var Laya=window.Laya=function($G,$X){var $c={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function($X,$g){return 1==arguments.length?$c.__presubstr.call(this,$X):$c.__presubstr.call(this,$X,0<$g?$g:this.length+$g)},__init:function($X){$X.forEach(function($X){$X.__init$&&$X.__init$()})},__isClass:function($X){return $X&&($X.__isclass||$X==Object||$X==String||$X==Array)},__newvec:function($X,$g){var $K=[];$K.length=$X;for(var $x=0;$x<$X;$x++)$K[$x]=$g;return $K},__extend:function($X,$g){for(var $K in $g)if($g.hasOwnProperty($K)){var $x=Object.getOwnPropertyDescriptor($g,$K),$Z=$x.get,$n=$x.set;$Z||$n?$Z&&$n?Object.defineProperty($X,$K,$x):($Z&&Object.defineProperty($X,$K,$Z),$n&&Object.defineProperty($X,$K,$n)):$X[$K]=$g[$K]}function $W(){$c.un(this,"constructor",$X)}$W.prototype=$g.prototype,$X.prototype=new $W,$c.un($X.prototype,"__imps",$c.__copy({},$g.prototype.__imps))},__copy:function($X,$g){if(!$g)return null;for(var $K in $X=$X||{},$g)$X[$K]=$g[$K];return $X},__package:function($X,$g){if(!$c.__packages[$X]){$c.__packages[$X]=!0;var $K=$G,$x=$X.split(".");if(1<$x.length)for(var $Z=0,$n=$x.length-1;$Z<$n;$Z++){var $W=$K[$x[$Z]];$K=$W||($K[$x[$Z]]={})}$K[$x[$x.length-1]]||($K[$x[$x.length-1]]=$g||{})}},__hasOwnProperty:function($X,$g){return $g=$g||this,Object.hasOwnProperty.call($g,$X)||function $X($g,$K){if(Object.hasOwnProperty.call($K.prototype,$g))return!0;var $x=$K.prototype.__super;return null==$x?null:$X($g,$x)}($X,$g.__class)},__typeof:function($X,$g){if(!$X||!$g)return!1;if($g===String)return"string"==typeof $X;if($g===Number)return"number"==typeof $X;if($g.__interface__)$g=$g.__interface__;else if("string"!=typeof $g)return $X instanceof $g;return $X.__imps&&$X.__imps[$g]||$X.__class==$g},__as:function($X,$g){return this.__typeof($X,$g)?$X:null},__int:function($X){return $X?parseInt($X):0},interface:function($X,$g){$c.__package($X,{});var $K=$c.__internals,$x=$K[$X]=$K[$X]||{self:$X};if($g){var $Z=$g.split(",");$x.extend=[];for(var $n=0;$n<$Z.length;$n++){var $W=$Z[$n];$K[$W]=$K[$W]||{self:$W},$x.extend.push($K[$W])}}var $v=$G,$T=$X.split(".");for($n=0;$n<$T.length-1;$n++)$v=$v[$T[$n]];$v[$T[$T.length-1]]={__interface__:$X}},class:function($X,$g,$K,$x){if($K&&$c.__extend($X,$K),$g)if($c.__package($g,$X),$c.__classmap[$g]=$X,0<$g.indexOf(".")){if(0==$g.indexOf("laya.")){var $Z=$g.split(".");$x=$x||$Z[$Z.length-1],$c[$x]&&console.log("Warning!,this class["+$x+"] already exist:",$c[$x]),$c[$x]=$X}}else"Main"==$g?$G.Main=$X:"MainWX"==$g?$G.MainWX=$X:($c[$g]&&console.log("Error!,this class["+$g+"] already exist:",$c[$g]),$c[$g]=$X);var $n=$c.un,$W=$X.prototype;$n($W,"hasOwnProperty",$c.__hasOwnProperty),$n($W,"__class",$X),$n($W,"__super",$K),$n($W,"__className",$g),$n($X,"__super",$K),$n($X,"__className",$g),$n($X,"__isclass",!0),$n($X,"super",function($X){this.__super.call($X)})},imps:function($X,$g){if(!$g)return null;var $Z=$X.__imps||$c.un($X,"__imps",{});function $n($X){var $g,$K;if(($g=$c.__internals[$X])&&($Z[$X]=!0,$K=$g.extend))for(var $x=0;$x<$K.length;$x++)$n($K[$x].self)}for(var $K in $g)$n($K)},superSet:function($X,$g,$K,$x){var $Z=$X.prototype["_$set_"+$K];$Z&&$Z.call($g,$x)},superGet:function($X,$g,$K){var $x=$X.prototype["_$get_"+$K];return $x?$x.call($g):null},getset:function($X,$g,$K,$x,$Z){$X?($x&&($g["_$GET_"+$K]=$x),$Z&&($g["_$SET_"+$K]=$Z)):($x&&$c.un($g,"_$get_"+$K,$x),$Z&&$c.un($g,"_$set_"+$K,$Z)),$x&&$Z?Object.defineProperty($g,$K,{get:$x,set:$Z,enumerable:!1,configurable:!0}):($x&&Object.defineProperty($g,$K,{get:$x,enumerable:!1,configurable:!0}),$Z&&Object.defineProperty($g,$K,{set:$Z,enumerable:!1,configurable:!0}))},static:function($K,$x){for(var $Z=0,$X=$x.length;$Z<$X;$Z+=2)if("length"==$x[$Z])$K.length=$x[$Z+1].call($K);else{function $g(){var $g=$x[$Z],$X=$x[$Z+1];Object.defineProperty($K,$g,{get:function(){return delete this[$g],this[$g]=$X.call(this)},set:function($X){delete this[$g],this[$g]=$X},enumerable:!0,configurable:!0})}$g()}},un:function($X,$g,$K){return $K||($K=$X[$g]),$c.__propun.value=$K,Object.defineProperty($X,$g,$c.__propun),$K},uns:function($g,$X){$X.forEach(function($X){$c.un($g,$X)})}};return $G.console=$G.console||{log:function(){}},$G.trace=$G.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),$c}(window,document);!function($X,$g,$K){$K.un,$K.uns,$K.static,$K.class,$K.getset,$K.__newvec}(window,document,Laya),function($W,$g,$D){$D.un,$D.uns;var $T=$D.static,$a=$D.class,$c=$D.getset;$D.__newvec;$D.interface("laya.runtime.IMarket"),$D.interface("laya.filters.IFilter"),$D.interface("laya.display.ILayout"),$D.interface("laya.resource.IDispose"),$D.interface("laya.runtime.IPlatform"),$D.interface("laya.resource.IDestroy"),$D.interface("laya.runtime.IConchNode"),$D.interface("laya.filters.IFilterAction"),$D.interface("laya.runtime.ICPlatformClass"),$D.interface("laya.resource.ICreateResource"),$D.interface("laya.runtime.IConchRenderObject"),$D.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var $t=function(){function $n(){}return $a($n,"laya.utils.RunDriver"),$n.FILTER_ACTIONS=[],$n.pixelRatio=-1,$n._charSizeTestDiv=null,$n.now=function(){return Date.now()},$n.getWindow=function(){return $W},$n.getPixelRatio=function(){if($n.pixelRatio<0){var $X=$q.context,$g=$X.backingStorePixelRatio||$X.webkitBackingStorePixelRatio||$X.mozBackingStorePixelRatio||$X.msBackingStorePixelRatio||$X.oBackingStorePixelRatio||$X.backingStorePixelRatio||1;($n.pixelRatio=($q.window.devicePixelRatio||1)/$g)<1&&($n.pixelRatio=1)}return $n.pixelRatio},$n.getIncludeStr=function($X){return null},$n.createShaderCondition=function($X){var $g="(function() {return "+$X+";})";return $D._runScript($g)},$n.fontMap=[],$n.measureText=function($X,$g){var $K=$n.hanzi.test($X);if($K&&$n.fontMap[$g])return $n.fontMap[$g];var $x=$q.context;$x.font=$g;var $Z=$x.measureText($X);return $Z||($Z={width:16,height:16}),$K&&($n.fontMap[$g]=$Z),$Z},$n.getWebGLContext=function($X){},$n.beginFlush=function(){},$n.endFinish=function(){},$n.addToAtlas=null,$n.flashFlushImage=function($X){},$n.drawToCanvas=function($X,$g,$K,$x,$Z,$n){var $W=$$X.create("2D"),$v=new $Y($K,$x,$W);return $l.renders[$g]._fun($X,$v,$Z,$n),$W},$n.createParticleTemplate2D=null,$n.createGLTextur=null,$n.createWebGLContext2D=null,$n.changeWebGLSize=function($X,$g){},$n.createRenderSprite=function($X,$g){return new $l($X,$g)},$n.createFilterAction=function($X){return new $$},$n.createGraphics=function(){return new $s},$n.clear=function($X){$C._context.ctx.clear()},$n.cancelLoadByUrl=function($X){},$n.clearAtlas=function($X){},$n.isAtlas=function($X){return!1},$n.addTextureToAtlas=function($X){},$n.getTexturePixels=function($X,$g,$K,$x,$Z){return null},$n.skinAniSprite=function(){return null},$n.update3DLoop=function(){},$T($n,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),$n}(),$x=($c(1,$D,"alertGlobalError",null,function($X){var $n=0;$q.window.onerror=$X?function($X,$g,$K,$x,$Z){$n++<5&&$Z&&alert($Z.stack||$Z)}:null}),$D.init=function($X,$g,$K){for(var $x=[],$Z=2,$n=arguments.length;$Z<$n;$Z++)$x.push(arguments[$Z]);if(!$D._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=$D._arrayBufferSlice),$D._isinit=!0,$q.__init__(),$p.__init__(),$s.__init__(),$D.timer=new $h,$D.scaleTimer=new $h,$D.loader=new $TX,$H.__init__(),$Z=0;for(var $W=$x.length;$Z<$W;$Z++)$x[$Z].enable&&$x[$Z].enable();return $V.__init__(),$v.__init__(),$L.__init__(),$u.beginCheck(),$D._currentStage=$D.stage=new $FX,$D.stage.conchModel&&$D.stage.conchModel.setRootNode(),$D._getUrlPath(),$D.render=new $C(0,0),$D.stage.size($X,$g),$l.__init__(),$_.__init__(),$A.instance.__init__($D.stage,$C.canvas),$QX.__init__(),$r.autoStopMusic=!0,$k.__init__(),$C.canvas}},$D._getUrlPath=function(){var $X=$q.window.location,$g=$X.pathname;$g=$g&&":"==$g.charAt(2)?$g.substring(1):$g,$N.rootPath=$N.basePath=$N.getPath("file:"==$X.protocol?$g:$X.protocol+"//"+$X.host+$X.pathname)},$D._arrayBufferSlice=function($X,$g){var $K=new Uint8Array(this,$X,$g-$X),$x=new Uint8Array($K.length);return $x.set($K),$x.buffer},$D._runScript=function($X){return $q.window[$D._evcode]($X)},$D.stage=null,$D.timer=null,$D.scaleTimer=null,$D.loader=null,$D.version="1.8.6",$D.render=null,$D._currentStage=null,$D._isinit=!1,$D.isDebug=!1,$D.MiniAdpter={init:function(){$W.navigator&&$W.navigator.userAgent&&-1<$W.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},$T($D,["conchMarket",function(){return this.conchMarket=$W.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=$W.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function $X(){}return $a($X,"Config"),$X.WebGLTextCacheCount=500,$X.atlasEnable=!1,$X.showCanvasMark=!1,$X.animationInterval=50,$X.isAntialias=!1,$X.isAlpha=!1,$X.premultipliedAlpha=!0,$X.isStencil=!0,$X.preserveDrawingBuffer=!1,$X}()),$G=function(){function $G(){this._events=null}$a($G,"laya.events.EventDispatcher");var $X=$G.prototype;return $X.hasListener=function($X){return!!(this._events&&this._events[$X])},$X.getListener=function($X){return this._events?this._events[$X]:null},$X.event=function($X,$g){if(!this._events||!this._events[$X])return!1;var $K=this._events[$X];if($K.lock)$K.queue||($K.queue=[]),$K.queue.push($g);else{var $x;for($K.lock=!0,$K.cursor=$K.head;$K.cursor;)($x=$K.cursor).recover?($K.head=$K.tail=$K.cursor=null,console.error("node is recover："+$x.id)):($K.cursor=$x.next,$x.once&&$G.delNode($K,$x),$x.method&&(null!=$g?$x.args?$x.method.apply($x.caller,$x.args.concat($g)):$g instanceof Array?$x.method.apply($x.caller,$g):$x.caller?$x.method.call($x.caller,$g):$D.recordError("事件派发错误","node.caller:"+$x.caller+"node.method:"+$x.method+"data:"+$g+"node.prev"+$x.prev):$x.method.apply($x.caller,$x.args)),$x.once&&$G.recoverHandler($x));$K.lock=!1,!$K.head&&this._events&&this._events[$X]==$K&&delete this._events[$X],$K.queue&&$K.queue.length&&this.event($X,$K.queue.shift())}return!0},$X.on=function($X,$g,$K,$x){return this._createListener($X,$g,$K,$x,!1)},$X.once=function($X,$g,$K,$x){return this._createListener($X,$g,$K,$x,!0)},$X._createListener=function($X,$g,$K,$x,$Z,$n){void 0===$n&&($n=!0),$n&&this.off($X,$g,$K,$Z);var $W=$G.createHandler($g||this,$K,$x,$Z);this._events||(this._events={});var $v=this._events,$T=$v[$X];return $T?$T.tail?($W.prev=$T.tail,$T.tail.next=$W,$T.tail=$W):$T.head=$T.tail=$W:$v[$X]={head:$W,tail:$W,cursor:null,lock:!1},this},$X.off=function($X,$g,$K,$x){if(void 0===$x&&($x=!1),!this._events||!this._events[$X])return this;for(var $Z=this._events[$X],$n=$Z.head;$n;){if((!$g||$n.caller===$g)&&$n.method===$K&&(!$x||$n.once)){$G.delNode($Z,$n),$Z.cursor==$n&&($Z.cursor=$n.next),$G.recoverHandler($n);break}$n=$n.next}return this},$X.offAll=function($X){var $g=this._events;if(!$g)return this;if($X)this._recoverHandlers($g[$X]),delete $g[$X];else{for(var $K in $g)this._recoverHandlers($g[$K]);this._events=null}return this},$X._recoverHandlers=function($X){if($X){for(var $g=$X.head;$g;){$G.delNode($X,$g);var $K=$g.next;$G.recoverHandler($g),$g=$K}$X.cursor=null}},$X.isMouseEvent=function($X){return $G.MOUSE_EVENTS[$X]},$G.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},$G.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},$G.delNode=function($X,$g){$g.prev?$g.prev.next=$g.next:$X.head=$g.next,$g.next?$g.next.prev=$g.prev:$X.tail=$g.prev},$G.createHandler=function($X,$g,$K,$x){var $Z=500<$G._freeHandler.length?$G._freeHandler.shift():null;if($Z)if($Z.recover)$Z.recover=!1,$Z.caller=$X,$Z.method=$g,$Z.args=$K,$Z.once=$x;else{var $n="";try{arguments.propertyIsEnumerable.caller}catch($X){$n=$X.stack}var $W=$Z.caller?($Z.caller.__proto__&&$Z.caller.__proto__.constructor&&$Z.caller.__proto__.constructor.name)+"|"+$Z.caller.__className+"|"+$Z.caller.name:"",$v=$Z.method?$Z.method.name:"";$D.recordError("EventDispatcher重复创建","caller="+$W+"  method="+$v+"  stack="+$n),$Z={id:++$G._nodeCount,caller:$X,method:$g,args:$K,once:$x,recover:!1}}else $Z={id:++$G._nodeCount,caller:$X,method:$g,args:$K,once:$x,recover:!1};return $Z.prev=$Z.next=null,$Z},$G.recoverHandler=function($X){if($X.recover){if($G._errorCount<5){$G._errorCount++;var $g="";try{arguments.propertyIsEnumerable.caller}catch($X){$g=$X.stack}var $K=$X.caller?($X.caller.__proto__&&$X.caller.__proto__.constructor&&$X.caller.__proto__.constructor.name)+"|"+$X.caller.__className+"|"+$X.caller.name:"",$x=$X.method?$X.method.name:"";$D.recordError("EventDispatcher重复回收","id="+$X.id+"  caller="+$K+"  method="+$x+"  stack="+$g)}$X.caller=$X.method=$X.args=$X.prev=null}else $X.recover=!0,$X.caller=$X.method=$X.args=$X.prev=$X.next=null,$G._freeHandler&&$G._freeHandler.length<3e3&&$G._freeHandler.push($X)},$G._freeHandler=[],$G._nodeCount=0,$G._errorCount=0,$G}(),$U=function(){function $Z($X,$g,$K,$x){this.once=!1,void(this._id=0)===$x&&($x=!1),this.setTo($X,$g,$K,$x)}$a($Z,"laya.utils.Handler");var $X=$Z.prototype;return $X.setTo=function($X,$g,$K,$x){return this._id=$Z._gid++,this.caller=$X,this.method=$g,this.args=$K,this.once=$x,this},$X.run=function(){if(null==this.method)return null;var $X=this._id,$g=this.method.apply(this.caller,this.args);return this._id===$X&&this.once&&this.recover(),$g},$X.runWith=function($X){if(null==this.method)return null;var $g=this._id;if(null==$X)var $K=this.method.apply(this.caller,this.args);else $K=this.args||$X.unshift?this.args?this.method.apply(this.caller,this.args.concat($X)):this.method.apply(this.caller,$X):this.method.call(this.caller,$X);return this._id===$g&&this.once&&this.recover(),$K},$X.clear=function(){return this.caller=null,this.method=null,this.args=null,this},$X.recover=function(){0<this._id&&(this._id=0,this.clear())},$Z.create=function($X,$g,$K,$x){return void 0===$x&&($x=!0),new $Z($X,$g,$K,$x)},$Z._gid=1,$Z}(),$I=function(){function $X(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}$a($X,"laya.display.BitmapFont");var $g=$X.prototype;return $g.loadFont=function($X,$g){this._path=$X,this._complete=$g,$D.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],$U.create(this,this.onLoaded))},$g.onLoaded=function(){this.parseFont($vX.getRes(this._path),$vX.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},$g.parseFont=function($X,$g){if(null!=$X&&null!=$g){this._texture=$g;var $K=$X.getElementsByTagName("info");if(!$K[0].getAttributeNode)return this.parseFont2($X,$g);this.fontSize=parseInt($K[0].getAttributeNode("size").nodeValue);var $x,$Z=$K[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt($Z[0]),parseInt($Z[1]),parseInt($Z[2]),parseInt($Z[3])],$x=$X.getElementsByTagName("char");var $n=0;for($n=0;$n<$x.length;$n++){var $W=$x[$n],$v=parseInt($W.getAttributeNode("id").nodeValue),$T=parseInt($W.getAttributeNode("xoffset").nodeValue)/1,$G=parseInt($W.getAttributeNode("yoffset").nodeValue)/1,$c=parseInt($W.getAttributeNode("xadvance").nodeValue)/1,$_=new $i;$_.x=parseInt($W.getAttributeNode("x").nodeValue),$_.y=parseInt($W.getAttributeNode("y").nodeValue),$_.width=parseInt($W.getAttributeNode("width").nodeValue),$_.height=parseInt($W.getAttributeNode("height").nodeValue);var $s=$cX.create($g,$_.x,$_.y,$_.width,$_.height,$T,$G);this._maxWidth=Math.max(this._maxWidth,$c+this.letterSpacing),this._fontCharDic[$v]=$s,this._fontWidthMap[$v]=$c}}},$g.parseFont2=function($X,$g){if(null!=$X&&null!=$g){this._texture=$g;var $K=$X.getElementsByTagName("info");this.fontSize=parseInt($K[0].attributes.size.nodeValue);var $x=$K[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt($x[0]),parseInt($x[1]),parseInt($x[2]),parseInt($x[3])];var $Z=$X.getElementsByTagName("char"),$n=0;for($n=0;$n<$Z.length;$n++){var $W=$Z[$n].attributes,$v=parseInt($W.id.nodeValue),$T=parseInt($W.xoffset.nodeValue)/1,$G=parseInt($W.yoffset.nodeValue)/1,$c=parseInt($W.xadvance.nodeValue)/1,$_=new $i;$_.x=parseInt($W.x.nodeValue),$_.y=parseInt($W.y.nodeValue),$_.width=parseInt($W.width.nodeValue),$_.height=parseInt($W.height.nodeValue);var $s=$cX.create($g,$_.x,$_.y,$_.width,$_.height,$T,$G);this._maxWidth=Math.max(this._maxWidth,$c+this.letterSpacing),this._fontCharDic[$v]=$s,this._fontWidthMap[$v]=$c}}},$g.getCharTexture=function($X){return this._fontCharDic[$X.charCodeAt(0)]},$g.destroy=function(){if(this._texture){for(var $X in this._fontCharDic){var $g=this._fontCharDic[$X];$g&&$g.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},$g.setSpaceWidth=function($X){this._spaceWidth=$X},$g.getCharWidth=function($X){var $g=$X.charCodeAt(0);return this._fontWidthMap[$g]?this._fontWidthMap[$g]+this.letterSpacing:" "==$X?this._spaceWidth+this.letterSpacing:0},$g.getTextWidth=function($X){for(var $g=0,$K=0,$x=$X.length;$K<$x;$K++)$g+=this.getCharWidth($X.charAt($K));return $g},$g.getMaxWidth=function(){return this._maxWidth},$g.getMaxHeight=function(){return this.fontSize},$g.drawText=function($X,$g,$K,$x,$Z,$n){var $W,$v=this.getTextWidth($X),$T=0;"center"===$Z&&($T=($n-$v)/2),"right"===$Z&&($T=$n-$v);for(var $G=0,$c=0,$_=$X.length;$c<$_;$c++)($W=this.getCharTexture($X.charAt($c)))&&($g.graphics.drawTexture($W,$K+$G+$T,$x),$G+=this.getCharWidth($X.charAt($c)))},$X}(),$v=function(){function $K(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=$K._TF_EMPTY}$a($K,"laya.display.css.Style");var $X=$K.prototype;return $X.getTransform=function(){return this._tf},$X.setTransform=function($X){this._tf="none"!==$X&&$X?$X:$K._TF_EMPTY},$X.setTranslateX=function($X){this._tf===$K._TF_EMPTY&&(this._tf=new $Z),this._tf.translateX=$X},$X.setTranslateY=function($X){this._tf===$K._TF_EMPTY&&(this._tf=new $Z),this._tf.translateY=$X},$X.setScaleX=function($X){this._tf===$K._TF_EMPTY&&(this._tf=new $Z),this._tf.scaleX=$X},$X.setScale=function($X,$g){this._tf===$K._TF_EMPTY&&(this._tf=new $Z),this._tf.scaleX=$X,this._tf.scaleY=$g},$X.setScaleY=function($X){this._tf===$K._TF_EMPTY&&(this._tf=new $Z),this._tf.scaleY=$X},$X.setRotate=function($X){this._tf===$K._TF_EMPTY&&(this._tf=new $Z),this._tf.rotate=$X},$X.setSkewX=function($X){this._tf===$K._TF_EMPTY&&(this._tf=new $Z),this._tf.skewX=$X},$X.setSkewY=function($X){this._tf===$K._TF_EMPTY&&(this._tf=new $Z),this._tf.skewY=$X},$X.destroy=function(){this.scrollRect=null},$X.render=function($X,$g,$K,$x){},$X.getCSSStyle=function(){return $gX.EMPTY},$X._enableLayout=function(){return!1},$c(0,$X,"scaleX",function(){return this._tf.scaleX},function($X){this.setScaleX($X)}),$c(0,$X,"transform",function(){return this.getTransform()},function($X){this.setTransform($X)}),$c(0,$X,"translateX",function(){return this._tf.translateX},function($X){this.setTranslateX($X)}),$c(0,$X,"translateY",function(){return this._tf.translateY},function($X){this.setTranslateY($X)}),$c(0,$X,"scaleY",function(){return this._tf.scaleY},function($X){this.setScaleY($X)}),$c(0,$X,"block",function(){return 0!=(1&this._type)}),$c(0,$X,"skewY",function(){return this._tf.skewY},function($X){this.setSkewY($X)}),$c(0,$X,"rotate",function(){return this._tf.rotate},function($X){this.setRotate($X)}),$c(0,$X,"skewX",function(){return this._tf.skewX},function($X){this.setSkewX($X)}),$c(0,$X,"paddingLeft",function(){return 0}),$c(0,$X,"paddingTop",function(){return 0}),$c(0,$X,"absolute",function(){return!0}),$K.__init__=function(){$K._TF_EMPTY=new $Z,$K.EMPTY=new $K},$K.EMPTY=null,$K._TF_EMPTY=null,$K}(),$V=function(){function $g($X){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=$e.create($g.defaultColor),this.family=$g.defaultFamily,this.stroke=$g._STROKE,this.size=$g.defaultSize,$X&&$X!==$g.EMPTY&&$X.copyTo(this)}$a($g,"laya.display.css.Font");var $X=$g.prototype;return $X.set=function($X){this._text=null;for(var $g=$X.split(" "),$K=0,$x=$g.length;$K<$x;$K++){var $Z=$g[$K];switch($Z){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<$Z.indexOf("px")&&(this.size=parseInt($Z),this.family=$g[$K+1],$K++)}},$X.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},$X.copyTo=function($X){$X._type=this._type,$X._text=this._text,$X._weight=this._weight,$X._color=this._color,$X.family=this.family,$X.stroke=this.stroke!=$g._STROKE?this.stroke.slice():$g._STROKE,$X.indent=this.indent,$X.size=this.size},$c(0,$X,"password",function(){return 0!=(1024&this._type)},function($X){$X?this._type|=1024:this._type&=-1025}),$c(0,$X,"color",function(){return this._color.strColor},function($X){this._color=$e.create($X)}),$c(0,$X,"italic",function(){return 0!=(512&this._type)},function($X){$X?this._type|=512:this._type&=-513}),$c(0,$X,"bold",function(){return 0!=(2048&this._type)},function($X){$X?this._type|=2048:this._type&=-2049}),$c(0,$X,"weight",function(){return""+this._weight},function($X){var $g=0;switch($X){case"normal":break;case"bold":this.bold=!0,$g=700;break;case"bolder":$g=800;break;case"lighter":$g=100;break;default:$g=parseInt($X)}this._weight=$g,this._text=null}),$c(0,$X,"decoration",function(){return this._decoration?this._decoration.value:null},function($X){var $g=$X.split(" ");switch(this._decoration||(this._decoration={}),$g[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=$g[0]}$g[1]&&(this._decoration.color=$e.create($g)),this._decoration.value=$X}),$g.__init__=function(){$g.EMPTY=new $g(null)},$g.EMPTY=null,$g.defaultColor="#000000",$g.defaultSize=12,$g.defaultFamily="Arial",$g.defaultFont="12px Arial",$g._STROKE=[0,"#000000"],$g._ITALIC=512,$g._PASSWORD=1024,$g._BOLD=2048,$g}(),$Z=function(){function $X(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return $a($X,"laya.display.css.TransformInfo"),$X}(),$s=function(){function $_(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,$C.isConchNode){this._nativeObj=new $W._conchGraphics,this.id=this._nativeObj.conchID}}$a($_,"laya.display.Graphics");var $X=$_.prototype;return $X.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},$X.clear=function($X){void 0===$X&&($X=!1);var $g=0,$K=0;if($X){var $x=this._one;if(this._cmds){for($K=this._cmds.length,$g=0;$g<$K;$g++)!($x=this._cmds[$g])||$x.callee!==$C._context._drawTexture&&$x.callee!==$C._context._drawTextureWithTransform||($x[0]=null,$_._cache.push($x));this._cmds.length=0}else $x&&(!$x||$x.callee!==$C._context._drawTexture&&$x.callee!==$C._context._drawTextureWithTransform||($x[0]=null,$_._cache.push($x)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for($g=0,$K=this._vectorgraphArray.length;$g<$K;$g++)$o.getInstance().deleteShape(this._vectorgraphArray[$g]);this._vectorgraphArray.length=0}},$X._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},$X._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new $K,this._graphicBounds._graphics=this)},$X._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},$X._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},$X.getBounds=function($X){return void 0===$X&&($X=!1),this._initGraphicBounds(),this._graphicBounds.getBounds($X)},$X.getBoundPoints=function($X){return void 0===$X&&($X=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints($X)},$X._addCmd=function($X){this._cmds=this._cmds||[],$X.callee=$X.shift(),this._cmds.push($X)},$X.setFilters=function($X){this._saveToCmd($C._context._setFilters,$X)},$X.drawTexture=function($X,$g,$K,$x,$Z,$n,$W){if(void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=0),void 0===$Z&&($Z=0),void 0===$W&&($W=1),!$X||$W<.01)return null;$x||($x=$X.sourceWidth),$Z||($Z=$X.sourceHeight),$W=$W<0?0:1<$W?1:$W;var $v,$T=!$C.isWebGL&&($q.onFirefox||$q.onEdge||$q.onIE||$q.onSafari)?.5:0,$G=$x/$X.sourceWidth,$c=$Z/$X.sourceHeight;return $x=$X.width*$G,$Z=$X.height*$c,$X.loaded&&($x<=0||$Z<=0)?null:($g+=$X.offsetX*$G,$K+=$X.offsetY*$c,this._sp&&(this._sp._renderType|=512),$g-=$T,$K-=$T,$x+=2*$T,$Z+=2*$T,$_._cache.length?(($v=$_._cache.pop())[0]=$X,$v[1]=$g,$v[2]=$K,$v[3]=$x,$v[4]=$Z,$v[5]=$n,$v[6]=$W):$v=[$X,$g,$K,$x,$Z,$n,$W],$v.callee=$n||1!=$W?$C._context._drawTextureWithTransform:$C._context._drawTexture,null!=this._one||$n||1!=$W?this._saveToCmd($v.callee,$v):(this._one=$v,this._render=this._renderOneImg),$X.loaded||$X.once("loaded",this,this._textureLoaded,[$X,$v]),this._repaint(),$v)},$X.cleanByTexture=function($X,$g,$K,$x,$Z){if(void 0===$x&&($x=0),void 0===$Z&&($Z=0),!$X)return this.clear();if(this._one&&this._render===this._renderOneImg){$x||($x=$X.sourceWidth),$Z||($Z=$X.sourceHeight);var $n=$x/$X.sourceWidth,$W=$Z/$X.sourceHeight;$x=$X.width*$n,$Z=$X.height*$W,$g+=$X.offsetX*$n,$K+=$X.offsetY*$W,this._one[0]=$X,this._one[1]=$g,this._one[2]=$K,this._one[3]=$x,this._one[4]=$Z,this._repaint()}else this.clear(),$X&&this.drawTexture($X,$g,$K,$x,$Z)},$X.drawTextures=function($X,$g){$X&&this._saveToCmd($C._context._drawTextures,[$X,$g])},$X.fillTexture=function($X,$g,$K,$x,$Z,$n,$W){if(void 0===$x&&($x=0),void 0===$Z&&($Z=0),void 0===$n&&($n="repeat"),$X){var $v=[$X,$g,$K,$x,$Z,$n,$W||$B.EMPTY,{}];$X.loaded||$X.once("loaded",this,this._textureLoaded,[$X,$v]),this._saveToCmd($C._context._fillTexture,$v)}},$X._textureLoaded=function($X,$g){$g[3]=$g[3]||$X.width,$g[4]=$g[4]||$X.height,this._repaint()},$X.fillCircle=function($X,$g,$K,$x,$Z,$n,$W){$K.bitmap.enableMerageInAtlas=!1;var $v=new Float32Array(2*($W+1)),$T=new Float32Array(2*($W+1)),$G=new Uint16Array(3*$W),$c=2*Math.PI/$W,$_=0;$v[0]=$x,$v[1]=$Z,$T[0]=$x/$K.width,$T[1]=$Z/$K.height;for(var $s=2,$V=0;$V<$W;$V++){var $A=$n*Math.cos($_)+$x,$a=$n*Math.sin($_)+$Z;$v[$s]=$A,$v[$s+1]=$a,$T[$s]=$A/$K.width,$T[$s+1]=$a/$K.height,$_+=$c,$s+=2}for($V=$s=0;$V<$W;$V++)$G[$s++]=0,$G[$s++]=$V+1,$G[$s++]=$W+1<=$V+2?1:$V+2;this.drawTriangles($K,$X,$g,$v,$T,$G)},$X.drawTriangles=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){void 0===$v&&($v=1),this._saveToCmd($C._context.drawTriangles,[$X,$g,$K,$x,$Z,$n,$W,$v,$T,$G])},$X._saveToCmd=function($X,$g){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=$g,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push($g)),$g.callee=$X,this._repaint(),$g},$X.clipRect=function($X,$g,$K,$x){this._saveToCmd($C._context._clipRect,[$X,$g,$K,$x])},$X.fillText=function($X,$g,$K,$x,$Z,$n,$W){void 0===$W&&($W=0),this._saveToCmd($C._context._fillText,[$X,$g,$K,$x||$V.defaultFont,$Z,$n])},$X.fillBorderText=function($X,$g,$K,$x,$Z,$n,$W,$v){this._saveToCmd($C._context._fillBorderText,[$X,$g,$K,$x||$V.defaultFont,$Z,$n,$W,$v])},$X.strokeText=function($X,$g,$K,$x,$Z,$n,$W){this._saveToCmd($C._context._strokeText,[$X,$g,$K,$x||$V.defaultFont,$Z,$n,$W])},$X.alpha=function($X){$X=$X<0?0:1<$X?1:$X,this._saveToCmd($C._context._alpha,[$X])},$X.setAlpha=function($X){$X=$X<0?0:1<$X?1:$X,this._saveToCmd($C._context._setAlpha,[$X])},$X.transform=function($X,$g,$K){void 0===$g&&($g=0),void 0===$K&&($K=0),this._saveToCmd($C._context._transform,[$X,$g,$K])},$X.rotate=function($X,$g,$K){void 0===$g&&($g=0),void 0===$K&&($K=0),this._saveToCmd($C._context._rotate,[$X,$g,$K])},$X.scale=function($X,$g,$K,$x){void 0===$K&&($K=0),void 0===$x&&($x=0),this._saveToCmd($C._context._scale,[$X,$g,$K,$x])},$X.translate=function($X,$g){this._saveToCmd($C._context._translate,[$X,$g])},$X.save=function(){this._saveToCmd($C._context._save,[])},$X.restore=function(){this._saveToCmd($C._context._restore,[])},$X.replaceText=function($X){this._repaint();var $g=this._cmds;if($g){for(var $K=$g.length-1;-1<$K;$K--)if(this._isTextCmd($g[$K].callee))return $g[$K][0].toUpperCase?$g[$K][0]=$X:$g[$K][0].setText($X),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=$X:this._one[0].setText($X),!0;return!1},$X._isTextCmd=function($X){return $X===$C._context._fillText||$X===$C._context._fillBorderText||$X===$C._context._strokeText},$X.replaceTextColor=function($X){this._repaint();var $g=this._cmds;if($g)for(var $K=$g.length-1;-1<$K;$K--)this._isTextCmd($g[$K].callee)&&($g[$K][4]=$X,$g[$K][0].toUpperCase||($g[$K][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=$X,this._one[0].toUpperCase||(this._one[0].changed=!0))},$X.loadImage=function($X,$g,$K,$x,$Z,$n){var $W=this;void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=0),void 0===$Z&&($Z=0);var $v=$vX.getRes($X);function $T($X){$X&&($W.drawTexture($X,$g,$K,$x,$Z),null!=$n&&$n.call($W._sp,$X))}$v?$T($v):$D.loader.load($X,$U.create(null,$T),null,"image")},$X._renderEmpty=function($X,$g,$K,$x){},$X._renderAll=function($X,$g,$K,$x){for(var $Z,$n=this._cmds,$W=0,$v=$n.length;$W<$v;$W++)($Z=$n[$W]).callee.call($g,$K,$x,$Z)},$X._renderOne=function($X,$g,$K,$x){this._one.callee.call($g,$K,$x,this._one)},$X._renderOneImg=function($X,$g,$K,$x){this._one.callee.call($g,$K,$x,this._one),2305!==$X._renderType&&($X._renderType|=1)},$X.drawLine=function($X,$g,$K,$x,$Z,$n){void 0===$n&&($n=1);var $W=0;$C.isWebGL&&($W=$o.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($W));var $v=$n%2==0?0:.5,$T=[$X+$v,$g+$v,$K+$v,$x+$v,$Z,$n,$W];this._saveToCmd($C._context._drawLine,$T)},$X.drawLines=function($X,$g,$K,$x,$Z){void 0===$Z&&($Z=1);var $n=0;if($K&&!($K.length<4)){$C.isWebGL&&($n=$o.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($n));var $W=$Z%2==0?0:.5,$v=[$X+$W,$g+$W,$K,$x,$Z,$n];this._saveToCmd($C._context._drawLines,$v)}},$X.drawCurves=function($X,$g,$K,$x,$Z){void 0===$Z&&($Z=1);var $n=[$X,$g,$K,$x,$Z];this._saveToCmd($C._context._drawCurves,$n)},$X.drawRect=function($X,$g,$K,$x,$Z,$n,$W){void 0===$W&&($W=1);var $v=$n?$W/2:0,$T=$n?$W:0,$G=[$X+$v,$g+$v,$K-$T,$x-$T,$Z,$n,$W];this._saveToCmd($C._context._drawRect,$G)},$X.drawCircle=function($X,$g,$K,$x,$Z,$n){void 0===$n&&($n=1);var $W=$Z?$n/2:0,$v=0;$C.isWebGL&&($v=$o.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($v));var $T=[$X,$g,$K-$W,$x,$Z,$n,$v];this._saveToCmd($C._context._drawCircle,$T)},$X.drawPie=function($X,$g,$K,$x,$Z,$n,$W,$v){void 0===$v&&($v=1);var $T=$W?$v/2:0,$G=$W?$v:0,$c=0;$C.isWebGL&&($c=$o.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($c));var $_=[$X+$T,$g+$T,$K-$G,$x,$Z,$n,$W,$v,$c];$_[3]=$J.toRadian($x),$_[4]=$J.toRadian($Z),this._saveToCmd($C._context._drawPie,$_)},$X.drawPoly=function($X,$g,$K,$x,$Z,$n){void 0===$n&&($n=1);var $W=0,$v=!1;$C.isWebGL&&($W=$o.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($W),$v=!(6<$K.length));var $T=$Z?$n%2==0?0:.5:0,$G=[$X+$T,$g+$T,$K,$x,$Z,$n,$W,$v];this._saveToCmd($C._context._drawPoly,$G)},$X.drawPath=function($X,$g,$K,$x,$Z){var $n=[$X,$g,$K,$x,$Z];this._saveToCmd($C._context._drawPath,$n)},$c(0,$X,"cmds",function(){return this._cmds},function($X){this._sp&&(this._sp._renderType|=512),this._cmds=$X,this._render=this._renderAll,this._repaint()}),$_.__init__=function(){if($C.isConchNode){for(var $X=laya.display.Graphics.prototype,$g=$q.window.ConchGraphics.prototype,$K=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],$x=0,$Z=$K.length;$x<=$Z;$x++){var $n=$K[$x];$X[$n]=$g[$n]}$X._saveToCmd=null,$g.drawImageS&&($X.drawTextures=function($X,$g){if($X&&$X.loaded&&$X.bitmap&&$X.source){var $K=$X.uv,$x=$X.bitmap.width,$Z=$X.bitmap.height;this.drawImageS($X.bitmap.source,$K[0]*$x,$K[1]*$Z,($K[2]-$K[0])*$x,($K[5]-$K[3])*$Z,$X.offsetX,$X.offsetY,$X.width,$X.height,$g)}}),$X.drawTexture=function($X,$g,$K,$x,$Z,$n,$W){if(void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=0),void 0===$Z&&($Z=0),void 0===$W&&($W=1),$X)if($X.loaded){if($X.loaded&&$X.bitmap&&$X.source&&($x||($x=$X.sourceWidth),$Z||($Z=$X.sourceHeight),$W=$W<0?0:1<$W?1:$W,$x=$x-$X.sourceWidth+$X.width,$Z=$Z-$X.sourceHeight+$X.height,!($x<=0||$Z<=0))){$g+=$X.offsetX,$K+=$X.offsetY;var $v=$X.uv,$T=$X.bitmap.width,$G=$X.bitmap.height;$v[4]<$v[0]&&$v[5]<$v[1]?this.drawImageM($X.bitmap.source,$v[4]*$T,$v[5]*$G,($v[0]-$v[4])*$T,($v[1]-$v[5])*$G,$g,$K,$x,$Z,$n,$W):this.drawImageM($X.bitmap.source,$v[0]*$T,$v[1]*$G,($v[2]-$v[0])*$T,($v[5]-$v[3])*$G,$g,$K,$x,$Z,$n,$W),this._repaint()}}else $X.once("loaded",this,function(){this.drawTexture($X,$g,$K,$x,$Z,$n)})},$X.fillTexture=function($X,$g,$K,$x,$Z,$n,$W){if(void 0===$x&&($x=0),void 0===$Z&&($Z=0),void 0===$n&&($n="repeat"),$X&&$X.loaded){var $v,$T=$C._context.ctx,$G=$X.bitmap.width,$c=$X.bitmap.height,$_=$X.uv;$v=$X.uv!=$cX.DEF_UV?$T.createPattern($X.bitmap.source,$n,$_[0]*$G,$_[1]*$c,($_[2]-$_[0])*$G,($_[5]-$_[3])*$c):$T.createPattern($X.bitmap.source,$n);var $s=0,$V=0;$W&&($g+=$W.x%$X.width,$K+=$W.y%$X.height,$s-=$W.x%$X.width,$V-=$W.y%$X.height),this._fillImage($v,$g,$K,$s,$V,$x,$Z)}}}},$_._cache=[],$_}(),$K=function(){function $$(){this._cacheBoundsType=!1}$a($$,"laya.display.GraphicsBounds");var $X=$$.prototype;return $X.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},$X.reset=function(){this._temp&&(this._temp.length=0)},$X.getBounds=function($X){return void 0===$X&&($X=!1),(!this._bounds||!this._temp||this._temp.length<1||$X!=this._cacheBoundsType)&&(this._bounds=$i._getWrapRec(this.getBoundPoints($X),this._bounds)),this._cacheBoundsType=$X,this._bounds},$X.getBoundPoints=function($X){return void 0===$X&&($X=!1),(!this._temp||this._temp.length<1||$X!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints($X)),this._cacheBoundsType=$X,this._rstBoundPoints=$J.copyArray(this._rstBoundPoints,this._temp)},$X._getCmdPoints=function($X){void 0===$X&&($X=!1);var $g,$K,$x=$C._context,$Z=this._graphics.cmds;if(($g=this._temp||(this._temp=[])).length=0,$Z||null==this._graphics._one||($$._tempCmds.length=0,$$._tempCmds.push(this._graphics._one),$Z=$$._tempCmds),!$Z)return $g;($K=$$._tempMatrixArrays).length=0;var $n=$$._initMatrix;$n.identity();for(var $W,$v,$T=$$._tempMatrix,$G=NaN,$c=NaN,$_=NaN,$s=NaN,$V=NaN,$A=NaN,$a=0,$m=$Z.length;$a<$m;$a++)if(($W=$Z[$a]).callee)switch($W.callee){case $x._save:case 7:$K.push($n),$n=$n.clone();break;case $x._restore:case 8:$n=$K.pop();break;case $x._scale:case 5:$T.identity(),$T.translate(-$W[2],-$W[3]),$T.scale($W[0],$W[1]),$T.translate($W[2],$W[3]),this._switchMatrix($n,$T);break;case $x._rotate:case 3:$T.identity(),$T.translate(-$W[1],-$W[2]),$T.rotate($W[0]),$T.translate($W[1],$W[2]),this._switchMatrix($n,$T);break;case $x._translate:case 6:$T.identity(),$T.translate($W[0],$W[1]),this._switchMatrix($n,$T);break;case $x._transform:case 4:$T.identity(),$T.translate(-$W[1],-$W[2]),$T.concat($W[0]),$T.translate($W[1],$W[2]),this._switchMatrix($n,$T);break;case 16:case 24:$$._addPointArrToRst($g,$i._getBoundPointS($W[0],$W[1],$W[2],$W[3]),$n);break;case 17:$n.copyTo($T),$T.concat($W[4]),$$._addPointArrToRst($g,$i._getBoundPointS($W[0],$W[1],$W[2],$W[3]),$T);break;case $x._drawTexture:$v=$W[0],$X?$W[3]&&$W[4]?$$._addPointArrToRst($g,$i._getBoundPointS($W[1],$W[2],$W[3],$W[4]),$n):($v=$W[0],$$._addPointArrToRst($g,$i._getBoundPointS($W[1],$W[2],$v.width,$v.height),$n)):($G=($W[3]||$v.sourceWidth)/$v.width,$c=($W[4]||$v.sourceHeight)/$v.height,$_=$G*$v.sourceWidth,$s=$c*$v.sourceHeight,$V=0<$v.offsetX?$v.offsetX:0,$A=0<$v.offsetY?$v.offsetY:0,$V*=$G,$A*=$c,$$._addPointArrToRst($g,$i._getBoundPointS($W[1]-$V,$W[2]-$A,$_,$s),$n));break;case $x._fillTexture:$W[3]&&$W[4]?$$._addPointArrToRst($g,$i._getBoundPointS($W[1],$W[2],$W[3],$W[4]),$n):($v=$W[0],$$._addPointArrToRst($g,$i._getBoundPointS($W[1],$W[2],$v.width,$v.height),$n));break;case $x._drawTextureWithTransform:var $F;$F=$W[5]?($n.copyTo($T),$T.concat($W[5]),$T):$n,$X?$W[3]&&$W[4]?$$._addPointArrToRst($g,$i._getBoundPointS($W[1],$W[2],$W[3],$W[4]),$F):($v=$W[0],$$._addPointArrToRst($g,$i._getBoundPointS($W[1],$W[2],$v.width,$v.height),$F)):($v=$W[0],$G=($W[3]||$v.sourceWidth)/$v.width,$c=($W[4]||$v.sourceHeight)/$v.height,$_=$G*$v.sourceWidth,$s=$c*$v.sourceHeight,$V=0<$v.offsetX?$v.offsetX:0,$A=0<$v.offsetY?$v.offsetY:0,$V*=$G,$A*=$c,$$._addPointArrToRst($g,$i._getBoundPointS($W[1]-$V,$W[2]-$A,$_,$s),$F));break;case $x._drawRect:case 13:$$._addPointArrToRst($g,$i._getBoundPointS($W[0],$W[1],$W[2],$W[3]),$n);break;case $x._drawCircle:case $x._fillCircle:case 14:$$._addPointArrToRst($g,$i._getBoundPointS($W[0]-$W[2],$W[1]-$W[2],$W[2]+$W[2],$W[2]+$W[2]),$n);break;case $x._drawLine:case 20:$$._tempPoints.length=0;var $U;$U=.5*$W[5],$W[0]==$W[2]?$$._tempPoints.push($W[0]+$U,$W[1],$W[2]+$U,$W[3],$W[0]-$U,$W[1],$W[2]-$U,$W[3]):$W[1]==$W[3]?$$._tempPoints.push($W[0],$W[1]+$U,$W[2],$W[3]+$U,$W[0],$W[1]-$U,$W[2],$W[3]-$U):$$._tempPoints.push($W[0],$W[1],$W[2],$W[3]),$$._addPointArrToRst($g,$$._tempPoints,$n);break;case $x._drawCurves:case 22:$$._addPointArrToRst($g,$w.I.getBezierPoints($W[2]),$n,$W[0],$W[1]);break;case $x._drawPoly:case $x._drawLines:case 18:$$._addPointArrToRst($g,$W[2],$n,$W[0],$W[1]);break;case $x._drawPath:case 19:$$._addPointArrToRst($g,this._getPathPoints($W[2]),$n,$W[0],$W[1]);break;case $x._drawPie:case 15:$$._addPointArrToRst($g,this._getPiePoints($W[0],$W[1],$W[2],$W[3],$W[4]),$n)}return 200<$g.length?$g=$J.copyArray($g,$i._getWrapRec($g)._getBoundPoints()):8<$g.length&&($g=$Q.scanPList($g)),$g},$X._switchMatrix=function($X,$g){$g.concat($X),$g.copyTo($X)},$X._getPiePoints=function($X,$g,$K,$x,$Z){var $n=$$._tempPoints;$$._tempPoints.length=0,$n.push($X,$g);var $W=($Z-$x)%(2*Math.PI)/10,$v=NaN,$T=$x;for($v=0;$v<=10;$v++)$n.push($X+$K*Math.cos($T),$g+$K*Math.sin($T)),$T+=$W;return $n},$X._getPathPoints=function($X){var $g,$K,$x=0,$Z=$$._tempPoints;for($Z.length=0,$g=$X.length,$x=0;$x<$g;$x++)1<($K=$X[$x]).length&&($Z.push($K[1],$K[2]),3<$K.length&&$Z.push($K[3],$K[4]));return $Z},$$._addPointArrToRst=function($X,$g,$K,$x,$Z){void 0===$x&&($x=0),void 0===$Z&&($Z=0);var $n,$W=0;for($n=$g.length,$W=0;$W<$n;$W+=2)$$._addPointToRst($X,$g[$W]+$x,$g[$W+1]+$Z,$K)},$$._addPointToRst=function($X,$g,$K,$x){var $Z=$B.TEMP;$Z.setTo($g||0,$K||0),$x.transformPoint($Z),$X.push($Z.x,$Z.y)},$$._tempPoints=[],$$._tempMatrixArrays=[],$$._tempCmds=[],$T($$,["_tempMatrix",function(){return this._tempMatrix=new $M},"_initMatrix",function(){return this._initMatrix=new $M}]),$$}(),$n=function(){function $X(){}$a($X,"laya.events.Event");var $g=$X.prototype;return $g.setTo=function($X,$g,$K){return this.type=$X,this.currentTarget=$g,this.target=$K,this},$g.stopPropagation=function(){this._stoped=!0},$c(0,$g,"stageY",function(){return $D.stage.mouseY}),$c(0,$g,"charCode",function(){return this.nativeEvent.charCode}),$c(0,$g,"touches",function(){var $X=this.nativeEvent.touches;if($X)for(var $g=$D.stage,$K=0,$x=$X.length;$K<$x;$K++){var $Z=$X[$K],$n=$B.TEMP;$n.setTo($Z.clientX,$Z.clientY),$g._canvasTransform.invertTransformPoint($n),$g.transform.invertTransformPoint($n),$Z.stageX=$n.x,$Z.stageY=$n.y}return $X}),$c(0,$g,"keyLocation",function(){return this.nativeEvent.keyLocation}),$c(0,$g,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),$c(0,$g,"altKey",function(){return this.nativeEvent.altKey}),$c(0,$g,"shiftKey",function(){return this.nativeEvent.shiftKey}),$c(0,$g,"stageX",function(){return $D.stage.mouseX}),$X.EMPTY=new $X,$X.MOUSE_DOWN="mousedown",$X.MOUSE_UP="mouseup",$X.CLICK="click",$X.RIGHT_MOUSE_DOWN="rightmousedown",$X.RIGHT_MOUSE_UP="rightmouseup",$X.RIGHT_CLICK="rightclick",$X.MOUSE_MOVE="mousemove",$X.MOUSE_OVER="mouseover",$X.MOUSE_OUT="mouseout",$X.MOUSE_WHEEL="mousewheel",$X.ROLL_OVER="mouseover",$X.ROLL_OUT="mouseout",$X.DOUBLE_CLICK="doubleclick",$X.CHANGE="change",$X.CHANGED="changed",$X.RESIZE="resize",$X.ADDED="added",$X.REMOVED="removed",$X.DISPLAY="display",$X.UNDISPLAY="undisplay",$X.ERROR="error",$X.COMPLETE="complete",$X.LOADED="loaded",$X.INITED="inited",$X.PROGRESS="progress",$X.INPUT="input",$X.RENDER="render",$X.OPEN="open",$X.MESSAGE="message",$X.CLOSE="close",$X.KEY_DOWN="keydown",$X.KEY_PRESS="keypress",$X.KEY_UP="keyup",$X.FRAME="enterframe",$X.DRAG_START="dragstart",$X.DRAG_MOVE="dragmove",$X.DRAG_END="dragend",$X.ENTER="enter",$X.SELECT="select",$X.BLUR="blur",$X.FOCUS="focus",$X.VISIBILITY_CHANGE="visibilitychange",$X.FOCUS_CHANGE="focuschange",$X.PLAYED="played",$X.PAUSED="paused",$X.STOPPED="stopped",$X.START="start",$X.END="end",$X.ENABLE_CHANGED="enablechanged",$X.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",$X.COMPONENT_ADDED="componentadded",$X.COMPONENT_REMOVED="componentremoved",$X.LAYER_CHANGED="layerchanged",$X.HIERARCHY_LOADED="hierarchyloaded",$X.RECOVERED="recovered",$X.RELEASED="released",$X.LINK="link",$X.LABEL="label",$X.FULL_SCREEN_CHANGE="fullscreenchange",$X.DEVICE_LOST="devicelost",$X.MESH_CHANGED="meshchanged",$X.MATERIAL_CHANGED="materialchanged",$X.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",$X.ANIMATION_CHANGED="animationchanged",$X.TRIGGER_ENTER="triggerenter",$X.TRIGGER_STAY="triggerstay",$X.TRIGGER_EXIT="triggerexit",$X.TRAIL_FILTER_CHANGE="trailfilterchange",$X.DOMINO_FILTER_CHANGE="dominofilterchange",$X}(),$_=(function(){function $X(){}$a($X,"laya.events.Keyboard"),$X.NUMBER_0=48,$X.NUMBER_1=49,$X.NUMBER_2=50,$X.NUMBER_3=51,$X.NUMBER_4=52,$X.NUMBER_5=53,$X.NUMBER_6=54,$X.NUMBER_7=55,$X.NUMBER_8=56,$X.NUMBER_9=57,$X.A=65,$X.B=66,$X.C=67,$X.D=68,$X.E=69,$X.F=70,$X.G=71,$X.H=72,$X.I=73,$X.J=74,$X.K=75,$X.L=76,$X.M=77,$X.N=78,$X.O=79,$X.P=80,$X.Q=81,$X.R=82,$X.S=83,$X.T=84,$X.U=85,$X.V=86,$X.W=87,$X.X=88,$X.Y=89,$X.Z=90,$X.F1=112,$X.F2=113,$X.F3=114,$X.F4=115,$X.F5=116,$X.F6=117,$X.F7=118,$X.F8=119,$X.F9=120,$X.F10=121,$X.F11=122,$X.F12=123,$X.F13=124,$X.F14=125,$X.F15=126,$X.NUMPAD=21,$X.NUMPAD_0=96,$X.NUMPAD_1=97,$X.NUMPAD_2=98,$X.NUMPAD_3=99,$X.NUMPAD_4=100,$X.NUMPAD_5=101,$X.NUMPAD_6=102,$X.NUMPAD_7=103,$X.NUMPAD_8=104,$X.NUMPAD_9=105,$X.NUMPAD_ADD=107,$X.NUMPAD_DECIMAL=110,$X.NUMPAD_DIVIDE=111,$X.NUMPAD_ENTER=108,$X.NUMPAD_MULTIPLY=106,$X.NUMPAD_SUBTRACT=109,$X.SEMICOLON=186,$X.EQUAL=187,$X.COMMA=188,$X.MINUS=189,$X.PERIOD=190,$X.SLASH=191,$X.BACKQUOTE=192,$X.LEFTBRACKET=219,$X.BACKSLASH=220,$X.RIGHTBRACKET=221,$X.QUOTE=222,$X.ALTERNATE=18,$X.BACKSPACE=8,$X.CAPS_LOCK=20,$X.COMMAND=15,$X.CONTROL=17,$X.DELETE=46,$X.ENTER=13,$X.ESCAPE=27,$X.PAGE_UP=33,$X.PAGE_DOWN=34,$X.END=35,$X.HOME=36,$X.LEFT=37,$X.UP=38,$X.RIGHT=39,$X.DOWN=40,$X.SHIFT=16,$X.SPACE=32,$X.TAB=9,$X.INSERT=45}(),function(){function $Z(){}return $a($Z,"laya.events.KeyBoardManager"),$Z.__init__=function(){$Z._addEvent("keydown"),$Z._addEvent("keypress"),$Z._addEvent("keyup")},$Z._addEvent=function($g){$q.document.addEventListener($g,function($X){laya.events.KeyBoardManager._dispatch($X,$g)},!0)},$Z._dispatch=function($X,$g){if($Z.enabled){$Z._event._stoped=!1,$Z._event.nativeEvent=$X,$Z._event.keyCode=$X.keyCode||$X.which||$X.charCode,"keydown"===$g?$Z._pressKeys[$Z._event.keyCode]=!0:"keyup"===$g&&($Z._pressKeys[$Z._event.keyCode]=null);for(var $K=$D.stage.focus&&null!=$D.stage.focus.event&&$D.stage.focus.displayedInStage?$D.stage.focus:$D.stage,$x=$K;$x;)$x.event($g,$Z._event.setTo($g,$x,$K)),$x=$x.parent}},$Z.hasKeyDown=function($X){return $Z._pressKeys[$X]},$Z._pressKeys={},$Z.enabled=!0,$T($Z,["_event",function(){return this._event=new $n}]),$Z}()),$A=(function(){function $X(){}$a($X,"laya.events.KeyLocation"),$X.STANDARD=0,$X.LEFT=1,$X.RIGHT=2,$X.NUM_PAD=3}(),function(){function $c(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=$q.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new $n,this._matrix=new $M,this._point=new $B,this._rect=new $i,this._prePoint=new $B,this._curTouchID=NaN}$a($c,"laya.events.MouseManager");var $X=$c.prototype;return $X.__init__=function($X,$g){var $K=this;this._stage=$X;var $x=this,$Z=this._eventList;$g.oncontextmenu=function($X){if($c.enabled)return!1},$g.addEventListener("mousedown",function($X){$c.enabled&&($q.onIE||$X.preventDefault(),$Z.push($X),$x.mouseDownTime=$q.now())}),$g.addEventListener("mouseup",function($X){$c.enabled&&($X.preventDefault(),$Z.push($X),$x.mouseDownTime=-$q.now())},!0),$g.addEventListener("mousemove",function($X){if($c.enabled){$X.preventDefault();var $g=$q.now();if($g-$x._lastMoveTimer<10)return;$x._lastMoveTimer=$g,$Z.push($X)}},!0),$g.addEventListener("mouseout",function($X){$c.enabled&&$Z.push($X)}),$g.addEventListener("mouseover",function($X){$c.enabled&&$Z.push($X)}),$g.addEventListener("touchstart",function($X){$c.enabled&&($Z.push($X),$c._isFirstTouch||$QX.isInputting||$X.preventDefault(),$x.mouseDownTime=$q.now())}),$g.addEventListener("touchend",function($X){$c.enabled?($c._isFirstTouch||$QX.isInputting||$X.preventDefault(),$c._isFirstTouch=!1,$Z.push($X),$x.mouseDownTime=-$q.now()):$K._curTouchID=NaN},!0),$g.addEventListener("touchmove",function($X){$c.enabled&&($X.preventDefault(),$Z.push($X))},!0),$g.addEventListener("touchcancel",function($X){$c.enabled?($X.preventDefault(),$Z.push($X)):$K._curTouchID=NaN},!0),$g.addEventListener("mousewheel",function($X){$c.enabled&&$Z.push($X)}),$g.addEventListener("DOMMouseScroll",function($X){$c.enabled&&$Z.push($X)})},$X.initEvent=function($X,$g){var $K;this._event._stoped=!1,this._event.nativeEvent=$g||$X,this._target=null,this._point.setTo($X.pageX||$X.clientX,$X.pageY||$X.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=$X.identifier||0,this._tTouchID=this._event.touchId,($K=$m.I._event)._stoped=!1,$K.nativeEvent=this._event.nativeEvent,$K.touchId=this._event.touchId},$X.checkMouseWheel=function($X){this._event.delta=$X.wheelDelta?.025*$X.wheelDelta:-$X.detail;for(var $g=$m.I.getLastOvers(),$K=0,$x=$g.length;$K<$x;$K++){var $Z=$g[$K];$Z.event("mousewheel",this._event.setTo("mousewheel",$Z,this._target))}},$X.onMouseMove=function($X){$m.I.onMouseMove($X,this._tTouchID)},$X.onMouseDown=function($X){if($QX.isInputting&&$D.stage.focus&&$D.stage.focus.focus&&!$D.stage.focus.contains(this._target)){var $g=$D.stage.focus._tf||$D.stage.focus,$K=$X._tf||$X;$K instanceof laya.display.Input&&$K.multiline==$g.multiline?$g._focusOut():$g.focus=!1}$m.I.onMouseDown($X,this._tTouchID,this._isLeftMouse)},$X.onMouseUp=function($X){$m.I.onMouseUp($X,this._tTouchID,this._isLeftMouse)},$X.check=function($X,$g,$K,$x){this._point.setTo($g,$K),$X.fromParentPoint(this._point),$g=this._point.x,$K=this._point.y;var $Z=$X.scrollRect;if($Z&&(this._rect.setTo($Z.x,$Z.y,$Z.width,$Z.height),!this._rect.contains($g,$K)))return!1;if(!this.disableMouseEvent){if($X.hitTestPrior&&!$X.mouseThrough&&!this.hitTest($X,$g,$K))return!1;for(var $n=$X._childs.length-1;-1<$n;$n--){var $W=$X._childs[$n];if(!$W.destroyed&&$W.mouseEnabled&&$W.visible&&this.check($W,$g,$K,$x))return!0}}var $v=!(!$X.hitTestPrior||$X.mouseThrough||this.disableMouseEvent)||this.hitTest($X,$g,$K);return $v?(this._target=$X,$x.call(this,$X)):$x===this.onMouseUp&&$X===this._stage&&(this._target=this._stage,$x.call(this,this._target)),$v},$X.hitTest=function($X,$g,$K){var $x=!1;if($X.scrollRect&&($g-=$X.scrollRect.x,$K-=$X.scrollRect.y),$X.hitArea instanceof laya.utils.HitArea)return $X.hitArea.isHit($g,$K);if(0<$X.width&&0<$X.height||$X.mouseThrough||$X.hitArea)if($X.mouseThrough)$x=$X.getGraphicBounds().contains($g,$K);else{var $Z=this._rect;$X.hitArea?$Z=$X.hitArea:$Z.setTo(0,0,$X.width,$X.height),$x=$Z.contains($g,$K)}return $x},$X.runEvent=function(){var $X=this._eventList.length;if($X){var $g=this;$g.mouseEventTime=$q.now();var $K,$x=0,$Z=0,$n=0;try{for(;$x<$X;){var $W=this._eventList[$x];switch("mousemove"!==$W.type&&(this._prePoint.x=this._prePoint.y=-1e6),$W.type){case"mousedown":this._touchIDs[0]=this._id++,$c._isTouchRespond?$c._isTouchRespond=!1:($g._isLeftMouse=0===$W.button,$g.initEvent($W),$g.check($g._stage,$g.mouseX,$g.mouseY,$g.onMouseDown));break;case"mouseup":$g._isLeftMouse=0===$W.button,$g.initEvent($W),$g.check($g._stage,$g.mouseX,$g.mouseY,$g.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-$W.clientX)+Math.abs(this._prePoint.y-$W.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=$W.clientX,this._prePoint.y=$W.clientY,$g.initEvent($W),$g.check($g._stage,$g.mouseX,$g.mouseY,$g.onMouseMove));break;case"touchstart":$c._isTouchRespond=!0,$g._isLeftMouse=!0;var $v=$W.changedTouches;for($Z=0,$n=$v.length;$Z<$n;$Z++)$K=$v[$Z],($c.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=$K.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[$K.identifier]=this._id++,$g.initEvent($K,$W),$g.check($g._stage,$g.mouseX,$g.mouseY,$g.onMouseDown));break;case"touchend":case"touchcancel":$c._isTouchRespond=!0,$g._isLeftMouse=!0;var $T=$W.changedTouches;for($Z=0,$n=$T.length;$Z<$n;$Z++)if($K=$T[$Z],$c.multiTouchEnabled||$K.identifier==this._curTouchID){this._curTouchID=NaN,$g.initEvent($K,$W);$g.check($g._stage,$g.mouseX,$g.mouseY,$g.onMouseUp)||$g.onMouseUp(null)}break;case"touchmove":var $G=$W.changedTouches;for($Z=0,$n=$G.length;$Z<$n;$Z++)$K=$G[$Z],($c.multiTouchEnabled||$K.identifier==this._curTouchID)&&($g.initEvent($K,$W),$g.check($g._stage,$g.mouseX,$g.mouseY,$g.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":$g.checkMouseWheel($W);break;case"mouseout":$m.I.stageMouseOut();break;case"mouseover":$g._stage.event("mouseover",$g._event.setTo("mouseover",$g._stage,$g._stage))}$x++}}catch($X){throw this._eventList.length=0,$X}this._eventList.length=0}},$c.enabled=!0,$c.multiTouchEnabled=!0,$c._isTouchRespond=!1,$c._isFirstTouch=!0,$T($c,["instance",function(){return this.instance=new $c}]),$c}()),$m=function(){function $A(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new $n}$a($A,"laya.events.TouchManager");var $X=$A.prototype;return $X._clearTempArrs=function(){$A._oldArr.length=0,$A._newArr.length=0,$A._tEleArr.length=0},$X.getTouchFromArr=function($X,$g){var $K,$x,$Z=0;for($K=$g.length,$Z=0;$Z<$K;$Z++)if(($x=$g[$Z]).id==$X)return $x;return null},$X.removeTouchFromArr=function($X,$g){var $K=0;for($K=$g.length-1;0<=$K;$K--)$g[$K].id==$X&&$g.splice($K,1)},$X.createTouchO=function($X,$g){var $K;return($K=$j.getItem("TouchData")||{}).id=$g,$K.tar=$X,$K},$X.onMouseDown=function($X,$g,$K){var $x,$Z,$n,$W;(void 0===$K&&($K=!1),this.enable)&&($x=this.getTouchFromArr($g,this.preOvers),$n=this.getEles($X,null,$A._tEleArr),$x?$x.tar=$X:($Z=this.createTouchO($X,$g),this.preOvers.push($Z)),$q.onMobile&&this.sendEvents($n,"mouseover",$g),$W=$K?this.preDowns:this.preRightDowns,($x=this.getTouchFromArr($g,$W))?$x.tar=$X:($Z=this.createTouchO($X,$g),$W.push($Z)),this.sendEvents($n,$K?"mousedown":"rightmousedown",$g),this._clearTempArrs())},$X.sendEvents=function($X,$g,$K){void 0===$K&&($K=0);var $x,$Z,$n,$W=0;for($x=$X.length,this._event._stoped=!1,$Z=$X[0],$W=0;$W<$x;$W++){if(($n=$X[$W]).destroyed)return;if($n.event($g,this._event.setTo($g,$n,$Z)),this._event._stoped)break}},$X.getEles=function($X,$g,$K){for($K?$K.length=0:$K=[];$X&&$X!=$g;)$K.push($X),$X=$X.parent;return $K},$X.checkMouseOutAndOverOfMove=function($X,$g,$K){if(void 0===$K&&($K=0),$g!=$X){var $x,$Z,$n=0,$W=0;if($g.contains($X))$Z=this.getEles($X,$g,$A._tEleArr),this.sendEvents($Z,"mouseover",$K);else if($X.contains($g))$Z=this.getEles($g,$X,$A._tEleArr),this.sendEvents($Z,"mouseout",$K);else{var $v,$T;($Z=$A._tEleArr).length=0,$v=this.getEles($g,null,$A._oldArr),$T=this.getEles($X,null,$A._newArr),$W=$v.length;var $G=0;for($n=0;$n<$W;$n++){if($x=$v[$n],0<=($G=$T.indexOf($x))){$T.splice($G,$T.length-$G);break}$Z.push($x)}0<$Z.length&&this.sendEvents($Z,"mouseout",$K),0<$T.length&&this.sendEvents($T,"mouseover",$K)}}},$X.onMouseMove=function($X,$g){var $K,$x;this.enable&&(($K=this.getTouchFromArr($g,this.preOvers))?(this.checkMouseOutAndOverOfMove($X,$K.tar),$K.tar=$X,$x=this.getEles($X,null,$A._tEleArr)):($x=this.getEles($X,null,$A._tEleArr),this.sendEvents($x,"mouseover",$g),this.preOvers.push(this.createTouchO($X,$g))),this.sendEvents($x,"mousemove",$g),this._clearTempArrs())},$X.getLastOvers=function(){return($A._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,$A._tEleArr):($A._tEleArr.push($D.stage),$A._tEleArr)},$X.stageMouseOut=function(){var $X;$X=this.getLastOvers(),this.preOvers.length=0,this.sendEvents($X,"mouseout",0)},$X.onMouseUp=function($X,$g,$K){if(void 0===$K&&($K=!1),this.enable){var $x,$Z,$n,$W,$v,$T,$G=0,$c=0,$_=$q.onMobile;if($Z=this.getEles($X,null,$A._tEleArr),this.sendEvents($Z,$K?"mouseup":"rightmouseup",$g),$T=$K?this.preDowns:this.preRightDowns,$x=this.getTouchFromArr($g,$T)){var $s,$V=$q.now();if($s=$V-this._lastClickTime<300,this._lastClickTime=$V,$X==$x.tar)$v=$Z;else for($n=this.getEles($x.tar,null,$A._oldArr),($v=$A._newArr).length=0,$c=$n.length,$G=0;$G<$c;$G++)$W=$n[$G],0<=$Z.indexOf($W)&&$v.push($W);0<$v.length&&this.sendEvents($v,$K?"click":"rightclick",$g),$K&&$s&&this.sendEvents($v,"doubleclick",$g),this.removeTouchFromArr($g,$T),$x.tar=null,$j.recover("TouchData",$x)}else;($x=this.getTouchFromArr($g,this.preOvers))&&$_&&(($v=this.getEles($x.tar,null,$v))&&0<$v.length&&this.sendEvents($v,"mouseout",$g),this.removeTouchFromArr($g,this.preOvers),$x.tar=null,$j.recover("TouchData",$x)),this._clearTempArrs()}},$A._oldArr=[],$A._newArr=[],$A._tEleArr=[],$T($A,["I",function(){return this.I=new $A}]),$A}(),$F=function(){function $X(){this._action=null}$a($X,"laya.filters.Filter");var $g=$X.prototype;return $D.imps($g,{"laya.filters.IFilter":!0}),$g.callNative=function($X){},$c(0,$g,"type",function(){return-1}),$c(0,$g,"action",function(){return this._action}),$X.BLUR=16,$X.COLOR=32,$X.GLOW=8,$X._filterStart=null,$X._filterEnd=null,$X._EndTarget=null,$X._recycleScope=null,$X._filter=null,$X._useSrc=null,$X._endSrc=null,$X._useOut=null,$X._endOut=null,$X}(),$$=function(){function $X(){this.data=null}$a($X,"laya.filters.ColorFilterAction");var $g=$X.prototype;return $D.imps($g,{"laya.filters.IFilterAction":!0}),$g.apply=function($X){var $g=$X.ctx.ctx,$K=$X.ctx.ctx.canvas;if(0==$K.width||0==$K.height)return $K;for(var $x,$Z=$g.getImageData(0,0,$K.width,$K.height),$n=$Z.data,$W=0,$v=$n.length;$W<$v;$W+=4)$x=this.getColor($n[$W],$n[$W+1],$n[$W+2],$n[$W+3]),0!=$n[$W+3]&&($n[$W]=$x[0],$n[$W+1]=$x[1],$n[$W+2]=$x[2],$n[$W+3]=$x[3]);return $g.putImageData($Z,0,0),$X},$g.getColor=function($X,$g,$K,$x){var $Z=[];if(this.data._mat&&this.data._alpha){var $n=this.data._mat,$W=this.data._alpha;$Z[0]=$n[0]*$X+$n[1]*$g+$n[2]*$K+$n[3]*$x+$W[0],$Z[1]=$n[4]*$X+$n[5]*$g+$n[6]*$K+$n[7]*$x+$W[1],$Z[2]=$n[8]*$X+$n[9]*$g+$n[10]*$K+$n[11]*$x+$W[2],$Z[3]=$n[12]*$X+$n[13]*$g+$n[14]*$K+$n[15]*$x+$W[3]}return $Z},$X}(),$w=(function(){function $X(){}$a($X,"laya.maths.Arith"),$X.formatR=function($X){return $X>Math.PI&&($X-=2*Math.PI),$X<-Math.PI&&($X+=2*Math.PI),$X},$X.isPOT=function($X,$g){return 0<$X&&0==($X&$X-1)&&0<$g&&0==($g&$g-1)},$X.setMatToArray=function($X,$g){$X.a,$X.b,$X.c,$X.d,$X.tx,$X.ty,$g[0]=$X.a,$g[1]=$X.b,$g[4]=$X.c,$g[5]=$X.d,$g[12]=$X.tx,$g[13]=$X.ty}}(),function(){function $X(){this._controlPoints=[new $B,new $B,new $B],this._calFun=this.getPoint2}$a($X,"laya.maths.Bezier");var $g=$X.prototype;return $g._switchPoint=function($X,$g){var $K=this._controlPoints.shift();$K.setTo($X,$g),this._controlPoints.push($K)},$g.getPoint2=function($X,$g){var $K=this._controlPoints[0],$x=this._controlPoints[1],$Z=this._controlPoints[2],$n=Math.pow(1-$X,2)*$K.x+2*$X*(1-$X)*$x.x+Math.pow($X,2)*$Z.x,$W=Math.pow(1-$X,2)*$K.y+2*$X*(1-$X)*$x.y+Math.pow($X,2)*$Z.y;$g.push($n,$W)},$g.getPoint3=function($X,$g){var $K=this._controlPoints[0],$x=this._controlPoints[1],$Z=this._controlPoints[2],$n=this._controlPoints[3],$W=Math.pow(1-$X,3)*$K.x+3*$x.x*$X*(1-$X)*(1-$X)+3*$Z.x*$X*$X*(1-$X)+$n.x*Math.pow($X,3),$v=Math.pow(1-$X,3)*$K.y+3*$x.y*$X*(1-$X)*(1-$X)+3*$Z.y*$X*$X*(1-$X)+$n.y*Math.pow($X,3);$g.push($W,$v)},$g.insertPoints=function($X,$g){var $K,$x=NaN;for($K=1/($X=0<$X?$X:5),$x=0;$x<=1;$x+=$K)this._calFun($x,$g)},$g.getBezierPoints=function($X,$g,$K){void 0===$g&&($g=5),void 0===$K&&($K=2);var $x,$Z,$n=0;if(($x=$X.length)<2*($K+1))return[];switch($Z=[],$K){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=$K;)this._controlPoints.push(new $B);for($n=0;$n<2*$K;$n+=2)this._switchPoint($X[$n],$X[$n+1]);for($n=2*$K;$n<$x;$n+=2)this._switchPoint($X[$n],$X[$n+1]),$n/2%$K==0&&this.insertPoints($g,$Z);return $Z},$T($X,["I",function(){return this.I=new $X}]),$X}()),$Q=function(){function $G(){}return $a($G,"laya.maths.GrahamScan"),$G.multiply=function($X,$g,$K){return($X.x-$K.x)*($g.y-$K.y)-($g.x-$K.x)*($X.y-$K.y)},$G.dis=function($X,$g){return($X.x-$g.x)*($X.x-$g.x)+($X.y-$g.y)*($X.y-$g.y)},$G._getPoints=function($X,$g,$K){for(void 0===$g&&($g=!1),$G._mPointList||($G._mPointList=[]);$G._mPointList.length<$X;)$G._mPointList.push(new $B);return $K||($K=[]),$K.length=0,$g?$G.getFrom($K,$G._mPointList,$X):$G.getFromR($K,$G._mPointList,$X),$K},$G.getFrom=function($X,$g,$K){var $x=0;for($x=0;$x<$K;$x++)$X.push($g[$x]);return $X},$G.getFromR=function($X,$g,$K){var $x=0;for($x=0;$x<$K;$x++)$X.push($g.pop());return $X},$G.pListToPointList=function($X,$g){void 0===$g&&($g=!1);var $K=0,$x=$X.length/2,$Z=$G._getPoints($x,$g,$G._tempPointList);for($K=0;$K<$x;$K++)$Z[$K].setTo($X[$K+$K],$X[$K+$K+1]);return $Z},$G.pointListToPlist=function($X){var $g,$K=0,$x=$X.length,$Z=$G._temPList;for($K=$Z.length=0;$K<$x;$K++)$g=$X[$K],$Z.push($g.x,$g.y);return $Z},$G.scanPList=function($X){return $J.copyArray($X,$G.pointListToPlist($G.scan($G.pListToPointList($X,!0))))},$G.scan=function($X){var $g,$K,$x,$Z=0,$n=0,$W=0,$v=$X.length,$T={};for(($K=$G._temArr).length=0,$Z=($v=$X.length)-1;0<=$Z;$Z--)$x=($g=$X[$Z]).x+"_"+$g.y,$T.hasOwnProperty($x)||($T[$x]=!0,$K.push($g));for($v=$K.length,$J.copyArray($X,$K),$Z=1;$Z<$v;$Z++)($X[$Z].y<$X[$W].y||$X[$Z].y==$X[$W].y&&$X[$Z].x<$X[$W].x)&&($W=$Z);for($g=$X[0],$X[0]=$X[$W],$X[$W]=$g,$Z=1;$Z<$v-1;$Z++){for($n=($W=$Z)+1;$n<$v;$n++)(0<$G.multiply($X[$n],$X[$W],$X[0])||0==$G.multiply($X[$n],$X[$W],$X[0])&&$G.dis($X[0],$X[$n])<$G.dis($X[0],$X[$W]))&&($W=$n);$g=$X[$Z],$X[$Z]=$X[$W],$X[$W]=$g}if(($K=$G._temArr).length=0,$X.length<3)return $J.copyArray($K,$X);for($K.push($X[0],$X[1],$X[2]),$Z=3;$Z<$v;$Z++){for(;2<=$K.length&&0<=$G.multiply($X[$Z],$K[$K.length-1],$K[$K.length-2]);)$K.pop();$X[$Z]&&$K.push($X[$Z])}return $K},$G._mPointList=null,$G._tempPointList=[],$G._temPList=[],$G._temArr=[],$G}(),$f=function(){function $Z(){}return $a($Z,"laya.maths.MathUtil"),$Z.subtractVector3=function($X,$g,$K){$K[0]=$X[0]-$g[0],$K[1]=$X[1]-$g[1],$K[2]=$X[2]-$g[2]},$Z.lerp=function($X,$g,$K){return $X*(1-$K)+$g*$K},$Z.scaleVector3=function($X,$g,$K){$K[0]=$X[0]*$g,$K[1]=$X[1]*$g,$K[2]=$X[2]*$g},$Z.lerpVector3=function($X,$g,$K,$x){var $Z=$X[0],$n=$X[1],$W=$X[2];$x[0]=$Z+$K*($g[0]-$Z),$x[1]=$n+$K*($g[1]-$n),$x[2]=$W+$K*($g[2]-$W)},$Z.lerpVector4=function($X,$g,$K,$x){var $Z=$X[0],$n=$X[1],$W=$X[2],$v=$X[3];$x[0]=$Z+$K*($g[0]-$Z),$x[1]=$n+$K*($g[1]-$n),$x[2]=$W+$K*($g[2]-$W),$x[3]=$v+$K*($g[3]-$v)},$Z.slerpQuaternionArray=function($X,$g,$K,$x,$Z,$n,$W){var $v,$T,$G,$c,$_,$s=$X[$g+0],$V=$X[$g+1],$A=$X[$g+2],$a=$X[$g+3],$m=$K[$x+0],$F=$K[$x+1],$U=$K[$x+2],$$=$K[$x+3];return($T=$s*$m+$V*$F+$A*$U+$a*$$)<0&&($T=-$T,$m=-$m,$F=-$F,$U=-$U,$$=-$$),$_=1e-6<1-$T?($v=Math.acos($T),$G=Math.sin($v),$c=Math.sin((1-$Z)*$v)/$G,Math.sin($Z*$v)/$G):($c=1-$Z,$Z),$n[$W+0]=$c*$s+$_*$m,$n[$W+1]=$c*$V+$_*$F,$n[$W+2]=$c*$A+$_*$U,$n[$W+3]=$c*$a+$_*$$,$n},$Z.getRotation=function($X,$g,$K,$x){return Math.atan2($x-$g,$K-$X)/Math.PI*180},$Z.sortBigFirst=function($X,$g){return $X==$g?0:$X<$g?1:-1},$Z.sortSmallFirst=function($X,$g){return $X==$g?0:$X<$g?-1:1},$Z.sortNumBigFirst=function($X,$g){return parseFloat($g)-parseFloat($X)},$Z.sortNumSmallFirst=function($X,$g){return parseFloat($X)-parseFloat($g)},$Z.sortByKey=function($K,$X,$g){var $x;return void 0===$X&&($X=!1),void 0===$g&&($g=!0),$x=$X?$g?$Z.sortNumBigFirst:$Z.sortBigFirst:$g?$Z.sortNumSmallFirst:$Z.sortSmallFirst,function($X,$g){return $x($X[$K],$g[$K])}},$Z}(),$M=function(){function $K($X,$g,$K,$x,$Z,$n){this.inPool=!1,this.bTransform=!1,void 0===$X&&($X=1),void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=1),void 0===$Z&&($Z=0),void 0===$n&&($n=0),this.a=$X,this.b=$g,this.c=$K,this.d=$x,this.tx=$Z,this.ty=$n,this._checkTransform()}$a($K,"laya.maths.Matrix");var $X=$K.prototype;return $X.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},$X._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},$X.setTranslate=function($X,$g){return this.tx=$X,this.ty=$g,this},$X.translate=function($X,$g){return this.tx+=$X,this.ty+=$g,this},$X.scale=function($X,$g){this.a*=$X,this.d*=$g,this.c*=$X,this.b*=$g,this.tx*=$X,this.ty*=$g,this.bTransform=!0},$X.rotate=function($X){var $g=Math.cos($X),$K=Math.sin($X),$x=this.a,$Z=this.c,$n=this.tx;this.a=$x*$g-this.b*$K,this.b=$x*$K+this.b*$g,this.c=$Z*$g-this.d*$K,this.d=$Z*$K+this.d*$g,this.tx=$n*$g-this.ty*$K,this.ty=$n*$K+this.ty*$g,this.bTransform=!0},$X.skew=function($X,$g){var $K=Math.tan($X),$x=Math.tan($g),$Z=this.a,$n=this.b;return this.a+=$x*this.c,this.b+=$x*this.d,this.c+=$K*$Z,this.d+=$K*$n,this},$X.invertTransformPoint=function($X){var $g=this.a,$K=this.b,$x=this.c,$Z=this.d,$n=this.tx,$W=$g*$Z-$K*$x,$v=$Z/$W,$T=-$K/$W,$G=-$x/$W,$c=$g/$W,$_=($x*this.ty-$Z*$n)/$W,$s=-($g*this.ty-$K*$n)/$W;return $X.setTo($v*$X.x+$G*$X.y+$_,$T*$X.x+$c*$X.y+$s)},$X.transformPoint=function($X){return $X.setTo(this.a*$X.x+this.c*$X.y+this.tx,this.b*$X.x+this.d*$X.y+this.ty)},$X.transformPointN=function($X){return $X.setTo(this.a*$X.x+this.c*$X.y,this.b*$X.x+this.d*$X.y)},$X.transformPointArray=function($X,$g){for(var $K=$X.length,$x=0;$x<$K;$x+=2){var $Z=$X[$x],$n=$X[$x+1];$g[$x]=this.a*$Z+this.c*$n+this.tx,$g[$x+1]=this.b*$Z+this.d*$n+this.ty}return $g},$X.transformPointArrayScale=function($X,$g){for(var $K=$X.length,$x=0;$x<$K;$x+=2){var $Z=$X[$x],$n=$X[$x+1];$g[$x]=this.a*$Z+this.c*$n,$g[$x+1]=this.b*$Z+this.d*$n}return $g},$X.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},$X.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},$X.invert=function(){var $X=this.a,$g=this.b,$K=this.c,$x=this.d,$Z=this.tx,$n=$X*$x-$g*$K;return this.a=$x/$n,this.b=-$g/$n,this.c=-$K/$n,this.d=$X/$n,this.tx=($K*this.ty-$x*$Z)/$n,this.ty=-($X*this.ty-$g*$Z)/$n,this},$X.setTo=function($X,$g,$K,$x,$Z,$n){return this.a=$X,this.b=$g,this.c=$K,this.d=$x,this.tx=$Z,this.ty=$n,this},$X.concat=function($X){var $g=this.a,$K=this.c,$x=this.tx;return this.a=$g*$X.a+this.b*$X.c,this.b=$g*$X.b+this.b*$X.d,this.c=$K*$X.a+this.d*$X.c,this.d=$K*$X.b+this.d*$X.d,this.tx=$x*$X.a+this.ty*$X.c+$X.tx,this.ty=$x*$X.b+this.ty*$X.d+$X.ty,this},$X.scaleEx=function($X,$g){var $K=this.a,$x=this.b,$Z=this.c,$n=this.d;0!==$x||0!==$Z?(this.a=$X*$K,this.b=$X*$x,this.c=$g*$Z):(this.a=$X*$K,this.b=0*$n,this.c=0*$K),this.d=$g*$n,this.bTransform=!0},$X.rotateEx=function($X){var $g=Math.cos($X),$K=Math.sin($X),$x=this.a,$Z=this.b,$n=this.c,$W=this.d;0!==$Z||0!==$n?(this.a=$g*$x+$K*$n,this.b=$g*$Z+$K*$W,this.c=-$K*$x+$g*$n,this.d=-$K*$Z+$g*$W):(this.a=$g*$x,this.b=$K*$W,this.c=-$K*$x,this.d=$g*$W),this.bTransform=!0},$X.clone=function(){var $X=$K.create();return $X.a=this.a,$X.b=this.b,$X.c=this.c,$X.d=this.d,$X.tx=this.tx,$X.ty=this.ty,$X.bTransform=this.bTransform,$X},$X.copyTo=function($X){return $X.a=this.a,$X.b=this.b,$X.c=this.c,$X.d=this.d,$X.tx=this.tx,$X.ty=this.ty,$X.bTransform=this.bTransform,$X},$X.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},$X.destroy=function(){if(!this.inPool){var $X=$K._cache;this.inPool=!0,$X._length||($X._length=0),($X[$X._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},$K.mul=function($X,$g,$K){var $x=$X.a,$Z=$X.b,$n=$X.c,$W=$X.d,$v=$X.tx,$T=$X.ty,$G=$g.a,$c=$g.b,$_=$g.c,$s=$g.d,$V=$g.tx,$A=$g.ty;return 0!==$c||0!==$_?($K.a=$x*$G+$Z*$_,$K.b=$x*$c+$Z*$s,$K.c=$n*$G+$W*$_,$K.d=$n*$c+$W*$s,$K.tx=$G*$v+$_*$T+$V,$K.ty=$c*$v+$s*$T+$A):($K.a=$x*$G,$K.b=$Z*$s,$K.c=$n*$G,$K.d=$W*$s,$K.tx=$G*$v+$V,$K.ty=$s*$T+$A),$K},$K.mul16=function($X,$g,$K){var $x=$X.a,$Z=$X.b,$n=$X.c,$W=$X.d,$v=$X.tx,$T=$X.ty,$G=$g.a,$c=$g.b,$_=$g.c,$s=$g.d,$V=$g.tx,$A=$g.ty;return 0!==$c||0!==$_?($K[0]=$x*$G+$Z*$_,$K[1]=$x*$c+$Z*$s,$K[4]=$n*$G+$W*$_,$K[5]=$n*$c+$W*$s,$K[12]=$G*$v+$_*$T+$V,$K[13]=$c*$v+$s*$T+$A):($K[0]=$x*$G,$K[1]=$Z*$s,$K[4]=$n*$G,$K[5]=$W*$s,$K[12]=$G*$v+$V,$K[13]=$s*$T+$A),$K},$K.mulPre=function($X,$g,$K,$x,$Z,$n,$W,$v){var $T=$X.a,$G=$X.b,$c=$X.c,$_=$X.d,$s=$X.tx,$V=$X.ty;return 0!==$K||0!==$x?($v.a=$T*$g+$G*$x,$v.b=$T*$K+$G*$Z,$v.c=$c*$g+$_*$x,$v.d=$c*$K+$_*$Z,$v.tx=$g*$s+$x*$V+$n,$v.ty=$K*$s+$Z*$V+$W):($v.a=$T*$g,$v.b=$G*$Z,$v.c=$c*$g,$v.d=$_*$Z,$v.tx=$g*$s+$n,$v.ty=$Z*$V+$W),$v},$K.mulPos=function($X,$g,$K,$x,$Z,$n,$W,$v){var $T=$X.a,$G=$X.b,$c=$X.c,$_=$X.d,$s=$X.tx,$V=$X.ty;return 0!==$G||0!==$c?($v.a=$g*$T+$K*$c,$v.b=$g*$G+$K*$_,$v.c=$x*$T+$Z*$c,$v.d=$x*$G+$Z*$_,$v.tx=$T*$n+$c*$W+$s,$v.ty=$G*$n+$_*$W+$V):($v.a=$g*$T,$v.b=$K*$_,$v.c=$x*$T,$v.d=$Z*$_,$v.tx=$T*$n+$s,$v.ty=$_*$W+$V),$v},$K.preMul=function($X,$g,$K){var $x=$X.a,$Z=$X.b,$n=$X.c,$W=$X.d,$v=$g.a,$T=$g.b,$G=$g.c,$c=$g.d,$_=$g.tx,$s=$g.ty;return $K.a=$v*$x,$K.b=$K.c=0,$K.d=$c*$W,$K.tx=$_*$x+$X.tx,$K.ty=$s*$W+$X.ty,0===$T&&0===$G&&0===$Z&&0===$n||($K.a+=$T*$n,$K.d+=$G*$Z,$K.b+=$v*$Z+$T*$W,$K.c+=$G*$x+$c*$n,$K.tx+=$s*$n,$K.ty+=$_*$Z),$K},$K.preMulXY=function($X,$g,$K,$x){var $Z=$X.a,$n=$X.b,$W=$X.c,$v=$X.d;return $x.a=$Z,$x.b=$n,$x.c=$W,$x.d=$v,$x.tx=$g*$Z+$X.tx+$K*$W,$x.ty=$K*$v+$X.ty+$g*$n,$x},$K.create=function(){var $X=$K._cache,$g=$X._length?$X[--$X._length]:new $K;return $g.inPool=!1,$g},$K.EMPTY=new $K,$K.TEMP=new $K,$K._cache=[],$K}(),$B=function(){function $X($X,$g){void 0===$X&&($X=0),void 0===$g&&($g=0),this.x=$X,this.y=$g}$a($X,"laya.maths.Point");var $g=$X.prototype;return $g.setTo=function($X,$g){return this.x=$X,this.y=$g,this},$g.distance=function($X,$g){return Math.sqrt((this.x-$X)*(this.x-$X)+(this.y-$g)*(this.y-$g))},$g.toString=function(){return this.x+","+this.y},$g.normalize=function(){var $X=Math.sqrt(this.x*this.x+this.y*this.y);if(0<$X){var $g=1/$X;this.x*=$g,this.y*=$g}},$X.TEMP=new $X,$X.EMPTY=new $X,$X}(),$i=function(){function $G($X,$g,$K,$x){void 0===$X&&($X=0),void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=0),this.x=$X,this.y=$g,this.width=$K,this.height=$x}$a($G,"laya.maths.Rectangle");var $X=$G.prototype;return $X.setTo=function($X,$g,$K,$x){return this.x=$X,this.y=$g,this.width=$K,this.height=$x,this},$X.copyFrom=function($X){return this.x=$X.x,this.y=$X.y,this.width=$X.width,this.height=$X.height,this},$X.contains=function($X,$g){return!(this.width<=0||this.height<=0)&&($X>=this.x&&$X<this.right&&$g>=this.y&&$g<this.bottom)},$X.intersects=function($X){return!($X.x>this.x+this.width||$X.x+$X.width<this.x||$X.y>this.y+this.height||$X.y+$X.height<this.y)},$X.intersection=function($X,$g){return this.intersects($X)?($g||($g=new $G),$g.x=Math.max(this.x,$X.x),$g.y=Math.max(this.y,$X.y),$g.width=Math.min(this.right,$X.right)-$g.x,$g.height=Math.min(this.bottom,$X.bottom)-$g.y,$g):null},$X.union=function($X,$g){return $g||($g=new $G),this.clone($g),$X.width<=0||$X.height<=0?$g:($g.addPoint($X.x,$X.y),$g.addPoint($X.right,$X.bottom),this)},$X.clone=function($X){return $X||($X=new $G),$X.x=this.x,$X.y=this.y,$X.width=this.width,$X.height=this.height,$X},$X.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},$X.equals=function($X){return!(!$X||$X.x!==this.x||$X.y!==this.y||$X.width!==this.width||$X.height!==this.height)},$X.addPoint=function($X,$g){return this.x>$X&&(this.width+=this.x-$X,this.x=$X),this.y>$g&&(this.height+=this.y-$g,this.y=$g),this.width<$X-this.x&&(this.width=$X-this.x),this.height<$g-this.y&&(this.height=$g-this.y),this},$X._getBoundPoints=function(){var $X=$G._temB;return($X.length=0)==this.width||0==this.height||$X.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),$X},$X.isEmpty=function(){return this.width<=0||this.height<=0},$c(0,$X,"right",function(){return this.x+this.width}),$c(0,$X,"bottom",function(){return this.y+this.height}),$G._getBoundPointS=function($X,$g,$K,$x){var $Z=$G._temA;return($Z.length=0)==$K||0==$x||$Z.push($X,$g,$X+$K,$g,$X,$g+$x,$X+$K,$g+$x),$Z},$G._getWrapRec=function($X,$g){if(!$X||$X.length<1)return $g?$g.setTo(0,0,0,0):$G.TEMP.setTo(0,0,0,0);$g=$g||new $G;var $K,$x,$Z,$n,$W,$v=$X.length,$T=$B.TEMP;for($Z=$W=-($x=$n=99999),$K=0;$K<$v;$K+=2)$T.x=$X[$K],$T.y=$X[$K+1],$x=$x<$T.x?$x:$T.x,$n=$n<$T.y?$n:$T.y,$Z=$Z>$T.x?$Z:$T.x,$W=$W>$T.y?$W:$T.y;return $g.setTo($x,$n,$Z-$x,$W-$n)},$G.EMPTY=new $G,$G.TEMP=new $G,$G._temB=[],$G._temA=[],$G}(),$r=function(){function $T(){}return $a($T,"laya.media.SoundManager"),$c(1,$T,"useAudioMusic",function(){return $T._useAudioMusic},function($X){$T._useAudioMusic=$X,$T._musicClass=$X?$KX:null}),$c(1,$T,"autoStopMusic",function(){return $T._autoStopMusic},function($X){$D.stage.off("blur",null,$T._stageOnBlur),$D.stage.off("focus",null,$T._stageOnFocus),$D.stage.off("visibilitychange",null,$T._visibilityChange),($T._autoStopMusic=$X)&&($D.stage.on("blur",null,$T._stageOnBlur),$D.stage.on("focus",null,$T._stageOnFocus),$D.stage.on("visibilitychange",null,$T._visibilityChange))}),$c(1,$T,"muted",function(){return $T._muted},function($X){$X!=$T._muted&&($X&&$T.stopAllSound(),$T.musicMuted=$X,$T._muted=$X)}),$c(1,$T,"musicMuted",function(){return $T._musicMuted},function($X){$X!=$T._musicMuted&&($X?($T._tMusic&&$T._musicChannel&&!$T._musicChannel.isStopped?$T._musicChannel.pause():$T._musicChannel=null,$T._musicMuted=$X):($T._musicMuted=$X,$T._tMusic&&$T._musicChannel&&$T._musicChannel.resume()))}),$c(1,$T,"soundMuted",function(){return $T._soundMuted},function($X){$T._soundMuted=$X}),$T.addChannel=function($X){0<=$T._channels.indexOf($X)||($T._channels.push($X),$T.autoReleaseSound&&0!=$T._notUsedCount&&$T._notUsedUrls[$X.url]&&(delete $T._notUsedUrls[$X.url],0==--$T._notUsedCount&&$D.timer.clear($T,$T.disposeSoundIfNotUsed)))},$T.removeChannel=function($X){var $g=$T._channels,$K=$g.indexOf($X);if(-1!=$K&&($g.splice($K,1),$T.autoReleaseSound)){var $x=$X.url,$Z=$T.defaultIntervals[$x]||2e4;if(0<$Z){var $n=!0;for($K=$g.length-1;0<=$K;$K--)if($g[$K].url==$x){$n=!1;break}$n&&($T._notUsedUrls[$x]=Date.now()+$Z,0==$T._notUsedCount++&&$D.timer.loop(1e4,$T,$T.disposeSoundIfNotUsed))}}},$T.disposeSoundIfNotUsed=function(){var $X=$T._notUsedUrls;if(0!=$T._notUsedCount){var $g=Date.now();for(var $K in $X)$g>=$X[$K]&&(delete $X[$K],--$T._notUsedCount,$T.destroySound($K));if(0!=$T._notUsedCount)return}$D.timer.clear($T,$T.disposeSoundIfNotUsed)},$T._visibilityChange=function(){$D.stage.isVisibility?$T._stageOnFocus():$T._stageOnBlur()},$T._stageOnBlur=function(){$T._isActive=!1,$T._musicChannel&&($T._musicChannel.isStopped||($T._blurPaused=!0,$T._musicChannel.pause())),$T.stopAllSound(),$D.stage.once("mousedown",null,$T._stageOnFocus)},$T._recoverWebAudio=function(){$nX.ctx&&"running"!=$nX.ctx.state&&$nX.ctx.resume&&$nX.ctx.resume()},$T._stageOnFocus=function(){if($T._isActive=!0,$T._recoverWebAudio(),$D.stage.off("mousedown",null,$T._stageOnFocus),$T._blurPaused){var $X=$T._musicChannel;$X&&$T._music&&$X.isStopped&&($T._blurPaused=!1,$T._music._disposed?$T.playMusic($X.url,$X.loops,$X.startHandler,$X.completeHandler,$X.startTime):$X.audioBuffer?$X.resume():$T._music.play($X.startTime,$X.loops,$X.startHandler,$X))}},$T.playSound=function($X,$g,$K,$x,$Z,$n){if(void 0===$g&&($g=1),void 0===$n&&($n=0),!$X)return null;if($T._muted)return null;if($T._recoverWebAudio(),$X==$T._tMusic){if($T._musicMuted)return null}else{if(!$T._isActive)return null;if($T._soundMuted)return null}var $W,$v=$T._pool[$X];return $Z||($Z=$T._soundClass),$v||(($v=new $Z).load($X),$T._pool[$X]=$v),($W=$v.play($n,$g,$K))?($X==$T._tMusic&&($T._music=$v,$T._isActive||($T._blurPaused=!0,$W.pause())),$W.url=$X,$W.volume=$X==$T._tMusic?$T.musicVolume:$T.soundVolume,$W.completeHandler=$x,$W):null},$T.destroySound=function($X){var $g=$T._pool[$X];$g&&(delete $T._pool[$X],$g.dispose())},$T.playMusic=function($X,$g,$K,$x,$Z){return void 0===$g&&($g=0),void 0===$Z&&($Z=0),$T._tMusic=$X,$T._musicChannel&&$T._musicChannel.stop(),$T._musicChannel=$T.playSound($X,$g,$K,$x,null,$Z)},$T.stopSound=function($X){for(var $g,$K=$T._channels.length-1;0<=$K;$K--)($g=$T._channels[$K]).url==$X&&$g.stop()},$T.stopAll=function(){$T._tMusic=null;var $X=0;for($X=$T._channels.length-1;0<=$X;$X--)$T._channels[$X].stop()},$T.stopAllSound=function(){var $X,$g=0;for($g=$T._channels.length-1;0<=$g;$g--)($X=$T._channels[$g]).url!=$T._tMusic&&$X.stop()},$T.stopMusic=function(){$T._musicChannel&&$T._musicChannel.stop(),$T._tMusic=null},$T.setSoundVolume=function($X,$g){if($g)$T._setVolume($g,$X);else{$T.soundVolume=$X;var $K,$x=0;for($x=$T._channels.length-1;0<=$x;$x--)($K=$T._channels[$x]).url!=$T._tMusic&&($K.volume=$X)}},$T.setMusicVolume=function($X){$T.musicVolume=$X,$T._setVolume($T._tMusic,$X)},$T._setVolume=function($X,$g){for(var $K,$x=$T._channels.length-1;0<=$x;$x--)($K=$T._channels[$x]).url==$X&&($K.volume=$g)},$T.musicVolume=1,$T.soundVolume=1,$T.playbackRate=1,$T._useAudioMusic=!0,$T._muted=!1,$T._soundMuted=!1,$T._musicMuted=!1,$T._tMusic=null,$T._musicChannel=null,$T._music=null,$T._channels=[],$T._autoStopMusic=!1,$T._blurPaused=!1,$T._isActive=!0,$T._soundClass=null,$T._musicClass=null,$T.autoReleaseSound=!0,$T._pool={},$T.defaultIntervals={},$T._notUsedUrls={},$T._notUsedCount=0,$T}(),$k=function(){var $X;function $K(){}return $a($K,"laya.net.LocalStorage"),$K.__init__=function(){$K._baseClass||($K._baseClass=$X).init(),$K.items=$K._baseClass.items,$K.support=$K._baseClass.support},$K.setItem=function($X,$g){$K._baseClass.setItem($X,$g)},$K.getItem=function($X){return $K._baseClass.getItem($X)},$K.setJSON=function($X,$g){$K._baseClass.setJSON($X,$g)},$K.getJSON=function($X){return $K._baseClass.getJSON($X)},$K.removeItem=function($X){$K._baseClass.removeItem($X)},$K.clear=function(){$K._baseClass.clear()},$K._baseClass=null,$K.items=null,$K.support=!1,$K.__init$=function(){$X=function(){function $K(){}return $a($K,""),$K.init=function(){try{$K.support=!0,$K.items=$W.localStorage,$K.setItem("laya","1"),$K.removeItem("laya")}catch($X){$K.support=!1}$K.support||console.log("LocalStorage is not supprot or browser is private mode.")},$K.setItem=function($X,$g){try{$K.support&&$K.items.setItem($X,$g)}catch($X){console.warn("set localStorage failed",$X)}},$K.getItem=function($X){return $K.support?$K.items.getItem($X):null},$K.setJSON=function($X,$g){try{$K.support&&$K.items.setItem($X,JSON.stringify($g))}catch($X){console.warn("set localStorage failed",$X)}},$K.getJSON=function($X){return JSON.parse($K.support?$K.items.getItem($X):null)},$K.removeItem=function($X){$K.support&&$K.items.removeItem($X)},$K.clear=function(){$K.support&&$K.items.clear()},$K.items=null,$K.support=!1,$K}()},$K}(),$P=(function(){function $x(){}$a($x,"laya.net.ResourceVersion"),$x.enable=function($X,$g,$K){void 0===$K&&($K=2),laya.net.ResourceVersion.type=$K,$D.loader.load($X,$U.create(null,$x.onManifestLoaded,[$g]),null,"json"),$N.customFormat=$x.addVersionPrefix},$x.onManifestLoaded=function($X,$g){$x.manifest=$g,$X.run(),$g||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},$x.addVersionPrefix=function($X){return $x.manifest&&$x.manifest[$X]?2==$x.type?$x.manifest[$X]:$x.manifest[$X]+"/"+$X:$X},$x.FOLDER_VERSION=1,$x.FILENAME_VERSION=2,$x.manifest=null,$x.type=1}(),function(){function $X(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}$a($X,"laya.net.TTFLoader");var $g=$X.prototype;return $g.load=function($X){var $g=(this._url=$X).split(".ttf")[0].split("/");this.fontName=$g[$g.length-1],$q.window.conch?this._loadConch():$q.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},$g._loadConch=function(){this._http=new $WX,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},$g._onHttpLoaded=function($X){$q.window.conch.setFontFaceFromBuffer(this.fontName,$X),this._clearHttp(),this._complete()},$g._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},$g._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},$g._complete=function(){$D.timer.clear(this,this._complete),$D.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},$g._checkComplete=function(){$t.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},$g._loadWithFontFace=function(){var $X=new $q.window.FontFace(this.fontName,"url('"+this._url+"')");$q.window.document.fonts.add($X);var $g=this;$X.loaded.then(function(){$g._complete()}),$X.load()},$g._createDiv=function(){this._div=$q.createElement("div"),this._div.innerHTML="laya";var $X=this._div.style;$X.fontFamily=this.fontName,$X.position="absolute",$X.left="-100px",$X.top="-100px",$q.document.body.appendChild(this._div)},$g._loadWithCSS=function(){var $X=this,$g=$q.createElement("style");$g.type="text/css",$q.document.body.appendChild($g),$g.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=$t.measureText("LayaTTFFont",this._fontTxt).width;var $K=this;$g.onload=function(){$D.timer.once(1e4,$K,$X._complete)},$D.timer.loop(20,this,this._checkComplete),this._createDiv()},$X._testString="LayaTTFFont",$X}()),$N=function(){function $x($X){this._url=null,this._path=null,this._url=$x.formatURL($X),this._path=$x.getPath($X)}$a($x,"laya.net.URL");var $X=$x.prototype;return $c(0,$X,"path",function(){return this._path}),$c(0,$X,"url",function(){return this._url}),$x.formatURL=function($X,$g){if(!$X)return"null path";if(0<$X.indexOf(":"))return $X;null!=$x.customFormat&&($X=$x.customFormat($X,$g));var $K=$X.charAt(0);if("."===$K)return $x.formatRelativePath(($g||$x.basePath)+$X);if("~"===$K)return $x.rootPath+$X.substring(1);if("d"===$K){if(0===$X.indexOf("data:image"))return $X}else if("/"===$K)return $X;return($g||$x.basePath)+$X},$x.formatRelativePath=function($X){for(var $g=$X.split("/"),$K=0,$x=$g.length;$K<$x;$K++)".."==$g[$K]&&($g.splice($K-1,2),$K-=2);return $g.join("/")},$x.isAbsolute=function($X){return 0<$X.indexOf(":")||"/"==$X.charAt(0)},$x.getPath=function($X){var $g=$X.lastIndexOf("/");return 0<$g?$X.substr(0,$g+1):""},$x.getFileName=function($X){var $g=$X.lastIndexOf("/");return 0<$g?$X.substr($g+1):$X},$x.version={},$x.basePath="",$x.rootPath="",$x.customFormat=function($X){var $g=$x.version[$X];return!$C.isConchApp&&$g&&($X+="?v="+$g),$X},$x}(),$C=function(){function $Z($X,$g){this._timeId=0;var $K=$Z._mainCanvas.source.style;$K.position="absolute",$K.top=$K.left="0px",$K.background="#000000",$Z._mainCanvas.source.id="layaCanvas";var $x=laya.renders.Render.isWebGL;$Z._mainCanvas.source.width=$X,$Z._mainCanvas.source.height=$g,$x&&$Z.WebGL.init($Z._mainCanvas,$X,$g),$q.container.appendChild($Z._mainCanvas.source),($Z._context=new $Y($X,$g,$x?null:$Z._mainCanvas)).ctx.setIsMainContext(),$q.window.requestAnimationFrame(function $X($g){$q.window.requestAnimationFrame($X);$D.stage._loop()}),$D.stage.on("visibilitychange",this,this._onVisibilitychange)}$a($Z,"laya.renders.Render");var $X=$Z.prototype;return $X._onVisibilitychange=function(){$D.stage.isVisibility?0!=this._timeId&&$q.window.clearInterval(this._timeId):this._timeId=$q.window.setInterval(this._enterFrame,1e3)},$X._enterFrame=function($X){$D.stage._loop()},$c(1,$Z,"context",function(){return $Z._context}),$c(1,$Z,"canvas",function(){return $Z._mainCanvas.source}),$Z._context=null,$Z._mainCanvas=null,$Z.WebGL=null,$Z.isConchNode=!1,$Z.isConchApp=!1,$Z.isConchWebGL=!1,$Z.isWebGL=!1,$Z.is3DMode=!1,$Z.optimizeTextureMemory=function($X,$g){return!0},$Z.__init$=function(){$W.ConchRenderType=$W.ConchRenderType||1,$W.ConchRenderType|=$W.conch?4:0,$Z.isConchNode=5==(5&$W.ConchRenderType),$Z.isConchApp=4==(4&$W.ConchRenderType),$Z.isConchWebGL=6==$W.ConchRenderType},$Z}(),$Y=function(){function $W($X,$g,$K){this.x=0,this.y=0,this._drawTexture=function($X,$g,$K){$K[0].loaded&&this.ctx.drawTexture($K[0],$K[1],$K[2],$K[3],$K[4],$X,$g)},this._fillTexture=function($X,$g,$K){$K[0].loaded&&this.ctx.fillTexture($K[0],$K[1]+$X,$K[2]+$g,$K[3],$K[4],$K[5],$K[6],$K[7])},this._drawTextureWithTransform=function($X,$g,$K){$K[0].loaded&&this.ctx.drawTextureWithTransform($K[0],$K[1],$K[2],$K[3],$K[4],$K[5],$X,$g,$K[6])},this._fillQuadrangle=function($X,$g,$K){this.ctx.fillQuadrangle($K[0],$K[1],$K[2],$K[3],$K[4])},this._drawRect=function($X,$g,$K){var $x=this.ctx;null!=$K[4]&&($x.fillStyle=$K[4],$x.fillRect($X+$K[0],$g+$K[1],$K[2],$K[3],null)),null!=$K[5]&&($x.strokeStyle=$K[5],$x.lineWidth=$K[6],$x.strokeRect($X+$K[0],$g+$K[1],$K[2],$K[3],$K[6]))},this._drawPie=function($X,$g,$K){var $x=this.ctx;$C.isWebGL&&$x.setPathId($K[8]),$x.beginPath(),$C.isWebGL?($x.movePath($K[0]+$X,$K[1]+$g),$x.moveTo(0,0)):$x.moveTo($X+$K[0],$g+$K[1]),$x.arc($X+$K[0],$g+$K[1],$K[2],$K[3],$K[4]),$x.closePath(),this._fillAndStroke($K[5],$K[6],$K[7],!0)},this._clipRect=function($X,$g,$K){this.ctx.clipRect($X+$K[0],$g+$K[1],$K[2],$K[3])},this._fillRect=function($X,$g,$K){this.ctx.fillRect($X+$K[0],$g+$K[1],$K[2],$K[3],$K[4])},this._drawCircle=function($X,$g,$K){var $x=this.ctx;$C.isWebGL&&$x.setPathId($K[6]),$d.drawCall++,$x.beginPath(),$C.isWebGL&&$x.movePath($K[0]+$X,$K[1]+$g),$x.arc($K[0]+$X,$K[1]+$g,$K[2],0,$W.PI2),$x.closePath(),this._fillAndStroke($K[3],$K[4],$K[5],!0)},this._fillCircle=function($X,$g,$K){$d.drawCall++;var $x=this.ctx;$x.beginPath(),$x.fillStyle=$K[3],$x.arc($K[0]+$X,$K[1]+$g,$K[2],0,$W.PI2),$x.fill()},this._setShader=function($X,$g,$K){this.ctx.setShader($K[0])},this._drawLine=function($X,$g,$K){var $x=this.ctx;$C.isWebGL&&$x.setPathId($K[6]),$x.beginPath(),$x.strokeStyle=$K[4],$x.lineWidth=$K[5],$C.isWebGL?($x.movePath($X,$g),$x.moveTo($K[0],$K[1]),$x.lineTo($K[2],$K[3])):($x.moveTo($X+$K[0],$g+$K[1]),$x.lineTo($X+$K[2],$g+$K[3])),$x.stroke()},this._drawLines=function($X,$g,$K){var $x=this.ctx;$C.isWebGL&&$x.setPathId($K[5]),$x.beginPath(),$X+=$K[0],$g+=$K[1],$C.isWebGL&&$x.movePath($X,$g),$x.strokeStyle=$K[3],$x.lineWidth=$K[4];var $Z=$K[2],$n=2,$W=$Z.length;if($C.isWebGL)for($x.moveTo($Z[0],$Z[1]);$n<$W;)$x.lineTo($Z[$n++],$Z[$n++]);else for($x.moveTo($X+$Z[0],$g+$Z[1]);$n<$W;)$x.lineTo($X+$Z[$n++],$g+$Z[$n++]);$x.stroke()},this._drawLinesWebGL=function($X,$g,$K){this.ctx.drawLines($X+this.x+$K[0],$g+this.y+$K[1],$K[2],$K[3],$K[4])},this._drawCurves=function($X,$g,$K){this.ctx.drawCurves($X,$g,$K)},this._draw=function($X,$g,$K){$K[0].call(null,this,$X,$g)},this._transformByMatrix=function($X,$g,$K){this.ctx.transformByMatrix($K[0])},this._setTransform=function($X,$g,$K){this.ctx.setTransform($K[0],$K[1],$K[2],$K[3],$K[4],$K[5])},this._setTransformByMatrix=function($X,$g,$K){this.ctx.setTransformByMatrix($K[0])},this._save=function($X,$g,$K){this.ctx.save()},this._restore=function($X,$g,$K){this.ctx.restore()},this._translate=function($X,$g,$K){this.ctx.translate($K[0],$K[1])},this._transform=function($X,$g,$K){this.ctx.translate($K[1]+$X,$K[2]+$g);var $x=$K[0];this.ctx.transform($x.a,$x.b,$x.c,$x.d,$x.tx,$x.ty),this.ctx.translate(-$X-$K[1],-$g-$K[2])},this._rotate=function($X,$g,$K){this.ctx.translate($K[1]+$X,$K[2]+$g),this.ctx.rotate($K[0]),this.ctx.translate(-$X-$K[1],-$g-$K[2])},this._scale=function($X,$g,$K){this.ctx.translate($K[2]+$X,$K[3]+$g),this.ctx.scale($K[0],$K[1]),this.ctx.translate(-$X-$K[2],-$g-$K[3])},this._alpha=function($X,$g,$K){this.ctx.globalAlpha*=$K[0]},this._setAlpha=function($X,$g,$K){this.ctx.globalAlpha=$K[0]},this._fillText=function($X,$g,$K){this.ctx.fillText($K[0],$K[1]+$X,$K[2]+$g,$K[3],$K[4],$K[5])},this._strokeText=function($X,$g,$K){this.ctx.strokeText($K[0],$K[1]+$X,$K[2]+$g,$K[3],$K[4],$K[5],$K[6])},this._fillBorderText=function($X,$g,$K){this.ctx.fillBorderText($K[0],$K[1]+$X,$K[2]+$g,$K[3],$K[4],$K[5],$K[6],$K[7])},this._blendMode=function($X,$g,$K){this.ctx.globalCompositeOperation=$K[0]},this._beginClip=function($X,$g,$K){this.ctx.beginClip&&this.ctx.beginClip($X+$K[0],$g+$K[1],$K[2],$K[3])},this._setIBVB=function($X,$g,$K){this.ctx.setIBVB($K[0]+$X,$K[1]+$g,$K[2],$K[3],$K[4],$K[5],$K[6],$K[7])},this._fillTrangles=function($X,$g,$K){this.ctx.fillTrangles($K[0],$K[1]+$X,$K[2]+$g,$K[3],$K[4])},this._drawPath=function($X,$g,$K){var $x=this.ctx;$C.isWebGL&&$x.setPathId(-1),$x.beginPath(),$X+=$K[0],$g+=$K[1],$C.isWebGL&&$x.movePath($X,$g);for(var $Z=$K[2],$n=0,$W=$Z.length;$n<$W;$n++){var $v=$Z[$n];switch($v[0]){case"moveTo":$C.isWebGL?$x.moveTo($v[1],$v[2]):$x.moveTo($X+$v[1],$g+$v[2]);break;case"lineTo":$C.isWebGL?$x.lineTo($v[1],$v[2]):$x.lineTo($X+$v[1],$g+$v[2]);break;case"arcTo":$C.isWebGL?$x.arcTo($v[1],$v[2],$v[3],$v[4],$v[5]):$x.arcTo($X+$v[1],$g+$v[2],$X+$v[3],$g+$v[4],$v[5]);break;case"closePath":$x.closePath()}}var $T=$K[3];null!=$T&&($x.fillStyle=$T.fillStyle,$x.fill());var $G=$K[4];null!=$G&&($x.strokeStyle=$G.strokeStyle,$x.lineWidth=$G.lineWidth||1,$x.lineJoin=$G.lineJoin,$x.lineCap=$G.lineCap,$x.miterLimit=$G.miterLimit,$x.stroke())},this.drawPoly=function($X,$g,$K){this.ctx.drawPoly($X+this.x+$K[0],$g+this.y+$K[1],$K[2],$K[3],$K[4],$K[5],$K[6])},this._drawPoly=function($X,$g,$K){var $x=this.ctx,$Z=$K[2],$n=2,$W=$Z.length;if($C.isWebGL)for($x.setPathId($K[6]),$x.beginPath(),$X+=$K[0],$g+=$K[1],$x.movePath($X,$g),$x.moveTo($Z[0],$Z[1]);$n<$W;)$x.lineTo($Z[$n++],$Z[$n++]);else for($x.beginPath(),$X+=$K[0],$g+=$K[1],$x.moveTo($X+$Z[0],$g+$Z[1]);$n<$W;)$x.lineTo($X+$Z[$n++],$g+$Z[$n++]);$x.closePath(),this._fillAndStroke($K[3],$K[4],$K[5],$K[7])},this._drawSkin=function($X,$g,$K){var $x=$K[0];if($x){var $Z=this.ctx;$x.render($Z,$X,$g)}},this._drawParticle=function($X,$g,$K){this.ctx.drawParticle($X+this.x,$g+this.y,$K[0])},this._setFilters=function($X,$g,$K){this.ctx.setFilters($K)},$K?this.ctx=$K.getContext("2d"):($K=$$X.create("3D"),this.ctx=$t.createWebGLContext2D($K),$K._setContext(this.ctx)),$K.size($X,$g),this.canvas=$K}$a($W,"laya.renders.RenderContext");var $X=$W.prototype;return $X.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},$X.drawTexture=function($X,$g,$K,$x,$Z){$X.loaded&&this.ctx.drawTexture($X,$g,$K,$x,$Z,this.x,this.y)},$X._drawTextures=function($X,$g,$K){$K[0].loaded&&this.ctx.drawTextures($K[0],$K[1],$X+this.x,$g+this.y)},$X.drawTextureWithTransform=function($X,$g,$K,$x,$Z,$n,$W){$X.loaded&&this.ctx.drawTextureWithTransform($X,$g,$K,$x,$Z,$n,this.x,this.y,$W)},$X.fillQuadrangle=function($X,$g,$K,$x,$Z){this.ctx.fillQuadrangle($X,$g,$K,$x,$Z)},$X.drawCanvas=function($X,$g,$K,$x,$Z){this.ctx.drawCanvas($X,$g+this.x,$K+this.y,$x,$Z)},$X.drawRect=function($X,$g,$K,$x,$Z,$n){void 0===$n&&($n=1);var $W=this.ctx;$W.strokeStyle=$Z,$W.lineWidth=$n,$W.strokeRect($X+this.x,$g+this.y,$K,$x,$n)},$X._fillAndStroke=function($X,$g,$K,$x){void 0===$x&&($x=!1);var $Z=this.ctx;null!=$X&&($Z.fillStyle=$X,$C.isWebGL?$Z.fill($x):$Z.fill()),null!=$g&&0<$K&&($Z.strokeStyle=$g,$Z.lineWidth=$K,$Z.stroke())},$X.clipRect=function($X,$g,$K,$x){this.ctx.clipRect($X+this.x,$g+this.y,$K,$x)},$X.fillRect=function($X,$g,$K,$x,$Z){this.ctx.fillRect($X+this.x,$g+this.y,$K,$x,$Z)},$X.drawCircle=function($X,$g,$K,$x,$Z){void 0===$Z&&($Z=1),$d.drawCall++;var $n=this.ctx;$n.beginPath(),$n.strokeStyle=$x,$n.lineWidth=$Z,$n.arc($X+this.x,$g+this.y,$K,0,$W.PI2),$n.stroke()},$X.drawTriangles=function($X,$g,$K){if($C.isWebGL)this.ctx.drawTriangles($K[0],$X+$K[1],$g+$K[2],$K[3],$K[4],$K[5],$K[6],$K[7],$K[8],$K[9]);else{var $x=$K[5],$Z=0,$n=$x.length,$W=this.ctx;for($Z=0;$Z<$n;$Z+=3){var $v=2*$x[$Z],$T=2*$x[$Z+1],$G=2*$x[$Z+2];$W.drawTriangle($K[0],$K[3],$K[4],$v,$T,$G,$K[6],!0)}}},$X.fillCircle=function($X,$g,$K,$x){$d.drawCall++;var $Z=this.ctx;$Z.beginPath(),$Z.fillStyle=$x,$Z.arc($X+this.x,$g+this.y,$K,0,$W.PI2),$Z.fill()},$X.setShader=function($X){this.ctx.setShader($X)},$X.drawLine=function($X,$g,$K,$x,$Z,$n){void 0===$n&&($n=1);var $W=this.ctx;$W.beginPath(),$W.strokeStyle=$Z,$W.lineWidth=$n,$W.moveTo(this.x+$X,this.y+$g),$W.lineTo(this.x+$K,this.y+$x),$W.stroke()},$X.clear=function(){this.ctx.clear()},$X.transformByMatrix=function($X){this.ctx.transformByMatrix($X)},$X.setTransform=function($X,$g,$K,$x,$Z,$n){this.ctx.setTransform($X,$g,$K,$x,$Z,$n)},$X.setTransformByMatrix=function($X){this.ctx.setTransformByMatrix($X)},$X.save=function(){this.ctx.save()},$X.restore=function(){this.ctx.restore()},$X.translate=function($X,$g){this.ctx.translate($X,$g)},$X.transform=function($X,$g,$K,$x,$Z,$n){this.ctx.transform($X,$g,$K,$x,$Z,$n)},$X.rotate=function($X){this.ctx.rotate($X)},$X.scale=function($X,$g){this.ctx.scale($X,$g)},$X.alpha=function($X){this.ctx.globalAlpha*=$X},$X.setAlpha=function($X){this.ctx.globalAlpha=$X},$X.fillWords=function($X,$g,$K,$x,$Z,$n){void 0===$n&&($n=0),this.ctx.fillWords($X,$g,$K,$x,$Z,$n)},$X.fillBorderWords=function($X,$g,$K,$x,$Z,$n,$W){this.ctx.fillBorderWords($X,$g,$K,$x,$Z,$n,$W)},$X.fillText=function($X,$g,$K,$x,$Z,$n){this.ctx.fillText($X,$g+this.x,$K+this.y,$x,$Z,$n)},$X.strokeText=function($X,$g,$K,$x,$Z,$n,$W){this.ctx.strokeText($X,$g+this.x,$K+this.y,$x,$Z,$n,$W)},$X.blendMode=function($X){this.ctx.globalCompositeOperation=$X},$X.flush=function(){this.ctx.flush&&this.ctx.flush()},$X.addRenderObject=function($X){this.ctx.addRenderObject($X)},$X.beginClip=function($X,$g,$K,$x){this.ctx.beginClip&&this.ctx.beginClip($X,$g,$K,$x)},$X.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},$X.fillTrangles=function($X,$g,$K){this.ctx.fillTrangles($K[0],$K[1],$K[2],$K[3],4<$K.length?$K[4]:null)},$W.PI2=2*Math.PI,$W}(),$l=function(){function $W($X,$g){switch(this._next=$g||$W.NORENDER,$X){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=$F._filter);case 69905:return void(this._fun=$W._initRenderFun)}this.onCreate($X)}$a($W,"laya.renders.RenderSprite");var $X=$W.prototype;return $X.onCreate=function($X){},$X._style=function($X,$g,$K,$x){$X._style.render($X,$g,$K,$x);var $Z=this._next;$Z._fun.call($Z,$X,$g,$K,$x)},$X._no=function($X,$g,$K,$x){},$X._custom=function($X,$g,$K,$x){$X.customRender($g,$K,$x);var $Z=$X._style._tf;this._next._fun.call(this._next,$X,$g,$K-$Z.translateX,$x-$Z.translateY)},$X._clip=function($X,$g,$K,$x){var $Z=this._next;if($Z!=$W.NORENDER){var $n=$X._style.scrollRect;$g.ctx.save(),$g.ctx.clipRect($K,$x,$n.width,$n.height),$Z._fun.call($Z,$X,$g,$K-$n.x,$x-$n.y),$g.ctx.restore()}},$X._blend=function($X,$g,$K,$x){var $Z=$X._style;$Z.blendMode&&($g.ctx.globalCompositeOperation=$Z.blendMode);var $n=this._next;$n._fun.call($n,$X,$g,$K,$x),$g.ctx.globalCompositeOperation="source-over"},$X._mask=function($X,$g,$K,$x){var $Z=this._next;$Z._fun.call($Z,$X,$g,$K,$x);var $n=$X.mask;$n&&($g.ctx.globalCompositeOperation="destination-in",(0<$n.numChildren||!$n.graphics._isOnlyOne())&&($n.cacheAsBitmap=!0),$n.render($g,$K-$X.pivotX,$x-$X.pivotY)),$g.ctx.globalCompositeOperation="source-over"},$X._graphics=function($X,$g,$K,$x){var $Z=$X._style._tf;$X._graphics&&$X._graphics._render($X,$g,$K-$Z.translateX,$x-$Z.translateY);var $n=this._next;$n._fun.call($n,$X,$g,$K,$x)},$X._image=function($X,$g,$K,$x){var $Z=$X._style;$g.ctx.drawTexture2($K,$x,$Z._tf.translateX,$Z._tf.translateY,$X.transform,$Z.alpha,$Z.blendMode,$X._graphics._one)},$X._image2=function($X,$g,$K,$x){var $Z=$X._style._tf;$g.ctx.drawTexture2($K,$x,$Z.translateX,$Z.translateY,$X.transform,1,null,$X._graphics._one)},$X._alpha=function($X,$g,$K,$x){var $Z;if(.01<($Z=$X._style.alpha)||$X._needRepaint()){var $n=$g.ctx.globalAlpha;$g.ctx.globalAlpha*=$Z;var $W=this._next;$W._fun.call($W,$X,$g,$K,$x),$g.ctx.globalAlpha=$n}},$X._transform=function($X,$g,$K,$x){var $Z=$X.transform,$n=this._next;$Z&&$n!=$W.NORENDER?($g.save(),$g.transform($Z.a,$Z.b,$Z.c,$Z.d,$Z.tx+$K,$Z.ty+$x),$n._fun.call($n,$X,$g,0,0),$g.restore()):$n._fun.call($n,$X,$g,$K,$x)},$X._childs=function($X,$g,$K,$x){var $Z=$X._style,$n=$Z._tf;if($K=$K-$n.translateX+$Z.paddingLeft,$x=$x-$n.translateY+$Z.paddingTop,$Z._calculation){var $W=$X._getWords();if($W){var $v=$Z;$v&&($v.stroke?$g.fillBorderWords($W,$K,$x,$v.font,$v.color,$v.strokeColor,$v.stroke):$g.fillWords($W,$K,$x,$v.font,$v.color,"none"!=$v.textDecoration&&$v.underLine?1:0))}}var $T,$G=$X._childs,$c=$G.length;if($X.viewport||$X.optimizeScrollRect&&$X._style.scrollRect){var $_=$X.viewport||$X._style.scrollRect,$s=$_.x,$V=$_.y,$A=$_.right,$a=$_.bottom,$m=NaN,$F=NaN;for($U=0;$U<$c;++$U)($T=$G[$U]).visible&&($m=$T._x)<$A&&$m+$T.width>$s&&($F=$T._y)<$a&&$F+$T.height>$V&&$T.render($g,$K,$x)}else for(var $U=0;$U<$c;++$U)($T=$G[$U])._style.visible&&$T.render($g,$K,$x)},$X._canvas=function($X,$g,$K,$x){var $Z=$X._$P.cacheCanvas;if($Z){"bitmap"===$Z.type?$d.canvasBitmap++:$d.canvasNormal++;var $n=$Z.ctx;if($X._needRepaint()||!$n)this._canvas_repaint($X,$g,$K,$x);else{var $W=$Z._cacheRec;$g.drawCanvas($n.canvas,$K+$W.x,$x+$W.y,$W.width,$W.height)}}else this._next._fun.call(this._next,$X,$g,$K,$x)},$X._canvas_repaint=function($X,$g,$K,$x){var $Z=$X._$P.cacheCanvas,$n=this._next;if($Z){var $W,$v,$T,$G,$c=$Z.ctx,$_=$X._needRepaint()||!$c,$s=$Z.type;if("bitmap"===$s?$d.canvasBitmap++:$d.canvasNormal++,$_){var $V,$A;$Z._cacheRec||($Z._cacheRec=new $i),$C.isWebGL&&"bitmap"!==$s?$Z._cacheRec.setTo(-$X.pivotX,-$X.pivotY,1,1):(($G=$X.getSelfBounds()).x=$G.x-$X.pivotX,$G.y=$G.y-$X.pivotY,$G.x=$G.x-16,$G.y=$G.y-16,$G.width=$G.width+32,$G.height=$G.height+32,$G.x=Math.floor($G.x+$K)-$K,$G.y=Math.floor($G.y+$x)-$x,$G.width=Math.floor($G.width),$G.height=Math.floor($G.height),$Z._cacheRec.copyFrom($G)),$G=$Z._cacheRec;var $a,$m=$C.isWebGL?1:$q.pixelRatio*$D.stage.clientScaleX,$F=$C.isWebGL?1:$q.pixelRatio*$D.stage.clientScaleY;if(!$C.isWebGL){var $U,$$=1,$w=1;for($U=$X;$U&&$U!=$D.stage;)$$*=$U.scaleX,$w*=$U.scaleY,$U=$U.parent;$C.isWebGL?($$<1&&($m*=$$),$w<1&&($F*=$w)):(1<$$&&($m*=$$),1<$w&&($F*=$w))}if($X.scrollRect){var $Q=$X.scrollRect;$G.x-=$Q.x,$G.y-=$Q.y}if($V=$G.width*$m,$A=$G.height*$F,$v=$G.x,$T=$G.y,$C.isWebGL&&"bitmap"===$s&&(2048<$V||2048<$A))return console.warn("cache bitmap size larger than 2048,cache ignored"),$Z.ctx&&($j.recover("RenderContext",$Z.ctx),$Z.ctx.canvas.size(0,0),$Z.ctx=null),void $n._fun.call($n,$X,$g,$K,$x);if($c||($c=$Z.ctx=$j.getItem("RenderContext")||new $Y($V,$A,$$X.create("AUTO"))),$c.ctx.sprite=$X,($W=$c.canvas).clear(),($W.width!=$V||$W.height!=$A)&&$W.size($V,$A),"bitmap"===$s?$W.context.asBitmap=!0:"normal"===$s&&($W.context.asBitmap=!1),1!=$m||1!=$F){var $f=$c.ctx;$f.save(),$f.scale($m,$F),!$C.isConchWebGL&&$C.isConchApp&&($a=$X._$P.cf)&&$f.setFilterMatrix&&$f.setFilterMatrix($a._mat,$a._alpha),$n._fun.call($n,$X,$c,-$v,-$T),$f.restore(),$C.isConchApp&&!$C.isConchWebGL||$X._applyFilters()}else $f=$c.ctx,!$C.isConchWebGL&&$C.isConchApp&&($a=$X._$P.cf)&&$f.setFilterMatrix&&$f.setFilterMatrix($a._mat,$a._alpha),$n._fun.call($n,$X,$c,-$v,-$T),$C.isConchApp&&!$C.isConchWebGL||$X._applyFilters();$X._$P.staticCache&&($Z.reCache=!1),$d.canvasReCache++}else $v=($G=$Z._cacheRec).x,$T=$G.y,$W=$c.canvas;$g.drawCanvas($W,$K+$v,$x+$T,$G.width,$G.height)}else $n._fun.call($n,$X,$c,$K,$x)},$W.__init__=function(){var $X,$g,$K=0;for($g=$t.createRenderSprite(69905,null),$X=$W.renders.length=4096,$K=0;$K<$X;$K++)$W.renders[$K]=$g;$W.renders[0]=$t.createRenderSprite(0,null),function($X,$g){for(var $K=0,$x=0;$x<$X.length;$x++)$K|=$X[$x],$W.renders[$K]=$g}([1,512,4,2],new $W(1,null)),$W.renders[513]=$t.createRenderSprite(513,null),$W.renders[517]=new $W(517,null)},$W._initRenderFun=function($X,$g,$K,$x){var $Z=$X._renderType;($W.renders[$Z]=$W._getTypeRender($Z))._fun($X,$g,$K,$x)},$W._getTypeRender=function($X){for(var $g=null,$K=2048;1<$K;)$K&$X&&($g=$t.createRenderSprite($K,$g)),$K>>=1;return $g},$W.IMAGE=1,$W.ALPHA=2,$W.TRANSFORM=4,$W.BLEND=8,$W.CANVAS=16,$W.FILTERS=32,$W.MASK=64,$W.CLIP=128,$W.STYLE=256,$W.GRAPHICS=512,$W.CUSTOM=1024,$W.CHILDS=2048,$W.INIT=69905,$W.renders=[],$W.NORENDER=new $W(0,null),$W}(),$p=function(){function $v(){this._repaint=!1}$a($v,"laya.resource.Context");var $X=$v.prototype;return $X.replaceReset=function(){var $X,$g,$K=0;for($X=$v.replaceKeys.length,$K=0;$K<$X;$K++)$g=$v.replaceKeys[$K],this[$v.newKeys[$K]]=this[$g]},$X.replaceResotre=function(){this.__restore(),this.__reset()},$X.setIsMainContext=function(){},$X.drawTextures=function($X,$g,$K,$x){$d.drawCall+=$g.length/2;for(var $Z=$X.width,$n=$X.height,$W=0,$v=$g.length;$W<$v;$W+=2)this.drawTexture($X,$g[$W],$g[$W+1],$Z,$n,$K,$x)},$X.drawCanvas=function($X,$g,$K,$x,$Z){$d.drawCall++,this.drawImage($X.source,$g,$K,$x,$Z)},$X.fillRect=function($X,$g,$K,$x,$Z){$d.drawCall++,$Z&&(this.fillStyle=$Z),this.__fillRect($X,$g,$K,$x)},$X.fillText=function($X,$g,$K,$x,$Z,$n){$d.drawCall++,3<arguments.length&&null!=$x&&(this.font=$x,this.fillStyle=$Z,this.textAlign=$n,this.textBaseline="top"),this.__fillText($X,$g,$K)},$X.fillBorderText=function($X,$g,$K,$x,$Z,$n,$W,$v){$d.drawCall++,this.font=$x,this.fillStyle=$Z,this.textBaseline="top",this.strokeStyle=$n,this.lineWidth=$W,this.textAlign=$v,this.__strokeText($X,$g,$K),this.__fillText($X,$g,$K)},$X.strokeText=function($X,$g,$K,$x,$Z,$n,$W){$d.drawCall++,3<arguments.length&&null!=$x&&(this.font=$x,this.strokeStyle=$Z,this.lineWidth=$n,this.textAlign=$W,this.textBaseline="top"),this.__strokeText($X,$g,$K)},$X.transformByMatrix=function($X){this.transform($X.a,$X.b,$X.c,$X.d,$X.tx,$X.ty)},$X.setTransformByMatrix=function($X){this.setTransform($X.a,$X.b,$X.c,$X.d,$X.tx,$X.ty)},$X.clipRect=function($X,$g,$K,$x){$d.drawCall++,this.beginPath(),this.rect($X,$g,$K,$x),this.clip()},$X.drawTexture=function($X,$g,$K,$x,$Z,$n,$W){$d.drawCall++;var $v=$X.uv,$T=$X.bitmap.width,$G=$X.bitmap.height;this.drawImage($X.source,$v[0]*$T,$v[1]*$G,($v[2]-$v[0])*$T,($v[5]-$v[3])*$G,$g+$n,$K+$W,$x,$Z)},$X.drawTextureWithTransform=function($X,$g,$K,$x,$Z,$n,$W,$v,$T){$d.drawCall++;var $G=$X.uv,$c=$X.bitmap.width,$_=$X.bitmap.height;this.save(),1!=$T&&(this.globalAlpha*=$T),$n?(this.transform($n.a,$n.b,$n.c,$n.d,$n.tx+$W,$n.ty+$v),this.drawImage($X.source,$G[0]*$c,$G[1]*$_,($G[2]-$G[0])*$c,($G[5]-$G[3])*$_,$g,$K,$x,$Z)):this.drawImage($X.source,$G[0]*$c,$G[1]*$_,($G[2]-$G[0])*$c,($G[5]-$G[3])*$_,$g+$W,$K+$v,$x,$Z),this.restore()},$X.drawTexture2=function($X,$g,$K,$x,$Z,$n,$W,$v){var $T=$v[0];if($T.loaded&&$T.bitmap&&$T.source){$d.drawCall++;var $G=1!==$n;if($G){var $c=this.globalAlpha;this.globalAlpha*=$n}var $_=$T.uv,$s=$T.bitmap.width,$V=$T.bitmap.height;$Z?(this.save(),this.transform($Z.a,$Z.b,$Z.c,$Z.d,$Z.tx+$X,$Z.ty+$g),this.drawImage($T.source,$_[0]*$s,$_[1]*$V,($_[2]-$_[0])*$s,($_[5]-$_[3])*$V,$v[1]-$K,$v[2]-$x,$v[3],$v[4]),this.restore()):this.drawImage($T.source,$_[0]*$s,$_[1]*$V,($_[2]-$_[0])*$s,($_[5]-$_[3])*$V,$v[1]-$K+$X,$v[2]-$x+$g,$v[3],$v[4]),$G&&(this.globalAlpha=$c)}},$X.fillTexture=function($X,$g,$K,$x,$Z,$n,$W,$v){if(!$v.pat){if($X.uv!=$cX.DEF_UV){var $T=new $$X("2D");$T.getContext("2d"),$T.size($X.width,$X.height),$T.context.drawTexture($X,0,0,$X.width,$X.height,0,0),$X=new $cX($T)}$v.pat=this.createPattern($X.bitmap.source,$n)}var $G=$g,$c=$K,$_=0,$s=0;$W&&($G+=$W.x%$X.width,$c+=$W.y%$X.height,$_-=$W.x%$X.width,$s-=$W.y%$X.height),this.translate($G,$c),this.fillRect($_,$s,$x,$Z,$v.pat),this.translate(-$G,-$c)},$X.drawTriangle=function($X,$g,$K,$x,$Z,$n,$W,$v){var $T=$X.bitmap,$G=$T.source,$c=$X.width,$_=$X.height,$s=$T.width,$V=$T.height,$A=$K[$x]*$s,$a=$K[$Z]*$s,$m=$K[$n]*$s,$F=$K[$x+1]*$V,$U=$K[$Z+1]*$V,$$=$K[$n+1]*$V,$w=$g[$x],$Q=$g[$Z],$f=$g[$n],$D=$g[$x+1],$B=$g[$Z+1],$i=$g[$n+1];if($v){var $k=($w+$Q+$f)/3,$I=($D+$B+$i)/3,$r=$w-$k,$t=$D-$I,$M=Math.sqrt($r*$r+$t*$t);$w=$k+$r/$M*($M+1),$D=$I+$t/$M*($M+1),$t=$B-$I,$Q=$k+($r=$Q-$k)/($M=Math.sqrt($r*$r+$t*$t))*($M+1),$B=$I+$t/$M*($M+1),$t=$i-$I,$f=$k+($r=$f-$k)/($M=Math.sqrt($r*$r+$t*$t))*($M+1),$i=$I+$t/$M*($M+1)}this.save(),$W&&this.transform($W.a,$W.b,$W.c,$W.d,$W.tx,$W.ty),this.beginPath(),this.moveTo($w,$D),this.lineTo($Q,$B),this.lineTo($f,$i),this.closePath(),this.clip();var $P=1/($A*$U+$F*$m+$a*$$-$U*$m-$F*$a-$A*$$),$N=$w*$U+$F*$f+$Q*$$-$U*$f-$F*$Q-$w*$$,$C=$A*$Q+$w*$m+$a*$f-$Q*$m-$w*$a-$A*$f,$Y=$A*$U*$f+$F*$Q*$m+$w*$a*$$-$w*$U*$m-$F*$a*$f-$A*$Q*$$,$l=$D*$U+$F*$i+$B*$$-$U*$i-$F*$B-$D*$$,$p=$A*$B+$D*$m+$a*$i-$B*$m-$D*$a-$A*$i,$L=$A*$U*$i+$F*$B*$m+$D*$a*$$-$D*$U*$m-$F*$a*$i-$A*$B*$$;this.transform($N*$P,$l*$P,$C*$P,$p*$P,$Y*$P,$L*$P),this.drawImage($G,$X.uv[0]*$s,$X.uv[1]*$V,$c,$_,$X.uv[0]*$s,$X.uv[1]*$V,$c,$_),this.restore()},$X.flush=function(){return 0},$X.fillWords=function($X,$g,$K,$x,$Z,$n){$x&&(this.font=$x),$Z&&(this.fillStyle=$Z);this.textBaseline="top",this.textAlign="left";for(var $W=0,$v=$X.length;$W<$v;$W++){var $T=$X[$W];if(this.__fillText($T.char,$T.x+$g,$T.y+$K),1===$n){var $G=$T.height,$c=.5*$T.style.letterSpacing;$c||($c=0),this.beginPath(),this.strokeStyle=$Z,this.lineWidth=1,this.moveTo($g+$T.x-$c+.5,$K+$T.y+$G+.5),this.lineTo($g+$T.x+$T.width+$c+.5,$K+$T.y+$G+.5),this.stroke()}}},$X.fillBorderWords=function($X,$g,$K,$x,$Z,$n,$W){$x&&(this.font=$x),$Z&&(this.fillStyle=$Z),this.textBaseline="top",this.lineWidth=$W,this.textAlign="left",this.strokeStyle=$n;for(var $v=0,$T=$X.length;$v<$T;$v++){var $G=$X[$v];this.__strokeText($G.char,$G.x+$g,$G.y+$K),this.__fillText($G.char,$G.x+$g,$G.y+$K)}},$X.destroy=function(){this.canvas.width=this.canvas.height=0},$X.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},$X.drawCurves=function($X,$g,$K){this.beginPath(),this.strokeStyle=$K[3],this.lineWidth=$K[4];var $x=$K[2];$X+=$K[0],$g+=$K[1],this.moveTo($X+$x[0],$g+$x[1]);for(var $Z=2,$n=$x.length;$Z<$n;)this.quadraticCurveTo($X+$x[$Z++],$g+$x[$Z++],$X+$x[$Z++],$g+$x[$Z++]);this.stroke()},$v.__init__=function($g){var $K=laya.resource.Context.prototype;if(!($g=$g||CanvasRenderingContext2D.prototype).inited){$g.inited=!0,$g.__fillText=$g.fillText,$g.__fillRect=$g.fillRect,$g.__strokeText=$g.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function($X){$g[$X]=$K[$X]})}},$v.replaceCanvasGetSet=function($X,$g){var $K=Object.getOwnPropertyDescriptor($X,$g);if(!$K||!$K.configurable)return!1;var $x,$Z={};for($x in $K)"set"!=$x&&($Z[$x]=$K[$x]);var $n=$K.set;return $Z.set=function($X){$n.call(this,$X);var $g=this.getContext("2d");$g&&"__reset"in $g&&$g.__reset()},Object.defineProperty($X,$g,$Z),!0},$v.replaceGetSet=function($X,$g){var $K=Object.getOwnPropertyDescriptor($X,$g);if(!$K||!$K.configurable)return!1;var $x,$Z={};for($x in $K)"set"!=$x&&($Z[$x]=$K[$x]);var $n=$K.set,$W="___"+$g+"__";return $v.newKeys.push($W),$Z.set=function($X){$X!=this[$W]&&(this[$W]=$X,$n.call(this,$X))},Object.defineProperty($X,$g,$Z),!0},$v._default=new $v,$v.newKeys=[],$T($v,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),$v}(),$L=function(){function $n($X){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++$n._uniqueIDCounter,this._name=$X||"Content Manager",$n._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,$n._resourceManagers.push(this),this._resources=[],this._records={}}$a($n,"laya.resource.ResourceManager");var $X=$n.prototype;return $D.imps($X,{"laya.resource.IDispose":!0}),$X.getResourceByIndex=function($X){return this._resources[$X]},$X.getResourcesLength=function(){return this._resources.length},$X.addResource=function($X){return $X.resourceManager&&$X.resourceManager.removeResource($X),-1===this._resources.indexOf($X)&&(($X._resourceManager=this)._resources.push($X),this.addRecord($X.uri,$X.__className,$X.memorySize),this.addSize($X.memorySize),!0)},$X.removeResource=function($X){var $g=this._resources.indexOf($X);return-1!==$g&&(this._resources.splice($g,1),$X._resourceManager=null,this._memorySize-=$X.memorySize,this.addRecord($X.uri,$X.__className,-$X.memorySize),!0)},$X.unload=function(){for(var $X=this._resources.slice(0,this._resources.length),$g=0;$g<$X.length;$g++){$X[$g].destroy()}$X.length=0},$X.dispose=function(){if(this===$n._systemResourceManager)throw new Error("systemResourceManager不能被释放！");$n._resourceManagers.splice($n._resourceManagers.indexOf(this),1),$n._isResourceManagersSorted=!1;for(var $X=this._resources.slice(0,this._resources.length),$g=0;$g<$X.length;$g++){var $K=$X[$g];$K.resourceManager.removeResource($K),$K.destroy()}$X.length=0},$X.addSize=function($X){$X&&(this.autoRelease&&0<$X&&this._memorySize+$X>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=$X)},$X.addRecord=function($X,$g,$K){DEBUG&&$K&&!$X&&console.error($X,$g,$K)},$X.garbageCollection=function($X){var $g=this._resources;($g=$g.slice()).sort(function($X,$g){if(!$X||!$g)throw new Error("a或b不能为空！");return $X.released&&$g.released?0:$X.released?1:$g.released?-1:$X._lastUseFrameCount-$g._lastUseFrameCount});for(var $K=$d.loopCount,$x=0,$Z=$g.length;$x<$Z;$x++){var $n=$g[$x];if(!(1<$K-$n._lastUseFrameCount))return void(this._memorySize>=$X&&(this._isOverflow=!0));if($n.releaseResource(),this._memorySize<$X)return void(this._isOverflow=!1)}},$c(0,$X,"id",function(){return this._id}),$c(0,$X,"name",function(){return this._name},function($X){!$X&&""===$X||this._name===$X||(this._name=$X,$n._isResourceManagersSorted=!1)}),$c(0,$X,"memorySize",function(){return this._memorySize}),$c(0,$X,"records",function(){return this._records}),$c(1,$n,"systemResourceManager",function(){return $n._systemResourceManager}),$n.__init__=function(){$n.currentResourceManager=$n.systemResourceManager},$n.getLoadedResourceManagerByIndex=function($X){return $n._resourceManagers[$X]},$n.getLoadedResourceManagersCount=function(){return $n._resourceManagers.length},$n.recreateContentManagers=function($X){void 0===$X&&($X=!1);for(var $g=$n.currentResourceManager,$K=0;$K<$n._resourceManagers.length;$K++){$n.currentResourceManager=$n._resourceManagers[$K];for(var $x=0;$x<$n.currentResourceManager._resources.length;$x++)$n.currentResourceManager._resources[$x].releaseResource($X),$n.currentResourceManager._resources[$x].activeResource($X)}$n.currentResourceManager=$g},$n.releaseContentManagers=function($X){void 0===$X&&($X=!1);for(var $g=$n.currentResourceManager,$K=0;$K<$n._resourceManagers.length;$K++){$n.currentResourceManager=$n._resourceManagers[$K];for(var $x=0;$x<$n.currentResourceManager._resources.length;$x++){var $Z=$n.currentResourceManager._resources[$x];!$Z.released&&$Z.releaseResource($X)}}$n.currentResourceManager=$g},$n._uniqueIDCounter=0,$n._isResourceManagersSorted=!1,$n._resourceManagers=[],$T($n,["_systemResourceManager",function(){return this._systemResourceManager=new $n("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=$n._systemResourceManager}]),$n}(),$q=(function(){function $X(){}$a($X,"laya.system.System"),$X.changeDefinition=function($X,$g){$D[$X]=$g;var $K=$X+"=classObj";$D._runScript($K)},$X.__init__=function(){$C.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function $K(){}return $a($K,"laya.utils.Browser"),$c(1,$K,"pixelRatio",function(){return $K.__init__(),-1<$K.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:$t.getPixelRatio()}),$c(1,$K,"height",function(){return $K.__init__(),($D.stage&&$D.stage.canvasRotation?$K.clientWidth:$K.clientHeight)*$K.pixelRatio}),$c(1,$K,"clientWidth",function(){return $K.__init__(),$K.window.innerWidth||$K.document.body.clientWidth}),$c(1,$K,"window",function(){return $K.__init__(),$K._window}),$c(1,$K,"clientHeight",function(){return $K.__init__(),$K.window.innerHeight||$K.document.body.clientHeight||$K.document.documentElement.clientHeight}),$c(1,$K,"width",function(){return $K.__init__(),($D.stage&&$D.stage.canvasRotation?$K.clientHeight:$K.clientWidth)*$K.pixelRatio}),$c(1,$K,"container",function(){return $K.__init__(),$K._container||(($K._container=$K.createElement("div")).id="layaContainer",$K.document.body.appendChild($K._container)),$K._container},function($X){$K._container=$X}),$c(1,$K,"document",function(){return $K.__init__(),$K._document}),$K.__init__=function(){if(!$K._window){$K._window=$t.getWindow(),$K._document=$K.window.document,$K._window.addEventListener("message",function($X){laya.utils.Browser._onMessage($X)},!1),$K.document.__createElement=$K.document.createElement,$W.requestAnimationFrame=$W.requestAnimationFrame||$W.webkitRequestAnimationFrame||$W.mozRequestAnimationFrame||$W.oRequestAnimationFrame||$W.msRequestAnimationFrame||function($X){return $W.setTimeout($X,1e3/60)};var $X=$W.document.body.style;$X["-webkit-user-select"]="none",$X["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",$K.userAgent=$K.window.navigator.userAgent,$K.onIOS=!!($K.u=$K.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),$K.onMobile=-1<$K.u.indexOf("Mobile"),$K.onIPhone=-1<$K.u.indexOf("iPhone"),$K.onMac=-1<$K.u.indexOf("Mac OS X"),$K.onIPad=-1<$K.u.indexOf("iPad"),$K.onAndroid=-1<$K.u.indexOf("Android")||-1<$K.u.indexOf("Adr"),$K.onWP=-1<$K.u.indexOf("Windows Phone"),$K.onQQBrowser=-1<$K.u.indexOf("QQBrowser"),$K.onMQQBrowser=-1<$K.u.indexOf("MQQBrowser")||-1<$K.u.indexOf("Mobile")&&-1<$K.u.indexOf("QQ"),$K.onIE=!!$K.window.ActiveXObject||"ActiveXObject"in $K.window,$K.onWeiXin=-1<$K.u.indexOf("MicroMessenger"),$K.onPC=!$K.onMobile,$K.onSafari=-1<$K.u.indexOf("Safari"),$K.onFirefox=-1<$K.u.indexOf("Firefox"),$K.onEdge=-1<$K.u.indexOf("Edge"),$K.onMiniGame=-1<$K.u.indexOf("MiniGame"),$K.onLimixiu=-1<$K.u.indexOf("limixiu"),$K.httpProtocol="http:"==$K.window.location.protocol,$K.onMiniGame&&null==$K.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),$K.webAudioEnabled=!!($K.window.AudioContext||$K.window.webkitAudioContext||$K.window.mozAudioContext),$K.soundType=$K.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",$ZX=$K.webAudioEnabled?$nX:$KX,$K.webAudioEnabled&&$nX.initWebAudio(),$KX._initMusicAudio(),$K.enableTouch="ontouchstart"in $W||$W.DocumentTouch&&$g instanceof DocumentTouch,$W.focus(),$r._soundClass=$ZX,$r._musicClass=$KX,$C._mainCanvas=$C._mainCanvas||$$X.create("2D"),$K.canvas||($K.canvas=$$X.create("2D"),$K.context=$K.canvas.getContext("2d"))}},$K._onMessage=function($X){if($X.data&&"size"==$X.data.name){if($K.window.innerWidth=$X.data.width,$K.window.innerHeight=$X.data.height,$K.window.__innerHeight=$X.data.clientHeight,!$K.document.createEvent)return void console.warn("no document.createEvent");var $g=$K.document.createEvent("HTMLEvents");return $g.initEvent("resize",!1,!1),void $K.window.dispatchEvent($g)}},$K.createElement=function($X){return $K.__init__(),$K.document.__createElement($X)},$K.getElementById=function($X){return $K.__init__(),$K.document.getElementById($X)},$K.removeElement=function($X){$X&&$X.parentNode&&$X.parentNode.removeChild($X)},$K.now=function(){return $t.now()},$K._window=null,$K._document=null,$K._container=null,$K.userAgent=null,$K.u=null,$K.onIOS=!1,$K.onMac=!1,$K.onMobile=!1,$K.onIPhone=!1,$K.onIPad=!1,$K.onAndroid=!1,$K.onWP=!1,$K.onQQBrowser=!1,$K.onMQQBrowser=!1,$K.onSafari=!1,$K.onFirefox=!1,$K.onEdge=!1,$K.onIE=!1,$K.onWeiXin=!1,$K.onMiniGame=!1,$K.onLimixiu=!1,$K.onPC=!1,$K.httpProtocol=!1,$K.webAudioEnabled=!1,$K.soundType=null,$K.enableTouch=!1,$K.canvas=null,$K.context=null,$K.__init$=function(){},$K}()),$E=function(){function $g($X){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,$X?(this._u8d_=new Uint8Array($X),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}$a($g,"laya.utils.Byte");var $X=$g.prototype;return $X.___resizeBuffer=function($g){try{var $X=new Uint8Array($g);null!=this._u8d_&&(this._u8d_.length<=$g?$X.set(this._u8d_):$X.set(this._u8d_.subarray(0,$g))),this._u8d_=$X,this._d_=new DataView($X.buffer)}catch($X){throw"___resizeBuffer err:"+$g}},$X.getString=function(){return this.rUTF(this.getUint16())},$X.getFloat32Array=function($X,$g){var $K=$X+$g;$K=$K>this._length?this._length:$K;var $x=new Float32Array(this._d_.buffer.slice($X,$K));return this._pos_=$K,$x},$X.getUint8Array=function($X,$g){var $K=$X+$g;$K=$K>this._length?this._length:$K;var $x=new Uint8Array(this._d_.buffer.slice($X,$K));return this._pos_=$K,$x},$X.getInt16Array=function($X,$g){var $K=$X+$g;$K=$K>this._length?this._length:$K;var $x=new Int16Array(this._d_.buffer.slice($X,$K));return this._pos_=$K,$x},$X.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var $X=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,$X},$X.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var $X=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,$X},$X.writeFloat32=function($X){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,$X,this._xd_),this._pos_+=4},$X.writeFloat64=function($X){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,$X,this._xd_),this._pos_+=8},$X.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var $X=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,$X},$X.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var $X=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,$X},$X.writeInt32=function($X){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,$X,this._xd_),this._pos_+=4},$X.writeUint32=function($X){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,$X,this._xd_),this._pos_+=4},$X.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var $X=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,$X},$X.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var $X=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,$X},$X.writeUint16=function($X){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,$X,this._xd_),this._pos_+=2},$X.writeInt16=function($X){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,$X,this._xd_),this._pos_+=2},$X.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},$X.writeUint8=function($X){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,$X),this._pos_++},$X._getUInt8=function($X){return this._d_.getUint8($X)},$X._getUint16=function($X){return this._d_.getUint16($X,this._xd_)},$X._getMatrix=function(){return new $M(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},$X.rUTF=function($X){for(var $g=[],$K=this._pos_+$X,$x=0,$Z=0,$n=0,$W=String.fromCharCode,$v=this._u8d_;this._pos_<$K;)($x=$v[this._pos_++])<128?0!=$x&&$g.push($W($x)):$x<224?$g.push($W((63&$x)<<6|127&$v[this._pos_++])):$x<240?($Z=$v[this._pos_++],$g.push($W((31&$x)<<12|(127&$Z)<<6|127&$v[this._pos_++]))):($Z=$v[this._pos_++],$n=$v[this._pos_++],$g.push($W((15&$x)<<18|(127&$Z)<<12|$n<<6&127|127&$v[this._pos_++]))),0;return $g.join("")},$X.getCustomString=function($X){for(var $g=[],$K=0,$x=0,$Z=0,$n=String.fromCharCode,$W=this._u8d_;0<$X;)if(($x=$W[this._pos_])<128)$g.push($n($x)),this._pos_++,$X--;else for($K=$x-128,this._pos_++,$X-=$K;0<$K;)$x=$W[this._pos_++],$Z=$W[this._pos_++],$g.push($n($Z<<8|$x)),$K--;return $g.join("")},$X.clear=function(){this._pos_=0,this.length=0},$X.__getBuffer=function(){return this._d_.buffer},$X.writeUTFBytes=function($X){for(var $g=0,$K=($X+="").length;$g<$K;$g++){var $x=$X.charCodeAt($g);$x<=127?this.writeByte($x):$x<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|$x>>6,128|63&$x],this._pos_),this._pos_+=2):$x<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|$x>>12,128|$x>>6&63,128|63&$x],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|$x>>18,128|$x>>12&63,128|$x>>6&63,128|63&$x],this._pos_),this._pos_+=4)}},$X.writeUTFString=function($X){var $g=this.pos;this.writeUint16(1),this.writeUTFBytes($X);var $K=this.pos-$g-2;if(65536<=$K)throw"writeUTFString byte len more than 65536";this._d_.setUint16($g,$K,this._xd_)},$X.readUTFString=function(){return this.readUTFBytes(this.getUint16())},$X.getUTFString=function(){return this.readUTFString()},$X.readUTFBytes=function($X){if(void 0===$X&&($X=-1),0==$X)return"";var $g=this.bytesAvailable;if($g<$X)throw"readUTFBytes error - Out of bounds";return $X=0<$X?$X:$g,this.rUTF($X)},$X.getUTFBytes=function($X){return void 0===$X&&($X=-1),this.readUTFBytes($X)},$X.writeByte=function($X){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,$X),this._pos_+=1},$X.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},$X.getByte=function(){return this.readByte()},$X.ensureWrite=function($X){this._length<$X&&(this._length=$X),this._allocated_<$X&&(this.length=$X)},$X.writeArrayBuffer=function($X,$g,$K){if(void 0===$g&&($g=0),void 0===$K&&($K=0),$g<0||$K<0)throw"writeArrayBuffer error - Out of bounds";0==$K&&($K=$X.byteLength-$g),this.ensureWrite(this._pos_+$K);var $x=new Uint8Array($X);this._u8d_.set($x.subarray($g,$g+$K),this._pos_),this._pos_+=$K},$c(0,$X,"buffer",function(){var $X=this._d_.buffer;return $X.byteLength==this.length?$X:$X.slice(0,this.length)}),$c(0,$X,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function($X){this._xd_="littleEndian"==$X}),$c(0,$X,"length",function(){return this._length},function($X){this._allocated_<$X?this.___resizeBuffer(this._allocated_=Math.floor(Math.max($X,2*this._allocated_))):this._allocated_>$X&&this.___resizeBuffer(this._allocated_=$X),this._length=$X}),$c(0,$X,"pos",function(){return this._pos_},function($X){this._pos_=$X}),$c(0,$X,"bytesAvailable",function(){return this._length-this._pos_}),$g.getSystemEndian=function(){if(!$g._sysEndian){var $X=new ArrayBuffer(2);new DataView($X).setInt16(0,256,!0),$g._sysEndian=256===new Int16Array($X)[0]?"littleEndian":"bigEndian"}return $g._sysEndian},$g.BIG_ENDIAN="bigEndian",$g.LITTLE_ENDIAN="littleEndian",$g._sysEndian=null,$g}(),$u=function(){function $Z(){}return $a($Z,"laya.utils.CacheManager"),$Z.regCacheByFunction=function($X,$g){var $K;$Z.unRegCacheByFunction($X,$g),$K={tryDispose:$X,getCacheList:$g},$Z._cacheList.push($K)},$Z.unRegCacheByFunction=function($X,$g){var $K,$x=0;for($K=$Z._cacheList.length,$x=0;$x<$K;$x++)if($Z._cacheList[$x].tryDispose==$X&&$Z._cacheList[$x].getCacheList==$g)return void $Z._cacheList.splice($x,1)},$Z.forceDispose=function(){var $X=0,$g=$Z._cacheList.length;for($X=0;$X<$g;$X++)$Z._cacheList[$X].tryDispose(!0)},$Z.beginCheck=function($X){void 0===$X&&($X=15e3),$D.timer.loop($X,null,$Z._checkLoop)},$Z.stopCheck=function(){$D.timer.clear(null,$Z._checkLoop)},$Z._checkLoop=function(){var $X=$Z._cacheList;if(!($X.length<1)){var $g,$K=$q.now(),$x=0;for($g=$x=$X.length;0<$x&&($X[$Z._index=++$Z._index%$g].tryDispose(!1),!($q.now()-$K>$Z.loopTimeLimit));)$x--}},$Z.loopTimeLimit=2,$Z._cacheList=[],$Z._index=0,$Z}(),$O=function(){function $V(){}return $a($V,"laya.utils.ClassUtils"),$V.regClass=function($X,$g){$V._classMap[$X]=$g},$V.getRegClass=function($X){return $V._classMap[$X]},$V.getInstance=function($X){var $g=$V.getClass($X);return $g?new $g:(console.warn("[error] Undefined class:",$X),null)},$V.createByJson=function($X,$g,$K,$x,$Z){"string"==typeof $X&&($X=JSON.parse($X));var $n=$X.props;if(!$g&&!($g=$Z?$Z.runWith($X):$V.getInstance($n.runtime||$X.type)))return null;var $W=$X.child;if($W)for(var $v=0,$T=$W.length;$v<$T;$v++){var $G=$W[$v];if("render"!==$G.props.name&&"render"!==$G.props.renderType||!$g._$set_itemRender)if("Graphic"==$G.type)$V.addGraphicsToSprite($G,$g);else if($V.isDrawType($G.type))$V.addGraphicToSprite($G,$g,!0);else{var $c=$V.createByJson($G,null,$K,$x,$Z);"Script"==$G.type?$c.hasOwnProperty("owner")?$c.owner=$g:$c.hasOwnProperty("target")&&($c.target=$g):"mask"==$G.props.renderType?$g.mask=$c:$g.addChild($c)}else $g.itemRender=$G}if($n)for(var $_ in $n){var $s=$n[$_];"var"===$_&&$K?$K[$s]=$g:$s instanceof Array&&"function"==typeof $g[$_]?$g[$_].apply($g,$s):$g[$_]=$s}return $x&&$X.customProps&&$x.runWith([$g,$X]),$g.created&&$g.created(),$g},$V.addGraphicsToSprite=function($X,$g){var $K;if(($K=$X.child)&&!($K.length<1)){var $x;$x=$V._getGraphicsFromSprite($X,$g);var $Z=0,$n=0;$X.props&&($Z=$V._getObjVar($X.props,"x",0),$n=$V._getObjVar($X.props,"y",0)),0!=$Z&&0!=$n&&$x.translate($Z,$n);var $W,$v=0;for($W=$K.length,$v=0;$v<$W;$v++)$V._addGraphicToGraphics($K[$v],$x);0!=$Z&&0!=$n&&$x.translate(-$Z,-$n)}},$V.addGraphicToSprite=function($X,$g,$K){var $x;void 0===$K&&($K=!1),$x=$K?$V._getGraphicsFromSprite($X,$g):$g.graphics,$V._addGraphicToGraphics($X,$x)},$V._getGraphicsFromSprite=function($X,$g){var $K,$x;if(!$X||!$X.props)return $g.graphics;switch($x=$X.props.renderType){case"hit":case"unHit":var $Z;$g.hitArea||($g.hitArea=new $R),($Z=$g.hitArea)[$x]||($Z[$x]=new $s),$K=$Z[$x]}return $K||($K=$g.graphics),$K},$V._getTransformData=function($X){var $g;($X.hasOwnProperty("pivotX")||$X.hasOwnProperty("pivotY"))&&($g=$g||new $M).translate(-$V._getObjVar($X,"pivotX",0),-$V._getObjVar($X,"pivotY",0));var $K=$V._getObjVar($X,"scaleX",1),$x=$V._getObjVar($X,"scaleY",1),$Z=$V._getObjVar($X,"rotation",0);$V._getObjVar($X,"skewX",0),$V._getObjVar($X,"skewY",0);return 1==$K&&1==$x&&0==$Z||(($g=$g||new $M).scale($K,$x),$g.rotate(.0174532922222222*$Z)),$g},$V._addGraphicToGraphics=function($X,$g){var $K,$x;if(($K=$X.props)&&($x=$V.DrawTypeDic[$X.type])){var $Z,$n;$Z=$g;var $W=$V._getParams($K,$x[1],$x[2],$x[3]);(($n=$V._tM)||1!=$V._alpha)&&($Z.save(),$n&&$Z.transform($n),1!=$V._alpha&&$Z.alpha($V._alpha)),$Z[$x[0]].apply($Z,$W),($n||1!=$V._alpha)&&$Z.restore()}},$V._adptLineData=function($X){return $X[2]=parseFloat($X[0])+parseFloat($X[2]),$X[3]=parseFloat($X[1])+parseFloat($X[3]),$X},$V._adptTextureData=function($X){return $X[0]=$vX.getRes($X[0]),$X},$V._adptLinesData=function($X){return $X[2]=$V._getPointListByStr($X[2]),$X},$V.isDrawType=function($X){return"Image"!=$X&&$V.DrawTypeDic.hasOwnProperty($X)},$V._getParams=function($X,$g,$K,$x){var $Z;void 0===$K&&($K=0),($Z=$V._temParam).length=$g.length;var $n,$W,$v=0;for($n=$g.length,$v=0;$v<$n;$v++)$Z[$v]=$V._getObjVar($X,$g[$v][0],$g[$v][1]);return $V._alpha=$V._getObjVar($X,"alpha",1),$W=$V._getTransformData($X),$V._tM=$W?($K||($K=0),$W.translate($Z[$K],$Z[$K+1]),$Z[$K]=$Z[$K+1]=0,$W):null,$x&&$V[$x]&&($Z=$V[$x]($Z)),$Z},$V._getPointListByStr=function($X){var $g,$K,$x=0;for($K=($g=$X.split(",")).length,$x=0;$x<$K;$x++)$g[$x]=parseFloat($g[$x]);return $g},$V._getObjVar=function($X,$g,$K){return $X.hasOwnProperty($g)?$X[$g]:$K},$V._temParam=[],$V._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},$V.getClass=function($X){var $g=$V._classMap[$X]||$X;return"string"==typeof $g?$D.__classmap[$g]:$g},$V._tM=null,$V._alpha=NaN,$T($V,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),$V}(),$e=function(){function $n($X){if(this._color=[],"string"==typeof $X){null===(this.strColor=$X)&&($X="#000000"),"#"==$X.charAt(0)&&($X=$X.substr(1));var $g=$X.length;if(3==$g||4==$g){for(var $K="",$x=0;$x<$g;$x++)$K+=$X[$x]+$X[$x];$X=$K}var $Z=this.numColor=parseInt($X,16);if(8==$X.length)return void(this._color=[parseInt($X.substr(0,2),16)/255,((16711680&$Z)>>16)/255,((65280&$Z)>>8)/255,(255&$Z)/255])}else $Z=this.numColor=$X,this.strColor=$J.toHexColor($Z);this._color=[((16711680&$Z)>>16)/255,((65280&$Z)>>8)/255,(255&$Z)/255,1],this._color.__id=++$n._COLODID}return $a($n,"laya.utils.Color"),$n._initDefault=function(){for(var $X in $n._DEFAULT={},$n._COLOR_MAP)$n._SAVE[$X]=$n._DEFAULT[$X]=new $n($n._COLOR_MAP[$X]);return $n._DEFAULT},$n._initSaveMap=function(){for(var $X in $n._SAVE_SIZE=0,$n._SAVE={},$n._DEFAULT)$n._SAVE[$X]=$n._DEFAULT[$X]},$n.create=function($X){var $g=$n._SAVE[$X+""];return null!=$g?$g:($n._SAVE_SIZE<1e3||$n._initSaveMap(),$n._SAVE[$X+""]=new $n($X))},$n._SAVE={},$n._SAVE_SIZE=0,$n._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},$n._DEFAULT=$n._initDefault(),$n._COLODID=1,$n}(),$b=(function(){function $X(){this._values=[],this._keys=[]}$a($X,"laya.utils.Dictionary");var $g=$X.prototype;$g.set=function($X,$g){var $K=this.indexOf($X);0<=$K?this._values[$K]=$g:(this._keys.push($X),this._values.push($g))},$g.indexOf=function($X){var $g=this._keys.indexOf($X);return 0<=$g?$g:($X="string"==typeof $X?Number($X):"number"==typeof $X?$X.toString():$X,this._keys.indexOf($X))},$g.get=function($X){var $g=this.indexOf($X);return $g<0?null:this._values[$g]},$g.remove=function($X){var $g=this.indexOf($X);return 0<=$g&&(this._keys.splice($g,1),this._values.splice($g,1),!0)},$g.clear=function(){this._values.length=0,this._keys.length=0},$c(0,$g,"values",function(){return this._values}),$c(0,$g,"keys",function(){return this._keys})}(),function(){function $X(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}$a($X,"laya.utils.Dragging");var $g=$X.prototype;return $g.start=function($X,$g,$K,$x,$Z,$n,$W,$v){void 0===$v&&($v=.92),this.clearTimer(),this.target=$X,this.area=$g,this.hasInertia=$K,this.elasticDistance=$g?$x:0,this.elasticBackTime=$Z,this.data=$n,this._disableMouseEvent=$W,this.ratio=$v,1!=$X.globalScaleX||1!=$X.globalScaleY?this._parent=$X.parent:this._parent=$D.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,$D.stage.on("mouseup",this,this.onStageMouseUp),$D.stage.on("mouseout",this,this.onStageMouseUp),$D.timer.frameLoop(1,this,this.loop)},$g.clearTimer=function(){$D.timer.clear(this,this.loop),$D.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},$g.stop=function(){this._dragging&&($A.instance.disableMouseEvent=!1,$D.stage.off("mouseup",this,this.onStageMouseUp),$D.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},$g.loop=function(){var $X=this._parent.getMousePoint(),$g=$X.x,$K=$X.y,$x=$g-this._lastX,$Z=$K-this._lastY;if(this._clickOnly){if(!(1<Math.abs($x*$D.stage._canvasTransform.getScaleX())||1<Math.abs($Z*$D.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),$A.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push($x,$Z);0==$x&&0==$Z||(this._lastX=$g,this._lastY=$K,this.target.x+=$x*this._elasticRateX,this.target.y+=$Z*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},$g.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var $X=this.area.x-this.target.x;else $X=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-$X/this.elasticDistance),this.target.y<this.area.y)var $g=this.area.y-this.target.y;else $g=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-$g/this.elasticDistance)}},$g.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},$g.onStageMouseUp=function($X){if($A.instance.disableMouseEvent=!1,$D.stage.off("mouseup",this,this.onStageMouseUp),$D.stage.off("mouseout",this,this.onStageMouseUp),$D.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var $g=this._offsets.length,$K=Math.min($g,6),$x=this._offsets.length-$K,$Z=$g-1;$x<$Z;$Z--)this._offsetY+=this._offsets[$Z--],this._offsetX+=this._offsets[$Z];this._offsetX=this._offsetX/$K*2,this._offsetY=this._offsetY/$K*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),$D.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},$g.checkElastic=function(){var $X=NaN,$g=NaN;if(this.target.x<this.area.x?$X=this.area.x:this.target.x>this.area.x+this.area.width&&($X=this.area.x+this.area.width),this.target.y<this.area.y?$g=this.area.y:this.target.y>this.area.y+this.area.height&&($g=this.area.y+this.area.height),isNaN($X)&&isNaN($g))this.clear();else{var $K={};isNaN($X)||($K.x=$X),isNaN($g)||($K.y=$g),this._tween=$z.to(this.target,$K,this.elasticBackTime,$S.sineOut,$U.create(this,this.clear),0,!1,!1)}},$g.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&($D.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},$g.clear=function(){if(this.target){this.clearTimer();var $X=this.target;this.target=null,this._parent=null,$X.event("dragend",this.data)}},$X}()),$S=function(){function $v(){}return $a($v,"laya.utils.Ease"),$v.linearNone=function($X,$g,$K,$x){return $K*$X/$x+$g},$v.linearIn=function($X,$g,$K,$x){return $K*$X/$x+$g},$v.linearInOut=function($X,$g,$K,$x){return $K*$X/$x+$g},$v.linearOut=function($X,$g,$K,$x){return $K*$X/$x+$g},$v.bounceIn=function($X,$g,$K,$x){return $K-$v.bounceOut($x-$X,0,$K,$x)+$g},$v.bounceInOut=function($X,$g,$K,$x){return $X<.5*$x?.5*$v.bounceIn(2*$X,0,$K,$x)+$g:.5*$v.bounceOut(2*$X-$x,0,$K,$x)+.5*$K+$g},$v.bounceOut=function($X,$g,$K,$x){return($X/=$x)<1/2.75?$K*(7.5625*$X*$X)+$g:$X<2/2.75?$K*(7.5625*($X-=1.5/2.75)*$X+.75)+$g:$X<2.5/2.75?$K*(7.5625*($X-=2.25/2.75)*$X+.9375)+$g:$K*(7.5625*($X-=2.625/2.75)*$X+.984375)+$g},$v.backIn=function($X,$g,$K,$x,$Z){return void 0===$Z&&($Z=1.70158),$K*($X/=$x)*$X*(($Z+1)*$X-$Z)+$g},$v.backInOut=function($X,$g,$K,$x,$Z){return void 0===$Z&&($Z=1.70158),($X/=.5*$x)<1?.5*$K*($X*$X*((1+($Z*=1.525))*$X-$Z))+$g:$K/2*(($X-=2)*$X*((1+($Z*=1.525))*$X+$Z)+2)+$g},$v.backOut=function($X,$g,$K,$x,$Z){return void 0===$Z&&($Z=1.70158),$K*(($X=$X/$x-1)*$X*(($Z+1)*$X+$Z)+1)+$g},$v.elasticIn=function($X,$g,$K,$x,$Z,$n){var $W;return void 0===$Z&&($Z=0),void 0===$n&&($n=0),0==$X?$g:1==($X/=$x)?$g+$K:($n||($n=.3*$x),$W=!$Z||0<$K&&$Z<$K||$K<0&&$Z<-$K?($Z=$K,$n/4):$n/$v.PI2*Math.asin($K/$Z),-$Z*Math.pow(2,10*($X-=1))*Math.sin(($X*$x-$W)*$v.PI2/$n)+$g)},$v.elasticInOut=function($X,$g,$K,$x,$Z,$n){var $W;return void 0===$Z&&($Z=0),void 0===$n&&($n=0),0==$X?$g:2==($X/=.5*$x)?$g+$K:($n||($n=$x*(.3*1.5)),$W=!$Z||0<$K&&$Z<$K||$K<0&&$Z<-$K?($Z=$K,$n/4):$n/$v.PI2*Math.asin($K/$Z),$X<1?$Z*Math.pow(2,10*($X-=1))*Math.sin(($X*$x-$W)*$v.PI2/$n)*-.5+$g:$Z*Math.pow(2,-10*($X-=1))*Math.sin(($X*$x-$W)*$v.PI2/$n)*.5+$K+$g)},$v.elasticOut=function($X,$g,$K,$x,$Z,$n){var $W;return void 0===$Z&&($Z=0),void 0===$n&&($n=0),0==$X?$g:1==($X/=$x)?$g+$K:($n||($n=.3*$x),$W=!$Z||0<$K&&$Z<$K||$K<0&&$Z<-$K?($Z=$K,$n/4):$n/$v.PI2*Math.asin($K/$Z),$Z*Math.pow(2,-10*$X)*Math.sin(($X*$x-$W)*$v.PI2/$n)+$K+$g)},$v.strongIn=function($X,$g,$K,$x){return $K*($X/=$x)*$X*$X*$X*$X+$g},$v.strongInOut=function($X,$g,$K,$x){return($X/=.5*$x)<1?.5*$K*$X*$X*$X*$X*$X+$g:.5*$K*(($X-=2)*$X*$X*$X*$X+2)+$g},$v.strongOut=function($X,$g,$K,$x){return $K*(($X=$X/$x-1)*$X*$X*$X*$X+1)+$g},$v.sineInOut=function($X,$g,$K,$x){return.5*-$K*(Math.cos(Math.PI*$X/$x)-1)+$g},$v.sineIn=function($X,$g,$K,$x){return-$K*Math.cos($X/$x*$v.HALF_PI)+$K+$g},$v.sineOut=function($X,$g,$K,$x){return $K*Math.sin($X/$x*$v.HALF_PI)+$g},$v.quintIn=function($X,$g,$K,$x){return $K*($X/=$x)*$X*$X*$X*$X+$g},$v.quintInOut=function($X,$g,$K,$x){return($X/=.5*$x)<1?.5*$K*$X*$X*$X*$X*$X+$g:.5*$K*(($X-=2)*$X*$X*$X*$X+2)+$g},$v.quintOut=function($X,$g,$K,$x){return $K*(($X=$X/$x-1)*$X*$X*$X*$X+1)+$g},$v.quartIn=function($X,$g,$K,$x){return $K*($X/=$x)*$X*$X*$X+$g},$v.quartInOut=function($X,$g,$K,$x){return($X/=.5*$x)<1?.5*$K*$X*$X*$X*$X+$g:.5*-$K*(($X-=2)*$X*$X*$X-2)+$g},$v.quartOut=function($X,$g,$K,$x){return-$K*(($X=$X/$x-1)*$X*$X*$X-1)+$g},$v.cubicIn=function($X,$g,$K,$x){return $K*($X/=$x)*$X*$X+$g},$v.cubicInOut=function($X,$g,$K,$x){return($X/=.5*$x)<1?.5*$K*$X*$X*$X+$g:.5*$K*(($X-=2)*$X*$X+2)+$g},$v.cubicOut=function($X,$g,$K,$x){return $K*(($X=$X/$x-1)*$X*$X+1)+$g},$v.quadIn=function($X,$g,$K,$x){return $K*($X/=$x)*$X+$g},$v.quadInOut=function($X,$g,$K,$x){return($X/=.5*$x)<1?.5*$K*$X*$X+$g:.5*-$K*(--$X*($X-2)-1)+$g},$v.quadOut=function($X,$g,$K,$x){return-$K*($X/=$x)*($X-2)+$g},$v.expoIn=function($X,$g,$K,$x){return 0==$X?$g:$K*Math.pow(2,10*($X/$x-1))+$g-.001*$K},$v.expoInOut=function($X,$g,$K,$x){return 0==$X?$g:$X==$x?$g+$K:($X/=.5*$x)<1?.5*$K*Math.pow(2,10*($X-1))+$g:.5*$K*(2-Math.pow(2,-10*--$X))+$g},$v.expoOut=function($X,$g,$K,$x){return $X==$x?$g+$K:$K*(1-Math.pow(2,-10*$X/$x))+$g},$v.circIn=function($X,$g,$K,$x){return-$K*(Math.sqrt(1-($X/=$x)*$X)-1)+$g},$v.circInOut=function($X,$g,$K,$x){return($X/=.5*$x)<1?.5*-$K*(Math.sqrt(1-$X*$X)-1)+$g:.5*$K*(Math.sqrt(1-($X-=2)*$X)+1)+$g},$v.circOut=function($X,$g,$K,$x){return $K*Math.sqrt(1-($X=$X/$x-1)*$X)+$g},$v.HALF_PI=.5*Math.PI,$v.PI2=2*Math.PI,$v}(),$R=function(){function $_(){this._hit=null,this._unHit=null}$a($_,"laya.utils.HitArea");var $X=$_.prototype;return $X.isHit=function($X,$g){return!!$_.isHitGraphic($X,$g,this.hit)&&!$_.isHitGraphic($X,$g,this.unHit)},$X.contains=function($X,$g){return this.isHit($X,$g)},$c(0,$X,"hit",function(){return this._hit||(this._hit=new $s),this._hit},function($X){this._hit=$X}),$c(0,$X,"unHit",function(){return this._unHit||(this._unHit=new $s),this._unHit},function($X){this._unHit=$X}),$_.isHitGraphic=function($X,$g,$K){if(!$K)return!1;var $x;if(!($x=$K.cmds)&&$K._one&&(($x=$_._cmds).length=1,$x[0]=$K._one),!$x)return!1;var $Z,$n,$W=0;for($Z=$x.length,$W=0;$W<$Z;$W++)if($n=$x[$W]){var $v=$C._context;switch($n.callee){case $v._translate:case 6:$X-=$n[0],$g-=$n[1]}if($_.isHitCmd($X,$g,$n))return!0}return!1},$_.isHitCmd=function($X,$g,$K){if(!$K)return!1;var $x=$C._context,$Z=!1;switch($K.callee){case $x._drawRect:case 13:$_._rec.setTo($K[0],$K[1],$K[2],$K[3]),$Z=$_._rec.contains($X,$g);break;case $x._drawCircle:case $x._fillCircle:case 14:$Z=($X-=$K[0])*$X+($g-=$K[1])*$g<$K[2]*$K[2];break;case $x._drawPoly:case 18:$X-=$K[0],$g-=$K[1],$Z=$_.ptInPolygon($X,$g,$K[2])}return $Z},$_.ptInPolygon=function($X,$g,$K){var $x;($x=$_._ptPoint).setTo($X,$g);var $Z,$n=0,$W=NaN,$v=NaN,$T=NaN,$G=NaN;$Z=$K.length;for(var $c=0;$c<$Z;$c+=2){if($W=$K[$c],$v=$K[$c+1],$T=$K[($c+2)%$Z],$v!=($G=$K[($c+3)%$Z]))if(!($x.y<Math.min($v,$G)))if(!($x.y>=Math.max($v,$G)))($x.y-$v)*($T-$W)/($G-$v)+$W>$x.x&&$n++}return $n%2==1},$_._cmds=[],$T($_,["_rec",function(){return this._rec=new $i},"_ptPoint",function(){return this._ptPoint=new $B}]),$_}(),$j=(function(){function $Z($X,$g,$K,$x){this.char=$X,this.charNum=$X.charCodeAt(0),this._x=this._y=0,this.width=$g,this.height=$K,this.style=$x,this.isWord=!$Z._isWordRegExp.test($X)}$a($Z,"laya.utils.HTMLChar");var $X=$Z.prototype;$D.imps($X,{"laya.display.ILayout":!0}),$X.setSprite=function($X){this._sprite=$X},$X.getSprite=function(){return this._sprite},$X._isChar=function(){return!0},$X._getCSSStyle=function(){return this.style},$c(0,$X,"width",function(){return this._w},function($X){this._w=$X}),$c(0,$X,"x",function(){return this._x},function($X){this._sprite&&(this._sprite.x=$X),this._x=$X}),$c(0,$X,"y",function(){return this._y},function($X){this._sprite&&(this._sprite.y=$X),this._y=$X}),$c(0,$X,"height",function(){return this._h},function($X){this._h=$X}),$Z._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function $g(){}$a($g,"laya.utils.Log"),$g.enable=function(){$g._logdiv||($g._logdiv=$q.window.document.createElement("div"),$q.window.document.body.appendChild($g._logdiv),$g._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},$g.toggle=function(){var $X=$g._logdiv.style;"1px"==$X.width?$X.width=$X.height="50%":$X.width=$X.height="1px"},$g.print=function($X){$g._logdiv&&($g.maxCount<=$g._count&&$g.clear(),$g._count++,$g._logdiv.innerText+=$X+"\n",$g._logdiv.scrollTop=$g._logdiv.scrollHeight)},$g.clear=function(){$g._logdiv.innerText="",$g._count=0},$g._logdiv=null,$g._count=0,$g.maxCount=20}(),function(){function $g(){}$a($g,"laya.utils.Mouse"),$c(1,$g,"cursor",function(){return $g._style.cursor},function($X){$g._style.cursor=$X}),$g.hide=function(){"none"!=$g.cursor&&($g._preCursor=$g.cursor,$g.cursor="none")},$g.show=function(){"none"==$g.cursor&&($g.cursor=$g._preCursor?$g._preCursor:"auto")},$g._preCursor=null,$T($g,["_style",function(){return this._style=$q.document.body.style}])}(),function(){function $n(){}return $a($n,"laya.utils.Pool"),$n.getPoolBySign=function($X){return $n._poolDic[$X]||($n._poolDic[$X]=[])},$n.clearBySign=function($X){$n._poolDic[$X]&&($n._poolDic[$X].length=0)},$n.recover=function($X,$g){$g.__InPool||($g.__InPool=!0,$n.getPoolBySign($X).push($g))},$n.getItemByClass=function($X,$g){var $K=$n.getPoolBySign($X),$x=$K.length?$K.pop():new $g;return $x.__InPool=!1,$x},$n.getItemByCreateFun=function($X,$g,$K){var $x=$n.getPoolBySign($X),$Z=$x.length?$x.pop():$g.call($K);return $Z.__InPool=!1,$Z},$n.getItem=function($X){var $g=$n.getPoolBySign($X),$K=$g.length?$g.pop():null;return $K&&($K.__InPool=!1),$K},$n._poolDic={},$n.InPoolSign="__InPool",$n}()),$d=function(){function $T(){}return $a($T,"laya.utils.Stat"),$c(1,$T,"onclick",null,function($X){$T._sp&&$T._sp.on("click",$T._sp,$X),$T._canvas&&($T._canvas.source.onclick=$X,$T._canvas.source.style.pointerEvents="")}),$T.show=function($X,$g,$K){if(void 0===$X&&($X=0),void 0===$g&&($g=0),void 0===$K&&($K=0),!$C.isConchApp||$C.isConchWebGL){if($C.isConchWebGL||$q.onMiniGame||$q.onLimixiu||($T._useCanvas=!0),$T._show=!0,$T._fpsData.length=60,$T._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},$T._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},$T._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},$T._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},$C.isWebGL)if($T._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},$C.is3DMode){if($T._view[0].title="FPS(3D)",$T._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},$T._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},$T._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==$K){var $x=8;$T._view[$x++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},$T._view[$x++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$T._view[$x++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},$T._view[$x++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$T._view[$x++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$T._view[$x++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$T._view[$x++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$T._view[$x++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},$T._view[$x++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==$K){$x=8;$T._view[$x++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},$T._view[$x++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},$T._view[$x++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},$T._view[$x++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},$T._view[$x++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},$T._view[$x++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},$T._view[$x++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else $T._view[0].title="FPS(WebGL)",$T._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else $T._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};$T._useCanvas?$T.createUIPre($X,$g):$T.createUI($X,$g),$T.enable()}else $q.window.conch.showFPS&&$q.window.conch.showFPS($X,$g)},$T.createUIPre=function($X,$g){var $K=$q.pixelRatio;$T._width=170*$K,$T._vx=75*$K,$T._height=$K*(12*$T._view.length+3*$K)+4,$T._fontSize=12*$K;for(var $x=0;$x<$T._view.length;$x++)$T._view[$x].x=4,$T._view[$x].y=$x*$T._fontSize+2*$K;$T._canvas||(($T._canvas=new $$X("2D")).size($T._width,$T._height),($T._ctx=$T._canvas.getContext("2d")).textBaseline="top",$T._ctx.font=$T._fontSize+"px Sans-serif",$T._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+$X+"px;top:"+$g+"px;width:"+$T._width/$K+"px;height:"+$T._height/$K+"px;"),$T._first=!0,$T.loop(),$T._first=!1,$q.container.appendChild($T._canvas.source)},$T.createUI=function($X,$g){var $K=$T._sp,$x=$q.pixelRatio;$K||($K=new $_X,($T._leftText=new $mX).pos(5,5),$T._leftText.color="#ffffff",$K.addChild($T._leftText),($T._txt=new $mX).pos(80*$x,5),$T._txt.color="#ffffff",$K.addChild($T._txt),$T._sp=$K),$K.pos($X,$g);for(var $Z="",$n=0;$n<$T._view.length;$n++){$Z+=$T._view[$n].title+"\n"}$T._leftText.text=$Z;var $W=170*$x,$v=$x*(12*$T._view.length+3*$x)+4;$T._txt.fontSize=$T._fontSize*$x,$T._leftText.fontSize=$T._fontSize*$x,$K.size($W,$v),$K.graphics.clear(),$K.graphics.setAlpha(.5),$K.graphics.drawRect(0,0,$W,$v,"#999999"),$K.graphics.setAlpha(1),$T.loop()},$T.enable=function(){$D.timer.frameLoop(1,$T,$T.loop)},$T.hide=function(){$T._show=!1,$D.timer.clear($T,$T.loop),$T._canvas&&$q.removeElement($T._canvas.source)},$T.clear=function(){$T.trianglesFaces=$T.drawCall=$T.shaderCall=$T.spriteCount=$T.spriteRenderUseCacheCount=$T.treeNodeCollision=$T.treeSpriteCollision=$T.canvasNormal=$T.canvasBitmap=$T.canvasReCache=0},$T.loop=function(){$T._count++;var $X=$q.now();if(!($X-$T._timer<1e3)){var $g=$T._count;if($T.FPS=Math.round(1e3*$g/($X-$T._timer)),$T._show){$T.trianglesFaces=Math.round($T.trianglesFaces/$g),$T.spriteCount=$T._useCanvas?($T.drawCall=Math.round($T.drawCall/$g)-2,$T.shaderCall=Math.round($T.shaderCall/$g),Math.round($T.spriteCount/$g)-1):($T.drawCall=Math.round($T.drawCall/$g)-2,$T.shaderCall=Math.round($T.shaderCall/$g)-4,Math.round($T.spriteCount/$g)-4),$T.spriteRenderUseCacheCount=Math.round($T.spriteRenderUseCacheCount/$g),$T.canvasNormal=Math.round($T.canvasNormal/$g),$T.canvasBitmap=Math.round($T.canvasBitmap/$g),$T.canvasReCache=Math.ceil($T.canvasReCache/$g),$T.treeNodeCollision=Math.round($T.treeNodeCollision/$g),$T.treeSpriteCollision=Math.round($T.treeSpriteCollision/$g);var $K=0<$T.FPS?Math.floor(1e3/$T.FPS).toString():" ";$T._fpsStr=$T.FPS+($T.renderSlow?" slow":"")+" "+$K,$T._spriteStr=$T.spriteCount+($T.spriteRenderUseCacheCount?"/"+$T.spriteRenderUseCacheCount:""),$T._canvasStr=$T.canvasReCache+"/"+$T.canvasNormal+"/"+$T.canvasBitmap,$T.currentMemorySize=$L.systemResourceManager.memorySize,$T._useCanvas?$T.renderInfoPre():$T.renderInfo(),$T.clear()}$T._count=0,$T._timer=$X}},$T.renderInfoPre=function(){if($T._canvas){var $X=$T._ctx;$X.clearRect($T._first?0:$T._vx,0,$T._width,$T._height);for(var $g=$C.WebGL.mainContext,$K=0;$K<$T._view.length;$K++){var $x=$T._view[$K];$T._first&&($X.fillStyle="white",$X.fillText($x.title,$x.x,$x.y,null,null,null)),$X.fillStyle=$x.color;var $Z=-1;if(($x=$T._view[$K]).varying){if($g)switch($x.varying){case 1:$Z=$g.getParameter($g[$x.value]);break;case 2:$Z=$g.getExtension($x.value)}}else $Z=$T[$x.value];"M"==$x.units&&($Z=Math.floor($Z/1048576*100)/100+" M"),"K"==$x.units&&($Z=Math.floor($Z/1024*100)/100+" K"),"string"==$x.units&&($Z=$Z.match(/\d+\.?\d/i)),$X.fillText($Z+"",$x.x+$T._vx,$x.y,null,null,null)}}},$T.renderInfo=function(){for(var $X="",$g=$C.WebGL.mainContext,$K=0;$K<$T._view.length;$K++){var $x=$T._view[$K],$Z=-1;if($x.varying){if($g)switch($x.varying){case 1:$Z=$g.getParameter($g[$x.value]);break;case 2:$Z=$g.getExtension($x.value)}}else $Z=$T[$x.value];"M"==$x.units&&($Z=Math.floor($Z/1048576*100)/100+" M"),"K"==$x.units&&($Z=Math.floor($Z/1024*100)/100+" K"),"string"==$x.units&&($Z=$Z.match(/\d+\.?\d/i)),$X+=$Z+"\n"}$T._txt.text=$X},$T.FPS=0,$T.loopCount=0,$T.shaderCall=0,$T.drawCall=0,$T.trianglesFaces=0,$T.spriteCount=0,$T.spriteRenderUseCacheCount=0,$T.treeNodeCollision=0,$T.treeSpriteCollision=0,$T.canvasNormal=0,$T.canvasBitmap=0,$T.canvasReCache=0,$T.renderSlow=!1,$T.currentMemorySize=0,$T._fpsStr=null,$T._canvasStr=null,$T._spriteStr=null,$T._fpsData=[],$T._timer=0,$T._count=0,$T._view=[],$T._fontSize=12,$T._txt=null,$T._leftText=null,$T._sp=null,$T._show=!1,$T._useCanvas=!1,$T._canvas=null,$T._ctx=null,$T._first=!1,$T._vx=NaN,$T._width=0,$T._height=100,$T}(),$h=(function(){function $X(){this._strsToID={},this._idToStrs=[],this._length=0}$a($X,"laya.utils.StringKey");var $g=$X.prototype;$g.add=function($X){var $g=this._strsToID[$X];return null!=$g?$g:(this._idToStrs[this._length]=$X,this._strsToID[$X]=this._length++)},$g.getID=function($X){var $g=this._strsToID[$X];return null==$g?-1:$g},$g.getName=function($X){var $g=this._idToStrs[$X];return null==$g?void 0:$g}}(),function(){var $G;function $X(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}$a($X,"laya.utils.Timer");var $g=$X.prototype;return $g._init=function(){$D.timer&&$D.timer.frameLoop(1,this,this._update)},$g._now=function(){return Date.now()},$g._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var $X=this.currFrame=this.currFrame+this.scale,$g=this._now();this._delta=($g-this._lastTimer)*this.scale;var $K=this.currTimer=this.currTimer+this._delta;$D.isDebug&&6e4<Math.abs($g-this._lastTimer)&&console.error("系统时间错误！"+($g-this._lastTimer)),this._lastTimer=$g;var $x=this._handlers;for($W=this._count=0,$v=$x.length;$W<$v;$W++)if(null!==($T=$x[$W]).method){var $Z=$T.userFrame?$X:$K;if($Z>=$T.exeTime)if($T.repeat)if($T.jumpFrame)for(;$Z>=$T.exeTime;)$T.exeTime+=$T.delay,$T.run(!1);else $T.exeTime+=$T.delay,$T.run(!1),$Z>$T.exeTime&&($T.exeTime+=Math.ceil(($Z-$T.exeTime)/$T.delay)*$T.delay);else $T.run(!0)}else this._count++;(30<this._count||$X%200==0)&&this._clearHandlers();for(var $n=this._laters,$W=0,$v=$n.length-1;$W<=$v;$W++){var $T=$n[$W];this._isIgnoreRecover($T)||(null!==$T.method&&(delete this._map[$T.key],$T.run(!1)),this._recoverHandler($T)),$W===$v&&($v=$n.length-1)}$n.length=0}},$g._clearHandlers=function(){for(var $X=this._handlers,$g=0,$K=$X.length;$g<$K;$g++){var $x=$X[$g];null!==$x.method?this._temp.push($x):this._isIgnoreRecover($x)?this._temp.push($x):this._recoverHandler($x)}this._handlers=this._temp,this._temp=$X,this._temp.length=0},$g._recoverHandler=function($X){this._map[$X.key]==$X&&delete this._map[$X.key],$X.recover()},$g._create=function($X,$g,$K,$x,$Z,$n,$W,$v){if(!$K)return $Z.apply($x,$n),null;if($W){var $T=this._getHandler($x,$Z);if($T)return $T.repeat=$g,$T.userFrame=$X,$T.delay=$K,$T.ignoreRecover=$v,$T.caller=$x,$T.method=$Z,$T.args=$n,$T.exeTime=$K+($X?this.currFrame:this.currTimer+this._now()-this._lastTimer),$T}return($T=$G.create()).repeat=$g,$T.userFrame=$X,$T.delay=$K,$T.ignoreRecover=$v,$T.caller=$x,$T.method=$Z,$T.args=$n,$T.exeTime=$K+($X?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler($T),this._handlers.push($T),$T},$g._indexHandler=function($X){var $g=$X.caller,$K=$X.method,$x=$g?$g.$_GID||($g.$_GID=$J.getGID()):0,$Z=$K.$_TID||($K.$_TID=this._mid++);$X.key=$x+"_"+$Z,this._map[$X.key]=$X},$g.once=function($X,$g,$K,$x,$Z){void 0===$Z&&($Z=!0),this._create(!1,!1,$X,$g,$K,$x,$Z,!1)},$g.loop=function($X,$g,$K,$x,$Z,$n,$W){void 0===$Z&&($Z=!0),void 0===$n&&($n=!1),void 0===$W&&($W=!1);var $v=this._create(!1,!0,$X,$g,$K,$x,$Z,$W);$v&&($v.jumpFrame=$n)},$g.frameOnce=function($X,$g,$K,$x,$Z){void 0===$Z&&($Z=!0),this._create(!0,!1,$X,$g,$K,$x,$Z,!1)},$g.frameLoop=function($X,$g,$K,$x,$Z,$n){void 0===$Z&&($Z=!0),void 0===$n&&($n=!1),this._create(!0,!0,$X,$g,$K,$x,$Z,$n)},$g.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+$G._freeCount},$g.clear=function($X,$g){var $K=this._getHandler($X,$g);return!(!$K||this._isIgnoreRecover($K))&&(delete this._map[$K.key],$K.key=null,$K.clear(),!0)},$g.clearAll=function($X){if($X)for(var $g=0,$K=this._handlers.length;$g<$K;$g++){var $x=this._handlers[$g];$x.caller===$X&&(this._isIgnoreRecover($x)||(delete this._map[$x.key],$x.key=null,$x.clear()))}},$g._getHandler=function($X,$g){var $K=$X?$X.$_GID||($X.$_GID=$J.getGID()):0,$x=$g.$_TID||($g.$_TID=this._mid++);return this._map[$K+"_"+$x]},$g._isIgnoreRecover=function($X){if($X.ignoreRecover||$X.caller&&"IgnoreRecover"==$X.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var $g="";try{arguments.propertyIsEnumerable.caller}catch($X){$g=$X.stack}$D.recordError("报错：核心定时器销毁忽略  "+$g)}return!0}return!1},$g.hasHandler=function($X,$g){return this._map[$X.$_GID+"_"+$g.$_TID]},$g.callLater=function($X,$g,$K){if(null==this._getHandler($X,$g)){var $x=$G.create();$x.caller=$X,$x.method=$g,$x.args=$K,this._indexHandler($x),this._laters.push($x)}},$g.runCallLater=function($X,$g){var $K=this._getHandler($X,$g);$K&&null!=$K.method&&(this._isIgnoreRecover($K)||(delete this._map[$K.key],$K.run(!0)))},$g.runTimer=function($X,$g){this.runCallLater($X,$g)},$c(0,$g,"delta",function(){return this._delta}),$X.__init$=function(){$G=function(){function $g(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}$a($g,"");var $X=$g.prototype;return $X.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},$X.recover=function(){this.clear(),this.args=$g._freeHandler,$g._freeHandler=this,$g._freeCount++},$X.run=function($X){var $g=this.caller;if($g&&$g.destroyed)return this.clear();var $K=this.method,$x=this.args;$X&&this.clear(),null!=$K&&($x?$K.apply($g,$x):$K.call($g))},$g._freeHandler=null,$g._freeCount=0,$g.create=function(){var $X=$g._freeHandler;return $X?($g._freeHandler=$X.args,--$g._freeCount,$X.args=null,$X):new $g},$g}()},$X}()),$z=function(){function $_(){this.gid=0}$a($_,"laya.utils.Tween");var $X=$_.prototype;return $X.to=function($X,$g,$K,$x,$Z,$n,$W){return void 0===$n&&($n=0),void 0===$W&&($W=!1),this._create($X,$g,$K,$x,$Z,$n,$W,!0,!1,!0)},$X.from=function($X,$g,$K,$x,$Z,$n,$W){return void 0===$n&&($n=0),void 0===$W&&($W=!1),this._create($X,$g,$K,$x,$Z,$n,$W,!1,!1,!0)},$X._create=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){if(!$X)throw new Error("Tween:target is null");this._target=$X,this._duration=$K,this._ease=$x||$g.ease||$_.easeNone,this._complete=$Z||$g.complete,this._delay=$n,this._props=[],this._usedTimer=0,this._startTimer=$q.now(),this._usedPool=$T,this._delayParam=null,this.update=$g.update;var $c=$X.$_GID||($X.$_GID=$J.getGID());return $_.tweenMap[$c]?($W&&$_.clearTween($X),$_.tweenMap[$c].push(this)):$_.tweenMap[$c]=[this],$G?$n<=0?this.firstStart($X,$g,$v):(this._delayParam=[$X,$g,$v],$D.scaleTimer.once($n,this,this.firstStart,this._delayParam)):this._initProps($X,$g,$v),this},$X.firstStart=function($X,$g,$K){this._delayParam=null,$X.destroyed?this.clear():(this._initProps($X,$g,$K),this._beginLoop())},$X._initProps=function($X,$g,$K){for(var $x in $g)if("number"==typeof $X[$x]){var $Z=$K?$X[$x]:$g[$x],$n=$K?$g[$x]:$X[$x];this._props.push([$x,$Z,$n-$Z]),$K||($X[$x]=$Z)}},$X._beginLoop=function(){$D.scaleTimer.frameLoop(1,this,this._doEase)},$X._doEase=function(){this._updateEase($q.now())},$X._updateEase=function($X){var $g=this._target;if($g){if($g.destroyed)return $_.clearTween($g);var $K=this._usedTimer=$X-this._startTimer-this._delay;if(!($K<0)){if($K>=this._duration)return this.complete();for(var $x=0<$K?this._ease($K,0,1,this._duration):0,$Z=this._props,$n=0,$W=$Z.length;$n<$W;$n++){var $v=$Z[$n];$g[$v[0]]=$v[1]+$x*$v[2]}this.update&&this.update.run()}}},$X.complete=function(){if(this._target){$D.scaleTimer.runTimer(this,this.firstStart);for(var $X=this._target,$g=this._props,$K=this._complete,$x=0,$Z=$g.length;$x<$Z;$x++){var $n=$g[$x];$X[$n[0]]=$n[1]+$n[2]}this.update&&this.update.run(),this.clear(),$K&&$K.run()}},$X.pause=function(){$D.scaleTimer.clear(this,this._beginLoop),$D.scaleTimer.clear(this,this._doEase),$D.scaleTimer.clear(this,this.firstStart);var $X;($X=$q.now()-this._startTimer-this._delay)<0&&(this._usedTimer=$X)},$X.setStartTime=function($X){this._startTimer=$X},$X.clear=function(){this._target&&(this._remove(),this._clear())},$X._clear=function(){this.pause(),$D.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,$j.recover("tween",this))},$X.recover=function(){this._usedPool=!0,this._clear()},$X._remove=function(){var $X=$_.tweenMap[this._target.$_GID];if($X)for(var $g=0,$K=$X.length;$g<$K;$g++)if($X[$g]===this){$X.splice($g,1);break}},$X.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=$q.now(),this._delayParam)$D.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var $X=this._props,$g=0,$K=$X.length;$g<$K;$g++){var $x=$X[$g];this._target[$x[0]]=$x[1]}$D.scaleTimer.once(this._delay,this,this._beginLoop)}},$X.resume=function(){this._usedTimer>=this._duration||(this._startTimer=$q.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?$D.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},$c(0,$X,"progress",null,function($X){var $g=$X*this._duration;this._startTimer=$q.now()-this._delay-$g}),$_.to=function($X,$g,$K,$x,$Z,$n,$W,$v){return void 0===$n&&($n=0),void 0===$W&&($W=!1),void 0===$v&&($v=!0),$j.getItemByClass("tween",$_)._create($X,$g,$K,$x,$Z,$n,$W,!0,$v,!0)},$_.from=function($X,$g,$K,$x,$Z,$n,$W,$v){return void 0===$n&&($n=0),void 0===$W&&($W=!1),void 0===$v&&($v=!0),$j.getItemByClass("tween",$_)._create($X,$g,$K,$x,$Z,$n,$W,!1,$v,!0)},$_.clearAll=function($X){if($X&&$X.$_GID){var $g=$_.tweenMap[$X.$_GID];if($g){for(var $K=0,$x=$g.length;$K<$x;$K++)$g[$K]._clear();$g.length=0}}},$_.clear=function($X){$X.clear()},$_.clearTween=function($X){$_.clearAll($X)},$_.easeNone=function($X,$g,$K,$x){return $K*$X/$x+$g},$_.tweenMap={},$_}(),$J=function(){function $v(){}return $a($v,"laya.utils.Utils"),$v.toRadian=function($X){return $X*$v._pi2},$v.toAngle=function($X){return $X*$v._pi},$v.toHexColor=function($X){if($X<0||isNaN($X))return null;for(var $g=$X.toString(16);$g.length<6;)$g="0"+$g;return"#"+$g},$v.getGID=function(){return $v._gid++},$v.concatArray=function($X,$g){if(!$g)return $X;if(!$X)return $g;var $K=0,$x=$g.length;for($K=0;$K<$x;$K++)$X.push($g[$K]);return $X},$v.clearArray=function($X){return $X&&($X.length=0),$X},$v.copyArray=function($X,$g){if($X||($X=[]),!$g)return $X;$X.length=$g.length;var $K=0,$x=$g.length;for($K=0;$K<$x;$K++)$X[$K]=$g[$K];return $X},$v.getGlobalRecByPoints=function($X,$g,$K,$x,$Z){var $n,$W;return $n=new $B($g,$K),$n=$X.localToGlobal($n),$W=new $B($x,$Z),$W=$X.localToGlobal($W),$i._getWrapRec([$n.x,$n.y,$W.x,$W.y])},$v.getGlobalPosAndScale=function($X){return $v.getGlobalRecByPoints($X,0,0,1,1)},$v.bind=function($X,$g){return $X.bind($g)},$v.measureText=function($X,$g){return $t.measureText($X,$g)},$v.contextMeasureText=function($X){var $g=$q.context.measureText($X);return $g||($g={width:16,height:16}),$g},$v.updateOrder=function($X){if(!$X||$X.length<2)return!1;for(var $g,$K=1,$x=0,$Z=$X.length,$n=NaN;$K<$Z;){for($g=$X[$x=$K],$n=$X[$x]._zOrder;-1<--$x&&$X[$x]._zOrder>$n;)$X[$x+1]=$X[$x];$X[$x+1]=$g,$K++}var $W=$g.parent.conchModel;if($W)if(null!=$W.updateZOrder)$W.updateZOrder();else{for($K=0;$K<$Z;$K++)$W.removeChild($X[$K].conchModel);for($K=0;$K<$Z;$K++)$W.addChildAt($X[$K].conchModel,$K)}return!0},$v.transPointList=function($X,$g,$K){var $x=0,$Z=$X.length;for($x=0;$x<$Z;$x+=2)$X[$x]+=$g,$X[$x+1]+=$K},$v.parseInt=function($X,$g){void 0===$g&&($g=0);var $K=$q.window.parseInt($X,$g);return isNaN($K)?0:$K},$v.getFileExtension=function($X){$v._extReg.lastIndex=$X.lastIndexOf(".");var $g=$v._extReg.exec($X);return $g&&1<$g.length?$g[1].toLowerCase():null},$v.getTransformRelativeToWindow=function($X,$g,$K){var $x=$D.stage,$Z=laya.utils.Utils.getGlobalPosAndScale($X),$n=$x._canvasTransform.clone(),$W=$n.tx,$v=$n.ty;$n.rotate(-Math.PI/180*$D.stage.canvasDegree),$n.scale($D.stage.clientScaleX,$D.stage.clientScaleY);var $T=$D.stage.canvasDegree%180!=0,$G=NaN,$c=NaN;$T?($G=$K+$Z.y,$c=$g+$Z.x,$G*=$n.d,$c*=$n.a,90==$D.stage.canvasDegree?($G=$W-$G,$c+=$v):($G+=$W,$c=$v-$c)):($G=$g+$Z.x,$c=$K+$Z.y,$G*=$n.a,$c*=$n.d,$G+=$W,$c+=$v);var $_=NaN,$s=NaN;return $s=$T?($_=$n.d*$Z.height,$n.a*$Z.width):($_=$n.a*$Z.width,$n.d*$Z.height),{x:$G,y:$c,scaleX:$_,scaleY:$s}},$v.fitDOMElementInArea=function($X,$g,$K,$x,$Z,$n){$X._fitLayaAirInitialized||($X._fitLayaAirInitialized=!0,$X.style.transformOrigin=$X.style.webKittransformOrigin="left top",$X.style.position="absolute");var $W=$v.getTransformRelativeToWindow($g,$K,$x);$X.style.transform=$X.style.webkitTransform="scale("+$W.scaleX+","+$W.scaleY+") rotate("+$D.stage.canvasDegree+"deg)",$X.style.width=$Z+"px",$X.style.height=$n+"px",$X.style.left=$W.x+"px",$X.style.top=$W.y+"px"},$v.isOkTextureList=function($X){if(!$X)return!1;var $g,$K=0,$x=$X.length;for($K=0;$K<$x;$K++)if(!($g=$X[$K])||!$g.source)return!1;return!0},$v.isOKCmdList=function($X){if(!$X)return!1;var $g,$K,$x=0,$Z=$X.length,$n=$C._context;for($x=0;$x<$Z;$x++)switch(($g=$X[$x]).callee){case $n._drawTexture:case $n._fillTexture:case $n._drawTextureWithTransform:if(!($K=$g[0])||!$K.source)return!1}return!0},$v._gid=1,$v._pi=180/Math.PI,$v._pi2=Math.PI/180,$v._extReg=/\.(\w+)\??/g,$v.parseXMLFromString=function($X){var $g;if($X=$X.replace(/>\s+</g,"><"),-1<($g=(new DOMParser).parseFromString($X,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error($g.firstChild.firstChild.textContent);return $g},$v}(),$o=function(){function $X(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],$C.isWebGL&&$u.regCacheByFunction($J.bind(this.startDispose,this),$J.bind(this.getCacheList,this))}$a($X,"laya.utils.VectorGraphManager");var $g=$X.prototype;return $g.getId=function(){return this._id++},$g.addShape=function($X,$g){this.shapeDic[$X]=$g,this.useDic[$X]||(this.useDic[$X]=!0)},$g.addLine=function($X,$g){this.shapeLineDic[$X]=$g,this.shapeLineDic[$X]||(this.shapeLineDic[$X]=!0)},$g.getShape=function($X){this._checkKey&&null!=this.useDic[$X]&&(this.useDic[$X]=!0)},$g.deleteShape=function($X){this.shapeDic[$X]&&(this.shapeDic[$X]=null,delete this.shapeDic[$X]),this.shapeLineDic[$X]&&(this.shapeLineDic[$X]=null,delete this.shapeLineDic[$X]),null!=this.useDic[$X]&&delete this.useDic[$X]},$g.getCacheList=function(){var $X,$g=[];for($X in this.shapeDic)$g.push(this.shapeDic[$X]);for($X in this.shapeLineDic)$g.push(this.shapeLineDic[$X]);return $g},$g.startDispose=function($X){var $g;for($g in this.useDic)this.useDic[$g]=!1;this._checkKey=!0},$g.endDispose=function(){if(this._checkKey){var $X;for($X in this.useDic)this.useDic[$X]||this.deleteShape($X);this._checkKey=!1}},$X.getInstance=function(){return $X.instance=$X.instance||new $X},$X.instance=null,$X}(),$H=function(){function $x(){this._obj=null,this._obj=$x.supportWeakMap?new $q.window.WeakMap:{},$x.supportWeakMap||$x._maps.push(this)}$a($x,"laya.utils.WeakObject");var $X=$x.prototype;return $X.set=function($X,$g){if(null!=$X)if($x.supportWeakMap){var $K=$X;"string"!=typeof $X&&"number"!=typeof $X||($K=$x._keys[$X])||($K=$x._keys[$X]={k:$X}),this._obj.set($K,$g)}else"string"==typeof $X||"number"==typeof $X?this._obj[$X]=$g:($X.$_GID||($X.$_GID=$J.getGID()),this._obj[$X.$_GID]=$g)},$X.get=function($X){if(null==$X)return null;if($x.supportWeakMap){var $g="string"==typeof $X||"number"==typeof $X?$x._keys[$X]:$X;return $g?this._obj.get($g):null}return"string"==typeof $X||"number"==typeof $X?this._obj[$X]:this._obj[$X.$_GID]},$X.del=function($X){if(null!=$X)if($x.supportWeakMap){var $g="string"==typeof $X||"number"==typeof $X?$x._keys[$X]:$X;if(!$g)return;this._obj.delete($g)}else"string"==typeof $X||"number"==typeof $X?delete this._obj[$X]:delete this._obj[this._obj.$_GID]},$X.has=function($X){if(null==$X)return!1;if($x.supportWeakMap){var $g="string"==typeof $X||"number"==typeof $X?$x._keys[$X]:$X;return this._obj.has($g)}return"string"==typeof $X||"number"==typeof $X?null!=this._obj[$X]:null!=this._obj[this._obj.$_GID]},$x.__init__=function(){($x.supportWeakMap=null!=$q.window.WeakMap)||$D.timer.loop($x.delInterval,null,$x.clearCache)},$x.clearCache=function(){for(var $X=0,$g=$x._maps.length;$X<$g;$X++){$x._maps[$X]._obj={}}},$x.supportWeakMap=!1,$x.delInterval=3e5,$x._keys={},$x._maps=[],$T($x,["I",function(){return this.I=new $x}]),$x}(),$y=function(){function $X(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}$a($X,"laya.utils.WordText");var $g=$X.prototype;return $g.setText=function($X){this.changed=!0,this._text=$X},$g.toString=function(){return this._text},$g.charCodeAt=function($X){return this._text?this._text.charCodeAt($X):NaN},$g.charAt=function($X){return this._text?this._text.charAt($X):null},$c(0,$g,"length",function(){return this._text?this._text.length:0}),$X}(),$XX=function($X){function $W(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,$W.__super.call(this),this._childs=$W.ARRAY_EMPTY,this._$P=$W.PROP_EMPTY,this.timer=$D.scaleTimer,this.conchModel=$C.isConchNode?this.createConchModel():null}$a($W,"laya.display.Node",$G);var $g=$W.prototype;return $g._setBit=function($X,$g){1==$X&&(this._getBit($X)!=$g&&this._updateDisplayedInstage());$g?this._bits|=$X:this._bits&=~$X},$g._getBit=function($X){return 0!=(this._bits&$X)},$g._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},$g._setUpNoticeType=function($X){var $g=this;for($g._setBit($X,!0),$g=$g.parent;$g;){if($g._getBit($X))return;$g._setBit($X,!0),$g=$g.parent}},$g.on=function($X,$g,$K,$x){return"display"!==$X&&"undisplay"!==$X||this._getBit(1)||this._setUpNoticeType(1),this._createListener($X,$g,$K,$x,!1)},$g.once=function($X,$g,$K,$x){return"display"!==$X&&"undisplay"!==$X||this._getBit(1)||this._setUpNoticeType(1),this._createListener($X,$g,$K,$x,!0)},$g.createConchModel=function(){return null},$g.destroy=function($X){void 0===$X&&($X=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&($X?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},$g.destroyChildren=function(){if(this._childs)for(var $X=this._childs.length-1;-1<$X;$X--)this._childs[$X].destroy(!0)},$g.addChild=function($X){if(!$X||this.destroyed||$X===this)return $X;if($X.zOrder&&this._set$P("hasZorder",!0),$X._parent===this){var $g=this.getChildIndex($X);$g!==this._childs.length-1&&(this._childs.splice($g,1),this._childs.push($X),this.conchModel&&(this.conchModel.removeChild($X.conchModel),this.conchModel.addChildAt($X.conchModel,this._childs.length-1)),this._childChanged())}else $X.parent&&$X.parent.removeChild($X),this._childs===$W.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($X),this.conchModel&&this.conchModel.addChildAt($X.conchModel,this._childs.length-1),($X.parent=this)._childChanged();return $X},$g.addChildren=function($X){for(var $g=arguments,$K=0,$x=$g.length;$K<$x;)this.addChild($g[$K++])},$g.addChildAt=function($X,$g){if(!$X||this.destroyed||$X===this)return $X;if($X.zOrder&&this._set$P("hasZorder",!0),0<=$g&&$g<=this._childs.length){if($X._parent===this){var $K=this.getChildIndex($X);this._childs.splice($K,1),this._childs.splice($g,0,$X),this.conchModel&&(this.conchModel.removeChild($X.conchModel),this.conchModel.addChildAt($X.conchModel,$g)),this._childChanged()}else $X.parent&&$X.parent.removeChild($X),this._childs===$W.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($g,0,$X),this.conchModel&&this.conchModel.addChildAt($X.conchModel,$g),$X.parent=this;return $X}throw new Error("appendChildAt:The index is out of bounds")},$g.getChildIndex=function($X){return this._childs.indexOf($X)},$g.getChildByName=function($X){var $g=this._childs;if($g)for(var $K=0,$x=$g.length;$K<$x;$K++){var $Z=$g[$K];if($Z.name===$X)return $Z}return null},$g._get$P=function($X){return this._$P[$X]},$g._set$P=function($X,$g){return this.destroyed||(this._$P===$W.PROP_EMPTY&&(this._$P={}),this._$P[$X]=$g),$g},$g.getChildAt=function($X){return this._childs[$X]},$g.setChildIndex=function($X,$g){var $K=this._childs;if($g<0||$g>=$K.length)throw new Error("setChildIndex:The index is out of bounds.");var $x=this.getChildIndex($X);if($x<0)throw new Error("setChildIndex:node is must child of this object.");return $K.splice($x,1),$K.splice($g,0,$X),this.conchModel&&(this.conchModel.removeChild($X.conchModel),this.conchModel.addChildAt($X.conchModel,$g)),this._childChanged(),$X},$g._childChanged=function($X){},$g.removeChild=function($X){if(!this._childs)return $X;var $g=this._childs.indexOf($X);return this.removeChildAt($g)},$g.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},$g.removeChildByName=function($X){var $g=this.getChildByName($X);return $g&&this.removeChild($g),$g},$g.removeChildAt=function($X){var $g=this.getChildAt($X);if($g){for(var $K=this._childs.length-1,$x=$X;$x<$K;++$x)this._childs[$x]=this._childs[$x+1];this._childs.length=$K,this.conchModel&&this.conchModel.removeChild($g.conchModel),$g.parent=null}return $g},$g.removeChildren=function($X,$g){if(void 0===$X&&($X=0),void 0===$g&&($g=2147483647),this._childs&&0<this._childs.length){var $K=this._childs;if(0===$X&&$n<=$g){var $x=$K;this._childs=$W.ARRAY_EMPTY}else $x=$K.splice($X,$g-$X);for(var $Z=0,$n=$x.length;$Z<$n;$Z++)$x[$Z].parent=null,this.conchModel&&this.conchModel.removeChild($x[$Z].conchModel)}return this},$g.replaceChild=function($X,$g){var $K=this._childs.indexOf($g);return-1<$K?(this._childs.splice($K,1,$X),this.conchModel&&(this.conchModel.removeChild($g.conchModel),this.conchModel.addChildAt($X.conchModel,$K)),$g.parent=null,$X.parent=this,$X):null},$g._updateDisplayedInstage=function(){var $X;$X=this;var $g=$D.stage;for(this._displayedInStage=!1;$X;){if($X._getBit(1)){this._displayedInStage=$X._displayedInStage;break}if($X==$g||$X._displayedInStage){this._displayedInStage=!0;break}$X=$X.parent}},$g._setDisplay=function($X){this._displayedInStage!==$X&&((this._displayedInStage=$X)?this.event("display"):this.event("undisplay"))},$g._displayChild=function($X,$g){var $K=$X._childs;if($K)for(var $x=0;$x<$K.length;$x++){var $Z=$K[$x];$Z&&$Z._getBit(1)&&(0<$Z._childs.length?this._displayChild($Z,$g):$Z._setDisplay($g))}$X._setDisplay($g)},$g.contains=function($X){if($X===this)return!0;for(;$X;){if($X.parent===this)return!0;$X=$X.parent}return!1},$g.timerLoop=function($X,$g,$K,$x,$Z,$n){void 0===$Z&&($Z=!0),void 0===$n&&($n=!1),this.timer.loop($X,$g,$K,$x,$Z,$n)},$g.timerOnce=function($X,$g,$K,$x,$Z){void 0===$Z&&($Z=!0),this.timer._create(!1,!1,$X,$g,$K,$x,$Z)},$g.frameLoop=function($X,$g,$K,$x,$Z){void 0===$Z&&($Z=!0),this.timer._create(!0,!0,$X,$g,$K,$x,$Z)},$g.frameOnce=function($X,$g,$K,$x,$Z){void 0===$Z&&($Z=!0),this.timer._create(!0,!1,$X,$g,$K,$x,$Z)},$g.clearTimer=function($X,$g){this.timer.clear($X,$g)},$c(0,$g,"numChildren",function(){return this._childs.length}),$c(0,$g,"destroyed",function(){return this._destroyed}),$c(0,$g,"parent",function(){return this._parent},function($X){this._parent!==$X&&($X?(this._parent=$X,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),$X.displayedInStage&&this._displayChild(this,!0)),$X._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=$X))}),$c(0,$g,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),$W.ARRAY_EMPTY=[],$W.PROP_EMPTY={},$W.NOTICE_DISPLAY=1,$W.MOUSEENABLE=2,$W}(),$gX=function($X){function $s($X){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,$s.__super.call(this),this._padding=$s._PADDING,this._spacing=$s._SPACING,this._aligns=$s._ALIGNS,this._font=$V.EMPTY,this._ower=$X}$a($s,"laya.display.css.CSSStyle",$X);var $g=$s.prototype;return $g.destroy=function(){this._ower=null,this._font=null,this._rect=null},$g.inherit=function($X){this._font=$X._font,this._spacing=$X._spacing===$s._SPACING?$s._SPACING:$X._spacing.slice(),this.lineHeight=$X.lineHeight},$g._widthAuto=function(){return 0!=(262144&this._type)},$g.widthed=function($X){return 0!=(8&this._type)},$g._calculation=function($X,$g){if($g.indexOf("%")<0)return!1;var $x=this._ower,$Z=$x.parent,$n=this._rect;function $W($X,$g,$K){return $X*$K[0]+$g*$K[1]+$K[2]}function $K($X){var $g=$Z.width,$K=$x.width;$n.width&&($x.width=$W($g,$K,$n.width)),$n.height&&($x.height=$W($g,$K,$n.height)),$n.left&&($x.x=$W($g,$K,$n.left)),$n.top&&($x.y=$W($g,$K,$n.top))}null===$n&&($Z._getCSSStyle()._type|=524288,$Z.on("resize",this,$K),this._rect=$n={input:{}});var $v=$g.split(" ");return $v[0]=parseFloat($v[0])/100,1==$v.length?$v[1]=$v[2]=0:($v[1]=parseFloat($v[1])/100,$v[2]=parseFloat($v[2])),$n[$X]=$v,$n.input[$X]=$g,$K(),!0},$g.heighted=function($X){return 0!=(8192&this._type)},$g.size=function($X,$g){var $K=this._ower,$x=!1;-1!==$X&&$X!=this._ower.width&&(this._type|=8,this._ower.width=$X,$x=!0),-1!==$g&&$g!=this._ower.height&&(this._type|=8192,this._ower.height=$g,$x=!0),$x&&($K._layoutLater(),524288&this._type&&$K.event("resize",this))},$g._getAlign=function(){return this._aligns[0]},$g._getValign=function(){return this._aligns[1]},$g._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},$g._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new $V(this._font))},$g.render=function($X,$g,$K,$x){var $Z=$X.width,$n=$X.height;$K-=$X.pivotX,$x-=$X.pivotY,this._bgground&&null!=this._bgground.color&&$g.ctx.fillRect($K,$x,$Z,$n,this._bgground.color),this._border&&this._border.color&&$g.drawRect($K,$x,$Z,$n,this._border.color.strColor,this._border.size)},$g.getCSSStyle=function(){return this},$g.cssText=function($X){this.attrs($s.parseOneCSS($X,";"))},$g.attrs=function($X){if($X)for(var $g=0,$K=$X.length;$g<$K;$g++){var $x=$X[$g];this[$x[0]]=$x[1]}},$g.setTransform=function($X){"none"===$X?this._tf=$v._TF_EMPTY:this.attrs($s.parseOneCSS($X,","))},$g.translate=function($X,$g){this._tf===$v._TF_EMPTY&&(this._tf=new $Z),this._tf.translateX=$X,this._tf.translateY=$g},$g.scale=function($X,$g){this._tf===$v._TF_EMPTY&&(this._tf=new $Z),this._tf.scaleX=$X,this._tf.scaleY=$g},$g._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},$c(0,$g,"block",$X.prototype._$get_block,function($X){$X?this._type|=1:this._type&=-2}),$c(0,$g,"valign",function(){return $s._valigndef[this._aligns[1]]},function($X){this._aligns===$s._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=$s._valigndef[$X]}),$c(0,$g,"height",null,function($X){if(this._type|=8192,"string"==typeof $X){if(this._calculation("height",$X))return;$X=parseInt($X)}this.size(-1,$X)}),$c(0,$g,"width",null,function($X){if(this._type|=8,"string"==typeof $X){var $g=$X.indexOf("auto");if(0<=$g&&(this._type|=262144,$X=$X.substr(0,$g)),this._calculation("width",$X))return;$X=parseInt($X)}this.size($X,-1)}),$c(0,$g,"fontWeight",function(){return this._font.weight},function($X){this._createFont().weight=$X}),$c(0,$g,"left",null,function($X){var $g=this._ower;if("string"==typeof $X){if("center"===$X?$X="50% -50% 0":"right"===$X&&($X="100% -100% 0"),this._calculation("left",$X))return;$X=parseInt($X)}$g.x=$X}),$c(0,$g,"_translate",null,function($X){this.translate($X[0],$X[1])}),$c(0,$g,"absolute",function(){return 0!=(4&this._type)}),$c(0,$g,"top",null,function($X){var $g=this._ower;if("string"==typeof $X){if("middle"===$X?$X="50% -50% 0":"bottom"===$X&&($X="100% -100% 0"),this._calculation("top",$X))return;$X=parseInt($X)}$g.y=$X}),$c(0,$g,"align",function(){return $s._aligndef[this._aligns[0]]},function($X){this._aligns===$s._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=$s._aligndef[$X]}),$c(0,$g,"bold",function(){return this._font.bold},function($X){this._createFont().bold=$X}),$c(0,$g,"padding",function(){return this._padding},function($X){this._padding=$X}),$c(0,$g,"leading",function(){return this._spacing[1]},function($X){"string"==typeof $X&&($X=parseInt($X+"")),this._spacing===$s._SPACING&&(this._spacing=[0,0]),this._spacing[1]=$X}),$c(0,$g,"lineElement",function(){return 0!=(65536&this._type)},function($X){$X?this._type|=65536:this._type&=-65537}),$c(0,$g,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function($X){this.lineElement=!1,"right"===$X?this._type|=32768:this._type&=-32769}),$c(0,$g,"textDecoration",function(){return this._font.decoration},function($X){this._createFont().decoration=$X}),$c(0,$g,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function($X){"nowrap"===$X&&(this._type|=131072),"none"===$X&&(this._type&=-131073)}),$c(0,$g,"background",null,function($X){$X?(this._bgground||(this._bgground={}),this._bgground.color=$X,this._ower.conchModel&&this._ower.conchModel.bgColor($X),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),$c(0,$g,"wordWrap",function(){return 0==(131072&this._type)},function($X){$X?this._type&=-131073:this._type|=131072}),$c(0,$g,"color",function(){return this._font.color},function($X){this._createFont().color=$X}),$c(0,$g,"password",function(){return this._font.password},function($X){this._createFont().password=$X}),$c(0,$g,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function($X){"none"===$X?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=$X),this._ower.conchModel&&this._ower.conchModel.bgColor($X),this._ower._renderType|=256}),$c(0,$g,"font",function(){return this._font.toString()},function($X){this._createFont().set($X)}),$c(0,$g,"weight",null,function($X){this._createFont().weight=$X}),$c(0,$g,"letterSpacing",function(){return this._spacing[0]},function($X){"string"==typeof $X&&($X=parseInt($X+"")),this._spacing===$s._SPACING&&(this._spacing=[0,0]),this._spacing[0]=$X}),$c(0,$g,"fontSize",function(){return this._font.size},function($X){this._createFont().size=$X}),$c(0,$g,"italic",function(){return this._font.italic},function($X){this._createFont().italic=$X}),$c(0,$g,"fontFamily",function(){return this._font.family},function($X){this._createFont().family=$X}),$c(0,$g,"stroke",function(){return this._font.stroke[0]},function($X){this._createFont().stroke===$V._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=$X}),$c(0,$g,"strokeColor",function(){return this._font.stroke[1]},function($X){this._createFont().stroke===$V._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=$X}),$c(0,$g,"border",function(){return this._border?this._border.value:""},function($X){if("none"!=$X){this._border||(this._border={});var $g=(this._border.value=$X).split(" ");if(this._border.color=$e.create($g[$g.length-1]),1==$g.length)return this._border.size=1,void(this._border.type="solid");var $K=0;0<$g[0].indexOf("px")?(this._border.size=parseInt($g[0]),$K++):this._border.size=1,this._border.type=$g[$K],this._ower._renderType|=256}else this._border=null}),$c(0,$g,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function($X){$X?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==$X?null:$e.create($X),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),$c(0,$g,"position",function(){return 4&this._type?"absolute":""},function($X){"absolute"==$X?this._type|=4:this._type&=-5}),$c(0,$g,"display",null,function($X){switch($X){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),$c(0,$g,"paddingLeft",function(){return this.padding[3]}),$c(0,$g,"paddingTop",function(){return this.padding[0]}),$c(0,$g,"_scale",null,function($X){this._ower.scale($X[0],$X[1])}),$c(0,$g,"_rotate",null,function($X){this._ower.rotation=$X}),$s.parseOneCSS=function($X,$g){for(var $K,$x=[],$Z=$X.split($g),$n=0,$W=$Z.length;$n<$W;$n++){var $v=$Z[$n],$T=$v.indexOf(":"),$G=$v.substr(0,$T).replace(/^\s+|\s+$/g,"");if(0!=$G.length){var $c=$v.substr($T+1).replace(/^\s+|\s+$/g,""),$_=[$G,$c];switch($G){case"italic":case"bold":$_[1]="true"==$c;break;case"line-height":$_[0]="lineHeight",$_[1]=parseInt($c);break;case"font-size":$_[0]="fontSize",$_[1]=parseInt($c);break;case"padding":1<($K=$c.split(" ")).length||($K[1]=$K[2]=$K[3]=$K[0]),$_[1]=[parseInt($K[0]),parseInt($K[1]),parseInt($K[2]),parseInt($K[3])];break;case"rotate":$_[0]="_rotate",$_[1]=parseFloat($c);break;case"scale":$K=$c.split(" "),$_[0]="_scale",$_[1]=[parseFloat($K[0]),parseFloat($K[1])];break;case"translate":$K=$c.split(" "),$_[0]="_translate",$_[1]=[parseInt($K[0]),parseInt($K[1])];break;default:($_[0]=$s._CSSTOVALUE[$G])||($_[0]=$G)}$x.push($_)}}return $x},$s.parseCSS=function($X,$g){for(var $K;null!=($K=$s._parseCSSRegExp.exec($X));)$s.styleSheets[$K[1]]=$s.parseOneCSS($K[2],";")},$s.EMPTY=new $s(null),$s._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},$s._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),$s._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},$s._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},$s.styleSheets={},$s.ALIGN_CENTER=1,$s.ALIGN_RIGHT=2,$s.VALIGN_MIDDLE=1,$s.VALIGN_BOTTOM=2,$s._CSS_BLOCK=1,$s._DISPLAY_NONE=2,$s._ABSOLUTE=4,$s._WIDTH_SET=8,$s._PADDING=[0,0,0,0],$s._RECT=[-1,-1,-1,-1],$s._SPACING=[0,0],$s._ALIGNS=[0,0,0],$s.ADDLAYOUTED=512,$s._NEWFONT=4096,$s._HEIGHT_SET=8192,$s._BACKGROUND_SET=16384,$s._FLOAT_RIGHT=32768,$s._LINE_ELEMENT=65536,$s._NOWARP=131072,$s._WIDTHAUTO=262144,$s._LISTERRESZIE=524288,$s}($v),$KX=function($X){function $W(){this.url=null,this.audio=null,this.loaded=!1,$W.__super.call(this)}$a($W,"laya.media.h5audio.AudioSound",$G);var $g=$W.prototype;return $g.dispose=function(){var $X=$W._audioCache[this.url];$X&&($X.src="",delete $W._audioCache[this.url])},$g.load=function($X){var $g;if($X=$N.formatURL($X),(this.url=$X)==$r._tMusic?($W._initMusicAudio(),($g=$W._musicAudio).src!=$X&&($W._audioCache[$g.src]=null,$g=null)):$g=$W._audioCache[$X],$g&&2<=$g.readyState)this.event("complete");else{$g||($g=$X==$r._tMusic?($W._initMusicAudio(),$W._musicAudio):$q.createElement("audio"),($W._audioCache[$X]=$g).src=$X),$g.addEventListener("canplaythrough",$x),$g.addEventListener("error",$Z);var $K=this;(this.audio=$g).load?$g.load():$Z()}function $x(){$n(),$K.loaded=!0,$K.event("complete")}function $Z(){$g.load=null,$n(),$K.event("error")}function $n(){$g.removeEventListener("canplaythrough",$x),$g.removeEventListener("error",$Z)}},$g.play=function($X,$g,$K){if(void 0===$X&&($X=0),void 0===$g&&($g=0),!this.url)return null;var $x,$Z;if(!($x=this.url==$r._tMusic?$W._musicAudio:$W._audioCache[this.url]))return null;$Z=$j.getItem("audio:"+this.url),$C.isConchApp?$Z||(($Z=$q.createElement("audio")).src=this.url):this.url==$r._tMusic?($W._initMusicAudio(),($Z=$W._musicAudio).src=this.url):$Z=$Z||$x.cloneNode(!0);var $n=new $sX($Z);return $n.url=this.url,$n.loops=$g,$n.startTime=$X,$n.startHandler=$K,$n.play(!1),$r.addChannel($n),$n},$c(0,$g,"duration",function(){var $X;return($X=$W._audioCache[this.url])?$X.duration:0}),$W._initMusicAudio=function(){$W._musicAudio||($W._musicAudio||($W._musicAudio=$q.createElement("audio")),$C.isConchApp||$q.document.addEventListener("mousedown",$W._makeMusicOK))},$W._makeMusicOK=function(){$q.document.removeEventListener("mousedown",$W._makeMusicOK),$W._musicAudio.src?$W._musicAudio.play():($W._musicAudio.src="",$W._musicAudio.load())},$W._audioCache={},$W._musicAudio=null,$W}(),$xX=function($X){function $g(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,$g.__super.call(this)}$a($g,"laya.media.SoundChannel",$G);var $K=$g.prototype;return $K.play=function(){},$K.stop=function(){},$K.pause=function(){},$K.resume=function(){},$K.__runComplete=function($X){$X&&$X.run()},$c(0,$K,"volume",function(){return 1},function($X){}),$c(0,$K,"position",function(){return 0}),$c(0,$K,"duration",function(){return 0}),$g}(),$ZX=function($X){function $g(){$g.__super.call(this)}$a($g,"laya.media.Sound",$G);var $K=$g.prototype;return $K.load=function($X){},$K.play=function($X,$g,$K){return void 0===$X&&($X=0),void 0===$g&&($g=0),null},$K.dispose=function(){},$c(0,$K,"duration",function(){return 0}),$g}(),$nX=function($X){function $Z(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,$Z.__super.call(this)}$a($Z,"laya.media.webaudio.WebAudioSound",$G);var $g=$Z.prototype;return $g.load=function($X){this.url=$X,this.audioBuffer=$Z._dataCache[$X],this.audioBuffer?this._loaded(this.audioBuffer):($Z.e.on("loaded:"+$X,this,this._loaded),$Z.e.on("err:"+$X,this,this._err),$Z.__loadingSound[$X]||($Z.__loadingSound[$X]=!0,$D.loader.load($X,$U.create(this,this.onloaded),null,$vX.BUFFER,4,!1,null,!0)))},$g.onloaded=function($X){$X||this._err(),this._disposed?this._removeLoadEvents():(this.data=$X,$Z.buffs.push({buffer:this.data,url:this.url}),$Z.decode())},$g._err=function(){if(this._removeLoadEvents(),$Z.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var $X,$g,$K,$x=0;for($X=($g=this.__toPlays).length,$x=0;$x<$X;$x++)($K=$g[$x])[3]&&!$K[3].isStopped&&$K[3].event("error");this.__toPlays.length=0}},$g._loaded=function($X){this._removeLoadEvents(),this._disposed||(this.audioBuffer=$X,this.loaded=!0,this.event("complete"))},$g._removeLoadEvents=function(){$Z.e.off("loaded:"+this.url,this,this._loaded),$Z.e.off("err:"+this.url,this,this._err)},$g.__playAfterLoaded=function(){if(this.__toPlays){var $X,$g,$K,$x=0;for($X=($g=this.__toPlays).length,$x=0;$x<$X;$x++)($K=$g[$x])[3]&&!$K[3].isStopped&&this.play($K[0],$K[1],$K[2],$K[3]);this.__toPlays.length=0}},$g.play=function($X,$g,$K,$x){return void 0===$X&&($X=0),void 0===$g&&($g=0),$x=$x||new $VX,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([$X,$g,$K,$x]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),$x.url=this.url,$x.loops=$g,$x.audioBuffer=this.audioBuffer,$x.startTime=$X,$x.startHandler=$K,$x.play(!1),$r.addChannel($x),$x},$g.dispose=function(){this._disposed=!0,delete $Z._dataCache[this.url],delete $Z.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},$c(0,$g,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$Z.decode=function(){if(!($Z.buffs.length<=0||$Z.isDecoding))if($Z.isDecoding=!0,($Z.tInfo=$Z.buffs.shift())&&$Z.tInfo.buffer&&$Z.tInfo.buffer.byteLength)try{$Z.ctx.decodeAudioData($Z.tInfo.buffer,$Z._done,$Z._fail)}catch($X){console.error("decodeAudioData error  byteLength:"+$Z.tInfo.buffer.byteLength+"  url:"+$Z.tInfo.url)}else $Z._fail()},$Z._done=function($X){$Z.e.event("loaded:"+$Z.tInfo.url,$X),$Z._dataCache[$Z.tInfo.url]=$X,$Z.isDecoding=!1,$Z.decode()},$Z._fail=function(){$Z.e.event("err:"+$Z.tInfo.url,null),$Z.isDecoding=!1,$Z.decode()},$Z._playEmptySound=function(){if(null!=$Z.ctx){if($Z._emptySource&&($Z._emptySource.stop(),$Z._emptySource.disconnect(0),!$VX._tryCleanFailed))try{$Z._emptySource.buffer=null}catch($X){$VX._tryCleanFailed=!0}var $X=$Z.ctx.createBufferSource();$X.buffer=$Z._miniBuffer,$X.connect($Z.ctx.destination),$X.start(0,0,0),$Z._emptySource=$X}},$Z._unlock=function(){$Z._unlocked||($Z._playEmptySound(),"running"==$Z.ctx.state?($q.document.removeEventListener("mousedown",$Z._unlock,!0),$q.document.removeEventListener("touchend",$Z._unlock,!0),$q.document.removeEventListener("touchstart",$Z._unlock,!0),$Z._unlocked=!0):"suspended"==$Z.ctx.state&&$r._recoverWebAudio())},$Z.initWebAudio=function(){"running"!=$Z.ctx.state&&($Z._unlock(),$q.document.addEventListener("mousedown",$Z._unlock,!0),$q.document.addEventListener("touchend",$Z._unlock,!0),$q.document.addEventListener("touchstart",$Z._unlock,!0))},$Z._emptySource=null,$Z._dataCache={},$Z.buffs=[],$Z.isDecoding=!1,$Z._unlocked=!1,$Z.tInfo=null,$Z.__loadingSound={},$T($Z,["window",function(){return this.window=$q.window},"webAudioEnabled",function(){return this.webAudioEnabled=$Z.window.AudioContext||$Z.window.webkitAudioContext||$Z.window.mozAudioContext},"ctx",function(){return this.ctx=$Z.webAudioEnabled?new($Z.window.AudioContext||$Z.window.webkitAudioContext||$Z.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=$Z.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new $G}]),$Z}(),$WX=function($X){function $g(){this._responseType=null,this._data=null,$g.__super.call(this),this._http=new $q.window.XMLHttpRequest}$a($g,"laya.net.HttpRequest",$G);var $K=$g.prototype;return $K.send=function($X,$g,$K,$x,$Z){void 0===$K&&($K="get"),void 0===$x&&($x="text"),this._responseType=$x,this._data=null;var $n=this,$W=this._http;if($W.open($K,$X,!0),$Z)for(var $v=0;$v<$Z.length;$v++)$W.setRequestHeader($Z[$v++],$Z[$v]);else $C.isConchApp||($g&&"string"!=typeof $g?$W.setRequestHeader("Content-Type","application/json"):$W.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));$W.responseType="arraybuffer"!==$x?"text":"arraybuffer",$W.onerror=function($X){$n._onError($X)},$W.onabort=function($X){$n._onAbort($X)},$W.onprogress=function($X){$n._onProgress($X)},$W.onload=function($X){$n._onLoad($X)},$W.send($g)},$K._onProgress=function($X){$X&&$X.lengthComputable&&this.event("progress",$X.loaded/$X.total)},$K._onAbort=function($X){this.error("Request was aborted by user")},$K._onError=function($X){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},$K._onLoad=function($X){var $g=this._http,$K=void 0!==$g.status?$g.status:200;200===$K||204===$K||0===$K?this.complete():this.error("["+$g.status+"]"+$g.statusText+":"+$g.responseURL)},$K.error=function($X){this.clear(),this.event("error",$X)},$K.complete=function(){this.clear();var $g=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=$J.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch($X){$g=!1,this.error($X.message)}$g&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},$K.clear=function(){var $X=this._http;$X.onerror=$X.onabort=$X.onprogress=$X.onload=null},$c(0,$K,"url",function(){return this._http.responseURL}),$c(0,$K,"http",function(){return this._http}),$c(0,$K,"data",function(){return this._data}),$g}(),$vX=function($X){function $k(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,$k.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1,this._base64=!1}$a($k,"laya.net.Loader",$G);var $g=$k.prototype;return $g.load=function($X,$g,$K,$x,$Z){if($X&&""!=$X||console.error("Loader 加载的url不合法 "+$X),void 0===$K&&($K=!0),void 0===$Z&&($Z=!1),this._url=$X,this._base64=!1,0===$X.indexOf("data:image")?(this._base64=!0,this._type=$g="image"):this._type=$g||($g=this.getTypeFromUrl($X)),this._cache=$K,this._data=null,!$Z&&$k.loadedMap[$X])return this._data=$k.loadedMap[$X],this.event("progress",1),void this.event("complete",this._data);if($x&&$k.setGroup($X,$x),null!=$k.parserMap[$g])return this._customParse=!0,void($k.parserMap[$g]instanceof laya.utils.Handler?$k.parserMap[$g].runWith(this):$k.parserMap[$g].call(null,this));if("image"===$g||"htmlimage"===$g||"nativeimage"===$g)return this._loadImage($X);if("ttf"===$g)return this._loadTTF($X);switch($g){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:$g}$k.preLoadedMap[$X]?this.onLoaded($k.preLoadedMap[$X]):$W.resMgrLoad($X,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},$g.getTypeFromUrl=function($X){var $g=$J.getFileExtension($X);return $g?$k.typeMap[$g]:(console.warn("Not recognize the resources suffix",$X),"text")},$g._loadTTF=function($X){$X=$N.formatURL($X);var $g=new $P;$g.complete=$U.create(this,this.onLoaded),$g.load($X)},$g._loadBase64Image=function($g){$g=$N.formatURL($g);var $K,$X=this;function $x(){$K.onload=null,$K.onerror=null,delete $k.imgCache[$g]}function $Z(){$x(),$X.onLoaded($K)}function $n(){$x(),$X.event("error","Load image failed")}"nativeimage"===this._type?(($K=new $q.window.Image).crossOrigin="",$K.onload=$Z,$K.onerror=$n,$K.src=$g,$k.imgCache[$g]=$K):new $fX.create($g,{onload:$Z,onerror:$n,onCreate:function($X){$K=$X,$k.imgCache[$g]=$X}})},$g._loadImage=function($X){this._base64?this._loadBase64Image($X):$W.imgMgrLoad($X,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},$g._loadImageComplete=function($X,$g,$K){if(null!=$K)if($K instanceof ArrayBuffer){var $x=new DataView($K),$Z=new laya.webgl.resource.WebGLImage(new Uint8Array($K,8),$X,0,!1,$x.getUint32(0),$x.getUint32(4));this.onLoaded($Z)}else if($K instanceof $cX)$k.imgMgrSet[$X]=$g,$W.imgMgrLock($X,$k.imgMgrSet[$X]),this._url=$X,this.complete($K);else{var $n=-1!=$X.indexOf(".png",$X.length-4)?6408:6407;$Z=new laya.webgl.resource.WebGLImage($K,$X,$n,!1,$K.width,$K.height);this.onLoaded($Z)}else this.event("error","Load image failed")},$g.imageCancel=function($X,$g,$K){$W.imgMgrCancel&&$W.imgMgrCancel($X,this._onImageCallback)},$g._loadSound=function($X){var $g=new $r._soundClass,$K=this;function $x(){$g.offAll()}$g.on("complete",this,function(){$x(),$K.onLoaded($g)}),$g.on("error",this,function(){$x(),$g.dispose(),$K.event("error","Load sound failed")}),$g.load($X)},$g.onProgress=function($X){"atlas"===this._type?this.event("progress",.3*$X):this.event("progress",$X)},$g.onError=function($X){this.event("error",$X)},$g._loadedComplete=function($X,$g,$K){if(null!=$K)switch(this._type){case"atlas":case"plf":case"json":var $x=new $E($K);this.onLoaded(JSON.parse($x.readUTFBytes()));break;case"font":$x=new $E($K);this.onLoaded($J.parseXMLFromString($x.readUTFBytes()));break;default:this.onLoaded($K)}else this.event("error",$X)},$g.onLoaded=function($X){var $g=this._type;if("plf"==$g)this.parsePLFData($X),this.complete($X);else if("image"===$g){var $K=new $cX($X);$K.url=this._url,this.complete($K)}else if("sound"===$g||"htmlimage"===$g||"nativeimage"===$g)this.complete($X);else if("atlas"===$g){if(!$X.src&&!$X._setContext){if(!this._data){if((this._data=$X).meta&&$X.meta.image)for(var $x=$X.meta.image.split(","),$Z=0<=this._url.indexOf("/")?"/":"\\",$n=this._url.lastIndexOf($Z),$W=0<=$n?this._url.substr(0,$n+1):"",$v=0,$T=$x.length;$v<$T;$v++)$x[$v]=$W+$x[$v];else $x=[this._url.replace(".json",".png")];$x.reverse(),$X.toLoads=$x,$X.pics=[]}return this.event("progress",.3+1/$x.length*.6),this._loadImage($x.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push($X),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var $G=this._data.frames,$c=this._url.split("?")[0],$_=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:$c.substring(0,$c.lastIndexOf("."))+"/",$s=this._data.pics,$V=$N.formatURL(this._url),$A=$k.atlasMap[$V]||($k.atlasMap[$V]=[]);$A.dir=$_;var $a=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var $m in $a=parseFloat(this._data.meta.scale),$G){var $F,$U=$G[$m],$$=$s[$U.frame.idx?$U.frame.idx:0],$w=$N.formatURL($_+$m);$$.scaleRate=$a,$F=$cX.create($$,$U.frame.x,$U.frame.y,$U.frame.w,$U.frame.h,$U.spriteSourceSize.x,$U.spriteSourceSize.y,$U.sourceSize.w,$U.sourceSize.h),$k.cacheRes($w,$F),$k.keepCache(this._url,$_+$m),$F.url=$w,$A.push($w)}else for($m in $G)$$=$s[($U=$G[$m]).frame.idx?$U.frame.idx:0],$w=$N.formatURL($_+$m),$k.cacheRes($w,$cX.create($$,$U.frame.x,$U.frame.y,$U.frame.w,$U.frame.h,$U.spriteSourceSize.x,$U.spriteSourceSize.y,$U.sourceSize.w,$U.sourceSize.h)),$k.loadedMap[$w].url=$w,$k.keepCache(this._url,$_+$m),$A.push($w);delete this._data.pics,this.complete(this._data)}else if("font"==$g){if(!$X.src)return this._data=$X,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var $Q=new $I;$Q.parseFont(this._data,$X);var $f=this._url.split(".fnt")[0].split("/"),$D=$f[$f.length-1];$mX.registerBitmapFont($D,$Q),this._data=$Q,this.complete(this._data)}else if("pkm"==$g){var $B=$fX.create($X,this._url),$i=new $cX($B);$i.url=this._url,this.complete($i)}else this.complete($X)},$g.parsePLFData=function($X){var $g,$K,$x;for($g in $X)switch($x=$X[$g],$g){case"json":case"text":for($K in $x)$k.preLoadedMap[$N.formatURL($K)]=$x[$K];break;default:for($K in $x)$k.preLoadedMap[$N.formatURL($K)]=$x[$K]}},$g.complete=function($X){this._data=$X,this._customParse?this.event("loaded",$X instanceof Array?[$X]:$X):($k._loaders.push(this),$k._isWorking||$k.checkNext())},$g.endLoad=function($X){$X&&(this._data=$X),this._cache&&$k.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},$c(0,$g,"url",function(){return this._url}),$c(0,$g,"data",function(){return this._data}),$c(0,$g,"cache",function(){return this._cache}),$c(0,$g,"type",function(){return this._type}),$k.checkNext=function(){$k._isWorking=!0;for(var $X=$q.now();$k._startIndex<$k._loaders.length;)if($q.now(),$k._loaders[$k._startIndex].endLoad(),$k._startIndex++,$q.now()-$X>$k.maxTimeOut)return console.warn("loader callback cost a long time:"+($q.now()-$X)+" url="+$k._loaders[$k._startIndex-1].url),void $D.timer.frameOnce(1,null,$k.checkNext);$k._loaders.length=0,$k._startIndex=0,$k._isWorking=!1},$k.clearRes=function($X,$g){if(null!=$X){void 0===$g&&($g=!1),$X=$N.formatURL($X);var $K=$k.getAtlas($X);if($K){for(var $x=0,$Z=$K.length;$x<$Z;$x++){var $n=$K[$x],$W=$k.getRes($n);delete $k.loadedMap[$n],$k.clearCache($X.substring($N.basePath.length),$n.substring($N.basePath.length)),$W&&$W.destroy($g)}$K.length=0,delete $k.atlasMap[$X],delete $k.loadedMap[$X]}else{var $v=$k.loadedMap[$X];$v&&(delete $k.loadedMap[$X],$v instanceof laya.resource.Texture&&$v.bitmap&&$v.destroy($g))}}},$k.clearTextureRes=function($X){$X=$N.formatURL($X);var $g=laya.net.Loader.getAtlas($X),$K=$g&&0<$g.length?laya.net.Loader.getRes($g[0]):laya.net.Loader.getRes($X);$K&&$K.bitmap&&($C.isConchApp&&!$C.isConchWebGL?$K.bitmap.source.releaseTexture&&$K.bitmap.source.releaseTexture():null==$K.bitmap._atlaser&&$K.bitmap.releaseResource(!0))},$k.getRes=function($X){return $k.loadedMap[$N.formatURL($X)]},$k.getAtlas=function($X){return $k.atlasMap[$N.formatURL($X)]},$k.cacheRes=function($X,$g){$X=$N.formatURL($X),null!=$k.loadedMap[$X]?console.warn("Resources already exist,is repeated loading:",$X):$k.loadedMap[$X]=$g},$k.setGroup=function($X,$g){$k.groupMap[$g]||($k.groupMap[$g]=[]),$k.groupMap[$g].push($X)},$k.clearResByGroup=function($X){if($k.groupMap[$X]){var $g=$k.groupMap[$X],$K=0,$x=$g.length;for($K=0;$K<$x;$K++)$k.clearRes($g[$K]);$g.length=0}},$k.keepCache=function($X,$g){if($X&&$g){var $K=$k.cacheSet[$g];$K?-1==$K.indexOf($X)&&$K.push($X):$k.cacheSet[$g]=[$X]}},$k.clearCache=function($X,$g){if($X&&$g){var $K=$k.cacheSet[$g];if($K){var $x=$K.indexOf($X);if(-1!==$x){var $Z=$K.length-1;0==$Z?(delete $k.cacheSet[$g],0<$k.imgMgrSet[$g]?$W.imgMgrFree($g,$k.imgMgrSet[$g]):$k.clearRes($g,!0)):($K[$x]=$K[$Z],$K.length=$Z)}}}},$k.saveObject=function($X,$g,$K){if($g&&$X){var $x=$k.objectSet[$X];$x?(console.warn("Loader.saveObject: "+$X),$x[0]=$g,$x[1]=$K):$k.objectSet[$X]=[$g,$K,[]]}},$k.findObject=function($X){if($X){var $g=$k.objectSet[$X];if($g)return $g[0]}return null},$k.keepObject=function($X,$g){if($X&&$g){var $K=$k.objectSet[$g];$K&&-1===$K[2].indexOf($X)&&$K[2].push($X)}},$k.clearObject=function($X,$g){if($X&&$g){var $K=$k.objectSet[$g];if($K){var $x=$K[2],$Z=$x.indexOf($X);if(-1!==$Z){var $n=$x.length-1;0==$n?(delete $k.objectSet[$g],$K[1]&&$K[1].call(null,$K[0])):($x[$Z]=$x[$n],$x.length=$n)}}}},$k.TEXT="text",$k.JSON="json",$k.XML="xml",$k.BUFFER="arraybuffer",$k.IMAGE="image",$k.SOUND="sound",$k.ATLAS="atlas",$k.FONT="font",$k.TTF="ttf",$k.PLF="plf",$k.PKM="pkm",$k.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},$k.parserMap={},$k.groupMap={},$k.maxTimeOut=100,$k.loadedMap={},$k.preLoadedMap={},$k.atlasMap={},$k._loaders=[],$k._isWorking=!1,$k._startIndex=0,$k.imgCache={},$k.cacheSet={},$k.objectSet={},$k.imgMgrSet={},$k}(),$TX=function($X){var $s;function $V(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},$V.__super.call(this);for(var $X=0;$X<this._maxPriority;$X++)this._resInfos[$X]=[]}$a($V,"laya.net.LoaderManager",$G);var $g=$V.prototype;return $g.create=function($X,$K,$g,$x,$Z,$n,$W,$v){if(null==$n&&($n=2),null==$W&&($W=!0),$X instanceof Array){var $T=$X,$G=$T.length,$c=0;if($g)var $_=$U.create($g.caller,$g.method,$g.args,!1);for(var $s=0;$s<$G;$s++){var $V=$T[$s];"string"==typeof $V&&($V=$T[$s]={url:$V}),$V.progress=0}for($s=0;$s<$G;$s++){$V=$T[$s];var $A=$g?$U.create(null,$F,[$V],!1):null,$a=$g||$K?$U.create(null,$m,[$V]):null;this._create($V.url,$a,$A,$V.clas||$x,$V.params||$Z,null!=$V.priority&&0<=$V.priority?$V.priority:$n,$W,$V.group||$v)}function $m($X,$g){$c++,$X.progress=1,$c===$G&&$K&&$K.run()}function $F($X,$g){$X.progress=$g;for(var $K=0,$x=0;$x<$G;$x++){$K+=$T[$x].progress}var $Z=$K/$G;$_.runWith($Z)}return!0}return this._create($X,$K,$g,$x,$Z,$n,$W,$v)},$g._create=function($g,$K,$X,$x,$Z,$n,$W,$v){$g&&""!=$g||console.error("加载的url不合法 "+$g),null==$n&&($n=2),null==$W&&($W=!0);var $T=$N.formatURL($g),$G=this.getRes($T);if($G)!$G.hasOwnProperty("loaded")||$G.loaded?($X&&$X.runWith(1),$K&&$K.run()):$K&&$D.loader._createListener($g,$K.caller,$K.method,$K.args,!0,!1);else{var $c=$J.getFileExtension($g),$_=$V.createMap[$c];if(!$_)throw new Error("LoaderManager:unknown file("+$g+") extension with: "+$c+".");$x||($x=$_[0]);var $s=$_[1];if("atlas"==$c)this.load($g,$K,$X,$s,$n,$W);else{$x===$cX&&($s="htmlimage"),($G=$x?new $x:null).hasOwnProperty("_loaded")&&($G._loaded=!1),$G._setUrl($g),$v&&$G._setGroup($v),this._createLoad($G,$g,$U.create(null,function($X){$G&&!$G.destroyed&&$X&&$G.onAsynLoaded.call($G,$g,$X,$Z),$K&&$K.run();$D.loader.event($g)}),$X,$s,$n,!1,$v,!0),$W&&this.cacheRes($T,$G)}}return $G},$g.load=function($X,$g,$K,$x,$Z,$n,$W,$v){$X&&""!=$X||console.error("加载的url不合法 "+$X);var $T=this;if(null==$Z&&($Z=2),null==$n&&($n=!0),void 0===$v&&($v=!1),$X instanceof Array)return this._loadAssets($X,$g,$K,$x,$Z,$n,$W);var $G=$vX.getRes($X);if(null!=$G)$D.timer.frameOnce(1,null,function(){$K&&$K.runWith(1),$g&&$g.runWith($G),$T._loaderCount||$T.event("complete")});else{var $c=$V._resMap[$X];$c?($g&&$c._createListener("complete",$g.caller,$g.method,$g.args,!1,!1),$K&&$c._createListener("progress",$K.caller,$K.method,$K.args,!1,!1)):(($c=this._infoPool.length?this._infoPool.pop():new $s).url=$X,$c.clas=null,$c.type=$x,$c.cache=$n,$c.group=$W,$c.ignoreCache=$v,$c.priority=$Z,$g&&$c.on("complete",$g.caller,$g.method,$g.args),$K&&$c.on("progress",$K.caller,$K.method,$K.args),$V._resMap[$X]=$c,$Z=$Z<this._maxPriority?0<=$Z?$Z:0:this._maxPriority-1,this._resInfos[$Z].push($c),this._next())}return this},$g.cancel=function($X,$g,$K){if($G=$V._resMap[$X]){$g&&$G.off("complete",$g.caller,$g.method,!1),$K&&$G.off("progress",$K.caller,$K.method,!1);var $x=$G.getListener("complete"),$Z=$G.getListener("progress");if(!($x&&$x.head||$Z&&$Z.head)){if($G.loader){var $n=$G.loader;$n.imageCancel($X),$n.offAll(),$n._data=null,$n._customParse=!1,$n._url=null,$n._class=null,$n._type=null,this._loaders.push($n),this._loaderCount--,delete this._loaderMap[$G.url]}for(var $W=0;$W<this._maxPriority;$W++)for(var $v=this._resInfos[$W],$T=$v.length-1;-1<$T;$T--){var $G;($G=$v[$T])&&$G.url===$X&&($v[$T]=null,$G.destroy(),$G.offAll(),this._infoPool.push($G))}delete $V._resMap[$X],this._next()}}},$g._createLoad=function($X,$g,$K,$x,$Z,$n,$W,$v,$T){var $G=this;if(null==$n&&($n=2),null==$W&&($W=!0),void 0===$T&&($T=!1),$g instanceof Array)return this._loadAssets($g,$K,$x,$Z,$n,$W,$v);var $c=$vX.getRes($g);if(null!=$c)$D.timer.frameOnce(1,null,function(){$x&&$x.runWith(1),$K&&$K.runWith($c),$G._loaderCount||$G.event("complete")});else{var $_=$V._resMap[$g];$_?($K&&$_._createListener("complete",$K.caller,$K.method,$K.args,!1,!1),$x&&$_._createListener("progress",$x.caller,$x.method,$x.args,!1,!1)):(($_=this._infoPool.length?this._infoPool.pop():new $s).url=$g,$_.clas=$X,$_.type=$Z,$_.cache=$W,$_.group=$v,$_.ignoreCache=$T,$_.priority=$n,$K&&$_.on("complete",$K.caller,$K.method,$K.args),$x&&$_.on("progress",$x.caller,$x.method,$x.args),$V._resMap[$g]=$_,$n=$n<this._maxPriority?0<=$n?$n:0:this._maxPriority-1,this._resInfos[$n].push($_),this._next())}return this},$g._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var $X=0;$X<this._maxPriority;$X++)for(var $g=this._resInfos[$X];0<$g.length;){var $K=$g.shift();if($K)return this._doLoad($K)}this._loaderCount||this.event("complete")}},$g._doLoad=function($g){var $K=this._loaders.length?this._loaders.pop():new $vX;this._loaderCount++,(this._loaderMap[$g.url]=$K).on("complete",null,$Z),$K.on("progress",null,function($X){$g.event("progress",$X)}),$K.on("error",null,function($X){$Z(null)}),$g.loader=$K;var $x=this;function $Z($X){$K.offAll(),$K._data=null,$K._customParse=!1,$K._url=null,$K._class=null,$K._type=null,$x._loaders.push($K),$x._loaderCount--,delete $x._loaderMap[$g.url],$x._endLoad($g,$X instanceof Array?[$X]:$X),$x._next()}$K._class=$g.clas,1<=$g.priority?($K.priority=$g.priority,$K.realTime=!1):($K.priority=0,$K.realTime=!0),$K.load($g.url,$g.type,$g.cache,$g.group,$g.ignoreCache)},$g._endLoad=function($X,$g){var $K=$X.url;if(null==$g){var $x=this._failRes[$K]||0;if($x<this.retryNum)return console.warn("[warn]Retry to load:",$K),this._failRes[$K]=$x+1,void $D.timer.once(this.retryDelay,this,this._addReTry,[$X],!1);console.warn("[error]Failed to load:",$K),this.event("error",$K)}this._failRes[$K]&&(this._failRes[$K]=0),delete $V._resMap[$K],$X.event("complete",$g),$X.destroy(),$X.offAll(),this._infoPool.push($X)},$g._addReTry=function($X){this._resInfos[this._maxPriority-1].push($X),this._next()},$g.clearRes=function($X,$g){void 0===$g&&($g=!1),$vX.clearRes($X,$g)},$g.getRes=function($X){return $vX.getRes($X)},$g.cacheRes=function($X,$g){$vX.cacheRes($X,$g)},$g.clearTextureRes=function($X){$vX.clearTextureRes($X)},$g.setGroup=function($X,$g){$vX.setGroup($X,$g)},$g.clearResByGroup=function($X){$vX.clearResByGroup($X)},$g.clearUnLoaded=function(){for(var $X=0;$X<this._maxPriority;$X++){for(var $g=this._resInfos[$X],$K=$g.length-1;-1<$K;$K--){var $x=$g[$K];$x&&($x.destroy(),$x.offAll(),this._infoPool.push($x))}$g.length=0}this._loaderCount=0,$V._resMap={}},$g.cancelLoadByUrls=function($X){if($X)for(var $g=0,$K=$X.length;$g<$K;$g++)this.cancelLoadByUrl($X[$g])},$g.cancelLoadByUrl=function($X){for(var $g=0;$g<this._maxPriority;$g++)for(var $K=this._resInfos[$g],$x=$K.length-1;-1<$x;$x--){var $Z=$K[$x];$Z&&$Z.url===$X&&($K[$x]=null,$Z.destroy(),$Z.offAll(),this._infoPool.push($Z))}$V._resMap[$X]&&delete $V._resMap[$X]},$g._loadAssets=function($X,$K,$W,$g,$x,$Z,$n){null==$x&&($x=2),null==$Z&&($Z=!0);for(var $v=$X.length,$T=0,$G=0,$c=[],$_=!0,$s=0;$s<$v;$s++){var $V=$X[$s];if(!$V)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+$X);"string"==typeof $V&&($V={url:$V,type:$g,size:1,priority:$x}),$V.size||($V.size=1),$V.progress=0,$G+=$V.size,$c.push($V);var $A=$W?$U.create(null,$F,[$V],!1):null,$a=$K||$W?$U.create(null,$m,[$V]):null;this.load($V.url,$a,$A,$V.type,null!=$V.priority&&0<=$V.priority?$V.priority:2,$Z,$V.group||$n)}function $m($X,$g){$T++,$X.progress=1,$g||($_=!1),$T===$v&&$K&&$K.runWith($_)}function $F($X,$g){if(null!=$W){$X.progress=$g;for(var $K=0,$x=0;$x<$c.length;$x++){var $Z=$c[$x];$K+=$Z.size*$Z.progress}var $n=$K/$G;$W.runWith($n)}}return this},$V.cacheRes=function($X,$g){$vX.cacheRes($X,$g)},$V._resMap={},$T($V,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),$V.__init$=function(){$s=function($X){function $g(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,$g.__super.call(this)}return $a($g,"",$G),$g.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},$g}()},$V}(),$GX=(function($X){function $Z($X){$Z.__super.call(this),$X||($X=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var $g=0,$K=0,$x=0;$x<20;$x++)$x%5!=4?this._mat[$g++]=$X[$x]:this._alpha[$K++]=$X[$x];this._action=$t.createFilterAction(32),this._action.data=this}$a($Z,"laya.filters.ColorFilter",$F);var $g=$Z.prototype;$D.imps($g,{"laya.filters.IFilter":!0}),$g.callNative=function($X){$X._$P.cf=this;$X.conchModel&&$X.conchModel.setFilterMatrix&&$X.conchModel.setFilterMatrix(this._mat,this._alpha)},$c(0,$g,"type",function(){return 32}),$c(0,$g,"action",function(){return this._action})}(),function($X){function $x($X,$g,$K){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===$g&&($g=0),$x.__super.call(this),this._byteClass=$K||$E,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,$X&&0<$g&&$g<65535&&this.connect($X,$g)}$a($x,"laya.net.Socket",$G);var $g=$x.prototype;$g.connect=function($X,$g){var $K="ws://"+$X+":"+$g;$K="https:"==$q.window.location.protocol?"wss://"+$X+":"+$g:"ws://"+$X+":"+$g,this.connectByUrl($K)},$g.connectByUrl=function($X){var $g=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new $q.window.WebSocket($X,this.protocols):this._socket=new $q.window.WebSocket($X),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function($X){$g._onOpen($X)},this._socket.onmessage=function($X){$g._onMessage($X)},this._socket.onclose=function($X){$g._onClose($X)},this._socket.onerror=function($X){$g._onError($X)}},$g.cleanSocket=function(){try{this._socket.close()}catch($X){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},$g.close=function(){if(null!=this._socket)try{this._socket.close()}catch($X){}},$g._onOpen=function($X){this._connected=!0,this.event("open",$X)},$g._onMessage=function($X){if($X&&$X.data){var $g=$X.data;if(this.disableInput&&$g)this.event("message",$g);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var $K=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,$g&&("string"==typeof $g?this._input.writeUTFBytes($g):this._input.writeArrayBuffer($g),this._addInputPosition=this._input.pos,this._input.pos=$K),this.event("message",$g)}}},$g._onClose=function($X){this._connected=!1,this.event("close",$X)},$g._onError=function($X){this.event("error",$X)},$g.send=function($X){this._socket.send($X)},$g.flush=function(){if(this._output&&0<this._output.length){var $g;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch($X){$g=$X}this._output.endian=this.endian,this._output.clear(),$g&&this.event("error",$g)}},$c(0,$g,"input",function(){return this._input}),$c(0,$g,"output",function(){return this._output}),$c(0,$g,"connected",function(){return this._connected}),$c(0,$g,"endian",function(){return this._endian},function($X){this._endian=$X,null!=this._input&&(this._input.endian=$X),null!=this._output&&(this._output.endian=$X)}),$x.LITTLE_ENDIAN="littleEndian",$x.BIG_ENDIAN="bigEndian"}(),function($X){function $v(){$v.__super.call(this),this._$1__id=++$v._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,($v._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,$L.currentResourceManager&&$L.currentResourceManager.addResource(this)}$a($v,"laya.resource.Resource",$G);var $g=$v.prototype;return $D.imps($g,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),$g._setUrl=function($X){var $g;this._url!==$X&&(this._url&&(($g=$v._urlResourcesMap[this._url]).splice($g.indexOf(this),1),0===$g.length&&delete $v._urlResourcesMap[this._url]),$X&&(($g=$v._urlResourcesMap[$X])||($v._urlResourcesMap[$X]=$g=[]),$g.push(this)),this._url=$X)},$g._getGroup=function(){return this._group},$g._setGroup=function($X){var $g;this._group!==$X&&(this._group&&(($g=$v._groupResourcesMap[this._group]).splice($g.indexOf(this),1),0===$g.length&&delete $v._groupResourcesMap[this._group]),$X&&(($g=$v._groupResourcesMap[$X])||($v._groupResourcesMap[$X]=$g=[]),$g.push(this)),this._group=$X)},$g._addReference=function(){this._referenceCount++},$g._removeReference=function(){this._referenceCount--},$g._clearReference=function(){this._referenceCount=0},$g._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},$g.recreateResource=function(){this.completeCreate()},$g.disposeResource=function(){},$g.activeResource=function($X){void 0===$X&&($X=!1),this._lastUseFrameCount=$d.loopCount,!this._destroyed&&this.__loaded&&(this._released||$X)&&this.recreateResource()},$g.releaseResource=function($X){return void 0===$X&&($X=!0),!(!$X&&this.lock)&&(!(this._released&&!$X)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},$g.onAsynLoaded=function($X,$g,$K){throw new Error("Resource: must override this function!")},$g.destroy=function(){var $X;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete $v._idResourcesMap[this.id],this._url&&(($X=$v._urlResourcesMap[this._url])&&($X.splice($X.indexOf(this),1),0===$X.length&&delete $v._urlResourcesMap[this.url]),$vX.clearRes(this._url),this.__loaded||$t.cancelLoadByUrl(this._url)),this._group&&(($X=$v._groupResourcesMap[this._group]).splice($X.indexOf(this),1),0===$X.length&&delete $v._groupResourcesMap[this.url]))},$g.completeCreate=function(){this._released=!1,this.event("recovered",this)},$g.dispose=function(){this.destroy()},$c(0,$g,"memorySize",function(){return this._memorySize},function($X){var $g=$X-this._memorySize;this._memorySize=$X,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,$g),this.resourceManager&&this.resourceManager.addSize($g)}),$c(0,$g,"_loaded",null,function($X){this.__loaded=$X}),$c(0,$g,"loaded",function(){return this.__loaded}),$c(0,$g,"id",function(){return this._$1__id}),$c(0,$g,"destroyed",function(){return this._destroyed}),$c(0,$g,"group",function(){return this._getGroup()},function($X){this._setGroup($X)}),$c(0,$g,"resourceManager",function(){return this._resourceManager}),$c(0,$g,"url",function(){return this._url}),$c(0,$g,"released",function(){return this._released}),$c(0,$g,"referenceCount",function(){return this._referenceCount}),$v.getResourceByID=function($X){return $v._idResourcesMap[$X]},$v.getResourceByURL=function($X,$g){return void 0===$g&&($g=0),null==$v._urlResourcesMap[$X]?null:$v._urlResourcesMap[$X][$g]},$v.getResourceCountByURL=function($X){return $v._urlResourcesMap[$X].length},$v.destroyUnusedResources=function($X){var $g;if($X){var $K=$v._groupResourcesMap[$X];if($K)for(var $x=$K.slice(),$Z=0,$n=$x.length;$Z<$n;$Z++)($g=$x[$Z]).lock||0!==$g._referenceCount||$g.destroy()}else for(var $W in $v._idResourcesMap)($g=$v._idResourcesMap[$W]).lock||0!==$g._referenceCount||$g.destroy()},$v._uniqueIDCounter=0,$v._idResourcesMap={},$v._urlResourcesMap={},$v._groupResourcesMap={},$v}()),$cX=function($X){function $k($X,$g){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,$k.__super.call(this),$X&&null!=$X._addReference&&$X._addReference(),this.setTo($X,$g)}$a($k,"laya.resource.Texture",$G);var $g=$k.prototype;return $g._setUrl=function($X){this.url=$X},$g.setTo=function($X,$g){if($X instanceof $W.HTMLElement){var $K=$$X.create("2D",$X);this.bitmap=$K}else this.bitmap=$X;if(this.uv=$g||$k.DEF_UV,$X){this._w=$X.width,this._h=$X.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var $x=this;if(this._loaded)$t.addToAtlas&&$t.addToAtlas($x);else{var $Z=$X;$Z instanceof laya.resource.HTMLImage&&$Z.image&&$Z.image.addEventListener("load",function($X){$t.addToAtlas&&$t.addToAtlas($x)},!1)}}},$g.active=function(){this.bitmap&&this.bitmap.activeResource()},$g.destroy=function($X){if(void 0===$X&&($X=!1),this.alphaTexture&&(this.alphaTexture.destroy($X),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var $g=this.bitmap;$X?($C.isConchApp&&$g.source&&$g.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$g.dispose(),$g._clearReference()):($g._removeReference(),0==$g.referenceCount&&($C.isConchApp&&$g.source&&$g.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$g.dispose())),this.url&&this===$D.loader.getRes(this.url)&&$D.loader.clearRes(this.url,$X),this._loaded=!1}},$g.load=function($X){var $g=this;this._loaded=!1,$X=$N.customFormat($X);var $K=this.bitmap||(this.bitmap=$fX.create($X));$K.uri=$X,$K&&$K._addReference();var $x=this;$K.onload=function(){$K.onload=null,$x._loaded=!0,$g.sourceWidth=$g._w=$K.width,$g.sourceHeight=$g._h=$K.height,$x.event("loaded",this),$t.addToAtlas&&$t.addToAtlas($x)}},$g.addTextureToAtlas=function($X){$t.addTextureToAtlas(this)},$g.getPixels=function($X,$g,$K,$x){if($C.isConchApp){var $Z=this.bitmap;if($Z.source&&$Z.source.getImageData){var $n=$Z.source.getImageData($X,$g,$K,$x),$W=new Uint8Array($n);return Array.from($W)}return null}return $C.isWebGL?$t.getTexturePixels(this,$X,$g,$K,$x):($q.canvas.size($K,$x),$q.canvas.clear(),$q.context.drawTexture(this,-$X,-$g,this.width,this.height,0,0),$q.context.getImageData(0,0,$K,$x).data)},$g.onAsynLoaded=function($X,$g){if($g){if("function"!=typeof $g._addReference)throw new Error("bitmap._addReference is not a function. "+$g.className+" "+typeof $g._addReference+" "+$g.constructor);$g._addReference()}this.setTo($g,this.uv),this._loaded&&this.event("loaded",this)},$c(0,$g,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),$c(0,$g,"loaded",function(){return this._loaded}),$c(0,$g,"released",function(){return!this.bitmap||this.bitmap.released}),$c(0,$g,"width",function(){return this._w?this._w:this.uv&&this.uv!==$k.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function($X){this._w=$X,this.sourceWidth||(this.sourceWidth=$X)}),$c(0,$g,"repeat",function(){return!$C.isWebGL||!this.bitmap||this.bitmap.repeat},function($X){$X&&$C.isWebGL&&this.bitmap&&(this.bitmap.repeat=$X)&&(this.bitmap.enableMerageInAtlas=!1)}),$c(0,$g,"height",function(){return this._h?this._h:this.uv&&this.uv!==$k.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function($X){this._h=$X,this.sourceHeight||(this.sourceHeight=$X)}),$c(0,$g,"isLinearSampling",function(){return!$C.isWebGL||9728!=this.bitmap.minFifter},function($X){!$X&&$C.isWebGL&&($X||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),$k.moveUV=function($X,$g,$K){for(var $x=0;$x<8;$x+=2)$K[$x]+=$X,$K[$x+1]+=$g;return $K},$k.create=function($X,$g,$K,$x,$Z,$n,$W,$v,$T){void 0===$n&&($n=0),void 0===$W&&($W=0),void 0===$v&&($v=0),void 0===$T&&($T=0);var $G=$X instanceof laya.resource.Texture,$c=$G?$X.uv:$k.DEF_UV,$_=$G?$X.bitmap:$X,$s=$t.isAtlas($_);if($s){var $V=$_._atlaser,$A=$X._atlasID;if(-1==$A)throw new Error("create texture error");$_=$V._inAtlasTextureBitmapValue[$A],$c=$V._inAtlasTextureOriUVValue[$A]}var $a=new $k($_,null);$_.width&&$g+$x>$_.width&&($x=$_.width-$g),$_.height&&$K+$Z>$_.height&&($Z=$_.height-$K),$a.width=$x,$a.height=$Z,$a.offsetX=$n,$a.offsetY=$W,$a.sourceWidth=$v||$x,$a.sourceHeight=$T||$Z;var $m=1/$_.width,$F=1/$_.height;$g*=$m,$K*=$F,$x*=$m,$Z*=$F;var $U=$a.uv[0],$$=$a.uv[1],$w=$a.uv[4],$Q=$a.uv[5],$f=$w-$U,$D=$Q-$$,$B=$k.moveUV($c[0],$c[1],[$g,$K,$g+$x,$K,$g+$x,$K+$Z,$g,$K+$Z]);$a.uv=[$U+$B[0]*$f,$$+$B[1]*$D,$w-(1-$B[2])*$f,$$+$B[3]*$D,$w-(1-$B[4])*$f,$Q-(1-$B[5])*$D,$U+$B[6]*$f,$Q-(1-$B[7])*$D],$s&&$a.addTextureToAtlas();var $i=$_.scaleRate;return $i&&1!=$i?($a.sourceWidth/=$i,$a.sourceHeight/=$i,$a.width/=$i,$a.height/=$i,$a.scaleRate=$i,$a.offsetX/=$i,$a.offsetY/=$i):$a.scaleRate=1,$a},$k.createFromTexture=function($X,$g,$K,$x,$Z){var $n=$X.scaleRate;1!=$n&&($g*=$n,$K*=$n,$x*=$n,$Z*=$n);var $W=$i.TEMP.setTo($g-$X.offsetX,$K-$X.offsetY,$x,$Z),$v=$W.intersection($k._rect1.setTo(0,0,$X.width,$X.height),$k._rect2);if(!$v)return null;var $T=$k.create($X,$v.x,$v.y,$v.width,$v.height,$v.x-$W.x,$v.y-$W.y,$x,$Z);if($T.bitmap&&$T.bitmap._removeReference)return $T.bitmap._removeReference(),$T;var $G="bitmap:"+($T.bitmap?$T.bitmap.constructor?$T.bitmap.constructor.name:$T.bitmap.__className:"")+", url:"+($X.url+" | "+($T.bitmap?$T.bitmap.url:$X.url))+", x="+$g+",y="+$K+",width="+$x+",height="+$Z+", result="+($v?$v.x+","+$v.y+","+$v.width+","+$v.height:"null")+", rect="+$W.x+","+$W.y+","+$W.width+","+$W.height;throw new Error("报错：bitmap._removeReference is not a function  "+$G)},$k.DEF_UV=[0,0,1,0,1,1,0,1],$k.INV_UV=[0,1,1,1,1,0,0,0],$k._rect1=new $i,$k._rect2=new $i,$k}(),$X=function($X){var $v;function $n(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,$n.__super.call(this)}$a($n,"laya.utils.TimeLine",$G);var $g=$n.prototype;return $g.to=function($X,$g,$K,$x,$Z){return void 0===$Z&&($Z=0),this._create($X,$g,$K,$x,$Z,!0)},$g.from=function($X,$g,$K,$x,$Z){return void 0===$Z&&($Z=0),this._create($X,$g,$K,$x,$Z,!1)},$g._create=function($X,$g,$K,$x,$Z,$n){var $W=$j.getItemByClass("tweenData",$v);return $W.isTo=$n,$W.type=0,$W.target=$X,$W.duration=$K,$W.data=$g,$W.startTime=this._startTime+$Z,$W.endTime=$W.startTime+$W.duration,$W.ease=$x,this._startTime=Math.max($W.endTime,this._startTime),this._tweenDataList.push($W),this._startTimeSort=!0,this._endTimeSort=!0,this},$g.addLabel=function($X,$g){var $K=$j.getItemByClass("tweenData",$v);return $K.type=1,$K.data=$X,$K.endTime=$K.startTime=this._startTime+$g,this._labelDic||(this._labelDic={}),this._labelDic[$X]=$K,this._tweenDataList.push($K),this},$g.removeLabel=function($X){if(this._labelDic&&this._labelDic[$X]){var $g=this._labelDic[$X];if($g){var $K=this._tweenDataList.indexOf($g);-1<$K&&this._tweenDataList.splice($K,1)}delete this._labelDic[$X]}},$g.gotoTime=function($X){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var $g,$K,$x,$Z;for(var $n in this._firstTweenDic)if($K=this._firstTweenDic[$n])for(var $W in $K)$K.diyTarget.hasOwnProperty($W)&&($K.diyTarget[$W]=$K[$W]);for($n in this._tweenDic)($g=this._tweenDic[$n]).clear(),delete this._tweenDic[$n];if(this._index=0,this._gidIndex=0,this._currTime=$X,this._lastTime=$q.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=$x=this._tweenDataList.concat(),$x.sort(function($X,$g){return $X.endTime>$g.endTime?1:$X.endTime<$g.endTime?-1:0})}else $x=this._endTweenDataList;for(var $v=0,$T=$x.length;$v<$T;$v++)if(0==($Z=$x[$v]).type){if(!($X>=$Z.endTime))break;this._index=Math.max(this._index,$v+1);var $G=$Z.data;if($Z.isTo)for(var $c in $G)$Z.target[$c]=$G[$c]}for($v=0,$T=this._tweenDataList.length;$v<$T;$v++)0==($Z=this._tweenDataList[$v]).type&&$X>=$Z.startTime&&$X<$Z.endTime&&(this._index=Math.max(this._index,$v+1),this._gidIndex++,($g=$j.getItemByClass("tween",$z))._create($Z.target,$Z.data,$Z.duration,$Z.ease,$U.create(this,this._animComplete,[this._gidIndex]),0,!1,$Z.isTo,!0,!1),$g.setStartTime(this._currTime-($X-$Z.startTime)),$g._updateEase(this._currTime),$g.gid=this._gidIndex,this._tweenDic[this._gidIndex]=$g)}},$g.gotoLabel=function($X){if(null!=this._labelDic){var $g=this._labelDic[$X];$g&&this.gotoTime($g.startTime)}},$g.pause=function(){$D.timer.clear(this,this._update)},$g.resume=function(){this.play(this._currTime,this._loopKey)},$g.play=function($X,$g){if(void 0===$X&&($X=0),void 0===$g&&($g=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function($X,$g){return $X.startTime>$g.startTime?1:$X.startTime<$g.startTime?-1:0});for(var $K=0,$x=this._tweenDataList.length;$K<$x;$K++){var $Z=this._tweenDataList[$K];if(null!=$Z&&0==$Z.type){var $n=$Z.target,$W=$n.$_GID||($n.$_GID=$J.getGID()),$v=null;for(var $T in null==this._firstTweenDic[$W]?(($v={}).diyTarget=$n,this._firstTweenDic[$W]=$v):$v=this._firstTweenDic[$W],$Z.data)null==$v[$T]&&($v[$T]=$n[$T])}}}"string"==typeof $X?this.gotoLabel($X):this.gotoTime($X),this._loopKey=$g,this._lastTime=$q.now(),$D.timer.frameLoop(1,this,this._update)}},$g._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var $X in this._tweenDic)($g=this._tweenDic[$X]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var $g,$K=$q.now(),$x=$K-this._lastTime,$Z=this._currTime+=$x*this.scale;for($X in this._lastTime=$K,this._tweenDic)($g=this._tweenDic[$X])._updateEase($Z);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var $n=this._tweenDataList[this._index];$Z>=$n.startTime&&(this._index++,0==$n.type?(this._gidIndex++,($g=$j.getItemByClass("tween",$z))._create($n.target,$n.data,$n.duration,$n.ease,$U.create(this,this._animComplete,[this._gidIndex]),0,!1,$n.isTo,!0,!1),$g.setStartTime($Z),$g.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=$g)._updateEase($Z)):this.event("label",$n.data))}},$g._animComplete=function($X){this._tweenDic[$X]&&delete this._tweenDic[$X]},$g._complete=function(){this.event("complete")},$g.reset=function(){var $X;if(this._labelDic)for($X in this._labelDic)delete this._labelDic[$X];for($X in this._tweenDic)this._tweenDic[$X].clear(),delete this._tweenDic[$X];for($X in this._firstTweenDic)delete this._firstTweenDic[$X];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var $g,$K=0;for($g=this._tweenDataList.length,$K=0;$K<$g;$K++)this._tweenDataList[$K]&&this._tweenDataList[$K].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,$D.timer.clear(this,this._update)},$g.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},$c(0,$g,"index",function(){return this._frameIndex},function($X){this._frameIndex=$X,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),$c(0,$g,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),$n.to=function($X,$g,$K,$x,$Z){return void 0===$Z&&($Z=0),(new $n).to($X,$g,$K,$x,$Z)},$n.from=function($X,$g,$K,$x,$Z){return void 0===$Z&&($Z=0),(new $n).from($X,$g,$K,$x,$Z)},$n.__init$=function(){$v=function(){function $X(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return $a($X,""),$X.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,$j.recover("tweenData",this)},$X}()},$n}(),$_X=function($Z){function $K(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,$K.__super.call(this),this._style=$v.EMPTY}$a($K,"laya.display.Sprite",$Z);var $X=$K.prototype;return $D.imps($X,{"laya.display.ILayout":!0}),$X.createConchModel=function(){return new ConchNode},$X.destroy=function($X){if(void 0===$X&&($X=!0),this._releaseMem(),!this._destroyed){this.filters=null;var $g=this.mask;$g&&(this.mask=null,$g.destroy($X))}$Z.prototype.destroy.call(this,$X),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},$X.updateZOrder=function(){$J.updateOrder(this._childs)&&this.repaint()},$X.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},$X.setBounds=function($X){this._set$P("uBounds",$X)},$X.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new $i),$i._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},$X.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new $i),$i._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},$X._boundPointsToParent=function($X){void 0===$X&&($X=!1);var $g=0,$K=0;this._style&&($g=this._style._tf.translateX,$K=this._style._tf.translateY,$X=$X||0!==this._style._tf.rotate,this._style.scrollRect&&($g+=this._style.scrollRect.x,$K+=this._style.scrollRect.y));var $x=this._getBoundPointsM($X);if(!$x||$x.length<1)return $x;if(8!=$x.length&&($x=$X?$Q.scanPList($x):$i._getWrapRec($x,$i.TEMP)._getBoundPoints()),!this.transform)return $J.transPointList($x,this._x-$g,this._y-$K),$x;var $Z=$B.TEMP,$n=0,$W=$x.length;for($n=0;$n<$W;$n+=2)$Z.x=$x[$n],$Z.y=$x[$n+1],this.toParentPoint($Z),$x[$n]=$Z.x,$x[$n+1]=$Z.y;return $x},$X.getGraphicBounds=function($X){return void 0===$X&&($X=!1),this._graphics?this._graphics.getBounds($X):$i.TEMP.setTo(0,0,0,0)},$X._getBoundPointsM=function($X){if(void 0===$X&&($X=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var $g=$J.clearArray(this._$P.temBM),$K=$i.TEMP;return $K.copyFrom(this.scrollRect),$J.concatArray($g,$K._getBoundPoints()),$g}for(var $x,$Z,$n,$W=this._graphics?this._graphics.getBoundPoints():$J.clearArray(this._$P.temBM),$v=0,$T=($n=this._childs).length;$v<$T;$v++)($x=$n[$v])instanceof laya.display.Sprite&&1==$x.visible&&($Z=$x._boundPointsToParent($X))&&($W=$W?$J.concatArray($W,$Z):$Z);return $W},$X.getStyle=function(){return this._style===$v.EMPTY&&(this._style=new $v),this._style},$X.setStyle=function($X){this._style=$X},$X._adjustTransform=function(){this._tfChanged=!1;var $X,$g=this._style._tf,$K=$g.scaleX,$x=$g.scaleY;if($g.rotate||1!==$K||1!==$x||$g.skewX||$g.skewY){($X=this._transform||(this._transform=$M.create())).bTransform=!0;var $Z=.0174532922222222*($g.rotate-$g.skewX),$n=.0174532922222222*($g.rotate+$g.skewY),$W=Math.cos($n),$v=Math.sin($n),$T=Math.sin($Z),$G=Math.cos($Z);return $X.a=$K*$W,$X.b=$K*$v,$X.c=-$x*$T,$X.d=$x*$G,$X.tx=$X.ty=0,$X}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,$X},$X.pos=function($X,$g,$K){if(void 0===$K&&($K=!1),this._x!==$X||this._y!==$g){if(this.destroyed)return this;if($K){this._x=$X,this._y=$g,this.conchModel&&this.conchModel.pos(this._x,this._y);var $x=this._parent;$x&&0===$x._repaint&&($x._repaint=1,$x.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=$X,this.y=$g}return this},$X.pivot=function($X,$g){return this.pivotX=$X,this.pivotY=$g,this},$X.size=function($X,$g){return this.width=$X,this.height=$g,this},$X.scale=function($X,$g,$K){void 0===$K&&($K=!1);var $x=this.getStyle(),$Z=$x._tf;if($Z.scaleX!=$X||$Z.scaleY!=$g){if(this.destroyed)return this;if($K){$x.setScale($X,$g),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($X,$g),this._renderType|=4;var $n=this._parent;$n&&0===$n._repaint&&($n._repaint=1,$n.parentRepaint())}else this.scaleX=$X,this.scaleY=$g}return this},$X.skew=function($X,$g){return this.skewX=$X,this.skewY=$g,this},$X.render=function($X,$g,$K){$d.spriteCount++,$l.renders[this._renderType]._fun(this,$X,$g+this._x,$K+this._y),this._repaint=0},$X.drawToCanvas=function($X,$g,$K,$x){if($C.isConchNode){var $Z=$$X.create("2D");return new $Y($X,$g,$Z).ctx.setCanvasType(1),this.conchModel.drawToCanvas($Z.source,$K,$x),$Z}return $t.drawToCanvas(this,this._renderType,$X,$g,$K,$x)},$X.customRender=function($X,$g,$K){this._renderType|=1024},$X._applyFilters=function(){var $X;if(!$C.isWebGL&&(($X=this._$P.filters)&&!($X.length<1)))for(var $g=0,$K=$X.length;$g<$K;$g++)$X[$g].action.apply(this._$P.cacheCanvas)},$X._isHaveGlowFilter=function(){var $X,$g=0;if(this.filters)for($g=0;$g<this.filters.length;$g++)if(8==this.filters[$g].type)return!0;for($g=0,$X=this._childs.length;$g<$X;$g++)if(this._childs[$g]._isHaveGlowFilter())return!0;return!1},$X.localToGlobal=function($X,$g){void 0===$g&&($g=!1),!0===$g&&($X=new $B($X.x,$X.y));for(var $K=this;$K&&$K!=$D.stage;)$X=$K.toParentPoint($X),$K=$K.parent;return $X},$X.globalToLocal=function($X,$g){void 0===$g&&($g=!1),$g&&($X=new $B($X.x,$X.y));for(var $K=this,$x=[];$K&&$K!=$D.stage;)$x.push($K),$K=$K.parent;for(var $Z=$x.length-1;0<=$Z;)$X=($K=$x[$Z]).fromParentPoint($X),$Z--;return $X},$X.toParentPoint=function($X){if(!$X)return $X;$X.x-=this.pivotX,$X.y-=this.pivotY,this.transform&&this._transform.transformPoint($X),$X.x+=this._x,$X.y+=this._y;var $g=this._style.scrollRect;return $g&&($X.x-=$g.x,$X.y-=$g.y),$X},$X.fromParentPoint=function($X){if(!$X)return $X;$X.x-=this._x,$X.y-=this._y;var $g=this._style.scrollRect;return $g&&($X.x+=$g.x,$X.y+=$g.y),this.transform&&this._transform.invertTransformPoint($X),$X.x+=this.pivotX,$X.y+=this.pivotY,$X},$X.on=function($X,$g,$K,$x){return 1!==this._mouseEnableState&&this.isMouseEvent($X)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($X,$g,$K,$x,!1)):$Z.prototype.on.call(this,$X,$g,$K,$x)},$X.once=function($X,$g,$K,$x){return 1!==this._mouseEnableState&&this.isMouseEvent($X)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($X,$g,$K,$x,!0)):$Z.prototype.once.call(this,$X,$g,$K,$x)},$X._$2__onDisplay=function(){if(1!==this._mouseEnableState){var $X=this;for($X=$X.parent;$X&&1!==$X._mouseEnableState&&!$X._getBit(2);)$X.mouseEnabled=!0,$X._setBit(2,!0),$X=$X.parent}},$X.loadImage=function($X,$g,$K,$x,$Z,$n){var $W=this;return void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=0),void 0===$Z&&($Z=0),this.graphics.loadImage($X,$g,$K,$x,$Z,function($X){$W.destroyed||($W.size($g+($x||$X.width),$K+($Z||$X.height)),$W.repaint(),$n&&$n.runWith($X))}),this},$X.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},$X._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},$X._childChanged=function($X){this._childs.length?this._renderType|=2048:this._renderType&=-2049,$X&&this._get$P("hasZorder")&&$D.timer.callLater(this,this.updateZOrder),this.repaint()},$X.parentRepaint=function(){var $X=this._parent;$X&&0===$X._repaint&&($X._repaint=1,$X.parentRepaint())},$X.startDrag=function($X,$g,$K,$x,$Z,$n,$W){void 0===$g&&($g=!1),void 0===$K&&($K=0),void 0===$x&&($x=300),void 0===$n&&($n=!1),void 0===$W&&($W=.92),this._$P.dragging||this._set$P("dragging",new $b),this._$P.dragging.start(this,$X,$g,$K,$x,$Z,$n,$W)},$X.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},$X._releaseMem=function(){if(this._$P){var $X=this._$P.cacheCanvas;$X&&$X.ctx&&($j.recover("RenderContext",$X.ctx),$X.ctx.canvas.size(0,0),$X.ctx=null);var $g=this._$P._filterCache;$g&&($g.destroy(),$g.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},$X._setDisplay=function($X){$X||this._releaseMem(),$Z.prototype._setDisplay.call(this,$X)},$X.hitTestPoint=function($X,$g){var $K=this.globalToLocal($B.TEMP.setTo($X,$g));return $X=$K.x,$g=$K.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?$i.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains($X,$g)},$X.getMousePoint=function(){return this.globalToLocal($B.TEMP.setTo($D.stage.mouseX,$D.stage.mouseY))},$X._getWords=function(){return null},$X._addChildsToLayout=function($X){var $g=this._getWords();if(null==$g&&0==this._childs.length)return!1;if($g)for(var $K=0,$x=$g.length;$K<$x;$K++)$X.push($g[$K]);$K=0;for(var $Z=this._childs.length;$K<$Z;++$K){var $n=this._childs[$K];$n._style._enableLayout()&&$n._addToLayout($X)}return!0},$X._addToLayout=function($X){this._style.absolute||(this._style.block?$X.push(this):this._addChildsToLayout($X)&&(this.x=this.y=0))},$X._isChar=function(){return!1},$X._getCSSStyle=function(){return this._style.getCSSStyle()},$X._setAttributes=function($X,$g){switch($X){case"x":this.x=parseFloat($g);break;case"y":this.y=parseFloat($g);break;case"width":this.width=parseFloat($g);break;case"height":this.height=parseFloat($g);break;default:this[$X]=$g}},$X._layoutLater=function(){this.parent&&this.parent._layoutLater()},$c(0,$X,"optimizeScrollRect",function(){return this._optimizeScrollRect},function($X){this._optimizeScrollRect!=$X&&(this._optimizeScrollRect=$X,this.conchModel&&this.conchModel.optimizeScrollRect($X))}),$c(0,$X,"customRenderEnable",null,function($X){if($X&&(this._renderType|=1024,$C.isConchNode)){$K.CustomList.push(this);var $g=new $$X("2d");$g._setContext(new CanvasRenderingContext2D),this.customContext=new $Y(0,0,$g),$g.context.setCanvasType&&$g.context.setCanvasType(2),this.conchModel.custom($g.context)}}),$c(0,$X,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function($X){this.cacheAs=$X?this._$P.hasFilter?"none":"normal":"none"}),$c(0,$X,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function($X){var $g=this._$P.cacheCanvas;if($X!==($g?$g.type:"none")){if("none"!==$X)this._getBit(1)||this._setUpNoticeType(1),$g||($g=this._set$P("cacheCanvas",$j.getItemByClass("cacheCanvas",Object))),$g.type=$X,$g.reCache=!0,this._renderType|=16,"bitmap"==$X&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if($g){var $K=$g;$K&&$K.ctx&&($j.recover("RenderContext",$K.ctx),$K.ctx.canvas.size(0,0),$K.ctx=null),$j.recover("cacheCanvas",$g)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),$c(0,$X,"zOrder",function(){return this._zOrder},function($X){this._zOrder!=$X&&(this._zOrder=$X,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder($X),this._parent&&($X&&this._parent._set$P("hasZorder",!0),$D.timer.callLater(this._parent,this.updateZOrder)))}),$c(0,$X,"rotation",function(){return this._style._tf.rotate},function($X){var $g=this.getStyle();if($g._tf.rotate!==$X){$g.setRotate($X),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate($X),this._renderType|=4;var $K=this._parent;$K&&0===$K._repaint&&($K._repaint=1,$K.parentRepaint())}}),$c(0,$X,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($X){this._width!==$X&&(this._width=$X,this.conchModel&&this.conchModel.size($X,this._height),this.repaint())}),$c(0,$X,"x",function(){return this._x},function($X){if(this._x!==$X){if(this.destroyed)return;this._x=$X,this.conchModel&&this.conchModel.pos($X,this._y);var $g=this._parent;$g&&0===$g._repaint&&($g._repaint=1,$g.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$c(0,$X,"globalScaleY",function(){for(var $X=1,$g=this;$g&&$g!==$D.stage;)$X*=$g.scaleY,$g=$g.parent;return $X}),$c(0,$X,"hitArea",function(){return this._$P.hitArea},function($X){this._set$P("hitArea",$X)}),$c(0,$X,"staticCache",function(){return this._$P.staticCache},function($X){this._set$P("staticCache",$X),$X||this.reCache()}),$c(0,$X,"texture",function(){return this._texture},function($X){this._texture!=$X&&(this._texture=$X,this.graphics.cleanByTexture($X,0,0))}),$c(0,$X,"y",function(){return this._y},function($X){if(this._y!==$X){if(this.destroyed)return;this._y=$X,this.conchModel&&this.conchModel.pos(this._x,$X);var $g=this._parent;$g&&0===$g._repaint&&($g._repaint=1,$g.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$c(0,$X,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($X){this._height!==$X&&(this._height=$X,this.conchModel&&this.conchModel.size(this._width,$X),this.repaint())}),$c(0,$X,"blendMode",function(){return this._style.blendMode},function($X){this.getStyle().blendMode=$X,this.conchModel&&this.conchModel.blendMode($X),$X&&"source-over"!=$X?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),$c(0,$X,"scaleX",function(){return this._style._tf.scaleX},function($X){var $g=this.getStyle();if($g._tf.scaleX!==$X){$g.setScaleX($X),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($X,$g._tf.scaleY),this._renderType|=4;var $K=this._parent;$K&&0===$K._repaint&&($K._repaint=1,$K.parentRepaint())}}),$c(0,$X,"scaleY",function(){return this._style._tf.scaleY},function($X){var $g=this.getStyle();if($g._tf.scaleY!==$X){$g.setScaleY($X),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($g._tf.scaleX,$X),this._renderType|=4;var $K=this._parent;$K&&0===$K._repaint&&($K._repaint=1,$K.parentRepaint())}}),$c(0,$X,"stage",function(){return $D.stage}),$c(0,$X,"skewX",function(){return this._style._tf.skewX},function($X){var $g=this.getStyle();if($g._tf.skewX!==$X){$g.setSkewX($X),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($X,$g._tf.skewY),this._renderType|=4;var $K=this._parent;$K&&0===$K._repaint&&($K._repaint=1,$K.parentRepaint())}}),$c(0,$X,"scrollRect",function(){return this._style.scrollRect},function($X){this.getStyle().scrollRect=$X,this.repaint(),$X?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect($X.x,$X.y,$X.width,$X.height)):(this._renderType&=-129,this.conchModel&&($K.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),$c(0,$X,"skewY",function(){return this._style._tf.skewY},function($X){var $g=this.getStyle();if($g._tf.skewY!==$X){$g.setSkewY($X),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($g._tf.skewX,$X),this._renderType|=4;var $K=this._parent;$K&&0===$K._repaint&&($K._repaint=1,$K.parentRepaint())}}),$c(0,$X,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function($X){this._tfChanged=!1,(this._transform=$X)&&(this._x=$X.tx,this._y=$X.ty,$X.tx=$X.ty=0,this.conchModel&&this.conchModel.transform($X.a,$X.b,$X.c,$X.d,this._x,this._y)),$X?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),$c(0,$X,"pivotX",function(){return this._style._tf.translateX},function($X){this.getStyle().setTranslateX($X),this.conchModel&&this.conchModel.pivot($X,this._style._tf.translateY),this.repaint()}),$c(0,$X,"pivotY",function(){return this._style._tf.translateY},function($X){this.getStyle().setTranslateY($X),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,$X),this.repaint()}),$c(0,$X,"alpha",function(){return this._style.alpha},function($X){this._style&&this._style.alpha!==$X&&($X=$X<0?0:1<$X?1:$X,this.getStyle().alpha=$X,this.conchModel&&this.conchModel.alpha($X),1!==$X?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),$c(0,$X,"visible",function(){return this._style.visible},function($X){this._style&&this._style.visible!==$X&&(this.getStyle().visible=$X,this.conchModel&&this.conchModel.visible($X),this.parentRepaint())}),$c(0,$X,"graphics",function(){return this._graphics||(this.graphics=$t.createGraphics())},function($X){this._graphics&&(this._graphics._sp=null),(this._graphics=$X)?(this._renderType&=-2,this._renderType|=512,($X._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&($K.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),$c(0,$X,"filters",function(){return this._$P.filters},function($X){$X&&0===$X.length&&($X=null),this._$P.filters!=$X&&(this._set$P("filters",$X?$X.slice():null),$C.isConchApp&&(this.conchModel&&($K.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),$C.isWebGL&&($X&&$X.length?this._renderType|=32:this._renderType&=-33),$X&&0<$X.length?(this._getBit(1)||this._setUpNoticeType(1),$C.isWebGL&&1==$X.length&&$X[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&($C.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),$c(0,$X,"parent",$Z.prototype._$get_parent,function($X){$D.superSet($XX,this,"parent",$X),$X&&this._getBit(2)&&this._$2__onDisplay()}),$c(0,$X,"mask",function(){return this._$P._mask},function($X){$X&&this.mask&&this.mask._$P.maskParent||($X?(this.cacheAs="bitmap",this._set$P("_mask",$X),$X._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",$X),this.cacheAs="none"),this.conchModel&&this.conchModel.mask($X?$X.conchModel:null),this._renderType|=64,this.parentRepaint())}),$c(0,$X,"mouseEnabled",function(){return 1<this._mouseEnableState},function($X){this._mouseEnableState=$X?2:1}),$c(0,$X,"globalScaleX",function(){for(var $X=1,$g=this;$g&&$g!==$D.stage;)$X*=$g.scaleX,$g=$g.parent;return $X}),$c(0,$X,"mouseX",function(){return this.getMousePoint().x}),$c(0,$X,"mouseY",function(){return this.getMousePoint().y}),$K.fromImage=function($X){return(new $K).loadImage($X)},$K._cachePool=[],$K.CustomList=[],$T($K,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=$W.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),$K}($XX),$sX=function($X){function $g($X){this._audio=null,this._onEnd=null,this._resumePlay=null,$g.__super.call(this),this._onEnd=$J.bind(this.__onEnd,this),this._resumePlay=$J.bind(this.__resumePlay,this),$X.addEventListener("ended",this._onEnd),this._audio=$X}$a($g,"laya.media.h5audio.AudioSoundChannel",$xX);var $K=$g.prototype;return $K.__onEnd=function(){if(1==this.loops)return this.completeHandler&&($D.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$K.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,$q.container.appendChild(this._audio),this._audio.play()}catch($X){this.event("error")}},$K.play=function($X){this.isStopped=!1;try{this._audio.playbackRate=$r.playbackRate,this._audio.currentTime=this.startTime}catch($X){return void this._audio.addEventListener("canplay",this._resumePlay)}$r.addChannel(this),$q.container.appendChild(this._audio),!$X&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},$K.stop=function(){this.isStopped=!0,$r.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&$C.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),$q.onIE||this._audio!=$KX._musicAudio&&$j.recover("audio:"+this.url,this._audio),$q.removeElement(this._audio),this._audio=null)},$K.pause=function(){this.isStopped=!0,$r.removeChannel(this),"pause"in this._audio&&this._audio.pause()},$K.resume=function(){this._audio&&(this.isStopped=!1,$r.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},$c(0,$K,"position",function(){return this._audio?this._audio.currentTime:0}),$c(0,$K,"duration",function(){return this._audio?this._audio.duration:0}),$c(0,$K,"volume",function(){return this._audio?this._audio.volume:1},function($X){this._audio&&(this._audio.volume=$X)}),$g}(),$VX=function($X){function $g(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=$nX.ctx,$g.__super.call(this),this._onPlayEnd=$J.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}$a($g,"laya.media.webaudio.WebAudioSoundChannel",$xX);var $K=$g.prototype;return $K.play=function($X){if($r.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var $g=this.context,$K=this.gain,$x=$g.createBufferSource();(this.bufferSource=$x).buffer=this.audioBuffer,$x.connect($K),$K&&$K.disconnect(),$K.connect($g.destination),$x.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=$q.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&($x.loop=!0),$x.playbackRate.setTargetAtTime?$x.playbackRate.setTargetAtTime($r.playbackRate,this.context.currentTime,.1):$x.playbackRate.value=$r.playbackRate,$x.start(0,this.startTime),!$X&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},$K.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&($D.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$K._clearBufferSource=function(){if(this.bufferSource){var $X=this.bufferSource;$X.stop?$X.stop(0):$X.noteOff(0),$X.disconnect(0),$X.onended=null,$g._tryCleanFailed||this._tryClearBuffer($X),this.bufferSource=null}},$K._tryClearBuffer=function($X){try{$X.buffer=null}catch($X){$g._tryCleanFailed=!0}},$K.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,$r.removeChannel(this),this.startHandler=null,this.completeHandler=null},$K.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,$r.removeChannel(this)},$K.resume=function(){this.startTime=this._pauseTime,this.play(!1)},$c(0,$K,"position",function(){return this.bufferSource?($q.now()-this._startTime)/1e3+this.startTime:0}),$c(0,$K,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$c(0,$K,"volume",function(){return this._volume},function($X){this.isStopped||(this._volume=$X,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime($X,this.context.currentTime,.1):this.gain.gain.value=$X)}),$g._tryCleanFailed=!1,$g}(),$AX=function($X){function $g(){$g.__super.call(this),this._w=0,this._h=0}$a($g,"laya.resource.Bitmap",$GX);var $K=$g.prototype;return $c(0,$K,"width",function(){return this._w}),$c(0,$K,"height",function(){return this._h}),$c(0,$K,"source",function(){return this._source}),$g}(),$aX=function($g){function $X(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,$X.__super.call(this),this._interval=$x.animationInterval,this._setUpNoticeType(1)}$a($X,"laya.display.AnimationPlayerBase",$g);var $K=$X.prototype;return $K.play=function($X,$g,$K,$x){void 0===$X&&($X=0),void 0===$g&&($g=!0),void 0===$K&&($K=""),void 0===$x&&($x=!0),this._isPlaying=!0,this.index="string"==typeof $X?this._getFrameByLabel($X):$X,this.loop=$g,this._actionName=$K,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$K._getFrameByLabel=function($X){var $g=0;for($g=0;$g<this._count;$g++)if(this._labels[$g]&&0<=this._labels[$g].indexOf($X))return $g;return 0},$K._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},$K._setControlNode=function($X){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=$X)&&$X!=this&&($X.on("display",this,this._checkResumePlaying),$X.on("undisplay",this,this._checkResumePlaying))},$K._setDisplay=function($X){$g.prototype._setDisplay.call(this,$X),this._checkResumePlaying()},$K._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},$K.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},$K.addLabel=function($X,$g){this._labels||(this._labels={}),this._labels[$g]||(this._labels[$g]=[]),this._labels[$g].push($X)},$K.removeLabel=function($X){if($X){if(this._labels)for(var $g in this._labels)this._removeLabelFromLabelList(this._labels[$g],$X)}else this._labels=null},$K._removeLabelFromLabelList=function($X,$g){if($X)for(var $K=$X.length-1;0<=$K;$K--)$X[$K]==$g&&$X.splice($K,1)},$K.gotoAndStop=function($X){this.index="string"==typeof $X?this._getFrameByLabel($X):$X,this.stop()},$K._displayToIndex=function($X){},$K.clear=function(){this.stop(),this._labels=null},$c(0,$K,"interval",function(){return this._interval},function($X){this._interval!=$X&&(this._frameRateChanged=!0,this._interval=$X,this._isPlaying&&0<$X&&this.timerLoop($X,this,this._frameLoop,null,!0,!0))}),$c(0,$K,"isPlaying",function(){return this._isPlaying}),$c(0,$K,"index",function(){return this._index},function($X){if(this._index=$X,this._displayToIndex($X),this._labels&&this._labels[$X])for(var $g=this._labels[$X],$K=0,$x=$g.length;$K<$x;$K++)this.event("label",$g[$K])}),$c(0,$K,"count",function(){return this._count}),$X.WRAP_POSITIVE=0,$X.WRAP_REVERSE=1,$X.WRAP_PINGPONG=2,$X}($_X),$mX=function($g){function $V(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,$V.__super.call(this),this.overflow=$V.VISIBLE,this._style=new $gX(this),this._style.wordWrap=!1}$a($V,"laya.display.Text",$g);var $X=$V.prototype;return $X.destroy=function($X){void 0===$X&&($X=!0),$g.prototype.destroy.call(this,$X),this._lines=null,this._words&&(this._words.length=0,this._words=null)},$X._getBoundPointsM=function($X){void 0===$X&&($X=!1);var $g=$i.TEMP;return $g.setTo(0,0,this.width,this.height),$g._getBoundPoints()},$X.getGraphicBounds=function($X){void 0===$X&&($X=!1);var $g=$i.TEMP;return $g.setTo(0,0,this.width,this.height),$g},$X._getCSSStyle=function(){return this._style},$X.lang=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c){if($X=$V.langPacks&&$V.langPacks[$X]?$V.langPacks[$X]:$X,arguments.length<2)this._text=$X;else{for(var $_=0,$s=arguments.length;$_<$s;$_++)$X=$X.replace("{"+$_+"}",arguments[$_+1]);this._text=$X}},$X._isPassWordMode=function(){var $X=this._style.password;return"prompt"in this&&this.prompt==this._text&&($X=!1),$X},$X._getPassWordTxt=function($X){var $g;$g="";for(var $K=$X.length;0<$K;$K--)$g+="●";return $g},$X.renderText=function($X,$g){var $K=this.graphics;$K.clear(!0);var $x=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+($q.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);$q.context.font=$x;var $Z=this.padding,$n=$Z[3],$W="left",$v=this._lines,$T=this.leading+this._charSize.height,$G=this._currBitmapFont;$G&&($T=this.leading+$G.getMaxHeight());var $c=$Z[0];if(!$G&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?($W="right",$n=this._width-$Z[1]):"center"==this.align&&($W="center",$n=.5*this._width+$Z[3]-$Z[1])),0<this._height){var $_=this._textHeight>this._height?"top":this.valign;"middle"===$_?$c=.5*(this._height-$g*$T)+$Z[0]-$Z[2]:"bottom"===$_&&($c=this._height-$g*$T-$Z[2])}var $s=this._style;if($G&&$G.autoScaleSize)var $V=$G.fontSize/this.fontSize;if(this._clipPoint)if($K.save(),$G&&$G.autoScaleSize){var $A=0,$a=0;$A=this._width?this._width-$Z[3]-$Z[1]:this._textWidth,$a=this._height?this._height-$Z[0]-$Z[2]:this._textHeight,$A*=$V,$a*=$V,$K.clipRect($Z[3],$Z[0],$A,$a)}else $K.clipRect($Z[3],$Z[0],this._width?this._width-$Z[3]-$Z[1]:this._textWidth,this._height?this._height-$Z[0]-$Z[2]:this._textHeight);var $m=$s.password;"prompt"in this&&this.prompt==this._text&&($m=!1);for(var $F=0,$U=0,$$=Math.min(this._lines.length,$g+$X)||1,$w=$X;$w<$$;$w++){var $Q,$f=$v[$w];if($m){var $D=$f.length;$f="";for(var $B=$D;0<$B;$B--)$f+="●"}if($F=$n-(this._clipPoint?this._clipPoint.x:0),$U=$c+$T*$w-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline($W,$F,$U,$w),$G){var $i=this.width;$G.autoScaleSize&&($i=this.width*$V),$G.drawText($f,this,$F,$U,this.align,$i)}else $C.isWebGL?(this._words||(this._words=[]),($Q=this._words.length>$w-$X?this._words[$w-$X]:new $y).setText($f)):$Q=$f,$s.stroke?$K.fillBorderText($Q,$F,$U,$x,this.color,$s.strokeColor,$s.stroke,$W):$K.fillText($Q,$F,$U,$x,this.color,$W)}if($G&&$G.autoScaleSize){var $k=1/$V;this.scale($k,$k)}this._clipPoint&&$K.restore(),this._startX=$n,this._startY=$c},$X.drawUnderline=function($X,$g,$K,$x){var $Z=this._lineWidths[$x];switch($X){case"center":$g-=$Z/2;break;case"right":$g-=$Z}$K+=this._charSize.height,this._graphics.drawLine($g,$K,$g+$Z,$K,this.underlineColor||this.color,1)},$X.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);$q.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new $B(0,0)):this._clipPoint=null;var $X=this._lines.length;if(this.overflow!=$V.VISIBLE){var $g=this.overflow==$V.HIDDEN?Math.floor:Math.ceil;$X=Math.min($X,$g((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var $K=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText($K,$X),this.repaint()},$X.evalTextSize=function(){var $X,$g=NaN;$X=Math.max.apply(this,this._lineWidths),$g=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],$X==this._textWidth&&$g==this._textHeight||(this._textWidth=$X,this._textHeight=$g,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},$X.checkEnabledViewportOrNot=function(){return this.overflow==$V.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},$X.changeText=function($X){this._text!==$X&&(this.lang($X+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},$X.parseLines=function($X){var $g=this.wordWrap||this.overflow==$V.HIDDEN;if($g)var $K=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var $x=$J.contextMeasureText($V._testWord);$C.isConchApp&&0===$x.width&&0===$x.height&&($x=$J.contextMeasureText("W")),this._charSize.width=$x.width,this._charSize.height=$x.height||this.fontSize}for(var $Z=$X.replace(/\r\n/g,"\n").split("\n"),$n=0,$W=$Z.length;$n<$W;$n++){var $v=$Z[$n];$g?this.parseLine($v,$K):(this._lineWidths.push(this.getTextWidth($v)),this._lines.push($v))}},$X.parseLine=function($X,$g){$q.context;var $K,$x=this._lines,$Z=0,$n=NaN,$W=NaN,$v=0;if(($n=this.getTextWidth($X))<=$g)return $x.push($X),void this._lineWidths.push($n);$n=this._charSize.width,0==($Z=Math.floor($g/$n))&&($Z=1),$W=$n=this.getTextWidth($X.substring(0,$Z));for(var $T=$Z,$G=$X.length;$T<$G;$T++)if($g<($W+=$n=this.getTextWidth($X.charAt($T))))if(this.wordWrap){var $c=$X.substring($v,$T);if($c.charCodeAt($c.length-1)<255?($K=/(?:\w|-)+$/.exec($c))&&($T=$K.index+$v,0==$K.index?$T+=$c.length:$c=$X.substring($v,$T)):$V.RightToLeft&&($K=/([\u0600-\u06FF])+$/.exec($c))&&($T=$K.index+$v,0==$K.index?$T+=$c.length:$c=$X.substring($v,$T)),$x.push($c),this._lineWidths.push($W-$n),!(($v=$T)+$Z<$G)){$x.push($X.substring($v,$G)),this._lineWidths.push(this.getTextWidth($x[$x.length-1])),$v=-1;break}$T+=$Z,$W=$n=this.getTextWidth($X.substring($v,$T)),$T--}else if(this.overflow==$V.HIDDEN)return $x.push($X.substring(0,$T)),void this._lineWidths.push(this.getTextWidth($x[$x.length-1]));this.wordWrap&&-1!=$v&&($x.push($X.substring($v,$G)),this._lineWidths.push(this.getTextWidth($x[$x.length-1])))},$X.getTextWidth=function($X){return this._currBitmapFont?this._currBitmapFont.getTextWidth($X):$J.contextMeasureText($X).width},$X.getWordWrapWidth=function(){var $X=this.padding,$g=NaN;return($g=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&($g=this.wordWrap?100:$q.width),$g<=0&&($g=100),$g-$X[3]-$X[1]},$X.getCharPoint=function($X,$g){this._isChanged&&$D.timer.runCallLater(this,this.typeset);for(var $K=0,$x=this._lines,$Z=0,$n=0,$W=$x.length;$n<$W;$n++){if($X<($K+=$x[$n].length)){var $v=$n;break}$Z=$K}var $T=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;$q.context.font=$T;var $G=this.getTextWidth(this._text.substring($Z,$X));return($g||new $B).setTo(this._startX+$G-(this._clipPoint?this._clipPoint.x:0),this._startY+$v*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},$c(0,$X,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function($X){$X!=this._width&&($D.superSet($_X,this,"width",$X),this.isChanged=!0)}),$c(0,$X,"textWidth",function(){return this._isChanged&&$D.timer.runCallLater(this,this.typeset),this._textWidth}),$c(0,$X,"height",function(){return this._height?this._height:this.textHeight},function($X){$X!=this._height&&($D.superSet($_X,this,"height",$X),this.isChanged=!0)}),$c(0,$X,"textHeight",function(){return this._isChanged&&$D.timer.runCallLater(this,this.typeset),this._textHeight}),$c(0,$X,"padding",function(){return this._getCSSStyle().padding},function($X){this._getCSSStyle().padding=$X,this.isChanged=!0}),$c(0,$X,"bold",function(){return this._getCSSStyle().bold},function($X){this._getCSSStyle().bold=$X,this.isChanged=!0}),$c(0,$X,"text",function(){return this._text||""},function($X){this._text!==$X&&(this.lang($X+""),this.isChanged=!0,this.event("change"))}),$c(0,$X,"color",function(){return this._getCSSStyle().color},function($X){this._getCSSStyle().color!=$X&&(this._getCSSStyle().color=$X,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),$c(0,$X,"font",function(){return this._getCSSStyle().fontFamily},function($X){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),$V._bitmapFonts&&$V._bitmapFonts[$X]&&(this._currBitmapFont=$V._bitmapFonts[$X]),this._getCSSStyle().fontFamily=$X,this.isChanged=!0}),$c(0,$X,"fontSize",function(){return this._getCSSStyle().fontSize},function($X){this._getCSSStyle().fontSize=$X,this.isChanged=!0}),$c(0,$X,"italic",function(){return this._getCSSStyle().italic},function($X){this._getCSSStyle().italic=$X,this.isChanged=!0}),$c(0,$X,"align",function(){return this._getCSSStyle().align},function($X){this._getCSSStyle().align=$X,this.isChanged=!0}),$c(0,$X,"valign",function(){return this._getCSSStyle().valign},function($X){this._getCSSStyle().valign=$X,this.isChanged=!0}),$c(0,$X,"wordWrap",function(){return this._getCSSStyle().wordWrap},function($X){this._getCSSStyle().wordWrap=$X,this.isChanged=!0}),$c(0,$X,"leading",function(){return this._getCSSStyle().leading},function($X){this._getCSSStyle().leading=$X,this.isChanged=!0}),$c(0,$X,"bgColor",function(){return this._getCSSStyle().backgroundColor},function($X){this._getCSSStyle().backgroundColor=$X,this.isChanged=!0}),$c(0,$X,"borderColor",function(){return this._getCSSStyle().borderColor},function($X){this._getCSSStyle().borderColor=$X,this.isChanged=!0}),$c(0,$X,"stroke",function(){return this._getCSSStyle().stroke},function($X){this._getCSSStyle().stroke=$X,this.isChanged=!0}),$c(0,$X,"strokeColor",function(){return this._getCSSStyle().strokeColor},function($X){this._getCSSStyle().strokeColor=$X,this.isChanged=!0}),$c(0,$X,"isChanged",null,function($X){this._isChanged!==$X&&(this._isChanged=$X)&&$D.timer.callLater(this,this.typeset)}),$c(0,$X,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function($X){if(!(this.overflow!=$V.SCROLL||this.textWidth<this._width)&&this._clipPoint){$X=$X<this.padding[3]?this.padding[3]:$X;var $g=this._textWidth-this._width;$X=$g<$X?$g:$X;var $K=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=$X,this.renderText(this._lastVisibleLineIndex,$K)}}),$c(0,$X,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function($X){if(!(this.overflow!=$V.SCROLL||this.textHeight<this._height)&&this._clipPoint){$X=$X<this.padding[0]?this.padding[0]:$X;var $g=this._textHeight-this._height,$K=($X=$g<$X?$g:$X)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=$K;var $x=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=$X,this.renderText($K,$x)}}),$c(0,$X,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),$c(0,$X,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),$c(0,$X,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),$c(0,$X,"underlineColor",function(){return this._underlineColor},function($X){this._underlineColor=$X,this._isChanged=!0,this.typeset()}),$V.registerBitmapFont=function($X,$g){$V._bitmapFonts||($V._bitmapFonts={}),$V._bitmapFonts[$X]=$g},$V.unregisterBitmapFont=function($X,$g){if(void 0===$g&&($g=!0),$V._bitmapFonts&&$V._bitmapFonts[$X]){var $K=$V._bitmapFonts[$X];$g&&$K.destroy(),delete $V._bitmapFonts[$X]}},$V.setTextRightToLeft=function(){var $X;($X=$q.canvas.source.style).display="none",$X.position="absolute",$X.direction="rtl",$C._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,$q.document.body.appendChild($q.canvas.source)},$V.supportFont=function($X){$q.context.font="10px sans-serif";var $g=$J.contextMeasureText("abcji").width;$q.context.font="10px "+$X;var $K=$J.contextMeasureText("abcji").width;return console.log($g,$K),$g!==$K},$V._testWord="游",$V.langPacks=null,$V.VISIBLE="visible",$V.SCROLL="scroll",$V.HIDDEN="hidden",$V.CharacterCache=!0,$V.RightToLeft=!1,$V._bitmapFonts=null,$T($V,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),$V}($_X),$FX=function($_){function $W(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",$W.__super.call(this),this.offset=new $B,this._canvasTransform=new $M,this._previousOrientation=$q.window.orientation;var $g=this;this.transform=$M.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var $X=$q.window,$K=this;$X.addEventListener("focus",function(){$g._isFocused=!0,$K.event("focus"),$K.event("focuschange")}),$X.addEventListener("blur",function(){$g._isFocused=!1,$K.event("blur"),$K.event("focuschange"),$K._isInputting()&&($QX.inputElement.target.focus=!1)});var $x="visibilityState",$Z="visibilitychange",$n=$X.document;void 0!==$n.hidden?($Z="visibilitychange",$x="visibilityState"):void 0!==$n.mozHidden?($Z="mozvisibilitychange",$x="mozVisibilityState"):void 0!==$n.msHidden?($Z="msvisibilitychange",$x="msVisibilityState"):void 0!==$n.webkitHidden&&($Z="webkitvisibilitychange",$x="webkitVisibilityState"),$X.document.addEventListener($Z,function(){"hidden"==$q.document[$x]?$K._setStageVisible(!1):$K._setStageVisible(!0)}),$X.document.addEventListener("qbrowserVisibilityChange",function($X){$K._setStageVisible(!$X.hidden)}),$X.addEventListener("resize",function(){var $X=$q.window.orientation;null!=$X&&$X!=$g._previousOrientation&&$K._isInputting()&&($QX.inputElement.target.focus=!1),$g._previousOrientation=$X,$K._isInputting()||$K._resetCanvas()}),$X.addEventListener("orientationchange",function($X){$K._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),$q.onMobile&&this.on("mousedown",this,this._onmouseMove)}$a($W,"laya.display.Stage",$_);var $X=$W.prototype;return $X._setStageVisible=function($X){this._isVisibility!=$X&&(this._isVisibility=$X,this._isVisibility||this._isInputting()&&($QX.inputElement.target.focus=!1),this.event("visibilitychange"))},$X._isInputting=function(){return $q.onMobile&&$QX.isInputting},$X._changeCanvasSize=function(){this.setScreenSize($q.clientWidth*$q.pixelRatio,$q.clientHeight*$q.pixelRatio)},$X._resetCanvas=function(){if(this.screenAdaptationEnabled){var $X=$C._mainCanvas;$X.source.style;$X.size(1,1),$D.timer.once(100,this,this._changeCanvasSize)}},$X.setScreenSize=function($X,$g){var $K=!1;if("none"!==this._screenMode&&($K=($X/$g<1?"vertical":"horizontal")!==this._screenMode)){var $x=$g;$g=$X,$X=$x}this.canvasRotation=$K;var $Z=$C._mainCanvas,$n=$Z.source.style,$W=this._canvasTransform.identity(),$v=this._scaleMode,$T=$X/this.designWidth,$G=$g/this.designHeight,$c=this.designWidth,$_=this.designHeight,$s=$X,$V=$g,$A=$q.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,$v){case"noscale":$T=$G=1,$s=this.designWidth,$V=this.designHeight;break;case"showall":$T=$G=Math.min($T,$G),$c=$s=Math.round(this.designWidth*$T),$_=$V=Math.round(this.designHeight*$G);break;case"noborder":$T=$G=Math.max($T,$G),$s=Math.round(this.designWidth*$T),$V=Math.round(this.designHeight*$G);break;case"full":$T=$G=1,this._width=$c=$X,this._height=$_=$g;break;case"fixedwidth":$G=$T,this._height=$_=Math.round($g/$T);break;case"fixedheight":$T=$G,this._width=$c=Math.round($X/$G);break;case"fixedauto":$X/$g<this.designWidth/this.designHeight?($G=$T,this._height=$_=Math.round($g/$T)):($T=$G,this._width=$c=Math.round($X/$G))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,$c=$c+1&2147483646,$_=$_+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),$T*=this.scaleX,$G*=this.scaleY,1===$T&&1===$G?this.transform.identity():(this.transform.a=this._formatData($T/($s/$c)),this.transform.d=this._formatData($G/($V/$_)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),$Z.size($c,$_),$t.changeWebGLSize($c,$_),$W.scale($s/$c/$A,$V/$_/$A),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=($X-$s)/$A:this.offset.x=.5*($X-$s)/$A,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=($g-$V)/$A:this.offset.y=.5*($g-$V)/$A,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),$W.translate(this.offset.x,this.offset.y),this.canvasDegree=0,$K&&("horizontal"===this._screenMode?($W.rotate(Math.PI/2),$W.translate($g/$A,0),this.canvasDegree=90):($W.rotate(-Math.PI/2),$W.translate(0,$X/$A),this.canvasDegree=-90)),$W.a=this._formatData($W.a),$W.d=this._formatData($W.d),$W.tx=this._formatData($W.tx),$W.ty=this._formatData($W.ty),$n.transformOrigin=$n.webkitTransformOrigin=$n.msTransformOrigin=$n.mozTransformOrigin=$n.oTransformOrigin="0px 0px 0px",$n.transform=$n.webkitTransform=$n.msTransform=$n.mozTransform=$n.oTransform="matrix("+$W.toString()+")",$W.translate(parseInt($n.left)||0,parseInt($n.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},$X._formatData=function($X){return Math.abs($X)<1e-6?0:Math.abs(1-$X)<.001?0<$X?1:-1:$X},$X.getMousePoint=function(){return $B.TEMP.setTo(this.mouseX,this.mouseY)},$X.repaint=function(){this._repaint=1},$X.parentRepaint=function(){},$X._loop=function(){return this.render($C.context,0,0),!0},$X._onmouseMove=function($X){this._mouseMoveTime=$q.now()},$X.getTimeFromFrameStart=function(){return $q.now()-this._frameStartTime},$X.render=function($X,$g,$K){if("sleep"===this._frameRate&&!$C.isConchApp){var $x=$q.now();if(!(1e3<=$x-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&($d.loopCount++,$A.instance.runEvent(),$D.timer._update()));this._frameStartTime=$x}if(this._renderCount++,$C.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=$q.now();var $Z="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),$n=this._renderCount%2==0;if($d.renderSlow=!$Z,$Z||$n||$C.isConchApp){var $W;$d.loopCount++,$A.instance.runEvent(),$D.timer._update(),$t.update3DLoop();var $v=0,$T=0;if($C.isConchNode)for($v=0,$T=this._scenes.length;$v<$T;$v++)($W=this._scenes[$v])&&$W._updateSceneConch();else for($v=0,$T=this._scenes.length;$v<$T;$v++)($W=this._scenes[$v])&&$W._updateScene();if($C.isConchNode){var $G=$_X.CustomList;for($v=0,$T=$G.length;$v<$T;$v++){var $c=$G[$v];$c.customRender($c.customContext,0,0)}return}}$C.isConchNode||this.renderingEnabled&&($Z||!$n||$C.isConchWebGL)&&($C.isWebGL?$C.WebGL.mainContext&&!$C.WebGL.mainContext.isContextLost()&&($X.clear(),$_.prototype.render.call(this,$X,$g,$K),$d._show&&$d._sp&&$d._sp.render($X,$g,$K),$t.clear(this._bgColor),$t.beginFlush(),$X.flush(),$t.endFinish(),$o.instance&&$o.getInstance().endDispose()):($t.clear(this._bgColor),$_.prototype.render.call(this,$X,$g,$K),$d._show&&$d._sp&&$d._sp.render($X,$g,$K)))}else this._renderCount%5==0&&($d.loopCount++,$A.instance.runEvent(),$D.timer._update())},$X._requestFullscreen=function(){var $X=$q.document.documentElement;$X.requestFullscreen?$X.requestFullscreen():$X.mozRequestFullScreen?$X.mozRequestFullScreen():$X.webkitRequestFullscreen?$X.webkitRequestFullscreen():$X.msRequestFullscreen&&$X.msRequestFullscreen()},$X._fullScreenChanged=function(){$D.stage.event("fullscreenchange")},$X.exitFullscreen=function(){var $X=$q.document;$X.exitFullscreen?$X.exitFullscreen():$X.mozCancelFullScreen?$X.mozCancelFullScreen():$X.webkitExitFullscreen&&$X.webkitExitFullscreen()},$c(0,$X,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),$c(0,$X,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),$c(0,$X,"frameRate",function(){return this._frameRate},function($X){if(this._frameRate=$X,$C.isConchApp)switch(this._frameRate){case"slow":$q.window.conch&&$q.window.conchConfig.setSlowFrame&&$q.window.conchConfig.setSlowFrame(!0);break;case"fast":$q.window.conch&&$q.window.conchConfig.setSlowFrame&&$q.window.conchConfig.setSlowFrame(!1);break;case"mouse":$q.window.conch&&$q.window.conchConfig.setMouseFrame&&$q.window.conchConfig.setMouseFrame(2e3);break;case"sleep":$q.window.conch&&$q.window.conchConfig.setLimitFPS&&$q.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),$c(0,$X,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),$c(0,$X,"width",$_.prototype._$get_width,function($X){this.designWidth=$X,$D.superSet($_X,this,"width",$X),$D.timer.callLater(this,this._changeCanvasSize)}),$c(0,$X,"alignH",function(){return this._alignH},function($X){this._alignH=$X,$D.timer.callLater(this,this._changeCanvasSize)}),$c(0,$X,"isFocused",function(){return this._isFocused}),$c(0,$X,"height",$_.prototype._$get_height,function($X){this.designHeight=$X,$D.superSet($_X,this,"height",$X),$D.timer.callLater(this,this._changeCanvasSize)}),$c(0,$X,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||$M.create()},$_.prototype._$set_transform),$c(0,$X,"isVisibility",function(){return this._isVisibility}),$c(0,$X,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),$c(0,$X,"scaleMode",function(){return this._scaleMode},function($X){this._scaleMode=$X,$D.timer.callLater(this,this._changeCanvasSize)}),$c(0,$X,"alignV",function(){return this._alignV},function($X){this._alignV=$X,$D.timer.callLater(this,this._changeCanvasSize)}),$c(0,$X,"bgColor",function(){return this._bgColor},function($X){this._bgColor=$X,this.conchModel&&this.conchModel.bgColor($X),$C.isWebGL&&($X?$W._wgColor=$e.create($X)._color:$q.onMiniGame||($W._wgColor=null)),$q.onLimixiu?$W._wgColor=$e.create($X)._color:$C.canvas.style.background=$X||"none"}),$c(0,$X,"mouseX",function(){return Math.round($A.instance.mouseX/this.clientScaleX)}),$c(0,$X,"mouseY",function(){return Math.round($A.instance.mouseY/this.clientScaleY)}),$c(0,$X,"screenMode",function(){return this._screenMode},function($X){this._screenMode=$X}),$c(0,$X,"visible",$_.prototype._$get_visible,function($X){this.visible!==$X&&($D.superSet($_X,this,"visible",$X),$C._mainCanvas.source.style.visibility=$X?"visible":"hidden")}),$c(0,$X,"fullScreenEnabled",null,function($X){var $g=$q.document,$K=$C.canvas;$X?($K.addEventListener("mousedown",this._requestFullscreen),$K.addEventListener("touchstart",this._requestFullscreen),$g.addEventListener("fullscreenchange",this._fullScreenChanged),$g.addEventListener("mozfullscreenchange",this._fullScreenChanged),$g.addEventListener("webkitfullscreenchange",this._fullScreenChanged),$g.addEventListener("msfullscreenchange",this._fullScreenChanged)):($K.removeEventListener("mousedown",this._requestFullscreen),$K.removeEventListener("touchstart",this._requestFullscreen),$g.removeEventListener("fullscreenchange",this._fullScreenChanged),$g.removeEventListener("mozfullscreenchange",this._fullScreenChanged),$g.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),$g.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),$W.SCALE_NOSCALE="noscale",$W.SCALE_EXACTFIT="exactfit",$W.SCALE_SHOWALL="showall",$W.SCALE_NOBORDER="noborder",$W.SCALE_FULL="full",$W.SCALE_FIXED_WIDTH="fixedwidth",$W.SCALE_FIXED_HEIGHT="fixedheight",$W.SCALE_FIXED_AUTO="fixedauto",$W.ALIGN_LEFT="left",$W.ALIGN_RIGHT="right",$W.ALIGN_CENTER="center",$W.ALIGN_TOP="top",$W.ALIGN_MIDDLE="middle",$W.ALIGN_BOTTOM="bottom",$W.SCREEN_NONE="none",$W.SCREEN_HORIZONTAL="horizontal",$W.SCREEN_VERTICAL="vertical",$W.FRAME_FAST="fast",$W.FRAME_SLOW="slow",$W.FRAME_MOUSE="mouse",$W.FRAME_SLEEP="sleep",$W.FRAME_MOUSE_THREDHOLD=2e3,$T($W,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),$W}($_X),$UX=(function($X){function $g(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,$g.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}$a($g,"laya.media.SoundNode",$_X);var $K=$g.prototype;$K._onParentChange=function(){this.target=this.parent},$K.play=function($X,$g){void 0===$X&&($X=1),isNaN($X)&&($X=1),this.url&&(this.stop(),this._channel=$r.playSound(this.url,$X,null,$g))},$K.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},$K._setPlayAction=function($X,$g,$K,$x){void 0===$x&&($x=!0),this[$K]&&$X&&($x?$X.on($g,this,this[$K]):$X.off($g,this,this[$K]))},$K._setPlayActions=function($X,$g,$K,$x){if(void 0===$x&&($x=!0),$X&&$g){var $Z,$n=$g.split(","),$W=0;for($Z=$n.length,$W=0;$W<$Z;$W++)this._setPlayAction($X,$n[$W],$K,$x)}},$c(0,$K,"playEvent",null,function($X){(this._playEvents=$X)&&this._tar&&this._setPlayActions(this._tar,$X,"play")}),$c(0,$K,"target",null,function($X){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=$X,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),$c(0,$K,"stopEvent",null,function($X){(this._stopEvents=$X)&&this._tar&&this._setPlayActions(this._tar,$X,"stop")})}(),function($X){function $g(){this._src=null,this._onload=null,this._onerror=null,$g.__super.call(this)}$a($g,"laya.resource.FileBitmap",$AX);var $K=$g.prototype;return $c(0,$K,"src",function(){return this._src},function($X){this._src=$X}),$c(0,$K,"onload",null,function($X){}),$c(0,$K,"onerror",null,function($X){}),$g}()),$$X=function($X){function $K($X,$g){this._is2D=!1,$K.__super.call(this);var $x=this;if(this._source=this,"2D"===$X||"AUTO"===$X&&!$C.isWebGL){this._is2D=!0,this._source=$g||$q.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var $Z=this;$Z.getContext=function($X,$g){if($x._ctx)return $x._ctx;var $K=$x._ctx=$x._source.getContext($X,$g);return $K&&($K._canvas=$Z,$C.isFlash||$q.onLimixiu||($K.size=function($X,$g){})),$K}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}$a($K,"laya.resource.HTMLCanvas",$AX);var $g=$K.prototype;return $g.clear=function(){this._ctx&&this._ctx.clear()},$g.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$g.release=function(){},$g._setContext=function($X){this._ctx=$X},$g.getContext=function($X,$g){return this._ctx?this._ctx:this._ctx=$K._createContext(this)},$g.getMemSize=function(){return 0},$g.size=function($X,$g){(this._w!=$X||this._h!=$g||this._source&&(this._source.width!=$X||this._source.height!=$g))&&(this._w=$X,this._h=$g,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size($X,$g),this._source&&(this._source.height=$g,this._source.width=$X))},$g.getCanvas=function(){return this._source},$g.toBase64=function($X,$g,$K){if(this._source)if($C.isConchApp&&this._source.toBase64)this._source.toBase64($X,$g,$K);else{var $x=this._source.toDataURL($X,$g);$K.call(this,$x)}},$c(0,$g,"context",function(){return this._ctx}),$c(0,$g,"asBitmap",null,function($X){}),$K.create=function($X,$g){return new $K($X,$g)},$K.TYPE2D="2D",$K.TYPE3D="3D",$K.TYPEAUTO="AUTO",$K._createContext=null,$K}(),$wX=(function($X){function $T($X,$g,$K,$x,$Z,$n,$W,$v){throw $T.__super.call(this),new Error("不允许new！")}$a($T,"laya.resource.HTMLSubImage",$AX),$T.create=function($X,$g,$K,$x,$Z,$n,$W,$v){return void 0===$v&&($v=!1),new $T($X,$g,$K,$x,$Z,$n,$W,$v)}}(),function($X){function $_(){this._frames=null,this._url=null,$_.__super.call(this),this._setControlNode(this)}$a($_,"laya.display.Animation",$X);var $g=$_.prototype;$g.destroy=function($X){void 0===$X&&($X=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,$X),this._frames=null,this._labels=null},$g.play=function($X,$g,$K,$x){void 0===$X&&($X=0),void 0===$g&&($g=!0),void 0===$K&&($K=""),void 0===$x&&($x=!0),$K&&this._setFramesFromCache($K,$x),this._isPlaying=!0,this.index="string"==typeof $X?this._getFrameByLabel($X):$X,this.loop=$g,this._actionName=$K,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$g._setFramesFromCache=function($X,$g){var $K;return void 0===$g&&($g=!1),this._url&&($X=this._url+"#"+$X),$X&&$_.framesMap[$X]?(($K=$_.framesMap[$X])instanceof Array?(this._frames=$_.framesMap[$X],this._count=this._frames.length):($K.nodeRoot&&($_.framesMap[$X]=this._parseGraphicAnimationByData($K),$K=$_.framesMap[$X]),this._frames=$K.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=$K.interval),this._labels=this._copyLabels($K.labels)),!0):($g&&console.log("ani not found:",$X),!1)},$g._copyLabels=function($X){if(!$X)return null;var $g,$K;for($K in $g={},$X)$g[$K]=$J.copyArray([],$X[$K]);return $g},$g._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&$X.prototype._frameLoop.call(this)},$g._displayToIndex=function($X){this._frames&&(this.graphics=this._frames[$X])},$g.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},$g.loadImages=function($X,$g){return void 0===$g&&($g=""),this._url="",this._setFramesFromCache($g)||(this.frames=$_.framesMap[$g]?$_.framesMap[$g]:$_.createFrames($X,$g)),this},$g.loadAtlas=function($g,$K,$x){void 0===$x&&($x=""),this._url="";var $Z=this;function $X($X){$g===$X&&($Z.frames=$_.framesMap[$x]?$_.framesMap[$x]:$_.createFrames($g,$x),$K&&$K.run())}return $Z._setFramesFromCache($x)||($vX.getAtlas($g)?$X($g):$D.loader.load($g,$U.create(null,$X,[$g]),null,"atlas")),this},$g.loadAnimation=function($X,$g,$K){this._url=$X;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,$g&&$g.run()):!$K||$vX.getAtlas($K)?this._loadAnimationData($X,$g,$K):$D.loader.load($K,$U.create(this,this._loadAnimationData,[$X,$g,$K]),null,"atlas"),this},$g._loadAnimationData=function($v,$T,$X){var $G=this;if(!$X||$vX.getAtlas($X)){var $c=this;$vX.getRes($v)?$g($v):$D.loader.load($v,$U.create(null,$g,[$v]),null,"json"),$vX.clearRes($v)}else console.warn("atlas load fail:"+$X);function $g($X){if($vX.getRes($X)&&$v===$X){var $g;if($_.framesMap[$v+"#"])$c._setFramesFromCache($G._actionName,!0),$G.index=0,$G._checkResumePlaying();else{var $K=$c._parseGraphicAnimation($vX.getRes($v));if(!$K)return;var $x,$Z=$K.animationList,$n=0,$W=$Z.length;for($n=0;$n<$W;$n++)$g=$Z[$n],$_.framesMap[$v+"#"+$g.name]=$g,$x||($x=$g);$x&&($_.framesMap[$v+"#"]=$x,$c._setFramesFromCache($G._actionName,!0),$G.index=0),$G._checkResumePlaying()}$T&&$T.run()}}},$g._parseGraphicAnimation=function($X){return $DX.parseAnimationData($X)},$g._parseGraphicAnimationByData=function($X){return $DX.parseAnimationByData($X)},$c(0,$g,"frames",function(){return this._frames},function($X){(this._frames=$X)&&(this._count=$X.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),$c(0,$g,"autoPlay",null,function($X){$X?this.play():this.stop()}),$c(0,$g,"source",null,function($X){-1<$X.indexOf(".ani")?this.loadAnimation($X):-1<$X.indexOf(".json")||-1<$X.indexOf("als")||-1<$X.indexOf("atlas")?this.loadAtlas($X):this.loadImages($X.split(","))}),$c(0,$g,"autoAnimation",null,function($X){this.play(0,!0,$X,!1)}),$_.createFrames=function($X,$g){var $K,$x,$Z=0,$n=0;if("string"==typeof $X){var $W=$vX.getAtlas($X);if($W&&$W.length)for($K=[],$Z=0,$n=$W.length;$Z<$n;$Z++)($x=new $t.createGraphics).drawTexture($vX.getRes($W[$Z]),0,0),$K.push($x)}else if($X instanceof Array)for($K=[],$Z=0,$n=$X.length;$Z<$n;$Z++)($x=new $t.createGraphics).loadImage($X[$Z],0,0),$K.push($x);return $g&&($_.framesMap[$g]=$K),$K},$_.clearCache=function($X){var $g,$K=$_.framesMap,$x=$X+"#";for($g in $K)$g!==$X&&0!=$g.indexOf($x)||delete $_.framesMap[$g]},$_.framesMap={}}($aX),function($X){function $n(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,$n.__super.call(this),null==$n._sortIndexFun&&($n._sortIndexFun=$f.sortByKey("index",!1,!0))}$a($n,"laya.display.FrameAnimation",$X);var $g=$n.prototype;return $g._setUp=function($X,$g){this._labels=null,this._animationNewFrames=null,this._targetDic=$X,this._animationData=$g,this.interval=1e3/$g.frameRate,$g.parsed?(this._count=$g.count,this._labels=$g.labels,this._animationNewFrames=$g.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),$g.parsed=!0,$g.labels=this._labels,$g.count=this._count,$g.animationNewFrames=this._animationNewFrames},$g.clear=function(){$X.prototype.clear.call(this),this._targetDic=null,this._animationData=null},$g._displayToIndex=function($X){if(this._animationData){$X<0&&($X=0),$X>this._count&&($X=this._count);var $g=this._animationData.nodes,$K=0,$x=$g.length;for($K=0;$K<$x;$K++)this._displayNodeToFrame($g[$K],$X)}},$g._displayNodeToFrame=function($X,$g,$K){$K||($K=this._targetDic);var $x=$K[$X.target];if($x){var $Z,$n,$W,$v=$X.frames,$T=$X.keys,$G=0,$c=$T.length;for($G=0;$G<$c;$G++)$W=($n=$v[$Z=$T[$G]]).length>$g?$n[$g]:$n[$n.length-1],$x[$Z]=$W}},$g._calculateDatas=function(){if(this._animationData){var $X,$g=this._animationData.nodes,$K=0,$x=$g.length;for($K=this._count=0;$K<$x;$K++)$X=$g[$K],this._calculateNodeKeyFrames($X);this._count+=1}},$g._calculateNodeKeyFrames=function($X){var $g,$K,$x=$X.keyframes,$Z=$X.target;for($g in $X.frames||($X.frames={}),$X.keys?$X.keys.length=0:$X.keys=[],$X.initValues||($X.initValues={}),$x)$K=$x[$g],$X.frames[$g]||($X.frames[$g]=[]),this._targetDic&&this._targetDic[$Z]&&($X.initValues[$g]=this._targetDic[$Z][$g]),$K.sort($n._sortIndexFun),$X.keys.push($g),this._calculateNodePropFrames($K,$X.frames[$g],$g,$Z)},$g.resetToInitState=function(){if(this._targetDic&&this._animationData){var $X,$g,$K=this._animationData.nodes,$x=0,$Z=$K.length;for($x=0;$x<$Z;$x++)if($g=($X=$K[$x]).initValues){var $n,$W=this._targetDic[$X.target];if($W)for($n in $g)$W[$n]=$g[$n]}}},$g._calculateNodePropFrames=function($X,$g,$K,$x){var $Z=0,$n=$X.length-1;if(0<$n){for($g.length=$X[$n].index+1,$Z=0;$Z<$n;$Z++)this._dealKeyFrame($X[$Z]),this._calculateFrameValues($X[$Z],$X[$Z+1],$g);this._dealKeyFrame($X[$Z])}0==$n&&($g[$X[0].index]=$X[0].value,this._animationNewFrames&&(this._animationNewFrames[$X[0].index]=!0))},$g._dealKeyFrame=function($X){$X.label&&""!=$X.label&&this.addLabel($X.label,$X.index)},$g._calculateFrameValues=function($X,$g,$K){var $x,$Z=0,$n=$X.index,$W=$g.index,$v=$X.value,$T=$g.value-$X.value,$G=$W-$n;if($W>this._count&&(this._count=$W),$X.tween)for(null==($x=$S[$X.tweenMethod])&&($x=$S.linearNone),$Z=$n;$Z<$W;$Z++)$K[$Z]=$x($Z-$n,$v,$T,$G),this._animationNewFrames&&(this._animationNewFrames[$Z]=!0);else for($Z=$n;$Z<$W;$Z++)$K[$Z]=$v;this._animationNewFrames&&(this._animationNewFrames[$X.index]=!0,this._animationNewFrames[$g.index]=!0),$K[$g.index]=$g.value},$n._sortIndexFun=null,$n}($aX)),$QX=function($g){function $Z(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",$Z.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=$mX.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}$a($Z,"laya.display.Input",$g);var $X=$Z.prototype;return $X.setSelection=function($X,$g){this.focus=!0,laya.display.Input.inputElement.selectionStart=$X,laya.display.Input.inputElement.selectionEnd=$g},$X._onUnDisplay=function($X){this.focus=!1},$X._onMouseDown=function($X){this.focus=!0},$X._syncInputTransform=function(){var $X=this.nativeInput,$g=$J.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),$K=this._width-this.padding[1]-this.padding[3],$x=this._height-this.padding[0]-this.padding[2];$C.isConchApp?($X.setScale($g.scaleX,$g.scaleY),$X.setSize($K,$x),$X.setPos($g.x,$g.y)):($Z.inputContainer.style.transform=$Z.inputContainer.style.webkitTransform="scale("+$g.scaleX+","+$g.scaleY+") rotate("+$D.stage.canvasDegree+"deg)",$X.style.width=$K+"px",$X.style.height=$x+"px",$Z.inputContainer.style.left=$g.x+"px",$Z.inputContainer.style.top=$g.y+"px")},$X.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},$X._setInputMethod=function(){$Z.input.parentElement&&$Z.inputContainer.removeChild($Z.input),$Z.area.parentElement&&$Z.inputContainer.removeChild($Z.area),$Z.inputElement=this._multiline?$Z.area:$Z.input,$Z.inputContainer.appendChild($Z.inputElement),$mX.RightToLeft&&($Z.inputElement.style.direction="rtl")},$X._focusIn=function(){laya.display.Input.isInputting=!0;var $X=this.nativeInput;this._focus=!0;var $g=$X.style;$g.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),$X.readOnly=!this._editable,$C.isConchApp&&($X.setType(this._type),$X.setForbidEdit(!this._editable)),$X.maxLength=this._maxChars;this.padding;if($X.type=this._type,$X.value=this._content,$X.placeholder=this._prompt,$D.stage.off("keydown",this,this._onKeyDown),$D.stage.on("keydown",this,this._onKeyDown),($D.stage.focus=this).event("focus"),$q.onPC&&$X.focus(),!$q.onMiniGame){this._text;this._text=null}this.typeset(),$X.setColor(this._originColor),$X.setFontSize(this.fontSize),$X.setFontFace($q.onIPhone&&$mX._fontFamilyMap[this.font]||this.font),$C.isConchApp&&$X.setMultiAble&&$X.setMultiAble(this._multiline),$g.lineHeight=this.leading+this.fontSize+"px",$g.fontStyle=this.italic?"italic":"normal",$g.fontWeight=this.bold?"bold":"normal",$g.textAlign=this.align,$g.padding="0 0",this._syncInputTransform(),!$C.isConchApp&&$q.onPC&&$D.timer.frameLoop(1,this,this._syncInputTransform)},$X._setPromptColor=function(){($Z.promptStyleDOM=$q.getElementById("promptStyle"))||(($Z.promptStyleDOM=$q.createElement("style")).setAttribute("id","promptStyle"),$q.document.head.appendChild($Z.promptStyleDOM)),$Z.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},$X._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?($D.superSet($mX,this,"text",this._content),$D.superSet($mX,this,"color",this._originColor)):($D.superSet($mX,this,"text",this._prompt),$D.superSet($mX,this,"color",this._promptColor)),$D.stage.off("keydown",this,this._onKeyDown),$D.stage.focus=null,this.event("blur"),$C.isConchApp&&this.nativeInput.blur(),$q.onPC&&$D.timer.clear(this,this._syncInputTransform)},$X._onKeyDown=function($X){13===$X.keyCode&&($q.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},$X.changeText=function($X){this._content=$X,this._focus?(this.nativeInput.value=$X||"",this.event("change")):$g.prototype.changeText.call(this,$X)},$c(0,$X,"color",$g.prototype._$get_color,function($X){this._focus&&this.nativeInput.setColor($X),$D.superSet($mX,this,"color",this._content?$X:this._promptColor),this._originColor=$X}),$c(0,$X,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function($X){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),$c(0,$X,"multiline",function(){return this._multiline},function($X){this._multiline=$X,this.valign=$X?"top":"middle"}),$c(0,$X,"maxChars",function(){return this._maxChars},function($X){$X<=0&&($X=1e5),this._maxChars=$X}),$c(0,$X,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function($X){$D.superSet($mX,this,"color",this._originColor),$X+="",this._focus?(this.nativeInput.value=$X||"",this.event("change")):(this._multiline||($X=$X.replace(/\r?\n/g,"")),(this._content=$X)?$D.superSet($mX,this,"text",$X):($D.superSet($mX,this,"text",this._prompt),$D.superSet($mX,this,"color",this.promptColor)))}),$c(0,$X,"nativeInput",function(){return this._multiline?$Z.area:$Z.input}),$c(0,$X,"prompt",function(){return this._prompt},function($X){!this._text&&$X&&$D.superSet($mX,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?$D.superSet($mX,this,"text",this._text==this._prompt?$X:this._text):$D.superSet($mX,this,"text",$X),this._prompt=$mX.langPacks&&$mX.langPacks[$X]?$mX.langPacks[$X]:$X}),$c(0,$X,"focus",function(){return this._focus},function($X){var $g=this.nativeInput;this._focus!==$X&&($X?($g.target?$g.target._focusOut():this._setInputMethod(),($g.target=this)._focusIn()):($g.target=null,this._focusOut(),$q.document.body.scrollTop=0,$g.blur(),$C.isConchApp?$g.setPos(-1e4,-1e4):$Z.inputContainer.contains($g)&&$Z.inputContainer.removeChild($g)))}),$c(0,$X,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function($X){$X?(-1<($X="[^"+$X+"]").indexOf("^^")&&($X=$X.replace("^^","")),this._restrictPattern=new RegExp($X,"g")):this._restrictPattern=null}),$c(0,$X,"editable",function(){return this._editable},function($X){this._editable=$X,$C.isConchApp&&$Z.input.setForbidEdit(!$X)}),$c(0,$X,"promptColor",function(){return this._promptColor},function($X){this._promptColor=$X,this._content||$D.superSet($mX,this,"color",$X)}),$c(0,$X,"type",function(){return this._type},function($X){this._getCSSStyle().password="password"==$X,this._type=$X,$C.isConchApp&&this.nativeInput.setType($X)}),$c(0,$X,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function($X){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),$c(0,$X,"asPassword",function(){return this._getCSSStyle().password},function($X){this._getCSSStyle().password=$X,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),$Z.__init__=function(){$Z._createInputElement(),$q.onMobile&&$C.canvas.addEventListener($Z.IOS_IFRAME?$q.onMiniGame?"touchend":"click":"touchend",$Z._popupInputMethod)},$Z._popupInputMethod=function($X){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},$Z._createInputElement=function(){$Z._initInput($Z.area=$q.createElement("textarea")),$Z._initInput($Z.input=$q.createElement("input")),($Z.inputContainer=$q.createElement("div")).style.position="absolute",$Z.inputContainer.style.zIndex=1e5,$q.container.appendChild($Z.inputContainer),$Z.inputContainer.setPos=function($X,$g){$Z.inputContainer.style.left=$X+"px",$Z.inputContainer.style.top=$g+"px"}},$Z._initInput=function($g){var $X=$g.style;$X.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",$X.resize="none",$X.backgroundColor="transparent",$X.border="none",$X.outline="none",$X.zIndex=1,$g.addEventListener("input",$Z._processInputting),$g.addEventListener("mousemove",$Z._stopEvent),$g.addEventListener("mousedown",$Z._stopEvent),$g.addEventListener("touchmove",$Z._stopEvent),$g.setFontFace=function($X){$g.style.fontFamily=$X},$C.isConchApp||($g.setColor=function($X){$g.style.color=$X},$g.setFontSize=function($X){$g.style.fontSize=$X+"px"})},$Z._processInputting=function($X){var $g=laya.display.Input.inputElement.target;if($g){var $K=laya.display.Input.inputElement.value;$g._restrictPattern&&($K=$K.replace(/\u2006|\x27/g,""),$g._restrictPattern.test($K)&&($K=$K.replace($g._restrictPattern,""),laya.display.Input.inputElement.value=$K)),$g._text=$K,$g.event("input")}},$Z._stopEvent=function($X){"touchmove"==$X.type&&$X.preventDefault(),$X.stopPropagation&&$X.stopPropagation()},$Z.TYPE_TEXT="text",$Z.TYPE_PASSWORD="password",$Z.TYPE_EMAIL="email",$Z.TYPE_URL="url",$Z.TYPE_NUMBER="number",$Z.TYPE_RANGE="range",$Z.TYPE_DATE="date",$Z.TYPE_MONTH="month",$Z.TYPE_WEEK="week",$Z.TYPE_TIME="time",$Z.TYPE_DATE_TIME="datetime",$Z.TYPE_DATE_TIME_LOCAL="datetime-local",$Z.TYPE_SEARCH="search",$Z.input=null,$Z.area=null,$Z.inputElement=null,$Z.inputContainer=null,$Z.confirmButton=null,$Z.promptStyleDOM=null,$Z.inputHeight=45,$Z.isInputting=!1,$Z.stageMatrix=null,$T($Z,["IOS_IFRAME",function(){return this.IOS_IFRAME=$q.onIOS&&$q.window.top!=$q.window.self}]),$Z}($mX),$fX=function($X){function $K($X,$g){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,$K.__super.call(this),$X&&this._init_($X,$g)}$a($K,"laya.resource.HTMLImage",$UX);var $g=$K.prototype;return $g._init_=function($X,$g){this._src=$X,this._source=new $q.window.Image,$g&&($g.onload&&(this.onload=$g.onload),$g.onerror&&(this.onerror=$g.onerror),$g.onCreate&&$g.onCreate(this)),0!=$X.indexOf("data:image")&&(this._source.crossOrigin=""),$X&&(this._source.src=$X)},$g.recreateResource=function(){var $X=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var $g=this;this._source=new $q.window.Image,this._source.crossOrigin="",this._source.onload=function(){if($g._needReleaseAgain)return $g._needReleaseAgain=!1,$g._source.onload=null,void($g._source=null);$g._source.onload=null,$g.memorySize=$X._w*$X._h*4,$g._recreateLock=!1,$g.completeCreate()},this._source.src=this._src}},$g.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},$g.onresize=function(){this._w=this._source.width,this._h=this._source.height},$c(0,$g,"onload",null,function($X){var $g=this;this._onload=$X,this._source&&(this._source.onload=null!=this._onload?function(){$g.onresize(),$g._onload()}:null)}),$c(0,$g,"onerror",null,function($X){var $g=this;this._onerror=$X,this._source&&(this._source.onerror=null!=this._onerror?function(){$g._onerror()}:null)}),$c(0,$g,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($X){this._enableMerageInAtlas=$X,$C.isConchApp&&this._source&&(this._source.enableMerageInAtlas=$X)}),$K.create=function($X,$g){return new $K($X,$g)},$K}(),$DX=(function($n){function $X(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,$X.__super.call(this)}$a($X,"laya.display.EffectAnimation",$n);var $g=$X.prototype;$g._onOtherBegin=function($X){$X!=this&&this.stop()},$g.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},$g._onPlayAction=function(){this.play(0,!1)},$g.play=function($X,$g,$K,$x){void 0===$X&&($X=0),void 0===$g&&($g=!0),void 0===$K&&($K=""),void 0===$x&&($x=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,$X,$g,$K,$x))},$g._recordInitData=function(){if(this._aniKeys){var $X,$g,$K=0;for($X=this._aniKeys.length,$K=0;$K<$X;$K++)$g=this._aniKeys[$K],this._initData[$g]=this._target[$g]}},$g._displayToIndex=function($X){if(this._animationData){$X<0&&($X=0),$X>this._count&&($X=this._count);var $g=this._animationData.nodes,$K=0,$x=$g.length;for($x=1<$x?1:$x,$K=0;$K<$x;$K++)this._displayNodeToFrame($g[$K],$X)}},$g._displayNodeToFrame=function($X,$g,$K){if(this._target){var $x;$x=this._target;var $Z,$n,$W,$v,$T=$X.frames,$G=$X.keys,$c=0,$_=$G.length;$v=$X.secondFrames;var $s,$V,$A,$a,$m=0;for($c=0;$c<$_;$c++)$n=$T[$Z=$G[$c]],$W=-1==($m=$v[$Z])?this._initData[$Z]:$g<$m?($A=($V=$X.keyframes[$Z])[0]).tween?(null==($s=$S[$A.tweenMethod])&&($s=$S.linearNone),$a=$V[1],$s($g,this._initData[$Z],$a.value-this._initData[$Z],$a.index)):this._initData[$Z]:$n.length>$g?$n[$g]:$n[$n.length-1],$x[$Z]=$W}},$g._calculateNodeKeyFrames=function($X){$n.prototype._calculateNodeKeyFrames.call(this,$X);var $g,$K,$x,$Z=$X.keyframes;$X.target;for($g in $x={},$X.secondFrames=$x,$Z)($K=$Z[$g]).length<=1?$x[$g]=-1:$x[$g]=$K[1].index},$c(0,$g,"target",function(){return this._target},function($X){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=$X,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),$c(0,$g,"playEvent",null,function($X){(this._playEvents=$X)&&this.addEvent()}),$c(0,$g,"effectData",null,function($X){var $g;$X&&(($g=$X.animations)&&$g[0]&&(this._setUp({},$g[0]),$g[0].nodes&&$g[0].nodes[0]&&(this._aniKeys=$g[0].nodes[0].keys)))}),$c(0,$g,"effectClass",null,function($X){var $g,$K;(this._effectClass=$O.getClass($X),this._effectClass)&&(($g=this._effectClass.uiView)&&($K=$g.animations)&&$K[0]&&(this._setUp({},$K[0]),$K[0].nodes&&$K[0].nodes[0]&&(this._aniKeys=$K[0].nodes[0].keys)))}),$X.EffectAnimationBegin="effectanimationbegin"}($wX),function($g){var $I;function $r(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,$r.__super.call(this)}$a($r,"laya.utils.GraphicAnimation",$g);var $X=$r.prototype;return $X._parseNodeList=function($X){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[$X.compId]=$X.props,$X.compId&&this._nodeList.push($X.compId);var $g=$X.child;if($g){var $K=0,$x=$g.length;for($K=0;$K<$x;$K++)this._parseNodeList($g[$K])}},$X._calGraphicData=function($X){var $g;if(this._setUp(null,$X),this._createGraphicData(),this._nodeIDAniDic)for($g in this._nodeIDAniDic)this._nodeIDAniDic[$g]=null},$X._createGraphicData=function(){var $X,$g=[],$K=0,$x=this.count,$Z=this._animationNewFrames;for($Z||($Z=[]),$K=0;$K<$x;$K++)!$Z[$K]&&$X||($X=this._createFrameGraphic($K)),$g.push($X);this._gList=$g},$X._createFrameGraphic=function($X){var $g=$t.createGraphics();return $r._rootMatrix||($r._rootMatrix=new $M),this._updateNodeGraphic(this._rootNode,$X,$r._rootMatrix,$g),$g},$X._updateNodeGraphic=function($X,$g,$K,$x,$Z){var $n;void 0===$Z&&($Z=1);var $W,$v,$T,$G=($n=this._nodeGDic[$X.compId]=this._getNodeGraphicData($X.compId,$g,this._nodeGDic[$X.compId])).alpha*$Z;if(!($G<.01)&&($n.resultTransform||($n.resultTransform=$M.create()),$W=$n.resultTransform,$M.mul($n.transform,$K,$W),$n.skin&&($v=this._getTextureByUrl($n.skin))&&($W._checkTransform()?($x.drawTexture($v,0,0,$n.width,$n.height,$W,$G),$n.resultTransform=null):$x.drawTexture($v,$W.tx,$W.ty,$n.width,$n.height,null,$G)),$T=$X.child)){var $c,$_=0;for($c=$T.length,$_=0;$_<$c;$_++)this._updateNodeGraphic($T[$_],$g,$W,$x,$G)}},$X._updateNoChilds=function($X,$g){if($X.skin){var $K=this._getTextureByUrl($X.skin);if($K){var $x=$X.transform;$x._checkTransform();!$x.bTransform?$g.drawTexture($K,$x.tx,$x.ty,$X.width,$X.height,null,$X.alpha):$g.drawTexture($K,0,0,$X.width,$X.height,$x.clone(),$X.alpha)}}},$X._updateNodeGraphic2=function($X,$g,$K){var $x;if($x=this._nodeGDic[$X.compId]=this._getNodeGraphicData($X.compId,$g,this._nodeGDic[$X.compId]),$X.child){var $Z=$x.transform;$Z._checkTransform();var $n,$W;$W=($n=!$Z.bTransform)&&(0!=$Z.tx||0!=$Z.ty);var $v,$T,$G;if(($v=$Z.bTransform||1!=$x.alpha)&&$K.save(),1!=$x.alpha&&$K.alpha($x.alpha),$n?$W&&$K.translate($Z.tx,$Z.ty):$K.transform($Z.clone()),$T=$X.child,$x.skin&&($G=this._getTextureByUrl($x.skin))&&$K.drawTexture($G,0,0,$x.width,$x.height),$T){var $c,$_=0;for($c=$T.length,$_=0;$_<$c;$_++)this._updateNodeGraphic2($T[$_],$g,$K)}$v?$K.restore():$n?$W&&$K.translate(-$Z.tx,-$Z.ty):$K.transform($Z.clone().invert())}else this._updateNoChilds($x,$K)},$X._calculateNodeKeyFrames=function($X){$g.prototype._calculateNodeKeyFrames.call(this,$X),this._nodeIDAniDic[$X.target]=$X},$X.getNodeDataByID=function($X){return this._nodeIDAniDic[$X]},$X._getParams=function($X,$g,$K,$x){var $Z=$r._temParam;$Z.length=$g.length;var $n=0,$W=$g.length;for($n=0;$n<$W;$n++)$Z[$n]=this._getObjVar($X,$g[$n][0],$K,$g[$n][1],$x);return $Z},$X._getObjVar=function($X,$g,$K,$x,$Z){if($X.hasOwnProperty($g)){var $n=$X[$g];if($K>=$n.length&&($K=$n.length-1),null!=$X[$g][$K])return $X[$g][$K]}return $Z.hasOwnProperty($g)?$Z[$g]:$x},$X._getNodeGraphicData=function($X,$g,$K){$K||($K=$I.create()),$K.transform?$K.transform.identity():$K.transform=$M.create();var $x=this.getNodeDataByID($X);if(!$x)return $K;var $Z,$n,$W=$x.frames,$v=this._getParams($W,$r._drawTextureCmd,$g,this._nodeDefaultProps[$X]),$T=$v[0],$G=NaN,$c=NaN,$_=$v[5],$s=$v[6],$V=$v[13],$A=$v[14],$a=$v[7],$m=$v[8],$F=$v[9],$U=$v[11],$$=$v[12];$G=$v[3],$c=$v[4],0!=$G&&0!=$c||($T=null),-1==$G&&($G=0),-1==$c&&($c=0),$K.skin=$T,$K.width=$G,$K.height=$c,$T&&(($Z=this._getTextureByUrl($T))?($G||($G=$Z.sourceWidth),$c||($c=$Z.sourceHeight)):console.warn("lost skin:",$T,",you may load pics first")),$K.alpha=$v[10],$n=$K.transform,0!=$V&&($_=$V*$G),0!=$A&&($s=$A*$c),0==$_&&0==$s||$n.translate(-$_,-$s);var $w=null;if($F||1!==$a||1!==$m||$U||$$){($w=$r._tempMt).identity(),$w.bTransform=!0;var $Q=.0174532922222222*($F-$U),$f=.0174532922222222*($F+$$),$D=Math.cos($f),$B=Math.sin($f),$i=Math.sin($Q),$k=Math.cos($Q);$w.a=$a*$D,$w.b=$a*$B,$w.c=-$m*$i,$w.d=$m*$k,$w.tx=$w.ty=0}return $w&&($n=$M.mul($n,$w,$n)),$n.translate($v[1],$v[2]),$K},$X._getTextureByUrl=function($X){return $vX.getRes($X)},$X.setAniData=function($X,$g){if($X.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$X,this._parseNodeList($X);var $K,$x={},$Z=[],$n=$X.animations,$W=0,$v=$n.length;for($W=0;$W<$v;$W++)if($K=$n[$W],this._labels=null,(!$g||$g==$K.name)&&$K){try{this._calGraphicData($K)}catch($X){console.warn("parse animation fail:"+$K.name+",empty animation created"),this._gList=[]}var $T={};$T.interval=1e3/$K.frameRate,$T.frames=this._gList,$T.labels=this._labels,$T.name=$K.name,$Z.push($T),$x[$K.name]=$T}this.animationList=$Z,this.animationDic=$x}$r._temParam.length=0},$X.parseByData=function($X){var $g,$K;$g=$X.nodeRoot,$K=$X.aniO,delete $X.nodeRoot,delete $X.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$g,this._parseNodeList($g),this._labels=null;try{this._calGraphicData($K)}catch($X){console.warn("parse animation fail:"+$K.name+",empty animation created"),this._gList=[]}var $x=$X;return $x.interval=1e3/$K.frameRate,$x.frames=this._gList,$x.labels=this._labels,$x.name=$K.name,$x},$X.setUpAniData=function($X){if($X.animations){var $g,$K={},$x=[],$Z=$X.animations,$n=0,$W=$Z.length;for($n=0;$n<$W;$n++)if($g=$Z[$n]){var $v={};$v.name=$g.name,$v.aniO=$g,$v.nodeRoot=$X,$x.push($v),$K[$g.name]=$v}this.animationList=$x,this.animationDic=$K}},$X._clear=function(){var $X,$g;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for($X in this._nodeGDic)($g=this._nodeGDic[$X])&&$g.recover();this._nodeGDic=null},$r.parseAnimationByData=function($X){var $g;return $r._I||($r._I=new $r),$g=$r._I.parseByData($X),$r._I._clear(),$g},$r.parseAnimationData=function($X){var $g;return $r._I||($r._I=new $r),$r._I.setUpAniData($X),($g={}).animationList=$r._I.animationList,$g.animationDic=$r._I.animationDic,$r._I._clear(),$g},$r._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],$r._temParam=[],$r._I=null,$r._rootMatrix=null,$T($r,["_tempMt",function(){return this._tempMt=new $M}]),$r.__init$=function(){$I=function(){function $X(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return $a($X,""),$X.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),$j.recover("GraphicNode",this)},$X.create=function(){return $j.getItemByClass("GraphicNode",$X)},$X}()},$r}($wX));$D.__init([$G,$TX,$C,$q,$h,$k,$X,$DX])}(window,document,Laya),function($X,$g,$K){$K.un,$K.uns,$K.static;var $x=$K.class;$K.getset,$K.__newvec;new(function(){function $X(){}return $x($X,"LayaMain"),$X}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($X,$g){"use strict";for(var $K in Object.defineProperty($g,"__esModule",{value:!0}),Laya){var $x=Laya[$K];$x&&$x.__isclass&&($g[$K]=$x)}}),function($X,$g,$f){$f.un,$f.uns;var $W=$f.static,$s=$f.class,$x=$f.getset,$n=$f.__newvec,$c=laya.maths.Arith,$_=laya.maths.Bezier,$K=laya.resource.Bitmap,$V=laya.utils.Browser,$T=laya.utils.Byte,$A=laya.utils.Color,$D=(laya.filters.ColorFilter,$f.Config),$Z=laya.resource.Context,$B=(laya.events.Event,laya.filters.Filter),$v=laya.display.Graphics,$G=laya.resource.HTMLCanvas,$a=(laya.utils.HTMLChar,laya.resource.HTMLImage),$m=laya.resource.HTMLSubImage,$i=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),$k=laya.maths.Point,$I=laya.maths.Rectangle,$F=laya.renders.Render,$U=(laya.renders.RenderContext,laya.renders.RenderSprite),$$=laya.resource.Resource,$w=laya.resource.ResourceManager,$Q=laya.utils.RunDriver,$r=laya.display.Sprite,$t=laya.display.Stage,$M=laya.utils.Stat,$P=laya.utils.StringKey,$N=(laya.display.css.Style,laya.system.System),$C=laya.display.Text,$Y=laya.resource.Texture,$l=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),$p=laya.utils.VectorGraphManager;laya.utils.WordText;$f.interface("laya.webgl.shapes.IShape"),$f.interface("laya.webgl.submit.ISubmit"),$f.interface("laya.webgl.text.ICharSegment"),$f.interface("laya.webgl.canvas.save.ISaveData"),$f.interface("laya.webgl.resource.IMergeAtlasBitmap"),$f.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var $L=function(){function $X(){}$s($X,"laya.filters.webgl.FilterActionGL");var $g=$X.prototype;return $f.imps($g,{"laya.filters.IFilterActionGL":!0}),$g.setValue=function($X){},$g.setValueMix=function($X){},$g.apply3d=function($X,$g,$K,$x,$Z){return null},$g.apply=function($X){return null},$x(0,$g,"typeMix",function(){return 0}),$X}(),$q=function(){function $X(){}return $s($X,"laya.webgl.shader.ShaderValue"),$X}(),$E=function(){var $x,$Z;function $X($X,$g,$K){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new $Z,void 0===$X&&($X=0),void 0===$g&&($g=0),void 0===$K&&($K=0),this._cells=null,this._rowInfo=null,this._init($X,$g),this._atlasID=$K}$s($X,"laya.webgl.atlas.AtlasGrid");var $g=$X.prototype;return $g.getAltasID=function(){return this._atlasID},$g.setAltasID=function($X){0<=$X&&(this._atlasID=$X)},$g.addTex=function($X,$g,$K){var $x=this._get($g,$K);return 0==$x.ret||(this._fill($x.x,$x.y,$g,$K,$X),this._texCount++),$x},$g._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},$g._init=function($X,$g){if(this._width=$X,this._height=$g,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=$n(this._height);for(var $K=0;$K<this._height;$K++)this._rowInfo[$K]=new $x;return this._clear(),!0},$g._get=function($X,$g){var $K=new $O;if($X>=this._failSize.width&&$g>=this._failSize.height)return $K;for(var $x=-1,$Z=-1,$n=this._width,$W=this._height,$v=this._cells,$T=0;$T<$W;$T++)if(!(this._rowInfo[$T].spaceCount<$X))for(var $G=0;$G<$n;){var $c=3*($T*$n+$G);if(0!=$v[$c]||$v[1+$c]<$X||$v[2+$c]<$g)$G+=$v[1+$c];else{$x=$G,$Z=$T;for(var $_=0;$_<$X;$_++)if($v[3*$_+$c+2]<$g){$x=-1;break}if(!($x<0))return $K.ret=!0,$K.x=$x,$K.y=$Z,$K;$G+=$v[1+$c]}}return $K},$g._fill=function($X,$g,$K,$x,$Z){var $n=this._width,$W=this._height;this._check($X+$K<=$n&&$g+$x<=$W);for(var $v=$g;$v<$x+$g;++$v){this._check(this._rowInfo[$v].spaceCount>=$K),this._rowInfo[$v].spaceCount-=$K;for(var $T=0;$T<$K;$T++){var $G=3*($X+$v*$n+$T);this._check(0==this._cells[$G]),this._cells[$G]=$Z,this._cells[1+$G]=$K,this._cells[2+$G]=$x}}if(0<$X)for($v=0;$v<$x;++$v){var $c=0;for($T=$X-1;0<=$T&&0==this._cells[3*(($g+$v)*$n+$T)];--$T,++$c);for($T=$c;0<$T;--$T)this._cells[3*(($g+$v)*$n+$X-$T)+1]=$T,this._check(0<$T)}if(0<$g)for($T=$X;$T<$X+$K;++$T){for($c=0,$v=$g-1;0<=$v&&0==this._cells[3*($T+$v*$n)];--$v,$c++);for($v=$c;0<$v;--$v)this._cells[3*($T+($g-$v)*$n)+2]=$v,this._check(0<$v)}},$g._check=function($X){0==$X&&console.log("xtexMerger 错误啦")},$g._clear=function(){for(var $X=this._texCount=0;$X<this._height;$X++)this._rowInfo[$X].spaceCount=this._width;for(var $g=0;$g<this._height;$g++)for(var $K=0;$K<this._width;$K++){var $x=3*($g*this._width+$K);this._cells[$x]=0,this._cells[1+$x]=this._width-$K,this._cells[2+$x]=this._width-$g}this._failSize.width=this._width+1,this._failSize.height=this._height+1},$X.__init$=function(){$x=function(){function $X(){this.spaceCount=0}return $s($X,""),$X}(),$Z=function(){function $X(){this.width=0,this.height=0}return $s($X,""),$X}()},$X}(),$u=function(){function $F($X,$g,$K,$x){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=$X,this._height=$g,this._gridSize=$K,this._maxAtlaserCount=$x,this._gridNumX=$X/$K,this._gridNumY=$g/$K,this._curAtlasIndex=0,this._atlaserArray=[]}$s($F,"laya.webgl.atlas.AtlasResourceManager");var $X=$F.prototype;return $X.setAtlasParam=function($X,$g,$K,$x){if(1==this._setAtlasParam)return $F._sid_=0,this._width=$X,this._height=$g,this._gridSize=$K,this._maxAtlaserCount=$x,this._gridNumX=$X/$K,this._gridNumY=$g/$K,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},$X.pushData=function($X){var $g,$K=$X.bitmap,$x=-1,$Z=null,$n=0,$W=0;for($n=0,$g=this._atlaserArray.length;$n<$g&&($W=(this._curAtlasIndex+$n)%$g,-1==($x=($Z=this._atlaserArray[$W]).findBitmapIsExist($K)));$n++);if(-1!=$x){var $v=$Z.InAtlasWebGLImagesOffsetValue[$x];return $A=$v[0],$a=$v[1],$Z.addToAtlas($X,$A,$a),!0}this._setAtlasParam=!1;for(var $T=Math.ceil(($X.bitmap.width+2)/this._gridSize),$G=Math.ceil(($X.bitmap.height+2)/this._gridSize),$c=!1,$_=0;$_<2;$_++){var $s=this._maxAtlaserCount;for($n=0;$n<$s;$n++){$W=(this._curAtlasIndex+$n)%$s,this._atlaserArray.length-1>=$W||this._atlaserArray.push(new $IX(this._gridNumX,this._gridNumY,this._width,this._height,$F._sid_++));var $V=this._atlaserArray[$W],$A=0,$a=0,$m=$V.addTex(1,$T,$G);if($m.ret){$A=$m.x*this._gridSize+1,$a=$m.y*this._gridSize+1,$K.lock=!0,$V.addToAtlasTexture($K,$A,$a),$V.addToAtlas($X,$A,$a),$c=!0,this._curAtlasIndex=$W;break}}if($c)break;this._atlaserArray.push(new $IX(this._gridNumX,this._gridNumY,this._width,this._height,$F._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return $c||console.log(">>>AtlasManager pushData error"),$c},$X.addToAtlas=function($X){laya.webgl.atlas.AtlasResourceManager.instance.pushData($X)},$X.garbageCollection=function(){if(!0===this._needGC){for(var $X=this._atlaserArray.length-this._maxAtlaserCount,$g=0;$g<$X;$g++)this._atlaserArray[$g].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+$X),this._atlaserArray.splice(0,$X),this._needGC=!1}return!0},$X.freeAll=function(){for(var $X=0,$g=this._atlaserArray.length;$X<$g;$X++)this._atlaserArray[$X].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},$X.getAtlaserCount=function(){return this._atlaserArray.length},$X.getAtlaserByIndex=function($X){return this._atlaserArray[$X]},$x(1,$F,"instance",function(){return $F._Instance||($F._Instance=new $F(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),$F._Instance}),$x(1,$F,"enabled",function(){return $D.atlasEnable}),$x(1,$F,"atlasLimitWidth",function(){return $F._atlasLimitWidth},function($X){$F._atlasLimitWidth=$X}),$x(1,$F,"atlasLimitHeight",function(){return $F._atlasLimitHeight},function($X){$F._atlasLimitHeight=$X}),$F._enable=function(){$D.atlasEnable=!0},$F._disable=function(){$D.atlasEnable=!1},$F.__init__=function(){$F.atlasTextureWidth=2048,$F.atlasTextureHeight=2048,$F.maxTextureCount=6,$F.atlasLimitWidth=512,$F.atlasLimitHeight=512},$F._atlasLimitWidth=0,$F._atlasLimitHeight=0,$F.gridSize=16,$F.atlasTextureWidth=0,$F.atlasTextureHeight=0,$F.maxTextureCount=0,$F._atlasRestore=0,$F.BOARDER_TYPE_NO=0,$F.BOARDER_TYPE_RIGHT=1,$F.BOARDER_TYPE_LEFT=2,$F.BOARDER_TYPE_BOTTOM=4,$F.BOARDER_TYPE_TOP=8,$F.BOARDER_TYPE_ALL=15,$F._sid_=0,$F._Instance=null,$F}(),$O=function(){function $X(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return $s($X,"laya.webgl.atlas.MergeFillInfo"),$X}(),$e=function(){function $g(){}return $s($g,"laya.webgl.canvas.BlendMode"),$g._init_=function($X){$g.fns=[$g.BlendNormal,$g.BlendAdd,$g.BlendMultiply,$g.BlendScreen,$g.BlendOverlay,$g.BlendLight,$g.BlendMask,$g.BlendDestinationOut],$g.targetFns=[$g.BlendNormalTarget,$g.BlendAddTarget,$g.BlendMultiplyTarget,$g.BlendScreenTarget,$g.BlendOverlayTarget,$g.BlendLightTarget,$g.BlendMask,$g.BlendDestinationOut]},$g.BlendNormal=function($X){$X.blendFunc(1,771)},$g.BlendAdd=function($X){$X.blendFunc(1,772)},$g.BlendMultiply=function($X){$X.blendFunc(774,771)},$g.BlendScreen=function($X){$X.blendFunc(1,1)},$g.BlendOverlay=function($X){$X.blendFunc(1,769)},$g.BlendLight=function($X){$X.blendFunc(1,1)},$g.BlendNormalTarget=function($X){$X.blendFunc(1,771)},$g.BlendAddTarget=function($X){$X.blendFunc(1,772)},$g.BlendMultiplyTarget=function($X){$X.blendFunc(774,771)},$g.BlendScreenTarget=function($X){$X.blendFunc(1,1)},$g.BlendOverlayTarget=function($X){$X.blendFunc(1,769)},$g.BlendLightTarget=function($X){$X.blendFunc(1,1)},$g.BlendMask=function($X){$X.blendFunc(0,770)},$g.BlendDestinationOut=function($X){$X.blendFunc(0,0)},$g.activeBlendFunction=null,$g.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],$g.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},$g.NORMAL="normal",$g.ADD="add",$g.MULTIPLY="multiply",$g.SCREEN="screen",$g.LIGHT="light",$g.OVERLAY="overlay",$g.DESTINATIONOUT="destination-out",$g.fns=[],$g.targetFns=[],$g}(),$b=function(){function $K($X){this._color=$A.create("black"),this.setValue($X)}$s($K,"laya.webgl.canvas.DrawStyle");var $X=$K.prototype;return $X.setValue=function($X){if($X){if("string"==typeof $X)return void(this._color=$A.create($X));if($X instanceof laya.utils.Color)return void(this._color=$X)}},$X.reset=function(){this._color=$A.create("black")},$X.equal=function($X){return"string"==typeof $X?this._color.strColor===$X:$X instanceof laya.utils.Color&&this._color.numColor===$X.numColor},$X.toColorStr=function(){return this._color.strColor},$K.create=function($X){var $g;if($X&&("string"==typeof $X?$g=$A.create($X):$X instanceof laya.utils.Color&&($g=$X),$g))return $g._drawStyle||($g._drawStyle=new $K($X));return laya.webgl.canvas.DrawStyle.DEFAULT},$W($K,["DEFAULT",function(){return this.DEFAULT=new $K("#000000")}]),$K}(),$S=function(){function $X(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];$wX.mainContext;this.ib=$HX.create(35048),this.vb=$yX.create(5)}$s($X,"laya.webgl.canvas.Path");var $g=$X.prototype;return $g.addPoint=function($X,$g){this.tempArray.push($X,$g)},$g.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},$g.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},$g.polygon=function($X,$g,$K,$x,$Z,$n){var $W;return this.geomatrys.push(this._curGeomatry=$W=new $PX($X,$g,$K,$x,$Z,$n)),$x||($W.fill=!1),null==$n&&($W.borderWidth=0),$W},$g.setGeomtry=function($X){this.geomatrys.push(this._curGeomatry=$X)},$g.drawLine=function($X,$g,$K,$x,$Z){var $n;return this.closePath?this.geomatrys.push(this._curGeomatry=$n=new $MX($X,$g,$K,$x,$Z)):this.geomatrys.push(this._curGeomatry=$n=new $tX($X,$g,$K,$x,$Z)),$n.fill=!1,$n},$g.update=function(){var $X=this.ib._byteLength,$g=this.geomatrys.length;this.offset=$X;for(var $K=this.geoStart;$K<$g;$K++)this.geomatrys[$K].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=$g,this.count=(this.ib._byteLength-$X)/$aX.BYTES_PIDX},$g.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},$g.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},$X}(),$R=function(){function $v(){}$s($v,"laya.webgl.canvas.save.SaveBase");var $X=$v.prototype;return $f.imps($X,{"laya.webgl.canvas.save.ISaveData":!0}),$X.isSaveMark=function(){return!1},$X.restore=function($X){this._dataObj[this._valueName]=this._value,($v._cache[$v._cache._length++]=this)._newSubmit&&($X._curSubmit=$nX.RENDERBASE,$X._renderKey=0)},$v._createArray=function(){var $X=[];return $X._length=0,$X},$v._init=function(){var $X=$v._namemap={};return $X[1]="ALPHA",$X[2]="fillStyle",$X[8]="font",$X[256]="lineWidth",$X[512]="strokeStyle",$X[8192]="_mergeID",$X[1024]=$X[2048]=$X[4096]=[],$X[16384]="textBaseline",$X[32768]="textAlign",$X[65536]="_nBlendType",$X[1048576]="shader",$X[2097152]="filters",$X},$v.save=function($X,$g,$K,$x){if(($X._saveMark._saveuse&$g)!==$g){$X._saveMark._saveuse|=$g;var $Z=$v._cache,$n=0<$Z._length?$Z[--$Z._length]:new $v;$n._value=$K[$n._valueName=$v._namemap[$g]],$n._dataObj=$K,$n._newSubmit=$x;var $W=$X._save;$W[$W._length++]=$n}},$v._cache=laya.webgl.canvas.save.SaveBase._createArray(),$v._namemap=$v._init(),$v}(),$j=function(){function $n(){this._clipRect=new $I}$s($n,"laya.webgl.canvas.save.SaveClipRect");var $X=$n.prototype;return $f.imps($X,{"laya.webgl.canvas.save.ISaveData":!0}),$X.isSaveMark=function(){return!1},$X.restore=function($X){$X._clipRect=this._clipSaveRect,($n._cache[$n._cache._length++]=this)._submitScissor.submitLength=$X._submits._length-this._submitScissor.submitIndex,$X._curSubmit=$nX.RENDERBASE,$X._renderKey=0},$n.save=function($X,$g){if(131072!=(131072&$X._saveMark._saveuse)){$X._saveMark._saveuse|=131072;var $K=$n._cache,$x=0<$K._length?$K[--$K._length]:new $n;$x._clipSaveRect=$X._clipRect,$X._clipRect=$x._clipRect.copyFrom($X._clipRect),$x._submitScissor=$g;var $Z=$X._save;$Z[$Z._length++]=$x}},$W($n,["_cache",function(){return this._cache=$R._createArray()}]),$n}(),$d=function(){function $V(){this._contextX=0,this._contextY=0,this._clipRect=new $I,this._rect=new $I,this._matrix=new $i}$s($V,"laya.webgl.canvas.save.SaveClipRectStencil");var $X=$V.prototype;return $f.imps($X,{"laya.webgl.canvas.save.ISaveData":!0}),$X.isSaveMark=function(){return!1},$X.restore=function($X){$cX.restore($X,this._rect,this._saveMatrix,this._contextX,this._contextY),$X._clipRect=this._clipSaveRect,$X._curMat=this._saveMatrix,$X._x=this._contextX,$X._y=this._contextY,$V._cache[$V._cache._length++]=this,$X._curSubmit=$nX.RENDERBASE},$V.save=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){if(262144!=(262144&$X._saveMark._saveuse)){$X._saveMark._saveuse|=262144;var $c=$V._cache,$_=0<$c._length?$c[--$c._length]:new $V;$_._clipSaveRect=$X._clipRect,$_._clipRect.setTo($W,$v,$T,$G),$X._clipRect=$_._clipRect,$_._rect.x=$K,$_._rect.y=$x,$_._rect.width=$Z,$_._rect.height=$n,$_._contextX=$X._x,$_._contextY=$X._y,$_._saveMatrix=$X._curMat,$X._curMat.copyTo($_._matrix),$X._curMat=$_._matrix,$_._submitStencil=$g;var $s=$X._save;$s[$s._length++]=$_}},$W($V,["_cache",function(){return this._cache=$R._createArray()}]),$V}(),$h=function(){function $x(){this._saveuse=0}$s($x,"laya.webgl.canvas.save.SaveMark");var $X=$x.prototype;return $f.imps($X,{"laya.webgl.canvas.save.ISaveData":!0}),$X.isSaveMark=function(){return!0},$X.restore=function($X){$X._saveMark=this._preSaveMark,$x._no[$x._no._length++]=this},$x.Create=function($X){var $g=$x._no,$K=0<$g._length?$g[--$g._length]:new $x;return $K._saveuse=0,$K._preSaveMark=$X._saveMark,$X._saveMark=$K},$W($x,["_no",function(){return this._no=$R._createArray()}]),$x}(),$z=function(){function $n(){this._matrix=new $i}$s($n,"laya.webgl.canvas.save.SaveTransform");var $X=$n.prototype;return $f.imps($X,{"laya.webgl.canvas.save.ISaveData":!0}),$X.isSaveMark=function(){return!1},$X.restore=function($X){$X._curMat=this._savematrix,$n._no[$n._no._length++]=this},$n.save=function($X){var $g=$X._saveMark;if(2048!=(2048&$g._saveuse)){$g._saveuse|=2048;var $K=$n._no,$x=0<$K._length?$K[--$K._length]:new $n;$x._savematrix=$X._curMat,$X._curMat=$X._curMat.copyTo($x._matrix);var $Z=$X._save;$Z[$Z._length++]=$x}},$W($n,["_no",function(){return this._no=$R._createArray()}]),$n}(),$J=function(){function $Z(){}$s($Z,"laya.webgl.canvas.save.SaveTranslate");var $X=$Z.prototype;return $f.imps($X,{"laya.webgl.canvas.save.ISaveData":!0}),$X.isSaveMark=function(){return!1},$X.restore=function($X){$X._curMat;$X._x=this._x,$X._y=this._y,$Z._no[$Z._no._length++]=this},$Z.save=function($X){var $g=$Z._no,$K=0<$g._length?$g[--$g._length]:new $Z;$K._x=$X._x,$K._y=$X._y;var $x=$X._save;$x[$x._length++]=$K},$W($Z,["_no",function(){return this._no=$R._createArray()}]),$Z}(),$o=function(){function $X(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new $I}$s($X,"laya.webgl.resource.RenderTargetMAX");var $g=$X.prototype;return $g.setSP=function($X){this._sp=$X},$g.size=function($X,$g){var $K=this;this._width!==$X||this._height!==$g?(this.repaint=!0,this._width=$X,this._height=$g,this.target?this.target.size($X,$g):this.target=$pX.create($X,$g),this.target.hasListener("recovered")||this.target.on("recovered",this,function($X){$f.timer.callLater($K._sp,$K._sp.repaint)})):this.target.size($X,$g)},$g._flushToTarget=function($X,$g){if(!$g._destroy){var $K=$UX.worldScissorTest,$x=$UX.worldClipRect;$UX.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,$UX.worldScissorTest=!1,$wX.mainContext.disable(3089);var $Z=$UX.worldAlpha,$n=$UX.worldMatrix4,$W=$UX.worldMatrix,$v=$UX.worldFilters,$T=$UX.worldShaderDefines;if($UX.worldMatrix=$i.EMPTY,$UX.restoreTempArray(),$UX.worldMatrix4=$UX.TEMPMAT4_ARRAY,$UX.worldAlpha=1,$UX.worldFilters=null,$UX.worldShaderDefines=null,$lX.activeShader=null,$g.start(),$D.showCanvasMark?$g.clear(0,1,0,.3):$g.clear(0,0,0,0),$X.flush(),$g.end(),$lX.activeShader=null,$UX.worldAlpha=$Z,$UX.worldMatrix4=$n,$UX.worldMatrix=$W,$UX.worldFilters=$v,$UX.worldShaderDefines=$T,$UX.worldScissorTest=$K){var $G=$UX.height-$x.y-$x.height;$wX.mainContext.scissor($x.x,$G,$x.width,$x.height),$wX.mainContext.enable(3089)}$UX.worldClipRect=$x}},$g.flush=function($X){this.repaint&&(this._flushToTarget($X,this.target),this.repaint=!1)},$g.drawTo=function($X,$g,$K,$x,$Z){$X.drawTexture(this.target.getTexture(),$g,$K,$x,$Z,0,0)},$g.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},$X}(),$H=function(){function $X(){this.ALPHA=1,this.shaderType=0,this.defines=new $rX}return $s($X,"laya.webgl.shader.d2.Shader2D"),$X.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},$X.__init__=function(){var $X,$g;$hX.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),$hX.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),$hX.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),$hX.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),$hX.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),$hX.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),$hX.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),$hX.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),$X="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$g='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$hX.preCompile2D(0,1,$X,$g,null),$X="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",$g='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',$hX.preCompile2D(0,2,$X,$g,null),$X="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",$g="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",$hX.preCompile2D(0,4,$X,$g,null),$X="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$g='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$hX.preCompile2D(0,256,$X,$g,null),$X="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",$g="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",$hX.preCompile2D(0,512,$X,$g,null)},$X}(),$y=function(){function $g($X,$g,$K){this._value=0,this._name2int=$X,this._int2name=$g,this._int2nameMap=$K}$s($g,"laya.webgl.shader.ShaderDefines");var $X=$g.prototype;return $X.add=function($X){return"string"==typeof $X&&($X=this._name2int[$X]),this._value|=$X,this._value},$X.addInt=function($X){return this._value|=$X,this._value},$X.remove=function($X){return"string"==typeof $X&&($X=this._name2int[$X]),this._value&=~$X,this._value},$X.isDefine=function($X){return(this._value&$X)===$X},$X.getValue=function(){return this._value},$X.setValue=function($X){this._value=$X},$X.toNameDic=function(){var $X=this._int2nameMap[this._value];return $X||$g._toText(this._value,this._int2name,this._int2nameMap)},$g._reg=function($X,$g,$K,$x){$x[$K[$X]=$g]=$X},$g._toText=function($X,$g,$K){var $x=$K[$X];if($x)return $x;for(var $Z={},$n=1,$W=0;$W<32&&!($X<($n=1<<$W));$W++)if($X&$n){var $v=$g[$n];$v&&($Z[$v]="")}return $K[$X]=$Z},$g._toInt=function($X,$g){for(var $K=$X.split("."),$x=0,$Z=0,$n=$K.length;$Z<$n;$Z++){var $W=$g[$K[$Z]];if(!$W)throw new Error("Defines to int err:"+$X+"/"+$K[$Z]);$x|=$W}return $x},$g}(),$XX=function(){function $W(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new $i}$s($W,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var $X=$W.prototype;return $X.init=function($X,$g,$K){if($g)this._vs=$g;else{this._vs=[];var $x=$X.width,$Z=$X.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push($x,0,1,0,1,1,1,1),this._vs.push($x,$Z,1,1,1,1,1,1),this._vs.push(0,$Z,0,1,1,1,1,1)}$K?this._ps=$K:($W._defaultPS||($W._defaultPS=[]).push(0,1,3,3,1,2),this._ps=$W._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=$X},$X.init2=function($X,$g,$K,$x,$Z){this.transform&&(this.transform=null),$K?this._ps=$K:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=$x,this._uvs=$Z,this.mEleNum=this._ps.length,this.mTexture=$X,($F.isConchNode||$F.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},$X._initMyData=function(){var $X=0,$g=0,$K=4*this._verticles.length;this._vs=$W._tempVS;var $x=!1;if($F.isConchNode||$F.isConchApp?(this._vs.length=$K,$x=!0):this._vs.length<$K&&(this._vs.length=$K,$x=!0),$W._tVSLen=$K,$x)for(;$X<$K;)this._vs[$X]=this._verticles[$g],this._vs[$X+1]=this._verticles[$g+1],this._vs[$X+2]=this._uvs[$g],this._vs[$X+3]=this._uvs[$g+1],this._vs[$X+4]=1,this._vs[$X+5]=1,this._vs[$X+6]=1,this._vs[$X+7]=1,$X+=8,$g+=2;else for(;$X<$K;)this._vs[$X]=this._verticles[$g],this._vs[$X+1]=this._verticles[$g+1],this._vs[$X+2]=this._uvs[$g],this._vs[$X+3]=this._uvs[$g+1],$X+=8,$g+=2},$X.getData2=function($X,$g,$K){var $x;this.mVBBuffer=$X,this.mIBBuffer=$g,this._initMyData(),$X.appendEx2(this._vs,Float32Array,$W._tVSLen,4),this._indexStart=$g._byteLength,($x=$W._tempIB).length<this._ps.length&&($x.length=this._ps.length);for(var $Z=0,$n=this._ps.length;$Z<$n;$Z++)$x[$Z]=this._ps[$Z]+$K;$g.appendEx2($x,Uint16Array,this._ps.length,2)},$X.getData=function($X,$g,$K){if(this.mVBBuffer=$X,this.mIBBuffer=$g,$X.append(this.mVBData),this._indexStart=$g._byteLength,this.mIBData.start!=$K){for(var $x=0,$Z=this._ps.length;$x<$Z;$x++)this.mIBData[$x]=this._ps[$x]+$K;this.mIBData.start=$K}$g.append(this.mIBData)},$X.render=function($X,$g,$K){if($F.isWebGL&&this.mTexture){$X._renderKey=0,$X._shader2D.glTexture=null,$gX.getInstance().addSkinMesh(this);var $x=$nX.createShape($X,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,$BX.create(512,0));this.transform||(this.transform=$i.EMPTY),this.transform.translate($g,$K),$i.mul(this.transform,$X._curMat,this._tempMatrix),this.transform.translate(-$g,-$K);var $Z=$x.shaderValue,$n=$Z.u_mmat2||$UX.getMatrArray();$UX.mat2MatArray(this._tempMatrix,$n),$Z.textureHost=this.mTexture,$Z.offsetX=0,$Z.offsetY=0,$Z.u_mmat2=$n,$Z.ALPHA=$X._shader2D.ALPHA,$X._submits[$X._submits._length++]=$x}else $F.isConchApp&&this.mTexture&&(this.transform||(this.transform=$i.EMPTY),$X.setSkinMesh&&$X.setSkinMesh($g,$K,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},$W._tempVS=[],$W._tempIB=[],$W._defaultPS=null,$W._tVSLen=0,$W}(),$gX=function(){function $X(){this.ib=null,this.vb=null;$wX.mainContext;this.ib=$HX.create(35048),this.vb=$yX.create(8)}$s($X,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var $g=$X.prototype;return $g.addSkinMesh=function($X){$X.getData2(this.vb,this.ib,this.vb._byteLength/32)},$g.reset=function(){this.vb.clear(),this.ib.clear()},$X.getInstance=function(){return $X.instance=$X.instance||new $X},$X.instance=null,$X}(),$KX=function(){function $X($X,$g,$K,$x,$Z,$n,$W,$v,$T){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===$T&&($T=0),this.x=$X,this.y=$g,this.width=$K,this.height=$x,this.edges=$Z,this.color=$n,this.borderWidth=$W,this.borderColor=$v}$s($X,"laya.webgl.shapes.BasePoly");var $g=$X.prototype;return $f.imps($g,{"laya.webgl.shapes.IShape":!0}),$g.getData=function($X,$g,$K){},$g.rebuild=function($X){},$g.setMatrix=function($X){},$g.needUpdate=function($X){return!0},$g.sector=function($X,$g,$K){var $x=this.x,$Z=this.y,$n=this.edges,$W=(this.r1-this.r0)/$n,$v=this.width,$T=this.height,$G=this.color,$c=($G>>16&255)/255,$_=($G>>8&255)/255,$s=(255&$G)/255;$X.push($x,$Z,$c,$_,$s);for(var $V=0;$V<$n+1;$V++)$X.push($x+Math.sin($W*$V+this.r0)*$v,$Z+Math.cos($W*$V+this.r0)*$T),$X.push($c,$_,$s);for($V=0;$V<$n;$V++)$g.push($K,$K+$V+1,$K+$V+2)},$g.createLine2=function($X,$g,$K,$x,$Z,$n){var $W,$v,$T,$G,$c,$_,$s,$V,$A,$a,$m,$F,$U,$$,$w,$Q,$f,$D,$B,$i,$k=$X.concat(),$I=$Z,$r=this.borderColor,$t=($r>>16&255)/255,$M=($r>>8&255)/255,$P=(255&$r)/255,$N=$k.length/2,$C=$x,$Y=$K/2;$T=$k[0],$G=$k[1],$a=$T-($c=$k[2]),$A=($A=-($G-($_=$k[3])))/($i=Math.sqrt($A*$A+$a*$a))*$Y,$a=$a/$i*$Y,$I.push($T-$A+this.x,$G-$a+this.y,$t,$M,$P,$T+$A+this.x,$G+$a+this.y,$t,$M,$P);for(var $l=1;$l<$N-1;$l++)$T=$k[2*($l-1)],$G=$k[2*($l-1)+1],$c=$k[2*$l],$_=$k[2*$l+1],$s=$k[2*($l+1)],$V=$k[2*($l+1)+1],$a=$T-$c,$F=$c-$s,$w=(-($A=($A=-($G-$_))/($i=Math.sqrt($A*$A+$a*$a))*$Y)+$T)*(-($a=$a/$i*$Y)+$_)-(-$A+$c)*(-$a+$G),$D=(-($m=($m=-($_-$V))/($i=Math.sqrt($m*$m+$F*$F))*$Y)+$s)*(-($F=$F/$i*$Y)+$_)-(-$m+$c)*(-$F+$V),$B=($U=-$a+$G-(-$a+$_))*($f=-$m+$c-(-$m+$s))-($Q=-$F+$V-(-$F+$_))*($$=-$A+$c-(-$A+$T)),Math.abs($B)<.1?($B+=10.1,$I.push($c-$A+this.x,$_-$a+this.y,$t,$M,$P,$c+$A+this.x,$_+$a+this.y,$t,$M,$P)):((($W=($$*$D-$f*$w)/$B)-$c)*($W-$c)+(($v=($Q*$w-$U*$D)/$B)-$_)+($v-$_),$I.push($W+this.x,$v+this.y,$t,$M,$P,$c-($W-$c)+this.x,$_-($v-$_)+this.y,$t,$M,$P));$T=$k[$k.length-4],$G=$k[$k.length-3],$a=$T-($c=$k[$k.length-2]),$A=($A=-($G-($_=$k[$k.length-1])))/($i=Math.sqrt($A*$A+$a*$a))*$Y,$a=$a/$i*$Y,$I.push($c-$A+this.x,$_-$a+this.y,$t,$M,$P,$c+$A+this.x,$_+$a+this.y,$t,$M,$P);var $p=$n;for($l=1;$l<$p;$l++)$g.push($C+2*($l-1),$C+2*($l-1)+1,$C+2*$l+1,$C+2*$l+1,$C+2*$l,$C+2*($l-1));return $I},$g.createLine=function($X,$g,$K,$x){var $Z=$X.concat(),$n=$X,$W=this.borderColor,$v=($W>>16&255)/255,$T=($W>>8&255)/255,$G=(255&$W)/255;$Z.splice(0,5);var $c,$_,$s,$V,$A,$a,$m,$F,$U,$$,$w,$Q,$f,$D,$B,$i,$k,$I,$r,$t,$M=$Z.length/5,$P=$x,$N=$K/2;$s=$Z[0],$V=$Z[1],$$=$s-($A=$Z[5]),$U=($U=-($V-($a=$Z[6])))/($t=Math.sqrt($U*$U+$$*$$))*$N,$$=$$/$t*$N,$n.push($s-$U,$V-$$,$v,$T,$G,$s+$U,$V+$$,$v,$T,$G);for(var $C=1;$C<$M-1;$C++)$s=$Z[5*($C-1)],$V=$Z[5*($C-1)+1],$A=$Z[5*$C],$a=$Z[5*$C+1],$m=$Z[5*($C+1)],$F=$Z[5*($C+1)+1],$$=$s-$A,$Q=$A-$m,$B=(-($U=($U=-($V-$a))/($t=Math.sqrt($U*$U+$$*$$))*$N)+$s)*(-($$=$$/$t*$N)+$a)-(-$U+$A)*(-$$+$V),$I=(-($w=($w=-($a-$F))/($t=Math.sqrt($w*$w+$Q*$Q))*$N)+$m)*(-($Q=$Q/$t*$N)+$a)-(-$w+$A)*(-$Q+$F),$r=($f=-$$+$V-(-$$+$a))*($k=-$w+$A-(-$w+$m))-($i=-$Q+$F-(-$Q+$a))*($D=-$U+$A-(-$U+$s)),Math.abs($r)<.1?($r+=10.1,$n.push($A-$U,$a-$$,$v,$T,$G,$A+$U,$a+$$,$v,$T,$G)):((($c=($D*$I-$k*$B)/$r)-$A)*($c-$A)+(($_=($i*$B-$f*$I)/$r)-$a)+($_-$a),$n.push($c,$_,$v,$T,$G,$A-($c-$A),$a-($_-$a),$v,$T,$G));$s=$Z[$Z.length-10],$V=$Z[$Z.length-9],$$=$s-($A=$Z[$Z.length-5]),$U=($U=-($V-($a=$Z[$Z.length-4])))/($t=Math.sqrt($U*$U+$$*$$))*$N,$$=$$/$t*$N,$n.push($A-$U,$a-$$,$v,$T,$G,$A+$U,$a+$$,$v,$T,$G);var $Y=this.edges+1;for($C=1;$C<$Y;$C++)$g.push($P+2*($C-1),$P+2*($C-1)+1,$P+2*$C+1,$P+2*$C+1,$P+2*$C,$P+2*($C-1));return $n},$g.createLoopLine=function($X,$g,$K,$x,$Z,$n){var $W=$X.concat(),$v=$Z||$X,$T=this.borderColor,$G=($T>>16&255)/255,$c=($T>>8&255)/255,$_=(255&$T)/255;$W.splice(0,5);var $s=[$W[0],$W[1]],$V=[$W[$W.length-5],$W[$W.length-4]],$A=$V[0]+.5*($s[0]-$V[0]),$a=$V[1]+.5*($s[1]-$V[1]);$W.unshift($A,$a,0,0,0),$W.push($A,$a,0,0,0);var $m,$F,$U,$$,$w,$Q,$f,$D,$B,$i,$k,$I,$r,$t,$M,$P,$N,$C,$Y,$l,$p=$W.length/5,$L=$x,$q=$K/2;$U=$W[0],$$=$W[1],$i=$U-($w=$W[5]),$B=($B=-($$-($Q=$W[6])))/($l=Math.sqrt($B*$B+$i*$i))*$q,$i=$i/$l*$q,$v.push($U-$B,$$-$i,$G,$c,$_,$U+$B,$$+$i,$G,$c,$_);for(var $E=1;$E<$p-1;$E++)$U=$W[5*($E-1)],$$=$W[5*($E-1)+1],$w=$W[5*$E],$Q=$W[5*$E+1],$f=$W[5*($E+1)],$D=$W[5*($E+1)+1],$i=$U-$w,$I=$w-$f,$M=(-($B=($B=-($$-$Q))/($l=Math.sqrt($B*$B+$i*$i))*$q)+$U)*(-($i=$i/$l*$q)+$Q)-(-$B+$w)*(-$i+$$),$C=(-($k=($k=-($Q-$D))/($l=Math.sqrt($k*$k+$I*$I))*$q)+$f)*(-($I=$I/$l*$q)+$Q)-(-$k+$w)*(-$I+$D),$Y=($r=-$i+$$-(-$i+$Q))*($N=-$k+$w-(-$k+$f))-($P=-$I+$D-(-$I+$Q))*($t=-$B+$w-(-$B+$U)),Math.abs($Y)<.1?($Y+=10.1,$v.push($w-$B,$Q-$i,$G,$c,$_,$w+$B,$Q+$i,$G,$c,$_)):((($m=($t*$C-$N*$M)/$Y)-$w)*($m-$w)+(($F=($P*$M-$r*$C)/$Y)-$Q)+($F-$Q),$v.push($m,$F,$G,$c,$_,$w-($m-$w),$Q-($F-$Q),$G,$c,$_));$n&&($g=$n);var $u=this.edges+1;for($E=1;$E<$u;$E++)$g.push($L+2*($E-1),$L+2*($E-1)+1,$L+2*$E+1,$L+2*$E+1,$L+2*$E,$L+2*($E-1));return $g.push($L+2*($E-1),$L+2*($E-1)+1,$L+1,$L+1,$L,$L+2*($E-1)),$v},$X}(),$xX=function(){function $a(){}return $s($a,"laya.webgl.shapes.Earcut"),$a.earcut=function($X,$g,$K){$K=$K||2;var $x,$Z,$n,$W,$v,$T,$G,$c=$g&&$g.length,$_=$c?$g[0]*$K:$X.length,$s=$a.linkedList($X,0,$_,$K,!0),$V=[];if(!$s)return $V;if($c&&($s=$a.eliminateHoles($X,$g,$s,$K)),$X.length>80*$K){$x=$n=$X[0],$Z=$W=$X[1];for(var $A=$K;$A<$_;$A+=$K)($v=$X[$A])<$x&&($x=$v),($T=$X[$A+1])<$Z&&($Z=$T),$n<$v&&($n=$v),$W<$T&&($W=$T);$G=0!==($G=Math.max($n-$x,$W-$Z))?1/$G:0}return $a.earcutLinked($s,$V,$K,$x,$Z,$G),$V},$a.linkedList=function($X,$g,$K,$x,$Z){var $n,$W;if($Z===0<$a.signedArea($X,$g,$K,$x))for($n=$g;$n<$K;$n+=$x)$W=$a.insertNode($n,$X[$n],$X[$n+1],$W);else for($n=$K-$x;$g<=$n;$n-=$x)$W=$a.insertNode($n,$X[$n],$X[$n+1],$W);return $W&&$a.equals($W,$W.next)&&($a.removeNode($W),$W=$W.next),$W},$a.filterPoints=function($X,$g){if(!$X)return $X;$g||($g=$X);var $K,$x=$X;do{if($K=!1,$x.steiner||!$a.equals($x,$x.next)&&0!==$a.area($x.prev,$x,$x.next))$x=$x.next;else{if($a.removeNode($x),($x=$g=$x.prev)===$x.next)break;$K=!0}}while($K||$x!==$g);return $g},$a.earcutLinked=function($X,$g,$K,$x,$Z,$n,$W){if($X){!$W&&$n&&$a.indexCurve($X,$x,$Z,$n);for(var $v,$T,$G=$X;$X.prev!==$X.next;)if($v=$X.prev,$T=$X.next,$n?$a.isEarHashed($X,$x,$Z,$n):$a.isEar($X))$g.push($v.i/$K),$g.push($X.i/$K),$g.push($T.i/$K),$a.removeNode($X),$X=$T.next,$G=$T.next;else if(($X=$T)===$G){$W?1===$W?($X=$a.cureLocalIntersections($X,$g,$K),$a.earcutLinked($X,$g,$K,$x,$Z,$n,2)):2===$W&&$a.splitEarcut($X,$g,$K,$x,$Z,$n):$a.earcutLinked($a.filterPoints($X,null),$g,$K,$x,$Z,$n,1);break}}},$a.isEar=function($X){var $g=$X.prev,$K=$X,$x=$X.next;if(0<=$a.area($g,$K,$x))return!1;for(var $Z=$X.next.next;$Z!==$X.prev;){if($a.pointInTriangle($g.x,$g.y,$K.x,$K.y,$x.x,$x.y,$Z.x,$Z.y)&&0<=$a.area($Z.prev,$Z,$Z.next))return!1;$Z=$Z.next}return!0},$a.isEarHashed=function($X,$g,$K,$x){var $Z=$X.prev,$n=$X,$W=$X.next;if(0<=$a.area($Z,$n,$W))return!1;for(var $v=$Z.x<$n.x?$Z.x<$W.x?$Z.x:$W.x:$n.x<$W.x?$n.x:$W.x,$T=$Z.y<$n.y?$Z.y<$W.y?$Z.y:$W.y:$n.y<$W.y?$n.y:$W.y,$G=$Z.x>$n.x?$Z.x>$W.x?$Z.x:$W.x:$n.x>$W.x?$n.x:$W.x,$c=$Z.y>$n.y?$Z.y>$W.y?$Z.y:$W.y:$n.y>$W.y?$n.y:$W.y,$_=$a.zOrder($v,$T,$g,$K,$x),$s=$a.zOrder($G,$c,$g,$K,$x),$V=$X.nextZ;$V&&$V.z<=$s;){if($V!==$X.prev&&$V!==$X.next&&$a.pointInTriangle($Z.x,$Z.y,$n.x,$n.y,$W.x,$W.y,$V.x,$V.y)&&0<=$a.area($V.prev,$V,$V.next))return!1;$V=$V.nextZ}for($V=$X.prevZ;$V&&$V.z>=$_;){if($V!==$X.prev&&$V!==$X.next&&$a.pointInTriangle($Z.x,$Z.y,$n.x,$n.y,$W.x,$W.y,$V.x,$V.y)&&0<=$a.area($V.prev,$V,$V.next))return!1;$V=$V.prevZ}return!0},$a.cureLocalIntersections=function($X,$g,$K){var $x=$X;do{var $Z=$x.prev,$n=$x.next.next;!$a.equals($Z,$n)&&$a.intersects($Z,$x,$x.next,$n)&&$a.locallyInside($Z,$n)&&$a.locallyInside($n,$Z)&&($g.push($Z.i/$K),$g.push($x.i/$K),$g.push($n.i/$K),$a.removeNode($x),$a.removeNode($x.next),$x=$X=$n),$x=$x.next}while($x!==$X);return $x},$a.splitEarcut=function($X,$g,$K,$x,$Z,$n){var $W=$X;do{for(var $v=$W.next.next;$v!==$W.prev;){if($W.i!==$v.i&&$a.isValidDiagonal($W,$v)){var $T=$a.splitPolygon($W,$v);return $W=$a.filterPoints($W,$W.next),$T=$a.filterPoints($T,$T.next),$a.earcutLinked($W,$g,$K,$x,$Z,$n),void $a.earcutLinked($T,$g,$K,$x,$Z,$n)}$v=$v.next}$W=$W.next}while($W!==$X)},$a.eliminateHoles=function($X,$g,$K,$x){var $Z,$n,$W,$v,$T,$G=[];for($Z=0,$n=$g.length;$Z<$n;$Z++)$W=$g[$Z]*$x,$v=$Z<$n-1?$g[$Z+1]*$x:$X.length,($T=$a.linkedList($X,$W,$v,$x,!1))===$T.next&&($T.steiner=!0),$G.push($a.getLeftmost($T));for($G.sort($a.compareX),$Z=0;$Z<$G.length;$Z++)$a.eliminateHole($G[$Z],$K),$K=$a.filterPoints($K,$K.next);return $K},$a.compareX=function($X,$g){return $X.x-$g.x},$a.eliminateHole=function($X,$g){if($g=$a.findHoleBridge($X,$g)){var $K=$a.splitPolygon($g,$X);$a.filterPoints($K,$K.next)}},$a.findHoleBridge=function($X,$g){var $K,$x=$g,$Z=$X.x,$n=$X.y,$W=-1/0;do{if($n<=$x.y&&$n>=$x.next.y&&$x.next.y!==$x.y){var $v=$x.x+($n-$x.y)*($x.next.x-$x.x)/($x.next.y-$x.y);if($v<=$Z&&$W<$v){if(($W=$v)===$Z){if($n===$x.y)return $x;if($n===$x.next.y)return $x.next}$K=$x.x<$x.next.x?$x:$x.next}}$x=$x.next}while($x!==$g);if(!$K)return null;if($Z===$W)return $K.prev;var $T,$G=$K,$c=$K.x,$_=$K.y,$s=1/0;for($x=$K.next;$x!==$G;)$Z>=$x.x&&$x.x>=$c&&$Z!==$x.x&&$a.pointInTriangle($n<$_?$Z:$W,$n,$c,$_,$n<$_?$W:$Z,$n,$x.x,$x.y)&&(($T=Math.abs($n-$x.y)/($Z-$x.x))<$s||$T===$s&&$x.x>$K.x)&&$a.locallyInside($x,$X)&&($K=$x,$s=$T),$x=$x.next;return $K},$a.indexCurve=function($X,$g,$K,$x){for(var $Z=$X;null===$Z.z&&($Z.z=$a.zOrder($Z.x,$Z.y,$g,$K,$x)),$Z.prevZ=$Z.prev,$Z.nextZ=$Z.next,($Z=$Z.next)!==$X;);$Z.prevZ.nextZ=null,$Z.prevZ=null,$a.sortLinked($Z)},$a.sortLinked=function($X){var $g,$K,$x,$Z,$n,$W,$v,$T,$G=1;do{for($K=$X,$n=$X=null,$W=0;$K;){for($W++,$x=$K,$g=$v=0;$g<$G&&($v++,$x=$x.nextZ);$g++);for($T=$G;0<$v||0<$T&&$x;)0!==$v&&(0===$T||!$x||$K.z<=$x.z)?($K=($Z=$K).nextZ,$v--):($x=($Z=$x).nextZ,$T--),$n?$n.nextZ=$Z:$X=$Z,$Z.prevZ=$n,$n=$Z;$K=$x}$n.nextZ=null,$G*=2}while(1<$W);return $X},$a.zOrder=function($X,$g,$K,$x,$Z){return($X=1431655765&(($X=858993459&(($X=252645135&(($X=16711935&(($X=32767*($X-$K)*$Z)|$X<<8))|$X<<4))|$X<<2))|$X<<1))|($g=1431655765&(($g=858993459&(($g=252645135&(($g=16711935&(($g=32767*($g-$x)*$Z)|$g<<8))|$g<<4))|$g<<2))|$g<<1))<<1},$a.getLeftmost=function($X){for(var $g=$X,$K=$X;$g.x<$K.x&&($K=$g),($g=$g.next)!==$X;);return $K},$a.pointInTriangle=function($X,$g,$K,$x,$Z,$n,$W,$v){return 0<=($Z-$W)*($g-$v)-($X-$W)*($n-$v)&&0<=($X-$W)*($x-$v)-($K-$W)*($g-$v)&&0<=($K-$W)*($n-$v)-($Z-$W)*($x-$v)},$a.isValidDiagonal=function($X,$g){return $X.next.i!==$g.i&&$X.prev.i!==$g.i&&!$a.intersectsPolygon($X,$g)&&$a.locallyInside($X,$g)&&$a.locallyInside($g,$X)&&$a.middleInside($X,$g)},$a.area=function($X,$g,$K){return($g.y-$X.y)*($K.x-$g.x)-($g.x-$X.x)*($K.y-$g.y)},$a.equals=function($X,$g){return $X.x===$g.x&&$X.y===$g.y},$a.intersects=function($X,$g,$K,$x){return!!($a.equals($X,$g)&&$a.equals($K,$x)||$a.equals($X,$x)&&$a.equals($K,$g))||0<$a.area($X,$g,$K)!=0<$a.area($X,$g,$x)&&0<$a.area($K,$x,$X)!=0<$a.area($K,$x,$g)},$a.intersectsPolygon=function($X,$g){var $K=$X;do{if($K.i!==$X.i&&$K.next.i!==$X.i&&$K.i!==$g.i&&$K.next.i!==$g.i&&$a.intersects($K,$K.next,$X,$g))return!0;$K=$K.next}while($K!==$X);return!1},$a.locallyInside=function($X,$g){return $a.area($X.prev,$X,$X.next)<0?0<=$a.area($X,$g,$X.next)&&0<=$a.area($X,$X.prev,$g):$a.area($X,$g,$X.prev)<0||$a.area($X,$X.next,$g)<0},$a.middleInside=function($X,$g){for(var $K=$X,$x=!1,$Z=($X.x+$g.x)/2,$n=($X.y+$g.y)/2;$K.y>$n!=$K.next.y>$n&&$K.next.y!==$K.y&&$Z<($K.next.x-$K.x)*($n-$K.y)/($K.next.y-$K.y)+$K.x&&($x=!$x),($K=$K.next)!==$X;);return $x},$a.splitPolygon=function($X,$g){var $K=new $ZX($X.i,$X.x,$X.y),$x=new $ZX($g.i,$g.x,$g.y),$Z=$X.next,$n=$g.prev;return($X.next=$g).prev=$X,($K.next=$Z).prev=$K,($x.next=$K).prev=$x,($n.next=$x).prev=$n,$x},$a.insertNode=function($X,$g,$K,$x){var $Z=new $ZX($X,$g,$K);return $x?($Z.next=$x.next,($Z.prev=$x).next.prev=$Z,$x.next=$Z):($Z.prev=$Z).next=$Z,$Z},$a.removeNode=function($X){$X.next.prev=$X.prev,$X.prev.next=$X.next,$X.prevZ&&($X.prevZ.nextZ=$X.nextZ),$X.nextZ&&($X.nextZ.prevZ=$X.prevZ)},$a.signedArea=function($X,$g,$K,$x){for(var $Z=0,$n=$g,$W=$K-$x;$n<$K;$n+=$x)$Z+=($X[$W]-$X[$n])*($X[$n+1]+$X[$W+1]),$W=$n;return $Z},$a}(),$ZX=function(){function $X($X,$g,$K){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=$X,this.x=$g,this.y=$K,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return $s($X,"laya.webgl.shapes.EarcutNode"),$X}(),$nX=(function(){function $X($X,$g,$K,$x,$Z,$n,$W){this.lineWidth=$X,this.lineColor=$g,this.lineAlpha=$K,this.fillColor=$x,this.fillAlpha=$Z,this.shape=$W,this.fill=$n}$s($X,"laya.webgl.shapes.GeometryData");var $g=$X.prototype;$g.clone=function(){return new $X(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},$g.getIndexData=function(){return null},$g.getVertexData=function(){return null},$g.destroy=function(){this.shape=null}}(),function(){function $X($X){if($X instanceof Float32Array)this.points=$X;else if($X instanceof Array){$X.length;this.points=new Float32Array($X)}}$s($X,"laya.webgl.shapes.Vertex");var $g=$X.prototype;$f.imps($g,{"laya.webgl.shapes.IShape":!0}),$g.getData=function($X,$g,$K){},$g.needUpdate=function($X){return!1},$g.rebuild=function($X){},$g.setMatrix=function($X){}}(),function(){function $T($X){void 0===$X&&($X=1e4),this._renderType=$X}$s($T,"laya.webgl.submit.Submit");var $X=$T.prototype;return $f.imps($X,{"laya.webgl.submit.ISubmit":!0}),$X.releaseRender=function(){var $X=$T._cache;($X[$X._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$X.getRenderType=function(){return this._renderType},$X.renderSubmit=function(){if(0===this._numEle)return 1;var $X=this.shaderValue.textureHost;if($X){var $g=$X.source;if(!$X.bitmap||!$g)return 1;this.shaderValue.texture=$g,$X.alphaTexture&&$X.alphaTexture.source&&(this.shaderValue.texture1=$X.alphaTexture.source)}this._vb.bind_upload(this._ib);var $K=$wX.mainContext;return this.shaderValue.upload(),$e.activeBlendFunction!==this._blendFn&&($K.enable(3042),this._blendFn($K),$e.activeBlendFunction=this._blendFn),$M.drawCall++,$M.trianglesFaces+=this._numEle/3,$K.drawElements(4,this._numEle,5123,this._startIdx),1},$T.__init__=function(){var $X=$T.RENDERBASE=new $T(-1);$X.shaderValue=new $BX(0,0),$X.shaderValue.ALPHA=-1234},$T.createSubmit=function($X,$g,$K,$x,$Z){var $n=$T._cache._length?$T._cache[--$T._cache._length]:new $T;null==$K&&(($K=$n._selfVb||($n._selfVb=$yX.create(-1))).clear(),$x=0),$n._ib=$g,$n._vb=$K,$n._startIdx=$x*$aX.BYTES_PIDX,$n._numEle=0;var $W=$X._nBlendType;$n._blendFn=$X._targets?$e.targetFns[$W]:$e.fns[$W],$n.shaderValue=$Z,$n.shaderValue.setValue($X._shader2D);var $v=$X._shader2D.filters;return $v&&$n.shaderValue.setFilters($v),$n},$T.createShape=function($X,$g,$K,$x,$Z,$n){var $W=$T._cache._length?$T._cache[--$T._cache._length]:new $T;$W._ib=$g,$W._vb=$K,$W._numEle=$x,$W._startIdx=$Z,$W.shaderValue=$n,$W.shaderValue.setValue($X._shader2D);var $v=$X._nBlendType;return $W._blendFn=$X._targets?$e.targetFns[$v]:$e.fns[$v],$W},$T.TYPE_2D=1e4,$T.TYPE_CANVAS=10003,$T.TYPE_CMDSETRT=10004,$T.TYPE_CUSTOM=10005,$T.TYPE_BLURRT=10006,$T.TYPE_CMDDESTORYPRERT=10007,$T.TYPE_DISABLESTENCIL=10008,$T.TYPE_OTHERIBVB=10009,$T.TYPE_PRIMITIVE=10010,$T.TYPE_RT=10011,$T.TYPE_BLUR_RT=10012,$T.TYPE_TARGET=10013,$T.TYPE_CHANGE_VALUE=10014,$T.TYPE_SHAPE=10015,$T.TYPE_TEXTURE=10016,$T.TYPE_FILLTEXTURE=10017,$T.RENDERBASE=null,$T._cache=(($T._cache=[])._length=0,$T._cache),$T}()),$WX=function(){function $x(){this.fun=null,this.args=null}$s($x,"laya.webgl.submit.SubmitCMD");var $X=$x.prototype;return $f.imps($X,{"laya.webgl.submit.ISubmit":!0}),$X.renderSubmit=function(){return this.fun.apply(null,this.args),1},$X.getRenderType=function(){return 0},$X.releaseRender=function(){var $X=$x._cache;$X[$X._length++]=this},$x.create=function($X,$g){var $K=$x._cache._length?$x._cache[--$x._cache._length]:new $x;return $K.fun=$g,$K.args=$X,$K},$x._cache=(($x._cache=[])._length=0,$x._cache),$x}(),$vX=function(){function $g(){this.variables={}}$s($g,"laya.webgl.submit.SubmitCMDScope");var $X=$g.prototype;return $X.getValue=function($X){return this.variables[$X]},$X.addValue=function($X,$g){return this.variables[$X]=$g},$X.setValue=function($X,$g){return this.variables.hasOwnProperty($X)?this.variables[$X]=$g:null},$X.clear=function(){for(var $X in this.variables)delete this.variables[$X]},$X.recycle=function(){this.clear(),$g.POOL.push(this)},$g.create=function(){var $X=$g.POOL.pop();return $X||($X=new $g),$X},$g.POOL=[],$g}(),$TX=function(){function $_(){this.offset=0,this.startIndex=0,this._mat=$i.create()}$s($_,"laya.webgl.submit.SubmitOtherIBVB");var $X=$_.prototype;return $f.imps($X,{"laya.webgl.submit.ISubmit":!0}),$X.releaseRender=function(){var $X=$_._cache;($X[$X._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$X.getRenderType=function(){return 10009},$X.renderSubmit=function(){var $X=this._shaderValue.textureHost;if($X){var $g=$X.source;if(!$X.bitmap||!$g)return 1;this._shaderValue.texture=$g}this._vb.bind_upload(this._ib);var $K=$UX.worldMatrix4,$x=$i.TEMP;$i.mulPre(this._mat,$K[0],$K[1],$K[4],$K[5],$K[12],$K[13],$x);var $Z=$UX.worldMatrix4=$_.tempMatrix4;$Z[0]=$x.a,$Z[1]=$x.b,$Z[4]=$x.c,$Z[5]=$x.d,$Z[12]=$x.tx,$Z[13]=$x.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var $n=$wX.mainContext;return $e.activeBlendFunction!==this._blendFn&&($n.enable(3042),this._blendFn($n),$e.activeBlendFunction=this._blendFn),$M.drawCall++,$M.trianglesFaces+=this._numEle/3,$n.drawElements(4,this._numEle,5123,this.startIndex),$UX.worldMatrix4=$K,$lX.activeShader=null,1},$_.create=function($X,$g,$K,$x,$Z,$n,$W,$v,$T){void 0===$T&&($T=0);var $G=$_._cache._length?$_._cache[--$_._cache._length]:new $_;$G._ib=$K,$G._vb=$g,$G._numEle=$x,$G._shader=$Z,$G._shaderValue=$n;var $c=$X._nBlendType;switch($G._blendFn=$X._targets?$e.targetFns[$c]:$e.fns[$c],$T){case 0:$G.offset=0,$G.startIndex=$v/($aX.BYTES_PE*$g.vertexStride)*1.5,$G.startIndex*=$aX.BYTES_PIDX;break;case 1:$G.startIndex=$W,$G.offset=$v}return $G},$_._cache=(($_._cache=[])._length=0,$_._cache),$_.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$_}(),$GX=function(){function $K(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new $I,this.screenRect=new $I}$s($K,"laya.webgl.submit.SubmitScissor");var $X=$K.prototype;return $f.imps($X,{"laya.webgl.submit.ISubmit":!0}),$X._scissor=function($X,$g,$K,$x){var $Z=$UX.worldMatrix4,$n=$Z[0],$W=$Z[5],$v=$Z[12],$T=$Z[13];if($x*=$W,($K*=$n)<1||$x<1)return!1;var $G=($X=$X*$n+$v)+$K,$c=($g=$g*$W+$T)+$x;$X<0&&($K=$G-($X=0)),$g<0&&($x=$c-($g=0));var $_=$UX.worldClipRect;if($X=Math.max($X,$_.x),$g=Math.max($g,$_.y),$K=Math.min($G,$_.right)-$X,$x=Math.min($c,$_.bottom)-$g,$K<1||$x<1)return!1;var $s=$UX.worldScissorTest;return this.screenRect.copyFrom($_),$_.x=$X,$_.y=$g,$_.width=$K,$_.height=$x,$UX.worldScissorTest=!0,$g=$UX.height-$g-$x,$wX.mainContext.scissor($X,$g,$K,$x),$wX.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$s?($g=$UX.height-this.screenRect.y-this.screenRect.height,$wX.mainContext.scissor(this.screenRect.x,$g,this.screenRect.width,this.screenRect.height),$wX.mainContext.enable(3089)):($wX.mainContext.disable(3089),$UX.worldScissorTest=!1),$_.copyFrom(this.screenRect),!0},$X._scissorWithTagart=function($X,$g,$K,$x){if($K<1||$x<1)return!1;var $Z=$X+$K,$n=$g+$x;$X<0&&($K=$Z-($X=0)),$g<0&&($x=$n-($g=0));var $W=$UX.worldClipRect;if($X=Math.max($X,$W.x),$g=Math.max($g,$W.y),$K=Math.min($Z,$W.right)-$X,$x=Math.min($n,$W.bottom)-$g,$K<1||$x<1)return!1;var $v=$UX.worldScissorTest;return this.screenRect.copyFrom($W),$UX.worldScissorTest=!0,$W.x=$X,$W.y=$g,$W.width=$K,$W.height=$x,$g=$UX.height-$g-$x,$wX.mainContext.scissor($X,$g,$K,$x),$wX.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$v?($g=$UX.height-this.screenRect.y-this.screenRect.height,$wX.mainContext.scissor(this.screenRect.x,$g,this.screenRect.width,this.screenRect.height),$wX.mainContext.enable(3089)):($wX.mainContext.disable(3089),$UX.worldScissorTest=!1),$W.copyFrom(this.screenRect),!0},$X.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},$X.getRenderType=function(){return 0},$X.releaseRender=function(){var $X=$K._cache;($X[$X._length++]=this).context=null},$K.create=function($X){var $g=$K._cache._length?$K._cache[--$K._cache._length]:new $K;return $g.context=$X,$g},$K._cache=(($K._cache=[])._length=0,$K._cache),$K}(),$cX=function(){function $T(){this.step=0,this.blendMode=null,this.level=0}$s($T,"laya.webgl.submit.SubmitStencil");var $X=$T.prototype;return $f.imps($X,{"laya.webgl.submit.ISubmit":!0}),$X.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},$X.getRenderType=function(){return 0},$X.releaseRender=function(){var $X=$T._cache;$X[$X._length++]=this},$X.do1=function(){var $X=$wX.mainContext;$X.enable(2960),$X.clear(1024),$X.colorMask(!1,!1,!1,!1),$X.stencilFunc(514,this.level,255),$X.stencilOp(7680,7680,7682)},$X.do2=function(){var $X=$wX.mainContext;$X.stencilFunc(514,this.level+1,255),$X.colorMask(!0,!0,!0,!0),$X.stencilOp(7680,7680,7680)},$X.do3=function(){var $X=$wX.mainContext;$X.colorMask(!0,!0,!0,!0),$X.stencilOp(7680,7680,7680),$X.clear(1024),$X.disable(2960)},$X.do4=function(){var $X=$wX.mainContext;0==this.level&&($X.enable(2960),$X.clear(1024)),$X.colorMask(!1,!1,!1,!1),$X.stencilFunc(519,0,255),$X.stencilOp(7680,7680,7682)},$X.do5=function(){var $X=$wX.mainContext;$X.stencilFunc(514,this.level,255),$X.colorMask(!0,!0,!0,!0),$X.stencilOp(7680,7680,7680)},$X.do6=function(){var $X=$wX.mainContext;$e.targetFns[$e.TOINT[this.blendMode]]($X)},$X.do7=function(){var $X=$wX.mainContext;$X.colorMask(!1,!1,!1,!1),$X.stencilOp(7680,7680,7683)},$X.do8=function(){var $X=$wX.mainContext;$X.colorMask(!0,!0,!0,!0),$X.stencilFunc(514,this.level,255),$X.stencilOp(7680,7680,7680)},$T.restore=function($X,$g,$K,$x,$Z){var $n;if(($X._renderKey=0)<$T._mask&&$T._mask--,0==$T._mask)$n=laya.webgl.submit.SubmitStencil.create(3),$X.addRenderObject($n),$X._curSubmit=$nX.RENDERBASE;else{$n=laya.webgl.submit.SubmitStencil.create(7),$X.addRenderObject($n);var $W=$X._vb;$W._byteLength;if($mX.fillRectImgVb($W,null,$g.x,$g.y,$g.width,$g.height,$Y.DEF_UV,$K,$x,$Z,0,0)){$X._shader2D.glTexture=null;var $v=$X._curSubmit=$nX.createSubmit($X,$X._ib,$W,($W._byteLength-64)/32*3,$BX.create(2,0));$v.shaderValue.ALPHA=1,$X._submits[$X._submits._length++]=$v,$X._curSubmit._numEle+=6,$X._curSubmit=$nX.RENDERBASE}else alert("clipRect calc stencil rect error");$n=laya.webgl.submit.SubmitStencil.create(8),$X.addRenderObject($n)}},$T.restore2=function($X,$g){var $K;($X._renderKey=0)<$T._mask&&$T._mask--,0==$T._mask?($K=laya.webgl.submit.SubmitStencil.create(3),$X.addRenderObject($K),$X._curSubmit=$nX.RENDERBASE):($K=laya.webgl.submit.SubmitStencil.create(7),$X.addRenderObject($K),$X._submits[$X._submits._length++]=$g,$K=laya.webgl.submit.SubmitStencil.create(8),$X.addRenderObject($K))},$T.create=function($X){var $g=$T._cache._length?$T._cache[--$T._cache._length]:new $T;return 5==($g.step=$X)&&++$T._mask,$g.level=$T._mask,$g},$T._cache=(($T._cache=[])._length=0,$T._cache),$T._mask=0,$T}(),$_X=function(){function $v(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}$s($v,"laya.webgl.submit.SubmitTarget");var $X=$v.prototype;return $f.imps($X,{"laya.webgl.submit.ISubmit":!0}),$X.renderSubmit=function(){this._vb.bind_upload(this._ib);var $X=this.scope.getValue(this.proName);return $X&&(this.shaderValue.texture=$X.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[$X.width,$X.height]),this.shaderValue.upload(),this.blend(),$M.drawCall++,$M.trianglesFaces+=this._numEle/3,$wX.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},$X.blend=function(){if($e.activeBlendFunction!==$e.fns[this.blendType]){var $X=$wX.mainContext;$X.enable(3042),$e.fns[this.blendType]($X),$e.activeBlendFunction=$e.fns[this.blendType]}},$X.getRenderType=function(){return 0},$X.releaseRender=function(){var $X=$v._cache;($X[$X._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$v.create=function($X,$g,$K,$x,$Z,$n){var $W=$v._cache._length?$v._cache[--$v._cache._length]:new $v;return $W._ib=$g,$W._vb=$K,$W.proName=$n,$W._startIdx=$x*$aX.BYTES_PIDX,$W._numEle=0,$W.blendType=$X._nBlendType,$W.shaderValue=$Z,$W.shaderValue.setValue($X._shader2D),$W},$v._cache=(($v._cache=[])._length=0,$v._cache),$v}(),$sX=function(){function $X(){this._sourceStr=null}$s($X,"laya.webgl.text.CharSegment");var $g=$X.prototype;return $f.imps($g,{"laya.webgl.text.ICharSegment":!0}),$g.textToSpit=function($X){this._sourceStr=$X},$g.getChar=function($X){return this._sourceStr.charAt($X)},$g.getCharCode=function($X){return this._sourceStr.charCodeAt($X)},$g.length=function(){return this._sourceStr.length},$X}(),$VX=function(){var $X;function $M(){}return $s($M,"laya.webgl.text.DrawText"),$M.__init__=function(){$M._charsTemp=new Array,$M._drawValue=new $X,$M._charSeg=new $sX},$M.customCharSeg=function($X){$M._charSeg=$X},$M.getChar=function($X,$g,$K){var $x=$RX.createOneChar($X,$K);return-1!=$g&&($M._charsCache[$g]=$x),$x},$M._drawSlow=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$_,$s,$V,$A){var $a,$m,$F=$M._drawValue.value($n,$v,$T,$G,$s,$V,$A),$U=0,$$=0,$w=$M._charsTemp,$Q=0,$f=NaN;if($x)for($w.length=$x.length,$U=0,$$=$x.length;$U<$$;$U++)($m=$x[$U])&&($f=$m.charNum+$F.txtID,$w[$U]=$a=$M._charsCache[$f]||$M.getChar($m.char,$f,$F),$a.active());else{var $D=$K instanceof laya.utils.WordText?$K.toString():$K;if($C.CharacterCache){$M._charSeg.textToSpit($D);var $B=$M._charSeg.length();for($U=0,$$=$w.length=$B;$U<$$;$U++)$f=$M._charSeg.getCharCode($U)+$F.txtID,$w[$U]=$a=$M._charsCache[$f]||$M.getChar($M._charSeg.getChar($U),$f,$F),$a.active(),$Q+=$a.cw}else $w.length=0,($a=$M.getChar($D,-1,$F)).active(),$Q+=$a.cw,$w[0]=$a}var $i=0;null!==$W&&"left"!==$W&&($i=-("center"==$W?$Q/2:$Q));var $k,$I,$r=NaN,$t=0;if($x)for($U=0,$$=$w.length;$U<$$;$U++)$a=$w[$U],$m=$x[$U],$a&&$m&&!$a.isSpace&&($r=$a.borderSize,$k=$a.texture,$g._drawText($k,$c+$i+$m.x*$s-$r,$_+$m.y*$V-$r,$k.width,$k.height,$Z,0,0,0,0));else{for($U=0,$$=$w.length;$U<$$;$U++)($a=$w[$U])&&!$a.isSpace&&($r=$a.borderSize,$k=$a.texture,$g._drawText($k,$c+$i-$r,$_-$r,$k.width,$k.height,$Z,0,0,0,0),$X&&(($I=$X[$t++])||($I=$X[$t-1]=[]),$I[0]=$k,$I[1]=$i-$r,$I[2]=-$r)),$i+=$a.cw;$X&&($X.length=$t)}},$M._drawFast=function($X,$g,$K,$x,$Z){for(var $n,$W,$v=0,$T=$X.length;$v<$T;$v++)($n=($W=$X[$v])[0]).active(),$g._drawText($n,$x+$W[1],$Z+$W[2],$n.width,$n.height,$K,0,0,0,0)},$M.drawText=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$_){if(void 0===$_&&($_=0),!($g&&0===$g.length||$K&&0===$K.length)){var $s=$x.a,$V=$x.d;(0!==$x.b||0!==$x.c)&&($s=$V=1);var $A=1!==$s||1!==$V;if($A&&$f.stage.transform){var $a=$f.stage.transform;$A=$a.a===$s&&$a.d===$V}else $A=!1;if($A){var $m=($x=$x.copyTo($DX._tmpMatrix)).tx,$F=$x.ty;$x.scale(1/$s,1/$V),$x._checkTransform(),$G*=$s,$c*=$V,$G+=$m-$x.tx,$c+=$F-$x.ty}else $s=$V=1;if($K)$M._drawSlow(null,$X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$s,$V,$_);else{if(null===$g.toUpperCase){var $U=$s+1e5*$V,$$=$g;return void($$.changed||$$.id!==$U?($$.id=$U,$$.changed=!1,$M._drawSlow($$.save,$X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$s,$V,$_)):$M._drawFast($$.save,$X,$x,$G,$c))}var $w=$g+$Z.toString()+$W+$v+$T+$s+$V+$n,$Q=$M._textsCache[$w];$C.CharacterCache?$Q?$M._drawFast($Q,$X,$x,$G,$c):($M._textsCache.__length||($M._textsCache.__length=0),$M._textsCache.__length>$D.WebGLTextCacheCount&&(($M._textsCache={}).__length=0,$M._curPoolIndex=0),$M._textCachesPool[$M._curPoolIndex]?($Q=$M._textsCache[$w]=$M._textCachesPool[$M._curPoolIndex]).length=0:$M._textCachesPool[$M._curPoolIndex]=$Q=$M._textsCache[$w]=[],$M._textsCache.__length++,$M._curPoolIndex++,$M._drawSlow($Q,$X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$s,$V,$_)):$M._drawSlow($Q,$X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$s,$V,$_)}}},$M._charsTemp=null,$M._textCachesPool=[],$M._curPoolIndex=0,$M._charsCache={},$M._textsCache={},$M._drawValue=null,$M.d=[],$M._charSeg=null,$M.__init$=function(){$X=function(){function $T(){}return $s($T,""),$T.prototype.value=function($X,$g,$K,$x,$Z,$n,$W){this.font=$X,this.fillColor=$g,this.borderColor=$K,this.lineWidth=$x,this.scaleX=$Z,this.scaleY=$n,this.underLine=$W;var $v=$X.toString()+$Z+$n+$x+($g?$g.toLowerCase():" ")+($K?$K.toLowerCase():" ")+$W;return this.txtID=$T._keymap[$v],this.txtID||(this.txtID=1e-7*++$T._keymapCount,$T._keymap[$v]=this.txtID),this},$T.clear=function(){$T._keymap={},$T._keymapCount=1},$T._keymap={},$T._keymapCount=1,$T}()},$M}(),$AX=function(){function $Z($X){this._index=0,this._size=14,this._italic=-2,$Z._cache2=$Z._cache2||[],this.setFont($X||"14px Arial")}$s($Z,"laya.webgl.text.FontInContext");var $X=$Z.prototype;return $X.setFont=function($X){var $g=$Z._cache2[$X];if($g)this._words=$g[0],this._size=$g[1];else{this._words=$X.split(" ");for(var $K=0,$x=this._words.length;$K<$x;$K++)if(0<this._words[$K].indexOf("px")){this._index=$K;break}this._size=parseInt(this._words[this._index]),$Z._cache2[$X]=[this._words,this._size]}this._text=null,this._italic=-2},$X.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},$X.hasType=function($X){for(var $g=0,$K=this._words.length;$g<$K;$g++)if(this._words[$g]===$X)return $g;return-1},$X.removeType=function($X){for(var $g=0,$K=this._words.length;$g<$K;$g++)if(this._words[$g]===$X){this._words.splice($g,1),this._index>$g&&this._index--;break}this._text=null,this._italic=-2},$X.copyTo=function($X){return $X._text=this._text,$X._size=this._size,$X._index=this._index,$X._words=this._words.slice(),$X._italic=-2,$X},$X.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},$x(0,$X,"size",function(){return this._size},function($X){this._size=$X,this._words[this._index]=$X+"px",this._text=null}),$Z.create=function($X){var $g=$Z._cache[$X];return $g||($g=$Z._cache[$X]=new $Z($X))},$Z.EMPTY=new $Z,$Z._cache={},$Z._cache2=null,$Z}(),$aX=function(){function $X(){}return $s($X,"laya.webgl.utils.CONST3D2D"),$X.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$X.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],$X.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],$X._TMPARRAY=[],$X._OFFSETX=0,$X._OFFSETY=0,$W($X,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),$X}(),$mX=function(){function $A(){}return $s($A,"laya.webgl.utils.GlUtils"),$A.make2DProjection=function($X,$g,$K){return[2/$X,0,0,0,0,-2/$g,0,0,0,0,2/$K,0,-1,1,0,1]},$A.fillIBQuadrangle=function($X,$g){if(65535/4<$g)throw Error("IBQuadrangle count:"+$g+" must<:"+Math.floor(65535/4));$g=Math.floor($g),$X._resizeBuffer(6*($g+1)*2,!1),$X.byteLength=$X.bufferLength;for(var $K=$X.getUint16Array(),$x=0,$Z=0;$Z<$g;$Z++)$K[$x++]=4*$Z,$K[$x++]=4*$Z+2,$K[$x++]=4*$Z+1,$K[$x++]=4*$Z,$K[$x++]=4*$Z+3,$K[$x++]=4*$Z+2;return $X.setNeedUpload(),!0},$A.expandIBQuadrangle=function($X,$g){$X.bufferLength>=6*$g*2||$A.fillIBQuadrangle($X,$g)},$A.mathCeilPowerOfTwo=function($X){return $X--,$X|=$X>>1,$X|=$X>>2,$X|=$X>>4,$X|=$X>>8,$X|=$X>>16,++$X},$A.fillQuadrangleImgVb=function($X,$g,$K,$x,$Z,$n,$W,$v){var $T=16+($X._byteLength>>2);$X.byteLength=$T<<2;var $G=$X.getFloat32Array();$G[($T-=16)+2]=$Z[0],$G[$T+3]=$Z[1],$G[$T+6]=$Z[2],$G[$T+7]=$Z[3],$G[$T+10]=$Z[4],$G[$T+11]=$Z[5],$G[$T+14]=$Z[6],$G[$T+15]=$Z[7];var $c=$n.a,$_=$n.b,$s=$n.c,$V=$n.d;if(1!==$c||0!==$_||0!==$s||1!==$V){$n.bTransform=!0;var $A=$n.tx+$W,$a=$n.ty+$v;$G[$T]=($x[0]+$g)*$c+($x[1]+$K)*$s+$A,$G[$T+1]=($x[0]+$g)*$_+($x[1]+$K)*$V+$a,$G[$T+4]=($x[2]+$g)*$c+($x[3]+$K)*$s+$A,$G[$T+5]=($x[2]+$g)*$_+($x[3]+$K)*$V+$a,$G[$T+8]=($x[4]+$g)*$c+($x[5]+$K)*$s+$A,$G[$T+9]=($x[4]+$g)*$_+($x[5]+$K)*$V+$a,$G[$T+12]=($x[6]+$g)*$c+($x[7]+$K)*$s+$A,$G[$T+13]=($x[6]+$g)*$_+($x[7]+$K)*$V+$a}else $n.bTransform=!1,$g+=$n.tx+$W,$K+=$n.ty+$v,$G[$T]=$g+$x[0],$G[$T+1]=$K+$x[1],$G[$T+4]=$g+$x[2],$G[$T+5]=$K+$x[3],$G[$T+8]=$g+$x[4],$G[$T+9]=$K+$x[5],$G[$T+12]=$g+$x[6],$G[$T+13]=$K+$x[7];return $X._upload=!0},$A.fillTranglesVB=function($X,$g,$K,$x,$Z,$n,$W){var $v=($X._byteLength>>2)+$x.length;$X.byteLength=$v<<2;var $T=$X.getFloat32Array();$v-=$x.length;for(var $G=$x.length,$c=$Z.a,$_=$Z.b,$s=$Z.c,$V=$Z.d,$A=0;$A<$G;$A+=4)if($T[$v+$A+2]=$x[$A+2],$T[$v+$A+3]=$x[$A+3],1!==$c||0!==$_||0!==$s||1!==$V){$Z.bTransform=!0;var $a=$Z.tx+$n,$m=$Z.ty+$W;$T[$v+$A]=($x[$A]+$g)*$c+($x[$A+1]+$K)*$s+$a,$T[$v+$A+1]=($x[$A]+$g)*$_+($x[$A+1]+$K)*$V+$m}else $Z.bTransform=!1,$g+=$Z.tx+$n,$K+=$Z.ty+$W,$T[$v+$A]=$g+$x[$A],$T[$v+$A+1]=$K+$x[$A+1];return $X._upload=!0},$A.copyPreImgVb=function($X,$g,$K){var $x=$X._byteLength>>2;$X.byteLength=$x+16<<2;for(var $Z=$X.getFloat32Array(),$n=0,$W=$x-16;$n<4;$n++)$Z[$x]=$Z[$W]+$g,++$W,$Z[++$x]=$Z[$W]+$K,++$W,$Z[++$x]=$Z[$W],++$W,$Z[++$x]=$Z[$W],++$x,++$W;$X._upload=!0},$A.fillRectImgVb=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$_,$s){void 0===$s&&($s=!1);var $V,$A,$a,$m,$F,$U,$$,$w,$Q,$f,$D,$B,$i,$k,$I,$r,$t=1,$M=$v.a,$P=$v.b,$N=$v.c,$C=$v.d,$Y=$g&&$g.width<99999999;if(1!==$M||0!==$P||0!==$N||1!==$C?($v.bTransform=!0,0===$P&&0===$N&&($t=23,$Q=$Z+$K,$f=$n+$x,$V=$M*$K+($D=$v.tx+$T),$a=$M*$Q+$D,$A=$C*$x+($B=$v.ty+$G),$m=$C*$f+$B)):($t=23,$v.bTransform=!1,$a=($V=$K+$v.tx+$T)+$Z,$m=($A=$x+$v.ty+$G)+$n),$Y&&($F=$g.x,$U=$g.y,$$=$g.width+$F,$w=$g.height+$U),1!==$t){if(Math.min($V,$a)>=$$)return!1;if(Math.min($A,$m)>=$w)return!1;if(Math.max($a,$V)<=$F)return!1;if(Math.max($m,$A)<=$U)return!1}var $l=$X._byteLength>>2;$X.byteLength=16+$l<<2;var $p=$X.getFloat32Array();switch($p[2+$l]=$W[0],$p[3+$l]=$W[1],$p[6+$l]=$W[2],$p[7+$l]=$W[3],$p[10+$l]=$W[4],$p[11+$l]=$W[5],$p[14+$l]=$W[6],$p[15+$l]=$W[7],$t){case 1:$D=$v.tx+$T,$B=$v.ty+$G;var $L=$M*$K,$q=$N*$x,$E=$C*$x,$u=$P*$K,$O=$M*($Q=$Z+$K),$e=$N*($f=$n+$x),$b=$C*$f,$S=$P*$Q;$s?($i=$L+$q+$D,$I=Math.round($i)-$i,$k=$E+$u+$B,$r=Math.round($k)-$k,$p[$l]=$i+$I,$p[1+$l]=$k+$r,$p[4+$l]=$O+$q+$D+$I,$p[5+$l]=$E+$S+$B+$r,$p[8+$l]=$O+$e+$D+$I,$p[9+$l]=$b+$S+$B+$r,$p[12+$l]=$L+$e+$D+$I,$p[13+$l]=$b+$u+$B+$r):($p[$l]=$L+$q+$D,$p[1+$l]=$E+$u+$B,$p[4+$l]=$O+$q+$D,$p[5+$l]=$E+$S+$B,$p[8+$l]=$O+$e+$D,$p[9+$l]=$b+$S+$B,$p[12+$l]=$L+$e+$D,$p[13+$l]=$b+$u+$B);break;case 23:$s?($i=$V+$c,$I=Math.round($i)-$i,$k=$A,$r=Math.round($k)-$k,$p[$l]=$i+$I,$p[1+$l]=$k+$r,$p[4+$l]=$a+$c+$I,$p[5+$l]=$A+$r,$p[8+$l]=$a+$I,$p[9+$l]=$m+$r,$p[12+$l]=$V+$I,$p[13+$l]=$m+$r):($p[$l]=$V+$c,$p[1+$l]=$A,$p[4+$l]=$a+$c,$p[5+$l]=$A,$p[8+$l]=$a,$p[9+$l]=$m,$p[12+$l]=$V,$p[13+$l]=$m)}return $X._upload=!0},$A.fillLineVb=function($X,$g,$K,$x,$Z,$n,$W,$v){var $T=.5*$W,$G=$A._fillLineArray,$c=-($x-$n),$_=$K-$Z,$s=Math.sqrt($c*$c+$_*$_);$c/=$s,$_/=$s,$c*=$T,$_*=$T,$G[0]=$K-$c,$G[1]=$x-$_,$G[4]=$K+$c,$G[5]=$x+$_,$G[8]=$Z+$c,$G[9]=$n+$_,$G[12]=$Z-$c,$G[13]=$n-$_,$v&&$v.transformPointArray($G,$G);var $V=16+($X._byteLength>>2);return $X.byteLength=$V<<2,$X.insertData($G,$V-16),!0},$A._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$A}(),$FX=(function(){function $T(){}$s($T,"laya.webgl.utils.MatirxArray"),$T.ArrayMul=function($X,$g,$K){if($X)if($g)for(var $x=NaN,$Z=NaN,$n=NaN,$W=NaN,$v=0;$v<4;$v++)$x=$X[$v],$Z=$X[$v+4],$n=$X[$v+8],$W=$X[$v+12],$K[$v]=$x*$g[0]+$Z*$g[1]+$n*$g[2]+$W*$g[3],$K[$v+4]=$x*$g[4]+$Z*$g[5]+$n*$g[6]+$W*$g[7],$K[$v+8]=$x*$g[8]+$Z*$g[9]+$n*$g[10]+$W*$g[11],$K[$v+12]=$x*$g[12]+$Z*$g[13]+$n*$g[14]+$W*$g[15];else $T.copyArray($X,$K);else $T.copyArray($g,$K)},$T.copyArray=function($X,$g){if($X&&$g)for(var $K=0;$K<$X.length;$K++)$g[$K]=$X[$K]}}(),function(){function $g($X,$g,$K){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=$X,this._vb=new $yX($X,35048),$g&&this._vb._resizeBuffer($g,!1),this._ib=new $HX,$K&&this._ib._resizeBuffer($K,!1)}$s($g,"laya.webgl.utils.Mesh2D");var $X=$g.prototype;return $X.cloneWithNewVB=function(){var $X=new $g(this._stride,0,0);return $X._ib=this._ib,$X._quadNum=this._quadNum,$X._attribInfo=this._attribInfo,$X},$X.cloneWithNewVBIB=function(){var $X=new $g(this._stride,0,0);return $X._attribInfo=this._attribInfo,$X},$X.getVBW=function(){return this._vb.setNeedUpload(),this._vb},$X.getVBR=function(){return this._vb},$X.getIBR=function(){return this._ib},$X.getIBW=function(){return this._ib.setNeedUpload(),this._ib},$X.createQuadIB=function($X){this._quadNum=$X,this._ib._resizeBuffer(6*$X*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var $g=this._ib.getUint16Array(),$K=0,$x=0,$Z=0;$Z<$X;$Z++)$g[$K++]=$x,$g[$K++]=$x+2,$g[$K++]=$x+1,$g[$K++]=$x,$g[$K++]=$x+3,$g[$K++]=$x+2,$x+=4;this._ib.setNeedUpload()},$X.setAttributes=function($X){if(this._attribInfo=$X,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},$X.getEleNum=function(){return this._ib.getBuffer().byteLength/2},$X.releaseMesh=function(){},$X.destroy=function(){},$X.clearVB=function(){this._vb.clear()},$g._gvaoid=0,$g}()),$UX=function(){function $Z(){}return $s($Z,"laya.webgl.utils.RenderState2D"),$Z.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},$Z.mat2MatArray=function($X,$g){var $K=$X,$x=$g;return $x[0]=$K.a,$x[1]=$K.b,$x[2]=$Z.EMPTYMAT4_ARRAY[2],$x[3]=$Z.EMPTYMAT4_ARRAY[3],$x[4]=$K.c,$x[5]=$K.d,$x[6]=$Z.EMPTYMAT4_ARRAY[6],$x[7]=$Z.EMPTYMAT4_ARRAY[7],$x[8]=$Z.EMPTYMAT4_ARRAY[8],$x[9]=$Z.EMPTYMAT4_ARRAY[9],$x[10]=$Z.EMPTYMAT4_ARRAY[10],$x[11]=$Z.EMPTYMAT4_ARRAY[11],$x[12]=$K.tx,$x[13]=$K.ty,$x[14]=$Z.EMPTYMAT4_ARRAY[14],$x[15]=$Z.EMPTYMAT4_ARRAY[15],$g},$Z.restoreTempArray=function(){$Z.TEMPMAT4_ARRAY[0]=1,$Z.TEMPMAT4_ARRAY[1]=0,$Z.TEMPMAT4_ARRAY[4]=0,$Z.TEMPMAT4_ARRAY[5]=1,$Z.TEMPMAT4_ARRAY[12]=0,$Z.TEMPMAT4_ARRAY[13]=0},$Z.clear=function(){$Z.worldScissorTest=!1,$Z.worldShaderDefines=null,$Z.worldFilters=null,$Z.worldAlpha=1,$Z.worldClipRect.x=$Z.worldClipRect.y=0,$Z.worldClipRect.width=$Z.width,$Z.worldClipRect.height=$Z.height,$Z.curRenderTarget=null},$Z._MAXSIZE=99999999,$Z.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$Z.worldMatrix4=$Z.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$Z.worldAlpha=1,$Z.worldScissorTest=!1,$Z.worldFilters=null,$Z.worldShaderDefines=null,$Z.curRenderTarget=null,$Z.width=0,$Z.height=0,$W($Z,["worldMatrix",function(){return this.worldMatrix=new $i},"worldClipRect",function(){return this.worldClipRect=new $I(0,0,99999999,99999999)}]),$Z}(),$$X=function(){var $U,$K;function $$($X,$g,$K,$x,$Z){var $n=this;function $W($X){var $g=[],$K=new $U($g);return $n._compileToTree($K,$X.split("\n"),0,$g,$Z),$K}var $v=$V.now();this._VS=$W($g),this._PS=$W($K),this._nameMap=$x,2<$V.now()-$v&&console.log("ShaderCompile use time:"+($V.now()-$v)+"  size:"+$g.length+"/"+$K.length)}$s($$,"laya.webgl.utils.ShaderCompile");var $X=$$.prototype;return $X._compileToTree=function($X,$g,$K,$x,$Z){var $n,$W,$v,$T,$G,$c,$_,$s=0,$V=0,$A=0,$a=0;for($V=$K;$V<$g.length;$V++)if(!(($v=$g[$V]).length<1)&&0!==($s=$v.indexOf("//"))){if(0<=$s&&($v=$v.substr(0,$s)),$n=$_||new $U($x),$_=null,$n.text=$v,$n.noCompile=!0,0<=($s=$v.indexOf("#"))){for($T="#",$a=$s+1,$A=$v.length;$a<$A;$a++){var $m=$v.charAt($a);if(" "===$m||"\t"===$m||"\r"===$m||"\n"===$m||"?"===$m)break;$T+=$m}switch($n.name=$T){case"#ifdef":case"#ifndef":if($n.src=$v,$n.noCompile=null!=$v.match(/[!&|()=<>]/),$n.noCompile?console.log("function():Boolean{return "+$v.substr($s+$n.name.length)+"}"):($c=$v.replace(/^\s*/,"").split(/\s+/),$n.setCondition($c[1],"#ifdef"===$T?1:2),$n.text="//"+$n.text),$n.setParent($X),$X=$n,$Z)for($c=$v.substr($a).split($$._splitToWordExps3),$a=0;$a<$c.length;$a++)($v=$c[$a]).length&&($Z[$v]=!0);continue;case"#if":if($n.src=$v,$n.noCompile=!0,$n.setParent($X),$X=$n,$Z)for($c=$v.substr($a).split($$._splitToWordExps3),$a=0;$a<$c.length;$a++)($v=$c[$a]).length&&"defined"!=$v&&($Z[$v]=!0);continue;case"#else":$n.src=$v,$W=($X=$X.parent).childs[$X.childs.length-1],$n.noCompile=$W.noCompile,$n.noCompile||($n.condition=$W.condition,$n.conditionType=1==$W.conditionType?2:1,$n.text="//"+$n.text+" "+$W.text+" "+$n.conditionType),$n.setParent($X),$X=$n;continue;case"#endif":$W=($X=$X.parent).childs[$X.childs.length-1],$n.noCompile=$W.noCompile,$n.noCompile||($n.text="//"+$n.text),$n.setParent($X);continue;case"#include":$c=$$.splitToWords($v,null);var $F=$$.includes[$c[1]];if(!$F)throw"ShaderCompile error no this include file:"+$c[1];if(($s=$c[0].indexOf("?"))<0){$n.setParent($X),$v=$F.getWith("with"==$c[2]?$c[3]:null),this._compileToTree($n,$v.split("\n"),0,$x,$Z),$n.text="";continue}$n.setCondition($c[0].substr($s+1),1),$n.text=$F.getWith("with"==$c[2]?$c[3]:null);break;case"#import":$G=($c=$$.splitToWords($v,null))[1],$x.push({node:$n,file:$$.includes[$G],ofs:$n.text.length});continue}}else{if(($W=$X.childs[$X.childs.length-1])&&!$W.name){0<$x.length&&$$.splitToWords($v,$W),$_=$n,$W.text+="\n"+$v;continue}0<$x.length&&$$.splitToWords($v,$n)}$n.setParent($X)}},$X.createShader=function($X,$g,$K){var $x={},$Z="";if($X)for(var $n in $X)$Z+="#define "+$n+"\n",$x[$n]=!0;var $W=this._VS.toscript($x,[]),$v=this._PS.toscript($x,[]);return($K||$hX.create)($Z+$W.join("\n"),$Z+$v.join("\n"),$g,this._nameMap)},$$._parseOne=function($X,$g,$K,$x,$Z,$n){var $W={type:$$.shaderParamsMap[$K[$x+1]],name:$K[$x+2],size:isNaN(parseInt($K[$x+3]))?1:parseInt($K[$x+3])};return $n&&("attribute"==$Z?$X.push($W):$g.push($W)),":"==$K[$x+3]&&($W.type=$K[$x+4],$x+=2),$x+=2},$$.addInclude=function($X,$g){if(!$g||0===$g.length)throw new Error("add shader include file err:"+$X);if($$.includes[$X])throw new Error("add shader include file err, has add:"+$X);$$.includes[$X]=new $K($g)},$$.preGetParams=function($X,$g){var $K=[$X,$g],$x={},$Z=[],$n=[],$W={},$v=[];$x.attributes=$Z,$x.uniforms=$n,$x.defines=$W;for(var $T=0,$G=0,$c=0;$c<2;$c++){$K[$c]=$K[$c].replace($$._removeAnnotation,"");var $_,$s=$K[$c].match($$._reg);for($T=0,$G=$s.length;$T<$G;$T++){var $V=$s[$T];if("attribute"==$V||"uniform"==$V)$T=$$._parseOne($Z,$n,$s,$T,$V,!0);else{if("#define"==$V){$v[$V=$s[++$T]]=1;continue}if("#ifdef"==$V){$W[$_=$s[++$T]]=$W[$_]||[];for($T++;$T<$G;$T++)if("attribute"==($V=$s[$T])||"uniform"==$V)$T=$$._parseOne($Z,$n,$s,$T,$V,$v[$_]);else if("#else"==$V)for($T++;$T<$G;$T++)if("attribute"==($V=$s[$T])||"uniform"==$V)$T=$$._parseOne($Z,$n,$s,$T,$V,!$v[$_]);else if("#endif"==$V)break}}}}return $x},$$.splitToWords=function($X,$g){for(var $K,$x,$Z=[],$n=-1,$W=0,$v=$X.length;$W<$v;$W++)if($K=$X.charAt($W),0<=" \t=+-*/&%!<>()'\",;".indexOf($K)){if(0<=$n&&1<$W-$n&&($x=$X.substr($n,$W-$n),$Z.push($x)),'"'==$K||"'"==$K){var $T=$X.indexOf($K,$W+1);if($T<0)throw"Sharder err:"+$X;$Z.push($X.substr($W+1,$T-$W-1)),$W=$T,$n=-1;continue}"("==$K&&$g&&0<$Z.length&&($x=$Z[$Z.length-1]+";","vec4;main;".indexOf($x)<0&&($g.useFuns+=$x)),$n=-1}else $n<0&&($n=$W);return $n<$v&&1<$v-$n&&($x=$X.substr($n,$v-$n),$Z.push($x)),$Z},$$.IFDEF_NO=0,$$.IFDEF_YES=1,$$.IFDEF_ELSE=2,$$.IFDEF_PARENT=3,$$._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),$$._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),$$._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),$$.includes={},$W($$,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),$$.__init$=function(){$U=function(){function $K($X){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=$X}$s($K,"");var $X=$K.prototype;return $X.setParent=function($X){$X.childs.push(this),this.z=$X.z+1,this.parent=$X},$X.setCondition=function($X,$g){$X&&(this.conditionType=$g,$X=$X.replace(/(\s*$)/g,""),this.condition=function(){return this[$X]},this.condition.__condition=$X)},$X.toscript=function($X,$g){return this._toscript($X,$g,++$K.__id)},$X._toscript=function($x,$Z,$n){if(this.childs.length<1&&!this.text)return $Z;$Z.length;if(this.condition){var $X=!!this.condition.call($x);if(2===this.conditionType&&($X=!$X),!$X)return $Z}if(this.text&&$Z.push(this.text),0<this.childs.length&&this.childs.forEach(function($X,$g,$K){$X._toscript($x,$Z,$n)}),0<this.includefiles.length&&0<this.useFuns.length)for(var $g,$K=0,$W=this.includefiles.length;$K<$W;$K++)this.includefiles[$K].curUseID!=$n&&0<($g=this.includefiles[$K].file.getFunsScript(this.useFuns)).length&&(this.includefiles[$K].curUseID=$n,$Z[0]=$g+$Z[0]);return $Z},$K.__id=1,$K}(),$K=function(){function $X($X){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=$X;for(var $g=0,$K=0,$x=0;!(($g=$X.indexOf("#begin",$g))<0);){for($x=$g+5;!(($x=$X.indexOf("#end",$x))<0)&&"i"===$X.charAt($x+4);)$x+=5;if($x<0)throw"add include err,no #end:"+$X;$K=$X.indexOf("\n",$g);var $Z=$$.splitToWords($X.substr($g,$K-$g),null);"code"==$Z[1]?this.codes[$Z[2]]=$X.substr($K+1,$x-$K-1):"function"==$Z[1]&&($K=$X.indexOf("function",$g),$K+="function".length,this.funs[$Z[3]]=$X.substr($K+1,$x-$K-1),this.funnames+=$Z[3]+";"),$g=$x+1}}$s($X,"");var $g=$X.prototype;return $g.getWith=function($X){var $g=$X?this.codes[$X]:this.script;if(!$g)throw"get with error:"+$X;return $g},$g.getFunsScript=function($X){var $g="";for(var $K in this.funs)0<=$X.indexOf($K+";")&&($g+=this.funs[$K]);return $g},$X}()},$$}(),$wX=function(){function $W(){}return $s($W,"laya.webgl.WebGL"),$W._uint8ArraySlice=function(){for(var $X=this.length,$g=new Uint8Array(this.length),$K=0;$K<$X;$K++)$g[$K]=this[$K];return $g},$W._float32ArraySlice=function(){for(var $X=this.length,$g=new Float32Array(this.length),$K=0;$K<$X;$K++)$g[$K]=this[$K];return $g},$W._uint16ArraySlice=function($X){var $g,$K=arguments,$x=0,$Z=0;if(0===$K.length)for($x=this.length,$g=new Uint16Array($x),$Z=0;$Z<$x;$Z++)$g[$Z]=this[$Z];else if(2===$K.length){var $n=$K[0],$W=$K[1];if($n<$W)for($x=$W-$n,$g=new Uint16Array($x),$Z=$n;$Z<$W;$Z++)$g[$Z-$n]=this[$Z];else $g=new Uint16Array(0)}return $g},$W.expandContext=function(){var $X=$Z.prototype,$g=CanvasRenderingContext2D.prototype;$g.fillTrangles=$X.fillTrangles,$zX.__int__(null),$g.setIBVB=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){void 0===$T&&($T=0),void 0===$G&&($G=0),null===$K&&(this._ib=this._ib||$HX.QuadrangleIB,$K=this._ib,$mX.expandIBQuadrangle($K,$x._byteLength/64+8)),this._setIBVB($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G)},$g.fillTrangles=function($X,$g,$K,$x,$Z){this._curMat=this._curMat||$i.create(),this._vb=this._vb||$yX.create(),this._ib||(this._ib=$HX.create(),$mX.fillIBQuadrangle(this._ib,$W/4));var $n=this._vb,$W=$x.length>>4;$mX.fillTranglesVB($n,$g,$K,$x,$Z||this._curMat,0,0),$mX.expandIBQuadrangle(this._ib,$n._byteLength/64+8);var $v=new $BX(1,0);$v.textureHost=$X;var $T=new $oX("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");$n._vertType=3,this._setIBVB($g,$K,this._ib,$n,6*$W,$Z,$T,$v,0,0)}},$W.enable=function(){if($V.__init__(),$F.isConchApp&&!$F.isConchWebGL)return $Q.skinAniSprite=function(){return new $XX},$W.expandContext(),!1;if($Q.getWebGLContext=function($X){for(var $g,$K=["webgl","experimental-webgl","webkit-3d","moz-webgl"],$x=0;$x<$K.length;$x++){try{$g=$X.getContext($K[$x],{stencil:$D.isStencil,alpha:$D.isAlpha,antialias:$D.isAntialias,premultipliedAlpha:$D.premultipliedAlpha,preserveDrawingBuffer:$D.preserveDrawingBuffer})}catch($X){}if($g)return $g}return null},null==($W.mainContext=$W.mainContext||$Q.getWebGLContext($F._mainCanvas)))return!1;if($F.isWebGL)return!0;$a.create=function($X,$g){return new $Xg($X,$g)},$m.create=function($X,$g,$K,$x,$Z,$n,$W){return new $dX($X,$g,$K,$x,$Z,$n,$W)},$F.WebGL=$W,$F.isWebGL=!0,$VX.__init__(),$Q.createRenderSprite=function($X,$g){return new $iX($X,$g)},$Q.createWebGLContext2D=function($X){return new $DX($X)},$Q.changeWebGLSize=function($X,$g){laya.webgl.WebGL.onStageResize($X,$g)},$Q.createGraphics=function(){return new $fX};var $X=$Q.createFilterAction;return $Q.createFilterAction=$X||function($X){return new $kX},$Q.clear=function($X){$UX.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var $g=$F.context.ctx,$K=0==$g._submits._length||$D.preserveDrawingBuffer?$A.create($X)._color:$t._wgColor;$K&&$g.clearBG($K[0],$K[1],$K[2],$K[3]),$UX.clear()},$Q.addToAtlas=function($X,$g){void 0===$g&&($g=!1);var $K=$X.bitmap;$F.optimizeTextureMemory($X.url,$X)?$f.__typeof($K,"laya.webgl.resource.IMergeAtlasBitmap")&&$K.allowMerageInAtlas&&$K.on("recovered",$X,$X.addTextureToAtlas):$K.enableMerageInAtlas=!1},$Q.isAtlas=function($X){return $X instanceof laya.webgl.atlas.AtlasWebGLCanvas},$u._enable(),$Q.beginFlush=function(){for(var $X=$u.instance,$g=$X.getAtlaserCount(),$K=0;$K<$g;$K++){var $x=$X.getAtlaserByIndex($K).texture;$x._flashCacheImageNeedFlush&&$Q.flashFlushImage($x)}},$Q.drawToCanvas=function($X,$g,$K,$x,$Z,$n){($K<=0||$x<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),$K|=0,$x|=0,$Z|=0,$n|=0;var $W=$pX.create($K,$x,6408,5121,0,!1);$W.start(),$W.clear(0,0,0,0),$F.context.clear(),$U.renders[$g]._fun($X,$F.context,$Z,$UX.height-$x+$n),$F.context.flush(),$W.end();var $v=$W.getData(0,0,$K,$x);if($W.recycle(),$v.byteLength==$K*$x*4){var $T=new $SX;$T._canvas=$V.createElement("canvas"),$T.size($K,$x);var $G=$T._canvas.getContext("2d");$V.canvas.size($K,$x);var $c=$V.context,$_=$c.createImageData($K,$x);return $_.data.set(new Uint8ClampedArray($v.buffer)),$T._imgData=$_,$c.putImageData($_,0,0),$G.save(),$G.translate(0,$x),$G.scale(1,-1),$G.drawImage($V.canvas.source,0,0),$G.restore(),$T}console.log("drawToCanvas error: w:"+$K+",h:"+$x+",datalen:"+$v.byteLength)},$Q.createFilterAction=function($X){var $g;switch($X){case 32:$g=new $kX}return $g},$Q.addTextureToAtlas=function($X){$X._uvID++,$u._atlasRestore++,$X.bitmap.enableMerageInAtlas&&$u.instance.addToAtlas($X)},$Q.getTexturePixels=function($X,$g,$K,$x,$Z){$F.context.ctx.clear();var $n=new $r;$n.graphics.drawTexture($X,-$g,-$K);var $W=$pX.create($x,$Z);$W.start(),$W.clear(0,0,0,0),$n.render($F.context,0,0),$F.context.ctx.flush(),$W.end();for(var $v=$W.getData(0,0,$x,$Z),$T=[],$G=0,$c=$Z-1;0<=$c;$c--)for(var $_=0;$_<$x;$_++)$G=4*($c*$x+$_),$T.push($v[$G]),$T.push($v[$G+1]),$T.push($v[$G+2]),$T.push($v[$G+3]);return $T},$Q.skinAniSprite=function(){return new $XX},$G.create=function($X,$g){var $K=new $SX;return $K._imgData=$g,$K.flipY=!1,$K},$B._filterStart=function($X,$g,$K,$x,$Z){var $n=$X.getValue("bounds"),$W=$pX.create($n.width,$n.height);if($W.start(),$W.clear(0,0,0,0),$X.addValue("src",$W),$X.addValue("ScissorTest",$UX.worldScissorTest),$UX.worldScissorTest){var $v=new $I;$v.copyFrom($K.ctx._clipRect),$X.addValue("clipRect",$v),$UX.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},$B._filterEnd=function($X,$g,$K,$x,$Z){var $n=$X.getValue("bounds");$X.getValue("src").end();var $W=$pX.create($n.width,$n.height);$W.start(),$W.clear(0,0,0,0),$X.addValue("out",$W),$g._set$P("_filterCache",$W),$g._set$P("_isHaveGlowFilter",$X.getValue("_isHaveGlowFilter"))},$B._EndTarget=function($X,$g){if($X.getValue("src").recycle(),$X.getValue("out").end(),$X.getValue("ScissorTest")){$UX.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),$g.ctx.save();var $K=$X.getValue("clipRect");$g.ctx.clipRect($K.x,$K.y,$K.width,$K.height)}},$B._useSrc=function($X){var $g=$X.getValue("out");$g.end(),($g=$X.getValue("src")).start(),$g.clear(0,0,0,0)},$B._endSrc=function($X){$X.getValue("src").end()},$B._useOut=function($X){var $g=$X.getValue("src");$g.end(),($g=$X.getValue("out")).start(),$g.clear(0,0,0,0)},$B._endOut=function($X){$X.getValue("out").end()},$B._recycleScope=function($X){$X.recycle()},$B._filter=function($X,$g,$K,$x){var $Z=this._next;if($Z){var $n,$W,$v=$X.filters,$T=$v.length;if(1==$T&&32==$v[0].type)return $g.ctx.save(),$g.ctx.setFilters([$v[0]]),$Z._fun.call($Z,$X,$g,$K,$x),void $g.ctx.restore();var $G=$vX.create(),$c=$k.TEMP,$_=$g.ctx._getTransformMatrix(),$s=$i.create();$_.copyTo($s);var $V=0,$A=0,$a=!1,$m=$X._$P._filterCache?$X._$P._filterCache:null;if(!$m||$X._repaint){$a=$X._isHaveGlowFilter(),$G.addValue("_isHaveGlowFilter",$a),$a&&($V=50,$A=25),($W=new $I).copyFrom($X.getSelfBounds()),$W.x+=$X.x,$W.y+=$X.y,$W.x-=$X.pivotX+4,$W.y-=$X.pivotY+4;var $F=$W.x,$U=$W.y;if($W.width+=$V+8,$W.height+=$V+8,$c.x=$W.x*$s.a+$W.y*$s.c,$c.y=$W.y*$s.d+$W.x*$s.b,$W.x=$c.x,$W.y=$c.y,$c.x=$W.width*$s.a+$W.height*$s.c,$c.y=$W.height*$s.d+$W.width*$s.b,$W.width=$c.x,$W.height=$c.y,$W.width<=0||$W.height<=0)return;$m&&$m.recycle(),$G.addValue("bounds",$W);var $$=$WX.create([$G,$X,$g,0,0],$B._filterStart);$g.addRenderObject($$),$g.ctx._renderKey=0,$g.ctx._shader2D.glTexture=null;var $w=$X.x-$F+$A,$Q=$X.y-$U+$A;$Z._fun.call($Z,$X,$g,$w,$Q),$$=$WX.create([$G,$X,$g,0,0],$B._filterEnd),$g.addRenderObject($$);for(var $f=0;$f<$T;$f++){0!=$f&&($$=$WX.create([$G],$B._useSrc),$g.addRenderObject($$),$n=$BX.create(1,0),$i.TEMP.identity(),$g.ctx.drawTarget($G,0,0,$W.width,$W.height,$i.TEMP,"out",$n,null,$e.TOINT.overlay),$$=$WX.create([$G],$B._useOut),$g.addRenderObject($$)),$v[$f].action.apply3d($G,$X,$g,0,0)}$$=$WX.create([$G,$g],$B._EndTarget),$g.addRenderObject($$)}else{if(($a=!!$X._$P._isHaveGlowFilter&&$X._$P._isHaveGlowFilter)&&($V=50,$A=25),($W=$X.getBounds()).width<=0||$W.height<=0)return;$W.width+=$V,$W.height+=$V,$c.x=$W.x*$s.a+$W.y*$s.c,$c.y=$W.y*$s.d+$W.x*$s.b,$W.x=$c.x,$W.y=$c.y,$c.x=$W.width*$s.a+$W.height*$s.c,$c.y=$W.height*$s.d+$W.width*$s.b,$W.width=$c.x,$W.height=$c.y,$G.addValue("out",$m)}$K=$K-$A-$X.x,$x=$x-$A-$X.y,$c.setTo($K,$x),$s.transformPoint($c),$K=$c.x+$W.x,$x=$c.y+$W.y,$n=$BX.create(1,0),$i.TEMP.identity(),$g.ctx.drawTarget($G,$K,$x,$W.width,$W.height,$i.TEMP,"out",$n,null,$e.TOINT.overlay),$$=$WX.create([$G],$B._recycleScope),$g.addRenderObject($$),$s.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=$W._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=$W._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=$W._uint8ArraySlice),!0},$W.onStageResize=function($X,$g){null!=$W.mainContext&&($W.mainContext.viewport(0,0,$X,$g),$UX.width=$X,$UX.height=$g)},$W.onInvalidGLRes=function(){$u.instance.freeAll(),$w.releaseContentManagers(!0),$W.doNodeRepaint($f.stage),$W.mainContext.viewport(0,0,$UX.width,$UX.height),$f.stage.event("devicelost")},$W.doNodeRepaint=function($X){0==$X.numChildren&&$X.repaint();for(var $g=0;$g<$X.numChildren;$g++)$W.doNodeRepaint($X.getChildAt($g))},$W.init=function($X,$g,$K){$W.mainCanvas=$X,$G._createContext=function($X){return new $DX($X)},$SX._createContext=function($X){return new $DX($X)};var $x=laya.webgl.WebGL.mainContext;if(null!=$x.getShaderPrecisionFormat){var $Z=$x.getShaderPrecisionFormat(35633,36338),$n=$x.getShaderPrecisionFormat(35632,36338);$W.shaderHighPrecision=!(!$Z.precision||!$n.precision)}else $W.shaderHighPrecision=!1;if($W.compressAstc=$x.getExtension("WEBGL_compressed_texture_astc"),$W.compressAtc=$x.getExtension("WEBGL_compressed_texture_atc"),$W.compressEtc=$x.getExtension("WEBGL_compressed_texture_etc"),$W.compressEtc1=$x.getExtension("WEBGL_compressed_texture_etc1"),$W.compressPvrtc=$x.getExtension("WEBGL_compressed_texture_pvrtc"),$W.compressS3tc=$x.getExtension("WEBGL_compressed_texture_s3tc"),$W.compressS3tc_srgb=$x.getExtension("WEBGL_compressed_texture_s3tc_srgb"),$W.compressAstc=$W.compressAstc?$W.compressAstc:{},$W.compressAtc=$W.compressAtc?$W.compressAtc:{},$W.compressEtc=$W.compressEtc?$W.compressEtc:{},$W.compressEtc1=$W.compressEtc1?$W.compressEtc1:{},$W.compressPvrtc=$W.compressPvrtc?$W.compressPvrtc:{},$W.compressS3tc=$W.compressS3tc?$W.compressS3tc:{},$W.compressS3tc_srgb=$W.compressS3tc_srgb?$W.compressS3tc_srgb:{},$x.deleteTexture1=$x.deleteTexture,$x.deleteTexture=function($X){$X==$QX.curBindTexValue&&($QX.curBindTexValue=null),$x.deleteTexture1($X)},$W.onStageResize($g,$K),null==$W.mainContext)throw new Error("webGL getContext err!");$N.__init__(),$u.__init__(),$rX.__init__(),$nX.__init__(),$DX.__init__(),$BX.__init__(),$H.__init__(),$zX.__int__($x),$e._init_($x),$F.isConchApp&&conch.setOnInvalidGLRes($W.onInvalidGLRes)},$W.mainCanvas=null,$W.antialias=!0,$W.shaderHighPrecision=!1,$W._bg_null=[0,0,0,0],$W}(),$QX=function(){function $x(){}return $s($x,"laya.webgl.WebGLContext"),$x.UseProgram=function($X){return $x._useProgram!==$X&&($wX.mainContext.useProgram($X),$x._useProgram=$X,!0)},$x.setDepthTest=function($X,$g){$g!==$x._depthTest&&(($x._depthTest=$g)?$X.enable(2929):$X.disable(2929))},$x.setDepthMask=function($X,$g){$g!==$x._depthMask&&($x._depthMask=$g,$X.depthMask($g))},$x.setDepthFunc=function($X,$g){$g!==$x._depthFunc&&($x._depthFunc=$g,$X.depthFunc($g))},$x.setBlend=function($X,$g){$g!==$x._blend&&(($x._blend=$g)?$X.enable(3042):$X.disable(3042))},$x.setBlendFunc=function($X,$g,$K){($g!==$x._sFactor||$K!==$x._dFactor)&&($x._sFactor=$g,$x._dFactor=$K,$X.blendFunc($g,$K))},$x.setCullFace=function($X,$g){$g!==$x._cullFace&&(($x._cullFace=$g)?$X.enable(2884):$X.disable(2884))},$x.setFrontFace=function($X,$g){$g!==$x._frontFace&&($x._frontFace=$g,$X.frontFace($g))},$x.bindTexture=function($X,$g,$K){$X.bindTexture($g,$K),$x.curBindTexTarget=$g,$x.curBindTexValue=$K},$x.DEPTH_BUFFER_BIT=256,$x.STENCIL_BUFFER_BIT=1024,$x.COLOR_BUFFER_BIT=16384,$x.POINTS=0,$x.LINES=1,$x.LINE_LOOP=2,$x.LINE_STRIP=3,$x.TRIANGLES=4,$x.TRIANGLE_STRIP=5,$x.TRIANGLE_FAN=6,$x.ZERO=0,$x.ONE=1,$x.SRC_COLOR=768,$x.ONE_MINUS_SRC_COLOR=769,$x.SRC_ALPHA=770,$x.ONE_MINUS_SRC_ALPHA=771,$x.DST_ALPHA=772,$x.ONE_MINUS_DST_ALPHA=773,$x.DST_COLOR=774,$x.ONE_MINUS_DST_COLOR=775,$x.SRC_ALPHA_SATURATE=776,$x.FUNC_ADD=32774,$x.BLEND_EQUATION=32777,$x.BLEND_EQUATION_RGB=32777,$x.BLEND_EQUATION_ALPHA=34877,$x.FUNC_SUBTRACT=32778,$x.FUNC_REVERSE_SUBTRACT=32779,$x.BLEND_DST_RGB=32968,$x.BLEND_SRC_RGB=32969,$x.BLEND_DST_ALPHA=32970,$x.BLEND_SRC_ALPHA=32971,$x.CONSTANT_COLOR=32769,$x.ONE_MINUS_CONSTANT_COLOR=32770,$x.CONSTANT_ALPHA=32771,$x.ONE_MINUS_CONSTANT_ALPHA=32772,$x.BLEND_COLOR=32773,$x.ARRAY_BUFFER=34962,$x.ELEMENT_ARRAY_BUFFER=34963,$x.ARRAY_BUFFER_BINDING=34964,$x.ELEMENT_ARRAY_BUFFER_BINDING=34965,$x.STREAM_DRAW=35040,$x.STATIC_DRAW=35044,$x.DYNAMIC_DRAW=35048,$x.BUFFER_SIZE=34660,$x.BUFFER_USAGE=34661,$x.CURRENT_VERTEX_ATTRIB=34342,$x.FRONT=1028,$x.BACK=1029,$x.CULL_FACE=2884,$x.FRONT_AND_BACK=1032,$x.BLEND=3042,$x.DITHER=3024,$x.STENCIL_TEST=2960,$x.DEPTH_TEST=2929,$x.SCISSOR_TEST=3089,$x.POLYGON_OFFSET_FILL=32823,$x.SAMPLE_ALPHA_TO_COVERAGE=32926,$x.SAMPLE_COVERAGE=32928,$x.NO_ERROR=0,$x.INVALID_ENUM=1280,$x.INVALID_VALUE=1281,$x.INVALID_OPERATION=1282,$x.OUT_OF_MEMORY=1285,$x.CW=2304,$x.CCW=2305,$x.LINE_WIDTH=2849,$x.ALIASED_POINT_SIZE_RANGE=33901,$x.ALIASED_LINE_WIDTH_RANGE=33902,$x.CULL_FACE_MODE=2885,$x.FRONT_FACE=2886,$x.DEPTH_RANGE=2928,$x.DEPTH_WRITEMASK=2930,$x.DEPTH_CLEAR_VALUE=2931,$x.DEPTH_FUNC=2932,$x.STENCIL_CLEAR_VALUE=2961,$x.STENCIL_FUNC=2962,$x.STENCIL_FAIL=2964,$x.STENCIL_PASS_DEPTH_FAIL=2965,$x.STENCIL_PASS_DEPTH_PASS=2966,$x.STENCIL_REF=2967,$x.STENCIL_VALUE_MASK=2963,$x.STENCIL_WRITEMASK=2968,$x.STENCIL_BACK_FUNC=34816,$x.STENCIL_BACK_FAIL=34817,$x.STENCIL_BACK_PASS_DEPTH_FAIL=34818,$x.STENCIL_BACK_PASS_DEPTH_PASS=34819,$x.STENCIL_BACK_REF=36003,$x.STENCIL_BACK_VALUE_MASK=36004,$x.STENCIL_BACK_WRITEMASK=36005,$x.VIEWPORT=2978,$x.SCISSOR_BOX=3088,$x.COLOR_CLEAR_VALUE=3106,$x.COLOR_WRITEMASK=3107,$x.UNPACK_ALIGNMENT=3317,$x.PACK_ALIGNMENT=3333,$x.MAX_TEXTURE_SIZE=3379,$x.MAX_VIEWPORT_DIMS=3386,$x.SUBPIXEL_BITS=3408,$x.RED_BITS=3410,$x.GREEN_BITS=3411,$x.BLUE_BITS=3412,$x.ALPHA_BITS=3413,$x.DEPTH_BITS=3414,$x.STENCIL_BITS=3415,$x.POLYGON_OFFSET_UNITS=10752,$x.POLYGON_OFFSET_FACTOR=32824,$x.TEXTURE_BINDING_2D=32873,$x.SAMPLE_BUFFERS=32936,$x.SAMPLES=32937,$x.SAMPLE_COVERAGE_VALUE=32938,$x.SAMPLE_COVERAGE_INVERT=32939,$x.NUM_COMPRESSED_TEXTURE_FORMATS=34466,$x.COMPRESSED_TEXTURE_FORMATS=34467,$x.DONT_CARE=4352,$x.FASTEST=4353,$x.NICEST=4354,$x.GENERATE_MIPMAP_HINT=33170,$x.BYTE=5120,$x.UNSIGNED_BYTE=5121,$x.SHORT=5122,$x.UNSIGNED_SHORT=5123,$x.INT=5124,$x.UNSIGNED_INT=5125,$x.FLOAT=5126,$x.DEPTH_COMPONENT=6402,$x.ALPHA=6406,$x.RGB=6407,$x.RGBA=6408,$x.LUMINANCE=6409,$x.LUMINANCE_ALPHA=6410,$x.UNSIGNED_SHORT_4_4_4_4=32819,$x.UNSIGNED_SHORT_5_5_5_1=32820,$x.UNSIGNED_SHORT_5_6_5=33635,$x.FRAGMENT_SHADER=35632,$x.VERTEX_SHADER=35633,$x.MAX_VERTEX_ATTRIBS=34921,$x.MAX_VERTEX_UNIFORM_VECTORS=36347,$x.MAX_VARYING_VECTORS=36348,$x.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,$x.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,$x.MAX_TEXTURE_IMAGE_UNITS=34930,$x.MAX_FRAGMENT_UNIFORM_VECTORS=36349,$x.SHADER_TYPE=35663,$x.DELETE_STATUS=35712,$x.LINK_STATUS=35714,$x.VALIDATE_STATUS=35715,$x.ATTACHED_SHADERS=35717,$x.ACTIVE_UNIFORMS=35718,$x.ACTIVE_ATTRIBUTES=35721,$x.SHADING_LANGUAGE_VERSION=35724,$x.CURRENT_PROGRAM=35725,$x.NEVER=512,$x.LESS=513,$x.EQUAL=514,$x.LEQUAL=515,$x.GREATER=516,$x.NOTEQUAL=517,$x.GEQUAL=518,$x.ALWAYS=519,$x.KEEP=7680,$x.REPLACE=7681,$x.INCR=7682,$x.DECR=7683,$x.INVERT=5386,$x.INCR_WRAP=34055,$x.DECR_WRAP=34056,$x.VENDOR=7936,$x.RENDERER=7937,$x.VERSION=7938,$x.NEAREST=9728,$x.LINEAR=9729,$x.NEAREST_MIPMAP_NEAREST=9984,$x.LINEAR_MIPMAP_NEAREST=9985,$x.NEAREST_MIPMAP_LINEAR=9986,$x.LINEAR_MIPMAP_LINEAR=9987,$x.TEXTURE_MAG_FILTER=10240,$x.TEXTURE_MIN_FILTER=10241,$x.TEXTURE_WRAP_S=10242,$x.TEXTURE_WRAP_T=10243,$x.TEXTURE_2D=3553,$x.TEXTURE=5890,$x.TEXTURE_CUBE_MAP=34067,$x.TEXTURE_BINDING_CUBE_MAP=34068,$x.TEXTURE_CUBE_MAP_POSITIVE_X=34069,$x.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,$x.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,$x.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,$x.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,$x.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,$x.MAX_CUBE_MAP_TEXTURE_SIZE=34076,$x.TEXTURE0=33984,$x.TEXTURE1=33985,$x.TEXTURE2=33986,$x.TEXTURE3=33987,$x.TEXTURE4=33988,$x.TEXTURE5=33989,$x.TEXTURE6=33990,$x.TEXTURE7=33991,$x.TEXTURE8=33992,$x.TEXTURE9=33993,$x.TEXTURE10=33994,$x.TEXTURE11=33995,$x.TEXTURE12=33996,$x.TEXTURE13=33997,$x.TEXTURE14=33998,$x.TEXTURE15=33999,$x.TEXTURE16=34e3,$x.TEXTURE17=34001,$x.TEXTURE18=34002,$x.TEXTURE19=34003,$x.TEXTURE20=34004,$x.TEXTURE21=34005,$x.TEXTURE22=34006,$x.TEXTURE23=34007,$x.TEXTURE24=34008,$x.TEXTURE25=34009,$x.TEXTURE26=34010,$x.TEXTURE27=34011,$x.TEXTURE28=34012,$x.TEXTURE29=34013,$x.TEXTURE30=34014,$x.TEXTURE31=34015,$x.ACTIVE_TEXTURE=34016,$x.REPEAT=10497,$x.CLAMP_TO_EDGE=33071,$x.MIRRORED_REPEAT=33648,$x.FLOAT_VEC2=35664,$x.FLOAT_VEC3=35665,$x.FLOAT_VEC4=35666,$x.INT_VEC2=35667,$x.INT_VEC3=35668,$x.INT_VEC4=35669,$x.BOOL=35670,$x.BOOL_VEC2=35671,$x.BOOL_VEC3=35672,$x.BOOL_VEC4=35673,$x.FLOAT_MAT2=35674,$x.FLOAT_MAT3=35675,$x.FLOAT_MAT4=35676,$x.SAMPLER_2D=35678,$x.SAMPLER_CUBE=35680,$x.VERTEX_ATTRIB_ARRAY_ENABLED=34338,$x.VERTEX_ATTRIB_ARRAY_SIZE=34339,$x.VERTEX_ATTRIB_ARRAY_STRIDE=34340,$x.VERTEX_ATTRIB_ARRAY_TYPE=34341,$x.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,$x.VERTEX_ATTRIB_ARRAY_POINTER=34373,$x.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,$x.COMPILE_STATUS=35713,$x.LOW_FLOAT=36336,$x.MEDIUM_FLOAT=36337,$x.HIGH_FLOAT=36338,$x.LOW_INT=36339,$x.MEDIUM_INT=36340,$x.HIGH_INT=36341,$x.FRAMEBUFFER=36160,$x.RENDERBUFFER=36161,$x.RGBA4=32854,$x.RGB5_A1=32855,$x.RGB565=36194,$x.DEPTH_COMPONENT16=33189,$x.STENCIL_INDEX=6401,$x.STENCIL_INDEX8=36168,$x.DEPTH_STENCIL=34041,$x.RENDERBUFFER_WIDTH=36162,$x.RENDERBUFFER_HEIGHT=36163,$x.RENDERBUFFER_INTERNAL_FORMAT=36164,$x.RENDERBUFFER_RED_SIZE=36176,$x.RENDERBUFFER_GREEN_SIZE=36177,$x.RENDERBUFFER_BLUE_SIZE=36178,$x.RENDERBUFFER_ALPHA_SIZE=36179,$x.RENDERBUFFER_DEPTH_SIZE=36180,$x.RENDERBUFFER_STENCIL_SIZE=36181,$x.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,$x.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,$x.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,$x.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,$x.COLOR_ATTACHMENT0=36064,$x.DEPTH_ATTACHMENT=36096,$x.STENCIL_ATTACHMENT=36128,$x.DEPTH_STENCIL_ATTACHMENT=33306,$x.NONE=0,$x.FRAMEBUFFER_COMPLETE=36053,$x.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,$x.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,$x.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,$x.FRAMEBUFFER_UNSUPPORTED=36061,$x.FRAMEBUFFER_BINDING=36006,$x.RENDERBUFFER_BINDING=36007,$x.MAX_RENDERBUFFER_SIZE=34024,$x.INVALID_FRAMEBUFFER_OPERATION=1286,$x.UNPACK_FLIP_Y_WEBGL=37440,$x.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,$x.CONTEXT_LOST_WEBGL=37442,$x.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,$x.BROWSER_DEFAULT_WEBGL=37444,$x._useProgram=null,$x._depthTest=!0,$x._depthMask=!0,$x._blend=!1,$x._cullFace=!1,$x.curBindTexTarget=null,$x.curBindTexValue=null,$W($x,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),$x}(),$fX=function($X){function $g(){$g.__super.call(this)}$s($g,"laya.webgl.display.GraphicsGL",$v);var $K=$g.prototype;return $K.setShader=function($X){this._saveToCmd($F.context._setShader,[$X])},$K.setIBVB=function($X,$g,$K,$x,$Z,$n){this._saveToCmd($F.context._setIBVB,[$X,$g,$K,$x,$Z,$n])},$K.drawParticle=function($X,$g,$K){var $x=$Q.createParticleTemplate2D($K);$x.x=$X,$x.y=$g,this._saveToCmd($F.context._drawParticle,[$x])},$g}(),$DX=function($X){var $K;function $E($X){this._x=0,this._y=0,this._id=++$E._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,$E.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=$E.MAXCLIPRECT,this.mOutPoint,this._canvas=$X,this._canvas._addReference(),$E._contextcount++,$F.isFlash?(this._ib=$HX.create(35044),$mX.fillIBQuadrangle(this._ib,16)):this._ib=$HX.QuadrangleIB,this.clear()}$s($E,"laya.webgl.canvas.WebGLContext2D",$Z);var $g=$E.prototype;return $g.setIsMainContext=function(){this._isMain=!0},$g.clearBG=function($X,$g,$K,$x){var $Z=$wX.mainContext;$Z.clearColor($X,$g,$K,$x),$Z.clear(16384)},$g._getSubmits=function(){return this._submits},$g._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var $X=0,$g=this._submits._length;$X<$g;$X++)this._submits[$X].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},$g.destroy=function(){--$E._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=$HX.QuadrangleIB&&this._ib.releaseResource()},$g.clear=function(){this._submits||(this._other=$K.DEFAULT,this._curMat=$i.create(),this._vb=$yX.create(-1),this._submits=[],this._save=[$h.Create(this)],this._save.length=10,this._shader2D=new $H,this._triangleMesh=$YX.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=$K.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=$E.MAXCLIPRECT,this._curSubmit=$nX.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=$b.DEFAULT;for(var $X=0,$g=this._submits._length;$X<$g;$X++)this._submits[$X].releaseRender(),this._submits[$X]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},$g.size=function($X,$g){if(this._width!=$X||this._height!=$g)if(0==$X||0==$g){0!=this._vb._byteLength&&(this._width=$X,this._height=$g,this._vb.clear(),this._vb.upload());for(var $K=0,$x=this._submits._length;$K<$x;$K++)this._submits[$K].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=$X,this._height=$g,this._targets&&this._targets.size($X,$g),this._canvas.memorySize-=this._canvas.memorySize;0===$X&&0===$g&&this._releaseMem()},$g._getTransformMatrix=function(){return this._curMat},$g.translate=function($X,$g){0===$X&&0===$g||($J.save(this),this._curMat.bTransform&&($z.save(this),this._curMat.transformPointN($k.TEMP.setTo($X,$g)),$X=$k.TEMP.x,$g=$k.TEMP.y),this._x+=$X,this._y+=$g)},$g.save=function(){this._save[this._save._length++]=$h.Create(this)},$g.restore=function(){var $X=this._save._length;if(!($X<1))for(var $g=$X-1;0<=$g;$g--){var $K=this._save[$g];if($K.restore(this),$K.isSaveMark())return void(this._save._length=$g)}},$g._fillText=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){void 0===$G&&($G=0);var $c=this._shader2D,$_=this._curSubmit.shaderValue,$s=$Z?$AX.create($Z):this._other.font;if($u.enabled)$c.ALPHA!==$_.ALPHA&&($c.glTexture=null),$VX.drawText(this,$X,$g,this._curMat,$s,$T||this._other.textAlign,$n,$W,$v,$K,$x,$G);else{this._shader2D.defines.getValue();var $V=$n?$A.create($n)._color:$c.colorAdd;$c.ALPHA===$_.ALPHA&&$V===$c.colorAdd&&$_.colorAdd===$c.colorAdd||($c.glTexture=null,$c.colorAdd=$V),$VX.drawText(this,$X,$g,this._curMat,$s,$T||this._other.textAlign,$n,$W,$v,$K,$x,$G)}},$g.fillWords=function($X,$g,$K,$x,$Z,$n){this._fillText(null,$X,$g,$K,$x,$Z,null,-1,null,$n)},$g.fillBorderWords=function($X,$g,$K,$x,$Z,$n,$W){this._fillBorderText(null,$X,$g,$K,$x,$Z,$n,$W,null)},$g.fillText=function($X,$g,$K,$x,$Z,$n){this._fillText($X,null,$g,$K,$x,$Z,null,-1,$n)},$g.strokeText=function($X,$g,$K,$x,$Z,$n,$W){this._fillText($X,null,$g,$K,$x,null,$Z,$n||1,$W)},$g.fillBorderText=function($X,$g,$K,$x,$Z,$n,$W,$v){this._fillBorderText($X,null,$g,$K,$x,$Z,$n,$W,$v)},$g._fillBorderText=function($X,$g,$K,$x,$Z,$n,$W,$v,$T){if(!$u.enabled)return this._fillText($X,$g,$K,$x,$Z,null,$W,$v||1,$T),void this._fillText($X,$g,$K,$x,$Z,$n,null,-1,$T);var $G=this._shader2D,$c=this._curSubmit.shaderValue;$G.ALPHA!==$c.ALPHA&&($G.glTexture=null);var $_=$Z?($E._fontTemp.setFont($Z),$E._fontTemp):this._other.font;$VX.drawText(this,$X,$g,this._curMat,$_,$T||this._other.textAlign,$n,$W,$v||1,$K,$x,0)},$g.fillRect=function($X,$g,$K,$x,$Z){var $n=this._vb;if($mX.fillRectImgVb($n,this._clipRect,$X,$g,$K,$x,$Y.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $W=this._shader2D.fillStyle;$Z&&(this._shader2D.fillStyle=$b.create($Z));var $v=this._shader2D,$T=this._curSubmit.shaderValue;if($v.fillStyle!==$T.fillStyle||$v.ALPHA!==$T.ALPHA){$v.glTexture=null;var $G=this._curSubmit=$nX.createSubmit(this,this._ib,$n,($n._byteLength-64)/32*3,$BX.create(2,0));$G.shaderValue.color=$v.fillStyle._color._color,$G.shaderValue.ALPHA=$v.ALPHA,this._submits[this._submits._length++]=$G}this._curSubmit._numEle+=6,this._shader2D.fillStyle=$W}},$g.fillTexture=function($X,$g,$K,$x,$Z,$n,$W,$v){if($X.loaded&&$X.bitmap&&$X.source){var $T=this._vb,$G=$X.bitmap.width,$c=$X.bitmap.height,$_=$X.uv,$s=$W.x%$X.width,$V=$W.y%$X.height;if($G!=$v.w||$c!=$v.h){if(!$v.w&&!$v.h)switch($v.oy=$v.ox=0,$n){case"repeat":$v.width=$x,$v.height=$Z;break;case"repeat-x":$v.width=$x,$V<0?$X.height+$V>$Z?$v.height=$Z:$v.height=$X.height+$V:($v.oy=$V,$X.height+$V>$Z?$v.height=$Z-$V:$v.height=$X.height);break;case"repeat-y":$s<0?$X.width+$s>$x?$v.width=$x:$v.width=$X.width+$s:($v.ox=$s,$X.width+$s>$x?$v.width=$x-$s:$v.width=$X.width),$v.height=$Z;break;case"no-repeat":$s<0?$X.width+$s>$x?$v.width=$x:$v.width=$X.width+$s:($v.ox=$s,$X.width+$s>$x?$v.width=$x-$s:$v.width=$X.width),$V<0?$X.height+$V>$Z?$v.height=$Z:$v.height=$X.height+$V:($v.oy=$V,$X.height+$V>$Z?$v.height=$Z-$V:$v.height=$X.height);break;default:$v.width=$x,$v.height=$Z}$v.w=$G,$v.h=$c,$v.uv=[0,0,$v.width/$G,0,$v.width/$G,$v.height/$c,0,$v.height/$c]}if($g+=$v.ox,$K+=$v.oy,$s-=$v.ox,$V-=$v.oy,$mX.fillRectImgVb($T,this._clipRect,$g,$K,$v.width,$v.height,$v.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $A=$CX.create(this,this._ib,$T,($T._byteLength-64)/32*3,$BX.create(256,0)),$a=(this._submits[this._submits._length++]=$A).shaderValue;$a.textureHost=$X;var $m=$_[0]*$G,$F=$_[1]*$c,$U=($_[2]-$_[0])*$G,$$=($_[5]-$_[3])*$c,$w=-$s/$G,$Q=-$V/$c;$a.u_TexRange[0]=$m/$G,$a.u_TexRange[1]=$U/$G,$a.u_TexRange[2]=$F/$c,$a.u_TexRange[3]=$$/$c,$a.u_offset[0]=$w,$a.u_offset[1]=$Q,$u.enabled&&!this._isMain&&$A.addTexture($X,($T._byteLength>>2)-16),(this._curSubmit=$A)._renderType=10017,$A._numEle+=6}}else this.sprite&&$f.timer.callLater(this,this._repaintSprite)},$g.setShader=function($X){$R.save(this,1048576,this._shader2D,!0),this._shader2D.shader=$X},$g.setFilters=function($X){$R.save(this,2097152,this._shader2D,!0),this._shader2D.filters=$X,this._curSubmit=$nX.RENDERBASE,this._renderKey=0,this._drawCount++},$g.drawTexture=function($X,$g,$K,$x,$Z,$n,$W){this._drawTextureM($X,$g,$K,$x,$Z,$n,$W,null,1)},$g.addTextureVb=function($X,$g,$K){var $x=this._curSubmit._vb||this._vb,$Z=$x._byteLength>>2;$x.byteLength=$Z+16<<2;for(var $n=$x.getFloat32Array(),$W=0;$W<16;$W+=4)$n[$Z++]=$X[$W]+$g,$n[$Z++]=$X[$W+1]+$K,$n[$Z++]=$X[$W+2],$n[$Z++]=$X[$W+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),$x._upload=!0},$g.willDrawTexture=function($X,$g){if(!($X.loaded&&$X.bitmap&&$X.source))return this.sprite&&$f.timer.callLater(this,this._repaintSprite),0;var $K=$X.bitmap,$x=$K.id+this._shader2D.ALPHA*$g+10016;if($x==this._renderKey)return $x;var $Z=this._shader2D,$n=$Z.ALPHA,$W=this._curSubmit.shaderValue;$Z.ALPHA*=$g,this._renderKey=$x,this._drawCount++,$Z.glTexture=$K;var $v=this._vb,$T=null,$G=$v._byteLength/32*3,$c=$W.textureHost&&$W.textureHost==$X&&$W.textureHost.alphaTexture==$X.alphaTexture;return $T=$CX.create(this,this._ib,$v,$G,$BX.create(1,0)),(this._submits[this._submits._length++]=$T).shaderValue.textureHost=$X,$T._renderType=10016,$T._preIsSameTextureShader=10016===this._curSubmit._renderType&&$Z.ALPHA===$W.ALPHA&&$c,this._curSubmit=$T,$Z.ALPHA=$n,$x},$g.drawTextures=function($X,$g,$K,$x){if($X.loaded&&$X.bitmap&&$X.source){var $Z=this._clipRect;if(this._clipRect=$E.MAXCLIPRECT,this._drawTextureM($X,$g[0],$g[1],$X.width,$X.height,$K,$x,null,1)){if(this._clipRect=$Z,$M.drawCall++,!($g.length<4)){for(var $n=this._curSubmit._vb||this._vb,$W=this._curMat.a,$v=this._curMat.d,$T=2,$G=$g.length;$T<$G;$T+=2)$mX.copyPreImgVb($n,($g[$T]-$g[$T-2])*$W,($g[$T+1]-$g[$T-1])*$v),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&$f.timer.callLater(this,this._repaintSprite)},$g._drawTextureM=function($X,$g,$K,$x,$Z,$n,$W,$v,$T){if(!$X.loaded||!$X.source)return this.sprite&&$f.timer.callLater(this,this._repaintSprite),!1;var $G=this._curSubmit._vb||this._vb,$c=$X.bitmap;$g+=$n,$K+=$W,this._drawCount++;var $_=$c.id+this._shader2D.ALPHA*$T+10016;if($_!=this._renderKey){this._renderKey=$_;var $s=this._curSubmit.shaderValue,$V=this._shader2D,$A=$V.ALPHA;$V.ALPHA*=$T,$V.glTexture=$c;var $a=this._vb,$m=null,$F=$a._byteLength/32*3,$U=$s.textureHost&&$s.textureHost==$X&&$s.textureHost.alphaTexture==$X.alphaTexture;$m=$CX.create(this,this._ib,$a,$F,$BX.create(1,0)),(this._submits[this._submits._length++]=$m).shaderValue.textureHost=$X,$m._renderType=10016,$m._preIsSameTextureShader=10016===this._curSubmit._renderType&&$V.ALPHA===$s.ALPHA&&$U,this._curSubmit=$m,$G=this._curSubmit._vb||this._vb,$V.ALPHA=$A}return!!$mX.fillRectImgVb($G,this._clipRect,$g,$K,$x||$X.width,$Z||$X.height,$X.uv,$v||this._curMat,this._x,this._y,0,0)&&($u.enabled&&!this._isMain&&this._curSubmit.addTexture($X,($G._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},$g._repaintSprite=function(){this.sprite&&this.sprite.repaint()},$g._drawText=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){var $c=$X.bitmap;this._drawCount++;var $_=$c.id+this._shader2D.ALPHA+10016;if($_!=this._renderKey){this._renderKey=$_;var $s=this._curSubmit.shaderValue,$V=this._shader2D;$V.glTexture=$c;var $A=this._vb,$a=null,$m=$A._byteLength/32*3,$F=$s.textureHost&&$s.textureHost==$X&&$s.textureHost.alphaTexture==$X.alphaTexture;($a=$u.enabled?$CX.create(this,this._ib,$A,$m,$BX.create(1,0)):$CX.create(this,this._ib,$A,$m,$JX.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&$V.ALPHA===$s.ALPHA&&$F,(this._submits[this._submits._length++]=$a).shaderValue.textureHost=$X,$a._renderType=10016,this._curSubmit=$a}$X.active();var $U=this._curSubmit._vb||this._vb;$mX.fillRectImgVb($U,this._clipRect,$g+$W,$K+$v,$x||$X.width,$Z||$X.height,$X.uv,$n||this._curMat,this._x,this._y,$T,$G,!0)&&($u.enabled&&!this._isMain&&this._curSubmit.addTexture($X,($U._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},$g.drawTextureWithTransform=function($X,$g,$K,$x,$Z,$n,$W,$v,$T){if($n){var $G=this._curMat,$c=this._x,$_=this._y;(0!==$W||0!==$v)&&(this._x=$W*$G.a+$v*$G.c,this._y=$v*$G.d+$W*$G.b),$n&&$G.bTransform?($i.mul($n,$G,$E._tmpMatrix),($n=$E._tmpMatrix)._checkTransform()):(this._x+=$G.tx,this._y+=$G.ty),this._drawTextureM($X,$g,$K,$x,$Z,0,0,$n,$T),this._x=$c,this._y=$_}else this._drawTextureM($X,$g,$K,$x,$Z,$W,$v,null,$T)},$g.fillQuadrangle=function($X,$g,$K,$x,$Z){var $n=this._curSubmit,$W=this._vb,$v=this._shader2D,$T=$n.shaderValue;if(this._renderKey=0,$X.bitmap){var $G=$X.bitmap;$v.glTexture==$G&&$v.ALPHA===$T.ALPHA||($v.glTexture=$G,($n=this._curSubmit=$nX.createSubmit(this,this._ib,$W,$W._byteLength/32*3,$BX.create(1,0))).shaderValue.glTexture=$G,this._submits[this._submits._length++]=$n),$mX.fillQuadrangleImgVb($W,$g,$K,$x,$X.uv,$Z||this._curMat,this._x,this._y)}else $n.shaderValue.fillStyle&&$n.shaderValue.fillStyle.equal($X)&&$v.ALPHA===$T.ALPHA||($v.glTexture=null,($n=this._curSubmit=$nX.createSubmit(this,this._ib,$W,$W._byteLength/32*3,$BX.create(2,0))).shaderValue.defines.add(2),$n.shaderValue.fillStyle=$b.create($X),this._submits[this._submits._length++]=$n),$mX.fillQuadrangleImgVb($W,$g,$K,$x,$Y.DEF_UV,$Z||this._curMat,this._x,this._y);$n._numEle+=6},$g.drawTexture2=function($X,$g,$K,$x,$Z,$n,$W,$v){if(0!=$n){var $T=this._curMat;if(this._x=$X*$T.a+$g*$T.c,this._y=$g*$T.d+$X*$T.b,$Z&&($Z=$T.bTransform||$Z.bTransform?($i.mul($Z,$T,$E._tmpMatrix),$E._tmpMatrix):(this._x+=$Z.tx+$T.tx,this._y+=$Z.ty+$T.ty,$i.EMPTY)),1!==$n||$W){var $G=this._shader2D.ALPHA,$c=this._nBlendType;this._shader2D.ALPHA=$n,$W&&(this._nBlendType=$e.TOINT($W)),this._drawTextureM($v[0],$v[1]-$K,$v[2]-$x,$v[3],$v[4],0,0,$Z,1),this._shader2D.ALPHA=$G,this._nBlendType=$c}else this._drawTextureM($v[0],$v[1]-$K,$v[2]-$x,$v[3],$v[4],0,0,$Z,1);this._x=this._y=0}},$g.drawCanvas=function($X,$g,$K,$x,$Z){var $n=$X.context;if(this._renderKey=0,$n._targets)this._submits[this._submits._length++]=$NX.create($n,0,null),this._curSubmit=$nX.RENDERBASE,$n._targets.drawTo(this,$g,$K,$x,$Z);else{var $W=this._submits[this._submits._length++]=$NX.create($n,this._shader2D.ALPHA,this._shader2D.filters),$v=$x/$X.width,$T=$Z/$X.height,$G=$W._matrix;this._curMat.copyTo($G),1!=$v&&1!=$T&&$G.scale($v,$T);var $c=$G.tx,$_=$G.ty;$G.tx=$G.ty=0,$G.transformPoint($k.TEMP.setTo($g,$K)),$G.translate($k.TEMP.x+$c,$k.TEMP.y+$_),this._curSubmit=$nX.RENDERBASE}$D.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=$n._targets?"yellow":"green",this.strokeRect($g-1,$K-1,$x+2,$Z+2,1),this.strokeRect($g,$K,$x,$Z,1),this.restore())},$g.drawTarget=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){void 0===$G&&($G=-1);var $c=this._vb;if($mX.fillRectImgVb($c,this._clipRect,$g,$K,$x,$Z,$T||$Y.DEF_UV,$n||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var $_=this._curSubmit=$_X.create(this,this._ib,$c,($c._byteLength-64)/32*3,$v,$W);$_.blendType=-1==$G?this._nBlendType:$G,$_.scope=$X,this._submits[this._submits._length++]=$_,this._curSubmit._numEle+=6}},$g.mixRGBandAlpha=function($X){return this._mixRGBandAlpha($X,this._shader2D.ALPHA)},$g._mixRGBandAlpha=function($X,$g){var $K=(4278190080&$X)>>>24;return 0!=$K?$K*=$g:$K=255*$g,16777215&$X|$K<<24},$g.drawTriangles=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){if(!$X.loaded||!$X.source)return this.sprite&&$f.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;$X.bitmap;var $c=this._mixRGBandAlpha(4294967295,$v),$_=($x.length,$n.length);this._renderKey=-1;var $s=this._curSubmit=$CX.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,$BX.create(1,0));return $s.shaderValue.textureHost=$X,$s._renderType=10016,this._submits[this._submits._length++]=$s,$W?($E._tmpMatrix.a=$W.a,$E._tmpMatrix.b=$W.b,$E._tmpMatrix.c=$W.c,$E._tmpMatrix.d=$W.d,$E._tmpMatrix.tx=$W.tx+$g,$E._tmpMatrix.ty=$W.ty+$K,$i.mul($E._tmpMatrix,this._curMat,$E._tmpMatrix)):($E._tmpMatrix.a=this._curMat.a,$E._tmpMatrix.b=this._curMat.b,$E._tmpMatrix.c=this._curMat.c,$E._tmpMatrix.d=this._curMat.d,$E._tmpMatrix.tx=this._curMat.tx+$g,$E._tmpMatrix.ty=this._curMat.ty+$K),this._triangleMesh.addData($x,$Z,$n,$E._tmpMatrix,$c,this),this._curSubmit._numEle+=$_,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},$g.transform=function($X,$g,$K,$x,$Z,$n){$z.save(this),$i.mul($i.TEMP.setTo($X,$g,$K,$x,$Z,$n),this._curMat,this._curMat),this._curMat._checkTransform()},$g.setTransformByMatrix=function($X){$X.copyTo(this._curMat)},$g.transformByMatrix=function($X){$z.save(this),$i.mul($X,this._curMat,this._curMat),this._curMat._checkTransform()},$g.rotate=function($X){$z.save(this),this._curMat.rotateEx($X)},$g.scale=function($X,$g){$z.save(this),this._curMat.scaleEx($X,$g)},$g.clipRect=function($X,$g,$K,$x){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var $Z=$cX.create(4);this.addRenderObject($Z);var $n=this._vb,$W=$n._byteLength>>2;if($mX.fillRectImgVb($n,null,$X,$g,$K,$x,$Y.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var $v=this._curSubmit=$nX.createSubmit(this,this._ib,$n,($n._byteLength-64)/32*3,$BX.create(2,0));$v.shaderValue.ALPHA=1,this._submits[this._submits._length++]=$v,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var $T=$cX.create(5);this.addRenderObject($T);var $G=$n.getFloat32Array(),$c=Math.min(Math.min(Math.min($G[0+$W],$G[4+$W]),$G[8+$W]),$G[12+$W]),$_=Math.max(Math.max(Math.max($G[0+$W],$G[4+$W]),$G[8+$W]),$G[12+$W]),$s=Math.min(Math.min(Math.min($G[1+$W],$G[5+$W]),$G[9+$W]),$G[13+$W]),$V=Math.max(Math.max(Math.max($G[1+$W],$G[5+$W]),$G[9+$W]),$G[13+$W]);$d.save(this,$T,$X,$g,$K,$x,$c,$s,$_-$c,$V-$s),this._curSubmit=$nX.RENDERBASE}else{$K*=this._curMat.a,$x*=this._curMat.d;var $A=$k.TEMP;this._curMat.transformPoint($A.setTo($X,$g)),$K<0&&($A.x=$A.x+$K,$K=-$K),$x<0&&($A.y=$A.y+$x,$x=-$x),this._renderKey=0;var $a=this._curSubmit=$GX.create(this);(this._submits[this._submits._length++]=$a).submitIndex=this._submits._length,$a.submitLength=9999999,$j.save(this,$a);var $m=this._clipRect,$F=$m.x,$U=$m.y,$$=$A.x+$K,$w=$A.y+$x;$F<$A.x&&($m.x=$A.x),$U<$A.y&&($m.y=$A.y),$m.width=Math.min($$,$F+$m.width)-$m.x,$m.height=Math.min($w,$U+$m.height)-$m.y,this._shader2D.glTexture=null,$a.clipRect.copyFrom($m),this._curSubmit=$nX.RENDERBASE}},$g.setIBVB=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c){if(void 0===$T&&($T=0),void 0===$G&&($G=0),void 0===$c&&($c=0),null===$K){if($F.isFlash){var $_=$x;$_._selfIB||($_._selfIB=$HX.create(35044)),$_._selfIB.clear(),$K=$_._selfIB}else $K=this._ib;$mX.expandIBQuadrangle($K,$x._byteLength/(4*$x.vertexStride*4))}if(!$v||!$W)throw Error("setIBVB must input:shader shaderValues");var $s=$TX.create(this,$x,$K,$Z,$W,$v,$T,$G,$c);$n||($n=$i.EMPTY),$n.translate($X,$g),$i.mul($n,this._curMat,$s._mat),$n.translate(-$X,-$g),this._submits[this._submits._length++]=$s,this._curSubmit=$nX.RENDERBASE,this._renderKey=0},$g.addRenderObject=function($X){this._submits[this._submits._length++]=$X},$g.fillTrangles=function($X,$g,$K,$x,$Z){var $n=this._curSubmit,$W=this._vb,$v=this._shader2D,$T=$n.shaderValue,$G=$x.length>>4,$c=$X.bitmap;this._renderKey=0,$v.glTexture==$c&&$v.ALPHA===$T.ALPHA||(($n=this._curSubmit=$nX.createSubmit(this,this._ib,$W,$W._byteLength/32*3,$BX.create(1,0))).shaderValue.textureHost=$X,this._submits[this._submits._length++]=$n),$mX.fillTranglesVB($W,$g,$K,$x,$Z||this._curMat,this._x,this._y),$n._numEle+=6*$G},$g.submitElement=function($X,$g){var $K=this._submits;for($g<0&&($g=$K._length);$X<$g;)$X+=$K[$X].renderSubmit()},$g.finish=function(){$wX.mainContext.finish()},$g.flush=function(){var $X=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if($X>this._ib.bufferLength/12&&$mX.expandIBQuadrangle(this._ib,$X),!this._isMain&&$u.enabled&&$u._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=$u._atlasRestore;for(var $g=this._submits,$K=0,$x=$g._length;$K<$x;$K++){var $Z=$g[$K];10016===$Z.getRenderType()&&$Z.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),$gX.instance&&$gX.getInstance().reset();var $n;for($K=0,$n=this.meshlist.length;$K<$n;$K++){var $W=this.meshlist[$K];$W.canReuse?$W.releaseMesh():$W.destroy()}return this.meshlist.length=0,this._curSubmit=$nX.RENDERBASE,this._renderKey=0,this._triangleMesh=$YX.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},$g.setPathId=function($X){if(this.mId=$X,-1!=this.mId){this.mHaveKey=!1;var $g=$p.getInstance();$g.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,$g.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},$g.movePath=function($X,$g){var $K=$X,$x=$g;$X=this._curMat.a*$K+this._curMat.c*$x+this._curMat.tx,$g=this._curMat.b*$K+this._curMat.d*$x+this._curMat.ty,this.mX+=$X,this.mY+=$g},$g.beginPath=function(){var $X=this._getPath();$X.tempArray.length=0,$X.closePath=!1,this.mX=0,this.mY=0},$g.closePath=function(){this._path.closePath=!0},$g.fill=function($X){void 0===$X&&($X=!1);var $g=this._getPath();this.drawPoly(0,0,$g.tempArray,this.fillStyle._color.numColor,0,0,$X)},$g.stroke=function(){var $X=this._getPath();if(0<this.lineWidth){if(-1==this.mId)$X.drawLine(0,0,$X.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var $g=$p.getInstance().shapeLineDic[this.mId];$g.rebuild($X.tempArray),$X.setGeomtry($g)}else $p.getInstance().addLine(this.mId,$X.drawLine(0,0,$X.tempArray,this.lineWidth,this.strokeStyle._color.numColor));$X.update();var $K=[this.mX,this.mY],$x=$nX.createShape(this,$X.ib,$X.vb,$X.count,$X.offset,$BX.create(4,0));$x.shaderValue.ALPHA=this._shader2D.ALPHA,$x.shaderValue.u_pos=$K,$x.shaderValue.u_mmat2=$UX.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=$x,this._renderKey=-1}},$g.line=function($X,$g,$K,$x,$Z,$n){var $W=this._curSubmit,$v=this._vb;if($mX.fillLineVb($v,this._clipRect,$X,$g,$K,$x,$Z,$n)){this._renderKey=0;var $T=this._shader2D,$G=$W.shaderValue;$T.strokeStyle===$G.strokeStyle&&$T.ALPHA===$G.ALPHA||($T.glTexture=null,($W=this._curSubmit=$nX.createSubmit(this,this._ib,$v,($v._byteLength-64)/32*3,$BX.create(2,0))).shaderValue.strokeStyle=$T.strokeStyle,$W.shaderValue.mainID=2,$W.shaderValue.ALPHA=$T.ALPHA,this._submits[this._submits._length++]=$W),$W._numEle+=6}},$g.moveTo=function($X,$g,$K){void 0===$K&&($K=!0);var $x=this._getPath();if($K){var $Z=$X,$n=$g;$X=this._curMat.a*$Z+this._curMat.c*$n,$g=this._curMat.b*$Z+this._curMat.d*$n}$x.addPoint($X,$g)},$g.lineTo=function($X,$g,$K){void 0===$K&&($K=!0);var $x=this._getPath();if($K){var $Z=$X,$n=$g;$X=this._curMat.a*$Z+this._curMat.c*$n,$g=this._curMat.b*$Z+this._curMat.d*$n}$x.addPoint($X,$g)},$g.drawCurves=function($X,$g,$K){this.setPathId(-1),this.beginPath(),this.strokeStyle=$K[3],this.lineWidth=$K[4];var $x=$K[2];$X+=$K[0],$g+=$K[1],this.movePath($X,$g),this.moveTo($x[0],$x[1]);for(var $Z=2,$n=$x.length;$Z<$n;)this.quadraticCurveTo($x[$Z++],$x[$Z++],$x[$Z++],$x[$Z++]);this.stroke()},$g.arcTo=function($X,$g,$K,$x,$Z){if(-1==this.mId||!this.mHaveKey){var $n=0,$W=0,$v=0,$T=this._getPath();this._curMat.copyTo($E._tmpMatrix),$E._tmpMatrix.tx=$E._tmpMatrix.ty=0,$E._tempPoint.setTo($T.getEndPointX(),$T.getEndPointY()),$E._tmpMatrix.invertTransformPoint($E._tempPoint);var $G=$E._tempPoint.x-$X,$c=$E._tempPoint.y-$g,$_=Math.sqrt($G*$G+$c*$c);if(!($_<=1e-6)){var $s=$G/$_,$V=$c/$_,$A=$K-$X,$a=$x-$g,$m=$A*$A+$a*$a,$F=Math.sqrt($m);if(!($F<=1e-6)){var $U=$A/$F,$$=$a/$F,$w=$s+$U,$Q=$V+$$,$f=Math.sqrt($w*$w+$Q*$Q);if(!($f<=1e-6)){var $D=$w/$f,$B=$Q/$f,$i=Math.acos($D*$s+$B*$V),$k=Math.PI/2-$i,$I=($_=$Z/Math.tan($k))*$s+$X,$r=$_*$V+$g,$t=Math.sqrt($_*$_+$Z*$Z),$M=$X+$D*$t,$P=$g+$B*$t,$N=0,$C=0;if(0<=$s*$$-$V*$U){var $Y=2*$k/$E.SEGNUM;$N=Math.sin($Y),$C=Math.cos($Y)}else $Y=2*-$k/$E.SEGNUM,$N=Math.sin($Y),$C=Math.cos($Y);$W=this._curMat.a*$I+this._curMat.c*$r,$v=this._curMat.b*$I+this._curMat.d*$r,$W==this._path.getEndPointX()&&$v==this._path.getEndPointY()||$T.addPoint($W,$v);var $l=$I-$M,$p=$r-$P;for($n=0;$n<$E.SEGNUM;$n++){var $L=$l*$C+$p*$N,$q=-$l*$N+$p*$C;$W=$L+$M,$v=$q+$P,$X=this._curMat.a*$W+this._curMat.c*$v,$v=$g=this._curMat.b*$W+this._curMat.d*$v,($W=$X)==this._path.getEndPointX()&&$v==this._path.getEndPointY()||$T.addPoint($W,$v),$l=$L,$p=$q}}}}}},$g.arc=function($X,$g,$K,$x,$Z,$n,$W){if(void 0===$n&&($n=!1),void 0===$W&&($W=!0),-1!=this.mId){var $v=$p.getInstance().shapeDic[this.mId];if($v&&this.mHaveKey&&!$v.needUpdate(this._curMat))return;$g=$X=0}var $T,$G=0,$c=0,$_=0,$s=0,$V=0,$A=0,$a=0;if($c=$Z-$x,$n)if(Math.abs($c)>=2*Math.PI)$c=2*-Math.PI;else for(;0<$c;)$c-=2*Math.PI;else if(Math.abs($c)>=2*Math.PI)$c=2*Math.PI;else for(;$c<0;)$c+=2*Math.PI;$T=$c/($a=$K<101?Math.max(10,$c*$K/5):$K<201?Math.max(10,$c*$K/20):Math.max(10,$c*$K/40))/2,$_=Math.abs(4/3*(1-Math.cos($T))/Math.sin($T)),$n&&($_=-$_);var $m=this._getPath(),$F=NaN,$U=NaN;for($A=0;$A<=$a;$A++)$G=$x+$c*($A/$a),$s=$X+Math.cos($G)*$K,$V=$g+Math.sin($G)*$K,$W&&($F=$s,$U=$V,$s=this._curMat.a*$F+this._curMat.c*$U,$V=this._curMat.b*$F+this._curMat.d*$U),$s==this._path.getEndPointX()&&$V==this._path.getEndPointY()||$m.addPoint($s,$V);$s=$X+Math.cos($Z)*$K,$V=$g+Math.sin($Z)*$K,$W&&($F=$s,$U=$V,$s=this._curMat.a*$F+this._curMat.c*$U,$V=this._curMat.b*$F+this._curMat.d*$U),$s==this._path.getEndPointX()&&$V==this._path.getEndPointY()||$m.addPoint($s,$V)},$g.quadraticCurveTo=function($X,$g,$K,$x){var $Z=$_.I,$n=$K,$W=$x;$K=this._curMat.a*$n+this._curMat.c*$W,$x=this._curMat.b*$n+this._curMat.d*$W,$n=$X,$W=$g,$X=this._curMat.a*$n+this._curMat.c*$W,$g=this._curMat.b*$n+this._curMat.d*$W;for(var $v=$Z.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),$X,$g,$K,$x],30,2),$T=0,$G=$v.length/2;$T<$G;$T++)this.lineTo($v[2*$T],$v[2*$T+1],!1);this.lineTo($K,$x,!1)},$g.rect=function($X,$g,$K,$x){this._other=this._other.make(),this._other.path||(this._other.path=new $S),this._other.path.rect($X,$g,$K,$x)},$g.strokeRect=function($X,$g,$K,$x,$Z){var $n=.5*$Z;this.line($X-$n,$g,$X+$K+$n,$g,$Z,this._curMat),this.line($X+$K,$g,$X+$K,$g+$x,$Z,this._curMat),this.line($X,$g,$X,$g+$x,$Z,this._curMat),this.line($X-$n,$g+$x,$X+$K+$n,$g+$x,$Z,this._curMat)},$g.clip=function(){},$g.drawPoly=function($X,$g,$K,$x,$Z,$n,$W){void 0===$W&&($W=!1),this._renderKey=0,this._shader2D.glTexture=null;var $v=this._getPath();if(-1==this.mId)$v.polygon($X,$g,$K,$x,$Z||1,$n);else if(this.mHaveKey){var $T=$p.getInstance().shapeDic[this.mId];$T.setMatrix(this._curMat),$T.rebuild($v.tempArray),$v.setGeomtry($T)}else{var $G=$v.polygon($X,$g,$K,$x,$Z||1,$n);$p.getInstance().addShape(this.mId,$G),$G.setMatrix(this._curMat)}$v.update();var $c,$_=[this.mX,this.mY];if(($c=$nX.createShape(this,$v.ib,$v.vb,$v.count,$v.offset,$BX.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$c.shaderValue.u_pos=$_,$c.shaderValue.u_mmat2=$UX.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$c,0<$Z){if(this.mHaveLineKey){var $s=$p.getInstance().shapeLineDic[this.mId];$s.rebuild($v.tempArray),$v.setGeomtry($s)}else $p.getInstance().addShape(this.mId,$v.drawLine($X,$g,$K,$Z,$n));$v.update(),($c=$nX.createShape(this,$v.ib,$v.vb,$v.count,$v.offset,$BX.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$c.shaderValue.u_mmat2=$UX.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$c}},$g.drawParticle=function($X,$g,$K){$K.x=$X,$K.y=$g,this._submits[this._submits._length++]=$K},$g._getPath=function(){return this._path||(this._path=new $S)},$x(0,$g,"globalCompositeOperation",function(){return $e.NAMES[this._nBlendType]},function($X){var $g=$e.TOINT[$X];null==$g||this._nBlendType===$g||($R.save(this,65536,this,!0),this._curSubmit=$nX.RENDERBASE,this._renderKey=0,this._nBlendType=$g)}),$x(0,$g,"strokeStyle",function(){return this._shader2D.strokeStyle},function($X){this._shader2D.strokeStyle.equal($X)||($R.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=$b.create($X))}),$x(0,$g,"globalAlpha",function(){return this._shader2D.ALPHA},function($X){($X=Math.floor(1e3*$X)/1e3)!=this._shader2D.ALPHA&&($R.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=$X)}),$x(0,$g,"asBitmap",null,function($X){if($X){if(this._targets||(this._targets=new $o),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),$x(0,$g,"fillStyle",function(){return this._shader2D.fillStyle},function($X){this._shader2D.fillStyle.equal($X)||($R.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=$b.create($X))}),$x(0,$g,"textAlign",function(){return this._other.textAlign},function($X){this._other.textAlign===$X||(this._other=this._other.make(),$R.save(this,32768,this._other,!1),this._other.textAlign=$X)}),$x(0,$g,"lineWidth",function(){return this._other.lineWidth},function($X){this._other.lineWidth===$X||(this._other=this._other.make(),$R.save(this,256,this._other,!1),this._other.lineWidth=$X)}),$x(0,$g,"textBaseline",function(){return this._other.textBaseline},function($X){this._other.textBaseline===$X||(this._other=this._other.make(),$R.save(this,16384,this._other,!1),this._other.textBaseline=$X)}),$x(0,$g,"font",null,function($X){$X!=this._other.font.toString()&&(this._other=this._other.make(),$R.save(this,8,this._other,!1),this._other.font===$AX.EMPTY?this._other.font=new $AX($X):this._other.font.setFont($X))}),$E.__init__=function(){$K.DEFAULT=new $K},$E._tempPoint=new $k,$E._SUBMITVBSIZE=32e3,$E._MAXSIZE=99999999,$E._RECTVBSIZE=16,$E.MAXCLIPRECT=new $I(0,0,99999999,99999999),$E._COUNT=0,$E._tmpMatrix=new $i,$E.SEGNUM=32,$E._contextcount=0,$W($E,["_fontTemp",function(){return this._fontTemp=new $AX},"_drawStyleTemp",function(){return this._drawStyleTemp=new $b(null)}]),$E.__init$=function(){$K=function(){function $X(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=$AX.EMPTY}$s($X,"");var $g=$X.prototype;return $g.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=$AX.EMPTY},$g.make=function(){return this===$X.DEFAULT?new $X:this},$X.DEFAULT=null,$X}()},$E}(),$BX=function($X){function $x($X,$g){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,$x.__super.call(this),this.defines=new $rX,this.position=$x._POSITION,this.mainID=$X,this.subID=$g,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=$X|$g,this._inClassCache=$x._cache[this._cacheID],0<$X&&!this._inClassCache&&(this._inClassCache=$x._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}$s($x,"laya.webgl.shader.d2.value.Value2D",$q);var $g=$x.prototype;return $g.setValue=function($X){},$g.refresh=function(){var $X=this.size;return $X[0]=$UX.width,$X[1]=$UX.height,this.alpha=this.ALPHA*$UX.worldAlpha,this.mmat=$UX.worldMatrix4,this},$g._ShaderWithCompile=function(){return $hX.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,$oX.create)},$g._withWorldShaderDefines=function(){var $X=$UX.worldShaderDefines,$g=$hX.sharders[this.mainID|this.defines._value|$X.getValue()];if(!$g){var $K,$x={};for($K in this.defines.toNameDic())$x[$K]="";for($K in $X.toNameDic())$x[$K]="";$g=$hX.withCompile2D(0,this.mainID,$x,this.mainID|this.defines._value|$X.getValue(),$oX.create)}var $Z=$UX.worldFilters;if(!$Z)return $g;for(var $n,$W=$Z.length,$v=0;$v<$W;$v++)($n=$Z[$v])&&$n.action.setValue(this);return $g},$g.upload=function(){var $X=$UX;this.alpha=this.ALPHA*$X.worldAlpha,$UX.worldMatrix4!==$UX.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),$wX.shaderHighPrecision&&this.defines.add(1024);var $g,$K=$X.worldShaderDefines?this._withWorldShaderDefines():$hX.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=$X.width,this.size[1]=$X.height,this.mmat=$X.worldMatrix4,$lX.activeShader!==$K?$K._shaderValueWidth!==$X.width||$K._shaderValueHeight!==$X.height?($K._shaderValueWidth=$X.width,$K._shaderValueHeight=$X.height):$g=$K._params2dQuick2||$K._make2dQuick2():$K._shaderValueWidth!==$X.width||$K._shaderValueHeight!==$X.height?($K._shaderValueWidth=$X.width,$K._shaderValueHeight=$X.height):$g=$K._params2dQuick1||$K._make2dQuick1(),$K.upload(this,$g)},$g.setFilters=function($X){if(this.filters=$X)for(var $g,$K=$X.length,$x=0;$x<$K;$x++)($g=$X[$x])&&(this.defines.add($g.type),$g.action.setValue(this))},$g.clear=function(){this.defines.setValue(this.subID)},$g.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},$x._initone=function($X,$g){$x._typeClass[$X]=$g,$x._cache[$X]=[],$x._cache[$X]._length=0},$x.__init__=function(){$x._POSITION=[2,5126,!1,4*$aX.BYTES_PE,0],$x._TEXCOORD=[2,5126,!1,4*$aX.BYTES_PE,2*$aX.BYTES_PE],$x._initone(2,$EX),$x._initone(4,$eX),$x._initone(256,$uX),$x._initone(512,$qX),$x._initone(1,$OX),$x._initone(65,$JX),$x._initone(9,$OX)},$x.create=function($X,$g){var $K=$x._cache[$X|$g];return $K._length?$K[--$K._length]:new $x._typeClass[$X|$g]($g)},$x._POSITION=null,$x._TEXCOORD=null,$x._cache=[],$x._typeClass=[],$x.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$x}(),$iX=function($X){function $m($X,$g){$m.__super.call(this,$X,$g)}$s($m,"laya.webgl.utils.RenderSprite3D",$U);var $g=$m.prototype;return $g.onCreate=function($X){switch($X){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},$g._mask=function($X,$g,$K,$x){var $Z,$n,$W=this._next,$v=$X.mask;if($v){$g.ctx.save();var $T=$g.ctx.globalCompositeOperation,$G=new $I;if($G.copyFrom($v.getBounds()),$G.width=Math.round($G.width),$G.height=Math.round($G.height),$G.x=Math.round($G.x),$G.y=Math.round($G.y),0<$G.width&&0<$G.height){var $c=$X._style._tf,$_=$vX.create();$_.addValue("bounds",$G),$Z=$WX.create([$_,$g],laya.webgl.utils.RenderSprite3D.tmpTarget),$g.addRenderObject($Z),$v.render($g,-$G.x,-$G.y),$Z=$WX.create([$_],laya.webgl.utils.RenderSprite3D.endTmpTarget),$g.addRenderObject($Z),$g.ctx.save(),$g.clipRect($K-$c.translateX+$G.x,$x-$c.translateY+$G.y,$G.width,$G.height),$W._fun.call($W,$X,$g,$K,$x),$g.ctx.restore(),$n=$cX.create(6),$T=$g.ctx.globalCompositeOperation,$n.blendMode="mask",$g.addRenderObject($n),$i.TEMP.identity();var $s=$BX.create(1,0),$V=$Y.INV_UV,$A=$G.width,$a=$G.height;($G.width<32||$G.height<32)&&(($V=$m.tempUV)[0]=0,$V[1]=0,$V[2]=32<=$G.width?1:$G.width/32,$V[3]=0,$V[4]=32<=$G.width?1:$G.width/32,$V[5]=32<=$G.height?1:$G.height/32,$V[6]=0,$V[7]=32<=$G.height?1:$G.height/32,$G.width=32<=$G.width?$G.width:32,$G.height=32<=$G.height?$G.height:32,$V[1]*=-1,$V[3]*=-1,$V[5]*=-1,$V[7]*=-1,$V[1]+=1,$V[3]+=1,$V[5]+=1,$V[7]+=1),$g.ctx.drawTarget($_,$K+$G.x-$c.translateX,$x+$G.y-$c.translateY,$A,$a,$i.TEMP,"tmpTarget",$s,$V,6),$Z=$WX.create([$_],laya.webgl.utils.RenderSprite3D.recycleTarget),$g.addRenderObject($Z),($n=$cX.create(6)).blendMode=$T,$g.addRenderObject($n)}$g.ctx.restore()}else $W._fun.call($W,$X,$g,$K,$x)},$g._blend=function($X,$g,$K,$x){var $Z=$X._style,$n=this._next;$Z.blendMode?($g.ctx.save(),$g.ctx.globalCompositeOperation=$Z.blendMode,$n._fun.call($n,$X,$g,$K,$x),$g.ctx.restore()):$n._fun.call($n,$X,$g,$K,$x)},$g._transform=function($X,$g,$K,$x){var $Z=$X.transform,$n=this._next;if($Z&&$n!=$U.NORENDER){var $W=$g.ctx;$X._style;$Z.tx=$K,$Z.ty=$x;var $v=$W._getTransformMatrix(),$T=$v.clone();$i.mul($Z,$v,$v),$v._checkTransform(),$Z.tx=$Z.ty=0,$n._fun.call($n,$X,$g,0,0),$T.copyTo($v),$T.destroy()}else $n._fun.call($n,$X,$g,$K,$x)},$m.tmpTarget=function($X,$g){var $K=$X.getValue("bounds"),$x=$pX.create($K.width,$K.height);$x.start(),$x.clear(0,0,0,0),$X.addValue("tmpTarget",$x)},$m.endTmpTarget=function($X){$X.getValue("tmpTarget").end()},$m.recycleTarget=function($X){$X.getValue("tmpTarget").recycle(),$X.recycle()},$W($m,["tempUV",function(){return this.tempUV=new Array(8)}]),$m}(),$kX=function($X){function $g(){this.data=null,$g.__super.call(this)}$s($g,"laya.filters.webgl.ColorFilterActionGL",$L);var $K=$g.prototype;return $f.imps($K,{"laya.filters.IFilterActionGL":!0}),$K.setValue=function($X){$X.colorMat=this.data._mat,$X.colorAlpha=this.data._alpha},$K.apply3d=function($X,$g,$K,$x,$Z){var $n=$X.getValue("bounds"),$W=$BX.create(1,0);$W.setFilters([this.data]);var $v=$i.TEMP;$v.identity(),$K.ctx.drawTarget($X,0,0,$n.width,$n.height,$v,"src",$W)},$g}(),$IX=function($X){function $n($X,$g,$K,$x,$Z){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,$n.__super.call(this,$X,$g,$Z),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new $bX,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=$K,this._atlasCanvas.height=$x,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}$s($n,"laya.webgl.atlas.Atlaser",$E);var $g=$n.prototype;return $g.computeUVinAtlasTexture=function($X,$g,$K,$x){var $Z=$u.atlasTextureWidth,$n=$u.atlasTextureHeight,$W=$K/$Z,$v=$x/$n,$T=($K+$X.bitmap.width)/$Z,$G=($x+$X.bitmap.height)/$n,$c=$X.bitmap.width/$Z,$_=$X.bitmap.height/$n;$X.uv=[$W+$g[0]*$c,$v+$g[1]*$_,$T-(1-$g[2])*$c,$v+$g[3]*$_,$T-(1-$g[4])*$c,$G-(1-$g[5])*$_,$W+$g[6]*$c,$G-(1-$g[7])*$_]},$g.findBitmapIsExist=function($X){if($X instanceof laya.webgl.resource.WebGLImage){var $g=$X,$K=$g.url,$x=this._InAtlasWebGLImagesKey[$K||$g.id];if($x)return $x.offsetInfoID}return-1},$g.addToAtlasTexture=function($X,$g,$K){if($X instanceof laya.webgl.resource.WebGLImage){var $x=$X,$Z=$x.url;this._InAtlasWebGLImagesKey[$Z||$x.id]={bitmap:$X,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([$g,$K])}this._atlasCanvas.texSubImage2D($g,$K,$X.atlasSource),$X.clearAtlasSource()},$g.addToAtlas=function($X,$g,$K){$X._atlasID=this._inAtlasTextureKey.length;var $x=$X.uv.slice(),$Z=$X.bitmap;this._inAtlasTextureKey.push($X),this._inAtlasTextureOriUVValue.push($x),this._inAtlasTextureBitmapValue.push($Z),this.computeUVinAtlasTexture($X,$x,$g,$K),$X.bitmap=this._atlasCanvas},$g.clear=function(){for(var $X=0,$g=this._inAtlasTextureKey.length;$X<$g;$X++)this._inAtlasTextureKey[$X].bitmap=this._inAtlasTextureBitmapValue[$X],this._inAtlasTextureKey[$X].uv=this._inAtlasTextureOriUVValue[$X],this._inAtlasTextureKey[$X]._atlasID=-1,this._inAtlasTextureKey[$X].bitmap.lock=!1,this._inAtlasTextureKey[$X].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},$g.dispose=function(){this.clear(),this._atlasCanvas.destroy()},$x(0,$g,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),$x(0,$g,"texture",function(){return this._atlasCanvas}),$x(0,$g,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),$n}(),$rX=function($X){function $K(){$K.__super.call(this,$K.__name2int,$K.__int2name,$K.__int2nameMap)}return $s($K,"laya.webgl.shader.d2.ShaderDefines2D",$y),$K.__init__=function(){$K.reg("TEXTURE2D",1),$K.reg("COLOR2D",2),$K.reg("PRIMITIVE",4),$K.reg("GLOW_FILTER",8),$K.reg("BLUR_FILTER",16),$K.reg("COLOR_FILTER",32),$K.reg("COLOR_ADD",64),$K.reg("WORLDMAT",128),$K.reg("FILLTEXTURE",256),$K.reg("FSHIGHPRECISION",1024),$K.reg("TXTALPHA",2048),$K.reg("TXTCOMPRESS",4096)},$K.reg=function($X,$g){$y._reg($X,$g,$K.__name2int,$K.__int2name)},$K.toText=function($X,$g,$K){return $y._toText($X,$g,$K)},$K.toInt=function($X){return $y._toInt($X,$K.__name2int)},$K.TEXTURE2D=1,$K.COLOR2D=2,$K.PRIMITIVE=4,$K.FILTERGLOW=8,$K.FILTERBLUR=16,$K.FILTERCOLOR=32,$K.COLORADD=64,$K.WORLDMAT=128,$K.FILLTEXTURE=256,$K.SKINMESH=512,$K.SHADERDEFINE_FSHIGHPRECISION=1024,$K.TXTALPHA=2048,$K.TXTCOMPRESS=4096,$K.__name2int={},$K.__int2name=[],$K.__int2nameMap=[],$K}(),$tX=(function($X){function $v($X,$g,$K,$x,$Z,$n,$W){$v.__super.call(this,$X,$g,$K,$x,40,$Z,$n,$W)}$s($v,"laya.webgl.shapes.Ellipse",$KX)}(),function($X){function $n($X,$g,$K,$x,$Z){this._points=[],this.rebuild($K),$n.__super.call(this,$X,$g,0,0,0,$Z,$x,$Z,0)}$s($n,"laya.webgl.shapes.Line",$KX);var $g=$n.prototype;return $g.rebuild=function($X){var $g=$X.length;$g!=this._points.length&&(this.mUint16Array=new Uint16Array(6*($g/2-1)),this.mFloat32Array=new Float32Array(5*$g)),this._points.length=0;for(var $K=NaN,$x=NaN,$Z=-1,$n=-1,$W=$X.length/2,$v=0;$v<$W;$v++)$K=$X[2*$v],$x=$X[2*$v+1],(.01<Math.abs($Z-$K)||.01<Math.abs($n-$x))&&this._points.push($K,$x),$Z=$K,$n=$x},$g.getData=function($X,$g,$K){var $x=[],$Z=[];0<this.borderWidth&&this.createLine2(this._points,$x,this.borderWidth,$K,$Z,this._points.length/2),this.mUint16Array.set($x,0),this.mFloat32Array.set($Z,0),$X.append(this.mUint16Array),$g.append(this.mFloat32Array)},$n}()),$MX=function($X){function $_($X,$g,$K,$x,$Z){this._points=[];for(var $n=NaN,$W=NaN,$v=-1,$T=-1,$G=$K.length/2-1,$c=0;$c<$G;$c++)$n=$K[2*$c],$W=$K[2*$c+1],(.01<Math.abs($v-$n)||.01<Math.abs($T-$W))&&this._points.push($n,$W),$v=$n,$T=$W;$n=$K[2*$G],$W=$K[2*$G+1],$v=this._points[0],$T=this._points[1],(.01<Math.abs($v-$n)||.01<Math.abs($T-$W))&&this._points.push($n,$W),$_.__super.call(this,$X,$g,0,0,this._points.length/2,0,$x,$Z)}$s($_,"laya.webgl.shapes.LoopLine",$KX);var $g=$_.prototype;return $g.getData=function($X,$g,$K){if(0<this.borderWidth){for(var $x=this.color,$Z=($x>>16&255)/255,$n=($x>>8&255)/255,$W=(255&$x)/255,$v=[],$T=0,$G=0,$c=[],$_=Math.floor(this._points.length/2),$s=0;$s<$_;$s++)$T=this._points[2*$s],$G=this._points[2*$s+1],$v.push(this.x+$T,this.y+$G,$Z,$n,$W);this.createLoopLine($v,$c,this.borderWidth,$K+$v.length/5),$X.append(new Uint16Array($c)),$g.append(new Float32Array($v))}},$g.createLoopLine=function($X,$g,$K,$x,$Z,$n){$X.length;var $W=$X.concat(),$v=$Z||$X,$T=this.borderColor,$G=($T>>16&255)/255,$c=($T>>8&255)/255,$_=(255&$T)/255,$s=[$W[0],$W[1]],$V=[$W[$W.length-5],$W[$W.length-4]],$A=$V[0]+.5*($s[0]-$V[0]),$a=$V[1]+.5*($s[1]-$V[1]);$W.unshift($A,$a,0,0,0),$W.push($A,$a,0,0,0);var $m,$F,$U,$$,$w,$Q,$f,$D,$B,$i,$k,$I,$r,$t,$M,$P,$N,$C,$Y,$l,$p=$W.length/5,$L=$x,$q=$K/2;$U=$W[0],$$=$W[1],$i=$U-($w=$W[5]),$B=($B=-($$-($Q=$W[6])))/($l=Math.sqrt($B*$B+$i*$i))*$q,$i=$i/$l*$q,$v.push($U-$B,$$-$i,$G,$c,$_,$U+$B,$$+$i,$G,$c,$_);for(var $E=1;$E<$p-1;$E++)$U=$W[5*($E-1)],$$=$W[5*($E-1)+1],$w=$W[5*$E],$Q=$W[5*$E+1],$f=$W[5*($E+1)],$D=$W[5*($E+1)+1],$i=$U-$w,$I=$w-$f,$M=(-($B=($B=-($$-$Q))/($l=Math.sqrt($B*$B+$i*$i))*$q)+$U)*(-($i=$i/$l*$q)+$Q)-(-$B+$w)*(-$i+$$),$C=(-($k=($k=-($Q-$D))/($l=Math.sqrt($k*$k+$I*$I))*$q)+$f)*(-($I=$I/$l*$q)+$Q)-(-$k+$w)*(-$I+$D),$Y=($r=-$i+$$-(-$i+$Q))*($N=-$k+$w-(-$k+$f))-($P=-$I+$D-(-$I+$Q))*($t=-$B+$w-(-$B+$U)),Math.abs($Y)<.1?($Y+=10.1,$v.push($w-$B,$Q-$i,$G,$c,$_,$w+$B,$Q+$i,$G,$c,$_)):((($m=($t*$C-$N*$M)/$Y)-$w)*($m-$w)+(($F=($P*$M-$r*$C)/$Y)-$Q)+($F-$Q),$v.push($m,$F,$G,$c,$_,$w-($m-$w),$Q-($F-$Q),$G,$c,$_));$n&&($g=$n);var $u=this.edges+1;for($E=1;$E<$u;$E++)$g.push($L+2*($E-1),$L+2*($E-1)+1,$L+2*$E+1,$L+2*$E+1,$L+2*$E,$L+2*($E-1));return $g.push($L+2*($E-1),$L+2*($E-1)+1,$L+1,$L+1,$L,$L+2*($E-1)),$v},$_}(),$PX=function($X){function $W($X,$g,$K,$x,$Z,$n){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=$i.create(),this._points=$K.slice(0,$K.length),$W.__super.call(this,$X,$g,0,0,this._points.length/2,$x,$Z,$n)}$s($W,"laya.webgl.shapes.Polygon",$KX);var $g=$W.prototype;return $g.rebuild=function($X){this._repaint||(this._points.length=0,this._points=this._points.concat($X))},$g.setMatrix=function($X){$X.copyTo(this._mat)},$g.needUpdate=function($X){return this._repaint=this._mat.a==$X.a&&this._mat.b==$X.b&&this._mat.c==$X.c&&this._mat.d==$X.d&&this._mat.tx==$X.tx&&this._mat.ty==$X.ty,!this._repaint},$g.getData=function($X,$g,$K){var $x,$Z=0,$n=this._points,$W=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=$K){for(this._start=$K,$x=[],$W=this.earcutTriangles.length,$Z=0;$Z<$W;$Z++)$x.push(this.earcutTriangles[$Z]+$K);this.mUint16Array=new Uint16Array($x)}}else{this._start=$K,$x=[];var $v=[],$T=[],$G=this.color,$c=($G>>16&255)/255,$_=($G>>8&255)/255,$s=(255&$G)/255;for($W=Math.floor($n.length/2),$Z=0;$Z<$W;$Z++)$v.push(this.x+$n[2*$Z],this.y+$n[2*$Z+1],$c,$_,$s),$T.push(this.x+$n[2*$Z],this.y+$n[2*$Z+1]);for(this.earcutTriangles=$xX.earcut($T,null,2),$W=this.earcutTriangles.length,$Z=0;$Z<$W;$Z++)$x.push(this.earcutTriangles[$Z]+$K);this.mUint16Array=new Uint16Array($x),this.mFloat32Array=new Float32Array($v)}$X.append(this.mUint16Array),$g.append(this.mFloat32Array)},$W}(),$NX=function($X){function $n(){this._matrix=new $i,this._matrix4=$aX.defaultMatrix4.concat(),$n.__super.call(this,1e4),this.shaderValue=new $BX(0,0)}$s($n,"laya.webgl.submit.SubmitCanvas",$nX);var $g=$n.prototype;return $g.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var $X=$UX.worldAlpha,$g=$UX.worldMatrix4,$K=$UX.worldMatrix,$x=$UX.worldFilters,$Z=$UX.worldShaderDefines,$n=this.shaderValue,$W=this._matrix,$v=this._matrix4,$T=$i.TEMP;return $i.mul($W,$K,$T),$v[0]=$T.a,$v[1]=$T.b,$v[4]=$T.c,$v[5]=$T.d,$v[12]=$T.tx,$v[13]=$T.ty,$UX.worldMatrix=$T.clone(),$UX.worldMatrix4=$v,$UX.worldAlpha=$UX.worldAlpha*$n.alpha,$n.filters&&$n.filters.length&&($UX.worldFilters=$n.filters,$UX.worldShaderDefines=$n.defines),this._ctx_src.flush(),$UX.worldAlpha=$X,$UX.worldMatrix4=$g,$UX.worldMatrix.destroy(),$UX.worldMatrix=$K,$UX.worldFilters=$x,$UX.worldShaderDefines=$Z,1},$g.releaseRender=function(){var $X=$n._cache;this._ctx_src=null,$X[$X._length++]=this},$g.getRenderType=function(){return 10003},$n.create=function($X,$g,$K){var $x=$n._cache._length?$n._cache[--$n._cache._length]:new $n;$x._ctx_src=$X;var $Z=$x.shaderValue;return $Z.alpha=$g,$Z.defines.setValue(0),$K&&$K.length&&$Z.setFilters($K),$x},$n._cache=(($n._cache=[])._length=0,$n._cache),$n}(),$CX=function($X){function $G($X){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===$X&&($X=1e4),$G.__super.call(this,$X)}$s($G,"laya.webgl.submit.SubmitTexture",$nX);var $g=$G.prototype;return $g.releaseRender=function(){var $X=$G._cache;($X[$X._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},$g.addTexture=function($X,$g){this._texsID[this._texs.length]=$X._uvID,this._texs.push($X),this._vbPos.push($g)},$g.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var $X=this.shaderValue.textureHost.bitmap;if(null!==$X)for(var $g=this._vb.getFloat32Array(),$K=0,$x=this._texs.length;$K<$x;$K++){var $Z=this._texs[$K];$Z.active();var $n=$Z.uv;if(this._texsID[$K]!==$Z._uvID){this._texsID[$K]=$Z._uvID;var $W=this._vbPos[$K];$g[$W+2]=$n[0],$g[$W+3]=$n[1],$g[$W+6]=$n[2],$g[$W+7]=$n[3],$g[$W+10]=$n[4],$g[$W+11]=$n[5],$g[$W+14]=$n[6],$g[$W+15]=$n[7],this._vb.setNeedUpload()}$Z.bitmap!==$X&&(this._isSameTexture=!1)}}},$g.renderSubmit=function(){if(0===this._numEle)return $G._shaderSet=!1,1;var $X=this.shaderValue.textureHost;if($X){var $g=$X.source;if(!$X.bitmap||!$g)return $G._shaderSet=!1,1;this.shaderValue.texture=$g,$X.alphaTexture&&$X.alphaTexture.source&&(this.shaderValue.texture1=$X.alphaTexture.source)}this._vb.bind_upload(this._ib);var $K=$wX.mainContext;if($e.activeBlendFunction!==this._blendFn&&($K.enable(3042),this._blendFn($K),$e.activeBlendFunction=this._blendFn),$M.drawCall++,$M.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&$lX.activeShader&&$G._shaderSet?($lX.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&$lX.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),$G._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var $x=$X.bitmap,$Z=0,$n=$lX.activeShader,$W=0,$v=this._texs.length;$W<$v;$W++){var $T=this._texs[$W];$T.bitmap===$x&&$W+1!==$v||($n.uploadTexture2D($T.source),$K.drawElements(4,6*($W-$Z+1),5123,this._startIdx+6*$Z*$aX.BYTES_PIDX),$x=$T.bitmap,$Z=$W)}else $K.drawElements(4,this._numEle,5123,this._startIdx);return 1},$G.create=function($X,$g,$K,$x,$Z){var $n=$G._cache._length?$G._cache[--$G._cache._length]:new $G;null==$K&&(($K=$n._selfVb||($n._selfVb=$yX.create(-1))).clear(),$x=0),$n._ib=$g,$n._vb=$K,$n._startIdx=$x*$aX.BYTES_PIDX,$n._numEle=0;var $W=$X._nBlendType;$n._blendFn=$X._targets?$e.targetFns[$W]:$e.fns[$W],$n.shaderValue=$Z,$n.shaderValue.setValue($X._shader2D);var $v=$X._shader2D.filters;return $v&&$n.shaderValue.setFilters($v),$n},$G._cache=(($G._cache=[])._length=0,$G._cache),$G._shaderSet=!0,$G}(),$YX=function($X){function $F(){$F.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}$s($F,"laya.webgl.utils.MeshTexture",$FX);var $g=$F.prototype;return $g.addData=function($X,$g,$K,$x,$Z,$n){for(var $W=$X.length/2,$v=this._vb.needSize($W*$F.const_stride)>>2,$T=this._vb.getFloat32Array(),$G=0,$c=0;$c<$W;$c++){var $_=$X[$G],$s=$X[$G+1],$V=$_*$x.a+$s*$x.c+$x.tx,$A=$_*$x.b+$s*$x.d+$x.ty;$T[$v++]=$V,$T[$v++]=$A,$T[$v++]=$g[$G],$T[$v++]=$g[$G+1],$G+=2}this._vb.setNeedUpload();var $a=this.vertNum;if(0<$a){($W=$K.length)>$F.tmpIdx.length&&($F.tmpIdx=new Uint16Array($W));for(var $m=0;$m<$W;$m++)$F.tmpIdx[$m]=$K[$m]+$a;this._ib.appendU16Array($F.tmpIdx,$K.length)}else this._ib.append($K);this._ib.setNeedUpload(),this.vertNum+=$W,this.indexNum+=$K.length},$g.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},$g.destroy=function(){this._ib.destroy(),this._vb.destroy()},$F.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new $F},$F.const_stride=16,$F._POOL=[],$W($F,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),$F}(),$lX=function($X){function $g(){$g.__super.call(this),this.lock=!0}return $s($g,"laya.webgl.shader.BaseShader",$$),$g.activeShader=null,$g.bindShader=null,$g}(),$pX=function($g){function $c($X,$g,$K,$x,$Z,$n,$W,$v,$T){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===$K&&($K=6408),void 0===$x&&($x=5121),void 0===$Z&&($Z=34041),void 0===$n&&($n=!1),void 0===$W&&($W=!1),void 0===$v&&($v=-1),void 0===$T&&($T=-1),this._type=1,this._w=$X,this._h=$g,this._surfaceFormat=$K,this._surfaceType=$x,this._depthStencilFormat=$Z,$F.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=$n,this._repeat=$W,this._minFifter=$v,this._magFifter=$T,this._createWebGLRenderTarget(),this.bitmap.lock=!0,$c.__super.call(this,this.bitmap,$Y.INV_UV)}$s($c,"laya.webgl.resource.RenderTarget2D",$g);var $X=$c.prototype;return $f.imps($X,{"laya.resource.IDispose":!0}),$X.getType=function(){return this._type},$X.getTexture=function(){return this},$X.size=function($X,$g){this._w==$X&&this._h==$g||(this._w=$X,this._h=$g,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},$X.release=function(){this.destroy()},$X.recycle=function(){$c.POOL.push(this)},$X.start=function(){var $X=$wX.mainContext;return this._preRenderTarget=$UX.curRenderTarget,$UX.curRenderTarget=this,$X.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&($X.viewport(0,0,this._w,this._h),this._svWidth=$UX.width,this._svHeight=$UX.height,$UX.width=this._w,$UX.height=this._h,$lX.activeShader=null),this},$X.clear=function($X,$g,$K,$x){void 0===$X&&($X=0),void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=1);var $Z=$wX.mainContext;$Z.clearColor($X,$g,$K,$x);var $n=16384;switch(this._depthStencilFormat){case 33189:$n|=256;break;case 36168:$n|=1024;break;case 34041:$n|=256,$n|=1024}$Z.clear($n)},$X.end=function(){var $X=$wX.mainContext;$X.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,$UX.curRenderTarget=this._preRenderTarget,1==this._type?($X.viewport(0,0,this._svWidth,this._svHeight),$UX.width=this._svWidth,$UX.height=this._svHeight,$lX.activeShader=null):$X.viewport(0,0,$f.stage.width,$f.stage.height)},$X.getData=function($X,$g,$K,$x){var $Z=$wX.mainContext;if($Z.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===$Z.checkFramebufferStatus(36160)))return $Z.bindFramebuffer(36160,null),null;var $n=new Uint8Array(this._w*this._h*4);return $Z.readPixels($X,$g,$K,$x,this._surfaceFormat,this._surfaceType,$n),$Z.bindFramebuffer(36160,null),$n},$X.destroy=function($X){void 0===$X&&($X=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,$g.prototype.destroy.call(this))},$X.dispose=function(){},$X._createWebGLRenderTarget=function(){this.bitmap=new $jX(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function($X){this.event("recovered")})},$x(0,$X,"surfaceFormat",function(){return this._surfaceFormat}),$x(0,$X,"magFifter",function(){return this._magFifter}),$x(0,$X,"surfaceType",function(){return this._surfaceType}),$x(0,$X,"mipMap",function(){return this._mipMap}),$x(0,$X,"depthStencilFormat",function(){return this._depthStencilFormat}),$x(0,$X,"minFifter",function(){return this._minFifter}),$x(0,$X,"source",function(){return this._alreadyResolved?$f.superGet($Y,this,"source"):null}),$c.create=function($X,$g,$K,$x,$Z,$n,$W,$v,$T){void 0===$K&&($K=6408),void 0===$x&&($x=5121),void 0===$Z&&($Z=34041),void 0===$n&&($n=!1),void 0===$W&&($W=!1),void 0===$v&&($v=-1),void 0===$T&&($T=-1);var $G=$c.POOL.pop();return $G||($G=new $c($X,$g)),$G.bitmap&&$G._w==$X&&$G._h==$g&&$G._surfaceFormat==$K&&$G._surfaceType==$x&&$G._depthStencilFormat==$Z&&$G._mipMap==$n&&$G._repeat==$W&&$G._minFifter==$v&&$G._magFifter==$T||($G._w=$X,$G._h=$g,$G._surfaceFormat=$K,$G._surfaceType=$x,$G._depthStencilFormat=$Z,$F.isConchWebGL&&34041===$G._depthStencilFormat&&($G._depthStencilFormat=33189),$G._mipMap=$n,$G._repeat=$W,$G._minFifter=$v,$G._magFifter=$T,$G.release(),$G._createWebGLRenderTarget()),$G},$c.TYPE2D=1,$c.TYPE3D=2,$c.POOL=[],$c}($Y),$LX=function($X){function $g(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,$g.__super.call(this),$g._gl=$wX.mainContext}$s($g,"laya.webgl.utils.Buffer",$$);var $K=$g.prototype;return $K._bind=function(){this.activeResource(),$g._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&($g._bindVertexBuffer=this._glBuffer),$g._gl.bindBuffer(this._bufferType,$g._bindActive[this._bufferType]=this._glBuffer),$lX.activeShader=null)},$K.recreateResource=function(){this._glBuffer||(this._glBuffer=$g._gl.createBuffer()),this.completeCreate()},$K.disposeResource=function(){this._glBuffer&&($wX.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},$x(0,$K,"bufferUsage",function(){return this._bufferUsage}),$g._gl=null,$g._bindActive={},$g._bindVertexBuffer=null,$g._enableAtributes=[],$g}(),$qX=function($X){function $K($X){this.texcoord=null,this.offsetX=300,this.offsetY=0,$K.__super.call(this,512,0);var $g=8*$aX.BYTES_PE;this.position=[2,5126,!1,$g,0],this.texcoord=[2,5126,!1,$g,2*$aX.BYTES_PE],this.color=[4,5126,!1,$g,4*$aX.BYTES_PE]}return $s($K,"laya.webgl.shader.d2.skinAnishader.SkinSV",$BX),$K}(),$EX=function($X){function $g($X){$g.__super.call(this,2,0),this.color=[]}return $s($g,"laya.webgl.shader.d2.value.Color2dSV",$BX),$g.prototype.setValue=function($X){$X.fillStyle&&(this.color=$X.fillStyle._color._color),$X.strokeStyle&&(this.color=$X.strokeStyle._color._color)},$g}(),$uX=function($X){function $g($X){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=$BX._TEXCOORD,$g.__super.call(this,256,0)}$s($g,"laya.webgl.shader.d2.value.FillTextureSV",$BX);var $K=$g.prototype;return $K.setValue=function($X){this.ALPHA=$X.ALPHA,$X.filters&&this.setFilters($X.filters)},$K.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$g}(),$OX=function($X){function $g($X){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=$BX._TEXCOORD,void 0===$X&&($X=0),$g.__super.call(this,1,$X)}$s($g,"laya.webgl.shader.d2.value.TextureSV",$BX);var $K=$g.prototype;return $K.setValue=function($X){this.ALPHA=$X.ALPHA,$X.filters&&this.setFilters($X.filters)},$K.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$g}(),$eX=function($X){function $g($X){this.a_color=null,this.u_pos=[0,0],$g.__super.call(this,4,0),this.position=[2,5126,!1,5*$aX.BYTES_PE,0],this.a_color=[3,5126,!1,5*$aX.BYTES_PE,2*$aX.BYTES_PE]}return $s($g,"laya.webgl.shader.d2.value.PrimitiveSV",$BX),$g}(),$bX=function($X){function $g(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,$g.__super.call(this)}$s($g,"laya.webgl.atlas.AtlasWebGLCanvas",$X);var $K=$g.prototype;return $K.recreateResource=function(){var $X=$wX.mainContext,$g=this._source=$X.createTexture(),$K=$QX.curBindTexTarget,$x=$QX.curBindTexValue;$QX.bindTexture($X,3553,$g),$X.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),$X.texParameteri(3553,10241,9729),$X.texParameteri(3553,10240,9729),$X.texParameteri(3553,10242,33071),$X.texParameteri(3553,10243,33071),$K&&$x&&$QX.bindTexture($X,$K,$x),this.memorySize=this._w*this._h*4,this.completeCreate()},$K.disposeResource=function(){this._source&&($wX.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$K.texSubImage2D=function($X,$g,$K){if($F.isFlash){this._flashCacheImage||(this._flashCacheImage=$a.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var $x=$K.bitmapdata;this._flashCacheImage._image.copyPixels($x,0,0,$x.width,$x.height,$X,$g),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var $Z=$wX.mainContext,$n=$QX.curBindTexTarget,$W=$QX.curBindTexValue;$QX.bindTexture($Z,3553,this._source),$Z.pixelStorei(37441,!0),0<=$X-1&&$Z.texSubImage2D(3553,0,$X-1,$g,6408,5121,$K),$X+1<=this._w&&$Z.texSubImage2D(3553,0,$X+1,$g,6408,5121,$K),0<=$g-1&&$Z.texSubImage2D(3553,0,$X,$g-1,6408,5121,$K),$g+1<=this._h&&$Z.texSubImage2D(3553,0,$X,$g+1,6408,5121,$K),$Z.texSubImage2D(3553,0,$X,$g,6408,5121,$K),$Z.pixelStorei(37441,!1),$n&&$W&&$QX.bindTexture($Z,$n,$W)}},$K.texSubImage2DPixel=function($X,$g,$K,$x,$Z){var $n=$wX.mainContext,$W=$QX.curBindTexTarget,$v=$QX.curBindTexValue;$QX.bindTexture($n,3553,this._source);var $T=new Uint8Array($Z.data);$n.pixelStorei(37441,!0),$n.texSubImage2D(3553,0,$X,$g,$K,$x,6408,5121,$T),$n.pixelStorei(37441,!1),$W&&$v&&$QX.bindTexture($n,$W,$v)},$x(0,$K,"width",$X.prototype._$get_width,function($X){this._w=$X}),$x(0,$K,"height",$X.prototype._$get_height,function($X){this._h=$X}),$g}($K),$SX=function($X){function $Z(){this.flipY=!0,this.alwaysChange=!1,$Z.__super.call(this)}$s($Z,"laya.webgl.resource.WebGLCanvas",$K);var $g=$Z.prototype;return $g.getCanvas=function(){return this._canvas},$g.clear=function(){this._ctx&&this._ctx.clear()},$g.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$g._setContext=function($X){this._ctx=$X},$g.getContext=function($X,$g){return this._ctx?this._ctx:this._ctx=$Z._createContext(this)},$g.size=function($X,$g){this._w==$X&&this._h==$g||(this._w=$X,this._h=$g,this._ctx&&this._ctx.size($X,$g),this._canvas&&(this._canvas.height=$g,this._canvas.width=$X))},$g.activeResource=function($X){void 0===$X&&($X=!1),this._source||this.recreateResource()},$g.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},$g.disposeResource=function(){this._source&&!this.iscpuSource&&($wX.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$g.createWebGlTexture=function(){var $X=$wX.mainContext;this._canvas;var $g=this._source=$X.createTexture();this.iscpuSource=!1;var $K=$QX.curBindTexTarget,$x=$QX.curBindTexValue;$QX.bindTexture($X,3553,$g),$X.pixelStorei(37440,this.flipY?1:0),$Z.premulAlpha&&$X.pixelStorei(37441,!0),$X.texImage2D(3553,0,6408,6408,5121,this._imgData),$Z.premulAlpha&&$X.pixelStorei(37441,!1),$X.texParameteri(3553,10240,9729),$X.texParameteri(3553,10241,9729),$X.texParameteri(3553,10242,33071),$X.texParameteri(3553,10243,33071),$X.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,$K&&$x&&$QX.bindTexture($X,$K,$x)},$g.reloadCanvasData=function(){var $X=$wX.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var $g=$QX.curBindTexTarget,$K=$QX.curBindTexValue;$QX.bindTexture($X,3553,this._source),$Z.premulAlpha&&$X.pixelStorei(37441,!0),$X.texImage2D(3553,0,6408,6408,5121,this._imgData),$Z.premulAlpha&&$X.pixelStorei(37441,!1),$X.pixelStorei(37440,0),$g&&$K&&$QX.bindTexture($X,$g,$K)},$g.texSubImage2D=function($X,$g,$K){var $x=$wX.mainContext,$Z=$QX.curBindTexTarget,$n=$QX.curBindTexValue;$QX.bindTexture($x,3553,this._source),$x.pixelStorei(37441,!0),$x.texSubImage2D(3553,0,$g,$K,6408,5121,$X._source),$x.pixelStorei(37441,!1),$Z&&$n&&$QX.bindTexture($x,$Z,$n)},$g.toBase64=function($X,$g,$K){var $x=null;this._canvas&&($x=this._canvas.toDataURL($X,$g)),$K.call(this,$x)},$x(0,$g,"context",function(){return this._ctx}),$x(0,$g,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),$x(0,$g,"asBitmap",null,function($X){this._ctx&&(this._ctx.asBitmap=$X)}),$Z._createContext=null,$Z.premulAlpha=!1,$Z}(),$RX=function($X){function $n($X,$g){this.CborderSize=12,$n.__super.call(this),this.char=$X,this.isSpace=" "===$X,this.xs=$g.scaleX,this.ys=$g.scaleY,this.font=$g.font.toString(),this.fontSize=$g.font.size,this.fillColor=$g.fillColor,this.borderColor=$g.borderColor,this.lineWidth=$g.lineWidth,this.underLine=$g.underLine;var $K,$x=$F.isConchApp;$x?(($K=ConchTextCanvas)._source=ConchTextCanvas,$K._source.canvas=ConchTextCanvas):$K=$V.canvas.source,this.canvas=$K,this._enableMerageInAtlas=!0,this._ctx=$x?$K:this.canvas.getContext("2d",void 0);var $Z=$l.measureText(this.char,this.font);this.cw=$Z.width*this.xs,this.ch=($Z.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new $Y(this)}$s($n,"laya.webgl.resource.WebGLCharImage",$K);var $g=$n.prototype;return $f.imps($g,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$g.active=function(){this.texture.active()},$g.recreateResource=function(){var $X=$F.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),$X){var $g=this.fontSize;1==this.xs&&1==this.ys||($g=parseInt($g*(this.xs>this.ys?this.xs:this.ys)+""));var $K="normal 100 "+this.font;$K=$K.replace($n._fontSizeReg,$g),this.borderColor&&($K+=" 1 "+this.borderColor),this._ctx.font=$K,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,$C.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var $x=this._ctx.measureText(this.char);$x||($x={width:16});var $Z=$x.width+1;this._ctx.lineTo($Z,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},$g.onresize=function($X,$g){this._w=$X,this._h=$g,this._allowMerageInAtlas=!0},$g.clearAtlasSource=function(){},$x(0,$g,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$x(0,$g,"atlasSource",function(){return this.canvas}),$x(0,$g,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($X){this._enableMerageInAtlas=$X}),$n.createOneChar=function($X,$g){return new $n($X,$g)},$n._fontSizeReg=new RegExp("\\d+(?=px)","g"),$n}(),$jX=function($X){function $G($X,$g,$K,$x,$Z,$n,$W,$v,$T){void 0===$K&&($K=6408),void 0===$x&&($x=5121),void 0===$Z&&($Z=34041),void 0===$n&&($n=!1),void 0===$W&&($W=!1),void 0===$v&&($v=-1),void 0===$T&&($T=1),$G.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=$X,this._h=$g,this._surfaceFormat=$K,this._surfaceType=$x,this._depthStencilFormat=$Z,this._mipMap=$n,this._repeat=$W,this._minFifter=$v,this._magFifter=$T}$s($G,"laya.webgl.resource.WebGLRenderTarget",$K);var $g=$G.prototype;return $g.recreateResource=function(){var $X=$wX.mainContext;this._frameBuffer||(this._frameBuffer=$X.createFramebuffer()),this._source||(this._source=$X.createTexture());var $g=$QX.curBindTexTarget,$K=$QX.curBindTexValue;$QX.bindTexture($X,3553,this._source),$X.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var $x=this._minFifter,$Z=this._magFifter,$n=this._repeat?10497:33071,$W=$c.isPOT(this._w,this._h);if($W?(this._mipMap?-1!==$x||($x=9987):-1!==$x||($x=9729),-1!==$Z||($Z=9729),$X.texParameteri(3553,10241,$x),$X.texParameteri(3553,10240,$Z),$X.texParameteri(3553,10242,$n),$X.texParameteri(3553,10243,$n),this._mipMap&&$X.generateMipmap(3553)):(-1!==$x||($x=9729),-1!==$Z||($Z=9729),$X.texParameteri(3553,10241,$x),$X.texParameteri(3553,10240,$Z),$X.texParameteri(3553,10242,33071),$X.texParameteri(3553,10243,33071)),$X.bindFramebuffer(36160,this._frameBuffer),$X.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=$X.createRenderbuffer()),$X.bindRenderbuffer(36161,this._depthStencilBuffer),$X.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:$X.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$X.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$X.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$X.bindFramebuffer(36160,null),$g&&$K&&$QX.bindTexture($X,$g,$K),$X.bindRenderbuffer(36161,null),$W&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},$g.disposeResource=function(){this._frameBuffer&&($wX.mainContext.deleteTexture(this._source),$wX.mainContext.deleteFramebuffer(this._frameBuffer),$wX.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null)},$x(0,$g,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$x(0,$g,"frameBuffer",function(){return this._frameBuffer}),$G}(),$dX=function($X){function $v($X,$g,$K,$x,$Z,$n,$W){this.offsetX=0,this.offsetY=0,$v.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=$n,this.canvas=$X,this._ctx=$X.getContext("2d",void 0),this._w=$x,this._h=$Z,this.offsetX=$g,this.offsetY=$K,this.src=$W,this._enableMerageInAtlas=!0,$u.enabled&&this._w<$u.atlasLimitWidth&&this._h<$u.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}$s($v,"laya.webgl.resource.WebGLSubImage",$K);var $g=$v.prototype;return $f.imps($g,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$g.size=function($X,$g){this._w=$X,this._h=$g,this._ctx&&this._ctx.size($X,$g),this.canvas&&(this.canvas.height=$g,this.canvas.width=$X)},$g.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},$g.createWebGlTexture=function(){var $X=$wX.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var $g=this._source=$X.createTexture(),$K=$QX.curBindTexTarget,$x=$QX.curBindTexValue;$QX.bindTexture($X,3553,$g),$X.pixelStorei(37441,!0),$X.texImage2D(3553,0,6408,6408,5121,this.canvas),$X.pixelStorei(37441,!1);var $Z=this.minFifter,$n=this.magFifter,$W=this.repeat?10497:33071,$v=$c.isPOT(this.width,this.height);$v?(this.mipmap?-1!==$Z||($Z=9987):-1!==$Z||($Z=9729),-1!==$n||($n=9729),$X.texParameteri(3553,10240,$n),$X.texParameteri(3553,10241,$Z),$X.texParameteri(3553,10242,$W),$X.texParameteri(3553,10243,$W),this.mipmap&&$X.generateMipmap(3553)):(-1!==$Z||($Z=9729),-1!==$n||($n=9729),$X.texParameteri(3553,10241,$Z),$X.texParameteri(3553,10240,$n),$X.texParameteri(3553,10242,33071),$X.texParameteri(3553,10243,33071)),$K&&$x&&$QX.bindTexture($X,$K,$x),this.canvas=null,$v&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},$g.disposeResource=function(){$u.enabled&&this._allowMerageInAtlas||!this._source||($wX.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$g.clearAtlasSource=function(){},$x(0,$g,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$x(0,$g,"atlasSource",function(){return this.canvas}),$x(0,$g,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function($X){this._allowMerageInAtlas=$X}),$v}(),$hX=function($X){function $G($X,$g,$K,$x){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,$G.__super.call(this),!$X||!$g)throw"Shader Error";this._id=++$G._count,this._vs=$X,this._ps=$g,this._nameMap=$x||{},null!=$K&&($G.sharders[$K]=this)}$s($G,"laya.webgl.shader.Shader",$lX);var $g=$G.prototype;return $g.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},$g.disposeResource=function(){$wX.mainContext.deleteShader(this._vshader),$wX.mainContext.deleteShader(this._pshader),$wX.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},$g._compile=function(){if(!$wX.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var $X=[this._vs,this._ps],$g=$wX.mainContext;if(this._program=$g.createProgram(),this._vshader=$G._createShader($g,$X[0],35633),this._pshader=$G._createShader($g,$X[1],35632),$g.attachShader(this._program,this._vshader),$g.attachShader(this._program,this._pshader),$g.linkProgram(this._program),!$F.isConchApp&&!$g.getProgramParameter(this._program,35714))throw $g.getProgramInfoLog(this._program);var $K,$x,$Z=0,$n=0;for($n=$F.isConchApp?$g.getProgramParameterEx(this._vs,this._ps,"",35721):$g.getProgramParameter(this._program,35721),$Z=0;$Z<$n;$Z++){var $W=null;$K={vartype:"attribute",glfun:null,ivartype:0,attrib:$W=$F.isConchApp?$g.getActiveAttribEx(this._vs,this._ps,"",$Z):$g.getActiveAttrib(this._program,$Z),location:$g.getAttribLocation(this._program,$W.name),name:$W.name,type:$W.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push($K)}var $v=0;for($v=$F.isConchApp?$g.getProgramParameterEx(this._vs,this._ps,"",35718):$g.getProgramParameter(this._program,35718),$Z=0;$Z<$v;$Z++){var $T=null;$T=$F.isConchApp?$g.getActiveUniformEx(this._vs,this._ps,"",$Z):$g.getActiveUniform(this._program,$Z),0<($K={vartype:"uniform",glfun:null,ivartype:1,attrib:$W,location:$g.getUniformLocation(this._program,$T.name),name:$T.name,type:$T.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($K.name=$K.name.substr(0,$K.name.length-3),$K.isArray=!0,$K.location=$g.getUniformLocation(this._program,$K.name)),this._params.push($K)}for($Z=0,$x=this._params.length;$Z<$x;$Z++)if(($K=this._params[$Z]).indexOfParams=$Z,$K.index=1,$K.value=[$K.location,null],$K.codename=$K.name,$K.name=this._nameMap[$K.codename]?this._nameMap[$K.codename]:$K.codename,(this._paramsMap[$K.name]=$K)._this=this,$K.uploadedValue=[],"attribute"!==$K.vartype)switch($K.type){case 5124:$K.fun=$K.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$K.fun=$K.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$K.fun=$K.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$K.fun=$K.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$K.fun=$K.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$K.fun=this._uniform_sampler2D;break;case 35680:$K.fun=this._uniform_samplerCube;break;case 35676:$K.glfun=$g.uniformMatrix4fv,$K.fun=this._uniformMatrix4fv;break;case 35670:$K.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else $K.fun=this._attribute}},$g.getUniform=function($X){return this._paramsMap[$X]},$g._attribute=function($X,$g){var $K=$wX.mainContext,$x=$LX._enableAtributes,$Z=$X.location;return $x[$Z]||$K.enableVertexAttribArray($Z),$K.vertexAttribPointer($Z,$g[0],$g[1],$g[2],$g[3],$g[4]+this._offset),$x[$Z]=$LX._bindVertexBuffer,1},$g._uniform1f=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g?($wX.mainContext.uniform1f($X.location,$K[0]=$g),1):0},$g._uniform1fv=function($X,$g){if($g.length<4){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]||$K[2]!==$g[2]||$K[3]!==$g[3]?($wX.mainContext.uniform1fv($X.location,$g),$K[0]=$g[0],$K[1]=$g[1],$K[2]=$g[2],$K[3]=$g[3],1):0}return $wX.mainContext.uniform1fv($X.location,$g),1},$g._uniform_vec2=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]?($wX.mainContext.uniform2f($X.location,$K[0]=$g[0],$K[1]=$g[1]),1):0},$g._uniform_vec2v=function($X,$g){if($g.length<2){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]||$K[2]!==$g[2]||$K[3]!==$g[3]?($wX.mainContext.uniform2fv($X.location,$g),$K[0]=$g[0],$K[1]=$g[1],$K[2]=$g[2],$K[3]=$g[3],1):0}return $wX.mainContext.uniform2fv($X.location,$g),1},$g._uniform_vec3=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]||$K[2]!==$g[2]?($wX.mainContext.uniform3f($X.location,$K[0]=$g[0],$K[1]=$g[1],$K[2]=$g[2]),1):0},$g._uniform_vec3v=function($X,$g){return $wX.mainContext.uniform3fv($X.location,$g),1},$g._uniform_vec4=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]||$K[2]!==$g[2]||$K[3]!==$g[3]?($wX.mainContext.uniform4f($X.location,$K[0]=$g[0],$K[1]=$g[1],$K[2]=$g[2],$K[3]=$g[3]),1):0},$g._uniform_vec4v=function($X,$g){return $wX.mainContext.uniform4fv($X.location,$g),1},$g._uniformMatrix2fv=function($X,$g){return $wX.mainContext.uniformMatrix2fv($X.location,!1,$g),1},$g._uniformMatrix3fv=function($X,$g){return $wX.mainContext.uniformMatrix3fv($X.location,!1,$g),1},$g._uniformMatrix4fv=function($X,$g){return $wX.mainContext.uniformMatrix4fv($X.location,!1,$g),1},$g._uniform1i=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g?($wX.mainContext.uniform1i($X.location,$K[0]=$g),1):0},$g._uniform1iv=function($X,$g){return $wX.mainContext.uniform1iv($X.location,$g),1},$g._uniform_ivec2=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]?($wX.mainContext.uniform2i($X.location,$K[0]=$g[0],$K[1]=$g[1]),1):0},$g._uniform_ivec2v=function($X,$g){return $wX.mainContext.uniform2iv($X.location,$g),1},$g._uniform_vec3i=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]||$K[2]!==$g[2]?($wX.mainContext.uniform3i($X.location,$K[0]=$g[0],$K[1]=$g[1],$K[2]=$g[2]),1):0},$g._uniform_vec3vi=function($X,$g){return $wX.mainContext.uniform3iv($X.location,$g),1},$g._uniform_vec4i=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]||$K[2]!==$g[2]||$K[3]!==$g[3]?($wX.mainContext.uniform4i($X.location,$K[0]=$g[0],$K[1]=$g[1],$K[2]=$g[2],$K[3]=$g[3]),1):0},$g._uniform_vec4vi=function($X,$g){return $wX.mainContext.uniform4iv($X.location,$g),1},$g._uniform_sampler2D=function($X,$g){var $K=$wX.mainContext,$x=$X.uploadedValue;return null==$x[0]?($x[0]=this._curActTexIndex,$K.uniform1i($X.location,this._curActTexIndex),$K.activeTexture($G._TEXTURES[this._curActTexIndex]),$QX.bindTexture($K,3553,$g),this._curActTexIndex++,1):($K.activeTexture($G._TEXTURES[$x[0]]),$QX.bindTexture($K,3553,$g),0)},$g._uniform_samplerCube=function($X,$g){var $K=$wX.mainContext,$x=$X.uploadedValue;return null==$x[0]?($x[0]=this._curActTexIndex,$K.uniform1i($X.location,this._curActTexIndex),$K.activeTexture($G._TEXTURES[this._curActTexIndex]),$QX.bindTexture($K,34067,$g),this._curActTexIndex++,1):($K.activeTexture($G._TEXTURES[$x[0]]),$QX.bindTexture($K,34067,$g),0)},$g._noSetValue=function($X){console.log("no....:"+$X.name)},$g.uploadOne=function($X,$g){this.activeResource(),$QX.UseProgram(this._program);var $K=this._paramsMap[$X];$K.fun.call(this,$K,$g)},$g.uploadTexture2D=function($X){$M.shaderCall++;var $g=$wX.mainContext;$g.activeTexture(33984),$QX.bindTexture($g,3553,$X)},$g.uploadTexture2D1=function($X){$M.shaderCall++;var $g=$wX.mainContext;$g.activeTexture(33985),$QX.bindTexture($g,3553,$X)},$g.upload=function($X,$g){$lX.activeShader=$lX.bindShader=this,this._lastUseFrameCount===$M.loopCount||this.activeResource(),$QX.UseProgram(this._program),this._reCompile?($g=this._params,this._reCompile=!1):$g=$g||this._params;$wX.mainContext;for(var $K,$x,$Z=$g.length,$n=0,$W=0;$W<$Z;$W++)null!==($x=$X[($K=$g[$W]).name])&&($n+=$K.fun.call(this,$K,$x));$M.shaderCall+=$n},$g.uploadArray=function($X,$g,$K){$lX.activeShader=this,($lX.bindShader=this).activeResource(),$QX.UseProgram(this._program);this._params;for(var $x,$Z,$n=0,$W=$g-2;0<=$W;$W-=2)($Z=this._paramsMap[$X[$W]])&&null!=($x=$X[$W+1])&&($K&&$K[$Z.name]&&$K[$Z.name].bind(),$n+=$Z.fun.call(this,$Z,$x));$M.shaderCall+=$n},$g.getParams=function(){return this._params},$G.getShader=function($X){return $G.sharders[$X]},$G.create=function($X,$g,$K,$x){return new $G($X,$g,$K,$x)},$G.withCompile=function($X,$g,$K,$x){if($K&&$G.sharders[$K])return $G.sharders[$K];var $Z=$G._preCompileShader[2e-4*$X];if(!$Z)throw new Error("withCompile shader err!"+$X);return $Z.createShader($g,$K,$x)},$G.withCompile2D=function($X,$g,$K,$x,$Z){if($x&&$G.sharders[$x])return $G.sharders[$x];var $n=$G._preCompileShader[2e-4*$X+$g];if(!$n)throw new Error("withCompile shader err!"+$X+" "+$g);return $n.createShader($K,$x,$Z)},$G.addInclude=function($X,$g){$$X.addInclude($X,$g)},$G.preCompile=function($X,$g,$K,$x){var $Z=2e-4*$X;$G._preCompileShader[$Z]=new $$X($Z,$g,$K,$x)},$G.preCompile2D=function($X,$g,$K,$x,$Z){var $n=2e-4*$X+$g;$G._preCompileShader[$n]=new $$X($n,$K,$x,$Z)},$G._createShader=function($X,$g,$K){var $x=$X.createShader($K);return $X.shaderSource($x,$g),$X.compileShader($x),$x},$G._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],$G._count=0,$G._preCompileShader={},$G.SHADERNAME2ID=2e-4,$G.sharders=(($G.sharders=[]).length=32,$G.sharders),$W($G,["nameKey",function(){return this.nameKey=new $P}]),$G}(),$zX=function($X){function $g(){this._maxsize=0,this._upload=!0,this._uploadSize=0,$g.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}$s($g,"laya.webgl.utils.Buffer2D",$X);var $K=$g.prototype;return $K.needSize=function($X){var $g=this._byteLength;if($X){var $K=this._byteLength+$X;$K<=this._buffer.byteLength||this._resizeBuffer($K<<1,!0),this._byteLength=$K}return $g},$K._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),$M.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$LX._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$LX._gl.bufferSubData(this._bufferType,0,this._buffer)},$K._bufferSubData=function($X,$g,$K){if(void 0===$X&&($X=0),void 0===$g&&($g=0),void 0===$K&&($K=0),this._maxsize=Math.max(this._maxsize,this._byteLength),$M.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$LX._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$g||$K){var $x=this._buffer.slice($g,$K);$LX._gl.bufferSubData(this._bufferType,$X,$x)}else $LX._gl.bufferSubData(this._bufferType,$X,this._buffer)},$K._checkArrayUse=function(){},$K._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},$K._bind_subUpload=function($X,$g,$K){return void 0===$X&&($X=0),void 0===$g&&($g=0),void 0===$K&&($K=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData($X,$g,$K),!0)},$K._resizeBuffer=function($X,$g){if($X<this._buffer.byteLength)return this;if(this.memorySize=$X,$g&&this._buffer&&0<this._buffer.byteLength){var $K=new ArrayBuffer($X);new Uint8Array($K).set(new Uint8Array(this._buffer),0),this._buffer=$K}else this._buffer=new ArrayBuffer($X);return this._checkArrayUse(),this._upload=!0,this},$K.append=function($X){this._upload=!0;var $g,$K;$g=$X.byteLength,$X instanceof Uint8Array?(this._resizeBuffer(this._byteLength+$g,!0),$K=new Uint8Array(this._buffer,this._byteLength)):$X instanceof Uint16Array?(this._resizeBuffer(this._byteLength+$g,!0),$K=new Uint16Array(this._buffer,this._byteLength)):$X instanceof Float32Array&&(this._resizeBuffer(this._byteLength+$g,!0),$K=new Float32Array(this._buffer,this._byteLength)),$K.set($X,0),this._byteLength+=$g,this._checkArrayUse()},$K.appendU16Array=function($X,$g){this._resizeBuffer(this._byteLength+2*$g,!0);for(var $K=new Uint16Array(this._buffer,this._byteLength,$g),$x=0;$x<$g;$x++)$K[$x]=$X[$x];this._byteLength+=2*$g,this._checkArrayUse()},$K.appendEx=function($X,$g){this._upload=!0;var $K;$K=$X.byteLength,this._resizeBuffer(this._byteLength+$K,!0),new $g(this._buffer,this._byteLength).set($X,0),this._byteLength+=$K,this._checkArrayUse()},$K.appendEx2=function($X,$g,$K,$x){void 0===$x&&($x=1),this._upload=!0;var $Z,$n;$Z=$K*$x,this._resizeBuffer(this._byteLength+$Z,!0),$n=new $g(this._buffer,this._byteLength);var $W=0;for($W=0;$W<$K;$W++)$n[$W]=$X[$W];this._byteLength+=$Z,this._checkArrayUse()},$K.getBuffer=function(){return this._buffer},$K.setNeedUpload=function(){this._upload=!0},$K.getNeedUpload=function(){return this._upload},$K.upload=function(){var $X=this._bind_upload();return $LX._gl.bindBuffer(this._bufferType,null),$LX._bindActive[this._bufferType]=null,$lX.activeShader=null,$X},$K.subUpload=function($X,$g,$K){void 0===$X&&($X=0),void 0===$g&&($g=0),void 0===$K&&($K=0);var $x=this._bind_subUpload();return $LX._gl.bindBuffer(this._bufferType,null),$LX._bindActive[this._bufferType]=null,$lX.activeShader=null,$x},$K.disposeResource=function(){$X.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},$K.clear=function(){this._byteLength=0,this._upload=!0},$x(0,$K,"bufferLength",function(){return this._buffer.byteLength}),$x(0,$K,"byteLength",null,function($X){this._byteLength!==$X&&($X<=this._buffer.byteLength||this._resizeBuffer(2*$X+256,!0),this._byteLength=$X)}),$g.__int__=function($X){$HX.QuadrangleIB=$HX.create(35044),$mX.fillIBQuadrangle($HX.QuadrangleIB,16)},$g.FLOAT32=4,$g.SHORT=2,$g}($LX),$JX=(function($g){function $K($X){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,$K.__super.call(this,9)}$s($K,"laya.webgl.shader.d2.value.GlowSV",$g);var $X=$K.prototype;$X.setValue=function($X){$g.prototype.setValue.call(this,$X)},$X.clear=function(){$g.prototype.clear.call(this)}}($OX),function($X){function $g($X){$g.__super.call(this,64),this.defines.add(64)}$s($g,"laya.webgl.shader.d2.value.TextSV",$X);var $K=$g.prototype;return $K.release=function(){($g.pool[$g._length++]=this).clear()},$K.clear=function(){$X.prototype.clear.call(this)},$g.create=function(){return $g._length?$g.pool[--$g._length]:new $g(null)},$g.pool=[],$g._length=0,$g}($OX)),$oX=function($X){function $Z($X,$g,$K,$x){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,$Z.__super.call(this,$X,$g,$K,$x)}$s($Z,"laya.webgl.shader.d2.Shader2X",$X);var $g=$Z.prototype;return $g.upload2dQuick1=function($X){this.upload($X,this._params2dQuick1||this._make2dQuick1())},$g._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var $X,$g=this._params,$K=0,$x=$g.length;$K<$x;$K++)$X=$g[$K],($F.isFlash||"size"!==$X.name&&"position"!==$X.name&&"texcoord"!==$X.name)&&this._params2dQuick1.push($X)}return this._params2dQuick1},$g.disposeResource=function(){$X.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},$g.upload2dQuick2=function($X){this.upload($X,this._params2dQuick2||this._make2dQuick2())},$g._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var $X,$g=this._params,$K=0,$x=$g.length;$K<$x;$K++)$X=$g[$K],($F.isFlash||"size"!==$X.name)&&this._params2dQuick2.push($X)}return this._params2dQuick2},$Z.create=function($X,$g,$K,$x){return new $Z($X,$g,$K,$x)},$Z}($hX),$HX=function($X){function $g($X){this._uint8Array=null,this._uint16Array=null,void 0===$X&&($X=35044),$g.__super.call(this),this._bufferUsage=$X,this._bufferType=34963,$F.isFlash||(this._buffer=new ArrayBuffer(8))}$s($g,"laya.webgl.utils.IndexBuffer2D",$zX);var $K=$g.prototype;return $K._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},$K.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},$K.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},$K.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},$g.QuadrangleIB=null,$g.create=function($X){return void 0===$X&&($X=35044),new $g($X)},$g}(),$yX=function($X){function $K($X,$g){this._floatArray32=null,this._vertexStride=0,$K.__super.call(this),this._vertexStride=$X,this._bufferUsage=$g,this._bufferType=34962,$F.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}$s($K,"laya.webgl.utils.VertexBuffer2D",$X);var $g=$K.prototype;return $g.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},$g.bind=function($X){$X&&$X._bind(),this._bind()},$g.insertData=function($X,$g){this.getFloat32Array().set($X,$g),this._upload=!0},$g.bind_upload=function($X){$X._bind_upload()||$X._bind(),this._bind_upload()||this._bind()},$g._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},$g.disposeResource=function(){$X.prototype.disposeResource.call(this)},$g.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},$x(0,$g,"vertexStride",function(){return this._vertexStride}),$K.create=function($X,$g){return void 0===$g&&($g=35048),new $K($X,$g)},$K}($zX),$Xg=function($X){function $v($X,$g,$K,$x,$Z,$n){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===$K&&($K=6408),void 0===$x&&($x=!0),$v.__super.call(this,$X,$g),$X){if(this._format=$K,this._mipmap=$x,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof $X)this._url=$X,this._src=$X,this._image=new $V.window.Image,$g&&($g.onload&&(this.onload=$g.onload),$g.onerror&&(this.onerror=$g.onerror),$g.onCreate&&$g.onCreate(this)),this._image.crossOrigin=$X&&0==$X.indexOf("data:")?null:"",$X&&(this._image.src=$X);else if($X instanceof ArrayBuffer){this._src=$g,this._url=this._src;var $W=new $T($X);$W.readUTFBytes(4),$W.readUTFBytes(2),$W.getInt16();$W.endian="bigEndian",this._w=$W.getInt16(),this._h=$W.getInt16();$W.getInt16(),$W.getInt16();this._image=new Uint8Array($X,$W.pos),this._format=$wX.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,$u.enabled&&this._w<$u.atlasLimitWidth&&this._h<$u.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!($X instanceof Uint8Array))return this._src=$g,this._url=this._src,this._image=$X.source||$X,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=$g,this._url=this._src,this._w=$Z,this._h=$n,this._image=$X,this._format=0===$K?$X.byteLength/($Z*$n)==4?6408:6407:$K}this._$5__enableMerageInAtlas=!0}}$s($v,"laya.webgl.resource.WebGLImage",$a);var $g=$v.prototype;return $f.imps($g,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$g._init_=function($X,$g){},$g._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $X=$wX.mainContext,$g=this._source=$X.createTexture(),$K=$QX.curBindTexTarget,$x=$QX.curBindTexValue;$QX.bindTexture($X,3553,$g);var $Z=this.minFifter,$n=this.magFifter,$W=this.repeat?10497:33071,$v=$c.isPOT(this._w,this._h),$T=!1;switch($v?(this.mipmap?-1!==$Z||($Z=9987):-1!==$Z||($Z=9729),-1!==$n||($n=9729),$X.texParameteri(3553,10241,$Z),$X.texParameteri(3553,10240,$n),$X.texParameteri(3553,10242,$W),$X.texParameteri(3553,10243,$W),this.mipmap&&$X.generateMipmap(3553)):(-1!==$Z||($Z=9729),-1!==$n||($n=9729),$X.texParameteri(3553,10241,$Z),$X.texParameteri(3553,10240,$n),$X.texParameteri(3553,10242,33071),$X.texParameteri(3553,10243,33071)),$X.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&$X.pixelStorei($X.UNPACK_ALIGNMENT,1),$X.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&$X.pixelStorei($X.UNPACK_ALIGNMENT,1),$X.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:$T=!0,$X.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case $wX.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$T=!0,$X.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}$X.pixelStorei(37441,!1),$K&&$x&&$QX.bindTexture($X,$K,$x),this.uri||(this.uri=this._url),$T?this.memorySize=this._image.length:$v&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},$g.recreateResource=function(){var $X=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var $g=this;this._image=new $V.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if($g._needReleaseAgain)return $g._needReleaseAgain=!1,$g._image.onload=null,void($g._image=null);$g._allowMerageInAtlas&&$g._enableMerageInAtlas?($X.memorySize=0,$X._recreateLock=!1):$g._createWebGlTexture(),$g.completeCreate()},this._image.src=this._src}},$g.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&$wX.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},$g.onresize=function(){this._w=this._image.width,this._h=this._image.height,$u.enabled&&this._w<$u.atlasLimitWidth&&this._h<$u.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},$g.clearAtlasSource=function(){this._image=null},$x(0,$g,"format",function(){return this._format}),$x(0,$g,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function($X){this._$5__enableMerageInAtlas=$X}),$x(0,$g,"mipmap",function(){return this._mipmap}),$x(0,$g,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$x(0,$g,"atlasSource",function(){return this._image}),$x(0,$g,"onload",null,function($X){var $g=this;this._onload=$X,this._image&&(this._image.onload=null!=this._onload?function(){$g.onresize(),$g._onload()}:null)}),$x(0,$g,"onerror",null,function($X){var $g=this;this._onerror=$X,this._image&&(this._image.onerror=null!=this._onerror?function(){$g._onerror()}:null)}),$v}();$f.__init([$VX,$E,$DX,$$X])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($X,$g){"use strict";for(var $K in Object.defineProperty($g,"__esModule",{value:!0}),Laya){var $x=Laya[$K];$x&&$x.__isclass&&($g[$K]=$x)}}),function($n,$X,$x){$x.un,$x.uns;var $Z=$x.static,$W=$x.class,$v=$x.getset,$T=($x.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),$A=laya.utils.ClassUtils,$_=(laya.events.Event,laya.utils.HTMLChar),$G=laya.net.Loader,$c=(laya.display.Node,laya.maths.Rectangle),$s=laya.renders.Render,$V=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),$a=laya.utils.Stat,$l=laya.display.Text,$m=laya.resource.Texture,$F=laya.net.URL,$U=laya.utils.Utils,$$=function(){function $V(){}return $W($V,"laya.html.utils.HTMLParse"),$V.parse=function($X,$g,$K){$g=($g="<root>"+($g=$g.replace(/<br>/g,"<br/>"))+"</root>").replace($V.spacePattern,$V.char255);var $x=$U.parseXMLFromString($g);$V._parseXML($X,$x.childNodes[0].childNodes,$K)},$V._parseXML=function($X,$g,$K,$x){var $Z=0,$n=0;if($g.join||$g.item)for($Z=0,$n=$g.length;$Z<$n;++$Z)$V._parseXML($X,$g[$Z],$K,$x);else{var $W,$v,$T;if(3==$g.nodeType)return void($X instanceof laya.html.dom.HTMLDivElement?(null==$g.nodeName&&($g.nodeName="#text"),$v=$g.nodeName.toLowerCase(),0<($T=$g.textContent.replace(/^\s+|\s+$/g,"")).length&&($W=$A.getInstance($v))&&($X.addChild($W),$W.innerTEXT=$T.replace($V.char255AndOneSpacePattern," "))):0<($T=$g.textContent.replace(/^\s+|\s+$/g,"")).length&&($X.innerTEXT=$T.replace($V.char255AndOneSpacePattern," ")));if("#comment"==($v=$g.nodeName.toLowerCase()))return;if($W=$A.getInstance($v)){($W=$X.addChild($W)).URI=$K,$W.href=$x;var $G=$g.attributes;if($G&&0<$G.length)for($Z=0,$n=$G.length;$Z<$n;++$Z){var $c=$G[$Z],$_=$c.nodeName,$s=$c.value;$W._setAttributes($_,$s)}$V._parseXML($W,$g.childNodes,$K,$W.href)}else $V._parseXML($X,$g.childNodes,$K,$x)}},$V.char255=String.fromCharCode(255),$V.spacePattern=/&nbsp;|&#160;/g,$V.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),$V}(),$w=function(){function $Y(){}return $W($Y,"laya.html.utils.Layout"),$Y.later=function($X){null==$Y._will&&($Y._will=[],$x.stage.frameLoop(1,null,function(){if(!($Y._will.length<1)){for(var $X=0;$X<$Y._will.length;$X++)laya.html.utils.Layout.layout($Y._will[$X]);$Y._will.length=0}})),$Y._will.push($X)},$Y.layout=function($X){if(!$X||!$X._style)return null;if(0==(512&$X._style._type))return null;$X.getStyle()._type&=-513;var $g=$Y._multiLineLayout($X);return $s.isConchApp&&$X.layaoutCallNative&&$X.layaoutCallNative(),$g},$Y._multiLineLayout=function($X){if($l.RightToLeft)return $Y._multiLineLayout2($X);var $g=new Array;$X._addChildsToLayout($g);var $K,$x,$Z,$n,$W,$v=0,$T=$g.length,$G=$X._getCSSStyle(),$c=$G.letterSpacing,$_=$G.leading,$s=$G.lineHeight,$V=$G._widthAuto()||!$G.wordWrap,$A=$V?999999:$X.width,$a=($X.height,0),$m=$G.italic?$G.fontSize/3:0,$F=$G._getAlign(),$U=$G._getValign(),$$=0!==$U||0!==$F||0!=$s,$w=0,$Q=0,$f=0,$D=0,$B=new Array,$i=$B[0]=new $p,$k=!1,$I=!1;$i.h=0,$G.italic&&($A-=$G.fontSize/3);var $r=0,$t=!0;function $M(){$i.y=$Q,$Q+=$i.h+$_,0==$i.h&&($Q+=$s),$i.mWidth=$r,$r=0,$i=new $p,$B.push($i),$i.h=0,$k=!($t=!($w=0))}for($v=0;$v<$T;$v++)if(null!=($K=$g[$v]))if($t=!1,$K instanceof laya.html.dom.HTMLBrElement)$M(),$i.y=$Q;else{if($K._isChar()){if(($n=$K).isWord)$k=$I||"\n"===$n.char,$i.wordStartIndex=$i.elements.length;else{if($f=$n.width+$n.style.letterSpacin,0<$B.length&&$A<$w+$f&&0<$i.wordStartIndex){var $P;$P=$i.elements.length-$i.wordStartIndex+1,$i.elements.length=$i.wordStartIndex,$v-=$P,$M();continue}$k=!1,$r+=$n.width}$f=$n.width+$c,$D=$n.height,$I=!1,($k=$k||$A<$w+$f)&&$M(),$i.minTextHeight=Math.min($i.minTextHeight,$K.height)}else $x=$K._getCSSStyle(),$W=$K,$Z=$x.padding,0===$x._getCssFloat()||($$=!0),$k=$I||$x.lineElement,$f=$W.width*$W._style._tf.scaleX+$Z[1]+$Z[3]+$c,$D=$W.height*$W._style._tf.scaleY+$Z[0]+$Z[2],$I=$x.lineElement,($k=$k||$A<$w+$f&&$x.wordWrap)&&$M();$i.elements.push($K),$i.h=Math.max($i.h,$D),$K.x=$w,$K.y=$Q,$w+=$f,$i.w=$w-$c,$i.y=$Q,$a=Math.max($w+$m,$a)}else $t||($w+=$Y.DIV_ELEMENT_PADDING),$i.wordStartIndex=$i.elements.length;if($Q=$i.y+$i.h,$$){var $N=0,$C=$A;for($V&&0<$X.width&&($C=$X.width),$v=0,$T=$B.length;$v<$T;$v++)$B[$v].updatePos(0,$C,$v,$N,$F,$U,$s),$N+=Math.max($s,$B[$v].h+$_);$Q=$N}return $V&&($X.width=$a),$Q>$X.height&&($X.height=$Q),[$a,$Q]},$Y._multiLineLayout2=function($X){var $g=new Array;$X._addChildsToLayout($g);var $K,$x,$Z,$n,$W,$v=0,$T=$g.length,$G=$X._getCSSStyle(),$c=$G.letterSpacing,$_=$G.leading,$s=$G.lineHeight,$V=$G._widthAuto()||!$G.wordWrap,$A=$V?999999:$X.width,$a=($X.height,0),$m=$G.italic?$G.fontSize/3:0,$F=2-$G._getAlign(),$U=$G._getValign(),$$=0!==$U||0!=$F||0!=$s,$w=0,$Q=0,$f=0,$D=0,$B=new Array,$i=$B[0]=new $p,$k=!1,$I=!1;$i.h=0,$G.italic&&($A-=$G.fontSize/3);var $r=0,$t=!0;function $M(){$i.y=$Q,$Q+=$i.h+$_,0==$i.h&&($Q+=$s),$i.mWidth=$r,$r=0,$i=new $p,$B.push($i),$i.h=0,$k=!($t=!($w=0))}for($v=0;$v<$T;$v++)if(null!=($K=$g[$v]))if($t=!1,$K instanceof laya.html.dom.HTMLBrElement)$M(),$i.y=$Q;else{if($K._isChar()){if(($n=$K).isWord)$k=$I||"\n"===$n.char,$i.wordStartIndex=$i.elements.length;else{if(0<$B.length&&$A<$w+$f&&0<$i.wordStartIndex){var $P;$P=$i.elements.length-$i.wordStartIndex+1,$i.elements.length=$i.wordStartIndex,$v-=$P,$M();continue}$k=!1,$r+=$n.width}$f=$n.width+$c,$D=$n.height,$I=!1,($k=$k||$A<$w+$f)&&$M(),$i.minTextHeight=Math.min($i.minTextHeight,$K.height)}else $x=$K._getCSSStyle(),$W=$K,$Z=$x.padding,0===$x._getCssFloat()||($$=!0),$k=$I||$x.lineElement,$f=$W.width*$W._style._tf.scaleX+$Z[1]+$Z[3]+$c,$D=$W.height*$W._style._tf.scaleY+$Z[0]+$Z[2],$I=$x.lineElement,($k=$k||$A<$w+$f&&$x.wordWrap)&&$M();$i.elements.push($K),$i.h=Math.max($i.h,$D),$K.x=$w,$K.y=$Q,$w+=$f,$i.w=$w-$c,$i.y=$Q,$a=Math.max($w+$m,$a)}else $t||($w+=$Y.DIV_ELEMENT_PADDING),$i.wordStartIndex=$i.elements.length;if($Q=$i.y+$i.h,$$){var $N=0,$C=$A;for($v=0,$T=$B.length;$v<$T;$v++)$B[$v].updatePos(0,$C,$v,$N,$F,$U,$s),$N+=Math.max($s,$B[$v].h+$_);$Q=$N}for($V&&($X.width=$a),$Q>$X.height&&($X.height=$Q),$v=0,$T=$B.length;$v<$T;$v++)$B[$v].revertOrder($A);return[$a,$Q]},$Y._will=null,$Y.DIV_ELEMENT_PADDING=0,$Y}(),$p=function(){function $X(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}$W($X,"laya.html.utils.LayoutLine");var $g=$X.prototype;return $g.updatePos=function($X,$g,$K,$x,$Z,$n,$W){var $v,$T=0;0<this.elements.length&&($T=($v=this.elements[this.elements.length-1]).x+$v.width-this.elements[0].x);var $G=0,$c=NaN;1===$Z&&($G=($g-$T)/2),2===$Z&&($G=$g-$T),0===$W||0!=$n||($n=1);for(var $_=0,$s=this.elements.length;$_<$s;$_++){var $V=($v=this.elements[$_])._getCSSStyle();switch(0!==$G&&($v.x+=$G),$V._getValign()){case 0:$v.y=$x;break;case 1:var $A=0;99999!=this.minTextHeight&&($A=this.minTextHeight);var $a=($A+$W)/2;$a=Math.max($a,this.h),$c=(laya.html.dom.HTMLImageElement,$x+$a-$v.height),$v.y=$c;break;case 2:$v.y=$x+($W-$v.height)}}},$g.revertOrder=function($X){var $g;if(0<this.elements.length){var $K,$x=0;for($K=this.elements.length,$x=0;$x<$K;$x++)($g=this.elements[$x]).x=$X-$g.x-$g.width}},$X}(),$Q=function($K){function $g(){this.URI=null,this._href=null,$g.__super.call(this),this._text=$g._EMPTYTEXT,this.setStyle(new $T(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}$W($g,"laya.html.dom.HTMLElement",$K);var $X=$g.prototype;return $X.layaoutCallNative=function(){var $X=0;if(this._childs&&0<($X=this._childs.length))for(var $g=0;$g<$X;$g++)this._childs[$g].layaoutCallNative&&this._childs[$g].layaoutCallNative();var $K=this._getWords();$K?laya.html.dom.HTMLElement.fillWords(this,$K,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},$X.appendChild=function($X){return this.addChild($X)},$X._getWords2=function(){var $X=this._text.text;if(!$X||0===$X.length)return null;var $g,$K,$x=0,$Z=0;if(this._text.drawWords)$K=this._text.drawWords;else{for($Z=($g=$X.split(" ")).length-1,$K=[],$x=0;$x<$Z;$x++)$K.push($g[$x]," ");0<=$Z&&$K.push($g[$Z]),this._text.drawWords=$K}var $n,$W=this._text.words;if($W&&$W.length===$K.length)return $W;null===$W&&(this._text.words=$W=[]),$W.length=$K.length;var $v=this.style,$T=$v.font;for($x=0,$Z=$K.length;$x<$Z;$x++){$n=$U.measureText($K[$x],$T);var $G=$W[$x]=new $_($K[$x],$n.width,$n.height||$v.fontSize,$v);if(1<$G.char.length&&($G.charNum=$G.char),this.href){var $c=new $V;this.addChild($c),$G.setSprite($c)}}return $W},$X._getWords=function(){if(!$l.CharacterCache)return this._getWords2();var $X=this._text.text;if(!$X||0===$X.length)return null;var $g,$K=this._text.words;if($K&&$K.length===$X.length)return $K;null===$K&&(this._text.words=$K=[]),$K.length=$X.length;for(var $x=this.style,$Z=$x.font,$n=0,$W=$X.length;$n<$W;$n++)if($g=$U.measureText($X.charAt($n),$Z)){var $v=$K[$n]=new $_($X.charAt($n),$g.width,$g.height||$x.fontSize,$x);if(this.href){var $T=new $V;this.addChild($T),$v.setSprite($T)}}else console.warn("_getWords size is null"+$X.charAt($n),$Z);return $K},$X.showLinkSprite=function(){var $X=this._text.words;if($X)for(var $g,$K,$x=[],$Z=0;$Z<$X.length;$Z++)$K=$X[$Z],($g=new $V).graphics.drawRect(0,0,$K.width,$K.height,"#ff0000"),$g.width=$K.width,$g.height=$K.height,this.addChild($g),$x.push($g)},$X._layoutLater=function(){var $X=this.style;512&$X._type||($X.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&$X.block?($w.later(this),$X._type|=512):this.parent&&this.parent._layoutLater())},$X._setAttributes=function($X,$g){switch($X){case"style":return void this.style.cssText($g);case"class":return void(this.className=$g)}$K.prototype._setAttributes.call(this,$X,$g)},$X.updateHref=function(){if(null!=this._href){var $X=this._getWords();if($X)for(var $g,$K,$x=0;$x<$X.length;$x++)($K=($g=$X[$x]).getSprite())&&($K.size($g.width,$g.height),$K.on("click",this,this.onLinkHandler))}},$X.onLinkHandler=function($X){switch($X.type){case"click":for(var $g=this;$g;)$g.event("link",[this.href]),$g=$g.parent}},$X.formatURL=function($X){return this.URI?$F.formatURL($X,this.URI?this.URI.path:null):$X},$v(0,$X,"href",function(){return this._href},function($X){null!=(this._href=$X)&&(this._getCSSStyle().underLine=1,this.updateHref())}),$v(0,$X,"color",null,function($X){this.style.color=$X}),$v(0,$X,"onClick",null,function($X){$x._runScript("fn=function(event){"+$X+";}"),this.on("click",this,void 0)}),$v(0,$X,"id",null,function($X){$f.document.setElementById($X,this)}),$v(0,$X,"innerTEXT",function(){return this._text.text},function($X){this.text=$X}),$v(0,$X,"style",function(){return this._style}),$v(0,$X,"text",function(){return this._text.text},function($X){this._text==$g._EMPTYTEXT?this._text={text:$X,words:null}:(this._text.text=$X,this._text.words&&(this._text.words.length=0)),$s.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),$v(0,$X,"parent",$K.prototype._$get_parent,function($X){if($X instanceof laya.html.dom.HTMLElement){var $g=$X;this.URI||(this.URI=$g.URI),this.style.inherit($g.style)}$x.superSet($V,this,"parent",$X)}),$v(0,$X,"className",null,function($X){this.style.attrs($f.document.styleSheets["."+$X])}),$g.fillWords=function($X,$g,$K,$x,$Z,$n,$W){$X.graphics.clear();for(var $v=0,$T=$g.length;$v<$T;$v++){var $G=$g[$v];$X.graphics.fillText($G.char,$G.x+$K,$G.y+$x,$Z,$n,"left",$W)}},$g._EMPTYTEXT={text:null,words:null},$g}($V),$g=(function($X){function $g(){$g.__super.call(this),this.style.lineElement=!0,this.style.block=!0}$W($g,"laya.html.dom.HTMLBrElement",$Q)}(),function($X){function $g(){this.contextHeight=NaN,this.contextWidth=NaN,$g.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}$W($g,"laya.html.dom.HTMLDivElement",$X);var $K=$g.prototype;return $K.appendHTML=function($X){$$.parse(this,$X,this.URI),this.layout()},$K._addChildsToLayout=function($g){var $X=this._getWords();if(null==$X&&0==this._childs.length)return!1;$X&&$X.forEach(function($X){$g.push($X)});for(var $K=!0,$x=0,$Z=this._childs.length;$x<$Z;$x++){var $n=this._childs[$x];$K?$K=!1:$g.push(null),$n._addToLayout($g)}return!0},$K._addToLayout=function($X){this.layout()},$K.layout=function(){if(this.style){this.style._type|=512;var $X=$w.layout(this);if($X){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new $c);var $g=this._$P.mHtmlBounds;$g.x=$g.y=0,$g.width=this.contextWidth=$X[0],$g.height=this.contextHeight=$X[1],this.setBounds($g)}}},$v(0,$K,"height",function(){return this._height?this._height:this.contextHeight},$X.prototype._$set_height),$v(0,$K,"innerHTML",null,function($X){this.destroyChildren(),this.appendHTML($X)}),$v(0,$K,"width",function(){return this._width?this._width:this.contextWidth},function($X){var $g=!1;$g=0===$X?$X!=this._width:$X!=this.width,$x.superSet($Q,this,"width",$X),$g&&this.layout()}),$g}($Q)),$f=function($X){function $g(){this.all=new Array,this.styleSheets=$T.styleSheets,$g.__super.call(this)}$W($g,"laya.html.dom.HTMLDocument",$Q);var $K=$g.prototype;return $K.getElementById=function($X){return this.all[$X]},$K.setElementById=function($X,$g){this.all[$X]=$g},$Z($g,["document",function(){return this.document=new $g}]),$g}();(function($X){function $g(){this._tex=null,this._url=null,this._renderArgs=[],$g.__super.call(this),this.style.block=!0}$W($g,"laya.html.dom.HTMLImageElement",$Q);var $K=$g.prototype;$K._addToLayout=function($X){!this._style.absolute&&$X.push(this)},$K.render=function($X,$g,$K){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||($a.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,$X.ctx.drawTexture2($g,$K,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},$K.layaoutCallNative=function(){var $X=0;if(this._childs&&0<($X=this._childs.length))for(var $g=0;$g<$X;$g++)this._childs[$g].layaoutCallNative&&this._childs[$g].layaoutCallNative()},$v(0,$K,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($X){this._width!==$X&&(this._width=$X,this._style.width=$X,this.repaint())}),$v(0,$K,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($X){this._height!==$X&&(this._height=$X,this._style.height=$X,this.repaint())}),$K.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),$G.clearCache(this,this._url),this._tex=null),$Q.prototype.destroy.call(this)},$K.onloaded=function(){var $X=this._style;$X&&!$X.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),$X&&!$X.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),$s.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},$K._loadImageComplete=function($X,$g,$K){if(!this._destroyed)if(null!=$K)if($K instanceof ArrayBuffer){var $x=new DataView($K);new laya.webgl.resource.WebGLImage(new Uint8Array($K,8),$X,0,!1,$x.getUint32(0),$x.getUint32(4));this.onloaded()}else if($K instanceof $m)$G.imgMgrSet[$X]=$g,$n.imgMgrLock($X,$G.imgMgrSet[$X]),this._url=$X,this._tex=$K,$G.keepCache(this,$X),$G.cacheRes($X,this._tex),this.onloaded();else{var $Z=-1!=$X.indexOf(".png",$X.length-4)?6408:6407;new laya.webgl.resource.WebGLImage($K,$X,$Z,!1,$K.width,$K.height);this.onloaded()}else this.event("error","Load image failed")},$v(0,$K,"src",null,function($X){($X=this.formatURL($X),this._url!=$X)&&(null!=this._tex&&($G.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=$X,(this._tex=$G.getRes($X))?($G.keepCache(this,$X),this.onloaded()):$n.imgMgrLoad($X,this._loadImageComplete.bind(this),2,!1))})})(),function($X){function $g(){this.type=null,$g.__super.call(this),this.visible=!1}$W($g,"laya.html.dom.HTMLLinkElement",$X);var $K=$g.prototype;$K._onload=function($X){switch(this.type){case"text/css":$T.parseCSS($X,this.URI)}},$v(0,$K,"href",$X.prototype._$get_href,function($X){var $g=this;$X=this.formatURL($X),this.URI=new $F($X);var $K=new $G;$K.once("complete",null,function($X){$g._onload($X)}),$K.load($X,"text")}),$g._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}($Q),function($X){function $g(){$g.__super.call(this),this.visible=!1}$W($g,"laya.html.dom.HTMLStyleElement",$X),$v(0,$g.prototype,"text",$X.prototype._$get_text,function($X){$T.parseCSS($X,null)})}($Q),function($X){function $g(){$g.__super.call(this),this._getCSSStyle().valign="middle"}$W($g,"laya.html.dom.HTMLIframeElement",$X),$v(0,$g.prototype,"href",$X.prototype._$get_href,function($K){var $x=this;$K=this.formatURL($K);var $X=new $G;$X.once("complete",null,function($X){var $g=$x.URI;$x.URI=new $F($K),$x.innerHTML=$X,!$g||($x.URI=$g)}),$X.load($K,"text")})}($g)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($X,$g){"use strict";for(var $K in Object.defineProperty($g,"__esModule",{value:!0}),Laya){var $x=Laya[$K];$x&&$x.__isclass&&($g[$K]=$x)}}),function($Z,$X,$a){$a.un,$a.uns;var $x=$a.static,$n=$a.class,$W=$a.getset,$K=($a.__newvec,laya.display.Animation),$m=(laya.utils.Browser,laya.utils.ClassUtils),$v=laya.filters.ColorFilter,$T=laya.utils.Ease,$G=laya.events.Event,$c=(laya.events.EventDispatcher,laya.display.css.Font),$_=laya.display.FrameAnimation,$g=laya.display.Graphics,$s=laya.utils.Handler,$V=laya.display.Input,$U=laya.net.Loader,$A=(laya.display.Node,laya.maths.Point),$F=laya.maths.Rectangle,$$=laya.renders.Render,$w=laya.display.Sprite,$Q=laya.display.Text,$f=laya.resource.Texture,$D=laya.utils.Tween,$B=laya.utils.Utils,$i=laya.utils.WeakObject;$a.interface("laya.ui.IItem"),$a.interface("laya.ui.ISelect"),$a.interface("laya.ui.IRender"),$a.interface("laya.ui.IComponent"),$a.interface("laya.ui.IBox","IComponent");var $k=function(){function $X(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return $n($X,"laya.ui.LayoutStyle"),$x($X,["EMPTY",function(){return this.EMPTY=new $X}]),$X}(),$I=function(){function $X(){}return $n($X,"laya.ui.Styles"),$X.labelColor="#000000",$X.buttonStateNum=3,$X.scrollBarMinNum=15,$X.scrollBarDelayTime=500,$x($X,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),$X}(),$r=function(){function $Z(){}return $n($Z,"laya.ui.UIUtils"),$Z.fillArray=function($X,$g,$K){var $x=$X.concat();if($g)for(var $Z=$g.split(","),$n=0,$W=Math.min($x.length,$Z.length);$n<$W;$n++){var $v=$Z[$n];$x[$n]="true"==$v||"false"!=$v&&$v,null!=$K&&($x[$n]=$K($v))}return $x},$Z.toColor=function($X){return $B.toHexColor($X)},$Z.gray=function($X,$g){void 0===$g&&($g=!0),$g?$Z.addFilter($X,$Z.grayFilter):$Z.clearFilter($X,$v)},$Z.addFilter=function($X,$g){var $K=$X.filters||[];$K.push($g),$X.filters=$K},$Z.clearFilter=function($X,$g){var $K=$X.filters;if(null!=$K&&0<$K.length){for(var $x=$K.length-1;-1<$x;$x--){var $Z=$K[$x];$a.__typeof($Z,$g)&&$K.splice($x,1)}$X.filters=$K}},$Z._getReplaceStr=function($X){return $Z.escapeSequence[$X]},$Z.adptString=function($X){return $X.replace(/\\(\w)/g,$Z._getReplaceStr)},$Z.getBindFun=function($X){var $g=$Z._funMap.get($X);if(null==$g){var $K='"'+$X+'"',$x="(function(data){if(data==null)return;with(data){try{\nreturn "+($K=$K.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";$g=$a._runScript($x),$Z._funMap.set($X,$g)}return $g},$x($Z,["grayFilter",function(){return this.grayFilter=new $v([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new $i}]),$Z}(),$t=function(){function $X(){}return $n($X,"UIConfig"),$X.touchScrollEnable=!0,$X.mouseWheelEnable=!0,$X.showButtons=!0,$X.popupBgColor="#000000",$X.popupBgAlpha=.5,$X.closeDialogOnSide=!0,$X}(),$M=function($K){function $F(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,$F.__super.call(this),this._weakKeys=[]}$n($F,"laya.ui.AutoBitmap",$K);var $X=$F.prototype;return $X.destroy=function(){if($U.clearObject(this,this._weakKey),this._weakKeys){for(var $X=0,$g=this._weakKeys.length;$X<$g;++$X)$U.clearObject(this,this._weakKeys[$X]);this._weakKeys=null}$K.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},$X._setChanged=function(){this._isChanged||(this._isChanged=!0,$a.timer.callLater(this,this.changeSource))},$X.changeSource=function(){this._isChanged=!1;var $X=this._source;if($X&&$X.bitmap){var $g=this.width,$K=this.height,$x=this._sizeGrid,$Z=$X.sourceWidth,$n=$X.sourceHeight;if(!$x||$Z===$g&&$n===$K)this.cleanByTexture($X,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,$g,$K);else{$U.clearObject(this,this._weakKey),$X.$_GID||($X.$_GID=$B.getGID());var $W=$X.$_GID+"."+$g+"."+$K+"."+$x.join("."),$v=$U.findObject($W);if($B.isOKCmdList($v))return this._weakKey=$W,$U.keepObject(this,this._weakKey),void(this.cmds=$v);this.clear();var $T,$G,$c=$x[0],$_=$x[1],$s=$x[2],$V=$x[3],$A=$x[4],$a=!1;if($g==$Z&&($V=$_=0),$K==$n&&($c=$s=0),$g<$V+$_){var $m=$g;$a=!0,$g=$V+$_,this.save(),this.clipRect(0,0,$m,$K)}$V&&$c&&($T=$F.getTexture($X,0,0,$V,$c),$G=this._weakKeys[0],$T?($G!=$T.weakKey&&($U.clearObject(this,$G),$U.keepObject(this,$T.weakKey),this._weakKeys[0]=$T.weakKey),this.drawTexture($T,0,0,$V,$c)):($U.clearObject(this,$G),this._weakKeys[0]="")),$_&&$c&&($T=$F.getTexture($X,$Z-$_,0,$_,$c),$G=this._weakKeys[1],$T?($G!=$T.weakKey&&($U.clearObject(this,$G),$U.keepObject(this,$T.weakKey),this._weakKeys[1]=$T.weakKey),this.drawTexture($T,$g-$_,0,$_,$c)):($U.clearObject(this,$G),this._weakKeys[1]="")),$V&&$s&&($T=$F.getTexture($X,0,$n-$s,$V,$s),$G=this._weakKeys[2],$T?($G!=$T.weakKey&&($U.clearObject(this,$G),$U.keepObject(this,$T.weakKey),this._weakKeys[2]=$T.weakKey),this.drawTexture($T,0,$K-$s,$V,$s)):($U.clearObject(this,$G),this._weakKeys[2]="")),$_&&$s&&($T=$F.getTexture($X,$Z-$_,$n-$s,$_,$s),$G=this._weakKeys[3],$T?($G!=$T.weakKey&&($U.clearObject(this,$G),$U.keepObject(this,$T.weakKey),this._weakKeys[3]=$T.weakKey),this.drawTexture($T,$g-$_,$K-$s,$_,$s)):($U.clearObject(this,$G),this._weakKeys[3]="")),$c&&($T=$F.getTexture($X,$V,0,$Z-$V-$_,$c),$G=this._weakKeys[4],$T?($G!=$T.weakKey&&($U.clearObject(this,$G),$U.keepObject(this,$T.weakKey),this._weakKeys[4]=$T.weakKey),this.drawBitmap($A,$T,$V,0,$g-$V-$_,$c)):($U.clearObject(this,$G),this._weakKeys[4]="")),$s&&($T=$F.getTexture($X,$V,$n-$s,$Z-$V-$_,$s),$G=this._weakKeys[5],$T?($G!=$T.weakKey&&($U.clearObject(this,$G),$U.keepObject(this,$T.weakKey),this._weakKeys[5]=$T.weakKey),this.drawBitmap($A,$T,$V,$K-$s,$g-$V-$_,$s)):($U.clearObject(this,$G),this._weakKeys[5]="")),$V&&($T=$F.getTexture($X,0,$c,$V,$n-$c-$s),$G=this._weakKeys[6],$T?($G!=$T.weakKey&&($U.clearObject(this,$G),$U.keepObject(this,$T.weakKey),this._weakKeys[6]=$T.weakKey),this.drawBitmap($A,$T,0,$c,$V,$K-$c-$s)):($U.clearObject(this,$G),this._weakKeys[6]="")),$_&&($T=$F.getTexture($X,$Z-$_,$c,$_,$n-$c-$s),$G=this._weakKeys[7],$T?($G!=$T.weakKey&&($U.clearObject(this,$G),$U.keepObject(this,$T.weakKey),this._weakKeys[7]=$T.weakKey),this.drawBitmap($A,$T,$g-$_,$c,$_,$K-$c-$s)):($U.clearObject(this,$G),this._weakKeys[7]="")),$T=$F.getTexture($X,$V,$c,$Z-$V-$_,$n-$c-$s),$G=this._weakKeys[8],$T?($G!=$T.weakKey&&($U.clearObject(this,$G),$U.keepObject(this,$T.weakKey),this._weakKeys[8]=$T.weakKey),this.drawBitmap($A,$T,$V,$c,$g-$V-$_,$K-$c-$s)):($U.clearObject(this,$G),this._weakKeys[8]=""),$a&&this.restore(),this.autoCacheCmd&&!$$.isConchApp&&($U.saveObject($W,this.cmds,null),this._weakKey=$W,$U.keepObject(this,this._weakKey))}this._repaint()}},$X.drawBitmap=function($X,$g,$K,$x,$Z,$n){void 0===$Z&&($Z=0),void 0===$n&&($n=0),$Z<.1||$n<.1||(!$X||$g.width==$Z&&$g.height==$n?this.drawTexture($g,$K,$x,$Z,$n):this.fillTexture($g,$K,$x,$Z,$n))},$X.clear=function($X){void 0===$X&&($X=!0),$K.prototype.clear.call(this,!1)},$W(0,$X,"sizeGrid",function(){return this._sizeGrid},function($X){this._sizeGrid=$X,this._setChanged()}),$W(0,$X,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function($X){this._width!=$X&&(this._width=$X,this._setChanged())}),$W(0,$X,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function($X){this._height!=$X&&(this._height=$X,this._setChanged())}),$W(0,$X,"source",function(){return this._source},function($X){$X?(this._source=$X,this._setChanged()):(this._source=null,this.clear())}),$F.getTexture=function($X,$g,$K,$x,$Z){$x<=0&&($x=1),$Z<=0&&($Z=1),$X.$_GID||($X.$_GID=$B.getGID());var $n=$X.$_GID+"."+$g+"."+$K+"."+$x+"."+$Z,$W=$U.findObject($n);if((!$W||!$W.source)&&($W=$f.createFromTexture($X,$g,$K,$x,$Z))){if($X.alphaTexture){var $v=$X.width/$X.alphaTexture.width;$W.alphaTexture=$f.createFromTexture($X.alphaTexture,$g/$v,$K/$v,$x/$v,$Z/$v)}$U.saveObject($n,$W),$W.weakKey=$n}return $W},$F}($g),$P=(function($X){function $g(){$g.__super.call(this)}$n($g,"laya.ui.UIEvent",$G),$g.SHOW_TIP="showtip",$g.HIDE_TIP="hidetip"}(),function($g){function $X(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,$X.__super.call(this),this._layout=$k.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}$n($X,"laya.ui.Component",$g);var $K=$X.prototype;return $a.imps($K,{"laya.ui.IComponent":!0}),$K.destroy=function($X){void 0===$X&&($X=!0),$g.prototype.destroy.call(this,$X),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},$K.preinitialize=function(){},$K.createChildren=function(){},$K.initialize=function(){},$K.callLater=function($X,$g){$a.timer.callLater(this,$X,$g)},$K.runCallLater=function($X){$a.timer.runCallLater(this,$X)},$K.commitMeasure=function(){},$K.changeSize=function(){this.event("resize")},$K.getLayout=function(){return this._layout===$k.EMPTY&&(this._layout=new $k),this._layout},$K._setLayoutEnabled=function($X){this._layout&&this._layout.enable!=$X&&(this._layout.enable=$X,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},$K.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},$K.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},$K.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},$K.resetLayoutX=function(){var $X=this._layout;if(isNaN($X.anchorX)||(this.pivotX=$X.anchorX*this.width),this.layoutEnabled){var $g=this.parent;$g&&(isNaN($X.centerX)?isNaN($X.left)?isNaN($X.right)||(this.x=Math.round($g.width-this.displayWidth-$X.right+this.pivotX*this.scaleX)):(this.x=Math.round($X.left+this.pivotX*this.scaleX),isNaN($X.right)||(this.width=($g._width-$X.left-$X.right)/(this.scaleX||.01))):this.x=Math.round(.5*($g.width-this.displayWidth)+$X.centerX+this.pivotX*this.scaleX))}},$K.resetLayoutY=function(){var $X=this._layout;if(isNaN($X.anchorY)||(this.pivotY=$X.anchorY*this.height),this.layoutEnabled){var $g=this.parent;$g&&(isNaN($X.centerY)?isNaN($X.top)?isNaN($X.bottom)||(this.y=Math.round($g.height-this.displayHeight-$X.bottom+this.pivotY*this.scaleY)):(this.y=Math.round($X.top+this.pivotY*this.scaleY),isNaN($X.bottom)||(this.height=($g._height-$X.top-$X.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*($g.height-this.displayHeight)+$X.centerY+this.pivotY*this.scaleY))}},$K.onMouseOver=function($X){$a.stage.event("showtip",this._toolTip)},$K.onMouseOut=function($X){$a.stage.event("hidetip",this._toolTip)},$W(0,$K,"displayWidth",function(){return this.width*this.scaleX}),$W(0,$K,"width",function(){return this._width?this._width:this.measureWidth},function($X){this._width!=$X&&(this._width=$X,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),$W(0,$K,"measureWidth",function(){var $X=0;this.commitMeasure();for(var $g=this.numChildren-1;-1<$g;$g--){var $K=this.getChildAt($g);$K.visible&&($X=Math.max($K.x+$K.width*$K.scaleX,$X))}return $X}),$W(0,$K,"displayHeight",function(){return this.height*this.scaleY}),$W(0,$K,"height",function(){return this._height?this._height:this.measureHeight},function($X){this._height!=$X&&(this._height=$X,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),$W(0,$K,"dataSource",function(){return this._dataSource},function($X){for(var $g in this._dataSource=$X,this._dataSource)this.hasOwnProperty($g)&&"function"!=typeof this[$g]&&(this[$g]=this._dataSource[$g])}),$W(0,$K,"scaleY",$g.prototype._$get_scaleY,function($X){$a.superGet($w,this,"scaleY")!=$X&&($a.superSet($w,this,"scaleY",$X),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),$W(0,$K,"measureHeight",function(){var $X=0;this.commitMeasure();for(var $g=this.numChildren-1;-1<$g;$g--){var $K=this.getChildAt($g);$K.visible&&($X=Math.max($K.y+$K.height*$K.scaleY,$X))}return $X}),$W(0,$K,"scaleX",$g.prototype._$get_scaleX,function($X){$a.superGet($w,this,"scaleX")!=$X&&($a.superSet($w,this,"scaleX",$X),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),$W(0,$K,"top",function(){return this._layout.top},function($X){$X!=this._layout.top&&(this.getLayout().top=$X,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$W(0,$K,"bottom",function(){return this._layout.bottom},function($X){$X!=this._layout.bottom&&(this.getLayout().bottom=$X,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$W(0,$K,"left",function(){return this._layout.left},function($X){$X!=this._layout.left&&(this.getLayout().left=$X,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$W(0,$K,"right",function(){return this._layout.right},function($X){$X!=this._layout.right&&(this.getLayout().right=$X,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$W(0,$K,"centerX",function(){return this._layout.centerX},function($X){$X!=this._layout.centerX&&(this.getLayout().centerX=$X,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$W(0,$K,"centerY",function(){return this._layout.centerY},function($X){$X!=this._layout.centerY&&(this.getLayout().centerY=$X,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$W(0,$K,"anchorX",function(){return this._layout.anchorX},function($X){$X!=this._layout.anchorX&&(this.getLayout().anchorX=$X,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$W(0,$K,"anchorY",function(){return this._layout.anchorY},function($X){$X!=this._layout.anchorY&&(this.getLayout().anchorY=$X,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$W(0,$K,"tag",function(){return this._tag},function($X){this._tag=$X}),$W(0,$K,"toolTip",function(){return this._toolTip},function($X){this._toolTip!=$X&&(null!=(this._toolTip=$X)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),$W(0,$K,"comXml",function(){return this._comXml},function($X){this._comXml=$X}),$W(0,$K,"gray",function(){return this._gray},function($X){$X!==this._gray&&(this._gray=$X,$r.gray(this,$X))}),$W(0,$K,"disabled",function(){return this._disabled},function($X){$X!==this._disabled&&(this.gray=this._disabled=$X,this.mouseEnabled=!$X)}),$X}($w)),$N=function($X){function $g(){this.lockLayer=null,this.popupEffect=function($X){$X.scale(1,1),$D.from($X,{x:$a.stage.width/2,y:$a.stage.height/2,scaleX:0,scaleY:0},300,$T.backOut,$s.create(this,this.doOpen,[$X]))},this.closeEffect=function($X,$g){$D.to($X,{x:$a.stage.width/2,y:$a.stage.height/2,scaleX:0,scaleY:0},300,$T.strongOut,$s.create(this,this.doClose,[$X,$g]))},$g.__super.call(this),this.maskLayer=new $w,this.popupEffectHandler=$s.create(this,this.popupEffect,null,!1),this.closeEffectHandler=$s.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,$a.stage.addChild(this),$a.stage.on("resize",this,this._onResize),$t.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}$n($g,"laya.ui.DialogManager",$w);var $K=$g.prototype;return $K._closeOnSide=function(){var $X=this.getChildAt(this.numChildren-1);$X instanceof laya.ui.Dialog&&$X.close("side")},$K.setLockView=function($X){this.lockLayer||(this.lockLayer=new $C,this.lockLayer.mouseEnabled=!0,this.lockLayer.size($a.stage.width,$a.stage.height)),this.lockLayer.removeChildren(),$X&&($X.centerX=$X.centerY=0,this.lockLayer.addChild($X))},$K._onResize=function($X){var $g=this.maskLayer.width=$a.stage.width,$K=this.maskLayer.height=$a.stage.height;this.lockLayer&&this.lockLayer.size($g,$K),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,$g,$K,$t.popupBgColor),this.maskLayer.alpha=$t.popupBgAlpha;for(var $x=this.numChildren-1;-1<$x;$x--){var $Z=this.getChildAt($x);$Z.popupCenter&&this._centerDialog($Z)}},$K._centerDialog=function($X){$X.x=Math.round(($a.stage.width-$X.width>>1)+$X.pivotX),$X.y=Math.round(($a.stage.height-$X.height>>1)+$X.pivotY)},$K.open=function($X,$g,$K){void 0===$g&&($g=!1),void 0===$K&&($K=!1),$g&&this._closeAll(),$X.popupCenter&&this._centerDialog($X),this.addChild($X),($X.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),$K&&null!=$X.popupEffect?$X.popupEffect.runWith($X):this.doOpen($X),this.event("open")},$K.doOpen=function($X){$X.onOpened()},$K.lock=function($X){this.lockLayer&&($X?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},$K.close=function($X,$g,$K){void 0===$K&&($K=!1),$K&&null!=$X.closeEffect?$X.closeEffect.runWith([$X,$g]):this.doClose($X,$g),this.event("close")},$K.doClose=function($X,$g){$X.removeSelf(),$X.isModal&&this._checkMask(),$X.closeHandler&&$X.closeHandler.runWith($g),$X.onClosed($g)},$K.closeAll=function(){this._closeAll(),this.event("close")},$K._closeAll=function(){for(var $X=this.numChildren-1;-1<$X;$X--){var $g=this.getChildAt($X);$g&&null!=$g.close&&this.doClose($g)}},$K.getDialogsByGroup=function($X){for(var $g=[],$K=this.numChildren-1;-1<$K;$K--){var $x=this.getChildAt($K);$x&&$x.group===$X&&$g.push($x)}return $g},$K.closeByGroup=function($X){for(var $g=[],$K=this.numChildren-1;-1<$K;$K--){var $x=this.getChildAt($K);$x&&$x.group===$X&&($x.close(),$g.push($x))}return $g},$K._checkMask=function(){this.maskLayer.removeSelf();for(var $X=this.numChildren-1;-1<$X;$X--){var $g=this.getChildAt($X);if($g&&$g.isModal)return void this.addChildAt(this.maskLayer,$X)}},$g}(),$C=function($X){function $g(){$g.__super.call(this)}$n($g,"laya.ui.Box",$X);var $K=$g.prototype;return $a.imps($K,{"laya.ui.IBox":!0}),$W(0,$K,"dataSource",$X.prototype._$get_dataSource,function($X){for(var $g in this._dataSource=$X){var $K=this.getChildByName($g);$K?$K.dataSource=$X[$g]:this.hasOwnProperty($g)&&"function"!=typeof this[$g]&&(this[$g]=$X[$g])}}),$g}($P),$Y=function($g){function $K($X,$g){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,$K.__super.call(this),this._labelColors=$I.buttonLabelColors,this._stateNum=$I.buttonStateNum,void 0===$g&&($g=""),this.skin=$X,this.label=$g}$n($K,"laya.ui.Button",$g);var $X=$K.prototype;return $a.imps($X,{"laya.ui.ISelect":!0}),$X.destroy=function($X){this.clearEvent(),$U.clearCache(this,this._skin),$U.clearObject(this,this._weakKey),void 0===$X&&($X=!0),$g.prototype.destroy.call(this,$X),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy($X),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},$X.clearEvent=function(){this._skin&&$Z.atalsNotify&&$Z.atalsNotify.off(this._skin,this,this._setBtnSource)},$X.createChildren=function(){this.graphics=this._bitmap=new $M},$X.createText=function(){this._text||(this._text=new $Q,this._text.overflow=$Q.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},$X.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},$X.onMouse=function($X){if(!1!==this.toggle||!this._selected)return"click"===$X.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=$K.stateMap[$X.type]))},$X.changeClips=function(){var $X=$U.getRes(this._skin);if($X)if(this._skin&&""!=this._skin){$U.clearObject(this,this._weakKey);var $g=$X.sourceWidth,$K=$X.sourceHeight/this._stateNum;$X.$_GID||($X.$_GID=$B.getGID());var $x=$X.$_GID+"-"+this._stateNum,$Z=$U.findObject($x);if($B.isOkTextureList($Z)||($Z=null),$Z)this._weakKey=$x,$U.keepObject(this,this._weakKey),this._sources=$Z;else{if(this._sources=[],1===this._stateNum)this._sources.push($X);else for(var $n=0;$n<this._stateNum;$n++){var $W=$f.createFromTexture($X,0,$K*$n,$g,$K);if($X.alphaTexture){var $v=$X.width/$X.alphaTexture.width;$W.alphaTexture=$f.createFromTexture($X.alphaTexture,0/$v,$K*$n/$v,$g/$v,$K/$v)}this._sources.push($W)}$U.saveObject($x,this._sources),this._weakKey=$x,$U.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||$g,this._bitmap.height=this._height||$K,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=$g)}else console.warn("lose skin ",this._skin,this.name,this.__className)},$X.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var $X=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[$X]),this.label&&(this._text.color=this._labelColors[$X],this._strokeColors&&(this._text.strokeColor=this._strokeColors[$X]))},$X._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},$W(0,$X,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function($X){this.createText(),this._text.strokeColor=$X}),$W(0,$X,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),$W(0,$X,"skin",function(){return this._skin},function($X){if(this._skin!=$X)if(this.clearEvent(),$U.clearCache(this,this._skin),this._skin=$X,$U.keepCache(this,this._skin),$U.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var $g=$Z.resAtalsObj&&$Z.resAtalsObj[this._skin];$g?($Z.atalsNotify&&$Z.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=$g.sourceW),0==this.height&&(this.height=$g.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),$X._setBtnSource=function($X,$g){$X===this._skin&&$g&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},$W(0,$X,"state",function(){return this._state},function($X){this._state!=$X&&(this._state=$X,this._setStateChanged())}),$W(0,$X,"text",function(){return this.createText(),this._text}),$W(0,$X,"stateNum",function(){return this._stateNum},function($X){"string"==typeof $X&&($X=parseInt($X)),this._stateNum!=$X&&(this._stateNum=$X<1?1:3<$X?3:$X,this.callLater(this.changeClips))}),$W(0,$X,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function($X){this._strokeColors=$r.fillArray($I.buttonLabelColors,$X,String),this._setStateChanged()}),$W(0,$X,"labelColors",function(){return this._labelColors.join(",")},function($X){this._labelColors=$r.fillArray($I.buttonLabelColors,$X,String),this._setStateChanged()}),$W(0,$X,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),$W(0,$X,"label",function(){return this._text?this._text.text:null},function($X){(this._text||$X)&&(this.createText(),this._text.text!=$X&&($X&&!this._text.parent&&this.addChild(this._text),this._text.text=($X+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),$W(0,$X,"selected",function(){return this._selected},function($X){this._selected!=$X&&(this._selected=$X,this.state=this._selected?2:0,this.event("change"))}),$W(0,$X,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function($X){this.createText(),this._text.padding=$r.fillArray($I.labelPadding,$X,Number)}),$W(0,$X,"labelSize",function(){return this.createText(),this._text.fontSize},function($X){this.createText(),this._text.fontSize=$X}),$W(0,$X,"labelStroke",function(){return this.createText(),this._text.stroke},function($X){this.createText(),this._text.stroke=$X}),$W(0,$X,"labelBold",function(){return this.createText(),this._text.bold},function($X){this.createText(),this._text.bold=$X}),$W(0,$X,"labelFont",function(){return this.createText(),this._text.font},function($X){this.createText(),this._text.font=$X}),$W(0,$X,"labelAlign",function(){return this.createText(),this._text.align},function($X){this.createText(),this._text.align=$X}),$W(0,$X,"clickHandler",function(){return this._clickHandler},function($X){this._clickHandler=$X}),$W(0,$X,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($X){this._bitmap.sizeGrid=$r.fillArray($I.defaultSizeGrid,$X,Number)}),$W(0,$X,"width",$g.prototype._$get_width,function($X){$a.superSet($P,this,"width",$X),this._autoSize&&(this._bitmap.width=$X,this._text&&(this._text.width=$X))}),$W(0,$X,"height",$g.prototype._$get_height,function($X){$a.superSet($P,this,"height",$X),this._autoSize&&(this._bitmap.height=$X,this._text&&(this._text.height=$X))}),$W(0,$X,"dataSource",$g.prototype._$get_dataSource,function($X){"number"==typeof(this._dataSource=$X)||"string"==typeof $X?this.label=$X+"":$a.superSet($P,this,"dataSource",$X)}),$W(0,$X,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function($X){this._bitmap._offset=$X?$r.fillArray([1,1],$X,Number):[]}),$x($K,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),$K}($P),$l=function($g){function $x($X,$g,$K){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,$x.__super.call(this),void 0===$g&&($g=1),void 0===$K&&($K=1),this._clipX=$g,this._clipY=$K,this.skin=$X}$n($x,"laya.ui.Clip",$g);var $X=$x.prototype;return $X.destroy=function($X){this.clearEvent(),this.clearLoad(),$U.clearCache(this,this._skin),$U.clearObject(this,this._weakKey),void 0===$X&&($X=!0),$g.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},$X.dispose=function(){this.destroy(!0),$a.loader.clearRes(this._skin)},$X.createChildren=function(){this.graphics=this._bitmap=new $M},$X._onDisplay=function($X){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},$X.changeClip=function(){if(this._clipChanged=!1,this._skin){var $X=$U.getRes(this._skin);if($X)this.loadComplete(this._skin,$X);else{if($Z.resAtalsObj&&$Z.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=$s.create(this,this.loadComplete,[this._skin]),this._progress=null,$a.loader.load(this._skin,this._complete,this._progress)}}},$X.loadComplete=function($X,$g){if($X===this._skin&&$g){$U.clearObject(this,this._weakKey);var $K=this._clipWidth||Math.ceil($g.sourceWidth/this._clipX),$x=this._clipHeight||Math.ceil($g.sourceHeight/this._clipY),$Z=this._skin+$K+$x,$n=$U.findObject($Z);if($B.isOkTextureList($n)||($n=null),$n)this._weakKey=$Z,$U.keepObject(this,this._weakKey),this._sources=$n;else{this._sources=[];for(var $W=0;$W<this._clipY;$W++)for(var $v=0;$v<this._clipX;$v++){var $T=$f.createFromTexture($g,$K*$v,$x*$W,$K,$x);if($g.alphaTexture){var $G=$g.width/$g.alphaTexture.width;$T.alphaTexture=$f.createFromTexture($g.alphaTexture,$K*$v/$G,$x*$W/$G,$K/$G,$x/$G)}this._sources.push($T)}$U.saveObject($Z,this._sources),this._weakKey=$Z,$U.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},$X.play=function($X,$g){void 0===$X&&($X=0),void 0===$g&&($g=-1),this._isPlaying=!0,this.index=$X,this._toIndex=$g,this._index++,$a.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},$X._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},$X.stop=function(){this._isPlaying=!1,$a.timer.clear(this,this._loop),this.event("complete")},$X._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},$W(0,$X,"interval",function(){return this._interval},function($X){this._interval!=$X&&(this._interval=$X,this._isPlaying&&this.play())}),$X.clearEvent=function(){this._skin&&$Z.atalsNotify&&$Z.atalsNotify.off(this._skin,this,this._setBtnSource)},$X.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$a.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$W(0,$X,"skin",function(){return this._skin},function($X){if(this._skin!=$X)if(this.clearLoad(),this.clearEvent(),$U.clearCache(this,this._skin),this._skin=$X){$U.keepCache(this,this._skin);var $g=$U.getRes($X),$K=$Z.resAtalsObj&&$Z.resAtalsObj[this._skin];!$g&&$K?$Z.atalsNotify&&$Z.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),$X._setBtnSource=function($X,$g){$X===this._skin&&$g&&(this.loadComplete($X,$g),this.clearEvent())},$W(0,$X,"sources",function(){return this._sources},function($X){this._sources=$X,this.index=this._index,this.event("loaded")}),$W(0,$X,"clipX",function(){return this._clipX},function($X){this._clipX=$X||1,this._setClipChanged()}),$W(0,$X,"clipY",function(){return this._clipY},function($X){this._clipY=$X||1,this._setClipChanged()}),$W(0,$X,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),$W(0,$X,"clipWidth",function(){return this._clipWidth},function($X){this._clipWidth=$X,this._setClipChanged()}),$W(0,$X,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($X){this._bitmap.sizeGrid=$r.fillArray($I.defaultSizeGrid,$X,Number)}),$W(0,$X,"group",function(){return this._group},function($X){$X&&this._skin&&$U.setGroup(this._skin,$X),this._group=$X}),$W(0,$X,"clipHeight",function(){return this._clipHeight},function($X){this._clipHeight=$X,this._setClipChanged()}),$W(0,$X,"width",$g.prototype._$get_width,function($X){$a.superSet($P,this,"width",$X),this._bitmap.width=$X}),$W(0,$X,"height",$g.prototype._$get_height,function($X){$a.superSet($P,this,"height",$X),this._bitmap.height=$X}),$W(0,$X,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),$W(0,$X,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),$W(0,$X,"index",function(){return this._index},function($X){this._index=$X,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[$X]),this.event("change")}),$W(0,$X,"autoPlay",function(){return this._autoPlay},function($X){this._autoPlay!=$X&&((this._autoPlay=$X)?this.play():this.stop())}),$W(0,$X,"isPlaying",function(){return this._isPlaying},function($X){this._isPlaying=$X}),$W(0,$X,"dataSource",$g.prototype._$get_dataSource,function($X){"number"==typeof(this._dataSource=$X)&&Math.floor($X)==$X||"string"==typeof $X?this.index=parseInt($X):$a.superSet($P,this,"dataSource",$X)}),$W(0,$X,"bitmap",function(){return this._bitmap}),$x}($P),$p=function($g){function $X(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,$X.__super.call(this)}$n($X,"laya.ui.ColorPicker",$g);var $K=$X.prototype;return $K.destroy=function($X){void 0===$X&&($X=!0),$g.prototype.destroy.call(this,$X),this._colorPanel&&this._colorPanel.destroy($X),this._colorButton&&this._colorButton.destroy($X),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},$K.createChildren=function(){this.addChild(this._colorButton=new $Y),this._colorPanel=new $C,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new $w),this._colorPanel.addChild(this._colorBlock=new $w),this._colorPanel.addChild(this._colorInput=new $V)},$K.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},$K.onPanelMouseDown=function($X){$X.stopPropagation()},$K.changePanel=function(){this._panelChanged=!1;var $X=this._colorPanel.graphics;$X.clear(),$X.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,($X=this._colorTiles.graphics).clear();for(var $g=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],$K=0;$K<12;$K++)for(var $x=0;$x<20;$x++){var $Z=0;$Z=0===$x?$g[$K]:1===$x?0:51*(((3*$K+$x/6)%3<<0)+3*($K/6<<0))<<16|$x%6*51<<8|($K<<0)%6*51;var $n=$r.toColor($Z);this._colors.push($n);var $W=$x*this._gridSize,$v=$K*this._gridSize;$X.drawRect($W,$v,this._gridSize,this._gridSize,$n,"#000000")}},$K.onColorButtonClick=function($X){this._colorPanel.parent?this.close():this.open()},$K.open=function(){var $X=this.localToGlobal(new $A),$g=$X.x+this._colorPanel.width<=$a.stage.width?$X.x:$a.stage.width-this._colorPanel.width,$K=$X.y+this._colorButton.height;$K=$K+this._colorPanel.height<=$a.stage.height?$K:$X.y-this._colorPanel.height,this._colorPanel.pos($g,$K),this._colorPanel.zOrder=1001,$a._currentStage.addChild(this._colorPanel),$a.stage.on("mousedown",this,this.removeColorBox)},$K.close=function(){$a.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},$K.removeColorBox=function($X){this.close()},$K.onColorFieldKeyDown=function($X){13==$X.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),$X.stopPropagation())},$K.onColorInputChange=function($X){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},$K.onColorTilesClick=function($X){this.selectedColor=this.getColorByMouse(),this.close()},$K.onColorTilesMouseMove=function($X){this._colorInput.focus=!1;var $g=this.getColorByMouse();this._colorInput.text=$g,this.drawBlock($g)},$K.getColorByMouse=function(){var $X=this._colorTiles.getMousePoint(),$g=Math.floor($X.x/this._gridSize),$K=Math.floor($X.y/this._gridSize);return this._colors[20*$K+$g]},$K.drawBlock=function($X){var $g=this._colorBlock.graphics;$g.clear();var $K=$X||"#ffffff";$g.drawRect(0,0,50,20,$K,this._borderColor),$X||$g.drawLine(0,0,50,20,"#ff0000")},$K.changeColor=function(){var $X=this.graphics;$X.clear();var $g=this._selectedColor||"#000000";$X.drawRect(0,0,this._colorButton.width,this._colorButton.height,$g)},$K._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},$W(0,$K,"inputBgColor",function(){return this._inputBgColor},function($X){this._inputBgColor=$X,this._setPanelChanged()}),$W(0,$K,"selectedColor",function(){return this._selectedColor},function($X){this._selectedColor!=$X&&(this._selectedColor=this._colorInput.text=$X,this.drawBlock($X),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",$G.EMPTY.setTo("change",this,this)))}),$W(0,$K,"skin",function(){return this._colorButton.skin},function($X){this._colorButton.skin=$X,this.changeColor()}),$W(0,$K,"bgColor",function(){return this._bgColor},function($X){this._bgColor=$X,this._setPanelChanged()}),$W(0,$K,"borderColor",function(){return this._borderColor},function($X){this._borderColor=$X,this._setPanelChanged()}),$W(0,$K,"inputColor",function(){return this._inputColor},function($X){this._inputColor=$X,this._setPanelChanged()}),$X}($P),$L=function($g){function $K($X,$g){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,$K.__super.call(this),this._itemColors=$I.comboBoxItemColors,this.skin=$X,this.labels=$g}$n($K,"laya.ui.ComboBox",$g);var $X=$K.prototype;return $X.destroy=function($X){void 0===$X&&($X=!0),$g.prototype.destroy.call(this,$X),this._button&&this._button.destroy($X),this._list&&this._list.destroy($X),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},$X.createChildren=function(){this.addChild(this._button=new $Y),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},$X._createList=function(){this._list=new $d,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},$X._setListEvent=function($X){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=$s.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},$X.onListDown=function($X){$X.stopPropagation()},$X.onScrollBarDown=function($X){$X.stopPropagation()},$X.onButtonMouseDown=function($X){this.callLater(this.switchTo,[!this._isOpen])},$X.changeList=function(){this._listChanged=!1;var $X=this.width-2,$g=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:$X,height:this._itemHeight,fontSize:this._itemSize,color:$g}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},$X.onlistItemMouse=function($X,$g){var $K=$X.type;if("mouseover"===$K||"mouseout"===$K){if(this._isCustomList)return;var $x=this._list.getCell($g);if(!$x)return;var $Z=$x.getChildByName("label");$Z&&("mouseover"===$K?($Z.bgColor=this._itemColors[0],$Z.color=this._itemColors[1]):($Z.bgColor=null,$Z.color=this._itemColors[2]))}else"click"===$K&&(this.selectedIndex=$g,this.isOpen=!1)},$X.switchTo=function($X){this.isOpen=$X},$X.changeOpen=function(){this.isOpen=!this._isOpen},$X.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var $X=this._list.graphics;$X.clear(),$X.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var $g=this._list.array||[],$K=$g.length=0,$x=this._labels.length;$K<$x;$K++)$g.push({label:this._labels[$K]});this._list.height=this._listHeight,this._list.array=$g},$X.changeSelected=function(){this._button.label=this.selectedLabel},$X._onStageMouseWheel=function($X){this._list&&!this._list.contains($X.target)&&this.removeList(null)},$X.removeList=function($X){$a.stage.off("mousedown",this,this.removeList),$a.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},$W(0,$X,"selectedIndex",function(){return this._selectedIndex},function($X){this._selectedIndex!=$X&&(this._selectedIndex=$X,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[$G.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),$W(0,$X,"measureHeight",function(){return this._button.height}),$W(0,$X,"skin",function(){return this._button.skin},function($X){this._button.skin!=$X&&(this._button.skin=$X,this._listChanged=!0)}),$W(0,$X,"measureWidth",function(){return this._button.width}),$W(0,$X,"width",$g.prototype._$get_width,function($X){$a.superSet($P,this,"width",$X),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),$W(0,$X,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function($X){this.selectedIndex=this._labels.indexOf($X)}),$W(0,$X,"labels",function(){return this._labels.join(",")},function($X){0<this._labels.length&&(this.selectedIndex=-1),$X?this._labels=$X.split(","):this._labels.length=0,this._itemChanged=!0}),$W(0,$X,"height",$g.prototype._$get_height,function($X){$a.superSet($P,this,"height",$X),this._button.height=this._height}),$W(0,$X,"selectHandler",function(){return this._selectHandler},function($X){this._selectHandler=$X}),$W(0,$X,"visibleNum",function(){return this._visibleNum},function($X){this._visibleNum=$X,this._listChanged=!0}),$W(0,$X,"labelBold",function(){return this._button.text.bold},function($X){this._button.text.bold=$X}),$W(0,$X,"itemColors",function(){return String(this._itemColors)},function($X){this._itemColors=$r.fillArray(this._itemColors,$X,String),this._listChanged=!0}),$W(0,$X,"itemSize",function(){return this._itemSize},function($X){this._itemSize=$X,this._listChanged=!0}),$W(0,$X,"scrollBar",function(){return this.list.scrollBar}),$W(0,$X,"isOpen",function(){return this._isOpen},function($X){if(this._isOpen!=$X)if(this._isOpen=$X,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var $g=this.localToGlobal($A.TEMP.setTo(0,0)),$K=$g.y+this._button.height;$K=$K+this._listHeight<=$a.stage.height?$K:$g.y-this._listHeight,this._list.pos($g.x,$K),this._list.zOrder=1001,$a._currentStage.addChild(this._list),$a.stage.once("mousedown",this,this.removeList),$a.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),$W(0,$X,"scrollBarSkin",function(){return this._scrollBarSkin},function($X){this._scrollBarSkin=$X}),$W(0,$X,"sizeGrid",function(){return this._button.sizeGrid},function($X){this._button.sizeGrid=$X}),$W(0,$X,"button",function(){return this._button}),$W(0,$X,"list",function(){return this._list||this._createList(),this._list},function($X){$X&&($X.removeSelf(),this._isCustomList=!0,this._list=$X,this._setListEvent($X),this._itemHeight=$X.getCell(0).height+$X.spaceY)}),$W(0,$X,"dataSource",$g.prototype._$get_dataSource,function($X){"number"==typeof(this._dataSource=$X)&&Math.floor($X)==$X||"string"==typeof $X?this.selectedIndex=parseInt($X):$X instanceof Array?this.labels=$X.join(","):$a.superSet($P,this,"dataSource",$X)}),$W(0,$X,"labelColors",function(){return this._button.labelColors},function($X){this._button.labelColors!=$X&&(this._button.labelColors=$X)}),$W(0,$X,"labelPadding",function(){return this._button.text.padding.join(",")},function($X){this._button.text.padding=$r.fillArray($I.labelPadding,$X,Number)}),$W(0,$X,"labelSize",function(){return this._button.text.fontSize},function($X){this._button.text.fontSize=$X}),$W(0,$X,"labelFont",function(){return this._button.text.font},function($X){this._button.text.font=$X}),$W(0,$X,"stateNum",function(){return this._button.stateNum},function($X){this._button.stateNum=$X}),$K}($P),$q=function($g){function $K($X){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,$K.__super.call(this),this._showButtons=$t.showButtons,this._touchScrollEnable=$t.touchScrollEnable,this._mouseWheelEnable=$t.mouseWheelEnable,this.skin=$X,this.max=1}$n($K,"laya.ui.ScrollBar",$g);var $X=$K.prototype;return $X.destroy=function($X){void 0===$X&&($X=!0),this.stopScroll(),this.target=null,$g.prototype.destroy.call(this,$X),this.upButton&&this.upButton.destroy($X),this.downButton&&this.downButton.destroy($X),this.slider&&this.slider.destroy($X),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},$X.createChildren=function(){this.addChild(this.slider=new $E),this.addChild(this.upButton=new $Y),this.addChild(this.downButton=new $Y)},$X.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},$X.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},$X.onButtonMouseDown=function($X){var $g=$X.currentTarget===this.upButton;this.slide($g),$a.timer.once($I.scrollBarDelayTime,this,this.startLoop,[$g]),$a.stage.once("mouseup",this,this.onStageMouseUp)},$X.startLoop=function($X){$a.timer.frameLoop(1,this,this.slide,[$X])},$X.slide=function($X){$X?this.value-=this._scrollSize:this.value+=this._scrollSize},$X.onStageMouseUp=function($X){$a.timer.clear(this,this.startLoop),$a.timer.clear(this,this.slide)},$X.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},$X.changeSize=function(){$g.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},$X.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},$X.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},$X.setScroll=function($X,$g,$K){this.runCallLater(this.changeSize),this.slider.setSlider($X,$g,$K),this.slider.bar.visible=0<$g,!this._hide&&this.autoHide&&(this.visible=!1)},$X.onTargetMouseWheel=function($X){this.value-=$X.delta*this._scrollSize,this.target=this._target},$X.onTargetMouseDown=function($X){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $A),this._lastPoint.setTo($a.stage.mouseX,$a.stage.mouseY),$a.timer.clear(this,this.tweenMove),$D.clearTween(this),$a.stage.once("mouseup",this,this.onStageMouseUp2),$a.stage.once("mouseout",this,this.onStageMouseUp2),$a.timer.frameLoop(1,this,this.loop)},$X.loop=function(){var $X=$a.stage.mouseY,$g=$a.stage.mouseX;if(this._lastOffset=this.isVertical?$X-this._lastPoint.y:$g-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?$a.stage._canvasTransform.getScaleY():$a.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=$g,this._lastPoint.y=$X,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},$X.onStageMouseUp2=function($X){if($a.stage.off("mouseup",this,this.onStageMouseUp2),$a.stage.off("mouseout",this,this.onStageMouseUp2),$a.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?$D.to(this,{value:this.min},this.elasticBackTime,$T.sineOut,$s.create(this,this.elasticOver)):this._value>this.max&&$D.to(this,{value:this.max},this.elasticBackTime,$T.sineOut,$s.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?$a.stage.mouseY-this._lastPoint.y:$a.stage.mouseX-this._lastPoint.x);for(var $g=0,$K=Math.min(this._offsets.length,3),$x=0;$x<$K;$x++)$g+=this._offsets[this._offsets.length-1-$x];if(this._lastOffset=$g/$K,($g=Math.abs(this._lastOffset))<2)return void this.event("end");60<$g&&(this._lastOffset=0<this._lastOffset?60:-60);var $Z=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));$a.timer.frameLoop(1,this,this.tweenMove,[$Z])}},$X.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&$D.to(this,{alpha:0},500),this.event("end")},$X.tweenMove=function($X){this._lastOffset*=this.rollRatio;var $g=NaN;if(0<$X&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,$g=.5*-(this.min-$X-this.value),this._lastOffset>$g&&(this._lastOffset=$g)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,$g=.5*-(this.max+$X-this.value),this._lastOffset<$g&&(this._lastOffset=$g))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if($a.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?$D.to(this,{value:this.min},this.elasticBackTime,$T.sineOut,$s.create(this,this.elasticOver)):this._value>this.max?$D.to(this,{value:this.max},this.elasticBackTime,$T.sineOut,$s.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&$D.to(this,{alpha:0},500)}},$X.stopScroll=function(){this.onStageMouseUp2(null),$a.timer.clear(this,this.tweenMove),$D.clearTween(this)},$W(0,$X,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),$W(0,$X,"skin",function(){return this._skin},function($X){this._skin!=$X&&(this._skin=$X,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),$W(0,$X,"max",function(){return this.slider.max},function($X){this.slider.max=$X}),$W(0,$X,"showButtons",function(){return this._showButtons},function($X){this._showButtons=$X,this.callLater(this.changeScrollBar)}),$W(0,$X,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),$W(0,$X,"min",function(){return this.slider.min},function($X){this.slider.min=$X}),$W(0,$X,"value",function(){return this._value},function($X){$X!==this._value&&(this._value=$X,this._isElastic||(this.slider._value!=$X&&(this.slider._value=$X,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),$W(0,$X,"isVertical",function(){return this.slider.isVertical},function($X){this.slider.isVertical=$X}),$W(0,$X,"sizeGrid",function(){return this.slider.sizeGrid},function($X){this.slider.sizeGrid=$X}),$W(0,$X,"scrollSize",function(){return this._scrollSize},function($X){this._scrollSize=$X}),$W(0,$X,"dataSource",$g.prototype._$get_dataSource,function($X){"number"==typeof(this._dataSource=$X)||"string"==typeof $X?this.value=Number($X):$a.superSet($P,this,"dataSource",$X)}),$W(0,$X,"thumbPercent",function(){return this._thumbPercent},function($X){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),$X=1<=$X?.99:$X,this._thumbPercent=$X,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*$X,$I.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*$X,$I.scrollBarMinNum))}),$W(0,$X,"target",function(){return this._target},function($X){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=$X)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),$W(0,$X,"hide",function(){return this._hide},function($X){this._hide=$X,this.visible=!$X}),$W(0,$X,"touchScrollEnable",function(){return this._touchScrollEnable},function($X){this._touchScrollEnable=$X,this.target=this._target}),$W(0,$X,"mouseWheelEnable",function(){return this._mouseWheelEnable},function($X){this._mouseWheelEnable=$X,this.target=this._target}),$W(0,$X,"tick",function(){return this.slider.tick},function($X){this.slider.tick=$X}),$K}($P),$E=function($g){function $K($X){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,$K.__super.call(this),this.skin=$X}$n($K,"laya.ui.Slider",$g);var $X=$K.prototype;return $X.destroy=function($X){void 0===$X&&($X=!0),$g.prototype.destroy.call(this,$X),this._bg&&this._bg.destroy($X),this._bar&&this._bar.destroy($X),this._progress&&this._progress.destroy($X),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},$X.createChildren=function(){this.addChild(this._bg=new $u),this.addChild(this._bar=new $Y)},$X.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},$X.onBarMouseDown=function($X){this._globalSacle||(this._globalSacle=new $A),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=$a.stage.mouseX,this._ty=$a.stage.mouseY,$a.stage.on("mousemove",this,this.mouseMove),$a.stage.once("mouseup",this,this.mouseUp),$a.stage.once("mouseout",this,this.mouseUp),this.showValueText()},$X.showValueText=function(){if(this.showLabel){var $X=laya.ui.Slider.label;this.addChild($X),$X.textField.changeText(this._value+""),this.isVertical?($X.x=this._bar.x+20,$X.y=.5*(this._bar.height-$X.height)+this._bar.y):($X.y=this._bar.y-20,$X.x=.5*(this._bar.width-$X.width)+this._bar.x)}},$X.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},$X.mouseUp=function($X){$a.stage.off("mousemove",this,this.mouseMove),$a.stage.off("mouseup",this,this.mouseUp),$a.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},$X.mouseMove=function($X){var $g=this._value;this.isVertical?(this._bar.y+=($a.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=($a.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=$a.stage.mouseX,this._ty=$a.stage.mouseY;var $K=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$K)/$K,this._value!=$g&&this.sendChangeEvent(),this.showValueText()},$X.sendChangeEvent=function($X){void 0===$X&&($X="change"),this.event($X),this.changeHandler&&this.changeHandler.runWith(this._value)},$X.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},$X.changeSize=function(){$g.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},$X.setSlider=function($X,$g,$K){this._value=-1,this._min=$X,this._max=$X<$g?$g:$X,this.value=$K<$X?$X:$g<$K?$g:$K},$X.changeValue=function(){var $X=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$X)/$X,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var $g=this._max-this._min;0===$g&&($g=1),this.isVertical?(this._bar.y=(this._value-this._min)/$g*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/$g*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},$X.onBgMouseDown=function($X){var $g=this._bg.getMousePoint();this.isVertical?this.value=$g.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=$g.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},$W(0,$X,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),$W(0,$X,"skin",function(){return this._skin},function($X){if(this._skin!=$X){this._skin=$X,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var $g=this._skin.replace(".png","$progress.png");$U.getRes($g)&&(this._progress||(this.addChild(this._progress=new $u),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=$g),this.setBarPoint(),this.callLater(this.changeValue)}}),$W(0,$X,"allowClickBack",function(){return this._allowClickBack},function($X){this._allowClickBack!=$X&&((this._allowClickBack=$X)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),$W(0,$X,"max",function(){return this._max},function($X){this._max!=$X&&(this._max=$X,this.callLater(this.changeValue))}),$W(0,$X,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),$W(0,$X,"tick",function(){return this._tick},function($X){this._tick!=$X&&(this._tick=$X,this.callLater(this.changeValue))}),$W(0,$X,"sizeGrid",function(){return this._bg.sizeGrid},function($X){this._bg.sizeGrid=$X,this._bar.sizeGrid=$X,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),$W(0,$X,"min",function(){return this._min},function($X){this._min!=$X&&(this._min=$X,this.callLater(this.changeValue))}),$W(0,$X,"value",function(){return this._value},function($X){if(this._value!=$X){var $g=this._value;this._value=$X,this.changeValue(),this._value!=$g&&this.sendChangeEvent()}}),$W(0,$X,"dataSource",$g.prototype._$get_dataSource,function($X){"number"==typeof(this._dataSource=$X)||"string"==typeof $X?this.value=Number($X):$a.superSet($P,this,"dataSource",$X)}),$W(0,$X,"bar",function(){return this._bar}),$x($K,["label",function(){return this.label=new $O}]),$K}($P),$u=function($g){function $K($X){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,$K.__super.call(this),this.skin=$X}$n($K,"laya.ui.Image",$g);var $X=$K.prototype;return $X.destroy=function($X){void 0===$X&&($X=!0),$g.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,$U.clearCache(this,this._skin)},$X.dispose=function(){this.destroy(!0),$U.clearCache(this,this._skin),this.clearEvent()},$X.createChildren=function(){this.graphics=this._bitmap=new $M},$X.setSource=function($X,$g){this.destroyed||$X===this._skin&&$g&&(this.source=$g,this.onCompResize(),this.clearEvent())},$X.clearEvent=function(){this._skin&&$Z.atalsNotify&&$Z.atalsNotify.off(this._skin,this,this.setSource)},$X.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$a.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$W(0,$X,"source",function(){return this._bitmap.source},function($X){this._bitmap&&(this._bitmap.source=$X,this.event("loaded"),this.repaint())}),$W(0,$X,"dataSource",$g.prototype._$get_dataSource,function($X){"string"==typeof(this._dataSource=$X)?this.skin=$X:$a.superSet($P,this,"dataSource",$X)}),$W(0,$X,"measureHeight",function(){return this._bitmap.height}),$W(0,$X,"skin",function(){return this._skin},function($X){if(this._skin!=$X)if($U.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=$X){$U.keepCache(this,this._skin);var $g=$U.getRes($X),$K=$Z.resAtalsObj&&$Z.resAtalsObj[this._skin];$g?(this.source=$g,this.onCompResize()):$K?($Z.atalsNotify&&$Z.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=$K.sourceW),0==this.height&&(this.height=$K.sourceH)):(this._complete=$s.create(this,this.setSource,[this._skin]),this._progress=null,$a.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),$W(0,$X,"group",function(){return this._group},function($X){$X&&this._skin&&$U.setGroup(this._skin,$X),this._group=$X}),$W(0,$X,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($X){this._bitmap.sizeGrid=$r.fillArray($I.defaultSizeGrid,$X,Number)}),$W(0,$X,"measureWidth",function(){return this._bitmap.width}),$W(0,$X,"width",$g.prototype._$get_width,function($X){$a.superSet($P,this,"width",$X),this._bitmap.width=0==$X?1e-7:$X}),$W(0,$X,"height",$g.prototype._$get_height,function($X){$a.superSet($P,this,"height",$X),this._bitmap.height=0==$X?1e-7:$X}),$K}($P),$O=function($g){function $K($X){this._tf=null,$K.__super.call(this),void 0===$X&&($X=""),$c.defaultColor=$I.labelColor,this.text=$X}$n($K,"laya.ui.Label",$g);var $X=$K.prototype;return $X.destroy=function($X){void 0===$X&&($X=!0),$g.prototype.destroy.call(this,$X),this._tf=null},$X.createChildren=function(){this.addChild(this._tf=new $Q)},$X.changeText=function($X){this._tf.changeText($X)},$W(0,$X,"padding",function(){return this._tf.padding.join(",")},function($X){this._tf.padding=$r.fillArray($I.labelPadding,$X,Number)}),$W(0,$X,"bold",function(){return this._tf.bold},function($X){this._tf.bold=$X}),$W(0,$X,"align",function(){return this._tf.align},function($X){this._tf.align=$X}),$W(0,$X,"text",function(){return this._tf.text},function($X){this._tf.text!=$X&&($X&&($X=$r.adptString($X+"")),this._tf.text=$X,this.event("change"),this._width&&this._height||this.onCompResize())}),$W(0,$X,"italic",function(){return this._tf.italic},function($X){this._tf.italic=$X}),$W(0,$X,"wordWrap",function(){return this._tf.wordWrap},function($X){this._tf.wordWrap=$X}),$W(0,$X,"font",function(){return this._tf.font},function($X){this._tf.font=$X}),$W(0,$X,"dataSource",$g.prototype._$get_dataSource,function($X){"number"==typeof(this._dataSource=$X)||"string"==typeof $X?this.text=$X+"":$a.superSet($P,this,"dataSource",$X)}),$W(0,$X,"color",function(){return this._tf.color},function($X){this._tf.color=$X}),$W(0,$X,"valign",function(){return this._tf.valign},function($X){this._tf.valign=$X}),$W(0,$X,"leading",function(){return this._tf.leading},function($X){this._tf.leading=$X}),$W(0,$X,"fontSize",function(){return this._tf.fontSize},function($X){this._tf.fontSize=$X}),$W(0,$X,"bgColor",function(){return this._tf.bgColor},function($X){this._tf.bgColor=$X}),$W(0,$X,"borderColor",function(){return this._tf.borderColor},function($X){this._tf.borderColor=$X}),$W(0,$X,"stroke",function(){return this._tf.stroke},function($X){this._tf.stroke=$X}),$W(0,$X,"strokeColor",function(){return this._tf.strokeColor},function($X){this._tf.strokeColor=$X}),$W(0,$X,"textField",function(){return this._tf}),$W(0,$X,"measureWidth",function(){return this._tf.width}),$W(0,$X,"measureHeight",function(){return this._tf.height}),$W(0,$X,"width",function(){return this._width||this._tf.text?$a.superGet($P,this,"width"):0},function($X){$a.superSet($P,this,"width",$X),this._tf.width=$X}),$W(0,$X,"height",function(){return this._height||this._tf.text?$a.superGet($P,this,"height"):0},function($X){$a.superSet($P,this,"height",$X),this._tf.height=$X}),$W(0,$X,"overflow",function(){return this._tf.overflow},function($X){this._tf.overflow=$X}),$W(0,$X,"underline",function(){return this._tf.underline},function($X){this._tf.underline=$X}),$W(0,$X,"underlineColor",function(){return this._tf.underlineColor},function($X){this._tf.underlineColor=$X}),$K}($P),$e=function($g){function $K($X){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,$K.__super.call(this),this.skin=$X}$n($K,"laya.ui.ProgressBar",$g);var $X=$K.prototype;return $X.destroy=function($X){void 0===$X&&($X=!0),$g.prototype.destroy.call(this,$X),this._bg&&this._bg.destroy($X),this._bar&&this._bar.destroy($X),this._bg=this._bar=null,this.changeHandler=null},$X.createChildren=function(){this.addChild(this._bg=new $u),this.addChild(this._bar=new $u)},$X.changeValue=function(){if(this.sizeGrid){var $X=this.sizeGrid.split(","),$g=Number($X[3]),$K=Number($X[1]),$x=(this.width-$g-$K)*this._value;this._bar.width=$g+$K+$x,this._bar.visible=this._bar.width>$g+$K}else this._bar.width=this.width*this._value},$W(0,$X,"measureHeight",function(){return this._bg.height}),$W(0,$X,"skin",function(){return this._skin},function($X){this._skin!=$X&&(this._skin=$X,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),$W(0,$X,"measureWidth",function(){return this._bg.width}),$W(0,$X,"height",$g.prototype._$get_height,function($X){$a.superSet($P,this,"height",$X),this._bg.height=this._height,this._bar.height=this._height}),$W(0,$X,"bar",function(){return this._bar}),$W(0,$X,"value",function(){return this._value},function($X){this._value!=$X&&($X=1<$X?1:$X<0?0:$X,this._value=$X,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith($X))}),$W(0,$X,"bg",function(){return this._bg}),$W(0,$X,"sizeGrid",function(){return this._bg.sizeGrid},function($X){this._bg.sizeGrid=this._bar.sizeGrid=$X}),$W(0,$X,"width",$g.prototype._$get_width,function($X){$a.superSet($P,this,"width",$X),this._bg.width=this._width,this.callLater(this.changeValue)}),$W(0,$X,"dataSource",$g.prototype._$get_dataSource,function($X){"number"==typeof(this._dataSource=$X)||"string"==typeof $X?this.value=Number($X):$a.superSet($P,this,"dataSource",$X)}),$K}($P),$b=(function($X){function $K(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,$K.__super.call(this),this._tipBox=new $P,this._tipBox.addChild(this._tipText=new $Q),this._tipText.x=this._tipText.y=5,this._tipText.color=$K.tipTextColor,this._defaultTipHandler=this._showDefaultTip,$a.stage.on("showtip",this,this._onStageShowTip),$a.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}$n($K,"laya.ui.TipManager",$P);var $g=$K.prototype;$g._onStageHideTip=function($X){$a.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},$g._onStageShowTip=function($X){$a.timer.once($K.tipDelay,this,this._showTip,[$X],!0)},$g._showTip=function($X){if("string"==typeof $X){var $g=String($X);Boolean($g)&&this._defaultTipHandler($g)}else $X instanceof laya.utils.Handler?$X.run():"function"==typeof $X&&$X.apply();$a.stage.on("mousemove",this,this._onStageMouseMove),$a.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},$g._onStageMouseDown=function($X){this.closeAll()},$g._onStageMouseMove=function($X){this._showToStage(this,$K.offsetX,$K.offsetY)},$g._showToStage=function($X,$g,$K){void 0===$g&&($g=0),void 0===$K&&($K=0);var $x=$X.getBounds();$X.x=$a.stage.mouseX+$g,$X.y=$a.stage.mouseY+$K,$X.x+$x.width>$a.stage.width&&($X.x-=$x.width+$g),$X.y+$x.height>$a.stage.height&&($X.y-=$x.height+$K)},$g.closeAll=function(){$a.timer.clear(this,this._showTip),$a.stage.off("mousemove",this,this._onStageMouseMove),$a.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},$g.showDislayTip=function($X){this.addChild($X),this._showToStage(this),$a._currentStage.addChild(this)},$g._showDefaultTip=function($X){this._tipText.text=$X;var $g=this._tipBox.graphics;$g.clear(),$g.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,$K.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),$a._currentStage.addChild(this)},$W(0,$g,"defaultTipHandler",function(){return this._defaultTipHandler},function($X){this._defaultTipHandler=$X}),$K.offsetX=10,$K.offsetY=15,$K.tipTextColor="#ffffff",$K.tipBackColor="#111111",$K.tipDelay=200}(),function($X){var $V;function $A(){this._idMap=null,this._aniList=null,this._watchMap={},$A.__super.call(this)}$n($A,"laya.ui.View",$C);var $g=$A.prototype;return $g.createView=function($X){if($X.animations&&!this._idMap&&(this._idMap={}),$A.createComp($X,this,this),$X.animations){var $g,$K,$x=[],$Z=$X.animations,$n=0,$W=$Z.length;for($n=0;$n<$W;$n++){switch($g=new $_,$K=$Z[$n],$g._setUp(this._idMap,$K),(this[$K.name]=$g)._setControlNode(this),$K.action){case 1:$g.play(0,!1);break;case 2:$g.play(0,!0)}$x.push($g)}this._aniList=$x}0<this._width&&null==$X.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},$g.onEvent=function($X,$g){},$g.loadUI=function($X){var $g=$A.uiMap[$X];$g&&this.createView($g)},$g.destroy=function($X){void 0===$X&&($X=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,$X)},$g.changeData=function($X){var $g=this._watchMap[$X];if($g){console.log("change",$X);for(var $K=0,$x=$g.length;$K<$x;$K++){$g[$K].exe(this)}}},$A._regs=function(){for(var $X in $A.uiClassMap)$m.regClass($X,$A.uiClassMap[$X])},$A.createComp=function($X,$g,$K,$x){if(!($g=$g||$A.getCompInstance($X)))return console.warn("can not create:"+$X.type),null;var $Z=$X.child;if($Z)for(var $n=$g instanceof laya.ui.List,$W=0,$v=$Z.length;$W<$v;$W++){var $T=$Z[$W];if(!$g.hasOwnProperty("itemRender")||"render"!=$T.props.name&&"render"!==$T.props.renderType)if("Graphic"==$T.type)$m.addGraphicsToSprite($T,$g);else if($m.isDrawType($T.type))$m.addGraphicToSprite($T,$g,!0);else{if($n){var $G=[],$c=$A.createComp($T,null,$K,$G);$G.length&&($c._$bindData=$G)}else $c=$A.createComp($T,null,$K,$x);"Script"==$T.type?"owner"in $c?$c.owner=$g:"target"in $c&&($c.target=$g):"mask"==$T.props.renderType||"mask"==$T.props.name?$g.mask=$c:$c instanceof laya.display.Sprite&&$g.addChild($c)}else $g.itemRender=$T}var $_=$X.props;for(var $s in $_){var $V=$_[$s];$A.eventDic[$s]?$V&&$K&&$g.on($s,$K,$K.onEvent,[$V]):$A.setCompValue($g,$s,$V,$K,$x)}return $a.__typeof($g,"laya.ui.IItem")&&$g.initItems(),$X.compId&&$K&&$K._idMap&&($K._idMap[$X.compId]=$g),$g},$A.setCompValue=function($X,$g,$K,$x,$Z){if("string"==typeof $K&&-1<$K.indexOf("${")){if($A._sheet||($A._sheet=$m.getClass("laya.data.Table")),!$A._sheet)return void console.warn("Can not find class Sheet");if($Z)$Z.push($X,$g,$K);else if($x){-1==$K.indexOf("].")&&($K=$K.replace(".","[0]."));var $n,$W,$v=new $V($X,$g,$K);$v.exe($x);for(var $T=$K.replace(/\[.*?\]\./g,".");null!=($n=$A._parseWatchData.exec($T));){for(var $G=$n[1];null!=($W=$A._parseKeyWord.exec($G));){var $c=$W[0],$_=$x._watchMap[$c]||($x._watchMap[$c]=[]);$_.push($v),$A._sheet.I.notifer.on($c,$x,$x.changeData,[$c])}($_=$x._watchMap[$G]||($x._watchMap[$G]=[])).push($v),$A._sheet.I.notifer.on($G,$x,$x.changeData,[$G])}}}else if("var"===$g&&$x)$x[$K]=$X;else if("onClick"==$g){var $s=$a._runScript("(function(){"+$K+"})");$X.on("click",$x,$s)}else $X[$g]="true"===$K||"false"!==$K&&$K},$A.getCompInstance=function($X){var $g,$K=$X.props?$X.props.runtime:null;return $g=$K?$A.viewClassMap[$K]||$A.uiClassMap[$K]||$a.__classmap[$K]:$A.uiClassMap[$X.type],$X.props&&$X.props.hasOwnProperty("renderType")&&"instance"==$X.props.renderType?$g.instance:$g?new $g:null},$A.regComponent=function($X,$g){$A.uiClassMap[$X]=$g,$m.regClass($X,$g)},$A.regViewRuntime=function($X,$g){$A.viewClassMap[$X]=$g},$A.uiMap={},$A.viewClassMap={},$A._sheet=null,$x($A,["uiClassMap",function(){return this.uiClassMap={ViewStack:$XX,LinkButton:$Y,TextArea:$GX,ColorPicker:$p,Box:$C,Button:$Y,CheckBox:$S,Clip:$l,ComboBox:$L,Component:$P,HScrollBar:$h,HSlider:$J,Image:$u,Label:$O,List:$d,Panel:$z,ProgressBar:$e,Radio:$H,RadioGroup:$vX,ScrollBar:$q,Slider:$E,Tab:$TX,TextInput:$KX,View:$A,VScrollBar:$gX,VSlider:$xX,Tree:$y,HBox:$nX,VBox:$WX,Sprite:$w,Animation:$K,Text:$Q,FontClip:$j}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),$A.__init$=function(){$A._regs(),$V=function(){function $X($X,$g,$K){this.comp=null,this.prop=null,this.value=null,this.comp=$X,this.prop=$g,this.value=$K}return $n($X,""),$X.prototype.exe=function($X){var $g=$r.getBindFun(this.value);this.comp[this.prop]=$g.call(this,$X)},$X}()},$A}()),$S=function($X){function $K($X,$g){void 0===$g&&($g=""),$K.__super.call(this,$X,$g)}$n($K,"laya.ui.CheckBox",$X);var $g=$K.prototype;return $g.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},$g.initialize=function(){$X.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},$W(0,$g,"dataSource",$X.prototype._$get_dataSource,function($X){"boolean"==typeof(this._dataSource=$X)?this.selected=$X:"string"==typeof $X?this.selected="true"===$X:$a.superSet($Y,this,"dataSource",$X)}),$K}($Y),$R=function($X){function $g(){this._space=0,this._align="none",this._itemChanged=!1,$g.__super.call(this)}$n($g,"laya.ui.LayoutBox",$C);var $K=$g.prototype;return $K.addChild=function($X){return $X.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,$X)},$K.onResize=function($X){this._setItemChanged()},$K.addChildAt=function($X,$g){return $X.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,$X,$g)},$K.removeChild=function($X){return $X.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,$X)},$K.removeChildAt=function($X){return this.getChildAt($X).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,$X)},$K.refresh=function(){this._setItemChanged()},$K.changeItems=function(){this._itemChanged=!1},$K.sortItem=function($X){$X&&$X.sort(function($X,$g){return $X.y-$g.y})},$K._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},$W(0,$K,"space",function(){return this._space},function($X){this._space=$X,this._setItemChanged()}),$W(0,$K,"align",function(){return this._align},function($X){this._align=$X,this._setItemChanged()}),$g}(),$j=function($g){function $K($X,$g){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,$K.__super.call(this),$X&&(this.skin=$X),$g&&(this.sheet=$g)}$n($K,"laya.ui.FontClip",$g);var $X=$K.prototype;return $X.createChildren=function(){this._bitmap=new $M,this.on("loaded",this,this._onClipLoaded)},$X._onClipLoaded=function(){this.callLater(this.changeValue)},$X.changeValue=function(){var $X;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),$X=this._sources[0]))){var $g="horizontal"===this._direction;$g?(this._wordsW=this._valueArr.length*($X.sourceWidth+this.spaceX),this._wordsH=$X.sourceHeight):(this._wordsW=$X.sourceWidth,this._wordsH=($X.sourceHeight+this.spaceY)*this._valueArr.length);var $K=0;if(this._width)switch(this._align){case"center":$K=.5*(this._width-this._wordsW);break;case"right":$K=this._width-this._wordsW;break;default:$K=0}for(var $x=0,$Z=this._valueArr.length;$x<$Z;$x++){var $n=this._indexMap[this._valueArr.charAt($x)];this.sources[$n]&&($X=this.sources[$n],$g?this.graphics.drawTexture($X,$K+$x*($X.sourceWidth+this.spaceX),0,$X.sourceWidth,$X.sourceHeight):this.graphics.drawTexture($X,0+$K,$x*($X.sourceHeight+this.spaceY),$X.sourceWidth,$X.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},$X.destroy=function($X){void 0===$X&&($X=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),$g.prototype.destroy.call(this,$X)},$W(0,$X,"sheet",function(){return this._sheet},function($X){$X+="";var $g=(this._sheet=$X).split(" ");this._clipX=String($g[0]).length,this.clipY=$g.length,this._indexMap={};for(var $K=0;$K<this._clipY;$K++)for(var $x=$g[$K].split(""),$Z=0,$n=$x.length;$Z<$n;$Z++)this._indexMap[$x[$Z]]=$K*this._clipX+$Z}),$W(0,$X,"height",$g.prototype._$get_height,function($X){$a.superSet($l,this,"height",$X),this.callLater(this.changeValue)}),$W(0,$X,"direction",function(){return this._direction},function($X){this._direction=$X,this.callLater(this.changeValue)}),$W(0,$X,"value",function(){return this._valueArr?this._valueArr:""},function($X){$X+="",this._valueArr=$X,this.callLater(this.changeValue)}),$W(0,$X,"width",$g.prototype._$get_width,function($X){$a.superSet($l,this,"width",$X),this.callLater(this.changeValue)}),$W(0,$X,"spaceX",function(){return this._spaceX},function($X){this._spaceX=$X,"horizontal"===this._direction&&this.callLater(this.changeValue)}),$W(0,$X,"spaceY",function(){return this._spaceY},function($X){this._spaceY=$X,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),$W(0,$X,"align",function(){return this._align},function($X){this._align=$X,this.callLater(this.changeValue)}),$W(0,$X,"measureWidth",function(){return this._wordsW}),$W(0,$X,"measureHeight",function(){return this._wordsH}),$K}($l),$d=function($X){function $g(){this.selectHandler=null,this.renderHandler=null,this.renderTwHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this._twSwitch=!0,this._twDone=!0,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new $A,$g.__super.call(this)}$n($g,"laya.ui.List",$X);var $K=$g.prototype;return $a.imps($K,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),$K.destroy=function($X){void 0===$X&&($X=!0),this._content&&this._content.destroy($X),this._scrollBar&&this._scrollBar.destroy($X),laya.ui.Component.prototype.destroy.call(this,$X),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this._twSwitch=null,this._twDone=null,this.selectHandler=this.renderHandler=this.mouseHandler=this.renderTwHandler=null},$K.createChildren=function(){this.addChild(this._content=new $C)},$K.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$a.superGet($C,this,"cacheAs")),$a.superSet($C,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},$K.onScrollEnd=function(){$a.superSet($C,this,"cacheAs",this._$P.cacheAs)},$K._removePreScrollBar=function(){var $X=this.removeChildByName("scrollBar");$X&&$X.destroy(!0)},$K.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var $X=this._getOneCell(),$g=$X.width+this._spaceX||1,$K=$X.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/$g):Math.ceil(this._width/$g)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/$K):Math.round(this._height/$K));var $x=this._width?this._width:$g*this.repeatX-this._spaceX,$Z=this._height?this._height:$K*this.repeatY-this._spaceY;this._cellSize=this._isVertical?$K:$g,this._cellOffset=this._isVertical?$K*Math.max(this._repeatY2,this._repeatY)-$Z-this._spaceY:$g*Math.max(this._repeatX2,this._repeatX)-$x-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=$Z:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=$x),this.setContentSize($x,$Z);var $n=this._isVertical?this.repeatX:this.repeatY,$W=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,$n,$W),this._createdLine=$W,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},$K._getOneCell=function(){if(0===this._cells.length){var $X=this.createItem();if(this._offset.setTo($X.x,$X.y),this.cacheContent)return $X;this._cells.push($X)}return this._cells[0]},$K._createItems=function($X,$g,$K){var $x=this._content,$Z=this._getOneCell(),$n=$Z.width+this._spaceX,$W=$Z.height+this._spaceY;if(this.cacheContent){var $v=new $C;$v.cacheAsBitmap=!0,$v.pos((this._isVertical?0:$X)*$n,(this._isVertical?$X:0)*$W),this._content.addChild($v),this._content.optimizeScrollRect=!0,$x=$v}else{for(var $T=[],$G=this._cells.length-1;-1<$G;$G--){var $c=this._cells[$G];$c.removeSelf(),$T.push($c)}this._cells.length=0}for(var $_=$X;$_<$K;$_++)for(var $s=0;$s<$g;$s++)($Z=$T&&$T.length?$T.pop():this.createItem()).x=(this._isVertical?$s:$_)*$n-$x.x,$Z.y=(this._isVertical?$_:$s)*$W-$x.y,$Z.name="item"+($_*$g+$s),$x.addChild($Z),this.addCell($Z)},$K.createItem=function(){var $X=[];if("function"==typeof this._itemRender)var $g=new this._itemRender;else $g=$b.createComp(this._itemRender,null,null,$X);if(0==$X.length&&$g._watchMap){var $K=$g._watchMap;for(var $x in $K)for(var $Z=$K[$x],$n=0;$n<$Z.length;$n++){var $W=$Z[$n];$X.push($W.comp,$W.prop,$W.value)}}return $X.length&&($g._$bindData=$X),$g},$K.addCell=function($X){$X.on("click",this,this.onCellMouse),$X.on("rightclick",this,this.onCellMouse),$X.on("mouseover",this,this.onCellMouse),$X.on("mouseout",this,this.onCellMouse),$X.on("mousedown",this,this.onCellMouse),$X.on("mouseup",this,this.onCellMouse),this._cells.push($X)},$K.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var $X=0,$g=$X=0;$g<1e4;$g++){var $K=this.getChildByName("item"+$g);if(!$K)break;this.addCell($K),$X++}this.repeatY=$X}},$K.setContentSize=function($X,$g){this._content.width=$X,this._content.height=$g,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new $F),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,$X,$g),this._content.scrollRect=this._content.scrollRect),this.event("resize")},$K.onCellMouse=function($X){"mousedown"===$X.type&&(this._isMoved=!1);var $g=$X.currentTarget,$K=this._startIndex+this._cells.indexOf($g);$K<0||("click"===$X.type||"rightclick"===$X.type?this.selectEnable&&!this._isMoved?this.selectedIndex=$K:this.changeCellState($g,!0,0):"mouseover"!==$X.type&&"mouseout"!==$X.type||this._selectedIndex===$K||this.changeCellState($g,"mouseover"===$X.type,0),this.mouseHandler&&this.mouseHandler.runWith([$X,$K]))},$K.changeCellState=function($X,$g,$K){var $x=$X.getChildByName("selectBox");$x&&(this.selectEnable=!0,$x.visible=$g,$x.index=$K)},$K.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},$K.onScrollBarChange=function($X){this.runCallLater(this.changeCells);var $g=this._scrollBar.value,$K=this._isVertical?this.repeatX:this.repeatY,$x=this._isVertical?this.repeatY:this.repeatX,$Z=Math.floor($g/this._cellSize);if(this.cacheContent)$W=$x+1,this._createdLine-$Z<$W&&(this._createItems(this._createdLine,$K,this._createdLine+$W),this.renderItems(this._createdLine*$K,0),this._createdLine+=$W);else{var $n=$Z*$K,$W=0;if($n>this._startIndex){$W=$n-this._startIndex;var $v=!0,$T=this._startIndex+$K*($x+1);this._isMoved=!0}else $n<this._startIndex&&($W=this._startIndex-$n,$v=!1,$T=this._startIndex-1,this._isMoved=!0);for(var $G=0;$G<$W;$G++){if($v){var $c=this._cells.shift();this._cells[this._cells.length]=$c;var $_=$T+$G}else $c=this._cells.pop(),this._cells.unshift($c),$_=$T-$G;var $s=Math.floor($_/$K)*this._cellSize;this._isVertical?$c.y=$s:$c.x=$s,this.renderItem($c,$_)}this._startIndex=$n,this.changeSelectStatus()}var $V=this._content.scrollRect;this._isVertical?($V.y=$g-this._offset.y,$V.x=-this._offset.x):($V.y=-this._offset.y,$V.x=$g-this._offset.x),this._content.scrollRect=$V},$K.posCell=function($X,$g){if(this._scrollBar){var $K=this._isVertical?this.repeatX:this.repeatY,$x=(this._isVertical?this.repeatY:this.repeatX,Math.floor($g/$K)*this._cellSize);this._isVertical?$X.y=$x:$X.x=$x}},$K.changeSelectStatus=function(){for(var $X=0,$g=this._cells.length;$X<$g;$X++)this.changeCellState(this._cells[$X],this._selectedIndex===this._startIndex+$X,1)},$K.renderItems=function($X,$g){void 0===$X&&($X=0),void 0===$g&&($g=0);for(var $K=$X,$x=$g||this._cells.length;$K<$x;$K++)this.renderItem(this._cells[$K],this._startIndex+$K);this.changeSelectStatus(),this._twDone=!0},$K.renderItem=function($X,$g){this._array&&0<=$g&&$g<this._array.length?($X.visible=!0,$X._$bindData?($X._dataSource=this._array[$g],this._bindData($X,this._array[$g])):$X.dataSource=this._array[$g],this.cacheContent||this.posCell($X,$g),this.hasListener("render")&&this.event("render",[$X,$g]),this.renderHandler&&this.renderHandler.runWith([$X,$g]),this.renderTwHandler&&this.renderTwHandler.runWith([$X,$g])):($X.visible=!1,$X.dataSource=null)},$K._bindData=function($X,$g){for(var $K=$X._$bindData,$x=0,$Z=$K.length;$x<$Z;$x++){var $n=$K[$x++],$W=$K[$x++],$v=$K[$x],$T=$r.getBindFun($v);$n[$W]=$T.call(this,$g)}},$K.refresh=function(){this.array=this._array},$K.getItem=function($X){return-1<$X&&$X<this._array.length?this._array[$X]:null},$K.changeItem=function($X,$g){-1<$X&&$X<this._array.length&&(this._array[$X]=$g,$X>=this._startIndex&&$X<this._startIndex+this._cells.length&&this.renderItem(this.getCell($X),$X))},$K.setItem=function($X,$g){this.changeItem($X,$g)},$K.addItem=function($X){this._array.push($X),this.array=this._array},$K.addItemAt=function($X,$g){this._array.splice($g,0,$X),this.array=this._array},$K.deleteItem=function($X){this._array.splice($X,1),this.array=this._array},$K.getCell=function($X){return this.runCallLater(this.changeCells),-1<$X&&this._cells?this._cells[($X-this._startIndex)%this._cells.length]:null},$K.scrollTo=function($X){if(this._scrollBar){var $g=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor($X/$g)*this._cellSize}else this.startIndex=$X},$K.tweenTo=function($X,$g,$K){if(void 0===$g&&($g=200),this._scrollBar){var $x=this._isVertical?this.repeatX:this.repeatY;$D.to(this._scrollBar,{value:Math.floor($X/$x)*this._cellSize},$g,null,$K,0,!0)}else this.startIndex=$X,$K&&$K.run()},$K._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},$K.commitMeasure=function(){this.runCallLater(this.changeCells)},$W(0,$K,"cacheAs",$X.prototype._$get_cacheAs,function($X){$a.superSet($C,this,"cacheAs",$X),this._scrollBar&&(this._$P.cacheAs=null,"none"!==$X?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),$W(0,$K,"content",function(){return this._content}),$W(0,$K,"height",$X.prototype._$get_height,function($X){$X!=this._height&&($a.superSet($C,this,"height",$X),this._setCellChanged())}),$W(0,$K,"itemRender",function(){return this._itemRender},function($X){if(this._itemRender!=$X){this._itemRender=$X;for(var $g=this._cells.length-1;-1<$g;$g--)this._cells[$g].destroy();this._cells.length=0,this._setCellChanged()}}),$W(0,$K,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($X){this._removePreScrollBar();var $g=new $gX;$g.name="scrollBar",$g.right=0,$X&&" "!=$X&&($g.skin=$X),this.scrollBar=$g,this.addChild($g),this._setCellChanged()}),$W(0,$K,"page",function(){return this._page},function($X){this._page=$X,this._array&&(this._page=0<$X?$X:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),$W(0,$K,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($X){this._removePreScrollBar();var $g=new $h;$g.name="scrollBar",$g.bottom=0,$X&&" "!=$X&&($g.skin=$X),this.scrollBar=$g,this.addChild($g),this._setCellChanged()}),$W(0,$K,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function($X){this._repeatX=$X,this._setCellChanged()}),$W(0,$K,"scrollBar",function(){return this._scrollBar},function($X){this._scrollBar!=$X&&(this._scrollBar=$X)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),$W(0,$K,"width",$X.prototype._$get_width,function($X){$X!=this._width&&($a.superSet($C,this,"width",$X),this._setCellChanged())}),$W(0,$K,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function($X){this._repeatY=$X,this._setCellChanged()}),$W(0,$K,"spaceX",function(){return this._spaceX},function($X){this._spaceX=$X,this._setCellChanged()}),$W(0,$K,"spaceY",function(){return this._spaceY},function($X){this._spaceY=$X,this._setCellChanged()}),$W(0,$K,"selectedIndex",function(){return this._selectedIndex},function($X){this._selectedIndex!=$X&&(this._selectedIndex=$X,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith($X),this.startIndex=this._startIndex)}),$W(0,$K,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function($X){this.selectedIndex=this._array.indexOf($X)}),$W(0,$K,"length",function(){return this._array?this._array.length:0}),$W(0,$K,"selection",function(){return this.getCell(this._selectedIndex)},function($X){this.selectedIndex=this._startIndex+this._cells.indexOf($X)}),$W(0,$K,"startIndex",function(){return this._startIndex},function($X){this._startIndex=0<$X?$X:0,this.callLater(this.renderItems)}),$W(0,$K,"twSwitch",function(){return this._twSwitch},function($X){this._twSwitch=$X}),$W(0,$K,"twDone",function(){return this._twDone},function($X){this._twDone=$X}),$W(0,$K,"array",function(){return this._array},function($X){this.runCallLater(this.changeCells),this._array=$X||[];var $g=this._array.length;if(this.totalPage=Math.ceil($g/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<$g?this._selectedIndex:$g-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var $K=this._isVertical?this.repeatX:this.repeatY,$x=this._isVertical?this.repeatY:this.repeatX,$Z=Math.ceil($g/$K);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=$x/$Z,this._scrollBar.setScroll(0,($Z-$x)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),$W(0,$K,"dataSource",$X.prototype._$get_dataSource,function($X){"number"==typeof(this._dataSource=$X)&&Math.floor($X)==$X||"string"==typeof $X?this.selectedIndex=parseInt($X):$X instanceof Array?this.array=$X:$a.superSet($C,this,"dataSource",$X)}),$W(0,$K,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),$g}($C),$h=function($X){function $g(){$g.__super.call(this)}return $n($g,"laya.ui.HScrollBar",$X),$g.prototype.initialize=function(){$X.prototype.initialize.call(this),this.slider.isVertical=!1},$g}($q),$z=function($X){function $g(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,$g.__super.call(this),this.width=this.height=100}$n($g,"laya.ui.Panel",$X);var $K=$g.prototype;return $K.destroy=function($X){void 0===$X&&($X=!0),laya.ui.Component.prototype.destroy.call(this,$X),this._content&&this._content.destroy($X),this._vScrollBar&&this._vScrollBar.destroy($X),this._hScrollBar&&this._hScrollBar.destroy($X),this._vScrollBar=null,this._hScrollBar=null,this._content=null},$K.destroyChildren=function(){this._content.destroyChildren()},$K.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new $C)},$K.addChild=function($X){return $X.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild($X)},$K.onResize=function(){this._setScrollChanged()},$K.addChildAt=function($X,$g){return $X.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt($X,$g)},$K.removeChild=function($X){return $X.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild($X)},$K.removeChildAt=function($X){return this.getChildAt($X).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt($X)},$K.removeChildren=function($X,$g){return void 0===$X&&($X=0),void 0===$g&&($g=2147483647),this._content.removeChildren($X,$g),this._setScrollChanged(),this},$K.getChildAt=function($X){return this._content.getChildAt($X)},$K.getChildByName=function($X){return this._content.getChildByName($X)},$K.getChildIndex=function($X){return this._content.getChildIndex($X)},$K.changeScroll=function(){this._scrollChanged=!1;var $X=this.contentWidth||1,$g=this.contentHeight||1,$K=this._vScrollBar,$x=this._hScrollBar,$Z=$K&&$g>this._height,$n=$x&&$X>this._width,$W=$Z?this._width-$K.width:this._width,$v=$n?this._height-$x.height:this._height;$K&&($K.x=this._width-$K.width,$K.y=0,$K.height=this._height-($n?$x.height:0),$K.scrollSize=Math.max(.033*this._height,1),$K.thumbPercent=$v/$g,$K.setScroll(0,$g-$v,$K.value)),$x&&($x.x=0,$x.y=this._height-$x.height,$x.width=this._width-($Z?$K.width:0),$x.scrollSize=Math.max(.033*this._width,1),$x.thumbPercent=$W/$X,$x.setScroll(0,$X-$W,$x.value))},$K.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},$K.setContentSize=function($X,$g){var $K=this._content;$K.width=$X,$K.height=$g,$K.scrollRect||($K.scrollRect=new $F),$K.scrollRect.setTo(0,0,$X,$g),$K.scrollRect=$K.scrollRect},$K.onScrollBarChange=function($X){var $g=this._content.scrollRect;if($g){var $K=Math.round($X.value);$X.isVertical?$g.y=$K:$g.x=$K,this._content.scrollRect=$g}},$K.scrollTo=function($X,$g){void 0===$X&&($X=0),void 0===$g&&($g=0),this.vScrollBar&&(this.vScrollBar.value=$g),this.hScrollBar&&(this.hScrollBar.value=$X)},$K.refresh=function(){this.changeScroll()},$K.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$a.superGet($C,this,"cacheAs")),$a.superSet($C,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},$K.onScrollEnd=function(){$a.superSet($C,this,"cacheAs",this._$P.cacheAs)},$K._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},$W(0,$K,"numChildren",function(){return this._content.numChildren}),$W(0,$K,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($X){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new $h),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=$X}),$W(0,$K,"contentWidth",function(){for(var $X=0,$g=this._content.numChildren-1;-1<$g;$g--){var $K=this._content.getChildAt($g);$X=Math.max($K.x+$K.width*$K.scaleX,$X)}return $X}),$W(0,$K,"contentHeight",function(){for(var $X=0,$g=this._content.numChildren-1;-1<$g;$g--){var $K=this._content.getChildAt($g);$X=Math.max($K.y+$K.height*$K.scaleY,$X)}return $X}),$W(0,$K,"width",$X.prototype._$get_width,function($X){$a.superSet($C,this,"width",$X),this._setScrollChanged()}),$W(0,$K,"hScrollBar",function(){return this._hScrollBar}),$W(0,$K,"content",function(){return this._content}),$W(0,$K,"height",$X.prototype._$get_height,function($X){$a.superSet($C,this,"height",$X),this._setScrollChanged()}),$W(0,$K,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($X){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new $gX),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=$X}),$W(0,$K,"vScrollBar",function(){return this._vScrollBar}),$W(0,$K,"cacheAs",$X.prototype._$get_cacheAs,function($X){$a.superSet($C,this,"cacheAs",$X),this._$P.cacheAs=null,"none"!==$X?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),$g}($C),$J=function($X){function $g($X){$g.__super.call(this,$X),this.isVertical=!1}return $n($g,"laya.ui.HSlider",$E),$g}(),$o=function($X){function $K($X,$g){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,$K.__super.call(this),this.skin=$g,this.labels=$X}$n($K,"laya.ui.UIGroup",$X);var $g=$K.prototype;return $a.imps($g,{"laya.ui.IItem":!0}),$g.preinitialize=function(){this.mouseEnabled=!0},$g.destroy=function($X){void 0===$X&&($X=!0),laya.ui.Component.prototype.destroy.call(this,$X),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},$g.addItem=function($X,$g){void 0===$g&&($g=!0);var $K=$X,$x=this._items.length;if($K.name="item"+$x,this.addChild($K),this.initItems(),$g&&0<$x){var $Z=this._items[$x-1];"horizontal"==this._direction?$K.x=$Z.x+$Z.width+this._space:$K.y=$Z.y+$Z.height+this._space}else $g&&($K.x=0,$K.y=0);return $x},$g.delItem=function($X,$g){void 0===$g&&($g=!0);var $K=this._items.indexOf($X);if(-1!=$K){var $x=$X;this.removeChild($x);for(var $Z=$K+1,$n=this._items.length;$Z<$n;$Z++){var $W=this._items[$Z];$W.name="item"+($Z-1),$g&&("horizontal"==this._direction?$W.x-=$x.width+this._space:$W.y-=$x.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var $v;$v=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=$v}}},$g.initItems=function(){this._items||(this._items=[]);for(var $X=this._items.length=0;$X<1e4;$X++){var $g=this.getChildByName("item"+$X);if(null==$g)break;this._items.push($g),$g.selected=$X===this._selectedIndex,$g.clickHandler=$s.create(this,this.itemClick,[$X],!1)}},$g.itemClick=function($X){this.selectedIndex=$X},$g.setSelect=function($X,$g){this._items&&-1<$X&&$X<this._items.length&&(this._items[$X].selected=$g)},$g.createItem=function($X,$g){return null},$g.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var $X=0,$g=0,$K=this._items.length;$g<$K;$g++){var $x=this._items[$g];this._skin&&($x.skin=this._skin),this._labelColors&&($x.labelColors=this._labelColors),this._labelSize&&($x.labelSize=this._labelSize),this._labelStroke&&($x.labelStroke=this._labelStroke),this._labelStrokeColor&&($x.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&($x.strokeColors=this._strokeColors),this._labelBold&&($x.labelBold=this._labelBold),this._labelPadding&&($x.labelPadding=this._labelPadding),this._labelAlign&&($x.labelAlign=this._labelAlign),this._stateNum&&($x.stateNum=this._stateNum),this._labelFont&&($x.labelFont=this._labelFont),"horizontal"===this._direction?($x.y=0,$x.x=$X,$X+=$x.width+this._space):($x.x=0,$x.y=$X,$X+=$x.height+this._space)}this.changeSize()},$g.commitMeasure=function(){this.runCallLater(this.changeLabels)},$g._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},$W(0,$g,"labelStrokeColor",function(){return this._labelStrokeColor},function($X){this._labelStrokeColor!=$X&&(this._labelStrokeColor=$X,this._setLabelChanged())}),$W(0,$g,"skin",function(){return this._skin},function($X){this._skin!=$X&&(this._skin=$X,this._setLabelChanged())}),$W(0,$g,"selectedIndex",function(){return this._selectedIndex},function($X){this._selectedIndex!=$X&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$X,this.setSelect($X,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),$W(0,$g,"labels",function(){return this._labels},function($X){if(this._labels!=$X){if(this._labels=$X,this.removeChildren(),this._setLabelChanged(),this._labels)for(var $g=this._labels.split(","),$K=0,$x=$g.length;$K<$x;$K++){var $Z=this.createItem(this._skin,$g[$K]);$Z.name="item"+$K,this.addChild($Z)}this.initItems()}}),$W(0,$g,"strokeColors",function(){return this._strokeColors},function($X){this._strokeColors!=$X&&(this._strokeColors=$X,this._setLabelChanged())}),$W(0,$g,"labelColors",function(){return this._labelColors},function($X){this._labelColors!=$X&&(this._labelColors=$X,this._setLabelChanged())}),$W(0,$g,"labelStroke",function(){return this._labelStroke},function($X){this._labelStroke!=$X&&(this._labelStroke=$X,this._setLabelChanged())}),$W(0,$g,"labelSize",function(){return this._labelSize},function($X){this._labelSize!=$X&&(this._labelSize=$X,this._setLabelChanged())}),$W(0,$g,"stateNum",function(){return this._stateNum},function($X){this._stateNum!=$X&&(this._stateNum=$X,this._setLabelChanged())}),$W(0,$g,"labelBold",function(){return this._labelBold},function($X){this._labelBold!=$X&&(this._labelBold=$X,this._setLabelChanged())}),$W(0,$g,"labelFont",function(){return this._labelFont},function($X){this._labelFont!=$X&&(this._labelFont=$X,this._setLabelChanged())}),$W(0,$g,"labelPadding",function(){return this._labelPadding},function($X){this._labelPadding!=$X&&(this._labelPadding=$X,this._setLabelChanged())}),$W(0,$g,"direction",function(){return this._direction},function($X){this._direction=$X,this._setLabelChanged()}),$W(0,$g,"space",function(){return this._space},function($X){this._space=$X,this._setLabelChanged()}),$W(0,$g,"items",function(){return this._items}),$W(0,$g,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($X){this.selectedIndex=this._items.indexOf($X)}),$W(0,$g,"dataSource",$X.prototype._$get_dataSource,function($X){"number"==typeof(this._dataSource=$X)&&Math.floor($X)==$X||"string"==typeof $X?this.selectedIndex=parseInt($X):$X instanceof Array?this.labels=$X.join(","):$a.superSet($C,this,"dataSource",$X)}),$K}($C),$H=function($g){function $K($X,$g){this._value=null,void 0===$g&&($g=""),$K.__super.call(this,$X,$g)}$n($K,"laya.ui.Radio",$g);var $X=$K.prototype;return $X.destroy=function($X){void 0===$X&&($X=!0),$g.prototype.destroy.call(this,$X),this._value=null},$X.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},$X.initialize=function(){$g.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},$X.onClick=function($X){this.selected=!0},$W(0,$X,"value",function(){return null!=this._value?this._value:this.label},function($X){this._value=$X}),$K}($Y),$y=function($X){function $g(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,$g.__super.call(this),this.width=this.height=200}$n($g,"laya.ui.Tree",$X);var $K=$g.prototype;return $a.imps($K,{"laya.ui.IRender":!0}),$K.destroy=function($X){void 0===$X&&($X=!0),laya.ui.Component.prototype.destroy.call(this,$X),this._list&&this._list.destroy($X),this._list=null,this._source=null,this._renderHandler=null},$K.createChildren=function(){this.addChild(this._list=new $d),this._list.renderHandler=$s.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},$K.onListChange=function($X){this.event("change")},$K.getArray=function(){var $X,$g=[];for(var $K in this._source)$X=this._source[$K],this.getParentOpenStatus($X)&&($X.x=this._spaceLeft*this.getDepth($X),$g.push($X));return $g},$K.getDepth=function($X,$g){return void 0===$g&&($g=0),null==$X.nodeParent?$g:this.getDepth($X.nodeParent,$g+1)},$K.getParentOpenStatus=function($X){var $g=$X.nodeParent;return null==$g||!!$g.isOpen&&(null==$g.nodeParent||this.getParentOpenStatus($g))},$K.renderItem=function($X,$g){var $K=$X.dataSource;if($K){$X.left=$K.x;var $x=$X.getChildByName("arrow");$x&&($K.hasChild?($x.visible=!0,$x.index=$K.isOpen?1:0,$x.tag=$g,$x.off("click",this,this.onArrowClick),$x.on("click",this,this.onArrowClick)):$x.visible=!1);var $Z=$X.getChildByName("folder");$Z&&(2==$Z.clipY?$Z.index=$K.isDirectory?0:1:$Z.index=$K.isDirectory?$K.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([$X,$g])}},$K.onArrowClick=function($X){var $g=$X.currentTarget.tag;this._list.array[$g].isOpen=!this._list.array[$g].isOpen,this.event("open"),this._list.array=this.getArray()},$K.setItemState=function($X,$g){this._list.array[$X]&&(this._list.array[$X].isOpen=$g,this._list.array=this.getArray())},$K.fresh=function(){this._list.array=this.getArray(),this.repaint()},$K.parseXml=function($X,$g,$K,$x){var $Z,$n=$X.childNodes,$W=$n.length;if(!$x){$Z={};var $v,$T=$X.attributes;for(var $G in $T){var $c=($v=$T[$G]).nodeName,$_=$v.nodeValue;$Z[$c]="true"==$_||"false"!=$_&&$_}$Z.nodeParent=$K,0<$W&&($Z.isDirectory=!0),$Z.hasChild=0<$W,$g.push($Z)}for(var $s=0;$s<$W;$s++){var $V=$n[$s];this.parseXml($V,$g,$Z,!1)}},$K.parseOpenStatus=function($X,$g){for(var $K=0,$x=$g.length;$K<$x;$K++){var $Z=$g[$K];if($Z.isDirectory)for(var $n=0,$W=$X.length;$n<$W;$n++){var $v=$X[$n];if($v.isDirectory&&this.isSameParent($v,$Z)&&$Z.label==$v.label){$Z.isOpen=$v.isOpen;break}}}},$K.isSameParent=function($X,$g){return null==$X.nodeParent&&null==$g.nodeParent||null!=$X.nodeParent&&null!=$g.nodeParent&&($X.nodeParent.label==$g.nodeParent.label&&this.isSameParent($X.nodeParent,$g.nodeParent))},$K.filter=function($X){if(Boolean($X)){var $g=[];this.getFilterSource(this._source,$g,$X),this._list.array=$g}else this._list.array=this.getArray()},$K.getFilterSource=function($X,$g,$K){var $x;for(var $Z in $K=$K.toLocaleLowerCase(),$X)!($x=$X[$Z]).isDirectory&&-1<String($x.label).toLowerCase().indexOf($K)&&($x.x=0,$g.push($x)),$x.child&&0<$x.child.length&&this.getFilterSource($x.child,$g,$K)},$W(0,$K,"spaceBottom",function(){return this._list.spaceY},function($X){this._list.spaceY=$X}),$W(0,$K,"keepStatus",function(){return this._keepStatus},function($X){this._keepStatus=$X}),$W(0,$K,"itemRender",function(){return this._list.itemRender},function($X){this._list.itemRender=$X}),$W(0,$K,"array",function(){return this._list.array},function($X){this._keepStatus&&this._list.array&&$X&&this.parseOpenStatus(this._list.array,$X),this._source=$X,this._list.array=this.getArray()}),$W(0,$K,"mouseHandler",function(){return this._list.mouseHandler},function($X){this._list.mouseHandler=$X}),$W(0,$K,"dataSource",$X.prototype._$get_dataSource,function($X){this._dataSource=$X,$a.superSet($C,this,"dataSource",$X)}),$W(0,$K,"source",function(){return this._source}),$W(0,$K,"scrollBar",function(){return this._list.scrollBar}),$W(0,$K,"list",function(){return this._list}),$W(0,$K,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function($X){this._list.vScrollBarSkin=$X}),$W(0,$K,"renderHandler",function(){return this._renderHandler},function($X){this._renderHandler=$X}),$W(0,$K,"selectedIndex",function(){return this._list.selectedIndex},function($X){this._list.selectedIndex=$X}),$W(0,$K,"spaceLeft",function(){return this._spaceLeft},function($X){this._spaceLeft=$X}),$W(0,$K,"selectedItem",function(){return this._list.selectedItem},function($X){this._list.selectedItem=$X}),$W(0,$K,"width",$X.prototype._$get_width,function($X){$a.superSet($C,this,"width",$X),this._list.width=$X}),$W(0,$K,"height",$X.prototype._$get_height,function($X){$a.superSet($C,this,"height",$X),this._list.height=$X}),$W(0,$K,"xml",null,function($X){var $g=[];this.parseXml($X.childNodes[0],$g,null,!0),this.array=$g}),$W(0,$K,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),$g}($C),$XX=function($X){function $g(){this._items=null,this._selectedIndex=0,$g.__super.call(this),this._setIndexHandler=$s.create(this,this.setIndex,null,!1)}$n($g,"laya.ui.ViewStack",$X);var $K=$g.prototype;return $a.imps($K,{"laya.ui.IItem":!0}),$K.setItems=function($X){this.removeChildren();for(var $g=0,$K=0,$x=$X.length;$K<$x;$K++){var $Z=$X[$K];$Z&&($Z.name="item"+$g,this.addChild($Z),$g++)}this.initItems()},$K.addItem=function($X){$X.name="item"+this._items.length,this.addChild($X),this.initItems()},$K.initItems=function(){this._items=[];for(var $X=0;$X<1e4;$X++){var $g=this.getChildByName("item"+$X);if(null==$g)break;this._items.push($g),$g.visible=$X==this._selectedIndex}},$K.setSelect=function($X,$g){this._items&&-1<$X&&$X<this._items.length&&(this._items[$X].visible=$g)},$K.setIndex=function($X){this.selectedIndex=$X},$W(0,$K,"dataSource",$X.prototype._$get_dataSource,function($X){if("number"==typeof(this._dataSource=$X)&&Math.floor($X)==$X||"string"==typeof $X)this.selectedIndex=parseInt($X);else for(var $g in this._dataSource)this.hasOwnProperty($g)&&(this[$g]=this._dataSource[$g])}),$W(0,$K,"selectedIndex",function(){return this._selectedIndex},function($X){this._selectedIndex!=$X&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$X,this.setSelect(this._selectedIndex,!0))}),$W(0,$K,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($X){this.selectedIndex=this._items.indexOf($X)}),$W(0,$K,"items",function(){return this._items}),$W(0,$K,"setIndexHandler",function(){return this._setIndexHandler},function($X){this._setIndexHandler=$X}),$g}($C),$gX=function($X){function $g(){$g.__super.call(this)}return $n($g,"laya.ui.VScrollBar",$q),$g}(),$KX=function($g){function $K($X){this._bg=null,this._skin=null,$K.__super.call(this),void 0===$X&&($X=""),this.text=$X,this.skin=this.skin}$n($K,"laya.ui.TextInput",$g);var $X=$K.prototype;return $X.preinitialize=function(){this.mouseEnabled=!0},$X.destroy=function($X){$U.clearCache(this,this._skin),void 0===$X&&($X=!0),$g.prototype.destroy.call(this,$X),this._bg&&this._bg.destroy(),this._bg=null},$X.createChildren=function(){this.addChild(this._tf=new $V),this._tf.padding=$I.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},$X._onFocus=function(){this.event("focus",this)},$X._onBlur=function(){this.event("blur",this)},$X._onInput=function(){this.event("input",this)},$X._onEnter=function(){this.event("enter",this)},$X.initialize=function(){this.width=128,this.height=22},$X.select=function(){this._tf.select()},$X.setSelection=function($X,$g){this._tf.setSelection($X,$g)},$W(0,$X,"text",$g.prototype._$get_text,function($X){this._tf.text!=$X&&($X+="",this._tf.text=$X,this.event("change"))}),$W(0,$X,"bg",function(){return this._bg},function($X){this.graphics=this._bg=$X}),$W(0,$X,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function($X){this._tf.inputElementYAdjuster=$X}),$W(0,$X,"multiline",function(){return this._tf.multiline},function($X){this._tf.multiline=$X}),$W(0,$X,"skin",function(){return this._skin},function($X){this._skin!=$X&&($U.clearCache(this,this._skin),this._skin=$X,this._bg||(this.graphics=this._bg=new $M),$U.keepCache(this,this._skin),this._bg.source=$U.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),$W(0,$X,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function($X){this._bg||(this.graphics=this._bg=new $M),this._bg.sizeGrid=$r.fillArray($I.defaultSizeGrid,$X,Number)}),$W(0,$X,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function($X){this._tf.inputElementXAdjuster=$X}),$W(0,$X,"width",$g.prototype._$get_width,function($X){$a.superSet($O,this,"width",$X),this._bg&&(this._bg.width=$X)}),$W(0,$X,"height",$g.prototype._$get_height,function($X){$a.superSet($O,this,"height",$X),this._bg&&(this._bg.height=$X)}),$W(0,$X,"editable",function(){return this._tf.editable},function($X){this._tf.editable=$X}),$W(0,$X,"restrict",function(){return this._tf.restrict},function($X){this._tf.restrict=$X}),$W(0,$X,"prompt",function(){return this._tf.prompt},function($X){this._tf.prompt=$X}),$W(0,$X,"promptColor",function(){return this._tf.promptColor},function($X){this._tf.promptColor=$X}),$W(0,$X,"maxChars",function(){return this._tf.maxChars},function($X){this._tf.maxChars=$X}),$W(0,$X,"focus",function(){return this._tf.focus},function($X){this._tf.focus=$X}),$W(0,$X,"type",function(){return this._tf.type},function($X){this._tf.type=$X}),$W(0,$X,"asPassword",function(){return this._tf.asPassword},function($X){this._tf.asPassword=$X}),$K}($O),$xX=function($X){function $g(){$g.__super.call(this)}return $n($g,"laya.ui.VSlider",$E),$g}(),$ZX=function($X){function $x(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,$x.__super.call(this)}$n($x,"laya.ui.Dialog",$X);var $g=$x.prototype;return $g.initialize=function(){this.popupEffect=$x.manager.popupEffectHandler,this.closeEffect=$x.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},$g._dealDragArea=function(){var $X=this.getChildByName("drag");$X&&(this.dragArea=$X.x+","+$X.y+","+$X.width+","+$X.height,$X.removeSelf())},$g._onClick=function($X){var $g=$X.target;if($g)switch($g.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close($g.name)}},$g.show=function($X,$g){void 0===$X&&($X=!1),void 0===$g&&($g=!0),this._open(!1,$X,$g)},$g.popup=function($X,$g){void 0===$X&&($X=!1),void 0===$g&&($g=!0),this._open(!0,$X,$g)},$g._open=function($X,$g,$K){$x.manager.lock(!1),this.isModal=$X,$x.manager.open(this,$g,$K)},$g.onOpened=function(){},$g.close=function($X,$g){void 0===$g&&($g=!0),$x.manager.close(this,$X,$g)},$g.onClosed=function($X){},$g._onMouseDown=function($X){var $g=this.getMousePoint();this._dragArea.contains($g.x,$g.y)?this.startDrag():this.stopDrag()},$W(0,$g,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function($X){if($X){var $g=$r.fillArray([0,0,0,0],$X,Number);this._dragArea=new $F($g[0],$g[1],$g[2],$g[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),$W(0,$g,"isPopup",function(){return null!=this.parent}),$W(0,$g,"zOrder",$X.prototype._$get_zOrder,function($X){$a.superSet($b,this,"zOrder",$X),$x.manager._checkMask()}),$W(1,$x,"manager",function(){return $x._manager=$x._manager||new $N},function($X){$x._manager=$X}),$x.setLockView=function($X){$x.manager.setLockView($X)},$x.lock=function($X){$x.manager.lock($X)},$x.closeAll=function(){$x.manager.closeAll()},$x.getDialogsByGroup=function($X){return $x.manager.getDialogsByGroup($X)},$x.closeByGroup=function($X){return $x.manager.closeByGroup($X)},$x.CLOSE="close",$x.CANCEL="cancel",$x.SURE="sure",$x.NO="no",$x.OK="ok",$x.YES="yes",$x._manager=null,$x}($b),$nX=function($X){function $g(){$g.__super.call(this)}$n($g,"laya.ui.HBox",$X);var $K=$g.prototype;return $K.sortItem=function($X){$X&&$X.sort(function($X,$g){return $X.x-$g.x})},$K.changeItems=function(){this._itemChanged=!1;for(var $X=[],$g=0,$K=0,$x=this.numChildren;$K<$x;$K++){var $Z=this.getChildAt($K);$Z&&$Z.layoutEnabled&&($X.push($Z),$g=this._height?this._height:Math.max($g,$Z.height*$Z.scaleY))}this.sortItem($X);var $n=0;for($K=0,$x=$X.length;$K<$x;$K++)($Z=$X[$K]).x=$n,$n+=$Z.width*$Z.scaleX+this._space,"top"==this._align?$Z.y=0:"middle"==this._align?$Z.y=.5*($g-$Z.height*$Z.scaleY):"bottom"==this._align&&($Z.y=$g-$Z.height*$Z.scaleY);this.changeSize()},$W(0,$K,"height",$X.prototype._$get_height,function($X){this._height!=$X&&($a.superSet($R,this,"height",$X),this.callLater(this.changeItems))}),$g.NONE="none",$g.TOP="top",$g.MIDDLE="middle",$g.BOTTOM="bottom",$g}($R),$WX=function($X){function $g(){$g.__super.call(this)}$n($g,"laya.ui.VBox",$X);var $K=$g.prototype;return $K.changeItems=function(){this._itemChanged=!1;for(var $X=[],$g=0,$K=0,$x=this.numChildren;$K<$x;$K++){var $Z=this.getChildAt($K);$Z&&$Z.layoutEnabled&&($X.push($Z),$g=this._width?this._width:Math.max($g,$Z.width*$Z.scaleX))}this.sortItem($X);var $n=0;for($K=0,$x=$X.length;$K<$x;$K++)($Z=$X[$K]).y=$n,$n+=$Z.height*$Z.scaleY+this._space,"left"==this._align?$Z.x=0:"center"==this._align?$Z.x=.5*($g-$Z.width*$Z.scaleX):"right"==this._align&&($Z.x=$g-$Z.width*$Z.scaleX);this.changeSize()},$W(0,$K,"width",$X.prototype._$get_width,function($X){this._width!=$X&&($a.superSet($R,this,"width",$X),this.callLater(this.changeItems))}),$g.NONE="none",$g.LEFT="left",$g.CENTER="center",$g.RIGHT="right",$g}($R),$vX=function($X){function $g(){$g.__super.call(this)}return $n($g,"laya.ui.RadioGroup",$o),$g.prototype.createItem=function($X,$g){return new $H($X,$g)},$g}(),$TX=function($X){function $g(){$g.__super.call(this)}return $n($g,"laya.ui.Tab",$o),$g.prototype.createItem=function($X,$g){return new $Y($X,$g)},$g}(),$GX=function($g){function $K($X){this._vScrollBar=null,this._hScrollBar=null,void 0===$X&&($X=""),$K.__super.call(this,$X)}$n($K,"laya.ui.TextArea",$g);var $X=$K.prototype;return $X.destroy=function($X){void 0===$X&&($X=!0),$g.prototype.destroy.call(this,$X),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},$X.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},$X.onVBarChanged=function($X){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},$X.onHBarChanged=function($X){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},$X.changeScroll=function(){var $X=this._vScrollBar&&0<this._tf.maxScrollY,$g=this._hScrollBar&&0<this._tf.maxScrollX,$K=$X?this._width-this._vScrollBar.width:this._width,$x=$g?this._height-this._hScrollBar.height:this._height,$Z=this._tf.padding||$I.labelPadding;this._tf.width=$K,this._tf.height=$x,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-$Z[2],this._vScrollBar.y=$Z[1],this._vScrollBar.height=this._height-($g?this._hScrollBar.height:0)-$Z[1]-$Z[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=$x/Math.max(this._tf.textHeight,$x),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=$X),this._hScrollBar&&(this._hScrollBar.x=$Z[0],this._hScrollBar.y=this._height-this._hScrollBar.height-$Z[3],this._hScrollBar.width=this._width-($X?this._vScrollBar.width:0)-$Z[0]-$Z[2],this._hScrollBar.scrollSize=Math.max(.033*$K,1),this._hScrollBar.thumbPercent=$K/Math.max(this._tf.textWidth,$K),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=$g)},$X.scrollTo=function($X){this.commitMeasure(),this._tf.scrollY=$X},$W(0,$X,"scrollY",function(){return this._tf.scrollY}),$W(0,$X,"width",$g.prototype._$get_width,function($X){$a.superSet($KX,this,"width",$X),this.callLater(this.changeScroll)}),$W(0,$X,"hScrollBar",function(){return this._hScrollBar}),$W(0,$X,"height",$g.prototype._$get_height,function($X){$a.superSet($KX,this,"height",$X),this.callLater(this.changeScroll)}),$W(0,$X,"maxScrollX",function(){return this._tf.maxScrollX}),$W(0,$X,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($X){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new $gX),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=$X}),$W(0,$X,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($X){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new $h),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=$X}),$W(0,$X,"vScrollBar",function(){return this._vScrollBar}),$W(0,$X,"maxScrollY",function(){return this._tf.maxScrollY}),$W(0,$X,"scrollX",function(){return this._tf.scrollX}),$K}($KX);!function($X){function $g(){this._uiView=null,this.isCloseOther=!1,$g.__super.call(this)}$n($g,"laya.ui.AsynDialog",$ZX);var $K=$g.prototype;$K.createView=function($X){this._uiView=$X},$K._open=function($X,$g,$K){this.isModal=$X,this.isCloseOther=$g,$ZX.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},$K.onCreated=function(){this.createUI(),this.onOpen()},$K.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},$K.onOpen=function(){$ZX.manager.open(this,this.isCloseOther),$ZX.manager.lock(!1)},$K.close=function($X,$g){void 0===$g&&($g=!0),$ZX.manager.close(this),this.onClose()},$K.onClose=function(){},$K.destroy=function($X){void 0===$X&&($X=!0),laya.ui.View.prototype.destroy.call(this,$X),this._uiView=null,this.onDestroy()},$K.onDestroy=function(){}}();$a.__init([$b])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($X,$g){"use strict";for(var $K in Object.defineProperty($g,"__esModule",{value:!0}),Laya){var $x=Laya[$K];$x&&$x.__isclass&&($g[$K]=$x)}}),function($s,$X,$Q){$Q.un,$Q.uns;var $_=$Q.static,$V=$Q.class,$A=$Q.getset,$x=$Q.__newvec,$w=laya.maths.Arith,$W=laya.webgl.atlas.AtlasResourceManager,$K=laya.webgl.shader.BaseShader,$P=laya.utils.Browser,$v=laya.webgl.utils.Buffer,$f=laya.utils.Byte,$Z=laya.utils.ClassUtils,$T=$Q.Config,$n=(laya.events.Event,laya.events.EventDispatcher),$I=laya.utils.Handler,$F=laya.net.Loader,$g=laya.net.LoaderManager,$G=(laya.maths.MathUtil,laya.display.Node),$a=laya.renders.Render,$c=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),$m=laya.resource.Resource,$U=laya.utils.RunDriver,$$=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),$D=laya.display.Sprite,$B=laya.utils.Stat,$i=laya.utils.StringKey,$r=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),$k=laya.utils.Utils,$t=laya.webgl.WebGL,$M=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;$Q.interface("laya.d3.core.IClone"),$Q.interface("laya.d3.graphics.IVertex"),$Q.interface("laya.d3.core.render.IUpdate"),$Q.interface("laya.d3.core.scene.ITreeNode"),$Q.interface("laya.d3.core.render.IRenderable");(function(){function $Y(){}$V($Y,"laya.d3.animation.AnimationClipParser01"),$Y.READ_DATA=function(){$Y._DATA.offset=$Y._reader.getUint32(),$Y._DATA.size=$Y._reader.getUint32()},$Y.READ_BLOCK=function(){for(var $X=$Y._BLOCK.count=$Y._reader.getUint16(),$g=$Y._BLOCK.blockStarts=[],$K=$Y._BLOCK.blockLengths=[],$x=0;$x<$X;$x++)$g.push($Y._reader.getUint32()),$K.push($Y._reader.getUint32())},$Y.READ_STRINGS=function(){var $X=$Y._reader.getUint32(),$g=$Y._reader.getUint16(),$K=$Y._reader.pos;$Y._reader.pos=$X+$Y._DATA.offset;for(var $x=0;$x<$g;$x++)$Y._strings[$x]=$Y._reader.readUTFString();$Y._reader.pos=$K},$Y.parse=function($X,$g){$Y._animationClip=$X;($Y._reader=$g).__getBuffer();$Y.READ_DATA(),$Y.READ_BLOCK(),$Y.READ_STRINGS();for(var $K=0,$x=$Y._BLOCK.count;$K<$x;$K++){var $Z=$g.getUint16(),$n=$Y._strings[$Z],$W=$Y["READ_"+$n];if(null==$W)throw new Error("model file err,no this function:"+$Z+" "+$n);$W.call()}},$Y.READ_ANIMATIONS=function(){var $X,$g=0,$K=0,$x=$Y._reader,$Z=$x.__getBuffer(),$n=[],$W=$x.getUint8();for($n.length=$W,$g=0;$g<$W;$g++)$n[$g]=$x.getUint16();var $v=[],$T=$x.getUint16();for($v.length=$T,$g=0;$g<$T;$g++)$v[$g]=$x.getFloat32();var $G=$Y._animationClip;$G.name=$Y._strings[$x.getUint16()];var $c=$G._duration=$x.getFloat32();$G.islooping=!!$x.getByte(),$G._frameRate=$x.getInt16();var $_=$x.getInt16(),$s=$G._nodes=new Array;$s.length=$_,($G._publicClipDatas=[]).length=$_;var $V=$G._nodesMap={},$A=0,$a=0;for($g=0;$g<$_;$g++){$X=$s[$g]=new $e;var $m=$x.getUint16(),$F=$X.path=[];for($F.length=$m,$K=0;$K<$m;$K++)$F[$K]=$Y._strings[$x.getUint16()];var $U=$F.join("/"),$$=$V[$U];$$||($V[$U]=$$=[]),$$.push($X);var $w=$x.getInt16();-1!==$w&&($X.componentType=$Y._strings[$w]);var $Q=$u._propertyIndexDic[$Y._strings[$x.getUint16()]];if(null==$Q)throw new Error("AnimationClipParser01:unknown property name.");var $f=$Q<4,$D=!$f||$f&&""===$F[0];($X._cacheProperty=$D)?$A++:$a++,$X.propertyNameID=$Q;var $B=$n[$x.getUint8()];$X.keyFrameWidth=$B/4;var $i=$X.keyFrames=[],$k=$i.length=$x.getUint16(),$I=null,$r=NaN;for($K=0;$K<$k;$K++){var $t=$i[$K]=new $O;$r=$t.startTime=$v[$x.getUint16()];var $M=$x.pos;$t.inTangent=new Float32Array($Z.slice($M,$M+$B)),$x.pos+=$B,$M=$x.pos,$t.outTangent=new Float32Array($Z.slice($M,$M+$B)),$x.pos+=$B,$M=$x.pos,$t.data=new Float32Array($Z.slice($M,$M+$B)),$x.pos+=$B,$I&&($I.next=$t,$I.duration=$r-$I.startTime),$I=$t}$t.next=null,$t.duration=$c-$r}var $P=$G._nodeToCachePropertyMap=new Int32Array($_),$N=$G._cachePropertyMap=new Int32Array($A),$C=$G._unCachePropertyMap=new Int32Array($a);for($A=$a=0,$g=0;$g<$_;$g++)($X=$s[$g])._cacheProperty?($P[$g]=$A,$N[$A++]=$g):$C[$a++]=$g},$Y._animationClip=null,$Y._reader=null,$Y._strings=[],$_($Y,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function $q(){}$V($q,"laya.d3.animation.AnimationClipParser02"),$q.READ_DATA=function(){$q._DATA.offset=$q._reader.getUint32(),$q._DATA.size=$q._reader.getUint32()},$q.READ_BLOCK=function(){for(var $X=$q._BLOCK.count=$q._reader.getUint16(),$g=$q._BLOCK.blockStarts=[],$K=$q._BLOCK.blockLengths=[],$x=0;$x<$X;$x++)$g.push($q._reader.getUint32()),$K.push($q._reader.getUint32())},$q.READ_STRINGS=function(){var $X=$q._reader.getUint32(),$g=$q._reader.getUint16(),$K=$q._reader.pos;$q._reader.pos=$X+$q._DATA.offset;for(var $x=0;$x<$g;$x++)$q._strings[$x]=$q._reader.readUTFString();$q._reader.pos=$K},$q.parse=function($X,$g){$q._animationClip=$X;($q._reader=$g).__getBuffer();$q.READ_DATA(),$q.READ_BLOCK(),$q.READ_STRINGS();for(var $K=0,$x=$q._BLOCK.count;$K<$x;$K++){var $Z=$g.getUint16(),$n=$q._strings[$Z],$W=$q["READ_"+$n];if(null==$W)throw new Error("model file err,no this function:"+$Z+" "+$n);$W.call()}},$q.READ_ANIMATIONS=function(){var $X,$g=0,$K=0,$x=$q._reader,$Z=$x.__getBuffer(),$n=[],$W=$x.getUint8();for($n.length=$W,$g=0;$g<$W;$g++)$n[$g]=$x.getUint16();var $v=[],$T=$x.getUint16();for($v.length=$T,$g=0;$g<$T;$g++)$v[$g]=$x.getFloat32();var $G=$q._animationClip;$G.name=$q._strings[$x.getUint16()];var $c=$G._duration=$x.getFloat32();$G.islooping=!!$x.getByte(),$G._frameRate=$x.getInt16();var $_=$x.getInt16(),$s=$G._nodes=new Array;$s.length=$_,($G._publicClipDatas=[]).length=$_;var $V=$G._nodesMap={},$A=0,$a=0;for($g=0;$g<$_;$g++){$X=$s[$g]=new $e;var $m=$x.getUint16(),$F=$X.path=[];for($F.length=$m,$K=0;$K<$m;$K++)$F[$K]=$q._strings[$x.getUint16()];var $U=$F.join("/"),$$=$V[$U];$$||($V[$U]=$$=[]),$$.push($X);var $w=$x.getInt16();-1!==$w&&($X.componentType=$q._strings[$w]);var $Q=$u._propertyIndexDic[$q._strings[$x.getUint16()]];if(null==$Q)throw new Error("AnimationClipParser02:unknown property name.");var $f=$Q<4,$D=!$f||$f&&""===$F[0];($X._cacheProperty=$D)?$A++:$a++,$X.propertyNameID=$Q;var $B=$n[$x.getUint8()];$X.keyFrameWidth=$B/4;var $i=$X.keyFrames=[],$k=$i.length=$x.getUint16(),$I=null,$r=NaN;for($K=0;$K<$k;$K++){var $t=$i[$K]=new $O;$r=$t.startTime=$v[$x.getUint16()];var $M=$x.pos;$t.inTangent=new Float32Array($Z.slice($M,$M+$B)),$x.pos+=$B,$M=$x.pos,$t.outTangent=new Float32Array($Z.slice($M,$M+$B)),$x.pos+=$B,$M=$x.pos,$t.data=new Float32Array($Z.slice($M,$M+$B)),$x.pos+=$B,$I&&($I.next=$t,$I.duration=$r-$I.startTime),$I=$t}$t.next=null,$t.duration=$c-$r}var $P=$x.getUint16();for($g=0;$g<$P;$g++){var $N,$C=new $E;$C.time=$x.getFloat32(),$C.eventName=$q._strings[$x.getUint16()];var $Y=$x.getUint16();for(0<$Y&&($C.params=$N=[]),$K=0;$K<$Y;$K++){switch($x.getByte()){case 0:$N.push(!!$x.getByte());break;case 1:$N.push($x.getInt32());break;case 2:$N.push($x.getFloat32());break;case 3:$N.push($q._strings[$x.getUint16()]);break;default:throw new Error("unknown type.")}}$G.addEvent($C)}var $l=$G._nodeToCachePropertyMap=new Int32Array($_),$p=$G._cachePropertyMap=new Int32Array($A),$L=$G._unCachePropertyMap=new Int32Array($a);for($A=$a=0,$g=0;$g<$_;$g++)($X=$s[$g])._cacheProperty?($l[$g]=$A,$p[$A++]=$g):$L[$a++]=$g},$q._animationClip=null,$q._reader=null,$q._strings=[],$_($q,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var $E=function(){function $X(){this.time=NaN,this.eventName=null,this.params=null}return $V($X,"laya.d3.animation.AnimationEvent"),$X}(),$u=function(){function $x(){this._childs=[],this.transform=new $Ug(this)}$V($x,"laya.d3.animation.AnimationNode");var $X=$x.prototype;return $Q.imps($X,{"laya.d3.core.IClone":!0}),$X.addChild=function($X){$X._parent=this,$X.transform.setParent(this.transform),this._childs.push($X)},$X.removeChild=function($X){var $g=this._childs.indexOf($X);-1!==$g&&this._childs.splice($g,1)},$X.getChildByName=function($X){for(var $g=0,$K=this._childs.length;$g<$K;$g++){var $x=this._childs[$g];if($x.name===$X)return $x}return null},$X.getChildByIndex=function($X){return this._childs[$X]},$X.getChildCount=function(){return this._childs.length},$X.cloneTo=function($X){var $g=$X;$g.name=this.name;for(var $K=0,$x=this._childs.length;$K<$x;$K++){var $Z=this._childs[$K],$n=$Z.clone();$g.addChild($n);var $W=$Z.transform,$v=$n.transform;$v.setLocalPosition($W.getLocalPosition()),$v.setLocalRotation($W.getLocalRotation()),$v.setLocalScale($W.getLocalScale()),$v._localRotationEuler=$W._localRotationEuler,$v._setWorldMatrixIgnoreUpdate($W.getWorldMatrix())}},$X.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$x.__init__=function(){$x.registerAnimationNodeProperty("localPosition",$x._getLocalPosition,$x._setLocalPosition),$x.registerAnimationNodeProperty("localRotation",$x._getLocalRotation,$x._setLocalRotation),$x.registerAnimationNodeProperty("localScale",$x._getLocalScale,$x._setLocalScale),$x.registerAnimationNodeProperty("localRotationEuler",$x._getLocalRotationEuler,$x._setLocalRotationEuler),$x.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",$x._getParticleRenderSharedMaterialTintColor,$x._setParticleRenderSharedMaterialTintColor),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",$x._getMeshRenderSharedMaterialTilingOffset,$x._setMeshRenderSharedMaterialTilingOffset),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",$x._getMeshRenderSharedMaterialAlbedo,$x._setMeshRenderSharedMaterialAlbedo),$x.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",$x._getSkinnedMeshRenderSharedMaterialTilingOffset,$x._setSkinnedMeshRenderSharedMaterialTilingOffset),$x.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",$x._getSkinnedMeshRenderSharedMaterialAlbedo,$x._setSkinnedMeshRenderSharedMaterialAlbedo),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",$x._getMeshRenderSharedMaterialAlbedo,$x._setMeshRenderSharedMaterialAlbedo),$x.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",$x._getSkinnedMeshRenderSharedMaterialAlbedo,$x._setSkinnedMeshRenderSharedMaterialAlbedo),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",$x._getMeshRenderSharedMaterialIntensity,$x._setMeshRenderSharedMaterialIntensity),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",$x._getMeshRenderSharedMaterialAlpha,$x._setMeshRenderSharedMaterialAlpha),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",$x._getMeshRenderSharedMaterialAlphaColor,$x._setMeshRenderSharedMaterialAlphaColor),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",$x._getMeshRenderSharedMaterialBaseColor,$x._setMeshRenderSharedMaterialBaseColor),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",$x._getMeshRenderSharedMaterialDissolve,$x._setMeshRenderSharedMaterialDissolve),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",$x._getMeshRenderSharedMaterialDissolveSpeed,$x._setMeshRenderSharedMaterialDissolveSpeed),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",$x._getMeshRenderSharedMaterialMMultiplier,$x._setMeshRenderSharedMaterialMMultiplier),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",$x._getMeshRenderSharedMaterialBaseScrollSpeedX,$x._setMeshRenderSharedMaterialBaseScrollSpeedX),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",$x._getMeshRenderSharedMaterialBaseScrollSpeedY,$x._setMeshRenderSharedMaterialBaseScrollSpeedY),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",$x._getMeshRenderSharedMaterialSecondScrollSpeedX,$x._setMeshRenderSharedMaterialSecondScrollSpeedX),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",$x._getMeshRenderSharedMaterialSecondScrollSpeedY,$x._setMeshRenderSharedMaterialSecondScrollSpeedY),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",$x._getMeshRenderSharedMaterialDetailTilingOffset,$x._setMeshRenderSharedMaterialDetailTilingOffset),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",$x._getMeshRenderSharedMaterialDissolveTilingOffset,$x._setMeshRenderSharedMaterialDissolveTilingOffset),$x.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",$x._getMeshRenderSharedMaterialMaskTilingOffset,$x._setMeshRenderSharedMaterialMaskTilingOffset)},$x.registerAnimationNodeProperty=function($X,$g,$K){if($x._propertyIndexDic[$X])throw new Error("AnimationNode: this propertyName has registered.");$x._propertyIndexDic[$X]=$x._propertyIDCounter,$x._propertyGetFuncs[$x._propertyIDCounter]=$g,$x._propertySetFuncs[$x._propertyIDCounter]=$K,$x._propertyIDCounter++},$x._getLocalPosition=function($X,$g){return $X?$X.transform.getLocalPosition():$g._transform.localPosition.elements},$x._setLocalPosition=function($X,$g,$K){if($X)$X.transform.setLocalPosition($K);else{var $x=$g._transform,$Z=$x.localPosition;$Z.elements=$K,$x.localPosition=$Z}},$x._getLocalRotation=function($X,$g){return $X?$X.transform.getLocalRotation():$g._transform.localRotation.elements},$x._setLocalRotation=function($X,$g,$K){if($X)$X.transform.setLocalRotation($K);else{var $x=$g._transform,$Z=$x.localRotation;$Z.elements=$K,$x.localRotation=$Z}},$x._getLocalScale=function($X,$g){return $X?$X.transform.getLocalScale():$g._transform.localScale.elements},$x._setLocalScale=function($X,$g,$K){if($X)$X.transform.setLocalScale($K);else{var $x=$g._transform,$Z=$x.localScale;$Z.elements=$K,$x.localScale=$Z}},$x._getLocalRotationEuler=function($X,$g){return $X?$X.transform.getLocalRotationEuler():$g._transform.localRotationEuler.elements},$x._setLocalRotationEuler=function($X,$g,$K){if($X)$X.transform.setLocalRotationEuler($K);else{var $x=$g._transform,$Z=$x.localRotationEuler;$Z.elements=$K,$x.localRotationEuler=$Z}},$x._getMeshRenderSharedMaterialTilingOffset=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return $g.meshRender.sharedMaterial.tilingOffset.elements},$x._setMeshRenderSharedMaterialTilingOffset=function($X,$g,$K){var $x,$Z;if($X){var $n=$X.transform._entity;$n&&(($Z=($x=$n.owner.meshRender.material).tilingOffset).elements=$K,$x.tilingOffset=$Z)}else($Z=($x=$g.meshRender.material).tilingOffset).elements=$K,$x.tilingOffset=$Z},$x._getMeshRenderSharedMaterialAlbedo=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.albedoColor.elements:null}return $g.meshRender.sharedMaterial.albedoColor.elements},$x._setMeshRenderSharedMaterialAlbedo=function($X,$g,$K){var $x,$Z;if($X){var $n=$X.transform._entity;$n&&(($Z=($x=$n.owner.meshRender.material).albedoColor).elements=$K,$x.albedoColor=$Z)}else($Z=($x=$g.meshRender.material).albedoColor).elements=$K,$x.albedoColor=$Z},$x._getSkinnedMeshRenderSharedMaterialTilingOffset=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return $g.skinnedMeshRender.sharedMaterial.tilingOffset.elements},$x._setSkinnedMeshRenderSharedMaterialTilingOffset=function($X,$g,$K){var $x,$Z;if($X){var $n=$X.transform._entity;$n&&(($Z=($x=$n.owner.skinnedMeshRender.material).tilingOffset).elements=$K,$x.tilingOffset=$Z)}else($Z=($x=$g.skinnedMeshRender.material).tilingOffset).elements=$K,$x.tilingOffset=$Z},$x._getSkinnedMeshRenderSharedMaterialAlbedo=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return $g.skinnedMeshRender.sharedMaterial.albedoColor.elements},$x._setSkinnedMeshRenderSharedMaterialAlbedo=function($X,$g,$K){var $x,$Z;if($X){var $n=$X.transform._entity;$n&&(($Z=($x=$n.owner.skinnedMeshRender.material).albedoColor).elements=$K,$x.albedoColor=$Z)}else($Z=($x=$g.skinnedMeshRender.material).albedoColor).elements=$K,$x.albedoColor=$Z},$x._getParticleRenderSharedMaterialTintColor=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.particleRender.sharedMaterial.tintColor.elements:null}return $g.particleRender.sharedMaterial.tintColor.elements},$x._setParticleRenderSharedMaterialTintColor=function($X,$g,$K){var $x,$Z;if($X){var $n=$X.transform._entity;$n&&(($Z=($x=$n.owner.particleRender.material).tintColor).elements=$K,$x.tintColor=$Z)}else($Z=($x=$g.particleRender.material).tintColor).elements=$K,$x.tintColor=$Z},$x._getMeshRenderSharedMaterialAlphaColor=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.alphaColor.elements:null}return $g.meshRender.sharedMaterial.alphaColor.elements},$x._setMeshRenderSharedMaterialAlphaColor=function($X,$g,$K){var $x,$Z;if($X){var $n=$X.transform._entity;$n&&(($Z=($x=$n.owner.meshRender.material).alphaColor).elements=$K,$x.alphaColor=$Z)}else($Z=($x=$g.meshRender.material).alphaColor).elements=$K,$x.alphaColor=$Z},$x._getMeshRenderSharedMaterialBaseColor=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.baseColor.elements:null}return $g.meshRender.sharedMaterial.baseColor.elements},$x._setMeshRenderSharedMaterialBaseColor=function($X,$g,$K){var $x,$Z;if($X){var $n=$X.transform._entity;$n&&(($Z=($x=$n.owner.meshRender.material).baseColor).elements=$K,$x.baseColor=$Z)}else($Z=($x=$g.meshRender.material).baseColor).elements=$K,$x.baseColor=$Z},$x._getMeshRenderSharedMaterialDissolve=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.dissolve:0}return $g.meshRender.sharedMaterial.dissolve},$x._setMeshRenderSharedMaterialDissolve=function($X,$g,$K){if($X){var $x=$X.transform._entity;$x&&($x.owner.meshRender.material.dissolve=$K[0])}else $g.meshRender.material.dissolve=$K[0]},$x._getMeshRenderSharedMaterialDissolveSpeed=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.dissolveSpeed:0}return $g.meshRender.sharedMaterial.dissolveSpeed},$x._setMeshRenderSharedMaterialDissolveSpeed=function($X,$g,$K){if($X){var $x=$X.transform._entity;$x&&($x.owner.meshRender.material.dissolveSpeed=$K[0])}else $g.meshRender.material.dissolveSpeed=$K[0]},$x._getMeshRenderSharedMaterialMMultiplier=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.mMultiplier:0}return $g.meshRender.sharedMaterial.mMultiplier},$x._setMeshRenderSharedMaterialMMultiplier=function($X,$g,$K){if($X){var $x=$X.transform._entity;$x&&($x.owner.meshRender.material.mMultiplier=$K[0])}else $g.meshRender.material.mMultiplier=$K[0]},$x._getMeshRenderSharedMaterialBaseScrollSpeedX=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return $g.meshRender.sharedMaterial.baseScrollSpeedX},$x._setMeshRenderSharedMaterialBaseScrollSpeedX=function($X,$g,$K){if($X){var $x=$X.transform._entity;$x&&($x.owner.meshRender.material.baseScrollSpeedX=$K[0])}else $g.meshRender.material.baseScrollSpeedX=$K[0]},$x._getMeshRenderSharedMaterialBaseScrollSpeedY=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return $g.meshRender.sharedMaterial.baseScrollSpeedY},$x._setMeshRenderSharedMaterialBaseScrollSpeedY=function($X,$g,$K){if($X){var $x=$X.transform._entity;$x&&($x.owner.meshRender.material.baseScrollSpeedY=$K[0])}else $g.meshRender.material.baseScrollSpeedY=$K[0]},$x._getMeshRenderSharedMaterialSecondScrollSpeedX=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return $g.meshRender.sharedMaterial.secondScrollSpeedX},$x._setMeshRenderSharedMaterialSecondScrollSpeedX=function($X,$g,$K){if($X){var $x=$X.transform._entity;$x&&($x.owner.meshRender.material.secondScrollSpeedX=$K[0])}else $g.meshRender.material.secondScrollSpeedX=$K[0]},$x._getMeshRenderSharedMaterialSecondScrollSpeedY=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return $g.meshRender.sharedMaterial.secondScrollSpeedY},$x._setMeshRenderSharedMaterialSecondScrollSpeedY=function($X,$g,$K){if($X){var $x=$X.transform._entity;$x&&($x.owner.meshRender.material.secondScrollSpeedY=$K[0])}else $g.meshRender.material.secondScrollSpeedY=$K[0]},$x._getMeshRenderSharedMaterialAlpha=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.alpha:0}return $g.meshRender.sharedMaterial.alpha},$x._setMeshRenderSharedMaterialAlpha=function($X,$g,$K){if($X){var $x=$X.transform._entity;$x&&($x.owner.meshRender.material.alpha=$K[0])}else $g.meshRender.material.alpha=$K[0]},$x._getMeshRenderSharedMaterialIntensity=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.intensity:0}return $g.meshRender.sharedMaterial.intensity},$x._setMeshRenderSharedMaterialIntensity=function($X,$g,$K){if($X){var $x=$X.transform._entity;$x&&($x.owner.meshRender.material.intensity=$K[0])}else $g.meshRender.material.intensity=$K[0]},$x._getMeshRenderSharedMaterialDetailTilingOffset=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return $g.meshRender.sharedMaterial.detailTilingOffset.elements},$x._setMeshRenderSharedMaterialDetailTilingOffset=function($X,$g,$K){var $x,$Z;if($X){var $n=$X.transform._entity;$n&&(($Z=($x=$n.owner.meshRender.material).detailTilingOffset).elements=$K,$x.detailTilingOffset=$Z)}else($Z=($x=$g.meshRender.material).detailTilingOffset).elements=$K,$x.detailTilingOffset=$Z},$x._getMeshRenderSharedMaterialDissolveTilingOffset=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return $g.meshRender.sharedMaterial.dissolveTilingOffset.elements},$x._setMeshRenderSharedMaterialDissolveTilingOffset=function($X,$g,$K){var $x,$Z;if($X){var $n=$X.transform._entity;$n&&(($Z=($x=$n.owner.meshRender.material).dissolveTilingOffset).elements=$K,$x.dissolveTilingOffset=$Z)}else($Z=($x=$g.meshRender.material).dissolveTilingOffset).elements=$K,$x.dissolveTilingOffset=$Z},$x._getMeshRenderSharedMaterialMaskTilingOffset=function($X,$g){if($X){var $K=$X.transform._entity;return $K?$K.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return $g.meshRender.sharedMaterial.maskTilingOffset.elements},$x._setMeshRenderSharedMaterialMaskTilingOffset=function($X,$g,$K){var $x,$Z;if($X){var $n=$X.transform._entity;$n&&(($Z=($x=$n.owner.meshRender.material).maskTilingOffset).elements=$K,$x.maskTilingOffset=$Z)}else($Z=($x=$g.meshRender.material).maskTilingOffset).elements=$K,$x.maskTilingOffset=$Z},$x._propertyIDCounter=0,$x._propertyIndexDic={},$x._propertySetFuncs=[],$x._propertyGetFuncs=[],$x}(),$O=function(){function $X(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return $V($X,"laya.d3.animation.Keyframe"),$X}(),$e=function(){function $X(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return $V($X,"laya.d3.animation.KeyframeNode"),$X}(),$N=(function(){function $X(){this._tempVector30=new $Wg,this._tempVector31=new $Wg,this._tempVector32=new $Wg,this._a=new $Wg,this._b=new $Wg,this._c=new $Wg,this._d=new $Wg}$V($X,"laya.d3.core.glitter.SplineCurvePositionVelocity");var $g=$X.prototype;$g.Init=function($X,$g,$K,$x){$X.cloneTo(this._d),$g.cloneTo(this._c),$Wg.scale($X,2,this._a),$Wg.scale($K,2,this._tempVector30),$Wg.subtract(this._a,this._tempVector30,this._a),$Wg.add(this._a,$g,this._a),$Wg.add(this._a,$x,this._a),$Wg.scale($K,3,this._b),$Wg.scale($X,3,this._tempVector30),$Wg.subtract(this._b,this._tempVector30,this._b),$Wg.subtract(this._b,$x,this._b),$Wg.scale($g,2,this._tempVector30),$Wg.subtract(this._b,this._tempVector30,this._b)},$g.Slerp=function($X,$g){$Wg.scale(this._a,$X*$X*$X,this._tempVector30),$Wg.scale(this._b,$X*$X,this._tempVector31),$Wg.scale(this._c,$X,this._tempVector32),$Wg.add(this._tempVector30,this._tempVector31,$g),$Wg.add($g,this._tempVector32,$g),$Wg.add($g,this._d,$g)}}(),function(){function $p($X,$g,$K,$x){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=$X,this._h=$g,this._minHeight=$K,this._maxHeight=$x}$V($p,"laya.d3.core.HeightMap");var $X=$p.prototype;$X._inBounds=function($X,$g){return 0<=$X&&$X<this._h&&0<=$g&&$g<this._w},$X.getHeight=function($X,$g){return this._inBounds($X,$g)?this._datas[$X][$g]:NaN},$A(0,$X,"width",function(){return this._w}),$A(0,$X,"height",function(){return this._h}),$A(0,$X,"maxHeight",function(){return this._maxHeight}),$A(0,$X,"minHeight",function(){return this._minHeight}),$p.creatFromMesh=function($X,$g,$K,$x){for(var $Z=[],$n=[],$W=$X.getSubMeshCount(),$v=0;$v<$W;$v++){for(var $T=$X.getSubMesh($v),$G=$T._getVertexBuffer(),$c=$G.getData(),$_=[],$s=0;$s<$c.length;$s+=$G.vertexDeclaration.vertexStride/4){var $V=new $Wg($c[$s+0],$c[$s+1],$c[$s+2]);$_.push($V)}$Z.push($_);var $A=$T._getIndexBuffer();$n.push($A.getData())}var $a=$X.boundingBox,$m=$a.min.x,$F=$a.min.z,$U=$a.max.x,$$=$a.max.z,$w=$a.min.y,$Q=$a.max.y,$f=$U-$m,$D=$$-$F,$B=$x.elements[0]=$f/($g-1),$i=$x.elements[1]=$D/($K-1),$k=new $p($g,$K,$w,$Q),$I=$p._tempRay,$r=$I.direction.elements;$r[0]=0,$r[1]=-1,$r[2]=0;var $t=$Q+.1;$I.origin.elements[1]=$t;for(var $M=0;$M<$K;$M++){var $P=$F+$M*$i;$k._datas[$M]=[];for(var $N=0;$N<$g;$N++){var $C=$m+$N*$B,$Y=$I.origin.elements;$Y[0]=$C,$Y[2]=$P;var $l=$p._getPosition($I,$Z,$n);$k._datas[$M][$N]=$l===Number.MAX_VALUE?NaN:$t-$l}}return $k},$p.createFromImage=function($X,$g,$K){for(var $x=$X.width,$Z=$X.height,$n=new $p($x,$Z,$g,$K),$W=($K-$g)/254,$v=$X.getPixels(),$T=0,$G=0;$G<$Z;$G++)for(var $c=$n._datas[$G]=[],$_=0;$_<$x;$_++){var $s=$v[$T++],$V=$v[$T++],$A=$v[$T++],$a=$v[$T++];$c[$_]=255==$s&&255==$V&&255==$A&&255==$a?NaN:($s+$V+$A)/3*$W+$g}return $n},$p._getPosition=function($X,$g,$K){for(var $x=Number.MAX_VALUE,$Z=0;$Z<$g.length;$Z++)for(var $n=$g[$Z],$W=$K[$Z],$v=0;$v<$W.length;$v+=3){var $T=$n[$W[$v+0]],$G=$n[$W[$v+1]],$c=$n[$W[$v+2]],$_=$Ag.rayIntersectsTriangle($X,$T,$G,$c);!isNaN($_)&&$_<$x&&($x=$_)}return $x},$_($p,["_tempRay",function(){return this._tempRay=new $Zg(new $Wg,new $Wg)}])}(),function(){function $Z(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}$V($Z,"laya.d3.core.Layer");var $X=$Z.prototype;return $X._binarySearchIndex=function(){for(var $X=0,$g=$Z._collsionTestList.length-1,$K=0;$X<=$g;){$K=Math.floor(($X+$g)/2);var $x=$Z._collsionTestList[$K];if($x==this._number)return $K;$x>this._number?$g=$K-1:$X=$K+1}return $X},$X._addCollider=function($X){0===this._colliders.length&&$Z._collsionTestList.splice(this._binarySearchIndex(),0,this._number),$X._isRigidbody?(this._colliders.unshift($X),this._nonRigidbodyOffset++):this._colliders.push($X)},$X._removeCollider=function($X){var $g=this._colliders.indexOf($X);$g<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice($g,1),0===this._colliders.length&&$Z._collsionTestList.splice($Z._collsionTestList.indexOf(this._number),1)},$A(0,$X,"number",function(){return this._number}),$A(0,$X,"visible",function(){return this._visible},function($X){this._visible=$X,$Z._visibleLayers=$X?$Z._visibleLayers|this.mask:$Z._visibleLayers&~this.mask}),$A(0,$X,"mask",function(){return this._mask}),$A(1,$Z,"visibleLayers",function(){return $Z._visibleLayers},function($X){$Z._visibleLayers=$X;for(var $g=0,$K=$Z._layerList.length;$g<$K;$g++){var $x=$Z._layerList[$g];$x._visible=0!=($x._mask&$Z._visibleLayers)}}),$Z.__init__=function(){$Z._layerList.length=31;for(var $X=0;$X<31;$X++){var $g=new $Z;$Z._layerList[$X]=$g,0===$X?($g.name="Default Layer",$g.visible=!0):($g.name="Layer-"+$X,$g.visible=!1),$g._number=$X,$g._mask=Math.pow(2,$X)}$Z.currentCreationLayer=$Z._layerList[0]},$Z.getLayerByNumber=function($X){if($X<0||30<$X)throw new Error("无法返回指定Layer，该number超出范围！");return $Z._layerList[$X]},$Z.getLayerByName=function($X){for(var $g=0;$g<31;$g++)if($Z._layerList[$g].name===$X)return $Z._layerList[$g];throw new Error("无法返回指定Layer,该name不存在")},$Z.isVisible=function($X){return 0!=($X&$Z._currentCameraCullingMask&$Z._visibleLayers)},$Z._layerList=[],$Z._visibleLayers=2147483647,$Z._collsionTestList=[],$Z._currentCameraCullingMask=2147483647,$Z.maxCount=31,$Z.currentCreationLayer=null,$Z}()),$C=(function(){function $X($X,$g,$K){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=$X,this._minCount=$g,this._maxCount=$K}$V($X,"laya.d3.core.particleShuriKen.module.Burst");var $g=$X.prototype;$Q.imps($g,{"laya.d3.core.IClone":!0}),$g.cloneTo=function($X){var $g=$X;$g._time=this._time,$g._minCount=this._minCount,$g._maxCount=this._maxCount},$g.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$g,"time",function(){return this._time}),$A(0,$g,"minCount",function(){return this._minCount}),$A(0,$g,"maxCount",function(){return this._maxCount})}(),function(){function $X($X){this._color=null,this.enbale=!1,this._color=$X}$V($X,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var $g=$X.prototype;$g.cloneTo=function($X){var $g=$X;this._color.cloneTo($g._color),$g.enbale=this.enbale},$g.clone=function(){var $X;switch(this._color.type){case 0:$X=$l.createByConstant(this._color.constant.clone());break;case 1:$X=$l.createByGradient(this._color.gradient.clone());break;case 2:$X=$l.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:$X=$l.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var $g=new this.constructor($X);return $g.enbale=this.enbale,$g},$A(0,$g,"color",function(){return this._color})}(),function(){function $X(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}$V($X,"laya.d3.core.particleShuriKen.module.Emission");var $g=$X.prototype;$Q.imps($g,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),$g._destroy=function(){this._bursts=null,this._destroyed=!0},$g.getBurstsCount=function(){return this._bursts.length},$g.getBurstByIndex=function($X){return this._bursts[$X]},$g.addBurst=function($X){var $g=this._bursts.length;if(0<$g)for(var $K=0;$K<$g;$K++)this._bursts[$K].time>$X.time&&this._bursts.splice($K,0,$X);this._bursts.push($X)},$g.removeBurst=function($X){var $g=this._bursts.indexOf($X);-1!==$g&&this._bursts.splice($g,1)},$g.removeBurstByIndex=function($X){this._bursts.splice($X,1)},$g.clearBurst=function(){this._bursts.length=0},$g.cloneTo=function($X){var $g=$X,$K=$g._bursts;$K.length=this._bursts.length;for(var $x=0,$Z=this._bursts.length;$x<$Z;$x++){var $n=$K[$x];$n?this._bursts[$x].cloneTo($n):$K[$x]=this._bursts[$x].clone()}$g._emissionRate=this._emissionRate,$g.enbale=this.enbale},$g.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$g,"destroyed",function(){return this._destroyed}),$A(0,$g,"emissionRate",function(){return this._emissionRate},function($X){if($X<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=$X})}(),function(){function $x(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}$V($x,"laya.d3.core.particleShuriKen.module.FrameOverTime");var $X=$x.prototype;return $Q.imps($X,{"laya.d3.core.IClone":!0}),$X.cloneTo=function($X){var $g=$X;$g._type=this._type,$g._constant=this._constant,this._overTime.cloneTo($g._overTime),$g._constantMin=this._constantMin,$g._constantMax=this._constantMax,this._overTimeMin.cloneTo($g._overTimeMin),this._overTimeMax.cloneTo($g._overTimeMax)},$X.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$X,"frameOverTimeData",function(){return this._overTime}),$A(0,$X,"constant",function(){return this._constant}),$A(0,$X,"type",function(){return this._type}),$A(0,$X,"frameOverTimeDataMin",function(){return this._overTimeMin}),$A(0,$X,"constantMin",function(){return this._constantMin}),$A(0,$X,"frameOverTimeDataMax",function(){return this._overTimeMax}),$A(0,$X,"constantMax",function(){return this._constantMax}),$x.createByConstant=function($X){var $g=new $x;return $g._type=0,$g._constant=$X,$g},$x.createByOverTime=function($X){var $g=new $x;return $g._type=1,$g._overTime=$X,$g},$x.createByRandomTwoConstant=function($X,$g){var $K=new $x;return $K._type=2,$K._constantMin=$X,$K._constantMax=$g,$K},$x.createByRandomTwoOverTime=function($X,$g){var $K=new $x;return $K._type=3,$K._overTimeMin=$X,$K._overTimeMax=$g,$K},$x}()),$Y=function(){function $G(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}$V($G,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var $X=$G.prototype;return $Q.imps($X,{"laya.d3.core.IClone":!0}),$X.cloneTo=function($X){var $g=$X;$g._type=this._type,$g._separateAxes=this._separateAxes,$g._constant=this._constant,this._constantSeparate.cloneTo($g._constantSeparate),this._gradient.cloneTo($g._gradient),this._gradientX.cloneTo($g._gradientX),this._gradientY.cloneTo($g._gradientY),this._gradientZ.cloneTo($g._gradientZ),$g._constantMin=this._constantMin,$g._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($g._constantMinSeparate),this._constantMaxSeparate.cloneTo($g._constantMaxSeparate),this._gradientMin.cloneTo($g._gradientMin),this._gradientMax.cloneTo($g._gradientMax),this._gradientXMin.cloneTo($g._gradientXMin),this._gradientXMax.cloneTo($g._gradientXMax),this._gradientYMin.cloneTo($g._gradientYMin),this._gradientYMax.cloneTo($g._gradientYMax),this._gradientZMin.cloneTo($g._gradientZMin),this._gradientZMax.cloneTo($g._gradientZMax)},$X.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$X,"gradientZ",function(){return this._gradientZ}),$A(0,$X,"constant",function(){return this._constant}),$A(0,$X,"gradient",function(){return this._gradient}),$A(0,$X,"separateAxes",function(){return this._separateAxes}),$A(0,$X,"type",function(){return this._type}),$A(0,$X,"constantSeparate",function(){return this._constantSeparate}),$A(0,$X,"gradientX",function(){return this._gradientX}),$A(0,$X,"gradientY",function(){return this._gradientY}),$A(0,$X,"gradientW",function(){return this._gradientW}),$A(0,$X,"gradientMin",function(){return this._gradientMin}),$A(0,$X,"constantMin",function(){return this._constantMin}),$A(0,$X,"gradientMax",function(){return this._gradientMax}),$A(0,$X,"constantMax",function(){return this._constantMax}),$A(0,$X,"gradientWMin",function(){return this._gradientWMin}),$A(0,$X,"constantMinSeparate",function(){return this._constantMinSeparate}),$A(0,$X,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$A(0,$X,"gradientXMin",function(){return this._gradientXMin}),$A(0,$X,"gradientXMax",function(){return this._gradientXMax}),$A(0,$X,"gradientWMax",function(){return this._gradientWMax}),$A(0,$X,"gradientYMin",function(){return this._gradientYMin}),$A(0,$X,"gradientYMax",function(){return this._gradientYMax}),$A(0,$X,"gradientZMin",function(){return this._gradientZMin}),$A(0,$X,"gradientZMax",function(){return this._gradientZMax}),$G.createByConstant=function($X){var $g=new $G;return $g._type=0,$g._separateAxes=!1,$g._constant=$X,$g},$G.createByConstantSeparate=function($X){var $g=new $G;return $g._type=0,$g._separateAxes=!0,$g._constantSeparate=$X,$g},$G.createByGradient=function($X){var $g=new $G;return $g._type=1,$g._separateAxes=!1,$g._gradient=$X,$g},$G.createByGradientSeparate=function($X,$g,$K,$x){var $Z=new $G;return $Z._type=1,$Z._separateAxes=!0,$Z._gradientX=$X,$Z._gradientY=$g,$Z._gradientZ=$K,$Z._gradientW=$x,$Z},$G.createByRandomTwoConstant=function($X,$g){var $K=new $G;return $K._type=2,$K._separateAxes=!1,$K._constantMin=$X,$K._constantMax=$g,$K},$G.createByRandomTwoConstantSeparate=function($X,$g){var $K=new $G;return $K._type=2,$K._separateAxes=!0,$K._constantMinSeparate=$X,$K._constantMaxSeparate=$g,$K},$G.createByRandomTwoGradient=function($X,$g){var $K=new $G;return $K._type=3,$K._separateAxes=!1,$K._gradientMin=$X,$K._gradientMax=$g,$K},$G.createByRandomTwoGradientSeparate=function($X,$g,$K,$x,$Z,$n,$W,$v){var $T=new $G;return $T._type=3,$T._separateAxes=!0,$T._gradientXMin=$X,$T._gradientXMax=$g,$T._gradientYMin=$K,$T._gradientYMax=$x,$T._gradientZMin=$Z,$T._gradientZMax=$n,$T._gradientWMin=$W,$T._gradientWMax=$v,$T},$G}(),$l=function(){function $x(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}$V($x,"laya.d3.core.particleShuriKen.module.GradientColor");var $X=$x.prototype;return $Q.imps($X,{"laya.d3.core.IClone":!0}),$X.cloneTo=function($X){var $g=$X;$g._type=this._type,this._constant.cloneTo($g._constant),this._constantMin.cloneTo($g._constantMin),this._constantMax.cloneTo($g._constantMax),this._gradient.cloneTo($g._gradient),this._gradientMin.cloneTo($g._gradientMin),this._gradientMax.cloneTo($g._gradientMax)},$X.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$X,"gradient",function(){return this._gradient}),$A(0,$X,"constant",function(){return this._constant}),$A(0,$X,"type",function(){return this._type}),$A(0,$X,"gradientMin",function(){return this._gradientMin}),$A(0,$X,"constantMin",function(){return this._constantMin}),$A(0,$X,"gradientMax",function(){return this._gradientMax}),$A(0,$X,"constantMax",function(){return this._constantMax}),$x.createByConstant=function($X){var $g=new $x;return $g._type=0,$g._constant=$X,$g},$x.createByGradient=function($X){var $g=new $x;return $g._type=1,$g._gradient=$X,$g},$x.createByRandomTwoConstant=function($X,$g){var $K=new $x;return $K._type=2,$K._constantMin=$X,$K._constantMax=$g,$K},$x.createByRandomTwoGradient=function($X,$g){var $K=new $x;return $K._type=3,$K._gradientMin=$X,$K._gradientMax=$g,$K},$x}(),$p=(function(){function $X(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}$V($X,"laya.d3.core.particleShuriKen.module.GradientDataColor");var $g=$X.prototype;$Q.imps($g,{"laya.d3.core.IClone":!0}),$g.addAlpha=function($X,$g){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==$X&&($X=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=$X,this._alphaElements[this._alphaCurrentLength++]=$g):DEBUG},$g.addRGB=function($X,$g){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==$X&&($X=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=$X,this._rgbElements[this._rgbCurrentLength++]=$g.x,this._rgbElements[this._rgbCurrentLength++]=$g.y,this._rgbElements[this._rgbCurrentLength++]=$g.z):DEBUG},$g.cloneTo=function($X){var $g=$X,$K=0,$x=0;$g._alphaCurrentLength=this._alphaCurrentLength;var $Z=$g._alphaElements;for($Z.length=this._alphaElements.length,$K=0,$x=this._alphaElements.length;$K<$x;$K++)$Z[$K]=this._alphaElements[$K];$g._rgbCurrentLength=this._rgbCurrentLength;var $n=$g._rgbElements;for($n.length=this._rgbElements.length,$K=0,$x=this._rgbElements.length;$K<$x;$K++)$n[$K]=this._rgbElements[$K]},$g.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$g,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),$A(0,$g,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function $X(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$V($X,"laya.d3.core.particleShuriKen.module.GradientDataInt");var $g=$X.prototype;$Q.imps($g,{"laya.d3.core.IClone":!0}),$g.add=function($X,$g){this._currentLength<8?(6===this._currentLength&&1!==$X&&($X=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$X,this._elements[this._currentLength++]=$g):console.log("Warning:data count must lessEqual than 4")},$g.cloneTo=function($X){var $g=$X;$g._currentLength=this._currentLength;var $K=$g._elements;$K.length=this._elements.length;for(var $x=0,$Z=this._elements.length;$x<$Z;$x++)$K[$x]=this._elements[$x]},$g.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$g,"gradientCount",function(){return this._currentLength/2})}(),function(){function $X(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$V($X,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var $g=$X.prototype;$Q.imps($g,{"laya.d3.core.IClone":!0}),$g.add=function($X,$g){this._currentLength<8?(6===this._currentLength&&1!==$X&&($X=1,DEBUG),this._elements[this._currentLength++]=$X,this._elements[this._currentLength++]=$g):DEBUG},$g.getKeyByIndex=function($X){return this._elements[2*$X]},$g.getValueByIndex=function($X){return this._elements[2*$X+1]},$g.getAverageValue=function(){for(var $X=0,$g=this._currentLength-2;$X<$g;$X+=2){this._elements[$X+1];this._elements[$X+3],this._elements[$X+2]-this._elements[$X]}return 0},$g.cloneTo=function($X){var $g=$X;$g._currentLength=this._currentLength;var $K=$g._elements;$K.length=this._elements.length;for(var $x=0,$Z=this._elements.length;$x<$Z;$x++)$K[$x]=this._elements[$x]},$g.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$g,"gradientCount",function(){return this._currentLength/2})}(),function(){function $X(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}$V($X,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var $g=$X.prototype;$Q.imps($g,{"laya.d3.core.IClone":!0}),$g.add=function($X,$g){this._currentLength<8?(6===this._currentLength&&1!==$X&&($X=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$X,this._elements[this._currentLength++]=$g.x,this._elements[this._currentLength++]=$g.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},$g.cloneTo=function($X){var $g=$X;$g._currentLength=this._currentLength;var $K=$g._elements;$K.length=this._elements.length;for(var $x=0,$Z=this._elements.length;$x<$Z;$x++)$K[$x]=this._elements[$x]},$g.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$g,"gradientCount",function(){return this._currentLength/3})}(),function(){function $v(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$V($v,"laya.d3.core.particleShuriKen.module.GradientSize");var $X=$v.prototype;return $Q.imps($X,{"laya.d3.core.IClone":!0}),$X.getMaxSizeInGradient=function(){var $X=0,$g=0,$K=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for($X=0,$g=this._gradientX.gradientCount;$X<$g;$X++)$K=Math.max($K,this._gradientX.getValueByIndex($X));for($X=0,$g=this._gradientY.gradientCount;$X<$g;$X++)$K=Math.max($K,this._gradientY.getValueByIndex($X))}else for($X=0,$g=this._gradient.gradientCount;$X<$g;$X++)$K=Math.max($K,this._gradient.getValueByIndex($X));break;case 1:$K=this._separateAxes?($K=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),$K=Math.max($K,this._constantMinSeparate.y),Math.max($K,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for($X=0,$g=this._gradientXMin.gradientCount;$X<$g;$X++)$K=Math.max($K,this._gradientXMin.getValueByIndex($X));for($X=0,$g=this._gradientXMax.gradientCount;$X<$g;$X++)$K=Math.max($K,this._gradientXMax.getValueByIndex($X));for($X=0,$g=this._gradientYMin.gradientCount;$X<$g;$X++)$K=Math.max($K,this._gradientYMin.getValueByIndex($X));for($X=0,$g=this._gradientZMax.gradientCount;$X<$g;$X++)$K=Math.max($K,this._gradientZMax.getValueByIndex($X))}else{for($X=0,$g=this._gradientMin.gradientCount;$X<$g;$X++)$K=Math.max($K,this._gradientMin.getValueByIndex($X));for($X=0,$g=this._gradientMax.gradientCount;$X<$g;$X++)$K=Math.max($K,this._gradientMax.getValueByIndex($X))}}return $K},$X.cloneTo=function($X){var $g=$X;$g._type=this._type,$g._separateAxes=this._separateAxes,this._gradient.cloneTo($g._gradient),this._gradientX.cloneTo($g._gradientX),this._gradientY.cloneTo($g._gradientY),this._gradientZ.cloneTo($g._gradientZ),$g._constantMin=this._constantMin,$g._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($g._constantMinSeparate),this._constantMaxSeparate.cloneTo($g._constantMaxSeparate),this._gradientMin.cloneTo($g._gradientMin),this._gradientMax.cloneTo($g._gradientMax),this._gradientXMin.cloneTo($g._gradientXMin),this._gradientXMax.cloneTo($g._gradientXMax),this._gradientYMin.cloneTo($g._gradientYMin),this._gradientYMax.cloneTo($g._gradientYMax),this._gradientZMin.cloneTo($g._gradientZMin),this._gradientZMax.cloneTo($g._gradientZMax)},$X.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$X,"gradientZ",function(){return this._gradientZ}),$A(0,$X,"gradient",function(){return this._gradient}),$A(0,$X,"separateAxes",function(){return this._separateAxes}),$A(0,$X,"type",function(){return this._type}),$A(0,$X,"gradientMin",function(){return this._gradientMin}),$A(0,$X,"constantMin",function(){return this._constantMin}),$A(0,$X,"gradientX",function(){return this._gradientX}),$A(0,$X,"gradientY",function(){return this._gradientY}),$A(0,$X,"gradientMax",function(){return this._gradientMax}),$A(0,$X,"constantMax",function(){return this._constantMax}),$A(0,$X,"constantMinSeparate",function(){return this._constantMinSeparate}),$A(0,$X,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$A(0,$X,"gradientXMin",function(){return this._gradientXMin}),$A(0,$X,"gradientXMax",function(){return this._gradientXMax}),$A(0,$X,"gradientYMin",function(){return this._gradientYMin}),$A(0,$X,"gradientYMax",function(){return this._gradientYMax}),$A(0,$X,"gradientZMin",function(){return this._gradientZMin}),$A(0,$X,"gradientZMax",function(){return this._gradientZMax}),$v.createByGradient=function($X){var $g=new $v;return $g._type=0,$g._separateAxes=!1,$g._gradient=$X,$g},$v.createByGradientSeparate=function($X,$g,$K){var $x=new $v;return $x._type=0,$x._separateAxes=!0,$x._gradientX=$X,$x._gradientY=$g,$x._gradientZ=$K,$x},$v.createByRandomTwoConstant=function($X,$g){var $K=new $v;return $K._type=1,$K._separateAxes=!1,$K._constantMin=$X,$K._constantMax=$g,$K},$v.createByRandomTwoConstantSeparate=function($X,$g){var $K=new $v;return $K._type=1,$K._separateAxes=!0,$K._constantMinSeparate=$X,$K._constantMaxSeparate=$g,$K},$v.createByRandomTwoGradient=function($X,$g){var $K=new $v;return $K._type=2,$K._separateAxes=!1,$K._gradientMin=$X,$K._gradientMax=$g,$K},$v.createByRandomTwoGradientSeparate=function($X,$g,$K,$x,$Z,$n){var $W=new $v;return $W._type=2,$W._separateAxes=!0,$W._gradientXMin=$X,$W._gradientXMax=$g,$W._gradientYMin=$K,$W._gradientYMax=$x,$W._gradientZMin=$Z,$W._gradientZMax=$n,$W},$v}()),$L=function(){function $v(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$V($v,"laya.d3.core.particleShuriKen.module.GradientVelocity");var $X=$v.prototype;return $Q.imps($X,{"laya.d3.core.IClone":!0}),$X.cloneTo=function($X){var $g=$X;$g._type=this._type,this._constant.cloneTo($g._constant),this._gradientX.cloneTo($g._gradientX),this._gradientY.cloneTo($g._gradientY),this._gradientZ.cloneTo($g._gradientZ),this._constantMin.cloneTo($g._constantMin),this._constantMax.cloneTo($g._constantMax),this._gradientXMin.cloneTo($g._gradientXMin),this._gradientXMax.cloneTo($g._gradientXMax),this._gradientYMin.cloneTo($g._gradientYMin),this._gradientYMax.cloneTo($g._gradientYMax),this._gradientZMin.cloneTo($g._gradientZMin),this._gradientZMax.cloneTo($g._gradientZMax)},$X.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$X,"gradientZ",function(){return this._gradientZ}),$A(0,$X,"constant",function(){return this._constant}),$A(0,$X,"type",function(){return this._type}),$A(0,$X,"gradientXMax",function(){return this._gradientXMax}),$A(0,$X,"constantMin",function(){return this._constantMin}),$A(0,$X,"gradientX",function(){return this._gradientX}),$A(0,$X,"gradientY",function(){return this._gradientY}),$A(0,$X,"gradientXMin",function(){return this._gradientXMin}),$A(0,$X,"constantMax",function(){return this._constantMax}),$A(0,$X,"gradientYMin",function(){return this._gradientYMin}),$A(0,$X,"gradientYMax",function(){return this._gradientYMax}),$A(0,$X,"gradientZMin",function(){return this._gradientZMin}),$A(0,$X,"gradientZMax",function(){return this._gradientZMax}),$v.createByConstant=function($X){var $g=new $v;return $g._type=0,$g._constant=$X,$g},$v.createByGradient=function($X,$g,$K){var $x=new $v;return $x._type=1,$x._gradientX=$X,$x._gradientY=$g,$x._gradientZ=$K,$x},$v.createByRandomTwoConstant=function($X,$g){var $K=new $v;return $K._type=2,$K._constantMin=$X,$K._constantMax=$g,$K},$v.createByRandomTwoGradient=function($X,$g,$K,$x,$Z,$n){var $W=new $v;return $W._type=3,$W._gradientXMin=$X,$W._gradientXMax=$g,$W._gradientYMin=$K,$W._gradientYMax=$x,$W._gradientZMin=$Z,$W._gradientZMax=$n,$W},$v}(),$q=(function(){function $X($X){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=$X}$V($X,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var $g=$X.prototype;$Q.imps($g,{"laya.d3.core.IClone":!0}),$g.cloneTo=function($X){var $g=$X;this._angularVelocity.cloneTo($g._angularVelocity),$g.enbale=this.enbale},$g.clone=function(){var $X;switch(this._angularVelocity.type){case 0:$X=this._angularVelocity.separateAxes?$Y.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):$Y.createByConstant(this._angularVelocity.constant);break;case 1:$X=this._angularVelocity.separateAxes?$Y.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):$Y.createByGradient(this._angularVelocity.gradient.clone());break;case 2:$X=this._angularVelocity.separateAxes?$Y.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):$Y.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:$X=this._angularVelocity.separateAxes?$Y.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):$Y.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var $g=new this.constructor($X);return $g.enbale=this.enbale,$g},$A(0,$g,"angularVelocity",function(){return this._angularVelocity})}(),function(){function $X(){this.enable=!1,this.randomDirection=!1}$V($X,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.core.IClone":!0}),$g._getShapeBoundBox=function($X){throw new Error("BaseShape: must override it.")},$g._getSpeedBoundBox=function($X){throw new Error("BaseShape: must override it.")},$g.generatePositionAndDirection=function($X,$g,$K,$x){throw new Error("BaseShape: must override it.")},$g._calculateProceduralBounds=function($X,$g,$K){this._getShapeBoundBox($X);var $x=$X.min,$Z=$X.max;$Wg.multiply($x,$g,$x),$Wg.multiply($Z,$g,$Z);var $n=new $zX(new $Wg,new $Wg);this.randomDirection?($n.min=new $Wg(-1,-1,-1),$n.max=new $Wg(1,1,1)):this._getSpeedBoundBox($n);var $W=new $zX(new $Wg,new $Wg),$v=$W.min,$T=$W.max;$Wg.scale($n.min,$K.y,$v),$Wg.scale($n.max,$K.y,$T),$Wg.add($X.min,$v,$v),$Wg.add($X.max,$T,$T),$Wg.min($X.min,$v,$X.min),$Wg.max($X.max,$v,$X.max);var $G=new $zX(new $Wg,new $Wg),$c=$G.min,$_=$G.max;$Wg.scale($n.min,$K.x,$c),$Wg.scale($n.max,$K.x,$_),$Wg.min($G.min,$_,$v),$Wg.max($G.min,$_,$T),$Wg.min($X.min,$v,$X.min),$Wg.max($X.max,$v,$X.max)},$g.cloneTo=function($X){$X.enable=this.enable},$g.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$X}()),$b=function(){function $n(){}return $V($n,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),$n._randomPointUnitArcCircle=function($X,$g,$K){var $x=$g.elements,$Z=NaN;$Z=$K?$K.getFloat()*$X:Math.random()*$X,$x[0]=Math.cos($Z),$x[1]=Math.sin($Z)},$n._randomPointInsideUnitArcCircle=function($X,$g,$K){var $x=$g.elements;$n._randomPointUnitArcCircle($X,$g,$K);var $Z=NaN;$Z=$K?Math.pow($K.getFloat(),.5):Math.pow(Math.random(),.5),$x[0]=$x[0]*$Z,$x[1]=$x[1]*$Z},$n._randomPointUnitCircle=function($X,$g){var $K=$X.elements,$x=NaN;$x=$g?$g.getFloat()*Math.PI*2:Math.random()*Math.PI*2,$K[0]=Math.cos($x),$K[1]=Math.sin($x)},$n._randomPointInsideUnitCircle=function($X,$g){var $K=$X.elements;$n._randomPointUnitCircle($X);var $x=NaN;$x=$g?Math.pow($g.getFloat(),.5):Math.pow(Math.random(),.5),$K[0]=$K[0]*$x,$K[1]=$K[1]*$x},$n._randomPointUnitSphere=function($X,$g){var $K=$X.elements,$x=NaN,$Z=NaN;$Z=$g?($x=$K[2]=2*$g.getFloat()-1,$g.getFloat()*Math.PI*2):($x=$K[2]=2*Math.random()-1,Math.random()*Math.PI*2);var $n=Math.sqrt(1-$x*$x);$K[0]=$n*Math.cos($Z),$K[1]=$n*Math.sin($Z)},$n._randomPointInsideUnitSphere=function($X,$g){var $K=$X.elements;$n._randomPointUnitSphere($X);var $x=NaN;$x=$g?Math.pow($g.getFloat(),1/3):Math.pow(Math.random(),1/3),$K[0]=$K[0]*$x,$K[1]=$K[1]*$x,$K[2]=$K[2]*$x},$n._randomPointInsideHalfUnitBox=function($X,$g){var $K=$X.elements;$g?($K[0]=$g.getFloat()-.5,$K[1]=$g.getFloat()-.5,$K[2]=$g.getFloat()-.5):($K[0]=Math.random()-.5,$K[1]=Math.random()-.5,$K[2]=Math.random()-.5)},$n}(),$S=(function(){function $X($X){this._size=null,this.enbale=!1,this._size=$X}$V($X,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var $g=$X.prototype;$Q.imps($g,{"laya.d3.core.IClone":!0}),$g.cloneTo=function($X){var $g=$X;this._size.cloneTo($g._size),$g.enbale=this.enbale},$g.clone=function(){var $X;switch(this._size.type){case 0:$X=this._size.separateAxes?$p.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):$p.createByGradient(this._size.gradient.clone());break;case 1:$X=this._size.separateAxes?$p.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):$p.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:$X=this._size.separateAxes?$p.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):$p.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var $g=new this.constructor($X);return $g.enbale=this.enbale,$g},$A(0,$g,"size",function(){return this._size})}(),function(){function $x(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}$V($x,"laya.d3.core.particleShuriKen.module.StartFrame");var $X=$x.prototype;return $Q.imps($X,{"laya.d3.core.IClone":!0}),$X.cloneTo=function($X){var $g=$X;$g._type=this._type,$g._constant=this._constant,$g._constantMin=this._constantMin,$g._constantMax=this._constantMax},$X.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$X,"constant",function(){return this._constant}),$A(0,$X,"type",function(){return this._type}),$A(0,$X,"constantMin",function(){return this._constantMin}),$A(0,$X,"constantMax",function(){return this._constantMax}),$x.createByConstant=function($X){var $g=new $x;return $g._type=0,$g._constant=$X,$g},$x.createByRandomTwoConstant=function($X,$g){var $K=new $x;return $K._type=1,$K._constantMin=$X,$K._constantMax=$g,$K},$x}()),$R=(function(){function $X($X,$g){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new $ng(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=$X,this._startFrame=$g}$V($X,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var $g=$X.prototype;$Q.imps($g,{"laya.d3.core.IClone":!0}),$g.cloneTo=function($X){var $g=$X;this.tiles.cloneTo($g.tiles),$g.type=this.type,$g.randomRow=this.randomRow,this._frame.cloneTo($g._frame),this._startFrame.cloneTo($g._startFrame),$g.cycles=this.cycles,$g.enableUVChannels=this.enableUVChannels,$g.enable=this.enable},$g.clone=function(){var $X,$g;switch(this._frame.type){case 0:$X=$C.createByConstant(this._frame.constant);break;case 1:$X=$C.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:$X=$C.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:$X=$C.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:$g=$S.createByConstant(this._startFrame.constant);break;case 1:$g=$S.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var $K=new this.constructor($X,$g);return this.tiles.cloneTo($K.tiles),$K.type=this.type,$K.randomRow=this.randomRow,$K.cycles=this.cycles,$K.enableUVChannels=this.enableUVChannels,$K.enable=this.enable,$K},$A(0,$g,"frame",function(){return this._frame}),$A(0,$g,"startFrame",function(){return this._startFrame})}(),function(){function $X($X){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=$X}$V($X,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var $g=$X.prototype;$Q.imps($g,{"laya.d3.core.IClone":!0}),$g.cloneTo=function($X){var $g=$X;this._velocity.cloneTo($g._velocity),$g.enbale=this.enbale,$g.space=this.space},$g.clone=function(){var $X;switch(this._velocity.type){case 0:$X=$L.createByConstant(this._velocity.constant.clone());break;case 1:$X=$L.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:$X=$L.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:$X=$L.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var $g=new this.constructor($X);return $g.enbale=this.enbale,$g.space=this.space,$g},$A(0,$g,"velocity",function(){return this._velocity})}(),function(){function $X(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new $sg,this._vb=$qg.create($X._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=$Lg.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=$lg.nameKey.getID("LINE"),this._shaderCompile=$Bg._preCompileShader[this._sharderNameID]}$V($X,"laya.d3.core.PhasorSpriter3D");var $g=$X.prototype;return $g.line=function($X,$g,$K,$x){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($X.x,$X.y,$X.z,$g.x,$g.y,$g.z,$g.w),this.addVertex($K.x,$K.y,$K.z,$x.x,$x.y,$x.z,$x.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},$g.circle=function($X,$g,$K,$x,$Z,$n){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*$g,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/$g,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*$X,Math.cos(this._tempNumver0)*$X,0,$K,$x,$Z,$n),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},$g.plane=function($X,$g,$K,$x,$Z,$n,$W,$v,$T){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=$x/2,this._tempNumver1=$Z/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($X-this._tempNumver0,$g+this._tempNumver1,$K,$n,$W,$v,$T),this.addVertex($X+this._tempNumver0,$g+this._tempNumver1,$K,$n,$W,$v,$T),this.addVertex($X-this._tempNumver0,$g-this._tempNumver1,$K,$n,$W,$v,$T),this.addVertex($X+this._tempNumver0,$g-this._tempNumver1,$K,$n,$W,$v,$T),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},$g.box=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=$x/2,this._tempNumver1=$Z/2,this._tempNumver2=$n/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($X-this._tempNumver0,$g+this._tempNumver1,$K+this._tempNumver2,$W,$v,$T,$G),this.addVertex($X+this._tempNumver0,$g+this._tempNumver1,$K+this._tempNumver2,$W,$v,$T,$G),this.addVertex($X-this._tempNumver0,$g-this._tempNumver1,$K+this._tempNumver2,$W,$v,$T,$G),this.addVertex($X+this._tempNumver0,$g-this._tempNumver1,$K+this._tempNumver2,$W,$v,$T,$G),this.addVertex($X+this._tempNumver0,$g+this._tempNumver1,$K-this._tempNumver2,$W,$v,$T,$G),this.addVertex($X-this._tempNumver0,$g+this._tempNumver1,$K-this._tempNumver2,$W,$v,$T,$G),this.addVertex($X+this._tempNumver0,$g-this._tempNumver1,$K-this._tempNumver2,$W,$v,$T,$G),this.addVertex($X-this._tempNumver0,$g-this._tempNumver1,$K-this._tempNumver2,$W,$v,$T,$G),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},$g.cone=function($X,$g,$K,$x,$Z,$n,$W){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*$K+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*$K>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/$K,this.addVertexIndex(0,$g,0,$x,$Z,$n,$W,this._tempUint0),this.addVertexIndex(0,0,0,$x,$Z,$n,$W,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<$K;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex($X*this._tempNumver2,0,$X*this._tempNumver3,$x,$Z,$n,$W,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==$K-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex($X*this._tempNumver2,0,$X*this._tempNumver3,$x,$Z,$n,$W,this._tempUint0+(this._tempInt0+$K)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==$K-1?this.addIndexes(this._tempUint1+$K+2):this.addIndexes(this._tempUint1+this._tempInt0+$K+1),this.addIndexes(this._tempUint1+this._tempInt0+$K),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},$g.boundingBoxLine=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($X,$Z,$n,$W,$v,$T,$G),this.addVertex($x,$Z,$n,$W,$v,$T,$G),this.addVertex($X,$g,$n,$W,$v,$T,$G),this.addVertex($x,$g,$n,$W,$v,$T,$G),this.addVertex($x,$Z,$K,$W,$v,$T,$G),this.addVertex($X,$Z,$K,$W,$v,$T,$G),this.addVertex($x,$g,$K,$W,$v,$T,$G),this.addVertex($X,$g,$K,$W,$v,$T,$G),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},$g.addVertex=function($X,$g,$K,$x,$Z,$n,$W){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=$X,this._vbData[this._posInVBData+1]=$g,this._vbData[this._posInVBData+2]=$K,this._vbData[this._posInVBData+3]=$x,this._vbData[this._posInVBData+4]=$Z,this._vbData[this._posInVBData+5]=$n,this._vbData[this._posInVBData+6]=$W,this._posInVBData+=this._floatSizePerVer,this},$g.addVertexIndex=function($X,$g,$K,$x,$Z,$n,$W,$v){return this._hasBegun||this.addVertexIndexException(),this._vbData[$v]=$X,this._vbData[$v+1]=$g,this._vbData[$v+2]=$K,this._vbData[$v+3]=$x,this._vbData[$v+4]=$Z,this._vbData[$v+5]=$n,this._vbData[$v+6]=$W,($v+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=$v),this},$g.addIndexes=function($X){var $g=arguments;this._hasBegun||this.addVertexIndexException();for(var $K=0;$K<$g.length;$K++)this._ibData[this._posInIBData]=$g[$K],this._posInIBData++;return this},$g.begin=function($X,$g){return this._hasBegun&&this.beginException0(),1!==$X&&4!==$X&&this.beginException1(),this._primitiveType=$X,this._camera=$g,this._hasBegun=!0,this},$g.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},$g.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes($X._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),$B.drawCall++,$t.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},$g.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},$g.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},$g.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},$g.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},$g.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},$g.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(28,[new $WX(0,"vector3",0),new $WX(12,"vector4",1)])}]),$X}()),$j=function(){function $X(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++$X._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new $sg}$V($X,"laya.d3.core.render.RenderElement");var $g=$X.prototype;return $g.getDynamicBatchBakedVertexs=function($X){for(var $g=this._renderObj._getVertexBuffer($X),$K=$g.getData().slice(),$x=$g.vertexDeclaration,$Z=$x.getVertexElementByUsage(0).offset/4,$n=$x.getVertexElementByUsage(3).offset/4,$W=this._sprite3D.transform,$v=$W.worldMatrix,$T=$W.rotation,$G=$x.vertexStride/4,$c=0,$_=$K.length;$c<$_;$c+=$G){var $s=$c+$Z,$V=$c+$n;$mg.transformVector3ArrayToVector3ArrayCoordinate($K,$s,$v,$K,$s),$mg.transformVector3ArrayByQuat($K,$V,$T,$K,$V)}return $K},$g.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},$g._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},$A(0,$g,"id",function(){return this._id}),$A(0,$g,"renderObj",function(){return this._renderObj},function($X){this._renderObj!==$X&&(this._renderObj=$X)}),$X._uniqueIDCounter=0,$X}(),$d=function(){function $g($X){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++$g._uniqueIDCounter,this._needSort=!1,this._scene=$X,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}$V($g,"laya.d3.core.render.RenderQueue");var $X=$g.prototype;return $X._sortOpaqueFunc=function($X,$g){if($X._render&&$g._render){var $K=$X._material.renderQueue-$g._material.renderQueue;return 0==$K?$X._render._distanceForSort-$g._render._distanceForSort:$K}return 0},$X._sortAlphaFunc=function($X,$g){if($X._render&&$g._render){var $K=$X._material.renderQueue-$g._material.renderQueue;return 0==$K?$g._render._distanceForSort-$X._render._distanceForSort:$K}return 0},$X._begainRenderElement=function($X,$g,$K){return!!$g._beforeRender($X)},$X._sortAlpha=function($X){$g._cameraPosition=$X,this._finalElements.sort(this._sortAlphaFunc)},$X._sortOpaque=function($X){$g._cameraPosition=$X,this._finalElements.sort(this._sortOpaqueFunc)},$X._preRender=function($X){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},$X._render=function($X,$g){for(var $K,$x,$Z,$n,$W,$v,$T=$B.loopCount,$G=this._scene,$c=$X.camera,$_=($c.id,!1),$s=0,$V=this._finalElements.length;$s<$V;$s++){var $A,$a,$m,$F=this._finalElements[$s];if(null!=$F._onPreRenderFunction&&$F._onPreRenderFunction.call($F._sprite3D,$X),0===$F._type){if($X.owner=$m=$F._sprite3D,$X.renderElement=$F,$m._preRenderUpdateComponents($X),$A=$F.renderObj,$a=$F._material,this._begainRenderElement($X,$A,$a)){if($K=$A._getVertexBuffers(),!($Z=($x=$A._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[$x.id]){this._errorRecord[$x.id]=1;var $U="vertexBuffer:"+("("+$x._destroyed+","+$x._released+","+$x._referenceCount+","+$x._buffer+")")+", material:"+($a?$a.__className+"("+$a._destroyed+","+$a._released+")":"null")+", owner:"+($m?$m.__className+"("+$m._destroyed+","+$m._activeInHierarchy+","+$m._displayedInStage+")":"null")+", renderObj:"+($A?$A.__className+"("+$A._destroyed+","+$A._released+","+$A._referenceCount+")":"")+", parent:, url:"+($m?$m.url:"")+", disposeStack:"+$x.disposeStack;$Q.recordError("报错：unknown vertexDeclaration  "+$U)}continue}if($_=($n=$X._shader=$a._getShader($G._shaderDefineValue,$Z.shaderDefineValue,$m._shaderDefineValue)).bind()||$T!==$n._uploadLoopCount,$K){if($n._uploadVertexBuffer!==$K||$_){for(var $$=0;$$<$K.length;$$++){var $w=$K[$$];$n.uploadAttributesX($w.vertexDeclaration.shaderValues.data,$w)}$n._uploadVertexBuffer=$K}}else($n._uploadVertexBuffer!==$x||$_)&&($n.uploadAttributes($Z.shaderValues.data,null),$n._uploadVertexBuffer=$x);($n._uploadScene!==$G||$_)&&($n.uploadSceneUniforms($G._shaderValues.data),$n._uploadScene=$G),($c!==$n._uploadCamera||$n._uploadSprite3D!==$m||$_)&&($n.uploadSpriteUniforms($m._shaderValues.data),$n._uploadSprite3D=$m),($c!==$n._uploadCamera||$_)&&($n.uploadCameraUniforms($c._shaderValues.data),$n._uploadCamera=$c),($n._uploadMaterial!==$a||$_)&&($a._upload(),$n._uploadMaterial=$a),$W!==$a?($a._setRenderStateBlendDepth(),$a._setRenderStateFrontFace($g,$m.transform),$W=$a,$v=$m):$v!==$m&&($a._setRenderStateFrontFace($g,$m.transform),$v=$m),$A._render($X),$n._uploadLoopCount=$T}$m._postRenderUpdateComponents($X)}else if(2===$F._type){$F.renderObj;$X.owner=$m=$F._sprite3D,$X.renderElement=$F,$X._batchIndexStart=$F._tempBatchIndexStart,$X._batchIndexEnd=$F._tempBatchIndexEnd,$A=$F.renderObj,$a=$F._material,this._begainRenderElement($X,$A,$a)&&($Z=($x=$A._getVertexBuffer(0)).vertexDeclaration,$_=($n=$X._shader=$a._getShader($G._shaderDefineValue,$Z.shaderDefineValue,$m._shaderDefineValue)).bind()||$T!==$n._uploadLoopCount,($n._uploadVertexBuffer!==$x||$_)&&($n.uploadAttributes($Z.shaderValues.data,null),$n._uploadVertexBuffer=$x),($n._uploadScene!==$G||$_)&&($n.uploadSceneUniforms($G._shaderValues.data),$n._uploadScene=$G),($c!==$n._uploadCamera||$n._uploadSprite3D!==$m||$_)&&($n.uploadSpriteUniforms($m._shaderValues.data),$n._uploadSprite3D=$m),($c!==$n._uploadCamera||$_)&&($n.uploadCameraUniforms($c._shaderValues.data),$n._uploadCamera=$c),($n._uploadMaterial!==$a||$_)&&($a._upload(),$n._uploadMaterial=$a),$W!==$a?($a._setRenderStateBlendDepth(),$a._setRenderStateFrontFace($g,$m.transform),$W=$a,$v=$m):$v!==$m&&($a._setRenderStateFrontFace($g,$m.transform),$v=$m),$A._render($X),$n._uploadLoopCount=$T)}}},$X._renderShadow=function($X,$g){for(var $K,$x,$Z,$n,$W,$v=$B.loopCount,$T=this._scene,$G=$X.camera,$c=!1,$_=0,$s=this._finalElements.length;$_<$s;$_++){var $V,$A,$a,$m=this._finalElements[$_];0===$m._type&&($X.owner=$a=$m._sprite3D,$g||$a._projectionViewWorldUpdateCamera===$G&&$a._projectionViewWorldUpdateLoopCount===$B.loopCount||($a._render._renderUpdate($X._projectionViewMatrix),$a._projectionViewWorldUpdateLoopCount=$B.loopCount,$a._projectionViewWorldUpdateCamera=$G),$X.renderElement=$m,$a._preRenderUpdateComponents($X),$V=$m.renderObj,$A=$m._material,this._begainRenderElement($X,$V,null)&&($x=($K=$V._getVertexBuffer(0)).vertexDeclaration,$c=($Z=$X._shader=$A._getShader($T._shaderDefineValue,$x.shaderDefineValue,$a._shaderDefineValue)).bind()||$v!==$Z._uploadLoopCount,($Z._uploadVertexBuffer!==$K||$c)&&($Z.uploadAttributes($x.shaderValues.data,null),$Z._uploadVertexBuffer=$K),($G!==$Z._uploadCamera||$Z._uploadSprite3D!==$a||$c)&&($Z.uploadSpriteUniforms($a._shaderValues.data),$Z._uploadSprite3D=$a),($G!==$Z._uploadCamera||$c)&&($Z.uploadCameraUniforms($G._shaderValues.data),$Z._uploadCamera=$G),($Z._uploadMaterial!==$A||$c)&&($A._upload(),$Z._uploadMaterial=$A),$Z._uploadRenderElement,$n!==$A?($A._setRenderStateFrontFace(!1,$a.transform),$n=$A,$W=$a):$W!==$a&&($A._setRenderStateFrontFace(!1,$a.transform),$W=$a),$V._render($X),$Z._uploadLoopCount=$v),$a._postRenderUpdateComponents($X))}},$X._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},$X._addRenderElement=function($X){this._renderElements.push($X),this._needSort=!0},$X._addDynamicBatchElement=function($X){this._dynamicBatchCombineRenderElements.push($X)},$A(0,$X,"id",function(){return this._id}),$g._uniqueIDCounter=0,$g._cameraPosition=null,$g}(),$h=function(){function $X(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return $V($X,"laya.d3.core.render.RenderState"),$X.clientWidth=0,$X.clientHeight=0,$X}(),$z=function(){function $W($X,$g){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new $oX(new $Wg,0),this._corners=[new $Wg,new $Wg,new $Wg,new $Wg,new $Wg,new $Wg,new $Wg,new $Wg],this._boundingBoxCenter=new $Wg,this._children=$x(8),this._objects=[],this._tempBoundBoxCorners=[new $Wg,new $Wg,new $Wg,new $Wg,new $Wg,new $Wg,new $Wg,new $Wg],this._scene=$X,this._currentDepth=$g}$V($W,"laya.d3.core.scene.OctreeNode");var $X=$W.prototype;return $Q.imps($X,{"laya.d3.core.scene.ITreeNode":!0}),$X.init=function($X,$g){var $K=new $Wg,$x=new $Wg;$Wg.scale($g,-.5,$K),$Wg.scale($g,.5,$x),$Wg.add($K,$X,$K),$Wg.add($x,$X,$x),this.exactBox=new $zX($K,$x),this.relaxBox=new $zX($K,$x)},$X.addTreeNode=function($X){1===Collision.boxContainsBox(this._relaxBox,$X.boundingBox)?this.addNodeDown($X,0):this.addObject($X)},$X.addChild=function($X){var $g=this._children[$X];if(null==$g){$g=new $W(this._scene,this._currentDepth+1),(this._children[$X]=$g)._parent=this,$Wg.subtract(this._exactBox.max,this._exactBox.min,$W.tempSize),$Wg.multiply($W.tempSize,$W._octreeSplit[$X],$W.tempCenter),$Wg.add(this._exactBox.min,$W.tempCenter,$W.tempCenter),$Wg.scale($W.tempSize,.25,$W.tempSize);var $K=new $Wg,$x=new $Wg;$Wg.subtract($W.tempCenter,$W.tempSize,$K),$Wg.add($W.tempCenter,$W.tempSize,$x),$g.exactBox=new $zX($K,$x),$Wg.scale($W.tempSize,$W.relax,$W.tempSize);var $Z=new $Wg,$n=new $Wg;$Wg.subtract($W.tempCenter,$W.tempSize,$Z),$Wg.add($W.tempCenter,$W.tempSize,$n),$g.relaxBox=new $zX($Z,$n)}return $g},$X.addObject=function($X){($X._treeNode=this)._objects.push($X)},$X.removeObject=function($X){if($X._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var $g=this._objects.indexOf($X);return-1!==$g&&(this._objects.splice($g,1),!0)},$X.clearObject=function(){this._objects.length=0},$X.addNodeUp=function($X,$g){this._parent&&1!==Collision.boxContainsBox(this._exactBox,$X.boundingBox)?this._parent.addNodeUp($X,$g-1):this.addNodeDown($X,$g)},$X.addNodeDown=function($X,$g){if($g<this._scene.treeLevel){var $K=this.inChildIndex($X.boundingBoxCenter),$x=this.addChild($K);1===Collision.boxContainsBox($x._relaxBox,$X.boundingBox)?$x.addNodeDown($X,++$g):this.addObject($X)}else this.addObject($X)},$X.inChildIndex=function($X){return 4*($X.z<this._boundingBoxCenter.z?0:1)+2*($X.y<this._boundingBoxCenter.y?0:1)+($X.x<this._boundingBoxCenter.x?0:1)},$X.updateObject=function($X){1===Collision.boxContainsBox(this._relaxBox,$X.boundingBox)?(this.removeObject($X),$X._treeNode=null,this.addNodeDown($X,this._currentDepth)):this._parent&&(this.removeObject($X),$X._treeNode=null,this._parent.addNodeUp($X,this._currentDepth-1))},$X.cullingObjects=function($X,$g,$K,$x,$Z){var $n,$W=0,$v=0,$T=0,$G=this._scene._dynamicBatchManager;for($W=0,$n=this._objects.length;$W<$n;$W++){var $c=this._objects[$W];if($N.isVisible($c._owner.layer.mask)&&$c.enable){if($g&&($B.treeSpriteCollision+=1,0===$X.containsBoundSphere($c.boundingSphere)))continue;$c._renderUpdate($Z),$c._distanceForSort=$Wg.distance($c.boundingSphere.center,$x)+$c.sortingFudge;var $_=$c._renderElements;for($v=0,$T=$_.length;$v<$T;$v++){var $s=$_[$v],$V=$s._staticBatch;if($V&&$V._material===$s._material)$V._addBatchRenderElement($s);else{var $A=$s.renderObj;$A.triangleCount<10&&1===$A._vertexBufferCount&&$A._getIndexBuffer()&&$s._material.renderQueue<2&&$s._canDynamicBatch&&!$c._owner.isStatic?$G._addPrepareRenderElement($s):this._scene.getRenderQueue($s._material.renderQueue)._addRenderElement($s)}}}}for($W=0;$W<8;$W++){var $a=this._children[$W];if(null!=$a){var $m=$g;if($g){var $F=$X.containsBoundBox($a._relaxBox);if($B.treeNodeCollision+=1,0===$F)continue;$m=2===$F}$a.cullingObjects($X,$m,$K,$x,$Z)}}},$X.cullingShadowObjects=function($X,$g,$K,$x,$Z){var $n,$W=0,$v=0,$T=0;this._scene._dynamicBatchManager;for($W=0,$n=this._objects.length;$W<$n;$W++){var $G=this._objects[$W];if($G.castShadow&&$N.isVisible($G._owner.layer.mask)&&$G.enable){if($K&&0===$X[0].containsBoundSphere($G.boundingSphere))continue;for(var $c=1,$_=$X.length;$c<$_;$c++){var $s=$g[$c-1];if(0!==$X[$c].containsBoundSphere($G.boundingSphere)){var $V=$G._renderElements;for($v=0,$T=$V.length;$v<$T;$v++)$s._addRenderElement($V[$v])}}}}for($W=0;$W<8;$W++){var $A=this._children[$W];if(null!=$A){var $a=$K;if($K){var $m=$X[0].containsBoundBox($A._relaxBox);if(0===$m)continue;$a=2===$m}$A.cullingShadowObjects($X,$g,$a,$x,$Z)}}},$X.cullingShadowObjectsOnePSSM=function($X,$g,$K,$x,$Z,$n){var $W,$v=$g[0],$T=0,$G=0,$c=0;for($T=0,$W=this._objects.length;$T<$W;$T++){var $_=this._objects[$T];if($_.castShadow&&$N.isVisible($_._owner.layer.mask)&&$_.enable){if($x&&0===$X.containsBoundSphere($_.boundingSphere))continue;$_._renderUpdate($K);var $s=$_._renderElements;for($G=0,$c=$s.length;$G<$c;$G++)$v._addRenderElement($s[$G])}}for($T=0;$T<8;$T++){var $V=this._children[$T];if(null!=$V){var $A=$x;if($x){var $a=$X.containsBoundBox($V._relaxBox);if(0===$a)continue;$A=2===$a}$V.cullingShadowObjectsOnePSSM($X,$g,$K,$A,$Z,$n)}}},$X.renderBoudingBox=function($X){this._renderBoudingBox($X);for(var $g=0;$g<8;++$g){var $K=this._children[$g];$K&&$K.renderBoudingBox($X)}},$X.buildAllChild=function($X){if($X<this._scene.treeLevel)for(var $g=0;$g<8;$g++){this.addChild($g).buildAllChild($X+1)}},$X._renderBoudingBox=function($X){},$A(0,$X,"exactBox",function(){return this._exactBox},function($X){this._exactBox=$X,$Wg.add($X.min,$X.max,this._boundingBoxCenter),$Wg.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),$A(0,$X,"relaxBox",function(){return this._relaxBox},function($X){(this._relaxBox=$X).getCorners(this._corners),$oX.createfromPoints(this._corners,this._boundingSphere)}),$W.debugMode=!1,$W.relax=1.15,$W.CHILDNUM=8,$_($W,["tempVector0",function(){return this.tempVector0=new $Wg},"tempSize",function(){return this.tempSize=new $Wg},"tempCenter",function(){return this.tempCenter=new $Wg},"_octreeSplit",function(){return this._octreeSplit=[new $Wg(.25,.25,.25),new $Wg(.75,.25,.25),new $Wg(.25,.75,.25),new $Wg(.75,.75,.25),new $Wg(.25,.25,.75),new $Wg(.75,.25,.75),new $Wg(.25,.75,.75),new $Wg(.75,.75,.75)]}]),$W}(),$J=(function(){function $X(){}$V($X,"laya.d3.core.scene.SceneManager")}(),function(){function $X($X,$g,$K,$x){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===$X&&($X=1),void 0===$g&&($g=1),void 0===$K&&($K=1),void 0===$x&&($x=1),this._r=$X,this._g=$g,this._b=$K,this._a=$x}return $V($X,"laya.d3.core.trail.module.Color",null,"Color$1"),$X.prototype.cloneTo=function($X){$X._r=this._r,$X._g=this._g,$X._b=this._b,$X._a=this._a},$_($X,["RED",function(){return this.RED=new $X(1,0,0,1)},"GREEN",function(){return this.GREEN=new $X(0,1,0,1)},"BLUE",function(){return this.BLUE=new $X(0,0,1,1)},"CYAN",function(){return this.CYAN=new $X(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new $X(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new $X(1,0,1,1)},"GRAY",function(){return this.GRAY=new $X(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new $X(1,1,1,1)},"BLACK",function(){return this.BLACK=new $X(0,0,0,1)}]),$X}()),$o=(function(){function $X(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}$V($X,"laya.d3.core.trail.module.Gradient");var $g=$X.prototype;$g.setKeys=function($X,$g){var $K,$x;this._colorKeys=$X;for(var $Z=this.index=0;$Z<$X.length;$Z++){var $n=($K=$X[$Z]).color;this._colorKeyData[this.index++]=$n._r,this._colorKeyData[this.index++]=$n._g,this._colorKeyData[this.index++]=$n._b,this._colorKeyData[this.index++]=$K.time}this._alphaKeys=$g;for(var $W=this.index=0;$W<$g.length;$W++)$x=$g[$W],this._alphaKeyData[this.index++]=$x.alpha,this._alphaKeyData[this.index++]=$x.time},$g.cloneTo=function($X){var $g=0,$K=0,$x=this.colorKeys,$Z=[];for($g=0,$K=$x.length;$g<$K;$g++){var $n=new $H;$x[$g].cloneTo($n),$Z.push($n)}var $W=this.alphaKeys,$v=[];for($g=0,$K=$W.length;$g<$K;$g++){var $T=new $o;$W[$g].cloneTo($T),$v.push($T)}$X.setKeys($Z,$v)},$A(0,$g,"mode",function(){return this._mode},function($X){this._mode=$X}),$A(0,$g,"colorKeys",function(){return this._colorKeys},function($X){this._colorKeys=$X;for(var $g=this.index=0;$g<$X.length;$g++){var $K=$X[$g],$x=$K.color;this._colorKeyData[this.index++]=$x._r,this._colorKeyData[this.index++]=$x._g,this._colorKeyData[this.index++]=$x._b,this._colorKeyData[this.index++]=$K.time}}),$A(0,$g,"alphaKeys",function(){return this._alphaKeys},function($X){this._alphaKeys=$X;for(var $g=this.index=0;$g<$X.length;$g++){var $K=$X[$g];this._alphaKeyData[this.index++]=$K.alpha,this._alphaKeyData[this.index++]=$K.time}})}(),function(){function $X($X,$g){this._alpha=NaN,this._time=NaN,void 0===$X&&($X=0),void 0===$g&&($g=0),this._alpha=$X,this._time=$g}$V($X,"laya.d3.core.trail.module.GradientAlphaKey");var $g=$X.prototype;return $g.cloneTo=function($X){$X.alpha=this.alpha,$X.time=this.time},$A(0,$g,"alpha",function(){return this._alpha},function($X){this._alpha=$X}),$A(0,$g,"time",function(){return this._time},function($X){this._time=$X}),$X}()),$H=function(){function $X($X,$g){this._color=null,this._time=NaN,void 0===$g&&($g=0),this._color=$X||new $J,this._time=$g}$V($X,"laya.d3.core.trail.module.GradientColorKey");var $g=$X.prototype;return $g.cloneTo=function($X){this.color.cloneTo($X.color),$X.time=this.time},$A(0,$g,"color",function(){return this._color},function($X){this._color=$X}),$A(0,$g,"time",function(){return this._time},function($X){this._time=$X}),$X}(),$y=(function(){function $X(){}$V($X,"laya.d3.core.trail.module.GradientMode"),$X.Blend=0,$X.Fixed=1}(),function(){function $X(){}$V($X,"laya.d3.core.trail.module.TextureMode"),$X.Stretch=0,$X.Tile=1}(),function(){function $X(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}$V($X,"laya.d3.core.trail.module.TrailKeyFrame"),$X.prototype.cloneTo=function($X){$X.time=this.time,$X.inTangent=this.inTangent,$X.outTangent=this.outTangent,$X.value=this.value}}(),function(){function $g($X){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new $Wg,this._curPosition=new $Wg,this._delVector3=new $Wg,this._lastFixedVertexPosition=new $Wg,this._pointAtoBVector3=new $Wg,this._pointA=new $Wg,this._pointB=new $Wg,this._owner=$X,this._id=$g.renderElementCount++,0==this._id?$X._owner.transform.position.cloneTo(this._lastPosition):$X._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new $qg($y.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new $qg($y.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}$V($g,"laya.d3.core.trail.TrailRenderElement");var $X=$g.prototype;$Q.imps($X,{"laya.d3.core.render.IRenderable":!0}),$X._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},$X._addTrailByFirstPosition=function($X,$g){$Wg.subtract($g,$X,this._delVector3),$Wg.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$Wg.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$Wg.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition($X),$X.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},$X._addTrailByNextPosition=function($X){$Wg.subtract($X,this._lastFixedVertexPosition,this._delVector3),$Wg.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$Wg.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$Wg.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=$Wg.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=$HX.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition($X),$X.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition($X),this._virtualVerticesCount=2)},$X._updateVerticesByPosition=function($X){this._pointe=$X.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},$X._updateVertexBuffer2=function(){var $X,$g=0,$K=0,$x=0;for($x=0,$X=(this._verticesCount+this._virtualVerticesCount)/2;$x<$X;$x++)$K=0==this._owner.textureMode?(this._VerticesToTailLength[$x]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[$x],this._vertices2[$g++]=1-$K,this._vertices2[$g++]=1-$K;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},$X._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},$X._updateDisappear=function(){var $X,$g=0;for($g=this._curDisappearIndex,$X=(this._verticesCount+this._virtualVerticesCount)/2;$g<$X;$g++)this._owner._curtime-this._everyGroupVertexBirthTime[$g]>=this._owner.time+$HX.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},$X._beforeRender=function($X){return this._camera=$X.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),$Wg.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},$X._render=function($X){this._isDead||($t.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),$B.drawCall++,$B.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},$X._getVertexBuffer=function($X){return void 0===$X&&($X=0),0===$X?this._vertexBuffer1:1===$X?this._vertexBuffer2:null},$X._getVertexBuffers=function(){return this._vertexBuffers},$X._getIndexBuffer=function(){return null},$X.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},$X._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},$A(0,$X,"_vertexBufferCount",function(){return this._vertexBuffers.length}),$A(0,$X,"triangleCount",function(){return 0}),$g.renderElementCount=0}(),function(){function $X(){}$V($X,"laya.d3.core.trail.VertexTrail");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration1}),$A(1,$X,"vertexDeclaration1",function(){return $X._vertexDeclaration1}),$A(1,$X,"vertexDeclaration2",function(){return $X._vertexDeclaration2}),$_($X,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new $nX(32,[new $WX(0,"vector3",0),new $WX(12,"vector3",41),new $WX(24,"single",33),new $WX(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new $nX(4,[new $WX(0,"single",38)])}]),$X}()),$XX=function(){function $w($X){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=$X}$V($w,"laya.d3.graphics.DynamicBatch");var $X=$w.prototype;return $Q.imps($X,{"laya.d3.core.render.IRenderable":!0}),$X._getVertexBuffer=function($X){return void 0===$X&&($X=0),0===$X?this._vertexBuffer:null},$X._getIndexBuffer=function(){return this._indexBuffer},$X._getCombineRenderElementFromPool=function($X,$g,$K){var $x=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return $x||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=$x=new $j,$x._sprite3D=new $dg),$x._sprite3D._render._renderUpdate($K),$x},$X._getRenderElement=function($X,$g,$K){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*$w.maxVertexCount),this._indexDatas=new Uint16Array($w.maxIndexCount),this._vertexBuffer=$qg.create(this._vertexDeclaration,$w.maxVertexCount,35048),this._indexBuffer=$Lg.create("ushort",$w.maxIndexCount,35048));for(var $x=this._merageElements.length=0,$Z=0,$n=0,$W=this._combineRenderElements.length;$n<$W;$n++){var $v=this._combineRenderElements[$n],$T=$v.getDynamicBatchBakedVertexs(0),$G=$v.getBakedIndices(),$c=$v._sprite3D.transform._isFrontFaceInvert,$_=$x/(this._vertexDeclaration.vertexStride/4),$s=$Z,$V=$s+$G.length;$v._tempBatchIndexStart=$s,$v._tempBatchIndexEnd=$V,this._indexDatas.set($G,$Z);var $A=0;if($c)for($A=$s;$A<$V;$A+=3){this._indexDatas[$A]=$_+this._indexDatas[$A];var $a=this._indexDatas[$A+1],$m=this._indexDatas[$A+2];this._indexDatas[$A+1]=$_+$m,this._indexDatas[$A+2]=$_+$a}else for($A=$s;$A<$V;$A+=3)this._indexDatas[$A]=$_+this._indexDatas[$A],this._indexDatas[$A+1]=$_+this._indexDatas[$A+1],this._indexDatas[$A+2]=$_+this._indexDatas[$A+2];$Z+=$G.length,this._vertexDatas.set($T,$x),$x+=$T.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),$n=this._combineRenderElementPoolIndex=0,$W=this._materials.length;$n<$W;$n++){var $F=this._getCombineRenderElementFromPool($X,$g,$K);$F._type=2,$F._staticBatch=null;var $U=($F.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[$n]]._tempBatchIndexStart,$$=$n+1===this._materialToRenderElementsOffsets.length?$Z:this._combineRenderElements[this._materialToRenderElementsOffsets[$n+1]]._tempBatchIndexStart;$F._tempBatchIndexStart=$U,$F._tempBatchIndexEnd=$$,$F._material=this._materials[$n],this._merageElements.push($F)}},$X._addCombineRenderObjTest=function($X){var $g=$X.renderObj,$K=this._currentCombineIndexCount+$g._getIndexBuffer().indexCount,$x=this._currentCombineVertexCount+$g._getVertexBuffer().vertexCount;return!($w.maxVertexCount<$x||$w.maxIndexCount<$K)},$X._addCombineRenderObj=function($X){var $g=$X.renderObj;this._combineRenderElements.push($X),this._currentCombineIndexCount=this._currentCombineIndexCount+$g._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$g._getVertexBuffer().vertexCount},$X._addCombineMaterial=function($X){this._materials.push($X)},$X._addMaterialToRenderElementOffset=function($X){this._materialToRenderElementsOffsets.push($X)},$X._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},$X._addToRenderQueue=function($X,$g,$K,$x){this._getRenderElement($g,$K,$x);for(var $Z=0,$n=this._materials.length;$Z<$n;$Z++)$X.getRenderQueue(this._materials[$Z].renderQueue)._addDynamicBatchElement(this._merageElements[$Z])},$X._beforeRender=function($X){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$X._render=function($X){var $g=$X._batchIndexEnd-$X._batchIndexStart;$t.mainContext.drawElements(4,$g,5123,2*$X._batchIndexStart),$B.drawCall++,$B.trianglesFaces+=$g/3},$X._getVertexBuffers=function(){return null},$A(0,$X,"_vertexBufferCount",function(){return 1}),$A(0,$X,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$A(0,$X,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),$w.maxVertexCount=2e4,$w.maxIndexCount=4e4,$w.maxCombineTriangleCount=10,$w}(),$gX=function(){function $w(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}$V($w,"laya.d3.graphics.DynamicBatchManager");var $X=$w.prototype;return $X.getDynamicBatch=function($X,$g){var $K,$x=$X.id.toString()+$g;return this._dynamicBatches[$x]?$K=this._dynamicBatches[$x]:this._dynamicBatches[$x]=$K=new $XX($X),$K},$X._garbageCollection=function(){for(var $X in this._dynamicBatches)0===this._dynamicBatches[$X].combineRenderElementsCount&&delete this._dynamicBatches[$X]},$X._addPrepareRenderElement=function($X){this._prepareDynamicBatchCombineElements.push($X)},$X._finishCombineDynamicBatch=function($X){var $g,$K,$x;this._prepareDynamicBatchCombineElements.sort($w._sortPrepareDynamicBatch);for(var $Z,$n,$W,$v,$T,$G=-1,$c=!0,$_=0,$s=-1,$V=0,$A=this._prepareDynamicBatchCombineElements.length;$V<$A;$V++){var $a=($n=this._prepareDynamicBatchCombineElements[$V]).renderObj._getVertexBuffer(0).vertexDeclaration,$m=$K!==$a;$m&&($_=0,$K=$a);var $F=$_!==$G;if($F&&($G=$_),($m||$F)&&($W=this.getDynamicBatch($a,$_),$g=null),$c)if($W._addCombineRenderObjTest($n)){if($g!==($Z=$n._material))$v&&($X.getRenderQueue($T._material.renderQueue)._addRenderElement($T),$T=$v=null,$s=-1),$v=$Z,$s=$W.combineRenderElementsCount,$T=$n,$g=$Z;else if($v){var $U=$T.renderObj,$$=$n.renderObj;$U._getVertexBuffer().vertexCount+$$._getVertexBuffer().vertexCount>$XX.maxVertexCount||$U._getIndexBuffer().indexCount+$$._getIndexBuffer().indexCount>$XX.maxIndexCount?($X.getRenderQueue($T._material.renderQueue)._addRenderElement($T),$v=$Z,$s=$W.combineRenderElementsCount,$T=$n):($W._addCombineMaterial($v),$W._addMaterialToRenderElementOffset($s),$W._addCombineRenderObj($T),$T=$v=null,$s=-1,$W._addCombineRenderObj($n))}else $W._addCombineRenderObj($n);$c=!0}else $v&&($X.getRenderQueue($T._material.renderQueue)._addRenderElement($T),$T=$v=null,$s=-1),$_++,$c=!1;else $x=this._prepareDynamicBatchCombineElements[$V-1],$W._addMaterialToRenderElementOffset($W.combineRenderElementsCount),$g=$x._material,$W._addCombineMaterial($g),$W._addCombineRenderObj($x),$c=!0,$g!==($Z=$n._material)?($v=$Z,$s=$W.combineRenderElementsCount,$T=$n):$W._addCombineRenderObj($n),$g=$Z}$v&&($X.getRenderQueue($T._material.renderQueue)._addRenderElement($T),$T=$v=null,$s=-1),this._prepareDynamicBatchCombineElements.length=0},$X._clearRenderElements=function(){for(var $X in this._dynamicBatches)this._dynamicBatches[$X]._clearRenderElements()},$X._addToRenderQueue=function($X,$g,$K,$x){for(var $Z in this._dynamicBatches){var $n=this._dynamicBatches[$Z];0<$n.combineRenderElementsCount&&$n._addToRenderQueue($X,$g,$K,$x)}},$X.dispose=function(){this._dynamicBatches=null},$w._sortPrepareDynamicBatch=function($X,$g){return $X._mainSortID-$g._mainSortID},$w}(),$KX=function(){function $X(){}return $V($X,"laya.d3.graphics.FrustumCulling"),$X.renderShadowObjectCulling=function($X,$g,$K,$x,$Z){var $n=0,$W=0,$v=0,$T=0;for($n=0,$v=$K.length;$n<$v;$n++){var $G=$K[$n];$G&&$G._clearRenderElements()}var $c,$_,$s,$V=$X._cullingRenders;if(1<$Z){for($n=0,$v=$X._cullingRendersLength;$n<$v;$n++)if(($c=$V[$n]).castShadow&&$N.isVisible($c._owner.layer.mask)&&$c.enable)for(var $A=1,$a=$g.length;$A<$a;$A++)if($_=$K[$A-1],0!==$g[$A].containsBoundSphere($c.boundingSphere))for($W=0,$T=($s=$c._renderElements).length;$W<$T;$W++)$_._addRenderElement($s[$W])}else for($n=0,$v=$X._cullingRendersLength;$n<$v;$n++)if(($c=$V[$n]).castShadow&&$N.isVisible($c._owner.layer.mask)&&$c.enable&&0!==$g[0].containsBoundSphere($c.boundingSphere))for($c._renderUpdate($x),$_=$K[0],$W=0,$T=($s=$c._renderElements).length;$W<$T;$W++)$_._addRenderElement($s[$W])},$X.renderShadowObjectCullingOctree=function($X,$g,$K,$x,$Z){for(var $n=0,$W=$K.length;$n<$W;$n++){var $v=$K[$n];$v&&$v._clearRenderElements()}1<$Z?$X.treeRoot.cullingShadowObjects($g,$K,!0,0,$X):$X.treeRoot.cullingShadowObjectsOnePSSM($g[0],$K,$x,!0,0,$X)},$X.renderObjectCulling=function($X,$g,$K,$x,$Z,$n){var $W=0,$v=0,$T=0,$G=0,$c=$g._quenes,$_=$g._dynamicBatchManager,$s=$g._cullingRenders;for($W=0,$v=$c.length;$W<$v;$W++){var $V=$c[$W];$V&&$V._clearRenderElements()}var $A=$xX._staticBatchManagers;for($W=0,$v=$A.length;$W<$v;$W++)$A[$W]._clearRenderElements();$_._clearRenderElements();var $a=$K.transform.position;for($W=0,$v=$g._cullingRendersLength;$W<$v;$W++){var $m=$s[$W];if($N.isVisible($m._owner.layer.mask)&&$m.enable&&0!==$X.containsBoundSphere($m.boundingSphere)&&$m._renderUpdate($n)){$m._distanceForSort=$Wg.distance($m.boundingSphere.center,$a)+$m.sortingFudge;var $F=$m._renderElements;for($T=0,$G=$F.length;$T<$G;$T++){var $U=$F[$T],$$=$U._staticBatch;if($$&&$$._material===$U._material)$$._addBatchRenderElement($U);else{var $w=$U.renderObj;$w.triangleCount<10&&1===$w._vertexBufferCount&&$w._getIndexBuffer()&&$U._material.renderQueue<2&&$U._canDynamicBatch&&!$m._owner.isStatic?$_._addPrepareRenderElement($U):$g.getRenderQueue($U._material.renderQueue)._addRenderElement($U)}}}}for($W=0,$v=$A.length;$W<$v;$W++)$A[$W]._addToRenderQueue($g,$x,$Z,$n);$_._finishCombineDynamicBatch($g),$_._addToRenderQueue($g,$x,$Z,$n)},$X.renderObjectCullingOctree=function($X,$g,$K,$x,$Z,$n){var $W=0,$v=0,$T=$g._quenes,$G=$g._dynamicBatchManager;for($W=0,$v=$T.length;$W<$v;$W++){var $c=$T[$W];$c&&$c._clearRenderElements()}var $_=$xX._staticBatchManagers;for($W=0,$v=$_.length;$W<$v;$W++)$_[$W]._clearRenderElements();for($G._clearRenderElements(),$g._cullingRenders.length=0,$g.treeRoot.cullingObjects($X,!0,0,$K.transform.position,$n),$W=0,$v=$_.length;$W<$v;$W++)$_[$W]._addToRenderQueue($g,$x,$Z,$n);$G._finishCombineDynamicBatch($g),$G._addToRenderQueue($g,$x,$Z,$n)},$X.renderObjectCullingNoBoundFrustum=function($X,$g,$K,$x,$Z){var $n=0,$W=0,$v=0,$T=0,$G=$X._quenes,$c=$X._dynamicBatchManager,$_=$X._cullingRenders;for($n=0,$W=$G.length;$n<$W;$n++){var $s=$G[$n];$s&&$s._clearRenderElements()}var $V=$xX._staticBatchManagers;for($n=0,$W=$V.length;$n<$W;$n++)$V[$n]._clearRenderElements();$c._clearRenderElements();var $A=$g.transform.position;for($n=0,$W=$X._cullingRendersLength;$n<$W;$n++){var $a=$_[$n];if($N.isVisible($a._owner.layer.mask)&&$a.enable){$a._renderUpdate($Z),$a._distanceForSort=$Wg.distance($a.boundingSphere.center,$A)+$a.sortingFudge;var $m=$a._renderElements;for($v=0,$T=$m.length;$v<$T;$v++){var $F=$m[$v],$U=$F._staticBatch;if($U&&$U._material===$F._material)$U._addBatchRenderElement($F);else{var $$=$F.renderObj;$$.triangleCount<10&&1===$$._vertexBufferCount&&$$._getIndexBuffer()&&$F._material.renderQueue<2&&$F._canDynamicBatch&&!$a._owner.isStatic?$c._addPrepareRenderElement($F):$X.getRenderQueue($F._material.renderQueue)._addRenderElement($F)}}}}for($n=0,$W=$V.length;$n<$W;$n++)$V[$n]._addToRenderQueue($X,$K,$x,$Z);$c._finishCombineDynamicBatch($X),$c._addToRenderQueue($X,$K,$x,$Z)},$X}(),$xX=function(){function $n(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}$V($n,"laya.d3.graphics.StaticBatchManager");var $X=$n.prototype;return $X._finishInit=function(){for(var $X in this._staticBatches)this._staticBatches[$X]._finishInit();this._initBatchRenderElements.length=0},$X._initStaticBatchs=function($X){throw new Error("StaticBatchManager:must override this function.")},$X._addInitBatchSprite=function($X){for(var $g=$X._render._renderElements,$K=0,$x=$g.length;$K<$x;$K++)this._initBatchRenderElements.push($g[$K])},$X._clearRenderElements=function(){for(var $X in this._staticBatches)this._staticBatches[$X]._clearRenderElements()},$X._garbageCollection=function($X){var $g=$X._staticBatch,$K=$g._initBatchRenderElements,$x=$K.indexOf($X);$K.splice($x,1),0===$K.length&&($g.dispose(),delete this._staticBatches[$g._key])},$X._addToRenderQueue=function($X,$g,$K,$x){for(var $Z in this._staticBatches){var $n=this._staticBatches[$Z];0<$n._batchRenderElements.length&&$n._updateToRenderQueue($X,$x)}},$X.dispose=function(){this._staticBatches=null},$n._addToStaticBatchQueue=function($X){$X instanceof laya.d3.core.RenderableSprite3D&&$X._addToInitStaticBatchManager();for(var $g=0,$K=$X.numChildren;$g<$K;$g++)$n._addToStaticBatchQueue($X._childs[$g])},$n.combine=function($X,$g){var $K,$x=0,$Z=0;if($g)for($x=0,$Z=$g.length;$x<$Z;$x++){$g[$x]._addToInitStaticBatchManager()}else $X&&$n._addToStaticBatchQueue($X);for($x=0,$Z=$n._staticBatchManagers.length;$x<$Z;$x++)($K=$n._staticBatchManagers[$x])._initStaticBatchs($X),$K._finishInit()},$n._staticBatchManagers=[],$n}(),$ZX=function(){function $X($X,$g,$K){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=$X,this._manager=$g,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=$K}$V($X,"laya.d3.graphics.StaticBatch");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$g._binarySearch=function($X){for(var $g=0,$K=this._batchRenderElements.length-1,$x=0;$g<=$K;)$x=Math.floor(($g+$K)/2),this._compareBatchRenderElement(this._batchRenderElements[$x],$X)?$K=$x-1:$g=$x+1;return $g},$g._compareBatchRenderElement=function($X,$g){throw new Error("StaticBatch:must override this function.")},$g._getVertexDecLightMap=function($X){return $X===$LX.vertexDeclaration?$NX.vertexDeclaration:$X===$pX.vertexDeclaration?$PX.vertexDeclaration:$X===$iX.vertexDeclaration?$wX.vertexDeclaration:$X===$OX.vertexDeclaration?null:$X===$aX.vertexDeclaration?$mX.vertexDeclaration:$X===$EX.vertexDeclaration?$YX.vertexDeclaration:$X===$tX.vertexDeclaration?$MX.vertexDeclaration:$X===$qX.vertexDeclaration?$CX.vertexDeclaration:$X===$pX.vertexDeclaration?$PX.vertexDeclaration:$X===$kX.vertexDeclaration?$QX.vertexDeclaration:$X===$OX.vertexDeclaration?null:$X===$aX.vertexDeclaration?$mX.vertexDeclaration:$X===$uX.vertexDeclaration?$lX.vertexDeclaration:$X===$tX.vertexDeclaration?$MX.vertexDeclaration:$X},$g._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},$g._addBatchRenderElement=function($X){this._batchRenderElements.splice(this._binarySearch($X),0,$X)},$g._updateToRenderQueue=function($X,$g){this._combineRenderElementPoolIndex=0,this._getRenderElement($X.getRenderQueue(this._material.renderQueue)._renderElements,$X,$g)},$g._getRenderElement=function($X,$g,$K){throw new Error("StaticBatch:must override this function.")},$g._finishInit=function(){throw new Error("StaticBatch:must override this function.")},$g._clearRenderElements=function(){this._batchRenderElements.length=0},$g.dispose=function(){},$g._getVertexBuffer=function($X){return void 0===$X&&($X=0),null},$g._getIndexBuffer=function(){return null},$g._beforeRender=function($X){return!0},$g._render=function($X){},$g._getVertexBuffers=function(){return null},$A(0,$g,"_vertexBufferCount",function(){return 1}),$A(0,$g,"triangleCount",function(){return 0}),$X.combine=function($X){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),$xX.combine($X)},$X.maxBatchVertexCount=65535,$X}(),$nX=function(){function $W($X,$g){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++$W._uniqueIDCounter,this._id>$W.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",$W.maxVertexDeclaration);this._shaderValues=new $sg,this._vertexElementsDic={},this._vertexStride=$X,this._vertexElements=$g;for(var $K=0;$K<$g.length;$K++){var $x=$g[$K],$Z=$x.elementUsage;this._vertexElementsDic[$Z]=$x;var $n=[$W._getTypeSize($x.elementFormat)/4,5126,!1,this._vertexStride,$x.offset];switch(this._shaderValues.setValue($Z,$n),$Z){case 1:this._addShaderDefine($Bg.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine($Bg.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine($Bg.SHADERDEFINE_UV1)}}}$V($W,"laya.d3.graphics.VertexDeclaration");var $X=$W.prototype;return $X._addShaderDefine=function($X){this._shaderDefineValue|=$X},$X._removeShaderDefine=function($X){this._shaderDefineValue&=~$X},$X.getVertexElements=function(){return this._vertexElements.slice()},$X.getVertexElementByUsage=function($X){return this._vertexElementsDic[$X]},$X.unBinding=function(){},$A(0,$X,"shaderDefineValue",function(){return this._shaderDefineValue}),$A(0,$X,"id",function(){return this._id}),$A(0,$X,"vertexStride",function(){return this._vertexStride}),$A(0,$X,"shaderValues",function(){return this._shaderValues}),$W._getTypeSize=function($X){switch($X){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},$W.getVertexStride=function($X){for(var $g=0,$K=0;$K<$X.Length;$K++){var $x=$X[$K],$Z=$x.offset+$W._getTypeSize($x.elementFormat);$g<$Z&&($g=$Z)}return $g},$W._maxVertexDeclarationBit=1e3,$W._uniqueIDCounter=1,$_($W,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),$W}(),$WX=function(){function $X($X,$g,$K){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=$X,this.elementFormat=$g,this.elementUsage=$K}return $V($X,"laya.d3.graphics.VertexElement"),$X}(),$vX=(function(){function $X(){}$V($X,"laya.d3.graphics.VertexElementFormat"),$X.Single="single",$X.Vector2="vector2",$X.Vector3="vector3",$X.Vector4="vector4",$X.Color="color",$X.Byte4="byte4",$X.Short2="short2",$X.Short4="short4",$X.NormalizedShort2="normalizedshort2",$X.NormalizedShort4="normalizedshort4",$X.HalfVector2="halfvector2",$X.HalfVector4="halfvector4"}(),function(){function $X(){}$V($X,"laya.d3.graphics.VertexElementUsage"),$X.POSITION0=0,$X.COLOR0=1,$X.TEXTURECOORDINATE0=2,$X.NORMAL0=3,$X.BINORMAL0=4,$X.TANGENT0=5,$X.BLENDINDICES0=6,$X.BLENDWEIGHT0=7,$X.DEPTH0=8,$X.FOG0=9,$X.POINTSIZE0=10,$X.SAMPLE0=11,$X.TESSELLATEFACTOR0=12,$X.COLOR1=13,$X.NEXTTEXTURECOORDINATE0=14,$X.TEXTURECOORDINATE1=15,$X.NEXTTEXTURECOORDINATE1=16,$X.CORNERTEXTURECOORDINATE0=17,$X.VELOCITY0=18,$X.STARTCOLOR0=19,$X.STARTSIZE=20,$X.AGEADDSCALE0=21,$X.STARTROTATION=22,$X.ENDCOLOR0=23,$X.STARTLIFETIME=24,$X.TIME0=33,$X.SHAPEPOSITIONSTARTLIFETIME=30,$X.DIRECTIONTIME=32,$X.SIZEROTATION0=27,$X.RADIUS0=28,$X.RADIAN0=29,$X.STARTSPEED=31,$X.RANDOM0=34,$X.RANDOM1=35,$X.SIMULATIONWORLDPOSTION=36,$X.SIMULATIONWORLDROTATION=37,$X.TEXTURECOORDINATE0X=38,$X.TEXTURECOORDINATE0X1=39,$X.TEXTURECOORDINATE0Y=40,$X.OFFSETVECTOR=41}(),function(){function $X($X,$g,$K){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=$X,this._textureCoordinate0=$g,this._time=$K}$V($X,"laya.d3.graphics.VertexGlitter");var $g=$X.prototype;$Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate0}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"time",function(){return this._time}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(24,[new $WX(0,"vector3",0),new $WX(12,"vector2",2),new $WX(20,"single",33)])}])}(),function(){function $X($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=$X,this._position=$g,this._velocity=$K,this._startColor=$x,this._endColor=$Z,this._sizeRotation=$n,this._radius=$W,this._radian=$v,this._ageAddScale=$T,this._time=$G}$V($X,"laya.d3.graphics.VertexParticle");var $g=$X.prototype;$Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"endColor",function(){return this._endColor}),$A(0,$g,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$A(0,$g,"sizeRotation",function(){return this._sizeRotation}),$A(0,$g,"velocity",function(){return this._velocity}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"startColor",function(){return this._startColor}),$A(0,$g,"radius",function(){return this._radius}),$A(0,$g,"radian",function(){return this._radian}),$A(0,$g,"ageAddScale",function(){return this._ageAddScale}),$A(0,$g,"time",function(){return this._time}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(116,[new $WX(0,"vector4",17),new $WX(16,"vector3",0),new $WX(28,"vector3",18),new $WX(40,"vector4",19),new $WX(56,"vector4",23),new $WX(72,"vector3",27),new $WX(84,"vector2",28),new $WX(92,"vector4",29),new $WX(108,"single",24),new $WX(112,"single",33)])}])}(),function(){function $X($X){this._position=null,this._position=$X}$V($X,"laya.d3.graphics.VertexPosition");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(12,[new $WX(0,"vector3",0)])}]),$X}()),$TX=function(){function $X($X,$g){this._position=null,this._normal=null,this._position=$X,this._normal=$g}$V($X,"laya.d3.graphics.VertexPositionNormal");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(24,[new $WX(0,"vector3",0),new $WX(12,"vector3",3)])}]),$X}(),$GX=function(){function $X($X,$g,$K){this._position=null,this._normal=null,this._color=null,this._position=$X,this._normal=$g,this._color=$K}$V($X,"laya.d3.graphics.VertexPositionNormalColor");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(40,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1)])}]),$X}(),$cX=function(){function $X($X,$g,$K,$x,$Z){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=$X,this._normal=$g,this._color=$K,this._blendIndex=$x,this._blendWeight=$Z}$V($X,"laya.d3.graphics.VertexPositionNormalColorSkin");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(72,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector4",7),new $WX(56,"vector4",6)])}]),$X}(),$_X=function(){function $X($X,$g,$K,$x,$Z,$n){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$X,this._normal=$g,this._color=$K,this._tangent=$x,this._blendIndex=$Z,this._blendWeight=$n}$V($X,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(88,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector4",7),new $WX(56,"vector4",6),new $WX(72,"vector4",5)])}]),$X}(),$sX=function(){function $X($X,$g,$K,$x,$Z,$n){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$X,this._normal=$g,this._color=$K,this._tangent=$x,this._blendIndex=$Z,this._blendWeight=$n}$V($X,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(84,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector4",7),new $WX(56,"vector4",6),new $WX(72,"vector3",5)])}]),$X}(),$VX=function(){function $X($X,$g,$K,$x){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$X,this._normal=$g,this._color=$K,this._tangent=$x}$V($X,"laya.d3.graphics.VertexPositionNormalColorSTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(56,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector4",5)])}]),$X}(),$AX=function(){function $X($X,$g,$K,$x){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$X,this._normal=$g,this._color=$K,this._tangent=$x}$V($X,"laya.d3.graphics.VertexPositionNormalColorTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(52,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector3",5)])}]),$X}(),$aX=function(){function $X($X,$g,$K,$x){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=$X,this._normal=$g,this._color=$K,this._textureCoordinate=$x}$V($X,"laya.d3.graphics.VertexPositionNormalColorTexture");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(48,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector2",2)])}]),$X}(),$mX=function(){function $X($X,$g,$K,$x,$Z){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$X,this._normal=$g,this._color=$K,this._textureCoordinate0=$x,this._textureCoordinate1=$Z}$V($X,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(56,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector2",2),new $WX(48,"vector2",15)])}]),$X}(),$FX=function(){function $X($X,$g,$K,$x,$Z,$n,$W){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$X,this._normal=$g,this._color=$K,this._textureCoordinate0=$x,this._textureCoordinate1=$Z,this._blendIndex=$n,this._blendWeight=$W}$V($X,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(88,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector2",2),new $WX(48,"vector2",15),new $WX(56,"vector4",7),new $WX(72,"vector4",6)])}]),$X}(),$UX=function(){function $X($X,$g,$K,$x,$Z,$n,$W,$v){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$X,this._normal=$g,this._color=$K,this._textureCoordinate0=$x,this._textureCoordinate1=$Z,this._tangent=$n,this._blendIndex=$W,this._blendWeight=$v}$V($X,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(104,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector2",2),new $WX(48,"vector2",15),new $WX(56,"vector4",7),new $WX(72,"vector4",6),new $WX(88,"vector4",5)])}]),$X}(),$$X=function(){function $X(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$V($X,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$g.VertexPositionNormalColorTexture0SkinTangent=function($X,$g,$K,$x,$Z,$n,$W,$v){this._position=$X,this._normal=$g,this._color=$K,this._textureCoordinate0=$x,this._textureCoordinate1=$Z,this._tangent=$n,this._blendIndex=$W,this._blendWeight=$v},$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(100,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector2",2),new $WX(48,"vector2",15),new $WX(56,"vector4",7),new $WX(72,"vector4",6),new $WX(88,"vector3",5)])}]),$X}(),$wX=function(){function $X($X,$g,$K,$x,$Z,$n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$X,this._normal=$g,this._color=$K,this._textureCoordinate0=$x,this._textureCoordinate1=$Z,this._tangent=$n}$V($X,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(72,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector2",2),new $WX(48,"vector2",15),new $WX(56,"vector4",5)])}]),$X}(),$QX=function(){function $X(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$V($X,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$g.VertexPositionNormalColorTexture0Tangent=function($X,$g,$K,$x,$Z,$n){this._position=$X,this._normal=$g,this._color=$K,this._textureCoordinate0=$x,this._textureCoordinate1=$Z,this._tangent=$n},$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(68,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector2",2),new $WX(48,"vector2",15),new $WX(56,"vector3",5)])}]),$X}(),$fX=function(){function $X($X,$g,$K,$x,$Z,$n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$X,this._normal=$g,this._color=$K,this._textureCoordinate=$x,this._blendIndex=$Z,this._blendWeight=$n}$V($X,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(80,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector2",2),new $WX(48,"vector4",7),new $WX(64,"vector4",6)])}]),$X}(),$DX=function(){function $X($X,$g,$K,$x,$Z,$n,$W){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$X,this._normal=$g,this._color=$K,this._textureCoordinate=$x,this._tangent=$Z,this._blendIndex=$n,this._blendWeight=$W}$V($X,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(96,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector2",2),new $WX(48,"vector4",7),new $WX(64,"vector4",6),new $WX(80,"vector4",5)])}]),$X}(),$BX=function(){function $X($X,$g,$K,$x,$Z,$n,$W){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$X,this._normal=$g,this._color=$K,this._textureCoordinate=$x,this._tangent=$Z,this._blendIndex=$n,this._blendWeight=$W}$V($X,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(92,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector2",2),new $WX(48,"vector4",7),new $WX(64,"vector4",6),new $WX(80,"vector3",5)])}]),$X}(),$iX=function(){function $X($X,$g,$K,$x,$Z){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$X,this._normal=$g,this._color=$K,this._textureCoordinate=$x,this._tangent=$Z}$V($X,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(64,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector2",2),new $WX(48,"vector4",5)])}]),$X}(),$kX=function(){function $X($X,$g,$K,$x,$Z){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$X,this._normal=$g,this._color=$K,this._textureCoordinate=$x,this._tangent=$Z}$V($X,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"color",function(){return this._color}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(60,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",1),new $WX(40,"vector2",2),new $WX(48,"vector3",5)])}]),$X}(),$IX=function(){function $X($X,$g,$K){this._position=null,this._normal=null,this._tangent=null,this._position=$X,this._normal=$g,this._tangent=$K}$V($X,"laya.d3.graphics.VertexPositionNormalSTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(40,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector4",5)])}]),$X}(),$rX=function(){function $X($X,$g,$K){this._position=null,this._normal=null,this._tangent=null,this._position=$X,this._normal=$g,this._tangent=$K}$V($X,"laya.d3.graphics.VertexPositionNormalTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(36,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector3",5)])}]),$X}(),$tX=function(){function $X($X,$g,$K){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$X,this._normal=$g,this._textureCoordinate=$K}$V($X,"laya.d3.graphics.VertexPositionNormalTexture");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(32,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2)])}]),$X}(),$MX=function(){function $X($X,$g,$K,$x){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$X,this._normal=$g,this._textureCoordinate0=$K,this._textureCoordinate1=$x}$V($X,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(40,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2),new $WX(32,"vector2",15)])}]),$X}(),$PX=function(){function $X($X,$g,$K,$x,$Z,$n){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$X,this._normal=$g,this._textureCoordinate0=$K,this._textureCoordinate1=$x,this._blendIndex=$Z,this._blendWeight=$n}$V($X,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(72,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2),new $WX(32,"vector2",15),new $WX(40,"vector4",7),new $WX(56,"vector4",6)])}]),$X}(),$NX=function(){function $X($X,$g,$K,$x,$Z,$n,$W){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$X,this._normal=$g,this._textureCoordinate0=$K,this._textureCoordinate1=$x,this._tangent=$Z,this._blendIndex=$n,this._blendWeight=$W}$V($X,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(88,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2),new $WX(32,"vector2",15),new $WX(40,"vector4",7),new $WX(56,"vector4",6),new $WX(72,"vector4",5)])}]),$X}(),$CX=function(){function $X(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$V($X,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$g.VertexPositionNormalTexture0SkinTangent=function($X,$g,$K,$x,$Z,$n,$W){this._position=$X,this._normal=$g,this._textureCoordinate0=$K,this._textureCoordinate1=$x,this._tangent=$Z,this._blendIndex=$n,this._blendWeight=$W},$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(84,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2),new $WX(32,"vector2",15),new $WX(40,"vector4",7),new $WX(56,"vector4",6),new $WX(72,"vector3",5)])}]),$X}(),$YX=function(){function $X($X,$g,$K,$x,$Z){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$X,this._normal=$g,this._textureCoordinate0=$K,this._textureCoordinate1=$x,this._tangent=$Z}$V($X,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(56,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2),new $WX(32,"vector2",15),new $WX(40,"vector4",5)])}]),$X}(),$lX=function(){function $X(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$V($X,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$g.VertexPositionNormalTexture0Tangent=function($X,$g,$K,$x,$Z){this._position=$X,this._normal=$g,this._textureCoordinate0=$K,this._textureCoordinate1=$x,this._tangent=$Z},$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(52,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2),new $WX(32,"vector2",15),new $WX(40,"vector3",5)])}]),$X}(),$pX=function(){function $X($X,$g,$K,$x,$Z){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$X,this._normal=$g,this._textureCoordinate=$K,this._blendIndex=$x,this._blendWeight=$Z}$V($X,"laya.d3.graphics.VertexPositionNormalTextureSkin");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(64,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2),new $WX(32,"vector4",7),new $WX(48,"vector4",6)])}]),$X}(),$LX=function(){function $X($X,$g,$K,$x,$Z,$n){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$X,this._normal=$g,this._textureCoordinate=$K,this._tangent=$x,this._blendIndex=$Z,this._blendWeight=$n}$V($X,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(80,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2),new $WX(32,"vector4",7),new $WX(48,"vector4",6),new $WX(64,"vector4",5)])}]),$X}(),$qX=function(){function $X($X,$g,$K,$x,$Z,$n){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$X,this._normal=$g,this._textureCoordinate=$K,this._tangent=$x,this._blendIndex=$Z,this._blendWeight=$n}$V($X,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(76,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2),new $WX(32,"vector4",7),new $WX(48,"vector4",6),new $WX(64,"vector3",5)])}]),$X}(),$EX=function(){function $X($X,$g,$K,$x){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$X,this._normal=$g,this._textureCoordinate=$K,this._tangent=$x}$V($X,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(48,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2),new $WX(32,"vector4",5)])}]),$X}(),$uX=function(){function $X($X,$g,$K,$x){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$X,this._normal=$g,this._textureCoordinate=$K,this._tangent=$x}$V($X,"laya.d3.graphics.VertexPositionNormalTextureTangent");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(44,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2),new $WX(32,"vector3",5)])}]),$X}(),$OX=function(){function $X($X,$g,$K){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$X,this._normal=$g,this._textureCoordinate=$K}$V($X,"laya.d3.graphics.VertexPositionNTBTexture");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(56,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector3",5),new $WX(36,"vector3",4),new $WX(48,"vector2",2)])}]),$X}(),$eX=function(){function $X($X,$g,$K,$x,$Z,$n,$W,$v){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=$X,this._normal=$g,this._textureCoordinate0=$x,this._textureCoordinate1=$Z,this._tangent=$n,$K=$K,this._blendIndex=$W,this._blendWeight=$v}$V($X,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"tangent",function(){return this._tangent}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(0,$g,"textureCoordinate1",function(){return this._textureCoordinate1}),$A(0,$g,"blendIndex",function(){return this._blendIndex}),$A(0,$g,"blendWeight",function(){return this._blendWeight}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(96,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector3",5),new $WX(36,"vector3",4),new $WX(48,"vector2",2),new $WX(56,"vector2",15),new $WX(64,"vector4",7),new $WX(80,"vector4",6)])}]),$X}(),$bX=function(){function $X($X,$g,$K){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$X,this._normal=$g,this._textureCoordinate=$K}$V($X,"laya.d3.graphics.VertexPositionNTBTextureSkin");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"textureCoordinate",function(){return this._textureCoordinate}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(88,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector3",5),new $WX(36,"vector3",4),new $WX(48,"vector2",2),new $WX(56,"vector4",7),new $WX(72,"vector4",6)])}]),$X}(),$SX=(function(){function $X($X,$g,$K,$x){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=$X,this._normal=$g,this._textureCoord0=$K,this._textureCoord1=$x}$V($X,"laya.d3.graphics.VertexPositionTerrain");var $g=$X.prototype;$Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"normal",function(){return this._normal}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"textureCoord0",function(){return this._textureCoord0}),$A(0,$g,"textureCoord1",function(){return this._textureCoord1}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(40,[new $WX(0,"vector3",0),new $WX(12,"vector3",3),new $WX(24,"vector2",2),new $WX(32,"vector2",15)])}])}(),function(){function $X($X,$g){this._position=null,this._textureCoordinate0=null,this._position=$X,this._textureCoordinate0=$g}$V($X,"laya.d3.graphics.VertexPositionTexture0");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"position",function(){return this._position}),$A(0,$g,"textureCoordinate0",function(){return this._textureCoordinate0}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(20,[new $WX(0,"vector3",0),new $WX(12,"vector2",2)])}]),$X}()),$RX=(function(){function $X($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$_,$s,$V){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$X,this._positionStartLifeTime=$g,this._velocity=$K,this._startColor=$x,this._startSize=$Z,this._startRotation0=$n,this._startRotation1=$W,this._startRotation2=$v,this._startLifeTime=$T,this._time=$G,this._startSpeed=$c,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$V}$V($X,"laya.d3.graphics.VertexShurikenParticleBillboard");var $g=$X.prototype;$Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$A(0,$g,"random1",function(){return this._randoms1}),$A(0,$g,"startRotation2",function(){return this._startRotation2}),$A(0,$g,"positionStartLifeTime",function(){return this._positionStartLifeTime}),$A(0,$g,"velocity",function(){return this._velocity}),$A(0,$g,"random0",function(){return this._randoms0}),$A(0,$g,"startSize",function(){return this._startSize}),$A(0,$g,"startColor",function(){return this._startColor}),$A(0,$g,"startRotation0",function(){return this._startRotation0}),$A(0,$g,"startRotation1",function(){return this._startRotation1}),$A(0,$g,"startLifeTime",function(){return this._startLifeTime}),$A(0,$g,"time",function(){return this._time}),$A(0,$g,"startSpeed",function(){return this._startSpeed}),$A(0,$g,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(152,[new $WX(0,"vector4",17),new $WX(16,"vector4",30),new $WX(32,"vector4",32),new $WX(48,"vector4",19),new $WX(64,"vector3",20),new $WX(76,"vector3",22),new $WX(88,"single",31),new $WX(92,"vector4",34),new $WX(108,"vector4",35),new $WX(124,"vector3",36),new $WX(136,"vector4",37)])}])}(),function(){function $X($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$_,$s,$V){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$X,this._positionStartLifeTime=$g,this._velocity=$K,this._startColor=$x,this._startSize=$Z,this._startRotation0=$n,this._startRotation1=$W,this._startRotation2=$v,this._startLifeTime=$T,this._time=$G,this._startSpeed=$c,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$V}$V($X,"laya.d3.graphics.VertexShurikenParticleMesh");var $g=$X.prototype;$Q.imps($g,{"laya.d3.graphics.IVertex":!0}),$A(0,$g,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$A(0,$g,"velocity",function(){return this._velocity}),$A(0,$g,"position",function(){return this._positionStartLifeTime}),$A(0,$g,"random0",function(){return this._randoms0}),$A(0,$g,"startSize",function(){return this._startSize}),$A(0,$g,"startColor",function(){return this._startColor}),$A(0,$g,"startRotation0",function(){return this._startRotation0}),$A(0,$g,"startRotation1",function(){return this._startRotation1}),$A(0,$g,"random1",function(){return this._randoms1}),$A(0,$g,"startRotation2",function(){return this._startRotation2}),$A(0,$g,"startLifeTime",function(){return this._startLifeTime}),$A(0,$g,"time",function(){return this._time}),$A(0,$g,"startSpeed",function(){return this._startSpeed}),$A(0,$g,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$A(0,$g,"vertexDeclaration",function(){return $X._vertexDeclaration}),$A(1,$X,"vertexDeclaration",function(){return $X._vertexDeclaration}),$_($X,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nX(172,[new $WX(0,"vector3",0),new $WX(12,"vector4",1),new $WX(28,"vector2",2),new $WX(36,"vector4",30),new $WX(52,"vector4",32),new $WX(68,"vector4",19),new $WX(84,"vector3",20),new $WX(96,"vector3",22),new $WX(108,"single",31),new $WX(112,"vector4",34),new $WX(128,"vector4",35),new $WX(144,"vector3",36),new $WX(156,"vector4",37)])}])}(),function(){function $$($X,$g,$K,$x,$Z,$n){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=$K,this._materials=$x,this._subMeshes=$Z,this._materialMap=$n,this._version=$g,this._onLoaded($X)}$V($$,"laya.d3.loaders.LoadModelV01");var $X=$$.prototype;return $X._onLoaded=function($X){this._readData=$X,this.READ_BLOCK();for(var $g=0;$g<this._BLOCK.count;$g++){var $K=this._readData.getUint16(),$x=this._strings[$K],$Z=this["READ_"+$x];if(null==$Z)throw new Error("model file err,no this function:"+$K+" "+$x);if(!$Z.call(this))break}return this._mesh},$X.onError=function(){},$X._readString=function(){return this._strings[this._readData.getUint16()]},$X.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},$X.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},$X.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var $X=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var $g=0;$g<this._STRINGS.size;$g++)this._strings[$g]=this._readData.readUTFString();return this._readData.pos=$X,!0},$X.READ_MATERIAL=function(){var $X=this._readData.getUint16(),$g=(this._readString(),this._readString());return this._materials[$X]="null"!==$g?$F.getRes(this._materialMap[$g]):new $rg,!0},$X.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var $X,$g=this._readData.__getBuffer(),$K=0,$x=this._readData.getUint32(),$Z=this._readData.getUint32(),$n=(new Float32Array($g.slice($x+this._DATA.offset,$x+this._DATA.offset+$Z)),this._readData.getUint32()),$W=this._readData.getUint32(),$v=new Float32Array($g.slice($n+this._DATA.offset,$n+this._DATA.offset+$W));for(this.mesh._inverseBindPoses=[],$K=0,$X=$v.length;$K<$X;$K+=16){var $T=new $Xg($v[$K+0],$v[$K+1],$v[$K+2],$v[$K+3],$v[$K+4],$v[$K+5],$v[$K+6],$v[$K+7],$v[$K+8],$v[$K+9],$v[$K+10],$v[$K+11],$v[$K+12],$v[$K+13],$v[$K+14],$v[$K+15]);this.mesh._inverseBindPoses.push($T)}break;default:throw new Error("LoadModel:unknown version.")}return!0},$X.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var $X=this._readString();this._shaderAttributes=$X.match($$._attrReg);var $g=this._readData.getUint32(),$K=this._readData.getUint32(),$x=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),$Z=this._readData.getUint32(),$n=this._readData.getUint32(),$W=this._readData.getUint32(),$v=this._readData.__getBuffer(),$T=new $Gg(this._mesh),$G=this._getVertexDeclaration(),$c=$qg.create($G,$Z/$G.vertexStride,35044,!0),$_=$x+this._DATA.offset,$s=$v.slice($_,$_+$Z);$c.setData(new Float32Array($s));for(var $V=($T._vertexBuffer=$c).vertexDeclaration.getVertexElements(),$A=0;$A<$V.length;$A++)$T._bufferUsage[$V[$A].elementUsage]=$c;var $a=$Lg.create("ushort",$K/2,35044,!0),$m=$g+this._DATA.offset,$F=$v.slice($m,$m+$K);$a.setData(new Uint16Array($F)),$T._indexBuffer=$a;var $U=$v.slice($n+this._DATA.offset,$n+this._DATA.offset+$W);return $T._boneIndicesList[0]=new Uint8Array($U),this._subMeshes.push($T),!0},$X.READ_DATAAREA=function(){return!1},$X._getVertexDeclaration=function(){for(var $X,$g=!1,$K=!1,$x=!1,$Z=!1,$n=!1,$W=!1,$v=!1,$T=!1,$G=!1,$c=0;$c<this._shaderAttributes.length;$c+=8)switch(this._shaderAttributes[$c]){case"POSITION":$g=!0;break;case"NORMAL":$K=!0;break;case"COLOR":$x=!0;break;case"UV":$Z=!0;break;case"UV1":$n=!0;break;case"BLENDWEIGHT":$v=!0;break;case"BLENDINDICES":$T=!0;break;case"TANGENT":$W=!0;break;case"BINORMAL":$G=!0}return $g&&$K&&$x&&$Z&&$n&&$v&&$T&&$W?$X=$$X.vertexDeclaration:$g&&$K&&$x&&$Z&&$n&&$v&&$T?$X=$FX.vertexDeclaration:$g&&$K&&$Z&&$n&&$v&&$T&&$W?$X=$CX.vertexDeclaration:$g&&$K&&$Z&&$n&&$v&&$T?$X=$PX.vertexDeclaration:$g&&$K&&$x&&$Z&&$v&&$T&&$W?$X=$BX.vertexDeclaration:$g&&$K&&$x&&$Z&&$v&&$T?$X=$fX.vertexDeclaration:$g&&$K&&$W&&$G&&$Z&&$v&&$T?$X=$bX.vertexDeclaration:$g&&$K&&$Z&&$v&&$T&&$W?$X=$qX.vertexDeclaration:$g&&$K&&$Z&&$v&&$T?$X=$pX.vertexDeclaration:$g&&$K&&$x&&$v&&$T&&$W?$X=$sX.vertexDeclaration:$g&&$K&&$x&&$v&&$T?$X=$cX.vertexDeclaration:$g&&$K&&$x&&$Z&&$n&&$W?$X=$QX.vertexDeclaration:$g&&$K&&$x&&$Z&&$n?$X=$mX.vertexDeclaration:$g&&$K&&$Z&&$n&&$W?$X=$lX.vertexDeclaration:$g&&$K&&$Z&&$n?$X=$MX.vertexDeclaration:$g&&$K&&$x&&$Z&&$W?$X=$kX.vertexDeclaration:$g&&$K&&$Z&&$W&&$G?$X=$OX.vertexDeclaration:$g&&$K&&$x&&$Z?$X=$aX.vertexDeclaration:$g&&$K&&$Z&&$W?$X=$uX.vertexDeclaration:$g&&$K&&$Z?$X=$tX.vertexDeclaration:$g&&$K&&$x&&$W?$X=$AX.vertexDeclaration:$g&&$K&&$x&&($X=$GX.vertexDeclaration),$X},$A(0,$X,"mesh",function(){return this._mesh}),$$._attrReg=new RegExp("(\\w+)|([:,;])","g"),$$}()),$jX=function(){function $D(){}return $V($D,"laya.d3.loaders.LoadModelV02"),$D.parse=function($X,$g,$K,$x,$Z,$n){$D._mesh=$K,$D._materials=$x,$D._subMeshes=$Z,$D._materialMap=$n,$D._version=$g,$D._readData=$X,$D.READ_DATA(),$D.READ_BLOCK(),$D.READ_STRINGS();for(var $W=0,$v=$D._BLOCK.count;$W<$v;$W++){$D._readData.pos=$D._BLOCK.blockStarts[$W];var $T=$D._readData.getUint16(),$G=$D._strings[$T],$c=$D["READ_"+$G];if(null==$c)throw new Error("model file err,no this function:"+$T+" "+$G);$c.call()}$D._strings.length=0,$D._readData=null,$D._version=null,$D._mesh=null,$D._materials=null,$D._subMeshes=null,$D._materialMap=null},$D._readString=function(){return $D._strings[$D._readData.getUint16()]},$D.READ_DATA=function(){$D._DATA.offset=$D._readData.getUint32(),$D._DATA.size=$D._readData.getUint32()},$D.READ_BLOCK=function(){for(var $X=$D._BLOCK.count=$D._readData.getUint16(),$g=$D._BLOCK.blockStarts=[],$K=$D._BLOCK.blockLengths=[],$x=0;$x<$X;$x++)$g.push($D._readData.getUint32()),$K.push($D._readData.getUint32())},$D.READ_STRINGS=function(){var $X=$D._readData.getUint32(),$g=$D._readData.getUint16(),$K=$D._readData.pos;$D._readData.pos=$X+$D._DATA.offset;for(var $x=0;$x<$g;$x++)$D._strings[$x]=$D._readData.readUTFString();$D._readData.pos=$K},$D.READ_MATERIAL=function(){$D._readString(),$D._readString();var $X=$D._readString();return""!==$X&&$D._materials.push($F.getRes($D._materialMap[$X])),!0},$D.READ_MESH=function(){$D._readString();var $X,$g=$D._readData.__getBuffer(),$K=0,$x=$D._readData.getInt16(),$Z=$D._DATA.offset;for($K=0;$K<$x;$K++){var $n=$Z+$D._readData.getUint32(),$W=$D._readData.getUint32(),$v=new Float32Array($g.slice($n,$n+$W)),$T=$D._readString().match($D._attrReg),$G=$D._getVertexDeclaration($T),$c=$qg.create($G,4*$v.length/$G.vertexStride,35044,!0);$c.setData($v),$D._mesh._vertexBuffers.push($c)}var $_=$Z+$D._readData.getUint32(),$s=$D._readData.getUint32(),$V=new Uint16Array($g.slice($_,$_+$s)),$A=$Lg.create("ushort",$s/2,35044,!0);$A.setData($V),$D._mesh._indexBuffer=$A;var $a=$D._mesh._boneNames=[],$m=$D._readData.getUint16();for($a.length=$m,$K=0;$K<$m;$K++)$a[$K]=$D._strings[$D._readData.getUint16()];var $F=$D._readData.getUint32(),$U=$D._readData.getUint32(),$$=(new Float32Array($g.slice($Z+$F,$Z+$F+$U)),$D._readData.getUint32()),$w=$D._readData.getUint32(),$Q=new Float32Array($g.slice($Z+$$,$Z+$$+$w));for($D._mesh._inverseBindPoses=[],$K=0,$X=$Q.length;$K<$X;$K+=16){var $f=new $Xg($Q[$K+0],$Q[$K+1],$Q[$K+2],$Q[$K+3],$Q[$K+4],$Q[$K+5],$Q[$K+6],$Q[$K+7],$Q[$K+8],$Q[$K+9],$Q[$K+10],$Q[$K+11],$Q[$K+12],$Q[$K+13],$Q[$K+14],$Q[$K+15]);$D._mesh._inverseBindPoses.push($f)}return $D._mesh._skinnedDatas=new Float32Array(16*$Q.length),!0},$D.READ_SUBMESH=function(){var $X=$D._readData.__getBuffer(),$g=new $Gg($D._mesh),$K=$D._readData.getInt16(),$x=$D._readData.getUint32(),$Z=$D._readData.getUint32();$g._vertexBuffer=$D._mesh._vertexBuffers[$K],$g._vertexStart=$x,$g._vertexCount=$Z;var $n=$D._readData.getUint32(),$W=$D._readData.getUint32(),$v=$D._mesh._indexBuffer;$g._indexBuffer=$v,$g._indexStart=$n,$g._indexCount=$W,$g._indices=new Uint16Array($v.getData().buffer,2*$n,$W);var $T=$D._DATA.offset,$G=$g._subIndexBufferStart,$c=$g._subIndexBufferCount,$_=$g._boneIndicesList,$s=$D._readData.getUint16();$G.length=$s,$c.length=$s,$_.length=$s;for(var $V=0;$V<$s;$V++){$G[$V]=$D._readData.getUint32(),$c[$V]=$D._readData.getUint32();var $A=$D._readData.getUint32(),$a=$D._readData.getUint32();$g._boneIndicesList[$V]=new Uint8Array($X.slice($T+$A,$T+$A+$a))}return $D._subMeshes.push($g),!0},$D._getVertexDeclaration=function($X){for(var $g,$K=!1,$x=!1,$Z=!1,$n=!1,$W=!1,$v=!1,$T=!1,$G=!1,$c=!1,$_=0;$_<$X.length;$_++)switch($X[$_]){case"POSITION":$K=!0;break;case"NORMAL":$x=!0;break;case"COLOR":$Z=!0;break;case"UV":$n=!0;break;case"UV1":$W=!0;break;case"BLENDWEIGHT":$T=!0;break;case"BLENDINDICES":$G=!0;break;case"TANGENT":$v=!0;break;case"BINORMAL":$c=!0}return $K&&$x&&$Z&&$n&&$W&&$T&&$G&&$v?$g=$$X.vertexDeclaration:$K&&$x&&$Z&&$n&&$W&&$T&&$G?$g=$FX.vertexDeclaration:$K&&$x&&$n&&$W&&$T&&$G&&$v?$g=$CX.vertexDeclaration:$K&&$x&&$n&&$W&&$T&&$G?$g=$PX.vertexDeclaration:$K&&$x&&$Z&&$n&&$T&&$G&&$v?$g=$BX.vertexDeclaration:$K&&$x&&$Z&&$n&&$T&&$G?$g=$fX.vertexDeclaration:$K&&$x&&$n&&$T&&$G&&$v?$g=$qX.vertexDeclaration:$K&&$x&&$n&&$T&&$G?$g=$pX.vertexDeclaration:$K&&$x&&$Z&&$T&&$G&&$v?$g=$sX.vertexDeclaration:$K&&$x&&$Z&&$T&&$G?$g=$cX.vertexDeclaration:$K&&$x&&$Z&&$n&&$W&&$v?$g=$QX.vertexDeclaration:$K&&$x&&$Z&&$n&&$W?$g=$mX.vertexDeclaration:$K&&$x&&$n&&$W&&$v?$g=$lX.vertexDeclaration:$K&&$x&&$n&&$W?$g=$MX.vertexDeclaration:$K&&$x&&$Z&&$n&&$v?$g=$kX.vertexDeclaration:$K&&$x&&$n&&$v&&$c?$g=$OX.vertexDeclaration:$K&&$x&&$Z&&$n?$g=$aX.vertexDeclaration:$K&&$x&&$n&&$v?$g=$uX.vertexDeclaration:$K&&$x&&$n?$g=$tX.vertexDeclaration:$K&&$x&&$Z&&$v?$g=$AX.vertexDeclaration:$K&&$x&&$Z&&($g=$GX.vertexDeclaration),$g},$D._attrReg=new RegExp("(\\w+)|([:,;])","g"),$D._strings=[],$D._readData=null,$D._version=null,$D._mesh=null,$D._materials=null,$D._subMeshes=null,$D._materialMap=null,$_($D,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$D}(),$dX=function(){function $f(){}return $V($f,"laya.d3.loaders.LoadModelV03"),$f.parse=function($X,$g,$K,$x,$Z){$f._mesh=$K,$f._subMeshes=$x,$f._materialMap=$Z,$f._version=$g,$f._readData=$X,$f.READ_DATA(),$f.READ_BLOCK(),$f.READ_STRINGS();for(var $n=0,$W=$f._BLOCK.count;$n<$W;$n++){$f._readData.pos=$f._BLOCK.blockStarts[$n];var $v=$f._readData.getUint16(),$T=$f._strings[$v],$G=$f["READ_"+$T];if(null==$G)throw new Error("model file err,no this function:"+$v+" "+$T);$G.call()}$f._strings.length=0,$f._readData=null,$f._version=null,$f._mesh=null,$f._subMeshes=null,$f._materialMap=null},$f._readString=function(){return $f._strings[$f._readData.getUint16()]},$f.READ_DATA=function(){$f._DATA.offset=$f._readData.getUint32(),$f._DATA.size=$f._readData.getUint32()},$f.READ_BLOCK=function(){for(var $X=$f._BLOCK.count=$f._readData.getUint16(),$g=$f._BLOCK.blockStarts=[],$K=$f._BLOCK.blockLengths=[],$x=0;$x<$X;$x++)$g.push($f._readData.getUint32()),$K.push($f._readData.getUint32())},$f.READ_STRINGS=function(){var $X=$f._readData.getUint32(),$g=$f._readData.getUint16(),$K=$f._readData.pos;$f._readData.pos=$X+$f._DATA.offset;for(var $x=0;$x<$g;$x++)$f._strings[$x]=$f._readData.readUTFString();$f._readData.pos=$K},$f.READ_MESH=function(){var $X,$g=$f._readString(),$K=$f._readData.__getBuffer(),$x=0,$Z=$f._readData.getInt16(),$n=$f._DATA.offset;for($x=0;$x<$Z;$x++){var $W,$v=$n+$f._readData.getUint32(),$T=$f._readData.getUint32(),$G=new Float32Array($K.slice($v,$v+$T)),$c=$f._readString();switch($f._version){case"LAYAMODEL:03":$W=$f._vertexDeclarationMap_Discard[$c];break;case"LAYAMODEL:0301":$W=$f._vertexDeclarationMap[$c];break;default:throw new Error("LoadModelV03: unknown version.")}if(!$W)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+$f._version+"  bufferAttribute="+$c+"  name="+$g+"  url="+($f._mesh?$f._mesh.url:"null"));var $_=$qg.create($W,4*$G.length/$W.vertexStride,35044,!0,$f._mesh._url+"_"+$x);$_.setData($G),$f._mesh._vertexBuffers.push($_)}var $s=$n+$f._readData.getUint32(),$V=$f._readData.getUint32(),$A=new Uint16Array($K.slice($s,$s+$V)),$a=$Lg.create("ushort",$V/2,35044,!0,$f._mesh._url);$a.setData($A),$f._mesh._indexBuffer=$a;var $m=$f._mesh._boneNames=[],$F=$f._readData.getUint16();for($m.length=$F,$x=0;$x<$F;$x++)$m[$x]=$f._strings[$f._readData.getUint16()];$f._readData.pos+=8;var $U=$f._readData.getUint32(),$$=$f._readData.getUint32(),$w=new Float32Array($K.slice($n+$U,$n+$U+$$));for($f._mesh._inverseBindPoses=[],$x=0,$X=$w.length;$x<$X;$x+=16){var $Q=new $Xg($w[$x+0],$w[$x+1],$w[$x+2],$w[$x+3],$w[$x+4],$w[$x+5],$w[$x+6],$w[$x+7],$w[$x+8],$w[$x+9],$w[$x+10],$w[$x+11],$w[$x+12],$w[$x+13],$w[$x+14],$w[$x+15]);$f._mesh._inverseBindPoses.push($Q)}return $f._mesh._skinnedDatas=new Float32Array(16*$w.length),!0},$f.READ_SUBMESH=function(){var $X=$f._readData.__getBuffer(),$g=new $Gg($f._mesh),$K=$f._readData.getInt16(),$x=$f._readData.getUint32(),$Z=$f._readData.getUint32();$g._vertexBuffer=$f._mesh._vertexBuffers[$K],$g._vertexStart=$x,$g._vertexCount=$Z;var $n=$f._readData.getUint32(),$W=$f._readData.getUint32(),$v=$f._mesh._indexBuffer;$g._indexBuffer=$v,$g._indexStart=$n,$g._indexCount=$W,$g._indices=new Uint16Array($v.getData().buffer,2*$n,$W);var $T=$f._DATA.offset,$G=$g._subIndexBufferStart,$c=$g._subIndexBufferCount,$_=$g._boneIndicesList,$s=$f._readData.getUint16();$G.length=$s,$c.length=$s,$_.length=$s;for(var $V=0;$V<$s;$V++){$G[$V]=$f._readData.getUint32(),$c[$V]=$f._readData.getUint32();var $A=$f._readData.getUint32(),$a=$f._readData.getUint32();$_[$V]=new Uint8Array($X.slice($T+$A,$T+$A+$a))}return $f._subMeshes.push($g),!0},$f._strings=[],$f._readData=null,$f._version=null,$f._mesh=null,$f._subMeshes=null,$f._materialMap=null,$_($f,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$$X.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$FX.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$eX.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$CX.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$PX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$BX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$fX.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$qX.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$pX.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$sX.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$cX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$QX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$mX.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$lX.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$MX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$kX.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$OX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$aX.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$uX.vertexDeclaration,"POSITION,NORMAL,UV":$tX.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$AX.vertexDeclaration,"POSITION,NORMAL,COLOR":$GX.vertexDeclaration,"POSITION,NORMAL,TANGENT":$rX.vertexDeclaration,"POSITION,NORMAL":$TX.vertexDeclaration,"POSITION,UV":$SX.vertexDeclaration,POSITION:$vX.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$UX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$FX.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$eX.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$NX.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$PX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$DX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$fX.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$LX.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$pX.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$_X.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$cX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$wX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$mX.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$YX.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$MX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$iX.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$OX.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$aX.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$EX.vertexDeclaration,"POSITION,NORMAL,UV":$tX.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$VX.vertexDeclaration,"POSITION,NORMAL,COLOR":$GX.vertexDeclaration,"POSITION,NORMAL,TANGENT":$IX.vertexDeclaration,"POSITION,NORMAL":$TX.vertexDeclaration,"POSITION,UV":$SX.vertexDeclaration,POSITION:$vX.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$f}(),$hX=function(){function $v(){}return $V($v,"laya.d3.loaders.MeshReader"),$v.read=function($X,$g,$K,$x,$Z){var $n=new $f($X);$n.pos=0;var $W=$n.readUTFString();switch($W){case"LAYAMODEL:01":case"LAYASKINANI:01":$v._readVersion01($n,$W,$g,$K,$x,$Z);break;case"LAYAMODEL:02":$jX.parse($n,$W,$g,$K,$x,$Z);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":$dX.parse($n,$W,$g,$x,$Z);break;default:throw new Error("MeshReader: unknown mesh version.")}$g._setSubMeshes($x)},$v._readVersion01=function($X,$g,$K,$x,$Z,$n){new $RX($X,$g,$K,$x,$Z,$n)},$v}(),$zX=function(){function $X($X,$g){this.min=null,this.max=null,this.min=$X,this.max=$g}$V($X,"laya.d3.math.BoundBox");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.core.IClone":!0}),$g.getCorners=function($X){$X.length=8;var $g=this.min.elements,$K=this.max.elements,$x=$g[0],$Z=$g[1],$n=$g[2],$W=$K[0],$v=$K[1],$T=$K[2];$X[0]=new $Wg($x,$v,$T),$X[1]=new $Wg($W,$v,$T),$X[2]=new $Wg($W,$Z,$T),$X[3]=new $Wg($x,$Z,$T),$X[4]=new $Wg($x,$v,$n),$X[5]=new $Wg($W,$v,$n),$X[6]=new $Wg($W,$Z,$n),$X[7]=new $Wg($x,$Z,$n)},$g.toDefault=function(){this.min.toDefault(),this.max.toDefault()},$g.cloneTo=function($X){var $g=$X;this.min.cloneTo($g.min),this.max.cloneTo($g.max)},$g.clone=function(){var $X=new this.constructor(new $Wg,new $Wg);return this.cloneTo($X),$X},$X.createfromPoints=function($X,$g){if(null==$X)throw new Error("points");var $K=$g.min,$x=$g.max,$Z=$K.elements;$Z[0]=Number.MAX_VALUE,$Z[1]=Number.MAX_VALUE,$Z[2]=Number.MAX_VALUE;var $n=$x.elements;$n[0]=-Number.MAX_VALUE,$n[1]=-Number.MAX_VALUE,$n[2]=-Number.MAX_VALUE;for(var $W=0,$v=$X.length;$W<$v;++$W)$Wg.min($K,$X[$W],$K),$Wg.max($x,$X[$W],$x)},$X.merge=function($X,$g,$K){$Wg.min($X.min,$g.min,$K.min),$Wg.max($X.max,$g.max,$K.max)},$X}(),$JX=function(){function $G($X){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=$X,this._near=new $gg(new $Wg),this._far=new $gg(new $Wg),this._left=new $gg(new $Wg),this._right=new $gg(new $Wg),this._top=new $gg(new $Wg),this._bottom=new $gg(new $Wg),$G._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}$V($G,"laya.d3.math.BoundFrustum");var $X=$G.prototype;return $X.equalsBoundFrustum=function($X){return this._matrix.equalsOtherMatrix($X.matrix)},$X.equalsObj=function($X){if($X instanceof laya.d3.math.BoundFrustum){var $g=$X;return this.equalsBoundFrustum($g)}return!1},$X.getPlane=function($X){switch($X){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},$X.getCorners=function($X){$G._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo($X[0]),$G._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo($X[1]),$G._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo($X[2]),$G._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo($X[3]),$G._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo($X[4]),$G._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo($X[5]),$G._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo($X[6]),$G._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo($X[7])},$X.containsPoint=function($X){for(var $g=$gg.PlaneIntersectionType_Front,$K=$gg.PlaneIntersectionType_Front,$x=0;$x<6;$x++){switch($x){case 0:$K=Collision.intersectsPlaneAndPoint(this._near,$X);break;case 1:$K=Collision.intersectsPlaneAndPoint(this._far,$X);break;case 2:$K=Collision.intersectsPlaneAndPoint(this._left,$X);break;case 3:$K=Collision.intersectsPlaneAndPoint(this._right,$X);break;case 4:$K=Collision.intersectsPlaneAndPoint(this._top,$X);break;case 5:$K=Collision.intersectsPlaneAndPoint(this._bottom,$X)}switch($K){case $gg.PlaneIntersectionType_Back:return 0;case $gg.PlaneIntersectionType_Intersecting:$g=$gg.PlaneIntersectionType_Intersecting}}switch($g){case $gg.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$X.containsBoundBox=function($X){for(var $g,$K=$G._tempV30,$x=$G._tempV31,$Z=1,$n=0;$n<6;$n++){if($g=this.getPlane($n),this._getBoxToPlanePVertexNVertex($X,$g.normal,$K,$x),Collision.intersectsPlaneAndPoint($g,$K)===$gg.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint($g,$x)===$gg.PlaneIntersectionType_Back&&($Z=2)}return $Z},$X.containsBoundSphere=function($X){for(var $g=$gg.PlaneIntersectionType_Front,$K=$gg.PlaneIntersectionType_Front,$x=0;$x<6;$x++){switch($x){case 0:$K=Collision.intersectsPlaneAndSphere(this._near,$X);break;case 1:$K=Collision.intersectsPlaneAndSphere(this._far,$X);break;case 2:$K=Collision.intersectsPlaneAndSphere(this._left,$X);break;case 3:$K=Collision.intersectsPlaneAndSphere(this._right,$X);break;case 4:$K=Collision.intersectsPlaneAndSphere(this._top,$X);break;case 5:$K=Collision.intersectsPlaneAndSphere(this._bottom,$X)}switch($K){case $gg.PlaneIntersectionType_Back:return 0;case $gg.PlaneIntersectionType_Intersecting:$g=$gg.PlaneIntersectionType_Intersecting}}switch($g){case $gg.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$X._getBoxToPlanePVertexNVertex=function($X,$g,$K,$x){var $Z=$X.min,$n=$Z.elements,$W=$X.max,$v=$W.elements,$T=$g.elements,$G=$T[0],$c=$T[1],$_=$T[2];$Z.cloneTo($K);var $s=$K.elements;0<=$G&&($s[0]=$v[0]),0<=$c&&($s[1]=$v[1]),0<=$_&&($s[2]=$v[2]),$W.cloneTo($x);var $V=$x.elements;0<=$G&&($V[0]=$n[0]),0<=$c&&($V[1]=$n[1]),0<=$_&&($V[2]=$n[2])},$A(0,$X,"top",function(){return this._top}),$A(0,$X,"matrix",function(){return this._matrix},function($X){this._matrix=$X,$G._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),$A(0,$X,"near",function(){return this._near}),$A(0,$X,"far",function(){return this._far}),$A(0,$X,"left",function(){return this._left}),$A(0,$X,"right",function(){return this._right}),$A(0,$X,"bottom",function(){return this._bottom}),$G._getPlanesFromMatrix=function($X,$g,$K,$x,$Z,$n,$W){var $v=$X.elements,$T=$v[0],$G=$v[1],$c=$v[2],$_=$v[3],$s=$v[4],$V=$v[5],$A=$v[6],$a=$v[7],$m=$v[8],$F=$v[9],$U=$v[10],$$=$v[11],$w=$v[12],$Q=$v[13],$f=$v[14],$D=$v[15],$B=$g.normal.elements;$B[0]=$_+$c,$B[1]=$a+$A,$B[2]=$$+$U,$g.distance=$D+$f,$g.normalize();var $i=$K.normal.elements;$i[0]=$_-$c,$i[1]=$a-$A,$i[2]=$$-$U,$K.distance=$D-$f,$K.normalize();var $k=$x.normal.elements;$k[0]=$_+$T,$k[1]=$a+$s,$k[2]=$$+$m,$x.distance=$D+$w,$x.normalize();var $I=$Z.normal.elements;$I[0]=$_-$T,$I[1]=$a-$s,$I[2]=$$-$m,$Z.distance=$D-$w,$Z.normalize();var $r=$n.normal.elements;$r[0]=$_-$G,$r[1]=$a-$V,$r[2]=$$-$F,$n.distance=$D-$Q,$n.normalize();var $t=$W.normal.elements;$t[0]=$_+$G,$t[1]=$a+$V,$t[2]=$$+$F,$W.distance=$D+$Q,$W.normalize()},$G._get3PlaneInterPoint=function($X,$g,$K){var $x=$X.normal,$Z=$g.normal,$n=$K.normal;$Wg.cross($Z,$n,$G._tempV30),$Wg.cross($n,$x,$G._tempV31),$Wg.cross($x,$Z,$G._tempV32);var $W=$Wg.dot($x,$G._tempV30),$v=$Wg.dot($Z,$G._tempV31),$T=$Wg.dot($n,$G._tempV32);return $Wg.scale($G._tempV30,-$X.distance/$W,$G._tempV33),$Wg.scale($G._tempV31,-$g.distance/$v,$G._tempV34),$Wg.scale($G._tempV32,-$K.distance/$T,$G._tempV35),$Wg.add($G._tempV33,$G._tempV34,$G._tempV36),$Wg.add($G._tempV35,$G._tempV36,$G._tempV37),$G._tempV37},$_($G,["_tempV30",function(){return this._tempV30=new $Wg},"_tempV31",function(){return this._tempV31=new $Wg},"_tempV32",function(){return this._tempV32=new $Wg},"_tempV33",function(){return this._tempV33=new $Wg},"_tempV34",function(){return this._tempV34=new $Wg},"_tempV35",function(){return this._tempV35=new $Wg},"_tempV36",function(){return this._tempV36=new $Wg},"_tempV37",function(){return this._tempV37=new $Wg}]),$G}(),$oX=function(){function $c($X,$g){this.center=null,this.radius=NaN,this.center=$X,this.radius=$g}$V($c,"laya.d3.math.BoundSphere");var $X=$c.prototype;return $Q.imps($X,{"laya.d3.core.IClone":!0}),$X.toDefault=function(){this.center.toDefault(),this.radius=0},$X.intersectsRayDistance=function($X){return Collision.intersectsRayAndSphereRD($X,this)},$X.intersectsRayPoint=function($X,$g){return Collision.intersectsRayAndSphereRP($X,this,$g)},$X.cloneTo=function($X){var $g=$X;this.center.cloneTo($g.center),$g.radius=this.radius},$X.clone=function(){var $X=new this.constructor(new $Wg,new $Wg);return this.cloneTo($X),$X},$c.createFromSubPoints=function($X,$g,$K,$x){if(null==$X)throw new Error("points");if($g<0||$g>=$X.length)throw new Error("start"+$g+"Must be in the range [0, "+($X.length-1)+"]");if($K<0||$g+$K>$X.length)throw new Error("count"+$K+"Must be in the range <= "+$X.length+"}");var $Z=$g+$K,$n=$c._tempVector3;$n.elements[0]=0,$n.elements[1]=0,$n.elements[2]=0;for(var $W=$g;$W<$Z;++$W)$Wg.add($X[$W],$n,$n);var $v=$x.center;$Wg.scale($n,1/$K,$v);var $T=0;for($W=$g;$W<$Z;++$W){var $G=$Wg.distanceSquared($v,$X[$W]);$T<$G&&($T=$G)}$x.radius=Math.sqrt($T)},$c.createfromPoints=function($X,$g){if(null==$X)throw new Error("points");$c.createFromSubPoints($X,0,$X.length,$g)},$_($c,["_tempVector3",function(){return this._tempVector3=new $Wg}]),$c}(),$HX=(function(){function $X(){}$V($X,"laya.d3.math.ContainmentType"),$X.Disjoint=0,$X.Contains=1,$X.Intersects=2}(),function(){function $K(){}return $V($K,"laya.d3.math.MathUtils3D"),$K.isZero=function($X){return Math.abs($X)<$K.zeroTolerance},$K.nearEqual=function($X,$g){return!!$K.isZero($X-$g)},$K.fastInvSqrt=function($X){return $K.isZero($X)?$X:1/Math.sqrt($X)},$_($K,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),$K}()),$yX=function(){function $T(){var $X=this.elements=new Float32Array(9);$X[0]=1,$X[1]=0,$X[2]=0,$X[3]=0,$X[4]=1,$X[5]=0,$X[6]=0,$X[7]=0,$X[8]=1}$V($T,"laya.d3.math.Matrix3x3");var $X=$T.prototype;return $Q.imps($X,{"laya.d3.core.IClone":!0}),$X.determinant=function(){var $X=this.elements,$g=$X[0],$K=$X[1],$x=$X[2],$Z=$X[3],$n=$X[4],$W=$X[5],$v=$X[6],$T=$X[7],$G=$X[8];return $g*($G*$n-$W*$T)+$K*(-$G*$Z+$W*$v)+$x*($T*$Z-$n*$v)},$X.translate=function($X,$g){var $K=$g.elements,$x=this.elements,$Z=$X.elements,$n=$x[0],$W=$x[1],$v=$x[2],$T=$x[3],$G=$x[4],$c=$x[5],$_=$x[6],$s=$x[7],$V=$x[8],$A=$Z[0],$a=$Z[1];$K[0]=$n,$K[1]=$W,$K[2]=$v,$K[3]=$T,$K[4]=$G,$K[5]=$c,$K[6]=$A*$n+$a*$T+$_,$K[7]=$A*$W+$a*$G+$s,$K[8]=$A*$v+$a*$c+$V},$X.rotate=function($X,$g){var $K=$g.elements,$x=this.elements,$Z=$x[0],$n=$x[1],$W=$x[2],$v=$x[3],$T=$x[4],$G=$x[5],$c=$x[6],$_=$x[7],$s=$x[8],$V=Math.sin($X),$A=Math.cos($X);$K[0]=$A*$Z+$V*$v,$K[1]=$A*$n+$V*$T,$K[2]=$A*$W+$V*$G,$K[3]=$A*$v-$V*$Z,$K[4]=$A*$T-$V*$n,$K[5]=$A*$G-$V*$W,$K[6]=$c,$K[7]=$_,$K[8]=$s},$X.scale=function($X,$g){var $K=$g.elements,$x=this.elements,$Z=$X.elements,$n=$Z[0],$W=$Z[1];$K[0]=$n*$x[0],$K[1]=$n*$x[1],$K[2]=$n*$x[2],$K[3]=$W*$x[3],$K[4]=$W*$x[4],$K[5]=$W*$x[5],$K[6]=$x[6],$K[7]=$x[7],$K[8]=$x[8]},$X.invert=function($X){var $g=$X.elements,$K=this.elements,$x=$K[0],$Z=$K[1],$n=$K[2],$W=$K[3],$v=$K[4],$T=$K[5],$G=$K[6],$c=$K[7],$_=$K[8],$s=$_*$v-$T*$c,$V=-$_*$W+$T*$G,$A=$c*$W-$v*$G,$a=$x*$s+$Z*$V+$n*$A;$a||($X=null),$a=1/$a,$g[0]=$s*$a,$g[1]=(-$_*$Z+$n*$c)*$a,$g[2]=($T*$Z-$n*$v)*$a,$g[3]=$V*$a,$g[4]=($_*$x-$n*$G)*$a,$g[5]=(-$T*$x+$n*$W)*$a,$g[6]=$A*$a,$g[7]=(-$c*$x+$Z*$G)*$a,$g[8]=($v*$x-$Z*$W)*$a},$X.transpose=function($X){var $g=$X.elements,$K=this.elements;if($X===this){var $x=$K[1],$Z=$K[2],$n=$K[5];$g[1]=$K[3],$g[2]=$K[6],$g[3]=$x,$g[5]=$K[7],$g[6]=$Z,$g[7]=$n}else $g[0]=$K[0],$g[1]=$K[3],$g[2]=$K[6],$g[3]=$K[1],$g[4]=$K[4],$g[5]=$K[7],$g[6]=$K[2],$g[7]=$K[5],$g[8]=$K[8]},$X.identity=function(){var $X=this.elements;$X[0]=1,$X[1]=0,$X[2]=0,$X[3]=0,$X[4]=1,$X[5]=0,$X[6]=0,$X[7]=0,$X[8]=1},$X.cloneTo=function($X){var $g,$K,$x;if(($K=this.elements)!==($x=$X.elements))for($g=0;$g<9;++$g)$x[$g]=$K[$g]},$X.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$T.createFromTranslation=function($X,$g){$g.elements;var $K=$X.elements;$g[0]=1,$g[1]=0,$g[2]=0,$g[3]=0,$g[4]=1,$g[5]=0,$g[6]=$K[0],$g[7]=$K[1],$g[8]=1},$T.createFromRotation=function($X,$g){var $K=$g.elements,$x=Math.sin($X),$Z=Math.cos($X);$K[0]=$Z,$K[1]=$x,$K[2]=0,$K[3]=-$x,$K[4]=$Z,$K[5]=0,$K[6]=0,$K[7]=0,$K[8]=1},$T.createFromScaling=function($X,$g){var $K=$g.elements,$x=$X.elements;$K[0]=$x[0],$K[1]=0,$K[2]=0,$K[3]=0,$K[4]=$x[1],$K[5]=0,$K[6]=0,$K[7]=0,$K[8]=1},$T.createFromMatrix4x4=function($X,$g){$g[0]=$X[0],$g[1]=$X[1],$g[2]=$X[2],$g[3]=$X[4],$g[4]=$X[5],$g[5]=$X[6],$g[6]=$X[8],$g[7]=$X[9],$g[8]=$X[10]},$T.multiply=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements,$W=$Z[0],$v=$Z[1],$T=$Z[2],$G=$Z[3],$c=$Z[4],$_=$Z[5],$s=$Z[6],$V=$Z[7],$A=$Z[8],$a=$n[0],$m=$n[1],$F=$n[2],$U=$n[3],$$=$n[4],$w=$n[5],$Q=$n[6],$f=$n[7],$D=$n[8];$x[0]=$a*$W+$m*$G+$F*$s,$x[1]=$a*$v+$m*$c+$F*$V,$x[2]=$a*$T+$m*$_+$F*$A,$x[3]=$U*$W+$$*$G+$w*$s,$x[4]=$U*$v+$$*$c+$w*$V,$x[5]=$U*$T+$$*$_+$w*$A,$x[6]=$Q*$W+$f*$G+$D*$s,$x[7]=$Q*$v+$f*$c+$D*$V,$x[8]=$Q*$T+$f*$_+$D*$A},$T.lookAt=function($X,$g,$K,$x){$Wg.subtract($X,$g,$T._tempV30),$Wg.normalize($T._tempV30,$T._tempV30),$Wg.cross($K,$T._tempV30,$T._tempV31),$Wg.normalize($T._tempV31,$T._tempV31),$Wg.cross($T._tempV30,$T._tempV31,$T._tempV32);var $Z=$T._tempV30.elements,$n=$T._tempV31.elements,$W=$T._tempV32.elements,$v=$x.elements;$v[0]=$n[0],$v[3]=$n[1],$v[6]=$n[2],$v[1]=$W[0],$v[4]=$W[1],$v[7]=$W[2],$v[2]=$Z[0],$v[5]=$Z[1],$v[8]=$Z[2]},$T.DEFAULT=new $T,$_($T,["_tempV30",function(){return this._tempV30=new $Wg},"_tempV31",function(){return this._tempV31=new $Wg},"_tempV32",function(){return this._tempV32=new $Wg}]),$T}(),$Xg=function(){function $i($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$_,$s,$V,$A,$a){void 0===$X&&($X=1),void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=0),void 0===$Z&&($Z=0),void 0===$n&&($n=1),void 0===$W&&($W=0),void 0===$v&&($v=0),void 0===$T&&($T=0),void 0===$G&&($G=0),void 0===$c&&($c=1),void 0===$_&&($_=0),void 0===$s&&($s=0),void 0===$V&&($V=0),void 0===$A&&($A=0),void 0===$a&&($a=1);var $m=this.elements=new Float32Array(16);$m[0]=$X,$m[1]=$g,$m[2]=$K,$m[3]=$x,$m[4]=$Z,$m[5]=$n,$m[6]=$W,$m[7]=$v,$m[8]=$T,$m[9]=$G,$m[10]=$c,$m[11]=$_,$m[12]=$s,$m[13]=$V,$m[14]=$A,$m[15]=$a}$V($i,"laya.d3.math.Matrix4x4");var $X=$i.prototype;return $Q.imps($X,{"laya.d3.core.IClone":!0}),$X.getElementByRowColumn=function($X,$g){if($X<0||3<$X)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($g<0||3<$g)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*$X+$g]},$X.setElementByRowColumn=function($X,$g,$K){if($X<0||3<$X)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($g<0||3<$g)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*$X+$g]=$K},$X.equalsOtherMatrix=function($X){var $g=this.elements,$K=$X.elements;return $HX.nearEqual($g[0],$K[0])&&$HX.nearEqual($g[1],$K[1])&&$HX.nearEqual($g[2],$K[2])&&$HX.nearEqual($g[3],$K[3])&&$HX.nearEqual($g[4],$K[4])&&$HX.nearEqual($g[5],$K[5])&&$HX.nearEqual($g[6],$K[6])&&$HX.nearEqual($g[7],$K[7])&&$HX.nearEqual($g[8],$K[8])&&$HX.nearEqual($g[9],$K[9])&&$HX.nearEqual($g[10],$K[10])&&$HX.nearEqual($g[11],$K[11])&&$HX.nearEqual($g[12],$K[12])&&$HX.nearEqual($g[13],$K[13])&&$HX.nearEqual($g[14],$K[14])&&$HX.nearEqual($g[15],$K[15])},$X.decomposeTransRotScale=function($X,$g,$K){var $x=$i._tempMatrix4x4;return this.decomposeTransRotMatScale($X,$x,$K)?($Kg.createFromMatrix4x4($x,$g),!0):($g.identity(),!1)},$X.decomposeTransRotMatScale=function($X,$g,$K){var $x=this.elements,$Z=$X.elements,$n=$g.elements,$W=$K.elements;$Z[0]=$x[12],$Z[1]=$x[13],$Z[2]=$x[14];var $v=$x[0],$T=$x[1],$G=$x[2],$c=$x[4],$_=$x[5],$s=$x[6],$V=$x[8],$A=$x[9],$a=$x[10],$m=$W[0]=Math.sqrt($v*$v+$T*$T+$G*$G),$F=$W[1]=Math.sqrt($c*$c+$_*$_+$s*$s),$U=$W[2]=Math.sqrt($V*$V+$A*$A+$a*$a);if($HX.isZero($m)||$HX.isZero($F)||$HX.isZero($U))return $n[1]=$n[2]=$n[3]=$n[4]=$n[6]=$n[7]=$n[8]=$n[9]=$n[11]=$n[12]=$n[13]=$n[14]=0,$n[0]=$n[5]=$n[10]=$n[15]=1,!1;var $$=$i._tempVector0,$w=$$.elements;$w[0]=$V/$U,$w[1]=$A/$U,$w[2]=$a/$U;var $Q=$i._tempVector1,$f=$Q.elements;$f[0]=$v/$m,$f[1]=$T/$m,$f[2]=$G/$m;var $D=$i._tempVector2;$Wg.cross($$,$Q,$D);var $B=$i._tempVector1;return $Wg.cross($D,$$,$B),$n[3]=$n[7]=$n[11]=$n[12]=$n[13]=$n[14]=0,$n[15]=1,$n[0]=$B.x,$n[1]=$B.y,$n[2]=$B.z,$n[4]=$D.x,$n[5]=$D.y,$n[6]=$D.z,$n[8]=$$.x,$n[9]=$$.y,$n[10]=$$.z,$n[0]*$v+$n[1]*$T+$n[2]*$G<0&&($W[0]=-$m),$n[4]*$c+$n[5]*$_+$n[6]*$s<0&&($W[1]=-$F),$n[8]*$V+$n[9]*$A+$n[10]*$a<0&&($W[2]=-$U),!0},$X.decomposeYawPitchRoll=function($X){var $g=$X.elements,$K=Math.asin(-this.elements[9]);$g[1]=$K,Math.cos($K)>$HX.zeroTolerance?($g[2]=Math.atan2(this.elements[1],this.elements[5]),$g[0]=Math.atan2(this.elements[8],this.elements[10])):($g[2]=Math.atan2(-this.elements[4],this.elements[0]),$g[0]=0)},$X.normalize=function(){var $X=this.elements,$g=$X[0],$K=$X[1],$x=$X[2],$Z=Math.sqrt($g*$g+$K*$K+$x*$x);if(!$Z)return $X[0]=0,$X[1]=0,void($X[2]=0);1!=$Z&&($Z=1/$Z,$X[0]=$g*$Z,$X[1]=$K*$Z,$X[2]=$x*$Z)},$X.transpose=function(){var $X,$g;return $g=($X=this.elements)[1],$X[1]=$X[4],$X[4]=$g,$g=$X[2],$X[2]=$X[8],$X[8]=$g,$g=$X[3],$X[3]=$X[12],$X[12]=$g,$g=$X[6],$X[6]=$X[9],$X[9]=$g,$g=$X[7],$X[7]=$X[13],$X[13]=$g,$g=$X[11],$X[11]=$X[14],$X[14]=$g,this},$X.invert=function($X){var $g=this.elements,$K=$X.elements,$x=$g[0],$Z=$g[1],$n=$g[2],$W=$g[3],$v=$g[4],$T=$g[5],$G=$g[6],$c=$g[7],$_=$g[8],$s=$g[9],$V=$g[10],$A=$g[11],$a=$g[12],$m=$g[13],$F=$g[14],$U=$g[15],$$=$x*$T-$Z*$v,$w=$x*$G-$n*$v,$Q=$x*$c-$W*$v,$f=$Z*$G-$n*$T,$D=$Z*$c-$W*$T,$B=$n*$c-$W*$G,$i=$_*$m-$s*$a,$k=$_*$F-$V*$a,$I=$_*$U-$A*$a,$r=$s*$F-$V*$m,$t=$s*$U-$A*$m,$M=$V*$U-$A*$F,$P=$$*$M-$w*$t+$Q*$r+$f*$I-$D*$k+$B*$i;0!==Math.abs($P)&&($P=1/$P,$K[0]=($T*$M-$G*$t+$c*$r)*$P,$K[1]=($n*$t-$Z*$M-$W*$r)*$P,$K[2]=($m*$B-$F*$D+$U*$f)*$P,$K[3]=($V*$D-$s*$B-$A*$f)*$P,$K[4]=($G*$I-$v*$M-$c*$k)*$P,$K[5]=($x*$M-$n*$I+$W*$k)*$P,$K[6]=($F*$Q-$a*$B-$U*$w)*$P,$K[7]=($_*$B-$V*$Q+$A*$w)*$P,$K[8]=($v*$t-$T*$I+$c*$i)*$P,$K[9]=($Z*$I-$x*$t-$W*$i)*$P,$K[10]=($a*$D-$m*$Q+$U*$$)*$P,$K[11]=($s*$Q-$_*$D-$A*$$)*$P,$K[12]=($T*$k-$v*$r-$G*$i)*$P,$K[13]=($x*$r-$Z*$k+$n*$i)*$P,$K[14]=($m*$w-$a*$f-$F*$$)*$P,$K[15]=($_*$f-$s*$w+$V*$$)*$P)},$X.identity=function(){var $X=this.elements;$X[1]=$X[2]=$X[3]=$X[4]=$X[6]=$X[7]=$X[8]=$X[9]=$X[11]=$X[12]=$X[13]=$X[14]=0,$X[0]=$X[5]=$X[10]=$X[15]=1},$X.cloneTo=function($X){var $g,$K,$x;if(($K=this.elements)!==($x=$X.elements))for($g=0;$g<16;++$g)$x[$g]=$K[$g]},$X.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$X.getTranslationVector=function($X){var $g=this.elements,$K=$X.elements;$K[0]=$g[12],$K[1]=$g[13],$K[2]=$g[14]},$X.setTranslationVector=function($X){var $g=this.elements,$K=$X.elements;$g[12]=$K[0],$g[13]=$K[1],$g[14]=$K[2]},$X.getForward=function($X){var $g=this.elements,$K=$X.elements;$K[0]=-$g[8],$K[1]=-$g[9],$K[2]=-$g[10]},$X.setForward=function($X){var $g=this.elements,$K=$X.elements;$g[8]=-$K[0],$g[9]=-$K[1],$g[10]=-$K[2]},$i.createRotationX=function($X,$g){var $K=$g.elements,$x=Math.sin($X),$Z=Math.cos($X);$K[1]=$K[2]=$K[3]=$K[4]=$K[7]=$K[8]=$K[11]=$K[12]=$K[13]=$K[14]=0,$K[0]=$K[15]=1,$K[5]=$K[10]=$Z,$K[6]=$x,$K[9]=-$x},$i.createRotationY=function($X,$g){var $K=$g.elements,$x=Math.sin($X),$Z=Math.cos($X);$K[1]=$K[3]=$K[4]=$K[6]=$K[7]=$K[9]=$K[11]=$K[12]=$K[13]=$K[14]=0,$K[5]=$K[15]=1,$K[0]=$K[10]=$Z,$K[2]=-$x,$K[8]=$x},$i.createRotationZ=function($X,$g){var $K=$g.elements,$x=Math.sin($X),$Z=Math.cos($X);$K[2]=$K[3]=$K[6]=$K[7]=$K[8]=$K[9]=$K[11]=$K[12]=$K[13]=$K[14]=0,$K[10]=$K[15]=1,$K[0]=$K[5]=$Z,$K[1]=$x,$K[4]=-$x},$i.createRotationYawPitchRoll=function($X,$g,$K,$x){$Kg.createFromYawPitchRoll($X,$g,$K,$i._tempQuaternion),$i.createRotationQuaternion($i._tempQuaternion,$x)},$i.createRotationAxis=function($X,$g,$K){var $x=$X.elements,$Z=$x[0],$n=$x[1],$W=$x[2],$v=Math.cos($g),$T=Math.sin($g),$G=$Z*$Z,$c=$n*$n,$_=$W*$W,$s=$Z*$n,$V=$Z*$W,$A=$n*$W,$a=$K.elements;$a[3]=$a[7]=$a[11]=$a[12]=$a[13]=$a[14]=0,$a[15]=1,$a[0]=$G+$v*(1-$G),$a[1]=$s-$v*$s+$T*$W,$a[2]=$V-$v*$V-$T*$n,$a[4]=$s-$v*$s-$T*$W,$a[5]=$c+$v*(1-$c),$a[6]=$A-$v*$A+$T*$Z,$a[8]=$V-$v*$V+$T*$n,$a[9]=$A-$v*$A-$T*$Z,$a[10]=$_+$v*(1-$_)},$i.createRotationQuaternion=function($X,$g){var $K=$X.elements,$x=$g.elements,$Z=$K[0],$n=$K[1],$W=$K[2],$v=$K[3],$T=$Z*$Z,$G=$n*$n,$c=$W*$W,$_=$Z*$n,$s=$W*$v,$V=$W*$Z,$A=$n*$v,$a=$n*$W,$m=$Z*$v;$x[3]=$x[7]=$x[11]=$x[12]=$x[13]=$x[14]=0,$x[15]=1,$x[0]=1-2*($G+$c),$x[1]=2*($_+$s),$x[2]=2*($V-$A),$x[4]=2*($_-$s),$x[5]=1-2*($c+$T),$x[6]=2*($a+$m),$x[8]=2*($V+$A),$x[9]=2*($a-$m),$x[10]=1-2*($G+$T)},$i.createTranslate=function($X,$g){var $K=$X.elements,$x=$g.elements;$x[4]=$x[8]=$x[1]=$x[9]=$x[2]=$x[6]=$x[3]=$x[7]=$x[11]=0,$x[0]=$x[5]=$x[10]=$x[15]=1,$x[12]=$K[0],$x[13]=$K[1],$x[14]=$K[2]},$i.createScaling=function($X,$g){var $K=$X.elements,$x=$g.elements;$x[0]=$K[0],$x[5]=$K[1],$x[10]=$K[2],$x[1]=$x[4]=$x[8]=$x[12]=$x[9]=$x[13]=$x[2]=$x[6]=$x[14]=$x[3]=$x[7]=$x[11]=0,$x[15]=1},$i.multiply=function($X,$g,$K){var $x,$Z,$n,$W,$v,$T,$G,$c;for($Z=$K.elements,$n=$X.elements,$Z===($W=$g.elements)&&($W=$W.slice()),$x=0;$x<4;$x++)$v=$n[$x],$T=$n[$x+4],$G=$n[$x+8],$c=$n[$x+12],$Z[$x]=$v*$W[0]+$T*$W[1]+$G*$W[2]+$c*$W[3],$Z[$x+4]=$v*$W[4]+$T*$W[5]+$G*$W[6]+$c*$W[7],$Z[$x+8]=$v*$W[8]+$T*$W[9]+$G*$W[10]+$c*$W[11],$Z[$x+12]=$v*$W[12]+$T*$W[13]+$G*$W[14]+$c*$W[15]},$i.createFromQuaternion=function($X,$g){var $K=$g.elements,$x=$X.elements,$Z=$x[0],$n=$x[1],$W=$x[2],$v=$x[3],$T=$Z+$Z,$G=$n+$n,$c=$W+$W,$_=$Z*$T,$s=$n*$T,$V=$n*$G,$A=$W*$T,$a=$W*$G,$m=$W*$c,$F=$v*$T,$U=$v*$G,$$=$v*$c;$K[0]=1-$V-$m,$K[1]=$s+$$,$K[2]=$A-$U,$K[3]=0,$K[4]=$s-$$,$K[5]=1-$_-$m,$K[6]=$a+$F,$K[7]=0,$K[8]=$A+$U,$K[9]=$a-$F,$K[10]=1-$_-$V,$K[11]=0,$K[12]=0,$K[13]=0,$K[14]=0,$K[15]=1},$i.createAffineTransformation=function($X,$g,$K,$x){var $Z=$X.elements,$n=$g.elements,$W=$K.elements,$v=$x.elements,$T=$n[0],$G=$n[1],$c=$n[2],$_=$n[3],$s=$T+$T,$V=$G+$G,$A=$c+$c,$a=$T*$s,$m=$T*$V,$F=$T*$A,$U=$G*$V,$$=$G*$A,$w=$c*$A,$Q=$_*$s,$f=$_*$V,$D=$_*$A,$B=$W[0],$i=$W[1],$k=$W[2];$v[0]=(1-($U+$w))*$B,$v[1]=($m+$D)*$B,$v[2]=($F-$f)*$B,$v[3]=0,$v[4]=($m-$D)*$i,$v[5]=(1-($a+$w))*$i,$v[6]=($$+$Q)*$i,$v[7]=0,$v[8]=($F+$f)*$k,$v[9]=($$-$Q)*$k,$v[10]=(1-($a+$U))*$k,$v[11]=0,$v[12]=$Z[0],$v[13]=$Z[1],$v[14]=$Z[2],$v[15]=1},$i.createLookAt=function($X,$g,$K,$x){var $Z=$x.elements,$n=$i._tempVector0,$W=$i._tempVector1,$v=$i._tempVector2;$Wg.subtract($X,$g,$v),$Wg.normalize($v,$v),$Wg.cross($K,$v,$n),$Wg.normalize($n,$n),$Wg.cross($v,$n,$W),$x.identity(),$Z[0]=$n.x,$Z[4]=$n.y,$Z[8]=$n.z,$Z[1]=$W.x,$Z[5]=$W.y,$Z[9]=$W.z,$Z[2]=$v.x,$Z[6]=$v.y,$Z[10]=$v.z,$Z[12]=-$Wg.dot($n,$X),$Z[13]=-$Wg.dot($W,$X),$Z[14]=-$Wg.dot($v,$X)},$i.createPerspective=function($X,$g,$K,$x,$Z){var $n=$Z.elements,$W=1/Math.tan($X/2),$v=1/($K-$x);$n[0]=$W/$g,$n[5]=$W,$n[10]=($x+$K)*$v,$n[11]=-1,$n[14]=2*$x*$K*$v,$n[1]=$n[2]=$n[3]=$n[4]=$n[6]=$n[7]=$n[8]=$n[9]=$n[12]=$n[13]=$n[15]=0},$i.createOrthoOffCenterRH=function($X,$g,$K,$x,$Z,$n,$W){var $v=$W.elements,$T=1/($X-$g),$G=1/($K-$x),$c=1/($Z-$n);$v[1]=$v[2]=$v[3]=$v[4]=$v[6]=$v[7]=$v[8]=$v[9]=$v[11]=0,$v[15]=1,$v[0]=-2*$T,$v[5]=-2*$G,$v[10]=2*$c,$v[12]=($X+$g)*$T,$v[13]=($x+$K)*$G,$v[14]=($n+$Z)*$c},$i.translation=function($X,$g){var $K=$X.elements,$x=$g.elements;$x[0]=$x[5]=$x[10]=$x[15]=1,$x[12]=$K[0],$x[13]=$K[1],$x[14]=$K[2]},$_($i,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $i},"_tempVector0",function(){return this._tempVector0=new $Wg},"_tempVector1",function(){return this._tempVector1=new $Wg},"_tempVector2",function(){return this._tempVector2=new $Wg},"_tempQuaternion",function(){return this._tempQuaternion=new $Kg},"DEFAULT",function(){return this.DEFAULT=new $i},"ZERO",function(){return this.ZERO=new $i(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),$i}(),$gg=(function(){function $$($X,$g){this.extents=null,this.transformation=null,this.extents=$X,this.transformation=$g}$V($$,"laya.d3.math.OrientedBoundBox");var $X=$$.prototype;$X.getCorners=function($X){var $g=$$._tempV30.elements,$K=$$._tempV31.elements,$x=$$._tempV32.elements,$Z=this.extents.elements;$g[0]=$Z[0],$g[1]=$g[2]=0,$K[1]=$Z[1],$K[0]=$K[2]=0,$x[2]=$Z[2],$x[0]=$x[1]=0,$Wg.TransformNormal($$._tempV30,this.transformation,$$._tempV30),$Wg.TransformNormal($$._tempV31,this.transformation,$$._tempV31),$Wg.TransformNormal($$._tempV32,this.transformation,$$._tempV32);var $n=$$._tempV33;this.transformation.getTranslationVector($n),$X.length=8,$Wg.add($n,$$._tempV30,$$._tempV34),$Wg.add($$._tempV34,$$._tempV31,$$._tempV34),$Wg.add($$._tempV34,$$._tempV32,$X[0]),$Wg.add($n,$$._tempV30,$$._tempV34),$Wg.add($$._tempV34,$$._tempV31,$$._tempV34),$Wg.subtract($$._tempV34,$$._tempV32,$X[1]),$Wg.subtract($n,$$._tempV30,$$._tempV34),$Wg.add($$._tempV34,$$._tempV31,$$._tempV34),$Wg.subtract($$._tempV34,$$._tempV32,$X[2]),$Wg.subtract($n,$$._tempV30,$$._tempV34),$Wg.add($$._tempV34,$$._tempV31,$$._tempV34),$Wg.add($$._tempV34,$$._tempV32,$X[3]),$Wg.add($n,$$._tempV30,$$._tempV34),$Wg.subtract($$._tempV34,$$._tempV31,$$._tempV34),$Wg.add($$._tempV34,$$._tempV32,$X[4]),$Wg.add($n,$$._tempV30,$$._tempV34),$Wg.subtract($$._tempV34,$$._tempV31,$$._tempV34),$Wg.subtract($$._tempV34,$$._tempV32,$X[5]),$Wg.subtract($n,$$._tempV30,$$._tempV34),$Wg.subtract($$._tempV34,$$._tempV31,$$._tempV34),$Wg.subtract($$._tempV34,$$._tempV32,$X[6]),$Wg.subtract($n,$$._tempV30,$$._tempV34),$Wg.subtract($$._tempV34,$$._tempV31,$$._tempV34),$Wg.add($$._tempV34,$$._tempV32,$X[7])},$X.transform=function($X){$Xg.multiply(this.transformation,$X,this.transformation)},$X.scale=function($X){$Wg.multiply(this.extents,$X,this.extents)},$X.translate=function($X){this.transformation.getTranslationVector($$._tempV30),$Wg.add($$._tempV30,$X,$$._tempV31),this.transformation.setTranslationVector($$._tempV31)},$X.Size=function($X){$Wg.scale(this.extents,2,$X)},$X.getSize=function($X){var $g=this.extents.elements;$$._tempV30.x=$g[0],$$._tempV31.y=$g[1],$$._tempV32.z=$g[2],$Wg.TransformNormal($$._tempV30,this.transformation,$$._tempV30),$Wg.TransformNormal($$._tempV31,this.transformation,$$._tempV31),$Wg.TransformNormal($$._tempV31,this.transformation,$$._tempV32);var $K=$X.elements;$K[0]=$Wg.scalarLength($$._tempV30),$K[1]=$Wg.scalarLength($$._tempV31),$K[2]=$Wg.scalarLength($$._tempV32)},$X.getSizeSquared=function($X){var $g=this.extents.elements;$$._tempV30.x=$g[0],$$._tempV31.y=$g[1],$$._tempV32.z=$g[2],$Wg.TransformNormal($$._tempV30,this.transformation,$$._tempV30),$Wg.TransformNormal($$._tempV31,this.transformation,$$._tempV31),$Wg.TransformNormal($$._tempV31,this.transformation,$$._tempV32);var $K=$X.elements;$K[0]=$Wg.scalarLengthSquared($$._tempV30),$K[1]=$Wg.scalarLengthSquared($$._tempV31),$K[2]=$Wg.scalarLengthSquared($$._tempV32)},$X.getCenter=function($X){this.transformation.getTranslationVector($X)},$X.containsPoint=function($X){var $g=this.extents.elements,$K=$g[0],$x=$g[1],$Z=$g[2];this.transformation.invert($$._tempM0),$Wg.transformCoordinate($X,$$._tempM0,$$._tempV30);var $n=$$._tempV30.elements,$W=Math.abs($n[0]),$v=Math.abs($n[1]),$T=Math.abs($n[2]);return $HX.nearEqual($W,$K)&&$HX.nearEqual($v,$x)&&$HX.nearEqual($T,$Z)?2:$W<$K&&$v<$x&&$T<$Z?1:0},$X.containsPoints=function($X){var $g=this.extents.elements,$K=$g[0],$x=$g[1],$Z=$g[2];this.transformation.invert($$._tempM0);for(var $n=!0,$W=!1,$v=0;$v<$X.length;$v++){$Wg.transformCoordinate($X[$v],$$._tempM0,$$._tempV30);var $T=$$._tempV30.elements,$G=Math.abs($T[0]),$c=Math.abs($T[1]),$_=Math.abs($T[2]);$HX.nearEqual($G,$K)&&$HX.nearEqual($c,$x)&&$HX.nearEqual($_,$Z)&&($W=!0),$G<$K&&$c<$x&&$_<$Z?$W=!0:$n=!1}return $n?1:$W?2:0},$X.containsSphere=function($X,$g){void 0===$g&&($g=!1);var $K=this.extents.elements,$x=$K[0],$Z=$K[1],$n=$K[2],$W=$X.radius;this.transformation.invert($$._tempM0),$Wg.transformCoordinate($X.center,$$._tempM0,$$._tempV30);var $v=NaN;if($v=$g?$W:($Wg.scale($Wg.UnitX,$W,$$._tempV31),$Wg.TransformNormal($$._tempV31,$$._tempM0,$$._tempV31),$Wg.scalarLength($$._tempV31)),$Wg.scale(this.extents,-1,$$._tempV32),$Wg.Clamp($$._tempV30,$$._tempV32,this.extents,$$._tempV33),$v*$v<$Wg.distanceSquared($$._tempV30,$$._tempV33))return 0;var $T=$$._tempV30.elements,$G=$T[0],$c=$T[1],$_=$T[2],$s=$$._tempV32.elements,$V=$s[0],$A=$s[1],$a=$s[2];return $V+$v<=$G&&$G<=$x-$v&&$v<$x-$V&&$A+$v<=$c&&$c<=$Z-$v&&$v<$Z-$A&&$a+$v<=$_&&$_<=$n-$v&&$v<$n-$a?1:2},$X.containsOrientedBoundBox=function($X){var $g=0,$K=0;$X.getCorners($$._corners);var $x=this.containsPoints($$._corners);if(0!=$x)return $x;var $Z=this.extents.elements;$X.extents.cloneTo($$._tempV35);var $n=$$._tempV35.elements;$$._getRows(this.transformation,$$._rows1),$$._getRows($X.transformation,$$._rows2);var $W=NaN;for($g=0;$g<4;$g++)for($K=0;$K<4;$K++)3==$g||3==$K?($$._tempM0.setElementByRowColumn($g,$K,0),$$._tempM1.setElementByRowColumn($g,$K,0)):($W=$Wg.dot($$._rows1[$g],$$._rows2[$K]),$$._tempM0.setElementByRowColumn($g,$K,$W),$$._tempM1.setElementByRowColumn($g,$K,Math.abs($W)));$X.getCenter($$._tempV34),this.getCenter($$._tempV36),$Wg.subtract($$._tempV34,$$._tempV36,$$._tempV30);var $v=$$._tempV31.elements;$v[0]=$Wg.dot($$._tempV30,$$._rows1[0]),$v[1]=$Wg.dot($$._tempV30,$$._rows1[1]),$v[2]=$Wg.dot($$._tempV30,$$._rows1[2]);var $T=$$._tempV32.elements,$G=$$._tempV33.elements;for($g=0;$g<3;$g++)if($T[0]=$$._tempM1.getElementByRowColumn($g,0),$T[1]=$$._tempM1.getElementByRowColumn($g,1),$T[2]=$$._tempM1.getElementByRowColumn($g,2),$Z[$g]+$Wg.dot($$._tempV35,$$._tempV32)<Math.abs($v[$g]))return 0;for($K=0;$K<3;$K++)if($T[0]=$$._tempM1.getElementByRowColumn(0,$K),$T[1]=$$._tempM1.getElementByRowColumn(1,$K),$T[2]=$$._tempM1.getElementByRowColumn(2,$K),$G[0]=$$._tempM0.getElementByRowColumn(0,$K),$G[1]=$$._tempM0.getElementByRowColumn(1,$K),$G[2]=$$._tempM0.getElementByRowColumn(2,$K),$Wg.dot(this.extents,$$._tempV32)+$n[$K]<Math.abs($Wg.dot($$._tempV31,$$._tempV33)))return 0;for($g=0;$g<3;$g++)for($K=0;$K<3;$K++){var $c=($g+1)%3,$_=($g+2)%3,$s=($K+1)%3,$V=($K+2)%3;if($Z[$c]*$$._tempM1.getElementByRowColumn($_,$K)+$Z[$_]*$$._tempM1.getElementByRowColumn($c,$K)+($n[$s]*$$._tempM1.getElementByRowColumn($g,$V)+$n[$V]*$$._tempM1.getElementByRowColumn($g,$s))<Math.abs($v[$_]*$$._tempM0.getElementByRowColumn($c,$K)-$v[$c]*$$._tempM0.getElementByRowColumn($_,$K)))return 0}return 2},$X.containsLine=function($X,$g){$$._corners[0]=$X,$$._corners[1]=$g;var $K=this.containsPoints($$._corners);if(0!=$K)return $K;var $x=this.extents.elements,$Z=$x[0],$n=$x[1],$W=$x[2];this.transformation.invert($$._tempM0),$Wg.transformCoordinate($X,$$._tempM0,$$._tempV30),$Wg.transformCoordinate($g,$$._tempM0,$$._tempV31),$Wg.add($$._tempV30,$$._tempV31,$$._tempV32),$Wg.scale($$._tempV32,.5,$$._tempV32),$Wg.subtract($$._tempV30,$$._tempV32,$$._tempV33);var $v=$$._tempV33.elements,$T=$v[0],$G=$v[1],$c=$v[2],$_=$$._tempV34.elements,$s=$_[0]=Math.abs($v[0]),$V=$_[1]=Math.abs($v[1]),$A=$_[2]=Math.abs($v[2]),$a=$$._tempV32.elements,$m=$a[0],$F=$a[1],$U=$a[2];return Math.abs($m)>$Z+$s?0:Math.abs($F)>$n+$V?0:Math.abs($U)>$W+$A?0:Math.abs($F*$c-$U*$G)>$n*$A+$W*$V?0:Math.abs($m*$c-$U*$T)>$Z*$A+$W*$s?0:Math.abs($m*$G-$F*$T)>$Z*$V+$n*$s?0:2},$X.containsBoundBox=function($X){var $g=0,$K=0,$x=$X.min,$Z=$X.max;$X.getCorners($$._corners);var $n=this.containsPoints($$._corners);if(0!=$n)return $n;$Wg.subtract($Z,$x,$$._tempV30),$Wg.scale($$._tempV30,.5,$$._tempV30),$Wg.add($x,$$._tempV30,$$._tempV30),$Wg.subtract($Z,$$._tempV30,$$._tempV31);var $W=this.extents.elements,$v=$$._tempV31.elements;$$._getRows(this.transformation,$$._rows1),this.transformation.invert($$._tempM0);for($g=0;$g<3;$g++)for($K=0;$K<3;$K++)$$._tempM1.setElementByRowColumn($g,$K,Math.abs($$._tempM0.getElementByRowColumn($g,$K)));this.getCenter($$._tempV35),$Wg.subtract($$._tempV30,$$._tempV35,$$._tempV32);var $T=$$._tempV31.elements;$T[0]=$Wg.dot($$._tempV32,$$._rows1[0]),$T[1]=$Wg.dot($$._tempV32,$$._rows1[1]),$T[2]=$Wg.dot($$._tempV32,$$._rows1[2]);var $G=$$._tempV33.elements,$c=$$._tempV34.elements;for($g=0;$g<3;$g++)if($G[0]=$$._tempM1.getElementByRowColumn($g,0),$G[1]=$$._tempM1.getElementByRowColumn($g,1),$G[2]=$$._tempM1.getElementByRowColumn($g,2),$W[$g]+$Wg.dot($$._tempV31,$$._tempV33)<Math.abs($T[$g]))return 0;for($K=0;$K<3;$K++)if($G[0]=$$._tempM1.getElementByRowColumn(0,$K),$G[1]=$$._tempM1.getElementByRowColumn(1,$K),$G[2]=$$._tempM1.getElementByRowColumn(2,$K),$c[0]=$$._tempM0.getElementByRowColumn(0,$K),$c[1]=$$._tempM0.getElementByRowColumn(1,$K),$c[2]=$$._tempM0.getElementByRowColumn(2,$K),$Wg.dot(this.extents,$$._tempV33)+$v[$K]<Math.abs($Wg.dot($$._tempV31,$$._tempV34)))return 0;for($g=0;$g<3;$g++)for($K=0;$K<3;$K++){var $_=($g+1)%3,$s=($g+2)%3,$V=($K+1)%3,$A=($K+2)%3;if($W[$_]*$$._tempM1.getElementByRowColumn($s,$K)+$W[$s]*$$._tempM1.getElementByRowColumn($_,$K)+($v[$V]*$$._tempM1.getElementByRowColumn($g,$A)+$v[$A]*$$._tempM1.getElementByRowColumn($g,$V))<Math.abs($T[$s]*$$._tempM0.getElementByRowColumn($_,$K)-$T[$_]*$$._tempM0.getElementByRowColumn($s,$K)))return 0}return 2},$X.intersectsRay=function($X,$g){$Wg.scale(this.extents,-1,$$._tempV30),this.transformation.invert($$._tempM0),$Wg.TransformNormal($X.direction,$$._tempM0,$$._ray.direction),$Wg.transformCoordinate($X.origin,$$._tempM0,$$._ray.origin),$$._boxBound1.min=$$._tempV30,$$._boxBound1.max=this.extents;var $K=Collision.intersectsRayAndBoxRP($$._ray,$$._boxBound1,$g);return-1!==$K&&$Wg.transformCoordinate($g,this.transformation,$g),$K},$X._getLocalCorners=function($X){$X.length=8;var $g=this.extents.elements;$$._tempV30.x=$g[0],$$._tempV31.y=$g[1],$$._tempV32.z=$g[2],$Wg.add($$._tempV30,$$._tempV31,$$._tempV33),$Wg.add($$._tempV33,$$._tempV32,$X[0]),$Wg.add($$._tempV30,$$._tempV31,$$._tempV33),$Wg.subtract($$._tempV33,$$._tempV32,$X[1]),$Wg.subtract($$._tempV31,$$._tempV30,$$._tempV33),$Wg.subtract($$._tempV33,$$._tempV30,$X[2]),$Wg.subtract($$._tempV31,$$._tempV30,$$._tempV33),$Wg.add($$._tempV33,$$._tempV32,$X[3]),$Wg.subtract($$._tempV30,$$._tempV31,$$._tempV33),$Wg.add($$._tempV33,$$._tempV32,$X[4]),$Wg.subtract($$._tempV30,$$._tempV31,$$._tempV33),$Wg.subtract($$._tempV33,$$._tempV32,$X[5]),$Wg.scale($X[0],-1,$X[6]),$Wg.subtract($$._tempV32,$$._tempV30,$$._tempV33),$Wg.subtract($$._tempV33,$$._tempV31,$X[7])},$X.equals=function($X){return this.extents==$X.extents&&this.transformation==$X.transformation},$X.cloneTo=function($X){var $g=$X;this.extents.cloneTo($g.extents),this.transformation.cloneTo($g.transformation)},$$.createByBoundBox=function($X,$g){var $K=$X.min,$x=$X.max;$Wg.subtract($x,$K,$$._tempV30),$Wg.scale($$._tempV30,.5,$$._tempV30),$Wg.add($K,$$._tempV30,$$._tempV31),$Wg.subtract($x,$$._tempV31,$$._tempV32),$Xg.translation($$._tempV31,$$._tempM0);var $Z=$$._tempV32.clone(),$n=$$._tempM0.clone();$g.extents=$Z,$g.transformation=$n},$$.createByMinAndMaxVertex=function($X,$g){return $Wg.subtract($g,$X,$$._tempV30),$Wg.scale($$._tempV30,.5,$$._tempV30),$Wg.add($X,$$._tempV30,$$._tempV31),$Wg.subtract($g,$$._tempV31,$$._tempV32),$Xg.translation($$._tempV31,$$._tempM0),new $$($$._tempV32,$$._tempM0)},$$._getRows=function($X,$g){$g.length=3;var $K=$X.elements,$x=$g[0].elements;$x[0]=$K[0],$x[1]=$K[1],$x[2]=$K[2];var $Z=$g[1].elements;$Z[0]=$K[4],$Z[1]=$K[5],$Z[2]=$K[6];var $n=$g[2].elements;$n[0]=$K[8],$n[1]=$K[9],$n[2]=$K[10]},$$.getObbtoObbMatrix4x4=function($X,$g,$K,$x){var $Z=$X.transformation,$n=$g.transformation;if($K){$$._getRows($Z,$$._rows1),$$._getRows($n,$$._rows2);for(var $W=0;$W<3;$W++)for(var $v=0;$v<3;$v++)$x.setElementByRowColumn($W,$v,$Wg.dot($$._rows2[$W],$$._rows1[$v]));$g.getCenter($$._tempV30),$X.getCenter($$._tempV31),$Wg.subtract($$._tempV30,$$._tempV31,$$._tempV32);var $T=$x.elements;$T[12]=$Wg.dot($$._tempV32,$$._rows1[0]),$T[13]=$Wg.dot($$._tempV32,$$._rows1[1]),$T[14]=$Wg.dot($$._tempV32,$$._rows1[2]),$T[15]=1}else $Z.invert($$._tempM0),$Xg.multiply($n,$$._tempM0,$x)},$$.merge=function($X,$g,$K){var $x=$X.extents,$Z=$X.transformation;$$.getObbtoObbMatrix4x4($X,$g,$K,$$._tempM0),$g._getLocalCorners($$._corners),$Wg.transformCoordinate($$._corners[0],$$._tempM0,$$._corners[0]),$Wg.transformCoordinate($$._corners[1],$$._tempM0,$$._corners[1]),$Wg.transformCoordinate($$._corners[2],$$._tempM0,$$._corners[2]),$Wg.transformCoordinate($$._corners[3],$$._tempM0,$$._corners[3]),$Wg.transformCoordinate($$._corners[4],$$._tempM0,$$._corners[4]),$Wg.transformCoordinate($$._corners[5],$$._tempM0,$$._corners[5]),$Wg.transformCoordinate($$._corners[6],$$._tempM0,$$._corners[6]),$Wg.transformCoordinate($$._corners[7],$$._tempM0,$$._corners[7]),$Wg.scale($x,-1,$$._boxBound1.min),$x.cloneTo($$._boxBound1.max),$zX.createfromPoints($$._corners,$$._boxBound2),$zX.merge($$._boxBound2,$$._boxBound1,$$._boxBound3);var $n=$$._boxBound3.min,$W=$$._boxBound3.max;$Wg.subtract($W,$n,$$._tempV30),$Wg.scale($$._tempV30,.5,$$._tempV30),$Wg.add($n,$$._tempV30,$$._tempV32),$Wg.subtract($W,$$._tempV32,$x),$Wg.transformCoordinate($$._tempV32,$Z,$$._tempV33)},$_($$,["_tempV30",function(){return this._tempV30=new $Wg},"_tempV31",function(){return this._tempV31=new $Wg},"_tempV32",function(){return this._tempV32=new $Wg},"_tempV33",function(){return this._tempV33=new $Wg},"_tempV34",function(){return this._tempV34=new $Wg},"_tempV35",function(){return this._tempV35=new $Wg},"_tempV36",function(){return this._tempV36=new $Wg},"_tempM0",function(){return this._tempM0=new $Xg},"_tempM1",function(){return this._tempM1=new $Xg},"_corners",function(){return this._corners=[new $Wg,new $Wg,new $Wg,new $Wg,new $Wg,new $Wg,new $Wg,new $Wg]},"_rows1",function(){return this._rows1=[new $Wg,new $Wg,new $Wg]},"_rows2",function(){return this._rows2=[new $Wg,new $Wg,new $Wg]},"_ray",function(){return this._ray=new $Zg(new $Wg,new $Wg)},"_boxBound1",function(){return this._boxBound1=new $zX(new $Wg,new $Wg)},"_boxBound2",function(){return this._boxBound2=new $zX(new $Wg,new $Wg)},"_boxBound3",function(){return this._boxBound3=new $zX(new $Wg,new $Wg)}])}(),function(){function $Q($X,$g){this.normal=null,this.distance=NaN,void 0===$g&&($g=0),this.normal=$X,this.distance=$g}return $V($Q,"laya.d3.math.Plane"),$Q.prototype.normalize=function(){var $X=this.normal.elements,$g=$X[0],$K=$X[1],$x=$X[2],$Z=1/Math.sqrt($g*$g+$K*$K+$x*$x);$X[0]=$g*$Z,$X[1]=$K*$Z,$X[2]=$x*$Z,this.distance*=$Z},$Q.createPlaneBy3P=function($X,$g,$K){var $x=$X.elements,$Z=$g.elements,$n=$K.elements,$W=$Z[0]-$x[0],$v=$Z[1]-$x[1],$T=$Z[2]-$x[2],$G=$n[0]-$x[0],$c=$n[1]-$x[1],$_=$n[2]-$x[2],$s=$v*$_-$T*$c,$V=$T*$G-$W*$_,$A=$W*$c-$v*$G,$a=1/Math.sqrt($s*$s+$V*$V+$A*$A),$m=$s*$a,$F=$V*$a,$U=$A*$a,$$=$Q._TEMPVec3.elements;$$[0]=$m,$$[1]=$F,$$[2]=$U;var $w=-($m*$x[0]+$F*$x[1]+$U*$x[2]);return new $Q($Q._TEMPVec3,$w)},$Q.PlaneIntersectionType_Back=0,$Q.PlaneIntersectionType_Front=1,$Q.PlaneIntersectionType_Intersecting=2,$_($Q,["_TEMPVec3",function(){return this._TEMPVec3=new $Wg}]),$Q}()),$Kg=function(){function $Z($X,$g,$K,$x){this.elements=new Float32Array(4),void 0===$X&&($X=0),void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=1),this.elements[0]=$X,this.elements[1]=$g,this.elements[2]=$K,this.elements[3]=$x}$V($Z,"laya.d3.math.Quaternion");var $X=$Z.prototype;return $Q.imps($X,{"laya.d3.core.IClone":!0}),$X.scaling=function($X,$g){var $K=$g.elements,$x=this.elements;$K[0]=$x[0]*$X,$K[1]=$x[1]*$X,$K[2]=$x[2]*$X,$K[3]=$x[3]*$X},$X.normalize=function($X){var $g=$X.elements,$K=this.elements,$x=$K[0],$Z=$K[1],$n=$K[2],$W=$K[3],$v=$x*$x+$Z*$Z+$n*$n+$W*$W;0<$v&&($v=1/Math.sqrt($v),$g[0]=$x*$v,$g[1]=$Z*$v,$g[2]=$n*$v,$g[3]=$W*$v)},$X.length=function(){var $X=this.elements,$g=$X[0],$K=$X[1],$x=$X[2],$Z=$X[3];return Math.sqrt($g*$g+$K*$K+$x*$x+$Z*$Z)},$X.rotateX=function($X,$g){var $K=$g.elements,$x=this.elements;$X*=.5;var $Z=$x[0],$n=$x[1],$W=$x[2],$v=$x[3],$T=Math.sin($X),$G=Math.cos($X);$K[0]=$Z*$G+$v*$T,$K[1]=$n*$G+$W*$T,$K[2]=$W*$G-$n*$T,$K[3]=$v*$G-$Z*$T},$X.rotateY=function($X,$g){var $K=$g.elements,$x=this.elements;$X*=.5;var $Z=$x[0],$n=$x[1],$W=$x[2],$v=$x[3],$T=Math.sin($X),$G=Math.cos($X);$K[0]=$Z*$G-$W*$T,$K[1]=$n*$G+$v*$T,$K[2]=$W*$G+$Z*$T,$K[3]=$v*$G-$n*$T},$X.rotateZ=function($X,$g){var $K=$g.elements,$x=this.elements;$X*=.5;var $Z=$x[0],$n=$x[1],$W=$x[2],$v=$x[3],$T=Math.sin($X),$G=Math.cos($X);$K[0]=$Z*$G+$n*$T,$K[1]=$n*$G-$Z*$T,$K[2]=$W*$G+$v*$T,$K[3]=$v*$G-$W*$T},$X.getYawPitchRoll=function($X){$Wg.transformQuat($Wg.ForwardRH,this,$Z.TEMPVector31),$Wg.transformQuat($Wg.Up,this,$Z.TEMPVector32);var $g=$Z.TEMPVector32.elements;$Z.angleTo($Wg.ZERO,$Z.TEMPVector31,$Z.TEMPVector33);var $K=$Z.TEMPVector33.elements;$K[0]==Math.PI/2?($K[1]=$Z.arcTanAngle($g[2],$g[0]),$K[2]=0):$K[0]==-Math.PI/2?($K[1]=$Z.arcTanAngle(-$g[2],-$g[0]),$K[2]=0):($Xg.createRotationY(-$K[1],$Z.TEMPMatrix0),$Xg.createRotationX(-$K[0],$Z.TEMPMatrix1),$Wg.transformCoordinate($Z.TEMPVector32,$Z.TEMPMatrix0,$Z.TEMPVector32),$Wg.transformCoordinate($Z.TEMPVector32,$Z.TEMPMatrix1,$Z.TEMPVector32),$K[2]=$Z.arcTanAngle($g[1],-$g[0])),$K[1]<=-Math.PI&&($K[1]=Math.PI),$K[2]<=-Math.PI&&($K[2]=Math.PI),$K[1]>=Math.PI&&$K[2]>=Math.PI&&($K[1]=0,$K[2]=0,$K[0]=Math.PI-$K[0]);var $x=$X.elements;$x[0]=$K[1],$x[1]=$K[0],$x[2]=$K[2]},$X.invert=function($X){var $g=$X.elements,$K=this.elements,$x=$K[0],$Z=$K[1],$n=$K[2],$W=$K[3],$v=$x*$x+$Z*$Z+$n*$n+$W*$W,$T=$v?1/$v:0;$g[0]=-$x*$T,$g[1]=-$Z*$T,$g[2]=-$n*$T,$g[3]=$W*$T},$X.identity=function(){var $X=this.elements;$X[0]=0,$X[1]=0,$X[2]=0,$X[3]=1},$X.fromArray=function($X,$g){void 0===$g&&($g=0),this.elements[0]=$X[$g+0],this.elements[1]=$X[$g+1],this.elements[2]=$X[$g+2],this.elements[3]=$X[$g+3]},$X.cloneTo=function($X){var $g,$K,$x;if(($K=this.elements)!==($x=$X.elements))for($g=0;$g<4;++$g)$x[$g]=$K[$g]},$X.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$X.equals=function($X){var $g=this.elements,$K=$X.elements;return $HX.nearEqual($g[0],$K[0])&&$HX.nearEqual($g[1],$K[1])&&$HX.nearEqual($g[2],$K[2])&&$HX.nearEqual($g[3],$K[3])},$X.lengthSquared=function(){var $X=this.elements[0],$g=this.elements[1],$K=this.elements[2],$x=this.elements[3];return $X*$X+$g*$g+$K*$K+$x*$x},$A(0,$X,"x",function(){return this.elements[0]}),$A(0,$X,"y",function(){return this.elements[1]}),$A(0,$X,"z",function(){return this.elements[2]}),$A(0,$X,"w",function(){return this.elements[3]}),$Z.createFromYawPitchRoll=function($X,$g,$K,$x){var $Z=.5*$K,$n=.5*$g,$W=.5*$X,$v=Math.sin($Z),$T=Math.cos($Z),$G=Math.sin($n),$c=Math.cos($n),$_=Math.sin($W),$s=Math.cos($W),$V=$x.elements;$V[0]=$s*$G*$T+$_*$c*$v,$V[1]=$_*$c*$T-$s*$G*$v,$V[2]=$s*$c*$v-$_*$G*$T,$V[3]=$s*$c*$T+$_*$G*$v},$Z.multiply=function($X,$g,$K){var $x=$X.elements,$Z=$g.elements,$n=$K.elements,$W=$x[0],$v=$x[1],$T=$x[2],$G=$x[3],$c=$Z[0],$_=$Z[1],$s=$Z[2],$V=$Z[3],$A=$v*$s-$T*$_,$a=$T*$c-$W*$s,$m=$W*$_-$v*$c,$F=$W*$c+$v*$_+$T*$s;$n[0]=$W*$V+$c*$G+$A,$n[1]=$v*$V+$_*$G+$a,$n[2]=$T*$V+$s*$G+$m,$n[3]=$G*$V-$F},$Z.arcTanAngle=function($X,$g){return 0==$X?1==$g?Math.PI/2:-Math.PI/2:0<$X?Math.atan($g/$X):$X<0?0<$g?Math.atan($g/$X)+Math.PI:Math.atan($g/$X)-Math.PI:0},$Z.angleTo=function($X,$g,$K){$Wg.subtract($g,$X,$Z.TEMPVector30),$Wg.normalize($Z.TEMPVector30,$Z.TEMPVector30),$K.elements[0]=Math.asin($Z.TEMPVector30.y),$K.elements[1]=$Z.arcTanAngle(-$Z.TEMPVector30.z,-$Z.TEMPVector30.x)},$Z.createFromAxisAngle=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements;$g*=.5;var $n=Math.sin($g);$x[0]=$n*$Z[0],$x[1]=$n*$Z[1],$x[2]=$n*$Z[2],$x[3]=Math.cos($g)},$Z.createFromMatrix3x3=function($X,$g){var $K,$x=$g.elements,$Z=$X.elements,$n=$Z[0]+$Z[4]+$Z[8];if(0<$n)$K=Math.sqrt($n+1),$x[3]=.5*$K,$K=.5/$K,$x[0]=($Z[5]-$Z[7])*$K,$x[1]=($Z[6]-$Z[2])*$K,$x[2]=($Z[1]-$Z[3])*$K;else{var $W=0;$Z[4]>$Z[0]&&($W=1),$Z[8]>$Z[3*$W+$W]&&($W=2);var $v=($W+1)%3,$T=($W+2)%3;$K=Math.sqrt($Z[3*$W+$W]-$Z[3*$v+$v]-$Z[3*$T+$T]+1),$x[$W]=.5*$K,$K=.5/$K,$x[3]=($Z[3*$v+$T]-$Z[3*$T+$v])*$K,$x[$v]=($Z[3*$v+$W]+$Z[3*$W+$v])*$K,$x[$T]=($Z[3*$T+$W]+$Z[3*$W+$T])*$K}},$Z.createFromMatrix4x4=function($X,$g){var $K,$x,$Z=$X.elements,$n=$g.elements,$W=$Z[0]+$Z[5]+$Z[10];0<$W?($K=Math.sqrt($W+1),$n[3]=.5*$K,$K=.5/$K,$n[0]=($Z[6]-$Z[9])*$K,$n[1]=($Z[8]-$Z[2])*$K,$n[2]=($Z[1]-$Z[4])*$K):$Z[0]>=$Z[5]&&$Z[0]>=$Z[10]?($x=.5/($K=Math.sqrt(1+$Z[0]-$Z[5]-$Z[10])),$n[0]=.5*$K,$n[1]=($Z[1]+$Z[4])*$x,$n[2]=($Z[2]+$Z[8])*$x,$n[3]=($Z[6]-$Z[9])*$x):$Z[5]>$Z[10]?($x=.5/($K=Math.sqrt(1+$Z[5]-$Z[0]-$Z[10])),$n[0]=($Z[4]+$Z[1])*$x,$n[1]=.5*$K,$n[2]=($Z[9]+$Z[6])*$x,$n[3]=($Z[8]-$Z[2])*$x):($x=.5/($K=Math.sqrt(1+$Z[10]-$Z[0]-$Z[5])),$n[0]=($Z[8]+$Z[2])*$x,$n[1]=($Z[9]+$Z[6])*$x,$n[2]=.5*$K,$n[3]=($Z[1]-$Z[4])*$x)},$Z.slerp=function($X,$g,$K,$x){var $Z,$n,$W,$v,$T,$G=$X.elements,$c=$g.elements,$_=$x.elements,$s=$G[0],$V=$G[1],$A=$G[2],$a=$G[3],$m=$c[0],$F=$c[1],$U=$c[2],$$=$c[3];return($n=$s*$m+$V*$F+$A*$U+$a*$$)<0&&($n=-$n,$m=-$m,$F=-$F,$U=-$U,$$=-$$),$T=1e-6<1-$n?($Z=Math.acos($n),$W=Math.sin($Z),$v=Math.sin((1-$K)*$Z)/$W,Math.sin($K*$Z)/$W):($v=1-$K,$K),$_[0]=$v*$s+$T*$m,$_[1]=$v*$V+$T*$F,$_[2]=$v*$A+$T*$U,$_[3]=$v*$a+$T*$$,$_},$Z.lerp=function($X,$g,$K,$x){var $Z=$x.elements,$n=$X.elements,$W=$g.elements,$v=$n[0],$T=$n[1],$G=$n[2],$c=$n[3];$Z[0]=$v+$K*($W[0]-$v),$Z[1]=$T+$K*($W[1]-$T),$Z[2]=$G+$K*($W[2]-$G),$Z[3]=$c+$K*($W[3]-$c)},$Z.add=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements;$x[0]=$Z[0]+$n[0],$x[1]=$Z[1]+$n[1],$x[2]=$Z[2]+$n[2],$x[3]=$Z[3]+$n[3]},$Z.dot=function($X,$g){var $K=$X.elements,$x=$g.elements;return $K[0]*$x[0]+$K[1]*$x[1]+$K[2]*$x[2]+$K[3]*$x[3]},$Z.rotationLookAt=function($X,$g,$K){$Z.lookAt($Wg.ZERO,$X,$g,$K)},$Z.lookAt=function($X,$g,$K,$x){$yX.lookAt($X,$g,$K,$Z._tempMatrix3x3),$Z.rotationMatrix($Z._tempMatrix3x3,$x)},$Z.invert=function($X,$g){var $K=$X.elements,$x=$g.elements,$Z=$X.lengthSquared();$HX.isZero($Z)||($Z=1/$Z,$x[0]=-$K[0]*$Z,$x[1]=-$K[1]*$Z,$x[2]=-$K[2]*$Z,$x[3]=$K[3]*$Z)},$Z.rotationMatrix=function($X,$g){var $K=$X.elements,$x=$K[0],$Z=$K[1],$n=$K[2],$W=$K[3],$v=$K[4],$T=$K[5],$G=$K[6],$c=$K[7],$_=$K[8],$s=$g.elements,$V=NaN,$A=NaN,$a=$x+$v+$_;0<$a?($V=Math.sqrt($a+1),$s[3]=.5*$V,$V=.5/$V,$s[0]=($T-$c)*$V,$s[1]=($G-$n)*$V,$s[2]=($Z-$W)*$V):$v<=$x&&$_<=$x?($A=.5/($V=Math.sqrt(1+$x-$v-$_)),$s[0]=.5*$V,$s[1]=($Z+$W)*$A,$s[2]=($n+$G)*$A,$s[3]=($T-$c)*$A):$_<$v?($A=.5/($V=Math.sqrt(1+$v-$x-$_)),$s[0]=($W+$Z)*$A,$s[1]=.5*$V,$s[2]=($c+$T)*$A,$s[3]=($G-$n)*$A):($A=.5/($V=Math.sqrt(1+$_-$x-$v)),$s[0]=($G+$n)*$A,$s[1]=($c+$T)*$A,$s[2]=.5*$V,$s[3]=($Z-$W)*$A)},$Z.DEFAULT=new $Z,$_($Z,["TEMPVector30",function(){return this.TEMPVector30=new $Wg},"TEMPVector31",function(){return this.TEMPVector31=new $Wg},"TEMPVector32",function(){return this.TEMPVector32=new $Wg},"TEMPVector33",function(){return this.TEMPVector33=new $Wg},"TEMPMatrix0",function(){return this.TEMPMatrix0=new $Xg},"TEMPMatrix1",function(){return this.TEMPMatrix1=new $Xg},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new $yX},"NAN",function(){return this.NAN=new $Z(NaN,NaN,NaN,NaN)}]),$Z}(),$xg=function(){function $X($X){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=$X,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}$V($X,"laya.d3.math.Rand");var $g=$X.prototype;return $g.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},$g.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},$g.getSignedFloat=function(){return 2*this.getFloat()-1},$A(0,$g,"seed",function(){return this.seeds[0]},function($X){this.seeds[0]=$X,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),$X.getFloatFromInt=function($X){return 1/8388607*(8388607&$X)},$X.getByteFromInt=function($X){return(8388607&$X)>>>15},$X}(),$Zg=(function(){function $Z($X){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!($X instanceof Array)||4!==$X.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|$X[0],this._state0L=0|$X[1],this._state1U=0|$X[2],this._state1L=0|$X[3]}$V($Z,"laya.d3.math.RandX");var $X=$Z.prototype;$X.randomint=function(){var $X=this._state0U,$g=this._state0L,$K=this._state1U,$x=this._state1L,$Z=($x>>>0)+($g>>>0),$n=$K+$X+($Z/2>>>31)>>>0,$W=$Z>>>0,$v=0,$T=0;$v=($X^=$v=$X<<23|(-512&$g)>>>9)^(this._state0U=$K),$T=($g^=$T=$g<<23)^(this._state0L=$x);$v^=$X>>>18,$T^=$g>>>18|(262143&$X)<<14;return $v^=$K>>>5,$T^=$x>>>5|(31&$K)<<27,this._state1U=$v,this._state1L=$T,[$n,$W]},$X.random=function(){var $X=this.randomint(),$g=$X[0],$K=1023<<20|$g>>>12,$x=0|($X[1]>>>12|(4095&$g)<<20);return $Z._CONVERTION_BUFFER.setUint32(0,$K,!1),$Z._CONVERTION_BUFFER.setUint32(4,$x,!1),$xg._CONVERTION_BUFFER.getFloat64(0,!1)-1},$_($Z,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new $xg([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function $X($X,$g){this.origin=null,this.direction=null,this.origin=$X,this.direction=$g}return $V($X,"laya.d3.math.Ray"),$X}()),$ng=function(){function $X($X,$g){this.elements=new Float32Array(2),void 0===$X&&($X=0),void 0===$g&&($g=0);var $K=this.elements;$K[0]=$X,$K[1]=$g}$V($X,"laya.d3.math.Vector2");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.core.IClone":!0}),$g.fromArray=function($X,$g){void 0===$g&&($g=0),this.elements[0]=$X[$g+0],this.elements[1]=$X[$g+1]},$g.cloneTo=function($X){var $g=$X.elements,$K=this.elements;$g[0]=$K[0],$g[1]=$K[1]},$g.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$g,"x",function(){return this.elements[0]},function($X){this.elements[0]=$X}),$A(0,$g,"y",function(){return this.elements[1]},function($X){this.elements[1]=$X}),$X.scale=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements;$x[0]=$Z[0]*$g,$x[1]=$Z[1]*$g},$_($X,["ZERO",function(){return this.ZERO=new $X(0,0)},"ONE",function(){return this.ONE=new $X(1,1)}]),$X}(),$Wg=function(){function $c($X,$g,$K){this.elements=new Float32Array(3),void 0===$X&&($X=0),void 0===$g&&($g=0),void 0===$K&&($K=0);var $x=this.elements;$x[0]=$X,$x[1]=$g,$x[2]=$K}$V($c,"laya.d3.math.Vector3");var $X=$c.prototype;return $Q.imps($X,{"laya.d3.core.IClone":!0}),$X.fromArray=function($X,$g){void 0===$g&&($g=0),this.elements[0]=$X[$g+0],this.elements[1]=$X[$g+1],this.elements[2]=$X[$g+2]},$X.cloneTo=function($X){var $g=$X.elements,$K=this.elements;$g[0]=$K[0],$g[1]=$K[1],$g[2]=$K[2]},$X.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$X.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},$X.reset=function($X,$g,$K){this.elements[0]=$X,this.elements[1]=$g,this.elements[2]=$K},$A(0,$X,"x",function(){return this.elements[0]},function($X){this.elements[0]=$X}),$A(0,$X,"y",function(){return this.elements[1]},function($X){this.elements[1]=$X}),$A(0,$X,"z",function(){return this.elements[2]},function($X){this.elements[2]=$X}),$c.distanceSquared=function($X,$g){var $K=$X.elements,$x=$g.elements,$Z=$K[0]-$x[0],$n=$K[1]-$x[1],$W=$K[2]-$x[2];return $Z*$Z+$n*$n+$W*$W},$c.distance=function($X,$g){var $K=$X.elements,$x=$g.elements,$Z=$K[0]-$x[0],$n=$K[1]-$x[1],$W=$K[2]-$x[2];return Math.sqrt($Z*$Z+$n*$n+$W*$W)},$c.min=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements;$x[0]=Math.min($Z[0],$n[0]),$x[1]=Math.min($Z[1],$n[1]),$x[2]=Math.min($Z[2],$n[2])},$c.max=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements;$x[0]=Math.max($Z[0],$n[0]),$x[1]=Math.max($Z[1],$n[1]),$x[2]=Math.max($Z[2],$n[2])},$c.transformQuat=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements,$W=$Z[0],$v=$Z[1],$T=$Z[2],$G=$n[0],$c=$n[1],$_=$n[2],$s=$n[3],$V=$s*$W+$c*$T-$_*$v,$A=$s*$v+$_*$W-$G*$T,$a=$s*$T+$G*$v-$c*$W,$m=-$G*$W-$c*$v-$_*$T;$x[0]=$V*$s+$m*-$G+$A*-$_-$a*-$c,$x[1]=$A*$s+$m*-$c+$a*-$G-$V*-$_,$x[2]=$a*$s+$m*-$_+$V*-$c-$A*-$G},$c.scalarLength=function($X){var $g=$X.elements,$K=$g[0],$x=$g[1],$Z=$g[2];return Math.sqrt($K*$K+$x*$x+$Z*$Z)},$c.scalarLengthSquared=function($X){var $g=$X.elements,$K=$g[0],$x=$g[1],$Z=$g[2];return $K*$K+$x*$x+$Z*$Z},$c.normalize=function($X,$g){var $K=$X.elements,$x=$g.elements,$Z=$K[0],$n=$K[1],$W=$K[2],$v=$Z*$Z+$n*$n+$W*$W;0<$v&&($v=1/Math.sqrt($v),$x[0]=$K[0]*$v,$x[1]=$K[1]*$v,$x[2]=$K[2]*$v)},$c.multiply=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements;$x[0]=$Z[0]*$n[0],$x[1]=$Z[1]*$n[1],$x[2]=$Z[2]*$n[2]},$c.scale=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements;$x[0]=$Z[0]*$g,$x[1]=$Z[1]*$g,$x[2]=$Z[2]*$g},$c.lerp=function($X,$g,$K,$x){var $Z=$x.elements,$n=$X.elements,$W=$g.elements,$v=$n[0],$T=$n[1],$G=$n[2];$Z[0]=$v+$K*($W[0]-$v),$Z[1]=$T+$K*($W[1]-$T),$Z[2]=$G+$K*($W[2]-$G)},$c.transformV3ToV3=function($X,$g,$K){var $x=$c._tempVector4;$c.transformV3ToV4($X,$g,$x);var $Z=$x.elements,$n=$K.elements;$n[0]=$Z[0],$n[1]=$Z[1],$n[2]=$Z[2]},$c.transformV3ToV4=function($X,$g,$K){var $x=$X.elements,$Z=$x[0],$n=$x[1],$W=$x[2],$v=$g.elements,$T=$K.elements;$T[0]=$Z*$v[0]+$n*$v[4]+$W*$v[8]+$v[12],$T[1]=$Z*$v[1]+$n*$v[5]+$W*$v[9]+$v[13],$T[2]=$Z*$v[2]+$n*$v[6]+$W*$v[10]+$v[14],$T[3]=$Z*$v[3]+$n*$v[7]+$W*$v[11]+$v[15]},$c.TransformNormal=function($X,$g,$K){var $x=$X.elements,$Z=$x[0],$n=$x[1],$W=$x[2],$v=$g.elements,$T=$K.elements;$T[0]=$Z*$v[0]+$n*$v[4]+$W*$v[8],$T[1]=$Z*$v[1]+$n*$v[5]+$W*$v[9],$T[2]=$Z*$v[2]+$n*$v[6]+$W*$v[10]},$c.transformCoordinate=function($X,$g,$K){var $x=$c._tempVector4.elements,$Z=$X.elements,$n=$Z[0],$W=$Z[1],$v=$Z[2],$T=$g.elements;$x[0]=$n*$T[0]+$W*$T[4]+$v*$T[8]+$T[12],$x[1]=$n*$T[1]+$W*$T[5]+$v*$T[9]+$T[13],$x[2]=$n*$T[2]+$W*$T[6]+$v*$T[10]+$T[14],$x[3]=1/($n*$T[3]+$W*$T[7]+$v*$T[11]+$T[15]);var $G=$K.elements;$G[0]=$x[0]*$x[3],$G[1]=$x[1]*$x[3],$G[2]=$x[2]*$x[3]},$c.Clamp=function($X,$g,$K,$x){var $Z=$X.elements,$n=$Z[0],$W=$Z[1],$v=$Z[2],$T=$g.elements,$G=$T[0],$c=$T[1],$_=$T[2],$s=$K.elements,$V=$s[0],$A=$s[1],$a=$s[2],$m=$x.elements;$n=($n=$V<$n?$V:$n)<$G?$G:$n,$W=($W=$A<$W?$A:$W)<$c?$c:$W,$v=($v=$a<$v?$a:$v)<$_?$_:$v,$m[0]=$n,$m[1]=$W,$m[2]=$v},$c.add=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements;$x[0]=$Z[0]+$n[0],$x[1]=$Z[1]+$n[1],$x[2]=$Z[2]+$n[2]},$c.subtract=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements;$x[0]=$Z[0]-$n[0],$x[1]=$Z[1]-$n[1],$x[2]=$Z[2]-$n[2]},$c.cross=function($X,$g,$K){var $x=$X.elements,$Z=$g.elements,$n=$K.elements,$W=$x[0],$v=$x[1],$T=$x[2],$G=$Z[0],$c=$Z[1],$_=$Z[2];$n[0]=$v*$_-$T*$c,$n[1]=$T*$G-$W*$_,$n[2]=$W*$c-$v*$G},$c.dot=function($X,$g){var $K=$X.elements,$x=$g.elements;return $K[0]*$x[0]+$K[1]*$x[1]+$K[2]*$x[2]},$c.equals=function($X,$g){var $K=$X.elements,$x=$g.elements;return $HX.nearEqual(Math.abs($K[0]),Math.abs($x[0]))&&$HX.nearEqual(Math.abs($K[1]),Math.abs($x[1]))&&$HX.nearEqual(Math.abs($K[2]),Math.abs($x[2]))},$c.ZERO=new $c(0,0,0),$c.ONE=new $c(1,1,1),$c.NegativeUnitX=new $c(-1,0,0),$c.UnitX=new $c(1,0,0),$c.UnitY=new $c(0,1,0),$c.UnitZ=new $c(0,0,1),$c.ForwardRH=new $c(0,0,-1),$c.ForwardLH=new $c(0,0,1),$c.Up=new $c(0,1,0),$c.NAN=new $c(NaN,NaN,NaN),$_($c,["_tempVector4",function(){return this._tempVector4=new $vg}]),$c}(),$vg=function(){function $X($X,$g,$K,$x){this.elements=new Float32Array(4),void 0===$X&&($X=0),void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=0);var $Z=this.elements;$Z[0]=$X,$Z[1]=$g,$Z[2]=$K,$Z[3]=$x}$V($X,"laya.d3.math.Vector4");var $g=$X.prototype;return $Q.imps($g,{"laya.d3.core.IClone":!0}),$g.fromArray=function($X,$g){void 0===$g&&($g=0),this.elements[0]=$X[$g+0],this.elements[1]=$X[$g+1],this.elements[2]=$X[$g+2],this.elements[3]=$X[$g+3]},$g.cloneTo=function($X){var $g=$X.elements,$K=this.elements;$g[0]=$K[0],$g[1]=$K[1],$g[2]=$K[2],$g[3]=$K[3]},$g.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$g.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},$g.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},$A(0,$g,"x",function(){return this.elements[0]},function($X){this.elements[0]=$X}),$A(0,$g,"y",function(){return this.elements[1]},function($X){this.elements[1]=$X}),$A(0,$g,"z",function(){return this.elements[2]},function($X){this.elements[2]=$X}),$A(0,$g,"w",function(){return this.elements[3]},function($X){this.elements[3]=$X}),$X.lerp=function($X,$g,$K,$x){var $Z=$x.elements,$n=$X.elements,$W=$g.elements,$v=$n[0],$T=$n[1],$G=$n[2],$c=$n[3];$Z[0]=$v+$K*($W[0]-$v),$Z[1]=$T+$K*($W[1]-$T),$Z[2]=$G+$K*($W[2]-$G),$Z[3]=$c+$K*($W[3]-$c)},$X.transformByM4x4=function($X,$g,$K){var $x=$X.elements,$Z=$x[0],$n=$x[1],$W=$x[2],$v=$x[3],$T=$g.elements,$G=$K.elements;$G[0]=$Z*$T[0]+$n*$T[4]+$W*$T[8]+$v*$T[12],$G[1]=$Z*$T[1]+$n*$T[5]+$W*$T[9]+$v*$T[13],$G[2]=$Z*$T[2]+$n*$T[6]+$W*$T[10]+$v*$T[14],$G[3]=$Z*$T[3]+$n*$T[7]+$W*$T[11]+$v*$T[15]},$X.equals=function($X,$g){var $K=$X.elements,$x=$g.elements;return $HX.nearEqual(Math.abs($K[0]),Math.abs($x[0]))&&$HX.nearEqual(Math.abs($K[1]),Math.abs($x[1]))&&$HX.nearEqual(Math.abs($K[2]),Math.abs($x[2]))&&$HX.nearEqual(Math.abs($K[3]),Math.abs($x[3]))},$X.normalize=function($X,$g){var $K=$X.elements,$x=$g.elements,$Z=$X.length();0<$Z&&($x[0]=$K[0]*$Z,$x[1]=$K[1]*$Z,$x[2]=$K[2]*$Z,$x[3]=$K[3]*$Z)},$X.add=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements;$x[0]=$Z[0]+$n[0],$x[1]=$Z[1]+$n[1],$x[2]=$Z[2]+$n[2],$x[3]=$Z[3]+$n[3]},$X.subtract=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements;$x[0]=$Z[0]-$n[0],$x[1]=$Z[1]-$n[1],$x[2]=$Z[2]-$n[2],$x[3]=$Z[3]-$n[3]},$X.multiply=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements;$x[0]=$Z[0]*$n[0],$x[1]=$Z[1]*$n[1],$x[2]=$Z[2]*$n[2],$x[3]=$Z[3]*$n[3]},$X.scale=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements;$x[0]=$Z[0]*$g,$x[1]=$Z[1]*$g,$x[2]=$Z[2]*$g,$x[3]=$Z[3]*$g},$X.Clamp=function($X,$g,$K,$x){var $Z=$X.elements,$n=$Z[0],$W=$Z[1],$v=$Z[2],$T=$Z[3],$G=$g.elements,$c=$G[0],$_=$G[1],$s=$G[2],$V=$G[3],$A=$K.elements,$a=$A[0],$m=$A[1],$F=$A[2],$U=$A[3],$$=$x.elements;$n=($n=$a<$n?$a:$n)<$c?$c:$n,$W=($W=$m<$W?$m:$W)<$_?$_:$W,$v=($v=$F<$v?$F:$v)<$s?$s:$v,$T=($T=$U<$T?$U:$T)<$V?$V:$T,$$[0]=$n,$$[1]=$W,$$[2]=$v,$$[3]=$T},$X.distanceSquared=function($X,$g){var $K=$X.elements,$x=$g.elements,$Z=$K[0]-$x[0],$n=$K[1]-$x[1],$W=$K[2]-$x[2],$v=$K[3]-$x[3];return $Z*$Z+$n*$n+$W*$W+$v*$v},$X.distance=function($X,$g){var $K=$X.elements,$x=$g.elements,$Z=$K[0]-$x[0],$n=$K[1]-$x[1],$W=$K[2]-$x[2],$v=$K[3]-$x[3];return Math.sqrt($Z*$Z+$n*$n+$W*$W+$v*$v)},$X.dot=function($X,$g){var $K=$X.elements,$x=$g.elements;return $K[0]*$x[0]+$K[1]*$x[1]+$K[2]*$x[2]+$K[3]*$x[3]},$X.min=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements;$x[0]=Math.min($Z[0],$n[0]),$x[1]=Math.min($Z[1],$n[1]),$x[2]=Math.min($Z[2],$n[2]),$x[3]=Math.min($Z[3],$n[3])},$X.max=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g.elements;$x[0]=Math.max($Z[0],$n[0]),$x[1]=Math.max($Z[1],$n[1]),$x[2]=Math.max($Z[2],$n[2]),$x[3]=Math.max($Z[3],$n[3])},$_($X,["ZERO",function(){return this.ZERO=new $X},"ONE",function(){return this.ONE=new $X(1,1,1,1)},"UnitX",function(){return this.UnitX=new $X(1,0,0,0)},"UnitY",function(){return this.UnitY=new $X(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new $X(0,0,1,0)},"UnitW",function(){return this.UnitW=new $X(0,0,0,1)}]),$X}(),$Tg=function(){function $n($X,$g,$K,$x){this.minDepth=0,this.maxDepth=1,this.x=$X,this.y=$g,this.width=$K,this.height=$x}$V($n,"laya.d3.math.Viewport");var $X=$n.prototype;return $X.project=function($X,$g,$K){$Wg.transformV3ToV3($X,$g,$K);var $x=$X.elements,$Z=$g.elements,$n=$K.elements,$W=$x[0]*$Z[3]+$x[1]*$Z[7]+$x[2]*$Z[11]+$Z[15];1!==$W&&($n[0]=$n[0]/$W,$n[1]=$n[1]/$W,$n[2]=$n[2]/$W),$n[0]=.5*($n[0]+1)*this.width+this.x,$n[1]=.5*(1-$n[1])*this.height+this.y,$n[2]=$n[2]*(this.maxDepth-this.minDepth)+this.minDepth},$X.unprojectFromMat=function($X,$g,$K){var $x=$X.elements,$Z=$g.elements,$n=$K.elements;$n[0]=($x[0]-this.x)/this.width*2-1,$n[1]=-(($x[1]-this.y)/this.height*2-1);var $W=(this.maxDepth-this.minDepth)/2;$n[2]=($x[2]-this.minDepth-$W)/$W;var $v=$n[0]*$Z[3]+$n[1]*$Z[7]+$n[2]*$Z[11]+$Z[15];$Wg.transformV3ToV3($K,$g,$K),1!==$v&&($n[0]=$n[0]/$v,$n[1]=$n[1]/$v,$n[2]=$n[2]/$v)},$X.unprojectFromWVP=function($X,$g,$K,$x,$Z){$Xg.multiply($g,$K,$n._tempMatrix4x4),$x&&$Xg.multiply($n._tempMatrix4x4,$x,$n._tempMatrix4x4),$n._tempMatrix4x4.invert($n._tempMatrix4x4),this.unprojectFromMat($X,$n._tempMatrix4x4,$Z)},$_($n,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $Xg}]),$n}(),$Gg=function(){function $r($X){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=$X,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}$V($r,"laya.d3.resource.models.SubMesh");var $X=$r.prototype;return $Q.imps($X,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$X._getVertexBuffer=function($X){return void 0===$X&&($X=0),0===$X?this._vertexBuffer:null},$X._getIndexBuffer=function(){return this._indexBuffer},$X._getStaticBatchBakedVertexs=function($X,$g){var $K,$x,$Z=this._vertexBuffer,$n=$Z.vertexDeclaration,$W=$n.getVertexElementByUsage(0).offset/4,$v=$n.getVertexElementByUsage(3).offset/4,$T=$g.meshRender.lightmapScaleOffset,$G=0,$c=0,$_=0,$s=0,$V=0,$A=0;if($T)if($x=$n.getVertexElementByUsage(15))$_=$n.vertexStride/4,$K=0<this._vertexCount?$Z.getData().slice(this._vertexStart*$_,(this._vertexStart+this._vertexCount)*$_):$Z.getData().slice(),$s=$x.offset/4;else{$_=($A=$n.vertexStride/4)+2,$K=this._vertexCount?new Float32Array(this._vertexCount*($Z.vertexDeclaration.vertexStride/4+2)):new Float32Array($Z.vertexCount*($Z.vertexDeclaration.vertexStride/4+2)),$s=($V=$n.getVertexElementByUsage(2).offset/4)+2;var $a=$Z.getData();for($G=0,$c=$a.length/$A;$G<$c;$G++){var $m=0;$m=0<this._vertexCount?(this._vertexStart+$G)*$A:$G*$A;var $F=$G*$_,$U=0;for($U=0;$U<$s;$U++)$K[$F+$U]=$a[$m+$U];for($U=$s;$U<$A;$U++)$K[$F+$U+2]=$a[$m+$U]}}else $_=$n.vertexStride/4,$K=this._vertexCount?$Z.getData().slice(this._vertexStart*$_,(this._vertexStart+this._vertexCount)*$_):$Z.getData().slice();if($X){var $$=$X.worldMatrix,$w=$r._tempMatrix4x40;$$.invert($w);var $Q=$r._tempMatrix4x41,$f=$g.transform.worldMatrix;$Xg.multiply($w,$f,$Q)}else $Q=$g.transform.worldMatrix;var $D=$r._tempQuaternion0;for($Q.decomposeTransRotScale($r._tempVector30,$D,$r._tempVector31),$G=0,$c=$K.length/$_;$G<$c;$G++){var $B=$G*$_+$W,$i=$G*$_+$v;if($mg.transformVector3ArrayToVector3ArrayCoordinate($K,$B,$Q,$K,$B),$mg.transformVector3ArrayByQuat($K,$i,$D,$K,$i),$T){var $k=$G*$_+$s;if($x)$mg.transformLightingMapTexcoordByUV1Array($K,$k,$T,$K,$k);else{var $I=$G*$A+$V;$mg.transformLightingMapTexcoordByUV0Array($a,$I,$T,$K,$k)}}}return $K},$X._getVertexBuffers=function(){return null},$X._beforeRender=function($X){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$X._render=function($X){var $g,$K=0,$x=$X.renderElement;if(1<this._indexCount){var $Z=this._boneIndicesList.length;if(1<$Z){for(var $n=0;$n<$Z;$n++)($g=$x._skinAnimationDatas||this._skinAnimationDatas)&&($x._shaderValue.setValue(0,$g[$n]),$X._shader.uploadRenderElementUniforms($x._shaderValue.data)),$t.mainContext.drawElements(4,this._subIndexBufferCount[$n],5123,2*this._subIndexBufferStart[$n]);$B.drawCall+=$Z}else($g=$x._skinAnimationDatas||this._skinAnimationDatas)&&($x._shaderValue.setValue(0,$g[0]),$X._shader.uploadRenderElementUniforms($x._shaderValue.data)),$t.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),$B.drawCall++;$K=this._indexCount}else $K=this._indexBuffer.indexCount,($g=$x._skinAnimationDatas||this._skinAnimationDatas)&&($x._shaderValue.setValue(0,$g[0]),$X._shader.uploadRenderElementUniforms($x._shaderValue.data)),$t.mainContext.drawElements(4,$K,5123,0),$B.drawCall++;$B.trianglesFaces+=$K/3},$X.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},$X.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},$A(0,$X,"_vertexBufferCount",function(){return 1}),$A(0,$X,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$_($r,["_tempVector30",function(){return this._tempVector30=new $Wg},"_tempVector31",function(){return this._tempVector31=new $Wg},"_tempQuaternion0",function(){return this._tempQuaternion0=new $Kg},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new $Xg},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new $Xg}]),$r}(),$cg=function(){function $X($X){this.defineCounter=0,this.defines=null,$X?(this.defineCounter=$X.defineCounter,this.defines=$X.defines.slice()):(this.defineCounter=0,this.defines=[])}return $V($X,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),$X.prototype.registerDefine=function($X){var $g=Math.pow(2,this.defineCounter++);return this.defines[$g]=$X,$g},$X}(),$_g=function(){function $X(){}return $V($X,"laya.d3.shader.ShaderInit3D"),$X.__init__=function(){var $X,$g;$Bg._globalRegDefine("HIGHPRECISION",$Bg.SHADERDEFINE_HIGHPRECISION),$Bg._globalRegDefine("FOG",$Bg.SHADERDEFINE_FOG),$Bg._globalRegDefine("DIRECTIONLIGHT",$Bg.SHADERDEFINE_DIRECTIONLIGHT),$Bg._globalRegDefine("POINTLIGHT",$Bg.SHADERDEFINE_POINTLIGHT),$Bg._globalRegDefine("SPOTLIGHT",$Bg.SHADERDEFINE_SPOTLIGHT),$Bg._globalRegDefine("UV",$Bg.SHADERDEFINE_UV0),$Bg._globalRegDefine("COLOR",$Bg.SHADERDEFINE_COLOR),$Bg._globalRegDefine("UV1",$Bg.SHADERDEFINE_UV1),$Bg._globalRegDefine("CASTSHADOW",$Vg.SHADERDEFINE_CAST_SHADOW),$Bg._globalRegDefine("SHADOWMAP_PSSM1",$Vg.SHADERDEFINE_SHADOW_PSSM1),$Bg._globalRegDefine("SHADOWMAP_PSSM2",$Vg.SHADERDEFINE_SHADOW_PSSM2),$Bg._globalRegDefine("SHADOWMAP_PSSM3",$Vg.SHADERDEFINE_SHADOW_PSSM3),$Bg._globalRegDefine("SHADOWMAP_PCF_NO",$Vg.SHADERDEFINE_SHADOW_PCF_NO),$Bg._globalRegDefine("SHADOWMAP_PCF1",$Vg.SHADERDEFINE_SHADOW_PCF1),$Bg._globalRegDefine("SHADOWMAP_PCF2",$Vg.SHADERDEFINE_SHADOW_PCF2),$Bg._globalRegDefine("SHADOWMAP_PCF3",$Vg.SHADERDEFINE_SHADOW_PCF3),$Bg._globalRegDefine("DEPTHFOG",$Bg.SAHDERDEFINE_DEPTHFOG),$lg.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),$lg.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),$X={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},$g={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var $K=$lg.nameKey.add("SIMPLE");shaderCompile=$Bg.add($K,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',$X,$g),$pg.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),$pg.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),$pg.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),$pg.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),$pg.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),$pg.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),$pg.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),$pg.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),$pg.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},$X}(),$sg=function(){function $X(){this._data=null,this._data=[]}$V($X,"laya.d3.shader.ValusArray");var $g=$X.prototype;return $g.setValue=function($X,$g){this._data[$X]=$g},$A(0,$g,"data",function(){return this._data}),$X}(),$Vg=function(){function $X(){}return $X.SHADERDEFINE_RECEIVE_SHADOW=1,$X.SHADERDEFINE_CAST_SHADOW=512,$X.SHADERDEFINE_SHADOW_PSSM1=1024,$X.SHADERDEFINE_SHADOW_PSSM2=2048,$X.SHADERDEFINE_SHADOW_PSSM3=4096,$X.SHADERDEFINE_SHADOW_PCF_NO=8192,$X.SHADERDEFINE_SHADOW_PCF1=16384,$X.SHADERDEFINE_SHADOW_PCF2=32768,$X.SHADERDEFINE_SHADOW_PCF3=65536,$X.MAX_PSSM_COUNT=3,$X}(),$Ag=function(){function $d(){}return $V($d,"laya.d3.utils.Picker"),$d.calculateCursorRay=function($X,$g,$K,$x,$Z,$n){var $W=$X.elements[0],$v=$X.elements[1],$T=$d._tempVector30,$G=$T.elements;$G[0]=$W,$G[1]=$v,$G[2]=$g.minDepth;var $c=$d._tempVector31,$_=$c.elements;$_[0]=$W,$_[1]=$v,$_[2]=$g.maxDepth;var $s=$n.origin,$V=$d._tempVector32;$g.unprojectFromWVP($T,$K,$x,$Z,$s),$g.unprojectFromWVP($c,$K,$x,$Z,$V);var $A=$n.direction.elements;$A[0]=$V.x-$s.x,$A[1]=$V.y-$s.y,$A[2]=$V.z-$s.z,$Wg.normalize($n.direction,$n.direction)},$d.rayIntersectsPositionsAndIndices=function($X,$g,$K,$x,$Z){for(var $n=$K.vertexStride/4,$W=$K.getVertexElementByUsage(0).offset/4,$v=Number.MAX_VALUE,$T=-1,$G=-1,$c=-1,$_=0;$_<$x.length;$_+=3){var $s=$d._tempVector35,$V=$s.elements,$A=$x[$_]*$n,$a=$A+$W;$V[0]=$g[$a],$V[1]=$g[1+$a],$V[2]=$g[2+$a];var $m=$d._tempVector36,$F=$m.elements,$U=$x[$_+1]*$n,$$=$U+$W;$F[0]=$g[$$],$F[1]=$g[1+$$],$F[2]=$g[2+$$];var $w=$d._tempVector37,$Q=$w.elements,$f=$x[$_+2]*$n,$D=$f+$W;$Q[0]=$g[$D],$Q[1]=$g[1+$D],$Q[2]=$g[2+$D];var $B=laya.d3.utils.Picker.rayIntersectsTriangle($X,$s,$m,$w);!isNaN($B)&&$B<$v&&($v=$B,$T=$A,$G=$U,$c=$f)}if($v===Number.MAX_VALUE)return $Z.position.toDefault(),$Z.distance=Number.MAX_VALUE,$Z.trianglePositions[0].toDefault(),$Z.trianglePositions[1].toDefault(),$Z.trianglePositions[2].toDefault(),$Z.triangleNormals[0].toDefault(),$Z.triangleNormals[1].toDefault(),$Z.triangleNormals[2].toDefault(),!1;$Z.distance=$v,$Wg.scale($X.direction,$v,$Z.position),$Wg.add($X.origin,$Z.position,$Z.position);var $i=$Z.trianglePositions,$k=$i[0],$I=$i[1],$r=$i[2],$t=$k.elements,$M=$I.elements,$P=$r.elements,$N=$T+$W;$t[0]=$g[$N],$t[1]=$g[$N+1],$t[2]=$g[$N+2];var $C=$G+$W;$M[0]=$g[$C],$M[1]=$g[$C+1],$M[2]=$g[$C+2];var $Y=$c+$W;$P[0]=$g[$Y],$P[1]=$g[$Y+1],$P[2]=$g[$Y+2];var $l=$K.getVertexElementByUsage(3);if($l){var $p=$l.offset/4,$L=$Z.triangleNormals,$q=$L[0],$E=$L[1],$u=$L[2],$O=$q.elements,$e=$E.elements,$b=$u.elements,$S=$T+$p;$O[0]=$g[$S],$O[1]=$g[$S+1],$O[2]=$g[$S+2];var $R=$G+$p;$e[0]=$g[$R],$e[1]=$g[$R+1],$e[2]=$g[$R+2];var $j=$c+$p;$b[0]=$g[$j],$b[1]=$g[$j+1],$b[2]=$g[$j+2]}return!0},$d.rayIntersectsTriangle=function($X,$g,$K,$x){var $Z=$d._tempVector30,$n=$d._tempVector31;$Wg.subtract($K,$g,$Z),$Wg.subtract($x,$g,$n);var $W,$v=$d._tempVector32;if($Wg.cross($X.direction,$n,$v),($W=$Wg.dot($Z,$v))>-Number.MIN_VALUE&&$W<Number.MIN_VALUE)return Number.NaN;var $T,$G=1/$W,$c=$d._tempVector33;if($Wg.subtract($X.origin,$g,$c),$T=$Wg.dot($c,$v),($T*=$G)<0||1<$T)return Number.NaN;var $_,$s,$V=$d._tempVector34;return $Wg.cross($c,$Z,$V),$_=$Wg.dot($X.direction,$V),($_*=$G)<0||1<$T+$_?Number.NaN:($s=$Wg.dot($n,$V),($s*=$G)<0?Number.NaN:$s)},$_($d,["_tempVector30",function(){return this._tempVector30=new $Wg},"_tempVector31",function(){return this._tempVector31=new $Wg},"_tempVector32",function(){return this._tempVector32=new $Wg},"_tempVector33",function(){return this._tempVector33=new $Wg},"_tempVector34",function(){return this._tempVector34=new $Wg},"_tempVector35",function(){return this._tempVector35=new $Wg},"_tempVector36",function(){return this._tempVector36=new $Wg},"_tempVector37",function(){return this._tempVector37=new $Wg}]),$d}(),$ag=(function(){function $X(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new $Wg,new $Wg,new $Wg],this.trianglePositions.length=3,this.triangleNormals=[new $Wg,new $Wg,new $Wg],this.triangleNormals.length=3,this.position=new $Wg}$V($X,"laya.d3.utils.RaycastHit"),$X.prototype.cloneTo=function($X){$X.distance=this.distance,this.trianglePositions[0].cloneTo($X.trianglePositions[0]),this.trianglePositions[1].cloneTo($X.trianglePositions[1]),this.trianglePositions[2].cloneTo($X.trianglePositions[2]),this.triangleNormals[0].cloneTo($X.triangleNormals[0]),this.triangleNormals[1].cloneTo($X.triangleNormals[1]),this.triangleNormals[2].cloneTo($X.triangleNormals[2]),this.position.cloneTo($X.position),$X.sprite3D=this.sprite3D}}(),function(){function $X($X,$g){this._width=0,this._height=0,this._width=$X,this._height=$g}$V($X,"laya.d3.utils.Size");var $g=$X.prototype;return $A(0,$g,"width",function(){return-1===this._width?$h.clientWidth:this._width}),$A(0,$g,"height",function(){return-1===this._height?$h.clientHeight:this._height}),$A(1,$X,"fullScreen",function(){return new $X(-1,-1)}),$X}()),$mg=function(){function $N(){}return $V($N,"laya.d3.utils.Utils3D"),$N._rotationTransformScaleSkinAnimation=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$_){var $s,$V,$A,$a,$m,$F=$N._tempArray16_0,$U=$N._tempArray16_1,$$=$N._tempArray16_2,$w=$x+$x,$Q=$Z+$Z,$f=$n+$n,$D=$x*$w,$B=$Z*$w,$i=$Z*$Q,$k=$n*$w,$I=$n*$Q,$r=$n*$f,$t=$W*$w,$M=$W*$Q,$P=$W*$f;for($F[15]=1,$F[0]=1-$i-$r,$F[1]=$B+$P,$F[2]=$k-$M,$F[4]=$B-$P,$F[5]=1-$D-$r,$F[6]=$I+$t,$F[8]=$k+$M,$F[9]=$I-$t,$F[10]=1-$D-$i,$U[15]=1,$U[0]=$v,$U[5]=$T,$U[10]=$G,$s=0;$s<4;$s++)$V=$F[$s],$A=$F[$s+4],$a=$F[$s+8],$m=$F[$s+12],$$[$s]=$V,$$[$s+4]=$A,$$[$s+8]=$a,$$[$s+12]=$V*$X+$A*$g+$a*$K+$m;for($s=0;$s<4;$s++)$V=$$[$s],$A=$$[$s+4],$a=$$[$s+8],$m=$$[$s+12],$c[$s+$_]=$V*$U[0]+$A*$U[1]+$a*$U[2]+$m*$U[3],$c[$s+$_+4]=$V*$U[4]+$A*$U[5]+$a*$U[6]+$m*$U[7],$c[$s+$_+8]=$V*$U[8]+$A*$U[9]+$a*$U[10]+$m*$U[11],$c[$s+$_+12]=$V*$U[12]+$A*$U[13]+$a*$U[14]+$m*$U[15]},$N._createNodeByJson=function($X,$g,$K,$x){if(!$K)switch($g.type){case"Sprite3D":$K=new $Yg;break;case"MeshSprite3D":$K=new $dg;break;case"SkinnedMeshSprite3D":$K=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":$K=new ShuriKenParticle3D;break;case"TrailSprite3D":$K=new TrailSprite3D;break;case"Terrain":$K=new Terrain;break;case"Camera":$K=new $jg;break;case"DirectionLight":$K=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var $Z=$g.props;if($Z)for(var $n in $Z)$K[$n]=$Z[$n];var $W=$g.customProps;$W&&($K instanceof laya.d3.core.Sprite3D?($K._parseBaseCustomProps($W),$K._parseCustomProps($X,$x,$W,$g),$K._parseCustomComponent($X,$x,$g.components)):$K._parseCustomProps($X,$x,$W,$g));var $v=$g.child;if($v)for(var $T=0,$G=$v.length;$T<$G;$T++){var $c=$N._createNodeByJson($X,$v[$T],null,$x);$K.addChild($c)}return $K},$N._computeBoneAndAnimationDatasByBindPoseMatrxix=function($X,$g,$K,$x,$Z,$n){var $W,$v,$T=0,$G=0,$c=$X.length;for($W=0;$W<$c;$T+=$X[$W].keyframeWidth,$G+=16,$W++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($g[$T+0],$g[$T+1],$g[$T+2],$g[$T+3],$g[$T+4],$g[$T+5],$g[$T+6],$g[$T+7],$g[$T+8],$g[$T+9],$x,$G),0!=$W&&($v=16*$X[$W].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($x,$v,$x,$G,$x,$G));var $_=$K.length;for($W=0;$W<$_;$W++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($x,16*$n[$W],$K[$W],$Z,16*$W)},$N._computeAnimationDatasByArrayAndMatrixFast=function($X,$g,$K,$x){for(var $Z=0,$n=$X.length;$Z<$n;$Z++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($g,16*$x[$Z],$X[$Z],$K,16*$Z)},$N._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function($X,$g,$K,$x,$Z){var $n,$W,$v=0,$T=0,$G=$X.length;for($n=0;$n<$G;$v+=$X[$n].keyframeWidth,$T+=16,$n++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($g[$v+7],$g[$v+8],$g[$v+9],$g[$v+3],$g[$v+4],$g[$v+5],$g[$v+6],$g[$v+0],$g[$v+1],$g[$v+2],$x,$T),0!=$n&&($W=16*$X[$n].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($x,$W,$x,$T,$x,$T));var $c=$K.length;for($n=0;$n<$c;$n++){var $_=16*$n;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($x,$_,$K[$n],$Z,$_)}},$N._computeAnimationDatasByArrayAndMatrixFastOld=function($X,$g,$K){for(var $x=$X.length,$Z=0;$Z<$x;$Z++){var $n=16*$Z;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($g,$n,$X[$Z],$K,$n)}},$N._computeRootAnimationData=function($X,$g,$K){for(var $x=0,$Z=0,$n=0,$W=$X.length;$x<$W;$Z+=$X[$x].keyframeWidth,$n+=16,$x++)laya.d3.utils.Utils3D.createAffineTransformationArray($g[$Z+0],$g[$Z+1],$g[$Z+2],$g[$Z+3],$g[$Z+4],$g[$Z+5],$g[$Z+6],$g[$Z+7],$g[$Z+8],$g[$Z+9],$K,$n)},$N.transformVector3ArrayByQuat=function($X,$g,$K,$x,$Z){var $n=$K.elements,$W=$X[$g],$v=$X[$g+1],$T=$X[$g+2],$G=$n[0],$c=$n[1],$_=$n[2],$s=$n[3],$V=$s*$W+$c*$T-$_*$v,$A=$s*$v+$_*$W-$G*$T,$a=$s*$T+$G*$v-$c*$W,$m=-$G*$W-$c*$v-$_*$T;$x[$Z]=$V*$s+$m*-$G+$A*-$_-$a*-$c,$x[$Z+1]=$A*$s+$m*-$c+$a*-$G-$V*-$_,$x[$Z+2]=$a*$s+$m*-$_+$V*-$c-$A*-$G},$N.mulMatrixByArray=function($X,$g,$K,$x,$Z,$n){var $W,$v,$T,$G,$c;if($Z===$K){for($K=$N._tempArray16_3,$W=0;$W<16;++$W)$K[$W]=$Z[$n+$W];$x=0}for($W=0;$W<4;$W++)$v=$X[$g+$W],$T=$X[$g+$W+4],$G=$X[$g+$W+8],$c=$X[$g+$W+12],$Z[$n+$W]=$v*$K[$x+0]+$T*$K[$x+1]+$G*$K[$x+2]+$c*$K[$x+3],$Z[$n+$W+4]=$v*$K[$x+4]+$T*$K[$x+5]+$G*$K[$x+6]+$c*$K[$x+7],$Z[$n+$W+8]=$v*$K[$x+8]+$T*$K[$x+9]+$G*$K[$x+10]+$c*$K[$x+11],$Z[$n+$W+12]=$v*$K[$x+12]+$T*$K[$x+13]+$G*$K[$x+14]+$c*$K[$x+15]},$N.mulMatrixByArrayFast=function($X,$g,$K,$x,$Z,$n){var $W,$v,$T,$G,$c;for($W=0;$W<4;$W++)$v=$X[$g+$W],$T=$X[$g+$W+4],$G=$X[$g+$W+8],$c=$X[$g+$W+12],$Z[$n+$W]=$v*$K[$x+0]+$T*$K[$x+1]+$G*$K[$x+2]+$c*$K[$x+3],$Z[$n+$W+4]=$v*$K[$x+4]+$T*$K[$x+5]+$G*$K[$x+6]+$c*$K[$x+7],$Z[$n+$W+8]=$v*$K[$x+8]+$T*$K[$x+9]+$G*$K[$x+10]+$c*$K[$x+11],$Z[$n+$W+12]=$v*$K[$x+12]+$T*$K[$x+13]+$G*$K[$x+14]+$c*$K[$x+15]},$N.mulMatrixByArrayAndMatrixFast=function($X,$g,$K,$x,$Z){var $n,$W,$v,$T,$G,$c=$K.elements,$_=$c[0],$s=$c[1],$V=$c[2],$A=$c[3],$a=$c[4],$m=$c[5],$F=$c[6],$U=$c[7],$$=$c[8],$w=$c[9],$Q=$c[10],$f=$c[11],$D=$c[12],$B=$c[13],$i=$c[14],$k=$c[15],$I=$g,$r=$g+4,$t=$g+8,$M=$g+12,$P=$Z,$N=$Z+4,$C=$Z+8,$Y=$Z+12;for($n=0;$n<4;$n++)$W=$X[$I+$n],$v=$X[$r+$n],$T=$X[$t+$n],$G=$X[$M+$n],$x[$P+$n]=$W*$_+$v*$s+$T*$V+$G*$A,$x[$N+$n]=$W*$a+$v*$m+$T*$F+$G*$U,$x[$C+$n]=$W*$$+$v*$w+$T*$Q+$G*$f,$x[$Y+$n]=$W*$D+$v*$B+$T*$i+$G*$k},$N.createAffineTransformationArray=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$_){var $s=$x+$x,$V=$Z+$Z,$A=$n+$n,$a=$x*$s,$m=$x*$V,$F=$x*$A,$U=$Z*$V,$$=$Z*$A,$w=$n*$A,$Q=$W*$s,$f=$W*$V,$D=$W*$A;$c[$_+0]=(1-($U+$w))*$v,$c[$_+1]=($m+$D)*$v,$c[$_+2]=($F-$f)*$v,$c[$_+3]=0,$c[$_+4]=($m-$D)*$T,$c[$_+5]=(1-($a+$w))*$T,$c[$_+6]=($$+$Q)*$T,$c[$_+7]=0,$c[$_+8]=($F+$f)*$G,$c[$_+9]=($$-$Q)*$G,$c[$_+10]=(1-($a+$U))*$G,$c[$_+11]=0,$c[$_+12]=$X,$c[$_+13]=$g,$c[$_+14]=$K,$c[$_+15]=1},$N.transformVector3ArrayToVector3ArrayCoordinate=function($X,$g,$K,$x,$Z){var $n=$N._tempArray4_0,$W=$X[$g+0],$v=$X[$g+1],$T=$X[$g+2],$G=$K.elements;$n[0]=$W*$G[0]+$v*$G[4]+$T*$G[8]+$G[12],$n[1]=$W*$G[1]+$v*$G[5]+$T*$G[9]+$G[13],$n[2]=$W*$G[2]+$v*$G[6]+$T*$G[10]+$G[14],$n[3]=1/($W*$G[3]+$v*$G[7]+$T*$G[11]+$G[15]),$x[$Z+0]=$n[0]*$n[3],$x[$Z+1]=$n[1]*$n[3],$x[$Z+2]=$n[2]*$n[3]},$N.transformLightingMapTexcoordByUV0Array=function($X,$g,$K,$x,$Z){var $n=$K.elements;$x[$Z+0]=$X[$g+0]*$n[0]+$n[2],$x[$Z+1]=($X[$g+1]-1)*$n[1]+$n[3]},$N.transformLightingMapTexcoordByUV1Array=function($X,$g,$K,$x,$Z){var $n=$K.elements;$x[$Z+0]=$X[$g+0]*$n[0]+$n[2],$x[$Z+1]=1+$X[$g+1]*$n[1]+$n[3]},$N.getURLVerion=function($X){var $g=$X.indexOf("?");return 0<=$g?$X.substr($g):null},$N._quaternionCreateFromYawPitchRollArray=function($X,$g,$K,$x){var $Z=.5*$K,$n=.5*$g,$W=.5*$X,$v=Math.sin($Z),$T=Math.cos($Z),$G=Math.sin($n),$c=Math.cos($n),$_=Math.sin($W),$s=Math.cos($W);$x[0]=$s*$G*$T+$_*$c*$v,$x[1]=$_*$c*$T-$s*$G*$v,$x[2]=$s*$c*$v-$_*$G*$T,$x[3]=$s*$c*$T+$_*$G*$v},$N._createAffineTransformationArray=function($X,$g,$K,$x){var $Z=$g[0],$n=$g[1],$W=$g[2],$v=$g[3],$T=$Z+$Z,$G=$n+$n,$c=$W+$W,$_=$Z*$T,$s=$Z*$G,$V=$Z*$c,$A=$n*$G,$a=$n*$c,$m=$W*$c,$F=$v*$T,$U=$v*$G,$$=$v*$c,$w=$K[0],$Q=$K[1],$f=$K[2];$x[0]=(1-($A+$m))*$w,$x[1]=($s+$$)*$w,$x[2]=($V-$U)*$w,$x[3]=0,$x[4]=($s-$$)*$Q,$x[5]=(1-($_+$m))*$Q,$x[6]=($a+$F)*$Q,$x[7]=0,$x[8]=($V+$U)*$f,$x[9]=($a-$F)*$f,$x[10]=(1-($_+$A))*$f,$x[11]=0,$x[12]=$X[0],$x[13]=$X[1],$x[14]=$X[2],$x[15]=1},$N._mulMatrixArray=function($X,$g,$K,$x){var $Z,$n,$W,$v,$T,$G=$g.elements,$c=$G[0],$_=$G[1],$s=$G[2],$V=$G[3],$A=$G[4],$a=$G[5],$m=$G[6],$F=$G[7],$U=$G[8],$$=$G[9],$w=$G[10],$Q=$G[11],$f=$G[12],$D=$G[13],$B=$G[14],$i=$G[15],$k=$x,$I=$x+4,$r=$x+8,$t=$x+12;for($Z=0;$Z<4;$Z++)$n=$X[$Z],$W=$X[$Z+4],$v=$X[$Z+8],$T=$X[$Z+12],$K[$k+$Z]=$n*$c+$W*$_+$v*$s+$T*$V,$K[$I+$Z]=$n*$A+$W*$a+$v*$m+$T*$F,$K[$r+$Z]=$n*$U+$W*$$+$v*$w+$T*$Q,$K[$t+$Z]=$n*$f+$W*$D+$v*$B+$T*$i},$N.getYawPitchRoll=function($X,$g){$N.transformQuat($Wg.ForwardRH,$X,$Kg.TEMPVector31),$N.transformQuat($Wg.Up,$X,$Kg.TEMPVector32);var $K=$Kg.TEMPVector32.elements;$N.angleTo($Wg.ZERO,$Kg.TEMPVector31,$Kg.TEMPVector33);var $x=$Kg.TEMPVector33.elements;$x[0]==Math.PI/2?($x[1]=$N.arcTanAngle($K[2],$K[0]),$x[2]=0):$x[0]==-Math.PI/2?($x[1]=$N.arcTanAngle(-$K[2],-$K[0]),$x[2]=0):($Xg.createRotationY(-$x[1],$Kg.TEMPMatrix0),$Xg.createRotationX(-$x[0],$Kg.TEMPMatrix1),$Wg.transformCoordinate($Kg.TEMPVector32,$Kg.TEMPMatrix0,$Kg.TEMPVector32),$Wg.transformCoordinate($Kg.TEMPVector32,$Kg.TEMPMatrix1,$Kg.TEMPVector32),$x[2]=$N.arcTanAngle($K[1],-$K[0])),$x[1]<=-Math.PI&&($x[1]=Math.PI),$x[2]<=-Math.PI&&($x[2]=Math.PI),$x[1]>=Math.PI&&$x[2]>=Math.PI&&($x[1]=0,$x[2]=0,$x[0]=Math.PI-$x[0]),$g[0]=$x[1],$g[1]=$x[0],$g[2]=$x[2]},$N.arcTanAngle=function($X,$g){return 0==$X?1==$g?Math.PI/2:-Math.PI/2:0<$X?Math.atan($g/$X):$X<0?0<$g?Math.atan($g/$X)+Math.PI:Math.atan($g/$X)-Math.PI:0},$N.angleTo=function($X,$g,$K){$Wg.subtract($g,$X,$Kg.TEMPVector30),$Wg.normalize($Kg.TEMPVector30,$Kg.TEMPVector30),$K.elements[0]=Math.asin($Kg.TEMPVector30.y),$K.elements[1]=$N.arcTanAngle(-$Kg.TEMPVector30.z,-$Kg.TEMPVector30.x)},$N.transformQuat=function($X,$g,$K){var $x=$K.elements,$Z=$X.elements,$n=$g,$W=$Z[0],$v=$Z[1],$T=$Z[2],$G=$n[0],$c=$n[1],$_=$n[2],$s=$n[3],$V=$s*$W+$c*$T-$_*$v,$A=$s*$v+$_*$W-$G*$T,$a=$s*$T+$G*$v-$c*$W,$m=-$G*$W-$c*$v-$_*$T;$x[0]=$V*$s+$m*-$G+$A*-$_-$a*-$c,$x[1]=$A*$s+$m*-$c+$a*-$G-$V*-$_,$x[2]=$a*$s+$m*-$_+$V*-$c-$A*-$G},$N.quaterionNormalize=function($X,$g){var $K=$X[0],$x=$X[1],$Z=$X[2],$n=$X[3],$W=$K*$K+$x*$x+$Z*$Z+$n*$n;0<$W&&($W=1/Math.sqrt($W),$g[0]=$K*$W,$g[1]=$x*$W,$g[2]=$Z*$W,$g[3]=$n*$W)},$N.matrix4x4MultiplyFFF=function($X,$g,$K){var $x,$Z,$n,$W,$v;if($K===$g)for($g=new Float32Array(16),$x=0;$x<16;++$x)$g[$x]=$K[$x];for($x=0;$x<4;$x++)$Z=$X[$x],$n=$X[$x+4],$W=$X[$x+8],$v=$X[$x+12],$K[$x]=$Z*$g[0]+$n*$g[1]+$W*$g[2]+$v*$g[3],$K[$x+4]=$Z*$g[4]+$n*$g[5]+$W*$g[6]+$v*$g[7],$K[$x+8]=$Z*$g[8]+$n*$g[9]+$W*$g[10]+$v*$g[11],$K[$x+12]=$Z*$g[12]+$n*$g[13]+$W*$g[14]+$v*$g[15]},$N.matrix4x4MultiplyMFM=function($X,$g,$K){$N.matrix4x4MultiplyFFF($X.elements,$g,$K.elements)},$_($N,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new $Wg},"_tempVector3_1",function(){return this._tempVector3_1=new $Wg},"_tempVector3_2",function(){return this._tempVector3_2=new $Wg},"_tempVector3_3",function(){return this._tempVector3_3=new $Wg},"_tempVector3_4",function(){return this._tempVector3_4=new $Wg},"_tempVector3_5",function(){return this._tempVector3_5=new $Wg},"_tempVector3_6",function(){return this._tempVector3_6=new $Wg},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),$N}(),$Fg=function(){function $M(){}return $V($M,"Laya3D"),$M._cancelLoadByUrl=function($X){$Q.loader.cancelLoadByUrl($X),$M._innerFirstLevelLoaderManager.cancelLoadByUrl($X),$M._innerSecondLevelLoaderManager.cancelLoadByUrl($X),$M._innerThirdLevelLoaderManager.cancelLoadByUrl($X),$M._innerFourthLevelLoaderManager.cancelLoadByUrl($X)},$M._changeWebGLSize=function($X,$g){$t.onStageResize($X,$g),$h.clientWidth=$X,$h.clientHeight=$g},$M.__init__=function(){var $X=$g.createMap;$X.lh=[$Yg,"SPRITE3DHIERARCHY"],$X.ls=[$Cg,"SPRITE3DHIERARCHY"],$X.lm=[$Og,"MESH"],$X.lmat=[$pg,"MATERIAL"],$X.jpg=[$bg,"nativeimage"],$X.jpeg=[$bg,"nativeimage"],$X.png=[$bg,"nativeimage"],$X.pkm=[$bg,"arraybuffer"],$X.raw=[$Eg,"arraybuffer"],$X.mipmaps=[$Eg,"arraybuffer"],$F.parserMap.SPRITE3DHIERARCHY=$M._loadHierarchy,$F.parserMap.MESH=$M._loadMesh,$F.parserMap.MATERIAL=$M._loadMaterial,$F.parserMap.TEXTURECUBE=$M._loadTextureCube,$F.parserMap.TERRAIN=$M._loadTerrain,$M._innerFirstLevelLoaderManager.on("error",null,$M._eventLoadManagerError),$M._innerSecondLevelLoaderManager.on("error",null,$M._eventLoadManagerError),$M._innerThirdLevelLoaderManager.on("error",null,$M._eventLoadManagerError),$M._innerFourthLevelLoaderManager.on("error",null,$M._eventLoadManagerError)},$M.READ_BLOCK=function(){return $M._readData.pos+=4,!0},$M.READ_DATA=function(){return $M._DATA.offset=$M._readData.getUint32(),$M._DATA.size=$M._readData.getUint32(),!0},$M.READ_STRINGS=function(){var $X=[],$g={offset:0,size:0};$g.offset=$M._readData.getUint16(),$g.size=$M._readData.getUint16();$M._readData.pos;$M._readData.pos=$g.offset+$M._DATA.offset;for(var $K=0;$K<$g.size;$K++){var $x=$M._readData.readUTFString();-1===$x.lastIndexOf(".lmat")&&-1===$x.lastIndexOf(".lpbr")||$X.push($x)}return $X},$M.formatRelativePath=function($X,$g){var $K;if("."===$g.charAt(0)){for(var $x=($X+$g).split("/"),$Z=0,$n=$x.length;$Z<$n;$Z++)if(".."==$x[$Z]){var $W=$Z-1;0<$W&&".."!==$x[$W]&&($x.splice($W,2),$Z-=2)}$K=$x.join("/")}else $K=$X+$g;return null!=$r.customFormat&&($K=$r.customFormat($K,null)),$K},$M._eventLoadManagerError=function($X){$Q.loader.event("error",$X)},$M._addHierarchyInnerUrls=function($X,$g,$K,$x,$Z,$n){var $W=$M.formatRelativePath($x,$Z);$K&&($W+=$K),$X.push({url:$W,clas:$n}),$g[$Z]=$W},$M._getSprite3DHierarchyInnerUrls=function($X,$g,$K,$x,$Z,$n,$W){var $v,$T=0,$G=0;switch($X.type){case"Scene":var $c=$X.customProps.lightmaps;for($T=0,$G=$c.length;$T<$G;$T++){var $_=$c[$T].replace(".exr",".png");$M._addHierarchyInnerUrls($x,$Z,$n,$W,$_,$bg)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var $s;if($X.instanceParams)($s=$X.instanceParams.loadPath)&&$M._addHierarchyInnerUrls($g,$Z,$n,$W,$s,$Og);else{($s=($v=$X.customProps).meshPath)&&$M._addHierarchyInnerUrls($g,$Z,$n,$W,$s,$Og);var $V=$v.materials;if($V)for($T=0,$G=$V.length;$T<$G;$T++){for(var $A=$V[$T],$a=$A.type.split("."),$m=$P.window,$F=0,$U=$a.length;$F<$U;++$F){$m=$m[this.clasPaths[$F]]}if("function"!=typeof $m)throw"_getSprite3DHierarchyInnerUrls 错误: "+$A.type+" 不是类";$M._addHierarchyInnerUrls($K,$Z,$n,$W,$A.path,$m)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var $$=($v=$X.customProps).meshPath;$$&&$M._addHierarchyInnerUrls($g,$Z,$n,$W,$$,$Og);var $w=$v.material;if($w){$a=$w.type.split("."),$m=$P.window;for($F=0,$U=$a.length;$F<$U;++$F){$m=$m[this.clasPaths[$F]]}$M._addHierarchyInnerUrls($K,$Z,$n,$W,$w.path,$m)}else{var $Q=$v.materialPath;if($Q)$M._addHierarchyInnerUrls($K,$Z,$n,$W,$Q,ShurikenParticleMaterial);else{var $f=$v.texturePath;$f&&$M._addHierarchyInnerUrls($x,$Z,$n,$W,$f,$bg)}}break;case"Terrain":$M._addHierarchyInnerUrls($x,$Z,$n,$W,$X.customProps.dataPath,TerrainRes)}var $D=$X.components;for(var $B in $D){var $i=$D[$B];switch($B){case"Animator":var $k=$i.avatarPath;if($k)$M._addHierarchyInnerUrls($x,$Z,$n,$W,$k,Avatar);else{var $I=$i.avatar;$I&&$M._addHierarchyInnerUrls($x,$Z,$n,$W,$I.path,Avatar)}var $r=$i.clipPaths;for($T=0,$G=$r.length;$T<$G;$T++)$M._addHierarchyInnerUrls($x,$Z,$n,$W,$r[$T],AnimationClip)}}var $t=$X.child;for($T=0,$G=$t.length;$T<$G;$T++)$M._getSprite3DHierarchyInnerUrls($t[$T],$g,$K,$x,$Z,$n,$W)},$M._loadHierarchy=function($X){$X.on("loaded",null,$M._onHierarchylhLoaded,[$X,$X._class._getGroup()]),$X.load($X.url,"json",!1,null,!0)},$M._onHierarchylhLoaded=function($X,$g,$K){if($X._class.destroyed)$X.endLoad();else{var $x=$X.url,$Z=$mg.getURLVerion($x),$n=$r.getPath($x),$W=[],$v=[],$T=[],$G={};$M._getSprite3DHierarchyInnerUrls($K,$W,$v,$T,$G,$Z,$n);var $c=$W.length+$v.length+$T.length,$_=$c+1,$s=1/$_;if($M._onProcessChange($X,0,$s,1),0<$T.length){var $V=$c/$_,$A=$I.create(null,$M._onProcessChange,[$X,$s,$V],!1);$M._innerFourthLevelLoaderManager.create($T,$I.create(null,$M._onHierarchyInnerForthLevResouLoaded,[$X,$g,$A,$K,$G,$W,$v,$s+$V*$T.length,$V]),$A,null,null,1,!0,$g)}else $M._onHierarchyInnerForthLevResouLoaded($X,$g,null,$K,$G,$W,$v,$s,$V)}},$M._onHierarchyInnerForthLevResouLoaded=function($X,$g,$K,$x,$Z,$n,$W,$v,$T){if($X._class.destroyed)$X.endLoad();else if($K&&$K.recover(),0<$W.length){var $G=$I.create(null,$M._onProcessChange,[$X,$v,$T],!1);$M._innerSecondLevelLoaderManager.create($W,$I.create(null,$M._onHierarchyInnerSecondLevResouLoaded,[$X,$g,$G,$x,$Z,$n,$v+$T*$W.length,$T]),$K,null,null,1,!0,$g)}else $M._onHierarchyInnerSecondLevResouLoaded($X,$g,null,$x,$Z,$n,$v,$T)},$M._onHierarchyInnerSecondLevResouLoaded=function($X,$g,$K,$x,$Z,$n,$W,$v){if($X._class.destroyed)$X.endLoad();else if($K&&$K.recover(),0<$n.length){var $T=$I.create(null,$M._onProcessChange,[$X,$W,$v],!1);$M._innerFirstLevelLoaderManager.create($n,$I.create(null,$M._onHierarchyInnerFirstLevResouLoaded,[$X,$T,$x,$Z]),$K,null,null,1,!0,$g)}else $M._onHierarchyInnerFirstLevResouLoaded($X,null,$x,$Z)},$M._onHierarchyInnerFirstLevResouLoaded=function($X,$g,$K,$x){$g&&$g.recover(),$X.endLoad([$K,$x])},$M._loadTerrain=function($X){$X.on("loaded",null,$M._onTerrainLtLoaded,[$X,$X._class._getGroup()]),$X.load($X.url,"json",!1,null,!0)},$M._onTerrainLtLoaded=function($X,$g,$K){if($X._class.destroyed)$X.endLoad();else{var $x,$Z,$n=$X.url,$W=$mg.getURLVerion($n),$v=$r.getPath($n),$T=[],$G={},$c=0,$_=0,$s=$K.heightData;$x=$s.url,$Z=$M.formatRelativePath($v,$x),$W&&($Z+=$W),$x=$G[$x]=$Z;var $V=$K.detailTexture;for($c=0,$_=$V.length;$c<$_;$c++)$T.push({url:$V[$c].diffuse});var $A=$K.normalMap;for($c=0,$_=$A.length;$c<$_;$c++)$T.push({url:$A[$c]});var $a=$K.alphaMap;for($c=0,$_=$a.length;$c<$_;$c++)$T.push({url:$a[$c],params:[!1,!1,6408,!0]});for($c=0,$_=$T.length;$c<$_;$c++){var $m=$T[$c].url;$Z=$M.formatRelativePath($v,$m),$W&&($Z+=$W),$T[$c].url=$Z,$G[$m]=$Z}var $F=$T.length,$U=$F+2,$$=1/$U;$M._onProcessChange($X,0,$$,1);var $w={heightMapLoaded:!1,texturesLoaded:!1},$Q=$I.create(null,$M._onProcessChange,[$X,$$,$$],!1);$M._innerFourthLevelLoaderManager.create($x,$I.create(null,$M._onTerrainHeightMapLoaded,[$X,$Q,$K,$G,$w]),$Q,null,[$s.numX,$s.numZ,$s.bitType,$s.value],1,!0,$g);var $f=$I.create(null,$M._onProcessChange,[$X,2*$$,$F/$U],!1);$M._innerFourthLevelLoaderManager.create($T,$I.create(null,$M._onTerrainTexturesLoaded,[$X,$f,$K,$G,$w]),$f,null,null,1,!0,$g)}},$M._onTerrainHeightMapLoaded=function($X,$g,$K,$x,$Z){$Z.heightMapLoaded=!0,$Z.texturesLoaded&&($X.endLoad([$K,$x]),$g.recover())},$M._onTerrainTexturesLoaded=function($X,$g,$K,$x,$Z){$Z.texturesLoaded=!0,$Z.heightMapLoaded&&($X.endLoad([$K,$x]),$g.recover())},$M._loadMesh=function($X){$X.on("loaded",null,$M._onMeshLmLoaded,[$X,$X._class._getGroup()]),$X.load($X.url,"arraybuffer",!1,null,!0)},$M._onMeshLmLoaded=function($X,$g,$K){if($X._class.destroyed)$X.endLoad();else{var $x,$Z,$n,$W=$X.url,$v=$mg.getURLVerion($W),$T=$r.getPath($W),$G={},$c=0,$_=0;switch(($M._readData=new $f($K)).pos=0,$M._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var $s=$M._readData.getUint32();$M._readData.pos=$M._readData.pos+4,$_=$M._readData.getUint16(),$M._readData.pos=$M._readData.pos+8*$_;var $V=$M._readData.getUint32();for($_=$M._readData.getUint16(),$M._readData.pos=$s+$V,$x=[],$c=0;$c<$_;$c++){var $A=$M._readData.readUTFString();-1!==$A.lastIndexOf(".lmat")&&$x.push($A)}break;default:for($M.READ_BLOCK(),$c=0;$c<2;$c++){var $a=$M._readData.getUint16(),$m=$M._strings[$a],$F=$M["READ_"+$m];if(null==$F)throw new Error("model file err,no this function:"+$a+" "+$m);1===$c?$x=$F.call():$F.call()}}for($c=0,$n=$x.length;$c<$n;$c++){var $U=$x[$c];$Z=$M.formatRelativePath($T,$U),$v&&($Z+=$v),$x[$c]=$Z,$G[$U]=$Z}if(0<$x.length){$M._onProcessChange($X,0,.5,1);var $$=$I.create(null,$M._onProcessChange,[$X,.5,.5],!1);$M._innerSecondLevelLoaderManager.create($x,$I.create(null,$M._onMeshMateialLoaded,[$X,$$,$K,$G]),$$,null,null,1,!0,$g)}else $X.endLoad([$K,$G])}},$M._onMeshMateialLoaded=function($X,$g,$K,$x){$X.endLoad([$K,$x]),$g.recover()},$M._getMaterialTexturePath=function($X,$g,$K){var $x=$X.length-4;return $X.indexOf(".dds")!=$x&&$X.indexOf(".tga")!=$x&&$X.indexOf(".exr")!=$x&&$X.indexOf(".DDS")!=$x&&$X.indexOf(".TGA")!=$x&&$X.indexOf(".EXR")!=$x||($X=$X.substr(0,$x)+".png"),$X=$M.formatRelativePath($K,$X),$g&&($X+=$g),$X},$M._loadMaterial=function($X){$X.on("loaded",null,$M._onMaterilLmatLoaded,[$X,$X._class._getGroup()]),$X.load($X.url,"json",!1,null,!0)},$M._onMaterilLmatLoaded=function($X,$g,$K){if($X._class.destroyed)$X.endLoad();else{var $x,$Z=$X.url,$n=$mg.getURLVerion($Z),$W=$r.getPath($Z),$v=[],$T={},$G=$K.customProps,$c=$K.version;if($c)switch($c){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var $_=$K.props.textures,$s=0,$V=$_.length;$s<$V;$s++){var $A=$_[$s],$a=$A.path;if($a){var $m=$a.length-4;$a.indexOf(".exr")!=$m&&$a.indexOf(".EXR")!=$m||($a=$a.substr(0,$m)+".png"),$x=$M.formatRelativePath($W,$a),$n&&($x+=$n),$v.push({url:$x,params:$A.params}),$T[$a]=$x}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var $F=$G.diffuseTexture.texture2D;if($F&&($x=$M._getMaterialTexturePath($F,$n,$W),$v.push($x),$T[$F]=$x),$G.normalTexture){var $U=$G.normalTexture.texture2D;$U&&($x=$M._getMaterialTexturePath($U,$n,$W),$v.push($x),$T[$U]=$x)}if($G.specularTexture){var $$=$G.specularTexture.texture2D;$$&&($x=$M._getMaterialTexturePath($$,$n,$W),$v.push($x),$T[$$]=$x)}if($G.emissiveTexture){var $w=$G.emissiveTexture.texture2D;$w&&($x=$M._getMaterialTexturePath($w,$n,$W),$v.push($x),$T[$w]=$x)}if($G.ambientTexture){var $Q=$G.ambientTexture.texture2D;$Q&&($x=$M._getMaterialTexturePath($Q,$n,$W),$v.push($x),$T[$Q]=$x)}if($G.reflectTexture){var $f=$G.reflectTexture.texture2D;$f&&($x=$M._getMaterialTexturePath($f,$n,$W),$v.push($x),$T[$f]=$x)}}var $D=$v.length,$B=$D+1,$i=1/$B;if($M._onProcessChange($X,0,$i,1),0<$D){var $k=$I.create(null,$M._onProcessChange,[$X,$i,$D/$B],!1);$M._innerFourthLevelLoaderManager.create($v,$I.create(null,$M._onMateialTexturesLoaded,[$X,$k,$K,$T]),$k,$bg,null,1,!0,$g)}else $M._onMateialTexturesLoaded($X,null,$K,null)}},$M._onMateialTexturesLoaded=function($X,$g,$K,$x){$X.endLoad([$K,$x]),$g&&$g.recover()},$M._loadTextureCube=function($X){$X.on("loaded",null,$M._onTextureCubeLtcLoaded,[$X]),$X.load($X.url,"json",!1,null,!0)},$M._onTextureCubeLtcLoaded=function($X,$g){if($X._class.destroyed)$X.endLoad();else{var $K=$r.getPath($X.url),$x=[$M.formatRelativePath($K,$g.px),$M.formatRelativePath($K,$g.nx),$M.formatRelativePath($K,$g.py),$M.formatRelativePath($K,$g.ny),$M.formatRelativePath($K,$g.pz),$M.formatRelativePath($K,$g.nz)];$M._onProcessChange($X,0,1/7,1);var $Z=$I.create(null,$M._onProcessChange,[$X,1/7,6/7],!1);$M._innerFourthLevelLoaderManager.load($x,$I.create(null,$M._onTextureCubeImagesLoaded,[$X,$x,$Z]),$Z,"nativeimage")}},$M._onTextureCubeImagesLoaded=function($X,$g,$K){var $x=[];$x.length=6;for(var $Z=0;$Z<6;$Z++){var $n=$g[$Z];$x[$Z]=$F.getRes($n),$F.clearRes($n)}$X.endLoad($x),$K.recover()},$M._onProcessChange=function($X,$g,$K,$x){($x=$g+$x*$K)<1&&$X.event("progress",$x)},$M.init=function($X,$g,$K,$x,$Z,$n){if(void 0===$K&&($K=!1),void 0===$x&&($x=!1),void 0===$Z&&($Z=!0),void 0===$n&&($n=!0),$U.update3DLoop=function(){},$U.cancelLoadByUrl=function($X){$M._cancelLoadByUrl($X)},$T.isAntialias=$K,$T.isAlpha=$x,$T.premultipliedAlpha=$Z,$T.isStencil=$n,!$t.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");$U.changeWebGLSize=$M._changeWebGLSize,$a.is3DMode=!0,$Q.init($X,$g),$N.__init__(),$_g.__init__(),$dg.__init__(),$u.__init__(),$M.__init__(),$W.maxTextureCount=2,($M.debugMode||$z.debugMode)&&($M._debugPhasorSprite=new $R)},$M.HIERARCHY="SPRITE3DHIERARCHY",$M.MESH="MESH",$M.MATERIAL="MATERIAL",$M.PBRMATERIAL="PBRMTL",$M.TEXTURECUBE="TEXTURECUBE",$M.TERRAIN="TERRAIN",$M._readData=null,$M._debugPhasorSprite=null,$M.debugMode=!1,$_($M,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new $g},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new $g},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new $g},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new $g}]),$M}(),$Ug=function($X){function $Z($X){$Z.__super.call(this),this._owner=$X,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}$V($Z,"laya.d3.animation.AnimationTransform3D",$n);var $g=$Z.prototype;return $g._getlocalMatrix=function(){return this._localUpdate&&($mg._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},$g._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var $X=0,$g=this._childs.length;$X<$g;$X++)this._childs[$X]._onWorldTransform()}},$g._setWorldMatrixAndUpdate=function($X){if(this._worldMatrix=$X,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var $g=this._getlocalMatrix(),$K=0;$K<16;++$K)this._worldMatrix[$K]=$g[$K];else $mg.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},$g._setWorldMatrixNoUpdate=function($X){this._worldMatrix=$X},$g._setWorldMatrixIgnoreUpdate=function($X){this._worldMatrix=$X,this._worldUpdate=!1},$g.getLocalPosition=function(){return this._localPosition},$g.setLocalPosition=function($X){if(this._parent)this._localPosition=$X,this._localUpdate=!0,this._onWorldTransform();else{var $g=this._entity.owner._transform,$K=this._entity.localPosition,$x=$K.elements;$x[0]=$X[0],$x[1]=$X[1],$x[2]=$X[2],$g.localPosition=$K}},$g.getLocalRotation=function(){if(this._localQuaternionUpdate){var $X=this._localRotationEuler;$mg._quaternionCreateFromYawPitchRollArray($X[1]/$Z._angleToRandin,$X[0]/$Z._angleToRandin,$X[2]/$Z._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},$g.setLocalRotation=function($X){if(this._parent)this._localRotation=$X,$mg.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $g=this._entity.owner._transform,$K=this._entity.localRotation,$x=$K.elements;$x[0]=$X[0],$x[1]=$X[1],$x[2]=$X[2],$x[3]=$X[3],$g.localRotation=$K}},$g.getLocalScale=function(){return this._localScale},$g.setLocalScale=function($X){if(this._parent)this._localScale=$X,this._localUpdate=!0,this._onWorldTransform();else{var $g=this._entity.owner._transform,$K=this._entity.localScale,$x=$K.elements;$x[0]=$X[0],$x[1]=$X[1],$x[2]=$X[2],$g.localScale=$K}},$g.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){$mg.getYawPitchRoll(this._localRotation,$Z._tempVector3);var $X=$Z._tempVector3,$g=this._localRotationEuler;$g[0]=$X[1]*$Z._angleToRandin,$g[1]=$X[0]*$Z._angleToRandin,$g[2]=$X[2]*$Z._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},$g.setLocalRotationEuler=function($X){if(this._parent)$mg._quaternionCreateFromYawPitchRollArray($X[1]/$Z._angleToRandin,$X[0]/$Z._angleToRandin,$X[2]/$Z._angleToRandin,this._localRotation),this._localRotationEuler=$X,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $g=this._entity.owner._transform,$K=this._entity.localRotationEuler,$x=$K.elements;$x[0]=$X[0],$x[1]=$X[1],$x[2]=$X[2],$g.localRotationEuler=$K}},$g.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)$mg.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var $X=this._getlocalMatrix(),$g=0;$g<16;++$g)this._worldMatrix[$g]=$X[$g];this._worldUpdate=!1}return this._worldMatrix},$g.setParent=function($X){if(this._parent!==$X){if(this._parent){var $g=this._parent._childs,$K=$g.indexOf(this);$g.splice($K,1)}$X&&($X._childs.push(this),$X&&this._onWorldTransform()),this._parent=$X}},$_($Z,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$Z}(),$$g=function($X){function $g(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,$g.__super.call(this),this._destroyed=!1,this._id=$g._uniqueIDCounter,$g._uniqueIDCounter++}$V($g,"laya.d3.component.Component3D",$n);var $K=$g.prototype;return $Q.imps($K,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),$K._initialize=function($X){this._owner=$X,this._enable=!0,this.started=!1,this._load($X)},$K._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},$K._load=function($X){},$K._start=function($X){},$K._update=function($X){},$K._lateUpdate=function($X){},$K._preRenderUpdate=function($X){},$K._postRenderUpdate=function($X){},$K._unload=function($X){this.offAll()},$K._cloneTo=function($X){},$A(0,$K,"id",function(){return this._id}),$A(0,$K,"destroyed",function(){return this._destroyed}),$A(0,$K,"owner",function(){return this._owner}),$A(0,$K,"enable",function(){return this._enable},function($X){this._enable!==$X&&(this._enable=$X,this.event("enablechanged",this._enable))}),$A(0,$K,"isSingleton",function(){return $g._isSingleton}),$g._isSingleton=!0,$g._uniqueIDCounter=1,$g}(),$wg=function($X){function $g(){this._destroyed=!1,$g.__super.call(this),this._destroyed=!1}$V($g,"laya.d3.core.GeometryFilter",$n);var $K=$g.prototype;return $Q.imps($K,{"laya.resource.IDestroy":!0}),$K._destroy=function(){this.offAll(),this._destroyed=!0},$A(0,$K,"_isAsyncLoaded",function(){return!0}),$A(0,$K,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),$A(0,$K,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),$A(0,$K,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),$A(0,$K,"destroyed",function(){return this._destroyed}),$g}(),$Qg=function($X){function $x($X){$x.__super.call(this),this._id=++$x._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new $zX(new $Wg,new $Wg),this._boundingBoxCenter=new $Wg,this._boundingSphere=new $oX(new $Wg,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=$X,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}$V($x,"laya.d3.core.render.BaseRender",$n);var $g=$x.prototype;return $Q.imps($g,{"laya.resource.IDestroy":!0}),$g._changeMaterialReference=function($X,$g){$X&&$X._removeReference(),$g._addReference()},$g._getInstanceMaterial=function($X,$g){var $K=new $X.constructor;return $X.cloneTo($K),$K.name=$K.name+"(Instance)",this._materialsInstance[$g]=!0,this._changeMaterialReference(this._materials[$g],$K),this._materials[$g]=$K},$g._setShaderValuelightMap=function($X){this._setShaderValueTexture(3,$X)},$g._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},$g._renderRenderableBoundBox=function(){var $X=$Fg._debugPhasorSprite,$g=this.boundingBox,$K=$x._tempBoundBoxCorners;$g.getCorners($K),$X.line($K[0],$x._greenColor,$K[1],$x._greenColor),$X.line($K[2],$x._greenColor,$K[3],$x._greenColor),$X.line($K[4],$x._greenColor,$K[5],$x._greenColor),$X.line($K[6],$x._greenColor,$K[7],$x._greenColor),$X.line($K[0],$x._greenColor,$K[3],$x._greenColor),$X.line($K[1],$x._greenColor,$K[2],$x._greenColor),$X.line($K[2],$x._greenColor,$K[6],$x._greenColor),$X.line($K[3],$x._greenColor,$K[7],$x._greenColor),$X.line($K[0],$x._greenColor,$K[4],$x._greenColor),$X.line($K[1],$x._greenColor,$K[5],$x._greenColor),$X.line($K[4],$x._greenColor,$K[7],$x._greenColor),$X.line($K[5],$x._greenColor,$K[6],$x._greenColor)},$g._calculateBoundingSphere=function(){throw"BaseRender: must override it."},$g._calculateBoundingBox=function(){throw"BaseRender: must override it."},$g._setShaderValueTexture=function($X,$g){this._owner._shaderValues.setValue($X,$g)},$g._setShaderValueMatrix4x4=function($X,$g){this._owner._shaderValues.setValue($X,$g?$g.elements:null)},$g._setShaderValueColor=function($X,$g){this._owner._shaderValues.setValue($X,$g?$g.elements:null)},$g._setShaderValueBuffer=function($X,$g){this._owner._shaderValues.setValue($X,$g)},$g._setShaderValueInt=function($X,$g){this._owner._shaderValues.setValue($X,$g)},$g._setShaderValueBool=function($X,$g){this._owner._shaderValues.setValue($X,$g)},$g._setShaderValueNumber=function($X,$g){this._owner._shaderValues.setValue($X,$g)},$g._setShaderValueVector2=function($X,$g){this._owner._shaderValues.setValue($X,$g?$g.elements:null)},$g._addShaderDefine=function($X){this._owner._shaderDefineValue|=$X},$g._removeShaderDefine=function($X){this._owner._shaderDefineValue&=~$X},$g._renderUpdate=function($X){return!0},$g._applyLightMapParams=function(){if(0<=this._lightmapIndex){var $X=this._owner.scene;if($X){var $g=$X.getlightmaps()[this._lightmapIndex];$g?(this._addShaderDefine($Rg.SAHDERDEFINE_LIGHTMAP),$g.loaded?this._setShaderValuelightMap($g):$g.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine($Rg.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($Rg.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($Rg.SAHDERDEFINE_LIGHTMAP)},$g._updateOctreeNode=function(){var $X=this._treeNode;$X&&this._octreeNodeNeedChange&&($X.updateObject(this),this._octreeNodeNeedChange=!1)},$g._destroy=function(){this.offAll();var $X=0,$g=0;for($X=0,$g=this._renderElements.length;$X<$g;$X++)this._renderElements[$X]._destroy();for($X=0,$g=this._materials.length;$X<$g;$X++)this._materials[$X]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},$A(0,$g,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),$A(0,$g,"id",function(){return this._id}),$A(0,$g,"material",function(){var $X=this._materials[0];if($X&&!this._materialsInstance[0]){var $g=this._getInstanceMaterial($X,0);this.event("materialchanged",[this,0,$g])}return this._materials[0]},function($X){this.sharedMaterial=$X}),$A(0,$g,"sharedMaterial",function(){return this._materials[0]},function($X){var $g=this._materials[0];$g!==$X&&(this._materials[0]=$X,this._materialsInstance[0]=!1,this._changeMaterialReference($g,$X),this.event("materialchanged",[this,0,$X]))}),$A(0,$g,"lightmapIndex",function(){return this._lightmapIndex},function($X){this._lightmapIndex=$X,this._applyLightMapParams()}),$A(0,$g,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function($X){this._lightmapScaleOffset=$X,this._setShaderValueColor(2,$X),this._addShaderDefine($Rg.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),$A(0,$g,"enable",function(){return this._enable},function($X){this._enable=$X,this.event("enablechanged",[this,$X])}),$A(0,$g,"materials",function(){for(var $X=0,$g=this._materials.length;$X<$g;$X++)if(!this._materialsInstance[$X]){var $K=this._getInstanceMaterial(this._materials[$X],$X);this.event("materialchanged",[this,$X,$K])}return this._materials.slice()},function($X){this.sharedMaterials=$X}),$A(0,$g,"sharedMaterials",function(){return this._materials.slice()},function($X){if(!$X)throw new Error("MeshRender: shadredMaterials value can't be null.");var $g=$X.length;this._materialsInstance.length=$g;for(var $K=0;$K<$g;$K++){var $x=this._materials[$K];$x!==$X[$K]&&(this._materialsInstance[$K]=!1,this._changeMaterialReference($x,$X[$K]),this.event("materialchanged",[this,$K,$X[$K]]))}this._materials=$X}),$A(0,$g,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),$A(0,$g,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var $X=this.boundingBox;$Wg.add($X.min,$X.max,this._boundingBoxCenter),$Wg.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),$A(0,$g,"receiveShadow",function(){return this._receiveShadow},function($X){this._receiveShadow!==$X&&((this._receiveShadow=$X)?this._addShaderDefine($Vg.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine($Vg.SHADERDEFINE_RECEIVE_SHADOW))}),$A(0,$g,"destroyed",function(){return this._destroyed}),$x._uniqueIDCounter=0,$_($x,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new $Wg,new $Wg,new $Wg,new $Wg,new $Wg,new $Wg,new $Wg,new $Wg]},"_greenColor",function(){return this._greenColor=new $vg(0,1,0,1)}]),$x}(),$fg=function($X){function $v($X){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,$v.__super.call(this),this._localPosition=new $Wg,this._localRotation=new $Kg(0,0,0,1),this._localScale=new $Wg(1,1,1),this._localRotationEuler=new $Wg,this._localMatrix=new $Xg,this._position=new $Wg,this._rotation=new $Kg(0,0,0,1),this._scale=new $Wg(1,1,1),this._worldMatrix=new $Xg,this._forward=new $Wg,this._up=new $Wg,this._right=new $Wg,this._owner=$X,this._childs=[]}$V($v,"laya.d3.core.Transform3D",$n);var $g=$v.prototype;return $g._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)$Xg.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var $X=$v._tempVector30;$Wg.multiply(this.pivot,this._localScale,$X);var $g=$v._tempVector31;$Wg.subtract($X,this.pivot,$g);var $K=$v._tempVector32,$x=this.localRotation;$Wg.transformQuat($X,$x,$K),$Wg.subtract($K,$X,$K);var $Z=$v._tempVector33;$Wg.subtract(this._localPosition,$g,$Z),$Wg.subtract($Z,$K,$Z),$Xg.createAffineTransformation($Z,$x,this._localScale,this._localMatrix)}},$g._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $X=0,$g=this._childs.length;$X<$g;$X++)this._childs[$X]._onWorldPositionRotationTransform()}},$g._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $X=0,$g=this._childs.length;$X<$g;$X++)this._childs[$X]._onWorldPositionScaleTransform()}},$g._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var $X=0,$g=this._childs.length;$X<$g;$X++)this._childs[$X]._onWorldPositionTransform()}},$g._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $X=0,$g=this._childs.length;$X<$g;$X++)this._childs[$X]._onWorldPositionRotationTransform()}},$g._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $X=0,$g=this._childs.length;$X<$g;$X++)this._childs[$X]._onWorldPositionScaleTransform()}},$g._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $X=0,$g=this._childs.length;$X<$g;$X++)this._childs[$X]._onWorldTransform()}},$g.translate=function($X,$g){void 0===$g&&($g=!0),$g?($Xg.createFromQuaternion(this.localRotation,$v._tempMatrix0),$Wg.transformCoordinate($X,$v._tempMatrix0,$v._tempVector30),$Wg.add(this.localPosition,$v._tempVector30,this._localPosition),this.localPosition=this._localPosition):($Wg.add(this.position,$X,this._position),this.position=this._position)},$g.rotate=function($X,$g,$K){var $x;void 0===$g&&($g=!0),void 0===$K&&($K=!0),$x=$K?$X:($Wg.scale($X,Math.PI/180,$v._tempVector30),$v._tempVector30),$Kg.createFromYawPitchRoll($x.y,$x.x,$x.z,$v._tempQuaternion0),$g?($Kg.multiply(this._localRotation,$v._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):($Kg.multiply($v._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},$g.lookAt=function($X,$g,$K){void 0===$K&&($K=!1);var $x,$Z=$X.elements;if($K){if($x=this._localPosition.elements,Math.abs($x[0]-$Z[0])<$HX.zeroTolerance&&Math.abs($x[1]-$Z[1])<$HX.zeroTolerance&&Math.abs($x[2]-$Z[2])<$HX.zeroTolerance)return;$Kg.lookAt(this._localPosition,$X,$g,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var $n=this.position;if($x=$n.elements,Math.abs($x[0]-$Z[0])<$HX.zeroTolerance&&Math.abs($x[1]-$Z[1])<$HX.zeroTolerance&&Math.abs($x[2]-$Z[2])<$HX.zeroTolerance)return;$Kg.lookAt($n,$X,$g,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},$A(0,$g,"_isFrontFaceInvert",function(){var $X=this.scale,$g=$X.x<0;return $X.y<0&&($g=!$g),$X.z<0&&($g=!$g),$g}),$A(0,$g,"owner",function(){return this._owner}),$A(0,$g,"localRotation",function(){if(this._localQuaternionUpdate){var $X=this._localRotationEuler.elements;$Kg.createFromYawPitchRoll($X[1]/$v._angleToRandin,$X[0]/$v._angleToRandin,$X[2]/$v._angleToRandin,this._localRotation)}return this._localRotation},function($X){this._localRotation=$X,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$A(0,$g,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?$Xg.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function($X){null===this._parent?$X.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),$Xg.multiply(this._localMatrix,$X,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=$X,this._worldUpdate=!1}),$A(0,$g,"worldNeedUpdate",function(){return this._worldUpdate}),$A(0,$g,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function($X){this._localMatrix=$X,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),$A(0,$g,"dummy",function(){return this._dummy},function($X){this._dummy!==$X&&(this._dummy&&(this._dummy._entity=null),$X&&($X._entity=this),this._dummy=$X)}),$A(0,$g,"localPosition",function(){return this._localPosition},function($X){this._localPosition=$X,this._localUpdate=!0,this._onWorldPositionTransform()}),$A(0,$g,"position",function(){if(this._positionUpdate){if(null!=this._parent){var $X=this._parent.position;$Wg.multiply(this._localPosition,this._parent.scale,$v._tempVector30),$Wg.transformQuat($v._tempVector30,this._parent.rotation,$v._tempVector30),$Wg.add($X,$v._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function($X){if(null!=this._parent){$Wg.subtract($X,this._parent.position,this._localPosition);var $g=this._parent.scale.elements,$K=$g[0],$x=$g[1],$Z=$g[2];if(1!==$K||1!==$x||1!==$Z){var $n=$v._tempVector30,$W=$n.elements;$W[0]=1/$K,$W[1]=1/$x,$W[2]=1/$Z,$Wg.multiply(this._localPosition,$n,this._localPosition)}this._parent.rotation.invert($v._tempQuaternion0),$Wg.transformQuat(this._localPosition,$v._tempQuaternion0,this._localPosition)}else $X.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=$X,this._positionUpdate=!1}),$A(0,$g,"localScale",function(){return this._localScale},function($X){this._localScale=$X,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),$A(0,$g,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll($v._tempVector30);var $X=$v._tempVector30.elements,$g=this._localRotationEuler.elements;$g[0]=$X[1]*$v._angleToRandin,$g[1]=$X[0]*$v._angleToRandin,$g[2]=$X[2]*$v._angleToRandin}return this._localRotationEuler},function($X){this._localRotationEuler=$X,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$A(0,$g,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?$Kg.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function($X){null!=this._parent?(this._parent.rotation.invert($v._tempQuaternion0),$Kg.multiply($X,$v._tempQuaternion0,this._localRotation)):$X.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=$X,this._rotationUpdate=!1}),$A(0,$g,"scale",function(){return this._scaleUpdate&&(null!==this._parent?$Wg.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function($X){if(null!==this._parent){var $g=this._parent.scale.elements,$K=$v._tempVector30.elements;$K[0]=1/$g[0],$K[1]=1/$g[1],$K[2]=1/$g[2],$Wg.multiply($X,$v._tempVector30,this._localScale)}else $X.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=$X,this._scaleUpdate=!1}),$A(0,$g,"rotationEuler",null,function($X){$Kg.createFromYawPitchRoll($X.y,$X.x,$X.z,this._rotation),this.rotation=this._rotation}),$A(0,$g,"forward",function(){var $X=this.worldMatrix.elements;return this._forward.elements[0]=-$X[8],this._forward.elements[1]=-$X[9],this._forward.elements[2]=-$X[10],this._forward}),$A(0,$g,"up",function(){var $X=this.worldMatrix.elements;return this._up.elements[0]=$X[4],this._up.elements[1]=$X[5],this._up.elements[2]=$X[6],this._up}),$A(0,$g,"right",function(){var $X=this.worldMatrix.elements;return this._right.elements[0]=$X[0],this._right.elements[1]=$X[1],this._right.elements[2]=$X[2],this._right}),$A(0,$g,"parent",function(){return this._parent},function($X){if(this._parent!==$X){if(this._parent){var $g=this._parent._childs,$K=$g.indexOf(this);$g.splice($K,1)}$X&&($X._childs.push(this),$X&&this._onWorldTransform()),this._parent=$X}}),$_($v,["_tempVector30",function(){return this._tempVector30=new $Wg},"_tempVector31",function(){return this._tempVector31=new $Wg},"_tempVector32",function(){return this._tempVector32=new $Wg},"_tempVector33",function(){return this._tempVector33=new $Wg},"_tempQuaternion0",function(){return this._tempQuaternion0=new $Kg},"_tempMatrix0",function(){return this._tempMatrix0=new $Xg},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$v}(),$Dg=(function($X){function $g(){this._rotation=0,this._matNeedUpdte=!1,$g.__super.call(this),this._matrix=new $Xg,this._offset=new $ng,this._tiling=new $ng(1,1)}$V($g,"laya.d3.core.TransformUV",$n);var $K=$g.prototype;$Q.imps($K,{"laya.d3.core.IClone":!0}),$K._updateMatrix=function(){$g._tempOffsetV3.elements[0]=this._offset.x,$g._tempOffsetV3.elements[1]=this._offset.y,$Kg.createFromYawPitchRoll(0,0,this._rotation,$g._tempRotationQua),$g._tempTitlingV3.elements[0]=this._tiling.x,$g._tempTitlingV3.elements[1]=this._tiling.y,$Xg.createAffineTransformation($g._tempOffsetV3,$g._tempRotationQua,$g._tempTitlingV3,this._matrix)},$K.cloneTo=function($X){$X._matrix=this._matrix.clone(),$X._offset=this._offset.clone(),$X._rotation=this._rotation,$X._tiling=this._tiling.clone()},$K.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$K,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),$A(0,$K,"tiling",function(){return this._tiling},function($X){this._tiling=$X,this._matNeedUpdte=!0}),$A(0,$K,"offset",function(){return this._offset},function($X){this._offset=$X,this._matNeedUpdte=!0}),$A(0,$K,"rotation",function(){return this._rotation},function($X){this._rotation=$X,this._matNeedUpdte=!0}),$_($g,["_tempOffsetV3",function(){return this._tempOffsetV3=new $Wg(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new $Kg},"_tempTitlingV3",function(){return this._tempTitlingV3=new $Wg(1,1,1)}])}(),function($K){function $X(){this.x=NaN,this.y=NaN,this.z=NaN,$X.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}$V($X,"laya.d3.core.particleShuriKen.module.shape.BoxShape",$K);var $g=$X.prototype;$g._getShapeBoundBox=function($X){var $g=$X.min.elements;$g[0]=.5*-this.x,$g[1]=.5*-this.y,$g[2]=.5*-this.z;var $K=$X.max.elements;$K[0]=.5*this.x,$K[1]=.5*this.y,$K[2]=.5*this.z},$g._getSpeedBoundBox=function($X){var $g=$X.min.elements;$g[0]=0,$g[1]=0,$g[2]=0;var $K=$X.max.elements;$K[0]=0,$K[1]=1,$K[2]=0},$g.generatePositionAndDirection=function($X,$g,$K,$x){var $Z=$X.elements,$n=$g.elements;$K?($K.seed=$x[16],$b._randomPointInsideHalfUnitBox($X,$K),$x[16]=$K.seed):$b._randomPointInsideHalfUnitBox($X),$Z[0]=this.x*$Z[0],$Z[1]=this.y*$Z[1],$Z[2]=this.z*$Z[2],this.randomDirection?$K?($K.seed=$x[17],$b._randomPointUnitSphere($g,$K),$x[17]=$K.seed):$b._randomPointUnitSphere($g):($n[0]=0,$n[1]=0,$n[2]=1)},$g.cloneTo=function($X){$K.prototype.cloneTo.call(this,$X);var $g=$X;$g.x=this.x,$g.y=this.y,$g.z=this.z,$g.randomDirection=this.randomDirection}}($q),function($K){function $W(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,$W.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}$V($W,"laya.d3.core.particleShuriKen.module.shape.CircleShape",$K);var $X=$W.prototype;$X._getShapeBoundBox=function($X){var $g=$X.min.elements;$g[0]=$g[2]=-this.radius,$g[1]=0;var $K=$X.max.elements;$K[0]=$K[2]=this.radius,$K[1]=0},$X._getSpeedBoundBox=function($X){var $g=$X.min.elements;$g[0]=$g[1]=-1,$g[2]=0;var $K=$X.max.elements;$K[0]=$K[1]=1,$K[2]=0},$X.generatePositionAndDirection=function($X,$g,$K,$x){var $Z=$X.elements,$n=$W._tempPositionPoint.elements;$K?($K.seed=$x[16],this.emitFromEdge?$b._randomPointUnitArcCircle(this.arc,$W._tempPositionPoint,$K):$b._randomPointInsideUnitArcCircle(this.arc,$W._tempPositionPoint,$K),$x[16]=$K.seed):this.emitFromEdge?$b._randomPointUnitArcCircle(this.arc,$W._tempPositionPoint):$b._randomPointInsideUnitArcCircle(this.arc,$W._tempPositionPoint),$Z[0]=-$n[0],$Z[1]=$n[1],$Z[2]=0,$Wg.scale($X,this.radius,$X),this.randomDirection?$K?($K.seed=$x[17],$b._randomPointUnitSphere($g,$K),$x[17]=$K.seed):$b._randomPointUnitSphere($g):$X.cloneTo($g)},$X.cloneTo=function($X){$K.prototype.cloneTo.call(this,$X);var $g=$X;$g.radius=this.radius,$g.arc=this.arc,$g.emitFromEdge=this.emitFromEdge,$g.randomDirection=this.randomDirection},$_($W,["_tempPositionPoint",function(){return this._tempPositionPoint=new $ng}])}($q),function($K){function $s(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,$s.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}$V($s,"laya.d3.core.particleShuriKen.module.shape.ConeShape",$K);var $X=$s.prototype;$X._getShapeBoundBox=function($X){var $g=this.radius+this.length*Math.sin(this.angle),$K=this.length*Math.cos(this.angle),$x=$X.min.elements;$x[0]=$x[1]=-$g,$x[2]=0;var $Z=$X.max.elements;$Z[0]=$Z[1]=$g,$Z[2]=$K},$X._getSpeedBoundBox=function($X){var $g=Math.sin(this.angle),$K=$X.min.elements;$K[0]=$K[1]=-$g,$K[2]=0;var $x=$X.max.elements;$x[0]=$K[1]=$g,$x[2]=1},$X.generatePositionAndDirection=function($X,$g,$K,$x){var $Z,$n=$X.elements,$W=$g.elements,$v=$s._tempPositionPoint.elements,$T=NaN,$G=NaN,$c=Math.cos(this.angle),$_=Math.sin(this.angle);switch(this.emitType){case 0:$K?($K.seed=$x[16],$b._randomPointInsideUnitCircle($s._tempPositionPoint,$K),$x[16]=$K.seed):$b._randomPointInsideUnitCircle($s._tempPositionPoint),$T=$v[0],$G=$v[1],$n[0]=$T*this.radius,$n[1]=$G*this.radius,$n[2]=0,this.randomDirection?($K?($K.seed=$x[17],$b._randomPointInsideUnitCircle($s._tempDirectionPoint,$K),$x[17]=$K.seed):$b._randomPointInsideUnitCircle($s._tempDirectionPoint),$Z=$s._tempDirectionPoint.elements,$W[0]=$Z[0]*$_,$W[1]=$Z[1]*$_):($W[0]=$T*$_,$W[1]=$G*$_),$W[2]=$c;break;case 1:$K?($K.seed=$x[16],$b._randomPointUnitCircle($s._tempPositionPoint,$K),$x[16]=$K.seed):$b._randomPointUnitCircle($s._tempPositionPoint),$T=$v[0],$G=$v[1],$n[0]=$T*this.radius,$n[1]=$G*this.radius,$n[2]=0,this.randomDirection?($K?($K.seed=$x[17],$b._randomPointInsideUnitCircle($s._tempDirectionPoint,$K),$x[17]=$K.seed):$b._randomPointInsideUnitCircle($s._tempDirectionPoint),$Z=$s._tempDirectionPoint.elements,$W[0]=$Z[0]*$_,$W[1]=$Z[1]*$_):($W[0]=$T*$_,$W[1]=$G*$_),$W[2]=$c;break;case 2:$K?($K.seed=$x[16],$b._randomPointInsideUnitCircle($s._tempPositionPoint,$K)):$b._randomPointInsideUnitCircle($s._tempPositionPoint),$T=$v[0],$G=$v[1],$n[0]=$T*this.radius,$n[1]=$G*this.radius,$W[$n[2]=0]=$T*$_,$W[1]=$G*$_,$W[2]=$c,$Wg.normalize($g,$g),$K?($Wg.scale($g,this.length*$K.getFloat(),$g),$x[16]=$K.seed):$Wg.scale($g,this.length*Math.random(),$g),$Wg.add($X,$g,$X),this.randomDirection&&($K?($K.seed=$x[17],$b._randomPointUnitSphere($g,$K),$x[17]=$K.seed):$b._randomPointUnitSphere($g));break;case 3:$K?($K.seed=$x[16],$b._randomPointUnitCircle($s._tempPositionPoint,$K)):$b._randomPointUnitCircle($s._tempPositionPoint),$T=$v[0],$G=$v[1],$n[0]=$T*this.radius,$n[1]=$G*this.radius,$W[$n[2]=0]=$T*$_,$W[1]=$G*$_,$W[2]=$c,$Wg.normalize($g,$g),$K?($Wg.scale($g,this.length*$K.getFloat(),$g),$x[16]=$K.seed):$Wg.scale($g,this.length*Math.random(),$g),$Wg.add($X,$g,$X),this.randomDirection&&($K?($K.seed=$x[17],$b._randomPointUnitSphere($g,$K),$x[17]=$K.seed):$b._randomPointUnitSphere($g));break;default:throw new Error("ConeShape:emitType is invalid.")}},$X.cloneTo=function($X){$K.prototype.cloneTo.call(this,$X);var $g=$X;$g.angle=this.angle,$g.radius=this.radius,$g.length=this.length,$g.emitType=this.emitType,$g.randomDirection=this.randomDirection},$_($s,["_tempPositionPoint",function(){return this._tempPositionPoint=new $ng},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new $ng}])}($q),function($K){function $X(){this.radius=NaN,this.emitFromShell=!1,$X.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$V($X,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",$K);var $g=$X.prototype;$g._getShapeBoundBox=function($X){var $g=$X.min.elements;$g[0]=$g[1]=$g[2]=-this.radius;var $K=$X.max.elements;$K[0]=$K[1]=this.radius,$K[2]=0},$g._getSpeedBoundBox=function($X){var $g=$X.min.elements;$g[0]=$g[1]=-1,$g[2]=0;var $K=$X.max.elements;$K[0]=$K[1]=$K[2]=1},$g.generatePositionAndDirection=function($X,$g,$K,$x){var $Z=$X.elements;$K?($K.seed=$x[16],this.emitFromShell?$b._randomPointUnitSphere($X,$K):$b._randomPointInsideUnitSphere($X,$K),$x[16]=$K.seed):this.emitFromShell?$b._randomPointUnitSphere($X):$b._randomPointInsideUnitSphere($X),$Wg.scale($X,this.radius,$X);var $n=$Z[2];$n<0&&($Z[2]=-1*$n),this.randomDirection?$K?($K.seed=$x[17],$b._randomPointUnitSphere($g,$K),$x[17]=$K.seed):$b._randomPointUnitSphere($g):$X.cloneTo($g)},$g.cloneTo=function($X){$K.prototype.cloneTo.call(this,$X);var $g=$X;$g.radius=this.radius,$g.emitFromShell=this.emitFromShell,$g.randomDirection=this.randomDirection}}($q),function($K){function $X(){this.radius=NaN,this.emitFromShell=!1,$X.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$V($X,"laya.d3.core.particleShuriKen.module.shape.SphereShape",$K);var $g=$X.prototype;$g._getShapeBoundBox=function($X){var $g=$X.min.elements;$g[0]=$g[1]=$g[2]=-this.radius;var $K=$X.max.elements;$K[0]=$K[1]=$K[2]=this.radius},$g._getSpeedBoundBox=function($X){var $g=$X.min.elements;$g[0]=$g[1]=$g[2]=-1;var $K=$X.max.elements;$K[0]=$K[1]=$K[2]=1},$g.generatePositionAndDirection=function($X,$g,$K,$x){$K?($K.seed=$x[16],this.emitFromShell?$b._randomPointUnitSphere($X,$K):$b._randomPointInsideUnitSphere($X,$K),$x[16]=$K.seed):this.emitFromShell?$b._randomPointUnitSphere($X):$b._randomPointInsideUnitSphere($X),$Wg.scale($X,this.radius,$X),this.randomDirection?$K?($K.seed=$x[17],$b._randomPointUnitSphere($g,$K),$x[17]=$K.seed):$b._randomPointUnitSphere($g):$X.cloneTo($g)},$g.cloneTo=function($X){$K.prototype.cloneTo.call(this,$X);var $g=$X;$g.radius=this.radius,$g.emitFromShell=this.emitFromShell,$g.randomDirection=this.randomDirection}}($q),function($X){function $g(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,$g.__super.call(this)}return $V($g,"laya.d3.core.render.SubMeshRenderElement",$j),$g}()),$Bg=function($X){function $m($X,$g,$K,$x,$Z,$n){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=$X,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[$Vg.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[$Rg.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[$Rg.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[$rg.SHADERDEFINE_ALPHATEST]="ALPHATEST";$m.__super.call(this,$X,$g,$K,null,{}),this._attributeMap=$x;var $W;for($W in $Z){var $v=$Z[$W];switch($v[1]){case 0:this._renderElementUniformMap[$W]=$v[0];break;case 1:this._materialUniformMap[$W]=$v[0];break;case 2:this._spriteUniformMap[$W]=$v[0];break;case 3:this._cameraUniformMap[$W]=$v[0];break;case 4:this._sceneUniformMap[$W]=$v[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}$V($m,"laya.d3.shader.ShaderCompile3D",$$);var $g=$m.prototype;return $g._definesToNameDic=function($X,$g){for(var $K={},$x=1,$Z=0;$Z<32&&!($X<($x=1<<$Z));$Z++)if($X&$x){var $n=$g[$x];$n&&($K[$n]="")}return $K},$g.withCompile=function($X,$g,$K,$x){var $Z,$n,$W;if($n=this.sharders[$X])if($W=$n[$g]){if($Z=$W[$K])return $Z}else $W=$n[$g]=[];else $W=($n=this.sharders[$X]=[])[$g]=[];var $v,$T=this._definesToNameDic($X,$m._globalInt2name),$G=this._definesToNameDic($g,this._spriteInt2name),$c=this._definesToNameDic($K,this._materialInt2name),$_={},$s="";if($T)for($v in $T)$s+="#define "+$v+"\n",$_[$v]=!0;if($G)for($v in $G)$s+="#define "+$v+"\n",$_[$v]=!0;if($c)for($v in $c)$s+="#define "+$v+"\n",$_[$v]=!0;var $V=$lg.nameKey.getName(this._name)+" compile ("+$X+","+$g+","+$K+")",$A=this._VS.toscript($_,[]),$a=this._PS.toscript($_,[]);$P.now();if($Z=$lg.create($s+$A.join("\n"),$s+$a.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,$x,$V),$W[$K]=$Z,laya.d3.shader.ShaderCompile3D.debugMode)$P.now();return $Z},$g.precompileShaderWithShaderDefine=function($X,$g,$K){this.withCompile($X,$g,$K,!0)},$g.addMaterialDefines=function($X){var $g=$X.defines;for(var $K in $g){var $x=$g[$K],$Z=parseInt($K);this._materialInt2name[$Z]=$x,this._materialName2Int[$x]=$Z}},$g.addSpriteDefines=function($X){var $g=$X.defines;for(var $K in $g){var $x=$g[$K],$Z=parseInt($K);this._spriteInt2name[$Z]=$x,this._spriteName2Int[$x]=$Z}},$g.getMaterialDefineByName=function($X){return this._materialName2Int[$X]},$g.registerMaterialDefine=function($X){var $g=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[$g]=$X,this._materialName2Int[$X]=$g},$g.registerSpriteDefine=function($X){var $g=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[$g]=$X,this._spriteName2Int[$X]=$g},$m._globalRegDefine=function($X,$g){$m._globalInt2name[$g]=$X},$m.add=function($X,$g,$K,$x,$Z){return laya.d3.shader.ShaderCompile3D._preCompileShader[$X]=new $m($X,$g,$K,$x,$Z,$$.includes)},$m.get=function($X){return laya.d3.shader.ShaderCompile3D._preCompileShader[$lg.nameKey.getID($X)]},$m._preCompileShader={},$m._globalInt2name=[],$m.debugMode=!1,$m.SHADERDEFINE_HIGHPRECISION=1,$m.SHADERDEFINE_FOG=4,$m.SHADERDEFINE_DIRECTIONLIGHT=8,$m.SHADERDEFINE_POINTLIGHT=16,$m.SHADERDEFINE_SPOTLIGHT=32,$m.SHADERDEFINE_UV0=64,$m.SHADERDEFINE_COLOR=128,$m.SHADERDEFINE_UV1=256,$m.SAHDERDEFINE_DEPTHFOG=131072,$m}(),$ig=function($X){function $A(){$A.__super.call(this)}$V($A,"laya.d3.graphics.MeshSprite3DStaticBatchManager",$xX);var $g=$A.prototype;return $g._getStaticBatch=function($X,$g,$K,$x){var $Z,$n;return $n=$X?$X.id.toString()+$K.id.toString()+$g.id.toString()+$x.toString():$K.id.toString()+$g.id.toString()+$x.toString(),this._staticBatches[$n]?$Z=this._staticBatches[$n]:this._staticBatches[$n]=$Z=new $kg($n,this,$X,$g,$K),$Z},$g._initStaticBatchs=function($X){var $g,$K;this._initBatchRenderElements.sort($A._sortPrepareStaticBatch);for(var $x,$Z=!1,$n=0,$W=0,$v=this._initBatchRenderElements.length;$W<$v;$W++){var $T,$G=this._initBatchRenderElements[$W],$c=$G.renderObj._getVertexBuffer(0);$G._sprite3D;if($K===$c.vertexDeclaration&&$g===$G._material)if($Z)$x._addCombineBatchRenderObjTest($G)?($T=$G._staticBatch)!==$x&&($T&&$T._deleteCombineBatchRenderObj($G),$x._addCombineBatchRenderObj($G)):($Z=!1,$n++);else{var $_=this._initBatchRenderElements[$W-1],$s=$_.renderObj,$V=$G.renderObj;$Z=!(65535<$s._getVertexBuffer().vertexCount+$V._getVertexBuffer().vertexCount)&&($x=this._getStaticBatch($X,$K,$g,$n),($T=$_._staticBatch)!==$x&&($T&&$T._deleteCombineBatchRenderObj($_),$x._addCombineBatchRenderObj($_)),($T=$G._staticBatch)!==$x&&($T&&$T._deleteCombineBatchRenderObj($G),$x._addCombineBatchRenderObj($G)),!0)}else $Z=!1,$n=0;$g=$G._material,$K=$c.vertexDeclaration}},$A._sortPrepareStaticBatch=function($X,$g){var $K=$X._render,$x=$g._render,$Z=$K.lightmapIndex-$x.lightmapIndex;if(0!=$Z)return $Z;var $n=$K.receiveShadow-$x.receiveShadow;if(0!=$n)return $n;var $W=$X._mainSortID-$g._mainSortID;return 0==$W?$X.renderObj.triangleCount-$g.renderObj.triangleCount:$W},$A}(),$kg=function($X){function $n($X,$g,$K,$x,$Z){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,$n.__super.call(this,$X,$g,$K),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=$x,this._material=$Z}$V($n,"laya.d3.graphics.SubMeshStaticBatch",$ZX);var $g=$n.prototype;return $g._compareBatchRenderElement=function($X,$g){return $X._batchIndexStart>$g._batchIndexStart},$g._addCombineBatchRenderObjTest=function($X){var $g=$X.renderObj._vertexCount;return!(65535<(0<$g?this._currentCombineVertexCount+$g:this._currentCombineVertexCount+$X.renderObj._getVertexBuffer().vertexCount))},$g._addCombineBatchRenderObj=function($X){var $g=$X.renderObj,$K=$g._vertexCount;this._initBatchRenderElements.push($X),$X._staticBatch=this,0<$K?(this._currentCombineIndexCount+=$g._indexCount,this._currentCombineVertexCount+=$K):(this._currentCombineIndexCount=this._currentCombineIndexCount+$g._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$g._getVertexBuffer().vertexCount),this._needFinishCombine=!0},$g._deleteCombineBatchRenderObj=function($X){var $g=$X.renderObj,$K=this._initBatchRenderElements.indexOf($X);if(-1!==$K){this._initBatchRenderElements.splice($K,1),$X._staticBatch=null;var $x=$g._vertexCount;0<$x?(this._currentCombineIndexCount=this._currentCombineIndexCount-$g._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$x):(this._currentCombineIndexCount=this._currentCombineIndexCount-$g._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$g._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},$g._finishInit=function(){if(this._needFinishCombine){var $X=0,$g=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var $K=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),$x=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=$qg.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=$Lg.create("ushort",this._currentCombineIndexCount,35044);for(var $Z=0,$n=this._initBatchRenderElements.length;$Z<$n;$Z++){var $W=this._initBatchRenderElements[$Z],$v=$W.renderObj,$T=$v._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,$W._sprite3D),$G=$v.getIndices(),$c=$W._sprite3D.transform._isFrontFaceInvert,$_=$X/(this._vertexDeclaration.vertexStride/4)-$v._vertexStart,$s=$g,$V=$s+$G.length;$W._batchIndexStart=$s,$W._batchIndexEnd=$V,$x.set($G,$g);var $A=0;if($c)for($A=$s;$A<$V;$A+=3){$x[$A]=$_+$x[$A];var $a=$x[$A+1],$m=$x[$A+2];$x[$A+1]=$_+$m,$x[$A+2]=$_+$a}else for($A=$s;$A<$V;$A+=3)$x[$A]=$_+$x[$A],$x[$A+1]=$_+$x[$A+1],$x[$A+2]=$_+$x[$A+2];$g+=$G.length,$K.set($T,$X),$X+=$T.length}this._vertexBuffer.setData($K),this._indexBuffer.setData($x),this._needFinishCombine=!1}},$g._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new $Dg)},$g._getRenderElement=function($X,$g,$K){for(var $x,$Z,$n=this._batchRenderElements.length,$W=!0,$v=0;$v<$n;$v++){var $T,$G,$c=($Z=this._batchRenderElements[$v])._sprite3D._render;if(0!==$v&&($W=($T=($x=this._batchRenderElements[$v-1])._sprite3D._render).lightmapIndex!==$c.lightmapIndex||$T.receiveShadow!==$c.receiveShadow||$x._batchIndexEnd!==$Z._batchIndexStart),$W){($G=this._getCombineRenderElementFromPool()).renderObj=this,$G._material=this._material,$G._batchIndexStart=$Z._batchIndexStart,$G._batchIndexEnd=$Z._batchIndexEnd;var $_=$c.lightmapIndex,$s=$_+1,$V=this._batchOwnerIndices[$s];$V||($V=this._batchOwnerIndices[$s]=[]);var $A,$a=$V[$Z._render.receiveShadow?1:0];void 0===$a?($V[$c.receiveShadow?1:0]=this._batchOwners.length,($A=new $dg(null,"StaticBatchMeshSprite3D"))._scene=$g,$A._transform=this._rootOwner?this._rootOwner._transform:null,$A._render.lightmapIndex=$_,$A._render.receiveShadow=$Z._render.receiveShadow,this._batchOwners.push($A)):$A=this._batchOwners[$a],$A._render._renderUpdate($K),$G._sprite3D=$A,$X.push($G)}else $G._batchIndexEnd=$Z._batchIndexEnd}},$g._beforeRender=function($X){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$g._render=function($X){var $g=$X.renderElement,$K=$g._batchIndexStart,$x=$g._batchIndexEnd-$K;$t.mainContext.drawElements(4,$x,5123,2*$K),$B.drawCall++,$B.trianglesFaces+=$x/3},$g.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},$g._getVertexBuffer=function($X){return void 0===$X&&($X=0),this._vertexBuffer},$n}(),$Ig=function($X){function $g(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,$g.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}$V($g,"laya.d3.core.ComponentNode",$G);var $K=$g.prototype;return $K.addComponent=function($X){var $g,$K=this._componentsMap.indexOf($X);if(-1===$K)$g=[],this._componentsMap.push($X),this._typeComponentsIndices.push($g);else if($g=this._typeComponentsIndices[$K],this._components[$g[0]].isSingleton)throw new Error("无法单实例创建"+$X+"组件，"+$X+"组件已存在！");var $x=$Z.getInstance($X);return $g.push(this._components.length),this._components.push($x),$x instanceof laya.d3.component.Script&&this._scripts.push($x),$x._initialize(this),$x},$K._removeComponent=function($X,$g){var $K=this._typeComponentsIndices[$X],$x=$K[$g],$Z=this._components[$x];this._components.splice($x,1),$Z instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($Z),1),$K.splice($g,1),0===$K.length&&(this._typeComponentsIndices.splice($X,1),this._componentsMap.splice($X,1));for(var $n=0,$W=this._componentsMap.length;$n<$W;$n++)for(var $v=($K=this._typeComponentsIndices[$n]).length-1;0<=$v;$v--){var $T=$K[$v];if(!($x<$T))break;$K[$v]=--$T}$Z._destroy()},$K.getComponentByType=function($X,$g){void 0===$g&&($g=0);var $K=this._componentsMap.indexOf($X);return-1===$K?null:this._components[this._typeComponentsIndices[$K][$g]]},$K.getComponentsByType=function($X,$g){var $K=this._componentsMap.indexOf($X);if(-1!==$K){var $x=this._typeComponentsIndices[$K],$Z=$x.length;$g.length=$Z;for(var $n=0;$n<$Z;$n++)$g[$n]=this._components[$x[$n]]}else $g.length=0},$K.getComponentByIndex=function($X){return this._components[$X]},$K.removeComponentByType=function($X,$g){void 0===$g&&($g=0);var $K=this._componentsMap.indexOf($X);-1!==$K&&this._removeComponent($K,$g)},$K.removeComponentsByType=function($X){var $g=this._componentsMap.indexOf($X);if(-1!==$g)for(var $K=this._typeComponentsIndices[$g],$x=0,$Z=$K.length;$x<$Z;$K.length<$Z?$Z--:$x++)this._removeComponent($g,$x)},$K.removeAllComponent=function(){for(var $X=0,$g=this._componentsMap.length;$X<$g;this._componentsMap.length<$g?$g--:$X++)this.removeComponentsByType(this._componentsMap[$X])},$K._updateComponents=function($X){for(var $g=0,$K=this._components.length;$g<$K;$g++){var $x=this._components[$g];!$x.started&&($x._start($X),$x.started=!0),$x.enable&&$x._update($X)}},$K._lateUpdateComponents=function($X){for(var $g=0;$g<this._components.length;$g++){var $K=this._components[$g];!$K.started&&($K._start($X),$K.started=!0),$K.enable&&$K._lateUpdate($X)}},$K._preRenderUpdateComponents=function($X){for(var $g=0;$g<this._components.length;$g++){var $K=this._components[$g];!$K.started&&($K._start($X),$K.started=!0),$K.enable&&$K._preRenderUpdate($X)}},$K._postRenderUpdateComponents=function($X){for(var $g=0;$g<this._components.length;$g++){var $K=this._components[$g];!$K.started&&($K._start($X),$K.started=!0),$K.enable&&$K._postRenderUpdate($X)}},$g}(),$rg=function($x){function $X(){$X.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new $sg,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new $vg(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}$V($X,"laya.d3.core.material.BaseMaterial",$x);var $g=$X.prototype;return $Q.imps($g,{"laya.d3.core.IClone":!0}),$g._addShaderDefine=function($X){this._shaderDefineValue|=$X},$g._removeShaderDefine=function($X){this._shaderDefineValue&=~$X},$g._addDisablePublicShaderDefine=function($X){this._disablePublicShaderDefine|=$X},$g._removeDisablePublicShaderDefine=function($X){this._disablePublicShaderDefine&=~$X},$g._setBuffer=function($X,$g){this._shaderValues.setValue($X,$g),this._values[$X]=$g},$g._getBuffer=function($X){return this._values[$X]},$g._setMatrix4x4=function($X,$g){this._shaderValues.setValue($X,$g?$g.elements:null),this._values[$X]=$g},$g._getMatrix4x4=function($X){return this._values[$X]},$g._setInt=function($X,$g){this._shaderValues.setValue($X,$g),this._values[$X]=$g},$g._getInt=function($X){return this._values[$X]},$g._setNumber=function($X,$g){this._shaderValues.setValue($X,$g),this._values[$X]=$g},$g._getNumber=function($X){return this._values[$X]},$g._setBool=function($X,$g){this._shaderValues.setValue($X,$g),this._values[$X]=$g},$g._getBool=function($X){return this._values[$X]},$g._setVector2=function($X,$g){this._shaderValues.setValue($X,$g?$g.elements:null),this._values[$X]=$g},$g._getVector2=function($X){return this._values[$X]},$g._setColor=function($X,$g){this._shaderValues.setValue($X,$g?$g.elements:null),this._values[$X]=$g},$g._getColor=function($X){return this._values[$X]},$g._setTexture=function($X,$g){var $K=this._values[$X];this._values[$X]=$g,this._shaderValues.setValue($X,$g),0<this.referenceCount&&($K&&$K._removeReference(),$g&&$g._addReference())},$g._getTexture=function($X){return this._values[$X]},$g._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},$g._getShader=function($X,$g,$K){var $x=($X|$g)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile($x,$K,this._shaderDefineValue),this._shader},$g._setRenderStateBlendDepth=function(){var $X=$t.mainContext;switch($M.setDepthMask($X,this.depthWrite),0===this.depthTest?$M.setDepthTest($X,!1):($M.setDepthTest($X,!0),$M.setDepthFunc($X,this.depthTest)),this.blend){case 0:$M.setBlend($X,!1);break;case 1:$M.setBlend($X,!0),$M.setBlendFunc($X,this.srcBlend,this.dstBlend);break;case 2:$M.setBlend($X,!0)}},$g._setRenderStateFrontFace=function($X,$g){var $K=$t.mainContext,$x=0;switch(this.cull){case 0:$M.setCullFace($K,!1);break;case 1:$M.setCullFace($K,!0),$x=$X?$g&&$g._isFrontFaceInvert?2305:2304:$g&&$g._isFrontFaceInvert?2304:2305,$M.setFrontFace($K,$x);break;case 2:$M.setCullFace($K,!0),$x=$X?$g&&$g._isFrontFaceInvert?2304:2305:$g&&$g._isFrontFaceInvert?2305:2304,$M.setFrontFace($K,$x)}},$g.onAsynLoaded=function($X,$g,$K){var $x=$g[0],$Z=$g[1];switch($x.version){case"LAYAMATERIAL:01":var $n=0,$W=0,$v=$x.props;for(var $T in $v)switch($T){case"vectors":var $G=$v[$T];for($n=0,$W=$G.length;$n<$W;$n++){var $c=$G[$n],$_=$c.value;switch($_.length){case 2:this[$c.name]=new $ng($_[0],$_[1]);break;case 3:this[$c.name]=new $Wg($_[0],$_[1],$_[2]);break;case 4:this[$c.name]=new $vg($_[0],$_[1],$_[2],$_[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var $s=$v[$T];for($n=0,$W=$s.length;$n<$W;$n++){var $V=$s[$n],$A=$V.path;$A&&(this[$V.name]=$F.getRes($Z[$A]))}break;case"defines":var $a=$v[$T];for($n=0,$W=$a.length;$n<$W;$n++){var $m=this._shaderCompile.getMaterialDefineByName($a[$n]);this._addShaderDefine($m)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[$T]=$v[$T];break;case"renderQueue":switch($v[$T]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[$T]=$v[$T]}break;case"LAYAMATERIAL:02":for($T in $v=$x.props)switch($T){case"vectors":for($n=0,$W=($G=$v[$T]).length;$n<$W;$n++)switch(($_=($c=$G[$n]).value).length){case 2:this[$c.name]=new $ng($_[0],$_[1]);break;case 3:this[$c.name]=new $Wg($_[0],$_[1],$_[2]);break;case 4:this[$c.name]=new $vg($_[0],$_[1],$_[2],$_[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for($n=0,$W=($s=$v[$T]).length;$n<$W;$n++)($A=($V=$s[$n]).path)&&(this[$V.name]=$F.getRes($Z[$A]));break;case"defines":for($n=0,$W=($a=$v[$T]).length;$n<$W;$n++)$m=this._shaderCompile.getMaterialDefineByName($a[$n]),this._addShaderDefine($m);break;default:this[$T]=$v[$T]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},$g._addReference=function(){$x.prototype._addReference.call(this);for(var $X=0,$g=this._values.length;$X<$g;$X++){var $K=this._values[$X];$K&&$K instanceof laya.d3.resource.BaseTexture&&$K._addReference()}},$g._removeReference=function(){$x.prototype._removeReference.call(this);for(var $X=0,$g=this._values.length;$X<$g;$X++){var $K=this._values[$X];$K&&$K instanceof laya.d3.resource.BaseTexture&&$K._removeReference()}},$g.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},$g.setShaderName=function($X){var $g=$lg.nameKey.getID($X);if(-1===$g)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=$Bg._preCompileShader[$g]},$g.cloneTo=function($X){var $g=$X;$g.name=this.name,$g.cull=this.cull,$g.blend=this.blend,$g.srcBlend=this.srcBlend,$g.dstBlend=this.dstBlend,$g.srcBlendRGB=this.srcBlendRGB,$g.dstBlendRGB=this.dstBlendRGB,$g.srcBlendAlpha=this.srcBlendAlpha,$g.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo($g.blendConstColor),$g.blendEquation=this.blendEquation,$g.blendEquationRGB=this.blendEquationRGB,$g.blendEquationAlpha=this.blendEquationAlpha,$g.depthTest=this.depthTest,$g.depthWrite=this.depthWrite,$g.renderQueue=this.renderQueue,$g._shader=this._shader,$g._disablePublicShaderDefine=this._disablePublicShaderDefine,$g._shaderDefineValue=this._shaderDefineValue;var $K,$x=0,$Z=$g._shaderValues;$g._shaderValues.data.length=this._shaderValues.data.length;var $n=this._values.length,$W=$g._values;for($x=0,$K=$W.length=$n;$x<$K;$x++){var $v=this._values[$x];if($v)if("number"==typeof $v)$W[$x]=$v,$Z.data[$x]=$v;else if("number"==typeof $v&&Math.floor($v)==$v)$W[$x]=$v,$Z.data[$x]=$v;else if("boolean"==typeof $v)$W[$x]=$v,$Z.data[$x]=$v;else if($v instanceof laya.d3.math.Vector2){var $T=$W[$x]||($W[$x]=new $ng);$v.cloneTo($T),$Z.data[$x]=$T.elements}else if($v instanceof laya.d3.math.Vector3){var $G=$W[$x]||($W[$x]=new $Wg);$v.cloneTo($G),$Z.data[$x]=$G.elements}else if($v instanceof laya.d3.math.Vector4){var $c=$W[$x]||($W[$x]=new $vg);$v.cloneTo($c),$Z.data[$x]=$c.elements}else if($v instanceof laya.d3.math.Matrix4x4){var $_=$W[$x]||($W[$x]=new $Xg);$v.cloneTo($_),$Z.data[$x]=$_.elements}else $v instanceof laya.d3.resource.BaseTexture&&($W[$x]=$v,$Z.data[$x]=$v)}},$g.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$A(0,$g,"alphaTestValue",function(){return this._getNumber(0)},function($X){this._setNumber(0,$X)}),$A(0,$g,"alphaTest",function(){return this._alphaTest},function($X){(this._alphaTest=$X)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),$X.__init__=function(){$X.SHADERDEFINE_ALPHATEST=$X.shaderDefines.registerDefine("ALPHATEST")},$X.RENDERQUEUE_OPAQUE=2e3,$X.RENDERQUEUE_ALPHATEST=2450,$X.RENDERQUEUE_TRANSPARENT=3e3,$X.CULL_NONE=0,$X.CULL_FRONT=1,$X.CULL_BACK=2,$X.BLEND_DISABLE=0,$X.BLEND_ENABLE_ALL=1,$X.BLEND_ENABLE_SEPERATE=2,$X.BLENDPARAM_ZERO=0,$X.BLENDPARAM_ONE=1,$X.BLENDPARAM_SRC_COLOR=768,$X.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,$X.BLENDPARAM_DST_COLOR=774,$X.BLENDPARAM_ONE_MINUS_DST_COLOR=775,$X.BLENDPARAM_SRC_ALPHA=770,$X.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,$X.BLENDPARAM_DST_ALPHA=772,$X.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,$X.BLENDPARAM_SRC_ALPHA_SATURATE=776,$X.BLENDEQUATION_ADD=0,$X.BLENDEQUATION_SUBTRACT=1,$X.BLENDEQUATION_REVERSE_SUBTRACT=2,$X.DEPTHTEST_OFF=0,$X.DEPTHTEST_NEVER=512,$X.DEPTHTEST_LESS=513,$X.DEPTHTEST_EQUAL=514,$X.DEPTHTEST_LEQUAL=515,$X.DEPTHTEST_GREATER=516,$X.DEPTHTEST_NOTEQUAL=517,$X.DEPTHTEST_GEQUAL=518,$X.DEPTHTEST_ALWAYS=519,$X.SHADERDEFINE_ALPHATEST=1,$X.ALPHATESTVALUE=0,$_($X,["shaderDefines",function(){return this.shaderDefines=new $cg}]),$X}($m),$tg=function($X){function $g(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,$g.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}$V($g,"laya.d3.resource.BaseTexture",$m);var $K=$g.prototype;return $A(0,$K,"width",function(){return this._width}),$A(0,$K,"repeat",function(){return this._repeat},function($X){if(this._repeat!==$X&&(this._repeat=$X,this._source)){var $g=$t.mainContext;$M.bindTexture($g,this._type,this._source),$w.isPOT(this._width,this._height)&&this._repeat?($g.texParameteri(this._type,10242,10497),$g.texParameteri(this._type,10243,10497)):($g.texParameteri(this._type,10242,33071),$g.texParameteri(this._type,10243,33071))}}),$A(0,$K,"height",function(){return this._height}),$A(0,$K,"magFifter",function(){return this._magFifter},function($X){(this._magFifter=$X)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter($X)}),$A(0,$K,"wrapModeV",function(){return this._wrapModeV}),$A(0,$K,"size",function(){return this._size}),$A(0,$K,"wrapModeU",function(){return this._wrapModeU}),$A(0,$K,"mipmap",function(){return this._mipmap},function($X){this._mipmap=$X,this._mipmap!=$X&&this._conchTexture&&this._conchTexture.setMipMap($X)}),$A(0,$K,"minFifter",function(){return this._minFifter},function($X){this._minFifter=$X,this._minFifter!=$X&&this._conchTexture&&this._conchTexture.setMinFifter($X)}),$A(0,$K,"format",function(){return this._format}),$A(0,$K,"source",function(){return this.activeResource(),this._source}),$A(0,$K,"defaulteTexture",function(){return $eg.grayTexture}),$g.WARPMODE_REPEAT=0,$g.WARPMODE_CLAMP=1,$g}(),$Mg=function($X){function $g(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,$g.__super.call(this),this._boundingBoxCorners=$x(8,null)}$V($g,"laya.d3.resource.models.BaseMesh",$m);var $K=$g.prototype;return $K._getPositions=function(){throw new Error("未Override,请重载该属性！")},$K._generateBoundingObject=function(){this._boundingSphere=new $oX(new $Wg,0),$oX.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new $zX(new $Wg,new $Wg),$zX.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},$K.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},$K.getRenderElement=function($X){throw new Error("未Override,请重载该属性！")},$A(0,$K,"subMeshCount",function(){return this._subMeshCount}),$A(0,$K,"boundingBox",function(){return this._boundingBox}),$A(0,$K,"boundingBoxCorners",function(){return this._boundingBoxCorners}),$A(0,$K,"boundingSphere",function(){return this._boundingSphere}),$g}(),$Pg=(function($X){function $g(){$g.__super.call(this)}$V($g,"laya.d3.component.Script",$$g);var $K=$g.prototype;$K.onTriggerEnter=function($X){},$K.onTriggerExit=function($X){},$K.onTriggerStay=function($X){},$A(0,$K,"isSingleton",function(){return $g._isSingleton}),$g._isSingleton=!1}(),function($X){function $g($X){this._owner=null,this._sharedMesh=null,$g.__super.call(this),this._owner=$X}$V($g,"laya.d3.core.MeshFilter",$X);var $K=$g.prototype;return $K._sharedMeshLoaded=function(){this.event("loaded")},$K._destroy=function(){$X.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},$A(0,$K,"sharedMesh",function(){return this._sharedMesh},function($X){var $g=this._sharedMesh;$g&&$g._removeReference(),(this._sharedMesh=$X)._addReference(),this.event("meshchanged",[this,$g,$X]),$X.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),$A(0,$K,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),$A(0,$K,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),$A(0,$K,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),$A(0,$K,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),$g}($wg)),$Ng=function($X){function $g($X){$g.__super.call(this,$X),$X.meshFilter.on("meshchanged",this,this._onMeshChanged)}$V($g,"laya.d3.core.MeshRender",$Qg);var $K=$g.prototype;return $K._onMeshChanged=function($X,$g,$K){$K.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:$K.once("loaded",this,this._onMeshLoaed)},$K._onMeshLoaed=function($X,$g){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},$K._calculateBoundingSphereByInitSphere=function($X){var $g=NaN,$K=this._owner.transform,$x=$K.scale.elements,$Z=Math.abs($x[0]),$n=Math.abs($x[1]),$W=Math.abs($x[2]);$g=$n<=$Z&&$W<=$Z?$Z:$W<=$n?$n:$W,$Wg.transformCoordinate($X.center,$K.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=$X.radius*$g},$K._calculateBoundBoxByInitCorners=function($X){for(var $g=this._owner.transform.worldMatrix,$K=0;$K<8;$K++)$Wg.transformCoordinate($X[$K],$g,$Qg._tempBoundBoxCorners[$K]);$zX.createfromPoints($Qg._tempBoundBoxCorners,this._boundingBox)},$K._calculateBoundingSphere=function(){var $X=this._owner.meshFilter.sharedMesh;null==$X||null==$X.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere($X.boundingSphere)},$K._calculateBoundingBox=function(){var $X=this._owner.meshFilter.sharedMesh;null==$X||null==$X.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners($X.boundingBoxCorners)},$K._renderUpdate=function($X){var $g=this._owner.transform;if($g){this._setShaderValueMatrix4x4(0,$g.worldMatrix);var $K=this._owner.getProjectionViewWorldMatrix($X);this._setShaderValueMatrix4x4(1,$K)}else this._setShaderValueMatrix4x4(0,$Xg.DEFAULT),this._setShaderValueMatrix4x4(1,$X);return $Fg.debugMode&&this._renderRenderableBoundBox(),!0},$g}(),$Cg=function($g){function $x(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,$x.__super.call(this),this._renderState=new $h,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new $sg,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new $gX,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new $Wg(.7,.7,.7),this.ambientColor=new $Wg(.212,.227,.259),$t.shaderHighPrecision&&this.addShaderDefine($Bg.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}$V($x,"laya.d3.core.scene.Scene",$g);var $X=$x.prototype;return $Q.imps($X,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),$X._setUrl=function($X){this._url=$X},$X._getGroup=function(){return this._group},$X._setGroup=function($X){this._group=$X},$X._display=function(){$Q.stage._scenes.push(this),$Q.stage._scenes.sort($x._sortScenes);for(var $X=0,$g=this._childs.length;$X<$g;$X++){var $K=this._childs[$X];$K.active&&$K._activeHierarchy()}},$X._unDisplay=function(){var $X=$Q.stage._scenes;$X.splice($X.indexOf(this),1);for(var $g=0,$K=this._childs.length;$g<$K;$g++){var $x=this._childs[$g];$x.active&&$x._inActiveHierarchy()}},$X._addChild3D=function($X){$X.transform._onWorldTransform(),$X._setBelongScene(this),this.displayedInStage&&$X.active&&$X._activeHierarchy()},$X._removeChild3D=function($X){$X.transform.parent=null,this.displayedInStage&&$X.active&&$X._inActiveHierarchy(),$X._setUnBelongScene()},$X.initOctree=function($X,$g,$K,$x,$Z){void 0===$Z&&($Z=6),this.treeSize=new $Wg($X,$g,$K),this.treeLevel=$Z,this.treeRoot=new $z(this,0),this.treeRoot.init($x,this.treeSize)},$X._prepareUpdateToRenderState=function($X,$g){$g.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,$g.scene=this},$X._prepareSceneToRender=function($X){var $g=this._lights.length;if(0<$g)for(var $K=0,$x=0;$x<$g&&!(this._lights[$x]._prepareToScene($X)&&++$K>=this._enableLightCount);$x++);},$X._updateChilds=function($X){for(var $g=0,$K=this._childs.length;$g<$K;++$g)this._childs[$g]._update($X)},$X._preRenderScene=function($X,$g,$K){var $x,$Z=$g._viewMatrix,$n=$g._projectionMatrix,$W=$g._projectionViewMatrix,$v=0,$T=$g.camera;for($T.useOcclusionCulling?this.treeRoot?$KX.renderObjectCullingOctree($K,this,$T,$Z,$n,$W):$KX.renderObjectCulling($K,this,$T,$Z,$n,$W):$KX.renderObjectCullingNoBoundFrustum(this,$T,$Z,$n,$W),$v=0,$x=this._quenes.length;$v<$x;$v++)this._quenes[$v]&&this._quenes[$v]._preRender($g)},$X._clear=function($X,$g){var $K=$g._viewport,$x=$g.camera,$Z=$K.x,$n=$x.renderTargetSize.height-$K.y-$K.height,$W=$K.width,$v=$K.height;$X.viewport($Z,$n,$W,$v);var $T=256,$G=$x.renderTarget;switch($x.clearFlag){case 0:var $c=$x.clearColor;if($c){$X.enable(3089),$X.scissor($Z,$n,$W,$v);var $_=$c.elements;$X.clearColor($_[0],$_[1],$_[2],$_[3]),$T|=16384}if($G)switch($c||($T=16384),$G.depthStencilFormat){case 33189:$T|=256;break;case 36168:$T|=1024;break;case 34041:$T|=256,$T|=1024}$X.clear($T),$c&&$X.disable(3089);break;case 1:case 2:if($G)switch($T=16384,$G.depthStencilFormat){case 33189:$T|=256;break;case 36168:$T|=1024;break;case 34041:$T|=256,$T|=1024}$X.clear($T);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},$X._renderScene=function($X,$g){var $K,$x,$Z=$g.camera,$n=0;for($n=0;$n<2;$n++)($x=this._quenes[$n])&&($Z.renderTarget?$x._render($g,!0):$x._render($g,!1));if(1===$Z.clearFlag){var $W=$Z.sky;$W&&($M.setCullFace($X,!1),$M.setDepthFunc($X,515),$M.setDepthMask($X,!1),$W._render($g),$M.setDepthFunc($X,513),$M.setDepthMask($X,!0))}for($n=2,$K=this._quenes.length;$n<$K;$n++)($x=this._quenes[$n])&&($x._sortAlpha($g.camera.transform.position),$Z.renderTarget?$x._render($g,!0):$x._render($g,!1))},$X._set3DRenderConfig=function($X){$X.disable(3042),$M._blend=!1,$X.blendFunc(770,771),$M._sFactor=770,$M._dFactor=771,$X.disable(2929),$M._depthTest=!1,$X.enable(2884),$M._cullFace=!0,$X.depthMask(1),$M._depthMask=!0,$X.frontFace(2304),$M._frontFace=2304},$X._set2DRenderConfig=function($X){$M.setBlend($X,!0),$M.setBlendFunc($X,1,771),$M.setDepthTest($X,!1),$M.setCullFace($X,!1),$M.setDepthMask($X,!0),$M.setFrontFace($X,2305),$X.viewport(0,0,$c.width,$c.height)},$X._parseCustomProps=function($X,$g,$K,$x){var $Z=$x.customProps.lightmaps,$n=$Z.length,$W=this._lightmaps;$W.length=$n;for(var $v=0;$v<$n;$v++)$W[$v]=$F.getRes($g[$Z[$v].replace(".exr",".png")]);this.setlightmaps($W);var $T=$x.customProps.ambientColor;$T&&(this.ambientColor=new $Wg($T[0],$T[1],$T[2]));var $G=$x.customProps.fogColor;$G&&(this.fogColor=new $Wg($G[0],$G[1],$G[2]))},$X._addLight=function($X){this._lights.indexOf($X)<0&&this._lights.push($X)},$X._removeLight=function($X){var $g=this._lights.indexOf($X);0<=$g&&this._lights.splice($g,1)},$X._updateScene=function(){var $X=this._renderState;this._prepareUpdateToRenderState($t.mainContext,$X),this._updateComponents($X),this._updateChilds($X),this._lateUpdateComponents($X),this._time+=$X.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},$X._updateSceneConch=function(){var $X=this._renderState;this._prepareUpdateToRenderState($t.mainContext,$X),this._updateComponents($X),this._lateUpdateComponents($X),this._prepareSceneToRender($X);for(var $g=0,$K=this._cameraPool.length;$g<$K;$g++){var $x=this._cameraPool[$g];($X.camera=$x)._prepareCameraToRender()}},$X._preRenderShadow=function($X,$g,$K,$x,$Z){this.treeRoot?$KX.renderShadowObjectCullingOctree(this,$g,$K,$x,$Z):$KX.renderShadowObjectCulling(this,$g,$K,$x,$Z);for(var $n=0,$W=$K.length;$n<$W;$n++)$K[$n]&&$K[$n]._preRender($X)},$X._renderShadowMap=function($X,$g,$K){var $x=this.parallelSplitShadowMaps[0];$x._calcAllLightCameraInfo($K);var $Z,$n,$W,$v=$x.PSSMNum;if(this._preRenderShadow($g,$x._lightCulling,$x._shadowQuenes,$x._lightVPMatrix[0],$v),this.addShaderDefine($Vg.SHADERDEFINE_CAST_SHADOW),1<$v)for(var $T=0;$T<$v;$T++)$Z=$x.getRenderTarget($T+1),$x.beginRenderTarget($T+1),$X.clearColor(1,1,1,1),$X.clear(16640),$X.viewport(0,0,$Z.width,$Z.height),$g.camera=$W=$x.getLightCamera($T),$W._prepareCameraToRender(),$W._prepareCameraViewProject($W.viewMatrix,$W.projectionMatrix),$g._projectionViewMatrix=$x._lightVPMatrix[$T+1],($n=$x._shadowQuenes[$T])._preRender($g),$n._renderShadow($g,!1),$x.endRenderTarget($T+1);else $Z=$x.getRenderTarget(1),$x.beginRenderTarget(1),$X.clearColor(1,1,1,1),$X.clear(16640),$X.viewport(0,0,$Z.width,$Z.height),$g.camera=$W=$x.getLightCamera(0),$W._prepareCameraToRender(),$W._prepareCameraViewProject($W.viewMatrix,$W.projectionMatrix),$g._projectionViewMatrix=$x._lightVPMatrix[0],($n=$x._shadowQuenes[0])._preRender($g),$n._renderShadow($g,!0),$x.endRenderTarget(1);this.removeShaderDefine($Vg.SHADERDEFINE_CAST_SHADOW)},$X.addTreeNode=function($X){this.treeRoot.addTreeNode($X)},$X.removeTreeNode=function($X){this.treeSize&&$X._treeNode&&$X._treeNode.removeObject($X)},$X.setlightmaps=function($X){this._lightmaps=$X;for(var $g=0,$K=this._renderableSprite3Ds.length;$g<$K;$g++)this._renderableSprite3Ds[$g]._render._applyLightMapParams()},$X.getlightmaps=function(){return this._lightmaps},$X.addChildAt=function($X,$g){if(!($X instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+($X&&$X.__className));if(!$X||this.destroyed||$X===this)return $X;if($X.zOrder&&this._set$P("hasZorder",!0),0<=$g&&$g<=this._childs.length){if($X._parent===this){var $K=this.getChildIndex($X);this._childs.splice($K,1),this._childs.splice($g,0,$X),this.conchModel&&(this.conchModel.removeChild($X.conchModel),this.conchModel.addChildAt($X.conchModel,$g)),this._childChanged()}else $X.parent&&$X.parent.removeChild($X),this._childs===$G.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($g,0,$X),this.conchModel&&this.conchModel.addChildAt($X.conchModel,$g),($X.parent=this)._addChild3D($X);return $X}throw new Error("appendChildAt:The index is out of bounds")},$X.addChild=function($X){if(!($X instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$X||this.destroyed||$X===this)return $X;if($X.zOrder&&this._set$P("hasZorder",!0),$X._parent===this){var $g=this.getChildIndex($X);$g!==this._childs.length-1&&(this._childs.splice($g,1),this._childs.push($X),this.conchModel&&(this.conchModel.removeChild($X.conchModel),this.conchModel.addChildAt($X.conchModel,this._childs.length-1)),this._childChanged())}else $X.parent&&$X.parent.removeChild($X),this._childs===$G.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($X),this.conchModel&&this.conchModel.addChildAt($X.conchModel,this._childs.length-1),($X.parent=this)._childChanged(),this._addChild3D($X);return $X},$X.removeChildAt=function($X){var $g=this.getChildAt($X);return $g&&(this._removeChild3D($g),this._childs.splice($X,1),this.conchModel&&this.conchModel.removeChild($g.conchModel),$g.parent=null),$g},$X.removeChildren=function($X,$g){if(void 0===$X&&($X=0),void 0===$g&&($g=2147483647),this._childs&&0<this._childs.length){var $K=this._childs;if(0===$X&&$n<=$g){var $x=$K;this._childs=$G.ARRAY_EMPTY}else $x=$K.splice($X,$g-$X);for(var $Z=0,$n=$x.length;$Z<$n;$Z++)this._removeChild3D($x[$Z]),$x[$Z].parent=null,this.conchModel&&this.conchModel.removeChild($x[$Z].conchModel)}return this},$X.addFrustumCullingObject=function($X){this.treeRoot?this.addTreeNode($X):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push($X):this._cullingRenders[this._cullingRendersLength]=$X,$X._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},$X.removeFrustumCullingObject=function($X){if(this.treeRoot)this.removeTreeNode($X);else{this._cullingRendersLength--;var $g=$X._indexInSceneFrustumCullingObjects;if($g!==this._cullingRendersLength){var $K=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[$g]=$K)._indexInSceneFrustumCullingObjects=$g,$X._indexInSceneFrustumCullingObjects=-1}}},$X.getRenderQueue=function($X){return $X<3e3?this._quenes[1]||(this._quenes[1]=new $d(this)):this._quenes[2]||(this._quenes[2]=new $d(this))},$X.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new $d(this)},$X.addShaderDefine=function($X){this._shaderDefineValue|=$X},$X.removeShaderDefine=function($X){this._shaderDefineValue&=~$X},$X.addScript=function($X){return this._addComponent($X)},$X.getScriptByType=function($X,$g){return void 0===$g&&($g=0),this._getComponentByType($X,$g)},$X.getScriptsByType=function($X,$g){this._getComponentsByType($X,$g)},$X.getScriptByIndex=function($X){return this._getComponentByIndex($X)},$X.removeScriptByType=function($X,$g){void 0===$g&&($g=0),this._removeComponentByType($X,$g)},$X.removeScriptsByType=function($X){this._removeComponentByType($X)},$X.removeAllScript=function(){this._removeAllComponent()},$X.render=function($X,$g,$K){($a._context.ctx._renderKey=0)<this._childs.length&&$X.addRenderObject(this)},$X.renderSubmit=function(){var $X=$t.mainContext,$g=this._renderState;this._set3DRenderConfig($X),this._prepareSceneToRender(this._renderState);var $K,$x=0,$Z=0;if($Fg.debugMode||$z.debugMode)for($x=0,$Z=this._cameraPool.length;$x<$Z;$x++)$K=this._cameraPool[$x],$Fg._debugPhasorSprite.begin(1,$K),$K.activeInHierarchy&&$K._renderCamera($X,$g,this),$Fg._debugPhasorSprite.end();else for($x=0,$Z=this._cameraPool.length;$x<$Z;$x++)($K=this._cameraPool[$x]).activeInHierarchy&&$K._renderCamera($X,$g,this);return this._set2DRenderConfig($X),1},$X.onAsynLoaded=function($X,$g,$K){var $x=$g[0];if("Scene"!==$x.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var $Z=$g[1];$mg._createNodeByJson(this,$x,this,$Z),this.event("hierarchyloaded",[this]),this.__loaded=!0},$X.destroy=function($X){void 0===$X&&($X=!0),this.destroyed||($g.prototype.destroy.call(this,$X),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,$F.clearRes(this.url),this.loaded||$Fg._cancelLoadByUrl(this.url))},$X.getRenderType=function(){return 0},$X.releaseRender=function(){},$X._addComponent=function($X){var $g,$K=this._componentsMap.indexOf($X);if(-1===$K)$g=[],this._componentsMap.push($X),this._typeComponentsIndices.push($g);else if($g=this._typeComponentsIndices[$K],this._components[$g[0]].isSingleton)throw new Error("无法单实例创建"+$X+"组件，"+$X+"组件已存在！");var $x=$Z.getInstance($X);$g.push(this._components.length),this._components.push($x);return $x._initialize(this),$x},$X._removeComponent=function($X,$g){var $K=this._typeComponentsIndices[$X],$x=$K[$g],$Z=this._components[$x];this._components.splice($x,1),$K.splice($g,1),0===$K.length&&(this._typeComponentsIndices.splice($X,1),this._componentsMap.splice($X,1));for(var $n=0,$W=this._componentsMap.length;$n<$W;$n++)for(var $v=($K=this._typeComponentsIndices[$n]).length-1;0<=$v;$v--){var $T=$K[$v];if(!($x<$T))break;$K[$v]=--$T}$Z._destroy()},$X._getComponentByType=function($X,$g){void 0===$g&&($g=0);var $K=this._componentsMap.indexOf($X);return-1===$K?null:this._components[this._typeComponentsIndices[$K][$g]]},$X._getComponentsByType=function($X,$g){var $K=this._componentsMap.indexOf($X);if(-1!==$K){var $x=this._typeComponentsIndices[$K],$Z=$x.length;$g.length=$Z;for(var $n=0;$n<$Z;$n++)$g[$n]=this._components[$x[$n]]}else $g.length=0},$X._getComponentByIndex=function($X){return this._components[$X]},$X._removeComponentByType=function($X,$g){void 0===$g&&($g=0);var $K=this._componentsMap.indexOf($X);-1!==$K&&this._removeComponent($K,$g)},$X._removeComponentsByType=function($X){var $g=this._componentsMap.indexOf($X);if(-1!==$g)for(var $K=this._typeComponentsIndices[$g],$x=0,$Z=$K.length;$x<$Z;$K.length<$Z?$Z--:$x++)this._removeComponent($g,$x)},$X._removeAllComponent=function(){for(var $X=0,$g=this._componentsMap.length;$X<$g;this._componentsMap.length<$g?$g--:$X++)this._removeComponentsByType(this._componentsMap[$X])},$X._updateComponents=function($X){for(var $g=0,$K=this._components.length;$g<$K;$g++){var $x=this._components[$g];!$x.started&&($x._start($X),$x.started=!0),$x.enable&&$x._update($X)}},$X._lateUpdateComponents=function($X){for(var $g=0;$g<this._components.length;$g++){var $K=this._components[$g];!$K.started&&($K._start($X),$K.started=!0),$K.enable&&$K._lateUpdate($X)}},$X._preRenderUpdateComponents=function($X){for(var $g=0;$g<this._components.length;$g++){var $K=this._components[$g];!$K.started&&($K._start($X),$K.started=!0),$K.enable&&$K._preRenderUpdate($X)}},$X._postRenderUpdateComponents=function($X){for(var $g=0;$g<this._components.length;$g++){var $K=this._components[$g];!$K.started&&($K._start($X),$K.started=!0),$K.enable&&$K._postRenderUpdate($X)}},$A(0,$X,"_loaded",null,function($X){this.__loaded=$X}),$A(0,$X,"fogColor",function(){return this._fogColor},function($X){this._fogColor=$X,this._shaderValues.setValue(0,$X.elements)}),$A(0,$X,"enableFog",function(){return this._enableFog},function($X){this._enableFog!==$X&&((this._enableFog=$X)?(this.addShaderDefine($Bg.SHADERDEFINE_FOG),this.removeShaderDefine($Bg.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine($Bg.SHADERDEFINE_FOG))}),$A(0,$X,"url",function(){return this._url}),$A(0,$X,"loaded",function(){return this.__loaded}),$A(0,$X,"enableDepthFog",function(){return this._enableDepthFog},function($X){this._enableDepthFog!=$X&&((this._enableDepthFog=$X)?(this.addShaderDefine($Bg.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine($Bg.SHADERDEFINE_FOG)):this.removeShaderDefine($Bg.SAHDERDEFINE_DEPTHFOG))}),$A(0,$X,"fogStart",function(){return this._fogStart},function($X){this._fogStart=$X,this._shaderValues.setValue(1,$X)}),$A(0,$X,"fogRange",function(){return this._fogRange},function($X){this._fogRange=$X,this._shaderValues.setValue(2,$X)}),$A(0,$X,"ambientColor",function(){return this._ambientColor},function($X){this._ambientColor=$X,this._shaderValues.setValue(21,$X.elements)}),$A(0,$X,"scene",function(){return this}),$A(0,$X,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),$x._sortScenes=function($X,$g){if($X.parent!==$Q.stage||$g.parent!==$Q.stage)return $X.parent!==$Q.stage&&$g.parent!==$Q.stage?$x._sortScenes($X.parent,$g.parent):$X.parent===$Q.stage?-1:1;var $K=$Q.stage._childs;return $K.indexOf($X)-$K.indexOf($g)},$x.load=function($X){return $Q.loader.create($X,null,null,$x)},$x.FOGCOLOR=0,$x.FOGSTART=1,$x.FOGRANGE=2,$x.LIGHTDIRECTION=3,$x.LIGHTDIRCOLOR=4,$x.POINTLIGHTPOS=5,$x.POINTLIGHTRANGE=6,$x.POINTLIGHTATTENUATION=7,$x.POINTLIGHTCOLOR=8,$x.SPOTLIGHTPOS=9,$x.SPOTLIGHTDIRECTION=10,$x.SPOTLIGHTSPOT=11,$x.SPOTLIGHTRANGE=12,$x.SPOTLIGHTATTENUATION=13,$x.SPOTLIGHTCOLOR=14,$x.SHADOWDISTANCE=15,$x.SHADOWLIGHTVIEWPROJECT=16,$x.SHADOWMAPPCFOFFSET=17,$x.SHADOWMAPTEXTURE1=18,$x.SHADOWMAPTEXTURE2=19,$x.SHADOWMAPTEXTURE3=20,$x.AMBIENTCOLOR=21,$x.TIME=22,$x}($D),$Yg=function($X){function $g($X){$g.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new $Xg,this._shaderValues=new $sg,this._colliders=[],this._id=++$g._uniqueIDCounter,this._transform=new $fg(this),this.name=$X||"Sprite3D-"+$g._nameNumberCounter++,this.layer=$N.currentCreationLayer,this.active=!0}$V($g,"laya.d3.core.Sprite3D",$Ig);var $K=$g.prototype;return $Q.imps($K,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),$K._setUrl=function($X){this._url=$X},$K._getGroup=function(){return this._group},$K._setGroup=function($X){this._group=$X},$K._addChild3D=function($X){$X.transform.parent=this.transform,this._hierarchyAnimator&&(!$X._hierarchyAnimator&&$X._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($X,!0,[$X.name])),this._scene&&($X._setBelongScene(this._scene),this._activeInHierarchy&&$X._active&&$X._activeHierarchy())},$K._removeChild3D=function($X){$X.transform.parent=null,this._scene&&(this._activeInHierarchy&&$X._active&&$X._inActiveHierarchy(),$X._setUnBelongScene()),this._hierarchyAnimator&&($X._hierarchyAnimator==this._hierarchyAnimator&&$X._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($X,!1,[$X.name]))},$K._parseBaseCustomProps=function($X){var $g=this.transform.localPosition;$X.translate?($g.fromArray($X.translate),$g.x*=100,$g.y*=100,$g.z*=100):$g.elements.fill(0),this.transform.localPosition=$g;var $K=this.transform.localRotation;$X.rotation?$K.fromArray($X.rotation):$K.fromArray([0,0,0,-1]),this.transform.localRotation=$K;var $x=this.transform.localScale;$X.scale?$x.fromArray($X.scale):$x.elements.fill(1),this.transform.localScale=$x;var $Z=$X.layer;null!=$Z&&(this.layer=$N.getLayerByNumber($Z))},$K._parseCustomComponent=function($X,$g,$K){for(var $x in $K){var $Z=$K[$x];switch($x){case"Animator":var $n=this.addComponent(Animator);if($Z.avatarPath)$n.avatar=$F.getRes($g[$Z.avatarPath]);else{var $W=$Z.avatar;if($W){$n.avatar=$F.getRes($g[$W.path]);var $v=$W.linkSprites;$v&&$X.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[$n,$v])}}for(var $T=$Z.clipPaths,$G=$T.length,$c=0;$c<$G;$c++)$n.addClip($F.getRes($g[$T[$c]]));$n.clip=$F.getRes($g[$T[0]]);var $_=$Z.playOnWake;void 0!==$_&&($n.playOnWake=$_);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var $s=this.addComponent(SphereCollider);$s.isTrigger=$Z.isTrigger;var $V=$s.center;$V.fromArray($Z.center),$s.center=$V,$s.radius=$Z.radius;break;case"BoxCollider":var $A=this.addComponent(BoxCollider);$A.isTrigger=$Z.isTrigger,$A.center.fromArray($Z.center);var $a=$A.size;$a.fromArray($Z.size),$A.size=$a;break;case"MeshCollider":this.addComponent(MeshCollider)}}},$K._onRootNodeHierarchyLoaded=function($X,$g){for(var $K in $g){for(var $x=this,$Z=$g[$K],$n=0,$W=$Z.length;$n<$W;$n++){var $v=$Z[$n];if(""===$v)break;if(!($x=$x.getChildByName($v)))break}$x&&$X.linkSprite3DToAvatarNode($K,$x)}},$K._setHierarchyAnimator=function($X,$g){this._changeHierarchyAnimator($X);for(var $K=0,$x=this._childs.length;$K<$x;$K++){var $Z=this._childs[$K];$Z._hierarchyAnimator==$g&&$Z._setHierarchyAnimator($X,$g)}},$K._clearHierarchyAnimator=function($X,$g){this._changeHierarchyAnimator($g);for(var $K=0,$x=this._childs.length;$K<$x;$K++){var $Z=this._childs[$K];$Z._hierarchyAnimator==$X&&$Z._clearHierarchyAnimator($X,$g)}},$K._getAnimatorToLinkSprite3D=function($X,$g,$K){var $x=this.getComponentByType(Animator);if($x&&($x.avatar?$x.avatar._version||$X._setAnimatorToLinkAvatar($x,$g):$X._setAnimatorToLinkSprite3DNoAvatar($x,$g,$K)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){$K.unshift(this._parent.name);var $Z=this._parent;$Z._hierarchyAnimator&&$Z._getAnimatorToLinkSprite3D($X,$g,$K)}},$K._setAnimatorToLinkSprite3DNoAvatar=function($X,$g,$K){var $x=0,$Z=0;for($x=0,$Z=$X.getClipCount();$x<$Z;$x++)$X._handleSpriteOwnersBySprite($x,$g,$K,this);for($x=0,$Z=this._childs.length;$x<$Z;$x++){var $n=this._childs[$x],$W=$K.length;$K.push($n.name),$n._setAnimatorToLinkSprite3DNoAvatar($X,$g,$K),$K.splice($W,1)}},$K._changeHierarchyAnimator=function($X){this._hierarchyAnimator=$X},$K._isLinkSpriteToAnimationNode=function($X,$g,$K){var $x=$X._avatarNodes.indexOf($g),$Z=$X._cacheSpriteToNodesMap;if($K)this._transform.dummy=$g.transform,$X._cacheNodesToSpriteMap[$x]=$Z.length,$Z.push($x);else{this._transform.dummy=null;var $n=$X._cacheNodesToSpriteMap[$x];$X._cacheNodesToSpriteMap[$x]=null,$Z.splice($n,1)}},$K._setBelongScene=function($X){this._scene=$X;for(var $g=0,$K=this._childs.length;$g<$K;$g++)this._childs[$g]._setBelongScene($X)},$K._setUnBelongScene=function(){this._scene=null;for(var $X=0,$g=this._childs.length;$X<$g;$X++)this._childs[$X]._setUnBelongScene()},$K._activeHierarchy=function(){var $X=0,$g=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),$X=0,$g=this._colliders.length;$X<$g;$X++)this._layer._addCollider(this._colliders[$X]);for(this.event("activeinhierarchychanged",!0),$X=0,$g=this._childs.length;$X<$g;$X++){var $K=this._childs[$X];$K._active&&$K._activeHierarchy()}},$K._inActiveHierarchy=function(){var $X=0,$g=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),$X=0,$g=this._colliders.length;$X<$g;$X++){var $K=this._colliders[$X];$K._clearCollsionMap(),this._layer._removeCollider($K)}for(this.event("activeinhierarchychanged",!1),$X=0,$g=this._childs.length;$X<$g;$X++){var $x=this._childs[$X];$x._active&&$x._inActiveHierarchy()}},$K.addComponent=function($X){var $g,$K=this._componentsMap.indexOf($X);if(-1===$K)$g=[],this._componentsMap.push($X),this._typeComponentsIndices.push($g);else if($g=this._typeComponentsIndices[$K],this._components[$g[0]].isSingleton)throw new Error("无法单实例创建"+$X+"组件，"+$X+"组件已存在！");var $x=$Z.getInstance($X);return $g.push(this._components.length),this._components.push($x),$x instanceof laya.d3.component.Script&&this._scripts.push($x),$x._initialize(this),$x},$K._removeComponent=function($X,$g){var $K,$x=0,$Z=this._typeComponentsIndices[$X],$n=$Z[$g],$W=this._components[$n];for($W instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($W),1),$Z.splice($g,1),0===$Z.length&&(this._typeComponentsIndices.splice($X,1),this._componentsMap.splice($X,1)),$x=0,$K=this._componentsMap.length;$x<$K;$x++)for(var $v=($Z=this._typeComponentsIndices[$x]).length-1;0<=$v;$v--){var $T=$Z[$v];if(!($n<$T))break;$Z[$v]=--$T}$W._destroy()},$K._clearSelfRenderObjects=function(){},$K._addSelfRenderObjects=function(){},$K._parseCustomProps=function($X,$g,$K,$x){},$K._updateChilds=function($X){var $g=this._childs.length;if(0!==$g)for(var $K=0;$K<$g;++$K)this._childs[$K]._update($X)},$K._getSortID=function($X,$g){return 1e3*$g.id+$X._getVertexBuffer().vertexDeclaration.id},$K._update=function($X){($X.owner=this)._activeInHierarchy&&(this._updateComponents($X),this._lateUpdateComponents($X),$B.spriteCount++,this._childs.length&&this._updateChilds($X))},$K.getProjectionViewWorldMatrix=function($X){return $Xg.multiply($X,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},$K.loadHierarchy=function($X){this.addChild(laya.d3.core.Sprite3D.load($X))},$K.addChildAt=function($X,$g){if(!($X instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$X||this.destroyed||$X===this)return $X;if($X.zOrder&&this._set$P("hasZorder",!0),0<=$g&&$g<=this._childs.length){if($X._parent===this){var $K=this.getChildIndex($X);this._childs.splice($K,1),this._childs.splice($g,0,$X),this.conchModel&&(this.conchModel.removeChild($X.conchModel),this.conchModel.addChildAt($X.conchModel,$g)),this._childChanged()}else $X.parent&&$X.parent.removeChild($X),this._childs===$G.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($g,0,$X),this.conchModel&&this.conchModel.addChildAt($X.conchModel,$g),($X.parent=this)._addChild3D($X);return $X}throw new Error("appendChildAt:The index is out of bounds")},$K.addChild=function($X){if(!($X instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$X||this.destroyed||$X===this)return $X;if($X.zOrder&&this._set$P("hasZorder",!0),$X._parent===this){var $g=this.getChildIndex($X);$g!==this._childs.length-1&&(this._childs.splice($g,1),this._childs.push($X),this.conchModel&&(this.conchModel.removeChild($X.conchModel),this.conchModel.addChildAt($X.conchModel,this._childs.length-1)),this._childChanged())}else $X.parent&&$X.parent.removeChild($X),this._childs===$G.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($X),this.conchModel&&this.conchModel.addChildAt($X.conchModel,this._childs.length-1),($X.parent=this)._childChanged(),this._addChild3D($X);return $X},$K.removeChildAt=function($X){var $g=this.getChildAt($X);return $g&&(this._removeChild3D($g),this._childs.splice($X,1),this.conchModel&&this.conchModel.removeChild($g.conchModel),$g.parent=null),$g},$K.removeChildren=function($X,$g){if(void 0===$X&&($X=0),void 0===$g&&($g=2147483647),this._childs&&0<this._childs.length){var $K=this._childs;if(0===$X&&$n<=$g){var $x=$K;this._childs=$G.ARRAY_EMPTY}else $x=$K.splice($X,$g-$X);for(var $Z=0,$n=$x.length;$Z<$n;$Z++)this._removeChild3D($x[$Z]),$x[$Z].parent=null,this.conchModel&&this.conchModel.removeChild($x[$Z].conchModel)}return this},$K.onAsynLoaded=function($X,$g,$K){var $x=$g[0];if("Sprite3D"!==$x.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var $Z=$g[1];$mg._createNodeByJson(this,$x,this,$Z),this.event("hierarchyloaded",[this]),this.__loaded=!0},$K.cloneTo=function($X){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var $g=$X;$g.name=this.name,$g._destroyed=this._destroyed,$g.timer=this.timer,$g._$P=this._$P,$g.active=this._active;var $K=$g.transform.localPosition;this.transform.localPosition.cloneTo($K),$g.transform.localPosition=$K;var $x=$g.transform.localRotation;this.transform.localRotation.cloneTo($x),$g.transform.localRotation=$x;var $Z=$g.transform.localScale;this.transform.localScale.cloneTo($Z),$g.transform.localScale=$Z,$g.isStatic=this.isStatic;var $n=0,$W=0;for($n=0,$W=this._componentsMap.length;$n<$W;$n++){var $v=$g.addComponent(this._componentsMap[$n]);this._components[$n]._cloneTo($v)}for($n=0,$W=this._childs.length;$n<$W;$n++)$g.addChild(this._childs[$n].clone());var $T=$g.getComponentByType(Animator);if($T){var $G=$T._linkSpritesData;if($G)for(var $c in $G){for(var $_=$G[$c],$s=$g,$V=0,$A=$_.length;$V<$A&&($s=$s.getChildByName($_[$V]));$V++);if($s){var $a=$T._avatarNodeMap[$c];$s._isLinkSpriteToAnimationNode($T,$a,!0)}}}},$K.clone=function(){var $X=new this.constructor;return this.cloneTo($X),$X},$K.destroy=function($X){if(void 0===$X&&($X=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,$X);var $g,$K=0;for($K=0,$g=this._components.length;$K<$g;$K++)this._components[$K]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,$F.clearRes(this.url),this.loaded||$Fg._cancelLoadByUrl(this.url)}},$K._handleSpriteToAvatar=function($X,$g){$X._avatarNodes;var $K=$X._avatarNodeMap[this.name];$K&&$K.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode($X,$K,$g)},$K._setAnimatorToLinkAvatar=function($X,$g){this._handleSpriteToAvatar($X,$g);for(var $K=0,$x=this._childs.length;$K<$x;$K++){this._childs[$K]._setAnimatorToLinkAvatar($X,$g)}},$A(0,$K,"activeInHierarchy",function(){return this._activeInHierarchy}),$A(0,$K,"_loaded",null,function($X){this.__loaded=$X}),$A(0,$K,"active",function(){return this._active},function($X){this._active!==$X&&(this._active=$X,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&($X?this._activeHierarchy():this._inActiveHierarchy()))}),$A(0,$K,"componentsCount",function(){return this._components.length}),$A(0,$K,"loaded",function(){return this.__loaded}),$A(0,$K,"id",function(){return this._id}),$A(0,$K,"url",function(){return this._url}),$A(0,$K,"layer",function(){return this._layer},function($X){if(this._layer!==$X){if(!$X)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var $g=0,$K=this._colliders.length;if(this._layer)for($g=0;$g<$K;$g++)this._layer._removeCollider(this._colliders[$g]);for($g=0;$g<$K;$g++)$X._addCollider(this._colliders[$g])}this._layer=$X,this.event("layerchanged",$X)}}),$A(0,$K,"scene",function(){return this._scene}),$A(0,$K,"transform",function(){return this._transform}),$g.instantiate=function($X,$g,$K,$x,$Z){void 0===$K&&($K=!0);var $n=$X.clone();$g&&$g.addChild($n);var $W=$n.transform;if($K){var $v=$W.worldMatrix;$X.transform.worldMatrix.cloneTo($v),$W.worldMatrix=$v}else $x&&($W.position=$x),$Z&&($W.rotation=$Z);return $n},$g.load=function($X){return $Q.loader.create($X,null,null,$g)},$g.WORLDMATRIX=0,$g.MVPMATRIX=1,$g._uniqueIDCounter=0,$g._nameNumberCounter=0,$g}(),$lg=function($X){function $c($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],$c.__super.call(this),!$X||!$g)throw"Shader Error";this._id=++$c._count,this._vs=$X,this._ps=$g,this._attributeMap=$K,this._sceneUniformMap=$x,this._cameraUniformMap=$Z,this._spriteUniformMap=$n,this._materialUniformMap=$W,this._renderElementUniformMap=$v,this._precompile=$T,this._define=$G,this._precompile&&$c.extCompileObj&&$c.extCompileFunc?$c.extCompileFunc.call($c.extCompileObj,$X,$g,$G):this.recreateResource()}$V($c,"laya.d3.shader.Shader3D",$K);var $g=$c.prototype;return $g.recreateResource=function(){$P.now();this._compile(),this.completeCreate(),this.memorySize=0},$g.disposeResource=function(){$t.mainContext.deleteShader(this._vshader),$t.mainContext.deleteShader(this._pshader),$t.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},$g._compile=function(){if(!$t.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var $X=[this._vs,this._ps],$g=$t.mainContext;if(this._program=$g.createProgram(),this._vshader=$c._createShader($g,$X[0],35633),this._pshader=$c._createShader($g,$X[1],35632),$g.attachShader(this._program,this._vshader),$g.attachShader(this._program,this._pshader),$g.linkProgram(this._program),!$a.isConchApp&&$Bg.debugMode&&!$g.getProgramParameter(this._program,35714))throw $g.getProgramInfoLog(this._program);var $K,$x=0,$Z=0,$n=0;for($n=$a.isConchApp?$g.getProgramParameterEx(this._vs,this._ps,"",35721):$g.getProgramParameter(this._program,35721),$x=0;$x<$n;$x++){var $W=null;$K={vartype:"attribute",ivartype:0,attrib:$W=$a.isConchApp?$g.getActiveAttribEx(this._vs,this._ps,"",$x):$g.getActiveAttrib(this._program,$x),location:$g.getAttribLocation(this._program,$W.name),name:$W.name,type:$W.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push($K)}var $v=0;for($v=$a.isConchApp?$g.getProgramParameterEx(this._vs,this._ps,"",35718):$g.getProgramParameter(this._program,35718),$x=0;$x<$v;$x++){var $T=null;$T=$a.isConchApp?$g.getActiveUniformEx(this._vs,this._ps,"",$x):$g.getActiveUniform(this._program,$x),0<($K={vartype:"uniform",ivartype:1,attrib:$W,location:$g.getUniformLocation(this._program,$T.name),name:$T.name,type:$T.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($K.name=$K.name.substr(0,$K.name.length-3),$K.isArray=!0,$K.location=$g.getUniformLocation(this._program,$K.name)),this._uniformParams.push($K)}for($x=0,$Z=this._attributeParams.length;$x<$Z;$x++)($K=this._attributeParams[$x]).indexOfParams=$x,$K.index=1,$K.value=[$K.location,null],$K.codename=$K.name,$K.name=null!=this._attributeMap[$K.codename]?this._attributeMap[$K.codename]:$K.codename,this._attributeParamsMap.push($K.name),this._attributeParamsMap.push($K),$K._this=this,$K.uploadedValue=[],$K.fun=this._attribute;for($x=0,$Z=this._uniformParams.length;$x<$Z;$x++)switch(($K=this._uniformParams[$x]).indexOfParams=$x,$K.index=1,$K.value=[$K.location,null],$K.codename=$K.name,null!=this._sceneUniformMap[$K.codename]?($K.name=this._sceneUniformMap[$K.codename],this._sceneUniformParamsMap.push($K.name),this._sceneUniformParamsMap.push($K)):null!=this._cameraUniformMap[$K.codename]?($K.name=this._cameraUniformMap[$K.codename],this._cameraUniformParamsMap.push($K.name),this._cameraUniformParamsMap.push($K)):null!=this._spriteUniformMap[$K.codename]?($K.name=this._spriteUniformMap[$K.codename],this._spriteUniformParamsMap.push($K.name),this._spriteUniformParamsMap.push($K)):null!=this._materialUniformMap[$K.codename]?($K.name=this._materialUniformMap[$K.codename],this._materialUniformParamsMap.push($K.name),this._materialUniformParamsMap.push($K)):null!=this._renderElementUniformMap[$K.codename]?($K.name=this._renderElementUniformMap[$K.codename],this._renderElementUniformParamsMap.push($K.name),this._renderElementUniformParamsMap.push($K)):console.log("Shader:can't find uinform name:"+$K.codename+" in shader file."),$K._this=this,$K.uploadedValue=[],$K.type){case 5124:$K.fun=$K.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$K.fun=$K.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$K.fun=$K.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$K.fun=$K.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$K.fun=$K.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$K.fun=this._uniform_sampler2D;break;case 35680:$K.fun=this._uniform_samplerCube;break;case 35676:$K.fun=this._uniformMatrix4fv;break;case 35670:$K.fun=this._uniform1i;break;case 35674:$K.fun=this._uinformMatrix2fv;break;case 35675:$K.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},$g._attribute=function($X,$g){var $K=$t.mainContext,$x=$v._enableAtributes,$Z=$X.location;return $x[$Z]||$K.enableVertexAttribArray($Z),$K.vertexAttribPointer($Z,$g[0],$g[1],$g[2],$g[3],$g[4]),$x[$Z]=$v._bindVertexBuffer,1},$g._uniform1f=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g?($t.mainContext.uniform1f($X.location,$K[0]=$g),1):0},$g._uniform1fv=function($X,$g){if($g.length<4){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]||$K[2]!==$g[2]||$K[3]!==$g[3]?($t.mainContext.uniform1fv($X.location,$g),$K[0]=$g[0],$K[1]=$g[1],$K[2]=$g[2],$K[3]=$g[3],1):0}return $t.mainContext.uniform1fv($X.location,$g),1},$g._uniform_vec2=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]?($t.mainContext.uniform2f($X.location,$K[0]=$g[0],$K[1]=$g[1]),1):0},$g._uniform_vec2v=function($X,$g){if($g.length<2){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]||$K[2]!==$g[2]||$K[3]!==$g[3]?($t.mainContext.uniform2fv($X.location,$g),$K[0]=$g[0],$K[1]=$g[1],$K[2]=$g[2],$K[3]=$g[3],1):0}return $t.mainContext.uniform2fv($X.location,$g),1},$g._uniform_vec3=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]||$K[2]!==$g[2]?($t.mainContext.uniform3f($X.location,$K[0]=$g[0],$K[1]=$g[1],$K[2]=$g[2]),1):0},$g._uniform_vec3v=function($X,$g){return $t.mainContext.uniform3fv($X.location,$g),1},$g._uniform_vec4=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]||$K[2]!==$g[2]||$K[3]!==$g[3]?($t.mainContext.uniform4f($X.location,$K[0]=$g[0],$K[1]=$g[1],$K[2]=$g[2],$K[3]=$g[3]),1):0},$g._uniform_vec4v=function($X,$g){return $t.mainContext.uniform4fv($X.location,$g),1},$g._uniformMatrix2fv=function($X,$g){return $t.mainContext.uniformMatrix2fv($X.location,!1,$g),1},$g._uniformMatrix3fv=function($X,$g){return $t.mainContext.uniformMatrix3fv($X.location,!1,$g),1},$g._uniformMatrix4fv=function($X,$g){return $t.mainContext.uniformMatrix4fv($X.location,!1,$g),1},$g._uinformMatrix2fv=function($X,$g){return $t.mainContext.uniformMatrix2fv($X.location,!1,$g),1},$g._uinformMatrix3fv=function($X,$g){return $t.mainContext.uniformMatrix3fv($X.location,!1,$g),1},$g._uniform1i=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g?($t.mainContext.uniform1i($X.location,$K[0]=$g),1):0},$g._uniform1iv=function($X,$g){return $t.mainContext.uniform1iv($X.location,$g),1},$g._uniform_ivec2=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]?($t.mainContext.uniform2i($X.location,$K[0]=$g[0],$K[1]=$g[1]),1):0},$g._uniform_ivec2v=function($X,$g){return $t.mainContext.uniform2iv($X.location,$g),1},$g._uniform_vec3i=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]||$K[2]!==$g[2]?($t.mainContext.uniform3i($X.location,$K[0]=$g[0],$K[1]=$g[1],$K[2]=$g[2]),1):0},$g._uniform_vec3vi=function($X,$g){return $t.mainContext.uniform3iv($X.location,$g),1},$g._uniform_vec4i=function($X,$g){var $K=$X.uploadedValue;return $K[0]!==$g[0]||$K[1]!==$g[1]||$K[2]!==$g[2]||$K[3]!==$g[3]?($t.mainContext.uniform4i($X.location,$K[0]=$g[0],$K[1]=$g[1],$K[2]=$g[2],$K[3]=$g[3]),1):0},$g._uniform_vec4vi=function($X,$g){return $t.mainContext.uniform4iv($X.location,$g),1},$g._uniform_sampler2D=function($X,$g){var $K=$g.source||$g.defaulteTexture.source,$x=$t.mainContext,$Z=$X.uploadedValue;if(null!=$Z[0])return $x.activeTexture($c._TEXTURES[$Z[0]]),$K&&$M.bindTexture($x,3553,$K),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $Z[0]=this._curActTexIndex,$x.uniform1i($X.location,this._curActTexIndex),$x.activeTexture($c._TEXTURES[this._curActTexIndex]),$K&&$M.bindTexture($x,3553,$K),this._curActTexIndex++,1},$g._uniform_samplerCube=function($X,$g){var $K=$g.source||$g.defaulteTexture.source,$x=$t.mainContext,$Z=$X.uploadedValue;if(null!=$Z[0])return $x.activeTexture($c._TEXTURES[$Z[0]]),$K?$M.bindTexture($x,34067,$K):$M.bindTexture($x,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $Z[0]=this._curActTexIndex,$x.uniform1i($X.location,this._curActTexIndex),$x.activeTexture($c._TEXTURES[this._curActTexIndex]),$K?$M.bindTexture($x,34067,$K):$M.bindTexture($x,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},$g._noSetValue=function($X){console.log("no....:"+$X.name)},$g.bind=function(){return $K.activeShader=this,($K.bindShader=this).activeResource(),$M.UseProgram(this._program)},$g.uploadAttributes=function($X,$g){for(var $K,$x,$Z=0,$n=0,$W=this._attributeParamsMap.length;$n<$W;$n+=2)$x=this._attributeParamsMap[$n+1],null!=($K=$X[this._attributeParamsMap[$n]])&&($g&&$g[$x.name]&&$g[$x.name].bind(),$Z+=$x.fun.call(this,$x,$K));$B.shaderCall+=$Z},$g.uploadAttributesX=function($X,$g){for(var $K,$x,$Z=0,$n=0,$W=this._attributeParamsMap.length;$n<$W;$n+=2)$x=this._attributeParamsMap[$n+1],null!=($K=$X[this._attributeParamsMap[$n]])&&($g._bind(),$Z+=$x.fun.call(this,$x,$K));$B.shaderCall+=$Z},$g.uploadSceneUniforms=function($X){for(var $g,$K,$x=0,$Z=0,$n=this._sceneUniformParamsMap.length;$Z<$n;$Z+=2)$K=this._sceneUniformParamsMap[$Z+1],null!=($g=$X[this._sceneUniformParamsMap[$Z]])&&($x+=$K.fun.call(this,$K,$g));$B.shaderCall+=$x},$g.uploadCameraUniforms=function($X){for(var $g,$K,$x=0,$Z=0,$n=this._cameraUniformParamsMap.length;$Z<$n;$Z+=2)$K=this._cameraUniformParamsMap[$Z+1],null!=($g=$X[this._cameraUniformParamsMap[$Z]])&&($x+=$K.fun.call(this,$K,$g));$B.shaderCall+=$x},$g.uploadSpriteUniforms=function($X){for(var $g,$K,$x=0,$Z=0,$n=this._spriteUniformParamsMap.length;$Z<$n;$Z+=2)$K=this._spriteUniformParamsMap[$Z+1],null!=($g=$X[this._spriteUniformParamsMap[$Z]])&&($x+=$K.fun.call(this,$K,$g));$B.shaderCall+=$x},$g.uploadMaterialUniforms=function($X){for(var $g,$K,$x=0,$Z=0,$n=this._materialUniformParamsMap.length;$Z<$n;$Z+=2)$K=this._materialUniformParamsMap[$Z+1],null!=($g=$X[this._materialUniformParamsMap[$Z]])&&($x+=$K.fun.call(this,$K,$g));$B.shaderCall+=$x},$g.uploadRenderElementUniforms=function($X){for(var $g,$K,$x=0,$Z=0,$n=this._renderElementUniformParamsMap.length;$Z<$n;$Z+=2)$K=this._renderElementUniformParamsMap[$Z+1],null!=($g=$X[this._renderElementUniformParamsMap[$Z]])&&($x+=$K.fun.call(this,$K,$g));$B.shaderCall+=$x},$c.create=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){return new $c($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G)},$c.addInclude=function($X,$g){$$.addInclude($X,$g)},$c._createShader=function($X,$g,$K){var $x=$X.createShader($K);if($X.shaderSource($x,$g),$X.compileShader($x),$Bg.debugMode&&!$X.getShaderParameter($x,35713))throw $X.getShaderInfoLog($x);return $x},$c.PERIOD_RENDERELEMENT=0,$c.PERIOD_MATERIAL=1,$c.PERIOD_SPRITE=2,$c.PERIOD_CAMERA=3,$c.PERIOD_SCENE=4,$c._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],$c._count=0,$c._preCompile=!1,$c.extCompileFunc=null,$c.extCompileObj=null,$_($c,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new $i}]),$c}(),$pg=function($v){function $T(){this._transformUV=null,$T.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new $Wg(.6,.6,.6)),this._setColor(10,new $Wg(1,1,1)),this._setColor(11,new $vg(1,1,1,8)),this._setColor(12,new $Wg(1,1,1)),this._setColor(7,new $vg(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new $vg(1,1,0,0)),this.renderMode=1}$V($T,"laya.d3.core.material.StandardMaterial",$v);var $X=$T.prototype;return $X.disableLight=function(){this._addDisablePublicShaderDefine($Bg.SHADERDEFINE_POINTLIGHT|$Bg.SHADERDEFINE_SPOTLIGHT|$Bg.SHADERDEFINE_DIRECTIONLIGHT)},$X.disableFog=function(){this._addDisablePublicShaderDefine($Bg.SHADERDEFINE_FOG)},$X.onAsynLoaded=function($X,$g,$K){var $x=$g[0];if($x.version)$v.prototype.onAsynLoaded.call(this,$X,$g,$K);else{var $Z=$g[1],$n=$x.props;for(var $W in $n)this[$W]=$n[$W];$T._parseStandardMaterial($Z,this,$x),this._endLoaded()}},$X.cloneTo=function($X){$v.prototype.cloneTo.call(this,$X);var $g=$X;this._transformUV&&($g._transformUV=this._transformUV.clone())},$A(0,$X,"ambientColor",function(){return this._getColor(9)},function($X){this._setColor(9,$X)}),$A(0,$X,"ambientTexture",function(){return this._getTexture(5)},function($X){$X?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,$X)}),$A(0,$X,"renderMode",null,function($X){switch($X){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($T.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode($X)}),$A(0,$X,"reflectColor",function(){return this._getColor(12)},function($X){this._setColor(12,$X)}),$A(0,$X,"tilingOffset",function(){return this._getColor(15)},function($X){if($X){var $g=$X.elements;1!=$g[0]||1!=$g[1]||0!=$g[2]||0!=$g[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,$X)}),$A(0,$X,"albedo",function(){return this._getColor(7)},function($X){this._setColor(7,$X)}),$A(0,$X,"diffuseColor",function(){return this._getColor(10)},function($X){this._setColor(10,$X)}),$A(0,$X,"albedoColor",function(){return this._getColor(7)},function($X){this._setColor(7,$X)}),$A(0,$X,"specularColor",function(){return this._getColor(11)},function($X){this._setColor(11,$X)}),$A(0,$X,"diffuseTexture",function(){return this._getTexture(1)},function($X){$X?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,$X)}),$A(0,$X,"normalTexture",function(){return this._getTexture(2)},function($X){$X?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,$X)}),$A(0,$X,"specularTexture",function(){return this._getTexture(3)},function($X){$X?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,$X)}),$A(0,$X,"emissiveTexture",function(){return this._getTexture(4)},function($X){$X?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,$X)}),$A(0,$X,"reflectTexture",function(){return this._getTexture(6)},function($X){$X?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,$X)}),$A(0,$X,"transformUV",function(){return this._transformUV},function($X){this._transformUV=$X,this._setMatrix4x4(13,$X.matrix),$X?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,$X.matrix.elements,0)}),$T.__init__=function(){$T.SHADERDEFINE_DIFFUSEMAP=$T.shaderDefines.registerDefine("DIFFUSEMAP"),$T.SHADERDEFINE_NORMALMAP=$T.shaderDefines.registerDefine("NORMALMAP"),$T.SHADERDEFINE_SPECULARMAP=$T.shaderDefines.registerDefine("SPECULARMAP"),$T.SHADERDEFINE_EMISSIVEMAP=$T.shaderDefines.registerDefine("EMISSIVEMAP"),$T.SHADERDEFINE_AMBIENTMAP=$T.shaderDefines.registerDefine("AMBIENTMAP"),$T.SHADERDEFINE_REFLECTMAP=$T.shaderDefines.registerDefine("REFLECTMAP"),$T.SHADERDEFINE_UVTRANSFORM=$T.shaderDefines.registerDefine("UVTRANSFORM"),$T.SHADERDEFINE_TILINGOFFSET=$T.shaderDefines.registerDefine("TILINGOFFSET"),$T.SHADERDEFINE_ADDTIVEFOG=$T.shaderDefines.registerDefine("ADDTIVEFOG")},$T.load=function($X){return $Q.loader.create($X,null,null,$T)},$T._parseStandardMaterial=function($X,$g,$K){var $x=$K.customProps,$Z=$x.ambientColor;$g.ambientColor=new $Wg($Z[0],$Z[1],$Z[2]);var $n=$x.diffuseColor;$g.diffuseColor=new $Wg($n[0],$n[1],$n[2]);var $W=$x.specularColor;$g.specularColor=new $vg($W[0],$W[1],$W[2],$W[3]);var $v=$x.reflectColor;$g.reflectColor=new $Wg($v[0],$v[1],$v[2]);var $T=$x.albedoColor;$T&&($g.albedo=new $vg($T[0],$T[1],$T[2],$T[3]));var $G=$x.diffuseTexture.texture2D;$G&&($g.diffuseTexture=$F.getRes($X[$G]));var $c=$x.normalTexture.texture2D;$c&&($g.normalTexture=$F.getRes($X[$c]));var $_=$x.specularTexture.texture2D;$_&&($g.specularTexture=$F.getRes($X[$_]));var $s=$x.emissiveTexture.texture2D;$s&&($g.emissiveTexture=$F.getRes($X[$s]));var $V=$x.ambientTexture.texture2D;$V&&($g.ambientTexture=$F.getRes($X[$V]));var $A=$x.reflectTexture.texture2D;$A&&($g.reflectTexture=$F.getRes($X[$A]))},$T.RENDERMODE_OPAQUE=1,$T.RENDERMODE_OPAQUEDOUBLEFACE=2,$T.RENDERMODE_CUTOUT=3,$T.RENDERMODE_CUTOUTDOUBLEFACE=4,$T.RENDERMODE_TRANSPARENT=13,$T.RENDERMODE_TRANSPARENTDOUBLEFACE=14,$T.RENDERMODE_ADDTIVE=15,$T.RENDERMODE_ADDTIVEDOUBLEFACE=16,$T.RENDERMODE_DEPTHREAD_TRANSPARENT=5,$T.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,$T.RENDERMODE_DEPTHREAD_ADDTIVE=7,$T.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,$T.RENDERMODE_NONDEPTH_TRANSPARENT=9,$T.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,$T.RENDERMODE_NONDEPTH_ADDTIVE=11,$T.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,$T.SHADERDEFINE_DIFFUSEMAP=0,$T.SHADERDEFINE_NORMALMAP=0,$T.SHADERDEFINE_SPECULARMAP=0,$T.SHADERDEFINE_EMISSIVEMAP=0,$T.SHADERDEFINE_AMBIENTMAP=0,$T.SHADERDEFINE_REFLECTMAP=0,$T.SHADERDEFINE_UVTRANSFORM=0,$T.SHADERDEFINE_TILINGOFFSET=0,$T.SHADERDEFINE_ADDTIVEFOG=0,$T.DIFFUSETEXTURE=1,$T.NORMALTEXTURE=2,$T.SPECULARTEXTURE=3,$T.EMISSIVETEXTURE=4,$T.AMBIENTTEXTURE=5,$T.REFLECTTEXTURE=6,$T.ALBEDO=7,$T.UVANIAGE=8,$T.MATERIALAMBIENT=9,$T.MATERIALDIFFUSE=10,$T.MATERIALSPECULAR=11,$T.MATERIALREFLECT=12,$T.UVMATRIX=13,$T.UVAGE=14,$T.TILINGOFFSET=15,$_($T,["defaultMaterial",function(){var $X=new $T;return $X.lock=!0,this.defaultMaterial=$X},"shaderDefines",function(){return this.shaderDefines=new $cg($rg.shaderDefines)}]),$T}($rg),$Lg=function($X){function $W($X,$g,$K,$x,$Z){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===$K&&($K=35044),void 0===$x&&($x=!1),$W.__super.call(this),this._indexType=$X,this._indexCount=$g,this._bufferUsage=$K,this._bufferType=34963,this._canRead=$x;var $n;if("ushort"==$X)this._indexTypeByteCount=2;else{if("ubyte"!=$X)throw new Error("unidentification index type.");this._indexTypeByteCount=1}$n=this._indexTypeByteCount*$g,this._byteLength=$n,this._bind(),$v._gl.bufferData(this._bufferType,$n,this._bufferUsage),this.uri=$Z,$x?("ushort"==$X?this._buffer=new Uint16Array($g):"ubyte"==$X&&(this._buffer=new Uint8Array($g)),this.memorySize=2*$n):this.memorySize=$n}$V($W,"laya.d3.graphics.IndexBuffer3D",$X);var $g=$W.prototype;return $g.setData=function($X,$g,$K,$x){void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=4294967295);var $Z=0;if("ushort"==this._indexType?($Z=2,0===$K&&4294967295===$x||($X=new Uint16Array($X.buffer,$K*$Z,$x))):"ubyte"==this._indexType&&($Z=1,0===$K&&4294967295===$x||($X=new Uint8Array($X.buffer,$K*$Z,$x))),this._bind(),$v._gl.bufferSubData(this._bufferType,$g*$Z,$X),this._canRead)if(0!==$g||0!==$K||4294967295!==$x){var $n=this._buffer.length-$g;$n<$x&&($x=$n);for(var $W=0;$W<$x;$W++)this._buffer[$g+$W]=$X[$W]}else this._buffer=$X},$g.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$g.disposeResource=function(){$X.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},$A(0,$g,"indexType",function(){return this._indexType}),$A(0,$g,"indexTypeByteCount",function(){return this._indexTypeByteCount}),$A(0,$g,"indexCount",function(){return this._indexCount}),$A(0,$g,"canRead",function(){return this._canRead}),$W.INDEXTYPE_UBYTE="ubyte",$W.INDEXTYPE_USHORT="ushort",$W.create=function($X,$g,$K,$x,$Z){return void 0===$K&&($K=35044),void 0===$x&&($x=!1),new $W($X,$g,$K,$x,$Z)},$W}($v),$qg=function($n){function $W($X,$g,$K,$x,$Z){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===$x&&($x=!1),$W.__super.call(this),this._vertexDeclaration=$X,this._vertexCount=$g,this._bufferUsage=$K,this._bufferType=34962,this._canRead=$x,this.uri=$Z,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*$g,this._bind(),$v._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),$x&&(this._buffer=new Float32Array(this._byteLength/4))}$V($W,"laya.d3.graphics.VertexBuffer3D",$n);var $X=$W.prototype;return $X.bindWithIndexBuffer=function($X){$X&&$X._bind(),this._bind()},$X.setData=function($X,$g,$K,$x){if(void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=4294967295),0===$K&&4294967295===$x||($X=new Float32Array($X.buffer,4*$K,$x)),this._bind(),$v._gl.bufferSubData(this._bufferType,4*$g,$X),this._canRead)if(0!==$g||0!==$K||4294967295!==$x){var $Z=this._buffer.length-$g;$Z<$x&&($x=$Z);for(var $n=0;$n<$x;$n++)this._buffer[$g+$n]=$X[$n]}else this._buffer=$X},$X.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$X.disposeResource=function(){for(var $X=$t.mainContext,$g=this._vertexDeclaration.getVertexElements(),$K=$v._enableAtributes,$x=0,$Z=$g.length;$x<$Z;$x++)$K[$x]===this._glBuffer&&($X.disableVertexAttribArray($x),$K[$x]=null);$n.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},$A(0,$X,"vertexDeclaration",function(){return this._vertexDeclaration}),$A(0,$X,"vertexCount",function(){return this._vertexCount}),$A(0,$X,"canRead",function(){return this._canRead}),$W.create=function($X,$g,$K,$x,$Z){return void 0===$K&&($K=35044),void 0===$x&&($x=!1),new $W($X,$g,$K,$x,$Z)},$W}($v),$Eg=function($X){function $$(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,$$.__super.call(this),this._type=3553}$V($$,"laya.d3.resource.DataTexture2D",$tg);var $g=$$.prototype;return $g.genDebugMipmaps=function(){var $X=[];return $X.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),$X.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),$X.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),$X.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),$X.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),$X.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),$X.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),$X.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),$X.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),$X.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),$X},$g._onTextureLoaded=function($X){},$g._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var $X=$t.mainContext,$g=this._source=$X.createTexture(),$K=this._width,$x=this._height,$Z=$M.curBindTexTarget,$n=$M.curBindTexValue,$W=!1;if($M.bindTexture($X,this._type,$g),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var $v=0;$X.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var $T=0;$T<this._mipmaps.length;$T++){if(this._mipmaps[$T].byteLength!=$G*$c*4)throw"mipmap size error  level:"+$T;$X.texSubImage2D(this._type,0,$$.simLodRect[$v++],$$.simLodRect[$v++],$$.simLodRect[$v++],$$.simLodRect[$v++],6408,5121,new Uint8Array(this._mipmaps[$T]))}this.minFifter=9729,this.magFifter=9729}else{var $G=this._width,$c=this._height;for($v=0,$X.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),$T=0;$T<this._mipmaps.length;$T++){if(this._mipmaps[$T].byteLength!=$G*$c*4)throw"mipmap size error  level:"+$T;$X.texImage2D(this._type,$T,6408,$G,$c,0,6408,5121,new Uint8Array(this._mipmaps[$T])),($G/=2)<1&&($G=1),($c/=2)<1&&($c=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&$X.pixelStorei($X.UNPACK_ALIGNMENT,1),$X.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var $_=0,$s=!1,$V=!1;this._buffer.byteLength==4*$K*$x?($_=6408,$s=!0):this._buffer.byteLength==3*$K*$x?($_=6407,$V=!0):$_=this._format,$s||$V?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),$V&&$X.pixelStorei($X.UNPACK_ALIGNMENT,1),$X.texImage2D(this._type,0,$_,$K,$x,0,$_,5121,this._buffer)):$X&&$_==$X.ALPHA?($X.texImage2D(3553,0,$_,$K,$x,0,$_,$X.UNSIGNED_BYTE,this._buffer),$W=!0):0!=$_&&($X.compressedTexImage2D(3553,0,$_,$K,$x,0,this._buffer),$W=!0)}var $A=this._minFifter,$a=this._magFifter,$m=0==this._wrapModeU?10497:33071,$F=0==this._wrapModeV?10497:33071,$U=$w.isPOT($K,$x);$U?(this._mipmap||this._mipmaps?-1!==$A||($A=9987):-1!==$A||($A=9729),-1!==$a||($a=9729),$X.texParameteri(this._type,10241,$A),$X.texParameteri(this._type,10240,$a),$X.texParameteri(this._type,10242,$m),$X.texParameteri(this._type,10243,$F),this._mipmap&&$X.generateMipmap(this._type)):(-1!==$A||($A=9729),-1!==$a||($a=9729),$X.texParameteri(this._type,10241,$A),$X.texParameteri(this._type,10240,$a),$X.texParameteri(this._type,10242,33071),$X.texParameteri(this._type,10243,33071)),$Z&&$n&&$M.bindTexture($X,$Z,$n),this.memorySize=$W?this._buffer.length:$U?$K*$x*4*(1+1/3):$K*$x*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},$g.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},$g.onAsynLoaded=function($X,$g,$K){var $x;$K&&($x=$K[0].call(this,$g)),$x&&(this._width=$x.width,this._height=$x.height,this._buffer=$x.data),this._src=$X,this._size=new $ag(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},$g.getPixels=function(){return new Uint8Array(this._buffer)},$g.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&($t.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},$A(0,$g,"src",function(){return this._src}),$$.create=function($X,$g,$K,$x,$Z,$n,$W){if(void 0===$x&&($x=9729),void 0===$Z&&($Z=9729),void 0===$n&&($n=!0),!$X||$X.byteLength<$g*$K*4)throw"DataTexture2D create error";var $v=new $$;return $v.uri=$W,$v._buffer=$X,$v._width=$g,$v._height=$K,$v._mipmap=$n,$v._magFifter=$x,$v._minFifter=$Z,$v._size=new $ag($v._width,$v._height),$v._conchTexture?alert("怎么给runtime传递datatexture数据"):$v.activeResource(),$v},$$.load=function($X,$g,$K,$x,$Z){if(void 0===$g&&($g=0),void 0===$K&&($K=0),void 0===$x&&($x=9729),void 0===$Z&&($Z=9729),"mipmaps"===$k.getFileExtension($X)){var $n=$Q.loader.create($X,null,null,$$,[function($X){this._mipmaps=[];var $g=new Uint32Array($X);this._width=$g[0];var $K=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,$K=1024),this._width!=$K)throw"现在只支持512x256的环境贴图。当前的是"+$g[0];this._height=$g[1];for(var $x=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,$Z=this._height,$n=8;;){var $W=$x*$Z*4;if($n+$W>$X.byteLength)throw"load mipmaps data size error ";var $v=new Uint8Array($X,$n,$W);if(this._mipmaps.push($v),$n+=$W,1==$x&&1==$Z)break;($x/=2)<1&&($x=1),($Z/=2)<1&&($Z=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){$n.simLodInfo=new Float32Array(40);for(var $W=0;$W<$n.simLodInfo.length;)$n.simLodInfo[$W]=($$.simLodRect[$W]+.5)/1024,$W++,$n.simLodInfo[$W]=($$.simLodRect[$W]+.5)/256,$W++,$n.simLodInfo[$W]=Math.max($$.simLodRect[$W]-1,.1)/1024,$W++,$n.simLodInfo[$W]=Math.max($$.simLodRect[$W]-1.5,.1)/256,$W++}return $n}if("number"==typeof $g)return $Q.loader.create($X,null,null,$$,[function($X){return this._width=$g,this._height=$K,this._buffer=$X,null}]);if("function"==typeof $g)return $Q.loader.create($X,null,null,$$,[$g]);throw new Error("unknown params.")},$$.lodasatlas=!1,$_($$,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),$$}(),$ug=function($X){function $g(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,$g.__super.call(this)}$V($g,"laya.d3.resource.models.PrimitiveMesh",$Mg);var $K=$g.prototype;return $Q.imps($K,{"laya.d3.core.render.IRenderable":!0}),$K._getVertexBuffer=function($X){return void 0===$X&&($X=0),0===$X?this._vertexBuffer:null},$K._getVertexBuffers=function(){return null},$K._getIndexBuffer=function(){return this._indexBuffer},$K._getPositions=function(){var $X,$g=[],$K=this._vertexBuffer.vertexDeclaration.getVertexElements(),$x=0;for($x=0;$x<$K.length;$x++){var $Z=$K[$x];if("vector3"===$Z.elementFormat&&0===$Z.elementUsage){$X=$Z;break}}var $n=this._vertexBuffer.getData();for($x=0;$x<$n.length;$x+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var $W=$x+$X.offset/4,$v=new $Wg($n[$W+0],$n[$W+1],$n[$W+2]);$g.push($v)}return $g},$K.getRenderElement=function($X){return this},$K.getRenderElementsCount=function(){return 1},$K.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},$K._beforeRender=function($X){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$K._render=function($X){$t.mainContext.drawElements(4,this._numberIndices,5123,0),$B.drawCall++,$B.trianglesFaces+=this._numberIndices/3},$A(0,$K,"_vertexBufferCount",function(){return 1}),$A(0,$K,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$g}(),$Og=function($X){function $g(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,$g.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}$V($g,"laya.d3.resource.models.Mesh",$Mg);var $K=$g.prototype;return $K._getPositions=function(){var $X,$g,$K,$x,$Z,$n=[],$W=0,$v=0,$T=0;if(0!==this._vertexBuffers.length){var $G=this._vertexBuffers.length;for($W=0;$W<$G;$W++){for($K=($X=this._vertexBuffers[$W]).vertexDeclaration.getVertexElements(),$v=0;$v<$K.length;$v++)if("vector3"===($x=$K[$v]).elementFormat&&0===$x.elementUsage){$g=$x;break}for($Z=$X.getData(),$v=0;$v<$Z.length;$v+=$X.vertexDeclaration.vertexStride/4)$T=$v+$g.offset/4,$n.push(new $Wg($Z[$T+0],$Z[$T+1],$Z[$T+2]))}}else{var $c=this._subMeshes.length;for($W=0;$W<$c;$W++){for($K=($X=this._subMeshes[$W]._getVertexBuffer()).vertexDeclaration.getVertexElements(),$v=0;$v<$K.length;$v++)if("vector3"===($x=$K[$v]).elementFormat&&0===$x.elementUsage){$g=$x;break}for($Z=$X.getData(),$v=0;$v<$Z.length;$v+=$X.vertexDeclaration.vertexStride/4)$T=$v+$g.offset/4,$n.push(new $Wg($Z[$T+0],$Z[$T+1],$Z[$T+2]))}}return $n},$K._setSubMeshes=function($X){this._subMeshes=$X,this._subMeshCount=$X.length;for(var $g=0;$g<this._subMeshCount;$g++)$X[$g]._indexInMesh=$g;this._positions=this._getPositions(),this._generateBoundingObject()},$K.onAsynLoaded=function($X,$g,$K){var $x=$g[0],$Z=$g[1];$hX.read($x,this,this._materials,this._subMeshes,$Z),this.completeCreate(),this._endLoaded()},$K.getSubMesh=function($X){return this._subMeshes[$X]},$K.getSubMeshCount=function(){return this._subMeshes.length},$K.getRenderElementsCount=function(){return this._subMeshes.length},$K.getRenderElement=function($X){return this._subMeshes[$X]},$K.disposeResource=function(){for(var $X=0;$X<this._subMeshes.length;$X++)this._subMeshes[$X].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},$A(0,$K,"materials",function(){return this._materials.slice()}),$A(0,$K,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),$g.load=function($X){return $Q.loader.create($X,null,null,$g)},$g}(),$eg=(function($X){function $G($X,$g,$K,$x,$Z,$n,$W,$v,$T){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===$K&&($K=6408),void 0===$x&&($x=5121),void 0===$Z&&($Z=33189),void 0===$n&&($n=!1),void 0===$W&&($W=!1),void 0===$v&&($v=-1),void 0===$T&&($T=-1),$G.__super.call(this),this._type=3553,this._width=$X,this._height=$g,this._size=new $ag($X,$g),this._surfaceFormat=$K,this._surfaceType=$x,this._depthStencilFormat=$Z,$a.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=$n,this._repeat=$W,this._minFifter=$v,this._magFifter=$T,this.activeResource(),this._alreadyResolved=!0}$V($G,"laya.d3.resource.RenderTexture",$tg);var $g=$G.prototype;$g.recreateResource=function(){var $X=$t.mainContext;this._frameBuffer=$X.createFramebuffer(),this._source=$X.createTexture();var $g=$M.curBindTexTarget,$K=$M.curBindTexValue;$M.bindTexture($X,this._type,this._source),$X.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var $x=this._minFifter,$Z=this._magFifter,$n=this._repeat?10497:33071;if($w.isPOT(this._width,this._height)?(this._mipmap?-1!==$x||($x=9987):-1!==$x||($x=9729),-1!==$Z||($Z=9729),$X.texParameteri(this._type,10241,$x),$X.texParameteri(this._type,10240,$Z),$X.texParameteri(this._type,10242,$n),$X.texParameteri(this._type,10243,$n),this._mipmap&&$X.generateMipmap(this._type)):(-1!==$x||($x=9729),-1!==$Z||($Z=9729),$X.texParameteri(this._type,10241,$x),$X.texParameteri(this._type,10240,$Z),$X.texParameteri(this._type,10242,33071),$X.texParameteri(this._type,10243,33071)),$g&&$K&&$M.bindTexture($X,$g,$K),$X.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=$X.createRenderbuffer(),$X.bindRenderbuffer(36161,this._depthStencilBuffer),$X.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),$X.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:$X.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$X.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$X.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$X.framebufferTexture2D(36160,36064,3553,this._source,0),$X.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},$g.start=function(){$t.mainContext.bindFramebuffer(36160,this.frameBuffer),($G._currentRenderTarget=this)._alreadyResolved=!1},$g.end=function(){$t.mainContext.bindFramebuffer(36160,null),$G._currentRenderTarget=null,this._alreadyResolved=!0},$g.getData=function($X,$g,$K,$x){var $Z=$t.mainContext;if($Z.bindFramebuffer(36160,this._frameBuffer),!(36053===$Z.checkFramebufferStatus(36160)))return $Z.bindFramebuffer(36160,null),null;var $n=new Uint8Array(this._width*this._height*4);return $Z.readPixels($X,$g,$K,$x,this._surfaceFormat,this._surfaceType,$n),$Z.bindFramebuffer(36160,null),$n},$g.disposeResource=function(){if(this._frameBuffer){var $X=$t.mainContext;$X.deleteTexture(this._source),$X.deleteFramebuffer(this._frameBuffer),$X.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},$A(0,$g,"surfaceFormat",function(){return this._surfaceFormat}),$A(0,$g,"surfaceType",function(){return this._surfaceType}),$A(0,$g,"depthStencilFormat",function(){return this._depthStencilFormat}),$A(0,$g,"source",function(){return this._alreadyResolved?$Q.superGet($tg,this,"source"):null}),$A(0,$g,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$A(0,$g,"frameBuffer",function(){return this._frameBuffer}),$G._currentRenderTarget=null}(),function($X){function $g($X){this._color=null,this._pixels=null,$g.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new $ag(this.width,this.height),this._color=$X,this._pixels=new Uint8Array([255*$X.x,255*$X.y,255*$X.z,255*$X.w]),this.uri="SolidColorTexture2D_"+this.id}$V($g,"laya.d3.resource.SolidColorTexture2D",$tg);var $K=$g.prototype;return $K._createWebGlTexture=function(){var $X=$t.mainContext,$g=this._source=$X.createTexture(),$K=this._width,$x=this._height,$Z=$M.curBindTexTarget,$n=$M.curBindTexValue;$M.bindTexture($X,this._type,$g),$X.texImage2D(this._type,0,6408,$K,$x,0,6408,5121,this._pixels);var $W=this._minFifter,$v=this._magFifter,$T=this._repeat?10497:33071,$G=$w.isPOT($K,$x);$G?(this._mipmap?-1!==$W||($W=9987):-1!==$W||($W=9729),-1!==$v||($v=9729),$X.texParameteri(this._type,10241,$W),$X.texParameteri(this._type,10240,$v),$X.texParameteri(this._type,10242,$T),$X.texParameteri(this._type,10243,$T),this._mipmap&&$X.generateMipmap(this._type)):(-1!==$W||($W=9729),-1!==$v||($v=9729),$X.texParameteri(this._type,10241,$W),$X.texParameteri(this._type,10240,$v),$X.texParameteri(this._type,10242,33071),$X.texParameteri(this._type,10243,33071)),$Z&&$n&&$M.bindTexture($X,$Z,$n),this.memorySize=$G?$K*$x*4*(1+1/3):$K*$x*4},$K.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$K.disposeResource=function(){this._source&&($t.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$_($g,["magentaTexture",function(){var $X=new $g(new $vg(1,0,1,1));return $X.lock=!0,this.magentaTexture=$X},"grayTexture",function(){var $X=new $g(new $vg(.5,.5,.5,1));return $X.lock=!0,this.grayTexture=$X}]),$g}()),$bg=function($X){function $Z($X,$g,$K,$x){this._canRead=!1,this._image=null,this._pixels=null,void 0===$X&&($X=!1),void 0===$g&&($g=!0),void 0===$K&&($K=6408),void 0===$x&&($x=!0),$Z.__super.call(this),this._type=3553,this._repeat=$g,this._canRead=$X,this._format=$K,this._mipmap=$x}$V($Z,"laya.d3.resource.Texture2D",$tg);var $g=$Z.prototype;return $g._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $X=$t.mainContext,$g=this._source=$X.createTexture(),$K=this._width,$x=this._height,$Z=$M.curBindTexTarget,$n=$M.curBindTexValue;switch($M.bindTexture($X,this._type,$g),this._format){case 6407:case 6408:this._canRead?$X.texImage2D(this._type,0,this._format,$K,$x,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?$X.texImage2D(this._type,0,this._image._format,$K,$x,0,this._image._format,5121,this._image.atlasSource):$X.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case $t.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$X.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var $W=this._minFifter,$v=this._magFifter,$T=this._repeat?10497:33071,$G=0==this._wrapModeU?10497:33071,$c=0==this._wrapModeV?10497:33071,$_=$w.isPOT($K,$x);$_?(this._mipmap?-1!==$W||($W=9987):-1!==$W||($W=9729),-1!==$v||($v=9729),$X.texParameteri(this._type,10241,$W),$X.texParameteri(this._type,10240,$v),$X.texParameteri(this._type,10242,$T),$X.texParameteri(this._type,10243,$T),$X.texParameteri(this._type,10242,$G),$X.texParameteri(this._type,10243,$c),this._mipmap&&$X.generateMipmap(this._type)):(-1!==$W||($W=9729),-1!==$v||($v=9729),$X.texParameteri(this._type,10241,$W),$X.texParameteri(this._type,10240,$v),$X.texParameteri(this._type,10242,33071),$X.texParameteri(this._type,10243,33071)),$Z&&$n&&$M.bindTexture($X,$Z,$n),this._image.onload=null,this._image=null,this.memorySize=$_?$K*$x*4*(1+1/3):$K*$x*4},$g.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$g.onAsynLoaded=function($X,$g,$K){if($K){var $x=$K[0];void 0!==$x&&(this._canRead=$x);var $Z=$K[1];void 0!==$Z&&(this._repeat=$Z);var $n=$K[2];void 0!==$n&&(this._format=$n);var $W=$K[3];void 0!==$W&&(this._mipmap=$W);var $v=$K.wrapModeU;void 0!==$v&&(this._wrapModeU=$v);var $T=$K.wrapModeV;void 0!==$T&&(this._wrapModeV=$T)}switch(this._format){case 6407:case 6408:var $G=(this._image=$g).width,$c=$g.height;this._width=$G,this._height=$c,this._size=new $ag($G,$c),this._canRead&&($a.isConchApp?$g instanceof $s.HTMLElement&&(this._pixels=new Uint8Array($g.getImageData(0,0,$G,$c))):($P.canvas.size($G,$c),$P.canvas.clear(),$P.context.drawImage($g,0,0,$G,$c),this._pixels=new Uint8Array($P.context.getImageData(0,0,$G,$c).data.buffer)));break;case $t.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var $_=new $f($g);$_.readUTFBytes(4),$_.readUTFBytes(2),$_.getInt16();$_.endian="bigEndian",this._width=$_.getInt16(),this._height=$_.getInt16(),this._size=new $ag(this._width,this._height);$_.getInt16(),$_.getInt16();this._image=new Uint8Array($g,$_.pos)}this.recreateResource(),this._endLoaded()},$g.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},$g.disposeResource=function(){this._source&&($t.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},$A(0,$g,"_src",function(){return this.url}),$A(0,$g,"src",function(){return this.url}),$Z.load=function($X){return $Q.loader.create($X,null,null,$Z)},$Z}(),$Sg=function($g){function $K($X,$g){$K.__super.call(this),void 0===$X&&($X=.3),void 0===$g&&($g=1e3),this._tempVector3=new $Wg,this._position=new $Wg,this._up=new $Wg,this._forward=new $Wg,this._right=new $Wg,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=$ag.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=$X,this._farPlane=$g,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),$Q.stage.on("resize",this,this._onScreenSizeChanged)}$V($K,"laya.d3.core.BaseCamera",$g);var $X=$K.prototype;return $X._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var $X=this.scene._cameraPool,$g=$X.length-1,$K=0;$K<$g;$K++)if($X[$K].renderingOrder>$X[$g].renderingOrder){var $x=$X[$K];$X[$K]=$X[$g],$X[$g]=$x}},$X._calculateProjectionMatrix=function(){},$X._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},$X._prepareCameraToRender=function(){$N._currentCameraCullingMask=this.cullingMask;var $X=this._shaderValues;$X.setValue(0,this.transform.position.elements),$X.setValue(5,this.forward.elements),$X.setValue(6,this.up.elements)},$X._prepareCameraViewProject=function($X,$g){var $K=this._shaderValues;$K.setValue(1,$X.elements),$K.setValue(2,$g.elements)},$X._renderCamera=function($X,$g,$K){},$X.addLayer=function($X){29!==$X.number&&30!=$X.number&&(this.cullingMask=this.cullingMask|$X.mask)},$X.removeLayer=function($X){29!==$X.number&&30!=$X.number&&(this.cullingMask=this.cullingMask&~$X.mask)},$X.addAllLayers=function(){this.cullingMask=2147483647},$X.removeAllLayers=function(){this.cullingMask=0|$N.getLayerByNumber(29).mask|$N.getLayerByNumber(30).mask},$X.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},$X.moveForward=function($X){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=$X,this.transform.translate(this._tempVector3)},$X.moveRight=function($X){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=$X,this.transform.translate(this._tempVector3)},$X.moveVertical=function($X){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=$X,this.transform.translate(this._tempVector3,!1)},$X._addSelfRenderObjects=function(){var $X=this.scene._cameraPool,$g=$X.length;if(0<$g){for(var $K=$g-1;0<=$K;$K--)if(this.renderingOrder<=$X[$K].renderingOrder){$X.splice($K+1,0,this);break}}else $X.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},$X._clearSelfRenderObjects=function(){var $X=this.scene._cameraPool;$X.splice($X.indexOf(this),1)},$X.destroy=function($X){void 0===$X&&($X=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,$Q.stage.off("resize",this,this._onScreenSizeChanged),$g.prototype.destroy.call(this,$X)},$A(0,$X,"sky",function(){return this._sky},function($X){(this._sky=$X)._ownerCamera=this}),$A(0,$X,"forward",function(){var $X=this.transform.worldMatrix.elements,$g=this._forward.elements;return $g[0]=-$X[8],$g[1]=-$X[9],$g[2]=-$X[10],this._forward}),$A(0,$X,"position",function(){var $X=this.transform.worldMatrix.elements,$g=this._position.elements;return $g[0]=$X[12],$g[1]=$X[13],$g[2]=$X[14],this._position}),$A(0,$X,"renderTarget",function(){return this._renderTarget},function($X){null!=(this._renderTarget=$X)&&(this._renderTargetSize=$X.size)}),$A(0,$X,"up",function(){var $X=this.transform.worldMatrix.elements,$g=this._up.elements;return $g[0]=$X[4],$g[1]=$X[5],$g[2]=$X[6],this._up}),$A(0,$X,"right",function(){var $X=this.transform.worldMatrix.elements,$g=this._right.elements;return $g[0]=$X[0],$g[1]=$X[1],$g[2]=$X[2],this._right}),$A(0,$X,"renderTargetSize",function(){return this._renderTargetSize},function($X){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=$X,this._calculateProjectionMatrix()}),$A(0,$X,"fieldOfView",function(){return this._fieldOfView},function($X){this._fieldOfView=$X,this._calculateProjectionMatrix()}),$A(0,$X,"nearPlane",function(){return this._nearPlane},function($X){this._nearPlane=$X,this._calculateProjectionMatrix()}),$A(0,$X,"farPlane",function(){return this._farPlane},function($X){this._farPlane=$X,this._calculateProjectionMatrix()}),$A(0,$X,"orthographic",function(){return this._orthographic},function($X){this._orthographic=$X,this._calculateProjectionMatrix()}),$A(0,$X,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function($X){this._orthographicVerticalSize=$X,this._calculateProjectionMatrix()}),$A(0,$X,"renderingOrder",function(){return this._renderingOrder},function($X){this._renderingOrder=$X,this._sortCamerasByRenderingOrder()}),$K.CAMERAPOS=0,$K.VIEWMATRIX=1,$K.PROJECTMATRIX=2,$K.VPMATRIX=3,$K.VPMATRIX_NO_TRANSLATE=4,$K.CAMERADIRECTION=5,$K.CAMERAUP=6,$K.ENVIRONMENTDIFFUSE=7,$K.ENVIRONMENTSPECULAR=8,$K.SIMLODINFO=9,$K.DIFFUSEIRRADMATR=10,$K.DIFFUSEIRRADMATG=11,$K.DIFFUSEIRRADMATB=12,$K.HDREXPOSURE=13,$K.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",$K.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",$K.CLEARFLAG_SOLIDCOLOR=0,$K.CLEARFLAG_SKY=1,$K.CLEARFLAG_DEPTHONLY=2,$K.CLEARFLAG_NONE=3,$_($K,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new $Xg(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new $Xg},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new $Xg}]),$K}($Yg),$Rg=function($K){function $g($X){this._render=null,this._geometryFilter=null,$g.__super.call(this,$X)}$V($g,"laya.d3.core.RenderableSprite3D",$K);var $X=$g.prototype;return $X._addToInitStaticBatchManager=function(){},$X._setBelongScene=function($X){$K.prototype._setBelongScene.call(this,$X),$X._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},$X._setUnBelongScene=function(){var $X=this._scene._renderableSprite3Ds,$g=$X.indexOf(this);$X.splice($g,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),$K.prototype._setUnBelongScene.call(this)},$X._update=function($X){($X.owner=this)._activeInHierarchy&&(this._updateComponents($X),this._render._updateOctreeNode(),this._lateUpdateComponents($X),$B.spriteCount++,this._childs.length&&this._updateChilds($X))},$X.destroy=function($X){void 0===$X&&($X=!0),$K.prototype.destroy.call(this,$X),this._render._destroy(),this._render=null},$g.__init__=function(){$g.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=$g.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),$g.SAHDERDEFINE_LIGHTMAP=$g.shaderDefines.registerDefine("LIGHTMAP")},$g.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,$g.SAHDERDEFINE_LIGHTMAP=4,$g.LIGHTMAPSCALEOFFSET=2,$g.LIGHTMAP=3,$_($g,["shaderDefines",function(){return this.shaderDefines=new $cg}]),$g}($Yg),$jg=(function($X){function $x($X,$g,$K){this._long=NaN,this._width=NaN,this._height=NaN,void 0===$X&&($X=1),void 0===$g&&($g=1),void 0===$K&&($K=1),$x.__super.call(this),this._long=$X,this._width=$g,this._height=$K,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$V($x,"laya.d3.resource.models.BoxMesh",$ug);var $g=$x.prototype;$g.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var $X=$tX.vertexDeclaration,$g=($X.vertexStride,this._long/2),$K=this._height/2,$x=this._width/2,$Z=new Float32Array([-$g,$K,-$x,0,1,0,0,0,$g,$K,-$x,0,1,0,1,0,$g,$K,$x,0,1,0,1,1,-$g,$K,$x,0,1,0,0,1,-$g,-$K,-$x,0,-1,0,0,1,$g,-$K,-$x,0,-1,0,1,1,$g,-$K,$x,0,-1,0,1,0,-$g,-$K,$x,0,-1,0,0,0,-$g,$K,-$x,-1,0,0,0,0,-$g,$K,$x,-1,0,0,1,0,-$g,-$K,$x,-1,0,0,1,1,-$g,-$K,-$x,-1,0,0,0,1,$g,$K,-$x,1,0,0,1,0,$g,$K,$x,1,0,0,0,0,$g,-$K,$x,1,0,0,0,1,$g,-$K,-$x,1,0,0,1,1,-$g,$K,$x,0,0,1,0,0,$g,$K,$x,0,0,1,1,0,$g,-$K,$x,0,0,1,1,1,-$g,-$K,$x,0,0,1,0,1,-$g,$K,-$x,0,0,-1,1,0,$g,$K,-$x,0,0,-1,0,0,$g,-$K,-$x,0,0,-1,0,1,-$g,-$K,-$x,0,0,-1,1,1]),$n=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new $qg($X,this._numberVertices,35044,!0),this._indexBuffer=new $Lg("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData($Z),this._indexBuffer.setData($n),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$A(0,$g,"long",function(){return this._long},function($X){this._long!==$X&&(this._long=$X,this.releaseResource(),this.activeResource())}),$A(0,$g,"width",function(){return this._width},function($X){this._width!==$X&&(this._width=$X,this.releaseResource(),this.activeResource())}),$A(0,$g,"height",function(){return this._height},function($X){this._height!==$X&&(this._height=$X,this.releaseResource(),this.activeResource())})}(),function($X){function $Z($X,$g,$K,$x){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===$X&&($X=10),void 0===$g&&($g=10),void 0===$K&&($K=10),void 0===$x&&($x=10),$Z.__super.call(this),this._long=$X,this._width=$g,this._stacks=$K,this._slices=$x,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$V($Z,"laya.d3.resource.models.PlaneMesh",$ug);var $g=$Z.prototype;$g.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var $X=new Uint16Array(this._numberIndices),$g=$tX.vertexDeclaration,$K=$g.vertexStride/4,$x=new Float32Array(this._numberVertices*$K),$Z=this._long/2,$n=this._width/2,$W=this._long/this._stacks,$v=this._width/this._slices,$T=0,$G=0;$G<=this._slices;$G++)for(var $c=0;$c<=this._stacks;$c++)$x[$T++]=$c*$W-$Z,$x[$T++]=0,$x[$T++]=$G*$v-$n,$x[$T++]=0,$x[$T++]=1,$x[$T++]=0,$x[$T++]=1*$c/this._stacks,$x[$T++]=1*$G/this._slices;var $_=0;for($G=0;$G<this._slices;$G++)for($c=0;$c<this._stacks;$c++)$X[$_++]=($G+1)*(this._stacks+1)+$c,$X[$_++]=$G*(this._stacks+1)+$c,$X[$_++]=($G+1)*(this._stacks+1)+$c+1,$X[$_++]=$G*(this._stacks+1)+$c,$X[$_++]=$G*(this._stacks+1)+$c+1,$X[$_++]=($G+1)*(this._stacks+1)+$c+1;this._vertexBuffer=new $qg($g,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new $Lg("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData($x),this._indexBuffer.setData($X),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$A(0,$g,"long",function(){return this._long},function($X){this._long!==$X&&(this._long=$X,this.releaseResource(),this.activeResource())}),$A(0,$g,"width",function(){return this._width},function($X){this._width!==$X&&(this._width=$X,this.releaseResource(),this.activeResource())}),$A(0,$g,"stacks",function(){return this._stacks},function($X){this._stacks!==$X&&(this._stacks=$X,this.releaseResource(),this.activeResource())}),$A(0,$g,"slices",function(){return this._slices},function($X){this._slices!==$X&&(this._slices=$X,this.releaseResource(),this.activeResource())})}(),function($X){function $W($X,$g,$K){void 0===$X&&($X=0),void 0===$g&&($g=.3),void 0===$K&&($K=1e3),this._viewMatrix=new $Xg,this._projectionMatrix=new $Xg,this._projectionViewMatrix=new $Xg,this._viewport=new $Tg(0,0,0,0),this._normalizedViewport=new $Tg(0,0,1,1),this._aspectRatio=$X,this._boundFrustumUpdate=!0,this._boundFrustum=new $JX($Xg.DEFAULT),$W.__super.call(this,$g,$K),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}$V($W,"laya.d3.core.Camera",$Sg);var $g=$W.prototype;return $g._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},$g._parseCustomProps=function($X,$g,$K,$x){var $Z=$K.clearColor;this.clearColor=new $vg($Z[0],$Z[1],$Z[2],$Z[3]);var $n=$K.viewport;this.normalizedViewport=new $Tg($n[0],$n[1],$n[2],$n[3])},$g._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var $X=this.orthographicVerticalSize*this.aspectRatio*.5,$g=.5*this.orthographicVerticalSize;$Xg.createOrthoOffCenterRH(-$X,$X,-$g,$g,this.nearPlane,this.farPlane,this._projectionMatrix)}else $Xg.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},$g._update=function($X){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,$X)},$g._renderCamera=function($X,$g,$K){var $x,$Z;$K.parallelSplitShadowMaps[0]&&$K._renderShadowMap($X,$g,this),($g.camera=this)._prepareCameraToRender(),$K._preRenderUpdateComponents($g),$x=$g._viewMatrix=this.viewMatrix;var $n=this._renderTarget;$n?($n.start(),$Xg.multiply($Sg._invertYScaleMatrix,this._projectionMatrix,$Sg._invertYProjectionMatrix),$Xg.multiply($Sg._invertYScaleMatrix,this.projectionViewMatrix,$Sg._invertYProjectionViewMatrix),$Z=$g._projectionMatrix=$Sg._invertYProjectionMatrix,$g._projectionViewMatrix=$Sg._invertYProjectionViewMatrix):($Z=$g._projectionMatrix=this._projectionMatrix,$g._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject($x,$Z),$g._viewport=this.viewport,$K._preRenderScene($X,$g,this.boundFrustum),$K._clear($X,$g),$K._renderScene($X,$g),$K._postRenderUpdateComponents($g),$n&&$n.end()},$g.viewportPointToRay=function($X,$g){$Ag.calculateCursorRay($X,this.viewport,this._projectionMatrix,this.viewMatrix,null,$g)},$g.normalizedViewportPointToRay=function($X,$g){var $K=$W._tempVector20,$x=this.viewport,$Z=$X.elements,$n=$K.elements;$n[0]=$Z[0]*$x.width,$n[1]=$Z[1]*$x.height,$Ag.calculateCursorRay($K,this.viewport,this._projectionMatrix,this.viewMatrix,null,$g)},$g.worldToViewportPoint=function($X,$g){$Xg.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project($X,this._projectionViewMatrix,$g);var $K=$g.elements;$K[0]=$K[0]/$Q.stage.clientScaleX,$K[1]=$K[1]/$Q.stage.clientScaleY},$g.worldToNormalizedViewportPoint=function($X,$g){$Xg.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project($X,this._projectionViewMatrix,$g);var $K=$g.elements;$K[0]=$K[0]/$Q.stage.clientScaleX,$K[1]=$K[1]/$Q.stage.clientScaleY},$g.convertScreenCoordToOrthographicCoord=function($X,$g){if(this._orthographic){var $K=$h.clientWidth,$x=$h.clientHeight,$Z=this.orthographicVerticalSize*this.aspectRatio/$K,$n=this.orthographicVerticalSize/$x,$W=$X.elements,$v=$g.elements;return $v[0]=(-$K/2+$W[0])*$Z,$v[1]=($x/2-$W[1])*$n,$v[2]=(this.nearPlane-this.farPlane)*($W[2]+1)/2-this.nearPlane,$Wg.transformCoordinate($g,this.transform.worldMatrix,$g),!0}return!1},$A(0,$g,"projectionViewMatrix",function(){return $Xg.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),$A(0,$g,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var $X=this.viewport;return $X.width/$X.height},function($X){if($X<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=$X,this._calculateProjectionMatrix()}),$A(0,$g,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),$A(0,$g,"needViewport",function(){var $X=this.normalizedViewport;return 0===$X.x&&0===$X.y&&1===$X.width&&1===$X.height}),$A(0,$g,"viewport",function(){if(this._viewportExpressedInClipSpace){var $X=this._normalizedViewport,$g=this.renderTargetSize,$K=$g.width,$x=$g.height;this._viewport.x=$X.x*$K,this._viewport.y=$X.y*$x,this._viewport.width=$X.width*$K,this._viewport.height=$X.height*$x}return this._viewport},function($X){if(null!=this.renderTarget&&($X.x<0||$X.y<0||0==$X.width||0==$X.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=$X,this._calculateProjectionMatrix()}),$A(0,$g,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var $X=this._viewport,$g=this.renderTargetSize,$K=$g.width,$x=$g.height;this._normalizedViewport.x=$X.x/$K,this._normalizedViewport.y=$X.y/$x,this._normalizedViewport.width=$X.width/$K,this._normalizedViewport.height=$X.height/$x}return this._normalizedViewport},function($X){$X.x<0&&($X.x=0,console.warn("Camera: viewport.x must large than 0.0.")),$X.y<0&&($X.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<$X.x+$X.width&&($X.width=1-$X.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<$X.y+$X.height&&($X.height=1-$X.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=$X,this._calculateProjectionMatrix()}),$A(0,$g,"projectionMatrix",function(){return this._projectionMatrix},function($X){this._projectionMatrix=$X,this._useUserProjectionMatrix=!0}),$A(0,$g,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),$_($W,["_tempVector20",function(){return this._tempVector20=new $ng}]),$W}()),$dg=function($K){function $x($X,$g){$x.__super.call(this,$g),this._geometryFilter=new $Pg(this),this._render=new $Ng(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),$X&&(this._geometryFilter.sharedMesh=$X)instanceof laya.d3.resource.models.Mesh&&($X.loaded?this._render.sharedMaterials=$X.materials:$X.once("loaded",this,this._applyMeshMaterials))}$V($x,"laya.d3.core.MeshSprite3D",$K);var $X=$x.prototype;return $X._changeRenderObjectByMesh=function($X){var $g=this._render._renderElements,$K=$g[$X];$K||($K=$g[$X]=new $Dg),$K._render=this._render;var $x=this._render.sharedMaterials[$X];$x||($x=$pg.defaultMaterial);var $Z=this._geometryFilter.sharedMesh.getRenderElement($X);return $K._mainSortID=this._getSortID($Z,$x),$K._sprite3D=this,$K.renderObj=$Z,$K._material=$x,$K},$X._changeRenderObjectByMaterial=function($X,$g){var $K=this._render._renderElements[$X];$g||($g=$pg.defaultMaterial);var $x=this._geometryFilter.sharedMesh.getRenderElement($X);return $K._mainSortID=this._getSortID($x,$g),$K._sprite3D=this,$K.renderObj=$x,$K._material=$g,$K},$X._changeRenderObjectsByMesh=function(){var $X=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=$X;for(var $g=0;$g<$X;$g++)this._changeRenderObjectByMesh($g)},$X._onMeshChanged=function($X){var $g=$X.sharedMesh;$g.loaded?this._changeRenderObjectsByMesh():$g.once("loaded",this,this._onMeshLoaded)},$X._onMeshLoaded=function($X){$X===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},$X._onMaterialChanged=function($X,$g,$K){$g<this._render._renderElements.length&&this._changeRenderObjectByMaterial($g,$K)},$X._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},$X._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},$X._parseCustomProps=function($X,$g,$K,$x){var $Z=this.meshRender,$n=$K.lightmapIndex;null!=$n&&($Z.lightmapIndex=$n);var $W,$v,$T=$K.lightmapScaleOffset;if($T&&($Z.lightmapScaleOffset=new $vg($T[0],$T[1],$T[2],$T[3])),$x.instanceParams)($W=$x.instanceParams.loadPath)&&($v=$F.getRes($g[$W]),(this.meshFilter.sharedMesh=$v).loaded?$Z.sharedMaterials=$v.materials:$v.once("loaded",this,this._applyMeshMaterials));else{($W=$K.meshPath)&&($v=$F.getRes($g[$W]),this.meshFilter.sharedMesh=$v);var $G=$K.materials;if($G){var $c=$Z.sharedMaterials,$_=$G.length;$c.length=$_;for(var $s=0;$s<$_;$s++)$c[$s]=$F.getRes($g[$G[$s].path]);$Z.sharedMaterials=$c}}},$X._applyMeshMaterials=function($X){for(var $g=this._render.sharedMaterials,$K=$X.materials,$x=0,$Z=$K.length;$x<$Z;$x++)$g[$x]||($g[$x]=$K[$x]);this._render.sharedMaterials=$g},$X._addToInitStaticBatchManager=function(){$x._staticBatchManager._addInitBatchSprite(this)},$X.cloneTo=function($X){var $g=$X;$g._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var $K=this._render,$x=$g._render;$x.enable=$K.enable,$x.sharedMaterials=$K.sharedMaterials,$x.castShadow=$K.castShadow;var $Z=$K.lightmapScaleOffset;$Z&&($x.lightmapScaleOffset=$Z.clone()),$x.lightmapIndex=$K.lightmapIndex,$x.receiveShadow=$K.receiveShadow,$x.sortingFudge=$K.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,$X)},$X.destroy=function($X){if(void 0===$X&&($X=!0),!this.destroyed){var $g=this.meshFilter.sharedMesh;null!=$g&&($g.loaded||$g.off("loaded",this,this._applyMeshMaterials)),$K.prototype.destroy.call(this,$X),this._geometryFilter._destroy()}},$A(0,$X,"meshFilter",function(){return this._geometryFilter}),$A(0,$X,"meshRender",function(){return this._render}),$x.__init__=function(){$xX._staticBatchManagers.push($x._staticBatchManager)},$x.load=function($X){return $Q.loader.create($X,null,null,$x)},$_($x,["_staticBatchManager",function(){return this._staticBatchManager=new $ig}]),$x}($Rg)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($X,$g){"use strict";for(var $K in Object.defineProperty($g,"__esModule",{value:!0}),Laya){var $x=Laya[$K];$x&&$x.__isclass&&($g[$K]=$x)}}),function($X,$g,$ZX){$ZX.un,$ZX.uns;var $K=$ZX.static,$x=$ZX.class,$n=$ZX.getset,$a=$ZX.__newvec,$v=laya.maths.Bezier,$_=laya.utils.Browser,$tX=laya.utils.Byte,$Z=(laya.events.Event,laya.events.EventDispatcher),$W=laya.display.Graphics,$T=(laya.resource.HTMLCanvas,laya.utils.Handler),$G=laya.net.Loader,$s=laya.maths.MathUtil,$MX=laya.maths.Matrix,$m=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),$c=(laya.renders.RenderContext,laya.resource.Resource),$V=laya.utils.RunDriver,$nX=laya.display.Sprite,$A=laya.utils.Stat,$PX=laya.resource.Texture,$F=(laya.net.URL,laya.utils.Utils),$M=function(){function $X(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return $x($X,"laya.ani.AnimationContent"),$X}(),$P=function(){function $X(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return $x($X,"laya.ani.AnimationNodeContent"),$X}(),$$=function(){function $X(){}return $x($X,"laya.ani.AnimationParser01"),$X.parse=function($X,$g){var $K=$g.__getBuffer(),$x=0,$Z=0,$n=0,$W=0,$v=0,$T=0,$G=0,$c=$g.readUTFString();$X._aniClassName=$c;var $_,$s=$g.readUTFString().split("\n"),$V=$g.getUint8(),$A=$g.getUint32(),$a=$g.getUint32();0<$A&&($_=$K.slice($A,$a));var $m=new $tX($_);for(0<$a&&($X._publicExtData=$K.slice($a,$K.byteLength)),$X._useParent=!!$g.getUint8(),$X._anis.length=$V,$x=0;$x<$V;$x++){var $F=$X._anis[$x]=new $M;$F.nodes=new Array;var $U=$F.name=$s[$g.getUint16()];$X._aniMap[$U]=$x,$F.bone3DMap={},$F.playTime=$g.getFloat32(),$F.playTime<=0&&console.error("播放时间不能为0  url="+$X.url+" name="+$F.name);var $$=$F.nodes.length=$g.getUint8();for($Z=$F.totalKeyframeDatasLength=0;$Z<$$;$Z++){var $w=$F.nodes[$Z]=new $P;$w.childs=[];var $Q=$g.getInt16();0<=$Q&&($w.name=$s[$Q],$F.bone3DMap[$w.name]=$Z),$w.keyFrame=new Array,$w.parentIndex=$g.getInt16(),-1==$w.parentIndex?$w.parent=null:$w.parent=$F.nodes[$w.parentIndex],$w.lerpType=$g.getUint8();var $f=$g.getUint32();$m.pos=$f;var $D=$w.keyframeWidth=$m.getUint16();if($F.totalKeyframeDatasLength+=$D,0===$w.lerpType||1===$w.lerpType)for($w.interpolationMethod=[],$w.interpolationMethod.length=$D,$n=0;$n<$D;$n++)$w.interpolationMethod[$n]=$Y.interpolation[$m.getUint8()];null!=$w.parent&&$w.parent.childs.push($w);var $B=$g.getUint16();0<$B&&($w.extenData=$K.slice($g.pos,$g.pos+$B),$g.pos+=$B);var $i,$k=$g.getUint16(),$I=0;for($n=0,$W=$w.keyFrame.length=$k;$n<$W;$n++){if(($i=$w.keyFrame[$n]=new $N).duration=$g.getFloat32(),$i.startTime=$I,2===$w.lerpType){$i.interpolationData=[];var $r,$t=$g.getUint8();switch($r=$g.getFloat32()){case 254:for($i.interpolationData.length=$D,$G=0;$G<$D;$G++)$i.interpolationData[$G]=0;break;case 255:for($i.interpolationData.length=$D,$G=0;$G<$D;$G++)$i.interpolationData[$G]=5;break;default:for($i.interpolationData.push($r),$T=1;$T<$t;$T++)$i.interpolationData.push($g.getFloat32())}}for($i.data=new Float32Array($D),$v=0;$v<$D;$v++)$i.data[$v]=$g.getFloat32(),-1e-8<$i.data[$v]&&$i.data[$v]<1e-8&&($i.data[$v]=0);$I+=$i.duration}$i.startTime=$F.playTime,$w.playTime=$F.playTime,$X._calculateKeyFrame($w,$k,$D)}}},$X}(),$w=function(){function $Q(){}return $x($Q,"laya.ani.AnimationParser02"),$Q.READ_DATA=function(){$Q._DATA.offset=$Q._reader.getUint32(),$Q._DATA.size=$Q._reader.getUint32()},$Q.READ_BLOCK=function(){for(var $X=$Q._BLOCK.count=$Q._reader.getUint16(),$g=$Q._BLOCK.blockStarts=[],$K=$Q._BLOCK.blockLengths=[],$x=0;$x<$X;$x++)$g.push($Q._reader.getUint32()),$K.push($Q._reader.getUint32())},$Q.READ_STRINGS=function(){var $X=$Q._reader.getUint32(),$g=$Q._reader.getUint16(),$K=$Q._reader.pos;$Q._reader.pos=$X+$Q._DATA.offset;for(var $x=0;$x<$g;$x++)$Q._strings[$x]=$Q._reader.readUTFString();$Q._reader.pos=$K},$Q.parse=function($X,$g){$Q._templet=$X;($Q._reader=$g).__getBuffer();$Q.READ_DATA(),$Q.READ_BLOCK(),$Q.READ_STRINGS();for(var $K=0,$x=$Q._BLOCK.count;$K<$x;$K++){var $Z=$g.getUint16(),$n=$Q._strings[$Z],$W=$Q["READ_"+$n];if(null==$W)throw new Error("model file err,no this function:"+$Z+" "+$n);$W.call()}},$Q.READ_ANIMATIONS=function(){var $X=$Q._reader,$g=$X.__getBuffer(),$K=0,$x=0,$Z=0,$n=0,$W=$X.getUint16(),$v=[];for($v.length=$W,$K=0;$K<$W;$K++)$v[$K]=$Y.interpolation[$X.getByte()];var $T=$X.getUint8();for($Q._templet._anis.length=$T,$K=0;$K<$T;$K++){var $G=$Q._templet._anis[$K]={};$G.nodes=new Array;var $c=$G.name=$Q._strings[$X.getUint16()];$Q._templet._aniMap[$c]=$K,$G.bone3DMap={},$G.playTime=$X.getFloat32();var $_=$G.nodes.length=$X.getInt16();for($x=$G.totalKeyframeDatasLength=0;$x<$_;$x++){var $s=$G.nodes[$x]={};$s.keyframeWidth=$W,$s.childs=[];var $V=$X.getUint16();0<=$V&&($s.name=$Q._strings[$V],$G.bone3DMap[$s.name]=$x),$s.keyFrame=new Array,$s.parentIndex=$X.getInt16(),-1==$s.parentIndex?$s.parent=null:$s.parent=$G.nodes[$s.parentIndex],$G.totalKeyframeDatasLength+=$W,$s.interpolationMethod=$v,null!=$s.parent&&$s.parent.childs.push($s);var $A=$X.getUint16(),$a=null,$m=null;for($Z=0,$n=$s.keyFrame.length=$A;$Z<$n;$Z++){($a=$s.keyFrame[$Z]={}).startTime=$X.getFloat32(),$m&&($m.duration=$a.startTime-$m.startTime);var $F=$Q._DATA.offset,$U=$X.getUint32(),$$=4*$W,$w=$g.slice($F+$U,$F+$U+$$);$a.data=new Float32Array($w),$m=$a}$a.duration=0,$s.playTime=$G.playTime,$Q._templet._calculateKeyFrame($s,$A,$W)}}},$Q._templet=null,$Q._reader=null,$Q._strings=[],$K($Q,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$Q}(),$NX=(function(){function $X(){}$x($X,"laya.ani.AnimationState"),$X.stopped=0,$X.paused=1,$X.playing=2}(),function(){function $Z(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new $RX,this.resultMatrix=new $MX,this._children=[]}$x($Z,"laya.ani.bone.Bone");var $X=$Z.prototype;return $X.setTempMatrix=function($X){this._tempMatrix=$X;var $g,$K=0;for($K=0,$g=this._children.length;$K<$g;$K++)this._children[$K].setTempMatrix(this._tempMatrix)},$X.update=function($X){var $g;if(this.rotation=this.transform.skX,$X)$g=this.resultTransform.getMatrix(),$MX.mul($g,$X,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)$g=this.resultTransform.getMatrix(),$MX.mul($g,this.parentBone.resultMatrix,this.resultMatrix);else{var $K=this.parentBone,$x=NaN,$Z=NaN,$n=NaN,$W=this.parentBone.resultMatrix;$g=this.resultTransform.getMatrix();var $v=$W.a*$g.tx+$W.c*$g.ty+$W.tx,$T=$W.b*$g.tx+$W.d*$g.ty+$W.ty,$G=new $MX;this.inheritRotation?($x=Math.atan2($K.resultMatrix.b,$K.resultMatrix.a),$Z=Math.cos($x),$n=Math.sin($x),$G.setTo($Z,$n,-$n,$Z,0,0),$MX.mul(this._tempMatrix,$G,$MX.TEMP),$MX.TEMP.copyTo($G),$g=this.resultTransform.getMatrix(),$MX.mul($g,$G,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,$g=this.resultTransform.getMatrix(),$MX.TEMP.identity(),$MX.TEMP.d=this.d,$MX.mul($g,$MX.TEMP,this.resultMatrix)),this.resultMatrix.tx=$v,this.resultMatrix.ty=$T}else($g=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var $c,$_=0;for($_=0,$c=this._children.length;$_<$c;$_++)this._children[$_].update()},$X.updateChild=function(){var $X,$g=0;for($g=0,$X=this._children.length;$g<$X;$g++)this._children[$g].update()},$X.setRotation=function($X){this._sprite&&(this._sprite.rotation=180*$X/Math.PI)},$X.updateDraw=function($X,$g){$Z.ShowBones&&!$Z.ShowBones[this.name]||(this._sprite||(this._sprite=new $nX,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),$ZX.stage.addChild(this._sprite)),this._sprite.x=$X+this.resultMatrix.tx,this._sprite.y=$g+this.resultMatrix.ty);var $K,$x=0;for($x=0,$K=this._children.length;$x<$K;$x++)this._children[$x].updateDraw($X,$g)},$X.addChild=function($X){this._children.push($X),$X.parentBone=this},$X.findBone=function($X){if(this.name==$X)return this;var $g,$K,$x=0;for($x=0,$g=this._children.length;$x<$g;$x++)if($K=this._children[$x].findBone($X))return $K;return null},$X.localToWorld=function($X){var $g=$X[0],$K=$X[1];$X[0]=$g*this.resultMatrix.a+$K*this.resultMatrix.c+this.resultMatrix.tx,$X[1]=$g*this.resultMatrix.b+$K*this.resultMatrix.d+this.resultMatrix.ty},$Z.ShowBones={},$Z}()),$CX=function(){function $a(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}$x($a,"laya.ani.bone.BoneSlot");var $X=$a.prototype;return $X.showSlotData=function($X,$g){void 0===$g&&($g=!0),this.currSlotData=$X,$g&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},$X.showDisplayByName=function($X){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName($X))},$X.replaceDisplayByName=function($X,$g){if(this.currSlotData){var $K;$K=this.currSlotData.getDisplayByName($X);var $x;$x=this.currSlotData.getDisplayByName($g),this.replaceDisplayByIndex($K,$x)}},$X.replaceDisplayByIndex=function($X,$g){this.currSlotData&&(this._replaceDic[$X]=$g,this.displayIndex==$X&&this.showDisplayByIndex($X))},$X.showDisplayByIndex=function($X){if(null!=this._replaceDic[$X]&&($X=this._replaceDic[$X]),this.currSlotData&&-1<$X&&$X<this.currSlotData.displayArr.length){if(this.displayIndex=$X,this.currDisplayData=this.currSlotData.displayArr[$X],this.currDisplayData){var $g=this.currDisplayData.name;this.currTexture=this.templet.getTexture($g),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!$m.isConchApp||$m.isConchApp&&"0.9.15"<$nX.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},$X.replaceSkin=function($X){this._diyTexture=$X,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},$X.setParentMatrix=function($X){this._parentMatrix=$X},$X.draw=function($X,$g,$K,$x){if(void 0===$K&&($K=!1),void 0===$x&&($x=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var $Z,$n=this.currTexture;switch(this._diyTexture&&($n=this._diyTexture),this.currDisplayData.type){case 0:if($X){var $W=this.getDisplayMatrix();if(this._parentMatrix){var $v=!1;if($W){var $T;if($MX.mul($W,this._parentMatrix,$MX.TEMP),$T=$K?(null==this._resultMatrix&&(this._resultMatrix=new $MX),this._resultMatrix):new $MX,!$m.isWebGL&&this.currDisplayData.uvs||$m.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var $G=$a._tempMatrix;$G.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($G.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($v=!0,$G.rotate(-Math.PI/2)),$MX.mul($G,$MX.TEMP,$T)}else $MX.TEMP.copyTo($T);$v?$X.drawTexture($n,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,$T):$X.drawTexture($n,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,$T)}}}break;case 1:if(null==($Z=$K?(null==this._skinSprite&&(this._skinSprite=$a.createSkinMesh()),this._skinSprite):$a.createSkinMesh()))return;var $c;if(null==this.currDisplayData.bones){var $_,$s=this.currDisplayData.weights;this.deformData&&($s=this.deformData),$_=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$D.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$D.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=$s;this.currDisplayData.triangles.length;$c=this.currDisplayData.triangles,$Z.init2($n,null,$c,this._mVerticleArr,$_);var $V,$A=this.getDisplayMatrix();if(this._parentMatrix)if($A)$MX.mul($A,this._parentMatrix,$MX.TEMP),$V=$K?(null==this._resultMatrix&&(this._resultMatrix=new $MX),this._resultMatrix):new $MX,$MX.TEMP.copyTo($V),$Z.transform=$V}else this.skinMesh($g,$Z,$x);$X.drawSkin($Z);break;case 2:if(null==($Z=$K?(null==this._skinSprite&&(this._skinSprite=$a.createSkinMesh()),this._skinSprite):$a.createSkinMesh()))return;this.skinMesh($g,$Z,$x),$X.drawSkin($Z)}}},$X.skinMesh=function($X,$g,$K){var $x,$Z=this.currTexture,$n=this.currDisplayData.bones;$x=this._diyTexture?($Z=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$D.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$D.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var $W,$v,$T=this.currDisplayData.weights,$G=this.currDisplayData.triangles,$c=0,$_=0,$s=0,$V=NaN,$A=NaN,$a=0,$m=0,$F=[],$U=0,$$=0;if(this.deformData&&0<this.deformData.length){var $w=0;for($U=0,$$=$n.length;$U<$$;){for($s=$n[$U++]+$U,$_=$c=0;$U<$s;$U++)$v=$X[$n[$U]],$V=$T[$a]+this.deformData[$w++],$A=$T[$a+1]+this.deformData[$w++],$m=$T[$a+2],$c+=($V*$v.a+$A*$v.c+$v.tx)*$m,$_+=($V*$v.b+$A*$v.d+$v.ty)*$m,$a+=3;$F.push($c,$_)}}else for($U=0,$$=$n.length;$U<$$;){for($s=$n[$U++]+$U,$_=$c=0;$U<$s;$U++)$v=$X[$n[$U]],$V=$T[$a],$A=$T[$a+1],$m=$T[$a+2],$c+=($V*$v.a+$A*$v.c+$v.tx)*$m,$_+=($V*$v.b+$A*$v.d+$v.ty)*$m,$a+=3;$F.push($c,$_)}this._mVerticleArr=$F,$W=$G,$g.init2($Z,null,$W,this._mVerticleArr,$x)},$X.drawBonePoint=function($X){$X&&this._parentMatrix&&$X.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},$X.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},$X.getMatrix=function(){return this._resultMatrix},$X.copy=function(){var $X=new $a;return $X.type="copy",$X.name=this.name,$X.attachmentName=this.attachmentName,$X.srcDisplayIndex=this.srcDisplayIndex,$X.parent=this.parent,$X.displayIndex=this.displayIndex,$X.templet=this.templet,$X.currSlotData=this.currSlotData,$X.currTexture=this.currTexture,$X.currDisplayData=this.currDisplayData,$X},$a.createSkinMesh=function(){return $m.isWebGL||$m.isConchApp?$V.skinAniSprite():($m.isWebGL,null)},$K($a,["_tempMatrix",function(){return this._tempMatrix=new $MX}]),$a}(),$YX=function(){function $X(){this.skinName=null,this.deformSlotDataList=[]}return $x($X,"laya.ani.bone.DeformAniData"),$X}(),$lX=function(){function $X(){this.deformSlotDisplayList=[]}return $x($X,"laya.ani.bone.DeformSlotData"),$X}(),$pX=function(){function $X(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}$x($X,"laya.ani.bone.DeformSlotDisplayData");var $g=$X.prototype;return $g.binarySearch1=function($X,$g){var $K=0,$x=$X.length-2;if(0==$x)return 1;for(var $Z=$x>>>1;;){if($X[Math.floor($Z+1)]<=$g?$K=$Z+1:$x=$Z,$K==$x)return $K+1;$Z=$K+$x>>>1}return 0},$g.apply=function($X,$g,$K){if(void 0===$K&&($K=1),$X+=.05,!(this.timeList.length<=0)){var $x=0;if(!($X<this.timeList[0])){var $Z=this.vectices[0].length,$n=[],$W=this.binarySearch1(this.timeList,$X);if(this.frameIndex=$W,$X>=this.timeList[this.timeList.length-1]){var $v=this.vectices[this.vectices.length-1];if($K<1)for($x=0;$x<$Z;$x++)$n[$x]+=($v[$x]-$n[$x])*$K;else for($x=0;$x<$Z;$x++)$n[$x]=$v[$x];this.deformData=$n}else{this.tweenKeyList[this.frameIndex];var $T=this.vectices[this.frameIndex-1],$G=this.vectices[this.frameIndex],$c=this.timeList[this.frameIndex-1],$_=this.timeList[this.frameIndex];$K=this.tweenKeyList[$W-1]?($X-$c)/($_-$c):0;var $s=NaN;for($x=0;$x<$Z;$x++)$s=$T[$x],$n[$x]=$s+($G[$x]-$s)*$K;this.deformData=$n}}}},$X}(),$LX=function(){function $X(){this.time=NaN,this.drawOrder=[]}return $x($X,"laya.ani.bone.DrawOrderData"),$X}(),$qX=function(){function $X(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return $x($X,"laya.ani.bone.EventData"),$X}(),$U=function(){function $xX($X,$g){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=$X,this._targetBone=$g[$X.targetBoneIndex],this.isSpine=$X.isSpine,null==this._bones&&(this._bones=[]);for(var $K=this._bones.length=0,$x=$X.boneIndexs.length;$K<$x;$K++)this._bones.push($g[$X.boneIndexs[$K]]);this.name=$X.name,this.mix=$X.mix,this.bendDirection=$X.bendDirection}$x($xX,"laya.ani.bone.IkConstraint");var $X=$xX.prototype;return $X.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},$X._applyIk1=function($X,$g,$K,$x){var $Z=$X.parentBone,$n=1/($Z.resultMatrix.a*$Z.resultMatrix.d-$Z.resultMatrix.b*$Z.resultMatrix.c),$W=$g-$Z.resultMatrix.tx,$v=$K-$Z.resultMatrix.ty,$T=($W*$Z.resultMatrix.d-$v*$Z.resultMatrix.c)*$n-$X.transform.x,$G=($v*$Z.resultMatrix.a-$W*$Z.resultMatrix.b)*$n-$X.transform.y,$c=Math.atan2($G,$T)*$xX.radDeg-0-$X.transform.skX;$X.transform.scX<0&&($c+=180),180<$c?$c-=360:$c<-180&&($c+=360),$X.transform.skX=$X.transform.skY=$X.transform.skX+$c*$x,$X.update()},$X.updatePos=function($X,$g){this._sp&&this._sp.pos($X,$g)},$X._applyIk2=function($X,$g,$K,$x,$Z,$n){if(0!=$n){var $W=$X.resultTransform.x,$v=$X.resultTransform.y,$T=$X.transform.scX,$G=$X.transform.scY,$c=$g.transform.scX,$_=0,$s=0,$V=0;$V=$T<0?($T=-$T,$_=180,-1):($_=0,1),$G<0&&($G=-$G,$V=-$V),$s=$c<0?($c=-$c,180):0;var $A=$g.resultTransform.x,$a=NaN,$m=NaN,$F=NaN,$U=$X.resultMatrix.a,$$=$X.resultMatrix.c,$w=$X.resultMatrix.b,$Q=$X.resultMatrix.d,$f=Math.abs($T-$G)<=1e-4;$F=$f?($m=$U*$A+$$*($a=$g.resultTransform.y)+$X.resultMatrix.tx,$w*$A+$Q*$a+$X.resultMatrix.ty):($a=0,$m=$U*$A+$X.resultMatrix.tx,$w*$A+$X.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new $nX,$ZX.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($K,$x,15,"#ffff00"),this._sp.graphics.drawCircle($m,$F,15,"#ff00ff")),$X.setRotation(Math.atan2($F-$X.resultMatrix.ty,$m-$X.resultMatrix.tx));var $D=$X.parentBone;$U=$D.resultMatrix.a,$$=$D.resultMatrix.c,$w=$D.resultMatrix.b;var $B=1/($U*($Q=$D.resultMatrix.d)-$$*$w),$i=$K-$D.resultMatrix.tx,$k=$x-$D.resultMatrix.ty,$I=($i*$Q-$k*$$)*$B-$W,$r=($k*$U-$i*$w)*$B-$v,$t=(($i=$m-$D.resultMatrix.tx)*$Q-($k=$F-$D.resultMatrix.ty)*$$)*$B-$W,$M=($k*$U-$i*$w)*$B-$v,$P=Math.sqrt($t*$t+$M*$M),$N=$g.length*$c,$C=NaN,$Y=NaN;if($f){var $l=($I*$I+$r*$r-$P*$P-($N*=$T)*$N)/(2*$P*$N);$l<-1?$l=-1:1<$l&&($l=1),$Y=Math.acos($l)*$Z,$U=$P+$N*$l,$$=$N*Math.sin($Y),$C=Math.atan2($r*$U-$I*$$,$I*$U+$r*$$)}else{var $p=($U=$T*$N)*$U,$L=($$=$G*$N)*$$,$q=$I*$I+$r*$r,$E=Math.atan2($r,$I),$u=-2*$L*$P,$O=$L-$p;if(0<($Q=$u*$u-4*$O*($w=$L*$P*$P+$p*$q-$p*$L))){var $e=Math.sqrt($Q);$u<0&&($e=-$e);var $b=($e=-($u+$e)/2)/$O,$S=$w/$e,$R=Math.abs($b)<Math.abs($S)?$b:$S;$R*$R<=$q&&($k=Math.sqrt($q-$R*$R)*$Z,$C=$E-Math.atan2($k,$R),$Y=Math.atan2($k/$G,($R-$P)/$T))}var $j=0,$d=Number.MAX_VALUE,$h=0,$z=0,$J=0,$o=0,$H=0,$y=0;$o<($Q=($i=$P+$U)*$i)&&($J=0,$o=$Q,$H=$i),($Q=($i=$P-$U)*$i)<$d&&($j=Math.PI,$d=$Q,$h=$i);var $XX=Math.acos(-$U*$P/($p-$L));($Q=($i=$U*Math.cos($XX)+$P)*$i+($k=$$*Math.sin($XX))*$k)<$d&&($j=$XX,$d=$Q,$h=$i,$z=$k),$o<$Q&&($J=$XX,$o=$Q,$H=$i,$y=$k),$Y=$q<=($d+$o)/2?($C=$E-Math.atan2($z*$Z,$h),$j*$Z):($C=$E-Math.atan2($y*$Z,$H),$J*$Z)}var $gX=Math.atan2($a,$A)*$V,$KX=$X.resultTransform.skX;180<($C=($C-$gX)*$xX.radDeg+$_-$KX)?$C-=360:$C<-180&&($C+=360),$X.resultTransform.x=$W,$X.resultTransform.y=$v,$X.resultTransform.skX=$X.resultTransform.skY=$KX+$C*$n,$KX=$g.resultTransform.skX,180<($Y=(($Y+$gX)*$xX.radDeg-0)*$V+$s-($KX%=360))?$Y-=360:$Y<-180&&($Y+=360),$g.resultTransform.x=$A,$g.resultTransform.y=$a,$g.resultTransform.skX=$g.resultTransform.skY=$g.resultTransform.skY+$Y*$n,$X.update()}},$X._applyIk3=function($X,$g,$K,$x,$Z,$n){if(0!=$n){var $W,$v,$T=$g.resultMatrix.a*$g.length,$G=$g.resultMatrix.b*$g.length,$c=$T*$T+$G*$G,$_=Math.sqrt($c),$s=$X.resultMatrix.tx,$V=$X.resultMatrix.ty,$A=$g.resultMatrix.tx,$a=$g.resultMatrix.ty,$m=$A-$s,$F=$a-$V,$U=$m*$m+$F*$F,$$=Math.sqrt($U),$w=($m=$K-$X.resultMatrix.tx)*$m+($F=$x-$X.resultMatrix.ty)*$F,$Q=Math.sqrt($w);if($_+$$<=$Q||$Q+$_<=$$||$Q+$$<=$_){var $f=NaN;$A=$s+($f=$_+$$<=$Q?1:-1)*($K-$s)*$$/$Q,$a=$V+$f*($x-$V)*$$/$Q}else{var $D=($U-$c+$w)/(2*$w),$B=Math.sqrt($U-$D*$D*$w)/$Q,$i=$s+$m*$D,$k=$V+$F*$D,$I=-$F*$B,$r=$m*$B;$a=0<$Z?($A=$i-$I,$k-$r):($A=$i+$I,$k+$r)}$W=$A,$v=$a,this.isDebug&&(this._sp||(this._sp=new $nX,$ZX.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($s,$V,15,"#ff00ff"),this._sp.graphics.drawCircle($K,$x,15,"#ffff00"),this._sp.graphics.drawCircle($W,$v,15,"#ff00ff"));var $t,$M;$t=Math.atan2($v-$X.resultMatrix.ty,$W-$X.resultMatrix.tx),$X.setRotation($t),($M=$xX._tempMatrix).identity(),$M.rotate($t),$M.scale($X.resultMatrix.getScaleX(),$X.resultMatrix.getScaleY()),$M.translate($X.resultMatrix.tx,$X.resultMatrix.ty),$M.copyTo($X.resultMatrix),$X.updateChild();var $P,$N;$P=Math.atan2($x-$v,$K-$W),$g.setRotation($P),($N=$xX._tempMatrix).identity(),$N.rotate($P),$N.scale($g.resultMatrix.getScaleX(),$g.resultMatrix.getScaleY()),$N.translate($W,$v),$M.copyTo($g.resultMatrix),$g.updateChild()}},$K($xX,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new $MX}]),$xX}(),$EX=function(){function $X(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return $x($X,"laya.ani.bone.IkConstraintData"),$X}(),$Q=function(){function $N($X,$g){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=$X,this.position=$X.position,this.spacing=$X.spacing,this.rotateMix=$X.rotateMix,this.translateMix=$X.translateMix,this.bones=[];for(var $K=this.data.bones,$x=0,$Z=$K.length;$x<$Z;$x++)this.bones.push($g[$K[$x]])}$x($N,"laya.ani.bone.PathConstraint");var $X=$N.prototype;return $X.apply=function($X,$g){if(this.target){var $K=this.translateMix,$x=this.translateMix,$Z=0<$x,$n=this.data.spacingMode,$W="length"==$n,$v=this.data.rotateMode,$T="tangent"==$v,$G="chainScale"==$v,$c=[],$_=this.bones.length,$s=$T?$_:$_+1,$V=[];(this._spaces=$V)[0]=this.position;var $A=this.spacing;if($G||$W)for(var $a=0,$m=$s-1;$a<$m;){var $F=this.bones[$a],$U=$F.length,$$=$U*$F.resultMatrix.a,$w=$U*$F.resultMatrix.b;$U=Math.sqrt($$*$$+$w*$w),$G&&($c[$a]=$U),$V[++$a]=$W?Math.max(0,$U+$A):$A}else for($a=1;$a<$s;$a++)$V[$a]=$A;var $Q=this.computeWorldPositions(this.target,$X,$g,$s,$T,"percent"==this.data.positionMode,"percent"==$n);if(this._debugKey){for($a=0;$a<$Q.length;$a++)$g.drawCircle($Q[$a++],$Q[$a++],5,"#00ff00");var $f=[];for($a=0;$a<$Q.length;$a++)$f.push($Q[$a++],$Q[$a++]);$g.drawLines(0,0,$f,"#ff0000")}var $D=$Q[0],$B=$Q[1],$i=this.data.offsetRotation,$k="chain"==$v&&0==$i,$I=NaN;for($a=0,$I=3;$a<$_;$a++,$I+=3){($F=this.bones[$a]).resultMatrix.tx+=($D-$F.resultMatrix.tx)*$K,$F.resultMatrix.ty+=($B-$F.resultMatrix.ty)*$K;var $r=($$=$Q[$I])-$D,$t=($w=$Q[$I+1])-$B;if($G&&0!=($U=$c[$a])){var $M=(Math.sqrt($r*$r+$t*$t)/$U-1)*$x+1;$F.resultMatrix.a*=$M,$F.resultMatrix.c*=$M}if($D=$$,$B=$w,$Z){var $P=$F.resultMatrix.a,$N=$F.resultMatrix.c,$C=$F.resultMatrix.b,$Y=$F.resultMatrix.d,$l=NaN,$p=NaN,$L=NaN;$l=$T?$Q[$I-1]:0==$V[$a+1]?$Q[$I+2]:Math.atan2($t,$r),$l-=Math.atan2($C,$P)-$i/180*Math.PI,$k&&($p=Math.cos($l),$L=Math.sin($l),$D+=(($U=$F.length)*($p*$P-$L*$C)-$r)*$x,$B+=($U*($L*$P+$p*$C)-$t)*$x),$l>Math.PI?$l-=2*Math.PI:$l<-Math.PI&&($l+=2*Math.PI),$l*=$x,$p=Math.cos($l),$L=Math.sin($l),$F.resultMatrix.a=$p*$P-$L*$C,$F.resultMatrix.c=$p*$N-$L*$Y,$F.resultMatrix.b=$L*$P+$p*$C,$F.resultMatrix.d=$L*$N+$p*$Y}}}},$X.computeWorldVertices2=function($X,$g,$K,$x,$Z,$n){var $W,$v,$T=$X.currDisplayData.bones,$G=$X.currDisplayData.weights,$c=$X.currDisplayData.triangles,$_=0,$s=0,$V=0,$A=0,$a=0,$m=0,$F=0,$U=0,$$=0,$w=0,$Q=0;if(null!=$T){for($_=0;$_<$K;$_+=2)$s+=($A=$T[$s])+1,$V+=$A;var $f=$g;for($a=$n,$m=3*$V;$a<$x;$a+=2){for($U=$F=0,$A=$T[$s++],$A+=$s;$s<$A;$s++,$m+=3){$W=$f[$T[$s]].resultMatrix,$$=$G[$m],$w=$G[$m+1];var $D=$G[$m+2];$F+=($$*$W.a+$w*$W.c+$W.tx)*$D,$U+=($$*$W.b+$w*$W.d+$W.ty)*$D}$Z[$a]=$F,$Z[$a+1]=$U}}else{var $B,$i;if($c||($c=$G),$X.deformData&&($c=$X.deformData),$B=$X.parent,$g)for($Q=$g.length,$_=0;$_<$Q;$_++)if($g[$_].name==$B){$v=$g[$_];break}$v&&($i=$v.resultMatrix),$i||($i=$N._tempMt);var $k=$i.tx,$I=$i.ty,$r=$i.a,$t=$i.b,$M=$i.c,$P=$i.d;for($v&&($P*=$v.d),$s=$K,$a=$n;$a<$x;$s+=2,$a+=2)$$=$c[$s],$w=$c[$s+1],$Z[$a]=$$*$r+$w*$t+$k,$Z[$a+1]=-($$*$M+$w*$P+$I)}},$X.computeWorldPositions=function($X,$g,$K,$x,$Z,$n,$W){$X.currDisplayData.bones,$X.currDisplayData.weights,$X.currDisplayData.triangles;var $v=[],$T=0,$G=$X.currDisplayData.verLen,$c=this.position,$_=this._spaces,$s=[],$V=[],$A=$G/6,$a=-1,$m=NaN,$F=0,$U=0,$$=NaN,$w=NaN,$Q=NaN,$f=NaN;if($A--,$G-=4,this.computeWorldVertices2($X,$g,2,$G,$v,0),this._debugKey)for($T=0;$T<$v.length;)$K.drawCircle($v[$T++],$v[$T++],10,"#ff0000");$s=$v,this._curves.length=$A;var $D=this._curves,$B=$s[$m=0],$i=$s[1],$k=0,$I=0,$r=0,$t=0,$M=0,$P=0,$N=NaN,$C=NaN,$Y=NaN,$l=NaN,$p=NaN,$L=NaN,$q=NaN,$E=NaN,$u=0;for($T=0,$u=2;$T<$A;$T++,$u+=6)$k=$s[$u],$I=$s[$u+1],$r=$s[$u+2],$t=$s[$u+3],$p=2*($N=.1875*($B-2*$k+$r))+($Y=.09375*(3*($k-$r)-$B+($M=$s[$u+4]))),$L=2*($C=.1875*($i-2*$I+$t))+($l=.09375*(3*($I-$t)-$i+($P=$s[$u+5]))),$q=.75*($k-$B)+$N+.16666667*$Y,$E=.75*($I-$i)+$C+.16666667*$l,$m+=Math.sqrt($q*$q+$E*$E),$q+=$p,$E+=$L,$p+=$Y,$L+=$l,$m+=Math.sqrt($q*$q+$E*$E),$q+=$p,$E+=$L,$m+=Math.sqrt($q*$q+$E*$E),$q+=$p+$Y,$E+=$L+$l,$m+=Math.sqrt($q*$q+$E*$E),$D[$T]=$m,$B=$M,$i=$P;if($n&&($c*=$m),$W)for($T=0;$T<$x;$T++)$_[$T]*=$m;var $O=this._segments,$e=0,$b=0;for($b=$U=$F=$T=0;$T<$x;$T++,$F+=3)if(($$=$c+=$w=$_[$T])<0)this.addBeforePosition($$,$s,0,$V,$F);else if($m<$$)this.addAfterPosition($$-$m,$s,$G-4,$V,$F);else{for(;;$U++)if(!(($f=$D[$U])<$$)){0==$U?$$/=$f:$$=($$-($Q=$D[$U-1]))/($f-$Q);break}if($U!=$a){var $S=6*($a=$U);for($B=$s[$S],$i=$s[$S+1],$k=$s[$S+2],$I=$s[$S+3],$r=$s[$S+4],$t=$s[$S+5],$p=2*($N=.03*($B-2*$k+$r))+($Y=.006*(3*($k-$r)-$B+($M=$s[$S+6]))),$L=2*($C=.03*($i-2*$I+$t))+($l=.006*(3*($I-$t)-$i+($P=$s[$S+7]))),$q=.3*($k-$B)+$N+.16666667*$Y,$E=.3*($I-$i)+$C+.16666667*$l,$e=Math.sqrt($q*$q+$E*$E),$O[0]=$e,$S=1;$S<8;$S++)$q+=$p,$E+=$L,$p+=$Y,$L+=$l,$e+=Math.sqrt($q*$q+$E*$E),$O[$S]=$e;$q+=$p,$E+=$L,$e+=Math.sqrt($q*$q+$E*$E),$O[8]=$e,$q+=$p+$Y,$E+=$L+$l,$e+=Math.sqrt($q*$q+$E*$E),$O[9]=$e,$b=0}for($$*=$e;;$b++)if(!(($f=$O[$b])<$$)){0==$b?$$/=$f:$$=$b+($$-($Q=$O[$b-1]))/($f-$Q);break}this.addCurvePosition(.1*$$,$B,$i,$k,$I,$r,$t,$M,$P,$V,$F,$Z||0<$T&&0==$w)}return $V},$X.addBeforePosition=function($X,$g,$K,$x,$Z){var $n=$g[$K],$W=$g[$K+1],$v=$g[$K+2]-$n,$T=$g[$K+3]-$W,$G=Math.atan2($T,$v);$x[$Z]=$n+$X*Math.cos($G),$x[$Z+1]=$W+$X*Math.sin($G),$x[$Z+2]=$G},$X.addAfterPosition=function($X,$g,$K,$x,$Z){var $n=$g[$K+2],$W=$g[$K+3],$v=$n-$g[$K],$T=$W-$g[$K+1],$G=Math.atan2($T,$v);$x[$Z]=$n+$X*Math.cos($G),$x[$Z+1]=$W+$X*Math.sin($G),$x[$Z+2]=$G},$X.addCurvePosition=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c,$_){0==$X&&($X=1e-4);var $s=$X*$X,$V=$s*$X,$A=1-$X,$a=$A*$A,$m=$a*$A,$F=$A*$X,$U=3*$F,$$=$A*$U,$w=$U*$X,$Q=$g*$m+$x*$$+$n*$w+$v*$V,$f=$K*$m+$Z*$$+$W*$w+$T*$V;$G[$c]=$Q,$G[$c+1]=$f,$G[$c+2]=$_?Math.atan2($f-($K*$a+$Z*$F*2+$W*$s),$Q-($g*$a+$x*$F*2+$n*$s)):0},$N.NONE=-1,$N.BEFORE=-2,$N.AFTER=-3,$K($N,["_tempMt",function(){return this._tempMt=new $MX}]),$N}(),$uX=function(){function $X(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return $x($X,"laya.ani.bone.PathConstraintData"),$X}(),$OX=function(){function $X(){this.name=null,this.slotArr=[]}return $x($X,"laya.ani.bone.SkinData"),$X}(),$eX=function(){function $X(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}$x($X,"laya.ani.bone.SkinSlotDisplayData");var $g=$X.prototype;return $g.createTexture=function($X){return this.texture||(this.texture=new $PX($X.bitmap,this.uvs),$X.bitmap.alphaTexture&&(this.texture.alphaTexture=new $PX($X.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=$X.height,this.texture.height=$X.width,this.texture.offsetX=-$X.offsetX,this.texture.offsetY=-$X.offsetY,this.texture.sourceWidth=$X.sourceHeight,this.texture.sourceHeight=$X.sourceWidth):(this.texture.width=$X.width,this.texture.height=$X.height,this.texture.offsetX=-$X.offsetX,this.texture.offsetY=-$X.offsetY,this.texture.sourceWidth=$X.sourceWidth,this.texture.sourceHeight=$X.sourceHeight),$m.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},$g.destory=function(){this.texture&&this.texture.destroy()},$X}(),$bX=function(){function $X(){this.name=null,this.displayArr=[]}return $x($X,"laya.ani.bone.SlotData"),$X.prototype.getDisplayByName=function($X){for(var $g=0,$K=this.displayArr.length;$g<$K;$g++)if(this.displayArr[$g].attachmentName==$X)return $g;return-1},$X}(),$f=function(){function $X($X,$g){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=$a(2,0),this._data=$X,null==this._bones&&(this._bones=[]),this.target=$g[$X.targetIndex];var $K,$x=0;for($x=0,$K=$X.boneIndexs.length;$x<$K;$x++)this._bones.push($g[$X.boneIndexs[$x]]);this.rotateMix=$X.rotateMix,this.translateMix=$X.translateMix,this.scaleMix=$X.scaleMix,this.shearMix=$X.shearMix}return $x($X,"laya.ani.bone.TfConstraint"),$X.prototype.apply=function(){for(var $X,$g=this.target.resultMatrix.a,$K=this.target.resultMatrix.b,$x=this.target.resultMatrix.c,$Z=this.target.resultMatrix.d,$n=0,$W=this._bones.length;$n<$W;$n++){if($X=this._bones[$n],0<this.rotateMix){var $v=$X.resultMatrix.a,$T=$X.resultMatrix.b,$G=$X.resultMatrix.c,$c=$X.resultMatrix.d,$_=Math.atan2($x,$g)-Math.atan2($G,$v)+this._data.offsetRotation*Math.PI/180;$_>Math.PI?$_-=2*Math.PI:$_<-Math.PI&&($_+=2*Math.PI),$_*=this.rotateMix;var $s=Math.cos($_),$V=Math.sin($_);$X.resultMatrix.a=$s*$v-$V*$G,$X.resultMatrix.b=$s*$T-$V*$c,$X.resultMatrix.c=$V*$v+$s*$G,$X.resultMatrix.d=$V*$T+$s*$c}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),$X.resultMatrix.tx+=(this._temp[0]-$X.resultMatrix.tx)*this.translateMix,$X.resultMatrix.ty+=(this._temp[1]-$X.resultMatrix.ty)*this.translateMix,$X.updateChild()),0<this.scaleMix){var $A=Math.sqrt($X.resultMatrix.a*$X.resultMatrix.a+$X.resultMatrix.c*$X.resultMatrix.c),$a=Math.sqrt($g*$g+$x*$x),$m=1e-5<$A?($A+($a-$A+this._data.offsetScaleX)*this.scaleMix)/$A:0;$X.resultMatrix.a*=$m,$X.resultMatrix.c*=$m,$A=Math.sqrt($X.resultMatrix.b*$X.resultMatrix.b+$X.resultMatrix.d*$X.resultMatrix.d),$a=Math.sqrt($K*$K+$Z*$Z),$m=1e-5<$A?($A+($a-$A+this._data.offsetScaleY)*this.scaleMix)/$A:0,$X.resultMatrix.b*=$m,$X.resultMatrix.d*=$m}if(0<this.shearMix){$T=$X.resultMatrix.b,$c=$X.resultMatrix.d;var $F=Math.atan2($c,$T);($_=Math.atan2($Z,$K)-Math.atan2($x,$g)-($F-Math.atan2($X.resultMatrix.c,$X.resultMatrix.a)))>Math.PI?$_-=2*Math.PI:$_<-Math.PI&&($_+=2*Math.PI),$_=$F+($_+this._data.offsetShearY*Math.PI/180)*this.shearMix,$m=Math.sqrt($T*$T+$c*$c),$X.resultMatrix.b=Math.cos($_)*$m,$X.resultMatrix.d=Math.sin($_)*$m}}},$X}(),$SX=function(){function $X(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return $x($X,"laya.ani.bone.TfConstraintData"),$X}(),$RX=function(){function $X(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}$x($X,"laya.ani.bone.Transform");var $g=$X.prototype;return $g.initData=function($X){null!=$X.x&&(this.x=$X.x),null!=$X.y&&(this.y=$X.y),null!=$X.skX&&(this.skX=$X.skX),null!=$X.skY&&(this.skY=$X.skY),null!=$X.scX&&(this.scX=$X.scX),null!=$X.scY&&(this.scY=$X.scY)},$g.getMatrix=function(){var $X;return($X=this.mMatrix?this.mMatrix:this.mMatrix=new $MX).identity(),$X.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew($X,this.skewX*Math.PI/180,this.skewY*Math.PI/180),$X.rotate(this.skX*Math.PI/180),$X.translate(this.x,this.y),$X},$g.skew=function($X,$g,$K){var $x=Math.sin($K),$Z=Math.cos($K),$n=Math.sin($g),$W=Math.cos($g);return $X.setTo($X.a*$W-$X.b*$x,$X.a*$n+$X.b*$Z,$X.c*$W-$X.d*$x,$X.c*$n+$X.d*$Z,$X.tx*$W-$X.ty*$x,$X.tx*$n+$X.ty*$Z),$X},$X}(),$D=function(){function $X(){}return $x($X,"laya.ani.bone.UVTools"),$X.getRelativeUV=function($X,$g,$K){var $x=$X[0],$Z=$X[2]-$X[0],$n=$X[1],$W=$X[5]-$X[1];$K||($K=[]),$K.length=$g.length;var $v,$T=0;$v=$K.length;var $G=1/$Z,$c=1/$W;for($T=0;$T<$v;$T+=2)$K[$T]=($g[$T]-$x)*$G,$K[$T+1]=($g[$T+1]-$n)*$c;return $K},$X.getAbsoluteUV=function($X,$g,$K){if(0==$X[0]&&0==$X[1]&&1==$X[4]&&1==$X[5])return $K?($F.copyArray($K,$g),$K):$g;var $x=$X[0],$Z=$X[2]-$X[0],$n=$X[1],$W=$X[5]-$X[1];$K||($K=[]),$K.length=$g.length;var $v,$T=0;for($v=$K.length,$T=0;$T<$v;$T+=2)$K[$T]=$g[$T]*$Z+$x,$K[$T+1]=$g[$T+1]*$W+$n;return $K},$X}(),$N=function(){function $X(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return $x($X,"laya.ani.KeyFramesContent"),$X}(),$B=function(){function $c(){}return $x($c,"laya.ani.math.BezierLerp"),$c.getBezierRate=function($X,$g,$K,$x,$Z){var $n=$c._getBezierParamKey($g,$K,$x,$Z),$W=100*$n+$X;if($c._bezierResultCache[$W])return $c._bezierResultCache[$W];var $v,$T=$c._getBezierPoints($g,$K,$x,$Z,$n),$G=0;for($v=$T.length,$G=0;$G<$v;$G+=2)if($X<=$T[$G])return $c._bezierResultCache[$W]=$T[$G+1],$T[$G+1];return $c._bezierResultCache[$W]=1},$c._getBezierParamKey=function($X,$g,$K,$x){return 100*(100*(100*(100*$X+$g)+$K)+$x)},$c._getBezierPoints=function($X,$g,$K,$x,$Z){return $c._bezierPointsCache[$Z]?$c._bezierPointsCache[$Z]:($n=[0,0,$X,$g,$K,$x,1,1],$W=(new $v).getBezierPoints($n,100,3),$c._bezierPointsCache[$Z]=$W);var $n,$W},$c._bezierResultCache={},$c._bezierPointsCache={},$c}(),$i=function($X){function $g(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,$g.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}$x($g,"laya.ani.AnimationPlayer",$Z);var $K=$g.prototype;return $ZX.imps($K,{"laya.resource.IDestroy":!0}),$K._onTempletLoadedComputeFullKeyframeIndices=function($X,$g,$K){this._templet===$K&&this._cachePlayRate===$X&&this._cacheFrameRate===$g&&this._computeFullKeyframeIndices()},$K._computeFullKeyframeIndices=function(){for(var $X=this._fullFrames=[],$g=this._templet,$K=this._cacheFrameRateInterval*this._cachePlayRate,$x=0,$Z=$g.getAnimationCount();$x<$Z;$x++){for(var $n=[],$W=0,$v=$g.getAnimation($x).nodes.length;$W<$v;$W++){for(var $T=$g.getAnimation($x).nodes[$W],$G=Math.floor($T.playTime/$K+.01),$c=new Uint16Array($G+1),$_=-1,$s=0,$V=$T.keyFrame.length;$s<$V;$s++){var $A=$T.keyFrame[$s],$a=$A.startTime,$m=$a+$A.duration+$K;do{for(var $F=Math.floor($a/$K+.5),$U=$_+1;$U<$F;$U++)$c[$U]=$s;$c[$_=$F]=$s,$a+=$K}while($a<=$m)}$n.push($c)}$X.push($n)}},$K._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},$K._calculatePlayDuration=function(){if(0!==this.state){var $X=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=$X),this._playEnd>$X&&(this._playEnd=$X),this._playDuration=this._playEnd-this._playStart}},$K._setPlayParams=function($X,$g){this._currentTime=$X,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$g+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$g},$K._setPlayParamsWhenStop=function($X,$g){this._currentTime=$X,this._currentKeyframeIndex=Math.max(Math.floor($X/$g+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$g,this._currentAnimationClipIndex=-1},$K._update=function($X){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var $g=this._cacheFrameRateInterval*this._cachePlayRate,$K=0;this._startUpdateLoopCount!==$A.loopCount&&($K=$X*this.playbackRate,this._elapsedPlaybackTime+=$K);var $x=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=$x)return this._setPlayParamsWhenStop($x,$g),void this.event("stopped");if($K+=this._currentTime,0<$x)if($x<=$K)do{if($K-=$x,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($x,$g),this._stopWhenCircleFinish=!1,void this.event("stopped");$K<$x&&(this._setPlayParams($K,$g),this.event("complete"))}while($x<=$K);else this._setPlayParams($K,$g);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($x,$g),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},$K._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},$K.play=function($X,$g,$K,$x,$Z){if(void 0===$X&&($X=0),void 0===$g&&($g=1),void 0===$K&&($K=2147483647),void 0===$x&&($x=0),void 0===$Z&&($Z=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if($K<0||$x<0||$Z<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==$Z&&$Z<$x)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=$g,this._overallDuration=$K,this._playStart=$x,this._playEnd=$Z,this._paused=!1,this._currentAnimationClipIndex=$X,this._currentKeyframeIndex=0,this._startUpdateLoopCount=$A.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},$K.playByFrame=function($X,$g,$K,$x,$Z,$n){void 0===$X&&($X=0),void 0===$g&&($g=1),void 0===$K&&($K=2147483647),void 0===$x&&($x=0),void 0===$Z&&($Z=0),void 0===$n&&($n=30);var $W=1e3/$n;this.play($X,$g,$K,$x*$W,$Z*$W)},$K.stop=function($X){void 0===$X&&($X=!0),$X?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},$n(0,$K,"playEnd",function(){return this._playEnd}),$n(0,$K,"templet",function(){return this._templet},function($X){0===!this.state&&this.stop(!0),this._templet!==$X&&((this._templet=$X).loaded?this._computeFullKeyframeIndices():$X.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),$n(0,$K,"playStart",function(){return this._playStart}),$n(0,$K,"playDuration",function(){return this._playDuration}),$n(0,$K,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),$n(0,$K,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),$n(0,$K,"overallDuration",function(){return this._overallDuration}),$n(0,$K,"currentFrameTime",function(){return this._currentFrameTime}),$n(0,$K,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),$n(0,$K,"currentPlayTime",function(){return this._currentTime+this._playStart}),$n(0,$K,"cachePlayRate",function(){return this._cachePlayRate},function($X){this._cachePlayRate!==$X&&(this._cachePlayRate=$X,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[$X,this._cacheFrameRate])))}),$n(0,$K,"cacheFrameRate",function(){return this._cacheFrameRate},function($X){this._cacheFrameRate!==$X&&(this._cacheFrameRate=$X,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,$X])))}),$n(0,$K,"currentTime",null,function($X){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if($X<this._playStart||$X>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=$A.loopCount;var $g=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=$X,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$g),0),this._currentFrameTime=this._currentKeyframeIndex*$g}}),$n(0,$K,"paused",function(){return this._paused},function($X){(this._paused=$X)&&this.event("paused")}),$n(0,$K,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),$n(0,$K,"destroyed",function(){return this._destroyed}),$g}(),$C=function($X){function $g(){$g.__super.call(this),$m.isConchNode&&(this.drawSkin=function($X){$X.transform||($X.transform=$MX.EMPTY),this._addCmd([$X]),this.setSkinMesh&&this.setSkinMesh($X._ps,$X.mVBData,$X.mEleNum,0,$X.mTexture,$X.transform)})}return $x($g,"laya.ani.GraphicsAni",$W),$g.prototype.drawSkin=function($X){var $g=[$X];this._saveToCmd($m._context._drawSkin,$g)},$g.create=function(){return $g._caches.pop()||new $g},$g.recycle=function($X){$X.clear(),$g._caches.push($X)},$g._caches=[],$g}(),$Y=function($X){function $U(){this._aniMap={},this.unfixedLastAniIndex=-1,$U.__super.call(this),this._anis=new Array}$x($U,"laya.ani.AnimationTemplet",$c);var $g=$U.prototype;return $g.parse=function($X){var $g=new $tX($X);this._aniVersion=$g.readUTFString(),$$.parse(this,$g)},$g._calculateKeyFrame=function($X,$g,$K){var $x=$X.keyFrame;$x[$g]=$x[0];for(var $Z=0;$Z<$g;$Z++){var $n=$x[$Z];$n.nextData=0===$n.duration?$n.data:$x[$Z+1].data}$x.length--},$g.onAsynLoaded=function($X,$g,$K){var $x=new $tX($g);switch(this._aniVersion=$x.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":$w.parse(this,$x);break;default:$$.parse(this,$x)}this._endLoaded()},$g.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},$g.getAnimationCount=function(){return this._anis.length},$g.getAnimation=function($X){return this._anis[$X]},$g.getAniDuration=function($X){return this._anis[$X].playTime},$g.getNodes=function($X){return this._anis[$X].nodes},$g.getNodeIndexWithName=function($X,$g){return this._anis[$X].bone3DMap[$g]},$g.getNodeCount=function($X){return this._anis[$X].nodes.length},$g.getTotalkeyframesLength=function($X){return this._anis[$X].totalKeyframeDatasLength},$g.getPublicExtData=function(){return this._publicExtData},$g.getAnimationDataWithCache=function($X,$g,$K,$x){var $Z=$g[$K];if($Z){var $n=$Z[$X];return $n?$n[$x]:null}return null},$g.setAnimationDataWithCache=function($X,$g,$K,$x,$Z){var $n=$g[$K]||($g[$K]={});($n[$X]||($n[$X]=[]))[$x]=$Z},$g.getOriginalData=function($X,$g,$K,$x,$Z){for(var $n=this._anis[$X].nodes,$W=0,$v=0,$T=$n.length,$G=0;$v<$T;$v++){var $c,$_=$n[$v];$c=$_.keyFrame[$K[$v][$x]],$_.dataOffset=$G;var $s=$Z-$c.startTime,$V=$_.lerpType;if($V)switch($V){case 0:case 1:for($W=0;$W<$_.keyframeWidth;)$W+=$_.interpolationMethod[$W]($_,$W,$g,$G+$W,$c.data,$s,null,$c.duration,$c.nextData);break;case 2:var $A=$c.interpolationData,$a=$A.length,$m=0;for($W=0;$W<$a;){var $F=$A[$W];switch($F){case 6:case 7:$W+=$U.interpolation[$F]($_,$m,$g,$G+$m,$c.data,$s,null,$c.duration,$c.nextData,$A,$W+1);break;default:$W+=$U.interpolation[$F]($_,$m,$g,$G+$m,$c.data,$s,null,$c.duration,$c.nextData)}$m++}}else for($W=0;$W<$_.keyframeWidth;)$W+=$_.interpolationMethod[$W]($_,$W,$g,$G+$W,$c.data,$s,null,$c.duration,$c.nextData);$G+=$_.keyframeWidth}},$g.getNodesCurrentFrameIndex=function($X,$g){var $K=this._anis[$X].nodes;$X!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($K.length),this.unfixedCurrentTimes=new Float32Array($K.length),this.unfixedLastAniIndex=$X);for(var $x=0,$Z=$K.length;$x<$Z;$x++){var $n=$K[$x];for($g<this.unfixedCurrentTimes[$x]&&(this.unfixedCurrentFrameIndexes[$x]=0),this.unfixedCurrentTimes[$x]=$g;this.unfixedCurrentFrameIndexes[$x]<$n.keyFrame.length&&!($n.keyFrame[this.unfixedCurrentFrameIndexes[$x]].startTime>this.unfixedCurrentTimes[$x]);)this.unfixedCurrentFrameIndexes[$x]++;this.unfixedCurrentFrameIndexes[$x]--}return this.unfixedCurrentFrameIndexes},$g.getOriginalDataUnfixedRate=function($X,$g,$K){var $x=this._anis[$X].nodes;$X!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($x.length),this.unfixedCurrentTimes=new Float32Array($x.length),this.unfixedKeyframes=$a($x.length),this.unfixedLastAniIndex=$X);for(var $Z=0,$n=0,$W=$x.length,$v=0;$n<$W;$n++){var $T=$x[$n];for($K<this.unfixedCurrentTimes[$n]&&(this.unfixedCurrentFrameIndexes[$n]=0),this.unfixedCurrentTimes[$n]=$K;this.unfixedCurrentFrameIndexes[$n]<$T.keyFrame.length&&!($T.keyFrame[this.unfixedCurrentFrameIndexes[$n]].startTime>this.unfixedCurrentTimes[$n]);)this.unfixedKeyframes[$n]=$T.keyFrame[this.unfixedCurrentFrameIndexes[$n]],this.unfixedCurrentFrameIndexes[$n]++;var $G=this.unfixedKeyframes[$n];$T.dataOffset=$v;var $c=$K-$G.startTime;if($T.lerpType)switch($T.lerpType){case 0:case 1:for($Z=0;$Z<$T.keyframeWidth;)$Z+=$T.interpolationMethod[$Z]($T,$Z,$g,$v+$Z,$G.data,$c,null,$G.duration,$G.nextData);break;case 2:var $_=$G.interpolationData,$s=$_.length,$V=0;for($Z=0;$Z<$s;){var $A=$_[$Z];switch($A){case 6:case 7:$Z+=$U.interpolation[$A]($T,$V,$g,$v+$V,$G.data,$c,null,$G.duration,$G.nextData,$_,$Z+1);break;default:$Z+=$U.interpolation[$A]($T,$V,$g,$v+$V,$G.data,$c,null,$G.duration,$G.nextData)}$V++}}else for($Z=0;$Z<$T.keyframeWidth;)$Z+=$T.interpolationMethod[$Z]($T,$Z,$g,$v+$Z,$G.data,$c,null,$G.duration,$G.nextData);$v+=$T.keyframeWidth}},$U._LinearInterpolation_0=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){var $c=0===$v?0:$n/$v;return $K[$x]=(1-$c)*$Z[$g]+$c*$T[$g],1},$U._QuaternionInterpolation_1=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){var $c=0===$v?0:$n/$v;return $s.slerpQuaternionArray($Z,$g,$T,$g,$c,$K,$x),4},$U._AngleInterpolation_2=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){return 0},$U._RadiansInterpolation_3=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){return 0},$U._Matrix4x4Interpolation_4=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){for(var $c=0;$c<16;$c++,$g++)$K[$x+$c]=$Z[$g]+$n*$W[$g];return 16},$U._NoInterpolation_5=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G){return $K[$x]=$Z[$g],1},$U._BezierInterpolation_6=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c){return void 0===$c&&($c=0),$K[$x]=$Z[$g]+($T[$g]-$Z[$g])*$B.getBezierRate($n/$v,$G[$c],$G[$c+1],$G[$c+2],$G[$c+3]),5},$U._BezierInterpolation_7=function($X,$g,$K,$x,$Z,$n,$W,$v,$T,$G,$c){return void 0===$c&&($c=0),$K[$x]=$G[$c+4]+$G[$c+5]*$B.getBezierRate((.001*$n+$G[$c+6])/$G[$c+7],$G[$c],$G[$c+1],$G[$c+2],$G[$c+3]),9},$U.load=function($X){return $ZX.loader.create($X,null,null,$U)},$U.interpolation=[$U._LinearInterpolation_0,$U._QuaternionInterpolation_1,$U._AngleInterpolation_2,$U._RadiansInterpolation_3,$U._Matrix4x4Interpolation_4,$U._NoInterpolation_5,$U._BezierInterpolation_6,$U._BezierInterpolation_7],$U}(),$k=function($g){function $K($X,$g){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,$K.__super.call(this),void 0===$g&&($g=0),$X&&this.init($X,$g)}$x($K,"laya.ani.bone.Skeleton",$g);var $X=$K.prototype;return $X.init=function($X,$g){void 0===$g&&($g=0);var $K,$x,$Z,$n=0,$W=0;if(1==$g)for(this._graphicsCache=[],$n=0,$W=$X.getAnimationCount();$n<$W;$n++)this._graphicsCache.push([]);if(this._yReverseMatrix=$X.yReverseMatrix,this._aniMode=$g,this._templet=$X,this._player=new $i,this._player.cacheFrameRate=$X.rate,this._player.templet=$X,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=$X.mBoneArr,this._rootBone=$X.mRootBone,this._aniSectionDic=$X.aniSectionDic,0<$X.ikArr.length)for(this._ikArr=[],$n=0,$W=$X.ikArr.length;$n<$W;$n++)this._ikArr.push(new $U($X.ikArr[$n],this._boneList));if(0<$X.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),$n=0,$W=$X.pathArr.length;$n<$W;$n++)$K=$X.pathArr[$n],$x=new $Q($K,this._boneList),($Z=this._boneSlotDic[$K.name])&&(($x=new $Q($K,this._boneList)).target=$Z),this._pathDic[$K.name]=$x;if(0<$X.tfArr.length)for(this._tfArr=[],$n=0,$W=$X.tfArr.length;$n<$W;$n++)this._tfArr.push(new $f($X.tfArr[$n],this._boneList));if(0<$X.skinDataArray.length){var $v=this._templet.skinDataArray[this._skinIndex];this._skinName=$v.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},$X.load=function($X,$g,$K){},$X._onLoaded=function(){},$X._parseComplete=function(){var $X=$I.TEMPLET_DICTIONARY[this._aniPath];$X&&(this.init($X,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},$X._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},$X._onPlay=function(){this.event("played")},$X._onStop=function(){var $X,$g=this._templet.eventAniArr[this._aniClipIndex];if($g&&this._eventIndex<$g.length)for(;this._eventIndex<$g.length;this._eventIndex++)($X=$g[this._eventIndex]).time>=this._player.playStart&&$X.time<=this._player.playEnd&&this.event("label",$X);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},$X._onPause=function(){this.event("paused")},$X._parseSrcBoneMatrix=function(){var $X=0,$g=0;for($g=this._templet.srcBoneMatrixArr.length,$X=0;$X<$g;$X++)this._boneMatrixArray.push(new $MX);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var $K,$x,$Z=this._templet.boneSlotArray;for($X=0,$g=$Z.length;$X<$g;$X++)$K=$Z[$X],null==($x=this._bindBoneBoneSlotDic[$K.parent])&&(this._bindBoneBoneSlotDic[$K.parent]=$x=[]),this._boneSlotDic[$K.name]=$K=$K.copy(),$x.push($K),this._boneSlotArray.push($K)}},$X._emitMissedEvents=function($X,$g,$K){void 0===$K&&($K=0);var $x=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if($x){var $Z,$n,$W=0;for($Z=$x.length,$W=$K;$W<$Z;$W++)($n=$x[$W]).time>=this._player.playStart&&$n.time<=this._player.playEnd&&this.event("label",$n)}},$X._update=function($X){if(void 0===$X&&($X=!0),!(this._pause||$X&&this._indexControl)){var $g=this.timer.currTimer,$K=this._player.currentKeyframeIndex,$x=$g-this._lastTime;if($X?this._player._update($x):$K=-1,this._lastTime=$g,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<$x&&this._clipIndex==$K&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var $Z;this._lastUpdateAniClipIndex=this._aniClipIndex,$K>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var $n,$W=this._templet.eventAniArr[this._aniClipIndex];if($W&&this._eventIndex<$W.length&&(($Z=$W[this._eventIndex]).time>=this._player.playStart&&$Z.time<=this._player.playEnd?this._player.currentPlayTime>=$Z.time&&(this.event("label",$Z),this._eventIndex++):this._eventIndex++),0==this._aniMode){if($n=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$n&&(this.graphics=$n));var $v=0,$T=0;for($T=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,$T-1)&&0<$T;)$T--;if($T<this._clipIndex)for($v=$T;$v<this._clipIndex;$v++)this._createGraphics($v)}else if(1==this._aniMode){if($n=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$n&&(this.graphics=$n));for($T=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,$T-1)&&0<$T;)$T--;if($T<this._clipIndex)for($v=$T;$v<this._clipIndex;$v++)this._createGraphics($v)}this._createGraphics()}}},$X._createGraphics=function($X){void 0===$X&&($X=-1),-1==$X&&($X=this._clipIndex);var $g,$K,$x=$X*this._player.cacheFrameRateInterval,$Z=this._templet.drawOrderAniArr[this._aniClipIndex];if($Z&&0<$Z.length)for(this._drawOrderIndex=0,$g=$Z[this._drawOrderIndex];$x>=$g.time&&(this._drawOrder=$g.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=$Z.length));)$g=$Z[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=$C.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=$C.create(),$K=this.graphics;var $n=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],$X,$x);var $W,$v,$T,$G,$c=this._aniSectionDic[this._aniClipIndex],$_=0,$s=0,$V=0,$A=0,$a=0,$m=this._templet.srcBoneMatrixArr.length;for($a=$c[$s=0];$s<$m;$s++)$G=this._boneList[$s],$T=this._templet.srcBoneMatrixArr[$s],$G.resultTransform.scX=$T.scX*this._curOriginalData[$_++],$G.resultTransform.skX=$T.skX+this._curOriginalData[$_++],$G.resultTransform.skY=$T.skY+this._curOriginalData[$_++],$G.resultTransform.scY=$T.scY*this._curOriginalData[$_++],$G.resultTransform.x=$T.x+this._curOriginalData[$_++],$G.resultTransform.y=$T.y+this._curOriginalData[$_++],8===this._templet.tMatrixDataLen&&($G.resultTransform.skewX=$T.skewX+this._curOriginalData[$_++],$G.resultTransform.skewY=$T.skewY+this._curOriginalData[$_++]);var $F,$U={},$$={};for($a+=$c[1];$s<$a;$s++)$U[($F=$n[$s]).name]=this._curOriginalData[$_++],$$[$F.name]=this._curOriginalData[$_++],this._curOriginalData[$_++],this._curOriginalData[$_++],this._curOriginalData[$_++],this._curOriginalData[$_++];var $w,$Q,$f={},$D={};for($a+=$c[2];$s<$a;$s++)$f[($F=$n[$s]).name]=this._curOriginalData[$_++],$D[$F.name]=this._curOriginalData[$_++],this._curOriginalData[$_++],this._curOriginalData[$_++],this._curOriginalData[$_++],this._curOriginalData[$_++];if(this._pathDic)for($a+=$c[3];$s<$a;$s++){if($F=$n[$s],$w=this._pathDic[$F.name])switch(new $tX($F.extenData).getByte()){case 1:$w.position=this._curOriginalData[$_++];break;case 2:$w.spacing=this._curOriginalData[$_++];break;case 3:$w.rotateMix=this._curOriginalData[$_++],$w.translateMix=this._curOriginalData[$_++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update($MX.TEMP.identity()),this._ikArr)for($s=0,$a=this._ikArr.length;$s<$a;$s++)$Q=this._ikArr[$s],$f.hasOwnProperty($Q.name)&&($Q.bendDirection=$f[$Q.name]),$D.hasOwnProperty($Q.name)&&($Q.mix=$D[$Q.name]),$Q.apply();if(this._pathDic)for(var $B in this._pathDic)($w=this._pathDic[$B]).apply(this._boneList,$K);if(this._tfArr)for($s=0,$A=this._tfArr.length;$s<$A;$s++)this._tfArr[$s].apply();for($s=0,$A=this._boneList.length;$s<$A;$s++)if($G=this._boneList[$s],$v=this._bindBoneBoneSlotDic[$G.name],$G.resultMatrix.copyTo(this._boneMatrixArray[$s]),$v)for($V=0,$a=$v.length;$V<$a;$V++)($W=$v[$V])&&$W.setParentMatrix($G.resultMatrix);var $i,$k,$I,$r,$t={},$M=this._templet.deformAniArr;if($M&&0<$M.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,$s=0,$a=this._boneSlotArray.length;$s<$a;$s++)($W=this._boneSlotArray[$s]).deformData=null;var $P,$N=$M[this._aniClipIndex];for($P in $i=$N.default,this._setDeform($i,$t,this._boneSlotArray,$x),$N)"default"!=$P&&$P!=this._skinName&&($i=$N[$P],this._setDeform($i,$t,this._boneSlotArray,$x));$i=$N[this._skinName],this._setDeform($i,$t,this._boneSlotArray,$x)}if(this._drawOrder)for($s=0,$a=this._drawOrder.length;$s<$a;$s++)$k=$U[($W=this._boneSlotArray[this._drawOrder[$s]]).name],$I=$$[$W.name],isNaN($I)||($K.save(),$K.alpha($I)),isNaN($k)||-2==$k||(this._templet.attachmentNames?$W.showDisplayByName(this._templet.attachmentNames[$k]):$W.showDisplayByIndex($k)),$t[this._drawOrder[$s]]?($r=$t[this._drawOrder[$s]],$W.currDisplayData&&$r[$W.currDisplayData.attachmentName]?$W.deformData=$r[$W.currDisplayData.attachmentName]:$W.deformData=null):$W.deformData=null,isNaN($I)?$W.draw($K,this._boneMatrixArray,2==this._aniMode):$W.draw($K,this._boneMatrixArray,2==this._aniMode,$I),isNaN($I)||$K.restore();else for($s=0,$a=this._boneSlotArray.length;$s<$a;$s++)$k=$U[($W=this._boneSlotArray[$s]).name],$I=$$[$W.name],isNaN($I)||($K.save(),$K.alpha($I)),isNaN($k)||-2==$k||(this._templet.attachmentNames?$W.showDisplayByName(this._templet.attachmentNames[$k]):$W.showDisplayByIndex($k)),$t[$s]?($r=$t[$s],$W.currDisplayData&&$r[$W.currDisplayData.attachmentName]?$W.deformData=$r[$W.currDisplayData.attachmentName]:$W.deformData=null):$W.deformData=null,isNaN($I)?$W.draw($K,this._boneMatrixArray,2==this._aniMode):$W.draw($K,this._boneMatrixArray,2==this._aniMode,$I),isNaN($I)||$K.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,$X,$K):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,$X,$K)},$X._setDeform=function($X,$g,$K,$x){if($X){var $Z,$n,$W,$v=0,$T=0,$G=0;if($X)for($v=0,$T=$X.deformSlotDataList.length;$v<$T;$v++)for($Z=$X.deformSlotDataList[$v],$G=0;$G<$Z.deformSlotDisplayList.length;$G++)$W=$K[($n=$Z.deformSlotDisplayList[$G]).slotIndex],$n.apply($x,$W),$g[$n.slotIndex]||($g[$n.slotIndex]={}),$g[$n.slotIndex][$n.attachment]=$n.deformData}},$X.getAnimNum=function(){return this._templet.getAnimationCount()},$X.getAniNameByIndex=function($X){return this._templet.getAniNameByIndex($X)},$X.getSlotByName=function($X){return this._boneSlotDic[$X]},$X.showSkinByName=function($X,$g){void 0===$g&&($g=!0),this.showSkinByIndex(this._templet.getSkinIndexByName($X),$g)},$X.showSkinByIndex=function($X,$g){void 0===$g&&($g=!0);for(var $K=0;$K<this._boneSlotArray.length;$K++)this._boneSlotArray[$K].showSlotData(null,$g);if(this._templet.showSkinByIndex(this._boneSlotDic,$X,$g)){var $x=this._templet.skinDataArray[$X];this._skinIndex=$X,this._skinName=$x.name}this._clearCache()},$X.showSlotSkinByIndex=function($X,$g){if(0!=this._aniMode){var $K=this.getSlotByName($X);$K&&$K.showDisplayByIndex($g),this._clearCache()}},$X.showSlotSkinByName=function($X,$g){if(0!=this._aniMode){var $K=this.getSlotByName($X);$K&&$K.showDisplayByName($g),this._clearCache()}},$X.replaceSlotSkinName=function($X,$g,$K){if(0!=this._aniMode){var $x=this.getSlotByName($X);$x&&$x.replaceDisplayByName($g,$K),this._clearCache()}},$X.replaceSlotSkinByIndex=function($X,$g,$K){if(0!=this._aniMode){var $x=this.getSlotByName($X);$x&&$x.replaceDisplayByIndex($g,$K),this._clearCache()}},$X.setSlotSkin=function($X,$g){if(0!=this._aniMode){var $K=this.getSlotByName($X);$K&&$K.replaceSkin($g),this._clearCache()}},$X._clearCache=function(){if(1==this._aniMode)for(var $X=0,$g=this._graphicsCache.length;$X<$g;$X++){for(var $K=0,$x=this._graphicsCache[$X].length;$K<$x;$K++){var $Z=this._graphicsCache[$X][$K];$Z!=this.graphics&&$C.recycle($Z)}this._graphicsCache[$X].length=0}},$X.play=function($X,$g,$K,$x,$Z,$n){void 0===$K&&($K=!0),void 0===$x&&($x=0),void 0===$Z&&($Z=0),void 0===$n&&($n=!0),this._indexControl=!1;var $W=-1,$v=NaN;if($v=$g?2147483647:0,"string"==typeof $X)for(var $T=0,$G=this._templet.getAnimationCount();$T<$G;$T++){var $c=this._templet.getAnimation($T);if($c&&$X==$c.name){$W=$T;break}}else $W=$X;-1<$W&&$W<this.getAnimNum()&&(this._aniClipIndex=$W,($K||this._pause||this._currAniIndex!=$W)&&(this._currAniIndex=$W,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength($W)),this._drawOrder=null,this._eventIndex=0,this._player.play($W,this._player.playbackRate,$v,$x,$Z),$n&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=$_.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},$X.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},$X.playbackRate=function($X){this._player&&(this._player.playbackRate=$X)},$X.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},$X.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=$_.now(),this.timer.frameLoop(1,this,this._update,null,!0))},$X._getGrahicsDataWithCache=function($X,$g){return this._graphicsCache[$X][$g]},$X._setGrahicsDataWithCache=function($X,$g,$K){this._graphicsCache[$X][$g]=$K},$X.destroy=function($X){void 0===$X&&($X=!0),$g.prototype.destroy.call(this,$X),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},$n(0,$X,"url",function(){return this._aniPath},function($X){this.load($X)}),$n(0,$X,"index",function(){return this._index},function($X){this.player&&(this._index=$X,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),$n(0,$X,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),$n(0,$X,"templet",function(){return this._templet}),$n(0,$X,"player",function(){return this._player}),$K.useSimpleMeshInCanvas=!1,$K}($nX),$I=function($g){function $Z(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,$Z.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}$x($Z,"laya.ani.bone.Templet",$g);var $X=$Z.prototype;return $X.getLoadList=function(){return this._loadList},$X.loadAni=function($X){this._skBufferUrl=$X,$ZX.loader.load($X,$T.create(this,this.onComplete),null,"arraybuffer")},$X.onComplete=function($X){if(this._isDestroyed)this.destroy();else{var $g=$G.getRes(this._skBufferUrl);$g?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,$g)):this.event("error","load failed:"+this._skBufferUrl)}},$X.parseData=function($X,$g,$K){void 0===$K&&($K=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=$X,this._mainTexture&&$m.isWebGL&&$X.bitmap&&($X.bitmap.enableMerageInAtlas=!1),this._rate=$K,this.parse($g)},$X.buildArmature=function($X){return void 0===$X&&($X=0),new $k(this,$X)},$X.parse=function($X){$g.prototype.parse.call(this,$X),this._endLoaded(),this._aniVersion!=$Z.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+$Z.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},$X._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var $X=0;this._loadList=[];var $g,$K=new $tX(this.getPublicExtData()),$x=0,$Z=0,$n=0,$W=$K.getInt32(),$v=$K.readUTFString(),$T=$v.split("\n");for($X=0;$X<$W;$X++)$g=this._path+$T[2*$X],$v=$T[2*$X+1],$K.getFloat32(),$K.getFloat32(),$x=$K.getFloat32(),$Z=$K.getFloat32(),$n=$K.getFloat32(),isNaN($n)?0:$n,$n=$K.getFloat32(),isNaN($n)?0:$n,$n=$K.getFloat32(),isNaN($n)?$x:$n,$n=$K.getFloat32(),isNaN($n)?$Z:$n,-1==this._loadList.indexOf($g)&&this._loadList.push($g);this.event("inited",this)}},$X._textureComplete=function(){for(var $X,$g,$K=0,$x=this._loadList.length;$K<$x;$K++)$g=this._loadList[$K],$X=this._textureDic[$g]=$G.getRes($g),$m.isWebGL&&$X&&$X.bitmap&&($X.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},$X._parsePublicExtData=function(){var $X=0,$g=0,$K=0,$x=0,$Z=0;for($X=0,$Z=this.getAnimationCount();$X<$Z;$X++)this._graphicsCache.push([]);var $n;$n="Dragon"!=this._aniClassName;var $W,$v,$T=new $tX(this.getPublicExtData()),$G=0,$c=0,$_=0,$s=0,$V=0,$A=0,$a=0,$m=0,$F=0,$U=$T.getInt32(),$$=$T.readUTFString(),$w=$$.split("\n");for($X=0;$X<$U;$X++){if($W=this._mainTexture,$v=this._path+$w[2*$X],$$=$w[2*$X+1],null==this._mainTexture&&($W=this._textureDic[$v]),!$W)return this.event("error",this),void(this.isParseFail=!0);$G=$T.getFloat32(),$c=$T.getFloat32(),$_=$T.getFloat32(),$s=$T.getFloat32(),$F=$T.getFloat32(),$V=isNaN($F)?0:$F,$F=$T.getFloat32(),$A=isNaN($F)?0:$F,$F=$T.getFloat32(),$a=isNaN($F)?$_:$F,$F=$T.getFloat32(),$m=isNaN($F)?$s:$F,this.subTextureDic[$$]=$PX.create($W,$G,$c,$_,$s,-$V,-$A,$a,$m),$W.alphaTexture&&(this.subTextureDic[$$].alphaTexture=$PX.create($W.alphaTexture,$G,$c,$_,$s,-$V,-$A,$a,$m))}this._mainTexture=$W;var $Q,$f,$D,$B,$i,$k=$T.getUint16();for($X=0;$X<$k;$X++)($Q=[]).push($T.getUint16()),$Q.push($T.getUint16()),$Q.push($T.getUint16()),$Q.push($T.getUint16()),this.aniSectionDic[$X]=$Q;var $I,$r=$T.getInt16(),$t={};for($X=0;$X<$r;$X++)$f=new $NX,0==$X?$I=$f:$f.root=$I,$f.d=$n?-1:1,$B=$T.readUTFString(),$i=$T.readUTFString(),$f.length=$T.getFloat32(),1==$T.getByte()&&($f.inheritRotation=!1),1==$T.getByte()&&($f.inheritScale=!1),$f.name=$B,$i&&(($D=$t[$i])?$D.addChild($f):this.mRootBone=$f),$t[$B]=$f,this.mBoneArr.push($f);this.tMatrixDataLen=$T.getUint16();var $M,$P,$N=$T.getUint16(),$C=Math.floor($N/this.tMatrixDataLen),$Y=this.srcBoneMatrixArr;for($X=0;$X<$C;$X++)($M=new $RX).scX=$T.getFloat32(),$M.skX=$T.getFloat32(),$M.skY=$T.getFloat32(),$M.scY=$T.getFloat32(),$M.x=$T.getFloat32(),$M.y=$T.getFloat32(),8===this.tMatrixDataLen&&($M.skewX=$T.getFloat32(),$M.skewY=$T.getFloat32()),$Y.push($M),($f=this.mBoneArr[$X]).transform=$M;var $l,$p=$T.getUint16(),$L=0;for($X=0;$X<$p;$X++){for($P=new $EX,$L=$T.getUint16(),$g=0;$g<$L;$g++)$P.boneNames.push($T.readUTFString()),$P.boneIndexs.push($T.getInt16());$P.name=$T.readUTFString(),$P.targetBoneName=$T.readUTFString(),$P.targetBoneIndex=$T.getInt16(),$P.bendDirection=$T.getFloat32(),$P.mix=$T.getFloat32(),$P.isSpine=$n,this.ikArr.push($P)}var $q,$E=$T.getUint16(),$u=0;for($X=0;$X<$E;$X++){for($l=new $SX,$u=$T.getUint16(),$g=0;$g<$u;$g++)$l.boneIndexs.push($T.getInt16());$l.name=$T.getUTFString(),$l.targetIndex=$T.getInt16(),$l.rotateMix=$T.getFloat32(),$l.translateMix=$T.getFloat32(),$l.scaleMix=$T.getFloat32(),$l.shearMix=$T.getFloat32(),$l.offsetRotation=$T.getFloat32(),$l.offsetX=$T.getFloat32(),$l.offsetY=$T.getFloat32(),$l.offsetScaleX=$T.getFloat32(),$l.offsetScaleY=$T.getFloat32(),$l.offsetShearY=$T.getFloat32(),this.tfArr.push($l)}var $O=$T.getUint16(),$e=0;for($X=0;$X<$O;$X++){for(($q=new $uX).name=$T.readUTFString(),$e=$T.getUint16(),$g=0;$g<$e;$g++)$q.bones.push($T.getInt16());$q.target=$T.readUTFString(),$q.positionMode=$T.readUTFString(),$q.spacingMode=$T.readUTFString(),$q.rotateMode=$T.readUTFString(),$q.offsetRotation=$T.getFloat32(),$q.position=$T.getFloat32(),$q.spacing=$T.getFloat32(),$q.rotateMix=$T.getFloat32(),$q.translateMix=$T.getFloat32(),this.pathArr.push($q)}var $b,$S,$R,$j,$d,$h=0,$z=0,$J=0,$o=NaN,$H=0,$y=$T.getInt16();for($X=0;$X<$y;$X++){var $XX=$T.getUint8(),$gX={};this.deformAniArr.push($gX);for(var $KX=0;$KX<$XX;$KX++)for(($b=new $YX).skinName=$T.getUTFString(),$gX[$b.skinName]=$b,$h=$T.getInt16(),$g=0;$g<$h;$g++)for($S=new $lX,$b.deformSlotDataList.push($S),$z=$T.getInt16(),$K=0;$K<$z;$K++)for($R=new $pX,$S.deformSlotDisplayList.push($R),$R.slotIndex=$T.getInt16(),$R.attachment=$T.getUTFString(),$J=$T.getInt16(),$x=0;$x<$J;$x++)for(1==$T.getByte()?$R.tweenKeyList.push(!0):$R.tweenKeyList.push(!1),$o=$T.getFloat32(),$R.timeList.push($o),$j=[],$R.vectices.push($j),$H=$T.getInt16(),$Z=0;$Z<$H;$Z++)$j.push($T.getFloat32())}var $xX,$ZX,$nX=$T.getInt16(),$WX=0,$vX=0;for($X=0;$X<$nX;$X++){for($WX=$T.getInt16(),$d=[],$g=0;$g<$WX;$g++){for(($xX=new $LX).time=$T.getFloat32(),$vX=$T.getInt16(),$K=0;$K<$vX;$K++)$xX.drawOrder.push($T.getInt16());$d.push($xX)}this.drawOrderAniArr.push($d)}var $TX,$GX=$T.getInt16(),$cX=0;for($X=0;$X<$GX;$X++){for($cX=$T.getInt16(),$ZX=[],$g=0;$g<$cX;$g++)($TX=new $qX).name=$T.getUTFString(),$TX.intValue=$T.getInt32(),$TX.floatValue=$T.getFloat32(),$TX.stringValue=$T.getUTFString(),$TX.time=$T.getFloat32(),$ZX.push($TX);this.eventAniArr.push($ZX)}var $_X=$T.getInt16();if(0<$_X)for(this.attachmentNames=[],$X=0;$X<$_X;$X++)this.attachmentNames.push($T.getUTFString());var $sX,$VX,$AX=$T.getInt16();for($X=0;$X<$AX;$X++)($sX=new $CX).name=$T.readUTFString(),$sX.parent=$T.readUTFString(),$sX.attachmentName=$T.readUTFString(),$sX.srcDisplayIndex=$sX.displayIndex=$T.getInt16(),($sX.templet=this).boneSlotDic[$sX.name]=$sX,null==($VX=this.bindBoneBoneSlotDic[$sX.parent])&&(this.bindBoneBoneSlotDic[$sX.parent]=$VX=[]),$VX.push($sX),this.boneSlotArray.push($sX);var $aX,$mX,$FX,$UX=$T.readUTFString().split("\n"),$$X=0,$wX=$T.getUint8(),$QX=0,$fX=0,$DX=0,$BX=0,$iX=0,$kX=0,$IX=0;for($X=0;$X<$wX;$X++){for(($aX=new $OX).name=$UX[$$X++],$QX=$T.getUint8(),$g=0;$g<$QX;$g++){for(($mX=new $bX).name=$UX[$$X++],$sX=this.boneSlotDic[$mX.name],$fX=$T.getUint8(),$K=0;$K<$fX;$K++){if($FX=new $eX,this.skinSlotDisplayDataArr.push($FX),$FX.name=$UX[$$X++],$FX.attachmentName=$UX[$$X++],$FX.transform=new $RX,$FX.transform.scX=$T.getFloat32(),$FX.transform.skX=$T.getFloat32(),$FX.transform.skY=$T.getFloat32(),$FX.transform.scY=$T.getFloat32(),$FX.transform.x=$T.getFloat32(),$FX.transform.y=$T.getFloat32(),$mX.displayArr.push($FX),$FX.width=$T.getFloat32(),$FX.height=$T.getFloat32(),$FX.type=$T.getUint8(),$FX.verLen=$T.getUint16(),0<($r=$T.getUint16()))for($FX.bones=[],$x=0;$x<$r;$x++){var $rX=$T.getUint16();$FX.bones.push($rX)}if(0<($DX=$T.getUint16()))for($FX.uvs=[],$x=0;$x<$DX;$x++)$FX.uvs.push($T.getFloat32());if(0<($BX=$T.getUint16()))for($FX.weights=[],$x=0;$x<$BX;$x++)$FX.weights.push($T.getFloat32());if(0<($iX=$T.getUint16()))for($FX.triangles=[],$x=0;$x<$iX;$x++)$FX.triangles.push($T.getUint16());if(0<($kX=$T.getUint16()))for($FX.vertices=[],$x=0;$x<$kX;$x++)$FX.vertices.push($T.getFloat32());if(0<($IX=$T.getUint16()))for($FX.lengths=[],$x=0;$x<$IX;$x++)$FX.lengths.push($T.getFloat32())}$aX.slotArr.push($mX)}this.skinDic[$aX.name]=$aX,this.skinDataArray.push($aX)}1==$T.getUint8()?(this.yReverseMatrix=new $MX(1,0,0,-1,0,0),$I&&$I.setTempMatrix(this.yReverseMatrix)):$I&&$I.setTempMatrix(new $MX),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},$X.getTexture=function($X){var $g=this.subTextureDic[$X];return $g||($g=this.subTextureDic[$X.substr(0,$X.length-1)]),null==$g?this._mainTexture:$g},$X.showSkinByIndex=function($X,$g,$K){if(void 0===$K&&($K=!0),$g<0&&$g>=this.skinDataArray.length)return!1;var $x,$Z,$n=0,$W=0,$v=this.skinDataArray[$g];if($v){for($n=0,$W=$v.slotArr.length;$n<$W;$n++)($Z=$v.slotArr[$n])&&($x=$X[$Z.name])&&($x.showSlotData($Z,$K),$K&&"undefined"!=$x.attachmentName&&"null"!=$x.attachmentName?$x.showDisplayByName($x.attachmentName):$x.showDisplayByIndex($x.displayIndex));return!0}return!1},$X.getSkinIndexByName=function($X){for(var $g=0,$K=this.skinDataArray.length;$g<$K;$g++)if(this.skinDataArray[$g].name==$X)return $g;return-1},$X.getGrahicsDataWithCache=function($X,$g){return this._graphicsCache[$X][$g]},$X.setGrahicsDataWithCache=function($X,$g,$K){this._graphicsCache[$X][$g]=$K},$X.destroy=function(){var $X;for(var $g in this._isDestroyed=!0,this.subTextureDic)($X=this.subTextureDic[$g])&&$X.destroy();for($g in this._textureDic)($X=this._textureDic[$g])&&$X.destroy();for(var $K=0,$x=this.skinSlotDisplayDataArr.length;$K<$x;$K++)this.skinSlotDisplayDataArr[$K].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete $Z.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},$X.getAniNameByIndex=function($X){var $g=this.getAnimation($X);return $g?$g.name:null},$n(0,$X,"rate",function(){return this._rate},function($X){this._rate=$X}),$Z.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",$Z.TEMPLET_DICTIONARY=null,$Z}($Y)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($X,$g){"use strict";for(var $K in Object.defineProperty($g,"__esModule",{value:!0}),Laya){var $x=Laya[$K];$x&&$x.__isclass&&($g[$K]=$x)}});