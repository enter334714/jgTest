var _=wx.y$;function init(a){let o=wx.getLaunchOptionsSync();return new Promise((n,t)=>{wx.getSystemInfo({success:e=>{wx.request({url:"https://api.huiyaohuyu.com/hy/init",data:{sdkversion:3,channel_id:a.channel_id,imei:wx.getStorageSync("openId"),app_id:a.appId,mobile:a.mobile,device:a.device,brand:e.brand,brand_desc:e.model,type:e.platform,ext:JSON.stringify([{scene:o.scene,query:o.query,referrerInfo:o.referrerInfo}])},success:n,fail:t})}})})}function getOpenId(a){return new Promise((n,t)=>{wx.login({success:e=>{wx.request({url:"https://api.huiyaohuyu.com/minigame/getOpenid",data:{code:e.code,app_id:a},success:n,fail:t})}})})}function userLogin(t){return new Promise((e,n)=>{wx.request({url:"https://u9php.huiyaohuyu.com/login/loginRequest",data:{aid:"0",channelId:t.channel_id,token:wx.getStorageSync("session_key"),ProductId:t.appId,ChannelUserId:wx.getStorageSync("openId"),DeviceId:wx.getStorageSync("device")},success:e,fail:n})})}function setRoleInfo(t){return new Promise((e,n)=>{wx.request({url:"https://bu.huiyaohuyu.com/cs/report",data:{type:1,channel:t.channel,imei:wx.getStorageSync("imei"),userid:wx.getStorageSync("userId"),guid:wx.getStorageSync("openId"),app:t.appId,zone_id:t.zone_id,zone_name:t.zone_name,role_id:t.role_id,role_name:t.role_name,role_level:t.role_level,vip:t.vip,party_name:t.party_name,left_coin:t.left_coin,is_role_create:t.is_role_create},success:e,fail:n})})}function checkPay(t){return new Promise((e,n)=>{wx.request({url:"https://u9php.huiyaohuyu.com/u9/checkPay",method:"GET",data:{total_fee:t.total_fee,u9uid:wx.getStorageSync("userId"),app:t.appId,channel:t.channel_id,role_id:t.role_id,zone_id:t.zone_id,platform:t.platform},success:n=>{-1==n.data.Code?t.isSwitchPayChannel=0:t.isSwitchPayChannel=1,t.callbackUrl="",payRequest(t).then(e=>{0==e.data.Code&&(-1==n.data.Code&&(t.order_id=e.data.OrderId,t.offerId=e.data.Ext.offerId,t.buyQuantity=e.data.Ext.buyQuantity,payMoney(t).then(e=>{console.log(e)})),0==n.data.Code&&wx.openCustomerServiceConversation({sessionFrom:t.appId,showMessageCard:!0,sendMessageImg:"http://res.hyhygame.com/icon/img/goods.jpg"}))})},fail:n})})}function payRequest(t){return new Promise((e,n)=>{wx.request({url:"https://u9php.huiyaohuyu.com/payRequest/payRequest",data:{ProductId:t.appId,ChannelId:t.channel_id,UserId:wx.getStorageSync("userId"),ProductOrderId:t.productOrderId,Amount:t.amount,IsSwitchPayChannel:t.isSwitchPayChannel,CallbackUrl:t.callbackUrl,Ext:t.ext,AppExt:t.appExt,DeviceId:wx.getStorageSync("device"),zone_name:t.zone_name,zone_id:t.zone_id,role_id:t.role_id},success:e,fail:n})})}function payMoney(a){return new Promise((n,t)=>{wx.requestMidasPayment({mode:"game",offerId:a.offerId,currencyType:"CNY",buyQuantity:a.buyQuantity,env:a.env,platform:a.platform,success:e=>{wx.request({url:"https://u9php.huiyaohuyu.com/payNotify/channelPayNotify/"+a.appId+"/"+a.channel_id,method:"POST",data:{order_id:a.order_id,openid:wx.getStorageSync("openId"),amount:a.amount,debug:a.env},success:n,fail:t})}})})}export{init,getOpenId,userLogin,setRoleInfo,checkPay,payRequest,payMoney};