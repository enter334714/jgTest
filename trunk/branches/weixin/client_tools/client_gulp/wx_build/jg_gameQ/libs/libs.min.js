var Laya=window.Laya=function(q$b,q$S){var q$H={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(q$S,q$_){return 1==arguments.length?q$H.__presubstr.call(this,q$S):q$H.__presubstr.call(this,q$S,0<q$_?q$_:this.length+q$_)},__init:function(q$S){q$S.forEach(function(q$S){q$S.__init$&&q$S.__init$()})},__isClass:function(q$S){return q$S&&(q$S.__isclass||q$S==Object||q$S==String||q$S==Array)},__newvec:function(q$S,q$_){var q$a=[];q$a.length=q$S;for(var q$R=0;q$R<q$S;q$R++)q$a[q$R]=q$_;return q$a},__extend:function(q$S,q$_){for(var q$a in q$_)if(q$_.hasOwnProperty(q$a)){var q$R=Object.getOwnPropertyDescriptor(q$_,q$a),q$J=q$R.get,q$V=q$R.set;q$J||q$V?q$J&&q$V?Object.defineProperty(q$S,q$a,q$R):(q$J&&Object.defineProperty(q$S,q$a,q$J),q$V&&Object.defineProperty(q$S,q$a,q$V)):q$S[q$a]=q$_[q$a]}function q$W(){q$H.un(this,"constructor",q$S)}q$W.prototype=q$_.prototype,q$S.prototype=new q$W,q$H.un(q$S.prototype,"__imps",q$H.__copy({},q$_.prototype.__imps))},__copy:function(q$S,q$_){if(!q$_)return null;for(var q$a in q$S=q$S||{},q$_)q$S[q$a]=q$_[q$a];return q$S},__package:function(q$S,q$_){if(!q$H.__packages[q$S]){q$H.__packages[q$S]=!0;var q$a=q$b,q$R=q$S.split(".");if(1<q$R.length)for(var q$J=0,q$V=q$R.length-1;q$J<q$V;q$J++){var q$W=q$a[q$R[q$J]];q$a=q$W||(q$a[q$R[q$J]]={})}q$a[q$R[q$R.length-1]]||(q$a[q$R[q$R.length-1]]=q$_||{})}},__hasOwnProperty:function(q$S,q$_){return q$_=q$_||this,Object.hasOwnProperty.call(q$_,q$S)||function q$S(q$_,q$a){if(Object.hasOwnProperty.call(q$a.prototype,q$_))return!0;var q$R=q$a.prototype.__super;return null==q$R?null:q$S(q$_,q$R)}(q$S,q$_.__class)},__typeof:function(q$S,q$_){if(!q$S||!q$_)return!1;if(q$_===String)return"string"==typeof q$S;if(q$_===Number)return"number"==typeof q$S;if(q$_.__interface__)q$_=q$_.__interface__;else if("string"!=typeof q$_)return q$S instanceof q$_;return q$S.__imps&&q$S.__imps[q$_]||q$S.__class==q$_},__as:function(q$S,q$_){return this.__typeof(q$S,q$_)?q$S:null},__int:function(q$S){return q$S?parseInt(q$S):0},interface:function(q$S,q$_){q$H.__package(q$S,{});var q$a=q$H.__internals,q$R=q$a[q$S]=q$a[q$S]||{self:q$S};if(q$_){var q$J=q$_.split(",");q$R.extend=[];for(var q$V=0;q$V<q$J.length;q$V++){var q$W=q$J[q$V];q$a[q$W]=q$a[q$W]||{self:q$W},q$R.extend.push(q$a[q$W])}}var q$k=q$b,q$z=q$S.split(".");for(q$V=0;q$V<q$z.length-1;q$V++)q$k=q$k[q$z[q$V]];q$k[q$z[q$z.length-1]]={__interface__:q$S}},class:function(q$S,q$_,q$a,q$R){if(q$a&&q$H.__extend(q$S,q$a),q$_)if(q$H.__package(q$_,q$S),q$H.__classmap[q$_]=q$S,0<q$_.indexOf(".")){if(0==q$_.indexOf("laya.")){var q$J=q$_.split(".");q$R=q$R||q$J[q$J.length-1],q$H[q$R]&&console.log("Warning!,this class["+q$R+"] already exist:",q$H[q$R]),q$H[q$R]=q$S}}else"Main"==q$_?q$b.Main=q$S:"MainWX"==q$_?q$b.MainWX=q$S:(q$H[q$_]&&console.log("Error!,this class["+q$_+"] already exist:",q$H[q$_]),q$H[q$_]=q$S);var q$V=q$H.un,q$W=q$S.prototype;q$V(q$W,"hasOwnProperty",q$H.__hasOwnProperty),q$V(q$W,"__class",q$S),q$V(q$W,"__super",q$a),q$V(q$W,"__className",q$_),q$V(q$S,"__super",q$a),q$V(q$S,"__className",q$_),q$V(q$S,"__isclass",!0),q$V(q$S,"super",function(q$S){this.__super.call(q$S)})},imps:function(q$S,q$_){if(!q$_)return null;var q$J=q$S.__imps||q$H.un(q$S,"__imps",{});function q$V(q$S){var q$_,q$a;if((q$_=q$H.__internals[q$S])&&(q$J[q$S]=!0,q$a=q$_.extend))for(var q$R=0;q$R<q$a.length;q$R++)q$V(q$a[q$R].self)}for(var q$a in q$_)q$V(q$a)},superSet:function(q$S,q$_,q$a,q$R){var q$J=q$S.prototype["_$set_"+q$a];q$J&&q$J.call(q$_,q$R)},superGet:function(q$S,q$_,q$a){var q$R=q$S.prototype["_$get_"+q$a];return q$R?q$R.call(q$_):null},getset:function(q$S,q$_,q$a,q$R,q$J){q$S?(q$R&&(q$_["_$GET_"+q$a]=q$R),q$J&&(q$_["_$SET_"+q$a]=q$J)):(q$R&&q$H.un(q$_,"_$get_"+q$a,q$R),q$J&&q$H.un(q$_,"_$set_"+q$a,q$J)),q$R&&q$J?Object.defineProperty(q$_,q$a,{get:q$R,set:q$J,enumerable:!1,configurable:!0}):(q$R&&Object.defineProperty(q$_,q$a,{get:q$R,enumerable:!1,configurable:!0}),q$J&&Object.defineProperty(q$_,q$a,{set:q$J,enumerable:!1,configurable:!0}))},static:function(q$a,q$R){for(var q$J=0,q$S=q$R.length;q$J<q$S;q$J+=2)if("length"==q$R[q$J])q$a.length=q$R[q$J+1].call(q$a);else{function q$_(){var q$_=q$R[q$J],q$S=q$R[q$J+1];Object.defineProperty(q$a,q$_,{get:function(){return delete this[q$_],this[q$_]=q$S.call(this)},set:function(q$S){delete this[q$_],this[q$_]=q$S},enumerable:!0,configurable:!0})}q$_()}},un:function(q$S,q$_,q$a){return q$a||(q$a=q$S[q$_]),q$H.__propun.value=q$a,Object.defineProperty(q$S,q$_,q$H.__propun),q$a},uns:function(q$_,q$S){q$S.forEach(function(q$S){q$H.un(q$_,q$S)})}};return q$b.console=q$b.console||{log:function(){}},q$b.trace=q$b.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),q$H}(window,document);!function(q$S,q$_,q$a){q$a.un,q$a.uns,q$a.static,q$a.class,q$a.getset,q$a.__newvec}(window,document,Laya),function(q$W,q$_,q$q){q$q.un,q$q.uns;var q$z=q$q.static,q$H=q$q.class,q$t=q$q.getset;q$q.__newvec;q$q.interface("laya.runtime.IMarket"),q$q.interface("laya.filters.IFilter"),q$q.interface("laya.display.ILayout"),q$q.interface("laya.resource.IDispose"),q$q.interface("laya.runtime.IPlatform"),q$q.interface("laya.resource.IDestroy"),q$q.interface("laya.runtime.IConchNode"),q$q.interface("laya.filters.IFilterAction"),q$q.interface("laya.runtime.ICPlatformClass"),q$q.interface("laya.resource.ICreateResource"),q$q.interface("laya.runtime.IConchRenderObject"),q$q.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var q$A=function(){function q$V(){}return q$H(q$V,"laya.utils.RunDriver"),q$V.FILTER_ACTIONS=[],q$V.pixelRatio=-1,q$V._charSizeTestDiv=null,q$V.now=function(){return Date.now()},q$V.getWindow=function(){return q$W},q$V.getPixelRatio=function(){if(q$V.pixelRatio<0){var q$S=q$g.context,q$_=q$S.backingStorePixelRatio||q$S.webkitBackingStorePixelRatio||q$S.mozBackingStorePixelRatio||q$S.msBackingStorePixelRatio||q$S.oBackingStorePixelRatio||q$S.backingStorePixelRatio||1;(q$V.pixelRatio=(q$g.window.devicePixelRatio||1)/q$_)<1&&(q$V.pixelRatio=1)}return q$V.pixelRatio},q$V.getIncludeStr=function(q$S){return null},q$V.createShaderCondition=function(q$S){var q$_="(function() {return "+q$S+";})";return q$q._runScript(q$_)},q$V.fontMap=[],q$V.measureText=function(q$S,q$_){var q$a=q$V.hanzi.test(q$S);if(q$a&&q$V.fontMap[q$_])return q$V.fontMap[q$_];var q$R=q$g.context;q$R.font=q$_;var q$J=q$R.measureText(q$S);return q$J||(q$J={width:16,height:16}),q$a&&(q$V.fontMap[q$_]=q$J),q$J},q$V.getWebGLContext=function(q$S){},q$V.beginFlush=function(){},q$V.endFinish=function(){},q$V.addToAtlas=null,q$V.flashFlushImage=function(q$S){},q$V.drawToCanvas=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=q$DS.create("2D"),q$k=new q$P(q$a,q$R,q$W);return q$M.renders[q$_]._fun(q$S,q$k,q$J,q$V),q$W},q$V.createParticleTemplate2D=null,q$V.createGLTextur=null,q$V.createWebGLContext2D=null,q$V.changeWebGLSize=function(q$S,q$_){},q$V.createRenderSprite=function(q$S,q$_){return new q$M(q$S,q$_)},q$V.createFilterAction=function(q$S){return new q$D},q$V.createGraphics=function(){return new q$C},q$V.clear=function(q$S){q$K._context.ctx.clear()},q$V.cancelLoadByUrl=function(q$S){},q$V.clearAtlas=function(q$S){},q$V.isAtlas=function(q$S){return!1},q$V.addTextureToAtlas=function(q$S){},q$V.getTexturePixels=function(q$S,q$_,q$a,q$R,q$J){return null},q$V.skinAniSprite=function(){return null},q$V.update3DLoop=function(){},q$z(q$V,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),q$V}(),q$R=(q$t(1,q$q,"alertGlobalError",null,function(q$S){var q$V=0;q$g.window.onerror=q$S?function(q$S,q$_,q$a,q$R,q$J){q$V++<5&&q$J&&alert(q$J.stack||q$J)}:null}),q$q.init=function(q$S,q$_,q$a){for(var q$R=[],q$J=2,q$V=arguments.length;q$J<q$V;q$J++)q$R.push(arguments[q$J]);if(!q$q._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=q$q._arrayBufferSlice),q$q._isinit=!0,q$g.__init__(),q$r.__init__(),q$C.__init__(),q$q.timer=new q$y,q$q.scaleTimer=new q$y,q$q.loader=new q$zS,q$v.__init__(),q$J=0;for(var q$W=q$R.length;q$J<q$W;q$J++)q$R[q$J].enable&&q$R[q$J].enable();return q$G.__init__(),q$k.__init__(),q$e.__init__(),q$s.beginCheck(),q$q._currentStage=q$q.stage=new q$FS,q$q.stage.conchModel&&q$q.stage.conchModel.setRootNode(),q$q._getUrlPath(),q$q.render=new q$K(0,0),q$q.stage.size(q$S,q$_),q$M.__init__(),q$L.__init__(),q$o.instance.__init__(q$q.stage,q$K.canvas),q$QS.__init__(),q$I.autoStopMusic=!0,q$l.__init__(),q$K.canvas}},q$q._getUrlPath=function(){var q$S=q$g.window.location,q$_=q$S.pathname;q$_=q$_&&":"==q$_.charAt(2)?q$_.substring(1):q$_,q$u.rootPath=q$u.basePath=q$u.getPath("file:"==q$S.protocol?q$_:q$S.protocol+"//"+q$S.host+q$S.pathname)},q$q._arrayBufferSlice=function(q$S,q$_){var q$a=new Uint8Array(this,q$S,q$_-q$S),q$R=new Uint8Array(q$a.length);return q$R.set(q$a),q$R.buffer},q$q._runScript=function(q$S){return q$g.window[q$q._evcode](q$S)},q$q.stage=null,q$q.timer=null,q$q.scaleTimer=null,q$q.loader=null,q$q.version="1.8.6",q$q.render=null,q$q._currentStage=null,q$q._isinit=!1,q$q.isDebug=!1,q$q.MiniAdpter={init:function(){q$W.navigator&&q$W.navigator.userAgent&&-1<q$W.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},q$z(q$q,["conchMarket",function(){return this.conchMarket=q$W.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=q$W.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function q$S(){}return q$H(q$S,"Config"),q$S.WebGLTextCacheCount=500,q$S.atlasEnable=!1,q$S.showCanvasMark=!1,q$S.animationInterval=50,q$S.isAntialias=!1,q$S.isAlpha=!1,q$S.premultipliedAlpha=!0,q$S.isStencil=!0,q$S.preserveDrawingBuffer=!1,q$S}()),q$b=function(){function q$b(){this._events=null}q$H(q$b,"laya.events.EventDispatcher");var q$S=q$b.prototype;return q$S.hasListener=function(q$S){return!!(this._events&&this._events[q$S])},q$S.getListener=function(q$S){return this._events?this._events[q$S]:null},q$S.event=function(q$S,q$_){if(!this._events||!this._events[q$S])return!1;var q$a=this._events[q$S];if(q$a.lock)q$a.queue||(q$a.queue=[]),q$a.queue.push(q$_);else{var q$R;for(q$a.lock=!0,q$a.cursor=q$a.head;q$a.cursor;)(q$R=q$a.cursor).recover?(q$a.head=q$a.tail=q$a.cursor=null,console.error("node is recover："+q$R.id)):(q$a.cursor=q$R.next,q$R.once&&q$b.delNode(q$a,q$R),q$R.method&&(null!=q$_?q$R.args?q$R.method.apply(q$R.caller,q$R.args.concat(q$_)):q$_ instanceof Array?q$R.method.apply(q$R.caller,q$_):q$R.caller?q$R.method.call(q$R.caller,q$_):q$q.recordError("事件派发错误","node.caller:"+q$R.caller+"node.method:"+q$R.method+"data:"+q$_+"node.prev"+q$R.prev):q$R.method.apply(q$R.caller,q$R.args)),q$R.once&&q$b.recoverHandler(q$R));q$a.lock=!1,!q$a.head&&this._events&&this._events[q$S]==q$a&&delete this._events[q$S],q$a.queue&&q$a.queue.length&&this.event(q$S,q$a.queue.shift())}return!0},q$S.on=function(q$S,q$_,q$a,q$R){return this._createListener(q$S,q$_,q$a,q$R,!1)},q$S.once=function(q$S,q$_,q$a,q$R){return this._createListener(q$S,q$_,q$a,q$R,!0)},q$S._createListener=function(q$S,q$_,q$a,q$R,q$J,q$V){void 0===q$V&&(q$V=!0),q$V&&this.off(q$S,q$_,q$a,q$J);var q$W=q$b.createHandler(q$_||this,q$a,q$R,q$J);this._events||(this._events={});var q$k=this._events,q$z=q$k[q$S];return q$z?q$z.tail?(q$W.prev=q$z.tail,q$z.tail.next=q$W,q$z.tail=q$W):q$z.head=q$z.tail=q$W:q$k[q$S]={head:q$W,tail:q$W,cursor:null,lock:!1},this},q$S.off=function(q$S,q$_,q$a,q$R){if(void 0===q$R&&(q$R=!1),!this._events||!this._events[q$S])return this;for(var q$J=this._events[q$S],q$V=q$J.head;q$V;){if((!q$_||q$V.caller===q$_)&&q$V.method===q$a&&(!q$R||q$V.once)){q$b.delNode(q$J,q$V),q$J.cursor==q$V&&(q$J.cursor=q$V.next),q$b.recoverHandler(q$V);break}q$V=q$V.next}return this},q$S.offAll=function(q$S){var q$_=this._events;if(!q$_)return this;if(q$S)this._recoverHandlers(q$_[q$S]),delete q$_[q$S];else{for(var q$a in q$_)this._recoverHandlers(q$_[q$a]);this._events=null}return this},q$S._recoverHandlers=function(q$S){if(q$S){for(var q$_=q$S.head;q$_;){q$b.delNode(q$S,q$_);var q$a=q$_.next;q$b.recoverHandler(q$_),q$_=q$a}q$S.cursor=null}},q$S.isMouseEvent=function(q$S){return q$b.MOUSE_EVENTS[q$S]},q$b.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},q$b.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},q$b.delNode=function(q$S,q$_){q$_.prev?q$_.prev.next=q$_.next:q$S.head=q$_.next,q$_.next?q$_.next.prev=q$_.prev:q$S.tail=q$_.prev},q$b.createHandler=function(q$S,q$_,q$a,q$R){var q$J=500<q$b._freeHandler.length?q$b._freeHandler.shift():null;if(q$J)if(q$J.recover)q$J.recover=!1,q$J.caller=q$S,q$J.method=q$_,q$J.args=q$a,q$J.once=q$R;else{var q$V="";try{arguments.propertyIsEnumerable.caller}catch(q$S){q$V=q$S.stack}var q$W=q$J.caller?(q$J.caller.__proto__&&q$J.caller.__proto__.constructor&&q$J.caller.__proto__.constructor.name)+"|"+q$J.caller.__className+"|"+q$J.caller.name:"",q$k=q$J.method?q$J.method.name:"";q$q.recordError("EventDispatcher重复创建","caller="+q$W+"  method="+q$k+"  stack="+q$V),q$J={id:++q$b._nodeCount,caller:q$S,method:q$_,args:q$a,once:q$R,recover:!1}}else q$J={id:++q$b._nodeCount,caller:q$S,method:q$_,args:q$a,once:q$R,recover:!1};return q$J.prev=q$J.next=null,q$J},q$b.recoverHandler=function(q$S){if(q$S.recover){if(q$b._errorCount<5){q$b._errorCount++;var q$_="";try{arguments.propertyIsEnumerable.caller}catch(q$S){q$_=q$S.stack}var q$a=q$S.caller?(q$S.caller.__proto__&&q$S.caller.__proto__.constructor&&q$S.caller.__proto__.constructor.name)+"|"+q$S.caller.__className+"|"+q$S.caller.name:"",q$R=q$S.method?q$S.method.name:"";q$q.recordError("EventDispatcher重复回收","id="+q$S.id+"  caller="+q$a+"  method="+q$R+"  stack="+q$_)}q$S.caller=q$S.method=q$S.args=q$S.prev=null}else q$S.recover=!0,q$S.caller=q$S.method=q$S.args=q$S.prev=q$S.next=null,q$b._freeHandler&&q$b._freeHandler.length<3e3&&q$b._freeHandler.push(q$S)},q$b._freeHandler=[],q$b._nodeCount=0,q$b._errorCount=0,q$b}(),q$T=function(){function q$J(q$S,q$_,q$a,q$R){this.once=!1,void(this._id=0)===q$R&&(q$R=!1),this.setTo(q$S,q$_,q$a,q$R)}q$H(q$J,"laya.utils.Handler");var q$S=q$J.prototype;return q$S.setTo=function(q$S,q$_,q$a,q$R){return this._id=q$J._gid++,this.caller=q$S,this.method=q$_,this.args=q$a,this.once=q$R,this},q$S.run=function(){if(null==this.method)return null;var q$S=this._id,q$_=this.method.apply(this.caller,this.args);return this._id===q$S&&this.once&&this.recover(),q$_},q$S.runWith=function(q$S){if(null==this.method)return null;var q$_=this._id;if(null==q$S)var q$a=this.method.apply(this.caller,this.args);else q$a=this.args||q$S.unshift?this.args?this.method.apply(this.caller,this.args.concat(q$S)):this.method.apply(this.caller,q$S):this.method.call(this.caller,q$S);return this._id===q$_&&this.once&&this.recover(),q$a},q$S.clear=function(){return this.caller=null,this.method=null,this.args=null,this},q$S.recover=function(){0<this._id&&(this._id=0,this.clear())},q$J.create=function(q$S,q$_,q$a,q$R){return void 0===q$R&&(q$R=!0),new q$J(q$S,q$_,q$a,q$R)},q$J._gid=1,q$J}(),q$B=function(){function q$S(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}q$H(q$S,"laya.display.BitmapFont");var q$_=q$S.prototype;return q$_.loadFont=function(q$S,q$_){this._path=q$S,this._complete=q$_,q$q.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],q$T.create(this,this.onLoaded))},q$_.onLoaded=function(){this.parseFont(q$kS.getRes(this._path),q$kS.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},q$_.parseFont=function(q$S,q$_){if(null!=q$S&&null!=q$_){this._texture=q$_;var q$a=q$S.getElementsByTagName("info");if(!q$a[0].getAttributeNode)return this.parseFont2(q$S,q$_);this.fontSize=parseInt(q$a[0].getAttributeNode("size").nodeValue);var q$R,q$J=q$a[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(q$J[0]),parseInt(q$J[1]),parseInt(q$J[2]),parseInt(q$J[3])],q$R=q$S.getElementsByTagName("char");var q$V=0;for(q$V=0;q$V<q$R.length;q$V++){var q$W=q$R[q$V],q$k=parseInt(q$W.getAttributeNode("id").nodeValue),q$z=parseInt(q$W.getAttributeNode("xoffset").nodeValue)/1,q$b=parseInt(q$W.getAttributeNode("yoffset").nodeValue)/1,q$H=parseInt(q$W.getAttributeNode("xadvance").nodeValue)/1,q$L=new q$n;q$L.x=parseInt(q$W.getAttributeNode("x").nodeValue),q$L.y=parseInt(q$W.getAttributeNode("y").nodeValue),q$L.width=parseInt(q$W.getAttributeNode("width").nodeValue),q$L.height=parseInt(q$W.getAttributeNode("height").nodeValue);var q$C=q$HS.create(q$_,q$L.x,q$L.y,q$L.width,q$L.height,q$z,q$b);this._maxWidth=Math.max(this._maxWidth,q$H+this.letterSpacing),this._fontCharDic[q$k]=q$C,this._fontWidthMap[q$k]=q$H}}},q$_.parseFont2=function(q$S,q$_){if(null!=q$S&&null!=q$_){this._texture=q$_;var q$a=q$S.getElementsByTagName("info");this.fontSize=parseInt(q$a[0].attributes.size.nodeValue);var q$R=q$a[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(q$R[0]),parseInt(q$R[1]),parseInt(q$R[2]),parseInt(q$R[3])];var q$J=q$S.getElementsByTagName("char"),q$V=0;for(q$V=0;q$V<q$J.length;q$V++){var q$W=q$J[q$V].attributes,q$k=parseInt(q$W.id.nodeValue),q$z=parseInt(q$W.xoffset.nodeValue)/1,q$b=parseInt(q$W.yoffset.nodeValue)/1,q$H=parseInt(q$W.xadvance.nodeValue)/1,q$L=new q$n;q$L.x=parseInt(q$W.x.nodeValue),q$L.y=parseInt(q$W.y.nodeValue),q$L.width=parseInt(q$W.width.nodeValue),q$L.height=parseInt(q$W.height.nodeValue);var q$C=q$HS.create(q$_,q$L.x,q$L.y,q$L.width,q$L.height,q$z,q$b);this._maxWidth=Math.max(this._maxWidth,q$H+this.letterSpacing),this._fontCharDic[q$k]=q$C,this._fontWidthMap[q$k]=q$H}}},q$_.getCharTexture=function(q$S){return this._fontCharDic[q$S.charCodeAt(0)]},q$_.destroy=function(){if(this._texture){for(var q$S in this._fontCharDic){var q$_=this._fontCharDic[q$S];q$_&&q$_.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},q$_.setSpaceWidth=function(q$S){this._spaceWidth=q$S},q$_.getCharWidth=function(q$S){var q$_=q$S.charCodeAt(0);return this._fontWidthMap[q$_]?this._fontWidthMap[q$_]+this.letterSpacing:" "==q$S?this._spaceWidth+this.letterSpacing:0},q$_.getTextWidth=function(q$S){for(var q$_=0,q$a=0,q$R=q$S.length;q$a<q$R;q$a++)q$_+=this.getCharWidth(q$S.charAt(q$a));return q$_},q$_.getMaxWidth=function(){return this._maxWidth},q$_.getMaxHeight=function(){return this.fontSize},q$_.drawText=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W,q$k=this.getTextWidth(q$S),q$z=0;"center"===q$J&&(q$z=(q$V-q$k)/2),"right"===q$J&&(q$z=q$V-q$k);for(var q$b=0,q$H=0,q$L=q$S.length;q$H<q$L;q$H++)(q$W=this.getCharTexture(q$S.charAt(q$H)))&&(q$_.graphics.drawTexture(q$W,q$a+q$b+q$z,q$R),q$b+=this.getCharWidth(q$S.charAt(q$H)))},q$S}(),q$k=function(){function q$a(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=q$a._TF_EMPTY}q$H(q$a,"laya.display.css.Style");var q$S=q$a.prototype;return q$S.getTransform=function(){return this._tf},q$S.setTransform=function(q$S){this._tf="none"!==q$S&&q$S?q$S:q$a._TF_EMPTY},q$S.setTranslateX=function(q$S){this._tf===q$a._TF_EMPTY&&(this._tf=new q$J),this._tf.translateX=q$S},q$S.setTranslateY=function(q$S){this._tf===q$a._TF_EMPTY&&(this._tf=new q$J),this._tf.translateY=q$S},q$S.setScaleX=function(q$S){this._tf===q$a._TF_EMPTY&&(this._tf=new q$J),this._tf.scaleX=q$S},q$S.setScale=function(q$S,q$_){this._tf===q$a._TF_EMPTY&&(this._tf=new q$J),this._tf.scaleX=q$S,this._tf.scaleY=q$_},q$S.setScaleY=function(q$S){this._tf===q$a._TF_EMPTY&&(this._tf=new q$J),this._tf.scaleY=q$S},q$S.setRotate=function(q$S){this._tf===q$a._TF_EMPTY&&(this._tf=new q$J),this._tf.rotate=q$S},q$S.setSkewX=function(q$S){this._tf===q$a._TF_EMPTY&&(this._tf=new q$J),this._tf.skewX=q$S},q$S.setSkewY=function(q$S){this._tf===q$a._TF_EMPTY&&(this._tf=new q$J),this._tf.skewY=q$S},q$S.destroy=function(){this.scrollRect=null},q$S.render=function(q$S,q$_,q$a,q$R){},q$S.getCSSStyle=function(){return q$_S.EMPTY},q$S._enableLayout=function(){return!1},q$t(0,q$S,"scaleX",function(){return this._tf.scaleX},function(q$S){this.setScaleX(q$S)}),q$t(0,q$S,"transform",function(){return this.getTransform()},function(q$S){this.setTransform(q$S)}),q$t(0,q$S,"translateX",function(){return this._tf.translateX},function(q$S){this.setTranslateX(q$S)}),q$t(0,q$S,"translateY",function(){return this._tf.translateY},function(q$S){this.setTranslateY(q$S)}),q$t(0,q$S,"scaleY",function(){return this._tf.scaleY},function(q$S){this.setScaleY(q$S)}),q$t(0,q$S,"block",function(){return 0!=(1&this._type)}),q$t(0,q$S,"skewY",function(){return this._tf.skewY},function(q$S){this.setSkewY(q$S)}),q$t(0,q$S,"rotate",function(){return this._tf.rotate},function(q$S){this.setRotate(q$S)}),q$t(0,q$S,"skewX",function(){return this._tf.skewX},function(q$S){this.setSkewX(q$S)}),q$t(0,q$S,"paddingLeft",function(){return 0}),q$t(0,q$S,"paddingTop",function(){return 0}),q$t(0,q$S,"absolute",function(){return!0}),q$a.__init__=function(){q$a._TF_EMPTY=new q$J,q$a.EMPTY=new q$a},q$a.EMPTY=null,q$a._TF_EMPTY=null,q$a}(),q$G=function(){function q$_(q$S){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=q$f.create(q$_.defaultColor),this.family=q$_.defaultFamily,this.stroke=q$_._STROKE,this.size=q$_.defaultSize,q$S&&q$S!==q$_.EMPTY&&q$S.copyTo(this)}q$H(q$_,"laya.display.css.Font");var q$S=q$_.prototype;return q$S.set=function(q$S){this._text=null;for(var q$_=q$S.split(" "),q$a=0,q$R=q$_.length;q$a<q$R;q$a++){var q$J=q$_[q$a];switch(q$J){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<q$J.indexOf("px")&&(this.size=parseInt(q$J),this.family=q$_[q$a+1],q$a++)}},q$S.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},q$S.copyTo=function(q$S){q$S._type=this._type,q$S._text=this._text,q$S._weight=this._weight,q$S._color=this._color,q$S.family=this.family,q$S.stroke=this.stroke!=q$_._STROKE?this.stroke.slice():q$_._STROKE,q$S.indent=this.indent,q$S.size=this.size},q$t(0,q$S,"password",function(){return 0!=(1024&this._type)},function(q$S){q$S?this._type|=1024:this._type&=-1025}),q$t(0,q$S,"color",function(){return this._color.strColor},function(q$S){this._color=q$f.create(q$S)}),q$t(0,q$S,"italic",function(){return 0!=(512&this._type)},function(q$S){q$S?this._type|=512:this._type&=-513}),q$t(0,q$S,"bold",function(){return 0!=(2048&this._type)},function(q$S){q$S?this._type|=2048:this._type&=-2049}),q$t(0,q$S,"weight",function(){return""+this._weight},function(q$S){var q$_=0;switch(q$S){case"normal":break;case"bold":this.bold=!0,q$_=700;break;case"bolder":q$_=800;break;case"lighter":q$_=100;break;default:q$_=parseInt(q$S)}this._weight=q$_,this._text=null}),q$t(0,q$S,"decoration",function(){return this._decoration?this._decoration.value:null},function(q$S){var q$_=q$S.split(" ");switch(this._decoration||(this._decoration={}),q$_[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=q$_[0]}q$_[1]&&(this._decoration.color=q$f.create(q$_)),this._decoration.value=q$S}),q$_.__init__=function(){q$_.EMPTY=new q$_(null)},q$_.EMPTY=null,q$_.defaultColor="#000000",q$_.defaultSize=12,q$_.defaultFamily="Arial",q$_.defaultFont="12px Arial",q$_._STROKE=[0,"#000000"],q$_._ITALIC=512,q$_._PASSWORD=1024,q$_._BOLD=2048,q$_}(),q$J=function(){function q$S(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return q$H(q$S,"laya.display.css.TransformInfo"),q$S}(),q$C=function(){function q$L(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,q$K.isConchNode){this._nativeObj=new q$W._conchGraphics,this.id=this._nativeObj.conchID}}q$H(q$L,"laya.display.Graphics");var q$S=q$L.prototype;return q$S.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},q$S.clear=function(q$S){void 0===q$S&&(q$S=!1);var q$_=0,q$a=0;if(q$S){var q$R=this._one;if(this._cmds){for(q$a=this._cmds.length,q$_=0;q$_<q$a;q$_++)!(q$R=this._cmds[q$_])||q$R.callee!==q$K._context._drawTexture&&q$R.callee!==q$K._context._drawTextureWithTransform||(q$R[0]=null,q$L._cache.push(q$R));this._cmds.length=0}else q$R&&(!q$R||q$R.callee!==q$K._context._drawTexture&&q$R.callee!==q$K._context._drawTextureWithTransform||(q$R[0]=null,q$L._cache.push(q$R)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(q$_=0,q$a=this._vectorgraphArray.length;q$_<q$a;q$_++)q$w.getInstance().deleteShape(this._vectorgraphArray[q$_]);this._vectorgraphArray.length=0}},q$S._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},q$S._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new q$a,this._graphicBounds._graphics=this)},q$S._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},q$S._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},q$S.getBounds=function(q$S){return void 0===q$S&&(q$S=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(q$S)},q$S.getBoundPoints=function(q$S){return void 0===q$S&&(q$S=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(q$S)},q$S._addCmd=function(q$S){this._cmds=this._cmds||[],q$S.callee=q$S.shift(),this._cmds.push(q$S)},q$S.setFilters=function(q$S){this._saveToCmd(q$K._context._setFilters,q$S)},q$S.drawTexture=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){if(void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=0),void 0===q$J&&(q$J=0),void 0===q$W&&(q$W=1),!q$S||q$W<.01)return null;q$R||(q$R=q$S.sourceWidth),q$J||(q$J=q$S.sourceHeight),q$W=q$W<0?0:1<q$W?1:q$W;var q$k,q$z=!q$K.isWebGL&&(q$g.onFirefox||q$g.onEdge||q$g.onIE||q$g.onSafari)?.5:0,q$b=q$R/q$S.sourceWidth,q$H=q$J/q$S.sourceHeight;return q$R=q$S.width*q$b,q$J=q$S.height*q$H,q$S.loaded&&(q$R<=0||q$J<=0)?null:(q$_+=q$S.offsetX*q$b,q$a+=q$S.offsetY*q$H,this._sp&&(this._sp._renderType|=512),q$_-=q$z,q$a-=q$z,q$R+=2*q$z,q$J+=2*q$z,q$L._cache.length?((q$k=q$L._cache.pop())[0]=q$S,q$k[1]=q$_,q$k[2]=q$a,q$k[3]=q$R,q$k[4]=q$J,q$k[5]=q$V,q$k[6]=q$W):q$k=[q$S,q$_,q$a,q$R,q$J,q$V,q$W],q$k.callee=q$V||1!=q$W?q$K._context._drawTextureWithTransform:q$K._context._drawTexture,null!=this._one||q$V||1!=q$W?this._saveToCmd(q$k.callee,q$k):(this._one=q$k,this._render=this._renderOneImg),q$S.loaded||q$S.once("loaded",this,this._textureLoaded,[q$S,q$k]),this._repaint(),q$k)},q$S.cleanByTexture=function(q$S,q$_,q$a,q$R,q$J){if(void 0===q$R&&(q$R=0),void 0===q$J&&(q$J=0),!q$S)return this.clear();if(this._one&&this._render===this._renderOneImg){q$R||(q$R=q$S.sourceWidth),q$J||(q$J=q$S.sourceHeight);var q$V=q$R/q$S.sourceWidth,q$W=q$J/q$S.sourceHeight;q$R=q$S.width*q$V,q$J=q$S.height*q$W,q$_+=q$S.offsetX*q$V,q$a+=q$S.offsetY*q$W,this._one[0]=q$S,this._one[1]=q$_,this._one[2]=q$a,this._one[3]=q$R,this._one[4]=q$J,this._repaint()}else this.clear(),q$S&&this.drawTexture(q$S,q$_,q$a,q$R,q$J)},q$S.drawTextures=function(q$S,q$_){q$S&&this._saveToCmd(q$K._context._drawTextures,[q$S,q$_])},q$S.fillTexture=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){if(void 0===q$R&&(q$R=0),void 0===q$J&&(q$J=0),void 0===q$V&&(q$V="repeat"),q$S){var q$k=[q$S,q$_,q$a,q$R,q$J,q$V,q$W||q$N.EMPTY,{}];q$S.loaded||q$S.once("loaded",this,this._textureLoaded,[q$S,q$k]),this._saveToCmd(q$K._context._fillTexture,q$k)}},q$S._textureLoaded=function(q$S,q$_){q$_[3]=q$_[3]||q$S.width,q$_[4]=q$_[4]||q$S.height,this._repaint()},q$S.fillCircle=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){q$a.bitmap.enableMerageInAtlas=!1;var q$k=new Float32Array(2*(q$W+1)),q$z=new Float32Array(2*(q$W+1)),q$b=new Uint16Array(3*q$W),q$H=2*Math.PI/q$W,q$L=0;q$k[0]=q$R,q$k[1]=q$J,q$z[0]=q$R/q$a.width,q$z[1]=q$J/q$a.height;for(var q$C=2,q$G=0;q$G<q$W;q$G++){var q$t=q$V*Math.cos(q$L)+q$R,q$o=q$V*Math.sin(q$L)+q$J;q$k[q$C]=q$t,q$k[q$C+1]=q$o,q$z[q$C]=q$t/q$a.width,q$z[q$C+1]=q$o/q$a.height,q$L+=q$H,q$C+=2}for(q$G=q$C=0;q$G<q$W;q$G++)q$b[q$C++]=0,q$b[q$C++]=q$G+1,q$b[q$C++]=q$W+1<=q$G+2?1:q$G+2;this.drawTriangles(q$a,q$S,q$_,q$k,q$z,q$b)},q$S.drawTriangles=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){void 0===q$k&&(q$k=1),this._saveToCmd(q$K._context.drawTriangles,[q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b])},q$S._saveToCmd=function(q$S,q$_){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=q$_,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(q$_)),q$_.callee=q$S,this._repaint(),q$_},q$S.clipRect=function(q$S,q$_,q$a,q$R){this._saveToCmd(q$K._context._clipRect,[q$S,q$_,q$a,q$R])},q$S.fillText=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){void 0===q$W&&(q$W=0),this._saveToCmd(q$K._context._fillText,[q$S,q$_,q$a,q$R||q$G.defaultFont,q$J,q$V])},q$S.fillBorderText=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){this._saveToCmd(q$K._context._fillBorderText,[q$S,q$_,q$a,q$R||q$G.defaultFont,q$J,q$V,q$W,q$k])},q$S.strokeText=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this._saveToCmd(q$K._context._strokeText,[q$S,q$_,q$a,q$R||q$G.defaultFont,q$J,q$V,q$W])},q$S.alpha=function(q$S){q$S=q$S<0?0:1<q$S?1:q$S,this._saveToCmd(q$K._context._alpha,[q$S])},q$S.setAlpha=function(q$S){q$S=q$S<0?0:1<q$S?1:q$S,this._saveToCmd(q$K._context._setAlpha,[q$S])},q$S.transform=function(q$S,q$_,q$a){void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),this._saveToCmd(q$K._context._transform,[q$S,q$_,q$a])},q$S.rotate=function(q$S,q$_,q$a){void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),this._saveToCmd(q$K._context._rotate,[q$S,q$_,q$a])},q$S.scale=function(q$S,q$_,q$a,q$R){void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=0),this._saveToCmd(q$K._context._scale,[q$S,q$_,q$a,q$R])},q$S.translate=function(q$S,q$_){this._saveToCmd(q$K._context._translate,[q$S,q$_])},q$S.save=function(){this._saveToCmd(q$K._context._save,[])},q$S.restore=function(){this._saveToCmd(q$K._context._restore,[])},q$S.replaceText=function(q$S){this._repaint();var q$_=this._cmds;if(q$_){for(var q$a=q$_.length-1;-1<q$a;q$a--)if(this._isTextCmd(q$_[q$a].callee))return q$_[q$a][0].toUpperCase?q$_[q$a][0]=q$S:q$_[q$a][0].setText(q$S),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=q$S:this._one[0].setText(q$S),!0;return!1},q$S._isTextCmd=function(q$S){return q$S===q$K._context._fillText||q$S===q$K._context._fillBorderText||q$S===q$K._context._strokeText},q$S.replaceTextColor=function(q$S){this._repaint();var q$_=this._cmds;if(q$_)for(var q$a=q$_.length-1;-1<q$a;q$a--)this._isTextCmd(q$_[q$a].callee)&&(q$_[q$a][4]=q$S,q$_[q$a][0].toUpperCase||(q$_[q$a][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=q$S,this._one[0].toUpperCase||(this._one[0].changed=!0))},q$S.loadImage=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=this;void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=0),void 0===q$J&&(q$J=0);var q$k=q$kS.getRes(q$S);function q$z(q$S){q$S&&(q$W.drawTexture(q$S,q$_,q$a,q$R,q$J),null!=q$V&&q$V.call(q$W._sp,q$S))}q$k?q$z(q$k):q$q.loader.load(q$S,q$T.create(null,q$z),null,"image")},q$S._renderEmpty=function(q$S,q$_,q$a,q$R){},q$S._renderAll=function(q$S,q$_,q$a,q$R){for(var q$J,q$V=this._cmds,q$W=0,q$k=q$V.length;q$W<q$k;q$W++)(q$J=q$V[q$W]).callee.call(q$_,q$a,q$R,q$J)},q$S._renderOne=function(q$S,q$_,q$a,q$R){this._one.callee.call(q$_,q$a,q$R,this._one)},q$S._renderOneImg=function(q$S,q$_,q$a,q$R){this._one.callee.call(q$_,q$a,q$R,this._one),2305!==q$S._renderType&&(q$S._renderType|=1)},q$S.drawLine=function(q$S,q$_,q$a,q$R,q$J,q$V){void 0===q$V&&(q$V=1);var q$W=0;q$K.isWebGL&&(q$W=q$w.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(q$W));var q$k=q$V%2==0?0:.5,q$z=[q$S+q$k,q$_+q$k,q$a+q$k,q$R+q$k,q$J,q$V,q$W];this._saveToCmd(q$K._context._drawLine,q$z)},q$S.drawLines=function(q$S,q$_,q$a,q$R,q$J){void 0===q$J&&(q$J=1);var q$V=0;if(q$a&&!(q$a.length<4)){q$K.isWebGL&&(q$V=q$w.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(q$V));var q$W=q$J%2==0?0:.5,q$k=[q$S+q$W,q$_+q$W,q$a,q$R,q$J,q$V];this._saveToCmd(q$K._context._drawLines,q$k)}},q$S.drawCurves=function(q$S,q$_,q$a,q$R,q$J){void 0===q$J&&(q$J=1);var q$V=[q$S,q$_,q$a,q$R,q$J];this._saveToCmd(q$K._context._drawCurves,q$V)},q$S.drawRect=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){void 0===q$W&&(q$W=1);var q$k=q$V?q$W/2:0,q$z=q$V?q$W:0,q$b=[q$S+q$k,q$_+q$k,q$a-q$z,q$R-q$z,q$J,q$V,q$W];this._saveToCmd(q$K._context._drawRect,q$b)},q$S.drawCircle=function(q$S,q$_,q$a,q$R,q$J,q$V){void 0===q$V&&(q$V=1);var q$W=q$J?q$V/2:0,q$k=0;q$K.isWebGL&&(q$k=q$w.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(q$k));var q$z=[q$S,q$_,q$a-q$W,q$R,q$J,q$V,q$k];this._saveToCmd(q$K._context._drawCircle,q$z)},q$S.drawPie=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){void 0===q$k&&(q$k=1);var q$z=q$W?q$k/2:0,q$b=q$W?q$k:0,q$H=0;q$K.isWebGL&&(q$H=q$w.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(q$H));var q$L=[q$S+q$z,q$_+q$z,q$a-q$b,q$R,q$J,q$V,q$W,q$k,q$H];q$L[3]=q$O.toRadian(q$R),q$L[4]=q$O.toRadian(q$J),this._saveToCmd(q$K._context._drawPie,q$L)},q$S.drawPoly=function(q$S,q$_,q$a,q$R,q$J,q$V){void 0===q$V&&(q$V=1);var q$W=0,q$k=!1;q$K.isWebGL&&(q$W=q$w.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(q$W),q$k=!(6<q$a.length));var q$z=q$J?q$V%2==0?0:.5:0,q$b=[q$S+q$z,q$_+q$z,q$a,q$R,q$J,q$V,q$W,q$k];this._saveToCmd(q$K._context._drawPoly,q$b)},q$S.drawPath=function(q$S,q$_,q$a,q$R,q$J){var q$V=[q$S,q$_,q$a,q$R,q$J];this._saveToCmd(q$K._context._drawPath,q$V)},q$t(0,q$S,"cmds",function(){return this._cmds},function(q$S){this._sp&&(this._sp._renderType|=512),this._cmds=q$S,this._render=this._renderAll,this._repaint()}),q$L.__init__=function(){if(q$K.isConchNode){for(var q$S=laya.display.Graphics.prototype,q$_=q$g.window.ConchGraphics.prototype,q$a=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],q$R=0,q$J=q$a.length;q$R<=q$J;q$R++){var q$V=q$a[q$R];q$S[q$V]=q$_[q$V]}q$S._saveToCmd=null,q$_.drawImageS&&(q$S.drawTextures=function(q$S,q$_){if(q$S&&q$S.loaded&&q$S.bitmap&&q$S.source){var q$a=q$S.uv,q$R=q$S.bitmap.width,q$J=q$S.bitmap.height;this.drawImageS(q$S.bitmap.source,q$a[0]*q$R,q$a[1]*q$J,(q$a[2]-q$a[0])*q$R,(q$a[5]-q$a[3])*q$J,q$S.offsetX,q$S.offsetY,q$S.width,q$S.height,q$_)}}),q$S.drawTexture=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){if(void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=0),void 0===q$J&&(q$J=0),void 0===q$W&&(q$W=1),q$S)if(q$S.loaded){if(q$S.loaded&&q$S.bitmap&&q$S.source&&(q$R||(q$R=q$S.sourceWidth),q$J||(q$J=q$S.sourceHeight),q$W=q$W<0?0:1<q$W?1:q$W,q$R=q$R-q$S.sourceWidth+q$S.width,q$J=q$J-q$S.sourceHeight+q$S.height,!(q$R<=0||q$J<=0))){q$_+=q$S.offsetX,q$a+=q$S.offsetY;var q$k=q$S.uv,q$z=q$S.bitmap.width,q$b=q$S.bitmap.height;q$k[4]<q$k[0]&&q$k[5]<q$k[1]?this.drawImageM(q$S.bitmap.source,q$k[4]*q$z,q$k[5]*q$b,(q$k[0]-q$k[4])*q$z,(q$k[1]-q$k[5])*q$b,q$_,q$a,q$R,q$J,q$V,q$W):this.drawImageM(q$S.bitmap.source,q$k[0]*q$z,q$k[1]*q$b,(q$k[2]-q$k[0])*q$z,(q$k[5]-q$k[3])*q$b,q$_,q$a,q$R,q$J,q$V,q$W),this._repaint()}}else q$S.once("loaded",this,function(){this.drawTexture(q$S,q$_,q$a,q$R,q$J,q$V)})},q$S.fillTexture=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){if(void 0===q$R&&(q$R=0),void 0===q$J&&(q$J=0),void 0===q$V&&(q$V="repeat"),q$S&&q$S.loaded){var q$k,q$z=q$K._context.ctx,q$b=q$S.bitmap.width,q$H=q$S.bitmap.height,q$L=q$S.uv;q$k=q$S.uv!=q$HS.DEF_UV?q$z.createPattern(q$S.bitmap.source,q$V,q$L[0]*q$b,q$L[1]*q$H,(q$L[2]-q$L[0])*q$b,(q$L[5]-q$L[3])*q$H):q$z.createPattern(q$S.bitmap.source,q$V);var q$C=0,q$G=0;q$W&&(q$_+=q$W.x%q$S.width,q$a+=q$W.y%q$S.height,q$C-=q$W.x%q$S.width,q$G-=q$W.y%q$S.height),this._fillImage(q$k,q$_,q$a,q$C,q$G,q$R,q$J)}}}},q$L._cache=[],q$L}(),q$a=function(){function q$D(){this._cacheBoundsType=!1}q$H(q$D,"laya.display.GraphicsBounds");var q$S=q$D.prototype;return q$S.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},q$S.reset=function(){this._temp&&(this._temp.length=0)},q$S.getBounds=function(q$S){return void 0===q$S&&(q$S=!1),(!this._bounds||!this._temp||this._temp.length<1||q$S!=this._cacheBoundsType)&&(this._bounds=q$n._getWrapRec(this.getBoundPoints(q$S),this._bounds)),this._cacheBoundsType=q$S,this._bounds},q$S.getBoundPoints=function(q$S){return void 0===q$S&&(q$S=!1),(!this._temp||this._temp.length<1||q$S!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(q$S)),this._cacheBoundsType=q$S,this._rstBoundPoints=q$O.copyArray(this._rstBoundPoints,this._temp)},q$S._getCmdPoints=function(q$S){void 0===q$S&&(q$S=!1);var q$_,q$a,q$R=q$K._context,q$J=this._graphics.cmds;if((q$_=this._temp||(this._temp=[])).length=0,q$J||null==this._graphics._one||(q$D._tempCmds.length=0,q$D._tempCmds.push(this._graphics._one),q$J=q$D._tempCmds),!q$J)return q$_;(q$a=q$D._tempMatrixArrays).length=0;var q$V=q$D._initMatrix;q$V.identity();for(var q$W,q$k,q$z=q$D._tempMatrix,q$b=NaN,q$H=NaN,q$L=NaN,q$C=NaN,q$G=NaN,q$t=NaN,q$o=0,q$$=q$J.length;q$o<q$$;q$o++)if((q$W=q$J[q$o]).callee)switch(q$W.callee){case q$R._save:case 7:q$a.push(q$V),q$V=q$V.clone();break;case q$R._restore:case 8:q$V=q$a.pop();break;case q$R._scale:case 5:q$z.identity(),q$z.translate(-q$W[2],-q$W[3]),q$z.scale(q$W[0],q$W[1]),q$z.translate(q$W[2],q$W[3]),this._switchMatrix(q$V,q$z);break;case q$R._rotate:case 3:q$z.identity(),q$z.translate(-q$W[1],-q$W[2]),q$z.rotate(q$W[0]),q$z.translate(q$W[1],q$W[2]),this._switchMatrix(q$V,q$z);break;case q$R._translate:case 6:q$z.identity(),q$z.translate(q$W[0],q$W[1]),this._switchMatrix(q$V,q$z);break;case q$R._transform:case 4:q$z.identity(),q$z.translate(-q$W[1],-q$W[2]),q$z.concat(q$W[0]),q$z.translate(q$W[1],q$W[2]),this._switchMatrix(q$V,q$z);break;case 16:case 24:q$D._addPointArrToRst(q$_,q$n._getBoundPointS(q$W[0],q$W[1],q$W[2],q$W[3]),q$V);break;case 17:q$V.copyTo(q$z),q$z.concat(q$W[4]),q$D._addPointArrToRst(q$_,q$n._getBoundPointS(q$W[0],q$W[1],q$W[2],q$W[3]),q$z);break;case q$R._drawTexture:q$k=q$W[0],q$S?q$W[3]&&q$W[4]?q$D._addPointArrToRst(q$_,q$n._getBoundPointS(q$W[1],q$W[2],q$W[3],q$W[4]),q$V):(q$k=q$W[0],q$D._addPointArrToRst(q$_,q$n._getBoundPointS(q$W[1],q$W[2],q$k.width,q$k.height),q$V)):(q$b=(q$W[3]||q$k.sourceWidth)/q$k.width,q$H=(q$W[4]||q$k.sourceHeight)/q$k.height,q$L=q$b*q$k.sourceWidth,q$C=q$H*q$k.sourceHeight,q$G=0<q$k.offsetX?q$k.offsetX:0,q$t=0<q$k.offsetY?q$k.offsetY:0,q$G*=q$b,q$t*=q$H,q$D._addPointArrToRst(q$_,q$n._getBoundPointS(q$W[1]-q$G,q$W[2]-q$t,q$L,q$C),q$V));break;case q$R._fillTexture:q$W[3]&&q$W[4]?q$D._addPointArrToRst(q$_,q$n._getBoundPointS(q$W[1],q$W[2],q$W[3],q$W[4]),q$V):(q$k=q$W[0],q$D._addPointArrToRst(q$_,q$n._getBoundPointS(q$W[1],q$W[2],q$k.width,q$k.height),q$V));break;case q$R._drawTextureWithTransform:var q$F;q$F=q$W[5]?(q$V.copyTo(q$z),q$z.concat(q$W[5]),q$z):q$V,q$S?q$W[3]&&q$W[4]?q$D._addPointArrToRst(q$_,q$n._getBoundPointS(q$W[1],q$W[2],q$W[3],q$W[4]),q$F):(q$k=q$W[0],q$D._addPointArrToRst(q$_,q$n._getBoundPointS(q$W[1],q$W[2],q$k.width,q$k.height),q$F)):(q$k=q$W[0],q$b=(q$W[3]||q$k.sourceWidth)/q$k.width,q$H=(q$W[4]||q$k.sourceHeight)/q$k.height,q$L=q$b*q$k.sourceWidth,q$C=q$H*q$k.sourceHeight,q$G=0<q$k.offsetX?q$k.offsetX:0,q$t=0<q$k.offsetY?q$k.offsetY:0,q$G*=q$b,q$t*=q$H,q$D._addPointArrToRst(q$_,q$n._getBoundPointS(q$W[1]-q$G,q$W[2]-q$t,q$L,q$C),q$F));break;case q$R._drawRect:case 13:q$D._addPointArrToRst(q$_,q$n._getBoundPointS(q$W[0],q$W[1],q$W[2],q$W[3]),q$V);break;case q$R._drawCircle:case q$R._fillCircle:case 14:q$D._addPointArrToRst(q$_,q$n._getBoundPointS(q$W[0]-q$W[2],q$W[1]-q$W[2],q$W[2]+q$W[2],q$W[2]+q$W[2]),q$V);break;case q$R._drawLine:case 20:q$D._tempPoints.length=0;var q$T;q$T=.5*q$W[5],q$W[0]==q$W[2]?q$D._tempPoints.push(q$W[0]+q$T,q$W[1],q$W[2]+q$T,q$W[3],q$W[0]-q$T,q$W[1],q$W[2]-q$T,q$W[3]):q$W[1]==q$W[3]?q$D._tempPoints.push(q$W[0],q$W[1]+q$T,q$W[2],q$W[3]+q$T,q$W[0],q$W[1]-q$T,q$W[2],q$W[3]-q$T):q$D._tempPoints.push(q$W[0],q$W[1],q$W[2],q$W[3]),q$D._addPointArrToRst(q$_,q$D._tempPoints,q$V);break;case q$R._drawCurves:case 22:q$D._addPointArrToRst(q$_,q$j.I.getBezierPoints(q$W[2]),q$V,q$W[0],q$W[1]);break;case q$R._drawPoly:case q$R._drawLines:case 18:q$D._addPointArrToRst(q$_,q$W[2],q$V,q$W[0],q$W[1]);break;case q$R._drawPath:case 19:q$D._addPointArrToRst(q$_,this._getPathPoints(q$W[2]),q$V,q$W[0],q$W[1]);break;case q$R._drawPie:case 15:q$D._addPointArrToRst(q$_,this._getPiePoints(q$W[0],q$W[1],q$W[2],q$W[3],q$W[4]),q$V)}return 200<q$_.length?q$_=q$O.copyArray(q$_,q$n._getWrapRec(q$_)._getBoundPoints()):8<q$_.length&&(q$_=q$Q.scanPList(q$_)),q$_},q$S._switchMatrix=function(q$S,q$_){q$_.concat(q$S),q$_.copyTo(q$S)},q$S._getPiePoints=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$D._tempPoints;q$D._tempPoints.length=0,q$V.push(q$S,q$_);var q$W=(q$J-q$R)%(2*Math.PI)/10,q$k=NaN,q$z=q$R;for(q$k=0;q$k<=10;q$k++)q$V.push(q$S+q$a*Math.cos(q$z),q$_+q$a*Math.sin(q$z)),q$z+=q$W;return q$V},q$S._getPathPoints=function(q$S){var q$_,q$a,q$R=0,q$J=q$D._tempPoints;for(q$J.length=0,q$_=q$S.length,q$R=0;q$R<q$_;q$R++)1<(q$a=q$S[q$R]).length&&(q$J.push(q$a[1],q$a[2]),3<q$a.length&&q$J.push(q$a[3],q$a[4]));return q$J},q$D._addPointArrToRst=function(q$S,q$_,q$a,q$R,q$J){void 0===q$R&&(q$R=0),void 0===q$J&&(q$J=0);var q$V,q$W=0;for(q$V=q$_.length,q$W=0;q$W<q$V;q$W+=2)q$D._addPointToRst(q$S,q$_[q$W]+q$R,q$_[q$W+1]+q$J,q$a)},q$D._addPointToRst=function(q$S,q$_,q$a,q$R){var q$J=q$N.TEMP;q$J.setTo(q$_||0,q$a||0),q$R.transformPoint(q$J),q$S.push(q$J.x,q$J.y)},q$D._tempPoints=[],q$D._tempMatrixArrays=[],q$D._tempCmds=[],q$z(q$D,["_tempMatrix",function(){return this._tempMatrix=new q$X},"_initMatrix",function(){return this._initMatrix=new q$X}]),q$D}(),q$V=function(){function q$S(){}q$H(q$S,"laya.events.Event");var q$_=q$S.prototype;return q$_.setTo=function(q$S,q$_,q$a){return this.type=q$S,this.currentTarget=q$_,this.target=q$a,this},q$_.stopPropagation=function(){this._stoped=!0},q$t(0,q$_,"stageY",function(){return q$q.stage.mouseY}),q$t(0,q$_,"charCode",function(){return this.nativeEvent.charCode}),q$t(0,q$_,"touches",function(){var q$S=this.nativeEvent.touches;if(q$S)for(var q$_=q$q.stage,q$a=0,q$R=q$S.length;q$a<q$R;q$a++){var q$J=q$S[q$a],q$V=q$N.TEMP;q$V.setTo(q$J.clientX,q$J.clientY),q$_._canvasTransform.invertTransformPoint(q$V),q$_.transform.invertTransformPoint(q$V),q$J.stageX=q$V.x,q$J.stageY=q$V.y}return q$S}),q$t(0,q$_,"keyLocation",function(){return this.nativeEvent.keyLocation}),q$t(0,q$_,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),q$t(0,q$_,"altKey",function(){return this.nativeEvent.altKey}),q$t(0,q$_,"shiftKey",function(){return this.nativeEvent.shiftKey}),q$t(0,q$_,"stageX",function(){return q$q.stage.mouseX}),q$S.EMPTY=new q$S,q$S.MOUSE_DOWN="mousedown",q$S.MOUSE_UP="mouseup",q$S.CLICK="click",q$S.RIGHT_MOUSE_DOWN="rightmousedown",q$S.RIGHT_MOUSE_UP="rightmouseup",q$S.RIGHT_CLICK="rightclick",q$S.MOUSE_MOVE="mousemove",q$S.MOUSE_OVER="mouseover",q$S.MOUSE_OUT="mouseout",q$S.MOUSE_WHEEL="mousewheel",q$S.ROLL_OVER="mouseover",q$S.ROLL_OUT="mouseout",q$S.DOUBLE_CLICK="doubleclick",q$S.CHANGE="change",q$S.CHANGED="changed",q$S.RESIZE="resize",q$S.ADDED="added",q$S.REMOVED="removed",q$S.DISPLAY="display",q$S.UNDISPLAY="undisplay",q$S.ERROR="error",q$S.COMPLETE="complete",q$S.LOADED="loaded",q$S.INITED="inited",q$S.PROGRESS="progress",q$S.INPUT="input",q$S.RENDER="render",q$S.OPEN="open",q$S.MESSAGE="message",q$S.CLOSE="close",q$S.KEY_DOWN="keydown",q$S.KEY_PRESS="keypress",q$S.KEY_UP="keyup",q$S.FRAME="enterframe",q$S.DRAG_START="dragstart",q$S.DRAG_MOVE="dragmove",q$S.DRAG_END="dragend",q$S.ENTER="enter",q$S.SELECT="select",q$S.BLUR="blur",q$S.FOCUS="focus",q$S.VISIBILITY_CHANGE="visibilitychange",q$S.FOCUS_CHANGE="focuschange",q$S.PLAYED="played",q$S.PAUSED="paused",q$S.STOPPED="stopped",q$S.START="start",q$S.END="end",q$S.ENABLE_CHANGED="enablechanged",q$S.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",q$S.COMPONENT_ADDED="componentadded",q$S.COMPONENT_REMOVED="componentremoved",q$S.LAYER_CHANGED="layerchanged",q$S.HIERARCHY_LOADED="hierarchyloaded",q$S.RECOVERED="recovered",q$S.RELEASED="released",q$S.LINK="link",q$S.LABEL="label",q$S.FULL_SCREEN_CHANGE="fullscreenchange",q$S.DEVICE_LOST="devicelost",q$S.MESH_CHANGED="meshchanged",q$S.MATERIAL_CHANGED="materialchanged",q$S.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",q$S.ANIMATION_CHANGED="animationchanged",q$S.TRIGGER_ENTER="triggerenter",q$S.TRIGGER_STAY="triggerstay",q$S.TRIGGER_EXIT="triggerexit",q$S.TRAIL_FILTER_CHANGE="trailfilterchange",q$S.DOMINO_FILTER_CHANGE="dominofilterchange",q$S}(),q$L=(function(){function q$S(){}q$H(q$S,"laya.events.Keyboard"),q$S.NUMBER_0=48,q$S.NUMBER_1=49,q$S.NUMBER_2=50,q$S.NUMBER_3=51,q$S.NUMBER_4=52,q$S.NUMBER_5=53,q$S.NUMBER_6=54,q$S.NUMBER_7=55,q$S.NUMBER_8=56,q$S.NUMBER_9=57,q$S.A=65,q$S.B=66,q$S.C=67,q$S.D=68,q$S.E=69,q$S.F=70,q$S.G=71,q$S.H=72,q$S.I=73,q$S.J=74,q$S.K=75,q$S.L=76,q$S.M=77,q$S.N=78,q$S.O=79,q$S.P=80,q$S.Q=81,q$S.R=82,q$S.S=83,q$S.T=84,q$S.U=85,q$S.V=86,q$S.W=87,q$S.X=88,q$S.Y=89,q$S.Z=90,q$S.F1=112,q$S.F2=113,q$S.F3=114,q$S.F4=115,q$S.F5=116,q$S.F6=117,q$S.F7=118,q$S.F8=119,q$S.F9=120,q$S.F10=121,q$S.F11=122,q$S.F12=123,q$S.F13=124,q$S.F14=125,q$S.F15=126,q$S.NUMPAD=21,q$S.NUMPAD_0=96,q$S.NUMPAD_1=97,q$S.NUMPAD_2=98,q$S.NUMPAD_3=99,q$S.NUMPAD_4=100,q$S.NUMPAD_5=101,q$S.NUMPAD_6=102,q$S.NUMPAD_7=103,q$S.NUMPAD_8=104,q$S.NUMPAD_9=105,q$S.NUMPAD_ADD=107,q$S.NUMPAD_DECIMAL=110,q$S.NUMPAD_DIVIDE=111,q$S.NUMPAD_ENTER=108,q$S.NUMPAD_MULTIPLY=106,q$S.NUMPAD_SUBTRACT=109,q$S.SEMICOLON=186,q$S.EQUAL=187,q$S.COMMA=188,q$S.MINUS=189,q$S.PERIOD=190,q$S.SLASH=191,q$S.BACKQUOTE=192,q$S.LEFTBRACKET=219,q$S.BACKSLASH=220,q$S.RIGHTBRACKET=221,q$S.QUOTE=222,q$S.ALTERNATE=18,q$S.BACKSPACE=8,q$S.CAPS_LOCK=20,q$S.COMMAND=15,q$S.CONTROL=17,q$S.DELETE=46,q$S.ENTER=13,q$S.ESCAPE=27,q$S.PAGE_UP=33,q$S.PAGE_DOWN=34,q$S.END=35,q$S.HOME=36,q$S.LEFT=37,q$S.UP=38,q$S.RIGHT=39,q$S.DOWN=40,q$S.SHIFT=16,q$S.SPACE=32,q$S.TAB=9,q$S.INSERT=45}(),function(){function q$J(){}return q$H(q$J,"laya.events.KeyBoardManager"),q$J.__init__=function(){q$J._addEvent("keydown"),q$J._addEvent("keypress"),q$J._addEvent("keyup")},q$J._addEvent=function(q$_){q$g.document.addEventListener(q$_,function(q$S){laya.events.KeyBoardManager._dispatch(q$S,q$_)},!0)},q$J._dispatch=function(q$S,q$_){if(q$J.enabled){q$J._event._stoped=!1,q$J._event.nativeEvent=q$S,q$J._event.keyCode=q$S.keyCode||q$S.which||q$S.charCode,"keydown"===q$_?q$J._pressKeys[q$J._event.keyCode]=!0:"keyup"===q$_&&(q$J._pressKeys[q$J._event.keyCode]=null);for(var q$a=q$q.stage.focus&&null!=q$q.stage.focus.event&&q$q.stage.focus.displayedInStage?q$q.stage.focus:q$q.stage,q$R=q$a;q$R;)q$R.event(q$_,q$J._event.setTo(q$_,q$R,q$a)),q$R=q$R.parent}},q$J.hasKeyDown=function(q$S){return q$J._pressKeys[q$S]},q$J._pressKeys={},q$J.enabled=!0,q$z(q$J,["_event",function(){return this._event=new q$V}]),q$J}()),q$o=(function(){function q$S(){}q$H(q$S,"laya.events.KeyLocation"),q$S.STANDARD=0,q$S.LEFT=1,q$S.RIGHT=2,q$S.NUM_PAD=3}(),function(){function q$b(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=q$g.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new q$V,this._matrix=new q$X,this._point=new q$N,this._rect=new q$n,this._prePoint=new q$N,this._curTouchID=NaN}q$H(q$b,"laya.events.MouseManager");var q$S=q$b.prototype;return q$S.__init__=function(q$S,q$_){var q$a=this;this._stage=q$S;var q$R=this,q$J=this._eventList;q$_.oncontextmenu=function(q$S){if(q$b.enabled)return!1},q$_.addEventListener("mousedown",function(q$S){q$b.enabled&&(q$g.onIE||q$S.preventDefault(),q$J.push(q$S),q$R.mouseDownTime=q$g.now())}),q$_.addEventListener("mouseup",function(q$S){q$b.enabled&&(q$S.preventDefault(),q$J.push(q$S),q$R.mouseDownTime=-q$g.now())},!0),q$_.addEventListener("mousemove",function(q$S){if(q$b.enabled){q$S.preventDefault();var q$_=q$g.now();if(q$_-q$R._lastMoveTimer<10)return;q$R._lastMoveTimer=q$_,q$J.push(q$S)}},!0),q$_.addEventListener("mouseout",function(q$S){q$b.enabled&&q$J.push(q$S)}),q$_.addEventListener("mouseover",function(q$S){q$b.enabled&&q$J.push(q$S)}),q$_.addEventListener("touchstart",function(q$S){q$b.enabled&&(q$J.push(q$S),q$b._isFirstTouch||q$QS.isInputting||q$S.preventDefault(),q$R.mouseDownTime=q$g.now())}),q$_.addEventListener("touchend",function(q$S){q$b.enabled?(q$b._isFirstTouch||q$QS.isInputting||q$S.preventDefault(),q$b._isFirstTouch=!1,q$J.push(q$S),q$R.mouseDownTime=-q$g.now()):q$a._curTouchID=NaN},!0),q$_.addEventListener("touchmove",function(q$S){q$b.enabled&&(q$S.preventDefault(),q$J.push(q$S))},!0),q$_.addEventListener("touchcancel",function(q$S){q$b.enabled?(q$S.preventDefault(),q$J.push(q$S)):q$a._curTouchID=NaN},!0),q$_.addEventListener("mousewheel",function(q$S){q$b.enabled&&q$J.push(q$S)}),q$_.addEventListener("DOMMouseScroll",function(q$S){q$b.enabled&&q$J.push(q$S)})},q$S.initEvent=function(q$S,q$_){var q$a;this._event._stoped=!1,this._event.nativeEvent=q$_||q$S,this._target=null,this._point.setTo(q$S.pageX||q$S.clientX,q$S.pageY||q$S.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=q$S.identifier||0,this._tTouchID=this._event.touchId,(q$a=q$$.I._event)._stoped=!1,q$a.nativeEvent=this._event.nativeEvent,q$a.touchId=this._event.touchId},q$S.checkMouseWheel=function(q$S){this._event.delta=q$S.wheelDelta?.025*q$S.wheelDelta:-q$S.detail;for(var q$_=q$$.I.getLastOvers(),q$a=0,q$R=q$_.length;q$a<q$R;q$a++){var q$J=q$_[q$a];q$J.event("mousewheel",this._event.setTo("mousewheel",q$J,this._target))}},q$S.onMouseMove=function(q$S){q$$.I.onMouseMove(q$S,this._tTouchID)},q$S.onMouseDown=function(q$S){if(q$QS.isInputting&&q$q.stage.focus&&q$q.stage.focus.focus&&!q$q.stage.focus.contains(this._target)){var q$_=q$q.stage.focus._tf||q$q.stage.focus,q$a=q$S._tf||q$S;q$a instanceof laya.display.Input&&q$a.multiline==q$_.multiline?q$_._focusOut():q$_.focus=!1}q$$.I.onMouseDown(q$S,this._tTouchID,this._isLeftMouse)},q$S.onMouseUp=function(q$S){q$$.I.onMouseUp(q$S,this._tTouchID,this._isLeftMouse)},q$S.check=function(q$S,q$_,q$a,q$R){this._point.setTo(q$_,q$a),q$S.fromParentPoint(this._point),q$_=this._point.x,q$a=this._point.y;var q$J=q$S.scrollRect;if(q$J&&(this._rect.setTo(q$J.x,q$J.y,q$J.width,q$J.height),!this._rect.contains(q$_,q$a)))return!1;if(!this.disableMouseEvent){if(q$S.hitTestPrior&&!q$S.mouseThrough&&!this.hitTest(q$S,q$_,q$a))return!1;for(var q$V=q$S._childs.length-1;-1<q$V;q$V--){var q$W=q$S._childs[q$V];if(!q$W.destroyed&&q$W.mouseEnabled&&q$W.visible&&this.check(q$W,q$_,q$a,q$R))return!0}}var q$k=!(!q$S.hitTestPrior||q$S.mouseThrough||this.disableMouseEvent)||this.hitTest(q$S,q$_,q$a);return q$k?(this._target=q$S,q$R.call(this,q$S)):q$R===this.onMouseUp&&q$S===this._stage&&(this._target=this._stage,q$R.call(this,this._target)),q$k},q$S.hitTest=function(q$S,q$_,q$a){var q$R=!1;if(q$S.scrollRect&&(q$_-=q$S.scrollRect.x,q$a-=q$S.scrollRect.y),q$S.hitArea instanceof laya.utils.HitArea)return q$S.hitArea.isHit(q$_,q$a);if(0<q$S.width&&0<q$S.height||q$S.mouseThrough||q$S.hitArea)if(q$S.mouseThrough)q$R=q$S.getGraphicBounds().contains(q$_,q$a);else{var q$J=this._rect;q$S.hitArea?q$J=q$S.hitArea:q$J.setTo(0,0,q$S.width,q$S.height),q$R=q$J.contains(q$_,q$a)}return q$R},q$S.runEvent=function(){var q$S=this._eventList.length;if(q$S){this.mouseEventTime=q$g.now();var q$_,q$a=0,q$R=0,q$J=0;try{for(;q$a<q$S;){var q$V=this._eventList[q$a];switch("mousemove"!==q$V.type&&(this._prePoint.x=this._prePoint.y=-1e6),q$V.type){case"mousedown":this._touchIDs[0]=this._id++,q$b._isTouchRespond?q$b._isTouchRespond=!1:(this._isLeftMouse=0===q$V.button,this.initEvent(q$V),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===q$V.button,this.initEvent(q$V),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-q$V.clientX)+Math.abs(this._prePoint.y-q$V.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=q$V.clientX,this._prePoint.y=q$V.clientY,this.initEvent(q$V),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":q$b._isTouchRespond=!0,this._isLeftMouse=!0;var q$W=q$V.changedTouches;for(q$R=0,q$J=q$W.length;q$R<q$J;q$R++)q$_=q$W[q$R],(q$b.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=q$_.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[q$_.identifier]=this._id++,this.initEvent(q$_,q$V),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":q$b._isTouchRespond=!0,this._isLeftMouse=!0;var q$k=q$V.changedTouches;for(q$R=0,q$J=q$k.length;q$R<q$J;q$R++)if(q$_=q$k[q$R],q$b.multiTouchEnabled||q$_.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(q$_,q$V);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var q$z=q$V.changedTouches;for(q$R=0,q$J=q$z.length;q$R<q$J;q$R++)q$_=q$z[q$R],(q$b.multiTouchEnabled||q$_.identifier==this._curTouchID)&&(this.initEvent(q$_,q$V),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(q$V);break;case"mouseout":q$$.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}q$a++}}catch(q$S){throw this._eventList.length=0,q$S}this._eventList.length=0}},q$b.enabled=!0,q$b.multiTouchEnabled=!0,q$b._isTouchRespond=!1,q$b._isFirstTouch=!0,q$z(q$b,["instance",function(){return this.instance=new q$b}]),q$b}()),q$$=function(){function q$t(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new q$V}q$H(q$t,"laya.events.TouchManager");var q$S=q$t.prototype;return q$S._clearTempArrs=function(){q$t._oldArr.length=0,q$t._newArr.length=0,q$t._tEleArr.length=0},q$S.getTouchFromArr=function(q$S,q$_){var q$a,q$R,q$J=0;for(q$a=q$_.length,q$J=0;q$J<q$a;q$J++)if((q$R=q$_[q$J]).id==q$S)return q$R;return null},q$S.removeTouchFromArr=function(q$S,q$_){var q$a=0;for(q$a=q$_.length-1;0<=q$a;q$a--)q$_[q$a].id==q$S&&q$_.splice(q$a,1)},q$S.createTouchO=function(q$S,q$_){var q$a;return(q$a=q$p.getItem("TouchData")||{}).id=q$_,q$a.tar=q$S,q$a},q$S.onMouseDown=function(q$S,q$_,q$a){var q$R,q$J,q$V,q$W;(void 0===q$a&&(q$a=!1),this.enable)&&(q$R=this.getTouchFromArr(q$_,this.preOvers),q$V=this.getEles(q$S,null,q$t._tEleArr),q$R?q$R.tar=q$S:(q$J=this.createTouchO(q$S,q$_),this.preOvers.push(q$J)),q$g.onMobile&&this.sendEvents(q$V,"mouseover",q$_),q$W=q$a?this.preDowns:this.preRightDowns,(q$R=this.getTouchFromArr(q$_,q$W))?q$R.tar=q$S:(q$J=this.createTouchO(q$S,q$_),q$W.push(q$J)),this.sendEvents(q$V,q$a?"mousedown":"rightmousedown",q$_),this._clearTempArrs())},q$S.sendEvents=function(q$S,q$_,q$a){void 0===q$a&&(q$a=0);var q$R,q$J,q$V,q$W=0;for(q$R=q$S.length,this._event._stoped=!1,q$J=q$S[0],q$W=0;q$W<q$R;q$W++){if((q$V=q$S[q$W]).destroyed)return;if(q$V.event(q$_,this._event.setTo(q$_,q$V,q$J)),this._event._stoped)break}},q$S.getEles=function(q$S,q$_,q$a){for(q$a?q$a.length=0:q$a=[];q$S&&q$S!=q$_;)q$a.push(q$S),q$S=q$S.parent;return q$a},q$S.checkMouseOutAndOverOfMove=function(q$S,q$_,q$a){if(void 0===q$a&&(q$a=0),q$_!=q$S){var q$R,q$J,q$V=0,q$W=0;if(q$_.contains(q$S))q$J=this.getEles(q$S,q$_,q$t._tEleArr),this.sendEvents(q$J,"mouseover",q$a);else if(q$S.contains(q$_))q$J=this.getEles(q$_,q$S,q$t._tEleArr),this.sendEvents(q$J,"mouseout",q$a);else{var q$k,q$z;(q$J=q$t._tEleArr).length=0,q$k=this.getEles(q$_,null,q$t._oldArr),q$z=this.getEles(q$S,null,q$t._newArr),q$W=q$k.length;var q$b=0;for(q$V=0;q$V<q$W;q$V++){if(q$R=q$k[q$V],0<=(q$b=q$z.indexOf(q$R))){q$z.splice(q$b,q$z.length-q$b);break}q$J.push(q$R)}0<q$J.length&&this.sendEvents(q$J,"mouseout",q$a),0<q$z.length&&this.sendEvents(q$z,"mouseover",q$a)}}},q$S.onMouseMove=function(q$S,q$_){var q$a,q$R;this.enable&&((q$a=this.getTouchFromArr(q$_,this.preOvers))?(this.checkMouseOutAndOverOfMove(q$S,q$a.tar),q$a.tar=q$S,q$R=this.getEles(q$S,null,q$t._tEleArr)):(q$R=this.getEles(q$S,null,q$t._tEleArr),this.sendEvents(q$R,"mouseover",q$_),this.preOvers.push(this.createTouchO(q$S,q$_))),this.sendEvents(q$R,"mousemove",q$_),this._clearTempArrs())},q$S.getLastOvers=function(){return(q$t._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,q$t._tEleArr):(q$t._tEleArr.push(q$q.stage),q$t._tEleArr)},q$S.stageMouseOut=function(){var q$S;q$S=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(q$S,"mouseout",0)},q$S.onMouseUp=function(q$S,q$_,q$a){if(void 0===q$a&&(q$a=!1),this.enable){var q$R,q$J,q$V,q$W,q$k,q$z,q$b=0,q$H=0,q$L=q$g.onMobile;if(q$J=this.getEles(q$S,null,q$t._tEleArr),this.sendEvents(q$J,q$a?"mouseup":"rightmouseup",q$_),q$z=q$a?this.preDowns:this.preRightDowns,q$R=this.getTouchFromArr(q$_,q$z)){var q$C,q$G=q$g.now();if(q$C=q$G-this._lastClickTime<300,this._lastClickTime=q$G,q$S==q$R.tar)q$k=q$J;else for(q$V=this.getEles(q$R.tar,null,q$t._oldArr),(q$k=q$t._newArr).length=0,q$H=q$V.length,q$b=0;q$b<q$H;q$b++)q$W=q$V[q$b],0<=q$J.indexOf(q$W)&&q$k.push(q$W);0<q$k.length&&this.sendEvents(q$k,q$a?"click":"rightclick",q$_),q$a&&q$C&&this.sendEvents(q$k,"doubleclick",q$_),this.removeTouchFromArr(q$_,q$z),q$R.tar=null,q$p.recover("TouchData",q$R)}else;(q$R=this.getTouchFromArr(q$_,this.preOvers))&&q$L&&((q$k=this.getEles(q$R.tar,null,q$k))&&0<q$k.length&&this.sendEvents(q$k,"mouseout",q$_),this.removeTouchFromArr(q$_,this.preOvers),q$R.tar=null,q$p.recover("TouchData",q$R)),this._clearTempArrs()}},q$t._oldArr=[],q$t._newArr=[],q$t._tEleArr=[],q$z(q$t,["I",function(){return this.I=new q$t}]),q$t}(),q$F=function(){function q$S(){this._action=null}q$H(q$S,"laya.filters.Filter");var q$_=q$S.prototype;return q$q.imps(q$_,{"laya.filters.IFilter":!0}),q$_.callNative=function(q$S){},q$t(0,q$_,"type",function(){return-1}),q$t(0,q$_,"action",function(){return this._action}),q$S.BLUR=16,q$S.COLOR=32,q$S.GLOW=8,q$S._filterStart=null,q$S._filterEnd=null,q$S._EndTarget=null,q$S._recycleScope=null,q$S._filter=null,q$S._useSrc=null,q$S._endSrc=null,q$S._useOut=null,q$S._endOut=null,q$S}(),q$D=function(){function q$S(){this.data=null}q$H(q$S,"laya.filters.ColorFilterAction");var q$_=q$S.prototype;return q$q.imps(q$_,{"laya.filters.IFilterAction":!0}),q$_.apply=function(q$S){var q$_=q$S.ctx.ctx,q$a=q$S.ctx.ctx.canvas;if(0==q$a.width||0==q$a.height)return q$a;for(var q$R,q$J=q$_.getImageData(0,0,q$a.width,q$a.height),q$V=q$J.data,q$W=0,q$k=q$V.length;q$W<q$k;q$W+=4)q$R=this.getColor(q$V[q$W],q$V[q$W+1],q$V[q$W+2],q$V[q$W+3]),0!=q$V[q$W+3]&&(q$V[q$W]=q$R[0],q$V[q$W+1]=q$R[1],q$V[q$W+2]=q$R[2],q$V[q$W+3]=q$R[3]);return q$_.putImageData(q$J,0,0),q$S},q$_.getColor=function(q$S,q$_,q$a,q$R){var q$J=[];if(this.data._mat&&this.data._alpha){var q$V=this.data._mat,q$W=this.data._alpha;q$J[0]=q$V[0]*q$S+q$V[1]*q$_+q$V[2]*q$a+q$V[3]*q$R+q$W[0],q$J[1]=q$V[4]*q$S+q$V[5]*q$_+q$V[6]*q$a+q$V[7]*q$R+q$W[1],q$J[2]=q$V[8]*q$S+q$V[9]*q$_+q$V[10]*q$a+q$V[11]*q$R+q$W[2],q$J[3]=q$V[12]*q$S+q$V[13]*q$_+q$V[14]*q$a+q$V[15]*q$R+q$W[3]}return q$J},q$S}(),q$j=(function(){function q$S(){}q$H(q$S,"laya.maths.Arith"),q$S.formatR=function(q$S){return q$S>Math.PI&&(q$S-=2*Math.PI),q$S<-Math.PI&&(q$S+=2*Math.PI),q$S},q$S.isPOT=function(q$S,q$_){return 0<q$S&&0==(q$S&q$S-1)&&0<q$_&&0==(q$_&q$_-1)},q$S.setMatToArray=function(q$S,q$_){q$S.a,q$S.b,q$S.c,q$S.d,q$S.tx,q$S.ty,q$_[0]=q$S.a,q$_[1]=q$S.b,q$_[4]=q$S.c,q$_[5]=q$S.d,q$_[12]=q$S.tx,q$_[13]=q$S.ty}}(),function(){function q$S(){this._controlPoints=[new q$N,new q$N,new q$N],this._calFun=this.getPoint2}q$H(q$S,"laya.maths.Bezier");var q$_=q$S.prototype;return q$_._switchPoint=function(q$S,q$_){var q$a=this._controlPoints.shift();q$a.setTo(q$S,q$_),this._controlPoints.push(q$a)},q$_.getPoint2=function(q$S,q$_){var q$a=this._controlPoints[0],q$R=this._controlPoints[1],q$J=this._controlPoints[2],q$V=Math.pow(1-q$S,2)*q$a.x+2*q$S*(1-q$S)*q$R.x+Math.pow(q$S,2)*q$J.x,q$W=Math.pow(1-q$S,2)*q$a.y+2*q$S*(1-q$S)*q$R.y+Math.pow(q$S,2)*q$J.y;q$_.push(q$V,q$W)},q$_.getPoint3=function(q$S,q$_){var q$a=this._controlPoints[0],q$R=this._controlPoints[1],q$J=this._controlPoints[2],q$V=this._controlPoints[3],q$W=Math.pow(1-q$S,3)*q$a.x+3*q$R.x*q$S*(1-q$S)*(1-q$S)+3*q$J.x*q$S*q$S*(1-q$S)+q$V.x*Math.pow(q$S,3),q$k=Math.pow(1-q$S,3)*q$a.y+3*q$R.y*q$S*(1-q$S)*(1-q$S)+3*q$J.y*q$S*q$S*(1-q$S)+q$V.y*Math.pow(q$S,3);q$_.push(q$W,q$k)},q$_.insertPoints=function(q$S,q$_){var q$a,q$R=NaN;for(q$a=1/(q$S=0<q$S?q$S:5),q$R=0;q$R<=1;q$R+=q$a)this._calFun(q$R,q$_)},q$_.getBezierPoints=function(q$S,q$_,q$a){void 0===q$_&&(q$_=5),void 0===q$a&&(q$a=2);var q$R,q$J,q$V=0;if((q$R=q$S.length)<2*(q$a+1))return[];switch(q$J=[],q$a){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=q$a;)this._controlPoints.push(new q$N);for(q$V=0;q$V<2*q$a;q$V+=2)this._switchPoint(q$S[q$V],q$S[q$V+1]);for(q$V=2*q$a;q$V<q$R;q$V+=2)this._switchPoint(q$S[q$V],q$S[q$V+1]),q$V/2%q$a==0&&this.insertPoints(q$_,q$J);return q$J},q$z(q$S,["I",function(){return this.I=new q$S}]),q$S}()),q$Q=function(){function q$b(){}return q$H(q$b,"laya.maths.GrahamScan"),q$b.multiply=function(q$S,q$_,q$a){return(q$S.x-q$a.x)*(q$_.y-q$a.y)-(q$_.x-q$a.x)*(q$S.y-q$a.y)},q$b.dis=function(q$S,q$_){return(q$S.x-q$_.x)*(q$S.x-q$_.x)+(q$S.y-q$_.y)*(q$S.y-q$_.y)},q$b._getPoints=function(q$S,q$_,q$a){for(void 0===q$_&&(q$_=!1),q$b._mPointList||(q$b._mPointList=[]);q$b._mPointList.length<q$S;)q$b._mPointList.push(new q$N);return q$a||(q$a=[]),q$a.length=0,q$_?q$b.getFrom(q$a,q$b._mPointList,q$S):q$b.getFromR(q$a,q$b._mPointList,q$S),q$a},q$b.getFrom=function(q$S,q$_,q$a){var q$R=0;for(q$R=0;q$R<q$a;q$R++)q$S.push(q$_[q$R]);return q$S},q$b.getFromR=function(q$S,q$_,q$a){var q$R=0;for(q$R=0;q$R<q$a;q$R++)q$S.push(q$_.pop());return q$S},q$b.pListToPointList=function(q$S,q$_){void 0===q$_&&(q$_=!1);var q$a=0,q$R=q$S.length/2,q$J=q$b._getPoints(q$R,q$_,q$b._tempPointList);for(q$a=0;q$a<q$R;q$a++)q$J[q$a].setTo(q$S[q$a+q$a],q$S[q$a+q$a+1]);return q$J},q$b.pointListToPlist=function(q$S){var q$_,q$a=0,q$R=q$S.length,q$J=q$b._temPList;for(q$a=q$J.length=0;q$a<q$R;q$a++)q$_=q$S[q$a],q$J.push(q$_.x,q$_.y);return q$J},q$b.scanPList=function(q$S){return q$O.copyArray(q$S,q$b.pointListToPlist(q$b.scan(q$b.pListToPointList(q$S,!0))))},q$b.scan=function(q$S){var q$_,q$a,q$R,q$J=0,q$V=0,q$W=0,q$k=q$S.length,q$z={};for((q$a=q$b._temArr).length=0,q$J=(q$k=q$S.length)-1;0<=q$J;q$J--)q$R=(q$_=q$S[q$J]).x+"_"+q$_.y,q$z.hasOwnProperty(q$R)||(q$z[q$R]=!0,q$a.push(q$_));for(q$k=q$a.length,q$O.copyArray(q$S,q$a),q$J=1;q$J<q$k;q$J++)(q$S[q$J].y<q$S[q$W].y||q$S[q$J].y==q$S[q$W].y&&q$S[q$J].x<q$S[q$W].x)&&(q$W=q$J);for(q$_=q$S[0],q$S[0]=q$S[q$W],q$S[q$W]=q$_,q$J=1;q$J<q$k-1;q$J++){for(q$V=(q$W=q$J)+1;q$V<q$k;q$V++)(0<q$b.multiply(q$S[q$V],q$S[q$W],q$S[0])||0==q$b.multiply(q$S[q$V],q$S[q$W],q$S[0])&&q$b.dis(q$S[0],q$S[q$V])<q$b.dis(q$S[0],q$S[q$W]))&&(q$W=q$V);q$_=q$S[q$J],q$S[q$J]=q$S[q$W],q$S[q$W]=q$_}if((q$a=q$b._temArr).length=0,q$S.length<3)return q$O.copyArray(q$a,q$S);for(q$a.push(q$S[0],q$S[1],q$S[2]),q$J=3;q$J<q$k;q$J++){for(;2<=q$a.length&&0<=q$b.multiply(q$S[q$J],q$a[q$a.length-1],q$a[q$a.length-2]);)q$a.pop();q$S[q$J]&&q$a.push(q$S[q$J])}return q$a},q$b._mPointList=null,q$b._tempPointList=[],q$b._temPList=[],q$b._temArr=[],q$b}(),q$m=function(){function q$J(){}return q$H(q$J,"laya.maths.MathUtil"),q$J.subtractVector3=function(q$S,q$_,q$a){q$a[0]=q$S[0]-q$_[0],q$a[1]=q$S[1]-q$_[1],q$a[2]=q$S[2]-q$_[2]},q$J.lerp=function(q$S,q$_,q$a){return q$S*(1-q$a)+q$_*q$a},q$J.scaleVector3=function(q$S,q$_,q$a){q$a[0]=q$S[0]*q$_,q$a[1]=q$S[1]*q$_,q$a[2]=q$S[2]*q$_},q$J.lerpVector3=function(q$S,q$_,q$a,q$R){var q$J=q$S[0],q$V=q$S[1],q$W=q$S[2];q$R[0]=q$J+q$a*(q$_[0]-q$J),q$R[1]=q$V+q$a*(q$_[1]-q$V),q$R[2]=q$W+q$a*(q$_[2]-q$W)},q$J.lerpVector4=function(q$S,q$_,q$a,q$R){var q$J=q$S[0],q$V=q$S[1],q$W=q$S[2],q$k=q$S[3];q$R[0]=q$J+q$a*(q$_[0]-q$J),q$R[1]=q$V+q$a*(q$_[1]-q$V),q$R[2]=q$W+q$a*(q$_[2]-q$W),q$R[3]=q$k+q$a*(q$_[3]-q$k)},q$J.slerpQuaternionArray=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){var q$k,q$z,q$b,q$H,q$L,q$C=q$S[q$_+0],q$G=q$S[q$_+1],q$t=q$S[q$_+2],q$o=q$S[q$_+3],q$$=q$a[q$R+0],q$F=q$a[q$R+1],q$T=q$a[q$R+2],q$D=q$a[q$R+3];return(q$z=q$C*q$$+q$G*q$F+q$t*q$T+q$o*q$D)<0&&(q$z=-q$z,q$$=-q$$,q$F=-q$F,q$T=-q$T,q$D=-q$D),q$L=1e-6<1-q$z?(q$k=Math.acos(q$z),q$b=Math.sin(q$k),q$H=Math.sin((1-q$J)*q$k)/q$b,Math.sin(q$J*q$k)/q$b):(q$H=1-q$J,q$J),q$V[q$W+0]=q$H*q$C+q$L*q$$,q$V[q$W+1]=q$H*q$G+q$L*q$F,q$V[q$W+2]=q$H*q$t+q$L*q$T,q$V[q$W+3]=q$H*q$o+q$L*q$D,q$V},q$J.getRotation=function(q$S,q$_,q$a,q$R){return Math.atan2(q$R-q$_,q$a-q$S)/Math.PI*180},q$J.sortBigFirst=function(q$S,q$_){return q$S==q$_?0:q$S<q$_?1:-1},q$J.sortSmallFirst=function(q$S,q$_){return q$S==q$_?0:q$S<q$_?-1:1},q$J.sortNumBigFirst=function(q$S,q$_){return parseFloat(q$_)-parseFloat(q$S)},q$J.sortNumSmallFirst=function(q$S,q$_){return parseFloat(q$S)-parseFloat(q$_)},q$J.sortByKey=function(q$a,q$S,q$_){var q$R;return void 0===q$S&&(q$S=!1),void 0===q$_&&(q$_=!0),q$R=q$S?q$_?q$J.sortNumBigFirst:q$J.sortBigFirst:q$_?q$J.sortNumSmallFirst:q$J.sortSmallFirst,function(q$S,q$_){return q$R(q$S[q$a],q$_[q$a])}},q$J}(),q$X=function(){function q$a(q$S,q$_,q$a,q$R,q$J,q$V){this.inPool=!1,this.bTransform=!1,void 0===q$S&&(q$S=1),void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=1),void 0===q$J&&(q$J=0),void 0===q$V&&(q$V=0),this.a=q$S,this.b=q$_,this.c=q$a,this.d=q$R,this.tx=q$J,this.ty=q$V,this._checkTransform()}q$H(q$a,"laya.maths.Matrix");var q$S=q$a.prototype;return q$S.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},q$S._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},q$S.setTranslate=function(q$S,q$_){return this.tx=q$S,this.ty=q$_,this},q$S.translate=function(q$S,q$_){return this.tx+=q$S,this.ty+=q$_,this},q$S.scale=function(q$S,q$_){this.a*=q$S,this.d*=q$_,this.c*=q$S,this.b*=q$_,this.tx*=q$S,this.ty*=q$_,this.bTransform=!0},q$S.rotate=function(q$S){var q$_=Math.cos(q$S),q$a=Math.sin(q$S),q$R=this.a,q$J=this.c,q$V=this.tx;this.a=q$R*q$_-this.b*q$a,this.b=q$R*q$a+this.b*q$_,this.c=q$J*q$_-this.d*q$a,this.d=q$J*q$a+this.d*q$_,this.tx=q$V*q$_-this.ty*q$a,this.ty=q$V*q$a+this.ty*q$_,this.bTransform=!0},q$S.skew=function(q$S,q$_){var q$a=Math.tan(q$S),q$R=Math.tan(q$_),q$J=this.a,q$V=this.b;return this.a+=q$R*this.c,this.b+=q$R*this.d,this.c+=q$a*q$J,this.d+=q$a*q$V,this},q$S.invertTransformPoint=function(q$S){var q$_=this.a,q$a=this.b,q$R=this.c,q$J=this.d,q$V=this.tx,q$W=q$_*q$J-q$a*q$R,q$k=q$J/q$W,q$z=-q$a/q$W,q$b=-q$R/q$W,q$H=q$_/q$W,q$L=(q$R*this.ty-q$J*q$V)/q$W,q$C=-(q$_*this.ty-q$a*q$V)/q$W;return q$S.setTo(q$k*q$S.x+q$b*q$S.y+q$L,q$z*q$S.x+q$H*q$S.y+q$C)},q$S.transformPoint=function(q$S){return q$S.setTo(this.a*q$S.x+this.c*q$S.y+this.tx,this.b*q$S.x+this.d*q$S.y+this.ty)},q$S.transformPointN=function(q$S){return q$S.setTo(this.a*q$S.x+this.c*q$S.y,this.b*q$S.x+this.d*q$S.y)},q$S.transformPointArray=function(q$S,q$_){for(var q$a=q$S.length,q$R=0;q$R<q$a;q$R+=2){var q$J=q$S[q$R],q$V=q$S[q$R+1];q$_[q$R]=this.a*q$J+this.c*q$V+this.tx,q$_[q$R+1]=this.b*q$J+this.d*q$V+this.ty}return q$_},q$S.transformPointArrayScale=function(q$S,q$_){for(var q$a=q$S.length,q$R=0;q$R<q$a;q$R+=2){var q$J=q$S[q$R],q$V=q$S[q$R+1];q$_[q$R]=this.a*q$J+this.c*q$V,q$_[q$R+1]=this.b*q$J+this.d*q$V}return q$_},q$S.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},q$S.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},q$S.invert=function(){var q$S=this.a,q$_=this.b,q$a=this.c,q$R=this.d,q$J=this.tx,q$V=q$S*q$R-q$_*q$a;return this.a=q$R/q$V,this.b=-q$_/q$V,this.c=-q$a/q$V,this.d=q$S/q$V,this.tx=(q$a*this.ty-q$R*q$J)/q$V,this.ty=-(q$S*this.ty-q$_*q$J)/q$V,this},q$S.setTo=function(q$S,q$_,q$a,q$R,q$J,q$V){return this.a=q$S,this.b=q$_,this.c=q$a,this.d=q$R,this.tx=q$J,this.ty=q$V,this},q$S.concat=function(q$S){var q$_=this.a,q$a=this.c,q$R=this.tx;return this.a=q$_*q$S.a+this.b*q$S.c,this.b=q$_*q$S.b+this.b*q$S.d,this.c=q$a*q$S.a+this.d*q$S.c,this.d=q$a*q$S.b+this.d*q$S.d,this.tx=q$R*q$S.a+this.ty*q$S.c+q$S.tx,this.ty=q$R*q$S.b+this.ty*q$S.d+q$S.ty,this},q$S.scaleEx=function(q$S,q$_){var q$a=this.a,q$R=this.b,q$J=this.c,q$V=this.d;0!==q$R||0!==q$J?(this.a=q$S*q$a,this.b=q$S*q$R,this.c=q$_*q$J):(this.a=q$S*q$a,this.b=0*q$V,this.c=0*q$a),this.d=q$_*q$V,this.bTransform=!0},q$S.rotateEx=function(q$S){var q$_=Math.cos(q$S),q$a=Math.sin(q$S),q$R=this.a,q$J=this.b,q$V=this.c,q$W=this.d;0!==q$J||0!==q$V?(this.a=q$_*q$R+q$a*q$V,this.b=q$_*q$J+q$a*q$W,this.c=-q$a*q$R+q$_*q$V,this.d=-q$a*q$J+q$_*q$W):(this.a=q$_*q$R,this.b=q$a*q$W,this.c=-q$a*q$R,this.d=q$_*q$W),this.bTransform=!0},q$S.clone=function(){var q$S=q$a.create();return q$S.a=this.a,q$S.b=this.b,q$S.c=this.c,q$S.d=this.d,q$S.tx=this.tx,q$S.ty=this.ty,q$S.bTransform=this.bTransform,q$S},q$S.copyTo=function(q$S){return q$S.a=this.a,q$S.b=this.b,q$S.c=this.c,q$S.d=this.d,q$S.tx=this.tx,q$S.ty=this.ty,q$S.bTransform=this.bTransform,q$S},q$S.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},q$S.destroy=function(){if(!this.inPool){var q$S=q$a._cache;this.inPool=!0,q$S._length||(q$S._length=0),(q$S[q$S._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},q$a.mul=function(q$S,q$_,q$a){var q$R=q$S.a,q$J=q$S.b,q$V=q$S.c,q$W=q$S.d,q$k=q$S.tx,q$z=q$S.ty,q$b=q$_.a,q$H=q$_.b,q$L=q$_.c,q$C=q$_.d,q$G=q$_.tx,q$t=q$_.ty;return 0!==q$H||0!==q$L?(q$a.a=q$R*q$b+q$J*q$L,q$a.b=q$R*q$H+q$J*q$C,q$a.c=q$V*q$b+q$W*q$L,q$a.d=q$V*q$H+q$W*q$C,q$a.tx=q$b*q$k+q$L*q$z+q$G,q$a.ty=q$H*q$k+q$C*q$z+q$t):(q$a.a=q$R*q$b,q$a.b=q$J*q$C,q$a.c=q$V*q$b,q$a.d=q$W*q$C,q$a.tx=q$b*q$k+q$G,q$a.ty=q$C*q$z+q$t),q$a},q$a.mul16=function(q$S,q$_,q$a){var q$R=q$S.a,q$J=q$S.b,q$V=q$S.c,q$W=q$S.d,q$k=q$S.tx,q$z=q$S.ty,q$b=q$_.a,q$H=q$_.b,q$L=q$_.c,q$C=q$_.d,q$G=q$_.tx,q$t=q$_.ty;return 0!==q$H||0!==q$L?(q$a[0]=q$R*q$b+q$J*q$L,q$a[1]=q$R*q$H+q$J*q$C,q$a[4]=q$V*q$b+q$W*q$L,q$a[5]=q$V*q$H+q$W*q$C,q$a[12]=q$b*q$k+q$L*q$z+q$G,q$a[13]=q$H*q$k+q$C*q$z+q$t):(q$a[0]=q$R*q$b,q$a[1]=q$J*q$C,q$a[4]=q$V*q$b,q$a[5]=q$W*q$C,q$a[12]=q$b*q$k+q$G,q$a[13]=q$C*q$z+q$t),q$a},q$a.mulPre=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){var q$z=q$S.a,q$b=q$S.b,q$H=q$S.c,q$L=q$S.d,q$C=q$S.tx,q$G=q$S.ty;return 0!==q$a||0!==q$R?(q$k.a=q$z*q$_+q$b*q$R,q$k.b=q$z*q$a+q$b*q$J,q$k.c=q$H*q$_+q$L*q$R,q$k.d=q$H*q$a+q$L*q$J,q$k.tx=q$_*q$C+q$R*q$G+q$V,q$k.ty=q$a*q$C+q$J*q$G+q$W):(q$k.a=q$z*q$_,q$k.b=q$b*q$J,q$k.c=q$H*q$_,q$k.d=q$L*q$J,q$k.tx=q$_*q$C+q$V,q$k.ty=q$J*q$G+q$W),q$k},q$a.mulPos=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){var q$z=q$S.a,q$b=q$S.b,q$H=q$S.c,q$L=q$S.d,q$C=q$S.tx,q$G=q$S.ty;return 0!==q$b||0!==q$H?(q$k.a=q$_*q$z+q$a*q$H,q$k.b=q$_*q$b+q$a*q$L,q$k.c=q$R*q$z+q$J*q$H,q$k.d=q$R*q$b+q$J*q$L,q$k.tx=q$z*q$V+q$H*q$W+q$C,q$k.ty=q$b*q$V+q$L*q$W+q$G):(q$k.a=q$_*q$z,q$k.b=q$a*q$L,q$k.c=q$R*q$z,q$k.d=q$J*q$L,q$k.tx=q$z*q$V+q$C,q$k.ty=q$L*q$W+q$G),q$k},q$a.preMul=function(q$S,q$_,q$a){var q$R=q$S.a,q$J=q$S.b,q$V=q$S.c,q$W=q$S.d,q$k=q$_.a,q$z=q$_.b,q$b=q$_.c,q$H=q$_.d,q$L=q$_.tx,q$C=q$_.ty;return q$a.a=q$k*q$R,q$a.b=q$a.c=0,q$a.d=q$H*q$W,q$a.tx=q$L*q$R+q$S.tx,q$a.ty=q$C*q$W+q$S.ty,0===q$z&&0===q$b&&0===q$J&&0===q$V||(q$a.a+=q$z*q$V,q$a.d+=q$b*q$J,q$a.b+=q$k*q$J+q$z*q$W,q$a.c+=q$b*q$R+q$H*q$V,q$a.tx+=q$C*q$V,q$a.ty+=q$L*q$J),q$a},q$a.preMulXY=function(q$S,q$_,q$a,q$R){var q$J=q$S.a,q$V=q$S.b,q$W=q$S.c,q$k=q$S.d;return q$R.a=q$J,q$R.b=q$V,q$R.c=q$W,q$R.d=q$k,q$R.tx=q$_*q$J+q$S.tx+q$a*q$W,q$R.ty=q$a*q$k+q$S.ty+q$_*q$V,q$R},q$a.create=function(){var q$S=q$a._cache,q$_=q$S._length?q$S[--q$S._length]:new q$a;return q$_.inPool=!1,q$_},q$a.EMPTY=new q$a,q$a.TEMP=new q$a,q$a._cache=[],q$a}(),q$N=function(){function q$S(q$S,q$_){void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),this.x=q$S,this.y=q$_}q$H(q$S,"laya.maths.Point");var q$_=q$S.prototype;return q$_.setTo=function(q$S,q$_){return this.x=q$S,this.y=q$_,this},q$_.distance=function(q$S,q$_){return Math.sqrt((this.x-q$S)*(this.x-q$S)+(this.y-q$_)*(this.y-q$_))},q$_.toString=function(){return this.x+","+this.y},q$_.normalize=function(){var q$S=Math.sqrt(this.x*this.x+this.y*this.y);if(0<q$S){var q$_=1/q$S;this.x*=q$_,this.y*=q$_}},q$S.TEMP=new q$S,q$S.EMPTY=new q$S,q$S}(),q$n=function(){function q$b(q$S,q$_,q$a,q$R){void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=0),this.x=q$S,this.y=q$_,this.width=q$a,this.height=q$R}q$H(q$b,"laya.maths.Rectangle");var q$S=q$b.prototype;return q$S.setTo=function(q$S,q$_,q$a,q$R){return this.x=q$S,this.y=q$_,this.width=q$a,this.height=q$R,this},q$S.copyFrom=function(q$S){return this.x=q$S.x,this.y=q$S.y,this.width=q$S.width,this.height=q$S.height,this},q$S.contains=function(q$S,q$_){return!(this.width<=0||this.height<=0)&&(q$S>=this.x&&q$S<this.right&&q$_>=this.y&&q$_<this.bottom)},q$S.intersects=function(q$S){return!(q$S.x>this.x+this.width||q$S.x+q$S.width<this.x||q$S.y>this.y+this.height||q$S.y+q$S.height<this.y)},q$S.intersection=function(q$S,q$_){return this.intersects(q$S)?(q$_||(q$_=new q$b),q$_.x=Math.max(this.x,q$S.x),q$_.y=Math.max(this.y,q$S.y),q$_.width=Math.min(this.right,q$S.right)-q$_.x,q$_.height=Math.min(this.bottom,q$S.bottom)-q$_.y,q$_):null},q$S.union=function(q$S,q$_){return q$_||(q$_=new q$b),this.clone(q$_),q$S.width<=0||q$S.height<=0?q$_:(q$_.addPoint(q$S.x,q$S.y),q$_.addPoint(q$S.right,q$S.bottom),this)},q$S.clone=function(q$S){return q$S||(q$S=new q$b),q$S.x=this.x,q$S.y=this.y,q$S.width=this.width,q$S.height=this.height,q$S},q$S.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},q$S.equals=function(q$S){return!(!q$S||q$S.x!==this.x||q$S.y!==this.y||q$S.width!==this.width||q$S.height!==this.height)},q$S.addPoint=function(q$S,q$_){return this.x>q$S&&(this.width+=this.x-q$S,this.x=q$S),this.y>q$_&&(this.height+=this.y-q$_,this.y=q$_),this.width<q$S-this.x&&(this.width=q$S-this.x),this.height<q$_-this.y&&(this.height=q$_-this.y),this},q$S._getBoundPoints=function(){var q$S=q$b._temB;return(q$S.length=0)==this.width||0==this.height||q$S.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),q$S},q$S.isEmpty=function(){return this.width<=0||this.height<=0},q$t(0,q$S,"right",function(){return this.x+this.width}),q$t(0,q$S,"bottom",function(){return this.y+this.height}),q$b._getBoundPointS=function(q$S,q$_,q$a,q$R){var q$J=q$b._temA;return(q$J.length=0)==q$a||0==q$R||q$J.push(q$S,q$_,q$S+q$a,q$_,q$S,q$_+q$R,q$S+q$a,q$_+q$R),q$J},q$b._getWrapRec=function(q$S,q$_){if(!q$S||q$S.length<1)return q$_?q$_.setTo(0,0,0,0):q$b.TEMP.setTo(0,0,0,0);q$_=q$_||new q$b;var q$a,q$R,q$J,q$V,q$W,q$k=q$S.length,q$z=q$N.TEMP;for(q$J=q$W=-(q$R=q$V=99999),q$a=0;q$a<q$k;q$a+=2)q$z.x=q$S[q$a],q$z.y=q$S[q$a+1],q$R=q$R<q$z.x?q$R:q$z.x,q$V=q$V<q$z.y?q$V:q$z.y,q$J=q$J>q$z.x?q$J:q$z.x,q$W=q$W>q$z.y?q$W:q$z.y;return q$_.setTo(q$R,q$V,q$J-q$R,q$W-q$V)},q$b.EMPTY=new q$b,q$b.TEMP=new q$b,q$b._temB=[],q$b._temA=[],q$b}(),q$I=function(){function q$z(){}return q$H(q$z,"laya.media.SoundManager"),q$t(1,q$z,"useAudioMusic",function(){return q$z._useAudioMusic},function(q$S){q$z._useAudioMusic=q$S,q$z._musicClass=q$S?q$aS:null}),q$t(1,q$z,"autoStopMusic",function(){return q$z._autoStopMusic},function(q$S){q$q.stage.off("blur",null,q$z._stageOnBlur),q$q.stage.off("focus",null,q$z._stageOnFocus),q$q.stage.off("visibilitychange",null,q$z._visibilityChange),(q$z._autoStopMusic=q$S)&&(q$q.stage.on("blur",null,q$z._stageOnBlur),q$q.stage.on("focus",null,q$z._stageOnFocus),q$q.stage.on("visibilitychange",null,q$z._visibilityChange))}),q$t(1,q$z,"muted",function(){return q$z._muted},function(q$S){q$S!=q$z._muted&&(q$S&&q$z.stopAllSound(),q$z.musicMuted=q$S,q$z._muted=q$S)}),q$t(1,q$z,"musicMuted",function(){return q$z._musicMuted},function(q$S){q$S!=q$z._musicMuted&&(q$S?(q$z._tMusic&&q$z._musicChannel&&!q$z._musicChannel.isStopped?q$z._musicChannel.pause():q$z._musicChannel=null,q$z._musicMuted=q$S):(q$z._musicMuted=q$S,q$z._tMusic&&q$z._musicChannel&&q$z._musicChannel.resume()))}),q$t(1,q$z,"soundMuted",function(){return q$z._soundMuted},function(q$S){q$z._soundMuted=q$S}),q$z.addChannel=function(q$S){0<=q$z._channels.indexOf(q$S)||(q$z._channels.push(q$S),q$z.autoReleaseSound&&0!=q$z._notUsedCount&&q$z._notUsedUrls[q$S.url]&&(delete q$z._notUsedUrls[q$S.url],0==--q$z._notUsedCount&&q$q.timer.clear(q$z,q$z.disposeSoundIfNotUsed)))},q$z.removeChannel=function(q$S){var q$_=q$z._channels,q$a=q$_.indexOf(q$S);if(-1!=q$a&&(q$_.splice(q$a,1),q$z.autoReleaseSound)){var q$R=q$S.url,q$J=q$z.defaultIntervals[q$R]||2e4;if(0<q$J){var q$V=!0;for(q$a=q$_.length-1;0<=q$a;q$a--)if(q$_[q$a].url==q$R){q$V=!1;break}q$V&&(q$z._notUsedUrls[q$R]=Date.now()+q$J,0==q$z._notUsedCount++&&q$q.timer.loop(1e4,q$z,q$z.disposeSoundIfNotUsed))}}},q$z.disposeSoundIfNotUsed=function(){var q$S=q$z._notUsedUrls;if(0!=q$z._notUsedCount){var q$_=Date.now();for(var q$a in q$S)q$_>=q$S[q$a]&&(delete q$S[q$a],--q$z._notUsedCount,q$z.destroySound(q$a));if(0!=q$z._notUsedCount)return}q$q.timer.clear(q$z,q$z.disposeSoundIfNotUsed)},q$z._visibilityChange=function(){q$q.stage.isVisibility?q$z._stageOnFocus():q$z._stageOnBlur()},q$z._stageOnBlur=function(){q$z._isActive=!1,q$z._musicChannel&&(q$z._musicChannel.isStopped||(q$z._blurPaused=!0,q$z._musicChannel.pause())),q$z.stopAllSound(),q$q.stage.once("mousedown",null,q$z._stageOnFocus)},q$z._recoverWebAudio=function(){q$VS.ctx&&"running"!=q$VS.ctx.state&&q$VS.ctx.resume&&q$VS.ctx.resume()},q$z._stageOnFocus=function(){if(q$z._isActive=!0,q$z._recoverWebAudio(),q$q.stage.off("mousedown",null,q$z._stageOnFocus),q$z._blurPaused){var q$S=q$z._musicChannel;q$S&&q$z._music&&q$S.isStopped&&(q$z._blurPaused=!1,q$z._music._disposed?q$z.playMusic(q$S.url,q$S.loops,q$S.startHandler,q$S.completeHandler,q$S.startTime):q$S.audioBuffer?q$S.resume():q$z._music.play(q$S.startTime,q$S.loops,q$S.startHandler,q$S))}},q$z.playSound=function(q$S,q$_,q$a,q$R,q$J,q$V){if(void 0===q$_&&(q$_=1),void 0===q$V&&(q$V=0),!q$S)return null;if(q$z._muted)return null;if(q$z._recoverWebAudio(),q$S==q$z._tMusic){if(q$z._musicMuted)return null}else{if(!q$z._isActive)return null;if(q$z._soundMuted)return null}var q$W,q$k=q$z._pool[q$S];return q$J||(q$J=q$z._soundClass),q$k||((q$k=new q$J).load(q$S),q$z._pool[q$S]=q$k),(q$W=q$k.play(q$V,q$_,q$a))?(q$S==q$z._tMusic&&(q$z._music=q$k,q$z._isActive||(q$z._blurPaused=!0,q$W.pause())),q$W.url=q$S,q$W.volume=q$S==q$z._tMusic?q$z.musicVolume:q$z.soundVolume,q$W.completeHandler=q$R,q$W):null},q$z.destroySound=function(q$S){var q$_=q$z._pool[q$S];q$_&&(delete q$z._pool[q$S],q$_.dispose())},q$z.playMusic=function(q$S,q$_,q$a,q$R,q$J){return void 0===q$_&&(q$_=0),void 0===q$J&&(q$J=0),q$z._tMusic=q$S,q$z._musicChannel&&q$z._musicChannel.stop(),q$z._musicChannel=q$z.playSound(q$S,q$_,q$a,q$R,null,q$J)},q$z.stopSound=function(q$S){for(var q$_,q$a=q$z._channels.length-1;0<=q$a;q$a--)(q$_=q$z._channels[q$a]).url==q$S&&q$_.stop()},q$z.stopAll=function(){q$z._tMusic=null;var q$S=0;for(q$S=q$z._channels.length-1;0<=q$S;q$S--)q$z._channels[q$S].stop()},q$z.stopAllSound=function(){var q$S,q$_=0;for(q$_=q$z._channels.length-1;0<=q$_;q$_--)(q$S=q$z._channels[q$_]).url!=q$z._tMusic&&q$S.stop()},q$z.stopMusic=function(){q$z._musicChannel&&q$z._musicChannel.stop(),q$z._tMusic=null},q$z.setSoundVolume=function(q$S,q$_){if(q$_)q$z._setVolume(q$_,q$S);else{q$z.soundVolume=q$S;var q$a,q$R=0;for(q$R=q$z._channels.length-1;0<=q$R;q$R--)(q$a=q$z._channels[q$R]).url!=q$z._tMusic&&(q$a.volume=q$S)}},q$z.setMusicVolume=function(q$S){q$z.musicVolume=q$S,q$z._setVolume(q$z._tMusic,q$S)},q$z._setVolume=function(q$S,q$_){for(var q$a,q$R=q$z._channels.length-1;0<=q$R;q$R--)(q$a=q$z._channels[q$R]).url==q$S&&(q$a.volume=q$_)},q$z.musicVolume=1,q$z.soundVolume=1,q$z.playbackRate=1,q$z._useAudioMusic=!0,q$z._muted=!1,q$z._soundMuted=!1,q$z._musicMuted=!1,q$z._tMusic=null,q$z._musicChannel=null,q$z._music=null,q$z._channels=[],q$z._autoStopMusic=!1,q$z._blurPaused=!1,q$z._isActive=!0,q$z._soundClass=null,q$z._musicClass=null,q$z.autoReleaseSound=!0,q$z._pool={},q$z.defaultIntervals={},q$z._notUsedUrls={},q$z._notUsedCount=0,q$z}(),q$l=function(){var q$S;function q$a(){}return q$H(q$a,"laya.net.LocalStorage"),q$a.__init__=function(){q$a._baseClass||(q$a._baseClass=q$S).init(),q$a.items=q$a._baseClass.items,q$a.support=q$a._baseClass.support},q$a.setItem=function(q$S,q$_){q$a._baseClass.setItem(q$S,q$_)},q$a.getItem=function(q$S){return q$a._baseClass.getItem(q$S)},q$a.setJSON=function(q$S,q$_){q$a._baseClass.setJSON(q$S,q$_)},q$a.getJSON=function(q$S){return q$a._baseClass.getJSON(q$S)},q$a.removeItem=function(q$S){q$a._baseClass.removeItem(q$S)},q$a.clear=function(){q$a._baseClass.clear()},q$a._baseClass=null,q$a.items=null,q$a.support=!1,q$a.__init$=function(){q$S=function(){function q$a(){}return q$H(q$a,""),q$a.init=function(){try{q$a.support=!0,q$a.items=q$W.localStorage,q$a.setItem("laya","1"),q$a.removeItem("laya")}catch(q$S){q$a.support=!1}q$a.support||console.log("LocalStorage is not supprot or browser is private mode.")},q$a.setItem=function(q$S,q$_){try{q$a.support&&q$a.items.setItem(q$S,q$_)}catch(q$S){console.warn("set localStorage failed",q$S)}},q$a.getItem=function(q$S){return q$a.support?q$a.items.getItem(q$S):null},q$a.setJSON=function(q$S,q$_){try{q$a.support&&q$a.items.setItem(q$S,JSON.stringify(q$_))}catch(q$S){console.warn("set localStorage failed",q$S)}},q$a.getJSON=function(q$S){return JSON.parse(q$a.support?q$a.items.getItem(q$S):null)},q$a.removeItem=function(q$S){q$a.support&&q$a.items.removeItem(q$S)},q$a.clear=function(){q$a.support&&q$a.items.clear()},q$a.items=null,q$a.support=!1,q$a}()},q$a}(),q$h=(function(){function q$R(){}q$H(q$R,"laya.net.ResourceVersion"),q$R.enable=function(q$S,q$_,q$a){void 0===q$a&&(q$a=2),laya.net.ResourceVersion.type=q$a,q$q.loader.load(q$S,q$T.create(null,q$R.onManifestLoaded,[q$_]),null,"json"),q$u.customFormat=q$R.addVersionPrefix},q$R.onManifestLoaded=function(q$S,q$_){q$R.manifest=q$_,q$S.run(),q$_||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},q$R.addVersionPrefix=function(q$S){return q$R.manifest&&q$R.manifest[q$S]?2==q$R.type?q$R.manifest[q$S]:q$R.manifest[q$S]+"/"+q$S:q$S},q$R.FOLDER_VERSION=1,q$R.FILENAME_VERSION=2,q$R.manifest=null,q$R.type=1}(),function(){function q$S(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}q$H(q$S,"laya.net.TTFLoader");var q$_=q$S.prototype;return q$_.load=function(q$S){var q$_=(this._url=q$S).split(".ttf")[0].split("/");this.fontName=q$_[q$_.length-1],q$g.window.conch?this._loadConch():q$g.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},q$_._loadConch=function(){this._http=new q$WS,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},q$_._onHttpLoaded=function(q$S){q$g.window.conch.setFontFaceFromBuffer(this.fontName,q$S),this._clearHttp(),this._complete()},q$_._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},q$_._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},q$_._complete=function(){q$q.timer.clear(this,this._complete),q$q.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},q$_._checkComplete=function(){q$A.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},q$_._loadWithFontFace=function(){var q$S=new q$g.window.FontFace(this.fontName,"url('"+this._url+"')");q$g.window.document.fonts.add(q$S);var q$_=this;q$S.loaded.then(function(){q$_._complete()}),q$S.load()},q$_._createDiv=function(){this._div=q$g.createElement("div"),this._div.innerHTML="laya";var q$S=this._div.style;q$S.fontFamily=this.fontName,q$S.position="absolute",q$S.left="-100px",q$S.top="-100px",q$g.document.body.appendChild(this._div)},q$_._loadWithCSS=function(){var q$S=this,q$_=q$g.createElement("style");q$_.type="text/css",q$g.document.body.appendChild(q$_),q$_.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=q$A.measureText("LayaTTFFont",this._fontTxt).width;var q$a=this;q$_.onload=function(){q$q.timer.once(1e4,q$a,q$S._complete)},q$q.timer.loop(20,this,this._checkComplete),this._createDiv()},q$S._testString="LayaTTFFont",q$S}()),q$u=function(){function q$R(q$S){this._url=null,this._path=null,this._url=q$R.formatURL(q$S),this._path=q$R.getPath(q$S)}q$H(q$R,"laya.net.URL");var q$S=q$R.prototype;return q$t(0,q$S,"path",function(){return this._path}),q$t(0,q$S,"url",function(){return this._url}),q$R.formatURL=function(q$S,q$_){if(!q$S)return"null path";if(0<q$S.indexOf(":"))return q$S;null!=q$R.customFormat&&(q$S=q$R.customFormat(q$S,q$_));var q$a=q$S.charAt(0);if("."===q$a)return q$R.formatRelativePath((q$_||q$R.basePath)+q$S);if("~"===q$a)return q$R.rootPath+q$S.substring(1);if("d"===q$a){if(0===q$S.indexOf("data:image"))return q$S}else if("/"===q$a)return q$S;return(q$_||q$R.basePath)+q$S},q$R.formatRelativePath=function(q$S){for(var q$_=q$S.split("/"),q$a=0,q$R=q$_.length;q$a<q$R;q$a++)".."==q$_[q$a]&&(q$_.splice(q$a-1,2),q$a-=2);return q$_.join("/")},q$R.isAbsolute=function(q$S){return 0<q$S.indexOf(":")||"/"==q$S.charAt(0)},q$R.getPath=function(q$S){var q$_=q$S.lastIndexOf("/");return 0<q$_?q$S.substr(0,q$_+1):""},q$R.getFileName=function(q$S){var q$_=q$S.lastIndexOf("/");return 0<q$_?q$S.substr(q$_+1):q$S},q$R.version={},q$R.basePath="",q$R.rootPath="",q$R.customFormat=function(q$S){var q$_=q$R.version[q$S];return!q$K.isConchApp&&q$_&&(q$S+="?v="+q$_),q$S},q$R}(),q$K=function(){function q$J(q$S,q$_){this._timeId=0;var q$a=q$J._mainCanvas.source.style;q$a.position="absolute",q$a.top=q$a.left="0px",q$a.background="#000000",q$J._mainCanvas.source.id="layaCanvas";var q$R=laya.renders.Render.isWebGL;q$J._mainCanvas.source.width=q$S,q$J._mainCanvas.source.height=q$_,q$R&&q$J.WebGL.init(q$J._mainCanvas,q$S,q$_),q$g.container.appendChild(q$J._mainCanvas.source),(q$J._context=new q$P(q$S,q$_,q$R?null:q$J._mainCanvas)).ctx.setIsMainContext(),q$g.window.requestAnimationFrame(function q$S(q$_){q$g.window.requestAnimationFrame(q$S);q$q.stage._loop()}),q$q.stage.on("visibilitychange",this,this._onVisibilitychange)}q$H(q$J,"laya.renders.Render");var q$S=q$J.prototype;return q$S._onVisibilitychange=function(){q$q.stage.isVisibility?0!=this._timeId&&q$g.window.clearInterval(this._timeId):this._timeId=q$g.window.setInterval(this._enterFrame,1e3)},q$S._enterFrame=function(q$S){q$q.stage._loop()},q$t(1,q$J,"context",function(){return q$J._context}),q$t(1,q$J,"canvas",function(){return q$J._mainCanvas.source}),q$J._context=null,q$J._mainCanvas=null,q$J.WebGL=null,q$J.isConchNode=!1,q$J.isConchApp=!1,q$J.isConchWebGL=!1,q$J.isWebGL=!1,q$J.is3DMode=!1,q$J.optimizeTextureMemory=function(q$S,q$_){return!0},q$J.__init$=function(){q$W.ConchRenderType=q$W.ConchRenderType||1,q$W.ConchRenderType|=q$W.conch?4:0,q$J.isConchNode=5==(5&q$W.ConchRenderType),q$J.isConchApp=4==(4&q$W.ConchRenderType),q$J.isConchWebGL=6==q$W.ConchRenderType},q$J}(),q$P=function(){function q$W(q$S,q$_,q$a){this.x=0,this.y=0,this._drawTexture=function(q$S,q$_,q$a){q$a[0].loaded&&this.ctx.drawTexture(q$a[0],q$a[1],q$a[2],q$a[3],q$a[4],q$S,q$_)},this._fillTexture=function(q$S,q$_,q$a){q$a[0].loaded&&this.ctx.fillTexture(q$a[0],q$a[1]+q$S,q$a[2]+q$_,q$a[3],q$a[4],q$a[5],q$a[6],q$a[7])},this._drawTextureWithTransform=function(q$S,q$_,q$a){q$a[0].loaded&&this.ctx.drawTextureWithTransform(q$a[0],q$a[1],q$a[2],q$a[3],q$a[4],q$a[5],q$S,q$_,q$a[6])},this._fillQuadrangle=function(q$S,q$_,q$a){this.ctx.fillQuadrangle(q$a[0],q$a[1],q$a[2],q$a[3],q$a[4])},this._drawRect=function(q$S,q$_,q$a){var q$R=this.ctx;null!=q$a[4]&&(q$R.fillStyle=q$a[4],q$R.fillRect(q$S+q$a[0],q$_+q$a[1],q$a[2],q$a[3],null)),null!=q$a[5]&&(q$R.strokeStyle=q$a[5],q$R.lineWidth=q$a[6],q$R.strokeRect(q$S+q$a[0],q$_+q$a[1],q$a[2],q$a[3],q$a[6]))},this._drawPie=function(q$S,q$_,q$a){var q$R=this.ctx;q$K.isWebGL&&q$R.setPathId(q$a[8]),q$R.beginPath(),q$K.isWebGL?(q$R.movePath(q$a[0]+q$S,q$a[1]+q$_),q$R.moveTo(0,0)):q$R.moveTo(q$S+q$a[0],q$_+q$a[1]),q$R.arc(q$S+q$a[0],q$_+q$a[1],q$a[2],q$a[3],q$a[4]),q$R.closePath(),this._fillAndStroke(q$a[5],q$a[6],q$a[7],!0)},this._clipRect=function(q$S,q$_,q$a){this.ctx.clipRect(q$S+q$a[0],q$_+q$a[1],q$a[2],q$a[3])},this._fillRect=function(q$S,q$_,q$a){this.ctx.fillRect(q$S+q$a[0],q$_+q$a[1],q$a[2],q$a[3],q$a[4])},this._drawCircle=function(q$S,q$_,q$a){var q$R=this.ctx;q$K.isWebGL&&q$R.setPathId(q$a[6]),q$c.drawCall++,q$R.beginPath(),q$K.isWebGL&&q$R.movePath(q$a[0]+q$S,q$a[1]+q$_),q$R.arc(q$a[0]+q$S,q$a[1]+q$_,q$a[2],0,q$W.PI2),q$R.closePath(),this._fillAndStroke(q$a[3],q$a[4],q$a[5],!0)},this._fillCircle=function(q$S,q$_,q$a){q$c.drawCall++;var q$R=this.ctx;q$R.beginPath(),q$R.fillStyle=q$a[3],q$R.arc(q$a[0]+q$S,q$a[1]+q$_,q$a[2],0,q$W.PI2),q$R.fill()},this._setShader=function(q$S,q$_,q$a){this.ctx.setShader(q$a[0])},this._drawLine=function(q$S,q$_,q$a){var q$R=this.ctx;q$K.isWebGL&&q$R.setPathId(q$a[6]),q$R.beginPath(),q$R.strokeStyle=q$a[4],q$R.lineWidth=q$a[5],q$K.isWebGL?(q$R.movePath(q$S,q$_),q$R.moveTo(q$a[0],q$a[1]),q$R.lineTo(q$a[2],q$a[3])):(q$R.moveTo(q$S+q$a[0],q$_+q$a[1]),q$R.lineTo(q$S+q$a[2],q$_+q$a[3])),q$R.stroke()},this._drawLines=function(q$S,q$_,q$a){var q$R=this.ctx;q$K.isWebGL&&q$R.setPathId(q$a[5]),q$R.beginPath(),q$S+=q$a[0],q$_+=q$a[1],q$K.isWebGL&&q$R.movePath(q$S,q$_),q$R.strokeStyle=q$a[3],q$R.lineWidth=q$a[4];var q$J=q$a[2],q$V=2,q$W=q$J.length;if(q$K.isWebGL)for(q$R.moveTo(q$J[0],q$J[1]);q$V<q$W;)q$R.lineTo(q$J[q$V++],q$J[q$V++]);else for(q$R.moveTo(q$S+q$J[0],q$_+q$J[1]);q$V<q$W;)q$R.lineTo(q$S+q$J[q$V++],q$_+q$J[q$V++]);q$R.stroke()},this._drawLinesWebGL=function(q$S,q$_,q$a){this.ctx.drawLines(q$S+this.x+q$a[0],q$_+this.y+q$a[1],q$a[2],q$a[3],q$a[4])},this._drawCurves=function(q$S,q$_,q$a){this.ctx.drawCurves(q$S,q$_,q$a)},this._draw=function(q$S,q$_,q$a){q$a[0].call(null,this,q$S,q$_)},this._transformByMatrix=function(q$S,q$_,q$a){this.ctx.transformByMatrix(q$a[0])},this._setTransform=function(q$S,q$_,q$a){this.ctx.setTransform(q$a[0],q$a[1],q$a[2],q$a[3],q$a[4],q$a[5])},this._setTransformByMatrix=function(q$S,q$_,q$a){this.ctx.setTransformByMatrix(q$a[0])},this._save=function(q$S,q$_,q$a){this.ctx.save()},this._restore=function(q$S,q$_,q$a){this.ctx.restore()},this._translate=function(q$S,q$_,q$a){this.ctx.translate(q$a[0],q$a[1])},this._transform=function(q$S,q$_,q$a){this.ctx.translate(q$a[1]+q$S,q$a[2]+q$_);var q$R=q$a[0];this.ctx.transform(q$R.a,q$R.b,q$R.c,q$R.d,q$R.tx,q$R.ty),this.ctx.translate(-q$S-q$a[1],-q$_-q$a[2])},this._rotate=function(q$S,q$_,q$a){this.ctx.translate(q$a[1]+q$S,q$a[2]+q$_),this.ctx.rotate(q$a[0]),this.ctx.translate(-q$S-q$a[1],-q$_-q$a[2])},this._scale=function(q$S,q$_,q$a){this.ctx.translate(q$a[2]+q$S,q$a[3]+q$_),this.ctx.scale(q$a[0],q$a[1]),this.ctx.translate(-q$S-q$a[2],-q$_-q$a[3])},this._alpha=function(q$S,q$_,q$a){this.ctx.globalAlpha*=q$a[0]},this._setAlpha=function(q$S,q$_,q$a){this.ctx.globalAlpha=q$a[0]},this._fillText=function(q$S,q$_,q$a){this.ctx.fillText(q$a[0],q$a[1]+q$S,q$a[2]+q$_,q$a[3],q$a[4],q$a[5])},this._strokeText=function(q$S,q$_,q$a){this.ctx.strokeText(q$a[0],q$a[1]+q$S,q$a[2]+q$_,q$a[3],q$a[4],q$a[5],q$a[6])},this._fillBorderText=function(q$S,q$_,q$a){this.ctx.fillBorderText(q$a[0],q$a[1]+q$S,q$a[2]+q$_,q$a[3],q$a[4],q$a[5],q$a[6],q$a[7])},this._blendMode=function(q$S,q$_,q$a){this.ctx.globalCompositeOperation=q$a[0]},this._beginClip=function(q$S,q$_,q$a){this.ctx.beginClip&&this.ctx.beginClip(q$S+q$a[0],q$_+q$a[1],q$a[2],q$a[3])},this._setIBVB=function(q$S,q$_,q$a){this.ctx.setIBVB(q$a[0]+q$S,q$a[1]+q$_,q$a[2],q$a[3],q$a[4],q$a[5],q$a[6],q$a[7])},this._fillTrangles=function(q$S,q$_,q$a){this.ctx.fillTrangles(q$a[0],q$a[1]+q$S,q$a[2]+q$_,q$a[3],q$a[4])},this._drawPath=function(q$S,q$_,q$a){var q$R=this.ctx;q$K.isWebGL&&q$R.setPathId(-1),q$R.beginPath(),q$S+=q$a[0],q$_+=q$a[1],q$K.isWebGL&&q$R.movePath(q$S,q$_);for(var q$J=q$a[2],q$V=0,q$W=q$J.length;q$V<q$W;q$V++){var q$k=q$J[q$V];switch(q$k[0]){case"moveTo":q$K.isWebGL?q$R.moveTo(q$k[1],q$k[2]):q$R.moveTo(q$S+q$k[1],q$_+q$k[2]);break;case"lineTo":q$K.isWebGL?q$R.lineTo(q$k[1],q$k[2]):q$R.lineTo(q$S+q$k[1],q$_+q$k[2]);break;case"arcTo":q$K.isWebGL?q$R.arcTo(q$k[1],q$k[2],q$k[3],q$k[4],q$k[5]):q$R.arcTo(q$S+q$k[1],q$_+q$k[2],q$S+q$k[3],q$_+q$k[4],q$k[5]);break;case"closePath":q$R.closePath()}}var q$z=q$a[3];null!=q$z&&(q$R.fillStyle=q$z.fillStyle,q$R.fill());var q$b=q$a[4];null!=q$b&&(q$R.strokeStyle=q$b.strokeStyle,q$R.lineWidth=q$b.lineWidth||1,q$R.lineJoin=q$b.lineJoin,q$R.lineCap=q$b.lineCap,q$R.miterLimit=q$b.miterLimit,q$R.stroke())},this.drawPoly=function(q$S,q$_,q$a){this.ctx.drawPoly(q$S+this.x+q$a[0],q$_+this.y+q$a[1],q$a[2],q$a[3],q$a[4],q$a[5],q$a[6])},this._drawPoly=function(q$S,q$_,q$a){var q$R=this.ctx,q$J=q$a[2],q$V=2,q$W=q$J.length;if(q$K.isWebGL)for(q$R.setPathId(q$a[6]),q$R.beginPath(),q$S+=q$a[0],q$_+=q$a[1],q$R.movePath(q$S,q$_),q$R.moveTo(q$J[0],q$J[1]);q$V<q$W;)q$R.lineTo(q$J[q$V++],q$J[q$V++]);else for(q$R.beginPath(),q$S+=q$a[0],q$_+=q$a[1],q$R.moveTo(q$S+q$J[0],q$_+q$J[1]);q$V<q$W;)q$R.lineTo(q$S+q$J[q$V++],q$_+q$J[q$V++]);q$R.closePath(),this._fillAndStroke(q$a[3],q$a[4],q$a[5],q$a[7])},this._drawSkin=function(q$S,q$_,q$a){var q$R=q$a[0];if(q$R){var q$J=this.ctx;q$R.render(q$J,q$S,q$_)}},this._drawParticle=function(q$S,q$_,q$a){this.ctx.drawParticle(q$S+this.x,q$_+this.y,q$a[0])},this._setFilters=function(q$S,q$_,q$a){this.ctx.setFilters(q$a)},q$a?this.ctx=q$a.getContext("2d"):(q$a=q$DS.create("3D"),this.ctx=q$A.createWebGLContext2D(q$a),q$a._setContext(this.ctx)),q$a.size(q$S,q$_),this.canvas=q$a}q$H(q$W,"laya.renders.RenderContext");var q$S=q$W.prototype;return q$S.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},q$S.drawTexture=function(q$S,q$_,q$a,q$R,q$J){q$S.loaded&&this.ctx.drawTexture(q$S,q$_,q$a,q$R,q$J,this.x,this.y)},q$S._drawTextures=function(q$S,q$_,q$a){q$a[0].loaded&&this.ctx.drawTextures(q$a[0],q$a[1],q$S+this.x,q$_+this.y)},q$S.drawTextureWithTransform=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){q$S.loaded&&this.ctx.drawTextureWithTransform(q$S,q$_,q$a,q$R,q$J,q$V,this.x,this.y,q$W)},q$S.fillQuadrangle=function(q$S,q$_,q$a,q$R,q$J){this.ctx.fillQuadrangle(q$S,q$_,q$a,q$R,q$J)},q$S.drawCanvas=function(q$S,q$_,q$a,q$R,q$J){this.ctx.drawCanvas(q$S,q$_+this.x,q$a+this.y,q$R,q$J)},q$S.drawRect=function(q$S,q$_,q$a,q$R,q$J,q$V){void 0===q$V&&(q$V=1);var q$W=this.ctx;q$W.strokeStyle=q$J,q$W.lineWidth=q$V,q$W.strokeRect(q$S+this.x,q$_+this.y,q$a,q$R,q$V)},q$S._fillAndStroke=function(q$S,q$_,q$a,q$R){void 0===q$R&&(q$R=!1);var q$J=this.ctx;null!=q$S&&(q$J.fillStyle=q$S,q$K.isWebGL?q$J.fill(q$R):q$J.fill()),null!=q$_&&0<q$a&&(q$J.strokeStyle=q$_,q$J.lineWidth=q$a,q$J.stroke())},q$S.clipRect=function(q$S,q$_,q$a,q$R){this.ctx.clipRect(q$S+this.x,q$_+this.y,q$a,q$R)},q$S.fillRect=function(q$S,q$_,q$a,q$R,q$J){this.ctx.fillRect(q$S+this.x,q$_+this.y,q$a,q$R,q$J)},q$S.drawCircle=function(q$S,q$_,q$a,q$R,q$J){void 0===q$J&&(q$J=1),q$c.drawCall++;var q$V=this.ctx;q$V.beginPath(),q$V.strokeStyle=q$R,q$V.lineWidth=q$J,q$V.arc(q$S+this.x,q$_+this.y,q$a,0,q$W.PI2),q$V.stroke()},q$S.drawTriangles=function(q$S,q$_,q$a){if(q$K.isWebGL)this.ctx.drawTriangles(q$a[0],q$S+q$a[1],q$_+q$a[2],q$a[3],q$a[4],q$a[5],q$a[6],q$a[7],q$a[8],q$a[9]);else{var q$R=q$a[5],q$J=0,q$V=q$R.length,q$W=this.ctx;for(q$J=0;q$J<q$V;q$J+=3){var q$k=2*q$R[q$J],q$z=2*q$R[q$J+1],q$b=2*q$R[q$J+2];q$W.drawTriangle(q$a[0],q$a[3],q$a[4],q$k,q$z,q$b,q$a[6],!0)}}},q$S.fillCircle=function(q$S,q$_,q$a,q$R){q$c.drawCall++;var q$J=this.ctx;q$J.beginPath(),q$J.fillStyle=q$R,q$J.arc(q$S+this.x,q$_+this.y,q$a,0,q$W.PI2),q$J.fill()},q$S.setShader=function(q$S){this.ctx.setShader(q$S)},q$S.drawLine=function(q$S,q$_,q$a,q$R,q$J,q$V){void 0===q$V&&(q$V=1);var q$W=this.ctx;q$W.beginPath(),q$W.strokeStyle=q$J,q$W.lineWidth=q$V,q$W.moveTo(this.x+q$S,this.y+q$_),q$W.lineTo(this.x+q$a,this.y+q$R),q$W.stroke()},q$S.clear=function(){this.ctx.clear()},q$S.transformByMatrix=function(q$S){this.ctx.transformByMatrix(q$S)},q$S.setTransform=function(q$S,q$_,q$a,q$R,q$J,q$V){this.ctx.setTransform(q$S,q$_,q$a,q$R,q$J,q$V)},q$S.setTransformByMatrix=function(q$S){this.ctx.setTransformByMatrix(q$S)},q$S.save=function(){this.ctx.save()},q$S.restore=function(){this.ctx.restore()},q$S.translate=function(q$S,q$_){this.ctx.translate(q$S,q$_)},q$S.transform=function(q$S,q$_,q$a,q$R,q$J,q$V){this.ctx.transform(q$S,q$_,q$a,q$R,q$J,q$V)},q$S.rotate=function(q$S){this.ctx.rotate(q$S)},q$S.scale=function(q$S,q$_){this.ctx.scale(q$S,q$_)},q$S.alpha=function(q$S){this.ctx.globalAlpha*=q$S},q$S.setAlpha=function(q$S){this.ctx.globalAlpha=q$S},q$S.fillWords=function(q$S,q$_,q$a,q$R,q$J,q$V){void 0===q$V&&(q$V=0),this.ctx.fillWords(q$S,q$_,q$a,q$R,q$J,q$V)},q$S.fillBorderWords=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this.ctx.fillBorderWords(q$S,q$_,q$a,q$R,q$J,q$V,q$W)},q$S.fillText=function(q$S,q$_,q$a,q$R,q$J,q$V){this.ctx.fillText(q$S,q$_+this.x,q$a+this.y,q$R,q$J,q$V)},q$S.strokeText=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this.ctx.strokeText(q$S,q$_+this.x,q$a+this.y,q$R,q$J,q$V,q$W)},q$S.blendMode=function(q$S){this.ctx.globalCompositeOperation=q$S},q$S.flush=function(){this.ctx.flush&&this.ctx.flush()},q$S.addRenderObject=function(q$S){this.ctx.addRenderObject(q$S)},q$S.beginClip=function(q$S,q$_,q$a,q$R){this.ctx.beginClip&&this.ctx.beginClip(q$S,q$_,q$a,q$R)},q$S.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},q$S.fillTrangles=function(q$S,q$_,q$a){this.ctx.fillTrangles(q$a[0],q$a[1],q$a[2],q$a[3],4<q$a.length?q$a[4]:null)},q$W.PI2=2*Math.PI,q$W}(),q$M=function(){function q$W(q$S,q$_){switch(this._next=q$_||q$W.NORENDER,q$S){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=q$F._filter);case 69905:return void(this._fun=q$W._initRenderFun)}this.onCreate(q$S)}q$H(q$W,"laya.renders.RenderSprite");var q$S=q$W.prototype;return q$S.onCreate=function(q$S){},q$S._style=function(q$S,q$_,q$a,q$R){q$S._style.render(q$S,q$_,q$a,q$R);var q$J=this._next;q$J._fun.call(q$J,q$S,q$_,q$a,q$R)},q$S._no=function(q$S,q$_,q$a,q$R){},q$S._custom=function(q$S,q$_,q$a,q$R){q$S.customRender(q$_,q$a,q$R);var q$J=q$S._style._tf;this._next._fun.call(this._next,q$S,q$_,q$a-q$J.translateX,q$R-q$J.translateY)},q$S._clip=function(q$S,q$_,q$a,q$R){var q$J=this._next;if(q$J!=q$W.NORENDER){var q$V=q$S._style.scrollRect;q$_.ctx.save(),q$_.ctx.clipRect(q$a,q$R,q$V.width,q$V.height),q$J._fun.call(q$J,q$S,q$_,q$a-q$V.x,q$R-q$V.y),q$_.ctx.restore()}},q$S._blend=function(q$S,q$_,q$a,q$R){var q$J=q$S._style;q$J.blendMode&&(q$_.ctx.globalCompositeOperation=q$J.blendMode);var q$V=this._next;q$V._fun.call(q$V,q$S,q$_,q$a,q$R),q$_.ctx.globalCompositeOperation="source-over"},q$S._mask=function(q$S,q$_,q$a,q$R){var q$J=this._next;q$J._fun.call(q$J,q$S,q$_,q$a,q$R);var q$V=q$S.mask;q$V&&(q$_.ctx.globalCompositeOperation="destination-in",(0<q$V.numChildren||!q$V.graphics._isOnlyOne())&&(q$V.cacheAsBitmap=!0),q$V.render(q$_,q$a-q$S.pivotX,q$R-q$S.pivotY)),q$_.ctx.globalCompositeOperation="source-over"},q$S._graphics=function(q$S,q$_,q$a,q$R){var q$J=q$S._style._tf;q$S._graphics&&q$S._graphics._render(q$S,q$_,q$a-q$J.translateX,q$R-q$J.translateY);var q$V=this._next;q$V._fun.call(q$V,q$S,q$_,q$a,q$R)},q$S._image=function(q$S,q$_,q$a,q$R){var q$J=q$S._style;q$_.ctx.drawTexture2(q$a,q$R,q$J._tf.translateX,q$J._tf.translateY,q$S.transform,q$J.alpha,q$J.blendMode,q$S._graphics._one)},q$S._image2=function(q$S,q$_,q$a,q$R){var q$J=q$S._style._tf;q$_.ctx.drawTexture2(q$a,q$R,q$J.translateX,q$J.translateY,q$S.transform,1,null,q$S._graphics._one)},q$S._alpha=function(q$S,q$_,q$a,q$R){var q$J;if(.01<(q$J=q$S._style.alpha)||q$S._needRepaint()){var q$V=q$_.ctx.globalAlpha;q$_.ctx.globalAlpha*=q$J;var q$W=this._next;q$W._fun.call(q$W,q$S,q$_,q$a,q$R),q$_.ctx.globalAlpha=q$V}},q$S._transform=function(q$S,q$_,q$a,q$R){var q$J=q$S.transform,q$V=this._next;q$J&&q$V!=q$W.NORENDER?(q$_.save(),q$_.transform(q$J.a,q$J.b,q$J.c,q$J.d,q$J.tx+q$a,q$J.ty+q$R),q$V._fun.call(q$V,q$S,q$_,0,0),q$_.restore()):q$V._fun.call(q$V,q$S,q$_,q$a,q$R)},q$S._childs=function(q$S,q$_,q$a,q$R){var q$J=q$S._style,q$V=q$J._tf;if(q$a=q$a-q$V.translateX+q$J.paddingLeft,q$R=q$R-q$V.translateY+q$J.paddingTop,q$J._calculation){var q$W=q$S._getWords();if(q$W){var q$k=q$J;q$k&&(q$k.stroke?q$_.fillBorderWords(q$W,q$a,q$R,q$k.font,q$k.color,q$k.strokeColor,q$k.stroke):q$_.fillWords(q$W,q$a,q$R,q$k.font,q$k.color,"none"!=q$k.textDecoration&&q$k.underLine?1:0))}}var q$z,q$b=q$S._childs,q$H=q$b.length;if(q$S.viewport||q$S.optimizeScrollRect&&q$S._style.scrollRect){var q$L=q$S.viewport||q$S._style.scrollRect,q$C=q$L.x,q$G=q$L.y,q$t=q$L.right,q$o=q$L.bottom,q$$=NaN,q$F=NaN;for(q$T=0;q$T<q$H;++q$T)(q$z=q$b[q$T]).visible&&(q$$=q$z._x)<q$t&&q$$+q$z.width>q$C&&(q$F=q$z._y)<q$o&&q$F+q$z.height>q$G&&q$z.render(q$_,q$a,q$R)}else for(var q$T=0;q$T<q$H;++q$T)(q$z=q$b[q$T])._style.visible&&q$z.render(q$_,q$a,q$R)},q$S._canvas=function(q$S,q$_,q$a,q$R){var q$J=q$S._$P.cacheCanvas;if(q$J){"bitmap"===q$J.type?q$c.canvasBitmap++:q$c.canvasNormal++;var q$V=q$J.ctx;if(q$S._needRepaint()||!q$V)this._canvas_repaint(q$S,q$_,q$a,q$R);else{var q$W=q$J._cacheRec;q$_.drawCanvas(q$V.canvas,q$a+q$W.x,q$R+q$W.y,q$W.width,q$W.height)}}else this._next._fun.call(this._next,q$S,q$_,q$a,q$R)},q$S._canvas_repaint=function(q$S,q$_,q$a,q$R){var q$J=q$S._$P.cacheCanvas,q$V=this._next;if(q$J){var q$W,q$k,q$z,q$b,q$H=q$J.ctx,q$L=q$S._needRepaint()||!q$H,q$C=q$J.type;if("bitmap"===q$C?q$c.canvasBitmap++:q$c.canvasNormal++,q$L){var q$G,q$t;q$J._cacheRec||(q$J._cacheRec=new q$n),q$K.isWebGL&&"bitmap"!==q$C?q$J._cacheRec.setTo(-q$S.pivotX,-q$S.pivotY,1,1):((q$b=q$S.getSelfBounds()).x=q$b.x-q$S.pivotX,q$b.y=q$b.y-q$S.pivotY,q$b.x=q$b.x-16,q$b.y=q$b.y-16,q$b.width=q$b.width+32,q$b.height=q$b.height+32,q$b.x=Math.floor(q$b.x+q$a)-q$a,q$b.y=Math.floor(q$b.y+q$R)-q$R,q$b.width=Math.floor(q$b.width),q$b.height=Math.floor(q$b.height),q$J._cacheRec.copyFrom(q$b)),q$b=q$J._cacheRec;var q$o,q$$=q$K.isWebGL?1:q$g.pixelRatio*q$q.stage.clientScaleX,q$F=q$K.isWebGL?1:q$g.pixelRatio*q$q.stage.clientScaleY;if(!q$K.isWebGL){var q$T,q$D=1,q$j=1;for(q$T=q$S;q$T&&q$T!=q$q.stage;)q$D*=q$T.scaleX,q$j*=q$T.scaleY,q$T=q$T.parent;q$K.isWebGL?(q$D<1&&(q$$*=q$D),q$j<1&&(q$F*=q$j)):(1<q$D&&(q$$*=q$D),1<q$j&&(q$F*=q$j))}if(q$S.scrollRect){var q$Q=q$S.scrollRect;q$b.x-=q$Q.x,q$b.y-=q$Q.y}if(q$G=q$b.width*q$$,q$t=q$b.height*q$F,q$k=q$b.x,q$z=q$b.y,q$K.isWebGL&&"bitmap"===q$C&&(2048<q$G||2048<q$t))return console.warn("cache bitmap size larger than 2048,cache ignored"),q$J.ctx&&(q$p.recover("RenderContext",q$J.ctx),q$J.ctx.canvas.size(0,0),q$J.ctx=null),void q$V._fun.call(q$V,q$S,q$_,q$a,q$R);if(q$H||(q$H=q$J.ctx=q$p.getItem("RenderContext")||new q$P(q$G,q$t,q$DS.create("AUTO"))),q$H.ctx.sprite=q$S,(q$W=q$H.canvas).clear(),(q$W.width!=q$G||q$W.height!=q$t)&&q$W.size(q$G,q$t),"bitmap"===q$C?q$W.context.asBitmap=!0:"normal"===q$C&&(q$W.context.asBitmap=!1),1!=q$$||1!=q$F){var q$m=q$H.ctx;q$m.save(),q$m.scale(q$$,q$F),!q$K.isConchWebGL&&q$K.isConchApp&&(q$o=q$S._$P.cf)&&q$m.setFilterMatrix&&q$m.setFilterMatrix(q$o._mat,q$o._alpha),q$V._fun.call(q$V,q$S,q$H,-q$k,-q$z),q$m.restore(),q$K.isConchApp&&!q$K.isConchWebGL||q$S._applyFilters()}else q$m=q$H.ctx,!q$K.isConchWebGL&&q$K.isConchApp&&(q$o=q$S._$P.cf)&&q$m.setFilterMatrix&&q$m.setFilterMatrix(q$o._mat,q$o._alpha),q$V._fun.call(q$V,q$S,q$H,-q$k,-q$z),q$K.isConchApp&&!q$K.isConchWebGL||q$S._applyFilters();q$S._$P.staticCache&&(q$J.reCache=!1),q$c.canvasReCache++}else q$k=(q$b=q$J._cacheRec).x,q$z=q$b.y,q$W=q$H.canvas;q$_.drawCanvas(q$W,q$a+q$k,q$R+q$z,q$b.width,q$b.height)}else q$V._fun.call(q$V,q$S,q$H,q$a,q$R)},q$W.__init__=function(){var q$S,q$_,q$a=0;for(q$_=q$A.createRenderSprite(69905,null),q$S=q$W.renders.length=4096,q$a=0;q$a<q$S;q$a++)q$W.renders[q$a]=q$_;q$W.renders[0]=q$A.createRenderSprite(0,null),function(q$S,q$_){for(var q$a=0,q$R=0;q$R<q$S.length;q$R++)q$a|=q$S[q$R],q$W.renders[q$a]=q$_}([1,512,4,2],new q$W(1,null)),q$W.renders[513]=q$A.createRenderSprite(513,null),q$W.renders[517]=new q$W(517,null)},q$W._initRenderFun=function(q$S,q$_,q$a,q$R){var q$J=q$S._renderType;(q$W.renders[q$J]=q$W._getTypeRender(q$J))._fun(q$S,q$_,q$a,q$R)},q$W._getTypeRender=function(q$S){for(var q$_=null,q$a=2048;1<q$a;)q$a&q$S&&(q$_=q$A.createRenderSprite(q$a,q$_)),q$a>>=1;return q$_},q$W.IMAGE=1,q$W.ALPHA=2,q$W.TRANSFORM=4,q$W.BLEND=8,q$W.CANVAS=16,q$W.FILTERS=32,q$W.MASK=64,q$W.CLIP=128,q$W.STYLE=256,q$W.GRAPHICS=512,q$W.CUSTOM=1024,q$W.CHILDS=2048,q$W.INIT=69905,q$W.renders=[],q$W.NORENDER=new q$W(0,null),q$W}(),q$r=function(){function q$k(){this._repaint=!1}q$H(q$k,"laya.resource.Context");var q$S=q$k.prototype;return q$S.replaceReset=function(){var q$S,q$_,q$a=0;for(q$S=q$k.replaceKeys.length,q$a=0;q$a<q$S;q$a++)q$_=q$k.replaceKeys[q$a],this[q$k.newKeys[q$a]]=this[q$_]},q$S.replaceResotre=function(){this.__restore(),this.__reset()},q$S.setIsMainContext=function(){},q$S.drawTextures=function(q$S,q$_,q$a,q$R){q$c.drawCall+=q$_.length/2;for(var q$J=q$S.width,q$V=q$S.height,q$W=0,q$k=q$_.length;q$W<q$k;q$W+=2)this.drawTexture(q$S,q$_[q$W],q$_[q$W+1],q$J,q$V,q$a,q$R)},q$S.drawCanvas=function(q$S,q$_,q$a,q$R,q$J){q$c.drawCall++,this.drawImage(q$S.source,q$_,q$a,q$R,q$J)},q$S.fillRect=function(q$S,q$_,q$a,q$R,q$J){q$c.drawCall++,q$J&&(this.fillStyle=q$J),this.__fillRect(q$S,q$_,q$a,q$R)},q$S.fillText=function(q$S,q$_,q$a,q$R,q$J,q$V){q$c.drawCall++,3<arguments.length&&null!=q$R&&(this.font=q$R,this.fillStyle=q$J,this.textAlign=q$V,this.textBaseline="top"),this.__fillText(q$S,q$_,q$a)},q$S.fillBorderText=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){q$c.drawCall++,this.font=q$R,this.fillStyle=q$J,this.textBaseline="top",this.strokeStyle=q$V,this.lineWidth=q$W,this.textAlign=q$k,this.__strokeText(q$S,q$_,q$a),this.__fillText(q$S,q$_,q$a)},q$S.strokeText=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){q$c.drawCall++,3<arguments.length&&null!=q$R&&(this.font=q$R,this.strokeStyle=q$J,this.lineWidth=q$V,this.textAlign=q$W,this.textBaseline="top"),this.__strokeText(q$S,q$_,q$a)},q$S.transformByMatrix=function(q$S){this.transform(q$S.a,q$S.b,q$S.c,q$S.d,q$S.tx,q$S.ty)},q$S.setTransformByMatrix=function(q$S){this.setTransform(q$S.a,q$S.b,q$S.c,q$S.d,q$S.tx,q$S.ty)},q$S.clipRect=function(q$S,q$_,q$a,q$R){q$c.drawCall++,this.beginPath(),this.rect(q$S,q$_,q$a,q$R),this.clip()},q$S.drawTexture=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){q$c.drawCall++;var q$k=q$S.uv,q$z=q$S.bitmap.width,q$b=q$S.bitmap.height;this.drawImage(q$S.source,q$k[0]*q$z,q$k[1]*q$b,(q$k[2]-q$k[0])*q$z,(q$k[5]-q$k[3])*q$b,q$_+q$V,q$a+q$W,q$R,q$J)},q$S.drawTextureWithTransform=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){q$c.drawCall++;var q$b=q$S.uv,q$H=q$S.bitmap.width,q$L=q$S.bitmap.height;this.save(),1!=q$z&&(this.globalAlpha*=q$z),q$V?(this.transform(q$V.a,q$V.b,q$V.c,q$V.d,q$V.tx+q$W,q$V.ty+q$k),this.drawImage(q$S.source,q$b[0]*q$H,q$b[1]*q$L,(q$b[2]-q$b[0])*q$H,(q$b[5]-q$b[3])*q$L,q$_,q$a,q$R,q$J)):this.drawImage(q$S.source,q$b[0]*q$H,q$b[1]*q$L,(q$b[2]-q$b[0])*q$H,(q$b[5]-q$b[3])*q$L,q$_+q$W,q$a+q$k,q$R,q$J),this.restore()},q$S.drawTexture2=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){var q$z=q$k[0];if(q$z.loaded&&q$z.bitmap&&q$z.source){q$c.drawCall++;var q$b=1!==q$V;if(q$b){var q$H=this.globalAlpha;this.globalAlpha*=q$V}var q$L=q$z.uv,q$C=q$z.bitmap.width,q$G=q$z.bitmap.height;q$J?(this.save(),this.transform(q$J.a,q$J.b,q$J.c,q$J.d,q$J.tx+q$S,q$J.ty+q$_),this.drawImage(q$z.source,q$L[0]*q$C,q$L[1]*q$G,(q$L[2]-q$L[0])*q$C,(q$L[5]-q$L[3])*q$G,q$k[1]-q$a,q$k[2]-q$R,q$k[3],q$k[4]),this.restore()):this.drawImage(q$z.source,q$L[0]*q$C,q$L[1]*q$G,(q$L[2]-q$L[0])*q$C,(q$L[5]-q$L[3])*q$G,q$k[1]-q$a+q$S,q$k[2]-q$R+q$_,q$k[3],q$k[4]),q$b&&(this.globalAlpha=q$H)}},q$S.fillTexture=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){if(!q$k.pat){if(q$S.uv!=q$HS.DEF_UV){var q$z=new q$DS("2D");q$z.getContext("2d"),q$z.size(q$S.width,q$S.height),q$z.context.drawTexture(q$S,0,0,q$S.width,q$S.height,0,0),q$S=new q$HS(q$z)}q$k.pat=this.createPattern(q$S.bitmap.source,q$V)}var q$b=q$_,q$H=q$a,q$L=0,q$C=0;q$W&&(q$b+=q$W.x%q$S.width,q$H+=q$W.y%q$S.height,q$L-=q$W.x%q$S.width,q$C-=q$W.y%q$S.height),this.translate(q$b,q$H),this.fillRect(q$L,q$C,q$R,q$J,q$k.pat),this.translate(-q$b,-q$H)},q$S.drawTriangle=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){var q$z=q$S.bitmap,q$b=q$z.source,q$H=q$S.width,q$L=q$S.height,q$C=q$z.width,q$G=q$z.height,q$t=q$a[q$R]*q$C,q$o=q$a[q$J]*q$C,q$$=q$a[q$V]*q$C,q$F=q$a[q$R+1]*q$G,q$T=q$a[q$J+1]*q$G,q$D=q$a[q$V+1]*q$G,q$j=q$_[q$R],q$Q=q$_[q$J],q$m=q$_[q$V],q$q=q$_[q$R+1],q$N=q$_[q$J+1],q$n=q$_[q$V+1];if(q$k){var q$l=(q$j+q$Q+q$m)/3,q$B=(q$q+q$N+q$n)/3,q$I=q$j-q$l,q$A=q$q-q$B,q$X=Math.sqrt(q$I*q$I+q$A*q$A);q$j=q$l+q$I/q$X*(q$X+1),q$q=q$B+q$A/q$X*(q$X+1),q$A=q$N-q$B,q$Q=q$l+(q$I=q$Q-q$l)/(q$X=Math.sqrt(q$I*q$I+q$A*q$A))*(q$X+1),q$N=q$B+q$A/q$X*(q$X+1),q$A=q$n-q$B,q$m=q$l+(q$I=q$m-q$l)/(q$X=Math.sqrt(q$I*q$I+q$A*q$A))*(q$X+1),q$n=q$B+q$A/q$X*(q$X+1)}this.save(),q$W&&this.transform(q$W.a,q$W.b,q$W.c,q$W.d,q$W.tx,q$W.ty),this.beginPath(),this.moveTo(q$j,q$q),this.lineTo(q$Q,q$N),this.lineTo(q$m,q$n),this.closePath(),this.clip();var q$h=1/(q$t*q$T+q$F*q$$+q$o*q$D-q$T*q$$-q$F*q$o-q$t*q$D),q$u=q$j*q$T+q$F*q$m+q$Q*q$D-q$T*q$m-q$F*q$Q-q$j*q$D,q$K=q$t*q$Q+q$j*q$$+q$o*q$m-q$Q*q$$-q$j*q$o-q$t*q$m,q$P=q$t*q$T*q$m+q$F*q$Q*q$$+q$j*q$o*q$D-q$j*q$T*q$$-q$F*q$o*q$m-q$t*q$Q*q$D,q$M=q$q*q$T+q$F*q$n+q$N*q$D-q$T*q$n-q$F*q$N-q$q*q$D,q$r=q$t*q$N+q$q*q$$+q$o*q$n-q$N*q$$-q$q*q$o-q$t*q$n,q$e=q$t*q$T*q$n+q$F*q$N*q$$+q$q*q$o*q$D-q$q*q$T*q$$-q$F*q$o*q$n-q$t*q$N*q$D;this.transform(q$u*q$h,q$M*q$h,q$K*q$h,q$r*q$h,q$P*q$h,q$e*q$h),this.drawImage(q$b,q$S.uv[0]*q$C,q$S.uv[1]*q$G,q$H,q$L,q$S.uv[0]*q$C,q$S.uv[1]*q$G,q$H,q$L),this.restore()},q$S.flush=function(){return 0},q$S.fillWords=function(q$S,q$_,q$a,q$R,q$J,q$V){q$R&&(this.font=q$R),q$J&&(this.fillStyle=q$J);this.textBaseline="top",this.textAlign="left";for(var q$W=0,q$k=q$S.length;q$W<q$k;q$W++){var q$z=q$S[q$W];if(this.__fillText(q$z.char,q$z.x+q$_,q$z.y+q$a),1===q$V){var q$b=q$z.height,q$H=.5*q$z.style.letterSpacing;q$H||(q$H=0),this.beginPath(),this.strokeStyle=q$J,this.lineWidth=1,this.moveTo(q$_+q$z.x-q$H+.5,q$a+q$z.y+q$b+.5),this.lineTo(q$_+q$z.x+q$z.width+q$H+.5,q$a+q$z.y+q$b+.5),this.stroke()}}},q$S.fillBorderWords=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){q$R&&(this.font=q$R),q$J&&(this.fillStyle=q$J),this.textBaseline="top",this.lineWidth=q$W,this.textAlign="left",this.strokeStyle=q$V;for(var q$k=0,q$z=q$S.length;q$k<q$z;q$k++){var q$b=q$S[q$k];this.__strokeText(q$b.char,q$b.x+q$_,q$b.y+q$a),this.__fillText(q$b.char,q$b.x+q$_,q$b.y+q$a)}},q$S.destroy=function(){this.canvas.width=this.canvas.height=0},q$S.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},q$S.drawCurves=function(q$S,q$_,q$a){this.beginPath(),this.strokeStyle=q$a[3],this.lineWidth=q$a[4];var q$R=q$a[2];q$S+=q$a[0],q$_+=q$a[1],this.moveTo(q$S+q$R[0],q$_+q$R[1]);for(var q$J=2,q$V=q$R.length;q$J<q$V;)this.quadraticCurveTo(q$S+q$R[q$J++],q$_+q$R[q$J++],q$S+q$R[q$J++],q$_+q$R[q$J++]);this.stroke()},q$k.__init__=function(q$_){var q$a=laya.resource.Context.prototype;if(!(q$_=q$_||CanvasRenderingContext2D.prototype).inited){q$_.inited=!0,q$_.__fillText=q$_.fillText,q$_.__fillRect=q$_.fillRect,q$_.__strokeText=q$_.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(q$S){q$_[q$S]=q$a[q$S]})}},q$k.replaceCanvasGetSet=function(q$S,q$_){var q$a=Object.getOwnPropertyDescriptor(q$S,q$_);if(!q$a||!q$a.configurable)return!1;var q$R,q$J={};for(q$R in q$a)"set"!=q$R&&(q$J[q$R]=q$a[q$R]);var q$V=q$a.set;return q$J.set=function(q$S){q$V.call(this,q$S);var q$_=this.getContext("2d");q$_&&"__reset"in q$_&&q$_.__reset()},Object.defineProperty(q$S,q$_,q$J),!0},q$k.replaceGetSet=function(q$S,q$_){var q$a=Object.getOwnPropertyDescriptor(q$S,q$_);if(!q$a||!q$a.configurable)return!1;var q$R,q$J={};for(q$R in q$a)"set"!=q$R&&(q$J[q$R]=q$a[q$R]);var q$V=q$a.set,q$W="___"+q$_+"__";return q$k.newKeys.push(q$W),q$J.set=function(q$S){q$S!=this[q$W]&&(this[q$W]=q$S,q$V.call(this,q$S))},Object.defineProperty(q$S,q$_,q$J),!0},q$k._default=new q$k,q$k.newKeys=[],q$z(q$k,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),q$k}(),q$e=function(){function q$V(q$S){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++q$V._uniqueIDCounter,this._name=q$S||"Content Manager",q$V._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,q$V._resourceManagers.push(this),this._resources=[],this._records={}}q$H(q$V,"laya.resource.ResourceManager");var q$S=q$V.prototype;return q$q.imps(q$S,{"laya.resource.IDispose":!0}),q$S.getResourceByIndex=function(q$S){return this._resources[q$S]},q$S.getResourcesLength=function(){return this._resources.length},q$S.addResource=function(q$S){return q$S.resourceManager&&q$S.resourceManager.removeResource(q$S),-1===this._resources.indexOf(q$S)&&((q$S._resourceManager=this)._resources.push(q$S),this.addRecord(q$S.uri,q$S.__className,q$S.memorySize),this.addSize(q$S.memorySize),!0)},q$S.removeResource=function(q$S){var q$_=this._resources.indexOf(q$S);return-1!==q$_&&(this._resources.splice(q$_,1),q$S._resourceManager=null,this._memorySize-=q$S.memorySize,this.addRecord(q$S.uri,q$S.__className,-q$S.memorySize),!0)},q$S.unload=function(){for(var q$S=this._resources.slice(0,this._resources.length),q$_=0;q$_<q$S.length;q$_++){q$S[q$_].destroy()}q$S.length=0},q$S.dispose=function(){if(this===q$V._systemResourceManager)throw new Error("systemResourceManager不能被释放！");q$V._resourceManagers.splice(q$V._resourceManagers.indexOf(this),1),q$V._isResourceManagersSorted=!1;for(var q$S=this._resources.slice(0,this._resources.length),q$_=0;q$_<q$S.length;q$_++){var q$a=q$S[q$_];q$a.resourceManager.removeResource(q$a),q$a.destroy()}q$S.length=0},q$S.addSize=function(q$S){q$S&&(this.autoRelease&&0<q$S&&this._memorySize+q$S>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=q$S)},q$S.addRecord=function(q$S,q$_,q$a){DEBUG&&q$a&&!q$S&&console.error(q$S,q$_,q$a),q$S&&(this._records.hasOwnProperty(q$_+"|"+q$S)||(this._records[q$_+"|"+q$S]=0),this._records[q$_+"|"+q$S]+=q$a,DEBUG&&this._records[q$_+"|"+q$S]<0&&console.error(q$S,q$_,this._records[q$_+"|"+q$S]))},q$S.garbageCollection=function(q$S){var q$_=this._resources;(q$_=q$_.slice()).sort(function(q$S,q$_){if(!q$S||!q$_)throw new Error("a或b不能为空！");return q$S.released&&q$_.released?0:q$S.released?1:q$_.released?-1:q$S._lastUseFrameCount-q$_._lastUseFrameCount});for(var q$a=q$c.loopCount,q$R=0,q$J=q$_.length;q$R<q$J;q$R++){var q$V=q$_[q$R];if(!(1<q$a-q$V._lastUseFrameCount))return void(this._memorySize>=q$S&&(this._isOverflow=!0));if(q$V.releaseResource(),this._memorySize<q$S)return void(this._isOverflow=!1)}},q$t(0,q$S,"id",function(){return this._id}),q$t(0,q$S,"name",function(){return this._name},function(q$S){!q$S&&""===q$S||this._name===q$S||(this._name=q$S,q$V._isResourceManagersSorted=!1)}),q$t(0,q$S,"memorySize",function(){return this._memorySize}),q$t(0,q$S,"records",function(){return this._records}),q$t(1,q$V,"systemResourceManager",function(){return q$V._systemResourceManager}),q$V.__init__=function(){q$V.currentResourceManager=q$V.systemResourceManager},q$V.getLoadedResourceManagerByIndex=function(q$S){return q$V._resourceManagers[q$S]},q$V.getLoadedResourceManagersCount=function(){return q$V._resourceManagers.length},q$V.recreateContentManagers=function(q$S){void 0===q$S&&(q$S=!1);for(var q$_=q$V.currentResourceManager,q$a=0;q$a<q$V._resourceManagers.length;q$a++){q$V.currentResourceManager=q$V._resourceManagers[q$a];for(var q$R=0;q$R<q$V.currentResourceManager._resources.length;q$R++)q$V.currentResourceManager._resources[q$R].releaseResource(q$S),q$V.currentResourceManager._resources[q$R].activeResource(q$S)}q$V.currentResourceManager=q$_},q$V.releaseContentManagers=function(q$S){void 0===q$S&&(q$S=!1);for(var q$_=q$V.currentResourceManager,q$a=0;q$a<q$V._resourceManagers.length;q$a++){q$V.currentResourceManager=q$V._resourceManagers[q$a];for(var q$R=0;q$R<q$V.currentResourceManager._resources.length;q$R++){var q$J=q$V.currentResourceManager._resources[q$R];!q$J.released&&q$J.releaseResource(q$S)}}q$V.currentResourceManager=q$_},q$V._uniqueIDCounter=0,q$V._isResourceManagersSorted=!1,q$V._resourceManagers=[],q$z(q$V,["_systemResourceManager",function(){return this._systemResourceManager=new q$V("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=q$V._systemResourceManager}]),q$V}(),q$g=(function(){function q$S(){}q$H(q$S,"laya.system.System"),q$S.changeDefinition=function(q$S,q$_){q$q[q$S]=q$_;var q$a=q$S+"=classObj";q$q._runScript(q$a)},q$S.__init__=function(){q$K.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function q$a(){}return q$H(q$a,"laya.utils.Browser"),q$t(1,q$a,"pixelRatio",function(){return q$a.__init__(),-1<q$a.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:q$A.getPixelRatio()}),q$t(1,q$a,"height",function(){return q$a.__init__(),(q$q.stage&&q$q.stage.canvasRotation?q$a.clientWidth:q$a.clientHeight)*q$a.pixelRatio}),q$t(1,q$a,"clientWidth",function(){return q$a.__init__(),q$a.window.innerWidth||q$a.document.body.clientWidth}),q$t(1,q$a,"window",function(){return q$a.__init__(),q$a._window}),q$t(1,q$a,"clientHeight",function(){return q$a.__init__(),q$a.window.innerHeight||q$a.document.body.clientHeight||q$a.document.documentElement.clientHeight}),q$t(1,q$a,"width",function(){return q$a.__init__(),(q$q.stage&&q$q.stage.canvasRotation?q$a.clientHeight:q$a.clientWidth)*q$a.pixelRatio}),q$t(1,q$a,"container",function(){return q$a.__init__(),q$a._container||((q$a._container=q$a.createElement("div")).id="layaContainer",q$a.document.body.appendChild(q$a._container)),q$a._container},function(q$S){q$a._container=q$S}),q$t(1,q$a,"document",function(){return q$a.__init__(),q$a._document}),q$a.__init__=function(){if(!q$a._window){q$a._window=q$A.getWindow(),q$a._document=q$a.window.document,q$a._window.addEventListener("message",function(q$S){laya.utils.Browser._onMessage(q$S)},!1),q$a.document.__createElement=q$a.document.createElement,q$W.requestAnimationFrame=q$W.requestAnimationFrame||q$W.webkitRequestAnimationFrame||q$W.mozRequestAnimationFrame||q$W.oRequestAnimationFrame||q$W.msRequestAnimationFrame||function(q$S){return q$W.setTimeout(q$S,1e3/60)};var q$S=q$W.document.body.style;q$S["-webkit-user-select"]="none",q$S["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",q$a.userAgent=q$a.window.navigator.userAgent,q$a.onIOS=!!(q$a.u=q$a.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),q$a.onMobile=-1<q$a.u.indexOf("Mobile"),q$a.onIPhone=-1<q$a.u.indexOf("iPhone"),q$a.onMac=-1<q$a.u.indexOf("Mac OS X"),q$a.onIPad=-1<q$a.u.indexOf("iPad"),q$a.onAndroid=-1<q$a.u.indexOf("Android")||-1<q$a.u.indexOf("Adr"),q$a.onWP=-1<q$a.u.indexOf("Windows Phone"),q$a.onQQBrowser=-1<q$a.u.indexOf("QQBrowser"),q$a.onMQQBrowser=-1<q$a.u.indexOf("MQQBrowser")||-1<q$a.u.indexOf("Mobile")&&-1<q$a.u.indexOf("QQ"),q$a.onIE=!!q$a.window.ActiveXObject||"ActiveXObject"in q$a.window,q$a.onWeiXin=-1<q$a.u.indexOf("MicroMessenger"),q$a.onPC=!q$a.onMobile,q$a.onSafari=-1<q$a.u.indexOf("Safari"),q$a.onFirefox=-1<q$a.u.indexOf("Firefox"),q$a.onEdge=-1<q$a.u.indexOf("Edge"),q$a.onMiniGame=-1<q$a.u.indexOf("MiniGame"),q$a.onLimixiu=-1<q$a.u.indexOf("limixiu"),q$a.httpProtocol="http:"==q$a.window.location.protocol,q$a.onMiniGame&&null==q$a.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),q$a.webAudioEnabled=!!(q$a.window.AudioContext||q$a.window.webkitAudioContext||q$a.window.mozAudioContext),q$a.soundType=q$a.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",q$JS=q$a.webAudioEnabled?q$VS:q$aS,q$a.webAudioEnabled&&q$VS.initWebAudio(),q$aS._initMusicAudio(),q$a.enableTouch="ontouchstart"in q$W||q$W.DocumentTouch&&q$_ instanceof DocumentTouch,q$W.focus(),q$I._soundClass=q$JS,q$I._musicClass=q$aS,q$K._mainCanvas=q$K._mainCanvas||q$DS.create("2D"),q$a.canvas||(q$a.canvas=q$DS.create("2D"),q$a.context=q$a.canvas.getContext("2d"))}},q$a._onMessage=function(q$S){if(q$S.data&&"size"==q$S.data.name){if(q$a.window.innerWidth=q$S.data.width,q$a.window.innerHeight=q$S.data.height,q$a.window.__innerHeight=q$S.data.clientHeight,!q$a.document.createEvent)return void console.warn("no document.createEvent");var q$_=q$a.document.createEvent("HTMLEvents");return q$_.initEvent("resize",!1,!1),void q$a.window.dispatchEvent(q$_)}},q$a.createElement=function(q$S){return q$a.__init__(),q$a.document.__createElement(q$S)},q$a.getElementById=function(q$S){return q$a.__init__(),q$a.document.getElementById(q$S)},q$a.removeElement=function(q$S){q$S&&q$S.parentNode&&q$S.parentNode.removeChild(q$S)},q$a.now=function(){return q$A.now()},q$a._window=null,q$a._document=null,q$a._container=null,q$a.userAgent=null,q$a.u=null,q$a.onIOS=!1,q$a.onMac=!1,q$a.onMobile=!1,q$a.onIPhone=!1,q$a.onIPad=!1,q$a.onAndroid=!1,q$a.onWP=!1,q$a.onQQBrowser=!1,q$a.onMQQBrowser=!1,q$a.onSafari=!1,q$a.onFirefox=!1,q$a.onEdge=!1,q$a.onIE=!1,q$a.onWeiXin=!1,q$a.onMiniGame=!1,q$a.onLimixiu=!1,q$a.onPC=!1,q$a.httpProtocol=!1,q$a.webAudioEnabled=!1,q$a.soundType=null,q$a.enableTouch=!1,q$a.canvas=null,q$a.context=null,q$a.__init$=function(){},q$a}()),q$x=function(){function q$_(q$S){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,q$S?(this._u8d_=new Uint8Array(q$S),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}q$H(q$_,"laya.utils.Byte");var q$S=q$_.prototype;return q$S.___resizeBuffer=function(q$_){try{var q$S=new Uint8Array(q$_);null!=this._u8d_&&(this._u8d_.length<=q$_?q$S.set(this._u8d_):q$S.set(this._u8d_.subarray(0,q$_))),this._u8d_=q$S,this._d_=new DataView(q$S.buffer)}catch(q$S){throw"___resizeBuffer err:"+q$_}},q$S.getString=function(){return this.rUTF(this.getUint16())},q$S.getFloat32Array=function(q$S,q$_){var q$a=q$S+q$_;q$a=q$a>this._length?this._length:q$a;var q$R=new Float32Array(this._d_.buffer.slice(q$S,q$a));return this._pos_=q$a,q$R},q$S.getUint8Array=function(q$S,q$_){var q$a=q$S+q$_;q$a=q$a>this._length?this._length:q$a;var q$R=new Uint8Array(this._d_.buffer.slice(q$S,q$a));return this._pos_=q$a,q$R},q$S.getInt16Array=function(q$S,q$_){var q$a=q$S+q$_;q$a=q$a>this._length?this._length:q$a;var q$R=new Int16Array(this._d_.buffer.slice(q$S,q$a));return this._pos_=q$a,q$R},q$S.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var q$S=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,q$S},q$S.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var q$S=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,q$S},q$S.writeFloat32=function(q$S){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,q$S,this._xd_),this._pos_+=4},q$S.writeFloat64=function(q$S){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,q$S,this._xd_),this._pos_+=8},q$S.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var q$S=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,q$S},q$S.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var q$S=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,q$S},q$S.writeInt32=function(q$S){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,q$S,this._xd_),this._pos_+=4},q$S.writeUint32=function(q$S){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,q$S,this._xd_),this._pos_+=4},q$S.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var q$S=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,q$S},q$S.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var q$S=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,q$S},q$S.writeUint16=function(q$S){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,q$S,this._xd_),this._pos_+=2},q$S.writeInt16=function(q$S){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,q$S,this._xd_),this._pos_+=2},q$S.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},q$S.writeUint8=function(q$S){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,q$S),this._pos_++},q$S._getUInt8=function(q$S){return this._d_.getUint8(q$S)},q$S._getUint16=function(q$S){return this._d_.getUint16(q$S,this._xd_)},q$S._getMatrix=function(){return new q$X(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},q$S.rUTF=function(q$S){for(var q$_=[],q$a=this._pos_+q$S,q$R=0,q$J=0,q$V=0,q$W=String.fromCharCode,q$k=this._u8d_;this._pos_<q$a;)(q$R=q$k[this._pos_++])<128?0!=q$R&&q$_.push(q$W(q$R)):q$R<224?q$_.push(q$W((63&q$R)<<6|127&q$k[this._pos_++])):q$R<240?(q$J=q$k[this._pos_++],q$_.push(q$W((31&q$R)<<12|(127&q$J)<<6|127&q$k[this._pos_++]))):(q$J=q$k[this._pos_++],q$V=q$k[this._pos_++],q$_.push(q$W((15&q$R)<<18|(127&q$J)<<12|q$V<<6&127|127&q$k[this._pos_++]))),0;return q$_.join("")},q$S.getCustomString=function(q$S){for(var q$_=[],q$a=0,q$R=0,q$J=0,q$V=String.fromCharCode,q$W=this._u8d_;0<q$S;)if((q$R=q$W[this._pos_])<128)q$_.push(q$V(q$R)),this._pos_++,q$S--;else for(q$a=q$R-128,this._pos_++,q$S-=q$a;0<q$a;)q$R=q$W[this._pos_++],q$J=q$W[this._pos_++],q$_.push(q$V(q$J<<8|q$R)),q$a--;return q$_.join("")},q$S.clear=function(){this._pos_=0,this.length=0},q$S.__getBuffer=function(){return this._d_.buffer},q$S.writeUTFBytes=function(q$S){for(var q$_=0,q$a=(q$S+="").length;q$_<q$a;q$_++){var q$R=q$S.charCodeAt(q$_);q$R<=127?this.writeByte(q$R):q$R<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|q$R>>6,128|63&q$R],this._pos_),this._pos_+=2):q$R<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|q$R>>12,128|q$R>>6&63,128|63&q$R],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|q$R>>18,128|q$R>>12&63,128|q$R>>6&63,128|63&q$R],this._pos_),this._pos_+=4)}},q$S.writeUTFString=function(q$S){var q$_=this.pos;this.writeUint16(1),this.writeUTFBytes(q$S);var q$a=this.pos-q$_-2;if(65536<=q$a)throw"writeUTFString byte len more than 65536";this._d_.setUint16(q$_,q$a,this._xd_)},q$S.readUTFString=function(){return this.readUTFBytes(this.getUint16())},q$S.getUTFString=function(){return this.readUTFString()},q$S.readUTFBytes=function(q$S){if(void 0===q$S&&(q$S=-1),0==q$S)return"";var q$_=this.bytesAvailable;if(q$_<q$S)throw"readUTFBytes error - Out of bounds";return q$S=0<q$S?q$S:q$_,this.rUTF(q$S)},q$S.getUTFBytes=function(q$S){return void 0===q$S&&(q$S=-1),this.readUTFBytes(q$S)},q$S.writeByte=function(q$S){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,q$S),this._pos_+=1},q$S.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},q$S.getByte=function(){return this.readByte()},q$S.ensureWrite=function(q$S){this._length<q$S&&(this._length=q$S),this._allocated_<q$S&&(this.length=q$S)},q$S.writeArrayBuffer=function(q$S,q$_,q$a){if(void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),q$_<0||q$a<0)throw"writeArrayBuffer error - Out of bounds";0==q$a&&(q$a=q$S.byteLength-q$_),this.ensureWrite(this._pos_+q$a);var q$R=new Uint8Array(q$S);this._u8d_.set(q$R.subarray(q$_,q$_+q$a),this._pos_),this._pos_+=q$a},q$t(0,q$S,"buffer",function(){var q$S=this._d_.buffer;return q$S.byteLength==this.length?q$S:q$S.slice(0,this.length)}),q$t(0,q$S,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(q$S){this._xd_="littleEndian"==q$S}),q$t(0,q$S,"length",function(){return this._length},function(q$S){this._allocated_<q$S?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(q$S,2*this._allocated_))):this._allocated_>q$S&&this.___resizeBuffer(this._allocated_=q$S),this._length=q$S}),q$t(0,q$S,"pos",function(){return this._pos_},function(q$S){this._pos_=q$S}),q$t(0,q$S,"bytesAvailable",function(){return this._length-this._pos_}),q$_.getSystemEndian=function(){if(!q$_._sysEndian){var q$S=new ArrayBuffer(2);new DataView(q$S).setInt16(0,256,!0),q$_._sysEndian=256===new Int16Array(q$S)[0]?"littleEndian":"bigEndian"}return q$_._sysEndian},q$_.BIG_ENDIAN="bigEndian",q$_.LITTLE_ENDIAN="littleEndian",q$_._sysEndian=null,q$_}(),q$s=function(){function q$J(){}return q$H(q$J,"laya.utils.CacheManager"),q$J.regCacheByFunction=function(q$S,q$_){var q$a;q$J.unRegCacheByFunction(q$S,q$_),q$a={tryDispose:q$S,getCacheList:q$_},q$J._cacheList.push(q$a)},q$J.unRegCacheByFunction=function(q$S,q$_){var q$a,q$R=0;for(q$a=q$J._cacheList.length,q$R=0;q$R<q$a;q$R++)if(q$J._cacheList[q$R].tryDispose==q$S&&q$J._cacheList[q$R].getCacheList==q$_)return void q$J._cacheList.splice(q$R,1)},q$J.forceDispose=function(){var q$S=0,q$_=q$J._cacheList.length;for(q$S=0;q$S<q$_;q$S++)q$J._cacheList[q$S].tryDispose(!0)},q$J.beginCheck=function(q$S){void 0===q$S&&(q$S=15e3),q$q.timer.loop(q$S,null,q$J._checkLoop)},q$J.stopCheck=function(){q$q.timer.clear(null,q$J._checkLoop)},q$J._checkLoop=function(){var q$S=q$J._cacheList;if(!(q$S.length<1)){var q$_,q$a=q$g.now(),q$R=0;for(q$_=q$R=q$S.length;0<q$R&&(q$S[q$J._index=++q$J._index%q$_].tryDispose(!1),!(q$g.now()-q$a>q$J.loopTimeLimit));)q$R--}},q$J.loopTimeLimit=2,q$J._cacheList=[],q$J._index=0,q$J}(),q$U=function(){function q$G(){}return q$H(q$G,"laya.utils.ClassUtils"),q$G.regClass=function(q$S,q$_){q$G._classMap[q$S]=q$_},q$G.getRegClass=function(q$S){return q$G._classMap[q$S]},q$G.getInstance=function(q$S){var q$_=q$G.getClass(q$S);return q$_?new q$_:(console.warn("[error] Undefined class:",q$S),null)},q$G.createByJson=function(q$S,q$_,q$a,q$R,q$J){"string"==typeof q$S&&(q$S=JSON.parse(q$S));var q$V=q$S.props;if(!q$_&&!(q$_=q$J?q$J.runWith(q$S):q$G.getInstance(q$V.runtime||q$S.type)))return null;var q$W=q$S.child;if(q$W)for(var q$k=0,q$z=q$W.length;q$k<q$z;q$k++){var q$b=q$W[q$k];if("render"!==q$b.props.name&&"render"!==q$b.props.renderType||!q$_._$set_itemRender)if("Graphic"==q$b.type)q$G.addGraphicsToSprite(q$b,q$_);else if(q$G.isDrawType(q$b.type))q$G.addGraphicToSprite(q$b,q$_,!0);else{var q$H=q$G.createByJson(q$b,null,q$a,q$R,q$J);"Script"==q$b.type?q$H.hasOwnProperty("owner")?q$H.owner=q$_:q$H.hasOwnProperty("target")&&(q$H.target=q$_):"mask"==q$b.props.renderType?q$_.mask=q$H:q$_.addChild(q$H)}else q$_.itemRender=q$b}if(q$V)for(var q$L in q$V){var q$C=q$V[q$L];"var"===q$L&&q$a?q$a[q$C]=q$_:q$C instanceof Array&&"function"==typeof q$_[q$L]?q$_[q$L].apply(q$_,q$C):q$_[q$L]=q$C}return q$R&&q$S.customProps&&q$R.runWith([q$_,q$S]),q$_.created&&q$_.created(),q$_},q$G.addGraphicsToSprite=function(q$S,q$_){var q$a;if((q$a=q$S.child)&&!(q$a.length<1)){var q$R;q$R=q$G._getGraphicsFromSprite(q$S,q$_);var q$J=0,q$V=0;q$S.props&&(q$J=q$G._getObjVar(q$S.props,"x",0),q$V=q$G._getObjVar(q$S.props,"y",0)),0!=q$J&&0!=q$V&&q$R.translate(q$J,q$V);var q$W,q$k=0;for(q$W=q$a.length,q$k=0;q$k<q$W;q$k++)q$G._addGraphicToGraphics(q$a[q$k],q$R);0!=q$J&&0!=q$V&&q$R.translate(-q$J,-q$V)}},q$G.addGraphicToSprite=function(q$S,q$_,q$a){var q$R;void 0===q$a&&(q$a=!1),q$R=q$a?q$G._getGraphicsFromSprite(q$S,q$_):q$_.graphics,q$G._addGraphicToGraphics(q$S,q$R)},q$G._getGraphicsFromSprite=function(q$S,q$_){var q$a,q$R;if(!q$S||!q$S.props)return q$_.graphics;switch(q$R=q$S.props.renderType){case"hit":case"unHit":var q$J;q$_.hitArea||(q$_.hitArea=new q$Z),(q$J=q$_.hitArea)[q$R]||(q$J[q$R]=new q$C),q$a=q$J[q$R]}return q$a||(q$a=q$_.graphics),q$a},q$G._getTransformData=function(q$S){var q$_;(q$S.hasOwnProperty("pivotX")||q$S.hasOwnProperty("pivotY"))&&(q$_=q$_||new q$X).translate(-q$G._getObjVar(q$S,"pivotX",0),-q$G._getObjVar(q$S,"pivotY",0));var q$a=q$G._getObjVar(q$S,"scaleX",1),q$R=q$G._getObjVar(q$S,"scaleY",1),q$J=q$G._getObjVar(q$S,"rotation",0);q$G._getObjVar(q$S,"skewX",0),q$G._getObjVar(q$S,"skewY",0);return 1==q$a&&1==q$R&&0==q$J||((q$_=q$_||new q$X).scale(q$a,q$R),q$_.rotate(.0174532922222222*q$J)),q$_},q$G._addGraphicToGraphics=function(q$S,q$_){var q$a,q$R;if((q$a=q$S.props)&&(q$R=q$G.DrawTypeDic[q$S.type])){var q$J,q$V;q$J=q$_;var q$W=q$G._getParams(q$a,q$R[1],q$R[2],q$R[3]);((q$V=q$G._tM)||1!=q$G._alpha)&&(q$J.save(),q$V&&q$J.transform(q$V),1!=q$G._alpha&&q$J.alpha(q$G._alpha)),q$J[q$R[0]].apply(q$J,q$W),(q$V||1!=q$G._alpha)&&q$J.restore()}},q$G._adptLineData=function(q$S){return q$S[2]=parseFloat(q$S[0])+parseFloat(q$S[2]),q$S[3]=parseFloat(q$S[1])+parseFloat(q$S[3]),q$S},q$G._adptTextureData=function(q$S){return q$S[0]=q$kS.getRes(q$S[0]),q$S},q$G._adptLinesData=function(q$S){return q$S[2]=q$G._getPointListByStr(q$S[2]),q$S},q$G.isDrawType=function(q$S){return"Image"!=q$S&&q$G.DrawTypeDic.hasOwnProperty(q$S)},q$G._getParams=function(q$S,q$_,q$a,q$R){var q$J;void 0===q$a&&(q$a=0),(q$J=q$G._temParam).length=q$_.length;var q$V,q$W,q$k=0;for(q$V=q$_.length,q$k=0;q$k<q$V;q$k++)q$J[q$k]=q$G._getObjVar(q$S,q$_[q$k][0],q$_[q$k][1]);return q$G._alpha=q$G._getObjVar(q$S,"alpha",1),q$W=q$G._getTransformData(q$S),q$G._tM=q$W?(q$a||(q$a=0),q$W.translate(q$J[q$a],q$J[q$a+1]),q$J[q$a]=q$J[q$a+1]=0,q$W):null,q$R&&q$G[q$R]&&(q$J=q$G[q$R](q$J)),q$J},q$G._getPointListByStr=function(q$S){var q$_,q$a,q$R=0;for(q$a=(q$_=q$S.split(",")).length,q$R=0;q$R<q$a;q$R++)q$_[q$R]=parseFloat(q$_[q$R]);return q$_},q$G._getObjVar=function(q$S,q$_,q$a){return q$S.hasOwnProperty(q$_)?q$S[q$_]:q$a},q$G._temParam=[],q$G._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},q$G.getClass=function(q$S){var q$_=q$G._classMap[q$S]||q$S;return"string"==typeof q$_?q$q.__classmap[q$_]:q$_},q$G._tM=null,q$G._alpha=NaN,q$z(q$G,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),q$G}(),q$f=function(){function q$V(q$S){if(this._color=[],"string"==typeof q$S){null===(this.strColor=q$S)&&(q$S="#000000"),"#"==q$S.charAt(0)&&(q$S=q$S.substr(1));var q$_=q$S.length;if(3==q$_||4==q$_){for(var q$a="",q$R=0;q$R<q$_;q$R++)q$a+=q$S[q$R]+q$S[q$R];q$S=q$a}var q$J=this.numColor=parseInt(q$S,16);if(8==q$S.length)return void(this._color=[parseInt(q$S.substr(0,2),16)/255,((16711680&q$J)>>16)/255,((65280&q$J)>>8)/255,(255&q$J)/255])}else q$J=this.numColor=q$S,this.strColor=q$O.toHexColor(q$J);this._color=[((16711680&q$J)>>16)/255,((65280&q$J)>>8)/255,(255&q$J)/255,1],this._color.__id=++q$V._COLODID}return q$H(q$V,"laya.utils.Color"),q$V._initDefault=function(){for(var q$S in q$V._DEFAULT={},q$V._COLOR_MAP)q$V._SAVE[q$S]=q$V._DEFAULT[q$S]=new q$V(q$V._COLOR_MAP[q$S]);return q$V._DEFAULT},q$V._initSaveMap=function(){for(var q$S in q$V._SAVE_SIZE=0,q$V._SAVE={},q$V._DEFAULT)q$V._SAVE[q$S]=q$V._DEFAULT[q$S]},q$V.create=function(q$S){var q$_=q$V._SAVE[q$S+""];return null!=q$_?q$_:(q$V._SAVE_SIZE<1e3||q$V._initSaveMap(),q$V._SAVE[q$S+""]=new q$V(q$S))},q$V._SAVE={},q$V._SAVE_SIZE=0,q$V._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},q$V._DEFAULT=q$V._initDefault(),q$V._COLODID=1,q$V}(),q$Y=(function(){function q$S(){this._values=[],this._keys=[]}q$H(q$S,"laya.utils.Dictionary");var q$_=q$S.prototype;q$_.set=function(q$S,q$_){var q$a=this.indexOf(q$S);0<=q$a?this._values[q$a]=q$_:(this._keys.push(q$S),this._values.push(q$_))},q$_.indexOf=function(q$S){var q$_=this._keys.indexOf(q$S);return 0<=q$_?q$_:(q$S="string"==typeof q$S?Number(q$S):"number"==typeof q$S?q$S.toString():q$S,this._keys.indexOf(q$S))},q$_.get=function(q$S){var q$_=this.indexOf(q$S);return q$_<0?null:this._values[q$_]},q$_.remove=function(q$S){var q$_=this.indexOf(q$S);return 0<=q$_&&(this._keys.splice(q$_,1),this._values.splice(q$_,1),!0)},q$_.clear=function(){this._values.length=0,this._keys.length=0},q$t(0,q$_,"values",function(){return this._values}),q$t(0,q$_,"keys",function(){return this._keys})}(),function(){function q$S(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}q$H(q$S,"laya.utils.Dragging");var q$_=q$S.prototype;return q$_.start=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){void 0===q$k&&(q$k=.92),this.clearTimer(),this.target=q$S,this.area=q$_,this.hasInertia=q$a,this.elasticDistance=q$_?q$R:0,this.elasticBackTime=q$J,this.data=q$V,this._disableMouseEvent=q$W,this.ratio=q$k,1!=q$S.globalScaleX||1!=q$S.globalScaleY?this._parent=q$S.parent:this._parent=q$q.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,q$q.stage.on("mouseup",this,this.onStageMouseUp),q$q.stage.on("mouseout",this,this.onStageMouseUp),q$q.timer.frameLoop(1,this,this.loop)},q$_.clearTimer=function(){q$q.timer.clear(this,this.loop),q$q.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},q$_.stop=function(){this._dragging&&(q$o.instance.disableMouseEvent=!1,q$q.stage.off("mouseup",this,this.onStageMouseUp),q$q.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},q$_.loop=function(){var q$S=this._parent.getMousePoint(),q$_=q$S.x,q$a=q$S.y,q$R=q$_-this._lastX,q$J=q$a-this._lastY;if(this._clickOnly){if(!(1<Math.abs(q$R*q$q.stage._canvasTransform.getScaleX())||1<Math.abs(q$J*q$q.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),q$o.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(q$R,q$J);0==q$R&&0==q$J||(this._lastX=q$_,this._lastY=q$a,this.target.x+=q$R*this._elasticRateX,this.target.y+=q$J*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},q$_.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var q$S=this.area.x-this.target.x;else q$S=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-q$S/this.elasticDistance),this.target.y<this.area.y)var q$_=this.area.y-this.target.y;else q$_=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-q$_/this.elasticDistance)}},q$_.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},q$_.onStageMouseUp=function(q$S){if(q$o.instance.disableMouseEvent=!1,q$q.stage.off("mouseup",this,this.onStageMouseUp),q$q.stage.off("mouseout",this,this.onStageMouseUp),q$q.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var q$_=this._offsets.length,q$a=Math.min(q$_,6),q$R=this._offsets.length-q$a,q$J=q$_-1;q$R<q$J;q$J--)this._offsetY+=this._offsets[q$J--],this._offsetX+=this._offsets[q$J];this._offsetX=this._offsetX/q$a*2,this._offsetY=this._offsetY/q$a*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),q$q.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},q$_.checkElastic=function(){var q$S=NaN,q$_=NaN;if(this.target.x<this.area.x?q$S=this.area.x:this.target.x>this.area.x+this.area.width&&(q$S=this.area.x+this.area.width),this.target.y<this.area.y?q$_=this.area.y:this.target.y>this.area.y+this.area.height&&(q$_=this.area.y+this.area.height),isNaN(q$S)&&isNaN(q$_))this.clear();else{var q$a={};isNaN(q$S)||(q$a.x=q$S),isNaN(q$_)||(q$a.y=q$_),this._tween=q$E.to(this.target,q$a,this.elasticBackTime,q$i.sineOut,q$T.create(this,this.clear),0,!1,!1)}},q$_.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(q$q.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},q$_.clear=function(){if(this.target){this.clearTimer();var q$S=this.target;this.target=null,this._parent=null,q$S.event("dragend",this.data)}},q$S}()),q$i=function(){function q$k(){}return q$H(q$k,"laya.utils.Ease"),q$k.linearNone=function(q$S,q$_,q$a,q$R){return q$a*q$S/q$R+q$_},q$k.linearIn=function(q$S,q$_,q$a,q$R){return q$a*q$S/q$R+q$_},q$k.linearInOut=function(q$S,q$_,q$a,q$R){return q$a*q$S/q$R+q$_},q$k.linearOut=function(q$S,q$_,q$a,q$R){return q$a*q$S/q$R+q$_},q$k.bounceIn=function(q$S,q$_,q$a,q$R){return q$a-q$k.bounceOut(q$R-q$S,0,q$a,q$R)+q$_},q$k.bounceInOut=function(q$S,q$_,q$a,q$R){return q$S<.5*q$R?.5*q$k.bounceIn(2*q$S,0,q$a,q$R)+q$_:.5*q$k.bounceOut(2*q$S-q$R,0,q$a,q$R)+.5*q$a+q$_},q$k.bounceOut=function(q$S,q$_,q$a,q$R){return(q$S/=q$R)<1/2.75?q$a*(7.5625*q$S*q$S)+q$_:q$S<2/2.75?q$a*(7.5625*(q$S-=1.5/2.75)*q$S+.75)+q$_:q$S<2.5/2.75?q$a*(7.5625*(q$S-=2.25/2.75)*q$S+.9375)+q$_:q$a*(7.5625*(q$S-=2.625/2.75)*q$S+.984375)+q$_},q$k.backIn=function(q$S,q$_,q$a,q$R,q$J){return void 0===q$J&&(q$J=1.70158),q$a*(q$S/=q$R)*q$S*((q$J+1)*q$S-q$J)+q$_},q$k.backInOut=function(q$S,q$_,q$a,q$R,q$J){return void 0===q$J&&(q$J=1.70158),(q$S/=.5*q$R)<1?.5*q$a*(q$S*q$S*((1+(q$J*=1.525))*q$S-q$J))+q$_:q$a/2*((q$S-=2)*q$S*((1+(q$J*=1.525))*q$S+q$J)+2)+q$_},q$k.backOut=function(q$S,q$_,q$a,q$R,q$J){return void 0===q$J&&(q$J=1.70158),q$a*((q$S=q$S/q$R-1)*q$S*((q$J+1)*q$S+q$J)+1)+q$_},q$k.elasticIn=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W;return void 0===q$J&&(q$J=0),void 0===q$V&&(q$V=0),0==q$S?q$_:1==(q$S/=q$R)?q$_+q$a:(q$V||(q$V=.3*q$R),q$W=!q$J||0<q$a&&q$J<q$a||q$a<0&&q$J<-q$a?(q$J=q$a,q$V/4):q$V/q$k.PI2*Math.asin(q$a/q$J),-q$J*Math.pow(2,10*(q$S-=1))*Math.sin((q$S*q$R-q$W)*q$k.PI2/q$V)+q$_)},q$k.elasticInOut=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W;return void 0===q$J&&(q$J=0),void 0===q$V&&(q$V=0),0==q$S?q$_:2==(q$S/=.5*q$R)?q$_+q$a:(q$V||(q$V=q$R*(.3*1.5)),q$W=!q$J||0<q$a&&q$J<q$a||q$a<0&&q$J<-q$a?(q$J=q$a,q$V/4):q$V/q$k.PI2*Math.asin(q$a/q$J),q$S<1?q$J*Math.pow(2,10*(q$S-=1))*Math.sin((q$S*q$R-q$W)*q$k.PI2/q$V)*-.5+q$_:q$J*Math.pow(2,-10*(q$S-=1))*Math.sin((q$S*q$R-q$W)*q$k.PI2/q$V)*.5+q$a+q$_)},q$k.elasticOut=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W;return void 0===q$J&&(q$J=0),void 0===q$V&&(q$V=0),0==q$S?q$_:1==(q$S/=q$R)?q$_+q$a:(q$V||(q$V=.3*q$R),q$W=!q$J||0<q$a&&q$J<q$a||q$a<0&&q$J<-q$a?(q$J=q$a,q$V/4):q$V/q$k.PI2*Math.asin(q$a/q$J),q$J*Math.pow(2,-10*q$S)*Math.sin((q$S*q$R-q$W)*q$k.PI2/q$V)+q$a+q$_)},q$k.strongIn=function(q$S,q$_,q$a,q$R){return q$a*(q$S/=q$R)*q$S*q$S*q$S*q$S+q$_},q$k.strongInOut=function(q$S,q$_,q$a,q$R){return(q$S/=.5*q$R)<1?.5*q$a*q$S*q$S*q$S*q$S*q$S+q$_:.5*q$a*((q$S-=2)*q$S*q$S*q$S*q$S+2)+q$_},q$k.strongOut=function(q$S,q$_,q$a,q$R){return q$a*((q$S=q$S/q$R-1)*q$S*q$S*q$S*q$S+1)+q$_},q$k.sineInOut=function(q$S,q$_,q$a,q$R){return.5*-q$a*(Math.cos(Math.PI*q$S/q$R)-1)+q$_},q$k.sineIn=function(q$S,q$_,q$a,q$R){return-q$a*Math.cos(q$S/q$R*q$k.HALF_PI)+q$a+q$_},q$k.sineOut=function(q$S,q$_,q$a,q$R){return q$a*Math.sin(q$S/q$R*q$k.HALF_PI)+q$_},q$k.quintIn=function(q$S,q$_,q$a,q$R){return q$a*(q$S/=q$R)*q$S*q$S*q$S*q$S+q$_},q$k.quintInOut=function(q$S,q$_,q$a,q$R){return(q$S/=.5*q$R)<1?.5*q$a*q$S*q$S*q$S*q$S*q$S+q$_:.5*q$a*((q$S-=2)*q$S*q$S*q$S*q$S+2)+q$_},q$k.quintOut=function(q$S,q$_,q$a,q$R){return q$a*((q$S=q$S/q$R-1)*q$S*q$S*q$S*q$S+1)+q$_},q$k.quartIn=function(q$S,q$_,q$a,q$R){return q$a*(q$S/=q$R)*q$S*q$S*q$S+q$_},q$k.quartInOut=function(q$S,q$_,q$a,q$R){return(q$S/=.5*q$R)<1?.5*q$a*q$S*q$S*q$S*q$S+q$_:.5*-q$a*((q$S-=2)*q$S*q$S*q$S-2)+q$_},q$k.quartOut=function(q$S,q$_,q$a,q$R){return-q$a*((q$S=q$S/q$R-1)*q$S*q$S*q$S-1)+q$_},q$k.cubicIn=function(q$S,q$_,q$a,q$R){return q$a*(q$S/=q$R)*q$S*q$S+q$_},q$k.cubicInOut=function(q$S,q$_,q$a,q$R){return(q$S/=.5*q$R)<1?.5*q$a*q$S*q$S*q$S+q$_:.5*q$a*((q$S-=2)*q$S*q$S+2)+q$_},q$k.cubicOut=function(q$S,q$_,q$a,q$R){return q$a*((q$S=q$S/q$R-1)*q$S*q$S+1)+q$_},q$k.quadIn=function(q$S,q$_,q$a,q$R){return q$a*(q$S/=q$R)*q$S+q$_},q$k.quadInOut=function(q$S,q$_,q$a,q$R){return(q$S/=.5*q$R)<1?.5*q$a*q$S*q$S+q$_:.5*-q$a*(--q$S*(q$S-2)-1)+q$_},q$k.quadOut=function(q$S,q$_,q$a,q$R){return-q$a*(q$S/=q$R)*(q$S-2)+q$_},q$k.expoIn=function(q$S,q$_,q$a,q$R){return 0==q$S?q$_:q$a*Math.pow(2,10*(q$S/q$R-1))+q$_-.001*q$a},q$k.expoInOut=function(q$S,q$_,q$a,q$R){return 0==q$S?q$_:q$S==q$R?q$_+q$a:(q$S/=.5*q$R)<1?.5*q$a*Math.pow(2,10*(q$S-1))+q$_:.5*q$a*(2-Math.pow(2,-10*--q$S))+q$_},q$k.expoOut=function(q$S,q$_,q$a,q$R){return q$S==q$R?q$_+q$a:q$a*(1-Math.pow(2,-10*q$S/q$R))+q$_},q$k.circIn=function(q$S,q$_,q$a,q$R){return-q$a*(Math.sqrt(1-(q$S/=q$R)*q$S)-1)+q$_},q$k.circInOut=function(q$S,q$_,q$a,q$R){return(q$S/=.5*q$R)<1?.5*-q$a*(Math.sqrt(1-q$S*q$S)-1)+q$_:.5*q$a*(Math.sqrt(1-(q$S-=2)*q$S)+1)+q$_},q$k.circOut=function(q$S,q$_,q$a,q$R){return q$a*Math.sqrt(1-(q$S=q$S/q$R-1)*q$S)+q$_},q$k.HALF_PI=.5*Math.PI,q$k.PI2=2*Math.PI,q$k}(),q$Z=function(){function q$L(){this._hit=null,this._unHit=null}q$H(q$L,"laya.utils.HitArea");var q$S=q$L.prototype;return q$S.isHit=function(q$S,q$_){return!!q$L.isHitGraphic(q$S,q$_,this.hit)&&!q$L.isHitGraphic(q$S,q$_,this.unHit)},q$S.contains=function(q$S,q$_){return this.isHit(q$S,q$_)},q$t(0,q$S,"hit",function(){return this._hit||(this._hit=new q$C),this._hit},function(q$S){this._hit=q$S}),q$t(0,q$S,"unHit",function(){return this._unHit||(this._unHit=new q$C),this._unHit},function(q$S){this._unHit=q$S}),q$L.isHitGraphic=function(q$S,q$_,q$a){if(!q$a)return!1;var q$R;if(!(q$R=q$a.cmds)&&q$a._one&&((q$R=q$L._cmds).length=1,q$R[0]=q$a._one),!q$R)return!1;var q$J,q$V,q$W=0;for(q$J=q$R.length,q$W=0;q$W<q$J;q$W++)if(q$V=q$R[q$W]){var q$k=q$K._context;switch(q$V.callee){case q$k._translate:case 6:q$S-=q$V[0],q$_-=q$V[1]}if(q$L.isHitCmd(q$S,q$_,q$V))return!0}return!1},q$L.isHitCmd=function(q$S,q$_,q$a){if(!q$a)return!1;var q$R=q$K._context,q$J=!1;switch(q$a.callee){case q$R._drawRect:case 13:q$L._rec.setTo(q$a[0],q$a[1],q$a[2],q$a[3]),q$J=q$L._rec.contains(q$S,q$_);break;case q$R._drawCircle:case q$R._fillCircle:case 14:q$J=(q$S-=q$a[0])*q$S+(q$_-=q$a[1])*q$_<q$a[2]*q$a[2];break;case q$R._drawPoly:case 18:q$S-=q$a[0],q$_-=q$a[1],q$J=q$L.ptInPolygon(q$S,q$_,q$a[2])}return q$J},q$L.ptInPolygon=function(q$S,q$_,q$a){var q$R;(q$R=q$L._ptPoint).setTo(q$S,q$_);var q$J,q$V=0,q$W=NaN,q$k=NaN,q$z=NaN,q$b=NaN;q$J=q$a.length;for(var q$H=0;q$H<q$J;q$H+=2){if(q$W=q$a[q$H],q$k=q$a[q$H+1],q$z=q$a[(q$H+2)%q$J],q$k!=(q$b=q$a[(q$H+3)%q$J]))if(!(q$R.y<Math.min(q$k,q$b)))if(!(q$R.y>=Math.max(q$k,q$b)))(q$R.y-q$k)*(q$z-q$W)/(q$b-q$k)+q$W>q$R.x&&q$V++}return q$V%2==1},q$L._cmds=[],q$z(q$L,["_rec",function(){return this._rec=new q$n},"_ptPoint",function(){return this._ptPoint=new q$N}]),q$L}(),q$p=(function(){function q$J(q$S,q$_,q$a,q$R){this.char=q$S,this.charNum=q$S.charCodeAt(0),this._x=this._y=0,this.width=q$_,this.height=q$a,this.style=q$R,this.isWord=!q$J._isWordRegExp.test(q$S)}q$H(q$J,"laya.utils.HTMLChar");var q$S=q$J.prototype;q$q.imps(q$S,{"laya.display.ILayout":!0}),q$S.setSprite=function(q$S){this._sprite=q$S},q$S.getSprite=function(){return this._sprite},q$S._isChar=function(){return!0},q$S._getCSSStyle=function(){return this.style},q$t(0,q$S,"width",function(){return this._w},function(q$S){this._w=q$S}),q$t(0,q$S,"x",function(){return this._x},function(q$S){this._sprite&&(this._sprite.x=q$S),this._x=q$S}),q$t(0,q$S,"y",function(){return this._y},function(q$S){this._sprite&&(this._sprite.y=q$S),this._y=q$S}),q$t(0,q$S,"height",function(){return this._h},function(q$S){this._h=q$S}),q$J._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function q$_(){}q$H(q$_,"laya.utils.Log"),q$_.enable=function(){q$_._logdiv||(q$_._logdiv=q$g.window.document.createElement("div"),q$g.window.document.body.appendChild(q$_._logdiv),q$_._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},q$_.toggle=function(){var q$S=q$_._logdiv.style;"1px"==q$S.width?q$S.width=q$S.height="50%":q$S.width=q$S.height="1px"},q$_.print=function(q$S){q$_._logdiv&&(q$_.maxCount<=q$_._count&&q$_.clear(),q$_._count++,q$_._logdiv.innerText+=q$S+"\n",q$_._logdiv.scrollTop=q$_._logdiv.scrollHeight)},q$_.clear=function(){q$_._logdiv.innerText="",q$_._count=0},q$_._logdiv=null,q$_._count=0,q$_.maxCount=20}(),function(){function q$_(){}q$H(q$_,"laya.utils.Mouse"),q$t(1,q$_,"cursor",function(){return q$_._style.cursor},function(q$S){q$_._style.cursor=q$S}),q$_.hide=function(){"none"!=q$_.cursor&&(q$_._preCursor=q$_.cursor,q$_.cursor="none")},q$_.show=function(){"none"==q$_.cursor&&(q$_.cursor=q$_._preCursor?q$_._preCursor:"auto")},q$_._preCursor=null,q$z(q$_,["_style",function(){return this._style=q$g.document.body.style}])}(),function(){function q$V(){}return q$H(q$V,"laya.utils.Pool"),q$V.getPoolBySign=function(q$S){return q$V._poolDic[q$S]||(q$V._poolDic[q$S]=[])},q$V.clearBySign=function(q$S){q$V._poolDic[q$S]&&(q$V._poolDic[q$S].length=0)},q$V.recover=function(q$S,q$_){q$_.__InPool||(q$_.__InPool=!0,q$V.getPoolBySign(q$S).push(q$_))},q$V.getItemByClass=function(q$S,q$_){var q$a=q$V.getPoolBySign(q$S),q$R=q$a.length?q$a.pop():new q$_;return q$R.__InPool=!1,q$R},q$V.getItemByCreateFun=function(q$S,q$_,q$a){var q$R=q$V.getPoolBySign(q$S),q$J=q$R.length?q$R.pop():q$_.call(q$a);return q$J.__InPool=!1,q$J},q$V.getItem=function(q$S){var q$_=q$V.getPoolBySign(q$S),q$a=q$_.length?q$_.pop():null;return q$a&&(q$a.__InPool=!1),q$a},q$V._poolDic={},q$V.InPoolSign="__InPool",q$V}()),q$c=function(){function q$z(){}return q$H(q$z,"laya.utils.Stat"),q$t(1,q$z,"onclick",null,function(q$S){q$z._sp&&q$z._sp.on("click",q$z._sp,q$S),q$z._canvas&&(q$z._canvas.source.onclick=q$S,q$z._canvas.source.style.pointerEvents="")}),q$z.show=function(q$S,q$_,q$a){if(void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),!q$K.isConchApp||q$K.isConchWebGL){if(q$K.isConchWebGL||q$g.onMiniGame||q$g.onLimixiu||(q$z._useCanvas=!0),q$z._show=!0,q$z._fpsData.length=60,q$z._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},q$z._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},q$z._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},q$z._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},q$K.isWebGL)if(q$z._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},q$K.is3DMode){if(q$z._view[0].title="FPS(3D)",q$z._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},q$z._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},q$z._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==q$a){var q$R=8;q$z._view[q$R++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},q$z._view[q$R++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},q$z._view[q$R++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},q$z._view[q$R++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},q$z._view[q$R++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},q$z._view[q$R++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},q$z._view[q$R++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},q$z._view[q$R++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},q$z._view[q$R++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==q$a){q$R=8;q$z._view[q$R++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},q$z._view[q$R++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},q$z._view[q$R++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},q$z._view[q$R++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},q$z._view[q$R++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},q$z._view[q$R++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},q$z._view[q$R++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else q$z._view[0].title="FPS(WebGL)",q$z._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else q$z._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};q$z._useCanvas?q$z.createUIPre(q$S,q$_):q$z.createUI(q$S,q$_),q$z.enable()}else q$g.window.conch.showFPS&&q$g.window.conch.showFPS(q$S,q$_)},q$z.createUIPre=function(q$S,q$_){var q$a=q$g.pixelRatio;q$z._width=170*q$a,q$z._vx=75*q$a,q$z._height=q$a*(12*q$z._view.length+3*q$a)+4,q$z._fontSize=12*q$a;for(var q$R=0;q$R<q$z._view.length;q$R++)q$z._view[q$R].x=4,q$z._view[q$R].y=q$R*q$z._fontSize+2*q$a;q$z._canvas||((q$z._canvas=new q$DS("2D")).size(q$z._width,q$z._height),(q$z._ctx=q$z._canvas.getContext("2d")).textBaseline="top",q$z._ctx.font=q$z._fontSize+"px Sans-serif",q$z._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+q$S+"px;top:"+q$_+"px;width:"+q$z._width/q$a+"px;height:"+q$z._height/q$a+"px;"),q$z._first=!0,q$z.loop(),q$z._first=!1,q$g.container.appendChild(q$z._canvas.source)},q$z.createUI=function(q$S,q$_){var q$a=q$z._sp,q$R=q$g.pixelRatio;q$a||(q$a=new q$LS,(q$z._leftText=new q$$S).pos(5,5),q$z._leftText.color="#ffffff",q$a.addChild(q$z._leftText),(q$z._txt=new q$$S).pos(80*q$R,5),q$z._txt.color="#ffffff",q$a.addChild(q$z._txt),q$z._sp=q$a),q$a.pos(q$S,q$_);for(var q$J="",q$V=0;q$V<q$z._view.length;q$V++){q$J+=q$z._view[q$V].title+"\n"}q$z._leftText.text=q$J;var q$W=170*q$R,q$k=q$R*(12*q$z._view.length+3*q$R)+4;q$z._txt.fontSize=q$z._fontSize*q$R,q$z._leftText.fontSize=q$z._fontSize*q$R,q$a.size(q$W,q$k),q$a.graphics.clear(),q$a.graphics.setAlpha(.5),q$a.graphics.drawRect(0,0,q$W,q$k,"#999999"),q$a.graphics.setAlpha(1),q$z.loop()},q$z.enable=function(){q$q.timer.frameLoop(1,q$z,q$z.loop)},q$z.hide=function(){q$z._show=!1,q$q.timer.clear(q$z,q$z.loop),q$z._canvas&&q$g.removeElement(q$z._canvas.source)},q$z.clear=function(){q$z.trianglesFaces=q$z.drawCall=q$z.shaderCall=q$z.spriteCount=q$z.spriteRenderUseCacheCount=q$z.treeNodeCollision=q$z.treeSpriteCollision=q$z.canvasNormal=q$z.canvasBitmap=q$z.canvasReCache=0},q$z.loop=function(){q$z._count++;var q$S=q$g.now();if(!(q$S-q$z._timer<1e3)){var q$_=q$z._count;if(q$z.FPS=Math.round(1e3*q$_/(q$S-q$z._timer)),q$z._show){q$z.trianglesFaces=Math.round(q$z.trianglesFaces/q$_),q$z.spriteCount=q$z._useCanvas?(q$z.drawCall=Math.round(q$z.drawCall/q$_)-2,q$z.shaderCall=Math.round(q$z.shaderCall/q$_),Math.round(q$z.spriteCount/q$_)-1):(q$z.drawCall=Math.round(q$z.drawCall/q$_)-2,q$z.shaderCall=Math.round(q$z.shaderCall/q$_)-4,Math.round(q$z.spriteCount/q$_)-4),q$z.spriteRenderUseCacheCount=Math.round(q$z.spriteRenderUseCacheCount/q$_),q$z.canvasNormal=Math.round(q$z.canvasNormal/q$_),q$z.canvasBitmap=Math.round(q$z.canvasBitmap/q$_),q$z.canvasReCache=Math.ceil(q$z.canvasReCache/q$_),q$z.treeNodeCollision=Math.round(q$z.treeNodeCollision/q$_),q$z.treeSpriteCollision=Math.round(q$z.treeSpriteCollision/q$_);var q$a=0<q$z.FPS?Math.floor(1e3/q$z.FPS).toString():" ";q$z._fpsStr=q$z.FPS+(q$z.renderSlow?" slow":"")+" "+q$a,q$z._spriteStr=q$z.spriteCount+(q$z.spriteRenderUseCacheCount?"/"+q$z.spriteRenderUseCacheCount:""),q$z._canvasStr=q$z.canvasReCache+"/"+q$z.canvasNormal+"/"+q$z.canvasBitmap,q$z.currentMemorySize=q$e.systemResourceManager.memorySize,q$z._useCanvas?q$z.renderInfoPre():q$z.renderInfo(),q$z.clear()}q$z._count=0,q$z._timer=q$S}},q$z.renderInfoPre=function(){if(q$z._canvas){var q$S=q$z._ctx;q$S.clearRect(q$z._first?0:q$z._vx,0,q$z._width,q$z._height);for(var q$_=q$K.WebGL.mainContext,q$a=0;q$a<q$z._view.length;q$a++){var q$R=q$z._view[q$a];q$z._first&&(q$S.fillStyle="white",q$S.fillText(q$R.title,q$R.x,q$R.y,null,null,null)),q$S.fillStyle=q$R.color;var q$J=-1;if((q$R=q$z._view[q$a]).varying){if(q$_)switch(q$R.varying){case 1:q$J=q$_.getParameter(q$_[q$R.value]);break;case 2:q$J=q$_.getExtension(q$R.value)}}else q$J=q$z[q$R.value];"M"==q$R.units&&(q$J=Math.floor(q$J/1048576*100)/100+" M"),"K"==q$R.units&&(q$J=Math.floor(q$J/1024*100)/100+" K"),"string"==q$R.units&&(q$J=q$J.match(/\d+\.?\d/i)),q$S.fillText(q$J+"",q$R.x+q$z._vx,q$R.y,null,null,null)}}},q$z.renderInfo=function(){for(var q$S="",q$_=q$K.WebGL.mainContext,q$a=0;q$a<q$z._view.length;q$a++){var q$R=q$z._view[q$a],q$J=-1;if(q$R.varying){if(q$_)switch(q$R.varying){case 1:q$J=q$_.getParameter(q$_[q$R.value]);break;case 2:q$J=q$_.getExtension(q$R.value)}}else q$J=q$z[q$R.value];"M"==q$R.units&&(q$J=Math.floor(q$J/1048576*100)/100+" M"),"K"==q$R.units&&(q$J=Math.floor(q$J/1024*100)/100+" K"),"string"==q$R.units&&(q$J=q$J.match(/\d+\.?\d/i)),q$S+=q$J+"\n"}q$z._txt.text=q$S},q$z.FPS=0,q$z.loopCount=0,q$z.shaderCall=0,q$z.drawCall=0,q$z.trianglesFaces=0,q$z.spriteCount=0,q$z.spriteRenderUseCacheCount=0,q$z.treeNodeCollision=0,q$z.treeSpriteCollision=0,q$z.canvasNormal=0,q$z.canvasBitmap=0,q$z.canvasReCache=0,q$z.renderSlow=!1,q$z.currentMemorySize=0,q$z._fpsStr=null,q$z._canvasStr=null,q$z._spriteStr=null,q$z._fpsData=[],q$z._timer=0,q$z._count=0,q$z._view=[],q$z._fontSize=12,q$z._txt=null,q$z._leftText=null,q$z._sp=null,q$z._show=!1,q$z._useCanvas=!1,q$z._canvas=null,q$z._ctx=null,q$z._first=!1,q$z._vx=NaN,q$z._width=0,q$z._height=100,q$z}(),q$y=(function(){function q$S(){this._strsToID={},this._idToStrs=[],this._length=0}q$H(q$S,"laya.utils.StringKey");var q$_=q$S.prototype;q$_.add=function(q$S){var q$_=this._strsToID[q$S];return null!=q$_?q$_:(this._idToStrs[this._length]=q$S,this._strsToID[q$S]=this._length++)},q$_.getID=function(q$S){var q$_=this._strsToID[q$S];return null==q$_?-1:q$_},q$_.getName=function(q$S){var q$_=this._idToStrs[q$S];return null==q$_?void 0:q$_}}(),function(){var q$b;function q$S(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}q$H(q$S,"laya.utils.Timer");var q$_=q$S.prototype;return q$_._init=function(){q$q.timer&&q$q.timer.frameLoop(1,this,this._update)},q$_._now=function(){return Date.now()},q$_._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var q$S=this.currFrame=this.currFrame+this.scale,q$_=this._now();this._delta=(q$_-this._lastTimer)*this.scale;var q$a=this.currTimer=this.currTimer+this._delta;q$q.isDebug&&6e4<Math.abs(q$_-this._lastTimer)&&console.error("系统时间错误！"+(q$_-this._lastTimer)),this._lastTimer=q$_;var q$R=this._handlers;for(q$W=this._count=0,q$k=q$R.length;q$W<q$k;q$W++)if(null!==(q$z=q$R[q$W]).method){var q$J=q$z.userFrame?q$S:q$a;if(q$J>=q$z.exeTime)if(q$z.repeat)if(q$z.jumpFrame)for(;q$J>=q$z.exeTime;)q$z.exeTime+=q$z.delay,q$z.run(!1);else q$z.exeTime+=q$z.delay,q$z.run(!1),q$J>q$z.exeTime&&(q$z.exeTime+=Math.ceil((q$J-q$z.exeTime)/q$z.delay)*q$z.delay);else q$z.run(!0)}else this._count++;(30<this._count||q$S%200==0)&&this._clearHandlers();for(var q$V=this._laters,q$W=0,q$k=q$V.length-1;q$W<=q$k;q$W++){var q$z=q$V[q$W];this._isIgnoreRecover(q$z)||(null!==q$z.method&&(delete this._map[q$z.key],q$z.run(!1)),this._recoverHandler(q$z)),q$W===q$k&&(q$k=q$V.length-1)}q$V.length=0}},q$_._clearHandlers=function(){for(var q$S=this._handlers,q$_=0,q$a=q$S.length;q$_<q$a;q$_++){var q$R=q$S[q$_];null!==q$R.method?this._temp.push(q$R):this._isIgnoreRecover(q$R)?this._temp.push(q$R):this._recoverHandler(q$R)}this._handlers=this._temp,this._temp=q$S,this._temp.length=0},q$_._recoverHandler=function(q$S){this._map[q$S.key]==q$S&&delete this._map[q$S.key],q$S.recover()},q$_._create=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){if(!q$a)return q$J.apply(q$R,q$V),null;if(q$W){var q$z=this._getHandler(q$R,q$J);if(q$z)return q$z.repeat=q$_,q$z.userFrame=q$S,q$z.delay=q$a,q$z.ignoreRecover=q$k,q$z.caller=q$R,q$z.method=q$J,q$z.args=q$V,q$z.exeTime=q$a+(q$S?this.currFrame:this.currTimer+this._now()-this._lastTimer),q$z}return(q$z=q$b.create()).repeat=q$_,q$z.userFrame=q$S,q$z.delay=q$a,q$z.ignoreRecover=q$k,q$z.caller=q$R,q$z.method=q$J,q$z.args=q$V,q$z.exeTime=q$a+(q$S?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(q$z),this._handlers.push(q$z),q$z},q$_._indexHandler=function(q$S){var q$_=q$S.caller,q$a=q$S.method,q$R=q$_?q$_.$_GID||(q$_.$_GID=q$O.getGID()):0,q$J=q$a.$_TID||(q$a.$_TID=this._mid++);q$S.key=q$R+"_"+q$J,this._map[q$S.key]=q$S},q$_.once=function(q$S,q$_,q$a,q$R,q$J){void 0===q$J&&(q$J=!0),this._create(!1,!1,q$S,q$_,q$a,q$R,q$J,!1)},q$_.loop=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){void 0===q$J&&(q$J=!0),void 0===q$V&&(q$V=!1),void 0===q$W&&(q$W=!1);var q$k=this._create(!1,!0,q$S,q$_,q$a,q$R,q$J,q$W);q$k&&(q$k.jumpFrame=q$V)},q$_.frameOnce=function(q$S,q$_,q$a,q$R,q$J){void 0===q$J&&(q$J=!0),this._create(!0,!1,q$S,q$_,q$a,q$R,q$J,!1)},q$_.frameLoop=function(q$S,q$_,q$a,q$R,q$J,q$V){void 0===q$J&&(q$J=!0),void 0===q$V&&(q$V=!1),this._create(!0,!0,q$S,q$_,q$a,q$R,q$J,q$V)},q$_.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+q$b._freeCount},q$_.clear=function(q$S,q$_){var q$a=this._getHandler(q$S,q$_);return!(!q$a||this._isIgnoreRecover(q$a))&&(delete this._map[q$a.key],q$a.key=null,q$a.clear(),!0)},q$_.clearAll=function(q$S){if(q$S)for(var q$_=0,q$a=this._handlers.length;q$_<q$a;q$_++){var q$R=this._handlers[q$_];q$R.caller===q$S&&(this._isIgnoreRecover(q$R)||(delete this._map[q$R.key],q$R.key=null,q$R.clear()))}},q$_._getHandler=function(q$S,q$_){var q$a=q$S?q$S.$_GID||(q$S.$_GID=q$O.getGID()):0,q$R=q$_.$_TID||(q$_.$_TID=this._mid++);return this._map[q$a+"_"+q$R]},q$_._isIgnoreRecover=function(q$S){if(q$S.ignoreRecover||q$S.caller&&"IgnoreRecover"==q$S.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var q$_="";try{arguments.propertyIsEnumerable.caller}catch(q$S){q$_=q$S.stack}q$q.recordError("报错：核心定时器销毁忽略  "+q$_)}return!0}return!1},q$_.hasHandler=function(q$S,q$_){return this._map[q$S.$_GID+"_"+q$_.$_TID]},q$_.callLater=function(q$S,q$_,q$a){if(null==this._getHandler(q$S,q$_)){var q$R=q$b.create();q$R.caller=q$S,q$R.method=q$_,q$R.args=q$a,this._indexHandler(q$R),this._laters.push(q$R)}},q$_.runCallLater=function(q$S,q$_){var q$a=this._getHandler(q$S,q$_);q$a&&null!=q$a.method&&(this._isIgnoreRecover(q$a)||(delete this._map[q$a.key],q$a.run(!0)))},q$_.runTimer=function(q$S,q$_){this.runCallLater(q$S,q$_)},q$t(0,q$_,"delta",function(){return this._delta}),q$S.__init$=function(){q$b=function(){function q$_(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}q$H(q$_,"");var q$S=q$_.prototype;return q$S.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},q$S.recover=function(){this.clear(),this.args=q$_._freeHandler,q$_._freeHandler=this,q$_._freeCount++},q$S.run=function(q$S){var q$_=this.caller;if(q$_&&q$_.destroyed)return this.clear();var q$a=this.method,q$R=this.args;q$S&&this.clear(),null!=q$a&&(q$R?q$a.apply(q$_,q$R):q$a.call(q$_))},q$_._freeHandler=null,q$_._freeCount=0,q$_.create=function(){var q$S=q$_._freeHandler;return q$S?(q$_._freeHandler=q$S.args,--q$_._freeCount,q$S.args=null,q$S):new q$_},q$_}()},q$S}()),q$E=function(){function q$L(){this.gid=0}q$H(q$L,"laya.utils.Tween");var q$S=q$L.prototype;return q$S.to=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){return void 0===q$V&&(q$V=0),void 0===q$W&&(q$W=!1),this._create(q$S,q$_,q$a,q$R,q$J,q$V,q$W,!0,!1,!0)},q$S.from=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){return void 0===q$V&&(q$V=0),void 0===q$W&&(q$W=!1),this._create(q$S,q$_,q$a,q$R,q$J,q$V,q$W,!1,!1,!0)},q$S._create=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){if(!q$S)throw new Error("Tween:target is null");this._target=q$S,this._duration=q$a,this._ease=q$R||q$_.ease||q$L.easeNone,this._complete=q$J||q$_.complete,this._delay=q$V,this._props=[],this._usedTimer=0,this._startTimer=q$g.now(),this._usedPool=q$z,this._delayParam=null,this.update=q$_.update;var q$H=q$S.$_GID||(q$S.$_GID=q$O.getGID());return q$L.tweenMap[q$H]?(q$W&&q$L.clearTween(q$S),q$L.tweenMap[q$H].push(this)):q$L.tweenMap[q$H]=[this],q$b?q$V<=0?this.firstStart(q$S,q$_,q$k):(this._delayParam=[q$S,q$_,q$k],q$q.scaleTimer.once(q$V,this,this.firstStart,this._delayParam)):this._initProps(q$S,q$_,q$k),this},q$S.firstStart=function(q$S,q$_,q$a){this._delayParam=null,q$S.destroyed?this.clear():(this._initProps(q$S,q$_,q$a),this._beginLoop())},q$S._initProps=function(q$S,q$_,q$a){for(var q$R in q$_)if("number"==typeof q$S[q$R]){var q$J=q$a?q$S[q$R]:q$_[q$R],q$V=q$a?q$_[q$R]:q$S[q$R];this._props.push([q$R,q$J,q$V-q$J]),q$a||(q$S[q$R]=q$J)}},q$S._beginLoop=function(){q$q.scaleTimer.frameLoop(1,this,this._doEase)},q$S._doEase=function(){this._updateEase(q$g.now())},q$S._updateEase=function(q$S){var q$_=this._target;if(q$_){if(q$_.destroyed)return q$L.clearTween(q$_);var q$a=this._usedTimer=q$S-this._startTimer-this._delay;if(!(q$a<0)){if(q$a>=this._duration)return this.complete();for(var q$R=0<q$a?this._ease(q$a,0,1,this._duration):0,q$J=this._props,q$V=0,q$W=q$J.length;q$V<q$W;q$V++){var q$k=q$J[q$V];q$_[q$k[0]]=q$k[1]+q$R*q$k[2]}this.update&&this.update.run()}}},q$S.complete=function(){if(this._target){q$q.scaleTimer.runTimer(this,this.firstStart);for(var q$S=this._target,q$_=this._props,q$a=this._complete,q$R=0,q$J=q$_.length;q$R<q$J;q$R++){var q$V=q$_[q$R];q$S[q$V[0]]=q$V[1]+q$V[2]}this.update&&this.update.run(),this.clear(),q$a&&q$a.run()}},q$S.pause=function(){q$q.scaleTimer.clear(this,this._beginLoop),q$q.scaleTimer.clear(this,this._doEase),q$q.scaleTimer.clear(this,this.firstStart);var q$S;(q$S=q$g.now()-this._startTimer-this._delay)<0&&(this._usedTimer=q$S)},q$S.setStartTime=function(q$S){this._startTimer=q$S},q$S.clear=function(){this._target&&(this._remove(),this._clear())},q$S._clear=function(){this.pause(),q$q.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,q$p.recover("tween",this))},q$S.recover=function(){this._usedPool=!0,this._clear()},q$S._remove=function(){var q$S=q$L.tweenMap[this._target.$_GID];if(q$S)for(var q$_=0,q$a=q$S.length;q$_<q$a;q$_++)if(q$S[q$_]===this){q$S.splice(q$_,1);break}},q$S.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=q$g.now(),this._delayParam)q$q.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var q$S=this._props,q$_=0,q$a=q$S.length;q$_<q$a;q$_++){var q$R=q$S[q$_];this._target[q$R[0]]=q$R[1]}q$q.scaleTimer.once(this._delay,this,this._beginLoop)}},q$S.resume=function(){this._usedTimer>=this._duration||(this._startTimer=q$g.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?q$q.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},q$t(0,q$S,"progress",null,function(q$S){var q$_=q$S*this._duration;this._startTimer=q$g.now()-this._delay-q$_}),q$L.to=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){return void 0===q$V&&(q$V=0),void 0===q$W&&(q$W=!1),void 0===q$k&&(q$k=!0),q$p.getItemByClass("tween",q$L)._create(q$S,q$_,q$a,q$R,q$J,q$V,q$W,!0,q$k,!0)},q$L.from=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){return void 0===q$V&&(q$V=0),void 0===q$W&&(q$W=!1),void 0===q$k&&(q$k=!0),q$p.getItemByClass("tween",q$L)._create(q$S,q$_,q$a,q$R,q$J,q$V,q$W,!1,q$k,!0)},q$L.clearAll=function(q$S){if(q$S&&q$S.$_GID){var q$_=q$L.tweenMap[q$S.$_GID];if(q$_){for(var q$a=0,q$R=q$_.length;q$a<q$R;q$a++)q$_[q$a]._clear();q$_.length=0}}},q$L.clear=function(q$S){q$S.clear()},q$L.clearTween=function(q$S){q$L.clearAll(q$S)},q$L.easeNone=function(q$S,q$_,q$a,q$R){return q$a*q$S/q$R+q$_},q$L.tweenMap={},q$L}(),q$O=function(){function q$k(){}return q$H(q$k,"laya.utils.Utils"),q$k.toRadian=function(q$S){return q$S*q$k._pi2},q$k.toAngle=function(q$S){return q$S*q$k._pi},q$k.toHexColor=function(q$S){if(q$S<0||isNaN(q$S))return null;for(var q$_=q$S.toString(16);q$_.length<6;)q$_="0"+q$_;return"#"+q$_},q$k.getGID=function(){return q$k._gid++},q$k.concatArray=function(q$S,q$_){if(!q$_)return q$S;if(!q$S)return q$_;var q$a=0,q$R=q$_.length;for(q$a=0;q$a<q$R;q$a++)q$S.push(q$_[q$a]);return q$S},q$k.clearArray=function(q$S){return q$S&&(q$S.length=0),q$S},q$k.copyArray=function(q$S,q$_){if(q$S||(q$S=[]),!q$_)return q$S;q$S.length=q$_.length;var q$a=0,q$R=q$_.length;for(q$a=0;q$a<q$R;q$a++)q$S[q$a]=q$_[q$a];return q$S},q$k.getGlobalRecByPoints=function(q$S,q$_,q$a,q$R,q$J){var q$V,q$W;return q$V=new q$N(q$_,q$a),q$V=q$S.localToGlobal(q$V),q$W=new q$N(q$R,q$J),q$W=q$S.localToGlobal(q$W),q$n._getWrapRec([q$V.x,q$V.y,q$W.x,q$W.y])},q$k.getGlobalPosAndScale=function(q$S){return q$k.getGlobalRecByPoints(q$S,0,0,1,1)},q$k.bind=function(q$S,q$_){return q$S.bind(q$_)},q$k.measureText=function(q$S,q$_){return q$A.measureText(q$S,q$_)},q$k.contextMeasureText=function(q$S){var q$_=q$g.context.measureText(q$S);return q$_||(q$_={width:16,height:16}),q$_},q$k.updateOrder=function(q$S){if(!q$S||q$S.length<2)return!1;for(var q$_,q$a=1,q$R=0,q$J=q$S.length,q$V=NaN;q$a<q$J;){for(q$_=q$S[q$R=q$a],q$V=q$S[q$R]._zOrder;-1<--q$R&&q$S[q$R]._zOrder>q$V;)q$S[q$R+1]=q$S[q$R];q$S[q$R+1]=q$_,q$a++}var q$W=q$_.parent.conchModel;if(q$W)if(null!=q$W.updateZOrder)q$W.updateZOrder();else{for(q$a=0;q$a<q$J;q$a++)q$W.removeChild(q$S[q$a].conchModel);for(q$a=0;q$a<q$J;q$a++)q$W.addChildAt(q$S[q$a].conchModel,q$a)}return!0},q$k.transPointList=function(q$S,q$_,q$a){var q$R=0,q$J=q$S.length;for(q$R=0;q$R<q$J;q$R+=2)q$S[q$R]+=q$_,q$S[q$R+1]+=q$a},q$k.parseInt=function(q$S,q$_){void 0===q$_&&(q$_=0);var q$a=q$g.window.parseInt(q$S,q$_);return isNaN(q$a)?0:q$a},q$k.getFileExtension=function(q$S){q$k._extReg.lastIndex=q$S.lastIndexOf(".");var q$_=q$k._extReg.exec(q$S);return q$_&&1<q$_.length?q$_[1].toLowerCase():null},q$k.getTransformRelativeToWindow=function(q$S,q$_,q$a){var q$R=q$q.stage,q$J=laya.utils.Utils.getGlobalPosAndScale(q$S),q$V=q$R._canvasTransform.clone(),q$W=q$V.tx,q$k=q$V.ty;q$V.rotate(-Math.PI/180*q$q.stage.canvasDegree),q$V.scale(q$q.stage.clientScaleX,q$q.stage.clientScaleY);var q$z=q$q.stage.canvasDegree%180!=0,q$b=NaN,q$H=NaN;q$z?(q$b=q$a+q$J.y,q$H=q$_+q$J.x,q$b*=q$V.d,q$H*=q$V.a,90==q$q.stage.canvasDegree?(q$b=q$W-q$b,q$H+=q$k):(q$b+=q$W,q$H=q$k-q$H)):(q$b=q$_+q$J.x,q$H=q$a+q$J.y,q$b*=q$V.a,q$H*=q$V.d,q$b+=q$W,q$H+=q$k);var q$L=NaN,q$C=NaN;return q$C=q$z?(q$L=q$V.d*q$J.height,q$V.a*q$J.width):(q$L=q$V.a*q$J.width,q$V.d*q$J.height),{x:q$b,y:q$H,scaleX:q$L,scaleY:q$C}},q$k.fitDOMElementInArea=function(q$S,q$_,q$a,q$R,q$J,q$V){q$S._fitLayaAirInitialized||(q$S._fitLayaAirInitialized=!0,q$S.style.transformOrigin=q$S.style.webKittransformOrigin="left top",q$S.style.position="absolute");var q$W=q$k.getTransformRelativeToWindow(q$_,q$a,q$R);q$S.style.transform=q$S.style.webkitTransform="scale("+q$W.scaleX+","+q$W.scaleY+") rotate("+q$q.stage.canvasDegree+"deg)",q$S.style.width=q$J+"px",q$S.style.height=q$V+"px",q$S.style.left=q$W.x+"px",q$S.style.top=q$W.y+"px"},q$k.isOkTextureList=function(q$S){if(!q$S)return!1;var q$_,q$a=0,q$R=q$S.length;for(q$a=0;q$a<q$R;q$a++)if(!(q$_=q$S[q$a])||!q$_.source)return!1;return!0},q$k.isOKCmdList=function(q$S){if(!q$S)return!1;var q$_,q$a,q$R=0,q$J=q$S.length,q$V=q$K._context;for(q$R=0;q$R<q$J;q$R++)switch((q$_=q$S[q$R]).callee){case q$V._drawTexture:case q$V._fillTexture:case q$V._drawTextureWithTransform:if(!(q$a=q$_[0])||!q$a.source)return!1}return!0},q$k._gid=1,q$k._pi=180/Math.PI,q$k._pi2=Math.PI/180,q$k._extReg=/\.(\w+)\??/g,q$k.parseXMLFromString=function(q$S){var q$_;if(q$S=q$S.replace(/>\s+</g,"><"),-1<(q$_=(new DOMParser).parseFromString(q$S,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(q$_.firstChild.firstChild.textContent);return q$_},q$k}(),q$w=function(){function q$S(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],q$K.isWebGL&&q$s.regCacheByFunction(q$O.bind(this.startDispose,this),q$O.bind(this.getCacheList,this))}q$H(q$S,"laya.utils.VectorGraphManager");var q$_=q$S.prototype;return q$_.getId=function(){return this._id++},q$_.addShape=function(q$S,q$_){this.shapeDic[q$S]=q$_,this.useDic[q$S]||(this.useDic[q$S]=!0)},q$_.addLine=function(q$S,q$_){this.shapeLineDic[q$S]=q$_,this.shapeLineDic[q$S]||(this.shapeLineDic[q$S]=!0)},q$_.getShape=function(q$S){this._checkKey&&null!=this.useDic[q$S]&&(this.useDic[q$S]=!0)},q$_.deleteShape=function(q$S){this.shapeDic[q$S]&&(this.shapeDic[q$S]=null,delete this.shapeDic[q$S]),this.shapeLineDic[q$S]&&(this.shapeLineDic[q$S]=null,delete this.shapeLineDic[q$S]),null!=this.useDic[q$S]&&delete this.useDic[q$S]},q$_.getCacheList=function(){var q$S,q$_=[];for(q$S in this.shapeDic)q$_.push(this.shapeDic[q$S]);for(q$S in this.shapeLineDic)q$_.push(this.shapeLineDic[q$S]);return q$_},q$_.startDispose=function(q$S){var q$_;for(q$_ in this.useDic)this.useDic[q$_]=!1;this._checkKey=!0},q$_.endDispose=function(){if(this._checkKey){var q$S;for(q$S in this.useDic)this.useDic[q$S]||this.deleteShape(q$S);this._checkKey=!1}},q$S.getInstance=function(){return q$S.instance=q$S.instance||new q$S},q$S.instance=null,q$S}(),q$v=function(){function q$R(){this._obj=null,this._obj=q$R.supportWeakMap?new q$g.window.WeakMap:{},q$R.supportWeakMap||q$R._maps.push(this)}q$H(q$R,"laya.utils.WeakObject");var q$S=q$R.prototype;return q$S.set=function(q$S,q$_){if(null!=q$S)if(q$R.supportWeakMap){var q$a=q$S;"string"!=typeof q$S&&"number"!=typeof q$S||(q$a=q$R._keys[q$S])||(q$a=q$R._keys[q$S]={k:q$S}),this._obj.set(q$a,q$_)}else"string"==typeof q$S||"number"==typeof q$S?this._obj[q$S]=q$_:(q$S.$_GID||(q$S.$_GID=q$O.getGID()),this._obj[q$S.$_GID]=q$_)},q$S.get=function(q$S){if(null==q$S)return null;if(q$R.supportWeakMap){var q$_="string"==typeof q$S||"number"==typeof q$S?q$R._keys[q$S]:q$S;return q$_?this._obj.get(q$_):null}return"string"==typeof q$S||"number"==typeof q$S?this._obj[q$S]:this._obj[q$S.$_GID]},q$S.del=function(q$S){if(null!=q$S)if(q$R.supportWeakMap){var q$_="string"==typeof q$S||"number"==typeof q$S?q$R._keys[q$S]:q$S;if(!q$_)return;this._obj.delete(q$_)}else"string"==typeof q$S||"number"==typeof q$S?delete this._obj[q$S]:delete this._obj[this._obj.$_GID]},q$S.has=function(q$S){if(null==q$S)return!1;if(q$R.supportWeakMap){var q$_="string"==typeof q$S||"number"==typeof q$S?q$R._keys[q$S]:q$S;return this._obj.has(q$_)}return"string"==typeof q$S||"number"==typeof q$S?null!=this._obj[q$S]:null!=this._obj[this._obj.$_GID]},q$R.__init__=function(){(q$R.supportWeakMap=null!=q$g.window.WeakMap)||q$q.timer.loop(q$R.delInterval,null,q$R.clearCache)},q$R.clearCache=function(){for(var q$S=0,q$_=q$R._maps.length;q$S<q$_;q$S++){q$R._maps[q$S]._obj={}}},q$R.supportWeakMap=!1,q$R.delInterval=3e5,q$R._keys={},q$R._maps=[],q$z(q$R,["I",function(){return this.I=new q$R}]),q$R}(),q$d=function(){function q$S(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}q$H(q$S,"laya.utils.WordText");var q$_=q$S.prototype;return q$_.setText=function(q$S){this.changed=!0,this._text=q$S},q$_.toString=function(){return this._text},q$_.charCodeAt=function(q$S){return this._text?this._text.charCodeAt(q$S):NaN},q$_.charAt=function(q$S){return this._text?this._text.charAt(q$S):null},q$t(0,q$_,"length",function(){return this._text?this._text.length:0}),q$S}(),q$SS=function(q$S){function q$W(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,q$W.__super.call(this),this._childs=q$W.ARRAY_EMPTY,this._$P=q$W.PROP_EMPTY,this.timer=q$q.scaleTimer,this.conchModel=q$K.isConchNode?this.createConchModel():null}q$H(q$W,"laya.display.Node",q$b);var q$_=q$W.prototype;return q$_._setBit=function(q$S,q$_){1==q$S&&(this._getBit(q$S)!=q$_&&this._updateDisplayedInstage());q$_?this._bits|=q$S:this._bits&=~q$S},q$_._getBit=function(q$S){return 0!=(this._bits&q$S)},q$_._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},q$_._setUpNoticeType=function(q$S){var q$_=this;for(q$_._setBit(q$S,!0),q$_=q$_.parent;q$_;){if(q$_._getBit(q$S))return;q$_._setBit(q$S,!0),q$_=q$_.parent}},q$_.on=function(q$S,q$_,q$a,q$R){return"display"!==q$S&&"undisplay"!==q$S||this._getBit(1)||this._setUpNoticeType(1),this._createListener(q$S,q$_,q$a,q$R,!1)},q$_.once=function(q$S,q$_,q$a,q$R){return"display"!==q$S&&"undisplay"!==q$S||this._getBit(1)||this._setUpNoticeType(1),this._createListener(q$S,q$_,q$a,q$R,!0)},q$_.createConchModel=function(){return null},q$_.destroy=function(q$S){void 0===q$S&&(q$S=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(q$S?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},q$_.destroyChildren=function(){if(this._childs)for(var q$S=this._childs.length-1;-1<q$S;q$S--)this._childs[q$S].destroy(!0)},q$_.addChild=function(q$S){if(!q$S||this.destroyed||q$S===this)return q$S;if(q$S.zOrder&&this._set$P("hasZorder",!0),q$S._parent===this){var q$_=this.getChildIndex(q$S);q$_!==this._childs.length-1&&(this._childs.splice(q$_,1),this._childs.push(q$S),this.conchModel&&(this.conchModel.removeChild(q$S.conchModel),this.conchModel.addChildAt(q$S.conchModel,this._childs.length-1)),this._childChanged())}else q$S.parent&&q$S.parent.removeChild(q$S),this._childs===q$W.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(q$S),this.conchModel&&this.conchModel.addChildAt(q$S.conchModel,this._childs.length-1),(q$S.parent=this)._childChanged();return q$S},q$_.addChildren=function(q$S){for(var q$_=arguments,q$a=0,q$R=q$_.length;q$a<q$R;)this.addChild(q$_[q$a++])},q$_.addChildAt=function(q$S,q$_){if(!q$S||this.destroyed||q$S===this)return q$S;if(q$S.zOrder&&this._set$P("hasZorder",!0),0<=q$_&&q$_<=this._childs.length){if(q$S._parent===this){var q$a=this.getChildIndex(q$S);this._childs.splice(q$a,1),this._childs.splice(q$_,0,q$S),this.conchModel&&(this.conchModel.removeChild(q$S.conchModel),this.conchModel.addChildAt(q$S.conchModel,q$_)),this._childChanged()}else q$S.parent&&q$S.parent.removeChild(q$S),this._childs===q$W.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(q$_,0,q$S),this.conchModel&&this.conchModel.addChildAt(q$S.conchModel,q$_),q$S.parent=this;return q$S}throw new Error("appendChildAt:The index is out of bounds")},q$_.getChildIndex=function(q$S){return this._childs.indexOf(q$S)},q$_.getChildByName=function(q$S){var q$_=this._childs;if(q$_)for(var q$a=0,q$R=q$_.length;q$a<q$R;q$a++){var q$J=q$_[q$a];if(q$J.name===q$S)return q$J}return null},q$_._get$P=function(q$S){return this._$P[q$S]},q$_._set$P=function(q$S,q$_){return this.destroyed||(this._$P===q$W.PROP_EMPTY&&(this._$P={}),this._$P[q$S]=q$_),q$_},q$_.getChildAt=function(q$S){return this._childs[q$S]},q$_.setChildIndex=function(q$S,q$_){var q$a=this._childs;if(q$_<0||q$_>=q$a.length)throw new Error("setChildIndex:The index is out of bounds.");var q$R=this.getChildIndex(q$S);if(q$R<0)throw new Error("setChildIndex:node is must child of this object.");return q$a.splice(q$R,1),q$a.splice(q$_,0,q$S),this.conchModel&&(this.conchModel.removeChild(q$S.conchModel),this.conchModel.addChildAt(q$S.conchModel,q$_)),this._childChanged(),q$S},q$_._childChanged=function(q$S){},q$_.removeChild=function(q$S){if(!this._childs)return q$S;var q$_=this._childs.indexOf(q$S);return this.removeChildAt(q$_)},q$_.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},q$_.removeChildByName=function(q$S){var q$_=this.getChildByName(q$S);return q$_&&this.removeChild(q$_),q$_},q$_.removeChildAt=function(q$S){var q$_=this.getChildAt(q$S);if(q$_){for(var q$a=this._childs.length-1,q$R=q$S;q$R<q$a;++q$R)this._childs[q$R]=this._childs[q$R+1];this._childs.length=q$a,this.conchModel&&this.conchModel.removeChild(q$_.conchModel),q$_.parent=null}return q$_},q$_.removeChildren=function(q$S,q$_){if(void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=2147483647),this._childs&&0<this._childs.length){var q$a=this._childs;if(0===q$S&&q$V<=q$_){var q$R=q$a;this._childs=q$W.ARRAY_EMPTY}else q$R=q$a.splice(q$S,q$_-q$S);for(var q$J=0,q$V=q$R.length;q$J<q$V;q$J++)q$R[q$J].parent=null,this.conchModel&&this.conchModel.removeChild(q$R[q$J].conchModel)}return this},q$_.replaceChild=function(q$S,q$_){var q$a=this._childs.indexOf(q$_);return-1<q$a?(this._childs.splice(q$a,1,q$S),this.conchModel&&(this.conchModel.removeChild(q$_.conchModel),this.conchModel.addChildAt(q$S.conchModel,q$a)),q$_.parent=null,q$S.parent=this,q$S):null},q$_._updateDisplayedInstage=function(){var q$S;q$S=this;var q$_=q$q.stage;for(this._displayedInStage=!1;q$S;){if(q$S._getBit(1)){this._displayedInStage=q$S._displayedInStage;break}if(q$S==q$_||q$S._displayedInStage){this._displayedInStage=!0;break}q$S=q$S.parent}},q$_._setDisplay=function(q$S){this._displayedInStage!==q$S&&((this._displayedInStage=q$S)?this.event("display"):this.event("undisplay"))},q$_._displayChild=function(q$S,q$_){var q$a=q$S._childs;if(q$a)for(var q$R=0;q$R<q$a.length;q$R++){var q$J=q$a[q$R];q$J&&q$J._getBit(1)&&(0<q$J._childs.length?this._displayChild(q$J,q$_):q$J._setDisplay(q$_))}q$S._setDisplay(q$_)},q$_.contains=function(q$S){if(q$S===this)return!0;for(;q$S;){if(q$S.parent===this)return!0;q$S=q$S.parent}return!1},q$_.timerLoop=function(q$S,q$_,q$a,q$R,q$J,q$V){void 0===q$J&&(q$J=!0),void 0===q$V&&(q$V=!1),this.timer.loop(q$S,q$_,q$a,q$R,q$J,q$V)},q$_.timerOnce=function(q$S,q$_,q$a,q$R,q$J){void 0===q$J&&(q$J=!0),this.timer._create(!1,!1,q$S,q$_,q$a,q$R,q$J)},q$_.frameLoop=function(q$S,q$_,q$a,q$R,q$J){void 0===q$J&&(q$J=!0),this.timer._create(!0,!0,q$S,q$_,q$a,q$R,q$J)},q$_.frameOnce=function(q$S,q$_,q$a,q$R,q$J){void 0===q$J&&(q$J=!0),this.timer._create(!0,!1,q$S,q$_,q$a,q$R,q$J)},q$_.clearTimer=function(q$S,q$_){this.timer.clear(q$S,q$_)},q$t(0,q$_,"numChildren",function(){return this._childs.length}),q$t(0,q$_,"destroyed",function(){return this._destroyed}),q$t(0,q$_,"parent",function(){return this._parent},function(q$S){this._parent!==q$S&&(q$S?(this._parent=q$S,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),q$S.displayedInStage&&this._displayChild(this,!0)),q$S._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=q$S))}),q$t(0,q$_,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),q$W.ARRAY_EMPTY=[],q$W.PROP_EMPTY={},q$W.NOTICE_DISPLAY=1,q$W.MOUSEENABLE=2,q$W}(),q$_S=function(q$S){function q$C(q$S){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,q$C.__super.call(this),this._padding=q$C._PADDING,this._spacing=q$C._SPACING,this._aligns=q$C._ALIGNS,this._font=q$G.EMPTY,this._ower=q$S}q$H(q$C,"laya.display.css.CSSStyle",q$S);var q$_=q$C.prototype;return q$_.destroy=function(){this._ower=null,this._font=null,this._rect=null},q$_.inherit=function(q$S){this._font=q$S._font,this._spacing=q$S._spacing===q$C._SPACING?q$C._SPACING:q$S._spacing.slice(),this.lineHeight=q$S.lineHeight},q$_._widthAuto=function(){return 0!=(262144&this._type)},q$_.widthed=function(q$S){return 0!=(8&this._type)},q$_._calculation=function(q$S,q$_){if(q$_.indexOf("%")<0)return!1;var q$R=this._ower,q$J=q$R.parent,q$V=this._rect;function q$W(q$S,q$_,q$a){return q$S*q$a[0]+q$_*q$a[1]+q$a[2]}function q$a(q$S){var q$_=q$J.width,q$a=q$R.width;q$V.width&&(q$R.width=q$W(q$_,q$a,q$V.width)),q$V.height&&(q$R.height=q$W(q$_,q$a,q$V.height)),q$V.left&&(q$R.x=q$W(q$_,q$a,q$V.left)),q$V.top&&(q$R.y=q$W(q$_,q$a,q$V.top))}null===q$V&&(q$J._getCSSStyle()._type|=524288,q$J.on("resize",this,q$a),this._rect=q$V={input:{}});var q$k=q$_.split(" ");return q$k[0]=parseFloat(q$k[0])/100,1==q$k.length?q$k[1]=q$k[2]=0:(q$k[1]=parseFloat(q$k[1])/100,q$k[2]=parseFloat(q$k[2])),q$V[q$S]=q$k,q$V.input[q$S]=q$_,q$a(),!0},q$_.heighted=function(q$S){return 0!=(8192&this._type)},q$_.size=function(q$S,q$_){var q$a=this._ower,q$R=!1;-1!==q$S&&q$S!=this._ower.width&&(this._type|=8,this._ower.width=q$S,q$R=!0),-1!==q$_&&q$_!=this._ower.height&&(this._type|=8192,this._ower.height=q$_,q$R=!0),q$R&&(q$a._layoutLater(),524288&this._type&&q$a.event("resize",this))},q$_._getAlign=function(){return this._aligns[0]},q$_._getValign=function(){return this._aligns[1]},q$_._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},q$_._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new q$G(this._font))},q$_.render=function(q$S,q$_,q$a,q$R){var q$J=q$S.width,q$V=q$S.height;q$a-=q$S.pivotX,q$R-=q$S.pivotY,this._bgground&&null!=this._bgground.color&&q$_.ctx.fillRect(q$a,q$R,q$J,q$V,this._bgground.color),this._border&&this._border.color&&q$_.drawRect(q$a,q$R,q$J,q$V,this._border.color.strColor,this._border.size)},q$_.getCSSStyle=function(){return this},q$_.cssText=function(q$S){this.attrs(q$C.parseOneCSS(q$S,";"))},q$_.attrs=function(q$S){if(q$S)for(var q$_=0,q$a=q$S.length;q$_<q$a;q$_++){var q$R=q$S[q$_];this[q$R[0]]=q$R[1]}},q$_.setTransform=function(q$S){"none"===q$S?this._tf=q$k._TF_EMPTY:this.attrs(q$C.parseOneCSS(q$S,","))},q$_.translate=function(q$S,q$_){this._tf===q$k._TF_EMPTY&&(this._tf=new q$J),this._tf.translateX=q$S,this._tf.translateY=q$_},q$_.scale=function(q$S,q$_){this._tf===q$k._TF_EMPTY&&(this._tf=new q$J),this._tf.scaleX=q$S,this._tf.scaleY=q$_},q$_._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},q$t(0,q$_,"block",q$S.prototype._$get_block,function(q$S){q$S?this._type|=1:this._type&=-2}),q$t(0,q$_,"valign",function(){return q$C._valigndef[this._aligns[1]]},function(q$S){this._aligns===q$C._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=q$C._valigndef[q$S]}),q$t(0,q$_,"height",null,function(q$S){if(this._type|=8192,"string"==typeof q$S){if(this._calculation("height",q$S))return;q$S=parseInt(q$S)}this.size(-1,q$S)}),q$t(0,q$_,"width",null,function(q$S){if(this._type|=8,"string"==typeof q$S){var q$_=q$S.indexOf("auto");if(0<=q$_&&(this._type|=262144,q$S=q$S.substr(0,q$_)),this._calculation("width",q$S))return;q$S=parseInt(q$S)}this.size(q$S,-1)}),q$t(0,q$_,"fontWeight",function(){return this._font.weight},function(q$S){this._createFont().weight=q$S}),q$t(0,q$_,"left",null,function(q$S){var q$_=this._ower;if("string"==typeof q$S){if("center"===q$S?q$S="50% -50% 0":"right"===q$S&&(q$S="100% -100% 0"),this._calculation("left",q$S))return;q$S=parseInt(q$S)}q$_.x=q$S}),q$t(0,q$_,"_translate",null,function(q$S){this.translate(q$S[0],q$S[1])}),q$t(0,q$_,"absolute",function(){return 0!=(4&this._type)}),q$t(0,q$_,"top",null,function(q$S){var q$_=this._ower;if("string"==typeof q$S){if("middle"===q$S?q$S="50% -50% 0":"bottom"===q$S&&(q$S="100% -100% 0"),this._calculation("top",q$S))return;q$S=parseInt(q$S)}q$_.y=q$S}),q$t(0,q$_,"align",function(){return q$C._aligndef[this._aligns[0]]},function(q$S){this._aligns===q$C._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=q$C._aligndef[q$S]}),q$t(0,q$_,"bold",function(){return this._font.bold},function(q$S){this._createFont().bold=q$S}),q$t(0,q$_,"padding",function(){return this._padding},function(q$S){this._padding=q$S}),q$t(0,q$_,"leading",function(){return this._spacing[1]},function(q$S){"string"==typeof q$S&&(q$S=parseInt(q$S+"")),this._spacing===q$C._SPACING&&(this._spacing=[0,0]),this._spacing[1]=q$S}),q$t(0,q$_,"lineElement",function(){return 0!=(65536&this._type)},function(q$S){q$S?this._type|=65536:this._type&=-65537}),q$t(0,q$_,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(q$S){this.lineElement=!1,"right"===q$S?this._type|=32768:this._type&=-32769}),q$t(0,q$_,"textDecoration",function(){return this._font.decoration},function(q$S){this._createFont().decoration=q$S}),q$t(0,q$_,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(q$S){"nowrap"===q$S&&(this._type|=131072),"none"===q$S&&(this._type&=-131073)}),q$t(0,q$_,"background",null,function(q$S){q$S?(this._bgground||(this._bgground={}),this._bgground.color=q$S,this._ower.conchModel&&this._ower.conchModel.bgColor(q$S),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),q$t(0,q$_,"wordWrap",function(){return 0==(131072&this._type)},function(q$S){q$S?this._type&=-131073:this._type|=131072}),q$t(0,q$_,"color",function(){return this._font.color},function(q$S){this._createFont().color=q$S}),q$t(0,q$_,"password",function(){return this._font.password},function(q$S){this._createFont().password=q$S}),q$t(0,q$_,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(q$S){"none"===q$S?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=q$S),this._ower.conchModel&&this._ower.conchModel.bgColor(q$S),this._ower._renderType|=256}),q$t(0,q$_,"font",function(){return this._font.toString()},function(q$S){this._createFont().set(q$S)}),q$t(0,q$_,"weight",null,function(q$S){this._createFont().weight=q$S}),q$t(0,q$_,"letterSpacing",function(){return this._spacing[0]},function(q$S){"string"==typeof q$S&&(q$S=parseInt(q$S+"")),this._spacing===q$C._SPACING&&(this._spacing=[0,0]),this._spacing[0]=q$S}),q$t(0,q$_,"fontSize",function(){return this._font.size},function(q$S){this._createFont().size=q$S}),q$t(0,q$_,"italic",function(){return this._font.italic},function(q$S){this._createFont().italic=q$S}),q$t(0,q$_,"fontFamily",function(){return this._font.family},function(q$S){this._createFont().family=q$S}),q$t(0,q$_,"stroke",function(){return this._font.stroke[0]},function(q$S){this._createFont().stroke===q$G._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=q$S}),q$t(0,q$_,"strokeColor",function(){return this._font.stroke[1]},function(q$S){this._createFont().stroke===q$G._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=q$S}),q$t(0,q$_,"border",function(){return this._border?this._border.value:""},function(q$S){if("none"!=q$S){this._border||(this._border={});var q$_=(this._border.value=q$S).split(" ");if(this._border.color=q$f.create(q$_[q$_.length-1]),1==q$_.length)return this._border.size=1,void(this._border.type="solid");var q$a=0;0<q$_[0].indexOf("px")?(this._border.size=parseInt(q$_[0]),q$a++):this._border.size=1,this._border.type=q$_[q$a],this._ower._renderType|=256}else this._border=null}),q$t(0,q$_,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(q$S){q$S?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==q$S?null:q$f.create(q$S),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),q$t(0,q$_,"position",function(){return 4&this._type?"absolute":""},function(q$S){"absolute"==q$S?this._type|=4:this._type&=-5}),q$t(0,q$_,"display",null,function(q$S){switch(q$S){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),q$t(0,q$_,"paddingLeft",function(){return this.padding[3]}),q$t(0,q$_,"paddingTop",function(){return this.padding[0]}),q$t(0,q$_,"_scale",null,function(q$S){this._ower.scale(q$S[0],q$S[1])}),q$t(0,q$_,"_rotate",null,function(q$S){this._ower.rotation=q$S}),q$C.parseOneCSS=function(q$S,q$_){for(var q$a,q$R=[],q$J=q$S.split(q$_),q$V=0,q$W=q$J.length;q$V<q$W;q$V++){var q$k=q$J[q$V],q$z=q$k.indexOf(":"),q$b=q$k.substr(0,q$z).replace(/^\s+|\s+$/g,"");if(0!=q$b.length){var q$H=q$k.substr(q$z+1).replace(/^\s+|\s+$/g,""),q$L=[q$b,q$H];switch(q$b){case"italic":case"bold":q$L[1]="true"==q$H;break;case"line-height":q$L[0]="lineHeight",q$L[1]=parseInt(q$H);break;case"font-size":q$L[0]="fontSize",q$L[1]=parseInt(q$H);break;case"padding":1<(q$a=q$H.split(" ")).length||(q$a[1]=q$a[2]=q$a[3]=q$a[0]),q$L[1]=[parseInt(q$a[0]),parseInt(q$a[1]),parseInt(q$a[2]),parseInt(q$a[3])];break;case"rotate":q$L[0]="_rotate",q$L[1]=parseFloat(q$H);break;case"scale":q$a=q$H.split(" "),q$L[0]="_scale",q$L[1]=[parseFloat(q$a[0]),parseFloat(q$a[1])];break;case"translate":q$a=q$H.split(" "),q$L[0]="_translate",q$L[1]=[parseInt(q$a[0]),parseInt(q$a[1])];break;default:(q$L[0]=q$C._CSSTOVALUE[q$b])||(q$L[0]=q$b)}q$R.push(q$L)}}return q$R},q$C.parseCSS=function(q$S,q$_){for(var q$a;null!=(q$a=q$C._parseCSSRegExp.exec(q$S));)q$C.styleSheets[q$a[1]]=q$C.parseOneCSS(q$a[2],";")},q$C.EMPTY=new q$C(null),q$C._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},q$C._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),q$C._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},q$C._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},q$C.styleSheets={},q$C.ALIGN_CENTER=1,q$C.ALIGN_RIGHT=2,q$C.VALIGN_MIDDLE=1,q$C.VALIGN_BOTTOM=2,q$C._CSS_BLOCK=1,q$C._DISPLAY_NONE=2,q$C._ABSOLUTE=4,q$C._WIDTH_SET=8,q$C._PADDING=[0,0,0,0],q$C._RECT=[-1,-1,-1,-1],q$C._SPACING=[0,0],q$C._ALIGNS=[0,0,0],q$C.ADDLAYOUTED=512,q$C._NEWFONT=4096,q$C._HEIGHT_SET=8192,q$C._BACKGROUND_SET=16384,q$C._FLOAT_RIGHT=32768,q$C._LINE_ELEMENT=65536,q$C._NOWARP=131072,q$C._WIDTHAUTO=262144,q$C._LISTERRESZIE=524288,q$C}(q$k),q$aS=function(q$S){function q$W(){this.url=null,this.audio=null,this.loaded=!1,q$W.__super.call(this)}q$H(q$W,"laya.media.h5audio.AudioSound",q$b);var q$_=q$W.prototype;return q$_.dispose=function(){var q$S=q$W._audioCache[this.url];q$S&&(q$S.src="",delete q$W._audioCache[this.url])},q$_.load=function(q$S){var q$_;if(q$S=q$u.formatURL(q$S),(this.url=q$S)==q$I._tMusic?(q$W._initMusicAudio(),(q$_=q$W._musicAudio).src!=q$S&&(q$W._audioCache[q$_.src]=null,q$_=null)):q$_=q$W._audioCache[q$S],q$_&&2<=q$_.readyState)this.event("complete");else{q$_||(q$_=q$S==q$I._tMusic?(q$W._initMusicAudio(),q$W._musicAudio):q$g.createElement("audio"),(q$W._audioCache[q$S]=q$_).src=q$S),q$_.addEventListener("canplaythrough",q$R),q$_.addEventListener("error",q$J);var q$a=this;(this.audio=q$_).load?q$_.load():q$J()}function q$R(){q$V(),q$a.loaded=!0,q$a.event("complete")}function q$J(){q$_.load=null,q$V(),q$a.event("error")}function q$V(){q$_.removeEventListener("canplaythrough",q$R),q$_.removeEventListener("error",q$J)}},q$_.play=function(q$S,q$_,q$a){if(void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),!this.url)return null;var q$R,q$J;if(!(q$R=this.url==q$I._tMusic?q$W._musicAudio:q$W._audioCache[this.url]))return null;q$J=q$p.getItem("audio:"+this.url),q$K.isConchApp?q$J||((q$J=q$g.createElement("audio")).src=this.url):this.url==q$I._tMusic?(q$W._initMusicAudio(),(q$J=q$W._musicAudio).src=this.url):q$J=q$J||q$R.cloneNode(!0);var q$V=new q$CS(q$J);return q$V.url=this.url,q$V.loops=q$_,q$V.startTime=q$S,q$V.startHandler=q$a,q$V.play(!1),q$I.addChannel(q$V),q$V},q$t(0,q$_,"duration",function(){var q$S;return(q$S=q$W._audioCache[this.url])?q$S.duration:0}),q$W._initMusicAudio=function(){q$W._musicAudio||(q$W._musicAudio||(q$W._musicAudio=q$g.createElement("audio")),q$K.isConchApp||q$g.document.addEventListener("mousedown",q$W._makeMusicOK))},q$W._makeMusicOK=function(){q$g.document.removeEventListener("mousedown",q$W._makeMusicOK),q$W._musicAudio.src?q$W._musicAudio.play():(q$W._musicAudio.src="",q$W._musicAudio.load())},q$W._audioCache={},q$W._musicAudio=null,q$W}(),q$RS=function(q$S){function q$_(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,q$_.__super.call(this)}q$H(q$_,"laya.media.SoundChannel",q$b);var q$a=q$_.prototype;return q$a.play=function(){},q$a.stop=function(){},q$a.pause=function(){},q$a.resume=function(){},q$a.__runComplete=function(q$S){q$S&&q$S.run()},q$t(0,q$a,"volume",function(){return 1},function(q$S){}),q$t(0,q$a,"position",function(){return 0}),q$t(0,q$a,"duration",function(){return 0}),q$_}(),q$JS=function(q$S){function q$_(){q$_.__super.call(this)}q$H(q$_,"laya.media.Sound",q$b);var q$a=q$_.prototype;return q$a.load=function(q$S){},q$a.play=function(q$S,q$_,q$a){return void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),null},q$a.dispose=function(){},q$t(0,q$a,"duration",function(){return 0}),q$_}(),q$VS=function(q$S){function q$J(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,q$J.__super.call(this)}q$H(q$J,"laya.media.webaudio.WebAudioSound",q$b);var q$_=q$J.prototype;return q$_.load=function(q$S){this.url=q$S,this.audioBuffer=q$J._dataCache[q$S],this.audioBuffer?this._loaded(this.audioBuffer):(q$J.e.on("loaded:"+q$S,this,this._loaded),q$J.e.on("err:"+q$S,this,this._err),q$J.__loadingSound[q$S]||(q$J.__loadingSound[q$S]=!0,q$q.loader.load(q$S,q$T.create(this,this.onloaded),null,q$kS.BUFFER,4,!1,null,!0)))},q$_.onloaded=function(q$S){q$S||this._err(),this._disposed?this._removeLoadEvents():(this.data=q$S,q$J.buffs.push({buffer:this.data,url:this.url}),q$J.decode())},q$_._err=function(){if(this._removeLoadEvents(),q$J.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var q$S,q$_,q$a,q$R=0;for(q$S=(q$_=this.__toPlays).length,q$R=0;q$R<q$S;q$R++)(q$a=q$_[q$R])[3]&&!q$a[3].isStopped&&q$a[3].event("error");this.__toPlays.length=0}},q$_._loaded=function(q$S){this._removeLoadEvents(),this._disposed||(this.audioBuffer=q$S,this.loaded=!0,this.event("complete"))},q$_._removeLoadEvents=function(){q$J.e.off("loaded:"+this.url,this,this._loaded),q$J.e.off("err:"+this.url,this,this._err)},q$_.__playAfterLoaded=function(){if(this.__toPlays){var q$S,q$_,q$a,q$R=0;for(q$S=(q$_=this.__toPlays).length,q$R=0;q$R<q$S;q$R++)(q$a=q$_[q$R])[3]&&!q$a[3].isStopped&&this.play(q$a[0],q$a[1],q$a[2],q$a[3]);this.__toPlays.length=0}},q$_.play=function(q$S,q$_,q$a,q$R){return void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),q$R=q$R||new q$GS,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([q$S,q$_,q$a,q$R]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),q$R.url=this.url,q$R.loops=q$_,q$R.audioBuffer=this.audioBuffer,q$R.startTime=q$S,q$R.startHandler=q$a,q$R.play(!1),q$I.addChannel(q$R),q$R},q$_.dispose=function(){this._disposed=!0,delete q$J._dataCache[this.url],delete q$J.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},q$t(0,q$_,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),q$J.decode=function(){if(!(q$J.buffs.length<=0||q$J.isDecoding))if(q$J.isDecoding=!0,(q$J.tInfo=q$J.buffs.shift())&&q$J.tInfo.buffer&&q$J.tInfo.buffer.byteLength)try{q$J.ctx.decodeAudioData(q$J.tInfo.buffer,q$J._done,q$J._fail)}catch(q$S){console.error("decodeAudioData error  byteLength:"+q$J.tInfo.buffer.byteLength+"  url:"+q$J.tInfo.url)}else q$J._fail()},q$J._done=function(q$S){q$J.e.event("loaded:"+q$J.tInfo.url,q$S),q$J._dataCache[q$J.tInfo.url]=q$S,q$J.isDecoding=!1,q$J.decode()},q$J._fail=function(){q$J.e.event("err:"+q$J.tInfo.url,null),q$J.isDecoding=!1,q$J.decode()},q$J._playEmptySound=function(){if(null!=q$J.ctx){if(q$J._emptySource&&(q$J._emptySource.stop(),q$J._emptySource.disconnect(0),!q$GS._tryCleanFailed))try{q$J._emptySource.buffer=null}catch(q$S){q$GS._tryCleanFailed=!0}var q$S=q$J.ctx.createBufferSource();q$S.buffer=q$J._miniBuffer,q$S.connect(q$J.ctx.destination),q$S.start(0,0,0),q$J._emptySource=q$S}},q$J._unlock=function(){q$J._unlocked||(q$J._playEmptySound(),"running"==q$J.ctx.state?(q$g.document.removeEventListener("mousedown",q$J._unlock,!0),q$g.document.removeEventListener("touchend",q$J._unlock,!0),q$g.document.removeEventListener("touchstart",q$J._unlock,!0),q$J._unlocked=!0):"suspended"==q$J.ctx.state&&q$I._recoverWebAudio())},q$J.initWebAudio=function(){"running"!=q$J.ctx.state&&(q$J._unlock(),q$g.document.addEventListener("mousedown",q$J._unlock,!0),q$g.document.addEventListener("touchend",q$J._unlock,!0),q$g.document.addEventListener("touchstart",q$J._unlock,!0))},q$J._emptySource=null,q$J._dataCache={},q$J.buffs=[],q$J.isDecoding=!1,q$J._unlocked=!1,q$J.tInfo=null,q$J.__loadingSound={},q$z(q$J,["window",function(){return this.window=q$g.window},"webAudioEnabled",function(){return this.webAudioEnabled=q$J.window.AudioContext||q$J.window.webkitAudioContext||q$J.window.mozAudioContext},"ctx",function(){return this.ctx=q$J.webAudioEnabled?new(q$J.window.AudioContext||q$J.window.webkitAudioContext||q$J.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=q$J.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new q$b}]),q$J}(),q$WS=function(q$S){function q$_(){this._responseType=null,this._data=null,q$_.__super.call(this),this._http=new q$g.window.XMLHttpRequest}q$H(q$_,"laya.net.HttpRequest",q$b);var q$a=q$_.prototype;return q$a.send=function(q$S,q$_,q$a,q$R,q$J){void 0===q$a&&(q$a="get"),void 0===q$R&&(q$R="text"),this._responseType=q$R,this._data=null;var q$V=this,q$W=this._http;if(q$W.open(q$a,q$S,!0),q$J)for(var q$k=0;q$k<q$J.length;q$k++)q$W.setRequestHeader(q$J[q$k++],q$J[q$k]);else q$K.isConchApp||(q$_&&"string"!=typeof q$_?q$W.setRequestHeader("Content-Type","application/json"):q$W.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));q$W.responseType="arraybuffer"!==q$R?"text":"arraybuffer",q$W.onerror=function(q$S){q$V._onError(q$S)},q$W.onabort=function(q$S){q$V._onAbort(q$S)},q$W.onprogress=function(q$S){q$V._onProgress(q$S)},q$W.onload=function(q$S){q$V._onLoad(q$S)},q$W.send(q$_)},q$a._onProgress=function(q$S){q$S&&q$S.lengthComputable&&this.event("progress",q$S.loaded/q$S.total)},q$a._onAbort=function(q$S){this.error("Request was aborted by user")},q$a._onError=function(q$S){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},q$a._onLoad=function(q$S){var q$_=this._http,q$a=void 0!==q$_.status?q$_.status:200;200===q$a||204===q$a||0===q$a?this.complete():this.error("["+q$_.status+"]"+q$_.statusText+":"+q$_.responseURL)},q$a.error=function(q$S){this.clear(),this.event("error",q$S)},q$a.complete=function(){this.clear();var q$_=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=q$O.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(q$S){q$_=!1,this.error(q$S.message)}q$_&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},q$a.clear=function(){var q$S=this._http;q$S.onerror=q$S.onabort=q$S.onprogress=q$S.onload=null},q$t(0,q$a,"url",function(){return this._http.responseURL}),q$t(0,q$a,"http",function(){return this._http}),q$t(0,q$a,"data",function(){return this._data}),q$_}(),q$kS=function(q$S){function q$l(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,q$l.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}q$H(q$l,"laya.net.Loader",q$b);var q$_=q$l.prototype;return q$_.load=function(q$S,q$_,q$a,q$R,q$J){if(q$S&&""!=q$S||console.error("Loader 加载的url不合法 "+q$S),void 0===q$a&&(q$a=!0),void 0===q$J&&(q$J=!1),0===(this._url=q$S).indexOf("data:image")?this._type=q$_="image":this._type=q$_||(q$_=this.getTypeFromUrl(q$S)),this._cache=q$a,this._data=null,!q$J&&q$l.loadedMap[q$S])return this._data=q$l.loadedMap[q$S],this.event("progress",1),void this.event("complete",this._data);if(q$R&&q$l.setGroup(q$S,q$R),null!=q$l.parserMap[q$_])return this._customParse=!0,void(q$l.parserMap[q$_]instanceof laya.utils.Handler?q$l.parserMap[q$_].runWith(this):q$l.parserMap[q$_].call(null,this));if("image"===q$_||"htmlimage"===q$_||"nativeimage"===q$_)return this._loadImage(q$S);if("ttf"===q$_)return this._loadTTF(q$S);switch(q$_){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:q$_}q$l.preLoadedMap[q$S]?this.onLoaded(q$l.preLoadedMap[q$S]):q$W.resMgrLoad(q$S,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},q$_.getTypeFromUrl=function(q$S){var q$_=q$O.getFileExtension(q$S);return q$_?q$l.typeMap[q$_]:(console.warn("Not recognize the resources suffix",q$S),"text")},q$_._loadTTF=function(q$S){q$S=q$u.formatURL(q$S);var q$_=new q$h;q$_.complete=q$T.create(this,this.onLoaded),q$_.load(q$S)},q$_._loadImage=function(q$S){q$W.imgMgrLoad(q$S,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},q$_._loadImageComplete=function(q$S,q$_,q$a){if(null!=q$a)if(q$a instanceof ArrayBuffer){var q$R=new DataView(q$a),q$J=new laya.webgl.resource.WebGLImage(new Uint8Array(q$a,8),q$S,0,!1,q$R.getUint32(0),q$R.getUint32(4));this.onLoaded(q$J)}else if(q$a instanceof q$HS)q$l.imgMgrSet[q$S]=q$_,q$W.imgMgrLock(q$S,q$l.imgMgrSet[q$S]),this._url=q$S,this.complete(q$a);else{var q$V=-1!=q$S.indexOf(".png",q$S.length-4)?6408:6407;q$J=new laya.webgl.resource.WebGLImage(q$a,q$S,q$V,!1,q$a.width,q$a.height);this.onLoaded(q$J)}else this.event("error","Load image failed")},q$_.imageCancel=function(q$S,q$_,q$a){q$W.imgMgrCancel(q$S,this._onImageCallback)},q$_._loadSound=function(q$S){var q$_=new q$I._soundClass,q$a=this;function q$R(){q$_.offAll()}q$_.on("complete",this,function(){q$R(),q$a.onLoaded(q$_)}),q$_.on("error",this,function(){q$R(),q$_.dispose(),q$a.event("error","Load sound failed")}),q$_.load(q$S)},q$_.onProgress=function(q$S){"atlas"===this._type?this.event("progress",.3*q$S):this.event("progress",q$S)},q$_.onError=function(q$S){this.event("error",q$S)},q$_._loadedComplete=function(q$S,q$_,q$a){if(null!=q$a)switch(this._type){case"atlas":case"plf":case"json":var q$R=new q$x(q$a);this.onLoaded(JSON.parse(q$R.readUTFBytes()));break;case"font":q$R=new q$x(q$a);this.onLoaded(q$O.parseXMLFromString(q$R.readUTFBytes()));break;default:this.onLoaded(q$a)}else this.event("error",q$S)},q$_.onLoaded=function(q$S){var q$_=this._type;if("plf"==q$_)this.parsePLFData(q$S),this.complete(q$S);else if("image"===q$_){var q$a=new q$HS(q$S);q$a.url=this._url,this.complete(q$a)}else if("sound"===q$_||"htmlimage"===q$_||"nativeimage"===q$_)this.complete(q$S);else if("atlas"===q$_){if(!q$S.src&&!q$S._setContext){if(!this._data){if((this._data=q$S).meta&&q$S.meta.image)for(var q$R=q$S.meta.image.split(","),q$J=0<=this._url.indexOf("/")?"/":"\\",q$V=this._url.lastIndexOf(q$J),q$W=0<=q$V?this._url.substr(0,q$V+1):"",q$k=0,q$z=q$R.length;q$k<q$z;q$k++)q$R[q$k]=q$W+q$R[q$k];else q$R=[this._url.replace(".json",".png")];q$R.reverse(),q$S.toLoads=q$R,q$S.pics=[]}return this.event("progress",.3+1/q$R.length*.6),this._loadImage(q$R.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(q$S),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var q$b=this._data.frames,q$H=this._url.split("?")[0],q$L=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:q$H.substring(0,q$H.lastIndexOf("."))+"/",q$C=this._data.pics,q$G=q$u.formatURL(this._url),q$t=q$l.atlasMap[q$G]||(q$l.atlasMap[q$G]=[]);q$t.dir=q$L;var q$o=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var q$$ in q$o=parseFloat(this._data.meta.scale),q$b){var q$F,q$T=q$b[q$$],q$D=q$C[q$T.frame.idx?q$T.frame.idx:0],q$j=q$u.formatURL(q$L+q$$);q$D.scaleRate=q$o,q$F=q$HS.create(q$D,q$T.frame.x,q$T.frame.y,q$T.frame.w,q$T.frame.h,q$T.spriteSourceSize.x,q$T.spriteSourceSize.y,q$T.sourceSize.w,q$T.sourceSize.h),q$l.cacheRes(q$j,q$F),q$l.keepCache(this._url,q$L+q$$),q$F.url=q$j,q$t.push(q$j)}else for(q$$ in q$b)q$D=q$C[(q$T=q$b[q$$]).frame.idx?q$T.frame.idx:0],q$j=q$u.formatURL(q$L+q$$),q$l.cacheRes(q$j,q$HS.create(q$D,q$T.frame.x,q$T.frame.y,q$T.frame.w,q$T.frame.h,q$T.spriteSourceSize.x,q$T.spriteSourceSize.y,q$T.sourceSize.w,q$T.sourceSize.h)),q$l.loadedMap[q$j].url=q$j,q$l.keepCache(this._url,q$L+q$$),q$t.push(q$j);delete this._data.pics,this.complete(this._data)}else if("font"==q$_){if(!q$S.src)return this._data=q$S,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var q$Q=new q$B;q$Q.parseFont(this._data,q$S);var q$m=this._url.split(".fnt")[0].split("/"),q$q=q$m[q$m.length-1];q$$S.registerBitmapFont(q$q,q$Q),this._data=q$Q,this.complete(this._data)}else if("pkm"==q$_){var q$N=q$mS.create(q$S,this._url),q$n=new q$HS(q$N);q$n.url=this._url,this.complete(q$n)}else this.complete(q$S)},q$_.parsePLFData=function(q$S){var q$_,q$a,q$R;for(q$_ in q$S)switch(q$R=q$S[q$_],q$_){case"json":case"text":for(q$a in q$R)q$l.preLoadedMap[q$u.formatURL(q$a)]=q$R[q$a];break;default:for(q$a in q$R)q$l.preLoadedMap[q$u.formatURL(q$a)]=q$R[q$a]}},q$_.complete=function(q$S){this._data=q$S,this._customParse?this.event("loaded",q$S instanceof Array?[q$S]:q$S):(q$l._loaders.push(this),q$l._isWorking||q$l.checkNext())},q$_.endLoad=function(q$S){q$S&&(this._data=q$S),this._cache&&q$l.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},q$t(0,q$_,"url",function(){return this._url}),q$t(0,q$_,"data",function(){return this._data}),q$t(0,q$_,"cache",function(){return this._cache}),q$t(0,q$_,"type",function(){return this._type}),q$l.checkNext=function(){q$l._isWorking=!0;for(var q$S=q$g.now();q$l._startIndex<q$l._loaders.length;)if(q$g.now(),q$l._loaders[q$l._startIndex].endLoad(),q$l._startIndex++,q$g.now()-q$S>q$l.maxTimeOut)return console.warn("loader callback cost a long time:"+(q$g.now()-q$S)+" url="+q$l._loaders[q$l._startIndex-1].url),void q$q.timer.frameOnce(1,null,q$l.checkNext);q$l._loaders.length=0,q$l._startIndex=0,q$l._isWorking=!1},q$l.clearRes=function(q$S,q$_){if(null!=q$S){void 0===q$_&&(q$_=!1),q$S=q$u.formatURL(q$S);var q$a=q$l.getAtlas(q$S);if(q$a){for(var q$R=0,q$J=q$a.length;q$R<q$J;q$R++){var q$V=q$a[q$R],q$W=q$l.getRes(q$V);delete q$l.loadedMap[q$V],q$l.clearCache(q$S.substring(q$u.basePath.length),q$V.substring(q$u.basePath.length)),q$W&&q$W.destroy(q$_)}q$a.length=0,delete q$l.atlasMap[q$S],delete q$l.loadedMap[q$S]}else{var q$k=q$l.loadedMap[q$S];q$k&&(delete q$l.loadedMap[q$S],q$k instanceof laya.resource.Texture&&q$k.bitmap&&q$k.destroy(q$_))}}},q$l.clearTextureRes=function(q$S){q$S=q$u.formatURL(q$S);var q$_=laya.net.Loader.getAtlas(q$S),q$a=q$_&&0<q$_.length?laya.net.Loader.getRes(q$_[0]):laya.net.Loader.getRes(q$S);q$a&&q$a.bitmap&&(q$K.isConchApp&&!q$K.isConchWebGL?q$a.bitmap.source.releaseTexture&&q$a.bitmap.source.releaseTexture():null==q$a.bitmap._atlaser&&q$a.bitmap.releaseResource(!0))},q$l.getRes=function(q$S){return q$l.loadedMap[q$u.formatURL(q$S)]},q$l.getAtlas=function(q$S){return q$l.atlasMap[q$u.formatURL(q$S)]},q$l.cacheRes=function(q$S,q$_){q$S=q$u.formatURL(q$S),null!=q$l.loadedMap[q$S]?console.warn("Resources already exist,is repeated loading:",q$S):q$l.loadedMap[q$S]=q$_},q$l.setGroup=function(q$S,q$_){q$l.groupMap[q$_]||(q$l.groupMap[q$_]=[]),q$l.groupMap[q$_].push(q$S)},q$l.clearResByGroup=function(q$S){if(q$l.groupMap[q$S]){var q$_=q$l.groupMap[q$S],q$a=0,q$R=q$_.length;for(q$a=0;q$a<q$R;q$a++)q$l.clearRes(q$_[q$a]);q$_.length=0}},q$l.keepCache=function(q$S,q$_){if(q$S&&q$_){var q$a=q$l.cacheSet[q$_];q$a?-1==q$a.indexOf(q$S)&&q$a.push(q$S):q$l.cacheSet[q$_]=[q$S]}},q$l.clearCache=function(q$S,q$_){if(q$S&&q$_){var q$a=q$l.cacheSet[q$_];if(q$a){var q$R=q$a.indexOf(q$S);if(-1!==q$R){var q$J=q$a.length-1;0==q$J?(delete q$l.cacheSet[q$_],0<q$l.imgMgrSet[q$_]?q$W.imgMgrFree(q$_,q$l.imgMgrSet[q$_]):q$l.clearRes(q$_,!0)):(q$a[q$R]=q$a[q$J],q$a.length=q$J)}}}},q$l.saveObject=function(q$S,q$_,q$a){if(q$_&&q$S){var q$R=q$l.objectSet[q$S];q$R?(console.warn("Loader.saveObject: "+q$S),q$R[0]=q$_,q$R[1]=q$a):q$l.objectSet[q$S]=[q$_,q$a,[]]}},q$l.findObject=function(q$S){if(q$S){var q$_=q$l.objectSet[q$S];if(q$_)return q$_[0]}return null},q$l.keepObject=function(q$S,q$_){if(q$S&&q$_){var q$a=q$l.objectSet[q$_];q$a&&-1===q$a[2].indexOf(q$S)&&q$a[2].push(q$S)}},q$l.clearObject=function(q$S,q$_){if(q$S&&q$_){var q$a=q$l.objectSet[q$_];if(q$a){var q$R=q$a[2],q$J=q$R.indexOf(q$S);if(-1!==q$J){var q$V=q$R.length-1;0==q$V?(delete q$l.objectSet[q$_],q$a[1]&&q$a[1].call(null,q$a[0])):(q$R[q$J]=q$R[q$V],q$R.length=q$V)}}}},q$l.TEXT="text",q$l.JSON="json",q$l.XML="xml",q$l.BUFFER="arraybuffer",q$l.IMAGE="image",q$l.SOUND="sound",q$l.ATLAS="atlas",q$l.FONT="font",q$l.TTF="ttf",q$l.PLF="plf",q$l.PKM="pkm",q$l.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},q$l.parserMap={},q$l.groupMap={},q$l.maxTimeOut=100,q$l.loadedMap={},q$l.preLoadedMap={},q$l.atlasMap={},q$l._loaders=[],q$l._isWorking=!1,q$l._startIndex=0,q$l.imgCache={},q$l.cacheSet={},q$l.objectSet={},q$l.imgMgrSet={},q$l}(),q$zS=function(q$S){var q$C;function q$G(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},q$G.__super.call(this);for(var q$S=0;q$S<this._maxPriority;q$S++)this._resInfos[q$S]=[]}q$H(q$G,"laya.net.LoaderManager",q$b);var q$_=q$G.prototype;return q$_.create=function(q$S,q$a,q$_,q$R,q$J,q$V,q$W,q$k){if(null==q$V&&(q$V=2),null==q$W&&(q$W=!0),q$S instanceof Array){var q$z=q$S,q$b=q$z.length,q$H=0;if(q$_)var q$L=q$T.create(q$_.caller,q$_.method,q$_.args,!1);for(var q$C=0;q$C<q$b;q$C++){var q$G=q$z[q$C];"string"==typeof q$G&&(q$G=q$z[q$C]={url:q$G}),q$G.progress=0}for(q$C=0;q$C<q$b;q$C++){q$G=q$z[q$C];var q$t=q$_?q$T.create(null,q$F,[q$G],!1):null,q$o=q$_||q$a?q$T.create(null,q$$,[q$G]):null;this._create(q$G.url,q$o,q$t,q$G.clas||q$R,q$G.params||q$J,null!=q$G.priority&&0<=q$G.priority?q$G.priority:q$V,q$W,q$G.group||q$k)}function q$$(q$S,q$_){q$H++,q$S.progress=1,q$H===q$b&&q$a&&q$a.run()}function q$F(q$S,q$_){q$S.progress=q$_;for(var q$a=0,q$R=0;q$R<q$b;q$R++){q$a+=q$z[q$R].progress}var q$J=q$a/q$b;q$L.runWith(q$J)}return!0}return this._create(q$S,q$a,q$_,q$R,q$J,q$V,q$W,q$k)},q$_._create=function(q$_,q$a,q$S,q$R,q$J,q$V,q$W,q$k){q$_&&""!=q$_||console.error("加载的url不合法 "+q$_),null==q$V&&(q$V=2),null==q$W&&(q$W=!0);var q$z=q$u.formatURL(q$_),q$b=this.getRes(q$z);if(q$b)!q$b.hasOwnProperty("loaded")||q$b.loaded?(q$S&&q$S.runWith(1),q$a&&q$a.run()):q$a&&q$q.loader._createListener(q$_,q$a.caller,q$a.method,q$a.args,!0,!1);else{var q$H=q$O.getFileExtension(q$_),q$L=q$G.createMap[q$H];if(!q$L)throw new Error("LoaderManager:unknown file("+q$_+") extension with: "+q$H+".");q$R||(q$R=q$L[0]);var q$C=q$L[1];if("atlas"==q$H)this.load(q$_,q$a,q$S,q$C,q$V,q$W);else{q$R===q$HS&&(q$C="htmlimage"),(q$b=q$R?new q$R:null).hasOwnProperty("_loaded")&&(q$b._loaded=!1),q$b._setUrl(q$_),q$k&&q$b._setGroup(q$k),this._createLoad(q$b,q$_,q$T.create(null,function(q$S){q$b&&!q$b.destroyed&&q$S&&q$b.onAsynLoaded.call(q$b,q$_,q$S,q$J),q$a&&q$a.run();q$q.loader.event(q$_)}),q$S,q$C,q$V,!1,q$k,!0),q$W&&this.cacheRes(q$z,q$b)}}return q$b},q$_.load=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){q$S&&""!=q$S||console.error("加载的url不合法 "+q$S);var q$z=this;if(null==q$J&&(q$J=2),null==q$V&&(q$V=!0),void 0===q$k&&(q$k=!1),q$S instanceof Array)return this._loadAssets(q$S,q$_,q$a,q$R,q$J,q$V,q$W);var q$b=q$kS.getRes(q$S);if(null!=q$b)q$q.timer.frameOnce(1,null,function(){q$a&&q$a.runWith(1),q$_&&q$_.runWith(q$b),q$z._loaderCount||q$z.event("complete")});else{var q$H=q$G._resMap[q$S];q$H?(q$_&&q$H._createListener("complete",q$_.caller,q$_.method,q$_.args,!1,!1),q$a&&q$H._createListener("progress",q$a.caller,q$a.method,q$a.args,!1,!1)):((q$H=this._infoPool.length?this._infoPool.pop():new q$C).url=q$S,q$H.clas=null,q$H.type=q$R,q$H.cache=q$V,q$H.group=q$W,q$H.ignoreCache=q$k,q$H.priority=q$J,q$_&&q$H.on("complete",q$_.caller,q$_.method,q$_.args),q$a&&q$H.on("progress",q$a.caller,q$a.method,q$a.args),q$G._resMap[q$S]=q$H,q$J=q$J<this._maxPriority?0<=q$J?q$J:0:this._maxPriority-1,this._resInfos[q$J].push(q$H),this._next())}return this},q$_.cancel=function(q$S,q$_,q$a){if(q$b=q$G._resMap[q$S]){q$_&&q$b.off("complete",q$_.caller,q$_.method,!1),q$a&&q$b.off("progress",q$a.caller,q$a.method,!1);var q$R=q$b.getListener("complete"),q$J=q$b.getListener("progress");if(!(q$R&&q$R.head||q$J&&q$J.head)){if(q$b.loader){var q$V=q$b.loader;q$V.imageCancel(q$S),q$V.offAll(),q$V._data=null,q$V._customParse=!1,q$V._url=null,q$V._class=null,q$V._type=null,this._loaders.push(q$V),this._loaderCount--,delete this._loaderMap[q$b.url]}for(var q$W=0;q$W<this._maxPriority;q$W++)for(var q$k=this._resInfos[q$W],q$z=q$k.length-1;-1<q$z;q$z--){var q$b;(q$b=q$k[q$z])&&q$b.url===q$S&&(q$k[q$z]=null,q$b.destroy(),q$b.offAll(),this._infoPool.push(q$b))}delete q$G._resMap[q$S],this._next()}}},q$_._createLoad=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){var q$b=this;if(null==q$V&&(q$V=2),null==q$W&&(q$W=!0),void 0===q$z&&(q$z=!1),q$_ instanceof Array)return this._loadAssets(q$_,q$a,q$R,q$J,q$V,q$W,q$k);var q$H=q$kS.getRes(q$_);if(null!=q$H)q$q.timer.frameOnce(1,null,function(){q$R&&q$R.runWith(1),q$a&&q$a.runWith(q$H),q$b._loaderCount||q$b.event("complete")});else{var q$L=q$G._resMap[q$_];q$L?(q$a&&q$L._createListener("complete",q$a.caller,q$a.method,q$a.args,!1,!1),q$R&&q$L._createListener("progress",q$R.caller,q$R.method,q$R.args,!1,!1)):((q$L=this._infoPool.length?this._infoPool.pop():new q$C).url=q$_,q$L.clas=q$S,q$L.type=q$J,q$L.cache=q$W,q$L.group=q$k,q$L.ignoreCache=q$z,q$L.priority=q$V,q$a&&q$L.on("complete",q$a.caller,q$a.method,q$a.args),q$R&&q$L.on("progress",q$R.caller,q$R.method,q$R.args),q$G._resMap[q$_]=q$L,q$V=q$V<this._maxPriority?0<=q$V?q$V:0:this._maxPriority-1,this._resInfos[q$V].push(q$L),this._next())}return this},q$_._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var q$S=0;q$S<this._maxPriority;q$S++)for(var q$_=this._resInfos[q$S];0<q$_.length;){var q$a=q$_.shift();if(q$a)return this._doLoad(q$a)}this._loaderCount||this.event("complete")}},q$_._doLoad=function(q$_){var q$a=this._loaders.length?this._loaders.pop():new q$kS;this._loaderCount++,(this._loaderMap[q$_.url]=q$a).on("complete",null,q$J),q$a.on("progress",null,function(q$S){q$_.event("progress",q$S)}),q$a.on("error",null,function(q$S){q$J(null)}),q$_.loader=q$a;var q$R=this;function q$J(q$S){q$a.offAll(),q$a._data=null,q$a._customParse=!1,q$a._url=null,q$a._class=null,q$a._type=null,q$R._loaders.push(q$a),q$R._loaderCount--,delete q$R._loaderMap[q$_.url],q$R._endLoad(q$_,q$S instanceof Array?[q$S]:q$S),q$R._next()}q$a._class=q$_.clas,1<=q$_.priority?(q$a.priority=q$_.priority,q$a.realTime=!1):(q$a.priority=0,q$a.realTime=!0),q$a.load(q$_.url,q$_.type,q$_.cache,q$_.group,q$_.ignoreCache)},q$_._endLoad=function(q$S,q$_){var q$a=q$S.url;if(null==q$_){var q$R=this._failRes[q$a]||0;if(q$R<this.retryNum)return console.warn("[warn]Retry to load:",q$a),this._failRes[q$a]=q$R+1,void q$q.timer.once(this.retryDelay,this,this._addReTry,[q$S],!1);console.warn("[error]Failed to load:",q$a),this.event("error",q$a)}this._failRes[q$a]&&(this._failRes[q$a]=0),delete q$G._resMap[q$a],q$S.event("complete",q$_),q$S.destroy(),q$S.offAll(),this._infoPool.push(q$S)},q$_._addReTry=function(q$S){this._resInfos[this._maxPriority-1].push(q$S),this._next()},q$_.clearRes=function(q$S,q$_){void 0===q$_&&(q$_=!1),q$kS.clearRes(q$S,q$_)},q$_.getRes=function(q$S){return q$kS.getRes(q$S)},q$_.cacheRes=function(q$S,q$_){q$kS.cacheRes(q$S,q$_)},q$_.clearTextureRes=function(q$S){q$kS.clearTextureRes(q$S)},q$_.setGroup=function(q$S,q$_){q$kS.setGroup(q$S,q$_)},q$_.clearResByGroup=function(q$S){q$kS.clearResByGroup(q$S)},q$_.clearUnLoaded=function(){for(var q$S=0;q$S<this._maxPriority;q$S++){for(var q$_=this._resInfos[q$S],q$a=q$_.length-1;-1<q$a;q$a--){var q$R=q$_[q$a];q$R&&(q$R.destroy(),q$R.offAll(),this._infoPool.push(q$R))}q$_.length=0}this._loaderCount=0,q$G._resMap={}},q$_.cancelLoadByUrls=function(q$S){if(q$S)for(var q$_=0,q$a=q$S.length;q$_<q$a;q$_++)this.cancelLoadByUrl(q$S[q$_])},q$_.cancelLoadByUrl=function(q$S){for(var q$_=0;q$_<this._maxPriority;q$_++)for(var q$a=this._resInfos[q$_],q$R=q$a.length-1;-1<q$R;q$R--){var q$J=q$a[q$R];q$J&&q$J.url===q$S&&(q$a[q$R]=null,q$J.destroy(),q$J.offAll(),this._infoPool.push(q$J))}q$G._resMap[q$S]&&delete q$G._resMap[q$S]},q$_._loadAssets=function(q$S,q$a,q$W,q$_,q$R,q$J,q$V){null==q$R&&(q$R=2),null==q$J&&(q$J=!0);for(var q$k=q$S.length,q$z=0,q$b=0,q$H=[],q$L=!0,q$C=0;q$C<q$k;q$C++){var q$G=q$S[q$C];if(!q$G)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+q$S);"string"==typeof q$G&&(q$G={url:q$G,type:q$_,size:1,priority:q$R}),q$G.size||(q$G.size=1),q$G.progress=0,q$b+=q$G.size,q$H.push(q$G);var q$t=q$W?q$T.create(null,q$F,[q$G],!1):null,q$o=q$a||q$W?q$T.create(null,q$$,[q$G]):null;this.load(q$G.url,q$o,q$t,q$G.type,null!=q$G.priority&&0<=q$G.priority?q$G.priority:2,q$J,q$G.group||q$V)}function q$$(q$S,q$_){q$z++,q$S.progress=1,q$_||(q$L=!1),q$z===q$k&&q$a&&q$a.runWith(q$L)}function q$F(q$S,q$_){if(null!=q$W){q$S.progress=q$_;for(var q$a=0,q$R=0;q$R<q$H.length;q$R++){var q$J=q$H[q$R];q$a+=q$J.size*q$J.progress}var q$V=q$a/q$b;q$W.runWith(q$V)}}return this},q$G.cacheRes=function(q$S,q$_){q$kS.cacheRes(q$S,q$_)},q$G._resMap={},q$z(q$G,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),q$G.__init$=function(){q$C=function(q$S){function q$_(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,q$_.__super.call(this)}return q$H(q$_,"",q$b),q$_.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},q$_}()},q$G}(),q$bS=(function(q$S){function q$J(q$S){q$J.__super.call(this),q$S||(q$S=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var q$_=0,q$a=0,q$R=0;q$R<20;q$R++)q$R%5!=4?this._mat[q$_++]=q$S[q$R]:this._alpha[q$a++]=q$S[q$R];this._action=q$A.createFilterAction(32),this._action.data=this}q$H(q$J,"laya.filters.ColorFilter",q$F);var q$_=q$J.prototype;q$q.imps(q$_,{"laya.filters.IFilter":!0}),q$_.callNative=function(q$S){q$S._$P.cf=this;q$S.conchModel&&q$S.conchModel.setFilterMatrix&&q$S.conchModel.setFilterMatrix(this._mat,this._alpha)},q$t(0,q$_,"type",function(){return 32}),q$t(0,q$_,"action",function(){return this._action})}(),function(q$S){function q$R(q$S,q$_,q$a){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===q$_&&(q$_=0),q$R.__super.call(this),this._byteClass=q$a||q$x,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,q$S&&0<q$_&&q$_<65535&&this.connect(q$S,q$_)}q$H(q$R,"laya.net.Socket",q$b);var q$_=q$R.prototype;q$_.connect=function(q$S,q$_){var q$a="ws://"+q$S+":"+q$_;q$a="https:"==q$g.window.location.protocol?"wss://"+q$S+":"+q$_:"ws://"+q$S+":"+q$_,this.connectByUrl(q$a)},q$_.connectByUrl=function(q$S){var q$_=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new q$g.window.WebSocket(q$S,this.protocols):this._socket=new q$g.window.WebSocket(q$S),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(q$S){q$_._onOpen(q$S)},this._socket.onmessage=function(q$S){q$_._onMessage(q$S)},this._socket.onclose=function(q$S){q$_._onClose(q$S)},this._socket.onerror=function(q$S){q$_._onError(q$S)}},q$_.cleanSocket=function(){try{this._socket.close()}catch(q$S){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},q$_.close=function(){if(null!=this._socket)try{this._socket.close()}catch(q$S){}},q$_._onOpen=function(q$S){this._connected=!0,this.event("open",q$S)},q$_._onMessage=function(q$S){if(q$S&&q$S.data){var q$_=q$S.data;if(this.disableInput&&q$_)this.event("message",q$_);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var q$a=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,q$_&&("string"==typeof q$_?this._input.writeUTFBytes(q$_):this._input.writeArrayBuffer(q$_),this._addInputPosition=this._input.pos,this._input.pos=q$a),this.event("message",q$_)}}},q$_._onClose=function(q$S){this._connected=!1,this.event("close",q$S)},q$_._onError=function(q$S){this.event("error",q$S)},q$_.send=function(q$S){this._socket.send(q$S)},q$_.flush=function(){if(this._output&&0<this._output.length){var q$_;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(q$S){q$_=q$S}this._output.endian=this.endian,this._output.clear(),q$_&&this.event("error",q$_)}},q$t(0,q$_,"input",function(){return this._input}),q$t(0,q$_,"output",function(){return this._output}),q$t(0,q$_,"connected",function(){return this._connected}),q$t(0,q$_,"endian",function(){return this._endian},function(q$S){this._endian=q$S,null!=this._input&&(this._input.endian=q$S),null!=this._output&&(this._output.endian=q$S)}),q$R.LITTLE_ENDIAN="littleEndian",q$R.BIG_ENDIAN="bigEndian"}(),function(q$S){function q$k(){q$k.__super.call(this),this._$1__id=++q$k._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(q$k._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,q$e.currentResourceManager&&q$e.currentResourceManager.addResource(this)}q$H(q$k,"laya.resource.Resource",q$b);var q$_=q$k.prototype;return q$q.imps(q$_,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),q$_._setUrl=function(q$S){var q$_;this._url!==q$S&&(this._url&&((q$_=q$k._urlResourcesMap[this._url]).splice(q$_.indexOf(this),1),0===q$_.length&&delete q$k._urlResourcesMap[this._url]),q$S&&((q$_=q$k._urlResourcesMap[q$S])||(q$k._urlResourcesMap[q$S]=q$_=[]),q$_.push(this)),this._url=q$S)},q$_._getGroup=function(){return this._group},q$_._setGroup=function(q$S){var q$_;this._group!==q$S&&(this._group&&((q$_=q$k._groupResourcesMap[this._group]).splice(q$_.indexOf(this),1),0===q$_.length&&delete q$k._groupResourcesMap[this._group]),q$S&&((q$_=q$k._groupResourcesMap[q$S])||(q$k._groupResourcesMap[q$S]=q$_=[]),q$_.push(this)),this._group=q$S)},q$_._addReference=function(){this._referenceCount++},q$_._removeReference=function(){this._referenceCount--},q$_._clearReference=function(){this._referenceCount=0},q$_._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},q$_.recreateResource=function(){this.completeCreate()},q$_.disposeResource=function(){},q$_.activeResource=function(q$S){void 0===q$S&&(q$S=!1),this._lastUseFrameCount=q$c.loopCount,!this._destroyed&&this.__loaded&&(this._released||q$S)&&this.recreateResource()},q$_.releaseResource=function(q$S){return void 0===q$S&&(q$S=!0),!(!q$S&&this.lock)&&(!(this._released&&!q$S)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},q$_.onAsynLoaded=function(q$S,q$_,q$a){throw new Error("Resource: must override this function!")},q$_.destroy=function(){var q$S;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete q$k._idResourcesMap[this.id],this._url&&((q$S=q$k._urlResourcesMap[this._url])&&(q$S.splice(q$S.indexOf(this),1),0===q$S.length&&delete q$k._urlResourcesMap[this.url]),q$kS.clearRes(this._url),this.__loaded||q$A.cancelLoadByUrl(this._url)),this._group&&((q$S=q$k._groupResourcesMap[this._group]).splice(q$S.indexOf(this),1),0===q$S.length&&delete q$k._groupResourcesMap[this.url]))},q$_.completeCreate=function(){this._released=!1,this.event("recovered",this)},q$_.dispose=function(){this.destroy()},q$t(0,q$_,"memorySize",function(){return this._memorySize},function(q$S){var q$_=q$S-this._memorySize;this._memorySize=q$S,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,q$_),this.resourceManager&&this.resourceManager.addSize(q$_)}),q$t(0,q$_,"_loaded",null,function(q$S){this.__loaded=q$S}),q$t(0,q$_,"loaded",function(){return this.__loaded}),q$t(0,q$_,"id",function(){return this._$1__id}),q$t(0,q$_,"destroyed",function(){return this._destroyed}),q$t(0,q$_,"group",function(){return this._getGroup()},function(q$S){this._setGroup(q$S)}),q$t(0,q$_,"resourceManager",function(){return this._resourceManager}),q$t(0,q$_,"url",function(){return this._url}),q$t(0,q$_,"released",function(){return this._released}),q$t(0,q$_,"referenceCount",function(){return this._referenceCount}),q$k.getResourceByID=function(q$S){return q$k._idResourcesMap[q$S]},q$k.getResourceByURL=function(q$S,q$_){return void 0===q$_&&(q$_=0),null==q$k._urlResourcesMap[q$S]?null:q$k._urlResourcesMap[q$S][q$_]},q$k.getResourceCountByURL=function(q$S){return q$k._urlResourcesMap[q$S].length},q$k.destroyUnusedResources=function(q$S){var q$_;if(q$S){var q$a=q$k._groupResourcesMap[q$S];if(q$a)for(var q$R=q$a.slice(),q$J=0,q$V=q$R.length;q$J<q$V;q$J++)(q$_=q$R[q$J]).lock||0!==q$_._referenceCount||q$_.destroy()}else for(var q$W in q$k._idResourcesMap)(q$_=q$k._idResourcesMap[q$W]).lock||0!==q$_._referenceCount||q$_.destroy()},q$k._uniqueIDCounter=0,q$k._idResourcesMap={},q$k._urlResourcesMap={},q$k._groupResourcesMap={},q$k}()),q$HS=function(q$S){function q$l(q$S,q$_){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,q$l.__super.call(this),q$S&&null!=q$S._addReference&&q$S._addReference(),this.setTo(q$S,q$_)}q$H(q$l,"laya.resource.Texture",q$b);var q$_=q$l.prototype;return q$_._setUrl=function(q$S){this.url=q$S},q$_.setTo=function(q$S,q$_){if(q$S instanceof q$W.HTMLElement){var q$a=q$DS.create("2D",q$S);this.bitmap=q$a}else this.bitmap=q$S;if(this.uv=q$_||q$l.DEF_UV,q$S){this._w=q$S.width,this._h=q$S.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var q$R=this;if(this._loaded)q$A.addToAtlas&&q$A.addToAtlas(q$R);else{var q$J=q$S;q$J instanceof laya.resource.HTMLImage&&q$J.image&&q$J.image.addEventListener("load",function(q$S){q$A.addToAtlas&&q$A.addToAtlas(q$R)},!1)}}},q$_.active=function(){this.bitmap&&this.bitmap.activeResource()},q$_.destroy=function(q$S){if(void 0===q$S&&(q$S=!1),this.alphaTexture&&(this.alphaTexture.destroy(q$S),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var q$_=this.bitmap;q$S?(q$K.isConchApp&&q$_.source&&q$_.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,q$_.dispose(),q$_._clearReference()):(q$_._removeReference(),0==q$_.referenceCount&&(q$K.isConchApp&&q$_.source&&q$_.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,q$_.dispose())),this.url&&this===q$q.loader.getRes(this.url)&&q$q.loader.clearRes(this.url,q$S),this._loaded=!1}},q$_.load=function(q$S){var q$_=this;this._loaded=!1,q$S=q$u.customFormat(q$S);var q$a=this.bitmap||(this.bitmap=q$mS.create(q$S));q$a.uri=q$S,q$a&&q$a._addReference();var q$R=this;q$a.onload=function(){q$a.onload=null,q$R._loaded=!0,q$_.sourceWidth=q$_._w=q$a.width,q$_.sourceHeight=q$_._h=q$a.height,q$R.event("loaded",this),q$A.addToAtlas&&q$A.addToAtlas(q$R)}},q$_.addTextureToAtlas=function(q$S){q$A.addTextureToAtlas(this)},q$_.getPixels=function(q$S,q$_,q$a,q$R){if(q$K.isConchApp){var q$J=this.bitmap;if(q$J.source&&q$J.source.getImageData){var q$V=q$J.source.getImageData(q$S,q$_,q$a,q$R),q$W=new Uint8Array(q$V);return Array.from(q$W)}return null}return q$K.isWebGL?q$A.getTexturePixels(this,q$S,q$_,q$a,q$R):(q$g.canvas.size(q$a,q$R),q$g.canvas.clear(),q$g.context.drawTexture(this,-q$S,-q$_,this.width,this.height,0,0),q$g.context.getImageData(0,0,q$a,q$R).data)},q$_.onAsynLoaded=function(q$S,q$_){if(q$_){if("function"!=typeof q$_._addReference)throw new Error("bitmap._addReference is not a function. "+q$_.className+" "+typeof q$_._addReference+" "+q$_.constructor);q$_._addReference()}this.setTo(q$_,this.uv),this._loaded&&this.event("loaded",this)},q$t(0,q$_,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),q$t(0,q$_,"loaded",function(){return this._loaded}),q$t(0,q$_,"released",function(){return!this.bitmap||this.bitmap.released}),q$t(0,q$_,"width",function(){return this._w?this._w:this.uv&&this.uv!==q$l.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(q$S){this._w=q$S,this.sourceWidth||(this.sourceWidth=q$S)}),q$t(0,q$_,"repeat",function(){return!q$K.isWebGL||!this.bitmap||this.bitmap.repeat},function(q$S){q$S&&q$K.isWebGL&&this.bitmap&&(this.bitmap.repeat=q$S)&&(this.bitmap.enableMerageInAtlas=!1)}),q$t(0,q$_,"height",function(){return this._h?this._h:this.uv&&this.uv!==q$l.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(q$S){this._h=q$S,this.sourceHeight||(this.sourceHeight=q$S)}),q$t(0,q$_,"isLinearSampling",function(){return!q$K.isWebGL||9728!=this.bitmap.minFifter},function(q$S){!q$S&&q$K.isWebGL&&(q$S||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),q$l.moveUV=function(q$S,q$_,q$a){for(var q$R=0;q$R<8;q$R+=2)q$a[q$R]+=q$S,q$a[q$R+1]+=q$_;return q$a},q$l.create=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){void 0===q$V&&(q$V=0),void 0===q$W&&(q$W=0),void 0===q$k&&(q$k=0),void 0===q$z&&(q$z=0);var q$b=q$S instanceof laya.resource.Texture,q$H=q$b?q$S.uv:q$l.DEF_UV,q$L=q$b?q$S.bitmap:q$S,q$C=q$A.isAtlas(q$L);if(q$C){var q$G=q$L._atlaser,q$t=q$S._atlasID;if(-1==q$t)throw new Error("create texture error");q$L=q$G._inAtlasTextureBitmapValue[q$t],q$H=q$G._inAtlasTextureOriUVValue[q$t]}var q$o=new q$l(q$L,null);q$L.width&&q$_+q$R>q$L.width&&(q$R=q$L.width-q$_),q$L.height&&q$a+q$J>q$L.height&&(q$J=q$L.height-q$a),q$o.width=q$R,q$o.height=q$J,q$o.offsetX=q$V,q$o.offsetY=q$W,q$o.sourceWidth=q$k||q$R,q$o.sourceHeight=q$z||q$J;var q$$=1/q$L.width,q$F=1/q$L.height;q$_*=q$$,q$a*=q$F,q$R*=q$$,q$J*=q$F;var q$T=q$o.uv[0],q$D=q$o.uv[1],q$j=q$o.uv[4],q$Q=q$o.uv[5],q$m=q$j-q$T,q$q=q$Q-q$D,q$N=q$l.moveUV(q$H[0],q$H[1],[q$_,q$a,q$_+q$R,q$a,q$_+q$R,q$a+q$J,q$_,q$a+q$J]);q$o.uv=[q$T+q$N[0]*q$m,q$D+q$N[1]*q$q,q$j-(1-q$N[2])*q$m,q$D+q$N[3]*q$q,q$j-(1-q$N[4])*q$m,q$Q-(1-q$N[5])*q$q,q$T+q$N[6]*q$m,q$Q-(1-q$N[7])*q$q],q$C&&q$o.addTextureToAtlas();var q$n=q$L.scaleRate;return q$n&&1!=q$n?(q$o.sourceWidth/=q$n,q$o.sourceHeight/=q$n,q$o.width/=q$n,q$o.height/=q$n,q$o.scaleRate=q$n,q$o.offsetX/=q$n,q$o.offsetY/=q$n):q$o.scaleRate=1,q$o},q$l.createFromTexture=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$S.scaleRate;1!=q$V&&(q$_*=q$V,q$a*=q$V,q$R*=q$V,q$J*=q$V);var q$W=q$n.TEMP.setTo(q$_-q$S.offsetX,q$a-q$S.offsetY,q$R,q$J),q$k=q$W.intersection(q$l._rect1.setTo(0,0,q$S.width,q$S.height),q$l._rect2);if(!q$k)return null;var q$z=q$l.create(q$S,q$k.x,q$k.y,q$k.width,q$k.height,q$k.x-q$W.x,q$k.y-q$W.y,q$R,q$J);if(q$z.bitmap&&q$z.bitmap._removeReference)return q$z.bitmap._removeReference(),q$z;var q$b="bitmap:"+(q$z.bitmap?q$z.bitmap.constructor?q$z.bitmap.constructor.name:q$z.bitmap.__className:"")+", url:"+(q$S.url+" | "+(q$z.bitmap?q$z.bitmap.url:q$S.url))+", x="+q$_+",y="+q$a+",width="+q$R+",height="+q$J+", result="+(q$k?q$k.x+","+q$k.y+","+q$k.width+","+q$k.height:"null")+", rect="+q$W.x+","+q$W.y+","+q$W.width+","+q$W.height;throw new Error("报错：bitmap._removeReference is not a function  "+q$b)},q$l.DEF_UV=[0,0,1,0,1,1,0,1],q$l.INV_UV=[0,1,1,1,1,0,0,0],q$l._rect1=new q$n,q$l._rect2=new q$n,q$l}(),q$S=function(q$S){var q$k;function q$V(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,q$V.__super.call(this)}q$H(q$V,"laya.utils.TimeLine",q$b);var q$_=q$V.prototype;return q$_.to=function(q$S,q$_,q$a,q$R,q$J){return void 0===q$J&&(q$J=0),this._create(q$S,q$_,q$a,q$R,q$J,!0)},q$_.from=function(q$S,q$_,q$a,q$R,q$J){return void 0===q$J&&(q$J=0),this._create(q$S,q$_,q$a,q$R,q$J,!1)},q$_._create=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=q$p.getItemByClass("tweenData",q$k);return q$W.isTo=q$V,q$W.type=0,q$W.target=q$S,q$W.duration=q$a,q$W.data=q$_,q$W.startTime=this._startTime+q$J,q$W.endTime=q$W.startTime+q$W.duration,q$W.ease=q$R,this._startTime=Math.max(q$W.endTime,this._startTime),this._tweenDataList.push(q$W),this._startTimeSort=!0,this._endTimeSort=!0,this},q$_.addLabel=function(q$S,q$_){var q$a=q$p.getItemByClass("tweenData",q$k);return q$a.type=1,q$a.data=q$S,q$a.endTime=q$a.startTime=this._startTime+q$_,this._labelDic||(this._labelDic={}),this._labelDic[q$S]=q$a,this._tweenDataList.push(q$a),this},q$_.removeLabel=function(q$S){if(this._labelDic&&this._labelDic[q$S]){var q$_=this._labelDic[q$S];if(q$_){var q$a=this._tweenDataList.indexOf(q$_);-1<q$a&&this._tweenDataList.splice(q$a,1)}delete this._labelDic[q$S]}},q$_.gotoTime=function(q$S){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var q$_,q$a,q$R,q$J;for(var q$V in this._firstTweenDic)if(q$a=this._firstTweenDic[q$V])for(var q$W in q$a)q$a.diyTarget.hasOwnProperty(q$W)&&(q$a.diyTarget[q$W]=q$a[q$W]);for(q$V in this._tweenDic)(q$_=this._tweenDic[q$V]).clear(),delete this._tweenDic[q$V];if(this._index=0,this._gidIndex=0,this._currTime=q$S,this._lastTime=q$g.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=q$R=this._tweenDataList.concat(),q$R.sort(function(q$S,q$_){return q$S.endTime>q$_.endTime?1:q$S.endTime<q$_.endTime?-1:0})}else q$R=this._endTweenDataList;for(var q$k=0,q$z=q$R.length;q$k<q$z;q$k++)if(0==(q$J=q$R[q$k]).type){if(!(q$S>=q$J.endTime))break;this._index=Math.max(this._index,q$k+1);var q$b=q$J.data;if(q$J.isTo)for(var q$H in q$b)q$J.target[q$H]=q$b[q$H]}for(q$k=0,q$z=this._tweenDataList.length;q$k<q$z;q$k++)0==(q$J=this._tweenDataList[q$k]).type&&q$S>=q$J.startTime&&q$S<q$J.endTime&&(this._index=Math.max(this._index,q$k+1),this._gidIndex++,(q$_=q$p.getItemByClass("tween",q$E))._create(q$J.target,q$J.data,q$J.duration,q$J.ease,q$T.create(this,this._animComplete,[this._gidIndex]),0,!1,q$J.isTo,!0,!1),q$_.setStartTime(this._currTime-(q$S-q$J.startTime)),q$_._updateEase(this._currTime),q$_.gid=this._gidIndex,this._tweenDic[this._gidIndex]=q$_)}},q$_.gotoLabel=function(q$S){if(null!=this._labelDic){var q$_=this._labelDic[q$S];q$_&&this.gotoTime(q$_.startTime)}},q$_.pause=function(){q$q.timer.clear(this,this._update)},q$_.resume=function(){this.play(this._currTime,this._loopKey)},q$_.play=function(q$S,q$_){if(void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(q$S,q$_){return q$S.startTime>q$_.startTime?1:q$S.startTime<q$_.startTime?-1:0});for(var q$a=0,q$R=this._tweenDataList.length;q$a<q$R;q$a++){var q$J=this._tweenDataList[q$a];if(null!=q$J&&0==q$J.type){var q$V=q$J.target,q$W=q$V.$_GID||(q$V.$_GID=q$O.getGID()),q$k=null;for(var q$z in null==this._firstTweenDic[q$W]?((q$k={}).diyTarget=q$V,this._firstTweenDic[q$W]=q$k):q$k=this._firstTweenDic[q$W],q$J.data)null==q$k[q$z]&&(q$k[q$z]=q$V[q$z])}}}"string"==typeof q$S?this.gotoLabel(q$S):this.gotoTime(q$S),this._loopKey=q$_,this._lastTime=q$g.now(),q$q.timer.frameLoop(1,this,this._update)}},q$_._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var q$S in this._tweenDic)(q$_=this._tweenDic[q$S]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var q$_,q$a=q$g.now(),q$R=q$a-this._lastTime,q$J=this._currTime+=q$R*this.scale;for(q$S in this._lastTime=q$a,this._tweenDic)(q$_=this._tweenDic[q$S])._updateEase(q$J);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var q$V=this._tweenDataList[this._index];q$J>=q$V.startTime&&(this._index++,0==q$V.type?(this._gidIndex++,(q$_=q$p.getItemByClass("tween",q$E))._create(q$V.target,q$V.data,q$V.duration,q$V.ease,q$T.create(this,this._animComplete,[this._gidIndex]),0,!1,q$V.isTo,!0,!1),q$_.setStartTime(q$J),q$_.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=q$_)._updateEase(q$J)):this.event("label",q$V.data))}},q$_._animComplete=function(q$S){this._tweenDic[q$S]&&delete this._tweenDic[q$S]},q$_._complete=function(){this.event("complete")},q$_.reset=function(){var q$S;if(this._labelDic)for(q$S in this._labelDic)delete this._labelDic[q$S];for(q$S in this._tweenDic)this._tweenDic[q$S].clear(),delete this._tweenDic[q$S];for(q$S in this._firstTweenDic)delete this._firstTweenDic[q$S];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var q$_,q$a=0;for(q$_=this._tweenDataList.length,q$a=0;q$a<q$_;q$a++)this._tweenDataList[q$a]&&this._tweenDataList[q$a].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,q$q.timer.clear(this,this._update)},q$_.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},q$t(0,q$_,"index",function(){return this._frameIndex},function(q$S){this._frameIndex=q$S,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),q$t(0,q$_,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),q$V.to=function(q$S,q$_,q$a,q$R,q$J){return void 0===q$J&&(q$J=0),(new q$V).to(q$S,q$_,q$a,q$R,q$J)},q$V.from=function(q$S,q$_,q$a,q$R,q$J){return void 0===q$J&&(q$J=0),(new q$V).from(q$S,q$_,q$a,q$R,q$J)},q$V.__init$=function(){q$k=function(){function q$S(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return q$H(q$S,""),q$S.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,q$p.recover("tweenData",this)},q$S}()},q$V}(),q$LS=function(q$J){function q$a(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,q$a.__super.call(this),this._style=q$k.EMPTY}q$H(q$a,"laya.display.Sprite",q$J);var q$S=q$a.prototype;return q$q.imps(q$S,{"laya.display.ILayout":!0}),q$S.createConchModel=function(){return new ConchNode},q$S.destroy=function(q$S){if(void 0===q$S&&(q$S=!0),this._releaseMem(),!this._destroyed){this.filters=null;var q$_=this.mask;q$_&&(this.mask=null,q$_.destroy(q$S))}q$J.prototype.destroy.call(this,q$S),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},q$S.updateZOrder=function(){q$O.updateOrder(this._childs)&&this.repaint()},q$S.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},q$S.setBounds=function(q$S){this._set$P("uBounds",q$S)},q$S.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new q$n),q$n._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},q$S.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new q$n),q$n._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},q$S._boundPointsToParent=function(q$S){void 0===q$S&&(q$S=!1);var q$_=0,q$a=0;this._style&&(q$_=this._style._tf.translateX,q$a=this._style._tf.translateY,q$S=q$S||0!==this._style._tf.rotate,this._style.scrollRect&&(q$_+=this._style.scrollRect.x,q$a+=this._style.scrollRect.y));var q$R=this._getBoundPointsM(q$S);if(!q$R||q$R.length<1)return q$R;if(8!=q$R.length&&(q$R=q$S?q$Q.scanPList(q$R):q$n._getWrapRec(q$R,q$n.TEMP)._getBoundPoints()),!this.transform)return q$O.transPointList(q$R,this._x-q$_,this._y-q$a),q$R;var q$J=q$N.TEMP,q$V=0,q$W=q$R.length;for(q$V=0;q$V<q$W;q$V+=2)q$J.x=q$R[q$V],q$J.y=q$R[q$V+1],this.toParentPoint(q$J),q$R[q$V]=q$J.x,q$R[q$V+1]=q$J.y;return q$R},q$S.getGraphicBounds=function(q$S){return void 0===q$S&&(q$S=!1),this._graphics?this._graphics.getBounds(q$S):q$n.TEMP.setTo(0,0,0,0)},q$S._getBoundPointsM=function(q$S){if(void 0===q$S&&(q$S=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var q$_=q$O.clearArray(this._$P.temBM),q$a=q$n.TEMP;return q$a.copyFrom(this.scrollRect),q$O.concatArray(q$_,q$a._getBoundPoints()),q$_}for(var q$R,q$J,q$V,q$W=this._graphics?this._graphics.getBoundPoints():q$O.clearArray(this._$P.temBM),q$k=0,q$z=(q$V=this._childs).length;q$k<q$z;q$k++)(q$R=q$V[q$k])instanceof laya.display.Sprite&&1==q$R.visible&&(q$J=q$R._boundPointsToParent(q$S))&&(q$W=q$W?q$O.concatArray(q$W,q$J):q$J);return q$W},q$S.getStyle=function(){return this._style===q$k.EMPTY&&(this._style=new q$k),this._style},q$S.setStyle=function(q$S){this._style=q$S},q$S._adjustTransform=function(){this._tfChanged=!1;var q$S,q$_=this._style._tf,q$a=q$_.scaleX,q$R=q$_.scaleY;if(q$_.rotate||1!==q$a||1!==q$R||q$_.skewX||q$_.skewY){(q$S=this._transform||(this._transform=q$X.create())).bTransform=!0;var q$J=.0174532922222222*(q$_.rotate-q$_.skewX),q$V=.0174532922222222*(q$_.rotate+q$_.skewY),q$W=Math.cos(q$V),q$k=Math.sin(q$V),q$z=Math.sin(q$J),q$b=Math.cos(q$J);return q$S.a=q$a*q$W,q$S.b=q$a*q$k,q$S.c=-q$R*q$z,q$S.d=q$R*q$b,q$S.tx=q$S.ty=0,q$S}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,q$S},q$S.pos=function(q$S,q$_,q$a){if(void 0===q$a&&(q$a=!1),this._x!==q$S||this._y!==q$_){if(this.destroyed)return this;if(q$a){this._x=q$S,this._y=q$_,this.conchModel&&this.conchModel.pos(this._x,this._y);var q$R=this._parent;q$R&&0===q$R._repaint&&(q$R._repaint=1,q$R.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=q$S,this.y=q$_}return this},q$S.pivot=function(q$S,q$_){return this.pivotX=q$S,this.pivotY=q$_,this},q$S.size=function(q$S,q$_){return this.width=q$S,this.height=q$_,this},q$S.scale=function(q$S,q$_,q$a){void 0===q$a&&(q$a=!1);var q$R=this.getStyle(),q$J=q$R._tf;if(q$J.scaleX!=q$S||q$J.scaleY!=q$_){if(this.destroyed)return this;if(q$a){q$R.setScale(q$S,q$_),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(q$S,q$_),this._renderType|=4;var q$V=this._parent;q$V&&0===q$V._repaint&&(q$V._repaint=1,q$V.parentRepaint())}else this.scaleX=q$S,this.scaleY=q$_}return this},q$S.skew=function(q$S,q$_){return this.skewX=q$S,this.skewY=q$_,this},q$S.render=function(q$S,q$_,q$a){q$c.spriteCount++,q$M.renders[this._renderType]._fun(this,q$S,q$_+this._x,q$a+this._y),this._repaint=0},q$S.drawToCanvas=function(q$S,q$_,q$a,q$R){if(q$K.isConchNode){var q$J=q$DS.create("2D");return new q$P(q$S,q$_,q$J).ctx.setCanvasType(1),this.conchModel.drawToCanvas(q$J.source,q$a,q$R),q$J}return q$A.drawToCanvas(this,this._renderType,q$S,q$_,q$a,q$R)},q$S.customRender=function(q$S,q$_,q$a){this._renderType|=1024},q$S._applyFilters=function(){var q$S;if(!q$K.isWebGL&&((q$S=this._$P.filters)&&!(q$S.length<1)))for(var q$_=0,q$a=q$S.length;q$_<q$a;q$_++)q$S[q$_].action.apply(this._$P.cacheCanvas)},q$S._isHaveGlowFilter=function(){var q$S,q$_=0;if(this.filters)for(q$_=0;q$_<this.filters.length;q$_++)if(8==this.filters[q$_].type)return!0;for(q$_=0,q$S=this._childs.length;q$_<q$S;q$_++)if(this._childs[q$_]._isHaveGlowFilter())return!0;return!1},q$S.localToGlobal=function(q$S,q$_){void 0===q$_&&(q$_=!1),!0===q$_&&(q$S=new q$N(q$S.x,q$S.y));for(var q$a=this;q$a&&q$a!=q$q.stage;)q$S=q$a.toParentPoint(q$S),q$a=q$a.parent;return q$S},q$S.globalToLocal=function(q$S,q$_){void 0===q$_&&(q$_=!1),q$_&&(q$S=new q$N(q$S.x,q$S.y));for(var q$a=this,q$R=[];q$a&&q$a!=q$q.stage;)q$R.push(q$a),q$a=q$a.parent;for(var q$J=q$R.length-1;0<=q$J;)q$S=(q$a=q$R[q$J]).fromParentPoint(q$S),q$J--;return q$S},q$S.toParentPoint=function(q$S){if(!q$S)return q$S;q$S.x-=this.pivotX,q$S.y-=this.pivotY,this.transform&&this._transform.transformPoint(q$S),q$S.x+=this._x,q$S.y+=this._y;var q$_=this._style.scrollRect;return q$_&&(q$S.x-=q$_.x,q$S.y-=q$_.y),q$S},q$S.fromParentPoint=function(q$S){if(!q$S)return q$S;q$S.x-=this._x,q$S.y-=this._y;var q$_=this._style.scrollRect;return q$_&&(q$S.x+=q$_.x,q$S.y+=q$_.y),this.transform&&this._transform.invertTransformPoint(q$S),q$S.x+=this.pivotX,q$S.y+=this.pivotY,q$S},q$S.on=function(q$S,q$_,q$a,q$R){return 1!==this._mouseEnableState&&this.isMouseEvent(q$S)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(q$S,q$_,q$a,q$R,!1)):q$J.prototype.on.call(this,q$S,q$_,q$a,q$R)},q$S.once=function(q$S,q$_,q$a,q$R){return 1!==this._mouseEnableState&&this.isMouseEvent(q$S)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(q$S,q$_,q$a,q$R,!0)):q$J.prototype.once.call(this,q$S,q$_,q$a,q$R)},q$S._$2__onDisplay=function(){if(1!==this._mouseEnableState){var q$S=this;for(q$S=q$S.parent;q$S&&1!==q$S._mouseEnableState&&!q$S._getBit(2);)q$S.mouseEnabled=!0,q$S._setBit(2,!0),q$S=q$S.parent}},q$S.loadImage=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=this;return void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=0),void 0===q$J&&(q$J=0),this.graphics.loadImage(q$S,q$_,q$a,q$R,q$J,function(q$S){q$W.destroyed||(q$W.size(q$_+(q$R||q$S.width),q$a+(q$J||q$S.height)),q$W.repaint(),q$V&&q$V.runWith(q$S))}),this},q$S.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},q$S._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},q$S._childChanged=function(q$S){this._childs.length?this._renderType|=2048:this._renderType&=-2049,q$S&&this._get$P("hasZorder")&&q$q.timer.callLater(this,this.updateZOrder),this.repaint()},q$S.parentRepaint=function(){var q$S=this._parent;q$S&&0===q$S._repaint&&(q$S._repaint=1,q$S.parentRepaint())},q$S.startDrag=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){void 0===q$_&&(q$_=!1),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=300),void 0===q$V&&(q$V=!1),void 0===q$W&&(q$W=.92),this._$P.dragging||this._set$P("dragging",new q$Y),this._$P.dragging.start(this,q$S,q$_,q$a,q$R,q$J,q$V,q$W)},q$S.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},q$S._releaseMem=function(){if(this._$P){var q$S=this._$P.cacheCanvas;q$S&&q$S.ctx&&(q$p.recover("RenderContext",q$S.ctx),q$S.ctx.canvas.size(0,0),q$S.ctx=null);var q$_=this._$P._filterCache;q$_&&(q$_.destroy(),q$_.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},q$S._setDisplay=function(q$S){q$S||this._releaseMem(),q$J.prototype._setDisplay.call(this,q$S)},q$S.hitTestPoint=function(q$S,q$_){var q$a=this.globalToLocal(q$N.TEMP.setTo(q$S,q$_));return q$S=q$a.x,q$_=q$a.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?q$n.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(q$S,q$_)},q$S.getMousePoint=function(){return this.globalToLocal(q$N.TEMP.setTo(q$q.stage.mouseX,q$q.stage.mouseY))},q$S._getWords=function(){return null},q$S._addChildsToLayout=function(q$S){var q$_=this._getWords();if(null==q$_&&0==this._childs.length)return!1;if(q$_)for(var q$a=0,q$R=q$_.length;q$a<q$R;q$a++)q$S.push(q$_[q$a]);q$a=0;for(var q$J=this._childs.length;q$a<q$J;++q$a){var q$V=this._childs[q$a];q$V._style._enableLayout()&&q$V._addToLayout(q$S)}return!0},q$S._addToLayout=function(q$S){this._style.absolute||(this._style.block?q$S.push(this):this._addChildsToLayout(q$S)&&(this.x=this.y=0))},q$S._isChar=function(){return!1},q$S._getCSSStyle=function(){return this._style.getCSSStyle()},q$S._setAttributes=function(q$S,q$_){switch(q$S){case"x":this.x=parseFloat(q$_);break;case"y":this.y=parseFloat(q$_);break;case"width":this.width=parseFloat(q$_);break;case"height":this.height=parseFloat(q$_);break;default:this[q$S]=q$_}},q$S._layoutLater=function(){this.parent&&this.parent._layoutLater()},q$t(0,q$S,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(q$S){this._optimizeScrollRect!=q$S&&(this._optimizeScrollRect=q$S,this.conchModel&&this.conchModel.optimizeScrollRect(q$S))}),q$t(0,q$S,"customRenderEnable",null,function(q$S){if(q$S&&(this._renderType|=1024,q$K.isConchNode)){q$a.CustomList.push(this);var q$_=new q$DS("2d");q$_._setContext(new CanvasRenderingContext2D),this.customContext=new q$P(0,0,q$_),q$_.context.setCanvasType&&q$_.context.setCanvasType(2),this.conchModel.custom(q$_.context)}}),q$t(0,q$S,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(q$S){this.cacheAs=q$S?this._$P.hasFilter?"none":"normal":"none"}),q$t(0,q$S,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(q$S){var q$_=this._$P.cacheCanvas;if(q$S!==(q$_?q$_.type:"none")){if("none"!==q$S)this._getBit(1)||this._setUpNoticeType(1),q$_||(q$_=this._set$P("cacheCanvas",q$p.getItemByClass("cacheCanvas",Object))),q$_.type=q$S,q$_.reCache=!0,this._renderType|=16,"bitmap"==q$S&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(q$_){var q$a=q$_;q$a&&q$a.ctx&&(q$p.recover("RenderContext",q$a.ctx),q$a.ctx.canvas.size(0,0),q$a.ctx=null),q$p.recover("cacheCanvas",q$_)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),q$t(0,q$S,"zOrder",function(){return this._zOrder},function(q$S){this._zOrder!=q$S&&(this._zOrder=q$S,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(q$S),this._parent&&(q$S&&this._parent._set$P("hasZorder",!0),q$q.timer.callLater(this._parent,this.updateZOrder)))}),q$t(0,q$S,"rotation",function(){return this._style._tf.rotate},function(q$S){var q$_=this.getStyle();if(q$_._tf.rotate!==q$S){q$_.setRotate(q$S),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(q$S),this._renderType|=4;var q$a=this._parent;q$a&&0===q$a._repaint&&(q$a._repaint=1,q$a.parentRepaint())}}),q$t(0,q$S,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(q$S){this._width!==q$S&&(this._width=q$S,this.conchModel&&this.conchModel.size(q$S,this._height),this.repaint())}),q$t(0,q$S,"x",function(){return this._x},function(q$S){if(this._x!==q$S){if(this.destroyed)return;this._x=q$S,this.conchModel&&this.conchModel.pos(q$S,this._y);var q$_=this._parent;q$_&&0===q$_._repaint&&(q$_._repaint=1,q$_.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),q$t(0,q$S,"globalScaleY",function(){for(var q$S=1,q$_=this;q$_&&q$_!==q$q.stage;)q$S*=q$_.scaleY,q$_=q$_.parent;return q$S}),q$t(0,q$S,"hitArea",function(){return this._$P.hitArea},function(q$S){this._set$P("hitArea",q$S)}),q$t(0,q$S,"staticCache",function(){return this._$P.staticCache},function(q$S){this._set$P("staticCache",q$S),q$S||this.reCache()}),q$t(0,q$S,"texture",function(){return this._texture},function(q$S){this._texture!=q$S&&(this._texture=q$S,this.graphics.cleanByTexture(q$S,0,0))}),q$t(0,q$S,"y",function(){return this._y},function(q$S){if(this._y!==q$S){if(this.destroyed)return;this._y=q$S,this.conchModel&&this.conchModel.pos(this._x,q$S);var q$_=this._parent;q$_&&0===q$_._repaint&&(q$_._repaint=1,q$_.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),q$t(0,q$S,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(q$S){this._height!==q$S&&(this._height=q$S,this.conchModel&&this.conchModel.size(this._width,q$S),this.repaint())}),q$t(0,q$S,"blendMode",function(){return this._style.blendMode},function(q$S){this.getStyle().blendMode=q$S,this.conchModel&&this.conchModel.blendMode(q$S),q$S&&"source-over"!=q$S?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),q$t(0,q$S,"scaleX",function(){return this._style._tf.scaleX},function(q$S){var q$_=this.getStyle();if(q$_._tf.scaleX!==q$S){q$_.setScaleX(q$S),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(q$S,q$_._tf.scaleY),this._renderType|=4;var q$a=this._parent;q$a&&0===q$a._repaint&&(q$a._repaint=1,q$a.parentRepaint())}}),q$t(0,q$S,"scaleY",function(){return this._style._tf.scaleY},function(q$S){var q$_=this.getStyle();if(q$_._tf.scaleY!==q$S){q$_.setScaleY(q$S),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(q$_._tf.scaleX,q$S),this._renderType|=4;var q$a=this._parent;q$a&&0===q$a._repaint&&(q$a._repaint=1,q$a.parentRepaint())}}),q$t(0,q$S,"stage",function(){return q$q.stage}),q$t(0,q$S,"skewX",function(){return this._style._tf.skewX},function(q$S){var q$_=this.getStyle();if(q$_._tf.skewX!==q$S){q$_.setSkewX(q$S),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(q$S,q$_._tf.skewY),this._renderType|=4;var q$a=this._parent;q$a&&0===q$a._repaint&&(q$a._repaint=1,q$a.parentRepaint())}}),q$t(0,q$S,"scrollRect",function(){return this._style.scrollRect},function(q$S){this.getStyle().scrollRect=q$S,this.repaint(),q$S?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(q$S.x,q$S.y,q$S.width,q$S.height)):(this._renderType&=-129,this.conchModel&&(q$a.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),q$t(0,q$S,"skewY",function(){return this._style._tf.skewY},function(q$S){var q$_=this.getStyle();if(q$_._tf.skewY!==q$S){q$_.setSkewY(q$S),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(q$_._tf.skewX,q$S),this._renderType|=4;var q$a=this._parent;q$a&&0===q$a._repaint&&(q$a._repaint=1,q$a.parentRepaint())}}),q$t(0,q$S,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(q$S){this._tfChanged=!1,(this._transform=q$S)&&(this._x=q$S.tx,this._y=q$S.ty,q$S.tx=q$S.ty=0,this.conchModel&&this.conchModel.transform(q$S.a,q$S.b,q$S.c,q$S.d,this._x,this._y)),q$S?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),q$t(0,q$S,"pivotX",function(){return this._style._tf.translateX},function(q$S){this.getStyle().setTranslateX(q$S),this.conchModel&&this.conchModel.pivot(q$S,this._style._tf.translateY),this.repaint()}),q$t(0,q$S,"pivotY",function(){return this._style._tf.translateY},function(q$S){this.getStyle().setTranslateY(q$S),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,q$S),this.repaint()}),q$t(0,q$S,"alpha",function(){return this._style.alpha},function(q$S){this._style&&this._style.alpha!==q$S&&(q$S=q$S<0?0:1<q$S?1:q$S,this.getStyle().alpha=q$S,this.conchModel&&this.conchModel.alpha(q$S),1!==q$S?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),q$t(0,q$S,"visible",function(){return this._style.visible},function(q$S){this._style&&this._style.visible!==q$S&&(this.getStyle().visible=q$S,this.conchModel&&this.conchModel.visible(q$S),this.parentRepaint())}),q$t(0,q$S,"graphics",function(){return this._graphics||(this.graphics=q$A.createGraphics())},function(q$S){this._graphics&&(this._graphics._sp=null),(this._graphics=q$S)?(this._renderType&=-2,this._renderType|=512,(q$S._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(q$a.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),q$t(0,q$S,"filters",function(){return this._$P.filters},function(q$S){q$S&&0===q$S.length&&(q$S=null),this._$P.filters!=q$S&&(this._set$P("filters",q$S?q$S.slice():null),q$K.isConchApp&&(this.conchModel&&(q$a.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),q$K.isWebGL&&(q$S&&q$S.length?this._renderType|=32:this._renderType&=-33),q$S&&0<q$S.length?(this._getBit(1)||this._setUpNoticeType(1),q$K.isWebGL&&1==q$S.length&&q$S[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(q$K.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),q$t(0,q$S,"parent",q$J.prototype._$get_parent,function(q$S){q$q.superSet(q$SS,this,"parent",q$S),q$S&&this._getBit(2)&&this._$2__onDisplay()}),q$t(0,q$S,"mask",function(){return this._$P._mask},function(q$S){q$S&&this.mask&&this.mask._$P.maskParent||(q$S?(this.cacheAs="bitmap",this._set$P("_mask",q$S),q$S._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",q$S),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(q$S?q$S.conchModel:null),this._renderType|=64,this.parentRepaint())}),q$t(0,q$S,"mouseEnabled",function(){return 1<this._mouseEnableState},function(q$S){this._mouseEnableState=q$S?2:1}),q$t(0,q$S,"globalScaleX",function(){for(var q$S=1,q$_=this;q$_&&q$_!==q$q.stage;)q$S*=q$_.scaleX,q$_=q$_.parent;return q$S}),q$t(0,q$S,"mouseX",function(){return this.getMousePoint().x}),q$t(0,q$S,"mouseY",function(){return this.getMousePoint().y}),q$a.fromImage=function(q$S){return(new q$a).loadImage(q$S)},q$a._cachePool=[],q$a.CustomList=[],q$z(q$a,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=q$W.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),q$a}(q$SS),q$CS=function(q$S){function q$_(q$S){this._audio=null,this._onEnd=null,this._resumePlay=null,q$_.__super.call(this),this._onEnd=q$O.bind(this.__onEnd,this),this._resumePlay=q$O.bind(this.__resumePlay,this),q$S.addEventListener("ended",this._onEnd),this._audio=q$S}q$H(q$_,"laya.media.h5audio.AudioSoundChannel",q$RS);var q$a=q$_.prototype;return q$a.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(q$q.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},q$a.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,q$g.container.appendChild(this._audio),this._audio.play()}catch(q$S){this.event("error")}},q$a.play=function(q$S){this.isStopped=!1;try{this._audio.playbackRate=q$I.playbackRate,this._audio.currentTime=this.startTime}catch(q$S){return void this._audio.addEventListener("canplay",this._resumePlay)}q$I.addChannel(this),q$g.container.appendChild(this._audio),!q$S&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},q$a.stop=function(){this.isStopped=!0,q$I.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&q$K.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),q$g.onIE||this._audio!=q$aS._musicAudio&&q$p.recover("audio:"+this.url,this._audio),q$g.removeElement(this._audio),this._audio=null)},q$a.pause=function(){this.isStopped=!0,q$I.removeChannel(this),"pause"in this._audio&&this._audio.pause()},q$a.resume=function(){this._audio&&(this.isStopped=!1,q$I.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},q$t(0,q$a,"position",function(){return this._audio?this._audio.currentTime:0}),q$t(0,q$a,"duration",function(){return this._audio?this._audio.duration:0}),q$t(0,q$a,"volume",function(){return this._audio?this._audio.volume:1},function(q$S){this._audio&&(this._audio.volume=q$S)}),q$_}(),q$GS=function(q$S){function q$_(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=q$VS.ctx,q$_.__super.call(this),this._onPlayEnd=q$O.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}q$H(q$_,"laya.media.webaudio.WebAudioSoundChannel",q$RS);var q$a=q$_.prototype;return q$a.play=function(q$S){if(q$I.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var q$_=this.context,q$a=this.gain,q$R=q$_.createBufferSource();(this.bufferSource=q$R).buffer=this.audioBuffer,q$R.connect(q$a),q$a&&q$a.disconnect(),q$a.connect(q$_.destination),q$R.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=q$g.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(q$R.loop=!0),q$R.playbackRate.setTargetAtTime?q$R.playbackRate.setTargetAtTime(q$I.playbackRate,this.context.currentTime,.1):q$R.playbackRate.value=q$I.playbackRate,q$R.start(0,this.startTime),!q$S&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},q$a.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(q$q.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},q$a._clearBufferSource=function(){if(this.bufferSource){var q$S=this.bufferSource;q$S.stop?q$S.stop(0):q$S.noteOff(0),q$S.disconnect(0),q$S.onended=null,q$_._tryCleanFailed||this._tryClearBuffer(q$S),this.bufferSource=null}},q$a._tryClearBuffer=function(q$S){try{q$S.buffer=null}catch(q$S){q$_._tryCleanFailed=!0}},q$a.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,q$I.removeChannel(this),this.startHandler=null,this.completeHandler=null},q$a.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,q$I.removeChannel(this)},q$a.resume=function(){this.startTime=this._pauseTime,this.play(!1)},q$t(0,q$a,"position",function(){return this.bufferSource?(q$g.now()-this._startTime)/1e3+this.startTime:0}),q$t(0,q$a,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),q$t(0,q$a,"volume",function(){return this._volume},function(q$S){this.isStopped||(this._volume=q$S,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(q$S,this.context.currentTime,.1):this.gain.gain.value=q$S)}),q$_._tryCleanFailed=!1,q$_}(),q$tS=function(q$S){function q$_(){q$_.__super.call(this),this._w=0,this._h=0}q$H(q$_,"laya.resource.Bitmap",q$bS);var q$a=q$_.prototype;return q$t(0,q$a,"width",function(){return this._w}),q$t(0,q$a,"height",function(){return this._h}),q$t(0,q$a,"source",function(){return this._source}),q$_}(),q$oS=function(q$_){function q$S(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,q$S.__super.call(this),this._interval=q$R.animationInterval,this._setUpNoticeType(1)}q$H(q$S,"laya.display.AnimationPlayerBase",q$_);var q$a=q$S.prototype;return q$a.play=function(q$S,q$_,q$a,q$R){void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=!0),void 0===q$a&&(q$a=""),void 0===q$R&&(q$R=!0),this._isPlaying=!0,this.index="string"==typeof q$S?this._getFrameByLabel(q$S):q$S,this.loop=q$_,this._actionName=q$a,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},q$a._getFrameByLabel=function(q$S){var q$_=0;for(q$_=0;q$_<this._count;q$_++)if(this._labels[q$_]&&0<=this._labels[q$_].indexOf(q$S))return q$_;return 0},q$a._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},q$a._setControlNode=function(q$S){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=q$S)&&q$S!=this&&(q$S.on("display",this,this._checkResumePlaying),q$S.on("undisplay",this,this._checkResumePlaying))},q$a._setDisplay=function(q$S){q$_.prototype._setDisplay.call(this,q$S),this._checkResumePlaying()},q$a._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},q$a.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},q$a.addLabel=function(q$S,q$_){this._labels||(this._labels={}),this._labels[q$_]||(this._labels[q$_]=[]),this._labels[q$_].push(q$S)},q$a.removeLabel=function(q$S){if(q$S){if(this._labels)for(var q$_ in this._labels)this._removeLabelFromLabelList(this._labels[q$_],q$S)}else this._labels=null},q$a._removeLabelFromLabelList=function(q$S,q$_){if(q$S)for(var q$a=q$S.length-1;0<=q$a;q$a--)q$S[q$a]==q$_&&q$S.splice(q$a,1)},q$a.gotoAndStop=function(q$S){this.index="string"==typeof q$S?this._getFrameByLabel(q$S):q$S,this.stop()},q$a._displayToIndex=function(q$S){},q$a.clear=function(){this.stop(),this._labels=null},q$t(0,q$a,"interval",function(){return this._interval},function(q$S){this._interval!=q$S&&(this._frameRateChanged=!0,this._interval=q$S,this._isPlaying&&0<q$S&&this.timerLoop(q$S,this,this._frameLoop,null,!0,!0))}),q$t(0,q$a,"isPlaying",function(){return this._isPlaying}),q$t(0,q$a,"index",function(){return this._index},function(q$S){if(this._index=q$S,this._displayToIndex(q$S),this._labels&&this._labels[q$S])for(var q$_=this._labels[q$S],q$a=0,q$R=q$_.length;q$a<q$R;q$a++)this.event("label",q$_[q$a])}),q$t(0,q$a,"count",function(){return this._count}),q$S.WRAP_POSITIVE=0,q$S.WRAP_REVERSE=1,q$S.WRAP_PINGPONG=2,q$S}(q$LS),q$$S=function(q$_){function q$G(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,q$G.__super.call(this),this.overflow=q$G.VISIBLE,this._style=new q$_S(this),this._style.wordWrap=!1}q$H(q$G,"laya.display.Text",q$_);var q$S=q$G.prototype;return q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,q$S),this._lines=null,this._words&&(this._words.length=0,this._words=null)},q$S._getBoundPointsM=function(q$S){void 0===q$S&&(q$S=!1);var q$_=q$n.TEMP;return q$_.setTo(0,0,this.width,this.height),q$_._getBoundPoints()},q$S.getGraphicBounds=function(q$S){void 0===q$S&&(q$S=!1);var q$_=q$n.TEMP;return q$_.setTo(0,0,this.width,this.height),q$_},q$S._getCSSStyle=function(){return this._style},q$S.lang=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H){if(q$S=q$G.langPacks&&q$G.langPacks[q$S]?q$G.langPacks[q$S]:q$S,arguments.length<2)this._text=q$S;else{for(var q$L=0,q$C=arguments.length;q$L<q$C;q$L++)q$S=q$S.replace("{"+q$L+"}",arguments[q$L+1]);this._text=q$S}},q$S._isPassWordMode=function(){var q$S=this._style.password;return"prompt"in this&&this.prompt==this._text&&(q$S=!1),q$S},q$S._getPassWordTxt=function(q$S){var q$_;q$_="";for(var q$a=q$S.length;0<q$a;q$a--)q$_+="●";return q$_},q$S.renderText=function(q$S,q$_){var q$a=this.graphics;q$a.clear(!0);var q$R=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(q$g.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);q$g.context.font=q$R;var q$J=this.padding,q$V=q$J[3],q$W="left",q$k=this._lines,q$z=this.leading+this._charSize.height,q$b=this._currBitmapFont;q$b&&(q$z=this.leading+q$b.getMaxHeight());var q$H=q$J[0];if(!q$b&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(q$W="right",q$V=this._width-q$J[1]):"center"==this.align&&(q$W="center",q$V=.5*this._width+q$J[3]-q$J[1])),0<this._height){var q$L=this._textHeight>this._height?"top":this.valign;"middle"===q$L?q$H=.5*(this._height-q$_*q$z)+q$J[0]-q$J[2]:"bottom"===q$L&&(q$H=this._height-q$_*q$z-q$J[2])}var q$C=this._style;if(q$b&&q$b.autoScaleSize)var q$G=q$b.fontSize/this.fontSize;if(this._clipPoint)if(q$a.save(),q$b&&q$b.autoScaleSize){var q$t=0,q$o=0;q$t=this._width?this._width-q$J[3]-q$J[1]:this._textWidth,q$o=this._height?this._height-q$J[0]-q$J[2]:this._textHeight,q$t*=q$G,q$o*=q$G,q$a.clipRect(q$J[3],q$J[0],q$t,q$o)}else q$a.clipRect(q$J[3],q$J[0],this._width?this._width-q$J[3]-q$J[1]:this._textWidth,this._height?this._height-q$J[0]-q$J[2]:this._textHeight);var q$$=q$C.password;"prompt"in this&&this.prompt==this._text&&(q$$=!1);for(var q$F=0,q$T=0,q$D=Math.min(this._lines.length,q$_+q$S)||1,q$j=q$S;q$j<q$D;q$j++){var q$Q,q$m=q$k[q$j];if(q$$){var q$q=q$m.length;q$m="";for(var q$N=q$q;0<q$N;q$N--)q$m+="●"}if(q$F=q$V-(this._clipPoint?this._clipPoint.x:0),q$T=q$H+q$z*q$j-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(q$W,q$F,q$T,q$j),q$b){var q$n=this.width;q$b.autoScaleSize&&(q$n=this.width*q$G),q$b.drawText(q$m,this,q$F,q$T,this.align,q$n)}else q$K.isWebGL?(this._words||(this._words=[]),(q$Q=this._words.length>q$j-q$S?this._words[q$j-q$S]:new q$d).setText(q$m)):q$Q=q$m,q$C.stroke?q$a.fillBorderText(q$Q,q$F,q$T,q$R,this.color,q$C.strokeColor,q$C.stroke,q$W):q$a.fillText(q$Q,q$F,q$T,q$R,this.color,q$W)}if(q$b&&q$b.autoScaleSize){var q$l=1/q$G;this.scale(q$l,q$l)}this._clipPoint&&q$a.restore(),this._startX=q$V,this._startY=q$H},q$S.drawUnderline=function(q$S,q$_,q$a,q$R){var q$J=this._lineWidths[q$R];switch(q$S){case"center":q$_-=q$J/2;break;case"right":q$_-=q$J}q$a+=this._charSize.height,this._graphics.drawLine(q$_,q$a,q$_+q$J,q$a,this.underlineColor||this.color,1)},q$S.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);q$g.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new q$N(0,0)):this._clipPoint=null;var q$S=this._lines.length;if(this.overflow!=q$G.VISIBLE){var q$_=this.overflow==q$G.HIDDEN?Math.floor:Math.ceil;q$S=Math.min(q$S,q$_((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var q$a=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(q$a,q$S),this.repaint()},q$S.evalTextSize=function(){var q$S,q$_=NaN;q$S=Math.max.apply(this,this._lineWidths),q$_=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],q$S==this._textWidth&&q$_==this._textHeight||(this._textWidth=q$S,this._textHeight=q$_,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},q$S.checkEnabledViewportOrNot=function(){return this.overflow==q$G.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},q$S.changeText=function(q$S){this._text!==q$S&&(this.lang(q$S+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},q$S.parseLines=function(q$S){var q$_=this.wordWrap||this.overflow==q$G.HIDDEN;if(q$_)var q$a=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var q$R=q$O.contextMeasureText(q$G._testWord);q$K.isConchApp&&0===q$R.width&&0===q$R.height&&(q$R=q$O.contextMeasureText("W")),this._charSize.width=q$R.width,this._charSize.height=q$R.height||this.fontSize}for(var q$J=q$S.replace(/\r\n/g,"\n").split("\n"),q$V=0,q$W=q$J.length;q$V<q$W;q$V++){var q$k=q$J[q$V];q$_?this.parseLine(q$k,q$a):(this._lineWidths.push(this.getTextWidth(q$k)),this._lines.push(q$k))}},q$S.parseLine=function(q$S,q$_){q$g.context;var q$a,q$R=this._lines,q$J=0,q$V=NaN,q$W=NaN,q$k=0;if((q$V=this.getTextWidth(q$S))<=q$_)return q$R.push(q$S),void this._lineWidths.push(q$V);q$V=this._charSize.width,0==(q$J=Math.floor(q$_/q$V))&&(q$J=1),q$W=q$V=this.getTextWidth(q$S.substring(0,q$J));for(var q$z=q$J,q$b=q$S.length;q$z<q$b;q$z++)if(q$_<(q$W+=q$V=this.getTextWidth(q$S.charAt(q$z))))if(this.wordWrap){var q$H=q$S.substring(q$k,q$z);if(q$H.charCodeAt(q$H.length-1)<255?(q$a=/(?:\w|-)+$/.exec(q$H))&&(q$z=q$a.index+q$k,0==q$a.index?q$z+=q$H.length:q$H=q$S.substring(q$k,q$z)):q$G.RightToLeft&&(q$a=/([\u0600-\u06FF])+$/.exec(q$H))&&(q$z=q$a.index+q$k,0==q$a.index?q$z+=q$H.length:q$H=q$S.substring(q$k,q$z)),q$R.push(q$H),this._lineWidths.push(q$W-q$V),!((q$k=q$z)+q$J<q$b)){q$R.push(q$S.substring(q$k,q$b)),this._lineWidths.push(this.getTextWidth(q$R[q$R.length-1])),q$k=-1;break}q$z+=q$J,q$W=q$V=this.getTextWidth(q$S.substring(q$k,q$z)),q$z--}else if(this.overflow==q$G.HIDDEN)return q$R.push(q$S.substring(0,q$z)),void this._lineWidths.push(this.getTextWidth(q$R[q$R.length-1]));this.wordWrap&&-1!=q$k&&(q$R.push(q$S.substring(q$k,q$b)),this._lineWidths.push(this.getTextWidth(q$R[q$R.length-1])))},q$S.getTextWidth=function(q$S){return this._currBitmapFont?this._currBitmapFont.getTextWidth(q$S):q$O.contextMeasureText(q$S).width},q$S.getWordWrapWidth=function(){var q$S=this.padding,q$_=NaN;return(q$_=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(q$_=this.wordWrap?100:q$g.width),q$_<=0&&(q$_=100),q$_-q$S[3]-q$S[1]},q$S.getCharPoint=function(q$S,q$_){this._isChanged&&q$q.timer.runCallLater(this,this.typeset);for(var q$a=0,q$R=this._lines,q$J=0,q$V=0,q$W=q$R.length;q$V<q$W;q$V++){if(q$S<(q$a+=q$R[q$V].length)){var q$k=q$V;break}q$J=q$a}var q$z=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;q$g.context.font=q$z;var q$b=this.getTextWidth(this._text.substring(q$J,q$S));return(q$_||new q$N).setTo(this._startX+q$b-(this._clipPoint?this._clipPoint.x:0),this._startY+q$k*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},q$t(0,q$S,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(q$S){q$S!=this._width&&(q$q.superSet(q$LS,this,"width",q$S),this.isChanged=!0)}),q$t(0,q$S,"textWidth",function(){return this._isChanged&&q$q.timer.runCallLater(this,this.typeset),this._textWidth}),q$t(0,q$S,"height",function(){return this._height?this._height:this.textHeight},function(q$S){q$S!=this._height&&(q$q.superSet(q$LS,this,"height",q$S),this.isChanged=!0)}),q$t(0,q$S,"textHeight",function(){return this._isChanged&&q$q.timer.runCallLater(this,this.typeset),this._textHeight}),q$t(0,q$S,"padding",function(){return this._getCSSStyle().padding},function(q$S){this._getCSSStyle().padding=q$S,this.isChanged=!0}),q$t(0,q$S,"bold",function(){return this._getCSSStyle().bold},function(q$S){this._getCSSStyle().bold=q$S,this.isChanged=!0}),q$t(0,q$S,"text",function(){return this._text||""},function(q$S){this._text!==q$S&&(this.lang(q$S+""),this.isChanged=!0,this.event("change"))}),q$t(0,q$S,"color",function(){return this._getCSSStyle().color},function(q$S){this._getCSSStyle().color!=q$S&&(this._getCSSStyle().color=q$S,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),q$t(0,q$S,"font",function(){return this._getCSSStyle().fontFamily},function(q$S){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),q$G._bitmapFonts&&q$G._bitmapFonts[q$S]&&(this._currBitmapFont=q$G._bitmapFonts[q$S]),this._getCSSStyle().fontFamily=q$S,this.isChanged=!0}),q$t(0,q$S,"fontSize",function(){return this._getCSSStyle().fontSize},function(q$S){this._getCSSStyle().fontSize=q$S,this.isChanged=!0}),q$t(0,q$S,"italic",function(){return this._getCSSStyle().italic},function(q$S){this._getCSSStyle().italic=q$S,this.isChanged=!0}),q$t(0,q$S,"align",function(){return this._getCSSStyle().align},function(q$S){this._getCSSStyle().align=q$S,this.isChanged=!0}),q$t(0,q$S,"valign",function(){return this._getCSSStyle().valign},function(q$S){this._getCSSStyle().valign=q$S,this.isChanged=!0}),q$t(0,q$S,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(q$S){this._getCSSStyle().wordWrap=q$S,this.isChanged=!0}),q$t(0,q$S,"leading",function(){return this._getCSSStyle().leading},function(q$S){this._getCSSStyle().leading=q$S,this.isChanged=!0}),q$t(0,q$S,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(q$S){this._getCSSStyle().backgroundColor=q$S,this.isChanged=!0}),q$t(0,q$S,"borderColor",function(){return this._getCSSStyle().borderColor},function(q$S){this._getCSSStyle().borderColor=q$S,this.isChanged=!0}),q$t(0,q$S,"stroke",function(){return this._getCSSStyle().stroke},function(q$S){this._getCSSStyle().stroke=q$S,this.isChanged=!0}),q$t(0,q$S,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(q$S){this._getCSSStyle().strokeColor=q$S,this.isChanged=!0}),q$t(0,q$S,"isChanged",null,function(q$S){this._isChanged!==q$S&&(this._isChanged=q$S)&&q$q.timer.callLater(this,this.typeset)}),q$t(0,q$S,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(q$S){if(!(this.overflow!=q$G.SCROLL||this.textWidth<this._width)&&this._clipPoint){q$S=q$S<this.padding[3]?this.padding[3]:q$S;var q$_=this._textWidth-this._width;q$S=q$_<q$S?q$_:q$S;var q$a=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=q$S,this.renderText(this._lastVisibleLineIndex,q$a)}}),q$t(0,q$S,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(q$S){if(!(this.overflow!=q$G.SCROLL||this.textHeight<this._height)&&this._clipPoint){q$S=q$S<this.padding[0]?this.padding[0]:q$S;var q$_=this._textHeight-this._height,q$a=(q$S=q$_<q$S?q$_:q$S)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=q$a;var q$R=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=q$S,this.renderText(q$a,q$R)}}),q$t(0,q$S,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),q$t(0,q$S,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),q$t(0,q$S,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),q$t(0,q$S,"underlineColor",function(){return this._underlineColor},function(q$S){this._underlineColor=q$S,this._isChanged=!0,this.typeset()}),q$G.registerBitmapFont=function(q$S,q$_){q$G._bitmapFonts||(q$G._bitmapFonts={}),q$G._bitmapFonts[q$S]=q$_},q$G.unregisterBitmapFont=function(q$S,q$_){if(void 0===q$_&&(q$_=!0),q$G._bitmapFonts&&q$G._bitmapFonts[q$S]){var q$a=q$G._bitmapFonts[q$S];q$_&&q$a.destroy(),delete q$G._bitmapFonts[q$S]}},q$G.setTextRightToLeft=function(){var q$S;(q$S=q$g.canvas.source.style).display="none",q$S.position="absolute",q$S.direction="rtl",q$K._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,q$g.document.body.appendChild(q$g.canvas.source)},q$G.supportFont=function(q$S){q$g.context.font="10px sans-serif";var q$_=q$O.contextMeasureText("abcji").width;q$g.context.font="10px "+q$S;var q$a=q$O.contextMeasureText("abcji").width;return console.log(q$_,q$a),q$_!==q$a},q$G._testWord="游",q$G.langPacks=null,q$G.VISIBLE="visible",q$G.SCROLL="scroll",q$G.HIDDEN="hidden",q$G.CharacterCache=!0,q$G.RightToLeft=!1,q$G._bitmapFonts=null,q$z(q$G,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),q$G}(q$LS),q$FS=function(q$L){function q$W(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",q$W.__super.call(this),this.offset=new q$N,this._canvasTransform=new q$X,this._previousOrientation=q$g.window.orientation;var q$_=this;this.transform=q$X.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var q$S=q$g.window,q$a=this;q$S.addEventListener("focus",function(){q$_._isFocused=!0,q$a.event("focus"),q$a.event("focuschange")}),q$S.addEventListener("blur",function(){q$_._isFocused=!1,q$a.event("blur"),q$a.event("focuschange"),q$a._isInputting()&&(q$QS.inputElement.target.focus=!1)});var q$R="visibilityState",q$J="visibilitychange",q$V=q$S.document;void 0!==q$V.hidden?(q$J="visibilitychange",q$R="visibilityState"):void 0!==q$V.mozHidden?(q$J="mozvisibilitychange",q$R="mozVisibilityState"):void 0!==q$V.msHidden?(q$J="msvisibilitychange",q$R="msVisibilityState"):void 0!==q$V.webkitHidden&&(q$J="webkitvisibilitychange",q$R="webkitVisibilityState"),q$S.document.addEventListener(q$J,function(){"hidden"==q$g.document[q$R]?q$a._setStageVisible(!1):q$a._setStageVisible(!0)}),q$S.document.addEventListener("qbrowserVisibilityChange",function(q$S){q$a._setStageVisible(!q$S.hidden)}),q$S.addEventListener("resize",function(){var q$S=q$g.window.orientation;null!=q$S&&q$S!=q$_._previousOrientation&&q$a._isInputting()&&(q$QS.inputElement.target.focus=!1),q$_._previousOrientation=q$S,q$a._isInputting()||q$a._resetCanvas()}),q$S.addEventListener("orientationchange",function(q$S){q$a._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),q$g.onMobile&&this.on("mousedown",this,this._onmouseMove)}q$H(q$W,"laya.display.Stage",q$L);var q$S=q$W.prototype;return q$S._setStageVisible=function(q$S){this._isVisibility!=q$S&&(this._isVisibility=q$S,this._isVisibility||this._isInputting()&&(q$QS.inputElement.target.focus=!1),this.event("visibilitychange"))},q$S._isInputting=function(){return q$g.onMobile&&q$QS.isInputting},q$S._changeCanvasSize=function(){this.setScreenSize(q$g.clientWidth*q$g.pixelRatio,q$g.clientHeight*q$g.pixelRatio)},q$S._resetCanvas=function(){if(this.screenAdaptationEnabled){var q$S=q$K._mainCanvas;q$S.source.style;q$S.size(1,1),q$q.timer.once(100,this,this._changeCanvasSize)}},q$S.setScreenSize=function(q$S,q$_){var q$a=!1;if("none"!==this._screenMode&&(q$a=(q$S/q$_<1?"vertical":"horizontal")!==this._screenMode)){var q$R=q$_;q$_=q$S,q$S=q$R}this.canvasRotation=q$a;var q$J=q$K._mainCanvas,q$V=q$J.source.style,q$W=this._canvasTransform.identity(),q$k=this._scaleMode,q$z=q$S/this.designWidth,q$b=q$_/this.designHeight,q$H=this.designWidth,q$L=this.designHeight,q$C=q$S,q$G=q$_,q$t=q$g.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,q$k){case"noscale":q$z=q$b=1,q$C=this.designWidth,q$G=this.designHeight;break;case"showall":q$z=q$b=Math.min(q$z,q$b),q$H=q$C=Math.round(this.designWidth*q$z),q$L=q$G=Math.round(this.designHeight*q$b);break;case"noborder":q$z=q$b=Math.max(q$z,q$b),q$C=Math.round(this.designWidth*q$z),q$G=Math.round(this.designHeight*q$b);break;case"full":q$z=q$b=1,this._width=q$H=q$S,this._height=q$L=q$_;break;case"fixedwidth":q$b=q$z,this._height=q$L=Math.round(q$_/q$z);break;case"fixedheight":q$z=q$b,this._width=q$H=Math.round(q$S/q$b);break;case"fixedauto":q$S/q$_<this.designWidth/this.designHeight?(q$b=q$z,this._height=q$L=Math.round(q$_/q$z)):(q$z=q$b,this._width=q$H=Math.round(q$S/q$b))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,q$H=q$H+1&2147483646,q$L=q$L+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),q$z*=this.scaleX,q$b*=this.scaleY,1===q$z&&1===q$b?this.transform.identity():(this.transform.a=this._formatData(q$z/(q$C/q$H)),this.transform.d=this._formatData(q$b/(q$G/q$L)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),q$J.size(q$H,q$L),q$A.changeWebGLSize(q$H,q$L),q$W.scale(q$C/q$H/q$t,q$G/q$L/q$t),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(q$S-q$C)/q$t:this.offset.x=.5*(q$S-q$C)/q$t,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(q$_-q$G)/q$t:this.offset.y=.5*(q$_-q$G)/q$t,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),q$W.translate(this.offset.x,this.offset.y),this.canvasDegree=0,q$a&&("horizontal"===this._screenMode?(q$W.rotate(Math.PI/2),q$W.translate(q$_/q$t,0),this.canvasDegree=90):(q$W.rotate(-Math.PI/2),q$W.translate(0,q$S/q$t),this.canvasDegree=-90)),q$W.a=this._formatData(q$W.a),q$W.d=this._formatData(q$W.d),q$W.tx=this._formatData(q$W.tx),q$W.ty=this._formatData(q$W.ty),q$V.transformOrigin=q$V.webkitTransformOrigin=q$V.msTransformOrigin=q$V.mozTransformOrigin=q$V.oTransformOrigin="0px 0px 0px",q$V.transform=q$V.webkitTransform=q$V.msTransform=q$V.mozTransform=q$V.oTransform="matrix("+q$W.toString()+")",q$W.translate(parseInt(q$V.left)||0,parseInt(q$V.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},q$S._formatData=function(q$S){return Math.abs(q$S)<1e-6?0:Math.abs(1-q$S)<.001?0<q$S?1:-1:q$S},q$S.getMousePoint=function(){return q$N.TEMP.setTo(this.mouseX,this.mouseY)},q$S.repaint=function(){this._repaint=1},q$S.parentRepaint=function(){},q$S._loop=function(){return this.render(q$K.context,0,0),!0},q$S._onmouseMove=function(q$S){this._mouseMoveTime=q$g.now()},q$S.getTimeFromFrameStart=function(){return q$g.now()-this._frameStartTime},q$S.render=function(q$S,q$_,q$a){if("sleep"===this._frameRate&&!q$K.isConchApp){var q$R=q$g.now();if(!(1e3<=q$R-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(q$c.loopCount++,q$o.instance.runEvent(),q$q.timer._update()));this._frameStartTime=q$R}if(this._renderCount++,q$K.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=q$g.now();var q$J="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),q$V=this._renderCount%2==0;if(q$c.renderSlow=!q$J,q$J||q$V||q$K.isConchApp){var q$W;q$c.loopCount++,q$o.instance.runEvent(),q$q.timer._update(),q$A.update3DLoop();var q$k=0,q$z=0;if(q$K.isConchNode)for(q$k=0,q$z=this._scenes.length;q$k<q$z;q$k++)(q$W=this._scenes[q$k])&&q$W._updateSceneConch();else for(q$k=0,q$z=this._scenes.length;q$k<q$z;q$k++)(q$W=this._scenes[q$k])&&q$W._updateScene();if(q$K.isConchNode){var q$b=q$LS.CustomList;for(q$k=0,q$z=q$b.length;q$k<q$z;q$k++){var q$H=q$b[q$k];q$H.customRender(q$H.customContext,0,0)}return}}q$K.isConchNode||this.renderingEnabled&&(q$J||!q$V||q$K.isConchWebGL)&&(q$K.isWebGL?q$K.WebGL.mainContext&&!q$K.WebGL.mainContext.isContextLost()&&(q$S.clear(),q$L.prototype.render.call(this,q$S,q$_,q$a),q$c._show&&q$c._sp&&q$c._sp.render(q$S,q$_,q$a),q$A.clear(this._bgColor),q$A.beginFlush(),q$S.flush(),q$A.endFinish(),q$w.instance&&q$w.getInstance().endDispose()):(q$A.clear(this._bgColor),q$L.prototype.render.call(this,q$S,q$_,q$a),q$c._show&&q$c._sp&&q$c._sp.render(q$S,q$_,q$a)))}else this._renderCount%5==0&&(q$c.loopCount++,q$o.instance.runEvent(),q$q.timer._update())},q$S._requestFullscreen=function(){var q$S=q$g.document.documentElement;q$S.requestFullscreen?q$S.requestFullscreen():q$S.mozRequestFullScreen?q$S.mozRequestFullScreen():q$S.webkitRequestFullscreen?q$S.webkitRequestFullscreen():q$S.msRequestFullscreen&&q$S.msRequestFullscreen()},q$S._fullScreenChanged=function(){q$q.stage.event("fullscreenchange")},q$S.exitFullscreen=function(){var q$S=q$g.document;q$S.exitFullscreen?q$S.exitFullscreen():q$S.mozCancelFullScreen?q$S.mozCancelFullScreen():q$S.webkitExitFullscreen&&q$S.webkitExitFullscreen()},q$t(0,q$S,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),q$t(0,q$S,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),q$t(0,q$S,"frameRate",function(){return this._frameRate},function(q$S){if(this._frameRate=q$S,q$K.isConchApp)switch(this._frameRate){case"slow":q$g.window.conch&&q$g.window.conchConfig.setSlowFrame&&q$g.window.conchConfig.setSlowFrame(!0);break;case"fast":q$g.window.conch&&q$g.window.conchConfig.setSlowFrame&&q$g.window.conchConfig.setSlowFrame(!1);break;case"mouse":q$g.window.conch&&q$g.window.conchConfig.setMouseFrame&&q$g.window.conchConfig.setMouseFrame(2e3);break;case"sleep":q$g.window.conch&&q$g.window.conchConfig.setLimitFPS&&q$g.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),q$t(0,q$S,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),q$t(0,q$S,"width",q$L.prototype._$get_width,function(q$S){this.designWidth=q$S,q$q.superSet(q$LS,this,"width",q$S),q$q.timer.callLater(this,this._changeCanvasSize)}),q$t(0,q$S,"alignH",function(){return this._alignH},function(q$S){this._alignH=q$S,q$q.timer.callLater(this,this._changeCanvasSize)}),q$t(0,q$S,"isFocused",function(){return this._isFocused}),q$t(0,q$S,"height",q$L.prototype._$get_height,function(q$S){this.designHeight=q$S,q$q.superSet(q$LS,this,"height",q$S),q$q.timer.callLater(this,this._changeCanvasSize)}),q$t(0,q$S,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||q$X.create()},q$L.prototype._$set_transform),q$t(0,q$S,"isVisibility",function(){return this._isVisibility}),q$t(0,q$S,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),q$t(0,q$S,"scaleMode",function(){return this._scaleMode},function(q$S){this._scaleMode=q$S,q$q.timer.callLater(this,this._changeCanvasSize)}),q$t(0,q$S,"alignV",function(){return this._alignV},function(q$S){this._alignV=q$S,q$q.timer.callLater(this,this._changeCanvasSize)}),q$t(0,q$S,"bgColor",function(){return this._bgColor},function(q$S){this._bgColor=q$S,this.conchModel&&this.conchModel.bgColor(q$S),q$K.isWebGL&&(q$S?q$W._wgColor=q$f.create(q$S)._color:q$g.onMiniGame||(q$W._wgColor=null)),q$g.onLimixiu?q$W._wgColor=q$f.create(q$S)._color:q$K.canvas.style.background=q$S||"none"}),q$t(0,q$S,"mouseX",function(){return Math.round(q$o.instance.mouseX/this.clientScaleX)}),q$t(0,q$S,"mouseY",function(){return Math.round(q$o.instance.mouseY/this.clientScaleY)}),q$t(0,q$S,"screenMode",function(){return this._screenMode},function(q$S){this._screenMode=q$S}),q$t(0,q$S,"visible",q$L.prototype._$get_visible,function(q$S){this.visible!==q$S&&(q$q.superSet(q$LS,this,"visible",q$S),q$K._mainCanvas.source.style.visibility=q$S?"visible":"hidden")}),q$t(0,q$S,"fullScreenEnabled",null,function(q$S){var q$_=q$g.document,q$a=q$K.canvas;q$S?(q$a.addEventListener("mousedown",this._requestFullscreen),q$a.addEventListener("touchstart",this._requestFullscreen),q$_.addEventListener("fullscreenchange",this._fullScreenChanged),q$_.addEventListener("mozfullscreenchange",this._fullScreenChanged),q$_.addEventListener("webkitfullscreenchange",this._fullScreenChanged),q$_.addEventListener("msfullscreenchange",this._fullScreenChanged)):(q$a.removeEventListener("mousedown",this._requestFullscreen),q$a.removeEventListener("touchstart",this._requestFullscreen),q$_.removeEventListener("fullscreenchange",this._fullScreenChanged),q$_.removeEventListener("mozfullscreenchange",this._fullScreenChanged),q$_.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),q$_.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),q$W.SCALE_NOSCALE="noscale",q$W.SCALE_EXACTFIT="exactfit",q$W.SCALE_SHOWALL="showall",q$W.SCALE_NOBORDER="noborder",q$W.SCALE_FULL="full",q$W.SCALE_FIXED_WIDTH="fixedwidth",q$W.SCALE_FIXED_HEIGHT="fixedheight",q$W.SCALE_FIXED_AUTO="fixedauto",q$W.ALIGN_LEFT="left",q$W.ALIGN_RIGHT="right",q$W.ALIGN_CENTER="center",q$W.ALIGN_TOP="top",q$W.ALIGN_MIDDLE="middle",q$W.ALIGN_BOTTOM="bottom",q$W.SCREEN_NONE="none",q$W.SCREEN_HORIZONTAL="horizontal",q$W.SCREEN_VERTICAL="vertical",q$W.FRAME_FAST="fast",q$W.FRAME_SLOW="slow",q$W.FRAME_MOUSE="mouse",q$W.FRAME_SLEEP="sleep",q$W.FRAME_MOUSE_THREDHOLD=2e3,q$z(q$W,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),q$W}(q$LS),q$TS=(function(q$S){function q$_(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,q$_.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}q$H(q$_,"laya.media.SoundNode",q$LS);var q$a=q$_.prototype;q$a._onParentChange=function(){this.target=this.parent},q$a.play=function(q$S,q$_){void 0===q$S&&(q$S=1),isNaN(q$S)&&(q$S=1),this.url&&(this.stop(),this._channel=q$I.playSound(this.url,q$S,null,q$_))},q$a.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},q$a._setPlayAction=function(q$S,q$_,q$a,q$R){void 0===q$R&&(q$R=!0),this[q$a]&&q$S&&(q$R?q$S.on(q$_,this,this[q$a]):q$S.off(q$_,this,this[q$a]))},q$a._setPlayActions=function(q$S,q$_,q$a,q$R){if(void 0===q$R&&(q$R=!0),q$S&&q$_){var q$J,q$V=q$_.split(","),q$W=0;for(q$J=q$V.length,q$W=0;q$W<q$J;q$W++)this._setPlayAction(q$S,q$V[q$W],q$a,q$R)}},q$t(0,q$a,"playEvent",null,function(q$S){(this._playEvents=q$S)&&this._tar&&this._setPlayActions(this._tar,q$S,"play")}),q$t(0,q$a,"target",null,function(q$S){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=q$S,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),q$t(0,q$a,"stopEvent",null,function(q$S){(this._stopEvents=q$S)&&this._tar&&this._setPlayActions(this._tar,q$S,"stop")})}(),function(q$S){function q$_(){this._src=null,this._onload=null,this._onerror=null,q$_.__super.call(this)}q$H(q$_,"laya.resource.FileBitmap",q$tS);var q$a=q$_.prototype;return q$t(0,q$a,"src",function(){return this._src},function(q$S){this._src=q$S}),q$t(0,q$a,"onload",null,function(q$S){}),q$t(0,q$a,"onerror",null,function(q$S){}),q$_}()),q$DS=function(q$S){function q$a(q$S,q$_){this._is2D=!1,q$a.__super.call(this);var q$R=this;if(this._source=this,"2D"===q$S||"AUTO"===q$S&&!q$K.isWebGL){this._is2D=!0,this._source=q$_||q$g.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var q$J=this;q$J.getContext=function(q$S,q$_){if(q$R._ctx)return q$R._ctx;var q$a=q$R._ctx=q$R._source.getContext(q$S,q$_);return q$a&&(q$a._canvas=q$J,q$K.isFlash||q$g.onLimixiu||(q$a.size=function(q$S,q$_){})),q$a}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}q$H(q$a,"laya.resource.HTMLCanvas",q$tS);var q$_=q$a.prototype;return q$_.clear=function(){this._ctx&&this._ctx.clear()},q$_.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},q$_.release=function(){},q$_._setContext=function(q$S){this._ctx=q$S},q$_.getContext=function(q$S,q$_){return this._ctx?this._ctx:this._ctx=q$a._createContext(this)},q$_.getMemSize=function(){return 0},q$_.size=function(q$S,q$_){(this._w!=q$S||this._h!=q$_||this._source&&(this._source.width!=q$S||this._source.height!=q$_))&&(this._w=q$S,this._h=q$_,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(q$S,q$_),this._source&&(this._source.height=q$_,this._source.width=q$S))},q$_.getCanvas=function(){return this._source},q$_.toBase64=function(q$S,q$_,q$a){if(this._source)if(q$K.isConchApp&&this._source.toBase64)this._source.toBase64(q$S,q$_,q$a);else{var q$R=this._source.toDataURL(q$S,q$_);q$a.call(this,q$R)}},q$t(0,q$_,"context",function(){return this._ctx}),q$t(0,q$_,"asBitmap",null,function(q$S){}),q$a.create=function(q$S,q$_){return new q$a(q$S,q$_)},q$a.TYPE2D="2D",q$a.TYPE3D="3D",q$a.TYPEAUTO="AUTO",q$a._createContext=null,q$a}(),q$jS=(function(q$S){function q$z(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){throw q$z.__super.call(this),new Error("不允许new！")}q$H(q$z,"laya.resource.HTMLSubImage",q$tS),q$z.create=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){return void 0===q$k&&(q$k=!1),new q$z(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k)}}(),function(q$S){function q$L(){this._frames=null,this._url=null,q$L.__super.call(this),this._setControlNode(this)}q$H(q$L,"laya.display.Animation",q$S);var q$_=q$L.prototype;q$_.destroy=function(q$S){void 0===q$S&&(q$S=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,q$S),this._frames=null,this._labels=null},q$_.play=function(q$S,q$_,q$a,q$R){void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=!0),void 0===q$a&&(q$a=""),void 0===q$R&&(q$R=!0),q$a&&this._setFramesFromCache(q$a,q$R),this._isPlaying=!0,this.index="string"==typeof q$S?this._getFrameByLabel(q$S):q$S,this.loop=q$_,this._actionName=q$a,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},q$_._setFramesFromCache=function(q$S,q$_){var q$a;return void 0===q$_&&(q$_=!1),this._url&&(q$S=this._url+"#"+q$S),q$S&&q$L.framesMap[q$S]?((q$a=q$L.framesMap[q$S])instanceof Array?(this._frames=q$L.framesMap[q$S],this._count=this._frames.length):(q$a.nodeRoot&&(q$L.framesMap[q$S]=this._parseGraphicAnimationByData(q$a),q$a=q$L.framesMap[q$S]),this._frames=q$a.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=q$a.interval),this._labels=this._copyLabels(q$a.labels)),!0):(q$_&&console.log("ani not found:",q$S),!1)},q$_._copyLabels=function(q$S){if(!q$S)return null;var q$_,q$a;for(q$a in q$_={},q$S)q$_[q$a]=q$O.copyArray([],q$S[q$a]);return q$_},q$_._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&q$S.prototype._frameLoop.call(this)},q$_._displayToIndex=function(q$S){this._frames&&(this.graphics=this._frames[q$S])},q$_.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},q$_.loadImages=function(q$S,q$_){return void 0===q$_&&(q$_=""),this._url="",this._setFramesFromCache(q$_)||(this.frames=q$L.framesMap[q$_]?q$L.framesMap[q$_]:q$L.createFrames(q$S,q$_)),this},q$_.loadAtlas=function(q$_,q$a,q$R){void 0===q$R&&(q$R=""),this._url="";var q$J=this;function q$S(q$S){q$_===q$S&&(q$J.frames=q$L.framesMap[q$R]?q$L.framesMap[q$R]:q$L.createFrames(q$_,q$R),q$a&&q$a.run())}return q$J._setFramesFromCache(q$R)||(q$kS.getAtlas(q$_)?q$S(q$_):q$q.loader.load(q$_,q$T.create(null,q$S,[q$_]),null,"atlas")),this},q$_.loadAnimation=function(q$S,q$_,q$a){this._url=q$S;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,q$_&&q$_.run()):!q$a||q$kS.getAtlas(q$a)?this._loadAnimationData(q$S,q$_,q$a):q$q.loader.load(q$a,q$T.create(this,this._loadAnimationData,[q$S,q$_,q$a]),null,"atlas"),this},q$_._loadAnimationData=function(q$k,q$z,q$S){var q$b=this;if(!q$S||q$kS.getAtlas(q$S)){var q$H=this;q$kS.getRes(q$k)?q$_(q$k):q$q.loader.load(q$k,q$T.create(null,q$_,[q$k]),null,"json"),q$kS.clearRes(q$k)}else console.warn("atlas load fail:"+q$S);function q$_(q$S){if(q$kS.getRes(q$S)&&q$k===q$S){var q$_;if(q$L.framesMap[q$k+"#"])q$H._setFramesFromCache(q$b._actionName,!0),q$b.index=0,q$b._checkResumePlaying();else{var q$a=q$H._parseGraphicAnimation(q$kS.getRes(q$k));if(!q$a)return;var q$R,q$J=q$a.animationList,q$V=0,q$W=q$J.length;for(q$V=0;q$V<q$W;q$V++)q$_=q$J[q$V],q$L.framesMap[q$k+"#"+q$_.name]=q$_,q$R||(q$R=q$_);q$R&&(q$L.framesMap[q$k+"#"]=q$R,q$H._setFramesFromCache(q$b._actionName,!0),q$b.index=0),q$b._checkResumePlaying()}q$z&&q$z.run()}}},q$_._parseGraphicAnimation=function(q$S){return q$qS.parseAnimationData(q$S)},q$_._parseGraphicAnimationByData=function(q$S){return q$qS.parseAnimationByData(q$S)},q$t(0,q$_,"frames",function(){return this._frames},function(q$S){(this._frames=q$S)&&(this._count=q$S.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),q$t(0,q$_,"autoPlay",null,function(q$S){q$S?this.play():this.stop()}),q$t(0,q$_,"source",null,function(q$S){-1<q$S.indexOf(".ani")?this.loadAnimation(q$S):-1<q$S.indexOf(".json")||-1<q$S.indexOf("als")||-1<q$S.indexOf("atlas")?this.loadAtlas(q$S):this.loadImages(q$S.split(","))}),q$t(0,q$_,"autoAnimation",null,function(q$S){this.play(0,!0,q$S,!1)}),q$L.createFrames=function(q$S,q$_){var q$a,q$R,q$J=0,q$V=0;if("string"==typeof q$S){var q$W=q$kS.getAtlas(q$S);if(q$W&&q$W.length)for(q$a=[],q$J=0,q$V=q$W.length;q$J<q$V;q$J++)(q$R=new q$A.createGraphics).drawTexture(q$kS.getRes(q$W[q$J]),0,0),q$a.push(q$R)}else if(q$S instanceof Array)for(q$a=[],q$J=0,q$V=q$S.length;q$J<q$V;q$J++)(q$R=new q$A.createGraphics).loadImage(q$S[q$J],0,0),q$a.push(q$R);return q$_&&(q$L.framesMap[q$_]=q$a),q$a},q$L.clearCache=function(q$S){var q$_,q$a=q$L.framesMap,q$R=q$S+"#";for(q$_ in q$a)q$_!==q$S&&0!=q$_.indexOf(q$R)||delete q$L.framesMap[q$_]},q$L.framesMap={}}(q$oS),function(q$S){function q$V(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,q$V.__super.call(this),null==q$V._sortIndexFun&&(q$V._sortIndexFun=q$m.sortByKey("index",!1,!0))}q$H(q$V,"laya.display.FrameAnimation",q$S);var q$_=q$V.prototype;return q$_._setUp=function(q$S,q$_){this._labels=null,this._animationNewFrames=null,this._targetDic=q$S,this._animationData=q$_,this.interval=1e3/q$_.frameRate,q$_.parsed?(this._count=q$_.count,this._labels=q$_.labels,this._animationNewFrames=q$_.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),q$_.parsed=!0,q$_.labels=this._labels,q$_.count=this._count,q$_.animationNewFrames=this._animationNewFrames},q$_.clear=function(){q$S.prototype.clear.call(this),this._targetDic=null,this._animationData=null},q$_._displayToIndex=function(q$S){if(this._animationData){q$S<0&&(q$S=0),q$S>this._count&&(q$S=this._count);var q$_=this._animationData.nodes,q$a=0,q$R=q$_.length;for(q$a=0;q$a<q$R;q$a++)this._displayNodeToFrame(q$_[q$a],q$S)}},q$_._displayNodeToFrame=function(q$S,q$_,q$a){q$a||(q$a=this._targetDic);var q$R=q$a[q$S.target];if(q$R){var q$J,q$V,q$W,q$k=q$S.frames,q$z=q$S.keys,q$b=0,q$H=q$z.length;for(q$b=0;q$b<q$H;q$b++)q$W=(q$V=q$k[q$J=q$z[q$b]]).length>q$_?q$V[q$_]:q$V[q$V.length-1],q$R[q$J]=q$W}},q$_._calculateDatas=function(){if(this._animationData){var q$S,q$_=this._animationData.nodes,q$a=0,q$R=q$_.length;for(q$a=this._count=0;q$a<q$R;q$a++)q$S=q$_[q$a],this._calculateNodeKeyFrames(q$S);this._count+=1}},q$_._calculateNodeKeyFrames=function(q$S){var q$_,q$a,q$R=q$S.keyframes,q$J=q$S.target;for(q$_ in q$S.frames||(q$S.frames={}),q$S.keys?q$S.keys.length=0:q$S.keys=[],q$S.initValues||(q$S.initValues={}),q$R)q$a=q$R[q$_],q$S.frames[q$_]||(q$S.frames[q$_]=[]),this._targetDic&&this._targetDic[q$J]&&(q$S.initValues[q$_]=this._targetDic[q$J][q$_]),q$a.sort(q$V._sortIndexFun),q$S.keys.push(q$_),this._calculateNodePropFrames(q$a,q$S.frames[q$_],q$_,q$J)},q$_.resetToInitState=function(){if(this._targetDic&&this._animationData){var q$S,q$_,q$a=this._animationData.nodes,q$R=0,q$J=q$a.length;for(q$R=0;q$R<q$J;q$R++)if(q$_=(q$S=q$a[q$R]).initValues){var q$V,q$W=this._targetDic[q$S.target];if(q$W)for(q$V in q$_)q$W[q$V]=q$_[q$V]}}},q$_._calculateNodePropFrames=function(q$S,q$_,q$a,q$R){var q$J=0,q$V=q$S.length-1;if(0<q$V){for(q$_.length=q$S[q$V].index+1,q$J=0;q$J<q$V;q$J++)this._dealKeyFrame(q$S[q$J]),this._calculateFrameValues(q$S[q$J],q$S[q$J+1],q$_);this._dealKeyFrame(q$S[q$J])}0==q$V&&(q$_[q$S[0].index]=q$S[0].value,this._animationNewFrames&&(this._animationNewFrames[q$S[0].index]=!0))},q$_._dealKeyFrame=function(q$S){q$S.label&&""!=q$S.label&&this.addLabel(q$S.label,q$S.index)},q$_._calculateFrameValues=function(q$S,q$_,q$a){var q$R,q$J=0,q$V=q$S.index,q$W=q$_.index,q$k=q$S.value,q$z=q$_.value-q$S.value,q$b=q$W-q$V;if(q$W>this._count&&(this._count=q$W),q$S.tween)for(null==(q$R=q$i[q$S.tweenMethod])&&(q$R=q$i.linearNone),q$J=q$V;q$J<q$W;q$J++)q$a[q$J]=q$R(q$J-q$V,q$k,q$z,q$b),this._animationNewFrames&&(this._animationNewFrames[q$J]=!0);else for(q$J=q$V;q$J<q$W;q$J++)q$a[q$J]=q$k;this._animationNewFrames&&(this._animationNewFrames[q$S.index]=!0,this._animationNewFrames[q$_.index]=!0),q$a[q$_.index]=q$_.value},q$V._sortIndexFun=null,q$V}(q$oS)),q$QS=function(q$_){function q$J(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",q$J.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=q$$S.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}q$H(q$J,"laya.display.Input",q$_);var q$S=q$J.prototype;return q$S.setSelection=function(q$S,q$_){this.focus=!0,laya.display.Input.inputElement.selectionStart=q$S,laya.display.Input.inputElement.selectionEnd=q$_},q$S._onUnDisplay=function(q$S){this.focus=!1},q$S._onMouseDown=function(q$S){this.focus=!0},q$S._syncInputTransform=function(){var q$S=this.nativeInput,q$_=q$O.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),q$a=this._width-this.padding[1]-this.padding[3],q$R=this._height-this.padding[0]-this.padding[2];q$K.isConchApp?(q$S.setScale(q$_.scaleX,q$_.scaleY),q$S.setSize(q$a,q$R),q$S.setPos(q$_.x,q$_.y)):(q$J.inputContainer.style.transform=q$J.inputContainer.style.webkitTransform="scale("+q$_.scaleX+","+q$_.scaleY+") rotate("+q$q.stage.canvasDegree+"deg)",q$S.style.width=q$a+"px",q$S.style.height=q$R+"px",q$J.inputContainer.style.left=q$_.x+"px",q$J.inputContainer.style.top=q$_.y+"px")},q$S.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},q$S._setInputMethod=function(){q$J.input.parentElement&&q$J.inputContainer.removeChild(q$J.input),q$J.area.parentElement&&q$J.inputContainer.removeChild(q$J.area),q$J.inputElement=this._multiline?q$J.area:q$J.input,q$J.inputContainer.appendChild(q$J.inputElement),q$$S.RightToLeft&&(q$J.inputElement.style.direction="rtl")},q$S._focusIn=function(){laya.display.Input.isInputting=!0;var q$S=this.nativeInput;this._focus=!0;var q$_=q$S.style;q$_.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),q$S.readOnly=!this._editable,q$K.isConchApp&&(q$S.setType(this._type),q$S.setForbidEdit(!this._editable)),q$S.maxLength=this._maxChars;this.padding;if(q$S.type=this._type,q$S.value=this._content,q$S.placeholder=this._prompt,q$q.stage.off("keydown",this,this._onKeyDown),q$q.stage.on("keydown",this,this._onKeyDown),(q$q.stage.focus=this).event("focus"),q$g.onPC&&q$S.focus(),!q$g.onMiniGame){this._text;this._text=null}this.typeset(),q$S.setColor(this._originColor),q$S.setFontSize(this.fontSize),q$S.setFontFace(q$g.onIPhone&&q$$S._fontFamilyMap[this.font]||this.font),q$K.isConchApp&&q$S.setMultiAble&&q$S.setMultiAble(this._multiline),q$_.lineHeight=this.leading+this.fontSize+"px",q$_.fontStyle=this.italic?"italic":"normal",q$_.fontWeight=this.bold?"bold":"normal",q$_.textAlign=this.align,q$_.padding="0 0",this._syncInputTransform(),!q$K.isConchApp&&q$g.onPC&&q$q.timer.frameLoop(1,this,this._syncInputTransform)},q$S._setPromptColor=function(){(q$J.promptStyleDOM=q$g.getElementById("promptStyle"))||((q$J.promptStyleDOM=q$g.createElement("style")).setAttribute("id","promptStyle"),q$g.document.head.appendChild(q$J.promptStyleDOM)),q$J.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},q$S._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(q$q.superSet(q$$S,this,"text",this._content),q$q.superSet(q$$S,this,"color",this._originColor)):(q$q.superSet(q$$S,this,"text",this._prompt),q$q.superSet(q$$S,this,"color",this._promptColor)),q$q.stage.off("keydown",this,this._onKeyDown),q$q.stage.focus=null,this.event("blur"),q$K.isConchApp&&this.nativeInput.blur(),q$g.onPC&&q$q.timer.clear(this,this._syncInputTransform)},q$S._onKeyDown=function(q$S){13===q$S.keyCode&&(q$g.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},q$S.changeText=function(q$S){this._content=q$S,this._focus?(this.nativeInput.value=q$S||"",this.event("change")):q$_.prototype.changeText.call(this,q$S)},q$t(0,q$S,"color",q$_.prototype._$get_color,function(q$S){this._focus&&this.nativeInput.setColor(q$S),q$q.superSet(q$$S,this,"color",this._content?q$S:this._promptColor),this._originColor=q$S}),q$t(0,q$S,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(q$S){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),q$t(0,q$S,"multiline",function(){return this._multiline},function(q$S){this._multiline=q$S,this.valign=q$S?"top":"middle"}),q$t(0,q$S,"maxChars",function(){return this._maxChars},function(q$S){q$S<=0&&(q$S=1e5),this._maxChars=q$S}),q$t(0,q$S,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(q$S){q$q.superSet(q$$S,this,"color",this._originColor),q$S+="",this._focus?(this.nativeInput.value=q$S||"",this.event("change")):(this._multiline||(q$S=q$S.replace(/\r?\n/g,"")),(this._content=q$S)?q$q.superSet(q$$S,this,"text",q$S):(q$q.superSet(q$$S,this,"text",this._prompt),q$q.superSet(q$$S,this,"color",this.promptColor)))}),q$t(0,q$S,"nativeInput",function(){return this._multiline?q$J.area:q$J.input}),q$t(0,q$S,"prompt",function(){return this._prompt},function(q$S){!this._text&&q$S&&q$q.superSet(q$$S,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?q$q.superSet(q$$S,this,"text",this._text==this._prompt?q$S:this._text):q$q.superSet(q$$S,this,"text",q$S),this._prompt=q$$S.langPacks&&q$$S.langPacks[q$S]?q$$S.langPacks[q$S]:q$S}),q$t(0,q$S,"focus",function(){return this._focus},function(q$S){var q$_=this.nativeInput;this._focus!==q$S&&(q$S?(q$_.target?q$_.target._focusOut():this._setInputMethod(),(q$_.target=this)._focusIn()):(q$_.target=null,this._focusOut(),q$g.document.body.scrollTop=0,q$_.blur(),q$K.isConchApp?q$_.setPos(-1e4,-1e4):q$J.inputContainer.contains(q$_)&&q$J.inputContainer.removeChild(q$_)))}),q$t(0,q$S,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(q$S){q$S?(-1<(q$S="[^"+q$S+"]").indexOf("^^")&&(q$S=q$S.replace("^^","")),this._restrictPattern=new RegExp(q$S,"g")):this._restrictPattern=null}),q$t(0,q$S,"editable",function(){return this._editable},function(q$S){this._editable=q$S,q$K.isConchApp&&q$J.input.setForbidEdit(!q$S)}),q$t(0,q$S,"promptColor",function(){return this._promptColor},function(q$S){this._promptColor=q$S,this._content||q$q.superSet(q$$S,this,"color",q$S)}),q$t(0,q$S,"type",function(){return this._type},function(q$S){this._getCSSStyle().password="password"==q$S,this._type=q$S,q$K.isConchApp&&this.nativeInput.setType(q$S)}),q$t(0,q$S,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(q$S){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),q$t(0,q$S,"asPassword",function(){return this._getCSSStyle().password},function(q$S){this._getCSSStyle().password=q$S,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),q$J.__init__=function(){q$J._createInputElement(),q$g.onMobile&&q$K.canvas.addEventListener(q$J.IOS_IFRAME?q$g.onMiniGame?"touchend":"click":"touchend",q$J._popupInputMethod)},q$J._popupInputMethod=function(q$S){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},q$J._createInputElement=function(){q$J._initInput(q$J.area=q$g.createElement("textarea")),q$J._initInput(q$J.input=q$g.createElement("input")),(q$J.inputContainer=q$g.createElement("div")).style.position="absolute",q$J.inputContainer.style.zIndex=1e5,q$g.container.appendChild(q$J.inputContainer),q$J.inputContainer.setPos=function(q$S,q$_){q$J.inputContainer.style.left=q$S+"px",q$J.inputContainer.style.top=q$_+"px"}},q$J._initInput=function(q$_){var q$S=q$_.style;q$S.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",q$S.resize="none",q$S.backgroundColor="transparent",q$S.border="none",q$S.outline="none",q$S.zIndex=1,q$_.addEventListener("input",q$J._processInputting),q$_.addEventListener("mousemove",q$J._stopEvent),q$_.addEventListener("mousedown",q$J._stopEvent),q$_.addEventListener("touchmove",q$J._stopEvent),q$_.setFontFace=function(q$S){q$_.style.fontFamily=q$S},q$K.isConchApp||(q$_.setColor=function(q$S){q$_.style.color=q$S},q$_.setFontSize=function(q$S){q$_.style.fontSize=q$S+"px"})},q$J._processInputting=function(q$S){var q$_=laya.display.Input.inputElement.target;if(q$_){var q$a=laya.display.Input.inputElement.value;q$_._restrictPattern&&(q$a=q$a.replace(/\u2006|\x27/g,""),q$_._restrictPattern.test(q$a)&&(q$a=q$a.replace(q$_._restrictPattern,""),laya.display.Input.inputElement.value=q$a)),q$_._text=q$a,q$_.event("input")}},q$J._stopEvent=function(q$S){"touchmove"==q$S.type&&q$S.preventDefault(),q$S.stopPropagation&&q$S.stopPropagation()},q$J.TYPE_TEXT="text",q$J.TYPE_PASSWORD="password",q$J.TYPE_EMAIL="email",q$J.TYPE_URL="url",q$J.TYPE_NUMBER="number",q$J.TYPE_RANGE="range",q$J.TYPE_DATE="date",q$J.TYPE_MONTH="month",q$J.TYPE_WEEK="week",q$J.TYPE_TIME="time",q$J.TYPE_DATE_TIME="datetime",q$J.TYPE_DATE_TIME_LOCAL="datetime-local",q$J.TYPE_SEARCH="search",q$J.input=null,q$J.area=null,q$J.inputElement=null,q$J.inputContainer=null,q$J.confirmButton=null,q$J.promptStyleDOM=null,q$J.inputHeight=45,q$J.isInputting=!1,q$J.stageMatrix=null,q$z(q$J,["IOS_IFRAME",function(){return this.IOS_IFRAME=q$g.onIOS&&q$g.window.top!=q$g.window.self}]),q$J}(q$$S),q$mS=function(q$S){function q$a(q$S,q$_){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,q$a.__super.call(this),q$S&&this._init_(q$S,q$_)}q$H(q$a,"laya.resource.HTMLImage",q$TS);var q$_=q$a.prototype;return q$_._init_=function(q$S,q$_){this._src=q$S,this._source=new q$g.window.Image,q$_&&(q$_.onload&&(this.onload=q$_.onload),q$_.onerror&&(this.onerror=q$_.onerror),q$_.onCreate&&q$_.onCreate(this)),0!=q$S.indexOf("data:image")&&(this._source.crossOrigin=""),q$S&&(this._source.src=q$S)},q$_.recreateResource=function(){var q$S=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var q$_=this;this._source=new q$g.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(q$_._needReleaseAgain)return q$_._needReleaseAgain=!1,q$_._source.onload=null,void(q$_._source=null);q$_._source.onload=null,q$_.memorySize=q$S._w*q$S._h*4,q$_._recreateLock=!1,q$_.completeCreate()},this._source.src=this._src}},q$_.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},q$_.onresize=function(){this._w=this._source.width,this._h=this._source.height},q$t(0,q$_,"onload",null,function(q$S){var q$_=this;this._onload=q$S,this._source&&(this._source.onload=null!=this._onload?function(){q$_.onresize(),q$_._onload()}:null)}),q$t(0,q$_,"onerror",null,function(q$S){var q$_=this;this._onerror=q$S,this._source&&(this._source.onerror=null!=this._onerror?function(){q$_._onerror()}:null)}),q$t(0,q$_,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(q$S){this._enableMerageInAtlas=q$S,q$K.isConchApp&&this._source&&(this._source.enableMerageInAtlas=q$S)}),q$a.create=function(q$S,q$_){return new q$a(q$S,q$_)},q$a}(),q$qS=(function(q$V){function q$S(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,q$S.__super.call(this)}q$H(q$S,"laya.display.EffectAnimation",q$V);var q$_=q$S.prototype;q$_._onOtherBegin=function(q$S){q$S!=this&&this.stop()},q$_.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},q$_._onPlayAction=function(){this.play(0,!1)},q$_.play=function(q$S,q$_,q$a,q$R){void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=!0),void 0===q$a&&(q$a=""),void 0===q$R&&(q$R=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,q$S,q$_,q$a,q$R))},q$_._recordInitData=function(){if(this._aniKeys){var q$S,q$_,q$a=0;for(q$S=this._aniKeys.length,q$a=0;q$a<q$S;q$a++)q$_=this._aniKeys[q$a],this._initData[q$_]=this._target[q$_]}},q$_._displayToIndex=function(q$S){if(this._animationData){q$S<0&&(q$S=0),q$S>this._count&&(q$S=this._count);var q$_=this._animationData.nodes,q$a=0,q$R=q$_.length;for(q$R=1<q$R?1:q$R,q$a=0;q$a<q$R;q$a++)this._displayNodeToFrame(q$_[q$a],q$S)}},q$_._displayNodeToFrame=function(q$S,q$_,q$a){if(this._target){var q$R;q$R=this._target;var q$J,q$V,q$W,q$k,q$z=q$S.frames,q$b=q$S.keys,q$H=0,q$L=q$b.length;q$k=q$S.secondFrames;var q$C,q$G,q$t,q$o,q$$=0;for(q$H=0;q$H<q$L;q$H++)q$V=q$z[q$J=q$b[q$H]],q$W=-1==(q$$=q$k[q$J])?this._initData[q$J]:q$_<q$$?(q$t=(q$G=q$S.keyframes[q$J])[0]).tween?(null==(q$C=q$i[q$t.tweenMethod])&&(q$C=q$i.linearNone),q$o=q$G[1],q$C(q$_,this._initData[q$J],q$o.value-this._initData[q$J],q$o.index)):this._initData[q$J]:q$V.length>q$_?q$V[q$_]:q$V[q$V.length-1],q$R[q$J]=q$W}},q$_._calculateNodeKeyFrames=function(q$S){q$V.prototype._calculateNodeKeyFrames.call(this,q$S);var q$_,q$a,q$R,q$J=q$S.keyframes;q$S.target;for(q$_ in q$R={},q$S.secondFrames=q$R,q$J)(q$a=q$J[q$_]).length<=1?q$R[q$_]=-1:q$R[q$_]=q$a[1].index},q$t(0,q$_,"target",function(){return this._target},function(q$S){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=q$S,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),q$t(0,q$_,"playEvent",null,function(q$S){(this._playEvents=q$S)&&this.addEvent()}),q$t(0,q$_,"effectData",null,function(q$S){var q$_;q$S&&((q$_=q$S.animations)&&q$_[0]&&(this._setUp({},q$_[0]),q$_[0].nodes&&q$_[0].nodes[0]&&(this._aniKeys=q$_[0].nodes[0].keys)))}),q$t(0,q$_,"effectClass",null,function(q$S){var q$_,q$a;(this._effectClass=q$U.getClass(q$S),this._effectClass)&&((q$_=this._effectClass.uiView)&&(q$a=q$_.animations)&&q$a[0]&&(this._setUp({},q$a[0]),q$a[0].nodes&&q$a[0].nodes[0]&&(this._aniKeys=q$a[0].nodes[0].keys)))}),q$S.EffectAnimationBegin="effectanimationbegin"}(q$jS),function(q$_){var q$B;function q$I(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,q$I.__super.call(this)}q$H(q$I,"laya.utils.GraphicAnimation",q$_);var q$S=q$I.prototype;return q$S._parseNodeList=function(q$S){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[q$S.compId]=q$S.props,q$S.compId&&this._nodeList.push(q$S.compId);var q$_=q$S.child;if(q$_){var q$a=0,q$R=q$_.length;for(q$a=0;q$a<q$R;q$a++)this._parseNodeList(q$_[q$a])}},q$S._calGraphicData=function(q$S){var q$_;if(this._setUp(null,q$S),this._createGraphicData(),this._nodeIDAniDic)for(q$_ in this._nodeIDAniDic)this._nodeIDAniDic[q$_]=null},q$S._createGraphicData=function(){var q$S,q$_=[],q$a=0,q$R=this.count,q$J=this._animationNewFrames;for(q$J||(q$J=[]),q$a=0;q$a<q$R;q$a++)!q$J[q$a]&&q$S||(q$S=this._createFrameGraphic(q$a)),q$_.push(q$S);this._gList=q$_},q$S._createFrameGraphic=function(q$S){var q$_=q$A.createGraphics();return q$I._rootMatrix||(q$I._rootMatrix=new q$X),this._updateNodeGraphic(this._rootNode,q$S,q$I._rootMatrix,q$_),q$_},q$S._updateNodeGraphic=function(q$S,q$_,q$a,q$R,q$J){var q$V;void 0===q$J&&(q$J=1);var q$W,q$k,q$z,q$b=(q$V=this._nodeGDic[q$S.compId]=this._getNodeGraphicData(q$S.compId,q$_,this._nodeGDic[q$S.compId])).alpha*q$J;if(!(q$b<.01)&&(q$V.resultTransform||(q$V.resultTransform=q$X.create()),q$W=q$V.resultTransform,q$X.mul(q$V.transform,q$a,q$W),q$V.skin&&(q$k=this._getTextureByUrl(q$V.skin))&&(q$W._checkTransform()?(q$R.drawTexture(q$k,0,0,q$V.width,q$V.height,q$W,q$b),q$V.resultTransform=null):q$R.drawTexture(q$k,q$W.tx,q$W.ty,q$V.width,q$V.height,null,q$b)),q$z=q$S.child)){var q$H,q$L=0;for(q$H=q$z.length,q$L=0;q$L<q$H;q$L++)this._updateNodeGraphic(q$z[q$L],q$_,q$W,q$R,q$b)}},q$S._updateNoChilds=function(q$S,q$_){if(q$S.skin){var q$a=this._getTextureByUrl(q$S.skin);if(q$a){var q$R=q$S.transform;q$R._checkTransform();!q$R.bTransform?q$_.drawTexture(q$a,q$R.tx,q$R.ty,q$S.width,q$S.height,null,q$S.alpha):q$_.drawTexture(q$a,0,0,q$S.width,q$S.height,q$R.clone(),q$S.alpha)}}},q$S._updateNodeGraphic2=function(q$S,q$_,q$a){var q$R;if(q$R=this._nodeGDic[q$S.compId]=this._getNodeGraphicData(q$S.compId,q$_,this._nodeGDic[q$S.compId]),q$S.child){var q$J=q$R.transform;q$J._checkTransform();var q$V,q$W;q$W=(q$V=!q$J.bTransform)&&(0!=q$J.tx||0!=q$J.ty);var q$k,q$z,q$b;if((q$k=q$J.bTransform||1!=q$R.alpha)&&q$a.save(),1!=q$R.alpha&&q$a.alpha(q$R.alpha),q$V?q$W&&q$a.translate(q$J.tx,q$J.ty):q$a.transform(q$J.clone()),q$z=q$S.child,q$R.skin&&(q$b=this._getTextureByUrl(q$R.skin))&&q$a.drawTexture(q$b,0,0,q$R.width,q$R.height),q$z){var q$H,q$L=0;for(q$H=q$z.length,q$L=0;q$L<q$H;q$L++)this._updateNodeGraphic2(q$z[q$L],q$_,q$a)}q$k?q$a.restore():q$V?q$W&&q$a.translate(-q$J.tx,-q$J.ty):q$a.transform(q$J.clone().invert())}else this._updateNoChilds(q$R,q$a)},q$S._calculateNodeKeyFrames=function(q$S){q$_.prototype._calculateNodeKeyFrames.call(this,q$S),this._nodeIDAniDic[q$S.target]=q$S},q$S.getNodeDataByID=function(q$S){return this._nodeIDAniDic[q$S]},q$S._getParams=function(q$S,q$_,q$a,q$R){var q$J=q$I._temParam;q$J.length=q$_.length;var q$V=0,q$W=q$_.length;for(q$V=0;q$V<q$W;q$V++)q$J[q$V]=this._getObjVar(q$S,q$_[q$V][0],q$a,q$_[q$V][1],q$R);return q$J},q$S._getObjVar=function(q$S,q$_,q$a,q$R,q$J){if(q$S.hasOwnProperty(q$_)){var q$V=q$S[q$_];if(q$a>=q$V.length&&(q$a=q$V.length-1),null!=q$S[q$_][q$a])return q$S[q$_][q$a]}return q$J.hasOwnProperty(q$_)?q$J[q$_]:q$R},q$S._getNodeGraphicData=function(q$S,q$_,q$a){q$a||(q$a=q$B.create()),q$a.transform?q$a.transform.identity():q$a.transform=q$X.create();var q$R=this.getNodeDataByID(q$S);if(!q$R)return q$a;var q$J,q$V,q$W=q$R.frames,q$k=this._getParams(q$W,q$I._drawTextureCmd,q$_,this._nodeDefaultProps[q$S]),q$z=q$k[0],q$b=NaN,q$H=NaN,q$L=q$k[5],q$C=q$k[6],q$G=q$k[13],q$t=q$k[14],q$o=q$k[7],q$$=q$k[8],q$F=q$k[9],q$T=q$k[11],q$D=q$k[12];q$b=q$k[3],q$H=q$k[4],0!=q$b&&0!=q$H||(q$z=null),-1==q$b&&(q$b=0),-1==q$H&&(q$H=0),q$a.skin=q$z,q$a.width=q$b,q$a.height=q$H,q$z&&((q$J=this._getTextureByUrl(q$z))?(q$b||(q$b=q$J.sourceWidth),q$H||(q$H=q$J.sourceHeight)):console.warn("lost skin:",q$z,",you may load pics first")),q$a.alpha=q$k[10],q$V=q$a.transform,0!=q$G&&(q$L=q$G*q$b),0!=q$t&&(q$C=q$t*q$H),0==q$L&&0==q$C||q$V.translate(-q$L,-q$C);var q$j=null;if(q$F||1!==q$o||1!==q$$||q$T||q$D){(q$j=q$I._tempMt).identity(),q$j.bTransform=!0;var q$Q=.0174532922222222*(q$F-q$T),q$m=.0174532922222222*(q$F+q$D),q$q=Math.cos(q$m),q$N=Math.sin(q$m),q$n=Math.sin(q$Q),q$l=Math.cos(q$Q);q$j.a=q$o*q$q,q$j.b=q$o*q$N,q$j.c=-q$$*q$n,q$j.d=q$$*q$l,q$j.tx=q$j.ty=0}return q$j&&(q$V=q$X.mul(q$V,q$j,q$V)),q$V.translate(q$k[1],q$k[2]),q$a},q$S._getTextureByUrl=function(q$S){return q$kS.getRes(q$S)},q$S.setAniData=function(q$S,q$_){if(q$S.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=q$S,this._parseNodeList(q$S);var q$a,q$R={},q$J=[],q$V=q$S.animations,q$W=0,q$k=q$V.length;for(q$W=0;q$W<q$k;q$W++)if(q$a=q$V[q$W],this._labels=null,(!q$_||q$_==q$a.name)&&q$a){try{this._calGraphicData(q$a)}catch(q$S){console.warn("parse animation fail:"+q$a.name+",empty animation created"),this._gList=[]}var q$z={};q$z.interval=1e3/q$a.frameRate,q$z.frames=this._gList,q$z.labels=this._labels,q$z.name=q$a.name,q$J.push(q$z),q$R[q$a.name]=q$z}this.animationList=q$J,this.animationDic=q$R}q$I._temParam.length=0},q$S.parseByData=function(q$S){var q$_,q$a;q$_=q$S.nodeRoot,q$a=q$S.aniO,delete q$S.nodeRoot,delete q$S.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=q$_,this._parseNodeList(q$_),this._labels=null;try{this._calGraphicData(q$a)}catch(q$S){console.warn("parse animation fail:"+q$a.name+",empty animation created"),this._gList=[]}var q$R=q$S;return q$R.interval=1e3/q$a.frameRate,q$R.frames=this._gList,q$R.labels=this._labels,q$R.name=q$a.name,q$R},q$S.setUpAniData=function(q$S){if(q$S.animations){var q$_,q$a={},q$R=[],q$J=q$S.animations,q$V=0,q$W=q$J.length;for(q$V=0;q$V<q$W;q$V++)if(q$_=q$J[q$V]){var q$k={};q$k.name=q$_.name,q$k.aniO=q$_,q$k.nodeRoot=q$S,q$R.push(q$k),q$a[q$_.name]=q$k}this.animationList=q$R,this.animationDic=q$a}},q$S._clear=function(){var q$S,q$_;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(q$S in this._nodeGDic)(q$_=this._nodeGDic[q$S])&&q$_.recover();this._nodeGDic=null},q$I.parseAnimationByData=function(q$S){var q$_;return q$I._I||(q$I._I=new q$I),q$_=q$I._I.parseByData(q$S),q$I._I._clear(),q$_},q$I.parseAnimationData=function(q$S){var q$_;return q$I._I||(q$I._I=new q$I),q$I._I.setUpAniData(q$S),(q$_={}).animationList=q$I._I.animationList,q$_.animationDic=q$I._I.animationDic,q$I._I._clear(),q$_},q$I._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],q$I._temParam=[],q$I._I=null,q$I._rootMatrix=null,q$z(q$I,["_tempMt",function(){return this._tempMt=new q$X}]),q$I.__init$=function(){q$B=function(){function q$S(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return q$H(q$S,""),q$S.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),q$p.recover("GraphicNode",this)},q$S.create=function(){return q$p.getItemByClass("GraphicNode",q$S)},q$S}()},q$I}(q$jS));q$q.__init([q$b,q$zS,q$K,q$g,q$y,q$l,q$S,q$qS])}(window,document,Laya),function(q$S,q$_,q$a){q$a.un,q$a.uns,q$a.static;var q$R=q$a.class;q$a.getset,q$a.__newvec;new(function(){function q$S(){}return q$R(q$S,"LayaMain"),q$S}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(q$S,q$_){"use strict";for(var q$a in Object.defineProperty(q$_,"__esModule",{value:!0}),Laya){var q$R=Laya[q$a];q$R&&q$R.__isclass&&(q$_[q$a]=q$R)}}),function(q$S,q$_,q$m){q$m.un,q$m.uns;var q$W=q$m.static,q$C=q$m.class,q$R=q$m.getset,q$V=q$m.__newvec,q$H=laya.maths.Arith,q$L=laya.maths.Bezier,q$a=laya.resource.Bitmap,q$G=laya.utils.Browser,q$z=laya.utils.Byte,q$t=laya.utils.Color,q$q=(laya.filters.ColorFilter,q$m.Config),q$J=laya.resource.Context,q$N=(laya.events.Event,laya.filters.Filter),q$k=laya.display.Graphics,q$b=laya.resource.HTMLCanvas,q$o=(laya.utils.HTMLChar,laya.resource.HTMLImage),q$$=laya.resource.HTMLSubImage,q$n=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),q$l=laya.maths.Point,q$B=laya.maths.Rectangle,q$F=laya.renders.Render,q$T=(laya.renders.RenderContext,laya.renders.RenderSprite),q$D=laya.resource.Resource,q$j=laya.resource.ResourceManager,q$Q=laya.utils.RunDriver,q$I=laya.display.Sprite,q$A=laya.display.Stage,q$X=laya.utils.Stat,q$h=laya.utils.StringKey,q$u=(laya.display.css.Style,laya.system.System),q$K=laya.display.Text,q$P=laya.resource.Texture,q$M=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),q$r=laya.utils.VectorGraphManager;laya.utils.WordText;q$m.interface("laya.webgl.shapes.IShape"),q$m.interface("laya.webgl.submit.ISubmit"),q$m.interface("laya.webgl.text.ICharSegment"),q$m.interface("laya.webgl.canvas.save.ISaveData"),q$m.interface("laya.webgl.resource.IMergeAtlasBitmap"),q$m.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var q$e=function(){function q$S(){}q$C(q$S,"laya.filters.webgl.FilterActionGL");var q$_=q$S.prototype;return q$m.imps(q$_,{"laya.filters.IFilterActionGL":!0}),q$_.setValue=function(q$S){},q$_.setValueMix=function(q$S){},q$_.apply3d=function(q$S,q$_,q$a,q$R,q$J){return null},q$_.apply=function(q$S){return null},q$R(0,q$_,"typeMix",function(){return 0}),q$S}(),q$g=function(){function q$S(){}return q$C(q$S,"laya.webgl.shader.ShaderValue"),q$S}(),q$x=function(){var q$R,q$J;function q$S(q$S,q$_,q$a){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new q$J,void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),this._cells=null,this._rowInfo=null,this._init(q$S,q$_),this._atlasID=q$a}q$C(q$S,"laya.webgl.atlas.AtlasGrid");var q$_=q$S.prototype;return q$_.getAltasID=function(){return this._atlasID},q$_.setAltasID=function(q$S){0<=q$S&&(this._atlasID=q$S)},q$_.addTex=function(q$S,q$_,q$a){var q$R=this._get(q$_,q$a);return 0==q$R.ret||(this._fill(q$R.x,q$R.y,q$_,q$a,q$S),this._texCount++),q$R},q$_._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},q$_._init=function(q$S,q$_){if(this._width=q$S,this._height=q$_,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=q$V(this._height);for(var q$a=0;q$a<this._height;q$a++)this._rowInfo[q$a]=new q$R;return this._clear(),!0},q$_._get=function(q$S,q$_){var q$a=new q$U;if(q$S>=this._failSize.width&&q$_>=this._failSize.height)return q$a;for(var q$R=-1,q$J=-1,q$V=this._width,q$W=this._height,q$k=this._cells,q$z=0;q$z<q$W;q$z++)if(!(this._rowInfo[q$z].spaceCount<q$S))for(var q$b=0;q$b<q$V;){var q$H=3*(q$z*q$V+q$b);if(0!=q$k[q$H]||q$k[1+q$H]<q$S||q$k[2+q$H]<q$_)q$b+=q$k[1+q$H];else{q$R=q$b,q$J=q$z;for(var q$L=0;q$L<q$S;q$L++)if(q$k[3*q$L+q$H+2]<q$_){q$R=-1;break}if(!(q$R<0))return q$a.ret=!0,q$a.x=q$R,q$a.y=q$J,q$a;q$b+=q$k[1+q$H]}}return q$a},q$_._fill=function(q$S,q$_,q$a,q$R,q$J){var q$V=this._width,q$W=this._height;this._check(q$S+q$a<=q$V&&q$_+q$R<=q$W);for(var q$k=q$_;q$k<q$R+q$_;++q$k){this._check(this._rowInfo[q$k].spaceCount>=q$a),this._rowInfo[q$k].spaceCount-=q$a;for(var q$z=0;q$z<q$a;q$z++){var q$b=3*(q$S+q$k*q$V+q$z);this._check(0==this._cells[q$b]),this._cells[q$b]=q$J,this._cells[1+q$b]=q$a,this._cells[2+q$b]=q$R}}if(0<q$S)for(q$k=0;q$k<q$R;++q$k){var q$H=0;for(q$z=q$S-1;0<=q$z&&0==this._cells[3*((q$_+q$k)*q$V+q$z)];--q$z,++q$H);for(q$z=q$H;0<q$z;--q$z)this._cells[3*((q$_+q$k)*q$V+q$S-q$z)+1]=q$z,this._check(0<q$z)}if(0<q$_)for(q$z=q$S;q$z<q$S+q$a;++q$z){for(q$H=0,q$k=q$_-1;0<=q$k&&0==this._cells[3*(q$z+q$k*q$V)];--q$k,q$H++);for(q$k=q$H;0<q$k;--q$k)this._cells[3*(q$z+(q$_-q$k)*q$V)+2]=q$k,this._check(0<q$k)}},q$_._check=function(q$S){0==q$S&&console.log("xtexMerger 错误啦")},q$_._clear=function(){for(var q$S=this._texCount=0;q$S<this._height;q$S++)this._rowInfo[q$S].spaceCount=this._width;for(var q$_=0;q$_<this._height;q$_++)for(var q$a=0;q$a<this._width;q$a++){var q$R=3*(q$_*this._width+q$a);this._cells[q$R]=0,this._cells[1+q$R]=this._width-q$a,this._cells[2+q$R]=this._width-q$_}this._failSize.width=this._width+1,this._failSize.height=this._height+1},q$S.__init$=function(){q$R=function(){function q$S(){this.spaceCount=0}return q$C(q$S,""),q$S}(),q$J=function(){function q$S(){this.width=0,this.height=0}return q$C(q$S,""),q$S}()},q$S}(),q$s=function(){function q$F(q$S,q$_,q$a,q$R){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=q$S,this._height=q$_,this._gridSize=q$a,this._maxAtlaserCount=q$R,this._gridNumX=q$S/q$a,this._gridNumY=q$_/q$a,this._curAtlasIndex=0,this._atlaserArray=[]}q$C(q$F,"laya.webgl.atlas.AtlasResourceManager");var q$S=q$F.prototype;return q$S.setAtlasParam=function(q$S,q$_,q$a,q$R){if(1==this._setAtlasParam)return q$F._sid_=0,this._width=q$S,this._height=q$_,this._gridSize=q$a,this._maxAtlaserCount=q$R,this._gridNumX=q$S/q$a,this._gridNumY=q$_/q$a,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},q$S.pushData=function(q$S){var q$_,q$a=q$S.bitmap,q$R=-1,q$J=null,q$V=0,q$W=0;for(q$V=0,q$_=this._atlaserArray.length;q$V<q$_&&(q$W=(this._curAtlasIndex+q$V)%q$_,-1==(q$R=(q$J=this._atlaserArray[q$W]).findBitmapIsExist(q$a)));q$V++);if(-1!=q$R){var q$k=q$J.InAtlasWebGLImagesOffsetValue[q$R];return q$t=q$k[0],q$o=q$k[1],q$J.addToAtlas(q$S,q$t,q$o),!0}this._setAtlasParam=!1;for(var q$z=Math.ceil((q$S.bitmap.width+2)/this._gridSize),q$b=Math.ceil((q$S.bitmap.height+2)/this._gridSize),q$H=!1,q$L=0;q$L<2;q$L++){var q$C=this._maxAtlaserCount;for(q$V=0;q$V<q$C;q$V++){q$W=(this._curAtlasIndex+q$V)%q$C,this._atlaserArray.length-1>=q$W||this._atlaserArray.push(new q$BS(this._gridNumX,this._gridNumY,this._width,this._height,q$F._sid_++));var q$G=this._atlaserArray[q$W],q$t=0,q$o=0,q$$=q$G.addTex(1,q$z,q$b);if(q$$.ret){q$t=q$$.x*this._gridSize+1,q$o=q$$.y*this._gridSize+1,q$a.lock=!0,q$G.addToAtlasTexture(q$a,q$t,q$o),q$G.addToAtlas(q$S,q$t,q$o),q$H=!0,this._curAtlasIndex=q$W;break}}if(q$H)break;this._atlaserArray.push(new q$BS(this._gridNumX,this._gridNumY,this._width,this._height,q$F._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return q$H||console.log(">>>AtlasManager pushData error"),q$H},q$S.addToAtlas=function(q$S){laya.webgl.atlas.AtlasResourceManager.instance.pushData(q$S)},q$S.garbageCollection=function(){if(!0===this._needGC){for(var q$S=this._atlaserArray.length-this._maxAtlaserCount,q$_=0;q$_<q$S;q$_++)this._atlaserArray[q$_].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+q$S),this._atlaserArray.splice(0,q$S),this._needGC=!1}return!0},q$S.freeAll=function(){for(var q$S=0,q$_=this._atlaserArray.length;q$S<q$_;q$S++)this._atlaserArray[q$S].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},q$S.getAtlaserCount=function(){return this._atlaserArray.length},q$S.getAtlaserByIndex=function(q$S){return this._atlaserArray[q$S]},q$R(1,q$F,"instance",function(){return q$F._Instance||(q$F._Instance=new q$F(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),q$F._Instance}),q$R(1,q$F,"enabled",function(){return q$q.atlasEnable}),q$R(1,q$F,"atlasLimitWidth",function(){return q$F._atlasLimitWidth},function(q$S){q$F._atlasLimitWidth=q$S}),q$R(1,q$F,"atlasLimitHeight",function(){return q$F._atlasLimitHeight},function(q$S){q$F._atlasLimitHeight=q$S}),q$F._enable=function(){q$q.atlasEnable=!0},q$F._disable=function(){q$q.atlasEnable=!1},q$F.__init__=function(){q$F.atlasTextureWidth=2048,q$F.atlasTextureHeight=2048,q$F.maxTextureCount=6,q$F.atlasLimitWidth=512,q$F.atlasLimitHeight=512},q$F._atlasLimitWidth=0,q$F._atlasLimitHeight=0,q$F.gridSize=16,q$F.atlasTextureWidth=0,q$F.atlasTextureHeight=0,q$F.maxTextureCount=0,q$F._atlasRestore=0,q$F.BOARDER_TYPE_NO=0,q$F.BOARDER_TYPE_RIGHT=1,q$F.BOARDER_TYPE_LEFT=2,q$F.BOARDER_TYPE_BOTTOM=4,q$F.BOARDER_TYPE_TOP=8,q$F.BOARDER_TYPE_ALL=15,q$F._sid_=0,q$F._Instance=null,q$F}(),q$U=function(){function q$S(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return q$C(q$S,"laya.webgl.atlas.MergeFillInfo"),q$S}(),q$f=function(){function q$_(){}return q$C(q$_,"laya.webgl.canvas.BlendMode"),q$_._init_=function(q$S){q$_.fns=[q$_.BlendNormal,q$_.BlendAdd,q$_.BlendMultiply,q$_.BlendScreen,q$_.BlendOverlay,q$_.BlendLight,q$_.BlendMask,q$_.BlendDestinationOut],q$_.targetFns=[q$_.BlendNormalTarget,q$_.BlendAddTarget,q$_.BlendMultiplyTarget,q$_.BlendScreenTarget,q$_.BlendOverlayTarget,q$_.BlendLightTarget,q$_.BlendMask,q$_.BlendDestinationOut]},q$_.BlendNormal=function(q$S){q$S.blendFunc(1,771)},q$_.BlendAdd=function(q$S){q$S.blendFunc(1,772)},q$_.BlendMultiply=function(q$S){q$S.blendFunc(774,771)},q$_.BlendScreen=function(q$S){q$S.blendFunc(1,1)},q$_.BlendOverlay=function(q$S){q$S.blendFunc(1,769)},q$_.BlendLight=function(q$S){q$S.blendFunc(1,1)},q$_.BlendNormalTarget=function(q$S){q$S.blendFunc(1,771)},q$_.BlendAddTarget=function(q$S){q$S.blendFunc(1,772)},q$_.BlendMultiplyTarget=function(q$S){q$S.blendFunc(774,771)},q$_.BlendScreenTarget=function(q$S){q$S.blendFunc(1,1)},q$_.BlendOverlayTarget=function(q$S){q$S.blendFunc(1,769)},q$_.BlendLightTarget=function(q$S){q$S.blendFunc(1,1)},q$_.BlendMask=function(q$S){q$S.blendFunc(0,770)},q$_.BlendDestinationOut=function(q$S){q$S.blendFunc(0,0)},q$_.activeBlendFunction=null,q$_.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],q$_.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},q$_.NORMAL="normal",q$_.ADD="add",q$_.MULTIPLY="multiply",q$_.SCREEN="screen",q$_.LIGHT="light",q$_.OVERLAY="overlay",q$_.DESTINATIONOUT="destination-out",q$_.fns=[],q$_.targetFns=[],q$_}(),q$Y=function(){function q$a(q$S){this._color=q$t.create("black"),this.setValue(q$S)}q$C(q$a,"laya.webgl.canvas.DrawStyle");var q$S=q$a.prototype;return q$S.setValue=function(q$S){if(q$S){if("string"==typeof q$S)return void(this._color=q$t.create(q$S));if(q$S instanceof laya.utils.Color)return void(this._color=q$S)}},q$S.reset=function(){this._color=q$t.create("black")},q$S.equal=function(q$S){return"string"==typeof q$S?this._color.strColor===q$S:q$S instanceof laya.utils.Color&&this._color.numColor===q$S.numColor},q$S.toColorStr=function(){return this._color.strColor},q$a.create=function(q$S){var q$_;if(q$S&&("string"==typeof q$S?q$_=q$t.create(q$S):q$S instanceof laya.utils.Color&&(q$_=q$S),q$_))return q$_._drawStyle||(q$_._drawStyle=new q$a(q$S));return laya.webgl.canvas.DrawStyle.DEFAULT},q$W(q$a,["DEFAULT",function(){return this.DEFAULT=new q$a("#000000")}]),q$a}(),q$i=function(){function q$S(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];q$jS.mainContext;this.ib=q$vS.create(35048),this.vb=q$dS.create(5)}q$C(q$S,"laya.webgl.canvas.Path");var q$_=q$S.prototype;return q$_.addPoint=function(q$S,q$_){this.tempArray.push(q$S,q$_)},q$_.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},q$_.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},q$_.polygon=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W;return this.geomatrys.push(this._curGeomatry=q$W=new q$hS(q$S,q$_,q$a,q$R,q$J,q$V)),q$R||(q$W.fill=!1),null==q$V&&(q$W.borderWidth=0),q$W},q$_.setGeomtry=function(q$S){this.geomatrys.push(this._curGeomatry=q$S)},q$_.drawLine=function(q$S,q$_,q$a,q$R,q$J){var q$V;return this.closePath?this.geomatrys.push(this._curGeomatry=q$V=new q$XS(q$S,q$_,q$a,q$R,q$J)):this.geomatrys.push(this._curGeomatry=q$V=new q$AS(q$S,q$_,q$a,q$R,q$J)),q$V.fill=!1,q$V},q$_.update=function(){var q$S=this.ib._byteLength,q$_=this.geomatrys.length;this.offset=q$S;for(var q$a=this.geoStart;q$a<q$_;q$a++)this.geomatrys[q$a].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=q$_,this.count=(this.ib._byteLength-q$S)/q$oS.BYTES_PIDX},q$_.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},q$_.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},q$S}(),q$Z=function(){function q$k(){}q$C(q$k,"laya.webgl.canvas.save.SaveBase");var q$S=q$k.prototype;return q$m.imps(q$S,{"laya.webgl.canvas.save.ISaveData":!0}),q$S.isSaveMark=function(){return!1},q$S.restore=function(q$S){this._dataObj[this._valueName]=this._value,(q$k._cache[q$k._cache._length++]=this)._newSubmit&&(q$S._curSubmit=q$VS.RENDERBASE,q$S._renderKey=0)},q$k._createArray=function(){var q$S=[];return q$S._length=0,q$S},q$k._init=function(){var q$S=q$k._namemap={};return q$S[1]="ALPHA",q$S[2]="fillStyle",q$S[8]="font",q$S[256]="lineWidth",q$S[512]="strokeStyle",q$S[8192]="_mergeID",q$S[1024]=q$S[2048]=q$S[4096]=[],q$S[16384]="textBaseline",q$S[32768]="textAlign",q$S[65536]="_nBlendType",q$S[1048576]="shader",q$S[2097152]="filters",q$S},q$k.save=function(q$S,q$_,q$a,q$R){if((q$S._saveMark._saveuse&q$_)!==q$_){q$S._saveMark._saveuse|=q$_;var q$J=q$k._cache,q$V=0<q$J._length?q$J[--q$J._length]:new q$k;q$V._value=q$a[q$V._valueName=q$k._namemap[q$_]],q$V._dataObj=q$a,q$V._newSubmit=q$R;var q$W=q$S._save;q$W[q$W._length++]=q$V}},q$k._cache=laya.webgl.canvas.save.SaveBase._createArray(),q$k._namemap=q$k._init(),q$k}(),q$p=function(){function q$V(){this._clipRect=new q$B}q$C(q$V,"laya.webgl.canvas.save.SaveClipRect");var q$S=q$V.prototype;return q$m.imps(q$S,{"laya.webgl.canvas.save.ISaveData":!0}),q$S.isSaveMark=function(){return!1},q$S.restore=function(q$S){q$S._clipRect=this._clipSaveRect,(q$V._cache[q$V._cache._length++]=this)._submitScissor.submitLength=q$S._submits._length-this._submitScissor.submitIndex,q$S._curSubmit=q$VS.RENDERBASE,q$S._renderKey=0},q$V.save=function(q$S,q$_){if(131072!=(131072&q$S._saveMark._saveuse)){q$S._saveMark._saveuse|=131072;var q$a=q$V._cache,q$R=0<q$a._length?q$a[--q$a._length]:new q$V;q$R._clipSaveRect=q$S._clipRect,q$S._clipRect=q$R._clipRect.copyFrom(q$S._clipRect),q$R._submitScissor=q$_;var q$J=q$S._save;q$J[q$J._length++]=q$R}},q$W(q$V,["_cache",function(){return this._cache=q$Z._createArray()}]),q$V}(),q$c=function(){function q$G(){this._contextX=0,this._contextY=0,this._clipRect=new q$B,this._rect=new q$B,this._matrix=new q$n}q$C(q$G,"laya.webgl.canvas.save.SaveClipRectStencil");var q$S=q$G.prototype;return q$m.imps(q$S,{"laya.webgl.canvas.save.ISaveData":!0}),q$S.isSaveMark=function(){return!1},q$S.restore=function(q$S){q$HS.restore(q$S,this._rect,this._saveMatrix,this._contextX,this._contextY),q$S._clipRect=this._clipSaveRect,q$S._curMat=this._saveMatrix,q$S._x=this._contextX,q$S._y=this._contextY,q$G._cache[q$G._cache._length++]=this,q$S._curSubmit=q$VS.RENDERBASE},q$G.save=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){if(262144!=(262144&q$S._saveMark._saveuse)){q$S._saveMark._saveuse|=262144;var q$H=q$G._cache,q$L=0<q$H._length?q$H[--q$H._length]:new q$G;q$L._clipSaveRect=q$S._clipRect,q$L._clipRect.setTo(q$W,q$k,q$z,q$b),q$S._clipRect=q$L._clipRect,q$L._rect.x=q$a,q$L._rect.y=q$R,q$L._rect.width=q$J,q$L._rect.height=q$V,q$L._contextX=q$S._x,q$L._contextY=q$S._y,q$L._saveMatrix=q$S._curMat,q$S._curMat.copyTo(q$L._matrix),q$S._curMat=q$L._matrix,q$L._submitStencil=q$_;var q$C=q$S._save;q$C[q$C._length++]=q$L}},q$W(q$G,["_cache",function(){return this._cache=q$Z._createArray()}]),q$G}(),q$y=function(){function q$R(){this._saveuse=0}q$C(q$R,"laya.webgl.canvas.save.SaveMark");var q$S=q$R.prototype;return q$m.imps(q$S,{"laya.webgl.canvas.save.ISaveData":!0}),q$S.isSaveMark=function(){return!0},q$S.restore=function(q$S){q$S._saveMark=this._preSaveMark,q$R._no[q$R._no._length++]=this},q$R.Create=function(q$S){var q$_=q$R._no,q$a=0<q$_._length?q$_[--q$_._length]:new q$R;return q$a._saveuse=0,q$a._preSaveMark=q$S._saveMark,q$S._saveMark=q$a},q$W(q$R,["_no",function(){return this._no=q$Z._createArray()}]),q$R}(),q$E=function(){function q$V(){this._matrix=new q$n}q$C(q$V,"laya.webgl.canvas.save.SaveTransform");var q$S=q$V.prototype;return q$m.imps(q$S,{"laya.webgl.canvas.save.ISaveData":!0}),q$S.isSaveMark=function(){return!1},q$S.restore=function(q$S){q$S._curMat=this._savematrix,q$V._no[q$V._no._length++]=this},q$V.save=function(q$S){var q$_=q$S._saveMark;if(2048!=(2048&q$_._saveuse)){q$_._saveuse|=2048;var q$a=q$V._no,q$R=0<q$a._length?q$a[--q$a._length]:new q$V;q$R._savematrix=q$S._curMat,q$S._curMat=q$S._curMat.copyTo(q$R._matrix);var q$J=q$S._save;q$J[q$J._length++]=q$R}},q$W(q$V,["_no",function(){return this._no=q$Z._createArray()}]),q$V}(),q$O=function(){function q$J(){}q$C(q$J,"laya.webgl.canvas.save.SaveTranslate");var q$S=q$J.prototype;return q$m.imps(q$S,{"laya.webgl.canvas.save.ISaveData":!0}),q$S.isSaveMark=function(){return!1},q$S.restore=function(q$S){q$S._curMat;q$S._x=this._x,q$S._y=this._y,q$J._no[q$J._no._length++]=this},q$J.save=function(q$S){var q$_=q$J._no,q$a=0<q$_._length?q$_[--q$_._length]:new q$J;q$a._x=q$S._x,q$a._y=q$S._y;var q$R=q$S._save;q$R[q$R._length++]=q$a},q$W(q$J,["_no",function(){return this._no=q$Z._createArray()}]),q$J}(),q$w=function(){function q$S(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new q$B}q$C(q$S,"laya.webgl.resource.RenderTargetMAX");var q$_=q$S.prototype;return q$_.setSP=function(q$S){this._sp=q$S},q$_.size=function(q$S,q$_){var q$a=this;this._width!==q$S||this._height!==q$_?(this.repaint=!0,this._width=q$S,this._height=q$_,this.target?this.target.size(q$S,q$_):this.target=q$rS.create(q$S,q$_),this.target.hasListener("recovered")||this.target.on("recovered",this,function(q$S){q$m.timer.callLater(q$a._sp,q$a._sp.repaint)})):this.target.size(q$S,q$_)},q$_._flushToTarget=function(q$S,q$_){if(!q$_._destroy){var q$a=q$TS.worldScissorTest,q$R=q$TS.worldClipRect;q$TS.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,q$TS.worldScissorTest=!1,q$jS.mainContext.disable(3089);var q$J=q$TS.worldAlpha,q$V=q$TS.worldMatrix4,q$W=q$TS.worldMatrix,q$k=q$TS.worldFilters,q$z=q$TS.worldShaderDefines;if(q$TS.worldMatrix=q$n.EMPTY,q$TS.restoreTempArray(),q$TS.worldMatrix4=q$TS.TEMPMAT4_ARRAY,q$TS.worldAlpha=1,q$TS.worldFilters=null,q$TS.worldShaderDefines=null,q$MS.activeShader=null,q$_.start(),q$q.showCanvasMark?q$_.clear(0,1,0,.3):q$_.clear(0,0,0,0),q$S.flush(),q$_.end(),q$MS.activeShader=null,q$TS.worldAlpha=q$J,q$TS.worldMatrix4=q$V,q$TS.worldMatrix=q$W,q$TS.worldFilters=q$k,q$TS.worldShaderDefines=q$z,q$TS.worldScissorTest=q$a){var q$b=q$TS.height-q$R.y-q$R.height;q$jS.mainContext.scissor(q$R.x,q$b,q$R.width,q$R.height),q$jS.mainContext.enable(3089)}q$TS.worldClipRect=q$R}},q$_.flush=function(q$S){this.repaint&&(this._flushToTarget(q$S,this.target),this.repaint=!1)},q$_.drawTo=function(q$S,q$_,q$a,q$R,q$J){q$S.drawTexture(this.target.getTexture(),q$_,q$a,q$R,q$J,0,0)},q$_.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},q$S}(),q$v=function(){function q$S(){this.ALPHA=1,this.shaderType=0,this.defines=new q$IS}return q$C(q$S,"laya.webgl.shader.d2.Shader2D"),q$S.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},q$S.__init__=function(){var q$S,q$_;q$yS.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),q$yS.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),q$yS.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),q$yS.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),q$yS.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),q$yS.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),q$yS.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),q$yS.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),q$S="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",q$_='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',q$yS.preCompile2D(0,1,q$S,q$_,null),q$S="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",q$_='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',q$yS.preCompile2D(0,2,q$S,q$_,null),q$S="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",q$_="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",q$yS.preCompile2D(0,4,q$S,q$_,null),q$S="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",q$_='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',q$yS.preCompile2D(0,256,q$S,q$_,null),q$S="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",q$_="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",q$yS.preCompile2D(0,512,q$S,q$_,null)},q$S}(),q$d=function(){function q$_(q$S,q$_,q$a){this._value=0,this._name2int=q$S,this._int2name=q$_,this._int2nameMap=q$a}q$C(q$_,"laya.webgl.shader.ShaderDefines");var q$S=q$_.prototype;return q$S.add=function(q$S){return"string"==typeof q$S&&(q$S=this._name2int[q$S]),this._value|=q$S,this._value},q$S.addInt=function(q$S){return this._value|=q$S,this._value},q$S.remove=function(q$S){return"string"==typeof q$S&&(q$S=this._name2int[q$S]),this._value&=~q$S,this._value},q$S.isDefine=function(q$S){return(this._value&q$S)===q$S},q$S.getValue=function(){return this._value},q$S.setValue=function(q$S){this._value=q$S},q$S.toNameDic=function(){var q$S=this._int2nameMap[this._value];return q$S||q$_._toText(this._value,this._int2name,this._int2nameMap)},q$_._reg=function(q$S,q$_,q$a,q$R){q$R[q$a[q$S]=q$_]=q$S},q$_._toText=function(q$S,q$_,q$a){var q$R=q$a[q$S];if(q$R)return q$R;for(var q$J={},q$V=1,q$W=0;q$W<32&&!(q$S<(q$V=1<<q$W));q$W++)if(q$S&q$V){var q$k=q$_[q$V];q$k&&(q$J[q$k]="")}return q$a[q$S]=q$J},q$_._toInt=function(q$S,q$_){for(var q$a=q$S.split("."),q$R=0,q$J=0,q$V=q$a.length;q$J<q$V;q$J++){var q$W=q$_[q$a[q$J]];if(!q$W)throw new Error("Defines to int err:"+q$S+"/"+q$a[q$J]);q$R|=q$W}return q$R},q$_}(),q$SS=function(){function q$W(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new q$n}q$C(q$W,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var q$S=q$W.prototype;return q$S.init=function(q$S,q$_,q$a){if(q$_)this._vs=q$_;else{this._vs=[];var q$R=q$S.width,q$J=q$S.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(q$R,0,1,0,1,1,1,1),this._vs.push(q$R,q$J,1,1,1,1,1,1),this._vs.push(0,q$J,0,1,1,1,1,1)}q$a?this._ps=q$a:(q$W._defaultPS||(q$W._defaultPS=[]).push(0,1,3,3,1,2),this._ps=q$W._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=q$S},q$S.init2=function(q$S,q$_,q$a,q$R,q$J){this.transform&&(this.transform=null),q$a?this._ps=q$a:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=q$R,this._uvs=q$J,this.mEleNum=this._ps.length,this.mTexture=q$S,(q$F.isConchNode||q$F.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},q$S._initMyData=function(){var q$S=0,q$_=0,q$a=4*this._verticles.length;this._vs=q$W._tempVS;var q$R=!1;if(q$F.isConchNode||q$F.isConchApp?(this._vs.length=q$a,q$R=!0):this._vs.length<q$a&&(this._vs.length=q$a,q$R=!0),q$W._tVSLen=q$a,q$R)for(;q$S<q$a;)this._vs[q$S]=this._verticles[q$_],this._vs[q$S+1]=this._verticles[q$_+1],this._vs[q$S+2]=this._uvs[q$_],this._vs[q$S+3]=this._uvs[q$_+1],this._vs[q$S+4]=1,this._vs[q$S+5]=1,this._vs[q$S+6]=1,this._vs[q$S+7]=1,q$S+=8,q$_+=2;else for(;q$S<q$a;)this._vs[q$S]=this._verticles[q$_],this._vs[q$S+1]=this._verticles[q$_+1],this._vs[q$S+2]=this._uvs[q$_],this._vs[q$S+3]=this._uvs[q$_+1],q$S+=8,q$_+=2},q$S.getData2=function(q$S,q$_,q$a){var q$R;this.mVBBuffer=q$S,this.mIBBuffer=q$_,this._initMyData(),q$S.appendEx2(this._vs,Float32Array,q$W._tVSLen,4),this._indexStart=q$_._byteLength,(q$R=q$W._tempIB).length<this._ps.length&&(q$R.length=this._ps.length);for(var q$J=0,q$V=this._ps.length;q$J<q$V;q$J++)q$R[q$J]=this._ps[q$J]+q$a;q$_.appendEx2(q$R,Uint16Array,this._ps.length,2)},q$S.getData=function(q$S,q$_,q$a){if(this.mVBBuffer=q$S,this.mIBBuffer=q$_,q$S.append(this.mVBData),this._indexStart=q$_._byteLength,this.mIBData.start!=q$a){for(var q$R=0,q$J=this._ps.length;q$R<q$J;q$R++)this.mIBData[q$R]=this._ps[q$R]+q$a;this.mIBData.start=q$a}q$_.append(this.mIBData)},q$S.render=function(q$S,q$_,q$a){if(q$F.isWebGL&&this.mTexture){q$S._renderKey=0,q$S._shader2D.glTexture=null,q$_S.getInstance().addSkinMesh(this);var q$R=q$VS.createShape(q$S,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,q$NS.create(512,0));this.transform||(this.transform=q$n.EMPTY),this.transform.translate(q$_,q$a),q$n.mul(this.transform,q$S._curMat,this._tempMatrix),this.transform.translate(-q$_,-q$a);var q$J=q$R.shaderValue,q$V=q$J.u_mmat2||q$TS.getMatrArray();q$TS.mat2MatArray(this._tempMatrix,q$V),q$J.textureHost=this.mTexture,q$J.offsetX=0,q$J.offsetY=0,q$J.u_mmat2=q$V,q$J.ALPHA=q$S._shader2D.ALPHA,q$S._submits[q$S._submits._length++]=q$R}else q$F.isConchApp&&this.mTexture&&(this.transform||(this.transform=q$n.EMPTY),q$S.setSkinMesh&&q$S.setSkinMesh(q$_,q$a,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},q$W._tempVS=[],q$W._tempIB=[],q$W._defaultPS=null,q$W._tVSLen=0,q$W}(),q$_S=function(){function q$S(){this.ib=null,this.vb=null;q$jS.mainContext;this.ib=q$vS.create(35048),this.vb=q$dS.create(8)}q$C(q$S,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var q$_=q$S.prototype;return q$_.addSkinMesh=function(q$S){q$S.getData2(this.vb,this.ib,this.vb._byteLength/32)},q$_.reset=function(){this.vb.clear(),this.ib.clear()},q$S.getInstance=function(){return q$S.instance=q$S.instance||new q$S},q$S.instance=null,q$S}(),q$aS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===q$z&&(q$z=0),this.x=q$S,this.y=q$_,this.width=q$a,this.height=q$R,this.edges=q$J,this.color=q$V,this.borderWidth=q$W,this.borderColor=q$k}q$C(q$S,"laya.webgl.shapes.BasePoly");var q$_=q$S.prototype;return q$m.imps(q$_,{"laya.webgl.shapes.IShape":!0}),q$_.getData=function(q$S,q$_,q$a){},q$_.rebuild=function(q$S){},q$_.setMatrix=function(q$S){},q$_.needUpdate=function(q$S){return!0},q$_.sector=function(q$S,q$_,q$a){var q$R=this.x,q$J=this.y,q$V=this.edges,q$W=(this.r1-this.r0)/q$V,q$k=this.width,q$z=this.height,q$b=this.color,q$H=(q$b>>16&255)/255,q$L=(q$b>>8&255)/255,q$C=(255&q$b)/255;q$S.push(q$R,q$J,q$H,q$L,q$C);for(var q$G=0;q$G<q$V+1;q$G++)q$S.push(q$R+Math.sin(q$W*q$G+this.r0)*q$k,q$J+Math.cos(q$W*q$G+this.r0)*q$z),q$S.push(q$H,q$L,q$C);for(q$G=0;q$G<q$V;q$G++)q$_.push(q$a,q$a+q$G+1,q$a+q$G+2)},q$_.createLine2=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W,q$k,q$z,q$b,q$H,q$L,q$C,q$G,q$t,q$o,q$$,q$F,q$T,q$D,q$j,q$Q,q$m,q$q,q$N,q$n,q$l=q$S.concat(),q$B=q$J,q$I=this.borderColor,q$A=(q$I>>16&255)/255,q$X=(q$I>>8&255)/255,q$h=(255&q$I)/255,q$u=q$l.length/2,q$K=q$R,q$P=q$a/2;q$z=q$l[0],q$b=q$l[1],q$o=q$z-(q$H=q$l[2]),q$t=(q$t=-(q$b-(q$L=q$l[3])))/(q$n=Math.sqrt(q$t*q$t+q$o*q$o))*q$P,q$o=q$o/q$n*q$P,q$B.push(q$z-q$t+this.x,q$b-q$o+this.y,q$A,q$X,q$h,q$z+q$t+this.x,q$b+q$o+this.y,q$A,q$X,q$h);for(var q$M=1;q$M<q$u-1;q$M++)q$z=q$l[2*(q$M-1)],q$b=q$l[2*(q$M-1)+1],q$H=q$l[2*q$M],q$L=q$l[2*q$M+1],q$C=q$l[2*(q$M+1)],q$G=q$l[2*(q$M+1)+1],q$o=q$z-q$H,q$F=q$H-q$C,q$j=(-(q$t=(q$t=-(q$b-q$L))/(q$n=Math.sqrt(q$t*q$t+q$o*q$o))*q$P)+q$z)*(-(q$o=q$o/q$n*q$P)+q$L)-(-q$t+q$H)*(-q$o+q$b),q$q=(-(q$$=(q$$=-(q$L-q$G))/(q$n=Math.sqrt(q$$*q$$+q$F*q$F))*q$P)+q$C)*(-(q$F=q$F/q$n*q$P)+q$L)-(-q$$+q$H)*(-q$F+q$G),q$N=(q$T=-q$o+q$b-(-q$o+q$L))*(q$m=-q$$+q$H-(-q$$+q$C))-(q$Q=-q$F+q$G-(-q$F+q$L))*(q$D=-q$t+q$H-(-q$t+q$z)),Math.abs(q$N)<.1?(q$N+=10.1,q$B.push(q$H-q$t+this.x,q$L-q$o+this.y,q$A,q$X,q$h,q$H+q$t+this.x,q$L+q$o+this.y,q$A,q$X,q$h)):(((q$W=(q$D*q$q-q$m*q$j)/q$N)-q$H)*(q$W-q$H)+((q$k=(q$Q*q$j-q$T*q$q)/q$N)-q$L)+(q$k-q$L),q$B.push(q$W+this.x,q$k+this.y,q$A,q$X,q$h,q$H-(q$W-q$H)+this.x,q$L-(q$k-q$L)+this.y,q$A,q$X,q$h));q$z=q$l[q$l.length-4],q$b=q$l[q$l.length-3],q$o=q$z-(q$H=q$l[q$l.length-2]),q$t=(q$t=-(q$b-(q$L=q$l[q$l.length-1])))/(q$n=Math.sqrt(q$t*q$t+q$o*q$o))*q$P,q$o=q$o/q$n*q$P,q$B.push(q$H-q$t+this.x,q$L-q$o+this.y,q$A,q$X,q$h,q$H+q$t+this.x,q$L+q$o+this.y,q$A,q$X,q$h);var q$r=q$V;for(q$M=1;q$M<q$r;q$M++)q$_.push(q$K+2*(q$M-1),q$K+2*(q$M-1)+1,q$K+2*q$M+1,q$K+2*q$M+1,q$K+2*q$M,q$K+2*(q$M-1));return q$B},q$_.createLine=function(q$S,q$_,q$a,q$R){var q$J=q$S.concat(),q$V=q$S,q$W=this.borderColor,q$k=(q$W>>16&255)/255,q$z=(q$W>>8&255)/255,q$b=(255&q$W)/255;q$J.splice(0,5);var q$H,q$L,q$C,q$G,q$t,q$o,q$$,q$F,q$T,q$D,q$j,q$Q,q$m,q$q,q$N,q$n,q$l,q$B,q$I,q$A,q$X=q$J.length/5,q$h=q$R,q$u=q$a/2;q$C=q$J[0],q$G=q$J[1],q$D=q$C-(q$t=q$J[5]),q$T=(q$T=-(q$G-(q$o=q$J[6])))/(q$A=Math.sqrt(q$T*q$T+q$D*q$D))*q$u,q$D=q$D/q$A*q$u,q$V.push(q$C-q$T,q$G-q$D,q$k,q$z,q$b,q$C+q$T,q$G+q$D,q$k,q$z,q$b);for(var q$K=1;q$K<q$X-1;q$K++)q$C=q$J[5*(q$K-1)],q$G=q$J[5*(q$K-1)+1],q$t=q$J[5*q$K],q$o=q$J[5*q$K+1],q$$=q$J[5*(q$K+1)],q$F=q$J[5*(q$K+1)+1],q$D=q$C-q$t,q$Q=q$t-q$$,q$N=(-(q$T=(q$T=-(q$G-q$o))/(q$A=Math.sqrt(q$T*q$T+q$D*q$D))*q$u)+q$C)*(-(q$D=q$D/q$A*q$u)+q$o)-(-q$T+q$t)*(-q$D+q$G),q$B=(-(q$j=(q$j=-(q$o-q$F))/(q$A=Math.sqrt(q$j*q$j+q$Q*q$Q))*q$u)+q$$)*(-(q$Q=q$Q/q$A*q$u)+q$o)-(-q$j+q$t)*(-q$Q+q$F),q$I=(q$m=-q$D+q$G-(-q$D+q$o))*(q$l=-q$j+q$t-(-q$j+q$$))-(q$n=-q$Q+q$F-(-q$Q+q$o))*(q$q=-q$T+q$t-(-q$T+q$C)),Math.abs(q$I)<.1?(q$I+=10.1,q$V.push(q$t-q$T,q$o-q$D,q$k,q$z,q$b,q$t+q$T,q$o+q$D,q$k,q$z,q$b)):(((q$H=(q$q*q$B-q$l*q$N)/q$I)-q$t)*(q$H-q$t)+((q$L=(q$n*q$N-q$m*q$B)/q$I)-q$o)+(q$L-q$o),q$V.push(q$H,q$L,q$k,q$z,q$b,q$t-(q$H-q$t),q$o-(q$L-q$o),q$k,q$z,q$b));q$C=q$J[q$J.length-10],q$G=q$J[q$J.length-9],q$D=q$C-(q$t=q$J[q$J.length-5]),q$T=(q$T=-(q$G-(q$o=q$J[q$J.length-4])))/(q$A=Math.sqrt(q$T*q$T+q$D*q$D))*q$u,q$D=q$D/q$A*q$u,q$V.push(q$t-q$T,q$o-q$D,q$k,q$z,q$b,q$t+q$T,q$o+q$D,q$k,q$z,q$b);var q$P=this.edges+1;for(q$K=1;q$K<q$P;q$K++)q$_.push(q$h+2*(q$K-1),q$h+2*(q$K-1)+1,q$h+2*q$K+1,q$h+2*q$K+1,q$h+2*q$K,q$h+2*(q$K-1));return q$V},q$_.createLoopLine=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=q$S.concat(),q$k=q$J||q$S,q$z=this.borderColor,q$b=(q$z>>16&255)/255,q$H=(q$z>>8&255)/255,q$L=(255&q$z)/255;q$W.splice(0,5);var q$C=[q$W[0],q$W[1]],q$G=[q$W[q$W.length-5],q$W[q$W.length-4]],q$t=q$G[0]+.5*(q$C[0]-q$G[0]),q$o=q$G[1]+.5*(q$C[1]-q$G[1]);q$W.unshift(q$t,q$o,0,0,0),q$W.push(q$t,q$o,0,0,0);var q$$,q$F,q$T,q$D,q$j,q$Q,q$m,q$q,q$N,q$n,q$l,q$B,q$I,q$A,q$X,q$h,q$u,q$K,q$P,q$M,q$r=q$W.length/5,q$e=q$R,q$g=q$a/2;q$T=q$W[0],q$D=q$W[1],q$n=q$T-(q$j=q$W[5]),q$N=(q$N=-(q$D-(q$Q=q$W[6])))/(q$M=Math.sqrt(q$N*q$N+q$n*q$n))*q$g,q$n=q$n/q$M*q$g,q$k.push(q$T-q$N,q$D-q$n,q$b,q$H,q$L,q$T+q$N,q$D+q$n,q$b,q$H,q$L);for(var q$x=1;q$x<q$r-1;q$x++)q$T=q$W[5*(q$x-1)],q$D=q$W[5*(q$x-1)+1],q$j=q$W[5*q$x],q$Q=q$W[5*q$x+1],q$m=q$W[5*(q$x+1)],q$q=q$W[5*(q$x+1)+1],q$n=q$T-q$j,q$B=q$j-q$m,q$X=(-(q$N=(q$N=-(q$D-q$Q))/(q$M=Math.sqrt(q$N*q$N+q$n*q$n))*q$g)+q$T)*(-(q$n=q$n/q$M*q$g)+q$Q)-(-q$N+q$j)*(-q$n+q$D),q$K=(-(q$l=(q$l=-(q$Q-q$q))/(q$M=Math.sqrt(q$l*q$l+q$B*q$B))*q$g)+q$m)*(-(q$B=q$B/q$M*q$g)+q$Q)-(-q$l+q$j)*(-q$B+q$q),q$P=(q$I=-q$n+q$D-(-q$n+q$Q))*(q$u=-q$l+q$j-(-q$l+q$m))-(q$h=-q$B+q$q-(-q$B+q$Q))*(q$A=-q$N+q$j-(-q$N+q$T)),Math.abs(q$P)<.1?(q$P+=10.1,q$k.push(q$j-q$N,q$Q-q$n,q$b,q$H,q$L,q$j+q$N,q$Q+q$n,q$b,q$H,q$L)):(((q$$=(q$A*q$K-q$u*q$X)/q$P)-q$j)*(q$$-q$j)+((q$F=(q$h*q$X-q$I*q$K)/q$P)-q$Q)+(q$F-q$Q),q$k.push(q$$,q$F,q$b,q$H,q$L,q$j-(q$$-q$j),q$Q-(q$F-q$Q),q$b,q$H,q$L));q$V&&(q$_=q$V);var q$s=this.edges+1;for(q$x=1;q$x<q$s;q$x++)q$_.push(q$e+2*(q$x-1),q$e+2*(q$x-1)+1,q$e+2*q$x+1,q$e+2*q$x+1,q$e+2*q$x,q$e+2*(q$x-1));return q$_.push(q$e+2*(q$x-1),q$e+2*(q$x-1)+1,q$e+1,q$e+1,q$e,q$e+2*(q$x-1)),q$k},q$S}(),q$RS=function(){function q$o(){}return q$C(q$o,"laya.webgl.shapes.Earcut"),q$o.earcut=function(q$S,q$_,q$a){q$a=q$a||2;var q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H=q$_&&q$_.length,q$L=q$H?q$_[0]*q$a:q$S.length,q$C=q$o.linkedList(q$S,0,q$L,q$a,!0),q$G=[];if(!q$C)return q$G;if(q$H&&(q$C=q$o.eliminateHoles(q$S,q$_,q$C,q$a)),q$S.length>80*q$a){q$R=q$V=q$S[0],q$J=q$W=q$S[1];for(var q$t=q$a;q$t<q$L;q$t+=q$a)(q$k=q$S[q$t])<q$R&&(q$R=q$k),(q$z=q$S[q$t+1])<q$J&&(q$J=q$z),q$V<q$k&&(q$V=q$k),q$W<q$z&&(q$W=q$z);q$b=0!==(q$b=Math.max(q$V-q$R,q$W-q$J))?1/q$b:0}return q$o.earcutLinked(q$C,q$G,q$a,q$R,q$J,q$b),q$G},q$o.linkedList=function(q$S,q$_,q$a,q$R,q$J){var q$V,q$W;if(q$J===0<q$o.signedArea(q$S,q$_,q$a,q$R))for(q$V=q$_;q$V<q$a;q$V+=q$R)q$W=q$o.insertNode(q$V,q$S[q$V],q$S[q$V+1],q$W);else for(q$V=q$a-q$R;q$_<=q$V;q$V-=q$R)q$W=q$o.insertNode(q$V,q$S[q$V],q$S[q$V+1],q$W);return q$W&&q$o.equals(q$W,q$W.next)&&(q$o.removeNode(q$W),q$W=q$W.next),q$W},q$o.filterPoints=function(q$S,q$_){if(!q$S)return q$S;q$_||(q$_=q$S);var q$a,q$R=q$S;do{if(q$a=!1,q$R.steiner||!q$o.equals(q$R,q$R.next)&&0!==q$o.area(q$R.prev,q$R,q$R.next))q$R=q$R.next;else{if(q$o.removeNode(q$R),(q$R=q$_=q$R.prev)===q$R.next)break;q$a=!0}}while(q$a||q$R!==q$_);return q$_},q$o.earcutLinked=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){if(q$S){!q$W&&q$V&&q$o.indexCurve(q$S,q$R,q$J,q$V);for(var q$k,q$z,q$b=q$S;q$S.prev!==q$S.next;)if(q$k=q$S.prev,q$z=q$S.next,q$V?q$o.isEarHashed(q$S,q$R,q$J,q$V):q$o.isEar(q$S))q$_.push(q$k.i/q$a),q$_.push(q$S.i/q$a),q$_.push(q$z.i/q$a),q$o.removeNode(q$S),q$S=q$z.next,q$b=q$z.next;else if((q$S=q$z)===q$b){q$W?1===q$W?(q$S=q$o.cureLocalIntersections(q$S,q$_,q$a),q$o.earcutLinked(q$S,q$_,q$a,q$R,q$J,q$V,2)):2===q$W&&q$o.splitEarcut(q$S,q$_,q$a,q$R,q$J,q$V):q$o.earcutLinked(q$o.filterPoints(q$S,null),q$_,q$a,q$R,q$J,q$V,1);break}}},q$o.isEar=function(q$S){var q$_=q$S.prev,q$a=q$S,q$R=q$S.next;if(0<=q$o.area(q$_,q$a,q$R))return!1;for(var q$J=q$S.next.next;q$J!==q$S.prev;){if(q$o.pointInTriangle(q$_.x,q$_.y,q$a.x,q$a.y,q$R.x,q$R.y,q$J.x,q$J.y)&&0<=q$o.area(q$J.prev,q$J,q$J.next))return!1;q$J=q$J.next}return!0},q$o.isEarHashed=function(q$S,q$_,q$a,q$R){var q$J=q$S.prev,q$V=q$S,q$W=q$S.next;if(0<=q$o.area(q$J,q$V,q$W))return!1;for(var q$k=q$J.x<q$V.x?q$J.x<q$W.x?q$J.x:q$W.x:q$V.x<q$W.x?q$V.x:q$W.x,q$z=q$J.y<q$V.y?q$J.y<q$W.y?q$J.y:q$W.y:q$V.y<q$W.y?q$V.y:q$W.y,q$b=q$J.x>q$V.x?q$J.x>q$W.x?q$J.x:q$W.x:q$V.x>q$W.x?q$V.x:q$W.x,q$H=q$J.y>q$V.y?q$J.y>q$W.y?q$J.y:q$W.y:q$V.y>q$W.y?q$V.y:q$W.y,q$L=q$o.zOrder(q$k,q$z,q$_,q$a,q$R),q$C=q$o.zOrder(q$b,q$H,q$_,q$a,q$R),q$G=q$S.nextZ;q$G&&q$G.z<=q$C;){if(q$G!==q$S.prev&&q$G!==q$S.next&&q$o.pointInTriangle(q$J.x,q$J.y,q$V.x,q$V.y,q$W.x,q$W.y,q$G.x,q$G.y)&&0<=q$o.area(q$G.prev,q$G,q$G.next))return!1;q$G=q$G.nextZ}for(q$G=q$S.prevZ;q$G&&q$G.z>=q$L;){if(q$G!==q$S.prev&&q$G!==q$S.next&&q$o.pointInTriangle(q$J.x,q$J.y,q$V.x,q$V.y,q$W.x,q$W.y,q$G.x,q$G.y)&&0<=q$o.area(q$G.prev,q$G,q$G.next))return!1;q$G=q$G.prevZ}return!0},q$o.cureLocalIntersections=function(q$S,q$_,q$a){var q$R=q$S;do{var q$J=q$R.prev,q$V=q$R.next.next;!q$o.equals(q$J,q$V)&&q$o.intersects(q$J,q$R,q$R.next,q$V)&&q$o.locallyInside(q$J,q$V)&&q$o.locallyInside(q$V,q$J)&&(q$_.push(q$J.i/q$a),q$_.push(q$R.i/q$a),q$_.push(q$V.i/q$a),q$o.removeNode(q$R),q$o.removeNode(q$R.next),q$R=q$S=q$V),q$R=q$R.next}while(q$R!==q$S);return q$R},q$o.splitEarcut=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=q$S;do{for(var q$k=q$W.next.next;q$k!==q$W.prev;){if(q$W.i!==q$k.i&&q$o.isValidDiagonal(q$W,q$k)){var q$z=q$o.splitPolygon(q$W,q$k);return q$W=q$o.filterPoints(q$W,q$W.next),q$z=q$o.filterPoints(q$z,q$z.next),q$o.earcutLinked(q$W,q$_,q$a,q$R,q$J,q$V),void q$o.earcutLinked(q$z,q$_,q$a,q$R,q$J,q$V)}q$k=q$k.next}q$W=q$W.next}while(q$W!==q$S)},q$o.eliminateHoles=function(q$S,q$_,q$a,q$R){var q$J,q$V,q$W,q$k,q$z,q$b=[];for(q$J=0,q$V=q$_.length;q$J<q$V;q$J++)q$W=q$_[q$J]*q$R,q$k=q$J<q$V-1?q$_[q$J+1]*q$R:q$S.length,(q$z=q$o.linkedList(q$S,q$W,q$k,q$R,!1))===q$z.next&&(q$z.steiner=!0),q$b.push(q$o.getLeftmost(q$z));for(q$b.sort(q$o.compareX),q$J=0;q$J<q$b.length;q$J++)q$o.eliminateHole(q$b[q$J],q$a),q$a=q$o.filterPoints(q$a,q$a.next);return q$a},q$o.compareX=function(q$S,q$_){return q$S.x-q$_.x},q$o.eliminateHole=function(q$S,q$_){if(q$_=q$o.findHoleBridge(q$S,q$_)){var q$a=q$o.splitPolygon(q$_,q$S);q$o.filterPoints(q$a,q$a.next)}},q$o.findHoleBridge=function(q$S,q$_){var q$a,q$R=q$_,q$J=q$S.x,q$V=q$S.y,q$W=-1/0;do{if(q$V<=q$R.y&&q$V>=q$R.next.y&&q$R.next.y!==q$R.y){var q$k=q$R.x+(q$V-q$R.y)*(q$R.next.x-q$R.x)/(q$R.next.y-q$R.y);if(q$k<=q$J&&q$W<q$k){if((q$W=q$k)===q$J){if(q$V===q$R.y)return q$R;if(q$V===q$R.next.y)return q$R.next}q$a=q$R.x<q$R.next.x?q$R:q$R.next}}q$R=q$R.next}while(q$R!==q$_);if(!q$a)return null;if(q$J===q$W)return q$a.prev;var q$z,q$b=q$a,q$H=q$a.x,q$L=q$a.y,q$C=1/0;for(q$R=q$a.next;q$R!==q$b;)q$J>=q$R.x&&q$R.x>=q$H&&q$J!==q$R.x&&q$o.pointInTriangle(q$V<q$L?q$J:q$W,q$V,q$H,q$L,q$V<q$L?q$W:q$J,q$V,q$R.x,q$R.y)&&((q$z=Math.abs(q$V-q$R.y)/(q$J-q$R.x))<q$C||q$z===q$C&&q$R.x>q$a.x)&&q$o.locallyInside(q$R,q$S)&&(q$a=q$R,q$C=q$z),q$R=q$R.next;return q$a},q$o.indexCurve=function(q$S,q$_,q$a,q$R){for(var q$J=q$S;null===q$J.z&&(q$J.z=q$o.zOrder(q$J.x,q$J.y,q$_,q$a,q$R)),q$J.prevZ=q$J.prev,q$J.nextZ=q$J.next,(q$J=q$J.next)!==q$S;);q$J.prevZ.nextZ=null,q$J.prevZ=null,q$o.sortLinked(q$J)},q$o.sortLinked=function(q$S){var q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b=1;do{for(q$a=q$S,q$V=q$S=null,q$W=0;q$a;){for(q$W++,q$R=q$a,q$_=q$k=0;q$_<q$b&&(q$k++,q$R=q$R.nextZ);q$_++);for(q$z=q$b;0<q$k||0<q$z&&q$R;)0!==q$k&&(0===q$z||!q$R||q$a.z<=q$R.z)?(q$a=(q$J=q$a).nextZ,q$k--):(q$R=(q$J=q$R).nextZ,q$z--),q$V?q$V.nextZ=q$J:q$S=q$J,q$J.prevZ=q$V,q$V=q$J;q$a=q$R}q$V.nextZ=null,q$b*=2}while(1<q$W);return q$S},q$o.zOrder=function(q$S,q$_,q$a,q$R,q$J){return(q$S=1431655765&((q$S=858993459&((q$S=252645135&((q$S=16711935&((q$S=32767*(q$S-q$a)*q$J)|q$S<<8))|q$S<<4))|q$S<<2))|q$S<<1))|(q$_=1431655765&((q$_=858993459&((q$_=252645135&((q$_=16711935&((q$_=32767*(q$_-q$R)*q$J)|q$_<<8))|q$_<<4))|q$_<<2))|q$_<<1))<<1},q$o.getLeftmost=function(q$S){for(var q$_=q$S,q$a=q$S;q$_.x<q$a.x&&(q$a=q$_),(q$_=q$_.next)!==q$S;);return q$a},q$o.pointInTriangle=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){return 0<=(q$J-q$W)*(q$_-q$k)-(q$S-q$W)*(q$V-q$k)&&0<=(q$S-q$W)*(q$R-q$k)-(q$a-q$W)*(q$_-q$k)&&0<=(q$a-q$W)*(q$V-q$k)-(q$J-q$W)*(q$R-q$k)},q$o.isValidDiagonal=function(q$S,q$_){return q$S.next.i!==q$_.i&&q$S.prev.i!==q$_.i&&!q$o.intersectsPolygon(q$S,q$_)&&q$o.locallyInside(q$S,q$_)&&q$o.locallyInside(q$_,q$S)&&q$o.middleInside(q$S,q$_)},q$o.area=function(q$S,q$_,q$a){return(q$_.y-q$S.y)*(q$a.x-q$_.x)-(q$_.x-q$S.x)*(q$a.y-q$_.y)},q$o.equals=function(q$S,q$_){return q$S.x===q$_.x&&q$S.y===q$_.y},q$o.intersects=function(q$S,q$_,q$a,q$R){return!!(q$o.equals(q$S,q$_)&&q$o.equals(q$a,q$R)||q$o.equals(q$S,q$R)&&q$o.equals(q$a,q$_))||0<q$o.area(q$S,q$_,q$a)!=0<q$o.area(q$S,q$_,q$R)&&0<q$o.area(q$a,q$R,q$S)!=0<q$o.area(q$a,q$R,q$_)},q$o.intersectsPolygon=function(q$S,q$_){var q$a=q$S;do{if(q$a.i!==q$S.i&&q$a.next.i!==q$S.i&&q$a.i!==q$_.i&&q$a.next.i!==q$_.i&&q$o.intersects(q$a,q$a.next,q$S,q$_))return!0;q$a=q$a.next}while(q$a!==q$S);return!1},q$o.locallyInside=function(q$S,q$_){return q$o.area(q$S.prev,q$S,q$S.next)<0?0<=q$o.area(q$S,q$_,q$S.next)&&0<=q$o.area(q$S,q$S.prev,q$_):q$o.area(q$S,q$_,q$S.prev)<0||q$o.area(q$S,q$S.next,q$_)<0},q$o.middleInside=function(q$S,q$_){for(var q$a=q$S,q$R=!1,q$J=(q$S.x+q$_.x)/2,q$V=(q$S.y+q$_.y)/2;q$a.y>q$V!=q$a.next.y>q$V&&q$a.next.y!==q$a.y&&q$J<(q$a.next.x-q$a.x)*(q$V-q$a.y)/(q$a.next.y-q$a.y)+q$a.x&&(q$R=!q$R),(q$a=q$a.next)!==q$S;);return q$R},q$o.splitPolygon=function(q$S,q$_){var q$a=new q$JS(q$S.i,q$S.x,q$S.y),q$R=new q$JS(q$_.i,q$_.x,q$_.y),q$J=q$S.next,q$V=q$_.prev;return(q$S.next=q$_).prev=q$S,(q$a.next=q$J).prev=q$a,(q$R.next=q$a).prev=q$R,(q$V.next=q$R).prev=q$V,q$R},q$o.insertNode=function(q$S,q$_,q$a,q$R){var q$J=new q$JS(q$S,q$_,q$a);return q$R?(q$J.next=q$R.next,(q$J.prev=q$R).next.prev=q$J,q$R.next=q$J):(q$J.prev=q$J).next=q$J,q$J},q$o.removeNode=function(q$S){q$S.next.prev=q$S.prev,q$S.prev.next=q$S.next,q$S.prevZ&&(q$S.prevZ.nextZ=q$S.nextZ),q$S.nextZ&&(q$S.nextZ.prevZ=q$S.prevZ)},q$o.signedArea=function(q$S,q$_,q$a,q$R){for(var q$J=0,q$V=q$_,q$W=q$a-q$R;q$V<q$a;q$V+=q$R)q$J+=(q$S[q$W]-q$S[q$V])*(q$S[q$V+1]+q$S[q$W+1]),q$W=q$V;return q$J},q$o}(),q$JS=function(){function q$S(q$S,q$_,q$a){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=q$S,this.x=q$_,this.y=q$a,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return q$C(q$S,"laya.webgl.shapes.EarcutNode"),q$S}(),q$VS=(function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this.lineWidth=q$S,this.lineColor=q$_,this.lineAlpha=q$a,this.fillColor=q$R,this.fillAlpha=q$J,this.shape=q$W,this.fill=q$V}q$C(q$S,"laya.webgl.shapes.GeometryData");var q$_=q$S.prototype;q$_.clone=function(){return new q$S(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},q$_.getIndexData=function(){return null},q$_.getVertexData=function(){return null},q$_.destroy=function(){this.shape=null}}(),function(){function q$S(q$S){if(q$S instanceof Float32Array)this.points=q$S;else if(q$S instanceof Array){q$S.length;this.points=new Float32Array(q$S)}}q$C(q$S,"laya.webgl.shapes.Vertex");var q$_=q$S.prototype;q$m.imps(q$_,{"laya.webgl.shapes.IShape":!0}),q$_.getData=function(q$S,q$_,q$a){},q$_.needUpdate=function(q$S){return!1},q$_.rebuild=function(q$S){},q$_.setMatrix=function(q$S){}}(),function(){function q$z(q$S){void 0===q$S&&(q$S=1e4),this._renderType=q$S}q$C(q$z,"laya.webgl.submit.Submit");var q$S=q$z.prototype;return q$m.imps(q$S,{"laya.webgl.submit.ISubmit":!0}),q$S.releaseRender=function(){var q$S=q$z._cache;(q$S[q$S._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},q$S.getRenderType=function(){return this._renderType},q$S.renderSubmit=function(){if(0===this._numEle)return 1;var q$S=this.shaderValue.textureHost;if(q$S){var q$_=q$S.source;if(!q$S.bitmap||!q$_)return 1;this.shaderValue.texture=q$_,q$S.alphaTexture&&q$S.alphaTexture.source&&(this.shaderValue.texture1=q$S.alphaTexture.source)}this._vb.bind_upload(this._ib);var q$a=q$jS.mainContext;return this.shaderValue.upload(),q$f.activeBlendFunction!==this._blendFn&&(q$a.enable(3042),this._blendFn(q$a),q$f.activeBlendFunction=this._blendFn),q$X.drawCall++,q$X.trianglesFaces+=this._numEle/3,q$a.drawElements(4,this._numEle,5123,this._startIdx),1},q$z.__init__=function(){var q$S=q$z.RENDERBASE=new q$z(-1);q$S.shaderValue=new q$NS(0,0),q$S.shaderValue.ALPHA=-1234},q$z.createSubmit=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$z._cache._length?q$z._cache[--q$z._cache._length]:new q$z;null==q$a&&((q$a=q$V._selfVb||(q$V._selfVb=q$dS.create(-1))).clear(),q$R=0),q$V._ib=q$_,q$V._vb=q$a,q$V._startIdx=q$R*q$oS.BYTES_PIDX,q$V._numEle=0;var q$W=q$S._nBlendType;q$V._blendFn=q$S._targets?q$f.targetFns[q$W]:q$f.fns[q$W],q$V.shaderValue=q$J,q$V.shaderValue.setValue(q$S._shader2D);var q$k=q$S._shader2D.filters;return q$k&&q$V.shaderValue.setFilters(q$k),q$V},q$z.createShape=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=q$z._cache._length?q$z._cache[--q$z._cache._length]:new q$z;q$W._ib=q$_,q$W._vb=q$a,q$W._numEle=q$R,q$W._startIdx=q$J,q$W.shaderValue=q$V,q$W.shaderValue.setValue(q$S._shader2D);var q$k=q$S._nBlendType;return q$W._blendFn=q$S._targets?q$f.targetFns[q$k]:q$f.fns[q$k],q$W},q$z.TYPE_2D=1e4,q$z.TYPE_CANVAS=10003,q$z.TYPE_CMDSETRT=10004,q$z.TYPE_CUSTOM=10005,q$z.TYPE_BLURRT=10006,q$z.TYPE_CMDDESTORYPRERT=10007,q$z.TYPE_DISABLESTENCIL=10008,q$z.TYPE_OTHERIBVB=10009,q$z.TYPE_PRIMITIVE=10010,q$z.TYPE_RT=10011,q$z.TYPE_BLUR_RT=10012,q$z.TYPE_TARGET=10013,q$z.TYPE_CHANGE_VALUE=10014,q$z.TYPE_SHAPE=10015,q$z.TYPE_TEXTURE=10016,q$z.TYPE_FILLTEXTURE=10017,q$z.RENDERBASE=null,q$z._cache=((q$z._cache=[])._length=0,q$z._cache),q$z}()),q$WS=function(){function q$R(){this.fun=null,this.args=null}q$C(q$R,"laya.webgl.submit.SubmitCMD");var q$S=q$R.prototype;return q$m.imps(q$S,{"laya.webgl.submit.ISubmit":!0}),q$S.renderSubmit=function(){return this.fun.apply(null,this.args),1},q$S.getRenderType=function(){return 0},q$S.releaseRender=function(){var q$S=q$R._cache;q$S[q$S._length++]=this},q$R.create=function(q$S,q$_){var q$a=q$R._cache._length?q$R._cache[--q$R._cache._length]:new q$R;return q$a.fun=q$_,q$a.args=q$S,q$a},q$R._cache=((q$R._cache=[])._length=0,q$R._cache),q$R}(),q$kS=function(){function q$_(){this.variables={}}q$C(q$_,"laya.webgl.submit.SubmitCMDScope");var q$S=q$_.prototype;return q$S.getValue=function(q$S){return this.variables[q$S]},q$S.addValue=function(q$S,q$_){return this.variables[q$S]=q$_},q$S.setValue=function(q$S,q$_){return this.variables.hasOwnProperty(q$S)?this.variables[q$S]=q$_:null},q$S.clear=function(){for(var q$S in this.variables)delete this.variables[q$S]},q$S.recycle=function(){this.clear(),q$_.POOL.push(this)},q$_.create=function(){var q$S=q$_.POOL.pop();return q$S||(q$S=new q$_),q$S},q$_.POOL=[],q$_}(),q$zS=function(){function q$L(){this.offset=0,this.startIndex=0,this._mat=q$n.create()}q$C(q$L,"laya.webgl.submit.SubmitOtherIBVB");var q$S=q$L.prototype;return q$m.imps(q$S,{"laya.webgl.submit.ISubmit":!0}),q$S.releaseRender=function(){var q$S=q$L._cache;(q$S[q$S._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},q$S.getRenderType=function(){return 10009},q$S.renderSubmit=function(){var q$S=this._shaderValue.textureHost;if(q$S){var q$_=q$S.source;if(!q$S.bitmap||!q$_)return 1;this._shaderValue.texture=q$_}this._vb.bind_upload(this._ib);var q$a=q$TS.worldMatrix4,q$R=q$n.TEMP;q$n.mulPre(this._mat,q$a[0],q$a[1],q$a[4],q$a[5],q$a[12],q$a[13],q$R);var q$J=q$TS.worldMatrix4=q$L.tempMatrix4;q$J[0]=q$R.a,q$J[1]=q$R.b,q$J[4]=q$R.c,q$J[5]=q$R.d,q$J[12]=q$R.tx,q$J[13]=q$R.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var q$V=q$jS.mainContext;return q$f.activeBlendFunction!==this._blendFn&&(q$V.enable(3042),this._blendFn(q$V),q$f.activeBlendFunction=this._blendFn),q$X.drawCall++,q$X.trianglesFaces+=this._numEle/3,q$V.drawElements(4,this._numEle,5123,this.startIndex),q$TS.worldMatrix4=q$a,q$MS.activeShader=null,1},q$L.create=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){void 0===q$z&&(q$z=0);var q$b=q$L._cache._length?q$L._cache[--q$L._cache._length]:new q$L;q$b._ib=q$a,q$b._vb=q$_,q$b._numEle=q$R,q$b._shader=q$J,q$b._shaderValue=q$V;var q$H=q$S._nBlendType;switch(q$b._blendFn=q$S._targets?q$f.targetFns[q$H]:q$f.fns[q$H],q$z){case 0:q$b.offset=0,q$b.startIndex=q$k/(q$oS.BYTES_PE*q$_.vertexStride)*1.5,q$b.startIndex*=q$oS.BYTES_PIDX;break;case 1:q$b.startIndex=q$W,q$b.offset=q$k}return q$b},q$L._cache=((q$L._cache=[])._length=0,q$L._cache),q$L.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],q$L}(),q$bS=function(){function q$a(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new q$B,this.screenRect=new q$B}q$C(q$a,"laya.webgl.submit.SubmitScissor");var q$S=q$a.prototype;return q$m.imps(q$S,{"laya.webgl.submit.ISubmit":!0}),q$S._scissor=function(q$S,q$_,q$a,q$R){var q$J=q$TS.worldMatrix4,q$V=q$J[0],q$W=q$J[5],q$k=q$J[12],q$z=q$J[13];if(q$R*=q$W,(q$a*=q$V)<1||q$R<1)return!1;var q$b=(q$S=q$S*q$V+q$k)+q$a,q$H=(q$_=q$_*q$W+q$z)+q$R;q$S<0&&(q$a=q$b-(q$S=0)),q$_<0&&(q$R=q$H-(q$_=0));var q$L=q$TS.worldClipRect;if(q$S=Math.max(q$S,q$L.x),q$_=Math.max(q$_,q$L.y),q$a=Math.min(q$b,q$L.right)-q$S,q$R=Math.min(q$H,q$L.bottom)-q$_,q$a<1||q$R<1)return!1;var q$C=q$TS.worldScissorTest;return this.screenRect.copyFrom(q$L),q$L.x=q$S,q$L.y=q$_,q$L.width=q$a,q$L.height=q$R,q$TS.worldScissorTest=!0,q$_=q$TS.height-q$_-q$R,q$jS.mainContext.scissor(q$S,q$_,q$a,q$R),q$jS.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),q$C?(q$_=q$TS.height-this.screenRect.y-this.screenRect.height,q$jS.mainContext.scissor(this.screenRect.x,q$_,this.screenRect.width,this.screenRect.height),q$jS.mainContext.enable(3089)):(q$jS.mainContext.disable(3089),q$TS.worldScissorTest=!1),q$L.copyFrom(this.screenRect),!0},q$S._scissorWithTagart=function(q$S,q$_,q$a,q$R){if(q$a<1||q$R<1)return!1;var q$J=q$S+q$a,q$V=q$_+q$R;q$S<0&&(q$a=q$J-(q$S=0)),q$_<0&&(q$R=q$V-(q$_=0));var q$W=q$TS.worldClipRect;if(q$S=Math.max(q$S,q$W.x),q$_=Math.max(q$_,q$W.y),q$a=Math.min(q$J,q$W.right)-q$S,q$R=Math.min(q$V,q$W.bottom)-q$_,q$a<1||q$R<1)return!1;var q$k=q$TS.worldScissorTest;return this.screenRect.copyFrom(q$W),q$TS.worldScissorTest=!0,q$W.x=q$S,q$W.y=q$_,q$W.width=q$a,q$W.height=q$R,q$_=q$TS.height-q$_-q$R,q$jS.mainContext.scissor(q$S,q$_,q$a,q$R),q$jS.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),q$k?(q$_=q$TS.height-this.screenRect.y-this.screenRect.height,q$jS.mainContext.scissor(this.screenRect.x,q$_,this.screenRect.width,this.screenRect.height),q$jS.mainContext.enable(3089)):(q$jS.mainContext.disable(3089),q$TS.worldScissorTest=!1),q$W.copyFrom(this.screenRect),!0},q$S.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},q$S.getRenderType=function(){return 0},q$S.releaseRender=function(){var q$S=q$a._cache;(q$S[q$S._length++]=this).context=null},q$a.create=function(q$S){var q$_=q$a._cache._length?q$a._cache[--q$a._cache._length]:new q$a;return q$_.context=q$S,q$_},q$a._cache=((q$a._cache=[])._length=0,q$a._cache),q$a}(),q$HS=function(){function q$z(){this.step=0,this.blendMode=null,this.level=0}q$C(q$z,"laya.webgl.submit.SubmitStencil");var q$S=q$z.prototype;return q$m.imps(q$S,{"laya.webgl.submit.ISubmit":!0}),q$S.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},q$S.getRenderType=function(){return 0},q$S.releaseRender=function(){var q$S=q$z._cache;q$S[q$S._length++]=this},q$S.do1=function(){var q$S=q$jS.mainContext;q$S.enable(2960),q$S.clear(1024),q$S.colorMask(!1,!1,!1,!1),q$S.stencilFunc(514,this.level,255),q$S.stencilOp(7680,7680,7682)},q$S.do2=function(){var q$S=q$jS.mainContext;q$S.stencilFunc(514,this.level+1,255),q$S.colorMask(!0,!0,!0,!0),q$S.stencilOp(7680,7680,7680)},q$S.do3=function(){var q$S=q$jS.mainContext;q$S.colorMask(!0,!0,!0,!0),q$S.stencilOp(7680,7680,7680),q$S.clear(1024),q$S.disable(2960)},q$S.do4=function(){var q$S=q$jS.mainContext;0==this.level&&(q$S.enable(2960),q$S.clear(1024)),q$S.colorMask(!1,!1,!1,!1),q$S.stencilFunc(519,0,255),q$S.stencilOp(7680,7680,7682)},q$S.do5=function(){var q$S=q$jS.mainContext;q$S.stencilFunc(514,this.level,255),q$S.colorMask(!0,!0,!0,!0),q$S.stencilOp(7680,7680,7680)},q$S.do6=function(){var q$S=q$jS.mainContext;q$f.targetFns[q$f.TOINT[this.blendMode]](q$S)},q$S.do7=function(){var q$S=q$jS.mainContext;q$S.colorMask(!1,!1,!1,!1),q$S.stencilOp(7680,7680,7683)},q$S.do8=function(){var q$S=q$jS.mainContext;q$S.colorMask(!0,!0,!0,!0),q$S.stencilFunc(514,this.level,255),q$S.stencilOp(7680,7680,7680)},q$z.restore=function(q$S,q$_,q$a,q$R,q$J){var q$V;if((q$S._renderKey=0)<q$z._mask&&q$z._mask--,0==q$z._mask)q$V=laya.webgl.submit.SubmitStencil.create(3),q$S.addRenderObject(q$V),q$S._curSubmit=q$VS.RENDERBASE;else{q$V=laya.webgl.submit.SubmitStencil.create(7),q$S.addRenderObject(q$V);var q$W=q$S._vb;q$W._byteLength;if(q$$S.fillRectImgVb(q$W,null,q$_.x,q$_.y,q$_.width,q$_.height,q$P.DEF_UV,q$a,q$R,q$J,0,0)){q$S._shader2D.glTexture=null;var q$k=q$S._curSubmit=q$VS.createSubmit(q$S,q$S._ib,q$W,(q$W._byteLength-64)/32*3,q$NS.create(2,0));q$k.shaderValue.ALPHA=1,q$S._submits[q$S._submits._length++]=q$k,q$S._curSubmit._numEle+=6,q$S._curSubmit=q$VS.RENDERBASE}else alert("clipRect calc stencil rect error");q$V=laya.webgl.submit.SubmitStencil.create(8),q$S.addRenderObject(q$V)}},q$z.restore2=function(q$S,q$_){var q$a;(q$S._renderKey=0)<q$z._mask&&q$z._mask--,0==q$z._mask?(q$a=laya.webgl.submit.SubmitStencil.create(3),q$S.addRenderObject(q$a),q$S._curSubmit=q$VS.RENDERBASE):(q$a=laya.webgl.submit.SubmitStencil.create(7),q$S.addRenderObject(q$a),q$S._submits[q$S._submits._length++]=q$_,q$a=laya.webgl.submit.SubmitStencil.create(8),q$S.addRenderObject(q$a))},q$z.create=function(q$S){var q$_=q$z._cache._length?q$z._cache[--q$z._cache._length]:new q$z;return 5==(q$_.step=q$S)&&++q$z._mask,q$_.level=q$z._mask,q$_},q$z._cache=((q$z._cache=[])._length=0,q$z._cache),q$z._mask=0,q$z}(),q$LS=function(){function q$k(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}q$C(q$k,"laya.webgl.submit.SubmitTarget");var q$S=q$k.prototype;return q$m.imps(q$S,{"laya.webgl.submit.ISubmit":!0}),q$S.renderSubmit=function(){this._vb.bind_upload(this._ib);var q$S=this.scope.getValue(this.proName);return q$S&&(this.shaderValue.texture=q$S.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[q$S.width,q$S.height]),this.shaderValue.upload(),this.blend(),q$X.drawCall++,q$X.trianglesFaces+=this._numEle/3,q$jS.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},q$S.blend=function(){if(q$f.activeBlendFunction!==q$f.fns[this.blendType]){var q$S=q$jS.mainContext;q$S.enable(3042),q$f.fns[this.blendType](q$S),q$f.activeBlendFunction=q$f.fns[this.blendType]}},q$S.getRenderType=function(){return 0},q$S.releaseRender=function(){var q$S=q$k._cache;(q$S[q$S._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},q$k.create=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=q$k._cache._length?q$k._cache[--q$k._cache._length]:new q$k;return q$W._ib=q$_,q$W._vb=q$a,q$W.proName=q$V,q$W._startIdx=q$R*q$oS.BYTES_PIDX,q$W._numEle=0,q$W.blendType=q$S._nBlendType,q$W.shaderValue=q$J,q$W.shaderValue.setValue(q$S._shader2D),q$W},q$k._cache=((q$k._cache=[])._length=0,q$k._cache),q$k}(),q$CS=function(){function q$S(){this._sourceStr=null}q$C(q$S,"laya.webgl.text.CharSegment");var q$_=q$S.prototype;return q$m.imps(q$_,{"laya.webgl.text.ICharSegment":!0}),q$_.textToSpit=function(q$S){this._sourceStr=q$S},q$_.getChar=function(q$S){return this._sourceStr.charAt(q$S)},q$_.getCharCode=function(q$S){return this._sourceStr.charCodeAt(q$S)},q$_.length=function(){return this._sourceStr.length},q$S}(),q$GS=function(){var q$S;function q$X(){}return q$C(q$X,"laya.webgl.text.DrawText"),q$X.__init__=function(){q$X._charsTemp=new Array,q$X._drawValue=new q$S,q$X._charSeg=new q$CS},q$X.customCharSeg=function(q$S){q$X._charSeg=q$S},q$X.getChar=function(q$S,q$_,q$a){var q$R=q$ZS.createOneChar(q$S,q$a);return-1!=q$_&&(q$X._charsCache[q$_]=q$R),q$R},q$X._drawSlow=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$L,q$C,q$G,q$t){var q$o,q$$,q$F=q$X._drawValue.value(q$V,q$k,q$z,q$b,q$C,q$G,q$t),q$T=0,q$D=0,q$j=q$X._charsTemp,q$Q=0,q$m=NaN;if(q$R)for(q$j.length=q$R.length,q$T=0,q$D=q$R.length;q$T<q$D;q$T++)(q$$=q$R[q$T])&&(q$m=q$$.charNum+q$F.txtID,q$j[q$T]=q$o=q$X._charsCache[q$m]||q$X.getChar(q$$.char,q$m,q$F),q$o.active());else{var q$q=q$a instanceof laya.utils.WordText?q$a.toString():q$a;if(q$K.CharacterCache){q$X._charSeg.textToSpit(q$q);var q$N=q$X._charSeg.length();for(q$T=0,q$D=q$j.length=q$N;q$T<q$D;q$T++)q$m=q$X._charSeg.getCharCode(q$T)+q$F.txtID,q$j[q$T]=q$o=q$X._charsCache[q$m]||q$X.getChar(q$X._charSeg.getChar(q$T),q$m,q$F),q$o.active(),q$Q+=q$o.cw}else q$j.length=0,(q$o=q$X.getChar(q$q,-1,q$F)).active(),q$Q+=q$o.cw,q$j[0]=q$o}var q$n=0;null!==q$W&&"left"!==q$W&&(q$n=-("center"==q$W?q$Q/2:q$Q));var q$l,q$B,q$I=NaN,q$A=0;if(q$R)for(q$T=0,q$D=q$j.length;q$T<q$D;q$T++)q$o=q$j[q$T],q$$=q$R[q$T],q$o&&q$$&&!q$o.isSpace&&(q$I=q$o.borderSize,q$l=q$o.texture,q$_._drawText(q$l,q$H+q$n+q$$.x*q$C-q$I,q$L+q$$.y*q$G-q$I,q$l.width,q$l.height,q$J,0,0,0,0));else{for(q$T=0,q$D=q$j.length;q$T<q$D;q$T++)(q$o=q$j[q$T])&&!q$o.isSpace&&(q$I=q$o.borderSize,q$l=q$o.texture,q$_._drawText(q$l,q$H+q$n-q$I,q$L-q$I,q$l.width,q$l.height,q$J,0,0,0,0),q$S&&((q$B=q$S[q$A++])||(q$B=q$S[q$A-1]=[]),q$B[0]=q$l,q$B[1]=q$n-q$I,q$B[2]=-q$I)),q$n+=q$o.cw;q$S&&(q$S.length=q$A)}},q$X._drawFast=function(q$S,q$_,q$a,q$R,q$J){for(var q$V,q$W,q$k=0,q$z=q$S.length;q$k<q$z;q$k++)(q$V=(q$W=q$S[q$k])[0]).active(),q$_._drawText(q$V,q$R+q$W[1],q$J+q$W[2],q$V.width,q$V.height,q$a,0,0,0,0)},q$X.drawText=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$L){if(void 0===q$L&&(q$L=0),!(q$_&&0===q$_.length||q$a&&0===q$a.length)){var q$C=q$R.a,q$G=q$R.d;(0!==q$R.b||0!==q$R.c)&&(q$C=q$G=1);var q$t=1!==q$C||1!==q$G;if(q$t&&q$m.stage.transform){var q$o=q$m.stage.transform;q$t=q$o.a===q$C&&q$o.d===q$G}else q$t=!1;if(q$t){var q$$=(q$R=q$R.copyTo(q$qS._tmpMatrix)).tx,q$F=q$R.ty;q$R.scale(1/q$C,1/q$G),q$R._checkTransform(),q$b*=q$C,q$H*=q$G,q$b+=q$$-q$R.tx,q$H+=q$F-q$R.ty}else q$C=q$G=1;if(q$a)q$X._drawSlow(null,q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$C,q$G,q$L);else{if(null===q$_.toUpperCase){var q$T=q$C+1e5*q$G,q$D=q$_;return void(q$D.changed||q$D.id!==q$T?(q$D.id=q$T,q$D.changed=!1,q$X._drawSlow(q$D.save,q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$C,q$G,q$L)):q$X._drawFast(q$D.save,q$S,q$R,q$b,q$H))}var q$j=q$_+q$J.toString()+q$W+q$k+q$z+q$C+q$G+q$V,q$Q=q$X._textsCache[q$j];q$K.CharacterCache?q$Q?q$X._drawFast(q$Q,q$S,q$R,q$b,q$H):(q$X._textsCache.__length||(q$X._textsCache.__length=0),q$X._textsCache.__length>q$q.WebGLTextCacheCount&&((q$X._textsCache={}).__length=0,q$X._curPoolIndex=0),q$X._textCachesPool[q$X._curPoolIndex]?(q$Q=q$X._textsCache[q$j]=q$X._textCachesPool[q$X._curPoolIndex]).length=0:q$X._textCachesPool[q$X._curPoolIndex]=q$Q=q$X._textsCache[q$j]=[],q$X._textsCache.__length++,q$X._curPoolIndex++,q$X._drawSlow(q$Q,q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$C,q$G,q$L)):q$X._drawSlow(q$Q,q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$C,q$G,q$L)}}},q$X._charsTemp=null,q$X._textCachesPool=[],q$X._curPoolIndex=0,q$X._charsCache={},q$X._textsCache={},q$X._drawValue=null,q$X.d=[],q$X._charSeg=null,q$X.__init$=function(){q$S=function(){function q$z(){}return q$C(q$z,""),q$z.prototype.value=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this.font=q$S,this.fillColor=q$_,this.borderColor=q$a,this.lineWidth=q$R,this.scaleX=q$J,this.scaleY=q$V,this.underLine=q$W;var q$k=q$S.toString()+q$J+q$V+q$R+(q$_?q$_.toLowerCase():" ")+(q$a?q$a.toLowerCase():" ")+q$W;return this.txtID=q$z._keymap[q$k],this.txtID||(this.txtID=1e-7*++q$z._keymapCount,q$z._keymap[q$k]=this.txtID),this},q$z.clear=function(){q$z._keymap={},q$z._keymapCount=1},q$z._keymap={},q$z._keymapCount=1,q$z}()},q$X}(),q$tS=function(){function q$J(q$S){this._index=0,this._size=14,this._italic=-2,q$J._cache2=q$J._cache2||[],this.setFont(q$S||"14px Arial")}q$C(q$J,"laya.webgl.text.FontInContext");var q$S=q$J.prototype;return q$S.setFont=function(q$S){var q$_=q$J._cache2[q$S];if(q$_)this._words=q$_[0],this._size=q$_[1];else{this._words=q$S.split(" ");for(var q$a=0,q$R=this._words.length;q$a<q$R;q$a++)if(0<this._words[q$a].indexOf("px")){this._index=q$a;break}this._size=parseInt(this._words[this._index]),q$J._cache2[q$S]=[this._words,this._size]}this._text=null,this._italic=-2},q$S.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},q$S.hasType=function(q$S){for(var q$_=0,q$a=this._words.length;q$_<q$a;q$_++)if(this._words[q$_]===q$S)return q$_;return-1},q$S.removeType=function(q$S){for(var q$_=0,q$a=this._words.length;q$_<q$a;q$_++)if(this._words[q$_]===q$S){this._words.splice(q$_,1),this._index>q$_&&this._index--;break}this._text=null,this._italic=-2},q$S.copyTo=function(q$S){return q$S._text=this._text,q$S._size=this._size,q$S._index=this._index,q$S._words=this._words.slice(),q$S._italic=-2,q$S},q$S.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},q$R(0,q$S,"size",function(){return this._size},function(q$S){this._size=q$S,this._words[this._index]=q$S+"px",this._text=null}),q$J.create=function(q$S){var q$_=q$J._cache[q$S];return q$_||(q$_=q$J._cache[q$S]=new q$J(q$S))},q$J.EMPTY=new q$J,q$J._cache={},q$J._cache2=null,q$J}(),q$oS=function(){function q$S(){}return q$C(q$S,"laya.webgl.utils.CONST3D2D"),q$S.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],q$S.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],q$S.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],q$S._TMPARRAY=[],q$S._OFFSETX=0,q$S._OFFSETY=0,q$W(q$S,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),q$S}(),q$$S=function(){function q$t(){}return q$C(q$t,"laya.webgl.utils.GlUtils"),q$t.make2DProjection=function(q$S,q$_,q$a){return[2/q$S,0,0,0,0,-2/q$_,0,0,0,0,2/q$a,0,-1,1,0,1]},q$t.fillIBQuadrangle=function(q$S,q$_){if(65535/4<q$_)throw Error("IBQuadrangle count:"+q$_+" must<:"+Math.floor(65535/4));q$_=Math.floor(q$_),q$S._resizeBuffer(6*(q$_+1)*2,!1),q$S.byteLength=q$S.bufferLength;for(var q$a=q$S.getUint16Array(),q$R=0,q$J=0;q$J<q$_;q$J++)q$a[q$R++]=4*q$J,q$a[q$R++]=4*q$J+2,q$a[q$R++]=4*q$J+1,q$a[q$R++]=4*q$J,q$a[q$R++]=4*q$J+3,q$a[q$R++]=4*q$J+2;return q$S.setNeedUpload(),!0},q$t.expandIBQuadrangle=function(q$S,q$_){q$S.bufferLength>=6*q$_*2||q$t.fillIBQuadrangle(q$S,q$_)},q$t.mathCeilPowerOfTwo=function(q$S){return q$S--,q$S|=q$S>>1,q$S|=q$S>>2,q$S|=q$S>>4,q$S|=q$S>>8,q$S|=q$S>>16,++q$S},q$t.fillQuadrangleImgVb=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){var q$z=16+(q$S._byteLength>>2);q$S.byteLength=q$z<<2;var q$b=q$S.getFloat32Array();q$b[(q$z-=16)+2]=q$J[0],q$b[q$z+3]=q$J[1],q$b[q$z+6]=q$J[2],q$b[q$z+7]=q$J[3],q$b[q$z+10]=q$J[4],q$b[q$z+11]=q$J[5],q$b[q$z+14]=q$J[6],q$b[q$z+15]=q$J[7];var q$H=q$V.a,q$L=q$V.b,q$C=q$V.c,q$G=q$V.d;if(1!==q$H||0!==q$L||0!==q$C||1!==q$G){q$V.bTransform=!0;var q$t=q$V.tx+q$W,q$o=q$V.ty+q$k;q$b[q$z]=(q$R[0]+q$_)*q$H+(q$R[1]+q$a)*q$C+q$t,q$b[q$z+1]=(q$R[0]+q$_)*q$L+(q$R[1]+q$a)*q$G+q$o,q$b[q$z+4]=(q$R[2]+q$_)*q$H+(q$R[3]+q$a)*q$C+q$t,q$b[q$z+5]=(q$R[2]+q$_)*q$L+(q$R[3]+q$a)*q$G+q$o,q$b[q$z+8]=(q$R[4]+q$_)*q$H+(q$R[5]+q$a)*q$C+q$t,q$b[q$z+9]=(q$R[4]+q$_)*q$L+(q$R[5]+q$a)*q$G+q$o,q$b[q$z+12]=(q$R[6]+q$_)*q$H+(q$R[7]+q$a)*q$C+q$t,q$b[q$z+13]=(q$R[6]+q$_)*q$L+(q$R[7]+q$a)*q$G+q$o}else q$V.bTransform=!1,q$_+=q$V.tx+q$W,q$a+=q$V.ty+q$k,q$b[q$z]=q$_+q$R[0],q$b[q$z+1]=q$a+q$R[1],q$b[q$z+4]=q$_+q$R[2],q$b[q$z+5]=q$a+q$R[3],q$b[q$z+8]=q$_+q$R[4],q$b[q$z+9]=q$a+q$R[5],q$b[q$z+12]=q$_+q$R[6],q$b[q$z+13]=q$a+q$R[7];return q$S._upload=!0},q$t.fillTranglesVB=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){var q$k=(q$S._byteLength>>2)+q$R.length;q$S.byteLength=q$k<<2;var q$z=q$S.getFloat32Array();q$k-=q$R.length;for(var q$b=q$R.length,q$H=q$J.a,q$L=q$J.b,q$C=q$J.c,q$G=q$J.d,q$t=0;q$t<q$b;q$t+=4)if(q$z[q$k+q$t+2]=q$R[q$t+2],q$z[q$k+q$t+3]=q$R[q$t+3],1!==q$H||0!==q$L||0!==q$C||1!==q$G){q$J.bTransform=!0;var q$o=q$J.tx+q$V,q$$=q$J.ty+q$W;q$z[q$k+q$t]=(q$R[q$t]+q$_)*q$H+(q$R[q$t+1]+q$a)*q$C+q$o,q$z[q$k+q$t+1]=(q$R[q$t]+q$_)*q$L+(q$R[q$t+1]+q$a)*q$G+q$$}else q$J.bTransform=!1,q$_+=q$J.tx+q$V,q$a+=q$J.ty+q$W,q$z[q$k+q$t]=q$_+q$R[q$t],q$z[q$k+q$t+1]=q$a+q$R[q$t+1];return q$S._upload=!0},q$t.copyPreImgVb=function(q$S,q$_,q$a){var q$R=q$S._byteLength>>2;q$S.byteLength=q$R+16<<2;for(var q$J=q$S.getFloat32Array(),q$V=0,q$W=q$R-16;q$V<4;q$V++)q$J[q$R]=q$J[q$W]+q$_,++q$W,q$J[++q$R]=q$J[q$W]+q$a,++q$W,q$J[++q$R]=q$J[q$W],++q$W,q$J[++q$R]=q$J[q$W],++q$R,++q$W;q$S._upload=!0},q$t.fillRectImgVb=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$L,q$C){void 0===q$C&&(q$C=!1);var q$G,q$t,q$o,q$$,q$F,q$T,q$D,q$j,q$Q,q$m,q$q,q$N,q$n,q$l,q$B,q$I,q$A=1,q$X=q$k.a,q$h=q$k.b,q$u=q$k.c,q$K=q$k.d,q$P=q$_&&q$_.width<99999999;if(1!==q$X||0!==q$h||0!==q$u||1!==q$K?(q$k.bTransform=!0,0===q$h&&0===q$u&&(q$A=23,q$Q=q$J+q$a,q$m=q$V+q$R,q$G=q$X*q$a+(q$q=q$k.tx+q$z),q$o=q$X*q$Q+q$q,q$t=q$K*q$R+(q$N=q$k.ty+q$b),q$$=q$K*q$m+q$N)):(q$A=23,q$k.bTransform=!1,q$o=(q$G=q$a+q$k.tx+q$z)+q$J,q$$=(q$t=q$R+q$k.ty+q$b)+q$V),q$P&&(q$F=q$_.x,q$T=q$_.y,q$D=q$_.width+q$F,q$j=q$_.height+q$T),1!==q$A){if(Math.min(q$G,q$o)>=q$D)return!1;if(Math.min(q$t,q$$)>=q$j)return!1;if(Math.max(q$o,q$G)<=q$F)return!1;if(Math.max(q$$,q$t)<=q$T)return!1}var q$M=q$S._byteLength>>2;q$S.byteLength=16+q$M<<2;var q$r=q$S.getFloat32Array();switch(q$r[2+q$M]=q$W[0],q$r[3+q$M]=q$W[1],q$r[6+q$M]=q$W[2],q$r[7+q$M]=q$W[3],q$r[10+q$M]=q$W[4],q$r[11+q$M]=q$W[5],q$r[14+q$M]=q$W[6],q$r[15+q$M]=q$W[7],q$A){case 1:q$q=q$k.tx+q$z,q$N=q$k.ty+q$b;var q$e=q$X*q$a,q$g=q$u*q$R,q$x=q$K*q$R,q$s=q$h*q$a,q$U=q$X*(q$Q=q$J+q$a),q$f=q$u*(q$m=q$V+q$R),q$Y=q$K*q$m,q$i=q$h*q$Q;q$C?(q$n=q$e+q$g+q$q,q$B=Math.round(q$n)-q$n,q$l=q$x+q$s+q$N,q$I=Math.round(q$l)-q$l,q$r[q$M]=q$n+q$B,q$r[1+q$M]=q$l+q$I,q$r[4+q$M]=q$U+q$g+q$q+q$B,q$r[5+q$M]=q$x+q$i+q$N+q$I,q$r[8+q$M]=q$U+q$f+q$q+q$B,q$r[9+q$M]=q$Y+q$i+q$N+q$I,q$r[12+q$M]=q$e+q$f+q$q+q$B,q$r[13+q$M]=q$Y+q$s+q$N+q$I):(q$r[q$M]=q$e+q$g+q$q,q$r[1+q$M]=q$x+q$s+q$N,q$r[4+q$M]=q$U+q$g+q$q,q$r[5+q$M]=q$x+q$i+q$N,q$r[8+q$M]=q$U+q$f+q$q,q$r[9+q$M]=q$Y+q$i+q$N,q$r[12+q$M]=q$e+q$f+q$q,q$r[13+q$M]=q$Y+q$s+q$N);break;case 23:q$C?(q$n=q$G+q$H,q$B=Math.round(q$n)-q$n,q$l=q$t,q$I=Math.round(q$l)-q$l,q$r[q$M]=q$n+q$B,q$r[1+q$M]=q$l+q$I,q$r[4+q$M]=q$o+q$H+q$B,q$r[5+q$M]=q$t+q$I,q$r[8+q$M]=q$o+q$B,q$r[9+q$M]=q$$+q$I,q$r[12+q$M]=q$G+q$B,q$r[13+q$M]=q$$+q$I):(q$r[q$M]=q$G+q$H,q$r[1+q$M]=q$t,q$r[4+q$M]=q$o+q$H,q$r[5+q$M]=q$t,q$r[8+q$M]=q$o,q$r[9+q$M]=q$$,q$r[12+q$M]=q$G,q$r[13+q$M]=q$$)}return q$S._upload=!0},q$t.fillLineVb=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){var q$z=.5*q$W,q$b=q$t._fillLineArray,q$H=-(q$R-q$V),q$L=q$a-q$J,q$C=Math.sqrt(q$H*q$H+q$L*q$L);q$H/=q$C,q$L/=q$C,q$H*=q$z,q$L*=q$z,q$b[0]=q$a-q$H,q$b[1]=q$R-q$L,q$b[4]=q$a+q$H,q$b[5]=q$R+q$L,q$b[8]=q$J+q$H,q$b[9]=q$V+q$L,q$b[12]=q$J-q$H,q$b[13]=q$V-q$L,q$k&&q$k.transformPointArray(q$b,q$b);var q$G=16+(q$S._byteLength>>2);return q$S.byteLength=q$G<<2,q$S.insertData(q$b,q$G-16),!0},q$t._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q$t}(),q$FS=(function(){function q$z(){}q$C(q$z,"laya.webgl.utils.MatirxArray"),q$z.ArrayMul=function(q$S,q$_,q$a){if(q$S)if(q$_)for(var q$R=NaN,q$J=NaN,q$V=NaN,q$W=NaN,q$k=0;q$k<4;q$k++)q$R=q$S[q$k],q$J=q$S[q$k+4],q$V=q$S[q$k+8],q$W=q$S[q$k+12],q$a[q$k]=q$R*q$_[0]+q$J*q$_[1]+q$V*q$_[2]+q$W*q$_[3],q$a[q$k+4]=q$R*q$_[4]+q$J*q$_[5]+q$V*q$_[6]+q$W*q$_[7],q$a[q$k+8]=q$R*q$_[8]+q$J*q$_[9]+q$V*q$_[10]+q$W*q$_[11],q$a[q$k+12]=q$R*q$_[12]+q$J*q$_[13]+q$V*q$_[14]+q$W*q$_[15];else q$z.copyArray(q$S,q$a);else q$z.copyArray(q$_,q$a)},q$z.copyArray=function(q$S,q$_){if(q$S&&q$_)for(var q$a=0;q$a<q$S.length;q$a++)q$_[q$a]=q$S[q$a]}}(),function(){function q$_(q$S,q$_,q$a){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=q$S,this._vb=new q$dS(q$S,35048),q$_&&this._vb._resizeBuffer(q$_,!1),this._ib=new q$vS,q$a&&this._ib._resizeBuffer(q$a,!1)}q$C(q$_,"laya.webgl.utils.Mesh2D");var q$S=q$_.prototype;return q$S.cloneWithNewVB=function(){var q$S=new q$_(this._stride,0,0);return q$S._ib=this._ib,q$S._quadNum=this._quadNum,q$S._attribInfo=this._attribInfo,q$S},q$S.cloneWithNewVBIB=function(){var q$S=new q$_(this._stride,0,0);return q$S._attribInfo=this._attribInfo,q$S},q$S.getVBW=function(){return this._vb.setNeedUpload(),this._vb},q$S.getVBR=function(){return this._vb},q$S.getIBR=function(){return this._ib},q$S.getIBW=function(){return this._ib.setNeedUpload(),this._ib},q$S.createQuadIB=function(q$S){this._quadNum=q$S,this._ib._resizeBuffer(6*q$S*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var q$_=this._ib.getUint16Array(),q$a=0,q$R=0,q$J=0;q$J<q$S;q$J++)q$_[q$a++]=q$R,q$_[q$a++]=q$R+2,q$_[q$a++]=q$R+1,q$_[q$a++]=q$R,q$_[q$a++]=q$R+3,q$_[q$a++]=q$R+2,q$R+=4;this._ib.setNeedUpload()},q$S.setAttributes=function(q$S){if(this._attribInfo=q$S,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},q$S.getEleNum=function(){return this._ib.getBuffer().byteLength/2},q$S.releaseMesh=function(){},q$S.destroy=function(){},q$S.clearVB=function(){this._vb.clear()},q$_._gvaoid=0,q$_}()),q$TS=function(){function q$J(){}return q$C(q$J,"laya.webgl.utils.RenderState2D"),q$J.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},q$J.mat2MatArray=function(q$S,q$_){var q$a=q$S,q$R=q$_;return q$R[0]=q$a.a,q$R[1]=q$a.b,q$R[2]=q$J.EMPTYMAT4_ARRAY[2],q$R[3]=q$J.EMPTYMAT4_ARRAY[3],q$R[4]=q$a.c,q$R[5]=q$a.d,q$R[6]=q$J.EMPTYMAT4_ARRAY[6],q$R[7]=q$J.EMPTYMAT4_ARRAY[7],q$R[8]=q$J.EMPTYMAT4_ARRAY[8],q$R[9]=q$J.EMPTYMAT4_ARRAY[9],q$R[10]=q$J.EMPTYMAT4_ARRAY[10],q$R[11]=q$J.EMPTYMAT4_ARRAY[11],q$R[12]=q$a.tx,q$R[13]=q$a.ty,q$R[14]=q$J.EMPTYMAT4_ARRAY[14],q$R[15]=q$J.EMPTYMAT4_ARRAY[15],q$_},q$J.restoreTempArray=function(){q$J.TEMPMAT4_ARRAY[0]=1,q$J.TEMPMAT4_ARRAY[1]=0,q$J.TEMPMAT4_ARRAY[4]=0,q$J.TEMPMAT4_ARRAY[5]=1,q$J.TEMPMAT4_ARRAY[12]=0,q$J.TEMPMAT4_ARRAY[13]=0},q$J.clear=function(){q$J.worldScissorTest=!1,q$J.worldShaderDefines=null,q$J.worldFilters=null,q$J.worldAlpha=1,q$J.worldClipRect.x=q$J.worldClipRect.y=0,q$J.worldClipRect.width=q$J.width,q$J.worldClipRect.height=q$J.height,q$J.curRenderTarget=null},q$J._MAXSIZE=99999999,q$J.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],q$J.worldMatrix4=q$J.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],q$J.worldAlpha=1,q$J.worldScissorTest=!1,q$J.worldFilters=null,q$J.worldShaderDefines=null,q$J.curRenderTarget=null,q$J.width=0,q$J.height=0,q$W(q$J,["worldMatrix",function(){return this.worldMatrix=new q$n},"worldClipRect",function(){return this.worldClipRect=new q$B(0,0,99999999,99999999)}]),q$J}(),q$DS=function(){var q$T,q$a;function q$D(q$S,q$_,q$a,q$R,q$J){var q$V=this;function q$W(q$S){var q$_=[],q$a=new q$T(q$_);return q$V._compileToTree(q$a,q$S.split("\n"),0,q$_,q$J),q$a}var q$k=q$G.now();this._VS=q$W(q$_),this._PS=q$W(q$a),this._nameMap=q$R,2<q$G.now()-q$k&&console.log("ShaderCompile use time:"+(q$G.now()-q$k)+"  size:"+q$_.length+"/"+q$a.length)}q$C(q$D,"laya.webgl.utils.ShaderCompile");var q$S=q$D.prototype;return q$S._compileToTree=function(q$S,q$_,q$a,q$R,q$J){var q$V,q$W,q$k,q$z,q$b,q$H,q$L,q$C=0,q$G=0,q$t=0,q$o=0;for(q$G=q$a;q$G<q$_.length;q$G++)if(!((q$k=q$_[q$G]).length<1)&&0!==(q$C=q$k.indexOf("//"))){if(0<=q$C&&(q$k=q$k.substr(0,q$C)),q$V=q$L||new q$T(q$R),q$L=null,q$V.text=q$k,q$V.noCompile=!0,0<=(q$C=q$k.indexOf("#"))){for(q$z="#",q$o=q$C+1,q$t=q$k.length;q$o<q$t;q$o++){var q$$=q$k.charAt(q$o);if(" "===q$$||"\t"===q$$||"\r"===q$$||"\n"===q$$||"?"===q$$)break;q$z+=q$$}switch(q$V.name=q$z){case"#ifdef":case"#ifndef":if(q$V.src=q$k,q$V.noCompile=null!=q$k.match(/[!&|()=<>]/),q$V.noCompile?console.log("function():Boolean{return "+q$k.substr(q$C+q$V.name.length)+"}"):(q$H=q$k.replace(/^\s*/,"").split(/\s+/),q$V.setCondition(q$H[1],"#ifdef"===q$z?1:2),q$V.text="//"+q$V.text),q$V.setParent(q$S),q$S=q$V,q$J)for(q$H=q$k.substr(q$o).split(q$D._splitToWordExps3),q$o=0;q$o<q$H.length;q$o++)(q$k=q$H[q$o]).length&&(q$J[q$k]=!0);continue;case"#if":if(q$V.src=q$k,q$V.noCompile=!0,q$V.setParent(q$S),q$S=q$V,q$J)for(q$H=q$k.substr(q$o).split(q$D._splitToWordExps3),q$o=0;q$o<q$H.length;q$o++)(q$k=q$H[q$o]).length&&"defined"!=q$k&&(q$J[q$k]=!0);continue;case"#else":q$V.src=q$k,q$W=(q$S=q$S.parent).childs[q$S.childs.length-1],q$V.noCompile=q$W.noCompile,q$V.noCompile||(q$V.condition=q$W.condition,q$V.conditionType=1==q$W.conditionType?2:1,q$V.text="//"+q$V.text+" "+q$W.text+" "+q$V.conditionType),q$V.setParent(q$S),q$S=q$V;continue;case"#endif":q$W=(q$S=q$S.parent).childs[q$S.childs.length-1],q$V.noCompile=q$W.noCompile,q$V.noCompile||(q$V.text="//"+q$V.text),q$V.setParent(q$S);continue;case"#include":q$H=q$D.splitToWords(q$k,null);var q$F=q$D.includes[q$H[1]];if(!q$F)throw"ShaderCompile error no this include file:"+q$H[1];if((q$C=q$H[0].indexOf("?"))<0){q$V.setParent(q$S),q$k=q$F.getWith("with"==q$H[2]?q$H[3]:null),this._compileToTree(q$V,q$k.split("\n"),0,q$R,q$J),q$V.text="";continue}q$V.setCondition(q$H[0].substr(q$C+1),1),q$V.text=q$F.getWith("with"==q$H[2]?q$H[3]:null);break;case"#import":q$b=(q$H=q$D.splitToWords(q$k,null))[1],q$R.push({node:q$V,file:q$D.includes[q$b],ofs:q$V.text.length});continue}}else{if((q$W=q$S.childs[q$S.childs.length-1])&&!q$W.name){0<q$R.length&&q$D.splitToWords(q$k,q$W),q$L=q$V,q$W.text+="\n"+q$k;continue}0<q$R.length&&q$D.splitToWords(q$k,q$V)}q$V.setParent(q$S)}},q$S.createShader=function(q$S,q$_,q$a){var q$R={},q$J="";if(q$S)for(var q$V in q$S)q$J+="#define "+q$V+"\n",q$R[q$V]=!0;var q$W=this._VS.toscript(q$R,[]),q$k=this._PS.toscript(q$R,[]);return(q$a||q$yS.create)(q$J+q$W.join("\n"),q$J+q$k.join("\n"),q$_,this._nameMap)},q$D._parseOne=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W={type:q$D.shaderParamsMap[q$a[q$R+1]],name:q$a[q$R+2],size:isNaN(parseInt(q$a[q$R+3]))?1:parseInt(q$a[q$R+3])};return q$V&&("attribute"==q$J?q$S.push(q$W):q$_.push(q$W)),":"==q$a[q$R+3]&&(q$W.type=q$a[q$R+4],q$R+=2),q$R+=2},q$D.addInclude=function(q$S,q$_){if(!q$_||0===q$_.length)throw new Error("add shader include file err:"+q$S);if(q$D.includes[q$S])throw new Error("add shader include file err, has add:"+q$S);q$D.includes[q$S]=new q$a(q$_)},q$D.preGetParams=function(q$S,q$_){var q$a=[q$S,q$_],q$R={},q$J=[],q$V=[],q$W={},q$k=[];q$R.attributes=q$J,q$R.uniforms=q$V,q$R.defines=q$W;for(var q$z=0,q$b=0,q$H=0;q$H<2;q$H++){q$a[q$H]=q$a[q$H].replace(q$D._removeAnnotation,"");var q$L,q$C=q$a[q$H].match(q$D._reg);for(q$z=0,q$b=q$C.length;q$z<q$b;q$z++){var q$G=q$C[q$z];if("attribute"==q$G||"uniform"==q$G)q$z=q$D._parseOne(q$J,q$V,q$C,q$z,q$G,!0);else{if("#define"==q$G){q$k[q$G=q$C[++q$z]]=1;continue}if("#ifdef"==q$G){q$W[q$L=q$C[++q$z]]=q$W[q$L]||[];for(q$z++;q$z<q$b;q$z++)if("attribute"==(q$G=q$C[q$z])||"uniform"==q$G)q$z=q$D._parseOne(q$J,q$V,q$C,q$z,q$G,q$k[q$L]);else if("#else"==q$G)for(q$z++;q$z<q$b;q$z++)if("attribute"==(q$G=q$C[q$z])||"uniform"==q$G)q$z=q$D._parseOne(q$J,q$V,q$C,q$z,q$G,!q$k[q$L]);else if("#endif"==q$G)break}}}}return q$R},q$D.splitToWords=function(q$S,q$_){for(var q$a,q$R,q$J=[],q$V=-1,q$W=0,q$k=q$S.length;q$W<q$k;q$W++)if(q$a=q$S.charAt(q$W),0<=" \t=+-*/&%!<>()'\",;".indexOf(q$a)){if(0<=q$V&&1<q$W-q$V&&(q$R=q$S.substr(q$V,q$W-q$V),q$J.push(q$R)),'"'==q$a||"'"==q$a){var q$z=q$S.indexOf(q$a,q$W+1);if(q$z<0)throw"Sharder err:"+q$S;q$J.push(q$S.substr(q$W+1,q$z-q$W-1)),q$W=q$z,q$V=-1;continue}"("==q$a&&q$_&&0<q$J.length&&(q$R=q$J[q$J.length-1]+";","vec4;main;".indexOf(q$R)<0&&(q$_.useFuns+=q$R)),q$V=-1}else q$V<0&&(q$V=q$W);return q$V<q$k&&1<q$k-q$V&&(q$R=q$S.substr(q$V,q$k-q$V),q$J.push(q$R)),q$J},q$D.IFDEF_NO=0,q$D.IFDEF_YES=1,q$D.IFDEF_ELSE=2,q$D.IFDEF_PARENT=3,q$D._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),q$D._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),q$D._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),q$D.includes={},q$W(q$D,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),q$D.__init$=function(){q$T=function(){function q$a(q$S){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=q$S}q$C(q$a,"");var q$S=q$a.prototype;return q$S.setParent=function(q$S){q$S.childs.push(this),this.z=q$S.z+1,this.parent=q$S},q$S.setCondition=function(q$S,q$_){q$S&&(this.conditionType=q$_,q$S=q$S.replace(/(\s*$)/g,""),this.condition=function(){return this[q$S]},this.condition.__condition=q$S)},q$S.toscript=function(q$S,q$_){return this._toscript(q$S,q$_,++q$a.__id)},q$S._toscript=function(q$R,q$J,q$V){if(this.childs.length<1&&!this.text)return q$J;q$J.length;if(this.condition){var q$S=!!this.condition.call(q$R);if(2===this.conditionType&&(q$S=!q$S),!q$S)return q$J}if(this.text&&q$J.push(this.text),0<this.childs.length&&this.childs.forEach(function(q$S,q$_,q$a){q$S._toscript(q$R,q$J,q$V)}),0<this.includefiles.length&&0<this.useFuns.length)for(var q$_,q$a=0,q$W=this.includefiles.length;q$a<q$W;q$a++)this.includefiles[q$a].curUseID!=q$V&&0<(q$_=this.includefiles[q$a].file.getFunsScript(this.useFuns)).length&&(this.includefiles[q$a].curUseID=q$V,q$J[0]=q$_+q$J[0]);return q$J},q$a.__id=1,q$a}(),q$a=function(){function q$S(q$S){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=q$S;for(var q$_=0,q$a=0,q$R=0;!((q$_=q$S.indexOf("#begin",q$_))<0);){for(q$R=q$_+5;!((q$R=q$S.indexOf("#end",q$R))<0)&&"i"===q$S.charAt(q$R+4);)q$R+=5;if(q$R<0)throw"add include err,no #end:"+q$S;q$a=q$S.indexOf("\n",q$_);var q$J=q$D.splitToWords(q$S.substr(q$_,q$a-q$_),null);"code"==q$J[1]?this.codes[q$J[2]]=q$S.substr(q$a+1,q$R-q$a-1):"function"==q$J[1]&&(q$a=q$S.indexOf("function",q$_),q$a+="function".length,this.funs[q$J[3]]=q$S.substr(q$a+1,q$R-q$a-1),this.funnames+=q$J[3]+";"),q$_=q$R+1}}q$C(q$S,"");var q$_=q$S.prototype;return q$_.getWith=function(q$S){var q$_=q$S?this.codes[q$S]:this.script;if(!q$_)throw"get with error:"+q$S;return q$_},q$_.getFunsScript=function(q$S){var q$_="";for(var q$a in this.funs)0<=q$S.indexOf(q$a+";")&&(q$_+=this.funs[q$a]);return q$_},q$S}()},q$D}(),q$jS=function(){function q$W(){}return q$C(q$W,"laya.webgl.WebGL"),q$W._uint8ArraySlice=function(){for(var q$S=this.length,q$_=new Uint8Array(this.length),q$a=0;q$a<q$S;q$a++)q$_[q$a]=this[q$a];return q$_},q$W._float32ArraySlice=function(){for(var q$S=this.length,q$_=new Float32Array(this.length),q$a=0;q$a<q$S;q$a++)q$_[q$a]=this[q$a];return q$_},q$W._uint16ArraySlice=function(q$S){var q$_,q$a=arguments,q$R=0,q$J=0;if(0===q$a.length)for(q$R=this.length,q$_=new Uint16Array(q$R),q$J=0;q$J<q$R;q$J++)q$_[q$J]=this[q$J];else if(2===q$a.length){var q$V=q$a[0],q$W=q$a[1];if(q$V<q$W)for(q$R=q$W-q$V,q$_=new Uint16Array(q$R),q$J=q$V;q$J<q$W;q$J++)q$_[q$J-q$V]=this[q$J];else q$_=new Uint16Array(0)}return q$_},q$W.expandContext=function(){var q$S=q$J.prototype,q$_=CanvasRenderingContext2D.prototype;q$_.fillTrangles=q$S.fillTrangles,q$ES.__int__(null),q$_.setIBVB=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){void 0===q$z&&(q$z=0),void 0===q$b&&(q$b=0),null===q$a&&(this._ib=this._ib||q$vS.QuadrangleIB,q$a=this._ib,q$$S.expandIBQuadrangle(q$a,q$R._byteLength/64+8)),this._setIBVB(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b)},q$_.fillTrangles=function(q$S,q$_,q$a,q$R,q$J){this._curMat=this._curMat||q$n.create(),this._vb=this._vb||q$dS.create(),this._ib||(this._ib=q$vS.create(),q$$S.fillIBQuadrangle(this._ib,q$W/4));var q$V=this._vb,q$W=q$R.length>>4;q$$S.fillTranglesVB(q$V,q$_,q$a,q$R,q$J||this._curMat,0,0),q$$S.expandIBQuadrangle(this._ib,q$V._byteLength/64+8);var q$k=new q$NS(1,0);q$k.textureHost=q$S;var q$z=new q$wS("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");q$V._vertType=3,this._setIBVB(q$_,q$a,this._ib,q$V,6*q$W,q$J,q$z,q$k,0,0)}},q$W.enable=function(){if(q$G.__init__(),q$F.isConchApp&&!q$F.isConchWebGL)return q$Q.skinAniSprite=function(){return new q$SS},q$W.expandContext(),!1;if(q$Q.getWebGLContext=function(q$S){for(var q$_,q$a=["webgl","experimental-webgl","webkit-3d","moz-webgl"],q$R=0;q$R<q$a.length;q$R++){try{q$_=q$S.getContext(q$a[q$R],{stencil:q$q.isStencil,alpha:q$q.isAlpha,antialias:q$q.isAntialias,premultipliedAlpha:q$q.premultipliedAlpha,preserveDrawingBuffer:q$q.preserveDrawingBuffer})}catch(q$S){}if(q$_)return q$_}return null},null==(q$W.mainContext=q$W.mainContext||q$Q.getWebGLContext(q$F._mainCanvas)))return!1;if(q$F.isWebGL)return!0;q$o.create=function(q$S,q$_){return new q$S_(q$S,q$_)},q$$.create=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){return new q$cS(q$S,q$_,q$a,q$R,q$J,q$V,q$W)},q$F.WebGL=q$W,q$F.isWebGL=!0,q$GS.__init__(),q$Q.createRenderSprite=function(q$S,q$_){return new q$nS(q$S,q$_)},q$Q.createWebGLContext2D=function(q$S){return new q$qS(q$S)},q$Q.changeWebGLSize=function(q$S,q$_){laya.webgl.WebGL.onStageResize(q$S,q$_)},q$Q.createGraphics=function(){return new q$mS};var q$S=q$Q.createFilterAction;return q$Q.createFilterAction=q$S||function(q$S){return new q$lS},q$Q.clear=function(q$S){q$TS.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var q$_=q$F.context.ctx,q$a=0==q$_._submits._length||q$q.preserveDrawingBuffer?q$t.create(q$S)._color:q$A._wgColor;q$a&&q$_.clearBG(q$a[0],q$a[1],q$a[2],q$a[3]),q$TS.clear()},q$Q.addToAtlas=function(q$S,q$_){void 0===q$_&&(q$_=!1);var q$a=q$S.bitmap;q$F.optimizeTextureMemory(q$S.url,q$S)?q$m.__typeof(q$a,"laya.webgl.resource.IMergeAtlasBitmap")&&q$a.allowMerageInAtlas&&q$a.on("recovered",q$S,q$S.addTextureToAtlas):q$a.enableMerageInAtlas=!1},q$Q.isAtlas=function(q$S){return q$S instanceof laya.webgl.atlas.AtlasWebGLCanvas},q$s._enable(),q$Q.beginFlush=function(){for(var q$S=q$s.instance,q$_=q$S.getAtlaserCount(),q$a=0;q$a<q$_;q$a++){var q$R=q$S.getAtlaserByIndex(q$a).texture;q$R._flashCacheImageNeedFlush&&q$Q.flashFlushImage(q$R)}},q$Q.drawToCanvas=function(q$S,q$_,q$a,q$R,q$J,q$V){(q$a<=0||q$R<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),q$a|=0,q$R|=0,q$J|=0,q$V|=0;var q$W=q$rS.create(q$a,q$R,6408,5121,0,!1);q$W.start(),q$W.clear(0,0,0,0),q$F.context.clear(),q$T.renders[q$_]._fun(q$S,q$F.context,q$J,q$TS.height-q$R+q$V),q$F.context.flush(),q$W.end();var q$k=q$W.getData(0,0,q$a,q$R);if(q$W.recycle(),q$k.byteLength==q$a*q$R*4){var q$z=new q$iS;q$z._canvas=q$G.createElement("canvas"),q$z.size(q$a,q$R);var q$b=q$z._canvas.getContext("2d");q$G.canvas.size(q$a,q$R);var q$H=q$G.context,q$L=q$H.createImageData(q$a,q$R);return q$L.data.set(new Uint8ClampedArray(q$k.buffer)),q$z._imgData=q$L,q$H.putImageData(q$L,0,0),q$b.save(),q$b.translate(0,q$R),q$b.scale(1,-1),q$b.drawImage(q$G.canvas.source,0,0),q$b.restore(),q$z}console.log("drawToCanvas error: w:"+q$a+",h:"+q$R+",datalen:"+q$k.byteLength)},q$Q.createFilterAction=function(q$S){var q$_;switch(q$S){case 32:q$_=new q$lS}return q$_},q$Q.addTextureToAtlas=function(q$S){q$S._uvID++,q$s._atlasRestore++,q$S.bitmap.enableMerageInAtlas&&q$s.instance.addToAtlas(q$S)},q$Q.getTexturePixels=function(q$S,q$_,q$a,q$R,q$J){q$F.context.ctx.clear();var q$V=new q$I;q$V.graphics.drawTexture(q$S,-q$_,-q$a);var q$W=q$rS.create(q$R,q$J);q$W.start(),q$W.clear(0,0,0,0),q$V.render(q$F.context,0,0),q$F.context.ctx.flush(),q$W.end();for(var q$k=q$W.getData(0,0,q$R,q$J),q$z=[],q$b=0,q$H=q$J-1;0<=q$H;q$H--)for(var q$L=0;q$L<q$R;q$L++)q$b=4*(q$H*q$R+q$L),q$z.push(q$k[q$b]),q$z.push(q$k[q$b+1]),q$z.push(q$k[q$b+2]),q$z.push(q$k[q$b+3]);return q$z},q$Q.skinAniSprite=function(){return new q$SS},q$b.create=function(q$S,q$_){var q$a=new q$iS;return q$a._imgData=q$_,q$a.flipY=!1,q$a},q$N._filterStart=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$S.getValue("bounds"),q$W=q$rS.create(q$V.width,q$V.height);if(q$W.start(),q$W.clear(0,0,0,0),q$S.addValue("src",q$W),q$S.addValue("ScissorTest",q$TS.worldScissorTest),q$TS.worldScissorTest){var q$k=new q$B;q$k.copyFrom(q$a.ctx._clipRect),q$S.addValue("clipRect",q$k),q$TS.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},q$N._filterEnd=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$S.getValue("bounds");q$S.getValue("src").end();var q$W=q$rS.create(q$V.width,q$V.height);q$W.start(),q$W.clear(0,0,0,0),q$S.addValue("out",q$W),q$_._set$P("_filterCache",q$W),q$_._set$P("_isHaveGlowFilter",q$S.getValue("_isHaveGlowFilter"))},q$N._EndTarget=function(q$S,q$_){if(q$S.getValue("src").recycle(),q$S.getValue("out").end(),q$S.getValue("ScissorTest")){q$TS.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),q$_.ctx.save();var q$a=q$S.getValue("clipRect");q$_.ctx.clipRect(q$a.x,q$a.y,q$a.width,q$a.height)}},q$N._useSrc=function(q$S){var q$_=q$S.getValue("out");q$_.end(),(q$_=q$S.getValue("src")).start(),q$_.clear(0,0,0,0)},q$N._endSrc=function(q$S){q$S.getValue("src").end()},q$N._useOut=function(q$S){var q$_=q$S.getValue("src");q$_.end(),(q$_=q$S.getValue("out")).start(),q$_.clear(0,0,0,0)},q$N._endOut=function(q$S){q$S.getValue("out").end()},q$N._recycleScope=function(q$S){q$S.recycle()},q$N._filter=function(q$S,q$_,q$a,q$R){var q$J=this._next;if(q$J){var q$V,q$W,q$k=q$S.filters,q$z=q$k.length;if(1==q$z&&32==q$k[0].type)return q$_.ctx.save(),q$_.ctx.setFilters([q$k[0]]),q$J._fun.call(q$J,q$S,q$_,q$a,q$R),void q$_.ctx.restore();var q$b=q$kS.create(),q$H=q$l.TEMP,q$L=q$_.ctx._getTransformMatrix(),q$C=q$n.create();q$L.copyTo(q$C);var q$G=0,q$t=0,q$o=!1,q$$=q$S._$P._filterCache?q$S._$P._filterCache:null;if(!q$$||q$S._repaint){q$o=q$S._isHaveGlowFilter(),q$b.addValue("_isHaveGlowFilter",q$o),q$o&&(q$G=50,q$t=25),(q$W=new q$B).copyFrom(q$S.getSelfBounds()),q$W.x+=q$S.x,q$W.y+=q$S.y,q$W.x-=q$S.pivotX+4,q$W.y-=q$S.pivotY+4;var q$F=q$W.x,q$T=q$W.y;if(q$W.width+=q$G+8,q$W.height+=q$G+8,q$H.x=q$W.x*q$C.a+q$W.y*q$C.c,q$H.y=q$W.y*q$C.d+q$W.x*q$C.b,q$W.x=q$H.x,q$W.y=q$H.y,q$H.x=q$W.width*q$C.a+q$W.height*q$C.c,q$H.y=q$W.height*q$C.d+q$W.width*q$C.b,q$W.width=q$H.x,q$W.height=q$H.y,q$W.width<=0||q$W.height<=0)return;q$$&&q$$.recycle(),q$b.addValue("bounds",q$W);var q$D=q$WS.create([q$b,q$S,q$_,0,0],q$N._filterStart);q$_.addRenderObject(q$D),q$_.ctx._renderKey=0,q$_.ctx._shader2D.glTexture=null;var q$j=q$S.x-q$F+q$t,q$Q=q$S.y-q$T+q$t;q$J._fun.call(q$J,q$S,q$_,q$j,q$Q),q$D=q$WS.create([q$b,q$S,q$_,0,0],q$N._filterEnd),q$_.addRenderObject(q$D);for(var q$m=0;q$m<q$z;q$m++){0!=q$m&&(q$D=q$WS.create([q$b],q$N._useSrc),q$_.addRenderObject(q$D),q$V=q$NS.create(1,0),q$n.TEMP.identity(),q$_.ctx.drawTarget(q$b,0,0,q$W.width,q$W.height,q$n.TEMP,"out",q$V,null,q$f.TOINT.overlay),q$D=q$WS.create([q$b],q$N._useOut),q$_.addRenderObject(q$D)),q$k[q$m].action.apply3d(q$b,q$S,q$_,0,0)}q$D=q$WS.create([q$b,q$_],q$N._EndTarget),q$_.addRenderObject(q$D)}else{if((q$o=!!q$S._$P._isHaveGlowFilter&&q$S._$P._isHaveGlowFilter)&&(q$G=50,q$t=25),(q$W=q$S.getBounds()).width<=0||q$W.height<=0)return;q$W.width+=q$G,q$W.height+=q$G,q$H.x=q$W.x*q$C.a+q$W.y*q$C.c,q$H.y=q$W.y*q$C.d+q$W.x*q$C.b,q$W.x=q$H.x,q$W.y=q$H.y,q$H.x=q$W.width*q$C.a+q$W.height*q$C.c,q$H.y=q$W.height*q$C.d+q$W.width*q$C.b,q$W.width=q$H.x,q$W.height=q$H.y,q$b.addValue("out",q$$)}q$a=q$a-q$t-q$S.x,q$R=q$R-q$t-q$S.y,q$H.setTo(q$a,q$R),q$C.transformPoint(q$H),q$a=q$H.x+q$W.x,q$R=q$H.y+q$W.y,q$V=q$NS.create(1,0),q$n.TEMP.identity(),q$_.ctx.drawTarget(q$b,q$a,q$R,q$W.width,q$W.height,q$n.TEMP,"out",q$V,null,q$f.TOINT.overlay),q$D=q$WS.create([q$b],q$N._recycleScope),q$_.addRenderObject(q$D),q$C.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=q$W._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=q$W._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=q$W._uint8ArraySlice),!0},q$W.onStageResize=function(q$S,q$_){null!=q$W.mainContext&&(q$W.mainContext.viewport(0,0,q$S,q$_),q$TS.width=q$S,q$TS.height=q$_)},q$W.onInvalidGLRes=function(){q$s.instance.freeAll(),q$j.releaseContentManagers(!0),q$W.doNodeRepaint(q$m.stage),q$W.mainContext.viewport(0,0,q$TS.width,q$TS.height),q$m.stage.event("devicelost")},q$W.doNodeRepaint=function(q$S){0==q$S.numChildren&&q$S.repaint();for(var q$_=0;q$_<q$S.numChildren;q$_++)q$W.doNodeRepaint(q$S.getChildAt(q$_))},q$W.init=function(q$S,q$_,q$a){q$W.mainCanvas=q$S,q$b._createContext=function(q$S){return new q$qS(q$S)},q$iS._createContext=function(q$S){return new q$qS(q$S)};var q$R=laya.webgl.WebGL.mainContext;if(null!=q$R.getShaderPrecisionFormat){var q$J=q$R.getShaderPrecisionFormat(35633,36338),q$V=q$R.getShaderPrecisionFormat(35632,36338);q$W.shaderHighPrecision=!(!q$J.precision||!q$V.precision)}else q$W.shaderHighPrecision=!1;if(q$W.compressAstc=q$R.getExtension("WEBGL_compressed_texture_astc"),q$W.compressAtc=q$R.getExtension("WEBGL_compressed_texture_atc"),q$W.compressEtc=q$R.getExtension("WEBGL_compressed_texture_etc"),q$W.compressEtc1=q$R.getExtension("WEBGL_compressed_texture_etc1"),q$W.compressPvrtc=q$R.getExtension("WEBGL_compressed_texture_pvrtc"),q$W.compressS3tc=q$R.getExtension("WEBGL_compressed_texture_s3tc"),q$W.compressS3tc_srgb=q$R.getExtension("WEBGL_compressed_texture_s3tc_srgb"),q$W.compressAstc=q$W.compressAstc?q$W.compressAstc:{},q$W.compressAtc=q$W.compressAtc?q$W.compressAtc:{},q$W.compressEtc=q$W.compressEtc?q$W.compressEtc:{},q$W.compressEtc1=q$W.compressEtc1?q$W.compressEtc1:{},q$W.compressPvrtc=q$W.compressPvrtc?q$W.compressPvrtc:{},q$W.compressS3tc=q$W.compressS3tc?q$W.compressS3tc:{},q$W.compressS3tc_srgb=q$W.compressS3tc_srgb?q$W.compressS3tc_srgb:{},q$R.deleteTexture1=q$R.deleteTexture,q$R.deleteTexture=function(q$S){q$S==q$QS.curBindTexValue&&(q$QS.curBindTexValue=null),q$R.deleteTexture1(q$S)},q$W.onStageResize(q$_,q$a),null==q$W.mainContext)throw new Error("webGL getContext err!");q$u.__init__(),q$s.__init__(),q$IS.__init__(),q$VS.__init__(),q$qS.__init__(),q$NS.__init__(),q$v.__init__(),q$ES.__int__(q$R),q$f._init_(q$R),q$F.isConchApp&&conch.setOnInvalidGLRes(q$W.onInvalidGLRes)},q$W.mainCanvas=null,q$W.antialias=!0,q$W.shaderHighPrecision=!1,q$W._bg_null=[0,0,0,0],q$W}(),q$QS=function(){function q$R(){}return q$C(q$R,"laya.webgl.WebGLContext"),q$R.UseProgram=function(q$S){return q$R._useProgram!==q$S&&(q$jS.mainContext.useProgram(q$S),q$R._useProgram=q$S,!0)},q$R.setDepthTest=function(q$S,q$_){q$_!==q$R._depthTest&&((q$R._depthTest=q$_)?q$S.enable(2929):q$S.disable(2929))},q$R.setDepthMask=function(q$S,q$_){q$_!==q$R._depthMask&&(q$R._depthMask=q$_,q$S.depthMask(q$_))},q$R.setDepthFunc=function(q$S,q$_){q$_!==q$R._depthFunc&&(q$R._depthFunc=q$_,q$S.depthFunc(q$_))},q$R.setBlend=function(q$S,q$_){q$_!==q$R._blend&&((q$R._blend=q$_)?q$S.enable(3042):q$S.disable(3042))},q$R.setBlendFunc=function(q$S,q$_,q$a){(q$_!==q$R._sFactor||q$a!==q$R._dFactor)&&(q$R._sFactor=q$_,q$R._dFactor=q$a,q$S.blendFunc(q$_,q$a))},q$R.setCullFace=function(q$S,q$_){q$_!==q$R._cullFace&&((q$R._cullFace=q$_)?q$S.enable(2884):q$S.disable(2884))},q$R.setFrontFace=function(q$S,q$_){q$_!==q$R._frontFace&&(q$R._frontFace=q$_,q$S.frontFace(q$_))},q$R.bindTexture=function(q$S,q$_,q$a){q$S.bindTexture(q$_,q$a),q$R.curBindTexTarget=q$_,q$R.curBindTexValue=q$a},q$R.DEPTH_BUFFER_BIT=256,q$R.STENCIL_BUFFER_BIT=1024,q$R.COLOR_BUFFER_BIT=16384,q$R.POINTS=0,q$R.LINES=1,q$R.LINE_LOOP=2,q$R.LINE_STRIP=3,q$R.TRIANGLES=4,q$R.TRIANGLE_STRIP=5,q$R.TRIANGLE_FAN=6,q$R.ZERO=0,q$R.ONE=1,q$R.SRC_COLOR=768,q$R.ONE_MINUS_SRC_COLOR=769,q$R.SRC_ALPHA=770,q$R.ONE_MINUS_SRC_ALPHA=771,q$R.DST_ALPHA=772,q$R.ONE_MINUS_DST_ALPHA=773,q$R.DST_COLOR=774,q$R.ONE_MINUS_DST_COLOR=775,q$R.SRC_ALPHA_SATURATE=776,q$R.FUNC_ADD=32774,q$R.BLEND_EQUATION=32777,q$R.BLEND_EQUATION_RGB=32777,q$R.BLEND_EQUATION_ALPHA=34877,q$R.FUNC_SUBTRACT=32778,q$R.FUNC_REVERSE_SUBTRACT=32779,q$R.BLEND_DST_RGB=32968,q$R.BLEND_SRC_RGB=32969,q$R.BLEND_DST_ALPHA=32970,q$R.BLEND_SRC_ALPHA=32971,q$R.CONSTANT_COLOR=32769,q$R.ONE_MINUS_CONSTANT_COLOR=32770,q$R.CONSTANT_ALPHA=32771,q$R.ONE_MINUS_CONSTANT_ALPHA=32772,q$R.BLEND_COLOR=32773,q$R.ARRAY_BUFFER=34962,q$R.ELEMENT_ARRAY_BUFFER=34963,q$R.ARRAY_BUFFER_BINDING=34964,q$R.ELEMENT_ARRAY_BUFFER_BINDING=34965,q$R.STREAM_DRAW=35040,q$R.STATIC_DRAW=35044,q$R.DYNAMIC_DRAW=35048,q$R.BUFFER_SIZE=34660,q$R.BUFFER_USAGE=34661,q$R.CURRENT_VERTEX_ATTRIB=34342,q$R.FRONT=1028,q$R.BACK=1029,q$R.CULL_FACE=2884,q$R.FRONT_AND_BACK=1032,q$R.BLEND=3042,q$R.DITHER=3024,q$R.STENCIL_TEST=2960,q$R.DEPTH_TEST=2929,q$R.SCISSOR_TEST=3089,q$R.POLYGON_OFFSET_FILL=32823,q$R.SAMPLE_ALPHA_TO_COVERAGE=32926,q$R.SAMPLE_COVERAGE=32928,q$R.NO_ERROR=0,q$R.INVALID_ENUM=1280,q$R.INVALID_VALUE=1281,q$R.INVALID_OPERATION=1282,q$R.OUT_OF_MEMORY=1285,q$R.CW=2304,q$R.CCW=2305,q$R.LINE_WIDTH=2849,q$R.ALIASED_POINT_SIZE_RANGE=33901,q$R.ALIASED_LINE_WIDTH_RANGE=33902,q$R.CULL_FACE_MODE=2885,q$R.FRONT_FACE=2886,q$R.DEPTH_RANGE=2928,q$R.DEPTH_WRITEMASK=2930,q$R.DEPTH_CLEAR_VALUE=2931,q$R.DEPTH_FUNC=2932,q$R.STENCIL_CLEAR_VALUE=2961,q$R.STENCIL_FUNC=2962,q$R.STENCIL_FAIL=2964,q$R.STENCIL_PASS_DEPTH_FAIL=2965,q$R.STENCIL_PASS_DEPTH_PASS=2966,q$R.STENCIL_REF=2967,q$R.STENCIL_VALUE_MASK=2963,q$R.STENCIL_WRITEMASK=2968,q$R.STENCIL_BACK_FUNC=34816,q$R.STENCIL_BACK_FAIL=34817,q$R.STENCIL_BACK_PASS_DEPTH_FAIL=34818,q$R.STENCIL_BACK_PASS_DEPTH_PASS=34819,q$R.STENCIL_BACK_REF=36003,q$R.STENCIL_BACK_VALUE_MASK=36004,q$R.STENCIL_BACK_WRITEMASK=36005,q$R.VIEWPORT=2978,q$R.SCISSOR_BOX=3088,q$R.COLOR_CLEAR_VALUE=3106,q$R.COLOR_WRITEMASK=3107,q$R.UNPACK_ALIGNMENT=3317,q$R.PACK_ALIGNMENT=3333,q$R.MAX_TEXTURE_SIZE=3379,q$R.MAX_VIEWPORT_DIMS=3386,q$R.SUBPIXEL_BITS=3408,q$R.RED_BITS=3410,q$R.GREEN_BITS=3411,q$R.BLUE_BITS=3412,q$R.ALPHA_BITS=3413,q$R.DEPTH_BITS=3414,q$R.STENCIL_BITS=3415,q$R.POLYGON_OFFSET_UNITS=10752,q$R.POLYGON_OFFSET_FACTOR=32824,q$R.TEXTURE_BINDING_2D=32873,q$R.SAMPLE_BUFFERS=32936,q$R.SAMPLES=32937,q$R.SAMPLE_COVERAGE_VALUE=32938,q$R.SAMPLE_COVERAGE_INVERT=32939,q$R.NUM_COMPRESSED_TEXTURE_FORMATS=34466,q$R.COMPRESSED_TEXTURE_FORMATS=34467,q$R.DONT_CARE=4352,q$R.FASTEST=4353,q$R.NICEST=4354,q$R.GENERATE_MIPMAP_HINT=33170,q$R.BYTE=5120,q$R.UNSIGNED_BYTE=5121,q$R.SHORT=5122,q$R.UNSIGNED_SHORT=5123,q$R.INT=5124,q$R.UNSIGNED_INT=5125,q$R.FLOAT=5126,q$R.DEPTH_COMPONENT=6402,q$R.ALPHA=6406,q$R.RGB=6407,q$R.RGBA=6408,q$R.LUMINANCE=6409,q$R.LUMINANCE_ALPHA=6410,q$R.UNSIGNED_SHORT_4_4_4_4=32819,q$R.UNSIGNED_SHORT_5_5_5_1=32820,q$R.UNSIGNED_SHORT_5_6_5=33635,q$R.FRAGMENT_SHADER=35632,q$R.VERTEX_SHADER=35633,q$R.MAX_VERTEX_ATTRIBS=34921,q$R.MAX_VERTEX_UNIFORM_VECTORS=36347,q$R.MAX_VARYING_VECTORS=36348,q$R.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,q$R.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,q$R.MAX_TEXTURE_IMAGE_UNITS=34930,q$R.MAX_FRAGMENT_UNIFORM_VECTORS=36349,q$R.SHADER_TYPE=35663,q$R.DELETE_STATUS=35712,q$R.LINK_STATUS=35714,q$R.VALIDATE_STATUS=35715,q$R.ATTACHED_SHADERS=35717,q$R.ACTIVE_UNIFORMS=35718,q$R.ACTIVE_ATTRIBUTES=35721,q$R.SHADING_LANGUAGE_VERSION=35724,q$R.CURRENT_PROGRAM=35725,q$R.NEVER=512,q$R.LESS=513,q$R.EQUAL=514,q$R.LEQUAL=515,q$R.GREATER=516,q$R.NOTEQUAL=517,q$R.GEQUAL=518,q$R.ALWAYS=519,q$R.KEEP=7680,q$R.REPLACE=7681,q$R.INCR=7682,q$R.DECR=7683,q$R.INVERT=5386,q$R.INCR_WRAP=34055,q$R.DECR_WRAP=34056,q$R.VENDOR=7936,q$R.RENDERER=7937,q$R.VERSION=7938,q$R.NEAREST=9728,q$R.LINEAR=9729,q$R.NEAREST_MIPMAP_NEAREST=9984,q$R.LINEAR_MIPMAP_NEAREST=9985,q$R.NEAREST_MIPMAP_LINEAR=9986,q$R.LINEAR_MIPMAP_LINEAR=9987,q$R.TEXTURE_MAG_FILTER=10240,q$R.TEXTURE_MIN_FILTER=10241,q$R.TEXTURE_WRAP_S=10242,q$R.TEXTURE_WRAP_T=10243,q$R.TEXTURE_2D=3553,q$R.TEXTURE=5890,q$R.TEXTURE_CUBE_MAP=34067,q$R.TEXTURE_BINDING_CUBE_MAP=34068,q$R.TEXTURE_CUBE_MAP_POSITIVE_X=34069,q$R.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,q$R.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,q$R.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,q$R.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,q$R.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,q$R.MAX_CUBE_MAP_TEXTURE_SIZE=34076,q$R.TEXTURE0=33984,q$R.TEXTURE1=33985,q$R.TEXTURE2=33986,q$R.TEXTURE3=33987,q$R.TEXTURE4=33988,q$R.TEXTURE5=33989,q$R.TEXTURE6=33990,q$R.TEXTURE7=33991,q$R.TEXTURE8=33992,q$R.TEXTURE9=33993,q$R.TEXTURE10=33994,q$R.TEXTURE11=33995,q$R.TEXTURE12=33996,q$R.TEXTURE13=33997,q$R.TEXTURE14=33998,q$R.TEXTURE15=33999,q$R.TEXTURE16=34e3,q$R.TEXTURE17=34001,q$R.TEXTURE18=34002,q$R.TEXTURE19=34003,q$R.TEXTURE20=34004,q$R.TEXTURE21=34005,q$R.TEXTURE22=34006,q$R.TEXTURE23=34007,q$R.TEXTURE24=34008,q$R.TEXTURE25=34009,q$R.TEXTURE26=34010,q$R.TEXTURE27=34011,q$R.TEXTURE28=34012,q$R.TEXTURE29=34013,q$R.TEXTURE30=34014,q$R.TEXTURE31=34015,q$R.ACTIVE_TEXTURE=34016,q$R.REPEAT=10497,q$R.CLAMP_TO_EDGE=33071,q$R.MIRRORED_REPEAT=33648,q$R.FLOAT_VEC2=35664,q$R.FLOAT_VEC3=35665,q$R.FLOAT_VEC4=35666,q$R.INT_VEC2=35667,q$R.INT_VEC3=35668,q$R.INT_VEC4=35669,q$R.BOOL=35670,q$R.BOOL_VEC2=35671,q$R.BOOL_VEC3=35672,q$R.BOOL_VEC4=35673,q$R.FLOAT_MAT2=35674,q$R.FLOAT_MAT3=35675,q$R.FLOAT_MAT4=35676,q$R.SAMPLER_2D=35678,q$R.SAMPLER_CUBE=35680,q$R.VERTEX_ATTRIB_ARRAY_ENABLED=34338,q$R.VERTEX_ATTRIB_ARRAY_SIZE=34339,q$R.VERTEX_ATTRIB_ARRAY_STRIDE=34340,q$R.VERTEX_ATTRIB_ARRAY_TYPE=34341,q$R.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,q$R.VERTEX_ATTRIB_ARRAY_POINTER=34373,q$R.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,q$R.COMPILE_STATUS=35713,q$R.LOW_FLOAT=36336,q$R.MEDIUM_FLOAT=36337,q$R.HIGH_FLOAT=36338,q$R.LOW_INT=36339,q$R.MEDIUM_INT=36340,q$R.HIGH_INT=36341,q$R.FRAMEBUFFER=36160,q$R.RENDERBUFFER=36161,q$R.RGBA4=32854,q$R.RGB5_A1=32855,q$R.RGB565=36194,q$R.DEPTH_COMPONENT16=33189,q$R.STENCIL_INDEX=6401,q$R.STENCIL_INDEX8=36168,q$R.DEPTH_STENCIL=34041,q$R.RENDERBUFFER_WIDTH=36162,q$R.RENDERBUFFER_HEIGHT=36163,q$R.RENDERBUFFER_INTERNAL_FORMAT=36164,q$R.RENDERBUFFER_RED_SIZE=36176,q$R.RENDERBUFFER_GREEN_SIZE=36177,q$R.RENDERBUFFER_BLUE_SIZE=36178,q$R.RENDERBUFFER_ALPHA_SIZE=36179,q$R.RENDERBUFFER_DEPTH_SIZE=36180,q$R.RENDERBUFFER_STENCIL_SIZE=36181,q$R.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,q$R.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,q$R.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,q$R.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,q$R.COLOR_ATTACHMENT0=36064,q$R.DEPTH_ATTACHMENT=36096,q$R.STENCIL_ATTACHMENT=36128,q$R.DEPTH_STENCIL_ATTACHMENT=33306,q$R.NONE=0,q$R.FRAMEBUFFER_COMPLETE=36053,q$R.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,q$R.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,q$R.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,q$R.FRAMEBUFFER_UNSUPPORTED=36061,q$R.FRAMEBUFFER_BINDING=36006,q$R.RENDERBUFFER_BINDING=36007,q$R.MAX_RENDERBUFFER_SIZE=34024,q$R.INVALID_FRAMEBUFFER_OPERATION=1286,q$R.UNPACK_FLIP_Y_WEBGL=37440,q$R.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,q$R.CONTEXT_LOST_WEBGL=37442,q$R.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,q$R.BROWSER_DEFAULT_WEBGL=37444,q$R._useProgram=null,q$R._depthTest=!0,q$R._depthMask=!0,q$R._blend=!1,q$R._cullFace=!1,q$R.curBindTexTarget=null,q$R.curBindTexValue=null,q$W(q$R,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),q$R}(),q$mS=function(q$S){function q$_(){q$_.__super.call(this)}q$C(q$_,"laya.webgl.display.GraphicsGL",q$k);var q$a=q$_.prototype;return q$a.setShader=function(q$S){this._saveToCmd(q$F.context._setShader,[q$S])},q$a.setIBVB=function(q$S,q$_,q$a,q$R,q$J,q$V){this._saveToCmd(q$F.context._setIBVB,[q$S,q$_,q$a,q$R,q$J,q$V])},q$a.drawParticle=function(q$S,q$_,q$a){var q$R=q$Q.createParticleTemplate2D(q$a);q$R.x=q$S,q$R.y=q$_,this._saveToCmd(q$F.context._drawParticle,[q$R])},q$_}(),q$qS=function(q$S){var q$a;function q$x(q$S){this._x=0,this._y=0,this._id=++q$x._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,q$x.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=q$x.MAXCLIPRECT,this.mOutPoint,this._canvas=q$S,this._canvas._addReference(),q$x._contextcount++,q$F.isFlash?(this._ib=q$vS.create(35044),q$$S.fillIBQuadrangle(this._ib,16)):this._ib=q$vS.QuadrangleIB,this.clear()}q$C(q$x,"laya.webgl.canvas.WebGLContext2D",q$J);var q$_=q$x.prototype;return q$_.setIsMainContext=function(){this._isMain=!0},q$_.clearBG=function(q$S,q$_,q$a,q$R){var q$J=q$jS.mainContext;q$J.clearColor(q$S,q$_,q$a,q$R),q$J.clear(16384)},q$_._getSubmits=function(){return this._submits},q$_._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var q$S=0,q$_=this._submits._length;q$S<q$_;q$S++)this._submits[q$S].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},q$_.destroy=function(){--q$x._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=q$vS.QuadrangleIB&&this._ib.releaseResource()},q$_.clear=function(){this._submits||(this._other=q$a.DEFAULT,this._curMat=q$n.create(),this._vb=q$dS.create(-1),this._submits=[],this._save=[q$y.Create(this)],this._save.length=10,this._shader2D=new q$v,this._triangleMesh=q$PS.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=q$a.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=q$x.MAXCLIPRECT,this._curSubmit=q$VS.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=q$Y.DEFAULT;for(var q$S=0,q$_=this._submits._length;q$S<q$_;q$S++)this._submits[q$S].releaseRender(),this._submits[q$S]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},q$_.size=function(q$S,q$_){if(this._width!=q$S||this._height!=q$_)if(0==q$S||0==q$_){0!=this._vb._byteLength&&(this._width=q$S,this._height=q$_,this._vb.clear(),this._vb.upload());for(var q$a=0,q$R=this._submits._length;q$a<q$R;q$a++)this._submits[q$a].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=q$S,this._height=q$_,this._targets&&this._targets.size(q$S,q$_),this._canvas.memorySize-=this._canvas.memorySize;0===q$S&&0===q$_&&this._releaseMem()},q$_._getTransformMatrix=function(){return this._curMat},q$_.translate=function(q$S,q$_){0===q$S&&0===q$_||(q$O.save(this),this._curMat.bTransform&&(q$E.save(this),this._curMat.transformPointN(q$l.TEMP.setTo(q$S,q$_)),q$S=q$l.TEMP.x,q$_=q$l.TEMP.y),this._x+=q$S,this._y+=q$_)},q$_.save=function(){this._save[this._save._length++]=q$y.Create(this)},q$_.restore=function(){var q$S=this._save._length;if(!(q$S<1))for(var q$_=q$S-1;0<=q$_;q$_--){var q$a=this._save[q$_];if(q$a.restore(this),q$a.isSaveMark())return void(this._save._length=q$_)}},q$_._fillText=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){void 0===q$b&&(q$b=0);var q$H=this._shader2D,q$L=this._curSubmit.shaderValue,q$C=q$J?q$tS.create(q$J):this._other.font;if(q$s.enabled)q$H.ALPHA!==q$L.ALPHA&&(q$H.glTexture=null),q$GS.drawText(this,q$S,q$_,this._curMat,q$C,q$z||this._other.textAlign,q$V,q$W,q$k,q$a,q$R,q$b);else{this._shader2D.defines.getValue();var q$G=q$V?q$t.create(q$V)._color:q$H.colorAdd;q$H.ALPHA===q$L.ALPHA&&q$G===q$H.colorAdd&&q$L.colorAdd===q$H.colorAdd||(q$H.glTexture=null,q$H.colorAdd=q$G),q$GS.drawText(this,q$S,q$_,this._curMat,q$C,q$z||this._other.textAlign,q$V,q$W,q$k,q$a,q$R,q$b)}},q$_.fillWords=function(q$S,q$_,q$a,q$R,q$J,q$V){this._fillText(null,q$S,q$_,q$a,q$R,q$J,null,-1,null,q$V)},q$_.fillBorderWords=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this._fillBorderText(null,q$S,q$_,q$a,q$R,q$J,q$V,q$W,null)},q$_.fillText=function(q$S,q$_,q$a,q$R,q$J,q$V){this._fillText(q$S,null,q$_,q$a,q$R,q$J,null,-1,q$V)},q$_.strokeText=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this._fillText(q$S,null,q$_,q$a,q$R,null,q$J,q$V||1,q$W)},q$_.fillBorderText=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){this._fillBorderText(q$S,null,q$_,q$a,q$R,q$J,q$V,q$W,q$k)},q$_._fillBorderText=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){if(!q$s.enabled)return this._fillText(q$S,q$_,q$a,q$R,q$J,null,q$W,q$k||1,q$z),void this._fillText(q$S,q$_,q$a,q$R,q$J,q$V,null,-1,q$z);var q$b=this._shader2D,q$H=this._curSubmit.shaderValue;q$b.ALPHA!==q$H.ALPHA&&(q$b.glTexture=null);var q$L=q$J?(q$x._fontTemp.setFont(q$J),q$x._fontTemp):this._other.font;q$GS.drawText(this,q$S,q$_,this._curMat,q$L,q$z||this._other.textAlign,q$V,q$W,q$k||1,q$a,q$R,0)},q$_.fillRect=function(q$S,q$_,q$a,q$R,q$J){var q$V=this._vb;if(q$$S.fillRectImgVb(q$V,this._clipRect,q$S,q$_,q$a,q$R,q$P.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var q$W=this._shader2D.fillStyle;q$J&&(this._shader2D.fillStyle=q$Y.create(q$J));var q$k=this._shader2D,q$z=this._curSubmit.shaderValue;if(q$k.fillStyle!==q$z.fillStyle||q$k.ALPHA!==q$z.ALPHA){q$k.glTexture=null;var q$b=this._curSubmit=q$VS.createSubmit(this,this._ib,q$V,(q$V._byteLength-64)/32*3,q$NS.create(2,0));q$b.shaderValue.color=q$k.fillStyle._color._color,q$b.shaderValue.ALPHA=q$k.ALPHA,this._submits[this._submits._length++]=q$b}this._curSubmit._numEle+=6,this._shader2D.fillStyle=q$W}},q$_.fillTexture=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){if(q$S.loaded&&q$S.bitmap&&q$S.source){var q$z=this._vb,q$b=q$S.bitmap.width,q$H=q$S.bitmap.height,q$L=q$S.uv,q$C=q$W.x%q$S.width,q$G=q$W.y%q$S.height;if(q$b!=q$k.w||q$H!=q$k.h){if(!q$k.w&&!q$k.h)switch(q$k.oy=q$k.ox=0,q$V){case"repeat":q$k.width=q$R,q$k.height=q$J;break;case"repeat-x":q$k.width=q$R,q$G<0?q$S.height+q$G>q$J?q$k.height=q$J:q$k.height=q$S.height+q$G:(q$k.oy=q$G,q$S.height+q$G>q$J?q$k.height=q$J-q$G:q$k.height=q$S.height);break;case"repeat-y":q$C<0?q$S.width+q$C>q$R?q$k.width=q$R:q$k.width=q$S.width+q$C:(q$k.ox=q$C,q$S.width+q$C>q$R?q$k.width=q$R-q$C:q$k.width=q$S.width),q$k.height=q$J;break;case"no-repeat":q$C<0?q$S.width+q$C>q$R?q$k.width=q$R:q$k.width=q$S.width+q$C:(q$k.ox=q$C,q$S.width+q$C>q$R?q$k.width=q$R-q$C:q$k.width=q$S.width),q$G<0?q$S.height+q$G>q$J?q$k.height=q$J:q$k.height=q$S.height+q$G:(q$k.oy=q$G,q$S.height+q$G>q$J?q$k.height=q$J-q$G:q$k.height=q$S.height);break;default:q$k.width=q$R,q$k.height=q$J}q$k.w=q$b,q$k.h=q$H,q$k.uv=[0,0,q$k.width/q$b,0,q$k.width/q$b,q$k.height/q$H,0,q$k.height/q$H]}if(q$_+=q$k.ox,q$a+=q$k.oy,q$C-=q$k.ox,q$G-=q$k.oy,q$$S.fillRectImgVb(q$z,this._clipRect,q$_,q$a,q$k.width,q$k.height,q$k.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var q$t=q$KS.create(this,this._ib,q$z,(q$z._byteLength-64)/32*3,q$NS.create(256,0)),q$o=(this._submits[this._submits._length++]=q$t).shaderValue;q$o.textureHost=q$S;var q$$=q$L[0]*q$b,q$F=q$L[1]*q$H,q$T=(q$L[2]-q$L[0])*q$b,q$D=(q$L[5]-q$L[3])*q$H,q$j=-q$C/q$b,q$Q=-q$G/q$H;q$o.u_TexRange[0]=q$$/q$b,q$o.u_TexRange[1]=q$T/q$b,q$o.u_TexRange[2]=q$F/q$H,q$o.u_TexRange[3]=q$D/q$H,q$o.u_offset[0]=q$j,q$o.u_offset[1]=q$Q,q$s.enabled&&!this._isMain&&q$t.addTexture(q$S,(q$z._byteLength>>2)-16),(this._curSubmit=q$t)._renderType=10017,q$t._numEle+=6}}else this.sprite&&q$m.timer.callLater(this,this._repaintSprite)},q$_.setShader=function(q$S){q$Z.save(this,1048576,this._shader2D,!0),this._shader2D.shader=q$S},q$_.setFilters=function(q$S){q$Z.save(this,2097152,this._shader2D,!0),this._shader2D.filters=q$S,this._curSubmit=q$VS.RENDERBASE,this._renderKey=0,this._drawCount++},q$_.drawTexture=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this._drawTextureM(q$S,q$_,q$a,q$R,q$J,q$V,q$W,null,1)},q$_.addTextureVb=function(q$S,q$_,q$a){var q$R=this._curSubmit._vb||this._vb,q$J=q$R._byteLength>>2;q$R.byteLength=q$J+16<<2;for(var q$V=q$R.getFloat32Array(),q$W=0;q$W<16;q$W+=4)q$V[q$J++]=q$S[q$W]+q$_,q$V[q$J++]=q$S[q$W+1]+q$a,q$V[q$J++]=q$S[q$W+2],q$V[q$J++]=q$S[q$W+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),q$R._upload=!0},q$_.willDrawTexture=function(q$S,q$_){if(!(q$S.loaded&&q$S.bitmap&&q$S.source))return this.sprite&&q$m.timer.callLater(this,this._repaintSprite),0;var q$a=q$S.bitmap,q$R=q$a.id+this._shader2D.ALPHA*q$_+10016;if(q$R==this._renderKey)return q$R;var q$J=this._shader2D,q$V=q$J.ALPHA,q$W=this._curSubmit.shaderValue;q$J.ALPHA*=q$_,this._renderKey=q$R,this._drawCount++,q$J.glTexture=q$a;var q$k=this._vb,q$z=null,q$b=q$k._byteLength/32*3,q$H=q$W.textureHost&&q$W.textureHost==q$S&&q$W.textureHost.alphaTexture==q$S.alphaTexture;return q$z=q$KS.create(this,this._ib,q$k,q$b,q$NS.create(1,0)),(this._submits[this._submits._length++]=q$z).shaderValue.textureHost=q$S,q$z._renderType=10016,q$z._preIsSameTextureShader=10016===this._curSubmit._renderType&&q$J.ALPHA===q$W.ALPHA&&q$H,this._curSubmit=q$z,q$J.ALPHA=q$V,q$R},q$_.drawTextures=function(q$S,q$_,q$a,q$R){if(q$S.loaded&&q$S.bitmap&&q$S.source){var q$J=this._clipRect;if(this._clipRect=q$x.MAXCLIPRECT,this._drawTextureM(q$S,q$_[0],q$_[1],q$S.width,q$S.height,q$a,q$R,null,1)){if(this._clipRect=q$J,q$X.drawCall++,!(q$_.length<4)){for(var q$V=this._curSubmit._vb||this._vb,q$W=this._curMat.a,q$k=this._curMat.d,q$z=2,q$b=q$_.length;q$z<q$b;q$z+=2)q$$S.copyPreImgVb(q$V,(q$_[q$z]-q$_[q$z-2])*q$W,(q$_[q$z+1]-q$_[q$z-1])*q$k),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&q$m.timer.callLater(this,this._repaintSprite)},q$_._drawTextureM=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){if(!q$S.loaded||!q$S.source)return this.sprite&&q$m.timer.callLater(this,this._repaintSprite),!1;var q$b=this._curSubmit._vb||this._vb,q$H=q$S.bitmap;q$_+=q$V,q$a+=q$W,this._drawCount++;var q$L=q$H.id+this._shader2D.ALPHA*q$z+10016;if(q$L!=this._renderKey){this._renderKey=q$L;var q$C=this._curSubmit.shaderValue,q$G=this._shader2D,q$t=q$G.ALPHA;q$G.ALPHA*=q$z,q$G.glTexture=q$H;var q$o=this._vb,q$$=null,q$F=q$o._byteLength/32*3,q$T=q$C.textureHost&&q$C.textureHost==q$S&&q$C.textureHost.alphaTexture==q$S.alphaTexture;q$$=q$KS.create(this,this._ib,q$o,q$F,q$NS.create(1,0)),(this._submits[this._submits._length++]=q$$).shaderValue.textureHost=q$S,q$$._renderType=10016,q$$._preIsSameTextureShader=10016===this._curSubmit._renderType&&q$G.ALPHA===q$C.ALPHA&&q$T,this._curSubmit=q$$,q$b=this._curSubmit._vb||this._vb,q$G.ALPHA=q$t}return!!q$$S.fillRectImgVb(q$b,this._clipRect,q$_,q$a,q$R||q$S.width,q$J||q$S.height,q$S.uv,q$k||this._curMat,this._x,this._y,0,0)&&(q$s.enabled&&!this._isMain&&this._curSubmit.addTexture(q$S,(q$b._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},q$_._repaintSprite=function(){this.sprite&&this.sprite.repaint()},q$_._drawText=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){var q$H=q$S.bitmap;this._drawCount++;var q$L=q$H.id+this._shader2D.ALPHA+10016;if(q$L!=this._renderKey){this._renderKey=q$L;var q$C=this._curSubmit.shaderValue,q$G=this._shader2D;q$G.glTexture=q$H;var q$t=this._vb,q$o=null,q$$=q$t._byteLength/32*3,q$F=q$C.textureHost&&q$C.textureHost==q$S&&q$C.textureHost.alphaTexture==q$S.alphaTexture;(q$o=q$s.enabled?q$KS.create(this,this._ib,q$t,q$$,q$NS.create(1,0)):q$KS.create(this,this._ib,q$t,q$$,q$OS.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&q$G.ALPHA===q$C.ALPHA&&q$F,(this._submits[this._submits._length++]=q$o).shaderValue.textureHost=q$S,q$o._renderType=10016,this._curSubmit=q$o}q$S.active();var q$T=this._curSubmit._vb||this._vb;q$$S.fillRectImgVb(q$T,this._clipRect,q$_+q$W,q$a+q$k,q$R||q$S.width,q$J||q$S.height,q$S.uv,q$V||this._curMat,this._x,this._y,q$z,q$b,!0)&&(q$s.enabled&&!this._isMain&&this._curSubmit.addTexture(q$S,(q$T._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},q$_.drawTextureWithTransform=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){if(q$V){var q$b=this._curMat,q$H=this._x,q$L=this._y;(0!==q$W||0!==q$k)&&(this._x=q$W*q$b.a+q$k*q$b.c,this._y=q$k*q$b.d+q$W*q$b.b),q$V&&q$b.bTransform?(q$n.mul(q$V,q$b,q$x._tmpMatrix),(q$V=q$x._tmpMatrix)._checkTransform()):(this._x+=q$b.tx,this._y+=q$b.ty),this._drawTextureM(q$S,q$_,q$a,q$R,q$J,0,0,q$V,q$z),this._x=q$H,this._y=q$L}else this._drawTextureM(q$S,q$_,q$a,q$R,q$J,q$W,q$k,null,q$z)},q$_.fillQuadrangle=function(q$S,q$_,q$a,q$R,q$J){var q$V=this._curSubmit,q$W=this._vb,q$k=this._shader2D,q$z=q$V.shaderValue;if(this._renderKey=0,q$S.bitmap){var q$b=q$S.bitmap;q$k.glTexture==q$b&&q$k.ALPHA===q$z.ALPHA||(q$k.glTexture=q$b,(q$V=this._curSubmit=q$VS.createSubmit(this,this._ib,q$W,q$W._byteLength/32*3,q$NS.create(1,0))).shaderValue.glTexture=q$b,this._submits[this._submits._length++]=q$V),q$$S.fillQuadrangleImgVb(q$W,q$_,q$a,q$R,q$S.uv,q$J||this._curMat,this._x,this._y)}else q$V.shaderValue.fillStyle&&q$V.shaderValue.fillStyle.equal(q$S)&&q$k.ALPHA===q$z.ALPHA||(q$k.glTexture=null,(q$V=this._curSubmit=q$VS.createSubmit(this,this._ib,q$W,q$W._byteLength/32*3,q$NS.create(2,0))).shaderValue.defines.add(2),q$V.shaderValue.fillStyle=q$Y.create(q$S),this._submits[this._submits._length++]=q$V),q$$S.fillQuadrangleImgVb(q$W,q$_,q$a,q$R,q$P.DEF_UV,q$J||this._curMat,this._x,this._y);q$V._numEle+=6},q$_.drawTexture2=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){if(0!=q$V){var q$z=this._curMat;if(this._x=q$S*q$z.a+q$_*q$z.c,this._y=q$_*q$z.d+q$S*q$z.b,q$J&&(q$J=q$z.bTransform||q$J.bTransform?(q$n.mul(q$J,q$z,q$x._tmpMatrix),q$x._tmpMatrix):(this._x+=q$J.tx+q$z.tx,this._y+=q$J.ty+q$z.ty,q$n.EMPTY)),1!==q$V||q$W){var q$b=this._shader2D.ALPHA,q$H=this._nBlendType;this._shader2D.ALPHA=q$V,q$W&&(this._nBlendType=q$f.TOINT(q$W)),this._drawTextureM(q$k[0],q$k[1]-q$a,q$k[2]-q$R,q$k[3],q$k[4],0,0,q$J,1),this._shader2D.ALPHA=q$b,this._nBlendType=q$H}else this._drawTextureM(q$k[0],q$k[1]-q$a,q$k[2]-q$R,q$k[3],q$k[4],0,0,q$J,1);this._x=this._y=0}},q$_.drawCanvas=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$S.context;if(this._renderKey=0,q$V._targets)this._submits[this._submits._length++]=q$uS.create(q$V,0,null),this._curSubmit=q$VS.RENDERBASE,q$V._targets.drawTo(this,q$_,q$a,q$R,q$J);else{var q$W=this._submits[this._submits._length++]=q$uS.create(q$V,this._shader2D.ALPHA,this._shader2D.filters),q$k=q$R/q$S.width,q$z=q$J/q$S.height,q$b=q$W._matrix;this._curMat.copyTo(q$b),1!=q$k&&1!=q$z&&q$b.scale(q$k,q$z);var q$H=q$b.tx,q$L=q$b.ty;q$b.tx=q$b.ty=0,q$b.transformPoint(q$l.TEMP.setTo(q$_,q$a)),q$b.translate(q$l.TEMP.x+q$H,q$l.TEMP.y+q$L),this._curSubmit=q$VS.RENDERBASE}q$q.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=q$V._targets?"yellow":"green",this.strokeRect(q$_-1,q$a-1,q$R+2,q$J+2,1),this.strokeRect(q$_,q$a,q$R,q$J,1),this.restore())},q$_.drawTarget=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){void 0===q$b&&(q$b=-1);var q$H=this._vb;if(q$$S.fillRectImgVb(q$H,this._clipRect,q$_,q$a,q$R,q$J,q$z||q$P.DEF_UV,q$V||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var q$L=this._curSubmit=q$LS.create(this,this._ib,q$H,(q$H._byteLength-64)/32*3,q$k,q$W);q$L.blendType=-1==q$b?this._nBlendType:q$b,q$L.scope=q$S,this._submits[this._submits._length++]=q$L,this._curSubmit._numEle+=6}},q$_.mixRGBandAlpha=function(q$S){return this._mixRGBandAlpha(q$S,this._shader2D.ALPHA)},q$_._mixRGBandAlpha=function(q$S,q$_){var q$a=(4278190080&q$S)>>>24;return 0!=q$a?q$a*=q$_:q$a=255*q$_,16777215&q$S|q$a<<24},q$_.drawTriangles=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){if(!q$S.loaded||!q$S.source)return this.sprite&&q$m.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;q$S.bitmap;var q$H=this._mixRGBandAlpha(4294967295,q$k),q$L=(q$R.length,q$V.length);this._renderKey=-1;var q$C=this._curSubmit=q$KS.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,q$NS.create(1,0));return q$C.shaderValue.textureHost=q$S,q$C._renderType=10016,this._submits[this._submits._length++]=q$C,q$W?(q$x._tmpMatrix.a=q$W.a,q$x._tmpMatrix.b=q$W.b,q$x._tmpMatrix.c=q$W.c,q$x._tmpMatrix.d=q$W.d,q$x._tmpMatrix.tx=q$W.tx+q$_,q$x._tmpMatrix.ty=q$W.ty+q$a,q$n.mul(q$x._tmpMatrix,this._curMat,q$x._tmpMatrix)):(q$x._tmpMatrix.a=this._curMat.a,q$x._tmpMatrix.b=this._curMat.b,q$x._tmpMatrix.c=this._curMat.c,q$x._tmpMatrix.d=this._curMat.d,q$x._tmpMatrix.tx=this._curMat.tx+q$_,q$x._tmpMatrix.ty=this._curMat.ty+q$a),this._triangleMesh.addData(q$R,q$J,q$V,q$x._tmpMatrix,q$H,this),this._curSubmit._numEle+=q$L,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},q$_.transform=function(q$S,q$_,q$a,q$R,q$J,q$V){q$E.save(this),q$n.mul(q$n.TEMP.setTo(q$S,q$_,q$a,q$R,q$J,q$V),this._curMat,this._curMat),this._curMat._checkTransform()},q$_.setTransformByMatrix=function(q$S){q$S.copyTo(this._curMat)},q$_.transformByMatrix=function(q$S){q$E.save(this),q$n.mul(q$S,this._curMat,this._curMat),this._curMat._checkTransform()},q$_.rotate=function(q$S){q$E.save(this),this._curMat.rotateEx(q$S)},q$_.scale=function(q$S,q$_){q$E.save(this),this._curMat.scaleEx(q$S,q$_)},q$_.clipRect=function(q$S,q$_,q$a,q$R){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var q$J=q$HS.create(4);this.addRenderObject(q$J);var q$V=this._vb,q$W=q$V._byteLength>>2;if(q$$S.fillRectImgVb(q$V,null,q$S,q$_,q$a,q$R,q$P.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var q$k=this._curSubmit=q$VS.createSubmit(this,this._ib,q$V,(q$V._byteLength-64)/32*3,q$NS.create(2,0));q$k.shaderValue.ALPHA=1,this._submits[this._submits._length++]=q$k,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var q$z=q$HS.create(5);this.addRenderObject(q$z);var q$b=q$V.getFloat32Array(),q$H=Math.min(Math.min(Math.min(q$b[0+q$W],q$b[4+q$W]),q$b[8+q$W]),q$b[12+q$W]),q$L=Math.max(Math.max(Math.max(q$b[0+q$W],q$b[4+q$W]),q$b[8+q$W]),q$b[12+q$W]),q$C=Math.min(Math.min(Math.min(q$b[1+q$W],q$b[5+q$W]),q$b[9+q$W]),q$b[13+q$W]),q$G=Math.max(Math.max(Math.max(q$b[1+q$W],q$b[5+q$W]),q$b[9+q$W]),q$b[13+q$W]);q$c.save(this,q$z,q$S,q$_,q$a,q$R,q$H,q$C,q$L-q$H,q$G-q$C),this._curSubmit=q$VS.RENDERBASE}else{q$a*=this._curMat.a,q$R*=this._curMat.d;var q$t=q$l.TEMP;this._curMat.transformPoint(q$t.setTo(q$S,q$_)),q$a<0&&(q$t.x=q$t.x+q$a,q$a=-q$a),q$R<0&&(q$t.y=q$t.y+q$R,q$R=-q$R),this._renderKey=0;var q$o=this._curSubmit=q$bS.create(this);(this._submits[this._submits._length++]=q$o).submitIndex=this._submits._length,q$o.submitLength=9999999,q$p.save(this,q$o);var q$$=this._clipRect,q$F=q$$.x,q$T=q$$.y,q$D=q$t.x+q$a,q$j=q$t.y+q$R;q$F<q$t.x&&(q$$.x=q$t.x),q$T<q$t.y&&(q$$.y=q$t.y),q$$.width=Math.min(q$D,q$F+q$$.width)-q$$.x,q$$.height=Math.min(q$j,q$T+q$$.height)-q$$.y,this._shader2D.glTexture=null,q$o.clipRect.copyFrom(q$$),this._curSubmit=q$VS.RENDERBASE}},q$_.setIBVB=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H){if(void 0===q$z&&(q$z=0),void 0===q$b&&(q$b=0),void 0===q$H&&(q$H=0),null===q$a){if(q$F.isFlash){var q$L=q$R;q$L._selfIB||(q$L._selfIB=q$vS.create(35044)),q$L._selfIB.clear(),q$a=q$L._selfIB}else q$a=this._ib;q$$S.expandIBQuadrangle(q$a,q$R._byteLength/(4*q$R.vertexStride*4))}if(!q$k||!q$W)throw Error("setIBVB must input:shader shaderValues");var q$C=q$zS.create(this,q$R,q$a,q$J,q$W,q$k,q$z,q$b,q$H);q$V||(q$V=q$n.EMPTY),q$V.translate(q$S,q$_),q$n.mul(q$V,this._curMat,q$C._mat),q$V.translate(-q$S,-q$_),this._submits[this._submits._length++]=q$C,this._curSubmit=q$VS.RENDERBASE,this._renderKey=0},q$_.addRenderObject=function(q$S){this._submits[this._submits._length++]=q$S},q$_.fillTrangles=function(q$S,q$_,q$a,q$R,q$J){var q$V=this._curSubmit,q$W=this._vb,q$k=this._shader2D,q$z=q$V.shaderValue,q$b=q$R.length>>4,q$H=q$S.bitmap;this._renderKey=0,q$k.glTexture==q$H&&q$k.ALPHA===q$z.ALPHA||((q$V=this._curSubmit=q$VS.createSubmit(this,this._ib,q$W,q$W._byteLength/32*3,q$NS.create(1,0))).shaderValue.textureHost=q$S,this._submits[this._submits._length++]=q$V),q$$S.fillTranglesVB(q$W,q$_,q$a,q$R,q$J||this._curMat,this._x,this._y),q$V._numEle+=6*q$b},q$_.submitElement=function(q$S,q$_){var q$a=this._submits;for(q$_<0&&(q$_=q$a._length);q$S<q$_;)q$S+=q$a[q$S].renderSubmit()},q$_.finish=function(){q$jS.mainContext.finish()},q$_.flush=function(){var q$S=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(q$S>this._ib.bufferLength/12&&q$$S.expandIBQuadrangle(this._ib,q$S),!this._isMain&&q$s.enabled&&q$s._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=q$s._atlasRestore;for(var q$_=this._submits,q$a=0,q$R=q$_._length;q$a<q$R;q$a++){var q$J=q$_[q$a];10016===q$J.getRenderType()&&q$J.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),q$_S.instance&&q$_S.getInstance().reset();var q$V;for(q$a=0,q$V=this.meshlist.length;q$a<q$V;q$a++){var q$W=this.meshlist[q$a];q$W.canReuse?q$W.releaseMesh():q$W.destroy()}return this.meshlist.length=0,this._curSubmit=q$VS.RENDERBASE,this._renderKey=0,this._triangleMesh=q$PS.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},q$_.setPathId=function(q$S){if(this.mId=q$S,-1!=this.mId){this.mHaveKey=!1;var q$_=q$r.getInstance();q$_.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,q$_.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},q$_.movePath=function(q$S,q$_){var q$a=q$S,q$R=q$_;q$S=this._curMat.a*q$a+this._curMat.c*q$R+this._curMat.tx,q$_=this._curMat.b*q$a+this._curMat.d*q$R+this._curMat.ty,this.mX+=q$S,this.mY+=q$_},q$_.beginPath=function(){var q$S=this._getPath();q$S.tempArray.length=0,q$S.closePath=!1,this.mX=0,this.mY=0},q$_.closePath=function(){this._path.closePath=!0},q$_.fill=function(q$S){void 0===q$S&&(q$S=!1);var q$_=this._getPath();this.drawPoly(0,0,q$_.tempArray,this.fillStyle._color.numColor,0,0,q$S)},q$_.stroke=function(){var q$S=this._getPath();if(0<this.lineWidth){if(-1==this.mId)q$S.drawLine(0,0,q$S.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var q$_=q$r.getInstance().shapeLineDic[this.mId];q$_.rebuild(q$S.tempArray),q$S.setGeomtry(q$_)}else q$r.getInstance().addLine(this.mId,q$S.drawLine(0,0,q$S.tempArray,this.lineWidth,this.strokeStyle._color.numColor));q$S.update();var q$a=[this.mX,this.mY],q$R=q$VS.createShape(this,q$S.ib,q$S.vb,q$S.count,q$S.offset,q$NS.create(4,0));q$R.shaderValue.ALPHA=this._shader2D.ALPHA,q$R.shaderValue.u_pos=q$a,q$R.shaderValue.u_mmat2=q$TS.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=q$R,this._renderKey=-1}},q$_.line=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=this._curSubmit,q$k=this._vb;if(q$$S.fillLineVb(q$k,this._clipRect,q$S,q$_,q$a,q$R,q$J,q$V)){this._renderKey=0;var q$z=this._shader2D,q$b=q$W.shaderValue;q$z.strokeStyle===q$b.strokeStyle&&q$z.ALPHA===q$b.ALPHA||(q$z.glTexture=null,(q$W=this._curSubmit=q$VS.createSubmit(this,this._ib,q$k,(q$k._byteLength-64)/32*3,q$NS.create(2,0))).shaderValue.strokeStyle=q$z.strokeStyle,q$W.shaderValue.mainID=2,q$W.shaderValue.ALPHA=q$z.ALPHA,this._submits[this._submits._length++]=q$W),q$W._numEle+=6}},q$_.moveTo=function(q$S,q$_,q$a){void 0===q$a&&(q$a=!0);var q$R=this._getPath();if(q$a){var q$J=q$S,q$V=q$_;q$S=this._curMat.a*q$J+this._curMat.c*q$V,q$_=this._curMat.b*q$J+this._curMat.d*q$V}q$R.addPoint(q$S,q$_)},q$_.lineTo=function(q$S,q$_,q$a){void 0===q$a&&(q$a=!0);var q$R=this._getPath();if(q$a){var q$J=q$S,q$V=q$_;q$S=this._curMat.a*q$J+this._curMat.c*q$V,q$_=this._curMat.b*q$J+this._curMat.d*q$V}q$R.addPoint(q$S,q$_)},q$_.drawCurves=function(q$S,q$_,q$a){this.setPathId(-1),this.beginPath(),this.strokeStyle=q$a[3],this.lineWidth=q$a[4];var q$R=q$a[2];q$S+=q$a[0],q$_+=q$a[1],this.movePath(q$S,q$_),this.moveTo(q$R[0],q$R[1]);for(var q$J=2,q$V=q$R.length;q$J<q$V;)this.quadraticCurveTo(q$R[q$J++],q$R[q$J++],q$R[q$J++],q$R[q$J++]);this.stroke()},q$_.arcTo=function(q$S,q$_,q$a,q$R,q$J){if(-1==this.mId||!this.mHaveKey){var q$V=0,q$W=0,q$k=0,q$z=this._getPath();this._curMat.copyTo(q$x._tmpMatrix),q$x._tmpMatrix.tx=q$x._tmpMatrix.ty=0,q$x._tempPoint.setTo(q$z.getEndPointX(),q$z.getEndPointY()),q$x._tmpMatrix.invertTransformPoint(q$x._tempPoint);var q$b=q$x._tempPoint.x-q$S,q$H=q$x._tempPoint.y-q$_,q$L=Math.sqrt(q$b*q$b+q$H*q$H);if(!(q$L<=1e-6)){var q$C=q$b/q$L,q$G=q$H/q$L,q$t=q$a-q$S,q$o=q$R-q$_,q$$=q$t*q$t+q$o*q$o,q$F=Math.sqrt(q$$);if(!(q$F<=1e-6)){var q$T=q$t/q$F,q$D=q$o/q$F,q$j=q$C+q$T,q$Q=q$G+q$D,q$m=Math.sqrt(q$j*q$j+q$Q*q$Q);if(!(q$m<=1e-6)){var q$q=q$j/q$m,q$N=q$Q/q$m,q$n=Math.acos(q$q*q$C+q$N*q$G),q$l=Math.PI/2-q$n,q$B=(q$L=q$J/Math.tan(q$l))*q$C+q$S,q$I=q$L*q$G+q$_,q$A=Math.sqrt(q$L*q$L+q$J*q$J),q$X=q$S+q$q*q$A,q$h=q$_+q$N*q$A,q$u=0,q$K=0;if(0<=q$C*q$D-q$G*q$T){var q$P=2*q$l/q$x.SEGNUM;q$u=Math.sin(q$P),q$K=Math.cos(q$P)}else q$P=2*-q$l/q$x.SEGNUM,q$u=Math.sin(q$P),q$K=Math.cos(q$P);q$W=this._curMat.a*q$B+this._curMat.c*q$I,q$k=this._curMat.b*q$B+this._curMat.d*q$I,q$W==this._path.getEndPointX()&&q$k==this._path.getEndPointY()||q$z.addPoint(q$W,q$k);var q$M=q$B-q$X,q$r=q$I-q$h;for(q$V=0;q$V<q$x.SEGNUM;q$V++){var q$e=q$M*q$K+q$r*q$u,q$g=-q$M*q$u+q$r*q$K;q$W=q$e+q$X,q$k=q$g+q$h,q$S=this._curMat.a*q$W+this._curMat.c*q$k,q$k=q$_=this._curMat.b*q$W+this._curMat.d*q$k,(q$W=q$S)==this._path.getEndPointX()&&q$k==this._path.getEndPointY()||q$z.addPoint(q$W,q$k),q$M=q$e,q$r=q$g}}}}}},q$_.arc=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){if(void 0===q$V&&(q$V=!1),void 0===q$W&&(q$W=!0),-1!=this.mId){var q$k=q$r.getInstance().shapeDic[this.mId];if(q$k&&this.mHaveKey&&!q$k.needUpdate(this._curMat))return;q$_=q$S=0}var q$z,q$b=0,q$H=0,q$L=0,q$C=0,q$G=0,q$t=0,q$o=0;if(q$H=q$J-q$R,q$V)if(Math.abs(q$H)>=2*Math.PI)q$H=2*-Math.PI;else for(;0<q$H;)q$H-=2*Math.PI;else if(Math.abs(q$H)>=2*Math.PI)q$H=2*Math.PI;else for(;q$H<0;)q$H+=2*Math.PI;q$z=q$H/(q$o=q$a<101?Math.max(10,q$H*q$a/5):q$a<201?Math.max(10,q$H*q$a/20):Math.max(10,q$H*q$a/40))/2,q$L=Math.abs(4/3*(1-Math.cos(q$z))/Math.sin(q$z)),q$V&&(q$L=-q$L);var q$$=this._getPath(),q$F=NaN,q$T=NaN;for(q$t=0;q$t<=q$o;q$t++)q$b=q$R+q$H*(q$t/q$o),q$C=q$S+Math.cos(q$b)*q$a,q$G=q$_+Math.sin(q$b)*q$a,q$W&&(q$F=q$C,q$T=q$G,q$C=this._curMat.a*q$F+this._curMat.c*q$T,q$G=this._curMat.b*q$F+this._curMat.d*q$T),q$C==this._path.getEndPointX()&&q$G==this._path.getEndPointY()||q$$.addPoint(q$C,q$G);q$C=q$S+Math.cos(q$J)*q$a,q$G=q$_+Math.sin(q$J)*q$a,q$W&&(q$F=q$C,q$T=q$G,q$C=this._curMat.a*q$F+this._curMat.c*q$T,q$G=this._curMat.b*q$F+this._curMat.d*q$T),q$C==this._path.getEndPointX()&&q$G==this._path.getEndPointY()||q$$.addPoint(q$C,q$G)},q$_.quadraticCurveTo=function(q$S,q$_,q$a,q$R){var q$J=q$L.I,q$V=q$a,q$W=q$R;q$a=this._curMat.a*q$V+this._curMat.c*q$W,q$R=this._curMat.b*q$V+this._curMat.d*q$W,q$V=q$S,q$W=q$_,q$S=this._curMat.a*q$V+this._curMat.c*q$W,q$_=this._curMat.b*q$V+this._curMat.d*q$W;for(var q$k=q$J.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),q$S,q$_,q$a,q$R],30,2),q$z=0,q$b=q$k.length/2;q$z<q$b;q$z++)this.lineTo(q$k[2*q$z],q$k[2*q$z+1],!1);this.lineTo(q$a,q$R,!1)},q$_.rect=function(q$S,q$_,q$a,q$R){this._other=this._other.make(),this._other.path||(this._other.path=new q$i),this._other.path.rect(q$S,q$_,q$a,q$R)},q$_.strokeRect=function(q$S,q$_,q$a,q$R,q$J){var q$V=.5*q$J;this.line(q$S-q$V,q$_,q$S+q$a+q$V,q$_,q$J,this._curMat),this.line(q$S+q$a,q$_,q$S+q$a,q$_+q$R,q$J,this._curMat),this.line(q$S,q$_,q$S,q$_+q$R,q$J,this._curMat),this.line(q$S-q$V,q$_+q$R,q$S+q$a+q$V,q$_+q$R,q$J,this._curMat)},q$_.clip=function(){},q$_.drawPoly=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){void 0===q$W&&(q$W=!1),this._renderKey=0,this._shader2D.glTexture=null;var q$k=this._getPath();if(-1==this.mId)q$k.polygon(q$S,q$_,q$a,q$R,q$J||1,q$V);else if(this.mHaveKey){var q$z=q$r.getInstance().shapeDic[this.mId];q$z.setMatrix(this._curMat),q$z.rebuild(q$k.tempArray),q$k.setGeomtry(q$z)}else{var q$b=q$k.polygon(q$S,q$_,q$a,q$R,q$J||1,q$V);q$r.getInstance().addShape(this.mId,q$b),q$b.setMatrix(this._curMat)}q$k.update();var q$H,q$L=[this.mX,this.mY];if((q$H=q$VS.createShape(this,q$k.ib,q$k.vb,q$k.count,q$k.offset,q$NS.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,q$H.shaderValue.u_pos=q$L,q$H.shaderValue.u_mmat2=q$TS.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=q$H,0<q$J){if(this.mHaveLineKey){var q$C=q$r.getInstance().shapeLineDic[this.mId];q$C.rebuild(q$k.tempArray),q$k.setGeomtry(q$C)}else q$r.getInstance().addShape(this.mId,q$k.drawLine(q$S,q$_,q$a,q$J,q$V));q$k.update(),(q$H=q$VS.createShape(this,q$k.ib,q$k.vb,q$k.count,q$k.offset,q$NS.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,q$H.shaderValue.u_mmat2=q$TS.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=q$H}},q$_.drawParticle=function(q$S,q$_,q$a){q$a.x=q$S,q$a.y=q$_,this._submits[this._submits._length++]=q$a},q$_._getPath=function(){return this._path||(this._path=new q$i)},q$R(0,q$_,"globalCompositeOperation",function(){return q$f.NAMES[this._nBlendType]},function(q$S){var q$_=q$f.TOINT[q$S];null==q$_||this._nBlendType===q$_||(q$Z.save(this,65536,this,!0),this._curSubmit=q$VS.RENDERBASE,this._renderKey=0,this._nBlendType=q$_)}),q$R(0,q$_,"strokeStyle",function(){return this._shader2D.strokeStyle},function(q$S){this._shader2D.strokeStyle.equal(q$S)||(q$Z.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=q$Y.create(q$S))}),q$R(0,q$_,"globalAlpha",function(){return this._shader2D.ALPHA},function(q$S){(q$S=Math.floor(1e3*q$S)/1e3)!=this._shader2D.ALPHA&&(q$Z.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=q$S)}),q$R(0,q$_,"asBitmap",null,function(q$S){if(q$S){if(this._targets||(this._targets=new q$w),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),q$R(0,q$_,"fillStyle",function(){return this._shader2D.fillStyle},function(q$S){this._shader2D.fillStyle.equal(q$S)||(q$Z.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=q$Y.create(q$S))}),q$R(0,q$_,"textAlign",function(){return this._other.textAlign},function(q$S){this._other.textAlign===q$S||(this._other=this._other.make(),q$Z.save(this,32768,this._other,!1),this._other.textAlign=q$S)}),q$R(0,q$_,"lineWidth",function(){return this._other.lineWidth},function(q$S){this._other.lineWidth===q$S||(this._other=this._other.make(),q$Z.save(this,256,this._other,!1),this._other.lineWidth=q$S)}),q$R(0,q$_,"textBaseline",function(){return this._other.textBaseline},function(q$S){this._other.textBaseline===q$S||(this._other=this._other.make(),q$Z.save(this,16384,this._other,!1),this._other.textBaseline=q$S)}),q$R(0,q$_,"font",null,function(q$S){q$S!=this._other.font.toString()&&(this._other=this._other.make(),q$Z.save(this,8,this._other,!1),this._other.font===q$tS.EMPTY?this._other.font=new q$tS(q$S):this._other.font.setFont(q$S))}),q$x.__init__=function(){q$a.DEFAULT=new q$a},q$x._tempPoint=new q$l,q$x._SUBMITVBSIZE=32e3,q$x._MAXSIZE=99999999,q$x._RECTVBSIZE=16,q$x.MAXCLIPRECT=new q$B(0,0,99999999,99999999),q$x._COUNT=0,q$x._tmpMatrix=new q$n,q$x.SEGNUM=32,q$x._contextcount=0,q$W(q$x,["_fontTemp",function(){return this._fontTemp=new q$tS},"_drawStyleTemp",function(){return this._drawStyleTemp=new q$Y(null)}]),q$x.__init$=function(){q$a=function(){function q$S(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=q$tS.EMPTY}q$C(q$S,"");var q$_=q$S.prototype;return q$_.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=q$tS.EMPTY},q$_.make=function(){return this===q$S.DEFAULT?new q$S:this},q$S.DEFAULT=null,q$S}()},q$x}(),q$NS=function(q$S){function q$R(q$S,q$_){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,q$R.__super.call(this),this.defines=new q$IS,this.position=q$R._POSITION,this.mainID=q$S,this.subID=q$_,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=q$S|q$_,this._inClassCache=q$R._cache[this._cacheID],0<q$S&&!this._inClassCache&&(this._inClassCache=q$R._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}q$C(q$R,"laya.webgl.shader.d2.value.Value2D",q$g);var q$_=q$R.prototype;return q$_.setValue=function(q$S){},q$_.refresh=function(){var q$S=this.size;return q$S[0]=q$TS.width,q$S[1]=q$TS.height,this.alpha=this.ALPHA*q$TS.worldAlpha,this.mmat=q$TS.worldMatrix4,this},q$_._ShaderWithCompile=function(){return q$yS.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,q$wS.create)},q$_._withWorldShaderDefines=function(){var q$S=q$TS.worldShaderDefines,q$_=q$yS.sharders[this.mainID|this.defines._value|q$S.getValue()];if(!q$_){var q$a,q$R={};for(q$a in this.defines.toNameDic())q$R[q$a]="";for(q$a in q$S.toNameDic())q$R[q$a]="";q$_=q$yS.withCompile2D(0,this.mainID,q$R,this.mainID|this.defines._value|q$S.getValue(),q$wS.create)}var q$J=q$TS.worldFilters;if(!q$J)return q$_;for(var q$V,q$W=q$J.length,q$k=0;q$k<q$W;q$k++)(q$V=q$J[q$k])&&q$V.action.setValue(this);return q$_},q$_.upload=function(){var q$S=q$TS;this.alpha=this.ALPHA*q$S.worldAlpha,q$TS.worldMatrix4!==q$TS.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),q$jS.shaderHighPrecision&&this.defines.add(1024);var q$_,q$a=q$S.worldShaderDefines?this._withWorldShaderDefines():q$yS.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=q$S.width,this.size[1]=q$S.height,this.mmat=q$S.worldMatrix4,q$MS.activeShader!==q$a?q$a._shaderValueWidth!==q$S.width||q$a._shaderValueHeight!==q$S.height?(q$a._shaderValueWidth=q$S.width,q$a._shaderValueHeight=q$S.height):q$_=q$a._params2dQuick2||q$a._make2dQuick2():q$a._shaderValueWidth!==q$S.width||q$a._shaderValueHeight!==q$S.height?(q$a._shaderValueWidth=q$S.width,q$a._shaderValueHeight=q$S.height):q$_=q$a._params2dQuick1||q$a._make2dQuick1(),q$a.upload(this,q$_)},q$_.setFilters=function(q$S){if(this.filters=q$S)for(var q$_,q$a=q$S.length,q$R=0;q$R<q$a;q$R++)(q$_=q$S[q$R])&&(this.defines.add(q$_.type),q$_.action.setValue(this))},q$_.clear=function(){this.defines.setValue(this.subID)},q$_.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},q$R._initone=function(q$S,q$_){q$R._typeClass[q$S]=q$_,q$R._cache[q$S]=[],q$R._cache[q$S]._length=0},q$R.__init__=function(){q$R._POSITION=[2,5126,!1,4*q$oS.BYTES_PE,0],q$R._TEXCOORD=[2,5126,!1,4*q$oS.BYTES_PE,2*q$oS.BYTES_PE],q$R._initone(2,q$xS),q$R._initone(4,q$fS),q$R._initone(256,q$sS),q$R._initone(512,q$gS),q$R._initone(1,q$US),q$R._initone(65,q$OS),q$R._initone(9,q$US)},q$R.create=function(q$S,q$_){var q$a=q$R._cache[q$S|q$_];return q$a._length?q$a[--q$a._length]:new q$R._typeClass[q$S|q$_](q$_)},q$R._POSITION=null,q$R._TEXCOORD=null,q$R._cache=[],q$R._typeClass=[],q$R.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],q$R}(),q$nS=function(q$S){function q$$(q$S,q$_){q$$.__super.call(this,q$S,q$_)}q$C(q$$,"laya.webgl.utils.RenderSprite3D",q$T);var q$_=q$$.prototype;return q$_.onCreate=function(q$S){switch(q$S){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},q$_._mask=function(q$S,q$_,q$a,q$R){var q$J,q$V,q$W=this._next,q$k=q$S.mask;if(q$k){q$_.ctx.save();var q$z=q$_.ctx.globalCompositeOperation,q$b=new q$B;if(q$b.copyFrom(q$k.getBounds()),q$b.width=Math.round(q$b.width),q$b.height=Math.round(q$b.height),q$b.x=Math.round(q$b.x),q$b.y=Math.round(q$b.y),0<q$b.width&&0<q$b.height){var q$H=q$S._style._tf,q$L=q$kS.create();q$L.addValue("bounds",q$b),q$J=q$WS.create([q$L,q$_],laya.webgl.utils.RenderSprite3D.tmpTarget),q$_.addRenderObject(q$J),q$k.render(q$_,-q$b.x,-q$b.y),q$J=q$WS.create([q$L],laya.webgl.utils.RenderSprite3D.endTmpTarget),q$_.addRenderObject(q$J),q$_.ctx.save(),q$_.clipRect(q$a-q$H.translateX+q$b.x,q$R-q$H.translateY+q$b.y,q$b.width,q$b.height),q$W._fun.call(q$W,q$S,q$_,q$a,q$R),q$_.ctx.restore(),q$V=q$HS.create(6),q$z=q$_.ctx.globalCompositeOperation,q$V.blendMode="mask",q$_.addRenderObject(q$V),q$n.TEMP.identity();var q$C=q$NS.create(1,0),q$G=q$P.INV_UV,q$t=q$b.width,q$o=q$b.height;(q$b.width<32||q$b.height<32)&&((q$G=q$$.tempUV)[0]=0,q$G[1]=0,q$G[2]=32<=q$b.width?1:q$b.width/32,q$G[3]=0,q$G[4]=32<=q$b.width?1:q$b.width/32,q$G[5]=32<=q$b.height?1:q$b.height/32,q$G[6]=0,q$G[7]=32<=q$b.height?1:q$b.height/32,q$b.width=32<=q$b.width?q$b.width:32,q$b.height=32<=q$b.height?q$b.height:32,q$G[1]*=-1,q$G[3]*=-1,q$G[5]*=-1,q$G[7]*=-1,q$G[1]+=1,q$G[3]+=1,q$G[5]+=1,q$G[7]+=1),q$_.ctx.drawTarget(q$L,q$a+q$b.x-q$H.translateX,q$R+q$b.y-q$H.translateY,q$t,q$o,q$n.TEMP,"tmpTarget",q$C,q$G,6),q$J=q$WS.create([q$L],laya.webgl.utils.RenderSprite3D.recycleTarget),q$_.addRenderObject(q$J),(q$V=q$HS.create(6)).blendMode=q$z,q$_.addRenderObject(q$V)}q$_.ctx.restore()}else q$W._fun.call(q$W,q$S,q$_,q$a,q$R)},q$_._blend=function(q$S,q$_,q$a,q$R){var q$J=q$S._style,q$V=this._next;q$J.blendMode?(q$_.ctx.save(),q$_.ctx.globalCompositeOperation=q$J.blendMode,q$V._fun.call(q$V,q$S,q$_,q$a,q$R),q$_.ctx.restore()):q$V._fun.call(q$V,q$S,q$_,q$a,q$R)},q$_._transform=function(q$S,q$_,q$a,q$R){var q$J=q$S.transform,q$V=this._next;if(q$J&&q$V!=q$T.NORENDER){var q$W=q$_.ctx;q$S._style;q$J.tx=q$a,q$J.ty=q$R;var q$k=q$W._getTransformMatrix(),q$z=q$k.clone();q$n.mul(q$J,q$k,q$k),q$k._checkTransform(),q$J.tx=q$J.ty=0,q$V._fun.call(q$V,q$S,q$_,0,0),q$z.copyTo(q$k),q$z.destroy()}else q$V._fun.call(q$V,q$S,q$_,q$a,q$R)},q$$.tmpTarget=function(q$S,q$_){var q$a=q$S.getValue("bounds"),q$R=q$rS.create(q$a.width,q$a.height);q$R.start(),q$R.clear(0,0,0,0),q$S.addValue("tmpTarget",q$R)},q$$.endTmpTarget=function(q$S){q$S.getValue("tmpTarget").end()},q$$.recycleTarget=function(q$S){q$S.getValue("tmpTarget").recycle(),q$S.recycle()},q$W(q$$,["tempUV",function(){return this.tempUV=new Array(8)}]),q$$}(),q$lS=function(q$S){function q$_(){this.data=null,q$_.__super.call(this)}q$C(q$_,"laya.filters.webgl.ColorFilterActionGL",q$e);var q$a=q$_.prototype;return q$m.imps(q$a,{"laya.filters.IFilterActionGL":!0}),q$a.setValue=function(q$S){q$S.colorMat=this.data._mat,q$S.colorAlpha=this.data._alpha},q$a.apply3d=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$S.getValue("bounds"),q$W=q$NS.create(1,0);q$W.setFilters([this.data]);var q$k=q$n.TEMP;q$k.identity(),q$a.ctx.drawTarget(q$S,0,0,q$V.width,q$V.height,q$k,"src",q$W)},q$_}(),q$BS=function(q$S){function q$V(q$S,q$_,q$a,q$R,q$J){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,q$V.__super.call(this,q$S,q$_,q$J),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new q$YS,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=q$a,this._atlasCanvas.height=q$R,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}q$C(q$V,"laya.webgl.atlas.Atlaser",q$x);var q$_=q$V.prototype;return q$_.computeUVinAtlasTexture=function(q$S,q$_,q$a,q$R){var q$J=q$s.atlasTextureWidth,q$V=q$s.atlasTextureHeight,q$W=q$a/q$J,q$k=q$R/q$V,q$z=(q$a+q$S.bitmap.width)/q$J,q$b=(q$R+q$S.bitmap.height)/q$V,q$H=q$S.bitmap.width/q$J,q$L=q$S.bitmap.height/q$V;q$S.uv=[q$W+q$_[0]*q$H,q$k+q$_[1]*q$L,q$z-(1-q$_[2])*q$H,q$k+q$_[3]*q$L,q$z-(1-q$_[4])*q$H,q$b-(1-q$_[5])*q$L,q$W+q$_[6]*q$H,q$b-(1-q$_[7])*q$L]},q$_.findBitmapIsExist=function(q$S){if(q$S instanceof laya.webgl.resource.WebGLImage){var q$_=q$S,q$a=q$_.url,q$R=this._InAtlasWebGLImagesKey[q$a||q$_.id];if(q$R)return q$R.offsetInfoID}return-1},q$_.addToAtlasTexture=function(q$S,q$_,q$a){if(q$S instanceof laya.webgl.resource.WebGLImage){var q$R=q$S,q$J=q$R.url;this._InAtlasWebGLImagesKey[q$J||q$R.id]={bitmap:q$S,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([q$_,q$a])}this._atlasCanvas.texSubImage2D(q$_,q$a,q$S.atlasSource),q$S.clearAtlasSource()},q$_.addToAtlas=function(q$S,q$_,q$a){q$S._atlasID=this._inAtlasTextureKey.length;var q$R=q$S.uv.slice(),q$J=q$S.bitmap;this._inAtlasTextureKey.push(q$S),this._inAtlasTextureOriUVValue.push(q$R),this._inAtlasTextureBitmapValue.push(q$J),this.computeUVinAtlasTexture(q$S,q$R,q$_,q$a),q$S.bitmap=this._atlasCanvas},q$_.clear=function(){for(var q$S=0,q$_=this._inAtlasTextureKey.length;q$S<q$_;q$S++)this._inAtlasTextureKey[q$S].bitmap=this._inAtlasTextureBitmapValue[q$S],this._inAtlasTextureKey[q$S].uv=this._inAtlasTextureOriUVValue[q$S],this._inAtlasTextureKey[q$S]._atlasID=-1,this._inAtlasTextureKey[q$S].bitmap.lock=!1,this._inAtlasTextureKey[q$S].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},q$_.dispose=function(){this.clear(),this._atlasCanvas.destroy()},q$R(0,q$_,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),q$R(0,q$_,"texture",function(){return this._atlasCanvas}),q$R(0,q$_,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),q$V}(),q$IS=function(q$S){function q$a(){q$a.__super.call(this,q$a.__name2int,q$a.__int2name,q$a.__int2nameMap)}return q$C(q$a,"laya.webgl.shader.d2.ShaderDefines2D",q$d),q$a.__init__=function(){q$a.reg("TEXTURE2D",1),q$a.reg("COLOR2D",2),q$a.reg("PRIMITIVE",4),q$a.reg("GLOW_FILTER",8),q$a.reg("BLUR_FILTER",16),q$a.reg("COLOR_FILTER",32),q$a.reg("COLOR_ADD",64),q$a.reg("WORLDMAT",128),q$a.reg("FILLTEXTURE",256),q$a.reg("FSHIGHPRECISION",1024),q$a.reg("TXTALPHA",2048),q$a.reg("TXTCOMPRESS",4096)},q$a.reg=function(q$S,q$_){q$d._reg(q$S,q$_,q$a.__name2int,q$a.__int2name)},q$a.toText=function(q$S,q$_,q$a){return q$d._toText(q$S,q$_,q$a)},q$a.toInt=function(q$S){return q$d._toInt(q$S,q$a.__name2int)},q$a.TEXTURE2D=1,q$a.COLOR2D=2,q$a.PRIMITIVE=4,q$a.FILTERGLOW=8,q$a.FILTERBLUR=16,q$a.FILTERCOLOR=32,q$a.COLORADD=64,q$a.WORLDMAT=128,q$a.FILLTEXTURE=256,q$a.SKINMESH=512,q$a.SHADERDEFINE_FSHIGHPRECISION=1024,q$a.TXTALPHA=2048,q$a.TXTCOMPRESS=4096,q$a.__name2int={},q$a.__int2name=[],q$a.__int2nameMap=[],q$a}(),q$AS=(function(q$S){function q$k(q$S,q$_,q$a,q$R,q$J,q$V,q$W){q$k.__super.call(this,q$S,q$_,q$a,q$R,40,q$J,q$V,q$W)}q$C(q$k,"laya.webgl.shapes.Ellipse",q$aS)}(),function(q$S){function q$V(q$S,q$_,q$a,q$R,q$J){this._points=[],this.rebuild(q$a),q$V.__super.call(this,q$S,q$_,0,0,0,q$J,q$R,q$J,0)}q$C(q$V,"laya.webgl.shapes.Line",q$aS);var q$_=q$V.prototype;return q$_.rebuild=function(q$S){var q$_=q$S.length;q$_!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(q$_/2-1)),this.mFloat32Array=new Float32Array(5*q$_)),this._points.length=0;for(var q$a=NaN,q$R=NaN,q$J=-1,q$V=-1,q$W=q$S.length/2,q$k=0;q$k<q$W;q$k++)q$a=q$S[2*q$k],q$R=q$S[2*q$k+1],(.01<Math.abs(q$J-q$a)||.01<Math.abs(q$V-q$R))&&this._points.push(q$a,q$R),q$J=q$a,q$V=q$R},q$_.getData=function(q$S,q$_,q$a){var q$R=[],q$J=[];0<this.borderWidth&&this.createLine2(this._points,q$R,this.borderWidth,q$a,q$J,this._points.length/2),this.mUint16Array.set(q$R,0),this.mFloat32Array.set(q$J,0),q$S.append(this.mUint16Array),q$_.append(this.mFloat32Array)},q$V}()),q$XS=function(q$S){function q$L(q$S,q$_,q$a,q$R,q$J){this._points=[];for(var q$V=NaN,q$W=NaN,q$k=-1,q$z=-1,q$b=q$a.length/2-1,q$H=0;q$H<q$b;q$H++)q$V=q$a[2*q$H],q$W=q$a[2*q$H+1],(.01<Math.abs(q$k-q$V)||.01<Math.abs(q$z-q$W))&&this._points.push(q$V,q$W),q$k=q$V,q$z=q$W;q$V=q$a[2*q$b],q$W=q$a[2*q$b+1],q$k=this._points[0],q$z=this._points[1],(.01<Math.abs(q$k-q$V)||.01<Math.abs(q$z-q$W))&&this._points.push(q$V,q$W),q$L.__super.call(this,q$S,q$_,0,0,this._points.length/2,0,q$R,q$J)}q$C(q$L,"laya.webgl.shapes.LoopLine",q$aS);var q$_=q$L.prototype;return q$_.getData=function(q$S,q$_,q$a){if(0<this.borderWidth){for(var q$R=this.color,q$J=(q$R>>16&255)/255,q$V=(q$R>>8&255)/255,q$W=(255&q$R)/255,q$k=[],q$z=0,q$b=0,q$H=[],q$L=Math.floor(this._points.length/2),q$C=0;q$C<q$L;q$C++)q$z=this._points[2*q$C],q$b=this._points[2*q$C+1],q$k.push(this.x+q$z,this.y+q$b,q$J,q$V,q$W);this.createLoopLine(q$k,q$H,this.borderWidth,q$a+q$k.length/5),q$S.append(new Uint16Array(q$H)),q$_.append(new Float32Array(q$k))}},q$_.createLoopLine=function(q$S,q$_,q$a,q$R,q$J,q$V){q$S.length;var q$W=q$S.concat(),q$k=q$J||q$S,q$z=this.borderColor,q$b=(q$z>>16&255)/255,q$H=(q$z>>8&255)/255,q$L=(255&q$z)/255,q$C=[q$W[0],q$W[1]],q$G=[q$W[q$W.length-5],q$W[q$W.length-4]],q$t=q$G[0]+.5*(q$C[0]-q$G[0]),q$o=q$G[1]+.5*(q$C[1]-q$G[1]);q$W.unshift(q$t,q$o,0,0,0),q$W.push(q$t,q$o,0,0,0);var q$$,q$F,q$T,q$D,q$j,q$Q,q$m,q$q,q$N,q$n,q$l,q$B,q$I,q$A,q$X,q$h,q$u,q$K,q$P,q$M,q$r=q$W.length/5,q$e=q$R,q$g=q$a/2;q$T=q$W[0],q$D=q$W[1],q$n=q$T-(q$j=q$W[5]),q$N=(q$N=-(q$D-(q$Q=q$W[6])))/(q$M=Math.sqrt(q$N*q$N+q$n*q$n))*q$g,q$n=q$n/q$M*q$g,q$k.push(q$T-q$N,q$D-q$n,q$b,q$H,q$L,q$T+q$N,q$D+q$n,q$b,q$H,q$L);for(var q$x=1;q$x<q$r-1;q$x++)q$T=q$W[5*(q$x-1)],q$D=q$W[5*(q$x-1)+1],q$j=q$W[5*q$x],q$Q=q$W[5*q$x+1],q$m=q$W[5*(q$x+1)],q$q=q$W[5*(q$x+1)+1],q$n=q$T-q$j,q$B=q$j-q$m,q$X=(-(q$N=(q$N=-(q$D-q$Q))/(q$M=Math.sqrt(q$N*q$N+q$n*q$n))*q$g)+q$T)*(-(q$n=q$n/q$M*q$g)+q$Q)-(-q$N+q$j)*(-q$n+q$D),q$K=(-(q$l=(q$l=-(q$Q-q$q))/(q$M=Math.sqrt(q$l*q$l+q$B*q$B))*q$g)+q$m)*(-(q$B=q$B/q$M*q$g)+q$Q)-(-q$l+q$j)*(-q$B+q$q),q$P=(q$I=-q$n+q$D-(-q$n+q$Q))*(q$u=-q$l+q$j-(-q$l+q$m))-(q$h=-q$B+q$q-(-q$B+q$Q))*(q$A=-q$N+q$j-(-q$N+q$T)),Math.abs(q$P)<.1?(q$P+=10.1,q$k.push(q$j-q$N,q$Q-q$n,q$b,q$H,q$L,q$j+q$N,q$Q+q$n,q$b,q$H,q$L)):(((q$$=(q$A*q$K-q$u*q$X)/q$P)-q$j)*(q$$-q$j)+((q$F=(q$h*q$X-q$I*q$K)/q$P)-q$Q)+(q$F-q$Q),q$k.push(q$$,q$F,q$b,q$H,q$L,q$j-(q$$-q$j),q$Q-(q$F-q$Q),q$b,q$H,q$L));q$V&&(q$_=q$V);var q$s=this.edges+1;for(q$x=1;q$x<q$s;q$x++)q$_.push(q$e+2*(q$x-1),q$e+2*(q$x-1)+1,q$e+2*q$x+1,q$e+2*q$x+1,q$e+2*q$x,q$e+2*(q$x-1));return q$_.push(q$e+2*(q$x-1),q$e+2*(q$x-1)+1,q$e+1,q$e+1,q$e,q$e+2*(q$x-1)),q$k},q$L}(),q$hS=function(q$S){function q$W(q$S,q$_,q$a,q$R,q$J,q$V){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=q$n.create(),this._points=q$a.slice(0,q$a.length),q$W.__super.call(this,q$S,q$_,0,0,this._points.length/2,q$R,q$J,q$V)}q$C(q$W,"laya.webgl.shapes.Polygon",q$aS);var q$_=q$W.prototype;return q$_.rebuild=function(q$S){this._repaint||(this._points.length=0,this._points=this._points.concat(q$S))},q$_.setMatrix=function(q$S){q$S.copyTo(this._mat)},q$_.needUpdate=function(q$S){return this._repaint=this._mat.a==q$S.a&&this._mat.b==q$S.b&&this._mat.c==q$S.c&&this._mat.d==q$S.d&&this._mat.tx==q$S.tx&&this._mat.ty==q$S.ty,!this._repaint},q$_.getData=function(q$S,q$_,q$a){var q$R,q$J=0,q$V=this._points,q$W=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=q$a){for(this._start=q$a,q$R=[],q$W=this.earcutTriangles.length,q$J=0;q$J<q$W;q$J++)q$R.push(this.earcutTriangles[q$J]+q$a);this.mUint16Array=new Uint16Array(q$R)}}else{this._start=q$a,q$R=[];var q$k=[],q$z=[],q$b=this.color,q$H=(q$b>>16&255)/255,q$L=(q$b>>8&255)/255,q$C=(255&q$b)/255;for(q$W=Math.floor(q$V.length/2),q$J=0;q$J<q$W;q$J++)q$k.push(this.x+q$V[2*q$J],this.y+q$V[2*q$J+1],q$H,q$L,q$C),q$z.push(this.x+q$V[2*q$J],this.y+q$V[2*q$J+1]);for(this.earcutTriangles=q$RS.earcut(q$z,null,2),q$W=this.earcutTriangles.length,q$J=0;q$J<q$W;q$J++)q$R.push(this.earcutTriangles[q$J]+q$a);this.mUint16Array=new Uint16Array(q$R),this.mFloat32Array=new Float32Array(q$k)}q$S.append(this.mUint16Array),q$_.append(this.mFloat32Array)},q$W}(),q$uS=function(q$S){function q$V(){this._matrix=new q$n,this._matrix4=q$oS.defaultMatrix4.concat(),q$V.__super.call(this,1e4),this.shaderValue=new q$NS(0,0)}q$C(q$V,"laya.webgl.submit.SubmitCanvas",q$VS);var q$_=q$V.prototype;return q$_.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var q$S=q$TS.worldAlpha,q$_=q$TS.worldMatrix4,q$a=q$TS.worldMatrix,q$R=q$TS.worldFilters,q$J=q$TS.worldShaderDefines,q$V=this.shaderValue,q$W=this._matrix,q$k=this._matrix4,q$z=q$n.TEMP;return q$n.mul(q$W,q$a,q$z),q$k[0]=q$z.a,q$k[1]=q$z.b,q$k[4]=q$z.c,q$k[5]=q$z.d,q$k[12]=q$z.tx,q$k[13]=q$z.ty,q$TS.worldMatrix=q$z.clone(),q$TS.worldMatrix4=q$k,q$TS.worldAlpha=q$TS.worldAlpha*q$V.alpha,q$V.filters&&q$V.filters.length&&(q$TS.worldFilters=q$V.filters,q$TS.worldShaderDefines=q$V.defines),this._ctx_src.flush(),q$TS.worldAlpha=q$S,q$TS.worldMatrix4=q$_,q$TS.worldMatrix.destroy(),q$TS.worldMatrix=q$a,q$TS.worldFilters=q$R,q$TS.worldShaderDefines=q$J,1},q$_.releaseRender=function(){var q$S=q$V._cache;this._ctx_src=null,q$S[q$S._length++]=this},q$_.getRenderType=function(){return 10003},q$V.create=function(q$S,q$_,q$a){var q$R=q$V._cache._length?q$V._cache[--q$V._cache._length]:new q$V;q$R._ctx_src=q$S;var q$J=q$R.shaderValue;return q$J.alpha=q$_,q$J.defines.setValue(0),q$a&&q$a.length&&q$J.setFilters(q$a),q$R},q$V._cache=((q$V._cache=[])._length=0,q$V._cache),q$V}(),q$KS=function(q$S){function q$b(q$S){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===q$S&&(q$S=1e4),q$b.__super.call(this,q$S)}q$C(q$b,"laya.webgl.submit.SubmitTexture",q$VS);var q$_=q$b.prototype;return q$_.releaseRender=function(){var q$S=q$b._cache;(q$S[q$S._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},q$_.addTexture=function(q$S,q$_){this._texsID[this._texs.length]=q$S._uvID,this._texs.push(q$S),this._vbPos.push(q$_)},q$_.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var q$S=this.shaderValue.textureHost.bitmap;if(null!==q$S)for(var q$_=this._vb.getFloat32Array(),q$a=0,q$R=this._texs.length;q$a<q$R;q$a++){var q$J=this._texs[q$a];q$J.active();var q$V=q$J.uv;if(this._texsID[q$a]!==q$J._uvID){this._texsID[q$a]=q$J._uvID;var q$W=this._vbPos[q$a];q$_[q$W+2]=q$V[0],q$_[q$W+3]=q$V[1],q$_[q$W+6]=q$V[2],q$_[q$W+7]=q$V[3],q$_[q$W+10]=q$V[4],q$_[q$W+11]=q$V[5],q$_[q$W+14]=q$V[6],q$_[q$W+15]=q$V[7],this._vb.setNeedUpload()}q$J.bitmap!==q$S&&(this._isSameTexture=!1)}}},q$_.renderSubmit=function(){if(0===this._numEle)return q$b._shaderSet=!1,1;var q$S=this.shaderValue.textureHost;if(q$S){var q$_=q$S.source;if(!q$S.bitmap||!q$_)return q$b._shaderSet=!1,1;this.shaderValue.texture=q$_,q$S.alphaTexture&&q$S.alphaTexture.source&&(this.shaderValue.texture1=q$S.alphaTexture.source)}this._vb.bind_upload(this._ib);var q$a=q$jS.mainContext;if(q$f.activeBlendFunction!==this._blendFn&&(q$a.enable(3042),this._blendFn(q$a),q$f.activeBlendFunction=this._blendFn),q$X.drawCall++,q$X.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&q$MS.activeShader&&q$b._shaderSet?(q$MS.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&q$MS.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),q$b._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var q$R=q$S.bitmap,q$J=0,q$V=q$MS.activeShader,q$W=0,q$k=this._texs.length;q$W<q$k;q$W++){var q$z=this._texs[q$W];q$z.bitmap===q$R&&q$W+1!==q$k||(q$V.uploadTexture2D(q$z.source),q$a.drawElements(4,6*(q$W-q$J+1),5123,this._startIdx+6*q$J*q$oS.BYTES_PIDX),q$R=q$z.bitmap,q$J=q$W)}else q$a.drawElements(4,this._numEle,5123,this._startIdx);return 1},q$b.create=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$b._cache._length?q$b._cache[--q$b._cache._length]:new q$b;null==q$a&&((q$a=q$V._selfVb||(q$V._selfVb=q$dS.create(-1))).clear(),q$R=0),q$V._ib=q$_,q$V._vb=q$a,q$V._startIdx=q$R*q$oS.BYTES_PIDX,q$V._numEle=0;var q$W=q$S._nBlendType;q$V._blendFn=q$S._targets?q$f.targetFns[q$W]:q$f.fns[q$W],q$V.shaderValue=q$J,q$V.shaderValue.setValue(q$S._shader2D);var q$k=q$S._shader2D.filters;return q$k&&q$V.shaderValue.setFilters(q$k),q$V},q$b._cache=((q$b._cache=[])._length=0,q$b._cache),q$b._shaderSet=!0,q$b}(),q$PS=function(q$S){function q$F(){q$F.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}q$C(q$F,"laya.webgl.utils.MeshTexture",q$FS);var q$_=q$F.prototype;return q$_.addData=function(q$S,q$_,q$a,q$R,q$J,q$V){for(var q$W=q$S.length/2,q$k=this._vb.needSize(q$W*q$F.const_stride)>>2,q$z=this._vb.getFloat32Array(),q$b=0,q$H=0;q$H<q$W;q$H++){var q$L=q$S[q$b],q$C=q$S[q$b+1],q$G=q$L*q$R.a+q$C*q$R.c+q$R.tx,q$t=q$L*q$R.b+q$C*q$R.d+q$R.ty;q$z[q$k++]=q$G,q$z[q$k++]=q$t,q$z[q$k++]=q$_[q$b],q$z[q$k++]=q$_[q$b+1],q$b+=2}this._vb.setNeedUpload();var q$o=this.vertNum;if(0<q$o){(q$W=q$a.length)>q$F.tmpIdx.length&&(q$F.tmpIdx=new Uint16Array(q$W));for(var q$$=0;q$$<q$W;q$$++)q$F.tmpIdx[q$$]=q$a[q$$]+q$o;this._ib.appendU16Array(q$F.tmpIdx,q$a.length)}else this._ib.append(q$a);this._ib.setNeedUpload(),this.vertNum+=q$W,this.indexNum+=q$a.length},q$_.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},q$_.destroy=function(){this._ib.destroy(),this._vb.destroy()},q$F.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new q$F},q$F.const_stride=16,q$F._POOL=[],q$W(q$F,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),q$F}(),q$MS=function(q$S){function q$_(){q$_.__super.call(this),this.lock=!0}return q$C(q$_,"laya.webgl.shader.BaseShader",q$D),q$_.activeShader=null,q$_.bindShader=null,q$_}(),q$rS=function(q$_){function q$H(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===q$a&&(q$a=6408),void 0===q$R&&(q$R=5121),void 0===q$J&&(q$J=34041),void 0===q$V&&(q$V=!1),void 0===q$W&&(q$W=!1),void 0===q$k&&(q$k=-1),void 0===q$z&&(q$z=-1),this._type=1,this._w=q$S,this._h=q$_,this._surfaceFormat=q$a,this._surfaceType=q$R,this._depthStencilFormat=q$J,q$F.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=q$V,this._repeat=q$W,this._minFifter=q$k,this._magFifter=q$z,this._createWebGLRenderTarget(),this.bitmap.lock=!0,q$H.__super.call(this,this.bitmap,q$P.INV_UV)}q$C(q$H,"laya.webgl.resource.RenderTarget2D",q$_);var q$S=q$H.prototype;return q$m.imps(q$S,{"laya.resource.IDispose":!0}),q$S.getType=function(){return this._type},q$S.getTexture=function(){return this},q$S.size=function(q$S,q$_){this._w==q$S&&this._h==q$_||(this._w=q$S,this._h=q$_,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},q$S.release=function(){this.destroy()},q$S.recycle=function(){q$H.POOL.push(this)},q$S.start=function(){var q$S=q$jS.mainContext;return this._preRenderTarget=q$TS.curRenderTarget,q$TS.curRenderTarget=this,q$S.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(q$S.viewport(0,0,this._w,this._h),this._svWidth=q$TS.width,this._svHeight=q$TS.height,q$TS.width=this._w,q$TS.height=this._h,q$MS.activeShader=null),this},q$S.clear=function(q$S,q$_,q$a,q$R){void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=1);var q$J=q$jS.mainContext;q$J.clearColor(q$S,q$_,q$a,q$R);var q$V=16384;switch(this._depthStencilFormat){case 33189:q$V|=256;break;case 36168:q$V|=1024;break;case 34041:q$V|=256,q$V|=1024}q$J.clear(q$V)},q$S.end=function(){var q$S=q$jS.mainContext;q$S.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,q$TS.curRenderTarget=this._preRenderTarget,1==this._type?(q$S.viewport(0,0,this._svWidth,this._svHeight),q$TS.width=this._svWidth,q$TS.height=this._svHeight,q$MS.activeShader=null):q$S.viewport(0,0,q$m.stage.width,q$m.stage.height)},q$S.getData=function(q$S,q$_,q$a,q$R){var q$J=q$jS.mainContext;if(q$J.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===q$J.checkFramebufferStatus(36160)))return q$J.bindFramebuffer(36160,null),null;var q$V=new Uint8Array(this._w*this._h*4);return q$J.readPixels(q$S,q$_,q$a,q$R,this._surfaceFormat,this._surfaceType,q$V),q$J.bindFramebuffer(36160,null),q$V},q$S.destroy=function(q$S){void 0===q$S&&(q$S=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,q$_.prototype.destroy.call(this))},q$S.dispose=function(){},q$S._createWebGLRenderTarget=function(){this.bitmap=new q$pS(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(q$S){this.event("recovered")})},q$R(0,q$S,"surfaceFormat",function(){return this._surfaceFormat}),q$R(0,q$S,"magFifter",function(){return this._magFifter}),q$R(0,q$S,"surfaceType",function(){return this._surfaceType}),q$R(0,q$S,"mipMap",function(){return this._mipMap}),q$R(0,q$S,"depthStencilFormat",function(){return this._depthStencilFormat}),q$R(0,q$S,"minFifter",function(){return this._minFifter}),q$R(0,q$S,"source",function(){return this._alreadyResolved?q$m.superGet(q$P,this,"source"):null}),q$H.create=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){void 0===q$a&&(q$a=6408),void 0===q$R&&(q$R=5121),void 0===q$J&&(q$J=34041),void 0===q$V&&(q$V=!1),void 0===q$W&&(q$W=!1),void 0===q$k&&(q$k=-1),void 0===q$z&&(q$z=-1);var q$b=q$H.POOL.pop();return q$b||(q$b=new q$H(q$S,q$_)),q$b.bitmap&&q$b._w==q$S&&q$b._h==q$_&&q$b._surfaceFormat==q$a&&q$b._surfaceType==q$R&&q$b._depthStencilFormat==q$J&&q$b._mipMap==q$V&&q$b._repeat==q$W&&q$b._minFifter==q$k&&q$b._magFifter==q$z||(q$b._w=q$S,q$b._h=q$_,q$b._surfaceFormat=q$a,q$b._surfaceType=q$R,q$b._depthStencilFormat=q$J,q$F.isConchWebGL&&34041===q$b._depthStencilFormat&&(q$b._depthStencilFormat=33189),q$b._mipMap=q$V,q$b._repeat=q$W,q$b._minFifter=q$k,q$b._magFifter=q$z,q$b.release(),q$b._createWebGLRenderTarget()),q$b},q$H.TYPE2D=1,q$H.TYPE3D=2,q$H.POOL=[],q$H}(q$P),q$eS=function(q$S){function q$_(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,q$_.__super.call(this),q$_._gl=q$jS.mainContext}q$C(q$_,"laya.webgl.utils.Buffer",q$D);var q$a=q$_.prototype;return q$a._bind=function(){this.activeResource(),q$_._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(q$_._bindVertexBuffer=this._glBuffer),q$_._gl.bindBuffer(this._bufferType,q$_._bindActive[this._bufferType]=this._glBuffer),q$MS.activeShader=null)},q$a.recreateResource=function(){this._glBuffer||(this._glBuffer=q$_._gl.createBuffer()),this.completeCreate()},q$a.disposeResource=function(){this._glBuffer&&(q$jS.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},q$R(0,q$a,"bufferUsage",function(){return this._bufferUsage}),q$_._gl=null,q$_._bindActive={},q$_._bindVertexBuffer=null,q$_._enableAtributes=[],q$_}(),q$gS=function(q$S){function q$a(q$S){this.texcoord=null,this.offsetX=300,this.offsetY=0,q$a.__super.call(this,512,0);var q$_=8*q$oS.BYTES_PE;this.position=[2,5126,!1,q$_,0],this.texcoord=[2,5126,!1,q$_,2*q$oS.BYTES_PE],this.color=[4,5126,!1,q$_,4*q$oS.BYTES_PE]}return q$C(q$a,"laya.webgl.shader.d2.skinAnishader.SkinSV",q$NS),q$a}(),q$xS=function(q$S){function q$_(q$S){q$_.__super.call(this,2,0),this.color=[]}return q$C(q$_,"laya.webgl.shader.d2.value.Color2dSV",q$NS),q$_.prototype.setValue=function(q$S){q$S.fillStyle&&(this.color=q$S.fillStyle._color._color),q$S.strokeStyle&&(this.color=q$S.strokeStyle._color._color)},q$_}(),q$sS=function(q$S){function q$_(q$S){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=q$NS._TEXCOORD,q$_.__super.call(this,256,0)}q$C(q$_,"laya.webgl.shader.d2.value.FillTextureSV",q$NS);var q$a=q$_.prototype;return q$a.setValue=function(q$S){this.ALPHA=q$S.ALPHA,q$S.filters&&this.setFilters(q$S.filters)},q$a.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},q$_}(),q$US=function(q$S){function q$_(q$S){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=q$NS._TEXCOORD,void 0===q$S&&(q$S=0),q$_.__super.call(this,1,q$S)}q$C(q$_,"laya.webgl.shader.d2.value.TextureSV",q$NS);var q$a=q$_.prototype;return q$a.setValue=function(q$S){this.ALPHA=q$S.ALPHA,q$S.filters&&this.setFilters(q$S.filters)},q$a.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},q$_}(),q$fS=function(q$S){function q$_(q$S){this.a_color=null,this.u_pos=[0,0],q$_.__super.call(this,4,0),this.position=[2,5126,!1,5*q$oS.BYTES_PE,0],this.a_color=[3,5126,!1,5*q$oS.BYTES_PE,2*q$oS.BYTES_PE]}return q$C(q$_,"laya.webgl.shader.d2.value.PrimitiveSV",q$NS),q$_}(),q$YS=function(q$S){function q$_(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,q$_.__super.call(this)}q$C(q$_,"laya.webgl.atlas.AtlasWebGLCanvas",q$S);var q$a=q$_.prototype;return q$a.recreateResource=function(){var q$S=q$jS.mainContext,q$_=this._source=q$S.createTexture(),q$a=q$QS.curBindTexTarget,q$R=q$QS.curBindTexValue;q$QS.bindTexture(q$S,3553,q$_),q$S.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),q$S.texParameteri(3553,10241,9729),q$S.texParameteri(3553,10240,9729),q$S.texParameteri(3553,10242,33071),q$S.texParameteri(3553,10243,33071),q$a&&q$R&&q$QS.bindTexture(q$S,q$a,q$R),this.memorySize=this._w*this._h*4,this.completeCreate()},q$a.disposeResource=function(){this._source&&(q$jS.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},q$a.texSubImage2D=function(q$S,q$_,q$a){if(q$F.isFlash){this._flashCacheImage||(this._flashCacheImage=q$o.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var q$R=q$a.bitmapdata;this._flashCacheImage._image.copyPixels(q$R,0,0,q$R.width,q$R.height,q$S,q$_),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var q$J=q$jS.mainContext,q$V=q$QS.curBindTexTarget,q$W=q$QS.curBindTexValue;q$QS.bindTexture(q$J,3553,this._source),q$J.pixelStorei(37441,!0),0<=q$S-1&&q$J.texSubImage2D(3553,0,q$S-1,q$_,6408,5121,q$a),q$S+1<=this._w&&q$J.texSubImage2D(3553,0,q$S+1,q$_,6408,5121,q$a),0<=q$_-1&&q$J.texSubImage2D(3553,0,q$S,q$_-1,6408,5121,q$a),q$_+1<=this._h&&q$J.texSubImage2D(3553,0,q$S,q$_+1,6408,5121,q$a),q$J.texSubImage2D(3553,0,q$S,q$_,6408,5121,q$a),q$J.pixelStorei(37441,!1),q$V&&q$W&&q$QS.bindTexture(q$J,q$V,q$W)}},q$a.texSubImage2DPixel=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$jS.mainContext,q$W=q$QS.curBindTexTarget,q$k=q$QS.curBindTexValue;q$QS.bindTexture(q$V,3553,this._source);var q$z=new Uint8Array(q$J.data);q$V.pixelStorei(37441,!0),q$V.texSubImage2D(3553,0,q$S,q$_,q$a,q$R,6408,5121,q$z),q$V.pixelStorei(37441,!1),q$W&&q$k&&q$QS.bindTexture(q$V,q$W,q$k)},q$R(0,q$a,"width",q$S.prototype._$get_width,function(q$S){this._w=q$S}),q$R(0,q$a,"height",q$S.prototype._$get_height,function(q$S){this._h=q$S}),q$_}(q$a),q$iS=function(q$S){function q$J(){this.flipY=!0,this.alwaysChange=!1,q$J.__super.call(this)}q$C(q$J,"laya.webgl.resource.WebGLCanvas",q$a);var q$_=q$J.prototype;return q$_.getCanvas=function(){return this._canvas},q$_.clear=function(){this._ctx&&this._ctx.clear()},q$_.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},q$_._setContext=function(q$S){this._ctx=q$S},q$_.getContext=function(q$S,q$_){return this._ctx?this._ctx:this._ctx=q$J._createContext(this)},q$_.size=function(q$S,q$_){this._w==q$S&&this._h==q$_||(this._w=q$S,this._h=q$_,this._ctx&&this._ctx.size(q$S,q$_),this._canvas&&(this._canvas.height=q$_,this._canvas.width=q$S))},q$_.activeResource=function(q$S){void 0===q$S&&(q$S=!1),this._source||this.recreateResource()},q$_.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},q$_.disposeResource=function(){this._source&&!this.iscpuSource&&(q$jS.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},q$_.createWebGlTexture=function(){var q$S=q$jS.mainContext;this._canvas;var q$_=this._source=q$S.createTexture();this.iscpuSource=!1;var q$a=q$QS.curBindTexTarget,q$R=q$QS.curBindTexValue;q$QS.bindTexture(q$S,3553,q$_),q$S.pixelStorei(37440,this.flipY?1:0),q$J.premulAlpha&&q$S.pixelStorei(37441,!0),q$S.texImage2D(3553,0,6408,6408,5121,this._imgData),q$J.premulAlpha&&q$S.pixelStorei(37441,!1),q$S.texParameteri(3553,10240,9729),q$S.texParameteri(3553,10241,9729),q$S.texParameteri(3553,10242,33071),q$S.texParameteri(3553,10243,33071),q$S.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,q$a&&q$R&&q$QS.bindTexture(q$S,q$a,q$R)},q$_.reloadCanvasData=function(){var q$S=q$jS.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var q$_=q$QS.curBindTexTarget,q$a=q$QS.curBindTexValue;q$QS.bindTexture(q$S,3553,this._source),q$J.premulAlpha&&q$S.pixelStorei(37441,!0),q$S.texImage2D(3553,0,6408,6408,5121,this._imgData),q$J.premulAlpha&&q$S.pixelStorei(37441,!1),q$S.pixelStorei(37440,0),q$_&&q$a&&q$QS.bindTexture(q$S,q$_,q$a)},q$_.texSubImage2D=function(q$S,q$_,q$a){var q$R=q$jS.mainContext,q$J=q$QS.curBindTexTarget,q$V=q$QS.curBindTexValue;q$QS.bindTexture(q$R,3553,this._source),q$R.pixelStorei(37441,!0),q$R.texSubImage2D(3553,0,q$_,q$a,6408,5121,q$S._source),q$R.pixelStorei(37441,!1),q$J&&q$V&&q$QS.bindTexture(q$R,q$J,q$V)},q$_.toBase64=function(q$S,q$_,q$a){var q$R=null;this._canvas&&(q$R=this._canvas.toDataURL(q$S,q$_)),q$a.call(this,q$R)},q$R(0,q$_,"context",function(){return this._ctx}),q$R(0,q$_,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),q$R(0,q$_,"asBitmap",null,function(q$S){this._ctx&&(this._ctx.asBitmap=q$S)}),q$J._createContext=null,q$J.premulAlpha=!1,q$J}(),q$ZS=function(q$S){function q$V(q$S,q$_){this.CborderSize=12,q$V.__super.call(this),this.char=q$S,this.isSpace=" "===q$S,this.xs=q$_.scaleX,this.ys=q$_.scaleY,this.font=q$_.font.toString(),this.fontSize=q$_.font.size,this.fillColor=q$_.fillColor,this.borderColor=q$_.borderColor,this.lineWidth=q$_.lineWidth,this.underLine=q$_.underLine;var q$a,q$R=q$F.isConchApp;q$R?((q$a=ConchTextCanvas)._source=ConchTextCanvas,q$a._source.canvas=ConchTextCanvas):q$a=q$G.canvas.source,this.canvas=q$a,this._enableMerageInAtlas=!0,this._ctx=q$R?q$a:this.canvas.getContext("2d",void 0);var q$J=q$M.measureText(this.char,this.font);this.cw=q$J.width*this.xs,this.ch=(q$J.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new q$P(this)}q$C(q$V,"laya.webgl.resource.WebGLCharImage",q$a);var q$_=q$V.prototype;return q$m.imps(q$_,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),q$_.active=function(){this.texture.active()},q$_.recreateResource=function(){var q$S=q$F.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),q$S){var q$_=this.fontSize;1==this.xs&&1==this.ys||(q$_=parseInt(q$_*(this.xs>this.ys?this.xs:this.ys)+""));var q$a="normal 100 "+this.font;q$a=q$a.replace(q$V._fontSizeReg,q$_),this.borderColor&&(q$a+=" 1 "+this.borderColor),this._ctx.font=q$a,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,q$K.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var q$R=this._ctx.measureText(this.char);q$R||(q$R={width:16});var q$J=q$R.width+1;this._ctx.lineTo(q$J,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},q$_.onresize=function(q$S,q$_){this._w=q$S,this._h=q$_,this._allowMerageInAtlas=!0},q$_.clearAtlasSource=function(){},q$R(0,q$_,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),q$R(0,q$_,"atlasSource",function(){return this.canvas}),q$R(0,q$_,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(q$S){this._enableMerageInAtlas=q$S}),q$V.createOneChar=function(q$S,q$_){return new q$V(q$S,q$_)},q$V._fontSizeReg=new RegExp("\\d+(?=px)","g"),q$V}(),q$pS=function(q$S){function q$b(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){void 0===q$a&&(q$a=6408),void 0===q$R&&(q$R=5121),void 0===q$J&&(q$J=34041),void 0===q$V&&(q$V=!1),void 0===q$W&&(q$W=!1),void 0===q$k&&(q$k=-1),void 0===q$z&&(q$z=1),q$b.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=q$S,this._h=q$_,this._surfaceFormat=q$a,this._surfaceType=q$R,this._depthStencilFormat=q$J,this._mipMap=q$V,this._repeat=q$W,this._minFifter=q$k,this._magFifter=q$z}q$C(q$b,"laya.webgl.resource.WebGLRenderTarget",q$a);var q$_=q$b.prototype;return q$_.recreateResource=function(){var q$S=q$jS.mainContext;this._frameBuffer||(this._frameBuffer=q$S.createFramebuffer()),this._source||(this._source=q$S.createTexture());var q$_=q$QS.curBindTexTarget,q$a=q$QS.curBindTexValue;q$QS.bindTexture(q$S,3553,this._source),q$S.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var q$R=this._minFifter,q$J=this._magFifter,q$V=this._repeat?10497:33071,q$W=q$H.isPOT(this._w,this._h);if(q$W?(this._mipMap?-1!==q$R||(q$R=9987):-1!==q$R||(q$R=9729),-1!==q$J||(q$J=9729),q$S.texParameteri(3553,10241,q$R),q$S.texParameteri(3553,10240,q$J),q$S.texParameteri(3553,10242,q$V),q$S.texParameteri(3553,10243,q$V),this._mipMap&&q$S.generateMipmap(3553)):(-1!==q$R||(q$R=9729),-1!==q$J||(q$J=9729),q$S.texParameteri(3553,10241,q$R),q$S.texParameteri(3553,10240,q$J),q$S.texParameteri(3553,10242,33071),q$S.texParameteri(3553,10243,33071)),q$S.bindFramebuffer(36160,this._frameBuffer),q$S.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=q$S.createRenderbuffer()),q$S.bindRenderbuffer(36161,this._depthStencilBuffer),q$S.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:q$S.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:q$S.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:q$S.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}q$S.bindFramebuffer(36160,null),q$_&&q$a&&q$QS.bindTexture(q$S,q$_,q$a),q$S.bindRenderbuffer(36161,null),q$W&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},q$_.disposeResource=function(){this._frameBuffer&&(q$jS.mainContext.deleteTexture(this._source),q$jS.mainContext.deleteFramebuffer(this._frameBuffer),q$jS.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},q$R(0,q$_,"depthStencilBuffer",function(){return this._depthStencilBuffer}),q$R(0,q$_,"frameBuffer",function(){return this._frameBuffer}),q$b}(),q$cS=function(q$S){function q$k(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this.offsetX=0,this.offsetY=0,q$k.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=q$V,this.canvas=q$S,this._ctx=q$S.getContext("2d",void 0),this._w=q$R,this._h=q$J,this.offsetX=q$_,this.offsetY=q$a,this.src=q$W,this._enableMerageInAtlas=!0,q$s.enabled&&this._w<q$s.atlasLimitWidth&&this._h<q$s.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}q$C(q$k,"laya.webgl.resource.WebGLSubImage",q$a);var q$_=q$k.prototype;return q$m.imps(q$_,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),q$_.size=function(q$S,q$_){this._w=q$S,this._h=q$_,this._ctx&&this._ctx.size(q$S,q$_),this.canvas&&(this.canvas.height=q$_,this.canvas.width=q$S)},q$_.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},q$_.createWebGlTexture=function(){var q$S=q$jS.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var q$_=this._source=q$S.createTexture(),q$a=q$QS.curBindTexTarget,q$R=q$QS.curBindTexValue;q$QS.bindTexture(q$S,3553,q$_),q$S.pixelStorei(37441,!0),q$S.texImage2D(3553,0,6408,6408,5121,this.canvas),q$S.pixelStorei(37441,!1);var q$J=this.minFifter,q$V=this.magFifter,q$W=this.repeat?10497:33071,q$k=q$H.isPOT(this.width,this.height);q$k?(this.mipmap?-1!==q$J||(q$J=9987):-1!==q$J||(q$J=9729),-1!==q$V||(q$V=9729),q$S.texParameteri(3553,10240,q$V),q$S.texParameteri(3553,10241,q$J),q$S.texParameteri(3553,10242,q$W),q$S.texParameteri(3553,10243,q$W),this.mipmap&&q$S.generateMipmap(3553)):(-1!==q$J||(q$J=9729),-1!==q$V||(q$V=9729),q$S.texParameteri(3553,10241,q$J),q$S.texParameteri(3553,10240,q$V),q$S.texParameteri(3553,10242,33071),q$S.texParameteri(3553,10243,33071)),q$a&&q$R&&q$QS.bindTexture(q$S,q$a,q$R),this.canvas=null,q$k&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},q$_.disposeResource=function(){q$s.enabled&&this._allowMerageInAtlas||!this._source||(q$jS.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},q$_.clearAtlasSource=function(){},q$R(0,q$_,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),q$R(0,q$_,"atlasSource",function(){return this.canvas}),q$R(0,q$_,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(q$S){this._allowMerageInAtlas=q$S}),q$k}(),q$yS=function(q$S){function q$b(q$S,q$_,q$a,q$R){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,q$b.__super.call(this),!q$S||!q$_)throw"Shader Error";this._id=++q$b._count,this._vs=q$S,this._ps=q$_,this._nameMap=q$R||{},null!=q$a&&(q$b.sharders[q$a]=this)}q$C(q$b,"laya.webgl.shader.Shader",q$MS);var q$_=q$b.prototype;return q$_.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},q$_.disposeResource=function(){q$jS.mainContext.deleteShader(this._vshader),q$jS.mainContext.deleteShader(this._pshader),q$jS.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},q$_._compile=function(){if(!q$jS.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var q$S=[this._vs,this._ps],q$_=q$jS.mainContext;if(this._program=q$_.createProgram(),this._vshader=q$b._createShader(q$_,q$S[0],35633),this._pshader=q$b._createShader(q$_,q$S[1],35632),q$_.attachShader(this._program,this._vshader),q$_.attachShader(this._program,this._pshader),q$_.linkProgram(this._program),!q$F.isConchApp&&!q$_.getProgramParameter(this._program,35714))throw q$_.getProgramInfoLog(this._program);var q$a,q$R,q$J=0,q$V=0;for(q$V=q$F.isConchApp?q$_.getProgramParameterEx(this._vs,this._ps,"",35721):q$_.getProgramParameter(this._program,35721),q$J=0;q$J<q$V;q$J++){var q$W=null;q$a={vartype:"attribute",glfun:null,ivartype:0,attrib:q$W=q$F.isConchApp?q$_.getActiveAttribEx(this._vs,this._ps,"",q$J):q$_.getActiveAttrib(this._program,q$J),location:q$_.getAttribLocation(this._program,q$W.name),name:q$W.name,type:q$W.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(q$a)}var q$k=0;for(q$k=q$F.isConchApp?q$_.getProgramParameterEx(this._vs,this._ps,"",35718):q$_.getProgramParameter(this._program,35718),q$J=0;q$J<q$k;q$J++){var q$z=null;q$z=q$F.isConchApp?q$_.getActiveUniformEx(this._vs,this._ps,"",q$J):q$_.getActiveUniform(this._program,q$J),0<(q$a={vartype:"uniform",glfun:null,ivartype:1,attrib:q$W,location:q$_.getUniformLocation(this._program,q$z.name),name:q$z.name,type:q$z.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(q$a.name=q$a.name.substr(0,q$a.name.length-3),q$a.isArray=!0,q$a.location=q$_.getUniformLocation(this._program,q$a.name)),this._params.push(q$a)}for(q$J=0,q$R=this._params.length;q$J<q$R;q$J++)if((q$a=this._params[q$J]).indexOfParams=q$J,q$a.index=1,q$a.value=[q$a.location,null],q$a.codename=q$a.name,q$a.name=this._nameMap[q$a.codename]?this._nameMap[q$a.codename]:q$a.codename,(this._paramsMap[q$a.name]=q$a)._this=this,q$a.uploadedValue=[],"attribute"!==q$a.vartype)switch(q$a.type){case 5124:q$a.fun=q$a.isArray?this._uniform1iv:this._uniform1i;break;case 5126:q$a.fun=q$a.isArray?this._uniform1fv:this._uniform1f;break;case 35664:q$a.fun=q$a.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:q$a.fun=q$a.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:q$a.fun=q$a.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:q$a.fun=this._uniform_sampler2D;break;case 35680:q$a.fun=this._uniform_samplerCube;break;case 35676:q$a.glfun=q$_.uniformMatrix4fv,q$a.fun=this._uniformMatrix4fv;break;case 35670:q$a.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else q$a.fun=this._attribute}},q$_.getUniform=function(q$S){return this._paramsMap[q$S]},q$_._attribute=function(q$S,q$_){var q$a=q$jS.mainContext,q$R=q$eS._enableAtributes,q$J=q$S.location;return q$R[q$J]||q$a.enableVertexAttribArray(q$J),q$a.vertexAttribPointer(q$J,q$_[0],q$_[1],q$_[2],q$_[3],q$_[4]+this._offset),q$R[q$J]=q$eS._bindVertexBuffer,1},q$_._uniform1f=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_?(q$jS.mainContext.uniform1f(q$S.location,q$a[0]=q$_),1):0},q$_._uniform1fv=function(q$S,q$_){if(q$_.length<4){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]||q$a[2]!==q$_[2]||q$a[3]!==q$_[3]?(q$jS.mainContext.uniform1fv(q$S.location,q$_),q$a[0]=q$_[0],q$a[1]=q$_[1],q$a[2]=q$_[2],q$a[3]=q$_[3],1):0}return q$jS.mainContext.uniform1fv(q$S.location,q$_),1},q$_._uniform_vec2=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]?(q$jS.mainContext.uniform2f(q$S.location,q$a[0]=q$_[0],q$a[1]=q$_[1]),1):0},q$_._uniform_vec2v=function(q$S,q$_){if(q$_.length<2){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]||q$a[2]!==q$_[2]||q$a[3]!==q$_[3]?(q$jS.mainContext.uniform2fv(q$S.location,q$_),q$a[0]=q$_[0],q$a[1]=q$_[1],q$a[2]=q$_[2],q$a[3]=q$_[3],1):0}return q$jS.mainContext.uniform2fv(q$S.location,q$_),1},q$_._uniform_vec3=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]||q$a[2]!==q$_[2]?(q$jS.mainContext.uniform3f(q$S.location,q$a[0]=q$_[0],q$a[1]=q$_[1],q$a[2]=q$_[2]),1):0},q$_._uniform_vec3v=function(q$S,q$_){return q$jS.mainContext.uniform3fv(q$S.location,q$_),1},q$_._uniform_vec4=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]||q$a[2]!==q$_[2]||q$a[3]!==q$_[3]?(q$jS.mainContext.uniform4f(q$S.location,q$a[0]=q$_[0],q$a[1]=q$_[1],q$a[2]=q$_[2],q$a[3]=q$_[3]),1):0},q$_._uniform_vec4v=function(q$S,q$_){return q$jS.mainContext.uniform4fv(q$S.location,q$_),1},q$_._uniformMatrix2fv=function(q$S,q$_){return q$jS.mainContext.uniformMatrix2fv(q$S.location,!1,q$_),1},q$_._uniformMatrix3fv=function(q$S,q$_){return q$jS.mainContext.uniformMatrix3fv(q$S.location,!1,q$_),1},q$_._uniformMatrix4fv=function(q$S,q$_){return q$jS.mainContext.uniformMatrix4fv(q$S.location,!1,q$_),1},q$_._uniform1i=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_?(q$jS.mainContext.uniform1i(q$S.location,q$a[0]=q$_),1):0},q$_._uniform1iv=function(q$S,q$_){return q$jS.mainContext.uniform1iv(q$S.location,q$_),1},q$_._uniform_ivec2=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]?(q$jS.mainContext.uniform2i(q$S.location,q$a[0]=q$_[0],q$a[1]=q$_[1]),1):0},q$_._uniform_ivec2v=function(q$S,q$_){return q$jS.mainContext.uniform2iv(q$S.location,q$_),1},q$_._uniform_vec3i=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]||q$a[2]!==q$_[2]?(q$jS.mainContext.uniform3i(q$S.location,q$a[0]=q$_[0],q$a[1]=q$_[1],q$a[2]=q$_[2]),1):0},q$_._uniform_vec3vi=function(q$S,q$_){return q$jS.mainContext.uniform3iv(q$S.location,q$_),1},q$_._uniform_vec4i=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]||q$a[2]!==q$_[2]||q$a[3]!==q$_[3]?(q$jS.mainContext.uniform4i(q$S.location,q$a[0]=q$_[0],q$a[1]=q$_[1],q$a[2]=q$_[2],q$a[3]=q$_[3]),1):0},q$_._uniform_vec4vi=function(q$S,q$_){return q$jS.mainContext.uniform4iv(q$S.location,q$_),1},q$_._uniform_sampler2D=function(q$S,q$_){var q$a=q$jS.mainContext,q$R=q$S.uploadedValue;return null==q$R[0]?(q$R[0]=this._curActTexIndex,q$a.uniform1i(q$S.location,this._curActTexIndex),q$a.activeTexture(q$b._TEXTURES[this._curActTexIndex]),q$QS.bindTexture(q$a,3553,q$_),this._curActTexIndex++,1):(q$a.activeTexture(q$b._TEXTURES[q$R[0]]),q$QS.bindTexture(q$a,3553,q$_),0)},q$_._uniform_samplerCube=function(q$S,q$_){var q$a=q$jS.mainContext,q$R=q$S.uploadedValue;return null==q$R[0]?(q$R[0]=this._curActTexIndex,q$a.uniform1i(q$S.location,this._curActTexIndex),q$a.activeTexture(q$b._TEXTURES[this._curActTexIndex]),q$QS.bindTexture(q$a,34067,q$_),this._curActTexIndex++,1):(q$a.activeTexture(q$b._TEXTURES[q$R[0]]),q$QS.bindTexture(q$a,34067,q$_),0)},q$_._noSetValue=function(q$S){console.log("no....:"+q$S.name)},q$_.uploadOne=function(q$S,q$_){this.activeResource(),q$QS.UseProgram(this._program);var q$a=this._paramsMap[q$S];q$a.fun.call(this,q$a,q$_)},q$_.uploadTexture2D=function(q$S){q$X.shaderCall++;var q$_=q$jS.mainContext;q$_.activeTexture(33984),q$QS.bindTexture(q$_,3553,q$S)},q$_.uploadTexture2D1=function(q$S){q$X.shaderCall++;var q$_=q$jS.mainContext;q$_.activeTexture(33985),q$QS.bindTexture(q$_,3553,q$S)},q$_.upload=function(q$S,q$_){q$MS.activeShader=q$MS.bindShader=this,this._lastUseFrameCount===q$X.loopCount||this.activeResource(),q$QS.UseProgram(this._program),this._reCompile?(q$_=this._params,this._reCompile=!1):q$_=q$_||this._params;q$jS.mainContext;for(var q$a,q$R,q$J=q$_.length,q$V=0,q$W=0;q$W<q$J;q$W++)null!==(q$R=q$S[(q$a=q$_[q$W]).name])&&(q$V+=q$a.fun.call(this,q$a,q$R));q$X.shaderCall+=q$V},q$_.uploadArray=function(q$S,q$_,q$a){q$MS.activeShader=this,(q$MS.bindShader=this).activeResource(),q$QS.UseProgram(this._program);this._params;for(var q$R,q$J,q$V=0,q$W=q$_-2;0<=q$W;q$W-=2)(q$J=this._paramsMap[q$S[q$W]])&&null!=(q$R=q$S[q$W+1])&&(q$a&&q$a[q$J.name]&&q$a[q$J.name].bind(),q$V+=q$J.fun.call(this,q$J,q$R));q$X.shaderCall+=q$V},q$_.getParams=function(){return this._params},q$b.getShader=function(q$S){return q$b.sharders[q$S]},q$b.create=function(q$S,q$_,q$a,q$R){return new q$b(q$S,q$_,q$a,q$R)},q$b.withCompile=function(q$S,q$_,q$a,q$R){if(q$a&&q$b.sharders[q$a])return q$b.sharders[q$a];var q$J=q$b._preCompileShader[2e-4*q$S];if(!q$J)throw new Error("withCompile shader err!"+q$S);return q$J.createShader(q$_,q$a,q$R)},q$b.withCompile2D=function(q$S,q$_,q$a,q$R,q$J){if(q$R&&q$b.sharders[q$R])return q$b.sharders[q$R];var q$V=q$b._preCompileShader[2e-4*q$S+q$_];if(!q$V)throw new Error("withCompile shader err!"+q$S+" "+q$_);return q$V.createShader(q$a,q$R,q$J)},q$b.addInclude=function(q$S,q$_){q$DS.addInclude(q$S,q$_)},q$b.preCompile=function(q$S,q$_,q$a,q$R){var q$J=2e-4*q$S;q$b._preCompileShader[q$J]=new q$DS(q$J,q$_,q$a,q$R)},q$b.preCompile2D=function(q$S,q$_,q$a,q$R,q$J){var q$V=2e-4*q$S+q$_;q$b._preCompileShader[q$V]=new q$DS(q$V,q$a,q$R,q$J)},q$b._createShader=function(q$S,q$_,q$a){var q$R=q$S.createShader(q$a);return q$S.shaderSource(q$R,q$_),q$S.compileShader(q$R),q$R},q$b._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],q$b._count=0,q$b._preCompileShader={},q$b.SHADERNAME2ID=2e-4,q$b.sharders=((q$b.sharders=[]).length=32,q$b.sharders),q$W(q$b,["nameKey",function(){return this.nameKey=new q$h}]),q$b}(),q$ES=function(q$S){function q$_(){this._maxsize=0,this._upload=!0,this._uploadSize=0,q$_.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}q$C(q$_,"laya.webgl.utils.Buffer2D",q$S);var q$a=q$_.prototype;return q$a.needSize=function(q$S){var q$_=this._byteLength;if(q$S){var q$a=this._byteLength+q$S;q$a<=this._buffer.byteLength||this._resizeBuffer(q$a<<1,!0),this._byteLength=q$a}return q$_},q$a._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),q$X.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,q$eS._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),q$eS._gl.bufferSubData(this._bufferType,0,this._buffer)},q$a._bufferSubData=function(q$S,q$_,q$a){if(void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),this._maxsize=Math.max(this._maxsize,this._byteLength),q$X.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,q$eS._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),q$_||q$a){var q$R=this._buffer.slice(q$_,q$a);q$eS._gl.bufferSubData(this._bufferType,q$S,q$R)}else q$eS._gl.bufferSubData(this._bufferType,q$S,this._buffer)},q$a._checkArrayUse=function(){},q$a._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},q$a._bind_subUpload=function(q$S,q$_,q$a){return void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(q$S,q$_,q$a),!0)},q$a._resizeBuffer=function(q$S,q$_){if(q$S<this._buffer.byteLength)return this;if(this.memorySize=q$S,q$_&&this._buffer&&0<this._buffer.byteLength){var q$a=new ArrayBuffer(q$S);new Uint8Array(q$a).set(new Uint8Array(this._buffer),0),this._buffer=q$a}else this._buffer=new ArrayBuffer(q$S);return this._checkArrayUse(),this._upload=!0,this},q$a.append=function(q$S){this._upload=!0;var q$_,q$a;q$_=q$S.byteLength,q$S instanceof Uint8Array?(this._resizeBuffer(this._byteLength+q$_,!0),q$a=new Uint8Array(this._buffer,this._byteLength)):q$S instanceof Uint16Array?(this._resizeBuffer(this._byteLength+q$_,!0),q$a=new Uint16Array(this._buffer,this._byteLength)):q$S instanceof Float32Array&&(this._resizeBuffer(this._byteLength+q$_,!0),q$a=new Float32Array(this._buffer,this._byteLength)),q$a.set(q$S,0),this._byteLength+=q$_,this._checkArrayUse()},q$a.appendU16Array=function(q$S,q$_){this._resizeBuffer(this._byteLength+2*q$_,!0);for(var q$a=new Uint16Array(this._buffer,this._byteLength,q$_),q$R=0;q$R<q$_;q$R++)q$a[q$R]=q$S[q$R];this._byteLength+=2*q$_,this._checkArrayUse()},q$a.appendEx=function(q$S,q$_){this._upload=!0;var q$a;q$a=q$S.byteLength,this._resizeBuffer(this._byteLength+q$a,!0),new q$_(this._buffer,this._byteLength).set(q$S,0),this._byteLength+=q$a,this._checkArrayUse()},q$a.appendEx2=function(q$S,q$_,q$a,q$R){void 0===q$R&&(q$R=1),this._upload=!0;var q$J,q$V;q$J=q$a*q$R,this._resizeBuffer(this._byteLength+q$J,!0),q$V=new q$_(this._buffer,this._byteLength);var q$W=0;for(q$W=0;q$W<q$a;q$W++)q$V[q$W]=q$S[q$W];this._byteLength+=q$J,this._checkArrayUse()},q$a.getBuffer=function(){return this._buffer},q$a.setNeedUpload=function(){this._upload=!0},q$a.getNeedUpload=function(){return this._upload},q$a.upload=function(){var q$S=this._bind_upload();return q$eS._gl.bindBuffer(this._bufferType,null),q$eS._bindActive[this._bufferType]=null,q$MS.activeShader=null,q$S},q$a.subUpload=function(q$S,q$_,q$a){void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0);var q$R=this._bind_subUpload();return q$eS._gl.bindBuffer(this._bufferType,null),q$eS._bindActive[this._bufferType]=null,q$MS.activeShader=null,q$R},q$a.disposeResource=function(){q$S.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},q$a.clear=function(){this._byteLength=0,this._upload=!0},q$R(0,q$a,"bufferLength",function(){return this._buffer.byteLength}),q$R(0,q$a,"byteLength",null,function(q$S){this._byteLength!==q$S&&(q$S<=this._buffer.byteLength||this._resizeBuffer(2*q$S+256,!0),this._byteLength=q$S)}),q$_.__int__=function(q$S){q$vS.QuadrangleIB=q$vS.create(35044),q$$S.fillIBQuadrangle(q$vS.QuadrangleIB,16)},q$_.FLOAT32=4,q$_.SHORT=2,q$_}(q$eS),q$OS=(function(q$_){function q$a(q$S){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,q$a.__super.call(this,9)}q$C(q$a,"laya.webgl.shader.d2.value.GlowSV",q$_);var q$S=q$a.prototype;q$S.setValue=function(q$S){q$_.prototype.setValue.call(this,q$S)},q$S.clear=function(){q$_.prototype.clear.call(this)}}(q$US),function(q$S){function q$_(q$S){q$_.__super.call(this,64),this.defines.add(64)}q$C(q$_,"laya.webgl.shader.d2.value.TextSV",q$S);var q$a=q$_.prototype;return q$a.release=function(){(q$_.pool[q$_._length++]=this).clear()},q$a.clear=function(){q$S.prototype.clear.call(this)},q$_.create=function(){return q$_._length?q$_.pool[--q$_._length]:new q$_(null)},q$_.pool=[],q$_._length=0,q$_}(q$US)),q$wS=function(q$S){function q$J(q$S,q$_,q$a,q$R){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,q$J.__super.call(this,q$S,q$_,q$a,q$R)}q$C(q$J,"laya.webgl.shader.d2.Shader2X",q$S);var q$_=q$J.prototype;return q$_.upload2dQuick1=function(q$S){this.upload(q$S,this._params2dQuick1||this._make2dQuick1())},q$_._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var q$S,q$_=this._params,q$a=0,q$R=q$_.length;q$a<q$R;q$a++)q$S=q$_[q$a],(q$F.isFlash||"size"!==q$S.name&&"position"!==q$S.name&&"texcoord"!==q$S.name)&&this._params2dQuick1.push(q$S)}return this._params2dQuick1},q$_.disposeResource=function(){q$S.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},q$_.upload2dQuick2=function(q$S){this.upload(q$S,this._params2dQuick2||this._make2dQuick2())},q$_._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var q$S,q$_=this._params,q$a=0,q$R=q$_.length;q$a<q$R;q$a++)q$S=q$_[q$a],(q$F.isFlash||"size"!==q$S.name)&&this._params2dQuick2.push(q$S)}return this._params2dQuick2},q$J.create=function(q$S,q$_,q$a,q$R){return new q$J(q$S,q$_,q$a,q$R)},q$J}(q$yS),q$vS=function(q$S){function q$_(q$S){this._uint8Array=null,this._uint16Array=null,void 0===q$S&&(q$S=35044),q$_.__super.call(this),this._bufferUsage=q$S,this._bufferType=34963,q$F.isFlash||(this._buffer=new ArrayBuffer(8))}q$C(q$_,"laya.webgl.utils.IndexBuffer2D",q$ES);var q$a=q$_.prototype;return q$a._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},q$a.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},q$a.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},q$a.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},q$_.QuadrangleIB=null,q$_.create=function(q$S){return void 0===q$S&&(q$S=35044),new q$_(q$S)},q$_}(),q$dS=function(q$S){function q$a(q$S,q$_){this._floatArray32=null,this._vertexStride=0,q$a.__super.call(this),this._vertexStride=q$S,this._bufferUsage=q$_,this._bufferType=34962,q$F.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}q$C(q$a,"laya.webgl.utils.VertexBuffer2D",q$S);var q$_=q$a.prototype;return q$_.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},q$_.bind=function(q$S){q$S&&q$S._bind(),this._bind()},q$_.insertData=function(q$S,q$_){this.getFloat32Array().set(q$S,q$_),this._upload=!0},q$_.bind_upload=function(q$S){q$S._bind_upload()||q$S._bind(),this._bind_upload()||this._bind()},q$_._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},q$_.disposeResource=function(){q$S.prototype.disposeResource.call(this)},q$_.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},q$R(0,q$_,"vertexStride",function(){return this._vertexStride}),q$a.create=function(q$S,q$_){return void 0===q$_&&(q$_=35048),new q$a(q$S,q$_)},q$a}(q$ES),q$S_=function(q$S){function q$k(q$S,q$_,q$a,q$R,q$J,q$V){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===q$a&&(q$a=6408),void 0===q$R&&(q$R=!0),q$k.__super.call(this,q$S,q$_),q$S){if(this._format=q$a,this._mipmap=q$R,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof q$S)this._url=q$S,this._src=q$S,this._image=new q$G.window.Image,q$_&&(q$_.onload&&(this.onload=q$_.onload),q$_.onerror&&(this.onerror=q$_.onerror),q$_.onCreate&&q$_.onCreate(this)),this._image.crossOrigin=q$S&&0==q$S.indexOf("data:")?null:"",q$S&&(this._image.src=q$S);else if(q$S instanceof ArrayBuffer){this._src=q$_,this._url=this._src;var q$W=new q$z(q$S);q$W.readUTFBytes(4),q$W.readUTFBytes(2),q$W.getInt16();q$W.endian="bigEndian",this._w=q$W.getInt16(),this._h=q$W.getInt16();q$W.getInt16(),q$W.getInt16();this._image=new Uint8Array(q$S,q$W.pos),this._format=q$jS.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,q$s.enabled&&this._w<q$s.atlasLimitWidth&&this._h<q$s.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(q$S instanceof Uint8Array))return this._src=q$_,this._url=this._src,this._image=q$S.source||q$S,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=q$_,this._url=this._src,this._w=q$J,this._h=q$V,this._image=q$S,this._format=0===q$a?q$S.byteLength/(q$J*q$V)==4?6408:6407:q$a}this._$5__enableMerageInAtlas=!0}}q$C(q$k,"laya.webgl.resource.WebGLImage",q$o);var q$_=q$k.prototype;return q$m.imps(q$_,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),q$_._init_=function(q$S,q$_){},q$_._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var q$S=q$jS.mainContext,q$_=this._source=q$S.createTexture(),q$a=q$QS.curBindTexTarget,q$R=q$QS.curBindTexValue;q$QS.bindTexture(q$S,3553,q$_);var q$J=this.minFifter,q$V=this.magFifter,q$W=this.repeat?10497:33071,q$k=q$H.isPOT(this._w,this._h),q$z=!1;switch(q$k?(this.mipmap?-1!==q$J||(q$J=9987):-1!==q$J||(q$J=9729),-1!==q$V||(q$V=9729),q$S.texParameteri(3553,10241,q$J),q$S.texParameteri(3553,10240,q$V),q$S.texParameteri(3553,10242,q$W),q$S.texParameteri(3553,10243,q$W),this.mipmap&&q$S.generateMipmap(3553)):(-1!==q$J||(q$J=9729),-1!==q$V||(q$V=9729),q$S.texParameteri(3553,10241,q$J),q$S.texParameteri(3553,10240,q$V),q$S.texParameteri(3553,10242,33071),q$S.texParameteri(3553,10243,33071)),q$S.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&q$S.pixelStorei(q$S.UNPACK_ALIGNMENT,1),q$S.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&q$S.pixelStorei(q$S.UNPACK_ALIGNMENT,1),q$S.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:q$z=!0,q$S.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case q$jS.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:q$z=!0,q$S.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}q$S.pixelStorei(37441,!1),q$a&&q$R&&q$QS.bindTexture(q$S,q$a,q$R),this.uri||(this.uri=this._url),q$z?this.memorySize=this._image.length:q$k&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},q$_.recreateResource=function(){var q$S=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var q$_=this;this._image=new q$G.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(q$_._needReleaseAgain)return q$_._needReleaseAgain=!1,q$_._image.onload=null,void(q$_._image=null);q$_._allowMerageInAtlas&&q$_._enableMerageInAtlas?(q$S.memorySize=0,q$S._recreateLock=!1):q$_._createWebGlTexture(),q$_.completeCreate()},this._image.src=this._src}},q$_.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&q$jS.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},q$_.onresize=function(){this._w=this._image.width,this._h=this._image.height,q$s.enabled&&this._w<q$s.atlasLimitWidth&&this._h<q$s.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},q$_.clearAtlasSource=function(){this._image=null},q$R(0,q$_,"format",function(){return this._format}),q$R(0,q$_,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(q$S){this._$5__enableMerageInAtlas=q$S}),q$R(0,q$_,"mipmap",function(){return this._mipmap}),q$R(0,q$_,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),q$R(0,q$_,"atlasSource",function(){return this._image}),q$R(0,q$_,"onload",null,function(q$S){var q$_=this;this._onload=q$S,this._image&&(this._image.onload=null!=this._onload?function(){q$_.onresize(),q$_._onload()}:null)}),q$R(0,q$_,"onerror",null,function(q$S){var q$_=this;this._onerror=q$S,this._image&&(this._image.onerror=null!=this._onerror?function(){q$_._onerror()}:null)}),q$k}();q$m.__init([q$GS,q$x,q$qS,q$DS])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(q$S,q$_){"use strict";for(var q$a in Object.defineProperty(q$_,"__esModule",{value:!0}),Laya){var q$R=Laya[q$a];q$R&&q$R.__isclass&&(q$_[q$a]=q$R)}}),function(q$V,q$S,q$R){q$R.un,q$R.uns;var q$J=q$R.static,q$W=q$R.class,q$k=q$R.getset,q$z=(q$R.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),q$t=laya.utils.ClassUtils,q$L=(laya.events.Event,laya.utils.HTMLChar),q$b=laya.net.Loader,q$H=(laya.display.Node,laya.maths.Rectangle),q$C=laya.renders.Render,q$G=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),q$o=laya.utils.Stat,q$M=laya.display.Text,q$$=laya.resource.Texture,q$F=laya.net.URL,q$T=laya.utils.Utils,q$D=function(){function q$G(){}return q$W(q$G,"laya.html.utils.HTMLParse"),q$G.parse=function(q$S,q$_,q$a){q$_=(q$_="<root>"+(q$_=q$_.replace(/<br>/g,"<br/>"))+"</root>").replace(q$G.spacePattern,q$G.char255);var q$R=q$T.parseXMLFromString(q$_);q$G._parseXML(q$S,q$R.childNodes[0].childNodes,q$a)},q$G._parseXML=function(q$S,q$_,q$a,q$R){var q$J=0,q$V=0;if(q$_.join||q$_.item)for(q$J=0,q$V=q$_.length;q$J<q$V;++q$J)q$G._parseXML(q$S,q$_[q$J],q$a,q$R);else{var q$W,q$k,q$z;if(3==q$_.nodeType)return void(q$S instanceof laya.html.dom.HTMLDivElement?(null==q$_.nodeName&&(q$_.nodeName="#text"),q$k=q$_.nodeName.toLowerCase(),0<(q$z=q$_.textContent.replace(/^\s+|\s+$/g,"")).length&&(q$W=q$t.getInstance(q$k))&&(q$S.addChild(q$W),q$W.innerTEXT=q$z.replace(q$G.char255AndOneSpacePattern," "))):0<(q$z=q$_.textContent.replace(/^\s+|\s+$/g,"")).length&&(q$S.innerTEXT=q$z.replace(q$G.char255AndOneSpacePattern," ")));if("#comment"==(q$k=q$_.nodeName.toLowerCase()))return;if(q$W=q$t.getInstance(q$k)){(q$W=q$S.addChild(q$W)).URI=q$a,q$W.href=q$R;var q$b=q$_.attributes;if(q$b&&0<q$b.length)for(q$J=0,q$V=q$b.length;q$J<q$V;++q$J){var q$H=q$b[q$J],q$L=q$H.nodeName,q$C=q$H.value;q$W._setAttributes(q$L,q$C)}q$G._parseXML(q$W,q$_.childNodes,q$a,q$W.href)}else q$G._parseXML(q$S,q$_.childNodes,q$a,q$R)}},q$G.char255=String.fromCharCode(255),q$G.spacePattern=/&nbsp;|&#160;/g,q$G.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),q$G}(),q$j=function(){function q$P(){}return q$W(q$P,"laya.html.utils.Layout"),q$P.later=function(q$S){null==q$P._will&&(q$P._will=[],q$R.stage.frameLoop(1,null,function(){if(!(q$P._will.length<1)){for(var q$S=0;q$S<q$P._will.length;q$S++)laya.html.utils.Layout.layout(q$P._will[q$S]);q$P._will.length=0}})),q$P._will.push(q$S)},q$P.layout=function(q$S){if(!q$S||!q$S._style)return null;if(0==(512&q$S._style._type))return null;q$S.getStyle()._type&=-513;var q$_=q$P._multiLineLayout(q$S);return q$C.isConchApp&&q$S.layaoutCallNative&&q$S.layaoutCallNative(),q$_},q$P._multiLineLayout=function(q$S){if(q$M.RightToLeft)return q$P._multiLineLayout2(q$S);var q$_=new Array;q$S._addChildsToLayout(q$_);var q$a,q$R,q$J,q$V,q$W,q$k=0,q$z=q$_.length,q$b=q$S._getCSSStyle(),q$H=q$b.letterSpacing,q$L=q$b.leading,q$C=q$b.lineHeight,q$G=q$b._widthAuto()||!q$b.wordWrap,q$t=q$G?999999:q$S.width,q$o=(q$S.height,0),q$$=q$b.italic?q$b.fontSize/3:0,q$F=q$b._getAlign(),q$T=q$b._getValign(),q$D=0!==q$T||0!==q$F||0!=q$C,q$j=0,q$Q=0,q$m=0,q$q=0,q$N=new Array,q$n=q$N[0]=new q$r,q$l=!1,q$B=!1;q$n.h=0,q$b.italic&&(q$t-=q$b.fontSize/3);var q$I=0,q$A=!0;function q$X(){q$n.y=q$Q,q$Q+=q$n.h+q$L,0==q$n.h&&(q$Q+=q$C),q$n.mWidth=q$I,q$I=0,q$n=new q$r,q$N.push(q$n),q$n.h=0,q$l=!(q$A=!(q$j=0))}for(q$k=0;q$k<q$z;q$k++)if(null!=(q$a=q$_[q$k]))if(q$A=!1,q$a instanceof laya.html.dom.HTMLBrElement)q$X(),q$n.y=q$Q;else{if(q$a._isChar()){if((q$V=q$a).isWord)q$l=q$B||"\n"===q$V.char,q$n.wordStartIndex=q$n.elements.length;else{if(q$m=q$V.width+q$V.style.letterSpacin,0<q$N.length&&q$t<q$j+q$m&&0<q$n.wordStartIndex){var q$h;q$h=q$n.elements.length-q$n.wordStartIndex+1,q$n.elements.length=q$n.wordStartIndex,q$k-=q$h,q$X();continue}q$l=!1,q$I+=q$V.width}q$m=q$V.width+q$H,q$q=q$V.height,q$B=!1,(q$l=q$l||q$t<q$j+q$m)&&q$X(),q$n.minTextHeight=Math.min(q$n.minTextHeight,q$a.height)}else q$R=q$a._getCSSStyle(),q$W=q$a,q$J=q$R.padding,0===q$R._getCssFloat()||(q$D=!0),q$l=q$B||q$R.lineElement,q$m=q$W.width*q$W._style._tf.scaleX+q$J[1]+q$J[3]+q$H,q$q=q$W.height*q$W._style._tf.scaleY+q$J[0]+q$J[2],q$B=q$R.lineElement,(q$l=q$l||q$t<q$j+q$m&&q$R.wordWrap)&&q$X();q$n.elements.push(q$a),q$n.h=Math.max(q$n.h,q$q),q$a.x=q$j,q$a.y=q$Q,q$j+=q$m,q$n.w=q$j-q$H,q$n.y=q$Q,q$o=Math.max(q$j+q$$,q$o)}else q$A||(q$j+=q$P.DIV_ELEMENT_PADDING),q$n.wordStartIndex=q$n.elements.length;if(q$Q=q$n.y+q$n.h,q$D){var q$u=0,q$K=q$t;for(q$G&&0<q$S.width&&(q$K=q$S.width),q$k=0,q$z=q$N.length;q$k<q$z;q$k++)q$N[q$k].updatePos(0,q$K,q$k,q$u,q$F,q$T,q$C),q$u+=Math.max(q$C,q$N[q$k].h+q$L);q$Q=q$u}return q$G&&(q$S.width=q$o),q$Q>q$S.height&&(q$S.height=q$Q),[q$o,q$Q]},q$P._multiLineLayout2=function(q$S){var q$_=new Array;q$S._addChildsToLayout(q$_);var q$a,q$R,q$J,q$V,q$W,q$k=0,q$z=q$_.length,q$b=q$S._getCSSStyle(),q$H=q$b.letterSpacing,q$L=q$b.leading,q$C=q$b.lineHeight,q$G=q$b._widthAuto()||!q$b.wordWrap,q$t=q$G?999999:q$S.width,q$o=(q$S.height,0),q$$=q$b.italic?q$b.fontSize/3:0,q$F=2-q$b._getAlign(),q$T=q$b._getValign(),q$D=0!==q$T||0!=q$F||0!=q$C,q$j=0,q$Q=0,q$m=0,q$q=0,q$N=new Array,q$n=q$N[0]=new q$r,q$l=!1,q$B=!1;q$n.h=0,q$b.italic&&(q$t-=q$b.fontSize/3);var q$I=0,q$A=!0;function q$X(){q$n.y=q$Q,q$Q+=q$n.h+q$L,0==q$n.h&&(q$Q+=q$C),q$n.mWidth=q$I,q$I=0,q$n=new q$r,q$N.push(q$n),q$n.h=0,q$l=!(q$A=!(q$j=0))}for(q$k=0;q$k<q$z;q$k++)if(null!=(q$a=q$_[q$k]))if(q$A=!1,q$a instanceof laya.html.dom.HTMLBrElement)q$X(),q$n.y=q$Q;else{if(q$a._isChar()){if((q$V=q$a).isWord)q$l=q$B||"\n"===q$V.char,q$n.wordStartIndex=q$n.elements.length;else{if(0<q$N.length&&q$t<q$j+q$m&&0<q$n.wordStartIndex){var q$h;q$h=q$n.elements.length-q$n.wordStartIndex+1,q$n.elements.length=q$n.wordStartIndex,q$k-=q$h,q$X();continue}q$l=!1,q$I+=q$V.width}q$m=q$V.width+q$H,q$q=q$V.height,q$B=!1,(q$l=q$l||q$t<q$j+q$m)&&q$X(),q$n.minTextHeight=Math.min(q$n.minTextHeight,q$a.height)}else q$R=q$a._getCSSStyle(),q$W=q$a,q$J=q$R.padding,0===q$R._getCssFloat()||(q$D=!0),q$l=q$B||q$R.lineElement,q$m=q$W.width*q$W._style._tf.scaleX+q$J[1]+q$J[3]+q$H,q$q=q$W.height*q$W._style._tf.scaleY+q$J[0]+q$J[2],q$B=q$R.lineElement,(q$l=q$l||q$t<q$j+q$m&&q$R.wordWrap)&&q$X();q$n.elements.push(q$a),q$n.h=Math.max(q$n.h,q$q),q$a.x=q$j,q$a.y=q$Q,q$j+=q$m,q$n.w=q$j-q$H,q$n.y=q$Q,q$o=Math.max(q$j+q$$,q$o)}else q$A||(q$j+=q$P.DIV_ELEMENT_PADDING),q$n.wordStartIndex=q$n.elements.length;if(q$Q=q$n.y+q$n.h,q$D){var q$u=0,q$K=q$t;for(q$k=0,q$z=q$N.length;q$k<q$z;q$k++)q$N[q$k].updatePos(0,q$K,q$k,q$u,q$F,q$T,q$C),q$u+=Math.max(q$C,q$N[q$k].h+q$L);q$Q=q$u}for(q$G&&(q$S.width=q$o),q$Q>q$S.height&&(q$S.height=q$Q),q$k=0,q$z=q$N.length;q$k<q$z;q$k++)q$N[q$k].revertOrder(q$t);return[q$o,q$Q]},q$P._will=null,q$P.DIV_ELEMENT_PADDING=0,q$P}(),q$r=function(){function q$S(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}q$W(q$S,"laya.html.utils.LayoutLine");var q$_=q$S.prototype;return q$_.updatePos=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){var q$k,q$z=0;0<this.elements.length&&(q$z=(q$k=this.elements[this.elements.length-1]).x+q$k.width-this.elements[0].x);var q$b=0,q$H=NaN;1===q$J&&(q$b=(q$_-q$z)/2),2===q$J&&(q$b=q$_-q$z),0===q$W||0!=q$V||(q$V=1);for(var q$L=0,q$C=this.elements.length;q$L<q$C;q$L++){var q$G=(q$k=this.elements[q$L])._getCSSStyle();switch(0!==q$b&&(q$k.x+=q$b),q$G._getValign()){case 0:q$k.y=q$R;break;case 1:var q$t=0;99999!=this.minTextHeight&&(q$t=this.minTextHeight);var q$o=(q$t+q$W)/2;q$o=Math.max(q$o,this.h),q$H=(laya.html.dom.HTMLImageElement,q$R+q$o-q$k.height),q$k.y=q$H;break;case 2:q$k.y=q$R+(q$W-q$k.height)}}},q$_.revertOrder=function(q$S){var q$_;if(0<this.elements.length){var q$a,q$R=0;for(q$a=this.elements.length,q$R=0;q$R<q$a;q$R++)(q$_=this.elements[q$R]).x=q$S-q$_.x-q$_.width}},q$S}(),q$Q=function(q$a){function q$_(){this.URI=null,this._href=null,q$_.__super.call(this),this._text=q$_._EMPTYTEXT,this.setStyle(new q$z(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}q$W(q$_,"laya.html.dom.HTMLElement",q$a);var q$S=q$_.prototype;return q$S.layaoutCallNative=function(){var q$S=0;if(this._childs&&0<(q$S=this._childs.length))for(var q$_=0;q$_<q$S;q$_++)this._childs[q$_].layaoutCallNative&&this._childs[q$_].layaoutCallNative();var q$a=this._getWords();q$a?laya.html.dom.HTMLElement.fillWords(this,q$a,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},q$S.appendChild=function(q$S){return this.addChild(q$S)},q$S._getWords2=function(){var q$S=this._text.text;if(!q$S||0===q$S.length)return null;var q$_,q$a,q$R=0,q$J=0;if(this._text.drawWords)q$a=this._text.drawWords;else{for(q$J=(q$_=q$S.split(" ")).length-1,q$a=[],q$R=0;q$R<q$J;q$R++)q$a.push(q$_[q$R]," ");0<=q$J&&q$a.push(q$_[q$J]),this._text.drawWords=q$a}var q$V,q$W=this._text.words;if(q$W&&q$W.length===q$a.length)return q$W;null===q$W&&(this._text.words=q$W=[]),q$W.length=q$a.length;var q$k=this.style,q$z=q$k.font;for(q$R=0,q$J=q$a.length;q$R<q$J;q$R++){q$V=q$T.measureText(q$a[q$R],q$z);var q$b=q$W[q$R]=new q$L(q$a[q$R],q$V.width,q$V.height||q$k.fontSize,q$k);if(1<q$b.char.length&&(q$b.charNum=q$b.char),this.href){var q$H=new q$G;this.addChild(q$H),q$b.setSprite(q$H)}}return q$W},q$S._getWords=function(){if(!q$M.CharacterCache)return this._getWords2();var q$S=this._text.text;if(!q$S||0===q$S.length)return null;var q$_,q$a=this._text.words;if(q$a&&q$a.length===q$S.length)return q$a;null===q$a&&(this._text.words=q$a=[]),q$a.length=q$S.length;for(var q$R=this.style,q$J=q$R.font,q$V=0,q$W=q$S.length;q$V<q$W;q$V++)if(q$_=q$T.measureText(q$S.charAt(q$V),q$J)){var q$k=q$a[q$V]=new q$L(q$S.charAt(q$V),q$_.width,q$_.height||q$R.fontSize,q$R);if(this.href){var q$z=new q$G;this.addChild(q$z),q$k.setSprite(q$z)}}else console.warn("_getWords size is null"+q$S.charAt(q$V),q$J);return q$a},q$S.showLinkSprite=function(){var q$S=this._text.words;if(q$S)for(var q$_,q$a,q$R=[],q$J=0;q$J<q$S.length;q$J++)q$a=q$S[q$J],(q$_=new q$G).graphics.drawRect(0,0,q$a.width,q$a.height,"#ff0000"),q$_.width=q$a.width,q$_.height=q$a.height,this.addChild(q$_),q$R.push(q$_)},q$S._layoutLater=function(){var q$S=this.style;512&q$S._type||(q$S.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&q$S.block?(q$j.later(this),q$S._type|=512):this.parent&&this.parent._layoutLater())},q$S._setAttributes=function(q$S,q$_){switch(q$S){case"style":return void this.style.cssText(q$_);case"class":return void(this.className=q$_)}q$a.prototype._setAttributes.call(this,q$S,q$_)},q$S.updateHref=function(){if(null!=this._href){var q$S=this._getWords();if(q$S)for(var q$_,q$a,q$R=0;q$R<q$S.length;q$R++)(q$a=(q$_=q$S[q$R]).getSprite())&&(q$a.size(q$_.width,q$_.height),q$a.on("click",this,this.onLinkHandler))}},q$S.onLinkHandler=function(q$S){switch(q$S.type){case"click":for(var q$_=this;q$_;)q$_.event("link",[this.href]),q$_=q$_.parent}},q$S.formatURL=function(q$S){return this.URI?q$F.formatURL(q$S,this.URI?this.URI.path:null):q$S},q$k(0,q$S,"href",function(){return this._href},function(q$S){null!=(this._href=q$S)&&(this._getCSSStyle().underLine=1,this.updateHref())}),q$k(0,q$S,"color",null,function(q$S){this.style.color=q$S}),q$k(0,q$S,"onClick",null,function(q$S){q$R._runScript("fn=function(event){"+q$S+";}"),this.on("click",this,void 0)}),q$k(0,q$S,"id",null,function(q$S){q$m.document.setElementById(q$S,this)}),q$k(0,q$S,"innerTEXT",function(){return this._text.text},function(q$S){this.text=q$S}),q$k(0,q$S,"style",function(){return this._style}),q$k(0,q$S,"text",function(){return this._text.text},function(q$S){this._text==q$_._EMPTYTEXT?this._text={text:q$S,words:null}:(this._text.text=q$S,this._text.words&&(this._text.words.length=0)),q$C.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),q$k(0,q$S,"parent",q$a.prototype._$get_parent,function(q$S){if(q$S instanceof laya.html.dom.HTMLElement){var q$_=q$S;this.URI||(this.URI=q$_.URI),this.style.inherit(q$_.style)}q$R.superSet(q$G,this,"parent",q$S)}),q$k(0,q$S,"className",null,function(q$S){this.style.attrs(q$m.document.styleSheets["."+q$S])}),q$_.fillWords=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){q$S.graphics.clear();for(var q$k=0,q$z=q$_.length;q$k<q$z;q$k++){var q$b=q$_[q$k];q$S.graphics.fillText(q$b.char,q$b.x+q$a,q$b.y+q$R,q$J,q$V,"left",q$W)}},q$_._EMPTYTEXT={text:null,words:null},q$_}(q$G),q$_=(function(q$S){function q$_(){q$_.__super.call(this),this.style.lineElement=!0,this.style.block=!0}q$W(q$_,"laya.html.dom.HTMLBrElement",q$Q)}(),function(q$S){function q$_(){this.contextHeight=NaN,this.contextWidth=NaN,q$_.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}q$W(q$_,"laya.html.dom.HTMLDivElement",q$S);var q$a=q$_.prototype;return q$a.appendHTML=function(q$S){q$D.parse(this,q$S,this.URI),this.layout()},q$a._addChildsToLayout=function(q$_){var q$S=this._getWords();if(null==q$S&&0==this._childs.length)return!1;q$S&&q$S.forEach(function(q$S){q$_.push(q$S)});for(var q$a=!0,q$R=0,q$J=this._childs.length;q$R<q$J;q$R++){var q$V=this._childs[q$R];q$a?q$a=!1:q$_.push(null),q$V._addToLayout(q$_)}return!0},q$a._addToLayout=function(q$S){this.layout()},q$a.layout=function(){if(this.style){this.style._type|=512;var q$S=q$j.layout(this);if(q$S){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new q$H);var q$_=this._$P.mHtmlBounds;q$_.x=q$_.y=0,q$_.width=this.contextWidth=q$S[0],q$_.height=this.contextHeight=q$S[1],this.setBounds(q$_)}}},q$k(0,q$a,"height",function(){return this._height?this._height:this.contextHeight},q$S.prototype._$set_height),q$k(0,q$a,"innerHTML",null,function(q$S){this.destroyChildren(),this.appendHTML(q$S)}),q$k(0,q$a,"width",function(){return this._width?this._width:this.contextWidth},function(q$S){var q$_=!1;q$_=0===q$S?q$S!=this._width:q$S!=this.width,q$R.superSet(q$Q,this,"width",q$S),q$_&&this.layout()}),q$_}(q$Q)),q$m=function(q$S){function q$_(){this.all=new Array,this.styleSheets=q$z.styleSheets,q$_.__super.call(this)}q$W(q$_,"laya.html.dom.HTMLDocument",q$Q);var q$a=q$_.prototype;return q$a.getElementById=function(q$S){return this.all[q$S]},q$a.setElementById=function(q$S,q$_){this.all[q$S]=q$_},q$J(q$_,["document",function(){return this.document=new q$_}]),q$_}();(function(q$S){function q$_(){this._tex=null,this._url=null,this._renderArgs=[],q$_.__super.call(this),this.style.block=!0}q$W(q$_,"laya.html.dom.HTMLImageElement",q$Q);var q$a=q$_.prototype;q$a._addToLayout=function(q$S){!this._style.absolute&&q$S.push(this)},q$a.render=function(q$S,q$_,q$a){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(q$o.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,q$S.ctx.drawTexture2(q$_,q$a,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},q$a.layaoutCallNative=function(){var q$S=0;if(this._childs&&0<(q$S=this._childs.length))for(var q$_=0;q$_<q$S;q$_++)this._childs[q$_].layaoutCallNative&&this._childs[q$_].layaoutCallNative()},q$k(0,q$a,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(q$S){this._width!==q$S&&(this._width=q$S,this._style.width=q$S,this.repaint())}),q$k(0,q$a,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(q$S){this._height!==q$S&&(this._height=q$S,this._style.height=q$S,this.repaint())}),q$a.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),q$b.clearCache(this,this._url),this._tex=null),q$Q.prototype.destroy.call(this)},q$a.onloaded=function(){var q$S=this._style;q$S&&!q$S.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),q$S&&!q$S.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),q$C.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},q$a._loadImageComplete=function(q$S,q$_,q$a){if(!this._destroyed)if(null!=q$a)if(q$a instanceof ArrayBuffer){var q$R=new DataView(q$a);new laya.webgl.resource.WebGLImage(new Uint8Array(q$a,8),q$S,0,!1,q$R.getUint32(0),q$R.getUint32(4));this.onloaded()}else if(q$a instanceof q$$)q$b.imgMgrSet[q$S]=q$_,q$V.imgMgrLock(q$S,q$b.imgMgrSet[q$S]),this._url=q$S,this._tex=q$a,q$b.keepCache(this,q$S),q$b.cacheRes(q$S,this._tex),this.onloaded();else{var q$J=-1!=q$S.indexOf(".png",q$S.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(q$a,q$S,q$J,!1,q$a.width,q$a.height);this.onloaded()}else this.event("error","Load image failed")},q$k(0,q$a,"src",null,function(q$S){(q$S=this.formatURL(q$S),this._url!=q$S)&&(null!=this._tex&&(q$b.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=q$S,(this._tex=q$b.getRes(q$S))?(q$b.keepCache(this,q$S),this.onloaded()):q$V.imgMgrLoad(q$S,this._loadImageComplete.bind(this),2,!1))})})(),function(q$S){function q$_(){this.type=null,q$_.__super.call(this),this.visible=!1}q$W(q$_,"laya.html.dom.HTMLLinkElement",q$S);var q$a=q$_.prototype;q$a._onload=function(q$S){switch(this.type){case"text/css":q$z.parseCSS(q$S,this.URI)}},q$k(0,q$a,"href",q$S.prototype._$get_href,function(q$S){var q$_=this;q$S=this.formatURL(q$S),this.URI=new q$F(q$S);var q$a=new q$b;q$a.once("complete",null,function(q$S){q$_._onload(q$S)}),q$a.load(q$S,"text")}),q$_._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(q$Q),function(q$S){function q$_(){q$_.__super.call(this),this.visible=!1}q$W(q$_,"laya.html.dom.HTMLStyleElement",q$S),q$k(0,q$_.prototype,"text",q$S.prototype._$get_text,function(q$S){q$z.parseCSS(q$S,null)})}(q$Q),function(q$S){function q$_(){q$_.__super.call(this),this._getCSSStyle().valign="middle"}q$W(q$_,"laya.html.dom.HTMLIframeElement",q$S),q$k(0,q$_.prototype,"href",q$S.prototype._$get_href,function(q$a){var q$R=this;q$a=this.formatURL(q$a);var q$S=new q$b;q$S.once("complete",null,function(q$S){var q$_=q$R.URI;q$R.URI=new q$F(q$a),q$R.innerHTML=q$S,!q$_||(q$R.URI=q$_)}),q$S.load(q$a,"text")})}(q$_)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(q$S,q$_){"use strict";for(var q$a in Object.defineProperty(q$_,"__esModule",{value:!0}),Laya){var q$R=Laya[q$a];q$R&&q$R.__isclass&&(q$_[q$a]=q$R)}}),function(q$J,q$S,q$o){q$o.un,q$o.uns;var q$R=q$o.static,q$V=q$o.class,q$W=q$o.getset,q$a=(q$o.__newvec,laya.display.Animation),q$$=(laya.utils.Browser,laya.utils.ClassUtils),q$k=laya.filters.ColorFilter,q$z=laya.utils.Ease,q$b=laya.events.Event,q$H=(laya.events.EventDispatcher,laya.display.css.Font),q$L=laya.display.FrameAnimation,q$_=laya.display.Graphics,q$C=laya.utils.Handler,q$G=laya.display.Input,q$T=laya.net.Loader,q$t=(laya.display.Node,laya.maths.Point),q$F=laya.maths.Rectangle,q$D=laya.renders.Render,q$j=laya.display.Sprite,q$Q=laya.display.Text,q$m=laya.resource.Texture,q$q=laya.utils.Tween,q$N=laya.utils.Utils,q$n=laya.utils.WeakObject;q$o.interface("laya.ui.IItem"),q$o.interface("laya.ui.ISelect"),q$o.interface("laya.ui.IRender"),q$o.interface("laya.ui.IComponent"),q$o.interface("laya.ui.IBox","IComponent");var q$l=function(){function q$S(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return q$V(q$S,"laya.ui.LayoutStyle"),q$R(q$S,["EMPTY",function(){return this.EMPTY=new q$S}]),q$S}(),q$B=function(){function q$S(){}return q$V(q$S,"laya.ui.Styles"),q$S.labelColor="#000000",q$S.buttonStateNum=3,q$S.scrollBarMinNum=15,q$S.scrollBarDelayTime=500,q$R(q$S,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),q$S}(),q$I=function(){function q$J(){}return q$V(q$J,"laya.ui.UIUtils"),q$J.fillArray=function(q$S,q$_,q$a){var q$R=q$S.concat();if(q$_)for(var q$J=q$_.split(","),q$V=0,q$W=Math.min(q$R.length,q$J.length);q$V<q$W;q$V++){var q$k=q$J[q$V];q$R[q$V]="true"==q$k||"false"!=q$k&&q$k,null!=q$a&&(q$R[q$V]=q$a(q$k))}return q$R},q$J.toColor=function(q$S){return q$N.toHexColor(q$S)},q$J.gray=function(q$S,q$_){void 0===q$_&&(q$_=!0),q$_?q$J.addFilter(q$S,q$J.grayFilter):q$J.clearFilter(q$S,q$k)},q$J.addFilter=function(q$S,q$_){var q$a=q$S.filters||[];q$a.push(q$_),q$S.filters=q$a},q$J.clearFilter=function(q$S,q$_){var q$a=q$S.filters;if(null!=q$a&&0<q$a.length){for(var q$R=q$a.length-1;-1<q$R;q$R--){var q$J=q$a[q$R];q$o.__typeof(q$J,q$_)&&q$a.splice(q$R,1)}q$S.filters=q$a}},q$J._getReplaceStr=function(q$S){return q$J.escapeSequence[q$S]},q$J.adptString=function(q$S){return q$S.replace(/\\(\w)/g,q$J._getReplaceStr)},q$J.getBindFun=function(q$S){var q$_=q$J._funMap.get(q$S);if(null==q$_){var q$a='"'+q$S+'"',q$R="(function(data){if(data==null)return;with(data){try{\nreturn "+(q$a=q$a.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";q$_=q$o._runScript(q$R),q$J._funMap.set(q$S,q$_)}return q$_},q$R(q$J,["grayFilter",function(){return this.grayFilter=new q$k([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new q$n}]),q$J}(),q$A=function(){function q$S(){}return q$V(q$S,"UIConfig"),q$S.touchScrollEnable=!0,q$S.mouseWheelEnable=!0,q$S.showButtons=!0,q$S.popupBgColor="#000000",q$S.popupBgAlpha=.5,q$S.closeDialogOnSide=!0,q$S}(),q$X=function(q$a){function q$F(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,q$F.__super.call(this),this._weakKeys=[]}q$V(q$F,"laya.ui.AutoBitmap",q$a);var q$S=q$F.prototype;return q$S.destroy=function(){if(q$T.clearObject(this,this._weakKey),this._weakKeys){for(var q$S=0,q$_=this._weakKeys.length;q$S<q$_;++q$S)q$T.clearObject(this,this._weakKeys[q$S]);this._weakKeys=null}q$a.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},q$S._setChanged=function(){this._isChanged||(this._isChanged=!0,q$o.timer.callLater(this,this.changeSource))},q$S.changeSource=function(){this._isChanged=!1;var q$S=this._source;if(q$S&&q$S.bitmap){var q$_=this.width,q$a=this.height,q$R=this._sizeGrid,q$J=q$S.sourceWidth,q$V=q$S.sourceHeight;if(!q$R||q$J===q$_&&q$V===q$a)this.cleanByTexture(q$S,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,q$_,q$a);else{q$T.clearObject(this,this._weakKey),q$S.$_GID||(q$S.$_GID=q$N.getGID());var q$W=q$S.$_GID+"."+q$_+"."+q$a+"."+q$R.join("."),q$k=q$T.findObject(q$W);if(q$N.isOKCmdList(q$k))return this._weakKey=q$W,q$T.keepObject(this,this._weakKey),void(this.cmds=q$k);this.clear();var q$z,q$b,q$H=q$R[0],q$L=q$R[1],q$C=q$R[2],q$G=q$R[3],q$t=q$R[4],q$o=!1;if(q$_==q$J&&(q$G=q$L=0),q$a==q$V&&(q$H=q$C=0),q$_<q$G+q$L){var q$$=q$_;q$o=!0,q$_=q$G+q$L,this.save(),this.clipRect(0,0,q$$,q$a)}q$G&&q$H&&(q$z=q$F.getTexture(q$S,0,0,q$G,q$H),q$b=this._weakKeys[0],q$z?(q$b!=q$z.weakKey&&(q$T.clearObject(this,q$b),q$T.keepObject(this,q$z.weakKey),this._weakKeys[0]=q$z.weakKey),this.drawTexture(q$z,0,0,q$G,q$H)):(q$T.clearObject(this,q$b),this._weakKeys[0]="")),q$L&&q$H&&(q$z=q$F.getTexture(q$S,q$J-q$L,0,q$L,q$H),q$b=this._weakKeys[1],q$z?(q$b!=q$z.weakKey&&(q$T.clearObject(this,q$b),q$T.keepObject(this,q$z.weakKey),this._weakKeys[1]=q$z.weakKey),this.drawTexture(q$z,q$_-q$L,0,q$L,q$H)):(q$T.clearObject(this,q$b),this._weakKeys[1]="")),q$G&&q$C&&(q$z=q$F.getTexture(q$S,0,q$V-q$C,q$G,q$C),q$b=this._weakKeys[2],q$z?(q$b!=q$z.weakKey&&(q$T.clearObject(this,q$b),q$T.keepObject(this,q$z.weakKey),this._weakKeys[2]=q$z.weakKey),this.drawTexture(q$z,0,q$a-q$C,q$G,q$C)):(q$T.clearObject(this,q$b),this._weakKeys[2]="")),q$L&&q$C&&(q$z=q$F.getTexture(q$S,q$J-q$L,q$V-q$C,q$L,q$C),q$b=this._weakKeys[3],q$z?(q$b!=q$z.weakKey&&(q$T.clearObject(this,q$b),q$T.keepObject(this,q$z.weakKey),this._weakKeys[3]=q$z.weakKey),this.drawTexture(q$z,q$_-q$L,q$a-q$C,q$L,q$C)):(q$T.clearObject(this,q$b),this._weakKeys[3]="")),q$H&&(q$z=q$F.getTexture(q$S,q$G,0,q$J-q$G-q$L,q$H),q$b=this._weakKeys[4],q$z?(q$b!=q$z.weakKey&&(q$T.clearObject(this,q$b),q$T.keepObject(this,q$z.weakKey),this._weakKeys[4]=q$z.weakKey),this.drawBitmap(q$t,q$z,q$G,0,q$_-q$G-q$L,q$H)):(q$T.clearObject(this,q$b),this._weakKeys[4]="")),q$C&&(q$z=q$F.getTexture(q$S,q$G,q$V-q$C,q$J-q$G-q$L,q$C),q$b=this._weakKeys[5],q$z?(q$b!=q$z.weakKey&&(q$T.clearObject(this,q$b),q$T.keepObject(this,q$z.weakKey),this._weakKeys[5]=q$z.weakKey),this.drawBitmap(q$t,q$z,q$G,q$a-q$C,q$_-q$G-q$L,q$C)):(q$T.clearObject(this,q$b),this._weakKeys[5]="")),q$G&&(q$z=q$F.getTexture(q$S,0,q$H,q$G,q$V-q$H-q$C),q$b=this._weakKeys[6],q$z?(q$b!=q$z.weakKey&&(q$T.clearObject(this,q$b),q$T.keepObject(this,q$z.weakKey),this._weakKeys[6]=q$z.weakKey),this.drawBitmap(q$t,q$z,0,q$H,q$G,q$a-q$H-q$C)):(q$T.clearObject(this,q$b),this._weakKeys[6]="")),q$L&&(q$z=q$F.getTexture(q$S,q$J-q$L,q$H,q$L,q$V-q$H-q$C),q$b=this._weakKeys[7],q$z?(q$b!=q$z.weakKey&&(q$T.clearObject(this,q$b),q$T.keepObject(this,q$z.weakKey),this._weakKeys[7]=q$z.weakKey),this.drawBitmap(q$t,q$z,q$_-q$L,q$H,q$L,q$a-q$H-q$C)):(q$T.clearObject(this,q$b),this._weakKeys[7]="")),q$z=q$F.getTexture(q$S,q$G,q$H,q$J-q$G-q$L,q$V-q$H-q$C),q$b=this._weakKeys[8],q$z?(q$b!=q$z.weakKey&&(q$T.clearObject(this,q$b),q$T.keepObject(this,q$z.weakKey),this._weakKeys[8]=q$z.weakKey),this.drawBitmap(q$t,q$z,q$G,q$H,q$_-q$G-q$L,q$a-q$H-q$C)):(q$T.clearObject(this,q$b),this._weakKeys[8]=""),q$o&&this.restore(),this.autoCacheCmd&&!q$D.isConchApp&&(q$T.saveObject(q$W,this.cmds,null),this._weakKey=q$W,q$T.keepObject(this,this._weakKey))}this._repaint()}},q$S.drawBitmap=function(q$S,q$_,q$a,q$R,q$J,q$V){void 0===q$J&&(q$J=0),void 0===q$V&&(q$V=0),q$J<.1||q$V<.1||(!q$S||q$_.width==q$J&&q$_.height==q$V?this.drawTexture(q$_,q$a,q$R,q$J,q$V):this.fillTexture(q$_,q$a,q$R,q$J,q$V))},q$S.clear=function(q$S){void 0===q$S&&(q$S=!0),q$a.prototype.clear.call(this,!1)},q$W(0,q$S,"sizeGrid",function(){return this._sizeGrid},function(q$S){this._sizeGrid=q$S,this._setChanged()}),q$W(0,q$S,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(q$S){this._width!=q$S&&(this._width=q$S,this._setChanged())}),q$W(0,q$S,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(q$S){this._height!=q$S&&(this._height=q$S,this._setChanged())}),q$W(0,q$S,"source",function(){return this._source},function(q$S){q$S?(this._source=q$S,this._setChanged()):(this._source=null,this.clear())}),q$F.getTexture=function(q$S,q$_,q$a,q$R,q$J){q$R<=0&&(q$R=1),q$J<=0&&(q$J=1),q$S.$_GID||(q$S.$_GID=q$N.getGID());var q$V=q$S.$_GID+"."+q$_+"."+q$a+"."+q$R+"."+q$J,q$W=q$T.findObject(q$V);if((!q$W||!q$W.source)&&(q$W=q$m.createFromTexture(q$S,q$_,q$a,q$R,q$J))){if(q$S.alphaTexture){var q$k=q$S.width/q$S.alphaTexture.width;q$W.alphaTexture=q$m.createFromTexture(q$S.alphaTexture,q$_/q$k,q$a/q$k,q$R/q$k,q$J/q$k)}q$T.saveObject(q$V,q$W),q$W.weakKey=q$V}return q$W},q$F}(q$_),q$h=(function(q$S){function q$_(){q$_.__super.call(this)}q$V(q$_,"laya.ui.UIEvent",q$b),q$_.SHOW_TIP="showtip",q$_.HIDE_TIP="hidetip"}(),function(q$_){function q$S(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,q$S.__super.call(this),this._layout=q$l.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}q$V(q$S,"laya.ui.Component",q$_);var q$a=q$S.prototype;return q$o.imps(q$a,{"laya.ui.IComponent":!0}),q$a.destroy=function(q$S){void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,q$S),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},q$a.preinitialize=function(){},q$a.createChildren=function(){},q$a.initialize=function(){},q$a.callLater=function(q$S,q$_){q$o.timer.callLater(this,q$S,q$_)},q$a.runCallLater=function(q$S){q$o.timer.runCallLater(this,q$S)},q$a.commitMeasure=function(){},q$a.changeSize=function(){this.event("resize")},q$a.getLayout=function(){return this._layout===q$l.EMPTY&&(this._layout=new q$l),this._layout},q$a._setLayoutEnabled=function(q$S){this._layout&&this._layout.enable!=q$S&&(this._layout.enable=q$S,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},q$a.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},q$a.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},q$a.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},q$a.resetLayoutX=function(){var q$S=this._layout;if(isNaN(q$S.anchorX)||(this.pivotX=q$S.anchorX*this.width),this.layoutEnabled){var q$_=this.parent;q$_&&(isNaN(q$S.centerX)?isNaN(q$S.left)?isNaN(q$S.right)||(this.x=Math.round(q$_.width-this.displayWidth-q$S.right+this.pivotX*this.scaleX)):(this.x=Math.round(q$S.left+this.pivotX*this.scaleX),isNaN(q$S.right)||(this.width=(q$_._width-q$S.left-q$S.right)/(this.scaleX||.01))):this.x=Math.round(.5*(q$_.width-this.displayWidth)+q$S.centerX+this.pivotX*this.scaleX))}},q$a.resetLayoutY=function(){var q$S=this._layout;if(isNaN(q$S.anchorY)||(this.pivotY=q$S.anchorY*this.height),this.layoutEnabled){var q$_=this.parent;q$_&&(isNaN(q$S.centerY)?isNaN(q$S.top)?isNaN(q$S.bottom)||(this.y=Math.round(q$_.height-this.displayHeight-q$S.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(q$S.top+this.pivotY*this.scaleY),isNaN(q$S.bottom)||(this.height=(q$_._height-q$S.top-q$S.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(q$_.height-this.displayHeight)+q$S.centerY+this.pivotY*this.scaleY))}},q$a.onMouseOver=function(q$S){q$o.stage.event("showtip",this._toolTip)},q$a.onMouseOut=function(q$S){q$o.stage.event("hidetip",this._toolTip)},q$W(0,q$a,"displayWidth",function(){return this.width*this.scaleX}),q$W(0,q$a,"width",function(){return this._width?this._width:this.measureWidth},function(q$S){this._width!=q$S&&(this._width=q$S,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),q$W(0,q$a,"measureWidth",function(){var q$S=0;this.commitMeasure();for(var q$_=this.numChildren-1;-1<q$_;q$_--){var q$a=this.getChildAt(q$_);q$a.visible&&(q$S=Math.max(q$a.x+q$a.width*q$a.scaleX,q$S))}return q$S}),q$W(0,q$a,"displayHeight",function(){return this.height*this.scaleY}),q$W(0,q$a,"height",function(){return this._height?this._height:this.measureHeight},function(q$S){this._height!=q$S&&(this._height=q$S,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),q$W(0,q$a,"dataSource",function(){return this._dataSource},function(q$S){for(var q$_ in this._dataSource=q$S,this._dataSource)this.hasOwnProperty(q$_)&&"function"!=typeof this[q$_]&&(this[q$_]=this._dataSource[q$_])}),q$W(0,q$a,"scaleY",q$_.prototype._$get_scaleY,function(q$S){q$o.superGet(q$j,this,"scaleY")!=q$S&&(q$o.superSet(q$j,this,"scaleY",q$S),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),q$W(0,q$a,"measureHeight",function(){var q$S=0;this.commitMeasure();for(var q$_=this.numChildren-1;-1<q$_;q$_--){var q$a=this.getChildAt(q$_);q$a.visible&&(q$S=Math.max(q$a.y+q$a.height*q$a.scaleY,q$S))}return q$S}),q$W(0,q$a,"scaleX",q$_.prototype._$get_scaleX,function(q$S){q$o.superGet(q$j,this,"scaleX")!=q$S&&(q$o.superSet(q$j,this,"scaleX",q$S),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),q$W(0,q$a,"top",function(){return this._layout.top},function(q$S){q$S!=this._layout.top&&(this.getLayout().top=q$S,this._setLayoutEnabled(!0)),this.resetLayoutY()}),q$W(0,q$a,"bottom",function(){return this._layout.bottom},function(q$S){q$S!=this._layout.bottom&&(this.getLayout().bottom=q$S,this._setLayoutEnabled(!0)),this.resetLayoutY()}),q$W(0,q$a,"left",function(){return this._layout.left},function(q$S){q$S!=this._layout.left&&(this.getLayout().left=q$S,this._setLayoutEnabled(!0)),this.resetLayoutX()}),q$W(0,q$a,"right",function(){return this._layout.right},function(q$S){q$S!=this._layout.right&&(this.getLayout().right=q$S,this._setLayoutEnabled(!0)),this.resetLayoutX()}),q$W(0,q$a,"centerX",function(){return this._layout.centerX},function(q$S){q$S!=this._layout.centerX&&(this.getLayout().centerX=q$S,this._setLayoutEnabled(!0)),this.resetLayoutX()}),q$W(0,q$a,"centerY",function(){return this._layout.centerY},function(q$S){q$S!=this._layout.centerY&&(this.getLayout().centerY=q$S,this._setLayoutEnabled(!0)),this.resetLayoutY()}),q$W(0,q$a,"anchorX",function(){return this._layout.anchorX},function(q$S){q$S!=this._layout.anchorX&&(this.getLayout().anchorX=q$S,this._setLayoutEnabled(!0)),this.resetLayoutX()}),q$W(0,q$a,"anchorY",function(){return this._layout.anchorY},function(q$S){q$S!=this._layout.anchorY&&(this.getLayout().anchorY=q$S,this._setLayoutEnabled(!0)),this.resetLayoutY()}),q$W(0,q$a,"tag",function(){return this._tag},function(q$S){this._tag=q$S}),q$W(0,q$a,"toolTip",function(){return this._toolTip},function(q$S){this._toolTip!=q$S&&(null!=(this._toolTip=q$S)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),q$W(0,q$a,"comXml",function(){return this._comXml},function(q$S){this._comXml=q$S}),q$W(0,q$a,"gray",function(){return this._gray},function(q$S){q$S!==this._gray&&(this._gray=q$S,q$I.gray(this,q$S))}),q$W(0,q$a,"disabled",function(){return this._disabled},function(q$S){q$S!==this._disabled&&(this.gray=this._disabled=q$S,this.mouseEnabled=!q$S)}),q$S}(q$j)),q$u=function(q$S){function q$_(){this.lockLayer=null,this.popupEffect=function(q$S){q$S.scale(1,1),q$q.from(q$S,{x:q$o.stage.width/2,y:q$o.stage.height/2,scaleX:0,scaleY:0},300,q$z.backOut,q$C.create(this,this.doOpen,[q$S]))},this.closeEffect=function(q$S,q$_){q$q.to(q$S,{x:q$o.stage.width/2,y:q$o.stage.height/2,scaleX:0,scaleY:0},300,q$z.strongOut,q$C.create(this,this.doClose,[q$S,q$_]))},q$_.__super.call(this),this.maskLayer=new q$j,this.popupEffectHandler=q$C.create(this,this.popupEffect,null,!1),this.closeEffectHandler=q$C.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,q$o.stage.addChild(this),q$o.stage.on("resize",this,this._onResize),q$A.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}q$V(q$_,"laya.ui.DialogManager",q$j);var q$a=q$_.prototype;return q$a._closeOnSide=function(){var q$S=this.getChildAt(this.numChildren-1);q$S instanceof laya.ui.Dialog&&q$S.close("side")},q$a.setLockView=function(q$S){this.lockLayer||(this.lockLayer=new q$K,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(q$o.stage.width,q$o.stage.height)),this.lockLayer.removeChildren(),q$S&&(q$S.centerX=q$S.centerY=0,this.lockLayer.addChild(q$S))},q$a._onResize=function(q$S){var q$_=this.maskLayer.width=q$o.stage.width,q$a=this.maskLayer.height=q$o.stage.height;this.lockLayer&&this.lockLayer.size(q$_,q$a),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,q$_,q$a,q$A.popupBgColor),this.maskLayer.alpha=q$A.popupBgAlpha;for(var q$R=this.numChildren-1;-1<q$R;q$R--){var q$J=this.getChildAt(q$R);q$J.popupCenter&&this._centerDialog(q$J)}},q$a._centerDialog=function(q$S){q$S.x=Math.round((q$o.stage.width-q$S.width>>1)+q$S.pivotX),q$S.y=Math.round((q$o.stage.height-q$S.height>>1)+q$S.pivotY)},q$a.open=function(q$S,q$_,q$a){void 0===q$_&&(q$_=!1),void 0===q$a&&(q$a=!1),q$_&&this._closeAll(),q$S.popupCenter&&this._centerDialog(q$S),this.addChild(q$S),(q$S.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),q$a&&null!=q$S.popupEffect?q$S.popupEffect.runWith(q$S):this.doOpen(q$S),this.event("open")},q$a.doOpen=function(q$S){q$S.onOpened()},q$a.lock=function(q$S){this.lockLayer&&(q$S?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},q$a.close=function(q$S,q$_,q$a){void 0===q$a&&(q$a=!1),q$a&&null!=q$S.closeEffect?q$S.closeEffect.runWith([q$S,q$_]):this.doClose(q$S,q$_),this.event("close")},q$a.doClose=function(q$S,q$_){q$S.removeSelf(),q$S.isModal&&this._checkMask(),q$S.closeHandler&&q$S.closeHandler.runWith(q$_),q$S.onClosed(q$_)},q$a.closeAll=function(){this._closeAll(),this.event("close")},q$a._closeAll=function(){for(var q$S=this.numChildren-1;-1<q$S;q$S--){var q$_=this.getChildAt(q$S);q$_&&null!=q$_.close&&this.doClose(q$_)}},q$a.getDialogsByGroup=function(q$S){for(var q$_=[],q$a=this.numChildren-1;-1<q$a;q$a--){var q$R=this.getChildAt(q$a);q$R&&q$R.group===q$S&&q$_.push(q$R)}return q$_},q$a.closeByGroup=function(q$S){for(var q$_=[],q$a=this.numChildren-1;-1<q$a;q$a--){var q$R=this.getChildAt(q$a);q$R&&q$R.group===q$S&&(q$R.close(),q$_.push(q$R))}return q$_},q$a._checkMask=function(){this.maskLayer.removeSelf();for(var q$S=this.numChildren-1;-1<q$S;q$S--){var q$_=this.getChildAt(q$S);if(q$_&&q$_.isModal)return void this.addChildAt(this.maskLayer,q$S)}},q$_}(),q$K=function(q$S){function q$_(){q$_.__super.call(this)}q$V(q$_,"laya.ui.Box",q$S);var q$a=q$_.prototype;return q$o.imps(q$a,{"laya.ui.IBox":!0}),q$W(0,q$a,"dataSource",q$S.prototype._$get_dataSource,function(q$S){for(var q$_ in this._dataSource=q$S){var q$a=this.getChildByName(q$_);q$a?q$a.dataSource=q$S[q$_]:this.hasOwnProperty(q$_)&&"function"!=typeof this[q$_]&&(this[q$_]=q$S[q$_])}}),q$_}(q$h),q$P=function(q$_){function q$a(q$S,q$_){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,q$a.__super.call(this),this._labelColors=q$B.buttonLabelColors,this._stateNum=q$B.buttonStateNum,void 0===q$_&&(q$_=""),this.skin=q$S,this.label=q$_}q$V(q$a,"laya.ui.Button",q$_);var q$S=q$a.prototype;return q$o.imps(q$S,{"laya.ui.ISelect":!0}),q$S.destroy=function(q$S){this.clearEvent(),q$T.clearCache(this,this._skin),q$T.clearObject(this,this._weakKey),void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,q$S),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(q$S),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},q$S.clearEvent=function(){this._skin&&q$J.atalsNotify&&q$J.atalsNotify.off(this._skin,this,this._setBtnSource)},q$S.createChildren=function(){this.graphics=this._bitmap=new q$X},q$S.createText=function(){this._text||(this._text=new q$Q,this._text.overflow=q$Q.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},q$S.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},q$S.onMouse=function(q$S){if(!1!==this.toggle||!this._selected)return"click"===q$S.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=q$a.stateMap[q$S.type]))},q$S.changeClips=function(){var q$S=q$T.getRes(this._skin);if(q$S)if(this._skin&&""!=this._skin){q$T.clearObject(this,this._weakKey);var q$_=q$S.sourceWidth,q$a=q$S.sourceHeight/this._stateNum;q$S.$_GID||(q$S.$_GID=q$N.getGID());var q$R=q$S.$_GID+"-"+this._stateNum,q$J=q$T.findObject(q$R);if(q$N.isOkTextureList(q$J)||(q$J=null),q$J)this._weakKey=q$R,q$T.keepObject(this,this._weakKey),this._sources=q$J;else{if(this._sources=[],1===this._stateNum)this._sources.push(q$S);else for(var q$V=0;q$V<this._stateNum;q$V++){var q$W=q$m.createFromTexture(q$S,0,q$a*q$V,q$_,q$a);if(q$S.alphaTexture){var q$k=q$S.width/q$S.alphaTexture.width;q$W.alphaTexture=q$m.createFromTexture(q$S.alphaTexture,0/q$k,q$a*q$V/q$k,q$_/q$k,q$a/q$k)}this._sources.push(q$W)}q$T.saveObject(q$R,this._sources),this._weakKey=q$R,q$T.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||q$_,this._bitmap.height=this._height||q$a,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=q$_)}else console.warn("lose skin ",this._skin,this.name,this.__className)},q$S.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var q$S=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[q$S]),this.label&&(this._text.color=this._labelColors[q$S],this._strokeColors&&(this._text.strokeColor=this._strokeColors[q$S]))},q$S._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},q$W(0,q$S,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(q$S){this.createText(),this._text.strokeColor=q$S}),q$W(0,q$S,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),q$W(0,q$S,"skin",function(){return this._skin},function(q$S){if(this._skin!=q$S)if(this.clearEvent(),q$T.clearCache(this,this._skin),this._skin=q$S,q$T.keepCache(this,this._skin),q$T.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var q$_=q$J.resAtalsObj&&q$J.resAtalsObj[this._skin];q$_?(q$J.atalsNotify&&q$J.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=q$_.sourceW),0==this.height&&(this.height=q$_.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),q$S._setBtnSource=function(q$S,q$_){q$S===this._skin&&q$_&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},q$W(0,q$S,"state",function(){return this._state},function(q$S){this._state!=q$S&&(this._state=q$S,this._setStateChanged())}),q$W(0,q$S,"text",function(){return this.createText(),this._text}),q$W(0,q$S,"stateNum",function(){return this._stateNum},function(q$S){"string"==typeof q$S&&(q$S=parseInt(q$S)),this._stateNum!=q$S&&(this._stateNum=q$S<1?1:3<q$S?3:q$S,this.callLater(this.changeClips))}),q$W(0,q$S,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(q$S){this._strokeColors=q$I.fillArray(q$B.buttonLabelColors,q$S,String),this._setStateChanged()}),q$W(0,q$S,"labelColors",function(){return this._labelColors.join(",")},function(q$S){this._labelColors=q$I.fillArray(q$B.buttonLabelColors,q$S,String),this._setStateChanged()}),q$W(0,q$S,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),q$W(0,q$S,"label",function(){return this._text?this._text.text:null},function(q$S){(this._text||q$S)&&(this.createText(),this._text.text!=q$S&&(q$S&&!this._text.parent&&this.addChild(this._text),this._text.text=(q$S+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),q$W(0,q$S,"selected",function(){return this._selected},function(q$S){this._selected!=q$S&&(this._selected=q$S,this.state=this._selected?2:0,this.event("change"))}),q$W(0,q$S,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(q$S){this.createText(),this._text.padding=q$I.fillArray(q$B.labelPadding,q$S,Number)}),q$W(0,q$S,"labelSize",function(){return this.createText(),this._text.fontSize},function(q$S){this.createText(),this._text.fontSize=q$S}),q$W(0,q$S,"labelStroke",function(){return this.createText(),this._text.stroke},function(q$S){this.createText(),this._text.stroke=q$S}),q$W(0,q$S,"labelBold",function(){return this.createText(),this._text.bold},function(q$S){this.createText(),this._text.bold=q$S}),q$W(0,q$S,"labelFont",function(){return this.createText(),this._text.font},function(q$S){this.createText(),this._text.font=q$S}),q$W(0,q$S,"labelAlign",function(){return this.createText(),this._text.align},function(q$S){this.createText(),this._text.align=q$S}),q$W(0,q$S,"clickHandler",function(){return this._clickHandler},function(q$S){this._clickHandler=q$S}),q$W(0,q$S,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(q$S){this._bitmap.sizeGrid=q$I.fillArray(q$B.defaultSizeGrid,q$S,Number)}),q$W(0,q$S,"width",q$_.prototype._$get_width,function(q$S){q$o.superSet(q$h,this,"width",q$S),this._autoSize&&(this._bitmap.width=q$S,this._text&&(this._text.width=q$S))}),q$W(0,q$S,"height",q$_.prototype._$get_height,function(q$S){q$o.superSet(q$h,this,"height",q$S),this._autoSize&&(this._bitmap.height=q$S,this._text&&(this._text.height=q$S))}),q$W(0,q$S,"dataSource",q$_.prototype._$get_dataSource,function(q$S){"number"==typeof(this._dataSource=q$S)||"string"==typeof q$S?this.label=q$S+"":q$o.superSet(q$h,this,"dataSource",q$S)}),q$W(0,q$S,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(q$S){this._bitmap._offset=q$S?q$I.fillArray([1,1],q$S,Number):[]}),q$R(q$a,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),q$a}(q$h),q$M=function(q$_){function q$R(q$S,q$_,q$a){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,q$R.__super.call(this),void 0===q$_&&(q$_=1),void 0===q$a&&(q$a=1),this._clipX=q$_,this._clipY=q$a,this.skin=q$S}q$V(q$R,"laya.ui.Clip",q$_);var q$S=q$R.prototype;return q$S.destroy=function(q$S){this.clearEvent(),this.clearLoad(),q$T.clearCache(this,this._skin),q$T.clearObject(this,this._weakKey),void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},q$S.dispose=function(){this.destroy(!0),q$o.loader.clearRes(this._skin)},q$S.createChildren=function(){this.graphics=this._bitmap=new q$X},q$S._onDisplay=function(q$S){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},q$S.changeClip=function(){if(this._clipChanged=!1,this._skin){var q$S=q$T.getRes(this._skin);if(q$S)this.loadComplete(this._skin,q$S);else{if(q$J.resAtalsObj&&q$J.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=q$C.create(this,this.loadComplete,[this._skin]),this._progress=null,q$o.loader.load(this._skin,this._complete,this._progress)}}},q$S.loadComplete=function(q$S,q$_){if(q$S===this._skin&&q$_){q$T.clearObject(this,this._weakKey);var q$a=this._clipWidth||Math.ceil(q$_.sourceWidth/this._clipX),q$R=this._clipHeight||Math.ceil(q$_.sourceHeight/this._clipY),q$J=this._skin+q$a+q$R,q$V=q$T.findObject(q$J);if(q$N.isOkTextureList(q$V)||(q$V=null),q$V)this._weakKey=q$J,q$T.keepObject(this,this._weakKey),this._sources=q$V;else{this._sources=[];for(var q$W=0;q$W<this._clipY;q$W++)for(var q$k=0;q$k<this._clipX;q$k++){var q$z=q$m.createFromTexture(q$_,q$a*q$k,q$R*q$W,q$a,q$R);if(q$_.alphaTexture){var q$b=q$_.width/q$_.alphaTexture.width;q$z.alphaTexture=q$m.createFromTexture(q$_.alphaTexture,q$a*q$k/q$b,q$R*q$W/q$b,q$a/q$b,q$R/q$b)}this._sources.push(q$z)}q$T.saveObject(q$J,this._sources),this._weakKey=q$J,q$T.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},q$S.play=function(q$S,q$_){void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=-1),this._isPlaying=!0,this.index=q$S,this._toIndex=q$_,this._index++,q$o.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},q$S._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},q$S.stop=function(){this._isPlaying=!1,q$o.timer.clear(this,this._loop),this.event("complete")},q$S._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},q$W(0,q$S,"interval",function(){return this._interval},function(q$S){this._interval!=q$S&&(this._interval=q$S,this._isPlaying&&this.play())}),q$S.clearEvent=function(){this._skin&&q$J.atalsNotify&&q$J.atalsNotify.off(this._skin,this,this._setBtnSource)},q$S.clearLoad=function(){this._skin&&((this._complete||this._progress)&&q$o.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},q$W(0,q$S,"skin",function(){return this._skin},function(q$S){if(this._skin!=q$S)if(this.clearLoad(),this.clearEvent(),q$T.clearCache(this,this._skin),this._skin=q$S){q$T.keepCache(this,this._skin);var q$_=q$T.getRes(q$S),q$a=q$J.resAtalsObj&&q$J.resAtalsObj[this._skin];!q$_&&q$a?q$J.atalsNotify&&q$J.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),q$S._setBtnSource=function(q$S,q$_){q$S===this._skin&&q$_&&(this.loadComplete(q$S,q$_),this.clearEvent())},q$W(0,q$S,"sources",function(){return this._sources},function(q$S){this._sources=q$S,this.index=this._index,this.event("loaded")}),q$W(0,q$S,"clipX",function(){return this._clipX},function(q$S){this._clipX=q$S||1,this._setClipChanged()}),q$W(0,q$S,"clipY",function(){return this._clipY},function(q$S){this._clipY=q$S||1,this._setClipChanged()}),q$W(0,q$S,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),q$W(0,q$S,"clipWidth",function(){return this._clipWidth},function(q$S){this._clipWidth=q$S,this._setClipChanged()}),q$W(0,q$S,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(q$S){this._bitmap.sizeGrid=q$I.fillArray(q$B.defaultSizeGrid,q$S,Number)}),q$W(0,q$S,"group",function(){return this._group},function(q$S){q$S&&this._skin&&q$T.setGroup(this._skin,q$S),this._group=q$S}),q$W(0,q$S,"clipHeight",function(){return this._clipHeight},function(q$S){this._clipHeight=q$S,this._setClipChanged()}),q$W(0,q$S,"width",q$_.prototype._$get_width,function(q$S){q$o.superSet(q$h,this,"width",q$S),this._bitmap.width=q$S}),q$W(0,q$S,"height",q$_.prototype._$get_height,function(q$S){q$o.superSet(q$h,this,"height",q$S),this._bitmap.height=q$S}),q$W(0,q$S,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),q$W(0,q$S,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),q$W(0,q$S,"index",function(){return this._index},function(q$S){this._index=q$S,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[q$S]),this.event("change")}),q$W(0,q$S,"autoPlay",function(){return this._autoPlay},function(q$S){this._autoPlay!=q$S&&((this._autoPlay=q$S)?this.play():this.stop())}),q$W(0,q$S,"isPlaying",function(){return this._isPlaying},function(q$S){this._isPlaying=q$S}),q$W(0,q$S,"dataSource",q$_.prototype._$get_dataSource,function(q$S){"number"==typeof(this._dataSource=q$S)&&Math.floor(q$S)==q$S||"string"==typeof q$S?this.index=parseInt(q$S):q$o.superSet(q$h,this,"dataSource",q$S)}),q$W(0,q$S,"bitmap",function(){return this._bitmap}),q$R}(q$h),q$r=function(q$_){function q$S(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,q$S.__super.call(this)}q$V(q$S,"laya.ui.ColorPicker",q$_);var q$a=q$S.prototype;return q$a.destroy=function(q$S){void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,q$S),this._colorPanel&&this._colorPanel.destroy(q$S),this._colorButton&&this._colorButton.destroy(q$S),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},q$a.createChildren=function(){this.addChild(this._colorButton=new q$P),this._colorPanel=new q$K,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new q$j),this._colorPanel.addChild(this._colorBlock=new q$j),this._colorPanel.addChild(this._colorInput=new q$G)},q$a.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},q$a.onPanelMouseDown=function(q$S){q$S.stopPropagation()},q$a.changePanel=function(){this._panelChanged=!1;var q$S=this._colorPanel.graphics;q$S.clear(),q$S.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(q$S=this._colorTiles.graphics).clear();for(var q$_=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],q$a=0;q$a<12;q$a++)for(var q$R=0;q$R<20;q$R++){var q$J=0;q$J=0===q$R?q$_[q$a]:1===q$R?0:51*(((3*q$a+q$R/6)%3<<0)+3*(q$a/6<<0))<<16|q$R%6*51<<8|(q$a<<0)%6*51;var q$V=q$I.toColor(q$J);this._colors.push(q$V);var q$W=q$R*this._gridSize,q$k=q$a*this._gridSize;q$S.drawRect(q$W,q$k,this._gridSize,this._gridSize,q$V,"#000000")}},q$a.onColorButtonClick=function(q$S){this._colorPanel.parent?this.close():this.open()},q$a.open=function(){var q$S=this.localToGlobal(new q$t),q$_=q$S.x+this._colorPanel.width<=q$o.stage.width?q$S.x:q$o.stage.width-this._colorPanel.width,q$a=q$S.y+this._colorButton.height;q$a=q$a+this._colorPanel.height<=q$o.stage.height?q$a:q$S.y-this._colorPanel.height,this._colorPanel.pos(q$_,q$a),this._colorPanel.zOrder=1001,q$o._currentStage.addChild(this._colorPanel),q$o.stage.on("mousedown",this,this.removeColorBox)},q$a.close=function(){q$o.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},q$a.removeColorBox=function(q$S){this.close()},q$a.onColorFieldKeyDown=function(q$S){13==q$S.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),q$S.stopPropagation())},q$a.onColorInputChange=function(q$S){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},q$a.onColorTilesClick=function(q$S){this.selectedColor=this.getColorByMouse(),this.close()},q$a.onColorTilesMouseMove=function(q$S){this._colorInput.focus=!1;var q$_=this.getColorByMouse();this._colorInput.text=q$_,this.drawBlock(q$_)},q$a.getColorByMouse=function(){var q$S=this._colorTiles.getMousePoint(),q$_=Math.floor(q$S.x/this._gridSize),q$a=Math.floor(q$S.y/this._gridSize);return this._colors[20*q$a+q$_]},q$a.drawBlock=function(q$S){var q$_=this._colorBlock.graphics;q$_.clear();var q$a=q$S||"#ffffff";q$_.drawRect(0,0,50,20,q$a,this._borderColor),q$S||q$_.drawLine(0,0,50,20,"#ff0000")},q$a.changeColor=function(){var q$S=this.graphics;q$S.clear();var q$_=this._selectedColor||"#000000";q$S.drawRect(0,0,this._colorButton.width,this._colorButton.height,q$_)},q$a._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},q$W(0,q$a,"inputBgColor",function(){return this._inputBgColor},function(q$S){this._inputBgColor=q$S,this._setPanelChanged()}),q$W(0,q$a,"selectedColor",function(){return this._selectedColor},function(q$S){this._selectedColor!=q$S&&(this._selectedColor=this._colorInput.text=q$S,this.drawBlock(q$S),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",q$b.EMPTY.setTo("change",this,this)))}),q$W(0,q$a,"skin",function(){return this._colorButton.skin},function(q$S){this._colorButton.skin=q$S,this.changeColor()}),q$W(0,q$a,"bgColor",function(){return this._bgColor},function(q$S){this._bgColor=q$S,this._setPanelChanged()}),q$W(0,q$a,"borderColor",function(){return this._borderColor},function(q$S){this._borderColor=q$S,this._setPanelChanged()}),q$W(0,q$a,"inputColor",function(){return this._inputColor},function(q$S){this._inputColor=q$S,this._setPanelChanged()}),q$S}(q$h),q$e=function(q$_){function q$a(q$S,q$_){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,q$a.__super.call(this),this._itemColors=q$B.comboBoxItemColors,this.skin=q$S,this.labels=q$_}q$V(q$a,"laya.ui.ComboBox",q$_);var q$S=q$a.prototype;return q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,q$S),this._button&&this._button.destroy(q$S),this._list&&this._list.destroy(q$S),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},q$S.createChildren=function(){this.addChild(this._button=new q$P),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},q$S._createList=function(){this._list=new q$c,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},q$S._setListEvent=function(q$S){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=q$C.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},q$S.onListDown=function(q$S){q$S.stopPropagation()},q$S.onScrollBarDown=function(q$S){q$S.stopPropagation()},q$S.onButtonMouseDown=function(q$S){this.callLater(this.switchTo,[!this._isOpen])},q$S.changeList=function(){this._listChanged=!1;var q$S=this.width-2,q$_=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:q$S,height:this._itemHeight,fontSize:this._itemSize,color:q$_}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},q$S.onlistItemMouse=function(q$S,q$_){var q$a=q$S.type;if("mouseover"===q$a||"mouseout"===q$a){if(this._isCustomList)return;var q$R=this._list.getCell(q$_);if(!q$R)return;var q$J=q$R.getChildByName("label");q$J&&("mouseover"===q$a?(q$J.bgColor=this._itemColors[0],q$J.color=this._itemColors[1]):(q$J.bgColor=null,q$J.color=this._itemColors[2]))}else"click"===q$a&&(this.selectedIndex=q$_,this.isOpen=!1)},q$S.switchTo=function(q$S){this.isOpen=q$S},q$S.changeOpen=function(){this.isOpen=!this._isOpen},q$S.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var q$S=this._list.graphics;q$S.clear(),q$S.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var q$_=this._list.array||[],q$a=q$_.length=0,q$R=this._labels.length;q$a<q$R;q$a++)q$_.push({label:this._labels[q$a]});this._list.height=this._listHeight,this._list.array=q$_},q$S.changeSelected=function(){this._button.label=this.selectedLabel},q$S._onStageMouseWheel=function(q$S){this._list&&!this._list.contains(q$S.target)&&this.removeList(null)},q$S.removeList=function(q$S){q$o.stage.off("mousedown",this,this.removeList),q$o.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},q$W(0,q$S,"selectedIndex",function(){return this._selectedIndex},function(q$S){this._selectedIndex!=q$S&&(this._selectedIndex=q$S,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[q$b.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),q$W(0,q$S,"measureHeight",function(){return this._button.height}),q$W(0,q$S,"skin",function(){return this._button.skin},function(q$S){this._button.skin!=q$S&&(this._button.skin=q$S,this._listChanged=!0)}),q$W(0,q$S,"measureWidth",function(){return this._button.width}),q$W(0,q$S,"width",q$_.prototype._$get_width,function(q$S){q$o.superSet(q$h,this,"width",q$S),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),q$W(0,q$S,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(q$S){this.selectedIndex=this._labels.indexOf(q$S)}),q$W(0,q$S,"labels",function(){return this._labels.join(",")},function(q$S){0<this._labels.length&&(this.selectedIndex=-1),q$S?this._labels=q$S.split(","):this._labels.length=0,this._itemChanged=!0}),q$W(0,q$S,"height",q$_.prototype._$get_height,function(q$S){q$o.superSet(q$h,this,"height",q$S),this._button.height=this._height}),q$W(0,q$S,"selectHandler",function(){return this._selectHandler},function(q$S){this._selectHandler=q$S}),q$W(0,q$S,"visibleNum",function(){return this._visibleNum},function(q$S){this._visibleNum=q$S,this._listChanged=!0}),q$W(0,q$S,"labelBold",function(){return this._button.text.bold},function(q$S){this._button.text.bold=q$S}),q$W(0,q$S,"itemColors",function(){return String(this._itemColors)},function(q$S){this._itemColors=q$I.fillArray(this._itemColors,q$S,String),this._listChanged=!0}),q$W(0,q$S,"itemSize",function(){return this._itemSize},function(q$S){this._itemSize=q$S,this._listChanged=!0}),q$W(0,q$S,"scrollBar",function(){return this.list.scrollBar}),q$W(0,q$S,"isOpen",function(){return this._isOpen},function(q$S){if(this._isOpen!=q$S)if(this._isOpen=q$S,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var q$_=this.localToGlobal(q$t.TEMP.setTo(0,0)),q$a=q$_.y+this._button.height;q$a=q$a+this._listHeight<=q$o.stage.height?q$a:q$_.y-this._listHeight,this._list.pos(q$_.x,q$a),this._list.zOrder=1001,q$o._currentStage.addChild(this._list),q$o.stage.once("mousedown",this,this.removeList),q$o.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),q$W(0,q$S,"scrollBarSkin",function(){return this._scrollBarSkin},function(q$S){this._scrollBarSkin=q$S}),q$W(0,q$S,"sizeGrid",function(){return this._button.sizeGrid},function(q$S){this._button.sizeGrid=q$S}),q$W(0,q$S,"button",function(){return this._button}),q$W(0,q$S,"list",function(){return this._list||this._createList(),this._list},function(q$S){q$S&&(q$S.removeSelf(),this._isCustomList=!0,this._list=q$S,this._setListEvent(q$S),this._itemHeight=q$S.getCell(0).height+q$S.spaceY)}),q$W(0,q$S,"dataSource",q$_.prototype._$get_dataSource,function(q$S){"number"==typeof(this._dataSource=q$S)&&Math.floor(q$S)==q$S||"string"==typeof q$S?this.selectedIndex=parseInt(q$S):q$S instanceof Array?this.labels=q$S.join(","):q$o.superSet(q$h,this,"dataSource",q$S)}),q$W(0,q$S,"labelColors",function(){return this._button.labelColors},function(q$S){this._button.labelColors!=q$S&&(this._button.labelColors=q$S)}),q$W(0,q$S,"labelPadding",function(){return this._button.text.padding.join(",")},function(q$S){this._button.text.padding=q$I.fillArray(q$B.labelPadding,q$S,Number)}),q$W(0,q$S,"labelSize",function(){return this._button.text.fontSize},function(q$S){this._button.text.fontSize=q$S}),q$W(0,q$S,"labelFont",function(){return this._button.text.font},function(q$S){this._button.text.font=q$S}),q$W(0,q$S,"stateNum",function(){return this._button.stateNum},function(q$S){this._button.stateNum=q$S}),q$a}(q$h),q$g=function(q$_){function q$a(q$S){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,q$a.__super.call(this),this._showButtons=q$A.showButtons,this._touchScrollEnable=q$A.touchScrollEnable,this._mouseWheelEnable=q$A.mouseWheelEnable,this.skin=q$S,this.max=1}q$V(q$a,"laya.ui.ScrollBar",q$_);var q$S=q$a.prototype;return q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),this.stopScroll(),this.target=null,q$_.prototype.destroy.call(this,q$S),this.upButton&&this.upButton.destroy(q$S),this.downButton&&this.downButton.destroy(q$S),this.slider&&this.slider.destroy(q$S),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},q$S.createChildren=function(){this.addChild(this.slider=new q$x),this.addChild(this.upButton=new q$P),this.addChild(this.downButton=new q$P)},q$S.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},q$S.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},q$S.onButtonMouseDown=function(q$S){var q$_=q$S.currentTarget===this.upButton;this.slide(q$_),q$o.timer.once(q$B.scrollBarDelayTime,this,this.startLoop,[q$_]),q$o.stage.once("mouseup",this,this.onStageMouseUp)},q$S.startLoop=function(q$S){q$o.timer.frameLoop(1,this,this.slide,[q$S])},q$S.slide=function(q$S){q$S?this.value-=this._scrollSize:this.value+=this._scrollSize},q$S.onStageMouseUp=function(q$S){q$o.timer.clear(this,this.startLoop),q$o.timer.clear(this,this.slide)},q$S.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},q$S.changeSize=function(){q$_.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},q$S.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},q$S.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},q$S.setScroll=function(q$S,q$_,q$a){this.runCallLater(this.changeSize),this.slider.setSlider(q$S,q$_,q$a),this.slider.bar.visible=0<q$_,!this._hide&&this.autoHide&&(this.visible=!1)},q$S.onTargetMouseWheel=function(q$S){this.value-=q$S.delta*this._scrollSize,this.target=this._target},q$S.onTargetMouseDown=function(q$S){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new q$t),this._lastPoint.setTo(q$o.stage.mouseX,q$o.stage.mouseY),q$o.timer.clear(this,this.tweenMove),q$q.clearTween(this),q$o.stage.once("mouseup",this,this.onStageMouseUp2),q$o.stage.once("mouseout",this,this.onStageMouseUp2),q$o.timer.frameLoop(1,this,this.loop)},q$S.loop=function(){var q$S=q$o.stage.mouseY,q$_=q$o.stage.mouseX;if(this._lastOffset=this.isVertical?q$S-this._lastPoint.y:q$_-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?q$o.stage._canvasTransform.getScaleY():q$o.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=q$_,this._lastPoint.y=q$S,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},q$S.onStageMouseUp2=function(q$S){if(q$o.stage.off("mouseup",this,this.onStageMouseUp2),q$o.stage.off("mouseout",this,this.onStageMouseUp2),q$o.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?q$q.to(this,{value:this.min},this.elasticBackTime,q$z.sineOut,q$C.create(this,this.elasticOver)):this._value>this.max&&q$q.to(this,{value:this.max},this.elasticBackTime,q$z.sineOut,q$C.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?q$o.stage.mouseY-this._lastPoint.y:q$o.stage.mouseX-this._lastPoint.x);for(var q$_=0,q$a=Math.min(this._offsets.length,3),q$R=0;q$R<q$a;q$R++)q$_+=this._offsets[this._offsets.length-1-q$R];if(this._lastOffset=q$_/q$a,(q$_=Math.abs(this._lastOffset))<2)return void this.event("end");60<q$_&&(this._lastOffset=0<this._lastOffset?60:-60);var q$J=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));q$o.timer.frameLoop(1,this,this.tweenMove,[q$J])}},q$S.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&q$q.to(this,{alpha:0},500),this.event("end")},q$S.tweenMove=function(q$S){this._lastOffset*=this.rollRatio;var q$_=NaN;if(0<q$S&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,q$_=.5*-(this.min-q$S-this.value),this._lastOffset>q$_&&(this._lastOffset=q$_)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,q$_=.5*-(this.max+q$S-this.value),this._lastOffset<q$_&&(this._lastOffset=q$_))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(q$o.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?q$q.to(this,{value:this.min},this.elasticBackTime,q$z.sineOut,q$C.create(this,this.elasticOver)):this._value>this.max?q$q.to(this,{value:this.max},this.elasticBackTime,q$z.sineOut,q$C.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&q$q.to(this,{alpha:0},500)}},q$S.stopScroll=function(){this.onStageMouseUp2(null),q$o.timer.clear(this,this.tweenMove),q$q.clearTween(this)},q$W(0,q$S,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),q$W(0,q$S,"skin",function(){return this._skin},function(q$S){this._skin!=q$S&&(this._skin=q$S,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),q$W(0,q$S,"max",function(){return this.slider.max},function(q$S){this.slider.max=q$S}),q$W(0,q$S,"showButtons",function(){return this._showButtons},function(q$S){this._showButtons=q$S,this.callLater(this.changeScrollBar)}),q$W(0,q$S,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),q$W(0,q$S,"min",function(){return this.slider.min},function(q$S){this.slider.min=q$S}),q$W(0,q$S,"value",function(){return this._value},function(q$S){q$S!==this._value&&(this._value=q$S,this._isElastic||(this.slider._value!=q$S&&(this.slider._value=q$S,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),q$W(0,q$S,"isVertical",function(){return this.slider.isVertical},function(q$S){this.slider.isVertical=q$S}),q$W(0,q$S,"sizeGrid",function(){return this.slider.sizeGrid},function(q$S){this.slider.sizeGrid=q$S}),q$W(0,q$S,"scrollSize",function(){return this._scrollSize},function(q$S){this._scrollSize=q$S}),q$W(0,q$S,"dataSource",q$_.prototype._$get_dataSource,function(q$S){"number"==typeof(this._dataSource=q$S)||"string"==typeof q$S?this.value=Number(q$S):q$o.superSet(q$h,this,"dataSource",q$S)}),q$W(0,q$S,"thumbPercent",function(){return this._thumbPercent},function(q$S){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),q$S=1<=q$S?.99:q$S,this._thumbPercent=q$S,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*q$S,q$B.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*q$S,q$B.scrollBarMinNum))}),q$W(0,q$S,"target",function(){return this._target},function(q$S){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=q$S)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),q$W(0,q$S,"hide",function(){return this._hide},function(q$S){this._hide=q$S,this.visible=!q$S}),q$W(0,q$S,"touchScrollEnable",function(){return this._touchScrollEnable},function(q$S){this._touchScrollEnable=q$S,this.target=this._target}),q$W(0,q$S,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(q$S){this._mouseWheelEnable=q$S,this.target=this._target}),q$W(0,q$S,"tick",function(){return this.slider.tick},function(q$S){this.slider.tick=q$S}),q$a}(q$h),q$x=function(q$_){function q$a(q$S){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,q$a.__super.call(this),this.skin=q$S}q$V(q$a,"laya.ui.Slider",q$_);var q$S=q$a.prototype;return q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,q$S),this._bg&&this._bg.destroy(q$S),this._bar&&this._bar.destroy(q$S),this._progress&&this._progress.destroy(q$S),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},q$S.createChildren=function(){this.addChild(this._bg=new q$s),this.addChild(this._bar=new q$P)},q$S.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},q$S.onBarMouseDown=function(q$S){this._globalSacle||(this._globalSacle=new q$t),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=q$o.stage.mouseX,this._ty=q$o.stage.mouseY,q$o.stage.on("mousemove",this,this.mouseMove),q$o.stage.once("mouseup",this,this.mouseUp),q$o.stage.once("mouseout",this,this.mouseUp),this.showValueText()},q$S.showValueText=function(){if(this.showLabel){var q$S=laya.ui.Slider.label;this.addChild(q$S),q$S.textField.changeText(this._value+""),this.isVertical?(q$S.x=this._bar.x+20,q$S.y=.5*(this._bar.height-q$S.height)+this._bar.y):(q$S.y=this._bar.y-20,q$S.x=.5*(this._bar.width-q$S.width)+this._bar.x)}},q$S.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},q$S.mouseUp=function(q$S){q$o.stage.off("mousemove",this,this.mouseMove),q$o.stage.off("mouseup",this,this.mouseUp),q$o.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},q$S.mouseMove=function(q$S){var q$_=this._value;this.isVertical?(this._bar.y+=(q$o.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(q$o.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=q$o.stage.mouseX,this._ty=q$o.stage.mouseY;var q$a=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*q$a)/q$a,this._value!=q$_&&this.sendChangeEvent(),this.showValueText()},q$S.sendChangeEvent=function(q$S){void 0===q$S&&(q$S="change"),this.event(q$S),this.changeHandler&&this.changeHandler.runWith(this._value)},q$S.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},q$S.changeSize=function(){q$_.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},q$S.setSlider=function(q$S,q$_,q$a){this._value=-1,this._min=q$S,this._max=q$S<q$_?q$_:q$S,this.value=q$a<q$S?q$S:q$_<q$a?q$_:q$a},q$S.changeValue=function(){var q$S=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*q$S)/q$S,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var q$_=this._max-this._min;0===q$_&&(q$_=1),this.isVertical?(this._bar.y=(this._value-this._min)/q$_*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/q$_*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},q$S.onBgMouseDown=function(q$S){var q$_=this._bg.getMousePoint();this.isVertical?this.value=q$_.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=q$_.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},q$W(0,q$S,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),q$W(0,q$S,"skin",function(){return this._skin},function(q$S){if(this._skin!=q$S){this._skin=q$S,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var q$_=this._skin.replace(".png","$progress.png");q$T.getRes(q$_)&&(this._progress||(this.addChild(this._progress=new q$s),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=q$_),this.setBarPoint(),this.callLater(this.changeValue)}}),q$W(0,q$S,"allowClickBack",function(){return this._allowClickBack},function(q$S){this._allowClickBack!=q$S&&((this._allowClickBack=q$S)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),q$W(0,q$S,"max",function(){return this._max},function(q$S){this._max!=q$S&&(this._max=q$S,this.callLater(this.changeValue))}),q$W(0,q$S,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),q$W(0,q$S,"tick",function(){return this._tick},function(q$S){this._tick!=q$S&&(this._tick=q$S,this.callLater(this.changeValue))}),q$W(0,q$S,"sizeGrid",function(){return this._bg.sizeGrid},function(q$S){this._bg.sizeGrid=q$S,this._bar.sizeGrid=q$S,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),q$W(0,q$S,"min",function(){return this._min},function(q$S){this._min!=q$S&&(this._min=q$S,this.callLater(this.changeValue))}),q$W(0,q$S,"value",function(){return this._value},function(q$S){if(this._value!=q$S){var q$_=this._value;this._value=q$S,this.changeValue(),this._value!=q$_&&this.sendChangeEvent()}}),q$W(0,q$S,"dataSource",q$_.prototype._$get_dataSource,function(q$S){"number"==typeof(this._dataSource=q$S)||"string"==typeof q$S?this.value=Number(q$S):q$o.superSet(q$h,this,"dataSource",q$S)}),q$W(0,q$S,"bar",function(){return this._bar}),q$R(q$a,["label",function(){return this.label=new q$U}]),q$a}(q$h),q$s=function(q$_){function q$a(q$S){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,q$a.__super.call(this),this.skin=q$S}q$V(q$a,"laya.ui.Image",q$_);var q$S=q$a.prototype;return q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,q$T.clearCache(this,this._skin)},q$S.dispose=function(){this.destroy(!0),q$T.clearCache(this,this._skin),this.clearEvent()},q$S.createChildren=function(){this.graphics=this._bitmap=new q$X},q$S.setSource=function(q$S,q$_){q$S===this._skin&&q$_&&(this.source=q$_,this.onCompResize(),this.clearEvent())},q$S.clearEvent=function(){this._skin&&q$J.atalsNotify&&q$J.atalsNotify.off(this._skin,this,this.setSource)},q$S.clearLoad=function(){this._skin&&((this._complete||this._progress)&&q$o.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},q$W(0,q$S,"source",function(){return this._bitmap.source},function(q$S){this._bitmap&&(this._bitmap.source=q$S,this.event("loaded"),this.repaint())}),q$W(0,q$S,"dataSource",q$_.prototype._$get_dataSource,function(q$S){"string"==typeof(this._dataSource=q$S)?this.skin=q$S:q$o.superSet(q$h,this,"dataSource",q$S)}),q$W(0,q$S,"measureHeight",function(){return this._bitmap.height}),q$W(0,q$S,"skin",function(){return this._skin},function(q$S){if(this._skin!=q$S)if(q$T.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=q$S){q$T.keepCache(this,this._skin);var q$_=q$T.getRes(q$S),q$a=q$J.resAtalsObj&&q$J.resAtalsObj[this._skin];q$_?(this.source=q$_,this.onCompResize()):q$a?(q$J.atalsNotify&&q$J.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=q$a.sourceW),0==this.height&&(this.height=q$a.sourceH)):(this._complete=q$C.create(this,this.setSource,[this._skin]),this._progress=null,q$o.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),q$W(0,q$S,"group",function(){return this._group},function(q$S){q$S&&this._skin&&q$T.setGroup(this._skin,q$S),this._group=q$S}),q$W(0,q$S,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(q$S){this._bitmap.sizeGrid=q$I.fillArray(q$B.defaultSizeGrid,q$S,Number)}),q$W(0,q$S,"measureWidth",function(){return this._bitmap.width}),q$W(0,q$S,"width",q$_.prototype._$get_width,function(q$S){q$o.superSet(q$h,this,"width",q$S),this._bitmap.width=0==q$S?1e-7:q$S}),q$W(0,q$S,"height",q$_.prototype._$get_height,function(q$S){q$o.superSet(q$h,this,"height",q$S),this._bitmap.height=0==q$S?1e-7:q$S}),q$a}(q$h),q$U=function(q$_){function q$a(q$S){this._tf=null,q$a.__super.call(this),void 0===q$S&&(q$S=""),q$H.defaultColor=q$B.labelColor,this.text=q$S}q$V(q$a,"laya.ui.Label",q$_);var q$S=q$a.prototype;return q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,q$S),this._tf=null},q$S.createChildren=function(){this.addChild(this._tf=new q$Q)},q$S.changeText=function(q$S){this._tf.changeText(q$S)},q$W(0,q$S,"padding",function(){return this._tf.padding.join(",")},function(q$S){this._tf.padding=q$I.fillArray(q$B.labelPadding,q$S,Number)}),q$W(0,q$S,"bold",function(){return this._tf.bold},function(q$S){this._tf.bold=q$S}),q$W(0,q$S,"align",function(){return this._tf.align},function(q$S){this._tf.align=q$S}),q$W(0,q$S,"text",function(){return this._tf.text},function(q$S){this._tf.text!=q$S&&(q$S&&(q$S=q$I.adptString(q$S+"")),this._tf.text=q$S,this.event("change"),this._width&&this._height||this.onCompResize())}),q$W(0,q$S,"italic",function(){return this._tf.italic},function(q$S){this._tf.italic=q$S}),q$W(0,q$S,"wordWrap",function(){return this._tf.wordWrap},function(q$S){this._tf.wordWrap=q$S}),q$W(0,q$S,"font",function(){return this._tf.font},function(q$S){this._tf.font=q$S}),q$W(0,q$S,"dataSource",q$_.prototype._$get_dataSource,function(q$S){"number"==typeof(this._dataSource=q$S)||"string"==typeof q$S?this.text=q$S+"":q$o.superSet(q$h,this,"dataSource",q$S)}),q$W(0,q$S,"color",function(){return this._tf.color},function(q$S){this._tf.color=q$S}),q$W(0,q$S,"valign",function(){return this._tf.valign},function(q$S){this._tf.valign=q$S}),q$W(0,q$S,"leading",function(){return this._tf.leading},function(q$S){this._tf.leading=q$S}),q$W(0,q$S,"fontSize",function(){return this._tf.fontSize},function(q$S){this._tf.fontSize=q$S}),q$W(0,q$S,"bgColor",function(){return this._tf.bgColor},function(q$S){this._tf.bgColor=q$S}),q$W(0,q$S,"borderColor",function(){return this._tf.borderColor},function(q$S){this._tf.borderColor=q$S}),q$W(0,q$S,"stroke",function(){return this._tf.stroke},function(q$S){this._tf.stroke=q$S}),q$W(0,q$S,"strokeColor",function(){return this._tf.strokeColor},function(q$S){this._tf.strokeColor=q$S}),q$W(0,q$S,"textField",function(){return this._tf}),q$W(0,q$S,"measureWidth",function(){return this._tf.width}),q$W(0,q$S,"measureHeight",function(){return this._tf.height}),q$W(0,q$S,"width",function(){return this._width||this._tf.text?q$o.superGet(q$h,this,"width"):0},function(q$S){q$o.superSet(q$h,this,"width",q$S),this._tf.width=q$S}),q$W(0,q$S,"height",function(){return this._height||this._tf.text?q$o.superGet(q$h,this,"height"):0},function(q$S){q$o.superSet(q$h,this,"height",q$S),this._tf.height=q$S}),q$W(0,q$S,"overflow",function(){return this._tf.overflow},function(q$S){this._tf.overflow=q$S}),q$W(0,q$S,"underline",function(){return this._tf.underline},function(q$S){this._tf.underline=q$S}),q$W(0,q$S,"underlineColor",function(){return this._tf.underlineColor},function(q$S){this._tf.underlineColor=q$S}),q$a}(q$h),q$f=function(q$_){function q$a(q$S){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,q$a.__super.call(this),this.skin=q$S}q$V(q$a,"laya.ui.ProgressBar",q$_);var q$S=q$a.prototype;return q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,q$S),this._bg&&this._bg.destroy(q$S),this._bar&&this._bar.destroy(q$S),this._bg=this._bar=null,this.changeHandler=null},q$S.createChildren=function(){this.addChild(this._bg=new q$s),this.addChild(this._bar=new q$s)},q$S.changeValue=function(){if(this.sizeGrid){var q$S=this.sizeGrid.split(","),q$_=Number(q$S[3]),q$a=Number(q$S[1]),q$R=(this.width-q$_-q$a)*this._value;this._bar.width=q$_+q$a+q$R,this._bar.visible=this._bar.width>q$_+q$a}else this._bar.width=this.width*this._value},q$W(0,q$S,"measureHeight",function(){return this._bg.height}),q$W(0,q$S,"skin",function(){return this._skin},function(q$S){this._skin!=q$S&&(this._skin=q$S,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),q$W(0,q$S,"measureWidth",function(){return this._bg.width}),q$W(0,q$S,"height",q$_.prototype._$get_height,function(q$S){q$o.superSet(q$h,this,"height",q$S),this._bg.height=this._height,this._bar.height=this._height}),q$W(0,q$S,"bar",function(){return this._bar}),q$W(0,q$S,"value",function(){return this._value},function(q$S){this._value!=q$S&&(q$S=1<q$S?1:q$S<0?0:q$S,this._value=q$S,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(q$S))}),q$W(0,q$S,"bg",function(){return this._bg}),q$W(0,q$S,"sizeGrid",function(){return this._bg.sizeGrid},function(q$S){this._bg.sizeGrid=this._bar.sizeGrid=q$S}),q$W(0,q$S,"width",q$_.prototype._$get_width,function(q$S){q$o.superSet(q$h,this,"width",q$S),this._bg.width=this._width,this.callLater(this.changeValue)}),q$W(0,q$S,"dataSource",q$_.prototype._$get_dataSource,function(q$S){"number"==typeof(this._dataSource=q$S)||"string"==typeof q$S?this.value=Number(q$S):q$o.superSet(q$h,this,"dataSource",q$S)}),q$a}(q$h),q$Y=(function(q$S){function q$a(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,q$a.__super.call(this),this._tipBox=new q$h,this._tipBox.addChild(this._tipText=new q$Q),this._tipText.x=this._tipText.y=5,this._tipText.color=q$a.tipTextColor,this._defaultTipHandler=this._showDefaultTip,q$o.stage.on("showtip",this,this._onStageShowTip),q$o.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}q$V(q$a,"laya.ui.TipManager",q$h);var q$_=q$a.prototype;q$_._onStageHideTip=function(q$S){q$o.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},q$_._onStageShowTip=function(q$S){q$o.timer.once(q$a.tipDelay,this,this._showTip,[q$S],!0)},q$_._showTip=function(q$S){if("string"==typeof q$S){var q$_=String(q$S);Boolean(q$_)&&this._defaultTipHandler(q$_)}else q$S instanceof laya.utils.Handler?q$S.run():"function"==typeof q$S&&q$S.apply();q$o.stage.on("mousemove",this,this._onStageMouseMove),q$o.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},q$_._onStageMouseDown=function(q$S){this.closeAll()},q$_._onStageMouseMove=function(q$S){this._showToStage(this,q$a.offsetX,q$a.offsetY)},q$_._showToStage=function(q$S,q$_,q$a){void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0);var q$R=q$S.getBounds();q$S.x=q$o.stage.mouseX+q$_,q$S.y=q$o.stage.mouseY+q$a,q$S.x+q$R.width>q$o.stage.width&&(q$S.x-=q$R.width+q$_),q$S.y+q$R.height>q$o.stage.height&&(q$S.y-=q$R.height+q$a)},q$_.closeAll=function(){q$o.timer.clear(this,this._showTip),q$o.stage.off("mousemove",this,this._onStageMouseMove),q$o.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},q$_.showDislayTip=function(q$S){this.addChild(q$S),this._showToStage(this),q$o._currentStage.addChild(this)},q$_._showDefaultTip=function(q$S){this._tipText.text=q$S;var q$_=this._tipBox.graphics;q$_.clear(),q$_.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,q$a.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),q$o._currentStage.addChild(this)},q$W(0,q$_,"defaultTipHandler",function(){return this._defaultTipHandler},function(q$S){this._defaultTipHandler=q$S}),q$a.offsetX=10,q$a.offsetY=15,q$a.tipTextColor="#ffffff",q$a.tipBackColor="#111111",q$a.tipDelay=200}(),function(q$S){var q$G;function q$t(){this._idMap=null,this._aniList=null,this._watchMap={},q$t.__super.call(this)}q$V(q$t,"laya.ui.View",q$K);var q$_=q$t.prototype;return q$_.createView=function(q$S){if(q$S.animations&&!this._idMap&&(this._idMap={}),q$t.createComp(q$S,this,this),q$S.animations){var q$_,q$a,q$R=[],q$J=q$S.animations,q$V=0,q$W=q$J.length;for(q$V=0;q$V<q$W;q$V++){switch(q$_=new q$L,q$a=q$J[q$V],q$_._setUp(this._idMap,q$a),(this[q$a.name]=q$_)._setControlNode(this),q$a.action){case 1:q$_.play(0,!1);break;case 2:q$_.play(0,!0)}q$R.push(q$_)}this._aniList=q$R}0<this._width&&null==q$S.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},q$_.onEvent=function(q$S,q$_){},q$_.loadUI=function(q$S){var q$_=q$t.uiMap[q$S];q$_&&this.createView(q$_)},q$_.destroy=function(q$S){void 0===q$S&&(q$S=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,q$S)},q$_.changeData=function(q$S){var q$_=this._watchMap[q$S];if(q$_){console.log("change",q$S);for(var q$a=0,q$R=q$_.length;q$a<q$R;q$a++){q$_[q$a].exe(this)}}},q$t._regs=function(){for(var q$S in q$t.uiClassMap)q$$.regClass(q$S,q$t.uiClassMap[q$S])},q$t.createComp=function(q$S,q$_,q$a,q$R){if(!(q$_=q$_||q$t.getCompInstance(q$S)))return console.warn("can not create:"+q$S.type),null;var q$J=q$S.child;if(q$J)for(var q$V=q$_ instanceof laya.ui.List,q$W=0,q$k=q$J.length;q$W<q$k;q$W++){var q$z=q$J[q$W];if(!q$_.hasOwnProperty("itemRender")||"render"!=q$z.props.name&&"render"!==q$z.props.renderType)if("Graphic"==q$z.type)q$$.addGraphicsToSprite(q$z,q$_);else if(q$$.isDrawType(q$z.type))q$$.addGraphicToSprite(q$z,q$_,!0);else{if(q$V){var q$b=[],q$H=q$t.createComp(q$z,null,q$a,q$b);q$b.length&&(q$H._$bindData=q$b)}else q$H=q$t.createComp(q$z,null,q$a,q$R);"Script"==q$z.type?"owner"in q$H?q$H.owner=q$_:"target"in q$H&&(q$H.target=q$_):"mask"==q$z.props.renderType||"mask"==q$z.props.name?q$_.mask=q$H:q$H instanceof laya.display.Sprite&&q$_.addChild(q$H)}else q$_.itemRender=q$z}var q$L=q$S.props;for(var q$C in q$L){var q$G=q$L[q$C];q$t.eventDic[q$C]?q$G&&q$a&&q$_.on(q$C,q$a,q$a.onEvent,[q$G]):q$t.setCompValue(q$_,q$C,q$G,q$a,q$R)}return q$o.__typeof(q$_,"laya.ui.IItem")&&q$_.initItems(),q$S.compId&&q$a&&q$a._idMap&&(q$a._idMap[q$S.compId]=q$_),q$_},q$t.setCompValue=function(q$S,q$_,q$a,q$R,q$J){if("string"==typeof q$a&&-1<q$a.indexOf("${")){if(q$t._sheet||(q$t._sheet=q$$.getClass("laya.data.Table")),!q$t._sheet)return void console.warn("Can not find class Sheet");if(q$J)q$J.push(q$S,q$_,q$a);else if(q$R){-1==q$a.indexOf("].")&&(q$a=q$a.replace(".","[0]."));var q$V,q$W,q$k=new q$G(q$S,q$_,q$a);q$k.exe(q$R);for(var q$z=q$a.replace(/\[.*?\]\./g,".");null!=(q$V=q$t._parseWatchData.exec(q$z));){for(var q$b=q$V[1];null!=(q$W=q$t._parseKeyWord.exec(q$b));){var q$H=q$W[0],q$L=q$R._watchMap[q$H]||(q$R._watchMap[q$H]=[]);q$L.push(q$k),q$t._sheet.I.notifer.on(q$H,q$R,q$R.changeData,[q$H])}(q$L=q$R._watchMap[q$b]||(q$R._watchMap[q$b]=[])).push(q$k),q$t._sheet.I.notifer.on(q$b,q$R,q$R.changeData,[q$b])}}}else if("var"===q$_&&q$R)q$R[q$a]=q$S;else if("onClick"==q$_){var q$C=q$o._runScript("(function(){"+q$a+"})");q$S.on("click",q$R,q$C)}else q$S[q$_]="true"===q$a||"false"!==q$a&&q$a},q$t.getCompInstance=function(q$S){var q$_,q$a=q$S.props?q$S.props.runtime:null;return q$_=q$a?q$t.viewClassMap[q$a]||q$t.uiClassMap[q$a]||q$o.__classmap[q$a]:q$t.uiClassMap[q$S.type],q$S.props&&q$S.props.hasOwnProperty("renderType")&&"instance"==q$S.props.renderType?q$_.instance:q$_?new q$_:null},q$t.regComponent=function(q$S,q$_){q$t.uiClassMap[q$S]=q$_,q$$.regClass(q$S,q$_)},q$t.regViewRuntime=function(q$S,q$_){q$t.viewClassMap[q$S]=q$_},q$t.uiMap={},q$t.viewClassMap={},q$t._sheet=null,q$R(q$t,["uiClassMap",function(){return this.uiClassMap={ViewStack:q$SS,LinkButton:q$P,TextArea:q$bS,ColorPicker:q$r,Box:q$K,Button:q$P,CheckBox:q$i,Clip:q$M,ComboBox:q$e,Component:q$h,HScrollBar:q$y,HSlider:q$O,Image:q$s,Label:q$U,List:q$c,Panel:q$E,ProgressBar:q$f,Radio:q$v,RadioGroup:q$kS,ScrollBar:q$g,Slider:q$x,Tab:q$zS,TextInput:q$aS,View:q$t,VScrollBar:q$_S,VSlider:q$RS,Tree:q$d,HBox:q$VS,VBox:q$WS,Sprite:q$j,Animation:q$a,Text:q$Q,FontClip:q$p}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),q$t.__init$=function(){q$t._regs(),q$G=function(){function q$S(q$S,q$_,q$a){this.comp=null,this.prop=null,this.value=null,this.comp=q$S,this.prop=q$_,this.value=q$a}return q$V(q$S,""),q$S.prototype.exe=function(q$S){var q$_=q$I.getBindFun(this.value);this.comp[this.prop]=q$_.call(this,q$S)},q$S}()},q$t}()),q$i=function(q$S){function q$a(q$S,q$_){void 0===q$_&&(q$_=""),q$a.__super.call(this,q$S,q$_)}q$V(q$a,"laya.ui.CheckBox",q$S);var q$_=q$a.prototype;return q$_.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},q$_.initialize=function(){q$S.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},q$W(0,q$_,"dataSource",q$S.prototype._$get_dataSource,function(q$S){"boolean"==typeof(this._dataSource=q$S)?this.selected=q$S:"string"==typeof q$S?this.selected="true"===q$S:q$o.superSet(q$P,this,"dataSource",q$S)}),q$a}(q$P),q$Z=function(q$S){function q$_(){this._space=0,this._align="none",this._itemChanged=!1,q$_.__super.call(this)}q$V(q$_,"laya.ui.LayoutBox",q$K);var q$a=q$_.prototype;return q$a.addChild=function(q$S){return q$S.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,q$S)},q$a.onResize=function(q$S){this._setItemChanged()},q$a.addChildAt=function(q$S,q$_){return q$S.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,q$S,q$_)},q$a.removeChild=function(q$S){return q$S.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,q$S)},q$a.removeChildAt=function(q$S){return this.getChildAt(q$S).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,q$S)},q$a.refresh=function(){this._setItemChanged()},q$a.changeItems=function(){this._itemChanged=!1},q$a.sortItem=function(q$S){q$S&&q$S.sort(function(q$S,q$_){return q$S.y-q$_.y})},q$a._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},q$W(0,q$a,"space",function(){return this._space},function(q$S){this._space=q$S,this._setItemChanged()}),q$W(0,q$a,"align",function(){return this._align},function(q$S){this._align=q$S,this._setItemChanged()}),q$_}(),q$p=function(q$_){function q$a(q$S,q$_){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,q$a.__super.call(this),q$S&&(this.skin=q$S),q$_&&(this.sheet=q$_)}q$V(q$a,"laya.ui.FontClip",q$_);var q$S=q$a.prototype;return q$S.createChildren=function(){this._bitmap=new q$X,this.on("loaded",this,this._onClipLoaded)},q$S._onClipLoaded=function(){this.callLater(this.changeValue)},q$S.changeValue=function(){var q$S;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),q$S=this._sources[0]))){var q$_="horizontal"===this._direction;q$_?(this._wordsW=this._valueArr.length*(q$S.sourceWidth+this.spaceX),this._wordsH=q$S.sourceHeight):(this._wordsW=q$S.sourceWidth,this._wordsH=(q$S.sourceHeight+this.spaceY)*this._valueArr.length);var q$a=0;if(this._width)switch(this._align){case"center":q$a=.5*(this._width-this._wordsW);break;case"right":q$a=this._width-this._wordsW;break;default:q$a=0}for(var q$R=0,q$J=this._valueArr.length;q$R<q$J;q$R++){var q$V=this._indexMap[this._valueArr.charAt(q$R)];this.sources[q$V]&&(q$S=this.sources[q$V],q$_?this.graphics.drawTexture(q$S,q$a+q$R*(q$S.sourceWidth+this.spaceX),0,q$S.sourceWidth,q$S.sourceHeight):this.graphics.drawTexture(q$S,0+q$a,q$R*(q$S.sourceHeight+this.spaceY),q$S.sourceWidth,q$S.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),q$_.prototype.destroy.call(this,q$S)},q$W(0,q$S,"sheet",function(){return this._sheet},function(q$S){q$S+="";var q$_=(this._sheet=q$S).split(" ");this._clipX=String(q$_[0]).length,this.clipY=q$_.length,this._indexMap={};for(var q$a=0;q$a<this._clipY;q$a++)for(var q$R=q$_[q$a].split(""),q$J=0,q$V=q$R.length;q$J<q$V;q$J++)this._indexMap[q$R[q$J]]=q$a*this._clipX+q$J}),q$W(0,q$S,"height",q$_.prototype._$get_height,function(q$S){q$o.superSet(q$M,this,"height",q$S),this.callLater(this.changeValue)}),q$W(0,q$S,"direction",function(){return this._direction},function(q$S){this._direction=q$S,this.callLater(this.changeValue)}),q$W(0,q$S,"value",function(){return this._valueArr?this._valueArr:""},function(q$S){q$S+="",this._valueArr=q$S,this.callLater(this.changeValue)}),q$W(0,q$S,"width",q$_.prototype._$get_width,function(q$S){q$o.superSet(q$M,this,"width",q$S),this.callLater(this.changeValue)}),q$W(0,q$S,"spaceX",function(){return this._spaceX},function(q$S){this._spaceX=q$S,"horizontal"===this._direction&&this.callLater(this.changeValue)}),q$W(0,q$S,"spaceY",function(){return this._spaceY},function(q$S){this._spaceY=q$S,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),q$W(0,q$S,"align",function(){return this._align},function(q$S){this._align=q$S,this.callLater(this.changeValue)}),q$W(0,q$S,"measureWidth",function(){return this._wordsW}),q$W(0,q$S,"measureHeight",function(){return this._wordsH}),q$a}(q$M),q$c=function(q$S){function q$_(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new q$t,q$_.__super.call(this)}q$V(q$_,"laya.ui.List",q$S);var q$a=q$_.prototype;return q$o.imps(q$a,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),q$a.destroy=function(q$S){void 0===q$S&&(q$S=!0),this._content&&this._content.destroy(q$S),this._scrollBar&&this._scrollBar.destroy(q$S),laya.ui.Component.prototype.destroy.call(this,q$S),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},q$a.createChildren=function(){this.addChild(this._content=new q$K)},q$a.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=q$o.superGet(q$K,this,"cacheAs")),q$o.superSet(q$K,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},q$a.onScrollEnd=function(){q$o.superSet(q$K,this,"cacheAs",this._$P.cacheAs)},q$a._removePreScrollBar=function(){var q$S=this.removeChildByName("scrollBar");q$S&&q$S.destroy(!0)},q$a.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var q$S=this._getOneCell(),q$_=q$S.width+this._spaceX||1,q$a=q$S.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/q$_):Math.ceil(this._width/q$_)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/q$a):Math.round(this._height/q$a));var q$R=this._width?this._width:q$_*this.repeatX-this._spaceX,q$J=this._height?this._height:q$a*this.repeatY-this._spaceY;this._cellSize=this._isVertical?q$a:q$_,this._cellOffset=this._isVertical?q$a*Math.max(this._repeatY2,this._repeatY)-q$J-this._spaceY:q$_*Math.max(this._repeatX2,this._repeatX)-q$R-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=q$J:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=q$R),this.setContentSize(q$R,q$J);var q$V=this._isVertical?this.repeatX:this.repeatY,q$W=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,q$V,q$W),this._createdLine=q$W,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},q$a._getOneCell=function(){if(0===this._cells.length){var q$S=this.createItem();if(this._offset.setTo(q$S.x,q$S.y),this.cacheContent)return q$S;this._cells.push(q$S)}return this._cells[0]},q$a._createItems=function(q$S,q$_,q$a){var q$R=this._content,q$J=this._getOneCell(),q$V=q$J.width+this._spaceX,q$W=q$J.height+this._spaceY;if(this.cacheContent){var q$k=new q$K;q$k.cacheAsBitmap=!0,q$k.pos((this._isVertical?0:q$S)*q$V,(this._isVertical?q$S:0)*q$W),this._content.addChild(q$k),this._content.optimizeScrollRect=!0,q$R=q$k}else{for(var q$z=[],q$b=this._cells.length-1;-1<q$b;q$b--){var q$H=this._cells[q$b];q$H.removeSelf(),q$z.push(q$H)}this._cells.length=0}for(var q$L=q$S;q$L<q$a;q$L++)for(var q$C=0;q$C<q$_;q$C++)(q$J=q$z&&q$z.length?q$z.pop():this.createItem()).x=(this._isVertical?q$C:q$L)*q$V-q$R.x,q$J.y=(this._isVertical?q$L:q$C)*q$W-q$R.y,q$J.name="item"+(q$L*q$_+q$C),q$R.addChild(q$J),this.addCell(q$J)},q$a.createItem=function(){var q$S=[];if("function"==typeof this._itemRender)var q$_=new this._itemRender;else q$_=q$Y.createComp(this._itemRender,null,null,q$S);if(0==q$S.length&&q$_._watchMap){var q$a=q$_._watchMap;for(var q$R in q$a)for(var q$J=q$a[q$R],q$V=0;q$V<q$J.length;q$V++){var q$W=q$J[q$V];q$S.push(q$W.comp,q$W.prop,q$W.value)}}return q$S.length&&(q$_._$bindData=q$S),q$_},q$a.addCell=function(q$S){q$S.on("click",this,this.onCellMouse),q$S.on("rightclick",this,this.onCellMouse),q$S.on("mouseover",this,this.onCellMouse),q$S.on("mouseout",this,this.onCellMouse),q$S.on("mousedown",this,this.onCellMouse),q$S.on("mouseup",this,this.onCellMouse),this._cells.push(q$S)},q$a.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var q$S=0,q$_=q$S=0;q$_<1e4;q$_++){var q$a=this.getChildByName("item"+q$_);if(!q$a)break;this.addCell(q$a),q$S++}this.repeatY=q$S}},q$a.setContentSize=function(q$S,q$_){this._content.width=q$S,this._content.height=q$_,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new q$F),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,q$S,q$_),this._content.scrollRect=this._content.scrollRect),this.event("resize")},q$a.onCellMouse=function(q$S){"mousedown"===q$S.type&&(this._isMoved=!1);var q$_=q$S.currentTarget,q$a=this._startIndex+this._cells.indexOf(q$_);q$a<0||("click"===q$S.type||"rightclick"===q$S.type?this.selectEnable&&!this._isMoved?this.selectedIndex=q$a:this.changeCellState(q$_,!0,0):"mouseover"!==q$S.type&&"mouseout"!==q$S.type||this._selectedIndex===q$a||this.changeCellState(q$_,"mouseover"===q$S.type,0),this.mouseHandler&&this.mouseHandler.runWith([q$S,q$a]))},q$a.changeCellState=function(q$S,q$_,q$a){var q$R=q$S.getChildByName("selectBox");q$R&&(this.selectEnable=!0,q$R.visible=q$_,q$R.index=q$a)},q$a.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},q$a.onScrollBarChange=function(q$S){this.runCallLater(this.changeCells);var q$_=this._scrollBar.value,q$a=this._isVertical?this.repeatX:this.repeatY,q$R=this._isVertical?this.repeatY:this.repeatX,q$J=Math.floor(q$_/this._cellSize);if(this.cacheContent)q$W=q$R+1,this._createdLine-q$J<q$W&&(this._createItems(this._createdLine,q$a,this._createdLine+q$W),this.renderItems(this._createdLine*q$a,0),this._createdLine+=q$W);else{var q$V=q$J*q$a,q$W=0;if(q$V>this._startIndex){q$W=q$V-this._startIndex;var q$k=!0,q$z=this._startIndex+q$a*(q$R+1);this._isMoved=!0}else q$V<this._startIndex&&(q$W=this._startIndex-q$V,q$k=!1,q$z=this._startIndex-1,this._isMoved=!0);for(var q$b=0;q$b<q$W;q$b++){if(q$k){var q$H=this._cells.shift();this._cells[this._cells.length]=q$H;var q$L=q$z+q$b}else q$H=this._cells.pop(),this._cells.unshift(q$H),q$L=q$z-q$b;var q$C=Math.floor(q$L/q$a)*this._cellSize;this._isVertical?q$H.y=q$C:q$H.x=q$C,this.renderItem(q$H,q$L)}this._startIndex=q$V,this.changeSelectStatus()}var q$G=this._content.scrollRect;this._isVertical?(q$G.y=q$_-this._offset.y,q$G.x=-this._offset.x):(q$G.y=-this._offset.y,q$G.x=q$_-this._offset.x),this._content.scrollRect=q$G},q$a.posCell=function(q$S,q$_){if(this._scrollBar){var q$a=this._isVertical?this.repeatX:this.repeatY,q$R=(this._isVertical?this.repeatY:this.repeatX,Math.floor(q$_/q$a)*this._cellSize);this._isVertical?q$S.y=q$R:q$S.x=q$R}},q$a.changeSelectStatus=function(){for(var q$S=0,q$_=this._cells.length;q$S<q$_;q$S++)this.changeCellState(this._cells[q$S],this._selectedIndex===this._startIndex+q$S,1)},q$a.renderItems=function(q$S,q$_){void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0);for(var q$a=q$S,q$R=q$_||this._cells.length;q$a<q$R;q$a++)this.renderItem(this._cells[q$a],this._startIndex+q$a);this.changeSelectStatus()},q$a.renderItem=function(q$S,q$_){this._array&&0<=q$_&&q$_<this._array.length?(q$S.visible=!0,q$S._$bindData?(q$S._dataSource=this._array[q$_],this._bindData(q$S,this._array[q$_])):q$S.dataSource=this._array[q$_],this.cacheContent||this.posCell(q$S,q$_),this.hasListener("render")&&this.event("render",[q$S,q$_]),this.renderHandler&&this.renderHandler.runWith([q$S,q$_])):(q$S.visible=!1,q$S.dataSource=null)},q$a._bindData=function(q$S,q$_){for(var q$a=q$S._$bindData,q$R=0,q$J=q$a.length;q$R<q$J;q$R++){var q$V=q$a[q$R++],q$W=q$a[q$R++],q$k=q$a[q$R],q$z=q$I.getBindFun(q$k);q$V[q$W]=q$z.call(this,q$_)}},q$a.refresh=function(){this.array=this._array},q$a.getItem=function(q$S){return-1<q$S&&q$S<this._array.length?this._array[q$S]:null},q$a.changeItem=function(q$S,q$_){-1<q$S&&q$S<this._array.length&&(this._array[q$S]=q$_,q$S>=this._startIndex&&q$S<this._startIndex+this._cells.length&&this.renderItem(this.getCell(q$S),q$S))},q$a.setItem=function(q$S,q$_){this.changeItem(q$S,q$_)},q$a.addItem=function(q$S){this._array.push(q$S),this.array=this._array},q$a.addItemAt=function(q$S,q$_){this._array.splice(q$_,0,q$S),this.array=this._array},q$a.deleteItem=function(q$S){this._array.splice(q$S,1),this.array=this._array},q$a.getCell=function(q$S){return this.runCallLater(this.changeCells),-1<q$S&&this._cells?this._cells[(q$S-this._startIndex)%this._cells.length]:null},q$a.scrollTo=function(q$S){if(this._scrollBar){var q$_=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(q$S/q$_)*this._cellSize}else this.startIndex=q$S},q$a.tweenTo=function(q$S,q$_,q$a){if(void 0===q$_&&(q$_=200),this._scrollBar){var q$R=this._isVertical?this.repeatX:this.repeatY;q$q.to(this._scrollBar,{value:Math.floor(q$S/q$R)*this._cellSize},q$_,null,q$a,0,!0)}else this.startIndex=q$S,q$a&&q$a.run()},q$a._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},q$a.commitMeasure=function(){this.runCallLater(this.changeCells)},q$W(0,q$a,"cacheAs",q$S.prototype._$get_cacheAs,function(q$S){q$o.superSet(q$K,this,"cacheAs",q$S),this._scrollBar&&(this._$P.cacheAs=null,"none"!==q$S?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),q$W(0,q$a,"content",function(){return this._content}),q$W(0,q$a,"height",q$S.prototype._$get_height,function(q$S){q$S!=this._height&&(q$o.superSet(q$K,this,"height",q$S),this._setCellChanged())}),q$W(0,q$a,"itemRender",function(){return this._itemRender},function(q$S){if(this._itemRender!=q$S){this._itemRender=q$S;for(var q$_=this._cells.length-1;-1<q$_;q$_--)this._cells[q$_].destroy();this._cells.length=0,this._setCellChanged()}}),q$W(0,q$a,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(q$S){this._removePreScrollBar();var q$_=new q$_S;q$_.name="scrollBar",q$_.right=0,q$S&&" "!=q$S&&(q$_.skin=q$S),this.scrollBar=q$_,this.addChild(q$_),this._setCellChanged()}),q$W(0,q$a,"page",function(){return this._page},function(q$S){this._page=q$S,this._array&&(this._page=0<q$S?q$S:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),q$W(0,q$a,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(q$S){this._removePreScrollBar();var q$_=new q$y;q$_.name="scrollBar",q$_.bottom=0,q$S&&" "!=q$S&&(q$_.skin=q$S),this.scrollBar=q$_,this.addChild(q$_),this._setCellChanged()}),q$W(0,q$a,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(q$S){this._repeatX=q$S,this._setCellChanged()}),q$W(0,q$a,"scrollBar",function(){return this._scrollBar},function(q$S){this._scrollBar!=q$S&&(this._scrollBar=q$S)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),q$W(0,q$a,"width",q$S.prototype._$get_width,function(q$S){q$S!=this._width&&(q$o.superSet(q$K,this,"width",q$S),this._setCellChanged())}),q$W(0,q$a,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(q$S){this._repeatY=q$S,this._setCellChanged()}),q$W(0,q$a,"spaceX",function(){return this._spaceX},function(q$S){this._spaceX=q$S,this._setCellChanged()}),q$W(0,q$a,"spaceY",function(){return this._spaceY},function(q$S){this._spaceY=q$S,this._setCellChanged()}),q$W(0,q$a,"selectedIndex",function(){return this._selectedIndex},function(q$S){this._selectedIndex!=q$S&&(this._selectedIndex=q$S,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(q$S),this.startIndex=this._startIndex)}),q$W(0,q$a,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(q$S){this.selectedIndex=this._array.indexOf(q$S)}),q$W(0,q$a,"length",function(){return this._array?this._array.length:0}),q$W(0,q$a,"selection",function(){return this.getCell(this._selectedIndex)},function(q$S){this.selectedIndex=this._startIndex+this._cells.indexOf(q$S)}),q$W(0,q$a,"startIndex",function(){return this._startIndex},function(q$S){this._startIndex=0<q$S?q$S:0,this.callLater(this.renderItems)}),q$W(0,q$a,"array",function(){return this._array},function(q$S){this.runCallLater(this.changeCells),this._array=q$S||[];var q$_=this._array.length;if(this.totalPage=Math.ceil(q$_/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<q$_?this._selectedIndex:q$_-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var q$a=this._isVertical?this.repeatX:this.repeatY,q$R=this._isVertical?this.repeatY:this.repeatX,q$J=Math.ceil(q$_/q$a);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=q$R/q$J,this._scrollBar.setScroll(0,(q$J-q$R)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),q$W(0,q$a,"dataSource",q$S.prototype._$get_dataSource,function(q$S){"number"==typeof(this._dataSource=q$S)&&Math.floor(q$S)==q$S||"string"==typeof q$S?this.selectedIndex=parseInt(q$S):q$S instanceof Array?this.array=q$S:q$o.superSet(q$K,this,"dataSource",q$S)}),q$W(0,q$a,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),q$_}(q$K),q$y=function(q$S){function q$_(){q$_.__super.call(this)}return q$V(q$_,"laya.ui.HScrollBar",q$S),q$_.prototype.initialize=function(){q$S.prototype.initialize.call(this),this.slider.isVertical=!1},q$_}(q$g),q$E=function(q$S){function q$_(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,q$_.__super.call(this),this.width=this.height=100}q$V(q$_,"laya.ui.Panel",q$S);var q$a=q$_.prototype;return q$a.destroy=function(q$S){void 0===q$S&&(q$S=!0),laya.ui.Component.prototype.destroy.call(this,q$S),this._content&&this._content.destroy(q$S),this._vScrollBar&&this._vScrollBar.destroy(q$S),this._hScrollBar&&this._hScrollBar.destroy(q$S),this._vScrollBar=null,this._hScrollBar=null,this._content=null},q$a.destroyChildren=function(){this._content.destroyChildren()},q$a.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new q$K)},q$a.addChild=function(q$S){return q$S.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(q$S)},q$a.onResize=function(){this._setScrollChanged()},q$a.addChildAt=function(q$S,q$_){return q$S.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(q$S,q$_)},q$a.removeChild=function(q$S){return q$S.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(q$S)},q$a.removeChildAt=function(q$S){return this.getChildAt(q$S).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(q$S)},q$a.removeChildren=function(q$S,q$_){return void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=2147483647),this._content.removeChildren(q$S,q$_),this._setScrollChanged(),this},q$a.getChildAt=function(q$S){return this._content.getChildAt(q$S)},q$a.getChildByName=function(q$S){return this._content.getChildByName(q$S)},q$a.getChildIndex=function(q$S){return this._content.getChildIndex(q$S)},q$a.changeScroll=function(){this._scrollChanged=!1;var q$S=this.contentWidth||1,q$_=this.contentHeight||1,q$a=this._vScrollBar,q$R=this._hScrollBar,q$J=q$a&&q$_>this._height,q$V=q$R&&q$S>this._width,q$W=q$J?this._width-q$a.width:this._width,q$k=q$V?this._height-q$R.height:this._height;q$a&&(q$a.x=this._width-q$a.width,q$a.y=0,q$a.height=this._height-(q$V?q$R.height:0),q$a.scrollSize=Math.max(.033*this._height,1),q$a.thumbPercent=q$k/q$_,q$a.setScroll(0,q$_-q$k,q$a.value)),q$R&&(q$R.x=0,q$R.y=this._height-q$R.height,q$R.width=this._width-(q$J?q$a.width:0),q$R.scrollSize=Math.max(.033*this._width,1),q$R.thumbPercent=q$W/q$S,q$R.setScroll(0,q$S-q$W,q$R.value))},q$a.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},q$a.setContentSize=function(q$S,q$_){var q$a=this._content;q$a.width=q$S,q$a.height=q$_,q$a.scrollRect||(q$a.scrollRect=new q$F),q$a.scrollRect.setTo(0,0,q$S,q$_),q$a.scrollRect=q$a.scrollRect},q$a.onScrollBarChange=function(q$S){var q$_=this._content.scrollRect;if(q$_){var q$a=Math.round(q$S.value);q$S.isVertical?q$_.y=q$a:q$_.x=q$a,this._content.scrollRect=q$_}},q$a.scrollTo=function(q$S,q$_){void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),this.vScrollBar&&(this.vScrollBar.value=q$_),this.hScrollBar&&(this.hScrollBar.value=q$S)},q$a.refresh=function(){this.changeScroll()},q$a.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=q$o.superGet(q$K,this,"cacheAs")),q$o.superSet(q$K,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},q$a.onScrollEnd=function(){q$o.superSet(q$K,this,"cacheAs",this._$P.cacheAs)},q$a._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},q$W(0,q$a,"numChildren",function(){return this._content.numChildren}),q$W(0,q$a,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(q$S){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new q$y),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=q$S}),q$W(0,q$a,"contentWidth",function(){for(var q$S=0,q$_=this._content.numChildren-1;-1<q$_;q$_--){var q$a=this._content.getChildAt(q$_);q$S=Math.max(q$a.x+q$a.width*q$a.scaleX,q$S)}return q$S}),q$W(0,q$a,"contentHeight",function(){for(var q$S=0,q$_=this._content.numChildren-1;-1<q$_;q$_--){var q$a=this._content.getChildAt(q$_);q$S=Math.max(q$a.y+q$a.height*q$a.scaleY,q$S)}return q$S}),q$W(0,q$a,"width",q$S.prototype._$get_width,function(q$S){q$o.superSet(q$K,this,"width",q$S),this._setScrollChanged()}),q$W(0,q$a,"hScrollBar",function(){return this._hScrollBar}),q$W(0,q$a,"content",function(){return this._content}),q$W(0,q$a,"height",q$S.prototype._$get_height,function(q$S){q$o.superSet(q$K,this,"height",q$S),this._setScrollChanged()}),q$W(0,q$a,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(q$S){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new q$_S),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=q$S}),q$W(0,q$a,"vScrollBar",function(){return this._vScrollBar}),q$W(0,q$a,"cacheAs",q$S.prototype._$get_cacheAs,function(q$S){q$o.superSet(q$K,this,"cacheAs",q$S),this._$P.cacheAs=null,"none"!==q$S?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),q$_}(q$K),q$O=function(q$S){function q$_(q$S){q$_.__super.call(this,q$S),this.isVertical=!1}return q$V(q$_,"laya.ui.HSlider",q$x),q$_}(),q$w=function(q$S){function q$a(q$S,q$_){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,q$a.__super.call(this),this.skin=q$_,this.labels=q$S}q$V(q$a,"laya.ui.UIGroup",q$S);var q$_=q$a.prototype;return q$o.imps(q$_,{"laya.ui.IItem":!0}),q$_.preinitialize=function(){this.mouseEnabled=!0},q$_.destroy=function(q$S){void 0===q$S&&(q$S=!0),laya.ui.Component.prototype.destroy.call(this,q$S),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},q$_.addItem=function(q$S,q$_){void 0===q$_&&(q$_=!0);var q$a=q$S,q$R=this._items.length;if(q$a.name="item"+q$R,this.addChild(q$a),this.initItems(),q$_&&0<q$R){var q$J=this._items[q$R-1];"horizontal"==this._direction?q$a.x=q$J.x+q$J.width+this._space:q$a.y=q$J.y+q$J.height+this._space}else q$_&&(q$a.x=0,q$a.y=0);return q$R},q$_.delItem=function(q$S,q$_){void 0===q$_&&(q$_=!0);var q$a=this._items.indexOf(q$S);if(-1!=q$a){var q$R=q$S;this.removeChild(q$R);for(var q$J=q$a+1,q$V=this._items.length;q$J<q$V;q$J++){var q$W=this._items[q$J];q$W.name="item"+(q$J-1),q$_&&("horizontal"==this._direction?q$W.x-=q$R.width+this._space:q$W.y-=q$R.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var q$k;q$k=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=q$k}}},q$_.initItems=function(){this._items||(this._items=[]);for(var q$S=this._items.length=0;q$S<1e4;q$S++){var q$_=this.getChildByName("item"+q$S);if(null==q$_)break;this._items.push(q$_),q$_.selected=q$S===this._selectedIndex,q$_.clickHandler=q$C.create(this,this.itemClick,[q$S],!1)}},q$_.itemClick=function(q$S){this.selectedIndex=q$S},q$_.setSelect=function(q$S,q$_){this._items&&-1<q$S&&q$S<this._items.length&&(this._items[q$S].selected=q$_)},q$_.createItem=function(q$S,q$_){return null},q$_.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var q$S=0,q$_=0,q$a=this._items.length;q$_<q$a;q$_++){var q$R=this._items[q$_];this._skin&&(q$R.skin=this._skin),this._labelColors&&(q$R.labelColors=this._labelColors),this._labelSize&&(q$R.labelSize=this._labelSize),this._labelStroke&&(q$R.labelStroke=this._labelStroke),this._labelStrokeColor&&(q$R.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(q$R.strokeColors=this._strokeColors),this._labelBold&&(q$R.labelBold=this._labelBold),this._labelPadding&&(q$R.labelPadding=this._labelPadding),this._labelAlign&&(q$R.labelAlign=this._labelAlign),this._stateNum&&(q$R.stateNum=this._stateNum),this._labelFont&&(q$R.labelFont=this._labelFont),"horizontal"===this._direction?(q$R.y=0,q$R.x=q$S,q$S+=q$R.width+this._space):(q$R.x=0,q$R.y=q$S,q$S+=q$R.height+this._space)}this.changeSize()},q$_.commitMeasure=function(){this.runCallLater(this.changeLabels)},q$_._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},q$W(0,q$_,"labelStrokeColor",function(){return this._labelStrokeColor},function(q$S){this._labelStrokeColor!=q$S&&(this._labelStrokeColor=q$S,this._setLabelChanged())}),q$W(0,q$_,"skin",function(){return this._skin},function(q$S){this._skin!=q$S&&(this._skin=q$S,this._setLabelChanged())}),q$W(0,q$_,"selectedIndex",function(){return this._selectedIndex},function(q$S){this._selectedIndex!=q$S&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=q$S,this.setSelect(q$S,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),q$W(0,q$_,"labels",function(){return this._labels},function(q$S){if(this._labels!=q$S){if(this._labels=q$S,this.removeChildren(),this._setLabelChanged(),this._labels)for(var q$_=this._labels.split(","),q$a=0,q$R=q$_.length;q$a<q$R;q$a++){var q$J=this.createItem(this._skin,q$_[q$a]);q$J.name="item"+q$a,this.addChild(q$J)}this.initItems()}}),q$W(0,q$_,"strokeColors",function(){return this._strokeColors},function(q$S){this._strokeColors!=q$S&&(this._strokeColors=q$S,this._setLabelChanged())}),q$W(0,q$_,"labelColors",function(){return this._labelColors},function(q$S){this._labelColors!=q$S&&(this._labelColors=q$S,this._setLabelChanged())}),q$W(0,q$_,"labelStroke",function(){return this._labelStroke},function(q$S){this._labelStroke!=q$S&&(this._labelStroke=q$S,this._setLabelChanged())}),q$W(0,q$_,"labelSize",function(){return this._labelSize},function(q$S){this._labelSize!=q$S&&(this._labelSize=q$S,this._setLabelChanged())}),q$W(0,q$_,"stateNum",function(){return this._stateNum},function(q$S){this._stateNum!=q$S&&(this._stateNum=q$S,this._setLabelChanged())}),q$W(0,q$_,"labelBold",function(){return this._labelBold},function(q$S){this._labelBold!=q$S&&(this._labelBold=q$S,this._setLabelChanged())}),q$W(0,q$_,"labelFont",function(){return this._labelFont},function(q$S){this._labelFont!=q$S&&(this._labelFont=q$S,this._setLabelChanged())}),q$W(0,q$_,"labelPadding",function(){return this._labelPadding},function(q$S){this._labelPadding!=q$S&&(this._labelPadding=q$S,this._setLabelChanged())}),q$W(0,q$_,"direction",function(){return this._direction},function(q$S){this._direction=q$S,this._setLabelChanged()}),q$W(0,q$_,"space",function(){return this._space},function(q$S){this._space=q$S,this._setLabelChanged()}),q$W(0,q$_,"items",function(){return this._items}),q$W(0,q$_,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(q$S){this.selectedIndex=this._items.indexOf(q$S)}),q$W(0,q$_,"dataSource",q$S.prototype._$get_dataSource,function(q$S){"number"==typeof(this._dataSource=q$S)&&Math.floor(q$S)==q$S||"string"==typeof q$S?this.selectedIndex=parseInt(q$S):q$S instanceof Array?this.labels=q$S.join(","):q$o.superSet(q$K,this,"dataSource",q$S)}),q$a}(q$K),q$v=function(q$_){function q$a(q$S,q$_){this._value=null,void 0===q$_&&(q$_=""),q$a.__super.call(this,q$S,q$_)}q$V(q$a,"laya.ui.Radio",q$_);var q$S=q$a.prototype;return q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,q$S),this._value=null},q$S.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},q$S.initialize=function(){q$_.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},q$S.onClick=function(q$S){this.selected=!0},q$W(0,q$S,"value",function(){return null!=this._value?this._value:this.label},function(q$S){this._value=q$S}),q$a}(q$P),q$d=function(q$S){function q$_(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,q$_.__super.call(this),this.width=this.height=200}q$V(q$_,"laya.ui.Tree",q$S);var q$a=q$_.prototype;return q$o.imps(q$a,{"laya.ui.IRender":!0}),q$a.destroy=function(q$S){void 0===q$S&&(q$S=!0),laya.ui.Component.prototype.destroy.call(this,q$S),this._list&&this._list.destroy(q$S),this._list=null,this._source=null,this._renderHandler=null},q$a.createChildren=function(){this.addChild(this._list=new q$c),this._list.renderHandler=q$C.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},q$a.onListChange=function(q$S){this.event("change")},q$a.getArray=function(){var q$S,q$_=[];for(var q$a in this._source)q$S=this._source[q$a],this.getParentOpenStatus(q$S)&&(q$S.x=this._spaceLeft*this.getDepth(q$S),q$_.push(q$S));return q$_},q$a.getDepth=function(q$S,q$_){return void 0===q$_&&(q$_=0),null==q$S.nodeParent?q$_:this.getDepth(q$S.nodeParent,q$_+1)},q$a.getParentOpenStatus=function(q$S){var q$_=q$S.nodeParent;return null==q$_||!!q$_.isOpen&&(null==q$_.nodeParent||this.getParentOpenStatus(q$_))},q$a.renderItem=function(q$S,q$_){var q$a=q$S.dataSource;if(q$a){q$S.left=q$a.x;var q$R=q$S.getChildByName("arrow");q$R&&(q$a.hasChild?(q$R.visible=!0,q$R.index=q$a.isOpen?1:0,q$R.tag=q$_,q$R.off("click",this,this.onArrowClick),q$R.on("click",this,this.onArrowClick)):q$R.visible=!1);var q$J=q$S.getChildByName("folder");q$J&&(2==q$J.clipY?q$J.index=q$a.isDirectory?0:1:q$J.index=q$a.isDirectory?q$a.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([q$S,q$_])}},q$a.onArrowClick=function(q$S){var q$_=q$S.currentTarget.tag;this._list.array[q$_].isOpen=!this._list.array[q$_].isOpen,this.event("open"),this._list.array=this.getArray()},q$a.setItemState=function(q$S,q$_){this._list.array[q$S]&&(this._list.array[q$S].isOpen=q$_,this._list.array=this.getArray())},q$a.fresh=function(){this._list.array=this.getArray(),this.repaint()},q$a.parseXml=function(q$S,q$_,q$a,q$R){var q$J,q$V=q$S.childNodes,q$W=q$V.length;if(!q$R){q$J={};var q$k,q$z=q$S.attributes;for(var q$b in q$z){var q$H=(q$k=q$z[q$b]).nodeName,q$L=q$k.nodeValue;q$J[q$H]="true"==q$L||"false"!=q$L&&q$L}q$J.nodeParent=q$a,0<q$W&&(q$J.isDirectory=!0),q$J.hasChild=0<q$W,q$_.push(q$J)}for(var q$C=0;q$C<q$W;q$C++){var q$G=q$V[q$C];this.parseXml(q$G,q$_,q$J,!1)}},q$a.parseOpenStatus=function(q$S,q$_){for(var q$a=0,q$R=q$_.length;q$a<q$R;q$a++){var q$J=q$_[q$a];if(q$J.isDirectory)for(var q$V=0,q$W=q$S.length;q$V<q$W;q$V++){var q$k=q$S[q$V];if(q$k.isDirectory&&this.isSameParent(q$k,q$J)&&q$J.label==q$k.label){q$J.isOpen=q$k.isOpen;break}}}},q$a.isSameParent=function(q$S,q$_){return null==q$S.nodeParent&&null==q$_.nodeParent||null!=q$S.nodeParent&&null!=q$_.nodeParent&&(q$S.nodeParent.label==q$_.nodeParent.label&&this.isSameParent(q$S.nodeParent,q$_.nodeParent))},q$a.filter=function(q$S){if(Boolean(q$S)){var q$_=[];this.getFilterSource(this._source,q$_,q$S),this._list.array=q$_}else this._list.array=this.getArray()},q$a.getFilterSource=function(q$S,q$_,q$a){var q$R;for(var q$J in q$a=q$a.toLocaleLowerCase(),q$S)!(q$R=q$S[q$J]).isDirectory&&-1<String(q$R.label).toLowerCase().indexOf(q$a)&&(q$R.x=0,q$_.push(q$R)),q$R.child&&0<q$R.child.length&&this.getFilterSource(q$R.child,q$_,q$a)},q$W(0,q$a,"spaceBottom",function(){return this._list.spaceY},function(q$S){this._list.spaceY=q$S}),q$W(0,q$a,"keepStatus",function(){return this._keepStatus},function(q$S){this._keepStatus=q$S}),q$W(0,q$a,"itemRender",function(){return this._list.itemRender},function(q$S){this._list.itemRender=q$S}),q$W(0,q$a,"array",function(){return this._list.array},function(q$S){this._keepStatus&&this._list.array&&q$S&&this.parseOpenStatus(this._list.array,q$S),this._source=q$S,this._list.array=this.getArray()}),q$W(0,q$a,"mouseHandler",function(){return this._list.mouseHandler},function(q$S){this._list.mouseHandler=q$S}),q$W(0,q$a,"dataSource",q$S.prototype._$get_dataSource,function(q$S){this._dataSource=q$S,q$o.superSet(q$K,this,"dataSource",q$S)}),q$W(0,q$a,"source",function(){return this._source}),q$W(0,q$a,"scrollBar",function(){return this._list.scrollBar}),q$W(0,q$a,"list",function(){return this._list}),q$W(0,q$a,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(q$S){this._list.vScrollBarSkin=q$S}),q$W(0,q$a,"renderHandler",function(){return this._renderHandler},function(q$S){this._renderHandler=q$S}),q$W(0,q$a,"selectedIndex",function(){return this._list.selectedIndex},function(q$S){this._list.selectedIndex=q$S}),q$W(0,q$a,"spaceLeft",function(){return this._spaceLeft},function(q$S){this._spaceLeft=q$S}),q$W(0,q$a,"selectedItem",function(){return this._list.selectedItem},function(q$S){this._list.selectedItem=q$S}),q$W(0,q$a,"width",q$S.prototype._$get_width,function(q$S){q$o.superSet(q$K,this,"width",q$S),this._list.width=q$S}),q$W(0,q$a,"height",q$S.prototype._$get_height,function(q$S){q$o.superSet(q$K,this,"height",q$S),this._list.height=q$S}),q$W(0,q$a,"xml",null,function(q$S){var q$_=[];this.parseXml(q$S.childNodes[0],q$_,null,!0),this.array=q$_}),q$W(0,q$a,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),q$_}(q$K),q$SS=function(q$S){function q$_(){this._items=null,this._selectedIndex=0,q$_.__super.call(this),this._setIndexHandler=q$C.create(this,this.setIndex,null,!1)}q$V(q$_,"laya.ui.ViewStack",q$S);var q$a=q$_.prototype;return q$o.imps(q$a,{"laya.ui.IItem":!0}),q$a.setItems=function(q$S){this.removeChildren();for(var q$_=0,q$a=0,q$R=q$S.length;q$a<q$R;q$a++){var q$J=q$S[q$a];q$J&&(q$J.name="item"+q$_,this.addChild(q$J),q$_++)}this.initItems()},q$a.addItem=function(q$S){q$S.name="item"+this._items.length,this.addChild(q$S),this.initItems()},q$a.initItems=function(){this._items=[];for(var q$S=0;q$S<1e4;q$S++){var q$_=this.getChildByName("item"+q$S);if(null==q$_)break;this._items.push(q$_),q$_.visible=q$S==this._selectedIndex}},q$a.setSelect=function(q$S,q$_){this._items&&-1<q$S&&q$S<this._items.length&&(this._items[q$S].visible=q$_)},q$a.setIndex=function(q$S){this.selectedIndex=q$S},q$W(0,q$a,"dataSource",q$S.prototype._$get_dataSource,function(q$S){if("number"==typeof(this._dataSource=q$S)&&Math.floor(q$S)==q$S||"string"==typeof q$S)this.selectedIndex=parseInt(q$S);else for(var q$_ in this._dataSource)this.hasOwnProperty(q$_)&&(this[q$_]=this._dataSource[q$_])}),q$W(0,q$a,"selectedIndex",function(){return this._selectedIndex},function(q$S){this._selectedIndex!=q$S&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=q$S,this.setSelect(this._selectedIndex,!0))}),q$W(0,q$a,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(q$S){this.selectedIndex=this._items.indexOf(q$S)}),q$W(0,q$a,"items",function(){return this._items}),q$W(0,q$a,"setIndexHandler",function(){return this._setIndexHandler},function(q$S){this._setIndexHandler=q$S}),q$_}(q$K),q$_S=function(q$S){function q$_(){q$_.__super.call(this)}return q$V(q$_,"laya.ui.VScrollBar",q$g),q$_}(),q$aS=function(q$_){function q$a(q$S){this._bg=null,this._skin=null,q$a.__super.call(this),void 0===q$S&&(q$S=""),this.text=q$S,this.skin=this.skin}q$V(q$a,"laya.ui.TextInput",q$_);var q$S=q$a.prototype;return q$S.preinitialize=function(){this.mouseEnabled=!0},q$S.destroy=function(q$S){q$T.clearCache(this,this._skin),void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,q$S),this._bg&&this._bg.destroy(),this._bg=null},q$S.createChildren=function(){this.addChild(this._tf=new q$G),this._tf.padding=q$B.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},q$S._onFocus=function(){this.event("focus",this)},q$S._onBlur=function(){this.event("blur",this)},q$S._onInput=function(){this.event("input",this)},q$S._onEnter=function(){this.event("enter",this)},q$S.initialize=function(){this.width=128,this.height=22},q$S.select=function(){this._tf.select()},q$S.setSelection=function(q$S,q$_){this._tf.setSelection(q$S,q$_)},q$W(0,q$S,"text",q$_.prototype._$get_text,function(q$S){this._tf.text!=q$S&&(q$S+="",this._tf.text=q$S,this.event("change"))}),q$W(0,q$S,"bg",function(){return this._bg},function(q$S){this.graphics=this._bg=q$S}),q$W(0,q$S,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(q$S){this._tf.inputElementYAdjuster=q$S}),q$W(0,q$S,"multiline",function(){return this._tf.multiline},function(q$S){this._tf.multiline=q$S}),q$W(0,q$S,"skin",function(){return this._skin},function(q$S){this._skin!=q$S&&(q$T.clearCache(this,this._skin),this._skin=q$S,this._bg||(this.graphics=this._bg=new q$X),q$T.keepCache(this,this._skin),this._bg.source=q$T.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),q$W(0,q$S,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(q$S){this._bg||(this.graphics=this._bg=new q$X),this._bg.sizeGrid=q$I.fillArray(q$B.defaultSizeGrid,q$S,Number)}),q$W(0,q$S,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(q$S){this._tf.inputElementXAdjuster=q$S}),q$W(0,q$S,"width",q$_.prototype._$get_width,function(q$S){q$o.superSet(q$U,this,"width",q$S),this._bg&&(this._bg.width=q$S)}),q$W(0,q$S,"height",q$_.prototype._$get_height,function(q$S){q$o.superSet(q$U,this,"height",q$S),this._bg&&(this._bg.height=q$S)}),q$W(0,q$S,"editable",function(){return this._tf.editable},function(q$S){this._tf.editable=q$S}),q$W(0,q$S,"restrict",function(){return this._tf.restrict},function(q$S){this._tf.restrict=q$S}),q$W(0,q$S,"prompt",function(){return this._tf.prompt},function(q$S){this._tf.prompt=q$S}),q$W(0,q$S,"promptColor",function(){return this._tf.promptColor},function(q$S){this._tf.promptColor=q$S}),q$W(0,q$S,"maxChars",function(){return this._tf.maxChars},function(q$S){this._tf.maxChars=q$S}),q$W(0,q$S,"focus",function(){return this._tf.focus},function(q$S){this._tf.focus=q$S}),q$W(0,q$S,"type",function(){return this._tf.type},function(q$S){this._tf.type=q$S}),q$W(0,q$S,"asPassword",function(){return this._tf.asPassword},function(q$S){this._tf.asPassword=q$S}),q$a}(q$U),q$RS=function(q$S){function q$_(){q$_.__super.call(this)}return q$V(q$_,"laya.ui.VSlider",q$x),q$_}(),q$JS=function(q$S){function q$R(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,q$R.__super.call(this)}q$V(q$R,"laya.ui.Dialog",q$S);var q$_=q$R.prototype;return q$_.initialize=function(){this.popupEffect=q$R.manager.popupEffectHandler,this.closeEffect=q$R.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},q$_._dealDragArea=function(){var q$S=this.getChildByName("drag");q$S&&(this.dragArea=q$S.x+","+q$S.y+","+q$S.width+","+q$S.height,q$S.removeSelf())},q$_._onClick=function(q$S){var q$_=q$S.target;if(q$_)switch(q$_.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(q$_.name)}},q$_.show=function(q$S,q$_){void 0===q$S&&(q$S=!1),void 0===q$_&&(q$_=!0),this._open(!1,q$S,q$_)},q$_.popup=function(q$S,q$_){void 0===q$S&&(q$S=!1),void 0===q$_&&(q$_=!0),this._open(!0,q$S,q$_)},q$_._open=function(q$S,q$_,q$a){q$R.manager.lock(!1),this.isModal=q$S,q$R.manager.open(this,q$_,q$a)},q$_.onOpened=function(){},q$_.close=function(q$S,q$_){void 0===q$_&&(q$_=!0),q$R.manager.close(this,q$S,q$_)},q$_.onClosed=function(q$S){},q$_._onMouseDown=function(q$S){var q$_=this.getMousePoint();this._dragArea.contains(q$_.x,q$_.y)?this.startDrag():this.stopDrag()},q$W(0,q$_,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(q$S){if(q$S){var q$_=q$I.fillArray([0,0,0,0],q$S,Number);this._dragArea=new q$F(q$_[0],q$_[1],q$_[2],q$_[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),q$W(0,q$_,"isPopup",function(){return null!=this.parent}),q$W(0,q$_,"zOrder",q$S.prototype._$get_zOrder,function(q$S){q$o.superSet(q$Y,this,"zOrder",q$S),q$R.manager._checkMask()}),q$W(1,q$R,"manager",function(){return q$R._manager=q$R._manager||new q$u},function(q$S){q$R._manager=q$S}),q$R.setLockView=function(q$S){q$R.manager.setLockView(q$S)},q$R.lock=function(q$S){q$R.manager.lock(q$S)},q$R.closeAll=function(){q$R.manager.closeAll()},q$R.getDialogsByGroup=function(q$S){return q$R.manager.getDialogsByGroup(q$S)},q$R.closeByGroup=function(q$S){return q$R.manager.closeByGroup(q$S)},q$R.CLOSE="close",q$R.CANCEL="cancel",q$R.SURE="sure",q$R.NO="no",q$R.OK="ok",q$R.YES="yes",q$R._manager=null,q$R}(q$Y),q$VS=function(q$S){function q$_(){q$_.__super.call(this)}q$V(q$_,"laya.ui.HBox",q$S);var q$a=q$_.prototype;return q$a.sortItem=function(q$S){q$S&&q$S.sort(function(q$S,q$_){return q$S.x-q$_.x})},q$a.changeItems=function(){this._itemChanged=!1;for(var q$S=[],q$_=0,q$a=0,q$R=this.numChildren;q$a<q$R;q$a++){var q$J=this.getChildAt(q$a);q$J&&q$J.layoutEnabled&&(q$S.push(q$J),q$_=this._height?this._height:Math.max(q$_,q$J.height*q$J.scaleY))}this.sortItem(q$S);var q$V=0;for(q$a=0,q$R=q$S.length;q$a<q$R;q$a++)(q$J=q$S[q$a]).x=q$V,q$V+=q$J.width*q$J.scaleX+this._space,"top"==this._align?q$J.y=0:"middle"==this._align?q$J.y=.5*(q$_-q$J.height*q$J.scaleY):"bottom"==this._align&&(q$J.y=q$_-q$J.height*q$J.scaleY);this.changeSize()},q$W(0,q$a,"height",q$S.prototype._$get_height,function(q$S){this._height!=q$S&&(q$o.superSet(q$Z,this,"height",q$S),this.callLater(this.changeItems))}),q$_.NONE="none",q$_.TOP="top",q$_.MIDDLE="middle",q$_.BOTTOM="bottom",q$_}(q$Z),q$WS=function(q$S){function q$_(){q$_.__super.call(this)}q$V(q$_,"laya.ui.VBox",q$S);var q$a=q$_.prototype;return q$a.changeItems=function(){this._itemChanged=!1;for(var q$S=[],q$_=0,q$a=0,q$R=this.numChildren;q$a<q$R;q$a++){var q$J=this.getChildAt(q$a);q$J&&q$J.layoutEnabled&&(q$S.push(q$J),q$_=this._width?this._width:Math.max(q$_,q$J.width*q$J.scaleX))}this.sortItem(q$S);var q$V=0;for(q$a=0,q$R=q$S.length;q$a<q$R;q$a++)(q$J=q$S[q$a]).y=q$V,q$V+=q$J.height*q$J.scaleY+this._space,"left"==this._align?q$J.x=0:"center"==this._align?q$J.x=.5*(q$_-q$J.width*q$J.scaleX):"right"==this._align&&(q$J.x=q$_-q$J.width*q$J.scaleX);this.changeSize()},q$W(0,q$a,"width",q$S.prototype._$get_width,function(q$S){this._width!=q$S&&(q$o.superSet(q$Z,this,"width",q$S),this.callLater(this.changeItems))}),q$_.NONE="none",q$_.LEFT="left",q$_.CENTER="center",q$_.RIGHT="right",q$_}(q$Z),q$kS=function(q$S){function q$_(){q$_.__super.call(this)}return q$V(q$_,"laya.ui.RadioGroup",q$w),q$_.prototype.createItem=function(q$S,q$_){return new q$v(q$S,q$_)},q$_}(),q$zS=function(q$S){function q$_(){q$_.__super.call(this)}return q$V(q$_,"laya.ui.Tab",q$w),q$_.prototype.createItem=function(q$S,q$_){return new q$P(q$S,q$_)},q$_}(),q$bS=function(q$_){function q$a(q$S){this._vScrollBar=null,this._hScrollBar=null,void 0===q$S&&(q$S=""),q$a.__super.call(this,q$S)}q$V(q$a,"laya.ui.TextArea",q$_);var q$S=q$a.prototype;return q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,q$S),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},q$S.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},q$S.onVBarChanged=function(q$S){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},q$S.onHBarChanged=function(q$S){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},q$S.changeScroll=function(){var q$S=this._vScrollBar&&0<this._tf.maxScrollY,q$_=this._hScrollBar&&0<this._tf.maxScrollX,q$a=q$S?this._width-this._vScrollBar.width:this._width,q$R=q$_?this._height-this._hScrollBar.height:this._height,q$J=this._tf.padding||q$B.labelPadding;this._tf.width=q$a,this._tf.height=q$R,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-q$J[2],this._vScrollBar.y=q$J[1],this._vScrollBar.height=this._height-(q$_?this._hScrollBar.height:0)-q$J[1]-q$J[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=q$R/Math.max(this._tf.textHeight,q$R),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=q$S),this._hScrollBar&&(this._hScrollBar.x=q$J[0],this._hScrollBar.y=this._height-this._hScrollBar.height-q$J[3],this._hScrollBar.width=this._width-(q$S?this._vScrollBar.width:0)-q$J[0]-q$J[2],this._hScrollBar.scrollSize=Math.max(.033*q$a,1),this._hScrollBar.thumbPercent=q$a/Math.max(this._tf.textWidth,q$a),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=q$_)},q$S.scrollTo=function(q$S){this.commitMeasure(),this._tf.scrollY=q$S},q$W(0,q$S,"scrollY",function(){return this._tf.scrollY}),q$W(0,q$S,"width",q$_.prototype._$get_width,function(q$S){q$o.superSet(q$aS,this,"width",q$S),this.callLater(this.changeScroll)}),q$W(0,q$S,"hScrollBar",function(){return this._hScrollBar}),q$W(0,q$S,"height",q$_.prototype._$get_height,function(q$S){q$o.superSet(q$aS,this,"height",q$S),this.callLater(this.changeScroll)}),q$W(0,q$S,"maxScrollX",function(){return this._tf.maxScrollX}),q$W(0,q$S,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(q$S){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new q$_S),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=q$S}),q$W(0,q$S,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(q$S){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new q$y),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=q$S}),q$W(0,q$S,"vScrollBar",function(){return this._vScrollBar}),q$W(0,q$S,"maxScrollY",function(){return this._tf.maxScrollY}),q$W(0,q$S,"scrollX",function(){return this._tf.scrollX}),q$a}(q$aS);!function(q$S){function q$_(){this._uiView=null,this.isCloseOther=!1,q$_.__super.call(this)}q$V(q$_,"laya.ui.AsynDialog",q$JS);var q$a=q$_.prototype;q$a.createView=function(q$S){this._uiView=q$S},q$a._open=function(q$S,q$_,q$a){this.isModal=q$S,this.isCloseOther=q$_,q$JS.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},q$a.onCreated=function(){this.createUI(),this.onOpen()},q$a.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},q$a.onOpen=function(){q$JS.manager.open(this,this.isCloseOther),q$JS.manager.lock(!1)},q$a.close=function(q$S,q$_){void 0===q$_&&(q$_=!0),q$JS.manager.close(this),this.onClose()},q$a.onClose=function(){},q$a.destroy=function(q$S){void 0===q$S&&(q$S=!0),laya.ui.View.prototype.destroy.call(this,q$S),this._uiView=null,this.onDestroy()},q$a.onDestroy=function(){}}();q$o.__init([q$Y])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(q$S,q$_){"use strict";for(var q$a in Object.defineProperty(q$_,"__esModule",{value:!0}),Laya){var q$R=Laya[q$a];q$R&&q$R.__isclass&&(q$_[q$a]=q$R)}}),function(q$C,q$S,q$Q){q$Q.un,q$Q.uns;var q$L=q$Q.static,q$G=q$Q.class,q$t=q$Q.getset,q$R=q$Q.__newvec,q$j=laya.maths.Arith,q$W=laya.webgl.atlas.AtlasResourceManager,q$a=laya.webgl.shader.BaseShader,q$h=laya.utils.Browser,q$k=laya.webgl.utils.Buffer,q$m=laya.utils.Byte,q$J=laya.utils.ClassUtils,q$z=q$Q.Config,q$V=(laya.events.Event,laya.events.EventDispatcher),q$B=laya.utils.Handler,q$F=laya.net.Loader,q$_=laya.net.LoaderManager,q$b=(laya.maths.MathUtil,laya.display.Node),q$o=laya.renders.Render,q$H=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),q$$=laya.resource.Resource,q$T=laya.utils.RunDriver,q$D=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),q$q=laya.display.Sprite,q$N=laya.utils.Stat,q$n=laya.utils.StringKey,q$I=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),q$l=laya.utils.Utils,q$A=laya.webgl.WebGL,q$X=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;q$Q.interface("laya.d3.core.IClone"),q$Q.interface("laya.d3.graphics.IVertex"),q$Q.interface("laya.d3.core.render.IUpdate"),q$Q.interface("laya.d3.core.scene.ITreeNode"),q$Q.interface("laya.d3.core.render.IRenderable");(function(){function q$P(){}q$G(q$P,"laya.d3.animation.AnimationClipParser01"),q$P.READ_DATA=function(){q$P._DATA.offset=q$P._reader.getUint32(),q$P._DATA.size=q$P._reader.getUint32()},q$P.READ_BLOCK=function(){for(var q$S=q$P._BLOCK.count=q$P._reader.getUint16(),q$_=q$P._BLOCK.blockStarts=[],q$a=q$P._BLOCK.blockLengths=[],q$R=0;q$R<q$S;q$R++)q$_.push(q$P._reader.getUint32()),q$a.push(q$P._reader.getUint32())},q$P.READ_STRINGS=function(){var q$S=q$P._reader.getUint32(),q$_=q$P._reader.getUint16(),q$a=q$P._reader.pos;q$P._reader.pos=q$S+q$P._DATA.offset;for(var q$R=0;q$R<q$_;q$R++)q$P._strings[q$R]=q$P._reader.readUTFString();q$P._reader.pos=q$a},q$P.parse=function(q$S,q$_){q$P._animationClip=q$S;(q$P._reader=q$_).__getBuffer();q$P.READ_DATA(),q$P.READ_BLOCK(),q$P.READ_STRINGS();for(var q$a=0,q$R=q$P._BLOCK.count;q$a<q$R;q$a++){var q$J=q$_.getUint16(),q$V=q$P._strings[q$J],q$W=q$P["READ_"+q$V];if(null==q$W)throw new Error("model file err,no this function:"+q$J+" "+q$V);q$W.call()}},q$P.READ_ANIMATIONS=function(){var q$S,q$_=0,q$a=0,q$R=q$P._reader,q$J=q$R.__getBuffer(),q$V=[],q$W=q$R.getUint8();for(q$V.length=q$W,q$_=0;q$_<q$W;q$_++)q$V[q$_]=q$R.getUint16();var q$k=[],q$z=q$R.getUint16();for(q$k.length=q$z,q$_=0;q$_<q$z;q$_++)q$k[q$_]=q$R.getFloat32();var q$b=q$P._animationClip;q$b.name=q$P._strings[q$R.getUint16()];var q$H=q$b._duration=q$R.getFloat32();q$b.islooping=!!q$R.getByte(),q$b._frameRate=q$R.getInt16();var q$L=q$R.getInt16(),q$C=q$b._nodes=new Array;q$C.length=q$L,(q$b._publicClipDatas=[]).length=q$L;var q$G=q$b._nodesMap={},q$t=0,q$o=0;for(q$_=0;q$_<q$L;q$_++){q$S=q$C[q$_]=new q$f;var q$$=q$R.getUint16(),q$F=q$S.path=[];for(q$F.length=q$$,q$a=0;q$a<q$$;q$a++)q$F[q$a]=q$P._strings[q$R.getUint16()];var q$T=q$F.join("/"),q$D=q$G[q$T];q$D||(q$G[q$T]=q$D=[]),q$D.push(q$S);var q$j=q$R.getInt16();-1!==q$j&&(q$S.componentType=q$P._strings[q$j]);var q$Q=q$s._propertyIndexDic[q$P._strings[q$R.getUint16()]];if(null==q$Q)throw new Error("AnimationClipParser01:unknown property name.");var q$m=q$Q<4,q$q=!q$m||q$m&&""===q$F[0];(q$S._cacheProperty=q$q)?q$t++:q$o++,q$S.propertyNameID=q$Q;var q$N=q$V[q$R.getUint8()];q$S.keyFrameWidth=q$N/4;var q$n=q$S.keyFrames=[],q$l=q$n.length=q$R.getUint16(),q$B=null,q$I=NaN;for(q$a=0;q$a<q$l;q$a++){var q$A=q$n[q$a]=new q$U;q$I=q$A.startTime=q$k[q$R.getUint16()];var q$X=q$R.pos;q$A.inTangent=new Float32Array(q$J.slice(q$X,q$X+q$N)),q$R.pos+=q$N,q$X=q$R.pos,q$A.outTangent=new Float32Array(q$J.slice(q$X,q$X+q$N)),q$R.pos+=q$N,q$X=q$R.pos,q$A.data=new Float32Array(q$J.slice(q$X,q$X+q$N)),q$R.pos+=q$N,q$B&&(q$B.next=q$A,q$B.duration=q$I-q$B.startTime),q$B=q$A}q$A.next=null,q$A.duration=q$H-q$I}var q$h=q$b._nodeToCachePropertyMap=new Int32Array(q$L),q$u=q$b._cachePropertyMap=new Int32Array(q$t),q$K=q$b._unCachePropertyMap=new Int32Array(q$o);for(q$t=q$o=0,q$_=0;q$_<q$L;q$_++)(q$S=q$C[q$_])._cacheProperty?(q$h[q$_]=q$t,q$u[q$t++]=q$_):q$K[q$o++]=q$_},q$P._animationClip=null,q$P._reader=null,q$P._strings=[],q$L(q$P,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function q$g(){}q$G(q$g,"laya.d3.animation.AnimationClipParser02"),q$g.READ_DATA=function(){q$g._DATA.offset=q$g._reader.getUint32(),q$g._DATA.size=q$g._reader.getUint32()},q$g.READ_BLOCK=function(){for(var q$S=q$g._BLOCK.count=q$g._reader.getUint16(),q$_=q$g._BLOCK.blockStarts=[],q$a=q$g._BLOCK.blockLengths=[],q$R=0;q$R<q$S;q$R++)q$_.push(q$g._reader.getUint32()),q$a.push(q$g._reader.getUint32())},q$g.READ_STRINGS=function(){var q$S=q$g._reader.getUint32(),q$_=q$g._reader.getUint16(),q$a=q$g._reader.pos;q$g._reader.pos=q$S+q$g._DATA.offset;for(var q$R=0;q$R<q$_;q$R++)q$g._strings[q$R]=q$g._reader.readUTFString();q$g._reader.pos=q$a},q$g.parse=function(q$S,q$_){q$g._animationClip=q$S;(q$g._reader=q$_).__getBuffer();q$g.READ_DATA(),q$g.READ_BLOCK(),q$g.READ_STRINGS();for(var q$a=0,q$R=q$g._BLOCK.count;q$a<q$R;q$a++){var q$J=q$_.getUint16(),q$V=q$g._strings[q$J],q$W=q$g["READ_"+q$V];if(null==q$W)throw new Error("model file err,no this function:"+q$J+" "+q$V);q$W.call()}},q$g.READ_ANIMATIONS=function(){var q$S,q$_=0,q$a=0,q$R=q$g._reader,q$J=q$R.__getBuffer(),q$V=[],q$W=q$R.getUint8();for(q$V.length=q$W,q$_=0;q$_<q$W;q$_++)q$V[q$_]=q$R.getUint16();var q$k=[],q$z=q$R.getUint16();for(q$k.length=q$z,q$_=0;q$_<q$z;q$_++)q$k[q$_]=q$R.getFloat32();var q$b=q$g._animationClip;q$b.name=q$g._strings[q$R.getUint16()];var q$H=q$b._duration=q$R.getFloat32();q$b.islooping=!!q$R.getByte(),q$b._frameRate=q$R.getInt16();var q$L=q$R.getInt16(),q$C=q$b._nodes=new Array;q$C.length=q$L,(q$b._publicClipDatas=[]).length=q$L;var q$G=q$b._nodesMap={},q$t=0,q$o=0;for(q$_=0;q$_<q$L;q$_++){q$S=q$C[q$_]=new q$f;var q$$=q$R.getUint16(),q$F=q$S.path=[];for(q$F.length=q$$,q$a=0;q$a<q$$;q$a++)q$F[q$a]=q$g._strings[q$R.getUint16()];var q$T=q$F.join("/"),q$D=q$G[q$T];q$D||(q$G[q$T]=q$D=[]),q$D.push(q$S);var q$j=q$R.getInt16();-1!==q$j&&(q$S.componentType=q$g._strings[q$j]);var q$Q=q$s._propertyIndexDic[q$g._strings[q$R.getUint16()]];if(null==q$Q)throw new Error("AnimationClipParser02:unknown property name.");var q$m=q$Q<4,q$q=!q$m||q$m&&""===q$F[0];(q$S._cacheProperty=q$q)?q$t++:q$o++,q$S.propertyNameID=q$Q;var q$N=q$V[q$R.getUint8()];q$S.keyFrameWidth=q$N/4;var q$n=q$S.keyFrames=[],q$l=q$n.length=q$R.getUint16(),q$B=null,q$I=NaN;for(q$a=0;q$a<q$l;q$a++){var q$A=q$n[q$a]=new q$U;q$I=q$A.startTime=q$k[q$R.getUint16()];var q$X=q$R.pos;q$A.inTangent=new Float32Array(q$J.slice(q$X,q$X+q$N)),q$R.pos+=q$N,q$X=q$R.pos,q$A.outTangent=new Float32Array(q$J.slice(q$X,q$X+q$N)),q$R.pos+=q$N,q$X=q$R.pos,q$A.data=new Float32Array(q$J.slice(q$X,q$X+q$N)),q$R.pos+=q$N,q$B&&(q$B.next=q$A,q$B.duration=q$I-q$B.startTime),q$B=q$A}q$A.next=null,q$A.duration=q$H-q$I}var q$h=q$R.getUint16();for(q$_=0;q$_<q$h;q$_++){var q$u,q$K=new q$x;q$K.time=q$R.getFloat32(),q$K.eventName=q$g._strings[q$R.getUint16()];var q$P=q$R.getUint16();for(0<q$P&&(q$K.params=q$u=[]),q$a=0;q$a<q$P;q$a++){switch(q$R.getByte()){case 0:q$u.push(!!q$R.getByte());break;case 1:q$u.push(q$R.getInt32());break;case 2:q$u.push(q$R.getFloat32());break;case 3:q$u.push(q$g._strings[q$R.getUint16()]);break;default:throw new Error("unknown type.")}}q$b.addEvent(q$K)}var q$M=q$b._nodeToCachePropertyMap=new Int32Array(q$L),q$r=q$b._cachePropertyMap=new Int32Array(q$t),q$e=q$b._unCachePropertyMap=new Int32Array(q$o);for(q$t=q$o=0,q$_=0;q$_<q$L;q$_++)(q$S=q$C[q$_])._cacheProperty?(q$M[q$_]=q$t,q$r[q$t++]=q$_):q$e[q$o++]=q$_},q$g._animationClip=null,q$g._reader=null,q$g._strings=[],q$L(q$g,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var q$x=function(){function q$S(){this.time=NaN,this.eventName=null,this.params=null}return q$G(q$S,"laya.d3.animation.AnimationEvent"),q$S}(),q$s=function(){function q$R(){this._childs=[],this.transform=new q$T_(this)}q$G(q$R,"laya.d3.animation.AnimationNode");var q$S=q$R.prototype;return q$Q.imps(q$S,{"laya.d3.core.IClone":!0}),q$S.addChild=function(q$S){q$S._parent=this,q$S.transform.setParent(this.transform),this._childs.push(q$S)},q$S.removeChild=function(q$S){var q$_=this._childs.indexOf(q$S);-1!==q$_&&this._childs.splice(q$_,1)},q$S.getChildByName=function(q$S){for(var q$_=0,q$a=this._childs.length;q$_<q$a;q$_++){var q$R=this._childs[q$_];if(q$R.name===q$S)return q$R}return null},q$S.getChildByIndex=function(q$S){return this._childs[q$S]},q$S.getChildCount=function(){return this._childs.length},q$S.cloneTo=function(q$S){var q$_=q$S;q$_.name=this.name;for(var q$a=0,q$R=this._childs.length;q$a<q$R;q$a++){var q$J=this._childs[q$a],q$V=q$J.clone();q$_.addChild(q$V);var q$W=q$J.transform,q$k=q$V.transform;q$k.setLocalPosition(q$W.getLocalPosition()),q$k.setLocalRotation(q$W.getLocalRotation()),q$k.setLocalScale(q$W.getLocalScale()),q$k._localRotationEuler=q$W._localRotationEuler,q$k._setWorldMatrixIgnoreUpdate(q$W.getWorldMatrix())}},q$S.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$R.__init__=function(){q$R.registerAnimationNodeProperty("localPosition",q$R._getLocalPosition,q$R._setLocalPosition),q$R.registerAnimationNodeProperty("localRotation",q$R._getLocalRotation,q$R._setLocalRotation),q$R.registerAnimationNodeProperty("localScale",q$R._getLocalScale,q$R._setLocalScale),q$R.registerAnimationNodeProperty("localRotationEuler",q$R._getLocalRotationEuler,q$R._setLocalRotationEuler),q$R.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",q$R._getParticleRenderSharedMaterialTintColor,q$R._setParticleRenderSharedMaterialTintColor),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",q$R._getMeshRenderSharedMaterialTilingOffset,q$R._setMeshRenderSharedMaterialTilingOffset),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",q$R._getMeshRenderSharedMaterialAlbedo,q$R._setMeshRenderSharedMaterialAlbedo),q$R.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",q$R._getSkinnedMeshRenderSharedMaterialTilingOffset,q$R._setSkinnedMeshRenderSharedMaterialTilingOffset),q$R.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",q$R._getSkinnedMeshRenderSharedMaterialAlbedo,q$R._setSkinnedMeshRenderSharedMaterialAlbedo),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",q$R._getMeshRenderSharedMaterialAlbedo,q$R._setMeshRenderSharedMaterialAlbedo),q$R.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",q$R._getSkinnedMeshRenderSharedMaterialAlbedo,q$R._setSkinnedMeshRenderSharedMaterialAlbedo),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",q$R._getMeshRenderSharedMaterialIntensity,q$R._setMeshRenderSharedMaterialIntensity),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",q$R._getMeshRenderSharedMaterialAlpha,q$R._setMeshRenderSharedMaterialAlpha),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",q$R._getMeshRenderSharedMaterialAlphaColor,q$R._setMeshRenderSharedMaterialAlphaColor),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",q$R._getMeshRenderSharedMaterialBaseColor,q$R._setMeshRenderSharedMaterialBaseColor),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",q$R._getMeshRenderSharedMaterialDissolve,q$R._setMeshRenderSharedMaterialDissolve),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",q$R._getMeshRenderSharedMaterialDissolveSpeed,q$R._setMeshRenderSharedMaterialDissolveSpeed),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",q$R._getMeshRenderSharedMaterialMMultiplier,q$R._setMeshRenderSharedMaterialMMultiplier),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",q$R._getMeshRenderSharedMaterialBaseScrollSpeedX,q$R._setMeshRenderSharedMaterialBaseScrollSpeedX),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",q$R._getMeshRenderSharedMaterialBaseScrollSpeedY,q$R._setMeshRenderSharedMaterialBaseScrollSpeedY),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",q$R._getMeshRenderSharedMaterialSecondScrollSpeedX,q$R._setMeshRenderSharedMaterialSecondScrollSpeedX),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",q$R._getMeshRenderSharedMaterialSecondScrollSpeedY,q$R._setMeshRenderSharedMaterialSecondScrollSpeedY),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",q$R._getMeshRenderSharedMaterialDetailTilingOffset,q$R._setMeshRenderSharedMaterialDetailTilingOffset),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",q$R._getMeshRenderSharedMaterialDissolveTilingOffset,q$R._setMeshRenderSharedMaterialDissolveTilingOffset),q$R.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",q$R._getMeshRenderSharedMaterialMaskTilingOffset,q$R._setMeshRenderSharedMaterialMaskTilingOffset)},q$R.registerAnimationNodeProperty=function(q$S,q$_,q$a){if(q$R._propertyIndexDic[q$S])throw new Error("AnimationNode: this propertyName has registered.");q$R._propertyIndexDic[q$S]=q$R._propertyIDCounter,q$R._propertyGetFuncs[q$R._propertyIDCounter]=q$_,q$R._propertySetFuncs[q$R._propertyIDCounter]=q$a,q$R._propertyIDCounter++},q$R._getLocalPosition=function(q$S,q$_){return q$S?q$S.transform.getLocalPosition():q$_._transform.localPosition.elements},q$R._setLocalPosition=function(q$S,q$_,q$a){if(q$S)q$S.transform.setLocalPosition(q$a);else{var q$R=q$_._transform,q$J=q$R.localPosition;q$J.elements=q$a,q$R.localPosition=q$J}},q$R._getLocalRotation=function(q$S,q$_){return q$S?q$S.transform.getLocalRotation():q$_._transform.localRotation.elements},q$R._setLocalRotation=function(q$S,q$_,q$a){if(q$S)q$S.transform.setLocalRotation(q$a);else{var q$R=q$_._transform,q$J=q$R.localRotation;q$J.elements=q$a,q$R.localRotation=q$J}},q$R._getLocalScale=function(q$S,q$_){return q$S?q$S.transform.getLocalScale():q$_._transform.localScale.elements},q$R._setLocalScale=function(q$S,q$_,q$a){if(q$S)q$S.transform.setLocalScale(q$a);else{var q$R=q$_._transform,q$J=q$R.localScale;q$J.elements=q$a,q$R.localScale=q$J}},q$R._getLocalRotationEuler=function(q$S,q$_){return q$S?q$S.transform.getLocalRotationEuler():q$_._transform.localRotationEuler.elements},q$R._setLocalRotationEuler=function(q$S,q$_,q$a){if(q$S)q$S.transform.setLocalRotationEuler(q$a);else{var q$R=q$_._transform,q$J=q$R.localRotationEuler;q$J.elements=q$a,q$R.localRotationEuler=q$J}},q$R._getMeshRenderSharedMaterialTilingOffset=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return q$_.meshRender.sharedMaterial.tilingOffset.elements},q$R._setMeshRenderSharedMaterialTilingOffset=function(q$S,q$_,q$a){var q$R,q$J;if(q$S){var q$V=q$S.transform._entity;q$V&&((q$J=(q$R=q$V.owner.meshRender.material).tilingOffset).elements=q$a,q$R.tilingOffset=q$J)}else(q$J=(q$R=q$_.meshRender.material).tilingOffset).elements=q$a,q$R.tilingOffset=q$J},q$R._getMeshRenderSharedMaterialAlbedo=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.albedoColor.elements:null}return q$_.meshRender.sharedMaterial.albedoColor.elements},q$R._setMeshRenderSharedMaterialAlbedo=function(q$S,q$_,q$a){var q$R,q$J;if(q$S){var q$V=q$S.transform._entity;q$V&&((q$J=(q$R=q$V.owner.meshRender.material).albedoColor).elements=q$a,q$R.albedoColor=q$J)}else(q$J=(q$R=q$_.meshRender.material).albedoColor).elements=q$a,q$R.albedoColor=q$J},q$R._getSkinnedMeshRenderSharedMaterialTilingOffset=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return q$_.skinnedMeshRender.sharedMaterial.tilingOffset.elements},q$R._setSkinnedMeshRenderSharedMaterialTilingOffset=function(q$S,q$_,q$a){var q$R,q$J;if(q$S){var q$V=q$S.transform._entity;q$V&&((q$J=(q$R=q$V.owner.skinnedMeshRender.material).tilingOffset).elements=q$a,q$R.tilingOffset=q$J)}else(q$J=(q$R=q$_.skinnedMeshRender.material).tilingOffset).elements=q$a,q$R.tilingOffset=q$J},q$R._getSkinnedMeshRenderSharedMaterialAlbedo=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return q$_.skinnedMeshRender.sharedMaterial.albedoColor.elements},q$R._setSkinnedMeshRenderSharedMaterialAlbedo=function(q$S,q$_,q$a){var q$R,q$J;if(q$S){var q$V=q$S.transform._entity;q$V&&((q$J=(q$R=q$V.owner.skinnedMeshRender.material).albedoColor).elements=q$a,q$R.albedoColor=q$J)}else(q$J=(q$R=q$_.skinnedMeshRender.material).albedoColor).elements=q$a,q$R.albedoColor=q$J},q$R._getParticleRenderSharedMaterialTintColor=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.particleRender.sharedMaterial.tintColor.elements:null}return q$_.particleRender.sharedMaterial.tintColor.elements},q$R._setParticleRenderSharedMaterialTintColor=function(q$S,q$_,q$a){var q$R,q$J;if(q$S){var q$V=q$S.transform._entity;q$V&&((q$J=(q$R=q$V.owner.particleRender.material).tintColor).elements=q$a,q$R.tintColor=q$J)}else(q$J=(q$R=q$_.particleRender.material).tintColor).elements=q$a,q$R.tintColor=q$J},q$R._getMeshRenderSharedMaterialAlphaColor=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.alphaColor.elements:null}return q$_.meshRender.sharedMaterial.alphaColor.elements},q$R._setMeshRenderSharedMaterialAlphaColor=function(q$S,q$_,q$a){var q$R,q$J;if(q$S){var q$V=q$S.transform._entity;q$V&&((q$J=(q$R=q$V.owner.meshRender.material).alphaColor).elements=q$a,q$R.alphaColor=q$J)}else(q$J=(q$R=q$_.meshRender.material).alphaColor).elements=q$a,q$R.alphaColor=q$J},q$R._getMeshRenderSharedMaterialBaseColor=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.baseColor.elements:null}return q$_.meshRender.sharedMaterial.baseColor.elements},q$R._setMeshRenderSharedMaterialBaseColor=function(q$S,q$_,q$a){var q$R,q$J;if(q$S){var q$V=q$S.transform._entity;q$V&&((q$J=(q$R=q$V.owner.meshRender.material).baseColor).elements=q$a,q$R.baseColor=q$J)}else(q$J=(q$R=q$_.meshRender.material).baseColor).elements=q$a,q$R.baseColor=q$J},q$R._getMeshRenderSharedMaterialDissolve=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.dissolve:0}return q$_.meshRender.sharedMaterial.dissolve},q$R._setMeshRenderSharedMaterialDissolve=function(q$S,q$_,q$a){if(q$S){var q$R=q$S.transform._entity;q$R&&(q$R.owner.meshRender.material.dissolve=q$a[0])}else q$_.meshRender.material.dissolve=q$a[0]},q$R._getMeshRenderSharedMaterialDissolveSpeed=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.dissolveSpeed:0}return q$_.meshRender.sharedMaterial.dissolveSpeed},q$R._setMeshRenderSharedMaterialDissolveSpeed=function(q$S,q$_,q$a){if(q$S){var q$R=q$S.transform._entity;q$R&&(q$R.owner.meshRender.material.dissolveSpeed=q$a[0])}else q$_.meshRender.material.dissolveSpeed=q$a[0]},q$R._getMeshRenderSharedMaterialMMultiplier=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.mMultiplier:0}return q$_.meshRender.sharedMaterial.mMultiplier},q$R._setMeshRenderSharedMaterialMMultiplier=function(q$S,q$_,q$a){if(q$S){var q$R=q$S.transform._entity;q$R&&(q$R.owner.meshRender.material.mMultiplier=q$a[0])}else q$_.meshRender.material.mMultiplier=q$a[0]},q$R._getMeshRenderSharedMaterialBaseScrollSpeedX=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return q$_.meshRender.sharedMaterial.baseScrollSpeedX},q$R._setMeshRenderSharedMaterialBaseScrollSpeedX=function(q$S,q$_,q$a){if(q$S){var q$R=q$S.transform._entity;q$R&&(q$R.owner.meshRender.material.baseScrollSpeedX=q$a[0])}else q$_.meshRender.material.baseScrollSpeedX=q$a[0]},q$R._getMeshRenderSharedMaterialBaseScrollSpeedY=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return q$_.meshRender.sharedMaterial.baseScrollSpeedY},q$R._setMeshRenderSharedMaterialBaseScrollSpeedY=function(q$S,q$_,q$a){if(q$S){var q$R=q$S.transform._entity;q$R&&(q$R.owner.meshRender.material.baseScrollSpeedY=q$a[0])}else q$_.meshRender.material.baseScrollSpeedY=q$a[0]},q$R._getMeshRenderSharedMaterialSecondScrollSpeedX=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return q$_.meshRender.sharedMaterial.secondScrollSpeedX},q$R._setMeshRenderSharedMaterialSecondScrollSpeedX=function(q$S,q$_,q$a){if(q$S){var q$R=q$S.transform._entity;q$R&&(q$R.owner.meshRender.material.secondScrollSpeedX=q$a[0])}else q$_.meshRender.material.secondScrollSpeedX=q$a[0]},q$R._getMeshRenderSharedMaterialSecondScrollSpeedY=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return q$_.meshRender.sharedMaterial.secondScrollSpeedY},q$R._setMeshRenderSharedMaterialSecondScrollSpeedY=function(q$S,q$_,q$a){if(q$S){var q$R=q$S.transform._entity;q$R&&(q$R.owner.meshRender.material.secondScrollSpeedY=q$a[0])}else q$_.meshRender.material.secondScrollSpeedY=q$a[0]},q$R._getMeshRenderSharedMaterialAlpha=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.alpha:0}return q$_.meshRender.sharedMaterial.alpha},q$R._setMeshRenderSharedMaterialAlpha=function(q$S,q$_,q$a){if(q$S){var q$R=q$S.transform._entity;q$R&&(q$R.owner.meshRender.material.alpha=q$a[0])}else q$_.meshRender.material.alpha=q$a[0]},q$R._getMeshRenderSharedMaterialIntensity=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.intensity:0}return q$_.meshRender.sharedMaterial.intensity},q$R._setMeshRenderSharedMaterialIntensity=function(q$S,q$_,q$a){if(q$S){var q$R=q$S.transform._entity;q$R&&(q$R.owner.meshRender.material.intensity=q$a[0])}else q$_.meshRender.material.intensity=q$a[0]},q$R._getMeshRenderSharedMaterialDetailTilingOffset=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return q$_.meshRender.sharedMaterial.detailTilingOffset.elements},q$R._setMeshRenderSharedMaterialDetailTilingOffset=function(q$S,q$_,q$a){var q$R,q$J;if(q$S){var q$V=q$S.transform._entity;q$V&&((q$J=(q$R=q$V.owner.meshRender.material).detailTilingOffset).elements=q$a,q$R.detailTilingOffset=q$J)}else(q$J=(q$R=q$_.meshRender.material).detailTilingOffset).elements=q$a,q$R.detailTilingOffset=q$J},q$R._getMeshRenderSharedMaterialDissolveTilingOffset=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return q$_.meshRender.sharedMaterial.dissolveTilingOffset.elements},q$R._setMeshRenderSharedMaterialDissolveTilingOffset=function(q$S,q$_,q$a){var q$R,q$J;if(q$S){var q$V=q$S.transform._entity;q$V&&((q$J=(q$R=q$V.owner.meshRender.material).dissolveTilingOffset).elements=q$a,q$R.dissolveTilingOffset=q$J)}else(q$J=(q$R=q$_.meshRender.material).dissolveTilingOffset).elements=q$a,q$R.dissolveTilingOffset=q$J},q$R._getMeshRenderSharedMaterialMaskTilingOffset=function(q$S,q$_){if(q$S){var q$a=q$S.transform._entity;return q$a?q$a.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return q$_.meshRender.sharedMaterial.maskTilingOffset.elements},q$R._setMeshRenderSharedMaterialMaskTilingOffset=function(q$S,q$_,q$a){var q$R,q$J;if(q$S){var q$V=q$S.transform._entity;q$V&&((q$J=(q$R=q$V.owner.meshRender.material).maskTilingOffset).elements=q$a,q$R.maskTilingOffset=q$J)}else(q$J=(q$R=q$_.meshRender.material).maskTilingOffset).elements=q$a,q$R.maskTilingOffset=q$J},q$R._propertyIDCounter=0,q$R._propertyIndexDic={},q$R._propertySetFuncs=[],q$R._propertyGetFuncs=[],q$R}(),q$U=function(){function q$S(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return q$G(q$S,"laya.d3.animation.Keyframe"),q$S}(),q$f=function(){function q$S(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return q$G(q$S,"laya.d3.animation.KeyframeNode"),q$S}(),q$u=(function(){function q$S(){this._tempVector30=new q$W_,this._tempVector31=new q$W_,this._tempVector32=new q$W_,this._a=new q$W_,this._b=new q$W_,this._c=new q$W_,this._d=new q$W_}q$G(q$S,"laya.d3.core.glitter.SplineCurvePositionVelocity");var q$_=q$S.prototype;q$_.Init=function(q$S,q$_,q$a,q$R){q$S.cloneTo(this._d),q$_.cloneTo(this._c),q$W_.scale(q$S,2,this._a),q$W_.scale(q$a,2,this._tempVector30),q$W_.subtract(this._a,this._tempVector30,this._a),q$W_.add(this._a,q$_,this._a),q$W_.add(this._a,q$R,this._a),q$W_.scale(q$a,3,this._b),q$W_.scale(q$S,3,this._tempVector30),q$W_.subtract(this._b,this._tempVector30,this._b),q$W_.subtract(this._b,q$R,this._b),q$W_.scale(q$_,2,this._tempVector30),q$W_.subtract(this._b,this._tempVector30,this._b)},q$_.Slerp=function(q$S,q$_){q$W_.scale(this._a,q$S*q$S*q$S,this._tempVector30),q$W_.scale(this._b,q$S*q$S,this._tempVector31),q$W_.scale(this._c,q$S,this._tempVector32),q$W_.add(this._tempVector30,this._tempVector31,q$_),q$W_.add(q$_,this._tempVector32,q$_),q$W_.add(q$_,this._d,q$_)}}(),function(){function q$r(q$S,q$_,q$a,q$R){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=q$S,this._h=q$_,this._minHeight=q$a,this._maxHeight=q$R}q$G(q$r,"laya.d3.core.HeightMap");var q$S=q$r.prototype;q$S._inBounds=function(q$S,q$_){return 0<=q$S&&q$S<this._h&&0<=q$_&&q$_<this._w},q$S.getHeight=function(q$S,q$_){return this._inBounds(q$S,q$_)?this._datas[q$S][q$_]:NaN},q$t(0,q$S,"width",function(){return this._w}),q$t(0,q$S,"height",function(){return this._h}),q$t(0,q$S,"maxHeight",function(){return this._maxHeight}),q$t(0,q$S,"minHeight",function(){return this._minHeight}),q$r.creatFromMesh=function(q$S,q$_,q$a,q$R){for(var q$J=[],q$V=[],q$W=q$S.getSubMeshCount(),q$k=0;q$k<q$W;q$k++){for(var q$z=q$S.getSubMesh(q$k),q$b=q$z._getVertexBuffer(),q$H=q$b.getData(),q$L=[],q$C=0;q$C<q$H.length;q$C+=q$b.vertexDeclaration.vertexStride/4){var q$G=new q$W_(q$H[q$C+0],q$H[q$C+1],q$H[q$C+2]);q$L.push(q$G)}q$J.push(q$L);var q$t=q$z._getIndexBuffer();q$V.push(q$t.getData())}var q$o=q$S.boundingBox,q$$=q$o.min.x,q$F=q$o.min.z,q$T=q$o.max.x,q$D=q$o.max.z,q$j=q$o.min.y,q$Q=q$o.max.y,q$m=q$T-q$$,q$q=q$D-q$F,q$N=q$R.elements[0]=q$m/(q$_-1),q$n=q$R.elements[1]=q$q/(q$a-1),q$l=new q$r(q$_,q$a,q$j,q$Q),q$B=q$r._tempRay,q$I=q$B.direction.elements;q$I[0]=0,q$I[1]=-1,q$I[2]=0;var q$A=q$Q+.1;q$B.origin.elements[1]=q$A;for(var q$X=0;q$X<q$a;q$X++){var q$h=q$F+q$X*q$n;q$l._datas[q$X]=[];for(var q$u=0;q$u<q$_;q$u++){var q$K=q$$+q$u*q$N,q$P=q$B.origin.elements;q$P[0]=q$K,q$P[2]=q$h;var q$M=q$r._getPosition(q$B,q$J,q$V);q$l._datas[q$X][q$u]=q$M===Number.MAX_VALUE?NaN:q$A-q$M}}return q$l},q$r.createFromImage=function(q$S,q$_,q$a){for(var q$R=q$S.width,q$J=q$S.height,q$V=new q$r(q$R,q$J,q$_,q$a),q$W=(q$a-q$_)/254,q$k=q$S.getPixels(),q$z=0,q$b=0;q$b<q$J;q$b++)for(var q$H=q$V._datas[q$b]=[],q$L=0;q$L<q$R;q$L++){var q$C=q$k[q$z++],q$G=q$k[q$z++],q$t=q$k[q$z++],q$o=q$k[q$z++];q$H[q$L]=255==q$C&&255==q$G&&255==q$t&&255==q$o?NaN:(q$C+q$G+q$t)/3*q$W+q$_}return q$V},q$r._getPosition=function(q$S,q$_,q$a){for(var q$R=Number.MAX_VALUE,q$J=0;q$J<q$_.length;q$J++)for(var q$V=q$_[q$J],q$W=q$a[q$J],q$k=0;q$k<q$W.length;q$k+=3){var q$z=q$V[q$W[q$k+0]],q$b=q$V[q$W[q$k+1]],q$H=q$V[q$W[q$k+2]],q$L=q$t_.rayIntersectsTriangle(q$S,q$z,q$b,q$H);!isNaN(q$L)&&q$L<q$R&&(q$R=q$L)}return q$R},q$L(q$r,["_tempRay",function(){return this._tempRay=new q$J_(new q$W_,new q$W_)}])}(),function(){function q$J(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}q$G(q$J,"laya.d3.core.Layer");var q$S=q$J.prototype;return q$S._binarySearchIndex=function(){for(var q$S=0,q$_=q$J._collsionTestList.length-1,q$a=0;q$S<=q$_;){q$a=Math.floor((q$S+q$_)/2);var q$R=q$J._collsionTestList[q$a];if(q$R==this._number)return q$a;q$R>this._number?q$_=q$a-1:q$S=q$a+1}return q$S},q$S._addCollider=function(q$S){0===this._colliders.length&&q$J._collsionTestList.splice(this._binarySearchIndex(),0,this._number),q$S._isRigidbody?(this._colliders.unshift(q$S),this._nonRigidbodyOffset++):this._colliders.push(q$S)},q$S._removeCollider=function(q$S){var q$_=this._colliders.indexOf(q$S);q$_<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(q$_,1),0===this._colliders.length&&q$J._collsionTestList.splice(q$J._collsionTestList.indexOf(this._number),1)},q$t(0,q$S,"number",function(){return this._number}),q$t(0,q$S,"visible",function(){return this._visible},function(q$S){this._visible=q$S,q$J._visibleLayers=q$S?q$J._visibleLayers|this.mask:q$J._visibleLayers&~this.mask}),q$t(0,q$S,"mask",function(){return this._mask}),q$t(1,q$J,"visibleLayers",function(){return q$J._visibleLayers},function(q$S){q$J._visibleLayers=q$S;for(var q$_=0,q$a=q$J._layerList.length;q$_<q$a;q$_++){var q$R=q$J._layerList[q$_];q$R._visible=0!=(q$R._mask&q$J._visibleLayers)}}),q$J.__init__=function(){q$J._layerList.length=31;for(var q$S=0;q$S<31;q$S++){var q$_=new q$J;q$J._layerList[q$S]=q$_,0===q$S?(q$_.name="Default Layer",q$_.visible=!0):(q$_.name="Layer-"+q$S,q$_.visible=!1),q$_._number=q$S,q$_._mask=Math.pow(2,q$S)}q$J.currentCreationLayer=q$J._layerList[0]},q$J.getLayerByNumber=function(q$S){if(q$S<0||30<q$S)throw new Error("无法返回指定Layer，该number超出范围！");return q$J._layerList[q$S]},q$J.getLayerByName=function(q$S){for(var q$_=0;q$_<31;q$_++)if(q$J._layerList[q$_].name===q$S)return q$J._layerList[q$_];throw new Error("无法返回指定Layer,该name不存在")},q$J.isVisible=function(q$S){return 0!=(q$S&q$J._currentCameraCullingMask&q$J._visibleLayers)},q$J._layerList=[],q$J._visibleLayers=2147483647,q$J._collsionTestList=[],q$J._currentCameraCullingMask=2147483647,q$J.maxCount=31,q$J.currentCreationLayer=null,q$J}()),q$K=(function(){function q$S(q$S,q$_,q$a){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=q$S,this._minCount=q$_,this._maxCount=q$a}q$G(q$S,"laya.d3.core.particleShuriKen.module.Burst");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_.cloneTo=function(q$S){var q$_=q$S;q$_._time=this._time,q$_._minCount=this._minCount,q$_._maxCount=this._maxCount},q$_.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$_,"time",function(){return this._time}),q$t(0,q$_,"minCount",function(){return this._minCount}),q$t(0,q$_,"maxCount",function(){return this._maxCount})}(),function(){function q$S(q$S){this._color=null,this.enbale=!1,this._color=q$S}q$G(q$S,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var q$_=q$S.prototype;q$_.cloneTo=function(q$S){var q$_=q$S;this._color.cloneTo(q$_._color),q$_.enbale=this.enbale},q$_.clone=function(){var q$S;switch(this._color.type){case 0:q$S=q$M.createByConstant(this._color.constant.clone());break;case 1:q$S=q$M.createByGradient(this._color.gradient.clone());break;case 2:q$S=q$M.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:q$S=q$M.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var q$_=new this.constructor(q$S);return q$_.enbale=this.enbale,q$_},q$t(0,q$_,"color",function(){return this._color})}(),function(){function q$S(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}q$G(q$S,"laya.d3.core.particleShuriKen.module.Emission");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),q$_._destroy=function(){this._bursts=null,this._destroyed=!0},q$_.getBurstsCount=function(){return this._bursts.length},q$_.getBurstByIndex=function(q$S){return this._bursts[q$S]},q$_.addBurst=function(q$S){var q$_=this._bursts.length;if(0<q$_)for(var q$a=0;q$a<q$_;q$a++)this._bursts[q$a].time>q$S.time&&this._bursts.splice(q$a,0,q$S);this._bursts.push(q$S)},q$_.removeBurst=function(q$S){var q$_=this._bursts.indexOf(q$S);-1!==q$_&&this._bursts.splice(q$_,1)},q$_.removeBurstByIndex=function(q$S){this._bursts.splice(q$S,1)},q$_.clearBurst=function(){this._bursts.length=0},q$_.cloneTo=function(q$S){var q$_=q$S,q$a=q$_._bursts;q$a.length=this._bursts.length;for(var q$R=0,q$J=this._bursts.length;q$R<q$J;q$R++){var q$V=q$a[q$R];q$V?this._bursts[q$R].cloneTo(q$V):q$a[q$R]=this._bursts[q$R].clone()}q$_._emissionRate=this._emissionRate,q$_.enbale=this.enbale},q$_.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$_,"destroyed",function(){return this._destroyed}),q$t(0,q$_,"emissionRate",function(){return this._emissionRate},function(q$S){if(q$S<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=q$S})}(),function(){function q$R(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}q$G(q$R,"laya.d3.core.particleShuriKen.module.FrameOverTime");var q$S=q$R.prototype;return q$Q.imps(q$S,{"laya.d3.core.IClone":!0}),q$S.cloneTo=function(q$S){var q$_=q$S;q$_._type=this._type,q$_._constant=this._constant,this._overTime.cloneTo(q$_._overTime),q$_._constantMin=this._constantMin,q$_._constantMax=this._constantMax,this._overTimeMin.cloneTo(q$_._overTimeMin),this._overTimeMax.cloneTo(q$_._overTimeMax)},q$S.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$S,"frameOverTimeData",function(){return this._overTime}),q$t(0,q$S,"constant",function(){return this._constant}),q$t(0,q$S,"type",function(){return this._type}),q$t(0,q$S,"frameOverTimeDataMin",function(){return this._overTimeMin}),q$t(0,q$S,"constantMin",function(){return this._constantMin}),q$t(0,q$S,"frameOverTimeDataMax",function(){return this._overTimeMax}),q$t(0,q$S,"constantMax",function(){return this._constantMax}),q$R.createByConstant=function(q$S){var q$_=new q$R;return q$_._type=0,q$_._constant=q$S,q$_},q$R.createByOverTime=function(q$S){var q$_=new q$R;return q$_._type=1,q$_._overTime=q$S,q$_},q$R.createByRandomTwoConstant=function(q$S,q$_){var q$a=new q$R;return q$a._type=2,q$a._constantMin=q$S,q$a._constantMax=q$_,q$a},q$R.createByRandomTwoOverTime=function(q$S,q$_){var q$a=new q$R;return q$a._type=3,q$a._overTimeMin=q$S,q$a._overTimeMax=q$_,q$a},q$R}()),q$P=function(){function q$b(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}q$G(q$b,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var q$S=q$b.prototype;return q$Q.imps(q$S,{"laya.d3.core.IClone":!0}),q$S.cloneTo=function(q$S){var q$_=q$S;q$_._type=this._type,q$_._separateAxes=this._separateAxes,q$_._constant=this._constant,this._constantSeparate.cloneTo(q$_._constantSeparate),this._gradient.cloneTo(q$_._gradient),this._gradientX.cloneTo(q$_._gradientX),this._gradientY.cloneTo(q$_._gradientY),this._gradientZ.cloneTo(q$_._gradientZ),q$_._constantMin=this._constantMin,q$_._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(q$_._constantMinSeparate),this._constantMaxSeparate.cloneTo(q$_._constantMaxSeparate),this._gradientMin.cloneTo(q$_._gradientMin),this._gradientMax.cloneTo(q$_._gradientMax),this._gradientXMin.cloneTo(q$_._gradientXMin),this._gradientXMax.cloneTo(q$_._gradientXMax),this._gradientYMin.cloneTo(q$_._gradientYMin),this._gradientYMax.cloneTo(q$_._gradientYMax),this._gradientZMin.cloneTo(q$_._gradientZMin),this._gradientZMax.cloneTo(q$_._gradientZMax)},q$S.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$S,"gradientZ",function(){return this._gradientZ}),q$t(0,q$S,"constant",function(){return this._constant}),q$t(0,q$S,"gradient",function(){return this._gradient}),q$t(0,q$S,"separateAxes",function(){return this._separateAxes}),q$t(0,q$S,"type",function(){return this._type}),q$t(0,q$S,"constantSeparate",function(){return this._constantSeparate}),q$t(0,q$S,"gradientX",function(){return this._gradientX}),q$t(0,q$S,"gradientY",function(){return this._gradientY}),q$t(0,q$S,"gradientW",function(){return this._gradientW}),q$t(0,q$S,"gradientMin",function(){return this._gradientMin}),q$t(0,q$S,"constantMin",function(){return this._constantMin}),q$t(0,q$S,"gradientMax",function(){return this._gradientMax}),q$t(0,q$S,"constantMax",function(){return this._constantMax}),q$t(0,q$S,"gradientWMin",function(){return this._gradientWMin}),q$t(0,q$S,"constantMinSeparate",function(){return this._constantMinSeparate}),q$t(0,q$S,"constantMaxSeparate",function(){return this._constantMaxSeparate}),q$t(0,q$S,"gradientXMin",function(){return this._gradientXMin}),q$t(0,q$S,"gradientXMax",function(){return this._gradientXMax}),q$t(0,q$S,"gradientWMax",function(){return this._gradientWMax}),q$t(0,q$S,"gradientYMin",function(){return this._gradientYMin}),q$t(0,q$S,"gradientYMax",function(){return this._gradientYMax}),q$t(0,q$S,"gradientZMin",function(){return this._gradientZMin}),q$t(0,q$S,"gradientZMax",function(){return this._gradientZMax}),q$b.createByConstant=function(q$S){var q$_=new q$b;return q$_._type=0,q$_._separateAxes=!1,q$_._constant=q$S,q$_},q$b.createByConstantSeparate=function(q$S){var q$_=new q$b;return q$_._type=0,q$_._separateAxes=!0,q$_._constantSeparate=q$S,q$_},q$b.createByGradient=function(q$S){var q$_=new q$b;return q$_._type=1,q$_._separateAxes=!1,q$_._gradient=q$S,q$_},q$b.createByGradientSeparate=function(q$S,q$_,q$a,q$R){var q$J=new q$b;return q$J._type=1,q$J._separateAxes=!0,q$J._gradientX=q$S,q$J._gradientY=q$_,q$J._gradientZ=q$a,q$J._gradientW=q$R,q$J},q$b.createByRandomTwoConstant=function(q$S,q$_){var q$a=new q$b;return q$a._type=2,q$a._separateAxes=!1,q$a._constantMin=q$S,q$a._constantMax=q$_,q$a},q$b.createByRandomTwoConstantSeparate=function(q$S,q$_){var q$a=new q$b;return q$a._type=2,q$a._separateAxes=!0,q$a._constantMinSeparate=q$S,q$a._constantMaxSeparate=q$_,q$a},q$b.createByRandomTwoGradient=function(q$S,q$_){var q$a=new q$b;return q$a._type=3,q$a._separateAxes=!1,q$a._gradientMin=q$S,q$a._gradientMax=q$_,q$a},q$b.createByRandomTwoGradientSeparate=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){var q$z=new q$b;return q$z._type=3,q$z._separateAxes=!0,q$z._gradientXMin=q$S,q$z._gradientXMax=q$_,q$z._gradientYMin=q$a,q$z._gradientYMax=q$R,q$z._gradientZMin=q$J,q$z._gradientZMax=q$V,q$z._gradientWMin=q$W,q$z._gradientWMax=q$k,q$z},q$b}(),q$M=function(){function q$R(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}q$G(q$R,"laya.d3.core.particleShuriKen.module.GradientColor");var q$S=q$R.prototype;return q$Q.imps(q$S,{"laya.d3.core.IClone":!0}),q$S.cloneTo=function(q$S){var q$_=q$S;q$_._type=this._type,this._constant.cloneTo(q$_._constant),this._constantMin.cloneTo(q$_._constantMin),this._constantMax.cloneTo(q$_._constantMax),this._gradient.cloneTo(q$_._gradient),this._gradientMin.cloneTo(q$_._gradientMin),this._gradientMax.cloneTo(q$_._gradientMax)},q$S.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$S,"gradient",function(){return this._gradient}),q$t(0,q$S,"constant",function(){return this._constant}),q$t(0,q$S,"type",function(){return this._type}),q$t(0,q$S,"gradientMin",function(){return this._gradientMin}),q$t(0,q$S,"constantMin",function(){return this._constantMin}),q$t(0,q$S,"gradientMax",function(){return this._gradientMax}),q$t(0,q$S,"constantMax",function(){return this._constantMax}),q$R.createByConstant=function(q$S){var q$_=new q$R;return q$_._type=0,q$_._constant=q$S,q$_},q$R.createByGradient=function(q$S){var q$_=new q$R;return q$_._type=1,q$_._gradient=q$S,q$_},q$R.createByRandomTwoConstant=function(q$S,q$_){var q$a=new q$R;return q$a._type=2,q$a._constantMin=q$S,q$a._constantMax=q$_,q$a},q$R.createByRandomTwoGradient=function(q$S,q$_){var q$a=new q$R;return q$a._type=3,q$a._gradientMin=q$S,q$a._gradientMax=q$_,q$a},q$R}(),q$r=(function(){function q$S(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}q$G(q$S,"laya.d3.core.particleShuriKen.module.GradientDataColor");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_.addAlpha=function(q$S,q$_){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==q$S&&(q$S=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=q$S,this._alphaElements[this._alphaCurrentLength++]=q$_):DEBUG},q$_.addRGB=function(q$S,q$_){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==q$S&&(q$S=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=q$S,this._rgbElements[this._rgbCurrentLength++]=q$_.x,this._rgbElements[this._rgbCurrentLength++]=q$_.y,this._rgbElements[this._rgbCurrentLength++]=q$_.z):DEBUG},q$_.cloneTo=function(q$S){var q$_=q$S,q$a=0,q$R=0;q$_._alphaCurrentLength=this._alphaCurrentLength;var q$J=q$_._alphaElements;for(q$J.length=this._alphaElements.length,q$a=0,q$R=this._alphaElements.length;q$a<q$R;q$a++)q$J[q$a]=this._alphaElements[q$a];q$_._rgbCurrentLength=this._rgbCurrentLength;var q$V=q$_._rgbElements;for(q$V.length=this._rgbElements.length,q$a=0,q$R=this._rgbElements.length;q$a<q$R;q$a++)q$V[q$a]=this._rgbElements[q$a]},q$_.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$_,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),q$t(0,q$_,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function q$S(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}q$G(q$S,"laya.d3.core.particleShuriKen.module.GradientDataInt");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_.add=function(q$S,q$_){this._currentLength<8?(6===this._currentLength&&1!==q$S&&(q$S=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=q$S,this._elements[this._currentLength++]=q$_):console.log("Warning:data count must lessEqual than 4")},q$_.cloneTo=function(q$S){var q$_=q$S;q$_._currentLength=this._currentLength;var q$a=q$_._elements;q$a.length=this._elements.length;for(var q$R=0,q$J=this._elements.length;q$R<q$J;q$R++)q$a[q$R]=this._elements[q$R]},q$_.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$_,"gradientCount",function(){return this._currentLength/2})}(),function(){function q$S(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}q$G(q$S,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_.add=function(q$S,q$_){this._currentLength<8?(6===this._currentLength&&1!==q$S&&(q$S=1,DEBUG),this._elements[this._currentLength++]=q$S,this._elements[this._currentLength++]=q$_):DEBUG},q$_.getKeyByIndex=function(q$S){return this._elements[2*q$S]},q$_.getValueByIndex=function(q$S){return this._elements[2*q$S+1]},q$_.getAverageValue=function(){for(var q$S=0,q$_=this._currentLength-2;q$S<q$_;q$S+=2){this._elements[q$S+1];this._elements[q$S+3],this._elements[q$S+2]-this._elements[q$S]}return 0},q$_.cloneTo=function(q$S){var q$_=q$S;q$_._currentLength=this._currentLength;var q$a=q$_._elements;q$a.length=this._elements.length;for(var q$R=0,q$J=this._elements.length;q$R<q$J;q$R++)q$a[q$R]=this._elements[q$R]},q$_.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$_,"gradientCount",function(){return this._currentLength/2})}(),function(){function q$S(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}q$G(q$S,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_.add=function(q$S,q$_){this._currentLength<8?(6===this._currentLength&&1!==q$S&&(q$S=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=q$S,this._elements[this._currentLength++]=q$_.x,this._elements[this._currentLength++]=q$_.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},q$_.cloneTo=function(q$S){var q$_=q$S;q$_._currentLength=this._currentLength;var q$a=q$_._elements;q$a.length=this._elements.length;for(var q$R=0,q$J=this._elements.length;q$R<q$J;q$R++)q$a[q$R]=this._elements[q$R]},q$_.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$_,"gradientCount",function(){return this._currentLength/3})}(),function(){function q$k(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}q$G(q$k,"laya.d3.core.particleShuriKen.module.GradientSize");var q$S=q$k.prototype;return q$Q.imps(q$S,{"laya.d3.core.IClone":!0}),q$S.getMaxSizeInGradient=function(){var q$S=0,q$_=0,q$a=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(q$S=0,q$_=this._gradientX.gradientCount;q$S<q$_;q$S++)q$a=Math.max(q$a,this._gradientX.getValueByIndex(q$S));for(q$S=0,q$_=this._gradientY.gradientCount;q$S<q$_;q$S++)q$a=Math.max(q$a,this._gradientY.getValueByIndex(q$S))}else for(q$S=0,q$_=this._gradient.gradientCount;q$S<q$_;q$S++)q$a=Math.max(q$a,this._gradient.getValueByIndex(q$S));break;case 1:q$a=this._separateAxes?(q$a=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),q$a=Math.max(q$a,this._constantMinSeparate.y),Math.max(q$a,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(q$S=0,q$_=this._gradientXMin.gradientCount;q$S<q$_;q$S++)q$a=Math.max(q$a,this._gradientXMin.getValueByIndex(q$S));for(q$S=0,q$_=this._gradientXMax.gradientCount;q$S<q$_;q$S++)q$a=Math.max(q$a,this._gradientXMax.getValueByIndex(q$S));for(q$S=0,q$_=this._gradientYMin.gradientCount;q$S<q$_;q$S++)q$a=Math.max(q$a,this._gradientYMin.getValueByIndex(q$S));for(q$S=0,q$_=this._gradientZMax.gradientCount;q$S<q$_;q$S++)q$a=Math.max(q$a,this._gradientZMax.getValueByIndex(q$S))}else{for(q$S=0,q$_=this._gradientMin.gradientCount;q$S<q$_;q$S++)q$a=Math.max(q$a,this._gradientMin.getValueByIndex(q$S));for(q$S=0,q$_=this._gradientMax.gradientCount;q$S<q$_;q$S++)q$a=Math.max(q$a,this._gradientMax.getValueByIndex(q$S))}}return q$a},q$S.cloneTo=function(q$S){var q$_=q$S;q$_._type=this._type,q$_._separateAxes=this._separateAxes,this._gradient.cloneTo(q$_._gradient),this._gradientX.cloneTo(q$_._gradientX),this._gradientY.cloneTo(q$_._gradientY),this._gradientZ.cloneTo(q$_._gradientZ),q$_._constantMin=this._constantMin,q$_._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(q$_._constantMinSeparate),this._constantMaxSeparate.cloneTo(q$_._constantMaxSeparate),this._gradientMin.cloneTo(q$_._gradientMin),this._gradientMax.cloneTo(q$_._gradientMax),this._gradientXMin.cloneTo(q$_._gradientXMin),this._gradientXMax.cloneTo(q$_._gradientXMax),this._gradientYMin.cloneTo(q$_._gradientYMin),this._gradientYMax.cloneTo(q$_._gradientYMax),this._gradientZMin.cloneTo(q$_._gradientZMin),this._gradientZMax.cloneTo(q$_._gradientZMax)},q$S.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$S,"gradientZ",function(){return this._gradientZ}),q$t(0,q$S,"gradient",function(){return this._gradient}),q$t(0,q$S,"separateAxes",function(){return this._separateAxes}),q$t(0,q$S,"type",function(){return this._type}),q$t(0,q$S,"gradientMin",function(){return this._gradientMin}),q$t(0,q$S,"constantMin",function(){return this._constantMin}),q$t(0,q$S,"gradientX",function(){return this._gradientX}),q$t(0,q$S,"gradientY",function(){return this._gradientY}),q$t(0,q$S,"gradientMax",function(){return this._gradientMax}),q$t(0,q$S,"constantMax",function(){return this._constantMax}),q$t(0,q$S,"constantMinSeparate",function(){return this._constantMinSeparate}),q$t(0,q$S,"constantMaxSeparate",function(){return this._constantMaxSeparate}),q$t(0,q$S,"gradientXMin",function(){return this._gradientXMin}),q$t(0,q$S,"gradientXMax",function(){return this._gradientXMax}),q$t(0,q$S,"gradientYMin",function(){return this._gradientYMin}),q$t(0,q$S,"gradientYMax",function(){return this._gradientYMax}),q$t(0,q$S,"gradientZMin",function(){return this._gradientZMin}),q$t(0,q$S,"gradientZMax",function(){return this._gradientZMax}),q$k.createByGradient=function(q$S){var q$_=new q$k;return q$_._type=0,q$_._separateAxes=!1,q$_._gradient=q$S,q$_},q$k.createByGradientSeparate=function(q$S,q$_,q$a){var q$R=new q$k;return q$R._type=0,q$R._separateAxes=!0,q$R._gradientX=q$S,q$R._gradientY=q$_,q$R._gradientZ=q$a,q$R},q$k.createByRandomTwoConstant=function(q$S,q$_){var q$a=new q$k;return q$a._type=1,q$a._separateAxes=!1,q$a._constantMin=q$S,q$a._constantMax=q$_,q$a},q$k.createByRandomTwoConstantSeparate=function(q$S,q$_){var q$a=new q$k;return q$a._type=1,q$a._separateAxes=!0,q$a._constantMinSeparate=q$S,q$a._constantMaxSeparate=q$_,q$a},q$k.createByRandomTwoGradient=function(q$S,q$_){var q$a=new q$k;return q$a._type=2,q$a._separateAxes=!1,q$a._gradientMin=q$S,q$a._gradientMax=q$_,q$a},q$k.createByRandomTwoGradientSeparate=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=new q$k;return q$W._type=2,q$W._separateAxes=!0,q$W._gradientXMin=q$S,q$W._gradientXMax=q$_,q$W._gradientYMin=q$a,q$W._gradientYMax=q$R,q$W._gradientZMin=q$J,q$W._gradientZMax=q$V,q$W},q$k}()),q$e=function(){function q$k(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}q$G(q$k,"laya.d3.core.particleShuriKen.module.GradientVelocity");var q$S=q$k.prototype;return q$Q.imps(q$S,{"laya.d3.core.IClone":!0}),q$S.cloneTo=function(q$S){var q$_=q$S;q$_._type=this._type,this._constant.cloneTo(q$_._constant),this._gradientX.cloneTo(q$_._gradientX),this._gradientY.cloneTo(q$_._gradientY),this._gradientZ.cloneTo(q$_._gradientZ),this._constantMin.cloneTo(q$_._constantMin),this._constantMax.cloneTo(q$_._constantMax),this._gradientXMin.cloneTo(q$_._gradientXMin),this._gradientXMax.cloneTo(q$_._gradientXMax),this._gradientYMin.cloneTo(q$_._gradientYMin),this._gradientYMax.cloneTo(q$_._gradientYMax),this._gradientZMin.cloneTo(q$_._gradientZMin),this._gradientZMax.cloneTo(q$_._gradientZMax)},q$S.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$S,"gradientZ",function(){return this._gradientZ}),q$t(0,q$S,"constant",function(){return this._constant}),q$t(0,q$S,"type",function(){return this._type}),q$t(0,q$S,"gradientXMax",function(){return this._gradientXMax}),q$t(0,q$S,"constantMin",function(){return this._constantMin}),q$t(0,q$S,"gradientX",function(){return this._gradientX}),q$t(0,q$S,"gradientY",function(){return this._gradientY}),q$t(0,q$S,"gradientXMin",function(){return this._gradientXMin}),q$t(0,q$S,"constantMax",function(){return this._constantMax}),q$t(0,q$S,"gradientYMin",function(){return this._gradientYMin}),q$t(0,q$S,"gradientYMax",function(){return this._gradientYMax}),q$t(0,q$S,"gradientZMin",function(){return this._gradientZMin}),q$t(0,q$S,"gradientZMax",function(){return this._gradientZMax}),q$k.createByConstant=function(q$S){var q$_=new q$k;return q$_._type=0,q$_._constant=q$S,q$_},q$k.createByGradient=function(q$S,q$_,q$a){var q$R=new q$k;return q$R._type=1,q$R._gradientX=q$S,q$R._gradientY=q$_,q$R._gradientZ=q$a,q$R},q$k.createByRandomTwoConstant=function(q$S,q$_){var q$a=new q$k;return q$a._type=2,q$a._constantMin=q$S,q$a._constantMax=q$_,q$a},q$k.createByRandomTwoGradient=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=new q$k;return q$W._type=3,q$W._gradientXMin=q$S,q$W._gradientXMax=q$_,q$W._gradientYMin=q$a,q$W._gradientYMax=q$R,q$W._gradientZMin=q$J,q$W._gradientZMax=q$V,q$W},q$k}(),q$g=(function(){function q$S(q$S){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=q$S}q$G(q$S,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_.cloneTo=function(q$S){var q$_=q$S;this._angularVelocity.cloneTo(q$_._angularVelocity),q$_.enbale=this.enbale},q$_.clone=function(){var q$S;switch(this._angularVelocity.type){case 0:q$S=this._angularVelocity.separateAxes?q$P.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):q$P.createByConstant(this._angularVelocity.constant);break;case 1:q$S=this._angularVelocity.separateAxes?q$P.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):q$P.createByGradient(this._angularVelocity.gradient.clone());break;case 2:q$S=this._angularVelocity.separateAxes?q$P.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):q$P.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:q$S=this._angularVelocity.separateAxes?q$P.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):q$P.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var q$_=new this.constructor(q$S);return q$_.enbale=this.enbale,q$_},q$t(0,q$_,"angularVelocity",function(){return this._angularVelocity})}(),function(){function q$S(){this.enable=!1,this.randomDirection=!1}q$G(q$S,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_._getShapeBoundBox=function(q$S){throw new Error("BaseShape: must override it.")},q$_._getSpeedBoundBox=function(q$S){throw new Error("BaseShape: must override it.")},q$_.generatePositionAndDirection=function(q$S,q$_,q$a,q$R){throw new Error("BaseShape: must override it.")},q$_._calculateProceduralBounds=function(q$S,q$_,q$a){this._getShapeBoundBox(q$S);var q$R=q$S.min,q$J=q$S.max;q$W_.multiply(q$R,q$_,q$R),q$W_.multiply(q$J,q$_,q$J);var q$V=new q$ES(new q$W_,new q$W_);this.randomDirection?(q$V.min=new q$W_(-1,-1,-1),q$V.max=new q$W_(1,1,1)):this._getSpeedBoundBox(q$V);var q$W=new q$ES(new q$W_,new q$W_),q$k=q$W.min,q$z=q$W.max;q$W_.scale(q$V.min,q$a.y,q$k),q$W_.scale(q$V.max,q$a.y,q$z),q$W_.add(q$S.min,q$k,q$k),q$W_.add(q$S.max,q$z,q$z),q$W_.min(q$S.min,q$k,q$S.min),q$W_.max(q$S.max,q$k,q$S.max);var q$b=new q$ES(new q$W_,new q$W_),q$H=q$b.min,q$L=q$b.max;q$W_.scale(q$V.min,q$a.x,q$H),q$W_.scale(q$V.max,q$a.x,q$L),q$W_.min(q$b.min,q$L,q$k),q$W_.max(q$b.min,q$L,q$z),q$W_.min(q$S.min,q$k,q$S.min),q$W_.max(q$S.max,q$k,q$S.max)},q$_.cloneTo=function(q$S){q$S.enable=this.enable},q$_.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$S}()),q$Y=function(){function q$V(){}return q$G(q$V,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),q$V._randomPointUnitArcCircle=function(q$S,q$_,q$a){var q$R=q$_.elements,q$J=NaN;q$J=q$a?q$a.getFloat()*q$S:Math.random()*q$S,q$R[0]=Math.cos(q$J),q$R[1]=Math.sin(q$J)},q$V._randomPointInsideUnitArcCircle=function(q$S,q$_,q$a){var q$R=q$_.elements;q$V._randomPointUnitArcCircle(q$S,q$_,q$a);var q$J=NaN;q$J=q$a?Math.pow(q$a.getFloat(),.5):Math.pow(Math.random(),.5),q$R[0]=q$R[0]*q$J,q$R[1]=q$R[1]*q$J},q$V._randomPointUnitCircle=function(q$S,q$_){var q$a=q$S.elements,q$R=NaN;q$R=q$_?q$_.getFloat()*Math.PI*2:Math.random()*Math.PI*2,q$a[0]=Math.cos(q$R),q$a[1]=Math.sin(q$R)},q$V._randomPointInsideUnitCircle=function(q$S,q$_){var q$a=q$S.elements;q$V._randomPointUnitCircle(q$S);var q$R=NaN;q$R=q$_?Math.pow(q$_.getFloat(),.5):Math.pow(Math.random(),.5),q$a[0]=q$a[0]*q$R,q$a[1]=q$a[1]*q$R},q$V._randomPointUnitSphere=function(q$S,q$_){var q$a=q$S.elements,q$R=NaN,q$J=NaN;q$J=q$_?(q$R=q$a[2]=2*q$_.getFloat()-1,q$_.getFloat()*Math.PI*2):(q$R=q$a[2]=2*Math.random()-1,Math.random()*Math.PI*2);var q$V=Math.sqrt(1-q$R*q$R);q$a[0]=q$V*Math.cos(q$J),q$a[1]=q$V*Math.sin(q$J)},q$V._randomPointInsideUnitSphere=function(q$S,q$_){var q$a=q$S.elements;q$V._randomPointUnitSphere(q$S);var q$R=NaN;q$R=q$_?Math.pow(q$_.getFloat(),1/3):Math.pow(Math.random(),1/3),q$a[0]=q$a[0]*q$R,q$a[1]=q$a[1]*q$R,q$a[2]=q$a[2]*q$R},q$V._randomPointInsideHalfUnitBox=function(q$S,q$_){var q$a=q$S.elements;q$_?(q$a[0]=q$_.getFloat()-.5,q$a[1]=q$_.getFloat()-.5,q$a[2]=q$_.getFloat()-.5):(q$a[0]=Math.random()-.5,q$a[1]=Math.random()-.5,q$a[2]=Math.random()-.5)},q$V}(),q$i=(function(){function q$S(q$S){this._size=null,this.enbale=!1,this._size=q$S}q$G(q$S,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_.cloneTo=function(q$S){var q$_=q$S;this._size.cloneTo(q$_._size),q$_.enbale=this.enbale},q$_.clone=function(){var q$S;switch(this._size.type){case 0:q$S=this._size.separateAxes?q$r.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):q$r.createByGradient(this._size.gradient.clone());break;case 1:q$S=this._size.separateAxes?q$r.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):q$r.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:q$S=this._size.separateAxes?q$r.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):q$r.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var q$_=new this.constructor(q$S);return q$_.enbale=this.enbale,q$_},q$t(0,q$_,"size",function(){return this._size})}(),function(){function q$R(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}q$G(q$R,"laya.d3.core.particleShuriKen.module.StartFrame");var q$S=q$R.prototype;return q$Q.imps(q$S,{"laya.d3.core.IClone":!0}),q$S.cloneTo=function(q$S){var q$_=q$S;q$_._type=this._type,q$_._constant=this._constant,q$_._constantMin=this._constantMin,q$_._constantMax=this._constantMax},q$S.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$S,"constant",function(){return this._constant}),q$t(0,q$S,"type",function(){return this._type}),q$t(0,q$S,"constantMin",function(){return this._constantMin}),q$t(0,q$S,"constantMax",function(){return this._constantMax}),q$R.createByConstant=function(q$S){var q$_=new q$R;return q$_._type=0,q$_._constant=q$S,q$_},q$R.createByRandomTwoConstant=function(q$S,q$_){var q$a=new q$R;return q$a._type=1,q$a._constantMin=q$S,q$a._constantMax=q$_,q$a},q$R}()),q$Z=(function(){function q$S(q$S,q$_){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new q$V_(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=q$S,this._startFrame=q$_}q$G(q$S,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_.cloneTo=function(q$S){var q$_=q$S;this.tiles.cloneTo(q$_.tiles),q$_.type=this.type,q$_.randomRow=this.randomRow,this._frame.cloneTo(q$_._frame),this._startFrame.cloneTo(q$_._startFrame),q$_.cycles=this.cycles,q$_.enableUVChannels=this.enableUVChannels,q$_.enable=this.enable},q$_.clone=function(){var q$S,q$_;switch(this._frame.type){case 0:q$S=q$K.createByConstant(this._frame.constant);break;case 1:q$S=q$K.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:q$S=q$K.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:q$S=q$K.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:q$_=q$i.createByConstant(this._startFrame.constant);break;case 1:q$_=q$i.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var q$a=new this.constructor(q$S,q$_);return this.tiles.cloneTo(q$a.tiles),q$a.type=this.type,q$a.randomRow=this.randomRow,q$a.cycles=this.cycles,q$a.enableUVChannels=this.enableUVChannels,q$a.enable=this.enable,q$a},q$t(0,q$_,"frame",function(){return this._frame}),q$t(0,q$_,"startFrame",function(){return this._startFrame})}(),function(){function q$S(q$S){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=q$S}q$G(q$S,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_.cloneTo=function(q$S){var q$_=q$S;this._velocity.cloneTo(q$_._velocity),q$_.enbale=this.enbale,q$_.space=this.space},q$_.clone=function(){var q$S;switch(this._velocity.type){case 0:q$S=q$e.createByConstant(this._velocity.constant.clone());break;case 1:q$S=q$e.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:q$S=q$e.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:q$S=q$e.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var q$_=new this.constructor(q$S);return q$_.enbale=this.enbale,q$_.space=this.space,q$_},q$t(0,q$_,"velocity",function(){return this._velocity})}(),function(){function q$S(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new q$C_,this._vb=q$g_.create(q$S._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=q$e_.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=q$M_.nameKey.getID("LINE"),this._shaderCompile=q$N_._preCompileShader[this._sharderNameID]}q$G(q$S,"laya.d3.core.PhasorSpriter3D");var q$_=q$S.prototype;return q$_.line=function(q$S,q$_,q$a,q$R){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(q$S.x,q$S.y,q$S.z,q$_.x,q$_.y,q$_.z,q$_.w),this.addVertex(q$a.x,q$a.y,q$a.z,q$R.x,q$R.y,q$R.z,q$R.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},q$_.circle=function(q$S,q$_,q$a,q$R,q$J,q$V){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*q$_,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/q$_,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*q$S,Math.cos(this._tempNumver0)*q$S,0,q$a,q$R,q$J,q$V),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},q$_.plane=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=q$R/2,this._tempNumver1=q$J/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(q$S-this._tempNumver0,q$_+this._tempNumver1,q$a,q$V,q$W,q$k,q$z),this.addVertex(q$S+this._tempNumver0,q$_+this._tempNumver1,q$a,q$V,q$W,q$k,q$z),this.addVertex(q$S-this._tempNumver0,q$_-this._tempNumver1,q$a,q$V,q$W,q$k,q$z),this.addVertex(q$S+this._tempNumver0,q$_-this._tempNumver1,q$a,q$V,q$W,q$k,q$z),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},q$_.box=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=q$R/2,this._tempNumver1=q$J/2,this._tempNumver2=q$V/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(q$S-this._tempNumver0,q$_+this._tempNumver1,q$a+this._tempNumver2,q$W,q$k,q$z,q$b),this.addVertex(q$S+this._tempNumver0,q$_+this._tempNumver1,q$a+this._tempNumver2,q$W,q$k,q$z,q$b),this.addVertex(q$S-this._tempNumver0,q$_-this._tempNumver1,q$a+this._tempNumver2,q$W,q$k,q$z,q$b),this.addVertex(q$S+this._tempNumver0,q$_-this._tempNumver1,q$a+this._tempNumver2,q$W,q$k,q$z,q$b),this.addVertex(q$S+this._tempNumver0,q$_+this._tempNumver1,q$a-this._tempNumver2,q$W,q$k,q$z,q$b),this.addVertex(q$S-this._tempNumver0,q$_+this._tempNumver1,q$a-this._tempNumver2,q$W,q$k,q$z,q$b),this.addVertex(q$S+this._tempNumver0,q$_-this._tempNumver1,q$a-this._tempNumver2,q$W,q$k,q$z,q$b),this.addVertex(q$S-this._tempNumver0,q$_-this._tempNumver1,q$a-this._tempNumver2,q$W,q$k,q$z,q$b),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},q$_.cone=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*q$a+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*q$a>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/q$a,this.addVertexIndex(0,q$_,0,q$R,q$J,q$V,q$W,this._tempUint0),this.addVertexIndex(0,0,0,q$R,q$J,q$V,q$W,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<q$a;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(q$S*this._tempNumver2,0,q$S*this._tempNumver3,q$R,q$J,q$V,q$W,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==q$a-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(q$S*this._tempNumver2,0,q$S*this._tempNumver3,q$R,q$J,q$V,q$W,this._tempUint0+(this._tempInt0+q$a)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==q$a-1?this.addIndexes(this._tempUint1+q$a+2):this.addIndexes(this._tempUint1+this._tempInt0+q$a+1),this.addIndexes(this._tempUint1+this._tempInt0+q$a),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},q$_.boundingBoxLine=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(q$S,q$J,q$V,q$W,q$k,q$z,q$b),this.addVertex(q$R,q$J,q$V,q$W,q$k,q$z,q$b),this.addVertex(q$S,q$_,q$V,q$W,q$k,q$z,q$b),this.addVertex(q$R,q$_,q$V,q$W,q$k,q$z,q$b),this.addVertex(q$R,q$J,q$a,q$W,q$k,q$z,q$b),this.addVertex(q$S,q$J,q$a,q$W,q$k,q$z,q$b),this.addVertex(q$R,q$_,q$a,q$W,q$k,q$z,q$b),this.addVertex(q$S,q$_,q$a,q$W,q$k,q$z,q$b),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},q$_.addVertex=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=q$S,this._vbData[this._posInVBData+1]=q$_,this._vbData[this._posInVBData+2]=q$a,this._vbData[this._posInVBData+3]=q$R,this._vbData[this._posInVBData+4]=q$J,this._vbData[this._posInVBData+5]=q$V,this._vbData[this._posInVBData+6]=q$W,this._posInVBData+=this._floatSizePerVer,this},q$_.addVertexIndex=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){return this._hasBegun||this.addVertexIndexException(),this._vbData[q$k]=q$S,this._vbData[q$k+1]=q$_,this._vbData[q$k+2]=q$a,this._vbData[q$k+3]=q$R,this._vbData[q$k+4]=q$J,this._vbData[q$k+5]=q$V,this._vbData[q$k+6]=q$W,(q$k+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=q$k),this},q$_.addIndexes=function(q$S){var q$_=arguments;this._hasBegun||this.addVertexIndexException();for(var q$a=0;q$a<q$_.length;q$a++)this._ibData[this._posInIBData]=q$_[q$a],this._posInIBData++;return this},q$_.begin=function(q$S,q$_){return this._hasBegun&&this.beginException0(),1!==q$S&&4!==q$S&&this.beginException1(),this._primitiveType=q$S,this._camera=q$_,this._hasBegun=!0,this},q$_.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},q$_.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(q$S._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),q$N.drawCall++,q$A.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},q$_.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},q$_.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},q$_.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},q$_.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},q$_.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},q$_.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(28,[new q$WS(0,"vector3",0),new q$WS(12,"vector4",1)])}]),q$S}()),q$p=function(){function q$S(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++q$S._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new q$C_}q$G(q$S,"laya.d3.core.render.RenderElement");var q$_=q$S.prototype;return q$_.getDynamicBatchBakedVertexs=function(q$S){for(var q$_=this._renderObj._getVertexBuffer(q$S),q$a=q$_.getData().slice(),q$R=q$_.vertexDeclaration,q$J=q$R.getVertexElementByUsage(0).offset/4,q$V=q$R.getVertexElementByUsage(3).offset/4,q$W=this._sprite3D.transform,q$k=q$W.worldMatrix,q$z=q$W.rotation,q$b=q$R.vertexStride/4,q$H=0,q$L=q$a.length;q$H<q$L;q$H+=q$b){var q$C=q$H+q$J,q$G=q$H+q$V;q$$_.transformVector3ArrayToVector3ArrayCoordinate(q$a,q$C,q$k,q$a,q$C),q$$_.transformVector3ArrayByQuat(q$a,q$G,q$z,q$a,q$G)}return q$a},q$_.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},q$_._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},q$t(0,q$_,"id",function(){return this._id}),q$t(0,q$_,"renderObj",function(){return this._renderObj},function(q$S){this._renderObj!==q$S&&(this._renderObj=q$S)}),q$S._uniqueIDCounter=0,q$S}(),q$c=function(){function q$_(q$S){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++q$_._uniqueIDCounter,this._needSort=!1,this._scene=q$S,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}q$G(q$_,"laya.d3.core.render.RenderQueue");var q$S=q$_.prototype;return q$S._sortOpaqueFunc=function(q$S,q$_){if(q$S._render&&q$_._render){var q$a=q$S._material.renderQueue-q$_._material.renderQueue;return 0==q$a?q$S._render._distanceForSort-q$_._render._distanceForSort:q$a}return 0},q$S._sortAlphaFunc=function(q$S,q$_){if(q$S._render&&q$_._render){var q$a=q$S._material.renderQueue-q$_._material.renderQueue;return 0==q$a?q$_._render._distanceForSort-q$S._render._distanceForSort:q$a}return 0},q$S._begainRenderElement=function(q$S,q$_,q$a){return!!q$_._beforeRender(q$S)},q$S._sortAlpha=function(q$S){q$_._cameraPosition=q$S,this._finalElements.sort(this._sortAlphaFunc)},q$S._sortOpaque=function(q$S){q$_._cameraPosition=q$S,this._finalElements.sort(this._sortOpaqueFunc)},q$S._preRender=function(q$S){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},q$S._render=function(q$S,q$_){for(var q$a,q$R,q$J,q$V,q$W,q$k,q$z=q$N.loopCount,q$b=this._scene,q$H=q$S.camera,q$L=(q$H.id,!1),q$C=0,q$G=this._finalElements.length;q$C<q$G;q$C++){var q$t,q$o,q$$,q$F=this._finalElements[q$C];if(null!=q$F._onPreRenderFunction&&q$F._onPreRenderFunction.call(q$F._sprite3D,q$S),0===q$F._type){if(q$S.owner=q$$=q$F._sprite3D,q$S.renderElement=q$F,q$$._preRenderUpdateComponents(q$S),q$t=q$F.renderObj,q$o=q$F._material,this._begainRenderElement(q$S,q$t,q$o)){if(q$a=q$t._getVertexBuffers(),!(q$J=(q$R=q$t._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[q$R.id]){this._errorRecord[q$R.id]=1;var q$T="vertexBuffer:"+("("+q$R._destroyed+","+q$R._released+","+q$R._referenceCount+","+q$R._buffer+")")+", material:"+(q$o?q$o.__className+"("+q$o._destroyed+","+q$o._released+")":"null")+", owner:"+(q$$?q$$.__className+"("+q$$._destroyed+","+q$$._activeInHierarchy+","+q$$._displayedInStage+")":"null")+", renderObj:"+(q$t?q$t.__className+"("+q$t._destroyed+","+q$t._released+","+q$t._referenceCount+")":"")+", parent:, url:"+(q$$?q$$.url:"")+", disposeStack:"+q$R.disposeStack;q$Q.recordError("报错：unknown vertexDeclaration  "+q$T)}continue}if(q$L=(q$V=q$S._shader=q$o._getShader(q$b._shaderDefineValue,q$J.shaderDefineValue,q$$._shaderDefineValue)).bind()||q$z!==q$V._uploadLoopCount,q$a){if(q$V._uploadVertexBuffer!==q$a||q$L){for(var q$D=0;q$D<q$a.length;q$D++){var q$j=q$a[q$D];q$V.uploadAttributesX(q$j.vertexDeclaration.shaderValues.data,q$j)}q$V._uploadVertexBuffer=q$a}}else(q$V._uploadVertexBuffer!==q$R||q$L)&&(q$V.uploadAttributes(q$J.shaderValues.data,null),q$V._uploadVertexBuffer=q$R);(q$V._uploadScene!==q$b||q$L)&&(q$V.uploadSceneUniforms(q$b._shaderValues.data),q$V._uploadScene=q$b),(q$H!==q$V._uploadCamera||q$V._uploadSprite3D!==q$$||q$L)&&(q$V.uploadSpriteUniforms(q$$._shaderValues.data),q$V._uploadSprite3D=q$$),(q$H!==q$V._uploadCamera||q$L)&&(q$V.uploadCameraUniforms(q$H._shaderValues.data),q$V._uploadCamera=q$H),(q$V._uploadMaterial!==q$o||q$L)&&(q$o._upload(),q$V._uploadMaterial=q$o),q$W!==q$o?(q$o._setRenderStateBlendDepth(),q$o._setRenderStateFrontFace(q$_,q$$.transform),q$W=q$o,q$k=q$$):q$k!==q$$&&(q$o._setRenderStateFrontFace(q$_,q$$.transform),q$k=q$$),q$t._render(q$S),q$V._uploadLoopCount=q$z}q$$._postRenderUpdateComponents(q$S)}else if(2===q$F._type){q$F.renderObj;q$S.owner=q$$=q$F._sprite3D,q$S.renderElement=q$F,q$S._batchIndexStart=q$F._tempBatchIndexStart,q$S._batchIndexEnd=q$F._tempBatchIndexEnd,q$t=q$F.renderObj,q$o=q$F._material,this._begainRenderElement(q$S,q$t,q$o)&&(q$J=(q$R=q$t._getVertexBuffer(0)).vertexDeclaration,q$L=(q$V=q$S._shader=q$o._getShader(q$b._shaderDefineValue,q$J.shaderDefineValue,q$$._shaderDefineValue)).bind()||q$z!==q$V._uploadLoopCount,(q$V._uploadVertexBuffer!==q$R||q$L)&&(q$V.uploadAttributes(q$J.shaderValues.data,null),q$V._uploadVertexBuffer=q$R),(q$V._uploadScene!==q$b||q$L)&&(q$V.uploadSceneUniforms(q$b._shaderValues.data),q$V._uploadScene=q$b),(q$H!==q$V._uploadCamera||q$V._uploadSprite3D!==q$$||q$L)&&(q$V.uploadSpriteUniforms(q$$._shaderValues.data),q$V._uploadSprite3D=q$$),(q$H!==q$V._uploadCamera||q$L)&&(q$V.uploadCameraUniforms(q$H._shaderValues.data),q$V._uploadCamera=q$H),(q$V._uploadMaterial!==q$o||q$L)&&(q$o._upload(),q$V._uploadMaterial=q$o),q$W!==q$o?(q$o._setRenderStateBlendDepth(),q$o._setRenderStateFrontFace(q$_,q$$.transform),q$W=q$o,q$k=q$$):q$k!==q$$&&(q$o._setRenderStateFrontFace(q$_,q$$.transform),q$k=q$$),q$t._render(q$S),q$V._uploadLoopCount=q$z)}}},q$S._renderShadow=function(q$S,q$_){for(var q$a,q$R,q$J,q$V,q$W,q$k=q$N.loopCount,q$z=this._scene,q$b=q$S.camera,q$H=!1,q$L=0,q$C=this._finalElements.length;q$L<q$C;q$L++){var q$G,q$t,q$o,q$$=this._finalElements[q$L];0===q$$._type&&(q$S.owner=q$o=q$$._sprite3D,q$_||q$o._projectionViewWorldUpdateCamera===q$b&&q$o._projectionViewWorldUpdateLoopCount===q$N.loopCount||(q$o._render._renderUpdate(q$S._projectionViewMatrix),q$o._projectionViewWorldUpdateLoopCount=q$N.loopCount,q$o._projectionViewWorldUpdateCamera=q$b),q$S.renderElement=q$$,q$o._preRenderUpdateComponents(q$S),q$G=q$$.renderObj,q$t=q$$._material,this._begainRenderElement(q$S,q$G,null)&&(q$R=(q$a=q$G._getVertexBuffer(0)).vertexDeclaration,q$H=(q$J=q$S._shader=q$t._getShader(q$z._shaderDefineValue,q$R.shaderDefineValue,q$o._shaderDefineValue)).bind()||q$k!==q$J._uploadLoopCount,(q$J._uploadVertexBuffer!==q$a||q$H)&&(q$J.uploadAttributes(q$R.shaderValues.data,null),q$J._uploadVertexBuffer=q$a),(q$b!==q$J._uploadCamera||q$J._uploadSprite3D!==q$o||q$H)&&(q$J.uploadSpriteUniforms(q$o._shaderValues.data),q$J._uploadSprite3D=q$o),(q$b!==q$J._uploadCamera||q$H)&&(q$J.uploadCameraUniforms(q$b._shaderValues.data),q$J._uploadCamera=q$b),(q$J._uploadMaterial!==q$t||q$H)&&(q$t._upload(),q$J._uploadMaterial=q$t),q$J._uploadRenderElement,q$V!==q$t?(q$t._setRenderStateFrontFace(!1,q$o.transform),q$V=q$t,q$W=q$o):q$W!==q$o&&(q$t._setRenderStateFrontFace(!1,q$o.transform),q$W=q$o),q$G._render(q$S),q$J._uploadLoopCount=q$k),q$o._postRenderUpdateComponents(q$S))}},q$S._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},q$S._addRenderElement=function(q$S){this._renderElements.push(q$S),this._needSort=!0},q$S._addDynamicBatchElement=function(q$S){this._dynamicBatchCombineRenderElements.push(q$S)},q$t(0,q$S,"id",function(){return this._id}),q$_._uniqueIDCounter=0,q$_._cameraPosition=null,q$_}(),q$y=function(){function q$S(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return q$G(q$S,"laya.d3.core.render.RenderState"),q$S.clientWidth=0,q$S.clientHeight=0,q$S}(),q$E=function(){function q$W(q$S,q$_){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new q$wS(new q$W_,0),this._corners=[new q$W_,new q$W_,new q$W_,new q$W_,new q$W_,new q$W_,new q$W_,new q$W_],this._boundingBoxCenter=new q$W_,this._children=q$R(8),this._objects=[],this._tempBoundBoxCorners=[new q$W_,new q$W_,new q$W_,new q$W_,new q$W_,new q$W_,new q$W_,new q$W_],this._scene=q$S,this._currentDepth=q$_}q$G(q$W,"laya.d3.core.scene.OctreeNode");var q$S=q$W.prototype;return q$Q.imps(q$S,{"laya.d3.core.scene.ITreeNode":!0}),q$S.init=function(q$S,q$_){var q$a=new q$W_,q$R=new q$W_;q$W_.scale(q$_,-.5,q$a),q$W_.scale(q$_,.5,q$R),q$W_.add(q$a,q$S,q$a),q$W_.add(q$R,q$S,q$R),this.exactBox=new q$ES(q$a,q$R),this.relaxBox=new q$ES(q$a,q$R)},q$S.addTreeNode=function(q$S){1===Collision.boxContainsBox(this._relaxBox,q$S.boundingBox)?this.addNodeDown(q$S,0):this.addObject(q$S)},q$S.addChild=function(q$S){var q$_=this._children[q$S];if(null==q$_){q$_=new q$W(this._scene,this._currentDepth+1),(this._children[q$S]=q$_)._parent=this,q$W_.subtract(this._exactBox.max,this._exactBox.min,q$W.tempSize),q$W_.multiply(q$W.tempSize,q$W._octreeSplit[q$S],q$W.tempCenter),q$W_.add(this._exactBox.min,q$W.tempCenter,q$W.tempCenter),q$W_.scale(q$W.tempSize,.25,q$W.tempSize);var q$a=new q$W_,q$R=new q$W_;q$W_.subtract(q$W.tempCenter,q$W.tempSize,q$a),q$W_.add(q$W.tempCenter,q$W.tempSize,q$R),q$_.exactBox=new q$ES(q$a,q$R),q$W_.scale(q$W.tempSize,q$W.relax,q$W.tempSize);var q$J=new q$W_,q$V=new q$W_;q$W_.subtract(q$W.tempCenter,q$W.tempSize,q$J),q$W_.add(q$W.tempCenter,q$W.tempSize,q$V),q$_.relaxBox=new q$ES(q$J,q$V)}return q$_},q$S.addObject=function(q$S){(q$S._treeNode=this)._objects.push(q$S)},q$S.removeObject=function(q$S){if(q$S._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var q$_=this._objects.indexOf(q$S);return-1!==q$_&&(this._objects.splice(q$_,1),!0)},q$S.clearObject=function(){this._objects.length=0},q$S.addNodeUp=function(q$S,q$_){this._parent&&1!==Collision.boxContainsBox(this._exactBox,q$S.boundingBox)?this._parent.addNodeUp(q$S,q$_-1):this.addNodeDown(q$S,q$_)},q$S.addNodeDown=function(q$S,q$_){if(q$_<this._scene.treeLevel){var q$a=this.inChildIndex(q$S.boundingBoxCenter),q$R=this.addChild(q$a);1===Collision.boxContainsBox(q$R._relaxBox,q$S.boundingBox)?q$R.addNodeDown(q$S,++q$_):this.addObject(q$S)}else this.addObject(q$S)},q$S.inChildIndex=function(q$S){return 4*(q$S.z<this._boundingBoxCenter.z?0:1)+2*(q$S.y<this._boundingBoxCenter.y?0:1)+(q$S.x<this._boundingBoxCenter.x?0:1)},q$S.updateObject=function(q$S){1===Collision.boxContainsBox(this._relaxBox,q$S.boundingBox)?(this.removeObject(q$S),q$S._treeNode=null,this.addNodeDown(q$S,this._currentDepth)):this._parent&&(this.removeObject(q$S),q$S._treeNode=null,this._parent.addNodeUp(q$S,this._currentDepth-1))},q$S.cullingObjects=function(q$S,q$_,q$a,q$R,q$J){var q$V,q$W=0,q$k=0,q$z=0,q$b=this._scene._dynamicBatchManager;for(q$W=0,q$V=this._objects.length;q$W<q$V;q$W++){var q$H=this._objects[q$W];if(q$u.isVisible(q$H._owner.layer.mask)&&q$H.enable){if(q$_&&(q$N.treeSpriteCollision+=1,0===q$S.containsBoundSphere(q$H.boundingSphere)))continue;q$H._renderUpdate(q$J),q$H._distanceForSort=q$W_.distance(q$H.boundingSphere.center,q$R)+q$H.sortingFudge;var q$L=q$H._renderElements;for(q$k=0,q$z=q$L.length;q$k<q$z;q$k++){var q$C=q$L[q$k],q$G=q$C._staticBatch;if(q$G&&q$G._material===q$C._material)q$G._addBatchRenderElement(q$C);else{var q$t=q$C.renderObj;q$t.triangleCount<10&&1===q$t._vertexBufferCount&&q$t._getIndexBuffer()&&q$C._material.renderQueue<2&&q$C._canDynamicBatch&&!q$H._owner.isStatic?q$b._addPrepareRenderElement(q$C):this._scene.getRenderQueue(q$C._material.renderQueue)._addRenderElement(q$C)}}}}for(q$W=0;q$W<8;q$W++){var q$o=this._children[q$W];if(null!=q$o){var q$$=q$_;if(q$_){var q$F=q$S.containsBoundBox(q$o._relaxBox);if(q$N.treeNodeCollision+=1,0===q$F)continue;q$$=2===q$F}q$o.cullingObjects(q$S,q$$,q$a,q$R,q$J)}}},q$S.cullingShadowObjects=function(q$S,q$_,q$a,q$R,q$J){var q$V,q$W=0,q$k=0,q$z=0;this._scene._dynamicBatchManager;for(q$W=0,q$V=this._objects.length;q$W<q$V;q$W++){var q$b=this._objects[q$W];if(q$b.castShadow&&q$u.isVisible(q$b._owner.layer.mask)&&q$b.enable){if(q$a&&0===q$S[0].containsBoundSphere(q$b.boundingSphere))continue;for(var q$H=1,q$L=q$S.length;q$H<q$L;q$H++){var q$C=q$_[q$H-1];if(0!==q$S[q$H].containsBoundSphere(q$b.boundingSphere)){var q$G=q$b._renderElements;for(q$k=0,q$z=q$G.length;q$k<q$z;q$k++)q$C._addRenderElement(q$G[q$k])}}}}for(q$W=0;q$W<8;q$W++){var q$t=this._children[q$W];if(null!=q$t){var q$o=q$a;if(q$a){var q$$=q$S[0].containsBoundBox(q$t._relaxBox);if(0===q$$)continue;q$o=2===q$$}q$t.cullingShadowObjects(q$S,q$_,q$o,q$R,q$J)}}},q$S.cullingShadowObjectsOnePSSM=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W,q$k=q$_[0],q$z=0,q$b=0,q$H=0;for(q$z=0,q$W=this._objects.length;q$z<q$W;q$z++){var q$L=this._objects[q$z];if(q$L.castShadow&&q$u.isVisible(q$L._owner.layer.mask)&&q$L.enable){if(q$R&&0===q$S.containsBoundSphere(q$L.boundingSphere))continue;q$L._renderUpdate(q$a);var q$C=q$L._renderElements;for(q$b=0,q$H=q$C.length;q$b<q$H;q$b++)q$k._addRenderElement(q$C[q$b])}}for(q$z=0;q$z<8;q$z++){var q$G=this._children[q$z];if(null!=q$G){var q$t=q$R;if(q$R){var q$o=q$S.containsBoundBox(q$G._relaxBox);if(0===q$o)continue;q$t=2===q$o}q$G.cullingShadowObjectsOnePSSM(q$S,q$_,q$a,q$t,q$J,q$V)}}},q$S.renderBoudingBox=function(q$S){this._renderBoudingBox(q$S);for(var q$_=0;q$_<8;++q$_){var q$a=this._children[q$_];q$a&&q$a.renderBoudingBox(q$S)}},q$S.buildAllChild=function(q$S){if(q$S<this._scene.treeLevel)for(var q$_=0;q$_<8;q$_++){this.addChild(q$_).buildAllChild(q$S+1)}},q$S._renderBoudingBox=function(q$S){},q$t(0,q$S,"exactBox",function(){return this._exactBox},function(q$S){this._exactBox=q$S,q$W_.add(q$S.min,q$S.max,this._boundingBoxCenter),q$W_.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),q$t(0,q$S,"relaxBox",function(){return this._relaxBox},function(q$S){(this._relaxBox=q$S).getCorners(this._corners),q$wS.createfromPoints(this._corners,this._boundingSphere)}),q$W.debugMode=!1,q$W.relax=1.15,q$W.CHILDNUM=8,q$L(q$W,["tempVector0",function(){return this.tempVector0=new q$W_},"tempSize",function(){return this.tempSize=new q$W_},"tempCenter",function(){return this.tempCenter=new q$W_},"_octreeSplit",function(){return this._octreeSplit=[new q$W_(.25,.25,.25),new q$W_(.75,.25,.25),new q$W_(.25,.75,.25),new q$W_(.75,.75,.25),new q$W_(.25,.25,.75),new q$W_(.75,.25,.75),new q$W_(.25,.75,.75),new q$W_(.75,.75,.75)]}]),q$W}(),q$O=(function(){function q$S(){}q$G(q$S,"laya.d3.core.scene.SceneManager")}(),function(){function q$S(q$S,q$_,q$a,q$R){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===q$S&&(q$S=1),void 0===q$_&&(q$_=1),void 0===q$a&&(q$a=1),void 0===q$R&&(q$R=1),this._r=q$S,this._g=q$_,this._b=q$a,this._a=q$R}return q$G(q$S,"laya.d3.core.trail.module.Color",null,"Color$1"),q$S.prototype.cloneTo=function(q$S){q$S._r=this._r,q$S._g=this._g,q$S._b=this._b,q$S._a=this._a},q$L(q$S,["RED",function(){return this.RED=new q$S(1,0,0,1)},"GREEN",function(){return this.GREEN=new q$S(0,1,0,1)},"BLUE",function(){return this.BLUE=new q$S(0,0,1,1)},"CYAN",function(){return this.CYAN=new q$S(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new q$S(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new q$S(1,0,1,1)},"GRAY",function(){return this.GRAY=new q$S(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new q$S(1,1,1,1)},"BLACK",function(){return this.BLACK=new q$S(0,0,0,1)}]),q$S}()),q$w=(function(){function q$S(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}q$G(q$S,"laya.d3.core.trail.module.Gradient");var q$_=q$S.prototype;q$_.setKeys=function(q$S,q$_){var q$a,q$R;this._colorKeys=q$S;for(var q$J=this.index=0;q$J<q$S.length;q$J++){var q$V=(q$a=q$S[q$J]).color;this._colorKeyData[this.index++]=q$V._r,this._colorKeyData[this.index++]=q$V._g,this._colorKeyData[this.index++]=q$V._b,this._colorKeyData[this.index++]=q$a.time}this._alphaKeys=q$_;for(var q$W=this.index=0;q$W<q$_.length;q$W++)q$R=q$_[q$W],this._alphaKeyData[this.index++]=q$R.alpha,this._alphaKeyData[this.index++]=q$R.time},q$_.cloneTo=function(q$S){var q$_=0,q$a=0,q$R=this.colorKeys,q$J=[];for(q$_=0,q$a=q$R.length;q$_<q$a;q$_++){var q$V=new q$v;q$R[q$_].cloneTo(q$V),q$J.push(q$V)}var q$W=this.alphaKeys,q$k=[];for(q$_=0,q$a=q$W.length;q$_<q$a;q$_++){var q$z=new q$w;q$W[q$_].cloneTo(q$z),q$k.push(q$z)}q$S.setKeys(q$J,q$k)},q$t(0,q$_,"mode",function(){return this._mode},function(q$S){this._mode=q$S}),q$t(0,q$_,"colorKeys",function(){return this._colorKeys},function(q$S){this._colorKeys=q$S;for(var q$_=this.index=0;q$_<q$S.length;q$_++){var q$a=q$S[q$_],q$R=q$a.color;this._colorKeyData[this.index++]=q$R._r,this._colorKeyData[this.index++]=q$R._g,this._colorKeyData[this.index++]=q$R._b,this._colorKeyData[this.index++]=q$a.time}}),q$t(0,q$_,"alphaKeys",function(){return this._alphaKeys},function(q$S){this._alphaKeys=q$S;for(var q$_=this.index=0;q$_<q$S.length;q$_++){var q$a=q$S[q$_];this._alphaKeyData[this.index++]=q$a.alpha,this._alphaKeyData[this.index++]=q$a.time}})}(),function(){function q$S(q$S,q$_){this._alpha=NaN,this._time=NaN,void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),this._alpha=q$S,this._time=q$_}q$G(q$S,"laya.d3.core.trail.module.GradientAlphaKey");var q$_=q$S.prototype;return q$_.cloneTo=function(q$S){q$S.alpha=this.alpha,q$S.time=this.time},q$t(0,q$_,"alpha",function(){return this._alpha},function(q$S){this._alpha=q$S}),q$t(0,q$_,"time",function(){return this._time},function(q$S){this._time=q$S}),q$S}()),q$v=function(){function q$S(q$S,q$_){this._color=null,this._time=NaN,void 0===q$_&&(q$_=0),this._color=q$S||new q$O,this._time=q$_}q$G(q$S,"laya.d3.core.trail.module.GradientColorKey");var q$_=q$S.prototype;return q$_.cloneTo=function(q$S){this.color.cloneTo(q$S.color),q$S.time=this.time},q$t(0,q$_,"color",function(){return this._color},function(q$S){this._color=q$S}),q$t(0,q$_,"time",function(){return this._time},function(q$S){this._time=q$S}),q$S}(),q$d=(function(){function q$S(){}q$G(q$S,"laya.d3.core.trail.module.GradientMode"),q$S.Blend=0,q$S.Fixed=1}(),function(){function q$S(){}q$G(q$S,"laya.d3.core.trail.module.TextureMode"),q$S.Stretch=0,q$S.Tile=1}(),function(){function q$S(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}q$G(q$S,"laya.d3.core.trail.module.TrailKeyFrame"),q$S.prototype.cloneTo=function(q$S){q$S.time=this.time,q$S.inTangent=this.inTangent,q$S.outTangent=this.outTangent,q$S.value=this.value}}(),function(){function q$_(q$S){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new q$W_,this._curPosition=new q$W_,this._delVector3=new q$W_,this._lastFixedVertexPosition=new q$W_,this._pointAtoBVector3=new q$W_,this._pointA=new q$W_,this._pointB=new q$W_,this._owner=q$S,this._id=q$_.renderElementCount++,0==this._id?q$S._owner.transform.position.cloneTo(this._lastPosition):q$S._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new q$g_(q$d.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new q$g_(q$d.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}q$G(q$_,"laya.d3.core.trail.TrailRenderElement");var q$S=q$_.prototype;q$Q.imps(q$S,{"laya.d3.core.render.IRenderable":!0}),q$S._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},q$S._addTrailByFirstPosition=function(q$S,q$_){q$W_.subtract(q$_,q$S,this._delVector3),q$W_.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),q$W_.normalize(this._pointAtoBVector3,this._pointAtoBVector3),q$W_.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(q$S),q$S.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},q$S._addTrailByNextPosition=function(q$S){q$W_.subtract(q$S,this._lastFixedVertexPosition,this._delVector3),q$W_.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),q$W_.normalize(this._pointAtoBVector3,this._pointAtoBVector3),q$W_.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=q$W_.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=q$vS.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(q$S),q$S.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(q$S),this._virtualVerticesCount=2)},q$S._updateVerticesByPosition=function(q$S){this._pointe=q$S.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},q$S._updateVertexBuffer2=function(){var q$S,q$_=0,q$a=0,q$R=0;for(q$R=0,q$S=(this._verticesCount+this._virtualVerticesCount)/2;q$R<q$S;q$R++)q$a=0==this._owner.textureMode?(this._VerticesToTailLength[q$R]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[q$R],this._vertices2[q$_++]=1-q$a,this._vertices2[q$_++]=1-q$a;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},q$S._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},q$S._updateDisappear=function(){var q$S,q$_=0;for(q$_=this._curDisappearIndex,q$S=(this._verticesCount+this._virtualVerticesCount)/2;q$_<q$S;q$_++)this._owner._curtime-this._everyGroupVertexBirthTime[q$_]>=this._owner.time+q$vS.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},q$S._beforeRender=function(q$S){return this._camera=q$S.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),q$W_.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},q$S._render=function(q$S){this._isDead||(q$A.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),q$N.drawCall++,q$N.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},q$S._getVertexBuffer=function(q$S){return void 0===q$S&&(q$S=0),0===q$S?this._vertexBuffer1:1===q$S?this._vertexBuffer2:null},q$S._getVertexBuffers=function(){return this._vertexBuffers},q$S._getIndexBuffer=function(){return null},q$S.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},q$S._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},q$t(0,q$S,"_vertexBufferCount",function(){return this._vertexBuffers.length}),q$t(0,q$S,"triangleCount",function(){return 0}),q$_.renderElementCount=0}(),function(){function q$S(){}q$G(q$S,"laya.d3.core.trail.VertexTrail");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration1}),q$t(1,q$S,"vertexDeclaration1",function(){return q$S._vertexDeclaration1}),q$t(1,q$S,"vertexDeclaration2",function(){return q$S._vertexDeclaration2}),q$L(q$S,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new q$VS(32,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",41),new q$WS(24,"single",33),new q$WS(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new q$VS(4,[new q$WS(0,"single",38)])}]),q$S}()),q$SS=function(){function q$j(q$S){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=q$S}q$G(q$j,"laya.d3.graphics.DynamicBatch");var q$S=q$j.prototype;return q$Q.imps(q$S,{"laya.d3.core.render.IRenderable":!0}),q$S._getVertexBuffer=function(q$S){return void 0===q$S&&(q$S=0),0===q$S?this._vertexBuffer:null},q$S._getIndexBuffer=function(){return this._indexBuffer},q$S._getCombineRenderElementFromPool=function(q$S,q$_,q$a){var q$R=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return q$R||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=q$R=new q$p,q$R._sprite3D=new q$c_),q$R._sprite3D._render._renderUpdate(q$a),q$R},q$S._getRenderElement=function(q$S,q$_,q$a){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*q$j.maxVertexCount),this._indexDatas=new Uint16Array(q$j.maxIndexCount),this._vertexBuffer=q$g_.create(this._vertexDeclaration,q$j.maxVertexCount,35048),this._indexBuffer=q$e_.create("ushort",q$j.maxIndexCount,35048));for(var q$R=this._merageElements.length=0,q$J=0,q$V=0,q$W=this._combineRenderElements.length;q$V<q$W;q$V++){var q$k=this._combineRenderElements[q$V],q$z=q$k.getDynamicBatchBakedVertexs(0),q$b=q$k.getBakedIndices(),q$H=q$k._sprite3D.transform._isFrontFaceInvert,q$L=q$R/(this._vertexDeclaration.vertexStride/4),q$C=q$J,q$G=q$C+q$b.length;q$k._tempBatchIndexStart=q$C,q$k._tempBatchIndexEnd=q$G,this._indexDatas.set(q$b,q$J);var q$t=0;if(q$H)for(q$t=q$C;q$t<q$G;q$t+=3){this._indexDatas[q$t]=q$L+this._indexDatas[q$t];var q$o=this._indexDatas[q$t+1],q$$=this._indexDatas[q$t+2];this._indexDatas[q$t+1]=q$L+q$$,this._indexDatas[q$t+2]=q$L+q$o}else for(q$t=q$C;q$t<q$G;q$t+=3)this._indexDatas[q$t]=q$L+this._indexDatas[q$t],this._indexDatas[q$t+1]=q$L+this._indexDatas[q$t+1],this._indexDatas[q$t+2]=q$L+this._indexDatas[q$t+2];q$J+=q$b.length,this._vertexDatas.set(q$z,q$R),q$R+=q$z.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),q$V=this._combineRenderElementPoolIndex=0,q$W=this._materials.length;q$V<q$W;q$V++){var q$F=this._getCombineRenderElementFromPool(q$S,q$_,q$a);q$F._type=2,q$F._staticBatch=null;var q$T=(q$F.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[q$V]]._tempBatchIndexStart,q$D=q$V+1===this._materialToRenderElementsOffsets.length?q$J:this._combineRenderElements[this._materialToRenderElementsOffsets[q$V+1]]._tempBatchIndexStart;q$F._tempBatchIndexStart=q$T,q$F._tempBatchIndexEnd=q$D,q$F._material=this._materials[q$V],this._merageElements.push(q$F)}},q$S._addCombineRenderObjTest=function(q$S){var q$_=q$S.renderObj,q$a=this._currentCombineIndexCount+q$_._getIndexBuffer().indexCount,q$R=this._currentCombineVertexCount+q$_._getVertexBuffer().vertexCount;return!(q$j.maxVertexCount<q$R||q$j.maxIndexCount<q$a)},q$S._addCombineRenderObj=function(q$S){var q$_=q$S.renderObj;this._combineRenderElements.push(q$S),this._currentCombineIndexCount=this._currentCombineIndexCount+q$_._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+q$_._getVertexBuffer().vertexCount},q$S._addCombineMaterial=function(q$S){this._materials.push(q$S)},q$S._addMaterialToRenderElementOffset=function(q$S){this._materialToRenderElementsOffsets.push(q$S)},q$S._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},q$S._addToRenderQueue=function(q$S,q$_,q$a,q$R){this._getRenderElement(q$_,q$a,q$R);for(var q$J=0,q$V=this._materials.length;q$J<q$V;q$J++)q$S.getRenderQueue(this._materials[q$J].renderQueue)._addDynamicBatchElement(this._merageElements[q$J])},q$S._beforeRender=function(q$S){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},q$S._render=function(q$S){var q$_=q$S._batchIndexEnd-q$S._batchIndexStart;q$A.mainContext.drawElements(4,q$_,5123,2*q$S._batchIndexStart),q$N.drawCall++,q$N.trianglesFaces+=q$_/3},q$S._getVertexBuffers=function(){return null},q$t(0,q$S,"_vertexBufferCount",function(){return 1}),q$t(0,q$S,"triangleCount",function(){return this._indexBuffer.indexCount/3}),q$t(0,q$S,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),q$j.maxVertexCount=2e4,q$j.maxIndexCount=4e4,q$j.maxCombineTriangleCount=10,q$j}(),q$_S=function(){function q$j(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}q$G(q$j,"laya.d3.graphics.DynamicBatchManager");var q$S=q$j.prototype;return q$S.getDynamicBatch=function(q$S,q$_){var q$a,q$R=q$S.id.toString()+q$_;return this._dynamicBatches[q$R]?q$a=this._dynamicBatches[q$R]:this._dynamicBatches[q$R]=q$a=new q$SS(q$S),q$a},q$S._garbageCollection=function(){for(var q$S in this._dynamicBatches)0===this._dynamicBatches[q$S].combineRenderElementsCount&&delete this._dynamicBatches[q$S]},q$S._addPrepareRenderElement=function(q$S){this._prepareDynamicBatchCombineElements.push(q$S)},q$S._finishCombineDynamicBatch=function(q$S){var q$_,q$a,q$R;this._prepareDynamicBatchCombineElements.sort(q$j._sortPrepareDynamicBatch);for(var q$J,q$V,q$W,q$k,q$z,q$b=-1,q$H=!0,q$L=0,q$C=-1,q$G=0,q$t=this._prepareDynamicBatchCombineElements.length;q$G<q$t;q$G++){var q$o=(q$V=this._prepareDynamicBatchCombineElements[q$G]).renderObj._getVertexBuffer(0).vertexDeclaration,q$$=q$a!==q$o;q$$&&(q$L=0,q$a=q$o);var q$F=q$L!==q$b;if(q$F&&(q$b=q$L),(q$$||q$F)&&(q$W=this.getDynamicBatch(q$o,q$L),q$_=null),q$H)if(q$W._addCombineRenderObjTest(q$V)){if(q$_!==(q$J=q$V._material))q$k&&(q$S.getRenderQueue(q$z._material.renderQueue)._addRenderElement(q$z),q$z=q$k=null,q$C=-1),q$k=q$J,q$C=q$W.combineRenderElementsCount,q$z=q$V,q$_=q$J;else if(q$k){var q$T=q$z.renderObj,q$D=q$V.renderObj;q$T._getVertexBuffer().vertexCount+q$D._getVertexBuffer().vertexCount>q$SS.maxVertexCount||q$T._getIndexBuffer().indexCount+q$D._getIndexBuffer().indexCount>q$SS.maxIndexCount?(q$S.getRenderQueue(q$z._material.renderQueue)._addRenderElement(q$z),q$k=q$J,q$C=q$W.combineRenderElementsCount,q$z=q$V):(q$W._addCombineMaterial(q$k),q$W._addMaterialToRenderElementOffset(q$C),q$W._addCombineRenderObj(q$z),q$z=q$k=null,q$C=-1,q$W._addCombineRenderObj(q$V))}else q$W._addCombineRenderObj(q$V);q$H=!0}else q$k&&(q$S.getRenderQueue(q$z._material.renderQueue)._addRenderElement(q$z),q$z=q$k=null,q$C=-1),q$L++,q$H=!1;else q$R=this._prepareDynamicBatchCombineElements[q$G-1],q$W._addMaterialToRenderElementOffset(q$W.combineRenderElementsCount),q$_=q$R._material,q$W._addCombineMaterial(q$_),q$W._addCombineRenderObj(q$R),q$H=!0,q$_!==(q$J=q$V._material)?(q$k=q$J,q$C=q$W.combineRenderElementsCount,q$z=q$V):q$W._addCombineRenderObj(q$V),q$_=q$J}q$k&&(q$S.getRenderQueue(q$z._material.renderQueue)._addRenderElement(q$z),q$z=q$k=null,q$C=-1),this._prepareDynamicBatchCombineElements.length=0},q$S._clearRenderElements=function(){for(var q$S in this._dynamicBatches)this._dynamicBatches[q$S]._clearRenderElements()},q$S._addToRenderQueue=function(q$S,q$_,q$a,q$R){for(var q$J in this._dynamicBatches){var q$V=this._dynamicBatches[q$J];0<q$V.combineRenderElementsCount&&q$V._addToRenderQueue(q$S,q$_,q$a,q$R)}},q$S.dispose=function(){this._dynamicBatches=null},q$j._sortPrepareDynamicBatch=function(q$S,q$_){return q$S._mainSortID-q$_._mainSortID},q$j}(),q$aS=function(){function q$S(){}return q$G(q$S,"laya.d3.graphics.FrustumCulling"),q$S.renderShadowObjectCulling=function(q$S,q$_,q$a,q$R,q$J){var q$V=0,q$W=0,q$k=0,q$z=0;for(q$V=0,q$k=q$a.length;q$V<q$k;q$V++){var q$b=q$a[q$V];q$b&&q$b._clearRenderElements()}var q$H,q$L,q$C,q$G=q$S._cullingRenders;if(1<q$J){for(q$V=0,q$k=q$S._cullingRendersLength;q$V<q$k;q$V++)if((q$H=q$G[q$V]).castShadow&&q$u.isVisible(q$H._owner.layer.mask)&&q$H.enable)for(var q$t=1,q$o=q$_.length;q$t<q$o;q$t++)if(q$L=q$a[q$t-1],0!==q$_[q$t].containsBoundSphere(q$H.boundingSphere))for(q$W=0,q$z=(q$C=q$H._renderElements).length;q$W<q$z;q$W++)q$L._addRenderElement(q$C[q$W])}else for(q$V=0,q$k=q$S._cullingRendersLength;q$V<q$k;q$V++)if((q$H=q$G[q$V]).castShadow&&q$u.isVisible(q$H._owner.layer.mask)&&q$H.enable&&0!==q$_[0].containsBoundSphere(q$H.boundingSphere))for(q$H._renderUpdate(q$R),q$L=q$a[0],q$W=0,q$z=(q$C=q$H._renderElements).length;q$W<q$z;q$W++)q$L._addRenderElement(q$C[q$W])},q$S.renderShadowObjectCullingOctree=function(q$S,q$_,q$a,q$R,q$J){for(var q$V=0,q$W=q$a.length;q$V<q$W;q$V++){var q$k=q$a[q$V];q$k&&q$k._clearRenderElements()}1<q$J?q$S.treeRoot.cullingShadowObjects(q$_,q$a,!0,0,q$S):q$S.treeRoot.cullingShadowObjectsOnePSSM(q$_[0],q$a,q$R,!0,0,q$S)},q$S.renderObjectCulling=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=0,q$k=0,q$z=0,q$b=0,q$H=q$_._quenes,q$L=q$_._dynamicBatchManager,q$C=q$_._cullingRenders;for(q$W=0,q$k=q$H.length;q$W<q$k;q$W++){var q$G=q$H[q$W];q$G&&q$G._clearRenderElements()}var q$t=q$RS._staticBatchManagers;for(q$W=0,q$k=q$t.length;q$W<q$k;q$W++)q$t[q$W]._clearRenderElements();q$L._clearRenderElements();var q$o=q$a.transform.position;for(q$W=0,q$k=q$_._cullingRendersLength;q$W<q$k;q$W++){var q$$=q$C[q$W];if(q$u.isVisible(q$$._owner.layer.mask)&&q$$.enable&&0!==q$S.containsBoundSphere(q$$.boundingSphere)&&q$$._renderUpdate(q$V)){q$$._distanceForSort=q$W_.distance(q$$.boundingSphere.center,q$o)+q$$.sortingFudge;var q$F=q$$._renderElements;for(q$z=0,q$b=q$F.length;q$z<q$b;q$z++){var q$T=q$F[q$z],q$D=q$T._staticBatch;if(q$D&&q$D._material===q$T._material)q$D._addBatchRenderElement(q$T);else{var q$j=q$T.renderObj;q$j.triangleCount<10&&1===q$j._vertexBufferCount&&q$j._getIndexBuffer()&&q$T._material.renderQueue<2&&q$T._canDynamicBatch&&!q$$._owner.isStatic?q$L._addPrepareRenderElement(q$T):q$_.getRenderQueue(q$T._material.renderQueue)._addRenderElement(q$T)}}}}for(q$W=0,q$k=q$t.length;q$W<q$k;q$W++)q$t[q$W]._addToRenderQueue(q$_,q$R,q$J,q$V);q$L._finishCombineDynamicBatch(q$_),q$L._addToRenderQueue(q$_,q$R,q$J,q$V)},q$S.renderObjectCullingOctree=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=0,q$k=0,q$z=q$_._quenes,q$b=q$_._dynamicBatchManager;for(q$W=0,q$k=q$z.length;q$W<q$k;q$W++){var q$H=q$z[q$W];q$H&&q$H._clearRenderElements()}var q$L=q$RS._staticBatchManagers;for(q$W=0,q$k=q$L.length;q$W<q$k;q$W++)q$L[q$W]._clearRenderElements();for(q$b._clearRenderElements(),q$_._cullingRenders.length=0,q$_.treeRoot.cullingObjects(q$S,!0,0,q$a.transform.position,q$V),q$W=0,q$k=q$L.length;q$W<q$k;q$W++)q$L[q$W]._addToRenderQueue(q$_,q$R,q$J,q$V);q$b._finishCombineDynamicBatch(q$_),q$b._addToRenderQueue(q$_,q$R,q$J,q$V)},q$S.renderObjectCullingNoBoundFrustum=function(q$S,q$_,q$a,q$R,q$J){var q$V=0,q$W=0,q$k=0,q$z=0,q$b=q$S._quenes,q$H=q$S._dynamicBatchManager,q$L=q$S._cullingRenders;for(q$V=0,q$W=q$b.length;q$V<q$W;q$V++){var q$C=q$b[q$V];q$C&&q$C._clearRenderElements()}var q$G=q$RS._staticBatchManagers;for(q$V=0,q$W=q$G.length;q$V<q$W;q$V++)q$G[q$V]._clearRenderElements();q$H._clearRenderElements();var q$t=q$_.transform.position;for(q$V=0,q$W=q$S._cullingRendersLength;q$V<q$W;q$V++){var q$o=q$L[q$V];if(q$u.isVisible(q$o._owner.layer.mask)&&q$o.enable){q$o._renderUpdate(q$J),q$o._distanceForSort=q$W_.distance(q$o.boundingSphere.center,q$t)+q$o.sortingFudge;var q$$=q$o._renderElements;for(q$k=0,q$z=q$$.length;q$k<q$z;q$k++){var q$F=q$$[q$k],q$T=q$F._staticBatch;if(q$T&&q$T._material===q$F._material)q$T._addBatchRenderElement(q$F);else{var q$D=q$F.renderObj;q$D.triangleCount<10&&1===q$D._vertexBufferCount&&q$D._getIndexBuffer()&&q$F._material.renderQueue<2&&q$F._canDynamicBatch&&!q$o._owner.isStatic?q$H._addPrepareRenderElement(q$F):q$S.getRenderQueue(q$F._material.renderQueue)._addRenderElement(q$F)}}}}for(q$V=0,q$W=q$G.length;q$V<q$W;q$V++)q$G[q$V]._addToRenderQueue(q$S,q$a,q$R,q$J);q$H._finishCombineDynamicBatch(q$S),q$H._addToRenderQueue(q$S,q$a,q$R,q$J)},q$S}(),q$RS=function(){function q$V(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}q$G(q$V,"laya.d3.graphics.StaticBatchManager");var q$S=q$V.prototype;return q$S._finishInit=function(){for(var q$S in this._staticBatches)this._staticBatches[q$S]._finishInit();this._initBatchRenderElements.length=0},q$S._initStaticBatchs=function(q$S){throw new Error("StaticBatchManager:must override this function.")},q$S._addInitBatchSprite=function(q$S){for(var q$_=q$S._render._renderElements,q$a=0,q$R=q$_.length;q$a<q$R;q$a++)this._initBatchRenderElements.push(q$_[q$a])},q$S._clearRenderElements=function(){for(var q$S in this._staticBatches)this._staticBatches[q$S]._clearRenderElements()},q$S._garbageCollection=function(q$S){var q$_=q$S._staticBatch,q$a=q$_._initBatchRenderElements,q$R=q$a.indexOf(q$S);q$a.splice(q$R,1),0===q$a.length&&(q$_.dispose(),delete this._staticBatches[q$_._key])},q$S._addToRenderQueue=function(q$S,q$_,q$a,q$R){for(var q$J in this._staticBatches){var q$V=this._staticBatches[q$J];0<q$V._batchRenderElements.length&&q$V._updateToRenderQueue(q$S,q$R)}},q$S.dispose=function(){this._staticBatches=null},q$V._addToStaticBatchQueue=function(q$S){q$S instanceof laya.d3.core.RenderableSprite3D&&q$S._addToInitStaticBatchManager();for(var q$_=0,q$a=q$S.numChildren;q$_<q$a;q$_++)q$V._addToStaticBatchQueue(q$S._childs[q$_])},q$V.combine=function(q$S,q$_){var q$a,q$R=0,q$J=0;if(q$_)for(q$R=0,q$J=q$_.length;q$R<q$J;q$R++){q$_[q$R]._addToInitStaticBatchManager()}else q$S&&q$V._addToStaticBatchQueue(q$S);for(q$R=0,q$J=q$V._staticBatchManagers.length;q$R<q$J;q$R++)(q$a=q$V._staticBatchManagers[q$R])._initStaticBatchs(q$S),q$a._finishInit()},q$V._staticBatchManagers=[],q$V}(),q$JS=function(){function q$S(q$S,q$_,q$a){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=q$S,this._manager=q$_,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=q$a}q$G(q$S,"laya.d3.graphics.StaticBatch");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),q$_._binarySearch=function(q$S){for(var q$_=0,q$a=this._batchRenderElements.length-1,q$R=0;q$_<=q$a;)q$R=Math.floor((q$_+q$a)/2),this._compareBatchRenderElement(this._batchRenderElements[q$R],q$S)?q$a=q$R-1:q$_=q$R+1;return q$_},q$_._compareBatchRenderElement=function(q$S,q$_){throw new Error("StaticBatch:must override this function.")},q$_._getVertexDecLightMap=function(q$S){return q$S===q$eS.vertexDeclaration?q$uS.vertexDeclaration:q$S===q$rS.vertexDeclaration?q$hS.vertexDeclaration:q$S===q$nS.vertexDeclaration?q$jS.vertexDeclaration:q$S===q$US.vertexDeclaration?null:q$S===q$oS.vertexDeclaration?q$$S.vertexDeclaration:q$S===q$xS.vertexDeclaration?q$PS.vertexDeclaration:q$S===q$AS.vertexDeclaration?q$XS.vertexDeclaration:q$S===q$gS.vertexDeclaration?q$KS.vertexDeclaration:q$S===q$rS.vertexDeclaration?q$hS.vertexDeclaration:q$S===q$lS.vertexDeclaration?q$QS.vertexDeclaration:q$S===q$US.vertexDeclaration?null:q$S===q$oS.vertexDeclaration?q$$S.vertexDeclaration:q$S===q$sS.vertexDeclaration?q$MS.vertexDeclaration:q$S===q$AS.vertexDeclaration?q$XS.vertexDeclaration:q$S},q$_._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},q$_._addBatchRenderElement=function(q$S){this._batchRenderElements.splice(this._binarySearch(q$S),0,q$S)},q$_._updateToRenderQueue=function(q$S,q$_){this._combineRenderElementPoolIndex=0,this._getRenderElement(q$S.getRenderQueue(this._material.renderQueue)._renderElements,q$S,q$_)},q$_._getRenderElement=function(q$S,q$_,q$a){throw new Error("StaticBatch:must override this function.")},q$_._finishInit=function(){throw new Error("StaticBatch:must override this function.")},q$_._clearRenderElements=function(){this._batchRenderElements.length=0},q$_.dispose=function(){},q$_._getVertexBuffer=function(q$S){return void 0===q$S&&(q$S=0),null},q$_._getIndexBuffer=function(){return null},q$_._beforeRender=function(q$S){return!0},q$_._render=function(q$S){},q$_._getVertexBuffers=function(){return null},q$t(0,q$_,"_vertexBufferCount",function(){return 1}),q$t(0,q$_,"triangleCount",function(){return 0}),q$S.combine=function(q$S){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),q$RS.combine(q$S)},q$S.maxBatchVertexCount=65535,q$S}(),q$VS=function(){function q$W(q$S,q$_){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++q$W._uniqueIDCounter,this._id>q$W.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",q$W.maxVertexDeclaration);this._shaderValues=new q$C_,this._vertexElementsDic={},this._vertexStride=q$S,this._vertexElements=q$_;for(var q$a=0;q$a<q$_.length;q$a++){var q$R=q$_[q$a],q$J=q$R.elementUsage;this._vertexElementsDic[q$J]=q$R;var q$V=[q$W._getTypeSize(q$R.elementFormat)/4,5126,!1,this._vertexStride,q$R.offset];switch(this._shaderValues.setValue(q$J,q$V),q$J){case 1:this._addShaderDefine(q$N_.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(q$N_.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(q$N_.SHADERDEFINE_UV1)}}}q$G(q$W,"laya.d3.graphics.VertexDeclaration");var q$S=q$W.prototype;return q$S._addShaderDefine=function(q$S){this._shaderDefineValue|=q$S},q$S._removeShaderDefine=function(q$S){this._shaderDefineValue&=~q$S},q$S.getVertexElements=function(){return this._vertexElements.slice()},q$S.getVertexElementByUsage=function(q$S){return this._vertexElementsDic[q$S]},q$S.unBinding=function(){},q$t(0,q$S,"shaderDefineValue",function(){return this._shaderDefineValue}),q$t(0,q$S,"id",function(){return this._id}),q$t(0,q$S,"vertexStride",function(){return this._vertexStride}),q$t(0,q$S,"shaderValues",function(){return this._shaderValues}),q$W._getTypeSize=function(q$S){switch(q$S){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},q$W.getVertexStride=function(q$S){for(var q$_=0,q$a=0;q$a<q$S.Length;q$a++){var q$R=q$S[q$a],q$J=q$R.offset+q$W._getTypeSize(q$R.elementFormat);q$_<q$J&&(q$_=q$J)}return q$_},q$W._maxVertexDeclarationBit=1e3,q$W._uniqueIDCounter=1,q$L(q$W,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),q$W}(),q$WS=function(){function q$S(q$S,q$_,q$a){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=q$S,this.elementFormat=q$_,this.elementUsage=q$a}return q$G(q$S,"laya.d3.graphics.VertexElement"),q$S}(),q$kS=(function(){function q$S(){}q$G(q$S,"laya.d3.graphics.VertexElementFormat"),q$S.Single="single",q$S.Vector2="vector2",q$S.Vector3="vector3",q$S.Vector4="vector4",q$S.Color="color",q$S.Byte4="byte4",q$S.Short2="short2",q$S.Short4="short4",q$S.NormalizedShort2="normalizedshort2",q$S.NormalizedShort4="normalizedshort4",q$S.HalfVector2="halfvector2",q$S.HalfVector4="halfvector4"}(),function(){function q$S(){}q$G(q$S,"laya.d3.graphics.VertexElementUsage"),q$S.POSITION0=0,q$S.COLOR0=1,q$S.TEXTURECOORDINATE0=2,q$S.NORMAL0=3,q$S.BINORMAL0=4,q$S.TANGENT0=5,q$S.BLENDINDICES0=6,q$S.BLENDWEIGHT0=7,q$S.DEPTH0=8,q$S.FOG0=9,q$S.POINTSIZE0=10,q$S.SAMPLE0=11,q$S.TESSELLATEFACTOR0=12,q$S.COLOR1=13,q$S.NEXTTEXTURECOORDINATE0=14,q$S.TEXTURECOORDINATE1=15,q$S.NEXTTEXTURECOORDINATE1=16,q$S.CORNERTEXTURECOORDINATE0=17,q$S.VELOCITY0=18,q$S.STARTCOLOR0=19,q$S.STARTSIZE=20,q$S.AGEADDSCALE0=21,q$S.STARTROTATION=22,q$S.ENDCOLOR0=23,q$S.STARTLIFETIME=24,q$S.TIME0=33,q$S.SHAPEPOSITIONSTARTLIFETIME=30,q$S.DIRECTIONTIME=32,q$S.SIZEROTATION0=27,q$S.RADIUS0=28,q$S.RADIAN0=29,q$S.STARTSPEED=31,q$S.RANDOM0=34,q$S.RANDOM1=35,q$S.SIMULATIONWORLDPOSTION=36,q$S.SIMULATIONWORLDROTATION=37,q$S.TEXTURECOORDINATE0X=38,q$S.TEXTURECOORDINATE0X1=39,q$S.TEXTURECOORDINATE0Y=40,q$S.OFFSETVECTOR=41}(),function(){function q$S(q$S,q$_,q$a){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=q$S,this._textureCoordinate0=q$_,this._time=q$a}q$G(q$S,"laya.d3.graphics.VertexGlitter");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate0}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"time",function(){return this._time}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(24,[new q$WS(0,"vector3",0),new q$WS(12,"vector2",2),new q$WS(20,"single",33)])}])}(),function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=q$S,this._position=q$_,this._velocity=q$a,this._startColor=q$R,this._endColor=q$J,this._sizeRotation=q$V,this._radius=q$W,this._radian=q$k,this._ageAddScale=q$z,this._time=q$b}q$G(q$S,"laya.d3.graphics.VertexParticle");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"endColor",function(){return this._endColor}),q$t(0,q$_,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),q$t(0,q$_,"sizeRotation",function(){return this._sizeRotation}),q$t(0,q$_,"velocity",function(){return this._velocity}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"startColor",function(){return this._startColor}),q$t(0,q$_,"radius",function(){return this._radius}),q$t(0,q$_,"radian",function(){return this._radian}),q$t(0,q$_,"ageAddScale",function(){return this._ageAddScale}),q$t(0,q$_,"time",function(){return this._time}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(116,[new q$WS(0,"vector4",17),new q$WS(16,"vector3",0),new q$WS(28,"vector3",18),new q$WS(40,"vector4",19),new q$WS(56,"vector4",23),new q$WS(72,"vector3",27),new q$WS(84,"vector2",28),new q$WS(92,"vector4",29),new q$WS(108,"single",24),new q$WS(112,"single",33)])}])}(),function(){function q$S(q$S){this._position=null,this._position=q$S}q$G(q$S,"laya.d3.graphics.VertexPosition");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(12,[new q$WS(0,"vector3",0)])}]),q$S}()),q$zS=function(){function q$S(q$S,q$_){this._position=null,this._normal=null,this._position=q$S,this._normal=q$_}q$G(q$S,"laya.d3.graphics.VertexPositionNormal");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(24,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3)])}]),q$S}(),q$bS=function(){function q$S(q$S,q$_,q$a){this._position=null,this._normal=null,this._color=null,this._position=q$S,this._normal=q$_,this._color=q$a}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColor");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(40,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1)])}]),q$S}(),q$HS=function(){function q$S(q$S,q$_,q$a,q$R,q$J){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._blendIndex=q$R,this._blendWeight=q$J}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorSkin");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(72,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector4",7),new q$WS(56,"vector4",6)])}]),q$S}(),q$LS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._tangent=q$R,this._blendIndex=q$J,this._blendWeight=q$V}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(88,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector4",7),new q$WS(56,"vector4",6),new q$WS(72,"vector4",5)])}]),q$S}(),q$CS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._tangent=q$R,this._blendIndex=q$J,this._blendWeight=q$V}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(84,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector4",7),new q$WS(56,"vector4",6),new q$WS(72,"vector3",5)])}]),q$S}(),q$GS=function(){function q$S(q$S,q$_,q$a,q$R){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._tangent=q$R}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorSTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(56,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector4",5)])}]),q$S}(),q$tS=function(){function q$S(q$S,q$_,q$a,q$R){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._tangent=q$R}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(52,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector3",5)])}]),q$S}(),q$oS=function(){function q$S(q$S,q$_,q$a,q$R){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._textureCoordinate=q$R}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTexture");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(48,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector2",2)])}]),q$S}(),q$$S=function(){function q$S(q$S,q$_,q$a,q$R,q$J){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._textureCoordinate0=q$R,this._textureCoordinate1=q$J}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(56,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector2",2),new q$WS(48,"vector2",15)])}]),q$S}(),q$FS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._textureCoordinate0=q$R,this._textureCoordinate1=q$J,this._blendIndex=q$V,this._blendWeight=q$W}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(88,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector2",2),new q$WS(48,"vector2",15),new q$WS(56,"vector4",7),new q$WS(72,"vector4",6)])}]),q$S}(),q$TS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._textureCoordinate0=q$R,this._textureCoordinate1=q$J,this._tangent=q$V,this._blendIndex=q$W,this._blendWeight=q$k}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(104,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector2",2),new q$WS(48,"vector2",15),new q$WS(56,"vector4",7),new q$WS(72,"vector4",6),new q$WS(88,"vector4",5)])}]),q$S}(),q$DS=function(){function q$S(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$_.VertexPositionNormalColorTexture0SkinTangent=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){this._position=q$S,this._normal=q$_,this._color=q$a,this._textureCoordinate0=q$R,this._textureCoordinate1=q$J,this._tangent=q$V,this._blendIndex=q$W,this._blendWeight=q$k},q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(100,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector2",2),new q$WS(48,"vector2",15),new q$WS(56,"vector4",7),new q$WS(72,"vector4",6),new q$WS(88,"vector3",5)])}]),q$S}(),q$jS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._textureCoordinate0=q$R,this._textureCoordinate1=q$J,this._tangent=q$V}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(72,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector2",2),new q$WS(48,"vector2",15),new q$WS(56,"vector4",5)])}]),q$S}(),q$QS=function(){function q$S(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$_.VertexPositionNormalColorTexture0Tangent=function(q$S,q$_,q$a,q$R,q$J,q$V){this._position=q$S,this._normal=q$_,this._color=q$a,this._textureCoordinate0=q$R,this._textureCoordinate1=q$J,this._tangent=q$V},q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(68,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector2",2),new q$WS(48,"vector2",15),new q$WS(56,"vector3",5)])}]),q$S}(),q$mS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._textureCoordinate=q$R,this._blendIndex=q$J,this._blendWeight=q$V}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(80,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector2",2),new q$WS(48,"vector4",7),new q$WS(64,"vector4",6)])}]),q$S}(),q$qS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._textureCoordinate=q$R,this._tangent=q$J,this._blendIndex=q$V,this._blendWeight=q$W}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(96,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector2",2),new q$WS(48,"vector4",7),new q$WS(64,"vector4",6),new q$WS(80,"vector4",5)])}]),q$S}(),q$NS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._textureCoordinate=q$R,this._tangent=q$J,this._blendIndex=q$V,this._blendWeight=q$W}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(92,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector2",2),new q$WS(48,"vector4",7),new q$WS(64,"vector4",6),new q$WS(80,"vector3",5)])}]),q$S}(),q$nS=function(){function q$S(q$S,q$_,q$a,q$R,q$J){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._textureCoordinate=q$R,this._tangent=q$J}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(64,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector2",2),new q$WS(48,"vector4",5)])}]),q$S}(),q$lS=function(){function q$S(q$S,q$_,q$a,q$R,q$J){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._color=q$a,this._textureCoordinate=q$R,this._tangent=q$J}q$G(q$S,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"color",function(){return this._color}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(60,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",1),new q$WS(40,"vector2",2),new q$WS(48,"vector3",5)])}]),q$S}(),q$BS=function(){function q$S(q$S,q$_,q$a){this._position=null,this._normal=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._tangent=q$a}q$G(q$S,"laya.d3.graphics.VertexPositionNormalSTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(40,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector4",5)])}]),q$S}(),q$IS=function(){function q$S(q$S,q$_,q$a){this._position=null,this._normal=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._tangent=q$a}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(36,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector3",5)])}]),q$S}(),q$AS=function(){function q$S(q$S,q$_,q$a){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=q$S,this._normal=q$_,this._textureCoordinate=q$a}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTexture");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(32,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2)])}]),q$S}(),q$XS=function(){function q$S(q$S,q$_,q$a,q$R){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=q$S,this._normal=q$_,this._textureCoordinate0=q$a,this._textureCoordinate1=q$R}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(40,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2),new q$WS(32,"vector2",15)])}]),q$S}(),q$hS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=q$S,this._normal=q$_,this._textureCoordinate0=q$a,this._textureCoordinate1=q$R,this._blendIndex=q$J,this._blendWeight=q$V}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(72,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2),new q$WS(32,"vector2",15),new q$WS(40,"vector4",7),new q$WS(56,"vector4",6)])}]),q$S}(),q$uS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._textureCoordinate0=q$a,this._textureCoordinate1=q$R,this._tangent=q$J,this._blendIndex=q$V,this._blendWeight=q$W}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(88,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2),new q$WS(32,"vector2",15),new q$WS(40,"vector4",7),new q$WS(56,"vector4",6),new q$WS(72,"vector4",5)])}]),q$S}(),q$KS=function(){function q$S(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$_.VertexPositionNormalTexture0SkinTangent=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){this._position=q$S,this._normal=q$_,this._textureCoordinate0=q$a,this._textureCoordinate1=q$R,this._tangent=q$J,this._blendIndex=q$V,this._blendWeight=q$W},q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(84,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2),new q$WS(32,"vector2",15),new q$WS(40,"vector4",7),new q$WS(56,"vector4",6),new q$WS(72,"vector3",5)])}]),q$S}(),q$PS=function(){function q$S(q$S,q$_,q$a,q$R,q$J){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._textureCoordinate0=q$a,this._textureCoordinate1=q$R,this._tangent=q$J}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(56,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2),new q$WS(32,"vector2",15),new q$WS(40,"vector4",5)])}]),q$S}(),q$MS=function(){function q$S(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$_.VertexPositionNormalTexture0Tangent=function(q$S,q$_,q$a,q$R,q$J){this._position=q$S,this._normal=q$_,this._textureCoordinate0=q$a,this._textureCoordinate1=q$R,this._tangent=q$J},q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(52,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2),new q$WS(32,"vector2",15),new q$WS(40,"vector3",5)])}]),q$S}(),q$rS=function(){function q$S(q$S,q$_,q$a,q$R,q$J){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=q$S,this._normal=q$_,this._textureCoordinate=q$a,this._blendIndex=q$R,this._blendWeight=q$J}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTextureSkin");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(64,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2),new q$WS(32,"vector4",7),new q$WS(48,"vector4",6)])}]),q$S}(),q$eS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._textureCoordinate=q$a,this._tangent=q$R,this._blendIndex=q$J,this._blendWeight=q$V}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(80,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2),new q$WS(32,"vector4",7),new q$WS(48,"vector4",6),new q$WS(64,"vector4",5)])}]),q$S}(),q$gS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._textureCoordinate=q$a,this._tangent=q$R,this._blendIndex=q$J,this._blendWeight=q$V}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(76,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2),new q$WS(32,"vector4",7),new q$WS(48,"vector4",6),new q$WS(64,"vector3",5)])}]),q$S}(),q$xS=function(){function q$S(q$S,q$_,q$a,q$R){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._textureCoordinate=q$a,this._tangent=q$R}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(48,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2),new q$WS(32,"vector4",5)])}]),q$S}(),q$sS=function(){function q$S(q$S,q$_,q$a,q$R){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=q$S,this._normal=q$_,this._textureCoordinate=q$a,this._tangent=q$R}q$G(q$S,"laya.d3.graphics.VertexPositionNormalTextureTangent");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(44,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2),new q$WS(32,"vector3",5)])}]),q$S}(),q$US=function(){function q$S(q$S,q$_,q$a){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=q$S,this._normal=q$_,this._textureCoordinate=q$a}q$G(q$S,"laya.d3.graphics.VertexPositionNTBTexture");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(56,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector3",5),new q$WS(36,"vector3",4),new q$WS(48,"vector2",2)])}]),q$S}(),q$fS=function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=q$S,this._normal=q$_,this._textureCoordinate0=q$R,this._textureCoordinate1=q$J,this._tangent=q$V,q$a=q$a,this._blendIndex=q$W,this._blendWeight=q$k}q$G(q$S,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"tangent",function(){return this._tangent}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(0,q$_,"textureCoordinate1",function(){return this._textureCoordinate1}),q$t(0,q$_,"blendIndex",function(){return this._blendIndex}),q$t(0,q$_,"blendWeight",function(){return this._blendWeight}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(96,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector3",5),new q$WS(36,"vector3",4),new q$WS(48,"vector2",2),new q$WS(56,"vector2",15),new q$WS(64,"vector4",7),new q$WS(80,"vector4",6)])}]),q$S}(),q$YS=function(){function q$S(q$S,q$_,q$a){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=q$S,this._normal=q$_,this._textureCoordinate=q$a}q$G(q$S,"laya.d3.graphics.VertexPositionNTBTextureSkin");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"textureCoordinate",function(){return this._textureCoordinate}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(88,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector3",5),new q$WS(36,"vector3",4),new q$WS(48,"vector2",2),new q$WS(56,"vector4",7),new q$WS(72,"vector4",6)])}]),q$S}(),q$iS=(function(){function q$S(q$S,q$_,q$a,q$R){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=q$S,this._normal=q$_,this._textureCoord0=q$a,this._textureCoord1=q$R}q$G(q$S,"laya.d3.graphics.VertexPositionTerrain");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"normal",function(){return this._normal}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"textureCoord0",function(){return this._textureCoord0}),q$t(0,q$_,"textureCoord1",function(){return this._textureCoord1}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(40,[new q$WS(0,"vector3",0),new q$WS(12,"vector3",3),new q$WS(24,"vector2",2),new q$WS(32,"vector2",15)])}])}(),function(){function q$S(q$S,q$_){this._position=null,this._textureCoordinate0=null,this._position=q$S,this._textureCoordinate0=q$_}q$G(q$S,"laya.d3.graphics.VertexPositionTexture0");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"position",function(){return this._position}),q$t(0,q$_,"textureCoordinate0",function(){return this._textureCoordinate0}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(20,[new q$WS(0,"vector3",0),new q$WS(12,"vector2",2)])}]),q$S}()),q$ZS=(function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$L,q$C,q$G){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=q$S,this._positionStartLifeTime=q$_,this._velocity=q$a,this._startColor=q$R,this._startSize=q$J,this._startRotation0=q$V,this._startRotation1=q$W,this._startRotation2=q$k,this._startLifeTime=q$z,this._time=q$b,this._startSpeed=q$H,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=q$G}q$G(q$S,"laya.d3.graphics.VertexShurikenParticleBillboard");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),q$t(0,q$_,"random1",function(){return this._randoms1}),q$t(0,q$_,"startRotation2",function(){return this._startRotation2}),q$t(0,q$_,"positionStartLifeTime",function(){return this._positionStartLifeTime}),q$t(0,q$_,"velocity",function(){return this._velocity}),q$t(0,q$_,"random0",function(){return this._randoms0}),q$t(0,q$_,"startSize",function(){return this._startSize}),q$t(0,q$_,"startColor",function(){return this._startColor}),q$t(0,q$_,"startRotation0",function(){return this._startRotation0}),q$t(0,q$_,"startRotation1",function(){return this._startRotation1}),q$t(0,q$_,"startLifeTime",function(){return this._startLifeTime}),q$t(0,q$_,"time",function(){return this._time}),q$t(0,q$_,"startSpeed",function(){return this._startSpeed}),q$t(0,q$_,"simulationWorldPostion",function(){return this._simulationWorldPostion}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(152,[new q$WS(0,"vector4",17),new q$WS(16,"vector4",30),new q$WS(32,"vector4",32),new q$WS(48,"vector4",19),new q$WS(64,"vector3",20),new q$WS(76,"vector3",22),new q$WS(88,"single",31),new q$WS(92,"vector4",34),new q$WS(108,"vector4",35),new q$WS(124,"vector3",36),new q$WS(136,"vector4",37)])}])}(),function(){function q$S(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$L,q$C,q$G){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=q$S,this._positionStartLifeTime=q$_,this._velocity=q$a,this._startColor=q$R,this._startSize=q$J,this._startRotation0=q$V,this._startRotation1=q$W,this._startRotation2=q$k,this._startLifeTime=q$z,this._time=q$b,this._startSpeed=q$H,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=q$G}q$G(q$S,"laya.d3.graphics.VertexShurikenParticleMesh");var q$_=q$S.prototype;q$Q.imps(q$_,{"laya.d3.graphics.IVertex":!0}),q$t(0,q$_,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),q$t(0,q$_,"velocity",function(){return this._velocity}),q$t(0,q$_,"position",function(){return this._positionStartLifeTime}),q$t(0,q$_,"random0",function(){return this._randoms0}),q$t(0,q$_,"startSize",function(){return this._startSize}),q$t(0,q$_,"startColor",function(){return this._startColor}),q$t(0,q$_,"startRotation0",function(){return this._startRotation0}),q$t(0,q$_,"startRotation1",function(){return this._startRotation1}),q$t(0,q$_,"random1",function(){return this._randoms1}),q$t(0,q$_,"startRotation2",function(){return this._startRotation2}),q$t(0,q$_,"startLifeTime",function(){return this._startLifeTime}),q$t(0,q$_,"time",function(){return this._time}),q$t(0,q$_,"startSpeed",function(){return this._startSpeed}),q$t(0,q$_,"simulationWorldPostion",function(){return this._simulationWorldPostion}),q$t(0,q$_,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$t(1,q$S,"vertexDeclaration",function(){return q$S._vertexDeclaration}),q$L(q$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new q$VS(172,[new q$WS(0,"vector3",0),new q$WS(12,"vector4",1),new q$WS(28,"vector2",2),new q$WS(36,"vector4",30),new q$WS(52,"vector4",32),new q$WS(68,"vector4",19),new q$WS(84,"vector3",20),new q$WS(96,"vector3",22),new q$WS(108,"single",31),new q$WS(112,"vector4",34),new q$WS(128,"vector4",35),new q$WS(144,"vector3",36),new q$WS(156,"vector4",37)])}])}(),function(){function q$D(q$S,q$_,q$a,q$R,q$J,q$V){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=q$a,this._materials=q$R,this._subMeshes=q$J,this._materialMap=q$V,this._version=q$_,this._onLoaded(q$S)}q$G(q$D,"laya.d3.loaders.LoadModelV01");var q$S=q$D.prototype;return q$S._onLoaded=function(q$S){this._readData=q$S,this.READ_BLOCK();for(var q$_=0;q$_<this._BLOCK.count;q$_++){var q$a=this._readData.getUint16(),q$R=this._strings[q$a],q$J=this["READ_"+q$R];if(null==q$J)throw new Error("model file err,no this function:"+q$a+" "+q$R);if(!q$J.call(this))break}return this._mesh},q$S.onError=function(){},q$S._readString=function(){return this._strings[this._readData.getUint16()]},q$S.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},q$S.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},q$S.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var q$S=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var q$_=0;q$_<this._STRINGS.size;q$_++)this._strings[q$_]=this._readData.readUTFString();return this._readData.pos=q$S,!0},q$S.READ_MATERIAL=function(){var q$S=this._readData.getUint16(),q$_=(this._readString(),this._readString());return this._materials[q$S]="null"!==q$_?q$F.getRes(this._materialMap[q$_]):new q$I_,!0},q$S.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var q$S,q$_=this._readData.__getBuffer(),q$a=0,q$R=this._readData.getUint32(),q$J=this._readData.getUint32(),q$V=(new Float32Array(q$_.slice(q$R+this._DATA.offset,q$R+this._DATA.offset+q$J)),this._readData.getUint32()),q$W=this._readData.getUint32(),q$k=new Float32Array(q$_.slice(q$V+this._DATA.offset,q$V+this._DATA.offset+q$W));for(this.mesh._inverseBindPoses=[],q$a=0,q$S=q$k.length;q$a<q$S;q$a+=16){var q$z=new q$S_(q$k[q$a+0],q$k[q$a+1],q$k[q$a+2],q$k[q$a+3],q$k[q$a+4],q$k[q$a+5],q$k[q$a+6],q$k[q$a+7],q$k[q$a+8],q$k[q$a+9],q$k[q$a+10],q$k[q$a+11],q$k[q$a+12],q$k[q$a+13],q$k[q$a+14],q$k[q$a+15]);this.mesh._inverseBindPoses.push(q$z)}break;default:throw new Error("LoadModel:unknown version.")}return!0},q$S.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var q$S=this._readString();this._shaderAttributes=q$S.match(q$D._attrReg);var q$_=this._readData.getUint32(),q$a=this._readData.getUint32(),q$R=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),q$J=this._readData.getUint32(),q$V=this._readData.getUint32(),q$W=this._readData.getUint32(),q$k=this._readData.__getBuffer(),q$z=new q$b_(this._mesh),q$b=this._getVertexDeclaration(),q$H=q$g_.create(q$b,q$J/q$b.vertexStride,35044,!0),q$L=q$R+this._DATA.offset,q$C=q$k.slice(q$L,q$L+q$J);q$H.setData(new Float32Array(q$C));for(var q$G=(q$z._vertexBuffer=q$H).vertexDeclaration.getVertexElements(),q$t=0;q$t<q$G.length;q$t++)q$z._bufferUsage[q$G[q$t].elementUsage]=q$H;var q$o=q$e_.create("ushort",q$a/2,35044,!0),q$$=q$_+this._DATA.offset,q$F=q$k.slice(q$$,q$$+q$a);q$o.setData(new Uint16Array(q$F)),q$z._indexBuffer=q$o;var q$T=q$k.slice(q$V+this._DATA.offset,q$V+this._DATA.offset+q$W);return q$z._boneIndicesList[0]=new Uint8Array(q$T),this._subMeshes.push(q$z),!0},q$S.READ_DATAAREA=function(){return!1},q$S._getVertexDeclaration=function(){for(var q$S,q$_=!1,q$a=!1,q$R=!1,q$J=!1,q$V=!1,q$W=!1,q$k=!1,q$z=!1,q$b=!1,q$H=0;q$H<this._shaderAttributes.length;q$H+=8)switch(this._shaderAttributes[q$H]){case"POSITION":q$_=!0;break;case"NORMAL":q$a=!0;break;case"COLOR":q$R=!0;break;case"UV":q$J=!0;break;case"UV1":q$V=!0;break;case"BLENDWEIGHT":q$k=!0;break;case"BLENDINDICES":q$z=!0;break;case"TANGENT":q$W=!0;break;case"BINORMAL":q$b=!0}return q$_&&q$a&&q$R&&q$J&&q$V&&q$k&&q$z&&q$W?q$S=q$DS.vertexDeclaration:q$_&&q$a&&q$R&&q$J&&q$V&&q$k&&q$z?q$S=q$FS.vertexDeclaration:q$_&&q$a&&q$J&&q$V&&q$k&&q$z&&q$W?q$S=q$KS.vertexDeclaration:q$_&&q$a&&q$J&&q$V&&q$k&&q$z?q$S=q$hS.vertexDeclaration:q$_&&q$a&&q$R&&q$J&&q$k&&q$z&&q$W?q$S=q$NS.vertexDeclaration:q$_&&q$a&&q$R&&q$J&&q$k&&q$z?q$S=q$mS.vertexDeclaration:q$_&&q$a&&q$W&&q$b&&q$J&&q$k&&q$z?q$S=q$YS.vertexDeclaration:q$_&&q$a&&q$J&&q$k&&q$z&&q$W?q$S=q$gS.vertexDeclaration:q$_&&q$a&&q$J&&q$k&&q$z?q$S=q$rS.vertexDeclaration:q$_&&q$a&&q$R&&q$k&&q$z&&q$W?q$S=q$CS.vertexDeclaration:q$_&&q$a&&q$R&&q$k&&q$z?q$S=q$HS.vertexDeclaration:q$_&&q$a&&q$R&&q$J&&q$V&&q$W?q$S=q$QS.vertexDeclaration:q$_&&q$a&&q$R&&q$J&&q$V?q$S=q$$S.vertexDeclaration:q$_&&q$a&&q$J&&q$V&&q$W?q$S=q$MS.vertexDeclaration:q$_&&q$a&&q$J&&q$V?q$S=q$XS.vertexDeclaration:q$_&&q$a&&q$R&&q$J&&q$W?q$S=q$lS.vertexDeclaration:q$_&&q$a&&q$J&&q$W&&q$b?q$S=q$US.vertexDeclaration:q$_&&q$a&&q$R&&q$J?q$S=q$oS.vertexDeclaration:q$_&&q$a&&q$J&&q$W?q$S=q$sS.vertexDeclaration:q$_&&q$a&&q$J?q$S=q$AS.vertexDeclaration:q$_&&q$a&&q$R&&q$W?q$S=q$tS.vertexDeclaration:q$_&&q$a&&q$R&&(q$S=q$bS.vertexDeclaration),q$S},q$t(0,q$S,"mesh",function(){return this._mesh}),q$D._attrReg=new RegExp("(\\w+)|([:,;])","g"),q$D}()),q$pS=function(){function q$q(){}return q$G(q$q,"laya.d3.loaders.LoadModelV02"),q$q.parse=function(q$S,q$_,q$a,q$R,q$J,q$V){q$q._mesh=q$a,q$q._materials=q$R,q$q._subMeshes=q$J,q$q._materialMap=q$V,q$q._version=q$_,q$q._readData=q$S,q$q.READ_DATA(),q$q.READ_BLOCK(),q$q.READ_STRINGS();for(var q$W=0,q$k=q$q._BLOCK.count;q$W<q$k;q$W++){q$q._readData.pos=q$q._BLOCK.blockStarts[q$W];var q$z=q$q._readData.getUint16(),q$b=q$q._strings[q$z],q$H=q$q["READ_"+q$b];if(null==q$H)throw new Error("model file err,no this function:"+q$z+" "+q$b);q$H.call()}q$q._strings.length=0,q$q._readData=null,q$q._version=null,q$q._mesh=null,q$q._materials=null,q$q._subMeshes=null,q$q._materialMap=null},q$q._readString=function(){return q$q._strings[q$q._readData.getUint16()]},q$q.READ_DATA=function(){q$q._DATA.offset=q$q._readData.getUint32(),q$q._DATA.size=q$q._readData.getUint32()},q$q.READ_BLOCK=function(){for(var q$S=q$q._BLOCK.count=q$q._readData.getUint16(),q$_=q$q._BLOCK.blockStarts=[],q$a=q$q._BLOCK.blockLengths=[],q$R=0;q$R<q$S;q$R++)q$_.push(q$q._readData.getUint32()),q$a.push(q$q._readData.getUint32())},q$q.READ_STRINGS=function(){var q$S=q$q._readData.getUint32(),q$_=q$q._readData.getUint16(),q$a=q$q._readData.pos;q$q._readData.pos=q$S+q$q._DATA.offset;for(var q$R=0;q$R<q$_;q$R++)q$q._strings[q$R]=q$q._readData.readUTFString();q$q._readData.pos=q$a},q$q.READ_MATERIAL=function(){q$q._readString(),q$q._readString();var q$S=q$q._readString();return""!==q$S&&q$q._materials.push(q$F.getRes(q$q._materialMap[q$S])),!0},q$q.READ_MESH=function(){q$q._readString();var q$S,q$_=q$q._readData.__getBuffer(),q$a=0,q$R=q$q._readData.getInt16(),q$J=q$q._DATA.offset;for(q$a=0;q$a<q$R;q$a++){var q$V=q$J+q$q._readData.getUint32(),q$W=q$q._readData.getUint32(),q$k=new Float32Array(q$_.slice(q$V,q$V+q$W)),q$z=q$q._readString().match(q$q._attrReg),q$b=q$q._getVertexDeclaration(q$z),q$H=q$g_.create(q$b,4*q$k.length/q$b.vertexStride,35044,!0);q$H.setData(q$k),q$q._mesh._vertexBuffers.push(q$H)}var q$L=q$J+q$q._readData.getUint32(),q$C=q$q._readData.getUint32(),q$G=new Uint16Array(q$_.slice(q$L,q$L+q$C)),q$t=q$e_.create("ushort",q$C/2,35044,!0);q$t.setData(q$G),q$q._mesh._indexBuffer=q$t;var q$o=q$q._mesh._boneNames=[],q$$=q$q._readData.getUint16();for(q$o.length=q$$,q$a=0;q$a<q$$;q$a++)q$o[q$a]=q$q._strings[q$q._readData.getUint16()];var q$F=q$q._readData.getUint32(),q$T=q$q._readData.getUint32(),q$D=(new Float32Array(q$_.slice(q$J+q$F,q$J+q$F+q$T)),q$q._readData.getUint32()),q$j=q$q._readData.getUint32(),q$Q=new Float32Array(q$_.slice(q$J+q$D,q$J+q$D+q$j));for(q$q._mesh._inverseBindPoses=[],q$a=0,q$S=q$Q.length;q$a<q$S;q$a+=16){var q$m=new q$S_(q$Q[q$a+0],q$Q[q$a+1],q$Q[q$a+2],q$Q[q$a+3],q$Q[q$a+4],q$Q[q$a+5],q$Q[q$a+6],q$Q[q$a+7],q$Q[q$a+8],q$Q[q$a+9],q$Q[q$a+10],q$Q[q$a+11],q$Q[q$a+12],q$Q[q$a+13],q$Q[q$a+14],q$Q[q$a+15]);q$q._mesh._inverseBindPoses.push(q$m)}return q$q._mesh._skinnedDatas=new Float32Array(16*q$Q.length),!0},q$q.READ_SUBMESH=function(){var q$S=q$q._readData.__getBuffer(),q$_=new q$b_(q$q._mesh),q$a=q$q._readData.getInt16(),q$R=q$q._readData.getUint32(),q$J=q$q._readData.getUint32();q$_._vertexBuffer=q$q._mesh._vertexBuffers[q$a],q$_._vertexStart=q$R,q$_._vertexCount=q$J;var q$V=q$q._readData.getUint32(),q$W=q$q._readData.getUint32(),q$k=q$q._mesh._indexBuffer;q$_._indexBuffer=q$k,q$_._indexStart=q$V,q$_._indexCount=q$W,q$_._indices=new Uint16Array(q$k.getData().buffer,2*q$V,q$W);var q$z=q$q._DATA.offset,q$b=q$_._subIndexBufferStart,q$H=q$_._subIndexBufferCount,q$L=q$_._boneIndicesList,q$C=q$q._readData.getUint16();q$b.length=q$C,q$H.length=q$C,q$L.length=q$C;for(var q$G=0;q$G<q$C;q$G++){q$b[q$G]=q$q._readData.getUint32(),q$H[q$G]=q$q._readData.getUint32();var q$t=q$q._readData.getUint32(),q$o=q$q._readData.getUint32();q$_._boneIndicesList[q$G]=new Uint8Array(q$S.slice(q$z+q$t,q$z+q$t+q$o))}return q$q._subMeshes.push(q$_),!0},q$q._getVertexDeclaration=function(q$S){for(var q$_,q$a=!1,q$R=!1,q$J=!1,q$V=!1,q$W=!1,q$k=!1,q$z=!1,q$b=!1,q$H=!1,q$L=0;q$L<q$S.length;q$L++)switch(q$S[q$L]){case"POSITION":q$a=!0;break;case"NORMAL":q$R=!0;break;case"COLOR":q$J=!0;break;case"UV":q$V=!0;break;case"UV1":q$W=!0;break;case"BLENDWEIGHT":q$z=!0;break;case"BLENDINDICES":q$b=!0;break;case"TANGENT":q$k=!0;break;case"BINORMAL":q$H=!0}return q$a&&q$R&&q$J&&q$V&&q$W&&q$z&&q$b&&q$k?q$_=q$DS.vertexDeclaration:q$a&&q$R&&q$J&&q$V&&q$W&&q$z&&q$b?q$_=q$FS.vertexDeclaration:q$a&&q$R&&q$V&&q$W&&q$z&&q$b&&q$k?q$_=q$KS.vertexDeclaration:q$a&&q$R&&q$V&&q$W&&q$z&&q$b?q$_=q$hS.vertexDeclaration:q$a&&q$R&&q$J&&q$V&&q$z&&q$b&&q$k?q$_=q$NS.vertexDeclaration:q$a&&q$R&&q$J&&q$V&&q$z&&q$b?q$_=q$mS.vertexDeclaration:q$a&&q$R&&q$V&&q$z&&q$b&&q$k?q$_=q$gS.vertexDeclaration:q$a&&q$R&&q$V&&q$z&&q$b?q$_=q$rS.vertexDeclaration:q$a&&q$R&&q$J&&q$z&&q$b&&q$k?q$_=q$CS.vertexDeclaration:q$a&&q$R&&q$J&&q$z&&q$b?q$_=q$HS.vertexDeclaration:q$a&&q$R&&q$J&&q$V&&q$W&&q$k?q$_=q$QS.vertexDeclaration:q$a&&q$R&&q$J&&q$V&&q$W?q$_=q$$S.vertexDeclaration:q$a&&q$R&&q$V&&q$W&&q$k?q$_=q$MS.vertexDeclaration:q$a&&q$R&&q$V&&q$W?q$_=q$XS.vertexDeclaration:q$a&&q$R&&q$J&&q$V&&q$k?q$_=q$lS.vertexDeclaration:q$a&&q$R&&q$V&&q$k&&q$H?q$_=q$US.vertexDeclaration:q$a&&q$R&&q$J&&q$V?q$_=q$oS.vertexDeclaration:q$a&&q$R&&q$V&&q$k?q$_=q$sS.vertexDeclaration:q$a&&q$R&&q$V?q$_=q$AS.vertexDeclaration:q$a&&q$R&&q$J&&q$k?q$_=q$tS.vertexDeclaration:q$a&&q$R&&q$J&&(q$_=q$bS.vertexDeclaration),q$_},q$q._attrReg=new RegExp("(\\w+)|([:,;])","g"),q$q._strings=[],q$q._readData=null,q$q._version=null,q$q._mesh=null,q$q._materials=null,q$q._subMeshes=null,q$q._materialMap=null,q$L(q$q,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),q$q}(),q$cS=function(){function q$m(){}return q$G(q$m,"laya.d3.loaders.LoadModelV03"),q$m.parse=function(q$S,q$_,q$a,q$R,q$J){q$m._mesh=q$a,q$m._subMeshes=q$R,q$m._materialMap=q$J,q$m._version=q$_,q$m._readData=q$S,q$m.READ_DATA(),q$m.READ_BLOCK(),q$m.READ_STRINGS();for(var q$V=0,q$W=q$m._BLOCK.count;q$V<q$W;q$V++){q$m._readData.pos=q$m._BLOCK.blockStarts[q$V];var q$k=q$m._readData.getUint16(),q$z=q$m._strings[q$k],q$b=q$m["READ_"+q$z];if(null==q$b)throw new Error("model file err,no this function:"+q$k+" "+q$z);q$b.call()}q$m._strings.length=0,q$m._readData=null,q$m._version=null,q$m._mesh=null,q$m._subMeshes=null,q$m._materialMap=null},q$m._readString=function(){return q$m._strings[q$m._readData.getUint16()]},q$m.READ_DATA=function(){q$m._DATA.offset=q$m._readData.getUint32(),q$m._DATA.size=q$m._readData.getUint32()},q$m.READ_BLOCK=function(){for(var q$S=q$m._BLOCK.count=q$m._readData.getUint16(),q$_=q$m._BLOCK.blockStarts=[],q$a=q$m._BLOCK.blockLengths=[],q$R=0;q$R<q$S;q$R++)q$_.push(q$m._readData.getUint32()),q$a.push(q$m._readData.getUint32())},q$m.READ_STRINGS=function(){var q$S=q$m._readData.getUint32(),q$_=q$m._readData.getUint16(),q$a=q$m._readData.pos;q$m._readData.pos=q$S+q$m._DATA.offset;for(var q$R=0;q$R<q$_;q$R++)q$m._strings[q$R]=q$m._readData.readUTFString();q$m._readData.pos=q$a},q$m.READ_MESH=function(){var q$S,q$_=q$m._readString(),q$a=q$m._readData.__getBuffer(),q$R=0,q$J=q$m._readData.getInt16(),q$V=q$m._DATA.offset;for(q$R=0;q$R<q$J;q$R++){var q$W,q$k=q$V+q$m._readData.getUint32(),q$z=q$m._readData.getUint32(),q$b=new Float32Array(q$a.slice(q$k,q$k+q$z)),q$H=q$m._readString();switch(q$m._version){case"LAYAMODEL:03":q$W=q$m._vertexDeclarationMap_Discard[q$H];break;case"LAYAMODEL:0301":q$W=q$m._vertexDeclarationMap[q$H];break;default:throw new Error("LoadModelV03: unknown version.")}if(!q$W)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+q$m._version+"  bufferAttribute="+q$H+"  name="+q$_+"  url="+(q$m._mesh?q$m._mesh.url:"null"));var q$L=q$g_.create(q$W,4*q$b.length/q$W.vertexStride,35044,!0,q$m._mesh._url+"_"+q$R);q$L.setData(q$b),q$m._mesh._vertexBuffers.push(q$L)}var q$C=q$V+q$m._readData.getUint32(),q$G=q$m._readData.getUint32(),q$t=new Uint16Array(q$a.slice(q$C,q$C+q$G)),q$o=q$e_.create("ushort",q$G/2,35044,!0,q$m._mesh._url);q$o.setData(q$t),q$m._mesh._indexBuffer=q$o;var q$$=q$m._mesh._boneNames=[],q$F=q$m._readData.getUint16();for(q$$.length=q$F,q$R=0;q$R<q$F;q$R++)q$$[q$R]=q$m._strings[q$m._readData.getUint16()];q$m._readData.pos+=8;var q$T=q$m._readData.getUint32(),q$D=q$m._readData.getUint32(),q$j=new Float32Array(q$a.slice(q$V+q$T,q$V+q$T+q$D));for(q$m._mesh._inverseBindPoses=[],q$R=0,q$S=q$j.length;q$R<q$S;q$R+=16){var q$Q=new q$S_(q$j[q$R+0],q$j[q$R+1],q$j[q$R+2],q$j[q$R+3],q$j[q$R+4],q$j[q$R+5],q$j[q$R+6],q$j[q$R+7],q$j[q$R+8],q$j[q$R+9],q$j[q$R+10],q$j[q$R+11],q$j[q$R+12],q$j[q$R+13],q$j[q$R+14],q$j[q$R+15]);q$m._mesh._inverseBindPoses.push(q$Q)}return q$m._mesh._skinnedDatas=new Float32Array(16*q$j.length),!0},q$m.READ_SUBMESH=function(){var q$S=q$m._readData.__getBuffer(),q$_=new q$b_(q$m._mesh),q$a=q$m._readData.getInt16(),q$R=q$m._readData.getUint32(),q$J=q$m._readData.getUint32();q$_._vertexBuffer=q$m._mesh._vertexBuffers[q$a],q$_._vertexStart=q$R,q$_._vertexCount=q$J;var q$V=q$m._readData.getUint32(),q$W=q$m._readData.getUint32(),q$k=q$m._mesh._indexBuffer;q$_._indexBuffer=q$k,q$_._indexStart=q$V,q$_._indexCount=q$W,q$_._indices=new Uint16Array(q$k.getData().buffer,2*q$V,q$W);var q$z=q$m._DATA.offset,q$b=q$_._subIndexBufferStart,q$H=q$_._subIndexBufferCount,q$L=q$_._boneIndicesList,q$C=q$m._readData.getUint16();q$b.length=q$C,q$H.length=q$C,q$L.length=q$C;for(var q$G=0;q$G<q$C;q$G++){q$b[q$G]=q$m._readData.getUint32(),q$H[q$G]=q$m._readData.getUint32();var q$t=q$m._readData.getUint32(),q$o=q$m._readData.getUint32();q$L[q$G]=new Uint8Array(q$S.slice(q$z+q$t,q$z+q$t+q$o))}return q$m._subMeshes.push(q$_),!0},q$m._strings=[],q$m._readData=null,q$m._version=null,q$m._mesh=null,q$m._subMeshes=null,q$m._materialMap=null,q$L(q$m,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":q$DS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":q$FS.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":q$fS.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":q$KS.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":q$hS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":q$NS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":q$mS.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":q$gS.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":q$rS.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":q$CS.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":q$HS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":q$QS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":q$$S.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":q$MS.vertexDeclaration,"POSITION,NORMAL,UV,UV1":q$XS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":q$lS.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":q$US.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":q$oS.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":q$sS.vertexDeclaration,"POSITION,NORMAL,UV":q$AS.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":q$tS.vertexDeclaration,"POSITION,NORMAL,COLOR":q$bS.vertexDeclaration,"POSITION,NORMAL,TANGENT":q$IS.vertexDeclaration,"POSITION,NORMAL":q$zS.vertexDeclaration,"POSITION,UV":q$iS.vertexDeclaration,POSITION:q$kS.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":q$TS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":q$FS.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":q$fS.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":q$uS.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":q$hS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":q$qS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":q$mS.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":q$eS.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":q$rS.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":q$LS.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":q$HS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":q$jS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":q$$S.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":q$PS.vertexDeclaration,"POSITION,NORMAL,UV,UV1":q$XS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":q$nS.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":q$US.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":q$oS.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":q$xS.vertexDeclaration,"POSITION,NORMAL,UV":q$AS.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":q$GS.vertexDeclaration,"POSITION,NORMAL,COLOR":q$bS.vertexDeclaration,"POSITION,NORMAL,TANGENT":q$BS.vertexDeclaration,"POSITION,NORMAL":q$zS.vertexDeclaration,"POSITION,UV":q$iS.vertexDeclaration,POSITION:q$kS.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),q$m}(),q$yS=function(){function q$k(){}return q$G(q$k,"laya.d3.loaders.MeshReader"),q$k.read=function(q$S,q$_,q$a,q$R,q$J){var q$V=new q$m(q$S);q$V.pos=0;var q$W=q$V.readUTFString();switch(q$W){case"LAYAMODEL:01":case"LAYASKINANI:01":q$k._readVersion01(q$V,q$W,q$_,q$a,q$R,q$J);break;case"LAYAMODEL:02":q$pS.parse(q$V,q$W,q$_,q$a,q$R,q$J);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":q$cS.parse(q$V,q$W,q$_,q$R,q$J);break;default:throw new Error("MeshReader: unknown mesh version.")}q$_._setSubMeshes(q$R)},q$k._readVersion01=function(q$S,q$_,q$a,q$R,q$J,q$V){new q$ZS(q$S,q$_,q$a,q$R,q$J,q$V)},q$k}(),q$ES=function(){function q$S(q$S,q$_){this.min=null,this.max=null,this.min=q$S,this.max=q$_}q$G(q$S,"laya.d3.math.BoundBox");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_.getCorners=function(q$S){q$S.length=8;var q$_=this.min.elements,q$a=this.max.elements,q$R=q$_[0],q$J=q$_[1],q$V=q$_[2],q$W=q$a[0],q$k=q$a[1],q$z=q$a[2];q$S[0]=new q$W_(q$R,q$k,q$z),q$S[1]=new q$W_(q$W,q$k,q$z),q$S[2]=new q$W_(q$W,q$J,q$z),q$S[3]=new q$W_(q$R,q$J,q$z),q$S[4]=new q$W_(q$R,q$k,q$V),q$S[5]=new q$W_(q$W,q$k,q$V),q$S[6]=new q$W_(q$W,q$J,q$V),q$S[7]=new q$W_(q$R,q$J,q$V)},q$_.toDefault=function(){this.min.toDefault(),this.max.toDefault()},q$_.cloneTo=function(q$S){var q$_=q$S;this.min.cloneTo(q$_.min),this.max.cloneTo(q$_.max)},q$_.clone=function(){var q$S=new this.constructor(new q$W_,new q$W_);return this.cloneTo(q$S),q$S},q$S.createfromPoints=function(q$S,q$_){if(null==q$S)throw new Error("points");var q$a=q$_.min,q$R=q$_.max,q$J=q$a.elements;q$J[0]=Number.MAX_VALUE,q$J[1]=Number.MAX_VALUE,q$J[2]=Number.MAX_VALUE;var q$V=q$R.elements;q$V[0]=-Number.MAX_VALUE,q$V[1]=-Number.MAX_VALUE,q$V[2]=-Number.MAX_VALUE;for(var q$W=0,q$k=q$S.length;q$W<q$k;++q$W)q$W_.min(q$a,q$S[q$W],q$a),q$W_.max(q$R,q$S[q$W],q$R)},q$S.merge=function(q$S,q$_,q$a){q$W_.min(q$S.min,q$_.min,q$a.min),q$W_.max(q$S.max,q$_.max,q$a.max)},q$S}(),q$OS=function(){function q$b(q$S){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=q$S,this._near=new q$__(new q$W_),this._far=new q$__(new q$W_),this._left=new q$__(new q$W_),this._right=new q$__(new q$W_),this._top=new q$__(new q$W_),this._bottom=new q$__(new q$W_),q$b._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}q$G(q$b,"laya.d3.math.BoundFrustum");var q$S=q$b.prototype;return q$S.equalsBoundFrustum=function(q$S){return this._matrix.equalsOtherMatrix(q$S.matrix)},q$S.equalsObj=function(q$S){if(q$S instanceof laya.d3.math.BoundFrustum){var q$_=q$S;return this.equalsBoundFrustum(q$_)}return!1},q$S.getPlane=function(q$S){switch(q$S){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},q$S.getCorners=function(q$S){q$b._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(q$S[0]),q$b._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(q$S[1]),q$b._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(q$S[2]),q$b._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(q$S[3]),q$b._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(q$S[4]),q$b._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(q$S[5]),q$b._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(q$S[6]),q$b._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(q$S[7])},q$S.containsPoint=function(q$S){for(var q$_=q$__.PlaneIntersectionType_Front,q$a=q$__.PlaneIntersectionType_Front,q$R=0;q$R<6;q$R++){switch(q$R){case 0:q$a=Collision.intersectsPlaneAndPoint(this._near,q$S);break;case 1:q$a=Collision.intersectsPlaneAndPoint(this._far,q$S);break;case 2:q$a=Collision.intersectsPlaneAndPoint(this._left,q$S);break;case 3:q$a=Collision.intersectsPlaneAndPoint(this._right,q$S);break;case 4:q$a=Collision.intersectsPlaneAndPoint(this._top,q$S);break;case 5:q$a=Collision.intersectsPlaneAndPoint(this._bottom,q$S)}switch(q$a){case q$__.PlaneIntersectionType_Back:return 0;case q$__.PlaneIntersectionType_Intersecting:q$_=q$__.PlaneIntersectionType_Intersecting}}switch(q$_){case q$__.PlaneIntersectionType_Intersecting:return 2;default:return 1}},q$S.containsBoundBox=function(q$S){for(var q$_,q$a=q$b._tempV30,q$R=q$b._tempV31,q$J=1,q$V=0;q$V<6;q$V++){if(q$_=this.getPlane(q$V),this._getBoxToPlanePVertexNVertex(q$S,q$_.normal,q$a,q$R),Collision.intersectsPlaneAndPoint(q$_,q$a)===q$__.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(q$_,q$R)===q$__.PlaneIntersectionType_Back&&(q$J=2)}return q$J},q$S.containsBoundSphere=function(q$S){for(var q$_=q$__.PlaneIntersectionType_Front,q$a=q$__.PlaneIntersectionType_Front,q$R=0;q$R<6;q$R++){switch(q$R){case 0:q$a=Collision.intersectsPlaneAndSphere(this._near,q$S);break;case 1:q$a=Collision.intersectsPlaneAndSphere(this._far,q$S);break;case 2:q$a=Collision.intersectsPlaneAndSphere(this._left,q$S);break;case 3:q$a=Collision.intersectsPlaneAndSphere(this._right,q$S);break;case 4:q$a=Collision.intersectsPlaneAndSphere(this._top,q$S);break;case 5:q$a=Collision.intersectsPlaneAndSphere(this._bottom,q$S)}switch(q$a){case q$__.PlaneIntersectionType_Back:return 0;case q$__.PlaneIntersectionType_Intersecting:q$_=q$__.PlaneIntersectionType_Intersecting}}switch(q$_){case q$__.PlaneIntersectionType_Intersecting:return 2;default:return 1}},q$S._getBoxToPlanePVertexNVertex=function(q$S,q$_,q$a,q$R){var q$J=q$S.min,q$V=q$J.elements,q$W=q$S.max,q$k=q$W.elements,q$z=q$_.elements,q$b=q$z[0],q$H=q$z[1],q$L=q$z[2];q$J.cloneTo(q$a);var q$C=q$a.elements;0<=q$b&&(q$C[0]=q$k[0]),0<=q$H&&(q$C[1]=q$k[1]),0<=q$L&&(q$C[2]=q$k[2]),q$W.cloneTo(q$R);var q$G=q$R.elements;0<=q$b&&(q$G[0]=q$V[0]),0<=q$H&&(q$G[1]=q$V[1]),0<=q$L&&(q$G[2]=q$V[2])},q$t(0,q$S,"top",function(){return this._top}),q$t(0,q$S,"matrix",function(){return this._matrix},function(q$S){this._matrix=q$S,q$b._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),q$t(0,q$S,"near",function(){return this._near}),q$t(0,q$S,"far",function(){return this._far}),q$t(0,q$S,"left",function(){return this._left}),q$t(0,q$S,"right",function(){return this._right}),q$t(0,q$S,"bottom",function(){return this._bottom}),q$b._getPlanesFromMatrix=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){var q$k=q$S.elements,q$z=q$k[0],q$b=q$k[1],q$H=q$k[2],q$L=q$k[3],q$C=q$k[4],q$G=q$k[5],q$t=q$k[6],q$o=q$k[7],q$$=q$k[8],q$F=q$k[9],q$T=q$k[10],q$D=q$k[11],q$j=q$k[12],q$Q=q$k[13],q$m=q$k[14],q$q=q$k[15],q$N=q$_.normal.elements;q$N[0]=q$L+q$H,q$N[1]=q$o+q$t,q$N[2]=q$D+q$T,q$_.distance=q$q+q$m,q$_.normalize();var q$n=q$a.normal.elements;q$n[0]=q$L-q$H,q$n[1]=q$o-q$t,q$n[2]=q$D-q$T,q$a.distance=q$q-q$m,q$a.normalize();var q$l=q$R.normal.elements;q$l[0]=q$L+q$z,q$l[1]=q$o+q$C,q$l[2]=q$D+q$$,q$R.distance=q$q+q$j,q$R.normalize();var q$B=q$J.normal.elements;q$B[0]=q$L-q$z,q$B[1]=q$o-q$C,q$B[2]=q$D-q$$,q$J.distance=q$q-q$j,q$J.normalize();var q$I=q$V.normal.elements;q$I[0]=q$L-q$b,q$I[1]=q$o-q$G,q$I[2]=q$D-q$F,q$V.distance=q$q-q$Q,q$V.normalize();var q$A=q$W.normal.elements;q$A[0]=q$L+q$b,q$A[1]=q$o+q$G,q$A[2]=q$D+q$F,q$W.distance=q$q+q$Q,q$W.normalize()},q$b._get3PlaneInterPoint=function(q$S,q$_,q$a){var q$R=q$S.normal,q$J=q$_.normal,q$V=q$a.normal;q$W_.cross(q$J,q$V,q$b._tempV30),q$W_.cross(q$V,q$R,q$b._tempV31),q$W_.cross(q$R,q$J,q$b._tempV32);var q$W=q$W_.dot(q$R,q$b._tempV30),q$k=q$W_.dot(q$J,q$b._tempV31),q$z=q$W_.dot(q$V,q$b._tempV32);return q$W_.scale(q$b._tempV30,-q$S.distance/q$W,q$b._tempV33),q$W_.scale(q$b._tempV31,-q$_.distance/q$k,q$b._tempV34),q$W_.scale(q$b._tempV32,-q$a.distance/q$z,q$b._tempV35),q$W_.add(q$b._tempV33,q$b._tempV34,q$b._tempV36),q$W_.add(q$b._tempV35,q$b._tempV36,q$b._tempV37),q$b._tempV37},q$L(q$b,["_tempV30",function(){return this._tempV30=new q$W_},"_tempV31",function(){return this._tempV31=new q$W_},"_tempV32",function(){return this._tempV32=new q$W_},"_tempV33",function(){return this._tempV33=new q$W_},"_tempV34",function(){return this._tempV34=new q$W_},"_tempV35",function(){return this._tempV35=new q$W_},"_tempV36",function(){return this._tempV36=new q$W_},"_tempV37",function(){return this._tempV37=new q$W_}]),q$b}(),q$wS=function(){function q$H(q$S,q$_){this.center=null,this.radius=NaN,this.center=q$S,this.radius=q$_}q$G(q$H,"laya.d3.math.BoundSphere");var q$S=q$H.prototype;return q$Q.imps(q$S,{"laya.d3.core.IClone":!0}),q$S.toDefault=function(){this.center.toDefault(),this.radius=0},q$S.intersectsRayDistance=function(q$S){return Collision.intersectsRayAndSphereRD(q$S,this)},q$S.intersectsRayPoint=function(q$S,q$_){return Collision.intersectsRayAndSphereRP(q$S,this,q$_)},q$S.cloneTo=function(q$S){var q$_=q$S;this.center.cloneTo(q$_.center),q$_.radius=this.radius},q$S.clone=function(){var q$S=new this.constructor(new q$W_,new q$W_);return this.cloneTo(q$S),q$S},q$H.createFromSubPoints=function(q$S,q$_,q$a,q$R){if(null==q$S)throw new Error("points");if(q$_<0||q$_>=q$S.length)throw new Error("start"+q$_+"Must be in the range [0, "+(q$S.length-1)+"]");if(q$a<0||q$_+q$a>q$S.length)throw new Error("count"+q$a+"Must be in the range <= "+q$S.length+"}");var q$J=q$_+q$a,q$V=q$H._tempVector3;q$V.elements[0]=0,q$V.elements[1]=0,q$V.elements[2]=0;for(var q$W=q$_;q$W<q$J;++q$W)q$W_.add(q$S[q$W],q$V,q$V);var q$k=q$R.center;q$W_.scale(q$V,1/q$a,q$k);var q$z=0;for(q$W=q$_;q$W<q$J;++q$W){var q$b=q$W_.distanceSquared(q$k,q$S[q$W]);q$z<q$b&&(q$z=q$b)}q$R.radius=Math.sqrt(q$z)},q$H.createfromPoints=function(q$S,q$_){if(null==q$S)throw new Error("points");q$H.createFromSubPoints(q$S,0,q$S.length,q$_)},q$L(q$H,["_tempVector3",function(){return this._tempVector3=new q$W_}]),q$H}(),q$vS=(function(){function q$S(){}q$G(q$S,"laya.d3.math.ContainmentType"),q$S.Disjoint=0,q$S.Contains=1,q$S.Intersects=2}(),function(){function q$a(){}return q$G(q$a,"laya.d3.math.MathUtils3D"),q$a.isZero=function(q$S){return Math.abs(q$S)<q$a.zeroTolerance},q$a.nearEqual=function(q$S,q$_){return!!q$a.isZero(q$S-q$_)},q$a.fastInvSqrt=function(q$S){return q$a.isZero(q$S)?q$S:1/Math.sqrt(q$S)},q$L(q$a,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),q$a}()),q$dS=function(){function q$z(){var q$S=this.elements=new Float32Array(9);q$S[0]=1,q$S[1]=0,q$S[2]=0,q$S[3]=0,q$S[4]=1,q$S[5]=0,q$S[6]=0,q$S[7]=0,q$S[8]=1}q$G(q$z,"laya.d3.math.Matrix3x3");var q$S=q$z.prototype;return q$Q.imps(q$S,{"laya.d3.core.IClone":!0}),q$S.determinant=function(){var q$S=this.elements,q$_=q$S[0],q$a=q$S[1],q$R=q$S[2],q$J=q$S[3],q$V=q$S[4],q$W=q$S[5],q$k=q$S[6],q$z=q$S[7],q$b=q$S[8];return q$_*(q$b*q$V-q$W*q$z)+q$a*(-q$b*q$J+q$W*q$k)+q$R*(q$z*q$J-q$V*q$k)},q$S.translate=function(q$S,q$_){var q$a=q$_.elements,q$R=this.elements,q$J=q$S.elements,q$V=q$R[0],q$W=q$R[1],q$k=q$R[2],q$z=q$R[3],q$b=q$R[4],q$H=q$R[5],q$L=q$R[6],q$C=q$R[7],q$G=q$R[8],q$t=q$J[0],q$o=q$J[1];q$a[0]=q$V,q$a[1]=q$W,q$a[2]=q$k,q$a[3]=q$z,q$a[4]=q$b,q$a[5]=q$H,q$a[6]=q$t*q$V+q$o*q$z+q$L,q$a[7]=q$t*q$W+q$o*q$b+q$C,q$a[8]=q$t*q$k+q$o*q$H+q$G},q$S.rotate=function(q$S,q$_){var q$a=q$_.elements,q$R=this.elements,q$J=q$R[0],q$V=q$R[1],q$W=q$R[2],q$k=q$R[3],q$z=q$R[4],q$b=q$R[5],q$H=q$R[6],q$L=q$R[7],q$C=q$R[8],q$G=Math.sin(q$S),q$t=Math.cos(q$S);q$a[0]=q$t*q$J+q$G*q$k,q$a[1]=q$t*q$V+q$G*q$z,q$a[2]=q$t*q$W+q$G*q$b,q$a[3]=q$t*q$k-q$G*q$J,q$a[4]=q$t*q$z-q$G*q$V,q$a[5]=q$t*q$b-q$G*q$W,q$a[6]=q$H,q$a[7]=q$L,q$a[8]=q$C},q$S.scale=function(q$S,q$_){var q$a=q$_.elements,q$R=this.elements,q$J=q$S.elements,q$V=q$J[0],q$W=q$J[1];q$a[0]=q$V*q$R[0],q$a[1]=q$V*q$R[1],q$a[2]=q$V*q$R[2],q$a[3]=q$W*q$R[3],q$a[4]=q$W*q$R[4],q$a[5]=q$W*q$R[5],q$a[6]=q$R[6],q$a[7]=q$R[7],q$a[8]=q$R[8]},q$S.invert=function(q$S){var q$_=q$S.elements,q$a=this.elements,q$R=q$a[0],q$J=q$a[1],q$V=q$a[2],q$W=q$a[3],q$k=q$a[4],q$z=q$a[5],q$b=q$a[6],q$H=q$a[7],q$L=q$a[8],q$C=q$L*q$k-q$z*q$H,q$G=-q$L*q$W+q$z*q$b,q$t=q$H*q$W-q$k*q$b,q$o=q$R*q$C+q$J*q$G+q$V*q$t;q$o||(q$S=null),q$o=1/q$o,q$_[0]=q$C*q$o,q$_[1]=(-q$L*q$J+q$V*q$H)*q$o,q$_[2]=(q$z*q$J-q$V*q$k)*q$o,q$_[3]=q$G*q$o,q$_[4]=(q$L*q$R-q$V*q$b)*q$o,q$_[5]=(-q$z*q$R+q$V*q$W)*q$o,q$_[6]=q$t*q$o,q$_[7]=(-q$H*q$R+q$J*q$b)*q$o,q$_[8]=(q$k*q$R-q$J*q$W)*q$o},q$S.transpose=function(q$S){var q$_=q$S.elements,q$a=this.elements;if(q$S===this){var q$R=q$a[1],q$J=q$a[2],q$V=q$a[5];q$_[1]=q$a[3],q$_[2]=q$a[6],q$_[3]=q$R,q$_[5]=q$a[7],q$_[6]=q$J,q$_[7]=q$V}else q$_[0]=q$a[0],q$_[1]=q$a[3],q$_[2]=q$a[6],q$_[3]=q$a[1],q$_[4]=q$a[4],q$_[5]=q$a[7],q$_[6]=q$a[2],q$_[7]=q$a[5],q$_[8]=q$a[8]},q$S.identity=function(){var q$S=this.elements;q$S[0]=1,q$S[1]=0,q$S[2]=0,q$S[3]=0,q$S[4]=1,q$S[5]=0,q$S[6]=0,q$S[7]=0,q$S[8]=1},q$S.cloneTo=function(q$S){var q$_,q$a,q$R;if((q$a=this.elements)!==(q$R=q$S.elements))for(q$_=0;q$_<9;++q$_)q$R[q$_]=q$a[q$_]},q$S.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$z.createFromTranslation=function(q$S,q$_){q$_.elements;var q$a=q$S.elements;q$_[0]=1,q$_[1]=0,q$_[2]=0,q$_[3]=0,q$_[4]=1,q$_[5]=0,q$_[6]=q$a[0],q$_[7]=q$a[1],q$_[8]=1},q$z.createFromRotation=function(q$S,q$_){var q$a=q$_.elements,q$R=Math.sin(q$S),q$J=Math.cos(q$S);q$a[0]=q$J,q$a[1]=q$R,q$a[2]=0,q$a[3]=-q$R,q$a[4]=q$J,q$a[5]=0,q$a[6]=0,q$a[7]=0,q$a[8]=1},q$z.createFromScaling=function(q$S,q$_){var q$a=q$_.elements,q$R=q$S.elements;q$a[0]=q$R[0],q$a[1]=0,q$a[2]=0,q$a[3]=0,q$a[4]=q$R[1],q$a[5]=0,q$a[6]=0,q$a[7]=0,q$a[8]=1},q$z.createFromMatrix4x4=function(q$S,q$_){q$_[0]=q$S[0],q$_[1]=q$S[1],q$_[2]=q$S[2],q$_[3]=q$S[4],q$_[4]=q$S[5],q$_[5]=q$S[6],q$_[6]=q$S[8],q$_[7]=q$S[9],q$_[8]=q$S[10]},q$z.multiply=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements,q$W=q$J[0],q$k=q$J[1],q$z=q$J[2],q$b=q$J[3],q$H=q$J[4],q$L=q$J[5],q$C=q$J[6],q$G=q$J[7],q$t=q$J[8],q$o=q$V[0],q$$=q$V[1],q$F=q$V[2],q$T=q$V[3],q$D=q$V[4],q$j=q$V[5],q$Q=q$V[6],q$m=q$V[7],q$q=q$V[8];q$R[0]=q$o*q$W+q$$*q$b+q$F*q$C,q$R[1]=q$o*q$k+q$$*q$H+q$F*q$G,q$R[2]=q$o*q$z+q$$*q$L+q$F*q$t,q$R[3]=q$T*q$W+q$D*q$b+q$j*q$C,q$R[4]=q$T*q$k+q$D*q$H+q$j*q$G,q$R[5]=q$T*q$z+q$D*q$L+q$j*q$t,q$R[6]=q$Q*q$W+q$m*q$b+q$q*q$C,q$R[7]=q$Q*q$k+q$m*q$H+q$q*q$G,q$R[8]=q$Q*q$z+q$m*q$L+q$q*q$t},q$z.lookAt=function(q$S,q$_,q$a,q$R){q$W_.subtract(q$S,q$_,q$z._tempV30),q$W_.normalize(q$z._tempV30,q$z._tempV30),q$W_.cross(q$a,q$z._tempV30,q$z._tempV31),q$W_.normalize(q$z._tempV31,q$z._tempV31),q$W_.cross(q$z._tempV30,q$z._tempV31,q$z._tempV32);var q$J=q$z._tempV30.elements,q$V=q$z._tempV31.elements,q$W=q$z._tempV32.elements,q$k=q$R.elements;q$k[0]=q$V[0],q$k[3]=q$V[1],q$k[6]=q$V[2],q$k[1]=q$W[0],q$k[4]=q$W[1],q$k[7]=q$W[2],q$k[2]=q$J[0],q$k[5]=q$J[1],q$k[8]=q$J[2]},q$z.DEFAULT=new q$z,q$L(q$z,["_tempV30",function(){return this._tempV30=new q$W_},"_tempV31",function(){return this._tempV31=new q$W_},"_tempV32",function(){return this._tempV32=new q$W_}]),q$z}(),q$S_=function(){function q$n(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$L,q$C,q$G,q$t,q$o){void 0===q$S&&(q$S=1),void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=0),void 0===q$J&&(q$J=0),void 0===q$V&&(q$V=1),void 0===q$W&&(q$W=0),void 0===q$k&&(q$k=0),void 0===q$z&&(q$z=0),void 0===q$b&&(q$b=0),void 0===q$H&&(q$H=1),void 0===q$L&&(q$L=0),void 0===q$C&&(q$C=0),void 0===q$G&&(q$G=0),void 0===q$t&&(q$t=0),void 0===q$o&&(q$o=1);var q$$=this.elements=new Float32Array(16);q$$[0]=q$S,q$$[1]=q$_,q$$[2]=q$a,q$$[3]=q$R,q$$[4]=q$J,q$$[5]=q$V,q$$[6]=q$W,q$$[7]=q$k,q$$[8]=q$z,q$$[9]=q$b,q$$[10]=q$H,q$$[11]=q$L,q$$[12]=q$C,q$$[13]=q$G,q$$[14]=q$t,q$$[15]=q$o}q$G(q$n,"laya.d3.math.Matrix4x4");var q$S=q$n.prototype;return q$Q.imps(q$S,{"laya.d3.core.IClone":!0}),q$S.getElementByRowColumn=function(q$S,q$_){if(q$S<0||3<q$S)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(q$_<0||3<q$_)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*q$S+q$_]},q$S.setElementByRowColumn=function(q$S,q$_,q$a){if(q$S<0||3<q$S)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(q$_<0||3<q$_)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*q$S+q$_]=q$a},q$S.equalsOtherMatrix=function(q$S){var q$_=this.elements,q$a=q$S.elements;return q$vS.nearEqual(q$_[0],q$a[0])&&q$vS.nearEqual(q$_[1],q$a[1])&&q$vS.nearEqual(q$_[2],q$a[2])&&q$vS.nearEqual(q$_[3],q$a[3])&&q$vS.nearEqual(q$_[4],q$a[4])&&q$vS.nearEqual(q$_[5],q$a[5])&&q$vS.nearEqual(q$_[6],q$a[6])&&q$vS.nearEqual(q$_[7],q$a[7])&&q$vS.nearEqual(q$_[8],q$a[8])&&q$vS.nearEqual(q$_[9],q$a[9])&&q$vS.nearEqual(q$_[10],q$a[10])&&q$vS.nearEqual(q$_[11],q$a[11])&&q$vS.nearEqual(q$_[12],q$a[12])&&q$vS.nearEqual(q$_[13],q$a[13])&&q$vS.nearEqual(q$_[14],q$a[14])&&q$vS.nearEqual(q$_[15],q$a[15])},q$S.decomposeTransRotScale=function(q$S,q$_,q$a){var q$R=q$n._tempMatrix4x4;return this.decomposeTransRotMatScale(q$S,q$R,q$a)?(q$a_.createFromMatrix4x4(q$R,q$_),!0):(q$_.identity(),!1)},q$S.decomposeTransRotMatScale=function(q$S,q$_,q$a){var q$R=this.elements,q$J=q$S.elements,q$V=q$_.elements,q$W=q$a.elements;q$J[0]=q$R[12],q$J[1]=q$R[13],q$J[2]=q$R[14];var q$k=q$R[0],q$z=q$R[1],q$b=q$R[2],q$H=q$R[4],q$L=q$R[5],q$C=q$R[6],q$G=q$R[8],q$t=q$R[9],q$o=q$R[10],q$$=q$W[0]=Math.sqrt(q$k*q$k+q$z*q$z+q$b*q$b),q$F=q$W[1]=Math.sqrt(q$H*q$H+q$L*q$L+q$C*q$C),q$T=q$W[2]=Math.sqrt(q$G*q$G+q$t*q$t+q$o*q$o);if(q$vS.isZero(q$$)||q$vS.isZero(q$F)||q$vS.isZero(q$T))return q$V[1]=q$V[2]=q$V[3]=q$V[4]=q$V[6]=q$V[7]=q$V[8]=q$V[9]=q$V[11]=q$V[12]=q$V[13]=q$V[14]=0,q$V[0]=q$V[5]=q$V[10]=q$V[15]=1,!1;var q$D=q$n._tempVector0,q$j=q$D.elements;q$j[0]=q$G/q$T,q$j[1]=q$t/q$T,q$j[2]=q$o/q$T;var q$Q=q$n._tempVector1,q$m=q$Q.elements;q$m[0]=q$k/q$$,q$m[1]=q$z/q$$,q$m[2]=q$b/q$$;var q$q=q$n._tempVector2;q$W_.cross(q$D,q$Q,q$q);var q$N=q$n._tempVector1;return q$W_.cross(q$q,q$D,q$N),q$V[3]=q$V[7]=q$V[11]=q$V[12]=q$V[13]=q$V[14]=0,q$V[15]=1,q$V[0]=q$N.x,q$V[1]=q$N.y,q$V[2]=q$N.z,q$V[4]=q$q.x,q$V[5]=q$q.y,q$V[6]=q$q.z,q$V[8]=q$D.x,q$V[9]=q$D.y,q$V[10]=q$D.z,q$V[0]*q$k+q$V[1]*q$z+q$V[2]*q$b<0&&(q$W[0]=-q$$),q$V[4]*q$H+q$V[5]*q$L+q$V[6]*q$C<0&&(q$W[1]=-q$F),q$V[8]*q$G+q$V[9]*q$t+q$V[10]*q$o<0&&(q$W[2]=-q$T),!0},q$S.decomposeYawPitchRoll=function(q$S){var q$_=q$S.elements,q$a=Math.asin(-this.elements[9]);q$_[1]=q$a,Math.cos(q$a)>q$vS.zeroTolerance?(q$_[2]=Math.atan2(this.elements[1],this.elements[5]),q$_[0]=Math.atan2(this.elements[8],this.elements[10])):(q$_[2]=Math.atan2(-this.elements[4],this.elements[0]),q$_[0]=0)},q$S.normalize=function(){var q$S=this.elements,q$_=q$S[0],q$a=q$S[1],q$R=q$S[2],q$J=Math.sqrt(q$_*q$_+q$a*q$a+q$R*q$R);if(!q$J)return q$S[0]=0,q$S[1]=0,void(q$S[2]=0);1!=q$J&&(q$J=1/q$J,q$S[0]=q$_*q$J,q$S[1]=q$a*q$J,q$S[2]=q$R*q$J)},q$S.transpose=function(){var q$S,q$_;return q$_=(q$S=this.elements)[1],q$S[1]=q$S[4],q$S[4]=q$_,q$_=q$S[2],q$S[2]=q$S[8],q$S[8]=q$_,q$_=q$S[3],q$S[3]=q$S[12],q$S[12]=q$_,q$_=q$S[6],q$S[6]=q$S[9],q$S[9]=q$_,q$_=q$S[7],q$S[7]=q$S[13],q$S[13]=q$_,q$_=q$S[11],q$S[11]=q$S[14],q$S[14]=q$_,this},q$S.invert=function(q$S){var q$_=this.elements,q$a=q$S.elements,q$R=q$_[0],q$J=q$_[1],q$V=q$_[2],q$W=q$_[3],q$k=q$_[4],q$z=q$_[5],q$b=q$_[6],q$H=q$_[7],q$L=q$_[8],q$C=q$_[9],q$G=q$_[10],q$t=q$_[11],q$o=q$_[12],q$$=q$_[13],q$F=q$_[14],q$T=q$_[15],q$D=q$R*q$z-q$J*q$k,q$j=q$R*q$b-q$V*q$k,q$Q=q$R*q$H-q$W*q$k,q$m=q$J*q$b-q$V*q$z,q$q=q$J*q$H-q$W*q$z,q$N=q$V*q$H-q$W*q$b,q$n=q$L*q$$-q$C*q$o,q$l=q$L*q$F-q$G*q$o,q$B=q$L*q$T-q$t*q$o,q$I=q$C*q$F-q$G*q$$,q$A=q$C*q$T-q$t*q$$,q$X=q$G*q$T-q$t*q$F,q$h=q$D*q$X-q$j*q$A+q$Q*q$I+q$m*q$B-q$q*q$l+q$N*q$n;0!==Math.abs(q$h)&&(q$h=1/q$h,q$a[0]=(q$z*q$X-q$b*q$A+q$H*q$I)*q$h,q$a[1]=(q$V*q$A-q$J*q$X-q$W*q$I)*q$h,q$a[2]=(q$$*q$N-q$F*q$q+q$T*q$m)*q$h,q$a[3]=(q$G*q$q-q$C*q$N-q$t*q$m)*q$h,q$a[4]=(q$b*q$B-q$k*q$X-q$H*q$l)*q$h,q$a[5]=(q$R*q$X-q$V*q$B+q$W*q$l)*q$h,q$a[6]=(q$F*q$Q-q$o*q$N-q$T*q$j)*q$h,q$a[7]=(q$L*q$N-q$G*q$Q+q$t*q$j)*q$h,q$a[8]=(q$k*q$A-q$z*q$B+q$H*q$n)*q$h,q$a[9]=(q$J*q$B-q$R*q$A-q$W*q$n)*q$h,q$a[10]=(q$o*q$q-q$$*q$Q+q$T*q$D)*q$h,q$a[11]=(q$C*q$Q-q$L*q$q-q$t*q$D)*q$h,q$a[12]=(q$z*q$l-q$k*q$I-q$b*q$n)*q$h,q$a[13]=(q$R*q$I-q$J*q$l+q$V*q$n)*q$h,q$a[14]=(q$$*q$j-q$o*q$m-q$F*q$D)*q$h,q$a[15]=(q$L*q$m-q$C*q$j+q$G*q$D)*q$h)},q$S.identity=function(){var q$S=this.elements;q$S[1]=q$S[2]=q$S[3]=q$S[4]=q$S[6]=q$S[7]=q$S[8]=q$S[9]=q$S[11]=q$S[12]=q$S[13]=q$S[14]=0,q$S[0]=q$S[5]=q$S[10]=q$S[15]=1},q$S.cloneTo=function(q$S){var q$_,q$a,q$R;if((q$a=this.elements)!==(q$R=q$S.elements))for(q$_=0;q$_<16;++q$_)q$R[q$_]=q$a[q$_]},q$S.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$S.getTranslationVector=function(q$S){var q$_=this.elements,q$a=q$S.elements;q$a[0]=q$_[12],q$a[1]=q$_[13],q$a[2]=q$_[14]},q$S.setTranslationVector=function(q$S){var q$_=this.elements,q$a=q$S.elements;q$_[12]=q$a[0],q$_[13]=q$a[1],q$_[14]=q$a[2]},q$S.getForward=function(q$S){var q$_=this.elements,q$a=q$S.elements;q$a[0]=-q$_[8],q$a[1]=-q$_[9],q$a[2]=-q$_[10]},q$S.setForward=function(q$S){var q$_=this.elements,q$a=q$S.elements;q$_[8]=-q$a[0],q$_[9]=-q$a[1],q$_[10]=-q$a[2]},q$n.createRotationX=function(q$S,q$_){var q$a=q$_.elements,q$R=Math.sin(q$S),q$J=Math.cos(q$S);q$a[1]=q$a[2]=q$a[3]=q$a[4]=q$a[7]=q$a[8]=q$a[11]=q$a[12]=q$a[13]=q$a[14]=0,q$a[0]=q$a[15]=1,q$a[5]=q$a[10]=q$J,q$a[6]=q$R,q$a[9]=-q$R},q$n.createRotationY=function(q$S,q$_){var q$a=q$_.elements,q$R=Math.sin(q$S),q$J=Math.cos(q$S);q$a[1]=q$a[3]=q$a[4]=q$a[6]=q$a[7]=q$a[9]=q$a[11]=q$a[12]=q$a[13]=q$a[14]=0,q$a[5]=q$a[15]=1,q$a[0]=q$a[10]=q$J,q$a[2]=-q$R,q$a[8]=q$R},q$n.createRotationZ=function(q$S,q$_){var q$a=q$_.elements,q$R=Math.sin(q$S),q$J=Math.cos(q$S);q$a[2]=q$a[3]=q$a[6]=q$a[7]=q$a[8]=q$a[9]=q$a[11]=q$a[12]=q$a[13]=q$a[14]=0,q$a[10]=q$a[15]=1,q$a[0]=q$a[5]=q$J,q$a[1]=q$R,q$a[4]=-q$R},q$n.createRotationYawPitchRoll=function(q$S,q$_,q$a,q$R){q$a_.createFromYawPitchRoll(q$S,q$_,q$a,q$n._tempQuaternion),q$n.createRotationQuaternion(q$n._tempQuaternion,q$R)},q$n.createRotationAxis=function(q$S,q$_,q$a){var q$R=q$S.elements,q$J=q$R[0],q$V=q$R[1],q$W=q$R[2],q$k=Math.cos(q$_),q$z=Math.sin(q$_),q$b=q$J*q$J,q$H=q$V*q$V,q$L=q$W*q$W,q$C=q$J*q$V,q$G=q$J*q$W,q$t=q$V*q$W,q$o=q$a.elements;q$o[3]=q$o[7]=q$o[11]=q$o[12]=q$o[13]=q$o[14]=0,q$o[15]=1,q$o[0]=q$b+q$k*(1-q$b),q$o[1]=q$C-q$k*q$C+q$z*q$W,q$o[2]=q$G-q$k*q$G-q$z*q$V,q$o[4]=q$C-q$k*q$C-q$z*q$W,q$o[5]=q$H+q$k*(1-q$H),q$o[6]=q$t-q$k*q$t+q$z*q$J,q$o[8]=q$G-q$k*q$G+q$z*q$V,q$o[9]=q$t-q$k*q$t-q$z*q$J,q$o[10]=q$L+q$k*(1-q$L)},q$n.createRotationQuaternion=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements,q$J=q$a[0],q$V=q$a[1],q$W=q$a[2],q$k=q$a[3],q$z=q$J*q$J,q$b=q$V*q$V,q$H=q$W*q$W,q$L=q$J*q$V,q$C=q$W*q$k,q$G=q$W*q$J,q$t=q$V*q$k,q$o=q$V*q$W,q$$=q$J*q$k;q$R[3]=q$R[7]=q$R[11]=q$R[12]=q$R[13]=q$R[14]=0,q$R[15]=1,q$R[0]=1-2*(q$b+q$H),q$R[1]=2*(q$L+q$C),q$R[2]=2*(q$G-q$t),q$R[4]=2*(q$L-q$C),q$R[5]=1-2*(q$H+q$z),q$R[6]=2*(q$o+q$$),q$R[8]=2*(q$G+q$t),q$R[9]=2*(q$o-q$$),q$R[10]=1-2*(q$b+q$z)},q$n.createTranslate=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements;q$R[4]=q$R[8]=q$R[1]=q$R[9]=q$R[2]=q$R[6]=q$R[3]=q$R[7]=q$R[11]=0,q$R[0]=q$R[5]=q$R[10]=q$R[15]=1,q$R[12]=q$a[0],q$R[13]=q$a[1],q$R[14]=q$a[2]},q$n.createScaling=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements;q$R[0]=q$a[0],q$R[5]=q$a[1],q$R[10]=q$a[2],q$R[1]=q$R[4]=q$R[8]=q$R[12]=q$R[9]=q$R[13]=q$R[2]=q$R[6]=q$R[14]=q$R[3]=q$R[7]=q$R[11]=0,q$R[15]=1},q$n.multiply=function(q$S,q$_,q$a){var q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H;for(q$J=q$a.elements,q$V=q$S.elements,q$J===(q$W=q$_.elements)&&(q$W=q$W.slice()),q$R=0;q$R<4;q$R++)q$k=q$V[q$R],q$z=q$V[q$R+4],q$b=q$V[q$R+8],q$H=q$V[q$R+12],q$J[q$R]=q$k*q$W[0]+q$z*q$W[1]+q$b*q$W[2]+q$H*q$W[3],q$J[q$R+4]=q$k*q$W[4]+q$z*q$W[5]+q$b*q$W[6]+q$H*q$W[7],q$J[q$R+8]=q$k*q$W[8]+q$z*q$W[9]+q$b*q$W[10]+q$H*q$W[11],q$J[q$R+12]=q$k*q$W[12]+q$z*q$W[13]+q$b*q$W[14]+q$H*q$W[15]},q$n.createFromQuaternion=function(q$S,q$_){var q$a=q$_.elements,q$R=q$S.elements,q$J=q$R[0],q$V=q$R[1],q$W=q$R[2],q$k=q$R[3],q$z=q$J+q$J,q$b=q$V+q$V,q$H=q$W+q$W,q$L=q$J*q$z,q$C=q$V*q$z,q$G=q$V*q$b,q$t=q$W*q$z,q$o=q$W*q$b,q$$=q$W*q$H,q$F=q$k*q$z,q$T=q$k*q$b,q$D=q$k*q$H;q$a[0]=1-q$G-q$$,q$a[1]=q$C+q$D,q$a[2]=q$t-q$T,q$a[3]=0,q$a[4]=q$C-q$D,q$a[5]=1-q$L-q$$,q$a[6]=q$o+q$F,q$a[7]=0,q$a[8]=q$t+q$T,q$a[9]=q$o-q$F,q$a[10]=1-q$L-q$G,q$a[11]=0,q$a[12]=0,q$a[13]=0,q$a[14]=0,q$a[15]=1},q$n.createAffineTransformation=function(q$S,q$_,q$a,q$R){var q$J=q$S.elements,q$V=q$_.elements,q$W=q$a.elements,q$k=q$R.elements,q$z=q$V[0],q$b=q$V[1],q$H=q$V[2],q$L=q$V[3],q$C=q$z+q$z,q$G=q$b+q$b,q$t=q$H+q$H,q$o=q$z*q$C,q$$=q$z*q$G,q$F=q$z*q$t,q$T=q$b*q$G,q$D=q$b*q$t,q$j=q$H*q$t,q$Q=q$L*q$C,q$m=q$L*q$G,q$q=q$L*q$t,q$N=q$W[0],q$n=q$W[1],q$l=q$W[2];q$k[0]=(1-(q$T+q$j))*q$N,q$k[1]=(q$$+q$q)*q$N,q$k[2]=(q$F-q$m)*q$N,q$k[3]=0,q$k[4]=(q$$-q$q)*q$n,q$k[5]=(1-(q$o+q$j))*q$n,q$k[6]=(q$D+q$Q)*q$n,q$k[7]=0,q$k[8]=(q$F+q$m)*q$l,q$k[9]=(q$D-q$Q)*q$l,q$k[10]=(1-(q$o+q$T))*q$l,q$k[11]=0,q$k[12]=q$J[0],q$k[13]=q$J[1],q$k[14]=q$J[2],q$k[15]=1},q$n.createLookAt=function(q$S,q$_,q$a,q$R){var q$J=q$R.elements,q$V=q$n._tempVector0,q$W=q$n._tempVector1,q$k=q$n._tempVector2;q$W_.subtract(q$S,q$_,q$k),q$W_.normalize(q$k,q$k),q$W_.cross(q$a,q$k,q$V),q$W_.normalize(q$V,q$V),q$W_.cross(q$k,q$V,q$W),q$R.identity(),q$J[0]=q$V.x,q$J[4]=q$V.y,q$J[8]=q$V.z,q$J[1]=q$W.x,q$J[5]=q$W.y,q$J[9]=q$W.z,q$J[2]=q$k.x,q$J[6]=q$k.y,q$J[10]=q$k.z,q$J[12]=-q$W_.dot(q$V,q$S),q$J[13]=-q$W_.dot(q$W,q$S),q$J[14]=-q$W_.dot(q$k,q$S)},q$n.createPerspective=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$J.elements,q$W=1/Math.tan(q$S/2),q$k=1/(q$a-q$R);q$V[0]=q$W/q$_,q$V[5]=q$W,q$V[10]=(q$R+q$a)*q$k,q$V[11]=-1,q$V[14]=2*q$R*q$a*q$k,q$V[1]=q$V[2]=q$V[3]=q$V[4]=q$V[6]=q$V[7]=q$V[8]=q$V[9]=q$V[12]=q$V[13]=q$V[15]=0},q$n.createOrthoOffCenterRH=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){var q$k=q$W.elements,q$z=1/(q$S-q$_),q$b=1/(q$a-q$R),q$H=1/(q$J-q$V);q$k[1]=q$k[2]=q$k[3]=q$k[4]=q$k[6]=q$k[7]=q$k[8]=q$k[9]=q$k[11]=0,q$k[15]=1,q$k[0]=-2*q$z,q$k[5]=-2*q$b,q$k[10]=2*q$H,q$k[12]=(q$S+q$_)*q$z,q$k[13]=(q$R+q$a)*q$b,q$k[14]=(q$V+q$J)*q$H},q$n.translation=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements;q$R[0]=q$R[5]=q$R[10]=q$R[15]=1,q$R[12]=q$a[0],q$R[13]=q$a[1],q$R[14]=q$a[2]},q$L(q$n,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new q$n},"_tempVector0",function(){return this._tempVector0=new q$W_},"_tempVector1",function(){return this._tempVector1=new q$W_},"_tempVector2",function(){return this._tempVector2=new q$W_},"_tempQuaternion",function(){return this._tempQuaternion=new q$a_},"DEFAULT",function(){return this.DEFAULT=new q$n},"ZERO",function(){return this.ZERO=new q$n(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),q$n}(),q$__=(function(){function q$D(q$S,q$_){this.extents=null,this.transformation=null,this.extents=q$S,this.transformation=q$_}q$G(q$D,"laya.d3.math.OrientedBoundBox");var q$S=q$D.prototype;q$S.getCorners=function(q$S){var q$_=q$D._tempV30.elements,q$a=q$D._tempV31.elements,q$R=q$D._tempV32.elements,q$J=this.extents.elements;q$_[0]=q$J[0],q$_[1]=q$_[2]=0,q$a[1]=q$J[1],q$a[0]=q$a[2]=0,q$R[2]=q$J[2],q$R[0]=q$R[1]=0,q$W_.TransformNormal(q$D._tempV30,this.transformation,q$D._tempV30),q$W_.TransformNormal(q$D._tempV31,this.transformation,q$D._tempV31),q$W_.TransformNormal(q$D._tempV32,this.transformation,q$D._tempV32);var q$V=q$D._tempV33;this.transformation.getTranslationVector(q$V),q$S.length=8,q$W_.add(q$V,q$D._tempV30,q$D._tempV34),q$W_.add(q$D._tempV34,q$D._tempV31,q$D._tempV34),q$W_.add(q$D._tempV34,q$D._tempV32,q$S[0]),q$W_.add(q$V,q$D._tempV30,q$D._tempV34),q$W_.add(q$D._tempV34,q$D._tempV31,q$D._tempV34),q$W_.subtract(q$D._tempV34,q$D._tempV32,q$S[1]),q$W_.subtract(q$V,q$D._tempV30,q$D._tempV34),q$W_.add(q$D._tempV34,q$D._tempV31,q$D._tempV34),q$W_.subtract(q$D._tempV34,q$D._tempV32,q$S[2]),q$W_.subtract(q$V,q$D._tempV30,q$D._tempV34),q$W_.add(q$D._tempV34,q$D._tempV31,q$D._tempV34),q$W_.add(q$D._tempV34,q$D._tempV32,q$S[3]),q$W_.add(q$V,q$D._tempV30,q$D._tempV34),q$W_.subtract(q$D._tempV34,q$D._tempV31,q$D._tempV34),q$W_.add(q$D._tempV34,q$D._tempV32,q$S[4]),q$W_.add(q$V,q$D._tempV30,q$D._tempV34),q$W_.subtract(q$D._tempV34,q$D._tempV31,q$D._tempV34),q$W_.subtract(q$D._tempV34,q$D._tempV32,q$S[5]),q$W_.subtract(q$V,q$D._tempV30,q$D._tempV34),q$W_.subtract(q$D._tempV34,q$D._tempV31,q$D._tempV34),q$W_.subtract(q$D._tempV34,q$D._tempV32,q$S[6]),q$W_.subtract(q$V,q$D._tempV30,q$D._tempV34),q$W_.subtract(q$D._tempV34,q$D._tempV31,q$D._tempV34),q$W_.add(q$D._tempV34,q$D._tempV32,q$S[7])},q$S.transform=function(q$S){q$S_.multiply(this.transformation,q$S,this.transformation)},q$S.scale=function(q$S){q$W_.multiply(this.extents,q$S,this.extents)},q$S.translate=function(q$S){this.transformation.getTranslationVector(q$D._tempV30),q$W_.add(q$D._tempV30,q$S,q$D._tempV31),this.transformation.setTranslationVector(q$D._tempV31)},q$S.Size=function(q$S){q$W_.scale(this.extents,2,q$S)},q$S.getSize=function(q$S){var q$_=this.extents.elements;q$D._tempV30.x=q$_[0],q$D._tempV31.y=q$_[1],q$D._tempV32.z=q$_[2],q$W_.TransformNormal(q$D._tempV30,this.transformation,q$D._tempV30),q$W_.TransformNormal(q$D._tempV31,this.transformation,q$D._tempV31),q$W_.TransformNormal(q$D._tempV31,this.transformation,q$D._tempV32);var q$a=q$S.elements;q$a[0]=q$W_.scalarLength(q$D._tempV30),q$a[1]=q$W_.scalarLength(q$D._tempV31),q$a[2]=q$W_.scalarLength(q$D._tempV32)},q$S.getSizeSquared=function(q$S){var q$_=this.extents.elements;q$D._tempV30.x=q$_[0],q$D._tempV31.y=q$_[1],q$D._tempV32.z=q$_[2],q$W_.TransformNormal(q$D._tempV30,this.transformation,q$D._tempV30),q$W_.TransformNormal(q$D._tempV31,this.transformation,q$D._tempV31),q$W_.TransformNormal(q$D._tempV31,this.transformation,q$D._tempV32);var q$a=q$S.elements;q$a[0]=q$W_.scalarLengthSquared(q$D._tempV30),q$a[1]=q$W_.scalarLengthSquared(q$D._tempV31),q$a[2]=q$W_.scalarLengthSquared(q$D._tempV32)},q$S.getCenter=function(q$S){this.transformation.getTranslationVector(q$S)},q$S.containsPoint=function(q$S){var q$_=this.extents.elements,q$a=q$_[0],q$R=q$_[1],q$J=q$_[2];this.transformation.invert(q$D._tempM0),q$W_.transformCoordinate(q$S,q$D._tempM0,q$D._tempV30);var q$V=q$D._tempV30.elements,q$W=Math.abs(q$V[0]),q$k=Math.abs(q$V[1]),q$z=Math.abs(q$V[2]);return q$vS.nearEqual(q$W,q$a)&&q$vS.nearEqual(q$k,q$R)&&q$vS.nearEqual(q$z,q$J)?2:q$W<q$a&&q$k<q$R&&q$z<q$J?1:0},q$S.containsPoints=function(q$S){var q$_=this.extents.elements,q$a=q$_[0],q$R=q$_[1],q$J=q$_[2];this.transformation.invert(q$D._tempM0);for(var q$V=!0,q$W=!1,q$k=0;q$k<q$S.length;q$k++){q$W_.transformCoordinate(q$S[q$k],q$D._tempM0,q$D._tempV30);var q$z=q$D._tempV30.elements,q$b=Math.abs(q$z[0]),q$H=Math.abs(q$z[1]),q$L=Math.abs(q$z[2]);q$vS.nearEqual(q$b,q$a)&&q$vS.nearEqual(q$H,q$R)&&q$vS.nearEqual(q$L,q$J)&&(q$W=!0),q$b<q$a&&q$H<q$R&&q$L<q$J?q$W=!0:q$V=!1}return q$V?1:q$W?2:0},q$S.containsSphere=function(q$S,q$_){void 0===q$_&&(q$_=!1);var q$a=this.extents.elements,q$R=q$a[0],q$J=q$a[1],q$V=q$a[2],q$W=q$S.radius;this.transformation.invert(q$D._tempM0),q$W_.transformCoordinate(q$S.center,q$D._tempM0,q$D._tempV30);var q$k=NaN;if(q$k=q$_?q$W:(q$W_.scale(q$W_.UnitX,q$W,q$D._tempV31),q$W_.TransformNormal(q$D._tempV31,q$D._tempM0,q$D._tempV31),q$W_.scalarLength(q$D._tempV31)),q$W_.scale(this.extents,-1,q$D._tempV32),q$W_.Clamp(q$D._tempV30,q$D._tempV32,this.extents,q$D._tempV33),q$k*q$k<q$W_.distanceSquared(q$D._tempV30,q$D._tempV33))return 0;var q$z=q$D._tempV30.elements,q$b=q$z[0],q$H=q$z[1],q$L=q$z[2],q$C=q$D._tempV32.elements,q$G=q$C[0],q$t=q$C[1],q$o=q$C[2];return q$G+q$k<=q$b&&q$b<=q$R-q$k&&q$k<q$R-q$G&&q$t+q$k<=q$H&&q$H<=q$J-q$k&&q$k<q$J-q$t&&q$o+q$k<=q$L&&q$L<=q$V-q$k&&q$k<q$V-q$o?1:2},q$S.containsOrientedBoundBox=function(q$S){var q$_=0,q$a=0;q$S.getCorners(q$D._corners);var q$R=this.containsPoints(q$D._corners);if(0!=q$R)return q$R;var q$J=this.extents.elements;q$S.extents.cloneTo(q$D._tempV35);var q$V=q$D._tempV35.elements;q$D._getRows(this.transformation,q$D._rows1),q$D._getRows(q$S.transformation,q$D._rows2);var q$W=NaN;for(q$_=0;q$_<4;q$_++)for(q$a=0;q$a<4;q$a++)3==q$_||3==q$a?(q$D._tempM0.setElementByRowColumn(q$_,q$a,0),q$D._tempM1.setElementByRowColumn(q$_,q$a,0)):(q$W=q$W_.dot(q$D._rows1[q$_],q$D._rows2[q$a]),q$D._tempM0.setElementByRowColumn(q$_,q$a,q$W),q$D._tempM1.setElementByRowColumn(q$_,q$a,Math.abs(q$W)));q$S.getCenter(q$D._tempV34),this.getCenter(q$D._tempV36),q$W_.subtract(q$D._tempV34,q$D._tempV36,q$D._tempV30);var q$k=q$D._tempV31.elements;q$k[0]=q$W_.dot(q$D._tempV30,q$D._rows1[0]),q$k[1]=q$W_.dot(q$D._tempV30,q$D._rows1[1]),q$k[2]=q$W_.dot(q$D._tempV30,q$D._rows1[2]);var q$z=q$D._tempV32.elements,q$b=q$D._tempV33.elements;for(q$_=0;q$_<3;q$_++)if(q$z[0]=q$D._tempM1.getElementByRowColumn(q$_,0),q$z[1]=q$D._tempM1.getElementByRowColumn(q$_,1),q$z[2]=q$D._tempM1.getElementByRowColumn(q$_,2),q$J[q$_]+q$W_.dot(q$D._tempV35,q$D._tempV32)<Math.abs(q$k[q$_]))return 0;for(q$a=0;q$a<3;q$a++)if(q$z[0]=q$D._tempM1.getElementByRowColumn(0,q$a),q$z[1]=q$D._tempM1.getElementByRowColumn(1,q$a),q$z[2]=q$D._tempM1.getElementByRowColumn(2,q$a),q$b[0]=q$D._tempM0.getElementByRowColumn(0,q$a),q$b[1]=q$D._tempM0.getElementByRowColumn(1,q$a),q$b[2]=q$D._tempM0.getElementByRowColumn(2,q$a),q$W_.dot(this.extents,q$D._tempV32)+q$V[q$a]<Math.abs(q$W_.dot(q$D._tempV31,q$D._tempV33)))return 0;for(q$_=0;q$_<3;q$_++)for(q$a=0;q$a<3;q$a++){var q$H=(q$_+1)%3,q$L=(q$_+2)%3,q$C=(q$a+1)%3,q$G=(q$a+2)%3;if(q$J[q$H]*q$D._tempM1.getElementByRowColumn(q$L,q$a)+q$J[q$L]*q$D._tempM1.getElementByRowColumn(q$H,q$a)+(q$V[q$C]*q$D._tempM1.getElementByRowColumn(q$_,q$G)+q$V[q$G]*q$D._tempM1.getElementByRowColumn(q$_,q$C))<Math.abs(q$k[q$L]*q$D._tempM0.getElementByRowColumn(q$H,q$a)-q$k[q$H]*q$D._tempM0.getElementByRowColumn(q$L,q$a)))return 0}return 2},q$S.containsLine=function(q$S,q$_){q$D._corners[0]=q$S,q$D._corners[1]=q$_;var q$a=this.containsPoints(q$D._corners);if(0!=q$a)return q$a;var q$R=this.extents.elements,q$J=q$R[0],q$V=q$R[1],q$W=q$R[2];this.transformation.invert(q$D._tempM0),q$W_.transformCoordinate(q$S,q$D._tempM0,q$D._tempV30),q$W_.transformCoordinate(q$_,q$D._tempM0,q$D._tempV31),q$W_.add(q$D._tempV30,q$D._tempV31,q$D._tempV32),q$W_.scale(q$D._tempV32,.5,q$D._tempV32),q$W_.subtract(q$D._tempV30,q$D._tempV32,q$D._tempV33);var q$k=q$D._tempV33.elements,q$z=q$k[0],q$b=q$k[1],q$H=q$k[2],q$L=q$D._tempV34.elements,q$C=q$L[0]=Math.abs(q$k[0]),q$G=q$L[1]=Math.abs(q$k[1]),q$t=q$L[2]=Math.abs(q$k[2]),q$o=q$D._tempV32.elements,q$$=q$o[0],q$F=q$o[1],q$T=q$o[2];return Math.abs(q$$)>q$J+q$C?0:Math.abs(q$F)>q$V+q$G?0:Math.abs(q$T)>q$W+q$t?0:Math.abs(q$F*q$H-q$T*q$b)>q$V*q$t+q$W*q$G?0:Math.abs(q$$*q$H-q$T*q$z)>q$J*q$t+q$W*q$C?0:Math.abs(q$$*q$b-q$F*q$z)>q$J*q$G+q$V*q$C?0:2},q$S.containsBoundBox=function(q$S){var q$_=0,q$a=0,q$R=q$S.min,q$J=q$S.max;q$S.getCorners(q$D._corners);var q$V=this.containsPoints(q$D._corners);if(0!=q$V)return q$V;q$W_.subtract(q$J,q$R,q$D._tempV30),q$W_.scale(q$D._tempV30,.5,q$D._tempV30),q$W_.add(q$R,q$D._tempV30,q$D._tempV30),q$W_.subtract(q$J,q$D._tempV30,q$D._tempV31);var q$W=this.extents.elements,q$k=q$D._tempV31.elements;q$D._getRows(this.transformation,q$D._rows1),this.transformation.invert(q$D._tempM0);for(q$_=0;q$_<3;q$_++)for(q$a=0;q$a<3;q$a++)q$D._tempM1.setElementByRowColumn(q$_,q$a,Math.abs(q$D._tempM0.getElementByRowColumn(q$_,q$a)));this.getCenter(q$D._tempV35),q$W_.subtract(q$D._tempV30,q$D._tempV35,q$D._tempV32);var q$z=q$D._tempV31.elements;q$z[0]=q$W_.dot(q$D._tempV32,q$D._rows1[0]),q$z[1]=q$W_.dot(q$D._tempV32,q$D._rows1[1]),q$z[2]=q$W_.dot(q$D._tempV32,q$D._rows1[2]);var q$b=q$D._tempV33.elements,q$H=q$D._tempV34.elements;for(q$_=0;q$_<3;q$_++)if(q$b[0]=q$D._tempM1.getElementByRowColumn(q$_,0),q$b[1]=q$D._tempM1.getElementByRowColumn(q$_,1),q$b[2]=q$D._tempM1.getElementByRowColumn(q$_,2),q$W[q$_]+q$W_.dot(q$D._tempV31,q$D._tempV33)<Math.abs(q$z[q$_]))return 0;for(q$a=0;q$a<3;q$a++)if(q$b[0]=q$D._tempM1.getElementByRowColumn(0,q$a),q$b[1]=q$D._tempM1.getElementByRowColumn(1,q$a),q$b[2]=q$D._tempM1.getElementByRowColumn(2,q$a),q$H[0]=q$D._tempM0.getElementByRowColumn(0,q$a),q$H[1]=q$D._tempM0.getElementByRowColumn(1,q$a),q$H[2]=q$D._tempM0.getElementByRowColumn(2,q$a),q$W_.dot(this.extents,q$D._tempV33)+q$k[q$a]<Math.abs(q$W_.dot(q$D._tempV31,q$D._tempV34)))return 0;for(q$_=0;q$_<3;q$_++)for(q$a=0;q$a<3;q$a++){var q$L=(q$_+1)%3,q$C=(q$_+2)%3,q$G=(q$a+1)%3,q$t=(q$a+2)%3;if(q$W[q$L]*q$D._tempM1.getElementByRowColumn(q$C,q$a)+q$W[q$C]*q$D._tempM1.getElementByRowColumn(q$L,q$a)+(q$k[q$G]*q$D._tempM1.getElementByRowColumn(q$_,q$t)+q$k[q$t]*q$D._tempM1.getElementByRowColumn(q$_,q$G))<Math.abs(q$z[q$C]*q$D._tempM0.getElementByRowColumn(q$L,q$a)-q$z[q$L]*q$D._tempM0.getElementByRowColumn(q$C,q$a)))return 0}return 2},q$S.intersectsRay=function(q$S,q$_){q$W_.scale(this.extents,-1,q$D._tempV30),this.transformation.invert(q$D._tempM0),q$W_.TransformNormal(q$S.direction,q$D._tempM0,q$D._ray.direction),q$W_.transformCoordinate(q$S.origin,q$D._tempM0,q$D._ray.origin),q$D._boxBound1.min=q$D._tempV30,q$D._boxBound1.max=this.extents;var q$a=Collision.intersectsRayAndBoxRP(q$D._ray,q$D._boxBound1,q$_);return-1!==q$a&&q$W_.transformCoordinate(q$_,this.transformation,q$_),q$a},q$S._getLocalCorners=function(q$S){q$S.length=8;var q$_=this.extents.elements;q$D._tempV30.x=q$_[0],q$D._tempV31.y=q$_[1],q$D._tempV32.z=q$_[2],q$W_.add(q$D._tempV30,q$D._tempV31,q$D._tempV33),q$W_.add(q$D._tempV33,q$D._tempV32,q$S[0]),q$W_.add(q$D._tempV30,q$D._tempV31,q$D._tempV33),q$W_.subtract(q$D._tempV33,q$D._tempV32,q$S[1]),q$W_.subtract(q$D._tempV31,q$D._tempV30,q$D._tempV33),q$W_.subtract(q$D._tempV33,q$D._tempV30,q$S[2]),q$W_.subtract(q$D._tempV31,q$D._tempV30,q$D._tempV33),q$W_.add(q$D._tempV33,q$D._tempV32,q$S[3]),q$W_.subtract(q$D._tempV30,q$D._tempV31,q$D._tempV33),q$W_.add(q$D._tempV33,q$D._tempV32,q$S[4]),q$W_.subtract(q$D._tempV30,q$D._tempV31,q$D._tempV33),q$W_.subtract(q$D._tempV33,q$D._tempV32,q$S[5]),q$W_.scale(q$S[0],-1,q$S[6]),q$W_.subtract(q$D._tempV32,q$D._tempV30,q$D._tempV33),q$W_.subtract(q$D._tempV33,q$D._tempV31,q$S[7])},q$S.equals=function(q$S){return this.extents==q$S.extents&&this.transformation==q$S.transformation},q$S.cloneTo=function(q$S){var q$_=q$S;this.extents.cloneTo(q$_.extents),this.transformation.cloneTo(q$_.transformation)},q$D.createByBoundBox=function(q$S,q$_){var q$a=q$S.min,q$R=q$S.max;q$W_.subtract(q$R,q$a,q$D._tempV30),q$W_.scale(q$D._tempV30,.5,q$D._tempV30),q$W_.add(q$a,q$D._tempV30,q$D._tempV31),q$W_.subtract(q$R,q$D._tempV31,q$D._tempV32),q$S_.translation(q$D._tempV31,q$D._tempM0);var q$J=q$D._tempV32.clone(),q$V=q$D._tempM0.clone();q$_.extents=q$J,q$_.transformation=q$V},q$D.createByMinAndMaxVertex=function(q$S,q$_){return q$W_.subtract(q$_,q$S,q$D._tempV30),q$W_.scale(q$D._tempV30,.5,q$D._tempV30),q$W_.add(q$S,q$D._tempV30,q$D._tempV31),q$W_.subtract(q$_,q$D._tempV31,q$D._tempV32),q$S_.translation(q$D._tempV31,q$D._tempM0),new q$D(q$D._tempV32,q$D._tempM0)},q$D._getRows=function(q$S,q$_){q$_.length=3;var q$a=q$S.elements,q$R=q$_[0].elements;q$R[0]=q$a[0],q$R[1]=q$a[1],q$R[2]=q$a[2];var q$J=q$_[1].elements;q$J[0]=q$a[4],q$J[1]=q$a[5],q$J[2]=q$a[6];var q$V=q$_[2].elements;q$V[0]=q$a[8],q$V[1]=q$a[9],q$V[2]=q$a[10]},q$D.getObbtoObbMatrix4x4=function(q$S,q$_,q$a,q$R){var q$J=q$S.transformation,q$V=q$_.transformation;if(q$a){q$D._getRows(q$J,q$D._rows1),q$D._getRows(q$V,q$D._rows2);for(var q$W=0;q$W<3;q$W++)for(var q$k=0;q$k<3;q$k++)q$R.setElementByRowColumn(q$W,q$k,q$W_.dot(q$D._rows2[q$W],q$D._rows1[q$k]));q$_.getCenter(q$D._tempV30),q$S.getCenter(q$D._tempV31),q$W_.subtract(q$D._tempV30,q$D._tempV31,q$D._tempV32);var q$z=q$R.elements;q$z[12]=q$W_.dot(q$D._tempV32,q$D._rows1[0]),q$z[13]=q$W_.dot(q$D._tempV32,q$D._rows1[1]),q$z[14]=q$W_.dot(q$D._tempV32,q$D._rows1[2]),q$z[15]=1}else q$J.invert(q$D._tempM0),q$S_.multiply(q$V,q$D._tempM0,q$R)},q$D.merge=function(q$S,q$_,q$a){var q$R=q$S.extents,q$J=q$S.transformation;q$D.getObbtoObbMatrix4x4(q$S,q$_,q$a,q$D._tempM0),q$_._getLocalCorners(q$D._corners),q$W_.transformCoordinate(q$D._corners[0],q$D._tempM0,q$D._corners[0]),q$W_.transformCoordinate(q$D._corners[1],q$D._tempM0,q$D._corners[1]),q$W_.transformCoordinate(q$D._corners[2],q$D._tempM0,q$D._corners[2]),q$W_.transformCoordinate(q$D._corners[3],q$D._tempM0,q$D._corners[3]),q$W_.transformCoordinate(q$D._corners[4],q$D._tempM0,q$D._corners[4]),q$W_.transformCoordinate(q$D._corners[5],q$D._tempM0,q$D._corners[5]),q$W_.transformCoordinate(q$D._corners[6],q$D._tempM0,q$D._corners[6]),q$W_.transformCoordinate(q$D._corners[7],q$D._tempM0,q$D._corners[7]),q$W_.scale(q$R,-1,q$D._boxBound1.min),q$R.cloneTo(q$D._boxBound1.max),q$ES.createfromPoints(q$D._corners,q$D._boxBound2),q$ES.merge(q$D._boxBound2,q$D._boxBound1,q$D._boxBound3);var q$V=q$D._boxBound3.min,q$W=q$D._boxBound3.max;q$W_.subtract(q$W,q$V,q$D._tempV30),q$W_.scale(q$D._tempV30,.5,q$D._tempV30),q$W_.add(q$V,q$D._tempV30,q$D._tempV32),q$W_.subtract(q$W,q$D._tempV32,q$R),q$W_.transformCoordinate(q$D._tempV32,q$J,q$D._tempV33)},q$L(q$D,["_tempV30",function(){return this._tempV30=new q$W_},"_tempV31",function(){return this._tempV31=new q$W_},"_tempV32",function(){return this._tempV32=new q$W_},"_tempV33",function(){return this._tempV33=new q$W_},"_tempV34",function(){return this._tempV34=new q$W_},"_tempV35",function(){return this._tempV35=new q$W_},"_tempV36",function(){return this._tempV36=new q$W_},"_tempM0",function(){return this._tempM0=new q$S_},"_tempM1",function(){return this._tempM1=new q$S_},"_corners",function(){return this._corners=[new q$W_,new q$W_,new q$W_,new q$W_,new q$W_,new q$W_,new q$W_,new q$W_]},"_rows1",function(){return this._rows1=[new q$W_,new q$W_,new q$W_]},"_rows2",function(){return this._rows2=[new q$W_,new q$W_,new q$W_]},"_ray",function(){return this._ray=new q$J_(new q$W_,new q$W_)},"_boxBound1",function(){return this._boxBound1=new q$ES(new q$W_,new q$W_)},"_boxBound2",function(){return this._boxBound2=new q$ES(new q$W_,new q$W_)},"_boxBound3",function(){return this._boxBound3=new q$ES(new q$W_,new q$W_)}])}(),function(){function q$Q(q$S,q$_){this.normal=null,this.distance=NaN,void 0===q$_&&(q$_=0),this.normal=q$S,this.distance=q$_}return q$G(q$Q,"laya.d3.math.Plane"),q$Q.prototype.normalize=function(){var q$S=this.normal.elements,q$_=q$S[0],q$a=q$S[1],q$R=q$S[2],q$J=1/Math.sqrt(q$_*q$_+q$a*q$a+q$R*q$R);q$S[0]=q$_*q$J,q$S[1]=q$a*q$J,q$S[2]=q$R*q$J,this.distance*=q$J},q$Q.createPlaneBy3P=function(q$S,q$_,q$a){var q$R=q$S.elements,q$J=q$_.elements,q$V=q$a.elements,q$W=q$J[0]-q$R[0],q$k=q$J[1]-q$R[1],q$z=q$J[2]-q$R[2],q$b=q$V[0]-q$R[0],q$H=q$V[1]-q$R[1],q$L=q$V[2]-q$R[2],q$C=q$k*q$L-q$z*q$H,q$G=q$z*q$b-q$W*q$L,q$t=q$W*q$H-q$k*q$b,q$o=1/Math.sqrt(q$C*q$C+q$G*q$G+q$t*q$t),q$$=q$C*q$o,q$F=q$G*q$o,q$T=q$t*q$o,q$D=q$Q._TEMPVec3.elements;q$D[0]=q$$,q$D[1]=q$F,q$D[2]=q$T;var q$j=-(q$$*q$R[0]+q$F*q$R[1]+q$T*q$R[2]);return new q$Q(q$Q._TEMPVec3,q$j)},q$Q.PlaneIntersectionType_Back=0,q$Q.PlaneIntersectionType_Front=1,q$Q.PlaneIntersectionType_Intersecting=2,q$L(q$Q,["_TEMPVec3",function(){return this._TEMPVec3=new q$W_}]),q$Q}()),q$a_=function(){function q$J(q$S,q$_,q$a,q$R){this.elements=new Float32Array(4),void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=1),this.elements[0]=q$S,this.elements[1]=q$_,this.elements[2]=q$a,this.elements[3]=q$R}q$G(q$J,"laya.d3.math.Quaternion");var q$S=q$J.prototype;return q$Q.imps(q$S,{"laya.d3.core.IClone":!0}),q$S.scaling=function(q$S,q$_){var q$a=q$_.elements,q$R=this.elements;q$a[0]=q$R[0]*q$S,q$a[1]=q$R[1]*q$S,q$a[2]=q$R[2]*q$S,q$a[3]=q$R[3]*q$S},q$S.normalize=function(q$S){var q$_=q$S.elements,q$a=this.elements,q$R=q$a[0],q$J=q$a[1],q$V=q$a[2],q$W=q$a[3],q$k=q$R*q$R+q$J*q$J+q$V*q$V+q$W*q$W;0<q$k&&(q$k=1/Math.sqrt(q$k),q$_[0]=q$R*q$k,q$_[1]=q$J*q$k,q$_[2]=q$V*q$k,q$_[3]=q$W*q$k)},q$S.length=function(){var q$S=this.elements,q$_=q$S[0],q$a=q$S[1],q$R=q$S[2],q$J=q$S[3];return Math.sqrt(q$_*q$_+q$a*q$a+q$R*q$R+q$J*q$J)},q$S.rotateX=function(q$S,q$_){var q$a=q$_.elements,q$R=this.elements;q$S*=.5;var q$J=q$R[0],q$V=q$R[1],q$W=q$R[2],q$k=q$R[3],q$z=Math.sin(q$S),q$b=Math.cos(q$S);q$a[0]=q$J*q$b+q$k*q$z,q$a[1]=q$V*q$b+q$W*q$z,q$a[2]=q$W*q$b-q$V*q$z,q$a[3]=q$k*q$b-q$J*q$z},q$S.rotateY=function(q$S,q$_){var q$a=q$_.elements,q$R=this.elements;q$S*=.5;var q$J=q$R[0],q$V=q$R[1],q$W=q$R[2],q$k=q$R[3],q$z=Math.sin(q$S),q$b=Math.cos(q$S);q$a[0]=q$J*q$b-q$W*q$z,q$a[1]=q$V*q$b+q$k*q$z,q$a[2]=q$W*q$b+q$J*q$z,q$a[3]=q$k*q$b-q$V*q$z},q$S.rotateZ=function(q$S,q$_){var q$a=q$_.elements,q$R=this.elements;q$S*=.5;var q$J=q$R[0],q$V=q$R[1],q$W=q$R[2],q$k=q$R[3],q$z=Math.sin(q$S),q$b=Math.cos(q$S);q$a[0]=q$J*q$b+q$V*q$z,q$a[1]=q$V*q$b-q$J*q$z,q$a[2]=q$W*q$b+q$k*q$z,q$a[3]=q$k*q$b-q$W*q$z},q$S.getYawPitchRoll=function(q$S){q$W_.transformQuat(q$W_.ForwardRH,this,q$J.TEMPVector31),q$W_.transformQuat(q$W_.Up,this,q$J.TEMPVector32);var q$_=q$J.TEMPVector32.elements;q$J.angleTo(q$W_.ZERO,q$J.TEMPVector31,q$J.TEMPVector33);var q$a=q$J.TEMPVector33.elements;q$a[0]==Math.PI/2?(q$a[1]=q$J.arcTanAngle(q$_[2],q$_[0]),q$a[2]=0):q$a[0]==-Math.PI/2?(q$a[1]=q$J.arcTanAngle(-q$_[2],-q$_[0]),q$a[2]=0):(q$S_.createRotationY(-q$a[1],q$J.TEMPMatrix0),q$S_.createRotationX(-q$a[0],q$J.TEMPMatrix1),q$W_.transformCoordinate(q$J.TEMPVector32,q$J.TEMPMatrix0,q$J.TEMPVector32),q$W_.transformCoordinate(q$J.TEMPVector32,q$J.TEMPMatrix1,q$J.TEMPVector32),q$a[2]=q$J.arcTanAngle(q$_[1],-q$_[0])),q$a[1]<=-Math.PI&&(q$a[1]=Math.PI),q$a[2]<=-Math.PI&&(q$a[2]=Math.PI),q$a[1]>=Math.PI&&q$a[2]>=Math.PI&&(q$a[1]=0,q$a[2]=0,q$a[0]=Math.PI-q$a[0]);var q$R=q$S.elements;q$R[0]=q$a[1],q$R[1]=q$a[0],q$R[2]=q$a[2]},q$S.invert=function(q$S){var q$_=q$S.elements,q$a=this.elements,q$R=q$a[0],q$J=q$a[1],q$V=q$a[2],q$W=q$a[3],q$k=q$R*q$R+q$J*q$J+q$V*q$V+q$W*q$W,q$z=q$k?1/q$k:0;q$_[0]=-q$R*q$z,q$_[1]=-q$J*q$z,q$_[2]=-q$V*q$z,q$_[3]=q$W*q$z},q$S.identity=function(){var q$S=this.elements;q$S[0]=0,q$S[1]=0,q$S[2]=0,q$S[3]=1},q$S.fromArray=function(q$S,q$_){void 0===q$_&&(q$_=0),this.elements[0]=q$S[q$_+0],this.elements[1]=q$S[q$_+1],this.elements[2]=q$S[q$_+2],this.elements[3]=q$S[q$_+3]},q$S.cloneTo=function(q$S){var q$_,q$a,q$R;if((q$a=this.elements)!==(q$R=q$S.elements))for(q$_=0;q$_<4;++q$_)q$R[q$_]=q$a[q$_]},q$S.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$S.equals=function(q$S){var q$_=this.elements,q$a=q$S.elements;return q$vS.nearEqual(q$_[0],q$a[0])&&q$vS.nearEqual(q$_[1],q$a[1])&&q$vS.nearEqual(q$_[2],q$a[2])&&q$vS.nearEqual(q$_[3],q$a[3])},q$S.lengthSquared=function(){var q$S=this.elements[0],q$_=this.elements[1],q$a=this.elements[2],q$R=this.elements[3];return q$S*q$S+q$_*q$_+q$a*q$a+q$R*q$R},q$t(0,q$S,"x",function(){return this.elements[0]}),q$t(0,q$S,"y",function(){return this.elements[1]}),q$t(0,q$S,"z",function(){return this.elements[2]}),q$t(0,q$S,"w",function(){return this.elements[3]}),q$J.createFromYawPitchRoll=function(q$S,q$_,q$a,q$R){var q$J=.5*q$a,q$V=.5*q$_,q$W=.5*q$S,q$k=Math.sin(q$J),q$z=Math.cos(q$J),q$b=Math.sin(q$V),q$H=Math.cos(q$V),q$L=Math.sin(q$W),q$C=Math.cos(q$W),q$G=q$R.elements;q$G[0]=q$C*q$b*q$z+q$L*q$H*q$k,q$G[1]=q$L*q$H*q$z-q$C*q$b*q$k,q$G[2]=q$C*q$H*q$k-q$L*q$b*q$z,q$G[3]=q$C*q$H*q$z+q$L*q$b*q$k},q$J.multiply=function(q$S,q$_,q$a){var q$R=q$S.elements,q$J=q$_.elements,q$V=q$a.elements,q$W=q$R[0],q$k=q$R[1],q$z=q$R[2],q$b=q$R[3],q$H=q$J[0],q$L=q$J[1],q$C=q$J[2],q$G=q$J[3],q$t=q$k*q$C-q$z*q$L,q$o=q$z*q$H-q$W*q$C,q$$=q$W*q$L-q$k*q$H,q$F=q$W*q$H+q$k*q$L+q$z*q$C;q$V[0]=q$W*q$G+q$H*q$b+q$t,q$V[1]=q$k*q$G+q$L*q$b+q$o,q$V[2]=q$z*q$G+q$C*q$b+q$$,q$V[3]=q$b*q$G-q$F},q$J.arcTanAngle=function(q$S,q$_){return 0==q$S?1==q$_?Math.PI/2:-Math.PI/2:0<q$S?Math.atan(q$_/q$S):q$S<0?0<q$_?Math.atan(q$_/q$S)+Math.PI:Math.atan(q$_/q$S)-Math.PI:0},q$J.angleTo=function(q$S,q$_,q$a){q$W_.subtract(q$_,q$S,q$J.TEMPVector30),q$W_.normalize(q$J.TEMPVector30,q$J.TEMPVector30),q$a.elements[0]=Math.asin(q$J.TEMPVector30.y),q$a.elements[1]=q$J.arcTanAngle(-q$J.TEMPVector30.z,-q$J.TEMPVector30.x)},q$J.createFromAxisAngle=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements;q$_*=.5;var q$V=Math.sin(q$_);q$R[0]=q$V*q$J[0],q$R[1]=q$V*q$J[1],q$R[2]=q$V*q$J[2],q$R[3]=Math.cos(q$_)},q$J.createFromMatrix3x3=function(q$S,q$_){var q$a,q$R=q$_.elements,q$J=q$S.elements,q$V=q$J[0]+q$J[4]+q$J[8];if(0<q$V)q$a=Math.sqrt(q$V+1),q$R[3]=.5*q$a,q$a=.5/q$a,q$R[0]=(q$J[5]-q$J[7])*q$a,q$R[1]=(q$J[6]-q$J[2])*q$a,q$R[2]=(q$J[1]-q$J[3])*q$a;else{var q$W=0;q$J[4]>q$J[0]&&(q$W=1),q$J[8]>q$J[3*q$W+q$W]&&(q$W=2);var q$k=(q$W+1)%3,q$z=(q$W+2)%3;q$a=Math.sqrt(q$J[3*q$W+q$W]-q$J[3*q$k+q$k]-q$J[3*q$z+q$z]+1),q$R[q$W]=.5*q$a,q$a=.5/q$a,q$R[3]=(q$J[3*q$k+q$z]-q$J[3*q$z+q$k])*q$a,q$R[q$k]=(q$J[3*q$k+q$W]+q$J[3*q$W+q$k])*q$a,q$R[q$z]=(q$J[3*q$z+q$W]+q$J[3*q$W+q$z])*q$a}},q$J.createFromMatrix4x4=function(q$S,q$_){var q$a,q$R,q$J=q$S.elements,q$V=q$_.elements,q$W=q$J[0]+q$J[5]+q$J[10];0<q$W?(q$a=Math.sqrt(q$W+1),q$V[3]=.5*q$a,q$a=.5/q$a,q$V[0]=(q$J[6]-q$J[9])*q$a,q$V[1]=(q$J[8]-q$J[2])*q$a,q$V[2]=(q$J[1]-q$J[4])*q$a):q$J[0]>=q$J[5]&&q$J[0]>=q$J[10]?(q$R=.5/(q$a=Math.sqrt(1+q$J[0]-q$J[5]-q$J[10])),q$V[0]=.5*q$a,q$V[1]=(q$J[1]+q$J[4])*q$R,q$V[2]=(q$J[2]+q$J[8])*q$R,q$V[3]=(q$J[6]-q$J[9])*q$R):q$J[5]>q$J[10]?(q$R=.5/(q$a=Math.sqrt(1+q$J[5]-q$J[0]-q$J[10])),q$V[0]=(q$J[4]+q$J[1])*q$R,q$V[1]=.5*q$a,q$V[2]=(q$J[9]+q$J[6])*q$R,q$V[3]=(q$J[8]-q$J[2])*q$R):(q$R=.5/(q$a=Math.sqrt(1+q$J[10]-q$J[0]-q$J[5])),q$V[0]=(q$J[8]+q$J[2])*q$R,q$V[1]=(q$J[9]+q$J[6])*q$R,q$V[2]=.5*q$a,q$V[3]=(q$J[1]-q$J[4])*q$R)},q$J.slerp=function(q$S,q$_,q$a,q$R){var q$J,q$V,q$W,q$k,q$z,q$b=q$S.elements,q$H=q$_.elements,q$L=q$R.elements,q$C=q$b[0],q$G=q$b[1],q$t=q$b[2],q$o=q$b[3],q$$=q$H[0],q$F=q$H[1],q$T=q$H[2],q$D=q$H[3];return(q$V=q$C*q$$+q$G*q$F+q$t*q$T+q$o*q$D)<0&&(q$V=-q$V,q$$=-q$$,q$F=-q$F,q$T=-q$T,q$D=-q$D),q$z=1e-6<1-q$V?(q$J=Math.acos(q$V),q$W=Math.sin(q$J),q$k=Math.sin((1-q$a)*q$J)/q$W,Math.sin(q$a*q$J)/q$W):(q$k=1-q$a,q$a),q$L[0]=q$k*q$C+q$z*q$$,q$L[1]=q$k*q$G+q$z*q$F,q$L[2]=q$k*q$t+q$z*q$T,q$L[3]=q$k*q$o+q$z*q$D,q$L},q$J.lerp=function(q$S,q$_,q$a,q$R){var q$J=q$R.elements,q$V=q$S.elements,q$W=q$_.elements,q$k=q$V[0],q$z=q$V[1],q$b=q$V[2],q$H=q$V[3];q$J[0]=q$k+q$a*(q$W[0]-q$k),q$J[1]=q$z+q$a*(q$W[1]-q$z),q$J[2]=q$b+q$a*(q$W[2]-q$b),q$J[3]=q$H+q$a*(q$W[3]-q$H)},q$J.add=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements;q$R[0]=q$J[0]+q$V[0],q$R[1]=q$J[1]+q$V[1],q$R[2]=q$J[2]+q$V[2],q$R[3]=q$J[3]+q$V[3]},q$J.dot=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements;return q$a[0]*q$R[0]+q$a[1]*q$R[1]+q$a[2]*q$R[2]+q$a[3]*q$R[3]},q$J.rotationLookAt=function(q$S,q$_,q$a){q$J.lookAt(q$W_.ZERO,q$S,q$_,q$a)},q$J.lookAt=function(q$S,q$_,q$a,q$R){q$dS.lookAt(q$S,q$_,q$a,q$J._tempMatrix3x3),q$J.rotationMatrix(q$J._tempMatrix3x3,q$R)},q$J.invert=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements,q$J=q$S.lengthSquared();q$vS.isZero(q$J)||(q$J=1/q$J,q$R[0]=-q$a[0]*q$J,q$R[1]=-q$a[1]*q$J,q$R[2]=-q$a[2]*q$J,q$R[3]=q$a[3]*q$J)},q$J.rotationMatrix=function(q$S,q$_){var q$a=q$S.elements,q$R=q$a[0],q$J=q$a[1],q$V=q$a[2],q$W=q$a[3],q$k=q$a[4],q$z=q$a[5],q$b=q$a[6],q$H=q$a[7],q$L=q$a[8],q$C=q$_.elements,q$G=NaN,q$t=NaN,q$o=q$R+q$k+q$L;0<q$o?(q$G=Math.sqrt(q$o+1),q$C[3]=.5*q$G,q$G=.5/q$G,q$C[0]=(q$z-q$H)*q$G,q$C[1]=(q$b-q$V)*q$G,q$C[2]=(q$J-q$W)*q$G):q$k<=q$R&&q$L<=q$R?(q$t=.5/(q$G=Math.sqrt(1+q$R-q$k-q$L)),q$C[0]=.5*q$G,q$C[1]=(q$J+q$W)*q$t,q$C[2]=(q$V+q$b)*q$t,q$C[3]=(q$z-q$H)*q$t):q$L<q$k?(q$t=.5/(q$G=Math.sqrt(1+q$k-q$R-q$L)),q$C[0]=(q$W+q$J)*q$t,q$C[1]=.5*q$G,q$C[2]=(q$H+q$z)*q$t,q$C[3]=(q$b-q$V)*q$t):(q$t=.5/(q$G=Math.sqrt(1+q$L-q$R-q$k)),q$C[0]=(q$b+q$V)*q$t,q$C[1]=(q$H+q$z)*q$t,q$C[2]=.5*q$G,q$C[3]=(q$J-q$W)*q$t)},q$J.DEFAULT=new q$J,q$L(q$J,["TEMPVector30",function(){return this.TEMPVector30=new q$W_},"TEMPVector31",function(){return this.TEMPVector31=new q$W_},"TEMPVector32",function(){return this.TEMPVector32=new q$W_},"TEMPVector33",function(){return this.TEMPVector33=new q$W_},"TEMPMatrix0",function(){return this.TEMPMatrix0=new q$S_},"TEMPMatrix1",function(){return this.TEMPMatrix1=new q$S_},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new q$dS},"NAN",function(){return this.NAN=new q$J(NaN,NaN,NaN,NaN)}]),q$J}(),q$R_=function(){function q$S(q$S){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=q$S,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}q$G(q$S,"laya.d3.math.Rand");var q$_=q$S.prototype;return q$_.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},q$_.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},q$_.getSignedFloat=function(){return 2*this.getFloat()-1},q$t(0,q$_,"seed",function(){return this.seeds[0]},function(q$S){this.seeds[0]=q$S,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),q$S.getFloatFromInt=function(q$S){return 1/8388607*(8388607&q$S)},q$S.getByteFromInt=function(q$S){return(8388607&q$S)>>>15},q$S}(),q$J_=(function(){function q$J(q$S){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(q$S instanceof Array)||4!==q$S.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|q$S[0],this._state0L=0|q$S[1],this._state1U=0|q$S[2],this._state1L=0|q$S[3]}q$G(q$J,"laya.d3.math.RandX");var q$S=q$J.prototype;q$S.randomint=function(){var q$S=this._state0U,q$_=this._state0L,q$a=this._state1U,q$R=this._state1L,q$J=(q$R>>>0)+(q$_>>>0),q$V=q$a+q$S+(q$J/2>>>31)>>>0,q$W=q$J>>>0,q$k=0,q$z=0;q$k=(q$S^=q$k=q$S<<23|(-512&q$_)>>>9)^(this._state0U=q$a),q$z=(q$_^=q$z=q$_<<23)^(this._state0L=q$R);q$k^=q$S>>>18,q$z^=q$_>>>18|(262143&q$S)<<14;return q$k^=q$a>>>5,q$z^=q$R>>>5|(31&q$a)<<27,this._state1U=q$k,this._state1L=q$z,[q$V,q$W]},q$S.random=function(){var q$S=this.randomint(),q$_=q$S[0],q$a=1023<<20|q$_>>>12,q$R=0|(q$S[1]>>>12|(4095&q$_)<<20);return q$J._CONVERTION_BUFFER.setUint32(0,q$a,!1),q$J._CONVERTION_BUFFER.setUint32(4,q$R,!1),q$R_._CONVERTION_BUFFER.getFloat64(0,!1)-1},q$L(q$J,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new q$R_([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function q$S(q$S,q$_){this.origin=null,this.direction=null,this.origin=q$S,this.direction=q$_}return q$G(q$S,"laya.d3.math.Ray"),q$S}()),q$V_=function(){function q$S(q$S,q$_){this.elements=new Float32Array(2),void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0);var q$a=this.elements;q$a[0]=q$S,q$a[1]=q$_}q$G(q$S,"laya.d3.math.Vector2");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_.fromArray=function(q$S,q$_){void 0===q$_&&(q$_=0),this.elements[0]=q$S[q$_+0],this.elements[1]=q$S[q$_+1]},q$_.cloneTo=function(q$S){var q$_=q$S.elements,q$a=this.elements;q$_[0]=q$a[0],q$_[1]=q$a[1]},q$_.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$_,"x",function(){return this.elements[0]},function(q$S){this.elements[0]=q$S}),q$t(0,q$_,"y",function(){return this.elements[1]},function(q$S){this.elements[1]=q$S}),q$S.scale=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements;q$R[0]=q$J[0]*q$_,q$R[1]=q$J[1]*q$_},q$L(q$S,["ZERO",function(){return this.ZERO=new q$S(0,0)},"ONE",function(){return this.ONE=new q$S(1,1)}]),q$S}(),q$W_=function(){function q$H(q$S,q$_,q$a){this.elements=new Float32Array(3),void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0);var q$R=this.elements;q$R[0]=q$S,q$R[1]=q$_,q$R[2]=q$a}q$G(q$H,"laya.d3.math.Vector3");var q$S=q$H.prototype;return q$Q.imps(q$S,{"laya.d3.core.IClone":!0}),q$S.fromArray=function(q$S,q$_){void 0===q$_&&(q$_=0),this.elements[0]=q$S[q$_+0],this.elements[1]=q$S[q$_+1],this.elements[2]=q$S[q$_+2]},q$S.cloneTo=function(q$S){var q$_=q$S.elements,q$a=this.elements;q$_[0]=q$a[0],q$_[1]=q$a[1],q$_[2]=q$a[2]},q$S.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$S.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},q$S.reset=function(q$S,q$_,q$a){this.elements[0]=q$S,this.elements[1]=q$_,this.elements[2]=q$a},q$t(0,q$S,"x",function(){return this.elements[0]},function(q$S){this.elements[0]=q$S}),q$t(0,q$S,"y",function(){return this.elements[1]},function(q$S){this.elements[1]=q$S}),q$t(0,q$S,"z",function(){return this.elements[2]},function(q$S){this.elements[2]=q$S}),q$H.distanceSquared=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements,q$J=q$a[0]-q$R[0],q$V=q$a[1]-q$R[1],q$W=q$a[2]-q$R[2];return q$J*q$J+q$V*q$V+q$W*q$W},q$H.distance=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements,q$J=q$a[0]-q$R[0],q$V=q$a[1]-q$R[1],q$W=q$a[2]-q$R[2];return Math.sqrt(q$J*q$J+q$V*q$V+q$W*q$W)},q$H.min=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements;q$R[0]=Math.min(q$J[0],q$V[0]),q$R[1]=Math.min(q$J[1],q$V[1]),q$R[2]=Math.min(q$J[2],q$V[2])},q$H.max=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements;q$R[0]=Math.max(q$J[0],q$V[0]),q$R[1]=Math.max(q$J[1],q$V[1]),q$R[2]=Math.max(q$J[2],q$V[2])},q$H.transformQuat=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements,q$W=q$J[0],q$k=q$J[1],q$z=q$J[2],q$b=q$V[0],q$H=q$V[1],q$L=q$V[2],q$C=q$V[3],q$G=q$C*q$W+q$H*q$z-q$L*q$k,q$t=q$C*q$k+q$L*q$W-q$b*q$z,q$o=q$C*q$z+q$b*q$k-q$H*q$W,q$$=-q$b*q$W-q$H*q$k-q$L*q$z;q$R[0]=q$G*q$C+q$$*-q$b+q$t*-q$L-q$o*-q$H,q$R[1]=q$t*q$C+q$$*-q$H+q$o*-q$b-q$G*-q$L,q$R[2]=q$o*q$C+q$$*-q$L+q$G*-q$H-q$t*-q$b},q$H.scalarLength=function(q$S){var q$_=q$S.elements,q$a=q$_[0],q$R=q$_[1],q$J=q$_[2];return Math.sqrt(q$a*q$a+q$R*q$R+q$J*q$J)},q$H.scalarLengthSquared=function(q$S){var q$_=q$S.elements,q$a=q$_[0],q$R=q$_[1],q$J=q$_[2];return q$a*q$a+q$R*q$R+q$J*q$J},q$H.normalize=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements,q$J=q$a[0],q$V=q$a[1],q$W=q$a[2],q$k=q$J*q$J+q$V*q$V+q$W*q$W;0<q$k&&(q$k=1/Math.sqrt(q$k),q$R[0]=q$a[0]*q$k,q$R[1]=q$a[1]*q$k,q$R[2]=q$a[2]*q$k)},q$H.multiply=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements;q$R[0]=q$J[0]*q$V[0],q$R[1]=q$J[1]*q$V[1],q$R[2]=q$J[2]*q$V[2]},q$H.scale=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements;q$R[0]=q$J[0]*q$_,q$R[1]=q$J[1]*q$_,q$R[2]=q$J[2]*q$_},q$H.lerp=function(q$S,q$_,q$a,q$R){var q$J=q$R.elements,q$V=q$S.elements,q$W=q$_.elements,q$k=q$V[0],q$z=q$V[1],q$b=q$V[2];q$J[0]=q$k+q$a*(q$W[0]-q$k),q$J[1]=q$z+q$a*(q$W[1]-q$z),q$J[2]=q$b+q$a*(q$W[2]-q$b)},q$H.transformV3ToV3=function(q$S,q$_,q$a){var q$R=q$H._tempVector4;q$H.transformV3ToV4(q$S,q$_,q$R);var q$J=q$R.elements,q$V=q$a.elements;q$V[0]=q$J[0],q$V[1]=q$J[1],q$V[2]=q$J[2]},q$H.transformV3ToV4=function(q$S,q$_,q$a){var q$R=q$S.elements,q$J=q$R[0],q$V=q$R[1],q$W=q$R[2],q$k=q$_.elements,q$z=q$a.elements;q$z[0]=q$J*q$k[0]+q$V*q$k[4]+q$W*q$k[8]+q$k[12],q$z[1]=q$J*q$k[1]+q$V*q$k[5]+q$W*q$k[9]+q$k[13],q$z[2]=q$J*q$k[2]+q$V*q$k[6]+q$W*q$k[10]+q$k[14],q$z[3]=q$J*q$k[3]+q$V*q$k[7]+q$W*q$k[11]+q$k[15]},q$H.TransformNormal=function(q$S,q$_,q$a){var q$R=q$S.elements,q$J=q$R[0],q$V=q$R[1],q$W=q$R[2],q$k=q$_.elements,q$z=q$a.elements;q$z[0]=q$J*q$k[0]+q$V*q$k[4]+q$W*q$k[8],q$z[1]=q$J*q$k[1]+q$V*q$k[5]+q$W*q$k[9],q$z[2]=q$J*q$k[2]+q$V*q$k[6]+q$W*q$k[10]},q$H.transformCoordinate=function(q$S,q$_,q$a){var q$R=q$H._tempVector4.elements,q$J=q$S.elements,q$V=q$J[0],q$W=q$J[1],q$k=q$J[2],q$z=q$_.elements;q$R[0]=q$V*q$z[0]+q$W*q$z[4]+q$k*q$z[8]+q$z[12],q$R[1]=q$V*q$z[1]+q$W*q$z[5]+q$k*q$z[9]+q$z[13],q$R[2]=q$V*q$z[2]+q$W*q$z[6]+q$k*q$z[10]+q$z[14],q$R[3]=1/(q$V*q$z[3]+q$W*q$z[7]+q$k*q$z[11]+q$z[15]);var q$b=q$a.elements;q$b[0]=q$R[0]*q$R[3],q$b[1]=q$R[1]*q$R[3],q$b[2]=q$R[2]*q$R[3]},q$H.Clamp=function(q$S,q$_,q$a,q$R){var q$J=q$S.elements,q$V=q$J[0],q$W=q$J[1],q$k=q$J[2],q$z=q$_.elements,q$b=q$z[0],q$H=q$z[1],q$L=q$z[2],q$C=q$a.elements,q$G=q$C[0],q$t=q$C[1],q$o=q$C[2],q$$=q$R.elements;q$V=(q$V=q$G<q$V?q$G:q$V)<q$b?q$b:q$V,q$W=(q$W=q$t<q$W?q$t:q$W)<q$H?q$H:q$W,q$k=(q$k=q$o<q$k?q$o:q$k)<q$L?q$L:q$k,q$$[0]=q$V,q$$[1]=q$W,q$$[2]=q$k},q$H.add=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements;q$R[0]=q$J[0]+q$V[0],q$R[1]=q$J[1]+q$V[1],q$R[2]=q$J[2]+q$V[2]},q$H.subtract=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements;q$R[0]=q$J[0]-q$V[0],q$R[1]=q$J[1]-q$V[1],q$R[2]=q$J[2]-q$V[2]},q$H.cross=function(q$S,q$_,q$a){var q$R=q$S.elements,q$J=q$_.elements,q$V=q$a.elements,q$W=q$R[0],q$k=q$R[1],q$z=q$R[2],q$b=q$J[0],q$H=q$J[1],q$L=q$J[2];q$V[0]=q$k*q$L-q$z*q$H,q$V[1]=q$z*q$b-q$W*q$L,q$V[2]=q$W*q$H-q$k*q$b},q$H.dot=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements;return q$a[0]*q$R[0]+q$a[1]*q$R[1]+q$a[2]*q$R[2]},q$H.equals=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements;return q$vS.nearEqual(Math.abs(q$a[0]),Math.abs(q$R[0]))&&q$vS.nearEqual(Math.abs(q$a[1]),Math.abs(q$R[1]))&&q$vS.nearEqual(Math.abs(q$a[2]),Math.abs(q$R[2]))},q$H.ZERO=new q$H(0,0,0),q$H.ONE=new q$H(1,1,1),q$H.NegativeUnitX=new q$H(-1,0,0),q$H.UnitX=new q$H(1,0,0),q$H.UnitY=new q$H(0,1,0),q$H.UnitZ=new q$H(0,0,1),q$H.ForwardRH=new q$H(0,0,-1),q$H.ForwardLH=new q$H(0,0,1),q$H.Up=new q$H(0,1,0),q$H.NAN=new q$H(NaN,NaN,NaN),q$L(q$H,["_tempVector4",function(){return this._tempVector4=new q$k_}]),q$H}(),q$k_=function(){function q$S(q$S,q$_,q$a,q$R){this.elements=new Float32Array(4),void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=0);var q$J=this.elements;q$J[0]=q$S,q$J[1]=q$_,q$J[2]=q$a,q$J[3]=q$R}q$G(q$S,"laya.d3.math.Vector4");var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_.fromArray=function(q$S,q$_){void 0===q$_&&(q$_=0),this.elements[0]=q$S[q$_+0],this.elements[1]=q$S[q$_+1],this.elements[2]=q$S[q$_+2],this.elements[3]=q$S[q$_+3]},q$_.cloneTo=function(q$S){var q$_=q$S.elements,q$a=this.elements;q$_[0]=q$a[0],q$_[1]=q$a[1],q$_[2]=q$a[2],q$_[3]=q$a[3]},q$_.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$_.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},q$_.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},q$t(0,q$_,"x",function(){return this.elements[0]},function(q$S){this.elements[0]=q$S}),q$t(0,q$_,"y",function(){return this.elements[1]},function(q$S){this.elements[1]=q$S}),q$t(0,q$_,"z",function(){return this.elements[2]},function(q$S){this.elements[2]=q$S}),q$t(0,q$_,"w",function(){return this.elements[3]},function(q$S){this.elements[3]=q$S}),q$S.lerp=function(q$S,q$_,q$a,q$R){var q$J=q$R.elements,q$V=q$S.elements,q$W=q$_.elements,q$k=q$V[0],q$z=q$V[1],q$b=q$V[2],q$H=q$V[3];q$J[0]=q$k+q$a*(q$W[0]-q$k),q$J[1]=q$z+q$a*(q$W[1]-q$z),q$J[2]=q$b+q$a*(q$W[2]-q$b),q$J[3]=q$H+q$a*(q$W[3]-q$H)},q$S.transformByM4x4=function(q$S,q$_,q$a){var q$R=q$S.elements,q$J=q$R[0],q$V=q$R[1],q$W=q$R[2],q$k=q$R[3],q$z=q$_.elements,q$b=q$a.elements;q$b[0]=q$J*q$z[0]+q$V*q$z[4]+q$W*q$z[8]+q$k*q$z[12],q$b[1]=q$J*q$z[1]+q$V*q$z[5]+q$W*q$z[9]+q$k*q$z[13],q$b[2]=q$J*q$z[2]+q$V*q$z[6]+q$W*q$z[10]+q$k*q$z[14],q$b[3]=q$J*q$z[3]+q$V*q$z[7]+q$W*q$z[11]+q$k*q$z[15]},q$S.equals=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements;return q$vS.nearEqual(Math.abs(q$a[0]),Math.abs(q$R[0]))&&q$vS.nearEqual(Math.abs(q$a[1]),Math.abs(q$R[1]))&&q$vS.nearEqual(Math.abs(q$a[2]),Math.abs(q$R[2]))&&q$vS.nearEqual(Math.abs(q$a[3]),Math.abs(q$R[3]))},q$S.normalize=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements,q$J=q$S.length();0<q$J&&(q$R[0]=q$a[0]*q$J,q$R[1]=q$a[1]*q$J,q$R[2]=q$a[2]*q$J,q$R[3]=q$a[3]*q$J)},q$S.add=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements;q$R[0]=q$J[0]+q$V[0],q$R[1]=q$J[1]+q$V[1],q$R[2]=q$J[2]+q$V[2],q$R[3]=q$J[3]+q$V[3]},q$S.subtract=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements;q$R[0]=q$J[0]-q$V[0],q$R[1]=q$J[1]-q$V[1],q$R[2]=q$J[2]-q$V[2],q$R[3]=q$J[3]-q$V[3]},q$S.multiply=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements;q$R[0]=q$J[0]*q$V[0],q$R[1]=q$J[1]*q$V[1],q$R[2]=q$J[2]*q$V[2],q$R[3]=q$J[3]*q$V[3]},q$S.scale=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements;q$R[0]=q$J[0]*q$_,q$R[1]=q$J[1]*q$_,q$R[2]=q$J[2]*q$_,q$R[3]=q$J[3]*q$_},q$S.Clamp=function(q$S,q$_,q$a,q$R){var q$J=q$S.elements,q$V=q$J[0],q$W=q$J[1],q$k=q$J[2],q$z=q$J[3],q$b=q$_.elements,q$H=q$b[0],q$L=q$b[1],q$C=q$b[2],q$G=q$b[3],q$t=q$a.elements,q$o=q$t[0],q$$=q$t[1],q$F=q$t[2],q$T=q$t[3],q$D=q$R.elements;q$V=(q$V=q$o<q$V?q$o:q$V)<q$H?q$H:q$V,q$W=(q$W=q$$<q$W?q$$:q$W)<q$L?q$L:q$W,q$k=(q$k=q$F<q$k?q$F:q$k)<q$C?q$C:q$k,q$z=(q$z=q$T<q$z?q$T:q$z)<q$G?q$G:q$z,q$D[0]=q$V,q$D[1]=q$W,q$D[2]=q$k,q$D[3]=q$z},q$S.distanceSquared=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements,q$J=q$a[0]-q$R[0],q$V=q$a[1]-q$R[1],q$W=q$a[2]-q$R[2],q$k=q$a[3]-q$R[3];return q$J*q$J+q$V*q$V+q$W*q$W+q$k*q$k},q$S.distance=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements,q$J=q$a[0]-q$R[0],q$V=q$a[1]-q$R[1],q$W=q$a[2]-q$R[2],q$k=q$a[3]-q$R[3];return Math.sqrt(q$J*q$J+q$V*q$V+q$W*q$W+q$k*q$k)},q$S.dot=function(q$S,q$_){var q$a=q$S.elements,q$R=q$_.elements;return q$a[0]*q$R[0]+q$a[1]*q$R[1]+q$a[2]*q$R[2]+q$a[3]*q$R[3]},q$S.min=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements;q$R[0]=Math.min(q$J[0],q$V[0]),q$R[1]=Math.min(q$J[1],q$V[1]),q$R[2]=Math.min(q$J[2],q$V[2]),q$R[3]=Math.min(q$J[3],q$V[3])},q$S.max=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_.elements;q$R[0]=Math.max(q$J[0],q$V[0]),q$R[1]=Math.max(q$J[1],q$V[1]),q$R[2]=Math.max(q$J[2],q$V[2]),q$R[3]=Math.max(q$J[3],q$V[3])},q$L(q$S,["ZERO",function(){return this.ZERO=new q$S},"ONE",function(){return this.ONE=new q$S(1,1,1,1)},"UnitX",function(){return this.UnitX=new q$S(1,0,0,0)},"UnitY",function(){return this.UnitY=new q$S(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new q$S(0,0,1,0)},"UnitW",function(){return this.UnitW=new q$S(0,0,0,1)}]),q$S}(),q$z_=function(){function q$V(q$S,q$_,q$a,q$R){this.minDepth=0,this.maxDepth=1,this.x=q$S,this.y=q$_,this.width=q$a,this.height=q$R}q$G(q$V,"laya.d3.math.Viewport");var q$S=q$V.prototype;return q$S.project=function(q$S,q$_,q$a){q$W_.transformV3ToV3(q$S,q$_,q$a);var q$R=q$S.elements,q$J=q$_.elements,q$V=q$a.elements,q$W=q$R[0]*q$J[3]+q$R[1]*q$J[7]+q$R[2]*q$J[11]+q$J[15];1!==q$W&&(q$V[0]=q$V[0]/q$W,q$V[1]=q$V[1]/q$W,q$V[2]=q$V[2]/q$W),q$V[0]=.5*(q$V[0]+1)*this.width+this.x,q$V[1]=.5*(1-q$V[1])*this.height+this.y,q$V[2]=q$V[2]*(this.maxDepth-this.minDepth)+this.minDepth},q$S.unprojectFromMat=function(q$S,q$_,q$a){var q$R=q$S.elements,q$J=q$_.elements,q$V=q$a.elements;q$V[0]=(q$R[0]-this.x)/this.width*2-1,q$V[1]=-((q$R[1]-this.y)/this.height*2-1);var q$W=(this.maxDepth-this.minDepth)/2;q$V[2]=(q$R[2]-this.minDepth-q$W)/q$W;var q$k=q$V[0]*q$J[3]+q$V[1]*q$J[7]+q$V[2]*q$J[11]+q$J[15];q$W_.transformV3ToV3(q$a,q$_,q$a),1!==q$k&&(q$V[0]=q$V[0]/q$k,q$V[1]=q$V[1]/q$k,q$V[2]=q$V[2]/q$k)},q$S.unprojectFromWVP=function(q$S,q$_,q$a,q$R,q$J){q$S_.multiply(q$_,q$a,q$V._tempMatrix4x4),q$R&&q$S_.multiply(q$V._tempMatrix4x4,q$R,q$V._tempMatrix4x4),q$V._tempMatrix4x4.invert(q$V._tempMatrix4x4),this.unprojectFromMat(q$S,q$V._tempMatrix4x4,q$J)},q$L(q$V,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new q$S_}]),q$V}(),q$b_=function(){function q$I(q$S){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=q$S,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}q$G(q$I,"laya.d3.resource.models.SubMesh");var q$S=q$I.prototype;return q$Q.imps(q$S,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),q$S._getVertexBuffer=function(q$S){return void 0===q$S&&(q$S=0),0===q$S?this._vertexBuffer:null},q$S._getIndexBuffer=function(){return this._indexBuffer},q$S._getStaticBatchBakedVertexs=function(q$S,q$_){var q$a,q$R,q$J=this._vertexBuffer,q$V=q$J.vertexDeclaration,q$W=q$V.getVertexElementByUsage(0).offset/4,q$k=q$V.getVertexElementByUsage(3).offset/4,q$z=q$_.meshRender.lightmapScaleOffset,q$b=0,q$H=0,q$L=0,q$C=0,q$G=0,q$t=0;if(q$z)if(q$R=q$V.getVertexElementByUsage(15))q$L=q$V.vertexStride/4,q$a=0<this._vertexCount?q$J.getData().slice(this._vertexStart*q$L,(this._vertexStart+this._vertexCount)*q$L):q$J.getData().slice(),q$C=q$R.offset/4;else{q$L=(q$t=q$V.vertexStride/4)+2,q$a=this._vertexCount?new Float32Array(this._vertexCount*(q$J.vertexDeclaration.vertexStride/4+2)):new Float32Array(q$J.vertexCount*(q$J.vertexDeclaration.vertexStride/4+2)),q$C=(q$G=q$V.getVertexElementByUsage(2).offset/4)+2;var q$o=q$J.getData();for(q$b=0,q$H=q$o.length/q$t;q$b<q$H;q$b++){var q$$=0;q$$=0<this._vertexCount?(this._vertexStart+q$b)*q$t:q$b*q$t;var q$F=q$b*q$L,q$T=0;for(q$T=0;q$T<q$C;q$T++)q$a[q$F+q$T]=q$o[q$$+q$T];for(q$T=q$C;q$T<q$t;q$T++)q$a[q$F+q$T+2]=q$o[q$$+q$T]}}else q$L=q$V.vertexStride/4,q$a=this._vertexCount?q$J.getData().slice(this._vertexStart*q$L,(this._vertexStart+this._vertexCount)*q$L):q$J.getData().slice();if(q$S){var q$D=q$S.worldMatrix,q$j=q$I._tempMatrix4x40;q$D.invert(q$j);var q$Q=q$I._tempMatrix4x41,q$m=q$_.transform.worldMatrix;q$S_.multiply(q$j,q$m,q$Q)}else q$Q=q$_.transform.worldMatrix;var q$q=q$I._tempQuaternion0;for(q$Q.decomposeTransRotScale(q$I._tempVector30,q$q,q$I._tempVector31),q$b=0,q$H=q$a.length/q$L;q$b<q$H;q$b++){var q$N=q$b*q$L+q$W,q$n=q$b*q$L+q$k;if(q$$_.transformVector3ArrayToVector3ArrayCoordinate(q$a,q$N,q$Q,q$a,q$N),q$$_.transformVector3ArrayByQuat(q$a,q$n,q$q,q$a,q$n),q$z){var q$l=q$b*q$L+q$C;if(q$R)q$$_.transformLightingMapTexcoordByUV1Array(q$a,q$l,q$z,q$a,q$l);else{var q$B=q$b*q$t+q$G;q$$_.transformLightingMapTexcoordByUV0Array(q$o,q$B,q$z,q$a,q$l)}}}return q$a},q$S._getVertexBuffers=function(){return null},q$S._beforeRender=function(q$S){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},q$S._render=function(q$S){var q$_,q$a=0,q$R=q$S.renderElement;if(1<this._indexCount){var q$J=this._boneIndicesList.length;if(1<q$J){for(var q$V=0;q$V<q$J;q$V++)(q$_=q$R._skinAnimationDatas||this._skinAnimationDatas)&&(q$R._shaderValue.setValue(0,q$_[q$V]),q$S._shader.uploadRenderElementUniforms(q$R._shaderValue.data)),q$A.mainContext.drawElements(4,this._subIndexBufferCount[q$V],5123,2*this._subIndexBufferStart[q$V]);q$N.drawCall+=q$J}else(q$_=q$R._skinAnimationDatas||this._skinAnimationDatas)&&(q$R._shaderValue.setValue(0,q$_[0]),q$S._shader.uploadRenderElementUniforms(q$R._shaderValue.data)),q$A.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),q$N.drawCall++;q$a=this._indexCount}else q$a=this._indexBuffer.indexCount,(q$_=q$R._skinAnimationDatas||this._skinAnimationDatas)&&(q$R._shaderValue.setValue(0,q$_[0]),q$S._shader.uploadRenderElementUniforms(q$R._shaderValue.data)),q$A.mainContext.drawElements(4,q$a,5123,0),q$N.drawCall++;q$N.trianglesFaces+=q$a/3},q$S.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},q$S.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},q$t(0,q$S,"_vertexBufferCount",function(){return 1}),q$t(0,q$S,"triangleCount",function(){return this._indexBuffer.indexCount/3}),q$L(q$I,["_tempVector30",function(){return this._tempVector30=new q$W_},"_tempVector31",function(){return this._tempVector31=new q$W_},"_tempQuaternion0",function(){return this._tempQuaternion0=new q$a_},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new q$S_},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new q$S_}]),q$I}(),q$H_=function(){function q$S(q$S){this.defineCounter=0,this.defines=null,q$S?(this.defineCounter=q$S.defineCounter,this.defines=q$S.defines.slice()):(this.defineCounter=0,this.defines=[])}return q$G(q$S,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),q$S.prototype.registerDefine=function(q$S){var q$_=Math.pow(2,this.defineCounter++);return this.defines[q$_]=q$S,q$_},q$S}(),q$L_=function(){function q$S(){}return q$G(q$S,"laya.d3.shader.ShaderInit3D"),q$S.__init__=function(){var q$S,q$_;q$N_._globalRegDefine("HIGHPRECISION",q$N_.SHADERDEFINE_HIGHPRECISION),q$N_._globalRegDefine("FOG",q$N_.SHADERDEFINE_FOG),q$N_._globalRegDefine("DIRECTIONLIGHT",q$N_.SHADERDEFINE_DIRECTIONLIGHT),q$N_._globalRegDefine("POINTLIGHT",q$N_.SHADERDEFINE_POINTLIGHT),q$N_._globalRegDefine("SPOTLIGHT",q$N_.SHADERDEFINE_SPOTLIGHT),q$N_._globalRegDefine("UV",q$N_.SHADERDEFINE_UV0),q$N_._globalRegDefine("COLOR",q$N_.SHADERDEFINE_COLOR),q$N_._globalRegDefine("UV1",q$N_.SHADERDEFINE_UV1),q$N_._globalRegDefine("CASTSHADOW",q$G_.SHADERDEFINE_CAST_SHADOW),q$N_._globalRegDefine("SHADOWMAP_PSSM1",q$G_.SHADERDEFINE_SHADOW_PSSM1),q$N_._globalRegDefine("SHADOWMAP_PSSM2",q$G_.SHADERDEFINE_SHADOW_PSSM2),q$N_._globalRegDefine("SHADOWMAP_PSSM3",q$G_.SHADERDEFINE_SHADOW_PSSM3),q$N_._globalRegDefine("SHADOWMAP_PCF_NO",q$G_.SHADERDEFINE_SHADOW_PCF_NO),q$N_._globalRegDefine("SHADOWMAP_PCF1",q$G_.SHADERDEFINE_SHADOW_PCF1),q$N_._globalRegDefine("SHADOWMAP_PCF2",q$G_.SHADERDEFINE_SHADOW_PCF2),q$N_._globalRegDefine("SHADOWMAP_PCF3",q$G_.SHADERDEFINE_SHADOW_PCF3),q$N_._globalRegDefine("DEPTHFOG",q$N_.SAHDERDEFINE_DEPTHFOG),q$M_.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),q$M_.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),q$S={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},q$_={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var q$a=q$M_.nameKey.add("SIMPLE");shaderCompile=q$N_.add(q$a,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',q$S,q$_),q$r_.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),q$r_.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),q$r_.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),q$r_.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),q$r_.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),q$r_.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),q$r_.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),q$r_.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),q$r_.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},q$S}(),q$C_=function(){function q$S(){this._data=null,this._data=[]}q$G(q$S,"laya.d3.shader.ValusArray");var q$_=q$S.prototype;return q$_.setValue=function(q$S,q$_){this._data[q$S]=q$_},q$t(0,q$_,"data",function(){return this._data}),q$S}(),q$G_=function(){function q$S(){}return q$S.SHADERDEFINE_RECEIVE_SHADOW=1,q$S.SHADERDEFINE_CAST_SHADOW=512,q$S.SHADERDEFINE_SHADOW_PSSM1=1024,q$S.SHADERDEFINE_SHADOW_PSSM2=2048,q$S.SHADERDEFINE_SHADOW_PSSM3=4096,q$S.SHADERDEFINE_SHADOW_PCF_NO=8192,q$S.SHADERDEFINE_SHADOW_PCF1=16384,q$S.SHADERDEFINE_SHADOW_PCF2=32768,q$S.SHADERDEFINE_SHADOW_PCF3=65536,q$S.MAX_PSSM_COUNT=3,q$S}(),q$t_=function(){function q$c(){}return q$G(q$c,"laya.d3.utils.Picker"),q$c.calculateCursorRay=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=q$S.elements[0],q$k=q$S.elements[1],q$z=q$c._tempVector30,q$b=q$z.elements;q$b[0]=q$W,q$b[1]=q$k,q$b[2]=q$_.minDepth;var q$H=q$c._tempVector31,q$L=q$H.elements;q$L[0]=q$W,q$L[1]=q$k,q$L[2]=q$_.maxDepth;var q$C=q$V.origin,q$G=q$c._tempVector32;q$_.unprojectFromWVP(q$z,q$a,q$R,q$J,q$C),q$_.unprojectFromWVP(q$H,q$a,q$R,q$J,q$G);var q$t=q$V.direction.elements;q$t[0]=q$G.x-q$C.x,q$t[1]=q$G.y-q$C.y,q$t[2]=q$G.z-q$C.z,q$W_.normalize(q$V.direction,q$V.direction)},q$c.rayIntersectsPositionsAndIndices=function(q$S,q$_,q$a,q$R,q$J){for(var q$V=q$a.vertexStride/4,q$W=q$a.getVertexElementByUsage(0).offset/4,q$k=Number.MAX_VALUE,q$z=-1,q$b=-1,q$H=-1,q$L=0;q$L<q$R.length;q$L+=3){var q$C=q$c._tempVector35,q$G=q$C.elements,q$t=q$R[q$L]*q$V,q$o=q$t+q$W;q$G[0]=q$_[q$o],q$G[1]=q$_[1+q$o],q$G[2]=q$_[2+q$o];var q$$=q$c._tempVector36,q$F=q$$.elements,q$T=q$R[q$L+1]*q$V,q$D=q$T+q$W;q$F[0]=q$_[q$D],q$F[1]=q$_[1+q$D],q$F[2]=q$_[2+q$D];var q$j=q$c._tempVector37,q$Q=q$j.elements,q$m=q$R[q$L+2]*q$V,q$q=q$m+q$W;q$Q[0]=q$_[q$q],q$Q[1]=q$_[1+q$q],q$Q[2]=q$_[2+q$q];var q$N=laya.d3.utils.Picker.rayIntersectsTriangle(q$S,q$C,q$$,q$j);!isNaN(q$N)&&q$N<q$k&&(q$k=q$N,q$z=q$t,q$b=q$T,q$H=q$m)}if(q$k===Number.MAX_VALUE)return q$J.position.toDefault(),q$J.distance=Number.MAX_VALUE,q$J.trianglePositions[0].toDefault(),q$J.trianglePositions[1].toDefault(),q$J.trianglePositions[2].toDefault(),q$J.triangleNormals[0].toDefault(),q$J.triangleNormals[1].toDefault(),q$J.triangleNormals[2].toDefault(),!1;q$J.distance=q$k,q$W_.scale(q$S.direction,q$k,q$J.position),q$W_.add(q$S.origin,q$J.position,q$J.position);var q$n=q$J.trianglePositions,q$l=q$n[0],q$B=q$n[1],q$I=q$n[2],q$A=q$l.elements,q$X=q$B.elements,q$h=q$I.elements,q$u=q$z+q$W;q$A[0]=q$_[q$u],q$A[1]=q$_[q$u+1],q$A[2]=q$_[q$u+2];var q$K=q$b+q$W;q$X[0]=q$_[q$K],q$X[1]=q$_[q$K+1],q$X[2]=q$_[q$K+2];var q$P=q$H+q$W;q$h[0]=q$_[q$P],q$h[1]=q$_[q$P+1],q$h[2]=q$_[q$P+2];var q$M=q$a.getVertexElementByUsage(3);if(q$M){var q$r=q$M.offset/4,q$e=q$J.triangleNormals,q$g=q$e[0],q$x=q$e[1],q$s=q$e[2],q$U=q$g.elements,q$f=q$x.elements,q$Y=q$s.elements,q$i=q$z+q$r;q$U[0]=q$_[q$i],q$U[1]=q$_[q$i+1],q$U[2]=q$_[q$i+2];var q$Z=q$b+q$r;q$f[0]=q$_[q$Z],q$f[1]=q$_[q$Z+1],q$f[2]=q$_[q$Z+2];var q$p=q$H+q$r;q$Y[0]=q$_[q$p],q$Y[1]=q$_[q$p+1],q$Y[2]=q$_[q$p+2]}return!0},q$c.rayIntersectsTriangle=function(q$S,q$_,q$a,q$R){var q$J=q$c._tempVector30,q$V=q$c._tempVector31;q$W_.subtract(q$a,q$_,q$J),q$W_.subtract(q$R,q$_,q$V);var q$W,q$k=q$c._tempVector32;if(q$W_.cross(q$S.direction,q$V,q$k),(q$W=q$W_.dot(q$J,q$k))>-Number.MIN_VALUE&&q$W<Number.MIN_VALUE)return Number.NaN;var q$z,q$b=1/q$W,q$H=q$c._tempVector33;if(q$W_.subtract(q$S.origin,q$_,q$H),q$z=q$W_.dot(q$H,q$k),(q$z*=q$b)<0||1<q$z)return Number.NaN;var q$L,q$C,q$G=q$c._tempVector34;return q$W_.cross(q$H,q$J,q$G),q$L=q$W_.dot(q$S.direction,q$G),(q$L*=q$b)<0||1<q$z+q$L?Number.NaN:(q$C=q$W_.dot(q$V,q$G),(q$C*=q$b)<0?Number.NaN:q$C)},q$L(q$c,["_tempVector30",function(){return this._tempVector30=new q$W_},"_tempVector31",function(){return this._tempVector31=new q$W_},"_tempVector32",function(){return this._tempVector32=new q$W_},"_tempVector33",function(){return this._tempVector33=new q$W_},"_tempVector34",function(){return this._tempVector34=new q$W_},"_tempVector35",function(){return this._tempVector35=new q$W_},"_tempVector36",function(){return this._tempVector36=new q$W_},"_tempVector37",function(){return this._tempVector37=new q$W_}]),q$c}(),q$o_=(function(){function q$S(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new q$W_,new q$W_,new q$W_],this.trianglePositions.length=3,this.triangleNormals=[new q$W_,new q$W_,new q$W_],this.triangleNormals.length=3,this.position=new q$W_}q$G(q$S,"laya.d3.utils.RaycastHit"),q$S.prototype.cloneTo=function(q$S){q$S.distance=this.distance,this.trianglePositions[0].cloneTo(q$S.trianglePositions[0]),this.trianglePositions[1].cloneTo(q$S.trianglePositions[1]),this.trianglePositions[2].cloneTo(q$S.trianglePositions[2]),this.triangleNormals[0].cloneTo(q$S.triangleNormals[0]),this.triangleNormals[1].cloneTo(q$S.triangleNormals[1]),this.triangleNormals[2].cloneTo(q$S.triangleNormals[2]),this.position.cloneTo(q$S.position),q$S.sprite3D=this.sprite3D}}(),function(){function q$S(q$S,q$_){this._width=0,this._height=0,this._width=q$S,this._height=q$_}q$G(q$S,"laya.d3.utils.Size");var q$_=q$S.prototype;return q$t(0,q$_,"width",function(){return-1===this._width?q$y.clientWidth:this._width}),q$t(0,q$_,"height",function(){return-1===this._height?q$y.clientHeight:this._height}),q$t(1,q$S,"fullScreen",function(){return new q$S(-1,-1)}),q$S}()),q$$_=function(){function q$u(){}return q$G(q$u,"laya.d3.utils.Utils3D"),q$u._rotationTransformScaleSkinAnimation=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$L){var q$C,q$G,q$t,q$o,q$$,q$F=q$u._tempArray16_0,q$T=q$u._tempArray16_1,q$D=q$u._tempArray16_2,q$j=q$R+q$R,q$Q=q$J+q$J,q$m=q$V+q$V,q$q=q$R*q$j,q$N=q$J*q$j,q$n=q$J*q$Q,q$l=q$V*q$j,q$B=q$V*q$Q,q$I=q$V*q$m,q$A=q$W*q$j,q$X=q$W*q$Q,q$h=q$W*q$m;for(q$F[15]=1,q$F[0]=1-q$n-q$I,q$F[1]=q$N+q$h,q$F[2]=q$l-q$X,q$F[4]=q$N-q$h,q$F[5]=1-q$q-q$I,q$F[6]=q$B+q$A,q$F[8]=q$l+q$X,q$F[9]=q$B-q$A,q$F[10]=1-q$q-q$n,q$T[15]=1,q$T[0]=q$k,q$T[5]=q$z,q$T[10]=q$b,q$C=0;q$C<4;q$C++)q$G=q$F[q$C],q$t=q$F[q$C+4],q$o=q$F[q$C+8],q$$=q$F[q$C+12],q$D[q$C]=q$G,q$D[q$C+4]=q$t,q$D[q$C+8]=q$o,q$D[q$C+12]=q$G*q$S+q$t*q$_+q$o*q$a+q$$;for(q$C=0;q$C<4;q$C++)q$G=q$D[q$C],q$t=q$D[q$C+4],q$o=q$D[q$C+8],q$$=q$D[q$C+12],q$H[q$C+q$L]=q$G*q$T[0]+q$t*q$T[1]+q$o*q$T[2]+q$$*q$T[3],q$H[q$C+q$L+4]=q$G*q$T[4]+q$t*q$T[5]+q$o*q$T[6]+q$$*q$T[7],q$H[q$C+q$L+8]=q$G*q$T[8]+q$t*q$T[9]+q$o*q$T[10]+q$$*q$T[11],q$H[q$C+q$L+12]=q$G*q$T[12]+q$t*q$T[13]+q$o*q$T[14]+q$$*q$T[15]},q$u._createNodeByJson=function(q$S,q$_,q$a,q$R){if(!q$a)switch(q$_.type){case"Sprite3D":q$a=new q$P_;break;case"MeshSprite3D":q$a=new q$c_;break;case"SkinnedMeshSprite3D":q$a=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":q$a=new ShuriKenParticle3D;break;case"TrailSprite3D":q$a=new TrailSprite3D;break;case"Terrain":q$a=new Terrain;break;case"Camera":q$a=new q$p_;break;case"DirectionLight":q$a=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var q$J=q$_.props;if(q$J)for(var q$V in q$J)q$a[q$V]=q$J[q$V];var q$W=q$_.customProps;q$W&&(q$a instanceof laya.d3.core.Sprite3D?(q$a._parseBaseCustomProps(q$W),q$a._parseCustomProps(q$S,q$R,q$W,q$_),q$a._parseCustomComponent(q$S,q$R,q$_.components)):q$a._parseCustomProps(q$S,q$R,q$W,q$_));var q$k=q$_.child;if(q$k)for(var q$z=0,q$b=q$k.length;q$z<q$b;q$z++){var q$H=q$u._createNodeByJson(q$S,q$k[q$z],null,q$R);q$a.addChild(q$H)}return q$a},q$u._computeBoneAndAnimationDatasByBindPoseMatrxix=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W,q$k,q$z=0,q$b=0,q$H=q$S.length;for(q$W=0;q$W<q$H;q$z+=q$S[q$W].keyframeWidth,q$b+=16,q$W++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(q$_[q$z+0],q$_[q$z+1],q$_[q$z+2],q$_[q$z+3],q$_[q$z+4],q$_[q$z+5],q$_[q$z+6],q$_[q$z+7],q$_[q$z+8],q$_[q$z+9],q$R,q$b),0!=q$W&&(q$k=16*q$S[q$W].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(q$R,q$k,q$R,q$b,q$R,q$b));var q$L=q$a.length;for(q$W=0;q$W<q$L;q$W++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(q$R,16*q$V[q$W],q$a[q$W],q$J,16*q$W)},q$u._computeAnimationDatasByArrayAndMatrixFast=function(q$S,q$_,q$a,q$R){for(var q$J=0,q$V=q$S.length;q$J<q$V;q$J++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(q$_,16*q$R[q$J],q$S[q$J],q$a,16*q$J)},q$u._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(q$S,q$_,q$a,q$R,q$J){var q$V,q$W,q$k=0,q$z=0,q$b=q$S.length;for(q$V=0;q$V<q$b;q$k+=q$S[q$V].keyframeWidth,q$z+=16,q$V++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(q$_[q$k+7],q$_[q$k+8],q$_[q$k+9],q$_[q$k+3],q$_[q$k+4],q$_[q$k+5],q$_[q$k+6],q$_[q$k+0],q$_[q$k+1],q$_[q$k+2],q$R,q$z),0!=q$V&&(q$W=16*q$S[q$V].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(q$R,q$W,q$R,q$z,q$R,q$z));var q$H=q$a.length;for(q$V=0;q$V<q$H;q$V++){var q$L=16*q$V;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(q$R,q$L,q$a[q$V],q$J,q$L)}},q$u._computeAnimationDatasByArrayAndMatrixFastOld=function(q$S,q$_,q$a){for(var q$R=q$S.length,q$J=0;q$J<q$R;q$J++){var q$V=16*q$J;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(q$_,q$V,q$S[q$J],q$a,q$V)}},q$u._computeRootAnimationData=function(q$S,q$_,q$a){for(var q$R=0,q$J=0,q$V=0,q$W=q$S.length;q$R<q$W;q$J+=q$S[q$R].keyframeWidth,q$V+=16,q$R++)laya.d3.utils.Utils3D.createAffineTransformationArray(q$_[q$J+0],q$_[q$J+1],q$_[q$J+2],q$_[q$J+3],q$_[q$J+4],q$_[q$J+5],q$_[q$J+6],q$_[q$J+7],q$_[q$J+8],q$_[q$J+9],q$a,q$V)},q$u.transformVector3ArrayByQuat=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$a.elements,q$W=q$S[q$_],q$k=q$S[q$_+1],q$z=q$S[q$_+2],q$b=q$V[0],q$H=q$V[1],q$L=q$V[2],q$C=q$V[3],q$G=q$C*q$W+q$H*q$z-q$L*q$k,q$t=q$C*q$k+q$L*q$W-q$b*q$z,q$o=q$C*q$z+q$b*q$k-q$H*q$W,q$$=-q$b*q$W-q$H*q$k-q$L*q$z;q$R[q$J]=q$G*q$C+q$$*-q$b+q$t*-q$L-q$o*-q$H,q$R[q$J+1]=q$t*q$C+q$$*-q$H+q$o*-q$b-q$G*-q$L,q$R[q$J+2]=q$o*q$C+q$$*-q$L+q$G*-q$H-q$t*-q$b},q$u.mulMatrixByArray=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W,q$k,q$z,q$b,q$H;if(q$J===q$a){for(q$a=q$u._tempArray16_3,q$W=0;q$W<16;++q$W)q$a[q$W]=q$J[q$V+q$W];q$R=0}for(q$W=0;q$W<4;q$W++)q$k=q$S[q$_+q$W],q$z=q$S[q$_+q$W+4],q$b=q$S[q$_+q$W+8],q$H=q$S[q$_+q$W+12],q$J[q$V+q$W]=q$k*q$a[q$R+0]+q$z*q$a[q$R+1]+q$b*q$a[q$R+2]+q$H*q$a[q$R+3],q$J[q$V+q$W+4]=q$k*q$a[q$R+4]+q$z*q$a[q$R+5]+q$b*q$a[q$R+6]+q$H*q$a[q$R+7],q$J[q$V+q$W+8]=q$k*q$a[q$R+8]+q$z*q$a[q$R+9]+q$b*q$a[q$R+10]+q$H*q$a[q$R+11],q$J[q$V+q$W+12]=q$k*q$a[q$R+12]+q$z*q$a[q$R+13]+q$b*q$a[q$R+14]+q$H*q$a[q$R+15]},q$u.mulMatrixByArrayFast=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W,q$k,q$z,q$b,q$H;for(q$W=0;q$W<4;q$W++)q$k=q$S[q$_+q$W],q$z=q$S[q$_+q$W+4],q$b=q$S[q$_+q$W+8],q$H=q$S[q$_+q$W+12],q$J[q$V+q$W]=q$k*q$a[q$R+0]+q$z*q$a[q$R+1]+q$b*q$a[q$R+2]+q$H*q$a[q$R+3],q$J[q$V+q$W+4]=q$k*q$a[q$R+4]+q$z*q$a[q$R+5]+q$b*q$a[q$R+6]+q$H*q$a[q$R+7],q$J[q$V+q$W+8]=q$k*q$a[q$R+8]+q$z*q$a[q$R+9]+q$b*q$a[q$R+10]+q$H*q$a[q$R+11],q$J[q$V+q$W+12]=q$k*q$a[q$R+12]+q$z*q$a[q$R+13]+q$b*q$a[q$R+14]+q$H*q$a[q$R+15]},q$u.mulMatrixByArrayAndMatrixFast=function(q$S,q$_,q$a,q$R,q$J){var q$V,q$W,q$k,q$z,q$b,q$H=q$a.elements,q$L=q$H[0],q$C=q$H[1],q$G=q$H[2],q$t=q$H[3],q$o=q$H[4],q$$=q$H[5],q$F=q$H[6],q$T=q$H[7],q$D=q$H[8],q$j=q$H[9],q$Q=q$H[10],q$m=q$H[11],q$q=q$H[12],q$N=q$H[13],q$n=q$H[14],q$l=q$H[15],q$B=q$_,q$I=q$_+4,q$A=q$_+8,q$X=q$_+12,q$h=q$J,q$u=q$J+4,q$K=q$J+8,q$P=q$J+12;for(q$V=0;q$V<4;q$V++)q$W=q$S[q$B+q$V],q$k=q$S[q$I+q$V],q$z=q$S[q$A+q$V],q$b=q$S[q$X+q$V],q$R[q$h+q$V]=q$W*q$L+q$k*q$C+q$z*q$G+q$b*q$t,q$R[q$u+q$V]=q$W*q$o+q$k*q$$+q$z*q$F+q$b*q$T,q$R[q$K+q$V]=q$W*q$D+q$k*q$j+q$z*q$Q+q$b*q$m,q$R[q$P+q$V]=q$W*q$q+q$k*q$N+q$z*q$n+q$b*q$l},q$u.createAffineTransformationArray=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$L){var q$C=q$R+q$R,q$G=q$J+q$J,q$t=q$V+q$V,q$o=q$R*q$C,q$$=q$R*q$G,q$F=q$R*q$t,q$T=q$J*q$G,q$D=q$J*q$t,q$j=q$V*q$t,q$Q=q$W*q$C,q$m=q$W*q$G,q$q=q$W*q$t;q$H[q$L+0]=(1-(q$T+q$j))*q$k,q$H[q$L+1]=(q$$+q$q)*q$k,q$H[q$L+2]=(q$F-q$m)*q$k,q$H[q$L+3]=0,q$H[q$L+4]=(q$$-q$q)*q$z,q$H[q$L+5]=(1-(q$o+q$j))*q$z,q$H[q$L+6]=(q$D+q$Q)*q$z,q$H[q$L+7]=0,q$H[q$L+8]=(q$F+q$m)*q$b,q$H[q$L+9]=(q$D-q$Q)*q$b,q$H[q$L+10]=(1-(q$o+q$T))*q$b,q$H[q$L+11]=0,q$H[q$L+12]=q$S,q$H[q$L+13]=q$_,q$H[q$L+14]=q$a,q$H[q$L+15]=1},q$u.transformVector3ArrayToVector3ArrayCoordinate=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$u._tempArray4_0,q$W=q$S[q$_+0],q$k=q$S[q$_+1],q$z=q$S[q$_+2],q$b=q$a.elements;q$V[0]=q$W*q$b[0]+q$k*q$b[4]+q$z*q$b[8]+q$b[12],q$V[1]=q$W*q$b[1]+q$k*q$b[5]+q$z*q$b[9]+q$b[13],q$V[2]=q$W*q$b[2]+q$k*q$b[6]+q$z*q$b[10]+q$b[14],q$V[3]=1/(q$W*q$b[3]+q$k*q$b[7]+q$z*q$b[11]+q$b[15]),q$R[q$J+0]=q$V[0]*q$V[3],q$R[q$J+1]=q$V[1]*q$V[3],q$R[q$J+2]=q$V[2]*q$V[3]},q$u.transformLightingMapTexcoordByUV0Array=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$a.elements;q$R[q$J+0]=q$S[q$_+0]*q$V[0]+q$V[2],q$R[q$J+1]=(q$S[q$_+1]-1)*q$V[1]+q$V[3]},q$u.transformLightingMapTexcoordByUV1Array=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$a.elements;q$R[q$J+0]=q$S[q$_+0]*q$V[0]+q$V[2],q$R[q$J+1]=1+q$S[q$_+1]*q$V[1]+q$V[3]},q$u.getURLVerion=function(q$S){var q$_=q$S.indexOf("?");return 0<=q$_?q$S.substr(q$_):null},q$u._quaternionCreateFromYawPitchRollArray=function(q$S,q$_,q$a,q$R){var q$J=.5*q$a,q$V=.5*q$_,q$W=.5*q$S,q$k=Math.sin(q$J),q$z=Math.cos(q$J),q$b=Math.sin(q$V),q$H=Math.cos(q$V),q$L=Math.sin(q$W),q$C=Math.cos(q$W);q$R[0]=q$C*q$b*q$z+q$L*q$H*q$k,q$R[1]=q$L*q$H*q$z-q$C*q$b*q$k,q$R[2]=q$C*q$H*q$k-q$L*q$b*q$z,q$R[3]=q$C*q$H*q$z+q$L*q$b*q$k},q$u._createAffineTransformationArray=function(q$S,q$_,q$a,q$R){var q$J=q$_[0],q$V=q$_[1],q$W=q$_[2],q$k=q$_[3],q$z=q$J+q$J,q$b=q$V+q$V,q$H=q$W+q$W,q$L=q$J*q$z,q$C=q$J*q$b,q$G=q$J*q$H,q$t=q$V*q$b,q$o=q$V*q$H,q$$=q$W*q$H,q$F=q$k*q$z,q$T=q$k*q$b,q$D=q$k*q$H,q$j=q$a[0],q$Q=q$a[1],q$m=q$a[2];q$R[0]=(1-(q$t+q$$))*q$j,q$R[1]=(q$C+q$D)*q$j,q$R[2]=(q$G-q$T)*q$j,q$R[3]=0,q$R[4]=(q$C-q$D)*q$Q,q$R[5]=(1-(q$L+q$$))*q$Q,q$R[6]=(q$o+q$F)*q$Q,q$R[7]=0,q$R[8]=(q$G+q$T)*q$m,q$R[9]=(q$o-q$F)*q$m,q$R[10]=(1-(q$L+q$t))*q$m,q$R[11]=0,q$R[12]=q$S[0],q$R[13]=q$S[1],q$R[14]=q$S[2],q$R[15]=1},q$u._mulMatrixArray=function(q$S,q$_,q$a,q$R){var q$J,q$V,q$W,q$k,q$z,q$b=q$_.elements,q$H=q$b[0],q$L=q$b[1],q$C=q$b[2],q$G=q$b[3],q$t=q$b[4],q$o=q$b[5],q$$=q$b[6],q$F=q$b[7],q$T=q$b[8],q$D=q$b[9],q$j=q$b[10],q$Q=q$b[11],q$m=q$b[12],q$q=q$b[13],q$N=q$b[14],q$n=q$b[15],q$l=q$R,q$B=q$R+4,q$I=q$R+8,q$A=q$R+12;for(q$J=0;q$J<4;q$J++)q$V=q$S[q$J],q$W=q$S[q$J+4],q$k=q$S[q$J+8],q$z=q$S[q$J+12],q$a[q$l+q$J]=q$V*q$H+q$W*q$L+q$k*q$C+q$z*q$G,q$a[q$B+q$J]=q$V*q$t+q$W*q$o+q$k*q$$+q$z*q$F,q$a[q$I+q$J]=q$V*q$T+q$W*q$D+q$k*q$j+q$z*q$Q,q$a[q$A+q$J]=q$V*q$m+q$W*q$q+q$k*q$N+q$z*q$n},q$u.getYawPitchRoll=function(q$S,q$_){q$u.transformQuat(q$W_.ForwardRH,q$S,q$a_.TEMPVector31),q$u.transformQuat(q$W_.Up,q$S,q$a_.TEMPVector32);var q$a=q$a_.TEMPVector32.elements;q$u.angleTo(q$W_.ZERO,q$a_.TEMPVector31,q$a_.TEMPVector33);var q$R=q$a_.TEMPVector33.elements;q$R[0]==Math.PI/2?(q$R[1]=q$u.arcTanAngle(q$a[2],q$a[0]),q$R[2]=0):q$R[0]==-Math.PI/2?(q$R[1]=q$u.arcTanAngle(-q$a[2],-q$a[0]),q$R[2]=0):(q$S_.createRotationY(-q$R[1],q$a_.TEMPMatrix0),q$S_.createRotationX(-q$R[0],q$a_.TEMPMatrix1),q$W_.transformCoordinate(q$a_.TEMPVector32,q$a_.TEMPMatrix0,q$a_.TEMPVector32),q$W_.transformCoordinate(q$a_.TEMPVector32,q$a_.TEMPMatrix1,q$a_.TEMPVector32),q$R[2]=q$u.arcTanAngle(q$a[1],-q$a[0])),q$R[1]<=-Math.PI&&(q$R[1]=Math.PI),q$R[2]<=-Math.PI&&(q$R[2]=Math.PI),q$R[1]>=Math.PI&&q$R[2]>=Math.PI&&(q$R[1]=0,q$R[2]=0,q$R[0]=Math.PI-q$R[0]),q$_[0]=q$R[1],q$_[1]=q$R[0],q$_[2]=q$R[2]},q$u.arcTanAngle=function(q$S,q$_){return 0==q$S?1==q$_?Math.PI/2:-Math.PI/2:0<q$S?Math.atan(q$_/q$S):q$S<0?0<q$_?Math.atan(q$_/q$S)+Math.PI:Math.atan(q$_/q$S)-Math.PI:0},q$u.angleTo=function(q$S,q$_,q$a){q$W_.subtract(q$_,q$S,q$a_.TEMPVector30),q$W_.normalize(q$a_.TEMPVector30,q$a_.TEMPVector30),q$a.elements[0]=Math.asin(q$a_.TEMPVector30.y),q$a.elements[1]=q$u.arcTanAngle(-q$a_.TEMPVector30.z,-q$a_.TEMPVector30.x)},q$u.transformQuat=function(q$S,q$_,q$a){var q$R=q$a.elements,q$J=q$S.elements,q$V=q$_,q$W=q$J[0],q$k=q$J[1],q$z=q$J[2],q$b=q$V[0],q$H=q$V[1],q$L=q$V[2],q$C=q$V[3],q$G=q$C*q$W+q$H*q$z-q$L*q$k,q$t=q$C*q$k+q$L*q$W-q$b*q$z,q$o=q$C*q$z+q$b*q$k-q$H*q$W,q$$=-q$b*q$W-q$H*q$k-q$L*q$z;q$R[0]=q$G*q$C+q$$*-q$b+q$t*-q$L-q$o*-q$H,q$R[1]=q$t*q$C+q$$*-q$H+q$o*-q$b-q$G*-q$L,q$R[2]=q$o*q$C+q$$*-q$L+q$G*-q$H-q$t*-q$b},q$u.quaterionNormalize=function(q$S,q$_){var q$a=q$S[0],q$R=q$S[1],q$J=q$S[2],q$V=q$S[3],q$W=q$a*q$a+q$R*q$R+q$J*q$J+q$V*q$V;0<q$W&&(q$W=1/Math.sqrt(q$W),q$_[0]=q$a*q$W,q$_[1]=q$R*q$W,q$_[2]=q$J*q$W,q$_[3]=q$V*q$W)},q$u.matrix4x4MultiplyFFF=function(q$S,q$_,q$a){var q$R,q$J,q$V,q$W,q$k;if(q$a===q$_)for(q$_=new Float32Array(16),q$R=0;q$R<16;++q$R)q$_[q$R]=q$a[q$R];for(q$R=0;q$R<4;q$R++)q$J=q$S[q$R],q$V=q$S[q$R+4],q$W=q$S[q$R+8],q$k=q$S[q$R+12],q$a[q$R]=q$J*q$_[0]+q$V*q$_[1]+q$W*q$_[2]+q$k*q$_[3],q$a[q$R+4]=q$J*q$_[4]+q$V*q$_[5]+q$W*q$_[6]+q$k*q$_[7],q$a[q$R+8]=q$J*q$_[8]+q$V*q$_[9]+q$W*q$_[10]+q$k*q$_[11],q$a[q$R+12]=q$J*q$_[12]+q$V*q$_[13]+q$W*q$_[14]+q$k*q$_[15]},q$u.matrix4x4MultiplyMFM=function(q$S,q$_,q$a){q$u.matrix4x4MultiplyFFF(q$S.elements,q$_,q$a.elements)},q$L(q$u,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new q$W_},"_tempVector3_1",function(){return this._tempVector3_1=new q$W_},"_tempVector3_2",function(){return this._tempVector3_2=new q$W_},"_tempVector3_3",function(){return this._tempVector3_3=new q$W_},"_tempVector3_4",function(){return this._tempVector3_4=new q$W_},"_tempVector3_5",function(){return this._tempVector3_5=new q$W_},"_tempVector3_6",function(){return this._tempVector3_6=new q$W_},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),q$u}(),q$F_=function(){function q$X(){}return q$G(q$X,"Laya3D"),q$X._cancelLoadByUrl=function(q$S){q$Q.loader.cancelLoadByUrl(q$S),q$X._innerFirstLevelLoaderManager.cancelLoadByUrl(q$S),q$X._innerSecondLevelLoaderManager.cancelLoadByUrl(q$S),q$X._innerThirdLevelLoaderManager.cancelLoadByUrl(q$S),q$X._innerFourthLevelLoaderManager.cancelLoadByUrl(q$S)},q$X._changeWebGLSize=function(q$S,q$_){q$A.onStageResize(q$S,q$_),q$y.clientWidth=q$S,q$y.clientHeight=q$_},q$X.__init__=function(){var q$S=q$_.createMap;q$S.lh=[q$P_,"SPRITE3DHIERARCHY"],q$S.ls=[q$K_,"SPRITE3DHIERARCHY"],q$S.lm=[q$U_,"MESH"],q$S.lmat=[q$r_,"MATERIAL"],q$S.jpg=[q$Y_,"nativeimage"],q$S.jpeg=[q$Y_,"nativeimage"],q$S.png=[q$Y_,"nativeimage"],q$S.pkm=[q$Y_,"arraybuffer"],q$S.raw=[q$x_,"arraybuffer"],q$S.mipmaps=[q$x_,"arraybuffer"],q$F.parserMap.SPRITE3DHIERARCHY=q$X._loadHierarchy,q$F.parserMap.MESH=q$X._loadMesh,q$F.parserMap.MATERIAL=q$X._loadMaterial,q$F.parserMap.TEXTURECUBE=q$X._loadTextureCube,q$F.parserMap.TERRAIN=q$X._loadTerrain,q$X._innerFirstLevelLoaderManager.on("error",null,q$X._eventLoadManagerError),q$X._innerSecondLevelLoaderManager.on("error",null,q$X._eventLoadManagerError),q$X._innerThirdLevelLoaderManager.on("error",null,q$X._eventLoadManagerError),q$X._innerFourthLevelLoaderManager.on("error",null,q$X._eventLoadManagerError)},q$X.READ_BLOCK=function(){return q$X._readData.pos+=4,!0},q$X.READ_DATA=function(){return q$X._DATA.offset=q$X._readData.getUint32(),q$X._DATA.size=q$X._readData.getUint32(),!0},q$X.READ_STRINGS=function(){var q$S=[],q$_={offset:0,size:0};q$_.offset=q$X._readData.getUint16(),q$_.size=q$X._readData.getUint16();q$X._readData.pos;q$X._readData.pos=q$_.offset+q$X._DATA.offset;for(var q$a=0;q$a<q$_.size;q$a++){var q$R=q$X._readData.readUTFString();-1===q$R.lastIndexOf(".lmat")&&-1===q$R.lastIndexOf(".lpbr")||q$S.push(q$R)}return q$S},q$X.formatRelativePath=function(q$S,q$_){var q$a;if("."===q$_.charAt(0)){for(var q$R=(q$S+q$_).split("/"),q$J=0,q$V=q$R.length;q$J<q$V;q$J++)if(".."==q$R[q$J]){var q$W=q$J-1;0<q$W&&".."!==q$R[q$W]&&(q$R.splice(q$W,2),q$J-=2)}q$a=q$R.join("/")}else q$a=q$S+q$_;return null!=q$I.customFormat&&(q$a=q$I.customFormat(q$a,null)),q$a},q$X._eventLoadManagerError=function(q$S){q$Q.loader.event("error",q$S)},q$X._addHierarchyInnerUrls=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W=q$X.formatRelativePath(q$R,q$J);q$a&&(q$W+=q$a),q$S.push({url:q$W,clas:q$V}),q$_[q$J]=q$W},q$X._getSprite3DHierarchyInnerUrls=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){var q$k,q$z=0,q$b=0;switch(q$S.type){case"Scene":var q$H=q$S.customProps.lightmaps;for(q$z=0,q$b=q$H.length;q$z<q$b;q$z++){var q$L=q$H[q$z].replace(".exr",".png");q$X._addHierarchyInnerUrls(q$R,q$J,q$V,q$W,q$L,q$Y_)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var q$C;if(q$S.instanceParams)(q$C=q$S.instanceParams.loadPath)&&q$X._addHierarchyInnerUrls(q$_,q$J,q$V,q$W,q$C,q$U_);else{(q$C=(q$k=q$S.customProps).meshPath)&&q$X._addHierarchyInnerUrls(q$_,q$J,q$V,q$W,q$C,q$U_);var q$G=q$k.materials;if(q$G)for(q$z=0,q$b=q$G.length;q$z<q$b;q$z++){for(var q$t=q$G[q$z],q$o=q$t.type.split("."),q$$=q$h.window,q$F=0,q$T=q$o.length;q$F<q$T;++q$F){q$$=q$$[this.clasPaths[q$F]]}if("function"!=typeof q$$)throw"_getSprite3DHierarchyInnerUrls 错误: "+q$t.type+" 不是类";q$X._addHierarchyInnerUrls(q$a,q$J,q$V,q$W,q$t.path,q$$)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var q$D=(q$k=q$S.customProps).meshPath;q$D&&q$X._addHierarchyInnerUrls(q$_,q$J,q$V,q$W,q$D,q$U_);var q$j=q$k.material;if(q$j){q$o=q$j.type.split("."),q$$=q$h.window;for(q$F=0,q$T=q$o.length;q$F<q$T;++q$F){q$$=q$$[this.clasPaths[q$F]]}q$X._addHierarchyInnerUrls(q$a,q$J,q$V,q$W,q$j.path,q$$)}else{var q$Q=q$k.materialPath;if(q$Q)q$X._addHierarchyInnerUrls(q$a,q$J,q$V,q$W,q$Q,ShurikenParticleMaterial);else{var q$m=q$k.texturePath;q$m&&q$X._addHierarchyInnerUrls(q$R,q$J,q$V,q$W,q$m,q$Y_)}}break;case"Terrain":q$X._addHierarchyInnerUrls(q$R,q$J,q$V,q$W,q$S.customProps.dataPath,TerrainRes)}var q$q=q$S.components;for(var q$N in q$q){var q$n=q$q[q$N];switch(q$N){case"Animator":var q$l=q$n.avatarPath;if(q$l)q$X._addHierarchyInnerUrls(q$R,q$J,q$V,q$W,q$l,Avatar);else{var q$B=q$n.avatar;q$B&&q$X._addHierarchyInnerUrls(q$R,q$J,q$V,q$W,q$B.path,Avatar)}var q$I=q$n.clipPaths;for(q$z=0,q$b=q$I.length;q$z<q$b;q$z++)q$X._addHierarchyInnerUrls(q$R,q$J,q$V,q$W,q$I[q$z],AnimationClip)}}var q$A=q$S.child;for(q$z=0,q$b=q$A.length;q$z<q$b;q$z++)q$X._getSprite3DHierarchyInnerUrls(q$A[q$z],q$_,q$a,q$R,q$J,q$V,q$W)},q$X._loadHierarchy=function(q$S){q$S.on("loaded",null,q$X._onHierarchylhLoaded,[q$S,q$S._class._getGroup()]),q$S.load(q$S.url,"json",!1,null,!0)},q$X._onHierarchylhLoaded=function(q$S,q$_,q$a){if(q$S._class.destroyed)q$S.endLoad();else{var q$R=q$S.url,q$J=q$$_.getURLVerion(q$R),q$V=q$I.getPath(q$R),q$W=[],q$k=[],q$z=[],q$b={};q$X._getSprite3DHierarchyInnerUrls(q$a,q$W,q$k,q$z,q$b,q$J,q$V);var q$H=q$W.length+q$k.length+q$z.length,q$L=q$H+1,q$C=1/q$L;if(q$X._onProcessChange(q$S,0,q$C,1),0<q$z.length){var q$G=q$H/q$L,q$t=q$B.create(null,q$X._onProcessChange,[q$S,q$C,q$G],!1);q$X._innerFourthLevelLoaderManager.create(q$z,q$B.create(null,q$X._onHierarchyInnerForthLevResouLoaded,[q$S,q$_,q$t,q$a,q$b,q$W,q$k,q$C+q$G*q$z.length,q$G]),q$t,null,null,1,!0,q$_)}else q$X._onHierarchyInnerForthLevResouLoaded(q$S,q$_,null,q$a,q$b,q$W,q$k,q$C,q$G)}},q$X._onHierarchyInnerForthLevResouLoaded=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){if(q$S._class.destroyed)q$S.endLoad();else if(q$a&&q$a.recover(),0<q$W.length){var q$b=q$B.create(null,q$X._onProcessChange,[q$S,q$k,q$z],!1);q$X._innerSecondLevelLoaderManager.create(q$W,q$B.create(null,q$X._onHierarchyInnerSecondLevResouLoaded,[q$S,q$_,q$b,q$R,q$J,q$V,q$k+q$z*q$W.length,q$z]),q$a,null,null,1,!0,q$_)}else q$X._onHierarchyInnerSecondLevResouLoaded(q$S,q$_,null,q$R,q$J,q$V,q$k,q$z)},q$X._onHierarchyInnerSecondLevResouLoaded=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k){if(q$S._class.destroyed)q$S.endLoad();else if(q$a&&q$a.recover(),0<q$V.length){var q$z=q$B.create(null,q$X._onProcessChange,[q$S,q$W,q$k],!1);q$X._innerFirstLevelLoaderManager.create(q$V,q$B.create(null,q$X._onHierarchyInnerFirstLevResouLoaded,[q$S,q$z,q$R,q$J]),q$a,null,null,1,!0,q$_)}else q$X._onHierarchyInnerFirstLevResouLoaded(q$S,null,q$R,q$J)},q$X._onHierarchyInnerFirstLevResouLoaded=function(q$S,q$_,q$a,q$R){q$_&&q$_.recover(),q$S.endLoad([q$a,q$R])},q$X._loadTerrain=function(q$S){q$S.on("loaded",null,q$X._onTerrainLtLoaded,[q$S,q$S._class._getGroup()]),q$S.load(q$S.url,"json",!1,null,!0)},q$X._onTerrainLtLoaded=function(q$S,q$_,q$a){if(q$S._class.destroyed)q$S.endLoad();else{var q$R,q$J,q$V=q$S.url,q$W=q$$_.getURLVerion(q$V),q$k=q$I.getPath(q$V),q$z=[],q$b={},q$H=0,q$L=0,q$C=q$a.heightData;q$R=q$C.url,q$J=q$X.formatRelativePath(q$k,q$R),q$W&&(q$J+=q$W),q$R=q$b[q$R]=q$J;var q$G=q$a.detailTexture;for(q$H=0,q$L=q$G.length;q$H<q$L;q$H++)q$z.push({url:q$G[q$H].diffuse});var q$t=q$a.normalMap;for(q$H=0,q$L=q$t.length;q$H<q$L;q$H++)q$z.push({url:q$t[q$H]});var q$o=q$a.alphaMap;for(q$H=0,q$L=q$o.length;q$H<q$L;q$H++)q$z.push({url:q$o[q$H],params:[!1,!1,6408,!0]});for(q$H=0,q$L=q$z.length;q$H<q$L;q$H++){var q$$=q$z[q$H].url;q$J=q$X.formatRelativePath(q$k,q$$),q$W&&(q$J+=q$W),q$z[q$H].url=q$J,q$b[q$$]=q$J}var q$F=q$z.length,q$T=q$F+2,q$D=1/q$T;q$X._onProcessChange(q$S,0,q$D,1);var q$j={heightMapLoaded:!1,texturesLoaded:!1},q$Q=q$B.create(null,q$X._onProcessChange,[q$S,q$D,q$D],!1);q$X._innerFourthLevelLoaderManager.create(q$R,q$B.create(null,q$X._onTerrainHeightMapLoaded,[q$S,q$Q,q$a,q$b,q$j]),q$Q,null,[q$C.numX,q$C.numZ,q$C.bitType,q$C.value],1,!0,q$_);var q$m=q$B.create(null,q$X._onProcessChange,[q$S,2*q$D,q$F/q$T],!1);q$X._innerFourthLevelLoaderManager.create(q$z,q$B.create(null,q$X._onTerrainTexturesLoaded,[q$S,q$m,q$a,q$b,q$j]),q$m,null,null,1,!0,q$_)}},q$X._onTerrainHeightMapLoaded=function(q$S,q$_,q$a,q$R,q$J){q$J.heightMapLoaded=!0,q$J.texturesLoaded&&(q$S.endLoad([q$a,q$R]),q$_.recover())},q$X._onTerrainTexturesLoaded=function(q$S,q$_,q$a,q$R,q$J){q$J.texturesLoaded=!0,q$J.heightMapLoaded&&(q$S.endLoad([q$a,q$R]),q$_.recover())},q$X._loadMesh=function(q$S){q$S.on("loaded",null,q$X._onMeshLmLoaded,[q$S,q$S._class._getGroup()]),q$S.load(q$S.url,"arraybuffer",!1,null,!0)},q$X._onMeshLmLoaded=function(q$S,q$_,q$a){if(q$S._class.destroyed)q$S.endLoad();else{var q$R,q$J,q$V,q$W=q$S.url,q$k=q$$_.getURLVerion(q$W),q$z=q$I.getPath(q$W),q$b={},q$H=0,q$L=0;switch((q$X._readData=new q$m(q$a)).pos=0,q$X._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var q$C=q$X._readData.getUint32();q$X._readData.pos=q$X._readData.pos+4,q$L=q$X._readData.getUint16(),q$X._readData.pos=q$X._readData.pos+8*q$L;var q$G=q$X._readData.getUint32();for(q$L=q$X._readData.getUint16(),q$X._readData.pos=q$C+q$G,q$R=[],q$H=0;q$H<q$L;q$H++){var q$t=q$X._readData.readUTFString();-1!==q$t.lastIndexOf(".lmat")&&q$R.push(q$t)}break;default:for(q$X.READ_BLOCK(),q$H=0;q$H<2;q$H++){var q$o=q$X._readData.getUint16(),q$$=q$X._strings[q$o],q$F=q$X["READ_"+q$$];if(null==q$F)throw new Error("model file err,no this function:"+q$o+" "+q$$);1===q$H?q$R=q$F.call():q$F.call()}}for(q$H=0,q$V=q$R.length;q$H<q$V;q$H++){var q$T=q$R[q$H];q$J=q$X.formatRelativePath(q$z,q$T),q$k&&(q$J+=q$k),q$R[q$H]=q$J,q$b[q$T]=q$J}if(0<q$R.length){q$X._onProcessChange(q$S,0,.5,1);var q$D=q$B.create(null,q$X._onProcessChange,[q$S,.5,.5],!1);q$X._innerSecondLevelLoaderManager.create(q$R,q$B.create(null,q$X._onMeshMateialLoaded,[q$S,q$D,q$a,q$b]),q$D,null,null,1,!0,q$_)}else q$S.endLoad([q$a,q$b])}},q$X._onMeshMateialLoaded=function(q$S,q$_,q$a,q$R){q$S.endLoad([q$a,q$R]),q$_.recover()},q$X._getMaterialTexturePath=function(q$S,q$_,q$a){var q$R=q$S.length-4;return q$S.indexOf(".dds")!=q$R&&q$S.indexOf(".tga")!=q$R&&q$S.indexOf(".exr")!=q$R&&q$S.indexOf(".DDS")!=q$R&&q$S.indexOf(".TGA")!=q$R&&q$S.indexOf(".EXR")!=q$R||(q$S=q$S.substr(0,q$R)+".png"),q$S=q$X.formatRelativePath(q$a,q$S),q$_&&(q$S+=q$_),q$S},q$X._loadMaterial=function(q$S){q$S.on("loaded",null,q$X._onMaterilLmatLoaded,[q$S,q$S._class._getGroup()]),q$S.load(q$S.url,"json",!1,null,!0)},q$X._onMaterilLmatLoaded=function(q$S,q$_,q$a){if(q$S._class.destroyed)q$S.endLoad();else{var q$R,q$J=q$S.url,q$V=q$$_.getURLVerion(q$J),q$W=q$I.getPath(q$J),q$k=[],q$z={},q$b=q$a.customProps,q$H=q$a.version;if(q$H)switch(q$H){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var q$L=q$a.props.textures,q$C=0,q$G=q$L.length;q$C<q$G;q$C++){var q$t=q$L[q$C],q$o=q$t.path;if(q$o){var q$$=q$o.length-4;q$o.indexOf(".exr")!=q$$&&q$o.indexOf(".EXR")!=q$$||(q$o=q$o.substr(0,q$$)+".png"),q$R=q$X.formatRelativePath(q$W,q$o),q$V&&(q$R+=q$V),q$k.push({url:q$R,params:q$t.params}),q$z[q$o]=q$R}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var q$F=q$b.diffuseTexture.texture2D;if(q$F&&(q$R=q$X._getMaterialTexturePath(q$F,q$V,q$W),q$k.push(q$R),q$z[q$F]=q$R),q$b.normalTexture){var q$T=q$b.normalTexture.texture2D;q$T&&(q$R=q$X._getMaterialTexturePath(q$T,q$V,q$W),q$k.push(q$R),q$z[q$T]=q$R)}if(q$b.specularTexture){var q$D=q$b.specularTexture.texture2D;q$D&&(q$R=q$X._getMaterialTexturePath(q$D,q$V,q$W),q$k.push(q$R),q$z[q$D]=q$R)}if(q$b.emissiveTexture){var q$j=q$b.emissiveTexture.texture2D;q$j&&(q$R=q$X._getMaterialTexturePath(q$j,q$V,q$W),q$k.push(q$R),q$z[q$j]=q$R)}if(q$b.ambientTexture){var q$Q=q$b.ambientTexture.texture2D;q$Q&&(q$R=q$X._getMaterialTexturePath(q$Q,q$V,q$W),q$k.push(q$R),q$z[q$Q]=q$R)}if(q$b.reflectTexture){var q$m=q$b.reflectTexture.texture2D;q$m&&(q$R=q$X._getMaterialTexturePath(q$m,q$V,q$W),q$k.push(q$R),q$z[q$m]=q$R)}}var q$q=q$k.length,q$N=q$q+1,q$n=1/q$N;if(q$X._onProcessChange(q$S,0,q$n,1),0<q$q){var q$l=q$B.create(null,q$X._onProcessChange,[q$S,q$n,q$q/q$N],!1);q$X._innerFourthLevelLoaderManager.create(q$k,q$B.create(null,q$X._onMateialTexturesLoaded,[q$S,q$l,q$a,q$z]),q$l,q$Y_,null,1,!0,q$_)}else q$X._onMateialTexturesLoaded(q$S,null,q$a,null)}},q$X._onMateialTexturesLoaded=function(q$S,q$_,q$a,q$R){q$S.endLoad([q$a,q$R]),q$_&&q$_.recover()},q$X._loadTextureCube=function(q$S){q$S.on("loaded",null,q$X._onTextureCubeLtcLoaded,[q$S]),q$S.load(q$S.url,"json",!1,null,!0)},q$X._onTextureCubeLtcLoaded=function(q$S,q$_){if(q$S._class.destroyed)q$S.endLoad();else{var q$a=q$I.getPath(q$S.url),q$R=[q$X.formatRelativePath(q$a,q$_.px),q$X.formatRelativePath(q$a,q$_.nx),q$X.formatRelativePath(q$a,q$_.py),q$X.formatRelativePath(q$a,q$_.ny),q$X.formatRelativePath(q$a,q$_.pz),q$X.formatRelativePath(q$a,q$_.nz)];q$X._onProcessChange(q$S,0,1/7,1);var q$J=q$B.create(null,q$X._onProcessChange,[q$S,1/7,6/7],!1);q$X._innerFourthLevelLoaderManager.load(q$R,q$B.create(null,q$X._onTextureCubeImagesLoaded,[q$S,q$R,q$J]),q$J,"nativeimage")}},q$X._onTextureCubeImagesLoaded=function(q$S,q$_,q$a){var q$R=[];q$R.length=6;for(var q$J=0;q$J<6;q$J++){var q$V=q$_[q$J];q$R[q$J]=q$F.getRes(q$V),q$F.clearRes(q$V)}q$S.endLoad(q$R),q$a.recover()},q$X._onProcessChange=function(q$S,q$_,q$a,q$R){(q$R=q$_+q$R*q$a)<1&&q$S.event("progress",q$R)},q$X.init=function(q$S,q$_,q$a,q$R,q$J,q$V){if(void 0===q$a&&(q$a=!1),void 0===q$R&&(q$R=!1),void 0===q$J&&(q$J=!0),void 0===q$V&&(q$V=!0),q$T.update3DLoop=function(){},q$T.cancelLoadByUrl=function(q$S){q$X._cancelLoadByUrl(q$S)},q$z.isAntialias=q$a,q$z.isAlpha=q$R,q$z.premultipliedAlpha=q$J,q$z.isStencil=q$V,!q$A.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");q$T.changeWebGLSize=q$X._changeWebGLSize,q$o.is3DMode=!0,q$Q.init(q$S,q$_),q$u.__init__(),q$L_.__init__(),q$c_.__init__(),q$s.__init__(),q$X.__init__(),q$W.maxTextureCount=2,(q$X.debugMode||q$E.debugMode)&&(q$X._debugPhasorSprite=new q$Z)},q$X.HIERARCHY="SPRITE3DHIERARCHY",q$X.MESH="MESH",q$X.MATERIAL="MATERIAL",q$X.PBRMATERIAL="PBRMTL",q$X.TEXTURECUBE="TEXTURECUBE",q$X.TERRAIN="TERRAIN",q$X._readData=null,q$X._debugPhasorSprite=null,q$X.debugMode=!1,q$L(q$X,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new q$_},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new q$_},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new q$_},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new q$_}]),q$X}(),q$T_=function(q$S){function q$J(q$S){q$J.__super.call(this),this._owner=q$S,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}q$G(q$J,"laya.d3.animation.AnimationTransform3D",q$V);var q$_=q$J.prototype;return q$_._getlocalMatrix=function(){return this._localUpdate&&(q$$_._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},q$_._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var q$S=0,q$_=this._childs.length;q$S<q$_;q$S++)this._childs[q$S]._onWorldTransform()}},q$_._setWorldMatrixAndUpdate=function(q$S){if(this._worldMatrix=q$S,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var q$_=this._getlocalMatrix(),q$a=0;q$a<16;++q$a)this._worldMatrix[q$a]=q$_[q$a];else q$$_.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},q$_._setWorldMatrixNoUpdate=function(q$S){this._worldMatrix=q$S},q$_._setWorldMatrixIgnoreUpdate=function(q$S){this._worldMatrix=q$S,this._worldUpdate=!1},q$_.getLocalPosition=function(){return this._localPosition},q$_.setLocalPosition=function(q$S){if(this._parent)this._localPosition=q$S,this._localUpdate=!0,this._onWorldTransform();else{var q$_=this._entity.owner._transform,q$a=this._entity.localPosition,q$R=q$a.elements;q$R[0]=q$S[0],q$R[1]=q$S[1],q$R[2]=q$S[2],q$_.localPosition=q$a}},q$_.getLocalRotation=function(){if(this._localQuaternionUpdate){var q$S=this._localRotationEuler;q$$_._quaternionCreateFromYawPitchRollArray(q$S[1]/q$J._angleToRandin,q$S[0]/q$J._angleToRandin,q$S[2]/q$J._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},q$_.setLocalRotation=function(q$S){if(this._parent)this._localRotation=q$S,q$$_.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var q$_=this._entity.owner._transform,q$a=this._entity.localRotation,q$R=q$a.elements;q$R[0]=q$S[0],q$R[1]=q$S[1],q$R[2]=q$S[2],q$R[3]=q$S[3],q$_.localRotation=q$a}},q$_.getLocalScale=function(){return this._localScale},q$_.setLocalScale=function(q$S){if(this._parent)this._localScale=q$S,this._localUpdate=!0,this._onWorldTransform();else{var q$_=this._entity.owner._transform,q$a=this._entity.localScale,q$R=q$a.elements;q$R[0]=q$S[0],q$R[1]=q$S[1],q$R[2]=q$S[2],q$_.localScale=q$a}},q$_.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){q$$_.getYawPitchRoll(this._localRotation,q$J._tempVector3);var q$S=q$J._tempVector3,q$_=this._localRotationEuler;q$_[0]=q$S[1]*q$J._angleToRandin,q$_[1]=q$S[0]*q$J._angleToRandin,q$_[2]=q$S[2]*q$J._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},q$_.setLocalRotationEuler=function(q$S){if(this._parent)q$$_._quaternionCreateFromYawPitchRollArray(q$S[1]/q$J._angleToRandin,q$S[0]/q$J._angleToRandin,q$S[2]/q$J._angleToRandin,this._localRotation),this._localRotationEuler=q$S,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var q$_=this._entity.owner._transform,q$a=this._entity.localRotationEuler,q$R=q$a.elements;q$R[0]=q$S[0],q$R[1]=q$S[1],q$R[2]=q$S[2],q$_.localRotationEuler=q$a}},q$_.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)q$$_.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var q$S=this._getlocalMatrix(),q$_=0;q$_<16;++q$_)this._worldMatrix[q$_]=q$S[q$_];this._worldUpdate=!1}return this._worldMatrix},q$_.setParent=function(q$S){if(this._parent!==q$S){if(this._parent){var q$_=this._parent._childs,q$a=q$_.indexOf(this);q$_.splice(q$a,1)}q$S&&(q$S._childs.push(this),q$S&&this._onWorldTransform()),this._parent=q$S}},q$L(q$J,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),q$J}(),q$D_=function(q$S){function q$_(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,q$_.__super.call(this),this._destroyed=!1,this._id=q$_._uniqueIDCounter,q$_._uniqueIDCounter++}q$G(q$_,"laya.d3.component.Component3D",q$V);var q$a=q$_.prototype;return q$Q.imps(q$a,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),q$a._initialize=function(q$S){this._owner=q$S,this._enable=!0,this.started=!1,this._load(q$S)},q$a._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},q$a._load=function(q$S){},q$a._start=function(q$S){},q$a._update=function(q$S){},q$a._lateUpdate=function(q$S){},q$a._preRenderUpdate=function(q$S){},q$a._postRenderUpdate=function(q$S){},q$a._unload=function(q$S){this.offAll()},q$a._cloneTo=function(q$S){},q$t(0,q$a,"id",function(){return this._id}),q$t(0,q$a,"destroyed",function(){return this._destroyed}),q$t(0,q$a,"owner",function(){return this._owner}),q$t(0,q$a,"enable",function(){return this._enable},function(q$S){this._enable!==q$S&&(this._enable=q$S,this.event("enablechanged",this._enable))}),q$t(0,q$a,"isSingleton",function(){return q$_._isSingleton}),q$_._isSingleton=!0,q$_._uniqueIDCounter=1,q$_}(),q$j_=function(q$S){function q$_(){this._destroyed=!1,q$_.__super.call(this),this._destroyed=!1}q$G(q$_,"laya.d3.core.GeometryFilter",q$V);var q$a=q$_.prototype;return q$Q.imps(q$a,{"laya.resource.IDestroy":!0}),q$a._destroy=function(){this.offAll(),this._destroyed=!0},q$t(0,q$a,"_isAsyncLoaded",function(){return!0}),q$t(0,q$a,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),q$t(0,q$a,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),q$t(0,q$a,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),q$t(0,q$a,"destroyed",function(){return this._destroyed}),q$_}(),q$Q_=function(q$S){function q$R(q$S){q$R.__super.call(this),this._id=++q$R._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new q$ES(new q$W_,new q$W_),this._boundingBoxCenter=new q$W_,this._boundingSphere=new q$wS(new q$W_,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=q$S,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}q$G(q$R,"laya.d3.core.render.BaseRender",q$V);var q$_=q$R.prototype;return q$Q.imps(q$_,{"laya.resource.IDestroy":!0}),q$_._changeMaterialReference=function(q$S,q$_){q$S&&q$S._removeReference(),q$_._addReference()},q$_._getInstanceMaterial=function(q$S,q$_){var q$a=new q$S.constructor;return q$S.cloneTo(q$a),q$a.name=q$a.name+"(Instance)",this._materialsInstance[q$_]=!0,this._changeMaterialReference(this._materials[q$_],q$a),this._materials[q$_]=q$a},q$_._setShaderValuelightMap=function(q$S){this._setShaderValueTexture(3,q$S)},q$_._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},q$_._renderRenderableBoundBox=function(){var q$S=q$F_._debugPhasorSprite,q$_=this.boundingBox,q$a=q$R._tempBoundBoxCorners;q$_.getCorners(q$a),q$S.line(q$a[0],q$R._greenColor,q$a[1],q$R._greenColor),q$S.line(q$a[2],q$R._greenColor,q$a[3],q$R._greenColor),q$S.line(q$a[4],q$R._greenColor,q$a[5],q$R._greenColor),q$S.line(q$a[6],q$R._greenColor,q$a[7],q$R._greenColor),q$S.line(q$a[0],q$R._greenColor,q$a[3],q$R._greenColor),q$S.line(q$a[1],q$R._greenColor,q$a[2],q$R._greenColor),q$S.line(q$a[2],q$R._greenColor,q$a[6],q$R._greenColor),q$S.line(q$a[3],q$R._greenColor,q$a[7],q$R._greenColor),q$S.line(q$a[0],q$R._greenColor,q$a[4],q$R._greenColor),q$S.line(q$a[1],q$R._greenColor,q$a[5],q$R._greenColor),q$S.line(q$a[4],q$R._greenColor,q$a[7],q$R._greenColor),q$S.line(q$a[5],q$R._greenColor,q$a[6],q$R._greenColor)},q$_._calculateBoundingSphere=function(){throw"BaseRender: must override it."},q$_._calculateBoundingBox=function(){throw"BaseRender: must override it."},q$_._setShaderValueTexture=function(q$S,q$_){this._owner._shaderValues.setValue(q$S,q$_)},q$_._setShaderValueMatrix4x4=function(q$S,q$_){this._owner._shaderValues.setValue(q$S,q$_?q$_.elements:null)},q$_._setShaderValueColor=function(q$S,q$_){this._owner._shaderValues.setValue(q$S,q$_?q$_.elements:null)},q$_._setShaderValueBuffer=function(q$S,q$_){this._owner._shaderValues.setValue(q$S,q$_)},q$_._setShaderValueInt=function(q$S,q$_){this._owner._shaderValues.setValue(q$S,q$_)},q$_._setShaderValueBool=function(q$S,q$_){this._owner._shaderValues.setValue(q$S,q$_)},q$_._setShaderValueNumber=function(q$S,q$_){this._owner._shaderValues.setValue(q$S,q$_)},q$_._setShaderValueVector2=function(q$S,q$_){this._owner._shaderValues.setValue(q$S,q$_?q$_.elements:null)},q$_._addShaderDefine=function(q$S){this._owner._shaderDefineValue|=q$S},q$_._removeShaderDefine=function(q$S){this._owner._shaderDefineValue&=~q$S},q$_._renderUpdate=function(q$S){return!0},q$_._applyLightMapParams=function(){if(0<=this._lightmapIndex){var q$S=this._owner.scene;if(q$S){var q$_=q$S.getlightmaps()[this._lightmapIndex];q$_?(this._addShaderDefine(q$Z_.SAHDERDEFINE_LIGHTMAP),q$_.loaded?this._setShaderValuelightMap(q$_):q$_.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(q$Z_.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(q$Z_.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(q$Z_.SAHDERDEFINE_LIGHTMAP)},q$_._updateOctreeNode=function(){var q$S=this._treeNode;q$S&&this._octreeNodeNeedChange&&(q$S.updateObject(this),this._octreeNodeNeedChange=!1)},q$_._destroy=function(){this.offAll();var q$S=0,q$_=0;for(q$S=0,q$_=this._renderElements.length;q$S<q$_;q$S++)this._renderElements[q$S]._destroy();for(q$S=0,q$_=this._materials.length;q$S<q$_;q$S++)this._materials[q$S]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},q$t(0,q$_,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),q$t(0,q$_,"id",function(){return this._id}),q$t(0,q$_,"material",function(){var q$S=this._materials[0];if(q$S&&!this._materialsInstance[0]){var q$_=this._getInstanceMaterial(q$S,0);this.event("materialchanged",[this,0,q$_])}return this._materials[0]},function(q$S){this.sharedMaterial=q$S}),q$t(0,q$_,"sharedMaterial",function(){return this._materials[0]},function(q$S){var q$_=this._materials[0];q$_!==q$S&&(this._materials[0]=q$S,this._materialsInstance[0]=!1,this._changeMaterialReference(q$_,q$S),this.event("materialchanged",[this,0,q$S]))}),q$t(0,q$_,"lightmapIndex",function(){return this._lightmapIndex},function(q$S){this._lightmapIndex=q$S,this._applyLightMapParams()}),q$t(0,q$_,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(q$S){this._lightmapScaleOffset=q$S,this._setShaderValueColor(2,q$S),this._addShaderDefine(q$Z_.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),q$t(0,q$_,"enable",function(){return this._enable},function(q$S){this._enable=q$S,this.event("enablechanged",[this,q$S])}),q$t(0,q$_,"materials",function(){for(var q$S=0,q$_=this._materials.length;q$S<q$_;q$S++)if(!this._materialsInstance[q$S]){var q$a=this._getInstanceMaterial(this._materials[q$S],q$S);this.event("materialchanged",[this,q$S,q$a])}return this._materials.slice()},function(q$S){this.sharedMaterials=q$S}),q$t(0,q$_,"sharedMaterials",function(){return this._materials.slice()},function(q$S){if(!q$S)throw new Error("MeshRender: shadredMaterials value can't be null.");var q$_=q$S.length;this._materialsInstance.length=q$_;for(var q$a=0;q$a<q$_;q$a++){var q$R=this._materials[q$a];q$R!==q$S[q$a]&&(this._materialsInstance[q$a]=!1,this._changeMaterialReference(q$R,q$S[q$a]),this.event("materialchanged",[this,q$a,q$S[q$a]]))}this._materials=q$S}),q$t(0,q$_,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),q$t(0,q$_,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var q$S=this.boundingBox;q$W_.add(q$S.min,q$S.max,this._boundingBoxCenter),q$W_.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),q$t(0,q$_,"receiveShadow",function(){return this._receiveShadow},function(q$S){this._receiveShadow!==q$S&&((this._receiveShadow=q$S)?this._addShaderDefine(q$G_.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(q$G_.SHADERDEFINE_RECEIVE_SHADOW))}),q$t(0,q$_,"destroyed",function(){return this._destroyed}),q$R._uniqueIDCounter=0,q$L(q$R,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new q$W_,new q$W_,new q$W_,new q$W_,new q$W_,new q$W_,new q$W_,new q$W_]},"_greenColor",function(){return this._greenColor=new q$k_(0,1,0,1)}]),q$R}(),q$m_=function(q$S){function q$k(q$S){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,q$k.__super.call(this),this._localPosition=new q$W_,this._localRotation=new q$a_(0,0,0,1),this._localScale=new q$W_(1,1,1),this._localRotationEuler=new q$W_,this._localMatrix=new q$S_,this._position=new q$W_,this._rotation=new q$a_(0,0,0,1),this._scale=new q$W_(1,1,1),this._worldMatrix=new q$S_,this._forward=new q$W_,this._up=new q$W_,this._right=new q$W_,this._owner=q$S,this._childs=[]}q$G(q$k,"laya.d3.core.Transform3D",q$V);var q$_=q$k.prototype;return q$_._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)q$S_.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var q$S=q$k._tempVector30;q$W_.multiply(this.pivot,this._localScale,q$S);var q$_=q$k._tempVector31;q$W_.subtract(q$S,this.pivot,q$_);var q$a=q$k._tempVector32,q$R=this.localRotation;q$W_.transformQuat(q$S,q$R,q$a),q$W_.subtract(q$a,q$S,q$a);var q$J=q$k._tempVector33;q$W_.subtract(this._localPosition,q$_,q$J),q$W_.subtract(q$J,q$a,q$J),q$S_.createAffineTransformation(q$J,q$R,this._localScale,this._localMatrix)}},q$_._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var q$S=0,q$_=this._childs.length;q$S<q$_;q$S++)this._childs[q$S]._onWorldPositionRotationTransform()}},q$_._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var q$S=0,q$_=this._childs.length;q$S<q$_;q$S++)this._childs[q$S]._onWorldPositionScaleTransform()}},q$_._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var q$S=0,q$_=this._childs.length;q$S<q$_;q$S++)this._childs[q$S]._onWorldPositionTransform()}},q$_._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var q$S=0,q$_=this._childs.length;q$S<q$_;q$S++)this._childs[q$S]._onWorldPositionRotationTransform()}},q$_._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var q$S=0,q$_=this._childs.length;q$S<q$_;q$S++)this._childs[q$S]._onWorldPositionScaleTransform()}},q$_._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var q$S=0,q$_=this._childs.length;q$S<q$_;q$S++)this._childs[q$S]._onWorldTransform()}},q$_.translate=function(q$S,q$_){void 0===q$_&&(q$_=!0),q$_?(q$S_.createFromQuaternion(this.localRotation,q$k._tempMatrix0),q$W_.transformCoordinate(q$S,q$k._tempMatrix0,q$k._tempVector30),q$W_.add(this.localPosition,q$k._tempVector30,this._localPosition),this.localPosition=this._localPosition):(q$W_.add(this.position,q$S,this._position),this.position=this._position)},q$_.rotate=function(q$S,q$_,q$a){var q$R;void 0===q$_&&(q$_=!0),void 0===q$a&&(q$a=!0),q$R=q$a?q$S:(q$W_.scale(q$S,Math.PI/180,q$k._tempVector30),q$k._tempVector30),q$a_.createFromYawPitchRoll(q$R.y,q$R.x,q$R.z,q$k._tempQuaternion0),q$_?(q$a_.multiply(this._localRotation,q$k._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(q$a_.multiply(q$k._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},q$_.lookAt=function(q$S,q$_,q$a){void 0===q$a&&(q$a=!1);var q$R,q$J=q$S.elements;if(q$a){if(q$R=this._localPosition.elements,Math.abs(q$R[0]-q$J[0])<q$vS.zeroTolerance&&Math.abs(q$R[1]-q$J[1])<q$vS.zeroTolerance&&Math.abs(q$R[2]-q$J[2])<q$vS.zeroTolerance)return;q$a_.lookAt(this._localPosition,q$S,q$_,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var q$V=this.position;if(q$R=q$V.elements,Math.abs(q$R[0]-q$J[0])<q$vS.zeroTolerance&&Math.abs(q$R[1]-q$J[1])<q$vS.zeroTolerance&&Math.abs(q$R[2]-q$J[2])<q$vS.zeroTolerance)return;q$a_.lookAt(q$V,q$S,q$_,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},q$t(0,q$_,"_isFrontFaceInvert",function(){var q$S=this.scale,q$_=q$S.x<0;return q$S.y<0&&(q$_=!q$_),q$S.z<0&&(q$_=!q$_),q$_}),q$t(0,q$_,"owner",function(){return this._owner}),q$t(0,q$_,"localRotation",function(){if(this._localQuaternionUpdate){var q$S=this._localRotationEuler.elements;q$a_.createFromYawPitchRoll(q$S[1]/q$k._angleToRandin,q$S[0]/q$k._angleToRandin,q$S[2]/q$k._angleToRandin,this._localRotation)}return this._localRotation},function(q$S){this._localRotation=q$S,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),q$t(0,q$_,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?q$S_.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(q$S){null===this._parent?q$S.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),q$S_.multiply(this._localMatrix,q$S,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=q$S,this._worldUpdate=!1}),q$t(0,q$_,"worldNeedUpdate",function(){return this._worldUpdate}),q$t(0,q$_,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(q$S){this._localMatrix=q$S,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),q$t(0,q$_,"dummy",function(){return this._dummy},function(q$S){this._dummy!==q$S&&(this._dummy&&(this._dummy._entity=null),q$S&&(q$S._entity=this),this._dummy=q$S)}),q$t(0,q$_,"localPosition",function(){return this._localPosition},function(q$S){this._localPosition=q$S,this._localUpdate=!0,this._onWorldPositionTransform()}),q$t(0,q$_,"position",function(){if(this._positionUpdate){if(null!=this._parent){var q$S=this._parent.position;q$W_.multiply(this._localPosition,this._parent.scale,q$k._tempVector30),q$W_.transformQuat(q$k._tempVector30,this._parent.rotation,q$k._tempVector30),q$W_.add(q$S,q$k._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(q$S){if(null!=this._parent){q$W_.subtract(q$S,this._parent.position,this._localPosition);var q$_=this._parent.scale.elements,q$a=q$_[0],q$R=q$_[1],q$J=q$_[2];if(1!==q$a||1!==q$R||1!==q$J){var q$V=q$k._tempVector30,q$W=q$V.elements;q$W[0]=1/q$a,q$W[1]=1/q$R,q$W[2]=1/q$J,q$W_.multiply(this._localPosition,q$V,this._localPosition)}this._parent.rotation.invert(q$k._tempQuaternion0),q$W_.transformQuat(this._localPosition,q$k._tempQuaternion0,this._localPosition)}else q$S.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=q$S,this._positionUpdate=!1}),q$t(0,q$_,"localScale",function(){return this._localScale},function(q$S){this._localScale=q$S,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),q$t(0,q$_,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(q$k._tempVector30);var q$S=q$k._tempVector30.elements,q$_=this._localRotationEuler.elements;q$_[0]=q$S[1]*q$k._angleToRandin,q$_[1]=q$S[0]*q$k._angleToRandin,q$_[2]=q$S[2]*q$k._angleToRandin}return this._localRotationEuler},function(q$S){this._localRotationEuler=q$S,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),q$t(0,q$_,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?q$a_.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(q$S){null!=this._parent?(this._parent.rotation.invert(q$k._tempQuaternion0),q$a_.multiply(q$S,q$k._tempQuaternion0,this._localRotation)):q$S.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=q$S,this._rotationUpdate=!1}),q$t(0,q$_,"scale",function(){return this._scaleUpdate&&(null!==this._parent?q$W_.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(q$S){if(null!==this._parent){var q$_=this._parent.scale.elements,q$a=q$k._tempVector30.elements;q$a[0]=1/q$_[0],q$a[1]=1/q$_[1],q$a[2]=1/q$_[2],q$W_.multiply(q$S,q$k._tempVector30,this._localScale)}else q$S.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=q$S,this._scaleUpdate=!1}),q$t(0,q$_,"rotationEuler",null,function(q$S){q$a_.createFromYawPitchRoll(q$S.y,q$S.x,q$S.z,this._rotation),this.rotation=this._rotation}),q$t(0,q$_,"forward",function(){var q$S=this.worldMatrix.elements;return this._forward.elements[0]=-q$S[8],this._forward.elements[1]=-q$S[9],this._forward.elements[2]=-q$S[10],this._forward}),q$t(0,q$_,"up",function(){var q$S=this.worldMatrix.elements;return this._up.elements[0]=q$S[4],this._up.elements[1]=q$S[5],this._up.elements[2]=q$S[6],this._up}),q$t(0,q$_,"right",function(){var q$S=this.worldMatrix.elements;return this._right.elements[0]=q$S[0],this._right.elements[1]=q$S[1],this._right.elements[2]=q$S[2],this._right}),q$t(0,q$_,"parent",function(){return this._parent},function(q$S){if(this._parent!==q$S){if(this._parent){var q$_=this._parent._childs,q$a=q$_.indexOf(this);q$_.splice(q$a,1)}q$S&&(q$S._childs.push(this),q$S&&this._onWorldTransform()),this._parent=q$S}}),q$L(q$k,["_tempVector30",function(){return this._tempVector30=new q$W_},"_tempVector31",function(){return this._tempVector31=new q$W_},"_tempVector32",function(){return this._tempVector32=new q$W_},"_tempVector33",function(){return this._tempVector33=new q$W_},"_tempQuaternion0",function(){return this._tempQuaternion0=new q$a_},"_tempMatrix0",function(){return this._tempMatrix0=new q$S_},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),q$k}(),q$q_=(function(q$S){function q$_(){this._rotation=0,this._matNeedUpdte=!1,q$_.__super.call(this),this._matrix=new q$S_,this._offset=new q$V_,this._tiling=new q$V_(1,1)}q$G(q$_,"laya.d3.core.TransformUV",q$V);var q$a=q$_.prototype;q$Q.imps(q$a,{"laya.d3.core.IClone":!0}),q$a._updateMatrix=function(){q$_._tempOffsetV3.elements[0]=this._offset.x,q$_._tempOffsetV3.elements[1]=this._offset.y,q$a_.createFromYawPitchRoll(0,0,this._rotation,q$_._tempRotationQua),q$_._tempTitlingV3.elements[0]=this._tiling.x,q$_._tempTitlingV3.elements[1]=this._tiling.y,q$S_.createAffineTransformation(q$_._tempOffsetV3,q$_._tempRotationQua,q$_._tempTitlingV3,this._matrix)},q$a.cloneTo=function(q$S){q$S._matrix=this._matrix.clone(),q$S._offset=this._offset.clone(),q$S._rotation=this._rotation,q$S._tiling=this._tiling.clone()},q$a.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$a,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),q$t(0,q$a,"tiling",function(){return this._tiling},function(q$S){this._tiling=q$S,this._matNeedUpdte=!0}),q$t(0,q$a,"offset",function(){return this._offset},function(q$S){this._offset=q$S,this._matNeedUpdte=!0}),q$t(0,q$a,"rotation",function(){return this._rotation},function(q$S){this._rotation=q$S,this._matNeedUpdte=!0}),q$L(q$_,["_tempOffsetV3",function(){return this._tempOffsetV3=new q$W_(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new q$a_},"_tempTitlingV3",function(){return this._tempTitlingV3=new q$W_(1,1,1)}])}(),function(q$a){function q$S(){this.x=NaN,this.y=NaN,this.z=NaN,q$S.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}q$G(q$S,"laya.d3.core.particleShuriKen.module.shape.BoxShape",q$a);var q$_=q$S.prototype;q$_._getShapeBoundBox=function(q$S){var q$_=q$S.min.elements;q$_[0]=.5*-this.x,q$_[1]=.5*-this.y,q$_[2]=.5*-this.z;var q$a=q$S.max.elements;q$a[0]=.5*this.x,q$a[1]=.5*this.y,q$a[2]=.5*this.z},q$_._getSpeedBoundBox=function(q$S){var q$_=q$S.min.elements;q$_[0]=0,q$_[1]=0,q$_[2]=0;var q$a=q$S.max.elements;q$a[0]=0,q$a[1]=1,q$a[2]=0},q$_.generatePositionAndDirection=function(q$S,q$_,q$a,q$R){var q$J=q$S.elements,q$V=q$_.elements;q$a?(q$a.seed=q$R[16],q$Y._randomPointInsideHalfUnitBox(q$S,q$a),q$R[16]=q$a.seed):q$Y._randomPointInsideHalfUnitBox(q$S),q$J[0]=this.x*q$J[0],q$J[1]=this.y*q$J[1],q$J[2]=this.z*q$J[2],this.randomDirection?q$a?(q$a.seed=q$R[17],q$Y._randomPointUnitSphere(q$_,q$a),q$R[17]=q$a.seed):q$Y._randomPointUnitSphere(q$_):(q$V[0]=0,q$V[1]=0,q$V[2]=1)},q$_.cloneTo=function(q$S){q$a.prototype.cloneTo.call(this,q$S);var q$_=q$S;q$_.x=this.x,q$_.y=this.y,q$_.z=this.z,q$_.randomDirection=this.randomDirection}}(q$g),function(q$a){function q$W(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,q$W.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}q$G(q$W,"laya.d3.core.particleShuriKen.module.shape.CircleShape",q$a);var q$S=q$W.prototype;q$S._getShapeBoundBox=function(q$S){var q$_=q$S.min.elements;q$_[0]=q$_[2]=-this.radius,q$_[1]=0;var q$a=q$S.max.elements;q$a[0]=q$a[2]=this.radius,q$a[1]=0},q$S._getSpeedBoundBox=function(q$S){var q$_=q$S.min.elements;q$_[0]=q$_[1]=-1,q$_[2]=0;var q$a=q$S.max.elements;q$a[0]=q$a[1]=1,q$a[2]=0},q$S.generatePositionAndDirection=function(q$S,q$_,q$a,q$R){var q$J=q$S.elements,q$V=q$W._tempPositionPoint.elements;q$a?(q$a.seed=q$R[16],this.emitFromEdge?q$Y._randomPointUnitArcCircle(this.arc,q$W._tempPositionPoint,q$a):q$Y._randomPointInsideUnitArcCircle(this.arc,q$W._tempPositionPoint,q$a),q$R[16]=q$a.seed):this.emitFromEdge?q$Y._randomPointUnitArcCircle(this.arc,q$W._tempPositionPoint):q$Y._randomPointInsideUnitArcCircle(this.arc,q$W._tempPositionPoint),q$J[0]=-q$V[0],q$J[1]=q$V[1],q$J[2]=0,q$W_.scale(q$S,this.radius,q$S),this.randomDirection?q$a?(q$a.seed=q$R[17],q$Y._randomPointUnitSphere(q$_,q$a),q$R[17]=q$a.seed):q$Y._randomPointUnitSphere(q$_):q$S.cloneTo(q$_)},q$S.cloneTo=function(q$S){q$a.prototype.cloneTo.call(this,q$S);var q$_=q$S;q$_.radius=this.radius,q$_.arc=this.arc,q$_.emitFromEdge=this.emitFromEdge,q$_.randomDirection=this.randomDirection},q$L(q$W,["_tempPositionPoint",function(){return this._tempPositionPoint=new q$V_}])}(q$g),function(q$a){function q$C(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,q$C.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}q$G(q$C,"laya.d3.core.particleShuriKen.module.shape.ConeShape",q$a);var q$S=q$C.prototype;q$S._getShapeBoundBox=function(q$S){var q$_=this.radius+this.length*Math.sin(this.angle),q$a=this.length*Math.cos(this.angle),q$R=q$S.min.elements;q$R[0]=q$R[1]=-q$_,q$R[2]=0;var q$J=q$S.max.elements;q$J[0]=q$J[1]=q$_,q$J[2]=q$a},q$S._getSpeedBoundBox=function(q$S){var q$_=Math.sin(this.angle),q$a=q$S.min.elements;q$a[0]=q$a[1]=-q$_,q$a[2]=0;var q$R=q$S.max.elements;q$R[0]=q$a[1]=q$_,q$R[2]=1},q$S.generatePositionAndDirection=function(q$S,q$_,q$a,q$R){var q$J,q$V=q$S.elements,q$W=q$_.elements,q$k=q$C._tempPositionPoint.elements,q$z=NaN,q$b=NaN,q$H=Math.cos(this.angle),q$L=Math.sin(this.angle);switch(this.emitType){case 0:q$a?(q$a.seed=q$R[16],q$Y._randomPointInsideUnitCircle(q$C._tempPositionPoint,q$a),q$R[16]=q$a.seed):q$Y._randomPointInsideUnitCircle(q$C._tempPositionPoint),q$z=q$k[0],q$b=q$k[1],q$V[0]=q$z*this.radius,q$V[1]=q$b*this.radius,q$V[2]=0,this.randomDirection?(q$a?(q$a.seed=q$R[17],q$Y._randomPointInsideUnitCircle(q$C._tempDirectionPoint,q$a),q$R[17]=q$a.seed):q$Y._randomPointInsideUnitCircle(q$C._tempDirectionPoint),q$J=q$C._tempDirectionPoint.elements,q$W[0]=q$J[0]*q$L,q$W[1]=q$J[1]*q$L):(q$W[0]=q$z*q$L,q$W[1]=q$b*q$L),q$W[2]=q$H;break;case 1:q$a?(q$a.seed=q$R[16],q$Y._randomPointUnitCircle(q$C._tempPositionPoint,q$a),q$R[16]=q$a.seed):q$Y._randomPointUnitCircle(q$C._tempPositionPoint),q$z=q$k[0],q$b=q$k[1],q$V[0]=q$z*this.radius,q$V[1]=q$b*this.radius,q$V[2]=0,this.randomDirection?(q$a?(q$a.seed=q$R[17],q$Y._randomPointInsideUnitCircle(q$C._tempDirectionPoint,q$a),q$R[17]=q$a.seed):q$Y._randomPointInsideUnitCircle(q$C._tempDirectionPoint),q$J=q$C._tempDirectionPoint.elements,q$W[0]=q$J[0]*q$L,q$W[1]=q$J[1]*q$L):(q$W[0]=q$z*q$L,q$W[1]=q$b*q$L),q$W[2]=q$H;break;case 2:q$a?(q$a.seed=q$R[16],q$Y._randomPointInsideUnitCircle(q$C._tempPositionPoint,q$a)):q$Y._randomPointInsideUnitCircle(q$C._tempPositionPoint),q$z=q$k[0],q$b=q$k[1],q$V[0]=q$z*this.radius,q$V[1]=q$b*this.radius,q$W[q$V[2]=0]=q$z*q$L,q$W[1]=q$b*q$L,q$W[2]=q$H,q$W_.normalize(q$_,q$_),q$a?(q$W_.scale(q$_,this.length*q$a.getFloat(),q$_),q$R[16]=q$a.seed):q$W_.scale(q$_,this.length*Math.random(),q$_),q$W_.add(q$S,q$_,q$S),this.randomDirection&&(q$a?(q$a.seed=q$R[17],q$Y._randomPointUnitSphere(q$_,q$a),q$R[17]=q$a.seed):q$Y._randomPointUnitSphere(q$_));break;case 3:q$a?(q$a.seed=q$R[16],q$Y._randomPointUnitCircle(q$C._tempPositionPoint,q$a)):q$Y._randomPointUnitCircle(q$C._tempPositionPoint),q$z=q$k[0],q$b=q$k[1],q$V[0]=q$z*this.radius,q$V[1]=q$b*this.radius,q$W[q$V[2]=0]=q$z*q$L,q$W[1]=q$b*q$L,q$W[2]=q$H,q$W_.normalize(q$_,q$_),q$a?(q$W_.scale(q$_,this.length*q$a.getFloat(),q$_),q$R[16]=q$a.seed):q$W_.scale(q$_,this.length*Math.random(),q$_),q$W_.add(q$S,q$_,q$S),this.randomDirection&&(q$a?(q$a.seed=q$R[17],q$Y._randomPointUnitSphere(q$_,q$a),q$R[17]=q$a.seed):q$Y._randomPointUnitSphere(q$_));break;default:throw new Error("ConeShape:emitType is invalid.")}},q$S.cloneTo=function(q$S){q$a.prototype.cloneTo.call(this,q$S);var q$_=q$S;q$_.angle=this.angle,q$_.radius=this.radius,q$_.length=this.length,q$_.emitType=this.emitType,q$_.randomDirection=this.randomDirection},q$L(q$C,["_tempPositionPoint",function(){return this._tempPositionPoint=new q$V_},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new q$V_}])}(q$g),function(q$a){function q$S(){this.radius=NaN,this.emitFromShell=!1,q$S.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}q$G(q$S,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",q$a);var q$_=q$S.prototype;q$_._getShapeBoundBox=function(q$S){var q$_=q$S.min.elements;q$_[0]=q$_[1]=q$_[2]=-this.radius;var q$a=q$S.max.elements;q$a[0]=q$a[1]=this.radius,q$a[2]=0},q$_._getSpeedBoundBox=function(q$S){var q$_=q$S.min.elements;q$_[0]=q$_[1]=-1,q$_[2]=0;var q$a=q$S.max.elements;q$a[0]=q$a[1]=q$a[2]=1},q$_.generatePositionAndDirection=function(q$S,q$_,q$a,q$R){var q$J=q$S.elements;q$a?(q$a.seed=q$R[16],this.emitFromShell?q$Y._randomPointUnitSphere(q$S,q$a):q$Y._randomPointInsideUnitSphere(q$S,q$a),q$R[16]=q$a.seed):this.emitFromShell?q$Y._randomPointUnitSphere(q$S):q$Y._randomPointInsideUnitSphere(q$S),q$W_.scale(q$S,this.radius,q$S);var q$V=q$J[2];q$V<0&&(q$J[2]=-1*q$V),this.randomDirection?q$a?(q$a.seed=q$R[17],q$Y._randomPointUnitSphere(q$_,q$a),q$R[17]=q$a.seed):q$Y._randomPointUnitSphere(q$_):q$S.cloneTo(q$_)},q$_.cloneTo=function(q$S){q$a.prototype.cloneTo.call(this,q$S);var q$_=q$S;q$_.radius=this.radius,q$_.emitFromShell=this.emitFromShell,q$_.randomDirection=this.randomDirection}}(q$g),function(q$a){function q$S(){this.radius=NaN,this.emitFromShell=!1,q$S.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}q$G(q$S,"laya.d3.core.particleShuriKen.module.shape.SphereShape",q$a);var q$_=q$S.prototype;q$_._getShapeBoundBox=function(q$S){var q$_=q$S.min.elements;q$_[0]=q$_[1]=q$_[2]=-this.radius;var q$a=q$S.max.elements;q$a[0]=q$a[1]=q$a[2]=this.radius},q$_._getSpeedBoundBox=function(q$S){var q$_=q$S.min.elements;q$_[0]=q$_[1]=q$_[2]=-1;var q$a=q$S.max.elements;q$a[0]=q$a[1]=q$a[2]=1},q$_.generatePositionAndDirection=function(q$S,q$_,q$a,q$R){q$a?(q$a.seed=q$R[16],this.emitFromShell?q$Y._randomPointUnitSphere(q$S,q$a):q$Y._randomPointInsideUnitSphere(q$S,q$a),q$R[16]=q$a.seed):this.emitFromShell?q$Y._randomPointUnitSphere(q$S):q$Y._randomPointInsideUnitSphere(q$S),q$W_.scale(q$S,this.radius,q$S),this.randomDirection?q$a?(q$a.seed=q$R[17],q$Y._randomPointUnitSphere(q$_,q$a),q$R[17]=q$a.seed):q$Y._randomPointUnitSphere(q$_):q$S.cloneTo(q$_)},q$_.cloneTo=function(q$S){q$a.prototype.cloneTo.call(this,q$S);var q$_=q$S;q$_.radius=this.radius,q$_.emitFromShell=this.emitFromShell,q$_.randomDirection=this.randomDirection}}(q$g),function(q$S){function q$_(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,q$_.__super.call(this)}return q$G(q$_,"laya.d3.core.render.SubMeshRenderElement",q$p),q$_}()),q$N_=function(q$S){function q$$(q$S,q$_,q$a,q$R,q$J,q$V){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=q$S,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[q$G_.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[q$Z_.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[q$Z_.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[q$I_.SHADERDEFINE_ALPHATEST]="ALPHATEST";q$$.__super.call(this,q$S,q$_,q$a,null,{}),this._attributeMap=q$R;var q$W;for(q$W in q$J){var q$k=q$J[q$W];switch(q$k[1]){case 0:this._renderElementUniformMap[q$W]=q$k[0];break;case 1:this._materialUniformMap[q$W]=q$k[0];break;case 2:this._spriteUniformMap[q$W]=q$k[0];break;case 3:this._cameraUniformMap[q$W]=q$k[0];break;case 4:this._sceneUniformMap[q$W]=q$k[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}q$G(q$$,"laya.d3.shader.ShaderCompile3D",q$D);var q$_=q$$.prototype;return q$_._definesToNameDic=function(q$S,q$_){for(var q$a={},q$R=1,q$J=0;q$J<32&&!(q$S<(q$R=1<<q$J));q$J++)if(q$S&q$R){var q$V=q$_[q$R];q$V&&(q$a[q$V]="")}return q$a},q$_.withCompile=function(q$S,q$_,q$a,q$R){var q$J,q$V,q$W;if(q$V=this.sharders[q$S])if(q$W=q$V[q$_]){if(q$J=q$W[q$a])return q$J}else q$W=q$V[q$_]=[];else q$W=(q$V=this.sharders[q$S]=[])[q$_]=[];var q$k,q$z=this._definesToNameDic(q$S,q$$._globalInt2name),q$b=this._definesToNameDic(q$_,this._spriteInt2name),q$H=this._definesToNameDic(q$a,this._materialInt2name),q$L={},q$C="";if(q$z)for(q$k in q$z)q$C+="#define "+q$k+"\n",q$L[q$k]=!0;if(q$b)for(q$k in q$b)q$C+="#define "+q$k+"\n",q$L[q$k]=!0;if(q$H)for(q$k in q$H)q$C+="#define "+q$k+"\n",q$L[q$k]=!0;var q$G=q$M_.nameKey.getName(this._name)+" compile ("+q$S+","+q$_+","+q$a+")",q$t=this._VS.toscript(q$L,[]),q$o=this._PS.toscript(q$L,[]);q$h.now();if(q$J=q$M_.create(q$C+q$t.join("\n"),q$C+q$o.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,q$R,q$G),q$W[q$a]=q$J,laya.d3.shader.ShaderCompile3D.debugMode)q$h.now();return q$J},q$_.precompileShaderWithShaderDefine=function(q$S,q$_,q$a){this.withCompile(q$S,q$_,q$a,!0)},q$_.addMaterialDefines=function(q$S){var q$_=q$S.defines;for(var q$a in q$_){var q$R=q$_[q$a],q$J=parseInt(q$a);this._materialInt2name[q$J]=q$R,this._materialName2Int[q$R]=q$J}},q$_.addSpriteDefines=function(q$S){var q$_=q$S.defines;for(var q$a in q$_){var q$R=q$_[q$a],q$J=parseInt(q$a);this._spriteInt2name[q$J]=q$R,this._spriteName2Int[q$R]=q$J}},q$_.getMaterialDefineByName=function(q$S){return this._materialName2Int[q$S]},q$_.registerMaterialDefine=function(q$S){var q$_=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[q$_]=q$S,this._materialName2Int[q$S]=q$_},q$_.registerSpriteDefine=function(q$S){var q$_=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[q$_]=q$S,this._spriteName2Int[q$S]=q$_},q$$._globalRegDefine=function(q$S,q$_){q$$._globalInt2name[q$_]=q$S},q$$.add=function(q$S,q$_,q$a,q$R,q$J){return laya.d3.shader.ShaderCompile3D._preCompileShader[q$S]=new q$$(q$S,q$_,q$a,q$R,q$J,q$D.includes)},q$$.get=function(q$S){return laya.d3.shader.ShaderCompile3D._preCompileShader[q$M_.nameKey.getID(q$S)]},q$$._preCompileShader={},q$$._globalInt2name=[],q$$.debugMode=!1,q$$.SHADERDEFINE_HIGHPRECISION=1,q$$.SHADERDEFINE_FOG=4,q$$.SHADERDEFINE_DIRECTIONLIGHT=8,q$$.SHADERDEFINE_POINTLIGHT=16,q$$.SHADERDEFINE_SPOTLIGHT=32,q$$.SHADERDEFINE_UV0=64,q$$.SHADERDEFINE_COLOR=128,q$$.SHADERDEFINE_UV1=256,q$$.SAHDERDEFINE_DEPTHFOG=131072,q$$}(),q$n_=function(q$S){function q$t(){q$t.__super.call(this)}q$G(q$t,"laya.d3.graphics.MeshSprite3DStaticBatchManager",q$RS);var q$_=q$t.prototype;return q$_._getStaticBatch=function(q$S,q$_,q$a,q$R){var q$J,q$V;return q$V=q$S?q$S.id.toString()+q$a.id.toString()+q$_.id.toString()+q$R.toString():q$a.id.toString()+q$_.id.toString()+q$R.toString(),this._staticBatches[q$V]?q$J=this._staticBatches[q$V]:this._staticBatches[q$V]=q$J=new q$l_(q$V,this,q$S,q$_,q$a),q$J},q$_._initStaticBatchs=function(q$S){var q$_,q$a;this._initBatchRenderElements.sort(q$t._sortPrepareStaticBatch);for(var q$R,q$J=!1,q$V=0,q$W=0,q$k=this._initBatchRenderElements.length;q$W<q$k;q$W++){var q$z,q$b=this._initBatchRenderElements[q$W],q$H=q$b.renderObj._getVertexBuffer(0);q$b._sprite3D;if(q$a===q$H.vertexDeclaration&&q$_===q$b._material)if(q$J)q$R._addCombineBatchRenderObjTest(q$b)?(q$z=q$b._staticBatch)!==q$R&&(q$z&&q$z._deleteCombineBatchRenderObj(q$b),q$R._addCombineBatchRenderObj(q$b)):(q$J=!1,q$V++);else{var q$L=this._initBatchRenderElements[q$W-1],q$C=q$L.renderObj,q$G=q$b.renderObj;q$J=!(65535<q$C._getVertexBuffer().vertexCount+q$G._getVertexBuffer().vertexCount)&&(q$R=this._getStaticBatch(q$S,q$a,q$_,q$V),(q$z=q$L._staticBatch)!==q$R&&(q$z&&q$z._deleteCombineBatchRenderObj(q$L),q$R._addCombineBatchRenderObj(q$L)),(q$z=q$b._staticBatch)!==q$R&&(q$z&&q$z._deleteCombineBatchRenderObj(q$b),q$R._addCombineBatchRenderObj(q$b)),!0)}else q$J=!1,q$V=0;q$_=q$b._material,q$a=q$H.vertexDeclaration}},q$t._sortPrepareStaticBatch=function(q$S,q$_){var q$a=q$S._render,q$R=q$_._render,q$J=q$a.lightmapIndex-q$R.lightmapIndex;if(0!=q$J)return q$J;var q$V=q$a.receiveShadow-q$R.receiveShadow;if(0!=q$V)return q$V;var q$W=q$S._mainSortID-q$_._mainSortID;return 0==q$W?q$S.renderObj.triangleCount-q$_.renderObj.triangleCount:q$W},q$t}(),q$l_=function(q$S){function q$V(q$S,q$_,q$a,q$R,q$J){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,q$V.__super.call(this,q$S,q$_,q$a),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=q$R,this._material=q$J}q$G(q$V,"laya.d3.graphics.SubMeshStaticBatch",q$JS);var q$_=q$V.prototype;return q$_._compareBatchRenderElement=function(q$S,q$_){return q$S._batchIndexStart>q$_._batchIndexStart},q$_._addCombineBatchRenderObjTest=function(q$S){var q$_=q$S.renderObj._vertexCount;return!(65535<(0<q$_?this._currentCombineVertexCount+q$_:this._currentCombineVertexCount+q$S.renderObj._getVertexBuffer().vertexCount))},q$_._addCombineBatchRenderObj=function(q$S){var q$_=q$S.renderObj,q$a=q$_._vertexCount;this._initBatchRenderElements.push(q$S),q$S._staticBatch=this,0<q$a?(this._currentCombineIndexCount+=q$_._indexCount,this._currentCombineVertexCount+=q$a):(this._currentCombineIndexCount=this._currentCombineIndexCount+q$_._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+q$_._getVertexBuffer().vertexCount),this._needFinishCombine=!0},q$_._deleteCombineBatchRenderObj=function(q$S){var q$_=q$S.renderObj,q$a=this._initBatchRenderElements.indexOf(q$S);if(-1!==q$a){this._initBatchRenderElements.splice(q$a,1),q$S._staticBatch=null;var q$R=q$_._vertexCount;0<q$R?(this._currentCombineIndexCount=this._currentCombineIndexCount-q$_._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-q$R):(this._currentCombineIndexCount=this._currentCombineIndexCount-q$_._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-q$_._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},q$_._finishInit=function(){if(this._needFinishCombine){var q$S=0,q$_=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var q$a=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),q$R=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=q$g_.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=q$e_.create("ushort",this._currentCombineIndexCount,35044);for(var q$J=0,q$V=this._initBatchRenderElements.length;q$J<q$V;q$J++){var q$W=this._initBatchRenderElements[q$J],q$k=q$W.renderObj,q$z=q$k._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,q$W._sprite3D),q$b=q$k.getIndices(),q$H=q$W._sprite3D.transform._isFrontFaceInvert,q$L=q$S/(this._vertexDeclaration.vertexStride/4)-q$k._vertexStart,q$C=q$_,q$G=q$C+q$b.length;q$W._batchIndexStart=q$C,q$W._batchIndexEnd=q$G,q$R.set(q$b,q$_);var q$t=0;if(q$H)for(q$t=q$C;q$t<q$G;q$t+=3){q$R[q$t]=q$L+q$R[q$t];var q$o=q$R[q$t+1],q$$=q$R[q$t+2];q$R[q$t+1]=q$L+q$$,q$R[q$t+2]=q$L+q$o}else for(q$t=q$C;q$t<q$G;q$t+=3)q$R[q$t]=q$L+q$R[q$t],q$R[q$t+1]=q$L+q$R[q$t+1],q$R[q$t+2]=q$L+q$R[q$t+2];q$_+=q$b.length,q$a.set(q$z,q$S),q$S+=q$z.length}this._vertexBuffer.setData(q$a),this._indexBuffer.setData(q$R),this._needFinishCombine=!1}},q$_._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new q$q_)},q$_._getRenderElement=function(q$S,q$_,q$a){for(var q$R,q$J,q$V=this._batchRenderElements.length,q$W=!0,q$k=0;q$k<q$V;q$k++){var q$z,q$b,q$H=(q$J=this._batchRenderElements[q$k])._sprite3D._render;if(0!==q$k&&(q$W=(q$z=(q$R=this._batchRenderElements[q$k-1])._sprite3D._render).lightmapIndex!==q$H.lightmapIndex||q$z.receiveShadow!==q$H.receiveShadow||q$R._batchIndexEnd!==q$J._batchIndexStart),q$W){(q$b=this._getCombineRenderElementFromPool()).renderObj=this,q$b._material=this._material,q$b._batchIndexStart=q$J._batchIndexStart,q$b._batchIndexEnd=q$J._batchIndexEnd;var q$L=q$H.lightmapIndex,q$C=q$L+1,q$G=this._batchOwnerIndices[q$C];q$G||(q$G=this._batchOwnerIndices[q$C]=[]);var q$t,q$o=q$G[q$J._render.receiveShadow?1:0];void 0===q$o?(q$G[q$H.receiveShadow?1:0]=this._batchOwners.length,(q$t=new q$c_(null,"StaticBatchMeshSprite3D"))._scene=q$_,q$t._transform=this._rootOwner?this._rootOwner._transform:null,q$t._render.lightmapIndex=q$L,q$t._render.receiveShadow=q$J._render.receiveShadow,this._batchOwners.push(q$t)):q$t=this._batchOwners[q$o],q$t._render._renderUpdate(q$a),q$b._sprite3D=q$t,q$S.push(q$b)}else q$b._batchIndexEnd=q$J._batchIndexEnd}},q$_._beforeRender=function(q$S){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},q$_._render=function(q$S){var q$_=q$S.renderElement,q$a=q$_._batchIndexStart,q$R=q$_._batchIndexEnd-q$a;q$A.mainContext.drawElements(4,q$R,5123,2*q$a),q$N.drawCall++,q$N.trianglesFaces+=q$R/3},q$_.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},q$_._getVertexBuffer=function(q$S){return void 0===q$S&&(q$S=0),this._vertexBuffer},q$V}(),q$B_=function(q$S){function q$_(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,q$_.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}q$G(q$_,"laya.d3.core.ComponentNode",q$b);var q$a=q$_.prototype;return q$a.addComponent=function(q$S){var q$_,q$a=this._componentsMap.indexOf(q$S);if(-1===q$a)q$_=[],this._componentsMap.push(q$S),this._typeComponentsIndices.push(q$_);else if(q$_=this._typeComponentsIndices[q$a],this._components[q$_[0]].isSingleton)throw new Error("无法单实例创建"+q$S+"组件，"+q$S+"组件已存在！");var q$R=q$J.getInstance(q$S);return q$_.push(this._components.length),this._components.push(q$R),q$R instanceof laya.d3.component.Script&&this._scripts.push(q$R),q$R._initialize(this),q$R},q$a._removeComponent=function(q$S,q$_){var q$a=this._typeComponentsIndices[q$S],q$R=q$a[q$_],q$J=this._components[q$R];this._components.splice(q$R,1),q$J instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(q$J),1),q$a.splice(q$_,1),0===q$a.length&&(this._typeComponentsIndices.splice(q$S,1),this._componentsMap.splice(q$S,1));for(var q$V=0,q$W=this._componentsMap.length;q$V<q$W;q$V++)for(var q$k=(q$a=this._typeComponentsIndices[q$V]).length-1;0<=q$k;q$k--){var q$z=q$a[q$k];if(!(q$R<q$z))break;q$a[q$k]=--q$z}q$J._destroy()},q$a.getComponentByType=function(q$S,q$_){void 0===q$_&&(q$_=0);var q$a=this._componentsMap.indexOf(q$S);return-1===q$a?null:this._components[this._typeComponentsIndices[q$a][q$_]]},q$a.getComponentsByType=function(q$S,q$_){var q$a=this._componentsMap.indexOf(q$S);if(-1!==q$a){var q$R=this._typeComponentsIndices[q$a],q$J=q$R.length;q$_.length=q$J;for(var q$V=0;q$V<q$J;q$V++)q$_[q$V]=this._components[q$R[q$V]]}else q$_.length=0},q$a.getComponentByIndex=function(q$S){return this._components[q$S]},q$a.removeComponentByType=function(q$S,q$_){void 0===q$_&&(q$_=0);var q$a=this._componentsMap.indexOf(q$S);-1!==q$a&&this._removeComponent(q$a,q$_)},q$a.removeComponentsByType=function(q$S){var q$_=this._componentsMap.indexOf(q$S);if(-1!==q$_)for(var q$a=this._typeComponentsIndices[q$_],q$R=0,q$J=q$a.length;q$R<q$J;q$a.length<q$J?q$J--:q$R++)this._removeComponent(q$_,q$R)},q$a.removeAllComponent=function(){for(var q$S=0,q$_=this._componentsMap.length;q$S<q$_;this._componentsMap.length<q$_?q$_--:q$S++)this.removeComponentsByType(this._componentsMap[q$S])},q$a._updateComponents=function(q$S){for(var q$_=0,q$a=this._components.length;q$_<q$a;q$_++){var q$R=this._components[q$_];!q$R.started&&(q$R._start(q$S),q$R.started=!0),q$R.enable&&q$R._update(q$S)}},q$a._lateUpdateComponents=function(q$S){for(var q$_=0;q$_<this._components.length;q$_++){var q$a=this._components[q$_];!q$a.started&&(q$a._start(q$S),q$a.started=!0),q$a.enable&&q$a._lateUpdate(q$S)}},q$a._preRenderUpdateComponents=function(q$S){for(var q$_=0;q$_<this._components.length;q$_++){var q$a=this._components[q$_];!q$a.started&&(q$a._start(q$S),q$a.started=!0),q$a.enable&&q$a._preRenderUpdate(q$S)}},q$a._postRenderUpdateComponents=function(q$S){for(var q$_=0;q$_<this._components.length;q$_++){var q$a=this._components[q$_];!q$a.started&&(q$a._start(q$S),q$a.started=!0),q$a.enable&&q$a._postRenderUpdate(q$S)}},q$_}(),q$I_=function(q$R){function q$S(){q$S.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new q$C_,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new q$k_(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}q$G(q$S,"laya.d3.core.material.BaseMaterial",q$R);var q$_=q$S.prototype;return q$Q.imps(q$_,{"laya.d3.core.IClone":!0}),q$_._addShaderDefine=function(q$S){this._shaderDefineValue|=q$S},q$_._removeShaderDefine=function(q$S){this._shaderDefineValue&=~q$S},q$_._addDisablePublicShaderDefine=function(q$S){this._disablePublicShaderDefine|=q$S},q$_._removeDisablePublicShaderDefine=function(q$S){this._disablePublicShaderDefine&=~q$S},q$_._setBuffer=function(q$S,q$_){this._shaderValues.setValue(q$S,q$_),this._values[q$S]=q$_},q$_._getBuffer=function(q$S){return this._values[q$S]},q$_._setMatrix4x4=function(q$S,q$_){this._shaderValues.setValue(q$S,q$_?q$_.elements:null),this._values[q$S]=q$_},q$_._getMatrix4x4=function(q$S){return this._values[q$S]},q$_._setInt=function(q$S,q$_){this._shaderValues.setValue(q$S,q$_),this._values[q$S]=q$_},q$_._getInt=function(q$S){return this._values[q$S]},q$_._setNumber=function(q$S,q$_){this._shaderValues.setValue(q$S,q$_),this._values[q$S]=q$_},q$_._getNumber=function(q$S){return this._values[q$S]},q$_._setBool=function(q$S,q$_){this._shaderValues.setValue(q$S,q$_),this._values[q$S]=q$_},q$_._getBool=function(q$S){return this._values[q$S]},q$_._setVector2=function(q$S,q$_){this._shaderValues.setValue(q$S,q$_?q$_.elements:null),this._values[q$S]=q$_},q$_._getVector2=function(q$S){return this._values[q$S]},q$_._setColor=function(q$S,q$_){this._shaderValues.setValue(q$S,q$_?q$_.elements:null),this._values[q$S]=q$_},q$_._getColor=function(q$S){return this._values[q$S]},q$_._setTexture=function(q$S,q$_){var q$a=this._values[q$S];this._values[q$S]=q$_,this._shaderValues.setValue(q$S,q$_),0<this.referenceCount&&(q$a&&q$a._removeReference(),q$_&&q$_._addReference())},q$_._getTexture=function(q$S){return this._values[q$S]},q$_._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},q$_._getShader=function(q$S,q$_,q$a){var q$R=(q$S|q$_)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(q$R,q$a,this._shaderDefineValue),this._shader},q$_._setRenderStateBlendDepth=function(){var q$S=q$A.mainContext;switch(q$X.setDepthMask(q$S,this.depthWrite),0===this.depthTest?q$X.setDepthTest(q$S,!1):(q$X.setDepthTest(q$S,!0),q$X.setDepthFunc(q$S,this.depthTest)),this.blend){case 0:q$X.setBlend(q$S,!1);break;case 1:q$X.setBlend(q$S,!0),q$X.setBlendFunc(q$S,this.srcBlend,this.dstBlend);break;case 2:q$X.setBlend(q$S,!0)}},q$_._setRenderStateFrontFace=function(q$S,q$_){var q$a=q$A.mainContext,q$R=0;switch(this.cull){case 0:q$X.setCullFace(q$a,!1);break;case 1:q$X.setCullFace(q$a,!0),q$R=q$S?q$_&&q$_._isFrontFaceInvert?2305:2304:q$_&&q$_._isFrontFaceInvert?2304:2305,q$X.setFrontFace(q$a,q$R);break;case 2:q$X.setCullFace(q$a,!0),q$R=q$S?q$_&&q$_._isFrontFaceInvert?2304:2305:q$_&&q$_._isFrontFaceInvert?2305:2304,q$X.setFrontFace(q$a,q$R)}},q$_.onAsynLoaded=function(q$S,q$_,q$a){var q$R=q$_[0],q$J=q$_[1];switch(q$R.version){case"LAYAMATERIAL:01":var q$V=0,q$W=0,q$k=q$R.props;for(var q$z in q$k)switch(q$z){case"vectors":var q$b=q$k[q$z];for(q$V=0,q$W=q$b.length;q$V<q$W;q$V++){var q$H=q$b[q$V],q$L=q$H.value;switch(q$L.length){case 2:this[q$H.name]=new q$V_(q$L[0],q$L[1]);break;case 3:this[q$H.name]=new q$W_(q$L[0],q$L[1],q$L[2]);break;case 4:this[q$H.name]=new q$k_(q$L[0],q$L[1],q$L[2],q$L[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var q$C=q$k[q$z];for(q$V=0,q$W=q$C.length;q$V<q$W;q$V++){var q$G=q$C[q$V],q$t=q$G.path;q$t&&(this[q$G.name]=q$F.getRes(q$J[q$t]))}break;case"defines":var q$o=q$k[q$z];for(q$V=0,q$W=q$o.length;q$V<q$W;q$V++){var q$$=this._shaderCompile.getMaterialDefineByName(q$o[q$V]);this._addShaderDefine(q$$)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[q$z]=q$k[q$z];break;case"renderQueue":switch(q$k[q$z]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[q$z]=q$k[q$z]}break;case"LAYAMATERIAL:02":for(q$z in q$k=q$R.props)switch(q$z){case"vectors":for(q$V=0,q$W=(q$b=q$k[q$z]).length;q$V<q$W;q$V++)switch((q$L=(q$H=q$b[q$V]).value).length){case 2:this[q$H.name]=new q$V_(q$L[0],q$L[1]);break;case 3:this[q$H.name]=new q$W_(q$L[0],q$L[1],q$L[2]);break;case 4:this[q$H.name]=new q$k_(q$L[0],q$L[1],q$L[2],q$L[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(q$V=0,q$W=(q$C=q$k[q$z]).length;q$V<q$W;q$V++)(q$t=(q$G=q$C[q$V]).path)&&(this[q$G.name]=q$F.getRes(q$J[q$t]));break;case"defines":for(q$V=0,q$W=(q$o=q$k[q$z]).length;q$V<q$W;q$V++)q$$=this._shaderCompile.getMaterialDefineByName(q$o[q$V]),this._addShaderDefine(q$$);break;default:this[q$z]=q$k[q$z]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},q$_._addReference=function(){q$R.prototype._addReference.call(this);for(var q$S=0,q$_=this._values.length;q$S<q$_;q$S++){var q$a=this._values[q$S];q$a&&q$a instanceof laya.d3.resource.BaseTexture&&q$a._addReference()}},q$_._removeReference=function(){q$R.prototype._removeReference.call(this);for(var q$S=0,q$_=this._values.length;q$S<q$_;q$S++){var q$a=this._values[q$S];q$a&&q$a instanceof laya.d3.resource.BaseTexture&&q$a._removeReference()}},q$_.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},q$_.setShaderName=function(q$S){var q$_=q$M_.nameKey.getID(q$S);if(-1===q$_)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=q$N_._preCompileShader[q$_]},q$_.cloneTo=function(q$S){var q$_=q$S;q$_.name=this.name,q$_.cull=this.cull,q$_.blend=this.blend,q$_.srcBlend=this.srcBlend,q$_.dstBlend=this.dstBlend,q$_.srcBlendRGB=this.srcBlendRGB,q$_.dstBlendRGB=this.dstBlendRGB,q$_.srcBlendAlpha=this.srcBlendAlpha,q$_.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(q$_.blendConstColor),q$_.blendEquation=this.blendEquation,q$_.blendEquationRGB=this.blendEquationRGB,q$_.blendEquationAlpha=this.blendEquationAlpha,q$_.depthTest=this.depthTest,q$_.depthWrite=this.depthWrite,q$_.renderQueue=this.renderQueue,q$_._shader=this._shader,q$_._disablePublicShaderDefine=this._disablePublicShaderDefine,q$_._shaderDefineValue=this._shaderDefineValue;var q$a,q$R=0,q$J=q$_._shaderValues;q$_._shaderValues.data.length=this._shaderValues.data.length;var q$V=this._values.length,q$W=q$_._values;for(q$R=0,q$a=q$W.length=q$V;q$R<q$a;q$R++){var q$k=this._values[q$R];if(q$k)if("number"==typeof q$k)q$W[q$R]=q$k,q$J.data[q$R]=q$k;else if("number"==typeof q$k&&Math.floor(q$k)==q$k)q$W[q$R]=q$k,q$J.data[q$R]=q$k;else if("boolean"==typeof q$k)q$W[q$R]=q$k,q$J.data[q$R]=q$k;else if(q$k instanceof laya.d3.math.Vector2){var q$z=q$W[q$R]||(q$W[q$R]=new q$V_);q$k.cloneTo(q$z),q$J.data[q$R]=q$z.elements}else if(q$k instanceof laya.d3.math.Vector3){var q$b=q$W[q$R]||(q$W[q$R]=new q$W_);q$k.cloneTo(q$b),q$J.data[q$R]=q$b.elements}else if(q$k instanceof laya.d3.math.Vector4){var q$H=q$W[q$R]||(q$W[q$R]=new q$k_);q$k.cloneTo(q$H),q$J.data[q$R]=q$H.elements}else if(q$k instanceof laya.d3.math.Matrix4x4){var q$L=q$W[q$R]||(q$W[q$R]=new q$S_);q$k.cloneTo(q$L),q$J.data[q$R]=q$L.elements}else q$k instanceof laya.d3.resource.BaseTexture&&(q$W[q$R]=q$k,q$J.data[q$R]=q$k)}},q$_.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$t(0,q$_,"alphaTestValue",function(){return this._getNumber(0)},function(q$S){this._setNumber(0,q$S)}),q$t(0,q$_,"alphaTest",function(){return this._alphaTest},function(q$S){(this._alphaTest=q$S)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),q$S.__init__=function(){q$S.SHADERDEFINE_ALPHATEST=q$S.shaderDefines.registerDefine("ALPHATEST")},q$S.RENDERQUEUE_OPAQUE=2e3,q$S.RENDERQUEUE_ALPHATEST=2450,q$S.RENDERQUEUE_TRANSPARENT=3e3,q$S.CULL_NONE=0,q$S.CULL_FRONT=1,q$S.CULL_BACK=2,q$S.BLEND_DISABLE=0,q$S.BLEND_ENABLE_ALL=1,q$S.BLEND_ENABLE_SEPERATE=2,q$S.BLENDPARAM_ZERO=0,q$S.BLENDPARAM_ONE=1,q$S.BLENDPARAM_SRC_COLOR=768,q$S.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,q$S.BLENDPARAM_DST_COLOR=774,q$S.BLENDPARAM_ONE_MINUS_DST_COLOR=775,q$S.BLENDPARAM_SRC_ALPHA=770,q$S.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,q$S.BLENDPARAM_DST_ALPHA=772,q$S.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,q$S.BLENDPARAM_SRC_ALPHA_SATURATE=776,q$S.BLENDEQUATION_ADD=0,q$S.BLENDEQUATION_SUBTRACT=1,q$S.BLENDEQUATION_REVERSE_SUBTRACT=2,q$S.DEPTHTEST_OFF=0,q$S.DEPTHTEST_NEVER=512,q$S.DEPTHTEST_LESS=513,q$S.DEPTHTEST_EQUAL=514,q$S.DEPTHTEST_LEQUAL=515,q$S.DEPTHTEST_GREATER=516,q$S.DEPTHTEST_NOTEQUAL=517,q$S.DEPTHTEST_GEQUAL=518,q$S.DEPTHTEST_ALWAYS=519,q$S.SHADERDEFINE_ALPHATEST=1,q$S.ALPHATESTVALUE=0,q$L(q$S,["shaderDefines",function(){return this.shaderDefines=new q$H_}]),q$S}(q$$),q$A_=function(q$S){function q$_(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,q$_.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}q$G(q$_,"laya.d3.resource.BaseTexture",q$$);var q$a=q$_.prototype;return q$t(0,q$a,"width",function(){return this._width}),q$t(0,q$a,"repeat",function(){return this._repeat},function(q$S){if(this._repeat!==q$S&&(this._repeat=q$S,this._source)){var q$_=q$A.mainContext;q$X.bindTexture(q$_,this._type,this._source),q$j.isPOT(this._width,this._height)&&this._repeat?(q$_.texParameteri(this._type,10242,10497),q$_.texParameteri(this._type,10243,10497)):(q$_.texParameteri(this._type,10242,33071),q$_.texParameteri(this._type,10243,33071))}}),q$t(0,q$a,"height",function(){return this._height}),q$t(0,q$a,"magFifter",function(){return this._magFifter},function(q$S){(this._magFifter=q$S)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(q$S)}),q$t(0,q$a,"wrapModeV",function(){return this._wrapModeV}),q$t(0,q$a,"size",function(){return this._size}),q$t(0,q$a,"wrapModeU",function(){return this._wrapModeU}),q$t(0,q$a,"mipmap",function(){return this._mipmap},function(q$S){this._mipmap=q$S,this._mipmap!=q$S&&this._conchTexture&&this._conchTexture.setMipMap(q$S)}),q$t(0,q$a,"minFifter",function(){return this._minFifter},function(q$S){this._minFifter=q$S,this._minFifter!=q$S&&this._conchTexture&&this._conchTexture.setMinFifter(q$S)}),q$t(0,q$a,"format",function(){return this._format}),q$t(0,q$a,"source",function(){return this.activeResource(),this._source}),q$t(0,q$a,"defaulteTexture",function(){return q$f_.grayTexture}),q$_.WARPMODE_REPEAT=0,q$_.WARPMODE_CLAMP=1,q$_}(),q$X_=function(q$S){function q$_(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,q$_.__super.call(this),this._boundingBoxCorners=q$R(8,null)}q$G(q$_,"laya.d3.resource.models.BaseMesh",q$$);var q$a=q$_.prototype;return q$a._getPositions=function(){throw new Error("未Override,请重载该属性！")},q$a._generateBoundingObject=function(){this._boundingSphere=new q$wS(new q$W_,0),q$wS.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new q$ES(new q$W_,new q$W_),q$ES.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},q$a.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},q$a.getRenderElement=function(q$S){throw new Error("未Override,请重载该属性！")},q$t(0,q$a,"subMeshCount",function(){return this._subMeshCount}),q$t(0,q$a,"boundingBox",function(){return this._boundingBox}),q$t(0,q$a,"boundingBoxCorners",function(){return this._boundingBoxCorners}),q$t(0,q$a,"boundingSphere",function(){return this._boundingSphere}),q$_}(),q$h_=(function(q$S){function q$_(){q$_.__super.call(this)}q$G(q$_,"laya.d3.component.Script",q$D_);var q$a=q$_.prototype;q$a.onTriggerEnter=function(q$S){},q$a.onTriggerExit=function(q$S){},q$a.onTriggerStay=function(q$S){},q$t(0,q$a,"isSingleton",function(){return q$_._isSingleton}),q$_._isSingleton=!1}(),function(q$S){function q$_(q$S){this._owner=null,this._sharedMesh=null,q$_.__super.call(this),this._owner=q$S}q$G(q$_,"laya.d3.core.MeshFilter",q$S);var q$a=q$_.prototype;return q$a._sharedMeshLoaded=function(){this.event("loaded")},q$a._destroy=function(){q$S.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},q$t(0,q$a,"sharedMesh",function(){return this._sharedMesh},function(q$S){var q$_=this._sharedMesh;q$_&&q$_._removeReference(),(this._sharedMesh=q$S)._addReference(),this.event("meshchanged",[this,q$_,q$S]),q$S.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),q$t(0,q$a,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),q$t(0,q$a,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),q$t(0,q$a,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),q$t(0,q$a,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),q$_}(q$j_)),q$u_=function(q$S){function q$_(q$S){q$_.__super.call(this,q$S),q$S.meshFilter.on("meshchanged",this,this._onMeshChanged)}q$G(q$_,"laya.d3.core.MeshRender",q$Q_);var q$a=q$_.prototype;return q$a._onMeshChanged=function(q$S,q$_,q$a){q$a.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:q$a.once("loaded",this,this._onMeshLoaed)},q$a._onMeshLoaed=function(q$S,q$_){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},q$a._calculateBoundingSphereByInitSphere=function(q$S){var q$_=NaN,q$a=this._owner.transform,q$R=q$a.scale.elements,q$J=Math.abs(q$R[0]),q$V=Math.abs(q$R[1]),q$W=Math.abs(q$R[2]);q$_=q$V<=q$J&&q$W<=q$J?q$J:q$W<=q$V?q$V:q$W,q$W_.transformCoordinate(q$S.center,q$a.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=q$S.radius*q$_},q$a._calculateBoundBoxByInitCorners=function(q$S){for(var q$_=this._owner.transform.worldMatrix,q$a=0;q$a<8;q$a++)q$W_.transformCoordinate(q$S[q$a],q$_,q$Q_._tempBoundBoxCorners[q$a]);q$ES.createfromPoints(q$Q_._tempBoundBoxCorners,this._boundingBox)},q$a._calculateBoundingSphere=function(){var q$S=this._owner.meshFilter.sharedMesh;null==q$S||null==q$S.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(q$S.boundingSphere)},q$a._calculateBoundingBox=function(){var q$S=this._owner.meshFilter.sharedMesh;null==q$S||null==q$S.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(q$S.boundingBoxCorners)},q$a._renderUpdate=function(q$S){var q$_=this._owner.transform;if(q$_){this._setShaderValueMatrix4x4(0,q$_.worldMatrix);var q$a=this._owner.getProjectionViewWorldMatrix(q$S);this._setShaderValueMatrix4x4(1,q$a)}else this._setShaderValueMatrix4x4(0,q$S_.DEFAULT),this._setShaderValueMatrix4x4(1,q$S);return q$F_.debugMode&&this._renderRenderableBoundBox(),!0},q$_}(),q$K_=function(q$_){function q$R(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,q$R.__super.call(this),this._renderState=new q$y,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new q$C_,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new q$_S,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new q$W_(.7,.7,.7),this.ambientColor=new q$W_(.212,.227,.259),q$A.shaderHighPrecision&&this.addShaderDefine(q$N_.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}q$G(q$R,"laya.d3.core.scene.Scene",q$_);var q$S=q$R.prototype;return q$Q.imps(q$S,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),q$S._setUrl=function(q$S){this._url=q$S},q$S._getGroup=function(){return this._group},q$S._setGroup=function(q$S){this._group=q$S},q$S._display=function(){q$Q.stage._scenes.push(this),q$Q.stage._scenes.sort(q$R._sortScenes);for(var q$S=0,q$_=this._childs.length;q$S<q$_;q$S++){var q$a=this._childs[q$S];q$a.active&&q$a._activeHierarchy()}},q$S._unDisplay=function(){var q$S=q$Q.stage._scenes;q$S.splice(q$S.indexOf(this),1);for(var q$_=0,q$a=this._childs.length;q$_<q$a;q$_++){var q$R=this._childs[q$_];q$R.active&&q$R._inActiveHierarchy()}},q$S._addChild3D=function(q$S){q$S.transform._onWorldTransform(),q$S._setBelongScene(this),this.displayedInStage&&q$S.active&&q$S._activeHierarchy()},q$S._removeChild3D=function(q$S){q$S.transform.parent=null,this.displayedInStage&&q$S.active&&q$S._inActiveHierarchy(),q$S._setUnBelongScene()},q$S.initOctree=function(q$S,q$_,q$a,q$R,q$J){void 0===q$J&&(q$J=6),this.treeSize=new q$W_(q$S,q$_,q$a),this.treeLevel=q$J,this.treeRoot=new q$E(this,0),this.treeRoot.init(q$R,this.treeSize)},q$S._prepareUpdateToRenderState=function(q$S,q$_){q$_.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,q$_.scene=this},q$S._prepareSceneToRender=function(q$S){var q$_=this._lights.length;if(0<q$_)for(var q$a=0,q$R=0;q$R<q$_&&!(this._lights[q$R]._prepareToScene(q$S)&&++q$a>=this._enableLightCount);q$R++);},q$S._updateChilds=function(q$S){for(var q$_=0,q$a=this._childs.length;q$_<q$a;++q$_)this._childs[q$_]._update(q$S)},q$S._preRenderScene=function(q$S,q$_,q$a){var q$R,q$J=q$_._viewMatrix,q$V=q$_._projectionMatrix,q$W=q$_._projectionViewMatrix,q$k=0,q$z=q$_.camera;for(q$z.useOcclusionCulling?this.treeRoot?q$aS.renderObjectCullingOctree(q$a,this,q$z,q$J,q$V,q$W):q$aS.renderObjectCulling(q$a,this,q$z,q$J,q$V,q$W):q$aS.renderObjectCullingNoBoundFrustum(this,q$z,q$J,q$V,q$W),q$k=0,q$R=this._quenes.length;q$k<q$R;q$k++)this._quenes[q$k]&&this._quenes[q$k]._preRender(q$_)},q$S._clear=function(q$S,q$_){var q$a=q$_._viewport,q$R=q$_.camera,q$J=q$a.x,q$V=q$R.renderTargetSize.height-q$a.y-q$a.height,q$W=q$a.width,q$k=q$a.height;q$S.viewport(q$J,q$V,q$W,q$k);var q$z=256,q$b=q$R.renderTarget;switch(q$R.clearFlag){case 0:var q$H=q$R.clearColor;if(q$H){q$S.enable(3089),q$S.scissor(q$J,q$V,q$W,q$k);var q$L=q$H.elements;q$S.clearColor(q$L[0],q$L[1],q$L[2],q$L[3]),q$z|=16384}if(q$b)switch(q$H||(q$z=16384),q$b.depthStencilFormat){case 33189:q$z|=256;break;case 36168:q$z|=1024;break;case 34041:q$z|=256,q$z|=1024}q$S.clear(q$z),q$H&&q$S.disable(3089);break;case 1:case 2:if(q$b)switch(q$z=16384,q$b.depthStencilFormat){case 33189:q$z|=256;break;case 36168:q$z|=1024;break;case 34041:q$z|=256,q$z|=1024}q$S.clear(q$z);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},q$S._renderScene=function(q$S,q$_){var q$a,q$R,q$J=q$_.camera,q$V=0;for(q$V=0;q$V<2;q$V++)(q$R=this._quenes[q$V])&&(q$J.renderTarget?q$R._render(q$_,!0):q$R._render(q$_,!1));if(1===q$J.clearFlag){var q$W=q$J.sky;q$W&&(q$X.setCullFace(q$S,!1),q$X.setDepthFunc(q$S,515),q$X.setDepthMask(q$S,!1),q$W._render(q$_),q$X.setDepthFunc(q$S,513),q$X.setDepthMask(q$S,!0))}for(q$V=2,q$a=this._quenes.length;q$V<q$a;q$V++)(q$R=this._quenes[q$V])&&(q$R._sortAlpha(q$_.camera.transform.position),q$J.renderTarget?q$R._render(q$_,!0):q$R._render(q$_,!1))},q$S._set3DRenderConfig=function(q$S){q$S.disable(3042),q$X._blend=!1,q$S.blendFunc(770,771),q$X._sFactor=770,q$X._dFactor=771,q$S.disable(2929),q$X._depthTest=!1,q$S.enable(2884),q$X._cullFace=!0,q$S.depthMask(1),q$X._depthMask=!0,q$S.frontFace(2304),q$X._frontFace=2304},q$S._set2DRenderConfig=function(q$S){q$X.setBlend(q$S,!0),q$X.setBlendFunc(q$S,1,771),q$X.setDepthTest(q$S,!1),q$X.setCullFace(q$S,!1),q$X.setDepthMask(q$S,!0),q$X.setFrontFace(q$S,2305),q$S.viewport(0,0,q$H.width,q$H.height)},q$S._parseCustomProps=function(q$S,q$_,q$a,q$R){var q$J=q$R.customProps.lightmaps,q$V=q$J.length,q$W=this._lightmaps;q$W.length=q$V;for(var q$k=0;q$k<q$V;q$k++)q$W[q$k]=q$F.getRes(q$_[q$J[q$k].replace(".exr",".png")]);this.setlightmaps(q$W);var q$z=q$R.customProps.ambientColor;q$z&&(this.ambientColor=new q$W_(q$z[0],q$z[1],q$z[2]));var q$b=q$R.customProps.fogColor;q$b&&(this.fogColor=new q$W_(q$b[0],q$b[1],q$b[2]))},q$S._addLight=function(q$S){this._lights.indexOf(q$S)<0&&this._lights.push(q$S)},q$S._removeLight=function(q$S){var q$_=this._lights.indexOf(q$S);0<=q$_&&this._lights.splice(q$_,1)},q$S._updateScene=function(){var q$S=this._renderState;this._prepareUpdateToRenderState(q$A.mainContext,q$S),this._updateComponents(q$S),this._updateChilds(q$S),this._lateUpdateComponents(q$S),this._time+=q$S.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},q$S._updateSceneConch=function(){var q$S=this._renderState;this._prepareUpdateToRenderState(q$A.mainContext,q$S),this._updateComponents(q$S),this._lateUpdateComponents(q$S),this._prepareSceneToRender(q$S);for(var q$_=0,q$a=this._cameraPool.length;q$_<q$a;q$_++){var q$R=this._cameraPool[q$_];(q$S.camera=q$R)._prepareCameraToRender()}},q$S._preRenderShadow=function(q$S,q$_,q$a,q$R,q$J){this.treeRoot?q$aS.renderShadowObjectCullingOctree(this,q$_,q$a,q$R,q$J):q$aS.renderShadowObjectCulling(this,q$_,q$a,q$R,q$J);for(var q$V=0,q$W=q$a.length;q$V<q$W;q$V++)q$a[q$V]&&q$a[q$V]._preRender(q$S)},q$S._renderShadowMap=function(q$S,q$_,q$a){var q$R=this.parallelSplitShadowMaps[0];q$R._calcAllLightCameraInfo(q$a);var q$J,q$V,q$W,q$k=q$R.PSSMNum;if(this._preRenderShadow(q$_,q$R._lightCulling,q$R._shadowQuenes,q$R._lightVPMatrix[0],q$k),this.addShaderDefine(q$G_.SHADERDEFINE_CAST_SHADOW),1<q$k)for(var q$z=0;q$z<q$k;q$z++)q$J=q$R.getRenderTarget(q$z+1),q$R.beginRenderTarget(q$z+1),q$S.clearColor(1,1,1,1),q$S.clear(16640),q$S.viewport(0,0,q$J.width,q$J.height),q$_.camera=q$W=q$R.getLightCamera(q$z),q$W._prepareCameraToRender(),q$W._prepareCameraViewProject(q$W.viewMatrix,q$W.projectionMatrix),q$_._projectionViewMatrix=q$R._lightVPMatrix[q$z+1],(q$V=q$R._shadowQuenes[q$z])._preRender(q$_),q$V._renderShadow(q$_,!1),q$R.endRenderTarget(q$z+1);else q$J=q$R.getRenderTarget(1),q$R.beginRenderTarget(1),q$S.clearColor(1,1,1,1),q$S.clear(16640),q$S.viewport(0,0,q$J.width,q$J.height),q$_.camera=q$W=q$R.getLightCamera(0),q$W._prepareCameraToRender(),q$W._prepareCameraViewProject(q$W.viewMatrix,q$W.projectionMatrix),q$_._projectionViewMatrix=q$R._lightVPMatrix[0],(q$V=q$R._shadowQuenes[0])._preRender(q$_),q$V._renderShadow(q$_,!0),q$R.endRenderTarget(1);this.removeShaderDefine(q$G_.SHADERDEFINE_CAST_SHADOW)},q$S.addTreeNode=function(q$S){this.treeRoot.addTreeNode(q$S)},q$S.removeTreeNode=function(q$S){this.treeSize&&q$S._treeNode&&q$S._treeNode.removeObject(q$S)},q$S.setlightmaps=function(q$S){this._lightmaps=q$S;for(var q$_=0,q$a=this._renderableSprite3Ds.length;q$_<q$a;q$_++)this._renderableSprite3Ds[q$_]._render._applyLightMapParams()},q$S.getlightmaps=function(){return this._lightmaps},q$S.addChildAt=function(q$S,q$_){if(!(q$S instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(q$S&&q$S.__className));if(!q$S||this.destroyed||q$S===this)return q$S;if(q$S.zOrder&&this._set$P("hasZorder",!0),0<=q$_&&q$_<=this._childs.length){if(q$S._parent===this){var q$a=this.getChildIndex(q$S);this._childs.splice(q$a,1),this._childs.splice(q$_,0,q$S),this.conchModel&&(this.conchModel.removeChild(q$S.conchModel),this.conchModel.addChildAt(q$S.conchModel,q$_)),this._childChanged()}else q$S.parent&&q$S.parent.removeChild(q$S),this._childs===q$b.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(q$_,0,q$S),this.conchModel&&this.conchModel.addChildAt(q$S.conchModel,q$_),(q$S.parent=this)._addChild3D(q$S);return q$S}throw new Error("appendChildAt:The index is out of bounds")},q$S.addChild=function(q$S){if(!(q$S instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!q$S||this.destroyed||q$S===this)return q$S;if(q$S.zOrder&&this._set$P("hasZorder",!0),q$S._parent===this){var q$_=this.getChildIndex(q$S);q$_!==this._childs.length-1&&(this._childs.splice(q$_,1),this._childs.push(q$S),this.conchModel&&(this.conchModel.removeChild(q$S.conchModel),this.conchModel.addChildAt(q$S.conchModel,this._childs.length-1)),this._childChanged())}else q$S.parent&&q$S.parent.removeChild(q$S),this._childs===q$b.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(q$S),this.conchModel&&this.conchModel.addChildAt(q$S.conchModel,this._childs.length-1),(q$S.parent=this)._childChanged(),this._addChild3D(q$S);return q$S},q$S.removeChildAt=function(q$S){var q$_=this.getChildAt(q$S);return q$_&&(this._removeChild3D(q$_),this._childs.splice(q$S,1),this.conchModel&&this.conchModel.removeChild(q$_.conchModel),q$_.parent=null),q$_},q$S.removeChildren=function(q$S,q$_){if(void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=2147483647),this._childs&&0<this._childs.length){var q$a=this._childs;if(0===q$S&&q$V<=q$_){var q$R=q$a;this._childs=q$b.ARRAY_EMPTY}else q$R=q$a.splice(q$S,q$_-q$S);for(var q$J=0,q$V=q$R.length;q$J<q$V;q$J++)this._removeChild3D(q$R[q$J]),q$R[q$J].parent=null,this.conchModel&&this.conchModel.removeChild(q$R[q$J].conchModel)}return this},q$S.addFrustumCullingObject=function(q$S){this.treeRoot?this.addTreeNode(q$S):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(q$S):this._cullingRenders[this._cullingRendersLength]=q$S,q$S._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},q$S.removeFrustumCullingObject=function(q$S){if(this.treeRoot)this.removeTreeNode(q$S);else{this._cullingRendersLength--;var q$_=q$S._indexInSceneFrustumCullingObjects;if(q$_!==this._cullingRendersLength){var q$a=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[q$_]=q$a)._indexInSceneFrustumCullingObjects=q$_,q$S._indexInSceneFrustumCullingObjects=-1}}},q$S.getRenderQueue=function(q$S){return q$S<3e3?this._quenes[1]||(this._quenes[1]=new q$c(this)):this._quenes[2]||(this._quenes[2]=new q$c(this))},q$S.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new q$c(this)},q$S.addShaderDefine=function(q$S){this._shaderDefineValue|=q$S},q$S.removeShaderDefine=function(q$S){this._shaderDefineValue&=~q$S},q$S.addScript=function(q$S){return this._addComponent(q$S)},q$S.getScriptByType=function(q$S,q$_){return void 0===q$_&&(q$_=0),this._getComponentByType(q$S,q$_)},q$S.getScriptsByType=function(q$S,q$_){this._getComponentsByType(q$S,q$_)},q$S.getScriptByIndex=function(q$S){return this._getComponentByIndex(q$S)},q$S.removeScriptByType=function(q$S,q$_){void 0===q$_&&(q$_=0),this._removeComponentByType(q$S,q$_)},q$S.removeScriptsByType=function(q$S){this._removeComponentByType(q$S)},q$S.removeAllScript=function(){this._removeAllComponent()},q$S.render=function(q$S,q$_,q$a){(q$o._context.ctx._renderKey=0)<this._childs.length&&q$S.addRenderObject(this)},q$S.renderSubmit=function(){var q$S=q$A.mainContext,q$_=this._renderState;this._set3DRenderConfig(q$S),this._prepareSceneToRender(this._renderState);var q$a,q$R=0,q$J=0;if(q$F_.debugMode||q$E.debugMode)for(q$R=0,q$J=this._cameraPool.length;q$R<q$J;q$R++)q$a=this._cameraPool[q$R],q$F_._debugPhasorSprite.begin(1,q$a),q$a.activeInHierarchy&&q$a._renderCamera(q$S,q$_,this),q$F_._debugPhasorSprite.end();else for(q$R=0,q$J=this._cameraPool.length;q$R<q$J;q$R++)(q$a=this._cameraPool[q$R]).activeInHierarchy&&q$a._renderCamera(q$S,q$_,this);return this._set2DRenderConfig(q$S),1},q$S.onAsynLoaded=function(q$S,q$_,q$a){var q$R=q$_[0];if("Scene"!==q$R.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var q$J=q$_[1];q$$_._createNodeByJson(this,q$R,this,q$J),this.event("hierarchyloaded",[this]),this.__loaded=!0},q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),this.destroyed||(q$_.prototype.destroy.call(this,q$S),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,q$F.clearRes(this.url),this.loaded||q$F_._cancelLoadByUrl(this.url))},q$S.getRenderType=function(){return 0},q$S.releaseRender=function(){},q$S._addComponent=function(q$S){var q$_,q$a=this._componentsMap.indexOf(q$S);if(-1===q$a)q$_=[],this._componentsMap.push(q$S),this._typeComponentsIndices.push(q$_);else if(q$_=this._typeComponentsIndices[q$a],this._components[q$_[0]].isSingleton)throw new Error("无法单实例创建"+q$S+"组件，"+q$S+"组件已存在！");var q$R=q$J.getInstance(q$S);q$_.push(this._components.length),this._components.push(q$R);return q$R._initialize(this),q$R},q$S._removeComponent=function(q$S,q$_){var q$a=this._typeComponentsIndices[q$S],q$R=q$a[q$_],q$J=this._components[q$R];this._components.splice(q$R,1),q$a.splice(q$_,1),0===q$a.length&&(this._typeComponentsIndices.splice(q$S,1),this._componentsMap.splice(q$S,1));for(var q$V=0,q$W=this._componentsMap.length;q$V<q$W;q$V++)for(var q$k=(q$a=this._typeComponentsIndices[q$V]).length-1;0<=q$k;q$k--){var q$z=q$a[q$k];if(!(q$R<q$z))break;q$a[q$k]=--q$z}q$J._destroy()},q$S._getComponentByType=function(q$S,q$_){void 0===q$_&&(q$_=0);var q$a=this._componentsMap.indexOf(q$S);return-1===q$a?null:this._components[this._typeComponentsIndices[q$a][q$_]]},q$S._getComponentsByType=function(q$S,q$_){var q$a=this._componentsMap.indexOf(q$S);if(-1!==q$a){var q$R=this._typeComponentsIndices[q$a],q$J=q$R.length;q$_.length=q$J;for(var q$V=0;q$V<q$J;q$V++)q$_[q$V]=this._components[q$R[q$V]]}else q$_.length=0},q$S._getComponentByIndex=function(q$S){return this._components[q$S]},q$S._removeComponentByType=function(q$S,q$_){void 0===q$_&&(q$_=0);var q$a=this._componentsMap.indexOf(q$S);-1!==q$a&&this._removeComponent(q$a,q$_)},q$S._removeComponentsByType=function(q$S){var q$_=this._componentsMap.indexOf(q$S);if(-1!==q$_)for(var q$a=this._typeComponentsIndices[q$_],q$R=0,q$J=q$a.length;q$R<q$J;q$a.length<q$J?q$J--:q$R++)this._removeComponent(q$_,q$R)},q$S._removeAllComponent=function(){for(var q$S=0,q$_=this._componentsMap.length;q$S<q$_;this._componentsMap.length<q$_?q$_--:q$S++)this._removeComponentsByType(this._componentsMap[q$S])},q$S._updateComponents=function(q$S){for(var q$_=0,q$a=this._components.length;q$_<q$a;q$_++){var q$R=this._components[q$_];!q$R.started&&(q$R._start(q$S),q$R.started=!0),q$R.enable&&q$R._update(q$S)}},q$S._lateUpdateComponents=function(q$S){for(var q$_=0;q$_<this._components.length;q$_++){var q$a=this._components[q$_];!q$a.started&&(q$a._start(q$S),q$a.started=!0),q$a.enable&&q$a._lateUpdate(q$S)}},q$S._preRenderUpdateComponents=function(q$S){for(var q$_=0;q$_<this._components.length;q$_++){var q$a=this._components[q$_];!q$a.started&&(q$a._start(q$S),q$a.started=!0),q$a.enable&&q$a._preRenderUpdate(q$S)}},q$S._postRenderUpdateComponents=function(q$S){for(var q$_=0;q$_<this._components.length;q$_++){var q$a=this._components[q$_];!q$a.started&&(q$a._start(q$S),q$a.started=!0),q$a.enable&&q$a._postRenderUpdate(q$S)}},q$t(0,q$S,"_loaded",null,function(q$S){this.__loaded=q$S}),q$t(0,q$S,"fogColor",function(){return this._fogColor},function(q$S){this._fogColor=q$S,this._shaderValues.setValue(0,q$S.elements)}),q$t(0,q$S,"enableFog",function(){return this._enableFog},function(q$S){this._enableFog!==q$S&&((this._enableFog=q$S)?(this.addShaderDefine(q$N_.SHADERDEFINE_FOG),this.removeShaderDefine(q$N_.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(q$N_.SHADERDEFINE_FOG))}),q$t(0,q$S,"url",function(){return this._url}),q$t(0,q$S,"loaded",function(){return this.__loaded}),q$t(0,q$S,"enableDepthFog",function(){return this._enableDepthFog},function(q$S){this._enableDepthFog!=q$S&&((this._enableDepthFog=q$S)?(this.addShaderDefine(q$N_.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(q$N_.SHADERDEFINE_FOG)):this.removeShaderDefine(q$N_.SAHDERDEFINE_DEPTHFOG))}),q$t(0,q$S,"fogStart",function(){return this._fogStart},function(q$S){this._fogStart=q$S,this._shaderValues.setValue(1,q$S)}),q$t(0,q$S,"fogRange",function(){return this._fogRange},function(q$S){this._fogRange=q$S,this._shaderValues.setValue(2,q$S)}),q$t(0,q$S,"ambientColor",function(){return this._ambientColor},function(q$S){this._ambientColor=q$S,this._shaderValues.setValue(21,q$S.elements)}),q$t(0,q$S,"scene",function(){return this}),q$t(0,q$S,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),q$R._sortScenes=function(q$S,q$_){if(q$S.parent!==q$Q.stage||q$_.parent!==q$Q.stage)return q$S.parent!==q$Q.stage&&q$_.parent!==q$Q.stage?q$R._sortScenes(q$S.parent,q$_.parent):q$S.parent===q$Q.stage?-1:1;var q$a=q$Q.stage._childs;return q$a.indexOf(q$S)-q$a.indexOf(q$_)},q$R.load=function(q$S){return q$Q.loader.create(q$S,null,null,q$R)},q$R.FOGCOLOR=0,q$R.FOGSTART=1,q$R.FOGRANGE=2,q$R.LIGHTDIRECTION=3,q$R.LIGHTDIRCOLOR=4,q$R.POINTLIGHTPOS=5,q$R.POINTLIGHTRANGE=6,q$R.POINTLIGHTATTENUATION=7,q$R.POINTLIGHTCOLOR=8,q$R.SPOTLIGHTPOS=9,q$R.SPOTLIGHTDIRECTION=10,q$R.SPOTLIGHTSPOT=11,q$R.SPOTLIGHTRANGE=12,q$R.SPOTLIGHTATTENUATION=13,q$R.SPOTLIGHTCOLOR=14,q$R.SHADOWDISTANCE=15,q$R.SHADOWLIGHTVIEWPROJECT=16,q$R.SHADOWMAPPCFOFFSET=17,q$R.SHADOWMAPTEXTURE1=18,q$R.SHADOWMAPTEXTURE2=19,q$R.SHADOWMAPTEXTURE3=20,q$R.AMBIENTCOLOR=21,q$R.TIME=22,q$R}(q$q),q$P_=function(q$S){function q$_(q$S){q$_.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new q$S_,this._shaderValues=new q$C_,this._colliders=[],this._id=++q$_._uniqueIDCounter,this._transform=new q$m_(this),this.name=q$S||"Sprite3D-"+q$_._nameNumberCounter++,this.layer=q$u.currentCreationLayer,this.active=!0}q$G(q$_,"laya.d3.core.Sprite3D",q$B_);var q$a=q$_.prototype;return q$Q.imps(q$a,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),q$a._setUrl=function(q$S){this._url=q$S},q$a._getGroup=function(){return this._group},q$a._setGroup=function(q$S){this._group=q$S},q$a._addChild3D=function(q$S){q$S.transform.parent=this.transform,this._hierarchyAnimator&&(!q$S._hierarchyAnimator&&q$S._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(q$S,!0,[q$S.name])),this._scene&&(q$S._setBelongScene(this._scene),this._activeInHierarchy&&q$S._active&&q$S._activeHierarchy())},q$a._removeChild3D=function(q$S){q$S.transform.parent=null,this._scene&&(this._activeInHierarchy&&q$S._active&&q$S._inActiveHierarchy(),q$S._setUnBelongScene()),this._hierarchyAnimator&&(q$S._hierarchyAnimator==this._hierarchyAnimator&&q$S._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(q$S,!1,[q$S.name]))},q$a._parseBaseCustomProps=function(q$S){var q$_=this.transform.localPosition;q$S.translate?(q$_.fromArray(q$S.translate),q$_.x*=100,q$_.y*=100,q$_.z*=100):q$_.elements.fill(0),this.transform.localPosition=q$_;var q$a=this.transform.localRotation;q$S.rotation?q$a.fromArray(q$S.rotation):q$a.fromArray([0,0,0,-1]),this.transform.localRotation=q$a;var q$R=this.transform.localScale;q$S.scale?q$R.fromArray(q$S.scale):q$R.elements.fill(1),this.transform.localScale=q$R;var q$J=q$S.layer;null!=q$J&&(this.layer=q$u.getLayerByNumber(q$J))},q$a._parseCustomComponent=function(q$S,q$_,q$a){for(var q$R in q$a){var q$J=q$a[q$R];switch(q$R){case"Animator":var q$V=this.addComponent(Animator);if(q$J.avatarPath)q$V.avatar=q$F.getRes(q$_[q$J.avatarPath]);else{var q$W=q$J.avatar;if(q$W){q$V.avatar=q$F.getRes(q$_[q$W.path]);var q$k=q$W.linkSprites;q$k&&q$S.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[q$V,q$k])}}for(var q$z=q$J.clipPaths,q$b=q$z.length,q$H=0;q$H<q$b;q$H++)q$V.addClip(q$F.getRes(q$_[q$z[q$H]]));q$V.clip=q$F.getRes(q$_[q$z[0]]);var q$L=q$J.playOnWake;void 0!==q$L&&(q$V.playOnWake=q$L);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var q$C=this.addComponent(SphereCollider);q$C.isTrigger=q$J.isTrigger;var q$G=q$C.center;q$G.fromArray(q$J.center),q$C.center=q$G,q$C.radius=q$J.radius;break;case"BoxCollider":var q$t=this.addComponent(BoxCollider);q$t.isTrigger=q$J.isTrigger,q$t.center.fromArray(q$J.center);var q$o=q$t.size;q$o.fromArray(q$J.size),q$t.size=q$o;break;case"MeshCollider":this.addComponent(MeshCollider)}}},q$a._onRootNodeHierarchyLoaded=function(q$S,q$_){for(var q$a in q$_){for(var q$R=this,q$J=q$_[q$a],q$V=0,q$W=q$J.length;q$V<q$W;q$V++){var q$k=q$J[q$V];if(""===q$k)break;if(!(q$R=q$R.getChildByName(q$k)))break}q$R&&q$S.linkSprite3DToAvatarNode(q$a,q$R)}},q$a._setHierarchyAnimator=function(q$S,q$_){this._changeHierarchyAnimator(q$S);for(var q$a=0,q$R=this._childs.length;q$a<q$R;q$a++){var q$J=this._childs[q$a];q$J._hierarchyAnimator==q$_&&q$J._setHierarchyAnimator(q$S,q$_)}},q$a._clearHierarchyAnimator=function(q$S,q$_){this._changeHierarchyAnimator(q$_);for(var q$a=0,q$R=this._childs.length;q$a<q$R;q$a++){var q$J=this._childs[q$a];q$J._hierarchyAnimator==q$S&&q$J._clearHierarchyAnimator(q$S,q$_)}},q$a._getAnimatorToLinkSprite3D=function(q$S,q$_,q$a){var q$R=this.getComponentByType(Animator);if(q$R&&(q$R.avatar?q$R.avatar._version||q$S._setAnimatorToLinkAvatar(q$R,q$_):q$S._setAnimatorToLinkSprite3DNoAvatar(q$R,q$_,q$a)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){q$a.unshift(this._parent.name);var q$J=this._parent;q$J._hierarchyAnimator&&q$J._getAnimatorToLinkSprite3D(q$S,q$_,q$a)}},q$a._setAnimatorToLinkSprite3DNoAvatar=function(q$S,q$_,q$a){var q$R=0,q$J=0;for(q$R=0,q$J=q$S.getClipCount();q$R<q$J;q$R++)q$S._handleSpriteOwnersBySprite(q$R,q$_,q$a,this);for(q$R=0,q$J=this._childs.length;q$R<q$J;q$R++){var q$V=this._childs[q$R],q$W=q$a.length;q$a.push(q$V.name),q$V._setAnimatorToLinkSprite3DNoAvatar(q$S,q$_,q$a),q$a.splice(q$W,1)}},q$a._changeHierarchyAnimator=function(q$S){this._hierarchyAnimator=q$S},q$a._isLinkSpriteToAnimationNode=function(q$S,q$_,q$a){var q$R=q$S._avatarNodes.indexOf(q$_),q$J=q$S._cacheSpriteToNodesMap;if(q$a)this._transform.dummy=q$_.transform,q$S._cacheNodesToSpriteMap[q$R]=q$J.length,q$J.push(q$R);else{this._transform.dummy=null;var q$V=q$S._cacheNodesToSpriteMap[q$R];q$S._cacheNodesToSpriteMap[q$R]=null,q$J.splice(q$V,1)}},q$a._setBelongScene=function(q$S){this._scene=q$S;for(var q$_=0,q$a=this._childs.length;q$_<q$a;q$_++)this._childs[q$_]._setBelongScene(q$S)},q$a._setUnBelongScene=function(){this._scene=null;for(var q$S=0,q$_=this._childs.length;q$S<q$_;q$S++)this._childs[q$S]._setUnBelongScene()},q$a._activeHierarchy=function(){var q$S=0,q$_=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),q$S=0,q$_=this._colliders.length;q$S<q$_;q$S++)this._layer._addCollider(this._colliders[q$S]);for(this.event("activeinhierarchychanged",!0),q$S=0,q$_=this._childs.length;q$S<q$_;q$S++){var q$a=this._childs[q$S];q$a._active&&q$a._activeHierarchy()}},q$a._inActiveHierarchy=function(){var q$S=0,q$_=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),q$S=0,q$_=this._colliders.length;q$S<q$_;q$S++){var q$a=this._colliders[q$S];q$a._clearCollsionMap(),this._layer._removeCollider(q$a)}for(this.event("activeinhierarchychanged",!1),q$S=0,q$_=this._childs.length;q$S<q$_;q$S++){var q$R=this._childs[q$S];q$R._active&&q$R._inActiveHierarchy()}},q$a.addComponent=function(q$S){var q$_,q$a=this._componentsMap.indexOf(q$S);if(-1===q$a)q$_=[],this._componentsMap.push(q$S),this._typeComponentsIndices.push(q$_);else if(q$_=this._typeComponentsIndices[q$a],this._components[q$_[0]].isSingleton)throw new Error("无法单实例创建"+q$S+"组件，"+q$S+"组件已存在！");var q$R=q$J.getInstance(q$S);return q$_.push(this._components.length),this._components.push(q$R),q$R instanceof laya.d3.component.Script&&this._scripts.push(q$R),q$R._initialize(this),q$R},q$a._removeComponent=function(q$S,q$_){var q$a,q$R=0,q$J=this._typeComponentsIndices[q$S],q$V=q$J[q$_],q$W=this._components[q$V];for(q$W instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(q$W),1),q$J.splice(q$_,1),0===q$J.length&&(this._typeComponentsIndices.splice(q$S,1),this._componentsMap.splice(q$S,1)),q$R=0,q$a=this._componentsMap.length;q$R<q$a;q$R++)for(var q$k=(q$J=this._typeComponentsIndices[q$R]).length-1;0<=q$k;q$k--){var q$z=q$J[q$k];if(!(q$V<q$z))break;q$J[q$k]=--q$z}q$W._destroy()},q$a._clearSelfRenderObjects=function(){},q$a._addSelfRenderObjects=function(){},q$a._parseCustomProps=function(q$S,q$_,q$a,q$R){},q$a._updateChilds=function(q$S){var q$_=this._childs.length;if(0!==q$_)for(var q$a=0;q$a<q$_;++q$a)this._childs[q$a]._update(q$S)},q$a._getSortID=function(q$S,q$_){return 1e3*q$_.id+q$S._getVertexBuffer().vertexDeclaration.id},q$a._update=function(q$S){(q$S.owner=this)._activeInHierarchy&&(this._updateComponents(q$S),this._lateUpdateComponents(q$S),q$N.spriteCount++,this._childs.length&&this._updateChilds(q$S))},q$a.getProjectionViewWorldMatrix=function(q$S){return q$S_.multiply(q$S,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},q$a.loadHierarchy=function(q$S){this.addChild(laya.d3.core.Sprite3D.load(q$S))},q$a.addChildAt=function(q$S,q$_){if(!(q$S instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!q$S||this.destroyed||q$S===this)return q$S;if(q$S.zOrder&&this._set$P("hasZorder",!0),0<=q$_&&q$_<=this._childs.length){if(q$S._parent===this){var q$a=this.getChildIndex(q$S);this._childs.splice(q$a,1),this._childs.splice(q$_,0,q$S),this.conchModel&&(this.conchModel.removeChild(q$S.conchModel),this.conchModel.addChildAt(q$S.conchModel,q$_)),this._childChanged()}else q$S.parent&&q$S.parent.removeChild(q$S),this._childs===q$b.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(q$_,0,q$S),this.conchModel&&this.conchModel.addChildAt(q$S.conchModel,q$_),(q$S.parent=this)._addChild3D(q$S);return q$S}throw new Error("appendChildAt:The index is out of bounds")},q$a.addChild=function(q$S){if(!(q$S instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!q$S||this.destroyed||q$S===this)return q$S;if(q$S.zOrder&&this._set$P("hasZorder",!0),q$S._parent===this){var q$_=this.getChildIndex(q$S);q$_!==this._childs.length-1&&(this._childs.splice(q$_,1),this._childs.push(q$S),this.conchModel&&(this.conchModel.removeChild(q$S.conchModel),this.conchModel.addChildAt(q$S.conchModel,this._childs.length-1)),this._childChanged())}else q$S.parent&&q$S.parent.removeChild(q$S),this._childs===q$b.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(q$S),this.conchModel&&this.conchModel.addChildAt(q$S.conchModel,this._childs.length-1),(q$S.parent=this)._childChanged(),this._addChild3D(q$S);return q$S},q$a.removeChildAt=function(q$S){var q$_=this.getChildAt(q$S);return q$_&&(this._removeChild3D(q$_),this._childs.splice(q$S,1),this.conchModel&&this.conchModel.removeChild(q$_.conchModel),q$_.parent=null),q$_},q$a.removeChildren=function(q$S,q$_){if(void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=2147483647),this._childs&&0<this._childs.length){var q$a=this._childs;if(0===q$S&&q$V<=q$_){var q$R=q$a;this._childs=q$b.ARRAY_EMPTY}else q$R=q$a.splice(q$S,q$_-q$S);for(var q$J=0,q$V=q$R.length;q$J<q$V;q$J++)this._removeChild3D(q$R[q$J]),q$R[q$J].parent=null,this.conchModel&&this.conchModel.removeChild(q$R[q$J].conchModel)}return this},q$a.onAsynLoaded=function(q$S,q$_,q$a){var q$R=q$_[0];if("Sprite3D"!==q$R.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var q$J=q$_[1];q$$_._createNodeByJson(this,q$R,this,q$J),this.event("hierarchyloaded",[this]),this.__loaded=!0},q$a.cloneTo=function(q$S){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var q$_=q$S;q$_.name=this.name,q$_._destroyed=this._destroyed,q$_.timer=this.timer,q$_._$P=this._$P,q$_.active=this._active;var q$a=q$_.transform.localPosition;this.transform.localPosition.cloneTo(q$a),q$_.transform.localPosition=q$a;var q$R=q$_.transform.localRotation;this.transform.localRotation.cloneTo(q$R),q$_.transform.localRotation=q$R;var q$J=q$_.transform.localScale;this.transform.localScale.cloneTo(q$J),q$_.transform.localScale=q$J,q$_.isStatic=this.isStatic;var q$V=0,q$W=0;for(q$V=0,q$W=this._componentsMap.length;q$V<q$W;q$V++){var q$k=q$_.addComponent(this._componentsMap[q$V]);this._components[q$V]._cloneTo(q$k)}for(q$V=0,q$W=this._childs.length;q$V<q$W;q$V++)q$_.addChild(this._childs[q$V].clone());var q$z=q$_.getComponentByType(Animator);if(q$z){var q$b=q$z._linkSpritesData;if(q$b)for(var q$H in q$b){for(var q$L=q$b[q$H],q$C=q$_,q$G=0,q$t=q$L.length;q$G<q$t&&(q$C=q$C.getChildByName(q$L[q$G]));q$G++);if(q$C){var q$o=q$z._avatarNodeMap[q$H];q$C._isLinkSpriteToAnimationNode(q$z,q$o,!0)}}}},q$a.clone=function(){var q$S=new this.constructor;return this.cloneTo(q$S),q$S},q$a.destroy=function(q$S){if(void 0===q$S&&(q$S=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,q$S);var q$_,q$a=0;for(q$a=0,q$_=this._components.length;q$a<q$_;q$a++)this._components[q$a]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,q$F.clearRes(this.url),this.loaded||q$F_._cancelLoadByUrl(this.url)}},q$a._handleSpriteToAvatar=function(q$S,q$_){q$S._avatarNodes;var q$a=q$S._avatarNodeMap[this.name];q$a&&q$a.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(q$S,q$a,q$_)},q$a._setAnimatorToLinkAvatar=function(q$S,q$_){this._handleSpriteToAvatar(q$S,q$_);for(var q$a=0,q$R=this._childs.length;q$a<q$R;q$a++){this._childs[q$a]._setAnimatorToLinkAvatar(q$S,q$_)}},q$t(0,q$a,"activeInHierarchy",function(){return this._activeInHierarchy}),q$t(0,q$a,"_loaded",null,function(q$S){this.__loaded=q$S}),q$t(0,q$a,"active",function(){return this._active},function(q$S){this._active!==q$S&&(this._active=q$S,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(q$S?this._activeHierarchy():this._inActiveHierarchy()))}),q$t(0,q$a,"componentsCount",function(){return this._components.length}),q$t(0,q$a,"loaded",function(){return this.__loaded}),q$t(0,q$a,"id",function(){return this._id}),q$t(0,q$a,"url",function(){return this._url}),q$t(0,q$a,"layer",function(){return this._layer},function(q$S){if(this._layer!==q$S){if(!q$S)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var q$_=0,q$a=this._colliders.length;if(this._layer)for(q$_=0;q$_<q$a;q$_++)this._layer._removeCollider(this._colliders[q$_]);for(q$_=0;q$_<q$a;q$_++)q$S._addCollider(this._colliders[q$_])}this._layer=q$S,this.event("layerchanged",q$S)}}),q$t(0,q$a,"scene",function(){return this._scene}),q$t(0,q$a,"transform",function(){return this._transform}),q$_.instantiate=function(q$S,q$_,q$a,q$R,q$J){void 0===q$a&&(q$a=!0);var q$V=q$S.clone();q$_&&q$_.addChild(q$V);var q$W=q$V.transform;if(q$a){var q$k=q$W.worldMatrix;q$S.transform.worldMatrix.cloneTo(q$k),q$W.worldMatrix=q$k}else q$R&&(q$W.position=q$R),q$J&&(q$W.rotation=q$J);return q$V},q$_.load=function(q$S){return q$Q.loader.create(q$S,null,null,q$_)},q$_.WORLDMATRIX=0,q$_.MVPMATRIX=1,q$_._uniqueIDCounter=0,q$_._nameNumberCounter=0,q$_}(),q$M_=function(q$S){function q$H(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],q$H.__super.call(this),!q$S||!q$_)throw"Shader Error";this._id=++q$H._count,this._vs=q$S,this._ps=q$_,this._attributeMap=q$a,this._sceneUniformMap=q$R,this._cameraUniformMap=q$J,this._spriteUniformMap=q$V,this._materialUniformMap=q$W,this._renderElementUniformMap=q$k,this._precompile=q$z,this._define=q$b,this._precompile&&q$H.extCompileObj&&q$H.extCompileFunc?q$H.extCompileFunc.call(q$H.extCompileObj,q$S,q$_,q$b):this.recreateResource()}q$G(q$H,"laya.d3.shader.Shader3D",q$a);var q$_=q$H.prototype;return q$_.recreateResource=function(){q$h.now();this._compile(),this.completeCreate(),this.memorySize=0},q$_.disposeResource=function(){q$A.mainContext.deleteShader(this._vshader),q$A.mainContext.deleteShader(this._pshader),q$A.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},q$_._compile=function(){if(!q$A.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var q$S=[this._vs,this._ps],q$_=q$A.mainContext;if(this._program=q$_.createProgram(),this._vshader=q$H._createShader(q$_,q$S[0],35633),this._pshader=q$H._createShader(q$_,q$S[1],35632),q$_.attachShader(this._program,this._vshader),q$_.attachShader(this._program,this._pshader),q$_.linkProgram(this._program),!q$o.isConchApp&&q$N_.debugMode&&!q$_.getProgramParameter(this._program,35714))throw q$_.getProgramInfoLog(this._program);var q$a,q$R=0,q$J=0,q$V=0;for(q$V=q$o.isConchApp?q$_.getProgramParameterEx(this._vs,this._ps,"",35721):q$_.getProgramParameter(this._program,35721),q$R=0;q$R<q$V;q$R++){var q$W=null;q$a={vartype:"attribute",ivartype:0,attrib:q$W=q$o.isConchApp?q$_.getActiveAttribEx(this._vs,this._ps,"",q$R):q$_.getActiveAttrib(this._program,q$R),location:q$_.getAttribLocation(this._program,q$W.name),name:q$W.name,type:q$W.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(q$a)}var q$k=0;for(q$k=q$o.isConchApp?q$_.getProgramParameterEx(this._vs,this._ps,"",35718):q$_.getProgramParameter(this._program,35718),q$R=0;q$R<q$k;q$R++){var q$z=null;q$z=q$o.isConchApp?q$_.getActiveUniformEx(this._vs,this._ps,"",q$R):q$_.getActiveUniform(this._program,q$R),0<(q$a={vartype:"uniform",ivartype:1,attrib:q$W,location:q$_.getUniformLocation(this._program,q$z.name),name:q$z.name,type:q$z.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(q$a.name=q$a.name.substr(0,q$a.name.length-3),q$a.isArray=!0,q$a.location=q$_.getUniformLocation(this._program,q$a.name)),this._uniformParams.push(q$a)}for(q$R=0,q$J=this._attributeParams.length;q$R<q$J;q$R++)(q$a=this._attributeParams[q$R]).indexOfParams=q$R,q$a.index=1,q$a.value=[q$a.location,null],q$a.codename=q$a.name,q$a.name=null!=this._attributeMap[q$a.codename]?this._attributeMap[q$a.codename]:q$a.codename,this._attributeParamsMap.push(q$a.name),this._attributeParamsMap.push(q$a),q$a._this=this,q$a.uploadedValue=[],q$a.fun=this._attribute;for(q$R=0,q$J=this._uniformParams.length;q$R<q$J;q$R++)switch((q$a=this._uniformParams[q$R]).indexOfParams=q$R,q$a.index=1,q$a.value=[q$a.location,null],q$a.codename=q$a.name,null!=this._sceneUniformMap[q$a.codename]?(q$a.name=this._sceneUniformMap[q$a.codename],this._sceneUniformParamsMap.push(q$a.name),this._sceneUniformParamsMap.push(q$a)):null!=this._cameraUniformMap[q$a.codename]?(q$a.name=this._cameraUniformMap[q$a.codename],this._cameraUniformParamsMap.push(q$a.name),this._cameraUniformParamsMap.push(q$a)):null!=this._spriteUniformMap[q$a.codename]?(q$a.name=this._spriteUniformMap[q$a.codename],this._spriteUniformParamsMap.push(q$a.name),this._spriteUniformParamsMap.push(q$a)):null!=this._materialUniformMap[q$a.codename]?(q$a.name=this._materialUniformMap[q$a.codename],this._materialUniformParamsMap.push(q$a.name),this._materialUniformParamsMap.push(q$a)):null!=this._renderElementUniformMap[q$a.codename]?(q$a.name=this._renderElementUniformMap[q$a.codename],this._renderElementUniformParamsMap.push(q$a.name),this._renderElementUniformParamsMap.push(q$a)):console.log("Shader:can't find uinform name:"+q$a.codename+" in shader file."),q$a._this=this,q$a.uploadedValue=[],q$a.type){case 5124:q$a.fun=q$a.isArray?this._uniform1iv:this._uniform1i;break;case 5126:q$a.fun=q$a.isArray?this._uniform1fv:this._uniform1f;break;case 35664:q$a.fun=q$a.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:q$a.fun=q$a.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:q$a.fun=q$a.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:q$a.fun=this._uniform_sampler2D;break;case 35680:q$a.fun=this._uniform_samplerCube;break;case 35676:q$a.fun=this._uniformMatrix4fv;break;case 35670:q$a.fun=this._uniform1i;break;case 35674:q$a.fun=this._uinformMatrix2fv;break;case 35675:q$a.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},q$_._attribute=function(q$S,q$_){var q$a=q$A.mainContext,q$R=q$k._enableAtributes,q$J=q$S.location;return q$R[q$J]||q$a.enableVertexAttribArray(q$J),q$a.vertexAttribPointer(q$J,q$_[0],q$_[1],q$_[2],q$_[3],q$_[4]),q$R[q$J]=q$k._bindVertexBuffer,1},q$_._uniform1f=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_?(q$A.mainContext.uniform1f(q$S.location,q$a[0]=q$_),1):0},q$_._uniform1fv=function(q$S,q$_){if(q$_.length<4){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]||q$a[2]!==q$_[2]||q$a[3]!==q$_[3]?(q$A.mainContext.uniform1fv(q$S.location,q$_),q$a[0]=q$_[0],q$a[1]=q$_[1],q$a[2]=q$_[2],q$a[3]=q$_[3],1):0}return q$A.mainContext.uniform1fv(q$S.location,q$_),1},q$_._uniform_vec2=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]?(q$A.mainContext.uniform2f(q$S.location,q$a[0]=q$_[0],q$a[1]=q$_[1]),1):0},q$_._uniform_vec2v=function(q$S,q$_){if(q$_.length<2){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]||q$a[2]!==q$_[2]||q$a[3]!==q$_[3]?(q$A.mainContext.uniform2fv(q$S.location,q$_),q$a[0]=q$_[0],q$a[1]=q$_[1],q$a[2]=q$_[2],q$a[3]=q$_[3],1):0}return q$A.mainContext.uniform2fv(q$S.location,q$_),1},q$_._uniform_vec3=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]||q$a[2]!==q$_[2]?(q$A.mainContext.uniform3f(q$S.location,q$a[0]=q$_[0],q$a[1]=q$_[1],q$a[2]=q$_[2]),1):0},q$_._uniform_vec3v=function(q$S,q$_){return q$A.mainContext.uniform3fv(q$S.location,q$_),1},q$_._uniform_vec4=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]||q$a[2]!==q$_[2]||q$a[3]!==q$_[3]?(q$A.mainContext.uniform4f(q$S.location,q$a[0]=q$_[0],q$a[1]=q$_[1],q$a[2]=q$_[2],q$a[3]=q$_[3]),1):0},q$_._uniform_vec4v=function(q$S,q$_){return q$A.mainContext.uniform4fv(q$S.location,q$_),1},q$_._uniformMatrix2fv=function(q$S,q$_){return q$A.mainContext.uniformMatrix2fv(q$S.location,!1,q$_),1},q$_._uniformMatrix3fv=function(q$S,q$_){return q$A.mainContext.uniformMatrix3fv(q$S.location,!1,q$_),1},q$_._uniformMatrix4fv=function(q$S,q$_){return q$A.mainContext.uniformMatrix4fv(q$S.location,!1,q$_),1},q$_._uinformMatrix2fv=function(q$S,q$_){return q$A.mainContext.uniformMatrix2fv(q$S.location,!1,q$_),1},q$_._uinformMatrix3fv=function(q$S,q$_){return q$A.mainContext.uniformMatrix3fv(q$S.location,!1,q$_),1},q$_._uniform1i=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_?(q$A.mainContext.uniform1i(q$S.location,q$a[0]=q$_),1):0},q$_._uniform1iv=function(q$S,q$_){return q$A.mainContext.uniform1iv(q$S.location,q$_),1},q$_._uniform_ivec2=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]?(q$A.mainContext.uniform2i(q$S.location,q$a[0]=q$_[0],q$a[1]=q$_[1]),1):0},q$_._uniform_ivec2v=function(q$S,q$_){return q$A.mainContext.uniform2iv(q$S.location,q$_),1},q$_._uniform_vec3i=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]||q$a[2]!==q$_[2]?(q$A.mainContext.uniform3i(q$S.location,q$a[0]=q$_[0],q$a[1]=q$_[1],q$a[2]=q$_[2]),1):0},q$_._uniform_vec3vi=function(q$S,q$_){return q$A.mainContext.uniform3iv(q$S.location,q$_),1},q$_._uniform_vec4i=function(q$S,q$_){var q$a=q$S.uploadedValue;return q$a[0]!==q$_[0]||q$a[1]!==q$_[1]||q$a[2]!==q$_[2]||q$a[3]!==q$_[3]?(q$A.mainContext.uniform4i(q$S.location,q$a[0]=q$_[0],q$a[1]=q$_[1],q$a[2]=q$_[2],q$a[3]=q$_[3]),1):0},q$_._uniform_vec4vi=function(q$S,q$_){return q$A.mainContext.uniform4iv(q$S.location,q$_),1},q$_._uniform_sampler2D=function(q$S,q$_){var q$a=q$_.source||q$_.defaulteTexture.source,q$R=q$A.mainContext,q$J=q$S.uploadedValue;if(null!=q$J[0])return q$R.activeTexture(q$H._TEXTURES[q$J[0]]),q$a&&q$X.bindTexture(q$R,3553,q$a),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return q$J[0]=this._curActTexIndex,q$R.uniform1i(q$S.location,this._curActTexIndex),q$R.activeTexture(q$H._TEXTURES[this._curActTexIndex]),q$a&&q$X.bindTexture(q$R,3553,q$a),this._curActTexIndex++,1},q$_._uniform_samplerCube=function(q$S,q$_){var q$a=q$_.source||q$_.defaulteTexture.source,q$R=q$A.mainContext,q$J=q$S.uploadedValue;if(null!=q$J[0])return q$R.activeTexture(q$H._TEXTURES[q$J[0]]),q$a?q$X.bindTexture(q$R,34067,q$a):q$X.bindTexture(q$R,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return q$J[0]=this._curActTexIndex,q$R.uniform1i(q$S.location,this._curActTexIndex),q$R.activeTexture(q$H._TEXTURES[this._curActTexIndex]),q$a?q$X.bindTexture(q$R,34067,q$a):q$X.bindTexture(q$R,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},q$_._noSetValue=function(q$S){console.log("no....:"+q$S.name)},q$_.bind=function(){return q$a.activeShader=this,(q$a.bindShader=this).activeResource(),q$X.UseProgram(this._program)},q$_.uploadAttributes=function(q$S,q$_){for(var q$a,q$R,q$J=0,q$V=0,q$W=this._attributeParamsMap.length;q$V<q$W;q$V+=2)q$R=this._attributeParamsMap[q$V+1],null!=(q$a=q$S[this._attributeParamsMap[q$V]])&&(q$_&&q$_[q$R.name]&&q$_[q$R.name].bind(),q$J+=q$R.fun.call(this,q$R,q$a));q$N.shaderCall+=q$J},q$_.uploadAttributesX=function(q$S,q$_){for(var q$a,q$R,q$J=0,q$V=0,q$W=this._attributeParamsMap.length;q$V<q$W;q$V+=2)q$R=this._attributeParamsMap[q$V+1],null!=(q$a=q$S[this._attributeParamsMap[q$V]])&&(q$_._bind(),q$J+=q$R.fun.call(this,q$R,q$a));q$N.shaderCall+=q$J},q$_.uploadSceneUniforms=function(q$S){for(var q$_,q$a,q$R=0,q$J=0,q$V=this._sceneUniformParamsMap.length;q$J<q$V;q$J+=2)q$a=this._sceneUniformParamsMap[q$J+1],null!=(q$_=q$S[this._sceneUniformParamsMap[q$J]])&&(q$R+=q$a.fun.call(this,q$a,q$_));q$N.shaderCall+=q$R},q$_.uploadCameraUniforms=function(q$S){for(var q$_,q$a,q$R=0,q$J=0,q$V=this._cameraUniformParamsMap.length;q$J<q$V;q$J+=2)q$a=this._cameraUniformParamsMap[q$J+1],null!=(q$_=q$S[this._cameraUniformParamsMap[q$J]])&&(q$R+=q$a.fun.call(this,q$a,q$_));q$N.shaderCall+=q$R},q$_.uploadSpriteUniforms=function(q$S){for(var q$_,q$a,q$R=0,q$J=0,q$V=this._spriteUniformParamsMap.length;q$J<q$V;q$J+=2)q$a=this._spriteUniformParamsMap[q$J+1],null!=(q$_=q$S[this._spriteUniformParamsMap[q$J]])&&(q$R+=q$a.fun.call(this,q$a,q$_));q$N.shaderCall+=q$R},q$_.uploadMaterialUniforms=function(q$S){for(var q$_,q$a,q$R=0,q$J=0,q$V=this._materialUniformParamsMap.length;q$J<q$V;q$J+=2)q$a=this._materialUniformParamsMap[q$J+1],null!=(q$_=q$S[this._materialUniformParamsMap[q$J]])&&(q$R+=q$a.fun.call(this,q$a,q$_));q$N.shaderCall+=q$R},q$_.uploadRenderElementUniforms=function(q$S){for(var q$_,q$a,q$R=0,q$J=0,q$V=this._renderElementUniformParamsMap.length;q$J<q$V;q$J+=2)q$a=this._renderElementUniformParamsMap[q$J+1],null!=(q$_=q$S[this._renderElementUniformParamsMap[q$J]])&&(q$R+=q$a.fun.call(this,q$a,q$_));q$N.shaderCall+=q$R},q$H.create=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){return new q$H(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b)},q$H.addInclude=function(q$S,q$_){q$D.addInclude(q$S,q$_)},q$H._createShader=function(q$S,q$_,q$a){var q$R=q$S.createShader(q$a);if(q$S.shaderSource(q$R,q$_),q$S.compileShader(q$R),q$N_.debugMode&&!q$S.getShaderParameter(q$R,35713))throw q$S.getShaderInfoLog(q$R);return q$R},q$H.PERIOD_RENDERELEMENT=0,q$H.PERIOD_MATERIAL=1,q$H.PERIOD_SPRITE=2,q$H.PERIOD_CAMERA=3,q$H.PERIOD_SCENE=4,q$H._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],q$H._count=0,q$H._preCompile=!1,q$H.extCompileFunc=null,q$H.extCompileObj=null,q$L(q$H,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new q$n}]),q$H}(),q$r_=function(q$k){function q$z(){this._transformUV=null,q$z.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new q$W_(.6,.6,.6)),this._setColor(10,new q$W_(1,1,1)),this._setColor(11,new q$k_(1,1,1,8)),this._setColor(12,new q$W_(1,1,1)),this._setColor(7,new q$k_(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new q$k_(1,1,0,0)),this.renderMode=1}q$G(q$z,"laya.d3.core.material.StandardMaterial",q$k);var q$S=q$z.prototype;return q$S.disableLight=function(){this._addDisablePublicShaderDefine(q$N_.SHADERDEFINE_POINTLIGHT|q$N_.SHADERDEFINE_SPOTLIGHT|q$N_.SHADERDEFINE_DIRECTIONLIGHT)},q$S.disableFog=function(){this._addDisablePublicShaderDefine(q$N_.SHADERDEFINE_FOG)},q$S.onAsynLoaded=function(q$S,q$_,q$a){var q$R=q$_[0];if(q$R.version)q$k.prototype.onAsynLoaded.call(this,q$S,q$_,q$a);else{var q$J=q$_[1],q$V=q$R.props;for(var q$W in q$V)this[q$W]=q$V[q$W];q$z._parseStandardMaterial(q$J,this,q$R),this._endLoaded()}},q$S.cloneTo=function(q$S){q$k.prototype.cloneTo.call(this,q$S);var q$_=q$S;this._transformUV&&(q$_._transformUV=this._transformUV.clone())},q$t(0,q$S,"ambientColor",function(){return this._getColor(9)},function(q$S){this._setColor(9,q$S)}),q$t(0,q$S,"ambientTexture",function(){return this._getTexture(5)},function(q$S){q$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,q$S)}),q$t(0,q$S,"renderMode",null,function(q$S){switch(q$S){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(q$z.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(q$S)}),q$t(0,q$S,"reflectColor",function(){return this._getColor(12)},function(q$S){this._setColor(12,q$S)}),q$t(0,q$S,"tilingOffset",function(){return this._getColor(15)},function(q$S){if(q$S){var q$_=q$S.elements;1!=q$_[0]||1!=q$_[1]||0!=q$_[2]||0!=q$_[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,q$S)}),q$t(0,q$S,"albedo",function(){return this._getColor(7)},function(q$S){this._setColor(7,q$S)}),q$t(0,q$S,"diffuseColor",function(){return this._getColor(10)},function(q$S){this._setColor(10,q$S)}),q$t(0,q$S,"albedoColor",function(){return this._getColor(7)},function(q$S){this._setColor(7,q$S)}),q$t(0,q$S,"specularColor",function(){return this._getColor(11)},function(q$S){this._setColor(11,q$S)}),q$t(0,q$S,"diffuseTexture",function(){return this._getTexture(1)},function(q$S){q$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,q$S)}),q$t(0,q$S,"normalTexture",function(){return this._getTexture(2)},function(q$S){q$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,q$S)}),q$t(0,q$S,"specularTexture",function(){return this._getTexture(3)},function(q$S){q$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,q$S)}),q$t(0,q$S,"emissiveTexture",function(){return this._getTexture(4)},function(q$S){q$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,q$S)}),q$t(0,q$S,"reflectTexture",function(){return this._getTexture(6)},function(q$S){q$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,q$S)}),q$t(0,q$S,"transformUV",function(){return this._transformUV},function(q$S){this._transformUV=q$S,this._setMatrix4x4(13,q$S.matrix),q$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,q$S.matrix.elements,0)}),q$z.__init__=function(){q$z.SHADERDEFINE_DIFFUSEMAP=q$z.shaderDefines.registerDefine("DIFFUSEMAP"),q$z.SHADERDEFINE_NORMALMAP=q$z.shaderDefines.registerDefine("NORMALMAP"),q$z.SHADERDEFINE_SPECULARMAP=q$z.shaderDefines.registerDefine("SPECULARMAP"),q$z.SHADERDEFINE_EMISSIVEMAP=q$z.shaderDefines.registerDefine("EMISSIVEMAP"),q$z.SHADERDEFINE_AMBIENTMAP=q$z.shaderDefines.registerDefine("AMBIENTMAP"),q$z.SHADERDEFINE_REFLECTMAP=q$z.shaderDefines.registerDefine("REFLECTMAP"),q$z.SHADERDEFINE_UVTRANSFORM=q$z.shaderDefines.registerDefine("UVTRANSFORM"),q$z.SHADERDEFINE_TILINGOFFSET=q$z.shaderDefines.registerDefine("TILINGOFFSET"),q$z.SHADERDEFINE_ADDTIVEFOG=q$z.shaderDefines.registerDefine("ADDTIVEFOG")},q$z.load=function(q$S){return q$Q.loader.create(q$S,null,null,q$z)},q$z._parseStandardMaterial=function(q$S,q$_,q$a){var q$R=q$a.customProps,q$J=q$R.ambientColor;q$_.ambientColor=new q$W_(q$J[0],q$J[1],q$J[2]);var q$V=q$R.diffuseColor;q$_.diffuseColor=new q$W_(q$V[0],q$V[1],q$V[2]);var q$W=q$R.specularColor;q$_.specularColor=new q$k_(q$W[0],q$W[1],q$W[2],q$W[3]);var q$k=q$R.reflectColor;q$_.reflectColor=new q$W_(q$k[0],q$k[1],q$k[2]);var q$z=q$R.albedoColor;q$z&&(q$_.albedo=new q$k_(q$z[0],q$z[1],q$z[2],q$z[3]));var q$b=q$R.diffuseTexture.texture2D;q$b&&(q$_.diffuseTexture=q$F.getRes(q$S[q$b]));var q$H=q$R.normalTexture.texture2D;q$H&&(q$_.normalTexture=q$F.getRes(q$S[q$H]));var q$L=q$R.specularTexture.texture2D;q$L&&(q$_.specularTexture=q$F.getRes(q$S[q$L]));var q$C=q$R.emissiveTexture.texture2D;q$C&&(q$_.emissiveTexture=q$F.getRes(q$S[q$C]));var q$G=q$R.ambientTexture.texture2D;q$G&&(q$_.ambientTexture=q$F.getRes(q$S[q$G]));var q$t=q$R.reflectTexture.texture2D;q$t&&(q$_.reflectTexture=q$F.getRes(q$S[q$t]))},q$z.RENDERMODE_OPAQUE=1,q$z.RENDERMODE_OPAQUEDOUBLEFACE=2,q$z.RENDERMODE_CUTOUT=3,q$z.RENDERMODE_CUTOUTDOUBLEFACE=4,q$z.RENDERMODE_TRANSPARENT=13,q$z.RENDERMODE_TRANSPARENTDOUBLEFACE=14,q$z.RENDERMODE_ADDTIVE=15,q$z.RENDERMODE_ADDTIVEDOUBLEFACE=16,q$z.RENDERMODE_DEPTHREAD_TRANSPARENT=5,q$z.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,q$z.RENDERMODE_DEPTHREAD_ADDTIVE=7,q$z.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,q$z.RENDERMODE_NONDEPTH_TRANSPARENT=9,q$z.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,q$z.RENDERMODE_NONDEPTH_ADDTIVE=11,q$z.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,q$z.SHADERDEFINE_DIFFUSEMAP=0,q$z.SHADERDEFINE_NORMALMAP=0,q$z.SHADERDEFINE_SPECULARMAP=0,q$z.SHADERDEFINE_EMISSIVEMAP=0,q$z.SHADERDEFINE_AMBIENTMAP=0,q$z.SHADERDEFINE_REFLECTMAP=0,q$z.SHADERDEFINE_UVTRANSFORM=0,q$z.SHADERDEFINE_TILINGOFFSET=0,q$z.SHADERDEFINE_ADDTIVEFOG=0,q$z.DIFFUSETEXTURE=1,q$z.NORMALTEXTURE=2,q$z.SPECULARTEXTURE=3,q$z.EMISSIVETEXTURE=4,q$z.AMBIENTTEXTURE=5,q$z.REFLECTTEXTURE=6,q$z.ALBEDO=7,q$z.UVANIAGE=8,q$z.MATERIALAMBIENT=9,q$z.MATERIALDIFFUSE=10,q$z.MATERIALSPECULAR=11,q$z.MATERIALREFLECT=12,q$z.UVMATRIX=13,q$z.UVAGE=14,q$z.TILINGOFFSET=15,q$L(q$z,["defaultMaterial",function(){var q$S=new q$z;return q$S.lock=!0,this.defaultMaterial=q$S},"shaderDefines",function(){return this.shaderDefines=new q$H_(q$I_.shaderDefines)}]),q$z}(q$I_),q$e_=function(q$S){function q$W(q$S,q$_,q$a,q$R,q$J){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===q$a&&(q$a=35044),void 0===q$R&&(q$R=!1),q$W.__super.call(this),this._indexType=q$S,this._indexCount=q$_,this._bufferUsage=q$a,this._bufferType=34963,this._canRead=q$R;var q$V;if("ushort"==q$S)this._indexTypeByteCount=2;else{if("ubyte"!=q$S)throw new Error("unidentification index type.");this._indexTypeByteCount=1}q$V=this._indexTypeByteCount*q$_,this._byteLength=q$V,this._bind(),q$k._gl.bufferData(this._bufferType,q$V,this._bufferUsage),this.uri=q$J,q$R?("ushort"==q$S?this._buffer=new Uint16Array(q$_):"ubyte"==q$S&&(this._buffer=new Uint8Array(q$_)),this.memorySize=2*q$V):this.memorySize=q$V}q$G(q$W,"laya.d3.graphics.IndexBuffer3D",q$S);var q$_=q$W.prototype;return q$_.setData=function(q$S,q$_,q$a,q$R){void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=4294967295);var q$J=0;if("ushort"==this._indexType?(q$J=2,0===q$a&&4294967295===q$R||(q$S=new Uint16Array(q$S.buffer,q$a*q$J,q$R))):"ubyte"==this._indexType&&(q$J=1,0===q$a&&4294967295===q$R||(q$S=new Uint8Array(q$S.buffer,q$a*q$J,q$R))),this._bind(),q$k._gl.bufferSubData(this._bufferType,q$_*q$J,q$S),this._canRead)if(0!==q$_||0!==q$a||4294967295!==q$R){var q$V=this._buffer.length-q$_;q$V<q$R&&(q$R=q$V);for(var q$W=0;q$W<q$R;q$W++)this._buffer[q$_+q$W]=q$S[q$W]}else this._buffer=q$S},q$_.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},q$_.disposeResource=function(){q$S.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},q$t(0,q$_,"indexType",function(){return this._indexType}),q$t(0,q$_,"indexTypeByteCount",function(){return this._indexTypeByteCount}),q$t(0,q$_,"indexCount",function(){return this._indexCount}),q$t(0,q$_,"canRead",function(){return this._canRead}),q$W.INDEXTYPE_UBYTE="ubyte",q$W.INDEXTYPE_USHORT="ushort",q$W.create=function(q$S,q$_,q$a,q$R,q$J){return void 0===q$a&&(q$a=35044),void 0===q$R&&(q$R=!1),new q$W(q$S,q$_,q$a,q$R,q$J)},q$W}(q$k),q$g_=function(q$V){function q$W(q$S,q$_,q$a,q$R,q$J){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===q$R&&(q$R=!1),q$W.__super.call(this),this._vertexDeclaration=q$S,this._vertexCount=q$_,this._bufferUsage=q$a,this._bufferType=34962,this._canRead=q$R,this.uri=q$J,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*q$_,this._bind(),q$k._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),q$R&&(this._buffer=new Float32Array(this._byteLength/4))}q$G(q$W,"laya.d3.graphics.VertexBuffer3D",q$V);var q$S=q$W.prototype;return q$S.bindWithIndexBuffer=function(q$S){q$S&&q$S._bind(),this._bind()},q$S.setData=function(q$S,q$_,q$a,q$R){if(void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=4294967295),0===q$a&&4294967295===q$R||(q$S=new Float32Array(q$S.buffer,4*q$a,q$R)),this._bind(),q$k._gl.bufferSubData(this._bufferType,4*q$_,q$S),this._canRead)if(0!==q$_||0!==q$a||4294967295!==q$R){var q$J=this._buffer.length-q$_;q$J<q$R&&(q$R=q$J);for(var q$V=0;q$V<q$R;q$V++)this._buffer[q$_+q$V]=q$S[q$V]}else this._buffer=q$S},q$S.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},q$S.disposeResource=function(){for(var q$S=q$A.mainContext,q$_=this._vertexDeclaration.getVertexElements(),q$a=q$k._enableAtributes,q$R=0,q$J=q$_.length;q$R<q$J;q$R++)q$a[q$R]===this._glBuffer&&(q$S.disableVertexAttribArray(q$R),q$a[q$R]=null);q$V.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},q$t(0,q$S,"vertexDeclaration",function(){return this._vertexDeclaration}),q$t(0,q$S,"vertexCount",function(){return this._vertexCount}),q$t(0,q$S,"canRead",function(){return this._canRead}),q$W.create=function(q$S,q$_,q$a,q$R,q$J){return void 0===q$a&&(q$a=35044),void 0===q$R&&(q$R=!1),new q$W(q$S,q$_,q$a,q$R,q$J)},q$W}(q$k),q$x_=function(q$S){function q$D(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,q$D.__super.call(this),this._type=3553}q$G(q$D,"laya.d3.resource.DataTexture2D",q$A_);var q$_=q$D.prototype;return q$_.genDebugMipmaps=function(){var q$S=[];return q$S.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),q$S.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),q$S.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),q$S.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),q$S.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),q$S.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),q$S.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),q$S.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),q$S.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),q$S.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),q$S},q$_._onTextureLoaded=function(q$S){},q$_._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var q$S=q$A.mainContext,q$_=this._source=q$S.createTexture(),q$a=this._width,q$R=this._height,q$J=q$X.curBindTexTarget,q$V=q$X.curBindTexValue,q$W=!1;if(q$X.bindTexture(q$S,this._type,q$_),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var q$k=0;q$S.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var q$z=0;q$z<this._mipmaps.length;q$z++){if(this._mipmaps[q$z].byteLength!=q$b*q$H*4)throw"mipmap size error  level:"+q$z;q$S.texSubImage2D(this._type,0,q$D.simLodRect[q$k++],q$D.simLodRect[q$k++],q$D.simLodRect[q$k++],q$D.simLodRect[q$k++],6408,5121,new Uint8Array(this._mipmaps[q$z]))}this.minFifter=9729,this.magFifter=9729}else{var q$b=this._width,q$H=this._height;for(q$k=0,q$S.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),q$z=0;q$z<this._mipmaps.length;q$z++){if(this._mipmaps[q$z].byteLength!=q$b*q$H*4)throw"mipmap size error  level:"+q$z;q$S.texImage2D(this._type,q$z,6408,q$b,q$H,0,6408,5121,new Uint8Array(this._mipmaps[q$z])),(q$b/=2)<1&&(q$b=1),(q$H/=2)<1&&(q$H=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&q$S.pixelStorei(q$S.UNPACK_ALIGNMENT,1),q$S.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var q$L=0,q$C=!1,q$G=!1;this._buffer.byteLength==4*q$a*q$R?(q$L=6408,q$C=!0):this._buffer.byteLength==3*q$a*q$R?(q$L=6407,q$G=!0):q$L=this._format,q$C||q$G?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),q$G&&q$S.pixelStorei(q$S.UNPACK_ALIGNMENT,1),q$S.texImage2D(this._type,0,q$L,q$a,q$R,0,q$L,5121,this._buffer)):q$S&&q$L==q$S.ALPHA?(q$S.texImage2D(3553,0,q$L,q$a,q$R,0,q$L,q$S.UNSIGNED_BYTE,this._buffer),q$W=!0):0!=q$L&&(q$S.compressedTexImage2D(3553,0,q$L,q$a,q$R,0,this._buffer),q$W=!0)}var q$t=this._minFifter,q$o=this._magFifter,q$$=0==this._wrapModeU?10497:33071,q$F=0==this._wrapModeV?10497:33071,q$T=q$j.isPOT(q$a,q$R);q$T?(this._mipmap||this._mipmaps?-1!==q$t||(q$t=9987):-1!==q$t||(q$t=9729),-1!==q$o||(q$o=9729),q$S.texParameteri(this._type,10241,q$t),q$S.texParameteri(this._type,10240,q$o),q$S.texParameteri(this._type,10242,q$$),q$S.texParameteri(this._type,10243,q$F),this._mipmap&&q$S.generateMipmap(this._type)):(-1!==q$t||(q$t=9729),-1!==q$o||(q$o=9729),q$S.texParameteri(this._type,10241,q$t),q$S.texParameteri(this._type,10240,q$o),q$S.texParameteri(this._type,10242,33071),q$S.texParameteri(this._type,10243,33071)),q$J&&q$V&&q$X.bindTexture(q$S,q$J,q$V),this.memorySize=q$W?this._buffer.length:q$T?q$a*q$R*4*(1+1/3):q$a*q$R*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},q$_.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},q$_.onAsynLoaded=function(q$S,q$_,q$a){var q$R;q$a&&(q$R=q$a[0].call(this,q$_)),q$R&&(this._width=q$R.width,this._height=q$R.height,this._buffer=q$R.data),this._src=q$S,this._size=new q$o_(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},q$_.getPixels=function(){return new Uint8Array(this._buffer)},q$_.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(q$A.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},q$t(0,q$_,"src",function(){return this._src}),q$D.create=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){if(void 0===q$R&&(q$R=9729),void 0===q$J&&(q$J=9729),void 0===q$V&&(q$V=!0),!q$S||q$S.byteLength<q$_*q$a*4)throw"DataTexture2D create error";var q$k=new q$D;return q$k.uri=q$W,q$k._buffer=q$S,q$k._width=q$_,q$k._height=q$a,q$k._mipmap=q$V,q$k._magFifter=q$R,q$k._minFifter=q$J,q$k._size=new q$o_(q$k._width,q$k._height),q$k._conchTexture?alert("怎么给runtime传递datatexture数据"):q$k.activeResource(),q$k},q$D.load=function(q$S,q$_,q$a,q$R,q$J){if(void 0===q$_&&(q$_=0),void 0===q$a&&(q$a=0),void 0===q$R&&(q$R=9729),void 0===q$J&&(q$J=9729),"mipmaps"===q$l.getFileExtension(q$S)){var q$V=q$Q.loader.create(q$S,null,null,q$D,[function(q$S){this._mipmaps=[];var q$_=new Uint32Array(q$S);this._width=q$_[0];var q$a=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,q$a=1024),this._width!=q$a)throw"现在只支持512x256的环境贴图。当前的是"+q$_[0];this._height=q$_[1];for(var q$R=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,q$J=this._height,q$V=8;;){var q$W=q$R*q$J*4;if(q$V+q$W>q$S.byteLength)throw"load mipmaps data size error ";var q$k=new Uint8Array(q$S,q$V,q$W);if(this._mipmaps.push(q$k),q$V+=q$W,1==q$R&&1==q$J)break;(q$R/=2)<1&&(q$R=1),(q$J/=2)<1&&(q$J=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){q$V.simLodInfo=new Float32Array(40);for(var q$W=0;q$W<q$V.simLodInfo.length;)q$V.simLodInfo[q$W]=(q$D.simLodRect[q$W]+.5)/1024,q$W++,q$V.simLodInfo[q$W]=(q$D.simLodRect[q$W]+.5)/256,q$W++,q$V.simLodInfo[q$W]=Math.max(q$D.simLodRect[q$W]-1,.1)/1024,q$W++,q$V.simLodInfo[q$W]=Math.max(q$D.simLodRect[q$W]-1.5,.1)/256,q$W++}return q$V}if("number"==typeof q$_)return q$Q.loader.create(q$S,null,null,q$D,[function(q$S){return this._width=q$_,this._height=q$a,this._buffer=q$S,null}]);if("function"==typeof q$_)return q$Q.loader.create(q$S,null,null,q$D,[q$_]);throw new Error("unknown params.")},q$D.lodasatlas=!1,q$L(q$D,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),q$D}(),q$s_=function(q$S){function q$_(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,q$_.__super.call(this)}q$G(q$_,"laya.d3.resource.models.PrimitiveMesh",q$X_);var q$a=q$_.prototype;return q$Q.imps(q$a,{"laya.d3.core.render.IRenderable":!0}),q$a._getVertexBuffer=function(q$S){return void 0===q$S&&(q$S=0),0===q$S?this._vertexBuffer:null},q$a._getVertexBuffers=function(){return null},q$a._getIndexBuffer=function(){return this._indexBuffer},q$a._getPositions=function(){var q$S,q$_=[],q$a=this._vertexBuffer.vertexDeclaration.getVertexElements(),q$R=0;for(q$R=0;q$R<q$a.length;q$R++){var q$J=q$a[q$R];if("vector3"===q$J.elementFormat&&0===q$J.elementUsage){q$S=q$J;break}}var q$V=this._vertexBuffer.getData();for(q$R=0;q$R<q$V.length;q$R+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var q$W=q$R+q$S.offset/4,q$k=new q$W_(q$V[q$W+0],q$V[q$W+1],q$V[q$W+2]);q$_.push(q$k)}return q$_},q$a.getRenderElement=function(q$S){return this},q$a.getRenderElementsCount=function(){return 1},q$a.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},q$a._beforeRender=function(q$S){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},q$a._render=function(q$S){q$A.mainContext.drawElements(4,this._numberIndices,5123,0),q$N.drawCall++,q$N.trianglesFaces+=this._numberIndices/3},q$t(0,q$a,"_vertexBufferCount",function(){return 1}),q$t(0,q$a,"triangleCount",function(){return this._indexBuffer.indexCount/3}),q$_}(),q$U_=function(q$S){function q$_(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,q$_.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}q$G(q$_,"laya.d3.resource.models.Mesh",q$X_);var q$a=q$_.prototype;return q$a._getPositions=function(){var q$S,q$_,q$a,q$R,q$J,q$V=[],q$W=0,q$k=0,q$z=0;if(0!==this._vertexBuffers.length){var q$b=this._vertexBuffers.length;for(q$W=0;q$W<q$b;q$W++){for(q$a=(q$S=this._vertexBuffers[q$W]).vertexDeclaration.getVertexElements(),q$k=0;q$k<q$a.length;q$k++)if("vector3"===(q$R=q$a[q$k]).elementFormat&&0===q$R.elementUsage){q$_=q$R;break}for(q$J=q$S.getData(),q$k=0;q$k<q$J.length;q$k+=q$S.vertexDeclaration.vertexStride/4)q$z=q$k+q$_.offset/4,q$V.push(new q$W_(q$J[q$z+0],q$J[q$z+1],q$J[q$z+2]))}}else{var q$H=this._subMeshes.length;for(q$W=0;q$W<q$H;q$W++){for(q$a=(q$S=this._subMeshes[q$W]._getVertexBuffer()).vertexDeclaration.getVertexElements(),q$k=0;q$k<q$a.length;q$k++)if("vector3"===(q$R=q$a[q$k]).elementFormat&&0===q$R.elementUsage){q$_=q$R;break}for(q$J=q$S.getData(),q$k=0;q$k<q$J.length;q$k+=q$S.vertexDeclaration.vertexStride/4)q$z=q$k+q$_.offset/4,q$V.push(new q$W_(q$J[q$z+0],q$J[q$z+1],q$J[q$z+2]))}}return q$V},q$a._setSubMeshes=function(q$S){this._subMeshes=q$S,this._subMeshCount=q$S.length;for(var q$_=0;q$_<this._subMeshCount;q$_++)q$S[q$_]._indexInMesh=q$_;this._positions=this._getPositions(),this._generateBoundingObject()},q$a.onAsynLoaded=function(q$S,q$_,q$a){var q$R=q$_[0],q$J=q$_[1];q$yS.read(q$R,this,this._materials,this._subMeshes,q$J),this.completeCreate(),this._endLoaded()},q$a.getSubMesh=function(q$S){return this._subMeshes[q$S]},q$a.getSubMeshCount=function(){return this._subMeshes.length},q$a.getRenderElementsCount=function(){return this._subMeshes.length},q$a.getRenderElement=function(q$S){return this._subMeshes[q$S]},q$a.disposeResource=function(){for(var q$S=0;q$S<this._subMeshes.length;q$S++)this._subMeshes[q$S].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},q$t(0,q$a,"materials",function(){return this._materials.slice()}),q$t(0,q$a,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),q$_.load=function(q$S){return q$Q.loader.create(q$S,null,null,q$_)},q$_}(),q$f_=(function(q$S){function q$b(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===q$a&&(q$a=6408),void 0===q$R&&(q$R=5121),void 0===q$J&&(q$J=33189),void 0===q$V&&(q$V=!1),void 0===q$W&&(q$W=!1),void 0===q$k&&(q$k=-1),void 0===q$z&&(q$z=-1),q$b.__super.call(this),this._type=3553,this._width=q$S,this._height=q$_,this._size=new q$o_(q$S,q$_),this._surfaceFormat=q$a,this._surfaceType=q$R,this._depthStencilFormat=q$J,q$o.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=q$V,this._repeat=q$W,this._minFifter=q$k,this._magFifter=q$z,this.activeResource(),this._alreadyResolved=!0}q$G(q$b,"laya.d3.resource.RenderTexture",q$A_);var q$_=q$b.prototype;q$_.recreateResource=function(){var q$S=q$A.mainContext;this._frameBuffer=q$S.createFramebuffer(),this._source=q$S.createTexture();var q$_=q$X.curBindTexTarget,q$a=q$X.curBindTexValue;q$X.bindTexture(q$S,this._type,this._source),q$S.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var q$R=this._minFifter,q$J=this._magFifter,q$V=this._repeat?10497:33071;if(q$j.isPOT(this._width,this._height)?(this._mipmap?-1!==q$R||(q$R=9987):-1!==q$R||(q$R=9729),-1!==q$J||(q$J=9729),q$S.texParameteri(this._type,10241,q$R),q$S.texParameteri(this._type,10240,q$J),q$S.texParameteri(this._type,10242,q$V),q$S.texParameteri(this._type,10243,q$V),this._mipmap&&q$S.generateMipmap(this._type)):(-1!==q$R||(q$R=9729),-1!==q$J||(q$J=9729),q$S.texParameteri(this._type,10241,q$R),q$S.texParameteri(this._type,10240,q$J),q$S.texParameteri(this._type,10242,33071),q$S.texParameteri(this._type,10243,33071)),q$_&&q$a&&q$X.bindTexture(q$S,q$_,q$a),q$S.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=q$S.createRenderbuffer(),q$S.bindRenderbuffer(36161,this._depthStencilBuffer),q$S.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),q$S.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:q$S.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:q$S.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:q$S.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}q$S.framebufferTexture2D(36160,36064,3553,this._source,0),q$S.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},q$_.start=function(){q$A.mainContext.bindFramebuffer(36160,this.frameBuffer),(q$b._currentRenderTarget=this)._alreadyResolved=!1},q$_.end=function(){q$A.mainContext.bindFramebuffer(36160,null),q$b._currentRenderTarget=null,this._alreadyResolved=!0},q$_.getData=function(q$S,q$_,q$a,q$R){var q$J=q$A.mainContext;if(q$J.bindFramebuffer(36160,this._frameBuffer),!(36053===q$J.checkFramebufferStatus(36160)))return q$J.bindFramebuffer(36160,null),null;var q$V=new Uint8Array(this._width*this._height*4);return q$J.readPixels(q$S,q$_,q$a,q$R,this._surfaceFormat,this._surfaceType,q$V),q$J.bindFramebuffer(36160,null),q$V},q$_.disposeResource=function(){if(this._frameBuffer){var q$S=q$A.mainContext;q$S.deleteTexture(this._source),q$S.deleteFramebuffer(this._frameBuffer),q$S.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},q$t(0,q$_,"surfaceFormat",function(){return this._surfaceFormat}),q$t(0,q$_,"surfaceType",function(){return this._surfaceType}),q$t(0,q$_,"depthStencilFormat",function(){return this._depthStencilFormat}),q$t(0,q$_,"source",function(){return this._alreadyResolved?q$Q.superGet(q$A_,this,"source"):null}),q$t(0,q$_,"depthStencilBuffer",function(){return this._depthStencilBuffer}),q$t(0,q$_,"frameBuffer",function(){return this._frameBuffer}),q$b._currentRenderTarget=null}(),function(q$S){function q$_(q$S){this._color=null,this._pixels=null,q$_.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new q$o_(this.width,this.height),this._color=q$S,this._pixels=new Uint8Array([255*q$S.x,255*q$S.y,255*q$S.z,255*q$S.w]),this.uri="SolidColorTexture2D_"+this.id}q$G(q$_,"laya.d3.resource.SolidColorTexture2D",q$A_);var q$a=q$_.prototype;return q$a._createWebGlTexture=function(){var q$S=q$A.mainContext,q$_=this._source=q$S.createTexture(),q$a=this._width,q$R=this._height,q$J=q$X.curBindTexTarget,q$V=q$X.curBindTexValue;q$X.bindTexture(q$S,this._type,q$_),q$S.texImage2D(this._type,0,6408,q$a,q$R,0,6408,5121,this._pixels);var q$W=this._minFifter,q$k=this._magFifter,q$z=this._repeat?10497:33071,q$b=q$j.isPOT(q$a,q$R);q$b?(this._mipmap?-1!==q$W||(q$W=9987):-1!==q$W||(q$W=9729),-1!==q$k||(q$k=9729),q$S.texParameteri(this._type,10241,q$W),q$S.texParameteri(this._type,10240,q$k),q$S.texParameteri(this._type,10242,q$z),q$S.texParameteri(this._type,10243,q$z),this._mipmap&&q$S.generateMipmap(this._type)):(-1!==q$W||(q$W=9729),-1!==q$k||(q$k=9729),q$S.texParameteri(this._type,10241,q$W),q$S.texParameteri(this._type,10240,q$k),q$S.texParameteri(this._type,10242,33071),q$S.texParameteri(this._type,10243,33071)),q$J&&q$V&&q$X.bindTexture(q$S,q$J,q$V),this.memorySize=q$b?q$a*q$R*4*(1+1/3):q$a*q$R*4},q$a.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},q$a.disposeResource=function(){this._source&&(q$A.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},q$L(q$_,["magentaTexture",function(){var q$S=new q$_(new q$k_(1,0,1,1));return q$S.lock=!0,this.magentaTexture=q$S},"grayTexture",function(){var q$S=new q$_(new q$k_(.5,.5,.5,1));return q$S.lock=!0,this.grayTexture=q$S}]),q$_}()),q$Y_=function(q$S){function q$J(q$S,q$_,q$a,q$R){this._canRead=!1,this._image=null,this._pixels=null,void 0===q$S&&(q$S=!1),void 0===q$_&&(q$_=!0),void 0===q$a&&(q$a=6408),void 0===q$R&&(q$R=!0),q$J.__super.call(this),this._type=3553,this._repeat=q$_,this._canRead=q$S,this._format=q$a,this._mipmap=q$R}q$G(q$J,"laya.d3.resource.Texture2D",q$A_);var q$_=q$J.prototype;return q$_._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var q$S=q$A.mainContext,q$_=this._source=q$S.createTexture(),q$a=this._width,q$R=this._height,q$J=q$X.curBindTexTarget,q$V=q$X.curBindTexValue;switch(q$X.bindTexture(q$S,this._type,q$_),this._format){case 6407:case 6408:this._canRead?q$S.texImage2D(this._type,0,this._format,q$a,q$R,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?q$S.texImage2D(this._type,0,this._image._format,q$a,q$R,0,this._image._format,5121,this._image.atlasSource):q$S.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case q$A.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:q$S.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var q$W=this._minFifter,q$k=this._magFifter,q$z=this._repeat?10497:33071,q$b=0==this._wrapModeU?10497:33071,q$H=0==this._wrapModeV?10497:33071,q$L=q$j.isPOT(q$a,q$R);q$L?(this._mipmap?-1!==q$W||(q$W=9987):-1!==q$W||(q$W=9729),-1!==q$k||(q$k=9729),q$S.texParameteri(this._type,10241,q$W),q$S.texParameteri(this._type,10240,q$k),q$S.texParameteri(this._type,10242,q$z),q$S.texParameteri(this._type,10243,q$z),q$S.texParameteri(this._type,10242,q$b),q$S.texParameteri(this._type,10243,q$H),this._mipmap&&q$S.generateMipmap(this._type)):(-1!==q$W||(q$W=9729),-1!==q$k||(q$k=9729),q$S.texParameteri(this._type,10241,q$W),q$S.texParameteri(this._type,10240,q$k),q$S.texParameteri(this._type,10242,33071),q$S.texParameteri(this._type,10243,33071)),q$J&&q$V&&q$X.bindTexture(q$S,q$J,q$V),this._image.onload=null,this._image=null,this.memorySize=q$L?q$a*q$R*4*(1+1/3):q$a*q$R*4},q$_.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},q$_.onAsynLoaded=function(q$S,q$_,q$a){if(q$a){var q$R=q$a[0];void 0!==q$R&&(this._canRead=q$R);var q$J=q$a[1];void 0!==q$J&&(this._repeat=q$J);var q$V=q$a[2];void 0!==q$V&&(this._format=q$V);var q$W=q$a[3];void 0!==q$W&&(this._mipmap=q$W);var q$k=q$a.wrapModeU;void 0!==q$k&&(this._wrapModeU=q$k);var q$z=q$a.wrapModeV;void 0!==q$z&&(this._wrapModeV=q$z)}switch(this._format){case 6407:case 6408:var q$b=(this._image=q$_).width,q$H=q$_.height;this._width=q$b,this._height=q$H,this._size=new q$o_(q$b,q$H),this._canRead&&(q$o.isConchApp?q$_ instanceof q$C.HTMLElement&&(this._pixels=new Uint8Array(q$_.getImageData(0,0,q$b,q$H))):(q$h.canvas.size(q$b,q$H),q$h.canvas.clear(),q$h.context.drawImage(q$_,0,0,q$b,q$H),this._pixels=new Uint8Array(q$h.context.getImageData(0,0,q$b,q$H).data.buffer)));break;case q$A.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var q$L=new q$m(q$_);q$L.readUTFBytes(4),q$L.readUTFBytes(2),q$L.getInt16();q$L.endian="bigEndian",this._width=q$L.getInt16(),this._height=q$L.getInt16(),this._size=new q$o_(this._width,this._height);q$L.getInt16(),q$L.getInt16();this._image=new Uint8Array(q$_,q$L.pos)}this.recreateResource(),this._endLoaded()},q$_.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},q$_.disposeResource=function(){this._source&&(q$A.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},q$t(0,q$_,"_src",function(){return this.url}),q$t(0,q$_,"src",function(){return this.url}),q$J.load=function(q$S){return q$Q.loader.create(q$S,null,null,q$J)},q$J}(),q$i_=function(q$_){function q$a(q$S,q$_){q$a.__super.call(this),void 0===q$S&&(q$S=.3),void 0===q$_&&(q$_=1e3),this._tempVector3=new q$W_,this._position=new q$W_,this._up=new q$W_,this._forward=new q$W_,this._right=new q$W_,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=q$o_.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=q$S,this._farPlane=q$_,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),q$Q.stage.on("resize",this,this._onScreenSizeChanged)}q$G(q$a,"laya.d3.core.BaseCamera",q$_);var q$S=q$a.prototype;return q$S._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var q$S=this.scene._cameraPool,q$_=q$S.length-1,q$a=0;q$a<q$_;q$a++)if(q$S[q$a].renderingOrder>q$S[q$_].renderingOrder){var q$R=q$S[q$a];q$S[q$a]=q$S[q$_],q$S[q$_]=q$R}},q$S._calculateProjectionMatrix=function(){},q$S._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},q$S._prepareCameraToRender=function(){q$u._currentCameraCullingMask=this.cullingMask;var q$S=this._shaderValues;q$S.setValue(0,this.transform.position.elements),q$S.setValue(5,this.forward.elements),q$S.setValue(6,this.up.elements)},q$S._prepareCameraViewProject=function(q$S,q$_){var q$a=this._shaderValues;q$a.setValue(1,q$S.elements),q$a.setValue(2,q$_.elements)},q$S._renderCamera=function(q$S,q$_,q$a){},q$S.addLayer=function(q$S){29!==q$S.number&&30!=q$S.number&&(this.cullingMask=this.cullingMask|q$S.mask)},q$S.removeLayer=function(q$S){29!==q$S.number&&30!=q$S.number&&(this.cullingMask=this.cullingMask&~q$S.mask)},q$S.addAllLayers=function(){this.cullingMask=2147483647},q$S.removeAllLayers=function(){this.cullingMask=0|q$u.getLayerByNumber(29).mask|q$u.getLayerByNumber(30).mask},q$S.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},q$S.moveForward=function(q$S){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=q$S,this.transform.translate(this._tempVector3)},q$S.moveRight=function(q$S){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=q$S,this.transform.translate(this._tempVector3)},q$S.moveVertical=function(q$S){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=q$S,this.transform.translate(this._tempVector3,!1)},q$S._addSelfRenderObjects=function(){var q$S=this.scene._cameraPool,q$_=q$S.length;if(0<q$_){for(var q$a=q$_-1;0<=q$a;q$a--)if(this.renderingOrder<=q$S[q$a].renderingOrder){q$S.splice(q$a+1,0,this);break}}else q$S.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},q$S._clearSelfRenderObjects=function(){var q$S=this.scene._cameraPool;q$S.splice(q$S.indexOf(this),1)},q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,q$Q.stage.off("resize",this,this._onScreenSizeChanged),q$_.prototype.destroy.call(this,q$S)},q$t(0,q$S,"sky",function(){return this._sky},function(q$S){(this._sky=q$S)._ownerCamera=this}),q$t(0,q$S,"forward",function(){var q$S=this.transform.worldMatrix.elements,q$_=this._forward.elements;return q$_[0]=-q$S[8],q$_[1]=-q$S[9],q$_[2]=-q$S[10],this._forward}),q$t(0,q$S,"position",function(){var q$S=this.transform.worldMatrix.elements,q$_=this._position.elements;return q$_[0]=q$S[12],q$_[1]=q$S[13],q$_[2]=q$S[14],this._position}),q$t(0,q$S,"renderTarget",function(){return this._renderTarget},function(q$S){null!=(this._renderTarget=q$S)&&(this._renderTargetSize=q$S.size)}),q$t(0,q$S,"up",function(){var q$S=this.transform.worldMatrix.elements,q$_=this._up.elements;return q$_[0]=q$S[4],q$_[1]=q$S[5],q$_[2]=q$S[6],this._up}),q$t(0,q$S,"right",function(){var q$S=this.transform.worldMatrix.elements,q$_=this._right.elements;return q$_[0]=q$S[0],q$_[1]=q$S[1],q$_[2]=q$S[2],this._right}),q$t(0,q$S,"renderTargetSize",function(){return this._renderTargetSize},function(q$S){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=q$S,this._calculateProjectionMatrix()}),q$t(0,q$S,"fieldOfView",function(){return this._fieldOfView},function(q$S){this._fieldOfView=q$S,this._calculateProjectionMatrix()}),q$t(0,q$S,"nearPlane",function(){return this._nearPlane},function(q$S){this._nearPlane=q$S,this._calculateProjectionMatrix()}),q$t(0,q$S,"farPlane",function(){return this._farPlane},function(q$S){this._farPlane=q$S,this._calculateProjectionMatrix()}),q$t(0,q$S,"orthographic",function(){return this._orthographic},function(q$S){this._orthographic=q$S,this._calculateProjectionMatrix()}),q$t(0,q$S,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(q$S){this._orthographicVerticalSize=q$S,this._calculateProjectionMatrix()}),q$t(0,q$S,"renderingOrder",function(){return this._renderingOrder},function(q$S){this._renderingOrder=q$S,this._sortCamerasByRenderingOrder()}),q$a.CAMERAPOS=0,q$a.VIEWMATRIX=1,q$a.PROJECTMATRIX=2,q$a.VPMATRIX=3,q$a.VPMATRIX_NO_TRANSLATE=4,q$a.CAMERADIRECTION=5,q$a.CAMERAUP=6,q$a.ENVIRONMENTDIFFUSE=7,q$a.ENVIRONMENTSPECULAR=8,q$a.SIMLODINFO=9,q$a.DIFFUSEIRRADMATR=10,q$a.DIFFUSEIRRADMATG=11,q$a.DIFFUSEIRRADMATB=12,q$a.HDREXPOSURE=13,q$a.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",q$a.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",q$a.CLEARFLAG_SOLIDCOLOR=0,q$a.CLEARFLAG_SKY=1,q$a.CLEARFLAG_DEPTHONLY=2,q$a.CLEARFLAG_NONE=3,q$L(q$a,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new q$S_(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new q$S_},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new q$S_}]),q$a}(q$P_),q$Z_=function(q$a){function q$_(q$S){this._render=null,this._geometryFilter=null,q$_.__super.call(this,q$S)}q$G(q$_,"laya.d3.core.RenderableSprite3D",q$a);var q$S=q$_.prototype;return q$S._addToInitStaticBatchManager=function(){},q$S._setBelongScene=function(q$S){q$a.prototype._setBelongScene.call(this,q$S),q$S._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},q$S._setUnBelongScene=function(){var q$S=this._scene._renderableSprite3Ds,q$_=q$S.indexOf(this);q$S.splice(q$_,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),q$a.prototype._setUnBelongScene.call(this)},q$S._update=function(q$S){(q$S.owner=this)._activeInHierarchy&&(this._updateComponents(q$S),this._render._updateOctreeNode(),this._lateUpdateComponents(q$S),q$N.spriteCount++,this._childs.length&&this._updateChilds(q$S))},q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),q$a.prototype.destroy.call(this,q$S),this._render._destroy(),this._render=null},q$_.__init__=function(){q$_.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=q$_.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),q$_.SAHDERDEFINE_LIGHTMAP=q$_.shaderDefines.registerDefine("LIGHTMAP")},q$_.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,q$_.SAHDERDEFINE_LIGHTMAP=4,q$_.LIGHTMAPSCALEOFFSET=2,q$_.LIGHTMAP=3,q$L(q$_,["shaderDefines",function(){return this.shaderDefines=new q$H_}]),q$_}(q$P_),q$p_=(function(q$S){function q$R(q$S,q$_,q$a){this._long=NaN,this._width=NaN,this._height=NaN,void 0===q$S&&(q$S=1),void 0===q$_&&(q$_=1),void 0===q$a&&(q$a=1),q$R.__super.call(this),this._long=q$S,this._width=q$_,this._height=q$a,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}q$G(q$R,"laya.d3.resource.models.BoxMesh",q$s_);var q$_=q$R.prototype;q$_.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var q$S=q$AS.vertexDeclaration,q$_=(q$S.vertexStride,this._long/2),q$a=this._height/2,q$R=this._width/2,q$J=new Float32Array([-q$_,q$a,-q$R,0,1,0,0,0,q$_,q$a,-q$R,0,1,0,1,0,q$_,q$a,q$R,0,1,0,1,1,-q$_,q$a,q$R,0,1,0,0,1,-q$_,-q$a,-q$R,0,-1,0,0,1,q$_,-q$a,-q$R,0,-1,0,1,1,q$_,-q$a,q$R,0,-1,0,1,0,-q$_,-q$a,q$R,0,-1,0,0,0,-q$_,q$a,-q$R,-1,0,0,0,0,-q$_,q$a,q$R,-1,0,0,1,0,-q$_,-q$a,q$R,-1,0,0,1,1,-q$_,-q$a,-q$R,-1,0,0,0,1,q$_,q$a,-q$R,1,0,0,1,0,q$_,q$a,q$R,1,0,0,0,0,q$_,-q$a,q$R,1,0,0,0,1,q$_,-q$a,-q$R,1,0,0,1,1,-q$_,q$a,q$R,0,0,1,0,0,q$_,q$a,q$R,0,0,1,1,0,q$_,-q$a,q$R,0,0,1,1,1,-q$_,-q$a,q$R,0,0,1,0,1,-q$_,q$a,-q$R,0,0,-1,1,0,q$_,q$a,-q$R,0,0,-1,0,0,q$_,-q$a,-q$R,0,0,-1,0,1,-q$_,-q$a,-q$R,0,0,-1,1,1]),q$V=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new q$g_(q$S,this._numberVertices,35044,!0),this._indexBuffer=new q$e_("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(q$J),this._indexBuffer.setData(q$V),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},q$t(0,q$_,"long",function(){return this._long},function(q$S){this._long!==q$S&&(this._long=q$S,this.releaseResource(),this.activeResource())}),q$t(0,q$_,"width",function(){return this._width},function(q$S){this._width!==q$S&&(this._width=q$S,this.releaseResource(),this.activeResource())}),q$t(0,q$_,"height",function(){return this._height},function(q$S){this._height!==q$S&&(this._height=q$S,this.releaseResource(),this.activeResource())})}(),function(q$S){function q$J(q$S,q$_,q$a,q$R){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===q$S&&(q$S=10),void 0===q$_&&(q$_=10),void 0===q$a&&(q$a=10),void 0===q$R&&(q$R=10),q$J.__super.call(this),this._long=q$S,this._width=q$_,this._stacks=q$a,this._slices=q$R,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}q$G(q$J,"laya.d3.resource.models.PlaneMesh",q$s_);var q$_=q$J.prototype;q$_.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var q$S=new Uint16Array(this._numberIndices),q$_=q$AS.vertexDeclaration,q$a=q$_.vertexStride/4,q$R=new Float32Array(this._numberVertices*q$a),q$J=this._long/2,q$V=this._width/2,q$W=this._long/this._stacks,q$k=this._width/this._slices,q$z=0,q$b=0;q$b<=this._slices;q$b++)for(var q$H=0;q$H<=this._stacks;q$H++)q$R[q$z++]=q$H*q$W-q$J,q$R[q$z++]=0,q$R[q$z++]=q$b*q$k-q$V,q$R[q$z++]=0,q$R[q$z++]=1,q$R[q$z++]=0,q$R[q$z++]=1*q$H/this._stacks,q$R[q$z++]=1*q$b/this._slices;var q$L=0;for(q$b=0;q$b<this._slices;q$b++)for(q$H=0;q$H<this._stacks;q$H++)q$S[q$L++]=(q$b+1)*(this._stacks+1)+q$H,q$S[q$L++]=q$b*(this._stacks+1)+q$H,q$S[q$L++]=(q$b+1)*(this._stacks+1)+q$H+1,q$S[q$L++]=q$b*(this._stacks+1)+q$H,q$S[q$L++]=q$b*(this._stacks+1)+q$H+1,q$S[q$L++]=(q$b+1)*(this._stacks+1)+q$H+1;this._vertexBuffer=new q$g_(q$_,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new q$e_("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData(q$R),this._indexBuffer.setData(q$S),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},q$t(0,q$_,"long",function(){return this._long},function(q$S){this._long!==q$S&&(this._long=q$S,this.releaseResource(),this.activeResource())}),q$t(0,q$_,"width",function(){return this._width},function(q$S){this._width!==q$S&&(this._width=q$S,this.releaseResource(),this.activeResource())}),q$t(0,q$_,"stacks",function(){return this._stacks},function(q$S){this._stacks!==q$S&&(this._stacks=q$S,this.releaseResource(),this.activeResource())}),q$t(0,q$_,"slices",function(){return this._slices},function(q$S){this._slices!==q$S&&(this._slices=q$S,this.releaseResource(),this.activeResource())})}(),function(q$S){function q$W(q$S,q$_,q$a){void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=.3),void 0===q$a&&(q$a=1e3),this._viewMatrix=new q$S_,this._projectionMatrix=new q$S_,this._projectionViewMatrix=new q$S_,this._viewport=new q$z_(0,0,0,0),this._normalizedViewport=new q$z_(0,0,1,1),this._aspectRatio=q$S,this._boundFrustumUpdate=!0,this._boundFrustum=new q$OS(q$S_.DEFAULT),q$W.__super.call(this,q$_,q$a),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}q$G(q$W,"laya.d3.core.Camera",q$i_);var q$_=q$W.prototype;return q$_._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},q$_._parseCustomProps=function(q$S,q$_,q$a,q$R){var q$J=q$a.clearColor;this.clearColor=new q$k_(q$J[0],q$J[1],q$J[2],q$J[3]);var q$V=q$a.viewport;this.normalizedViewport=new q$z_(q$V[0],q$V[1],q$V[2],q$V[3])},q$_._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var q$S=this.orthographicVerticalSize*this.aspectRatio*.5,q$_=.5*this.orthographicVerticalSize;q$S_.createOrthoOffCenterRH(-q$S,q$S,-q$_,q$_,this.nearPlane,this.farPlane,this._projectionMatrix)}else q$S_.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},q$_._update=function(q$S){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,q$S)},q$_._renderCamera=function(q$S,q$_,q$a){var q$R,q$J;q$a.parallelSplitShadowMaps[0]&&q$a._renderShadowMap(q$S,q$_,this),(q$_.camera=this)._prepareCameraToRender(),q$a._preRenderUpdateComponents(q$_),q$R=q$_._viewMatrix=this.viewMatrix;var q$V=this._renderTarget;q$V?(q$V.start(),q$S_.multiply(q$i_._invertYScaleMatrix,this._projectionMatrix,q$i_._invertYProjectionMatrix),q$S_.multiply(q$i_._invertYScaleMatrix,this.projectionViewMatrix,q$i_._invertYProjectionViewMatrix),q$J=q$_._projectionMatrix=q$i_._invertYProjectionMatrix,q$_._projectionViewMatrix=q$i_._invertYProjectionViewMatrix):(q$J=q$_._projectionMatrix=this._projectionMatrix,q$_._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(q$R,q$J),q$_._viewport=this.viewport,q$a._preRenderScene(q$S,q$_,this.boundFrustum),q$a._clear(q$S,q$_),q$a._renderScene(q$S,q$_),q$a._postRenderUpdateComponents(q$_),q$V&&q$V.end()},q$_.viewportPointToRay=function(q$S,q$_){q$t_.calculateCursorRay(q$S,this.viewport,this._projectionMatrix,this.viewMatrix,null,q$_)},q$_.normalizedViewportPointToRay=function(q$S,q$_){var q$a=q$W._tempVector20,q$R=this.viewport,q$J=q$S.elements,q$V=q$a.elements;q$V[0]=q$J[0]*q$R.width,q$V[1]=q$J[1]*q$R.height,q$t_.calculateCursorRay(q$a,this.viewport,this._projectionMatrix,this.viewMatrix,null,q$_)},q$_.worldToViewportPoint=function(q$S,q$_){q$S_.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(q$S,this._projectionViewMatrix,q$_);var q$a=q$_.elements;q$a[0]=q$a[0]/q$Q.stage.clientScaleX,q$a[1]=q$a[1]/q$Q.stage.clientScaleY},q$_.worldToNormalizedViewportPoint=function(q$S,q$_){q$S_.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(q$S,this._projectionViewMatrix,q$_);var q$a=q$_.elements;q$a[0]=q$a[0]/q$Q.stage.clientScaleX,q$a[1]=q$a[1]/q$Q.stage.clientScaleY},q$_.convertScreenCoordToOrthographicCoord=function(q$S,q$_){if(this._orthographic){var q$a=q$y.clientWidth,q$R=q$y.clientHeight,q$J=this.orthographicVerticalSize*this.aspectRatio/q$a,q$V=this.orthographicVerticalSize/q$R,q$W=q$S.elements,q$k=q$_.elements;return q$k[0]=(-q$a/2+q$W[0])*q$J,q$k[1]=(q$R/2-q$W[1])*q$V,q$k[2]=(this.nearPlane-this.farPlane)*(q$W[2]+1)/2-this.nearPlane,q$W_.transformCoordinate(q$_,this.transform.worldMatrix,q$_),!0}return!1},q$t(0,q$_,"projectionViewMatrix",function(){return q$S_.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),q$t(0,q$_,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var q$S=this.viewport;return q$S.width/q$S.height},function(q$S){if(q$S<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=q$S,this._calculateProjectionMatrix()}),q$t(0,q$_,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),q$t(0,q$_,"needViewport",function(){var q$S=this.normalizedViewport;return 0===q$S.x&&0===q$S.y&&1===q$S.width&&1===q$S.height}),q$t(0,q$_,"viewport",function(){if(this._viewportExpressedInClipSpace){var q$S=this._normalizedViewport,q$_=this.renderTargetSize,q$a=q$_.width,q$R=q$_.height;this._viewport.x=q$S.x*q$a,this._viewport.y=q$S.y*q$R,this._viewport.width=q$S.width*q$a,this._viewport.height=q$S.height*q$R}return this._viewport},function(q$S){if(null!=this.renderTarget&&(q$S.x<0||q$S.y<0||0==q$S.width||0==q$S.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=q$S,this._calculateProjectionMatrix()}),q$t(0,q$_,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var q$S=this._viewport,q$_=this.renderTargetSize,q$a=q$_.width,q$R=q$_.height;this._normalizedViewport.x=q$S.x/q$a,this._normalizedViewport.y=q$S.y/q$R,this._normalizedViewport.width=q$S.width/q$a,this._normalizedViewport.height=q$S.height/q$R}return this._normalizedViewport},function(q$S){q$S.x<0&&(q$S.x=0,console.warn("Camera: viewport.x must large than 0.0.")),q$S.y<0&&(q$S.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<q$S.x+q$S.width&&(q$S.width=1-q$S.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<q$S.y+q$S.height&&(q$S.height=1-q$S.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=q$S,this._calculateProjectionMatrix()}),q$t(0,q$_,"projectionMatrix",function(){return this._projectionMatrix},function(q$S){this._projectionMatrix=q$S,this._useUserProjectionMatrix=!0}),q$t(0,q$_,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),q$L(q$W,["_tempVector20",function(){return this._tempVector20=new q$V_}]),q$W}()),q$c_=function(q$a){function q$R(q$S,q$_){q$R.__super.call(this,q$_),this._geometryFilter=new q$h_(this),this._render=new q$u_(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),q$S&&(this._geometryFilter.sharedMesh=q$S)instanceof laya.d3.resource.models.Mesh&&(q$S.loaded?this._render.sharedMaterials=q$S.materials:q$S.once("loaded",this,this._applyMeshMaterials))}q$G(q$R,"laya.d3.core.MeshSprite3D",q$a);var q$S=q$R.prototype;return q$S._changeRenderObjectByMesh=function(q$S){var q$_=this._render._renderElements,q$a=q$_[q$S];q$a||(q$a=q$_[q$S]=new q$q_),q$a._render=this._render;var q$R=this._render.sharedMaterials[q$S];q$R||(q$R=q$r_.defaultMaterial);var q$J=this._geometryFilter.sharedMesh.getRenderElement(q$S);return q$a._mainSortID=this._getSortID(q$J,q$R),q$a._sprite3D=this,q$a.renderObj=q$J,q$a._material=q$R,q$a},q$S._changeRenderObjectByMaterial=function(q$S,q$_){var q$a=this._render._renderElements[q$S];q$_||(q$_=q$r_.defaultMaterial);var q$R=this._geometryFilter.sharedMesh.getRenderElement(q$S);return q$a._mainSortID=this._getSortID(q$R,q$_),q$a._sprite3D=this,q$a.renderObj=q$R,q$a._material=q$_,q$a},q$S._changeRenderObjectsByMesh=function(){var q$S=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=q$S;for(var q$_=0;q$_<q$S;q$_++)this._changeRenderObjectByMesh(q$_)},q$S._onMeshChanged=function(q$S){var q$_=q$S.sharedMesh;q$_.loaded?this._changeRenderObjectsByMesh():q$_.once("loaded",this,this._onMeshLoaded)},q$S._onMeshLoaded=function(q$S){q$S===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},q$S._onMaterialChanged=function(q$S,q$_,q$a){q$_<this._render._renderElements.length&&this._changeRenderObjectByMaterial(q$_,q$a)},q$S._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},q$S._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},q$S._parseCustomProps=function(q$S,q$_,q$a,q$R){var q$J=this.meshRender,q$V=q$a.lightmapIndex;null!=q$V&&(q$J.lightmapIndex=q$V);var q$W,q$k,q$z=q$a.lightmapScaleOffset;if(q$z&&(q$J.lightmapScaleOffset=new q$k_(q$z[0],q$z[1],q$z[2],q$z[3])),q$R.instanceParams)(q$W=q$R.instanceParams.loadPath)&&(q$k=q$F.getRes(q$_[q$W]),(this.meshFilter.sharedMesh=q$k).loaded?q$J.sharedMaterials=q$k.materials:q$k.once("loaded",this,this._applyMeshMaterials));else{(q$W=q$a.meshPath)&&(q$k=q$F.getRes(q$_[q$W]),this.meshFilter.sharedMesh=q$k);var q$b=q$a.materials;if(q$b){var q$H=q$J.sharedMaterials,q$L=q$b.length;q$H.length=q$L;for(var q$C=0;q$C<q$L;q$C++)q$H[q$C]=q$F.getRes(q$_[q$b[q$C].path]);q$J.sharedMaterials=q$H}}},q$S._applyMeshMaterials=function(q$S){for(var q$_=this._render.sharedMaterials,q$a=q$S.materials,q$R=0,q$J=q$a.length;q$R<q$J;q$R++)q$_[q$R]||(q$_[q$R]=q$a[q$R]);this._render.sharedMaterials=q$_},q$S._addToInitStaticBatchManager=function(){q$R._staticBatchManager._addInitBatchSprite(this)},q$S.cloneTo=function(q$S){var q$_=q$S;q$_._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var q$a=this._render,q$R=q$_._render;q$R.enable=q$a.enable,q$R.sharedMaterials=q$a.sharedMaterials,q$R.castShadow=q$a.castShadow;var q$J=q$a.lightmapScaleOffset;q$J&&(q$R.lightmapScaleOffset=q$J.clone()),q$R.lightmapIndex=q$a.lightmapIndex,q$R.receiveShadow=q$a.receiveShadow,q$R.sortingFudge=q$a.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,q$S)},q$S.destroy=function(q$S){if(void 0===q$S&&(q$S=!0),!this.destroyed){var q$_=this.meshFilter.sharedMesh;null!=q$_&&(q$_.loaded||q$_.off("loaded",this,this._applyMeshMaterials)),q$a.prototype.destroy.call(this,q$S),this._geometryFilter._destroy()}},q$t(0,q$S,"meshFilter",function(){return this._geometryFilter}),q$t(0,q$S,"meshRender",function(){return this._render}),q$R.__init__=function(){q$RS._staticBatchManagers.push(q$R._staticBatchManager)},q$R.load=function(q$S){return q$Q.loader.create(q$S,null,null,q$R)},q$L(q$R,["_staticBatchManager",function(){return this._staticBatchManager=new q$n_}]),q$R}(q$Z_)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(q$S,q$_){"use strict";for(var q$a in Object.defineProperty(q$_,"__esModule",{value:!0}),Laya){var q$R=Laya[q$a];q$R&&q$R.__isclass&&(q$_[q$a]=q$R)}}),function(q$S,q$_,q$JS){q$JS.un,q$JS.uns;var q$a=q$JS.static,q$R=q$JS.class,q$V=q$JS.getset,q$o=q$JS.__newvec,q$k=laya.maths.Bezier,q$L=laya.utils.Browser,q$AS=laya.utils.Byte,q$J=(laya.events.Event,laya.events.EventDispatcher),q$W=laya.display.Graphics,q$z=(laya.resource.HTMLCanvas,laya.utils.Handler),q$b=laya.net.Loader,q$C=laya.maths.MathUtil,q$XS=laya.maths.Matrix,q$$=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),q$H=(laya.renders.RenderContext,laya.resource.Resource),q$G=laya.utils.RunDriver,q$VS=laya.display.Sprite,q$t=laya.utils.Stat,q$hS=laya.resource.Texture,q$F=(laya.net.URL,laya.utils.Utils),q$X=function(){function q$S(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return q$R(q$S,"laya.ani.AnimationContent"),q$S}(),q$h=function(){function q$S(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return q$R(q$S,"laya.ani.AnimationNodeContent"),q$S}(),q$D=function(){function q$S(){}return q$R(q$S,"laya.ani.AnimationParser01"),q$S.parse=function(q$S,q$_){var q$a=q$_.__getBuffer(),q$R=0,q$J=0,q$V=0,q$W=0,q$k=0,q$z=0,q$b=0,q$H=q$_.readUTFString();q$S._aniClassName=q$H;var q$L,q$C=q$_.readUTFString().split("\n"),q$G=q$_.getUint8(),q$t=q$_.getUint32(),q$o=q$_.getUint32();0<q$t&&(q$L=q$a.slice(q$t,q$o));var q$$=new q$AS(q$L);for(0<q$o&&(q$S._publicExtData=q$a.slice(q$o,q$a.byteLength)),q$S._useParent=!!q$_.getUint8(),q$S._anis.length=q$G,q$R=0;q$R<q$G;q$R++){var q$F=q$S._anis[q$R]=new q$X;q$F.nodes=new Array;var q$T=q$F.name=q$C[q$_.getUint16()];q$S._aniMap[q$T]=q$R,q$F.bone3DMap={},q$F.playTime=q$_.getFloat32(),q$F.playTime<=0&&console.error("播放时间不能为0  url="+q$S.url+" name="+q$F.name);var q$D=q$F.nodes.length=q$_.getUint8();for(q$J=q$F.totalKeyframeDatasLength=0;q$J<q$D;q$J++){var q$j=q$F.nodes[q$J]=new q$h;q$j.childs=[];var q$Q=q$_.getInt16();0<=q$Q&&(q$j.name=q$C[q$Q],q$F.bone3DMap[q$j.name]=q$J),q$j.keyFrame=new Array,q$j.parentIndex=q$_.getInt16(),-1==q$j.parentIndex?q$j.parent=null:q$j.parent=q$F.nodes[q$j.parentIndex],q$j.lerpType=q$_.getUint8();var q$m=q$_.getUint32();q$$.pos=q$m;var q$q=q$j.keyframeWidth=q$$.getUint16();if(q$F.totalKeyframeDatasLength+=q$q,0===q$j.lerpType||1===q$j.lerpType)for(q$j.interpolationMethod=[],q$j.interpolationMethod.length=q$q,q$V=0;q$V<q$q;q$V++)q$j.interpolationMethod[q$V]=q$P.interpolation[q$$.getUint8()];null!=q$j.parent&&q$j.parent.childs.push(q$j);var q$N=q$_.getUint16();0<q$N&&(q$j.extenData=q$a.slice(q$_.pos,q$_.pos+q$N),q$_.pos+=q$N);var q$n,q$l=q$_.getUint16(),q$B=0;for(q$V=0,q$W=q$j.keyFrame.length=q$l;q$V<q$W;q$V++){if((q$n=q$j.keyFrame[q$V]=new q$u).duration=q$_.getFloat32(),q$n.startTime=q$B,2===q$j.lerpType){q$n.interpolationData=[];var q$I,q$A=q$_.getUint8();switch(q$I=q$_.getFloat32()){case 254:for(q$n.interpolationData.length=q$q,q$b=0;q$b<q$q;q$b++)q$n.interpolationData[q$b]=0;break;case 255:for(q$n.interpolationData.length=q$q,q$b=0;q$b<q$q;q$b++)q$n.interpolationData[q$b]=5;break;default:for(q$n.interpolationData.push(q$I),q$z=1;q$z<q$A;q$z++)q$n.interpolationData.push(q$_.getFloat32())}}for(q$n.data=new Float32Array(q$q),q$k=0;q$k<q$q;q$k++)q$n.data[q$k]=q$_.getFloat32(),-1e-8<q$n.data[q$k]&&q$n.data[q$k]<1e-8&&(q$n.data[q$k]=0);q$B+=q$n.duration}q$n.startTime=q$F.playTime,q$j.playTime=q$F.playTime,q$S._calculateKeyFrame(q$j,q$l,q$q)}}},q$S}(),q$j=function(){function q$Q(){}return q$R(q$Q,"laya.ani.AnimationParser02"),q$Q.READ_DATA=function(){q$Q._DATA.offset=q$Q._reader.getUint32(),q$Q._DATA.size=q$Q._reader.getUint32()},q$Q.READ_BLOCK=function(){for(var q$S=q$Q._BLOCK.count=q$Q._reader.getUint16(),q$_=q$Q._BLOCK.blockStarts=[],q$a=q$Q._BLOCK.blockLengths=[],q$R=0;q$R<q$S;q$R++)q$_.push(q$Q._reader.getUint32()),q$a.push(q$Q._reader.getUint32())},q$Q.READ_STRINGS=function(){var q$S=q$Q._reader.getUint32(),q$_=q$Q._reader.getUint16(),q$a=q$Q._reader.pos;q$Q._reader.pos=q$S+q$Q._DATA.offset;for(var q$R=0;q$R<q$_;q$R++)q$Q._strings[q$R]=q$Q._reader.readUTFString();q$Q._reader.pos=q$a},q$Q.parse=function(q$S,q$_){q$Q._templet=q$S;(q$Q._reader=q$_).__getBuffer();q$Q.READ_DATA(),q$Q.READ_BLOCK(),q$Q.READ_STRINGS();for(var q$a=0,q$R=q$Q._BLOCK.count;q$a<q$R;q$a++){var q$J=q$_.getUint16(),q$V=q$Q._strings[q$J],q$W=q$Q["READ_"+q$V];if(null==q$W)throw new Error("model file err,no this function:"+q$J+" "+q$V);q$W.call()}},q$Q.READ_ANIMATIONS=function(){var q$S=q$Q._reader,q$_=q$S.__getBuffer(),q$a=0,q$R=0,q$J=0,q$V=0,q$W=q$S.getUint16(),q$k=[];for(q$k.length=q$W,q$a=0;q$a<q$W;q$a++)q$k[q$a]=q$P.interpolation[q$S.getByte()];var q$z=q$S.getUint8();for(q$Q._templet._anis.length=q$z,q$a=0;q$a<q$z;q$a++){var q$b=q$Q._templet._anis[q$a]={};q$b.nodes=new Array;var q$H=q$b.name=q$Q._strings[q$S.getUint16()];q$Q._templet._aniMap[q$H]=q$a,q$b.bone3DMap={},q$b.playTime=q$S.getFloat32();var q$L=q$b.nodes.length=q$S.getInt16();for(q$R=q$b.totalKeyframeDatasLength=0;q$R<q$L;q$R++){var q$C=q$b.nodes[q$R]={};q$C.keyframeWidth=q$W,q$C.childs=[];var q$G=q$S.getUint16();0<=q$G&&(q$C.name=q$Q._strings[q$G],q$b.bone3DMap[q$C.name]=q$R),q$C.keyFrame=new Array,q$C.parentIndex=q$S.getInt16(),-1==q$C.parentIndex?q$C.parent=null:q$C.parent=q$b.nodes[q$C.parentIndex],q$b.totalKeyframeDatasLength+=q$W,q$C.interpolationMethod=q$k,null!=q$C.parent&&q$C.parent.childs.push(q$C);var q$t=q$S.getUint16(),q$o=null,q$$=null;for(q$J=0,q$V=q$C.keyFrame.length=q$t;q$J<q$V;q$J++){(q$o=q$C.keyFrame[q$J]={}).startTime=q$S.getFloat32(),q$$&&(q$$.duration=q$o.startTime-q$$.startTime);var q$F=q$Q._DATA.offset,q$T=q$S.getUint32(),q$D=4*q$W,q$j=q$_.slice(q$F+q$T,q$F+q$T+q$D);q$o.data=new Float32Array(q$j),q$$=q$o}q$o.duration=0,q$C.playTime=q$b.playTime,q$Q._templet._calculateKeyFrame(q$C,q$t,q$W)}}},q$Q._templet=null,q$Q._reader=null,q$Q._strings=[],q$a(q$Q,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),q$Q}(),q$uS=(function(){function q$S(){}q$R(q$S,"laya.ani.AnimationState"),q$S.stopped=0,q$S.paused=1,q$S.playing=2}(),function(){function q$J(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new q$ZS,this.resultMatrix=new q$XS,this._children=[]}q$R(q$J,"laya.ani.bone.Bone");var q$S=q$J.prototype;return q$S.setTempMatrix=function(q$S){this._tempMatrix=q$S;var q$_,q$a=0;for(q$a=0,q$_=this._children.length;q$a<q$_;q$a++)this._children[q$a].setTempMatrix(this._tempMatrix)},q$S.update=function(q$S){var q$_;if(this.rotation=this.transform.skX,q$S)q$_=this.resultTransform.getMatrix(),q$XS.mul(q$_,q$S,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)q$_=this.resultTransform.getMatrix(),q$XS.mul(q$_,this.parentBone.resultMatrix,this.resultMatrix);else{var q$a=this.parentBone,q$R=NaN,q$J=NaN,q$V=NaN,q$W=this.parentBone.resultMatrix;q$_=this.resultTransform.getMatrix();var q$k=q$W.a*q$_.tx+q$W.c*q$_.ty+q$W.tx,q$z=q$W.b*q$_.tx+q$W.d*q$_.ty+q$W.ty,q$b=new q$XS;this.inheritRotation?(q$R=Math.atan2(q$a.resultMatrix.b,q$a.resultMatrix.a),q$J=Math.cos(q$R),q$V=Math.sin(q$R),q$b.setTo(q$J,q$V,-q$V,q$J,0,0),q$XS.mul(this._tempMatrix,q$b,q$XS.TEMP),q$XS.TEMP.copyTo(q$b),q$_=this.resultTransform.getMatrix(),q$XS.mul(q$_,q$b,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,q$_=this.resultTransform.getMatrix(),q$XS.TEMP.identity(),q$XS.TEMP.d=this.d,q$XS.mul(q$_,q$XS.TEMP,this.resultMatrix)),this.resultMatrix.tx=q$k,this.resultMatrix.ty=q$z}else(q$_=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var q$H,q$L=0;for(q$L=0,q$H=this._children.length;q$L<q$H;q$L++)this._children[q$L].update()},q$S.updateChild=function(){var q$S,q$_=0;for(q$_=0,q$S=this._children.length;q$_<q$S;q$_++)this._children[q$_].update()},q$S.setRotation=function(q$S){this._sprite&&(this._sprite.rotation=180*q$S/Math.PI)},q$S.updateDraw=function(q$S,q$_){q$J.ShowBones&&!q$J.ShowBones[this.name]||(this._sprite||(this._sprite=new q$VS,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),q$JS.stage.addChild(this._sprite)),this._sprite.x=q$S+this.resultMatrix.tx,this._sprite.y=q$_+this.resultMatrix.ty);var q$a,q$R=0;for(q$R=0,q$a=this._children.length;q$R<q$a;q$R++)this._children[q$R].updateDraw(q$S,q$_)},q$S.addChild=function(q$S){this._children.push(q$S),q$S.parentBone=this},q$S.findBone=function(q$S){if(this.name==q$S)return this;var q$_,q$a,q$R=0;for(q$R=0,q$_=this._children.length;q$R<q$_;q$R++)if(q$a=this._children[q$R].findBone(q$S))return q$a;return null},q$S.localToWorld=function(q$S){var q$_=q$S[0],q$a=q$S[1];q$S[0]=q$_*this.resultMatrix.a+q$a*this.resultMatrix.c+this.resultMatrix.tx,q$S[1]=q$_*this.resultMatrix.b+q$a*this.resultMatrix.d+this.resultMatrix.ty},q$J.ShowBones={},q$J}()),q$KS=function(){function q$o(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}q$R(q$o,"laya.ani.bone.BoneSlot");var q$S=q$o.prototype;return q$S.showSlotData=function(q$S,q$_){void 0===q$_&&(q$_=!0),this.currSlotData=q$S,q$_&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},q$S.showDisplayByName=function(q$S){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(q$S))},q$S.replaceDisplayByName=function(q$S,q$_){if(this.currSlotData){var q$a;q$a=this.currSlotData.getDisplayByName(q$S);var q$R;q$R=this.currSlotData.getDisplayByName(q$_),this.replaceDisplayByIndex(q$a,q$R)}},q$S.replaceDisplayByIndex=function(q$S,q$_){this.currSlotData&&(this._replaceDic[q$S]=q$_,this.displayIndex==q$S&&this.showDisplayByIndex(q$S))},q$S.showDisplayByIndex=function(q$S){if(null!=this._replaceDic[q$S]&&(q$S=this._replaceDic[q$S]),this.currSlotData&&-1<q$S&&q$S<this.currSlotData.displayArr.length){if(this.displayIndex=q$S,this.currDisplayData=this.currSlotData.displayArr[q$S],this.currDisplayData){var q$_=this.currDisplayData.name;this.currTexture=this.templet.getTexture(q$_),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!q$$.isConchApp||q$$.isConchApp&&"0.9.15"<q$VS.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},q$S.replaceSkin=function(q$S){this._diyTexture=q$S,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},q$S.setParentMatrix=function(q$S){this._parentMatrix=q$S},q$S.draw=function(q$S,q$_,q$a,q$R){if(void 0===q$a&&(q$a=!1),void 0===q$R&&(q$R=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var q$J,q$V=this.currTexture;switch(this._diyTexture&&(q$V=this._diyTexture),this.currDisplayData.type){case 0:if(q$S){var q$W=this.getDisplayMatrix();if(this._parentMatrix){var q$k=!1;if(q$W){var q$z;if(q$XS.mul(q$W,this._parentMatrix,q$XS.TEMP),q$z=q$a?(null==this._resultMatrix&&(this._resultMatrix=new q$XS),this._resultMatrix):new q$XS,!q$$.isWebGL&&this.currDisplayData.uvs||q$$.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var q$b=q$o._tempMatrix;q$b.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(q$b.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(q$k=!0,q$b.rotate(-Math.PI/2)),q$XS.mul(q$b,q$XS.TEMP,q$z)}else q$XS.TEMP.copyTo(q$z);q$k?q$S.drawTexture(q$V,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,q$z):q$S.drawTexture(q$V,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,q$z)}}}break;case 1:if(null==(q$J=q$a?(null==this._skinSprite&&(this._skinSprite=q$o.createSkinMesh()),this._skinSprite):q$o.createSkinMesh()))return;var q$H;if(null==this.currDisplayData.bones){var q$L,q$C=this.currDisplayData.weights;this.deformData&&(q$C=this.deformData),q$L=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=q$q.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=q$q.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=q$C;this.currDisplayData.triangles.length;q$H=this.currDisplayData.triangles,q$J.init2(q$V,null,q$H,this._mVerticleArr,q$L);var q$G,q$t=this.getDisplayMatrix();if(this._parentMatrix)if(q$t)q$XS.mul(q$t,this._parentMatrix,q$XS.TEMP),q$G=q$a?(null==this._resultMatrix&&(this._resultMatrix=new q$XS),this._resultMatrix):new q$XS,q$XS.TEMP.copyTo(q$G),q$J.transform=q$G}else this.skinMesh(q$_,q$J,q$R);q$S.drawSkin(q$J);break;case 2:if(null==(q$J=q$a?(null==this._skinSprite&&(this._skinSprite=q$o.createSkinMesh()),this._skinSprite):q$o.createSkinMesh()))return;this.skinMesh(q$_,q$J,q$R),q$S.drawSkin(q$J)}}},q$S.skinMesh=function(q$S,q$_,q$a){var q$R,q$J=this.currTexture,q$V=this.currDisplayData.bones;q$R=this._diyTexture?(q$J=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=q$q.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=q$q.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var q$W,q$k,q$z=this.currDisplayData.weights,q$b=this.currDisplayData.triangles,q$H=0,q$L=0,q$C=0,q$G=NaN,q$t=NaN,q$o=0,q$$=0,q$F=[],q$T=0,q$D=0;if(this.deformData&&0<this.deformData.length){var q$j=0;for(q$T=0,q$D=q$V.length;q$T<q$D;){for(q$C=q$V[q$T++]+q$T,q$L=q$H=0;q$T<q$C;q$T++)q$k=q$S[q$V[q$T]],q$G=q$z[q$o]+this.deformData[q$j++],q$t=q$z[q$o+1]+this.deformData[q$j++],q$$=q$z[q$o+2],q$H+=(q$G*q$k.a+q$t*q$k.c+q$k.tx)*q$$,q$L+=(q$G*q$k.b+q$t*q$k.d+q$k.ty)*q$$,q$o+=3;q$F.push(q$H,q$L)}}else for(q$T=0,q$D=q$V.length;q$T<q$D;){for(q$C=q$V[q$T++]+q$T,q$L=q$H=0;q$T<q$C;q$T++)q$k=q$S[q$V[q$T]],q$G=q$z[q$o],q$t=q$z[q$o+1],q$$=q$z[q$o+2],q$H+=(q$G*q$k.a+q$t*q$k.c+q$k.tx)*q$$,q$L+=(q$G*q$k.b+q$t*q$k.d+q$k.ty)*q$$,q$o+=3;q$F.push(q$H,q$L)}this._mVerticleArr=q$F,q$W=q$b,q$_.init2(q$J,null,q$W,this._mVerticleArr,q$R)},q$S.drawBonePoint=function(q$S){q$S&&this._parentMatrix&&q$S.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},q$S.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},q$S.getMatrix=function(){return this._resultMatrix},q$S.copy=function(){var q$S=new q$o;return q$S.type="copy",q$S.name=this.name,q$S.attachmentName=this.attachmentName,q$S.srcDisplayIndex=this.srcDisplayIndex,q$S.parent=this.parent,q$S.displayIndex=this.displayIndex,q$S.templet=this.templet,q$S.currSlotData=this.currSlotData,q$S.currTexture=this.currTexture,q$S.currDisplayData=this.currDisplayData,q$S},q$o.createSkinMesh=function(){return q$$.isWebGL||q$$.isConchApp?q$G.skinAniSprite():(q$$.isWebGL,null)},q$a(q$o,["_tempMatrix",function(){return this._tempMatrix=new q$XS}]),q$o}(),q$PS=function(){function q$S(){this.skinName=null,this.deformSlotDataList=[]}return q$R(q$S,"laya.ani.bone.DeformAniData"),q$S}(),q$MS=function(){function q$S(){this.deformSlotDisplayList=[]}return q$R(q$S,"laya.ani.bone.DeformSlotData"),q$S}(),q$rS=function(){function q$S(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}q$R(q$S,"laya.ani.bone.DeformSlotDisplayData");var q$_=q$S.prototype;return q$_.binarySearch1=function(q$S,q$_){var q$a=0,q$R=q$S.length-2;if(0==q$R)return 1;for(var q$J=q$R>>>1;;){if(q$S[Math.floor(q$J+1)]<=q$_?q$a=q$J+1:q$R=q$J,q$a==q$R)return q$a+1;q$J=q$a+q$R>>>1}return 0},q$_.apply=function(q$S,q$_,q$a){if(void 0===q$a&&(q$a=1),q$S+=.05,!(this.timeList.length<=0)){var q$R=0;if(!(q$S<this.timeList[0])){var q$J=this.vectices[0].length,q$V=[],q$W=this.binarySearch1(this.timeList,q$S);if(this.frameIndex=q$W,q$S>=this.timeList[this.timeList.length-1]){var q$k=this.vectices[this.vectices.length-1];if(q$a<1)for(q$R=0;q$R<q$J;q$R++)q$V[q$R]+=(q$k[q$R]-q$V[q$R])*q$a;else for(q$R=0;q$R<q$J;q$R++)q$V[q$R]=q$k[q$R];this.deformData=q$V}else{this.tweenKeyList[this.frameIndex];var q$z=this.vectices[this.frameIndex-1],q$b=this.vectices[this.frameIndex],q$H=this.timeList[this.frameIndex-1],q$L=this.timeList[this.frameIndex];q$a=this.tweenKeyList[q$W-1]?(q$S-q$H)/(q$L-q$H):0;var q$C=NaN;for(q$R=0;q$R<q$J;q$R++)q$C=q$z[q$R],q$V[q$R]=q$C+(q$b[q$R]-q$C)*q$a;this.deformData=q$V}}}},q$S}(),q$eS=function(){function q$S(){this.time=NaN,this.drawOrder=[]}return q$R(q$S,"laya.ani.bone.DrawOrderData"),q$S}(),q$gS=function(){function q$S(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return q$R(q$S,"laya.ani.bone.EventData"),q$S}(),q$T=function(){function q$RS(q$S,q$_){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=q$S,this._targetBone=q$_[q$S.targetBoneIndex],this.isSpine=q$S.isSpine,null==this._bones&&(this._bones=[]);for(var q$a=this._bones.length=0,q$R=q$S.boneIndexs.length;q$a<q$R;q$a++)this._bones.push(q$_[q$S.boneIndexs[q$a]]);this.name=q$S.name,this.mix=q$S.mix,this.bendDirection=q$S.bendDirection}q$R(q$RS,"laya.ani.bone.IkConstraint");var q$S=q$RS.prototype;return q$S.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},q$S._applyIk1=function(q$S,q$_,q$a,q$R){var q$J=q$S.parentBone,q$V=1/(q$J.resultMatrix.a*q$J.resultMatrix.d-q$J.resultMatrix.b*q$J.resultMatrix.c),q$W=q$_-q$J.resultMatrix.tx,q$k=q$a-q$J.resultMatrix.ty,q$z=(q$W*q$J.resultMatrix.d-q$k*q$J.resultMatrix.c)*q$V-q$S.transform.x,q$b=(q$k*q$J.resultMatrix.a-q$W*q$J.resultMatrix.b)*q$V-q$S.transform.y,q$H=Math.atan2(q$b,q$z)*q$RS.radDeg-0-q$S.transform.skX;q$S.transform.scX<0&&(q$H+=180),180<q$H?q$H-=360:q$H<-180&&(q$H+=360),q$S.transform.skX=q$S.transform.skY=q$S.transform.skX+q$H*q$R,q$S.update()},q$S.updatePos=function(q$S,q$_){this._sp&&this._sp.pos(q$S,q$_)},q$S._applyIk2=function(q$S,q$_,q$a,q$R,q$J,q$V){if(0!=q$V){var q$W=q$S.resultTransform.x,q$k=q$S.resultTransform.y,q$z=q$S.transform.scX,q$b=q$S.transform.scY,q$H=q$_.transform.scX,q$L=0,q$C=0,q$G=0;q$G=q$z<0?(q$z=-q$z,q$L=180,-1):(q$L=0,1),q$b<0&&(q$b=-q$b,q$G=-q$G),q$C=q$H<0?(q$H=-q$H,180):0;var q$t=q$_.resultTransform.x,q$o=NaN,q$$=NaN,q$F=NaN,q$T=q$S.resultMatrix.a,q$D=q$S.resultMatrix.c,q$j=q$S.resultMatrix.b,q$Q=q$S.resultMatrix.d,q$m=Math.abs(q$z-q$b)<=1e-4;q$F=q$m?(q$$=q$T*q$t+q$D*(q$o=q$_.resultTransform.y)+q$S.resultMatrix.tx,q$j*q$t+q$Q*q$o+q$S.resultMatrix.ty):(q$o=0,q$$=q$T*q$t+q$S.resultMatrix.tx,q$j*q$t+q$S.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new q$VS,q$JS.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(q$a,q$R,15,"#ffff00"),this._sp.graphics.drawCircle(q$$,q$F,15,"#ff00ff")),q$S.setRotation(Math.atan2(q$F-q$S.resultMatrix.ty,q$$-q$S.resultMatrix.tx));var q$q=q$S.parentBone;q$T=q$q.resultMatrix.a,q$D=q$q.resultMatrix.c,q$j=q$q.resultMatrix.b;var q$N=1/(q$T*(q$Q=q$q.resultMatrix.d)-q$D*q$j),q$n=q$a-q$q.resultMatrix.tx,q$l=q$R-q$q.resultMatrix.ty,q$B=(q$n*q$Q-q$l*q$D)*q$N-q$W,q$I=(q$l*q$T-q$n*q$j)*q$N-q$k,q$A=((q$n=q$$-q$q.resultMatrix.tx)*q$Q-(q$l=q$F-q$q.resultMatrix.ty)*q$D)*q$N-q$W,q$X=(q$l*q$T-q$n*q$j)*q$N-q$k,q$h=Math.sqrt(q$A*q$A+q$X*q$X),q$u=q$_.length*q$H,q$K=NaN,q$P=NaN;if(q$m){var q$M=(q$B*q$B+q$I*q$I-q$h*q$h-(q$u*=q$z)*q$u)/(2*q$h*q$u);q$M<-1?q$M=-1:1<q$M&&(q$M=1),q$P=Math.acos(q$M)*q$J,q$T=q$h+q$u*q$M,q$D=q$u*Math.sin(q$P),q$K=Math.atan2(q$I*q$T-q$B*q$D,q$B*q$T+q$I*q$D)}else{var q$r=(q$T=q$z*q$u)*q$T,q$e=(q$D=q$b*q$u)*q$D,q$g=q$B*q$B+q$I*q$I,q$x=Math.atan2(q$I,q$B),q$s=-2*q$e*q$h,q$U=q$e-q$r;if(0<(q$Q=q$s*q$s-4*q$U*(q$j=q$e*q$h*q$h+q$r*q$g-q$r*q$e))){var q$f=Math.sqrt(q$Q);q$s<0&&(q$f=-q$f);var q$Y=(q$f=-(q$s+q$f)/2)/q$U,q$i=q$j/q$f,q$Z=Math.abs(q$Y)<Math.abs(q$i)?q$Y:q$i;q$Z*q$Z<=q$g&&(q$l=Math.sqrt(q$g-q$Z*q$Z)*q$J,q$K=q$x-Math.atan2(q$l,q$Z),q$P=Math.atan2(q$l/q$b,(q$Z-q$h)/q$z))}var q$p=0,q$c=Number.MAX_VALUE,q$y=0,q$E=0,q$O=0,q$w=0,q$v=0,q$d=0;q$w<(q$Q=(q$n=q$h+q$T)*q$n)&&(q$O=0,q$w=q$Q,q$v=q$n),(q$Q=(q$n=q$h-q$T)*q$n)<q$c&&(q$p=Math.PI,q$c=q$Q,q$y=q$n);var q$SS=Math.acos(-q$T*q$h/(q$r-q$e));(q$Q=(q$n=q$T*Math.cos(q$SS)+q$h)*q$n+(q$l=q$D*Math.sin(q$SS))*q$l)<q$c&&(q$p=q$SS,q$c=q$Q,q$y=q$n,q$E=q$l),q$w<q$Q&&(q$O=q$SS,q$w=q$Q,q$v=q$n,q$d=q$l),q$P=q$g<=(q$c+q$w)/2?(q$K=q$x-Math.atan2(q$E*q$J,q$y),q$p*q$J):(q$K=q$x-Math.atan2(q$d*q$J,q$v),q$O*q$J)}var q$_S=Math.atan2(q$o,q$t)*q$G,q$aS=q$S.resultTransform.skX;180<(q$K=(q$K-q$_S)*q$RS.radDeg+q$L-q$aS)?q$K-=360:q$K<-180&&(q$K+=360),q$S.resultTransform.x=q$W,q$S.resultTransform.y=q$k,q$S.resultTransform.skX=q$S.resultTransform.skY=q$aS+q$K*q$V,q$aS=q$_.resultTransform.skX,180<(q$P=((q$P+q$_S)*q$RS.radDeg-0)*q$G+q$C-(q$aS%=360))?q$P-=360:q$P<-180&&(q$P+=360),q$_.resultTransform.x=q$t,q$_.resultTransform.y=q$o,q$_.resultTransform.skX=q$_.resultTransform.skY=q$_.resultTransform.skY+q$P*q$V,q$S.update()}},q$S._applyIk3=function(q$S,q$_,q$a,q$R,q$J,q$V){if(0!=q$V){var q$W,q$k,q$z=q$_.resultMatrix.a*q$_.length,q$b=q$_.resultMatrix.b*q$_.length,q$H=q$z*q$z+q$b*q$b,q$L=Math.sqrt(q$H),q$C=q$S.resultMatrix.tx,q$G=q$S.resultMatrix.ty,q$t=q$_.resultMatrix.tx,q$o=q$_.resultMatrix.ty,q$$=q$t-q$C,q$F=q$o-q$G,q$T=q$$*q$$+q$F*q$F,q$D=Math.sqrt(q$T),q$j=(q$$=q$a-q$S.resultMatrix.tx)*q$$+(q$F=q$R-q$S.resultMatrix.ty)*q$F,q$Q=Math.sqrt(q$j);if(q$L+q$D<=q$Q||q$Q+q$L<=q$D||q$Q+q$D<=q$L){var q$m=NaN;q$t=q$C+(q$m=q$L+q$D<=q$Q?1:-1)*(q$a-q$C)*q$D/q$Q,q$o=q$G+q$m*(q$R-q$G)*q$D/q$Q}else{var q$q=(q$T-q$H+q$j)/(2*q$j),q$N=Math.sqrt(q$T-q$q*q$q*q$j)/q$Q,q$n=q$C+q$$*q$q,q$l=q$G+q$F*q$q,q$B=-q$F*q$N,q$I=q$$*q$N;q$o=0<q$J?(q$t=q$n-q$B,q$l-q$I):(q$t=q$n+q$B,q$l+q$I)}q$W=q$t,q$k=q$o,this.isDebug&&(this._sp||(this._sp=new q$VS,q$JS.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(q$C,q$G,15,"#ff00ff"),this._sp.graphics.drawCircle(q$a,q$R,15,"#ffff00"),this._sp.graphics.drawCircle(q$W,q$k,15,"#ff00ff"));var q$A,q$X;q$A=Math.atan2(q$k-q$S.resultMatrix.ty,q$W-q$S.resultMatrix.tx),q$S.setRotation(q$A),(q$X=q$RS._tempMatrix).identity(),q$X.rotate(q$A),q$X.scale(q$S.resultMatrix.getScaleX(),q$S.resultMatrix.getScaleY()),q$X.translate(q$S.resultMatrix.tx,q$S.resultMatrix.ty),q$X.copyTo(q$S.resultMatrix),q$S.updateChild();var q$h,q$u;q$h=Math.atan2(q$R-q$k,q$a-q$W),q$_.setRotation(q$h),(q$u=q$RS._tempMatrix).identity(),q$u.rotate(q$h),q$u.scale(q$_.resultMatrix.getScaleX(),q$_.resultMatrix.getScaleY()),q$u.translate(q$W,q$k),q$X.copyTo(q$_.resultMatrix),q$_.updateChild()}},q$a(q$RS,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new q$XS}]),q$RS}(),q$xS=function(){function q$S(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return q$R(q$S,"laya.ani.bone.IkConstraintData"),q$S}(),q$Q=function(){function q$u(q$S,q$_){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=q$S,this.position=q$S.position,this.spacing=q$S.spacing,this.rotateMix=q$S.rotateMix,this.translateMix=q$S.translateMix,this.bones=[];for(var q$a=this.data.bones,q$R=0,q$J=q$a.length;q$R<q$J;q$R++)this.bones.push(q$_[q$a[q$R]])}q$R(q$u,"laya.ani.bone.PathConstraint");var q$S=q$u.prototype;return q$S.apply=function(q$S,q$_){if(this.target){var q$a=this.translateMix,q$R=this.translateMix,q$J=0<q$R,q$V=this.data.spacingMode,q$W="length"==q$V,q$k=this.data.rotateMode,q$z="tangent"==q$k,q$b="chainScale"==q$k,q$H=[],q$L=this.bones.length,q$C=q$z?q$L:q$L+1,q$G=[];(this._spaces=q$G)[0]=this.position;var q$t=this.spacing;if(q$b||q$W)for(var q$o=0,q$$=q$C-1;q$o<q$$;){var q$F=this.bones[q$o],q$T=q$F.length,q$D=q$T*q$F.resultMatrix.a,q$j=q$T*q$F.resultMatrix.b;q$T=Math.sqrt(q$D*q$D+q$j*q$j),q$b&&(q$H[q$o]=q$T),q$G[++q$o]=q$W?Math.max(0,q$T+q$t):q$t}else for(q$o=1;q$o<q$C;q$o++)q$G[q$o]=q$t;var q$Q=this.computeWorldPositions(this.target,q$S,q$_,q$C,q$z,"percent"==this.data.positionMode,"percent"==q$V);if(this._debugKey){for(q$o=0;q$o<q$Q.length;q$o++)q$_.drawCircle(q$Q[q$o++],q$Q[q$o++],5,"#00ff00");var q$m=[];for(q$o=0;q$o<q$Q.length;q$o++)q$m.push(q$Q[q$o++],q$Q[q$o++]);q$_.drawLines(0,0,q$m,"#ff0000")}var q$q=q$Q[0],q$N=q$Q[1],q$n=this.data.offsetRotation,q$l="chain"==q$k&&0==q$n,q$B=NaN;for(q$o=0,q$B=3;q$o<q$L;q$o++,q$B+=3){(q$F=this.bones[q$o]).resultMatrix.tx+=(q$q-q$F.resultMatrix.tx)*q$a,q$F.resultMatrix.ty+=(q$N-q$F.resultMatrix.ty)*q$a;var q$I=(q$D=q$Q[q$B])-q$q,q$A=(q$j=q$Q[q$B+1])-q$N;if(q$b&&0!=(q$T=q$H[q$o])){var q$X=(Math.sqrt(q$I*q$I+q$A*q$A)/q$T-1)*q$R+1;q$F.resultMatrix.a*=q$X,q$F.resultMatrix.c*=q$X}if(q$q=q$D,q$N=q$j,q$J){var q$h=q$F.resultMatrix.a,q$u=q$F.resultMatrix.c,q$K=q$F.resultMatrix.b,q$P=q$F.resultMatrix.d,q$M=NaN,q$r=NaN,q$e=NaN;q$M=q$z?q$Q[q$B-1]:0==q$G[q$o+1]?q$Q[q$B+2]:Math.atan2(q$A,q$I),q$M-=Math.atan2(q$K,q$h)-q$n/180*Math.PI,q$l&&(q$r=Math.cos(q$M),q$e=Math.sin(q$M),q$q+=((q$T=q$F.length)*(q$r*q$h-q$e*q$K)-q$I)*q$R,q$N+=(q$T*(q$e*q$h+q$r*q$K)-q$A)*q$R),q$M>Math.PI?q$M-=2*Math.PI:q$M<-Math.PI&&(q$M+=2*Math.PI),q$M*=q$R,q$r=Math.cos(q$M),q$e=Math.sin(q$M),q$F.resultMatrix.a=q$r*q$h-q$e*q$K,q$F.resultMatrix.c=q$r*q$u-q$e*q$P,q$F.resultMatrix.b=q$e*q$h+q$r*q$K,q$F.resultMatrix.d=q$e*q$u+q$r*q$P}}}},q$S.computeWorldVertices2=function(q$S,q$_,q$a,q$R,q$J,q$V){var q$W,q$k,q$z=q$S.currDisplayData.bones,q$b=q$S.currDisplayData.weights,q$H=q$S.currDisplayData.triangles,q$L=0,q$C=0,q$G=0,q$t=0,q$o=0,q$$=0,q$F=0,q$T=0,q$D=0,q$j=0,q$Q=0;if(null!=q$z){for(q$L=0;q$L<q$a;q$L+=2)q$C+=(q$t=q$z[q$C])+1,q$G+=q$t;var q$m=q$_;for(q$o=q$V,q$$=3*q$G;q$o<q$R;q$o+=2){for(q$T=q$F=0,q$t=q$z[q$C++],q$t+=q$C;q$C<q$t;q$C++,q$$+=3){q$W=q$m[q$z[q$C]].resultMatrix,q$D=q$b[q$$],q$j=q$b[q$$+1];var q$q=q$b[q$$+2];q$F+=(q$D*q$W.a+q$j*q$W.c+q$W.tx)*q$q,q$T+=(q$D*q$W.b+q$j*q$W.d+q$W.ty)*q$q}q$J[q$o]=q$F,q$J[q$o+1]=q$T}}else{var q$N,q$n;if(q$H||(q$H=q$b),q$S.deformData&&(q$H=q$S.deformData),q$N=q$S.parent,q$_)for(q$Q=q$_.length,q$L=0;q$L<q$Q;q$L++)if(q$_[q$L].name==q$N){q$k=q$_[q$L];break}q$k&&(q$n=q$k.resultMatrix),q$n||(q$n=q$u._tempMt);var q$l=q$n.tx,q$B=q$n.ty,q$I=q$n.a,q$A=q$n.b,q$X=q$n.c,q$h=q$n.d;for(q$k&&(q$h*=q$k.d),q$C=q$a,q$o=q$V;q$o<q$R;q$C+=2,q$o+=2)q$D=q$H[q$C],q$j=q$H[q$C+1],q$J[q$o]=q$D*q$I+q$j*q$A+q$l,q$J[q$o+1]=-(q$D*q$X+q$j*q$h+q$B)}},q$S.computeWorldPositions=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W){q$S.currDisplayData.bones,q$S.currDisplayData.weights,q$S.currDisplayData.triangles;var q$k=[],q$z=0,q$b=q$S.currDisplayData.verLen,q$H=this.position,q$L=this._spaces,q$C=[],q$G=[],q$t=q$b/6,q$o=-1,q$$=NaN,q$F=0,q$T=0,q$D=NaN,q$j=NaN,q$Q=NaN,q$m=NaN;if(q$t--,q$b-=4,this.computeWorldVertices2(q$S,q$_,2,q$b,q$k,0),this._debugKey)for(q$z=0;q$z<q$k.length;)q$a.drawCircle(q$k[q$z++],q$k[q$z++],10,"#ff0000");q$C=q$k,this._curves.length=q$t;var q$q=this._curves,q$N=q$C[q$$=0],q$n=q$C[1],q$l=0,q$B=0,q$I=0,q$A=0,q$X=0,q$h=0,q$u=NaN,q$K=NaN,q$P=NaN,q$M=NaN,q$r=NaN,q$e=NaN,q$g=NaN,q$x=NaN,q$s=0;for(q$z=0,q$s=2;q$z<q$t;q$z++,q$s+=6)q$l=q$C[q$s],q$B=q$C[q$s+1],q$I=q$C[q$s+2],q$A=q$C[q$s+3],q$r=2*(q$u=.1875*(q$N-2*q$l+q$I))+(q$P=.09375*(3*(q$l-q$I)-q$N+(q$X=q$C[q$s+4]))),q$e=2*(q$K=.1875*(q$n-2*q$B+q$A))+(q$M=.09375*(3*(q$B-q$A)-q$n+(q$h=q$C[q$s+5]))),q$g=.75*(q$l-q$N)+q$u+.16666667*q$P,q$x=.75*(q$B-q$n)+q$K+.16666667*q$M,q$$+=Math.sqrt(q$g*q$g+q$x*q$x),q$g+=q$r,q$x+=q$e,q$r+=q$P,q$e+=q$M,q$$+=Math.sqrt(q$g*q$g+q$x*q$x),q$g+=q$r,q$x+=q$e,q$$+=Math.sqrt(q$g*q$g+q$x*q$x),q$g+=q$r+q$P,q$x+=q$e+q$M,q$$+=Math.sqrt(q$g*q$g+q$x*q$x),q$q[q$z]=q$$,q$N=q$X,q$n=q$h;if(q$V&&(q$H*=q$$),q$W)for(q$z=0;q$z<q$R;q$z++)q$L[q$z]*=q$$;var q$U=this._segments,q$f=0,q$Y=0;for(q$Y=q$T=q$F=q$z=0;q$z<q$R;q$z++,q$F+=3)if((q$D=q$H+=q$j=q$L[q$z])<0)this.addBeforePosition(q$D,q$C,0,q$G,q$F);else if(q$$<q$D)this.addAfterPosition(q$D-q$$,q$C,q$b-4,q$G,q$F);else{for(;;q$T++)if(!((q$m=q$q[q$T])<q$D)){0==q$T?q$D/=q$m:q$D=(q$D-(q$Q=q$q[q$T-1]))/(q$m-q$Q);break}if(q$T!=q$o){var q$i=6*(q$o=q$T);for(q$N=q$C[q$i],q$n=q$C[q$i+1],q$l=q$C[q$i+2],q$B=q$C[q$i+3],q$I=q$C[q$i+4],q$A=q$C[q$i+5],q$r=2*(q$u=.03*(q$N-2*q$l+q$I))+(q$P=.006*(3*(q$l-q$I)-q$N+(q$X=q$C[q$i+6]))),q$e=2*(q$K=.03*(q$n-2*q$B+q$A))+(q$M=.006*(3*(q$B-q$A)-q$n+(q$h=q$C[q$i+7]))),q$g=.3*(q$l-q$N)+q$u+.16666667*q$P,q$x=.3*(q$B-q$n)+q$K+.16666667*q$M,q$f=Math.sqrt(q$g*q$g+q$x*q$x),q$U[0]=q$f,q$i=1;q$i<8;q$i++)q$g+=q$r,q$x+=q$e,q$r+=q$P,q$e+=q$M,q$f+=Math.sqrt(q$g*q$g+q$x*q$x),q$U[q$i]=q$f;q$g+=q$r,q$x+=q$e,q$f+=Math.sqrt(q$g*q$g+q$x*q$x),q$U[8]=q$f,q$g+=q$r+q$P,q$x+=q$e+q$M,q$f+=Math.sqrt(q$g*q$g+q$x*q$x),q$U[9]=q$f,q$Y=0}for(q$D*=q$f;;q$Y++)if(!((q$m=q$U[q$Y])<q$D)){0==q$Y?q$D/=q$m:q$D=q$Y+(q$D-(q$Q=q$U[q$Y-1]))/(q$m-q$Q);break}this.addCurvePosition(.1*q$D,q$N,q$n,q$l,q$B,q$I,q$A,q$X,q$h,q$G,q$F,q$J||0<q$z&&0==q$j)}return q$G},q$S.addBeforePosition=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$_[q$a],q$W=q$_[q$a+1],q$k=q$_[q$a+2]-q$V,q$z=q$_[q$a+3]-q$W,q$b=Math.atan2(q$z,q$k);q$R[q$J]=q$V+q$S*Math.cos(q$b),q$R[q$J+1]=q$W+q$S*Math.sin(q$b),q$R[q$J+2]=q$b},q$S.addAfterPosition=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$_[q$a+2],q$W=q$_[q$a+3],q$k=q$V-q$_[q$a],q$z=q$W-q$_[q$a+1],q$b=Math.atan2(q$z,q$k);q$R[q$J]=q$V+q$S*Math.cos(q$b),q$R[q$J+1]=q$W+q$S*Math.sin(q$b),q$R[q$J+2]=q$b},q$S.addCurvePosition=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H,q$L){0==q$S&&(q$S=1e-4);var q$C=q$S*q$S,q$G=q$C*q$S,q$t=1-q$S,q$o=q$t*q$t,q$$=q$o*q$t,q$F=q$t*q$S,q$T=3*q$F,q$D=q$t*q$T,q$j=q$T*q$S,q$Q=q$_*q$$+q$R*q$D+q$V*q$j+q$k*q$G,q$m=q$a*q$$+q$J*q$D+q$W*q$j+q$z*q$G;q$b[q$H]=q$Q,q$b[q$H+1]=q$m,q$b[q$H+2]=q$L?Math.atan2(q$m-(q$a*q$o+q$J*q$F*2+q$W*q$C),q$Q-(q$_*q$o+q$R*q$F*2+q$V*q$C)):0},q$u.NONE=-1,q$u.BEFORE=-2,q$u.AFTER=-3,q$a(q$u,["_tempMt",function(){return this._tempMt=new q$XS}]),q$u}(),q$sS=function(){function q$S(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return q$R(q$S,"laya.ani.bone.PathConstraintData"),q$S}(),q$US=function(){function q$S(){this.name=null,this.slotArr=[]}return q$R(q$S,"laya.ani.bone.SkinData"),q$S}(),q$fS=function(){function q$S(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}q$R(q$S,"laya.ani.bone.SkinSlotDisplayData");var q$_=q$S.prototype;return q$_.createTexture=function(q$S){return this.texture||(this.texture=new q$hS(q$S.bitmap,this.uvs),q$S.bitmap.alphaTexture&&(this.texture.alphaTexture=new q$hS(q$S.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=q$S.height,this.texture.height=q$S.width,this.texture.offsetX=-q$S.offsetX,this.texture.offsetY=-q$S.offsetY,this.texture.sourceWidth=q$S.sourceHeight,this.texture.sourceHeight=q$S.sourceWidth):(this.texture.width=q$S.width,this.texture.height=q$S.height,this.texture.offsetX=-q$S.offsetX,this.texture.offsetY=-q$S.offsetY,this.texture.sourceWidth=q$S.sourceWidth,this.texture.sourceHeight=q$S.sourceHeight),q$$.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},q$_.destory=function(){this.texture&&this.texture.destroy()},q$S}(),q$YS=function(){function q$S(){this.name=null,this.displayArr=[]}return q$R(q$S,"laya.ani.bone.SlotData"),q$S.prototype.getDisplayByName=function(q$S){for(var q$_=0,q$a=this.displayArr.length;q$_<q$a;q$_++)if(this.displayArr[q$_].attachmentName==q$S)return q$_;return-1},q$S}(),q$m=function(){function q$S(q$S,q$_){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=q$o(2,0),this._data=q$S,null==this._bones&&(this._bones=[]),this.target=q$_[q$S.targetIndex];var q$a,q$R=0;for(q$R=0,q$a=q$S.boneIndexs.length;q$R<q$a;q$R++)this._bones.push(q$_[q$S.boneIndexs[q$R]]);this.rotateMix=q$S.rotateMix,this.translateMix=q$S.translateMix,this.scaleMix=q$S.scaleMix,this.shearMix=q$S.shearMix}return q$R(q$S,"laya.ani.bone.TfConstraint"),q$S.prototype.apply=function(){for(var q$S,q$_=this.target.resultMatrix.a,q$a=this.target.resultMatrix.b,q$R=this.target.resultMatrix.c,q$J=this.target.resultMatrix.d,q$V=0,q$W=this._bones.length;q$V<q$W;q$V++){if(q$S=this._bones[q$V],0<this.rotateMix){var q$k=q$S.resultMatrix.a,q$z=q$S.resultMatrix.b,q$b=q$S.resultMatrix.c,q$H=q$S.resultMatrix.d,q$L=Math.atan2(q$R,q$_)-Math.atan2(q$b,q$k)+this._data.offsetRotation*Math.PI/180;q$L>Math.PI?q$L-=2*Math.PI:q$L<-Math.PI&&(q$L+=2*Math.PI),q$L*=this.rotateMix;var q$C=Math.cos(q$L),q$G=Math.sin(q$L);q$S.resultMatrix.a=q$C*q$k-q$G*q$b,q$S.resultMatrix.b=q$C*q$z-q$G*q$H,q$S.resultMatrix.c=q$G*q$k+q$C*q$b,q$S.resultMatrix.d=q$G*q$z+q$C*q$H}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),q$S.resultMatrix.tx+=(this._temp[0]-q$S.resultMatrix.tx)*this.translateMix,q$S.resultMatrix.ty+=(this._temp[1]-q$S.resultMatrix.ty)*this.translateMix,q$S.updateChild()),0<this.scaleMix){var q$t=Math.sqrt(q$S.resultMatrix.a*q$S.resultMatrix.a+q$S.resultMatrix.c*q$S.resultMatrix.c),q$o=Math.sqrt(q$_*q$_+q$R*q$R),q$$=1e-5<q$t?(q$t+(q$o-q$t+this._data.offsetScaleX)*this.scaleMix)/q$t:0;q$S.resultMatrix.a*=q$$,q$S.resultMatrix.c*=q$$,q$t=Math.sqrt(q$S.resultMatrix.b*q$S.resultMatrix.b+q$S.resultMatrix.d*q$S.resultMatrix.d),q$o=Math.sqrt(q$a*q$a+q$J*q$J),q$$=1e-5<q$t?(q$t+(q$o-q$t+this._data.offsetScaleY)*this.scaleMix)/q$t:0,q$S.resultMatrix.b*=q$$,q$S.resultMatrix.d*=q$$}if(0<this.shearMix){q$z=q$S.resultMatrix.b,q$H=q$S.resultMatrix.d;var q$F=Math.atan2(q$H,q$z);(q$L=Math.atan2(q$J,q$a)-Math.atan2(q$R,q$_)-(q$F-Math.atan2(q$S.resultMatrix.c,q$S.resultMatrix.a)))>Math.PI?q$L-=2*Math.PI:q$L<-Math.PI&&(q$L+=2*Math.PI),q$L=q$F+(q$L+this._data.offsetShearY*Math.PI/180)*this.shearMix,q$$=Math.sqrt(q$z*q$z+q$H*q$H),q$S.resultMatrix.b=Math.cos(q$L)*q$$,q$S.resultMatrix.d=Math.sin(q$L)*q$$}}},q$S}(),q$iS=function(){function q$S(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return q$R(q$S,"laya.ani.bone.TfConstraintData"),q$S}(),q$ZS=function(){function q$S(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}q$R(q$S,"laya.ani.bone.Transform");var q$_=q$S.prototype;return q$_.initData=function(q$S){null!=q$S.x&&(this.x=q$S.x),null!=q$S.y&&(this.y=q$S.y),null!=q$S.skX&&(this.skX=q$S.skX),null!=q$S.skY&&(this.skY=q$S.skY),null!=q$S.scX&&(this.scX=q$S.scX),null!=q$S.scY&&(this.scY=q$S.scY)},q$_.getMatrix=function(){var q$S;return(q$S=this.mMatrix?this.mMatrix:this.mMatrix=new q$XS).identity(),q$S.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(q$S,this.skewX*Math.PI/180,this.skewY*Math.PI/180),q$S.rotate(this.skX*Math.PI/180),q$S.translate(this.x,this.y),q$S},q$_.skew=function(q$S,q$_,q$a){var q$R=Math.sin(q$a),q$J=Math.cos(q$a),q$V=Math.sin(q$_),q$W=Math.cos(q$_);return q$S.setTo(q$S.a*q$W-q$S.b*q$R,q$S.a*q$V+q$S.b*q$J,q$S.c*q$W-q$S.d*q$R,q$S.c*q$V+q$S.d*q$J,q$S.tx*q$W-q$S.ty*q$R,q$S.tx*q$V+q$S.ty*q$J),q$S},q$S}(),q$q=function(){function q$S(){}return q$R(q$S,"laya.ani.bone.UVTools"),q$S.getRelativeUV=function(q$S,q$_,q$a){var q$R=q$S[0],q$J=q$S[2]-q$S[0],q$V=q$S[1],q$W=q$S[5]-q$S[1];q$a||(q$a=[]),q$a.length=q$_.length;var q$k,q$z=0;q$k=q$a.length;var q$b=1/q$J,q$H=1/q$W;for(q$z=0;q$z<q$k;q$z+=2)q$a[q$z]=(q$_[q$z]-q$R)*q$b,q$a[q$z+1]=(q$_[q$z+1]-q$V)*q$H;return q$a},q$S.getAbsoluteUV=function(q$S,q$_,q$a){if(0==q$S[0]&&0==q$S[1]&&1==q$S[4]&&1==q$S[5])return q$a?(q$F.copyArray(q$a,q$_),q$a):q$_;var q$R=q$S[0],q$J=q$S[2]-q$S[0],q$V=q$S[1],q$W=q$S[5]-q$S[1];q$a||(q$a=[]),q$a.length=q$_.length;var q$k,q$z=0;for(q$k=q$a.length,q$z=0;q$z<q$k;q$z+=2)q$a[q$z]=q$_[q$z]*q$J+q$R,q$a[q$z+1]=q$_[q$z+1]*q$W+q$V;return q$a},q$S}(),q$u=function(){function q$S(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return q$R(q$S,"laya.ani.KeyFramesContent"),q$S}(),q$N=function(){function q$H(){}return q$R(q$H,"laya.ani.math.BezierLerp"),q$H.getBezierRate=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$H._getBezierParamKey(q$_,q$a,q$R,q$J),q$W=100*q$V+q$S;if(q$H._bezierResultCache[q$W])return q$H._bezierResultCache[q$W];var q$k,q$z=q$H._getBezierPoints(q$_,q$a,q$R,q$J,q$V),q$b=0;for(q$k=q$z.length,q$b=0;q$b<q$k;q$b+=2)if(q$S<=q$z[q$b])return q$H._bezierResultCache[q$W]=q$z[q$b+1],q$z[q$b+1];return q$H._bezierResultCache[q$W]=1},q$H._getBezierParamKey=function(q$S,q$_,q$a,q$R){return 100*(100*(100*(100*q$S+q$_)+q$a)+q$R)},q$H._getBezierPoints=function(q$S,q$_,q$a,q$R,q$J){return q$H._bezierPointsCache[q$J]?q$H._bezierPointsCache[q$J]:(q$V=[0,0,q$S,q$_,q$a,q$R,1,1],q$W=(new q$k).getBezierPoints(q$V,100,3),q$H._bezierPointsCache[q$J]=q$W);var q$V,q$W},q$H._bezierResultCache={},q$H._bezierPointsCache={},q$H}(),q$n=function(q$S){function q$_(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,q$_.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}q$R(q$_,"laya.ani.AnimationPlayer",q$J);var q$a=q$_.prototype;return q$JS.imps(q$a,{"laya.resource.IDestroy":!0}),q$a._onTempletLoadedComputeFullKeyframeIndices=function(q$S,q$_,q$a){this._templet===q$a&&this._cachePlayRate===q$S&&this._cacheFrameRate===q$_&&this._computeFullKeyframeIndices()},q$a._computeFullKeyframeIndices=function(){for(var q$S=this._fullFrames=[],q$_=this._templet,q$a=this._cacheFrameRateInterval*this._cachePlayRate,q$R=0,q$J=q$_.getAnimationCount();q$R<q$J;q$R++){for(var q$V=[],q$W=0,q$k=q$_.getAnimation(q$R).nodes.length;q$W<q$k;q$W++){for(var q$z=q$_.getAnimation(q$R).nodes[q$W],q$b=Math.floor(q$z.playTime/q$a+.01),q$H=new Uint16Array(q$b+1),q$L=-1,q$C=0,q$G=q$z.keyFrame.length;q$C<q$G;q$C++){var q$t=q$z.keyFrame[q$C],q$o=q$t.startTime,q$$=q$o+q$t.duration+q$a;do{for(var q$F=Math.floor(q$o/q$a+.5),q$T=q$L+1;q$T<q$F;q$T++)q$H[q$T]=q$C;q$H[q$L=q$F]=q$C,q$o+=q$a}while(q$o<=q$$)}q$V.push(q$H)}q$S.push(q$V)}},q$a._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},q$a._calculatePlayDuration=function(){if(0!==this.state){var q$S=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=q$S),this._playEnd>q$S&&(this._playEnd=q$S),this._playDuration=this._playEnd-this._playStart}},q$a._setPlayParams=function(q$S,q$_){this._currentTime=q$S,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/q$_+.01),0),this._currentFrameTime=this._currentKeyframeIndex*q$_},q$a._setPlayParamsWhenStop=function(q$S,q$_){this._currentTime=q$S,this._currentKeyframeIndex=Math.max(Math.floor(q$S/q$_+.01),0),this._currentFrameTime=this._currentKeyframeIndex*q$_,this._currentAnimationClipIndex=-1},q$a._update=function(q$S){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var q$_=this._cacheFrameRateInterval*this._cachePlayRate,q$a=0;this._startUpdateLoopCount!==q$t.loopCount&&(q$a=q$S*this.playbackRate,this._elapsedPlaybackTime+=q$a);var q$R=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=q$R)return this._setPlayParamsWhenStop(q$R,q$_),void this.event("stopped");if(q$a+=this._currentTime,0<q$R)if(q$R<=q$a)do{if(q$a-=q$R,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(q$R,q$_),this._stopWhenCircleFinish=!1,void this.event("stopped");q$a<q$R&&(this._setPlayParams(q$a,q$_),this.event("complete"))}while(q$R<=q$a);else this._setPlayParams(q$a,q$_);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(q$R,q$_),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},q$a._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},q$a.play=function(q$S,q$_,q$a,q$R,q$J){if(void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=1),void 0===q$a&&(q$a=2147483647),void 0===q$R&&(q$R=0),void 0===q$J&&(q$J=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(q$a<0||q$R<0||q$J<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==q$J&&q$J<q$R)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=q$_,this._overallDuration=q$a,this._playStart=q$R,this._playEnd=q$J,this._paused=!1,this._currentAnimationClipIndex=q$S,this._currentKeyframeIndex=0,this._startUpdateLoopCount=q$t.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},q$a.playByFrame=function(q$S,q$_,q$a,q$R,q$J,q$V){void 0===q$S&&(q$S=0),void 0===q$_&&(q$_=1),void 0===q$a&&(q$a=2147483647),void 0===q$R&&(q$R=0),void 0===q$J&&(q$J=0),void 0===q$V&&(q$V=30);var q$W=1e3/q$V;this.play(q$S,q$_,q$a,q$R*q$W,q$J*q$W)},q$a.stop=function(q$S){void 0===q$S&&(q$S=!0),q$S?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},q$V(0,q$a,"playEnd",function(){return this._playEnd}),q$V(0,q$a,"templet",function(){return this._templet},function(q$S){0===!this.state&&this.stop(!0),this._templet!==q$S&&((this._templet=q$S).loaded?this._computeFullKeyframeIndices():q$S.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),q$V(0,q$a,"playStart",function(){return this._playStart}),q$V(0,q$a,"playDuration",function(){return this._playDuration}),q$V(0,q$a,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),q$V(0,q$a,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),q$V(0,q$a,"overallDuration",function(){return this._overallDuration}),q$V(0,q$a,"currentFrameTime",function(){return this._currentFrameTime}),q$V(0,q$a,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),q$V(0,q$a,"currentPlayTime",function(){return this._currentTime+this._playStart}),q$V(0,q$a,"cachePlayRate",function(){return this._cachePlayRate},function(q$S){this._cachePlayRate!==q$S&&(this._cachePlayRate=q$S,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[q$S,this._cacheFrameRate])))}),q$V(0,q$a,"cacheFrameRate",function(){return this._cacheFrameRate},function(q$S){this._cacheFrameRate!==q$S&&(this._cacheFrameRate=q$S,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,q$S])))}),q$V(0,q$a,"currentTime",null,function(q$S){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(q$S<this._playStart||q$S>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=q$t.loopCount;var q$_=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=q$S,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/q$_),0),this._currentFrameTime=this._currentKeyframeIndex*q$_}}),q$V(0,q$a,"paused",function(){return this._paused},function(q$S){(this._paused=q$S)&&this.event("paused")}),q$V(0,q$a,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),q$V(0,q$a,"destroyed",function(){return this._destroyed}),q$_}(),q$K=function(q$S){function q$_(){q$_.__super.call(this),q$$.isConchNode&&(this.drawSkin=function(q$S){q$S.transform||(q$S.transform=q$XS.EMPTY),this._addCmd([q$S]),this.setSkinMesh&&this.setSkinMesh(q$S._ps,q$S.mVBData,q$S.mEleNum,0,q$S.mTexture,q$S.transform)})}return q$R(q$_,"laya.ani.GraphicsAni",q$W),q$_.prototype.drawSkin=function(q$S){var q$_=[q$S];this._saveToCmd(q$$._context._drawSkin,q$_)},q$_.create=function(){return q$_._caches.pop()||new q$_},q$_.recycle=function(q$S){q$S.clear(),q$_._caches.push(q$S)},q$_._caches=[],q$_}(),q$P=function(q$S){function q$T(){this._aniMap={},this.unfixedLastAniIndex=-1,q$T.__super.call(this),this._anis=new Array}q$R(q$T,"laya.ani.AnimationTemplet",q$H);var q$_=q$T.prototype;return q$_.parse=function(q$S){var q$_=new q$AS(q$S);this._aniVersion=q$_.readUTFString(),q$D.parse(this,q$_)},q$_._calculateKeyFrame=function(q$S,q$_,q$a){var q$R=q$S.keyFrame;q$R[q$_]=q$R[0];for(var q$J=0;q$J<q$_;q$J++){var q$V=q$R[q$J];q$V.nextData=0===q$V.duration?q$V.data:q$R[q$J+1].data}q$R.length--},q$_.onAsynLoaded=function(q$S,q$_,q$a){var q$R=new q$AS(q$_);switch(this._aniVersion=q$R.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":q$j.parse(this,q$R);break;default:q$D.parse(this,q$R)}this._endLoaded()},q$_.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},q$_.getAnimationCount=function(){return this._anis.length},q$_.getAnimation=function(q$S){return this._anis[q$S]},q$_.getAniDuration=function(q$S){return this._anis[q$S].playTime},q$_.getNodes=function(q$S){return this._anis[q$S].nodes},q$_.getNodeIndexWithName=function(q$S,q$_){return this._anis[q$S].bone3DMap[q$_]},q$_.getNodeCount=function(q$S){return this._anis[q$S].nodes.length},q$_.getTotalkeyframesLength=function(q$S){return this._anis[q$S].totalKeyframeDatasLength},q$_.getPublicExtData=function(){return this._publicExtData},q$_.getAnimationDataWithCache=function(q$S,q$_,q$a,q$R){var q$J=q$_[q$a];if(q$J){var q$V=q$J[q$S];return q$V?q$V[q$R]:null}return null},q$_.setAnimationDataWithCache=function(q$S,q$_,q$a,q$R,q$J){var q$V=q$_[q$a]||(q$_[q$a]={});(q$V[q$S]||(q$V[q$S]=[]))[q$R]=q$J},q$_.getOriginalData=function(q$S,q$_,q$a,q$R,q$J){for(var q$V=this._anis[q$S].nodes,q$W=0,q$k=0,q$z=q$V.length,q$b=0;q$k<q$z;q$k++){var q$H,q$L=q$V[q$k];q$H=q$L.keyFrame[q$a[q$k][q$R]],q$L.dataOffset=q$b;var q$C=q$J-q$H.startTime,q$G=q$L.lerpType;if(q$G)switch(q$G){case 0:case 1:for(q$W=0;q$W<q$L.keyframeWidth;)q$W+=q$L.interpolationMethod[q$W](q$L,q$W,q$_,q$b+q$W,q$H.data,q$C,null,q$H.duration,q$H.nextData);break;case 2:var q$t=q$H.interpolationData,q$o=q$t.length,q$$=0;for(q$W=0;q$W<q$o;){var q$F=q$t[q$W];switch(q$F){case 6:case 7:q$W+=q$T.interpolation[q$F](q$L,q$$,q$_,q$b+q$$,q$H.data,q$C,null,q$H.duration,q$H.nextData,q$t,q$W+1);break;default:q$W+=q$T.interpolation[q$F](q$L,q$$,q$_,q$b+q$$,q$H.data,q$C,null,q$H.duration,q$H.nextData)}q$$++}}else for(q$W=0;q$W<q$L.keyframeWidth;)q$W+=q$L.interpolationMethod[q$W](q$L,q$W,q$_,q$b+q$W,q$H.data,q$C,null,q$H.duration,q$H.nextData);q$b+=q$L.keyframeWidth}},q$_.getNodesCurrentFrameIndex=function(q$S,q$_){var q$a=this._anis[q$S].nodes;q$S!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(q$a.length),this.unfixedCurrentTimes=new Float32Array(q$a.length),this.unfixedLastAniIndex=q$S);for(var q$R=0,q$J=q$a.length;q$R<q$J;q$R++){var q$V=q$a[q$R];for(q$_<this.unfixedCurrentTimes[q$R]&&(this.unfixedCurrentFrameIndexes[q$R]=0),this.unfixedCurrentTimes[q$R]=q$_;this.unfixedCurrentFrameIndexes[q$R]<q$V.keyFrame.length&&!(q$V.keyFrame[this.unfixedCurrentFrameIndexes[q$R]].startTime>this.unfixedCurrentTimes[q$R]);)this.unfixedCurrentFrameIndexes[q$R]++;this.unfixedCurrentFrameIndexes[q$R]--}return this.unfixedCurrentFrameIndexes},q$_.getOriginalDataUnfixedRate=function(q$S,q$_,q$a){var q$R=this._anis[q$S].nodes;q$S!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(q$R.length),this.unfixedCurrentTimes=new Float32Array(q$R.length),this.unfixedKeyframes=q$o(q$R.length),this.unfixedLastAniIndex=q$S);for(var q$J=0,q$V=0,q$W=q$R.length,q$k=0;q$V<q$W;q$V++){var q$z=q$R[q$V];for(q$a<this.unfixedCurrentTimes[q$V]&&(this.unfixedCurrentFrameIndexes[q$V]=0),this.unfixedCurrentTimes[q$V]=q$a;this.unfixedCurrentFrameIndexes[q$V]<q$z.keyFrame.length&&!(q$z.keyFrame[this.unfixedCurrentFrameIndexes[q$V]].startTime>this.unfixedCurrentTimes[q$V]);)this.unfixedKeyframes[q$V]=q$z.keyFrame[this.unfixedCurrentFrameIndexes[q$V]],this.unfixedCurrentFrameIndexes[q$V]++;var q$b=this.unfixedKeyframes[q$V];q$z.dataOffset=q$k;var q$H=q$a-q$b.startTime;if(q$z.lerpType)switch(q$z.lerpType){case 0:case 1:for(q$J=0;q$J<q$z.keyframeWidth;)q$J+=q$z.interpolationMethod[q$J](q$z,q$J,q$_,q$k+q$J,q$b.data,q$H,null,q$b.duration,q$b.nextData);break;case 2:var q$L=q$b.interpolationData,q$C=q$L.length,q$G=0;for(q$J=0;q$J<q$C;){var q$t=q$L[q$J];switch(q$t){case 6:case 7:q$J+=q$T.interpolation[q$t](q$z,q$G,q$_,q$k+q$G,q$b.data,q$H,null,q$b.duration,q$b.nextData,q$L,q$J+1);break;default:q$J+=q$T.interpolation[q$t](q$z,q$G,q$_,q$k+q$G,q$b.data,q$H,null,q$b.duration,q$b.nextData)}q$G++}}else for(q$J=0;q$J<q$z.keyframeWidth;)q$J+=q$z.interpolationMethod[q$J](q$z,q$J,q$_,q$k+q$J,q$b.data,q$H,null,q$b.duration,q$b.nextData);q$k+=q$z.keyframeWidth}},q$T._LinearInterpolation_0=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){var q$H=0===q$k?0:q$V/q$k;return q$a[q$R]=(1-q$H)*q$J[q$_]+q$H*q$z[q$_],1},q$T._QuaternionInterpolation_1=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){var q$H=0===q$k?0:q$V/q$k;return q$C.slerpQuaternionArray(q$J,q$_,q$z,q$_,q$H,q$a,q$R),4},q$T._AngleInterpolation_2=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){return 0},q$T._RadiansInterpolation_3=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){return 0},q$T._Matrix4x4Interpolation_4=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){for(var q$H=0;q$H<16;q$H++,q$_++)q$a[q$R+q$H]=q$J[q$_]+q$V*q$W[q$_];return 16},q$T._NoInterpolation_5=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b){return q$a[q$R]=q$J[q$_],1},q$T._BezierInterpolation_6=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H){return void 0===q$H&&(q$H=0),q$a[q$R]=q$J[q$_]+(q$z[q$_]-q$J[q$_])*q$N.getBezierRate(q$V/q$k,q$b[q$H],q$b[q$H+1],q$b[q$H+2],q$b[q$H+3]),5},q$T._BezierInterpolation_7=function(q$S,q$_,q$a,q$R,q$J,q$V,q$W,q$k,q$z,q$b,q$H){return void 0===q$H&&(q$H=0),q$a[q$R]=q$b[q$H+4]+q$b[q$H+5]*q$N.getBezierRate((.001*q$V+q$b[q$H+6])/q$b[q$H+7],q$b[q$H],q$b[q$H+1],q$b[q$H+2],q$b[q$H+3]),9},q$T.load=function(q$S){return q$JS.loader.create(q$S,null,null,q$T)},q$T.interpolation=[q$T._LinearInterpolation_0,q$T._QuaternionInterpolation_1,q$T._AngleInterpolation_2,q$T._RadiansInterpolation_3,q$T._Matrix4x4Interpolation_4,q$T._NoInterpolation_5,q$T._BezierInterpolation_6,q$T._BezierInterpolation_7],q$T}(),q$l=function(q$_){function q$a(q$S,q$_){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,q$a.__super.call(this),void 0===q$_&&(q$_=0),q$S&&this.init(q$S,q$_)}q$R(q$a,"laya.ani.bone.Skeleton",q$_);var q$S=q$a.prototype;return q$S.init=function(q$S,q$_){void 0===q$_&&(q$_=0);var q$a,q$R,q$J,q$V=0,q$W=0;if(1==q$_)for(this._graphicsCache=[],q$V=0,q$W=q$S.getAnimationCount();q$V<q$W;q$V++)this._graphicsCache.push([]);if(this._yReverseMatrix=q$S.yReverseMatrix,this._aniMode=q$_,this._templet=q$S,this._player=new q$n,this._player.cacheFrameRate=q$S.rate,this._player.templet=q$S,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=q$S.mBoneArr,this._rootBone=q$S.mRootBone,this._aniSectionDic=q$S.aniSectionDic,0<q$S.ikArr.length)for(this._ikArr=[],q$V=0,q$W=q$S.ikArr.length;q$V<q$W;q$V++)this._ikArr.push(new q$T(q$S.ikArr[q$V],this._boneList));if(0<q$S.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),q$V=0,q$W=q$S.pathArr.length;q$V<q$W;q$V++)q$a=q$S.pathArr[q$V],q$R=new q$Q(q$a,this._boneList),(q$J=this._boneSlotDic[q$a.name])&&((q$R=new q$Q(q$a,this._boneList)).target=q$J),this._pathDic[q$a.name]=q$R;if(0<q$S.tfArr.length)for(this._tfArr=[],q$V=0,q$W=q$S.tfArr.length;q$V<q$W;q$V++)this._tfArr.push(new q$m(q$S.tfArr[q$V],this._boneList));if(0<q$S.skinDataArray.length){var q$k=this._templet.skinDataArray[this._skinIndex];this._skinName=q$k.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},q$S.load=function(q$S,q$_,q$a){},q$S._onLoaded=function(){},q$S._parseComplete=function(){var q$S=q$B.TEMPLET_DICTIONARY[this._aniPath];q$S&&(this.init(q$S,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},q$S._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},q$S._onPlay=function(){this.event("played")},q$S._onStop=function(){var q$S,q$_=this._templet.eventAniArr[this._aniClipIndex];if(q$_&&this._eventIndex<q$_.length)for(;this._eventIndex<q$_.length;this._eventIndex++)(q$S=q$_[this._eventIndex]).time>=this._player.playStart&&q$S.time<=this._player.playEnd&&this.event("label",q$S);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},q$S._onPause=function(){this.event("paused")},q$S._parseSrcBoneMatrix=function(){var q$S=0,q$_=0;for(q$_=this._templet.srcBoneMatrixArr.length,q$S=0;q$S<q$_;q$S++)this._boneMatrixArray.push(new q$XS);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var q$a,q$R,q$J=this._templet.boneSlotArray;for(q$S=0,q$_=q$J.length;q$S<q$_;q$S++)q$a=q$J[q$S],null==(q$R=this._bindBoneBoneSlotDic[q$a.parent])&&(this._bindBoneBoneSlotDic[q$a.parent]=q$R=[]),this._boneSlotDic[q$a.name]=q$a=q$a.copy(),q$R.push(q$a),this._boneSlotArray.push(q$a)}},q$S._emitMissedEvents=function(q$S,q$_,q$a){void 0===q$a&&(q$a=0);var q$R=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(q$R){var q$J,q$V,q$W=0;for(q$J=q$R.length,q$W=q$a;q$W<q$J;q$W++)(q$V=q$R[q$W]).time>=this._player.playStart&&q$V.time<=this._player.playEnd&&this.event("label",q$V)}},q$S._update=function(q$S){if(void 0===q$S&&(q$S=!0),!(this._pause||q$S&&this._indexControl)){var q$_=this.timer.currTimer,q$a=this._player.currentKeyframeIndex,q$R=q$_-this._lastTime;if(q$S?this._player._update(q$R):q$a=-1,this._lastTime=q$_,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<q$R&&this._clipIndex==q$a&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var q$J;this._lastUpdateAniClipIndex=this._aniClipIndex,q$a>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var q$V,q$W=this._templet.eventAniArr[this._aniClipIndex];if(q$W&&this._eventIndex<q$W.length&&((q$J=q$W[this._eventIndex]).time>=this._player.playStart&&q$J.time<=this._player.playEnd?this._player.currentPlayTime>=q$J.time&&(this.event("label",q$J),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(q$V=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=q$V&&(this.graphics=q$V));var q$k=0,q$z=0;for(q$z=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,q$z-1)&&0<q$z;)q$z--;if(q$z<this._clipIndex)for(q$k=q$z;q$k<this._clipIndex;q$k++)this._createGraphics(q$k)}else if(1==this._aniMode){if(q$V=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=q$V&&(this.graphics=q$V));for(q$z=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,q$z-1)&&0<q$z;)q$z--;if(q$z<this._clipIndex)for(q$k=q$z;q$k<this._clipIndex;q$k++)this._createGraphics(q$k)}this._createGraphics()}}},q$S._createGraphics=function(q$S){void 0===q$S&&(q$S=-1),-1==q$S&&(q$S=this._clipIndex);var q$_,q$a,q$R=q$S*this._player.cacheFrameRateInterval,q$J=this._templet.drawOrderAniArr[this._aniClipIndex];if(q$J&&0<q$J.length)for(this._drawOrderIndex=0,q$_=q$J[this._drawOrderIndex];q$R>=q$_.time&&(this._drawOrder=q$_.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=q$J.length));)q$_=q$J[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=q$K.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=q$K.create(),q$a=this.graphics;var q$V=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],q$S,q$R);var q$W,q$k,q$z,q$b,q$H=this._aniSectionDic[this._aniClipIndex],q$L=0,q$C=0,q$G=0,q$t=0,q$o=0,q$$=this._templet.srcBoneMatrixArr.length;for(q$o=q$H[q$C=0];q$C<q$$;q$C++)q$b=this._boneList[q$C],q$z=this._templet.srcBoneMatrixArr[q$C],q$b.resultTransform.scX=q$z.scX*this._curOriginalData[q$L++],q$b.resultTransform.skX=q$z.skX+this._curOriginalData[q$L++],q$b.resultTransform.skY=q$z.skY+this._curOriginalData[q$L++],q$b.resultTransform.scY=q$z.scY*this._curOriginalData[q$L++],q$b.resultTransform.x=q$z.x+this._curOriginalData[q$L++],q$b.resultTransform.y=q$z.y+this._curOriginalData[q$L++],8===this._templet.tMatrixDataLen&&(q$b.resultTransform.skewX=q$z.skewX+this._curOriginalData[q$L++],q$b.resultTransform.skewY=q$z.skewY+this._curOriginalData[q$L++]);var q$F,q$T={},q$D={};for(q$o+=q$H[1];q$C<q$o;q$C++)q$T[(q$F=q$V[q$C]).name]=this._curOriginalData[q$L++],q$D[q$F.name]=this._curOriginalData[q$L++],this._curOriginalData[q$L++],this._curOriginalData[q$L++],this._curOriginalData[q$L++],this._curOriginalData[q$L++];var q$j,q$Q,q$m={},q$q={};for(q$o+=q$H[2];q$C<q$o;q$C++)q$m[(q$F=q$V[q$C]).name]=this._curOriginalData[q$L++],q$q[q$F.name]=this._curOriginalData[q$L++],this._curOriginalData[q$L++],this._curOriginalData[q$L++],this._curOriginalData[q$L++],this._curOriginalData[q$L++];if(this._pathDic)for(q$o+=q$H[3];q$C<q$o;q$C++){if(q$F=q$V[q$C],q$j=this._pathDic[q$F.name])switch(new q$AS(q$F.extenData).getByte()){case 1:q$j.position=this._curOriginalData[q$L++];break;case 2:q$j.spacing=this._curOriginalData[q$L++];break;case 3:q$j.rotateMix=this._curOriginalData[q$L++],q$j.translateMix=this._curOriginalData[q$L++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(q$XS.TEMP.identity()),this._ikArr)for(q$C=0,q$o=this._ikArr.length;q$C<q$o;q$C++)q$Q=this._ikArr[q$C],q$m.hasOwnProperty(q$Q.name)&&(q$Q.bendDirection=q$m[q$Q.name]),q$q.hasOwnProperty(q$Q.name)&&(q$Q.mix=q$q[q$Q.name]),q$Q.apply();if(this._pathDic)for(var q$N in this._pathDic)(q$j=this._pathDic[q$N]).apply(this._boneList,q$a);if(this._tfArr)for(q$C=0,q$t=this._tfArr.length;q$C<q$t;q$C++)this._tfArr[q$C].apply();for(q$C=0,q$t=this._boneList.length;q$C<q$t;q$C++)if(q$b=this._boneList[q$C],q$k=this._bindBoneBoneSlotDic[q$b.name],q$b.resultMatrix.copyTo(this._boneMatrixArray[q$C]),q$k)for(q$G=0,q$o=q$k.length;q$G<q$o;q$G++)(q$W=q$k[q$G])&&q$W.setParentMatrix(q$b.resultMatrix);var q$n,q$l,q$B,q$I,q$A={},q$X=this._templet.deformAniArr;if(q$X&&0<q$X.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,q$C=0,q$o=this._boneSlotArray.length;q$C<q$o;q$C++)(q$W=this._boneSlotArray[q$C]).deformData=null;var q$h,q$u=q$X[this._aniClipIndex];for(q$h in q$n=q$u.default,this._setDeform(q$n,q$A,this._boneSlotArray,q$R),q$u)"default"!=q$h&&q$h!=this._skinName&&(q$n=q$u[q$h],this._setDeform(q$n,q$A,this._boneSlotArray,q$R));q$n=q$u[this._skinName],this._setDeform(q$n,q$A,this._boneSlotArray,q$R)}if(this._drawOrder)for(q$C=0,q$o=this._drawOrder.length;q$C<q$o;q$C++)q$l=q$T[(q$W=this._boneSlotArray[this._drawOrder[q$C]]).name],q$B=q$D[q$W.name],isNaN(q$B)||(q$a.save(),q$a.alpha(q$B)),isNaN(q$l)||-2==q$l||(this._templet.attachmentNames?q$W.showDisplayByName(this._templet.attachmentNames[q$l]):q$W.showDisplayByIndex(q$l)),q$A[this._drawOrder[q$C]]?(q$I=q$A[this._drawOrder[q$C]],q$W.currDisplayData&&q$I[q$W.currDisplayData.attachmentName]?q$W.deformData=q$I[q$W.currDisplayData.attachmentName]:q$W.deformData=null):q$W.deformData=null,isNaN(q$B)?q$W.draw(q$a,this._boneMatrixArray,2==this._aniMode):q$W.draw(q$a,this._boneMatrixArray,2==this._aniMode,q$B),isNaN(q$B)||q$a.restore();else for(q$C=0,q$o=this._boneSlotArray.length;q$C<q$o;q$C++)q$l=q$T[(q$W=this._boneSlotArray[q$C]).name],q$B=q$D[q$W.name],isNaN(q$B)||(q$a.save(),q$a.alpha(q$B)),isNaN(q$l)||-2==q$l||(this._templet.attachmentNames?q$W.showDisplayByName(this._templet.attachmentNames[q$l]):q$W.showDisplayByIndex(q$l)),q$A[q$C]?(q$I=q$A[q$C],q$W.currDisplayData&&q$I[q$W.currDisplayData.attachmentName]?q$W.deformData=q$I[q$W.currDisplayData.attachmentName]:q$W.deformData=null):q$W.deformData=null,isNaN(q$B)?q$W.draw(q$a,this._boneMatrixArray,2==this._aniMode):q$W.draw(q$a,this._boneMatrixArray,2==this._aniMode,q$B),isNaN(q$B)||q$a.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,q$S,q$a):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,q$S,q$a)},q$S._setDeform=function(q$S,q$_,q$a,q$R){if(q$S){var q$J,q$V,q$W,q$k=0,q$z=0,q$b=0;if(q$S)for(q$k=0,q$z=q$S.deformSlotDataList.length;q$k<q$z;q$k++)for(q$J=q$S.deformSlotDataList[q$k],q$b=0;q$b<q$J.deformSlotDisplayList.length;q$b++)q$W=q$a[(q$V=q$J.deformSlotDisplayList[q$b]).slotIndex],q$V.apply(q$R,q$W),q$_[q$V.slotIndex]||(q$_[q$V.slotIndex]={}),q$_[q$V.slotIndex][q$V.attachment]=q$V.deformData}},q$S.getAnimNum=function(){return this._templet.getAnimationCount()},q$S.getAniNameByIndex=function(q$S){return this._templet.getAniNameByIndex(q$S)},q$S.getSlotByName=function(q$S){return this._boneSlotDic[q$S]},q$S.showSkinByName=function(q$S,q$_){void 0===q$_&&(q$_=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(q$S),q$_)},q$S.showSkinByIndex=function(q$S,q$_){void 0===q$_&&(q$_=!0);for(var q$a=0;q$a<this._boneSlotArray.length;q$a++)this._boneSlotArray[q$a].showSlotData(null,q$_);if(this._templet.showSkinByIndex(this._boneSlotDic,q$S,q$_)){var q$R=this._templet.skinDataArray[q$S];this._skinIndex=q$S,this._skinName=q$R.name}this._clearCache()},q$S.showSlotSkinByIndex=function(q$S,q$_){if(0!=this._aniMode){var q$a=this.getSlotByName(q$S);q$a&&q$a.showDisplayByIndex(q$_),this._clearCache()}},q$S.showSlotSkinByName=function(q$S,q$_){if(0!=this._aniMode){var q$a=this.getSlotByName(q$S);q$a&&q$a.showDisplayByName(q$_),this._clearCache()}},q$S.replaceSlotSkinName=function(q$S,q$_,q$a){if(0!=this._aniMode){var q$R=this.getSlotByName(q$S);q$R&&q$R.replaceDisplayByName(q$_,q$a),this._clearCache()}},q$S.replaceSlotSkinByIndex=function(q$S,q$_,q$a){if(0!=this._aniMode){var q$R=this.getSlotByName(q$S);q$R&&q$R.replaceDisplayByIndex(q$_,q$a),this._clearCache()}},q$S.setSlotSkin=function(q$S,q$_){if(0!=this._aniMode){var q$a=this.getSlotByName(q$S);q$a&&q$a.replaceSkin(q$_),this._clearCache()}},q$S._clearCache=function(){if(1==this._aniMode)for(var q$S=0,q$_=this._graphicsCache.length;q$S<q$_;q$S++){for(var q$a=0,q$R=this._graphicsCache[q$S].length;q$a<q$R;q$a++){var q$J=this._graphicsCache[q$S][q$a];q$J!=this.graphics&&q$K.recycle(q$J)}this._graphicsCache[q$S].length=0}},q$S.play=function(q$S,q$_,q$a,q$R,q$J,q$V){void 0===q$a&&(q$a=!0),void 0===q$R&&(q$R=0),void 0===q$J&&(q$J=0),void 0===q$V&&(q$V=!0),this._indexControl=!1;var q$W=-1,q$k=NaN;if(q$k=q$_?2147483647:0,"string"==typeof q$S)for(var q$z=0,q$b=this._templet.getAnimationCount();q$z<q$b;q$z++){var q$H=this._templet.getAnimation(q$z);if(q$H&&q$S==q$H.name){q$W=q$z;break}}else q$W=q$S;-1<q$W&&q$W<this.getAnimNum()&&(this._aniClipIndex=q$W,(q$a||this._pause||this._currAniIndex!=q$W)&&(this._currAniIndex=q$W,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(q$W)),this._drawOrder=null,this._eventIndex=0,this._player.play(q$W,this._player.playbackRate,q$k,q$R,q$J),q$V&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=q$L.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},q$S.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},q$S.playbackRate=function(q$S){this._player&&(this._player.playbackRate=q$S)},q$S.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},q$S.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=q$L.now(),this.timer.frameLoop(1,this,this._update,null,!0))},q$S._getGrahicsDataWithCache=function(q$S,q$_){return this._graphicsCache[q$S][q$_]},q$S._setGrahicsDataWithCache=function(q$S,q$_,q$a){this._graphicsCache[q$S][q$_]=q$a},q$S.destroy=function(q$S){void 0===q$S&&(q$S=!0),q$_.prototype.destroy.call(this,q$S),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},q$V(0,q$S,"url",function(){return this._aniPath},function(q$S){this.load(q$S)}),q$V(0,q$S,"index",function(){return this._index},function(q$S){this.player&&(this._index=q$S,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),q$V(0,q$S,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),q$V(0,q$S,"templet",function(){return this._templet}),q$V(0,q$S,"player",function(){return this._player}),q$a.useSimpleMeshInCanvas=!1,q$a}(q$VS),q$B=function(q$_){function q$J(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,q$J.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}q$R(q$J,"laya.ani.bone.Templet",q$_);var q$S=q$J.prototype;return q$S.getLoadList=function(){return this._loadList},q$S.loadAni=function(q$S){this._skBufferUrl=q$S,q$JS.loader.load(q$S,q$z.create(this,this.onComplete),null,"arraybuffer")},q$S.onComplete=function(q$S){if(this._isDestroyed)this.destroy();else{var q$_=q$b.getRes(this._skBufferUrl);q$_?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,q$_)):this.event("error","load failed:"+this._skBufferUrl)}},q$S.parseData=function(q$S,q$_,q$a){void 0===q$a&&(q$a=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=q$S,this._mainTexture&&q$$.isWebGL&&q$S.bitmap&&(q$S.bitmap.enableMerageInAtlas=!1),this._rate=q$a,this.parse(q$_)},q$S.buildArmature=function(q$S){return void 0===q$S&&(q$S=0),new q$l(this,q$S)},q$S.parse=function(q$S){q$_.prototype.parse.call(this,q$S),this._endLoaded(),this._aniVersion!=q$J.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+q$J.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},q$S._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var q$S=0;this._loadList=[];var q$_,q$a=new q$AS(this.getPublicExtData()),q$R=0,q$J=0,q$V=0,q$W=q$a.getInt32(),q$k=q$a.readUTFString(),q$z=q$k.split("\n");for(q$S=0;q$S<q$W;q$S++)q$_=this._path+q$z[2*q$S],q$k=q$z[2*q$S+1],q$a.getFloat32(),q$a.getFloat32(),q$R=q$a.getFloat32(),q$J=q$a.getFloat32(),q$V=q$a.getFloat32(),isNaN(q$V)?0:q$V,q$V=q$a.getFloat32(),isNaN(q$V)?0:q$V,q$V=q$a.getFloat32(),isNaN(q$V)?q$R:q$V,q$V=q$a.getFloat32(),isNaN(q$V)?q$J:q$V,-1==this._loadList.indexOf(q$_)&&this._loadList.push(q$_);this.event("inited",this)}},q$S._textureComplete=function(){for(var q$S,q$_,q$a=0,q$R=this._loadList.length;q$a<q$R;q$a++)q$_=this._loadList[q$a],q$S=this._textureDic[q$_]=q$b.getRes(q$_),q$$.isWebGL&&q$S&&q$S.bitmap&&(q$S.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},q$S._parsePublicExtData=function(){var q$S=0,q$_=0,q$a=0,q$R=0,q$J=0;for(q$S=0,q$J=this.getAnimationCount();q$S<q$J;q$S++)this._graphicsCache.push([]);var q$V;q$V="Dragon"!=this._aniClassName;var q$W,q$k,q$z=new q$AS(this.getPublicExtData()),q$b=0,q$H=0,q$L=0,q$C=0,q$G=0,q$t=0,q$o=0,q$$=0,q$F=0,q$T=q$z.getInt32(),q$D=q$z.readUTFString(),q$j=q$D.split("\n");for(q$S=0;q$S<q$T;q$S++){if(q$W=this._mainTexture,q$k=this._path+q$j[2*q$S],q$D=q$j[2*q$S+1],null==this._mainTexture&&(q$W=this._textureDic[q$k]),!q$W)return this.event("error",this),void(this.isParseFail=!0);q$b=q$z.getFloat32(),q$H=q$z.getFloat32(),q$L=q$z.getFloat32(),q$C=q$z.getFloat32(),q$F=q$z.getFloat32(),q$G=isNaN(q$F)?0:q$F,q$F=q$z.getFloat32(),q$t=isNaN(q$F)?0:q$F,q$F=q$z.getFloat32(),q$o=isNaN(q$F)?q$L:q$F,q$F=q$z.getFloat32(),q$$=isNaN(q$F)?q$C:q$F,this.subTextureDic[q$D]=q$hS.create(q$W,q$b,q$H,q$L,q$C,-q$G,-q$t,q$o,q$$),q$W.alphaTexture&&(this.subTextureDic[q$D].alphaTexture=q$hS.create(q$W.alphaTexture,q$b,q$H,q$L,q$C,-q$G,-q$t,q$o,q$$))}this._mainTexture=q$W;var q$Q,q$m,q$q,q$N,q$n,q$l=q$z.getUint16();for(q$S=0;q$S<q$l;q$S++)(q$Q=[]).push(q$z.getUint16()),q$Q.push(q$z.getUint16()),q$Q.push(q$z.getUint16()),q$Q.push(q$z.getUint16()),this.aniSectionDic[q$S]=q$Q;var q$B,q$I=q$z.getInt16(),q$A={};for(q$S=0;q$S<q$I;q$S++)q$m=new q$uS,0==q$S?q$B=q$m:q$m.root=q$B,q$m.d=q$V?-1:1,q$N=q$z.readUTFString(),q$n=q$z.readUTFString(),q$m.length=q$z.getFloat32(),1==q$z.getByte()&&(q$m.inheritRotation=!1),1==q$z.getByte()&&(q$m.inheritScale=!1),q$m.name=q$N,q$n&&((q$q=q$A[q$n])?q$q.addChild(q$m):this.mRootBone=q$m),q$A[q$N]=q$m,this.mBoneArr.push(q$m);this.tMatrixDataLen=q$z.getUint16();var q$X,q$h,q$u=q$z.getUint16(),q$K=Math.floor(q$u/this.tMatrixDataLen),q$P=this.srcBoneMatrixArr;for(q$S=0;q$S<q$K;q$S++)(q$X=new q$ZS).scX=q$z.getFloat32(),q$X.skX=q$z.getFloat32(),q$X.skY=q$z.getFloat32(),q$X.scY=q$z.getFloat32(),q$X.x=q$z.getFloat32(),q$X.y=q$z.getFloat32(),8===this.tMatrixDataLen&&(q$X.skewX=q$z.getFloat32(),q$X.skewY=q$z.getFloat32()),q$P.push(q$X),(q$m=this.mBoneArr[q$S]).transform=q$X;var q$M,q$r=q$z.getUint16(),q$e=0;for(q$S=0;q$S<q$r;q$S++){for(q$h=new q$xS,q$e=q$z.getUint16(),q$_=0;q$_<q$e;q$_++)q$h.boneNames.push(q$z.readUTFString()),q$h.boneIndexs.push(q$z.getInt16());q$h.name=q$z.readUTFString(),q$h.targetBoneName=q$z.readUTFString(),q$h.targetBoneIndex=q$z.getInt16(),q$h.bendDirection=q$z.getFloat32(),q$h.mix=q$z.getFloat32(),q$h.isSpine=q$V,this.ikArr.push(q$h)}var q$g,q$x=q$z.getUint16(),q$s=0;for(q$S=0;q$S<q$x;q$S++){for(q$M=new q$iS,q$s=q$z.getUint16(),q$_=0;q$_<q$s;q$_++)q$M.boneIndexs.push(q$z.getInt16());q$M.name=q$z.getUTFString(),q$M.targetIndex=q$z.getInt16(),q$M.rotateMix=q$z.getFloat32(),q$M.translateMix=q$z.getFloat32(),q$M.scaleMix=q$z.getFloat32(),q$M.shearMix=q$z.getFloat32(),q$M.offsetRotation=q$z.getFloat32(),q$M.offsetX=q$z.getFloat32(),q$M.offsetY=q$z.getFloat32(),q$M.offsetScaleX=q$z.getFloat32(),q$M.offsetScaleY=q$z.getFloat32(),q$M.offsetShearY=q$z.getFloat32(),this.tfArr.push(q$M)}var q$U=q$z.getUint16(),q$f=0;for(q$S=0;q$S<q$U;q$S++){for((q$g=new q$sS).name=q$z.readUTFString(),q$f=q$z.getUint16(),q$_=0;q$_<q$f;q$_++)q$g.bones.push(q$z.getInt16());q$g.target=q$z.readUTFString(),q$g.positionMode=q$z.readUTFString(),q$g.spacingMode=q$z.readUTFString(),q$g.rotateMode=q$z.readUTFString(),q$g.offsetRotation=q$z.getFloat32(),q$g.position=q$z.getFloat32(),q$g.spacing=q$z.getFloat32(),q$g.rotateMix=q$z.getFloat32(),q$g.translateMix=q$z.getFloat32(),this.pathArr.push(q$g)}var q$Y,q$i,q$Z,q$p,q$c,q$y=0,q$E=0,q$O=0,q$w=NaN,q$v=0,q$d=q$z.getInt16();for(q$S=0;q$S<q$d;q$S++){var q$SS=q$z.getUint8(),q$_S={};this.deformAniArr.push(q$_S);for(var q$aS=0;q$aS<q$SS;q$aS++)for((q$Y=new q$PS).skinName=q$z.getUTFString(),q$_S[q$Y.skinName]=q$Y,q$y=q$z.getInt16(),q$_=0;q$_<q$y;q$_++)for(q$i=new q$MS,q$Y.deformSlotDataList.push(q$i),q$E=q$z.getInt16(),q$a=0;q$a<q$E;q$a++)for(q$Z=new q$rS,q$i.deformSlotDisplayList.push(q$Z),q$Z.slotIndex=q$z.getInt16(),q$Z.attachment=q$z.getUTFString(),q$O=q$z.getInt16(),q$R=0;q$R<q$O;q$R++)for(1==q$z.getByte()?q$Z.tweenKeyList.push(!0):q$Z.tweenKeyList.push(!1),q$w=q$z.getFloat32(),q$Z.timeList.push(q$w),q$p=[],q$Z.vectices.push(q$p),q$v=q$z.getInt16(),q$J=0;q$J<q$v;q$J++)q$p.push(q$z.getFloat32())}var q$RS,q$JS,q$VS=q$z.getInt16(),q$WS=0,q$kS=0;for(q$S=0;q$S<q$VS;q$S++){for(q$WS=q$z.getInt16(),q$c=[],q$_=0;q$_<q$WS;q$_++){for((q$RS=new q$eS).time=q$z.getFloat32(),q$kS=q$z.getInt16(),q$a=0;q$a<q$kS;q$a++)q$RS.drawOrder.push(q$z.getInt16());q$c.push(q$RS)}this.drawOrderAniArr.push(q$c)}var q$zS,q$bS=q$z.getInt16(),q$HS=0;for(q$S=0;q$S<q$bS;q$S++){for(q$HS=q$z.getInt16(),q$JS=[],q$_=0;q$_<q$HS;q$_++)(q$zS=new q$gS).name=q$z.getUTFString(),q$zS.intValue=q$z.getInt32(),q$zS.floatValue=q$z.getFloat32(),q$zS.stringValue=q$z.getUTFString(),q$zS.time=q$z.getFloat32(),q$JS.push(q$zS);this.eventAniArr.push(q$JS)}var q$LS=q$z.getInt16();if(0<q$LS)for(this.attachmentNames=[],q$S=0;q$S<q$LS;q$S++)this.attachmentNames.push(q$z.getUTFString());var q$CS,q$GS,q$tS=q$z.getInt16();for(q$S=0;q$S<q$tS;q$S++)(q$CS=new q$KS).name=q$z.readUTFString(),q$CS.parent=q$z.readUTFString(),q$CS.attachmentName=q$z.readUTFString(),q$CS.srcDisplayIndex=q$CS.displayIndex=q$z.getInt16(),(q$CS.templet=this).boneSlotDic[q$CS.name]=q$CS,null==(q$GS=this.bindBoneBoneSlotDic[q$CS.parent])&&(this.bindBoneBoneSlotDic[q$CS.parent]=q$GS=[]),q$GS.push(q$CS),this.boneSlotArray.push(q$CS);var q$oS,q$$S,q$FS,q$TS=q$z.readUTFString().split("\n"),q$DS=0,q$jS=q$z.getUint8(),q$QS=0,q$mS=0,q$qS=0,q$NS=0,q$nS=0,q$lS=0,q$BS=0;for(q$S=0;q$S<q$jS;q$S++){for((q$oS=new q$US).name=q$TS[q$DS++],q$QS=q$z.getUint8(),q$_=0;q$_<q$QS;q$_++){for((q$$S=new q$YS).name=q$TS[q$DS++],q$CS=this.boneSlotDic[q$$S.name],q$mS=q$z.getUint8(),q$a=0;q$a<q$mS;q$a++){if(q$FS=new q$fS,this.skinSlotDisplayDataArr.push(q$FS),q$FS.name=q$TS[q$DS++],q$FS.attachmentName=q$TS[q$DS++],q$FS.transform=new q$ZS,q$FS.transform.scX=q$z.getFloat32(),q$FS.transform.skX=q$z.getFloat32(),q$FS.transform.skY=q$z.getFloat32(),q$FS.transform.scY=q$z.getFloat32(),q$FS.transform.x=q$z.getFloat32(),q$FS.transform.y=q$z.getFloat32(),q$$S.displayArr.push(q$FS),q$FS.width=q$z.getFloat32(),q$FS.height=q$z.getFloat32(),q$FS.type=q$z.getUint8(),q$FS.verLen=q$z.getUint16(),0<(q$I=q$z.getUint16()))for(q$FS.bones=[],q$R=0;q$R<q$I;q$R++){var q$IS=q$z.getUint16();q$FS.bones.push(q$IS)}if(0<(q$qS=q$z.getUint16()))for(q$FS.uvs=[],q$R=0;q$R<q$qS;q$R++)q$FS.uvs.push(q$z.getFloat32());if(0<(q$NS=q$z.getUint16()))for(q$FS.weights=[],q$R=0;q$R<q$NS;q$R++)q$FS.weights.push(q$z.getFloat32());if(0<(q$nS=q$z.getUint16()))for(q$FS.triangles=[],q$R=0;q$R<q$nS;q$R++)q$FS.triangles.push(q$z.getUint16());if(0<(q$lS=q$z.getUint16()))for(q$FS.vertices=[],q$R=0;q$R<q$lS;q$R++)q$FS.vertices.push(q$z.getFloat32());if(0<(q$BS=q$z.getUint16()))for(q$FS.lengths=[],q$R=0;q$R<q$BS;q$R++)q$FS.lengths.push(q$z.getFloat32())}q$oS.slotArr.push(q$$S)}this.skinDic[q$oS.name]=q$oS,this.skinDataArray.push(q$oS)}1==q$z.getUint8()?(this.yReverseMatrix=new q$XS(1,0,0,-1,0,0),q$B&&q$B.setTempMatrix(this.yReverseMatrix)):q$B&&q$B.setTempMatrix(new q$XS),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},q$S.getTexture=function(q$S){var q$_=this.subTextureDic[q$S];return q$_||(q$_=this.subTextureDic[q$S.substr(0,q$S.length-1)]),null==q$_?this._mainTexture:q$_},q$S.showSkinByIndex=function(q$S,q$_,q$a){if(void 0===q$a&&(q$a=!0),q$_<0&&q$_>=this.skinDataArray.length)return!1;var q$R,q$J,q$V=0,q$W=0,q$k=this.skinDataArray[q$_];if(q$k){for(q$V=0,q$W=q$k.slotArr.length;q$V<q$W;q$V++)(q$J=q$k.slotArr[q$V])&&(q$R=q$S[q$J.name])&&(q$R.showSlotData(q$J,q$a),q$a&&"undefined"!=q$R.attachmentName&&"null"!=q$R.attachmentName?q$R.showDisplayByName(q$R.attachmentName):q$R.showDisplayByIndex(q$R.displayIndex));return!0}return!1},q$S.getSkinIndexByName=function(q$S){for(var q$_=0,q$a=this.skinDataArray.length;q$_<q$a;q$_++)if(this.skinDataArray[q$_].name==q$S)return q$_;return-1},q$S.getGrahicsDataWithCache=function(q$S,q$_){return this._graphicsCache[q$S][q$_]},q$S.setGrahicsDataWithCache=function(q$S,q$_,q$a){this._graphicsCache[q$S][q$_]=q$a},q$S.destroy=function(){var q$S;for(var q$_ in this._isDestroyed=!0,this.subTextureDic)(q$S=this.subTextureDic[q$_])&&q$S.destroy();for(q$_ in this._textureDic)(q$S=this._textureDic[q$_])&&q$S.destroy();for(var q$a=0,q$R=this.skinSlotDisplayDataArr.length;q$a<q$R;q$a++)this.skinSlotDisplayDataArr[q$a].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete q$J.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},q$S.getAniNameByIndex=function(q$S){var q$_=this.getAnimation(q$S);return q$_?q$_.name:null},q$V(0,q$S,"rate",function(){return this._rate},function(q$S){this._rate=q$S}),q$J.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",q$J.TEMPLET_DICTIONARY=null,q$J}(q$P)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(q$S,q$_){"use strict";for(var q$a in Object.defineProperty(q$_,"__esModule",{value:!0}),Laya){var q$R=Laya[q$a];q$R&&q$R.__isclass&&(q$_[q$a]=q$R)}});