var Laya=window.Laya=function($c,$R){var $q={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function($R,$F){return 1==arguments.length?$q.__presubstr.call(this,$R):$q.__presubstr.call(this,$R,0<$F?$F:this.length+$F);},__init:function($R){$R.forEach(function($R){$R.__init$&&$R.__init$();});},__isClass:function($R){return $R&&($R.__isclass||$R==Object||$R==String||$R==Array);},__newvec:function($R,$F){var $i=[];$i.length=$R;for(var $j=0;$j<$R;$j++)$i[$j]=$F;return $i;},__extend:function($R,$F){for(var $i in $F)if($F.hasOwnProperty($i)){var $j=Object.getOwnPropertyDescriptor($F,$i),$t=$j.get,$p=$j.set;$t||$p?$t&&$p?Object.defineProperty($R,$i,$j):($t&&Object.defineProperty($R,$i,$t),$p&&Object.defineProperty($R,$i,$p)):$R[$i]=$F[$i];}function $$(){$q.un(this,"constructor",$R);}$$.prototype=$F.prototype,$R.prototype=new $$(),$q.un($R.prototype,"__imps",$q.__copy({},$F.prototype.__imps));},__copy:function($R,$F){if(!$F)return null;for(var $i in $R=$R||{},$F)$R[$i]=$F[$i];return $R;},__package:function($R,$F){if(!$q.__packages[$R]){$q.__packages[$R]=!0;var $i=$c,$j=$R.split(".");if(1<$j.length)for(var $t=0,$p=$j.length-1;$t<$p;$t++){var $$=$i[$j[$t]];$i=$$||($i[$j[$t]]={});}$i[$j[$j.length-1]]||($i[$j[$j.length-1]]=$F||{});}},__hasOwnProperty:function($R,$F){return $F=$F||this,Object.hasOwnProperty.call($F,$R)||function $R($F,$i){if(Object.hasOwnProperty.call($i.prototype,$F))return!0;var $j=$i.prototype.__super;return null==$j?null:$R($F,$j);}($R,$F.__class);},__typeof:function($R,$F){if(!$R||!$F)return!1;if($F===String)return"string"==typeof $R;if($F===Number)return"number"==typeof $R;if($F.__interface__)$F=$F.__interface__;else if("string"!=typeof $F)return $R instanceof $F;return $R.__imps&&$R.__imps[$F]||$R.__class==$F;},__as:function($R,$F){return this.__typeof($R,$F)?$R:null;},__int:function($R){return $R?parseInt($R):0;},interface:function($R,$F){$q.__package($R,{});var $i=$q.__internals,$j=$i[$R]=$i[$R]||{self:$R};if($F){var $t=$F.split(",");$j.extend=[];for(var $p=0;$p<$t.length;$p++){var $$=$t[$p];$i[$$]=$i[$$]||{self:$$},$j.extend.push($i[$$]);}}var $V=$c,$N=$R.split(".");for($p=0;$p<$N.length-1;$p++)$V=$V[$N[$p]];$V[$N[$N.length-1]]={__interface__:$R};},class:function($R,$F,$i,$j){if($i&&$q.__extend($R,$i),$F)if($q.__package($F,$R),$q.__classmap[$F]=$R,0<$F.indexOf(".")){if(0==$F.indexOf("laya.")){var $t=$F.split(".");$j=$j||$t[$t.length-1],$q[$j]&&console.log("Warning!,this class["+$j+"] already exist:",$q[$j]),$q[$j]=$R;}}else"Main"==$F?$c.Main=$R:"MainWX"==$F?$c.MainWX=$R:($q[$F]&&console.log("Error!,this class["+$F+"] already exist:",$q[$F]),$q[$F]=$R);var $p=$q.un,$$=$R.prototype;$p($$,"hasOwnProperty",$q.__hasOwnProperty),$p($$,"__class",$R),$p($$,"__super",$i),$p($$,"__className",$F),$p($R,"__super",$i),$p($R,"__className",$F),$p($R,"__isclass",!0),$p($R,"super",function($R){this.__super.call($R);});},imps:function($R,$F){if(!$F)return null;var $t=$R.__imps||$q.un($R,"__imps",{});function $p($R){var $F,$i;if(($F=$q.__internals[$R])&&($t[$R]=!0,$i=$F.extend))for(var $j=0;$j<$i.length;$j++)$p($i[$j].self);}for(var $i in $F)$p($i);},superSet:function($R,$F,$i,$j){var $t=$R.prototype["_$set_"+$i];$t&&$t.call($F,$j);},superGet:function($R,$F,$i){var $j=$R.prototype["_$get_"+$i];return $j?$j.call($F):null;},getset:function($R,$F,$i,$j,$t){$R?($j&&($F["_$GET_"+$i]=$j),$t&&($F["_$SET_"+$i]=$t)):($j&&$q.un($F,"_$get_"+$i,$j),$t&&$q.un($F,"_$set_"+$i,$t)),$j&&$t?Object.defineProperty($F,$i,{get:$j,set:$t,enumerable:!1,configurable:!0}):($j&&Object.defineProperty($F,$i,{get:$j,enumerable:!1,configurable:!0}),$t&&Object.defineProperty($F,$i,{set:$t,enumerable:!1,configurable:!0}));},static:function($i,$j){for(var $t=0,$R=$j.length;$t<$R;$t+=2)if("length"==$j[$t])$i.length=$j[$t+1].call($i);else{function $F(){var $F=$j[$t],$R=$j[$t+1];Object.defineProperty($i,$F,{get:function(){return delete this[$F],this[$F]=$R.call(this);},set:function($R){delete this[$F],this[$F]=$R;},enumerable:!0,configurable:!0});}$F();}},un:function($R,$F,$i){return $i||($i=$R[$F]),$q.__propun.value=$i,Object.defineProperty($R,$F,$q.__propun),$i;},uns:function($F,$R){$R.forEach(function($R){$q.un($F,$R);});}};return $c.console=$c.console||{log:function(){}},$c.trace=$c.console.log,Error.prototype.throwError=function(){throw arguments;},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),$q;}(window,document);!function($R,$F,$i){$i.un,$i.uns,$i.static,$i.class,$i.getset,$i.__newvec;}(window,document,Laya),function($$,$F,$H){$H.un,$H.uns;var $N=$H.static,$x=$H.class,$q=$H.getset;$H.__newvec;$H.interface("laya.runtime.IMarket"),$H.interface("laya.filters.IFilter"),$H.interface("laya.display.ILayout"),$H.interface("laya.resource.IDispose"),$H.interface("laya.runtime.IPlatform"),$H.interface("laya.resource.IDestroy"),$H.interface("laya.runtime.IConchNode"),$H.interface("laya.filters.IFilterAction"),$H.interface("laya.runtime.ICPlatformClass"),$H.interface("laya.resource.ICreateResource"),$H.interface("laya.runtime.IConchRenderObject"),$H.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var $L=function(){function $p(){}return $x($p,"laya.utils.RunDriver"),$p.FILTER_ACTIONS=[],$p.pixelRatio=-1,$p._charSizeTestDiv=null,$p.now=function(){return Date.now();},$p.getWindow=function(){return $$;},$p.getPixelRatio=function(){if($p.pixelRatio<0){var $R=$b.context,$F=$R.backingStorePixelRatio||$R.webkitBackingStorePixelRatio||$R.mozBackingStorePixelRatio||$R.msBackingStorePixelRatio||$R.oBackingStorePixelRatio||$R.backingStorePixelRatio||1;($p.pixelRatio=($b.window.devicePixelRatio||1)/$F)<1&&($p.pixelRatio=1);}return $p.pixelRatio;},$p.getIncludeStr=function($R){return null;},$p.createShaderCondition=function($R){var $F="(function() {return "+$R+";})";return $H._runScript($F);},$p.fontMap=[],$p.measureText=function($R,$F){var $i=$p.hanzi.test($R);if($i&&$p.fontMap[$F])return $p.fontMap[$F];var $j=$b.context;$j.font=$F;var $t=$j.measureText($R);return $t||($t={width:16,height:16}),$i&&($p.fontMap[$F]=$t),$t;},$p.getWebGLContext=function($R){},$p.beginFlush=function(){},$p.endFinish=function(){},$p.addToAtlas=null,$p.flashFlushImage=function($R){},$p.drawToCanvas=function($R,$F,$i,$j,$t,$p){var $$=$JR.create("2D"),$V=new $v($i,$j,$$);return $K.renders[$F]._fun($R,$V,$t,$p),$$;},$p.createParticleTemplate2D=null,$p.createGLTextur=null,$p.createWebGLContext2D=null,$p.changeWebGLSize=function($R,$F){},$p.createRenderSprite=function($R,$F){return new $K($R,$F);},$p.createFilterAction=function($R){return new $J();},$p.createGraphics=function(){return new $k();},$p.clear=function($R){$u._context.ctx.clear();},$p.cancelLoadByUrl=function($R){},$p.clearAtlas=function($R){},$p.isAtlas=function($R){return!1;},$p.addTextureToAtlas=function($R){},$p.getTexturePixels=function($R,$F,$i,$j,$t){return null;},$p.skinAniSprite=function(){return null;},$p.update3DLoop=function(){},$N($p,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$");}]),$p;}(),$j=($q(1,$H,"alertGlobalError",null,function($R){var $p=0;$b.window.onerror=$R?function($R,$F,$i,$j,$t){$p++<5&&$t&&alert($t.stack||$t);}:null;}),$H.init=function($R,$F,$i){for(var $j=[],$t=2,$p=arguments.length;$t<$p;$t++)$j.push(arguments[$t]);if(!$H._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=$H._arrayBufferSlice),$H._isinit=!0,$b.__init__(),$e.__init__(),$k.__init__(),$H.timer=new $r(),$H.scaleTimer=new $r(),$H.loader=new $NR(),$I.__init__(),$t=0;for(var $$=$j.length;$t<$$;$t++)$j[$t].enable&&$j[$t].enable();return $h.__init__(),$V.__init__(),$Q.__init__(),$O.beginCheck(),$H._currentStage=$H.stage=new $mR(),$H.stage.conchModel&&$H.stage.conchModel.setRootNode(),$H._getUrlPath(),$H.render=new $u(0,0),$H.stage.size($R,$F),$K.__init__(),$s.__init__(),$S.instance.__init__($H.stage,$u.canvas),$wR.__init__(),$z.autoStopMusic=!0,$g.__init__(),$u.canvas;}},$H._getUrlPath=function(){var $R=$b.window.location,$F=$R.pathname;$F=$F&&":"==$F.charAt(2)?$F.substring(1):$F,$Z.rootPath=$Z.basePath=$Z.getPath("file:"==$R.protocol?$F:$R.protocol+"//"+$R.host+$R.pathname);},$H._arrayBufferSlice=function($R,$F){var $i=new Uint8Array(this,$R,$F-$R),$j=new Uint8Array($i.length);return $j.set($i),$j.buffer;},$H._runScript=function($R){return $b.window[$H._evcode]($R);},$H.stage=null,$H.timer=null,$H.scaleTimer=null,$H.loader=null,$H.version="1.8.6",$H.render=null,$H._currentStage=null,$H._isinit=!1,$H.isDebug=!1,$H.MiniAdpter={init:function(){$$.navigator&&$$.navigator.userAgent&&-1<$$.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0");}},$N($H,["conchMarket",function(){return this.conchMarket=$$.conch?conchMarket:null;},"PlatformClass",function(){return this.PlatformClass=$$.PlatformClass;},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al";}]),function(){function $R(){}return $x($R,"Config"),$R.WebGLTextCacheCount=500,$R.atlasEnable=!1,$R.showCanvasMark=!1,$R.animationInterval=50,$R.isAntialias=!1,$R.isAlpha=!1,$R.premultipliedAlpha=!0,$R.isStencil=!0,$R.preserveDrawingBuffer=!1,$R;}()),$c=function(){function $c(){this._events=null;}$x($c,"laya.events.EventDispatcher");var $R=$c.prototype;return $R.hasListener=function($R){return!!(this._events&&this._events[$R]);},$R.getListener=function($R){return this._events?this._events[$R]:null;},$R.event=function($R,$F){if(!this._events||!this._events[$R])return!1;var $i=this._events[$R];if($i.lock)$i.queue||($i.queue=[]),$i.queue.push($F);else{var $j;for($i.lock=!0,$i.cursor=$i.head;$i.cursor;)($j=$i.cursor).recover?($i.head=$i.tail=$i.cursor=null,console.error("node is recover："+$j.id)):($i.cursor=$j.next,$j.once&&$c.delNode($i,$j),$j.method&&(null!=$F?$j.args?$j.method.apply($j.caller,$j.args.concat($F)):$F instanceof Array?$j.method.apply($j.caller,$F):$j.caller?$j.method.call($j.caller,$F):$H.recordError("事件派发错误","node.caller:"+$j.caller+"node.method:"+$j.method+"data:"+$F+"node.prev"+$j.prev):$j.method.apply($j.caller,$j.args)),$j.once&&$c.recoverHandler($j));$i.lock=!1,!$i.head&&this._events&&this._events[$R]==$i&&delete this._events[$R],$i.queue&&$i.queue.length&&this.event($R,$i.queue.shift());}return!0;},$R.on=function($R,$F,$i,$j){return this._createListener($R,$F,$i,$j,!1);},$R.once=function($R,$F,$i,$j){return this._createListener($R,$F,$i,$j,!0);},$R._createListener=function($R,$F,$i,$j,$t,$p){void 0===$p&&($p=!0),$p&&this.off($R,$F,$i,$t);var $$=$c.createHandler($F||this,$i,$j,$t);this._events||(this._events={});var $V=this._events,$N=$V[$R];return $N?$N.tail?($$.prev=$N.tail,$N.tail.next=$$,$N.tail=$$):$N.head=$N.tail=$$:$V[$R]={head:$$,tail:$$,cursor:null,lock:!1},this;},$R.off=function($R,$F,$i,$j){if(void 0===$j&&($j=!1),!this._events||!this._events[$R])return this;for(var $t=this._events[$R],$p=$t.head;$p;){if((!$F||$p.caller===$F)&&$p.method===$i&&(!$j||$p.once)){$c.delNode($t,$p),$t.cursor==$p&&($t.cursor=$p.next),$c.recoverHandler($p);break;}$p=$p.next;}return this;},$R.offAll=function($R){var $F=this._events;if(!$F)return this;if($R)this._recoverHandlers($F[$R]),delete $F[$R];else{for(var $i in $F)this._recoverHandlers($F[$i]);this._events=null;}return this;},$R._recoverHandlers=function($R){if($R){for(var $F=$R.head;$F;){$c.delNode($R,$F);var $i=$F.next;$c.recoverHandler($F),$F=$i;}$R.cursor=null;}},$R.isMouseEvent=function($R){return $c.MOUSE_EVENTS[$R];},$c.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},$c.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0});},$c.delNode=function($R,$F){$F.prev?$F.prev.next=$F.next:$R.head=$F.next,$F.next?$F.next.prev=$F.prev:$R.tail=$F.prev;},$c.createHandler=function($R,$F,$i,$j){var $t=500<$c._freeHandler.length?$c._freeHandler.shift():null;if($t){if($t.recover)$t.recover=!1,$t.caller=$R,$t.method=$F,$t.args=$i,$t.once=$j;else{var $p="";try{arguments.propertyIsEnumerable.caller;}catch($R){$p=$R.stack;}var $$=$t.caller?($t.caller.__proto__&&$t.caller.__proto__.constructor&&$t.caller.__proto__.constructor.name)+"|"+$t.caller.__className+"|"+$t.caller.name:"",$V=$t.method?$t.method.name:"";$H.recordError("EventDispatcher重复创建","caller="+$$+"  method="+$V+"  stack="+$p),$t={id:++$c._nodeCount,caller:$R,method:$F,args:$i,once:$j,recover:!1};}}else $t={id:++$c._nodeCount,caller:$R,method:$F,args:$i,once:$j,recover:!1};return $t.prev=$t.next=null,$t;},$c.recoverHandler=function($R){if($R.recover){if($c._errorCount<5){$c._errorCount++;var $F="";try{arguments.propertyIsEnumerable.caller;}catch($R){$F=$R.stack;}var $i=$R.caller?($R.caller.__proto__&&$R.caller.__proto__.constructor&&$R.caller.__proto__.constructor.name)+"|"+$R.caller.__className+"|"+$R.caller.name:"",$j=$R.method?$R.method.name:"";$H.recordError("EventDispatcher重复回收","id="+$R.id+"  caller="+$i+"  method="+$j+"  stack="+$F);}$R.caller=$R.method=$R.args=$R.prev=null;}else $R.recover=!0,$R.caller=$R.method=$R.args=$R.prev=$R.next=null,$c._freeHandler&&$c._freeHandler.length<3e3&&$c._freeHandler.push($R);},$c._freeHandler=[],$c._nodeCount=0,$c._errorCount=0,$c;}(),$M=function(){function $t($R,$F,$i,$j){this.once=!1,void(this._id=0)===$j&&($j=!1),this.setTo($R,$F,$i,$j);}$x($t,"laya.utils.Handler");var $R=$t.prototype;return $R.setTo=function($R,$F,$i,$j){return this._id=$t._gid++,this.caller=$R,this.method=$F,this.args=$i,this.once=$j,this;},$R.run=function(){if(null==this.method)return null;var $R=this._id,$F=this.method.apply(this.caller,this.args);return this._id===$R&&this.once&&this.recover(),$F;},$R.runWith=function($R){if(null==this.method)return null;var $F=this._id;if(null==$R)var $i=this.method.apply(this.caller,this.args);else $i=this.args||$R.unshift?this.args?this.method.apply(this.caller,this.args.concat($R)):this.method.apply(this.caller,$R):this.method.call(this.caller,$R);return this._id===$F&&this.once&&this.recover(),$i;},$R.clear=function(){return this.caller=null,this.method=null,this.args=null,this;},$R.recover=function(){0<this._id&&(this._id=0,this.clear());},$t.create=function($R,$F,$i,$j){return void 0===$j&&($j=!0),new $t($R,$F,$i,$j);},$t._gid=1,$t;}(),$B=function(){function $R(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0;}$x($R,"laya.display.BitmapFont");var $F=$R.prototype;return $F.loadFont=function($R,$F){this._path=$R,this._complete=$F,$H.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],$M.create(this,this.onLoaded));},$F.onLoaded=function(){this.parseFont($VR.getRes(this._path),$VR.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null);},$F.parseFont=function($R,$F){if(null!=$R&&null!=$F){this._texture=$F;var $i=$R.getElementsByTagName("info");if(!$i[0].getAttributeNode)return this.parseFont2($R,$F);this.fontSize=parseInt($i[0].getAttributeNode("size").nodeValue);var $j,$t=$i[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt($t[0]),parseInt($t[1]),parseInt($t[2]),parseInt($t[3])],$j=$R.getElementsByTagName("char");var $p=0;for($p=0;$p<$j.length;$p++){var $$=$j[$p],$V=parseInt($$.getAttributeNode("id").nodeValue),$N=parseInt($$.getAttributeNode("xoffset").nodeValue)/1,$c=parseInt($$.getAttributeNode("yoffset").nodeValue)/1,$q=parseInt($$.getAttributeNode("xadvance").nodeValue)/1,$s=new $T();$s.x=parseInt($$.getAttributeNode("x").nodeValue),$s.y=parseInt($$.getAttributeNode("y").nodeValue),$s.width=parseInt($$.getAttributeNode("width").nodeValue),$s.height=parseInt($$.getAttributeNode("height").nodeValue);var $k=$qR.create($F,$s.x,$s.y,$s.width,$s.height,$N,$c);this._maxWidth=Math.max(this._maxWidth,$q+this.letterSpacing),this._fontCharDic[$V]=$k,this._fontWidthMap[$V]=$q;}}},$F.parseFont2=function($R,$F){if(null!=$R&&null!=$F){this._texture=$F;var $i=$R.getElementsByTagName("info");this.fontSize=parseInt($i[0].attributes.size.nodeValue);var $j=$i[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt($j[0]),parseInt($j[1]),parseInt($j[2]),parseInt($j[3])];var $t=$R.getElementsByTagName("char"),$p=0;for($p=0;$p<$t.length;$p++){var $$=$t[$p].attributes,$V=parseInt($$.id.nodeValue),$N=parseInt($$.xoffset.nodeValue)/1,$c=parseInt($$.yoffset.nodeValue)/1,$q=parseInt($$.xadvance.nodeValue)/1,$s=new $T();$s.x=parseInt($$.x.nodeValue),$s.y=parseInt($$.y.nodeValue),$s.width=parseInt($$.width.nodeValue),$s.height=parseInt($$.height.nodeValue);var $k=$qR.create($F,$s.x,$s.y,$s.width,$s.height,$N,$c);this._maxWidth=Math.max(this._maxWidth,$q+this.letterSpacing),this._fontCharDic[$V]=$k,this._fontWidthMap[$V]=$q;}}},$F.getCharTexture=function($R){return this._fontCharDic[$R.charCodeAt(0)];},$F.destroy=function(){if(this._texture){for(var $R in this._fontCharDic){var $F=this._fontCharDic[$R];$F&&$F.destroy();}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null;}},$F.setSpaceWidth=function($R){this._spaceWidth=$R;},$F.getCharWidth=function($R){var $F=$R.charCodeAt(0);return this._fontWidthMap[$F]?this._fontWidthMap[$F]+this.letterSpacing:" "==$R?this._spaceWidth+this.letterSpacing:0;},$F.getTextWidth=function($R){for(var $F=0,$i=0,$j=$R.length;$i<$j;$i++)$F+=this.getCharWidth($R.charAt($i));return $F;},$F.getMaxWidth=function(){return this._maxWidth;},$F.getMaxHeight=function(){return this.fontSize;},$F.drawText=function($R,$F,$i,$j,$t,$p){var $$,$V=this.getTextWidth($R),$N=0;"center"===$t&&($N=($p-$V)/2),"right"===$t&&($N=$p-$V);for(var $c=0,$q=0,$s=$R.length;$q<$s;$q++)($$=this.getCharTexture($R.charAt($q)))&&($F.graphics.drawTexture($$,$i+$c+$N,$j),$c+=this.getCharWidth($R.charAt($q)));},$R;}(),$V=function(){function $i(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=$i._TF_EMPTY;}$x($i,"laya.display.css.Style");var $R=$i.prototype;return $R.getTransform=function(){return this._tf;},$R.setTransform=function($R){this._tf="none"!==$R&&$R?$R:$i._TF_EMPTY;},$R.setTranslateX=function($R){this._tf===$i._TF_EMPTY&&(this._tf=new $t()),this._tf.translateX=$R;},$R.setTranslateY=function($R){this._tf===$i._TF_EMPTY&&(this._tf=new $t()),this._tf.translateY=$R;},$R.setScaleX=function($R){this._tf===$i._TF_EMPTY&&(this._tf=new $t()),this._tf.scaleX=$R;},$R.setScale=function($R,$F){this._tf===$i._TF_EMPTY&&(this._tf=new $t()),this._tf.scaleX=$R,this._tf.scaleY=$F;},$R.setScaleY=function($R){this._tf===$i._TF_EMPTY&&(this._tf=new $t()),this._tf.scaleY=$R;},$R.setRotate=function($R){this._tf===$i._TF_EMPTY&&(this._tf=new $t()),this._tf.rotate=$R;},$R.setSkewX=function($R){this._tf===$i._TF_EMPTY&&(this._tf=new $t()),this._tf.skewX=$R;},$R.setSkewY=function($R){this._tf===$i._TF_EMPTY&&(this._tf=new $t()),this._tf.skewY=$R;},$R.destroy=function(){this.scrollRect=null;},$R.render=function($R,$F,$i,$j){},$R.getCSSStyle=function(){return $FR.EMPTY;},$R._enableLayout=function(){return!1;},$q(0,$R,"scaleX",function(){return this._tf.scaleX;},function($R){this.setScaleX($R);}),$q(0,$R,"transform",function(){return this.getTransform();},function($R){this.setTransform($R);}),$q(0,$R,"translateX",function(){return this._tf.translateX;},function($R){this.setTranslateX($R);}),$q(0,$R,"translateY",function(){return this._tf.translateY;},function($R){this.setTranslateY($R);}),$q(0,$R,"scaleY",function(){return this._tf.scaleY;},function($R){this.setScaleY($R);}),$q(0,$R,"block",function(){return 0!=(1&this._type);}),$q(0,$R,"skewY",function(){return this._tf.skewY;},function($R){this.setSkewY($R);}),$q(0,$R,"rotate",function(){return this._tf.rotate;},function($R){this.setRotate($R);}),$q(0,$R,"skewX",function(){return this._tf.skewX;},function($R){this.setSkewX($R);}),$q(0,$R,"paddingLeft",function(){return 0;}),$q(0,$R,"paddingTop",function(){return 0;}),$q(0,$R,"absolute",function(){return!0;}),$i.__init__=function(){$i._TF_EMPTY=new $t(),$i.EMPTY=new $i();},$i.EMPTY=null,$i._TF_EMPTY=null,$i;}(),$h=function(){function $F($R){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=$E.create($F.defaultColor),this.family=$F.defaultFamily,this.stroke=$F._STROKE,this.size=$F.defaultSize,$R&&$R!==$F.EMPTY&&$R.copyTo(this);}$x($F,"laya.display.css.Font");var $R=$F.prototype;return $R.set=function($R){this._text=null;for(var $F=$R.split(" "),$i=0,$j=$F.length;$i<$j;$i++){var $t=$F[$i];switch($t){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue;}0<$t.indexOf("px")&&(this.size=parseInt($t),this.family=$F[$i+1],$i++);}},$R.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family;},$R.copyTo=function($R){$R._type=this._type,$R._text=this._text,$R._weight=this._weight,$R._color=this._color,$R.family=this.family,$R.stroke=this.stroke!=$F._STROKE?this.stroke.slice():$F._STROKE,$R.indent=this.indent,$R.size=this.size;},$q(0,$R,"password",function(){return 0!=(1024&this._type);},function($R){$R?this._type|=1024:this._type&=-1025;}),$q(0,$R,"color",function(){return this._color.strColor;},function($R){this._color=$E.create($R);}),$q(0,$R,"italic",function(){return 0!=(512&this._type);},function($R){$R?this._type|=512:this._type&=-513;}),$q(0,$R,"bold",function(){return 0!=(2048&this._type);},function($R){$R?this._type|=2048:this._type&=-2049;}),$q(0,$R,"weight",function(){return""+this._weight;},function($R){var $F=0;switch($R){case"normal":break;case"bold":this.bold=!0,$F=700;break;case"bolder":$F=800;break;case"lighter":$F=100;break;default:$F=parseInt($R);}this._weight=$F,this._text=null;}),$q(0,$R,"decoration",function(){return this._decoration?this._decoration.value:null;},function($R){var $F=$R.split(" ");switch(this._decoration||(this._decoration={}),$F[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=$F[0];}$F[1]&&(this._decoration.color=$E.create($F)),this._decoration.value=$R;}),$F.__init__=function(){$F.EMPTY=new $F(null);},$F.EMPTY=null,$F.defaultColor="#000000",$F.defaultSize=12,$F.defaultFamily="Arial",$F.defaultFont="12px Arial",$F._STROKE=[0,"#000000"],$F._ITALIC=512,$F._PASSWORD=1024,$F._BOLD=2048,$F;}(),$t=function(){function $R(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0;}return $x($R,"laya.display.css.TransformInfo"),$R;}(),$k=function(){function $s(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,$u.isConchNode){this._nativeObj=new $$._conchGraphics(),this.id=this._nativeObj.conchID;}}$x($s,"laya.display.Graphics");var $R=$s.prototype;return $R.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null;},$R.clear=function($R){void 0===$R&&($R=!1);var $F=0,$i=0;if($R){var $j=this._one;if(this._cmds){for($i=this._cmds.length,$F=0;$F<$i;$F++)!($j=this._cmds[$F])||$j.callee!==$u._context._drawTexture&&$j.callee!==$u._context._drawTextureWithTransform||($j[0]=null,$s._cache.push($j));this._cmds.length=0;}else $j&&(!$j||$j.callee!==$u._context._drawTexture&&$j.callee!==$u._context._drawTextureWithTransform||($j[0]=null,$s._cache.push($j)));}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for($F=0,$i=this._vectorgraphArray.length;$F<$i;$F++)$U.getInstance().deleteShape(this._vectorgraphArray[$F]);this._vectorgraphArray.length=0;}},$R._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset();},$R._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new $i(),this._graphicBounds._graphics=this);},$R._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint();},$R._isOnlyOne=function(){return!this._cmds||0===this._cmds.length;},$R.getBounds=function($R){return void 0===$R&&($R=!1),this._initGraphicBounds(),this._graphicBounds.getBounds($R);},$R.getBoundPoints=function($R){return void 0===$R&&($R=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints($R);},$R._addCmd=function($R){this._cmds=this._cmds||[],$R.callee=$R.shift(),this._cmds.push($R);},$R.setFilters=function($R){this._saveToCmd($u._context._setFilters,$R);},$R.drawTexture=function($R,$F,$i,$j,$t,$p,$$){if(void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=0),void 0===$t&&($t=0),void 0===$$&&($$=1),!$R||$$<.01)return null;$j||($j=$R.sourceWidth),$t||($t=$R.sourceHeight),$$=$$<0?0:1<$$?1:$$;var $V,$N=!$u.isWebGL&&($b.onFirefox||$b.onEdge||$b.onIE||$b.onSafari)?.5:0,$c=$j/$R.sourceWidth,$q=$t/$R.sourceHeight;return $j=$R.width*$c,$t=$R.height*$q,$R.loaded&&($j<=0||$t<=0)?null:($F+=$R.offsetX*$c,$i+=$R.offsetY*$q,this._sp&&(this._sp._renderType|=512),$F-=$N,$i-=$N,$j+=2*$N,$t+=2*$N,$s._cache.length?(($V=$s._cache.pop())[0]=$R,$V[1]=$F,$V[2]=$i,$V[3]=$j,$V[4]=$t,$V[5]=$p,$V[6]=$$):$V=[$R,$F,$i,$j,$t,$p,$$],$V.callee=$p||1!=$$?$u._context._drawTextureWithTransform:$u._context._drawTexture,null!=this._one||$p||1!=$$?this._saveToCmd($V.callee,$V):(this._one=$V,this._render=this._renderOneImg),$R.loaded||$R.once("loaded",this,this._textureLoaded,[$R,$V]),this._repaint(),$V);},$R.cleanByTexture=function($R,$F,$i,$j,$t){if(void 0===$j&&($j=0),void 0===$t&&($t=0),!$R)return this.clear();if(this._one&&this._render===this._renderOneImg){$j||($j=$R.sourceWidth),$t||($t=$R.sourceHeight);var $p=$j/$R.sourceWidth,$$=$t/$R.sourceHeight;$j=$R.width*$p,$t=$R.height*$$,$F+=$R.offsetX*$p,$i+=$R.offsetY*$$,this._one[0]=$R,this._one[1]=$F,this._one[2]=$i,this._one[3]=$j,this._one[4]=$t,this._repaint();}else this.clear(),$R&&this.drawTexture($R,$F,$i,$j,$t);},$R.drawTextures=function($R,$F){$R&&this._saveToCmd($u._context._drawTextures,[$R,$F]);},$R.fillTexture=function($R,$F,$i,$j,$t,$p,$$){if(void 0===$j&&($j=0),void 0===$t&&($t=0),void 0===$p&&($p="repeat"),$R){var $V=[$R,$F,$i,$j,$t,$p,$$||$_.EMPTY,{}];$R.loaded||$R.once("loaded",this,this._textureLoaded,[$R,$V]),this._saveToCmd($u._context._fillTexture,$V);}},$R._textureLoaded=function($R,$F){$F[3]=$F[3]||$R.width,$F[4]=$F[4]||$R.height,this._repaint();},$R.fillCircle=function($R,$F,$i,$j,$t,$p,$$){$i.bitmap.enableMerageInAtlas=!1;var $V=new Float32Array(2*($$+1)),$N=new Float32Array(2*($$+1)),$c=new Uint16Array(3*$$),$q=2*Math.PI/$$,$s=0;$V[0]=$j,$V[1]=$t,$N[0]=$j/$i.width,$N[1]=$t/$i.height;for(var $k=2,$h=0;$h<$$;$h++){var $S=$p*Math.cos($s)+$j,$x=$p*Math.sin($s)+$t;$V[$k]=$S,$V[$k+1]=$x,$N[$k]=$S/$i.width,$N[$k+1]=$x/$i.height,$s+=$q,$k+=2;}for($h=$k=0;$h<$$;$h++)$c[$k++]=0,$c[$k++]=$h+1,$c[$k++]=$$+1<=$h+2?1:$h+2;this.drawTriangles($i,$R,$F,$V,$N,$c);},$R.drawTriangles=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){void 0===$V&&($V=1),this._saveToCmd($u._context.drawTriangles,[$R,$F,$i,$j,$t,$p,$$,$V,$N,$c]);},$R._saveToCmd=function($R,$F){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=$F,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push($F)),$F.callee=$R,this._repaint(),$F;},$R.clipRect=function($R,$F,$i,$j){this._saveToCmd($u._context._clipRect,[$R,$F,$i,$j]);},$R.fillText=function($R,$F,$i,$j,$t,$p,$$){void 0===$$&&($$=0),this._saveToCmd($u._context._fillText,[$R,$F,$i,$j||$h.defaultFont,$t,$p]);},$R.fillBorderText=function($R,$F,$i,$j,$t,$p,$$,$V){this._saveToCmd($u._context._fillBorderText,[$R,$F,$i,$j||$h.defaultFont,$t,$p,$$,$V]);},$R.strokeText=function($R,$F,$i,$j,$t,$p,$$){this._saveToCmd($u._context._strokeText,[$R,$F,$i,$j||$h.defaultFont,$t,$p,$$]);},$R.alpha=function($R){$R=$R<0?0:1<$R?1:$R,this._saveToCmd($u._context._alpha,[$R]);},$R.setAlpha=function($R){$R=$R<0?0:1<$R?1:$R,this._saveToCmd($u._context._setAlpha,[$R]);},$R.transform=function($R,$F,$i){void 0===$F&&($F=0),void 0===$i&&($i=0),this._saveToCmd($u._context._transform,[$R,$F,$i]);},$R.rotate=function($R,$F,$i){void 0===$F&&($F=0),void 0===$i&&($i=0),this._saveToCmd($u._context._rotate,[$R,$F,$i]);},$R.scale=function($R,$F,$i,$j){void 0===$i&&($i=0),void 0===$j&&($j=0),this._saveToCmd($u._context._scale,[$R,$F,$i,$j]);},$R.translate=function($R,$F){this._saveToCmd($u._context._translate,[$R,$F]);},$R.save=function(){this._saveToCmd($u._context._save,[]);},$R.restore=function(){this._saveToCmd($u._context._restore,[]);},$R.replaceText=function($R){this._repaint();var $F=this._cmds;if($F){for(var $i=$F.length-1;-1<$i;$i--)if(this._isTextCmd($F[$i].callee))return $F[$i][0].toUpperCase?$F[$i][0]=$R:$F[$i][0].setText($R),!0;}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=$R:this._one[0].setText($R),!0;return!1;},$R._isTextCmd=function($R){return $R===$u._context._fillText||$R===$u._context._fillBorderText||$R===$u._context._strokeText;},$R.replaceTextColor=function($R){this._repaint();var $F=this._cmds;if($F)for(var $i=$F.length-1;-1<$i;$i--)this._isTextCmd($F[$i].callee)&&($F[$i][4]=$R,$F[$i][0].toUpperCase||($F[$i][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=$R,this._one[0].toUpperCase||(this._one[0].changed=!0));},$R.loadImage=function($R,$F,$i,$j,$t,$p){var $$=this;void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=0),void 0===$t&&($t=0);var $V=$VR.getRes($R);function $N($R){$R&&($$.drawTexture($R,$F,$i,$j,$t),null!=$p&&$p.call($$._sp,$R));}$V?$N($V):$H.loader.load($R,$M.create(null,$N),null,"image");},$R._renderEmpty=function($R,$F,$i,$j){},$R._renderAll=function($R,$F,$i,$j){for(var $t,$p=this._cmds,$$=0,$V=$p.length;$$<$V;$$++)($t=$p[$$]).callee.call($F,$i,$j,$t);},$R._renderOne=function($R,$F,$i,$j){this._one.callee.call($F,$i,$j,this._one);},$R._renderOneImg=function($R,$F,$i,$j){this._one.callee.call($F,$i,$j,this._one),2305!==$R._renderType&&($R._renderType|=1);},$R.drawLine=function($R,$F,$i,$j,$t,$p){void 0===$p&&($p=1);var $$=0;$u.isWebGL&&($$=$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($$));var $V=$p%2==0?0:.5,$N=[$R+$V,$F+$V,$i+$V,$j+$V,$t,$p,$$];this._saveToCmd($u._context._drawLine,$N);},$R.drawLines=function($R,$F,$i,$j,$t){void 0===$t&&($t=1);var $p=0;if($i&&!($i.length<4)){$u.isWebGL&&($p=$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($p));var $$=$t%2==0?0:.5,$V=[$R+$$,$F+$$,$i,$j,$t,$p];this._saveToCmd($u._context._drawLines,$V);}},$R.drawCurves=function($R,$F,$i,$j,$t){void 0===$t&&($t=1);var $p=[$R,$F,$i,$j,$t];this._saveToCmd($u._context._drawCurves,$p);},$R.drawRect=function($R,$F,$i,$j,$t,$p,$$){void 0===$$&&($$=1);var $V=$p?$$/2:0,$N=$p?$$:0,$c=[$R+$V,$F+$V,$i-$N,$j-$N,$t,$p,$$];this._saveToCmd($u._context._drawRect,$c);},$R.drawCircle=function($R,$F,$i,$j,$t,$p){void 0===$p&&($p=1);var $$=$t?$p/2:0,$V=0;$u.isWebGL&&($V=$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($V));var $N=[$R,$F,$i-$$,$j,$t,$p,$V];this._saveToCmd($u._context._drawCircle,$N);},$R.drawPie=function($R,$F,$i,$j,$t,$p,$$,$V){void 0===$V&&($V=1);var $N=$$?$V/2:0,$c=$$?$V:0,$q=0;$u.isWebGL&&($q=$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($q));var $s=[$R+$N,$F+$N,$i-$c,$j,$t,$p,$$,$V,$q];$s[3]=$P.toRadian($j),$s[4]=$P.toRadian($t),this._saveToCmd($u._context._drawPie,$s);},$R.drawPoly=function($R,$F,$i,$j,$t,$p){void 0===$p&&($p=1);var $$=0,$V=!1;$u.isWebGL&&($$=$U.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($$),$V=!(6<$i.length));var $N=$t?$p%2==0?0:.5:0,$c=[$R+$N,$F+$N,$i,$j,$t,$p,$$,$V];this._saveToCmd($u._context._drawPoly,$c);},$R.drawPath=function($R,$F,$i,$j,$t){var $p=[$R,$F,$i,$j,$t];this._saveToCmd($u._context._drawPath,$p);},$q(0,$R,"cmds",function(){return this._cmds;},function($R){this._sp&&(this._sp._renderType|=512),this._cmds=$R,this._render=this._renderAll,this._repaint();}),$s.__init__=function(){if($u.isConchNode){for(var $R=laya.display.Graphics.prototype,$F=$b.window.ConchGraphics.prototype,$i=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],$j=0,$t=$i.length;$j<=$t;$j++){var $p=$i[$j];$R[$p]=$F[$p];}$R._saveToCmd=null,$F.drawImageS&&($R.drawTextures=function($R,$F){if($R&&$R.loaded&&$R.bitmap&&$R.source){var $i=$R.uv,$j=$R.bitmap.width,$t=$R.bitmap.height;this.drawImageS($R.bitmap.source,$i[0]*$j,$i[1]*$t,($i[2]-$i[0])*$j,($i[5]-$i[3])*$t,$R.offsetX,$R.offsetY,$R.width,$R.height,$F);}}),$R.drawTexture=function($R,$F,$i,$j,$t,$p,$$){if(void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=0),void 0===$t&&($t=0),void 0===$$&&($$=1),$R)if($R.loaded){if($R.loaded&&$R.bitmap&&$R.source&&($j||($j=$R.sourceWidth),$t||($t=$R.sourceHeight),$$=$$<0?0:1<$$?1:$$,$j=$j-$R.sourceWidth+$R.width,$t=$t-$R.sourceHeight+$R.height,!($j<=0||$t<=0))){$F+=$R.offsetX,$i+=$R.offsetY;var $V=$R.uv,$N=$R.bitmap.width,$c=$R.bitmap.height;$V[4]<$V[0]&&$V[5]<$V[1]?this.drawImageM($R.bitmap.source,$V[4]*$N,$V[5]*$c,($V[0]-$V[4])*$N,($V[1]-$V[5])*$c,$F,$i,$j,$t,$p,$$):this.drawImageM($R.bitmap.source,$V[0]*$N,$V[1]*$c,($V[2]-$V[0])*$N,($V[5]-$V[3])*$c,$F,$i,$j,$t,$p,$$),this._repaint();}}else $R.once("loaded",this,function(){this.drawTexture($R,$F,$i,$j,$t,$p);});},$R.fillTexture=function($R,$F,$i,$j,$t,$p,$$){if(void 0===$j&&($j=0),void 0===$t&&($t=0),void 0===$p&&($p="repeat"),$R&&$R.loaded){var $V,$N=$u._context.ctx,$c=$R.bitmap.width,$q=$R.bitmap.height,$s=$R.uv;$V=$R.uv!=$qR.DEF_UV?$N.createPattern($R.bitmap.source,$p,$s[0]*$c,$s[1]*$q,($s[2]-$s[0])*$c,($s[5]-$s[3])*$q):$N.createPattern($R.bitmap.source,$p);var $k=0,$h=0;$$&&($F+=$$.x%$R.width,$i+=$$.y%$R.height,$k-=$$.x%$R.width,$h-=$$.y%$R.height),this._fillImage($V,$F,$i,$k,$h,$j,$t);}};}},$s._cache=[],$s;}(),$i=function(){function $J(){this._cacheBoundsType=!1;}$x($J,"laya.display.GraphicsBounds");var $R=$J.prototype;return $R.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null;},$R.reset=function(){this._temp&&(this._temp.length=0);},$R.getBounds=function($R){return void 0===$R&&($R=!1),(!this._bounds||!this._temp||this._temp.length<1||$R!=this._cacheBoundsType)&&(this._bounds=$T._getWrapRec(this.getBoundPoints($R),this._bounds)),this._cacheBoundsType=$R,this._bounds;},$R.getBoundPoints=function($R){return void 0===$R&&($R=!1),(!this._temp||this._temp.length<1||$R!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints($R)),this._cacheBoundsType=$R,this._rstBoundPoints=$P.copyArray(this._rstBoundPoints,this._temp);},$R._getCmdPoints=function($R){void 0===$R&&($R=!1);var $F,$i,$j=$u._context,$t=this._graphics.cmds;if(($F=this._temp||(this._temp=[])).length=0,$t||null==this._graphics._one||($J._tempCmds.length=0,$J._tempCmds.push(this._graphics._one),$t=$J._tempCmds),!$t)return $F;($i=$J._tempMatrixArrays).length=0;var $p=$J._initMatrix;$p.identity();for(var $$,$V,$N=$J._tempMatrix,$c=NaN,$q=NaN,$s=NaN,$k=NaN,$h=NaN,$S=NaN,$x=0,$a=$t.length;$x<$a;$x++)if(($$=$t[$x]).callee)switch($$.callee){case $j._save:case 7:$i.push($p),$p=$p.clone();break;case $j._restore:case 8:$p=$i.pop();break;case $j._scale:case 5:$N.identity(),$N.translate(-$$[2],-$$[3]),$N.scale($$[0],$$[1]),$N.translate($$[2],$$[3]),this._switchMatrix($p,$N);break;case $j._rotate:case 3:$N.identity(),$N.translate(-$$[1],-$$[2]),$N.rotate($$[0]),$N.translate($$[1],$$[2]),this._switchMatrix($p,$N);break;case $j._translate:case 6:$N.identity(),$N.translate($$[0],$$[1]),this._switchMatrix($p,$N);break;case $j._transform:case 4:$N.identity(),$N.translate(-$$[1],-$$[2]),$N.concat($$[0]),$N.translate($$[1],$$[2]),this._switchMatrix($p,$N);break;case 16:case 24:$J._addPointArrToRst($F,$T._getBoundPointS($$[0],$$[1],$$[2],$$[3]),$p);break;case 17:$p.copyTo($N),$N.concat($$[4]),$J._addPointArrToRst($F,$T._getBoundPointS($$[0],$$[1],$$[2],$$[3]),$N);break;case $j._drawTexture:$V=$$[0],$R?$$[3]&&$$[4]?$J._addPointArrToRst($F,$T._getBoundPointS($$[1],$$[2],$$[3],$$[4]),$p):($V=$$[0],$J._addPointArrToRst($F,$T._getBoundPointS($$[1],$$[2],$V.width,$V.height),$p)):($c=($$[3]||$V.sourceWidth)/$V.width,$q=($$[4]||$V.sourceHeight)/$V.height,$s=$c*$V.sourceWidth,$k=$q*$V.sourceHeight,$h=0<$V.offsetX?$V.offsetX:0,$S=0<$V.offsetY?$V.offsetY:0,$h*=$c,$S*=$q,$J._addPointArrToRst($F,$T._getBoundPointS($$[1]-$h,$$[2]-$S,$s,$k),$p));break;case $j._fillTexture:$$[3]&&$$[4]?$J._addPointArrToRst($F,$T._getBoundPointS($$[1],$$[2],$$[3],$$[4]),$p):($V=$$[0],$J._addPointArrToRst($F,$T._getBoundPointS($$[1],$$[2],$V.width,$V.height),$p));break;case $j._drawTextureWithTransform:var $m;$m=$$[5]?($p.copyTo($N),$N.concat($$[5]),$N):$p,$R?$$[3]&&$$[4]?$J._addPointArrToRst($F,$T._getBoundPointS($$[1],$$[2],$$[3],$$[4]),$m):($V=$$[0],$J._addPointArrToRst($F,$T._getBoundPointS($$[1],$$[2],$V.width,$V.height),$m)):($V=$$[0],$c=($$[3]||$V.sourceWidth)/$V.width,$q=($$[4]||$V.sourceHeight)/$V.height,$s=$c*$V.sourceWidth,$k=$q*$V.sourceHeight,$h=0<$V.offsetX?$V.offsetX:0,$S=0<$V.offsetY?$V.offsetY:0,$h*=$c,$S*=$q,$J._addPointArrToRst($F,$T._getBoundPointS($$[1]-$h,$$[2]-$S,$s,$k),$m));break;case $j._drawRect:case 13:$J._addPointArrToRst($F,$T._getBoundPointS($$[0],$$[1],$$[2],$$[3]),$p);break;case $j._drawCircle:case $j._fillCircle:case 14:$J._addPointArrToRst($F,$T._getBoundPointS($$[0]-$$[2],$$[1]-$$[2],$$[2]+$$[2],$$[2]+$$[2]),$p);break;case $j._drawLine:case 20:$J._tempPoints.length=0;var $M;$M=.5*$$[5],$$[0]==$$[2]?$J._tempPoints.push($$[0]+$M,$$[1],$$[2]+$M,$$[3],$$[0]-$M,$$[1],$$[2]-$M,$$[3]):$$[1]==$$[3]?$J._tempPoints.push($$[0],$$[1]+$M,$$[2],$$[3]+$M,$$[0],$$[1]-$M,$$[2],$$[3]-$M):$J._tempPoints.push($$[0],$$[1],$$[2],$$[3]),$J._addPointArrToRst($F,$J._tempPoints,$p);break;case $j._drawCurves:case 22:$J._addPointArrToRst($F,$d.I.getBezierPoints($$[2]),$p,$$[0],$$[1]);break;case $j._drawPoly:case $j._drawLines:case 18:$J._addPointArrToRst($F,$$[2],$p,$$[0],$$[1]);break;case $j._drawPath:case 19:$J._addPointArrToRst($F,this._getPathPoints($$[2]),$p,$$[0],$$[1]);break;case $j._drawPie:case 15:$J._addPointArrToRst($F,this._getPiePoints($$[0],$$[1],$$[2],$$[3],$$[4]),$p);}return 200<$F.length?$F=$P.copyArray($F,$T._getWrapRec($F)._getBoundPoints()):8<$F.length&&($F=$w.scanPList($F)),$F;},$R._switchMatrix=function($R,$F){$F.concat($R),$F.copyTo($R);},$R._getPiePoints=function($R,$F,$i,$j,$t){var $p=$J._tempPoints;$J._tempPoints.length=0,$p.push($R,$F);var $$=($t-$j)%(2*Math.PI)/10,$V=NaN,$N=$j;for($V=0;$V<=10;$V++)$p.push($R+$i*Math.cos($N),$F+$i*Math.sin($N)),$N+=$$;return $p;},$R._getPathPoints=function($R){var $F,$i,$j=0,$t=$J._tempPoints;for($t.length=0,$F=$R.length,$j=0;$j<$F;$j++)1<($i=$R[$j]).length&&($t.push($i[1],$i[2]),3<$i.length&&$t.push($i[3],$i[4]));return $t;},$J._addPointArrToRst=function($R,$F,$i,$j,$t){void 0===$j&&($j=0),void 0===$t&&($t=0);var $p,$$=0;for($p=$F.length,$$=0;$$<$p;$$+=2)$J._addPointToRst($R,$F[$$]+$j,$F[$$+1]+$t,$i);},$J._addPointToRst=function($R,$F,$i,$j){var $t=$_.TEMP;$t.setTo($F||0,$i||0),$j.transformPoint($t),$R.push($t.x,$t.y);},$J._tempPoints=[],$J._tempMatrixArrays=[],$J._tempCmds=[],$N($J,["_tempMatrix",function(){return this._tempMatrix=new $Y();},"_initMatrix",function(){return this._initMatrix=new $Y();}]),$J;}(),$p=function(){function $R(){}$x($R,"laya.events.Event");var $F=$R.prototype;return $F.setTo=function($R,$F,$i){return this.type=$R,this.currentTarget=$F,this.target=$i,this;},$F.stopPropagation=function(){this._stoped=!0;},$q(0,$F,"stageY",function(){return $H.stage.mouseY;}),$q(0,$F,"charCode",function(){return this.nativeEvent.charCode;}),$q(0,$F,"touches",function(){var $R=this.nativeEvent.touches;if($R)for(var $F=$H.stage,$i=0,$j=$R.length;$i<$j;$i++){var $t=$R[$i],$p=$_.TEMP;$p.setTo($t.clientX,$t.clientY),$F._canvasTransform.invertTransformPoint($p),$F.transform.invertTransformPoint($p),$t.stageX=$p.x,$t.stageY=$p.y;}return $R;}),$q(0,$F,"keyLocation",function(){return this.nativeEvent.keyLocation;}),$q(0,$F,"ctrlKey",function(){return this.nativeEvent.ctrlKey;}),$q(0,$F,"altKey",function(){return this.nativeEvent.altKey;}),$q(0,$F,"shiftKey",function(){return this.nativeEvent.shiftKey;}),$q(0,$F,"stageX",function(){return $H.stage.mouseX;}),$R.EMPTY=new $R(),$R.MOUSE_DOWN="mousedown",$R.MOUSE_UP="mouseup",$R.CLICK="click",$R.RIGHT_MOUSE_DOWN="rightmousedown",$R.RIGHT_MOUSE_UP="rightmouseup",$R.RIGHT_CLICK="rightclick",$R.MOUSE_MOVE="mousemove",$R.MOUSE_OVER="mouseover",$R.MOUSE_OUT="mouseout",$R.MOUSE_WHEEL="mousewheel",$R.ROLL_OVER="mouseover",$R.ROLL_OUT="mouseout",$R.DOUBLE_CLICK="doubleclick",$R.CHANGE="change",$R.CHANGED="changed",$R.RESIZE="resize",$R.ADDED="added",$R.REMOVED="removed",$R.DISPLAY="display",$R.UNDISPLAY="undisplay",$R.ERROR="error",$R.COMPLETE="complete",$R.LOADED="loaded",$R.INITED="inited",$R.PROGRESS="progress",$R.INPUT="input",$R.RENDER="render",$R.OPEN="open",$R.MESSAGE="message",$R.CLOSE="close",$R.KEY_DOWN="keydown",$R.KEY_PRESS="keypress",$R.KEY_UP="keyup",$R.FRAME="enterframe",$R.DRAG_START="dragstart",$R.DRAG_MOVE="dragmove",$R.DRAG_END="dragend",$R.ENTER="enter",$R.SELECT="select",$R.BLUR="blur",$R.FOCUS="focus",$R.VISIBILITY_CHANGE="visibilitychange",$R.FOCUS_CHANGE="focuschange",$R.PLAYED="played",$R.PAUSED="paused",$R.STOPPED="stopped",$R.START="start",$R.END="end",$R.ENABLE_CHANGED="enablechanged",$R.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",$R.COMPONENT_ADDED="componentadded",$R.COMPONENT_REMOVED="componentremoved",$R.LAYER_CHANGED="layerchanged",$R.HIERARCHY_LOADED="hierarchyloaded",$R.RECOVERED="recovered",$R.RELEASED="released",$R.LINK="link",$R.LABEL="label",$R.FULL_SCREEN_CHANGE="fullscreenchange",$R.DEVICE_LOST="devicelost",$R.MESH_CHANGED="meshchanged",$R.MATERIAL_CHANGED="materialchanged",$R.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",$R.ANIMATION_CHANGED="animationchanged",$R.TRIGGER_ENTER="triggerenter",$R.TRIGGER_STAY="triggerstay",$R.TRIGGER_EXIT="triggerexit",$R.TRAIL_FILTER_CHANGE="trailfilterchange",$R.DOMINO_FILTER_CHANGE="dominofilterchange",$R;}(),$s=(function(){function $R(){}$x($R,"laya.events.Keyboard"),$R.NUMBER_0=48,$R.NUMBER_1=49,$R.NUMBER_2=50,$R.NUMBER_3=51,$R.NUMBER_4=52,$R.NUMBER_5=53,$R.NUMBER_6=54,$R.NUMBER_7=55,$R.NUMBER_8=56,$R.NUMBER_9=57,$R.A=65,$R.B=66,$R.C=67,$R.D=68,$R.E=69,$R.F=70,$R.G=71,$R.H=72,$R.I=73,$R.J=74,$R.K=75,$R.L=76,$R.M=77,$R.N=78,$R.O=79,$R.P=80,$R.Q=81,$R.R=82,$R.S=83,$R.T=84,$R.U=85,$R.V=86,$R.W=87,$R.X=88,$R.Y=89,$R.Z=90,$R.F1=112,$R.F2=113,$R.F3=114,$R.F4=115,$R.F5=116,$R.F6=117,$R.F7=118,$R.F8=119,$R.F9=120,$R.F10=121,$R.F11=122,$R.F12=123,$R.F13=124,$R.F14=125,$R.F15=126,$R.NUMPAD=21,$R.NUMPAD_0=96,$R.NUMPAD_1=97,$R.NUMPAD_2=98,$R.NUMPAD_3=99,$R.NUMPAD_4=100,$R.NUMPAD_5=101,$R.NUMPAD_6=102,$R.NUMPAD_7=103,$R.NUMPAD_8=104,$R.NUMPAD_9=105,$R.NUMPAD_ADD=107,$R.NUMPAD_DECIMAL=110,$R.NUMPAD_DIVIDE=111,$R.NUMPAD_ENTER=108,$R.NUMPAD_MULTIPLY=106,$R.NUMPAD_SUBTRACT=109,$R.SEMICOLON=186,$R.EQUAL=187,$R.COMMA=188,$R.MINUS=189,$R.PERIOD=190,$R.SLASH=191,$R.BACKQUOTE=192,$R.LEFTBRACKET=219,$R.BACKSLASH=220,$R.RIGHTBRACKET=221,$R.QUOTE=222,$R.ALTERNATE=18,$R.BACKSPACE=8,$R.CAPS_LOCK=20,$R.COMMAND=15,$R.CONTROL=17,$R.DELETE=46,$R.ENTER=13,$R.ESCAPE=27,$R.PAGE_UP=33,$R.PAGE_DOWN=34,$R.END=35,$R.HOME=36,$R.LEFT=37,$R.UP=38,$R.RIGHT=39,$R.DOWN=40,$R.SHIFT=16,$R.SPACE=32,$R.TAB=9,$R.INSERT=45;}(),function(){function $t(){}return $x($t,"laya.events.KeyBoardManager"),$t.__init__=function(){$t._addEvent("keydown"),$t._addEvent("keypress"),$t._addEvent("keyup");},$t._addEvent=function($F){$b.document.addEventListener($F,function($R){laya.events.KeyBoardManager._dispatch($R,$F);},!0);},$t._dispatch=function($R,$F){if($t.enabled){$t._event._stoped=!1,$t._event.nativeEvent=$R,$t._event.keyCode=$R.keyCode||$R.which||$R.charCode,"keydown"===$F?$t._pressKeys[$t._event.keyCode]=!0:"keyup"===$F&&($t._pressKeys[$t._event.keyCode]=null);for(var $i=$H.stage.focus&&null!=$H.stage.focus.event&&$H.stage.focus.displayedInStage?$H.stage.focus:$H.stage,$j=$i;$j;)$j.event($F,$t._event.setTo($F,$j,$i)),$j=$j.parent;}},$t.hasKeyDown=function($R){return $t._pressKeys[$R];},$t._pressKeys={},$t.enabled=!0,$N($t,["_event",function(){return this._event=new $p();}]),$t;}()),$S=(function(){function $R(){}$x($R,"laya.events.KeyLocation"),$R.STANDARD=0,$R.LEFT=1,$R.RIGHT=2,$R.NUM_PAD=3;}(),function(){function $q(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=$b.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new $p(),this._matrix=new $Y(),this._point=new $_(),this._rect=new $T(),this._prePoint=new $_(),this._curTouchID=NaN;}$x($q,"laya.events.MouseManager");var $R=$q.prototype;return $R.__init__=function($R,$F){var $i=this;this._stage=$R;var $j=this,$t=this._eventList;$F.oncontextmenu=function($R){if($q.enabled)return!1;},$F.addEventListener("mousedown",function($R){$q.enabled&&($b.onIE||$R.preventDefault(),$t.push($R),$j.mouseDownTime=$b.now());}),$F.addEventListener("mouseup",function($R){$q.enabled&&($R.preventDefault(),$t.push($R),$j.mouseDownTime=-$b.now());},!0),$F.addEventListener("mousemove",function($R){if($q.enabled){$R.preventDefault();var $F=$b.now();if($F-$j._lastMoveTimer<10)return;$j._lastMoveTimer=$F,$t.push($R);}},!0),$F.addEventListener("mouseout",function($R){$q.enabled&&$t.push($R);}),$F.addEventListener("mouseover",function($R){$q.enabled&&$t.push($R);}),$F.addEventListener("touchstart",function($R){$q.enabled&&($t.push($R),$q._isFirstTouch||$wR.isInputting||$R.preventDefault(),$j.mouseDownTime=$b.now());}),$F.addEventListener("touchend",function($R){$q.enabled?($q._isFirstTouch||$wR.isInputting||$R.preventDefault(),$q._isFirstTouch=!1,$t.push($R),$j.mouseDownTime=-$b.now()):$i._curTouchID=NaN;},!0),$F.addEventListener("touchmove",function($R){$q.enabled&&($R.preventDefault(),$t.push($R));},!0),$F.addEventListener("touchcancel",function($R){$q.enabled?($R.preventDefault(),$t.push($R)):$i._curTouchID=NaN;},!0),$F.addEventListener("mousewheel",function($R){$q.enabled&&$t.push($R);}),$F.addEventListener("DOMMouseScroll",function($R){$q.enabled&&$t.push($R);});},$R.initEvent=function($R,$F){var $i;this._event._stoped=!1,this._event.nativeEvent=$F||$R,this._target=null,this._point.setTo($R.pageX||$R.clientX,$R.pageY||$R.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=$R.identifier||0,this._tTouchID=this._event.touchId,($i=$a.I._event)._stoped=!1,$i.nativeEvent=this._event.nativeEvent,$i.touchId=this._event.touchId;},$R.checkMouseWheel=function($R){this._event.delta=$R.wheelDelta?.025*$R.wheelDelta:-$R.detail;for(var $F=$a.I.getLastOvers(),$i=0,$j=$F.length;$i<$j;$i++){var $t=$F[$i];$t.event("mousewheel",this._event.setTo("mousewheel",$t,this._target));}},$R.onMouseMove=function($R){$a.I.onMouseMove($R,this._tTouchID);},$R.onMouseDown=function($R){if($wR.isInputting&&$H.stage.focus&&$H.stage.focus.focus&&!$H.stage.focus.contains(this._target)){var $F=$H.stage.focus._tf||$H.stage.focus,$i=$R._tf||$R;$i instanceof laya.display.Input&&$i.multiline==$F.multiline?$F._focusOut():$F.focus=!1;}$a.I.onMouseDown($R,this._tTouchID,this._isLeftMouse);},$R.onMouseUp=function($R){$a.I.onMouseUp($R,this._tTouchID,this._isLeftMouse);},$R.check=function($R,$F,$i,$j){this._point.setTo($F,$i),$R.fromParentPoint(this._point),$F=this._point.x,$i=this._point.y;var $t=$R.scrollRect;if($t&&(this._rect.setTo($t.x,$t.y,$t.width,$t.height),!this._rect.contains($F,$i)))return!1;if(!this.disableMouseEvent){if($R.hitTestPrior&&!$R.mouseThrough&&!this.hitTest($R,$F,$i))return!1;for(var $p=$R._childs.length-1;-1<$p;$p--){var $$=$R._childs[$p];if(!$$.destroyed&&$$.mouseEnabled&&$$.visible&&this.check($$,$F,$i,$j))return!0;}}var $V=!(!$R.hitTestPrior||$R.mouseThrough||this.disableMouseEvent)||this.hitTest($R,$F,$i);return $V?(this._target=$R,$j.call(this,$R)):$j===this.onMouseUp&&$R===this._stage&&(this._target=this._stage,$j.call(this,this._target)),$V;},$R.hitTest=function($R,$F,$i){var $j=!1;if($R.scrollRect&&($F-=$R.scrollRect.x,$i-=$R.scrollRect.y),$R.hitArea instanceof laya.utils.HitArea)return $R.hitArea.isHit($F,$i);if(0<$R.width&&0<$R.height||$R.mouseThrough||$R.hitArea)if($R.mouseThrough)$j=$R.getGraphicBounds().contains($F,$i);else{var $t=this._rect;$R.hitArea?$t=$R.hitArea:$t.setTo(0,0,$R.width,$R.height),$j=$t.contains($F,$i);}return $j;},$R.runEvent=function(){var $R=this._eventList.length;if($R){var $F=this;$F.mouseEventTime=$b.now();var $i,$j=0,$t=0,$p=0;try{for(;$j<$R;){var $$=this._eventList[$j];switch("mousemove"!==$$.type&&(this._prePoint.x=this._prePoint.y=-1e6),$$.type){case"mousedown":this._touchIDs[0]=this._id++,$q._isTouchRespond?$q._isTouchRespond=!1:($F._isLeftMouse=0===$$.button,$F.initEvent($$),$F.check($F._stage,$F.mouseX,$F.mouseY,$F.onMouseDown));break;case"mouseup":$F._isLeftMouse=0===$$.button,$F.initEvent($$),$F.check($F._stage,$F.mouseX,$F.mouseY,$F.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-$$.clientX)+Math.abs(this._prePoint.y-$$.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=$$.clientX,this._prePoint.y=$$.clientY,$F.initEvent($$),$F.check($F._stage,$F.mouseX,$F.mouseY,$F.onMouseMove));break;case"touchstart":$q._isTouchRespond=!0,$F._isLeftMouse=!0;var $V=$$.changedTouches;for($t=0,$p=$V.length;$t<$p;$t++)$i=$V[$t],($q.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=$i.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[$i.identifier]=this._id++,$F.initEvent($i,$$),$F.check($F._stage,$F.mouseX,$F.mouseY,$F.onMouseDown));break;case"touchend":case"touchcancel":$q._isTouchRespond=!0,$F._isLeftMouse=!0;var $N=$$.changedTouches;for($t=0,$p=$N.length;$t<$p;$t++)if($i=$N[$t],$q.multiTouchEnabled||$i.identifier==this._curTouchID){this._curTouchID=NaN,$F.initEvent($i,$$);$F.check($F._stage,$F.mouseX,$F.mouseY,$F.onMouseUp)||$F.onMouseUp(null);}break;case"touchmove":var $c=$$.changedTouches;for($t=0,$p=$c.length;$t<$p;$t++)$i=$c[$t],($q.multiTouchEnabled||$i.identifier==this._curTouchID)&&($F.initEvent($i,$$),$F.check($F._stage,$F.mouseX,$F.mouseY,$F.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":$F.checkMouseWheel($$);break;case"mouseout":$a.I.stageMouseOut();break;case"mouseover":$F._stage.event("mouseover",$F._event.setTo("mouseover",$F._stage,$F._stage));}$j++;}}catch($R){throw this._eventList.length=0,$R;}this._eventList.length=0;}},$q.enabled=!0,$q.multiTouchEnabled=!0,$q._isTouchRespond=!1,$q._isFirstTouch=!0,$N($q,["instance",function(){return this.instance=new $q();}]),$q;}()),$a=function(){function $S(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new $p();}$x($S,"laya.events.TouchManager");var $R=$S.prototype;return $R._clearTempArrs=function(){$S._oldArr.length=0,$S._newArr.length=0,$S._tEleArr.length=0;},$R.getTouchFromArr=function($R,$F){var $i,$j,$t=0;for($i=$F.length,$t=0;$t<$i;$t++)if(($j=$F[$t]).id==$R)return $j;return null;},$R.removeTouchFromArr=function($R,$F){var $i=0;for($i=$F.length-1;0<=$i;$i--)$F[$i].id==$R&&$F.splice($i,1);},$R.createTouchO=function($R,$F){var $i;return($i=$n.getItem("TouchData")||{}).id=$F,$i.tar=$R,$i;},$R.onMouseDown=function($R,$F,$i){var $j,$t,$p,$$;(void 0===$i&&($i=!1),this.enable)&&($j=this.getTouchFromArr($F,this.preOvers),$p=this.getEles($R,null,$S._tEleArr),$j?$j.tar=$R:($t=this.createTouchO($R,$F),this.preOvers.push($t)),$b.onMobile&&this.sendEvents($p,"mouseover",$F),$$=$i?this.preDowns:this.preRightDowns,($j=this.getTouchFromArr($F,$$))?$j.tar=$R:($t=this.createTouchO($R,$F),$$.push($t)),this.sendEvents($p,$i?"mousedown":"rightmousedown",$F),this._clearTempArrs());},$R.sendEvents=function($R,$F,$i){void 0===$i&&($i=0);var $j,$t,$p,$$=0;for($j=$R.length,this._event._stoped=!1,$t=$R[0],$$=0;$$<$j;$$++){if(($p=$R[$$]).destroyed)return;if($p.event($F,this._event.setTo($F,$p,$t)),this._event._stoped)break;}},$R.getEles=function($R,$F,$i){for($i?$i.length=0:$i=[];$R&&$R!=$F;)$i.push($R),$R=$R.parent;return $i;},$R.checkMouseOutAndOverOfMove=function($R,$F,$i){if(void 0===$i&&($i=0),$F!=$R){var $j,$t,$p=0,$$=0;if($F.contains($R))$t=this.getEles($R,$F,$S._tEleArr),this.sendEvents($t,"mouseover",$i);else if($R.contains($F))$t=this.getEles($F,$R,$S._tEleArr),this.sendEvents($t,"mouseout",$i);else{var $V,$N;($t=$S._tEleArr).length=0,$V=this.getEles($F,null,$S._oldArr),$N=this.getEles($R,null,$S._newArr),$$=$V.length;var $c=0;for($p=0;$p<$$;$p++){if($j=$V[$p],0<=($c=$N.indexOf($j))){$N.splice($c,$N.length-$c);break;}$t.push($j);}0<$t.length&&this.sendEvents($t,"mouseout",$i),0<$N.length&&this.sendEvents($N,"mouseover",$i);}}},$R.onMouseMove=function($R,$F){var $i,$j;this.enable&&(($i=this.getTouchFromArr($F,this.preOvers))?(this.checkMouseOutAndOverOfMove($R,$i.tar),$i.tar=$R,$j=this.getEles($R,null,$S._tEleArr)):($j=this.getEles($R,null,$S._tEleArr),this.sendEvents($j,"mouseover",$F),this.preOvers.push(this.createTouchO($R,$F))),this.sendEvents($j,"mousemove",$F),this._clearTempArrs());},$R.getLastOvers=function(){return($S._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,$S._tEleArr):($S._tEleArr.push($H.stage),$S._tEleArr);},$R.stageMouseOut=function(){var $R;$R=this.getLastOvers(),this.preOvers.length=0,this.sendEvents($R,"mouseout",0);},$R.onMouseUp=function($R,$F,$i){if(void 0===$i&&($i=!1),this.enable){var $j,$t,$p,$$,$V,$N,$c=0,$q=0,$s=$b.onMobile;if($t=this.getEles($R,null,$S._tEleArr),this.sendEvents($t,$i?"mouseup":"rightmouseup",$F),$N=$i?this.preDowns:this.preRightDowns,$j=this.getTouchFromArr($F,$N)){var $k,$h=$b.now();if($k=$h-this._lastClickTime<300,this._lastClickTime=$h,$R==$j.tar)$V=$t;else for($p=this.getEles($j.tar,null,$S._oldArr),($V=$S._newArr).length=0,$q=$p.length,$c=0;$c<$q;$c++)$$=$p[$c],0<=$t.indexOf($$)&&$V.push($$);0<$V.length&&this.sendEvents($V,$i?"click":"rightclick",$F),$i&&$k&&this.sendEvents($V,"doubleclick",$F),this.removeTouchFromArr($F,$N),$j.tar=null,$n.recover("TouchData",$j);}else;($j=this.getTouchFromArr($F,this.preOvers))&&$s&&(($V=this.getEles($j.tar,null,$V))&&0<$V.length&&this.sendEvents($V,"mouseout",$F),this.removeTouchFromArr($F,this.preOvers),$j.tar=null,$n.recover("TouchData",$j)),this._clearTempArrs();}},$S._oldArr=[],$S._newArr=[],$S._tEleArr=[],$N($S,["I",function(){return this.I=new $S();}]),$S;}(),$m=function(){function $R(){this._action=null;}$x($R,"laya.filters.Filter");var $F=$R.prototype;return $H.imps($F,{"laya.filters.IFilter":!0}),$F.callNative=function($R){},$q(0,$F,"type",function(){return-1;}),$q(0,$F,"action",function(){return this._action;}),$R.BLUR=16,$R.COLOR=32,$R.GLOW=8,$R._filterStart=null,$R._filterEnd=null,$R._EndTarget=null,$R._recycleScope=null,$R._filter=null,$R._useSrc=null,$R._endSrc=null,$R._useOut=null,$R._endOut=null,$R;}(),$J=function(){function $R(){this.data=null;}$x($R,"laya.filters.ColorFilterAction");var $F=$R.prototype;return $H.imps($F,{"laya.filters.IFilterAction":!0}),$F.apply=function($R){var $F=$R.ctx.ctx,$i=$R.ctx.ctx.canvas;if(0==$i.width||0==$i.height)return $i;for(var $j,$t=$F.getImageData(0,0,$i.width,$i.height),$p=$t.data,$$=0,$V=$p.length;$$<$V;$$+=4)$j=this.getColor($p[$$],$p[$$+1],$p[$$+2],$p[$$+3]),0!=$p[$$+3]&&($p[$$]=$j[0],$p[$$+1]=$j[1],$p[$$+2]=$j[2],$p[$$+3]=$j[3]);return $F.putImageData($t,0,0),$R;},$F.getColor=function($R,$F,$i,$j){var $t=[];if(this.data._mat&&this.data._alpha){var $p=this.data._mat,$$=this.data._alpha;$t[0]=$p[0]*$R+$p[1]*$F+$p[2]*$i+$p[3]*$j+$$[0],$t[1]=$p[4]*$R+$p[5]*$F+$p[6]*$i+$p[7]*$j+$$[1],$t[2]=$p[8]*$R+$p[9]*$F+$p[10]*$i+$p[11]*$j+$$[2],$t[3]=$p[12]*$R+$p[13]*$F+$p[14]*$i+$p[15]*$j+$$[3];}return $t;},$R;}(),$d=(function(){function $R(){}$x($R,"laya.maths.Arith"),$R.formatR=function($R){return $R>Math.PI&&($R-=2*Math.PI),$R<-Math.PI&&($R+=2*Math.PI),$R;},$R.isPOT=function($R,$F){return 0<$R&&0==($R&$R-1)&&0<$F&&0==($F&$F-1);},$R.setMatToArray=function($R,$F){$R.a,$R.b,$R.c,$R.d,$R.tx,$R.ty,$F[0]=$R.a,$F[1]=$R.b,$F[4]=$R.c,$F[5]=$R.d,$F[12]=$R.tx,$F[13]=$R.ty;};}(),function(){function $R(){this._controlPoints=[new $_(),new $_(),new $_()],this._calFun=this.getPoint2;}$x($R,"laya.maths.Bezier");var $F=$R.prototype;return $F._switchPoint=function($R,$F){var $i=this._controlPoints.shift();$i.setTo($R,$F),this._controlPoints.push($i);},$F.getPoint2=function($R,$F){var $i=this._controlPoints[0],$j=this._controlPoints[1],$t=this._controlPoints[2],$p=Math.pow(1-$R,2)*$i.x+2*$R*(1-$R)*$j.x+Math.pow($R,2)*$t.x,$$=Math.pow(1-$R,2)*$i.y+2*$R*(1-$R)*$j.y+Math.pow($R,2)*$t.y;$F.push($p,$$);},$F.getPoint3=function($R,$F){var $i=this._controlPoints[0],$j=this._controlPoints[1],$t=this._controlPoints[2],$p=this._controlPoints[3],$$=Math.pow(1-$R,3)*$i.x+3*$j.x*$R*(1-$R)*(1-$R)+3*$t.x*$R*$R*(1-$R)+$p.x*Math.pow($R,3),$V=Math.pow(1-$R,3)*$i.y+3*$j.y*$R*(1-$R)*(1-$R)+3*$t.y*$R*$R*(1-$R)+$p.y*Math.pow($R,3);$F.push($$,$V);},$F.insertPoints=function($R,$F){var $i,$j=NaN;for($i=1/($R=0<$R?$R:5),$j=0;$j<=1;$j+=$i)this._calFun($j,$F);},$F.getBezierPoints=function($R,$F,$i){void 0===$F&&($F=5),void 0===$i&&($i=2);var $j,$t,$p=0;if(($j=$R.length)<2*($i+1))return[];switch($t=[],$i){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[];}for(;this._controlPoints.length<=$i;)this._controlPoints.push(new $_());for($p=0;$p<2*$i;$p+=2)this._switchPoint($R[$p],$R[$p+1]);for($p=2*$i;$p<$j;$p+=2)this._switchPoint($R[$p],$R[$p+1]),$p/2%$i==0&&this.insertPoints($F,$t);return $t;},$N($R,["I",function(){return this.I=new $R();}]),$R;}()),$w=function(){function $c(){}return $x($c,"laya.maths.GrahamScan"),$c.multiply=function($R,$F,$i){return($R.x-$i.x)*($F.y-$i.y)-($F.x-$i.x)*($R.y-$i.y);},$c.dis=function($R,$F){return($R.x-$F.x)*($R.x-$F.x)+($R.y-$F.y)*($R.y-$F.y);},$c._getPoints=function($R,$F,$i){for(void 0===$F&&($F=!1),$c._mPointList||($c._mPointList=[]);$c._mPointList.length<$R;)$c._mPointList.push(new $_());return $i||($i=[]),$i.length=0,$F?$c.getFrom($i,$c._mPointList,$R):$c.getFromR($i,$c._mPointList,$R),$i;},$c.getFrom=function($R,$F,$i){var $j=0;for($j=0;$j<$i;$j++)$R.push($F[$j]);return $R;},$c.getFromR=function($R,$F,$i){var $j=0;for($j=0;$j<$i;$j++)$R.push($F.pop());return $R;},$c.pListToPointList=function($R,$F){void 0===$F&&($F=!1);var $i=0,$j=$R.length/2,$t=$c._getPoints($j,$F,$c._tempPointList);for($i=0;$i<$j;$i++)$t[$i].setTo($R[$i+$i],$R[$i+$i+1]);return $t;},$c.pointListToPlist=function($R){var $F,$i=0,$j=$R.length,$t=$c._temPList;for($i=$t.length=0;$i<$j;$i++)$F=$R[$i],$t.push($F.x,$F.y);return $t;},$c.scanPList=function($R){return $P.copyArray($R,$c.pointListToPlist($c.scan($c.pListToPointList($R,!0))));},$c.scan=function($R){var $F,$i,$j,$t=0,$p=0,$$=0,$V=$R.length,$N={};for(($i=$c._temArr).length=0,$t=($V=$R.length)-1;0<=$t;$t--)$j=($F=$R[$t]).x+"_"+$F.y,$N.hasOwnProperty($j)||($N[$j]=!0,$i.push($F));for($V=$i.length,$P.copyArray($R,$i),$t=1;$t<$V;$t++)($R[$t].y<$R[$$].y||$R[$t].y==$R[$$].y&&$R[$t].x<$R[$$].x)&&($$=$t);for($F=$R[0],$R[0]=$R[$$],$R[$$]=$F,$t=1;$t<$V-1;$t++){for($p=($$=$t)+1;$p<$V;$p++)(0<$c.multiply($R[$p],$R[$$],$R[0])||0==$c.multiply($R[$p],$R[$$],$R[0])&&$c.dis($R[0],$R[$p])<$c.dis($R[0],$R[$$]))&&($$=$p);$F=$R[$t],$R[$t]=$R[$$],$R[$$]=$F;}if(($i=$c._temArr).length=0,$R.length<3)return $P.copyArray($i,$R);for($i.push($R[0],$R[1],$R[2]),$t=3;$t<$V;$t++){for(;2<=$i.length&&0<=$c.multiply($R[$t],$i[$i.length-1],$i[$i.length-2]);)$i.pop();$R[$t]&&$i.push($R[$t]);}return $i;},$c._mPointList=null,$c._tempPointList=[],$c._temPList=[],$c._temArr=[],$c;}(),$X=function(){function $t(){}return $x($t,"laya.maths.MathUtil"),$t.subtractVector3=function($R,$F,$i){$i[0]=$R[0]-$F[0],$i[1]=$R[1]-$F[1],$i[2]=$R[2]-$F[2];},$t.lerp=function($R,$F,$i){return $R*(1-$i)+$F*$i;},$t.scaleVector3=function($R,$F,$i){$i[0]=$R[0]*$F,$i[1]=$R[1]*$F,$i[2]=$R[2]*$F;},$t.lerpVector3=function($R,$F,$i,$j){var $t=$R[0],$p=$R[1],$$=$R[2];$j[0]=$t+$i*($F[0]-$t),$j[1]=$p+$i*($F[1]-$p),$j[2]=$$+$i*($F[2]-$$);},$t.lerpVector4=function($R,$F,$i,$j){var $t=$R[0],$p=$R[1],$$=$R[2],$V=$R[3];$j[0]=$t+$i*($F[0]-$t),$j[1]=$p+$i*($F[1]-$p),$j[2]=$$+$i*($F[2]-$$),$j[3]=$V+$i*($F[3]-$V);},$t.slerpQuaternionArray=function($R,$F,$i,$j,$t,$p,$$){var $V,$N,$c,$q,$s,$k=$R[$F+0],$h=$R[$F+1],$S=$R[$F+2],$x=$R[$F+3],$a=$i[$j+0],$m=$i[$j+1],$M=$i[$j+2],$J=$i[$j+3];return($N=$k*$a+$h*$m+$S*$M+$x*$J)<0&&($N=-$N,$a=-$a,$m=-$m,$M=-$M,$J=-$J),$s=1e-6<1-$N?($V=Math.acos($N),$c=Math.sin($V),$q=Math.sin((1-$t)*$V)/$c,Math.sin($t*$V)/$c):($q=1-$t,$t),$p[$$+0]=$q*$k+$s*$a,$p[$$+1]=$q*$h+$s*$m,$p[$$+2]=$q*$S+$s*$M,$p[$$+3]=$q*$x+$s*$J,$p;},$t.getRotation=function($R,$F,$i,$j){return Math.atan2($j-$F,$i-$R)/Math.PI*180;},$t.sortBigFirst=function($R,$F){return $R==$F?0:$R<$F?1:-1;},$t.sortSmallFirst=function($R,$F){return $R==$F?0:$R<$F?-1:1;},$t.sortNumBigFirst=function($R,$F){return parseFloat($F)-parseFloat($R);},$t.sortNumSmallFirst=function($R,$F){return parseFloat($R)-parseFloat($F);},$t.sortByKey=function($i,$R,$F){var $j;return void 0===$R&&($R=!1),void 0===$F&&($F=!0),$j=$R?$F?$t.sortNumBigFirst:$t.sortBigFirst:$F?$t.sortNumSmallFirst:$t.sortSmallFirst,function($R,$F){return $j($R[$i],$F[$i]);};},$t;}(),$Y=function(){function $i($R,$F,$i,$j,$t,$p){this.inPool=!1,this.bTransform=!1,void 0===$R&&($R=1),void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=1),void 0===$t&&($t=0),void 0===$p&&($p=0),this.a=$R,this.b=$F,this.c=$i,this.d=$j,this.tx=$t,this.ty=$p,this._checkTransform();}$x($i,"laya.maths.Matrix");var $R=$i.prototype;return $R.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this;},$R._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d;},$R.setTranslate=function($R,$F){return this.tx=$R,this.ty=$F,this;},$R.translate=function($R,$F){return this.tx+=$R,this.ty+=$F,this;},$R.scale=function($R,$F){this.a*=$R,this.d*=$F,this.c*=$R,this.b*=$F,this.tx*=$R,this.ty*=$F,this.bTransform=!0;},$R.rotate=function($R){var $F=Math.cos($R),$i=Math.sin($R),$j=this.a,$t=this.c,$p=this.tx;this.a=$j*$F-this.b*$i,this.b=$j*$i+this.b*$F,this.c=$t*$F-this.d*$i,this.d=$t*$i+this.d*$F,this.tx=$p*$F-this.ty*$i,this.ty=$p*$i+this.ty*$F,this.bTransform=!0;},$R.skew=function($R,$F){var $i=Math.tan($R),$j=Math.tan($F),$t=this.a,$p=this.b;return this.a+=$j*this.c,this.b+=$j*this.d,this.c+=$i*$t,this.d+=$i*$p,this;},$R.invertTransformPoint=function($R){var $F=this.a,$i=this.b,$j=this.c,$t=this.d,$p=this.tx,$$=$F*$t-$i*$j,$V=$t/$$,$N=-$i/$$,$c=-$j/$$,$q=$F/$$,$s=($j*this.ty-$t*$p)/$$,$k=-($F*this.ty-$i*$p)/$$;return $R.setTo($V*$R.x+$c*$R.y+$s,$N*$R.x+$q*$R.y+$k);},$R.transformPoint=function($R){return $R.setTo(this.a*$R.x+this.c*$R.y+this.tx,this.b*$R.x+this.d*$R.y+this.ty);},$R.transformPointN=function($R){return $R.setTo(this.a*$R.x+this.c*$R.y,this.b*$R.x+this.d*$R.y);},$R.transformPointArray=function($R,$F){for(var $i=$R.length,$j=0;$j<$i;$j+=2){var $t=$R[$j],$p=$R[$j+1];$F[$j]=this.a*$t+this.c*$p+this.tx,$F[$j+1]=this.b*$t+this.d*$p+this.ty;}return $F;},$R.transformPointArrayScale=function($R,$F){for(var $i=$R.length,$j=0;$j<$i;$j+=2){var $t=$R[$j],$p=$R[$j+1];$F[$j]=this.a*$t+this.c*$p,$F[$j+1]=this.b*$t+this.d*$p;}return $F;},$R.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b);},$R.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d);},$R.invert=function(){var $R=this.a,$F=this.b,$i=this.c,$j=this.d,$t=this.tx,$p=$R*$j-$F*$i;return this.a=$j/$p,this.b=-$F/$p,this.c=-$i/$p,this.d=$R/$p,this.tx=($i*this.ty-$j*$t)/$p,this.ty=-($R*this.ty-$F*$t)/$p,this;},$R.setTo=function($R,$F,$i,$j,$t,$p){return this.a=$R,this.b=$F,this.c=$i,this.d=$j,this.tx=$t,this.ty=$p,this;},$R.concat=function($R){var $F=this.a,$i=this.c,$j=this.tx;return this.a=$F*$R.a+this.b*$R.c,this.b=$F*$R.b+this.b*$R.d,this.c=$i*$R.a+this.d*$R.c,this.d=$i*$R.b+this.d*$R.d,this.tx=$j*$R.a+this.ty*$R.c+$R.tx,this.ty=$j*$R.b+this.ty*$R.d+$R.ty,this;},$R.scaleEx=function($R,$F){var $i=this.a,$j=this.b,$t=this.c,$p=this.d;0!==$j||0!==$t?(this.a=$R*$i,this.b=$R*$j,this.c=$F*$t):(this.a=$R*$i,this.b=0*$p,this.c=0*$i),this.d=$F*$p,this.bTransform=!0;},$R.rotateEx=function($R){var $F=Math.cos($R),$i=Math.sin($R),$j=this.a,$t=this.b,$p=this.c,$$=this.d;0!==$t||0!==$p?(this.a=$F*$j+$i*$p,this.b=$F*$t+$i*$$,this.c=-$i*$j+$F*$p,this.d=-$i*$t+$F*$$):(this.a=$F*$j,this.b=$i*$$,this.c=-$i*$j,this.d=$F*$$),this.bTransform=!0;},$R.clone=function(){var $R=$i.create();return $R.a=this.a,$R.b=this.b,$R.c=this.c,$R.d=this.d,$R.tx=this.tx,$R.ty=this.ty,$R.bTransform=this.bTransform,$R;},$R.copyTo=function($R){return $R.a=this.a,$R.b=this.b,$R.c=this.c,$R.d=this.d,$R.tx=this.tx,$R.ty=this.ty,$R.bTransform=this.bTransform,$R;},$R.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty;},$R.destroy=function(){if(!this.inPool){var $R=$i._cache;this.inPool=!0,$R._length||($R._length=0),($R[$R._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1;}},$i.mul=function($R,$F,$i){var $j=$R.a,$t=$R.b,$p=$R.c,$$=$R.d,$V=$R.tx,$N=$R.ty,$c=$F.a,$q=$F.b,$s=$F.c,$k=$F.d,$h=$F.tx,$S=$F.ty;return 0!==$q||0!==$s?($i.a=$j*$c+$t*$s,$i.b=$j*$q+$t*$k,$i.c=$p*$c+$$*$s,$i.d=$p*$q+$$*$k,$i.tx=$c*$V+$s*$N+$h,$i.ty=$q*$V+$k*$N+$S):($i.a=$j*$c,$i.b=$t*$k,$i.c=$p*$c,$i.d=$$*$k,$i.tx=$c*$V+$h,$i.ty=$k*$N+$S),$i;},$i.mul16=function($R,$F,$i){var $j=$R.a,$t=$R.b,$p=$R.c,$$=$R.d,$V=$R.tx,$N=$R.ty,$c=$F.a,$q=$F.b,$s=$F.c,$k=$F.d,$h=$F.tx,$S=$F.ty;return 0!==$q||0!==$s?($i[0]=$j*$c+$t*$s,$i[1]=$j*$q+$t*$k,$i[4]=$p*$c+$$*$s,$i[5]=$p*$q+$$*$k,$i[12]=$c*$V+$s*$N+$h,$i[13]=$q*$V+$k*$N+$S):($i[0]=$j*$c,$i[1]=$t*$k,$i[4]=$p*$c,$i[5]=$$*$k,$i[12]=$c*$V+$h,$i[13]=$k*$N+$S),$i;},$i.mulPre=function($R,$F,$i,$j,$t,$p,$$,$V){var $N=$R.a,$c=$R.b,$q=$R.c,$s=$R.d,$k=$R.tx,$h=$R.ty;return 0!==$i||0!==$j?($V.a=$N*$F+$c*$j,$V.b=$N*$i+$c*$t,$V.c=$q*$F+$s*$j,$V.d=$q*$i+$s*$t,$V.tx=$F*$k+$j*$h+$p,$V.ty=$i*$k+$t*$h+$$):($V.a=$N*$F,$V.b=$c*$t,$V.c=$q*$F,$V.d=$s*$t,$V.tx=$F*$k+$p,$V.ty=$t*$h+$$),$V;},$i.mulPos=function($R,$F,$i,$j,$t,$p,$$,$V){var $N=$R.a,$c=$R.b,$q=$R.c,$s=$R.d,$k=$R.tx,$h=$R.ty;return 0!==$c||0!==$q?($V.a=$F*$N+$i*$q,$V.b=$F*$c+$i*$s,$V.c=$j*$N+$t*$q,$V.d=$j*$c+$t*$s,$V.tx=$N*$p+$q*$$+$k,$V.ty=$c*$p+$s*$$+$h):($V.a=$F*$N,$V.b=$i*$s,$V.c=$j*$N,$V.d=$t*$s,$V.tx=$N*$p+$k,$V.ty=$s*$$+$h),$V;},$i.preMul=function($R,$F,$i){var $j=$R.a,$t=$R.b,$p=$R.c,$$=$R.d,$V=$F.a,$N=$F.b,$c=$F.c,$q=$F.d,$s=$F.tx,$k=$F.ty;return $i.a=$V*$j,$i.b=$i.c=0,$i.d=$q*$$,$i.tx=$s*$j+$R.tx,$i.ty=$k*$$+$R.ty,0===$N&&0===$c&&0===$t&&0===$p||($i.a+=$N*$p,$i.d+=$c*$t,$i.b+=$V*$t+$N*$$,$i.c+=$c*$j+$q*$p,$i.tx+=$k*$p,$i.ty+=$s*$t),$i;},$i.preMulXY=function($R,$F,$i,$j){var $t=$R.a,$p=$R.b,$$=$R.c,$V=$R.d;return $j.a=$t,$j.b=$p,$j.c=$$,$j.d=$V,$j.tx=$F*$t+$R.tx+$i*$$,$j.ty=$i*$V+$R.ty+$F*$p,$j;},$i.create=function(){var $R=$i._cache,$F=$R._length?$R[--$R._length]:new $i();return $F.inPool=!1,$F;},$i.EMPTY=new $i(),$i.TEMP=new $i(),$i._cache=[],$i;}(),$_=function(){function $R($R,$F){void 0===$R&&($R=0),void 0===$F&&($F=0),this.x=$R,this.y=$F;}$x($R,"laya.maths.Point");var $F=$R.prototype;return $F.setTo=function($R,$F){return this.x=$R,this.y=$F,this;},$F.distance=function($R,$F){return Math.sqrt((this.x-$R)*(this.x-$R)+(this.y-$F)*(this.y-$F));},$F.toString=function(){return this.x+","+this.y;},$F.normalize=function(){var $R=Math.sqrt(this.x*this.x+this.y*this.y);if(0<$R){var $F=1/$R;this.x*=$F,this.y*=$F;}},$R.TEMP=new $R(),$R.EMPTY=new $R(),$R;}(),$T=function(){function $c($R,$F,$i,$j){void 0===$R&&($R=0),void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=0),this.x=$R,this.y=$F,this.width=$i,this.height=$j;}$x($c,"laya.maths.Rectangle");var $R=$c.prototype;return $R.setTo=function($R,$F,$i,$j){return this.x=$R,this.y=$F,this.width=$i,this.height=$j,this;},$R.copyFrom=function($R){return this.x=$R.x,this.y=$R.y,this.width=$R.width,this.height=$R.height,this;},$R.contains=function($R,$F){return!(this.width<=0||this.height<=0)&&$R>=this.x&&$R<this.right&&$F>=this.y&&$F<this.bottom;},$R.intersects=function($R){return!($R.x>this.x+this.width||$R.x+$R.width<this.x||$R.y>this.y+this.height||$R.y+$R.height<this.y);},$R.intersection=function($R,$F){return this.intersects($R)?($F||($F=new $c()),$F.x=Math.max(this.x,$R.x),$F.y=Math.max(this.y,$R.y),$F.width=Math.min(this.right,$R.right)-$F.x,$F.height=Math.min(this.bottom,$R.bottom)-$F.y,$F):null;},$R.union=function($R,$F){return $F||($F=new $c()),this.clone($F),$R.width<=0||$R.height<=0?$F:($F.addPoint($R.x,$R.y),$F.addPoint($R.right,$R.bottom),this);},$R.clone=function($R){return $R||($R=new $c()),$R.x=this.x,$R.y=this.y,$R.width=this.width,$R.height=this.height,$R;},$R.toString=function(){return this.x+","+this.y+","+this.width+","+this.height;},$R.equals=function($R){return!(!$R||$R.x!==this.x||$R.y!==this.y||$R.width!==this.width||$R.height!==this.height);},$R.addPoint=function($R,$F){return this.x>$R&&(this.width+=this.x-$R,this.x=$R),this.y>$F&&(this.height+=this.y-$F,this.y=$F),this.width<$R-this.x&&(this.width=$R-this.x),this.height<$F-this.y&&(this.height=$F-this.y),this;},$R._getBoundPoints=function(){var $R=$c._temB;return($R.length=0)==this.width||0==this.height||$R.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),$R;},$R.isEmpty=function(){return this.width<=0||this.height<=0;},$q(0,$R,"right",function(){return this.x+this.width;}),$q(0,$R,"bottom",function(){return this.y+this.height;}),$c._getBoundPointS=function($R,$F,$i,$j){var $t=$c._temA;return($t.length=0)==$i||0==$j||$t.push($R,$F,$R+$i,$F,$R,$F+$j,$R+$i,$F+$j),$t;},$c._getWrapRec=function($R,$F){if(!$R||$R.length<1)return $F?$F.setTo(0,0,0,0):$c.TEMP.setTo(0,0,0,0);$F=$F||new $c();var $i,$j,$t,$p,$$,$V=$R.length,$N=$_.TEMP;for($t=$$=-($j=$p=99999),$i=0;$i<$V;$i+=2)$N.x=$R[$i],$N.y=$R[$i+1],$j=$j<$N.x?$j:$N.x,$p=$p<$N.y?$p:$N.y,$t=$t>$N.x?$t:$N.x,$$=$$>$N.y?$$:$N.y;return $F.setTo($j,$p,$t-$j,$$-$p);},$c.EMPTY=new $c(),$c.TEMP=new $c(),$c._temB=[],$c._temA=[],$c;}(),$z=function(){function $N(){}return $x($N,"laya.media.SoundManager"),$q(1,$N,"useAudioMusic",function(){return $N._useAudioMusic;},function($R){$N._useAudioMusic=$R,$N._musicClass=$R?$iR:null;}),$q(1,$N,"autoStopMusic",function(){return $N._autoStopMusic;},function($R){$H.stage.off("blur",null,$N._stageOnBlur),$H.stage.off("focus",null,$N._stageOnFocus),$H.stage.off("visibilitychange",null,$N._visibilityChange),($N._autoStopMusic=$R)&&($H.stage.on("blur",null,$N._stageOnBlur),$H.stage.on("focus",null,$N._stageOnFocus),$H.stage.on("visibilitychange",null,$N._visibilityChange));}),$q(1,$N,"muted",function(){return $N._muted;},function($R){$R!=$N._muted&&($R&&$N.stopAllSound(),$N.musicMuted=$R,$N._muted=$R);}),$q(1,$N,"musicMuted",function(){return $N._musicMuted;},function($R){$R!=$N._musicMuted&&($R?($N._tMusic&&$N._musicChannel&&!$N._musicChannel.isStopped?$N._musicChannel.pause():$N._musicChannel=null,$N._musicMuted=$R):($N._musicMuted=$R,$N._tMusic&&$N._musicChannel&&$N._musicChannel.resume()));}),$q(1,$N,"soundMuted",function(){return $N._soundMuted;},function($R){$N._soundMuted=$R;}),$N.addChannel=function($R){0<=$N._channels.indexOf($R)||($N._channels.push($R),$N.autoReleaseSound&&0!=$N._notUsedCount&&$N._notUsedUrls[$R.url]&&(delete $N._notUsedUrls[$R.url],0==--$N._notUsedCount&&$H.timer.clear($N,$N.disposeSoundIfNotUsed)));},$N.removeChannel=function($R){var $F=$N._channels,$i=$F.indexOf($R);if(-1!=$i&&($F.splice($i,1),$N.autoReleaseSound)){var $j=$R.url,$t=$N.defaultIntervals[$j]||2e4;if(0<$t){var $p=!0;for($i=$F.length-1;0<=$i;$i--)if($F[$i].url==$j){$p=!1;break;}$p&&($N._notUsedUrls[$j]=Date.now()+$t,0==$N._notUsedCount++&&$H.timer.loop(1e4,$N,$N.disposeSoundIfNotUsed));}}},$N.disposeSoundIfNotUsed=function(){var $R=$N._notUsedUrls;if(0!=$N._notUsedCount){var $F=Date.now();for(var $i in $R)$F>=$R[$i]&&(delete $R[$i],--$N._notUsedCount,$N.destroySound($i));if(0!=$N._notUsedCount)return;}$H.timer.clear($N,$N.disposeSoundIfNotUsed);},$N._visibilityChange=function(){$H.stage.isVisibility?$N._stageOnFocus():$N._stageOnBlur();},$N._stageOnBlur=function(){$N._isActive=!1,$N._musicChannel&&($N._musicChannel.isStopped||($N._blurPaused=!0,$N._musicChannel.pause())),$N.stopAllSound(),$H.stage.once("mousedown",null,$N._stageOnFocus);},$N._recoverWebAudio=function(){$pR.ctx&&"running"!=$pR.ctx.state&&$pR.ctx.resume&&$pR.ctx.resume();},$N._stageOnFocus=function(){if($N._isActive=!0,$N._recoverWebAudio(),$H.stage.off("mousedown",null,$N._stageOnFocus),$N._blurPaused){var $R=$N._musicChannel;$R&&$N._music&&$R.isStopped&&($N._blurPaused=!1,$N._music._disposed?$N.playMusic($R.url,$R.loops,$R.startHandler,$R.completeHandler,$R.startTime):$R.audioBuffer?$R.resume():$N._music.play($R.startTime,$R.loops,$R.startHandler,$R));}},$N.playSound=function($R,$F,$i,$j,$t,$p){if(void 0===$F&&($F=1),void 0===$p&&($p=0),!$R)return null;if($N._muted)return null;if($N._recoverWebAudio(),$R==$N._tMusic){if($N._musicMuted)return null;}else{if(!$N._isActive)return null;if($N._soundMuted)return null;}var $$,$V=$N._pool[$R];return $t||($t=$N._soundClass),$V||(($V=new $t()).load($R),$N._pool[$R]=$V),($$=$V.play($p,$F,$i))?($R==$N._tMusic&&($N._music=$V,$N._isActive||($N._blurPaused=!0,$$.pause())),$$.url=$R,$$.volume=$R==$N._tMusic?$N.musicVolume:$N.soundVolume,$$.completeHandler=$j,$$):null;},$N.destroySound=function($R){var $F=$N._pool[$R];$F&&(delete $N._pool[$R],$F.dispose());},$N.playMusic=function($R,$F,$i,$j,$t){return void 0===$F&&($F=0),void 0===$t&&($t=0),$N._tMusic=$R,$N._musicChannel&&$N._musicChannel.stop(),$N._musicChannel=$N.playSound($R,$F,$i,$j,null,$t);},$N.stopSound=function($R){for(var $F,$i=$N._channels.length-1;0<=$i;$i--)($F=$N._channels[$i]).url==$R&&$F.stop();},$N.stopAll=function(){$N._tMusic=null;var $R=0;for($R=$N._channels.length-1;0<=$R;$R--)$N._channels[$R].stop();},$N.stopAllSound=function(){var $R,$F=0;for($F=$N._channels.length-1;0<=$F;$F--)($R=$N._channels[$F]).url!=$N._tMusic&&$R.stop();},$N.stopMusic=function(){$N._musicChannel&&$N._musicChannel.stop(),$N._tMusic=null;},$N.setSoundVolume=function($R,$F){if($F)$N._setVolume($F,$R);else{$N.soundVolume=$R;var $i,$j=0;for($j=$N._channels.length-1;0<=$j;$j--)($i=$N._channels[$j]).url!=$N._tMusic&&($i.volume=$R);}},$N.setMusicVolume=function($R){$N.musicVolume=$R,$N._setVolume($N._tMusic,$R);},$N._setVolume=function($R,$F){for(var $i,$j=$N._channels.length-1;0<=$j;$j--)($i=$N._channels[$j]).url==$R&&($i.volume=$F);},$N.musicVolume=1,$N.soundVolume=1,$N.playbackRate=1,$N._useAudioMusic=!0,$N._muted=!1,$N._soundMuted=!1,$N._musicMuted=!1,$N._tMusic=null,$N._musicChannel=null,$N._music=null,$N._channels=[],$N._autoStopMusic=!1,$N._blurPaused=!1,$N._isActive=!0,$N._soundClass=null,$N._musicClass=null,$N.autoReleaseSound=!0,$N._pool={},$N.defaultIntervals={},$N._notUsedUrls={},$N._notUsedCount=0,$N;}(),$g=function(){var $R;function $i(){}return $x($i,"laya.net.LocalStorage"),$i.__init__=function(){$i._baseClass||($i._baseClass=$R).init(),$i.items=$i._baseClass.items,$i.support=$i._baseClass.support;},$i.setItem=function($R,$F){$i._baseClass.setItem($R,$F);},$i.getItem=function($R){return $i._baseClass.getItem($R);},$i.setJSON=function($R,$F){$i._baseClass.setJSON($R,$F);},$i.getJSON=function($R){return $i._baseClass.getJSON($R);},$i.removeItem=function($R){$i._baseClass.removeItem($R);},$i.clear=function(){$i._baseClass.clear();},$i._baseClass=null,$i.items=null,$i.support=!1,$i.__init$=function(){$R=function(){function $i(){}return $x($i,""),$i.init=function(){try{$i.support=!0,$i.items=$$.localStorage,$i.setItem("laya","1"),$i.removeItem("laya");}catch($R){$i.support=!1;}$i.support||console.log("LocalStorage is not supprot or browser is private mode.");},$i.setItem=function($R,$F){try{$i.support&&$i.items.setItem($R,$F);}catch($R){console.warn("set localStorage failed",$R);}},$i.getItem=function($R){return $i.support?$i.items.getItem($R):null;},$i.setJSON=function($R,$F){try{$i.support&&$i.items.setItem($R,JSON.stringify($F));}catch($R){console.warn("set localStorage failed",$R);}},$i.getJSON=function($R){return JSON.parse($i.support?$i.items.getItem($R):null);},$i.removeItem=function($R){$i.support&&$i.items.removeItem($R);},$i.clear=function(){$i.support&&$i.items.clear();},$i.items=null,$i.support=!1,$i;}();},$i;}(),$f=(function(){function $j(){}$x($j,"laya.net.ResourceVersion"),$j.enable=function($R,$F,$i){void 0===$i&&($i=2),laya.net.ResourceVersion.type=$i,$H.loader.load($R,$M.create(null,$j.onManifestLoaded,[$F]),null,"json"),$Z.customFormat=$j.addVersionPrefix;},$j.onManifestLoaded=function($R,$F){$j.manifest=$F,$R.run(),$F||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。");},$j.addVersionPrefix=function($R){return $j.manifest&&$j.manifest[$R]?2==$j.type?$j.manifest[$R]:$j.manifest[$R]+"/"+$R:$R;},$j.FOLDER_VERSION=1,$j.FILENAME_VERSION=2,$j.manifest=null,$j.type=1;}(),function(){function $R(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null;}$x($R,"laya.net.TTFLoader");var $F=$R.prototype;return $F.load=function($R){var $F=(this._url=$R).split(".ttf")[0].split("/");this.fontName=$F[$F.length-1],$b.window.conch?this._loadConch():$b.window.FontFace?this._loadWithFontFace():this._loadWithCSS();},$F._loadConch=function(){this._http=new $$R(),this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer");},$F._onHttpLoaded=function($R){$b.window.conch.setFontFaceFromBuffer(this.fontName,$R),this._clearHttp(),this._complete();},$F._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null);},$F._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null);},$F._complete=function(){$H.timer.clear(this,this._complete),$H.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null);},$F._checkComplete=function(){$L.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete();},$F._loadWithFontFace=function(){var $R=new $b.window.FontFace(this.fontName,"url('"+this._url+"')");$b.window.document.fonts.add($R);var $F=this;$R.loaded.then(function(){$F._complete();}),$R.load();},$F._createDiv=function(){this._div=$b.createElement("div"),this._div.innerHTML="laya";var $R=this._div.style;$R.fontFamily=this.fontName,$R.position="absolute",$R.left="-100px",$R.top="-100px",$b.document.body.appendChild(this._div);},$F._loadWithCSS=function(){var $R=this,$F=$b.createElement("style");$F.type="text/css",$b.document.body.appendChild($F),$F.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=$L.measureText("LayaTTFFont",this._fontTxt).width;var $i=this;$F.onload=function(){$H.timer.once(1e4,$i,$R._complete);},$H.timer.loop(20,this,this._checkComplete),this._createDiv();},$R._testString="LayaTTFFont",$R;}()),$Z=function(){function $j($R){this._url=null,this._path=null,this._url=$j.formatURL($R),this._path=$j.getPath($R);}$x($j,"laya.net.URL");var $R=$j.prototype;return $q(0,$R,"path",function(){return this._path;}),$q(0,$R,"url",function(){return this._url;}),$j.formatURL=function($R,$F){if(!$R)return"null path";if(0<$R.indexOf(":"))return $R;null!=$j.customFormat&&($R=$j.customFormat($R,$F));var $i=$R.charAt(0);if("."===$i)return $j.formatRelativePath(($F||$j.basePath)+$R);if("~"===$i)return $j.rootPath+$R.substring(1);if("d"===$i){if(0===$R.indexOf("data:image"))return $R;}else if("/"===$i)return $R;return($F||$j.basePath)+$R;},$j.formatRelativePath=function($R){for(var $F=$R.split("/"),$i=0,$j=$F.length;$i<$j;$i++)".."==$F[$i]&&($F.splice($i-1,2),$i-=2);return $F.join("/");},$j.isAbsolute=function($R){return 0<$R.indexOf(":")||"/"==$R.charAt(0);},$j.getPath=function($R){var $F=$R.lastIndexOf("/");return 0<$F?$R.substr(0,$F+1):"";},$j.getFileName=function($R){var $F=$R.lastIndexOf("/");return 0<$F?$R.substr($F+1):$R;},$j.version={},$j.basePath="",$j.rootPath="",$j.customFormat=function($R){var $F=$j.version[$R];return!$u.isConchApp&&$F&&($R+="?v="+$F),$R;},$j;}(),$u=function(){function $t($R,$F){this._timeId=0;var $i=$t._mainCanvas.source.style;$i.position="absolute",$i.top=$i.left="0px",$i.background="#000000",$t._mainCanvas.source.id="layaCanvas";var $j=laya.renders.Render.isWebGL;$t._mainCanvas.source.width=$R,$t._mainCanvas.source.height=$F,$j&&$t.WebGL.init($t._mainCanvas,$R,$F),$b.container.appendChild($t._mainCanvas.source),($t._context=new $v($R,$F,$j?null:$t._mainCanvas)).ctx.setIsMainContext(),$b.window.requestAnimationFrame(function $R($F){$b.window.requestAnimationFrame($R);$H.stage._loop();}),$H.stage.on("visibilitychange",this,this._onVisibilitychange);}$x($t,"laya.renders.Render");var $R=$t.prototype;return $R._onVisibilitychange=function(){$H.stage.isVisibility?0!=this._timeId&&$b.window.clearInterval(this._timeId):this._timeId=$b.window.setInterval(this._enterFrame,1e3);},$R._enterFrame=function($R){$H.stage._loop();},$q(1,$t,"context",function(){return $t._context;}),$q(1,$t,"canvas",function(){return $t._mainCanvas.source;}),$t._context=null,$t._mainCanvas=null,$t.WebGL=null,$t.isConchNode=!1,$t.isConchApp=!1,$t.isConchWebGL=!1,$t.isWebGL=!1,$t.is3DMode=!1,$t.optimizeTextureMemory=function($R,$F){return!0;},$t.__init$=function(){$$.ConchRenderType=$$.ConchRenderType||1,$$.ConchRenderType|=$$.conch?4:0,$t.isConchNode=5==(5&$$.ConchRenderType),$t.isConchApp=4==(4&$$.ConchRenderType),$t.isConchWebGL=6==$$.ConchRenderType;},$t;}(),$v=function(){function $$($R,$F,$i){this.x=0,this.y=0,this._drawTexture=function($R,$F,$i){$i[0].loaded&&this.ctx.drawTexture($i[0],$i[1],$i[2],$i[3],$i[4],$R,$F);},this._fillTexture=function($R,$F,$i){$i[0].loaded&&this.ctx.fillTexture($i[0],$i[1]+$R,$i[2]+$F,$i[3],$i[4],$i[5],$i[6],$i[7]);},this._drawTextureWithTransform=function($R,$F,$i){$i[0].loaded&&this.ctx.drawTextureWithTransform($i[0],$i[1],$i[2],$i[3],$i[4],$i[5],$R,$F,$i[6]);},this._fillQuadrangle=function($R,$F,$i){this.ctx.fillQuadrangle($i[0],$i[1],$i[2],$i[3],$i[4]);},this._drawRect=function($R,$F,$i){var $j=this.ctx;null!=$i[4]&&($j.fillStyle=$i[4],$j.fillRect($R+$i[0],$F+$i[1],$i[2],$i[3],null)),null!=$i[5]&&($j.strokeStyle=$i[5],$j.lineWidth=$i[6],$j.strokeRect($R+$i[0],$F+$i[1],$i[2],$i[3],$i[6]));},this._drawPie=function($R,$F,$i){var $j=this.ctx;$u.isWebGL&&$j.setPathId($i[8]),$j.beginPath(),$u.isWebGL?($j.movePath($i[0]+$R,$i[1]+$F),$j.moveTo(0,0)):$j.moveTo($R+$i[0],$F+$i[1]),$j.arc($R+$i[0],$F+$i[1],$i[2],$i[3],$i[4]),$j.closePath(),this._fillAndStroke($i[5],$i[6],$i[7],!0);},this._clipRect=function($R,$F,$i){this.ctx.clipRect($R+$i[0],$F+$i[1],$i[2],$i[3]);},this._fillRect=function($R,$F,$i){this.ctx.fillRect($R+$i[0],$F+$i[1],$i[2],$i[3],$i[4]);},this._drawCircle=function($R,$F,$i){var $j=this.ctx;$u.isWebGL&&$j.setPathId($i[6]),$C.drawCall++,$j.beginPath(),$u.isWebGL&&$j.movePath($i[0]+$R,$i[1]+$F),$j.arc($i[0]+$R,$i[1]+$F,$i[2],0,$$.PI2),$j.closePath(),this._fillAndStroke($i[3],$i[4],$i[5],!0);},this._fillCircle=function($R,$F,$i){$C.drawCall++;var $j=this.ctx;$j.beginPath(),$j.fillStyle=$i[3],$j.arc($i[0]+$R,$i[1]+$F,$i[2],0,$$.PI2),$j.fill();},this._setShader=function($R,$F,$i){this.ctx.setShader($i[0]);},this._drawLine=function($R,$F,$i){var $j=this.ctx;$u.isWebGL&&$j.setPathId($i[6]),$j.beginPath(),$j.strokeStyle=$i[4],$j.lineWidth=$i[5],$u.isWebGL?($j.movePath($R,$F),$j.moveTo($i[0],$i[1]),$j.lineTo($i[2],$i[3])):($j.moveTo($R+$i[0],$F+$i[1]),$j.lineTo($R+$i[2],$F+$i[3])),$j.stroke();},this._drawLines=function($R,$F,$i){var $j=this.ctx;$u.isWebGL&&$j.setPathId($i[5]),$j.beginPath(),$R+=$i[0],$F+=$i[1],$u.isWebGL&&$j.movePath($R,$F),$j.strokeStyle=$i[3],$j.lineWidth=$i[4];var $t=$i[2],$p=2,$$=$t.length;if($u.isWebGL)for($j.moveTo($t[0],$t[1]);$p<$$;)$j.lineTo($t[$p++],$t[$p++]);else for($j.moveTo($R+$t[0],$F+$t[1]);$p<$$;)$j.lineTo($R+$t[$p++],$F+$t[$p++]);$j.stroke();},this._drawLinesWebGL=function($R,$F,$i){this.ctx.drawLines($R+this.x+$i[0],$F+this.y+$i[1],$i[2],$i[3],$i[4]);},this._drawCurves=function($R,$F,$i){this.ctx.drawCurves($R,$F,$i);},this._draw=function($R,$F,$i){$i[0].call(null,this,$R,$F);},this._transformByMatrix=function($R,$F,$i){this.ctx.transformByMatrix($i[0]);},this._setTransform=function($R,$F,$i){this.ctx.setTransform($i[0],$i[1],$i[2],$i[3],$i[4],$i[5]);},this._setTransformByMatrix=function($R,$F,$i){this.ctx.setTransformByMatrix($i[0]);},this._save=function($R,$F,$i){this.ctx.save();},this._restore=function($R,$F,$i){this.ctx.restore();},this._translate=function($R,$F,$i){this.ctx.translate($i[0],$i[1]);},this._transform=function($R,$F,$i){this.ctx.translate($i[1]+$R,$i[2]+$F);var $j=$i[0];this.ctx.transform($j.a,$j.b,$j.c,$j.d,$j.tx,$j.ty),this.ctx.translate(-$R-$i[1],-$F-$i[2]);},this._rotate=function($R,$F,$i){this.ctx.translate($i[1]+$R,$i[2]+$F),this.ctx.rotate($i[0]),this.ctx.translate(-$R-$i[1],-$F-$i[2]);},this._scale=function($R,$F,$i){this.ctx.translate($i[2]+$R,$i[3]+$F),this.ctx.scale($i[0],$i[1]),this.ctx.translate(-$R-$i[2],-$F-$i[3]);},this._alpha=function($R,$F,$i){this.ctx.globalAlpha*=$i[0];},this._setAlpha=function($R,$F,$i){this.ctx.globalAlpha=$i[0];},this._fillText=function($R,$F,$i){this.ctx.fillText($i[0],$i[1]+$R,$i[2]+$F,$i[3],$i[4],$i[5]);},this._strokeText=function($R,$F,$i){this.ctx.strokeText($i[0],$i[1]+$R,$i[2]+$F,$i[3],$i[4],$i[5],$i[6]);},this._fillBorderText=function($R,$F,$i){this.ctx.fillBorderText($i[0],$i[1]+$R,$i[2]+$F,$i[3],$i[4],$i[5],$i[6],$i[7]);},this._blendMode=function($R,$F,$i){this.ctx.globalCompositeOperation=$i[0];},this._beginClip=function($R,$F,$i){this.ctx.beginClip&&this.ctx.beginClip($R+$i[0],$F+$i[1],$i[2],$i[3]);},this._setIBVB=function($R,$F,$i){this.ctx.setIBVB($i[0]+$R,$i[1]+$F,$i[2],$i[3],$i[4],$i[5],$i[6],$i[7]);},this._fillTrangles=function($R,$F,$i){this.ctx.fillTrangles($i[0],$i[1]+$R,$i[2]+$F,$i[3],$i[4]);},this._drawPath=function($R,$F,$i){var $j=this.ctx;$u.isWebGL&&$j.setPathId(-1),$j.beginPath(),$R+=$i[0],$F+=$i[1],$u.isWebGL&&$j.movePath($R,$F);for(var $t=$i[2],$p=0,$$=$t.length;$p<$$;$p++){var $V=$t[$p];switch($V[0]){case"moveTo":$u.isWebGL?$j.moveTo($V[1],$V[2]):$j.moveTo($R+$V[1],$F+$V[2]);break;case"lineTo":$u.isWebGL?$j.lineTo($V[1],$V[2]):$j.lineTo($R+$V[1],$F+$V[2]);break;case"arcTo":$u.isWebGL?$j.arcTo($V[1],$V[2],$V[3],$V[4],$V[5]):$j.arcTo($R+$V[1],$F+$V[2],$R+$V[3],$F+$V[4],$V[5]);break;case"closePath":$j.closePath();}}var $N=$i[3];null!=$N&&($j.fillStyle=$N.fillStyle,$j.fill());var $c=$i[4];null!=$c&&($j.strokeStyle=$c.strokeStyle,$j.lineWidth=$c.lineWidth||1,$j.lineJoin=$c.lineJoin,$j.lineCap=$c.lineCap,$j.miterLimit=$c.miterLimit,$j.stroke());},this.drawPoly=function($R,$F,$i){this.ctx.drawPoly($R+this.x+$i[0],$F+this.y+$i[1],$i[2],$i[3],$i[4],$i[5],$i[6]);},this._drawPoly=function($R,$F,$i){var $j=this.ctx,$t=$i[2],$p=2,$$=$t.length;if($u.isWebGL)for($j.setPathId($i[6]),$j.beginPath(),$R+=$i[0],$F+=$i[1],$j.movePath($R,$F),$j.moveTo($t[0],$t[1]);$p<$$;)$j.lineTo($t[$p++],$t[$p++]);else for($j.beginPath(),$R+=$i[0],$F+=$i[1],$j.moveTo($R+$t[0],$F+$t[1]);$p<$$;)$j.lineTo($R+$t[$p++],$F+$t[$p++]);$j.closePath(),this._fillAndStroke($i[3],$i[4],$i[5],$i[7]);},this._drawSkin=function($R,$F,$i){var $j=$i[0];if($j){var $t=this.ctx;$j.render($t,$R,$F);}},this._drawParticle=function($R,$F,$i){this.ctx.drawParticle($R+this.x,$F+this.y,$i[0]);},this._setFilters=function($R,$F,$i){this.ctx.setFilters($i);},$i?this.ctx=$i.getContext("2d"):($i=$JR.create("3D"),this.ctx=$L.createWebGLContext2D($i),$i._setContext(this.ctx)),$i.size($R,$F),this.canvas=$i;}$x($$,"laya.renders.RenderContext");var $R=$$.prototype;return $R.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null);},$R.drawTexture=function($R,$F,$i,$j,$t){$R.loaded&&this.ctx.drawTexture($R,$F,$i,$j,$t,this.x,this.y);},$R._drawTextures=function($R,$F,$i){$i[0].loaded&&this.ctx.drawTextures($i[0],$i[1],$R+this.x,$F+this.y);},$R.drawTextureWithTransform=function($R,$F,$i,$j,$t,$p,$$){$R.loaded&&this.ctx.drawTextureWithTransform($R,$F,$i,$j,$t,$p,this.x,this.y,$$);},$R.fillQuadrangle=function($R,$F,$i,$j,$t){this.ctx.fillQuadrangle($R,$F,$i,$j,$t);},$R.drawCanvas=function($R,$F,$i,$j,$t){this.ctx.drawCanvas($R,$F+this.x,$i+this.y,$j,$t);},$R.drawRect=function($R,$F,$i,$j,$t,$p){void 0===$p&&($p=1);var $$=this.ctx;$$.strokeStyle=$t,$$.lineWidth=$p,$$.strokeRect($R+this.x,$F+this.y,$i,$j,$p);},$R._fillAndStroke=function($R,$F,$i,$j){void 0===$j&&($j=!1);var $t=this.ctx;null!=$R&&($t.fillStyle=$R,$u.isWebGL?$t.fill($j):$t.fill()),null!=$F&&0<$i&&($t.strokeStyle=$F,$t.lineWidth=$i,$t.stroke());},$R.clipRect=function($R,$F,$i,$j){this.ctx.clipRect($R+this.x,$F+this.y,$i,$j);},$R.fillRect=function($R,$F,$i,$j,$t){this.ctx.fillRect($R+this.x,$F+this.y,$i,$j,$t);},$R.drawCircle=function($R,$F,$i,$j,$t){void 0===$t&&($t=1),$C.drawCall++;var $p=this.ctx;$p.beginPath(),$p.strokeStyle=$j,$p.lineWidth=$t,$p.arc($R+this.x,$F+this.y,$i,0,$$.PI2),$p.stroke();},$R.drawTriangles=function($R,$F,$i){if($u.isWebGL)this.ctx.drawTriangles($i[0],$R+$i[1],$F+$i[2],$i[3],$i[4],$i[5],$i[6],$i[7],$i[8],$i[9]);else{var $j=$i[5],$t=0,$p=$j.length,$$=this.ctx;for($t=0;$t<$p;$t+=3){var $V=2*$j[$t],$N=2*$j[$t+1],$c=2*$j[$t+2];$$.drawTriangle($i[0],$i[3],$i[4],$V,$N,$c,$i[6],!0);}}},$R.fillCircle=function($R,$F,$i,$j){$C.drawCall++;var $t=this.ctx;$t.beginPath(),$t.fillStyle=$j,$t.arc($R+this.x,$F+this.y,$i,0,$$.PI2),$t.fill();},$R.setShader=function($R){this.ctx.setShader($R);},$R.drawLine=function($R,$F,$i,$j,$t,$p){void 0===$p&&($p=1);var $$=this.ctx;$$.beginPath(),$$.strokeStyle=$t,$$.lineWidth=$p,$$.moveTo(this.x+$R,this.y+$F),$$.lineTo(this.x+$i,this.y+$j),$$.stroke();},$R.clear=function(){this.ctx.clear();},$R.transformByMatrix=function($R){this.ctx.transformByMatrix($R);},$R.setTransform=function($R,$F,$i,$j,$t,$p){this.ctx.setTransform($R,$F,$i,$j,$t,$p);},$R.setTransformByMatrix=function($R){this.ctx.setTransformByMatrix($R);},$R.save=function(){this.ctx.save();},$R.restore=function(){this.ctx.restore();},$R.translate=function($R,$F){this.ctx.translate($R,$F);},$R.transform=function($R,$F,$i,$j,$t,$p){this.ctx.transform($R,$F,$i,$j,$t,$p);},$R.rotate=function($R){this.ctx.rotate($R);},$R.scale=function($R,$F){this.ctx.scale($R,$F);},$R.alpha=function($R){this.ctx.globalAlpha*=$R;},$R.setAlpha=function($R){this.ctx.globalAlpha=$R;},$R.fillWords=function($R,$F,$i,$j,$t,$p){void 0===$p&&($p=0),this.ctx.fillWords($R,$F,$i,$j,$t,$p);},$R.fillBorderWords=function($R,$F,$i,$j,$t,$p,$$){this.ctx.fillBorderWords($R,$F,$i,$j,$t,$p,$$);},$R.fillText=function($R,$F,$i,$j,$t,$p){this.ctx.fillText($R,$F+this.x,$i+this.y,$j,$t,$p);},$R.strokeText=function($R,$F,$i,$j,$t,$p,$$){this.ctx.strokeText($R,$F+this.x,$i+this.y,$j,$t,$p,$$);},$R.blendMode=function($R){this.ctx.globalCompositeOperation=$R;},$R.flush=function(){this.ctx.flush&&this.ctx.flush();},$R.addRenderObject=function($R){this.ctx.addRenderObject($R);},$R.beginClip=function($R,$F,$i,$j){this.ctx.beginClip&&this.ctx.beginClip($R,$F,$i,$j);},$R.endClip=function(){this.ctx.endClip&&this.ctx.endClip();},$R.fillTrangles=function($R,$F,$i){this.ctx.fillTrangles($i[0],$i[1],$i[2],$i[3],4<$i.length?$i[4]:null);},$$.PI2=2*Math.PI,$$;}(),$K=function(){function $$($R,$F){switch(this._next=$F||$$.NORENDER,$R){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=$m._filter);case 69905:return void(this._fun=$$._initRenderFun);}this.onCreate($R);}$x($$,"laya.renders.RenderSprite");var $R=$$.prototype;return $R.onCreate=function($R){},$R._style=function($R,$F,$i,$j){$R._style.render($R,$F,$i,$j);var $t=this._next;$t._fun.call($t,$R,$F,$i,$j);},$R._no=function($R,$F,$i,$j){},$R._custom=function($R,$F,$i,$j){$R.customRender($F,$i,$j);var $t=$R._style._tf;this._next._fun.call(this._next,$R,$F,$i-$t.translateX,$j-$t.translateY);},$R._clip=function($R,$F,$i,$j){var $t=this._next;if($t!=$$.NORENDER){var $p=$R._style.scrollRect;$F.ctx.save(),$F.ctx.clipRect($i,$j,$p.width,$p.height),$t._fun.call($t,$R,$F,$i-$p.x,$j-$p.y),$F.ctx.restore();}},$R._blend=function($R,$F,$i,$j){var $t=$R._style;$t.blendMode&&($F.ctx.globalCompositeOperation=$t.blendMode);var $p=this._next;$p._fun.call($p,$R,$F,$i,$j),$F.ctx.globalCompositeOperation="source-over";},$R._mask=function($R,$F,$i,$j){var $t=this._next;$t._fun.call($t,$R,$F,$i,$j);var $p=$R.mask;$p&&($F.ctx.globalCompositeOperation="destination-in",(0<$p.numChildren||!$p.graphics._isOnlyOne())&&($p.cacheAsBitmap=!0),$p.render($F,$i-$R.pivotX,$j-$R.pivotY)),$F.ctx.globalCompositeOperation="source-over";},$R._graphics=function($R,$F,$i,$j){var $t=$R._style._tf;$R._graphics&&$R._graphics._render($R,$F,$i-$t.translateX,$j-$t.translateY);var $p=this._next;$p._fun.call($p,$R,$F,$i,$j);},$R._image=function($R,$F,$i,$j){var $t=$R._style;$F.ctx.drawTexture2($i,$j,$t._tf.translateX,$t._tf.translateY,$R.transform,$t.alpha,$t.blendMode,$R._graphics._one);},$R._image2=function($R,$F,$i,$j){var $t=$R._style._tf;$F.ctx.drawTexture2($i,$j,$t.translateX,$t.translateY,$R.transform,1,null,$R._graphics._one);},$R._alpha=function($R,$F,$i,$j){var $t;if(.01<($t=$R._style.alpha)||$R._needRepaint()){var $p=$F.ctx.globalAlpha;$F.ctx.globalAlpha*=$t;var $$=this._next;$$._fun.call($$,$R,$F,$i,$j),$F.ctx.globalAlpha=$p;}},$R._transform=function($R,$F,$i,$j){var $t=$R.transform,$p=this._next;$t&&$p!=$$.NORENDER?($F.save(),$F.transform($t.a,$t.b,$t.c,$t.d,$t.tx+$i,$t.ty+$j),$p._fun.call($p,$R,$F,0,0),$F.restore()):$p._fun.call($p,$R,$F,$i,$j);},$R._childs=function($R,$F,$i,$j){var $t=$R._style,$p=$t._tf;if($i=$i-$p.translateX+$t.paddingLeft,$j=$j-$p.translateY+$t.paddingTop,$t._calculation){var $$=$R._getWords();if($$){var $V=$t;$V&&($V.stroke?$F.fillBorderWords($$,$i,$j,$V.font,$V.color,$V.strokeColor,$V.stroke):$F.fillWords($$,$i,$j,$V.font,$V.color,"none"!=$V.textDecoration&&$V.underLine?1:0));}}var $N,$c=$R._childs,$q=$c.length;if($R.viewport||$R.optimizeScrollRect&&$R._style.scrollRect){var $s=$R.viewport||$R._style.scrollRect,$k=$s.x,$h=$s.y,$S=$s.right,$x=$s.bottom,$a=NaN,$m=NaN;for($M=0;$M<$q;++$M)($N=$c[$M]).visible&&($a=$N._x)<$S&&$a+$N.width>$k&&($m=$N._y)<$x&&$m+$N.height>$h&&$N.render($F,$i,$j);}else for(var $M=0;$M<$q;++$M)($N=$c[$M])._style.visible&&$N.render($F,$i,$j);},$R._canvas=function($R,$F,$i,$j){var $t=$R._$P.cacheCanvas;if($t){"bitmap"===$t.type?$C.canvasBitmap++:$C.canvasNormal++;var $p=$t.ctx;if($R._needRepaint()||!$p)this._canvas_repaint($R,$F,$i,$j);else{var $$=$t._cacheRec;$F.drawCanvas($p.canvas,$i+$$.x,$j+$$.y,$$.width,$$.height);}}else this._next._fun.call(this._next,$R,$F,$i,$j);},$R._canvas_repaint=function($R,$F,$i,$j){var $t=$R._$P.cacheCanvas,$p=this._next;if($t){var $$,$V,$N,$c,$q=$t.ctx,$s=$R._needRepaint()||!$q,$k=$t.type;if("bitmap"===$k?$C.canvasBitmap++:$C.canvasNormal++,$s){var $h,$S;$t._cacheRec||($t._cacheRec=new $T()),$u.isWebGL&&"bitmap"!==$k?$t._cacheRec.setTo(-$R.pivotX,-$R.pivotY,1,1):(($c=$R.getSelfBounds()).x=$c.x-$R.pivotX,$c.y=$c.y-$R.pivotY,$c.x=$c.x-16,$c.y=$c.y-16,$c.width=$c.width+32,$c.height=$c.height+32,$c.x=Math.floor($c.x+$i)-$i,$c.y=Math.floor($c.y+$j)-$j,$c.width=Math.floor($c.width),$c.height=Math.floor($c.height),$t._cacheRec.copyFrom($c)),$c=$t._cacheRec;var $x,$a=$u.isWebGL?1:$b.pixelRatio*$H.stage.clientScaleX,$m=$u.isWebGL?1:$b.pixelRatio*$H.stage.clientScaleY;if(!$u.isWebGL){var $M,$J=1,$d=1;for($M=$R;$M&&$M!=$H.stage;)$J*=$M.scaleX,$d*=$M.scaleY,$M=$M.parent;$u.isWebGL?($J<1&&($a*=$J),$d<1&&($m*=$d)):(1<$J&&($a*=$J),1<$d&&($m*=$d));}if($R.scrollRect){var $w=$R.scrollRect;$c.x-=$w.x,$c.y-=$w.y;}if($h=$c.width*$a,$S=$c.height*$m,$V=$c.x,$N=$c.y,$u.isWebGL&&"bitmap"===$k&&(2048<$h||2048<$S))return console.warn("cache bitmap size larger than 2048,cache ignored"),$t.ctx&&($n.recover("RenderContext",$t.ctx),$t.ctx.canvas.size(0,0),$t.ctx=null),void $p._fun.call($p,$R,$F,$i,$j);if($q||($q=$t.ctx=$n.getItem("RenderContext")||new $v($h,$S,$JR.create("AUTO"))),$q.ctx.sprite=$R,($$=$q.canvas).clear(),($$.width!=$h||$$.height!=$S)&&$$.size($h,$S),"bitmap"===$k?$$.context.asBitmap=!0:"normal"===$k&&($$.context.asBitmap=!1),1!=$a||1!=$m){var $X=$q.ctx;$X.save(),$X.scale($a,$m),!$u.isConchWebGL&&$u.isConchApp&&($x=$R._$P.cf)&&$X.setFilterMatrix&&$X.setFilterMatrix($x._mat,$x._alpha),$p._fun.call($p,$R,$q,-$V,-$N),$X.restore(),$u.isConchApp&&!$u.isConchWebGL||$R._applyFilters();}else $X=$q.ctx,!$u.isConchWebGL&&$u.isConchApp&&($x=$R._$P.cf)&&$X.setFilterMatrix&&$X.setFilterMatrix($x._mat,$x._alpha),$p._fun.call($p,$R,$q,-$V,-$N),$u.isConchApp&&!$u.isConchWebGL||$R._applyFilters();$R._$P.staticCache&&($t.reCache=!1),$C.canvasReCache++;}else $V=($c=$t._cacheRec).x,$N=$c.y,$$=$q.canvas;$F.drawCanvas($$,$i+$V,$j+$N,$c.width,$c.height);}else $p._fun.call($p,$R,$q,$i,$j);},$$.__init__=function(){var $R,$F,$i=0;for($F=$L.createRenderSprite(69905,null),$R=$$.renders.length=4096,$i=0;$i<$R;$i++)$$.renders[$i]=$F;$$.renders[0]=$L.createRenderSprite(0,null),function($R,$F){for(var $i=0,$j=0;$j<$R.length;$j++)$i|=$R[$j],$$.renders[$i]=$F;}([1,512,4,2],new $$(1,null)),$$.renders[513]=$L.createRenderSprite(513,null),$$.renders[517]=new $$(517,null);},$$._initRenderFun=function($R,$F,$i,$j){var $t=$R._renderType;($$.renders[$t]=$$._getTypeRender($t))._fun($R,$F,$i,$j);},$$._getTypeRender=function($R){for(var $F=null,$i=2048;1<$i;)$i&$R&&($F=$L.createRenderSprite($i,$F)),$i>>=1;return $F;},$$.IMAGE=1,$$.ALPHA=2,$$.TRANSFORM=4,$$.BLEND=8,$$.CANVAS=16,$$.FILTERS=32,$$.MASK=64,$$.CLIP=128,$$.STYLE=256,$$.GRAPHICS=512,$$.CUSTOM=1024,$$.CHILDS=2048,$$.INIT=69905,$$.renders=[],$$.NORENDER=new $$(0,null),$$;}(),$e=function(){function $V(){this._repaint=!1;}$x($V,"laya.resource.Context");var $R=$V.prototype;return $R.replaceReset=function(){var $R,$F,$i=0;for($R=$V.replaceKeys.length,$i=0;$i<$R;$i++)$F=$V.replaceKeys[$i],this[$V.newKeys[$i]]=this[$F];},$R.replaceResotre=function(){this.__restore(),this.__reset();},$R.setIsMainContext=function(){},$R.drawTextures=function($R,$F,$i,$j){$C.drawCall+=$F.length/2;for(var $t=$R.width,$p=$R.height,$$=0,$V=$F.length;$$<$V;$$+=2)this.drawTexture($R,$F[$$],$F[$$+1],$t,$p,$i,$j);},$R.drawCanvas=function($R,$F,$i,$j,$t){$C.drawCall++,this.drawImage($R.source,$F,$i,$j,$t);},$R.fillRect=function($R,$F,$i,$j,$t){$C.drawCall++,$t&&(this.fillStyle=$t),this.__fillRect($R,$F,$i,$j);},$R.fillText=function($R,$F,$i,$j,$t,$p){$C.drawCall++,3<arguments.length&&null!=$j&&(this.font=$j,this.fillStyle=$t,this.textAlign=$p,this.textBaseline="top"),this.__fillText($R,$F,$i);},$R.fillBorderText=function($R,$F,$i,$j,$t,$p,$$,$V){$C.drawCall++,this.font=$j,this.fillStyle=$t,this.textBaseline="top",this.strokeStyle=$p,this.lineWidth=$$,this.textAlign=$V,this.__strokeText($R,$F,$i),this.__fillText($R,$F,$i);},$R.strokeText=function($R,$F,$i,$j,$t,$p,$$){$C.drawCall++,3<arguments.length&&null!=$j&&(this.font=$j,this.strokeStyle=$t,this.lineWidth=$p,this.textAlign=$$,this.textBaseline="top"),this.__strokeText($R,$F,$i);},$R.transformByMatrix=function($R){this.transform($R.a,$R.b,$R.c,$R.d,$R.tx,$R.ty);},$R.setTransformByMatrix=function($R){this.setTransform($R.a,$R.b,$R.c,$R.d,$R.tx,$R.ty);},$R.clipRect=function($R,$F,$i,$j){$C.drawCall++,this.beginPath(),this.rect($R,$F,$i,$j),this.clip();},$R.drawTexture=function($R,$F,$i,$j,$t,$p,$$){$C.drawCall++;var $V=$R.uv,$N=$R.bitmap.width,$c=$R.bitmap.height;this.drawImage($R.source,$V[0]*$N,$V[1]*$c,($V[2]-$V[0])*$N,($V[5]-$V[3])*$c,$F+$p,$i+$$,$j,$t);},$R.drawTextureWithTransform=function($R,$F,$i,$j,$t,$p,$$,$V,$N){$C.drawCall++;var $c=$R.uv,$q=$R.bitmap.width,$s=$R.bitmap.height;this.save(),1!=$N&&(this.globalAlpha*=$N),$p?(this.transform($p.a,$p.b,$p.c,$p.d,$p.tx+$$,$p.ty+$V),this.drawImage($R.source,$c[0]*$q,$c[1]*$s,($c[2]-$c[0])*$q,($c[5]-$c[3])*$s,$F,$i,$j,$t)):this.drawImage($R.source,$c[0]*$q,$c[1]*$s,($c[2]-$c[0])*$q,($c[5]-$c[3])*$s,$F+$$,$i+$V,$j,$t),this.restore();},$R.drawTexture2=function($R,$F,$i,$j,$t,$p,$$,$V){var $N=$V[0];if($N.loaded&&$N.bitmap&&$N.source){$C.drawCall++;var $c=1!==$p;if($c){var $q=this.globalAlpha;this.globalAlpha*=$p;}var $s=$N.uv,$k=$N.bitmap.width,$h=$N.bitmap.height;$t?(this.save(),this.transform($t.a,$t.b,$t.c,$t.d,$t.tx+$R,$t.ty+$F),this.drawImage($N.source,$s[0]*$k,$s[1]*$h,($s[2]-$s[0])*$k,($s[5]-$s[3])*$h,$V[1]-$i,$V[2]-$j,$V[3],$V[4]),this.restore()):this.drawImage($N.source,$s[0]*$k,$s[1]*$h,($s[2]-$s[0])*$k,($s[5]-$s[3])*$h,$V[1]-$i+$R,$V[2]-$j+$F,$V[3],$V[4]),$c&&(this.globalAlpha=$q);}},$R.fillTexture=function($R,$F,$i,$j,$t,$p,$$,$V){if(!$V.pat){if($R.uv!=$qR.DEF_UV){var $N=new $JR("2D");$N.getContext("2d"),$N.size($R.width,$R.height),$N.context.drawTexture($R,0,0,$R.width,$R.height,0,0),$R=new $qR($N);}$V.pat=this.createPattern($R.bitmap.source,$p);}var $c=$F,$q=$i,$s=0,$k=0;$$&&($c+=$$.x%$R.width,$q+=$$.y%$R.height,$s-=$$.x%$R.width,$k-=$$.y%$R.height),this.translate($c,$q),this.fillRect($s,$k,$j,$t,$V.pat),this.translate(-$c,-$q);},$R.drawTriangle=function($R,$F,$i,$j,$t,$p,$$,$V){var $N=$R.bitmap,$c=$N.source,$q=$R.width,$s=$R.height,$k=$N.width,$h=$N.height,$S=$i[$j]*$k,$x=$i[$t]*$k,$a=$i[$p]*$k,$m=$i[$j+1]*$h,$M=$i[$t+1]*$h,$J=$i[$p+1]*$h,$d=$F[$j],$w=$F[$t],$X=$F[$p],$H=$F[$j+1],$_=$F[$t+1],$T=$F[$p+1];if($V){var $g=($d+$w+$X)/3,$B=($H+$_+$T)/3,$z=$d-$g,$L=$H-$B,$Y=Math.sqrt($z*$z+$L*$L);$d=$g+$z/$Y*($Y+1),$H=$B+$L/$Y*($Y+1),$L=$_-$B,$w=$g+($z=$w-$g)/($Y=Math.sqrt($z*$z+$L*$L))*($Y+1),$_=$B+$L/$Y*($Y+1),$L=$T-$B,$X=$g+($z=$X-$g)/($Y=Math.sqrt($z*$z+$L*$L))*($Y+1),$T=$B+$L/$Y*($Y+1);}this.save(),$$&&this.transform($$.a,$$.b,$$.c,$$.d,$$.tx,$$.ty),this.beginPath(),this.moveTo($d,$H),this.lineTo($w,$_),this.lineTo($X,$T),this.closePath(),this.clip();var $f=1/($S*$M+$m*$a+$x*$J-$M*$a-$m*$x-$S*$J),$Z=$d*$M+$m*$X+$w*$J-$M*$X-$m*$w-$d*$J,$u=$S*$w+$d*$a+$x*$X-$w*$a-$d*$x-$S*$X,$v=$S*$M*$X+$m*$w*$a+$d*$x*$J-$d*$M*$a-$m*$x*$X-$S*$w*$J,$K=$H*$M+$m*$T+$_*$J-$M*$T-$m*$_-$H*$J,$e=$S*$_+$H*$a+$x*$T-$_*$a-$H*$x-$S*$T,$Q=$S*$M*$T+$m*$_*$a+$H*$x*$J-$H*$M*$a-$m*$x*$T-$S*$_*$J;this.transform($Z*$f,$K*$f,$u*$f,$e*$f,$v*$f,$Q*$f),this.drawImage($c,$R.uv[0]*$k,$R.uv[1]*$h,$q,$s,$R.uv[0]*$k,$R.uv[1]*$h,$q,$s),this.restore();},$R.flush=function(){return 0;},$R.fillWords=function($R,$F,$i,$j,$t,$p){$j&&(this.font=$j),$t&&(this.fillStyle=$t);this.textBaseline="top",this.textAlign="left";for(var $$=0,$V=$R.length;$$<$V;$$++){var $N=$R[$$];if(this.__fillText($N.char,$N.x+$F,$N.y+$i),1===$p){var $c=$N.height,$q=.5*$N.style.letterSpacing;$q||($q=0),this.beginPath(),this.strokeStyle=$t,this.lineWidth=1,this.moveTo($F+$N.x-$q+.5,$i+$N.y+$c+.5),this.lineTo($F+$N.x+$N.width+$q+.5,$i+$N.y+$c+.5),this.stroke();}}},$R.fillBorderWords=function($R,$F,$i,$j,$t,$p,$$){$j&&(this.font=$j),$t&&(this.fillStyle=$t),this.textBaseline="top",this.lineWidth=$$,this.textAlign="left",this.strokeStyle=$p;for(var $V=0,$N=$R.length;$V<$N;$V++){var $c=$R[$V];this.__strokeText($c.char,$c.x+$F,$c.y+$i),this.__fillText($c.char,$c.x+$F,$c.y+$i);}},$R.destroy=function(){this.canvas.width=this.canvas.height=0;},$R.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1;},$R.drawCurves=function($R,$F,$i){this.beginPath(),this.strokeStyle=$i[3],this.lineWidth=$i[4];var $j=$i[2];$R+=$i[0],$F+=$i[1],this.moveTo($R+$j[0],$F+$j[1]);for(var $t=2,$p=$j.length;$t<$p;)this.quadraticCurveTo($R+$j[$t++],$F+$j[$t++],$R+$j[$t++],$F+$j[$t++]);this.stroke();},$V.__init__=function($F){var $i=laya.resource.Context.prototype;if(!($F=$F||CanvasRenderingContext2D.prototype).inited){$F.inited=!0,$F.__fillText=$F.fillText,$F.__fillRect=$F.fillRect,$F.__strokeText=$F.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function($R){$F[$R]=$i[$R];});}},$V.replaceCanvasGetSet=function($R,$F){var $i=Object.getOwnPropertyDescriptor($R,$F);if(!$i||!$i.configurable)return!1;var $j,$t={};for($j in $i)"set"!=$j&&($t[$j]=$i[$j]);var $p=$i.set;return $t.set=function($R){$p.call(this,$R);var $F=this.getContext("2d");$F&&"__reset"in $F&&$F.__reset();},Object.defineProperty($R,$F,$t),!0;},$V.replaceGetSet=function($R,$F){var $i=Object.getOwnPropertyDescriptor($R,$F);if(!$i||!$i.configurable)return!1;var $j,$t={};for($j in $i)"set"!=$j&&($t[$j]=$i[$j]);var $p=$i.set,$$="___"+$F+"__";return $V.newKeys.push($$),$t.set=function($R){$R!=this[$$]&&(this[$$]=$R,$p.call(this,$R));},Object.defineProperty($R,$F,$t),!0;},$V._default=new $V(),$V.newKeys=[],$N($V,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"];}]),$V;}(),$Q=function(){function $p($R){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++$p._uniqueIDCounter,this._name=$R||"Content Manager",$p._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,$p._resourceManagers.push(this),this._resources=[],this._records={};}$x($p,"laya.resource.ResourceManager");var $R=$p.prototype;return $H.imps($R,{"laya.resource.IDispose":!0}),$R.getResourceByIndex=function($R){return this._resources[$R];},$R.getResourcesLength=function(){return this._resources.length;},$R.addResource=function($R){return $R.resourceManager&&$R.resourceManager.removeResource($R),-1===this._resources.indexOf($R)&&(($R._resourceManager=this)._resources.push($R),this.addRecord($R.uri,$R.__className,$R.memorySize),this.addSize($R.memorySize),!0);},$R.removeResource=function($R){var $F=this._resources.indexOf($R);return-1!==$F&&(this._resources.splice($F,1),$R._resourceManager=null,this._memorySize-=$R.memorySize,this.addRecord($R.uri,$R.__className,-$R.memorySize),!0);},$R.unload=function(){for(var $R=this._resources.slice(0,this._resources.length),$F=0;$F<$R.length;$F++){$R[$F].destroy();}$R.length=0;},$R.dispose=function(){if(this===$p._systemResourceManager)throw new Error("systemResourceManager不能被释放！");$p._resourceManagers.splice($p._resourceManagers.indexOf(this),1),$p._isResourceManagersSorted=!1;for(var $R=this._resources.slice(0,this._resources.length),$F=0;$F<$R.length;$F++){var $i=$R[$F];$i.resourceManager.removeResource($i),$i.destroy();}$R.length=0;},$R.addSize=function($R){$R&&(this.autoRelease&&0<$R&&this._memorySize+$R>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=$R);},$R.addRecord=function($R,$F,$i){DEBUG&&$i&&!$R&&console.error($R,$F,$i);},$R.garbageCollection=function($R){var $F=this._resources;($F=$F.slice()).sort(function($R,$F){if(!$R||!$F)throw new Error("a或b不能为空！");return $R.released&&$F.released?0:$R.released?1:$F.released?-1:$R._lastUseFrameCount-$F._lastUseFrameCount;});for(var $i=$C.loopCount,$j=0,$t=$F.length;$j<$t;$j++){var $p=$F[$j];if(!(1<$i-$p._lastUseFrameCount))return void(this._memorySize>=$R&&(this._isOverflow=!0));if($p.releaseResource(),this._memorySize<$R)return void(this._isOverflow=!1);}},$q(0,$R,"id",function(){return this._id;}),$q(0,$R,"name",function(){return this._name;},function($R){!$R&&""===$R||this._name===$R||(this._name=$R,$p._isResourceManagersSorted=!1);}),$q(0,$R,"memorySize",function(){return this._memorySize;}),$q(0,$R,"records",function(){return this._records;}),$q(1,$p,"systemResourceManager",function(){return $p._systemResourceManager;}),$p.__init__=function(){$p.currentResourceManager=$p.systemResourceManager;},$p.getLoadedResourceManagerByIndex=function($R){return $p._resourceManagers[$R];},$p.getLoadedResourceManagersCount=function(){return $p._resourceManagers.length;},$p.recreateContentManagers=function($R){void 0===$R&&($R=!1);for(var $F=$p.currentResourceManager,$i=0;$i<$p._resourceManagers.length;$i++){$p.currentResourceManager=$p._resourceManagers[$i];for(var $j=0;$j<$p.currentResourceManager._resources.length;$j++)$p.currentResourceManager._resources[$j].releaseResource($R),$p.currentResourceManager._resources[$j].activeResource($R);}$p.currentResourceManager=$F;},$p.releaseContentManagers=function($R){void 0===$R&&($R=!1);for(var $F=$p.currentResourceManager,$i=0;$i<$p._resourceManagers.length;$i++){$p.currentResourceManager=$p._resourceManagers[$i];for(var $j=0;$j<$p.currentResourceManager._resources.length;$j++){var $t=$p.currentResourceManager._resources[$j];!$t.released&&$t.releaseResource($R);}}$p.currentResourceManager=$F;},$p._uniqueIDCounter=0,$p._isResourceManagersSorted=!1,$p._resourceManagers=[],$N($p,["_systemResourceManager",function(){return this._systemResourceManager=new $p("System Resource Manager");},"currentResourceManager",function(){return this.currentResourceManager=$p._systemResourceManager;}]),$p;}(),$b=(function(){function $R(){}$x($R,"laya.system.System"),$R.changeDefinition=function($R,$F){$H[$R]=$F;var $i=$R+"=classObj";$H._runScript($i);},$R.__init__=function(){$u.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice());};}(),function(){function $i(){}return $x($i,"laya.utils.Browser"),$q(1,$i,"pixelRatio",function(){return $i.__init__(),-1<$i.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:$L.getPixelRatio();}),$q(1,$i,"height",function(){return $i.__init__(),($H.stage&&$H.stage.canvasRotation?$i.clientWidth:$i.clientHeight)*$i.pixelRatio;}),$q(1,$i,"clientWidth",function(){return $i.__init__(),$i.window.innerWidth||$i.document.body.clientWidth;}),$q(1,$i,"window",function(){return $i.__init__(),$i._window;}),$q(1,$i,"clientHeight",function(){return $i.__init__(),$i.window.innerHeight||$i.document.body.clientHeight||$i.document.documentElement.clientHeight;}),$q(1,$i,"width",function(){return $i.__init__(),($H.stage&&$H.stage.canvasRotation?$i.clientHeight:$i.clientWidth)*$i.pixelRatio;}),$q(1,$i,"container",function(){return $i.__init__(),$i._container||(($i._container=$i.createElement("div")).id="layaContainer",$i.document.body.appendChild($i._container)),$i._container;},function($R){$i._container=$R;}),$q(1,$i,"document",function(){return $i.__init__(),$i._document;}),$i.__init__=function(){if(!$i._window){$i._window=$L.getWindow(),$i._document=$i.window.document,$i._window.addEventListener("message",function($R){laya.utils.Browser._onMessage($R);},!1),$i.document.__createElement=$i.document.createElement,$$.requestAnimationFrame=$$.requestAnimationFrame||$$.webkitRequestAnimationFrame||$$.mozRequestAnimationFrame||$$.oRequestAnimationFrame||$$.msRequestAnimationFrame||function($R){return $$.setTimeout($R,1e3/60);};var $R=$$.document.body.style;$R["-webkit-user-select"]="none",$R["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",$i.userAgent=$i.window.navigator.userAgent,$i.onIOS=!!($i.u=$i.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),$i.onMobile=-1<$i.u.indexOf("Mobile"),$i.onIPhone=-1<$i.u.indexOf("iPhone"),$i.onMac=-1<$i.u.indexOf("Mac OS X"),$i.onIPad=-1<$i.u.indexOf("iPad"),$i.onAndroid=-1<$i.u.indexOf("Android")||-1<$i.u.indexOf("Adr"),$i.onWP=-1<$i.u.indexOf("Windows Phone"),$i.onQQBrowser=-1<$i.u.indexOf("QQBrowser"),$i.onMQQBrowser=-1<$i.u.indexOf("MQQBrowser")||-1<$i.u.indexOf("Mobile")&&-1<$i.u.indexOf("QQ"),$i.onIE=!!$i.window.ActiveXObject||"ActiveXObject"in $i.window,$i.onWeiXin=-1<$i.u.indexOf("MicroMessenger"),$i.onPC=!$i.onMobile,$i.onSafari=-1<$i.u.indexOf("Safari"),$i.onFirefox=-1<$i.u.indexOf("Firefox"),$i.onEdge=-1<$i.u.indexOf("Edge"),$i.onMiniGame=-1<$i.u.indexOf("MiniGame"),$i.onLimixiu=-1<$i.u.indexOf("limixiu"),$i.httpProtocol="http:"==$i.window.location.protocol,$i.onMiniGame&&null==$i.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),$i.webAudioEnabled=!!($i.window.AudioContext||$i.window.webkitAudioContext||$i.window.mozAudioContext),$i.soundType=$i.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",$tR=$i.webAudioEnabled?$pR:$iR,$i.webAudioEnabled&&$pR.initWebAudio(),$iR._initMusicAudio(),$i.enableTouch="ontouchstart"in $$||$$.DocumentTouch&&$F instanceof DocumentTouch,$$.focus(),$z._soundClass=$tR,$z._musicClass=$iR,$u._mainCanvas=$u._mainCanvas||$JR.create("2D"),$i.canvas||($i.canvas=$JR.create("2D"),$i.context=$i.canvas.getContext("2d"));}},$i._onMessage=function($R){if($R.data&&"size"==$R.data.name){if($i.window.innerWidth=$R.data.width,$i.window.innerHeight=$R.data.height,$i.window.__innerHeight=$R.data.clientHeight,!$i.document.createEvent)return void console.warn("no document.createEvent");var $F=$i.document.createEvent("HTMLEvents");return $F.initEvent("resize",!1,!1),void $i.window.dispatchEvent($F);}},$i.createElement=function($R){return $i.__init__(),$i.document.__createElement($R);},$i.getElementById=function($R){return $i.__init__(),$i.document.getElementById($R);},$i.removeElement=function($R){$R&&$R.parentNode&&$R.parentNode.removeChild($R);},$i.now=function(){return $L.now();},$i._window=null,$i._document=null,$i._container=null,$i.userAgent=null,$i.u=null,$i.onIOS=!1,$i.onMac=!1,$i.onMobile=!1,$i.onIPhone=!1,$i.onIPad=!1,$i.onAndroid=!1,$i.onWP=!1,$i.onQQBrowser=!1,$i.onMQQBrowser=!1,$i.onSafari=!1,$i.onFirefox=!1,$i.onEdge=!1,$i.onIE=!1,$i.onWeiXin=!1,$i.onMiniGame=!1,$i.onLimixiu=!1,$i.onPC=!1,$i.httpProtocol=!1,$i.webAudioEnabled=!1,$i.soundType=null,$i.enableTouch=!1,$i.canvas=null,$i.context=null,$i.__init$=function(){},$i;}()),$G=function(){function $F($R){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,$R?(this._u8d_=new Uint8Array($R),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_);}$x($F,"laya.utils.Byte");var $R=$F.prototype;return $R.___resizeBuffer=function($F){try{var $R=new Uint8Array($F);null!=this._u8d_&&(this._u8d_.length<=$F?$R.set(this._u8d_):$R.set(this._u8d_.subarray(0,$F))),this._u8d_=$R,this._d_=new DataView($R.buffer);}catch($R){throw"___resizeBuffer err:"+$F;}},$R.getString=function(){return this.rUTF(this.getUint16());},$R.getFloat32Array=function($R,$F){var $i=$R+$F;$i=$i>this._length?this._length:$i;var $j=new Float32Array(this._d_.buffer.slice($R,$i));return this._pos_=$i,$j;},$R.getUint8Array=function($R,$F){var $i=$R+$F;$i=$i>this._length?this._length:$i;var $j=new Uint8Array(this._d_.buffer.slice($R,$i));return this._pos_=$i,$j;},$R.getInt16Array=function($R,$F){var $i=$R+$F;$i=$i>this._length?this._length:$i;var $j=new Int16Array(this._d_.buffer.slice($R,$i));return this._pos_=$i,$j;},$R.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var $R=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,$R;},$R.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var $R=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,$R;},$R.writeFloat32=function($R){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,$R,this._xd_),this._pos_+=4;},$R.writeFloat64=function($R){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,$R,this._xd_),this._pos_+=8;},$R.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var $R=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,$R;},$R.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var $R=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,$R;},$R.writeInt32=function($R){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,$R,this._xd_),this._pos_+=4;},$R.writeUint32=function($R){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,$R,this._xd_),this._pos_+=4;},$R.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var $R=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,$R;},$R.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var $R=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,$R;},$R.writeUint16=function($R){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,$R,this._xd_),this._pos_+=2;},$R.writeInt16=function($R){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,$R,this._xd_),this._pos_+=2;},$R.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++);},$R.writeUint8=function($R){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,$R),this._pos_++;},$R._getUInt8=function($R){return this._d_.getUint8($R);},$R._getUint16=function($R){return this._d_.getUint16($R,this._xd_);},$R._getMatrix=function(){return new $Y(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32());},$R.rUTF=function($R){for(var $F=[],$i=this._pos_+$R,$j=0,$t=0,$p=0,$$=String.fromCharCode,$V=this._u8d_;this._pos_<$i;)($j=$V[this._pos_++])<128?0!=$j&&$F.push($$($j)):$j<224?$F.push($$((63&$j)<<6|127&$V[this._pos_++])):$j<240?($t=$V[this._pos_++],$F.push($$((31&$j)<<12|(127&$t)<<6|127&$V[this._pos_++]))):($t=$V[this._pos_++],$p=$V[this._pos_++],$F.push($$((15&$j)<<18|(127&$t)<<12|$p<<6&127|127&$V[this._pos_++]))),0;return $F.join("");},$R.getCustomString=function($R){for(var $F=[],$i=0,$j=0,$t=0,$p=String.fromCharCode,$$=this._u8d_;0<$R;)if(($j=$$[this._pos_])<128)$F.push($p($j)),this._pos_++,$R--;else for($i=$j-128,this._pos_++,$R-=$i;0<$i;)$j=$$[this._pos_++],$t=$$[this._pos_++],$F.push($p($t<<8|$j)),$i--;return $F.join("");},$R.clear=function(){this._pos_=0,this.length=0;},$R.__getBuffer=function(){return this._d_.buffer;},$R.writeUTFBytes=function($R){for(var $F=0,$i=($R+="").length;$F<$i;$F++){var $j=$R.charCodeAt($F);$j<=127?this.writeByte($j):$j<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|$j>>6,128|63&$j],this._pos_),this._pos_+=2):$j<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|$j>>12,128|$j>>6&63,128|63&$j],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|$j>>18,128|$j>>12&63,128|$j>>6&63,128|63&$j],this._pos_),this._pos_+=4);}},$R.writeUTFString=function($R){var $F=this.pos;this.writeUint16(1),this.writeUTFBytes($R);var $i=this.pos-$F-2;if(65536<=$i)throw"writeUTFString byte len more than 65536";this._d_.setUint16($F,$i,this._xd_);},$R.readUTFString=function(){return this.readUTFBytes(this.getUint16());},$R.getUTFString=function(){return this.readUTFString();},$R.readUTFBytes=function($R){if(void 0===$R&&($R=-1),0==$R)return"";var $F=this.bytesAvailable;if($F<$R)throw"readUTFBytes error - Out of bounds";return $R=0<$R?$R:$F,this.rUTF($R);},$R.getUTFBytes=function($R){return void 0===$R&&($R=-1),this.readUTFBytes($R);},$R.writeByte=function($R){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,$R),this._pos_+=1;},$R.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++);},$R.getByte=function(){return this.readByte();},$R.ensureWrite=function($R){this._length<$R&&(this._length=$R),this._allocated_<$R&&(this.length=$R);},$R.writeArrayBuffer=function($R,$F,$i){if(void 0===$F&&($F=0),void 0===$i&&($i=0),$F<0||$i<0)throw"writeArrayBuffer error - Out of bounds";0==$i&&($i=$R.byteLength-$F),this.ensureWrite(this._pos_+$i);var $j=new Uint8Array($R);this._u8d_.set($j.subarray($F,$F+$i),this._pos_),this._pos_+=$i;},$q(0,$R,"buffer",function(){var $R=this._d_.buffer;return $R.byteLength==this.length?$R:$R.slice(0,this.length);}),$q(0,$R,"endian",function(){return this._xd_?"littleEndian":"bigEndian";},function($R){this._xd_="littleEndian"==$R;}),$q(0,$R,"length",function(){return this._length;},function($R){this._allocated_<$R?this.___resizeBuffer(this._allocated_=Math.floor(Math.max($R,2*this._allocated_))):this._allocated_>$R&&this.___resizeBuffer(this._allocated_=$R),this._length=$R;}),$q(0,$R,"pos",function(){return this._pos_;},function($R){this._pos_=$R;}),$q(0,$R,"bytesAvailable",function(){return this._length-this._pos_;}),$F.getSystemEndian=function(){if(!$F._sysEndian){var $R=new ArrayBuffer(2);new DataView($R).setInt16(0,256,!0),$F._sysEndian=256===new Int16Array($R)[0]?"littleEndian":"bigEndian";}return $F._sysEndian;},$F.BIG_ENDIAN="bigEndian",$F.LITTLE_ENDIAN="littleEndian",$F._sysEndian=null,$F;}(),$O=function(){function $t(){}return $x($t,"laya.utils.CacheManager"),$t.regCacheByFunction=function($R,$F){var $i;$t.unRegCacheByFunction($R,$F),$i={tryDispose:$R,getCacheList:$F},$t._cacheList.push($i);},$t.unRegCacheByFunction=function($R,$F){var $i,$j=0;for($i=$t._cacheList.length,$j=0;$j<$i;$j++)if($t._cacheList[$j].tryDispose==$R&&$t._cacheList[$j].getCacheList==$F)return void $t._cacheList.splice($j,1);},$t.forceDispose=function(){var $R=0,$F=$t._cacheList.length;for($R=0;$R<$F;$R++)$t._cacheList[$R].tryDispose(!0);},$t.beginCheck=function($R){void 0===$R&&($R=15e3),$H.timer.loop($R,null,$t._checkLoop);},$t.stopCheck=function(){$H.timer.clear(null,$t._checkLoop);},$t._checkLoop=function(){var $R=$t._cacheList;if(!($R.length<1)){var $F,$i=$b.now(),$j=0;for($F=$j=$R.length;0<$j&&($R[$t._index=++$t._index%$F].tryDispose(!1),!($b.now()-$i>$t.loopTimeLimit));)$j--;}},$t.loopTimeLimit=2,$t._cacheList=[],$t._index=0,$t;}(),$y=function(){function $h(){}return $x($h,"laya.utils.ClassUtils"),$h.regClass=function($R,$F){$h._classMap[$R]=$F;},$h.getRegClass=function($R){return $h._classMap[$R];},$h.getInstance=function($R){var $F=$h.getClass($R);return $F?new $F():(console.warn("[error] Undefined class:",$R),null);},$h.createByJson=function($R,$F,$i,$j,$t){"string"==typeof $R&&($R=JSON.parse($R));var $p=$R.props;if(!$F&&!($F=$t?$t.runWith($R):$h.getInstance($p.runtime||$R.type)))return null;var $$=$R.child;if($$)for(var $V=0,$N=$$.length;$V<$N;$V++){var $c=$$[$V];if("render"!==$c.props.name&&"render"!==$c.props.renderType||!$F._$set_itemRender){if("Graphic"==$c.type)$h.addGraphicsToSprite($c,$F);else if($h.isDrawType($c.type))$h.addGraphicToSprite($c,$F,!0);else{var $q=$h.createByJson($c,null,$i,$j,$t);"Script"==$c.type?$q.hasOwnProperty("owner")?$q.owner=$F:$q.hasOwnProperty("target")&&($q.target=$F):"mask"==$c.props.renderType?$F.mask=$q:$F.addChild($q);}}else $F.itemRender=$c;}if($p)for(var $s in $p){var $k=$p[$s];"var"===$s&&$i?$i[$k]=$F:$k instanceof Array&&"function"==typeof $F[$s]?$F[$s].apply($F,$k):$F[$s]=$k;}return $j&&$R.customProps&&$j.runWith([$F,$R]),$F.created&&$F.created(),$F;},$h.addGraphicsToSprite=function($R,$F){var $i;if(($i=$R.child)&&!($i.length<1)){var $j;$j=$h._getGraphicsFromSprite($R,$F);var $t=0,$p=0;$R.props&&($t=$h._getObjVar($R.props,"x",0),$p=$h._getObjVar($R.props,"y",0)),0!=$t&&0!=$p&&$j.translate($t,$p);var $$,$V=0;for($$=$i.length,$V=0;$V<$$;$V++)$h._addGraphicToGraphics($i[$V],$j);0!=$t&&0!=$p&&$j.translate(-$t,-$p);}},$h.addGraphicToSprite=function($R,$F,$i){var $j;void 0===$i&&($i=!1),$j=$i?$h._getGraphicsFromSprite($R,$F):$F.graphics,$h._addGraphicToGraphics($R,$j);},$h._getGraphicsFromSprite=function($R,$F){var $i,$j;if(!$R||!$R.props)return $F.graphics;switch($j=$R.props.renderType){case"hit":case"unHit":var $t;$F.hitArea||($F.hitArea=new $o()),($t=$F.hitArea)[$j]||($t[$j]=new $k()),$i=$t[$j];}return $i||($i=$F.graphics),$i;},$h._getTransformData=function($R){var $F;($R.hasOwnProperty("pivotX")||$R.hasOwnProperty("pivotY"))&&($F=$F||new $Y()).translate(-$h._getObjVar($R,"pivotX",0),-$h._getObjVar($R,"pivotY",0));var $i=$h._getObjVar($R,"scaleX",1),$j=$h._getObjVar($R,"scaleY",1),$t=$h._getObjVar($R,"rotation",0);$h._getObjVar($R,"skewX",0),$h._getObjVar($R,"skewY",0);return 1==$i&&1==$j&&0==$t||(($F=$F||new $Y()).scale($i,$j),$F.rotate(.0174532922222222*$t)),$F;},$h._addGraphicToGraphics=function($R,$F){var $i,$j;if(($i=$R.props)&&($j=$h.DrawTypeDic[$R.type])){var $t,$p;$t=$F;var $$=$h._getParams($i,$j[1],$j[2],$j[3]);(($p=$h._tM)||1!=$h._alpha)&&($t.save(),$p&&$t.transform($p),1!=$h._alpha&&$t.alpha($h._alpha)),$t[$j[0]].apply($t,$$),($p||1!=$h._alpha)&&$t.restore();}},$h._adptLineData=function($R){return $R[2]=parseFloat($R[0])+parseFloat($R[2]),$R[3]=parseFloat($R[1])+parseFloat($R[3]),$R;},$h._adptTextureData=function($R){return $R[0]=$VR.getRes($R[0]),$R;},$h._adptLinesData=function($R){return $R[2]=$h._getPointListByStr($R[2]),$R;},$h.isDrawType=function($R){return"Image"!=$R&&$h.DrawTypeDic.hasOwnProperty($R);},$h._getParams=function($R,$F,$i,$j){var $t;void 0===$i&&($i=0),($t=$h._temParam).length=$F.length;var $p,$$,$V=0;for($p=$F.length,$V=0;$V<$p;$V++)$t[$V]=$h._getObjVar($R,$F[$V][0],$F[$V][1]);return $h._alpha=$h._getObjVar($R,"alpha",1),$$=$h._getTransformData($R),$h._tM=$$?($i||($i=0),$$.translate($t[$i],$t[$i+1]),$t[$i]=$t[$i+1]=0,$$):null,$j&&$h[$j]&&($t=$h[$j]($t)),$t;},$h._getPointListByStr=function($R){var $F,$i,$j=0;for($i=($F=$R.split(",")).length,$j=0;$j<$i;$j++)$F[$j]=parseFloat($F[$j]);return $F;},$h._getObjVar=function($R,$F,$i){return $R.hasOwnProperty($F)?$R[$F]:$i;},$h._temParam=[],$h._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},$h.getClass=function($R){var $F=$h._classMap[$R]||$R;return"string"==typeof $F?$H.__classmap[$F]:$F;},$h._tM=null,$h._alpha=NaN,$N($h,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]};}]),$h;}(),$E=function(){function $p($R){if(this._color=[],"string"==typeof $R){null===(this.strColor=$R)&&($R="#000000"),"#"==$R.charAt(0)&&($R=$R.substr(1));var $F=$R.length;if(3==$F||4==$F){for(var $i="",$j=0;$j<$F;$j++)$i+=$R[$j]+$R[$j];$R=$i;}var $t=this.numColor=parseInt($R,16);if(8==$R.length)return void(this._color=[parseInt($R.substr(0,2),16)/255,((16711680&$t)>>16)/255,((65280&$t)>>8)/255,(255&$t)/255]);}else $t=this.numColor=$R,this.strColor=$P.toHexColor($t);this._color=[((16711680&$t)>>16)/255,((65280&$t)>>8)/255,(255&$t)/255,1],this._color.__id=++$p._COLODID;}return $x($p,"laya.utils.Color"),$p._initDefault=function(){for(var $R in $p._DEFAULT={},$p._COLOR_MAP)$p._SAVE[$R]=$p._DEFAULT[$R]=new $p($p._COLOR_MAP[$R]);return $p._DEFAULT;},$p._initSaveMap=function(){for(var $R in $p._SAVE_SIZE=0,$p._SAVE={},$p._DEFAULT)$p._SAVE[$R]=$p._DEFAULT[$R];},$p.create=function($R){var $F=$p._SAVE[$R+""];return null!=$F?$F:($p._SAVE_SIZE<1e3||$p._initSaveMap(),$p._SAVE[$R+""]=new $p($R));},$p._SAVE={},$p._SAVE_SIZE=0,$p._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},$p._DEFAULT=$p._initDefault(),$p._COLODID=1,$p;}(),$l=(function(){function $R(){this._values=[],this._keys=[];}$x($R,"laya.utils.Dictionary");var $F=$R.prototype;$F.set=function($R,$F){var $i=this.indexOf($R);0<=$i?this._values[$i]=$F:(this._keys.push($R),this._values.push($F));},$F.indexOf=function($R){var $F=this._keys.indexOf($R);return 0<=$F?$F:($R="string"==typeof $R?Number($R):"number"==typeof $R?$R.toString():$R,this._keys.indexOf($R));},$F.get=function($R){var $F=this.indexOf($R);return $F<0?null:this._values[$F];},$F.remove=function($R){var $F=this.indexOf($R);return 0<=$F&&(this._keys.splice($F,1),this._values.splice($F,1),!0);},$F.clear=function(){this._values.length=0,this._keys.length=0;},$q(0,$F,"values",function(){return this._values;}),$q(0,$F,"keys",function(){return this._keys;});}(),function(){function $R(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0;}$x($R,"laya.utils.Dragging");var $F=$R.prototype;return $F.start=function($R,$F,$i,$j,$t,$p,$$,$V){void 0===$V&&($V=.92),this.clearTimer(),this.target=$R,this.area=$F,this.hasInertia=$i,this.elasticDistance=$F?$j:0,this.elasticBackTime=$t,this.data=$p,this._disableMouseEvent=$$,this.ratio=$V,1!=$R.globalScaleX||1!=$R.globalScaleY?this._parent=$R.parent:this._parent=$H.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,$H.stage.on("mouseup",this,this.onStageMouseUp),$H.stage.on("mouseout",this,this.onStageMouseUp),$H.timer.frameLoop(1,this,this.loop);},$F.clearTimer=function(){$H.timer.clear(this,this.loop),$H.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null);},$F.stop=function(){this._dragging&&($S.instance.disableMouseEvent=!1,$H.stage.off("mouseup",this,this.onStageMouseUp),$H.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear());},$F.loop=function(){var $R=this._parent.getMousePoint(),$F=$R.x,$i=$R.y,$j=$F-this._lastX,$t=$i-this._lastY;if(this._clickOnly){if(!(1<Math.abs($j*$H.stage._canvasTransform.getScaleX())||1<Math.abs($t*$H.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),$S.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1);}else this._offsets.push($j,$t);0==$j&&0==$t||(this._lastX=$F,this._lastY=$i,this.target.x+=$j*this._elasticRateX,this.target.y+=$t*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data));},$F.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var $R=this.area.x-this.target.x;else $R=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-$R/this.elasticDistance),this.target.y<this.area.y)var $F=this.area.y-this.target.y;else $F=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-$F/this.elasticDistance);}},$F.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height);},$F.onStageMouseUp=function($R){if($S.instance.disableMouseEvent=!1,$H.stage.off("mouseup",this,this.onStageMouseUp),$H.stage.off("mouseout",this,this.onStageMouseUp),$H.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var $F=this._offsets.length,$i=Math.min($F,6),$j=this._offsets.length-$i,$t=$F-1;$j<$t;$t--)this._offsetY+=this._offsets[$t--],this._offsetX+=this._offsets[$t];this._offsetX=this._offsetX/$i*2,this._offsetY=this._offsetY/$i*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),$H.timer.frameLoop(1,this,this.tweenMove);}else 0<this.elasticDistance?this.checkElastic():this.clear();},$F.checkElastic=function(){var $R=NaN,$F=NaN;if(this.target.x<this.area.x?$R=this.area.x:this.target.x>this.area.x+this.area.width&&($R=this.area.x+this.area.width),this.target.y<this.area.y?$F=this.area.y:this.target.y>this.area.y+this.area.height&&($F=this.area.y+this.area.height),isNaN($R)&&isNaN($F))this.clear();else{var $i={};isNaN($R)||($i.x=$R),isNaN($F)||($i.y=$F),this._tween=$A.to(this.target,$i,this.elasticBackTime,$W.sineOut,$M.create(this,this.clear),0,!1,!1);}},$F.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&($H.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear());},$F.clear=function(){if(this.target){this.clearTimer();var $R=this.target;this.target=null,this._parent=null,$R.event("dragend",this.data);}},$R;}()),$W=function(){function $V(){}return $x($V,"laya.utils.Ease"),$V.linearNone=function($R,$F,$i,$j){return $i*$R/$j+$F;},$V.linearIn=function($R,$F,$i,$j){return $i*$R/$j+$F;},$V.linearInOut=function($R,$F,$i,$j){return $i*$R/$j+$F;},$V.linearOut=function($R,$F,$i,$j){return $i*$R/$j+$F;},$V.bounceIn=function($R,$F,$i,$j){return $i-$V.bounceOut($j-$R,0,$i,$j)+$F;},$V.bounceInOut=function($R,$F,$i,$j){return $R<.5*$j?.5*$V.bounceIn(2*$R,0,$i,$j)+$F:.5*$V.bounceOut(2*$R-$j,0,$i,$j)+.5*$i+$F;},$V.bounceOut=function($R,$F,$i,$j){return($R/=$j)<1/2.75?$i*(7.5625*$R*$R)+$F:$R<2/2.75?$i*(7.5625*($R-=1.5/2.75)*$R+.75)+$F:$R<2.5/2.75?$i*(7.5625*($R-=2.25/2.75)*$R+.9375)+$F:$i*(7.5625*($R-=2.625/2.75)*$R+.984375)+$F;},$V.backIn=function($R,$F,$i,$j,$t){return void 0===$t&&($t=1.70158),$i*($R/=$j)*$R*(($t+1)*$R-$t)+$F;},$V.backInOut=function($R,$F,$i,$j,$t){return void 0===$t&&($t=1.70158),($R/=.5*$j)<1?.5*$i*($R*$R*((1+($t*=1.525))*$R-$t))+$F:$i/2*(($R-=2)*$R*((1+($t*=1.525))*$R+$t)+2)+$F;},$V.backOut=function($R,$F,$i,$j,$t){return void 0===$t&&($t=1.70158),$i*(($R=$R/$j-1)*$R*(($t+1)*$R+$t)+1)+$F;},$V.elasticIn=function($R,$F,$i,$j,$t,$p){var $$;return void 0===$t&&($t=0),void 0===$p&&($p=0),0==$R?$F:1==($R/=$j)?$F+$i:($p||($p=.3*$j),$$=!$t||0<$i&&$t<$i||$i<0&&$t<-$i?($t=$i,$p/4):$p/$V.PI2*Math.asin($i/$t),-$t*Math.pow(2,10*($R-=1))*Math.sin(($R*$j-$$)*$V.PI2/$p)+$F);},$V.elasticInOut=function($R,$F,$i,$j,$t,$p){var $$;return void 0===$t&&($t=0),void 0===$p&&($p=0),0==$R?$F:2==($R/=.5*$j)?$F+$i:($p||($p=$j*(.3*1.5)),$$=!$t||0<$i&&$t<$i||$i<0&&$t<-$i?($t=$i,$p/4):$p/$V.PI2*Math.asin($i/$t),$R<1?$t*Math.pow(2,10*($R-=1))*Math.sin(($R*$j-$$)*$V.PI2/$p)*-.5+$F:$t*Math.pow(2,-10*($R-=1))*Math.sin(($R*$j-$$)*$V.PI2/$p)*.5+$i+$F);},$V.elasticOut=function($R,$F,$i,$j,$t,$p){var $$;return void 0===$t&&($t=0),void 0===$p&&($p=0),0==$R?$F:1==($R/=$j)?$F+$i:($p||($p=.3*$j),$$=!$t||0<$i&&$t<$i||$i<0&&$t<-$i?($t=$i,$p/4):$p/$V.PI2*Math.asin($i/$t),$t*Math.pow(2,-10*$R)*Math.sin(($R*$j-$$)*$V.PI2/$p)+$i+$F);},$V.strongIn=function($R,$F,$i,$j){return $i*($R/=$j)*$R*$R*$R*$R+$F;},$V.strongInOut=function($R,$F,$i,$j){return($R/=.5*$j)<1?.5*$i*$R*$R*$R*$R*$R+$F:.5*$i*(($R-=2)*$R*$R*$R*$R+2)+$F;},$V.strongOut=function($R,$F,$i,$j){return $i*(($R=$R/$j-1)*$R*$R*$R*$R+1)+$F;},$V.sineInOut=function($R,$F,$i,$j){return .5*-$i*(Math.cos(Math.PI*$R/$j)-1)+$F;},$V.sineIn=function($R,$F,$i,$j){return-$i*Math.cos($R/$j*$V.HALF_PI)+$i+$F;},$V.sineOut=function($R,$F,$i,$j){return $i*Math.sin($R/$j*$V.HALF_PI)+$F;},$V.quintIn=function($R,$F,$i,$j){return $i*($R/=$j)*$R*$R*$R*$R+$F;},$V.quintInOut=function($R,$F,$i,$j){return($R/=.5*$j)<1?.5*$i*$R*$R*$R*$R*$R+$F:.5*$i*(($R-=2)*$R*$R*$R*$R+2)+$F;},$V.quintOut=function($R,$F,$i,$j){return $i*(($R=$R/$j-1)*$R*$R*$R*$R+1)+$F;},$V.quartIn=function($R,$F,$i,$j){return $i*($R/=$j)*$R*$R*$R+$F;},$V.quartInOut=function($R,$F,$i,$j){return($R/=.5*$j)<1?.5*$i*$R*$R*$R*$R+$F:.5*-$i*(($R-=2)*$R*$R*$R-2)+$F;},$V.quartOut=function($R,$F,$i,$j){return-$i*(($R=$R/$j-1)*$R*$R*$R-1)+$F;},$V.cubicIn=function($R,$F,$i,$j){return $i*($R/=$j)*$R*$R+$F;},$V.cubicInOut=function($R,$F,$i,$j){return($R/=.5*$j)<1?.5*$i*$R*$R*$R+$F:.5*$i*(($R-=2)*$R*$R+2)+$F;},$V.cubicOut=function($R,$F,$i,$j){return $i*(($R=$R/$j-1)*$R*$R+1)+$F;},$V.quadIn=function($R,$F,$i,$j){return $i*($R/=$j)*$R+$F;},$V.quadInOut=function($R,$F,$i,$j){return($R/=.5*$j)<1?.5*$i*$R*$R+$F:.5*-$i*(--$R*($R-2)-1)+$F;},$V.quadOut=function($R,$F,$i,$j){return-$i*($R/=$j)*($R-2)+$F;},$V.expoIn=function($R,$F,$i,$j){return 0==$R?$F:$i*Math.pow(2,10*($R/$j-1))+$F-.001*$i;},$V.expoInOut=function($R,$F,$i,$j){return 0==$R?$F:$R==$j?$F+$i:($R/=.5*$j)<1?.5*$i*Math.pow(2,10*($R-1))+$F:.5*$i*(2-Math.pow(2,-10*--$R))+$F;},$V.expoOut=function($R,$F,$i,$j){return $R==$j?$F+$i:$i*(1-Math.pow(2,-10*$R/$j))+$F;},$V.circIn=function($R,$F,$i,$j){return-$i*(Math.sqrt(1-($R/=$j)*$R)-1)+$F;},$V.circInOut=function($R,$F,$i,$j){return($R/=.5*$j)<1?.5*-$i*(Math.sqrt(1-$R*$R)-1)+$F:.5*$i*(Math.sqrt(1-($R-=2)*$R)+1)+$F;},$V.circOut=function($R,$F,$i,$j){return $i*Math.sqrt(1-($R=$R/$j-1)*$R)+$F;},$V.HALF_PI=.5*Math.PI,$V.PI2=2*Math.PI,$V;}(),$o=function(){function $s(){this._hit=null,this._unHit=null;}$x($s,"laya.utils.HitArea");var $R=$s.prototype;return $R.isHit=function($R,$F){return!!$s.isHitGraphic($R,$F,this.hit)&&!$s.isHitGraphic($R,$F,this.unHit);},$R.contains=function($R,$F){return this.isHit($R,$F);},$q(0,$R,"hit",function(){return this._hit||(this._hit=new $k()),this._hit;},function($R){this._hit=$R;}),$q(0,$R,"unHit",function(){return this._unHit||(this._unHit=new $k()),this._unHit;},function($R){this._unHit=$R;}),$s.isHitGraphic=function($R,$F,$i){if(!$i)return!1;var $j;if(!($j=$i.cmds)&&$i._one&&(($j=$s._cmds).length=1,$j[0]=$i._one),!$j)return!1;var $t,$p,$$=0;for($t=$j.length,$$=0;$$<$t;$$++)if($p=$j[$$]){var $V=$u._context;switch($p.callee){case $V._translate:case 6:$R-=$p[0],$F-=$p[1];}if($s.isHitCmd($R,$F,$p))return!0;}return!1;},$s.isHitCmd=function($R,$F,$i){if(!$i)return!1;var $j=$u._context,$t=!1;switch($i.callee){case $j._drawRect:case 13:$s._rec.setTo($i[0],$i[1],$i[2],$i[3]),$t=$s._rec.contains($R,$F);break;case $j._drawCircle:case $j._fillCircle:case 14:$t=($R-=$i[0])*$R+($F-=$i[1])*$F<$i[2]*$i[2];break;case $j._drawPoly:case 18:$R-=$i[0],$F-=$i[1],$t=$s.ptInPolygon($R,$F,$i[2]);}return $t;},$s.ptInPolygon=function($R,$F,$i){var $j;($j=$s._ptPoint).setTo($R,$F);var $t,$p=0,$$=NaN,$V=NaN,$N=NaN,$c=NaN;$t=$i.length;for(var $q=0;$q<$t;$q+=2){if($$=$i[$q],$V=$i[$q+1],$N=$i[($q+2)%$t],$V!=($c=$i[($q+3)%$t]))if(!($j.y<Math.min($V,$c)))if(!($j.y>=Math.max($V,$c)))($j.y-$V)*($N-$$)/($c-$V)+$$>$j.x&&$p++;}return $p%2==1;},$s._cmds=[],$N($s,["_rec",function(){return this._rec=new $T();},"_ptPoint",function(){return this._ptPoint=new $_();}]),$s;}(),$n=(function(){function $t($R,$F,$i,$j){this.char=$R,this.charNum=$R.charCodeAt(0),this._x=this._y=0,this.width=$F,this.height=$i,this.style=$j,this.isWord=!$t._isWordRegExp.test($R);}$x($t,"laya.utils.HTMLChar");var $R=$t.prototype;$H.imps($R,{"laya.display.ILayout":!0}),$R.setSprite=function($R){this._sprite=$R;},$R.getSprite=function(){return this._sprite;},$R._isChar=function(){return!0;},$R._getCSSStyle=function(){return this.style;},$q(0,$R,"width",function(){return this._w;},function($R){this._w=$R;}),$q(0,$R,"x",function(){return this._x;},function($R){this._sprite&&(this._sprite.x=$R),this._x=$R;}),$q(0,$R,"y",function(){return this._y;},function($R){this._sprite&&(this._sprite.y=$R),this._y=$R;}),$q(0,$R,"height",function(){return this._h;},function($R){this._h=$R;}),$t._isWordRegExp=new RegExp("[\\w.]","");}(),function(){function $F(){}$x($F,"laya.utils.Log"),$F.enable=function(){$F._logdiv||($F._logdiv=$b.window.document.createElement("div"),$b.window.document.body.appendChild($F._logdiv),$F._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;");},$F.toggle=function(){var $R=$F._logdiv.style;"1px"==$R.width?$R.width=$R.height="50%":$R.width=$R.height="1px";},$F.print=function($R){$F._logdiv&&($F.maxCount<=$F._count&&$F.clear(),$F._count++,$F._logdiv.innerText+=$R+"\n",$F._logdiv.scrollTop=$F._logdiv.scrollHeight);},$F.clear=function(){$F._logdiv.innerText="",$F._count=0;},$F._logdiv=null,$F._count=0,$F.maxCount=20;}(),function(){function $F(){}$x($F,"laya.utils.Mouse"),$q(1,$F,"cursor",function(){return $F._style.cursor;},function($R){$F._style.cursor=$R;}),$F.hide=function(){"none"!=$F.cursor&&($F._preCursor=$F.cursor,$F.cursor="none");},$F.show=function(){"none"==$F.cursor&&($F.cursor=$F._preCursor?$F._preCursor:"auto");},$F._preCursor=null,$N($F,["_style",function(){return this._style=$b.document.body.style;}]);}(),function(){function $p(){}return $x($p,"laya.utils.Pool"),$p.getPoolBySign=function($R){return $p._poolDic[$R]||($p._poolDic[$R]=[]);},$p.clearBySign=function($R){$p._poolDic[$R]&&($p._poolDic[$R].length=0);},$p.recover=function($R,$F){$F.__InPool||($F.__InPool=!0,$p.getPoolBySign($R).push($F));},$p.getItemByClass=function($R,$F){var $i=$p.getPoolBySign($R),$j=$i.length?$i.pop():new $F();return $j.__InPool=!1,$j;},$p.getItemByCreateFun=function($R,$F,$i){var $j=$p.getPoolBySign($R),$t=$j.length?$j.pop():$F.call($i);return $t.__InPool=!1,$t;},$p.getItem=function($R){var $F=$p.getPoolBySign($R),$i=$F.length?$F.pop():null;return $i&&($i.__InPool=!1),$i;},$p._poolDic={},$p.InPoolSign="__InPool",$p;}()),$C=function(){function $N(){}return $x($N,"laya.utils.Stat"),$q(1,$N,"onclick",null,function($R){$N._sp&&$N._sp.on("click",$N._sp,$R),$N._canvas&&($N._canvas.source.onclick=$R,$N._canvas.source.style.pointerEvents="");}),$N.show=function($R,$F,$i){if(void 0===$R&&($R=0),void 0===$F&&($F=0),void 0===$i&&($i=0),!$u.isConchApp||$u.isConchWebGL){if($u.isConchWebGL||$b.onMiniGame||$b.onLimixiu||($N._useCanvas=!0),$N._show=!0,$N._fpsData.length=60,$N._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},$N._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},$N._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},$N._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},$u.isWebGL){if($N._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},$u.is3DMode){if($N._view[0].title="FPS(3D)",$N._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},$N._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},$N._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==$i){var $j=8;$N._view[$j++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},$N._view[$j++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$N._view[$j++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},$N._view[$j++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$N._view[$j++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$N._view[$j++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$N._view[$j++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$N._view[$j++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},$N._view[$j++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1};}else if(2==$i){$j=8;$N._view[$j++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},$N._view[$j++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},$N._view[$j++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},$N._view[$j++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},$N._view[$j++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},$N._view[$j++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},$N._view[$j++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2};}}else $N._view[0].title="FPS(WebGL)",$N._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};}else $N._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};$N._useCanvas?$N.createUIPre($R,$F):$N.createUI($R,$F),$N.enable();}else $b.window.conch.showFPS&&$b.window.conch.showFPS($R,$F);},$N.createUIPre=function($R,$F){var $i=$b.pixelRatio;$N._width=170*$i,$N._vx=75*$i,$N._height=$i*(12*$N._view.length+3*$i)+4,$N._fontSize=12*$i;for(var $j=0;$j<$N._view.length;$j++)$N._view[$j].x=4,$N._view[$j].y=$j*$N._fontSize+2*$i;$N._canvas||(($N._canvas=new $JR("2D")).size($N._width,$N._height),($N._ctx=$N._canvas.getContext("2d")).textBaseline="top",$N._ctx.font=$N._fontSize+"px Sans-serif",$N._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+$R+"px;top:"+$F+"px;width:"+$N._width/$i+"px;height:"+$N._height/$i+"px;"),$N._first=!0,$N.loop(),$N._first=!1,$b.container.appendChild($N._canvas.source);},$N.createUI=function($R,$F){var $i=$N._sp,$j=$b.pixelRatio;$i||($i=new $sR(),($N._leftText=new $aR()).pos(5,5),$N._leftText.color="#ffffff",$i.addChild($N._leftText),($N._txt=new $aR()).pos(80*$j,5),$N._txt.color="#ffffff",$i.addChild($N._txt),$N._sp=$i),$i.pos($R,$F);for(var $t="",$p=0;$p<$N._view.length;$p++){$t+=$N._view[$p].title+"\n";}$N._leftText.text=$t;var $$=170*$j,$V=$j*(12*$N._view.length+3*$j)+4;$N._txt.fontSize=$N._fontSize*$j,$N._leftText.fontSize=$N._fontSize*$j,$i.size($$,$V),$i.graphics.clear(),$i.graphics.setAlpha(.5),$i.graphics.drawRect(0,0,$$,$V,"#999999"),$i.graphics.setAlpha(1),$N.loop();},$N.enable=function(){$H.timer.frameLoop(1,$N,$N.loop);},$N.hide=function(){$N._show=!1,$H.timer.clear($N,$N.loop),$N._canvas&&$b.removeElement($N._canvas.source);},$N.clear=function(){$N.trianglesFaces=$N.drawCall=$N.shaderCall=$N.spriteCount=$N.spriteRenderUseCacheCount=$N.treeNodeCollision=$N.treeSpriteCollision=$N.canvasNormal=$N.canvasBitmap=$N.canvasReCache=0;},$N.loop=function(){$N._count++;var $R=$b.now();if(!($R-$N._timer<1e3)){var $F=$N._count;if($N.FPS=Math.round(1e3*$F/($R-$N._timer)),$N._show){$N.trianglesFaces=Math.round($N.trianglesFaces/$F),$N.spriteCount=$N._useCanvas?($N.drawCall=Math.round($N.drawCall/$F)-2,$N.shaderCall=Math.round($N.shaderCall/$F),Math.round($N.spriteCount/$F)-1):($N.drawCall=Math.round($N.drawCall/$F)-2,$N.shaderCall=Math.round($N.shaderCall/$F)-4,Math.round($N.spriteCount/$F)-4),$N.spriteRenderUseCacheCount=Math.round($N.spriteRenderUseCacheCount/$F),$N.canvasNormal=Math.round($N.canvasNormal/$F),$N.canvasBitmap=Math.round($N.canvasBitmap/$F),$N.canvasReCache=Math.ceil($N.canvasReCache/$F),$N.treeNodeCollision=Math.round($N.treeNodeCollision/$F),$N.treeSpriteCollision=Math.round($N.treeSpriteCollision/$F);var $i=0<$N.FPS?Math.floor(1e3/$N.FPS).toString():" ";$N._fpsStr=$N.FPS+($N.renderSlow?" slow":"")+" "+$i,$N._spriteStr=$N.spriteCount+($N.spriteRenderUseCacheCount?"/"+$N.spriteRenderUseCacheCount:""),$N._canvasStr=$N.canvasReCache+"/"+$N.canvasNormal+"/"+$N.canvasBitmap,$N.currentMemorySize=$Q.systemResourceManager.memorySize,$N._useCanvas?$N.renderInfoPre():$N.renderInfo(),$N.clear();}$N._count=0,$N._timer=$R;}},$N.renderInfoPre=function(){if($N._canvas){var $R=$N._ctx;$R.clearRect($N._first?0:$N._vx,0,$N._width,$N._height);for(var $F=$u.WebGL.mainContext,$i=0;$i<$N._view.length;$i++){var $j=$N._view[$i];$N._first&&($R.fillStyle="white",$R.fillText($j.title,$j.x,$j.y,null,null,null)),$R.fillStyle=$j.color;var $t=-1;if(($j=$N._view[$i]).varying){if($F)switch($j.varying){case 1:$t=$F.getParameter($F[$j.value]);break;case 2:$t=$F.getExtension($j.value);}}else $t=$N[$j.value];"M"==$j.units&&($t=Math.floor($t/1048576*100)/100+" M"),"K"==$j.units&&($t=Math.floor($t/1024*100)/100+" K"),"string"==$j.units&&($t=$t.match(/\d+\.?\d/i)),$R.fillText($t+"",$j.x+$N._vx,$j.y,null,null,null);}}},$N.renderInfo=function(){for(var $R="",$F=$u.WebGL.mainContext,$i=0;$i<$N._view.length;$i++){var $j=$N._view[$i],$t=-1;if($j.varying){if($F)switch($j.varying){case 1:$t=$F.getParameter($F[$j.value]);break;case 2:$t=$F.getExtension($j.value);}}else $t=$N[$j.value];"M"==$j.units&&($t=Math.floor($t/1048576*100)/100+" M"),"K"==$j.units&&($t=Math.floor($t/1024*100)/100+" K"),"string"==$j.units&&($t=$t.match(/\d+\.?\d/i)),$R+=$t+"\n";}$N._txt.text=$R;},$N.FPS=0,$N.loopCount=0,$N.shaderCall=0,$N.drawCall=0,$N.trianglesFaces=0,$N.spriteCount=0,$N.spriteRenderUseCacheCount=0,$N.treeNodeCollision=0,$N.treeSpriteCollision=0,$N.canvasNormal=0,$N.canvasBitmap=0,$N.canvasReCache=0,$N.renderSlow=!1,$N.currentMemorySize=0,$N._fpsStr=null,$N._canvasStr=null,$N._spriteStr=null,$N._fpsData=[],$N._timer=0,$N._count=0,$N._view=[],$N._fontSize=12,$N._txt=null,$N._leftText=null,$N._sp=null,$N._show=!1,$N._useCanvas=!1,$N._canvas=null,$N._ctx=null,$N._first=!1,$N._vx=NaN,$N._width=0,$N._height=100,$N;}(),$r=(function(){function $R(){this._strsToID={},this._idToStrs=[],this._length=0;}$x($R,"laya.utils.StringKey");var $F=$R.prototype;$F.add=function($R){var $F=this._strsToID[$R];return null!=$F?$F:(this._idToStrs[this._length]=$R,this._strsToID[$R]=this._length++);},$F.getID=function($R){var $F=this._strsToID[$R];return null==$F?-1:$F;},$F.getName=function($R){var $F=this._idToStrs[$R];return null==$F?void 0:$F;};}(),function(){var $c;function $R(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init();}$x($R,"laya.utils.Timer");var $F=$R.prototype;return $F._init=function(){$H.timer&&$H.timer.frameLoop(1,this,this._update);},$F._now=function(){return Date.now();},$F._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var $R=this.currFrame=this.currFrame+this.scale,$F=this._now();this._delta=($F-this._lastTimer)*this.scale;var $i=this.currTimer=this.currTimer+this._delta;$H.isDebug&&6e4<Math.abs($F-this._lastTimer)&&console.error("系统时间错误！"+($F-this._lastTimer)),this._lastTimer=$F;var $j=this._handlers;for($$=this._count=0,$V=$j.length;$$<$V;$$++)if(null!==($N=$j[$$]).method){var $t=$N.userFrame?$R:$i;if($t>=$N.exeTime)if($N.repeat){if($N.jumpFrame)for(;$t>=$N.exeTime;)$N.exeTime+=$N.delay,$N.run(!1);else $N.exeTime+=$N.delay,$N.run(!1),$t>$N.exeTime&&($N.exeTime+=Math.ceil(($t-$N.exeTime)/$N.delay)*$N.delay);}else $N.run(!0);}else this._count++;(30<this._count||$R%200==0)&&this._clearHandlers();for(var $p=this._laters,$$=0,$V=$p.length-1;$$<=$V;$$++){var $N=$p[$$];this._isIgnoreRecover($N)||(null!==$N.method&&(delete this._map[$N.key],$N.run(!1)),this._recoverHandler($N)),$$===$V&&($V=$p.length-1);}$p.length=0;}},$F._clearHandlers=function(){for(var $R=this._handlers,$F=0,$i=$R.length;$F<$i;$F++){var $j=$R[$F];null!==$j.method?this._temp.push($j):this._isIgnoreRecover($j)?this._temp.push($j):this._recoverHandler($j);}this._handlers=this._temp,this._temp=$R,this._temp.length=0;},$F._recoverHandler=function($R){this._map[$R.key]==$R&&delete this._map[$R.key],$R.recover();},$F._create=function($R,$F,$i,$j,$t,$p,$$,$V){if(!$i)return $t.apply($j,$p),null;if($$){var $N=this._getHandler($j,$t);if($N)return $N.repeat=$F,$N.userFrame=$R,$N.delay=$i,$N.ignoreRecover=$V,$N.caller=$j,$N.method=$t,$N.args=$p,$N.exeTime=$i+($R?this.currFrame:this.currTimer+this._now()-this._lastTimer),$N;}return($N=$c.create()).repeat=$F,$N.userFrame=$R,$N.delay=$i,$N.ignoreRecover=$V,$N.caller=$j,$N.method=$t,$N.args=$p,$N.exeTime=$i+($R?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler($N),this._handlers.push($N),$N;},$F._indexHandler=function($R){var $F=$R.caller,$i=$R.method,$j=$F?$F.$_GID||($F.$_GID=$P.getGID()):0,$t=$i.$_TID||($i.$_TID=this._mid++);$R.key=$j+"_"+$t,this._map[$R.key]=$R;},$F.once=function($R,$F,$i,$j,$t){void 0===$t&&($t=!0),this._create(!1,!1,$R,$F,$i,$j,$t,!1);},$F.loop=function($R,$F,$i,$j,$t,$p,$$){void 0===$t&&($t=!0),void 0===$p&&($p=!1),void 0===$$&&($$=!1);var $V=this._create(!1,!0,$R,$F,$i,$j,$t,$$);$V&&($V.jumpFrame=$p);},$F.frameOnce=function($R,$F,$i,$j,$t){void 0===$t&&($t=!0),this._create(!0,!1,$R,$F,$i,$j,$t,!1);},$F.frameLoop=function($R,$F,$i,$j,$t,$p){void 0===$t&&($t=!0),void 0===$p&&($p=!1),this._create(!0,!0,$R,$F,$i,$j,$t,$p);},$F.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+$c._freeCount;},$F.clear=function($R,$F){var $i=this._getHandler($R,$F);return!(!$i||this._isIgnoreRecover($i))&&(delete this._map[$i.key],$i.key=null,$i.clear(),!0);},$F.clearAll=function($R){if($R)for(var $F=0,$i=this._handlers.length;$F<$i;$F++){var $j=this._handlers[$F];$j.caller===$R&&(this._isIgnoreRecover($j)||(delete this._map[$j.key],$j.key=null,$j.clear()));}},$F._getHandler=function($R,$F){var $i=$R?$R.$_GID||($R.$_GID=$P.getGID()):0,$j=$F.$_TID||($F.$_TID=this._mid++);return this._map[$i+"_"+$j];},$F._isIgnoreRecover=function($R){if($R.ignoreRecover||$R.caller&&"IgnoreRecover"==$R.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var $F="";try{arguments.propertyIsEnumerable.caller;}catch($R){$F=$R.stack;}$H.recordError("报错：核心定时器销毁忽略  "+$F);}return!0;}return!1;},$F.hasHandler=function($R,$F){return this._map[$R.$_GID+"_"+$F.$_TID];},$F.callLater=function($R,$F,$i){if(null==this._getHandler($R,$F)){var $j=$c.create();$j.caller=$R,$j.method=$F,$j.args=$i,this._indexHandler($j),this._laters.push($j);}},$F.runCallLater=function($R,$F){var $i=this._getHandler($R,$F);$i&&null!=$i.method&&(this._isIgnoreRecover($i)||(delete this._map[$i.key],$i.run(!0)));},$F.runTimer=function($R,$F){this.runCallLater($R,$F);},$q(0,$F,"delta",function(){return this._delta;}),$R.__init$=function(){$c=function(){function $F(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1;}$x($F,"");var $R=$F.prototype;return $R.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1;},$R.recover=function(){this.clear(),this.args=$F._freeHandler,$F._freeHandler=this,$F._freeCount++;},$R.run=function($R){var $F=this.caller;if($F&&$F.destroyed)return this.clear();var $i=this.method,$j=this.args;$R&&this.clear(),null!=$i&&($j?$i.apply($F,$j):$i.call($F));},$F._freeHandler=null,$F._freeCount=0,$F.create=function(){var $R=$F._freeHandler;return $R?($F._freeHandler=$R.args,--$F._freeCount,$R.args=null,$R):new $F();},$F;}();},$R;}()),$A=function(){function $s(){this.gid=0;}$x($s,"laya.utils.Tween");var $R=$s.prototype;return $R.to=function($R,$F,$i,$j,$t,$p,$$){return void 0===$p&&($p=0),void 0===$$&&($$=!1),this._create($R,$F,$i,$j,$t,$p,$$,!0,!1,!0);},$R.from=function($R,$F,$i,$j,$t,$p,$$){return void 0===$p&&($p=0),void 0===$$&&($$=!1),this._create($R,$F,$i,$j,$t,$p,$$,!1,!1,!0);},$R._create=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){if(!$R)throw new Error("Tween:target is null");this._target=$R,this._duration=$i,this._ease=$j||$F.ease||$s.easeNone,this._complete=$t||$F.complete,this._delay=$p,this._props=[],this._usedTimer=0,this._startTimer=$b.now(),this._usedPool=$N,this._delayParam=null,this.update=$F.update;var $q=$R.$_GID||($R.$_GID=$P.getGID());return $s.tweenMap[$q]?($$&&$s.clearTween($R),$s.tweenMap[$q].push(this)):$s.tweenMap[$q]=[this],$c?$p<=0?this.firstStart($R,$F,$V):(this._delayParam=[$R,$F,$V],$H.scaleTimer.once($p,this,this.firstStart,this._delayParam)):this._initProps($R,$F,$V),this;},$R.firstStart=function($R,$F,$i){this._delayParam=null,$R.destroyed?this.clear():(this._initProps($R,$F,$i),this._beginLoop());},$R._initProps=function($R,$F,$i){for(var $j in $F)if("number"==typeof $R[$j]){var $t=$i?$R[$j]:$F[$j],$p=$i?$F[$j]:$R[$j];this._props.push([$j,$t,$p-$t]),$i||($R[$j]=$t);}},$R._beginLoop=function(){$H.scaleTimer.frameLoop(1,this,this._doEase);},$R._doEase=function(){this._updateEase($b.now());},$R._updateEase=function($R){var $F=this._target;if($F){if($F.destroyed)return $s.clearTween($F);var $i=this._usedTimer=$R-this._startTimer-this._delay;if(!($i<0)){if($i>=this._duration)return this.complete();for(var $j=0<$i?this._ease($i,0,1,this._duration):0,$t=this._props,$p=0,$$=$t.length;$p<$$;$p++){var $V=$t[$p];$F[$V[0]]=$V[1]+$j*$V[2];}this.update&&this.update.run();}}},$R.complete=function(){if(this._target){$H.scaleTimer.runTimer(this,this.firstStart);for(var $R=this._target,$F=this._props,$i=this._complete,$j=0,$t=$F.length;$j<$t;$j++){var $p=$F[$j];$R[$p[0]]=$p[1]+$p[2];}this.update&&this.update.run(),this.clear(),$i&&$i.run();}},$R.pause=function(){$H.scaleTimer.clear(this,this._beginLoop),$H.scaleTimer.clear(this,this._doEase),$H.scaleTimer.clear(this,this.firstStart);var $R;($R=$b.now()-this._startTimer-this._delay)<0&&(this._usedTimer=$R);},$R.setStartTime=function($R){this._startTimer=$R;},$R.clear=function(){this._target&&(this._remove(),this._clear());},$R._clear=function(){this.pause(),$H.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,$n.recover("tween",this));},$R.recover=function(){this._usedPool=!0,this._clear();},$R._remove=function(){var $R=$s.tweenMap[this._target.$_GID];if($R)for(var $F=0,$i=$R.length;$F<$i;$F++)if($R[$F]===this){$R.splice($F,1);break;}},$R.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=$b.now(),this._delayParam)$H.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var $R=this._props,$F=0,$i=$R.length;$F<$i;$F++){var $j=$R[$F];this._target[$j[0]]=$j[1];}$H.scaleTimer.once(this._delay,this,this._beginLoop);}},$R.resume=function(){this._usedTimer>=this._duration||(this._startTimer=$b.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?$H.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop());},$q(0,$R,"progress",null,function($R){var $F=$R*this._duration;this._startTimer=$b.now()-this._delay-$F;}),$s.to=function($R,$F,$i,$j,$t,$p,$$,$V){return void 0===$p&&($p=0),void 0===$$&&($$=!1),void 0===$V&&($V=!0),$n.getItemByClass("tween",$s)._create($R,$F,$i,$j,$t,$p,$$,!0,$V,!0);},$s.from=function($R,$F,$i,$j,$t,$p,$$,$V){return void 0===$p&&($p=0),void 0===$$&&($$=!1),void 0===$V&&($V=!0),$n.getItemByClass("tween",$s)._create($R,$F,$i,$j,$t,$p,$$,!1,$V,!0);},$s.clearAll=function($R){if($R&&$R.$_GID){var $F=$s.tweenMap[$R.$_GID];if($F){for(var $i=0,$j=$F.length;$i<$j;$i++)$F[$i]._clear();$F.length=0;}}},$s.clear=function($R){$R.clear();},$s.clearTween=function($R){$s.clearAll($R);},$s.easeNone=function($R,$F,$i,$j){return $i*$R/$j+$F;},$s.tweenMap={},$s;}(),$P=function(){function $V(){}return $x($V,"laya.utils.Utils"),$V.toRadian=function($R){return $R*$V._pi2;},$V.toAngle=function($R){return $R*$V._pi;},$V.toHexColor=function($R){if($R<0||isNaN($R))return null;for(var $F=$R.toString(16);$F.length<6;)$F="0"+$F;return"#"+$F;},$V.getGID=function(){return $V._gid++;},$V.concatArray=function($R,$F){if(!$F)return $R;if(!$R)return $F;var $i=0,$j=$F.length;for($i=0;$i<$j;$i++)$R.push($F[$i]);return $R;},$V.clearArray=function($R){return $R&&($R.length=0),$R;},$V.copyArray=function($R,$F){if($R||($R=[]),!$F)return $R;$R.length=$F.length;var $i=0,$j=$F.length;for($i=0;$i<$j;$i++)$R[$i]=$F[$i];return $R;},$V.getGlobalRecByPoints=function($R,$F,$i,$j,$t){var $p,$$;return $p=new $_($F,$i),$p=$R.localToGlobal($p),$$=new $_($j,$t),$$=$R.localToGlobal($$),$T._getWrapRec([$p.x,$p.y,$$.x,$$.y]);},$V.getGlobalPosAndScale=function($R){return $V.getGlobalRecByPoints($R,0,0,1,1);},$V.bind=function($R,$F){return $R.bind($F);},$V.measureText=function($R,$F){return $L.measureText($R,$F);},$V.contextMeasureText=function($R){var $F=$b.context.measureText($R);return $F||($F={width:16,height:16}),$F;},$V.updateOrder=function($R){if(!$R||$R.length<2)return!1;for(var $F,$i=1,$j=0,$t=$R.length,$p=NaN;$i<$t;){for($F=$R[$j=$i],$p=$R[$j]._zOrder;-1<--$j&&$R[$j]._zOrder>$p;)$R[$j+1]=$R[$j];$R[$j+1]=$F,$i++;}var $$=$F.parent.conchModel;if($$)if(null!=$$.updateZOrder)$$.updateZOrder();else{for($i=0;$i<$t;$i++)$$.removeChild($R[$i].conchModel);for($i=0;$i<$t;$i++)$$.addChildAt($R[$i].conchModel,$i);}return!0;},$V.transPointList=function($R,$F,$i){var $j=0,$t=$R.length;for($j=0;$j<$t;$j+=2)$R[$j]+=$F,$R[$j+1]+=$i;},$V.parseInt=function($R,$F){void 0===$F&&($F=0);var $i=$b.window.parseInt($R,$F);return isNaN($i)?0:$i;},$V.getFileExtension=function($R){$V._extReg.lastIndex=$R.lastIndexOf(".");var $F=$V._extReg.exec($R);return $F&&1<$F.length?$F[1].toLowerCase():null;},$V.getTransformRelativeToWindow=function($R,$F,$i){var $j=$H.stage,$t=laya.utils.Utils.getGlobalPosAndScale($R),$p=$j._canvasTransform.clone(),$$=$p.tx,$V=$p.ty;$p.rotate(-Math.PI/180*$H.stage.canvasDegree),$p.scale($H.stage.clientScaleX,$H.stage.clientScaleY);var $N=$H.stage.canvasDegree%180!=0,$c=NaN,$q=NaN;$N?($c=$i+$t.y,$q=$F+$t.x,$c*=$p.d,$q*=$p.a,90==$H.stage.canvasDegree?($c=$$-$c,$q+=$V):($c+=$$,$q=$V-$q)):($c=$F+$t.x,$q=$i+$t.y,$c*=$p.a,$q*=$p.d,$c+=$$,$q+=$V);var $s=NaN,$k=NaN;return $k=$N?($s=$p.d*$t.height,$p.a*$t.width):($s=$p.a*$t.width,$p.d*$t.height),{x:$c,y:$q,scaleX:$s,scaleY:$k};},$V.fitDOMElementInArea=function($R,$F,$i,$j,$t,$p){$R._fitLayaAirInitialized||($R._fitLayaAirInitialized=!0,$R.style.transformOrigin=$R.style.webKittransformOrigin="left top",$R.style.position="absolute");var $$=$V.getTransformRelativeToWindow($F,$i,$j);$R.style.transform=$R.style.webkitTransform="scale("+$$.scaleX+","+$$.scaleY+") rotate("+$H.stage.canvasDegree+"deg)",$R.style.width=$t+"px",$R.style.height=$p+"px",$R.style.left=$$.x+"px",$R.style.top=$$.y+"px";},$V.isOkTextureList=function($R){if(!$R)return!1;var $F,$i=0,$j=$R.length;for($i=0;$i<$j;$i++)if(!($F=$R[$i])||!$F.source)return!1;return!0;},$V.isOKCmdList=function($R){if(!$R)return!1;var $F,$i,$j=0,$t=$R.length,$p=$u._context;for($j=0;$j<$t;$j++)switch(($F=$R[$j]).callee){case $p._drawTexture:case $p._fillTexture:case $p._drawTextureWithTransform:if(!($i=$F[0])||!$i.source)return!1;}return!0;},$V._gid=1,$V._pi=180/Math.PI,$V._pi2=Math.PI/180,$V._extReg=/\.(\w+)\??/g,$V.parseXMLFromString=function($R){var $F;if($R=$R.replace(/>\s+</g,"><"),-1<($F=new DOMParser().parseFromString($R,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error($F.firstChild.firstChild.textContent);return $F;},$V;}(),$U=function(){function $R(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],$u.isWebGL&&$O.regCacheByFunction($P.bind(this.startDispose,this),$P.bind(this.getCacheList,this));}$x($R,"laya.utils.VectorGraphManager");var $F=$R.prototype;return $F.getId=function(){return this._id++;},$F.addShape=function($R,$F){this.shapeDic[$R]=$F,this.useDic[$R]||(this.useDic[$R]=!0);},$F.addLine=function($R,$F){this.shapeLineDic[$R]=$F,this.shapeLineDic[$R]||(this.shapeLineDic[$R]=!0);},$F.getShape=function($R){this._checkKey&&null!=this.useDic[$R]&&(this.useDic[$R]=!0);},$F.deleteShape=function($R){this.shapeDic[$R]&&(this.shapeDic[$R]=null,delete this.shapeDic[$R]),this.shapeLineDic[$R]&&(this.shapeLineDic[$R]=null,delete this.shapeLineDic[$R]),null!=this.useDic[$R]&&delete this.useDic[$R];},$F.getCacheList=function(){var $R,$F=[];for($R in this.shapeDic)$F.push(this.shapeDic[$R]);for($R in this.shapeLineDic)$F.push(this.shapeLineDic[$R]);return $F;},$F.startDispose=function($R){var $F;for($F in this.useDic)this.useDic[$F]=!1;this._checkKey=!0;},$F.endDispose=function(){if(this._checkKey){var $R;for($R in this.useDic)this.useDic[$R]||this.deleteShape($R);this._checkKey=!1;}},$R.getInstance=function(){return $R.instance=$R.instance||new $R();},$R.instance=null,$R;}(),$I=function(){function $j(){this._obj=null,this._obj=$j.supportWeakMap?new $b.window.WeakMap():{},$j.supportWeakMap||$j._maps.push(this);}$x($j,"laya.utils.WeakObject");var $R=$j.prototype;return $R.set=function($R,$F){if(null!=$R)if($j.supportWeakMap){var $i=$R;"string"!=typeof $R&&"number"!=typeof $R||($i=$j._keys[$R])||($i=$j._keys[$R]={k:$R}),this._obj.set($i,$F);}else"string"==typeof $R||"number"==typeof $R?this._obj[$R]=$F:($R.$_GID||($R.$_GID=$P.getGID()),this._obj[$R.$_GID]=$F);},$R.get=function($R){if(null==$R)return null;if($j.supportWeakMap){var $F="string"==typeof $R||"number"==typeof $R?$j._keys[$R]:$R;return $F?this._obj.get($F):null;}return"string"==typeof $R||"number"==typeof $R?this._obj[$R]:this._obj[$R.$_GID];},$R.del=function($R){if(null!=$R)if($j.supportWeakMap){var $F="string"==typeof $R||"number"==typeof $R?$j._keys[$R]:$R;if(!$F)return;this._obj.delete($F);}else"string"==typeof $R||"number"==typeof $R?delete this._obj[$R]:delete this._obj[this._obj.$_GID];},$R.has=function($R){if(null==$R)return!1;if($j.supportWeakMap){var $F="string"==typeof $R||"number"==typeof $R?$j._keys[$R]:$R;return this._obj.has($F);}return"string"==typeof $R||"number"==typeof $R?null!=this._obj[$R]:null!=this._obj[this._obj.$_GID];},$j.__init__=function(){($j.supportWeakMap=null!=$b.window.WeakMap)||$H.timer.loop($j.delInterval,null,$j.clearCache);},$j.clearCache=function(){for(var $R=0,$F=$j._maps.length;$R<$F;$R++){$j._maps[$R]._obj={};}},$j.supportWeakMap=!1,$j.delInterval=3e5,$j._keys={},$j._maps=[],$N($j,["I",function(){return this.I=new $j();}]),$j;}(),$D=function(){function $R(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null;}$x($R,"laya.utils.WordText");var $F=$R.prototype;return $F.setText=function($R){this.changed=!0,this._text=$R;},$F.toString=function(){return this._text;},$F.charCodeAt=function($R){return this._text?this._text.charCodeAt($R):NaN;},$F.charAt=function($R){return this._text?this._text.charAt($R):null;},$q(0,$F,"length",function(){return this._text?this._text.length:0;}),$R;}(),$RR=function($R){function $$(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,$$.__super.call(this),this._childs=$$.ARRAY_EMPTY,this._$P=$$.PROP_EMPTY,this.timer=$H.scaleTimer,this.conchModel=$u.isConchNode?this.createConchModel():null;}$x($$,"laya.display.Node",$c);var $F=$$.prototype;return $F._setBit=function($R,$F){1==$R&&this._getBit($R)!=$F&&this._updateDisplayedInstage();$F?this._bits|=$R:this._bits&=~$R;},$F._getBit=function($R){return 0!=(this._bits&$R);},$F._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1);},$F._setUpNoticeType=function($R){var $F=this;for($F._setBit($R,!0),$F=$F.parent;$F;){if($F._getBit($R))return;$F._setBit($R,!0),$F=$F.parent;}},$F.on=function($R,$F,$i,$j){return"display"!==$R&&"undisplay"!==$R||this._getBit(1)||this._setUpNoticeType(1),this._createListener($R,$F,$i,$j,!1);},$F.once=function($R,$F,$i,$j){return"display"!==$R&&"undisplay"!==$R||this._getBit(1)||this._setUpNoticeType(1),this._createListener($R,$F,$i,$j,!0);},$F.createConchModel=function(){return null;},$F.destroy=function($R){void 0===$R&&($R=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&($R?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this);},$F.destroyChildren=function(){if(this._childs)for(var $R=this._childs.length-1;-1<$R;$R--)this._childs[$R].destroy(!0);},$F.addChild=function($R){if(!$R||this.destroyed||$R===this)return $R;if($R.zOrder&&this._set$P("hasZorder",!0),$R._parent===this){var $F=this.getChildIndex($R);$F!==this._childs.length-1&&(this._childs.splice($F,1),this._childs.push($R),this.conchModel&&(this.conchModel.removeChild($R.conchModel),this.conchModel.addChildAt($R.conchModel,this._childs.length-1)),this._childChanged());}else $R.parent&&$R.parent.removeChild($R),this._childs===$$.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($R),this.conchModel&&this.conchModel.addChildAt($R.conchModel,this._childs.length-1),($R.parent=this)._childChanged();return $R;},$F.addChildren=function($R){for(var $F=arguments,$i=0,$j=$F.length;$i<$j;)this.addChild($F[$i++]);},$F.addChildAt=function($R,$F){if(!$R||this.destroyed||$R===this)return $R;if($R.zOrder&&this._set$P("hasZorder",!0),0<=$F&&$F<=this._childs.length){if($R._parent===this){var $i=this.getChildIndex($R);this._childs.splice($i,1),this._childs.splice($F,0,$R),this.conchModel&&(this.conchModel.removeChild($R.conchModel),this.conchModel.addChildAt($R.conchModel,$F)),this._childChanged();}else $R.parent&&$R.parent.removeChild($R),this._childs===$$.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($F,0,$R),this.conchModel&&this.conchModel.addChildAt($R.conchModel,$F),$R.parent=this;return $R;}throw new Error("appendChildAt:The index is out of bounds");},$F.getChildIndex=function($R){return this._childs.indexOf($R);},$F.getChildByName=function($R){var $F=this._childs;if($F)for(var $i=0,$j=$F.length;$i<$j;$i++){var $t=$F[$i];if($t.name===$R)return $t;}return null;},$F._get$P=function($R){return this._$P[$R];},$F._set$P=function($R,$F){return this.destroyed||(this._$P===$$.PROP_EMPTY&&(this._$P={}),this._$P[$R]=$F),$F;},$F.getChildAt=function($R){return this._childs[$R];},$F.setChildIndex=function($R,$F){var $i=this._childs;if($F<0||$F>=$i.length)throw new Error("setChildIndex:The index is out of bounds.");var $j=this.getChildIndex($R);if($j<0)throw new Error("setChildIndex:node is must child of this object.");return $i.splice($j,1),$i.splice($F,0,$R),this.conchModel&&(this.conchModel.removeChild($R.conchModel),this.conchModel.addChildAt($R.conchModel,$F)),this._childChanged(),$R;},$F._childChanged=function($R){},$F.removeChild=function($R){if(!this._childs)return $R;var $F=this._childs.indexOf($R);return this.removeChildAt($F);},$F.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this;},$F.removeChildByName=function($R){var $F=this.getChildByName($R);return $F&&this.removeChild($F),$F;},$F.removeChildAt=function($R){var $F=this.getChildAt($R);if($F){for(var $i=this._childs.length-1,$j=$R;$j<$i;++$j)this._childs[$j]=this._childs[$j+1];this._childs.length=$i,this.conchModel&&this.conchModel.removeChild($F.conchModel),$F.parent=null;}return $F;},$F.removeChildren=function($R,$F){if(void 0===$R&&($R=0),void 0===$F&&($F=2147483647),this._childs&&0<this._childs.length){var $i=this._childs;if(0===$R&&$p<=$F){var $j=$i;this._childs=$$.ARRAY_EMPTY;}else $j=$i.splice($R,$F-$R);for(var $t=0,$p=$j.length;$t<$p;$t++)$j[$t].parent=null,this.conchModel&&this.conchModel.removeChild($j[$t].conchModel);}return this;},$F.replaceChild=function($R,$F){var $i=this._childs.indexOf($F);return-1<$i?(this._childs.splice($i,1,$R),this.conchModel&&(this.conchModel.removeChild($F.conchModel),this.conchModel.addChildAt($R.conchModel,$i)),$F.parent=null,$R.parent=this,$R):null;},$F._updateDisplayedInstage=function(){var $R;$R=this;var $F=$H.stage;for(this._displayedInStage=!1;$R;){if($R._getBit(1)){this._displayedInStage=$R._displayedInStage;break;}if($R==$F||$R._displayedInStage){this._displayedInStage=!0;break;}$R=$R.parent;}},$F._setDisplay=function($R){this._displayedInStage!==$R&&((this._displayedInStage=$R)?this.event("display"):this.event("undisplay"));},$F._displayChild=function($R,$F){var $i=$R._childs;if($i)for(var $j=0;$j<$i.length;$j++){var $t=$i[$j];$t&&$t._getBit(1)&&(0<$t._childs.length?this._displayChild($t,$F):$t._setDisplay($F));}$R._setDisplay($F);},$F.contains=function($R){if($R===this)return!0;for(;$R;){if($R.parent===this)return!0;$R=$R.parent;}return!1;},$F.timerLoop=function($R,$F,$i,$j,$t,$p){void 0===$t&&($t=!0),void 0===$p&&($p=!1),this.timer.loop($R,$F,$i,$j,$t,$p);},$F.timerOnce=function($R,$F,$i,$j,$t){void 0===$t&&($t=!0),this.timer._create(!1,!1,$R,$F,$i,$j,$t);},$F.frameLoop=function($R,$F,$i,$j,$t){void 0===$t&&($t=!0),this.timer._create(!0,!0,$R,$F,$i,$j,$t);},$F.frameOnce=function($R,$F,$i,$j,$t){void 0===$t&&($t=!0),this.timer._create(!0,!1,$R,$F,$i,$j,$t);},$F.clearTimer=function($R,$F){this.timer.clear($R,$F);},$q(0,$F,"numChildren",function(){return this._childs.length;}),$q(0,$F,"destroyed",function(){return this._destroyed;}),$q(0,$F,"parent",function(){return this._parent;},function($R){this._parent!==$R&&($R?(this._parent=$R,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),$R.displayedInStage&&this._displayChild(this,!0)),$R._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=$R));}),$q(0,$F,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage;}),$$.ARRAY_EMPTY=[],$$.PROP_EMPTY={},$$.NOTICE_DISPLAY=1,$$.MOUSEENABLE=2,$$;}(),$FR=function($R){function $k($R){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,$k.__super.call(this),this._padding=$k._PADDING,this._spacing=$k._SPACING,this._aligns=$k._ALIGNS,this._font=$h.EMPTY,this._ower=$R;}$x($k,"laya.display.css.CSSStyle",$R);var $F=$k.prototype;return $F.destroy=function(){this._ower=null,this._font=null,this._rect=null;},$F.inherit=function($R){this._font=$R._font,this._spacing=$R._spacing===$k._SPACING?$k._SPACING:$R._spacing.slice(),this.lineHeight=$R.lineHeight;},$F._widthAuto=function(){return 0!=(262144&this._type);},$F.widthed=function($R){return 0!=(8&this._type);},$F._calculation=function($R,$F){if($F.indexOf("%")<0)return!1;var $j=this._ower,$t=$j.parent,$p=this._rect;function $$($R,$F,$i){return $R*$i[0]+$F*$i[1]+$i[2];}function $i($R){var $F=$t.width,$i=$j.width;$p.width&&($j.width=$$($F,$i,$p.width)),$p.height&&($j.height=$$($F,$i,$p.height)),$p.left&&($j.x=$$($F,$i,$p.left)),$p.top&&($j.y=$$($F,$i,$p.top));}null===$p&&($t._getCSSStyle()._type|=524288,$t.on("resize",this,$i),this._rect=$p={input:{}});var $V=$F.split(" ");return $V[0]=parseFloat($V[0])/100,1==$V.length?$V[1]=$V[2]=0:($V[1]=parseFloat($V[1])/100,$V[2]=parseFloat($V[2])),$p[$R]=$V,$p.input[$R]=$F,$i(),!0;},$F.heighted=function($R){return 0!=(8192&this._type);},$F.size=function($R,$F){var $i=this._ower,$j=!1;-1!==$R&&$R!=this._ower.width&&(this._type|=8,this._ower.width=$R,$j=!0),-1!==$F&&$F!=this._ower.height&&(this._type|=8192,this._ower.height=$F,$j=!0),$j&&($i._layoutLater(),524288&this._type&&$i.event("resize",this));},$F._getAlign=function(){return this._aligns[0];},$F._getValign=function(){return this._aligns[1];},$F._getCssFloat=function(){return 0!=(32768&this._type)?32768:0;},$F._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new $h(this._font));},$F.render=function($R,$F,$i,$j){var $t=$R.width,$p=$R.height;$i-=$R.pivotX,$j-=$R.pivotY,this._bgground&&null!=this._bgground.color&&$F.ctx.fillRect($i,$j,$t,$p,this._bgground.color),this._border&&this._border.color&&$F.drawRect($i,$j,$t,$p,this._border.color.strColor,this._border.size);},$F.getCSSStyle=function(){return this;},$F.cssText=function($R){this.attrs($k.parseOneCSS($R,";"));},$F.attrs=function($R){if($R)for(var $F=0,$i=$R.length;$F<$i;$F++){var $j=$R[$F];this[$j[0]]=$j[1];}},$F.setTransform=function($R){"none"===$R?this._tf=$V._TF_EMPTY:this.attrs($k.parseOneCSS($R,","));},$F.translate=function($R,$F){this._tf===$V._TF_EMPTY&&(this._tf=new $t()),this._tf.translateX=$R,this._tf.translateY=$F;},$F.scale=function($R,$F){this._tf===$V._TF_EMPTY&&(this._tf=new $t()),this._tf.scaleX=$R,this._tf.scaleY=$F;},$F._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type);},$q(0,$F,"block",$R.prototype._$get_block,function($R){$R?this._type|=1:this._type&=-2;}),$q(0,$F,"valign",function(){return $k._valigndef[this._aligns[1]];},function($R){this._aligns===$k._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=$k._valigndef[$R];}),$q(0,$F,"height",null,function($R){if(this._type|=8192,"string"==typeof $R){if(this._calculation("height",$R))return;$R=parseInt($R);}this.size(-1,$R);}),$q(0,$F,"width",null,function($R){if(this._type|=8,"string"==typeof $R){var $F=$R.indexOf("auto");if(0<=$F&&(this._type|=262144,$R=$R.substr(0,$F)),this._calculation("width",$R))return;$R=parseInt($R);}this.size($R,-1);}),$q(0,$F,"fontWeight",function(){return this._font.weight;},function($R){this._createFont().weight=$R;}),$q(0,$F,"left",null,function($R){var $F=this._ower;if("string"==typeof $R){if("center"===$R?$R="50% -50% 0":"right"===$R&&($R="100% -100% 0"),this._calculation("left",$R))return;$R=parseInt($R);}$F.x=$R;}),$q(0,$F,"_translate",null,function($R){this.translate($R[0],$R[1]);}),$q(0,$F,"absolute",function(){return 0!=(4&this._type);}),$q(0,$F,"top",null,function($R){var $F=this._ower;if("string"==typeof $R){if("middle"===$R?$R="50% -50% 0":"bottom"===$R&&($R="100% -100% 0"),this._calculation("top",$R))return;$R=parseInt($R);}$F.y=$R;}),$q(0,$F,"align",function(){return $k._aligndef[this._aligns[0]];},function($R){this._aligns===$k._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=$k._aligndef[$R];}),$q(0,$F,"bold",function(){return this._font.bold;},function($R){this._createFont().bold=$R;}),$q(0,$F,"padding",function(){return this._padding;},function($R){this._padding=$R;}),$q(0,$F,"leading",function(){return this._spacing[1];},function($R){"string"==typeof $R&&($R=parseInt($R+"")),this._spacing===$k._SPACING&&(this._spacing=[0,0]),this._spacing[1]=$R;}),$q(0,$F,"lineElement",function(){return 0!=(65536&this._type);},function($R){$R?this._type|=65536:this._type&=-65537;}),$q(0,$F,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left";},function($R){this.lineElement=!1,"right"===$R?this._type|=32768:this._type&=-32769;}),$q(0,$F,"textDecoration",function(){return this._font.decoration;},function($R){this._createFont().decoration=$R;}),$q(0,$F,"whiteSpace",function(){return 131072&this._type?"nowrap":"";},function($R){"nowrap"===$R&&(this._type|=131072),"none"===$R&&(this._type&=-131073);}),$q(0,$F,"background",null,function($R){$R?(this._bgground||(this._bgground={}),this._bgground.color=$R,this._ower.conchModel&&this._ower.conchModel.bgColor($R),this._type|=16384,this._ower._renderType|=256):this._bgground=null;}),$q(0,$F,"wordWrap",function(){return 0==(131072&this._type);},function($R){$R?this._type&=-131073:this._type|=131072;}),$q(0,$F,"color",function(){return this._font.color;},function($R){this._createFont().color=$R;}),$q(0,$F,"password",function(){return this._font.password;},function($R){this._createFont().password=$R;}),$q(0,$F,"backgroundColor",function(){return this._bgground?this._bgground.color:null;},function($R){"none"===$R?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=$R),this._ower.conchModel&&this._ower.conchModel.bgColor($R),this._ower._renderType|=256;}),$q(0,$F,"font",function(){return this._font.toString();},function($R){this._createFont().set($R);}),$q(0,$F,"weight",null,function($R){this._createFont().weight=$R;}),$q(0,$F,"letterSpacing",function(){return this._spacing[0];},function($R){"string"==typeof $R&&($R=parseInt($R+"")),this._spacing===$k._SPACING&&(this._spacing=[0,0]),this._spacing[0]=$R;}),$q(0,$F,"fontSize",function(){return this._font.size;},function($R){this._createFont().size=$R;}),$q(0,$F,"italic",function(){return this._font.italic;},function($R){this._createFont().italic=$R;}),$q(0,$F,"fontFamily",function(){return this._font.family;},function($R){this._createFont().family=$R;}),$q(0,$F,"stroke",function(){return this._font.stroke[0];},function($R){this._createFont().stroke===$h._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=$R;}),$q(0,$F,"strokeColor",function(){return this._font.stroke[1];},function($R){this._createFont().stroke===$h._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=$R;}),$q(0,$F,"border",function(){return this._border?this._border.value:"";},function($R){if("none"!=$R){this._border||(this._border={});var $F=(this._border.value=$R).split(" ");if(this._border.color=$E.create($F[$F.length-1]),1==$F.length)return this._border.size=1,void(this._border.type="solid");var $i=0;0<$F[0].indexOf("px")?(this._border.size=parseInt($F[0]),$i++):this._border.size=1,this._border.type=$F[$i],this._ower._renderType|=256;}else this._border=null;}),$q(0,$F,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null;},function($R){$R?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==$R?null:$E.create($R),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null;}),$q(0,$F,"position",function(){return 4&this._type?"absolute":"";},function($R){"absolute"==$R?this._type|=4:this._type&=-5;}),$q(0,$F,"display",null,function($R){switch($R){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater();}}),$q(0,$F,"paddingLeft",function(){return this.padding[3];}),$q(0,$F,"paddingTop",function(){return this.padding[0];}),$q(0,$F,"_scale",null,function($R){this._ower.scale($R[0],$R[1]);}),$q(0,$F,"_rotate",null,function($R){this._ower.rotation=$R;}),$k.parseOneCSS=function($R,$F){for(var $i,$j=[],$t=$R.split($F),$p=0,$$=$t.length;$p<$$;$p++){var $V=$t[$p],$N=$V.indexOf(":"),$c=$V.substr(0,$N).replace(/^\s+|\s+$/g,"");if(0!=$c.length){var $q=$V.substr($N+1).replace(/^\s+|\s+$/g,""),$s=[$c,$q];switch($c){case"italic":case"bold":$s[1]="true"==$q;break;case"line-height":$s[0]="lineHeight",$s[1]=parseInt($q);break;case"font-size":$s[0]="fontSize",$s[1]=parseInt($q);break;case"padding":1<($i=$q.split(" ")).length||($i[1]=$i[2]=$i[3]=$i[0]),$s[1]=[parseInt($i[0]),parseInt($i[1]),parseInt($i[2]),parseInt($i[3])];break;case"rotate":$s[0]="_rotate",$s[1]=parseFloat($q);break;case"scale":$i=$q.split(" "),$s[0]="_scale",$s[1]=[parseFloat($i[0]),parseFloat($i[1])];break;case"translate":$i=$q.split(" "),$s[0]="_translate",$s[1]=[parseInt($i[0]),parseInt($i[1])];break;default:($s[0]=$k._CSSTOVALUE[$c])||($s[0]=$c);}$j.push($s);}}return $j;},$k.parseCSS=function($R,$F){for(var $i;null!=($i=$k._parseCSSRegExp.exec($R));)$k.styleSheets[$i[1]]=$k.parseOneCSS($i[2],";");},$k.EMPTY=new $k(null),$k._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},$k._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),$k._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},$k._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},$k.styleSheets={},$k.ALIGN_CENTER=1,$k.ALIGN_RIGHT=2,$k.VALIGN_MIDDLE=1,$k.VALIGN_BOTTOM=2,$k._CSS_BLOCK=1,$k._DISPLAY_NONE=2,$k._ABSOLUTE=4,$k._WIDTH_SET=8,$k._PADDING=[0,0,0,0],$k._RECT=[-1,-1,-1,-1],$k._SPACING=[0,0],$k._ALIGNS=[0,0,0],$k.ADDLAYOUTED=512,$k._NEWFONT=4096,$k._HEIGHT_SET=8192,$k._BACKGROUND_SET=16384,$k._FLOAT_RIGHT=32768,$k._LINE_ELEMENT=65536,$k._NOWARP=131072,$k._WIDTHAUTO=262144,$k._LISTERRESZIE=524288,$k;}($V),$iR=function($R){function $$(){this.url=null,this.audio=null,this.loaded=!1,$$.__super.call(this);}$x($$,"laya.media.h5audio.AudioSound",$c);var $F=$$.prototype;return $F.dispose=function(){var $R=$$._audioCache[this.url];$R&&($R.src="",delete $$._audioCache[this.url]);},$F.load=function($R){var $F;if($R=$Z.formatURL($R),(this.url=$R)==$z._tMusic?($$._initMusicAudio(),($F=$$._musicAudio).src!=$R&&($$._audioCache[$F.src]=null,$F=null)):$F=$$._audioCache[$R],$F&&2<=$F.readyState)this.event("complete");else{$F||($F=$R==$z._tMusic?($$._initMusicAudio(),$$._musicAudio):$b.createElement("audio"),($$._audioCache[$R]=$F).src=$R),$F.addEventListener("canplaythrough",$j),$F.addEventListener("error",$t);var $i=this;(this.audio=$F).load?$F.load():$t();}function $j(){$p(),$i.loaded=!0,$i.event("complete");}function $t(){$F.load=null,$p(),$i.event("error");}function $p(){$F.removeEventListener("canplaythrough",$j),$F.removeEventListener("error",$t);}},$F.play=function($R,$F,$i){if(void 0===$R&&($R=0),void 0===$F&&($F=0),!this.url)return null;var $j,$t;if(!($j=this.url==$z._tMusic?$$._musicAudio:$$._audioCache[this.url]))return null;$t=$n.getItem("audio:"+this.url),$u.isConchApp?$t||(($t=$b.createElement("audio")).src=this.url):this.url==$z._tMusic?($$._initMusicAudio(),($t=$$._musicAudio).src=this.url):$t=$t||$j.cloneNode(!0);var $p=new $kR($t);return $p.url=this.url,$p.loops=$F,$p.startTime=$R,$p.startHandler=$i,$p.play(!1),$z.addChannel($p),$p;},$q(0,$F,"duration",function(){var $R;return($R=$$._audioCache[this.url])?$R.duration:0;}),$$._initMusicAudio=function(){$$._musicAudio||($$._musicAudio||($$._musicAudio=$b.createElement("audio")),$u.isConchApp||$b.document.addEventListener("mousedown",$$._makeMusicOK));},$$._makeMusicOK=function(){$b.document.removeEventListener("mousedown",$$._makeMusicOK),$$._musicAudio.src?$$._musicAudio.play():($$._musicAudio.src="",$$._musicAudio.load());},$$._audioCache={},$$._musicAudio=null,$$;}(),$jR=function($R){function $F(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,$F.__super.call(this);}$x($F,"laya.media.SoundChannel",$c);var $i=$F.prototype;return $i.play=function(){},$i.stop=function(){},$i.pause=function(){},$i.resume=function(){},$i.__runComplete=function($R){$R&&$R.run();},$q(0,$i,"volume",function(){return 1;},function($R){}),$q(0,$i,"position",function(){return 0;}),$q(0,$i,"duration",function(){return 0;}),$F;}(),$tR=function($R){function $F(){$F.__super.call(this);}$x($F,"laya.media.Sound",$c);var $i=$F.prototype;return $i.load=function($R){},$i.play=function($R,$F,$i){return void 0===$R&&($R=0),void 0===$F&&($F=0),null;},$i.dispose=function(){},$q(0,$i,"duration",function(){return 0;}),$F;}(),$pR=function($R){function $t(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,$t.__super.call(this);}$x($t,"laya.media.webaudio.WebAudioSound",$c);var $F=$t.prototype;return $F.load=function($R){this.url=$R,this.audioBuffer=$t._dataCache[$R],this.audioBuffer?this._loaded(this.audioBuffer):($t.e.on("loaded:"+$R,this,this._loaded),$t.e.on("err:"+$R,this,this._err),$t.__loadingSound[$R]||($t.__loadingSound[$R]=!0,$H.loader.load($R,$M.create(this,this.onloaded),null,$VR.BUFFER,4,!1,null,!0)));},$F.onloaded=function($R){$R||this._err(),this._disposed?this._removeLoadEvents():(this.data=$R,$t.buffs.push({buffer:this.data,url:this.url}),$t.decode());},$F._err=function(){if(this._removeLoadEvents(),$t.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var $R,$F,$i,$j=0;for($R=($F=this.__toPlays).length,$j=0;$j<$R;$j++)($i=$F[$j])[3]&&!$i[3].isStopped&&$i[3].event("error");this.__toPlays.length=0;}},$F._loaded=function($R){this._removeLoadEvents(),this._disposed||(this.audioBuffer=$R,this.loaded=!0,this.event("complete"));},$F._removeLoadEvents=function(){$t.e.off("loaded:"+this.url,this,this._loaded),$t.e.off("err:"+this.url,this,this._err);},$F.__playAfterLoaded=function(){if(this.__toPlays){var $R,$F,$i,$j=0;for($R=($F=this.__toPlays).length,$j=0;$j<$R;$j++)($i=$F[$j])[3]&&!$i[3].isStopped&&this.play($i[0],$i[1],$i[2],$i[3]);this.__toPlays.length=0;}},$F.play=function($R,$F,$i,$j){return void 0===$R&&($R=0),void 0===$F&&($F=0),$j=$j||new $hR(),this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([$R,$F,$i,$j]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),$j.url=this.url,$j.loops=$F,$j.audioBuffer=this.audioBuffer,$j.startTime=$R,$j.startHandler=$i,$j.play(!1),$z.addChannel($j),$j;},$F.dispose=function(){this._disposed=!0,delete $t._dataCache[this.url],delete $t.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[];},$q(0,$F,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0;}),$t.decode=function(){if(!($t.buffs.length<=0||$t.isDecoding))if($t.isDecoding=!0,($t.tInfo=$t.buffs.shift())&&$t.tInfo.buffer&&$t.tInfo.buffer.byteLength)try{$t.ctx.decodeAudioData($t.tInfo.buffer,$t._done,$t._fail);}catch($R){console.error("decodeAudioData error  byteLength:"+$t.tInfo.buffer.byteLength+"  url:"+$t.tInfo.url);}else $t._fail();},$t._done=function($R){$t.e.event("loaded:"+$t.tInfo.url,$R),$t._dataCache[$t.tInfo.url]=$R,$t.isDecoding=!1,$t.decode();},$t._fail=function(){$t.e.event("err:"+$t.tInfo.url,null),$t.isDecoding=!1,$t.decode();},$t._playEmptySound=function(){if(null!=$t.ctx){if($t._emptySource&&($t._emptySource.stop(),$t._emptySource.disconnect(0),!$hR._tryCleanFailed))try{$t._emptySource.buffer=null;}catch($R){$hR._tryCleanFailed=!0;}var $R=$t.ctx.createBufferSource();$R.buffer=$t._miniBuffer,$R.connect($t.ctx.destination),$R.start(0,0,0),$t._emptySource=$R;}},$t._unlock=function(){$t._unlocked||($t._playEmptySound(),"running"==$t.ctx.state?($b.document.removeEventListener("mousedown",$t._unlock,!0),$b.document.removeEventListener("touchend",$t._unlock,!0),$b.document.removeEventListener("touchstart",$t._unlock,!0),$t._unlocked=!0):"suspended"==$t.ctx.state&&$z._recoverWebAudio());},$t.initWebAudio=function(){"running"!=$t.ctx.state&&($t._unlock(),$b.document.addEventListener("mousedown",$t._unlock,!0),$b.document.addEventListener("touchend",$t._unlock,!0),$b.document.addEventListener("touchstart",$t._unlock,!0));},$t._emptySource=null,$t._dataCache={},$t.buffs=[],$t.isDecoding=!1,$t._unlocked=!1,$t.tInfo=null,$t.__loadingSound={},$N($t,["window",function(){return this.window=$b.window;},"webAudioEnabled",function(){return this.webAudioEnabled=$t.window.AudioContext||$t.window.webkitAudioContext||$t.window.mozAudioContext;},"ctx",function(){return this.ctx=$t.webAudioEnabled?new($t.window.AudioContext||$t.window.webkitAudioContext||$t.window.mozAudioContext)():void 0;},"_miniBuffer",function(){return this._miniBuffer=$t.ctx.createBuffer(1,1,22050);},"e",function(){return this.e=new $c();}]),$t;}(),$$R=function($R){function $F(){this._responseType=null,this._data=null,$F.__super.call(this),this._http=new $b.window.XMLHttpRequest();}$x($F,"laya.net.HttpRequest",$c);var $i=$F.prototype;return $i.send=function($R,$F,$i,$j,$t){void 0===$i&&($i="get"),void 0===$j&&($j="text"),this._responseType=$j,this._data=null;var $p=this,$$=this._http;if($$.open($i,$R,!0),$t)for(var $V=0;$V<$t.length;$V++)$$.setRequestHeader($t[$V++],$t[$V]);else $u.isConchApp||($F&&"string"!=typeof $F?$$.setRequestHeader("Content-Type","application/json"):$$.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));$$.responseType="arraybuffer"!==$j?"text":"arraybuffer",$$.onerror=function($R){$p._onError($R);},$$.onabort=function($R){$p._onAbort($R);},$$.onprogress=function($R){$p._onProgress($R);},$$.onload=function($R){$p._onLoad($R);},$$.send($F);},$i._onProgress=function($R){$R&&$R.lengthComputable&&this.event("progress",$R.loaded/$R.total);},$i._onAbort=function($R){this.error("Request was aborted by user");},$i._onError=function($R){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText);},$i._onLoad=function($R){var $F=this._http,$i=void 0!==$F.status?$F.status:200;200===$i||204===$i||0===$i?this.complete():this.error("["+$F.status+"]"+$F.statusText+":"+$F.responseURL);},$i.error=function($R){this.clear(),this.event("error",$R);},$i.complete=function(){this.clear();var $F=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=$P.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText;}catch($R){$F=!1,this.error($R.message);}$F&&this.event("complete",this._data instanceof Array?[this._data]:this._data);},$i.clear=function(){var $R=this._http;$R.onerror=$R.onabort=$R.onprogress=$R.onload=null;},$q(0,$i,"url",function(){return this._http.responseURL;}),$q(0,$i,"http",function(){return this._http;}),$q(0,$i,"data",function(){return this._data;}),$F;}(),$VR=function($R){function $g(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,$g.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1;}$x($g,"laya.net.Loader",$c);var $F=$g.prototype;return $F.load=function($R,$F,$i,$j,$t){if($R&&""!=$R||console.error("Loader 加载的url不合法 "+$R),void 0===$i&&($i=!0),void 0===$t&&($t=!1),0===(this._url=$R).indexOf("data:image")?this._type=$F="image":this._type=$F||($F=this.getTypeFromUrl($R)),this._cache=$i,this._data=null,!$t&&$g.loadedMap[$R])return this._data=$g.loadedMap[$R],this.event("progress",1),void this.event("complete",this._data);if($j&&$g.setGroup($R,$j),null!=$g.parserMap[$F])return this._customParse=!0,void($g.parserMap[$F]instanceof laya.utils.Handler?$g.parserMap[$F].runWith(this):$g.parserMap[$F].call(null,this));if("image"===$F||"htmlimage"===$F||"nativeimage"===$F)return this._loadImage($R);if("ttf"===$F)return this._loadTTF($R);switch($F){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:$F;}$g.preLoadedMap[$R]?this.onLoaded($g.preLoadedMap[$R]):$$.resMgrLoad($R,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime);},$F.getTypeFromUrl=function($R){var $F=$P.getFileExtension($R);return $F?$g.typeMap[$F]:(console.warn("Not recognize the resources suffix",$R),"text");},$F._loadTTF=function($R){$R=$Z.formatURL($R);var $F=new $f();$F.complete=$M.create(this,this.onLoaded),$F.load($R);},$F._loadImage=function($R){$$.imgMgrLoad($R,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime);},$F._loadImageComplete=function($R,$F,$i){if(null!=$i){if($i instanceof ArrayBuffer){var $j=new DataView($i),$t=new laya.webgl.resource.WebGLImage(new Uint8Array($i,8),$R,0,!1,$j.getUint32(0),$j.getUint32(4));this.onLoaded($t);}else if($i instanceof $qR)$g.imgMgrSet[$R]=$F,$$.imgMgrLock($R,$g.imgMgrSet[$R]),this._url=$R,this.complete($i);else{var $p=-1!=$R.indexOf(".png",$R.length-4)?6408:6407;$t=new laya.webgl.resource.WebGLImage($i,$R,$p,!1,$i.width,$i.height);this.onLoaded($t);}}else this.event("error","Load image failed");},$F.imageCancel=function($R,$F,$i){$$.imgMgrCancel&&$$.imgMgrCancel($R,this._onImageCallback);},$F._loadSound=function($R){var $F=new $z._soundClass(),$i=this;function $j(){$F.offAll();}$F.on("complete",this,function(){$j(),$i.onLoaded($F);}),$F.on("error",this,function(){$j(),$F.dispose(),$i.event("error","Load sound failed");}),$F.load($R);},$F.onProgress=function($R){"atlas"===this._type?this.event("progress",.3*$R):this.event("progress",$R);},$F.onError=function($R){this.event("error",$R);},$F._loadedComplete=function($R,$F,$i){if(null!=$i)switch(this._type){case"atlas":case"plf":case"json":var $j=new $G($i);this.onLoaded(JSON.parse($j.readUTFBytes()));break;case"font":$j=new $G($i);this.onLoaded($P.parseXMLFromString($j.readUTFBytes()));break;default:this.onLoaded($i);}else this.event("error",$R);},$F.onLoaded=function($R){var $F=this._type;if("plf"==$F)this.parsePLFData($R),this.complete($R);else if("image"===$F){var $i=new $qR($R);$i.url=this._url,this.complete($i);}else if("sound"===$F||"htmlimage"===$F||"nativeimage"===$F)this.complete($R);else if("atlas"===$F){if(!$R.src&&!$R._setContext){if(!this._data){if((this._data=$R).meta&&$R.meta.image)for(var $j=$R.meta.image.split(","),$t=0<=this._url.indexOf("/")?"/":"\\",$p=this._url.lastIndexOf($t),$$=0<=$p?this._url.substr(0,$p+1):"",$V=0,$N=$j.length;$V<$N;$V++)$j[$V]=$$+$j[$V];else $j=[this._url.replace(".json",".png")];$j.reverse(),$R.toLoads=$j,$R.pics=[];}return this.event("progress",.3+1/$j.length*.6),this._loadImage($j.pop());}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push($R),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var $c=this._data.frames,$q=this._url.split("?")[0],$s=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:$q.substring(0,$q.lastIndexOf("."))+"/",$k=this._data.pics,$h=$Z.formatURL(this._url),$S=$g.atlasMap[$h]||($g.atlasMap[$h]=[]);$S.dir=$s;var $x=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var $a in $x=parseFloat(this._data.meta.scale),$c){var $m,$M=$c[$a],$J=$k[$M.frame.idx?$M.frame.idx:0],$d=$Z.formatURL($s+$a);$J.scaleRate=$x,$m=$qR.create($J,$M.frame.x,$M.frame.y,$M.frame.w,$M.frame.h,$M.spriteSourceSize.x,$M.spriteSourceSize.y,$M.sourceSize.w,$M.sourceSize.h),$g.cacheRes($d,$m),$g.keepCache(this._url,$s+$a),$m.url=$d,$S.push($d);}else for($a in $c)$J=$k[($M=$c[$a]).frame.idx?$M.frame.idx:0],$d=$Z.formatURL($s+$a),$g.cacheRes($d,$qR.create($J,$M.frame.x,$M.frame.y,$M.frame.w,$M.frame.h,$M.spriteSourceSize.x,$M.spriteSourceSize.y,$M.sourceSize.w,$M.sourceSize.h)),$g.loadedMap[$d].url=$d,$g.keepCache(this._url,$s+$a),$S.push($d);delete this._data.pics,this.complete(this._data);}else if("font"==$F){if(!$R.src)return this._data=$R,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var $w=new $B();$w.parseFont(this._data,$R);var $X=this._url.split(".fnt")[0].split("/"),$H=$X[$X.length-1];$aR.registerBitmapFont($H,$w),this._data=$w,this.complete(this._data);}else if("pkm"==$F){var $_=$XR.create($R,this._url),$T=new $qR($_);$T.url=this._url,this.complete($T);}else this.complete($R);},$F.parsePLFData=function($R){var $F,$i,$j;for($F in $R)switch($j=$R[$F],$F){case"json":case"text":for($i in $j)$g.preLoadedMap[$Z.formatURL($i)]=$j[$i];break;default:for($i in $j)$g.preLoadedMap[$Z.formatURL($i)]=$j[$i];}},$F.complete=function($R){this._data=$R,this._customParse?this.event("loaded",$R instanceof Array?[$R]:$R):($g._loaders.push(this),$g._isWorking||$g.checkNext());},$F.endLoad=function($R){$R&&(this._data=$R),this._cache&&$g.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data);},$q(0,$F,"url",function(){return this._url;}),$q(0,$F,"data",function(){return this._data;}),$q(0,$F,"cache",function(){return this._cache;}),$q(0,$F,"type",function(){return this._type;}),$g.checkNext=function(){$g._isWorking=!0;for(var $R=$b.now();$g._startIndex<$g._loaders.length;)if($b.now(),$g._loaders[$g._startIndex].endLoad(),$g._startIndex++,$b.now()-$R>$g.maxTimeOut)return console.warn("loader callback cost a long time:"+($b.now()-$R)+" url="+$g._loaders[$g._startIndex-1].url),void $H.timer.frameOnce(1,null,$g.checkNext);$g._loaders.length=0,$g._startIndex=0,$g._isWorking=!1;},$g.clearRes=function($R,$F){if(null!=$R){void 0===$F&&($F=!1),$R=$Z.formatURL($R);var $i=$g.getAtlas($R);if($i){for(var $j=0,$t=$i.length;$j<$t;$j++){var $p=$i[$j],$$=$g.getRes($p);delete $g.loadedMap[$p],$g.clearCache($R.substring($Z.basePath.length),$p.substring($Z.basePath.length)),$$&&$$.destroy($F);}$i.length=0,delete $g.atlasMap[$R],delete $g.loadedMap[$R];}else{var $V=$g.loadedMap[$R];$V&&(delete $g.loadedMap[$R],$V instanceof laya.resource.Texture&&$V.bitmap&&$V.destroy($F));}}},$g.clearTextureRes=function($R){$R=$Z.formatURL($R);var $F=laya.net.Loader.getAtlas($R),$i=$F&&0<$F.length?laya.net.Loader.getRes($F[0]):laya.net.Loader.getRes($R);$i&&$i.bitmap&&($u.isConchApp&&!$u.isConchWebGL?$i.bitmap.source.releaseTexture&&$i.bitmap.source.releaseTexture():null==$i.bitmap._atlaser&&$i.bitmap.releaseResource(!0));},$g.getRes=function($R){return $g.loadedMap[$Z.formatURL($R)];},$g.getAtlas=function($R){return $g.atlasMap[$Z.formatURL($R)];},$g.cacheRes=function($R,$F){$R=$Z.formatURL($R),null!=$g.loadedMap[$R]?console.warn("Resources already exist,is repeated loading:",$R):$g.loadedMap[$R]=$F;},$g.setGroup=function($R,$F){$g.groupMap[$F]||($g.groupMap[$F]=[]),$g.groupMap[$F].push($R);},$g.clearResByGroup=function($R){if($g.groupMap[$R]){var $F=$g.groupMap[$R],$i=0,$j=$F.length;for($i=0;$i<$j;$i++)$g.clearRes($F[$i]);$F.length=0;}},$g.keepCache=function($R,$F){if($R&&$F){var $i=$g.cacheSet[$F];$i?-1==$i.indexOf($R)&&$i.push($R):$g.cacheSet[$F]=[$R];}},$g.clearCache=function($R,$F){if($R&&$F){var $i=$g.cacheSet[$F];if($i){var $j=$i.indexOf($R);if(-1!==$j){var $t=$i.length-1;0==$t?(delete $g.cacheSet[$F],0<$g.imgMgrSet[$F]?$$.imgMgrFree($F,$g.imgMgrSet[$F]):$g.clearRes($F,!0)):($i[$j]=$i[$t],$i.length=$t);}}}},$g.saveObject=function($R,$F,$i){if($F&&$R){var $j=$g.objectSet[$R];$j?(console.warn("Loader.saveObject: "+$R),$j[0]=$F,$j[1]=$i):$g.objectSet[$R]=[$F,$i,[]];}},$g.findObject=function($R){if($R){var $F=$g.objectSet[$R];if($F)return $F[0];}return null;},$g.keepObject=function($R,$F){if($R&&$F){var $i=$g.objectSet[$F];$i&&-1===$i[2].indexOf($R)&&$i[2].push($R);}},$g.clearObject=function($R,$F){if($R&&$F){var $i=$g.objectSet[$F];if($i){var $j=$i[2],$t=$j.indexOf($R);if(-1!==$t){var $p=$j.length-1;0==$p?(delete $g.objectSet[$F],$i[1]&&$i[1].call(null,$i[0])):($j[$t]=$j[$p],$j.length=$p);}}}},$g.TEXT="text",$g.JSON="json",$g.XML="xml",$g.BUFFER="arraybuffer",$g.IMAGE="image",$g.SOUND="sound",$g.ATLAS="atlas",$g.FONT="font",$g.TTF="ttf",$g.PLF="plf",$g.PKM="pkm",$g.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},$g.parserMap={},$g.groupMap={},$g.maxTimeOut=100,$g.loadedMap={},$g.preLoadedMap={},$g.atlasMap={},$g._loaders=[],$g._isWorking=!1,$g._startIndex=0,$g.imgCache={},$g.cacheSet={},$g.objectSet={},$g.imgMgrSet={},$g;}(),$NR=function($R){var $k;function $h(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},$h.__super.call(this);for(var $R=0;$R<this._maxPriority;$R++)this._resInfos[$R]=[];}$x($h,"laya.net.LoaderManager",$c);var $F=$h.prototype;return $F.create=function($R,$i,$F,$j,$t,$p,$$,$V){if(null==$p&&($p=2),null==$$&&($$=!0),$R instanceof Array){var $N=$R,$c=$N.length,$q=0;if($F)var $s=$M.create($F.caller,$F.method,$F.args,!1);for(var $k=0;$k<$c;$k++){var $h=$N[$k];"string"==typeof $h&&($h=$N[$k]={url:$h}),$h.progress=0;}for($k=0;$k<$c;$k++){$h=$N[$k];var $S=$F?$M.create(null,$m,[$h],!1):null,$x=$F||$i?$M.create(null,$a,[$h]):null;this._create($h.url,$x,$S,$h.clas||$j,$h.params||$t,null!=$h.priority&&0<=$h.priority?$h.priority:$p,$$,$h.group||$V);}function $a($R,$F){$q++,$R.progress=1,$q===$c&&$i&&$i.run();}function $m($R,$F){$R.progress=$F;for(var $i=0,$j=0;$j<$c;$j++){$i+=$N[$j].progress;}var $t=$i/$c;$s.runWith($t);}return!0;}return this._create($R,$i,$F,$j,$t,$p,$$,$V);},$F._create=function($F,$i,$R,$j,$t,$p,$$,$V){$F&&""!=$F||console.error("加载的url不合法 "+$F),null==$p&&($p=2),null==$$&&($$=!0);var $N=$Z.formatURL($F),$c=this.getRes($N);if($c)!$c.hasOwnProperty("loaded")||$c.loaded?($R&&$R.runWith(1),$i&&$i.run()):$i&&$H.loader._createListener($F,$i.caller,$i.method,$i.args,!0,!1);else{var $q=$P.getFileExtension($F),$s=$h.createMap[$q];if(!$s)throw new Error("LoaderManager:unknown file("+$F+") extension with: "+$q+".");$j||($j=$s[0]);var $k=$s[1];if("atlas"==$q)this.load($F,$i,$R,$k,$p,$$);else{$j===$qR&&($k="htmlimage"),($c=$j?new $j():null).hasOwnProperty("_loaded")&&($c._loaded=!1),$c._setUrl($F),$V&&$c._setGroup($V),this._createLoad($c,$F,$M.create(null,function($R){$c&&!$c.destroyed&&$R&&$c.onAsynLoaded.call($c,$F,$R,$t),$i&&$i.run();$H.loader.event($F);}),$R,$k,$p,!1,$V,!0),$$&&this.cacheRes($N,$c);}}return $c;},$F.load=function($R,$F,$i,$j,$t,$p,$$,$V){$R&&""!=$R||console.error("加载的url不合法 "+$R);var $N=this;if(null==$t&&($t=2),null==$p&&($p=!0),void 0===$V&&($V=!1),$R instanceof Array)return this._loadAssets($R,$F,$i,$j,$t,$p,$$);var $c=$VR.getRes($R);if(null!=$c)$H.timer.frameOnce(1,null,function(){$i&&$i.runWith(1),$F&&$F.runWith($c),$N._loaderCount||$N.event("complete");});else{var $q=$h._resMap[$R];$q?($F&&$q._createListener("complete",$F.caller,$F.method,$F.args,!1,!1),$i&&$q._createListener("progress",$i.caller,$i.method,$i.args,!1,!1)):(($q=this._infoPool.length?this._infoPool.pop():new $k()).url=$R,$q.clas=null,$q.type=$j,$q.cache=$p,$q.group=$$,$q.ignoreCache=$V,$q.priority=$t,$F&&$q.on("complete",$F.caller,$F.method,$F.args),$i&&$q.on("progress",$i.caller,$i.method,$i.args),$h._resMap[$R]=$q,$t=$t<this._maxPriority?0<=$t?$t:0:this._maxPriority-1,this._resInfos[$t].push($q),this._next());}return this;},$F.cancel=function($R,$F,$i){if($c=$h._resMap[$R]){$F&&$c.off("complete",$F.caller,$F.method,!1),$i&&$c.off("progress",$i.caller,$i.method,!1);var $j=$c.getListener("complete"),$t=$c.getListener("progress");if(!($j&&$j.head||$t&&$t.head)){if($c.loader){var $p=$c.loader;$p.imageCancel($R),$p.offAll(),$p._data=null,$p._customParse=!1,$p._url=null,$p._class=null,$p._type=null,this._loaders.push($p),this._loaderCount--,delete this._loaderMap[$c.url];}for(var $$=0;$$<this._maxPriority;$$++)for(var $V=this._resInfos[$$],$N=$V.length-1;-1<$N;$N--){var $c;($c=$V[$N])&&$c.url===$R&&($V[$N]=null,$c.destroy(),$c.offAll(),this._infoPool.push($c));}delete $h._resMap[$R],this._next();}}},$F._createLoad=function($R,$F,$i,$j,$t,$p,$$,$V,$N){var $c=this;if(null==$p&&($p=2),null==$$&&($$=!0),void 0===$N&&($N=!1),$F instanceof Array)return this._loadAssets($F,$i,$j,$t,$p,$$,$V);var $q=$VR.getRes($F);if(null!=$q)$H.timer.frameOnce(1,null,function(){$j&&$j.runWith(1),$i&&$i.runWith($q),$c._loaderCount||$c.event("complete");});else{var $s=$h._resMap[$F];$s?($i&&$s._createListener("complete",$i.caller,$i.method,$i.args,!1,!1),$j&&$s._createListener("progress",$j.caller,$j.method,$j.args,!1,!1)):(($s=this._infoPool.length?this._infoPool.pop():new $k()).url=$F,$s.clas=$R,$s.type=$t,$s.cache=$$,$s.group=$V,$s.ignoreCache=$N,$s.priority=$p,$i&&$s.on("complete",$i.caller,$i.method,$i.args),$j&&$s.on("progress",$j.caller,$j.method,$j.args),$h._resMap[$F]=$s,$p=$p<this._maxPriority?0<=$p?$p:0:this._maxPriority-1,this._resInfos[$p].push($s),this._next());}return this;},$F._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var $R=0;$R<this._maxPriority;$R++)for(var $F=this._resInfos[$R];0<$F.length;){var $i=$F.shift();if($i)return this._doLoad($i);}this._loaderCount||this.event("complete");}},$F._doLoad=function($F){var $i=this._loaders.length?this._loaders.pop():new $VR();this._loaderCount++,(this._loaderMap[$F.url]=$i).on("complete",null,$t),$i.on("progress",null,function($R){$F.event("progress",$R);}),$i.on("error",null,function($R){$t(null);}),$F.loader=$i;var $j=this;function $t($R){$i.offAll(),$i._data=null,$i._customParse=!1,$i._url=null,$i._class=null,$i._type=null,$j._loaders.push($i),$j._loaderCount--,delete $j._loaderMap[$F.url],$j._endLoad($F,$R instanceof Array?[$R]:$R),$j._next();}$i._class=$F.clas,1<=$F.priority?($i.priority=$F.priority,$i.realTime=!1):($i.priority=0,$i.realTime=!0),$i.load($F.url,$F.type,$F.cache,$F.group,$F.ignoreCache);},$F._endLoad=function($R,$F){var $i=$R.url;if(null==$F){var $j=this._failRes[$i]||0;if($j<this.retryNum)return console.warn("[warn]Retry to load:",$i),this._failRes[$i]=$j+1,void $H.timer.once(this.retryDelay,this,this._addReTry,[$R],!1);console.warn("[error]Failed to load:",$i),this.event("error",$i);}this._failRes[$i]&&(this._failRes[$i]=0),delete $h._resMap[$i],$R.event("complete",$F),$R.destroy(),$R.offAll(),this._infoPool.push($R);},$F._addReTry=function($R){this._resInfos[this._maxPriority-1].push($R),this._next();},$F.clearRes=function($R,$F){void 0===$F&&($F=!1),$VR.clearRes($R,$F);},$F.getRes=function($R){return $VR.getRes($R);},$F.cacheRes=function($R,$F){$VR.cacheRes($R,$F);},$F.clearTextureRes=function($R){$VR.clearTextureRes($R);},$F.setGroup=function($R,$F){$VR.setGroup($R,$F);},$F.clearResByGroup=function($R){$VR.clearResByGroup($R);},$F.clearUnLoaded=function(){for(var $R=0;$R<this._maxPriority;$R++){for(var $F=this._resInfos[$R],$i=$F.length-1;-1<$i;$i--){var $j=$F[$i];$j&&($j.destroy(),$j.offAll(),this._infoPool.push($j));}$F.length=0;}this._loaderCount=0,$h._resMap={};},$F.cancelLoadByUrls=function($R){if($R)for(var $F=0,$i=$R.length;$F<$i;$F++)this.cancelLoadByUrl($R[$F]);},$F.cancelLoadByUrl=function($R){for(var $F=0;$F<this._maxPriority;$F++)for(var $i=this._resInfos[$F],$j=$i.length-1;-1<$j;$j--){var $t=$i[$j];$t&&$t.url===$R&&($i[$j]=null,$t.destroy(),$t.offAll(),this._infoPool.push($t));}$h._resMap[$R]&&delete $h._resMap[$R];},$F._loadAssets=function($R,$i,$$,$F,$j,$t,$p){null==$j&&($j=2),null==$t&&($t=!0);for(var $V=$R.length,$N=0,$c=0,$q=[],$s=!0,$k=0;$k<$V;$k++){var $h=$R[$k];if(!$h)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+$R);"string"==typeof $h&&($h={url:$h,type:$F,size:1,priority:$j}),$h.size||($h.size=1),$h.progress=0,$c+=$h.size,$q.push($h);var $S=$$?$M.create(null,$m,[$h],!1):null,$x=$i||$$?$M.create(null,$a,[$h]):null;this.load($h.url,$x,$S,$h.type,null!=$h.priority&&0<=$h.priority?$h.priority:2,$t,$h.group||$p);}function $a($R,$F){$N++,$R.progress=1,$F||($s=!1),$N===$V&&$i&&$i.runWith($s);}function $m($R,$F){if(null!=$$){$R.progress=$F;for(var $i=0,$j=0;$j<$q.length;$j++){var $t=$q[$j];$i+=$t.size*$t.progress;}var $p=$i/$c;$$.runWith($p);}}return this;},$h.cacheRes=function($R,$F){$VR.cacheRes($R,$F);},$h._resMap={},$N($h,["createMap",function(){return this.createMap={atlas:[null,"atlas"]};}]),$h.__init$=function(){$k=function($R){function $F(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,$F.__super.call(this);}return $x($F,"",$c),$F.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1;},$F;}();},$h;}(),$cR=(function($R){function $t($R){$t.__super.call(this),$R||($R=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var $F=0,$i=0,$j=0;$j<20;$j++)$j%5!=4?this._mat[$F++]=$R[$j]:this._alpha[$i++]=$R[$j];this._action=$L.createFilterAction(32),this._action.data=this;}$x($t,"laya.filters.ColorFilter",$m);var $F=$t.prototype;$H.imps($F,{"laya.filters.IFilter":!0}),$F.callNative=function($R){$R._$P.cf=this;$R.conchModel&&$R.conchModel.setFilterMatrix&&$R.conchModel.setFilterMatrix(this._mat,this._alpha);},$q(0,$F,"type",function(){return 32;}),$q(0,$F,"action",function(){return this._action;});}(),function($R){function $j($R,$F,$i){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===$F&&($F=0),$j.__super.call(this),this._byteClass=$i||$G,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,$R&&0<$F&&$F<65535&&this.connect($R,$F);}$x($j,"laya.net.Socket",$c);var $F=$j.prototype;$F.connect=function($R,$F){var $i="ws://"+$R+":"+$F;$i="https:"==$b.window.location.protocol?"wss://"+$R+":"+$F:"ws://"+$R+":"+$F,this.connectByUrl($i);},$F.connectByUrl=function($R){var $F=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new $b.window.WebSocket($R,this.protocols):this._socket=new $b.window.WebSocket($R),this._socket.binaryType="arraybuffer",this._output=new this._byteClass(),this._output.endian=this.endian,this._input=new this._byteClass(),this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function($R){$F._onOpen($R);},this._socket.onmessage=function($R){$F._onMessage($R);},this._socket.onclose=function($R){$F._onClose($R);},this._socket.onerror=function($R){$F._onError($R);};},$F.cleanSocket=function(){try{this._socket.close();}catch($R){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null;},$F.close=function(){if(null!=this._socket)try{this._socket.close();}catch($R){}},$F._onOpen=function($R){this._connected=!0,this.event("open",$R);},$F._onMessage=function($R){if($R&&$R.data){var $F=$R.data;if(this.disableInput&&$F)this.event("message",$F);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var $i=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,$F&&("string"==typeof $F?this._input.writeUTFBytes($F):this._input.writeArrayBuffer($F),this._addInputPosition=this._input.pos,this._input.pos=$i),this.event("message",$F);}}},$F._onClose=function($R){this._connected=!1,this.event("close",$R);},$F._onError=function($R){this.event("error",$R);},$F.send=function($R){this._socket.send($R);},$F.flush=function(){if(this._output&&0<this._output.length){var $F;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length));}catch($R){$F=$R;}this._output.endian=this.endian,this._output.clear(),$F&&this.event("error",$F);}},$q(0,$F,"input",function(){return this._input;}),$q(0,$F,"output",function(){return this._output;}),$q(0,$F,"connected",function(){return this._connected;}),$q(0,$F,"endian",function(){return this._endian;},function($R){this._endian=$R,null!=this._input&&(this._input.endian=$R),null!=this._output&&(this._output.endian=$R);}),$j.LITTLE_ENDIAN="littleEndian",$j.BIG_ENDIAN="bigEndian";}(),function($R){function $V(){$V.__super.call(this),this._$1__id=++$V._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,($V._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,$Q.currentResourceManager&&$Q.currentResourceManager.addResource(this);}$x($V,"laya.resource.Resource",$c);var $F=$V.prototype;return $H.imps($F,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),$F._setUrl=function($R){var $F;this._url!==$R&&(this._url&&(($F=$V._urlResourcesMap[this._url]).splice($F.indexOf(this),1),0===$F.length&&delete $V._urlResourcesMap[this._url]),$R&&(($F=$V._urlResourcesMap[$R])||($V._urlResourcesMap[$R]=$F=[]),$F.push(this)),this._url=$R);},$F._getGroup=function(){return this._group;},$F._setGroup=function($R){var $F;this._group!==$R&&(this._group&&(($F=$V._groupResourcesMap[this._group]).splice($F.indexOf(this),1),0===$F.length&&delete $V._groupResourcesMap[this._group]),$R&&(($F=$V._groupResourcesMap[$R])||($V._groupResourcesMap[$R]=$F=[]),$F.push(this)),this._group=$R);},$F._addReference=function(){this._referenceCount++;},$F._removeReference=function(){this._referenceCount--;},$F._clearReference=function(){this._referenceCount=0;},$F._endLoaded=function(){this.__loaded=!0,this.event("loaded",this);},$F.recreateResource=function(){this.completeCreate();},$F.disposeResource=function(){},$F.activeResource=function($R){void 0===$R&&($R=!1),this._lastUseFrameCount=$C.loopCount,!this._destroyed&&this.__loaded&&(this._released||$R)&&this.recreateResource();},$F.releaseResource=function($R){return void 0===$R&&($R=!0),!(!$R&&this.lock)&&!(this._released&&!$R)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0);},$F.onAsynLoaded=function($R,$F,$i){throw new Error("Resource: must override this function!");},$F.destroy=function(){var $R;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete $V._idResourcesMap[this.id],this._url&&(($R=$V._urlResourcesMap[this._url])&&($R.splice($R.indexOf(this),1),0===$R.length&&delete $V._urlResourcesMap[this.url]),$VR.clearRes(this._url),this.__loaded||$L.cancelLoadByUrl(this._url)),this._group&&(($R=$V._groupResourcesMap[this._group]).splice($R.indexOf(this),1),0===$R.length&&delete $V._groupResourcesMap[this.url]));},$F.completeCreate=function(){this._released=!1,this.event("recovered",this);},$F.dispose=function(){this.destroy();},$q(0,$F,"memorySize",function(){return this._memorySize;},function($R){var $F=$R-this._memorySize;this._memorySize=$R,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,$F),this.resourceManager&&this.resourceManager.addSize($F);}),$q(0,$F,"_loaded",null,function($R){this.__loaded=$R;}),$q(0,$F,"loaded",function(){return this.__loaded;}),$q(0,$F,"id",function(){return this._$1__id;}),$q(0,$F,"destroyed",function(){return this._destroyed;}),$q(0,$F,"group",function(){return this._getGroup();},function($R){this._setGroup($R);}),$q(0,$F,"resourceManager",function(){return this._resourceManager;}),$q(0,$F,"url",function(){return this._url;}),$q(0,$F,"released",function(){return this._released;}),$q(0,$F,"referenceCount",function(){return this._referenceCount;}),$V.getResourceByID=function($R){return $V._idResourcesMap[$R];},$V.getResourceByURL=function($R,$F){return void 0===$F&&($F=0),null==$V._urlResourcesMap[$R]?null:$V._urlResourcesMap[$R][$F];},$V.getResourceCountByURL=function($R){return $V._urlResourcesMap[$R].length;},$V.destroyUnusedResources=function($R){var $F;if($R){var $i=$V._groupResourcesMap[$R];if($i)for(var $j=$i.slice(),$t=0,$p=$j.length;$t<$p;$t++)($F=$j[$t]).lock||0!==$F._referenceCount||$F.destroy();}else for(var $$ in $V._idResourcesMap)($F=$V._idResourcesMap[$$]).lock||0!==$F._referenceCount||$F.destroy();},$V._uniqueIDCounter=0,$V._idResourcesMap={},$V._urlResourcesMap={},$V._groupResourcesMap={},$V;}()),$qR=function($R){function $g($R,$F){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,$g.__super.call(this),$R&&null!=$R._addReference&&$R._addReference(),this.setTo($R,$F);}$x($g,"laya.resource.Texture",$c);var $F=$g.prototype;return $F._setUrl=function($R){this.url=$R;},$F.setTo=function($R,$F){if($R instanceof $$.HTMLElement){var $i=$JR.create("2D",$R);this.bitmap=$i;}else this.bitmap=$R;if(this.uv=$F||$g.DEF_UV,$R){this._w=$R.width,this._h=$R.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var $j=this;if(this._loaded)$L.addToAtlas&&$L.addToAtlas($j);else{var $t=$R;$t instanceof laya.resource.HTMLImage&&$t.image&&$t.image.addEventListener("load",function($R){$L.addToAtlas&&$L.addToAtlas($j);},!1);}}},$F.active=function(){this.bitmap&&this.bitmap.activeResource();},$F.destroy=function($R){if(void 0===$R&&($R=!1),this.alphaTexture&&(this.alphaTexture.destroy($R),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var $F=this.bitmap;$R?($u.isConchApp&&$F.source&&$F.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$F.dispose(),$F._clearReference()):($F._removeReference(),0==$F.referenceCount&&($u.isConchApp&&$F.source&&$F.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$F.dispose())),this.url&&this===$H.loader.getRes(this.url)&&$H.loader.clearRes(this.url,$R),this._loaded=!1;}},$F.load=function($R){var $F=this;this._loaded=!1,$R=$Z.customFormat($R);var $i=this.bitmap||(this.bitmap=$XR.create($R));$i.uri=$R,$i&&$i._addReference();var $j=this;$i.onload=function(){$i.onload=null,$j._loaded=!0,$F.sourceWidth=$F._w=$i.width,$F.sourceHeight=$F._h=$i.height,$j.event("loaded",this),$L.addToAtlas&&$L.addToAtlas($j);};},$F.addTextureToAtlas=function($R){$L.addTextureToAtlas(this);},$F.getPixels=function($R,$F,$i,$j){if($u.isConchApp){var $t=this.bitmap;if($t.source&&$t.source.getImageData){var $p=$t.source.getImageData($R,$F,$i,$j),$$=new Uint8Array($p);return Array.from($$);}return null;}return $u.isWebGL?$L.getTexturePixels(this,$R,$F,$i,$j):($b.canvas.size($i,$j),$b.canvas.clear(),$b.context.drawTexture(this,-$R,-$F,this.width,this.height,0,0),$b.context.getImageData(0,0,$i,$j).data);},$F.onAsynLoaded=function($R,$F){if($F){if("function"!=typeof $F._addReference)throw new Error("bitmap._addReference is not a function. "+$F.className+" "+typeof $F._addReference+" "+$F.constructor);$F._addReference();}this.setTo($F,this.uv),this._loaded&&this.event("loaded",this);},$q(0,$F,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null;}),$q(0,$F,"loaded",function(){return this._loaded;}),$q(0,$F,"released",function(){return!this.bitmap||this.bitmap.released;}),$q(0,$F,"width",function(){return this._w?this._w:this.uv&&this.uv!==$g.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width;},function($R){this._w=$R,this.sourceWidth||(this.sourceWidth=$R);}),$q(0,$F,"repeat",function(){return!$u.isWebGL||!this.bitmap||this.bitmap.repeat;},function($R){$R&&$u.isWebGL&&this.bitmap&&(this.bitmap.repeat=$R)&&(this.bitmap.enableMerageInAtlas=!1);}),$q(0,$F,"height",function(){return this._h?this._h:this.uv&&this.uv!==$g.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height;},function($R){this._h=$R,this.sourceHeight||(this.sourceHeight=$R);}),$q(0,$F,"isLinearSampling",function(){return!$u.isWebGL||9728!=this.bitmap.minFifter;},function($R){!$R&&$u.isWebGL&&($R||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1));}),$g.moveUV=function($R,$F,$i){for(var $j=0;$j<8;$j+=2)$i[$j]+=$R,$i[$j+1]+=$F;return $i;},$g.create=function($R,$F,$i,$j,$t,$p,$$,$V,$N){void 0===$p&&($p=0),void 0===$$&&($$=0),void 0===$V&&($V=0),void 0===$N&&($N=0);var $c=$R instanceof laya.resource.Texture,$q=$c?$R.uv:$g.DEF_UV,$s=$c?$R.bitmap:$R,$k=$L.isAtlas($s);if($k){var $h=$s._atlaser,$S=$R._atlasID;if(-1==$S)throw new Error("create texture error");$s=$h._inAtlasTextureBitmapValue[$S],$q=$h._inAtlasTextureOriUVValue[$S];}var $x=new $g($s,null);$s.width&&$F+$j>$s.width&&($j=$s.width-$F),$s.height&&$i+$t>$s.height&&($t=$s.height-$i),$x.width=$j,$x.height=$t,$x.offsetX=$p,$x.offsetY=$$,$x.sourceWidth=$V||$j,$x.sourceHeight=$N||$t;var $a=1/$s.width,$m=1/$s.height;$F*=$a,$i*=$m,$j*=$a,$t*=$m;var $M=$x.uv[0],$J=$x.uv[1],$d=$x.uv[4],$w=$x.uv[5],$X=$d-$M,$H=$w-$J,$_=$g.moveUV($q[0],$q[1],[$F,$i,$F+$j,$i,$F+$j,$i+$t,$F,$i+$t]);$x.uv=[$M+$_[0]*$X,$J+$_[1]*$H,$d-(1-$_[2])*$X,$J+$_[3]*$H,$d-(1-$_[4])*$X,$w-(1-$_[5])*$H,$M+$_[6]*$X,$w-(1-$_[7])*$H],$k&&$x.addTextureToAtlas();var $T=$s.scaleRate;return $T&&1!=$T?($x.sourceWidth/=$T,$x.sourceHeight/=$T,$x.width/=$T,$x.height/=$T,$x.scaleRate=$T,$x.offsetX/=$T,$x.offsetY/=$T):$x.scaleRate=1,$x;},$g.createFromTexture=function($R,$F,$i,$j,$t){var $p=$R.scaleRate;1!=$p&&($F*=$p,$i*=$p,$j*=$p,$t*=$p);var $$=$T.TEMP.setTo($F-$R.offsetX,$i-$R.offsetY,$j,$t),$V=$$.intersection($g._rect1.setTo(0,0,$R.width,$R.height),$g._rect2);if(!$V)return null;var $N=$g.create($R,$V.x,$V.y,$V.width,$V.height,$V.x-$$.x,$V.y-$$.y,$j,$t);if($N.bitmap&&$N.bitmap._removeReference)return $N.bitmap._removeReference(),$N;var $c="bitmap:"+($N.bitmap?$N.bitmap.constructor?$N.bitmap.constructor.name:$N.bitmap.__className:"")+", url:"+($R.url+" | "+($N.bitmap?$N.bitmap.url:$R.url))+", x="+$F+",y="+$i+",width="+$j+",height="+$t+", result="+($V?$V.x+","+$V.y+","+$V.width+","+$V.height:"null")+", rect="+$$.x+","+$$.y+","+$$.width+","+$$.height;throw new Error("报错：bitmap._removeReference is not a function  "+$c);},$g.DEF_UV=[0,0,1,0,1,1,0,1],$g.INV_UV=[0,1,1,1,1,0,0,0],$g._rect1=new $T(),$g._rect2=new $T(),$g;}(),$R=function($R){var $V;function $p(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,$p.__super.call(this);}$x($p,"laya.utils.TimeLine",$c);var $F=$p.prototype;return $F.to=function($R,$F,$i,$j,$t){return void 0===$t&&($t=0),this._create($R,$F,$i,$j,$t,!0);},$F.from=function($R,$F,$i,$j,$t){return void 0===$t&&($t=0),this._create($R,$F,$i,$j,$t,!1);},$F._create=function($R,$F,$i,$j,$t,$p){var $$=$n.getItemByClass("tweenData",$V);return $$.isTo=$p,$$.type=0,$$.target=$R,$$.duration=$i,$$.data=$F,$$.startTime=this._startTime+$t,$$.endTime=$$.startTime+$$.duration,$$.ease=$j,this._startTime=Math.max($$.endTime,this._startTime),this._tweenDataList.push($$),this._startTimeSort=!0,this._endTimeSort=!0,this;},$F.addLabel=function($R,$F){var $i=$n.getItemByClass("tweenData",$V);return $i.type=1,$i.data=$R,$i.endTime=$i.startTime=this._startTime+$F,this._labelDic||(this._labelDic={}),this._labelDic[$R]=$i,this._tweenDataList.push($i),this;},$F.removeLabel=function($R){if(this._labelDic&&this._labelDic[$R]){var $F=this._labelDic[$R];if($F){var $i=this._tweenDataList.indexOf($F);-1<$i&&this._tweenDataList.splice($i,1);}delete this._labelDic[$R];}},$F.gotoTime=function($R){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var $F,$i,$j,$t;for(var $p in this._firstTweenDic)if($i=this._firstTweenDic[$p])for(var $$ in $i)$i.diyTarget.hasOwnProperty($$)&&($i.diyTarget[$$]=$i[$$]);for($p in this._tweenDic)($F=this._tweenDic[$p]).clear(),delete this._tweenDic[$p];if(this._index=0,this._gidIndex=0,this._currTime=$R,this._lastTime=$b.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=$j=this._tweenDataList.concat(),$j.sort(function($R,$F){return $R.endTime>$F.endTime?1:$R.endTime<$F.endTime?-1:0;});}else $j=this._endTweenDataList;for(var $V=0,$N=$j.length;$V<$N;$V++)if(0==($t=$j[$V]).type){if(!($R>=$t.endTime))break;this._index=Math.max(this._index,$V+1);var $c=$t.data;if($t.isTo)for(var $q in $c)$t.target[$q]=$c[$q];}for($V=0,$N=this._tweenDataList.length;$V<$N;$V++)0==($t=this._tweenDataList[$V]).type&&$R>=$t.startTime&&$R<$t.endTime&&(this._index=Math.max(this._index,$V+1),this._gidIndex++,($F=$n.getItemByClass("tween",$A))._create($t.target,$t.data,$t.duration,$t.ease,$M.create(this,this._animComplete,[this._gidIndex]),0,!1,$t.isTo,!0,!1),$F.setStartTime(this._currTime-($R-$t.startTime)),$F._updateEase(this._currTime),$F.gid=this._gidIndex,this._tweenDic[this._gidIndex]=$F);}},$F.gotoLabel=function($R){if(null!=this._labelDic){var $F=this._labelDic[$R];$F&&this.gotoTime($F.startTime);}},$F.pause=function(){$H.timer.clear(this,this._update);},$F.resume=function(){this.play(this._currTime,this._loopKey);},$F.play=function($R,$F){if(void 0===$R&&($R=0),void 0===$F&&($F=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function($R,$F){return $R.startTime>$F.startTime?1:$R.startTime<$F.startTime?-1:0;});for(var $i=0,$j=this._tweenDataList.length;$i<$j;$i++){var $t=this._tweenDataList[$i];if(null!=$t&&0==$t.type){var $p=$t.target,$$=$p.$_GID||($p.$_GID=$P.getGID()),$V=null;for(var $N in null==this._firstTweenDic[$$]?(($V={}).diyTarget=$p,this._firstTweenDic[$$]=$V):$V=this._firstTweenDic[$$],$t.data)null==$V[$N]&&($V[$N]=$p[$N]);}}}"string"==typeof $R?this.gotoLabel($R):this.gotoTime($R),this._loopKey=$F,this._lastTime=$b.now(),$H.timer.frameLoop(1,this,this._update);}},$F._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var $R in this._tweenDic)($F=this._tweenDic[$R]).complete();return this._complete(),void this.pause();}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0);}var $F,$i=$b.now(),$j=$i-this._lastTime,$t=this._currTime+=$j*this.scale;for($R in this._lastTime=$i,this._tweenDic)($F=this._tweenDic[$R])._updateEase($t);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var $p=this._tweenDataList[this._index];$t>=$p.startTime&&(this._index++,0==$p.type?(this._gidIndex++,($F=$n.getItemByClass("tween",$A))._create($p.target,$p.data,$p.duration,$p.ease,$M.create(this,this._animComplete,[this._gidIndex]),0,!1,$p.isTo,!0,!1),$F.setStartTime($t),$F.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=$F)._updateEase($t)):this.event("label",$p.data));}},$F._animComplete=function($R){this._tweenDic[$R]&&delete this._tweenDic[$R];},$F._complete=function(){this.event("complete");},$F.reset=function(){var $R;if(this._labelDic)for($R in this._labelDic)delete this._labelDic[$R];for($R in this._tweenDic)this._tweenDic[$R].clear(),delete this._tweenDic[$R];for($R in this._firstTweenDic)delete this._firstTweenDic[$R];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var $F,$i=0;for($F=this._tweenDataList.length,$i=0;$i<$F;$i++)this._tweenDataList[$i]&&this._tweenDataList[$i].destroy();}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,$H.timer.clear(this,this._update);},$F.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null;},$q(0,$F,"index",function(){return this._frameIndex;},function($R){this._frameIndex=$R,this.gotoTime(this._frameIndex/this._frameRate*1e3);}),$q(0,$F,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total;}),$p.to=function($R,$F,$i,$j,$t){return void 0===$t&&($t=0),new $p().to($R,$F,$i,$j,$t);},$p.from=function($R,$F,$i,$j,$t){return void 0===$t&&($t=0),new $p().from($R,$F,$i,$j,$t);},$p.__init$=function(){$V=function(){function $R(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null;}return $x($R,""),$R.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,$n.recover("tweenData",this);},$R;}();},$p;}(),$sR=function($t){function $i(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,$i.__super.call(this),this._style=$V.EMPTY;}$x($i,"laya.display.Sprite",$t);var $R=$i.prototype;return $H.imps($R,{"laya.display.ILayout":!0}),$R.createConchModel=function(){return new ConchNode();},$R.destroy=function($R){if(void 0===$R&&($R=!0),this._releaseMem(),!this._destroyed){this.filters=null;var $F=this.mask;$F&&(this.mask=null,$F.destroy($R));}$t.prototype.destroy.call(this,$R),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null;},$R.updateZOrder=function(){$P.updateOrder(this._childs)&&this.repaint();},$R.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1;},$R.setBounds=function($R){this._set$P("uBounds",$R);},$R.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new $T()),$T._getWrapRec(this._boundPointsToParent(),this._$P.mBounds);},$R.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new $T()),$T._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds));},$R._boundPointsToParent=function($R){void 0===$R&&($R=!1);var $F=0,$i=0;this._style&&($F=this._style._tf.translateX,$i=this._style._tf.translateY,$R=$R||0!==this._style._tf.rotate,this._style.scrollRect&&($F+=this._style.scrollRect.x,$i+=this._style.scrollRect.y));var $j=this._getBoundPointsM($R);if(!$j||$j.length<1)return $j;if(8!=$j.length&&($j=$R?$w.scanPList($j):$T._getWrapRec($j,$T.TEMP)._getBoundPoints()),!this.transform)return $P.transPointList($j,this._x-$F,this._y-$i),$j;var $t=$_.TEMP,$p=0,$$=$j.length;for($p=0;$p<$$;$p+=2)$t.x=$j[$p],$t.y=$j[$p+1],this.toParentPoint($t),$j[$p]=$t.x,$j[$p+1]=$t.y;return $j;},$R.getGraphicBounds=function($R){return void 0===$R&&($R=!1),this._graphics?this._graphics.getBounds($R):$T.TEMP.setTo(0,0,0,0);},$R._getBoundPointsM=function($R){if(void 0===$R&&($R=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var $F=$P.clearArray(this._$P.temBM),$i=$T.TEMP;return $i.copyFrom(this.scrollRect),$P.concatArray($F,$i._getBoundPoints()),$F;}for(var $j,$t,$p,$$=this._graphics?this._graphics.getBoundPoints():$P.clearArray(this._$P.temBM),$V=0,$N=($p=this._childs).length;$V<$N;$V++)($j=$p[$V])instanceof laya.display.Sprite&&1==$j.visible&&($t=$j._boundPointsToParent($R))&&($$=$$?$P.concatArray($$,$t):$t);return $$;},$R.getStyle=function(){return this._style===$V.EMPTY&&(this._style=new $V()),this._style;},$R.setStyle=function($R){this._style=$R;},$R._adjustTransform=function(){this._tfChanged=!1;var $R,$F=this._style._tf,$i=$F.scaleX,$j=$F.scaleY;if($F.rotate||1!==$i||1!==$j||$F.skewX||$F.skewY){($R=this._transform||(this._transform=$Y.create())).bTransform=!0;var $t=.0174532922222222*($F.rotate-$F.skewX),$p=.0174532922222222*($F.rotate+$F.skewY),$$=Math.cos($p),$V=Math.sin($p),$N=Math.sin($t),$c=Math.cos($t);return $R.a=$i*$$,$R.b=$i*$V,$R.c=-$j*$N,$R.d=$j*$c,$R.tx=$R.ty=0,$R;}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,$R;},$R.pos=function($R,$F,$i){if(void 0===$i&&($i=!1),this._x!==$R||this._y!==$F){if(this.destroyed)return this;if($i){this._x=$R,this._y=$F,this.conchModel&&this.conchModel.pos(this._x,this._y);var $j=this._parent;$j&&0===$j._repaint&&($j._repaint=1,$j.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint());}else this.x=$R,this.y=$F;}return this;},$R.pivot=function($R,$F){return this.pivotX=$R,this.pivotY=$F,this;},$R.size=function($R,$F){return this.width=$R,this.height=$F,this;},$R.scale=function($R,$F,$i){void 0===$i&&($i=!1);var $j=this.getStyle(),$t=$j._tf;if($t.scaleX!=$R||$t.scaleY!=$F){if(this.destroyed)return this;if($i){$j.setScale($R,$F),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($R,$F),this._renderType|=4;var $p=this._parent;$p&&0===$p._repaint&&($p._repaint=1,$p.parentRepaint());}else this.scaleX=$R,this.scaleY=$F;}return this;},$R.skew=function($R,$F){return this.skewX=$R,this.skewY=$F,this;},$R.render=function($R,$F,$i){$C.spriteCount++,$K.renders[this._renderType]._fun(this,$R,$F+this._x,$i+this._y),this._repaint=0;},$R.drawToCanvas=function($R,$F,$i,$j){if($u.isConchNode){var $t=$JR.create("2D");return new $v($R,$F,$t).ctx.setCanvasType(1),this.conchModel.drawToCanvas($t.source,$i,$j),$t;}return $L.drawToCanvas(this,this._renderType,$R,$F,$i,$j);},$R.customRender=function($R,$F,$i){this._renderType|=1024;},$R._applyFilters=function(){var $R;if(!$u.isWebGL&&($R=this._$P.filters)&&!($R.length<1))for(var $F=0,$i=$R.length;$F<$i;$F++)$R[$F].action.apply(this._$P.cacheCanvas);},$R._isHaveGlowFilter=function(){var $R,$F=0;if(this.filters)for($F=0;$F<this.filters.length;$F++)if(8==this.filters[$F].type)return!0;for($F=0,$R=this._childs.length;$F<$R;$F++)if(this._childs[$F]._isHaveGlowFilter())return!0;return!1;},$R.localToGlobal=function($R,$F){void 0===$F&&($F=!1),!0===$F&&($R=new $_($R.x,$R.y));for(var $i=this;$i&&$i!=$H.stage;)$R=$i.toParentPoint($R),$i=$i.parent;return $R;},$R.globalToLocal=function($R,$F){void 0===$F&&($F=!1),$F&&($R=new $_($R.x,$R.y));for(var $i=this,$j=[];$i&&$i!=$H.stage;)$j.push($i),$i=$i.parent;for(var $t=$j.length-1;0<=$t;)$R=($i=$j[$t]).fromParentPoint($R),$t--;return $R;},$R.toParentPoint=function($R){if(!$R)return $R;$R.x-=this.pivotX,$R.y-=this.pivotY,this.transform&&this._transform.transformPoint($R),$R.x+=this._x,$R.y+=this._y;var $F=this._style.scrollRect;return $F&&($R.x-=$F.x,$R.y-=$F.y),$R;},$R.fromParentPoint=function($R){if(!$R)return $R;$R.x-=this._x,$R.y-=this._y;var $F=this._style.scrollRect;return $F&&($R.x+=$F.x,$R.y+=$F.y),this.transform&&this._transform.invertTransformPoint($R),$R.x+=this.pivotX,$R.y+=this.pivotY,$R;},$R.on=function($R,$F,$i,$j){return 1!==this._mouseEnableState&&this.isMouseEvent($R)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($R,$F,$i,$j,!1)):$t.prototype.on.call(this,$R,$F,$i,$j);},$R.once=function($R,$F,$i,$j){return 1!==this._mouseEnableState&&this.isMouseEvent($R)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($R,$F,$i,$j,!0)):$t.prototype.once.call(this,$R,$F,$i,$j);},$R._$2__onDisplay=function(){if(1!==this._mouseEnableState){var $R=this;for($R=$R.parent;$R&&1!==$R._mouseEnableState&&!$R._getBit(2);)$R.mouseEnabled=!0,$R._setBit(2,!0),$R=$R.parent;}},$R.loadImage=function($R,$F,$i,$j,$t,$p){var $$=this;return void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=0),void 0===$t&&($t=0),this.graphics.loadImage($R,$F,$i,$j,$t,function($R){$$.destroyed||($$.size($F+($j||$R.width),$i+($t||$R.height)),$$.repaint(),$p&&$p.runWith($R));}),this;},$R.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint();},$R._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache;},$R._childChanged=function($R){this._childs.length?this._renderType|=2048:this._renderType&=-2049,$R&&this._get$P("hasZorder")&&$H.timer.callLater(this,this.updateZOrder),this.repaint();},$R.parentRepaint=function(){var $R=this._parent;$R&&0===$R._repaint&&($R._repaint=1,$R.parentRepaint());},$R.startDrag=function($R,$F,$i,$j,$t,$p,$$){void 0===$F&&($F=!1),void 0===$i&&($i=0),void 0===$j&&($j=300),void 0===$p&&($p=!1),void 0===$$&&($$=.92),this._$P.dragging||this._set$P("dragging",new $l()),this._$P.dragging.start(this,$R,$F,$i,$j,$t,$p,$$);},$R.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop();},$R._releaseMem=function(){if(this._$P){var $R=this._$P.cacheCanvas;$R&&$R.ctx&&($n.recover("RenderContext",$R.ctx),$R.ctx.canvas.size(0,0),$R.ctx=null);var $F=this._$P._filterCache;$F&&($F.destroy(),$F.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null;}},$R._setDisplay=function($R){$R||this._releaseMem(),$t.prototype._setDisplay.call(this,$R);},$R.hitTestPoint=function($R,$F){var $i=this.globalToLocal($_.TEMP.setTo($R,$F));return $R=$i.x,$F=$i.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?$T.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains($R,$F);},$R.getMousePoint=function(){return this.globalToLocal($_.TEMP.setTo($H.stage.mouseX,$H.stage.mouseY));},$R._getWords=function(){return null;},$R._addChildsToLayout=function($R){var $F=this._getWords();if(null==$F&&0==this._childs.length)return!1;if($F)for(var $i=0,$j=$F.length;$i<$j;$i++)$R.push($F[$i]);$i=0;for(var $t=this._childs.length;$i<$t;++$i){var $p=this._childs[$i];$p._style._enableLayout()&&$p._addToLayout($R);}return!0;},$R._addToLayout=function($R){this._style.absolute||(this._style.block?$R.push(this):this._addChildsToLayout($R)&&(this.x=this.y=0));},$R._isChar=function(){return!1;},$R._getCSSStyle=function(){return this._style.getCSSStyle();},$R._setAttributes=function($R,$F){switch($R){case"x":this.x=parseFloat($F);break;case"y":this.y=parseFloat($F);break;case"width":this.width=parseFloat($F);break;case"height":this.height=parseFloat($F);break;default:this[$R]=$F;}},$R._layoutLater=function(){this.parent&&this.parent._layoutLater();},$q(0,$R,"optimizeScrollRect",function(){return this._optimizeScrollRect;},function($R){this._optimizeScrollRect!=$R&&(this._optimizeScrollRect=$R,this.conchModel&&this.conchModel.optimizeScrollRect($R));}),$q(0,$R,"customRenderEnable",null,function($R){if($R&&(this._renderType|=1024,$u.isConchNode)){$i.CustomList.push(this);var $F=new $JR("2d");$F._setContext(new CanvasRenderingContext2D()),this.customContext=new $v(0,0,$F),$F.context.setCanvasType&&$F.context.setCanvasType(2),this.conchModel.custom($F.context);}}),$q(0,$R,"cacheAsBitmap",function(){return"none"!==this.cacheAs;},function($R){this.cacheAs=$R?this._$P.hasFilter?"none":"normal":"none";}),$q(0,$R,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type;},function($R){var $F=this._$P.cacheCanvas;if($R!==($F?$F.type:"none")){if("none"!==$R)this._getBit(1)||this._setUpNoticeType(1),$F||($F=this._set$P("cacheCanvas",$n.getItemByClass("cacheCanvas",Object))),$F.type=$R,$F.reCache=!0,this._renderType|=16,"bitmap"==$R&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if($F){var $i=$F;$i&&$i.ctx&&($n.recover("RenderContext",$i.ctx),$i.ctx.canvas.size(0,0),$i.ctx=null),$n.recover("cacheCanvas",$F);}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0);}this.repaint();}}),$q(0,$R,"zOrder",function(){return this._zOrder;},function($R){this._zOrder!=$R&&(this._zOrder=$R,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder($R),this._parent&&($R&&this._parent._set$P("hasZorder",!0),$H.timer.callLater(this._parent,this.updateZOrder)));}),$q(0,$R,"rotation",function(){return this._style._tf.rotate;},function($R){var $F=this.getStyle();if($F._tf.rotate!==$R){$F.setRotate($R),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate($R),this._renderType|=4;var $i=this._parent;$i&&0===$i._repaint&&($i._repaint=1,$i.parentRepaint());}}),$q(0,$R,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width;},function($R){this._width!==$R&&(this._width=$R,this.conchModel&&this.conchModel.size($R,this._height),this.repaint());}),$q(0,$R,"x",function(){return this._x;},function($R){if(this._x!==$R){if(this.destroyed)return;this._x=$R,this.conchModel&&this.conchModel.pos($R,this._y);var $F=this._parent;$F&&0===$F._repaint&&($F._repaint=1,$F.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint());}}),$q(0,$R,"globalScaleY",function(){for(var $R=1,$F=this;$F&&$F!==$H.stage;)$R*=$F.scaleY,$F=$F.parent;return $R;}),$q(0,$R,"hitArea",function(){return this._$P.hitArea;},function($R){this._set$P("hitArea",$R);}),$q(0,$R,"staticCache",function(){return this._$P.staticCache;},function($R){this._set$P("staticCache",$R),$R||this.reCache();}),$q(0,$R,"texture",function(){return this._texture;},function($R){this._texture!=$R&&(this._texture=$R,this.graphics.cleanByTexture($R,0,0));}),$q(0,$R,"y",function(){return this._y;},function($R){if(this._y!==$R){if(this.destroyed)return;this._y=$R,this.conchModel&&this.conchModel.pos(this._x,$R);var $F=this._parent;$F&&0===$F._repaint&&($F._repaint=1,$F.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint());}}),$q(0,$R,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height;},function($R){this._height!==$R&&(this._height=$R,this.conchModel&&this.conchModel.size(this._width,$R),this.repaint());}),$q(0,$R,"blendMode",function(){return this._style.blendMode;},function($R){this.getStyle().blendMode=$R,this.conchModel&&this.conchModel.blendMode($R),$R&&"source-over"!=$R?this._renderType|=8:this._renderType&=-9,this.parentRepaint();}),$q(0,$R,"scaleX",function(){return this._style._tf.scaleX;},function($R){var $F=this.getStyle();if($F._tf.scaleX!==$R){$F.setScaleX($R),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($R,$F._tf.scaleY),this._renderType|=4;var $i=this._parent;$i&&0===$i._repaint&&($i._repaint=1,$i.parentRepaint());}}),$q(0,$R,"scaleY",function(){return this._style._tf.scaleY;},function($R){var $F=this.getStyle();if($F._tf.scaleY!==$R){$F.setScaleY($R),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($F._tf.scaleX,$R),this._renderType|=4;var $i=this._parent;$i&&0===$i._repaint&&($i._repaint=1,$i.parentRepaint());}}),$q(0,$R,"stage",function(){return $H.stage;}),$q(0,$R,"skewX",function(){return this._style._tf.skewX;},function($R){var $F=this.getStyle();if($F._tf.skewX!==$R){$F.setSkewX($R),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($R,$F._tf.skewY),this._renderType|=4;var $i=this._parent;$i&&0===$i._repaint&&($i._repaint=1,$i.parentRepaint());}}),$q(0,$R,"scrollRect",function(){return this._style.scrollRect;},function($R){this.getStyle().scrollRect=$R,this.repaint(),$R?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect($R.x,$R.y,$R.width,$R.height)):(this._renderType&=-129,this.conchModel&&($i.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)));}),$q(0,$R,"skewY",function(){return this._style._tf.skewY;},function($R){var $F=this.getStyle();if($F._tf.skewY!==$R){$F.setSkewY($R),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($F._tf.skewX,$R),this._renderType|=4;var $i=this._parent;$i&&0===$i._repaint&&($i._repaint=1,$i.parentRepaint());}}),$q(0,$R,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform;},function($R){this._tfChanged=!1,(this._transform=$R)&&(this._x=$R.tx,this._y=$R.ty,$R.tx=$R.ty=0,this.conchModel&&this.conchModel.transform($R.a,$R.b,$R.c,$R.d,this._x,this._y)),$R?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint();}),$q(0,$R,"pivotX",function(){return this._style._tf.translateX;},function($R){this.getStyle().setTranslateX($R),this.conchModel&&this.conchModel.pivot($R,this._style._tf.translateY),this.repaint();}),$q(0,$R,"pivotY",function(){return this._style._tf.translateY;},function($R){this.getStyle().setTranslateY($R),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,$R),this.repaint();}),$q(0,$R,"alpha",function(){return this._style.alpha;},function($R){this._style&&this._style.alpha!==$R&&($R=$R<0?0:1<$R?1:$R,this.getStyle().alpha=$R,this.conchModel&&this.conchModel.alpha($R),1!==$R?this._renderType|=2:this._renderType&=-3,this.parentRepaint());}),$q(0,$R,"visible",function(){return this._style.visible;},function($R){this._style&&this._style.visible!==$R&&(this.getStyle().visible=$R,this.conchModel&&this.conchModel.visible($R),this.parentRepaint());}),$q(0,$R,"graphics",function(){return this._graphics||(this.graphics=$L.createGraphics());},function($R){this._graphics&&(this._graphics._sp=null),(this._graphics=$R)?(this._renderType&=-2,this._renderType|=512,($R._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&($i.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint();}),$q(0,$R,"filters",function(){return this._$P.filters;},function($R){$R&&0===$R.length&&($R=null),this._$P.filters!=$R&&(this._set$P("filters",$R?$R.slice():null),$u.isConchApp&&(this.conchModel&&($i.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),$u.isWebGL&&($R&&$R.length?this._renderType|=32:this._renderType&=-33),$R&&0<$R.length?(this._getBit(1)||this._setUpNoticeType(1),$u.isWebGL&&1==$R.length&&$R[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&($u.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint());}),$q(0,$R,"parent",$t.prototype._$get_parent,function($R){$H.superSet($RR,this,"parent",$R),$R&&this._getBit(2)&&this._$2__onDisplay();}),$q(0,$R,"mask",function(){return this._$P._mask;},function($R){$R&&this.mask&&this.mask._$P.maskParent||($R?(this.cacheAs="bitmap",this._set$P("_mask",$R),$R._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",$R),this.cacheAs="none"),this.conchModel&&this.conchModel.mask($R?$R.conchModel:null),this._renderType|=64,this.parentRepaint());}),$q(0,$R,"mouseEnabled",function(){return 1<this._mouseEnableState;},function($R){this._mouseEnableState=$R?2:1;}),$q(0,$R,"globalScaleX",function(){for(var $R=1,$F=this;$F&&$F!==$H.stage;)$R*=$F.scaleX,$F=$F.parent;return $R;}),$q(0,$R,"mouseX",function(){return this.getMousePoint().x;}),$q(0,$R,"mouseY",function(){return this.getMousePoint().y;}),$i.fromImage=function($R){return new $i().loadImage($R);},$i._cachePool=[],$i.CustomList=[],$N($i,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=$$.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):"";}]),$i;}($RR),$kR=function($R){function $F($R){this._audio=null,this._onEnd=null,this._resumePlay=null,$F.__super.call(this),this._onEnd=$P.bind(this.__onEnd,this),this._resumePlay=$P.bind(this.__resumePlay,this),$R.addEventListener("ended",this._onEnd),this._audio=$R;}$x($F,"laya.media.h5audio.AudioSoundChannel",$jR);var $i=$F.prototype;return $i.__onEnd=function(){if(1==this.loops)return this.completeHandler&&($H.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0);},$i.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,$b.container.appendChild(this._audio),this._audio.play();}catch($R){this.event("error");}},$i.play=function($R){this.isStopped=!1;try{this._audio.playbackRate=$z.playbackRate,this._audio.currentTime=this.startTime;}catch($R){return void this._audio.addEventListener("canplay",this._resumePlay);}$z.addChannel(this),$b.container.appendChild(this._audio),!$R&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play();},$i.stop=function(){this.isStopped=!0,$z.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&$u.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),$b.onIE||this._audio!=$iR._musicAudio&&$n.recover("audio:"+this.url,this._audio),$b.removeElement(this._audio),this._audio=null);},$i.pause=function(){this.isStopped=!0,$z.removeChannel(this),"pause"in this._audio&&this._audio.pause();},$i.resume=function(){this._audio&&(this.isStopped=!1,$z.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play());},$q(0,$i,"position",function(){return this._audio?this._audio.currentTime:0;}),$q(0,$i,"duration",function(){return this._audio?this._audio.duration:0;}),$q(0,$i,"volume",function(){return this._audio?this._audio.volume:1;},function($R){this._audio&&(this._audio.volume=$R);}),$F;}(),$hR=function($R){function $F(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=$pR.ctx,$F.__super.call(this),this._onPlayEnd=$P.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode();}$x($F,"laya.media.webaudio.WebAudioSoundChannel",$jR);var $i=$F.prototype;return $i.play=function($R){if($z.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var $F=this.context,$i=this.gain,$j=$F.createBufferSource();(this.bufferSource=$j).buffer=this.audioBuffer,$j.connect($i),$i&&$i.disconnect(),$i.connect($F.destination),$j.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=$b.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&($j.loop=!0),$j.playbackRate.setTargetAtTime?$j.playbackRate.setTargetAtTime($z.playbackRate,this.context.currentTime,.1):$j.playbackRate.value=$z.playbackRate,$j.start(0,this.startTime),!$R&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0;}},$i.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&($H.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0);},$i._clearBufferSource=function(){if(this.bufferSource){var $R=this.bufferSource;$R.stop?$R.stop(0):$R.noteOff(0),$R.disconnect(0),$R.onended=null,$F._tryCleanFailed||this._tryClearBuffer($R),this.bufferSource=null;}},$i._tryClearBuffer=function($R){try{$R.buffer=null;}catch($R){$F._tryCleanFailed=!0;}},$i.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,$z.removeChannel(this),this.startHandler=null,this.completeHandler=null;},$i.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,$z.removeChannel(this);},$i.resume=function(){this.startTime=this._pauseTime,this.play(!1);},$q(0,$i,"position",function(){return this.bufferSource?($b.now()-this._startTime)/1e3+this.startTime:0;}),$q(0,$i,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0;}),$q(0,$i,"volume",function(){return this._volume;},function($R){this.isStopped||(this._volume=$R,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime($R,this.context.currentTime,.1):this.gain.gain.value=$R);}),$F._tryCleanFailed=!1,$F;}(),$SR=function($R){function $F(){$F.__super.call(this),this._w=0,this._h=0;}$x($F,"laya.resource.Bitmap",$cR);var $i=$F.prototype;return $q(0,$i,"width",function(){return this._w;}),$q(0,$i,"height",function(){return this._h;}),$q(0,$i,"source",function(){return this._source;}),$F;}(),$xR=function($F){function $R(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,$R.__super.call(this),this._interval=$j.animationInterval,this._setUpNoticeType(1);}$x($R,"laya.display.AnimationPlayerBase",$F);var $i=$R.prototype;return $i.play=function($R,$F,$i,$j){void 0===$R&&($R=0),void 0===$F&&($F=!0),void 0===$i&&($i=""),void 0===$j&&($j=!0),this._isPlaying=!0,this.index="string"==typeof $R?this._getFrameByLabel($R):$R,this.loop=$F,this._actionName=$i,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0);},$i._getFrameByLabel=function($R){var $F=0;for($F=0;$F<this._count;$F++)if(this._labels[$F]&&0<=this._labels[$F].indexOf($R))return $F;return 0;},$i._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete");}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete");}this.index=this._index;},$i._setControlNode=function($R){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=$R)&&$R!=this&&($R.on("display",this,this._checkResumePlaying),$R.on("undisplay",this,this._checkResumePlaying));},$i._setDisplay=function($R){$F.prototype._setDisplay.call(this,$R),this._checkResumePlaying();},$i._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop));},$i.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop);},$i.addLabel=function($R,$F){this._labels||(this._labels={}),this._labels[$F]||(this._labels[$F]=[]),this._labels[$F].push($R);},$i.removeLabel=function($R){if($R){if(this._labels)for(var $F in this._labels)this._removeLabelFromLabelList(this._labels[$F],$R);}else this._labels=null;},$i._removeLabelFromLabelList=function($R,$F){if($R)for(var $i=$R.length-1;0<=$i;$i--)$R[$i]==$F&&$R.splice($i,1);},$i.gotoAndStop=function($R){this.index="string"==typeof $R?this._getFrameByLabel($R):$R,this.stop();},$i._displayToIndex=function($R){},$i.clear=function(){this.stop(),this._labels=null;},$q(0,$i,"interval",function(){return this._interval;},function($R){this._interval!=$R&&(this._frameRateChanged=!0,this._interval=$R,this._isPlaying&&0<$R&&this.timerLoop($R,this,this._frameLoop,null,!0,!0));}),$q(0,$i,"isPlaying",function(){return this._isPlaying;}),$q(0,$i,"index",function(){return this._index;},function($R){if(this._index=$R,this._displayToIndex($R),this._labels&&this._labels[$R])for(var $F=this._labels[$R],$i=0,$j=$F.length;$i<$j;$i++)this.event("label",$F[$i]);}),$q(0,$i,"count",function(){return this._count;}),$R.WRAP_POSITIVE=0,$R.WRAP_REVERSE=1,$R.WRAP_PINGPONG=2,$R;}($sR),$aR=function($F){function $h(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,$h.__super.call(this),this.overflow=$h.VISIBLE,this._style=new $FR(this),this._style.wordWrap=!1;}$x($h,"laya.display.Text",$F);var $R=$h.prototype;return $R.destroy=function($R){void 0===$R&&($R=!0),$F.prototype.destroy.call(this,$R),this._lines=null,this._words&&(this._words.length=0,this._words=null);},$R._getBoundPointsM=function($R){void 0===$R&&($R=!1);var $F=$T.TEMP;return $F.setTo(0,0,this.width,this.height),$F._getBoundPoints();},$R.getGraphicBounds=function($R){void 0===$R&&($R=!1);var $F=$T.TEMP;return $F.setTo(0,0,this.width,this.height),$F;},$R._getCSSStyle=function(){return this._style;},$R.lang=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q){if($R=$h.langPacks&&$h.langPacks[$R]?$h.langPacks[$R]:$R,arguments.length<2)this._text=$R;else{for(var $s=0,$k=arguments.length;$s<$k;$s++)$R=$R.replace("{"+$s+"}",arguments[$s+1]);this._text=$R;}},$R._isPassWordMode=function(){var $R=this._style.password;return"prompt"in this&&this.prompt==this._text&&($R=!1),$R;},$R._getPassWordTxt=function($R){var $F;$F="";for(var $i=$R.length;0<$i;$i--)$F+="●";return $F;},$R.renderText=function($R,$F){var $i=this.graphics;$i.clear(!0);var $j=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+($b.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);$b.context.font=$j;var $t=this.padding,$p=$t[3],$$="left",$V=this._lines,$N=this.leading+this._charSize.height,$c=this._currBitmapFont;$c&&($N=this.leading+$c.getMaxHeight());var $q=$t[0];if(!$c&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?($$="right",$p=this._width-$t[1]):"center"==this.align&&($$="center",$p=.5*this._width+$t[3]-$t[1])),0<this._height){var $s=this._textHeight>this._height?"top":this.valign;"middle"===$s?$q=.5*(this._height-$F*$N)+$t[0]-$t[2]:"bottom"===$s&&($q=this._height-$F*$N-$t[2]);}var $k=this._style;if($c&&$c.autoScaleSize)var $h=$c.fontSize/this.fontSize;if(this._clipPoint)if($i.save(),$c&&$c.autoScaleSize){var $S=0,$x=0;$S=this._width?this._width-$t[3]-$t[1]:this._textWidth,$x=this._height?this._height-$t[0]-$t[2]:this._textHeight,$S*=$h,$x*=$h,$i.clipRect($t[3],$t[0],$S,$x);}else $i.clipRect($t[3],$t[0],this._width?this._width-$t[3]-$t[1]:this._textWidth,this._height?this._height-$t[0]-$t[2]:this._textHeight);var $a=$k.password;"prompt"in this&&this.prompt==this._text&&($a=!1);for(var $m=0,$M=0,$J=Math.min(this._lines.length,$F+$R)||1,$d=$R;$d<$J;$d++){var $w,$X=$V[$d];if($a){var $H=$X.length;$X="";for(var $_=$H;0<$_;$_--)$X+="●";}if($m=$p-(this._clipPoint?this._clipPoint.x:0),$M=$q+$N*$d-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline($$,$m,$M,$d),$c){var $T=this.width;$c.autoScaleSize&&($T=this.width*$h),$c.drawText($X,this,$m,$M,this.align,$T);}else $u.isWebGL?(this._words||(this._words=[]),($w=this._words.length>$d-$R?this._words[$d-$R]:new $D()).setText($X)):$w=$X,$k.stroke?$i.fillBorderText($w,$m,$M,$j,this.color,$k.strokeColor,$k.stroke,$$):$i.fillText($w,$m,$M,$j,this.color,$$);}if($c&&$c.autoScaleSize){var $g=1/$h;this.scale($g,$g);}this._clipPoint&&$i.restore(),this._startX=$p,this._startY=$q;},$R.drawUnderline=function($R,$F,$i,$j){var $t=this._lineWidths[$j];switch($R){case"center":$F-=$t/2;break;case"right":$F-=$t;}$i+=this._charSize.height,this._graphics.drawLine($F,$i,$F+$t,$i,this.underlineColor||this.color,1);},$R.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);$b.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new $_(0,0)):this._clipPoint=null;var $R=this._lines.length;if(this.overflow!=$h.VISIBLE){var $F=this.overflow==$h.HIDDEN?Math.floor:Math.ceil;$R=Math.min($R,$F((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)));}var $i=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText($i,$R),this.repaint();},$R.evalTextSize=function(){var $R,$F=NaN;$R=Math.max.apply(this,this._lineWidths),$F=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],$R==this._textWidth&&$F==this._textHeight||(this._textWidth=$R,this._textHeight=$F,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight));},$R.checkEnabledViewportOrNot=function(){return this.overflow==$h.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height);},$R.changeText=function($R){this._text!==$R&&(this.lang($R+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset());},$R.parseLines=function($R){var $F=this.wordWrap||this.overflow==$h.HIDDEN;if($F)var $i=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var $j=$P.contextMeasureText($h._testWord);$u.isConchApp&&0===$j.width&&0===$j.height&&($j=$P.contextMeasureText("W")),this._charSize.width=$j.width,this._charSize.height=$j.height||this.fontSize;}for(var $t=$R.replace(/\r\n/g,"\n").split("\n"),$p=0,$$=$t.length;$p<$$;$p++){var $V=$t[$p];$F?this.parseLine($V,$i):(this._lineWidths.push(this.getTextWidth($V)),this._lines.push($V));}},$R.parseLine=function($R,$F){$b.context;var $i,$j=this._lines,$t=0,$p=NaN,$$=NaN,$V=0;if(($p=this.getTextWidth($R))<=$F)return $j.push($R),void this._lineWidths.push($p);$p=this._charSize.width,0==($t=Math.floor($F/$p))&&($t=1),$$=$p=this.getTextWidth($R.substring(0,$t));for(var $N=$t,$c=$R.length;$N<$c;$N++)if($F<($$+=$p=this.getTextWidth($R.charAt($N))))if(this.wordWrap){var $q=$R.substring($V,$N);if($q.charCodeAt($q.length-1)<255?($i=/(?:\w|-)+$/.exec($q))&&($N=$i.index+$V,0==$i.index?$N+=$q.length:$q=$R.substring($V,$N)):$h.RightToLeft&&($i=/([\u0600-\u06FF])+$/.exec($q))&&($N=$i.index+$V,0==$i.index?$N+=$q.length:$q=$R.substring($V,$N)),$j.push($q),this._lineWidths.push($$-$p),!(($V=$N)+$t<$c)){$j.push($R.substring($V,$c)),this._lineWidths.push(this.getTextWidth($j[$j.length-1])),$V=-1;break;}$N+=$t,$$=$p=this.getTextWidth($R.substring($V,$N)),$N--;}else if(this.overflow==$h.HIDDEN)return $j.push($R.substring(0,$N)),void this._lineWidths.push(this.getTextWidth($j[$j.length-1]));this.wordWrap&&-1!=$V&&($j.push($R.substring($V,$c)),this._lineWidths.push(this.getTextWidth($j[$j.length-1])));},$R.getTextWidth=function($R){return this._currBitmapFont?this._currBitmapFont.getTextWidth($R):$P.contextMeasureText($R).width;},$R.getWordWrapWidth=function(){var $R=this.padding,$F=NaN;return($F=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&($F=this.wordWrap?100:$b.width),$F<=0&&($F=100),$F-$R[3]-$R[1];},$R.getCharPoint=function($R,$F){this._isChanged&&$H.timer.runCallLater(this,this.typeset);for(var $i=0,$j=this._lines,$t=0,$p=0,$$=$j.length;$p<$$;$p++){if($R<($i+=$j[$p].length)){var $V=$p;break;}$t=$i;}var $N=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;$b.context.font=$N;var $c=this.getTextWidth(this._text.substring($t,$R));return($F||new $_()).setTo(this._startX+$c-(this._clipPoint?this._clipPoint.x:0),this._startY+$V*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0));},$q(0,$R,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3];},function($R){$R!=this._width&&($H.superSet($sR,this,"width",$R),this.isChanged=!0);}),$q(0,$R,"textWidth",function(){return this._isChanged&&$H.timer.runCallLater(this,this.typeset),this._textWidth;}),$q(0,$R,"height",function(){return this._height?this._height:this.textHeight;},function($R){$R!=this._height&&($H.superSet($sR,this,"height",$R),this.isChanged=!0);}),$q(0,$R,"textHeight",function(){return this._isChanged&&$H.timer.runCallLater(this,this.typeset),this._textHeight;}),$q(0,$R,"padding",function(){return this._getCSSStyle().padding;},function($R){this._getCSSStyle().padding=$R,this.isChanged=!0;}),$q(0,$R,"bold",function(){return this._getCSSStyle().bold;},function($R){this._getCSSStyle().bold=$R,this.isChanged=!0;}),$q(0,$R,"text",function(){return this._text||"";},function($R){this._text!==$R&&(this.lang($R+""),this.isChanged=!0,this.event("change"));}),$q(0,$R,"color",function(){return this._getCSSStyle().color;},function($R){this._getCSSStyle().color!=$R&&(this._getCSSStyle().color=$R,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0);}),$q(0,$R,"font",function(){return this._getCSSStyle().fontFamily;},function($R){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),$h._bitmapFonts&&$h._bitmapFonts[$R]&&(this._currBitmapFont=$h._bitmapFonts[$R]),this._getCSSStyle().fontFamily=$R,this.isChanged=!0;}),$q(0,$R,"fontSize",function(){return this._getCSSStyle().fontSize;},function($R){this._getCSSStyle().fontSize=$R,this.isChanged=!0;}),$q(0,$R,"italic",function(){return this._getCSSStyle().italic;},function($R){this._getCSSStyle().italic=$R,this.isChanged=!0;}),$q(0,$R,"align",function(){return this._getCSSStyle().align;},function($R){this._getCSSStyle().align=$R,this.isChanged=!0;}),$q(0,$R,"valign",function(){return this._getCSSStyle().valign;},function($R){this._getCSSStyle().valign=$R,this.isChanged=!0;}),$q(0,$R,"wordWrap",function(){return this._getCSSStyle().wordWrap;},function($R){this._getCSSStyle().wordWrap=$R,this.isChanged=!0;}),$q(0,$R,"leading",function(){return this._getCSSStyle().leading;},function($R){this._getCSSStyle().leading=$R,this.isChanged=!0;}),$q(0,$R,"bgColor",function(){return this._getCSSStyle().backgroundColor;},function($R){this._getCSSStyle().backgroundColor=$R,this.isChanged=!0;}),$q(0,$R,"borderColor",function(){return this._getCSSStyle().borderColor;},function($R){this._getCSSStyle().borderColor=$R,this.isChanged=!0;}),$q(0,$R,"stroke",function(){return this._getCSSStyle().stroke;},function($R){this._getCSSStyle().stroke=$R,this.isChanged=!0;}),$q(0,$R,"strokeColor",function(){return this._getCSSStyle().strokeColor;},function($R){this._getCSSStyle().strokeColor=$R,this.isChanged=!0;}),$q(0,$R,"isChanged",null,function($R){this._isChanged!==$R&&(this._isChanged=$R)&&$H.timer.callLater(this,this.typeset);}),$q(0,$R,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0;},function($R){if(!(this.overflow!=$h.SCROLL||this.textWidth<this._width)&&this._clipPoint){$R=$R<this.padding[3]?this.padding[3]:$R;var $F=this._textWidth-this._width;$R=$F<$R?$F:$R;var $i=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=$R,this.renderText(this._lastVisibleLineIndex,$i);}}),$q(0,$R,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0;},function($R){if(!(this.overflow!=$h.SCROLL||this.textHeight<this._height)&&this._clipPoint){$R=$R<this.padding[0]?this.padding[0]:$R;var $F=this._textHeight-this._height,$i=($R=$F<$R?$F:$R)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=$i;var $j=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=$R,this.renderText($i,$j);}}),$q(0,$R,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width;}),$q(0,$R,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height;}),$q(0,$R,"lines",function(){return this._isChanged&&this.typeset(),this._lines;}),$q(0,$R,"underlineColor",function(){return this._underlineColor;},function($R){this._underlineColor=$R,this._isChanged=!0,this.typeset();}),$h.registerBitmapFont=function($R,$F){$h._bitmapFonts||($h._bitmapFonts={}),$h._bitmapFonts[$R]=$F;},$h.unregisterBitmapFont=function($R,$F){if(void 0===$F&&($F=!0),$h._bitmapFonts&&$h._bitmapFonts[$R]){var $i=$h._bitmapFonts[$R];$F&&$i.destroy(),delete $h._bitmapFonts[$R];}},$h.setTextRightToLeft=function(){var $R;($R=$b.canvas.source.style).display="none",$R.position="absolute",$R.direction="rtl",$u._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,$b.document.body.appendChild($b.canvas.source);},$h.supportFont=function($R){$b.context.font="10px sans-serif";var $F=$P.contextMeasureText("abcji").width;$b.context.font="10px "+$R;var $i=$P.contextMeasureText("abcji").width;return console.log($F,$i),$F!==$i;},$h._testWord="游",$h.langPacks=null,$h.VISIBLE="visible",$h.SCROLL="scroll",$h.HIDDEN="hidden",$h.CharacterCache=!0,$h.RightToLeft=!1,$h._bitmapFonts=null,$N($h,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"};}]),$h;}($sR),$mR=function($s){function $$(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",$$.__super.call(this),this.offset=new $_(),this._canvasTransform=new $Y(),this._previousOrientation=$b.window.orientation;var $F=this;this.transform=$Y.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var $R=$b.window,$i=this;$R.addEventListener("focus",function(){$F._isFocused=!0,$i.event("focus"),$i.event("focuschange");}),$R.addEventListener("blur",function(){$F._isFocused=!1,$i.event("blur"),$i.event("focuschange"),$i._isInputting()&&($wR.inputElement.target.focus=!1);});var $j="visibilityState",$t="visibilitychange",$p=$R.document;void 0!==$p.hidden?($t="visibilitychange",$j="visibilityState"):void 0!==$p.mozHidden?($t="mozvisibilitychange",$j="mozVisibilityState"):void 0!==$p.msHidden?($t="msvisibilitychange",$j="msVisibilityState"):void 0!==$p.webkitHidden&&($t="webkitvisibilitychange",$j="webkitVisibilityState"),$R.document.addEventListener($t,function(){"hidden"==$b.document[$j]?$i._setStageVisible(!1):$i._setStageVisible(!0);}),$R.document.addEventListener("qbrowserVisibilityChange",function($R){$i._setStageVisible(!$R.hidden);}),$R.addEventListener("resize",function(){var $R=$b.window.orientation;null!=$R&&$R!=$F._previousOrientation&&$i._isInputting()&&($wR.inputElement.target.focus=!1),$F._previousOrientation=$R,$i._isInputting()||$i._resetCanvas();}),$R.addEventListener("orientationchange",function($R){$i._resetCanvas();}),this.on("mousemove",this,this._onmouseMove),$b.onMobile&&this.on("mousedown",this,this._onmouseMove);}$x($$,"laya.display.Stage",$s);var $R=$$.prototype;return $R._setStageVisible=function($R){this._isVisibility!=$R&&(this._isVisibility=$R,this._isVisibility||this._isInputting()&&($wR.inputElement.target.focus=!1),this.event("visibilitychange"));},$R._isInputting=function(){return $b.onMobile&&$wR.isInputting;},$R._changeCanvasSize=function(){this.setScreenSize($b.clientWidth*$b.pixelRatio,$b.clientHeight*$b.pixelRatio);},$R._resetCanvas=function(){if(this.screenAdaptationEnabled){var $R=$u._mainCanvas;$R.source.style;$R.size(1,1),$H.timer.once(100,this,this._changeCanvasSize);}},$R.setScreenSize=function($R,$F){var $i=!1;if("none"!==this._screenMode&&($i=($R/$F<1?"vertical":"horizontal")!==this._screenMode)){var $j=$F;$F=$R,$R=$j;}this.canvasRotation=$i;var $t=$u._mainCanvas,$p=$t.source.style,$$=this._canvasTransform.identity(),$V=this._scaleMode,$N=$R/this.designWidth,$c=$F/this.designHeight,$q=this.designWidth,$s=this.designHeight,$k=$R,$h=$F,$S=$b.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,$V){case"noscale":$N=$c=1,$k=this.designWidth,$h=this.designHeight;break;case"showall":$N=$c=Math.min($N,$c),$q=$k=Math.round(this.designWidth*$N),$s=$h=Math.round(this.designHeight*$c);break;case"noborder":$N=$c=Math.max($N,$c),$k=Math.round(this.designWidth*$N),$h=Math.round(this.designHeight*$c);break;case"full":$N=$c=1,this._width=$q=$R,this._height=$s=$F;break;case"fixedwidth":$c=$N,this._height=$s=Math.round($F/$N);break;case"fixedheight":$N=$c,this._width=$q=Math.round($R/$c);break;case"fixedauto":$R/$F<this.designWidth/this.designHeight?($c=$N,this._height=$s=Math.round($F/$N)):($N=$c,this._width=$q=Math.round($R/$c));}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,$q=$q+1&2147483646,$s=$s+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),$N*=this.scaleX,$c*=this.scaleY,1===$N&&1===$c?this.transform.identity():(this.transform.a=this._formatData($N/($k/$q)),this.transform.d=this._formatData($c/($h/$s)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),$t.size($q,$s),$L.changeWebGLSize($q,$s),$$.scale($k/$q/$S,$h/$s/$S),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=($R-$k)/$S:this.offset.x=.5*($R-$k)/$S,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=($F-$h)/$S:this.offset.y=.5*($F-$h)/$S,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),$$.translate(this.offset.x,this.offset.y),this.canvasDegree=0,$i&&("horizontal"===this._screenMode?($$.rotate(Math.PI/2),$$.translate($F/$S,0),this.canvasDegree=90):($$.rotate(-Math.PI/2),$$.translate(0,$R/$S),this.canvasDegree=-90)),$$.a=this._formatData($$.a),$$.d=this._formatData($$.d),$$.tx=this._formatData($$.tx),$$.ty=this._formatData($$.ty),$p.transformOrigin=$p.webkitTransformOrigin=$p.msTransformOrigin=$p.mozTransformOrigin=$p.oTransformOrigin="0px 0px 0px",$p.transform=$p.webkitTransform=$p.msTransform=$p.mozTransform=$p.oTransform="matrix("+$$.toString()+")",$$.translate(parseInt($p.left)||0,parseInt($p.top)||0),this.visible=!0,this._repaint=1,this.event("resize");},$R._formatData=function($R){return Math.abs($R)<1e-6?0:Math.abs(1-$R)<.001?0<$R?1:-1:$R;},$R.getMousePoint=function(){return $_.TEMP.setTo(this.mouseX,this.mouseY);},$R.repaint=function(){this._repaint=1;},$R.parentRepaint=function(){},$R._loop=function(){return this.render($u.context,0,0),!0;},$R._onmouseMove=function($R){this._mouseMoveTime=$b.now();},$R.getTimeFromFrameStart=function(){return $b.now()-this._frameStartTime;},$R.render=function($R,$F,$i){if("sleep"===this._frameRate&&!$u.isConchApp){var $j=$b.now();if(!(1e3<=$j-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&($C.loopCount++,$S.instance.runEvent(),$H.timer._update()));this._frameStartTime=$j;}if(this._renderCount++,$u.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=$b.now();var $t="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),$p=this._renderCount%2==0;if($C.renderSlow=!$t,$t||$p||$u.isConchApp){var $$;$C.loopCount++,$S.instance.runEvent(),$H.timer._update(),$L.update3DLoop();var $V=0,$N=0;if($u.isConchNode)for($V=0,$N=this._scenes.length;$V<$N;$V++)($$=this._scenes[$V])&&$$._updateSceneConch();else for($V=0,$N=this._scenes.length;$V<$N;$V++)($$=this._scenes[$V])&&$$._updateScene();if($u.isConchNode){var $c=$sR.CustomList;for($V=0,$N=$c.length;$V<$N;$V++){var $q=$c[$V];$q.customRender($q.customContext,0,0);}return;}}$u.isConchNode||this.renderingEnabled&&($t||!$p||$u.isConchWebGL)&&($u.isWebGL?$u.WebGL.mainContext&&!$u.WebGL.mainContext.isContextLost()&&($R.clear(),$s.prototype.render.call(this,$R,$F,$i),$C._show&&$C._sp&&$C._sp.render($R,$F,$i),$L.clear(this._bgColor),$L.beginFlush(),$R.flush(),$L.endFinish(),$U.instance&&$U.getInstance().endDispose()):($L.clear(this._bgColor),$s.prototype.render.call(this,$R,$F,$i),$C._show&&$C._sp&&$C._sp.render($R,$F,$i)));}else this._renderCount%5==0&&($C.loopCount++,$S.instance.runEvent(),$H.timer._update());},$R._requestFullscreen=function(){var $R=$b.document.documentElement;$R.requestFullscreen?$R.requestFullscreen():$R.mozRequestFullScreen?$R.mozRequestFullScreen():$R.webkitRequestFullscreen?$R.webkitRequestFullscreen():$R.msRequestFullscreen&&$R.msRequestFullscreen();},$R._fullScreenChanged=function(){$H.stage.event("fullscreenchange");},$R.exitFullscreen=function(){var $R=$b.document;$R.exitFullscreen?$R.exitFullscreen():$R.mozCancelFullScreen?$R.mozCancelFullScreen():$R.webkitExitFullscreen&&$R.webkitExitFullscreen();},$q(0,$R,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1;}),$q(0,$R,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight;}),$q(0,$R,"frameRate",function(){return this._frameRate;},function($R){if(this._frameRate=$R,$u.isConchApp)switch(this._frameRate){case"slow":$b.window.conch&&$b.window.conchConfig.setSlowFrame&&$b.window.conchConfig.setSlowFrame(!0);break;case"fast":$b.window.conch&&$b.window.conchConfig.setSlowFrame&&$b.window.conchConfig.setSlowFrame(!1);break;case"mouse":$b.window.conch&&$b.window.conchConfig.setMouseFrame&&$b.window.conchConfig.setMouseFrame(2e3);break;case"sleep":$b.window.conch&&$b.window.conchConfig.setLimitFPS&&$b.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.");}}),$q(0,$R,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1;}),$q(0,$R,"width",$s.prototype._$get_width,function($R){this.designWidth=$R,$H.superSet($sR,this,"width",$R),$H.timer.callLater(this,this._changeCanvasSize);}),$q(0,$R,"alignH",function(){return this._alignH;},function($R){this._alignH=$R,$H.timer.callLater(this,this._changeCanvasSize);}),$q(0,$R,"isFocused",function(){return this._isFocused;}),$q(0,$R,"height",$s.prototype._$get_height,function($R){this.designHeight=$R,$H.superSet($sR,this,"height",$R),$H.timer.callLater(this,this._changeCanvasSize);}),$q(0,$R,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||$Y.create();},$s.prototype._$set_transform),$q(0,$R,"isVisibility",function(){return this._isVisibility;}),$q(0,$R,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth;}),$q(0,$R,"scaleMode",function(){return this._scaleMode;},function($R){this._scaleMode=$R,$H.timer.callLater(this,this._changeCanvasSize);}),$q(0,$R,"alignV",function(){return this._alignV;},function($R){this._alignV=$R,$H.timer.callLater(this,this._changeCanvasSize);}),$q(0,$R,"bgColor",function(){return this._bgColor;},function($R){this._bgColor=$R,this.conchModel&&this.conchModel.bgColor($R),$u.isWebGL&&($R?$$._wgColor=$E.create($R)._color:$b.onMiniGame||($$._wgColor=null)),$b.onLimixiu?$$._wgColor=$E.create($R)._color:$u.canvas.style.background=$R||"none";}),$q(0,$R,"mouseX",function(){return Math.round($S.instance.mouseX/this.clientScaleX);}),$q(0,$R,"mouseY",function(){return Math.round($S.instance.mouseY/this.clientScaleY);}),$q(0,$R,"screenMode",function(){return this._screenMode;},function($R){this._screenMode=$R;}),$q(0,$R,"visible",$s.prototype._$get_visible,function($R){this.visible!==$R&&($H.superSet($sR,this,"visible",$R),$u._mainCanvas.source.style.visibility=$R?"visible":"hidden");}),$q(0,$R,"fullScreenEnabled",null,function($R){var $F=$b.document,$i=$u.canvas;$R?($i.addEventListener("mousedown",this._requestFullscreen),$i.addEventListener("touchstart",this._requestFullscreen),$F.addEventListener("fullscreenchange",this._fullScreenChanged),$F.addEventListener("mozfullscreenchange",this._fullScreenChanged),$F.addEventListener("webkitfullscreenchange",this._fullScreenChanged),$F.addEventListener("msfullscreenchange",this._fullScreenChanged)):($i.removeEventListener("mousedown",this._requestFullscreen),$i.removeEventListener("touchstart",this._requestFullscreen),$F.removeEventListener("fullscreenchange",this._fullScreenChanged),$F.removeEventListener("mozfullscreenchange",this._fullScreenChanged),$F.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),$F.removeEventListener("msfullscreenchange",this._fullScreenChanged));}),$$.SCALE_NOSCALE="noscale",$$.SCALE_EXACTFIT="exactfit",$$.SCALE_SHOWALL="showall",$$.SCALE_NOBORDER="noborder",$$.SCALE_FULL="full",$$.SCALE_FIXED_WIDTH="fixedwidth",$$.SCALE_FIXED_HEIGHT="fixedheight",$$.SCALE_FIXED_AUTO="fixedauto",$$.ALIGN_LEFT="left",$$.ALIGN_RIGHT="right",$$.ALIGN_CENTER="center",$$.ALIGN_TOP="top",$$.ALIGN_MIDDLE="middle",$$.ALIGN_BOTTOM="bottom",$$.SCREEN_NONE="none",$$.SCREEN_HORIZONTAL="horizontal",$$.SCREEN_VERTICAL="vertical",$$.FRAME_FAST="fast",$$.FRAME_SLOW="slow",$$.FRAME_MOUSE="mouse",$$.FRAME_SLEEP="sleep",$$.FRAME_MOUSE_THREDHOLD=2e3,$N($$,["_wgColor",function(){return this._wgColor=[0,0,0,1];}]),$$;}($sR),$MR=(function($R){function $F(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,$F.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange);}$x($F,"laya.media.SoundNode",$sR);var $i=$F.prototype;$i._onParentChange=function(){this.target=this.parent;},$i.play=function($R,$F){void 0===$R&&($R=1),isNaN($R)&&($R=1),this.url&&(this.stop(),this._channel=$z.playSound(this.url,$R,null,$F));},$i.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null;},$i._setPlayAction=function($R,$F,$i,$j){void 0===$j&&($j=!0),this[$i]&&$R&&($j?$R.on($F,this,this[$i]):$R.off($F,this,this[$i]));},$i._setPlayActions=function($R,$F,$i,$j){if(void 0===$j&&($j=!0),$R&&$F){var $t,$p=$F.split(","),$$=0;for($t=$p.length,$$=0;$$<$t;$$++)this._setPlayAction($R,$p[$$],$i,$j);}},$q(0,$i,"playEvent",null,function($R){(this._playEvents=$R)&&this._tar&&this._setPlayActions(this._tar,$R,"play");}),$q(0,$i,"target",null,function($R){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=$R,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0));}),$q(0,$i,"stopEvent",null,function($R){(this._stopEvents=$R)&&this._tar&&this._setPlayActions(this._tar,$R,"stop");});}(),function($R){function $F(){this._src=null,this._onload=null,this._onerror=null,$F.__super.call(this);}$x($F,"laya.resource.FileBitmap",$SR);var $i=$F.prototype;return $q(0,$i,"src",function(){return this._src;},function($R){this._src=$R;}),$q(0,$i,"onload",null,function($R){}),$q(0,$i,"onerror",null,function($R){}),$F;}()),$JR=function($R){function $i($R,$F){this._is2D=!1,$i.__super.call(this);var $j=this;if(this._source=this,"2D"===$R||"AUTO"===$R&&!$u.isWebGL){this._is2D=!0,this._source=$F||$b.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var $t=this;$t.getContext=function($R,$F){if($j._ctx)return $j._ctx;var $i=$j._ctx=$j._source.getContext($R,$F);return $i&&($i._canvas=$t,$u.isFlash||$b.onLimixiu||($i.size=function($R,$F){})),$i;};}this.uri="HTMLCanvas_"+this.id,this.lock=!0;}$x($i,"laya.resource.HTMLCanvas",$SR);var $F=$i.prototype;return $F.clear=function(){this._ctx&&this._ctx.clear();},$F.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this);},$F.release=function(){},$F._setContext=function($R){this._ctx=$R;},$F.getContext=function($R,$F){return this._ctx?this._ctx:this._ctx=$i._createContext(this);},$F.getMemSize=function(){return 0;},$F.size=function($R,$F){(this._w!=$R||this._h!=$F||this._source&&(this._source.width!=$R||this._source.height!=$F))&&(this._w=$R,this._h=$F,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size($R,$F),this._source&&(this._source.height=$F,this._source.width=$R));},$F.getCanvas=function(){return this._source;},$F.toBase64=function($R,$F,$i){if(this._source)if($u.isConchApp&&this._source.toBase64)this._source.toBase64($R,$F,$i);else{var $j=this._source.toDataURL($R,$F);$i.call(this,$j);}},$q(0,$F,"context",function(){return this._ctx;}),$q(0,$F,"asBitmap",null,function($R){}),$i.create=function($R,$F){return new $i($R,$F);},$i.TYPE2D="2D",$i.TYPE3D="3D",$i.TYPEAUTO="AUTO",$i._createContext=null,$i;}(),$dR=(function($R){function $N($R,$F,$i,$j,$t,$p,$$,$V){throw $N.__super.call(this),new Error("不允许new！");}$x($N,"laya.resource.HTMLSubImage",$SR),$N.create=function($R,$F,$i,$j,$t,$p,$$,$V){return void 0===$V&&($V=!1),new $N($R,$F,$i,$j,$t,$p,$$,$V);};}(),function($R){function $s(){this._frames=null,this._url=null,$s.__super.call(this),this._setControlNode(this);}$x($s,"laya.display.Animation",$R);var $F=$s.prototype;$F.destroy=function($R){void 0===$R&&($R=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,$R),this._frames=null,this._labels=null;},$F.play=function($R,$F,$i,$j){void 0===$R&&($R=0),void 0===$F&&($F=!0),void 0===$i&&($i=""),void 0===$j&&($j=!0),$i&&this._setFramesFromCache($i,$j),this._isPlaying=!0,this.index="string"==typeof $R?this._getFrameByLabel($R):$R,this.loop=$F,this._actionName=$i,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0);},$F._setFramesFromCache=function($R,$F){var $i;return void 0===$F&&($F=!1),this._url&&($R=this._url+"#"+$R),$R&&$s.framesMap[$R]?(($i=$s.framesMap[$R])instanceof Array?(this._frames=$s.framesMap[$R],this._count=this._frames.length):($i.nodeRoot&&($s.framesMap[$R]=this._parseGraphicAnimationByData($i),$i=$s.framesMap[$R]),this._frames=$i.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=$i.interval),this._labels=this._copyLabels($i.labels)),!0):($F&&console.log("ani not found:",$R),!1);},$F._copyLabels=function($R){if(!$R)return null;var $F,$i;for($i in $F={},$R)$F[$i]=$P.copyArray([],$R[$i]);return $F;},$F._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&$R.prototype._frameLoop.call(this);},$F._displayToIndex=function($R){this._frames&&(this.graphics=this._frames[$R]);},$F.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null;},$F.loadImages=function($R,$F){return void 0===$F&&($F=""),this._url="",this._setFramesFromCache($F)||(this.frames=$s.framesMap[$F]?$s.framesMap[$F]:$s.createFrames($R,$F)),this;},$F.loadAtlas=function($F,$i,$j){void 0===$j&&($j=""),this._url="";var $t=this;function $R($R){$F===$R&&($t.frames=$s.framesMap[$j]?$s.framesMap[$j]:$s.createFrames($F,$j),$i&&$i.run());}return $t._setFramesFromCache($j)||($VR.getAtlas($F)?$R($F):$H.loader.load($F,$M.create(null,$R,[$F]),null,"atlas")),this;},$F.loadAnimation=function($R,$F,$i){this._url=$R;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,$F&&$F.run()):!$i||$VR.getAtlas($i)?this._loadAnimationData($R,$F,$i):$H.loader.load($i,$M.create(this,this._loadAnimationData,[$R,$F,$i]),null,"atlas"),this;},$F._loadAnimationData=function($V,$N,$R){var $c=this;if(!$R||$VR.getAtlas($R)){var $q=this;$VR.getRes($V)?$F($V):$H.loader.load($V,$M.create(null,$F,[$V]),null,"json"),$VR.clearRes($V);}else console.warn("atlas load fail:"+$R);function $F($R){if($VR.getRes($R)&&$V===$R){var $F;if($s.framesMap[$V+"#"])$q._setFramesFromCache($c._actionName,!0),$c.index=0,$c._checkResumePlaying();else{var $i=$q._parseGraphicAnimation($VR.getRes($V));if(!$i)return;var $j,$t=$i.animationList,$p=0,$$=$t.length;for($p=0;$p<$$;$p++)$F=$t[$p],$s.framesMap[$V+"#"+$F.name]=$F,$j||($j=$F);$j&&($s.framesMap[$V+"#"]=$j,$q._setFramesFromCache($c._actionName,!0),$c.index=0),$c._checkResumePlaying();}$N&&$N.run();}}},$F._parseGraphicAnimation=function($R){return $HR.parseAnimationData($R);},$F._parseGraphicAnimationByData=function($R){return $HR.parseAnimationByData($R);},$q(0,$F,"frames",function(){return this._frames;},function($R){(this._frames=$R)&&(this._count=$R.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index);}),$q(0,$F,"autoPlay",null,function($R){$R?this.play():this.stop();}),$q(0,$F,"source",null,function($R){-1<$R.indexOf(".ani")?this.loadAnimation($R):-1<$R.indexOf(".json")||-1<$R.indexOf("als")||-1<$R.indexOf("atlas")?this.loadAtlas($R):this.loadImages($R.split(","));}),$q(0,$F,"autoAnimation",null,function($R){this.play(0,!0,$R,!1);}),$s.createFrames=function($R,$F){var $i,$j,$t=0,$p=0;if("string"==typeof $R){var $$=$VR.getAtlas($R);if($$&&$$.length)for($i=[],$t=0,$p=$$.length;$t<$p;$t++)($j=new $L.createGraphics()).drawTexture($VR.getRes($$[$t]),0,0),$i.push($j);}else if($R instanceof Array)for($i=[],$t=0,$p=$R.length;$t<$p;$t++)($j=new $L.createGraphics()).loadImage($R[$t],0,0),$i.push($j);return $F&&($s.framesMap[$F]=$i),$i;},$s.clearCache=function($R){var $F,$i=$s.framesMap,$j=$R+"#";for($F in $i)$F!==$R&&0!=$F.indexOf($j)||delete $s.framesMap[$F];},$s.framesMap={};}($xR),function($R){function $p(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,$p.__super.call(this),null==$p._sortIndexFun&&($p._sortIndexFun=$X.sortByKey("index",!1,!0));}$x($p,"laya.display.FrameAnimation",$R);var $F=$p.prototype;return $F._setUp=function($R,$F){this._labels=null,this._animationNewFrames=null,this._targetDic=$R,this._animationData=$F,this.interval=1e3/$F.frameRate,$F.parsed?(this._count=$F.count,this._labels=$F.labels,this._animationNewFrames=$F.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),$F.parsed=!0,$F.labels=this._labels,$F.count=this._count,$F.animationNewFrames=this._animationNewFrames;},$F.clear=function(){$R.prototype.clear.call(this),this._targetDic=null,this._animationData=null;},$F._displayToIndex=function($R){if(this._animationData){$R<0&&($R=0),$R>this._count&&($R=this._count);var $F=this._animationData.nodes,$i=0,$j=$F.length;for($i=0;$i<$j;$i++)this._displayNodeToFrame($F[$i],$R);}},$F._displayNodeToFrame=function($R,$F,$i){$i||($i=this._targetDic);var $j=$i[$R.target];if($j){var $t,$p,$$,$V=$R.frames,$N=$R.keys,$c=0,$q=$N.length;for($c=0;$c<$q;$c++)$$=($p=$V[$t=$N[$c]]).length>$F?$p[$F]:$p[$p.length-1],$j[$t]=$$;}},$F._calculateDatas=function(){if(this._animationData){var $R,$F=this._animationData.nodes,$i=0,$j=$F.length;for($i=this._count=0;$i<$j;$i++)$R=$F[$i],this._calculateNodeKeyFrames($R);this._count+=1;}},$F._calculateNodeKeyFrames=function($R){var $F,$i,$j=$R.keyframes,$t=$R.target;for($F in $R.frames||($R.frames={}),$R.keys?$R.keys.length=0:$R.keys=[],$R.initValues||($R.initValues={}),$j)$i=$j[$F],$R.frames[$F]||($R.frames[$F]=[]),this._targetDic&&this._targetDic[$t]&&($R.initValues[$F]=this._targetDic[$t][$F]),$i.sort($p._sortIndexFun),$R.keys.push($F),this._calculateNodePropFrames($i,$R.frames[$F],$F,$t);},$F.resetToInitState=function(){if(this._targetDic&&this._animationData){var $R,$F,$i=this._animationData.nodes,$j=0,$t=$i.length;for($j=0;$j<$t;$j++)if($F=($R=$i[$j]).initValues){var $p,$$=this._targetDic[$R.target];if($$)for($p in $F)$$[$p]=$F[$p];}}},$F._calculateNodePropFrames=function($R,$F,$i,$j){var $t=0,$p=$R.length-1;if(0<$p){for($F.length=$R[$p].index+1,$t=0;$t<$p;$t++)this._dealKeyFrame($R[$t]),this._calculateFrameValues($R[$t],$R[$t+1],$F);this._dealKeyFrame($R[$t]);}0==$p&&($F[$R[0].index]=$R[0].value,this._animationNewFrames&&(this._animationNewFrames[$R[0].index]=!0));},$F._dealKeyFrame=function($R){$R.label&&""!=$R.label&&this.addLabel($R.label,$R.index);},$F._calculateFrameValues=function($R,$F,$i){var $j,$t=0,$p=$R.index,$$=$F.index,$V=$R.value,$N=$F.value-$R.value,$c=$$-$p;if($$>this._count&&(this._count=$$),$R.tween)for(null==($j=$W[$R.tweenMethod])&&($j=$W.linearNone),$t=$p;$t<$$;$t++)$i[$t]=$j($t-$p,$V,$N,$c),this._animationNewFrames&&(this._animationNewFrames[$t]=!0);else for($t=$p;$t<$$;$t++)$i[$t]=$V;this._animationNewFrames&&(this._animationNewFrames[$R.index]=!0,this._animationNewFrames[$F.index]=!0),$i[$F.index]=$F.value;},$p._sortIndexFun=null,$p;}($xR)),$wR=function($F){function $t(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",$t.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=$aR.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay);}$x($t,"laya.display.Input",$F);var $R=$t.prototype;return $R.setSelection=function($R,$F){this.focus=!0,laya.display.Input.inputElement.selectionStart=$R,laya.display.Input.inputElement.selectionEnd=$F;},$R._onUnDisplay=function($R){this.focus=!1;},$R._onMouseDown=function($R){this.focus=!0;},$R._syncInputTransform=function(){var $R=this.nativeInput,$F=$P.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),$i=this._width-this.padding[1]-this.padding[3],$j=this._height-this.padding[0]-this.padding[2];$u.isConchApp?($R.setScale($F.scaleX,$F.scaleY),$R.setSize($i,$j),$R.setPos($F.x,$F.y)):($t.inputContainer.style.transform=$t.inputContainer.style.webkitTransform="scale("+$F.scaleX+","+$F.scaleY+") rotate("+$H.stage.canvasDegree+"deg)",$R.style.width=$i+"px",$R.style.height=$j+"px",$t.inputContainer.style.left=$F.x+"px",$t.inputContainer.style.top=$F.y+"px");},$R.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select();},$R._setInputMethod=function(){$t.input.parentElement&&$t.inputContainer.removeChild($t.input),$t.area.parentElement&&$t.inputContainer.removeChild($t.area),$t.inputElement=this._multiline?$t.area:$t.input,$t.inputContainer.appendChild($t.inputElement),$aR.RightToLeft&&($t.inputElement.style.direction="rtl");},$R._focusIn=function(){laya.display.Input.isInputting=!0;var $R=this.nativeInput;this._focus=!0;var $F=$R.style;$F.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),$R.readOnly=!this._editable,$u.isConchApp&&($R.setType(this._type),$R.setForbidEdit(!this._editable)),$R.maxLength=this._maxChars;this.padding;if($R.type=this._type,$R.value=this._content,$R.placeholder=this._prompt,$H.stage.off("keydown",this,this._onKeyDown),$H.stage.on("keydown",this,this._onKeyDown),($H.stage.focus=this).event("focus"),$b.onPC&&$R.focus(),!$b.onMiniGame){this._text;this._text=null;}this.typeset(),$R.setColor(this._originColor),$R.setFontSize(this.fontSize),$R.setFontFace($b.onIPhone&&$aR._fontFamilyMap[this.font]||this.font),$u.isConchApp&&$R.setMultiAble&&$R.setMultiAble(this._multiline),$F.lineHeight=this.leading+this.fontSize+"px",$F.fontStyle=this.italic?"italic":"normal",$F.fontWeight=this.bold?"bold":"normal",$F.textAlign=this.align,$F.padding="0 0",this._syncInputTransform(),!$u.isConchApp&&$b.onPC&&$H.timer.frameLoop(1,this,this._syncInputTransform);},$R._setPromptColor=function(){($t.promptStyleDOM=$b.getElementById("promptStyle"))||(($t.promptStyleDOM=$b.createElement("style")).setAttribute("id","promptStyle"),$b.document.head.appendChild($t.promptStyleDOM)),$t.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}";},$R._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?($H.superSet($aR,this,"text",this._content),$H.superSet($aR,this,"color",this._originColor)):($H.superSet($aR,this,"text",this._prompt),$H.superSet($aR,this,"color",this._promptColor)),$H.stage.off("keydown",this,this._onKeyDown),$H.stage.focus=null,this.event("blur"),$u.isConchApp&&this.nativeInput.blur(),$b.onPC&&$H.timer.clear(this,this._syncInputTransform);},$R._onKeyDown=function($R){13===$R.keyCode&&($b.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"));},$R.changeText=function($R){this._content=$R,this._focus?(this.nativeInput.value=$R||"",this.event("change")):$F.prototype.changeText.call(this,$R);},$q(0,$R,"color",$F.prototype._$get_color,function($R){this._focus&&this.nativeInput.setColor($R),$H.superSet($aR,this,"color",this._content?$R:this._promptColor),this._originColor=$R;}),$q(0,$R,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0;},function($R){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。");}),$q(0,$R,"multiline",function(){return this._multiline;},function($R){this._multiline=$R,this.valign=$R?"top":"middle";}),$q(0,$R,"maxChars",function(){return this._maxChars;},function($R){$R<=0&&($R=1e5),this._maxChars=$R;}),$q(0,$R,"text",function(){return this._focus?this.nativeInput.value:this._content||"";},function($R){$H.superSet($aR,this,"color",this._originColor),$R+="",this._focus?(this.nativeInput.value=$R||"",this.event("change")):(this._multiline||($R=$R.replace(/\r?\n/g,"")),(this._content=$R)?$H.superSet($aR,this,"text",$R):($H.superSet($aR,this,"text",this._prompt),$H.superSet($aR,this,"color",this.promptColor)));}),$q(0,$R,"nativeInput",function(){return this._multiline?$t.area:$t.input;}),$q(0,$R,"prompt",function(){return this._prompt;},function($R){!this._text&&$R&&$H.superSet($aR,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?$H.superSet($aR,this,"text",this._text==this._prompt?$R:this._text):$H.superSet($aR,this,"text",$R),this._prompt=$aR.langPacks&&$aR.langPacks[$R]?$aR.langPacks[$R]:$R;}),$q(0,$R,"focus",function(){return this._focus;},function($R){var $F=this.nativeInput;this._focus!==$R&&($R?($F.target?$F.target._focusOut():this._setInputMethod(),($F.target=this)._focusIn()):($F.target=null,this._focusOut(),$b.document.body.scrollTop=0,$F.blur(),$u.isConchApp?$F.setPos(-1e4,-1e4):$t.inputContainer.contains($F)&&$t.inputContainer.removeChild($F)));}),$q(0,$R,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:"";},function($R){$R?(-1<($R="[^"+$R+"]").indexOf("^^")&&($R=$R.replace("^^","")),this._restrictPattern=new RegExp($R,"g")):this._restrictPattern=null;}),$q(0,$R,"editable",function(){return this._editable;},function($R){this._editable=$R,$u.isConchApp&&$t.input.setForbidEdit(!$R);}),$q(0,$R,"promptColor",function(){return this._promptColor;},function($R){this._promptColor=$R,this._content||$H.superSet($aR,this,"color",$R);}),$q(0,$R,"type",function(){return this._type;},function($R){this._getCSSStyle().password="password"==$R,this._type=$R,$u.isConchApp&&this.nativeInput.setType($R);}),$q(0,$R,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0;},function($R){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。");}),$q(0,$R,"asPassword",function(){return this._getCSSStyle().password;},function($R){this._getCSSStyle().password=$R,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0;}),$t.__init__=function(){$t._createInputElement(),$b.onMobile&&$u.canvas.addEventListener($t.IOS_IFRAME?$b.onMiniGame?"touchend":"click":"touchend",$t._popupInputMethod);},$t._popupInputMethod=function($R){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus();},$t._createInputElement=function(){$t._initInput($t.area=$b.createElement("textarea")),$t._initInput($t.input=$b.createElement("input")),($t.inputContainer=$b.createElement("div")).style.position="absolute",$t.inputContainer.style.zIndex=1e5,$b.container.appendChild($t.inputContainer),$t.inputContainer.setPos=function($R,$F){$t.inputContainer.style.left=$R+"px",$t.inputContainer.style.top=$F+"px";};},$t._initInput=function($F){var $R=$F.style;$R.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",$R.resize="none",$R.backgroundColor="transparent",$R.border="none",$R.outline="none",$R.zIndex=1,$F.addEventListener("input",$t._processInputting),$F.addEventListener("mousemove",$t._stopEvent),$F.addEventListener("mousedown",$t._stopEvent),$F.addEventListener("touchmove",$t._stopEvent),$F.setFontFace=function($R){$F.style.fontFamily=$R;},$u.isConchApp||($F.setColor=function($R){$F.style.color=$R;},$F.setFontSize=function($R){$F.style.fontSize=$R+"px";});},$t._processInputting=function($R){var $F=laya.display.Input.inputElement.target;if($F){var $i=laya.display.Input.inputElement.value;$F._restrictPattern&&($i=$i.replace(/\u2006|\x27/g,""),$F._restrictPattern.test($i)&&($i=$i.replace($F._restrictPattern,""),laya.display.Input.inputElement.value=$i)),$F._text=$i,$F.event("input");}},$t._stopEvent=function($R){"touchmove"==$R.type&&$R.preventDefault(),$R.stopPropagation&&$R.stopPropagation();},$t.TYPE_TEXT="text",$t.TYPE_PASSWORD="password",$t.TYPE_EMAIL="email",$t.TYPE_URL="url",$t.TYPE_NUMBER="number",$t.TYPE_RANGE="range",$t.TYPE_DATE="date",$t.TYPE_MONTH="month",$t.TYPE_WEEK="week",$t.TYPE_TIME="time",$t.TYPE_DATE_TIME="datetime",$t.TYPE_DATE_TIME_LOCAL="datetime-local",$t.TYPE_SEARCH="search",$t.input=null,$t.area=null,$t.inputElement=null,$t.inputContainer=null,$t.confirmButton=null,$t.promptStyleDOM=null,$t.inputHeight=45,$t.isInputting=!1,$t.stageMatrix=null,$N($t,["IOS_IFRAME",function(){return this.IOS_IFRAME=$b.onIOS&&$b.window.top!=$b.window.self;}]),$t;}($aR),$XR=function($R){function $i($R,$F){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,$i.__super.call(this),$R&&this._init_($R,$F);}$x($i,"laya.resource.HTMLImage",$MR);var $F=$i.prototype;return $F._init_=function($R,$F){this._src=$R,this._source=new $b.window.Image(),$F&&($F.onload&&(this.onload=$F.onload),$F.onerror&&(this.onerror=$F.onerror),$F.onCreate&&$F.onCreate(this)),0!=$R.indexOf("data:image")&&(this._source.crossOrigin=""),$R&&(this._source.src=$R);},$F.recreateResource=function(){var $R=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate();}else{this._recreateLock=!0;var $F=this;this._source=new $b.window.Image(),this._source.crossOrigin="",this._source.onload=function(){if($F._needReleaseAgain)return $F._needReleaseAgain=!1,$F._source.onload=null,void($F._source=null);$F._source.onload=null,$F.memorySize=$R._w*$R._h*4,$F._recreateLock=!1,$F.completeCreate();},this._source.src=this._src;}},$F.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0);},$F.onresize=function(){this._w=this._source.width,this._h=this._source.height;},$q(0,$F,"onload",null,function($R){var $F=this;this._onload=$R,this._source&&(this._source.onload=null!=this._onload?function(){$F.onresize(),$F._onload();}:null);}),$q(0,$F,"onerror",null,function($R){var $F=this;this._onerror=$R,this._source&&(this._source.onerror=null!=this._onerror?function(){$F._onerror();}:null);}),$q(0,$F,"enableMerageInAtlas",function(){return this._enableMerageInAtlas;},function($R){this._enableMerageInAtlas=$R,$u.isConchApp&&this._source&&(this._source.enableMerageInAtlas=$R);}),$i.create=function($R,$F){return new $i($R,$F);},$i;}(),$HR=(function($p){function $R(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,$R.__super.call(this);}$x($R,"laya.display.EffectAnimation",$p);var $F=$R.prototype;$F._onOtherBegin=function($R){$R!=this&&this.stop();},$F.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction));},$F._onPlayAction=function(){this.play(0,!1);},$F.play=function($R,$F,$i,$j){void 0===$R&&($R=0),void 0===$F&&($F=!0),void 0===$i&&($i=""),void 0===$j&&($j=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,$R,$F,$i,$j));},$F._recordInitData=function(){if(this._aniKeys){var $R,$F,$i=0;for($R=this._aniKeys.length,$i=0;$i<$R;$i++)$F=this._aniKeys[$i],this._initData[$F]=this._target[$F];}},$F._displayToIndex=function($R){if(this._animationData){$R<0&&($R=0),$R>this._count&&($R=this._count);var $F=this._animationData.nodes,$i=0,$j=$F.length;for($j=1<$j?1:$j,$i=0;$i<$j;$i++)this._displayNodeToFrame($F[$i],$R);}},$F._displayNodeToFrame=function($R,$F,$i){if(this._target){var $j;$j=this._target;var $t,$p,$$,$V,$N=$R.frames,$c=$R.keys,$q=0,$s=$c.length;$V=$R.secondFrames;var $k,$h,$S,$x,$a=0;for($q=0;$q<$s;$q++)$p=$N[$t=$c[$q]],$$=-1==($a=$V[$t])?this._initData[$t]:$F<$a?($S=($h=$R.keyframes[$t])[0]).tween?(null==($k=$W[$S.tweenMethod])&&($k=$W.linearNone),$x=$h[1],$k($F,this._initData[$t],$x.value-this._initData[$t],$x.index)):this._initData[$t]:$p.length>$F?$p[$F]:$p[$p.length-1],$j[$t]=$$;}},$F._calculateNodeKeyFrames=function($R){$p.prototype._calculateNodeKeyFrames.call(this,$R);var $F,$i,$j,$t=$R.keyframes;$R.target;for($F in $j={},$R.secondFrames=$j,$t)($i=$t[$F]).length<=1?$j[$F]=-1:$j[$F]=$i[1].index;},$q(0,$F,"target",function(){return this._target;},function($R){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=$R,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent();}),$q(0,$F,"playEvent",null,function($R){(this._playEvents=$R)&&this.addEvent();}),$q(0,$F,"effectData",null,function($R){var $F;$R&&($F=$R.animations)&&$F[0]&&(this._setUp({},$F[0]),$F[0].nodes&&$F[0].nodes[0]&&(this._aniKeys=$F[0].nodes[0].keys));}),$q(0,$F,"effectClass",null,function($R){var $F,$i;(this._effectClass=$y.getClass($R),this._effectClass)&&($F=this._effectClass.uiView)&&($i=$F.animations)&&$i[0]&&(this._setUp({},$i[0]),$i[0].nodes&&$i[0].nodes[0]&&(this._aniKeys=$i[0].nodes[0].keys));}),$R.EffectAnimationBegin="effectanimationbegin";}($dR),function($F){var $B;function $z(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,$z.__super.call(this);}$x($z,"laya.utils.GraphicAnimation",$F);var $R=$z.prototype;return $R._parseNodeList=function($R){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[$R.compId]=$R.props,$R.compId&&this._nodeList.push($R.compId);var $F=$R.child;if($F){var $i=0,$j=$F.length;for($i=0;$i<$j;$i++)this._parseNodeList($F[$i]);}},$R._calGraphicData=function($R){var $F;if(this._setUp(null,$R),this._createGraphicData(),this._nodeIDAniDic)for($F in this._nodeIDAniDic)this._nodeIDAniDic[$F]=null;},$R._createGraphicData=function(){var $R,$F=[],$i=0,$j=this.count,$t=this._animationNewFrames;for($t||($t=[]),$i=0;$i<$j;$i++)!$t[$i]&&$R||($R=this._createFrameGraphic($i)),$F.push($R);this._gList=$F;},$R._createFrameGraphic=function($R){var $F=$L.createGraphics();return $z._rootMatrix||($z._rootMatrix=new $Y()),this._updateNodeGraphic(this._rootNode,$R,$z._rootMatrix,$F),$F;},$R._updateNodeGraphic=function($R,$F,$i,$j,$t){var $p;void 0===$t&&($t=1);var $$,$V,$N,$c=($p=this._nodeGDic[$R.compId]=this._getNodeGraphicData($R.compId,$F,this._nodeGDic[$R.compId])).alpha*$t;if(!($c<.01)&&($p.resultTransform||($p.resultTransform=$Y.create()),$$=$p.resultTransform,$Y.mul($p.transform,$i,$$),$p.skin&&($V=this._getTextureByUrl($p.skin))&&($$._checkTransform()?($j.drawTexture($V,0,0,$p.width,$p.height,$$,$c),$p.resultTransform=null):$j.drawTexture($V,$$.tx,$$.ty,$p.width,$p.height,null,$c)),$N=$R.child)){var $q,$s=0;for($q=$N.length,$s=0;$s<$q;$s++)this._updateNodeGraphic($N[$s],$F,$$,$j,$c);}},$R._updateNoChilds=function($R,$F){if($R.skin){var $i=this._getTextureByUrl($R.skin);if($i){var $j=$R.transform;$j._checkTransform();!$j.bTransform?$F.drawTexture($i,$j.tx,$j.ty,$R.width,$R.height,null,$R.alpha):$F.drawTexture($i,0,0,$R.width,$R.height,$j.clone(),$R.alpha);}}},$R._updateNodeGraphic2=function($R,$F,$i){var $j;if($j=this._nodeGDic[$R.compId]=this._getNodeGraphicData($R.compId,$F,this._nodeGDic[$R.compId]),$R.child){var $t=$j.transform;$t._checkTransform();var $p,$$;$$=($p=!$t.bTransform)&&(0!=$t.tx||0!=$t.ty);var $V,$N,$c;if(($V=$t.bTransform||1!=$j.alpha)&&$i.save(),1!=$j.alpha&&$i.alpha($j.alpha),$p?$$&&$i.translate($t.tx,$t.ty):$i.transform($t.clone()),$N=$R.child,$j.skin&&($c=this._getTextureByUrl($j.skin))&&$i.drawTexture($c,0,0,$j.width,$j.height),$N){var $q,$s=0;for($q=$N.length,$s=0;$s<$q;$s++)this._updateNodeGraphic2($N[$s],$F,$i);}$V?$i.restore():$p?$$&&$i.translate(-$t.tx,-$t.ty):$i.transform($t.clone().invert());}else this._updateNoChilds($j,$i);},$R._calculateNodeKeyFrames=function($R){$F.prototype._calculateNodeKeyFrames.call(this,$R),this._nodeIDAniDic[$R.target]=$R;},$R.getNodeDataByID=function($R){return this._nodeIDAniDic[$R];},$R._getParams=function($R,$F,$i,$j){var $t=$z._temParam;$t.length=$F.length;var $p=0,$$=$F.length;for($p=0;$p<$$;$p++)$t[$p]=this._getObjVar($R,$F[$p][0],$i,$F[$p][1],$j);return $t;},$R._getObjVar=function($R,$F,$i,$j,$t){if($R.hasOwnProperty($F)){var $p=$R[$F];if($i>=$p.length&&($i=$p.length-1),null!=$R[$F][$i])return $R[$F][$i];}return $t.hasOwnProperty($F)?$t[$F]:$j;},$R._getNodeGraphicData=function($R,$F,$i){$i||($i=$B.create()),$i.transform?$i.transform.identity():$i.transform=$Y.create();var $j=this.getNodeDataByID($R);if(!$j)return $i;var $t,$p,$$=$j.frames,$V=this._getParams($$,$z._drawTextureCmd,$F,this._nodeDefaultProps[$R]),$N=$V[0],$c=NaN,$q=NaN,$s=$V[5],$k=$V[6],$h=$V[13],$S=$V[14],$x=$V[7],$a=$V[8],$m=$V[9],$M=$V[11],$J=$V[12];$c=$V[3],$q=$V[4],0!=$c&&0!=$q||($N=null),-1==$c&&($c=0),-1==$q&&($q=0),$i.skin=$N,$i.width=$c,$i.height=$q,$N&&(($t=this._getTextureByUrl($N))?($c||($c=$t.sourceWidth),$q||($q=$t.sourceHeight)):console.warn("lost skin:",$N,",you may load pics first")),$i.alpha=$V[10],$p=$i.transform,0!=$h&&($s=$h*$c),0!=$S&&($k=$S*$q),0==$s&&0==$k||$p.translate(-$s,-$k);var $d=null;if($m||1!==$x||1!==$a||$M||$J){($d=$z._tempMt).identity(),$d.bTransform=!0;var $w=.0174532922222222*($m-$M),$X=.0174532922222222*($m+$J),$H=Math.cos($X),$_=Math.sin($X),$T=Math.sin($w),$g=Math.cos($w);$d.a=$x*$H,$d.b=$x*$_,$d.c=-$a*$T,$d.d=$a*$g,$d.tx=$d.ty=0;}return $d&&($p=$Y.mul($p,$d,$p)),$p.translate($V[1],$V[2]),$i;},$R._getTextureByUrl=function($R){return $VR.getRes($R);},$R.setAniData=function($R,$F){if($R.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$R,this._parseNodeList($R);var $i,$j={},$t=[],$p=$R.animations,$$=0,$V=$p.length;for($$=0;$$<$V;$$++)if($i=$p[$$],this._labels=null,(!$F||$F==$i.name)&&$i){try{this._calGraphicData($i);}catch($R){console.warn("parse animation fail:"+$i.name+",empty animation created"),this._gList=[];}var $N={};$N.interval=1e3/$i.frameRate,$N.frames=this._gList,$N.labels=this._labels,$N.name=$i.name,$t.push($N),$j[$i.name]=$N;}this.animationList=$t,this.animationDic=$j;}$z._temParam.length=0;},$R.parseByData=function($R){var $F,$i;$F=$R.nodeRoot,$i=$R.aniO,delete $R.nodeRoot,delete $R.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$F,this._parseNodeList($F),this._labels=null;try{this._calGraphicData($i);}catch($R){console.warn("parse animation fail:"+$i.name+",empty animation created"),this._gList=[];}var $j=$R;return $j.interval=1e3/$i.frameRate,$j.frames=this._gList,$j.labels=this._labels,$j.name=$i.name,$j;},$R.setUpAniData=function($R){if($R.animations){var $F,$i={},$j=[],$t=$R.animations,$p=0,$$=$t.length;for($p=0;$p<$$;$p++)if($F=$t[$p]){var $V={};$V.name=$F.name,$V.aniO=$F,$V.nodeRoot=$R,$j.push($V),$i[$F.name]=$V;}this.animationList=$j,this.animationDic=$i;}},$R._clear=function(){var $R,$F;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for($R in this._nodeGDic)($F=this._nodeGDic[$R])&&$F.recover();this._nodeGDic=null;},$z.parseAnimationByData=function($R){var $F;return $z._I||($z._I=new $z()),$F=$z._I.parseByData($R),$z._I._clear(),$F;},$z.parseAnimationData=function($R){var $F;return $z._I||($z._I=new $z()),$z._I.setUpAniData($R),($F={}).animationList=$z._I.animationList,$F.animationDic=$z._I.animationDic,$z._I._clear(),$F;},$z._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],$z._temParam=[],$z._I=null,$z._rootMatrix=null,$N($z,["_tempMt",function(){return this._tempMt=new $Y();}]),$z.__init$=function(){$B=function(){function $R(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1;}return $x($R,""),$R.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),$n.recover("GraphicNode",this);},$R.create=function(){return $n.getItemByClass("GraphicNode",$R);},$R;}();},$z;}($dR));$H.__init([$c,$NR,$u,$b,$r,$g,$R,$HR]);}(window,document,Laya),function($R,$F,$i){$i.un,$i.uns,$i.static;var $j=$i.class;$i.getset,$i.__newvec;new(function(){function $R(){}return $j($R,"LayaMain"),$R;}())();}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($R,$F){"use strict";for(var $i in Object.defineProperty($F,"__esModule",{value:!0}),Laya){var $j=Laya[$i];$j&&$j.__isclass&&($F[$i]=$j);}}),function($R,$F,$X){$X.un,$X.uns;var $$=$X.static,$k=$X.class,$j=$X.getset,$p=$X.__newvec,$q=laya.maths.Arith,$s=laya.maths.Bezier,$i=laya.resource.Bitmap,$h=laya.utils.Browser,$N=laya.utils.Byte,$S=laya.utils.Color,$H=(laya.filters.ColorFilter,$X.Config),$t=laya.resource.Context,$_=(laya.events.Event,laya.filters.Filter),$V=laya.display.Graphics,$c=laya.resource.HTMLCanvas,$x=(laya.utils.HTMLChar,laya.resource.HTMLImage),$a=laya.resource.HTMLSubImage,$T=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),$g=laya.maths.Point,$B=laya.maths.Rectangle,$m=laya.renders.Render,$M=(laya.renders.RenderContext,laya.renders.RenderSprite),$J=laya.resource.Resource,$d=laya.resource.ResourceManager,$w=laya.utils.RunDriver,$z=laya.display.Sprite,$L=laya.display.Stage,$Y=laya.utils.Stat,$f=laya.utils.StringKey,$Z=(laya.display.css.Style,laya.system.System),$u=laya.display.Text,$v=laya.resource.Texture,$K=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),$e=laya.utils.VectorGraphManager;laya.utils.WordText;$X.interface("laya.webgl.shapes.IShape"),$X.interface("laya.webgl.submit.ISubmit"),$X.interface("laya.webgl.text.ICharSegment"),$X.interface("laya.webgl.canvas.save.ISaveData"),$X.interface("laya.webgl.resource.IMergeAtlasBitmap"),$X.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var $Q=function(){function $R(){}$k($R,"laya.filters.webgl.FilterActionGL");var $F=$R.prototype;return $X.imps($F,{"laya.filters.IFilterActionGL":!0}),$F.setValue=function($R){},$F.setValueMix=function($R){},$F.apply3d=function($R,$F,$i,$j,$t){return null;},$F.apply=function($R){return null;},$j(0,$F,"typeMix",function(){return 0;}),$R;}(),$b=function(){function $R(){}return $k($R,"laya.webgl.shader.ShaderValue"),$R;}(),$G=function(){var $j,$t;function $R($R,$F,$i){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new $t(),void 0===$R&&($R=0),void 0===$F&&($F=0),void 0===$i&&($i=0),this._cells=null,this._rowInfo=null,this._init($R,$F),this._atlasID=$i;}$k($R,"laya.webgl.atlas.AtlasGrid");var $F=$R.prototype;return $F.getAltasID=function(){return this._atlasID;},$F.setAltasID=function($R){0<=$R&&(this._atlasID=$R);},$F.addTex=function($R,$F,$i){var $j=this._get($F,$i);return 0==$j.ret||(this._fill($j.x,$j.y,$F,$i,$R),this._texCount++),$j;},$F._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null);},$F._init=function($R,$F){if(this._width=$R,this._height=$F,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=$p(this._height);for(var $i=0;$i<this._height;$i++)this._rowInfo[$i]=new $j();return this._clear(),!0;},$F._get=function($R,$F){var $i=new $y();if($R>=this._failSize.width&&$F>=this._failSize.height)return $i;for(var $j=-1,$t=-1,$p=this._width,$$=this._height,$V=this._cells,$N=0;$N<$$;$N++)if(!(this._rowInfo[$N].spaceCount<$R))for(var $c=0;$c<$p;){var $q=3*($N*$p+$c);if(0!=$V[$q]||$V[1+$q]<$R||$V[2+$q]<$F)$c+=$V[1+$q];else{$j=$c,$t=$N;for(var $s=0;$s<$R;$s++)if($V[3*$s+$q+2]<$F){$j=-1;break;}if(!($j<0))return $i.ret=!0,$i.x=$j,$i.y=$t,$i;$c+=$V[1+$q];}}return $i;},$F._fill=function($R,$F,$i,$j,$t){var $p=this._width,$$=this._height;this._check($R+$i<=$p&&$F+$j<=$$);for(var $V=$F;$V<$j+$F;++$V){this._check(this._rowInfo[$V].spaceCount>=$i),this._rowInfo[$V].spaceCount-=$i;for(var $N=0;$N<$i;$N++){var $c=3*($R+$V*$p+$N);this._check(0==this._cells[$c]),this._cells[$c]=$t,this._cells[1+$c]=$i,this._cells[2+$c]=$j;}}if(0<$R)for($V=0;$V<$j;++$V){var $q=0;for($N=$R-1;0<=$N&&0==this._cells[3*(($F+$V)*$p+$N)];--$N,++$q);for($N=$q;0<$N;--$N)this._cells[3*(($F+$V)*$p+$R-$N)+1]=$N,this._check(0<$N);}if(0<$F)for($N=$R;$N<$R+$i;++$N){for($q=0,$V=$F-1;0<=$V&&0==this._cells[3*($N+$V*$p)];--$V,$q++);for($V=$q;0<$V;--$V)this._cells[3*($N+($F-$V)*$p)+2]=$V,this._check(0<$V);}},$F._check=function($R){0==$R&&console.log("xtexMerger 错误啦");},$F._clear=function(){for(var $R=this._texCount=0;$R<this._height;$R++)this._rowInfo[$R].spaceCount=this._width;for(var $F=0;$F<this._height;$F++)for(var $i=0;$i<this._width;$i++){var $j=3*($F*this._width+$i);this._cells[$j]=0,this._cells[1+$j]=this._width-$i,this._cells[2+$j]=this._width-$F;}this._failSize.width=this._width+1,this._failSize.height=this._height+1;},$R.__init$=function(){$j=function(){function $R(){this.spaceCount=0;}return $k($R,""),$R;}(),$t=function(){function $R(){this.width=0,this.height=0;}return $k($R,""),$R;}();},$R;}(),$O=function(){function $m($R,$F,$i,$j){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=$R,this._height=$F,this._gridSize=$i,this._maxAtlaserCount=$j,this._gridNumX=$R/$i,this._gridNumY=$F/$i,this._curAtlasIndex=0,this._atlaserArray=[];}$k($m,"laya.webgl.atlas.AtlasResourceManager");var $R=$m.prototype;return $R.setAtlasParam=function($R,$F,$i,$j){if(1==this._setAtlasParam)return $m._sid_=0,this._width=$R,this._height=$F,this._gridSize=$i,this._maxAtlaserCount=$j,this._gridNumX=$R/$i,this._gridNumY=$F/$i,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1;},$R.pushData=function($R){var $F,$i=$R.bitmap,$j=-1,$t=null,$p=0,$$=0;for($p=0,$F=this._atlaserArray.length;$p<$F&&($$=(this._curAtlasIndex+$p)%$F,-1==($j=($t=this._atlaserArray[$$]).findBitmapIsExist($i)));$p++);if(-1!=$j){var $V=$t.InAtlasWebGLImagesOffsetValue[$j];return $S=$V[0],$x=$V[1],$t.addToAtlas($R,$S,$x),!0;}this._setAtlasParam=!1;for(var $N=Math.ceil(($R.bitmap.width+2)/this._gridSize),$c=Math.ceil(($R.bitmap.height+2)/this._gridSize),$q=!1,$s=0;$s<2;$s++){var $k=this._maxAtlaserCount;for($p=0;$p<$k;$p++){$$=(this._curAtlasIndex+$p)%$k,this._atlaserArray.length-1>=$$||this._atlaserArray.push(new $BR(this._gridNumX,this._gridNumY,this._width,this._height,$m._sid_++));var $h=this._atlaserArray[$$],$S=0,$x=0,$a=$h.addTex(1,$N,$c);if($a.ret){$S=$a.x*this._gridSize+1,$x=$a.y*this._gridSize+1,$i.lock=!0,$h.addToAtlasTexture($i,$S,$x),$h.addToAtlas($R,$S,$x),$q=!0,this._curAtlasIndex=$$;break;}}if($q)break;this._atlaserArray.push(new $BR(this._gridNumX,this._gridNumY,this._width,this._height,$m._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1;}return $q||console.log(">>>AtlasManager pushData error"),$q;},$R.addToAtlas=function($R){laya.webgl.atlas.AtlasResourceManager.instance.pushData($R);},$R.garbageCollection=function(){if(!0===this._needGC){for(var $R=this._atlaserArray.length-this._maxAtlaserCount,$F=0;$F<$R;$F++)this._atlaserArray[$F].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+$R),this._atlaserArray.splice(0,$R),this._needGC=!1;}return!0;},$R.freeAll=function(){for(var $R=0,$F=this._atlaserArray.length;$R<$F;$R++)this._atlaserArray[$R].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0;},$R.getAtlaserCount=function(){return this._atlaserArray.length;},$R.getAtlaserByIndex=function($R){return this._atlaserArray[$R];},$j(1,$m,"instance",function(){return $m._Instance||($m._Instance=new $m(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),$m._Instance;}),$j(1,$m,"enabled",function(){return $H.atlasEnable;}),$j(1,$m,"atlasLimitWidth",function(){return $m._atlasLimitWidth;},function($R){$m._atlasLimitWidth=$R;}),$j(1,$m,"atlasLimitHeight",function(){return $m._atlasLimitHeight;},function($R){$m._atlasLimitHeight=$R;}),$m._enable=function(){$H.atlasEnable=!0;},$m._disable=function(){$H.atlasEnable=!1;},$m.__init__=function(){$m.atlasTextureWidth=2048,$m.atlasTextureHeight=2048,$m.maxTextureCount=6,$m.atlasLimitWidth=512,$m.atlasLimitHeight=512;},$m._atlasLimitWidth=0,$m._atlasLimitHeight=0,$m.gridSize=16,$m.atlasTextureWidth=0,$m.atlasTextureHeight=0,$m.maxTextureCount=0,$m._atlasRestore=0,$m.BOARDER_TYPE_NO=0,$m.BOARDER_TYPE_RIGHT=1,$m.BOARDER_TYPE_LEFT=2,$m.BOARDER_TYPE_BOTTOM=4,$m.BOARDER_TYPE_TOP=8,$m.BOARDER_TYPE_ALL=15,$m._sid_=0,$m._Instance=null,$m;}(),$y=function(){function $R(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0;}return $k($R,"laya.webgl.atlas.MergeFillInfo"),$R;}(),$E=function(){function $F(){}return $k($F,"laya.webgl.canvas.BlendMode"),$F._init_=function($R){$F.fns=[$F.BlendNormal,$F.BlendAdd,$F.BlendMultiply,$F.BlendScreen,$F.BlendOverlay,$F.BlendLight,$F.BlendMask,$F.BlendDestinationOut],$F.targetFns=[$F.BlendNormalTarget,$F.BlendAddTarget,$F.BlendMultiplyTarget,$F.BlendScreenTarget,$F.BlendOverlayTarget,$F.BlendLightTarget,$F.BlendMask,$F.BlendDestinationOut];},$F.BlendNormal=function($R){$R.blendFunc(1,771);},$F.BlendAdd=function($R){$R.blendFunc(1,772);},$F.BlendMultiply=function($R){$R.blendFunc(774,771);},$F.BlendScreen=function($R){$R.blendFunc(1,1);},$F.BlendOverlay=function($R){$R.blendFunc(1,769);},$F.BlendLight=function($R){$R.blendFunc(1,1);},$F.BlendNormalTarget=function($R){$R.blendFunc(1,771);},$F.BlendAddTarget=function($R){$R.blendFunc(1,772);},$F.BlendMultiplyTarget=function($R){$R.blendFunc(774,771);},$F.BlendScreenTarget=function($R){$R.blendFunc(1,1);},$F.BlendOverlayTarget=function($R){$R.blendFunc(1,769);},$F.BlendLightTarget=function($R){$R.blendFunc(1,1);},$F.BlendMask=function($R){$R.blendFunc(0,770);},$F.BlendDestinationOut=function($R){$R.blendFunc(0,0);},$F.activeBlendFunction=null,$F.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],$F.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},$F.NORMAL="normal",$F.ADD="add",$F.MULTIPLY="multiply",$F.SCREEN="screen",$F.LIGHT="light",$F.OVERLAY="overlay",$F.DESTINATIONOUT="destination-out",$F.fns=[],$F.targetFns=[],$F;}(),$l=function(){function $i($R){this._color=$S.create("black"),this.setValue($R);}$k($i,"laya.webgl.canvas.DrawStyle");var $R=$i.prototype;return $R.setValue=function($R){if($R){if("string"==typeof $R)return void(this._color=$S.create($R));if($R instanceof laya.utils.Color)return void(this._color=$R);}},$R.reset=function(){this._color=$S.create("black");},$R.equal=function($R){return"string"==typeof $R?this._color.strColor===$R:$R instanceof laya.utils.Color&&this._color.numColor===$R.numColor;},$R.toColorStr=function(){return this._color.strColor;},$i.create=function($R){var $F;if($R&&("string"==typeof $R?$F=$S.create($R):$R instanceof laya.utils.Color&&($F=$R),$F))return $F._drawStyle||($F._drawStyle=new $i($R));return laya.webgl.canvas.DrawStyle.DEFAULT;},$$($i,["DEFAULT",function(){return this.DEFAULT=new $i("#000000");}]),$i;}(),$W=function(){function $R(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];$dR.mainContext;this.ib=$IR.create(35048),this.vb=$DR.create(5);}$k($R,"laya.webgl.canvas.Path");var $F=$R.prototype;return $F.addPoint=function($R,$F){this.tempArray.push($R,$F);},$F.getEndPointX=function(){return this.tempArray[this.tempArray.length-2];},$F.getEndPointY=function(){return this.tempArray[this.tempArray.length-1];},$F.polygon=function($R,$F,$i,$j,$t,$p){var $$;return this.geomatrys.push(this._curGeomatry=$$=new $fR($R,$F,$i,$j,$t,$p)),$j||($$.fill=!1),null==$p&&($$.borderWidth=0),$$;},$F.setGeomtry=function($R){this.geomatrys.push(this._curGeomatry=$R);},$F.drawLine=function($R,$F,$i,$j,$t){var $p;return this.closePath?this.geomatrys.push(this._curGeomatry=$p=new $YR($R,$F,$i,$j,$t)):this.geomatrys.push(this._curGeomatry=$p=new $LR($R,$F,$i,$j,$t)),$p.fill=!1,$p;},$F.update=function(){var $R=this.ib._byteLength,$F=this.geomatrys.length;this.offset=$R;for(var $i=this.geoStart;$i<$F;$i++)this.geomatrys[$i].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=$F,this.count=(this.ib._byteLength-$R)/$xR.BYTES_PIDX;},$F.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0;},$F.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null;},$R;}(),$o=function(){function $V(){}$k($V,"laya.webgl.canvas.save.SaveBase");var $R=$V.prototype;return $X.imps($R,{"laya.webgl.canvas.save.ISaveData":!0}),$R.isSaveMark=function(){return!1;},$R.restore=function($R){this._dataObj[this._valueName]=this._value,($V._cache[$V._cache._length++]=this)._newSubmit&&($R._curSubmit=$pR.RENDERBASE,$R._renderKey=0);},$V._createArray=function(){var $R=[];return $R._length=0,$R;},$V._init=function(){var $R=$V._namemap={};return $R[1]="ALPHA",$R[2]="fillStyle",$R[8]="font",$R[256]="lineWidth",$R[512]="strokeStyle",$R[8192]="_mergeID",$R[1024]=$R[2048]=$R[4096]=[],$R[16384]="textBaseline",$R[32768]="textAlign",$R[65536]="_nBlendType",$R[1048576]="shader",$R[2097152]="filters",$R;},$V.save=function($R,$F,$i,$j){if(($R._saveMark._saveuse&$F)!==$F){$R._saveMark._saveuse|=$F;var $t=$V._cache,$p=0<$t._length?$t[--$t._length]:new $V();$p._value=$i[$p._valueName=$V._namemap[$F]],$p._dataObj=$i,$p._newSubmit=$j;var $$=$R._save;$$[$$._length++]=$p;}},$V._cache=laya.webgl.canvas.save.SaveBase._createArray(),$V._namemap=$V._init(),$V;}(),$n=function(){function $p(){this._clipRect=new $B();}$k($p,"laya.webgl.canvas.save.SaveClipRect");var $R=$p.prototype;return $X.imps($R,{"laya.webgl.canvas.save.ISaveData":!0}),$R.isSaveMark=function(){return!1;},$R.restore=function($R){$R._clipRect=this._clipSaveRect,($p._cache[$p._cache._length++]=this)._submitScissor.submitLength=$R._submits._length-this._submitScissor.submitIndex,$R._curSubmit=$pR.RENDERBASE,$R._renderKey=0;},$p.save=function($R,$F){if(131072!=(131072&$R._saveMark._saveuse)){$R._saveMark._saveuse|=131072;var $i=$p._cache,$j=0<$i._length?$i[--$i._length]:new $p();$j._clipSaveRect=$R._clipRect,$R._clipRect=$j._clipRect.copyFrom($R._clipRect),$j._submitScissor=$F;var $t=$R._save;$t[$t._length++]=$j;}},$$($p,["_cache",function(){return this._cache=$o._createArray();}]),$p;}(),$C=function(){function $h(){this._contextX=0,this._contextY=0,this._clipRect=new $B(),this._rect=new $B(),this._matrix=new $T();}$k($h,"laya.webgl.canvas.save.SaveClipRectStencil");var $R=$h.prototype;return $X.imps($R,{"laya.webgl.canvas.save.ISaveData":!0}),$R.isSaveMark=function(){return!1;},$R.restore=function($R){$qR.restore($R,this._rect,this._saveMatrix,this._contextX,this._contextY),$R._clipRect=this._clipSaveRect,$R._curMat=this._saveMatrix,$R._x=this._contextX,$R._y=this._contextY,$h._cache[$h._cache._length++]=this,$R._curSubmit=$pR.RENDERBASE;},$h.save=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){if(262144!=(262144&$R._saveMark._saveuse)){$R._saveMark._saveuse|=262144;var $q=$h._cache,$s=0<$q._length?$q[--$q._length]:new $h();$s._clipSaveRect=$R._clipRect,$s._clipRect.setTo($$,$V,$N,$c),$R._clipRect=$s._clipRect,$s._rect.x=$i,$s._rect.y=$j,$s._rect.width=$t,$s._rect.height=$p,$s._contextX=$R._x,$s._contextY=$R._y,$s._saveMatrix=$R._curMat,$R._curMat.copyTo($s._matrix),$R._curMat=$s._matrix,$s._submitStencil=$F;var $k=$R._save;$k[$k._length++]=$s;}},$$($h,["_cache",function(){return this._cache=$o._createArray();}]),$h;}(),$r=function(){function $j(){this._saveuse=0;}$k($j,"laya.webgl.canvas.save.SaveMark");var $R=$j.prototype;return $X.imps($R,{"laya.webgl.canvas.save.ISaveData":!0}),$R.isSaveMark=function(){return!0;},$R.restore=function($R){$R._saveMark=this._preSaveMark,$j._no[$j._no._length++]=this;},$j.Create=function($R){var $F=$j._no,$i=0<$F._length?$F[--$F._length]:new $j();return $i._saveuse=0,$i._preSaveMark=$R._saveMark,$R._saveMark=$i;},$$($j,["_no",function(){return this._no=$o._createArray();}]),$j;}(),$A=function(){function $p(){this._matrix=new $T();}$k($p,"laya.webgl.canvas.save.SaveTransform");var $R=$p.prototype;return $X.imps($R,{"laya.webgl.canvas.save.ISaveData":!0}),$R.isSaveMark=function(){return!1;},$R.restore=function($R){$R._curMat=this._savematrix,$p._no[$p._no._length++]=this;},$p.save=function($R){var $F=$R._saveMark;if(2048!=(2048&$F._saveuse)){$F._saveuse|=2048;var $i=$p._no,$j=0<$i._length?$i[--$i._length]:new $p();$j._savematrix=$R._curMat,$R._curMat=$R._curMat.copyTo($j._matrix);var $t=$R._save;$t[$t._length++]=$j;}},$$($p,["_no",function(){return this._no=$o._createArray();}]),$p;}(),$P=function(){function $t(){}$k($t,"laya.webgl.canvas.save.SaveTranslate");var $R=$t.prototype;return $X.imps($R,{"laya.webgl.canvas.save.ISaveData":!0}),$R.isSaveMark=function(){return!1;},$R.restore=function($R){$R._curMat;$R._x=this._x,$R._y=this._y,$t._no[$t._no._length++]=this;},$t.save=function($R){var $F=$t._no,$i=0<$F._length?$F[--$F._length]:new $t();$i._x=$R._x,$i._y=$R._y;var $j=$R._save;$j[$j._length++]=$i;},$$($t,["_no",function(){return this._no=$o._createArray();}]),$t;}(),$U=function(){function $R(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new $B();}$k($R,"laya.webgl.resource.RenderTargetMAX");var $F=$R.prototype;return $F.setSP=function($R){this._sp=$R;},$F.size=function($R,$F){var $i=this;this._width!==$R||this._height!==$F?(this.repaint=!0,this._width=$R,this._height=$F,this.target?this.target.size($R,$F):this.target=$eR.create($R,$F),this.target.hasListener("recovered")||this.target.on("recovered",this,function($R){$X.timer.callLater($i._sp,$i._sp.repaint);})):this.target.size($R,$F);},$F._flushToTarget=function($R,$F){if(!$F._destroy){var $i=$MR.worldScissorTest,$j=$MR.worldClipRect;$MR.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,$MR.worldScissorTest=!1,$dR.mainContext.disable(3089);var $t=$MR.worldAlpha,$p=$MR.worldMatrix4,$$=$MR.worldMatrix,$V=$MR.worldFilters,$N=$MR.worldShaderDefines;if($MR.worldMatrix=$T.EMPTY,$MR.restoreTempArray(),$MR.worldMatrix4=$MR.TEMPMAT4_ARRAY,$MR.worldAlpha=1,$MR.worldFilters=null,$MR.worldShaderDefines=null,$KR.activeShader=null,$F.start(),$H.showCanvasMark?$F.clear(0,1,0,.3):$F.clear(0,0,0,0),$R.flush(),$F.end(),$KR.activeShader=null,$MR.worldAlpha=$t,$MR.worldMatrix4=$p,$MR.worldMatrix=$$,$MR.worldFilters=$V,$MR.worldShaderDefines=$N,$MR.worldScissorTest=$i){var $c=$MR.height-$j.y-$j.height;$dR.mainContext.scissor($j.x,$c,$j.width,$j.height),$dR.mainContext.enable(3089);}$MR.worldClipRect=$j;}},$F.flush=function($R){this.repaint&&(this._flushToTarget($R,this.target),this.repaint=!1);},$F.drawTo=function($R,$F,$i,$j,$t){$R.drawTexture(this.target.getTexture(),$F,$i,$j,$t,0,0);},$F.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null);},$R;}(),$I=function(){function $R(){this.ALPHA=1,this.shaderType=0,this.defines=new $zR();}return $k($R,"laya.webgl.shader.d2.Shader2D"),$R.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null;},$R.__init__=function(){var $R,$F;$rR.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),$rR.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),$rR.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),$rR.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),$rR.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),$rR.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),$rR.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),$rR.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),$R="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$F='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$rR.preCompile2D(0,1,$R,$F,null),$R="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",$F='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',$rR.preCompile2D(0,2,$R,$F,null),$R="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",$F="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",$rR.preCompile2D(0,4,$R,$F,null),$R="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$F='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$rR.preCompile2D(0,256,$R,$F,null),$R="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",$F="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",$rR.preCompile2D(0,512,$R,$F,null);},$R;}(),$D=function(){function $F($R,$F,$i){this._value=0,this._name2int=$R,this._int2name=$F,this._int2nameMap=$i;}$k($F,"laya.webgl.shader.ShaderDefines");var $R=$F.prototype;return $R.add=function($R){return"string"==typeof $R&&($R=this._name2int[$R]),this._value|=$R,this._value;},$R.addInt=function($R){return this._value|=$R,this._value;},$R.remove=function($R){return"string"==typeof $R&&($R=this._name2int[$R]),this._value&=~$R,this._value;},$R.isDefine=function($R){return(this._value&$R)===$R;},$R.getValue=function(){return this._value;},$R.setValue=function($R){this._value=$R;},$R.toNameDic=function(){var $R=this._int2nameMap[this._value];return $R||$F._toText(this._value,this._int2name,this._int2nameMap);},$F._reg=function($R,$F,$i,$j){$j[$i[$R]=$F]=$R;},$F._toText=function($R,$F,$i){var $j=$i[$R];if($j)return $j;for(var $t={},$p=1,$$=0;$$<32&&!($R<($p=1<<$$));$$++)if($R&$p){var $V=$F[$p];$V&&($t[$V]="");}return $i[$R]=$t;},$F._toInt=function($R,$F){for(var $i=$R.split("."),$j=0,$t=0,$p=$i.length;$t<$p;$t++){var $$=$F[$i[$t]];if(!$$)throw new Error("Defines to int err:"+$R+"/"+$i[$t]);$j|=$$;}return $j;},$F;}(),$RR=function(){function $$(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new $T();}$k($$,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var $R=$$.prototype;return $R.init=function($R,$F,$i){if($F)this._vs=$F;else{this._vs=[];var $j=$R.width,$t=$R.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push($j,0,1,0,1,1,1,1),this._vs.push($j,$t,1,1,1,1,1,1),this._vs.push(0,$t,0,1,1,1,1,1);}$i?this._ps=$i:($$._defaultPS||($$._defaultPS=[]).push(0,1,3,3,1,2),this._ps=$$._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=$R;},$R.init2=function($R,$F,$i,$j,$t){this.transform&&(this.transform=null),$i?this._ps=$i:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=$j,this._uvs=$t,this.mEleNum=this._ps.length,this.mTexture=$R,($m.isConchNode||$m.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs));},$R._initMyData=function(){var $R=0,$F=0,$i=4*this._verticles.length;this._vs=$$._tempVS;var $j=!1;if($m.isConchNode||$m.isConchApp?(this._vs.length=$i,$j=!0):this._vs.length<$i&&(this._vs.length=$i,$j=!0),$$._tVSLen=$i,$j)for(;$R<$i;)this._vs[$R]=this._verticles[$F],this._vs[$R+1]=this._verticles[$F+1],this._vs[$R+2]=this._uvs[$F],this._vs[$R+3]=this._uvs[$F+1],this._vs[$R+4]=1,this._vs[$R+5]=1,this._vs[$R+6]=1,this._vs[$R+7]=1,$R+=8,$F+=2;else for(;$R<$i;)this._vs[$R]=this._verticles[$F],this._vs[$R+1]=this._verticles[$F+1],this._vs[$R+2]=this._uvs[$F],this._vs[$R+3]=this._uvs[$F+1],$R+=8,$F+=2;},$R.getData2=function($R,$F,$i){var $j;this.mVBBuffer=$R,this.mIBBuffer=$F,this._initMyData(),$R.appendEx2(this._vs,Float32Array,$$._tVSLen,4),this._indexStart=$F._byteLength,($j=$$._tempIB).length<this._ps.length&&($j.length=this._ps.length);for(var $t=0,$p=this._ps.length;$t<$p;$t++)$j[$t]=this._ps[$t]+$i;$F.appendEx2($j,Uint16Array,this._ps.length,2);},$R.getData=function($R,$F,$i){if(this.mVBBuffer=$R,this.mIBBuffer=$F,$R.append(this.mVBData),this._indexStart=$F._byteLength,this.mIBData.start!=$i){for(var $j=0,$t=this._ps.length;$j<$t;$j++)this.mIBData[$j]=this._ps[$j]+$i;this.mIBData.start=$i;}$F.append(this.mIBData);},$R.render=function($R,$F,$i){if($m.isWebGL&&this.mTexture){$R._renderKey=0,$R._shader2D.glTexture=null,$FR.getInstance().addSkinMesh(this);var $j=$pR.createShape($R,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,$_R.create(512,0));this.transform||(this.transform=$T.EMPTY),this.transform.translate($F,$i),$T.mul(this.transform,$R._curMat,this._tempMatrix),this.transform.translate(-$F,-$i);var $t=$j.shaderValue,$p=$t.u_mmat2||$MR.getMatrArray();$MR.mat2MatArray(this._tempMatrix,$p),$t.textureHost=this.mTexture,$t.offsetX=0,$t.offsetY=0,$t.u_mmat2=$p,$t.ALPHA=$R._shader2D.ALPHA,$R._submits[$R._submits._length++]=$j;}else $m.isConchApp&&this.mTexture&&(this.transform||(this.transform=$T.EMPTY),$R.setSkinMesh&&$R.setSkinMesh($F,$i,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform));},$$._tempVS=[],$$._tempIB=[],$$._defaultPS=null,$$._tVSLen=0,$$;}(),$FR=function(){function $R(){this.ib=null,this.vb=null;$dR.mainContext;this.ib=$IR.create(35048),this.vb=$DR.create(8);}$k($R,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var $F=$R.prototype;return $F.addSkinMesh=function($R){$R.getData2(this.vb,this.ib,this.vb._byteLength/32);},$F.reset=function(){this.vb.clear(),this.ib.clear();},$R.getInstance=function(){return $R.instance=$R.instance||new $R();},$R.instance=null,$R;}(),$iR=function(){function $R($R,$F,$i,$j,$t,$p,$$,$V,$N){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===$N&&($N=0),this.x=$R,this.y=$F,this.width=$i,this.height=$j,this.edges=$t,this.color=$p,this.borderWidth=$$,this.borderColor=$V;}$k($R,"laya.webgl.shapes.BasePoly");var $F=$R.prototype;return $X.imps($F,{"laya.webgl.shapes.IShape":!0}),$F.getData=function($R,$F,$i){},$F.rebuild=function($R){},$F.setMatrix=function($R){},$F.needUpdate=function($R){return!0;},$F.sector=function($R,$F,$i){var $j=this.x,$t=this.y,$p=this.edges,$$=(this.r1-this.r0)/$p,$V=this.width,$N=this.height,$c=this.color,$q=($c>>16&255)/255,$s=($c>>8&255)/255,$k=(255&$c)/255;$R.push($j,$t,$q,$s,$k);for(var $h=0;$h<$p+1;$h++)$R.push($j+Math.sin($$*$h+this.r0)*$V,$t+Math.cos($$*$h+this.r0)*$N),$R.push($q,$s,$k);for($h=0;$h<$p;$h++)$F.push($i,$i+$h+1,$i+$h+2);},$F.createLine2=function($R,$F,$i,$j,$t,$p){var $$,$V,$N,$c,$q,$s,$k,$h,$S,$x,$a,$m,$M,$J,$d,$w,$X,$H,$_,$T,$g=$R.concat(),$B=$t,$z=this.borderColor,$L=($z>>16&255)/255,$Y=($z>>8&255)/255,$f=(255&$z)/255,$Z=$g.length/2,$u=$j,$v=$i/2;$N=$g[0],$c=$g[1],$x=$N-($q=$g[2]),$S=($S=-($c-($s=$g[3])))/($T=Math.sqrt($S*$S+$x*$x))*$v,$x=$x/$T*$v,$B.push($N-$S+this.x,$c-$x+this.y,$L,$Y,$f,$N+$S+this.x,$c+$x+this.y,$L,$Y,$f);for(var $K=1;$K<$Z-1;$K++)$N=$g[2*($K-1)],$c=$g[2*($K-1)+1],$q=$g[2*$K],$s=$g[2*$K+1],$k=$g[2*($K+1)],$h=$g[2*($K+1)+1],$x=$N-$q,$m=$q-$k,$d=(-($S=($S=-($c-$s))/($T=Math.sqrt($S*$S+$x*$x))*$v)+$N)*(-($x=$x/$T*$v)+$s)-(-$S+$q)*(-$x+$c),$H=(-($a=($a=-($s-$h))/($T=Math.sqrt($a*$a+$m*$m))*$v)+$k)*(-($m=$m/$T*$v)+$s)-(-$a+$q)*(-$m+$h),$_=($M=-$x+$c-(-$x+$s))*($X=-$a+$q-(-$a+$k))-($w=-$m+$h-(-$m+$s))*($J=-$S+$q-(-$S+$N)),Math.abs($_)<.1?($_+=10.1,$B.push($q-$S+this.x,$s-$x+this.y,$L,$Y,$f,$q+$S+this.x,$s+$x+this.y,$L,$Y,$f)):((($$=($J*$H-$X*$d)/$_)-$q)*($$-$q)+(($V=($w*$d-$M*$H)/$_)-$s)+($V-$s),$B.push($$+this.x,$V+this.y,$L,$Y,$f,$q-($$-$q)+this.x,$s-($V-$s)+this.y,$L,$Y,$f));$N=$g[$g.length-4],$c=$g[$g.length-3],$x=$N-($q=$g[$g.length-2]),$S=($S=-($c-($s=$g[$g.length-1])))/($T=Math.sqrt($S*$S+$x*$x))*$v,$x=$x/$T*$v,$B.push($q-$S+this.x,$s-$x+this.y,$L,$Y,$f,$q+$S+this.x,$s+$x+this.y,$L,$Y,$f);var $e=$p;for($K=1;$K<$e;$K++)$F.push($u+2*($K-1),$u+2*($K-1)+1,$u+2*$K+1,$u+2*$K+1,$u+2*$K,$u+2*($K-1));return $B;},$F.createLine=function($R,$F,$i,$j){var $t=$R.concat(),$p=$R,$$=this.borderColor,$V=($$>>16&255)/255,$N=($$>>8&255)/255,$c=(255&$$)/255;$t.splice(0,5);var $q,$s,$k,$h,$S,$x,$a,$m,$M,$J,$d,$w,$X,$H,$_,$T,$g,$B,$z,$L,$Y=$t.length/5,$f=$j,$Z=$i/2;$k=$t[0],$h=$t[1],$J=$k-($S=$t[5]),$M=($M=-($h-($x=$t[6])))/($L=Math.sqrt($M*$M+$J*$J))*$Z,$J=$J/$L*$Z,$p.push($k-$M,$h-$J,$V,$N,$c,$k+$M,$h+$J,$V,$N,$c);for(var $u=1;$u<$Y-1;$u++)$k=$t[5*($u-1)],$h=$t[5*($u-1)+1],$S=$t[5*$u],$x=$t[5*$u+1],$a=$t[5*($u+1)],$m=$t[5*($u+1)+1],$J=$k-$S,$w=$S-$a,$_=(-($M=($M=-($h-$x))/($L=Math.sqrt($M*$M+$J*$J))*$Z)+$k)*(-($J=$J/$L*$Z)+$x)-(-$M+$S)*(-$J+$h),$B=(-($d=($d=-($x-$m))/($L=Math.sqrt($d*$d+$w*$w))*$Z)+$a)*(-($w=$w/$L*$Z)+$x)-(-$d+$S)*(-$w+$m),$z=($X=-$J+$h-(-$J+$x))*($g=-$d+$S-(-$d+$a))-($T=-$w+$m-(-$w+$x))*($H=-$M+$S-(-$M+$k)),Math.abs($z)<.1?($z+=10.1,$p.push($S-$M,$x-$J,$V,$N,$c,$S+$M,$x+$J,$V,$N,$c)):((($q=($H*$B-$g*$_)/$z)-$S)*($q-$S)+(($s=($T*$_-$X*$B)/$z)-$x)+($s-$x),$p.push($q,$s,$V,$N,$c,$S-($q-$S),$x-($s-$x),$V,$N,$c));$k=$t[$t.length-10],$h=$t[$t.length-9],$J=$k-($S=$t[$t.length-5]),$M=($M=-($h-($x=$t[$t.length-4])))/($L=Math.sqrt($M*$M+$J*$J))*$Z,$J=$J/$L*$Z,$p.push($S-$M,$x-$J,$V,$N,$c,$S+$M,$x+$J,$V,$N,$c);var $v=this.edges+1;for($u=1;$u<$v;$u++)$F.push($f+2*($u-1),$f+2*($u-1)+1,$f+2*$u+1,$f+2*$u+1,$f+2*$u,$f+2*($u-1));return $p;},$F.createLoopLine=function($R,$F,$i,$j,$t,$p){var $$=$R.concat(),$V=$t||$R,$N=this.borderColor,$c=($N>>16&255)/255,$q=($N>>8&255)/255,$s=(255&$N)/255;$$.splice(0,5);var $k=[$$[0],$$[1]],$h=[$$[$$.length-5],$$[$$.length-4]],$S=$h[0]+.5*($k[0]-$h[0]),$x=$h[1]+.5*($k[1]-$h[1]);$$.unshift($S,$x,0,0,0),$$.push($S,$x,0,0,0);var $a,$m,$M,$J,$d,$w,$X,$H,$_,$T,$g,$B,$z,$L,$Y,$f,$Z,$u,$v,$K,$e=$$.length/5,$Q=$j,$b=$i/2;$M=$$[0],$J=$$[1],$T=$M-($d=$$[5]),$_=($_=-($J-($w=$$[6])))/($K=Math.sqrt($_*$_+$T*$T))*$b,$T=$T/$K*$b,$V.push($M-$_,$J-$T,$c,$q,$s,$M+$_,$J+$T,$c,$q,$s);for(var $G=1;$G<$e-1;$G++)$M=$$[5*($G-1)],$J=$$[5*($G-1)+1],$d=$$[5*$G],$w=$$[5*$G+1],$X=$$[5*($G+1)],$H=$$[5*($G+1)+1],$T=$M-$d,$B=$d-$X,$Y=(-($_=($_=-($J-$w))/($K=Math.sqrt($_*$_+$T*$T))*$b)+$M)*(-($T=$T/$K*$b)+$w)-(-$_+$d)*(-$T+$J),$u=(-($g=($g=-($w-$H))/($K=Math.sqrt($g*$g+$B*$B))*$b)+$X)*(-($B=$B/$K*$b)+$w)-(-$g+$d)*(-$B+$H),$v=($z=-$T+$J-(-$T+$w))*($Z=-$g+$d-(-$g+$X))-($f=-$B+$H-(-$B+$w))*($L=-$_+$d-(-$_+$M)),Math.abs($v)<.1?($v+=10.1,$V.push($d-$_,$w-$T,$c,$q,$s,$d+$_,$w+$T,$c,$q,$s)):((($a=($L*$u-$Z*$Y)/$v)-$d)*($a-$d)+(($m=($f*$Y-$z*$u)/$v)-$w)+($m-$w),$V.push($a,$m,$c,$q,$s,$d-($a-$d),$w-($m-$w),$c,$q,$s));$p&&($F=$p);var $O=this.edges+1;for($G=1;$G<$O;$G++)$F.push($Q+2*($G-1),$Q+2*($G-1)+1,$Q+2*$G+1,$Q+2*$G+1,$Q+2*$G,$Q+2*($G-1));return $F.push($Q+2*($G-1),$Q+2*($G-1)+1,$Q+1,$Q+1,$Q,$Q+2*($G-1)),$V;},$R;}(),$jR=function(){function $x(){}return $k($x,"laya.webgl.shapes.Earcut"),$x.earcut=function($R,$F,$i){$i=$i||2;var $j,$t,$p,$$,$V,$N,$c,$q=$F&&$F.length,$s=$q?$F[0]*$i:$R.length,$k=$x.linkedList($R,0,$s,$i,!0),$h=[];if(!$k)return $h;if($q&&($k=$x.eliminateHoles($R,$F,$k,$i)),$R.length>80*$i){$j=$p=$R[0],$t=$$=$R[1];for(var $S=$i;$S<$s;$S+=$i)($V=$R[$S])<$j&&($j=$V),($N=$R[$S+1])<$t&&($t=$N),$p<$V&&($p=$V),$$<$N&&($$=$N);$c=0!==($c=Math.max($p-$j,$$-$t))?1/$c:0;}return $x.earcutLinked($k,$h,$i,$j,$t,$c),$h;},$x.linkedList=function($R,$F,$i,$j,$t){var $p,$$;if($t===0<$x.signedArea($R,$F,$i,$j))for($p=$F;$p<$i;$p+=$j)$$=$x.insertNode($p,$R[$p],$R[$p+1],$$);else for($p=$i-$j;$F<=$p;$p-=$j)$$=$x.insertNode($p,$R[$p],$R[$p+1],$$);return $$&&$x.equals($$,$$.next)&&($x.removeNode($$),$$=$$.next),$$;},$x.filterPoints=function($R,$F){if(!$R)return $R;$F||($F=$R);var $i,$j=$R;do{if($i=!1,$j.steiner||!$x.equals($j,$j.next)&&0!==$x.area($j.prev,$j,$j.next))$j=$j.next;else{if($x.removeNode($j),($j=$F=$j.prev)===$j.next)break;$i=!0;}}while($i||$j!==$F);return $F;},$x.earcutLinked=function($R,$F,$i,$j,$t,$p,$$){if($R){!$$&&$p&&$x.indexCurve($R,$j,$t,$p);for(var $V,$N,$c=$R;$R.prev!==$R.next;)if($V=$R.prev,$N=$R.next,$p?$x.isEarHashed($R,$j,$t,$p):$x.isEar($R))$F.push($V.i/$i),$F.push($R.i/$i),$F.push($N.i/$i),$x.removeNode($R),$R=$N.next,$c=$N.next;else if(($R=$N)===$c){$$?1===$$?($R=$x.cureLocalIntersections($R,$F,$i),$x.earcutLinked($R,$F,$i,$j,$t,$p,2)):2===$$&&$x.splitEarcut($R,$F,$i,$j,$t,$p):$x.earcutLinked($x.filterPoints($R,null),$F,$i,$j,$t,$p,1);break;}}},$x.isEar=function($R){var $F=$R.prev,$i=$R,$j=$R.next;if(0<=$x.area($F,$i,$j))return!1;for(var $t=$R.next.next;$t!==$R.prev;){if($x.pointInTriangle($F.x,$F.y,$i.x,$i.y,$j.x,$j.y,$t.x,$t.y)&&0<=$x.area($t.prev,$t,$t.next))return!1;$t=$t.next;}return!0;},$x.isEarHashed=function($R,$F,$i,$j){var $t=$R.prev,$p=$R,$$=$R.next;if(0<=$x.area($t,$p,$$))return!1;for(var $V=$t.x<$p.x?$t.x<$$.x?$t.x:$$.x:$p.x<$$.x?$p.x:$$.x,$N=$t.y<$p.y?$t.y<$$.y?$t.y:$$.y:$p.y<$$.y?$p.y:$$.y,$c=$t.x>$p.x?$t.x>$$.x?$t.x:$$.x:$p.x>$$.x?$p.x:$$.x,$q=$t.y>$p.y?$t.y>$$.y?$t.y:$$.y:$p.y>$$.y?$p.y:$$.y,$s=$x.zOrder($V,$N,$F,$i,$j),$k=$x.zOrder($c,$q,$F,$i,$j),$h=$R.nextZ;$h&&$h.z<=$k;){if($h!==$R.prev&&$h!==$R.next&&$x.pointInTriangle($t.x,$t.y,$p.x,$p.y,$$.x,$$.y,$h.x,$h.y)&&0<=$x.area($h.prev,$h,$h.next))return!1;$h=$h.nextZ;}for($h=$R.prevZ;$h&&$h.z>=$s;){if($h!==$R.prev&&$h!==$R.next&&$x.pointInTriangle($t.x,$t.y,$p.x,$p.y,$$.x,$$.y,$h.x,$h.y)&&0<=$x.area($h.prev,$h,$h.next))return!1;$h=$h.prevZ;}return!0;},$x.cureLocalIntersections=function($R,$F,$i){var $j=$R;do{var $t=$j.prev,$p=$j.next.next;!$x.equals($t,$p)&&$x.intersects($t,$j,$j.next,$p)&&$x.locallyInside($t,$p)&&$x.locallyInside($p,$t)&&($F.push($t.i/$i),$F.push($j.i/$i),$F.push($p.i/$i),$x.removeNode($j),$x.removeNode($j.next),$j=$R=$p),$j=$j.next;}while($j!==$R);return $j;},$x.splitEarcut=function($R,$F,$i,$j,$t,$p){var $$=$R;do{for(var $V=$$.next.next;$V!==$$.prev;){if($$.i!==$V.i&&$x.isValidDiagonal($$,$V)){var $N=$x.splitPolygon($$,$V);return $$=$x.filterPoints($$,$$.next),$N=$x.filterPoints($N,$N.next),$x.earcutLinked($$,$F,$i,$j,$t,$p),void $x.earcutLinked($N,$F,$i,$j,$t,$p);}$V=$V.next;}$$=$$.next;}while($$!==$R);},$x.eliminateHoles=function($R,$F,$i,$j){var $t,$p,$$,$V,$N,$c=[];for($t=0,$p=$F.length;$t<$p;$t++)$$=$F[$t]*$j,$V=$t<$p-1?$F[$t+1]*$j:$R.length,($N=$x.linkedList($R,$$,$V,$j,!1))===$N.next&&($N.steiner=!0),$c.push($x.getLeftmost($N));for($c.sort($x.compareX),$t=0;$t<$c.length;$t++)$x.eliminateHole($c[$t],$i),$i=$x.filterPoints($i,$i.next);return $i;},$x.compareX=function($R,$F){return $R.x-$F.x;},$x.eliminateHole=function($R,$F){if($F=$x.findHoleBridge($R,$F)){var $i=$x.splitPolygon($F,$R);$x.filterPoints($i,$i.next);}},$x.findHoleBridge=function($R,$F){var $i,$j=$F,$t=$R.x,$p=$R.y,$$=-1/0;do{if($p<=$j.y&&$p>=$j.next.y&&$j.next.y!==$j.y){var $V=$j.x+($p-$j.y)*($j.next.x-$j.x)/($j.next.y-$j.y);if($V<=$t&&$$<$V){if(($$=$V)===$t){if($p===$j.y)return $j;if($p===$j.next.y)return $j.next;}$i=$j.x<$j.next.x?$j:$j.next;}}$j=$j.next;}while($j!==$F);if(!$i)return null;if($t===$$)return $i.prev;var $N,$c=$i,$q=$i.x,$s=$i.y,$k=1/0;for($j=$i.next;$j!==$c;)$t>=$j.x&&$j.x>=$q&&$t!==$j.x&&$x.pointInTriangle($p<$s?$t:$$,$p,$q,$s,$p<$s?$$:$t,$p,$j.x,$j.y)&&(($N=Math.abs($p-$j.y)/($t-$j.x))<$k||$N===$k&&$j.x>$i.x)&&$x.locallyInside($j,$R)&&($i=$j,$k=$N),$j=$j.next;return $i;},$x.indexCurve=function($R,$F,$i,$j){for(var $t=$R;null===$t.z&&($t.z=$x.zOrder($t.x,$t.y,$F,$i,$j)),$t.prevZ=$t.prev,$t.nextZ=$t.next,($t=$t.next)!==$R;);$t.prevZ.nextZ=null,$t.prevZ=null,$x.sortLinked($t);},$x.sortLinked=function($R){var $F,$i,$j,$t,$p,$$,$V,$N,$c=1;do{for($i=$R,$p=$R=null,$$=0;$i;){for($$++,$j=$i,$F=$V=0;$F<$c&&($V++,$j=$j.nextZ);$F++);for($N=$c;0<$V||0<$N&&$j;)0!==$V&&(0===$N||!$j||$i.z<=$j.z)?($i=($t=$i).nextZ,$V--):($j=($t=$j).nextZ,$N--),$p?$p.nextZ=$t:$R=$t,$t.prevZ=$p,$p=$t;$i=$j;}$p.nextZ=null,$c*=2;}while(1<$$);return $R;},$x.zOrder=function($R,$F,$i,$j,$t){return($R=1431655765&(($R=858993459&(($R=252645135&(($R=16711935&(($R=32767*($R-$i)*$t)|$R<<8))|$R<<4))|$R<<2))|$R<<1))|($F=1431655765&(($F=858993459&(($F=252645135&(($F=16711935&(($F=32767*($F-$j)*$t)|$F<<8))|$F<<4))|$F<<2))|$F<<1))<<1;},$x.getLeftmost=function($R){for(var $F=$R,$i=$R;$F.x<$i.x&&($i=$F),($F=$F.next)!==$R;);return $i;},$x.pointInTriangle=function($R,$F,$i,$j,$t,$p,$$,$V){return 0<=($t-$$)*($F-$V)-($R-$$)*($p-$V)&&0<=($R-$$)*($j-$V)-($i-$$)*($F-$V)&&0<=($i-$$)*($p-$V)-($t-$$)*($j-$V);},$x.isValidDiagonal=function($R,$F){return $R.next.i!==$F.i&&$R.prev.i!==$F.i&&!$x.intersectsPolygon($R,$F)&&$x.locallyInside($R,$F)&&$x.locallyInside($F,$R)&&$x.middleInside($R,$F);},$x.area=function($R,$F,$i){return($F.y-$R.y)*($i.x-$F.x)-($F.x-$R.x)*($i.y-$F.y);},$x.equals=function($R,$F){return $R.x===$F.x&&$R.y===$F.y;},$x.intersects=function($R,$F,$i,$j){return!!($x.equals($R,$F)&&$x.equals($i,$j)||$x.equals($R,$j)&&$x.equals($i,$F))||0<$x.area($R,$F,$i)!=0<$x.area($R,$F,$j)&&0<$x.area($i,$j,$R)!=0<$x.area($i,$j,$F);},$x.intersectsPolygon=function($R,$F){var $i=$R;do{if($i.i!==$R.i&&$i.next.i!==$R.i&&$i.i!==$F.i&&$i.next.i!==$F.i&&$x.intersects($i,$i.next,$R,$F))return!0;$i=$i.next;}while($i!==$R);return!1;},$x.locallyInside=function($R,$F){return $x.area($R.prev,$R,$R.next)<0?0<=$x.area($R,$F,$R.next)&&0<=$x.area($R,$R.prev,$F):$x.area($R,$F,$R.prev)<0||$x.area($R,$R.next,$F)<0;},$x.middleInside=function($R,$F){for(var $i=$R,$j=!1,$t=($R.x+$F.x)/2,$p=($R.y+$F.y)/2;$i.y>$p!=$i.next.y>$p&&$i.next.y!==$i.y&&$t<($i.next.x-$i.x)*($p-$i.y)/($i.next.y-$i.y)+$i.x&&($j=!$j),($i=$i.next)!==$R;);return $j;},$x.splitPolygon=function($R,$F){var $i=new $tR($R.i,$R.x,$R.y),$j=new $tR($F.i,$F.x,$F.y),$t=$R.next,$p=$F.prev;return($R.next=$F).prev=$R,($i.next=$t).prev=$i,($j.next=$i).prev=$j,($p.next=$j).prev=$p,$j;},$x.insertNode=function($R,$F,$i,$j){var $t=new $tR($R,$F,$i);return $j?($t.next=$j.next,($t.prev=$j).next.prev=$t,$j.next=$t):($t.prev=$t).next=$t,$t;},$x.removeNode=function($R){$R.next.prev=$R.prev,$R.prev.next=$R.next,$R.prevZ&&($R.prevZ.nextZ=$R.nextZ),$R.nextZ&&($R.nextZ.prevZ=$R.prevZ);},$x.signedArea=function($R,$F,$i,$j){for(var $t=0,$p=$F,$$=$i-$j;$p<$i;$p+=$j)$t+=($R[$$]-$R[$p])*($R[$p+1]+$R[$$+1]),$$=$p;return $t;},$x;}(),$tR=function(){function $R($R,$F,$i){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=$R,this.x=$F,this.y=$i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1;}return $k($R,"laya.webgl.shapes.EarcutNode"),$R;}(),$pR=(function(){function $R($R,$F,$i,$j,$t,$p,$$){this.lineWidth=$R,this.lineColor=$F,this.lineAlpha=$i,this.fillColor=$j,this.fillAlpha=$t,this.shape=$$,this.fill=$p;}$k($R,"laya.webgl.shapes.GeometryData");var $F=$R.prototype;$F.clone=function(){return new $R(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape);},$F.getIndexData=function(){return null;},$F.getVertexData=function(){return null;},$F.destroy=function(){this.shape=null;};}(),function(){function $R($R){if($R instanceof Float32Array)this.points=$R;else if($R instanceof Array){$R.length;this.points=new Float32Array($R);}}$k($R,"laya.webgl.shapes.Vertex");var $F=$R.prototype;$X.imps($F,{"laya.webgl.shapes.IShape":!0}),$F.getData=function($R,$F,$i){},$F.needUpdate=function($R){return!1;},$F.rebuild=function($R){},$F.setMatrix=function($R){};}(),function(){function $N($R){void 0===$R&&($R=1e4),this._renderType=$R;}$k($N,"laya.webgl.submit.Submit");var $R=$N.prototype;return $X.imps($R,{"laya.webgl.submit.ISubmit":!0}),$R.releaseRender=function(){var $R=$N._cache;($R[$R._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null;},$R.getRenderType=function(){return this._renderType;},$R.renderSubmit=function(){if(0===this._numEle)return 1;var $R=this.shaderValue.textureHost;if($R){var $F=$R.source;if(!$R.bitmap||!$F)return 1;this.shaderValue.texture=$F,$R.alphaTexture&&$R.alphaTexture.source&&(this.shaderValue.texture1=$R.alphaTexture.source);}this._vb.bind_upload(this._ib);var $i=$dR.mainContext;return this.shaderValue.upload(),$E.activeBlendFunction!==this._blendFn&&($i.enable(3042),this._blendFn($i),$E.activeBlendFunction=this._blendFn),$Y.drawCall++,$Y.trianglesFaces+=this._numEle/3,$i.drawElements(4,this._numEle,5123,this._startIdx),1;},$N.__init__=function(){var $R=$N.RENDERBASE=new $N(-1);$R.shaderValue=new $_R(0,0),$R.shaderValue.ALPHA=-1234;},$N.createSubmit=function($R,$F,$i,$j,$t){var $p=$N._cache._length?$N._cache[--$N._cache._length]:new $N();null==$i&&(($i=$p._selfVb||($p._selfVb=$DR.create(-1))).clear(),$j=0),$p._ib=$F,$p._vb=$i,$p._startIdx=$j*$xR.BYTES_PIDX,$p._numEle=0;var $$=$R._nBlendType;$p._blendFn=$R._targets?$E.targetFns[$$]:$E.fns[$$],$p.shaderValue=$t,$p.shaderValue.setValue($R._shader2D);var $V=$R._shader2D.filters;return $V&&$p.shaderValue.setFilters($V),$p;},$N.createShape=function($R,$F,$i,$j,$t,$p){var $$=$N._cache._length?$N._cache[--$N._cache._length]:new $N();$$._ib=$F,$$._vb=$i,$$._numEle=$j,$$._startIdx=$t,$$.shaderValue=$p,$$.shaderValue.setValue($R._shader2D);var $V=$R._nBlendType;return $$._blendFn=$R._targets?$E.targetFns[$V]:$E.fns[$V],$$;},$N.TYPE_2D=1e4,$N.TYPE_CANVAS=10003,$N.TYPE_CMDSETRT=10004,$N.TYPE_CUSTOM=10005,$N.TYPE_BLURRT=10006,$N.TYPE_CMDDESTORYPRERT=10007,$N.TYPE_DISABLESTENCIL=10008,$N.TYPE_OTHERIBVB=10009,$N.TYPE_PRIMITIVE=10010,$N.TYPE_RT=10011,$N.TYPE_BLUR_RT=10012,$N.TYPE_TARGET=10013,$N.TYPE_CHANGE_VALUE=10014,$N.TYPE_SHAPE=10015,$N.TYPE_TEXTURE=10016,$N.TYPE_FILLTEXTURE=10017,$N.RENDERBASE=null,$N._cache=(($N._cache=[])._length=0,$N._cache),$N;}()),$$R=function(){function $j(){this.fun=null,this.args=null;}$k($j,"laya.webgl.submit.SubmitCMD");var $R=$j.prototype;return $X.imps($R,{"laya.webgl.submit.ISubmit":!0}),$R.renderSubmit=function(){return this.fun.apply(null,this.args),1;},$R.getRenderType=function(){return 0;},$R.releaseRender=function(){var $R=$j._cache;$R[$R._length++]=this;},$j.create=function($R,$F){var $i=$j._cache._length?$j._cache[--$j._cache._length]:new $j();return $i.fun=$F,$i.args=$R,$i;},$j._cache=(($j._cache=[])._length=0,$j._cache),$j;}(),$VR=function(){function $F(){this.variables={};}$k($F,"laya.webgl.submit.SubmitCMDScope");var $R=$F.prototype;return $R.getValue=function($R){return this.variables[$R];},$R.addValue=function($R,$F){return this.variables[$R]=$F;},$R.setValue=function($R,$F){return this.variables.hasOwnProperty($R)?this.variables[$R]=$F:null;},$R.clear=function(){for(var $R in this.variables)delete this.variables[$R];},$R.recycle=function(){this.clear(),$F.POOL.push(this);},$F.create=function(){var $R=$F.POOL.pop();return $R||($R=new $F()),$R;},$F.POOL=[],$F;}(),$NR=function(){function $s(){this.offset=0,this.startIndex=0,this._mat=$T.create();}$k($s,"laya.webgl.submit.SubmitOtherIBVB");var $R=$s.prototype;return $X.imps($R,{"laya.webgl.submit.ISubmit":!0}),$R.releaseRender=function(){var $R=$s._cache;($R[$R._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null;},$R.getRenderType=function(){return 10009;},$R.renderSubmit=function(){var $R=this._shaderValue.textureHost;if($R){var $F=$R.source;if(!$R.bitmap||!$F)return 1;this._shaderValue.texture=$F;}this._vb.bind_upload(this._ib);var $i=$MR.worldMatrix4,$j=$T.TEMP;$T.mulPre(this._mat,$i[0],$i[1],$i[4],$i[5],$i[12],$i[13],$j);var $t=$MR.worldMatrix4=$s.tempMatrix4;$t[0]=$j.a,$t[1]=$j.b,$t[4]=$j.c,$t[5]=$j.d,$t[12]=$j.tx,$t[13]=$j.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var $p=$dR.mainContext;return $E.activeBlendFunction!==this._blendFn&&($p.enable(3042),this._blendFn($p),$E.activeBlendFunction=this._blendFn),$Y.drawCall++,$Y.trianglesFaces+=this._numEle/3,$p.drawElements(4,this._numEle,5123,this.startIndex),$MR.worldMatrix4=$i,$KR.activeShader=null,1;},$s.create=function($R,$F,$i,$j,$t,$p,$$,$V,$N){void 0===$N&&($N=0);var $c=$s._cache._length?$s._cache[--$s._cache._length]:new $s();$c._ib=$i,$c._vb=$F,$c._numEle=$j,$c._shader=$t,$c._shaderValue=$p;var $q=$R._nBlendType;switch($c._blendFn=$R._targets?$E.targetFns[$q]:$E.fns[$q],$N){case 0:$c.offset=0,$c.startIndex=$V/($xR.BYTES_PE*$F.vertexStride)*1.5,$c.startIndex*=$xR.BYTES_PIDX;break;case 1:$c.startIndex=$$,$c.offset=$V;}return $c;},$s._cache=(($s._cache=[])._length=0,$s._cache),$s.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$s;}(),$cR=function(){function $i(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new $B(),this.screenRect=new $B();}$k($i,"laya.webgl.submit.SubmitScissor");var $R=$i.prototype;return $X.imps($R,{"laya.webgl.submit.ISubmit":!0}),$R._scissor=function($R,$F,$i,$j){var $t=$MR.worldMatrix4,$p=$t[0],$$=$t[5],$V=$t[12],$N=$t[13];if($j*=$$,($i*=$p)<1||$j<1)return!1;var $c=($R=$R*$p+$V)+$i,$q=($F=$F*$$+$N)+$j;$R<0&&($i=$c-($R=0)),$F<0&&($j=$q-($F=0));var $s=$MR.worldClipRect;if($R=Math.max($R,$s.x),$F=Math.max($F,$s.y),$i=Math.min($c,$s.right)-$R,$j=Math.min($q,$s.bottom)-$F,$i<1||$j<1)return!1;var $k=$MR.worldScissorTest;return this.screenRect.copyFrom($s),$s.x=$R,$s.y=$F,$s.width=$i,$s.height=$j,$MR.worldScissorTest=!0,$F=$MR.height-$F-$j,$dR.mainContext.scissor($R,$F,$i,$j),$dR.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$k?($F=$MR.height-this.screenRect.y-this.screenRect.height,$dR.mainContext.scissor(this.screenRect.x,$F,this.screenRect.width,this.screenRect.height),$dR.mainContext.enable(3089)):($dR.mainContext.disable(3089),$MR.worldScissorTest=!1),$s.copyFrom(this.screenRect),!0;},$R._scissorWithTagart=function($R,$F,$i,$j){if($i<1||$j<1)return!1;var $t=$R+$i,$p=$F+$j;$R<0&&($i=$t-($R=0)),$F<0&&($j=$p-($F=0));var $$=$MR.worldClipRect;if($R=Math.max($R,$$.x),$F=Math.max($F,$$.y),$i=Math.min($t,$$.right)-$R,$j=Math.min($p,$$.bottom)-$F,$i<1||$j<1)return!1;var $V=$MR.worldScissorTest;return this.screenRect.copyFrom($$),$MR.worldScissorTest=!0,$$.x=$R,$$.y=$F,$$.width=$i,$$.height=$j,$F=$MR.height-$F-$j,$dR.mainContext.scissor($R,$F,$i,$j),$dR.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$V?($F=$MR.height-this.screenRect.y-this.screenRect.height,$dR.mainContext.scissor(this.screenRect.x,$F,this.screenRect.width,this.screenRect.height),$dR.mainContext.enable(3089)):($dR.mainContext.disable(3089),$MR.worldScissorTest=!1),$$.copyFrom(this.screenRect),!0;},$R.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1;},$R.getRenderType=function(){return 0;},$R.releaseRender=function(){var $R=$i._cache;($R[$R._length++]=this).context=null;},$i.create=function($R){var $F=$i._cache._length?$i._cache[--$i._cache._length]:new $i();return $F.context=$R,$F;},$i._cache=(($i._cache=[])._length=0,$i._cache),$i;}(),$qR=function(){function $N(){this.step=0,this.blendMode=null,this.level=0;}$k($N,"laya.webgl.submit.SubmitStencil");var $R=$N.prototype;return $X.imps($R,{"laya.webgl.submit.ISubmit":!0}),$R.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8();}return 1;},$R.getRenderType=function(){return 0;},$R.releaseRender=function(){var $R=$N._cache;$R[$R._length++]=this;},$R.do1=function(){var $R=$dR.mainContext;$R.enable(2960),$R.clear(1024),$R.colorMask(!1,!1,!1,!1),$R.stencilFunc(514,this.level,255),$R.stencilOp(7680,7680,7682);},$R.do2=function(){var $R=$dR.mainContext;$R.stencilFunc(514,this.level+1,255),$R.colorMask(!0,!0,!0,!0),$R.stencilOp(7680,7680,7680);},$R.do3=function(){var $R=$dR.mainContext;$R.colorMask(!0,!0,!0,!0),$R.stencilOp(7680,7680,7680),$R.clear(1024),$R.disable(2960);},$R.do4=function(){var $R=$dR.mainContext;0==this.level&&($R.enable(2960),$R.clear(1024)),$R.colorMask(!1,!1,!1,!1),$R.stencilFunc(519,0,255),$R.stencilOp(7680,7680,7682);},$R.do5=function(){var $R=$dR.mainContext;$R.stencilFunc(514,this.level,255),$R.colorMask(!0,!0,!0,!0),$R.stencilOp(7680,7680,7680);},$R.do6=function(){var $R=$dR.mainContext;$E.targetFns[$E.TOINT[this.blendMode]]($R);},$R.do7=function(){var $R=$dR.mainContext;$R.colorMask(!1,!1,!1,!1),$R.stencilOp(7680,7680,7683);},$R.do8=function(){var $R=$dR.mainContext;$R.colorMask(!0,!0,!0,!0),$R.stencilFunc(514,this.level,255),$R.stencilOp(7680,7680,7680);},$N.restore=function($R,$F,$i,$j,$t){var $p;if(($R._renderKey=0)<$N._mask&&$N._mask--,0==$N._mask)$p=laya.webgl.submit.SubmitStencil.create(3),$R.addRenderObject($p),$R._curSubmit=$pR.RENDERBASE;else{$p=laya.webgl.submit.SubmitStencil.create(7),$R.addRenderObject($p);var $$=$R._vb;$$._byteLength;if($aR.fillRectImgVb($$,null,$F.x,$F.y,$F.width,$F.height,$v.DEF_UV,$i,$j,$t,0,0)){$R._shader2D.glTexture=null;var $V=$R._curSubmit=$pR.createSubmit($R,$R._ib,$$,($$._byteLength-64)/32*3,$_R.create(2,0));$V.shaderValue.ALPHA=1,$R._submits[$R._submits._length++]=$V,$R._curSubmit._numEle+=6,$R._curSubmit=$pR.RENDERBASE;}else alert("clipRect calc stencil rect error");$p=laya.webgl.submit.SubmitStencil.create(8),$R.addRenderObject($p);}},$N.restore2=function($R,$F){var $i;($R._renderKey=0)<$N._mask&&$N._mask--,0==$N._mask?($i=laya.webgl.submit.SubmitStencil.create(3),$R.addRenderObject($i),$R._curSubmit=$pR.RENDERBASE):($i=laya.webgl.submit.SubmitStencil.create(7),$R.addRenderObject($i),$R._submits[$R._submits._length++]=$F,$i=laya.webgl.submit.SubmitStencil.create(8),$R.addRenderObject($i));},$N.create=function($R){var $F=$N._cache._length?$N._cache[--$N._cache._length]:new $N();return 5==($F.step=$R)&&++$N._mask,$F.level=$N._mask,$F;},$N._cache=(($N._cache=[])._length=0,$N._cache),$N._mask=0,$N;}(),$sR=function(){function $V(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null;}$k($V,"laya.webgl.submit.SubmitTarget");var $R=$V.prototype;return $X.imps($R,{"laya.webgl.submit.ISubmit":!0}),$R.renderSubmit=function(){this._vb.bind_upload(this._ib);var $R=this.scope.getValue(this.proName);return $R&&(this.shaderValue.texture=$R.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[$R.width,$R.height]),this.shaderValue.upload(),this.blend(),$Y.drawCall++,$Y.trianglesFaces+=this._numEle/3,$dR.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1;},$R.blend=function(){if($E.activeBlendFunction!==$E.fns[this.blendType]){var $R=$dR.mainContext;$R.enable(3042),$E.fns[this.blendType]($R),$E.activeBlendFunction=$E.fns[this.blendType];}},$R.getRenderType=function(){return 0;},$R.releaseRender=function(){var $R=$V._cache;($R[$R._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null;},$V.create=function($R,$F,$i,$j,$t,$p){var $$=$V._cache._length?$V._cache[--$V._cache._length]:new $V();return $$._ib=$F,$$._vb=$i,$$.proName=$p,$$._startIdx=$j*$xR.BYTES_PIDX,$$._numEle=0,$$.blendType=$R._nBlendType,$$.shaderValue=$t,$$.shaderValue.setValue($R._shader2D),$$;},$V._cache=(($V._cache=[])._length=0,$V._cache),$V;}(),$kR=function(){function $R(){this._sourceStr=null;}$k($R,"laya.webgl.text.CharSegment");var $F=$R.prototype;return $X.imps($F,{"laya.webgl.text.ICharSegment":!0}),$F.textToSpit=function($R){this._sourceStr=$R;},$F.getChar=function($R){return this._sourceStr.charAt($R);},$F.getCharCode=function($R){return this._sourceStr.charCodeAt($R);},$F.length=function(){return this._sourceStr.length;},$R;}(),$hR=function(){var $R;function $Y(){}return $k($Y,"laya.webgl.text.DrawText"),$Y.__init__=function(){$Y._charsTemp=new Array(),$Y._drawValue=new $R(),$Y._charSeg=new $kR();},$Y.customCharSeg=function($R){$Y._charSeg=$R;},$Y.getChar=function($R,$F,$i){var $j=$oR.createOneChar($R,$i);return-1!=$F&&($Y._charsCache[$F]=$j),$j;},$Y._drawSlow=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$s,$k,$h,$S){var $x,$a,$m=$Y._drawValue.value($p,$V,$N,$c,$k,$h,$S),$M=0,$J=0,$d=$Y._charsTemp,$w=0,$X=NaN;if($j)for($d.length=$j.length,$M=0,$J=$j.length;$M<$J;$M++)($a=$j[$M])&&($X=$a.charNum+$m.txtID,$d[$M]=$x=$Y._charsCache[$X]||$Y.getChar($a.char,$X,$m),$x.active());else{var $H=$i instanceof laya.utils.WordText?$i.toString():$i;if($u.CharacterCache){$Y._charSeg.textToSpit($H);var $_=$Y._charSeg.length();for($M=0,$J=$d.length=$_;$M<$J;$M++)$X=$Y._charSeg.getCharCode($M)+$m.txtID,$d[$M]=$x=$Y._charsCache[$X]||$Y.getChar($Y._charSeg.getChar($M),$X,$m),$x.active(),$w+=$x.cw;}else $d.length=0,($x=$Y.getChar($H,-1,$m)).active(),$w+=$x.cw,$d[0]=$x;}var $T=0;null!==$$&&"left"!==$$&&($T=-("center"==$$?$w/2:$w));var $g,$B,$z=NaN,$L=0;if($j)for($M=0,$J=$d.length;$M<$J;$M++)$x=$d[$M],$a=$j[$M],$x&&$a&&!$x.isSpace&&($z=$x.borderSize,$g=$x.texture,$F._drawText($g,$q+$T+$a.x*$k-$z,$s+$a.y*$h-$z,$g.width,$g.height,$t,0,0,0,0));else{for($M=0,$J=$d.length;$M<$J;$M++)($x=$d[$M])&&!$x.isSpace&&($z=$x.borderSize,$g=$x.texture,$F._drawText($g,$q+$T-$z,$s-$z,$g.width,$g.height,$t,0,0,0,0),$R&&(($B=$R[$L++])||($B=$R[$L-1]=[]),$B[0]=$g,$B[1]=$T-$z,$B[2]=-$z)),$T+=$x.cw;$R&&($R.length=$L);}},$Y._drawFast=function($R,$F,$i,$j,$t){for(var $p,$$,$V=0,$N=$R.length;$V<$N;$V++)($p=($$=$R[$V])[0]).active(),$F._drawText($p,$j+$$[1],$t+$$[2],$p.width,$p.height,$i,0,0,0,0);},$Y.drawText=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$s){if(void 0===$s&&($s=0),!($F&&0===$F.length||$i&&0===$i.length)){var $k=$j.a,$h=$j.d;(0!==$j.b||0!==$j.c)&&($k=$h=1);var $S=1!==$k||1!==$h;if($S&&$X.stage.transform){var $x=$X.stage.transform;$S=$x.a===$k&&$x.d===$h;}else $S=!1;if($S){var $a=($j=$j.copyTo($HR._tmpMatrix)).tx,$m=$j.ty;$j.scale(1/$k,1/$h),$j._checkTransform(),$c*=$k,$q*=$h,$c+=$a-$j.tx,$q+=$m-$j.ty;}else $k=$h=1;if($i)$Y._drawSlow(null,$R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$k,$h,$s);else{if(null===$F.toUpperCase){var $M=$k+1e5*$h,$J=$F;return void($J.changed||$J.id!==$M?($J.id=$M,$J.changed=!1,$Y._drawSlow($J.save,$R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$k,$h,$s)):$Y._drawFast($J.save,$R,$j,$c,$q));}var $d=$F+$t.toString()+$$+$V+$N+$k+$h+$p,$w=$Y._textsCache[$d];$u.CharacterCache?$w?$Y._drawFast($w,$R,$j,$c,$q):($Y._textsCache.__length||($Y._textsCache.__length=0),$Y._textsCache.__length>$H.WebGLTextCacheCount&&(($Y._textsCache={}).__length=0,$Y._curPoolIndex=0),$Y._textCachesPool[$Y._curPoolIndex]?($w=$Y._textsCache[$d]=$Y._textCachesPool[$Y._curPoolIndex]).length=0:$Y._textCachesPool[$Y._curPoolIndex]=$w=$Y._textsCache[$d]=[],$Y._textsCache.__length++,$Y._curPoolIndex++,$Y._drawSlow($w,$R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$k,$h,$s)):$Y._drawSlow($w,$R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$k,$h,$s);}}},$Y._charsTemp=null,$Y._textCachesPool=[],$Y._curPoolIndex=0,$Y._charsCache={},$Y._textsCache={},$Y._drawValue=null,$Y.d=[],$Y._charSeg=null,$Y.__init$=function(){$R=function(){function $N(){}return $k($N,""),$N.prototype.value=function($R,$F,$i,$j,$t,$p,$$){this.font=$R,this.fillColor=$F,this.borderColor=$i,this.lineWidth=$j,this.scaleX=$t,this.scaleY=$p,this.underLine=$$;var $V=$R.toString()+$t+$p+$j+($F?$F.toLowerCase():" ")+($i?$i.toLowerCase():" ")+$$;return this.txtID=$N._keymap[$V],this.txtID||(this.txtID=1e-7*++$N._keymapCount,$N._keymap[$V]=this.txtID),this;},$N.clear=function(){$N._keymap={},$N._keymapCount=1;},$N._keymap={},$N._keymapCount=1,$N;}();},$Y;}(),$SR=function(){function $t($R){this._index=0,this._size=14,this._italic=-2,$t._cache2=$t._cache2||[],this.setFont($R||"14px Arial");}$k($t,"laya.webgl.text.FontInContext");var $R=$t.prototype;return $R.setFont=function($R){var $F=$t._cache2[$R];if($F)this._words=$F[0],this._size=$F[1];else{this._words=$R.split(" ");for(var $i=0,$j=this._words.length;$i<$j;$i++)if(0<this._words[$i].indexOf("px")){this._index=$i;break;}this._size=parseInt(this._words[this._index]),$t._cache2[$R]=[this._words,this._size];}this._text=null,this._italic=-2;},$R.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic;},$R.hasType=function($R){for(var $F=0,$i=this._words.length;$F<$i;$F++)if(this._words[$F]===$R)return $F;return-1;},$R.removeType=function($R){for(var $F=0,$i=this._words.length;$F<$i;$F++)if(this._words[$F]===$R){this._words.splice($F,1),this._index>$F&&this._index--;break;}this._text=null,this._italic=-2;},$R.copyTo=function($R){return $R._text=this._text,$R._size=this._size,$R._index=this._index,$R._words=this._words.slice(),$R._italic=-2,$R;},$R.toString=function(){return this._text?this._text:this._text=this._words.join(" ");},$j(0,$R,"size",function(){return this._size;},function($R){this._size=$R,this._words[this._index]=$R+"px",this._text=null;}),$t.create=function($R){var $F=$t._cache[$R];return $F||($F=$t._cache[$R]=new $t($R));},$t.EMPTY=new $t(),$t._cache={},$t._cache2=null,$t;}(),$xR=function(){function $R(){}return $k($R,"laya.webgl.utils.CONST3D2D"),$R.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$R.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],$R.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],$R._TMPARRAY=[],$R._OFFSETX=0,$R._OFFSETY=0,$$($R,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT;},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT;}]),$R;}(),$aR=function(){function $S(){}return $k($S,"laya.webgl.utils.GlUtils"),$S.make2DProjection=function($R,$F,$i){return[2/$R,0,0,0,0,-2/$F,0,0,0,0,2/$i,0,-1,1,0,1];},$S.fillIBQuadrangle=function($R,$F){if(65535/4<$F)throw Error("IBQuadrangle count:"+$F+" must<:"+Math.floor(65535/4));$F=Math.floor($F),$R._resizeBuffer(6*($F+1)*2,!1),$R.byteLength=$R.bufferLength;for(var $i=$R.getUint16Array(),$j=0,$t=0;$t<$F;$t++)$i[$j++]=4*$t,$i[$j++]=4*$t+2,$i[$j++]=4*$t+1,$i[$j++]=4*$t,$i[$j++]=4*$t+3,$i[$j++]=4*$t+2;return $R.setNeedUpload(),!0;},$S.expandIBQuadrangle=function($R,$F){$R.bufferLength>=6*$F*2||$S.fillIBQuadrangle($R,$F);},$S.mathCeilPowerOfTwo=function($R){return $R--,$R|=$R>>1,$R|=$R>>2,$R|=$R>>4,$R|=$R>>8,$R|=$R>>16,++$R;},$S.fillQuadrangleImgVb=function($R,$F,$i,$j,$t,$p,$$,$V){var $N=16+($R._byteLength>>2);$R.byteLength=$N<<2;var $c=$R.getFloat32Array();$c[($N-=16)+2]=$t[0],$c[$N+3]=$t[1],$c[$N+6]=$t[2],$c[$N+7]=$t[3],$c[$N+10]=$t[4],$c[$N+11]=$t[5],$c[$N+14]=$t[6],$c[$N+15]=$t[7];var $q=$p.a,$s=$p.b,$k=$p.c,$h=$p.d;if(1!==$q||0!==$s||0!==$k||1!==$h){$p.bTransform=!0;var $S=$p.tx+$$,$x=$p.ty+$V;$c[$N]=($j[0]+$F)*$q+($j[1]+$i)*$k+$S,$c[$N+1]=($j[0]+$F)*$s+($j[1]+$i)*$h+$x,$c[$N+4]=($j[2]+$F)*$q+($j[3]+$i)*$k+$S,$c[$N+5]=($j[2]+$F)*$s+($j[3]+$i)*$h+$x,$c[$N+8]=($j[4]+$F)*$q+($j[5]+$i)*$k+$S,$c[$N+9]=($j[4]+$F)*$s+($j[5]+$i)*$h+$x,$c[$N+12]=($j[6]+$F)*$q+($j[7]+$i)*$k+$S,$c[$N+13]=($j[6]+$F)*$s+($j[7]+$i)*$h+$x;}else $p.bTransform=!1,$F+=$p.tx+$$,$i+=$p.ty+$V,$c[$N]=$F+$j[0],$c[$N+1]=$i+$j[1],$c[$N+4]=$F+$j[2],$c[$N+5]=$i+$j[3],$c[$N+8]=$F+$j[4],$c[$N+9]=$i+$j[5],$c[$N+12]=$F+$j[6],$c[$N+13]=$i+$j[7];return $R._upload=!0;},$S.fillTranglesVB=function($R,$F,$i,$j,$t,$p,$$){var $V=($R._byteLength>>2)+$j.length;$R.byteLength=$V<<2;var $N=$R.getFloat32Array();$V-=$j.length;for(var $c=$j.length,$q=$t.a,$s=$t.b,$k=$t.c,$h=$t.d,$S=0;$S<$c;$S+=4)if($N[$V+$S+2]=$j[$S+2],$N[$V+$S+3]=$j[$S+3],1!==$q||0!==$s||0!==$k||1!==$h){$t.bTransform=!0;var $x=$t.tx+$p,$a=$t.ty+$$;$N[$V+$S]=($j[$S]+$F)*$q+($j[$S+1]+$i)*$k+$x,$N[$V+$S+1]=($j[$S]+$F)*$s+($j[$S+1]+$i)*$h+$a;}else $t.bTransform=!1,$F+=$t.tx+$p,$i+=$t.ty+$$,$N[$V+$S]=$F+$j[$S],$N[$V+$S+1]=$i+$j[$S+1];return $R._upload=!0;},$S.copyPreImgVb=function($R,$F,$i){var $j=$R._byteLength>>2;$R.byteLength=$j+16<<2;for(var $t=$R.getFloat32Array(),$p=0,$$=$j-16;$p<4;$p++)$t[$j]=$t[$$]+$F,++$$,$t[++$j]=$t[$$]+$i,++$$,$t[++$j]=$t[$$],++$$,$t[++$j]=$t[$$],++$j,++$$;$R._upload=!0;},$S.fillRectImgVb=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$s,$k){void 0===$k&&($k=!1);var $h,$S,$x,$a,$m,$M,$J,$d,$w,$X,$H,$_,$T,$g,$B,$z,$L=1,$Y=$V.a,$f=$V.b,$Z=$V.c,$u=$V.d,$v=$F&&$F.width<99999999;if(1!==$Y||0!==$f||0!==$Z||1!==$u?($V.bTransform=!0,0===$f&&0===$Z&&($L=23,$w=$t+$i,$X=$p+$j,$h=$Y*$i+($H=$V.tx+$N),$x=$Y*$w+$H,$S=$u*$j+($_=$V.ty+$c),$a=$u*$X+$_)):($L=23,$V.bTransform=!1,$x=($h=$i+$V.tx+$N)+$t,$a=($S=$j+$V.ty+$c)+$p),$v&&($m=$F.x,$M=$F.y,$J=$F.width+$m,$d=$F.height+$M),1!==$L){if(Math.min($h,$x)>=$J)return!1;if(Math.min($S,$a)>=$d)return!1;if(Math.max($x,$h)<=$m)return!1;if(Math.max($a,$S)<=$M)return!1;}var $K=$R._byteLength>>2;$R.byteLength=16+$K<<2;var $e=$R.getFloat32Array();switch($e[2+$K]=$$[0],$e[3+$K]=$$[1],$e[6+$K]=$$[2],$e[7+$K]=$$[3],$e[10+$K]=$$[4],$e[11+$K]=$$[5],$e[14+$K]=$$[6],$e[15+$K]=$$[7],$L){case 1:$H=$V.tx+$N,$_=$V.ty+$c;var $Q=$Y*$i,$b=$Z*$j,$G=$u*$j,$O=$f*$i,$y=$Y*($w=$t+$i),$E=$Z*($X=$p+$j),$l=$u*$X,$W=$f*$w;$k?($T=$Q+$b+$H,$B=Math.round($T)-$T,$g=$G+$O+$_,$z=Math.round($g)-$g,$e[$K]=$T+$B,$e[1+$K]=$g+$z,$e[4+$K]=$y+$b+$H+$B,$e[5+$K]=$G+$W+$_+$z,$e[8+$K]=$y+$E+$H+$B,$e[9+$K]=$l+$W+$_+$z,$e[12+$K]=$Q+$E+$H+$B,$e[13+$K]=$l+$O+$_+$z):($e[$K]=$Q+$b+$H,$e[1+$K]=$G+$O+$_,$e[4+$K]=$y+$b+$H,$e[5+$K]=$G+$W+$_,$e[8+$K]=$y+$E+$H,$e[9+$K]=$l+$W+$_,$e[12+$K]=$Q+$E+$H,$e[13+$K]=$l+$O+$_);break;case 23:$k?($T=$h+$q,$B=Math.round($T)-$T,$g=$S,$z=Math.round($g)-$g,$e[$K]=$T+$B,$e[1+$K]=$g+$z,$e[4+$K]=$x+$q+$B,$e[5+$K]=$S+$z,$e[8+$K]=$x+$B,$e[9+$K]=$a+$z,$e[12+$K]=$h+$B,$e[13+$K]=$a+$z):($e[$K]=$h+$q,$e[1+$K]=$S,$e[4+$K]=$x+$q,$e[5+$K]=$S,$e[8+$K]=$x,$e[9+$K]=$a,$e[12+$K]=$h,$e[13+$K]=$a);}return $R._upload=!0;},$S.fillLineVb=function($R,$F,$i,$j,$t,$p,$$,$V){var $N=.5*$$,$c=$S._fillLineArray,$q=-($j-$p),$s=$i-$t,$k=Math.sqrt($q*$q+$s*$s);$q/=$k,$s/=$k,$q*=$N,$s*=$N,$c[0]=$i-$q,$c[1]=$j-$s,$c[4]=$i+$q,$c[5]=$j+$s,$c[8]=$t+$q,$c[9]=$p+$s,$c[12]=$t-$q,$c[13]=$p-$s,$V&&$V.transformPointArray($c,$c);var $h=16+($R._byteLength>>2);return $R.byteLength=$h<<2,$R.insertData($c,$h-16),!0;},$S._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$S;}(),$mR=(function(){function $N(){}$k($N,"laya.webgl.utils.MatirxArray"),$N.ArrayMul=function($R,$F,$i){if($R){if($F)for(var $j=NaN,$t=NaN,$p=NaN,$$=NaN,$V=0;$V<4;$V++)$j=$R[$V],$t=$R[$V+4],$p=$R[$V+8],$$=$R[$V+12],$i[$V]=$j*$F[0]+$t*$F[1]+$p*$F[2]+$$*$F[3],$i[$V+4]=$j*$F[4]+$t*$F[5]+$p*$F[6]+$$*$F[7],$i[$V+8]=$j*$F[8]+$t*$F[9]+$p*$F[10]+$$*$F[11],$i[$V+12]=$j*$F[12]+$t*$F[13]+$p*$F[14]+$$*$F[15];else $N.copyArray($R,$i);}else $N.copyArray($F,$i);},$N.copyArray=function($R,$F){if($R&&$F)for(var $i=0;$i<$R.length;$i++)$F[$i]=$R[$i];};}(),function(){function $F($R,$F,$i){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=$R,this._vb=new $DR($R,35048),$F&&this._vb._resizeBuffer($F,!1),this._ib=new $IR(),$i&&this._ib._resizeBuffer($i,!1);}$k($F,"laya.webgl.utils.Mesh2D");var $R=$F.prototype;return $R.cloneWithNewVB=function(){var $R=new $F(this._stride,0,0);return $R._ib=this._ib,$R._quadNum=this._quadNum,$R._attribInfo=this._attribInfo,$R;},$R.cloneWithNewVBIB=function(){var $R=new $F(this._stride,0,0);return $R._attribInfo=this._attribInfo,$R;},$R.getVBW=function(){return this._vb.setNeedUpload(),this._vb;},$R.getVBR=function(){return this._vb;},$R.getIBR=function(){return this._ib;},$R.getIBW=function(){return this._ib.setNeedUpload(),this._ib;},$R.createQuadIB=function($R){this._quadNum=$R,this._ib._resizeBuffer(6*$R*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var $F=this._ib.getUint16Array(),$i=0,$j=0,$t=0;$t<$R;$t++)$F[$i++]=$j,$F[$i++]=$j+2,$F[$i++]=$j+1,$F[$i++]=$j,$F[$i++]=$j+3,$F[$i++]=$j+2,$j+=4;this._ib.setNeedUpload();},$R.setAttributes=function($R){if(this._attribInfo=$R,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!";},$R.getEleNum=function(){return this._ib.getBuffer().byteLength/2;},$R.releaseMesh=function(){},$R.destroy=function(){},$R.clearVB=function(){this._vb.clear();},$F._gvaoid=0,$F;}()),$MR=function(){function $t(){}return $k($t,"laya.webgl.utils.RenderState2D"),$t.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];},$t.mat2MatArray=function($R,$F){var $i=$R,$j=$F;return $j[0]=$i.a,$j[1]=$i.b,$j[2]=$t.EMPTYMAT4_ARRAY[2],$j[3]=$t.EMPTYMAT4_ARRAY[3],$j[4]=$i.c,$j[5]=$i.d,$j[6]=$t.EMPTYMAT4_ARRAY[6],$j[7]=$t.EMPTYMAT4_ARRAY[7],$j[8]=$t.EMPTYMAT4_ARRAY[8],$j[9]=$t.EMPTYMAT4_ARRAY[9],$j[10]=$t.EMPTYMAT4_ARRAY[10],$j[11]=$t.EMPTYMAT4_ARRAY[11],$j[12]=$i.tx,$j[13]=$i.ty,$j[14]=$t.EMPTYMAT4_ARRAY[14],$j[15]=$t.EMPTYMAT4_ARRAY[15],$F;},$t.restoreTempArray=function(){$t.TEMPMAT4_ARRAY[0]=1,$t.TEMPMAT4_ARRAY[1]=0,$t.TEMPMAT4_ARRAY[4]=0,$t.TEMPMAT4_ARRAY[5]=1,$t.TEMPMAT4_ARRAY[12]=0,$t.TEMPMAT4_ARRAY[13]=0;},$t.clear=function(){$t.worldScissorTest=!1,$t.worldShaderDefines=null,$t.worldFilters=null,$t.worldAlpha=1,$t.worldClipRect.x=$t.worldClipRect.y=0,$t.worldClipRect.width=$t.width,$t.worldClipRect.height=$t.height,$t.curRenderTarget=null;},$t._MAXSIZE=99999999,$t.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$t.worldMatrix4=$t.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$t.worldAlpha=1,$t.worldScissorTest=!1,$t.worldFilters=null,$t.worldShaderDefines=null,$t.curRenderTarget=null,$t.width=0,$t.height=0,$$($t,["worldMatrix",function(){return this.worldMatrix=new $T();},"worldClipRect",function(){return this.worldClipRect=new $B(0,0,99999999,99999999);}]),$t;}(),$JR=function(){var $M,$i;function $J($R,$F,$i,$j,$t){var $p=this;function $$($R){var $F=[],$i=new $M($F);return $p._compileToTree($i,$R.split("\n"),0,$F,$t),$i;}var $V=$h.now();this._VS=$$($F),this._PS=$$($i),this._nameMap=$j,2<$h.now()-$V&&console.log("ShaderCompile use time:"+($h.now()-$V)+"  size:"+$F.length+"/"+$i.length);}$k($J,"laya.webgl.utils.ShaderCompile");var $R=$J.prototype;return $R._compileToTree=function($R,$F,$i,$j,$t){var $p,$$,$V,$N,$c,$q,$s,$k=0,$h=0,$S=0,$x=0;for($h=$i;$h<$F.length;$h++)if(!(($V=$F[$h]).length<1)&&0!==($k=$V.indexOf("//"))){if(0<=$k&&($V=$V.substr(0,$k)),$p=$s||new $M($j),$s=null,$p.text=$V,$p.noCompile=!0,0<=($k=$V.indexOf("#"))){for($N="#",$x=$k+1,$S=$V.length;$x<$S;$x++){var $a=$V.charAt($x);if(" "===$a||"\t"===$a||"\r"===$a||"\n"===$a||"?"===$a)break;$N+=$a;}switch($p.name=$N){case"#ifdef":case"#ifndef":if($p.src=$V,$p.noCompile=null!=$V.match(/[!&|()=<>]/),$p.noCompile?console.log("function():Boolean{return "+$V.substr($k+$p.name.length)+"}"):($q=$V.replace(/^\s*/,"").split(/\s+/),$p.setCondition($q[1],"#ifdef"===$N?1:2),$p.text="//"+$p.text),$p.setParent($R),$R=$p,$t)for($q=$V.substr($x).split($J._splitToWordExps3),$x=0;$x<$q.length;$x++)($V=$q[$x]).length&&($t[$V]=!0);continue;case"#if":if($p.src=$V,$p.noCompile=!0,$p.setParent($R),$R=$p,$t)for($q=$V.substr($x).split($J._splitToWordExps3),$x=0;$x<$q.length;$x++)($V=$q[$x]).length&&"defined"!=$V&&($t[$V]=!0);continue;case"#else":$p.src=$V,$$=($R=$R.parent).childs[$R.childs.length-1],$p.noCompile=$$.noCompile,$p.noCompile||($p.condition=$$.condition,$p.conditionType=1==$$.conditionType?2:1,$p.text="//"+$p.text+" "+$$.text+" "+$p.conditionType),$p.setParent($R),$R=$p;continue;case"#endif":$$=($R=$R.parent).childs[$R.childs.length-1],$p.noCompile=$$.noCompile,$p.noCompile||($p.text="//"+$p.text),$p.setParent($R);continue;case"#include":$q=$J.splitToWords($V,null);var $m=$J.includes[$q[1]];if(!$m)throw"ShaderCompile error no this include file:"+$q[1];if(($k=$q[0].indexOf("?"))<0){$p.setParent($R),$V=$m.getWith("with"==$q[2]?$q[3]:null),this._compileToTree($p,$V.split("\n"),0,$j,$t),$p.text="";continue;}$p.setCondition($q[0].substr($k+1),1),$p.text=$m.getWith("with"==$q[2]?$q[3]:null);break;case"#import":$c=($q=$J.splitToWords($V,null))[1],$j.push({node:$p,file:$J.includes[$c],ofs:$p.text.length});continue;}}else{if(($$=$R.childs[$R.childs.length-1])&&!$$.name){0<$j.length&&$J.splitToWords($V,$$),$s=$p,$$.text+="\n"+$V;continue;}0<$j.length&&$J.splitToWords($V,$p);}$p.setParent($R);}},$R.createShader=function($R,$F,$i){var $j={},$t="";if($R)for(var $p in $R)$t+="#define "+$p+"\n",$j[$p]=!0;var $$=this._VS.toscript($j,[]),$V=this._PS.toscript($j,[]);return($i||$rR.create)($t+$$.join("\n"),$t+$V.join("\n"),$F,this._nameMap);},$J._parseOne=function($R,$F,$i,$j,$t,$p){var $$={type:$J.shaderParamsMap[$i[$j+1]],name:$i[$j+2],size:isNaN(parseInt($i[$j+3]))?1:parseInt($i[$j+3])};return $p&&("attribute"==$t?$R.push($$):$F.push($$)),":"==$i[$j+3]&&($$.type=$i[$j+4],$j+=2),$j+=2;},$J.addInclude=function($R,$F){if(!$F||0===$F.length)throw new Error("add shader include file err:"+$R);if($J.includes[$R])throw new Error("add shader include file err, has add:"+$R);$J.includes[$R]=new $i($F);},$J.preGetParams=function($R,$F){var $i=[$R,$F],$j={},$t=[],$p=[],$$={},$V=[];$j.attributes=$t,$j.uniforms=$p,$j.defines=$$;for(var $N=0,$c=0,$q=0;$q<2;$q++){$i[$q]=$i[$q].replace($J._removeAnnotation,"");var $s,$k=$i[$q].match($J._reg);for($N=0,$c=$k.length;$N<$c;$N++){var $h=$k[$N];if("attribute"==$h||"uniform"==$h)$N=$J._parseOne($t,$p,$k,$N,$h,!0);else{if("#define"==$h){$V[$h=$k[++$N]]=1;continue;}if("#ifdef"==$h){$$[$s=$k[++$N]]=$$[$s]||[];for($N++;$N<$c;$N++)if("attribute"==($h=$k[$N])||"uniform"==$h)$N=$J._parseOne($t,$p,$k,$N,$h,$V[$s]);else if("#else"==$h)for($N++;$N<$c;$N++)if("attribute"==($h=$k[$N])||"uniform"==$h)$N=$J._parseOne($t,$p,$k,$N,$h,!$V[$s]);else if("#endif"==$h)break;}}}}return $j;},$J.splitToWords=function($R,$F){for(var $i,$j,$t=[],$p=-1,$$=0,$V=$R.length;$$<$V;$$++)if($i=$R.charAt($$),0<=" \t=+-*/&%!<>()'\",;".indexOf($i)){if(0<=$p&&1<$$-$p&&($j=$R.substr($p,$$-$p),$t.push($j)),'"'==$i||"'"==$i){var $N=$R.indexOf($i,$$+1);if($N<0)throw"Sharder err:"+$R;$t.push($R.substr($$+1,$N-$$-1)),$$=$N,$p=-1;continue;}"("==$i&&$F&&0<$t.length&&($j=$t[$t.length-1]+";","vec4;main;".indexOf($j)<0&&($F.useFuns+=$j)),$p=-1;}else $p<0&&($p=$$);return $p<$V&&1<$V-$p&&($j=$R.substr($p,$V-$p),$t.push($j)),$t;},$J.IFDEF_NO=0,$J.IFDEF_YES=1,$J.IFDEF_ELSE=2,$J.IFDEF_PARENT=3,$J._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),$J._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),$J._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),$J.includes={},$$($J,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680};},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g");}]),$J.__init$=function(){$M=function(){function $i($R){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=$R;}$k($i,"");var $R=$i.prototype;return $R.setParent=function($R){$R.childs.push(this),this.z=$R.z+1,this.parent=$R;},$R.setCondition=function($R,$F){$R&&(this.conditionType=$F,$R=$R.replace(/(\s*$)/g,""),this.condition=function(){return this[$R];},this.condition.__condition=$R);},$R.toscript=function($R,$F){return this._toscript($R,$F,++$i.__id);},$R._toscript=function($j,$t,$p){if(this.childs.length<1&&!this.text)return $t;$t.length;if(this.condition){var $R=!!this.condition.call($j);if(2===this.conditionType&&($R=!$R),!$R)return $t;}if(this.text&&$t.push(this.text),0<this.childs.length&&this.childs.forEach(function($R,$F,$i){$R._toscript($j,$t,$p);}),0<this.includefiles.length&&0<this.useFuns.length)for(var $F,$i=0,$$=this.includefiles.length;$i<$$;$i++)this.includefiles[$i].curUseID!=$p&&0<($F=this.includefiles[$i].file.getFunsScript(this.useFuns)).length&&(this.includefiles[$i].curUseID=$p,$t[0]=$F+$t[0]);return $t;},$i.__id=1,$i;}(),$i=function(){function $R($R){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=$R;for(var $F=0,$i=0,$j=0;!(($F=$R.indexOf("#begin",$F))<0);){for($j=$F+5;!(($j=$R.indexOf("#end",$j))<0)&&"i"===$R.charAt($j+4);)$j+=5;if($j<0)throw"add include err,no #end:"+$R;$i=$R.indexOf("\n",$F);var $t=$J.splitToWords($R.substr($F,$i-$F),null);"code"==$t[1]?this.codes[$t[2]]=$R.substr($i+1,$j-$i-1):"function"==$t[1]&&($i=$R.indexOf("function",$F),$i+="function".length,this.funs[$t[3]]=$R.substr($i+1,$j-$i-1),this.funnames+=$t[3]+";"),$F=$j+1;}}$k($R,"");var $F=$R.prototype;return $F.getWith=function($R){var $F=$R?this.codes[$R]:this.script;if(!$F)throw"get with error:"+$R;return $F;},$F.getFunsScript=function($R){var $F="";for(var $i in this.funs)0<=$R.indexOf($i+";")&&($F+=this.funs[$i]);return $F;},$R;}();},$J;}(),$dR=function(){function $$(){}return $k($$,"laya.webgl.WebGL"),$$._uint8ArraySlice=function(){for(var $R=this.length,$F=new Uint8Array(this.length),$i=0;$i<$R;$i++)$F[$i]=this[$i];return $F;},$$._float32ArraySlice=function(){for(var $R=this.length,$F=new Float32Array(this.length),$i=0;$i<$R;$i++)$F[$i]=this[$i];return $F;},$$._uint16ArraySlice=function($R){var $F,$i=arguments,$j=0,$t=0;if(0===$i.length)for($j=this.length,$F=new Uint16Array($j),$t=0;$t<$j;$t++)$F[$t]=this[$t];else if(2===$i.length){var $p=$i[0],$$=$i[1];if($p<$$)for($j=$$-$p,$F=new Uint16Array($j),$t=$p;$t<$$;$t++)$F[$t-$p]=this[$t];else $F=new Uint16Array(0);}return $F;},$$.expandContext=function(){var $R=$t.prototype,$F=CanvasRenderingContext2D.prototype;$F.fillTrangles=$R.fillTrangles,$AR.__int__(null),$F.setIBVB=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){void 0===$N&&($N=0),void 0===$c&&($c=0),null===$i&&(this._ib=this._ib||$IR.QuadrangleIB,$i=this._ib,$aR.expandIBQuadrangle($i,$j._byteLength/64+8)),this._setIBVB($R,$F,$i,$j,$t,$p,$$,$V,$N,$c);},$F.fillTrangles=function($R,$F,$i,$j,$t){this._curMat=this._curMat||$T.create(),this._vb=this._vb||$DR.create(),this._ib||(this._ib=$IR.create(),$aR.fillIBQuadrangle(this._ib,$$/4));var $p=this._vb,$$=$j.length>>4;$aR.fillTranglesVB($p,$F,$i,$j,$t||this._curMat,0,0),$aR.expandIBQuadrangle(this._ib,$p._byteLength/64+8);var $V=new $_R(1,0);$V.textureHost=$R;var $N=new $UR("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");$p._vertType=3,this._setIBVB($F,$i,this._ib,$p,6*$$,$t,$N,$V,0,0);};},$$.enable=function(){if($h.__init__(),$m.isConchApp&&!$m.isConchWebGL)return $w.skinAniSprite=function(){return new $RR();},$$.expandContext(),!1;if($w.getWebGLContext=function($R){for(var $F,$i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],$j=0;$j<$i.length;$j++){try{$F=$R.getContext($i[$j],{stencil:$H.isStencil,alpha:$H.isAlpha,antialias:$H.isAntialias,premultipliedAlpha:$H.premultipliedAlpha,preserveDrawingBuffer:$H.preserveDrawingBuffer});}catch($R){}if($F)return $F;}return null;},null==($$.mainContext=$$.mainContext||$w.getWebGLContext($m._mainCanvas)))return!1;if($m.isWebGL)return!0;$x.create=function($R,$F){return new $RF($R,$F);},$a.create=function($R,$F,$i,$j,$t,$p,$$){return new $CR($R,$F,$i,$j,$t,$p,$$);},$m.WebGL=$$,$m.isWebGL=!0,$hR.__init__(),$w.createRenderSprite=function($R,$F){return new $TR($R,$F);},$w.createWebGLContext2D=function($R){return new $HR($R);},$w.changeWebGLSize=function($R,$F){laya.webgl.WebGL.onStageResize($R,$F);},$w.createGraphics=function(){return new $XR();};var $R=$w.createFilterAction;return $w.createFilterAction=$R||function($R){return new $gR();},$w.clear=function($R){$MR.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var $F=$m.context.ctx,$i=0==$F._submits._length||$H.preserveDrawingBuffer?$S.create($R)._color:$L._wgColor;$i&&$F.clearBG($i[0],$i[1],$i[2],$i[3]),$MR.clear();},$w.addToAtlas=function($R,$F){void 0===$F&&($F=!1);var $i=$R.bitmap;$m.optimizeTextureMemory($R.url,$R)?$X.__typeof($i,"laya.webgl.resource.IMergeAtlasBitmap")&&$i.allowMerageInAtlas&&$i.on("recovered",$R,$R.addTextureToAtlas):$i.enableMerageInAtlas=!1;},$w.isAtlas=function($R){return $R instanceof laya.webgl.atlas.AtlasWebGLCanvas;},$O._enable(),$w.beginFlush=function(){for(var $R=$O.instance,$F=$R.getAtlaserCount(),$i=0;$i<$F;$i++){var $j=$R.getAtlaserByIndex($i).texture;$j._flashCacheImageNeedFlush&&$w.flashFlushImage($j);}},$w.drawToCanvas=function($R,$F,$i,$j,$t,$p){($i<=0||$j<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),$i|=0,$j|=0,$t|=0,$p|=0;var $$=$eR.create($i,$j,6408,5121,0,!1);$$.start(),$$.clear(0,0,0,0),$m.context.clear(),$M.renders[$F]._fun($R,$m.context,$t,$MR.height-$j+$p),$m.context.flush(),$$.end();var $V=$$.getData(0,0,$i,$j);if($$.recycle(),$V.byteLength==$i*$j*4){var $N=new $WR();$N._canvas=$h.createElement("canvas"),$N.size($i,$j);var $c=$N._canvas.getContext("2d");$h.canvas.size($i,$j);var $q=$h.context,$s=$q.createImageData($i,$j);return $s.data.set(new Uint8ClampedArray($V.buffer)),$N._imgData=$s,$q.putImageData($s,0,0),$c.save(),$c.translate(0,$j),$c.scale(1,-1),$c.drawImage($h.canvas.source,0,0),$c.restore(),$N;}console.log("drawToCanvas error: w:"+$i+",h:"+$j+",datalen:"+$V.byteLength);},$w.createFilterAction=function($R){var $F;switch($R){case 32:$F=new $gR();}return $F;},$w.addTextureToAtlas=function($R){$R._uvID++,$O._atlasRestore++,$R.bitmap.enableMerageInAtlas&&$O.instance.addToAtlas($R);},$w.getTexturePixels=function($R,$F,$i,$j,$t){$m.context.ctx.clear();var $p=new $z();$p.graphics.drawTexture($R,-$F,-$i);var $$=$eR.create($j,$t);$$.start(),$$.clear(0,0,0,0),$p.render($m.context,0,0),$m.context.ctx.flush(),$$.end();for(var $V=$$.getData(0,0,$j,$t),$N=[],$c=0,$q=$t-1;0<=$q;$q--)for(var $s=0;$s<$j;$s++)$c=4*($q*$j+$s),$N.push($V[$c]),$N.push($V[$c+1]),$N.push($V[$c+2]),$N.push($V[$c+3]);return $N;},$w.skinAniSprite=function(){return new $RR();},$c.create=function($R,$F){var $i=new $WR();return $i._imgData=$F,$i.flipY=!1,$i;},$_._filterStart=function($R,$F,$i,$j,$t){var $p=$R.getValue("bounds"),$$=$eR.create($p.width,$p.height);if($$.start(),$$.clear(0,0,0,0),$R.addValue("src",$$),$R.addValue("ScissorTest",$MR.worldScissorTest),$MR.worldScissorTest){var $V=new $B();$V.copyFrom($i.ctx._clipRect),$R.addValue("clipRect",$V),$MR.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089);}},$_._filterEnd=function($R,$F,$i,$j,$t){var $p=$R.getValue("bounds");$R.getValue("src").end();var $$=$eR.create($p.width,$p.height);$$.start(),$$.clear(0,0,0,0),$R.addValue("out",$$),$F._set$P("_filterCache",$$),$F._set$P("_isHaveGlowFilter",$R.getValue("_isHaveGlowFilter"));},$_._EndTarget=function($R,$F){if($R.getValue("src").recycle(),$R.getValue("out").end(),$R.getValue("ScissorTest")){$MR.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),$F.ctx.save();var $i=$R.getValue("clipRect");$F.ctx.clipRect($i.x,$i.y,$i.width,$i.height);}},$_._useSrc=function($R){var $F=$R.getValue("out");$F.end(),($F=$R.getValue("src")).start(),$F.clear(0,0,0,0);},$_._endSrc=function($R){$R.getValue("src").end();},$_._useOut=function($R){var $F=$R.getValue("src");$F.end(),($F=$R.getValue("out")).start(),$F.clear(0,0,0,0);},$_._endOut=function($R){$R.getValue("out").end();},$_._recycleScope=function($R){$R.recycle();},$_._filter=function($R,$F,$i,$j){var $t=this._next;if($t){var $p,$$,$V=$R.filters,$N=$V.length;if(1==$N&&32==$V[0].type)return $F.ctx.save(),$F.ctx.setFilters([$V[0]]),$t._fun.call($t,$R,$F,$i,$j),void $F.ctx.restore();var $c=$VR.create(),$q=$g.TEMP,$s=$F.ctx._getTransformMatrix(),$k=$T.create();$s.copyTo($k);var $h=0,$S=0,$x=!1,$a=$R._$P._filterCache?$R._$P._filterCache:null;if(!$a||$R._repaint){$x=$R._isHaveGlowFilter(),$c.addValue("_isHaveGlowFilter",$x),$x&&($h=50,$S=25),($$=new $B()).copyFrom($R.getSelfBounds()),$$.x+=$R.x,$$.y+=$R.y,$$.x-=$R.pivotX+4,$$.y-=$R.pivotY+4;var $m=$$.x,$M=$$.y;if($$.width+=$h+8,$$.height+=$h+8,$q.x=$$.x*$k.a+$$.y*$k.c,$q.y=$$.y*$k.d+$$.x*$k.b,$$.x=$q.x,$$.y=$q.y,$q.x=$$.width*$k.a+$$.height*$k.c,$q.y=$$.height*$k.d+$$.width*$k.b,$$.width=$q.x,$$.height=$q.y,$$.width<=0||$$.height<=0)return;$a&&$a.recycle(),$c.addValue("bounds",$$);var $J=$$R.create([$c,$R,$F,0,0],$_._filterStart);$F.addRenderObject($J),$F.ctx._renderKey=0,$F.ctx._shader2D.glTexture=null;var $d=$R.x-$m+$S,$w=$R.y-$M+$S;$t._fun.call($t,$R,$F,$d,$w),$J=$$R.create([$c,$R,$F,0,0],$_._filterEnd),$F.addRenderObject($J);for(var $X=0;$X<$N;$X++){0!=$X&&($J=$$R.create([$c],$_._useSrc),$F.addRenderObject($J),$p=$_R.create(1,0),$T.TEMP.identity(),$F.ctx.drawTarget($c,0,0,$$.width,$$.height,$T.TEMP,"out",$p,null,$E.TOINT.overlay),$J=$$R.create([$c],$_._useOut),$F.addRenderObject($J)),$V[$X].action.apply3d($c,$R,$F,0,0);}$J=$$R.create([$c,$F],$_._EndTarget),$F.addRenderObject($J);}else{if(($x=!!$R._$P._isHaveGlowFilter&&$R._$P._isHaveGlowFilter)&&($h=50,$S=25),($$=$R.getBounds()).width<=0||$$.height<=0)return;$$.width+=$h,$$.height+=$h,$q.x=$$.x*$k.a+$$.y*$k.c,$q.y=$$.y*$k.d+$$.x*$k.b,$$.x=$q.x,$$.y=$q.y,$q.x=$$.width*$k.a+$$.height*$k.c,$q.y=$$.height*$k.d+$$.width*$k.b,$$.width=$q.x,$$.height=$q.y,$c.addValue("out",$a);}$i=$i-$S-$R.x,$j=$j-$S-$R.y,$q.setTo($i,$j),$k.transformPoint($q),$i=$q.x+$$.x,$j=$q.y+$$.y,$p=$_R.create(1,0),$T.TEMP.identity(),$F.ctx.drawTarget($c,$i,$j,$$.width,$$.height,$T.TEMP,"out",$p,null,$E.TOINT.overlay),$J=$$R.create([$c],$_._recycleScope),$F.addRenderObject($J),$k.destroy();}},Float32Array.prototype.slice||(Float32Array.prototype.slice=$$._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=$$._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=$$._uint8ArraySlice),!0;},$$.onStageResize=function($R,$F){null!=$$.mainContext&&($$.mainContext.viewport(0,0,$R,$F),$MR.width=$R,$MR.height=$F);},$$.onInvalidGLRes=function(){$O.instance.freeAll(),$d.releaseContentManagers(!0),$$.doNodeRepaint($X.stage),$$.mainContext.viewport(0,0,$MR.width,$MR.height),$X.stage.event("devicelost");},$$.doNodeRepaint=function($R){0==$R.numChildren&&$R.repaint();for(var $F=0;$F<$R.numChildren;$F++)$$.doNodeRepaint($R.getChildAt($F));},$$.init=function($R,$F,$i){$$.mainCanvas=$R,$c._createContext=function($R){return new $HR($R);},$WR._createContext=function($R){return new $HR($R);};var $j=laya.webgl.WebGL.mainContext;if(null!=$j.getShaderPrecisionFormat){var $t=$j.getShaderPrecisionFormat(35633,36338),$p=$j.getShaderPrecisionFormat(35632,36338);$$.shaderHighPrecision=!(!$t.precision||!$p.precision);}else $$.shaderHighPrecision=!1;if($$.compressAstc=$j.getExtension("WEBGL_compressed_texture_astc"),$$.compressAtc=$j.getExtension("WEBGL_compressed_texture_atc"),$$.compressEtc=$j.getExtension("WEBGL_compressed_texture_etc"),$$.compressEtc1=$j.getExtension("WEBGL_compressed_texture_etc1"),$$.compressPvrtc=$j.getExtension("WEBGL_compressed_texture_pvrtc"),$$.compressS3tc=$j.getExtension("WEBGL_compressed_texture_s3tc"),$$.compressS3tc_srgb=$j.getExtension("WEBGL_compressed_texture_s3tc_srgb"),$$.compressAstc=$$.compressAstc?$$.compressAstc:{},$$.compressAtc=$$.compressAtc?$$.compressAtc:{},$$.compressEtc=$$.compressEtc?$$.compressEtc:{},$$.compressEtc1=$$.compressEtc1?$$.compressEtc1:{},$$.compressPvrtc=$$.compressPvrtc?$$.compressPvrtc:{},$$.compressS3tc=$$.compressS3tc?$$.compressS3tc:{},$$.compressS3tc_srgb=$$.compressS3tc_srgb?$$.compressS3tc_srgb:{},$j.deleteTexture1=$j.deleteTexture,$j.deleteTexture=function($R){$R==$wR.curBindTexValue&&($wR.curBindTexValue=null),$j.deleteTexture1($R);},$$.onStageResize($F,$i),null==$$.mainContext)throw new Error("webGL getContext err!");$Z.__init__(),$O.__init__(),$zR.__init__(),$pR.__init__(),$HR.__init__(),$_R.__init__(),$I.__init__(),$AR.__int__($j),$E._init_($j),$m.isConchApp&&conch.setOnInvalidGLRes($$.onInvalidGLRes);},$$.mainCanvas=null,$$.antialias=!0,$$.shaderHighPrecision=!1,$$._bg_null=[0,0,0,0],$$;}(),$wR=function(){function $j(){}return $k($j,"laya.webgl.WebGLContext"),$j.UseProgram=function($R){return $j._useProgram!==$R&&($dR.mainContext.useProgram($R),$j._useProgram=$R,!0);},$j.setDepthTest=function($R,$F){$F!==$j._depthTest&&(($j._depthTest=$F)?$R.enable(2929):$R.disable(2929));},$j.setDepthMask=function($R,$F){$F!==$j._depthMask&&($j._depthMask=$F,$R.depthMask($F));},$j.setDepthFunc=function($R,$F){$F!==$j._depthFunc&&($j._depthFunc=$F,$R.depthFunc($F));},$j.setBlend=function($R,$F){$F!==$j._blend&&(($j._blend=$F)?$R.enable(3042):$R.disable(3042));},$j.setBlendFunc=function($R,$F,$i){($F!==$j._sFactor||$i!==$j._dFactor)&&($j._sFactor=$F,$j._dFactor=$i,$R.blendFunc($F,$i));},$j.setCullFace=function($R,$F){$F!==$j._cullFace&&(($j._cullFace=$F)?$R.enable(2884):$R.disable(2884));},$j.setFrontFace=function($R,$F){$F!==$j._frontFace&&($j._frontFace=$F,$R.frontFace($F));},$j.bindTexture=function($R,$F,$i){$R.bindTexture($F,$i),$j.curBindTexTarget=$F,$j.curBindTexValue=$i;},$j.DEPTH_BUFFER_BIT=256,$j.STENCIL_BUFFER_BIT=1024,$j.COLOR_BUFFER_BIT=16384,$j.POINTS=0,$j.LINES=1,$j.LINE_LOOP=2,$j.LINE_STRIP=3,$j.TRIANGLES=4,$j.TRIANGLE_STRIP=5,$j.TRIANGLE_FAN=6,$j.ZERO=0,$j.ONE=1,$j.SRC_COLOR=768,$j.ONE_MINUS_SRC_COLOR=769,$j.SRC_ALPHA=770,$j.ONE_MINUS_SRC_ALPHA=771,$j.DST_ALPHA=772,$j.ONE_MINUS_DST_ALPHA=773,$j.DST_COLOR=774,$j.ONE_MINUS_DST_COLOR=775,$j.SRC_ALPHA_SATURATE=776,$j.FUNC_ADD=32774,$j.BLEND_EQUATION=32777,$j.BLEND_EQUATION_RGB=32777,$j.BLEND_EQUATION_ALPHA=34877,$j.FUNC_SUBTRACT=32778,$j.FUNC_REVERSE_SUBTRACT=32779,$j.BLEND_DST_RGB=32968,$j.BLEND_SRC_RGB=32969,$j.BLEND_DST_ALPHA=32970,$j.BLEND_SRC_ALPHA=32971,$j.CONSTANT_COLOR=32769,$j.ONE_MINUS_CONSTANT_COLOR=32770,$j.CONSTANT_ALPHA=32771,$j.ONE_MINUS_CONSTANT_ALPHA=32772,$j.BLEND_COLOR=32773,$j.ARRAY_BUFFER=34962,$j.ELEMENT_ARRAY_BUFFER=34963,$j.ARRAY_BUFFER_BINDING=34964,$j.ELEMENT_ARRAY_BUFFER_BINDING=34965,$j.STREAM_DRAW=35040,$j.STATIC_DRAW=35044,$j.DYNAMIC_DRAW=35048,$j.BUFFER_SIZE=34660,$j.BUFFER_USAGE=34661,$j.CURRENT_VERTEX_ATTRIB=34342,$j.FRONT=1028,$j.BACK=1029,$j.CULL_FACE=2884,$j.FRONT_AND_BACK=1032,$j.BLEND=3042,$j.DITHER=3024,$j.STENCIL_TEST=2960,$j.DEPTH_TEST=2929,$j.SCISSOR_TEST=3089,$j.POLYGON_OFFSET_FILL=32823,$j.SAMPLE_ALPHA_TO_COVERAGE=32926,$j.SAMPLE_COVERAGE=32928,$j.NO_ERROR=0,$j.INVALID_ENUM=1280,$j.INVALID_VALUE=1281,$j.INVALID_OPERATION=1282,$j.OUT_OF_MEMORY=1285,$j.CW=2304,$j.CCW=2305,$j.LINE_WIDTH=2849,$j.ALIASED_POINT_SIZE_RANGE=33901,$j.ALIASED_LINE_WIDTH_RANGE=33902,$j.CULL_FACE_MODE=2885,$j.FRONT_FACE=2886,$j.DEPTH_RANGE=2928,$j.DEPTH_WRITEMASK=2930,$j.DEPTH_CLEAR_VALUE=2931,$j.DEPTH_FUNC=2932,$j.STENCIL_CLEAR_VALUE=2961,$j.STENCIL_FUNC=2962,$j.STENCIL_FAIL=2964,$j.STENCIL_PASS_DEPTH_FAIL=2965,$j.STENCIL_PASS_DEPTH_PASS=2966,$j.STENCIL_REF=2967,$j.STENCIL_VALUE_MASK=2963,$j.STENCIL_WRITEMASK=2968,$j.STENCIL_BACK_FUNC=34816,$j.STENCIL_BACK_FAIL=34817,$j.STENCIL_BACK_PASS_DEPTH_FAIL=34818,$j.STENCIL_BACK_PASS_DEPTH_PASS=34819,$j.STENCIL_BACK_REF=36003,$j.STENCIL_BACK_VALUE_MASK=36004,$j.STENCIL_BACK_WRITEMASK=36005,$j.VIEWPORT=2978,$j.SCISSOR_BOX=3088,$j.COLOR_CLEAR_VALUE=3106,$j.COLOR_WRITEMASK=3107,$j.UNPACK_ALIGNMENT=3317,$j.PACK_ALIGNMENT=3333,$j.MAX_TEXTURE_SIZE=3379,$j.MAX_VIEWPORT_DIMS=3386,$j.SUBPIXEL_BITS=3408,$j.RED_BITS=3410,$j.GREEN_BITS=3411,$j.BLUE_BITS=3412,$j.ALPHA_BITS=3413,$j.DEPTH_BITS=3414,$j.STENCIL_BITS=3415,$j.POLYGON_OFFSET_UNITS=10752,$j.POLYGON_OFFSET_FACTOR=32824,$j.TEXTURE_BINDING_2D=32873,$j.SAMPLE_BUFFERS=32936,$j.SAMPLES=32937,$j.SAMPLE_COVERAGE_VALUE=32938,$j.SAMPLE_COVERAGE_INVERT=32939,$j.NUM_COMPRESSED_TEXTURE_FORMATS=34466,$j.COMPRESSED_TEXTURE_FORMATS=34467,$j.DONT_CARE=4352,$j.FASTEST=4353,$j.NICEST=4354,$j.GENERATE_MIPMAP_HINT=33170,$j.BYTE=5120,$j.UNSIGNED_BYTE=5121,$j.SHORT=5122,$j.UNSIGNED_SHORT=5123,$j.INT=5124,$j.UNSIGNED_INT=5125,$j.FLOAT=5126,$j.DEPTH_COMPONENT=6402,$j.ALPHA=6406,$j.RGB=6407,$j.RGBA=6408,$j.LUMINANCE=6409,$j.LUMINANCE_ALPHA=6410,$j.UNSIGNED_SHORT_4_4_4_4=32819,$j.UNSIGNED_SHORT_5_5_5_1=32820,$j.UNSIGNED_SHORT_5_6_5=33635,$j.FRAGMENT_SHADER=35632,$j.VERTEX_SHADER=35633,$j.MAX_VERTEX_ATTRIBS=34921,$j.MAX_VERTEX_UNIFORM_VECTORS=36347,$j.MAX_VARYING_VECTORS=36348,$j.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,$j.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,$j.MAX_TEXTURE_IMAGE_UNITS=34930,$j.MAX_FRAGMENT_UNIFORM_VECTORS=36349,$j.SHADER_TYPE=35663,$j.DELETE_STATUS=35712,$j.LINK_STATUS=35714,$j.VALIDATE_STATUS=35715,$j.ATTACHED_SHADERS=35717,$j.ACTIVE_UNIFORMS=35718,$j.ACTIVE_ATTRIBUTES=35721,$j.SHADING_LANGUAGE_VERSION=35724,$j.CURRENT_PROGRAM=35725,$j.NEVER=512,$j.LESS=513,$j.EQUAL=514,$j.LEQUAL=515,$j.GREATER=516,$j.NOTEQUAL=517,$j.GEQUAL=518,$j.ALWAYS=519,$j.KEEP=7680,$j.REPLACE=7681,$j.INCR=7682,$j.DECR=7683,$j.INVERT=5386,$j.INCR_WRAP=34055,$j.DECR_WRAP=34056,$j.VENDOR=7936,$j.RENDERER=7937,$j.VERSION=7938,$j.NEAREST=9728,$j.LINEAR=9729,$j.NEAREST_MIPMAP_NEAREST=9984,$j.LINEAR_MIPMAP_NEAREST=9985,$j.NEAREST_MIPMAP_LINEAR=9986,$j.LINEAR_MIPMAP_LINEAR=9987,$j.TEXTURE_MAG_FILTER=10240,$j.TEXTURE_MIN_FILTER=10241,$j.TEXTURE_WRAP_S=10242,$j.TEXTURE_WRAP_T=10243,$j.TEXTURE_2D=3553,$j.TEXTURE=5890,$j.TEXTURE_CUBE_MAP=34067,$j.TEXTURE_BINDING_CUBE_MAP=34068,$j.TEXTURE_CUBE_MAP_POSITIVE_X=34069,$j.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,$j.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,$j.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,$j.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,$j.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,$j.MAX_CUBE_MAP_TEXTURE_SIZE=34076,$j.TEXTURE0=33984,$j.TEXTURE1=33985,$j.TEXTURE2=33986,$j.TEXTURE3=33987,$j.TEXTURE4=33988,$j.TEXTURE5=33989,$j.TEXTURE6=33990,$j.TEXTURE7=33991,$j.TEXTURE8=33992,$j.TEXTURE9=33993,$j.TEXTURE10=33994,$j.TEXTURE11=33995,$j.TEXTURE12=33996,$j.TEXTURE13=33997,$j.TEXTURE14=33998,$j.TEXTURE15=33999,$j.TEXTURE16=34e3,$j.TEXTURE17=34001,$j.TEXTURE18=34002,$j.TEXTURE19=34003,$j.TEXTURE20=34004,$j.TEXTURE21=34005,$j.TEXTURE22=34006,$j.TEXTURE23=34007,$j.TEXTURE24=34008,$j.TEXTURE25=34009,$j.TEXTURE26=34010,$j.TEXTURE27=34011,$j.TEXTURE28=34012,$j.TEXTURE29=34013,$j.TEXTURE30=34014,$j.TEXTURE31=34015,$j.ACTIVE_TEXTURE=34016,$j.REPEAT=10497,$j.CLAMP_TO_EDGE=33071,$j.MIRRORED_REPEAT=33648,$j.FLOAT_VEC2=35664,$j.FLOAT_VEC3=35665,$j.FLOAT_VEC4=35666,$j.INT_VEC2=35667,$j.INT_VEC3=35668,$j.INT_VEC4=35669,$j.BOOL=35670,$j.BOOL_VEC2=35671,$j.BOOL_VEC3=35672,$j.BOOL_VEC4=35673,$j.FLOAT_MAT2=35674,$j.FLOAT_MAT3=35675,$j.FLOAT_MAT4=35676,$j.SAMPLER_2D=35678,$j.SAMPLER_CUBE=35680,$j.VERTEX_ATTRIB_ARRAY_ENABLED=34338,$j.VERTEX_ATTRIB_ARRAY_SIZE=34339,$j.VERTEX_ATTRIB_ARRAY_STRIDE=34340,$j.VERTEX_ATTRIB_ARRAY_TYPE=34341,$j.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,$j.VERTEX_ATTRIB_ARRAY_POINTER=34373,$j.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,$j.COMPILE_STATUS=35713,$j.LOW_FLOAT=36336,$j.MEDIUM_FLOAT=36337,$j.HIGH_FLOAT=36338,$j.LOW_INT=36339,$j.MEDIUM_INT=36340,$j.HIGH_INT=36341,$j.FRAMEBUFFER=36160,$j.RENDERBUFFER=36161,$j.RGBA4=32854,$j.RGB5_A1=32855,$j.RGB565=36194,$j.DEPTH_COMPONENT16=33189,$j.STENCIL_INDEX=6401,$j.STENCIL_INDEX8=36168,$j.DEPTH_STENCIL=34041,$j.RENDERBUFFER_WIDTH=36162,$j.RENDERBUFFER_HEIGHT=36163,$j.RENDERBUFFER_INTERNAL_FORMAT=36164,$j.RENDERBUFFER_RED_SIZE=36176,$j.RENDERBUFFER_GREEN_SIZE=36177,$j.RENDERBUFFER_BLUE_SIZE=36178,$j.RENDERBUFFER_ALPHA_SIZE=36179,$j.RENDERBUFFER_DEPTH_SIZE=36180,$j.RENDERBUFFER_STENCIL_SIZE=36181,$j.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,$j.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,$j.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,$j.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,$j.COLOR_ATTACHMENT0=36064,$j.DEPTH_ATTACHMENT=36096,$j.STENCIL_ATTACHMENT=36128,$j.DEPTH_STENCIL_ATTACHMENT=33306,$j.NONE=0,$j.FRAMEBUFFER_COMPLETE=36053,$j.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,$j.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,$j.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,$j.FRAMEBUFFER_UNSUPPORTED=36061,$j.FRAMEBUFFER_BINDING=36006,$j.RENDERBUFFER_BINDING=36007,$j.MAX_RENDERBUFFER_SIZE=34024,$j.INVALID_FRAMEBUFFER_OPERATION=1286,$j.UNPACK_FLIP_Y_WEBGL=37440,$j.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,$j.CONTEXT_LOST_WEBGL=37442,$j.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,$j.BROWSER_DEFAULT_WEBGL=37444,$j._useProgram=null,$j._depthTest=!0,$j._depthMask=!0,$j._blend=!1,$j._cullFace=!1,$j.curBindTexTarget=null,$j.curBindTexValue=null,$$($j,["_depthFunc",function(){return this._depthFunc=513;},"_sFactor",function(){return this._sFactor=1;},"_dFactor",function(){return this._dFactor=0;},"_frontFace",function(){return this._frontFace=2305;}]),$j;}(),$XR=function($R){function $F(){$F.__super.call(this);}$k($F,"laya.webgl.display.GraphicsGL",$V);var $i=$F.prototype;return $i.setShader=function($R){this._saveToCmd($m.context._setShader,[$R]);},$i.setIBVB=function($R,$F,$i,$j,$t,$p){this._saveToCmd($m.context._setIBVB,[$R,$F,$i,$j,$t,$p]);},$i.drawParticle=function($R,$F,$i){var $j=$w.createParticleTemplate2D($i);$j.x=$R,$j.y=$F,this._saveToCmd($m.context._drawParticle,[$j]);},$F;}(),$HR=function($R){var $i;function $G($R){this._x=0,this._y=0,this._id=++$G._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,$G.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=$G.MAXCLIPRECT,this.mOutPoint,this._canvas=$R,this._canvas._addReference(),$G._contextcount++,$m.isFlash?(this._ib=$IR.create(35044),$aR.fillIBQuadrangle(this._ib,16)):this._ib=$IR.QuadrangleIB,this.clear();}$k($G,"laya.webgl.canvas.WebGLContext2D",$t);var $F=$G.prototype;return $F.setIsMainContext=function(){this._isMain=!0;},$F.clearBG=function($R,$F,$i,$j){var $t=$dR.mainContext;$t.clearColor($R,$F,$i,$j),$t.clear(16384);},$F._getSubmits=function(){return this._submits;},$F._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var $R=0,$F=this._submits._length;$R<$F;$R++)this._submits[$R].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null);}},$F.destroy=function(){--$G._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=$IR.QuadrangleIB&&this._ib.releaseResource();},$F.clear=function(){this._submits||(this._other=$i.DEFAULT,this._curMat=$T.create(),this._vb=$DR.create(-1),this._submits=[],this._save=[$r.Create(this)],this._save.length=10,this._shader2D=new $I(),this._triangleMesh=$vR.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=$i.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=$G.MAXCLIPRECT,this._curSubmit=$pR.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=$l.DEFAULT;for(var $R=0,$F=this._submits._length;$R<$F;$R++)this._submits[$R].releaseRender(),this._submits[$R]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1;},$F.size=function($R,$F){if(this._width!=$R||this._height!=$F)if(0==$R||0==$F){0!=this._vb._byteLength&&(this._width=$R,this._height=$F,this._vb.clear(),this._vb.upload());for(var $i=0,$j=this._submits._length;$i<$j;$i++)this._submits[$i].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null;}else this._width=$R,this._height=$F,this._targets&&this._targets.size($R,$F),this._canvas.memorySize-=this._canvas.memorySize;0===$R&&0===$F&&this._releaseMem();},$F._getTransformMatrix=function(){return this._curMat;},$F.translate=function($R,$F){0===$R&&0===$F||($P.save(this),this._curMat.bTransform&&($A.save(this),this._curMat.transformPointN($g.TEMP.setTo($R,$F)),$R=$g.TEMP.x,$F=$g.TEMP.y),this._x+=$R,this._y+=$F);},$F.save=function(){this._save[this._save._length++]=$r.Create(this);},$F.restore=function(){var $R=this._save._length;if(!($R<1))for(var $F=$R-1;0<=$F;$F--){var $i=this._save[$F];if($i.restore(this),$i.isSaveMark())return void(this._save._length=$F);}},$F._fillText=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){void 0===$c&&($c=0);var $q=this._shader2D,$s=this._curSubmit.shaderValue,$k=$t?$SR.create($t):this._other.font;if($O.enabled)$q.ALPHA!==$s.ALPHA&&($q.glTexture=null),$hR.drawText(this,$R,$F,this._curMat,$k,$N||this._other.textAlign,$p,$$,$V,$i,$j,$c);else{this._shader2D.defines.getValue();var $h=$p?$S.create($p)._color:$q.colorAdd;$q.ALPHA===$s.ALPHA&&$h===$q.colorAdd&&$s.colorAdd===$q.colorAdd||($q.glTexture=null,$q.colorAdd=$h),$hR.drawText(this,$R,$F,this._curMat,$k,$N||this._other.textAlign,$p,$$,$V,$i,$j,$c);}},$F.fillWords=function($R,$F,$i,$j,$t,$p){this._fillText(null,$R,$F,$i,$j,$t,null,-1,null,$p);},$F.fillBorderWords=function($R,$F,$i,$j,$t,$p,$$){this._fillBorderText(null,$R,$F,$i,$j,$t,$p,$$,null);},$F.fillText=function($R,$F,$i,$j,$t,$p){this._fillText($R,null,$F,$i,$j,$t,null,-1,$p);},$F.strokeText=function($R,$F,$i,$j,$t,$p,$$){this._fillText($R,null,$F,$i,$j,null,$t,$p||1,$$);},$F.fillBorderText=function($R,$F,$i,$j,$t,$p,$$,$V){this._fillBorderText($R,null,$F,$i,$j,$t,$p,$$,$V);},$F._fillBorderText=function($R,$F,$i,$j,$t,$p,$$,$V,$N){if(!$O.enabled)return this._fillText($R,$F,$i,$j,$t,null,$$,$V||1,$N),void this._fillText($R,$F,$i,$j,$t,$p,null,-1,$N);var $c=this._shader2D,$q=this._curSubmit.shaderValue;$c.ALPHA!==$q.ALPHA&&($c.glTexture=null);var $s=$t?($G._fontTemp.setFont($t),$G._fontTemp):this._other.font;$hR.drawText(this,$R,$F,this._curMat,$s,$N||this._other.textAlign,$p,$$,$V||1,$i,$j,0);},$F.fillRect=function($R,$F,$i,$j,$t){var $p=this._vb;if($aR.fillRectImgVb($p,this._clipRect,$R,$F,$i,$j,$v.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $$=this._shader2D.fillStyle;$t&&(this._shader2D.fillStyle=$l.create($t));var $V=this._shader2D,$N=this._curSubmit.shaderValue;if($V.fillStyle!==$N.fillStyle||$V.ALPHA!==$N.ALPHA){$V.glTexture=null;var $c=this._curSubmit=$pR.createSubmit(this,this._ib,$p,($p._byteLength-64)/32*3,$_R.create(2,0));$c.shaderValue.color=$V.fillStyle._color._color,$c.shaderValue.ALPHA=$V.ALPHA,this._submits[this._submits._length++]=$c;}this._curSubmit._numEle+=6,this._shader2D.fillStyle=$$;}},$F.fillTexture=function($R,$F,$i,$j,$t,$p,$$,$V){if($R.loaded&&$R.bitmap&&$R.source){var $N=this._vb,$c=$R.bitmap.width,$q=$R.bitmap.height,$s=$R.uv,$k=$$.x%$R.width,$h=$$.y%$R.height;if($c!=$V.w||$q!=$V.h){if(!$V.w&&!$V.h)switch($V.oy=$V.ox=0,$p){case"repeat":$V.width=$j,$V.height=$t;break;case"repeat-x":$V.width=$j,$h<0?$R.height+$h>$t?$V.height=$t:$V.height=$R.height+$h:($V.oy=$h,$R.height+$h>$t?$V.height=$t-$h:$V.height=$R.height);break;case"repeat-y":$k<0?$R.width+$k>$j?$V.width=$j:$V.width=$R.width+$k:($V.ox=$k,$R.width+$k>$j?$V.width=$j-$k:$V.width=$R.width),$V.height=$t;break;case"no-repeat":$k<0?$R.width+$k>$j?$V.width=$j:$V.width=$R.width+$k:($V.ox=$k,$R.width+$k>$j?$V.width=$j-$k:$V.width=$R.width),$h<0?$R.height+$h>$t?$V.height=$t:$V.height=$R.height+$h:($V.oy=$h,$R.height+$h>$t?$V.height=$t-$h:$V.height=$R.height);break;default:$V.width=$j,$V.height=$t;}$V.w=$c,$V.h=$q,$V.uv=[0,0,$V.width/$c,0,$V.width/$c,$V.height/$q,0,$V.height/$q];}if($F+=$V.ox,$i+=$V.oy,$k-=$V.ox,$h-=$V.oy,$aR.fillRectImgVb($N,this._clipRect,$F,$i,$V.width,$V.height,$V.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $S=$uR.create(this,this._ib,$N,($N._byteLength-64)/32*3,$_R.create(256,0)),$x=(this._submits[this._submits._length++]=$S).shaderValue;$x.textureHost=$R;var $a=$s[0]*$c,$m=$s[1]*$q,$M=($s[2]-$s[0])*$c,$J=($s[5]-$s[3])*$q,$d=-$k/$c,$w=-$h/$q;$x.u_TexRange[0]=$a/$c,$x.u_TexRange[1]=$M/$c,$x.u_TexRange[2]=$m/$q,$x.u_TexRange[3]=$J/$q,$x.u_offset[0]=$d,$x.u_offset[1]=$w,$O.enabled&&!this._isMain&&$S.addTexture($R,($N._byteLength>>2)-16),(this._curSubmit=$S)._renderType=10017,$S._numEle+=6;}}else this.sprite&&$X.timer.callLater(this,this._repaintSprite);},$F.setShader=function($R){$o.save(this,1048576,this._shader2D,!0),this._shader2D.shader=$R;},$F.setFilters=function($R){$o.save(this,2097152,this._shader2D,!0),this._shader2D.filters=$R,this._curSubmit=$pR.RENDERBASE,this._renderKey=0,this._drawCount++;},$F.drawTexture=function($R,$F,$i,$j,$t,$p,$$){this._drawTextureM($R,$F,$i,$j,$t,$p,$$,null,1);},$F.addTextureVb=function($R,$F,$i){var $j=this._curSubmit._vb||this._vb,$t=$j._byteLength>>2;$j.byteLength=$t+16<<2;for(var $p=$j.getFloat32Array(),$$=0;$$<16;$$+=4)$p[$t++]=$R[$$]+$F,$p[$t++]=$R[$$+1]+$i,$p[$t++]=$R[$$+2],$p[$t++]=$R[$$+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),$j._upload=!0;},$F.willDrawTexture=function($R,$F){if(!($R.loaded&&$R.bitmap&&$R.source))return this.sprite&&$X.timer.callLater(this,this._repaintSprite),0;var $i=$R.bitmap,$j=$i.id+this._shader2D.ALPHA*$F+10016;if($j==this._renderKey)return $j;var $t=this._shader2D,$p=$t.ALPHA,$$=this._curSubmit.shaderValue;$t.ALPHA*=$F,this._renderKey=$j,this._drawCount++,$t.glTexture=$i;var $V=this._vb,$N=null,$c=$V._byteLength/32*3,$q=$$.textureHost&&$$.textureHost==$R&&$$.textureHost.alphaTexture==$R.alphaTexture;return $N=$uR.create(this,this._ib,$V,$c,$_R.create(1,0)),(this._submits[this._submits._length++]=$N).shaderValue.textureHost=$R,$N._renderType=10016,$N._preIsSameTextureShader=10016===this._curSubmit._renderType&&$t.ALPHA===$$.ALPHA&&$q,this._curSubmit=$N,$t.ALPHA=$p,$j;},$F.drawTextures=function($R,$F,$i,$j){if($R.loaded&&$R.bitmap&&$R.source){var $t=this._clipRect;if(this._clipRect=$G.MAXCLIPRECT,this._drawTextureM($R,$F[0],$F[1],$R.width,$R.height,$i,$j,null,1)){if(this._clipRect=$t,$Y.drawCall++,!($F.length<4)){for(var $p=this._curSubmit._vb||this._vb,$$=this._curMat.a,$V=this._curMat.d,$N=2,$c=$F.length;$N<$c;$N+=2)$aR.copyPreImgVb($p,($F[$N]-$F[$N-2])*$$,($F[$N+1]-$F[$N-1])*$V),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);}}else alert("drawTextures err");}else this.sprite&&$X.timer.callLater(this,this._repaintSprite);},$F._drawTextureM=function($R,$F,$i,$j,$t,$p,$$,$V,$N){if(!$R.loaded||!$R.source)return this.sprite&&$X.timer.callLater(this,this._repaintSprite),!1;var $c=this._curSubmit._vb||this._vb,$q=$R.bitmap;$F+=$p,$i+=$$,this._drawCount++;var $s=$q.id+this._shader2D.ALPHA*$N+10016;if($s!=this._renderKey){this._renderKey=$s;var $k=this._curSubmit.shaderValue,$h=this._shader2D,$S=$h.ALPHA;$h.ALPHA*=$N,$h.glTexture=$q;var $x=this._vb,$a=null,$m=$x._byteLength/32*3,$M=$k.textureHost&&$k.textureHost==$R&&$k.textureHost.alphaTexture==$R.alphaTexture;$a=$uR.create(this,this._ib,$x,$m,$_R.create(1,0)),(this._submits[this._submits._length++]=$a).shaderValue.textureHost=$R,$a._renderType=10016,$a._preIsSameTextureShader=10016===this._curSubmit._renderType&&$h.ALPHA===$k.ALPHA&&$M,this._curSubmit=$a,$c=this._curSubmit._vb||this._vb,$h.ALPHA=$S;}return!!$aR.fillRectImgVb($c,this._clipRect,$F,$i,$j||$R.width,$t||$R.height,$R.uv,$V||this._curMat,this._x,this._y,0,0)&&($O.enabled&&!this._isMain&&this._curSubmit.addTexture($R,($c._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0);},$F._repaintSprite=function(){this.sprite&&this.sprite.repaint();},$F._drawText=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){var $q=$R.bitmap;this._drawCount++;var $s=$q.id+this._shader2D.ALPHA+10016;if($s!=this._renderKey){this._renderKey=$s;var $k=this._curSubmit.shaderValue,$h=this._shader2D;$h.glTexture=$q;var $S=this._vb,$x=null,$a=$S._byteLength/32*3,$m=$k.textureHost&&$k.textureHost==$R&&$k.textureHost.alphaTexture==$R.alphaTexture;($x=$O.enabled?$uR.create(this,this._ib,$S,$a,$_R.create(1,0)):$uR.create(this,this._ib,$S,$a,$PR.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&$h.ALPHA===$k.ALPHA&&$m,(this._submits[this._submits._length++]=$x).shaderValue.textureHost=$R,$x._renderType=10016,this._curSubmit=$x;}$R.active();var $M=this._curSubmit._vb||this._vb;$aR.fillRectImgVb($M,this._clipRect,$F+$$,$i+$V,$j||$R.width,$t||$R.height,$R.uv,$p||this._curMat,this._x,this._y,$N,$c,!0)&&($O.enabled&&!this._isMain&&this._curSubmit.addTexture($R,($M._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle));},$F.drawTextureWithTransform=function($R,$F,$i,$j,$t,$p,$$,$V,$N){if($p){var $c=this._curMat,$q=this._x,$s=this._y;(0!==$$||0!==$V)&&(this._x=$$*$c.a+$V*$c.c,this._y=$V*$c.d+$$*$c.b),$p&&$c.bTransform?($T.mul($p,$c,$G._tmpMatrix),($p=$G._tmpMatrix)._checkTransform()):(this._x+=$c.tx,this._y+=$c.ty),this._drawTextureM($R,$F,$i,$j,$t,0,0,$p,$N),this._x=$q,this._y=$s;}else this._drawTextureM($R,$F,$i,$j,$t,$$,$V,null,$N);},$F.fillQuadrangle=function($R,$F,$i,$j,$t){var $p=this._curSubmit,$$=this._vb,$V=this._shader2D,$N=$p.shaderValue;if(this._renderKey=0,$R.bitmap){var $c=$R.bitmap;$V.glTexture==$c&&$V.ALPHA===$N.ALPHA||($V.glTexture=$c,($p=this._curSubmit=$pR.createSubmit(this,this._ib,$$,$$._byteLength/32*3,$_R.create(1,0))).shaderValue.glTexture=$c,this._submits[this._submits._length++]=$p),$aR.fillQuadrangleImgVb($$,$F,$i,$j,$R.uv,$t||this._curMat,this._x,this._y);}else $p.shaderValue.fillStyle&&$p.shaderValue.fillStyle.equal($R)&&$V.ALPHA===$N.ALPHA||($V.glTexture=null,($p=this._curSubmit=$pR.createSubmit(this,this._ib,$$,$$._byteLength/32*3,$_R.create(2,0))).shaderValue.defines.add(2),$p.shaderValue.fillStyle=$l.create($R),this._submits[this._submits._length++]=$p),$aR.fillQuadrangleImgVb($$,$F,$i,$j,$v.DEF_UV,$t||this._curMat,this._x,this._y);$p._numEle+=6;},$F.drawTexture2=function($R,$F,$i,$j,$t,$p,$$,$V){if(0!=$p){var $N=this._curMat;if(this._x=$R*$N.a+$F*$N.c,this._y=$F*$N.d+$R*$N.b,$t&&($t=$N.bTransform||$t.bTransform?($T.mul($t,$N,$G._tmpMatrix),$G._tmpMatrix):(this._x+=$t.tx+$N.tx,this._y+=$t.ty+$N.ty,$T.EMPTY)),1!==$p||$$){var $c=this._shader2D.ALPHA,$q=this._nBlendType;this._shader2D.ALPHA=$p,$$&&(this._nBlendType=$E.TOINT($$)),this._drawTextureM($V[0],$V[1]-$i,$V[2]-$j,$V[3],$V[4],0,0,$t,1),this._shader2D.ALPHA=$c,this._nBlendType=$q;}else this._drawTextureM($V[0],$V[1]-$i,$V[2]-$j,$V[3],$V[4],0,0,$t,1);this._x=this._y=0;}},$F.drawCanvas=function($R,$F,$i,$j,$t){var $p=$R.context;if(this._renderKey=0,$p._targets)this._submits[this._submits._length++]=$ZR.create($p,0,null),this._curSubmit=$pR.RENDERBASE,$p._targets.drawTo(this,$F,$i,$j,$t);else{var $$=this._submits[this._submits._length++]=$ZR.create($p,this._shader2D.ALPHA,this._shader2D.filters),$V=$j/$R.width,$N=$t/$R.height,$c=$$._matrix;this._curMat.copyTo($c),1!=$V&&1!=$N&&$c.scale($V,$N);var $q=$c.tx,$s=$c.ty;$c.tx=$c.ty=0,$c.transformPoint($g.TEMP.setTo($F,$i)),$c.translate($g.TEMP.x+$q,$g.TEMP.y+$s),this._curSubmit=$pR.RENDERBASE;}$H.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=$p._targets?"yellow":"green",this.strokeRect($F-1,$i-1,$j+2,$t+2,1),this.strokeRect($F,$i,$j,$t,1),this.restore());},$F.drawTarget=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){void 0===$c&&($c=-1);var $q=this._vb;if($aR.fillRectImgVb($q,this._clipRect,$F,$i,$j,$t,$N||$v.DEF_UV,$p||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var $s=this._curSubmit=$sR.create(this,this._ib,$q,($q._byteLength-64)/32*3,$V,$$);$s.blendType=-1==$c?this._nBlendType:$c,$s.scope=$R,this._submits[this._submits._length++]=$s,this._curSubmit._numEle+=6;}},$F.mixRGBandAlpha=function($R){return this._mixRGBandAlpha($R,this._shader2D.ALPHA);},$F._mixRGBandAlpha=function($R,$F){var $i=(4278190080&$R)>>>24;return 0!=$i?$i*=$F:$i=255*$F,16777215&$R|$i<<24;},$F.drawTriangles=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){if(!$R.loaded||!$R.source)return this.sprite&&$X.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;$R.bitmap;var $q=this._mixRGBandAlpha(4294967295,$V),$s=($j.length,$p.length);this._renderKey=-1;var $k=this._curSubmit=$uR.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,$_R.create(1,0));return $k.shaderValue.textureHost=$R,$k._renderType=10016,this._submits[this._submits._length++]=$k,$$?($G._tmpMatrix.a=$$.a,$G._tmpMatrix.b=$$.b,$G._tmpMatrix.c=$$.c,$G._tmpMatrix.d=$$.d,$G._tmpMatrix.tx=$$.tx+$F,$G._tmpMatrix.ty=$$.ty+$i,$T.mul($G._tmpMatrix,this._curMat,$G._tmpMatrix)):($G._tmpMatrix.a=this._curMat.a,$G._tmpMatrix.b=this._curMat.b,$G._tmpMatrix.c=this._curMat.c,$G._tmpMatrix.d=this._curMat.d,$G._tmpMatrix.tx=this._curMat.tx+$F,$G._tmpMatrix.ty=this._curMat.ty+$i),this._triangleMesh.addData($j,$t,$p,$G._tmpMatrix,$q,this),this._curSubmit._numEle+=$s,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0;},$F.transform=function($R,$F,$i,$j,$t,$p){$A.save(this),$T.mul($T.TEMP.setTo($R,$F,$i,$j,$t,$p),this._curMat,this._curMat),this._curMat._checkTransform();},$F.setTransformByMatrix=function($R){$R.copyTo(this._curMat);},$F.transformByMatrix=function($R){$A.save(this),$T.mul($R,this._curMat,this._curMat),this._curMat._checkTransform();},$F.rotate=function($R){$A.save(this),this._curMat.rotateEx($R);},$F.scale=function($R,$F){$A.save(this),this._curMat.scaleEx($R,$F);},$F.clipRect=function($R,$F,$i,$j){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var $t=$qR.create(4);this.addRenderObject($t);var $p=this._vb,$$=$p._byteLength>>2;if($aR.fillRectImgVb($p,null,$R,$F,$i,$j,$v.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var $V=this._curSubmit=$pR.createSubmit(this,this._ib,$p,($p._byteLength-64)/32*3,$_R.create(2,0));$V.shaderValue.ALPHA=1,this._submits[this._submits._length++]=$V,this._curSubmit._numEle+=6;}else alert("clipRect calc stencil rect error");var $N=$qR.create(5);this.addRenderObject($N);var $c=$p.getFloat32Array(),$q=Math.min(Math.min(Math.min($c[0+$$],$c[4+$$]),$c[8+$$]),$c[12+$$]),$s=Math.max(Math.max(Math.max($c[0+$$],$c[4+$$]),$c[8+$$]),$c[12+$$]),$k=Math.min(Math.min(Math.min($c[1+$$],$c[5+$$]),$c[9+$$]),$c[13+$$]),$h=Math.max(Math.max(Math.max($c[1+$$],$c[5+$$]),$c[9+$$]),$c[13+$$]);$C.save(this,$N,$R,$F,$i,$j,$q,$k,$s-$q,$h-$k),this._curSubmit=$pR.RENDERBASE;}else{$i*=this._curMat.a,$j*=this._curMat.d;var $S=$g.TEMP;this._curMat.transformPoint($S.setTo($R,$F)),$i<0&&($S.x=$S.x+$i,$i=-$i),$j<0&&($S.y=$S.y+$j,$j=-$j),this._renderKey=0;var $x=this._curSubmit=$cR.create(this);(this._submits[this._submits._length++]=$x).submitIndex=this._submits._length,$x.submitLength=9999999,$n.save(this,$x);var $a=this._clipRect,$m=$a.x,$M=$a.y,$J=$S.x+$i,$d=$S.y+$j;$m<$S.x&&($a.x=$S.x),$M<$S.y&&($a.y=$S.y),$a.width=Math.min($J,$m+$a.width)-$a.x,$a.height=Math.min($d,$M+$a.height)-$a.y,this._shader2D.glTexture=null,$x.clipRect.copyFrom($a),this._curSubmit=$pR.RENDERBASE;}},$F.setIBVB=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q){if(void 0===$N&&($N=0),void 0===$c&&($c=0),void 0===$q&&($q=0),null===$i){if($m.isFlash){var $s=$j;$s._selfIB||($s._selfIB=$IR.create(35044)),$s._selfIB.clear(),$i=$s._selfIB;}else $i=this._ib;$aR.expandIBQuadrangle($i,$j._byteLength/(4*$j.vertexStride*4));}if(!$V||!$$)throw Error("setIBVB must input:shader shaderValues");var $k=$NR.create(this,$j,$i,$t,$$,$V,$N,$c,$q);$p||($p=$T.EMPTY),$p.translate($R,$F),$T.mul($p,this._curMat,$k._mat),$p.translate(-$R,-$F),this._submits[this._submits._length++]=$k,this._curSubmit=$pR.RENDERBASE,this._renderKey=0;},$F.addRenderObject=function($R){this._submits[this._submits._length++]=$R;},$F.fillTrangles=function($R,$F,$i,$j,$t){var $p=this._curSubmit,$$=this._vb,$V=this._shader2D,$N=$p.shaderValue,$c=$j.length>>4,$q=$R.bitmap;this._renderKey=0,$V.glTexture==$q&&$V.ALPHA===$N.ALPHA||(($p=this._curSubmit=$pR.createSubmit(this,this._ib,$$,$$._byteLength/32*3,$_R.create(1,0))).shaderValue.textureHost=$R,this._submits[this._submits._length++]=$p),$aR.fillTranglesVB($$,$F,$i,$j,$t||this._curMat,this._x,this._y),$p._numEle+=6*$c;},$F.submitElement=function($R,$F){var $i=this._submits;for($F<0&&($F=$i._length);$R<$F;)$R+=$i[$R].renderSubmit();},$F.finish=function(){$dR.mainContext.finish();},$F.flush=function(){var $R=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if($R>this._ib.bufferLength/12&&$aR.expandIBQuadrangle(this._ib,$R),!this._isMain&&$O.enabled&&$O._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=$O._atlasRestore;for(var $F=this._submits,$i=0,$j=$F._length;$i<$j;$i++){var $t=$F[$i];10016===$t.getRenderType()&&$t.checkTexture();}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),$FR.instance&&$FR.getInstance().reset();var $p;for($i=0,$p=this.meshlist.length;$i<$p;$i++){var $$=this.meshlist[$i];$$.canReuse?$$.releaseMesh():$$.destroy();}return this.meshlist.length=0,this._curSubmit=$pR.RENDERBASE,this._renderKey=0,this._triangleMesh=$vR.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length;},$F.setPathId=function($R){if(this.mId=$R,-1!=this.mId){this.mHaveKey=!1;var $F=$e.getInstance();$F.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,$F.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0);}},$F.movePath=function($R,$F){var $i=$R,$j=$F;$R=this._curMat.a*$i+this._curMat.c*$j+this._curMat.tx,$F=this._curMat.b*$i+this._curMat.d*$j+this._curMat.ty,this.mX+=$R,this.mY+=$F;},$F.beginPath=function(){var $R=this._getPath();$R.tempArray.length=0,$R.closePath=!1,this.mX=0,this.mY=0;},$F.closePath=function(){this._path.closePath=!0;},$F.fill=function($R){void 0===$R&&($R=!1);var $F=this._getPath();this.drawPoly(0,0,$F.tempArray,this.fillStyle._color.numColor,0,0,$R);},$F.stroke=function(){var $R=this._getPath();if(0<this.lineWidth){if(-1==this.mId)$R.drawLine(0,0,$R.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var $F=$e.getInstance().shapeLineDic[this.mId];$F.rebuild($R.tempArray),$R.setGeomtry($F);}else $e.getInstance().addLine(this.mId,$R.drawLine(0,0,$R.tempArray,this.lineWidth,this.strokeStyle._color.numColor));$R.update();var $i=[this.mX,this.mY],$j=$pR.createShape(this,$R.ib,$R.vb,$R.count,$R.offset,$_R.create(4,0));$j.shaderValue.ALPHA=this._shader2D.ALPHA,$j.shaderValue.u_pos=$i,$j.shaderValue.u_mmat2=$MR.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=$j,this._renderKey=-1;}},$F.line=function($R,$F,$i,$j,$t,$p){var $$=this._curSubmit,$V=this._vb;if($aR.fillLineVb($V,this._clipRect,$R,$F,$i,$j,$t,$p)){this._renderKey=0;var $N=this._shader2D,$c=$$.shaderValue;$N.strokeStyle===$c.strokeStyle&&$N.ALPHA===$c.ALPHA||($N.glTexture=null,($$=this._curSubmit=$pR.createSubmit(this,this._ib,$V,($V._byteLength-64)/32*3,$_R.create(2,0))).shaderValue.strokeStyle=$N.strokeStyle,$$.shaderValue.mainID=2,$$.shaderValue.ALPHA=$N.ALPHA,this._submits[this._submits._length++]=$$),$$._numEle+=6;}},$F.moveTo=function($R,$F,$i){void 0===$i&&($i=!0);var $j=this._getPath();if($i){var $t=$R,$p=$F;$R=this._curMat.a*$t+this._curMat.c*$p,$F=this._curMat.b*$t+this._curMat.d*$p;}$j.addPoint($R,$F);},$F.lineTo=function($R,$F,$i){void 0===$i&&($i=!0);var $j=this._getPath();if($i){var $t=$R,$p=$F;$R=this._curMat.a*$t+this._curMat.c*$p,$F=this._curMat.b*$t+this._curMat.d*$p;}$j.addPoint($R,$F);},$F.drawCurves=function($R,$F,$i){this.setPathId(-1),this.beginPath(),this.strokeStyle=$i[3],this.lineWidth=$i[4];var $j=$i[2];$R+=$i[0],$F+=$i[1],this.movePath($R,$F),this.moveTo($j[0],$j[1]);for(var $t=2,$p=$j.length;$t<$p;)this.quadraticCurveTo($j[$t++],$j[$t++],$j[$t++],$j[$t++]);this.stroke();},$F.arcTo=function($R,$F,$i,$j,$t){if(-1==this.mId||!this.mHaveKey){var $p=0,$$=0,$V=0,$N=this._getPath();this._curMat.copyTo($G._tmpMatrix),$G._tmpMatrix.tx=$G._tmpMatrix.ty=0,$G._tempPoint.setTo($N.getEndPointX(),$N.getEndPointY()),$G._tmpMatrix.invertTransformPoint($G._tempPoint);var $c=$G._tempPoint.x-$R,$q=$G._tempPoint.y-$F,$s=Math.sqrt($c*$c+$q*$q);if(!($s<=1e-6)){var $k=$c/$s,$h=$q/$s,$S=$i-$R,$x=$j-$F,$a=$S*$S+$x*$x,$m=Math.sqrt($a);if(!($m<=1e-6)){var $M=$S/$m,$J=$x/$m,$d=$k+$M,$w=$h+$J,$X=Math.sqrt($d*$d+$w*$w);if(!($X<=1e-6)){var $H=$d/$X,$_=$w/$X,$T=Math.acos($H*$k+$_*$h),$g=Math.PI/2-$T,$B=($s=$t/Math.tan($g))*$k+$R,$z=$s*$h+$F,$L=Math.sqrt($s*$s+$t*$t),$Y=$R+$H*$L,$f=$F+$_*$L,$Z=0,$u=0;if(0<=$k*$J-$h*$M){var $v=2*$g/$G.SEGNUM;$Z=Math.sin($v),$u=Math.cos($v);}else $v=2*-$g/$G.SEGNUM,$Z=Math.sin($v),$u=Math.cos($v);$$=this._curMat.a*$B+this._curMat.c*$z,$V=this._curMat.b*$B+this._curMat.d*$z,$$==this._path.getEndPointX()&&$V==this._path.getEndPointY()||$N.addPoint($$,$V);var $K=$B-$Y,$e=$z-$f;for($p=0;$p<$G.SEGNUM;$p++){var $Q=$K*$u+$e*$Z,$b=-$K*$Z+$e*$u;$$=$Q+$Y,$V=$b+$f,$R=this._curMat.a*$$+this._curMat.c*$V,$V=$F=this._curMat.b*$$+this._curMat.d*$V,($$=$R)==this._path.getEndPointX()&&$V==this._path.getEndPointY()||$N.addPoint($$,$V),$K=$Q,$e=$b;}}}}}},$F.arc=function($R,$F,$i,$j,$t,$p,$$){if(void 0===$p&&($p=!1),void 0===$$&&($$=!0),-1!=this.mId){var $V=$e.getInstance().shapeDic[this.mId];if($V&&this.mHaveKey&&!$V.needUpdate(this._curMat))return;$F=$R=0;}var $N,$c=0,$q=0,$s=0,$k=0,$h=0,$S=0,$x=0;if($q=$t-$j,$p){if(Math.abs($q)>=2*Math.PI)$q=2*-Math.PI;else for(;0<$q;)$q-=2*Math.PI;}else if(Math.abs($q)>=2*Math.PI)$q=2*Math.PI;else for(;$q<0;)$q+=2*Math.PI;$N=$q/($x=$i<101?Math.max(10,$q*$i/5):$i<201?Math.max(10,$q*$i/20):Math.max(10,$q*$i/40))/2,$s=Math.abs(4/3*(1-Math.cos($N))/Math.sin($N)),$p&&($s=-$s);var $a=this._getPath(),$m=NaN,$M=NaN;for($S=0;$S<=$x;$S++)$c=$j+$q*($S/$x),$k=$R+Math.cos($c)*$i,$h=$F+Math.sin($c)*$i,$$&&($m=$k,$M=$h,$k=this._curMat.a*$m+this._curMat.c*$M,$h=this._curMat.b*$m+this._curMat.d*$M),$k==this._path.getEndPointX()&&$h==this._path.getEndPointY()||$a.addPoint($k,$h);$k=$R+Math.cos($t)*$i,$h=$F+Math.sin($t)*$i,$$&&($m=$k,$M=$h,$k=this._curMat.a*$m+this._curMat.c*$M,$h=this._curMat.b*$m+this._curMat.d*$M),$k==this._path.getEndPointX()&&$h==this._path.getEndPointY()||$a.addPoint($k,$h);},$F.quadraticCurveTo=function($R,$F,$i,$j){var $t=$s.I,$p=$i,$$=$j;$i=this._curMat.a*$p+this._curMat.c*$$,$j=this._curMat.b*$p+this._curMat.d*$$,$p=$R,$$=$F,$R=this._curMat.a*$p+this._curMat.c*$$,$F=this._curMat.b*$p+this._curMat.d*$$;for(var $V=$t.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),$R,$F,$i,$j],30,2),$N=0,$c=$V.length/2;$N<$c;$N++)this.lineTo($V[2*$N],$V[2*$N+1],!1);this.lineTo($i,$j,!1);},$F.rect=function($R,$F,$i,$j){this._other=this._other.make(),this._other.path||(this._other.path=new $W()),this._other.path.rect($R,$F,$i,$j);},$F.strokeRect=function($R,$F,$i,$j,$t){var $p=.5*$t;this.line($R-$p,$F,$R+$i+$p,$F,$t,this._curMat),this.line($R+$i,$F,$R+$i,$F+$j,$t,this._curMat),this.line($R,$F,$R,$F+$j,$t,this._curMat),this.line($R-$p,$F+$j,$R+$i+$p,$F+$j,$t,this._curMat);},$F.clip=function(){},$F.drawPoly=function($R,$F,$i,$j,$t,$p,$$){void 0===$$&&($$=!1),this._renderKey=0,this._shader2D.glTexture=null;var $V=this._getPath();if(-1==this.mId)$V.polygon($R,$F,$i,$j,$t||1,$p);else if(this.mHaveKey){var $N=$e.getInstance().shapeDic[this.mId];$N.setMatrix(this._curMat),$N.rebuild($V.tempArray),$V.setGeomtry($N);}else{var $c=$V.polygon($R,$F,$i,$j,$t||1,$p);$e.getInstance().addShape(this.mId,$c),$c.setMatrix(this._curMat);}$V.update();var $q,$s=[this.mX,this.mY];if(($q=$pR.createShape(this,$V.ib,$V.vb,$V.count,$V.offset,$_R.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$q.shaderValue.u_pos=$s,$q.shaderValue.u_mmat2=$MR.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$q,0<$t){if(this.mHaveLineKey){var $k=$e.getInstance().shapeLineDic[this.mId];$k.rebuild($V.tempArray),$V.setGeomtry($k);}else $e.getInstance().addShape(this.mId,$V.drawLine($R,$F,$i,$t,$p));$V.update(),($q=$pR.createShape(this,$V.ib,$V.vb,$V.count,$V.offset,$_R.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$q.shaderValue.u_mmat2=$MR.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$q;}},$F.drawParticle=function($R,$F,$i){$i.x=$R,$i.y=$F,this._submits[this._submits._length++]=$i;},$F._getPath=function(){return this._path||(this._path=new $W());},$j(0,$F,"globalCompositeOperation",function(){return $E.NAMES[this._nBlendType];},function($R){var $F=$E.TOINT[$R];null==$F||this._nBlendType===$F||($o.save(this,65536,this,!0),this._curSubmit=$pR.RENDERBASE,this._renderKey=0,this._nBlendType=$F);}),$j(0,$F,"strokeStyle",function(){return this._shader2D.strokeStyle;},function($R){this._shader2D.strokeStyle.equal($R)||($o.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=$l.create($R));}),$j(0,$F,"globalAlpha",function(){return this._shader2D.ALPHA;},function($R){($R=Math.floor(1e3*$R)/1e3)!=this._shader2D.ALPHA&&($o.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=$R);}),$j(0,$F,"asBitmap",null,function($R){if($R){if(this._targets||(this._targets=new $U()),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height);}else this._targets=null;}),$j(0,$F,"fillStyle",function(){return this._shader2D.fillStyle;},function($R){this._shader2D.fillStyle.equal($R)||($o.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=$l.create($R));}),$j(0,$F,"textAlign",function(){return this._other.textAlign;},function($R){this._other.textAlign===$R||(this._other=this._other.make(),$o.save(this,32768,this._other,!1),this._other.textAlign=$R);}),$j(0,$F,"lineWidth",function(){return this._other.lineWidth;},function($R){this._other.lineWidth===$R||(this._other=this._other.make(),$o.save(this,256,this._other,!1),this._other.lineWidth=$R);}),$j(0,$F,"textBaseline",function(){return this._other.textBaseline;},function($R){this._other.textBaseline===$R||(this._other=this._other.make(),$o.save(this,16384,this._other,!1),this._other.textBaseline=$R);}),$j(0,$F,"font",null,function($R){$R!=this._other.font.toString()&&(this._other=this._other.make(),$o.save(this,8,this._other,!1),this._other.font===$SR.EMPTY?this._other.font=new $SR($R):this._other.font.setFont($R));}),$G.__init__=function(){$i.DEFAULT=new $i();},$G._tempPoint=new $g(),$G._SUBMITVBSIZE=32e3,$G._MAXSIZE=99999999,$G._RECTVBSIZE=16,$G.MAXCLIPRECT=new $B(0,0,99999999,99999999),$G._COUNT=0,$G._tmpMatrix=new $T(),$G.SEGNUM=32,$G._contextcount=0,$$($G,["_fontTemp",function(){return this._fontTemp=new $SR();},"_drawStyleTemp",function(){return this._drawStyleTemp=new $l(null);}]),$G.__init$=function(){$i=function(){function $R(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=$SR.EMPTY;}$k($R,"");var $F=$R.prototype;return $F.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=$SR.EMPTY;},$F.make=function(){return this===$R.DEFAULT?new $R():this;},$R.DEFAULT=null,$R;}();},$G;}(),$_R=function($R){function $j($R,$F){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,$j.__super.call(this),this.defines=new $zR(),this.position=$j._POSITION,this.mainID=$R,this.subID=$F,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=$R|$F,this._inClassCache=$j._cache[this._cacheID],0<$R&&!this._inClassCache&&(this._inClassCache=$j._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear();}$k($j,"laya.webgl.shader.d2.value.Value2D",$b);var $F=$j.prototype;return $F.setValue=function($R){},$F.refresh=function(){var $R=this.size;return $R[0]=$MR.width,$R[1]=$MR.height,this.alpha=this.ALPHA*$MR.worldAlpha,this.mmat=$MR.worldMatrix4,this;},$F._ShaderWithCompile=function(){return $rR.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,$UR.create);},$F._withWorldShaderDefines=function(){var $R=$MR.worldShaderDefines,$F=$rR.sharders[this.mainID|this.defines._value|$R.getValue()];if(!$F){var $i,$j={};for($i in this.defines.toNameDic())$j[$i]="";for($i in $R.toNameDic())$j[$i]="";$F=$rR.withCompile2D(0,this.mainID,$j,this.mainID|this.defines._value|$R.getValue(),$UR.create);}var $t=$MR.worldFilters;if(!$t)return $F;for(var $p,$$=$t.length,$V=0;$V<$$;$V++)($p=$t[$V])&&$p.action.setValue(this);return $F;},$F.upload=function(){var $R=$MR;this.alpha=this.ALPHA*$R.worldAlpha,$MR.worldMatrix4!==$MR.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),$dR.shaderHighPrecision&&this.defines.add(1024);var $F,$i=$R.worldShaderDefines?this._withWorldShaderDefines():$rR.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=$R.width,this.size[1]=$R.height,this.mmat=$R.worldMatrix4,$KR.activeShader!==$i?$i._shaderValueWidth!==$R.width||$i._shaderValueHeight!==$R.height?($i._shaderValueWidth=$R.width,$i._shaderValueHeight=$R.height):$F=$i._params2dQuick2||$i._make2dQuick2():$i._shaderValueWidth!==$R.width||$i._shaderValueHeight!==$R.height?($i._shaderValueWidth=$R.width,$i._shaderValueHeight=$R.height):$F=$i._params2dQuick1||$i._make2dQuick1(),$i.upload(this,$F);},$F.setFilters=function($R){if(this.filters=$R)for(var $F,$i=$R.length,$j=0;$j<$i;$j++)($F=$R[$j])&&(this.defines.add($F.type),$F.action.setValue(this));},$F.clear=function(){this.defines.setValue(this.subID);},$F.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear();},$j._initone=function($R,$F){$j._typeClass[$R]=$F,$j._cache[$R]=[],$j._cache[$R]._length=0;},$j.__init__=function(){$j._POSITION=[2,5126,!1,4*$xR.BYTES_PE,0],$j._TEXCOORD=[2,5126,!1,4*$xR.BYTES_PE,2*$xR.BYTES_PE],$j._initone(2,$GR),$j._initone(4,$ER),$j._initone(256,$OR),$j._initone(512,$bR),$j._initone(1,$yR),$j._initone(65,$PR),$j._initone(9,$yR);},$j.create=function($R,$F){var $i=$j._cache[$R|$F];return $i._length?$i[--$i._length]:new $j._typeClass[$R|$F]($F);},$j._POSITION=null,$j._TEXCOORD=null,$j._cache=[],$j._typeClass=[],$j.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$j;}(),$TR=function($R){function $a($R,$F){$a.__super.call(this,$R,$F);}$k($a,"laya.webgl.utils.RenderSprite3D",$M);var $F=$a.prototype;return $F.onCreate=function($R){switch($R){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform);}},$F._mask=function($R,$F,$i,$j){var $t,$p,$$=this._next,$V=$R.mask;if($V){$F.ctx.save();var $N=$F.ctx.globalCompositeOperation,$c=new $B();if($c.copyFrom($V.getBounds()),$c.width=Math.round($c.width),$c.height=Math.round($c.height),$c.x=Math.round($c.x),$c.y=Math.round($c.y),0<$c.width&&0<$c.height){var $q=$R._style._tf,$s=$VR.create();$s.addValue("bounds",$c),$t=$$R.create([$s,$F],laya.webgl.utils.RenderSprite3D.tmpTarget),$F.addRenderObject($t),$V.render($F,-$c.x,-$c.y),$t=$$R.create([$s],laya.webgl.utils.RenderSprite3D.endTmpTarget),$F.addRenderObject($t),$F.ctx.save(),$F.clipRect($i-$q.translateX+$c.x,$j-$q.translateY+$c.y,$c.width,$c.height),$$._fun.call($$,$R,$F,$i,$j),$F.ctx.restore(),$p=$qR.create(6),$N=$F.ctx.globalCompositeOperation,$p.blendMode="mask",$F.addRenderObject($p),$T.TEMP.identity();var $k=$_R.create(1,0),$h=$v.INV_UV,$S=$c.width,$x=$c.height;($c.width<32||$c.height<32)&&(($h=$a.tempUV)[0]=0,$h[1]=0,$h[2]=32<=$c.width?1:$c.width/32,$h[3]=0,$h[4]=32<=$c.width?1:$c.width/32,$h[5]=32<=$c.height?1:$c.height/32,$h[6]=0,$h[7]=32<=$c.height?1:$c.height/32,$c.width=32<=$c.width?$c.width:32,$c.height=32<=$c.height?$c.height:32,$h[1]*=-1,$h[3]*=-1,$h[5]*=-1,$h[7]*=-1,$h[1]+=1,$h[3]+=1,$h[5]+=1,$h[7]+=1),$F.ctx.drawTarget($s,$i+$c.x-$q.translateX,$j+$c.y-$q.translateY,$S,$x,$T.TEMP,"tmpTarget",$k,$h,6),$t=$$R.create([$s],laya.webgl.utils.RenderSprite3D.recycleTarget),$F.addRenderObject($t),($p=$qR.create(6)).blendMode=$N,$F.addRenderObject($p);}$F.ctx.restore();}else $$._fun.call($$,$R,$F,$i,$j);},$F._blend=function($R,$F,$i,$j){var $t=$R._style,$p=this._next;$t.blendMode?($F.ctx.save(),$F.ctx.globalCompositeOperation=$t.blendMode,$p._fun.call($p,$R,$F,$i,$j),$F.ctx.restore()):$p._fun.call($p,$R,$F,$i,$j);},$F._transform=function($R,$F,$i,$j){var $t=$R.transform,$p=this._next;if($t&&$p!=$M.NORENDER){var $$=$F.ctx;$R._style;$t.tx=$i,$t.ty=$j;var $V=$$._getTransformMatrix(),$N=$V.clone();$T.mul($t,$V,$V),$V._checkTransform(),$t.tx=$t.ty=0,$p._fun.call($p,$R,$F,0,0),$N.copyTo($V),$N.destroy();}else $p._fun.call($p,$R,$F,$i,$j);},$a.tmpTarget=function($R,$F){var $i=$R.getValue("bounds"),$j=$eR.create($i.width,$i.height);$j.start(),$j.clear(0,0,0,0),$R.addValue("tmpTarget",$j);},$a.endTmpTarget=function($R){$R.getValue("tmpTarget").end();},$a.recycleTarget=function($R){$R.getValue("tmpTarget").recycle(),$R.recycle();},$$($a,["tempUV",function(){return this.tempUV=new Array(8);}]),$a;}(),$gR=function($R){function $F(){this.data=null,$F.__super.call(this);}$k($F,"laya.filters.webgl.ColorFilterActionGL",$Q);var $i=$F.prototype;return $X.imps($i,{"laya.filters.IFilterActionGL":!0}),$i.setValue=function($R){$R.colorMat=this.data._mat,$R.colorAlpha=this.data._alpha;},$i.apply3d=function($R,$F,$i,$j,$t){var $p=$R.getValue("bounds"),$$=$_R.create(1,0);$$.setFilters([this.data]);var $V=$T.TEMP;$V.identity(),$i.ctx.drawTarget($R,0,0,$p.width,$p.height,$V,"src",$$);},$F;}(),$BR=function($R){function $p($R,$F,$i,$j,$t){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,$p.__super.call(this,$R,$F,$t),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new $lR(),this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=$i,this._atlasCanvas.height=$j,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0;}$k($p,"laya.webgl.atlas.Atlaser",$G);var $F=$p.prototype;return $F.computeUVinAtlasTexture=function($R,$F,$i,$j){var $t=$O.atlasTextureWidth,$p=$O.atlasTextureHeight,$$=$i/$t,$V=$j/$p,$N=($i+$R.bitmap.width)/$t,$c=($j+$R.bitmap.height)/$p,$q=$R.bitmap.width/$t,$s=$R.bitmap.height/$p;$R.uv=[$$+$F[0]*$q,$V+$F[1]*$s,$N-(1-$F[2])*$q,$V+$F[3]*$s,$N-(1-$F[4])*$q,$c-(1-$F[5])*$s,$$+$F[6]*$q,$c-(1-$F[7])*$s];},$F.findBitmapIsExist=function($R){if($R instanceof laya.webgl.resource.WebGLImage){var $F=$R,$i=$F.url,$j=this._InAtlasWebGLImagesKey[$i||$F.id];if($j)return $j.offsetInfoID;}return-1;},$F.addToAtlasTexture=function($R,$F,$i){if($R instanceof laya.webgl.resource.WebGLImage){var $j=$R,$t=$j.url;this._InAtlasWebGLImagesKey[$t||$j.id]={bitmap:$R,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([$F,$i]);}this._atlasCanvas.texSubImage2D($F,$i,$R.atlasSource),$R.clearAtlasSource();},$F.addToAtlas=function($R,$F,$i){$R._atlasID=this._inAtlasTextureKey.length;var $j=$R.uv.slice(),$t=$R.bitmap;this._inAtlasTextureKey.push($R),this._inAtlasTextureOriUVValue.push($j),this._inAtlasTextureBitmapValue.push($t),this.computeUVinAtlasTexture($R,$j,$F,$i),$R.bitmap=this._atlasCanvas;},$F.clear=function(){for(var $R=0,$F=this._inAtlasTextureKey.length;$R<$F;$R++)this._inAtlasTextureKey[$R].bitmap=this._inAtlasTextureBitmapValue[$R],this._inAtlasTextureKey[$R].uv=this._inAtlasTextureOriUVValue[$R],this._inAtlasTextureKey[$R]._atlasID=-1,this._inAtlasTextureKey[$R].bitmap.lock=!1,this._inAtlasTextureKey[$R].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0;},$F.dispose=function(){this.clear(),this._atlasCanvas.destroy();},$j(0,$F,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue;}),$j(0,$F,"texture",function(){return this._atlasCanvas;}),$j(0,$F,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey;}),$p;}(),$zR=function($R){function $i(){$i.__super.call(this,$i.__name2int,$i.__int2name,$i.__int2nameMap);}return $k($i,"laya.webgl.shader.d2.ShaderDefines2D",$D),$i.__init__=function(){$i.reg("TEXTURE2D",1),$i.reg("COLOR2D",2),$i.reg("PRIMITIVE",4),$i.reg("GLOW_FILTER",8),$i.reg("BLUR_FILTER",16),$i.reg("COLOR_FILTER",32),$i.reg("COLOR_ADD",64),$i.reg("WORLDMAT",128),$i.reg("FILLTEXTURE",256),$i.reg("FSHIGHPRECISION",1024),$i.reg("TXTALPHA",2048),$i.reg("TXTCOMPRESS",4096);},$i.reg=function($R,$F){$D._reg($R,$F,$i.__name2int,$i.__int2name);},$i.toText=function($R,$F,$i){return $D._toText($R,$F,$i);},$i.toInt=function($R){return $D._toInt($R,$i.__name2int);},$i.TEXTURE2D=1,$i.COLOR2D=2,$i.PRIMITIVE=4,$i.FILTERGLOW=8,$i.FILTERBLUR=16,$i.FILTERCOLOR=32,$i.COLORADD=64,$i.WORLDMAT=128,$i.FILLTEXTURE=256,$i.SKINMESH=512,$i.SHADERDEFINE_FSHIGHPRECISION=1024,$i.TXTALPHA=2048,$i.TXTCOMPRESS=4096,$i.__name2int={},$i.__int2name=[],$i.__int2nameMap=[],$i;}(),$LR=(function($R){function $V($R,$F,$i,$j,$t,$p,$$){$V.__super.call(this,$R,$F,$i,$j,40,$t,$p,$$);}$k($V,"laya.webgl.shapes.Ellipse",$iR);}(),function($R){function $p($R,$F,$i,$j,$t){this._points=[],this.rebuild($i),$p.__super.call(this,$R,$F,0,0,0,$t,$j,$t,0);}$k($p,"laya.webgl.shapes.Line",$iR);var $F=$p.prototype;return $F.rebuild=function($R){var $F=$R.length;$F!=this._points.length&&(this.mUint16Array=new Uint16Array(6*($F/2-1)),this.mFloat32Array=new Float32Array(5*$F)),this._points.length=0;for(var $i=NaN,$j=NaN,$t=-1,$p=-1,$$=$R.length/2,$V=0;$V<$$;$V++)$i=$R[2*$V],$j=$R[2*$V+1],(.01<Math.abs($t-$i)||.01<Math.abs($p-$j))&&this._points.push($i,$j),$t=$i,$p=$j;},$F.getData=function($R,$F,$i){var $j=[],$t=[];0<this.borderWidth&&this.createLine2(this._points,$j,this.borderWidth,$i,$t,this._points.length/2),this.mUint16Array.set($j,0),this.mFloat32Array.set($t,0),$R.append(this.mUint16Array),$F.append(this.mFloat32Array);},$p;}()),$YR=function($R){function $s($R,$F,$i,$j,$t){this._points=[];for(var $p=NaN,$$=NaN,$V=-1,$N=-1,$c=$i.length/2-1,$q=0;$q<$c;$q++)$p=$i[2*$q],$$=$i[2*$q+1],(.01<Math.abs($V-$p)||.01<Math.abs($N-$$))&&this._points.push($p,$$),$V=$p,$N=$$;$p=$i[2*$c],$$=$i[2*$c+1],$V=this._points[0],$N=this._points[1],(.01<Math.abs($V-$p)||.01<Math.abs($N-$$))&&this._points.push($p,$$),$s.__super.call(this,$R,$F,0,0,this._points.length/2,0,$j,$t);}$k($s,"laya.webgl.shapes.LoopLine",$iR);var $F=$s.prototype;return $F.getData=function($R,$F,$i){if(0<this.borderWidth){for(var $j=this.color,$t=($j>>16&255)/255,$p=($j>>8&255)/255,$$=(255&$j)/255,$V=[],$N=0,$c=0,$q=[],$s=Math.floor(this._points.length/2),$k=0;$k<$s;$k++)$N=this._points[2*$k],$c=this._points[2*$k+1],$V.push(this.x+$N,this.y+$c,$t,$p,$$);this.createLoopLine($V,$q,this.borderWidth,$i+$V.length/5),$R.append(new Uint16Array($q)),$F.append(new Float32Array($V));}},$F.createLoopLine=function($R,$F,$i,$j,$t,$p){$R.length;var $$=$R.concat(),$V=$t||$R,$N=this.borderColor,$c=($N>>16&255)/255,$q=($N>>8&255)/255,$s=(255&$N)/255,$k=[$$[0],$$[1]],$h=[$$[$$.length-5],$$[$$.length-4]],$S=$h[0]+.5*($k[0]-$h[0]),$x=$h[1]+.5*($k[1]-$h[1]);$$.unshift($S,$x,0,0,0),$$.push($S,$x,0,0,0);var $a,$m,$M,$J,$d,$w,$X,$H,$_,$T,$g,$B,$z,$L,$Y,$f,$Z,$u,$v,$K,$e=$$.length/5,$Q=$j,$b=$i/2;$M=$$[0],$J=$$[1],$T=$M-($d=$$[5]),$_=($_=-($J-($w=$$[6])))/($K=Math.sqrt($_*$_+$T*$T))*$b,$T=$T/$K*$b,$V.push($M-$_,$J-$T,$c,$q,$s,$M+$_,$J+$T,$c,$q,$s);for(var $G=1;$G<$e-1;$G++)$M=$$[5*($G-1)],$J=$$[5*($G-1)+1],$d=$$[5*$G],$w=$$[5*$G+1],$X=$$[5*($G+1)],$H=$$[5*($G+1)+1],$T=$M-$d,$B=$d-$X,$Y=(-($_=($_=-($J-$w))/($K=Math.sqrt($_*$_+$T*$T))*$b)+$M)*(-($T=$T/$K*$b)+$w)-(-$_+$d)*(-$T+$J),$u=(-($g=($g=-($w-$H))/($K=Math.sqrt($g*$g+$B*$B))*$b)+$X)*(-($B=$B/$K*$b)+$w)-(-$g+$d)*(-$B+$H),$v=($z=-$T+$J-(-$T+$w))*($Z=-$g+$d-(-$g+$X))-($f=-$B+$H-(-$B+$w))*($L=-$_+$d-(-$_+$M)),Math.abs($v)<.1?($v+=10.1,$V.push($d-$_,$w-$T,$c,$q,$s,$d+$_,$w+$T,$c,$q,$s)):((($a=($L*$u-$Z*$Y)/$v)-$d)*($a-$d)+(($m=($f*$Y-$z*$u)/$v)-$w)+($m-$w),$V.push($a,$m,$c,$q,$s,$d-($a-$d),$w-($m-$w),$c,$q,$s));$p&&($F=$p);var $O=this.edges+1;for($G=1;$G<$O;$G++)$F.push($Q+2*($G-1),$Q+2*($G-1)+1,$Q+2*$G+1,$Q+2*$G+1,$Q+2*$G,$Q+2*($G-1));return $F.push($Q+2*($G-1),$Q+2*($G-1)+1,$Q+1,$Q+1,$Q,$Q+2*($G-1)),$V;},$s;}(),$fR=function($R){function $$($R,$F,$i,$j,$t,$p){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=$T.create(),this._points=$i.slice(0,$i.length),$$.__super.call(this,$R,$F,0,0,this._points.length/2,$j,$t,$p);}$k($$,"laya.webgl.shapes.Polygon",$iR);var $F=$$.prototype;return $F.rebuild=function($R){this._repaint||(this._points.length=0,this._points=this._points.concat($R));},$F.setMatrix=function($R){$R.copyTo(this._mat);},$F.needUpdate=function($R){return this._repaint=this._mat.a==$R.a&&this._mat.b==$R.b&&this._mat.c==$R.c&&this._mat.d==$R.d&&this._mat.tx==$R.tx&&this._mat.ty==$R.ty,!this._repaint;},$F.getData=function($R,$F,$i){var $j,$t=0,$p=this._points,$$=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=$i){for(this._start=$i,$j=[],$$=this.earcutTriangles.length,$t=0;$t<$$;$t++)$j.push(this.earcutTriangles[$t]+$i);this.mUint16Array=new Uint16Array($j);}}else{this._start=$i,$j=[];var $V=[],$N=[],$c=this.color,$q=($c>>16&255)/255,$s=($c>>8&255)/255,$k=(255&$c)/255;for($$=Math.floor($p.length/2),$t=0;$t<$$;$t++)$V.push(this.x+$p[2*$t],this.y+$p[2*$t+1],$q,$s,$k),$N.push(this.x+$p[2*$t],this.y+$p[2*$t+1]);for(this.earcutTriangles=$jR.earcut($N,null,2),$$=this.earcutTriangles.length,$t=0;$t<$$;$t++)$j.push(this.earcutTriangles[$t]+$i);this.mUint16Array=new Uint16Array($j),this.mFloat32Array=new Float32Array($V);}$R.append(this.mUint16Array),$F.append(this.mFloat32Array);},$$;}(),$ZR=function($R){function $p(){this._matrix=new $T(),this._matrix4=$xR.defaultMatrix4.concat(),$p.__super.call(this,1e4),this.shaderValue=new $_R(0,0);}$k($p,"laya.webgl.submit.SubmitCanvas",$pR);var $F=$p.prototype;return $F.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var $R=$MR.worldAlpha,$F=$MR.worldMatrix4,$i=$MR.worldMatrix,$j=$MR.worldFilters,$t=$MR.worldShaderDefines,$p=this.shaderValue,$$=this._matrix,$V=this._matrix4,$N=$T.TEMP;return $T.mul($$,$i,$N),$V[0]=$N.a,$V[1]=$N.b,$V[4]=$N.c,$V[5]=$N.d,$V[12]=$N.tx,$V[13]=$N.ty,$MR.worldMatrix=$N.clone(),$MR.worldMatrix4=$V,$MR.worldAlpha=$MR.worldAlpha*$p.alpha,$p.filters&&$p.filters.length&&($MR.worldFilters=$p.filters,$MR.worldShaderDefines=$p.defines),this._ctx_src.flush(),$MR.worldAlpha=$R,$MR.worldMatrix4=$F,$MR.worldMatrix.destroy(),$MR.worldMatrix=$i,$MR.worldFilters=$j,$MR.worldShaderDefines=$t,1;},$F.releaseRender=function(){var $R=$p._cache;this._ctx_src=null,$R[$R._length++]=this;},$F.getRenderType=function(){return 10003;},$p.create=function($R,$F,$i){var $j=$p._cache._length?$p._cache[--$p._cache._length]:new $p();$j._ctx_src=$R;var $t=$j.shaderValue;return $t.alpha=$F,$t.defines.setValue(0),$i&&$i.length&&$t.setFilters($i),$j;},$p._cache=(($p._cache=[])._length=0,$p._cache),$p;}(),$uR=function($R){function $c($R){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array(),this._texsID=new Array(),this._vbPos=new Array(),void 0===$R&&($R=1e4),$c.__super.call(this,$R);}$k($c,"laya.webgl.submit.SubmitTexture",$pR);var $F=$c.prototype;return $F.releaseRender=function(){var $R=$c._cache;($R[$R._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0;},$F.addTexture=function($R,$F){this._texsID[this._texs.length]=$R._uvID,this._texs.push($R),this._vbPos.push($F);},$F.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var $R=this.shaderValue.textureHost.bitmap;if(null!==$R)for(var $F=this._vb.getFloat32Array(),$i=0,$j=this._texs.length;$i<$j;$i++){var $t=this._texs[$i];$t.active();var $p=$t.uv;if(this._texsID[$i]!==$t._uvID){this._texsID[$i]=$t._uvID;var $$=this._vbPos[$i];$F[$$+2]=$p[0],$F[$$+3]=$p[1],$F[$$+6]=$p[2],$F[$$+7]=$p[3],$F[$$+10]=$p[4],$F[$$+11]=$p[5],$F[$$+14]=$p[6],$F[$$+15]=$p[7],this._vb.setNeedUpload();}$t.bitmap!==$R&&(this._isSameTexture=!1);}}},$F.renderSubmit=function(){if(0===this._numEle)return $c._shaderSet=!1,1;var $R=this.shaderValue.textureHost;if($R){var $F=$R.source;if(!$R.bitmap||!$F)return $c._shaderSet=!1,1;this.shaderValue.texture=$F,$R.alphaTexture&&$R.alphaTexture.source&&(this.shaderValue.texture1=$R.alphaTexture.source);}this._vb.bind_upload(this._ib);var $i=$dR.mainContext;if($E.activeBlendFunction!==this._blendFn&&($i.enable(3042),this._blendFn($i),$E.activeBlendFunction=this._blendFn),$Y.drawCall++,$Y.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&$KR.activeShader&&$c._shaderSet?($KR.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&$KR.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),$c._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var $j=$R.bitmap,$t=0,$p=$KR.activeShader,$$=0,$V=this._texs.length;$$<$V;$$++){var $N=this._texs[$$];$N.bitmap===$j&&$$+1!==$V||($p.uploadTexture2D($N.source),$i.drawElements(4,6*($$-$t+1),5123,this._startIdx+6*$t*$xR.BYTES_PIDX),$j=$N.bitmap,$t=$$);}else $i.drawElements(4,this._numEle,5123,this._startIdx);return 1;},$c.create=function($R,$F,$i,$j,$t){var $p=$c._cache._length?$c._cache[--$c._cache._length]:new $c();null==$i&&(($i=$p._selfVb||($p._selfVb=$DR.create(-1))).clear(),$j=0),$p._ib=$F,$p._vb=$i,$p._startIdx=$j*$xR.BYTES_PIDX,$p._numEle=0;var $$=$R._nBlendType;$p._blendFn=$R._targets?$E.targetFns[$$]:$E.fns[$$],$p.shaderValue=$t,$p.shaderValue.setValue($R._shader2D);var $V=$R._shader2D.filters;return $V&&$p.shaderValue.setFilters($V),$p;},$c._cache=(($c._cache=[])._length=0,$c._cache),$c._shaderSet=!0,$c;}(),$vR=function($R){function $m(){$m.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo);}$k($m,"laya.webgl.utils.MeshTexture",$mR);var $F=$m.prototype;return $F.addData=function($R,$F,$i,$j,$t,$p){for(var $$=$R.length/2,$V=this._vb.needSize($$*$m.const_stride)>>2,$N=this._vb.getFloat32Array(),$c=0,$q=0;$q<$$;$q++){var $s=$R[$c],$k=$R[$c+1],$h=$s*$j.a+$k*$j.c+$j.tx,$S=$s*$j.b+$k*$j.d+$j.ty;$N[$V++]=$h,$N[$V++]=$S,$N[$V++]=$F[$c],$N[$V++]=$F[$c+1],$c+=2;}this._vb.setNeedUpload();var $x=this.vertNum;if(0<$x){($$=$i.length)>$m.tmpIdx.length&&($m.tmpIdx=new Uint16Array($$));for(var $a=0;$a<$$;$a++)$m.tmpIdx[$a]=$i[$a]+$x;this._ib.appendU16Array($m.tmpIdx,$i.length);}else this._ib.append($i);this._ib.setNeedUpload(),this.vertNum+=$$,this.indexNum+=$i.length;},$F.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this);},$F.destroy=function(){this._ib.destroy(),this._vb.destroy();},$m.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new $m();},$m.const_stride=16,$m._POOL=[],$$($m,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8];},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4);}]),$m;}(),$KR=function($R){function $F(){$F.__super.call(this),this.lock=!0;}return $k($F,"laya.webgl.shader.BaseShader",$J),$F.activeShader=null,$F.bindShader=null,$F;}(),$eR=function($F){function $q($R,$F,$i,$j,$t,$p,$$,$V,$N){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===$i&&($i=6408),void 0===$j&&($j=5121),void 0===$t&&($t=34041),void 0===$p&&($p=!1),void 0===$$&&($$=!1),void 0===$V&&($V=-1),void 0===$N&&($N=-1),this._type=1,this._w=$R,this._h=$F,this._surfaceFormat=$i,this._surfaceType=$j,this._depthStencilFormat=$t,$m.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=$p,this._repeat=$$,this._minFifter=$V,this._magFifter=$N,this._createWebGLRenderTarget(),this.bitmap.lock=!0,$q.__super.call(this,this.bitmap,$v.INV_UV);}$k($q,"laya.webgl.resource.RenderTarget2D",$F);var $R=$q.prototype;return $X.imps($R,{"laya.resource.IDispose":!0}),$R.getType=function(){return this._type;},$R.getTexture=function(){return this;},$R.size=function($R,$F){this._w==$R&&this._h==$F||(this._w=$R,this._h=$F,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget());},$R.release=function(){this.destroy();},$R.recycle=function(){$q.POOL.push(this);},$R.start=function(){var $R=$dR.mainContext;return this._preRenderTarget=$MR.curRenderTarget,$MR.curRenderTarget=this,$R.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&($R.viewport(0,0,this._w,this._h),this._svWidth=$MR.width,this._svHeight=$MR.height,$MR.width=this._w,$MR.height=this._h,$KR.activeShader=null),this;},$R.clear=function($R,$F,$i,$j){void 0===$R&&($R=0),void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=1);var $t=$dR.mainContext;$t.clearColor($R,$F,$i,$j);var $p=16384;switch(this._depthStencilFormat){case 33189:$p|=256;break;case 36168:$p|=1024;break;case 34041:$p|=256,$p|=1024;}$t.clear($p);},$R.end=function(){var $R=$dR.mainContext;$R.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,$MR.curRenderTarget=this._preRenderTarget,1==this._type?($R.viewport(0,0,this._svWidth,this._svHeight),$MR.width=this._svWidth,$MR.height=this._svHeight,$KR.activeShader=null):$R.viewport(0,0,$X.stage.width,$X.stage.height);},$R.getData=function($R,$F,$i,$j){var $t=$dR.mainContext;if($t.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===$t.checkFramebufferStatus(36160)))return $t.bindFramebuffer(36160,null),null;var $p=new Uint8Array(this._w*this._h*4);return $t.readPixels($R,$F,$i,$j,this._surfaceFormat,this._surfaceType,$p),$t.bindFramebuffer(36160,null),$p;},$R.destroy=function($R){void 0===$R&&($R=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,$F.prototype.destroy.call(this));},$R.dispose=function(){},$R._createWebGLRenderTarget=function(){this.bitmap=new $nR(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function($R){this.event("recovered");});},$j(0,$R,"surfaceFormat",function(){return this._surfaceFormat;}),$j(0,$R,"magFifter",function(){return this._magFifter;}),$j(0,$R,"surfaceType",function(){return this._surfaceType;}),$j(0,$R,"mipMap",function(){return this._mipMap;}),$j(0,$R,"depthStencilFormat",function(){return this._depthStencilFormat;}),$j(0,$R,"minFifter",function(){return this._minFifter;}),$j(0,$R,"source",function(){return this._alreadyResolved?$X.superGet($v,this,"source"):null;}),$q.create=function($R,$F,$i,$j,$t,$p,$$,$V,$N){void 0===$i&&($i=6408),void 0===$j&&($j=5121),void 0===$t&&($t=34041),void 0===$p&&($p=!1),void 0===$$&&($$=!1),void 0===$V&&($V=-1),void 0===$N&&($N=-1);var $c=$q.POOL.pop();return $c||($c=new $q($R,$F)),$c.bitmap&&$c._w==$R&&$c._h==$F&&$c._surfaceFormat==$i&&$c._surfaceType==$j&&$c._depthStencilFormat==$t&&$c._mipMap==$p&&$c._repeat==$$&&$c._minFifter==$V&&$c._magFifter==$N||($c._w=$R,$c._h=$F,$c._surfaceFormat=$i,$c._surfaceType=$j,$c._depthStencilFormat=$t,$m.isConchWebGL&&34041===$c._depthStencilFormat&&($c._depthStencilFormat=33189),$c._mipMap=$p,$c._repeat=$$,$c._minFifter=$V,$c._magFifter=$N,$c.release(),$c._createWebGLRenderTarget()),$c;},$q.TYPE2D=1,$q.TYPE3D=2,$q.POOL=[],$q;}($v),$QR=function($R){function $F(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,$F.__super.call(this),$F._gl=$dR.mainContext;}$k($F,"laya.webgl.utils.Buffer",$J);var $i=$F.prototype;return $i._bind=function(){this.activeResource(),$F._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&($F._bindVertexBuffer=this._glBuffer),$F._gl.bindBuffer(this._bufferType,$F._bindActive[this._bufferType]=this._glBuffer),$KR.activeShader=null);},$i.recreateResource=function(){this._glBuffer||(this._glBuffer=$F._gl.createBuffer()),this.completeCreate();},$i.disposeResource=function(){this._glBuffer&&($dR.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0;},$j(0,$i,"bufferUsage",function(){return this._bufferUsage;}),$F._gl=null,$F._bindActive={},$F._bindVertexBuffer=null,$F._enableAtributes=[],$F;}(),$bR=function($R){function $i($R){this.texcoord=null,this.offsetX=300,this.offsetY=0,$i.__super.call(this,512,0);var $F=8*$xR.BYTES_PE;this.position=[2,5126,!1,$F,0],this.texcoord=[2,5126,!1,$F,2*$xR.BYTES_PE],this.color=[4,5126,!1,$F,4*$xR.BYTES_PE];}return $k($i,"laya.webgl.shader.d2.skinAnishader.SkinSV",$_R),$i;}(),$GR=function($R){function $F($R){$F.__super.call(this,2,0),this.color=[];}return $k($F,"laya.webgl.shader.d2.value.Color2dSV",$_R),$F.prototype.setValue=function($R){$R.fillStyle&&(this.color=$R.fillStyle._color._color),$R.strokeStyle&&(this.color=$R.strokeStyle._color._color);},$F;}(),$OR=function($R){function $F($R){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=$_R._TEXCOORD,$F.__super.call(this,256,0);}$k($F,"laya.webgl.shader.d2.value.FillTextureSV",$_R);var $i=$F.prototype;return $i.setValue=function($R){this.ALPHA=$R.ALPHA,$R.filters&&this.setFilters($R.filters);},$i.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0);},$F;}(),$yR=function($R){function $F($R){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=$_R._TEXCOORD,void 0===$R&&($R=0),$F.__super.call(this,1,$R);}$k($F,"laya.webgl.shader.d2.value.TextureSV",$_R);var $i=$F.prototype;return $i.setValue=function($R){this.ALPHA=$R.ALPHA,$R.filters&&this.setFilters($R.filters);},$i.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0);},$F;}(),$ER=function($R){function $F($R){this.a_color=null,this.u_pos=[0,0],$F.__super.call(this,4,0),this.position=[2,5126,!1,5*$xR.BYTES_PE,0],this.a_color=[3,5126,!1,5*$xR.BYTES_PE,2*$xR.BYTES_PE];}return $k($F,"laya.webgl.shader.d2.value.PrimitiveSV",$_R),$F;}(),$lR=function($R){function $F(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,$F.__super.call(this);}$k($F,"laya.webgl.atlas.AtlasWebGLCanvas",$R);var $i=$F.prototype;return $i.recreateResource=function(){var $R=$dR.mainContext,$F=this._source=$R.createTexture(),$i=$wR.curBindTexTarget,$j=$wR.curBindTexValue;$wR.bindTexture($R,3553,$F),$R.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),$R.texParameteri(3553,10241,9729),$R.texParameteri(3553,10240,9729),$R.texParameteri(3553,10242,33071),$R.texParameteri(3553,10243,33071),$i&&$j&&$wR.bindTexture($R,$i,$j),this.memorySize=this._w*this._h*4,this.completeCreate();},$i.disposeResource=function(){this._source&&($dR.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0);},$i.texSubImage2D=function($R,$F,$i){if($m.isFlash){this._flashCacheImage||(this._flashCacheImage=$x.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var $j=$i.bitmapdata;this._flashCacheImage._image.copyPixels($j,0,0,$j.width,$j.height,$R,$F),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0);}else{var $t=$dR.mainContext,$p=$wR.curBindTexTarget,$$=$wR.curBindTexValue;$wR.bindTexture($t,3553,this._source),$t.pixelStorei(37441,!0),0<=$R-1&&$t.texSubImage2D(3553,0,$R-1,$F,6408,5121,$i),$R+1<=this._w&&$t.texSubImage2D(3553,0,$R+1,$F,6408,5121,$i),0<=$F-1&&$t.texSubImage2D(3553,0,$R,$F-1,6408,5121,$i),$F+1<=this._h&&$t.texSubImage2D(3553,0,$R,$F+1,6408,5121,$i),$t.texSubImage2D(3553,0,$R,$F,6408,5121,$i),$t.pixelStorei(37441,!1),$p&&$$&&$wR.bindTexture($t,$p,$$);}},$i.texSubImage2DPixel=function($R,$F,$i,$j,$t){var $p=$dR.mainContext,$$=$wR.curBindTexTarget,$V=$wR.curBindTexValue;$wR.bindTexture($p,3553,this._source);var $N=new Uint8Array($t.data);$p.pixelStorei(37441,!0),$p.texSubImage2D(3553,0,$R,$F,$i,$j,6408,5121,$N),$p.pixelStorei(37441,!1),$$&&$V&&$wR.bindTexture($p,$$,$V);},$j(0,$i,"width",$R.prototype._$get_width,function($R){this._w=$R;}),$j(0,$i,"height",$R.prototype._$get_height,function($R){this._h=$R;}),$F;}($i),$WR=function($R){function $t(){this.flipY=!0,this.alwaysChange=!1,$t.__super.call(this);}$k($t,"laya.webgl.resource.WebGLCanvas",$i);var $F=$t.prototype;return $F.getCanvas=function(){return this._canvas;},$F.clear=function(){this._ctx&&this._ctx.clear();},$F.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this);},$F._setContext=function($R){this._ctx=$R;},$F.getContext=function($R,$F){return this._ctx?this._ctx:this._ctx=$t._createContext(this);},$F.size=function($R,$F){this._w==$R&&this._h==$F||(this._w=$R,this._h=$F,this._ctx&&this._ctx.size($R,$F),this._canvas&&(this._canvas.height=$F,this._canvas.width=$R));},$F.activeResource=function($R){void 0===$R&&($R=!1),this._source||this.recreateResource();},$F.recreateResource=function(){this.createWebGlTexture(),this.completeCreate();},$F.disposeResource=function(){this._source&&!this.iscpuSource&&($dR.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0);},$F.createWebGlTexture=function(){var $R=$dR.mainContext;this._canvas;var $F=this._source=$R.createTexture();this.iscpuSource=!1;var $i=$wR.curBindTexTarget,$j=$wR.curBindTexValue;$wR.bindTexture($R,3553,$F),$R.pixelStorei(37440,this.flipY?1:0),$t.premulAlpha&&$R.pixelStorei(37441,!0),$R.texImage2D(3553,0,6408,6408,5121,this._imgData),$t.premulAlpha&&$R.pixelStorei(37441,!1),$R.texParameteri(3553,10240,9729),$R.texParameteri(3553,10241,9729),$R.texParameteri(3553,10242,33071),$R.texParameteri(3553,10243,33071),$R.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,$i&&$j&&$wR.bindTexture($R,$i,$j);},$F.reloadCanvasData=function(){var $R=$dR.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var $F=$wR.curBindTexTarget,$i=$wR.curBindTexValue;$wR.bindTexture($R,3553,this._source),$t.premulAlpha&&$R.pixelStorei(37441,!0),$R.texImage2D(3553,0,6408,6408,5121,this._imgData),$t.premulAlpha&&$R.pixelStorei(37441,!1),$R.pixelStorei(37440,0),$F&&$i&&$wR.bindTexture($R,$F,$i);},$F.texSubImage2D=function($R,$F,$i){var $j=$dR.mainContext,$t=$wR.curBindTexTarget,$p=$wR.curBindTexValue;$wR.bindTexture($j,3553,this._source),$j.pixelStorei(37441,!0),$j.texSubImage2D(3553,0,$F,$i,6408,5121,$R._source),$j.pixelStorei(37441,!1),$t&&$p&&$wR.bindTexture($j,$t,$p);},$F.toBase64=function($R,$F,$i){var $j=null;this._canvas&&($j=this._canvas.toDataURL($R,$F)),$i.call(this,$j);},$j(0,$F,"context",function(){return this._ctx;}),$j(0,$F,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source;}),$j(0,$F,"asBitmap",null,function($R){this._ctx&&(this._ctx.asBitmap=$R);}),$t._createContext=null,$t.premulAlpha=!1,$t;}(),$oR=function($R){function $p($R,$F){this.CborderSize=12,$p.__super.call(this),this.char=$R,this.isSpace=" "===$R,this.xs=$F.scaleX,this.ys=$F.scaleY,this.font=$F.font.toString(),this.fontSize=$F.font.size,this.fillColor=$F.fillColor,this.borderColor=$F.borderColor,this.lineWidth=$F.lineWidth,this.underLine=$F.underLine;var $i,$j=$m.isConchApp;$j?(($i=ConchTextCanvas)._source=ConchTextCanvas,$i._source.canvas=ConchTextCanvas):$i=$h.canvas.source,this.canvas=$i,this._enableMerageInAtlas=!0,this._ctx=$j?$i:this.canvas.getContext("2d",void 0);var $t=$K.measureText(this.char,this.font);this.cw=$t.width*this.xs,this.ch=($t.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new $v(this);}$k($p,"laya.webgl.resource.WebGLCharImage",$i);var $F=$p.prototype;return $X.imps($F,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$F.active=function(){this.texture.active();},$F.recreateResource=function(){var $R=$m.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),$R){var $F=this.fontSize;1==this.xs&&1==this.ys||($F=parseInt($F*(this.xs>this.ys?this.xs:this.ys)+""));var $i="normal 100 "+this.font;$i=$i.replace($p._fontSizeReg,$F),this.borderColor&&($i+=" 1 "+this.borderColor),this._ctx.font=$i,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null);}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,$u.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var $j=this._ctx.measureText(this.char);$j||($j={width:16});var $t=$j.width+1;this._ctx.lineTo($t,this.fontSize+1),this._ctx.stroke();}this._ctx.restore();}this.borderSize=this.CborderSize,this.completeCreate();},$F.onresize=function($R,$F){this._w=$R,this._h=$F,this._allowMerageInAtlas=!0;},$F.clearAtlasSource=function(){},$j(0,$F,"allowMerageInAtlas",function(){return this._allowMerageInAtlas;}),$j(0,$F,"atlasSource",function(){return this.canvas;}),$j(0,$F,"enableMerageInAtlas",function(){return this._enableMerageInAtlas;},function($R){this._enableMerageInAtlas=$R;}),$p.createOneChar=function($R,$F){return new $p($R,$F);},$p._fontSizeReg=new RegExp("\\d+(?=px)","g"),$p;}(),$nR=function($R){function $c($R,$F,$i,$j,$t,$p,$$,$V,$N){void 0===$i&&($i=6408),void 0===$j&&($j=5121),void 0===$t&&($t=34041),void 0===$p&&($p=!1),void 0===$$&&($$=!1),void 0===$V&&($V=-1),void 0===$N&&($N=1),$c.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=$R,this._h=$F,this._surfaceFormat=$i,this._surfaceType=$j,this._depthStencilFormat=$t,this._mipMap=$p,this._repeat=$$,this._minFifter=$V,this._magFifter=$N;}$k($c,"laya.webgl.resource.WebGLRenderTarget",$i);var $F=$c.prototype;return $F.recreateResource=function(){var $R=$dR.mainContext;this._frameBuffer||(this._frameBuffer=$R.createFramebuffer()),this._source||(this._source=$R.createTexture());var $F=$wR.curBindTexTarget,$i=$wR.curBindTexValue;$wR.bindTexture($R,3553,this._source),$R.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var $j=this._minFifter,$t=this._magFifter,$p=this._repeat?10497:33071,$$=$q.isPOT(this._w,this._h);if($$?(this._mipMap?-1!==$j||($j=9987):-1!==$j||($j=9729),-1!==$t||($t=9729),$R.texParameteri(3553,10241,$j),$R.texParameteri(3553,10240,$t),$R.texParameteri(3553,10242,$p),$R.texParameteri(3553,10243,$p),this._mipMap&&$R.generateMipmap(3553)):(-1!==$j||($j=9729),-1!==$t||($t=9729),$R.texParameteri(3553,10241,$j),$R.texParameteri(3553,10240,$t),$R.texParameteri(3553,10242,33071),$R.texParameteri(3553,10243,33071)),$R.bindFramebuffer(36160,this._frameBuffer),$R.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=$R.createRenderbuffer()),$R.bindRenderbuffer(36161,this._depthStencilBuffer),$R.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:$R.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$R.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$R.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer);}$R.bindFramebuffer(36160,null),$F&&$i&&$wR.bindTexture($R,$F,$i),$R.bindRenderbuffer(36161,null),$$&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate();},$F.disposeResource=function(){this._frameBuffer&&($dR.mainContext.deleteTexture(this._source),$dR.mainContext.deleteFramebuffer(this._frameBuffer),$dR.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null);},$j(0,$F,"depthStencilBuffer",function(){return this._depthStencilBuffer;}),$j(0,$F,"frameBuffer",function(){return this._frameBuffer;}),$c;}(),$CR=function($R){function $V($R,$F,$i,$j,$t,$p,$$){this.offsetX=0,this.offsetY=0,$V.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=$p,this.canvas=$R,this._ctx=$R.getContext("2d",void 0),this._w=$j,this._h=$t,this.offsetX=$F,this.offsetY=$i,this.src=$$,this._enableMerageInAtlas=!0,$O.enabled&&this._w<$O.atlasLimitWidth&&this._h<$O.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1;}$k($V,"laya.webgl.resource.WebGLSubImage",$i);var $F=$V.prototype;return $X.imps($F,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$F.size=function($R,$F){this._w=$R,this._h=$F,this._ctx&&this._ctx.size($R,$F),this.canvas&&(this.canvas.height=$F,this.canvas.width=$R);},$F.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate();},$F.createWebGlTexture=function(){var $R=$dR.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var $F=this._source=$R.createTexture(),$i=$wR.curBindTexTarget,$j=$wR.curBindTexValue;$wR.bindTexture($R,3553,$F),$R.pixelStorei(37441,!0),$R.texImage2D(3553,0,6408,6408,5121,this.canvas),$R.pixelStorei(37441,!1);var $t=this.minFifter,$p=this.magFifter,$$=this.repeat?10497:33071,$V=$q.isPOT(this.width,this.height);$V?(this.mipmap?-1!==$t||($t=9987):-1!==$t||($t=9729),-1!==$p||($p=9729),$R.texParameteri(3553,10240,$p),$R.texParameteri(3553,10241,$t),$R.texParameteri(3553,10242,$$),$R.texParameteri(3553,10243,$$),this.mipmap&&$R.generateMipmap(3553)):(-1!==$t||($t=9729),-1!==$p||($p=9729),$R.texParameteri(3553,10241,$t),$R.texParameteri(3553,10240,$p),$R.texParameteri(3553,10242,33071),$R.texParameteri(3553,10243,33071)),$i&&$j&&$wR.bindTexture($R,$i,$j),this.canvas=null,$V&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4;},$F.disposeResource=function(){$O.enabled&&this._allowMerageInAtlas||!this._source||($dR.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0);},$F.clearAtlasSource=function(){},$j(0,$F,"allowMerageInAtlas",function(){return this._allowMerageInAtlas;}),$j(0,$F,"atlasSource",function(){return this.canvas;}),$j(0,$F,"enableMerageInAtlas",function(){return this._allowMerageInAtlas;},function($R){this._allowMerageInAtlas=$R;}),$V;}(),$rR=function($R){function $c($R,$F,$i,$j){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,$c.__super.call(this),!$R||!$F)throw"Shader Error";this._id=++$c._count,this._vs=$R,this._ps=$F,this._nameMap=$j||{},null!=$i&&($c.sharders[$i]=this);}$k($c,"laya.webgl.shader.Shader",$KR);var $F=$c.prototype;return $F.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0;},$F.disposeResource=function(){$dR.mainContext.deleteShader(this._vshader),$dR.mainContext.deleteShader(this._pshader),$dR.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0;},$F._compile=function(){if(!$dR.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var $R=[this._vs,this._ps],$F=$dR.mainContext;if(this._program=$F.createProgram(),this._vshader=$c._createShader($F,$R[0],35633),this._pshader=$c._createShader($F,$R[1],35632),$F.attachShader(this._program,this._vshader),$F.attachShader(this._program,this._pshader),$F.linkProgram(this._program),!$m.isConchApp&&!$F.getProgramParameter(this._program,35714))throw $F.getProgramInfoLog(this._program);var $i,$j,$t=0,$p=0;for($p=$m.isConchApp?$F.getProgramParameterEx(this._vs,this._ps,"",35721):$F.getProgramParameter(this._program,35721),$t=0;$t<$p;$t++){var $$=null;$i={vartype:"attribute",glfun:null,ivartype:0,attrib:$$=$m.isConchApp?$F.getActiveAttribEx(this._vs,this._ps,"",$t):$F.getActiveAttrib(this._program,$t),location:$F.getAttribLocation(this._program,$$.name),name:$$.name,type:$$.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push($i);}var $V=0;for($V=$m.isConchApp?$F.getProgramParameterEx(this._vs,this._ps,"",35718):$F.getProgramParameter(this._program,35718),$t=0;$t<$V;$t++){var $N=null;$N=$m.isConchApp?$F.getActiveUniformEx(this._vs,this._ps,"",$t):$F.getActiveUniform(this._program,$t),0<($i={vartype:"uniform",glfun:null,ivartype:1,attrib:$$,location:$F.getUniformLocation(this._program,$N.name),name:$N.name,type:$N.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($i.name=$i.name.substr(0,$i.name.length-3),$i.isArray=!0,$i.location=$F.getUniformLocation(this._program,$i.name)),this._params.push($i);}for($t=0,$j=this._params.length;$t<$j;$t++)if(($i=this._params[$t]).indexOfParams=$t,$i.index=1,$i.value=[$i.location,null],$i.codename=$i.name,$i.name=this._nameMap[$i.codename]?this._nameMap[$i.codename]:$i.codename,(this._paramsMap[$i.name]=$i)._this=this,$i.uploadedValue=[],"attribute"!==$i.vartype)switch($i.type){case 5124:$i.fun=$i.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$i.fun=$i.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$i.fun=$i.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$i.fun=$i.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$i.fun=$i.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$i.fun=this._uniform_sampler2D;break;case 35680:$i.fun=this._uniform_samplerCube;break;case 35676:$i.glfun=$F.uniformMatrix4fv,$i.fun=this._uniformMatrix4fv;break;case 35670:$i.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!");}else $i.fun=this._attribute;}},$F.getUniform=function($R){return this._paramsMap[$R];},$F._attribute=function($R,$F){var $i=$dR.mainContext,$j=$QR._enableAtributes,$t=$R.location;return $j[$t]||$i.enableVertexAttribArray($t),$i.vertexAttribPointer($t,$F[0],$F[1],$F[2],$F[3],$F[4]+this._offset),$j[$t]=$QR._bindVertexBuffer,1;},$F._uniform1f=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F?($dR.mainContext.uniform1f($R.location,$i[0]=$F),1):0;},$F._uniform1fv=function($R,$F){if($F.length<4){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]||$i[2]!==$F[2]||$i[3]!==$F[3]?($dR.mainContext.uniform1fv($R.location,$F),$i[0]=$F[0],$i[1]=$F[1],$i[2]=$F[2],$i[3]=$F[3],1):0;}return $dR.mainContext.uniform1fv($R.location,$F),1;},$F._uniform_vec2=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]?($dR.mainContext.uniform2f($R.location,$i[0]=$F[0],$i[1]=$F[1]),1):0;},$F._uniform_vec2v=function($R,$F){if($F.length<2){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]||$i[2]!==$F[2]||$i[3]!==$F[3]?($dR.mainContext.uniform2fv($R.location,$F),$i[0]=$F[0],$i[1]=$F[1],$i[2]=$F[2],$i[3]=$F[3],1):0;}return $dR.mainContext.uniform2fv($R.location,$F),1;},$F._uniform_vec3=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]||$i[2]!==$F[2]?($dR.mainContext.uniform3f($R.location,$i[0]=$F[0],$i[1]=$F[1],$i[2]=$F[2]),1):0;},$F._uniform_vec3v=function($R,$F){return $dR.mainContext.uniform3fv($R.location,$F),1;},$F._uniform_vec4=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]||$i[2]!==$F[2]||$i[3]!==$F[3]?($dR.mainContext.uniform4f($R.location,$i[0]=$F[0],$i[1]=$F[1],$i[2]=$F[2],$i[3]=$F[3]),1):0;},$F._uniform_vec4v=function($R,$F){return $dR.mainContext.uniform4fv($R.location,$F),1;},$F._uniformMatrix2fv=function($R,$F){return $dR.mainContext.uniformMatrix2fv($R.location,!1,$F),1;},$F._uniformMatrix3fv=function($R,$F){return $dR.mainContext.uniformMatrix3fv($R.location,!1,$F),1;},$F._uniformMatrix4fv=function($R,$F){return $dR.mainContext.uniformMatrix4fv($R.location,!1,$F),1;},$F._uniform1i=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F?($dR.mainContext.uniform1i($R.location,$i[0]=$F),1):0;},$F._uniform1iv=function($R,$F){return $dR.mainContext.uniform1iv($R.location,$F),1;},$F._uniform_ivec2=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]?($dR.mainContext.uniform2i($R.location,$i[0]=$F[0],$i[1]=$F[1]),1):0;},$F._uniform_ivec2v=function($R,$F){return $dR.mainContext.uniform2iv($R.location,$F),1;},$F._uniform_vec3i=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]||$i[2]!==$F[2]?($dR.mainContext.uniform3i($R.location,$i[0]=$F[0],$i[1]=$F[1],$i[2]=$F[2]),1):0;},$F._uniform_vec3vi=function($R,$F){return $dR.mainContext.uniform3iv($R.location,$F),1;},$F._uniform_vec4i=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]||$i[2]!==$F[2]||$i[3]!==$F[3]?($dR.mainContext.uniform4i($R.location,$i[0]=$F[0],$i[1]=$F[1],$i[2]=$F[2],$i[3]=$F[3]),1):0;},$F._uniform_vec4vi=function($R,$F){return $dR.mainContext.uniform4iv($R.location,$F),1;},$F._uniform_sampler2D=function($R,$F){var $i=$dR.mainContext,$j=$R.uploadedValue;return null==$j[0]?($j[0]=this._curActTexIndex,$i.uniform1i($R.location,this._curActTexIndex),$i.activeTexture($c._TEXTURES[this._curActTexIndex]),$wR.bindTexture($i,3553,$F),this._curActTexIndex++,1):($i.activeTexture($c._TEXTURES[$j[0]]),$wR.bindTexture($i,3553,$F),0);},$F._uniform_samplerCube=function($R,$F){var $i=$dR.mainContext,$j=$R.uploadedValue;return null==$j[0]?($j[0]=this._curActTexIndex,$i.uniform1i($R.location,this._curActTexIndex),$i.activeTexture($c._TEXTURES[this._curActTexIndex]),$wR.bindTexture($i,34067,$F),this._curActTexIndex++,1):($i.activeTexture($c._TEXTURES[$j[0]]),$wR.bindTexture($i,34067,$F),0);},$F._noSetValue=function($R){console.log("no....:"+$R.name);},$F.uploadOne=function($R,$F){this.activeResource(),$wR.UseProgram(this._program);var $i=this._paramsMap[$R];$i.fun.call(this,$i,$F);},$F.uploadTexture2D=function($R){$Y.shaderCall++;var $F=$dR.mainContext;$F.activeTexture(33984),$wR.bindTexture($F,3553,$R);},$F.uploadTexture2D1=function($R){$Y.shaderCall++;var $F=$dR.mainContext;$F.activeTexture(33985),$wR.bindTexture($F,3553,$R);},$F.upload=function($R,$F){$KR.activeShader=$KR.bindShader=this,this._lastUseFrameCount===$Y.loopCount||this.activeResource(),$wR.UseProgram(this._program),this._reCompile?($F=this._params,this._reCompile=!1):$F=$F||this._params;$dR.mainContext;for(var $i,$j,$t=$F.length,$p=0,$$=0;$$<$t;$$++)null!==($j=$R[($i=$F[$$]).name])&&($p+=$i.fun.call(this,$i,$j));$Y.shaderCall+=$p;},$F.uploadArray=function($R,$F,$i){$KR.activeShader=this,($KR.bindShader=this).activeResource(),$wR.UseProgram(this._program);this._params;for(var $j,$t,$p=0,$$=$F-2;0<=$$;$$-=2)($t=this._paramsMap[$R[$$]])&&null!=($j=$R[$$+1])&&($i&&$i[$t.name]&&$i[$t.name].bind(),$p+=$t.fun.call(this,$t,$j));$Y.shaderCall+=$p;},$F.getParams=function(){return this._params;},$c.getShader=function($R){return $c.sharders[$R];},$c.create=function($R,$F,$i,$j){return new $c($R,$F,$i,$j);},$c.withCompile=function($R,$F,$i,$j){if($i&&$c.sharders[$i])return $c.sharders[$i];var $t=$c._preCompileShader[2e-4*$R];if(!$t)throw new Error("withCompile shader err!"+$R);return $t.createShader($F,$i,$j);},$c.withCompile2D=function($R,$F,$i,$j,$t){if($j&&$c.sharders[$j])return $c.sharders[$j];var $p=$c._preCompileShader[2e-4*$R+$F];if(!$p)throw new Error("withCompile shader err!"+$R+" "+$F);return $p.createShader($i,$j,$t);},$c.addInclude=function($R,$F){$JR.addInclude($R,$F);},$c.preCompile=function($R,$F,$i,$j){var $t=2e-4*$R;$c._preCompileShader[$t]=new $JR($t,$F,$i,$j);},$c.preCompile2D=function($R,$F,$i,$j,$t){var $p=2e-4*$R+$F;$c._preCompileShader[$p]=new $JR($p,$i,$j,$t);},$c._createShader=function($R,$F,$i){var $j=$R.createShader($i);return $R.shaderSource($j,$F),$R.compileShader($j),$j;},$c._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],$c._count=0,$c._preCompileShader={},$c.SHADERNAME2ID=2e-4,$c.sharders=(($c.sharders=[]).length=32,$c.sharders),$$($c,["nameKey",function(){return this.nameKey=new $f();}]),$c;}(),$AR=function($R){function $F(){this._maxsize=0,this._upload=!0,this._uploadSize=0,$F.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id;}$k($F,"laya.webgl.utils.Buffer2D",$R);var $i=$F.prototype;return $i.needSize=function($R){var $F=this._byteLength;if($R){var $i=this._byteLength+$R;$i<=this._buffer.byteLength||this._resizeBuffer($i<<1,!0),this._byteLength=$i;}return $F;},$i._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),$Y.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$QR._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$QR._gl.bufferSubData(this._bufferType,0,this._buffer);},$i._bufferSubData=function($R,$F,$i){if(void 0===$R&&($R=0),void 0===$F&&($F=0),void 0===$i&&($i=0),this._maxsize=Math.max(this._maxsize,this._byteLength),$Y.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$QR._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$F||$i){var $j=this._buffer.slice($F,$i);$QR._gl.bufferSubData(this._bufferType,$R,$j);}else $QR._gl.bufferSubData(this._bufferType,$R,this._buffer);},$i._checkArrayUse=function(){},$i._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0);},$i._bind_subUpload=function($R,$F,$i){return void 0===$R&&($R=0),void 0===$F&&($F=0),void 0===$i&&($i=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData($R,$F,$i),!0);},$i._resizeBuffer=function($R,$F){if($R<this._buffer.byteLength)return this;if(this.memorySize=$R,$F&&this._buffer&&0<this._buffer.byteLength){var $i=new ArrayBuffer($R);new Uint8Array($i).set(new Uint8Array(this._buffer),0),this._buffer=$i;}else this._buffer=new ArrayBuffer($R);return this._checkArrayUse(),this._upload=!0,this;},$i.append=function($R){this._upload=!0;var $F,$i;$F=$R.byteLength,$R instanceof Uint8Array?(this._resizeBuffer(this._byteLength+$F,!0),$i=new Uint8Array(this._buffer,this._byteLength)):$R instanceof Uint16Array?(this._resizeBuffer(this._byteLength+$F,!0),$i=new Uint16Array(this._buffer,this._byteLength)):$R instanceof Float32Array&&(this._resizeBuffer(this._byteLength+$F,!0),$i=new Float32Array(this._buffer,this._byteLength)),$i.set($R,0),this._byteLength+=$F,this._checkArrayUse();},$i.appendU16Array=function($R,$F){this._resizeBuffer(this._byteLength+2*$F,!0);for(var $i=new Uint16Array(this._buffer,this._byteLength,$F),$j=0;$j<$F;$j++)$i[$j]=$R[$j];this._byteLength+=2*$F,this._checkArrayUse();},$i.appendEx=function($R,$F){this._upload=!0;var $i;$i=$R.byteLength,this._resizeBuffer(this._byteLength+$i,!0),new $F(this._buffer,this._byteLength).set($R,0),this._byteLength+=$i,this._checkArrayUse();},$i.appendEx2=function($R,$F,$i,$j){void 0===$j&&($j=1),this._upload=!0;var $t,$p;$t=$i*$j,this._resizeBuffer(this._byteLength+$t,!0),$p=new $F(this._buffer,this._byteLength);var $$=0;for($$=0;$$<$i;$$++)$p[$$]=$R[$$];this._byteLength+=$t,this._checkArrayUse();},$i.getBuffer=function(){return this._buffer;},$i.setNeedUpload=function(){this._upload=!0;},$i.getNeedUpload=function(){return this._upload;},$i.upload=function(){var $R=this._bind_upload();return $QR._gl.bindBuffer(this._bufferType,null),$QR._bindActive[this._bufferType]=null,$KR.activeShader=null,$R;},$i.subUpload=function($R,$F,$i){void 0===$R&&($R=0),void 0===$F&&($F=0),void 0===$i&&($i=0);var $j=this._bind_subUpload();return $QR._gl.bindBuffer(this._bufferType,null),$QR._bindActive[this._bufferType]=null,$KR.activeShader=null,$j;},$i.disposeResource=function(){$R.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0;},$i.clear=function(){this._byteLength=0,this._upload=!0;},$j(0,$i,"bufferLength",function(){return this._buffer.byteLength;}),$j(0,$i,"byteLength",null,function($R){this._byteLength!==$R&&($R<=this._buffer.byteLength||this._resizeBuffer(2*$R+256,!0),this._byteLength=$R);}),$F.__int__=function($R){$IR.QuadrangleIB=$IR.create(35044),$aR.fillIBQuadrangle($IR.QuadrangleIB,16);},$F.FLOAT32=4,$F.SHORT=2,$F;}($QR),$PR=(function($F){function $i($R){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,$i.__super.call(this,9);}$k($i,"laya.webgl.shader.d2.value.GlowSV",$F);var $R=$i.prototype;$R.setValue=function($R){$F.prototype.setValue.call(this,$R);},$R.clear=function(){$F.prototype.clear.call(this);};}($yR),function($R){function $F($R){$F.__super.call(this,64),this.defines.add(64);}$k($F,"laya.webgl.shader.d2.value.TextSV",$R);var $i=$F.prototype;return $i.release=function(){($F.pool[$F._length++]=this).clear();},$i.clear=function(){$R.prototype.clear.call(this);},$F.create=function(){return $F._length?$F.pool[--$F._length]:new $F(null);},$F.pool=[],$F._length=0,$F;}($yR)),$UR=function($R){function $t($R,$F,$i,$j){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,$t.__super.call(this,$R,$F,$i,$j);}$k($t,"laya.webgl.shader.d2.Shader2X",$R);var $F=$t.prototype;return $F.upload2dQuick1=function($R){this.upload($R,this._params2dQuick1||this._make2dQuick1());},$F._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var $R,$F=this._params,$i=0,$j=$F.length;$i<$j;$i++)$R=$F[$i],($m.isFlash||"size"!==$R.name&&"position"!==$R.name&&"texcoord"!==$R.name)&&this._params2dQuick1.push($R);}return this._params2dQuick1;},$F.disposeResource=function(){$R.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null;},$F.upload2dQuick2=function($R){this.upload($R,this._params2dQuick2||this._make2dQuick2());},$F._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var $R,$F=this._params,$i=0,$j=$F.length;$i<$j;$i++)$R=$F[$i],($m.isFlash||"size"!==$R.name)&&this._params2dQuick2.push($R);}return this._params2dQuick2;},$t.create=function($R,$F,$i,$j){return new $t($R,$F,$i,$j);},$t;}($rR),$IR=function($R){function $F($R){this._uint8Array=null,this._uint16Array=null,void 0===$R&&($R=35044),$F.__super.call(this),this._bufferUsage=$R,this._bufferType=34963,$m.isFlash||(this._buffer=new ArrayBuffer(8));}$k($F,"laya.webgl.utils.IndexBuffer2D",$AR);var $i=$F.prototype;return $i._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer));},$i.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer));},$i.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer));},$i.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null;},$F.QuadrangleIB=null,$F.create=function($R){return void 0===$R&&($R=35044),new $F($R);},$F;}(),$DR=function($R){function $i($R,$F){this._floatArray32=null,this._vertexStride=0,$i.__super.call(this),this._vertexStride=$R,this._bufferUsage=$F,this._bufferType=34962,$m.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array();}$k($i,"laya.webgl.utils.VertexBuffer2D",$R);var $F=$i.prototype;return $F.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer));},$F.bind=function($R){$R&&$R._bind(),this._bind();},$F.insertData=function($R,$F){this.getFloat32Array().set($R,$F),this._upload=!0;},$F.bind_upload=function($R){$R._bind_upload()||$R._bind(),this._bind_upload()||this._bind();},$F._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer));},$F.disposeResource=function(){$R.prototype.disposeResource.call(this);},$F.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null;},$j(0,$F,"vertexStride",function(){return this._vertexStride;}),$i.create=function($R,$F){return void 0===$F&&($F=35048),new $i($R,$F);},$i;}($AR),$RF=function($R){function $V($R,$F,$i,$j,$t,$p){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===$i&&($i=6408),void 0===$j&&($j=!0),$V.__super.call(this,$R,$F),$R){if(this._format=$i,this._mipmap=$j,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof $R)this._url=$R,this._src=$R,this._image=new $h.window.Image(),$F&&($F.onload&&(this.onload=$F.onload),$F.onerror&&(this.onerror=$F.onerror),$F.onCreate&&$F.onCreate(this)),this._image.crossOrigin=$R&&0==$R.indexOf("data:")?null:"",$R&&(this._image.src=$R);else if($R instanceof ArrayBuffer){this._src=$F,this._url=this._src;var $$=new $N($R);$$.readUTFBytes(4),$$.readUTFBytes(2),$$.getInt16();$$.endian="bigEndian",this._w=$$.getInt16(),this._h=$$.getInt16();$$.getInt16(),$$.getInt16();this._image=new Uint8Array($R,$$.pos),this._format=$dR.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,$O.enabled&&this._w<$O.atlasLimitWidth&&this._h<$O.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1;}else{if(!($R instanceof Uint8Array))return this._src=$F,this._url=this._src,this._image=$R.source||$R,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=$F,this._url=this._src,this._w=$t,this._h=$p,this._image=$R,this._format=0===$i?$R.byteLength/($t*$p)==4?6408:6407:$i;}this._$5__enableMerageInAtlas=!0;}}$k($V,"laya.webgl.resource.WebGLImage",$x);var $F=$V.prototype;return $X.imps($F,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$F._init_=function($R,$F){},$F._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $R=$dR.mainContext,$F=this._source=$R.createTexture(),$i=$wR.curBindTexTarget,$j=$wR.curBindTexValue;$wR.bindTexture($R,3553,$F);var $t=this.minFifter,$p=this.magFifter,$$=this.repeat?10497:33071,$V=$q.isPOT(this._w,this._h),$N=!1;switch($V?(this.mipmap?-1!==$t||($t=9987):-1!==$t||($t=9729),-1!==$p||($p=9729),$R.texParameteri(3553,10241,$t),$R.texParameteri(3553,10240,$p),$R.texParameteri(3553,10242,$$),$R.texParameteri(3553,10243,$$),this.mipmap&&$R.generateMipmap(3553)):(-1!==$t||($t=9729),-1!==$p||($p=9729),$R.texParameteri(3553,10241,$t),$R.texParameteri(3553,10240,$p),$R.texParameteri(3553,10242,33071),$R.texParameteri(3553,10243,33071)),$R.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&$R.pixelStorei($R.UNPACK_ALIGNMENT,1),$R.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&$R.pixelStorei($R.UNPACK_ALIGNMENT,1),$R.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:$N=!0,$R.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case $dR.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$N=!0,$R.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format);}$R.pixelStorei(37441,!1),$i&&$j&&$wR.bindTexture($R,$i,$j),this.uri||(this.uri=this._url),$N?this.memorySize=this._image.length:$V&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1;},$F.recreateResource=function(){var $R=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate();}else{this._recreateLock=!0;var $F=this;this._image=new $h.window.Image(),this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if($F._needReleaseAgain)return $F._needReleaseAgain=!1,$F._image.onload=null,void($F._image=null);$F._allowMerageInAtlas&&$F._enableMerageInAtlas?($R.memorySize=0,$R._recreateLock=!1):$F._createWebGlTexture(),$F.completeCreate();},this._image.src=this._src;}},$F.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&$dR.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0;},$F.onresize=function(){this._w=this._image.width,this._h=this._image.height,$O.enabled&&this._w<$O.atlasLimitWidth&&this._h<$O.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1;},$F.clearAtlasSource=function(){this._image=null;},$j(0,$F,"format",function(){return this._format;}),$j(0,$F,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas;},function($R){this._$5__enableMerageInAtlas=$R;}),$j(0,$F,"mipmap",function(){return this._mipmap;}),$j(0,$F,"allowMerageInAtlas",function(){return this._allowMerageInAtlas;}),$j(0,$F,"atlasSource",function(){return this._image;}),$j(0,$F,"onload",null,function($R){var $F=this;this._onload=$R,this._image&&(this._image.onload=null!=this._onload?function(){$F.onresize(),$F._onload();}:null);}),$j(0,$F,"onerror",null,function($R){var $F=this;this._onerror=$R,this._image&&(this._image.onerror=null!=this._onerror?function(){$F._onerror();}:null);}),$V;}();$X.__init([$hR,$G,$HR,$JR]);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($R,$F){"use strict";for(var $i in Object.defineProperty($F,"__esModule",{value:!0}),Laya){var $j=Laya[$i];$j&&$j.__isclass&&($F[$i]=$j);}}),function($p,$R,$j){$j.un,$j.uns;var $t=$j.static,$$=$j.class,$V=$j.getset,$N=($j.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),$S=laya.utils.ClassUtils,$s=(laya.events.Event,laya.utils.HTMLChar),$c=laya.net.Loader,$q=(laya.display.Node,laya.maths.Rectangle),$k=laya.renders.Render,$h=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),$x=laya.utils.Stat,$K=laya.display.Text,$a=laya.resource.Texture,$m=laya.net.URL,$M=laya.utils.Utils,$J=function(){function $h(){}return $$($h,"laya.html.utils.HTMLParse"),$h.parse=function($R,$F,$i){$F=($F="<root>"+($F=$F.replace(/<br>/g,"<br/>"))+"</root>").replace($h.spacePattern,$h.char255);var $j=$M.parseXMLFromString($F);$h._parseXML($R,$j.childNodes[0].childNodes,$i);},$h._parseXML=function($R,$F,$i,$j){var $t=0,$p=0;if($F.join||$F.item)for($t=0,$p=$F.length;$t<$p;++$t)$h._parseXML($R,$F[$t],$i,$j);else{var $$,$V,$N;if(3==$F.nodeType)return void($R instanceof laya.html.dom.HTMLDivElement?(null==$F.nodeName&&($F.nodeName="#text"),$V=$F.nodeName.toLowerCase(),0<($N=$F.textContent.replace(/^\s+|\s+$/g,"")).length&&($$=$S.getInstance($V))&&($R.addChild($$),$$.innerTEXT=$N.replace($h.char255AndOneSpacePattern," "))):0<($N=$F.textContent.replace(/^\s+|\s+$/g,"")).length&&($R.innerTEXT=$N.replace($h.char255AndOneSpacePattern," ")));if("#comment"==($V=$F.nodeName.toLowerCase()))return;if($$=$S.getInstance($V)){($$=$R.addChild($$)).URI=$i,$$.href=$j;var $c=$F.attributes;if($c&&0<$c.length)for($t=0,$p=$c.length;$t<$p;++$t){var $q=$c[$t],$s=$q.nodeName,$k=$q.value;$$._setAttributes($s,$k);}$h._parseXML($$,$F.childNodes,$i,$$.href);}else $h._parseXML($R,$F.childNodes,$i,$j);}},$h.char255=String.fromCharCode(255),$h.spacePattern=/&nbsp;|&#160;/g,$h.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),$h;}(),$d=function(){function $v(){}return $$($v,"laya.html.utils.Layout"),$v.later=function($R){null==$v._will&&($v._will=[],$j.stage.frameLoop(1,null,function(){if(!($v._will.length<1)){for(var $R=0;$R<$v._will.length;$R++)laya.html.utils.Layout.layout($v._will[$R]);$v._will.length=0;}})),$v._will.push($R);},$v.layout=function($R){if(!$R||!$R._style)return null;if(0==(512&$R._style._type))return null;$R.getStyle()._type&=-513;var $F=$v._multiLineLayout($R);return $k.isConchApp&&$R.layaoutCallNative&&$R.layaoutCallNative(),$F;},$v._multiLineLayout=function($R){if($K.RightToLeft)return $v._multiLineLayout2($R);var $F=new Array();$R._addChildsToLayout($F);var $i,$j,$t,$p,$$,$V=0,$N=$F.length,$c=$R._getCSSStyle(),$q=$c.letterSpacing,$s=$c.leading,$k=$c.lineHeight,$h=$c._widthAuto()||!$c.wordWrap,$S=$h?999999:$R.width,$x=($R.height,0),$a=$c.italic?$c.fontSize/3:0,$m=$c._getAlign(),$M=$c._getValign(),$J=0!==$M||0!==$m||0!=$k,$d=0,$w=0,$X=0,$H=0,$_=new Array(),$T=$_[0]=new $e(),$g=!1,$B=!1;$T.h=0,$c.italic&&($S-=$c.fontSize/3);var $z=0,$L=!0;function $Y(){$T.y=$w,$w+=$T.h+$s,0==$T.h&&($w+=$k),$T.mWidth=$z,$z=0,$T=new $e(),$_.push($T),$T.h=0,$g=!($L=!($d=0));}for($V=0;$V<$N;$V++)if(null!=($i=$F[$V])){if($L=!1,$i instanceof laya.html.dom.HTMLBrElement)$Y(),$T.y=$w;else{if($i._isChar()){if(($p=$i).isWord)$g=$B||"\n"===$p.char,$T.wordStartIndex=$T.elements.length;else{if($X=$p.width+$p.style.letterSpacin,0<$_.length&&$S<$d+$X&&0<$T.wordStartIndex){var $f;$f=$T.elements.length-$T.wordStartIndex+1,$T.elements.length=$T.wordStartIndex,$V-=$f,$Y();continue;}$g=!1,$z+=$p.width;}$X=$p.width+$q,$H=$p.height,$B=!1,($g=$g||$S<$d+$X)&&$Y(),$T.minTextHeight=Math.min($T.minTextHeight,$i.height);}else $j=$i._getCSSStyle(),$$=$i,$t=$j.padding,0===$j._getCssFloat()||($J=!0),$g=$B||$j.lineElement,$X=$$.width*$$._style._tf.scaleX+$t[1]+$t[3]+$q,$H=$$.height*$$._style._tf.scaleY+$t[0]+$t[2],$B=$j.lineElement,($g=$g||$S<$d+$X&&$j.wordWrap)&&$Y();$T.elements.push($i),$T.h=Math.max($T.h,$H),$i.x=$d,$i.y=$w,$d+=$X,$T.w=$d-$q,$T.y=$w,$x=Math.max($d+$a,$x);}}else $L||($d+=$v.DIV_ELEMENT_PADDING),$T.wordStartIndex=$T.elements.length;if($w=$T.y+$T.h,$J){var $Z=0,$u=$S;for($h&&0<$R.width&&($u=$R.width),$V=0,$N=$_.length;$V<$N;$V++)$_[$V].updatePos(0,$u,$V,$Z,$m,$M,$k),$Z+=Math.max($k,$_[$V].h+$s);$w=$Z;}return $h&&($R.width=$x),$w>$R.height&&($R.height=$w),[$x,$w];},$v._multiLineLayout2=function($R){var $F=new Array();$R._addChildsToLayout($F);var $i,$j,$t,$p,$$,$V=0,$N=$F.length,$c=$R._getCSSStyle(),$q=$c.letterSpacing,$s=$c.leading,$k=$c.lineHeight,$h=$c._widthAuto()||!$c.wordWrap,$S=$h?999999:$R.width,$x=($R.height,0),$a=$c.italic?$c.fontSize/3:0,$m=2-$c._getAlign(),$M=$c._getValign(),$J=0!==$M||0!=$m||0!=$k,$d=0,$w=0,$X=0,$H=0,$_=new Array(),$T=$_[0]=new $e(),$g=!1,$B=!1;$T.h=0,$c.italic&&($S-=$c.fontSize/3);var $z=0,$L=!0;function $Y(){$T.y=$w,$w+=$T.h+$s,0==$T.h&&($w+=$k),$T.mWidth=$z,$z=0,$T=new $e(),$_.push($T),$T.h=0,$g=!($L=!($d=0));}for($V=0;$V<$N;$V++)if(null!=($i=$F[$V])){if($L=!1,$i instanceof laya.html.dom.HTMLBrElement)$Y(),$T.y=$w;else{if($i._isChar()){if(($p=$i).isWord)$g=$B||"\n"===$p.char,$T.wordStartIndex=$T.elements.length;else{if(0<$_.length&&$S<$d+$X&&0<$T.wordStartIndex){var $f;$f=$T.elements.length-$T.wordStartIndex+1,$T.elements.length=$T.wordStartIndex,$V-=$f,$Y();continue;}$g=!1,$z+=$p.width;}$X=$p.width+$q,$H=$p.height,$B=!1,($g=$g||$S<$d+$X)&&$Y(),$T.minTextHeight=Math.min($T.minTextHeight,$i.height);}else $j=$i._getCSSStyle(),$$=$i,$t=$j.padding,0===$j._getCssFloat()||($J=!0),$g=$B||$j.lineElement,$X=$$.width*$$._style._tf.scaleX+$t[1]+$t[3]+$q,$H=$$.height*$$._style._tf.scaleY+$t[0]+$t[2],$B=$j.lineElement,($g=$g||$S<$d+$X&&$j.wordWrap)&&$Y();$T.elements.push($i),$T.h=Math.max($T.h,$H),$i.x=$d,$i.y=$w,$d+=$X,$T.w=$d-$q,$T.y=$w,$x=Math.max($d+$a,$x);}}else $L||($d+=$v.DIV_ELEMENT_PADDING),$T.wordStartIndex=$T.elements.length;if($w=$T.y+$T.h,$J){var $Z=0,$u=$S;for($V=0,$N=$_.length;$V<$N;$V++)$_[$V].updatePos(0,$u,$V,$Z,$m,$M,$k),$Z+=Math.max($k,$_[$V].h+$s);$w=$Z;}for($h&&($R.width=$x),$w>$R.height&&($R.height=$w),$V=0,$N=$_.length;$V<$N;$V++)$_[$V].revertOrder($S);return[$x,$w];},$v._will=null,$v.DIV_ELEMENT_PADDING=0,$v;}(),$e=function(){function $R(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array();}$$($R,"laya.html.utils.LayoutLine");var $F=$R.prototype;return $F.updatePos=function($R,$F,$i,$j,$t,$p,$$){var $V,$N=0;0<this.elements.length&&($N=($V=this.elements[this.elements.length-1]).x+$V.width-this.elements[0].x);var $c=0,$q=NaN;1===$t&&($c=($F-$N)/2),2===$t&&($c=$F-$N),0===$$||0!=$p||($p=1);for(var $s=0,$k=this.elements.length;$s<$k;$s++){var $h=($V=this.elements[$s])._getCSSStyle();switch(0!==$c&&($V.x+=$c),$h._getValign()){case 0:$V.y=$j;break;case 1:var $S=0;99999!=this.minTextHeight&&($S=this.minTextHeight);var $x=($S+$$)/2;$x=Math.max($x,this.h),$q=(laya.html.dom.HTMLImageElement,$j+$x-$V.height),$V.y=$q;break;case 2:$V.y=$j+($$-$V.height);}}},$F.revertOrder=function($R){var $F;if(0<this.elements.length){var $i,$j=0;for($i=this.elements.length,$j=0;$j<$i;$j++)($F=this.elements[$j]).x=$R-$F.x-$F.width;}},$R;}(),$w=function($i){function $F(){this.URI=null,this._href=null,$F.__super.call(this),this._text=$F._EMPTYTEXT,this.setStyle(new $N(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0;}$$($F,"laya.html.dom.HTMLElement",$i);var $R=$F.prototype;return $R.layaoutCallNative=function(){var $R=0;if(this._childs&&0<($R=this._childs.length))for(var $F=0;$F<$R;$F++)this._childs[$F].layaoutCallNative&&this._childs[$F].layaoutCallNative();var $i=this._getWords();$i?laya.html.dom.HTMLElement.fillWords(this,$i,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear();},$R.appendChild=function($R){return this.addChild($R);},$R._getWords2=function(){var $R=this._text.text;if(!$R||0===$R.length)return null;var $F,$i,$j=0,$t=0;if(this._text.drawWords)$i=this._text.drawWords;else{for($t=($F=$R.split(" ")).length-1,$i=[],$j=0;$j<$t;$j++)$i.push($F[$j]," ");0<=$t&&$i.push($F[$t]),this._text.drawWords=$i;}var $p,$$=this._text.words;if($$&&$$.length===$i.length)return $$;null===$$&&(this._text.words=$$=[]),$$.length=$i.length;var $V=this.style,$N=$V.font;for($j=0,$t=$i.length;$j<$t;$j++){$p=$M.measureText($i[$j],$N);var $c=$$[$j]=new $s($i[$j],$p.width,$p.height||$V.fontSize,$V);if(1<$c.char.length&&($c.charNum=$c.char),this.href){var $q=new $h();this.addChild($q),$c.setSprite($q);}}return $$;},$R._getWords=function(){if(!$K.CharacterCache)return this._getWords2();var $R=this._text.text;if(!$R||0===$R.length)return null;var $F,$i=this._text.words;if($i&&$i.length===$R.length)return $i;null===$i&&(this._text.words=$i=[]),$i.length=$R.length;for(var $j=this.style,$t=$j.font,$p=0,$$=$R.length;$p<$$;$p++)if($F=$M.measureText($R.charAt($p),$t)){var $V=$i[$p]=new $s($R.charAt($p),$F.width,$F.height||$j.fontSize,$j);if(this.href){var $N=new $h();this.addChild($N),$V.setSprite($N);}}else console.warn("_getWords size is null"+$R.charAt($p),$t);return $i;},$R.showLinkSprite=function(){var $R=this._text.words;if($R)for(var $F,$i,$j=[],$t=0;$t<$R.length;$t++)$i=$R[$t],($F=new $h()).graphics.drawRect(0,0,$i.width,$i.height,"#ff0000"),$F.width=$i.width,$F.height=$i.height,this.addChild($F),$j.push($F);},$R._layoutLater=function(){var $R=this.style;512&$R._type||($R.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&$R.block?($d.later(this),$R._type|=512):this.parent&&this.parent._layoutLater());},$R._setAttributes=function($R,$F){switch($R){case"style":return void this.style.cssText($F);case"class":return void(this.className=$F);}$i.prototype._setAttributes.call(this,$R,$F);},$R.updateHref=function(){if(null!=this._href){var $R=this._getWords();if($R)for(var $F,$i,$j=0;$j<$R.length;$j++)($i=($F=$R[$j]).getSprite())&&($i.size($F.width,$F.height),$i.on("click",this,this.onLinkHandler));}},$R.onLinkHandler=function($R){switch($R.type){case"click":for(var $F=this;$F;)$F.event("link",[this.href]),$F=$F.parent;}},$R.formatURL=function($R){return this.URI?$m.formatURL($R,this.URI?this.URI.path:null):$R;},$V(0,$R,"href",function(){return this._href;},function($R){null!=(this._href=$R)&&(this._getCSSStyle().underLine=1,this.updateHref());}),$V(0,$R,"color",null,function($R){this.style.color=$R;}),$V(0,$R,"onClick",null,function($R){$j._runScript("fn=function(event){"+$R+";}"),this.on("click",this,void 0);}),$V(0,$R,"id",null,function($R){$X.document.setElementById($R,this);}),$V(0,$R,"innerTEXT",function(){return this._text.text;},function($R){this.text=$R;}),$V(0,$R,"style",function(){return this._style;}),$V(0,$R,"text",function(){return this._text.text;},function($R){this._text==$F._EMPTYTEXT?this._text={text:$R,words:null}:(this._text.text=$R,this._text.words&&(this._text.words.length=0)),$k.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref();}),$V(0,$R,"parent",$i.prototype._$get_parent,function($R){if($R instanceof laya.html.dom.HTMLElement){var $F=$R;this.URI||(this.URI=$F.URI),this.style.inherit($F.style);}$j.superSet($h,this,"parent",$R);}),$V(0,$R,"className",null,function($R){this.style.attrs($X.document.styleSheets["."+$R]);}),$F.fillWords=function($R,$F,$i,$j,$t,$p,$$){$R.graphics.clear();for(var $V=0,$N=$F.length;$V<$N;$V++){var $c=$F[$V];$R.graphics.fillText($c.char,$c.x+$i,$c.y+$j,$t,$p,"left",$$);}},$F._EMPTYTEXT={text:null,words:null},$F;}($h),$F=(function($R){function $F(){$F.__super.call(this),this.style.lineElement=!0,this.style.block=!0;}$$($F,"laya.html.dom.HTMLBrElement",$w);}(),function($R){function $F(){this.contextHeight=NaN,this.contextWidth=NaN,$F.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200;}$$($F,"laya.html.dom.HTMLDivElement",$R);var $i=$F.prototype;return $i.appendHTML=function($R){$J.parse(this,$R,this.URI),this.layout();},$i._addChildsToLayout=function($F){var $R=this._getWords();if(null==$R&&0==this._childs.length)return!1;$R&&$R.forEach(function($R){$F.push($R);});for(var $i=!0,$j=0,$t=this._childs.length;$j<$t;$j++){var $p=this._childs[$j];$i?$i=!1:$F.push(null),$p._addToLayout($F);}return!0;},$i._addToLayout=function($R){this.layout();},$i.layout=function(){if(this.style){this.style._type|=512;var $R=$d.layout(this);if($R){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new $q());var $F=this._$P.mHtmlBounds;$F.x=$F.y=0,$F.width=this.contextWidth=$R[0],$F.height=this.contextHeight=$R[1],this.setBounds($F);}}},$V(0,$i,"height",function(){return this._height?this._height:this.contextHeight;},$R.prototype._$set_height),$V(0,$i,"innerHTML",null,function($R){this.destroyChildren(),this.appendHTML($R);}),$V(0,$i,"width",function(){return this._width?this._width:this.contextWidth;},function($R){var $F=!1;$F=0===$R?$R!=this._width:$R!=this.width,$j.superSet($w,this,"width",$R),$F&&this.layout();}),$F;}($w)),$X=function($R){function $F(){this.all=new Array(),this.styleSheets=$N.styleSheets,$F.__super.call(this);}$$($F,"laya.html.dom.HTMLDocument",$w);var $i=$F.prototype;return $i.getElementById=function($R){return this.all[$R];},$i.setElementById=function($R,$F){this.all[$R]=$F;},$t($F,["document",function(){return this.document=new $F();}]),$F;}();(function($R){function $F(){this._tex=null,this._url=null,this._renderArgs=[],$F.__super.call(this),this.style.block=!0;}$$($F,"laya.html.dom.HTMLImageElement",$w);var $i=$F.prototype;$i._addToLayout=function($R){!this._style.absolute&&$R.push(this);},$i.render=function($R,$F,$i){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||($x.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,$R.ctx.drawTexture2($F,$i,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs));},$i.layaoutCallNative=function(){var $R=0;if(this._childs&&0<($R=this._childs.length))for(var $F=0;$F<$R;$F++)this._childs[$F].layaoutCallNative&&this._childs[$F].layaoutCallNative();},$V(0,$i,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width;},function($R){this._width!==$R&&(this._width=$R,this._style.width=$R,this.repaint());}),$V(0,$i,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height;},function($R){this._height!==$R&&(this._height=$R,this._style.height=$R,this.repaint());}),$i.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),$c.clearCache(this,this._url),this._tex=null),$w.prototype.destroy.call(this);},$i.onloaded=function(){var $R=this._style;$R&&!$R.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),$R&&!$R.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),$k.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint();},$i._loadImageComplete=function($R,$F,$i){if(!this._destroyed)if(null!=$i){if($i instanceof ArrayBuffer){var $j=new DataView($i);new laya.webgl.resource.WebGLImage(new Uint8Array($i,8),$R,0,!1,$j.getUint32(0),$j.getUint32(4));this.onloaded();}else if($i instanceof $a)$c.imgMgrSet[$R]=$F,$p.imgMgrLock($R,$c.imgMgrSet[$R]),this._url=$R,this._tex=$i,$c.keepCache(this,$R),$c.cacheRes($R,this._tex),this.onloaded();else{var $t=-1!=$R.indexOf(".png",$R.length-4)?6408:6407;new laya.webgl.resource.WebGLImage($i,$R,$t,!1,$i.width,$i.height);this.onloaded();}}else this.event("error","Load image failed");},$V(0,$i,"src",null,function($R){($R=this.formatURL($R),this._url!=$R)&&(null!=this._tex&&($c.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=$R,(this._tex=$c.getRes($R))?($c.keepCache(this,$R),this.onloaded()):$p.imgMgrLoad($R,this._loadImageComplete.bind(this),2,!1));});})(),function($R){function $F(){this.type=null,$F.__super.call(this),this.visible=!1;}$$($F,"laya.html.dom.HTMLLinkElement",$R);var $i=$F.prototype;$i._onload=function($R){switch(this.type){case"text/css":$N.parseCSS($R,this.URI);}},$V(0,$i,"href",$R.prototype._$get_href,function($R){var $F=this;$R=this.formatURL($R),this.URI=new $m($R);var $i=new $c();$i.once("complete",null,function($R){$F._onload($R);}),$i.load($R,"text");}),$F._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g");}($w),function($R){function $F(){$F.__super.call(this),this.visible=!1;}$$($F,"laya.html.dom.HTMLStyleElement",$R),$V(0,$F.prototype,"text",$R.prototype._$get_text,function($R){$N.parseCSS($R,null);});}($w),function($R){function $F(){$F.__super.call(this),this._getCSSStyle().valign="middle";}$$($F,"laya.html.dom.HTMLIframeElement",$R),$V(0,$F.prototype,"href",$R.prototype._$get_href,function($i){var $j=this;$i=this.formatURL($i);var $R=new $c();$R.once("complete",null,function($R){var $F=$j.URI;$j.URI=new $m($i),$j.innerHTML=$R,!$F||($j.URI=$F);}),$R.load($i,"text");});}($F);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($R,$F){"use strict";for(var $i in Object.defineProperty($F,"__esModule",{value:!0}),Laya){var $j=Laya[$i];$j&&$j.__isclass&&($F[$i]=$j);}}),function($t,$R,$x){$x.un,$x.uns;var $j=$x.static,$p=$x.class,$$=$x.getset,$i=($x.__newvec,laya.display.Animation),$a=(laya.utils.Browser,laya.utils.ClassUtils),$V=laya.filters.ColorFilter,$N=laya.utils.Ease,$c=laya.events.Event,$q=(laya.events.EventDispatcher,laya.display.css.Font),$s=laya.display.FrameAnimation,$F=laya.display.Graphics,$k=laya.utils.Handler,$h=laya.display.Input,$M=laya.net.Loader,$S=(laya.display.Node,laya.maths.Point),$m=laya.maths.Rectangle,$J=laya.renders.Render,$d=laya.display.Sprite,$w=laya.display.Text,$X=laya.resource.Texture,$H=laya.utils.Tween,$_=laya.utils.Utils,$T=laya.utils.WeakObject;$x.interface("laya.ui.IItem"),$x.interface("laya.ui.ISelect"),$x.interface("laya.ui.IRender"),$x.interface("laya.ui.IComponent"),$x.interface("laya.ui.IBox","IComponent");var $g=function(){function $R(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN;}return $p($R,"laya.ui.LayoutStyle"),$j($R,["EMPTY",function(){return this.EMPTY=new $R();}]),$R;}(),$B=function(){function $R(){}return $p($R,"laya.ui.Styles"),$R.labelColor="#000000",$R.buttonStateNum=3,$R.scrollBarMinNum=15,$R.scrollBarDelayTime=500,$j($R,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0];},"labelPadding",function(){return this.labelPadding=[2,2,2,2];},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3];},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"];},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"];}]),$R;}(),$z=function(){function $t(){}return $p($t,"laya.ui.UIUtils"),$t.fillArray=function($R,$F,$i){var $j=$R.concat();if($F)for(var $t=$F.split(","),$p=0,$$=Math.min($j.length,$t.length);$p<$$;$p++){var $V=$t[$p];$j[$p]="true"==$V||"false"!=$V&&$V,null!=$i&&($j[$p]=$i($V));}return $j;},$t.toColor=function($R){return $_.toHexColor($R);},$t.gray=function($R,$F){void 0===$F&&($F=!0),$F?$t.addFilter($R,$t.grayFilter):$t.clearFilter($R,$V);},$t.addFilter=function($R,$F){var $i=$R.filters||[];$i.push($F),$R.filters=$i;},$t.clearFilter=function($R,$F){var $i=$R.filters;if(null!=$i&&0<$i.length){for(var $j=$i.length-1;-1<$j;$j--){var $t=$i[$j];$x.__typeof($t,$F)&&$i.splice($j,1);}$R.filters=$i;}},$t._getReplaceStr=function($R){return $t.escapeSequence[$R];},$t.adptString=function($R){return $R.replace(/\\(\w)/g,$t._getReplaceStr);},$t.getBindFun=function($R){var $F=$t._funMap.get($R);if(null==$F){var $i='"'+$R+'"',$j="(function(data){if(data==null)return;with(data){try{\nreturn "+($i=$i.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";$F=$x._runScript($j),$t._funMap.set($R,$F);}return $F;},$j($t,["grayFilter",function(){return this.grayFilter=new $V([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]);},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"};},"_funMap",function(){return this._funMap=new $T();}]),$t;}(),$L=function(){function $R(){}return $p($R,"UIConfig"),$R.touchScrollEnable=!0,$R.mouseWheelEnable=!0,$R.showButtons=!0,$R.popupBgColor="#000000",$R.popupBgAlpha=.5,$R.closeDialogOnSide=!0,$R;}(),$Y=function($i){function $m(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,$m.__super.call(this),this._weakKeys=[];}$p($m,"laya.ui.AutoBitmap",$i);var $R=$m.prototype;return $R.destroy=function(){if($M.clearObject(this,this._weakKey),this._weakKeys){for(var $R=0,$F=this._weakKeys.length;$R<$F;++$R)$M.clearObject(this,this._weakKeys[$R]);this._weakKeys=null;}$i.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null;},$R._setChanged=function(){this._isChanged||(this._isChanged=!0,$x.timer.callLater(this,this.changeSource));},$R.changeSource=function(){this._isChanged=!1;var $R=this._source;if($R&&$R.bitmap){var $F=this.width,$i=this.height,$j=this._sizeGrid,$t=$R.sourceWidth,$p=$R.sourceHeight;if(!$j||$t===$F&&$p===$i)this.cleanByTexture($R,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,$F,$i);else{$M.clearObject(this,this._weakKey),$R.$_GID||($R.$_GID=$_.getGID());var $$=$R.$_GID+"."+$F+"."+$i+"."+$j.join("."),$V=$M.findObject($$);if($_.isOKCmdList($V))return this._weakKey=$$,$M.keepObject(this,this._weakKey),void(this.cmds=$V);this.clear();var $N,$c,$q=$j[0],$s=$j[1],$k=$j[2],$h=$j[3],$S=$j[4],$x=!1;if($F==$t&&($h=$s=0),$i==$p&&($q=$k=0),$F<$h+$s){var $a=$F;$x=!0,$F=$h+$s,this.save(),this.clipRect(0,0,$a,$i);}$h&&$q&&($N=$m.getTexture($R,0,0,$h,$q),$c=this._weakKeys[0],$N?($c!=$N.weakKey&&($M.clearObject(this,$c),$M.keepObject(this,$N.weakKey),this._weakKeys[0]=$N.weakKey),this.drawTexture($N,0,0,$h,$q)):($M.clearObject(this,$c),this._weakKeys[0]="")),$s&&$q&&($N=$m.getTexture($R,$t-$s,0,$s,$q),$c=this._weakKeys[1],$N?($c!=$N.weakKey&&($M.clearObject(this,$c),$M.keepObject(this,$N.weakKey),this._weakKeys[1]=$N.weakKey),this.drawTexture($N,$F-$s,0,$s,$q)):($M.clearObject(this,$c),this._weakKeys[1]="")),$h&&$k&&($N=$m.getTexture($R,0,$p-$k,$h,$k),$c=this._weakKeys[2],$N?($c!=$N.weakKey&&($M.clearObject(this,$c),$M.keepObject(this,$N.weakKey),this._weakKeys[2]=$N.weakKey),this.drawTexture($N,0,$i-$k,$h,$k)):($M.clearObject(this,$c),this._weakKeys[2]="")),$s&&$k&&($N=$m.getTexture($R,$t-$s,$p-$k,$s,$k),$c=this._weakKeys[3],$N?($c!=$N.weakKey&&($M.clearObject(this,$c),$M.keepObject(this,$N.weakKey),this._weakKeys[3]=$N.weakKey),this.drawTexture($N,$F-$s,$i-$k,$s,$k)):($M.clearObject(this,$c),this._weakKeys[3]="")),$q&&($N=$m.getTexture($R,$h,0,$t-$h-$s,$q),$c=this._weakKeys[4],$N?($c!=$N.weakKey&&($M.clearObject(this,$c),$M.keepObject(this,$N.weakKey),this._weakKeys[4]=$N.weakKey),this.drawBitmap($S,$N,$h,0,$F-$h-$s,$q)):($M.clearObject(this,$c),this._weakKeys[4]="")),$k&&($N=$m.getTexture($R,$h,$p-$k,$t-$h-$s,$k),$c=this._weakKeys[5],$N?($c!=$N.weakKey&&($M.clearObject(this,$c),$M.keepObject(this,$N.weakKey),this._weakKeys[5]=$N.weakKey),this.drawBitmap($S,$N,$h,$i-$k,$F-$h-$s,$k)):($M.clearObject(this,$c),this._weakKeys[5]="")),$h&&($N=$m.getTexture($R,0,$q,$h,$p-$q-$k),$c=this._weakKeys[6],$N?($c!=$N.weakKey&&($M.clearObject(this,$c),$M.keepObject(this,$N.weakKey),this._weakKeys[6]=$N.weakKey),this.drawBitmap($S,$N,0,$q,$h,$i-$q-$k)):($M.clearObject(this,$c),this._weakKeys[6]="")),$s&&($N=$m.getTexture($R,$t-$s,$q,$s,$p-$q-$k),$c=this._weakKeys[7],$N?($c!=$N.weakKey&&($M.clearObject(this,$c),$M.keepObject(this,$N.weakKey),this._weakKeys[7]=$N.weakKey),this.drawBitmap($S,$N,$F-$s,$q,$s,$i-$q-$k)):($M.clearObject(this,$c),this._weakKeys[7]="")),$N=$m.getTexture($R,$h,$q,$t-$h-$s,$p-$q-$k),$c=this._weakKeys[8],$N?($c!=$N.weakKey&&($M.clearObject(this,$c),$M.keepObject(this,$N.weakKey),this._weakKeys[8]=$N.weakKey),this.drawBitmap($S,$N,$h,$q,$F-$h-$s,$i-$q-$k)):($M.clearObject(this,$c),this._weakKeys[8]=""),$x&&this.restore(),this.autoCacheCmd&&!$J.isConchApp&&($M.saveObject($$,this.cmds,null),this._weakKey=$$,$M.keepObject(this,this._weakKey));}this._repaint();}},$R.drawBitmap=function($R,$F,$i,$j,$t,$p){void 0===$t&&($t=0),void 0===$p&&($p=0),$t<.1||$p<.1||(!$R||$F.width==$t&&$F.height==$p?this.drawTexture($F,$i,$j,$t,$p):this.fillTexture($F,$i,$j,$t,$p));},$R.clear=function($R){void 0===$R&&($R=!0),$i.prototype.clear.call(this,!1);},$$(0,$R,"sizeGrid",function(){return this._sizeGrid;},function($R){this._sizeGrid=$R,this._setChanged();}),$$(0,$R,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0;},function($R){this._width!=$R&&(this._width=$R,this._setChanged());}),$$(0,$R,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0;},function($R){this._height!=$R&&(this._height=$R,this._setChanged());}),$$(0,$R,"source",function(){return this._source;},function($R){$R?(this._source=$R,this._setChanged()):(this._source=null,this.clear());}),$m.getTexture=function($R,$F,$i,$j,$t){$j<=0&&($j=1),$t<=0&&($t=1),$R.$_GID||($R.$_GID=$_.getGID());var $p=$R.$_GID+"."+$F+"."+$i+"."+$j+"."+$t,$$=$M.findObject($p);if((!$$||!$$.source)&&($$=$X.createFromTexture($R,$F,$i,$j,$t))){if($R.alphaTexture){var $V=$R.width/$R.alphaTexture.width;$$.alphaTexture=$X.createFromTexture($R.alphaTexture,$F/$V,$i/$V,$j/$V,$t/$V);}$M.saveObject($p,$$),$$.weakKey=$p;}return $$;},$m;}($F),$f=(function($R){function $F(){$F.__super.call(this);}$p($F,"laya.ui.UIEvent",$c),$F.SHOW_TIP="showtip",$F.HIDE_TIP="hidetip";}(),function($F){function $R(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,$R.__super.call(this),this._layout=$g.EMPTY,this.preinitialize(),this.createChildren(),this.initialize();}$p($R,"laya.ui.Component",$F);var $i=$R.prototype;return $x.imps($i,{"laya.ui.IComponent":!0}),$i.destroy=function($R){void 0===$R&&($R=!0),$F.prototype.destroy.call(this,$R),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null;},$i.preinitialize=function(){},$i.createChildren=function(){},$i.initialize=function(){},$i.callLater=function($R,$F){$x.timer.callLater(this,$R,$F);},$i.runCallLater=function($R){$x.timer.runCallLater(this,$R);},$i.commitMeasure=function(){},$i.changeSize=function(){this.event("resize");},$i.getLayout=function(){return this._layout===$g.EMPTY&&(this._layout=new $g()),this._layout;},$i._setLayoutEnabled=function($R){this._layout&&this._layout.enable!=$R&&(this._layout.enable=$R,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded());},$i.onRemoved=function(){this.parent.off("resize",this,this.onCompResize);},$i.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY();},$i.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY());},$i.resetLayoutX=function(){var $R=this._layout;if(isNaN($R.anchorX)||(this.pivotX=$R.anchorX*this.width),this.layoutEnabled){var $F=this.parent;$F&&(isNaN($R.centerX)?isNaN($R.left)?isNaN($R.right)||(this.x=Math.round($F.width-this.displayWidth-$R.right+this.pivotX*this.scaleX)):(this.x=Math.round($R.left+this.pivotX*this.scaleX),isNaN($R.right)||(this.width=($F._width-$R.left-$R.right)/(this.scaleX||.01))):this.x=Math.round(.5*($F.width-this.displayWidth)+$R.centerX+this.pivotX*this.scaleX));}},$i.resetLayoutY=function(){var $R=this._layout;if(isNaN($R.anchorY)||(this.pivotY=$R.anchorY*this.height),this.layoutEnabled){var $F=this.parent;$F&&(isNaN($R.centerY)?isNaN($R.top)?isNaN($R.bottom)||(this.y=Math.round($F.height-this.displayHeight-$R.bottom+this.pivotY*this.scaleY)):(this.y=Math.round($R.top+this.pivotY*this.scaleY),isNaN($R.bottom)||(this.height=($F._height-$R.top-$R.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*($F.height-this.displayHeight)+$R.centerY+this.pivotY*this.scaleY));}},$i.onMouseOver=function($R){$x.stage.event("showtip",this._toolTip);},$i.onMouseOut=function($R){$x.stage.event("hidetip",this._toolTip);},$$(0,$i,"displayWidth",function(){return this.width*this.scaleX;}),$$(0,$i,"width",function(){return this._width?this._width:this.measureWidth;},function($R){this._width!=$R&&(this._width=$R,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX());}),$$(0,$i,"measureWidth",function(){var $R=0;this.commitMeasure();for(var $F=this.numChildren-1;-1<$F;$F--){var $i=this.getChildAt($F);$i.visible&&($R=Math.max($i.x+$i.width*$i.scaleX,$R));}return $R;}),$$(0,$i,"displayHeight",function(){return this.height*this.scaleY;}),$$(0,$i,"height",function(){return this._height?this._height:this.measureHeight;},function($R){this._height!=$R&&(this._height=$R,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY());}),$$(0,$i,"dataSource",function(){return this._dataSource;},function($R){for(var $F in this._dataSource=$R,this._dataSource)this.hasOwnProperty($F)&&"function"!=typeof this[$F]&&(this[$F]=this._dataSource[$F]);}),$$(0,$i,"scaleY",$F.prototype._$get_scaleY,function($R){$x.superGet($d,this,"scaleY")!=$R&&($x.superSet($d,this,"scaleY",$R),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY());}),$$(0,$i,"measureHeight",function(){var $R=0;this.commitMeasure();for(var $F=this.numChildren-1;-1<$F;$F--){var $i=this.getChildAt($F);$i.visible&&($R=Math.max($i.y+$i.height*$i.scaleY,$R));}return $R;}),$$(0,$i,"scaleX",$F.prototype._$get_scaleX,function($R){$x.superGet($d,this,"scaleX")!=$R&&($x.superSet($d,this,"scaleX",$R),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX());}),$$(0,$i,"top",function(){return this._layout.top;},function($R){$R!=this._layout.top&&(this.getLayout().top=$R,this._setLayoutEnabled(!0)),this.resetLayoutY();}),$$(0,$i,"bottom",function(){return this._layout.bottom;},function($R){$R!=this._layout.bottom&&(this.getLayout().bottom=$R,this._setLayoutEnabled(!0)),this.resetLayoutY();}),$$(0,$i,"left",function(){return this._layout.left;},function($R){$R!=this._layout.left&&(this.getLayout().left=$R,this._setLayoutEnabled(!0)),this.resetLayoutX();}),$$(0,$i,"right",function(){return this._layout.right;},function($R){$R!=this._layout.right&&(this.getLayout().right=$R,this._setLayoutEnabled(!0)),this.resetLayoutX();}),$$(0,$i,"centerX",function(){return this._layout.centerX;},function($R){$R!=this._layout.centerX&&(this.getLayout().centerX=$R,this._setLayoutEnabled(!0)),this.resetLayoutX();}),$$(0,$i,"centerY",function(){return this._layout.centerY;},function($R){$R!=this._layout.centerY&&(this.getLayout().centerY=$R,this._setLayoutEnabled(!0)),this.resetLayoutY();}),$$(0,$i,"anchorX",function(){return this._layout.anchorX;},function($R){$R!=this._layout.anchorX&&(this.getLayout().anchorX=$R,this._setLayoutEnabled(!0)),this.resetLayoutX();}),$$(0,$i,"anchorY",function(){return this._layout.anchorY;},function($R){$R!=this._layout.anchorY&&(this.getLayout().anchorY=$R,this._setLayoutEnabled(!0)),this.resetLayoutY();}),$$(0,$i,"tag",function(){return this._tag;},function($R){this._tag=$R;}),$$(0,$i,"toolTip",function(){return this._toolTip;},function($R){this._toolTip!=$R&&(null!=(this._toolTip=$R)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)));}),$$(0,$i,"comXml",function(){return this._comXml;},function($R){this._comXml=$R;}),$$(0,$i,"gray",function(){return this._gray;},function($R){$R!==this._gray&&(this._gray=$R,$z.gray(this,$R));}),$$(0,$i,"disabled",function(){return this._disabled;},function($R){$R!==this._disabled&&(this.gray=this._disabled=$R,this.mouseEnabled=!$R);}),$R;}($d)),$Z=function($R){function $F(){this.lockLayer=null,this.popupEffect=function($R){$R.scale(1,1),$H.from($R,{x:$x.stage.width/2,y:$x.stage.height/2,scaleX:0,scaleY:0},300,$N.backOut,$k.create(this,this.doOpen,[$R]));},this.closeEffect=function($R,$F){$H.to($R,{x:$x.stage.width/2,y:$x.stage.height/2,scaleX:0,scaleY:0},300,$N.strongOut,$k.create(this,this.doClose,[$R,$F]));},$F.__super.call(this),this.maskLayer=new $d(),this.popupEffectHandler=$k.create(this,this.popupEffect,null,!1),this.closeEffectHandler=$k.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,$x.stage.addChild(this),$x.stage.on("resize",this,this._onResize),$L.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null);}$p($F,"laya.ui.DialogManager",$d);var $i=$F.prototype;return $i._closeOnSide=function(){var $R=this.getChildAt(this.numChildren-1);$R instanceof laya.ui.Dialog&&$R.close("side");},$i.setLockView=function($R){this.lockLayer||(this.lockLayer=new $u(),this.lockLayer.mouseEnabled=!0,this.lockLayer.size($x.stage.width,$x.stage.height)),this.lockLayer.removeChildren(),$R&&($R.centerX=$R.centerY=0,this.lockLayer.addChild($R));},$i._onResize=function($R){var $F=this.maskLayer.width=$x.stage.width,$i=this.maskLayer.height=$x.stage.height;this.lockLayer&&this.lockLayer.size($F,$i),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,$F,$i,$L.popupBgColor),this.maskLayer.alpha=$L.popupBgAlpha;for(var $j=this.numChildren-1;-1<$j;$j--){var $t=this.getChildAt($j);$t.popupCenter&&this._centerDialog($t);}},$i._centerDialog=function($R){$R.x=Math.round(($x.stage.width-$R.width>>1)+$R.pivotX),$R.y=Math.round(($x.stage.height-$R.height>>1)+$R.pivotY);},$i.open=function($R,$F,$i){void 0===$F&&($F=!1),void 0===$i&&($i=!1),$F&&this._closeAll(),$R.popupCenter&&this._centerDialog($R),this.addChild($R),($R.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),$i&&null!=$R.popupEffect?$R.popupEffect.runWith($R):this.doOpen($R),this.event("open");},$i.doOpen=function($R){$R.onOpened();},$i.lock=function($R){this.lockLayer&&($R?this.addChild(this.lockLayer):this.lockLayer.removeSelf());},$i.close=function($R,$F,$i){void 0===$i&&($i=!1),$i&&null!=$R.closeEffect?$R.closeEffect.runWith([$R,$F]):this.doClose($R,$F),this.event("close");},$i.doClose=function($R,$F){$R.removeSelf(),$R.isModal&&this._checkMask(),$R.closeHandler&&$R.closeHandler.runWith($F),$R.onClosed($F);},$i.closeAll=function(){this._closeAll(),this.event("close");},$i._closeAll=function(){for(var $R=this.numChildren-1;-1<$R;$R--){var $F=this.getChildAt($R);$F&&null!=$F.close&&this.doClose($F);}},$i.getDialogsByGroup=function($R){for(var $F=[],$i=this.numChildren-1;-1<$i;$i--){var $j=this.getChildAt($i);$j&&$j.group===$R&&$F.push($j);}return $F;},$i.closeByGroup=function($R){for(var $F=[],$i=this.numChildren-1;-1<$i;$i--){var $j=this.getChildAt($i);$j&&$j.group===$R&&($j.close(),$F.push($j));}return $F;},$i._checkMask=function(){this.maskLayer.removeSelf();for(var $R=this.numChildren-1;-1<$R;$R--){var $F=this.getChildAt($R);if($F&&$F.isModal)return void this.addChildAt(this.maskLayer,$R);}},$F;}(),$u=function($R){function $F(){$F.__super.call(this);}$p($F,"laya.ui.Box",$R);var $i=$F.prototype;return $x.imps($i,{"laya.ui.IBox":!0}),$$(0,$i,"dataSource",$R.prototype._$get_dataSource,function($R){for(var $F in this._dataSource=$R){var $i=this.getChildByName($F);$i?$i.dataSource=$R[$F]:this.hasOwnProperty($F)&&"function"!=typeof this[$F]&&(this[$F]=$R[$F]);}}),$F;}($f),$v=function($F){function $i($R,$F){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,$i.__super.call(this),this._labelColors=$B.buttonLabelColors,this._stateNum=$B.buttonStateNum,void 0===$F&&($F=""),this.skin=$R,this.label=$F;}$p($i,"laya.ui.Button",$F);var $R=$i.prototype;return $x.imps($R,{"laya.ui.ISelect":!0}),$R.destroy=function($R){this.clearEvent(),$M.clearCache(this,this._skin),$M.clearObject(this,this._weakKey),void 0===$R&&($R=!0),$F.prototype.destroy.call(this,$R),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy($R),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null;},$R.clearEvent=function(){this._skin&&$t.atalsNotify&&$t.atalsNotify.off(this._skin,this,this._setBtnSource);},$R.createChildren=function(){this.graphics=this._bitmap=new $Y();},$R.createText=function(){this._text||(this._text=new $w(),this._text.overflow=$w.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height);},$R.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1);},$R.onMouse=function($R){if(!1!==this.toggle||!this._selected)return"click"===$R.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=$i.stateMap[$R.type]));},$R.changeClips=function(){var $R=$M.getRes(this._skin);if($R)if(this._skin&&""!=this._skin){$M.clearObject(this,this._weakKey);var $F=$R.sourceWidth,$i=$R.sourceHeight/this._stateNum;$R.$_GID||($R.$_GID=$_.getGID());var $j=$R.$_GID+"-"+this._stateNum,$t=$M.findObject($j);if($_.isOkTextureList($t)||($t=null),$t)this._weakKey=$j,$M.keepObject(this,this._weakKey),this._sources=$t;else{if(this._sources=[],1===this._stateNum)this._sources.push($R);else for(var $p=0;$p<this._stateNum;$p++){var $$=$X.createFromTexture($R,0,$i*$p,$F,$i);if($R.alphaTexture){var $V=$R.width/$R.alphaTexture.width;$$.alphaTexture=$X.createFromTexture($R.alphaTexture,0/$V,$i*$p/$V,$F/$V,$i/$V);}this._sources.push($$);}$M.saveObject($j,this._sources),this._weakKey=$j,$M.keepObject(this,this._weakKey);}this._autoSize?(this._bitmap.width=this._width||$F,this._bitmap.height=this._height||$i,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=$F);}else console.warn("lose skin ",this._skin,this.name,this.__className);},$R.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var $R=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[$R]),this.label&&(this._text.color=this._labelColors[$R],this._strokeColors&&(this._text.strokeColor=this._strokeColors[$R]));},$R._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState));},$$(0,$R,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor;},function($R){this.createText(),this._text.strokeColor=$R;}),$$(0,$R,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height;}),$$(0,$R,"skin",function(){return this._skin;},function($R){if(this._skin!=$R)if(this.clearEvent(),$M.clearCache(this,this._skin),this._skin=$R,$M.keepCache(this,this._skin),$M.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var $F=$t.resAtalsObj&&$t.resAtalsObj[this._skin];$F?($t.atalsNotify&&$t.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=$F.sourceW),0==this.height&&(this.height=$F.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className);}}),$R._setBtnSource=function($R,$F){$R===this._skin&&$F&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent());},$$(0,$R,"state",function(){return this._state;},function($R){this._state!=$R&&(this._state=$R,this._setStateChanged());}),$$(0,$R,"text",function(){return this.createText(),this._text;}),$$(0,$R,"stateNum",function(){return this._stateNum;},function($R){"string"==typeof $R&&($R=parseInt($R)),this._stateNum!=$R&&(this._stateNum=$R<1?1:3<$R?3:$R,this.callLater(this.changeClips));}),$$(0,$R,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):"";},function($R){this._strokeColors=$z.fillArray($B.buttonLabelColors,$R,String),this._setStateChanged();}),$$(0,$R,"labelColors",function(){return this._labelColors.join(",");},function($R){this._labelColors=$z.fillArray($B.buttonLabelColors,$R,String),this._setStateChanged();}),$$(0,$R,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0));}),$$(0,$R,"label",function(){return this._text?this._text.text:null;},function($R){(this._text||$R)&&(this.createText(),this._text.text!=$R&&($R&&!this._text.parent&&this.addChild(this._text),this._text.text=($R+"").replace(/\\n/g,"\n"),this._setStateChanged()));}),$$(0,$R,"selected",function(){return this._selected;},function($R){this._selected!=$R&&(this._selected=$R,this.state=this._selected?2:0,this.event("change"));}),$$(0,$R,"labelPadding",function(){return this.createText(),this._text.padding.join(",");},function($R){this.createText(),this._text.padding=$z.fillArray($B.labelPadding,$R,Number);}),$$(0,$R,"labelSize",function(){return this.createText(),this._text.fontSize;},function($R){this.createText(),this._text.fontSize=$R;}),$$(0,$R,"labelStroke",function(){return this.createText(),this._text.stroke;},function($R){this.createText(),this._text.stroke=$R;}),$$(0,$R,"labelBold",function(){return this.createText(),this._text.bold;},function($R){this.createText(),this._text.bold=$R;}),$$(0,$R,"labelFont",function(){return this.createText(),this._text.font;},function($R){this.createText(),this._text.font=$R;}),$$(0,$R,"labelAlign",function(){return this.createText(),this._text.align;},function($R){this.createText(),this._text.align=$R;}),$$(0,$R,"clickHandler",function(){return this._clickHandler;},function($R){this._clickHandler=$R;}),$$(0,$R,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null;},function($R){this._bitmap.sizeGrid=$z.fillArray($B.defaultSizeGrid,$R,Number);}),$$(0,$R,"width",$F.prototype._$get_width,function($R){$x.superSet($f,this,"width",$R),this._autoSize&&(this._bitmap.width=$R,this._text&&(this._text.width=$R));}),$$(0,$R,"height",$F.prototype._$get_height,function($R){$x.superSet($f,this,"height",$R),this._autoSize&&(this._bitmap.height=$R,this._text&&(this._text.height=$R));}),$$(0,$R,"dataSource",$F.prototype._$get_dataSource,function($R){"number"==typeof(this._dataSource=$R)||"string"==typeof $R?this.label=$R+"":$x.superSet($f,this,"dataSource",$R);}),$$(0,$R,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null;},function($R){this._bitmap._offset=$R?$z.fillArray([1,1],$R,Number):[];}),$j($i,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0};}]),$i;}($f),$K=function($F){function $j($R,$F,$i){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,$j.__super.call(this),void 0===$F&&($F=1),void 0===$i&&($i=1),this._clipX=$F,this._clipY=$i,this.skin=$R;}$p($j,"laya.ui.Clip",$F);var $R=$j.prototype;return $R.destroy=function($R){this.clearEvent(),this.clearLoad(),$M.clearCache(this,this._skin),$M.clearObject(this,this._weakKey),void 0===$R&&($R=!0),$F.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null;},$R.dispose=function(){this.destroy(!0),$x.loader.clearRes(this._skin);},$R.createChildren=function(){this.graphics=this._bitmap=new $Y();},$R._onDisplay=function($R){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play();},$R.changeClip=function(){if(this._clipChanged=!1,this._skin){var $R=$M.getRes(this._skin);if($R)this.loadComplete(this._skin,$R);else{if($t.resAtalsObj&&$t.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=$k.create(this,this.loadComplete,[this._skin]),this._progress=null,$x.loader.load(this._skin,this._complete,this._progress);}}},$R.loadComplete=function($R,$F){if($R===this._skin&&$F){$M.clearObject(this,this._weakKey);var $i=this._clipWidth||Math.ceil($F.sourceWidth/this._clipX),$j=this._clipHeight||Math.ceil($F.sourceHeight/this._clipY),$t=this._skin+$i+$j,$p=$M.findObject($t);if($_.isOkTextureList($p)||($p=null),$p)this._weakKey=$t,$M.keepObject(this,this._weakKey),this._sources=$p;else{this._sources=[];for(var $$=0;$$<this._clipY;$$++)for(var $V=0;$V<this._clipX;$V++){var $N=$X.createFromTexture($F,$i*$V,$j*$$,$i,$j);if($F.alphaTexture){var $c=$F.width/$F.alphaTexture.width;$N.alphaTexture=$X.createFromTexture($F.alphaTexture,$i*$V/$c,$j*$$/$c,$i/$c,$j/$c);}this._sources.push($N);}$M.saveObject($t,this._sources),this._weakKey=$t,$M.keepObject(this,this._weakKey);}this.index=this._index,this.event("loaded"),this.onCompResize();}},$R.play=function($R,$F){void 0===$R&&($R=0),void 0===$F&&($F=-1),this._isPlaying=!0,this.index=$R,this._toIndex=$F,this._index++,$x.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay);},$R._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index);},$R.stop=function(){this._isPlaying=!1,$x.timer.clear(this,this._loop),this.event("complete");},$R._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip));},$$(0,$R,"interval",function(){return this._interval;},function($R){this._interval!=$R&&(this._interval=$R,this._isPlaying&&this.play());}),$R.clearEvent=function(){this._skin&&$t.atalsNotify&&$t.atalsNotify.off(this._skin,this,this._setBtnSource);},$R.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$x.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null);},$$(0,$R,"skin",function(){return this._skin;},function($R){if(this._skin!=$R)if(this.clearLoad(),this.clearEvent(),$M.clearCache(this,this._skin),this._skin=$R){$M.keepCache(this,this._skin);var $F=$M.getRes($R),$i=$t.resAtalsObj&&$t.resAtalsObj[this._skin];!$F&&$i?$t.atalsNotify&&$t.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged();}else this._bitmap.source=null;}),$R._setBtnSource=function($R,$F){$R===this._skin&&$F&&(this.loadComplete($R,$F),this.clearEvent());},$$(0,$R,"sources",function(){return this._sources;},function($R){this._sources=$R,this.index=this._index,this.event("loaded");}),$$(0,$R,"clipX",function(){return this._clipX;},function($R){this._clipX=$R||1,this._setClipChanged();}),$$(0,$R,"clipY",function(){return this._clipY;},function($R){this._clipY=$R||1,this._setClipChanged();}),$$(0,$R,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0;}),$$(0,$R,"clipWidth",function(){return this._clipWidth;},function($R){this._clipWidth=$R,this._setClipChanged();}),$$(0,$R,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null;},function($R){this._bitmap.sizeGrid=$z.fillArray($B.defaultSizeGrid,$R,Number);}),$$(0,$R,"group",function(){return this._group;},function($R){$R&&this._skin&&$M.setGroup(this._skin,$R),this._group=$R;}),$$(0,$R,"clipHeight",function(){return this._clipHeight;},function($R){this._clipHeight=$R,this._setClipChanged();}),$$(0,$R,"width",$F.prototype._$get_width,function($R){$x.superSet($f,this,"width",$R),this._bitmap.width=$R;}),$$(0,$R,"height",$F.prototype._$get_height,function($R){$x.superSet($f,this,"height",$R),this._bitmap.height=$R;}),$$(0,$R,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width;}),$$(0,$R,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height;}),$$(0,$R,"index",function(){return this._index;},function($R){this._index=$R,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[$R]),this.event("change");}),$$(0,$R,"autoPlay",function(){return this._autoPlay;},function($R){this._autoPlay!=$R&&((this._autoPlay=$R)?this.play():this.stop());}),$$(0,$R,"isPlaying",function(){return this._isPlaying;},function($R){this._isPlaying=$R;}),$$(0,$R,"dataSource",$F.prototype._$get_dataSource,function($R){"number"==typeof(this._dataSource=$R)&&Math.floor($R)==$R||"string"==typeof $R?this.index=parseInt($R):$x.superSet($f,this,"dataSource",$R);}),$$(0,$R,"bitmap",function(){return this._bitmap;}),$j;}($f),$e=function($F){function $R(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,$R.__super.call(this);}$p($R,"laya.ui.ColorPicker",$F);var $i=$R.prototype;return $i.destroy=function($R){void 0===$R&&($R=!0),$F.prototype.destroy.call(this,$R),this._colorPanel&&this._colorPanel.destroy($R),this._colorButton&&this._colorButton.destroy($R),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null;},$i.createChildren=function(){this.addChild(this._colorButton=new $v()),this._colorPanel=new $u(),this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new $d()),this._colorPanel.addChild(this._colorBlock=new $d()),this._colorPanel.addChild(this._colorInput=new $h());},$i.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor;},$i.onPanelMouseDown=function($R){$R.stopPropagation();},$i.changePanel=function(){this._panelChanged=!1;var $R=this._colorPanel.graphics;$R.clear(),$R.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,($R=this._colorTiles.graphics).clear();for(var $F=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],$i=0;$i<12;$i++)for(var $j=0;$j<20;$j++){var $t=0;$t=0===$j?$F[$i]:1===$j?0:51*(((3*$i+$j/6)%3<<0)+3*($i/6<<0))<<16|$j%6*51<<8|($i<<0)%6*51;var $p=$z.toColor($t);this._colors.push($p);var $$=$j*this._gridSize,$V=$i*this._gridSize;$R.drawRect($$,$V,this._gridSize,this._gridSize,$p,"#000000");}},$i.onColorButtonClick=function($R){this._colorPanel.parent?this.close():this.open();},$i.open=function(){var $R=this.localToGlobal(new $S()),$F=$R.x+this._colorPanel.width<=$x.stage.width?$R.x:$x.stage.width-this._colorPanel.width,$i=$R.y+this._colorButton.height;$i=$i+this._colorPanel.height<=$x.stage.height?$i:$R.y-this._colorPanel.height,this._colorPanel.pos($F,$i),this._colorPanel.zOrder=1001,$x._currentStage.addChild(this._colorPanel),$x.stage.on("mousedown",this,this.removeColorBox);},$i.close=function(){$x.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf();},$i.removeColorBox=function($R){this.close();},$i.onColorFieldKeyDown=function($R){13==$R.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),$R.stopPropagation());},$i.onColorInputChange=function($R){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF");},$i.onColorTilesClick=function($R){this.selectedColor=this.getColorByMouse(),this.close();},$i.onColorTilesMouseMove=function($R){this._colorInput.focus=!1;var $F=this.getColorByMouse();this._colorInput.text=$F,this.drawBlock($F);},$i.getColorByMouse=function(){var $R=this._colorTiles.getMousePoint(),$F=Math.floor($R.x/this._gridSize),$i=Math.floor($R.y/this._gridSize);return this._colors[20*$i+$F];},$i.drawBlock=function($R){var $F=this._colorBlock.graphics;$F.clear();var $i=$R||"#ffffff";$F.drawRect(0,0,50,20,$i,this._borderColor),$R||$F.drawLine(0,0,50,20,"#ff0000");},$i.changeColor=function(){var $R=this.graphics;$R.clear();var $F=this._selectedColor||"#000000";$R.drawRect(0,0,this._colorButton.width,this._colorButton.height,$F);},$i._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel));},$$(0,$i,"inputBgColor",function(){return this._inputBgColor;},function($R){this._inputBgColor=$R,this._setPanelChanged();}),$$(0,$i,"selectedColor",function(){return this._selectedColor;},function($R){this._selectedColor!=$R&&(this._selectedColor=this._colorInput.text=$R,this.drawBlock($R),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",$c.EMPTY.setTo("change",this,this)));}),$$(0,$i,"skin",function(){return this._colorButton.skin;},function($R){this._colorButton.skin=$R,this.changeColor();}),$$(0,$i,"bgColor",function(){return this._bgColor;},function($R){this._bgColor=$R,this._setPanelChanged();}),$$(0,$i,"borderColor",function(){return this._borderColor;},function($R){this._borderColor=$R,this._setPanelChanged();}),$$(0,$i,"inputColor",function(){return this._inputColor;},function($R){this._inputColor=$R,this._setPanelChanged();}),$R;}($f),$Q=function($F){function $i($R,$F){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,$i.__super.call(this),this._itemColors=$B.comboBoxItemColors,this.skin=$R,this.labels=$F;}$p($i,"laya.ui.ComboBox",$F);var $R=$i.prototype;return $R.destroy=function($R){void 0===$R&&($R=!0),$F.prototype.destroy.call(this,$R),this._button&&this._button.destroy($R),this._list&&this._list.destroy($R),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null;},$R.createChildren=function(){this.addChild(this._button=new $v()),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown);},$R._createList=function(){this._list=new $C(),this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list);},$R._setListEvent=function($R){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=$k.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown);},$R.onListDown=function($R){$R.stopPropagation();},$R.onScrollBarDown=function($R){$R.stopPropagation();},$R.onButtonMouseDown=function($R){this.callLater(this.switchTo,[!this._isOpen]);},$R.changeList=function(){this._listChanged=!1;var $R=this.width-2,$F=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:$R,height:this._itemHeight,fontSize:this._itemSize,color:$F}}]},this._list.repeatY=this._visibleNum,this._list.refresh();},$R.onlistItemMouse=function($R,$F){var $i=$R.type;if("mouseover"===$i||"mouseout"===$i){if(this._isCustomList)return;var $j=this._list.getCell($F);if(!$j)return;var $t=$j.getChildByName("label");$t&&("mouseover"===$i?($t.bgColor=this._itemColors[0],$t.color=this._itemColors[1]):($t.bgColor=null,$t.color=this._itemColors[2]));}else"click"===$i&&(this.selectedIndex=$F,this.isOpen=!1);},$R.switchTo=function($R){this.isOpen=$R;},$R.changeOpen=function(){this.isOpen=!this._isOpen;},$R.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var $R=this._list.graphics;$R.clear(),$R.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3]);}for(var $F=this._list.array||[],$i=$F.length=0,$j=this._labels.length;$i<$j;$i++)$F.push({label:this._labels[$i]});this._list.height=this._listHeight,this._list.array=$F;},$R.changeSelected=function(){this._button.label=this.selectedLabel;},$R._onStageMouseWheel=function($R){this._list&&!this._list.contains($R.target)&&this.removeList(null);},$R.removeList=function($R){$x.stage.off("mousedown",this,this.removeList),$x.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1;},$$(0,$R,"selectedIndex",function(){return this._selectedIndex;},function($R){this._selectedIndex!=$R&&(this._selectedIndex=$R,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[$c.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex));}),$$(0,$R,"measureHeight",function(){return this._button.height;}),$$(0,$R,"skin",function(){return this._button.skin;},function($R){this._button.skin!=$R&&(this._button.skin=$R,this._listChanged=!0);}),$$(0,$R,"measureWidth",function(){return this._button.width;}),$$(0,$R,"width",$F.prototype._$get_width,function($R){$x.superSet($f,this,"width",$R),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0;}),$$(0,$R,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null;},function($R){this.selectedIndex=this._labels.indexOf($R);}),$$(0,$R,"labels",function(){return this._labels.join(",");},function($R){0<this._labels.length&&(this.selectedIndex=-1),$R?this._labels=$R.split(","):this._labels.length=0,this._itemChanged=!0;}),$$(0,$R,"height",$F.prototype._$get_height,function($R){$x.superSet($f,this,"height",$R),this._button.height=this._height;}),$$(0,$R,"selectHandler",function(){return this._selectHandler;},function($R){this._selectHandler=$R;}),$$(0,$R,"visibleNum",function(){return this._visibleNum;},function($R){this._visibleNum=$R,this._listChanged=!0;}),$$(0,$R,"labelBold",function(){return this._button.text.bold;},function($R){this._button.text.bold=$R;}),$$(0,$R,"itemColors",function(){return String(this._itemColors);},function($R){this._itemColors=$z.fillArray(this._itemColors,$R,String),this._listChanged=!0;}),$$(0,$R,"itemSize",function(){return this._itemSize;},function($R){this._itemSize=$R,this._listChanged=!0;}),$$(0,$R,"scrollBar",function(){return this.list.scrollBar;}),$$(0,$R,"isOpen",function(){return this._isOpen;},function($R){if(this._isOpen!=$R)if(this._isOpen=$R,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var $F=this.localToGlobal($S.TEMP.setTo(0,0)),$i=$F.y+this._button.height;$i=$i+this._listHeight<=$x.stage.height?$i:$F.y-this._listHeight,this._list.pos($F.x,$i),this._list.zOrder=1001,$x._currentStage.addChild(this._list),$x.stage.once("mousedown",this,this.removeList),$x.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex;}else this._list&&this._list.removeSelf();}),$$(0,$R,"scrollBarSkin",function(){return this._scrollBarSkin;},function($R){this._scrollBarSkin=$R;}),$$(0,$R,"sizeGrid",function(){return this._button.sizeGrid;},function($R){this._button.sizeGrid=$R;}),$$(0,$R,"button",function(){return this._button;}),$$(0,$R,"list",function(){return this._list||this._createList(),this._list;},function($R){$R&&($R.removeSelf(),this._isCustomList=!0,this._list=$R,this._setListEvent($R),this._itemHeight=$R.getCell(0).height+$R.spaceY);}),$$(0,$R,"dataSource",$F.prototype._$get_dataSource,function($R){"number"==typeof(this._dataSource=$R)&&Math.floor($R)==$R||"string"==typeof $R?this.selectedIndex=parseInt($R):$R instanceof Array?this.labels=$R.join(","):$x.superSet($f,this,"dataSource",$R);}),$$(0,$R,"labelColors",function(){return this._button.labelColors;},function($R){this._button.labelColors!=$R&&(this._button.labelColors=$R);}),$$(0,$R,"labelPadding",function(){return this._button.text.padding.join(",");},function($R){this._button.text.padding=$z.fillArray($B.labelPadding,$R,Number);}),$$(0,$R,"labelSize",function(){return this._button.text.fontSize;},function($R){this._button.text.fontSize=$R;}),$$(0,$R,"labelFont",function(){return this._button.text.font;},function($R){this._button.text.font=$R;}),$$(0,$R,"stateNum",function(){return this._button.stateNum;},function($R){this._button.stateNum=$R;}),$i;}($f),$b=function($F){function $i($R){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,$i.__super.call(this),this._showButtons=$L.showButtons,this._touchScrollEnable=$L.touchScrollEnable,this._mouseWheelEnable=$L.mouseWheelEnable,this.skin=$R,this.max=1;}$p($i,"laya.ui.ScrollBar",$F);var $R=$i.prototype;return $R.destroy=function($R){void 0===$R&&($R=!0),this.stopScroll(),this.target=null,$F.prototype.destroy.call(this,$R),this.upButton&&this.upButton.destroy($R),this.downButton&&this.downButton.destroy($R),this.slider&&this.slider.destroy($R),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null;},$R.createChildren=function(){this.addChild(this.slider=new $G()),this.addChild(this.upButton=new $v()),this.addChild(this.downButton=new $v());},$R.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown);},$R.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value);},$R.onButtonMouseDown=function($R){var $F=$R.currentTarget===this.upButton;this.slide($F),$x.timer.once($B.scrollBarDelayTime,this,this.startLoop,[$F]),$x.stage.once("mouseup",this,this.onStageMouseUp);},$R.startLoop=function($R){$x.timer.frameLoop(1,this,this.slide,[$R]);},$R.slide=function($R){$R?this.value-=this._scrollSize:this.value+=this._scrollSize;},$R.onStageMouseUp=function($R){$x.timer.clear(this,this.startLoop),$x.timer.clear(this,this.slide);},$R.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint();},$R.changeSize=function(){$F.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value);},$R.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition();},$R.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width;},$R.setScroll=function($R,$F,$i){this.runCallLater(this.changeSize),this.slider.setSlider($R,$F,$i),this.slider.bar.visible=0<$F,!this._hide&&this.autoHide&&(this.visible=!1);},$R.onTargetMouseWheel=function($R){this.value-=$R.delta*this._scrollSize,this.target=this._target;},$R.onTargetMouseDown=function($R){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $S()),this._lastPoint.setTo($x.stage.mouseX,$x.stage.mouseY),$x.timer.clear(this,this.tweenMove),$H.clearTween(this),$x.stage.once("mouseup",this,this.onStageMouseUp2),$x.stage.once("mouseout",this,this.onStageMouseUp2),$x.timer.frameLoop(1,this,this.loop);},$R.loop=function(){var $R=$x.stage.mouseY,$F=$x.stage.mouseX;if(this._lastOffset=this.isVertical?$R-this._lastPoint.y:$F-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?$x.stage._canvasTransform.getScaleY():$x.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start");}this._offsets.push(this._lastOffset),this._lastPoint.x=$F,this._lastPoint.y=$R,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset);},$R.onStageMouseUp2=function($R){if($x.stage.off("mouseup",this,this.onStageMouseUp2),$x.stage.off("mouseout",this,this.onStageMouseUp2),$x.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?$H.to(this,{value:this.min},this.elasticBackTime,$N.sineOut,$k.create(this,this.elasticOver)):this._value>this.max&&$H.to(this,{value:this.max},this.elasticBackTime,$N.sineOut,$k.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?$x.stage.mouseY-this._lastPoint.y:$x.stage.mouseX-this._lastPoint.x);for(var $F=0,$i=Math.min(this._offsets.length,3),$j=0;$j<$i;$j++)$F+=this._offsets[this._offsets.length-1-$j];if(this._lastOffset=$F/$i,($F=Math.abs(this._lastOffset))<2)return void this.event("end");60<$F&&(this._lastOffset=0<this._lastOffset?60:-60);var $t=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));$x.timer.frameLoop(1,this,this.tweenMove,[$t]);}},$R.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&$H.to(this,{alpha:0},500),this.event("end");},$R.tweenMove=function($R){this._lastOffset*=this.rollRatio;var $F=NaN;if(0<$R&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,$F=.5*-(this.min-$R-this.value),this._lastOffset>$F&&(this._lastOffset=$F)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,$F=.5*-(this.max+$R-this.value),this._lastOffset<$F&&(this._lastOffset=$F))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if($x.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?$H.to(this,{value:this.min},this.elasticBackTime,$N.sineOut,$k.create(this,this.elasticOver)):this._value>this.max?$H.to(this,{value:this.max},this.elasticBackTime,$N.sineOut,$k.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&$H.to(this,{alpha:0},500);}},$R.stopScroll=function(){this.onStageMouseUp2(null),$x.timer.clear(this,this.tweenMove),$H.clearTween(this);},$$(0,$R,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height;}),$$(0,$R,"skin",function(){return this._skin;},function($R){this._skin!=$R&&(this._skin=$R,this.slider.skin=this._skin,this.callLater(this.changeScrollBar));}),$$(0,$R,"max",function(){return this.slider.max;},function($R){this.slider.max=$R;}),$$(0,$R,"showButtons",function(){return this._showButtons;},function($R){this._showButtons=$R,this.callLater(this.changeScrollBar);}),$$(0,$R,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100;}),$$(0,$R,"min",function(){return this.slider.min;},function($R){this.slider.min=$R;}),$$(0,$R,"value",function(){return this._value;},function($R){$R!==this._value&&(this._value=$R,this._isElastic||(this.slider._value!=$R&&(this.slider._value=$R,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value));}),$$(0,$R,"isVertical",function(){return this.slider.isVertical;},function($R){this.slider.isVertical=$R;}),$$(0,$R,"sizeGrid",function(){return this.slider.sizeGrid;},function($R){this.slider.sizeGrid=$R;}),$$(0,$R,"scrollSize",function(){return this._scrollSize;},function($R){this._scrollSize=$R;}),$$(0,$R,"dataSource",$F.prototype._$get_dataSource,function($R){"number"==typeof(this._dataSource=$R)||"string"==typeof $R?this.value=Number($R):$x.superSet($f,this,"dataSource",$R);}),$$(0,$R,"thumbPercent",function(){return this._thumbPercent;},function($R){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),$R=1<=$R?.99:$R,this._thumbPercent=$R,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*$R,$B.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*$R,$B.scrollBarMinNum));}),$$(0,$R,"target",function(){return this._target;},function($R){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=$R)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown));}),$$(0,$R,"hide",function(){return this._hide;},function($R){this._hide=$R,this.visible=!$R;}),$$(0,$R,"touchScrollEnable",function(){return this._touchScrollEnable;},function($R){this._touchScrollEnable=$R,this.target=this._target;}),$$(0,$R,"mouseWheelEnable",function(){return this._mouseWheelEnable;},function($R){this._mouseWheelEnable=$R,this.target=this._target;}),$$(0,$R,"tick",function(){return this.slider.tick;},function($R){this.slider.tick=$R;}),$i;}($f),$G=function($F){function $i($R){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,$i.__super.call(this),this.skin=$R;}$p($i,"laya.ui.Slider",$F);var $R=$i.prototype;return $R.destroy=function($R){void 0===$R&&($R=!0),$F.prototype.destroy.call(this,$R),this._bg&&this._bg.destroy($R),this._bar&&this._bar.destroy($R),this._progress&&this._progress.destroy($R),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null;},$R.createChildren=function(){this.addChild(this._bg=new $O()),this.addChild(this._bar=new $v());},$R.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0;},$R.onBarMouseDown=function($R){this._globalSacle||(this._globalSacle=new $S()),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=$x.stage.mouseX,this._ty=$x.stage.mouseY,$x.stage.on("mousemove",this,this.mouseMove),$x.stage.once("mouseup",this,this.mouseUp),$x.stage.once("mouseout",this,this.mouseUp),this.showValueText();},$R.showValueText=function(){if(this.showLabel){var $R=laya.ui.Slider.label;this.addChild($R),$R.textField.changeText(this._value+""),this.isVertical?($R.x=this._bar.x+20,$R.y=.5*(this._bar.height-$R.height)+this._bar.y):($R.y=this._bar.y-20,$R.x=.5*(this._bar.width-$R.width)+this._bar.x);}},$R.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf();},$R.mouseUp=function($R){$x.stage.off("mousemove",this,this.mouseMove),$x.stage.off("mouseup",this,this.mouseUp),$x.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText();},$R.mouseMove=function($R){var $F=this._value;this.isVertical?(this._bar.y+=($x.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=($x.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=$x.stage.mouseX,this._ty=$x.stage.mouseY;var $i=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$i)/$i,this._value!=$F&&this.sendChangeEvent(),this.showValueText();},$R.sendChangeEvent=function($R){void 0===$R&&($R="change"),this.event($R),this.changeHandler&&this.changeHandler.runWith(this._value);},$R.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height));},$R.changeSize=function(){$F.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue();},$R.setSlider=function($R,$F,$i){this._value=-1,this._min=$R,this._max=$R<$F?$F:$R,this.value=$i<$R?$R:$F<$i?$F:$i;},$R.changeValue=function(){var $R=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$R)/$R,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var $F=this._max-this._min;0===$F&&($F=1),this.isVertical?(this._bar.y=(this._value-this._min)/$F*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/$F*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width));},$R.onBgMouseDown=function($R){var $F=this._bg.getMousePoint();this.isVertical?this.value=$F.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=$F.x/(this.width-this._bar.width)*(this._max-this._min)+this._min;},$$(0,$R,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height);}),$$(0,$R,"skin",function(){return this._skin;},function($R){if(this._skin!=$R){this._skin=$R,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var $F=this._skin.replace(".png","$progress.png");$M.getRes($F)&&(this._progress||(this.addChild(this._progress=new $O()),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=$F),this.setBarPoint(),this.callLater(this.changeValue);}}),$$(0,$R,"allowClickBack",function(){return this._allowClickBack;},function($R){this._allowClickBack!=$R&&((this._allowClickBack=$R)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown));}),$$(0,$R,"max",function(){return this._max;},function($R){this._max!=$R&&(this._max=$R,this.callLater(this.changeValue));}),$$(0,$R,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width);}),$$(0,$R,"tick",function(){return this._tick;},function($R){this._tick!=$R&&(this._tick=$R,this.callLater(this.changeValue));}),$$(0,$R,"sizeGrid",function(){return this._bg.sizeGrid;},function($R){this._bg.sizeGrid=$R,this._bar.sizeGrid=$R,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid);}),$$(0,$R,"min",function(){return this._min;},function($R){this._min!=$R&&(this._min=$R,this.callLater(this.changeValue));}),$$(0,$R,"value",function(){return this._value;},function($R){if(this._value!=$R){var $F=this._value;this._value=$R,this.changeValue(),this._value!=$F&&this.sendChangeEvent();}}),$$(0,$R,"dataSource",$F.prototype._$get_dataSource,function($R){"number"==typeof(this._dataSource=$R)||"string"==typeof $R?this.value=Number($R):$x.superSet($f,this,"dataSource",$R);}),$$(0,$R,"bar",function(){return this._bar;}),$j($i,["label",function(){return this.label=new $y();}]),$i;}($f),$O=function($F){function $i($R){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,$i.__super.call(this),this.skin=$R;}$p($i,"laya.ui.Image",$F);var $R=$i.prototype;return $R.destroy=function($R){void 0===$R&&($R=!0),$F.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,$M.clearCache(this,this._skin);},$R.dispose=function(){this.destroy(!0),$M.clearCache(this,this._skin),this.clearEvent();},$R.createChildren=function(){this.graphics=this._bitmap=new $Y();},$R.setSource=function($R,$F){this.destroyed||$R===this._skin&&$F&&(this.source=$F,this.onCompResize(),this.clearEvent());},$R.clearEvent=function(){this._skin&&$t.atalsNotify&&$t.atalsNotify.off(this._skin,this,this.setSource);},$R.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$x.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null);},$$(0,$R,"source",function(){return this._bitmap.source;},function($R){this._bitmap&&(this._bitmap.source=$R,this.event("loaded"),this.repaint());}),$$(0,$R,"dataSource",$F.prototype._$get_dataSource,function($R){"string"==typeof(this._dataSource=$R)?this.skin=$R:$x.superSet($f,this,"dataSource",$R);}),$$(0,$R,"measureHeight",function(){return this._bitmap.height;}),$$(0,$R,"skin",function(){return this._skin;},function($R){if(this._skin!=$R)if($M.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=$R){$M.keepCache(this,this._skin);var $F=$M.getRes($R),$i=$t.resAtalsObj&&$t.resAtalsObj[this._skin];$F?(this.source=$F,this.onCompResize()):$i?($t.atalsNotify&&$t.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=$i.sourceW),0==this.height&&(this.height=$i.sourceH)):(this._complete=$k.create(this,this.setSource,[this._skin]),this._progress=null,$x.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group));}else this.source=null;}),$$(0,$R,"group",function(){return this._group;},function($R){$R&&this._skin&&$M.setGroup(this._skin,$R),this._group=$R;}),$$(0,$R,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null;},function($R){this._bitmap.sizeGrid=$z.fillArray($B.defaultSizeGrid,$R,Number);}),$$(0,$R,"measureWidth",function(){return this._bitmap.width;}),$$(0,$R,"width",$F.prototype._$get_width,function($R){$x.superSet($f,this,"width",$R),this._bitmap.width=0==$R?1e-7:$R;}),$$(0,$R,"height",$F.prototype._$get_height,function($R){$x.superSet($f,this,"height",$R),this._bitmap.height=0==$R?1e-7:$R;}),$i;}($f),$y=function($F){function $i($R){this._tf=null,$i.__super.call(this),void 0===$R&&($R=""),$q.defaultColor=$B.labelColor,this.text=$R;}$p($i,"laya.ui.Label",$F);var $R=$i.prototype;return $R.destroy=function($R){void 0===$R&&($R=!0),$F.prototype.destroy.call(this,$R),this._tf=null;},$R.createChildren=function(){this.addChild(this._tf=new $w());},$R.changeText=function($R){this._tf.changeText($R);},$$(0,$R,"padding",function(){return this._tf.padding.join(",");},function($R){this._tf.padding=$z.fillArray($B.labelPadding,$R,Number);}),$$(0,$R,"bold",function(){return this._tf.bold;},function($R){this._tf.bold=$R;}),$$(0,$R,"align",function(){return this._tf.align;},function($R){this._tf.align=$R;}),$$(0,$R,"text",function(){return this._tf.text;},function($R){this._tf.text!=$R&&($R&&($R=$z.adptString($R+"")),this._tf.text=$R,this.event("change"),this._width&&this._height||this.onCompResize());}),$$(0,$R,"italic",function(){return this._tf.italic;},function($R){this._tf.italic=$R;}),$$(0,$R,"wordWrap",function(){return this._tf.wordWrap;},function($R){this._tf.wordWrap=$R;}),$$(0,$R,"font",function(){return this._tf.font;},function($R){this._tf.font=$R;}),$$(0,$R,"dataSource",$F.prototype._$get_dataSource,function($R){"number"==typeof(this._dataSource=$R)||"string"==typeof $R?this.text=$R+"":$x.superSet($f,this,"dataSource",$R);}),$$(0,$R,"color",function(){return this._tf.color;},function($R){this._tf.color=$R;}),$$(0,$R,"valign",function(){return this._tf.valign;},function($R){this._tf.valign=$R;}),$$(0,$R,"leading",function(){return this._tf.leading;},function($R){this._tf.leading=$R;}),$$(0,$R,"fontSize",function(){return this._tf.fontSize;},function($R){this._tf.fontSize=$R;}),$$(0,$R,"bgColor",function(){return this._tf.bgColor;},function($R){this._tf.bgColor=$R;}),$$(0,$R,"borderColor",function(){return this._tf.borderColor;},function($R){this._tf.borderColor=$R;}),$$(0,$R,"stroke",function(){return this._tf.stroke;},function($R){this._tf.stroke=$R;}),$$(0,$R,"strokeColor",function(){return this._tf.strokeColor;},function($R){this._tf.strokeColor=$R;}),$$(0,$R,"textField",function(){return this._tf;}),$$(0,$R,"measureWidth",function(){return this._tf.width;}),$$(0,$R,"measureHeight",function(){return this._tf.height;}),$$(0,$R,"width",function(){return this._width||this._tf.text?$x.superGet($f,this,"width"):0;},function($R){$x.superSet($f,this,"width",$R),this._tf.width=$R;}),$$(0,$R,"height",function(){return this._height||this._tf.text?$x.superGet($f,this,"height"):0;},function($R){$x.superSet($f,this,"height",$R),this._tf.height=$R;}),$$(0,$R,"overflow",function(){return this._tf.overflow;},function($R){this._tf.overflow=$R;}),$$(0,$R,"underline",function(){return this._tf.underline;},function($R){this._tf.underline=$R;}),$$(0,$R,"underlineColor",function(){return this._tf.underlineColor;},function($R){this._tf.underlineColor=$R;}),$i;}($f),$E=function($F){function $i($R){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,$i.__super.call(this),this.skin=$R;}$p($i,"laya.ui.ProgressBar",$F);var $R=$i.prototype;return $R.destroy=function($R){void 0===$R&&($R=!0),$F.prototype.destroy.call(this,$R),this._bg&&this._bg.destroy($R),this._bar&&this._bar.destroy($R),this._bg=this._bar=null,this.changeHandler=null;},$R.createChildren=function(){this.addChild(this._bg=new $O()),this.addChild(this._bar=new $O());},$R.changeValue=function(){if(this.sizeGrid){var $R=this.sizeGrid.split(","),$F=Number($R[3]),$i=Number($R[1]),$j=(this.width-$F-$i)*this._value;this._bar.width=$F+$i+$j,this._bar.visible=this._bar.width>$F+$i;}else this._bar.width=this.width*this._value;},$$(0,$R,"measureHeight",function(){return this._bg.height;}),$$(0,$R,"skin",function(){return this._skin;},function($R){this._skin!=$R&&(this._skin=$R,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue));}),$$(0,$R,"measureWidth",function(){return this._bg.width;}),$$(0,$R,"height",$F.prototype._$get_height,function($R){$x.superSet($f,this,"height",$R),this._bg.height=this._height,this._bar.height=this._height;}),$$(0,$R,"bar",function(){return this._bar;}),$$(0,$R,"value",function(){return this._value;},function($R){this._value!=$R&&($R=1<$R?1:$R<0?0:$R,this._value=$R,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith($R));}),$$(0,$R,"bg",function(){return this._bg;}),$$(0,$R,"sizeGrid",function(){return this._bg.sizeGrid;},function($R){this._bg.sizeGrid=this._bar.sizeGrid=$R;}),$$(0,$R,"width",$F.prototype._$get_width,function($R){$x.superSet($f,this,"width",$R),this._bg.width=this._width,this.callLater(this.changeValue);}),$$(0,$R,"dataSource",$F.prototype._$get_dataSource,function($R){"number"==typeof(this._dataSource=$R)||"string"==typeof $R?this.value=Number($R):$x.superSet($f,this,"dataSource",$R);}),$i;}($f),$l=(function($R){function $i(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,$i.__super.call(this),this._tipBox=new $f(),this._tipBox.addChild(this._tipText=new $w()),this._tipText.x=this._tipText.y=5,this._tipText.color=$i.tipTextColor,this._defaultTipHandler=this._showDefaultTip,$x.stage.on("showtip",this,this._onStageShowTip),$x.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100;}$p($i,"laya.ui.TipManager",$f);var $F=$i.prototype;$F._onStageHideTip=function($R){$x.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf();},$F._onStageShowTip=function($R){$x.timer.once($i.tipDelay,this,this._showTip,[$R],!0);},$F._showTip=function($R){if("string"==typeof $R){var $F=String($R);Boolean($F)&&this._defaultTipHandler($F);}else $R instanceof laya.utils.Handler?$R.run():"function"==typeof $R&&$R.apply();$x.stage.on("mousemove",this,this._onStageMouseMove),$x.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null);},$F._onStageMouseDown=function($R){this.closeAll();},$F._onStageMouseMove=function($R){this._showToStage(this,$i.offsetX,$i.offsetY);},$F._showToStage=function($R,$F,$i){void 0===$F&&($F=0),void 0===$i&&($i=0);var $j=$R.getBounds();$R.x=$x.stage.mouseX+$F,$R.y=$x.stage.mouseY+$i,$R.x+$j.width>$x.stage.width&&($R.x-=$j.width+$F),$R.y+$j.height>$x.stage.height&&($R.y-=$j.height+$i);},$F.closeAll=function(){$x.timer.clear(this,this._showTip),$x.stage.off("mousemove",this,this._onStageMouseMove),$x.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren();},$F.showDislayTip=function($R){this.addChild($R),this._showToStage(this),$x._currentStage.addChild(this);},$F._showDefaultTip=function($R){this._tipText.text=$R;var $F=this._tipBox.graphics;$F.clear(),$F.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,$i.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),$x._currentStage.addChild(this);},$$(0,$F,"defaultTipHandler",function(){return this._defaultTipHandler;},function($R){this._defaultTipHandler=$R;}),$i.offsetX=10,$i.offsetY=15,$i.tipTextColor="#ffffff",$i.tipBackColor="#111111",$i.tipDelay=200;}(),function($R){var $h;function $S(){this._idMap=null,this._aniList=null,this._watchMap={},$S.__super.call(this);}$p($S,"laya.ui.View",$u);var $F=$S.prototype;return $F.createView=function($R){if($R.animations&&!this._idMap&&(this._idMap={}),$S.createComp($R,this,this),$R.animations){var $F,$i,$j=[],$t=$R.animations,$p=0,$$=$t.length;for($p=0;$p<$$;$p++){switch($F=new $s(),$i=$t[$p],$F._setUp(this._idMap,$i),(this[$i.name]=$F)._setControlNode(this),$i.action){case 1:$F.play(0,!1);break;case 2:$F.play(0,!0);}$j.push($F);}this._aniList=$j;}0<this._width&&null==$R.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0);},$F.onEvent=function($R,$F){},$F.loadUI=function($R){var $F=$S.uiMap[$R];$F&&this.createView($F);},$F.destroy=function($R){void 0===$R&&($R=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,$R);},$F.changeData=function($R){var $F=this._watchMap[$R];if($F){console.log("change",$R);for(var $i=0,$j=$F.length;$i<$j;$i++){$F[$i].exe(this);}}},$S._regs=function(){for(var $R in $S.uiClassMap)$a.regClass($R,$S.uiClassMap[$R]);},$S.createComp=function($R,$F,$i,$j){if(!($F=$F||$S.getCompInstance($R)))return console.warn("can not create:"+$R.type),null;var $t=$R.child;if($t)for(var $p=$F instanceof laya.ui.List,$$=0,$V=$t.length;$$<$V;$$++){var $N=$t[$$];if(!$F.hasOwnProperty("itemRender")||"render"!=$N.props.name&&"render"!==$N.props.renderType){if("Graphic"==$N.type)$a.addGraphicsToSprite($N,$F);else if($a.isDrawType($N.type))$a.addGraphicToSprite($N,$F,!0);else{if($p){var $c=[],$q=$S.createComp($N,null,$i,$c);$c.length&&($q._$bindData=$c);}else $q=$S.createComp($N,null,$i,$j);"Script"==$N.type?"owner"in $q?$q.owner=$F:"target"in $q&&($q.target=$F):"mask"==$N.props.renderType||"mask"==$N.props.name?$F.mask=$q:$q instanceof laya.display.Sprite&&$F.addChild($q);}}else $F.itemRender=$N;}var $s=$R.props;for(var $k in $s){var $h=$s[$k];$S.eventDic[$k]?$h&&$i&&$F.on($k,$i,$i.onEvent,[$h]):$S.setCompValue($F,$k,$h,$i,$j);}return $x.__typeof($F,"laya.ui.IItem")&&$F.initItems(),$R.compId&&$i&&$i._idMap&&($i._idMap[$R.compId]=$F),$F;},$S.setCompValue=function($R,$F,$i,$j,$t){if("string"==typeof $i&&-1<$i.indexOf("${")){if($S._sheet||($S._sheet=$a.getClass("laya.data.Table")),!$S._sheet)return void console.warn("Can not find class Sheet");if($t)$t.push($R,$F,$i);else if($j){-1==$i.indexOf("].")&&($i=$i.replace(".","[0]."));var $p,$$,$V=new $h($R,$F,$i);$V.exe($j);for(var $N=$i.replace(/\[.*?\]\./g,".");null!=($p=$S._parseWatchData.exec($N));){for(var $c=$p[1];null!=($$=$S._parseKeyWord.exec($c));){var $q=$$[0],$s=$j._watchMap[$q]||($j._watchMap[$q]=[]);$s.push($V),$S._sheet.I.notifer.on($q,$j,$j.changeData,[$q]);}($s=$j._watchMap[$c]||($j._watchMap[$c]=[])).push($V),$S._sheet.I.notifer.on($c,$j,$j.changeData,[$c]);}}}else if("var"===$F&&$j)$j[$i]=$R;else if("onClick"==$F){var $k=$x._runScript("(function(){"+$i+"})");$R.on("click",$j,$k);}else $R[$F]="true"===$i||"false"!==$i&&$i;},$S.getCompInstance=function($R){var $F,$i=$R.props?$R.props.runtime:null;return $F=$i?$S.viewClassMap[$i]||$S.uiClassMap[$i]||$x.__classmap[$i]:$S.uiClassMap[$R.type],$R.props&&$R.props.hasOwnProperty("renderType")&&"instance"==$R.props.renderType?$F.instance:$F?new $F():null;},$S.regComponent=function($R,$F){$S.uiClassMap[$R]=$F,$a.regClass($R,$F);},$S.regViewRuntime=function($R,$F){$S.viewClassMap[$R]=$F;},$S.uiMap={},$S.viewClassMap={},$S._sheet=null,$j($S,["uiClassMap",function(){return this.uiClassMap={ViewStack:$RR,LinkButton:$v,TextArea:$cR,ColorPicker:$e,Box:$u,Button:$v,CheckBox:$W,Clip:$K,ComboBox:$Q,Component:$f,HScrollBar:$r,HSlider:$P,Image:$O,Label:$y,List:$C,Panel:$A,ProgressBar:$E,Radio:$I,RadioGroup:$VR,ScrollBar:$b,Slider:$G,Tab:$NR,TextInput:$iR,View:$S,VScrollBar:$FR,VSlider:$jR,Tree:$D,HBox:$pR,VBox:$$R,Sprite:$d,Animation:$i,Text:$w,FontClip:$n};},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0};},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g;},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g;}]),$S.__init$=function(){$S._regs(),$h=function(){function $R($R,$F,$i){this.comp=null,this.prop=null,this.value=null,this.comp=$R,this.prop=$F,this.value=$i;}return $p($R,""),$R.prototype.exe=function($R){var $F=$z.getBindFun(this.value);this.comp[this.prop]=$F.call(this,$R);},$R;}();},$S;}()),$W=function($R){function $i($R,$F){void 0===$F&&($F=""),$i.__super.call(this,$R,$F);}$p($i,"laya.ui.CheckBox",$R);var $F=$i.prototype;return $F.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1;},$F.initialize=function(){$R.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0;},$$(0,$F,"dataSource",$R.prototype._$get_dataSource,function($R){"boolean"==typeof(this._dataSource=$R)?this.selected=$R:"string"==typeof $R?this.selected="true"===$R:$x.superSet($v,this,"dataSource",$R);}),$i;}($v),$o=function($R){function $F(){this._space=0,this._align="none",this._itemChanged=!1,$F.__super.call(this);}$p($F,"laya.ui.LayoutBox",$u);var $i=$F.prototype;return $i.addChild=function($R){return $R.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,$R);},$i.onResize=function($R){this._setItemChanged();},$i.addChildAt=function($R,$F){return $R.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,$R,$F);},$i.removeChild=function($R){return $R.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,$R);},$i.removeChildAt=function($R){return this.getChildAt($R).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,$R);},$i.refresh=function(){this._setItemChanged();},$i.changeItems=function(){this._itemChanged=!1;},$i.sortItem=function($R){$R&&$R.sort(function($R,$F){return $R.y-$F.y;});},$i._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems));},$$(0,$i,"space",function(){return this._space;},function($R){this._space=$R,this._setItemChanged();}),$$(0,$i,"align",function(){return this._align;},function($R){this._align=$R,this._setItemChanged();}),$F;}(),$n=function($F){function $i($R,$F){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,$i.__super.call(this),$R&&(this.skin=$R),$F&&(this.sheet=$F);}$p($i,"laya.ui.FontClip",$F);var $R=$i.prototype;return $R.createChildren=function(){this._bitmap=new $Y(),this.on("loaded",this,this._onClipLoaded);},$R._onClipLoaded=function(){this.callLater(this.changeValue);},$R.changeValue=function(){var $R;if(this._sources&&this._valueArr&&(this.graphics.clear(!0),$R=this._sources[0])){var $F="horizontal"===this._direction;$F?(this._wordsW=this._valueArr.length*($R.sourceWidth+this.spaceX),this._wordsH=$R.sourceHeight):(this._wordsW=$R.sourceWidth,this._wordsH=($R.sourceHeight+this.spaceY)*this._valueArr.length);var $i=0;if(this._width)switch(this._align){case"center":$i=.5*(this._width-this._wordsW);break;case"right":$i=this._width-this._wordsW;break;default:$i=0;}for(var $j=0,$t=this._valueArr.length;$j<$t;$j++){var $p=this._indexMap[this._valueArr.charAt($j)];this.sources[$p]&&($R=this.sources[$p],$F?this.graphics.drawTexture($R,$i+$j*($R.sourceWidth+this.spaceX),0,$R.sourceWidth,$R.sourceHeight):this.graphics.drawTexture($R,0+$i,$j*($R.sourceHeight+this.spaceY),$R.sourceWidth,$R.sourceHeight));}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize));}},$R.destroy=function($R){void 0===$R&&($R=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),$F.prototype.destroy.call(this,$R);},$$(0,$R,"sheet",function(){return this._sheet;},function($R){$R+="";var $F=(this._sheet=$R).split(" ");this._clipX=String($F[0]).length,this.clipY=$F.length,this._indexMap={};for(var $i=0;$i<this._clipY;$i++)for(var $j=$F[$i].split(""),$t=0,$p=$j.length;$t<$p;$t++)this._indexMap[$j[$t]]=$i*this._clipX+$t;}),$$(0,$R,"height",$F.prototype._$get_height,function($R){$x.superSet($K,this,"height",$R),this.callLater(this.changeValue);}),$$(0,$R,"direction",function(){return this._direction;},function($R){this._direction=$R,this.callLater(this.changeValue);}),$$(0,$R,"value",function(){return this._valueArr?this._valueArr:"";},function($R){$R+="",this._valueArr=$R,this.callLater(this.changeValue);}),$$(0,$R,"width",$F.prototype._$get_width,function($R){$x.superSet($K,this,"width",$R),this.callLater(this.changeValue);}),$$(0,$R,"spaceX",function(){return this._spaceX;},function($R){this._spaceX=$R,"horizontal"===this._direction&&this.callLater(this.changeValue);}),$$(0,$R,"spaceY",function(){return this._spaceY;},function($R){this._spaceY=$R,"horizontal"!==this._direction&&this.callLater(this.changeValue);}),$$(0,$R,"align",function(){return this._align;},function($R){this._align=$R,this.callLater(this.changeValue);}),$$(0,$R,"measureWidth",function(){return this._wordsW;}),$$(0,$R,"measureHeight",function(){return this._wordsH;}),$i;}($K),$C=function($R){function $F(){this.selectHandler=null,this.renderHandler=null,this.renderTwHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this._twSwitch=!0,this._twDone=!0,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new $S(),$F.__super.call(this);}$p($F,"laya.ui.List",$R);var $i=$F.prototype;return $x.imps($i,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),$i.destroy=function($R){void 0===$R&&($R=!0),this._content&&this._content.destroy($R),this._scrollBar&&this._scrollBar.destroy($R),laya.ui.Component.prototype.destroy.call(this,$R),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this._twSwitch=null,this._twDone=null,this.selectHandler=this.renderHandler=this.mouseHandler=this.renderTwHandler=null;},$i.createChildren=function(){this.addChild(this._content=new $u());},$i.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$x.superGet($u,this,"cacheAs")),$x.superSet($u,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd);},$i.onScrollEnd=function(){$x.superSet($u,this,"cacheAs",this._$P.cacheAs);},$i._removePreScrollBar=function(){var $R=this.removeChildByName("scrollBar");$R&&$R.destroy(!0);},$i.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var $R=this._getOneCell(),$F=$R.width+this._spaceX||1,$i=$R.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/$F):Math.ceil(this._width/$F)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/$i):Math.round(this._height/$i));var $j=this._width?this._width:$F*this.repeatX-this._spaceX,$t=this._height?this._height:$i*this.repeatY-this._spaceY;this._cellSize=this._isVertical?$i:$F,this._cellOffset=this._isVertical?$i*Math.max(this._repeatY2,this._repeatY)-$t-this._spaceY:$F*Math.max(this._repeatX2,this._repeatX)-$j-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=$t:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=$j),this.setContentSize($j,$t);var $p=this._isVertical?this.repeatX:this.repeatY,$$=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,$p,$$),this._createdLine=$$,this._array&&(this.array=this._array,this.runCallLater(this.renderItems));}},$i._getOneCell=function(){if(0===this._cells.length){var $R=this.createItem();if(this._offset.setTo($R.x,$R.y),this.cacheContent)return $R;this._cells.push($R);}return this._cells[0];},$i._createItems=function($R,$F,$i){var $j=this._content,$t=this._getOneCell(),$p=$t.width+this._spaceX,$$=$t.height+this._spaceY;if(this.cacheContent){var $V=new $u();$V.cacheAsBitmap=!0,$V.pos((this._isVertical?0:$R)*$p,(this._isVertical?$R:0)*$$),this._content.addChild($V),this._content.optimizeScrollRect=!0,$j=$V;}else{for(var $N=[],$c=this._cells.length-1;-1<$c;$c--){var $q=this._cells[$c];$q.removeSelf(),$N.push($q);}this._cells.length=0;}for(var $s=$R;$s<$i;$s++)for(var $k=0;$k<$F;$k++)($t=$N&&$N.length?$N.pop():this.createItem()).x=(this._isVertical?$k:$s)*$p-$j.x,$t.y=(this._isVertical?$s:$k)*$$-$j.y,$t.name="item"+($s*$F+$k),$j.addChild($t),this.addCell($t);},$i.createItem=function(){var $R=[];if("function"==typeof this._itemRender)var $F=new this._itemRender();else $F=$l.createComp(this._itemRender,null,null,$R);if(0==$R.length&&$F._watchMap){var $i=$F._watchMap;for(var $j in $i)for(var $t=$i[$j],$p=0;$p<$t.length;$p++){var $$=$t[$p];$R.push($$.comp,$$.prop,$$.value);}}return $R.length&&($F._$bindData=$R),$F;},$i.addCell=function($R){$R.on("click",this,this.onCellMouse),$R.on("rightclick",this,this.onCellMouse),$R.on("mouseover",this,this.onCellMouse),$R.on("mouseout",this,this.onCellMouse),$R.on("mousedown",this,this.onCellMouse),$R.on("mouseup",this,this.onCellMouse),this._cells.push($R);},$i.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var $R=0,$F=$R=0;$F<1e4;$F++){var $i=this.getChildByName("item"+$F);if(!$i)break;this.addCell($i),$R++;}this.repeatY=$R;}},$i.setContentSize=function($R,$F){this._content.width=$R,this._content.height=$F,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new $m()),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,$R,$F),this._content.scrollRect=this._content.scrollRect),this.event("resize");},$i.onCellMouse=function($R){"mousedown"===$R.type&&(this._isMoved=!1);var $F=$R.currentTarget,$i=this._startIndex+this._cells.indexOf($F);$i<0||("click"===$R.type||"rightclick"===$R.type?this.selectEnable&&!this._isMoved?this.selectedIndex=$i:this.changeCellState($F,!0,0):"mouseover"!==$R.type&&"mouseout"!==$R.type||this._selectedIndex===$i||this.changeCellState($F,"mouseover"===$R.type,0),this.mouseHandler&&this.mouseHandler.runWith([$R,$i]));},$i.changeCellState=function($R,$F,$i){var $j=$R.getChildByName("selectBox");$j&&(this.selectEnable=!0,$j.visible=$F,$j.index=$i);},$i.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange);},$i.onScrollBarChange=function($R){this.runCallLater(this.changeCells);var $F=this._scrollBar.value,$i=this._isVertical?this.repeatX:this.repeatY,$j=this._isVertical?this.repeatY:this.repeatX,$t=Math.floor($F/this._cellSize);if(this.cacheContent)$$=$j+1,this._createdLine-$t<$$&&(this._createItems(this._createdLine,$i,this._createdLine+$$),this.renderItems(this._createdLine*$i,0),this._createdLine+=$$);else{var $p=$t*$i,$$=0;if($p>this._startIndex){$$=$p-this._startIndex;var $V=!0,$N=this._startIndex+$i*($j+1);this._isMoved=!0;}else $p<this._startIndex&&($$=this._startIndex-$p,$V=!1,$N=this._startIndex-1,this._isMoved=!0);for(var $c=0;$c<$$;$c++){if($V){var $q=this._cells.shift();this._cells[this._cells.length]=$q;var $s=$N+$c;}else $q=this._cells.pop(),this._cells.unshift($q),$s=$N-$c;var $k=Math.floor($s/$i)*this._cellSize;this._isVertical?$q.y=$k:$q.x=$k,this.renderItem($q,$s);}this._startIndex=$p,this.changeSelectStatus();}var $h=this._content.scrollRect;this._isVertical?($h.y=$F-this._offset.y,$h.x=-this._offset.x):($h.y=-this._offset.y,$h.x=$F-this._offset.x),this._content.scrollRect=$h;},$i.posCell=function($R,$F){if(this._scrollBar){var $i=this._isVertical?this.repeatX:this.repeatY,$j=(this._isVertical?this.repeatY:this.repeatX,Math.floor($F/$i)*this._cellSize);this._isVertical?$R.y=$j:$R.x=$j;}},$i.changeSelectStatus=function(){for(var $R=0,$F=this._cells.length;$R<$F;$R++)this.changeCellState(this._cells[$R],this._selectedIndex===this._startIndex+$R,1);},$i.renderItems=function($R,$F){void 0===$R&&($R=0),void 0===$F&&($F=0);for(var $i=$R,$j=$F||this._cells.length;$i<$j;$i++)this.renderItem(this._cells[$i],this._startIndex+$i);this.changeSelectStatus(),this._twDone=!0;},$i.renderItem=function($R,$F){this._array&&0<=$F&&$F<this._array.length?($R.visible=!0,$R._$bindData?($R._dataSource=this._array[$F],this._bindData($R,this._array[$F])):$R.dataSource=this._array[$F],this.cacheContent||this.posCell($R,$F),this.hasListener("render")&&this.event("render",[$R,$F]),this.renderHandler&&this.renderHandler.runWith([$R,$F]),this.renderTwHandler&&this.renderTwHandler.runWith([$R,$F])):($R.visible=!1,$R.dataSource=null);},$i._bindData=function($R,$F){for(var $i=$R._$bindData,$j=0,$t=$i.length;$j<$t;$j++){var $p=$i[$j++],$$=$i[$j++],$V=$i[$j],$N=$z.getBindFun($V);$p[$$]=$N.call(this,$F);}},$i.refresh=function(){this.array=this._array;},$i.getItem=function($R){return-1<$R&&$R<this._array.length?this._array[$R]:null;},$i.changeItem=function($R,$F){-1<$R&&$R<this._array.length&&(this._array[$R]=$F,$R>=this._startIndex&&$R<this._startIndex+this._cells.length&&this.renderItem(this.getCell($R),$R));},$i.setItem=function($R,$F){this.changeItem($R,$F);},$i.addItem=function($R){this._array.push($R),this.array=this._array;},$i.addItemAt=function($R,$F){this._array.splice($F,0,$R),this.array=this._array;},$i.deleteItem=function($R){this._array.splice($R,1),this.array=this._array;},$i.getCell=function($R){return this.runCallLater(this.changeCells),-1<$R&&this._cells?this._cells[($R-this._startIndex)%this._cells.length]:null;},$i.scrollTo=function($R){if(this._scrollBar){var $F=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor($R/$F)*this._cellSize;}else this.startIndex=$R;},$i.tweenTo=function($R,$F,$i){if(void 0===$F&&($F=200),this._scrollBar){var $j=this._isVertical?this.repeatX:this.repeatY;$H.to(this._scrollBar,{value:Math.floor($R/$j)*this._cellSize},$F,null,$i,0,!0);}else this.startIndex=$R,$i&&$i.run();},$i._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells));},$i.commitMeasure=function(){this.runCallLater(this.changeCells);},$$(0,$i,"cacheAs",$R.prototype._$get_cacheAs,function($R){$x.superSet($u,this,"cacheAs",$R),this._scrollBar&&(this._$P.cacheAs=null,"none"!==$R?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart));}),$$(0,$i,"content",function(){return this._content;}),$$(0,$i,"height",$R.prototype._$get_height,function($R){$R!=this._height&&($x.superSet($u,this,"height",$R),this._setCellChanged());}),$$(0,$i,"itemRender",function(){return this._itemRender;},function($R){if(this._itemRender!=$R){this._itemRender=$R;for(var $F=this._cells.length-1;-1<$F;$F--)this._cells[$F].destroy();this._cells.length=0,this._setCellChanged();}}),$$(0,$i,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null;},function($R){this._removePreScrollBar();var $F=new $FR();$F.name="scrollBar",$F.right=0,$R&&" "!=$R&&($F.skin=$R),this.scrollBar=$F,this.addChild($F),this._setCellChanged();}),$$(0,$i,"page",function(){return this._page;},function($R){this._page=$R,this._array&&(this._page=0<$R?$R:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY);}),$$(0,$i,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null;},function($R){this._removePreScrollBar();var $F=new $r();$F.name="scrollBar",$F.bottom=0,$R&&" "!=$R&&($F.skin=$R),this.scrollBar=$F,this.addChild($F),this._setCellChanged();}),$$(0,$i,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1;},function($R){this._repeatX=$R,this._setCellChanged();}),$$(0,$i,"scrollBar",function(){return this._scrollBar;},function($R){this._scrollBar!=$R&&(this._scrollBar=$R)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange));}),$$(0,$i,"width",$R.prototype._$get_width,function($R){$R!=this._width&&($x.superSet($u,this,"width",$R),this._setCellChanged());}),$$(0,$i,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1;},function($R){this._repeatY=$R,this._setCellChanged();}),$$(0,$i,"spaceX",function(){return this._spaceX;},function($R){this._spaceX=$R,this._setCellChanged();}),$$(0,$i,"spaceY",function(){return this._spaceY;},function($R){this._spaceY=$R,this._setCellChanged();}),$$(0,$i,"selectedIndex",function(){return this._selectedIndex;},function($R){this._selectedIndex!=$R&&(this._selectedIndex=$R,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith($R),this.startIndex=this._startIndex);}),$$(0,$i,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null;},function($R){this.selectedIndex=this._array.indexOf($R);}),$$(0,$i,"length",function(){return this._array?this._array.length:0;}),$$(0,$i,"selection",function(){return this.getCell(this._selectedIndex);},function($R){this.selectedIndex=this._startIndex+this._cells.indexOf($R);}),$$(0,$i,"startIndex",function(){return this._startIndex;},function($R){this._startIndex=0<$R?$R:0,this.callLater(this.renderItems);}),$$(0,$i,"twSwitch",function(){return this._twSwitch;},function($R){this._twSwitch=$R;}),$$(0,$i,"twDone",function(){return this._twDone;},function($R){this._twDone=$R;}),$$(0,$i,"array",function(){return this._array;},function($R){this.runCallLater(this.changeCells),this._array=$R||[];var $F=this._array.length;if(this.totalPage=Math.ceil($F/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<$F?this._selectedIndex:$F-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var $i=this._isVertical?this.repeatX:this.repeatY,$j=this._isVertical?this.repeatY:this.repeatX,$t=Math.ceil($F/$i);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=$j/$t,this._scrollBar.setScroll(0,($t-$j)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content;}}),$$(0,$i,"dataSource",$R.prototype._$get_dataSource,function($R){"number"==typeof(this._dataSource=$R)&&Math.floor($R)==$R||"string"==typeof $R?this.selectedIndex=parseInt($R):$R instanceof Array?this.array=$R:$x.superSet($u,this,"dataSource",$R);}),$$(0,$i,"cells",function(){return this.runCallLater(this.changeCells),this._cells;}),$F;}($u),$r=function($R){function $F(){$F.__super.call(this);}return $p($F,"laya.ui.HScrollBar",$R),$F.prototype.initialize=function(){$R.prototype.initialize.call(this),this.slider.isVertical=!1;},$F;}($b),$A=function($R){function $F(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,$F.__super.call(this),this.width=this.height=100;}$p($F,"laya.ui.Panel",$R);var $i=$F.prototype;return $i.destroy=function($R){void 0===$R&&($R=!0),laya.ui.Component.prototype.destroy.call(this,$R),this._content&&this._content.destroy($R),this._vScrollBar&&this._vScrollBar.destroy($R),this._hScrollBar&&this._hScrollBar.destroy($R),this._vScrollBar=null,this._hScrollBar=null,this._content=null;},$i.destroyChildren=function(){this._content.destroyChildren();},$i.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new $u());},$i.addChild=function($R){return $R.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild($R);},$i.onResize=function(){this._setScrollChanged();},$i.addChildAt=function($R,$F){return $R.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt($R,$F);},$i.removeChild=function($R){return $R.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild($R);},$i.removeChildAt=function($R){return this.getChildAt($R).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt($R);},$i.removeChildren=function($R,$F){return void 0===$R&&($R=0),void 0===$F&&($F=2147483647),this._content.removeChildren($R,$F),this._setScrollChanged(),this;},$i.getChildAt=function($R){return this._content.getChildAt($R);},$i.getChildByName=function($R){return this._content.getChildByName($R);},$i.getChildIndex=function($R){return this._content.getChildIndex($R);},$i.changeScroll=function(){this._scrollChanged=!1;var $R=this.contentWidth||1,$F=this.contentHeight||1,$i=this._vScrollBar,$j=this._hScrollBar,$t=$i&&$F>this._height,$p=$j&&$R>this._width,$$=$t?this._width-$i.width:this._width,$V=$p?this._height-$j.height:this._height;$i&&($i.x=this._width-$i.width,$i.y=0,$i.height=this._height-($p?$j.height:0),$i.scrollSize=Math.max(.033*this._height,1),$i.thumbPercent=$V/$F,$i.setScroll(0,$F-$V,$i.value)),$j&&($j.x=0,$j.y=this._height-$j.height,$j.width=this._width-($t?$i.width:0),$j.scrollSize=Math.max(.033*this._width,1),$j.thumbPercent=$$/$R,$j.setScroll(0,$R-$$,$j.value));},$i.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height);},$i.setContentSize=function($R,$F){var $i=this._content;$i.width=$R,$i.height=$F,$i.scrollRect||($i.scrollRect=new $m()),$i.scrollRect.setTo(0,0,$R,$F),$i.scrollRect=$i.scrollRect;},$i.onScrollBarChange=function($R){var $F=this._content.scrollRect;if($F){var $i=Math.round($R.value);$R.isVertical?$F.y=$i:$F.x=$i,this._content.scrollRect=$F;}},$i.scrollTo=function($R,$F){void 0===$R&&($R=0),void 0===$F&&($F=0),this.vScrollBar&&(this.vScrollBar.value=$F),this.hScrollBar&&(this.hScrollBar.value=$R);},$i.refresh=function(){this.changeScroll();},$i.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$x.superGet($u,this,"cacheAs")),$x.superSet($u,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd);},$i.onScrollEnd=function(){$x.superSet($u,this,"cacheAs",this._$P.cacheAs);},$i._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll));},$$(0,$i,"numChildren",function(){return this._content.numChildren;}),$$(0,$i,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null;},function($R){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new $r()),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=$R;}),$$(0,$i,"contentWidth",function(){for(var $R=0,$F=this._content.numChildren-1;-1<$F;$F--){var $i=this._content.getChildAt($F);$R=Math.max($i.x+$i.width*$i.scaleX,$R);}return $R;}),$$(0,$i,"contentHeight",function(){for(var $R=0,$F=this._content.numChildren-1;-1<$F;$F--){var $i=this._content.getChildAt($F);$R=Math.max($i.y+$i.height*$i.scaleY,$R);}return $R;}),$$(0,$i,"width",$R.prototype._$get_width,function($R){$x.superSet($u,this,"width",$R),this._setScrollChanged();}),$$(0,$i,"hScrollBar",function(){return this._hScrollBar;}),$$(0,$i,"content",function(){return this._content;}),$$(0,$i,"height",$R.prototype._$get_height,function($R){$x.superSet($u,this,"height",$R),this._setScrollChanged();}),$$(0,$i,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null;},function($R){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new $FR()),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=$R;}),$$(0,$i,"vScrollBar",function(){return this._vScrollBar;}),$$(0,$i,"cacheAs",$R.prototype._$get_cacheAs,function($R){$x.superSet($u,this,"cacheAs",$R),this._$P.cacheAs=null,"none"!==$R?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart));}),$F;}($u),$P=function($R){function $F($R){$F.__super.call(this,$R),this.isVertical=!1;}return $p($F,"laya.ui.HSlider",$G),$F;}(),$U=function($R){function $i($R,$F){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,$i.__super.call(this),this.skin=$F,this.labels=$R;}$p($i,"laya.ui.UIGroup",$R);var $F=$i.prototype;return $x.imps($F,{"laya.ui.IItem":!0}),$F.preinitialize=function(){this.mouseEnabled=!0;},$F.destroy=function($R){void 0===$R&&($R=!0),laya.ui.Component.prototype.destroy.call(this,$R),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null;},$F.addItem=function($R,$F){void 0===$F&&($F=!0);var $i=$R,$j=this._items.length;if($i.name="item"+$j,this.addChild($i),this.initItems(),$F&&0<$j){var $t=this._items[$j-1];"horizontal"==this._direction?$i.x=$t.x+$t.width+this._space:$i.y=$t.y+$t.height+this._space;}else $F&&($i.x=0,$i.y=0);return $j;},$F.delItem=function($R,$F){void 0===$F&&($F=!0);var $i=this._items.indexOf($R);if(-1!=$i){var $j=$R;this.removeChild($j);for(var $t=$i+1,$p=this._items.length;$t<$p;$t++){var $$=this._items[$t];$$.name="item"+($t-1),$F&&("horizontal"==this._direction?$$.x-=$j.width+this._space:$$.y-=$j.height+this._space);}if(this.initItems(),-1<this._selectedIndex){var $V;$V=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=$V;}}},$F.initItems=function(){this._items||(this._items=[]);for(var $R=this._items.length=0;$R<1e4;$R++){var $F=this.getChildByName("item"+$R);if(null==$F)break;this._items.push($F),$F.selected=$R===this._selectedIndex,$F.clickHandler=$k.create(this,this.itemClick,[$R],!1);}},$F.itemClick=function($R){this.selectedIndex=$R;},$F.setSelect=function($R,$F){this._items&&-1<$R&&$R<this._items.length&&(this._items[$R].selected=$F);},$F.createItem=function($R,$F){return null;},$F.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var $R=0,$F=0,$i=this._items.length;$F<$i;$F++){var $j=this._items[$F];this._skin&&($j.skin=this._skin),this._labelColors&&($j.labelColors=this._labelColors),this._labelSize&&($j.labelSize=this._labelSize),this._labelStroke&&($j.labelStroke=this._labelStroke),this._labelStrokeColor&&($j.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&($j.strokeColors=this._strokeColors),this._labelBold&&($j.labelBold=this._labelBold),this._labelPadding&&($j.labelPadding=this._labelPadding),this._labelAlign&&($j.labelAlign=this._labelAlign),this._stateNum&&($j.stateNum=this._stateNum),this._labelFont&&($j.labelFont=this._labelFont),"horizontal"===this._direction?($j.y=0,$j.x=$R,$R+=$j.width+this._space):($j.x=0,$j.y=$R,$R+=$j.height+this._space);}this.changeSize();},$F.commitMeasure=function(){this.runCallLater(this.changeLabels);},$F._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels));},$$(0,$F,"labelStrokeColor",function(){return this._labelStrokeColor;},function($R){this._labelStrokeColor!=$R&&(this._labelStrokeColor=$R,this._setLabelChanged());}),$$(0,$F,"skin",function(){return this._skin;},function($R){this._skin!=$R&&(this._skin=$R,this._setLabelChanged());}),$$(0,$F,"selectedIndex",function(){return this._selectedIndex;},function($R){this._selectedIndex!=$R&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$R,this.setSelect($R,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex));}),$$(0,$F,"labels",function(){return this._labels;},function($R){if(this._labels!=$R){if(this._labels=$R,this.removeChildren(),this._setLabelChanged(),this._labels)for(var $F=this._labels.split(","),$i=0,$j=$F.length;$i<$j;$i++){var $t=this.createItem(this._skin,$F[$i]);$t.name="item"+$i,this.addChild($t);}this.initItems();}}),$$(0,$F,"strokeColors",function(){return this._strokeColors;},function($R){this._strokeColors!=$R&&(this._strokeColors=$R,this._setLabelChanged());}),$$(0,$F,"labelColors",function(){return this._labelColors;},function($R){this._labelColors!=$R&&(this._labelColors=$R,this._setLabelChanged());}),$$(0,$F,"labelStroke",function(){return this._labelStroke;},function($R){this._labelStroke!=$R&&(this._labelStroke=$R,this._setLabelChanged());}),$$(0,$F,"labelSize",function(){return this._labelSize;},function($R){this._labelSize!=$R&&(this._labelSize=$R,this._setLabelChanged());}),$$(0,$F,"stateNum",function(){return this._stateNum;},function($R){this._stateNum!=$R&&(this._stateNum=$R,this._setLabelChanged());}),$$(0,$F,"labelBold",function(){return this._labelBold;},function($R){this._labelBold!=$R&&(this._labelBold=$R,this._setLabelChanged());}),$$(0,$F,"labelFont",function(){return this._labelFont;},function($R){this._labelFont!=$R&&(this._labelFont=$R,this._setLabelChanged());}),$$(0,$F,"labelPadding",function(){return this._labelPadding;},function($R){this._labelPadding!=$R&&(this._labelPadding=$R,this._setLabelChanged());}),$$(0,$F,"direction",function(){return this._direction;},function($R){this._direction=$R,this._setLabelChanged();}),$$(0,$F,"space",function(){return this._space;},function($R){this._space=$R,this._setLabelChanged();}),$$(0,$F,"items",function(){return this._items;}),$$(0,$F,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null;},function($R){this.selectedIndex=this._items.indexOf($R);}),$$(0,$F,"dataSource",$R.prototype._$get_dataSource,function($R){"number"==typeof(this._dataSource=$R)&&Math.floor($R)==$R||"string"==typeof $R?this.selectedIndex=parseInt($R):$R instanceof Array?this.labels=$R.join(","):$x.superSet($u,this,"dataSource",$R);}),$i;}($u),$I=function($F){function $i($R,$F){this._value=null,void 0===$F&&($F=""),$i.__super.call(this,$R,$F);}$p($i,"laya.ui.Radio",$F);var $R=$i.prototype;return $R.destroy=function($R){void 0===$R&&($R=!0),$F.prototype.destroy.call(this,$R),this._value=null;},$R.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1;},$R.initialize=function(){$F.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick);},$R.onClick=function($R){this.selected=!0;},$$(0,$R,"value",function(){return null!=this._value?this._value:this.label;},function($R){this._value=$R;}),$i;}($v),$D=function($R){function $F(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,$F.__super.call(this),this.width=this.height=200;}$p($F,"laya.ui.Tree",$R);var $i=$F.prototype;return $x.imps($i,{"laya.ui.IRender":!0}),$i.destroy=function($R){void 0===$R&&($R=!0),laya.ui.Component.prototype.destroy.call(this,$R),this._list&&this._list.destroy($R),this._list=null,this._source=null,this._renderHandler=null;},$i.createChildren=function(){this.addChild(this._list=new $C()),this._list.renderHandler=$k.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange);},$i.onListChange=function($R){this.event("change");},$i.getArray=function(){var $R,$F=[];for(var $i in this._source)$R=this._source[$i],this.getParentOpenStatus($R)&&($R.x=this._spaceLeft*this.getDepth($R),$F.push($R));return $F;},$i.getDepth=function($R,$F){return void 0===$F&&($F=0),null==$R.nodeParent?$F:this.getDepth($R.nodeParent,$F+1);},$i.getParentOpenStatus=function($R){var $F=$R.nodeParent;return null==$F||!!$F.isOpen&&(null==$F.nodeParent||this.getParentOpenStatus($F));},$i.renderItem=function($R,$F){var $i=$R.dataSource;if($i){$R.left=$i.x;var $j=$R.getChildByName("arrow");$j&&($i.hasChild?($j.visible=!0,$j.index=$i.isOpen?1:0,$j.tag=$F,$j.off("click",this,this.onArrowClick),$j.on("click",this,this.onArrowClick)):$j.visible=!1);var $t=$R.getChildByName("folder");$t&&(2==$t.clipY?$t.index=$i.isDirectory?0:1:$t.index=$i.isDirectory?$i.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([$R,$F]);}},$i.onArrowClick=function($R){var $F=$R.currentTarget.tag;this._list.array[$F].isOpen=!this._list.array[$F].isOpen,this.event("open"),this._list.array=this.getArray();},$i.setItemState=function($R,$F){this._list.array[$R]&&(this._list.array[$R].isOpen=$F,this._list.array=this.getArray());},$i.fresh=function(){this._list.array=this.getArray(),this.repaint();},$i.parseXml=function($R,$F,$i,$j){var $t,$p=$R.childNodes,$$=$p.length;if(!$j){$t={};var $V,$N=$R.attributes;for(var $c in $N){var $q=($V=$N[$c]).nodeName,$s=$V.nodeValue;$t[$q]="true"==$s||"false"!=$s&&$s;}$t.nodeParent=$i,0<$$&&($t.isDirectory=!0),$t.hasChild=0<$$,$F.push($t);}for(var $k=0;$k<$$;$k++){var $h=$p[$k];this.parseXml($h,$F,$t,!1);}},$i.parseOpenStatus=function($R,$F){for(var $i=0,$j=$F.length;$i<$j;$i++){var $t=$F[$i];if($t.isDirectory)for(var $p=0,$$=$R.length;$p<$$;$p++){var $V=$R[$p];if($V.isDirectory&&this.isSameParent($V,$t)&&$t.label==$V.label){$t.isOpen=$V.isOpen;break;}}}},$i.isSameParent=function($R,$F){return null==$R.nodeParent&&null==$F.nodeParent||null!=$R.nodeParent&&null!=$F.nodeParent&&$R.nodeParent.label==$F.nodeParent.label&&this.isSameParent($R.nodeParent,$F.nodeParent);},$i.filter=function($R){if(Boolean($R)){var $F=[];this.getFilterSource(this._source,$F,$R),this._list.array=$F;}else this._list.array=this.getArray();},$i.getFilterSource=function($R,$F,$i){var $j;for(var $t in $i=$i.toLocaleLowerCase(),$R)!($j=$R[$t]).isDirectory&&-1<String($j.label).toLowerCase().indexOf($i)&&($j.x=0,$F.push($j)),$j.child&&0<$j.child.length&&this.getFilterSource($j.child,$F,$i);},$$(0,$i,"spaceBottom",function(){return this._list.spaceY;},function($R){this._list.spaceY=$R;}),$$(0,$i,"keepStatus",function(){return this._keepStatus;},function($R){this._keepStatus=$R;}),$$(0,$i,"itemRender",function(){return this._list.itemRender;},function($R){this._list.itemRender=$R;}),$$(0,$i,"array",function(){return this._list.array;},function($R){this._keepStatus&&this._list.array&&$R&&this.parseOpenStatus(this._list.array,$R),this._source=$R,this._list.array=this.getArray();}),$$(0,$i,"mouseHandler",function(){return this._list.mouseHandler;},function($R){this._list.mouseHandler=$R;}),$$(0,$i,"dataSource",$R.prototype._$get_dataSource,function($R){this._dataSource=$R,$x.superSet($u,this,"dataSource",$R);}),$$(0,$i,"source",function(){return this._source;}),$$(0,$i,"scrollBar",function(){return this._list.scrollBar;}),$$(0,$i,"list",function(){return this._list;}),$$(0,$i,"scrollBarSkin",function(){return this._list.vScrollBarSkin;},function($R){this._list.vScrollBarSkin=$R;}),$$(0,$i,"renderHandler",function(){return this._renderHandler;},function($R){this._renderHandler=$R;}),$$(0,$i,"selectedIndex",function(){return this._list.selectedIndex;},function($R){this._list.selectedIndex=$R;}),$$(0,$i,"spaceLeft",function(){return this._spaceLeft;},function($R){this._spaceLeft=$R;}),$$(0,$i,"selectedItem",function(){return this._list.selectedItem;},function($R){this._list.selectedItem=$R;}),$$(0,$i,"width",$R.prototype._$get_width,function($R){$x.superSet($u,this,"width",$R),this._list.width=$R;}),$$(0,$i,"height",$R.prototype._$get_height,function($R){$x.superSet($u,this,"height",$R),this._list.height=$R;}),$$(0,$i,"xml",null,function($R){var $F=[];this.parseXml($R.childNodes[0],$F,null,!0),this.array=$F;}),$$(0,$i,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null;}),$F;}($u),$RR=function($R){function $F(){this._items=null,this._selectedIndex=0,$F.__super.call(this),this._setIndexHandler=$k.create(this,this.setIndex,null,!1);}$p($F,"laya.ui.ViewStack",$R);var $i=$F.prototype;return $x.imps($i,{"laya.ui.IItem":!0}),$i.setItems=function($R){this.removeChildren();for(var $F=0,$i=0,$j=$R.length;$i<$j;$i++){var $t=$R[$i];$t&&($t.name="item"+$F,this.addChild($t),$F++);}this.initItems();},$i.addItem=function($R){$R.name="item"+this._items.length,this.addChild($R),this.initItems();},$i.initItems=function(){this._items=[];for(var $R=0;$R<1e4;$R++){var $F=this.getChildByName("item"+$R);if(null==$F)break;this._items.push($F),$F.visible=$R==this._selectedIndex;}},$i.setSelect=function($R,$F){this._items&&-1<$R&&$R<this._items.length&&(this._items[$R].visible=$F);},$i.setIndex=function($R){this.selectedIndex=$R;},$$(0,$i,"dataSource",$R.prototype._$get_dataSource,function($R){if("number"==typeof(this._dataSource=$R)&&Math.floor($R)==$R||"string"==typeof $R)this.selectedIndex=parseInt($R);else for(var $F in this._dataSource)this.hasOwnProperty($F)&&(this[$F]=this._dataSource[$F]);}),$$(0,$i,"selectedIndex",function(){return this._selectedIndex;},function($R){this._selectedIndex!=$R&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$R,this.setSelect(this._selectedIndex,!0));}),$$(0,$i,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null;},function($R){this.selectedIndex=this._items.indexOf($R);}),$$(0,$i,"items",function(){return this._items;}),$$(0,$i,"setIndexHandler",function(){return this._setIndexHandler;},function($R){this._setIndexHandler=$R;}),$F;}($u),$FR=function($R){function $F(){$F.__super.call(this);}return $p($F,"laya.ui.VScrollBar",$b),$F;}(),$iR=function($F){function $i($R){this._bg=null,this._skin=null,$i.__super.call(this),void 0===$R&&($R=""),this.text=$R,this.skin=this.skin;}$p($i,"laya.ui.TextInput",$F);var $R=$i.prototype;return $R.preinitialize=function(){this.mouseEnabled=!0;},$R.destroy=function($R){$M.clearCache(this,this._skin),void 0===$R&&($R=!0),$F.prototype.destroy.call(this,$R),this._bg&&this._bg.destroy(),this._bg=null;},$R.createChildren=function(){this.addChild(this._tf=new $h()),this._tf.padding=$B.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus);},$R._onFocus=function(){this.event("focus",this);},$R._onBlur=function(){this.event("blur",this);},$R._onInput=function(){this.event("input",this);},$R._onEnter=function(){this.event("enter",this);},$R.initialize=function(){this.width=128,this.height=22;},$R.select=function(){this._tf.select();},$R.setSelection=function($R,$F){this._tf.setSelection($R,$F);},$$(0,$R,"text",$F.prototype._$get_text,function($R){this._tf.text!=$R&&($R+="",this._tf.text=$R,this.event("change"));}),$$(0,$R,"bg",function(){return this._bg;},function($R){this.graphics=this._bg=$R;}),$$(0,$R,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster;},function($R){this._tf.inputElementYAdjuster=$R;}),$$(0,$R,"multiline",function(){return this._tf.multiline;},function($R){this._tf.multiline=$R;}),$$(0,$R,"skin",function(){return this._skin;},function($R){this._skin!=$R&&($M.clearCache(this,this._skin),this._skin=$R,this._bg||(this.graphics=this._bg=new $Y()),$M.keepCache(this,this._skin),this._bg.source=$M.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height));}),$$(0,$R,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null;},function($R){this._bg||(this.graphics=this._bg=new $Y()),this._bg.sizeGrid=$z.fillArray($B.defaultSizeGrid,$R,Number);}),$$(0,$R,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster;},function($R){this._tf.inputElementXAdjuster=$R;}),$$(0,$R,"width",$F.prototype._$get_width,function($R){$x.superSet($y,this,"width",$R),this._bg&&(this._bg.width=$R);}),$$(0,$R,"height",$F.prototype._$get_height,function($R){$x.superSet($y,this,"height",$R),this._bg&&(this._bg.height=$R);}),$$(0,$R,"editable",function(){return this._tf.editable;},function($R){this._tf.editable=$R;}),$$(0,$R,"restrict",function(){return this._tf.restrict;},function($R){this._tf.restrict=$R;}),$$(0,$R,"prompt",function(){return this._tf.prompt;},function($R){this._tf.prompt=$R;}),$$(0,$R,"promptColor",function(){return this._tf.promptColor;},function($R){this._tf.promptColor=$R;}),$$(0,$R,"maxChars",function(){return this._tf.maxChars;},function($R){this._tf.maxChars=$R;}),$$(0,$R,"focus",function(){return this._tf.focus;},function($R){this._tf.focus=$R;}),$$(0,$R,"type",function(){return this._tf.type;},function($R){this._tf.type=$R;}),$$(0,$R,"asPassword",function(){return this._tf.asPassword;},function($R){this._tf.asPassword=$R;}),$i;}($y),$jR=function($R){function $F(){$F.__super.call(this);}return $p($F,"laya.ui.VSlider",$G),$F;}(),$tR=function($R){function $j(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,$j.__super.call(this);}$p($j,"laya.ui.Dialog",$R);var $F=$j.prototype;return $F.initialize=function(){this.popupEffect=$j.manager.popupEffectHandler,this.closeEffect=$j.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick);},$F._dealDragArea=function(){var $R=this.getChildByName("drag");$R&&(this.dragArea=$R.x+","+$R.y+","+$R.width+","+$R.height,$R.removeSelf());},$F._onClick=function($R){var $F=$R.target;if($F)switch($F.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close($F.name);}},$F.show=function($R,$F){void 0===$R&&($R=!1),void 0===$F&&($F=!0),this._open(!1,$R,$F);},$F.popup=function($R,$F){void 0===$R&&($R=!1),void 0===$F&&($F=!0),this._open(!0,$R,$F);},$F._open=function($R,$F,$i){$j.manager.lock(!1),this.isModal=$R,$j.manager.open(this,$F,$i);},$F.onOpened=function(){},$F.close=function($R,$F){void 0===$F&&($F=!0),$j.manager.close(this,$R,$F);},$F.onClosed=function($R){},$F._onMouseDown=function($R){var $F=this.getMousePoint();this._dragArea.contains($F.x,$F.y)?this.startDrag():this.stopDrag();},$$(0,$F,"dragArea",function(){return this._dragArea?this._dragArea.toString():null;},function($R){if($R){var $F=$z.fillArray([0,0,0,0],$R,Number);this._dragArea=new $m($F[0],$F[1],$F[2],$F[3]),this.on("mousedown",this,this._onMouseDown);}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown);}),$$(0,$F,"isPopup",function(){return null!=this.parent;}),$$(0,$F,"zOrder",$R.prototype._$get_zOrder,function($R){$x.superSet($l,this,"zOrder",$R),$j.manager._checkMask();}),$$(1,$j,"manager",function(){return $j._manager=$j._manager||new $Z();},function($R){$j._manager=$R;}),$j.setLockView=function($R){$j.manager.setLockView($R);},$j.lock=function($R){$j.manager.lock($R);},$j.closeAll=function(){$j.manager.closeAll();},$j.getDialogsByGroup=function($R){return $j.manager.getDialogsByGroup($R);},$j.closeByGroup=function($R){return $j.manager.closeByGroup($R);},$j.CLOSE="close",$j.CANCEL="cancel",$j.SURE="sure",$j.NO="no",$j.OK="ok",$j.YES="yes",$j._manager=null,$j;}($l),$pR=function($R){function $F(){$F.__super.call(this);}$p($F,"laya.ui.HBox",$R);var $i=$F.prototype;return $i.sortItem=function($R){$R&&$R.sort(function($R,$F){return $R.x-$F.x;});},$i.changeItems=function(){this._itemChanged=!1;for(var $R=[],$F=0,$i=0,$j=this.numChildren;$i<$j;$i++){var $t=this.getChildAt($i);$t&&$t.layoutEnabled&&($R.push($t),$F=this._height?this._height:Math.max($F,$t.height*$t.scaleY));}this.sortItem($R);var $p=0;for($i=0,$j=$R.length;$i<$j;$i++)($t=$R[$i]).x=$p,$p+=$t.width*$t.scaleX+this._space,"top"==this._align?$t.y=0:"middle"==this._align?$t.y=.5*($F-$t.height*$t.scaleY):"bottom"==this._align&&($t.y=$F-$t.height*$t.scaleY);this.changeSize();},$$(0,$i,"height",$R.prototype._$get_height,function($R){this._height!=$R&&($x.superSet($o,this,"height",$R),this.callLater(this.changeItems));}),$F.NONE="none",$F.TOP="top",$F.MIDDLE="middle",$F.BOTTOM="bottom",$F;}($o),$$R=function($R){function $F(){$F.__super.call(this);}$p($F,"laya.ui.VBox",$R);var $i=$F.prototype;return $i.changeItems=function(){this._itemChanged=!1;for(var $R=[],$F=0,$i=0,$j=this.numChildren;$i<$j;$i++){var $t=this.getChildAt($i);$t&&$t.layoutEnabled&&($R.push($t),$F=this._width?this._width:Math.max($F,$t.width*$t.scaleX));}this.sortItem($R);var $p=0;for($i=0,$j=$R.length;$i<$j;$i++)($t=$R[$i]).y=$p,$p+=$t.height*$t.scaleY+this._space,"left"==this._align?$t.x=0:"center"==this._align?$t.x=.5*($F-$t.width*$t.scaleX):"right"==this._align&&($t.x=$F-$t.width*$t.scaleX);this.changeSize();},$$(0,$i,"width",$R.prototype._$get_width,function($R){this._width!=$R&&($x.superSet($o,this,"width",$R),this.callLater(this.changeItems));}),$F.NONE="none",$F.LEFT="left",$F.CENTER="center",$F.RIGHT="right",$F;}($o),$VR=function($R){function $F(){$F.__super.call(this);}return $p($F,"laya.ui.RadioGroup",$U),$F.prototype.createItem=function($R,$F){return new $I($R,$F);},$F;}(),$NR=function($R){function $F(){$F.__super.call(this);}return $p($F,"laya.ui.Tab",$U),$F.prototype.createItem=function($R,$F){return new $v($R,$F);},$F;}(),$cR=function($F){function $i($R){this._vScrollBar=null,this._hScrollBar=null,void 0===$R&&($R=""),$i.__super.call(this,$R);}$p($i,"laya.ui.TextArea",$F);var $R=$i.prototype;return $R.destroy=function($R){void 0===$R&&($R=!0),$F.prototype.destroy.call(this,$R),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null;},$R.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0;},$R.onVBarChanged=function($R){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value);},$R.onHBarChanged=function($R){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value);},$R.changeScroll=function(){var $R=this._vScrollBar&&0<this._tf.maxScrollY,$F=this._hScrollBar&&0<this._tf.maxScrollX,$i=$R?this._width-this._vScrollBar.width:this._width,$j=$F?this._height-this._hScrollBar.height:this._height,$t=this._tf.padding||$B.labelPadding;this._tf.width=$i,this._tf.height=$j,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-$t[2],this._vScrollBar.y=$t[1],this._vScrollBar.height=this._height-($F?this._hScrollBar.height:0)-$t[1]-$t[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=$j/Math.max(this._tf.textHeight,$j),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=$R),this._hScrollBar&&(this._hScrollBar.x=$t[0],this._hScrollBar.y=this._height-this._hScrollBar.height-$t[3],this._hScrollBar.width=this._width-($R?this._vScrollBar.width:0)-$t[0]-$t[2],this._hScrollBar.scrollSize=Math.max(.033*$i,1),this._hScrollBar.thumbPercent=$i/Math.max(this._tf.textWidth,$i),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=$F);},$R.scrollTo=function($R){this.commitMeasure(),this._tf.scrollY=$R;},$$(0,$R,"scrollY",function(){return this._tf.scrollY;}),$$(0,$R,"width",$F.prototype._$get_width,function($R){$x.superSet($iR,this,"width",$R),this.callLater(this.changeScroll);}),$$(0,$R,"hScrollBar",function(){return this._hScrollBar;}),$$(0,$R,"height",$F.prototype._$get_height,function($R){$x.superSet($iR,this,"height",$R),this.callLater(this.changeScroll);}),$$(0,$R,"maxScrollX",function(){return this._tf.maxScrollX;}),$$(0,$R,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null;},function($R){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new $FR()),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=$R;}),$$(0,$R,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null;},function($R){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new $r()),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=$R;}),$$(0,$R,"vScrollBar",function(){return this._vScrollBar;}),$$(0,$R,"maxScrollY",function(){return this._tf.maxScrollY;}),$$(0,$R,"scrollX",function(){return this._tf.scrollX;}),$i;}($iR);!function($R){function $F(){this._uiView=null,this.isCloseOther=!1,$F.__super.call(this);}$p($F,"laya.ui.AsynDialog",$tR);var $i=$F.prototype;$i.createView=function($R){this._uiView=$R;},$i._open=function($R,$F,$i){this.isModal=$R,this.isCloseOther=$F,$tR.manager.lock(!0),this._uiView?this.onCreated():this.onOpen();},$i.onCreated=function(){this.createUI(),this.onOpen();},$i.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea();},$i.onOpen=function(){$tR.manager.open(this,this.isCloseOther),$tR.manager.lock(!1);},$i.close=function($R,$F){void 0===$F&&($F=!0),$tR.manager.close(this),this.onClose();},$i.onClose=function(){},$i.destroy=function($R){void 0===$R&&($R=!0),laya.ui.View.prototype.destroy.call(this,$R),this._uiView=null,this.onDestroy();},$i.onDestroy=function(){};}();$x.__init([$l]);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($R,$F){"use strict";for(var $i in Object.defineProperty($F,"__esModule",{value:!0}),Laya){var $j=Laya[$i];$j&&$j.__isclass&&($F[$i]=$j);}}),function($k,$R,$w){$w.un,$w.uns;var $s=$w.static,$h=$w.class,$S=$w.getset,$j=$w.__newvec,$d=laya.maths.Arith,$$=laya.webgl.atlas.AtlasResourceManager,$i=laya.webgl.shader.BaseShader,$f=laya.utils.Browser,$V=laya.webgl.utils.Buffer,$X=laya.utils.Byte,$t=laya.utils.ClassUtils,$N=$w.Config,$p=(laya.events.Event,laya.events.EventDispatcher),$B=laya.utils.Handler,$m=laya.net.Loader,$F=laya.net.LoaderManager,$c=(laya.maths.MathUtil,laya.display.Node),$x=laya.renders.Render,$q=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),$a=laya.resource.Resource,$M=laya.utils.RunDriver,$J=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),$H=laya.display.Sprite,$_=laya.utils.Stat,$T=laya.utils.StringKey,$z=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),$g=laya.utils.Utils,$L=laya.webgl.WebGL,$Y=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;$w.interface("laya.d3.core.IClone"),$w.interface("laya.d3.graphics.IVertex"),$w.interface("laya.d3.core.render.IUpdate"),$w.interface("laya.d3.core.scene.ITreeNode"),$w.interface("laya.d3.core.render.IRenderable");(function(){function $v(){}$h($v,"laya.d3.animation.AnimationClipParser01"),$v.READ_DATA=function(){$v._DATA.offset=$v._reader.getUint32(),$v._DATA.size=$v._reader.getUint32();},$v.READ_BLOCK=function(){for(var $R=$v._BLOCK.count=$v._reader.getUint16(),$F=$v._BLOCK.blockStarts=[],$i=$v._BLOCK.blockLengths=[],$j=0;$j<$R;$j++)$F.push($v._reader.getUint32()),$i.push($v._reader.getUint32());},$v.READ_STRINGS=function(){var $R=$v._reader.getUint32(),$F=$v._reader.getUint16(),$i=$v._reader.pos;$v._reader.pos=$R+$v._DATA.offset;for(var $j=0;$j<$F;$j++)$v._strings[$j]=$v._reader.readUTFString();$v._reader.pos=$i;},$v.parse=function($R,$F){$v._animationClip=$R;($v._reader=$F).__getBuffer();$v.READ_DATA(),$v.READ_BLOCK(),$v.READ_STRINGS();for(var $i=0,$j=$v._BLOCK.count;$i<$j;$i++){var $t=$F.getUint16(),$p=$v._strings[$t],$$=$v["READ_"+$p];if(null==$$)throw new Error("model file err,no this function:"+$t+" "+$p);$$.call();}},$v.READ_ANIMATIONS=function(){var $R,$F=0,$i=0,$j=$v._reader,$t=$j.__getBuffer(),$p=[],$$=$j.getUint8();for($p.length=$$,$F=0;$F<$$;$F++)$p[$F]=$j.getUint16();var $V=[],$N=$j.getUint16();for($V.length=$N,$F=0;$F<$N;$F++)$V[$F]=$j.getFloat32();var $c=$v._animationClip;$c.name=$v._strings[$j.getUint16()];var $q=$c._duration=$j.getFloat32();$c.islooping=!!$j.getByte(),$c._frameRate=$j.getInt16();var $s=$j.getInt16(),$k=$c._nodes=new Array();$k.length=$s,($c._publicClipDatas=[]).length=$s;var $h=$c._nodesMap={},$S=0,$x=0;for($F=0;$F<$s;$F++){$R=$k[$F]=new $E();var $a=$j.getUint16(),$m=$R.path=[];for($m.length=$a,$i=0;$i<$a;$i++)$m[$i]=$v._strings[$j.getUint16()];var $M=$m.join("/"),$J=$h[$M];$J||($h[$M]=$J=[]),$J.push($R);var $d=$j.getInt16();-1!==$d&&($R.componentType=$v._strings[$d]);var $w=$O._propertyIndexDic[$v._strings[$j.getUint16()]];if(null==$w)throw new Error("AnimationClipParser01:unknown property name.");var $X=$w<4,$H=!$X||$X&&""===$m[0];($R._cacheProperty=$H)?$S++:$x++,$R.propertyNameID=$w;var $_=$p[$j.getUint8()];$R.keyFrameWidth=$_/4;var $T=$R.keyFrames=[],$g=$T.length=$j.getUint16(),$B=null,$z=NaN;for($i=0;$i<$g;$i++){var $L=$T[$i]=new $y();$z=$L.startTime=$V[$j.getUint16()];var $Y=$j.pos;$L.inTangent=new Float32Array($t.slice($Y,$Y+$_)),$j.pos+=$_,$Y=$j.pos,$L.outTangent=new Float32Array($t.slice($Y,$Y+$_)),$j.pos+=$_,$Y=$j.pos,$L.data=new Float32Array($t.slice($Y,$Y+$_)),$j.pos+=$_,$B&&($B.next=$L,$B.duration=$z-$B.startTime),$B=$L;}$L.next=null,$L.duration=$q-$z;}var $f=$c._nodeToCachePropertyMap=new Int32Array($s),$Z=$c._cachePropertyMap=new Int32Array($S),$u=$c._unCachePropertyMap=new Int32Array($x);for($S=$x=0,$F=0;$F<$s;$F++)($R=$k[$F])._cacheProperty?($f[$F]=$S,$Z[$S++]=$F):$u[$x++]=$F;},$v._animationClip=null,$v._reader=null,$v._strings=[],$s($v,["_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]);})(),function(){function $b(){}$h($b,"laya.d3.animation.AnimationClipParser02"),$b.READ_DATA=function(){$b._DATA.offset=$b._reader.getUint32(),$b._DATA.size=$b._reader.getUint32();},$b.READ_BLOCK=function(){for(var $R=$b._BLOCK.count=$b._reader.getUint16(),$F=$b._BLOCK.blockStarts=[],$i=$b._BLOCK.blockLengths=[],$j=0;$j<$R;$j++)$F.push($b._reader.getUint32()),$i.push($b._reader.getUint32());},$b.READ_STRINGS=function(){var $R=$b._reader.getUint32(),$F=$b._reader.getUint16(),$i=$b._reader.pos;$b._reader.pos=$R+$b._DATA.offset;for(var $j=0;$j<$F;$j++)$b._strings[$j]=$b._reader.readUTFString();$b._reader.pos=$i;},$b.parse=function($R,$F){$b._animationClip=$R;($b._reader=$F).__getBuffer();$b.READ_DATA(),$b.READ_BLOCK(),$b.READ_STRINGS();for(var $i=0,$j=$b._BLOCK.count;$i<$j;$i++){var $t=$F.getUint16(),$p=$b._strings[$t],$$=$b["READ_"+$p];if(null==$$)throw new Error("model file err,no this function:"+$t+" "+$p);$$.call();}},$b.READ_ANIMATIONS=function(){var $R,$F=0,$i=0,$j=$b._reader,$t=$j.__getBuffer(),$p=[],$$=$j.getUint8();for($p.length=$$,$F=0;$F<$$;$F++)$p[$F]=$j.getUint16();var $V=[],$N=$j.getUint16();for($V.length=$N,$F=0;$F<$N;$F++)$V[$F]=$j.getFloat32();var $c=$b._animationClip;$c.name=$b._strings[$j.getUint16()];var $q=$c._duration=$j.getFloat32();$c.islooping=!!$j.getByte(),$c._frameRate=$j.getInt16();var $s=$j.getInt16(),$k=$c._nodes=new Array();$k.length=$s,($c._publicClipDatas=[]).length=$s;var $h=$c._nodesMap={},$S=0,$x=0;for($F=0;$F<$s;$F++){$R=$k[$F]=new $E();var $a=$j.getUint16(),$m=$R.path=[];for($m.length=$a,$i=0;$i<$a;$i++)$m[$i]=$b._strings[$j.getUint16()];var $M=$m.join("/"),$J=$h[$M];$J||($h[$M]=$J=[]),$J.push($R);var $d=$j.getInt16();-1!==$d&&($R.componentType=$b._strings[$d]);var $w=$O._propertyIndexDic[$b._strings[$j.getUint16()]];if(null==$w)throw new Error("AnimationClipParser02:unknown property name.");var $X=$w<4,$H=!$X||$X&&""===$m[0];($R._cacheProperty=$H)?$S++:$x++,$R.propertyNameID=$w;var $_=$p[$j.getUint8()];$R.keyFrameWidth=$_/4;var $T=$R.keyFrames=[],$g=$T.length=$j.getUint16(),$B=null,$z=NaN;for($i=0;$i<$g;$i++){var $L=$T[$i]=new $y();$z=$L.startTime=$V[$j.getUint16()];var $Y=$j.pos;$L.inTangent=new Float32Array($t.slice($Y,$Y+$_)),$j.pos+=$_,$Y=$j.pos,$L.outTangent=new Float32Array($t.slice($Y,$Y+$_)),$j.pos+=$_,$Y=$j.pos,$L.data=new Float32Array($t.slice($Y,$Y+$_)),$j.pos+=$_,$B&&($B.next=$L,$B.duration=$z-$B.startTime),$B=$L;}$L.next=null,$L.duration=$q-$z;}var $f=$j.getUint16();for($F=0;$F<$f;$F++){var $Z,$u=new $G();$u.time=$j.getFloat32(),$u.eventName=$b._strings[$j.getUint16()];var $v=$j.getUint16();for(0<$v&&($u.params=$Z=[]),$i=0;$i<$v;$i++){switch($j.getByte()){case 0:$Z.push(!!$j.getByte());break;case 1:$Z.push($j.getInt32());break;case 2:$Z.push($j.getFloat32());break;case 3:$Z.push($b._strings[$j.getUint16()]);break;default:throw new Error("unknown type.");}}$c.addEvent($u);}var $K=$c._nodeToCachePropertyMap=new Int32Array($s),$e=$c._cachePropertyMap=new Int32Array($S),$Q=$c._unCachePropertyMap=new Int32Array($x);for($S=$x=0,$F=0;$F<$s;$F++)($R=$k[$F])._cacheProperty?($K[$F]=$S,$e[$S++]=$F):$Q[$x++]=$F;},$b._animationClip=null,$b._reader=null,$b._strings=[],$s($b,["_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]);}();var $G=function(){function $R(){this.time=NaN,this.eventName=null,this.params=null;}return $h($R,"laya.d3.animation.AnimationEvent"),$R;}(),$O=function(){function $j(){this._childs=[],this.transform=new $MF(this);}$h($j,"laya.d3.animation.AnimationNode");var $R=$j.prototype;return $w.imps($R,{"laya.d3.core.IClone":!0}),$R.addChild=function($R){$R._parent=this,$R.transform.setParent(this.transform),this._childs.push($R);},$R.removeChild=function($R){var $F=this._childs.indexOf($R);-1!==$F&&this._childs.splice($F,1);},$R.getChildByName=function($R){for(var $F=0,$i=this._childs.length;$F<$i;$F++){var $j=this._childs[$F];if($j.name===$R)return $j;}return null;},$R.getChildByIndex=function($R){return this._childs[$R];},$R.getChildCount=function(){return this._childs.length;},$R.cloneTo=function($R){var $F=$R;$F.name=this.name;for(var $i=0,$j=this._childs.length;$i<$j;$i++){var $t=this._childs[$i],$p=$t.clone();$F.addChild($p);var $$=$t.transform,$V=$p.transform;$V.setLocalPosition($$.getLocalPosition()),$V.setLocalRotation($$.getLocalRotation()),$V.setLocalScale($$.getLocalScale()),$V._localRotationEuler=$$._localRotationEuler,$V._setWorldMatrixIgnoreUpdate($$.getWorldMatrix());}},$R.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$j.__init__=function(){$j.registerAnimationNodeProperty("localPosition",$j._getLocalPosition,$j._setLocalPosition),$j.registerAnimationNodeProperty("localRotation",$j._getLocalRotation,$j._setLocalRotation),$j.registerAnimationNodeProperty("localScale",$j._getLocalScale,$j._setLocalScale),$j.registerAnimationNodeProperty("localRotationEuler",$j._getLocalRotationEuler,$j._setLocalRotationEuler),$j.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",$j._getParticleRenderSharedMaterialTintColor,$j._setParticleRenderSharedMaterialTintColor),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",$j._getMeshRenderSharedMaterialTilingOffset,$j._setMeshRenderSharedMaterialTilingOffset),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",$j._getMeshRenderSharedMaterialAlbedo,$j._setMeshRenderSharedMaterialAlbedo),$j.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",$j._getSkinnedMeshRenderSharedMaterialTilingOffset,$j._setSkinnedMeshRenderSharedMaterialTilingOffset),$j.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",$j._getSkinnedMeshRenderSharedMaterialAlbedo,$j._setSkinnedMeshRenderSharedMaterialAlbedo),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",$j._getMeshRenderSharedMaterialAlbedo,$j._setMeshRenderSharedMaterialAlbedo),$j.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",$j._getSkinnedMeshRenderSharedMaterialAlbedo,$j._setSkinnedMeshRenderSharedMaterialAlbedo),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",$j._getMeshRenderSharedMaterialIntensity,$j._setMeshRenderSharedMaterialIntensity),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",$j._getMeshRenderSharedMaterialAlpha,$j._setMeshRenderSharedMaterialAlpha),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",$j._getMeshRenderSharedMaterialAlphaColor,$j._setMeshRenderSharedMaterialAlphaColor),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",$j._getMeshRenderSharedMaterialBaseColor,$j._setMeshRenderSharedMaterialBaseColor),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",$j._getMeshRenderSharedMaterialDissolve,$j._setMeshRenderSharedMaterialDissolve),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",$j._getMeshRenderSharedMaterialDissolveSpeed,$j._setMeshRenderSharedMaterialDissolveSpeed),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",$j._getMeshRenderSharedMaterialMMultiplier,$j._setMeshRenderSharedMaterialMMultiplier),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",$j._getMeshRenderSharedMaterialBaseScrollSpeedX,$j._setMeshRenderSharedMaterialBaseScrollSpeedX),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",$j._getMeshRenderSharedMaterialBaseScrollSpeedY,$j._setMeshRenderSharedMaterialBaseScrollSpeedY),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",$j._getMeshRenderSharedMaterialSecondScrollSpeedX,$j._setMeshRenderSharedMaterialSecondScrollSpeedX),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",$j._getMeshRenderSharedMaterialSecondScrollSpeedY,$j._setMeshRenderSharedMaterialSecondScrollSpeedY),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",$j._getMeshRenderSharedMaterialDetailTilingOffset,$j._setMeshRenderSharedMaterialDetailTilingOffset),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",$j._getMeshRenderSharedMaterialDissolveTilingOffset,$j._setMeshRenderSharedMaterialDissolveTilingOffset),$j.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",$j._getMeshRenderSharedMaterialMaskTilingOffset,$j._setMeshRenderSharedMaterialMaskTilingOffset);},$j.registerAnimationNodeProperty=function($R,$F,$i){if($j._propertyIndexDic[$R])throw new Error("AnimationNode: this propertyName has registered.");$j._propertyIndexDic[$R]=$j._propertyIDCounter,$j._propertyGetFuncs[$j._propertyIDCounter]=$F,$j._propertySetFuncs[$j._propertyIDCounter]=$i,$j._propertyIDCounter++;},$j._getLocalPosition=function($R,$F){return $R?$R.transform.getLocalPosition():$F._transform.localPosition.elements;},$j._setLocalPosition=function($R,$F,$i){if($R)$R.transform.setLocalPosition($i);else{var $j=$F._transform,$t=$j.localPosition;$t.elements=$i,$j.localPosition=$t;}},$j._getLocalRotation=function($R,$F){return $R?$R.transform.getLocalRotation():$F._transform.localRotation.elements;},$j._setLocalRotation=function($R,$F,$i){if($R)$R.transform.setLocalRotation($i);else{var $j=$F._transform,$t=$j.localRotation;$t.elements=$i,$j.localRotation=$t;}},$j._getLocalScale=function($R,$F){return $R?$R.transform.getLocalScale():$F._transform.localScale.elements;},$j._setLocalScale=function($R,$F,$i){if($R)$R.transform.setLocalScale($i);else{var $j=$F._transform,$t=$j.localScale;$t.elements=$i,$j.localScale=$t;}},$j._getLocalRotationEuler=function($R,$F){return $R?$R.transform.getLocalRotationEuler():$F._transform.localRotationEuler.elements;},$j._setLocalRotationEuler=function($R,$F,$i){if($R)$R.transform.setLocalRotationEuler($i);else{var $j=$F._transform,$t=$j.localRotationEuler;$t.elements=$i,$j.localRotationEuler=$t;}},$j._getMeshRenderSharedMaterialTilingOffset=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.tilingOffset.elements:null;}return $F.meshRender.sharedMaterial.tilingOffset.elements;},$j._setMeshRenderSharedMaterialTilingOffset=function($R,$F,$i){var $j,$t;if($R){var $p=$R.transform._entity;$p&&(($t=($j=$p.owner.meshRender.material).tilingOffset).elements=$i,$j.tilingOffset=$t);}else($t=($j=$F.meshRender.material).tilingOffset).elements=$i,$j.tilingOffset=$t;},$j._getMeshRenderSharedMaterialAlbedo=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.albedoColor.elements:null;}return $F.meshRender.sharedMaterial.albedoColor.elements;},$j._setMeshRenderSharedMaterialAlbedo=function($R,$F,$i){var $j,$t;if($R){var $p=$R.transform._entity;$p&&(($t=($j=$p.owner.meshRender.material).albedoColor).elements=$i,$j.albedoColor=$t);}else($t=($j=$F.meshRender.material).albedoColor).elements=$i,$j.albedoColor=$t;},$j._getSkinnedMeshRenderSharedMaterialTilingOffset=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null;}return $F.skinnedMeshRender.sharedMaterial.tilingOffset.elements;},$j._setSkinnedMeshRenderSharedMaterialTilingOffset=function($R,$F,$i){var $j,$t;if($R){var $p=$R.transform._entity;$p&&(($t=($j=$p.owner.skinnedMeshRender.material).tilingOffset).elements=$i,$j.tilingOffset=$t);}else($t=($j=$F.skinnedMeshRender.material).tilingOffset).elements=$i,$j.tilingOffset=$t;},$j._getSkinnedMeshRenderSharedMaterialAlbedo=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null;}return $F.skinnedMeshRender.sharedMaterial.albedoColor.elements;},$j._setSkinnedMeshRenderSharedMaterialAlbedo=function($R,$F,$i){var $j,$t;if($R){var $p=$R.transform._entity;$p&&(($t=($j=$p.owner.skinnedMeshRender.material).albedoColor).elements=$i,$j.albedoColor=$t);}else($t=($j=$F.skinnedMeshRender.material).albedoColor).elements=$i,$j.albedoColor=$t;},$j._getParticleRenderSharedMaterialTintColor=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.particleRender.sharedMaterial.tintColor.elements:null;}return $F.particleRender.sharedMaterial.tintColor.elements;},$j._setParticleRenderSharedMaterialTintColor=function($R,$F,$i){var $j,$t;if($R){var $p=$R.transform._entity;$p&&(($t=($j=$p.owner.particleRender.material).tintColor).elements=$i,$j.tintColor=$t);}else($t=($j=$F.particleRender.material).tintColor).elements=$i,$j.tintColor=$t;},$j._getMeshRenderSharedMaterialAlphaColor=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.alphaColor.elements:null;}return $F.meshRender.sharedMaterial.alphaColor.elements;},$j._setMeshRenderSharedMaterialAlphaColor=function($R,$F,$i){var $j,$t;if($R){var $p=$R.transform._entity;$p&&(($t=($j=$p.owner.meshRender.material).alphaColor).elements=$i,$j.alphaColor=$t);}else($t=($j=$F.meshRender.material).alphaColor).elements=$i,$j.alphaColor=$t;},$j._getMeshRenderSharedMaterialBaseColor=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.baseColor.elements:null;}return $F.meshRender.sharedMaterial.baseColor.elements;},$j._setMeshRenderSharedMaterialBaseColor=function($R,$F,$i){var $j,$t;if($R){var $p=$R.transform._entity;$p&&(($t=($j=$p.owner.meshRender.material).baseColor).elements=$i,$j.baseColor=$t);}else($t=($j=$F.meshRender.material).baseColor).elements=$i,$j.baseColor=$t;},$j._getMeshRenderSharedMaterialDissolve=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.dissolve:0;}return $F.meshRender.sharedMaterial.dissolve;},$j._setMeshRenderSharedMaterialDissolve=function($R,$F,$i){if($R){var $j=$R.transform._entity;$j&&($j.owner.meshRender.material.dissolve=$i[0]);}else $F.meshRender.material.dissolve=$i[0];},$j._getMeshRenderSharedMaterialDissolveSpeed=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.dissolveSpeed:0;}return $F.meshRender.sharedMaterial.dissolveSpeed;},$j._setMeshRenderSharedMaterialDissolveSpeed=function($R,$F,$i){if($R){var $j=$R.transform._entity;$j&&($j.owner.meshRender.material.dissolveSpeed=$i[0]);}else $F.meshRender.material.dissolveSpeed=$i[0];},$j._getMeshRenderSharedMaterialMMultiplier=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.mMultiplier:0;}return $F.meshRender.sharedMaterial.mMultiplier;},$j._setMeshRenderSharedMaterialMMultiplier=function($R,$F,$i){if($R){var $j=$R.transform._entity;$j&&($j.owner.meshRender.material.mMultiplier=$i[0]);}else $F.meshRender.material.mMultiplier=$i[0];},$j._getMeshRenderSharedMaterialBaseScrollSpeedX=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.baseScrollSpeedX:0;}return $F.meshRender.sharedMaterial.baseScrollSpeedX;},$j._setMeshRenderSharedMaterialBaseScrollSpeedX=function($R,$F,$i){if($R){var $j=$R.transform._entity;$j&&($j.owner.meshRender.material.baseScrollSpeedX=$i[0]);}else $F.meshRender.material.baseScrollSpeedX=$i[0];},$j._getMeshRenderSharedMaterialBaseScrollSpeedY=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.baseScrollSpeedY:0;}return $F.meshRender.sharedMaterial.baseScrollSpeedY;},$j._setMeshRenderSharedMaterialBaseScrollSpeedY=function($R,$F,$i){if($R){var $j=$R.transform._entity;$j&&($j.owner.meshRender.material.baseScrollSpeedY=$i[0]);}else $F.meshRender.material.baseScrollSpeedY=$i[0];},$j._getMeshRenderSharedMaterialSecondScrollSpeedX=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.secondScrollSpeedX:0;}return $F.meshRender.sharedMaterial.secondScrollSpeedX;},$j._setMeshRenderSharedMaterialSecondScrollSpeedX=function($R,$F,$i){if($R){var $j=$R.transform._entity;$j&&($j.owner.meshRender.material.secondScrollSpeedX=$i[0]);}else $F.meshRender.material.secondScrollSpeedX=$i[0];},$j._getMeshRenderSharedMaterialSecondScrollSpeedY=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.secondScrollSpeedY:0;}return $F.meshRender.sharedMaterial.secondScrollSpeedY;},$j._setMeshRenderSharedMaterialSecondScrollSpeedY=function($R,$F,$i){if($R){var $j=$R.transform._entity;$j&&($j.owner.meshRender.material.secondScrollSpeedY=$i[0]);}else $F.meshRender.material.secondScrollSpeedY=$i[0];},$j._getMeshRenderSharedMaterialAlpha=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.alpha:0;}return $F.meshRender.sharedMaterial.alpha;},$j._setMeshRenderSharedMaterialAlpha=function($R,$F,$i){if($R){var $j=$R.transform._entity;$j&&($j.owner.meshRender.material.alpha=$i[0]);}else $F.meshRender.material.alpha=$i[0];},$j._getMeshRenderSharedMaterialIntensity=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.intensity:0;}return $F.meshRender.sharedMaterial.intensity;},$j._setMeshRenderSharedMaterialIntensity=function($R,$F,$i){if($R){var $j=$R.transform._entity;$j&&($j.owner.meshRender.material.intensity=$i[0]);}else $F.meshRender.material.intensity=$i[0];},$j._getMeshRenderSharedMaterialDetailTilingOffset=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null;}return $F.meshRender.sharedMaterial.detailTilingOffset.elements;},$j._setMeshRenderSharedMaterialDetailTilingOffset=function($R,$F,$i){var $j,$t;if($R){var $p=$R.transform._entity;$p&&(($t=($j=$p.owner.meshRender.material).detailTilingOffset).elements=$i,$j.detailTilingOffset=$t);}else($t=($j=$F.meshRender.material).detailTilingOffset).elements=$i,$j.detailTilingOffset=$t;},$j._getMeshRenderSharedMaterialDissolveTilingOffset=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null;}return $F.meshRender.sharedMaterial.dissolveTilingOffset.elements;},$j._setMeshRenderSharedMaterialDissolveTilingOffset=function($R,$F,$i){var $j,$t;if($R){var $p=$R.transform._entity;$p&&(($t=($j=$p.owner.meshRender.material).dissolveTilingOffset).elements=$i,$j.dissolveTilingOffset=$t);}else($t=($j=$F.meshRender.material).dissolveTilingOffset).elements=$i,$j.dissolveTilingOffset=$t;},$j._getMeshRenderSharedMaterialMaskTilingOffset=function($R,$F){if($R){var $i=$R.transform._entity;return $i?$i.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null;}return $F.meshRender.sharedMaterial.maskTilingOffset.elements;},$j._setMeshRenderSharedMaterialMaskTilingOffset=function($R,$F,$i){var $j,$t;if($R){var $p=$R.transform._entity;$p&&(($t=($j=$p.owner.meshRender.material).maskTilingOffset).elements=$i,$j.maskTilingOffset=$t);}else($t=($j=$F.meshRender.material).maskTilingOffset).elements=$i,$j.maskTilingOffset=$t;},$j._propertyIDCounter=0,$j._propertyIndexDic={},$j._propertySetFuncs=[],$j._propertyGetFuncs=[],$j;}(),$y=function(){function $R(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null;}return $h($R,"laya.d3.animation.Keyframe"),$R;}(),$E=function(){function $R(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null;}return $h($R,"laya.d3.animation.KeyframeNode"),$R;}(),$Z=(function(){function $R(){this._tempVector30=new $$F(),this._tempVector31=new $$F(),this._tempVector32=new $$F(),this._a=new $$F(),this._b=new $$F(),this._c=new $$F(),this._d=new $$F();}$h($R,"laya.d3.core.glitter.SplineCurvePositionVelocity");var $F=$R.prototype;$F.Init=function($R,$F,$i,$j){$R.cloneTo(this._d),$F.cloneTo(this._c),$$F.scale($R,2,this._a),$$F.scale($i,2,this._tempVector30),$$F.subtract(this._a,this._tempVector30,this._a),$$F.add(this._a,$F,this._a),$$F.add(this._a,$j,this._a),$$F.scale($i,3,this._b),$$F.scale($R,3,this._tempVector30),$$F.subtract(this._b,this._tempVector30,this._b),$$F.subtract(this._b,$j,this._b),$$F.scale($F,2,this._tempVector30),$$F.subtract(this._b,this._tempVector30,this._b);},$F.Slerp=function($R,$F){$$F.scale(this._a,$R*$R*$R,this._tempVector30),$$F.scale(this._b,$R*$R,this._tempVector31),$$F.scale(this._c,$R,this._tempVector32),$$F.add(this._tempVector30,this._tempVector31,$F),$$F.add($F,this._tempVector32,$F),$$F.add($F,this._d,$F);};}(),function(){function $e($R,$F,$i,$j){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=$R,this._h=$F,this._minHeight=$i,this._maxHeight=$j;}$h($e,"laya.d3.core.HeightMap");var $R=$e.prototype;$R._inBounds=function($R,$F){return 0<=$R&&$R<this._h&&0<=$F&&$F<this._w;},$R.getHeight=function($R,$F){return this._inBounds($R,$F)?this._datas[$R][$F]:NaN;},$S(0,$R,"width",function(){return this._w;}),$S(0,$R,"height",function(){return this._h;}),$S(0,$R,"maxHeight",function(){return this._maxHeight;}),$S(0,$R,"minHeight",function(){return this._minHeight;}),$e.creatFromMesh=function($R,$F,$i,$j){for(var $t=[],$p=[],$$=$R.getSubMeshCount(),$V=0;$V<$$;$V++){for(var $N=$R.getSubMesh($V),$c=$N._getVertexBuffer(),$q=$c.getData(),$s=[],$k=0;$k<$q.length;$k+=$c.vertexDeclaration.vertexStride/4){var $h=new $$F($q[$k+0],$q[$k+1],$q[$k+2]);$s.push($h);}$t.push($s);var $S=$N._getIndexBuffer();$p.push($S.getData());}var $x=$R.boundingBox,$a=$x.min.x,$m=$x.min.z,$M=$x.max.x,$J=$x.max.z,$d=$x.min.y,$w=$x.max.y,$X=$M-$a,$H=$J-$m,$_=$j.elements[0]=$X/($F-1),$T=$j.elements[1]=$H/($i-1),$g=new $e($F,$i,$d,$w),$B=$e._tempRay,$z=$B.direction.elements;$z[0]=0,$z[1]=-1,$z[2]=0;var $L=$w+.1;$B.origin.elements[1]=$L;for(var $Y=0;$Y<$i;$Y++){var $f=$m+$Y*$T;$g._datas[$Y]=[];for(var $Z=0;$Z<$F;$Z++){var $u=$a+$Z*$_,$v=$B.origin.elements;$v[0]=$u,$v[2]=$f;var $K=$e._getPosition($B,$t,$p);$g._datas[$Y][$Z]=$K===Number.MAX_VALUE?NaN:$L-$K;}}return $g;},$e.createFromImage=function($R,$F,$i){for(var $j=$R.width,$t=$R.height,$p=new $e($j,$t,$F,$i),$$=($i-$F)/254,$V=$R.getPixels(),$N=0,$c=0;$c<$t;$c++)for(var $q=$p._datas[$c]=[],$s=0;$s<$j;$s++){var $k=$V[$N++],$h=$V[$N++],$S=$V[$N++],$x=$V[$N++];$q[$s]=255==$k&&255==$h&&255==$S&&255==$x?NaN:($k+$h+$S)/3*$$+$F;}return $p;},$e._getPosition=function($R,$F,$i){for(var $j=Number.MAX_VALUE,$t=0;$t<$F.length;$t++)for(var $p=$F[$t],$$=$i[$t],$V=0;$V<$$.length;$V+=3){var $N=$p[$$[$V+0]],$c=$p[$$[$V+1]],$q=$p[$$[$V+2]],$s=$SF.rayIntersectsTriangle($R,$N,$c,$q);!isNaN($s)&&$s<$j&&($j=$s);}return $j;},$s($e,["_tempRay",function(){return this._tempRay=new $tF(new $$F(),new $$F());}]);}(),function(){function $t(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[];}$h($t,"laya.d3.core.Layer");var $R=$t.prototype;return $R._binarySearchIndex=function(){for(var $R=0,$F=$t._collsionTestList.length-1,$i=0;$R<=$F;){$i=Math.floor(($R+$F)/2);var $j=$t._collsionTestList[$i];if($j==this._number)return $i;$j>this._number?$F=$i-1:$R=$i+1;}return $R;},$R._addCollider=function($R){0===this._colliders.length&&$t._collsionTestList.splice(this._binarySearchIndex(),0,this._number),$R._isRigidbody?(this._colliders.unshift($R),this._nonRigidbodyOffset++):this._colliders.push($R);},$R._removeCollider=function($R){var $F=this._colliders.indexOf($R);$F<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice($F,1),0===this._colliders.length&&$t._collsionTestList.splice($t._collsionTestList.indexOf(this._number),1);},$S(0,$R,"number",function(){return this._number;}),$S(0,$R,"visible",function(){return this._visible;},function($R){this._visible=$R,$t._visibleLayers=$R?$t._visibleLayers|this.mask:$t._visibleLayers&~this.mask;}),$S(0,$R,"mask",function(){return this._mask;}),$S(1,$t,"visibleLayers",function(){return $t._visibleLayers;},function($R){$t._visibleLayers=$R;for(var $F=0,$i=$t._layerList.length;$F<$i;$F++){var $j=$t._layerList[$F];$j._visible=0!=($j._mask&$t._visibleLayers);}}),$t.__init__=function(){$t._layerList.length=31;for(var $R=0;$R<31;$R++){var $F=new $t();$t._layerList[$R]=$F,0===$R?($F.name="Default Layer",$F.visible=!0):($F.name="Layer-"+$R,$F.visible=!1),$F._number=$R,$F._mask=Math.pow(2,$R);}$t.currentCreationLayer=$t._layerList[0];},$t.getLayerByNumber=function($R){if($R<0||30<$R)throw new Error("无法返回指定Layer，该number超出范围！");return $t._layerList[$R];},$t.getLayerByName=function($R){for(var $F=0;$F<31;$F++)if($t._layerList[$F].name===$R)return $t._layerList[$F];throw new Error("无法返回指定Layer,该name不存在");},$t.isVisible=function($R){return 0!=($R&$t._currentCameraCullingMask&$t._visibleLayers);},$t._layerList=[],$t._visibleLayers=2147483647,$t._collsionTestList=[],$t._currentCameraCullingMask=2147483647,$t.maxCount=31,$t.currentCreationLayer=null,$t;}()),$u=(function(){function $R($R,$F,$i){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=$R,this._minCount=$F,this._maxCount=$i;}$h($R,"laya.d3.core.particleShuriKen.module.Burst");var $F=$R.prototype;$w.imps($F,{"laya.d3.core.IClone":!0}),$F.cloneTo=function($R){var $F=$R;$F._time=this._time,$F._minCount=this._minCount,$F._maxCount=this._maxCount;},$F.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$F,"time",function(){return this._time;}),$S(0,$F,"minCount",function(){return this._minCount;}),$S(0,$F,"maxCount",function(){return this._maxCount;});}(),function(){function $R($R){this._color=null,this.enbale=!1,this._color=$R;}$h($R,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var $F=$R.prototype;$F.cloneTo=function($R){var $F=$R;this._color.cloneTo($F._color),$F.enbale=this.enbale;},$F.clone=function(){var $R;switch(this._color.type){case 0:$R=$K.createByConstant(this._color.constant.clone());break;case 1:$R=$K.createByGradient(this._color.gradient.clone());break;case 2:$R=$K.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:$R=$K.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone());}var $F=new this.constructor($R);return $F.enbale=this.enbale,$F;},$S(0,$F,"color",function(){return this._color;});}(),function(){function $R(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[];}$h($R,"laya.d3.core.particleShuriKen.module.Emission");var $F=$R.prototype;$w.imps($F,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),$F._destroy=function(){this._bursts=null,this._destroyed=!0;},$F.getBurstsCount=function(){return this._bursts.length;},$F.getBurstByIndex=function($R){return this._bursts[$R];},$F.addBurst=function($R){var $F=this._bursts.length;if(0<$F)for(var $i=0;$i<$F;$i++)this._bursts[$i].time>$R.time&&this._bursts.splice($i,0,$R);this._bursts.push($R);},$F.removeBurst=function($R){var $F=this._bursts.indexOf($R);-1!==$F&&this._bursts.splice($F,1);},$F.removeBurstByIndex=function($R){this._bursts.splice($R,1);},$F.clearBurst=function(){this._bursts.length=0;},$F.cloneTo=function($R){var $F=$R,$i=$F._bursts;$i.length=this._bursts.length;for(var $j=0,$t=this._bursts.length;$j<$t;$j++){var $p=$i[$j];$p?this._bursts[$j].cloneTo($p):$i[$j]=this._bursts[$j].clone();}$F._emissionRate=this._emissionRate,$F.enbale=this.enbale;},$F.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$F,"destroyed",function(){return this._destroyed;}),$S(0,$F,"emissionRate",function(){return this._emissionRate;},function($R){if($R<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=$R;});}(),function(){function $j(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null;}$h($j,"laya.d3.core.particleShuriKen.module.FrameOverTime");var $R=$j.prototype;return $w.imps($R,{"laya.d3.core.IClone":!0}),$R.cloneTo=function($R){var $F=$R;$F._type=this._type,$F._constant=this._constant,this._overTime.cloneTo($F._overTime),$F._constantMin=this._constantMin,$F._constantMax=this._constantMax,this._overTimeMin.cloneTo($F._overTimeMin),this._overTimeMax.cloneTo($F._overTimeMax);},$R.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$R,"frameOverTimeData",function(){return this._overTime;}),$S(0,$R,"constant",function(){return this._constant;}),$S(0,$R,"type",function(){return this._type;}),$S(0,$R,"frameOverTimeDataMin",function(){return this._overTimeMin;}),$S(0,$R,"constantMin",function(){return this._constantMin;}),$S(0,$R,"frameOverTimeDataMax",function(){return this._overTimeMax;}),$S(0,$R,"constantMax",function(){return this._constantMax;}),$j.createByConstant=function($R){var $F=new $j();return $F._type=0,$F._constant=$R,$F;},$j.createByOverTime=function($R){var $F=new $j();return $F._type=1,$F._overTime=$R,$F;},$j.createByRandomTwoConstant=function($R,$F){var $i=new $j();return $i._type=2,$i._constantMin=$R,$i._constantMax=$F,$i;},$j.createByRandomTwoOverTime=function($R,$F){var $i=new $j();return $i._type=3,$i._overTimeMin=$R,$i._overTimeMax=$F,$i;},$j;}()),$v=function(){function $c(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null;}$h($c,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var $R=$c.prototype;return $w.imps($R,{"laya.d3.core.IClone":!0}),$R.cloneTo=function($R){var $F=$R;$F._type=this._type,$F._separateAxes=this._separateAxes,$F._constant=this._constant,this._constantSeparate.cloneTo($F._constantSeparate),this._gradient.cloneTo($F._gradient),this._gradientX.cloneTo($F._gradientX),this._gradientY.cloneTo($F._gradientY),this._gradientZ.cloneTo($F._gradientZ),$F._constantMin=this._constantMin,$F._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($F._constantMinSeparate),this._constantMaxSeparate.cloneTo($F._constantMaxSeparate),this._gradientMin.cloneTo($F._gradientMin),this._gradientMax.cloneTo($F._gradientMax),this._gradientXMin.cloneTo($F._gradientXMin),this._gradientXMax.cloneTo($F._gradientXMax),this._gradientYMin.cloneTo($F._gradientYMin),this._gradientYMax.cloneTo($F._gradientYMax),this._gradientZMin.cloneTo($F._gradientZMin),this._gradientZMax.cloneTo($F._gradientZMax);},$R.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$R,"gradientZ",function(){return this._gradientZ;}),$S(0,$R,"constant",function(){return this._constant;}),$S(0,$R,"gradient",function(){return this._gradient;}),$S(0,$R,"separateAxes",function(){return this._separateAxes;}),$S(0,$R,"type",function(){return this._type;}),$S(0,$R,"constantSeparate",function(){return this._constantSeparate;}),$S(0,$R,"gradientX",function(){return this._gradientX;}),$S(0,$R,"gradientY",function(){return this._gradientY;}),$S(0,$R,"gradientW",function(){return this._gradientW;}),$S(0,$R,"gradientMin",function(){return this._gradientMin;}),$S(0,$R,"constantMin",function(){return this._constantMin;}),$S(0,$R,"gradientMax",function(){return this._gradientMax;}),$S(0,$R,"constantMax",function(){return this._constantMax;}),$S(0,$R,"gradientWMin",function(){return this._gradientWMin;}),$S(0,$R,"constantMinSeparate",function(){return this._constantMinSeparate;}),$S(0,$R,"constantMaxSeparate",function(){return this._constantMaxSeparate;}),$S(0,$R,"gradientXMin",function(){return this._gradientXMin;}),$S(0,$R,"gradientXMax",function(){return this._gradientXMax;}),$S(0,$R,"gradientWMax",function(){return this._gradientWMax;}),$S(0,$R,"gradientYMin",function(){return this._gradientYMin;}),$S(0,$R,"gradientYMax",function(){return this._gradientYMax;}),$S(0,$R,"gradientZMin",function(){return this._gradientZMin;}),$S(0,$R,"gradientZMax",function(){return this._gradientZMax;}),$c.createByConstant=function($R){var $F=new $c();return $F._type=0,$F._separateAxes=!1,$F._constant=$R,$F;},$c.createByConstantSeparate=function($R){var $F=new $c();return $F._type=0,$F._separateAxes=!0,$F._constantSeparate=$R,$F;},$c.createByGradient=function($R){var $F=new $c();return $F._type=1,$F._separateAxes=!1,$F._gradient=$R,$F;},$c.createByGradientSeparate=function($R,$F,$i,$j){var $t=new $c();return $t._type=1,$t._separateAxes=!0,$t._gradientX=$R,$t._gradientY=$F,$t._gradientZ=$i,$t._gradientW=$j,$t;},$c.createByRandomTwoConstant=function($R,$F){var $i=new $c();return $i._type=2,$i._separateAxes=!1,$i._constantMin=$R,$i._constantMax=$F,$i;},$c.createByRandomTwoConstantSeparate=function($R,$F){var $i=new $c();return $i._type=2,$i._separateAxes=!0,$i._constantMinSeparate=$R,$i._constantMaxSeparate=$F,$i;},$c.createByRandomTwoGradient=function($R,$F){var $i=new $c();return $i._type=3,$i._separateAxes=!1,$i._gradientMin=$R,$i._gradientMax=$F,$i;},$c.createByRandomTwoGradientSeparate=function($R,$F,$i,$j,$t,$p,$$,$V){var $N=new $c();return $N._type=3,$N._separateAxes=!0,$N._gradientXMin=$R,$N._gradientXMax=$F,$N._gradientYMin=$i,$N._gradientYMax=$j,$N._gradientZMin=$t,$N._gradientZMax=$p,$N._gradientWMin=$$,$N._gradientWMax=$V,$N;},$c;}(),$K=function(){function $j(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null;}$h($j,"laya.d3.core.particleShuriKen.module.GradientColor");var $R=$j.prototype;return $w.imps($R,{"laya.d3.core.IClone":!0}),$R.cloneTo=function($R){var $F=$R;$F._type=this._type,this._constant.cloneTo($F._constant),this._constantMin.cloneTo($F._constantMin),this._constantMax.cloneTo($F._constantMax),this._gradient.cloneTo($F._gradient),this._gradientMin.cloneTo($F._gradientMin),this._gradientMax.cloneTo($F._gradientMax);},$R.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$R,"gradient",function(){return this._gradient;}),$S(0,$R,"constant",function(){return this._constant;}),$S(0,$R,"type",function(){return this._type;}),$S(0,$R,"gradientMin",function(){return this._gradientMin;}),$S(0,$R,"constantMin",function(){return this._constantMin;}),$S(0,$R,"gradientMax",function(){return this._gradientMax;}),$S(0,$R,"constantMax",function(){return this._constantMax;}),$j.createByConstant=function($R){var $F=new $j();return $F._type=0,$F._constant=$R,$F;},$j.createByGradient=function($R){var $F=new $j();return $F._type=1,$F._gradient=$R,$F;},$j.createByRandomTwoConstant=function($R,$F){var $i=new $j();return $i._type=2,$i._constantMin=$R,$i._constantMax=$F,$i;},$j.createByRandomTwoGradient=function($R,$F){var $i=new $j();return $i._type=3,$i._gradientMin=$R,$i._gradientMax=$F,$i;},$j;}(),$e=(function(){function $R(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16);}$h($R,"laya.d3.core.particleShuriKen.module.GradientDataColor");var $F=$R.prototype;$w.imps($F,{"laya.d3.core.IClone":!0}),$F.addAlpha=function($R,$F){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==$R&&($R=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=$R,this._alphaElements[this._alphaCurrentLength++]=$F):DEBUG;},$F.addRGB=function($R,$F){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==$R&&($R=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=$R,this._rgbElements[this._rgbCurrentLength++]=$F.x,this._rgbElements[this._rgbCurrentLength++]=$F.y,this._rgbElements[this._rgbCurrentLength++]=$F.z):DEBUG;},$F.cloneTo=function($R){var $F=$R,$i=0,$j=0;$F._alphaCurrentLength=this._alphaCurrentLength;var $t=$F._alphaElements;for($t.length=this._alphaElements.length,$i=0,$j=this._alphaElements.length;$i<$j;$i++)$t[$i]=this._alphaElements[$i];$F._rgbCurrentLength=this._rgbCurrentLength;var $p=$F._rgbElements;for($p.length=this._rgbElements.length,$i=0,$j=this._rgbElements.length;$i<$j;$i++)$p[$i]=this._rgbElements[$i];},$F.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$F,"alphaGradientCount",function(){return this._alphaCurrentLength/2;}),$S(0,$F,"rgbGradientCount",function(){return this._rgbCurrentLength/4;});}(),function(){function $R(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8);}$h($R,"laya.d3.core.particleShuriKen.module.GradientDataInt");var $F=$R.prototype;$w.imps($F,{"laya.d3.core.IClone":!0}),$F.add=function($R,$F){this._currentLength<8?(6===this._currentLength&&1!==$R&&($R=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$R,this._elements[this._currentLength++]=$F):console.log("Warning:data count must lessEqual than 4");},$F.cloneTo=function($R){var $F=$R;$F._currentLength=this._currentLength;var $i=$F._elements;$i.length=this._elements.length;for(var $j=0,$t=this._elements.length;$j<$t;$j++)$i[$j]=this._elements[$j];},$F.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$F,"gradientCount",function(){return this._currentLength/2;});}(),function(){function $R(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8);}$h($R,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var $F=$R.prototype;$w.imps($F,{"laya.d3.core.IClone":!0}),$F.add=function($R,$F){this._currentLength<8?(6===this._currentLength&&1!==$R&&($R=1,DEBUG),this._elements[this._currentLength++]=$R,this._elements[this._currentLength++]=$F):DEBUG;},$F.getKeyByIndex=function($R){return this._elements[2*$R];},$F.getValueByIndex=function($R){return this._elements[2*$R+1];},$F.getAverageValue=function(){for(var $R=0,$F=this._currentLength-2;$R<$F;$R+=2){this._elements[$R+1];this._elements[$R+3],this._elements[$R+2]-this._elements[$R];}return 0;},$F.cloneTo=function($R){var $F=$R;$F._currentLength=this._currentLength;var $i=$F._elements;$i.length=this._elements.length;for(var $j=0,$t=this._elements.length;$j<$t;$j++)$i[$j]=this._elements[$j];},$F.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$F,"gradientCount",function(){return this._currentLength/2;});}(),function(){function $R(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12);}$h($R,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var $F=$R.prototype;$w.imps($F,{"laya.d3.core.IClone":!0}),$F.add=function($R,$F){this._currentLength<8?(6===this._currentLength&&1!==$R&&($R=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$R,this._elements[this._currentLength++]=$F.x,this._elements[this._currentLength++]=$F.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4");},$F.cloneTo=function($R){var $F=$R;$F._currentLength=this._currentLength;var $i=$F._elements;$i.length=this._elements.length;for(var $j=0,$t=this._elements.length;$j<$t;$j++)$i[$j]=this._elements[$j];},$F.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$F,"gradientCount",function(){return this._currentLength/3;});}(),function(){function $V(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null;}$h($V,"laya.d3.core.particleShuriKen.module.GradientSize");var $R=$V.prototype;return $w.imps($R,{"laya.d3.core.IClone":!0}),$R.getMaxSizeInGradient=function(){var $R=0,$F=0,$i=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for($R=0,$F=this._gradientX.gradientCount;$R<$F;$R++)$i=Math.max($i,this._gradientX.getValueByIndex($R));for($R=0,$F=this._gradientY.gradientCount;$R<$F;$R++)$i=Math.max($i,this._gradientY.getValueByIndex($R));}else for($R=0,$F=this._gradient.gradientCount;$R<$F;$R++)$i=Math.max($i,this._gradient.getValueByIndex($R));break;case 1:$i=this._separateAxes?($i=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),$i=Math.max($i,this._constantMinSeparate.y),Math.max($i,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for($R=0,$F=this._gradientXMin.gradientCount;$R<$F;$R++)$i=Math.max($i,this._gradientXMin.getValueByIndex($R));for($R=0,$F=this._gradientXMax.gradientCount;$R<$F;$R++)$i=Math.max($i,this._gradientXMax.getValueByIndex($R));for($R=0,$F=this._gradientYMin.gradientCount;$R<$F;$R++)$i=Math.max($i,this._gradientYMin.getValueByIndex($R));for($R=0,$F=this._gradientZMax.gradientCount;$R<$F;$R++)$i=Math.max($i,this._gradientZMax.getValueByIndex($R));}else{for($R=0,$F=this._gradientMin.gradientCount;$R<$F;$R++)$i=Math.max($i,this._gradientMin.getValueByIndex($R));for($R=0,$F=this._gradientMax.gradientCount;$R<$F;$R++)$i=Math.max($i,this._gradientMax.getValueByIndex($R));}}return $i;},$R.cloneTo=function($R){var $F=$R;$F._type=this._type,$F._separateAxes=this._separateAxes,this._gradient.cloneTo($F._gradient),this._gradientX.cloneTo($F._gradientX),this._gradientY.cloneTo($F._gradientY),this._gradientZ.cloneTo($F._gradientZ),$F._constantMin=this._constantMin,$F._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($F._constantMinSeparate),this._constantMaxSeparate.cloneTo($F._constantMaxSeparate),this._gradientMin.cloneTo($F._gradientMin),this._gradientMax.cloneTo($F._gradientMax),this._gradientXMin.cloneTo($F._gradientXMin),this._gradientXMax.cloneTo($F._gradientXMax),this._gradientYMin.cloneTo($F._gradientYMin),this._gradientYMax.cloneTo($F._gradientYMax),this._gradientZMin.cloneTo($F._gradientZMin),this._gradientZMax.cloneTo($F._gradientZMax);},$R.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$R,"gradientZ",function(){return this._gradientZ;}),$S(0,$R,"gradient",function(){return this._gradient;}),$S(0,$R,"separateAxes",function(){return this._separateAxes;}),$S(0,$R,"type",function(){return this._type;}),$S(0,$R,"gradientMin",function(){return this._gradientMin;}),$S(0,$R,"constantMin",function(){return this._constantMin;}),$S(0,$R,"gradientX",function(){return this._gradientX;}),$S(0,$R,"gradientY",function(){return this._gradientY;}),$S(0,$R,"gradientMax",function(){return this._gradientMax;}),$S(0,$R,"constantMax",function(){return this._constantMax;}),$S(0,$R,"constantMinSeparate",function(){return this._constantMinSeparate;}),$S(0,$R,"constantMaxSeparate",function(){return this._constantMaxSeparate;}),$S(0,$R,"gradientXMin",function(){return this._gradientXMin;}),$S(0,$R,"gradientXMax",function(){return this._gradientXMax;}),$S(0,$R,"gradientYMin",function(){return this._gradientYMin;}),$S(0,$R,"gradientYMax",function(){return this._gradientYMax;}),$S(0,$R,"gradientZMin",function(){return this._gradientZMin;}),$S(0,$R,"gradientZMax",function(){return this._gradientZMax;}),$V.createByGradient=function($R){var $F=new $V();return $F._type=0,$F._separateAxes=!1,$F._gradient=$R,$F;},$V.createByGradientSeparate=function($R,$F,$i){var $j=new $V();return $j._type=0,$j._separateAxes=!0,$j._gradientX=$R,$j._gradientY=$F,$j._gradientZ=$i,$j;},$V.createByRandomTwoConstant=function($R,$F){var $i=new $V();return $i._type=1,$i._separateAxes=!1,$i._constantMin=$R,$i._constantMax=$F,$i;},$V.createByRandomTwoConstantSeparate=function($R,$F){var $i=new $V();return $i._type=1,$i._separateAxes=!0,$i._constantMinSeparate=$R,$i._constantMaxSeparate=$F,$i;},$V.createByRandomTwoGradient=function($R,$F){var $i=new $V();return $i._type=2,$i._separateAxes=!1,$i._gradientMin=$R,$i._gradientMax=$F,$i;},$V.createByRandomTwoGradientSeparate=function($R,$F,$i,$j,$t,$p){var $$=new $V();return $$._type=2,$$._separateAxes=!0,$$._gradientXMin=$R,$$._gradientXMax=$F,$$._gradientYMin=$i,$$._gradientYMax=$j,$$._gradientZMin=$t,$$._gradientZMax=$p,$$;},$V;}()),$Q=function(){function $V(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null;}$h($V,"laya.d3.core.particleShuriKen.module.GradientVelocity");var $R=$V.prototype;return $w.imps($R,{"laya.d3.core.IClone":!0}),$R.cloneTo=function($R){var $F=$R;$F._type=this._type,this._constant.cloneTo($F._constant),this._gradientX.cloneTo($F._gradientX),this._gradientY.cloneTo($F._gradientY),this._gradientZ.cloneTo($F._gradientZ),this._constantMin.cloneTo($F._constantMin),this._constantMax.cloneTo($F._constantMax),this._gradientXMin.cloneTo($F._gradientXMin),this._gradientXMax.cloneTo($F._gradientXMax),this._gradientYMin.cloneTo($F._gradientYMin),this._gradientYMax.cloneTo($F._gradientYMax),this._gradientZMin.cloneTo($F._gradientZMin),this._gradientZMax.cloneTo($F._gradientZMax);},$R.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$R,"gradientZ",function(){return this._gradientZ;}),$S(0,$R,"constant",function(){return this._constant;}),$S(0,$R,"type",function(){return this._type;}),$S(0,$R,"gradientXMax",function(){return this._gradientXMax;}),$S(0,$R,"constantMin",function(){return this._constantMin;}),$S(0,$R,"gradientX",function(){return this._gradientX;}),$S(0,$R,"gradientY",function(){return this._gradientY;}),$S(0,$R,"gradientXMin",function(){return this._gradientXMin;}),$S(0,$R,"constantMax",function(){return this._constantMax;}),$S(0,$R,"gradientYMin",function(){return this._gradientYMin;}),$S(0,$R,"gradientYMax",function(){return this._gradientYMax;}),$S(0,$R,"gradientZMin",function(){return this._gradientZMin;}),$S(0,$R,"gradientZMax",function(){return this._gradientZMax;}),$V.createByConstant=function($R){var $F=new $V();return $F._type=0,$F._constant=$R,$F;},$V.createByGradient=function($R,$F,$i){var $j=new $V();return $j._type=1,$j._gradientX=$R,$j._gradientY=$F,$j._gradientZ=$i,$j;},$V.createByRandomTwoConstant=function($R,$F){var $i=new $V();return $i._type=2,$i._constantMin=$R,$i._constantMax=$F,$i;},$V.createByRandomTwoGradient=function($R,$F,$i,$j,$t,$p){var $$=new $V();return $$._type=3,$$._gradientXMin=$R,$$._gradientXMax=$F,$$._gradientYMin=$i,$$._gradientYMax=$j,$$._gradientZMin=$t,$$._gradientZMax=$p,$$;},$V;}(),$b=(function(){function $R($R){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=$R;}$h($R,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var $F=$R.prototype;$w.imps($F,{"laya.d3.core.IClone":!0}),$F.cloneTo=function($R){var $F=$R;this._angularVelocity.cloneTo($F._angularVelocity),$F.enbale=this.enbale;},$F.clone=function(){var $R;switch(this._angularVelocity.type){case 0:$R=this._angularVelocity.separateAxes?$v.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):$v.createByConstant(this._angularVelocity.constant);break;case 1:$R=this._angularVelocity.separateAxes?$v.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):$v.createByGradient(this._angularVelocity.gradient.clone());break;case 2:$R=this._angularVelocity.separateAxes?$v.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):$v.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:$R=this._angularVelocity.separateAxes?$v.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):$v.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone());}var $F=new this.constructor($R);return $F.enbale=this.enbale,$F;},$S(0,$F,"angularVelocity",function(){return this._angularVelocity;});}(),function(){function $R(){this.enable=!1,this.randomDirection=!1;}$h($R,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var $F=$R.prototype;return $w.imps($F,{"laya.d3.core.IClone":!0}),$F._getShapeBoundBox=function($R){throw new Error("BaseShape: must override it.");},$F._getSpeedBoundBox=function($R){throw new Error("BaseShape: must override it.");},$F.generatePositionAndDirection=function($R,$F,$i,$j){throw new Error("BaseShape: must override it.");},$F._calculateProceduralBounds=function($R,$F,$i){this._getShapeBoundBox($R);var $j=$R.min,$t=$R.max;$$F.multiply($j,$F,$j),$$F.multiply($t,$F,$t);var $p=new $AR(new $$F(),new $$F());this.randomDirection?($p.min=new $$F(-1,-1,-1),$p.max=new $$F(1,1,1)):this._getSpeedBoundBox($p);var $$=new $AR(new $$F(),new $$F()),$V=$$.min,$N=$$.max;$$F.scale($p.min,$i.y,$V),$$F.scale($p.max,$i.y,$N),$$F.add($R.min,$V,$V),$$F.add($R.max,$N,$N),$$F.min($R.min,$V,$R.min),$$F.max($R.max,$V,$R.max);var $c=new $AR(new $$F(),new $$F()),$q=$c.min,$s=$c.max;$$F.scale($p.min,$i.x,$q),$$F.scale($p.max,$i.x,$s),$$F.min($c.min,$s,$V),$$F.max($c.min,$s,$N),$$F.min($R.min,$V,$R.min),$$F.max($R.max,$V,$R.max);},$F.cloneTo=function($R){$R.enable=this.enable;},$F.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$R;}()),$l=function(){function $p(){}return $h($p,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),$p._randomPointUnitArcCircle=function($R,$F,$i){var $j=$F.elements,$t=NaN;$t=$i?$i.getFloat()*$R:Math.random()*$R,$j[0]=Math.cos($t),$j[1]=Math.sin($t);},$p._randomPointInsideUnitArcCircle=function($R,$F,$i){var $j=$F.elements;$p._randomPointUnitArcCircle($R,$F,$i);var $t=NaN;$t=$i?Math.pow($i.getFloat(),.5):Math.pow(Math.random(),.5),$j[0]=$j[0]*$t,$j[1]=$j[1]*$t;},$p._randomPointUnitCircle=function($R,$F){var $i=$R.elements,$j=NaN;$j=$F?$F.getFloat()*Math.PI*2:Math.random()*Math.PI*2,$i[0]=Math.cos($j),$i[1]=Math.sin($j);},$p._randomPointInsideUnitCircle=function($R,$F){var $i=$R.elements;$p._randomPointUnitCircle($R);var $j=NaN;$j=$F?Math.pow($F.getFloat(),.5):Math.pow(Math.random(),.5),$i[0]=$i[0]*$j,$i[1]=$i[1]*$j;},$p._randomPointUnitSphere=function($R,$F){var $i=$R.elements,$j=NaN,$t=NaN;$t=$F?($j=$i[2]=2*$F.getFloat()-1,$F.getFloat()*Math.PI*2):($j=$i[2]=2*Math.random()-1,Math.random()*Math.PI*2);var $p=Math.sqrt(1-$j*$j);$i[0]=$p*Math.cos($t),$i[1]=$p*Math.sin($t);},$p._randomPointInsideUnitSphere=function($R,$F){var $i=$R.elements;$p._randomPointUnitSphere($R);var $j=NaN;$j=$F?Math.pow($F.getFloat(),1/3):Math.pow(Math.random(),1/3),$i[0]=$i[0]*$j,$i[1]=$i[1]*$j,$i[2]=$i[2]*$j;},$p._randomPointInsideHalfUnitBox=function($R,$F){var $i=$R.elements;$F?($i[0]=$F.getFloat()-.5,$i[1]=$F.getFloat()-.5,$i[2]=$F.getFloat()-.5):($i[0]=Math.random()-.5,$i[1]=Math.random()-.5,$i[2]=Math.random()-.5);},$p;}(),$W=(function(){function $R($R){this._size=null,this.enbale=!1,this._size=$R;}$h($R,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var $F=$R.prototype;$w.imps($F,{"laya.d3.core.IClone":!0}),$F.cloneTo=function($R){var $F=$R;this._size.cloneTo($F._size),$F.enbale=this.enbale;},$F.clone=function(){var $R;switch(this._size.type){case 0:$R=this._size.separateAxes?$e.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):$e.createByGradient(this._size.gradient.clone());break;case 1:$R=this._size.separateAxes?$e.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):$e.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:$R=this._size.separateAxes?$e.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):$e.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone());}var $F=new this.constructor($R);return $F.enbale=this.enbale,$F;},$S(0,$F,"size",function(){return this._size;});}(),function(){function $j(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN;}$h($j,"laya.d3.core.particleShuriKen.module.StartFrame");var $R=$j.prototype;return $w.imps($R,{"laya.d3.core.IClone":!0}),$R.cloneTo=function($R){var $F=$R;$F._type=this._type,$F._constant=this._constant,$F._constantMin=this._constantMin,$F._constantMax=this._constantMax;},$R.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$R,"constant",function(){return this._constant;}),$S(0,$R,"type",function(){return this._type;}),$S(0,$R,"constantMin",function(){return this._constantMin;}),$S(0,$R,"constantMax",function(){return this._constantMax;}),$j.createByConstant=function($R){var $F=new $j();return $F._type=0,$F._constant=$R,$F;},$j.createByRandomTwoConstant=function($R,$F){var $i=new $j();return $i._type=1,$i._constantMin=$R,$i._constantMax=$F,$i;},$j;}()),$o=(function(){function $R($R,$F){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new $pF(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=$R,this._startFrame=$F;}$h($R,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var $F=$R.prototype;$w.imps($F,{"laya.d3.core.IClone":!0}),$F.cloneTo=function($R){var $F=$R;this.tiles.cloneTo($F.tiles),$F.type=this.type,$F.randomRow=this.randomRow,this._frame.cloneTo($F._frame),this._startFrame.cloneTo($F._startFrame),$F.cycles=this.cycles,$F.enableUVChannels=this.enableUVChannels,$F.enable=this.enable;},$F.clone=function(){var $R,$F;switch(this._frame.type){case 0:$R=$u.createByConstant(this._frame.constant);break;case 1:$R=$u.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:$R=$u.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:$R=$u.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone());}switch(this._startFrame.type){case 0:$F=$W.createByConstant(this._startFrame.constant);break;case 1:$F=$W.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax);}var $i=new this.constructor($R,$F);return this.tiles.cloneTo($i.tiles),$i.type=this.type,$i.randomRow=this.randomRow,$i.cycles=this.cycles,$i.enableUVChannels=this.enableUVChannels,$i.enable=this.enable,$i;},$S(0,$F,"frame",function(){return this._frame;}),$S(0,$F,"startFrame",function(){return this._startFrame;});}(),function(){function $R($R){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=$R;}$h($R,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var $F=$R.prototype;$w.imps($F,{"laya.d3.core.IClone":!0}),$F.cloneTo=function($R){var $F=$R;this._velocity.cloneTo($F._velocity),$F.enbale=this.enbale,$F.space=this.space;},$F.clone=function(){var $R;switch(this._velocity.type){case 0:$R=$Q.createByConstant(this._velocity.constant.clone());break;case 1:$R=$Q.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:$R=$Q.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:$R=$Q.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone());}var $F=new this.constructor($R);return $F.enbale=this.enbale,$F.space=this.space,$F;},$S(0,$F,"velocity",function(){return this._velocity;});}(),function(){function $R(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new $kF(),this._vb=$bF.create($R._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=$QF.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=$KF.nameKey.getID("LINE"),this._shaderCompile=$_F._preCompileShader[this._sharderNameID];}$h($R,"laya.d3.core.PhasorSpriter3D");var $F=$R.prototype;return $F.line=function($R,$F,$i,$j){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($R.x,$R.y,$R.z,$F.x,$F.y,$F.z,$F.w),this.addVertex($i.x,$i.y,$i.z,$j.x,$j.y,$j.z,$j.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this;},$F.circle=function($R,$F,$i,$j,$t,$p){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*$F,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/$F,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*$R,Math.cos(this._tempNumver0)*$R,0,$i,$j,$t,$p),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this;},$F.plane=function($R,$F,$i,$j,$t,$p,$$,$V,$N){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=$j/2,this._tempNumver1=$t/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($R-this._tempNumver0,$F+this._tempNumver1,$i,$p,$$,$V,$N),this.addVertex($R+this._tempNumver0,$F+this._tempNumver1,$i,$p,$$,$V,$N),this.addVertex($R-this._tempNumver0,$F-this._tempNumver1,$i,$p,$$,$V,$N),this.addVertex($R+this._tempNumver0,$F-this._tempNumver1,$i,$p,$$,$V,$N),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this;},$F.box=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=$j/2,this._tempNumver1=$t/2,this._tempNumver2=$p/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($R-this._tempNumver0,$F+this._tempNumver1,$i+this._tempNumver2,$$,$V,$N,$c),this.addVertex($R+this._tempNumver0,$F+this._tempNumver1,$i+this._tempNumver2,$$,$V,$N,$c),this.addVertex($R-this._tempNumver0,$F-this._tempNumver1,$i+this._tempNumver2,$$,$V,$N,$c),this.addVertex($R+this._tempNumver0,$F-this._tempNumver1,$i+this._tempNumver2,$$,$V,$N,$c),this.addVertex($R+this._tempNumver0,$F+this._tempNumver1,$i-this._tempNumver2,$$,$V,$N,$c),this.addVertex($R-this._tempNumver0,$F+this._tempNumver1,$i-this._tempNumver2,$$,$V,$N,$c),this.addVertex($R+this._tempNumver0,$F-this._tempNumver1,$i-this._tempNumver2,$$,$V,$N,$c),this.addVertex($R-this._tempNumver0,$F-this._tempNumver1,$i-this._tempNumver2,$$,$V,$N,$c),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this;},$F.cone=function($R,$F,$i,$j,$t,$p,$$){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*$i+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*$i>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/$i,this.addVertexIndex(0,$F,0,$j,$t,$p,$$,this._tempUint0),this.addVertexIndex(0,0,0,$j,$t,$p,$$,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<$i;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex($R*this._tempNumver2,0,$R*this._tempNumver3,$j,$t,$p,$$,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==$i-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex($R*this._tempNumver2,0,$R*this._tempNumver3,$j,$t,$p,$$,this._tempUint0+(this._tempInt0+$i)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==$i-1?this.addIndexes(this._tempUint1+$i+2):this.addIndexes(this._tempUint1+this._tempInt0+$i+1),this.addIndexes(this._tempUint1+this._tempInt0+$i),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this;},$F.boundingBoxLine=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($R,$t,$p,$$,$V,$N,$c),this.addVertex($j,$t,$p,$$,$V,$N,$c),this.addVertex($R,$F,$p,$$,$V,$N,$c),this.addVertex($j,$F,$p,$$,$V,$N,$c),this.addVertex($j,$t,$i,$$,$V,$N,$c),this.addVertex($R,$t,$i,$$,$V,$N,$c),this.addVertex($j,$F,$i,$$,$V,$N,$c),this.addVertex($R,$F,$i,$$,$V,$N,$c),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this;},$F.addVertex=function($R,$F,$i,$j,$t,$p,$$){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=$R,this._vbData[this._posInVBData+1]=$F,this._vbData[this._posInVBData+2]=$i,this._vbData[this._posInVBData+3]=$j,this._vbData[this._posInVBData+4]=$t,this._vbData[this._posInVBData+5]=$p,this._vbData[this._posInVBData+6]=$$,this._posInVBData+=this._floatSizePerVer,this;},$F.addVertexIndex=function($R,$F,$i,$j,$t,$p,$$,$V){return this._hasBegun||this.addVertexIndexException(),this._vbData[$V]=$R,this._vbData[$V+1]=$F,this._vbData[$V+2]=$i,this._vbData[$V+3]=$j,this._vbData[$V+4]=$t,this._vbData[$V+5]=$p,this._vbData[$V+6]=$$,($V+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=$V),this;},$F.addIndexes=function($R){var $F=arguments;this._hasBegun||this.addVertexIndexException();for(var $i=0;$i<$F.length;$i++)this._ibData[this._posInIBData]=$F[$i],this._posInIBData++;return this;},$F.begin=function($R,$F){return this._hasBegun&&this.beginException0(),1!==$R&&4!==$R&&this.beginException1(),this._primitiveType=$R,this._camera=$F,this._hasBegun=!0,this;},$F.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this;},$F.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes($R._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),$_.drawCall++,$L.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0);},$F.addVertexIndexException=function(){throw new Error("请先调用begin()函数");},$F.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！");},$F.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！");},$F.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！");},$F.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！");},$F.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！");},$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(28,[new $$R(0,"vector3",0),new $$R(12,"vector4",1)]);}]),$R;}()),$n=function(){function $R(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++$R._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new $kF();}$h($R,"laya.d3.core.render.RenderElement");var $F=$R.prototype;return $F.getDynamicBatchBakedVertexs=function($R){for(var $F=this._renderObj._getVertexBuffer($R),$i=$F.getData().slice(),$j=$F.vertexDeclaration,$t=$j.getVertexElementByUsage(0).offset/4,$p=$j.getVertexElementByUsage(3).offset/4,$$=this._sprite3D.transform,$V=$$.worldMatrix,$N=$$.rotation,$c=$j.vertexStride/4,$q=0,$s=$i.length;$q<$s;$q+=$c){var $k=$q+$t,$h=$q+$p;$aF.transformVector3ArrayToVector3ArrayCoordinate($i,$k,$V,$i,$k),$aF.transformVector3ArrayByQuat($i,$h,$N,$i,$h);}return $i;},$F.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData();},$F._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this);},$S(0,$F,"id",function(){return this._id;}),$S(0,$F,"renderObj",function(){return this._renderObj;},function($R){this._renderObj!==$R&&(this._renderObj=$R);}),$R._uniqueIDCounter=0,$R;}(),$C=function(){function $F($R){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++$F._uniqueIDCounter,this._needSort=!1,this._scene=$R,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={};}$h($F,"laya.d3.core.render.RenderQueue");var $R=$F.prototype;return $R._sortOpaqueFunc=function($R,$F){if($R._render&&$F._render){var $i=$R._material.renderQueue-$F._material.renderQueue;return 0==$i?$R._render._distanceForSort-$F._render._distanceForSort:$i;}return 0;},$R._sortAlphaFunc=function($R,$F){if($R._render&&$F._render){var $i=$R._material.renderQueue-$F._material.renderQueue;return 0==$i?$F._render._distanceForSort-$R._render._distanceForSort:$i;}return 0;},$R._begainRenderElement=function($R,$F,$i){return!!$F._beforeRender($R);},$R._sortAlpha=function($R){$F._cameraPosition=$R,this._finalElements.sort(this._sortAlphaFunc);},$R._sortOpaque=function($R){$F._cameraPosition=$R,this._finalElements.sort(this._sortOpaqueFunc);},$R._preRender=function($R){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements);},$R._render=function($R,$F){for(var $i,$j,$t,$p,$$,$V,$N=$_.loopCount,$c=this._scene,$q=$R.camera,$s=($q.id,!1),$k=0,$h=this._finalElements.length;$k<$h;$k++){var $S,$x,$a,$m=this._finalElements[$k];if(null!=$m._onPreRenderFunction&&$m._onPreRenderFunction.call($m._sprite3D,$R),0===$m._type){if($R.owner=$a=$m._sprite3D,$R.renderElement=$m,$a._preRenderUpdateComponents($R),$S=$m.renderObj,$x=$m._material,this._begainRenderElement($R,$S,$x)){if($i=$S._getVertexBuffers(),!($t=($j=$S._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[$j.id]){this._errorRecord[$j.id]=1;var $M="vertexBuffer:"+("("+$j._destroyed+","+$j._released+","+$j._referenceCount+","+$j._buffer+")")+", material:"+($x?$x.__className+"("+$x._destroyed+","+$x._released+")":"null")+", owner:"+($a?$a.__className+"("+$a._destroyed+","+$a._activeInHierarchy+","+$a._displayedInStage+")":"null")+", renderObj:"+($S?$S.__className+"("+$S._destroyed+","+$S._released+","+$S._referenceCount+")":"")+", parent:, url:"+($a?$a.url:"")+", disposeStack:"+$j.disposeStack;$w.recordError("报错：unknown vertexDeclaration  "+$M);}continue;}if($s=($p=$R._shader=$x._getShader($c._shaderDefineValue,$t.shaderDefineValue,$a._shaderDefineValue)).bind()||$N!==$p._uploadLoopCount,$i){if($p._uploadVertexBuffer!==$i||$s){for(var $J=0;$J<$i.length;$J++){var $d=$i[$J];$p.uploadAttributesX($d.vertexDeclaration.shaderValues.data,$d);}$p._uploadVertexBuffer=$i;}}else($p._uploadVertexBuffer!==$j||$s)&&($p.uploadAttributes($t.shaderValues.data,null),$p._uploadVertexBuffer=$j);($p._uploadScene!==$c||$s)&&($p.uploadSceneUniforms($c._shaderValues.data),$p._uploadScene=$c),($q!==$p._uploadCamera||$p._uploadSprite3D!==$a||$s)&&($p.uploadSpriteUniforms($a._shaderValues.data),$p._uploadSprite3D=$a),($q!==$p._uploadCamera||$s)&&($p.uploadCameraUniforms($q._shaderValues.data),$p._uploadCamera=$q),($p._uploadMaterial!==$x||$s)&&($x._upload(),$p._uploadMaterial=$x),$$!==$x?($x._setRenderStateBlendDepth(),$x._setRenderStateFrontFace($F,$a.transform),$$=$x,$V=$a):$V!==$a&&($x._setRenderStateFrontFace($F,$a.transform),$V=$a),$S._render($R),$p._uploadLoopCount=$N;}$a._postRenderUpdateComponents($R);}else if(2===$m._type){$m.renderObj;$R.owner=$a=$m._sprite3D,$R.renderElement=$m,$R._batchIndexStart=$m._tempBatchIndexStart,$R._batchIndexEnd=$m._tempBatchIndexEnd,$S=$m.renderObj,$x=$m._material,this._begainRenderElement($R,$S,$x)&&($t=($j=$S._getVertexBuffer(0)).vertexDeclaration,$s=($p=$R._shader=$x._getShader($c._shaderDefineValue,$t.shaderDefineValue,$a._shaderDefineValue)).bind()||$N!==$p._uploadLoopCount,($p._uploadVertexBuffer!==$j||$s)&&($p.uploadAttributes($t.shaderValues.data,null),$p._uploadVertexBuffer=$j),($p._uploadScene!==$c||$s)&&($p.uploadSceneUniforms($c._shaderValues.data),$p._uploadScene=$c),($q!==$p._uploadCamera||$p._uploadSprite3D!==$a||$s)&&($p.uploadSpriteUniforms($a._shaderValues.data),$p._uploadSprite3D=$a),($q!==$p._uploadCamera||$s)&&($p.uploadCameraUniforms($q._shaderValues.data),$p._uploadCamera=$q),($p._uploadMaterial!==$x||$s)&&($x._upload(),$p._uploadMaterial=$x),$$!==$x?($x._setRenderStateBlendDepth(),$x._setRenderStateFrontFace($F,$a.transform),$$=$x,$V=$a):$V!==$a&&($x._setRenderStateFrontFace($F,$a.transform),$V=$a),$S._render($R),$p._uploadLoopCount=$N);}}},$R._renderShadow=function($R,$F){for(var $i,$j,$t,$p,$$,$V=$_.loopCount,$N=this._scene,$c=$R.camera,$q=!1,$s=0,$k=this._finalElements.length;$s<$k;$s++){var $h,$S,$x,$a=this._finalElements[$s];0===$a._type&&($R.owner=$x=$a._sprite3D,$F||$x._projectionViewWorldUpdateCamera===$c&&$x._projectionViewWorldUpdateLoopCount===$_.loopCount||($x._render._renderUpdate($R._projectionViewMatrix),$x._projectionViewWorldUpdateLoopCount=$_.loopCount,$x._projectionViewWorldUpdateCamera=$c),$R.renderElement=$a,$x._preRenderUpdateComponents($R),$h=$a.renderObj,$S=$a._material,this._begainRenderElement($R,$h,null)&&($j=($i=$h._getVertexBuffer(0)).vertexDeclaration,$q=($t=$R._shader=$S._getShader($N._shaderDefineValue,$j.shaderDefineValue,$x._shaderDefineValue)).bind()||$V!==$t._uploadLoopCount,($t._uploadVertexBuffer!==$i||$q)&&($t.uploadAttributes($j.shaderValues.data,null),$t._uploadVertexBuffer=$i),($c!==$t._uploadCamera||$t._uploadSprite3D!==$x||$q)&&($t.uploadSpriteUniforms($x._shaderValues.data),$t._uploadSprite3D=$x),($c!==$t._uploadCamera||$q)&&($t.uploadCameraUniforms($c._shaderValues.data),$t._uploadCamera=$c),($t._uploadMaterial!==$S||$q)&&($S._upload(),$t._uploadMaterial=$S),$t._uploadRenderElement,$p!==$S?($S._setRenderStateFrontFace(!1,$x.transform),$p=$S,$$=$x):$$!==$x&&($S._setRenderStateFrontFace(!1,$x.transform),$$=$x),$h._render($R),$t._uploadLoopCount=$V),$x._postRenderUpdateComponents($R));}},$R._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0;},$R._addRenderElement=function($R){this._renderElements.push($R),this._needSort=!0;},$R._addDynamicBatchElement=function($R){this._dynamicBatchCombineRenderElements.push($R);},$S(0,$R,"id",function(){return this._id;}),$F._uniqueIDCounter=0,$F._cameraPosition=null,$F;}(),$r=function(){function $R(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null;}return $h($R,"laya.d3.core.render.RenderState"),$R.clientWidth=0,$R.clientHeight=0,$R;}(),$A=function(){function $$($R,$F){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new $UR(new $$F(),0),this._corners=[new $$F(),new $$F(),new $$F(),new $$F(),new $$F(),new $$F(),new $$F(),new $$F()],this._boundingBoxCenter=new $$F(),this._children=$j(8),this._objects=[],this._tempBoundBoxCorners=[new $$F(),new $$F(),new $$F(),new $$F(),new $$F(),new $$F(),new $$F(),new $$F()],this._scene=$R,this._currentDepth=$F;}$h($$,"laya.d3.core.scene.OctreeNode");var $R=$$.prototype;return $w.imps($R,{"laya.d3.core.scene.ITreeNode":!0}),$R.init=function($R,$F){var $i=new $$F(),$j=new $$F();$$F.scale($F,-.5,$i),$$F.scale($F,.5,$j),$$F.add($i,$R,$i),$$F.add($j,$R,$j),this.exactBox=new $AR($i,$j),this.relaxBox=new $AR($i,$j);},$R.addTreeNode=function($R){1===Collision.boxContainsBox(this._relaxBox,$R.boundingBox)?this.addNodeDown($R,0):this.addObject($R);},$R.addChild=function($R){var $F=this._children[$R];if(null==$F){$F=new $$(this._scene,this._currentDepth+1),(this._children[$R]=$F)._parent=this,$$F.subtract(this._exactBox.max,this._exactBox.min,$$.tempSize),$$F.multiply($$.tempSize,$$._octreeSplit[$R],$$.tempCenter),$$F.add(this._exactBox.min,$$.tempCenter,$$.tempCenter),$$F.scale($$.tempSize,.25,$$.tempSize);var $i=new $$F(),$j=new $$F();$$F.subtract($$.tempCenter,$$.tempSize,$i),$$F.add($$.tempCenter,$$.tempSize,$j),$F.exactBox=new $AR($i,$j),$$F.scale($$.tempSize,$$.relax,$$.tempSize);var $t=new $$F(),$p=new $$F();$$F.subtract($$.tempCenter,$$.tempSize,$t),$$F.add($$.tempCenter,$$.tempSize,$p),$F.relaxBox=new $AR($t,$p);}return $F;},$R.addObject=function($R){($R._treeNode=this)._objects.push($R);},$R.removeObject=function($R){if($R._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var $F=this._objects.indexOf($R);return-1!==$F&&(this._objects.splice($F,1),!0);},$R.clearObject=function(){this._objects.length=0;},$R.addNodeUp=function($R,$F){this._parent&&1!==Collision.boxContainsBox(this._exactBox,$R.boundingBox)?this._parent.addNodeUp($R,$F-1):this.addNodeDown($R,$F);},$R.addNodeDown=function($R,$F){if($F<this._scene.treeLevel){var $i=this.inChildIndex($R.boundingBoxCenter),$j=this.addChild($i);1===Collision.boxContainsBox($j._relaxBox,$R.boundingBox)?$j.addNodeDown($R,++$F):this.addObject($R);}else this.addObject($R);},$R.inChildIndex=function($R){return 4*($R.z<this._boundingBoxCenter.z?0:1)+2*($R.y<this._boundingBoxCenter.y?0:1)+($R.x<this._boundingBoxCenter.x?0:1);},$R.updateObject=function($R){1===Collision.boxContainsBox(this._relaxBox,$R.boundingBox)?(this.removeObject($R),$R._treeNode=null,this.addNodeDown($R,this._currentDepth)):this._parent&&(this.removeObject($R),$R._treeNode=null,this._parent.addNodeUp($R,this._currentDepth-1));},$R.cullingObjects=function($R,$F,$i,$j,$t){var $p,$$=0,$V=0,$N=0,$c=this._scene._dynamicBatchManager;for($$=0,$p=this._objects.length;$$<$p;$$++){var $q=this._objects[$$];if($Z.isVisible($q._owner.layer.mask)&&$q.enable){if($F&&($_.treeSpriteCollision+=1,0===$R.containsBoundSphere($q.boundingSphere)))continue;$q._renderUpdate($t),$q._distanceForSort=$$F.distance($q.boundingSphere.center,$j)+$q.sortingFudge;var $s=$q._renderElements;for($V=0,$N=$s.length;$V<$N;$V++){var $k=$s[$V],$h=$k._staticBatch;if($h&&$h._material===$k._material)$h._addBatchRenderElement($k);else{var $S=$k.renderObj;$S.triangleCount<10&&1===$S._vertexBufferCount&&$S._getIndexBuffer()&&$k._material.renderQueue<2&&$k._canDynamicBatch&&!$q._owner.isStatic?$c._addPrepareRenderElement($k):this._scene.getRenderQueue($k._material.renderQueue)._addRenderElement($k);}}}}for($$=0;$$<8;$$++){var $x=this._children[$$];if(null!=$x){var $a=$F;if($F){var $m=$R.containsBoundBox($x._relaxBox);if($_.treeNodeCollision+=1,0===$m)continue;$a=2===$m;}$x.cullingObjects($R,$a,$i,$j,$t);}}},$R.cullingShadowObjects=function($R,$F,$i,$j,$t){var $p,$$=0,$V=0,$N=0;this._scene._dynamicBatchManager;for($$=0,$p=this._objects.length;$$<$p;$$++){var $c=this._objects[$$];if($c.castShadow&&$Z.isVisible($c._owner.layer.mask)&&$c.enable){if($i&&0===$R[0].containsBoundSphere($c.boundingSphere))continue;for(var $q=1,$s=$R.length;$q<$s;$q++){var $k=$F[$q-1];if(0!==$R[$q].containsBoundSphere($c.boundingSphere)){var $h=$c._renderElements;for($V=0,$N=$h.length;$V<$N;$V++)$k._addRenderElement($h[$V]);}}}}for($$=0;$$<8;$$++){var $S=this._children[$$];if(null!=$S){var $x=$i;if($i){var $a=$R[0].containsBoundBox($S._relaxBox);if(0===$a)continue;$x=2===$a;}$S.cullingShadowObjects($R,$F,$x,$j,$t);}}},$R.cullingShadowObjectsOnePSSM=function($R,$F,$i,$j,$t,$p){var $$,$V=$F[0],$N=0,$c=0,$q=0;for($N=0,$$=this._objects.length;$N<$$;$N++){var $s=this._objects[$N];if($s.castShadow&&$Z.isVisible($s._owner.layer.mask)&&$s.enable){if($j&&0===$R.containsBoundSphere($s.boundingSphere))continue;$s._renderUpdate($i);var $k=$s._renderElements;for($c=0,$q=$k.length;$c<$q;$c++)$V._addRenderElement($k[$c]);}}for($N=0;$N<8;$N++){var $h=this._children[$N];if(null!=$h){var $S=$j;if($j){var $x=$R.containsBoundBox($h._relaxBox);if(0===$x)continue;$S=2===$x;}$h.cullingShadowObjectsOnePSSM($R,$F,$i,$S,$t,$p);}}},$R.renderBoudingBox=function($R){this._renderBoudingBox($R);for(var $F=0;$F<8;++$F){var $i=this._children[$F];$i&&$i.renderBoudingBox($R);}},$R.buildAllChild=function($R){if($R<this._scene.treeLevel)for(var $F=0;$F<8;$F++){this.addChild($F).buildAllChild($R+1);}},$R._renderBoudingBox=function($R){},$S(0,$R,"exactBox",function(){return this._exactBox;},function($R){this._exactBox=$R,$$F.add($R.min,$R.max,this._boundingBoxCenter),$$F.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter);}),$S(0,$R,"relaxBox",function(){return this._relaxBox;},function($R){(this._relaxBox=$R).getCorners(this._corners),$UR.createfromPoints(this._corners,this._boundingSphere);}),$$.debugMode=!1,$$.relax=1.15,$$.CHILDNUM=8,$s($$,["tempVector0",function(){return this.tempVector0=new $$F();},"tempSize",function(){return this.tempSize=new $$F();},"tempCenter",function(){return this.tempCenter=new $$F();},"_octreeSplit",function(){return this._octreeSplit=[new $$F(.25,.25,.25),new $$F(.75,.25,.25),new $$F(.25,.75,.25),new $$F(.75,.75,.25),new $$F(.25,.25,.75),new $$F(.75,.25,.75),new $$F(.25,.75,.75),new $$F(.75,.75,.75)];}]),$$;}(),$P=(function(){function $R(){}$h($R,"laya.d3.core.scene.SceneManager");}(),function(){function $R($R,$F,$i,$j){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===$R&&($R=1),void 0===$F&&($F=1),void 0===$i&&($i=1),void 0===$j&&($j=1),this._r=$R,this._g=$F,this._b=$i,this._a=$j;}return $h($R,"laya.d3.core.trail.module.Color",null,"Color$1"),$R.prototype.cloneTo=function($R){$R._r=this._r,$R._g=this._g,$R._b=this._b,$R._a=this._a;},$s($R,["RED",function(){return this.RED=new $R(1,0,0,1);},"GREEN",function(){return this.GREEN=new $R(0,1,0,1);},"BLUE",function(){return this.BLUE=new $R(0,0,1,1);},"CYAN",function(){return this.CYAN=new $R(0,1,1,1);},"YELLOW",function(){return this.YELLOW=new $R(1,.92,.016,1);},"MAGENTA",function(){return this.MAGENTA=new $R(1,0,1,1);},"GRAY",function(){return this.GRAY=new $R(.5,.5,.5,1);},"WHITE",function(){return this.WHITE=new $R(1,1,1,1);},"BLACK",function(){return this.BLACK=new $R(0,0,0,1);}]),$R;}()),$U=(function(){function $R(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[];}$h($R,"laya.d3.core.trail.module.Gradient");var $F=$R.prototype;$F.setKeys=function($R,$F){var $i,$j;this._colorKeys=$R;for(var $t=this.index=0;$t<$R.length;$t++){var $p=($i=$R[$t]).color;this._colorKeyData[this.index++]=$p._r,this._colorKeyData[this.index++]=$p._g,this._colorKeyData[this.index++]=$p._b,this._colorKeyData[this.index++]=$i.time;}this._alphaKeys=$F;for(var $$=this.index=0;$$<$F.length;$$++)$j=$F[$$],this._alphaKeyData[this.index++]=$j.alpha,this._alphaKeyData[this.index++]=$j.time;},$F.cloneTo=function($R){var $F=0,$i=0,$j=this.colorKeys,$t=[];for($F=0,$i=$j.length;$F<$i;$F++){var $p=new $I();$j[$F].cloneTo($p),$t.push($p);}var $$=this.alphaKeys,$V=[];for($F=0,$i=$$.length;$F<$i;$F++){var $N=new $U();$$[$F].cloneTo($N),$V.push($N);}$R.setKeys($t,$V);},$S(0,$F,"mode",function(){return this._mode;},function($R){this._mode=$R;}),$S(0,$F,"colorKeys",function(){return this._colorKeys;},function($R){this._colorKeys=$R;for(var $F=this.index=0;$F<$R.length;$F++){var $i=$R[$F],$j=$i.color;this._colorKeyData[this.index++]=$j._r,this._colorKeyData[this.index++]=$j._g,this._colorKeyData[this.index++]=$j._b,this._colorKeyData[this.index++]=$i.time;}}),$S(0,$F,"alphaKeys",function(){return this._alphaKeys;},function($R){this._alphaKeys=$R;for(var $F=this.index=0;$F<$R.length;$F++){var $i=$R[$F];this._alphaKeyData[this.index++]=$i.alpha,this._alphaKeyData[this.index++]=$i.time;}});}(),function(){function $R($R,$F){this._alpha=NaN,this._time=NaN,void 0===$R&&($R=0),void 0===$F&&($F=0),this._alpha=$R,this._time=$F;}$h($R,"laya.d3.core.trail.module.GradientAlphaKey");var $F=$R.prototype;return $F.cloneTo=function($R){$R.alpha=this.alpha,$R.time=this.time;},$S(0,$F,"alpha",function(){return this._alpha;},function($R){this._alpha=$R;}),$S(0,$F,"time",function(){return this._time;},function($R){this._time=$R;}),$R;}()),$I=function(){function $R($R,$F){this._color=null,this._time=NaN,void 0===$F&&($F=0),this._color=$R||new $P(),this._time=$F;}$h($R,"laya.d3.core.trail.module.GradientColorKey");var $F=$R.prototype;return $F.cloneTo=function($R){this.color.cloneTo($R.color),$R.time=this.time;},$S(0,$F,"color",function(){return this._color;},function($R){this._color=$R;}),$S(0,$F,"time",function(){return this._time;},function($R){this._time=$R;}),$R;}(),$D=(function(){function $R(){}$h($R,"laya.d3.core.trail.module.GradientMode"),$R.Blend=0,$R.Fixed=1;}(),function(){function $R(){}$h($R,"laya.d3.core.trail.module.TextureMode"),$R.Stretch=0,$R.Tile=1;}(),function(){function $R(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN;}$h($R,"laya.d3.core.trail.module.TrailKeyFrame"),$R.prototype.cloneTo=function($R){$R.time=this.time,$R.inTangent=this.inTangent,$R.outTangent=this.outTangent,$R.value=this.value;};}(),function(){function $F($R){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new $$F(),this._curPosition=new $$F(),this._delVector3=new $$F(),this._lastFixedVertexPosition=new $$F(),this._pointAtoBVector3=new $$F(),this._pointA=new $$F(),this._pointB=new $$F(),this._owner=$R,this._id=$F.renderElementCount++,0==this._id?$R._owner.transform.position.cloneTo(this._lastPosition):$R._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new $bF($D.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new $bF($D.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2);}$h($F,"laya.d3.core.trail.TrailRenderElement");var $R=$F.prototype;$w.imps($R,{"laya.d3.core.render.IRenderable":!0}),$R._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1);},$R._addTrailByFirstPosition=function($R,$F){$$F.subtract($F,$R,this._delVector3),$$F.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$$F.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$$F.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition($R),$R.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0;},$R._addTrailByNextPosition=function($R){$$F.subtract($R,this._lastFixedVertexPosition,this._delVector3),$$F.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$$F.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$$F.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=$$F.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=$IR.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition($R),$R.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition($R),this._virtualVerticesCount=2);},$R._updateVerticesByPosition=function($R){this._pointe=$R.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0;},$R._updateVertexBuffer2=function(){var $R,$F=0,$i=0,$j=0;for($j=0,$R=(this._verticesCount+this._virtualVerticesCount)/2;$j<$R;$j++)$i=0==this._owner.textureMode?(this._VerticesToTailLength[$j]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[$j],this._vertices2[$F++]=1-$i,this._vertices2[$F++]=1-$i;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount);},$R._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0;},$R._updateDisappear=function(){var $R,$F=0;for($F=this._curDisappearIndex,$R=(this._verticesCount+this._virtualVerticesCount)/2;$F<$R;$F++)this._owner._curtime-this._everyGroupVertexBirthTime[$F]>=this._owner.time+$IR.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0));},$R._beforeRender=function($R){return this._camera=$R.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),$$F.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0));},$R._render=function($R){this._isDead||($L.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),$_.drawCall++,$_.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2);},$R._getVertexBuffer=function($R){return void 0===$R&&($R=0),0===$R?this._vertexBuffer1:1===$R?this._vertexBuffer2:null;},$R._getVertexBuffers=function(){return this._vertexBuffers;},$R._getIndexBuffer=function(){return null;},$R.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition);},$R._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null;},$S(0,$R,"_vertexBufferCount",function(){return this._vertexBuffers.length;}),$S(0,$R,"triangleCount",function(){return 0;}),$F.renderElementCount=0;}(),function(){function $R(){}$h($R,"laya.d3.core.trail.VertexTrail");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration1;}),$S(1,$R,"vertexDeclaration1",function(){return $R._vertexDeclaration1;}),$S(1,$R,"vertexDeclaration2",function(){return $R._vertexDeclaration2;}),$s($R,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new $pR(32,[new $$R(0,"vector3",0),new $$R(12,"vector3",41),new $$R(24,"single",33),new $$R(28,"single",40)]);},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new $pR(4,[new $$R(0,"single",38)]);}]),$R;}()),$RR=function(){function $d($R){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=$R;}$h($d,"laya.d3.graphics.DynamicBatch");var $R=$d.prototype;return $w.imps($R,{"laya.d3.core.render.IRenderable":!0}),$R._getVertexBuffer=function($R){return void 0===$R&&($R=0),0===$R?this._vertexBuffer:null;},$R._getIndexBuffer=function(){return this._indexBuffer;},$R._getCombineRenderElementFromPool=function($R,$F,$i){var $j=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return $j||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=$j=new $n(),$j._sprite3D=new $CF()),$j._sprite3D._render._renderUpdate($i),$j;},$R._getRenderElement=function($R,$F,$i){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*$d.maxVertexCount),this._indexDatas=new Uint16Array($d.maxIndexCount),this._vertexBuffer=$bF.create(this._vertexDeclaration,$d.maxVertexCount,35048),this._indexBuffer=$QF.create("ushort",$d.maxIndexCount,35048));for(var $j=this._merageElements.length=0,$t=0,$p=0,$$=this._combineRenderElements.length;$p<$$;$p++){var $V=this._combineRenderElements[$p],$N=$V.getDynamicBatchBakedVertexs(0),$c=$V.getBakedIndices(),$q=$V._sprite3D.transform._isFrontFaceInvert,$s=$j/(this._vertexDeclaration.vertexStride/4),$k=$t,$h=$k+$c.length;$V._tempBatchIndexStart=$k,$V._tempBatchIndexEnd=$h,this._indexDatas.set($c,$t);var $S=0;if($q)for($S=$k;$S<$h;$S+=3){this._indexDatas[$S]=$s+this._indexDatas[$S];var $x=this._indexDatas[$S+1],$a=this._indexDatas[$S+2];this._indexDatas[$S+1]=$s+$a,this._indexDatas[$S+2]=$s+$x;}else for($S=$k;$S<$h;$S+=3)this._indexDatas[$S]=$s+this._indexDatas[$S],this._indexDatas[$S+1]=$s+this._indexDatas[$S+1],this._indexDatas[$S+2]=$s+this._indexDatas[$S+2];$t+=$c.length,this._vertexDatas.set($N,$j),$j+=$N.length;}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),$p=this._combineRenderElementPoolIndex=0,$$=this._materials.length;$p<$$;$p++){var $m=this._getCombineRenderElementFromPool($R,$F,$i);$m._type=2,$m._staticBatch=null;var $M=($m.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[$p]]._tempBatchIndexStart,$J=$p+1===this._materialToRenderElementsOffsets.length?$t:this._combineRenderElements[this._materialToRenderElementsOffsets[$p+1]]._tempBatchIndexStart;$m._tempBatchIndexStart=$M,$m._tempBatchIndexEnd=$J,$m._material=this._materials[$p],this._merageElements.push($m);}},$R._addCombineRenderObjTest=function($R){var $F=$R.renderObj,$i=this._currentCombineIndexCount+$F._getIndexBuffer().indexCount,$j=this._currentCombineVertexCount+$F._getVertexBuffer().vertexCount;return!($d.maxVertexCount<$j||$d.maxIndexCount<$i);},$R._addCombineRenderObj=function($R){var $F=$R.renderObj;this._combineRenderElements.push($R),this._currentCombineIndexCount=this._currentCombineIndexCount+$F._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$F._getVertexBuffer().vertexCount;},$R._addCombineMaterial=function($R){this._materials.push($R);},$R._addMaterialToRenderElementOffset=function($R){this._materialToRenderElementsOffsets.push($R);},$R._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0;},$R._addToRenderQueue=function($R,$F,$i,$j){this._getRenderElement($F,$i,$j);for(var $t=0,$p=this._materials.length;$t<$p;$t++)$R.getRenderQueue(this._materials[$t].renderQueue)._addDynamicBatchElement(this._merageElements[$t]);},$R._beforeRender=function($R){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0;},$R._render=function($R){var $F=$R._batchIndexEnd-$R._batchIndexStart;$L.mainContext.drawElements(4,$F,5123,2*$R._batchIndexStart),$_.drawCall++,$_.trianglesFaces+=$F/3;},$R._getVertexBuffers=function(){return null;},$S(0,$R,"_vertexBufferCount",function(){return 1;}),$S(0,$R,"triangleCount",function(){return this._indexBuffer.indexCount/3;}),$S(0,$R,"combineRenderElementsCount",function(){return this._combineRenderElements.length;}),$d.maxVertexCount=2e4,$d.maxIndexCount=4e4,$d.maxCombineTriangleCount=10,$d;}(),$FR=function(){function $d(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[];}$h($d,"laya.d3.graphics.DynamicBatchManager");var $R=$d.prototype;return $R.getDynamicBatch=function($R,$F){var $i,$j=$R.id.toString()+$F;return this._dynamicBatches[$j]?$i=this._dynamicBatches[$j]:this._dynamicBatches[$j]=$i=new $RR($R),$i;},$R._garbageCollection=function(){for(var $R in this._dynamicBatches)0===this._dynamicBatches[$R].combineRenderElementsCount&&delete this._dynamicBatches[$R];},$R._addPrepareRenderElement=function($R){this._prepareDynamicBatchCombineElements.push($R);},$R._finishCombineDynamicBatch=function($R){var $F,$i,$j;this._prepareDynamicBatchCombineElements.sort($d._sortPrepareDynamicBatch);for(var $t,$p,$$,$V,$N,$c=-1,$q=!0,$s=0,$k=-1,$h=0,$S=this._prepareDynamicBatchCombineElements.length;$h<$S;$h++){var $x=($p=this._prepareDynamicBatchCombineElements[$h]).renderObj._getVertexBuffer(0).vertexDeclaration,$a=$i!==$x;$a&&($s=0,$i=$x);var $m=$s!==$c;if($m&&($c=$s),($a||$m)&&($$=this.getDynamicBatch($x,$s),$F=null),$q){if($$._addCombineRenderObjTest($p)){if($F!==($t=$p._material))$V&&($R.getRenderQueue($N._material.renderQueue)._addRenderElement($N),$N=$V=null,$k=-1),$V=$t,$k=$$.combineRenderElementsCount,$N=$p,$F=$t;else if($V){var $M=$N.renderObj,$J=$p.renderObj;$M._getVertexBuffer().vertexCount+$J._getVertexBuffer().vertexCount>$RR.maxVertexCount||$M._getIndexBuffer().indexCount+$J._getIndexBuffer().indexCount>$RR.maxIndexCount?($R.getRenderQueue($N._material.renderQueue)._addRenderElement($N),$V=$t,$k=$$.combineRenderElementsCount,$N=$p):($$._addCombineMaterial($V),$$._addMaterialToRenderElementOffset($k),$$._addCombineRenderObj($N),$N=$V=null,$k=-1,$$._addCombineRenderObj($p));}else $$._addCombineRenderObj($p);$q=!0;}else $V&&($R.getRenderQueue($N._material.renderQueue)._addRenderElement($N),$N=$V=null,$k=-1),$s++,$q=!1;}else $j=this._prepareDynamicBatchCombineElements[$h-1],$$._addMaterialToRenderElementOffset($$.combineRenderElementsCount),$F=$j._material,$$._addCombineMaterial($F),$$._addCombineRenderObj($j),$q=!0,$F!==($t=$p._material)?($V=$t,$k=$$.combineRenderElementsCount,$N=$p):$$._addCombineRenderObj($p),$F=$t;}$V&&($R.getRenderQueue($N._material.renderQueue)._addRenderElement($N),$N=$V=null,$k=-1),this._prepareDynamicBatchCombineElements.length=0;},$R._clearRenderElements=function(){for(var $R in this._dynamicBatches)this._dynamicBatches[$R]._clearRenderElements();},$R._addToRenderQueue=function($R,$F,$i,$j){for(var $t in this._dynamicBatches){var $p=this._dynamicBatches[$t];0<$p.combineRenderElementsCount&&$p._addToRenderQueue($R,$F,$i,$j);}},$R.dispose=function(){this._dynamicBatches=null;},$d._sortPrepareDynamicBatch=function($R,$F){return $R._mainSortID-$F._mainSortID;},$d;}(),$iR=function(){function $R(){}return $h($R,"laya.d3.graphics.FrustumCulling"),$R.renderShadowObjectCulling=function($R,$F,$i,$j,$t){var $p=0,$$=0,$V=0,$N=0;for($p=0,$V=$i.length;$p<$V;$p++){var $c=$i[$p];$c&&$c._clearRenderElements();}var $q,$s,$k,$h=$R._cullingRenders;if(1<$t){for($p=0,$V=$R._cullingRendersLength;$p<$V;$p++)if(($q=$h[$p]).castShadow&&$Z.isVisible($q._owner.layer.mask)&&$q.enable)for(var $S=1,$x=$F.length;$S<$x;$S++)if($s=$i[$S-1],0!==$F[$S].containsBoundSphere($q.boundingSphere))for($$=0,$N=($k=$q._renderElements).length;$$<$N;$$++)$s._addRenderElement($k[$$]);}else for($p=0,$V=$R._cullingRendersLength;$p<$V;$p++)if(($q=$h[$p]).castShadow&&$Z.isVisible($q._owner.layer.mask)&&$q.enable&&0!==$F[0].containsBoundSphere($q.boundingSphere))for($q._renderUpdate($j),$s=$i[0],$$=0,$N=($k=$q._renderElements).length;$$<$N;$$++)$s._addRenderElement($k[$$]);},$R.renderShadowObjectCullingOctree=function($R,$F,$i,$j,$t){for(var $p=0,$$=$i.length;$p<$$;$p++){var $V=$i[$p];$V&&$V._clearRenderElements();}1<$t?$R.treeRoot.cullingShadowObjects($F,$i,!0,0,$R):$R.treeRoot.cullingShadowObjectsOnePSSM($F[0],$i,$j,!0,0,$R);},$R.renderObjectCulling=function($R,$F,$i,$j,$t,$p){var $$=0,$V=0,$N=0,$c=0,$q=$F._quenes,$s=$F._dynamicBatchManager,$k=$F._cullingRenders;for($$=0,$V=$q.length;$$<$V;$$++){var $h=$q[$$];$h&&$h._clearRenderElements();}var $S=$jR._staticBatchManagers;for($$=0,$V=$S.length;$$<$V;$$++)$S[$$]._clearRenderElements();$s._clearRenderElements();var $x=$i.transform.position;for($$=0,$V=$F._cullingRendersLength;$$<$V;$$++){var $a=$k[$$];if($Z.isVisible($a._owner.layer.mask)&&$a.enable&&0!==$R.containsBoundSphere($a.boundingSphere)&&$a._renderUpdate($p)){$a._distanceForSort=$$F.distance($a.boundingSphere.center,$x)+$a.sortingFudge;var $m=$a._renderElements;for($N=0,$c=$m.length;$N<$c;$N++){var $M=$m[$N],$J=$M._staticBatch;if($J&&$J._material===$M._material)$J._addBatchRenderElement($M);else{var $d=$M.renderObj;$d.triangleCount<10&&1===$d._vertexBufferCount&&$d._getIndexBuffer()&&$M._material.renderQueue<2&&$M._canDynamicBatch&&!$a._owner.isStatic?$s._addPrepareRenderElement($M):$F.getRenderQueue($M._material.renderQueue)._addRenderElement($M);}}}}for($$=0,$V=$S.length;$$<$V;$$++)$S[$$]._addToRenderQueue($F,$j,$t,$p);$s._finishCombineDynamicBatch($F),$s._addToRenderQueue($F,$j,$t,$p);},$R.renderObjectCullingOctree=function($R,$F,$i,$j,$t,$p){var $$=0,$V=0,$N=$F._quenes,$c=$F._dynamicBatchManager;for($$=0,$V=$N.length;$$<$V;$$++){var $q=$N[$$];$q&&$q._clearRenderElements();}var $s=$jR._staticBatchManagers;for($$=0,$V=$s.length;$$<$V;$$++)$s[$$]._clearRenderElements();for($c._clearRenderElements(),$F._cullingRenders.length=0,$F.treeRoot.cullingObjects($R,!0,0,$i.transform.position,$p),$$=0,$V=$s.length;$$<$V;$$++)$s[$$]._addToRenderQueue($F,$j,$t,$p);$c._finishCombineDynamicBatch($F),$c._addToRenderQueue($F,$j,$t,$p);},$R.renderObjectCullingNoBoundFrustum=function($R,$F,$i,$j,$t){var $p=0,$$=0,$V=0,$N=0,$c=$R._quenes,$q=$R._dynamicBatchManager,$s=$R._cullingRenders;for($p=0,$$=$c.length;$p<$$;$p++){var $k=$c[$p];$k&&$k._clearRenderElements();}var $h=$jR._staticBatchManagers;for($p=0,$$=$h.length;$p<$$;$p++)$h[$p]._clearRenderElements();$q._clearRenderElements();var $S=$F.transform.position;for($p=0,$$=$R._cullingRendersLength;$p<$$;$p++){var $x=$s[$p];if($Z.isVisible($x._owner.layer.mask)&&$x.enable){$x._renderUpdate($t),$x._distanceForSort=$$F.distance($x.boundingSphere.center,$S)+$x.sortingFudge;var $a=$x._renderElements;for($V=0,$N=$a.length;$V<$N;$V++){var $m=$a[$V],$M=$m._staticBatch;if($M&&$M._material===$m._material)$M._addBatchRenderElement($m);else{var $J=$m.renderObj;$J.triangleCount<10&&1===$J._vertexBufferCount&&$J._getIndexBuffer()&&$m._material.renderQueue<2&&$m._canDynamicBatch&&!$x._owner.isStatic?$q._addPrepareRenderElement($m):$R.getRenderQueue($m._material.renderQueue)._addRenderElement($m);}}}}for($p=0,$$=$h.length;$p<$$;$p++)$h[$p]._addToRenderQueue($R,$i,$j,$t);$q._finishCombineDynamicBatch($R),$q._addToRenderQueue($R,$i,$j,$t);},$R;}(),$jR=function(){function $p(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={};}$h($p,"laya.d3.graphics.StaticBatchManager");var $R=$p.prototype;return $R._finishInit=function(){for(var $R in this._staticBatches)this._staticBatches[$R]._finishInit();this._initBatchRenderElements.length=0;},$R._initStaticBatchs=function($R){throw new Error("StaticBatchManager:must override this function.");},$R._addInitBatchSprite=function($R){for(var $F=$R._render._renderElements,$i=0,$j=$F.length;$i<$j;$i++)this._initBatchRenderElements.push($F[$i]);},$R._clearRenderElements=function(){for(var $R in this._staticBatches)this._staticBatches[$R]._clearRenderElements();},$R._garbageCollection=function($R){var $F=$R._staticBatch,$i=$F._initBatchRenderElements,$j=$i.indexOf($R);$i.splice($j,1),0===$i.length&&($F.dispose(),delete this._staticBatches[$F._key]);},$R._addToRenderQueue=function($R,$F,$i,$j){for(var $t in this._staticBatches){var $p=this._staticBatches[$t];0<$p._batchRenderElements.length&&$p._updateToRenderQueue($R,$j);}},$R.dispose=function(){this._staticBatches=null;},$p._addToStaticBatchQueue=function($R){$R instanceof laya.d3.core.RenderableSprite3D&&$R._addToInitStaticBatchManager();for(var $F=0,$i=$R.numChildren;$F<$i;$F++)$p._addToStaticBatchQueue($R._childs[$F]);},$p.combine=function($R,$F){var $i,$j=0,$t=0;if($F)for($j=0,$t=$F.length;$j<$t;$j++){$F[$j]._addToInitStaticBatchManager();}else $R&&$p._addToStaticBatchQueue($R);for($j=0,$t=$p._staticBatchManagers.length;$j<$t;$j++)($i=$p._staticBatchManagers[$j])._initStaticBatchs($R),$i._finishInit();},$p._staticBatchManagers=[],$p;}(),$tR=function(){function $R($R,$F,$i){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=$R,this._manager=$F,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=$i;}$h($R,"laya.d3.graphics.StaticBatch");var $F=$R.prototype;return $w.imps($F,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$F._binarySearch=function($R){for(var $F=0,$i=this._batchRenderElements.length-1,$j=0;$F<=$i;)$j=Math.floor(($F+$i)/2),this._compareBatchRenderElement(this._batchRenderElements[$j],$R)?$i=$j-1:$F=$j+1;return $F;},$F._compareBatchRenderElement=function($R,$F){throw new Error("StaticBatch:must override this function.");},$F._getVertexDecLightMap=function($R){return $R===$QR.vertexDeclaration?$ZR.vertexDeclaration:$R===$eR.vertexDeclaration?$fR.vertexDeclaration:$R===$TR.vertexDeclaration?$dR.vertexDeclaration:$R===$yR.vertexDeclaration?null:$R===$xR.vertexDeclaration?$aR.vertexDeclaration:$R===$GR.vertexDeclaration?$vR.vertexDeclaration:$R===$LR.vertexDeclaration?$YR.vertexDeclaration:$R===$bR.vertexDeclaration?$uR.vertexDeclaration:$R===$eR.vertexDeclaration?$fR.vertexDeclaration:$R===$gR.vertexDeclaration?$wR.vertexDeclaration:$R===$yR.vertexDeclaration?null:$R===$xR.vertexDeclaration?$aR.vertexDeclaration:$R===$OR.vertexDeclaration?$KR.vertexDeclaration:$R===$LR.vertexDeclaration?$YR.vertexDeclaration:$R;},$F._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.");},$F._addBatchRenderElement=function($R){this._batchRenderElements.splice(this._binarySearch($R),0,$R);},$F._updateToRenderQueue=function($R,$F){this._combineRenderElementPoolIndex=0,this._getRenderElement($R.getRenderQueue(this._material.renderQueue)._renderElements,$R,$F);},$F._getRenderElement=function($R,$F,$i){throw new Error("StaticBatch:must override this function.");},$F._finishInit=function(){throw new Error("StaticBatch:must override this function.");},$F._clearRenderElements=function(){this._batchRenderElements.length=0;},$F.dispose=function(){},$F._getVertexBuffer=function($R){return void 0===$R&&($R=0),null;},$F._getIndexBuffer=function(){return null;},$F._beforeRender=function($R){return!0;},$F._render=function($R){},$F._getVertexBuffers=function(){return null;},$S(0,$F,"_vertexBufferCount",function(){return 1;}),$S(0,$F,"triangleCount",function(){return 0;}),$R.combine=function($R){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),$jR.combine($R);},$R.maxBatchVertexCount=65535,$R;}(),$pR=function(){function $$($R,$F){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++$$._uniqueIDCounter,this._id>$$.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",$$.maxVertexDeclaration);this._shaderValues=new $kF(),this._vertexElementsDic={},this._vertexStride=$R,this._vertexElements=$F;for(var $i=0;$i<$F.length;$i++){var $j=$F[$i],$t=$j.elementUsage;this._vertexElementsDic[$t]=$j;var $p=[$$._getTypeSize($j.elementFormat)/4,5126,!1,this._vertexStride,$j.offset];switch(this._shaderValues.setValue($t,$p),$t){case 1:this._addShaderDefine($_F.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine($_F.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine($_F.SHADERDEFINE_UV1);}}}$h($$,"laya.d3.graphics.VertexDeclaration");var $R=$$.prototype;return $R._addShaderDefine=function($R){this._shaderDefineValue|=$R;},$R._removeShaderDefine=function($R){this._shaderDefineValue&=~$R;},$R.getVertexElements=function(){return this._vertexElements.slice();},$R.getVertexElementByUsage=function($R){return this._vertexElementsDic[$R];},$R.unBinding=function(){},$S(0,$R,"shaderDefineValue",function(){return this._shaderDefineValue;}),$S(0,$R,"id",function(){return this._id;}),$S(0,$R,"vertexStride",function(){return this._vertexStride;}),$S(0,$R,"shaderValues",function(){return this._shaderValues;}),$$._getTypeSize=function($R){switch($R){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8;}return 0;},$$.getVertexStride=function($R){for(var $F=0,$i=0;$i<$R.Length;$i++){var $j=$R[$i],$t=$j.offset+$$._getTypeSize($j.elementFormat);$F<$t&&($F=$t);}return $F;},$$._maxVertexDeclarationBit=1e3,$$._uniqueIDCounter=1,$s($$,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647);}]),$$;}(),$$R=function(){function $R($R,$F,$i){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=$R,this.elementFormat=$F,this.elementUsage=$i;}return $h($R,"laya.d3.graphics.VertexElement"),$R;}(),$VR=(function(){function $R(){}$h($R,"laya.d3.graphics.VertexElementFormat"),$R.Single="single",$R.Vector2="vector2",$R.Vector3="vector3",$R.Vector4="vector4",$R.Color="color",$R.Byte4="byte4",$R.Short2="short2",$R.Short4="short4",$R.NormalizedShort2="normalizedshort2",$R.NormalizedShort4="normalizedshort4",$R.HalfVector2="halfvector2",$R.HalfVector4="halfvector4";}(),function(){function $R(){}$h($R,"laya.d3.graphics.VertexElementUsage"),$R.POSITION0=0,$R.COLOR0=1,$R.TEXTURECOORDINATE0=2,$R.NORMAL0=3,$R.BINORMAL0=4,$R.TANGENT0=5,$R.BLENDINDICES0=6,$R.BLENDWEIGHT0=7,$R.DEPTH0=8,$R.FOG0=9,$R.POINTSIZE0=10,$R.SAMPLE0=11,$R.TESSELLATEFACTOR0=12,$R.COLOR1=13,$R.NEXTTEXTURECOORDINATE0=14,$R.TEXTURECOORDINATE1=15,$R.NEXTTEXTURECOORDINATE1=16,$R.CORNERTEXTURECOORDINATE0=17,$R.VELOCITY0=18,$R.STARTCOLOR0=19,$R.STARTSIZE=20,$R.AGEADDSCALE0=21,$R.STARTROTATION=22,$R.ENDCOLOR0=23,$R.STARTLIFETIME=24,$R.TIME0=33,$R.SHAPEPOSITIONSTARTLIFETIME=30,$R.DIRECTIONTIME=32,$R.SIZEROTATION0=27,$R.RADIUS0=28,$R.RADIAN0=29,$R.STARTSPEED=31,$R.RANDOM0=34,$R.RANDOM1=35,$R.SIMULATIONWORLDPOSTION=36,$R.SIMULATIONWORLDROTATION=37,$R.TEXTURECOORDINATE0X=38,$R.TEXTURECOORDINATE0X1=39,$R.TEXTURECOORDINATE0Y=40,$R.OFFSETVECTOR=41;}(),function(){function $R($R,$F,$i){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=$R,this._textureCoordinate0=$F,this._time=$i;}$h($R,"laya.d3.graphics.VertexGlitter");var $F=$R.prototype;$w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate0;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"time",function(){return this._time;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(24,[new $$R(0,"vector3",0),new $$R(12,"vector2",2),new $$R(20,"single",33)]);}]);}(),function(){function $R($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=$R,this._position=$F,this._velocity=$i,this._startColor=$j,this._endColor=$t,this._sizeRotation=$p,this._radius=$$,this._radian=$V,this._ageAddScale=$N,this._time=$c;}$h($R,"laya.d3.graphics.VertexParticle");var $F=$R.prototype;$w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"endColor",function(){return this._endColor;}),$S(0,$F,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate;}),$S(0,$F,"sizeRotation",function(){return this._sizeRotation;}),$S(0,$F,"velocity",function(){return this._velocity;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"startColor",function(){return this._startColor;}),$S(0,$F,"radius",function(){return this._radius;}),$S(0,$F,"radian",function(){return this._radian;}),$S(0,$F,"ageAddScale",function(){return this._ageAddScale;}),$S(0,$F,"time",function(){return this._time;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(116,[new $$R(0,"vector4",17),new $$R(16,"vector3",0),new $$R(28,"vector3",18),new $$R(40,"vector4",19),new $$R(56,"vector4",23),new $$R(72,"vector3",27),new $$R(84,"vector2",28),new $$R(92,"vector4",29),new $$R(108,"single",24),new $$R(112,"single",33)]);}]);}(),function(){function $R($R){this._position=null,this._position=$R;}$h($R,"laya.d3.graphics.VertexPosition");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(12,[new $$R(0,"vector3",0)]);}]),$R;}()),$NR=function(){function $R($R,$F){this._position=null,this._normal=null,this._position=$R,this._normal=$F;}$h($R,"laya.d3.graphics.VertexPositionNormal");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(24,[new $$R(0,"vector3",0),new $$R(12,"vector3",3)]);}]),$R;}(),$cR=function(){function $R($R,$F,$i){this._position=null,this._normal=null,this._color=null,this._position=$R,this._normal=$F,this._color=$i;}$h($R,"laya.d3.graphics.VertexPositionNormalColor");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(40,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1)]);}]),$R;}(),$qR=function(){function $R($R,$F,$i,$j,$t){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=$R,this._normal=$F,this._color=$i,this._blendIndex=$j,this._blendWeight=$t;}$h($R,"laya.d3.graphics.VertexPositionNormalColorSkin");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(72,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector4",7),new $$R(56,"vector4",6)]);}]),$R;}(),$sR=function(){function $R($R,$F,$i,$j,$t,$p){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$R,this._normal=$F,this._color=$i,this._tangent=$j,this._blendIndex=$t,this._blendWeight=$p;}$h($R,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(88,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector4",7),new $$R(56,"vector4",6),new $$R(72,"vector4",5)]);}]),$R;}(),$kR=function(){function $R($R,$F,$i,$j,$t,$p){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$R,this._normal=$F,this._color=$i,this._tangent=$j,this._blendIndex=$t,this._blendWeight=$p;}$h($R,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(84,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector4",7),new $$R(56,"vector4",6),new $$R(72,"vector3",5)]);}]),$R;}(),$hR=function(){function $R($R,$F,$i,$j){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$R,this._normal=$F,this._color=$i,this._tangent=$j;}$h($R,"laya.d3.graphics.VertexPositionNormalColorSTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(56,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector4",5)]);}]),$R;}(),$SR=function(){function $R($R,$F,$i,$j){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$R,this._normal=$F,this._color=$i,this._tangent=$j;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(52,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector3",5)]);}]),$R;}(),$xR=function(){function $R($R,$F,$i,$j){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=$R,this._normal=$F,this._color=$i,this._textureCoordinate=$j;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTexture");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(48,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector2",2)]);}]),$R;}(),$aR=function(){function $R($R,$F,$i,$j,$t){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$R,this._normal=$F,this._color=$i,this._textureCoordinate0=$j,this._textureCoordinate1=$t;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(56,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector2",2),new $$R(48,"vector2",15)]);}]),$R;}(),$mR=function(){function $R($R,$F,$i,$j,$t,$p,$$){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$R,this._normal=$F,this._color=$i,this._textureCoordinate0=$j,this._textureCoordinate1=$t,this._blendIndex=$p,this._blendWeight=$$;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(88,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector2",2),new $$R(48,"vector2",15),new $$R(56,"vector4",7),new $$R(72,"vector4",6)]);}]),$R;}(),$MR=function(){function $R($R,$F,$i,$j,$t,$p,$$,$V){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$R,this._normal=$F,this._color=$i,this._textureCoordinate0=$j,this._textureCoordinate1=$t,this._tangent=$p,this._blendIndex=$$,this._blendWeight=$V;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(104,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector2",2),new $$R(48,"vector2",15),new $$R(56,"vector4",7),new $$R(72,"vector4",6),new $$R(88,"vector4",5)]);}]),$R;}(),$JR=function(){function $R(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$F.VertexPositionNormalColorTexture0SkinTangent=function($R,$F,$i,$j,$t,$p,$$,$V){this._position=$R,this._normal=$F,this._color=$i,this._textureCoordinate0=$j,this._textureCoordinate1=$t,this._tangent=$p,this._blendIndex=$$,this._blendWeight=$V;},$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(100,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector2",2),new $$R(48,"vector2",15),new $$R(56,"vector4",7),new $$R(72,"vector4",6),new $$R(88,"vector3",5)]);}]),$R;}(),$dR=function(){function $R($R,$F,$i,$j,$t,$p){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$R,this._normal=$F,this._color=$i,this._textureCoordinate0=$j,this._textureCoordinate1=$t,this._tangent=$p;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(72,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector2",2),new $$R(48,"vector2",15),new $$R(56,"vector4",5)]);}]),$R;}(),$wR=function(){function $R(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$F.VertexPositionNormalColorTexture0Tangent=function($R,$F,$i,$j,$t,$p){this._position=$R,this._normal=$F,this._color=$i,this._textureCoordinate0=$j,this._textureCoordinate1=$t,this._tangent=$p;},$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(68,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector2",2),new $$R(48,"vector2",15),new $$R(56,"vector3",5)]);}]),$R;}(),$XR=function(){function $R($R,$F,$i,$j,$t,$p){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$R,this._normal=$F,this._color=$i,this._textureCoordinate=$j,this._blendIndex=$t,this._blendWeight=$p;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(80,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector2",2),new $$R(48,"vector4",7),new $$R(64,"vector4",6)]);}]),$R;}(),$HR=function(){function $R($R,$F,$i,$j,$t,$p,$$){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$R,this._normal=$F,this._color=$i,this._textureCoordinate=$j,this._tangent=$t,this._blendIndex=$p,this._blendWeight=$$;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(96,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector2",2),new $$R(48,"vector4",7),new $$R(64,"vector4",6),new $$R(80,"vector4",5)]);}]),$R;}(),$_R=function(){function $R($R,$F,$i,$j,$t,$p,$$){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$R,this._normal=$F,this._color=$i,this._textureCoordinate=$j,this._tangent=$t,this._blendIndex=$p,this._blendWeight=$$;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(92,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector2",2),new $$R(48,"vector4",7),new $$R(64,"vector4",6),new $$R(80,"vector3",5)]);}]),$R;}(),$TR=function(){function $R($R,$F,$i,$j,$t){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$R,this._normal=$F,this._color=$i,this._textureCoordinate=$j,this._tangent=$t;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(64,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector2",2),new $$R(48,"vector4",5)]);}]),$R;}(),$gR=function(){function $R($R,$F,$i,$j,$t){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$R,this._normal=$F,this._color=$i,this._textureCoordinate=$j,this._tangent=$t;}$h($R,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"color",function(){return this._color;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(60,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",1),new $$R(40,"vector2",2),new $$R(48,"vector3",5)]);}]),$R;}(),$BR=function(){function $R($R,$F,$i){this._position=null,this._normal=null,this._tangent=null,this._position=$R,this._normal=$F,this._tangent=$i;}$h($R,"laya.d3.graphics.VertexPositionNormalSTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(40,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector4",5)]);}]),$R;}(),$zR=function(){function $R($R,$F,$i){this._position=null,this._normal=null,this._tangent=null,this._position=$R,this._normal=$F,this._tangent=$i;}$h($R,"laya.d3.graphics.VertexPositionNormalTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(36,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector3",5)]);}]),$R;}(),$LR=function(){function $R($R,$F,$i){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$R,this._normal=$F,this._textureCoordinate=$i;}$h($R,"laya.d3.graphics.VertexPositionNormalTexture");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(32,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2)]);}]),$R;}(),$YR=function(){function $R($R,$F,$i,$j){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$R,this._normal=$F,this._textureCoordinate0=$i,this._textureCoordinate1=$j;}$h($R,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(40,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2),new $$R(32,"vector2",15)]);}]),$R;}(),$fR=function(){function $R($R,$F,$i,$j,$t,$p){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$R,this._normal=$F,this._textureCoordinate0=$i,this._textureCoordinate1=$j,this._blendIndex=$t,this._blendWeight=$p;}$h($R,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(72,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2),new $$R(32,"vector2",15),new $$R(40,"vector4",7),new $$R(56,"vector4",6)]);}]),$R;}(),$ZR=function(){function $R($R,$F,$i,$j,$t,$p,$$){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$R,this._normal=$F,this._textureCoordinate0=$i,this._textureCoordinate1=$j,this._tangent=$t,this._blendIndex=$p,this._blendWeight=$$;}$h($R,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(88,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2),new $$R(32,"vector2",15),new $$R(40,"vector4",7),new $$R(56,"vector4",6),new $$R(72,"vector4",5)]);}]),$R;}(),$uR=function(){function $R(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null;}$h($R,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$F.VertexPositionNormalTexture0SkinTangent=function($R,$F,$i,$j,$t,$p,$$){this._position=$R,this._normal=$F,this._textureCoordinate0=$i,this._textureCoordinate1=$j,this._tangent=$t,this._blendIndex=$p,this._blendWeight=$$;},$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(84,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2),new $$R(32,"vector2",15),new $$R(40,"vector4",7),new $$R(56,"vector4",6),new $$R(72,"vector3",5)]);}]),$R;}(),$vR=function(){function $R($R,$F,$i,$j,$t){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$R,this._normal=$F,this._textureCoordinate0=$i,this._textureCoordinate1=$j,this._tangent=$t;}$h($R,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(56,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2),new $$R(32,"vector2",15),new $$R(40,"vector4",5)]);}]),$R;}(),$KR=function(){function $R(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null;}$h($R,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$F.VertexPositionNormalTexture0Tangent=function($R,$F,$i,$j,$t){this._position=$R,this._normal=$F,this._textureCoordinate0=$i,this._textureCoordinate1=$j,this._tangent=$t;},$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(52,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2),new $$R(32,"vector2",15),new $$R(40,"vector3",5)]);}]),$R;}(),$eR=function(){function $R($R,$F,$i,$j,$t){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$R,this._normal=$F,this._textureCoordinate=$i,this._blendIndex=$j,this._blendWeight=$t;}$h($R,"laya.d3.graphics.VertexPositionNormalTextureSkin");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(64,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2),new $$R(32,"vector4",7),new $$R(48,"vector4",6)]);}]),$R;}(),$QR=function(){function $R($R,$F,$i,$j,$t,$p){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$R,this._normal=$F,this._textureCoordinate=$i,this._tangent=$j,this._blendIndex=$t,this._blendWeight=$p;}$h($R,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(80,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2),new $$R(32,"vector4",7),new $$R(48,"vector4",6),new $$R(64,"vector4",5)]);}]),$R;}(),$bR=function(){function $R($R,$F,$i,$j,$t,$p){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$R,this._normal=$F,this._textureCoordinate=$i,this._tangent=$j,this._blendIndex=$t,this._blendWeight=$p;}$h($R,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(76,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2),new $$R(32,"vector4",7),new $$R(48,"vector4",6),new $$R(64,"vector3",5)]);}]),$R;}(),$GR=function(){function $R($R,$F,$i,$j){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$R,this._normal=$F,this._textureCoordinate=$i,this._tangent=$j;}$h($R,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(48,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2),new $$R(32,"vector4",5)]);}]),$R;}(),$OR=function(){function $R($R,$F,$i,$j){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$R,this._normal=$F,this._textureCoordinate=$i,this._tangent=$j;}$h($R,"laya.d3.graphics.VertexPositionNormalTextureTangent");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(44,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2),new $$R(32,"vector3",5)]);}]),$R;}(),$yR=function(){function $R($R,$F,$i){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$R,this._normal=$F,this._textureCoordinate=$i;}$h($R,"laya.d3.graphics.VertexPositionNTBTexture");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(56,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector3",5),new $$R(36,"vector3",4),new $$R(48,"vector2",2)]);}]),$R;}(),$ER=function(){function $R($R,$F,$i,$j,$t,$p,$$,$V){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=$R,this._normal=$F,this._textureCoordinate0=$j,this._textureCoordinate1=$t,this._tangent=$p,$i=$i,this._blendIndex=$$,this._blendWeight=$V;}$h($R,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"tangent",function(){return this._tangent;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(0,$F,"textureCoordinate1",function(){return this._textureCoordinate1;}),$S(0,$F,"blendIndex",function(){return this._blendIndex;}),$S(0,$F,"blendWeight",function(){return this._blendWeight;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(96,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector3",5),new $$R(36,"vector3",4),new $$R(48,"vector2",2),new $$R(56,"vector2",15),new $$R(64,"vector4",7),new $$R(80,"vector4",6)]);}]),$R;}(),$lR=function(){function $R($R,$F,$i){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$R,this._normal=$F,this._textureCoordinate=$i;}$h($R,"laya.d3.graphics.VertexPositionNTBTextureSkin");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"textureCoordinate",function(){return this._textureCoordinate;}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(88,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector3",5),new $$R(36,"vector3",4),new $$R(48,"vector2",2),new $$R(56,"vector4",7),new $$R(72,"vector4",6)]);}]),$R;}(),$WR=(function(){function $R($R,$F,$i,$j){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=$R,this._normal=$F,this._textureCoord0=$i,this._textureCoord1=$j;}$h($R,"laya.d3.graphics.VertexPositionTerrain");var $F=$R.prototype;$w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"normal",function(){return this._normal;}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"textureCoord0",function(){return this._textureCoord0;}),$S(0,$F,"textureCoord1",function(){return this._textureCoord1;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(40,[new $$R(0,"vector3",0),new $$R(12,"vector3",3),new $$R(24,"vector2",2),new $$R(32,"vector2",15)]);}]);}(),function(){function $R($R,$F){this._position=null,this._textureCoordinate0=null,this._position=$R,this._textureCoordinate0=$F;}$h($R,"laya.d3.graphics.VertexPositionTexture0");var $F=$R.prototype;return $w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"position",function(){return this._position;}),$S(0,$F,"textureCoordinate0",function(){return this._textureCoordinate0;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(20,[new $$R(0,"vector3",0),new $$R(12,"vector2",2)]);}]),$R;}()),$oR=(function(){function $R($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$s,$k,$h){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$R,this._positionStartLifeTime=$F,this._velocity=$i,this._startColor=$j,this._startSize=$t,this._startRotation0=$p,this._startRotation1=$$,this._startRotation2=$V,this._startLifeTime=$N,this._time=$c,this._startSpeed=$q,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$h;}$h($R,"laya.d3.graphics.VertexShurikenParticleBillboard");var $F=$R.prototype;$w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate;}),$S(0,$F,"random1",function(){return this._randoms1;}),$S(0,$F,"startRotation2",function(){return this._startRotation2;}),$S(0,$F,"positionStartLifeTime",function(){return this._positionStartLifeTime;}),$S(0,$F,"velocity",function(){return this._velocity;}),$S(0,$F,"random0",function(){return this._randoms0;}),$S(0,$F,"startSize",function(){return this._startSize;}),$S(0,$F,"startColor",function(){return this._startColor;}),$S(0,$F,"startRotation0",function(){return this._startRotation0;}),$S(0,$F,"startRotation1",function(){return this._startRotation1;}),$S(0,$F,"startLifeTime",function(){return this._startLifeTime;}),$S(0,$F,"time",function(){return this._time;}),$S(0,$F,"startSpeed",function(){return this._startSpeed;}),$S(0,$F,"simulationWorldPostion",function(){return this._simulationWorldPostion;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(152,[new $$R(0,"vector4",17),new $$R(16,"vector4",30),new $$R(32,"vector4",32),new $$R(48,"vector4",19),new $$R(64,"vector3",20),new $$R(76,"vector3",22),new $$R(88,"single",31),new $$R(92,"vector4",34),new $$R(108,"vector4",35),new $$R(124,"vector3",36),new $$R(136,"vector4",37)]);}]);}(),function(){function $R($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$s,$k,$h){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$R,this._positionStartLifeTime=$F,this._velocity=$i,this._startColor=$j,this._startSize=$t,this._startRotation0=$p,this._startRotation1=$$,this._startRotation2=$V,this._startLifeTime=$N,this._time=$c,this._startSpeed=$q,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$h;}$h($R,"laya.d3.graphics.VertexShurikenParticleMesh");var $F=$R.prototype;$w.imps($F,{"laya.d3.graphics.IVertex":!0}),$S(0,$F,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate;}),$S(0,$F,"velocity",function(){return this._velocity;}),$S(0,$F,"position",function(){return this._positionStartLifeTime;}),$S(0,$F,"random0",function(){return this._randoms0;}),$S(0,$F,"startSize",function(){return this._startSize;}),$S(0,$F,"startColor",function(){return this._startColor;}),$S(0,$F,"startRotation0",function(){return this._startRotation0;}),$S(0,$F,"startRotation1",function(){return this._startRotation1;}),$S(0,$F,"random1",function(){return this._randoms1;}),$S(0,$F,"startRotation2",function(){return this._startRotation2;}),$S(0,$F,"startLifeTime",function(){return this._startLifeTime;}),$S(0,$F,"time",function(){return this._time;}),$S(0,$F,"startSpeed",function(){return this._startSpeed;}),$S(0,$F,"simulationWorldPostion",function(){return this._simulationWorldPostion;}),$S(0,$F,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$S(1,$R,"vertexDeclaration",function(){return $R._vertexDeclaration;}),$s($R,["_vertexDeclaration",function(){return this._vertexDeclaration=new $pR(172,[new $$R(0,"vector3",0),new $$R(12,"vector4",1),new $$R(28,"vector2",2),new $$R(36,"vector4",30),new $$R(52,"vector4",32),new $$R(68,"vector4",19),new $$R(84,"vector3",20),new $$R(96,"vector3",22),new $$R(108,"single",31),new $$R(112,"vector4",34),new $$R(128,"vector4",35),new $$R(144,"vector3",36),new $$R(156,"vector4",37)]);}]);}(),function(){function $J($R,$F,$i,$j,$t,$p){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=$i,this._materials=$j,this._subMeshes=$t,this._materialMap=$p,this._version=$F,this._onLoaded($R);}$h($J,"laya.d3.loaders.LoadModelV01");var $R=$J.prototype;return $R._onLoaded=function($R){this._readData=$R,this.READ_BLOCK();for(var $F=0;$F<this._BLOCK.count;$F++){var $i=this._readData.getUint16(),$j=this._strings[$i],$t=this["READ_"+$j];if(null==$t)throw new Error("model file err,no this function:"+$i+" "+$j);if(!$t.call(this))break;}return this._mesh;},$R.onError=function(){},$R._readString=function(){return this._strings[this._readData.getUint16()];},$R.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0;},$R.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0;},$R.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var $R=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var $F=0;$F<this._STRINGS.size;$F++)this._strings[$F]=this._readData.readUTFString();return this._readData.pos=$R,!0;},$R.READ_MATERIAL=function(){var $R=this._readData.getUint16(),$F=(this._readString(),this._readString());return this._materials[$R]="null"!==$F?$m.getRes(this._materialMap[$F]):new $zF(),!0;},$R.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var $R,$F=this._readData.__getBuffer(),$i=0,$j=this._readData.getUint32(),$t=this._readData.getUint32(),$p=(new Float32Array($F.slice($j+this._DATA.offset,$j+this._DATA.offset+$t)),this._readData.getUint32()),$$=this._readData.getUint32(),$V=new Float32Array($F.slice($p+this._DATA.offset,$p+this._DATA.offset+$$));for(this.mesh._inverseBindPoses=[],$i=0,$R=$V.length;$i<$R;$i+=16){var $N=new $RF($V[$i+0],$V[$i+1],$V[$i+2],$V[$i+3],$V[$i+4],$V[$i+5],$V[$i+6],$V[$i+7],$V[$i+8],$V[$i+9],$V[$i+10],$V[$i+11],$V[$i+12],$V[$i+13],$V[$i+14],$V[$i+15]);this.mesh._inverseBindPoses.push($N);}break;default:throw new Error("LoadModel:unknown version.");}return!0;},$R.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var $R=this._readString();this._shaderAttributes=$R.match($J._attrReg);var $F=this._readData.getUint32(),$i=this._readData.getUint32(),$j=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),$t=this._readData.getUint32(),$p=this._readData.getUint32(),$$=this._readData.getUint32(),$V=this._readData.__getBuffer(),$N=new $cF(this._mesh),$c=this._getVertexDeclaration(),$q=$bF.create($c,$t/$c.vertexStride,35044,!0),$s=$j+this._DATA.offset,$k=$V.slice($s,$s+$t);$q.setData(new Float32Array($k));for(var $h=($N._vertexBuffer=$q).vertexDeclaration.getVertexElements(),$S=0;$S<$h.length;$S++)$N._bufferUsage[$h[$S].elementUsage]=$q;var $x=$QF.create("ushort",$i/2,35044,!0),$a=$F+this._DATA.offset,$m=$V.slice($a,$a+$i);$x.setData(new Uint16Array($m)),$N._indexBuffer=$x;var $M=$V.slice($p+this._DATA.offset,$p+this._DATA.offset+$$);return $N._boneIndicesList[0]=new Uint8Array($M),this._subMeshes.push($N),!0;},$R.READ_DATAAREA=function(){return!1;},$R._getVertexDeclaration=function(){for(var $R,$F=!1,$i=!1,$j=!1,$t=!1,$p=!1,$$=!1,$V=!1,$N=!1,$c=!1,$q=0;$q<this._shaderAttributes.length;$q+=8)switch(this._shaderAttributes[$q]){case"POSITION":$F=!0;break;case"NORMAL":$i=!0;break;case"COLOR":$j=!0;break;case"UV":$t=!0;break;case"UV1":$p=!0;break;case"BLENDWEIGHT":$V=!0;break;case"BLENDINDICES":$N=!0;break;case"TANGENT":$$=!0;break;case"BINORMAL":$c=!0;}return $F&&$i&&$j&&$t&&$p&&$V&&$N&&$$?$R=$JR.vertexDeclaration:$F&&$i&&$j&&$t&&$p&&$V&&$N?$R=$mR.vertexDeclaration:$F&&$i&&$t&&$p&&$V&&$N&&$$?$R=$uR.vertexDeclaration:$F&&$i&&$t&&$p&&$V&&$N?$R=$fR.vertexDeclaration:$F&&$i&&$j&&$t&&$V&&$N&&$$?$R=$_R.vertexDeclaration:$F&&$i&&$j&&$t&&$V&&$N?$R=$XR.vertexDeclaration:$F&&$i&&$$&&$c&&$t&&$V&&$N?$R=$lR.vertexDeclaration:$F&&$i&&$t&&$V&&$N&&$$?$R=$bR.vertexDeclaration:$F&&$i&&$t&&$V&&$N?$R=$eR.vertexDeclaration:$F&&$i&&$j&&$V&&$N&&$$?$R=$kR.vertexDeclaration:$F&&$i&&$j&&$V&&$N?$R=$qR.vertexDeclaration:$F&&$i&&$j&&$t&&$p&&$$?$R=$wR.vertexDeclaration:$F&&$i&&$j&&$t&&$p?$R=$aR.vertexDeclaration:$F&&$i&&$t&&$p&&$$?$R=$KR.vertexDeclaration:$F&&$i&&$t&&$p?$R=$YR.vertexDeclaration:$F&&$i&&$j&&$t&&$$?$R=$gR.vertexDeclaration:$F&&$i&&$t&&$$&&$c?$R=$yR.vertexDeclaration:$F&&$i&&$j&&$t?$R=$xR.vertexDeclaration:$F&&$i&&$t&&$$?$R=$OR.vertexDeclaration:$F&&$i&&$t?$R=$LR.vertexDeclaration:$F&&$i&&$j&&$$?$R=$SR.vertexDeclaration:$F&&$i&&$j&&($R=$cR.vertexDeclaration),$R;},$S(0,$R,"mesh",function(){return this._mesh;}),$J._attrReg=new RegExp("(\\w+)|([:,;])","g"),$J;}()),$nR=function(){function $H(){}return $h($H,"laya.d3.loaders.LoadModelV02"),$H.parse=function($R,$F,$i,$j,$t,$p){$H._mesh=$i,$H._materials=$j,$H._subMeshes=$t,$H._materialMap=$p,$H._version=$F,$H._readData=$R,$H.READ_DATA(),$H.READ_BLOCK(),$H.READ_STRINGS();for(var $$=0,$V=$H._BLOCK.count;$$<$V;$$++){$H._readData.pos=$H._BLOCK.blockStarts[$$];var $N=$H._readData.getUint16(),$c=$H._strings[$N],$q=$H["READ_"+$c];if(null==$q)throw new Error("model file err,no this function:"+$N+" "+$c);$q.call();}$H._strings.length=0,$H._readData=null,$H._version=null,$H._mesh=null,$H._materials=null,$H._subMeshes=null,$H._materialMap=null;},$H._readString=function(){return $H._strings[$H._readData.getUint16()];},$H.READ_DATA=function(){$H._DATA.offset=$H._readData.getUint32(),$H._DATA.size=$H._readData.getUint32();},$H.READ_BLOCK=function(){for(var $R=$H._BLOCK.count=$H._readData.getUint16(),$F=$H._BLOCK.blockStarts=[],$i=$H._BLOCK.blockLengths=[],$j=0;$j<$R;$j++)$F.push($H._readData.getUint32()),$i.push($H._readData.getUint32());},$H.READ_STRINGS=function(){var $R=$H._readData.getUint32(),$F=$H._readData.getUint16(),$i=$H._readData.pos;$H._readData.pos=$R+$H._DATA.offset;for(var $j=0;$j<$F;$j++)$H._strings[$j]=$H._readData.readUTFString();$H._readData.pos=$i;},$H.READ_MATERIAL=function(){$H._readString(),$H._readString();var $R=$H._readString();return""!==$R&&$H._materials.push($m.getRes($H._materialMap[$R])),!0;},$H.READ_MESH=function(){$H._readString();var $R,$F=$H._readData.__getBuffer(),$i=0,$j=$H._readData.getInt16(),$t=$H._DATA.offset;for($i=0;$i<$j;$i++){var $p=$t+$H._readData.getUint32(),$$=$H._readData.getUint32(),$V=new Float32Array($F.slice($p,$p+$$)),$N=$H._readString().match($H._attrReg),$c=$H._getVertexDeclaration($N),$q=$bF.create($c,4*$V.length/$c.vertexStride,35044,!0);$q.setData($V),$H._mesh._vertexBuffers.push($q);}var $s=$t+$H._readData.getUint32(),$k=$H._readData.getUint32(),$h=new Uint16Array($F.slice($s,$s+$k)),$S=$QF.create("ushort",$k/2,35044,!0);$S.setData($h),$H._mesh._indexBuffer=$S;var $x=$H._mesh._boneNames=[],$a=$H._readData.getUint16();for($x.length=$a,$i=0;$i<$a;$i++)$x[$i]=$H._strings[$H._readData.getUint16()];var $m=$H._readData.getUint32(),$M=$H._readData.getUint32(),$J=(new Float32Array($F.slice($t+$m,$t+$m+$M)),$H._readData.getUint32()),$d=$H._readData.getUint32(),$w=new Float32Array($F.slice($t+$J,$t+$J+$d));for($H._mesh._inverseBindPoses=[],$i=0,$R=$w.length;$i<$R;$i+=16){var $X=new $RF($w[$i+0],$w[$i+1],$w[$i+2],$w[$i+3],$w[$i+4],$w[$i+5],$w[$i+6],$w[$i+7],$w[$i+8],$w[$i+9],$w[$i+10],$w[$i+11],$w[$i+12],$w[$i+13],$w[$i+14],$w[$i+15]);$H._mesh._inverseBindPoses.push($X);}return $H._mesh._skinnedDatas=new Float32Array(16*$w.length),!0;},$H.READ_SUBMESH=function(){var $R=$H._readData.__getBuffer(),$F=new $cF($H._mesh),$i=$H._readData.getInt16(),$j=$H._readData.getUint32(),$t=$H._readData.getUint32();$F._vertexBuffer=$H._mesh._vertexBuffers[$i],$F._vertexStart=$j,$F._vertexCount=$t;var $p=$H._readData.getUint32(),$$=$H._readData.getUint32(),$V=$H._mesh._indexBuffer;$F._indexBuffer=$V,$F._indexStart=$p,$F._indexCount=$$,$F._indices=new Uint16Array($V.getData().buffer,2*$p,$$);var $N=$H._DATA.offset,$c=$F._subIndexBufferStart,$q=$F._subIndexBufferCount,$s=$F._boneIndicesList,$k=$H._readData.getUint16();$c.length=$k,$q.length=$k,$s.length=$k;for(var $h=0;$h<$k;$h++){$c[$h]=$H._readData.getUint32(),$q[$h]=$H._readData.getUint32();var $S=$H._readData.getUint32(),$x=$H._readData.getUint32();$F._boneIndicesList[$h]=new Uint8Array($R.slice($N+$S,$N+$S+$x));}return $H._subMeshes.push($F),!0;},$H._getVertexDeclaration=function($R){for(var $F,$i=!1,$j=!1,$t=!1,$p=!1,$$=!1,$V=!1,$N=!1,$c=!1,$q=!1,$s=0;$s<$R.length;$s++)switch($R[$s]){case"POSITION":$i=!0;break;case"NORMAL":$j=!0;break;case"COLOR":$t=!0;break;case"UV":$p=!0;break;case"UV1":$$=!0;break;case"BLENDWEIGHT":$N=!0;break;case"BLENDINDICES":$c=!0;break;case"TANGENT":$V=!0;break;case"BINORMAL":$q=!0;}return $i&&$j&&$t&&$p&&$$&&$N&&$c&&$V?$F=$JR.vertexDeclaration:$i&&$j&&$t&&$p&&$$&&$N&&$c?$F=$mR.vertexDeclaration:$i&&$j&&$p&&$$&&$N&&$c&&$V?$F=$uR.vertexDeclaration:$i&&$j&&$p&&$$&&$N&&$c?$F=$fR.vertexDeclaration:$i&&$j&&$t&&$p&&$N&&$c&&$V?$F=$_R.vertexDeclaration:$i&&$j&&$t&&$p&&$N&&$c?$F=$XR.vertexDeclaration:$i&&$j&&$p&&$N&&$c&&$V?$F=$bR.vertexDeclaration:$i&&$j&&$p&&$N&&$c?$F=$eR.vertexDeclaration:$i&&$j&&$t&&$N&&$c&&$V?$F=$kR.vertexDeclaration:$i&&$j&&$t&&$N&&$c?$F=$qR.vertexDeclaration:$i&&$j&&$t&&$p&&$$&&$V?$F=$wR.vertexDeclaration:$i&&$j&&$t&&$p&&$$?$F=$aR.vertexDeclaration:$i&&$j&&$p&&$$&&$V?$F=$KR.vertexDeclaration:$i&&$j&&$p&&$$?$F=$YR.vertexDeclaration:$i&&$j&&$t&&$p&&$V?$F=$gR.vertexDeclaration:$i&&$j&&$p&&$V&&$q?$F=$yR.vertexDeclaration:$i&&$j&&$t&&$p?$F=$xR.vertexDeclaration:$i&&$j&&$p&&$V?$F=$OR.vertexDeclaration:$i&&$j&&$p?$F=$LR.vertexDeclaration:$i&&$j&&$t&&$V?$F=$SR.vertexDeclaration:$i&&$j&&$t&&($F=$cR.vertexDeclaration),$F;},$H._attrReg=new RegExp("(\\w+)|([:,;])","g"),$H._strings=[],$H._readData=null,$H._version=null,$H._mesh=null,$H._materials=null,$H._subMeshes=null,$H._materialMap=null,$s($H,["_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]),$H;}(),$CR=function(){function $X(){}return $h($X,"laya.d3.loaders.LoadModelV03"),$X.parse=function($R,$F,$i,$j,$t){$X._mesh=$i,$X._subMeshes=$j,$X._materialMap=$t,$X._version=$F,$X._readData=$R,$X.READ_DATA(),$X.READ_BLOCK(),$X.READ_STRINGS();for(var $p=0,$$=$X._BLOCK.count;$p<$$;$p++){$X._readData.pos=$X._BLOCK.blockStarts[$p];var $V=$X._readData.getUint16(),$N=$X._strings[$V],$c=$X["READ_"+$N];if(null==$c)throw new Error("model file err,no this function:"+$V+" "+$N);$c.call();}$X._strings.length=0,$X._readData=null,$X._version=null,$X._mesh=null,$X._subMeshes=null,$X._materialMap=null;},$X._readString=function(){return $X._strings[$X._readData.getUint16()];},$X.READ_DATA=function(){$X._DATA.offset=$X._readData.getUint32(),$X._DATA.size=$X._readData.getUint32();},$X.READ_BLOCK=function(){for(var $R=$X._BLOCK.count=$X._readData.getUint16(),$F=$X._BLOCK.blockStarts=[],$i=$X._BLOCK.blockLengths=[],$j=0;$j<$R;$j++)$F.push($X._readData.getUint32()),$i.push($X._readData.getUint32());},$X.READ_STRINGS=function(){var $R=$X._readData.getUint32(),$F=$X._readData.getUint16(),$i=$X._readData.pos;$X._readData.pos=$R+$X._DATA.offset;for(var $j=0;$j<$F;$j++)$X._strings[$j]=$X._readData.readUTFString();$X._readData.pos=$i;},$X.READ_MESH=function(){var $R,$F=$X._readString(),$i=$X._readData.__getBuffer(),$j=0,$t=$X._readData.getInt16(),$p=$X._DATA.offset;for($j=0;$j<$t;$j++){var $$,$V=$p+$X._readData.getUint32(),$N=$X._readData.getUint32(),$c=new Float32Array($i.slice($V,$V+$N)),$q=$X._readString();switch($X._version){case"LAYAMODEL:03":$$=$X._vertexDeclarationMap_Discard[$q];break;case"LAYAMODEL:0301":$$=$X._vertexDeclarationMap[$q];break;default:throw new Error("LoadModelV03: unknown version.");}if(!$$)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+$X._version+"  bufferAttribute="+$q+"  name="+$F+"  url="+($X._mesh?$X._mesh.url:"null"));var $s=$bF.create($$,4*$c.length/$$.vertexStride,35044,!0,$X._mesh._url+"_"+$j);$s.setData($c),$X._mesh._vertexBuffers.push($s);}var $k=$p+$X._readData.getUint32(),$h=$X._readData.getUint32(),$S=new Uint16Array($i.slice($k,$k+$h)),$x=$QF.create("ushort",$h/2,35044,!0,$X._mesh._url);$x.setData($S),$X._mesh._indexBuffer=$x;var $a=$X._mesh._boneNames=[],$m=$X._readData.getUint16();for($a.length=$m,$j=0;$j<$m;$j++)$a[$j]=$X._strings[$X._readData.getUint16()];$X._readData.pos+=8;var $M=$X._readData.getUint32(),$J=$X._readData.getUint32(),$d=new Float32Array($i.slice($p+$M,$p+$M+$J));for($X._mesh._inverseBindPoses=[],$j=0,$R=$d.length;$j<$R;$j+=16){var $w=new $RF($d[$j+0],$d[$j+1],$d[$j+2],$d[$j+3],$d[$j+4],$d[$j+5],$d[$j+6],$d[$j+7],$d[$j+8],$d[$j+9],$d[$j+10],$d[$j+11],$d[$j+12],$d[$j+13],$d[$j+14],$d[$j+15]);$X._mesh._inverseBindPoses.push($w);}return $X._mesh._skinnedDatas=new Float32Array(16*$d.length),!0;},$X.READ_SUBMESH=function(){var $R=$X._readData.__getBuffer(),$F=new $cF($X._mesh),$i=$X._readData.getInt16(),$j=$X._readData.getUint32(),$t=$X._readData.getUint32();$F._vertexBuffer=$X._mesh._vertexBuffers[$i],$F._vertexStart=$j,$F._vertexCount=$t;var $p=$X._readData.getUint32(),$$=$X._readData.getUint32(),$V=$X._mesh._indexBuffer;$F._indexBuffer=$V,$F._indexStart=$p,$F._indexCount=$$,$F._indices=new Uint16Array($V.getData().buffer,2*$p,$$);var $N=$X._DATA.offset,$c=$F._subIndexBufferStart,$q=$F._subIndexBufferCount,$s=$F._boneIndicesList,$k=$X._readData.getUint16();$c.length=$k,$q.length=$k,$s.length=$k;for(var $h=0;$h<$k;$h++){$c[$h]=$X._readData.getUint32(),$q[$h]=$X._readData.getUint32();var $S=$X._readData.getUint32(),$x=$X._readData.getUint32();$s[$h]=new Uint8Array($R.slice($N+$S,$N+$S+$x));}return $X._subMeshes.push($F),!0;},$X._strings=[],$X._readData=null,$X._version=null,$X._mesh=null,$X._subMeshes=null,$X._materialMap=null,$s($X,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$JR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$mR.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$ER.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$uR.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$fR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$_R.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$XR.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$bR.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$eR.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$kR.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$qR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$wR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$aR.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$KR.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$YR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$gR.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$yR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$xR.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$OR.vertexDeclaration,"POSITION,NORMAL,UV":$LR.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$SR.vertexDeclaration,"POSITION,NORMAL,COLOR":$cR.vertexDeclaration,"POSITION,NORMAL,TANGENT":$zR.vertexDeclaration,"POSITION,NORMAL":$NR.vertexDeclaration,"POSITION,UV":$WR.vertexDeclaration,POSITION:$VR.vertexDeclaration};},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$MR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$mR.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$ER.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$ZR.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$fR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$HR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$XR.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$QR.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$eR.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$sR.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$qR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$dR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$aR.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$vR.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$YR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$TR.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$yR.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$xR.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$GR.vertexDeclaration,"POSITION,NORMAL,UV":$LR.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$hR.vertexDeclaration,"POSITION,NORMAL,COLOR":$cR.vertexDeclaration,"POSITION,NORMAL,TANGENT":$BR.vertexDeclaration,"POSITION,NORMAL":$NR.vertexDeclaration,"POSITION,UV":$WR.vertexDeclaration,POSITION:$VR.vertexDeclaration};},"_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]),$X;}(),$rR=function(){function $V(){}return $h($V,"laya.d3.loaders.MeshReader"),$V.read=function($R,$F,$i,$j,$t){var $p=new $X($R);$p.pos=0;var $$=$p.readUTFString();switch($$){case"LAYAMODEL:01":case"LAYASKINANI:01":$V._readVersion01($p,$$,$F,$i,$j,$t);break;case"LAYAMODEL:02":$nR.parse($p,$$,$F,$i,$j,$t);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":$CR.parse($p,$$,$F,$j,$t);break;default:throw new Error("MeshReader: unknown mesh version.");}$F._setSubMeshes($j);},$V._readVersion01=function($R,$F,$i,$j,$t,$p){new $oR($R,$F,$i,$j,$t,$p);},$V;}(),$AR=function(){function $R($R,$F){this.min=null,this.max=null,this.min=$R,this.max=$F;}$h($R,"laya.d3.math.BoundBox");var $F=$R.prototype;return $w.imps($F,{"laya.d3.core.IClone":!0}),$F.getCorners=function($R){$R.length=8;var $F=this.min.elements,$i=this.max.elements,$j=$F[0],$t=$F[1],$p=$F[2],$$=$i[0],$V=$i[1],$N=$i[2];$R[0]=new $$F($j,$V,$N),$R[1]=new $$F($$,$V,$N),$R[2]=new $$F($$,$t,$N),$R[3]=new $$F($j,$t,$N),$R[4]=new $$F($j,$V,$p),$R[5]=new $$F($$,$V,$p),$R[6]=new $$F($$,$t,$p),$R[7]=new $$F($j,$t,$p);},$F.toDefault=function(){this.min.toDefault(),this.max.toDefault();},$F.cloneTo=function($R){var $F=$R;this.min.cloneTo($F.min),this.max.cloneTo($F.max);},$F.clone=function(){var $R=new this.constructor(new $$F(),new $$F());return this.cloneTo($R),$R;},$R.createfromPoints=function($R,$F){if(null==$R)throw new Error("points");var $i=$F.min,$j=$F.max,$t=$i.elements;$t[0]=Number.MAX_VALUE,$t[1]=Number.MAX_VALUE,$t[2]=Number.MAX_VALUE;var $p=$j.elements;$p[0]=-Number.MAX_VALUE,$p[1]=-Number.MAX_VALUE,$p[2]=-Number.MAX_VALUE;for(var $$=0,$V=$R.length;$$<$V;++$$)$$F.min($i,$R[$$],$i),$$F.max($j,$R[$$],$j);},$R.merge=function($R,$F,$i){$$F.min($R.min,$F.min,$i.min),$$F.max($R.max,$F.max,$i.max);},$R;}(),$PR=function(){function $c($R){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=$R,this._near=new $FF(new $$F()),this._far=new $FF(new $$F()),this._left=new $FF(new $$F()),this._right=new $FF(new $$F()),this._top=new $FF(new $$F()),this._bottom=new $FF(new $$F()),$c._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom);}$h($c,"laya.d3.math.BoundFrustum");var $R=$c.prototype;return $R.equalsBoundFrustum=function($R){return this._matrix.equalsOtherMatrix($R.matrix);},$R.equalsObj=function($R){if($R instanceof laya.d3.math.BoundFrustum){var $F=$R;return this.equalsBoundFrustum($F);}return!1;},$R.getPlane=function($R){switch($R){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null;}},$R.getCorners=function($R){$c._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo($R[0]),$c._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo($R[1]),$c._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo($R[2]),$c._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo($R[3]),$c._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo($R[4]),$c._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo($R[5]),$c._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo($R[6]),$c._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo($R[7]);},$R.containsPoint=function($R){for(var $F=$FF.PlaneIntersectionType_Front,$i=$FF.PlaneIntersectionType_Front,$j=0;$j<6;$j++){switch($j){case 0:$i=Collision.intersectsPlaneAndPoint(this._near,$R);break;case 1:$i=Collision.intersectsPlaneAndPoint(this._far,$R);break;case 2:$i=Collision.intersectsPlaneAndPoint(this._left,$R);break;case 3:$i=Collision.intersectsPlaneAndPoint(this._right,$R);break;case 4:$i=Collision.intersectsPlaneAndPoint(this._top,$R);break;case 5:$i=Collision.intersectsPlaneAndPoint(this._bottom,$R);}switch($i){case $FF.PlaneIntersectionType_Back:return 0;case $FF.PlaneIntersectionType_Intersecting:$F=$FF.PlaneIntersectionType_Intersecting;}}switch($F){case $FF.PlaneIntersectionType_Intersecting:return 2;default:return 1;}},$R.containsBoundBox=function($R){for(var $F,$i=$c._tempV30,$j=$c._tempV31,$t=1,$p=0;$p<6;$p++){if($F=this.getPlane($p),this._getBoxToPlanePVertexNVertex($R,$F.normal,$i,$j),Collision.intersectsPlaneAndPoint($F,$i)===$FF.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint($F,$j)===$FF.PlaneIntersectionType_Back&&($t=2);}return $t;},$R.containsBoundSphere=function($R){for(var $F=$FF.PlaneIntersectionType_Front,$i=$FF.PlaneIntersectionType_Front,$j=0;$j<6;$j++){switch($j){case 0:$i=Collision.intersectsPlaneAndSphere(this._near,$R);break;case 1:$i=Collision.intersectsPlaneAndSphere(this._far,$R);break;case 2:$i=Collision.intersectsPlaneAndSphere(this._left,$R);break;case 3:$i=Collision.intersectsPlaneAndSphere(this._right,$R);break;case 4:$i=Collision.intersectsPlaneAndSphere(this._top,$R);break;case 5:$i=Collision.intersectsPlaneAndSphere(this._bottom,$R);}switch($i){case $FF.PlaneIntersectionType_Back:return 0;case $FF.PlaneIntersectionType_Intersecting:$F=$FF.PlaneIntersectionType_Intersecting;}}switch($F){case $FF.PlaneIntersectionType_Intersecting:return 2;default:return 1;}},$R._getBoxToPlanePVertexNVertex=function($R,$F,$i,$j){var $t=$R.min,$p=$t.elements,$$=$R.max,$V=$$.elements,$N=$F.elements,$c=$N[0],$q=$N[1],$s=$N[2];$t.cloneTo($i);var $k=$i.elements;0<=$c&&($k[0]=$V[0]),0<=$q&&($k[1]=$V[1]),0<=$s&&($k[2]=$V[2]),$$.cloneTo($j);var $h=$j.elements;0<=$c&&($h[0]=$p[0]),0<=$q&&($h[1]=$p[1]),0<=$s&&($h[2]=$p[2]);},$S(0,$R,"top",function(){return this._top;}),$S(0,$R,"matrix",function(){return this._matrix;},function($R){this._matrix=$R,$c._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom);}),$S(0,$R,"near",function(){return this._near;}),$S(0,$R,"far",function(){return this._far;}),$S(0,$R,"left",function(){return this._left;}),$S(0,$R,"right",function(){return this._right;}),$S(0,$R,"bottom",function(){return this._bottom;}),$c._getPlanesFromMatrix=function($R,$F,$i,$j,$t,$p,$$){var $V=$R.elements,$N=$V[0],$c=$V[1],$q=$V[2],$s=$V[3],$k=$V[4],$h=$V[5],$S=$V[6],$x=$V[7],$a=$V[8],$m=$V[9],$M=$V[10],$J=$V[11],$d=$V[12],$w=$V[13],$X=$V[14],$H=$V[15],$_=$F.normal.elements;$_[0]=$s+$q,$_[1]=$x+$S,$_[2]=$J+$M,$F.distance=$H+$X,$F.normalize();var $T=$i.normal.elements;$T[0]=$s-$q,$T[1]=$x-$S,$T[2]=$J-$M,$i.distance=$H-$X,$i.normalize();var $g=$j.normal.elements;$g[0]=$s+$N,$g[1]=$x+$k,$g[2]=$J+$a,$j.distance=$H+$d,$j.normalize();var $B=$t.normal.elements;$B[0]=$s-$N,$B[1]=$x-$k,$B[2]=$J-$a,$t.distance=$H-$d,$t.normalize();var $z=$p.normal.elements;$z[0]=$s-$c,$z[1]=$x-$h,$z[2]=$J-$m,$p.distance=$H-$w,$p.normalize();var $L=$$.normal.elements;$L[0]=$s+$c,$L[1]=$x+$h,$L[2]=$J+$m,$$.distance=$H+$w,$$.normalize();},$c._get3PlaneInterPoint=function($R,$F,$i){var $j=$R.normal,$t=$F.normal,$p=$i.normal;$$F.cross($t,$p,$c._tempV30),$$F.cross($p,$j,$c._tempV31),$$F.cross($j,$t,$c._tempV32);var $$=$$F.dot($j,$c._tempV30),$V=$$F.dot($t,$c._tempV31),$N=$$F.dot($p,$c._tempV32);return $$F.scale($c._tempV30,-$R.distance/$$,$c._tempV33),$$F.scale($c._tempV31,-$F.distance/$V,$c._tempV34),$$F.scale($c._tempV32,-$i.distance/$N,$c._tempV35),$$F.add($c._tempV33,$c._tempV34,$c._tempV36),$$F.add($c._tempV35,$c._tempV36,$c._tempV37),$c._tempV37;},$s($c,["_tempV30",function(){return this._tempV30=new $$F();},"_tempV31",function(){return this._tempV31=new $$F();},"_tempV32",function(){return this._tempV32=new $$F();},"_tempV33",function(){return this._tempV33=new $$F();},"_tempV34",function(){return this._tempV34=new $$F();},"_tempV35",function(){return this._tempV35=new $$F();},"_tempV36",function(){return this._tempV36=new $$F();},"_tempV37",function(){return this._tempV37=new $$F();}]),$c;}(),$UR=function(){function $q($R,$F){this.center=null,this.radius=NaN,this.center=$R,this.radius=$F;}$h($q,"laya.d3.math.BoundSphere");var $R=$q.prototype;return $w.imps($R,{"laya.d3.core.IClone":!0}),$R.toDefault=function(){this.center.toDefault(),this.radius=0;},$R.intersectsRayDistance=function($R){return Collision.intersectsRayAndSphereRD($R,this);},$R.intersectsRayPoint=function($R,$F){return Collision.intersectsRayAndSphereRP($R,this,$F);},$R.cloneTo=function($R){var $F=$R;this.center.cloneTo($F.center),$F.radius=this.radius;},$R.clone=function(){var $R=new this.constructor(new $$F(),new $$F());return this.cloneTo($R),$R;},$q.createFromSubPoints=function($R,$F,$i,$j){if(null==$R)throw new Error("points");if($F<0||$F>=$R.length)throw new Error("start"+$F+"Must be in the range [0, "+($R.length-1)+"]");if($i<0||$F+$i>$R.length)throw new Error("count"+$i+"Must be in the range <= "+$R.length+"}");var $t=$F+$i,$p=$q._tempVector3;$p.elements[0]=0,$p.elements[1]=0,$p.elements[2]=0;for(var $$=$F;$$<$t;++$$)$$F.add($R[$$],$p,$p);var $V=$j.center;$$F.scale($p,1/$i,$V);var $N=0;for($$=$F;$$<$t;++$$){var $c=$$F.distanceSquared($V,$R[$$]);$N<$c&&($N=$c);}$j.radius=Math.sqrt($N);},$q.createfromPoints=function($R,$F){if(null==$R)throw new Error("points");$q.createFromSubPoints($R,0,$R.length,$F);},$s($q,["_tempVector3",function(){return this._tempVector3=new $$F();}]),$q;}(),$IR=(function(){function $R(){}$h($R,"laya.d3.math.ContainmentType"),$R.Disjoint=0,$R.Contains=1,$R.Intersects=2;}(),function(){function $i(){}return $h($i,"laya.d3.math.MathUtils3D"),$i.isZero=function($R){return Math.abs($R)<$i.zeroTolerance;},$i.nearEqual=function($R,$F){return!!$i.isZero($R-$F);},$i.fastInvSqrt=function($R){return $i.isZero($R)?$R:1/Math.sqrt($R);},$s($i,["zeroTolerance",function(){return this.zeroTolerance=1e-6;},"MaxValue",function(){return this.MaxValue=340282347e30;},"MinValue",function(){return this.MinValue=-340282347e30;}]),$i;}()),$DR=function(){function $N(){var $R=this.elements=new Float32Array(9);$R[0]=1,$R[1]=0,$R[2]=0,$R[3]=0,$R[4]=1,$R[5]=0,$R[6]=0,$R[7]=0,$R[8]=1;}$h($N,"laya.d3.math.Matrix3x3");var $R=$N.prototype;return $w.imps($R,{"laya.d3.core.IClone":!0}),$R.determinant=function(){var $R=this.elements,$F=$R[0],$i=$R[1],$j=$R[2],$t=$R[3],$p=$R[4],$$=$R[5],$V=$R[6],$N=$R[7],$c=$R[8];return $F*($c*$p-$$*$N)+$i*(-$c*$t+$$*$V)+$j*($N*$t-$p*$V);},$R.translate=function($R,$F){var $i=$F.elements,$j=this.elements,$t=$R.elements,$p=$j[0],$$=$j[1],$V=$j[2],$N=$j[3],$c=$j[4],$q=$j[5],$s=$j[6],$k=$j[7],$h=$j[8],$S=$t[0],$x=$t[1];$i[0]=$p,$i[1]=$$,$i[2]=$V,$i[3]=$N,$i[4]=$c,$i[5]=$q,$i[6]=$S*$p+$x*$N+$s,$i[7]=$S*$$+$x*$c+$k,$i[8]=$S*$V+$x*$q+$h;},$R.rotate=function($R,$F){var $i=$F.elements,$j=this.elements,$t=$j[0],$p=$j[1],$$=$j[2],$V=$j[3],$N=$j[4],$c=$j[5],$q=$j[6],$s=$j[7],$k=$j[8],$h=Math.sin($R),$S=Math.cos($R);$i[0]=$S*$t+$h*$V,$i[1]=$S*$p+$h*$N,$i[2]=$S*$$+$h*$c,$i[3]=$S*$V-$h*$t,$i[4]=$S*$N-$h*$p,$i[5]=$S*$c-$h*$$,$i[6]=$q,$i[7]=$s,$i[8]=$k;},$R.scale=function($R,$F){var $i=$F.elements,$j=this.elements,$t=$R.elements,$p=$t[0],$$=$t[1];$i[0]=$p*$j[0],$i[1]=$p*$j[1],$i[2]=$p*$j[2],$i[3]=$$*$j[3],$i[4]=$$*$j[4],$i[5]=$$*$j[5],$i[6]=$j[6],$i[7]=$j[7],$i[8]=$j[8];},$R.invert=function($R){var $F=$R.elements,$i=this.elements,$j=$i[0],$t=$i[1],$p=$i[2],$$=$i[3],$V=$i[4],$N=$i[5],$c=$i[6],$q=$i[7],$s=$i[8],$k=$s*$V-$N*$q,$h=-$s*$$+$N*$c,$S=$q*$$-$V*$c,$x=$j*$k+$t*$h+$p*$S;$x||($R=null),$x=1/$x,$F[0]=$k*$x,$F[1]=(-$s*$t+$p*$q)*$x,$F[2]=($N*$t-$p*$V)*$x,$F[3]=$h*$x,$F[4]=($s*$j-$p*$c)*$x,$F[5]=(-$N*$j+$p*$$)*$x,$F[6]=$S*$x,$F[7]=(-$q*$j+$t*$c)*$x,$F[8]=($V*$j-$t*$$)*$x;},$R.transpose=function($R){var $F=$R.elements,$i=this.elements;if($R===this){var $j=$i[1],$t=$i[2],$p=$i[5];$F[1]=$i[3],$F[2]=$i[6],$F[3]=$j,$F[5]=$i[7],$F[6]=$t,$F[7]=$p;}else $F[0]=$i[0],$F[1]=$i[3],$F[2]=$i[6],$F[3]=$i[1],$F[4]=$i[4],$F[5]=$i[7],$F[6]=$i[2],$F[7]=$i[5],$F[8]=$i[8];},$R.identity=function(){var $R=this.elements;$R[0]=1,$R[1]=0,$R[2]=0,$R[3]=0,$R[4]=1,$R[5]=0,$R[6]=0,$R[7]=0,$R[8]=1;},$R.cloneTo=function($R){var $F,$i,$j;if(($i=this.elements)!==($j=$R.elements))for($F=0;$F<9;++$F)$j[$F]=$i[$F];},$R.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$N.createFromTranslation=function($R,$F){$F.elements;var $i=$R.elements;$F[0]=1,$F[1]=0,$F[2]=0,$F[3]=0,$F[4]=1,$F[5]=0,$F[6]=$i[0],$F[7]=$i[1],$F[8]=1;},$N.createFromRotation=function($R,$F){var $i=$F.elements,$j=Math.sin($R),$t=Math.cos($R);$i[0]=$t,$i[1]=$j,$i[2]=0,$i[3]=-$j,$i[4]=$t,$i[5]=0,$i[6]=0,$i[7]=0,$i[8]=1;},$N.createFromScaling=function($R,$F){var $i=$F.elements,$j=$R.elements;$i[0]=$j[0],$i[1]=0,$i[2]=0,$i[3]=0,$i[4]=$j[1],$i[5]=0,$i[6]=0,$i[7]=0,$i[8]=1;},$N.createFromMatrix4x4=function($R,$F){$F[0]=$R[0],$F[1]=$R[1],$F[2]=$R[2],$F[3]=$R[4],$F[4]=$R[5],$F[5]=$R[6],$F[6]=$R[8],$F[7]=$R[9],$F[8]=$R[10];},$N.multiply=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements,$$=$t[0],$V=$t[1],$N=$t[2],$c=$t[3],$q=$t[4],$s=$t[5],$k=$t[6],$h=$t[7],$S=$t[8],$x=$p[0],$a=$p[1],$m=$p[2],$M=$p[3],$J=$p[4],$d=$p[5],$w=$p[6],$X=$p[7],$H=$p[8];$j[0]=$x*$$+$a*$c+$m*$k,$j[1]=$x*$V+$a*$q+$m*$h,$j[2]=$x*$N+$a*$s+$m*$S,$j[3]=$M*$$+$J*$c+$d*$k,$j[4]=$M*$V+$J*$q+$d*$h,$j[5]=$M*$N+$J*$s+$d*$S,$j[6]=$w*$$+$X*$c+$H*$k,$j[7]=$w*$V+$X*$q+$H*$h,$j[8]=$w*$N+$X*$s+$H*$S;},$N.lookAt=function($R,$F,$i,$j){$$F.subtract($R,$F,$N._tempV30),$$F.normalize($N._tempV30,$N._tempV30),$$F.cross($i,$N._tempV30,$N._tempV31),$$F.normalize($N._tempV31,$N._tempV31),$$F.cross($N._tempV30,$N._tempV31,$N._tempV32);var $t=$N._tempV30.elements,$p=$N._tempV31.elements,$$=$N._tempV32.elements,$V=$j.elements;$V[0]=$p[0],$V[3]=$p[1],$V[6]=$p[2],$V[1]=$$[0],$V[4]=$$[1],$V[7]=$$[2],$V[2]=$t[0],$V[5]=$t[1],$V[8]=$t[2];},$N.DEFAULT=new $N(),$s($N,["_tempV30",function(){return this._tempV30=new $$F();},"_tempV31",function(){return this._tempV31=new $$F();},"_tempV32",function(){return this._tempV32=new $$F();}]),$N;}(),$RF=function(){function $T($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$s,$k,$h,$S,$x){void 0===$R&&($R=1),void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=0),void 0===$t&&($t=0),void 0===$p&&($p=1),void 0===$$&&($$=0),void 0===$V&&($V=0),void 0===$N&&($N=0),void 0===$c&&($c=0),void 0===$q&&($q=1),void 0===$s&&($s=0),void 0===$k&&($k=0),void 0===$h&&($h=0),void 0===$S&&($S=0),void 0===$x&&($x=1);var $a=this.elements=new Float32Array(16);$a[0]=$R,$a[1]=$F,$a[2]=$i,$a[3]=$j,$a[4]=$t,$a[5]=$p,$a[6]=$$,$a[7]=$V,$a[8]=$N,$a[9]=$c,$a[10]=$q,$a[11]=$s,$a[12]=$k,$a[13]=$h,$a[14]=$S,$a[15]=$x;}$h($T,"laya.d3.math.Matrix4x4");var $R=$T.prototype;return $w.imps($R,{"laya.d3.core.IClone":!0}),$R.getElementByRowColumn=function($R,$F){if($R<0||3<$R)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($F<0||3<$F)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*$R+$F];},$R.setElementByRowColumn=function($R,$F,$i){if($R<0||3<$R)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($F<0||3<$F)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*$R+$F]=$i;},$R.equalsOtherMatrix=function($R){var $F=this.elements,$i=$R.elements;return $IR.nearEqual($F[0],$i[0])&&$IR.nearEqual($F[1],$i[1])&&$IR.nearEqual($F[2],$i[2])&&$IR.nearEqual($F[3],$i[3])&&$IR.nearEqual($F[4],$i[4])&&$IR.nearEqual($F[5],$i[5])&&$IR.nearEqual($F[6],$i[6])&&$IR.nearEqual($F[7],$i[7])&&$IR.nearEqual($F[8],$i[8])&&$IR.nearEqual($F[9],$i[9])&&$IR.nearEqual($F[10],$i[10])&&$IR.nearEqual($F[11],$i[11])&&$IR.nearEqual($F[12],$i[12])&&$IR.nearEqual($F[13],$i[13])&&$IR.nearEqual($F[14],$i[14])&&$IR.nearEqual($F[15],$i[15]);},$R.decomposeTransRotScale=function($R,$F,$i){var $j=$T._tempMatrix4x4;return this.decomposeTransRotMatScale($R,$j,$i)?($iF.createFromMatrix4x4($j,$F),!0):($F.identity(),!1);},$R.decomposeTransRotMatScale=function($R,$F,$i){var $j=this.elements,$t=$R.elements,$p=$F.elements,$$=$i.elements;$t[0]=$j[12],$t[1]=$j[13],$t[2]=$j[14];var $V=$j[0],$N=$j[1],$c=$j[2],$q=$j[4],$s=$j[5],$k=$j[6],$h=$j[8],$S=$j[9],$x=$j[10],$a=$$[0]=Math.sqrt($V*$V+$N*$N+$c*$c),$m=$$[1]=Math.sqrt($q*$q+$s*$s+$k*$k),$M=$$[2]=Math.sqrt($h*$h+$S*$S+$x*$x);if($IR.isZero($a)||$IR.isZero($m)||$IR.isZero($M))return $p[1]=$p[2]=$p[3]=$p[4]=$p[6]=$p[7]=$p[8]=$p[9]=$p[11]=$p[12]=$p[13]=$p[14]=0,$p[0]=$p[5]=$p[10]=$p[15]=1,!1;var $J=$T._tempVector0,$d=$J.elements;$d[0]=$h/$M,$d[1]=$S/$M,$d[2]=$x/$M;var $w=$T._tempVector1,$X=$w.elements;$X[0]=$V/$a,$X[1]=$N/$a,$X[2]=$c/$a;var $H=$T._tempVector2;$$F.cross($J,$w,$H);var $_=$T._tempVector1;return $$F.cross($H,$J,$_),$p[3]=$p[7]=$p[11]=$p[12]=$p[13]=$p[14]=0,$p[15]=1,$p[0]=$_.x,$p[1]=$_.y,$p[2]=$_.z,$p[4]=$H.x,$p[5]=$H.y,$p[6]=$H.z,$p[8]=$J.x,$p[9]=$J.y,$p[10]=$J.z,$p[0]*$V+$p[1]*$N+$p[2]*$c<0&&($$[0]=-$a),$p[4]*$q+$p[5]*$s+$p[6]*$k<0&&($$[1]=-$m),$p[8]*$h+$p[9]*$S+$p[10]*$x<0&&($$[2]=-$M),!0;},$R.decomposeYawPitchRoll=function($R){var $F=$R.elements,$i=Math.asin(-this.elements[9]);$F[1]=$i,Math.cos($i)>$IR.zeroTolerance?($F[2]=Math.atan2(this.elements[1],this.elements[5]),$F[0]=Math.atan2(this.elements[8],this.elements[10])):($F[2]=Math.atan2(-this.elements[4],this.elements[0]),$F[0]=0);},$R.normalize=function(){var $R=this.elements,$F=$R[0],$i=$R[1],$j=$R[2],$t=Math.sqrt($F*$F+$i*$i+$j*$j);if(!$t)return $R[0]=0,$R[1]=0,void($R[2]=0);1!=$t&&($t=1/$t,$R[0]=$F*$t,$R[1]=$i*$t,$R[2]=$j*$t);},$R.transpose=function(){var $R,$F;return $F=($R=this.elements)[1],$R[1]=$R[4],$R[4]=$F,$F=$R[2],$R[2]=$R[8],$R[8]=$F,$F=$R[3],$R[3]=$R[12],$R[12]=$F,$F=$R[6],$R[6]=$R[9],$R[9]=$F,$F=$R[7],$R[7]=$R[13],$R[13]=$F,$F=$R[11],$R[11]=$R[14],$R[14]=$F,this;},$R.invert=function($R){var $F=this.elements,$i=$R.elements,$j=$F[0],$t=$F[1],$p=$F[2],$$=$F[3],$V=$F[4],$N=$F[5],$c=$F[6],$q=$F[7],$s=$F[8],$k=$F[9],$h=$F[10],$S=$F[11],$x=$F[12],$a=$F[13],$m=$F[14],$M=$F[15],$J=$j*$N-$t*$V,$d=$j*$c-$p*$V,$w=$j*$q-$$*$V,$X=$t*$c-$p*$N,$H=$t*$q-$$*$N,$_=$p*$q-$$*$c,$T=$s*$a-$k*$x,$g=$s*$m-$h*$x,$B=$s*$M-$S*$x,$z=$k*$m-$h*$a,$L=$k*$M-$S*$a,$Y=$h*$M-$S*$m,$f=$J*$Y-$d*$L+$w*$z+$X*$B-$H*$g+$_*$T;0!==Math.abs($f)&&($f=1/$f,$i[0]=($N*$Y-$c*$L+$q*$z)*$f,$i[1]=($p*$L-$t*$Y-$$*$z)*$f,$i[2]=($a*$_-$m*$H+$M*$X)*$f,$i[3]=($h*$H-$k*$_-$S*$X)*$f,$i[4]=($c*$B-$V*$Y-$q*$g)*$f,$i[5]=($j*$Y-$p*$B+$$*$g)*$f,$i[6]=($m*$w-$x*$_-$M*$d)*$f,$i[7]=($s*$_-$h*$w+$S*$d)*$f,$i[8]=($V*$L-$N*$B+$q*$T)*$f,$i[9]=($t*$B-$j*$L-$$*$T)*$f,$i[10]=($x*$H-$a*$w+$M*$J)*$f,$i[11]=($k*$w-$s*$H-$S*$J)*$f,$i[12]=($N*$g-$V*$z-$c*$T)*$f,$i[13]=($j*$z-$t*$g+$p*$T)*$f,$i[14]=($a*$d-$x*$X-$m*$J)*$f,$i[15]=($s*$X-$k*$d+$h*$J)*$f);},$R.identity=function(){var $R=this.elements;$R[1]=$R[2]=$R[3]=$R[4]=$R[6]=$R[7]=$R[8]=$R[9]=$R[11]=$R[12]=$R[13]=$R[14]=0,$R[0]=$R[5]=$R[10]=$R[15]=1;},$R.cloneTo=function($R){var $F,$i,$j;if(($i=this.elements)!==($j=$R.elements))for($F=0;$F<16;++$F)$j[$F]=$i[$F];},$R.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$R.getTranslationVector=function($R){var $F=this.elements,$i=$R.elements;$i[0]=$F[12],$i[1]=$F[13],$i[2]=$F[14];},$R.setTranslationVector=function($R){var $F=this.elements,$i=$R.elements;$F[12]=$i[0],$F[13]=$i[1],$F[14]=$i[2];},$R.getForward=function($R){var $F=this.elements,$i=$R.elements;$i[0]=-$F[8],$i[1]=-$F[9],$i[2]=-$F[10];},$R.setForward=function($R){var $F=this.elements,$i=$R.elements;$F[8]=-$i[0],$F[9]=-$i[1],$F[10]=-$i[2];},$T.createRotationX=function($R,$F){var $i=$F.elements,$j=Math.sin($R),$t=Math.cos($R);$i[1]=$i[2]=$i[3]=$i[4]=$i[7]=$i[8]=$i[11]=$i[12]=$i[13]=$i[14]=0,$i[0]=$i[15]=1,$i[5]=$i[10]=$t,$i[6]=$j,$i[9]=-$j;},$T.createRotationY=function($R,$F){var $i=$F.elements,$j=Math.sin($R),$t=Math.cos($R);$i[1]=$i[3]=$i[4]=$i[6]=$i[7]=$i[9]=$i[11]=$i[12]=$i[13]=$i[14]=0,$i[5]=$i[15]=1,$i[0]=$i[10]=$t,$i[2]=-$j,$i[8]=$j;},$T.createRotationZ=function($R,$F){var $i=$F.elements,$j=Math.sin($R),$t=Math.cos($R);$i[2]=$i[3]=$i[6]=$i[7]=$i[8]=$i[9]=$i[11]=$i[12]=$i[13]=$i[14]=0,$i[10]=$i[15]=1,$i[0]=$i[5]=$t,$i[1]=$j,$i[4]=-$j;},$T.createRotationYawPitchRoll=function($R,$F,$i,$j){$iF.createFromYawPitchRoll($R,$F,$i,$T._tempQuaternion),$T.createRotationQuaternion($T._tempQuaternion,$j);},$T.createRotationAxis=function($R,$F,$i){var $j=$R.elements,$t=$j[0],$p=$j[1],$$=$j[2],$V=Math.cos($F),$N=Math.sin($F),$c=$t*$t,$q=$p*$p,$s=$$*$$,$k=$t*$p,$h=$t*$$,$S=$p*$$,$x=$i.elements;$x[3]=$x[7]=$x[11]=$x[12]=$x[13]=$x[14]=0,$x[15]=1,$x[0]=$c+$V*(1-$c),$x[1]=$k-$V*$k+$N*$$,$x[2]=$h-$V*$h-$N*$p,$x[4]=$k-$V*$k-$N*$$,$x[5]=$q+$V*(1-$q),$x[6]=$S-$V*$S+$N*$t,$x[8]=$h-$V*$h+$N*$p,$x[9]=$S-$V*$S-$N*$t,$x[10]=$s+$V*(1-$s);},$T.createRotationQuaternion=function($R,$F){var $i=$R.elements,$j=$F.elements,$t=$i[0],$p=$i[1],$$=$i[2],$V=$i[3],$N=$t*$t,$c=$p*$p,$q=$$*$$,$s=$t*$p,$k=$$*$V,$h=$$*$t,$S=$p*$V,$x=$p*$$,$a=$t*$V;$j[3]=$j[7]=$j[11]=$j[12]=$j[13]=$j[14]=0,$j[15]=1,$j[0]=1-2*($c+$q),$j[1]=2*($s+$k),$j[2]=2*($h-$S),$j[4]=2*($s-$k),$j[5]=1-2*($q+$N),$j[6]=2*($x+$a),$j[8]=2*($h+$S),$j[9]=2*($x-$a),$j[10]=1-2*($c+$N);},$T.createTranslate=function($R,$F){var $i=$R.elements,$j=$F.elements;$j[4]=$j[8]=$j[1]=$j[9]=$j[2]=$j[6]=$j[3]=$j[7]=$j[11]=0,$j[0]=$j[5]=$j[10]=$j[15]=1,$j[12]=$i[0],$j[13]=$i[1],$j[14]=$i[2];},$T.createScaling=function($R,$F){var $i=$R.elements,$j=$F.elements;$j[0]=$i[0],$j[5]=$i[1],$j[10]=$i[2],$j[1]=$j[4]=$j[8]=$j[12]=$j[9]=$j[13]=$j[2]=$j[6]=$j[14]=$j[3]=$j[7]=$j[11]=0,$j[15]=1;},$T.multiply=function($R,$F,$i){var $j,$t,$p,$$,$V,$N,$c,$q;for($t=$i.elements,$p=$R.elements,$t===($$=$F.elements)&&($$=$$.slice()),$j=0;$j<4;$j++)$V=$p[$j],$N=$p[$j+4],$c=$p[$j+8],$q=$p[$j+12],$t[$j]=$V*$$[0]+$N*$$[1]+$c*$$[2]+$q*$$[3],$t[$j+4]=$V*$$[4]+$N*$$[5]+$c*$$[6]+$q*$$[7],$t[$j+8]=$V*$$[8]+$N*$$[9]+$c*$$[10]+$q*$$[11],$t[$j+12]=$V*$$[12]+$N*$$[13]+$c*$$[14]+$q*$$[15];},$T.createFromQuaternion=function($R,$F){var $i=$F.elements,$j=$R.elements,$t=$j[0],$p=$j[1],$$=$j[2],$V=$j[3],$N=$t+$t,$c=$p+$p,$q=$$+$$,$s=$t*$N,$k=$p*$N,$h=$p*$c,$S=$$*$N,$x=$$*$c,$a=$$*$q,$m=$V*$N,$M=$V*$c,$J=$V*$q;$i[0]=1-$h-$a,$i[1]=$k+$J,$i[2]=$S-$M,$i[3]=0,$i[4]=$k-$J,$i[5]=1-$s-$a,$i[6]=$x+$m,$i[7]=0,$i[8]=$S+$M,$i[9]=$x-$m,$i[10]=1-$s-$h,$i[11]=0,$i[12]=0,$i[13]=0,$i[14]=0,$i[15]=1;},$T.createAffineTransformation=function($R,$F,$i,$j){var $t=$R.elements,$p=$F.elements,$$=$i.elements,$V=$j.elements,$N=$p[0],$c=$p[1],$q=$p[2],$s=$p[3],$k=$N+$N,$h=$c+$c,$S=$q+$q,$x=$N*$k,$a=$N*$h,$m=$N*$S,$M=$c*$h,$J=$c*$S,$d=$q*$S,$w=$s*$k,$X=$s*$h,$H=$s*$S,$_=$$[0],$T=$$[1],$g=$$[2];$V[0]=(1-($M+$d))*$_,$V[1]=($a+$H)*$_,$V[2]=($m-$X)*$_,$V[3]=0,$V[4]=($a-$H)*$T,$V[5]=(1-($x+$d))*$T,$V[6]=($J+$w)*$T,$V[7]=0,$V[8]=($m+$X)*$g,$V[9]=($J-$w)*$g,$V[10]=(1-($x+$M))*$g,$V[11]=0,$V[12]=$t[0],$V[13]=$t[1],$V[14]=$t[2],$V[15]=1;},$T.createLookAt=function($R,$F,$i,$j){var $t=$j.elements,$p=$T._tempVector0,$$=$T._tempVector1,$V=$T._tempVector2;$$F.subtract($R,$F,$V),$$F.normalize($V,$V),$$F.cross($i,$V,$p),$$F.normalize($p,$p),$$F.cross($V,$p,$$),$j.identity(),$t[0]=$p.x,$t[4]=$p.y,$t[8]=$p.z,$t[1]=$$.x,$t[5]=$$.y,$t[9]=$$.z,$t[2]=$V.x,$t[6]=$V.y,$t[10]=$V.z,$t[12]=-$$F.dot($p,$R),$t[13]=-$$F.dot($$,$R),$t[14]=-$$F.dot($V,$R);},$T.createPerspective=function($R,$F,$i,$j,$t){var $p=$t.elements,$$=1/Math.tan($R/2),$V=1/($i-$j);$p[0]=$$/$F,$p[5]=$$,$p[10]=($j+$i)*$V,$p[11]=-1,$p[14]=2*$j*$i*$V,$p[1]=$p[2]=$p[3]=$p[4]=$p[6]=$p[7]=$p[8]=$p[9]=$p[12]=$p[13]=$p[15]=0;},$T.createOrthoOffCenterRH=function($R,$F,$i,$j,$t,$p,$$){var $V=$$.elements,$N=1/($R-$F),$c=1/($i-$j),$q=1/($t-$p);$V[1]=$V[2]=$V[3]=$V[4]=$V[6]=$V[7]=$V[8]=$V[9]=$V[11]=0,$V[15]=1,$V[0]=-2*$N,$V[5]=-2*$c,$V[10]=2*$q,$V[12]=($R+$F)*$N,$V[13]=($j+$i)*$c,$V[14]=($p+$t)*$q;},$T.translation=function($R,$F){var $i=$R.elements,$j=$F.elements;$j[0]=$j[5]=$j[10]=$j[15]=1,$j[12]=$i[0],$j[13]=$i[1],$j[14]=$i[2];},$s($T,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $T();},"_tempVector0",function(){return this._tempVector0=new $$F();},"_tempVector1",function(){return this._tempVector1=new $$F();},"_tempVector2",function(){return this._tempVector2=new $$F();},"_tempQuaternion",function(){return this._tempQuaternion=new $iF();},"DEFAULT",function(){return this.DEFAULT=new $T();},"ZERO",function(){return this.ZERO=new $T(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);}]),$T;}(),$FF=(function(){function $J($R,$F){this.extents=null,this.transformation=null,this.extents=$R,this.transformation=$F;}$h($J,"laya.d3.math.OrientedBoundBox");var $R=$J.prototype;$R.getCorners=function($R){var $F=$J._tempV30.elements,$i=$J._tempV31.elements,$j=$J._tempV32.elements,$t=this.extents.elements;$F[0]=$t[0],$F[1]=$F[2]=0,$i[1]=$t[1],$i[0]=$i[2]=0,$j[2]=$t[2],$j[0]=$j[1]=0,$$F.TransformNormal($J._tempV30,this.transformation,$J._tempV30),$$F.TransformNormal($J._tempV31,this.transformation,$J._tempV31),$$F.TransformNormal($J._tempV32,this.transformation,$J._tempV32);var $p=$J._tempV33;this.transformation.getTranslationVector($p),$R.length=8,$$F.add($p,$J._tempV30,$J._tempV34),$$F.add($J._tempV34,$J._tempV31,$J._tempV34),$$F.add($J._tempV34,$J._tempV32,$R[0]),$$F.add($p,$J._tempV30,$J._tempV34),$$F.add($J._tempV34,$J._tempV31,$J._tempV34),$$F.subtract($J._tempV34,$J._tempV32,$R[1]),$$F.subtract($p,$J._tempV30,$J._tempV34),$$F.add($J._tempV34,$J._tempV31,$J._tempV34),$$F.subtract($J._tempV34,$J._tempV32,$R[2]),$$F.subtract($p,$J._tempV30,$J._tempV34),$$F.add($J._tempV34,$J._tempV31,$J._tempV34),$$F.add($J._tempV34,$J._tempV32,$R[3]),$$F.add($p,$J._tempV30,$J._tempV34),$$F.subtract($J._tempV34,$J._tempV31,$J._tempV34),$$F.add($J._tempV34,$J._tempV32,$R[4]),$$F.add($p,$J._tempV30,$J._tempV34),$$F.subtract($J._tempV34,$J._tempV31,$J._tempV34),$$F.subtract($J._tempV34,$J._tempV32,$R[5]),$$F.subtract($p,$J._tempV30,$J._tempV34),$$F.subtract($J._tempV34,$J._tempV31,$J._tempV34),$$F.subtract($J._tempV34,$J._tempV32,$R[6]),$$F.subtract($p,$J._tempV30,$J._tempV34),$$F.subtract($J._tempV34,$J._tempV31,$J._tempV34),$$F.add($J._tempV34,$J._tempV32,$R[7]);},$R.transform=function($R){$RF.multiply(this.transformation,$R,this.transformation);},$R.scale=function($R){$$F.multiply(this.extents,$R,this.extents);},$R.translate=function($R){this.transformation.getTranslationVector($J._tempV30),$$F.add($J._tempV30,$R,$J._tempV31),this.transformation.setTranslationVector($J._tempV31);},$R.Size=function($R){$$F.scale(this.extents,2,$R);},$R.getSize=function($R){var $F=this.extents.elements;$J._tempV30.x=$F[0],$J._tempV31.y=$F[1],$J._tempV32.z=$F[2],$$F.TransformNormal($J._tempV30,this.transformation,$J._tempV30),$$F.TransformNormal($J._tempV31,this.transformation,$J._tempV31),$$F.TransformNormal($J._tempV31,this.transformation,$J._tempV32);var $i=$R.elements;$i[0]=$$F.scalarLength($J._tempV30),$i[1]=$$F.scalarLength($J._tempV31),$i[2]=$$F.scalarLength($J._tempV32);},$R.getSizeSquared=function($R){var $F=this.extents.elements;$J._tempV30.x=$F[0],$J._tempV31.y=$F[1],$J._tempV32.z=$F[2],$$F.TransformNormal($J._tempV30,this.transformation,$J._tempV30),$$F.TransformNormal($J._tempV31,this.transformation,$J._tempV31),$$F.TransformNormal($J._tempV31,this.transformation,$J._tempV32);var $i=$R.elements;$i[0]=$$F.scalarLengthSquared($J._tempV30),$i[1]=$$F.scalarLengthSquared($J._tempV31),$i[2]=$$F.scalarLengthSquared($J._tempV32);},$R.getCenter=function($R){this.transformation.getTranslationVector($R);},$R.containsPoint=function($R){var $F=this.extents.elements,$i=$F[0],$j=$F[1],$t=$F[2];this.transformation.invert($J._tempM0),$$F.transformCoordinate($R,$J._tempM0,$J._tempV30);var $p=$J._tempV30.elements,$$=Math.abs($p[0]),$V=Math.abs($p[1]),$N=Math.abs($p[2]);return $IR.nearEqual($$,$i)&&$IR.nearEqual($V,$j)&&$IR.nearEqual($N,$t)?2:$$<$i&&$V<$j&&$N<$t?1:0;},$R.containsPoints=function($R){var $F=this.extents.elements,$i=$F[0],$j=$F[1],$t=$F[2];this.transformation.invert($J._tempM0);for(var $p=!0,$$=!1,$V=0;$V<$R.length;$V++){$$F.transformCoordinate($R[$V],$J._tempM0,$J._tempV30);var $N=$J._tempV30.elements,$c=Math.abs($N[0]),$q=Math.abs($N[1]),$s=Math.abs($N[2]);$IR.nearEqual($c,$i)&&$IR.nearEqual($q,$j)&&$IR.nearEqual($s,$t)&&($$=!0),$c<$i&&$q<$j&&$s<$t?$$=!0:$p=!1;}return $p?1:$$?2:0;},$R.containsSphere=function($R,$F){void 0===$F&&($F=!1);var $i=this.extents.elements,$j=$i[0],$t=$i[1],$p=$i[2],$$=$R.radius;this.transformation.invert($J._tempM0),$$F.transformCoordinate($R.center,$J._tempM0,$J._tempV30);var $V=NaN;if($V=$F?$$:($$F.scale($$F.UnitX,$$,$J._tempV31),$$F.TransformNormal($J._tempV31,$J._tempM0,$J._tempV31),$$F.scalarLength($J._tempV31)),$$F.scale(this.extents,-1,$J._tempV32),$$F.Clamp($J._tempV30,$J._tempV32,this.extents,$J._tempV33),$V*$V<$$F.distanceSquared($J._tempV30,$J._tempV33))return 0;var $N=$J._tempV30.elements,$c=$N[0],$q=$N[1],$s=$N[2],$k=$J._tempV32.elements,$h=$k[0],$S=$k[1],$x=$k[2];return $h+$V<=$c&&$c<=$j-$V&&$V<$j-$h&&$S+$V<=$q&&$q<=$t-$V&&$V<$t-$S&&$x+$V<=$s&&$s<=$p-$V&&$V<$p-$x?1:2;},$R.containsOrientedBoundBox=function($R){var $F=0,$i=0;$R.getCorners($J._corners);var $j=this.containsPoints($J._corners);if(0!=$j)return $j;var $t=this.extents.elements;$R.extents.cloneTo($J._tempV35);var $p=$J._tempV35.elements;$J._getRows(this.transformation,$J._rows1),$J._getRows($R.transformation,$J._rows2);var $$=NaN;for($F=0;$F<4;$F++)for($i=0;$i<4;$i++)3==$F||3==$i?($J._tempM0.setElementByRowColumn($F,$i,0),$J._tempM1.setElementByRowColumn($F,$i,0)):($$=$$F.dot($J._rows1[$F],$J._rows2[$i]),$J._tempM0.setElementByRowColumn($F,$i,$$),$J._tempM1.setElementByRowColumn($F,$i,Math.abs($$)));$R.getCenter($J._tempV34),this.getCenter($J._tempV36),$$F.subtract($J._tempV34,$J._tempV36,$J._tempV30);var $V=$J._tempV31.elements;$V[0]=$$F.dot($J._tempV30,$J._rows1[0]),$V[1]=$$F.dot($J._tempV30,$J._rows1[1]),$V[2]=$$F.dot($J._tempV30,$J._rows1[2]);var $N=$J._tempV32.elements,$c=$J._tempV33.elements;for($F=0;$F<3;$F++)if($N[0]=$J._tempM1.getElementByRowColumn($F,0),$N[1]=$J._tempM1.getElementByRowColumn($F,1),$N[2]=$J._tempM1.getElementByRowColumn($F,2),$t[$F]+$$F.dot($J._tempV35,$J._tempV32)<Math.abs($V[$F]))return 0;for($i=0;$i<3;$i++)if($N[0]=$J._tempM1.getElementByRowColumn(0,$i),$N[1]=$J._tempM1.getElementByRowColumn(1,$i),$N[2]=$J._tempM1.getElementByRowColumn(2,$i),$c[0]=$J._tempM0.getElementByRowColumn(0,$i),$c[1]=$J._tempM0.getElementByRowColumn(1,$i),$c[2]=$J._tempM0.getElementByRowColumn(2,$i),$$F.dot(this.extents,$J._tempV32)+$p[$i]<Math.abs($$F.dot($J._tempV31,$J._tempV33)))return 0;for($F=0;$F<3;$F++)for($i=0;$i<3;$i++){var $q=($F+1)%3,$s=($F+2)%3,$k=($i+1)%3,$h=($i+2)%3;if($t[$q]*$J._tempM1.getElementByRowColumn($s,$i)+$t[$s]*$J._tempM1.getElementByRowColumn($q,$i)+($p[$k]*$J._tempM1.getElementByRowColumn($F,$h)+$p[$h]*$J._tempM1.getElementByRowColumn($F,$k))<Math.abs($V[$s]*$J._tempM0.getElementByRowColumn($q,$i)-$V[$q]*$J._tempM0.getElementByRowColumn($s,$i)))return 0;}return 2;},$R.containsLine=function($R,$F){$J._corners[0]=$R,$J._corners[1]=$F;var $i=this.containsPoints($J._corners);if(0!=$i)return $i;var $j=this.extents.elements,$t=$j[0],$p=$j[1],$$=$j[2];this.transformation.invert($J._tempM0),$$F.transformCoordinate($R,$J._tempM0,$J._tempV30),$$F.transformCoordinate($F,$J._tempM0,$J._tempV31),$$F.add($J._tempV30,$J._tempV31,$J._tempV32),$$F.scale($J._tempV32,.5,$J._tempV32),$$F.subtract($J._tempV30,$J._tempV32,$J._tempV33);var $V=$J._tempV33.elements,$N=$V[0],$c=$V[1],$q=$V[2],$s=$J._tempV34.elements,$k=$s[0]=Math.abs($V[0]),$h=$s[1]=Math.abs($V[1]),$S=$s[2]=Math.abs($V[2]),$x=$J._tempV32.elements,$a=$x[0],$m=$x[1],$M=$x[2];return Math.abs($a)>$t+$k?0:Math.abs($m)>$p+$h?0:Math.abs($M)>$$+$S?0:Math.abs($m*$q-$M*$c)>$p*$S+$$*$h?0:Math.abs($a*$q-$M*$N)>$t*$S+$$*$k?0:Math.abs($a*$c-$m*$N)>$t*$h+$p*$k?0:2;},$R.containsBoundBox=function($R){var $F=0,$i=0,$j=$R.min,$t=$R.max;$R.getCorners($J._corners);var $p=this.containsPoints($J._corners);if(0!=$p)return $p;$$F.subtract($t,$j,$J._tempV30),$$F.scale($J._tempV30,.5,$J._tempV30),$$F.add($j,$J._tempV30,$J._tempV30),$$F.subtract($t,$J._tempV30,$J._tempV31);var $$=this.extents.elements,$V=$J._tempV31.elements;$J._getRows(this.transformation,$J._rows1),this.transformation.invert($J._tempM0);for($F=0;$F<3;$F++)for($i=0;$i<3;$i++)$J._tempM1.setElementByRowColumn($F,$i,Math.abs($J._tempM0.getElementByRowColumn($F,$i)));this.getCenter($J._tempV35),$$F.subtract($J._tempV30,$J._tempV35,$J._tempV32);var $N=$J._tempV31.elements;$N[0]=$$F.dot($J._tempV32,$J._rows1[0]),$N[1]=$$F.dot($J._tempV32,$J._rows1[1]),$N[2]=$$F.dot($J._tempV32,$J._rows1[2]);var $c=$J._tempV33.elements,$q=$J._tempV34.elements;for($F=0;$F<3;$F++)if($c[0]=$J._tempM1.getElementByRowColumn($F,0),$c[1]=$J._tempM1.getElementByRowColumn($F,1),$c[2]=$J._tempM1.getElementByRowColumn($F,2),$$[$F]+$$F.dot($J._tempV31,$J._tempV33)<Math.abs($N[$F]))return 0;for($i=0;$i<3;$i++)if($c[0]=$J._tempM1.getElementByRowColumn(0,$i),$c[1]=$J._tempM1.getElementByRowColumn(1,$i),$c[2]=$J._tempM1.getElementByRowColumn(2,$i),$q[0]=$J._tempM0.getElementByRowColumn(0,$i),$q[1]=$J._tempM0.getElementByRowColumn(1,$i),$q[2]=$J._tempM0.getElementByRowColumn(2,$i),$$F.dot(this.extents,$J._tempV33)+$V[$i]<Math.abs($$F.dot($J._tempV31,$J._tempV34)))return 0;for($F=0;$F<3;$F++)for($i=0;$i<3;$i++){var $s=($F+1)%3,$k=($F+2)%3,$h=($i+1)%3,$S=($i+2)%3;if($$[$s]*$J._tempM1.getElementByRowColumn($k,$i)+$$[$k]*$J._tempM1.getElementByRowColumn($s,$i)+($V[$h]*$J._tempM1.getElementByRowColumn($F,$S)+$V[$S]*$J._tempM1.getElementByRowColumn($F,$h))<Math.abs($N[$k]*$J._tempM0.getElementByRowColumn($s,$i)-$N[$s]*$J._tempM0.getElementByRowColumn($k,$i)))return 0;}return 2;},$R.intersectsRay=function($R,$F){$$F.scale(this.extents,-1,$J._tempV30),this.transformation.invert($J._tempM0),$$F.TransformNormal($R.direction,$J._tempM0,$J._ray.direction),$$F.transformCoordinate($R.origin,$J._tempM0,$J._ray.origin),$J._boxBound1.min=$J._tempV30,$J._boxBound1.max=this.extents;var $i=Collision.intersectsRayAndBoxRP($J._ray,$J._boxBound1,$F);return-1!==$i&&$$F.transformCoordinate($F,this.transformation,$F),$i;},$R._getLocalCorners=function($R){$R.length=8;var $F=this.extents.elements;$J._tempV30.x=$F[0],$J._tempV31.y=$F[1],$J._tempV32.z=$F[2],$$F.add($J._tempV30,$J._tempV31,$J._tempV33),$$F.add($J._tempV33,$J._tempV32,$R[0]),$$F.add($J._tempV30,$J._tempV31,$J._tempV33),$$F.subtract($J._tempV33,$J._tempV32,$R[1]),$$F.subtract($J._tempV31,$J._tempV30,$J._tempV33),$$F.subtract($J._tempV33,$J._tempV30,$R[2]),$$F.subtract($J._tempV31,$J._tempV30,$J._tempV33),$$F.add($J._tempV33,$J._tempV32,$R[3]),$$F.subtract($J._tempV30,$J._tempV31,$J._tempV33),$$F.add($J._tempV33,$J._tempV32,$R[4]),$$F.subtract($J._tempV30,$J._tempV31,$J._tempV33),$$F.subtract($J._tempV33,$J._tempV32,$R[5]),$$F.scale($R[0],-1,$R[6]),$$F.subtract($J._tempV32,$J._tempV30,$J._tempV33),$$F.subtract($J._tempV33,$J._tempV31,$R[7]);},$R.equals=function($R){return this.extents==$R.extents&&this.transformation==$R.transformation;},$R.cloneTo=function($R){var $F=$R;this.extents.cloneTo($F.extents),this.transformation.cloneTo($F.transformation);},$J.createByBoundBox=function($R,$F){var $i=$R.min,$j=$R.max;$$F.subtract($j,$i,$J._tempV30),$$F.scale($J._tempV30,.5,$J._tempV30),$$F.add($i,$J._tempV30,$J._tempV31),$$F.subtract($j,$J._tempV31,$J._tempV32),$RF.translation($J._tempV31,$J._tempM0);var $t=$J._tempV32.clone(),$p=$J._tempM0.clone();$F.extents=$t,$F.transformation=$p;},$J.createByMinAndMaxVertex=function($R,$F){return $$F.subtract($F,$R,$J._tempV30),$$F.scale($J._tempV30,.5,$J._tempV30),$$F.add($R,$J._tempV30,$J._tempV31),$$F.subtract($F,$J._tempV31,$J._tempV32),$RF.translation($J._tempV31,$J._tempM0),new $J($J._tempV32,$J._tempM0);},$J._getRows=function($R,$F){$F.length=3;var $i=$R.elements,$j=$F[0].elements;$j[0]=$i[0],$j[1]=$i[1],$j[2]=$i[2];var $t=$F[1].elements;$t[0]=$i[4],$t[1]=$i[5],$t[2]=$i[6];var $p=$F[2].elements;$p[0]=$i[8],$p[1]=$i[9],$p[2]=$i[10];},$J.getObbtoObbMatrix4x4=function($R,$F,$i,$j){var $t=$R.transformation,$p=$F.transformation;if($i){$J._getRows($t,$J._rows1),$J._getRows($p,$J._rows2);for(var $$=0;$$<3;$$++)for(var $V=0;$V<3;$V++)$j.setElementByRowColumn($$,$V,$$F.dot($J._rows2[$$],$J._rows1[$V]));$F.getCenter($J._tempV30),$R.getCenter($J._tempV31),$$F.subtract($J._tempV30,$J._tempV31,$J._tempV32);var $N=$j.elements;$N[12]=$$F.dot($J._tempV32,$J._rows1[0]),$N[13]=$$F.dot($J._tempV32,$J._rows1[1]),$N[14]=$$F.dot($J._tempV32,$J._rows1[2]),$N[15]=1;}else $t.invert($J._tempM0),$RF.multiply($p,$J._tempM0,$j);},$J.merge=function($R,$F,$i){var $j=$R.extents,$t=$R.transformation;$J.getObbtoObbMatrix4x4($R,$F,$i,$J._tempM0),$F._getLocalCorners($J._corners),$$F.transformCoordinate($J._corners[0],$J._tempM0,$J._corners[0]),$$F.transformCoordinate($J._corners[1],$J._tempM0,$J._corners[1]),$$F.transformCoordinate($J._corners[2],$J._tempM0,$J._corners[2]),$$F.transformCoordinate($J._corners[3],$J._tempM0,$J._corners[3]),$$F.transformCoordinate($J._corners[4],$J._tempM0,$J._corners[4]),$$F.transformCoordinate($J._corners[5],$J._tempM0,$J._corners[5]),$$F.transformCoordinate($J._corners[6],$J._tempM0,$J._corners[6]),$$F.transformCoordinate($J._corners[7],$J._tempM0,$J._corners[7]),$$F.scale($j,-1,$J._boxBound1.min),$j.cloneTo($J._boxBound1.max),$AR.createfromPoints($J._corners,$J._boxBound2),$AR.merge($J._boxBound2,$J._boxBound1,$J._boxBound3);var $p=$J._boxBound3.min,$$=$J._boxBound3.max;$$F.subtract($$,$p,$J._tempV30),$$F.scale($J._tempV30,.5,$J._tempV30),$$F.add($p,$J._tempV30,$J._tempV32),$$F.subtract($$,$J._tempV32,$j),$$F.transformCoordinate($J._tempV32,$t,$J._tempV33);},$s($J,["_tempV30",function(){return this._tempV30=new $$F();},"_tempV31",function(){return this._tempV31=new $$F();},"_tempV32",function(){return this._tempV32=new $$F();},"_tempV33",function(){return this._tempV33=new $$F();},"_tempV34",function(){return this._tempV34=new $$F();},"_tempV35",function(){return this._tempV35=new $$F();},"_tempV36",function(){return this._tempV36=new $$F();},"_tempM0",function(){return this._tempM0=new $RF();},"_tempM1",function(){return this._tempM1=new $RF();},"_corners",function(){return this._corners=[new $$F(),new $$F(),new $$F(),new $$F(),new $$F(),new $$F(),new $$F(),new $$F()];},"_rows1",function(){return this._rows1=[new $$F(),new $$F(),new $$F()];},"_rows2",function(){return this._rows2=[new $$F(),new $$F(),new $$F()];},"_ray",function(){return this._ray=new $tF(new $$F(),new $$F());},"_boxBound1",function(){return this._boxBound1=new $AR(new $$F(),new $$F());},"_boxBound2",function(){return this._boxBound2=new $AR(new $$F(),new $$F());},"_boxBound3",function(){return this._boxBound3=new $AR(new $$F(),new $$F());}]);}(),function(){function $w($R,$F){this.normal=null,this.distance=NaN,void 0===$F&&($F=0),this.normal=$R,this.distance=$F;}return $h($w,"laya.d3.math.Plane"),$w.prototype.normalize=function(){var $R=this.normal.elements,$F=$R[0],$i=$R[1],$j=$R[2],$t=1/Math.sqrt($F*$F+$i*$i+$j*$j);$R[0]=$F*$t,$R[1]=$i*$t,$R[2]=$j*$t,this.distance*=$t;},$w.createPlaneBy3P=function($R,$F,$i){var $j=$R.elements,$t=$F.elements,$p=$i.elements,$$=$t[0]-$j[0],$V=$t[1]-$j[1],$N=$t[2]-$j[2],$c=$p[0]-$j[0],$q=$p[1]-$j[1],$s=$p[2]-$j[2],$k=$V*$s-$N*$q,$h=$N*$c-$$*$s,$S=$$*$q-$V*$c,$x=1/Math.sqrt($k*$k+$h*$h+$S*$S),$a=$k*$x,$m=$h*$x,$M=$S*$x,$J=$w._TEMPVec3.elements;$J[0]=$a,$J[1]=$m,$J[2]=$M;var $d=-($a*$j[0]+$m*$j[1]+$M*$j[2]);return new $w($w._TEMPVec3,$d);},$w.PlaneIntersectionType_Back=0,$w.PlaneIntersectionType_Front=1,$w.PlaneIntersectionType_Intersecting=2,$s($w,["_TEMPVec3",function(){return this._TEMPVec3=new $$F();}]),$w;}()),$iF=function(){function $t($R,$F,$i,$j){this.elements=new Float32Array(4),void 0===$R&&($R=0),void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=1),this.elements[0]=$R,this.elements[1]=$F,this.elements[2]=$i,this.elements[3]=$j;}$h($t,"laya.d3.math.Quaternion");var $R=$t.prototype;return $w.imps($R,{"laya.d3.core.IClone":!0}),$R.scaling=function($R,$F){var $i=$F.elements,$j=this.elements;$i[0]=$j[0]*$R,$i[1]=$j[1]*$R,$i[2]=$j[2]*$R,$i[3]=$j[3]*$R;},$R.normalize=function($R){var $F=$R.elements,$i=this.elements,$j=$i[0],$t=$i[1],$p=$i[2],$$=$i[3],$V=$j*$j+$t*$t+$p*$p+$$*$$;0<$V&&($V=1/Math.sqrt($V),$F[0]=$j*$V,$F[1]=$t*$V,$F[2]=$p*$V,$F[3]=$$*$V);},$R.length=function(){var $R=this.elements,$F=$R[0],$i=$R[1],$j=$R[2],$t=$R[3];return Math.sqrt($F*$F+$i*$i+$j*$j+$t*$t);},$R.rotateX=function($R,$F){var $i=$F.elements,$j=this.elements;$R*=.5;var $t=$j[0],$p=$j[1],$$=$j[2],$V=$j[3],$N=Math.sin($R),$c=Math.cos($R);$i[0]=$t*$c+$V*$N,$i[1]=$p*$c+$$*$N,$i[2]=$$*$c-$p*$N,$i[3]=$V*$c-$t*$N;},$R.rotateY=function($R,$F){var $i=$F.elements,$j=this.elements;$R*=.5;var $t=$j[0],$p=$j[1],$$=$j[2],$V=$j[3],$N=Math.sin($R),$c=Math.cos($R);$i[0]=$t*$c-$$*$N,$i[1]=$p*$c+$V*$N,$i[2]=$$*$c+$t*$N,$i[3]=$V*$c-$p*$N;},$R.rotateZ=function($R,$F){var $i=$F.elements,$j=this.elements;$R*=.5;var $t=$j[0],$p=$j[1],$$=$j[2],$V=$j[3],$N=Math.sin($R),$c=Math.cos($R);$i[0]=$t*$c+$p*$N,$i[1]=$p*$c-$t*$N,$i[2]=$$*$c+$V*$N,$i[3]=$V*$c-$$*$N;},$R.getYawPitchRoll=function($R){$$F.transformQuat($$F.ForwardRH,this,$t.TEMPVector31),$$F.transformQuat($$F.Up,this,$t.TEMPVector32);var $F=$t.TEMPVector32.elements;$t.angleTo($$F.ZERO,$t.TEMPVector31,$t.TEMPVector33);var $i=$t.TEMPVector33.elements;$i[0]==Math.PI/2?($i[1]=$t.arcTanAngle($F[2],$F[0]),$i[2]=0):$i[0]==-Math.PI/2?($i[1]=$t.arcTanAngle(-$F[2],-$F[0]),$i[2]=0):($RF.createRotationY(-$i[1],$t.TEMPMatrix0),$RF.createRotationX(-$i[0],$t.TEMPMatrix1),$$F.transformCoordinate($t.TEMPVector32,$t.TEMPMatrix0,$t.TEMPVector32),$$F.transformCoordinate($t.TEMPVector32,$t.TEMPMatrix1,$t.TEMPVector32),$i[2]=$t.arcTanAngle($F[1],-$F[0])),$i[1]<=-Math.PI&&($i[1]=Math.PI),$i[2]<=-Math.PI&&($i[2]=Math.PI),$i[1]>=Math.PI&&$i[2]>=Math.PI&&($i[1]=0,$i[2]=0,$i[0]=Math.PI-$i[0]);var $j=$R.elements;$j[0]=$i[1],$j[1]=$i[0],$j[2]=$i[2];},$R.invert=function($R){var $F=$R.elements,$i=this.elements,$j=$i[0],$t=$i[1],$p=$i[2],$$=$i[3],$V=$j*$j+$t*$t+$p*$p+$$*$$,$N=$V?1/$V:0;$F[0]=-$j*$N,$F[1]=-$t*$N,$F[2]=-$p*$N,$F[3]=$$*$N;},$R.identity=function(){var $R=this.elements;$R[0]=0,$R[1]=0,$R[2]=0,$R[3]=1;},$R.fromArray=function($R,$F){void 0===$F&&($F=0),this.elements[0]=$R[$F+0],this.elements[1]=$R[$F+1],this.elements[2]=$R[$F+2],this.elements[3]=$R[$F+3];},$R.cloneTo=function($R){var $F,$i,$j;if(($i=this.elements)!==($j=$R.elements))for($F=0;$F<4;++$F)$j[$F]=$i[$F];},$R.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$R.equals=function($R){var $F=this.elements,$i=$R.elements;return $IR.nearEqual($F[0],$i[0])&&$IR.nearEqual($F[1],$i[1])&&$IR.nearEqual($F[2],$i[2])&&$IR.nearEqual($F[3],$i[3]);},$R.lengthSquared=function(){var $R=this.elements[0],$F=this.elements[1],$i=this.elements[2],$j=this.elements[3];return $R*$R+$F*$F+$i*$i+$j*$j;},$S(0,$R,"x",function(){return this.elements[0];}),$S(0,$R,"y",function(){return this.elements[1];}),$S(0,$R,"z",function(){return this.elements[2];}),$S(0,$R,"w",function(){return this.elements[3];}),$t.createFromYawPitchRoll=function($R,$F,$i,$j){var $t=.5*$i,$p=.5*$F,$$=.5*$R,$V=Math.sin($t),$N=Math.cos($t),$c=Math.sin($p),$q=Math.cos($p),$s=Math.sin($$),$k=Math.cos($$),$h=$j.elements;$h[0]=$k*$c*$N+$s*$q*$V,$h[1]=$s*$q*$N-$k*$c*$V,$h[2]=$k*$q*$V-$s*$c*$N,$h[3]=$k*$q*$N+$s*$c*$V;},$t.multiply=function($R,$F,$i){var $j=$R.elements,$t=$F.elements,$p=$i.elements,$$=$j[0],$V=$j[1],$N=$j[2],$c=$j[3],$q=$t[0],$s=$t[1],$k=$t[2],$h=$t[3],$S=$V*$k-$N*$s,$x=$N*$q-$$*$k,$a=$$*$s-$V*$q,$m=$$*$q+$V*$s+$N*$k;$p[0]=$$*$h+$q*$c+$S,$p[1]=$V*$h+$s*$c+$x,$p[2]=$N*$h+$k*$c+$a,$p[3]=$c*$h-$m;},$t.arcTanAngle=function($R,$F){return 0==$R?1==$F?Math.PI/2:-Math.PI/2:0<$R?Math.atan($F/$R):$R<0?0<$F?Math.atan($F/$R)+Math.PI:Math.atan($F/$R)-Math.PI:0;},$t.angleTo=function($R,$F,$i){$$F.subtract($F,$R,$t.TEMPVector30),$$F.normalize($t.TEMPVector30,$t.TEMPVector30),$i.elements[0]=Math.asin($t.TEMPVector30.y),$i.elements[1]=$t.arcTanAngle(-$t.TEMPVector30.z,-$t.TEMPVector30.x);},$t.createFromAxisAngle=function($R,$F,$i){var $j=$i.elements,$t=$R.elements;$F*=.5;var $p=Math.sin($F);$j[0]=$p*$t[0],$j[1]=$p*$t[1],$j[2]=$p*$t[2],$j[3]=Math.cos($F);},$t.createFromMatrix3x3=function($R,$F){var $i,$j=$F.elements,$t=$R.elements,$p=$t[0]+$t[4]+$t[8];if(0<$p)$i=Math.sqrt($p+1),$j[3]=.5*$i,$i=.5/$i,$j[0]=($t[5]-$t[7])*$i,$j[1]=($t[6]-$t[2])*$i,$j[2]=($t[1]-$t[3])*$i;else{var $$=0;$t[4]>$t[0]&&($$=1),$t[8]>$t[3*$$+$$]&&($$=2);var $V=($$+1)%3,$N=($$+2)%3;$i=Math.sqrt($t[3*$$+$$]-$t[3*$V+$V]-$t[3*$N+$N]+1),$j[$$]=.5*$i,$i=.5/$i,$j[3]=($t[3*$V+$N]-$t[3*$N+$V])*$i,$j[$V]=($t[3*$V+$$]+$t[3*$$+$V])*$i,$j[$N]=($t[3*$N+$$]+$t[3*$$+$N])*$i;}},$t.createFromMatrix4x4=function($R,$F){var $i,$j,$t=$R.elements,$p=$F.elements,$$=$t[0]+$t[5]+$t[10];0<$$?($i=Math.sqrt($$+1),$p[3]=.5*$i,$i=.5/$i,$p[0]=($t[6]-$t[9])*$i,$p[1]=($t[8]-$t[2])*$i,$p[2]=($t[1]-$t[4])*$i):$t[0]>=$t[5]&&$t[0]>=$t[10]?($j=.5/($i=Math.sqrt(1+$t[0]-$t[5]-$t[10])),$p[0]=.5*$i,$p[1]=($t[1]+$t[4])*$j,$p[2]=($t[2]+$t[8])*$j,$p[3]=($t[6]-$t[9])*$j):$t[5]>$t[10]?($j=.5/($i=Math.sqrt(1+$t[5]-$t[0]-$t[10])),$p[0]=($t[4]+$t[1])*$j,$p[1]=.5*$i,$p[2]=($t[9]+$t[6])*$j,$p[3]=($t[8]-$t[2])*$j):($j=.5/($i=Math.sqrt(1+$t[10]-$t[0]-$t[5])),$p[0]=($t[8]+$t[2])*$j,$p[1]=($t[9]+$t[6])*$j,$p[2]=.5*$i,$p[3]=($t[1]-$t[4])*$j);},$t.slerp=function($R,$F,$i,$j){var $t,$p,$$,$V,$N,$c=$R.elements,$q=$F.elements,$s=$j.elements,$k=$c[0],$h=$c[1],$S=$c[2],$x=$c[3],$a=$q[0],$m=$q[1],$M=$q[2],$J=$q[3];return($p=$k*$a+$h*$m+$S*$M+$x*$J)<0&&($p=-$p,$a=-$a,$m=-$m,$M=-$M,$J=-$J),$N=1e-6<1-$p?($t=Math.acos($p),$$=Math.sin($t),$V=Math.sin((1-$i)*$t)/$$,Math.sin($i*$t)/$$):($V=1-$i,$i),$s[0]=$V*$k+$N*$a,$s[1]=$V*$h+$N*$m,$s[2]=$V*$S+$N*$M,$s[3]=$V*$x+$N*$J,$s;},$t.lerp=function($R,$F,$i,$j){var $t=$j.elements,$p=$R.elements,$$=$F.elements,$V=$p[0],$N=$p[1],$c=$p[2],$q=$p[3];$t[0]=$V+$i*($$[0]-$V),$t[1]=$N+$i*($$[1]-$N),$t[2]=$c+$i*($$[2]-$c),$t[3]=$q+$i*($$[3]-$q);},$t.add=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements;$j[0]=$t[0]+$p[0],$j[1]=$t[1]+$p[1],$j[2]=$t[2]+$p[2],$j[3]=$t[3]+$p[3];},$t.dot=function($R,$F){var $i=$R.elements,$j=$F.elements;return $i[0]*$j[0]+$i[1]*$j[1]+$i[2]*$j[2]+$i[3]*$j[3];},$t.rotationLookAt=function($R,$F,$i){$t.lookAt($$F.ZERO,$R,$F,$i);},$t.lookAt=function($R,$F,$i,$j){$DR.lookAt($R,$F,$i,$t._tempMatrix3x3),$t.rotationMatrix($t._tempMatrix3x3,$j);},$t.invert=function($R,$F){var $i=$R.elements,$j=$F.elements,$t=$R.lengthSquared();$IR.isZero($t)||($t=1/$t,$j[0]=-$i[0]*$t,$j[1]=-$i[1]*$t,$j[2]=-$i[2]*$t,$j[3]=$i[3]*$t);},$t.rotationMatrix=function($R,$F){var $i=$R.elements,$j=$i[0],$t=$i[1],$p=$i[2],$$=$i[3],$V=$i[4],$N=$i[5],$c=$i[6],$q=$i[7],$s=$i[8],$k=$F.elements,$h=NaN,$S=NaN,$x=$j+$V+$s;0<$x?($h=Math.sqrt($x+1),$k[3]=.5*$h,$h=.5/$h,$k[0]=($N-$q)*$h,$k[1]=($c-$p)*$h,$k[2]=($t-$$)*$h):$V<=$j&&$s<=$j?($S=.5/($h=Math.sqrt(1+$j-$V-$s)),$k[0]=.5*$h,$k[1]=($t+$$)*$S,$k[2]=($p+$c)*$S,$k[3]=($N-$q)*$S):$s<$V?($S=.5/($h=Math.sqrt(1+$V-$j-$s)),$k[0]=($$+$t)*$S,$k[1]=.5*$h,$k[2]=($q+$N)*$S,$k[3]=($c-$p)*$S):($S=.5/($h=Math.sqrt(1+$s-$j-$V)),$k[0]=($c+$p)*$S,$k[1]=($q+$N)*$S,$k[2]=.5*$h,$k[3]=($t-$$)*$S);},$t.DEFAULT=new $t(),$s($t,["TEMPVector30",function(){return this.TEMPVector30=new $$F();},"TEMPVector31",function(){return this.TEMPVector31=new $$F();},"TEMPVector32",function(){return this.TEMPVector32=new $$F();},"TEMPVector33",function(){return this.TEMPVector33=new $$F();},"TEMPMatrix0",function(){return this.TEMPMatrix0=new $RF();},"TEMPMatrix1",function(){return this.TEMPMatrix1=new $RF();},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new $DR();},"NAN",function(){return this.NAN=new $t(NaN,NaN,NaN,NaN);}]),$t;}(),$jF=function(){function $R($R){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=$R,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1;}$h($R,"laya.d3.math.Rand");var $F=$R.prototype;return $F.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3];},$F.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607);},$F.getSignedFloat=function(){return 2*this.getFloat()-1;},$S(0,$F,"seed",function(){return this.seeds[0];},function($R){this.seeds[0]=$R,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1;}),$R.getFloatFromInt=function($R){return 1/8388607*(8388607&$R);},$R.getByteFromInt=function($R){return(8388607&$R)>>>15;},$R;}(),$tF=(function(){function $t($R){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!($R instanceof Array)||4!==$R.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|$R[0],this._state0L=0|$R[1],this._state1U=0|$R[2],this._state1L=0|$R[3];}$h($t,"laya.d3.math.RandX");var $R=$t.prototype;$R.randomint=function(){var $R=this._state0U,$F=this._state0L,$i=this._state1U,$j=this._state1L,$t=($j>>>0)+($F>>>0),$p=$i+$R+($t/2>>>31)>>>0,$$=$t>>>0,$V=0,$N=0;$V=($R^=$V=$R<<23|(-512&$F)>>>9)^(this._state0U=$i),$N=($F^=$N=$F<<23)^(this._state0L=$j);$V^=$R>>>18,$N^=$F>>>18|(262143&$R)<<14;return $V^=$i>>>5,$N^=$j>>>5|(31&$i)<<27,this._state1U=$V,this._state1L=$N,[$p,$$];},$R.random=function(){var $R=this.randomint(),$F=$R[0],$i=1023<<20|$F>>>12,$j=0|($R[1]>>>12|(4095&$F)<<20);return $t._CONVERTION_BUFFER.setUint32(0,$i,!1),$t._CONVERTION_BUFFER.setUint32(4,$j,!1),$jF._CONVERTION_BUFFER.getFloat64(0,!1)-1;},$s($t,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8));},"defaultRand",function(){return this.defaultRand=new $jF([0,Date.now()/65536,0,Date.now()%65536]);}]);}(),function(){function $R($R,$F){this.origin=null,this.direction=null,this.origin=$R,this.direction=$F;}return $h($R,"laya.d3.math.Ray"),$R;}()),$pF=function(){function $R($R,$F){this.elements=new Float32Array(2),void 0===$R&&($R=0),void 0===$F&&($F=0);var $i=this.elements;$i[0]=$R,$i[1]=$F;}$h($R,"laya.d3.math.Vector2");var $F=$R.prototype;return $w.imps($F,{"laya.d3.core.IClone":!0}),$F.fromArray=function($R,$F){void 0===$F&&($F=0),this.elements[0]=$R[$F+0],this.elements[1]=$R[$F+1];},$F.cloneTo=function($R){var $F=$R.elements,$i=this.elements;$F[0]=$i[0],$F[1]=$i[1];},$F.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$F,"x",function(){return this.elements[0];},function($R){this.elements[0]=$R;}),$S(0,$F,"y",function(){return this.elements[1];},function($R){this.elements[1]=$R;}),$R.scale=function($R,$F,$i){var $j=$i.elements,$t=$R.elements;$j[0]=$t[0]*$F,$j[1]=$t[1]*$F;},$s($R,["ZERO",function(){return this.ZERO=new $R(0,0);},"ONE",function(){return this.ONE=new $R(1,1);}]),$R;}(),$$F=function(){function $q($R,$F,$i){this.elements=new Float32Array(3),void 0===$R&&($R=0),void 0===$F&&($F=0),void 0===$i&&($i=0);var $j=this.elements;$j[0]=$R,$j[1]=$F,$j[2]=$i;}$h($q,"laya.d3.math.Vector3");var $R=$q.prototype;return $w.imps($R,{"laya.d3.core.IClone":!0}),$R.fromArray=function($R,$F){void 0===$F&&($F=0),this.elements[0]=$R[$F+0],this.elements[1]=$R[$F+1],this.elements[2]=$R[$F+2];},$R.cloneTo=function($R){var $F=$R.elements,$i=this.elements;$F[0]=$i[0],$F[1]=$i[1],$F[2]=$i[2];},$R.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$R.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0;},$R.reset=function($R,$F,$i){this.elements[0]=$R,this.elements[1]=$F,this.elements[2]=$i;},$S(0,$R,"x",function(){return this.elements[0];},function($R){this.elements[0]=$R;}),$S(0,$R,"y",function(){return this.elements[1];},function($R){this.elements[1]=$R;}),$S(0,$R,"z",function(){return this.elements[2];},function($R){this.elements[2]=$R;}),$q.distanceSquared=function($R,$F){var $i=$R.elements,$j=$F.elements,$t=$i[0]-$j[0],$p=$i[1]-$j[1],$$=$i[2]-$j[2];return $t*$t+$p*$p+$$*$$;},$q.distance=function($R,$F){var $i=$R.elements,$j=$F.elements,$t=$i[0]-$j[0],$p=$i[1]-$j[1],$$=$i[2]-$j[2];return Math.sqrt($t*$t+$p*$p+$$*$$);},$q.min=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements;$j[0]=Math.min($t[0],$p[0]),$j[1]=Math.min($t[1],$p[1]),$j[2]=Math.min($t[2],$p[2]);},$q.max=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements;$j[0]=Math.max($t[0],$p[0]),$j[1]=Math.max($t[1],$p[1]),$j[2]=Math.max($t[2],$p[2]);},$q.transformQuat=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements,$$=$t[0],$V=$t[1],$N=$t[2],$c=$p[0],$q=$p[1],$s=$p[2],$k=$p[3],$h=$k*$$+$q*$N-$s*$V,$S=$k*$V+$s*$$-$c*$N,$x=$k*$N+$c*$V-$q*$$,$a=-$c*$$-$q*$V-$s*$N;$j[0]=$h*$k+$a*-$c+$S*-$s-$x*-$q,$j[1]=$S*$k+$a*-$q+$x*-$c-$h*-$s,$j[2]=$x*$k+$a*-$s+$h*-$q-$S*-$c;},$q.scalarLength=function($R){var $F=$R.elements,$i=$F[0],$j=$F[1],$t=$F[2];return Math.sqrt($i*$i+$j*$j+$t*$t);},$q.scalarLengthSquared=function($R){var $F=$R.elements,$i=$F[0],$j=$F[1],$t=$F[2];return $i*$i+$j*$j+$t*$t;},$q.normalize=function($R,$F){var $i=$R.elements,$j=$F.elements,$t=$i[0],$p=$i[1],$$=$i[2],$V=$t*$t+$p*$p+$$*$$;0<$V&&($V=1/Math.sqrt($V),$j[0]=$i[0]*$V,$j[1]=$i[1]*$V,$j[2]=$i[2]*$V);},$q.multiply=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements;$j[0]=$t[0]*$p[0],$j[1]=$t[1]*$p[1],$j[2]=$t[2]*$p[2];},$q.scale=function($R,$F,$i){var $j=$i.elements,$t=$R.elements;$j[0]=$t[0]*$F,$j[1]=$t[1]*$F,$j[2]=$t[2]*$F;},$q.lerp=function($R,$F,$i,$j){var $t=$j.elements,$p=$R.elements,$$=$F.elements,$V=$p[0],$N=$p[1],$c=$p[2];$t[0]=$V+$i*($$[0]-$V),$t[1]=$N+$i*($$[1]-$N),$t[2]=$c+$i*($$[2]-$c);},$q.transformV3ToV3=function($R,$F,$i){var $j=$q._tempVector4;$q.transformV3ToV4($R,$F,$j);var $t=$j.elements,$p=$i.elements;$p[0]=$t[0],$p[1]=$t[1],$p[2]=$t[2];},$q.transformV3ToV4=function($R,$F,$i){var $j=$R.elements,$t=$j[0],$p=$j[1],$$=$j[2],$V=$F.elements,$N=$i.elements;$N[0]=$t*$V[0]+$p*$V[4]+$$*$V[8]+$V[12],$N[1]=$t*$V[1]+$p*$V[5]+$$*$V[9]+$V[13],$N[2]=$t*$V[2]+$p*$V[6]+$$*$V[10]+$V[14],$N[3]=$t*$V[3]+$p*$V[7]+$$*$V[11]+$V[15];},$q.TransformNormal=function($R,$F,$i){var $j=$R.elements,$t=$j[0],$p=$j[1],$$=$j[2],$V=$F.elements,$N=$i.elements;$N[0]=$t*$V[0]+$p*$V[4]+$$*$V[8],$N[1]=$t*$V[1]+$p*$V[5]+$$*$V[9],$N[2]=$t*$V[2]+$p*$V[6]+$$*$V[10];},$q.transformCoordinate=function($R,$F,$i){var $j=$q._tempVector4.elements,$t=$R.elements,$p=$t[0],$$=$t[1],$V=$t[2],$N=$F.elements;$j[0]=$p*$N[0]+$$*$N[4]+$V*$N[8]+$N[12],$j[1]=$p*$N[1]+$$*$N[5]+$V*$N[9]+$N[13],$j[2]=$p*$N[2]+$$*$N[6]+$V*$N[10]+$N[14],$j[3]=1/($p*$N[3]+$$*$N[7]+$V*$N[11]+$N[15]);var $c=$i.elements;$c[0]=$j[0]*$j[3],$c[1]=$j[1]*$j[3],$c[2]=$j[2]*$j[3];},$q.Clamp=function($R,$F,$i,$j){var $t=$R.elements,$p=$t[0],$$=$t[1],$V=$t[2],$N=$F.elements,$c=$N[0],$q=$N[1],$s=$N[2],$k=$i.elements,$h=$k[0],$S=$k[1],$x=$k[2],$a=$j.elements;$p=($p=$h<$p?$h:$p)<$c?$c:$p,$$=($$=$S<$$?$S:$$)<$q?$q:$$,$V=($V=$x<$V?$x:$V)<$s?$s:$V,$a[0]=$p,$a[1]=$$,$a[2]=$V;},$q.add=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements;$j[0]=$t[0]+$p[0],$j[1]=$t[1]+$p[1],$j[2]=$t[2]+$p[2];},$q.subtract=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements;$j[0]=$t[0]-$p[0],$j[1]=$t[1]-$p[1],$j[2]=$t[2]-$p[2];},$q.cross=function($R,$F,$i){var $j=$R.elements,$t=$F.elements,$p=$i.elements,$$=$j[0],$V=$j[1],$N=$j[2],$c=$t[0],$q=$t[1],$s=$t[2];$p[0]=$V*$s-$N*$q,$p[1]=$N*$c-$$*$s,$p[2]=$$*$q-$V*$c;},$q.dot=function($R,$F){var $i=$R.elements,$j=$F.elements;return $i[0]*$j[0]+$i[1]*$j[1]+$i[2]*$j[2];},$q.equals=function($R,$F){var $i=$R.elements,$j=$F.elements;return $IR.nearEqual(Math.abs($i[0]),Math.abs($j[0]))&&$IR.nearEqual(Math.abs($i[1]),Math.abs($j[1]))&&$IR.nearEqual(Math.abs($i[2]),Math.abs($j[2]));},$q.ZERO=new $q(0,0,0),$q.ONE=new $q(1,1,1),$q.NegativeUnitX=new $q(-1,0,0),$q.UnitX=new $q(1,0,0),$q.UnitY=new $q(0,1,0),$q.UnitZ=new $q(0,0,1),$q.ForwardRH=new $q(0,0,-1),$q.ForwardLH=new $q(0,0,1),$q.Up=new $q(0,1,0),$q.NAN=new $q(NaN,NaN,NaN),$s($q,["_tempVector4",function(){return this._tempVector4=new $VF();}]),$q;}(),$VF=function(){function $R($R,$F,$i,$j){this.elements=new Float32Array(4),void 0===$R&&($R=0),void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=0);var $t=this.elements;$t[0]=$R,$t[1]=$F,$t[2]=$i,$t[3]=$j;}$h($R,"laya.d3.math.Vector4");var $F=$R.prototype;return $w.imps($F,{"laya.d3.core.IClone":!0}),$F.fromArray=function($R,$F){void 0===$F&&($F=0),this.elements[0]=$R[$F+0],this.elements[1]=$R[$F+1],this.elements[2]=$R[$F+2],this.elements[3]=$R[$F+3];},$F.cloneTo=function($R){var $F=$R.elements,$i=this.elements;$F[0]=$i[0],$F[1]=$i[1],$F[2]=$i[2],$F[3]=$i[3];},$F.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$F.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);},$F.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;},$S(0,$F,"x",function(){return this.elements[0];},function($R){this.elements[0]=$R;}),$S(0,$F,"y",function(){return this.elements[1];},function($R){this.elements[1]=$R;}),$S(0,$F,"z",function(){return this.elements[2];},function($R){this.elements[2]=$R;}),$S(0,$F,"w",function(){return this.elements[3];},function($R){this.elements[3]=$R;}),$R.lerp=function($R,$F,$i,$j){var $t=$j.elements,$p=$R.elements,$$=$F.elements,$V=$p[0],$N=$p[1],$c=$p[2],$q=$p[3];$t[0]=$V+$i*($$[0]-$V),$t[1]=$N+$i*($$[1]-$N),$t[2]=$c+$i*($$[2]-$c),$t[3]=$q+$i*($$[3]-$q);},$R.transformByM4x4=function($R,$F,$i){var $j=$R.elements,$t=$j[0],$p=$j[1],$$=$j[2],$V=$j[3],$N=$F.elements,$c=$i.elements;$c[0]=$t*$N[0]+$p*$N[4]+$$*$N[8]+$V*$N[12],$c[1]=$t*$N[1]+$p*$N[5]+$$*$N[9]+$V*$N[13],$c[2]=$t*$N[2]+$p*$N[6]+$$*$N[10]+$V*$N[14],$c[3]=$t*$N[3]+$p*$N[7]+$$*$N[11]+$V*$N[15];},$R.equals=function($R,$F){var $i=$R.elements,$j=$F.elements;return $IR.nearEqual(Math.abs($i[0]),Math.abs($j[0]))&&$IR.nearEqual(Math.abs($i[1]),Math.abs($j[1]))&&$IR.nearEqual(Math.abs($i[2]),Math.abs($j[2]))&&$IR.nearEqual(Math.abs($i[3]),Math.abs($j[3]));},$R.normalize=function($R,$F){var $i=$R.elements,$j=$F.elements,$t=$R.length();0<$t&&($j[0]=$i[0]*$t,$j[1]=$i[1]*$t,$j[2]=$i[2]*$t,$j[3]=$i[3]*$t);},$R.add=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements;$j[0]=$t[0]+$p[0],$j[1]=$t[1]+$p[1],$j[2]=$t[2]+$p[2],$j[3]=$t[3]+$p[3];},$R.subtract=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements;$j[0]=$t[0]-$p[0],$j[1]=$t[1]-$p[1],$j[2]=$t[2]-$p[2],$j[3]=$t[3]-$p[3];},$R.multiply=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements;$j[0]=$t[0]*$p[0],$j[1]=$t[1]*$p[1],$j[2]=$t[2]*$p[2],$j[3]=$t[3]*$p[3];},$R.scale=function($R,$F,$i){var $j=$i.elements,$t=$R.elements;$j[0]=$t[0]*$F,$j[1]=$t[1]*$F,$j[2]=$t[2]*$F,$j[3]=$t[3]*$F;},$R.Clamp=function($R,$F,$i,$j){var $t=$R.elements,$p=$t[0],$$=$t[1],$V=$t[2],$N=$t[3],$c=$F.elements,$q=$c[0],$s=$c[1],$k=$c[2],$h=$c[3],$S=$i.elements,$x=$S[0],$a=$S[1],$m=$S[2],$M=$S[3],$J=$j.elements;$p=($p=$x<$p?$x:$p)<$q?$q:$p,$$=($$=$a<$$?$a:$$)<$s?$s:$$,$V=($V=$m<$V?$m:$V)<$k?$k:$V,$N=($N=$M<$N?$M:$N)<$h?$h:$N,$J[0]=$p,$J[1]=$$,$J[2]=$V,$J[3]=$N;},$R.distanceSquared=function($R,$F){var $i=$R.elements,$j=$F.elements,$t=$i[0]-$j[0],$p=$i[1]-$j[1],$$=$i[2]-$j[2],$V=$i[3]-$j[3];return $t*$t+$p*$p+$$*$$+$V*$V;},$R.distance=function($R,$F){var $i=$R.elements,$j=$F.elements,$t=$i[0]-$j[0],$p=$i[1]-$j[1],$$=$i[2]-$j[2],$V=$i[3]-$j[3];return Math.sqrt($t*$t+$p*$p+$$*$$+$V*$V);},$R.dot=function($R,$F){var $i=$R.elements,$j=$F.elements;return $i[0]*$j[0]+$i[1]*$j[1]+$i[2]*$j[2]+$i[3]*$j[3];},$R.min=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements;$j[0]=Math.min($t[0],$p[0]),$j[1]=Math.min($t[1],$p[1]),$j[2]=Math.min($t[2],$p[2]),$j[3]=Math.min($t[3],$p[3]);},$R.max=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F.elements;$j[0]=Math.max($t[0],$p[0]),$j[1]=Math.max($t[1],$p[1]),$j[2]=Math.max($t[2],$p[2]),$j[3]=Math.max($t[3],$p[3]);},$s($R,["ZERO",function(){return this.ZERO=new $R();},"ONE",function(){return this.ONE=new $R(1,1,1,1);},"UnitX",function(){return this.UnitX=new $R(1,0,0,0);},"UnitY",function(){return this.UnitY=new $R(0,1,0,0);},"UnitZ",function(){return this.UnitZ=new $R(0,0,1,0);},"UnitW",function(){return this.UnitW=new $R(0,0,0,1);}]),$R;}(),$NF=function(){function $p($R,$F,$i,$j){this.minDepth=0,this.maxDepth=1,this.x=$R,this.y=$F,this.width=$i,this.height=$j;}$h($p,"laya.d3.math.Viewport");var $R=$p.prototype;return $R.project=function($R,$F,$i){$$F.transformV3ToV3($R,$F,$i);var $j=$R.elements,$t=$F.elements,$p=$i.elements,$$=$j[0]*$t[3]+$j[1]*$t[7]+$j[2]*$t[11]+$t[15];1!==$$&&($p[0]=$p[0]/$$,$p[1]=$p[1]/$$,$p[2]=$p[2]/$$),$p[0]=.5*($p[0]+1)*this.width+this.x,$p[1]=.5*(1-$p[1])*this.height+this.y,$p[2]=$p[2]*(this.maxDepth-this.minDepth)+this.minDepth;},$R.unprojectFromMat=function($R,$F,$i){var $j=$R.elements,$t=$F.elements,$p=$i.elements;$p[0]=($j[0]-this.x)/this.width*2-1,$p[1]=-(($j[1]-this.y)/this.height*2-1);var $$=(this.maxDepth-this.minDepth)/2;$p[2]=($j[2]-this.minDepth-$$)/$$;var $V=$p[0]*$t[3]+$p[1]*$t[7]+$p[2]*$t[11]+$t[15];$$F.transformV3ToV3($i,$F,$i),1!==$V&&($p[0]=$p[0]/$V,$p[1]=$p[1]/$V,$p[2]=$p[2]/$V);},$R.unprojectFromWVP=function($R,$F,$i,$j,$t){$RF.multiply($F,$i,$p._tempMatrix4x4),$j&&$RF.multiply($p._tempMatrix4x4,$j,$p._tempMatrix4x4),$p._tempMatrix4x4.invert($p._tempMatrix4x4),this.unprojectFromMat($R,$p._tempMatrix4x4,$t);},$s($p,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $RF();}]),$p;}(),$cF=function(){function $z($R){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=$R,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[];}$h($z,"laya.d3.resource.models.SubMesh");var $R=$z.prototype;return $w.imps($R,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$R._getVertexBuffer=function($R){return void 0===$R&&($R=0),0===$R?this._vertexBuffer:null;},$R._getIndexBuffer=function(){return this._indexBuffer;},$R._getStaticBatchBakedVertexs=function($R,$F){var $i,$j,$t=this._vertexBuffer,$p=$t.vertexDeclaration,$$=$p.getVertexElementByUsage(0).offset/4,$V=$p.getVertexElementByUsage(3).offset/4,$N=$F.meshRender.lightmapScaleOffset,$c=0,$q=0,$s=0,$k=0,$h=0,$S=0;if($N){if($j=$p.getVertexElementByUsage(15))$s=$p.vertexStride/4,$i=0<this._vertexCount?$t.getData().slice(this._vertexStart*$s,(this._vertexStart+this._vertexCount)*$s):$t.getData().slice(),$k=$j.offset/4;else{$s=($S=$p.vertexStride/4)+2,$i=this._vertexCount?new Float32Array(this._vertexCount*($t.vertexDeclaration.vertexStride/4+2)):new Float32Array($t.vertexCount*($t.vertexDeclaration.vertexStride/4+2)),$k=($h=$p.getVertexElementByUsage(2).offset/4)+2;var $x=$t.getData();for($c=0,$q=$x.length/$S;$c<$q;$c++){var $a=0;$a=0<this._vertexCount?(this._vertexStart+$c)*$S:$c*$S;var $m=$c*$s,$M=0;for($M=0;$M<$k;$M++)$i[$m+$M]=$x[$a+$M];for($M=$k;$M<$S;$M++)$i[$m+$M+2]=$x[$a+$M];}}}else $s=$p.vertexStride/4,$i=this._vertexCount?$t.getData().slice(this._vertexStart*$s,(this._vertexStart+this._vertexCount)*$s):$t.getData().slice();if($R){var $J=$R.worldMatrix,$d=$z._tempMatrix4x40;$J.invert($d);var $w=$z._tempMatrix4x41,$X=$F.transform.worldMatrix;$RF.multiply($d,$X,$w);}else $w=$F.transform.worldMatrix;var $H=$z._tempQuaternion0;for($w.decomposeTransRotScale($z._tempVector30,$H,$z._tempVector31),$c=0,$q=$i.length/$s;$c<$q;$c++){var $_=$c*$s+$$,$T=$c*$s+$V;if($aF.transformVector3ArrayToVector3ArrayCoordinate($i,$_,$w,$i,$_),$aF.transformVector3ArrayByQuat($i,$T,$H,$i,$T),$N){var $g=$c*$s+$k;if($j)$aF.transformLightingMapTexcoordByUV1Array($i,$g,$N,$i,$g);else{var $B=$c*$S+$h;$aF.transformLightingMapTexcoordByUV0Array($x,$B,$N,$i,$g);}}}return $i;},$R._getVertexBuffers=function(){return null;},$R._beforeRender=function($R){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0;},$R._render=function($R){var $F,$i=0,$j=$R.renderElement;if(1<this._indexCount){var $t=this._boneIndicesList.length;if(1<$t){for(var $p=0;$p<$t;$p++)($F=$j._skinAnimationDatas||this._skinAnimationDatas)&&($j._shaderValue.setValue(0,$F[$p]),$R._shader.uploadRenderElementUniforms($j._shaderValue.data)),$L.mainContext.drawElements(4,this._subIndexBufferCount[$p],5123,2*this._subIndexBufferStart[$p]);$_.drawCall+=$t;}else($F=$j._skinAnimationDatas||this._skinAnimationDatas)&&($j._shaderValue.setValue(0,$F[0]),$R._shader.uploadRenderElementUniforms($j._shaderValue.data)),$L.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),$_.drawCall++;$i=this._indexCount;}else $i=this._indexBuffer.indexCount,($F=$j._skinAnimationDatas||this._skinAnimationDatas)&&($j._shaderValue.setValue(0,$F[0]),$R._shader.uploadRenderElementUniforms($j._shaderValue.data)),$L.mainContext.drawElements(4,$i,5123,0),$_.drawCall++;$_.trianglesFaces+=$i/3;},$R.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData();},$R.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null;},$S(0,$R,"_vertexBufferCount",function(){return 1;}),$S(0,$R,"triangleCount",function(){return this._indexBuffer.indexCount/3;}),$s($z,["_tempVector30",function(){return this._tempVector30=new $$F();},"_tempVector31",function(){return this._tempVector31=new $$F();},"_tempQuaternion0",function(){return this._tempQuaternion0=new $iF();},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new $RF();},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new $RF();}]),$z;}(),$qF=function(){function $R($R){this.defineCounter=0,this.defines=null,$R?(this.defineCounter=$R.defineCounter,this.defines=$R.defines.slice()):(this.defineCounter=0,this.defines=[]);}return $h($R,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),$R.prototype.registerDefine=function($R){var $F=Math.pow(2,this.defineCounter++);return this.defines[$F]=$R,$F;},$R;}(),$sF=function(){function $R(){}return $h($R,"laya.d3.shader.ShaderInit3D"),$R.__init__=function(){var $R,$F;$_F._globalRegDefine("HIGHPRECISION",$_F.SHADERDEFINE_HIGHPRECISION),$_F._globalRegDefine("FOG",$_F.SHADERDEFINE_FOG),$_F._globalRegDefine("DIRECTIONLIGHT",$_F.SHADERDEFINE_DIRECTIONLIGHT),$_F._globalRegDefine("POINTLIGHT",$_F.SHADERDEFINE_POINTLIGHT),$_F._globalRegDefine("SPOTLIGHT",$_F.SHADERDEFINE_SPOTLIGHT),$_F._globalRegDefine("UV",$_F.SHADERDEFINE_UV0),$_F._globalRegDefine("COLOR",$_F.SHADERDEFINE_COLOR),$_F._globalRegDefine("UV1",$_F.SHADERDEFINE_UV1),$_F._globalRegDefine("CASTSHADOW",$hF.SHADERDEFINE_CAST_SHADOW),$_F._globalRegDefine("SHADOWMAP_PSSM1",$hF.SHADERDEFINE_SHADOW_PSSM1),$_F._globalRegDefine("SHADOWMAP_PSSM2",$hF.SHADERDEFINE_SHADOW_PSSM2),$_F._globalRegDefine("SHADOWMAP_PSSM3",$hF.SHADERDEFINE_SHADOW_PSSM3),$_F._globalRegDefine("SHADOWMAP_PCF_NO",$hF.SHADERDEFINE_SHADOW_PCF_NO),$_F._globalRegDefine("SHADOWMAP_PCF1",$hF.SHADERDEFINE_SHADOW_PCF1),$_F._globalRegDefine("SHADOWMAP_PCF2",$hF.SHADERDEFINE_SHADOW_PCF2),$_F._globalRegDefine("SHADOWMAP_PCF3",$hF.SHADERDEFINE_SHADOW_PCF3),$_F._globalRegDefine("DEPTHFOG",$_F.SAHDERDEFINE_DEPTHFOG),$KF.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),$KF.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),$R={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},$F={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var $i=$KF.nameKey.add("SIMPLE");shaderCompile=$_F.add($i,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',$R,$F),$eF.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),$eF.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),$eF.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),$eF.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),$eF.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),$eF.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),$eF.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),$eF.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),$eF.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG");},$R;}(),$kF=function(){function $R(){this._data=null,this._data=[];}$h($R,"laya.d3.shader.ValusArray");var $F=$R.prototype;return $F.setValue=function($R,$F){this._data[$R]=$F;},$S(0,$F,"data",function(){return this._data;}),$R;}(),$hF=function(){function $R(){}return $R.SHADERDEFINE_RECEIVE_SHADOW=1,$R.SHADERDEFINE_CAST_SHADOW=512,$R.SHADERDEFINE_SHADOW_PSSM1=1024,$R.SHADERDEFINE_SHADOW_PSSM2=2048,$R.SHADERDEFINE_SHADOW_PSSM3=4096,$R.SHADERDEFINE_SHADOW_PCF_NO=8192,$R.SHADERDEFINE_SHADOW_PCF1=16384,$R.SHADERDEFINE_SHADOW_PCF2=32768,$R.SHADERDEFINE_SHADOW_PCF3=65536,$R.MAX_PSSM_COUNT=3,$R;}(),$SF=function(){function $C(){}return $h($C,"laya.d3.utils.Picker"),$C.calculateCursorRay=function($R,$F,$i,$j,$t,$p){var $$=$R.elements[0],$V=$R.elements[1],$N=$C._tempVector30,$c=$N.elements;$c[0]=$$,$c[1]=$V,$c[2]=$F.minDepth;var $q=$C._tempVector31,$s=$q.elements;$s[0]=$$,$s[1]=$V,$s[2]=$F.maxDepth;var $k=$p.origin,$h=$C._tempVector32;$F.unprojectFromWVP($N,$i,$j,$t,$k),$F.unprojectFromWVP($q,$i,$j,$t,$h);var $S=$p.direction.elements;$S[0]=$h.x-$k.x,$S[1]=$h.y-$k.y,$S[2]=$h.z-$k.z,$$F.normalize($p.direction,$p.direction);},$C.rayIntersectsPositionsAndIndices=function($R,$F,$i,$j,$t){for(var $p=$i.vertexStride/4,$$=$i.getVertexElementByUsage(0).offset/4,$V=Number.MAX_VALUE,$N=-1,$c=-1,$q=-1,$s=0;$s<$j.length;$s+=3){var $k=$C._tempVector35,$h=$k.elements,$S=$j[$s]*$p,$x=$S+$$;$h[0]=$F[$x],$h[1]=$F[1+$x],$h[2]=$F[2+$x];var $a=$C._tempVector36,$m=$a.elements,$M=$j[$s+1]*$p,$J=$M+$$;$m[0]=$F[$J],$m[1]=$F[1+$J],$m[2]=$F[2+$J];var $d=$C._tempVector37,$w=$d.elements,$X=$j[$s+2]*$p,$H=$X+$$;$w[0]=$F[$H],$w[1]=$F[1+$H],$w[2]=$F[2+$H];var $_=laya.d3.utils.Picker.rayIntersectsTriangle($R,$k,$a,$d);!isNaN($_)&&$_<$V&&($V=$_,$N=$S,$c=$M,$q=$X);}if($V===Number.MAX_VALUE)return $t.position.toDefault(),$t.distance=Number.MAX_VALUE,$t.trianglePositions[0].toDefault(),$t.trianglePositions[1].toDefault(),$t.trianglePositions[2].toDefault(),$t.triangleNormals[0].toDefault(),$t.triangleNormals[1].toDefault(),$t.triangleNormals[2].toDefault(),!1;$t.distance=$V,$$F.scale($R.direction,$V,$t.position),$$F.add($R.origin,$t.position,$t.position);var $T=$t.trianglePositions,$g=$T[0],$B=$T[1],$z=$T[2],$L=$g.elements,$Y=$B.elements,$f=$z.elements,$Z=$N+$$;$L[0]=$F[$Z],$L[1]=$F[$Z+1],$L[2]=$F[$Z+2];var $u=$c+$$;$Y[0]=$F[$u],$Y[1]=$F[$u+1],$Y[2]=$F[$u+2];var $v=$q+$$;$f[0]=$F[$v],$f[1]=$F[$v+1],$f[2]=$F[$v+2];var $K=$i.getVertexElementByUsage(3);if($K){var $e=$K.offset/4,$Q=$t.triangleNormals,$b=$Q[0],$G=$Q[1],$O=$Q[2],$y=$b.elements,$E=$G.elements,$l=$O.elements,$W=$N+$e;$y[0]=$F[$W],$y[1]=$F[$W+1],$y[2]=$F[$W+2];var $o=$c+$e;$E[0]=$F[$o],$E[1]=$F[$o+1],$E[2]=$F[$o+2];var $n=$q+$e;$l[0]=$F[$n],$l[1]=$F[$n+1],$l[2]=$F[$n+2];}return!0;},$C.rayIntersectsTriangle=function($R,$F,$i,$j){var $t=$C._tempVector30,$p=$C._tempVector31;$$F.subtract($i,$F,$t),$$F.subtract($j,$F,$p);var $$,$V=$C._tempVector32;if($$F.cross($R.direction,$p,$V),($$=$$F.dot($t,$V))>-Number.MIN_VALUE&&$$<Number.MIN_VALUE)return Number.NaN;var $N,$c=1/$$,$q=$C._tempVector33;if($$F.subtract($R.origin,$F,$q),$N=$$F.dot($q,$V),($N*=$c)<0||1<$N)return Number.NaN;var $s,$k,$h=$C._tempVector34;return $$F.cross($q,$t,$h),$s=$$F.dot($R.direction,$h),($s*=$c)<0||1<$N+$s?Number.NaN:($k=$$F.dot($p,$h),($k*=$c)<0?Number.NaN:$k);},$s($C,["_tempVector30",function(){return this._tempVector30=new $$F();},"_tempVector31",function(){return this._tempVector31=new $$F();},"_tempVector32",function(){return this._tempVector32=new $$F();},"_tempVector33",function(){return this._tempVector33=new $$F();},"_tempVector34",function(){return this._tempVector34=new $$F();},"_tempVector35",function(){return this._tempVector35=new $$F();},"_tempVector36",function(){return this._tempVector36=new $$F();},"_tempVector37",function(){return this._tempVector37=new $$F();}]),$C;}(),$xF=(function(){function $R(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new $$F(),new $$F(),new $$F()],this.trianglePositions.length=3,this.triangleNormals=[new $$F(),new $$F(),new $$F()],this.triangleNormals.length=3,this.position=new $$F();}$h($R,"laya.d3.utils.RaycastHit"),$R.prototype.cloneTo=function($R){$R.distance=this.distance,this.trianglePositions[0].cloneTo($R.trianglePositions[0]),this.trianglePositions[1].cloneTo($R.trianglePositions[1]),this.trianglePositions[2].cloneTo($R.trianglePositions[2]),this.triangleNormals[0].cloneTo($R.triangleNormals[0]),this.triangleNormals[1].cloneTo($R.triangleNormals[1]),this.triangleNormals[2].cloneTo($R.triangleNormals[2]),this.position.cloneTo($R.position),$R.sprite3D=this.sprite3D;};}(),function(){function $R($R,$F){this._width=0,this._height=0,this._width=$R,this._height=$F;}$h($R,"laya.d3.utils.Size");var $F=$R.prototype;return $S(0,$F,"width",function(){return-1===this._width?$r.clientWidth:this._width;}),$S(0,$F,"height",function(){return-1===this._height?$r.clientHeight:this._height;}),$S(1,$R,"fullScreen",function(){return new $R(-1,-1);}),$R;}()),$aF=function(){function $Z(){}return $h($Z,"laya.d3.utils.Utils3D"),$Z._rotationTransformScaleSkinAnimation=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$s){var $k,$h,$S,$x,$a,$m=$Z._tempArray16_0,$M=$Z._tempArray16_1,$J=$Z._tempArray16_2,$d=$j+$j,$w=$t+$t,$X=$p+$p,$H=$j*$d,$_=$t*$d,$T=$t*$w,$g=$p*$d,$B=$p*$w,$z=$p*$X,$L=$$*$d,$Y=$$*$w,$f=$$*$X;for($m[15]=1,$m[0]=1-$T-$z,$m[1]=$_+$f,$m[2]=$g-$Y,$m[4]=$_-$f,$m[5]=1-$H-$z,$m[6]=$B+$L,$m[8]=$g+$Y,$m[9]=$B-$L,$m[10]=1-$H-$T,$M[15]=1,$M[0]=$V,$M[5]=$N,$M[10]=$c,$k=0;$k<4;$k++)$h=$m[$k],$S=$m[$k+4],$x=$m[$k+8],$a=$m[$k+12],$J[$k]=$h,$J[$k+4]=$S,$J[$k+8]=$x,$J[$k+12]=$h*$R+$S*$F+$x*$i+$a;for($k=0;$k<4;$k++)$h=$J[$k],$S=$J[$k+4],$x=$J[$k+8],$a=$J[$k+12],$q[$k+$s]=$h*$M[0]+$S*$M[1]+$x*$M[2]+$a*$M[3],$q[$k+$s+4]=$h*$M[4]+$S*$M[5]+$x*$M[6]+$a*$M[7],$q[$k+$s+8]=$h*$M[8]+$S*$M[9]+$x*$M[10]+$a*$M[11],$q[$k+$s+12]=$h*$M[12]+$S*$M[13]+$x*$M[14]+$a*$M[15];},$Z._createNodeByJson=function($R,$F,$i,$j){if(!$i)switch($F.type){case"Sprite3D":$i=new $vF();break;case"MeshSprite3D":$i=new $CF();break;case"SkinnedMeshSprite3D":$i=new SkinnedMeshSprite3D();break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":$i=new ShuriKenParticle3D();break;case"TrailSprite3D":$i=new TrailSprite3D();break;case"Terrain":$i=new Terrain();break;case"Camera":$i=new $nF();break;case"DirectionLight":$i=new DirectionLight();break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.");}var $t=$F.props;if($t)for(var $p in $t)$i[$p]=$t[$p];var $$=$F.customProps;$$&&($i instanceof laya.d3.core.Sprite3D?($i._parseBaseCustomProps($$),$i._parseCustomProps($R,$j,$$,$F),$i._parseCustomComponent($R,$j,$F.components)):$i._parseCustomProps($R,$j,$$,$F));var $V=$F.child;if($V)for(var $N=0,$c=$V.length;$N<$c;$N++){var $q=$Z._createNodeByJson($R,$V[$N],null,$j);$i.addChild($q);}return $i;},$Z._computeBoneAndAnimationDatasByBindPoseMatrxix=function($R,$F,$i,$j,$t,$p){var $$,$V,$N=0,$c=0,$q=$R.length;for($$=0;$$<$q;$N+=$R[$$].keyframeWidth,$c+=16,$$++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($F[$N+0],$F[$N+1],$F[$N+2],$F[$N+3],$F[$N+4],$F[$N+5],$F[$N+6],$F[$N+7],$F[$N+8],$F[$N+9],$j,$c),0!=$$&&($V=16*$R[$$].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($j,$V,$j,$c,$j,$c));var $s=$i.length;for($$=0;$$<$s;$$++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($j,16*$p[$$],$i[$$],$t,16*$$);},$Z._computeAnimationDatasByArrayAndMatrixFast=function($R,$F,$i,$j){for(var $t=0,$p=$R.length;$t<$p;$t++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($F,16*$j[$t],$R[$t],$i,16*$t);},$Z._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function($R,$F,$i,$j,$t){var $p,$$,$V=0,$N=0,$c=$R.length;for($p=0;$p<$c;$V+=$R[$p].keyframeWidth,$N+=16,$p++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($F[$V+7],$F[$V+8],$F[$V+9],$F[$V+3],$F[$V+4],$F[$V+5],$F[$V+6],$F[$V+0],$F[$V+1],$F[$V+2],$j,$N),0!=$p&&($$=16*$R[$p].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($j,$$,$j,$N,$j,$N));var $q=$i.length;for($p=0;$p<$q;$p++){var $s=16*$p;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($j,$s,$i[$p],$t,$s);}},$Z._computeAnimationDatasByArrayAndMatrixFastOld=function($R,$F,$i){for(var $j=$R.length,$t=0;$t<$j;$t++){var $p=16*$t;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($F,$p,$R[$t],$i,$p);}},$Z._computeRootAnimationData=function($R,$F,$i){for(var $j=0,$t=0,$p=0,$$=$R.length;$j<$$;$t+=$R[$j].keyframeWidth,$p+=16,$j++)laya.d3.utils.Utils3D.createAffineTransformationArray($F[$t+0],$F[$t+1],$F[$t+2],$F[$t+3],$F[$t+4],$F[$t+5],$F[$t+6],$F[$t+7],$F[$t+8],$F[$t+9],$i,$p);},$Z.transformVector3ArrayByQuat=function($R,$F,$i,$j,$t){var $p=$i.elements,$$=$R[$F],$V=$R[$F+1],$N=$R[$F+2],$c=$p[0],$q=$p[1],$s=$p[2],$k=$p[3],$h=$k*$$+$q*$N-$s*$V,$S=$k*$V+$s*$$-$c*$N,$x=$k*$N+$c*$V-$q*$$,$a=-$c*$$-$q*$V-$s*$N;$j[$t]=$h*$k+$a*-$c+$S*-$s-$x*-$q,$j[$t+1]=$S*$k+$a*-$q+$x*-$c-$h*-$s,$j[$t+2]=$x*$k+$a*-$s+$h*-$q-$S*-$c;},$Z.mulMatrixByArray=function($R,$F,$i,$j,$t,$p){var $$,$V,$N,$c,$q;if($t===$i){for($i=$Z._tempArray16_3,$$=0;$$<16;++$$)$i[$$]=$t[$p+$$];$j=0;}for($$=0;$$<4;$$++)$V=$R[$F+$$],$N=$R[$F+$$+4],$c=$R[$F+$$+8],$q=$R[$F+$$+12],$t[$p+$$]=$V*$i[$j+0]+$N*$i[$j+1]+$c*$i[$j+2]+$q*$i[$j+3],$t[$p+$$+4]=$V*$i[$j+4]+$N*$i[$j+5]+$c*$i[$j+6]+$q*$i[$j+7],$t[$p+$$+8]=$V*$i[$j+8]+$N*$i[$j+9]+$c*$i[$j+10]+$q*$i[$j+11],$t[$p+$$+12]=$V*$i[$j+12]+$N*$i[$j+13]+$c*$i[$j+14]+$q*$i[$j+15];},$Z.mulMatrixByArrayFast=function($R,$F,$i,$j,$t,$p){var $$,$V,$N,$c,$q;for($$=0;$$<4;$$++)$V=$R[$F+$$],$N=$R[$F+$$+4],$c=$R[$F+$$+8],$q=$R[$F+$$+12],$t[$p+$$]=$V*$i[$j+0]+$N*$i[$j+1]+$c*$i[$j+2]+$q*$i[$j+3],$t[$p+$$+4]=$V*$i[$j+4]+$N*$i[$j+5]+$c*$i[$j+6]+$q*$i[$j+7],$t[$p+$$+8]=$V*$i[$j+8]+$N*$i[$j+9]+$c*$i[$j+10]+$q*$i[$j+11],$t[$p+$$+12]=$V*$i[$j+12]+$N*$i[$j+13]+$c*$i[$j+14]+$q*$i[$j+15];},$Z.mulMatrixByArrayAndMatrixFast=function($R,$F,$i,$j,$t){var $p,$$,$V,$N,$c,$q=$i.elements,$s=$q[0],$k=$q[1],$h=$q[2],$S=$q[3],$x=$q[4],$a=$q[5],$m=$q[6],$M=$q[7],$J=$q[8],$d=$q[9],$w=$q[10],$X=$q[11],$H=$q[12],$_=$q[13],$T=$q[14],$g=$q[15],$B=$F,$z=$F+4,$L=$F+8,$Y=$F+12,$f=$t,$Z=$t+4,$u=$t+8,$v=$t+12;for($p=0;$p<4;$p++)$$=$R[$B+$p],$V=$R[$z+$p],$N=$R[$L+$p],$c=$R[$Y+$p],$j[$f+$p]=$$*$s+$V*$k+$N*$h+$c*$S,$j[$Z+$p]=$$*$x+$V*$a+$N*$m+$c*$M,$j[$u+$p]=$$*$J+$V*$d+$N*$w+$c*$X,$j[$v+$p]=$$*$H+$V*$_+$N*$T+$c*$g;},$Z.createAffineTransformationArray=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$s){var $k=$j+$j,$h=$t+$t,$S=$p+$p,$x=$j*$k,$a=$j*$h,$m=$j*$S,$M=$t*$h,$J=$t*$S,$d=$p*$S,$w=$$*$k,$X=$$*$h,$H=$$*$S;$q[$s+0]=(1-($M+$d))*$V,$q[$s+1]=($a+$H)*$V,$q[$s+2]=($m-$X)*$V,$q[$s+3]=0,$q[$s+4]=($a-$H)*$N,$q[$s+5]=(1-($x+$d))*$N,$q[$s+6]=($J+$w)*$N,$q[$s+7]=0,$q[$s+8]=($m+$X)*$c,$q[$s+9]=($J-$w)*$c,$q[$s+10]=(1-($x+$M))*$c,$q[$s+11]=0,$q[$s+12]=$R,$q[$s+13]=$F,$q[$s+14]=$i,$q[$s+15]=1;},$Z.transformVector3ArrayToVector3ArrayCoordinate=function($R,$F,$i,$j,$t){var $p=$Z._tempArray4_0,$$=$R[$F+0],$V=$R[$F+1],$N=$R[$F+2],$c=$i.elements;$p[0]=$$*$c[0]+$V*$c[4]+$N*$c[8]+$c[12],$p[1]=$$*$c[1]+$V*$c[5]+$N*$c[9]+$c[13],$p[2]=$$*$c[2]+$V*$c[6]+$N*$c[10]+$c[14],$p[3]=1/($$*$c[3]+$V*$c[7]+$N*$c[11]+$c[15]),$j[$t+0]=$p[0]*$p[3],$j[$t+1]=$p[1]*$p[3],$j[$t+2]=$p[2]*$p[3];},$Z.transformLightingMapTexcoordByUV0Array=function($R,$F,$i,$j,$t){var $p=$i.elements;$j[$t+0]=$R[$F+0]*$p[0]+$p[2],$j[$t+1]=($R[$F+1]-1)*$p[1]+$p[3];},$Z.transformLightingMapTexcoordByUV1Array=function($R,$F,$i,$j,$t){var $p=$i.elements;$j[$t+0]=$R[$F+0]*$p[0]+$p[2],$j[$t+1]=1+$R[$F+1]*$p[1]+$p[3];},$Z.getURLVerion=function($R){var $F=$R.indexOf("?");return 0<=$F?$R.substr($F):null;},$Z._quaternionCreateFromYawPitchRollArray=function($R,$F,$i,$j){var $t=.5*$i,$p=.5*$F,$$=.5*$R,$V=Math.sin($t),$N=Math.cos($t),$c=Math.sin($p),$q=Math.cos($p),$s=Math.sin($$),$k=Math.cos($$);$j[0]=$k*$c*$N+$s*$q*$V,$j[1]=$s*$q*$N-$k*$c*$V,$j[2]=$k*$q*$V-$s*$c*$N,$j[3]=$k*$q*$N+$s*$c*$V;},$Z._createAffineTransformationArray=function($R,$F,$i,$j){var $t=$F[0],$p=$F[1],$$=$F[2],$V=$F[3],$N=$t+$t,$c=$p+$p,$q=$$+$$,$s=$t*$N,$k=$t*$c,$h=$t*$q,$S=$p*$c,$x=$p*$q,$a=$$*$q,$m=$V*$N,$M=$V*$c,$J=$V*$q,$d=$i[0],$w=$i[1],$X=$i[2];$j[0]=(1-($S+$a))*$d,$j[1]=($k+$J)*$d,$j[2]=($h-$M)*$d,$j[3]=0,$j[4]=($k-$J)*$w,$j[5]=(1-($s+$a))*$w,$j[6]=($x+$m)*$w,$j[7]=0,$j[8]=($h+$M)*$X,$j[9]=($x-$m)*$X,$j[10]=(1-($s+$S))*$X,$j[11]=0,$j[12]=$R[0],$j[13]=$R[1],$j[14]=$R[2],$j[15]=1;},$Z._mulMatrixArray=function($R,$F,$i,$j){var $t,$p,$$,$V,$N,$c=$F.elements,$q=$c[0],$s=$c[1],$k=$c[2],$h=$c[3],$S=$c[4],$x=$c[5],$a=$c[6],$m=$c[7],$M=$c[8],$J=$c[9],$d=$c[10],$w=$c[11],$X=$c[12],$H=$c[13],$_=$c[14],$T=$c[15],$g=$j,$B=$j+4,$z=$j+8,$L=$j+12;for($t=0;$t<4;$t++)$p=$R[$t],$$=$R[$t+4],$V=$R[$t+8],$N=$R[$t+12],$i[$g+$t]=$p*$q+$$*$s+$V*$k+$N*$h,$i[$B+$t]=$p*$S+$$*$x+$V*$a+$N*$m,$i[$z+$t]=$p*$M+$$*$J+$V*$d+$N*$w,$i[$L+$t]=$p*$X+$$*$H+$V*$_+$N*$T;},$Z.getYawPitchRoll=function($R,$F){$Z.transformQuat($$F.ForwardRH,$R,$iF.TEMPVector31),$Z.transformQuat($$F.Up,$R,$iF.TEMPVector32);var $i=$iF.TEMPVector32.elements;$Z.angleTo($$F.ZERO,$iF.TEMPVector31,$iF.TEMPVector33);var $j=$iF.TEMPVector33.elements;$j[0]==Math.PI/2?($j[1]=$Z.arcTanAngle($i[2],$i[0]),$j[2]=0):$j[0]==-Math.PI/2?($j[1]=$Z.arcTanAngle(-$i[2],-$i[0]),$j[2]=0):($RF.createRotationY(-$j[1],$iF.TEMPMatrix0),$RF.createRotationX(-$j[0],$iF.TEMPMatrix1),$$F.transformCoordinate($iF.TEMPVector32,$iF.TEMPMatrix0,$iF.TEMPVector32),$$F.transformCoordinate($iF.TEMPVector32,$iF.TEMPMatrix1,$iF.TEMPVector32),$j[2]=$Z.arcTanAngle($i[1],-$i[0])),$j[1]<=-Math.PI&&($j[1]=Math.PI),$j[2]<=-Math.PI&&($j[2]=Math.PI),$j[1]>=Math.PI&&$j[2]>=Math.PI&&($j[1]=0,$j[2]=0,$j[0]=Math.PI-$j[0]),$F[0]=$j[1],$F[1]=$j[0],$F[2]=$j[2];},$Z.arcTanAngle=function($R,$F){return 0==$R?1==$F?Math.PI/2:-Math.PI/2:0<$R?Math.atan($F/$R):$R<0?0<$F?Math.atan($F/$R)+Math.PI:Math.atan($F/$R)-Math.PI:0;},$Z.angleTo=function($R,$F,$i){$$F.subtract($F,$R,$iF.TEMPVector30),$$F.normalize($iF.TEMPVector30,$iF.TEMPVector30),$i.elements[0]=Math.asin($iF.TEMPVector30.y),$i.elements[1]=$Z.arcTanAngle(-$iF.TEMPVector30.z,-$iF.TEMPVector30.x);},$Z.transformQuat=function($R,$F,$i){var $j=$i.elements,$t=$R.elements,$p=$F,$$=$t[0],$V=$t[1],$N=$t[2],$c=$p[0],$q=$p[1],$s=$p[2],$k=$p[3],$h=$k*$$+$q*$N-$s*$V,$S=$k*$V+$s*$$-$c*$N,$x=$k*$N+$c*$V-$q*$$,$a=-$c*$$-$q*$V-$s*$N;$j[0]=$h*$k+$a*-$c+$S*-$s-$x*-$q,$j[1]=$S*$k+$a*-$q+$x*-$c-$h*-$s,$j[2]=$x*$k+$a*-$s+$h*-$q-$S*-$c;},$Z.quaterionNormalize=function($R,$F){var $i=$R[0],$j=$R[1],$t=$R[2],$p=$R[3],$$=$i*$i+$j*$j+$t*$t+$p*$p;0<$$&&($$=1/Math.sqrt($$),$F[0]=$i*$$,$F[1]=$j*$$,$F[2]=$t*$$,$F[3]=$p*$$);},$Z.matrix4x4MultiplyFFF=function($R,$F,$i){var $j,$t,$p,$$,$V;if($i===$F)for($F=new Float32Array(16),$j=0;$j<16;++$j)$F[$j]=$i[$j];for($j=0;$j<4;$j++)$t=$R[$j],$p=$R[$j+4],$$=$R[$j+8],$V=$R[$j+12],$i[$j]=$t*$F[0]+$p*$F[1]+$$*$F[2]+$V*$F[3],$i[$j+4]=$t*$F[4]+$p*$F[5]+$$*$F[6]+$V*$F[7],$i[$j+8]=$t*$F[8]+$p*$F[9]+$$*$F[10]+$V*$F[11],$i[$j+12]=$t*$F[12]+$p*$F[13]+$$*$F[14]+$V*$F[15];},$Z.matrix4x4MultiplyMFM=function($R,$F,$i){$Z.matrix4x4MultiplyFFF($R.elements,$F,$i.elements);},$s($Z,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"};},"_tempVector3_0",function(){return this._tempVector3_0=new $$F();},"_tempVector3_1",function(){return this._tempVector3_1=new $$F();},"_tempVector3_2",function(){return this._tempVector3_2=new $$F();},"_tempVector3_3",function(){return this._tempVector3_3=new $$F();},"_tempVector3_4",function(){return this._tempVector3_4=new $$F();},"_tempVector3_5",function(){return this._tempVector3_5=new $$F();},"_tempVector3_6",function(){return this._tempVector3_6=new $$F();},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4);},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16);},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16);},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16);},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16);}]),$Z;}(),$mF=function(){function $Y(){}return $h($Y,"Laya3D"),$Y._cancelLoadByUrl=function($R){$w.loader.cancelLoadByUrl($R),$Y._innerFirstLevelLoaderManager.cancelLoadByUrl($R),$Y._innerSecondLevelLoaderManager.cancelLoadByUrl($R),$Y._innerThirdLevelLoaderManager.cancelLoadByUrl($R),$Y._innerFourthLevelLoaderManager.cancelLoadByUrl($R);},$Y._changeWebGLSize=function($R,$F){$L.onStageResize($R,$F),$r.clientWidth=$R,$r.clientHeight=$F;},$Y.__init__=function(){var $R=$F.createMap;$R.lh=[$vF,"SPRITE3DHIERARCHY"],$R.ls=[$uF,"SPRITE3DHIERARCHY"],$R.lm=[$yF,"MESH"],$R.lmat=[$eF,"MATERIAL"],$R.jpg=[$lF,"nativeimage"],$R.jpeg=[$lF,"nativeimage"],$R.png=[$lF,"nativeimage"],$R.pkm=[$lF,"arraybuffer"],$R.raw=[$GF,"arraybuffer"],$R.mipmaps=[$GF,"arraybuffer"],$m.parserMap.SPRITE3DHIERARCHY=$Y._loadHierarchy,$m.parserMap.MESH=$Y._loadMesh,$m.parserMap.MATERIAL=$Y._loadMaterial,$m.parserMap.TEXTURECUBE=$Y._loadTextureCube,$m.parserMap.TERRAIN=$Y._loadTerrain,$Y._innerFirstLevelLoaderManager.on("error",null,$Y._eventLoadManagerError),$Y._innerSecondLevelLoaderManager.on("error",null,$Y._eventLoadManagerError),$Y._innerThirdLevelLoaderManager.on("error",null,$Y._eventLoadManagerError),$Y._innerFourthLevelLoaderManager.on("error",null,$Y._eventLoadManagerError);},$Y.READ_BLOCK=function(){return $Y._readData.pos+=4,!0;},$Y.READ_DATA=function(){return $Y._DATA.offset=$Y._readData.getUint32(),$Y._DATA.size=$Y._readData.getUint32(),!0;},$Y.READ_STRINGS=function(){var $R=[],$F={offset:0,size:0};$F.offset=$Y._readData.getUint16(),$F.size=$Y._readData.getUint16();$Y._readData.pos;$Y._readData.pos=$F.offset+$Y._DATA.offset;for(var $i=0;$i<$F.size;$i++){var $j=$Y._readData.readUTFString();-1===$j.lastIndexOf(".lmat")&&-1===$j.lastIndexOf(".lpbr")||$R.push($j);}return $R;},$Y.formatRelativePath=function($R,$F){var $i;if("."===$F.charAt(0)){for(var $j=($R+$F).split("/"),$t=0,$p=$j.length;$t<$p;$t++)if(".."==$j[$t]){var $$=$t-1;0<$$&&".."!==$j[$$]&&($j.splice($$,2),$t-=2);}$i=$j.join("/");}else $i=$R+$F;return null!=$z.customFormat&&($i=$z.customFormat($i,null)),$i;},$Y._eventLoadManagerError=function($R){$w.loader.event("error",$R);},$Y._addHierarchyInnerUrls=function($R,$F,$i,$j,$t,$p){var $$=$Y.formatRelativePath($j,$t);$i&&($$+=$i),$R.push({url:$$,clas:$p}),$F[$t]=$$;},$Y._getSprite3DHierarchyInnerUrls=function($R,$F,$i,$j,$t,$p,$$){var $V,$N=0,$c=0;switch($R.type){case"Scene":var $q=$R.customProps.lightmaps;for($N=0,$c=$q.length;$N<$c;$N++){var $s=$q[$N].replace(".exr",".png");$Y._addHierarchyInnerUrls($j,$t,$p,$$,$s,$lF);}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var $k;if($R.instanceParams)($k=$R.instanceParams.loadPath)&&$Y._addHierarchyInnerUrls($F,$t,$p,$$,$k,$yF);else{($k=($V=$R.customProps).meshPath)&&$Y._addHierarchyInnerUrls($F,$t,$p,$$,$k,$yF);var $h=$V.materials;if($h)for($N=0,$c=$h.length;$N<$c;$N++){for(var $S=$h[$N],$x=$S.type.split("."),$a=$f.window,$m=0,$M=$x.length;$m<$M;++$m){$a=$a[this.clasPaths[$m]];}if("function"!=typeof $a)throw"_getSprite3DHierarchyInnerUrls 错误: "+$S.type+" 不是类";$Y._addHierarchyInnerUrls($i,$t,$p,$$,$S.path,$a);}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var $J=($V=$R.customProps).meshPath;$J&&$Y._addHierarchyInnerUrls($F,$t,$p,$$,$J,$yF);var $d=$V.material;if($d){$x=$d.type.split("."),$a=$f.window;for($m=0,$M=$x.length;$m<$M;++$m){$a=$a[this.clasPaths[$m]];}$Y._addHierarchyInnerUrls($i,$t,$p,$$,$d.path,$a);}else{var $w=$V.materialPath;if($w)$Y._addHierarchyInnerUrls($i,$t,$p,$$,$w,ShurikenParticleMaterial);else{var $X=$V.texturePath;$X&&$Y._addHierarchyInnerUrls($j,$t,$p,$$,$X,$lF);}}break;case"Terrain":$Y._addHierarchyInnerUrls($j,$t,$p,$$,$R.customProps.dataPath,TerrainRes);}var $H=$R.components;for(var $_ in $H){var $T=$H[$_];switch($_){case"Animator":var $g=$T.avatarPath;if($g)$Y._addHierarchyInnerUrls($j,$t,$p,$$,$g,Avatar);else{var $B=$T.avatar;$B&&$Y._addHierarchyInnerUrls($j,$t,$p,$$,$B.path,Avatar);}var $z=$T.clipPaths;for($N=0,$c=$z.length;$N<$c;$N++)$Y._addHierarchyInnerUrls($j,$t,$p,$$,$z[$N],AnimationClip);}}var $L=$R.child;for($N=0,$c=$L.length;$N<$c;$N++)$Y._getSprite3DHierarchyInnerUrls($L[$N],$F,$i,$j,$t,$p,$$);},$Y._loadHierarchy=function($R){$R.on("loaded",null,$Y._onHierarchylhLoaded,[$R,$R._class._getGroup()]),$R.load($R.url,"json",!1,null,!0);},$Y._onHierarchylhLoaded=function($R,$F,$i){if($R._class.destroyed)$R.endLoad();else{var $j=$R.url,$t=$aF.getURLVerion($j),$p=$z.getPath($j),$$=[],$V=[],$N=[],$c={};$Y._getSprite3DHierarchyInnerUrls($i,$$,$V,$N,$c,$t,$p);var $q=$$.length+$V.length+$N.length,$s=$q+1,$k=1/$s;if($Y._onProcessChange($R,0,$k,1),0<$N.length){var $h=$q/$s,$S=$B.create(null,$Y._onProcessChange,[$R,$k,$h],!1);$Y._innerFourthLevelLoaderManager.create($N,$B.create(null,$Y._onHierarchyInnerForthLevResouLoaded,[$R,$F,$S,$i,$c,$$,$V,$k+$h*$N.length,$h]),$S,null,null,1,!0,$F);}else $Y._onHierarchyInnerForthLevResouLoaded($R,$F,null,$i,$c,$$,$V,$k,$h);}},$Y._onHierarchyInnerForthLevResouLoaded=function($R,$F,$i,$j,$t,$p,$$,$V,$N){if($R._class.destroyed)$R.endLoad();else if($i&&$i.recover(),0<$$.length){var $c=$B.create(null,$Y._onProcessChange,[$R,$V,$N],!1);$Y._innerSecondLevelLoaderManager.create($$,$B.create(null,$Y._onHierarchyInnerSecondLevResouLoaded,[$R,$F,$c,$j,$t,$p,$V+$N*$$.length,$N]),$i,null,null,1,!0,$F);}else $Y._onHierarchyInnerSecondLevResouLoaded($R,$F,null,$j,$t,$p,$V,$N);},$Y._onHierarchyInnerSecondLevResouLoaded=function($R,$F,$i,$j,$t,$p,$$,$V){if($R._class.destroyed)$R.endLoad();else if($i&&$i.recover(),0<$p.length){var $N=$B.create(null,$Y._onProcessChange,[$R,$$,$V],!1);$Y._innerFirstLevelLoaderManager.create($p,$B.create(null,$Y._onHierarchyInnerFirstLevResouLoaded,[$R,$N,$j,$t]),$i,null,null,1,!0,$F);}else $Y._onHierarchyInnerFirstLevResouLoaded($R,null,$j,$t);},$Y._onHierarchyInnerFirstLevResouLoaded=function($R,$F,$i,$j){$F&&$F.recover(),$R.endLoad([$i,$j]);},$Y._loadTerrain=function($R){$R.on("loaded",null,$Y._onTerrainLtLoaded,[$R,$R._class._getGroup()]),$R.load($R.url,"json",!1,null,!0);},$Y._onTerrainLtLoaded=function($R,$F,$i){if($R._class.destroyed)$R.endLoad();else{var $j,$t,$p=$R.url,$$=$aF.getURLVerion($p),$V=$z.getPath($p),$N=[],$c={},$q=0,$s=0,$k=$i.heightData;$j=$k.url,$t=$Y.formatRelativePath($V,$j),$$&&($t+=$$),$j=$c[$j]=$t;var $h=$i.detailTexture;for($q=0,$s=$h.length;$q<$s;$q++)$N.push({url:$h[$q].diffuse});var $S=$i.normalMap;for($q=0,$s=$S.length;$q<$s;$q++)$N.push({url:$S[$q]});var $x=$i.alphaMap;for($q=0,$s=$x.length;$q<$s;$q++)$N.push({url:$x[$q],params:[!1,!1,6408,!0]});for($q=0,$s=$N.length;$q<$s;$q++){var $a=$N[$q].url;$t=$Y.formatRelativePath($V,$a),$$&&($t+=$$),$N[$q].url=$t,$c[$a]=$t;}var $m=$N.length,$M=$m+2,$J=1/$M;$Y._onProcessChange($R,0,$J,1);var $d={heightMapLoaded:!1,texturesLoaded:!1},$w=$B.create(null,$Y._onProcessChange,[$R,$J,$J],!1);$Y._innerFourthLevelLoaderManager.create($j,$B.create(null,$Y._onTerrainHeightMapLoaded,[$R,$w,$i,$c,$d]),$w,null,[$k.numX,$k.numZ,$k.bitType,$k.value],1,!0,$F);var $X=$B.create(null,$Y._onProcessChange,[$R,2*$J,$m/$M],!1);$Y._innerFourthLevelLoaderManager.create($N,$B.create(null,$Y._onTerrainTexturesLoaded,[$R,$X,$i,$c,$d]),$X,null,null,1,!0,$F);}},$Y._onTerrainHeightMapLoaded=function($R,$F,$i,$j,$t){$t.heightMapLoaded=!0,$t.texturesLoaded&&($R.endLoad([$i,$j]),$F.recover());},$Y._onTerrainTexturesLoaded=function($R,$F,$i,$j,$t){$t.texturesLoaded=!0,$t.heightMapLoaded&&($R.endLoad([$i,$j]),$F.recover());},$Y._loadMesh=function($R){$R.on("loaded",null,$Y._onMeshLmLoaded,[$R,$R._class._getGroup()]),$R.load($R.url,"arraybuffer",!1,null,!0);},$Y._onMeshLmLoaded=function($R,$F,$i){if($R._class.destroyed)$R.endLoad();else{var $j,$t,$p,$$=$R.url,$V=$aF.getURLVerion($$),$N=$z.getPath($$),$c={},$q=0,$s=0;switch(($Y._readData=new $X($i)).pos=0,$Y._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var $k=$Y._readData.getUint32();$Y._readData.pos=$Y._readData.pos+4,$s=$Y._readData.getUint16(),$Y._readData.pos=$Y._readData.pos+8*$s;var $h=$Y._readData.getUint32();for($s=$Y._readData.getUint16(),$Y._readData.pos=$k+$h,$j=[],$q=0;$q<$s;$q++){var $S=$Y._readData.readUTFString();-1!==$S.lastIndexOf(".lmat")&&$j.push($S);}break;default:for($Y.READ_BLOCK(),$q=0;$q<2;$q++){var $x=$Y._readData.getUint16(),$a=$Y._strings[$x],$m=$Y["READ_"+$a];if(null==$m)throw new Error("model file err,no this function:"+$x+" "+$a);1===$q?$j=$m.call():$m.call();}}for($q=0,$p=$j.length;$q<$p;$q++){var $M=$j[$q];$t=$Y.formatRelativePath($N,$M),$V&&($t+=$V),$j[$q]=$t,$c[$M]=$t;}if(0<$j.length){$Y._onProcessChange($R,0,.5,1);var $J=$B.create(null,$Y._onProcessChange,[$R,.5,.5],!1);$Y._innerSecondLevelLoaderManager.create($j,$B.create(null,$Y._onMeshMateialLoaded,[$R,$J,$i,$c]),$J,null,null,1,!0,$F);}else $R.endLoad([$i,$c]);}},$Y._onMeshMateialLoaded=function($R,$F,$i,$j){$R.endLoad([$i,$j]),$F.recover();},$Y._getMaterialTexturePath=function($R,$F,$i){var $j=$R.length-4;return $R.indexOf(".dds")!=$j&&$R.indexOf(".tga")!=$j&&$R.indexOf(".exr")!=$j&&$R.indexOf(".DDS")!=$j&&$R.indexOf(".TGA")!=$j&&$R.indexOf(".EXR")!=$j||($R=$R.substr(0,$j)+".png"),$R=$Y.formatRelativePath($i,$R),$F&&($R+=$F),$R;},$Y._loadMaterial=function($R){$R.on("loaded",null,$Y._onMaterilLmatLoaded,[$R,$R._class._getGroup()]),$R.load($R.url,"json",!1,null,!0);},$Y._onMaterilLmatLoaded=function($R,$F,$i){if($R._class.destroyed)$R.endLoad();else{var $j,$t=$R.url,$p=$aF.getURLVerion($t),$$=$z.getPath($t),$V=[],$N={},$c=$i.customProps,$q=$i.version;if($q)switch($q){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var $s=$i.props.textures,$k=0,$h=$s.length;$k<$h;$k++){var $S=$s[$k],$x=$S.path;if($x){var $a=$x.length-4;$x.indexOf(".exr")!=$a&&$x.indexOf(".EXR")!=$a||($x=$x.substr(0,$a)+".png"),$j=$Y.formatRelativePath($$,$x),$p&&($j+=$p),$V.push({url:$j,params:$S.params}),$N[$x]=$j;}}break;default:throw new Error("Laya3D:unkonwn version.");}else{var $m=$c.diffuseTexture.texture2D;if($m&&($j=$Y._getMaterialTexturePath($m,$p,$$),$V.push($j),$N[$m]=$j),$c.normalTexture){var $M=$c.normalTexture.texture2D;$M&&($j=$Y._getMaterialTexturePath($M,$p,$$),$V.push($j),$N[$M]=$j);}if($c.specularTexture){var $J=$c.specularTexture.texture2D;$J&&($j=$Y._getMaterialTexturePath($J,$p,$$),$V.push($j),$N[$J]=$j);}if($c.emissiveTexture){var $d=$c.emissiveTexture.texture2D;$d&&($j=$Y._getMaterialTexturePath($d,$p,$$),$V.push($j),$N[$d]=$j);}if($c.ambientTexture){var $w=$c.ambientTexture.texture2D;$w&&($j=$Y._getMaterialTexturePath($w,$p,$$),$V.push($j),$N[$w]=$j);}if($c.reflectTexture){var $X=$c.reflectTexture.texture2D;$X&&($j=$Y._getMaterialTexturePath($X,$p,$$),$V.push($j),$N[$X]=$j);}}var $H=$V.length,$_=$H+1,$T=1/$_;if($Y._onProcessChange($R,0,$T,1),0<$H){var $g=$B.create(null,$Y._onProcessChange,[$R,$T,$H/$_],!1);$Y._innerFourthLevelLoaderManager.create($V,$B.create(null,$Y._onMateialTexturesLoaded,[$R,$g,$i,$N]),$g,$lF,null,1,!0,$F);}else $Y._onMateialTexturesLoaded($R,null,$i,null);}},$Y._onMateialTexturesLoaded=function($R,$F,$i,$j){$R.endLoad([$i,$j]),$F&&$F.recover();},$Y._loadTextureCube=function($R){$R.on("loaded",null,$Y._onTextureCubeLtcLoaded,[$R]),$R.load($R.url,"json",!1,null,!0);},$Y._onTextureCubeLtcLoaded=function($R,$F){if($R._class.destroyed)$R.endLoad();else{var $i=$z.getPath($R.url),$j=[$Y.formatRelativePath($i,$F.px),$Y.formatRelativePath($i,$F.nx),$Y.formatRelativePath($i,$F.py),$Y.formatRelativePath($i,$F.ny),$Y.formatRelativePath($i,$F.pz),$Y.formatRelativePath($i,$F.nz)];$Y._onProcessChange($R,0,1/7,1);var $t=$B.create(null,$Y._onProcessChange,[$R,1/7,6/7],!1);$Y._innerFourthLevelLoaderManager.load($j,$B.create(null,$Y._onTextureCubeImagesLoaded,[$R,$j,$t]),$t,"nativeimage");}},$Y._onTextureCubeImagesLoaded=function($R,$F,$i){var $j=[];$j.length=6;for(var $t=0;$t<6;$t++){var $p=$F[$t];$j[$t]=$m.getRes($p),$m.clearRes($p);}$R.endLoad($j),$i.recover();},$Y._onProcessChange=function($R,$F,$i,$j){($j=$F+$j*$i)<1&&$R.event("progress",$j);},$Y.init=function($R,$F,$i,$j,$t,$p){if(void 0===$i&&($i=!1),void 0===$j&&($j=!1),void 0===$t&&($t=!0),void 0===$p&&($p=!0),$M.update3DLoop=function(){},$M.cancelLoadByUrl=function($R){$Y._cancelLoadByUrl($R);},$N.isAntialias=$i,$N.isAlpha=$j,$N.premultipliedAlpha=$t,$N.isStencil=$p,!$L.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");$M.changeWebGLSize=$Y._changeWebGLSize,$x.is3DMode=!0,$w.init($R,$F),$Z.__init__(),$sF.__init__(),$CF.__init__(),$O.__init__(),$Y.__init__(),$$.maxTextureCount=2,($Y.debugMode||$A.debugMode)&&($Y._debugPhasorSprite=new $o());},$Y.HIERARCHY="SPRITE3DHIERARCHY",$Y.MESH="MESH",$Y.MATERIAL="MATERIAL",$Y.PBRMATERIAL="PBRMTL",$Y.TEXTURECUBE="TEXTURECUBE",$Y.TERRAIN="TERRAIN",$Y._readData=null,$Y._debugPhasorSprite=null,$Y.debugMode=!1,$s($Y,["_DATA",function(){return this._DATA={offset:0,size:0};},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"];},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new $F();},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new $F();},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new $F();},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new $F();}]),$Y;}(),$MF=function($R){function $t($R){$t.__super.call(this),this._owner=$R,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0;}$h($t,"laya.d3.animation.AnimationTransform3D",$p);var $F=$t.prototype;return $F._getlocalMatrix=function(){return this._localUpdate&&($aF._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix;},$F._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var $R=0,$F=this._childs.length;$R<$F;$R++)this._childs[$R]._onWorldTransform();}},$F._setWorldMatrixAndUpdate=function($R){if(this._worldMatrix=$R,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var $F=this._getlocalMatrix(),$i=0;$i<16;++$i)this._worldMatrix[$i]=$F[$i];else $aF.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1;},$F._setWorldMatrixNoUpdate=function($R){this._worldMatrix=$R;},$F._setWorldMatrixIgnoreUpdate=function($R){this._worldMatrix=$R,this._worldUpdate=!1;},$F.getLocalPosition=function(){return this._localPosition;},$F.setLocalPosition=function($R){if(this._parent)this._localPosition=$R,this._localUpdate=!0,this._onWorldTransform();else{var $F=this._entity.owner._transform,$i=this._entity.localPosition,$j=$i.elements;$j[0]=$R[0],$j[1]=$R[1],$j[2]=$R[2],$F.localPosition=$i;}},$F.getLocalRotation=function(){if(this._localQuaternionUpdate){var $R=this._localRotationEuler;$aF._quaternionCreateFromYawPitchRollArray($R[1]/$t._angleToRandin,$R[0]/$t._angleToRandin,$R[2]/$t._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1;}return this._localRotation;},$F.setLocalRotation=function($R){if(this._parent)this._localRotation=$R,$aF.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $F=this._entity.owner._transform,$i=this._entity.localRotation,$j=$i.elements;$j[0]=$R[0],$j[1]=$R[1],$j[2]=$R[2],$j[3]=$R[3],$F.localRotation=$i;}},$F.getLocalScale=function(){return this._localScale;},$F.setLocalScale=function($R){if(this._parent)this._localScale=$R,this._localUpdate=!0,this._onWorldTransform();else{var $F=this._entity.owner._transform,$i=this._entity.localScale,$j=$i.elements;$j[0]=$R[0],$j[1]=$R[1],$j[2]=$R[2],$F.localScale=$i;}},$F.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){$aF.getYawPitchRoll(this._localRotation,$t._tempVector3);var $R=$t._tempVector3,$F=this._localRotationEuler;$F[0]=$R[1]*$t._angleToRandin,$F[1]=$R[0]*$t._angleToRandin,$F[2]=$R[2]*$t._angleToRandin,this._locaEulerlUpdate=!1;}return this._localRotationEuler;},$F.setLocalRotationEuler=function($R){if(this._parent)$aF._quaternionCreateFromYawPitchRollArray($R[1]/$t._angleToRandin,$R[0]/$t._angleToRandin,$R[2]/$t._angleToRandin,this._localRotation),this._localRotationEuler=$R,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $F=this._entity.owner._transform,$i=this._entity.localRotationEuler,$j=$i.elements;$j[0]=$R[0],$j[1]=$R[1],$j[2]=$R[2],$F.localRotationEuler=$i;}},$F.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)$aF.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var $R=this._getlocalMatrix(),$F=0;$F<16;++$F)this._worldMatrix[$F]=$R[$F];this._worldUpdate=!1;}return this._worldMatrix;},$F.setParent=function($R){if(this._parent!==$R){if(this._parent){var $F=this._parent._childs,$i=$F.indexOf(this);$F.splice($i,1);}$R&&($R._childs.push(this),$R&&this._onWorldTransform()),this._parent=$R;}},$s($t,["_tempVector3",function(){return this._tempVector3=new Float32Array(3);},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI;}]),$t;}(),$JF=function($R){function $F(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,$F.__super.call(this),this._destroyed=!1,this._id=$F._uniqueIDCounter,$F._uniqueIDCounter++;}$h($F,"laya.d3.component.Component3D",$p);var $i=$F.prototype;return $w.imps($i,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),$i._initialize=function($R){this._owner=$R,this._enable=!0,this.started=!1,this._load($R);},$i._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0;},$i._load=function($R){},$i._start=function($R){},$i._update=function($R){},$i._lateUpdate=function($R){},$i._preRenderUpdate=function($R){},$i._postRenderUpdate=function($R){},$i._unload=function($R){this.offAll();},$i._cloneTo=function($R){},$S(0,$i,"id",function(){return this._id;}),$S(0,$i,"destroyed",function(){return this._destroyed;}),$S(0,$i,"owner",function(){return this._owner;}),$S(0,$i,"enable",function(){return this._enable;},function($R){this._enable!==$R&&(this._enable=$R,this.event("enablechanged",this._enable));}),$S(0,$i,"isSingleton",function(){return $F._isSingleton;}),$F._isSingleton=!0,$F._uniqueIDCounter=1,$F;}(),$dF=function($R){function $F(){this._destroyed=!1,$F.__super.call(this),this._destroyed=!1;}$h($F,"laya.d3.core.GeometryFilter",$p);var $i=$F.prototype;return $w.imps($i,{"laya.resource.IDestroy":!0}),$i._destroy=function(){this.offAll(),this._destroyed=!0;},$S(0,$i,"_isAsyncLoaded",function(){return!0;}),$S(0,$i,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.");}),$S(0,$i,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.");}),$S(0,$i,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.");}),$S(0,$i,"destroyed",function(){return this._destroyed;}),$F;}(),$wF=function($R){function $j($R){$j.__super.call(this),this._id=++$j._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new $AR(new $$F(),new $$F()),this._boundingBoxCenter=new $$F(),this._boundingSphere=new $UR(new $$F(),0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=$R,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange);}$h($j,"laya.d3.core.render.BaseRender",$p);var $F=$j.prototype;return $w.imps($F,{"laya.resource.IDestroy":!0}),$F._changeMaterialReference=function($R,$F){$R&&$R._removeReference(),$F._addReference();},$F._getInstanceMaterial=function($R,$F){var $i=new $R.constructor();return $R.cloneTo($i),$i.name=$i.name+"(Instance)",this._materialsInstance[$F]=!0,this._changeMaterialReference(this._materials[$F],$i),this._materials[$F]=$i;},$F._setShaderValuelightMap=function($R){this._setShaderValueTexture(3,$R);},$F._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0;},$F._renderRenderableBoundBox=function(){var $R=$mF._debugPhasorSprite,$F=this.boundingBox,$i=$j._tempBoundBoxCorners;$F.getCorners($i),$R.line($i[0],$j._greenColor,$i[1],$j._greenColor),$R.line($i[2],$j._greenColor,$i[3],$j._greenColor),$R.line($i[4],$j._greenColor,$i[5],$j._greenColor),$R.line($i[6],$j._greenColor,$i[7],$j._greenColor),$R.line($i[0],$j._greenColor,$i[3],$j._greenColor),$R.line($i[1],$j._greenColor,$i[2],$j._greenColor),$R.line($i[2],$j._greenColor,$i[6],$j._greenColor),$R.line($i[3],$j._greenColor,$i[7],$j._greenColor),$R.line($i[0],$j._greenColor,$i[4],$j._greenColor),$R.line($i[1],$j._greenColor,$i[5],$j._greenColor),$R.line($i[4],$j._greenColor,$i[7],$j._greenColor),$R.line($i[5],$j._greenColor,$i[6],$j._greenColor);},$F._calculateBoundingSphere=function(){throw"BaseRender: must override it.";},$F._calculateBoundingBox=function(){throw"BaseRender: must override it.";},$F._setShaderValueTexture=function($R,$F){this._owner._shaderValues.setValue($R,$F);},$F._setShaderValueMatrix4x4=function($R,$F){this._owner._shaderValues.setValue($R,$F?$F.elements:null);},$F._setShaderValueColor=function($R,$F){this._owner._shaderValues.setValue($R,$F?$F.elements:null);},$F._setShaderValueBuffer=function($R,$F){this._owner._shaderValues.setValue($R,$F);},$F._setShaderValueInt=function($R,$F){this._owner._shaderValues.setValue($R,$F);},$F._setShaderValueBool=function($R,$F){this._owner._shaderValues.setValue($R,$F);},$F._setShaderValueNumber=function($R,$F){this._owner._shaderValues.setValue($R,$F);},$F._setShaderValueVector2=function($R,$F){this._owner._shaderValues.setValue($R,$F?$F.elements:null);},$F._addShaderDefine=function($R){this._owner._shaderDefineValue|=$R;},$F._removeShaderDefine=function($R){this._owner._shaderDefineValue&=~$R;},$F._renderUpdate=function($R){return!0;},$F._applyLightMapParams=function(){if(0<=this._lightmapIndex){var $R=this._owner.scene;if($R){var $F=$R.getlightmaps()[this._lightmapIndex];$F?(this._addShaderDefine($oF.SAHDERDEFINE_LIGHTMAP),$F.loaded?this._setShaderValuelightMap($F):$F.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine($oF.SAHDERDEFINE_LIGHTMAP);}else this._removeShaderDefine($oF.SAHDERDEFINE_LIGHTMAP);}else this._removeShaderDefine($oF.SAHDERDEFINE_LIGHTMAP);},$F._updateOctreeNode=function(){var $R=this._treeNode;$R&&this._octreeNodeNeedChange&&($R.updateObject(this),this._octreeNodeNeedChange=!1);},$F._destroy=function(){this.offAll();var $R=0,$F=0;for($R=0,$F=this._renderElements.length;$R<$F;$R++)this._renderElements[$R]._destroy();for($R=0,$F=this._materials.length;$R<$F;$R++)this._materials[$R]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0;},$S(0,$F,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere;}),$S(0,$F,"id",function(){return this._id;}),$S(0,$F,"material",function(){var $R=this._materials[0];if($R&&!this._materialsInstance[0]){var $F=this._getInstanceMaterial($R,0);this.event("materialchanged",[this,0,$F]);}return this._materials[0];},function($R){this.sharedMaterial=$R;}),$S(0,$F,"sharedMaterial",function(){return this._materials[0];},function($R){var $F=this._materials[0];$F!==$R&&(this._materials[0]=$R,this._materialsInstance[0]=!1,this._changeMaterialReference($F,$R),this.event("materialchanged",[this,0,$R]));}),$S(0,$F,"lightmapIndex",function(){return this._lightmapIndex;},function($R){this._lightmapIndex=$R,this._applyLightMapParams();}),$S(0,$F,"lightmapScaleOffset",function(){return this._lightmapScaleOffset;},function($R){this._lightmapScaleOffset=$R,this._setShaderValueColor(2,$R),this._addShaderDefine($oF.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV);}),$S(0,$F,"enable",function(){return this._enable;},function($R){this._enable=$R,this.event("enablechanged",[this,$R]);}),$S(0,$F,"materials",function(){for(var $R=0,$F=this._materials.length;$R<$F;$R++)if(!this._materialsInstance[$R]){var $i=this._getInstanceMaterial(this._materials[$R],$R);this.event("materialchanged",[this,$R,$i]);}return this._materials.slice();},function($R){this.sharedMaterials=$R;}),$S(0,$F,"sharedMaterials",function(){return this._materials.slice();},function($R){if(!$R)throw new Error("MeshRender: shadredMaterials value can't be null.");var $F=$R.length;this._materialsInstance.length=$F;for(var $i=0;$i<$F;$i++){var $j=this._materials[$i];$j!==$R[$i]&&(this._materialsInstance[$i]=!1,this._changeMaterialReference($j,$R[$i]),this.event("materialchanged",[this,$i,$R[$i]]));}this._materials=$R;}),$S(0,$F,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox;}),$S(0,$F,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var $R=this.boundingBox;$$F.add($R.min,$R.max,this._boundingBoxCenter),$$F.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1;}return this._boundingBoxCenter;}),$S(0,$F,"receiveShadow",function(){return this._receiveShadow;},function($R){this._receiveShadow!==$R&&((this._receiveShadow=$R)?this._addShaderDefine($hF.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine($hF.SHADERDEFINE_RECEIVE_SHADOW));}),$S(0,$F,"destroyed",function(){return this._destroyed;}),$j._uniqueIDCounter=0,$s($j,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new $$F(),new $$F(),new $$F(),new $$F(),new $$F(),new $$F(),new $$F(),new $$F()];},"_greenColor",function(){return this._greenColor=new $VF(0,1,0,1);}]),$j;}(),$XF=function($R){function $V($R){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,$V.__super.call(this),this._localPosition=new $$F(),this._localRotation=new $iF(0,0,0,1),this._localScale=new $$F(1,1,1),this._localRotationEuler=new $$F(),this._localMatrix=new $RF(),this._position=new $$F(),this._rotation=new $iF(0,0,0,1),this._scale=new $$F(1,1,1),this._worldMatrix=new $RF(),this._forward=new $$F(),this._up=new $$F(),this._right=new $$F(),this._owner=$R,this._childs=[];}$h($V,"laya.d3.core.Transform3D",$p);var $F=$V.prototype;return $F._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)$RF.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var $R=$V._tempVector30;$$F.multiply(this.pivot,this._localScale,$R);var $F=$V._tempVector31;$$F.subtract($R,this.pivot,$F);var $i=$V._tempVector32,$j=this.localRotation;$$F.transformQuat($R,$j,$i),$$F.subtract($i,$R,$i);var $t=$V._tempVector33;$$F.subtract(this._localPosition,$F,$t),$$F.subtract($t,$i,$t),$RF.createAffineTransformation($t,$j,this._localScale,this._localMatrix);}},$F._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $R=0,$F=this._childs.length;$R<$F;$R++)this._childs[$R]._onWorldPositionRotationTransform();}},$F._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $R=0,$F=this._childs.length;$R<$F;$R++)this._childs[$R]._onWorldPositionScaleTransform();}},$F._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var $R=0,$F=this._childs.length;$R<$F;$R++)this._childs[$R]._onWorldPositionTransform();}},$F._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $R=0,$F=this._childs.length;$R<$F;$R++)this._childs[$R]._onWorldPositionRotationTransform();}},$F._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $R=0,$F=this._childs.length;$R<$F;$R++)this._childs[$R]._onWorldPositionScaleTransform();}},$F._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $R=0,$F=this._childs.length;$R<$F;$R++)this._childs[$R]._onWorldTransform();}},$F.translate=function($R,$F){void 0===$F&&($F=!0),$F?($RF.createFromQuaternion(this.localRotation,$V._tempMatrix0),$$F.transformCoordinate($R,$V._tempMatrix0,$V._tempVector30),$$F.add(this.localPosition,$V._tempVector30,this._localPosition),this.localPosition=this._localPosition):($$F.add(this.position,$R,this._position),this.position=this._position);},$F.rotate=function($R,$F,$i){var $j;void 0===$F&&($F=!0),void 0===$i&&($i=!0),$j=$i?$R:($$F.scale($R,Math.PI/180,$V._tempVector30),$V._tempVector30),$iF.createFromYawPitchRoll($j.y,$j.x,$j.z,$V._tempQuaternion0),$F?($iF.multiply(this._localRotation,$V._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):($iF.multiply($V._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation);},$F.lookAt=function($R,$F,$i){void 0===$i&&($i=!1);var $j,$t=$R.elements;if($i){if($j=this._localPosition.elements,Math.abs($j[0]-$t[0])<$IR.zeroTolerance&&Math.abs($j[1]-$t[1])<$IR.zeroTolerance&&Math.abs($j[2]-$t[2])<$IR.zeroTolerance)return;$iF.lookAt(this._localPosition,$R,$F,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation;}else{var $p=this.position;if($j=$p.elements,Math.abs($j[0]-$t[0])<$IR.zeroTolerance&&Math.abs($j[1]-$t[1])<$IR.zeroTolerance&&Math.abs($j[2]-$t[2])<$IR.zeroTolerance)return;$iF.lookAt($p,$R,$F,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation;}},$S(0,$F,"_isFrontFaceInvert",function(){var $R=this.scale,$F=$R.x<0;return $R.y<0&&($F=!$F),$R.z<0&&($F=!$F),$F;}),$S(0,$F,"owner",function(){return this._owner;}),$S(0,$F,"localRotation",function(){if(this._localQuaternionUpdate){var $R=this._localRotationEuler.elements;$iF.createFromYawPitchRoll($R[1]/$V._angleToRandin,$R[0]/$V._angleToRandin,$R[2]/$V._angleToRandin,this._localRotation);}return this._localRotation;},function($R){this._localRotation=$R,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform();}),$S(0,$F,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?$RF.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix;},function($R){null===this._parent?$R.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),$RF.multiply(this._localMatrix,$R,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=$R,this._worldUpdate=!1;}),$S(0,$F,"worldNeedUpdate",function(){return this._worldUpdate;}),$S(0,$F,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix;},function($R){this._localMatrix=$R,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform();}),$S(0,$F,"dummy",function(){return this._dummy;},function($R){this._dummy!==$R&&(this._dummy&&(this._dummy._entity=null),$R&&($R._entity=this),this._dummy=$R);}),$S(0,$F,"localPosition",function(){return this._localPosition;},function($R){this._localPosition=$R,this._localUpdate=!0,this._onWorldPositionTransform();}),$S(0,$F,"position",function(){if(this._positionUpdate){if(null!=this._parent){var $R=this._parent.position;$$F.multiply(this._localPosition,this._parent.scale,$V._tempVector30),$$F.transformQuat($V._tempVector30,this._parent.rotation,$V._tempVector30),$$F.add($R,$V._tempVector30,this._position);}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1;}return this._position;},function($R){if(null!=this._parent){$$F.subtract($R,this._parent.position,this._localPosition);var $F=this._parent.scale.elements,$i=$F[0],$j=$F[1],$t=$F[2];if(1!==$i||1!==$j||1!==$t){var $p=$V._tempVector30,$$=$p.elements;$$[0]=1/$i,$$[1]=1/$j,$$[2]=1/$t,$$F.multiply(this._localPosition,$p,this._localPosition);}this._parent.rotation.invert($V._tempQuaternion0),$$F.transformQuat(this._localPosition,$V._tempQuaternion0,this._localPosition);}else $R.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=$R,this._positionUpdate=!1;}),$S(0,$F,"localScale",function(){return this._localScale;},function($R){this._localScale=$R,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform();}),$S(0,$F,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll($V._tempVector30);var $R=$V._tempVector30.elements,$F=this._localRotationEuler.elements;$F[0]=$R[1]*$V._angleToRandin,$F[1]=$R[0]*$V._angleToRandin,$F[2]=$R[2]*$V._angleToRandin;}return this._localRotationEuler;},function($R){this._localRotationEuler=$R,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform();}),$S(0,$F,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?$iF.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation;},function($R){null!=this._parent?(this._parent.rotation.invert($V._tempQuaternion0),$iF.multiply($R,$V._tempQuaternion0,this._localRotation)):$R.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=$R,this._rotationUpdate=!1;}),$S(0,$F,"scale",function(){return this._scaleUpdate&&(null!==this._parent?$$F.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale;},function($R){if(null!==this._parent){var $F=this._parent.scale.elements,$i=$V._tempVector30.elements;$i[0]=1/$F[0],$i[1]=1/$F[1],$i[2]=1/$F[2],$$F.multiply($R,$V._tempVector30,this._localScale);}else $R.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=$R,this._scaleUpdate=!1;}),$S(0,$F,"rotationEuler",null,function($R){$iF.createFromYawPitchRoll($R.y,$R.x,$R.z,this._rotation),this.rotation=this._rotation;}),$S(0,$F,"forward",function(){var $R=this.worldMatrix.elements;return this._forward.elements[0]=-$R[8],this._forward.elements[1]=-$R[9],this._forward.elements[2]=-$R[10],this._forward;}),$S(0,$F,"up",function(){var $R=this.worldMatrix.elements;return this._up.elements[0]=$R[4],this._up.elements[1]=$R[5],this._up.elements[2]=$R[6],this._up;}),$S(0,$F,"right",function(){var $R=this.worldMatrix.elements;return this._right.elements[0]=$R[0],this._right.elements[1]=$R[1],this._right.elements[2]=$R[2],this._right;}),$S(0,$F,"parent",function(){return this._parent;},function($R){if(this._parent!==$R){if(this._parent){var $F=this._parent._childs,$i=$F.indexOf(this);$F.splice($i,1);}$R&&($R._childs.push(this),$R&&this._onWorldTransform()),this._parent=$R;}}),$s($V,["_tempVector30",function(){return this._tempVector30=new $$F();},"_tempVector31",function(){return this._tempVector31=new $$F();},"_tempVector32",function(){return this._tempVector32=new $$F();},"_tempVector33",function(){return this._tempVector33=new $$F();},"_tempQuaternion0",function(){return this._tempQuaternion0=new $iF();},"_tempMatrix0",function(){return this._tempMatrix0=new $RF();},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI;}]),$V;}(),$HF=(function($R){function $F(){this._rotation=0,this._matNeedUpdte=!1,$F.__super.call(this),this._matrix=new $RF(),this._offset=new $pF(),this._tiling=new $pF(1,1);}$h($F,"laya.d3.core.TransformUV",$p);var $i=$F.prototype;$w.imps($i,{"laya.d3.core.IClone":!0}),$i._updateMatrix=function(){$F._tempOffsetV3.elements[0]=this._offset.x,$F._tempOffsetV3.elements[1]=this._offset.y,$iF.createFromYawPitchRoll(0,0,this._rotation,$F._tempRotationQua),$F._tempTitlingV3.elements[0]=this._tiling.x,$F._tempTitlingV3.elements[1]=this._tiling.y,$RF.createAffineTransformation($F._tempOffsetV3,$F._tempRotationQua,$F._tempTitlingV3,this._matrix);},$i.cloneTo=function($R){$R._matrix=this._matrix.clone(),$R._offset=this._offset.clone(),$R._rotation=this._rotation,$R._tiling=this._tiling.clone();},$i.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$i,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix;}),$S(0,$i,"tiling",function(){return this._tiling;},function($R){this._tiling=$R,this._matNeedUpdte=!0;}),$S(0,$i,"offset",function(){return this._offset;},function($R){this._offset=$R,this._matNeedUpdte=!0;}),$S(0,$i,"rotation",function(){return this._rotation;},function($R){this._rotation=$R,this._matNeedUpdte=!0;}),$s($F,["_tempOffsetV3",function(){return this._tempOffsetV3=new $$F(0,0,0);},"_tempRotationQua",function(){return this._tempRotationQua=new $iF();},"_tempTitlingV3",function(){return this._tempTitlingV3=new $$F(1,1,1);}]);}(),function($i){function $R(){this.x=NaN,this.y=NaN,this.z=NaN,$R.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1;}$h($R,"laya.d3.core.particleShuriKen.module.shape.BoxShape",$i);var $F=$R.prototype;$F._getShapeBoundBox=function($R){var $F=$R.min.elements;$F[0]=.5*-this.x,$F[1]=.5*-this.y,$F[2]=.5*-this.z;var $i=$R.max.elements;$i[0]=.5*this.x,$i[1]=.5*this.y,$i[2]=.5*this.z;},$F._getSpeedBoundBox=function($R){var $F=$R.min.elements;$F[0]=0,$F[1]=0,$F[2]=0;var $i=$R.max.elements;$i[0]=0,$i[1]=1,$i[2]=0;},$F.generatePositionAndDirection=function($R,$F,$i,$j){var $t=$R.elements,$p=$F.elements;$i?($i.seed=$j[16],$l._randomPointInsideHalfUnitBox($R,$i),$j[16]=$i.seed):$l._randomPointInsideHalfUnitBox($R),$t[0]=this.x*$t[0],$t[1]=this.y*$t[1],$t[2]=this.z*$t[2],this.randomDirection?$i?($i.seed=$j[17],$l._randomPointUnitSphere($F,$i),$j[17]=$i.seed):$l._randomPointUnitSphere($F):($p[0]=0,$p[1]=0,$p[2]=1);},$F.cloneTo=function($R){$i.prototype.cloneTo.call(this,$R);var $F=$R;$F.x=this.x,$F.y=this.y,$F.z=this.z,$F.randomDirection=this.randomDirection;};}($b),function($i){function $$(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,$$.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1;}$h($$,"laya.d3.core.particleShuriKen.module.shape.CircleShape",$i);var $R=$$.prototype;$R._getShapeBoundBox=function($R){var $F=$R.min.elements;$F[0]=$F[2]=-this.radius,$F[1]=0;var $i=$R.max.elements;$i[0]=$i[2]=this.radius,$i[1]=0;},$R._getSpeedBoundBox=function($R){var $F=$R.min.elements;$F[0]=$F[1]=-1,$F[2]=0;var $i=$R.max.elements;$i[0]=$i[1]=1,$i[2]=0;},$R.generatePositionAndDirection=function($R,$F,$i,$j){var $t=$R.elements,$p=$$._tempPositionPoint.elements;$i?($i.seed=$j[16],this.emitFromEdge?$l._randomPointUnitArcCircle(this.arc,$$._tempPositionPoint,$i):$l._randomPointInsideUnitArcCircle(this.arc,$$._tempPositionPoint,$i),$j[16]=$i.seed):this.emitFromEdge?$l._randomPointUnitArcCircle(this.arc,$$._tempPositionPoint):$l._randomPointInsideUnitArcCircle(this.arc,$$._tempPositionPoint),$t[0]=-$p[0],$t[1]=$p[1],$t[2]=0,$$F.scale($R,this.radius,$R),this.randomDirection?$i?($i.seed=$j[17],$l._randomPointUnitSphere($F,$i),$j[17]=$i.seed):$l._randomPointUnitSphere($F):$R.cloneTo($F);},$R.cloneTo=function($R){$i.prototype.cloneTo.call(this,$R);var $F=$R;$F.radius=this.radius,$F.arc=this.arc,$F.emitFromEdge=this.emitFromEdge,$F.randomDirection=this.randomDirection;},$s($$,["_tempPositionPoint",function(){return this._tempPositionPoint=new $pF();}]);}($b),function($i){function $k(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,$k.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1;}$h($k,"laya.d3.core.particleShuriKen.module.shape.ConeShape",$i);var $R=$k.prototype;$R._getShapeBoundBox=function($R){var $F=this.radius+this.length*Math.sin(this.angle),$i=this.length*Math.cos(this.angle),$j=$R.min.elements;$j[0]=$j[1]=-$F,$j[2]=0;var $t=$R.max.elements;$t[0]=$t[1]=$F,$t[2]=$i;},$R._getSpeedBoundBox=function($R){var $F=Math.sin(this.angle),$i=$R.min.elements;$i[0]=$i[1]=-$F,$i[2]=0;var $j=$R.max.elements;$j[0]=$i[1]=$F,$j[2]=1;},$R.generatePositionAndDirection=function($R,$F,$i,$j){var $t,$p=$R.elements,$$=$F.elements,$V=$k._tempPositionPoint.elements,$N=NaN,$c=NaN,$q=Math.cos(this.angle),$s=Math.sin(this.angle);switch(this.emitType){case 0:$i?($i.seed=$j[16],$l._randomPointInsideUnitCircle($k._tempPositionPoint,$i),$j[16]=$i.seed):$l._randomPointInsideUnitCircle($k._tempPositionPoint),$N=$V[0],$c=$V[1],$p[0]=$N*this.radius,$p[1]=$c*this.radius,$p[2]=0,this.randomDirection?($i?($i.seed=$j[17],$l._randomPointInsideUnitCircle($k._tempDirectionPoint,$i),$j[17]=$i.seed):$l._randomPointInsideUnitCircle($k._tempDirectionPoint),$t=$k._tempDirectionPoint.elements,$$[0]=$t[0]*$s,$$[1]=$t[1]*$s):($$[0]=$N*$s,$$[1]=$c*$s),$$[2]=$q;break;case 1:$i?($i.seed=$j[16],$l._randomPointUnitCircle($k._tempPositionPoint,$i),$j[16]=$i.seed):$l._randomPointUnitCircle($k._tempPositionPoint),$N=$V[0],$c=$V[1],$p[0]=$N*this.radius,$p[1]=$c*this.radius,$p[2]=0,this.randomDirection?($i?($i.seed=$j[17],$l._randomPointInsideUnitCircle($k._tempDirectionPoint,$i),$j[17]=$i.seed):$l._randomPointInsideUnitCircle($k._tempDirectionPoint),$t=$k._tempDirectionPoint.elements,$$[0]=$t[0]*$s,$$[1]=$t[1]*$s):($$[0]=$N*$s,$$[1]=$c*$s),$$[2]=$q;break;case 2:$i?($i.seed=$j[16],$l._randomPointInsideUnitCircle($k._tempPositionPoint,$i)):$l._randomPointInsideUnitCircle($k._tempPositionPoint),$N=$V[0],$c=$V[1],$p[0]=$N*this.radius,$p[1]=$c*this.radius,$$[$p[2]=0]=$N*$s,$$[1]=$c*$s,$$[2]=$q,$$F.normalize($F,$F),$i?($$F.scale($F,this.length*$i.getFloat(),$F),$j[16]=$i.seed):$$F.scale($F,this.length*Math.random(),$F),$$F.add($R,$F,$R),this.randomDirection&&($i?($i.seed=$j[17],$l._randomPointUnitSphere($F,$i),$j[17]=$i.seed):$l._randomPointUnitSphere($F));break;case 3:$i?($i.seed=$j[16],$l._randomPointUnitCircle($k._tempPositionPoint,$i)):$l._randomPointUnitCircle($k._tempPositionPoint),$N=$V[0],$c=$V[1],$p[0]=$N*this.radius,$p[1]=$c*this.radius,$$[$p[2]=0]=$N*$s,$$[1]=$c*$s,$$[2]=$q,$$F.normalize($F,$F),$i?($$F.scale($F,this.length*$i.getFloat(),$F),$j[16]=$i.seed):$$F.scale($F,this.length*Math.random(),$F),$$F.add($R,$F,$R),this.randomDirection&&($i?($i.seed=$j[17],$l._randomPointUnitSphere($F,$i),$j[17]=$i.seed):$l._randomPointUnitSphere($F));break;default:throw new Error("ConeShape:emitType is invalid.");}},$R.cloneTo=function($R){$i.prototype.cloneTo.call(this,$R);var $F=$R;$F.angle=this.angle,$F.radius=this.radius,$F.length=this.length,$F.emitType=this.emitType,$F.randomDirection=this.randomDirection;},$s($k,["_tempPositionPoint",function(){return this._tempPositionPoint=new $pF();},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new $pF();}]);}($b),function($i){function $R(){this.radius=NaN,this.emitFromShell=!1,$R.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1;}$h($R,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",$i);var $F=$R.prototype;$F._getShapeBoundBox=function($R){var $F=$R.min.elements;$F[0]=$F[1]=$F[2]=-this.radius;var $i=$R.max.elements;$i[0]=$i[1]=this.radius,$i[2]=0;},$F._getSpeedBoundBox=function($R){var $F=$R.min.elements;$F[0]=$F[1]=-1,$F[2]=0;var $i=$R.max.elements;$i[0]=$i[1]=$i[2]=1;},$F.generatePositionAndDirection=function($R,$F,$i,$j){var $t=$R.elements;$i?($i.seed=$j[16],this.emitFromShell?$l._randomPointUnitSphere($R,$i):$l._randomPointInsideUnitSphere($R,$i),$j[16]=$i.seed):this.emitFromShell?$l._randomPointUnitSphere($R):$l._randomPointInsideUnitSphere($R),$$F.scale($R,this.radius,$R);var $p=$t[2];$p<0&&($t[2]=-1*$p),this.randomDirection?$i?($i.seed=$j[17],$l._randomPointUnitSphere($F,$i),$j[17]=$i.seed):$l._randomPointUnitSphere($F):$R.cloneTo($F);},$F.cloneTo=function($R){$i.prototype.cloneTo.call(this,$R);var $F=$R;$F.radius=this.radius,$F.emitFromShell=this.emitFromShell,$F.randomDirection=this.randomDirection;};}($b),function($i){function $R(){this.radius=NaN,this.emitFromShell=!1,$R.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1;}$h($R,"laya.d3.core.particleShuriKen.module.shape.SphereShape",$i);var $F=$R.prototype;$F._getShapeBoundBox=function($R){var $F=$R.min.elements;$F[0]=$F[1]=$F[2]=-this.radius;var $i=$R.max.elements;$i[0]=$i[1]=$i[2]=this.radius;},$F._getSpeedBoundBox=function($R){var $F=$R.min.elements;$F[0]=$F[1]=$F[2]=-1;var $i=$R.max.elements;$i[0]=$i[1]=$i[2]=1;},$F.generatePositionAndDirection=function($R,$F,$i,$j){$i?($i.seed=$j[16],this.emitFromShell?$l._randomPointUnitSphere($R,$i):$l._randomPointInsideUnitSphere($R,$i),$j[16]=$i.seed):this.emitFromShell?$l._randomPointUnitSphere($R):$l._randomPointInsideUnitSphere($R),$$F.scale($R,this.radius,$R),this.randomDirection?$i?($i.seed=$j[17],$l._randomPointUnitSphere($F,$i),$j[17]=$i.seed):$l._randomPointUnitSphere($F):$R.cloneTo($F);},$F.cloneTo=function($R){$i.prototype.cloneTo.call(this,$R);var $F=$R;$F.radius=this.radius,$F.emitFromShell=this.emitFromShell,$F.randomDirection=this.randomDirection;};}($b),function($R){function $F(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,$F.__super.call(this);}return $h($F,"laya.d3.core.render.SubMeshRenderElement",$n),$F;}()),$_F=function($R){function $a($R,$F,$i,$j,$t,$p){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=$R,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[$hF.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[$oF.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[$oF.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[$zF.SHADERDEFINE_ALPHATEST]="ALPHATEST";$a.__super.call(this,$R,$F,$i,null,{}),this._attributeMap=$j;var $$;for($$ in $t){var $V=$t[$$];switch($V[1]){case 0:this._renderElementUniformMap[$$]=$V[0];break;case 1:this._materialUniformMap[$$]=$V[0];break;case 2:this._spriteUniformMap[$$]=$V[0];break;case 3:this._cameraUniformMap[$$]=$V[0];break;case 4:this._sceneUniformMap[$$]=$V[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.");}}}$h($a,"laya.d3.shader.ShaderCompile3D",$J);var $F=$a.prototype;return $F._definesToNameDic=function($R,$F){for(var $i={},$j=1,$t=0;$t<32&&!($R<($j=1<<$t));$t++)if($R&$j){var $p=$F[$j];$p&&($i[$p]="");}return $i;},$F.withCompile=function($R,$F,$i,$j){var $t,$p,$$;if($p=this.sharders[$R]){if($$=$p[$F]){if($t=$$[$i])return $t;}else $$=$p[$F]=[];}else $$=($p=this.sharders[$R]=[])[$F]=[];var $V,$N=this._definesToNameDic($R,$a._globalInt2name),$c=this._definesToNameDic($F,this._spriteInt2name),$q=this._definesToNameDic($i,this._materialInt2name),$s={},$k="";if($N)for($V in $N)$k+="#define "+$V+"\n",$s[$V]=!0;if($c)for($V in $c)$k+="#define "+$V+"\n",$s[$V]=!0;if($q)for($V in $q)$k+="#define "+$V+"\n",$s[$V]=!0;var $h=$KF.nameKey.getName(this._name)+" compile ("+$R+","+$F+","+$i+")",$S=this._VS.toscript($s,[]),$x=this._PS.toscript($s,[]);$f.now();if($t=$KF.create($k+$S.join("\n"),$k+$x.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,$j,$h),$$[$i]=$t,laya.d3.shader.ShaderCompile3D.debugMode)$f.now();return $t;},$F.precompileShaderWithShaderDefine=function($R,$F,$i){this.withCompile($R,$F,$i,!0);},$F.addMaterialDefines=function($R){var $F=$R.defines;for(var $i in $F){var $j=$F[$i],$t=parseInt($i);this._materialInt2name[$t]=$j,this._materialName2Int[$j]=$t;}},$F.addSpriteDefines=function($R){var $F=$R.defines;for(var $i in $F){var $j=$F[$i],$t=parseInt($i);this._spriteInt2name[$t]=$j,this._spriteName2Int[$j]=$t;}},$F.getMaterialDefineByName=function($R){return this._materialName2Int[$R];},$F.registerMaterialDefine=function($R){var $F=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[$F]=$R,this._materialName2Int[$R]=$F;},$F.registerSpriteDefine=function($R){var $F=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[$F]=$R,this._spriteName2Int[$R]=$F;},$a._globalRegDefine=function($R,$F){$a._globalInt2name[$F]=$R;},$a.add=function($R,$F,$i,$j,$t){return laya.d3.shader.ShaderCompile3D._preCompileShader[$R]=new $a($R,$F,$i,$j,$t,$J.includes);},$a.get=function($R){return laya.d3.shader.ShaderCompile3D._preCompileShader[$KF.nameKey.getID($R)];},$a._preCompileShader={},$a._globalInt2name=[],$a.debugMode=!1,$a.SHADERDEFINE_HIGHPRECISION=1,$a.SHADERDEFINE_FOG=4,$a.SHADERDEFINE_DIRECTIONLIGHT=8,$a.SHADERDEFINE_POINTLIGHT=16,$a.SHADERDEFINE_SPOTLIGHT=32,$a.SHADERDEFINE_UV0=64,$a.SHADERDEFINE_COLOR=128,$a.SHADERDEFINE_UV1=256,$a.SAHDERDEFINE_DEPTHFOG=131072,$a;}(),$TF=function($R){function $S(){$S.__super.call(this);}$h($S,"laya.d3.graphics.MeshSprite3DStaticBatchManager",$jR);var $F=$S.prototype;return $F._getStaticBatch=function($R,$F,$i,$j){var $t,$p;return $p=$R?$R.id.toString()+$i.id.toString()+$F.id.toString()+$j.toString():$i.id.toString()+$F.id.toString()+$j.toString(),this._staticBatches[$p]?$t=this._staticBatches[$p]:this._staticBatches[$p]=$t=new $gF($p,this,$R,$F,$i),$t;},$F._initStaticBatchs=function($R){var $F,$i;this._initBatchRenderElements.sort($S._sortPrepareStaticBatch);for(var $j,$t=!1,$p=0,$$=0,$V=this._initBatchRenderElements.length;$$<$V;$$++){var $N,$c=this._initBatchRenderElements[$$],$q=$c.renderObj._getVertexBuffer(0);$c._sprite3D;if($i===$q.vertexDeclaration&&$F===$c._material){if($t)$j._addCombineBatchRenderObjTest($c)?($N=$c._staticBatch)!==$j&&($N&&$N._deleteCombineBatchRenderObj($c),$j._addCombineBatchRenderObj($c)):($t=!1,$p++);else{var $s=this._initBatchRenderElements[$$-1],$k=$s.renderObj,$h=$c.renderObj;$t=!(65535<$k._getVertexBuffer().vertexCount+$h._getVertexBuffer().vertexCount)&&($j=this._getStaticBatch($R,$i,$F,$p),($N=$s._staticBatch)!==$j&&($N&&$N._deleteCombineBatchRenderObj($s),$j._addCombineBatchRenderObj($s)),($N=$c._staticBatch)!==$j&&($N&&$N._deleteCombineBatchRenderObj($c),$j._addCombineBatchRenderObj($c)),!0);}}else $t=!1,$p=0;$F=$c._material,$i=$q.vertexDeclaration;}},$S._sortPrepareStaticBatch=function($R,$F){var $i=$R._render,$j=$F._render,$t=$i.lightmapIndex-$j.lightmapIndex;if(0!=$t)return $t;var $p=$i.receiveShadow-$j.receiveShadow;if(0!=$p)return $p;var $$=$R._mainSortID-$F._mainSortID;return 0==$$?$R.renderObj.triangleCount-$F.renderObj.triangleCount:$$;},$S;}(),$gF=function($R){function $p($R,$F,$i,$j,$t){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,$p.__super.call(this,$R,$F,$i),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=$j,this._material=$t;}$h($p,"laya.d3.graphics.SubMeshStaticBatch",$tR);var $F=$p.prototype;return $F._compareBatchRenderElement=function($R,$F){return $R._batchIndexStart>$F._batchIndexStart;},$F._addCombineBatchRenderObjTest=function($R){var $F=$R.renderObj._vertexCount;return!(65535<(0<$F?this._currentCombineVertexCount+$F:this._currentCombineVertexCount+$R.renderObj._getVertexBuffer().vertexCount));},$F._addCombineBatchRenderObj=function($R){var $F=$R.renderObj,$i=$F._vertexCount;this._initBatchRenderElements.push($R),$R._staticBatch=this,0<$i?(this._currentCombineIndexCount+=$F._indexCount,this._currentCombineVertexCount+=$i):(this._currentCombineIndexCount=this._currentCombineIndexCount+$F._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$F._getVertexBuffer().vertexCount),this._needFinishCombine=!0;},$F._deleteCombineBatchRenderObj=function($R){var $F=$R.renderObj,$i=this._initBatchRenderElements.indexOf($R);if(-1!==$i){this._initBatchRenderElements.splice($i,1),$R._staticBatch=null;var $j=$F._vertexCount;0<$j?(this._currentCombineIndexCount=this._currentCombineIndexCount-$F._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$j):(this._currentCombineIndexCount=this._currentCombineIndexCount-$F._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$F._getVertexBuffer().vertexCount),this._needFinishCombine=!0;}},$F._finishInit=function(){if(this._needFinishCombine){var $R=0,$F=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var $i=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),$j=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=$bF.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=$QF.create("ushort",this._currentCombineIndexCount,35044);for(var $t=0,$p=this._initBatchRenderElements.length;$t<$p;$t++){var $$=this._initBatchRenderElements[$t],$V=$$.renderObj,$N=$V._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,$$._sprite3D),$c=$V.getIndices(),$q=$$._sprite3D.transform._isFrontFaceInvert,$s=$R/(this._vertexDeclaration.vertexStride/4)-$V._vertexStart,$k=$F,$h=$k+$c.length;$$._batchIndexStart=$k,$$._batchIndexEnd=$h,$j.set($c,$F);var $S=0;if($q)for($S=$k;$S<$h;$S+=3){$j[$S]=$s+$j[$S];var $x=$j[$S+1],$a=$j[$S+2];$j[$S+1]=$s+$a,$j[$S+2]=$s+$x;}else for($S=$k;$S<$h;$S+=3)$j[$S]=$s+$j[$S],$j[$S+1]=$s+$j[$S+1],$j[$S+2]=$s+$j[$S+2];$F+=$c.length,$i.set($N,$R),$R+=$N.length;}this._vertexBuffer.setData($i),this._indexBuffer.setData($j),this._needFinishCombine=!1;}},$F._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new $HF());},$F._getRenderElement=function($R,$F,$i){for(var $j,$t,$p=this._batchRenderElements.length,$$=!0,$V=0;$V<$p;$V++){var $N,$c,$q=($t=this._batchRenderElements[$V])._sprite3D._render;if(0!==$V&&($$=($N=($j=this._batchRenderElements[$V-1])._sprite3D._render).lightmapIndex!==$q.lightmapIndex||$N.receiveShadow!==$q.receiveShadow||$j._batchIndexEnd!==$t._batchIndexStart),$$){($c=this._getCombineRenderElementFromPool()).renderObj=this,$c._material=this._material,$c._batchIndexStart=$t._batchIndexStart,$c._batchIndexEnd=$t._batchIndexEnd;var $s=$q.lightmapIndex,$k=$s+1,$h=this._batchOwnerIndices[$k];$h||($h=this._batchOwnerIndices[$k]=[]);var $S,$x=$h[$t._render.receiveShadow?1:0];void 0===$x?($h[$q.receiveShadow?1:0]=this._batchOwners.length,($S=new $CF(null,"StaticBatchMeshSprite3D"))._scene=$F,$S._transform=this._rootOwner?this._rootOwner._transform:null,$S._render.lightmapIndex=$s,$S._render.receiveShadow=$t._render.receiveShadow,this._batchOwners.push($S)):$S=this._batchOwners[$x],$S._render._renderUpdate($i),$c._sprite3D=$S,$R.push($c);}else $c._batchIndexEnd=$t._batchIndexEnd;}},$F._beforeRender=function($R){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0;},$F._render=function($R){var $F=$R.renderElement,$i=$F._batchIndexStart,$j=$F._batchIndexEnd-$i;$L.mainContext.drawElements(4,$j,5123,2*$i),$_.drawCall++,$_.trianglesFaces+=$j/3;},$F.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy();},$F._getVertexBuffer=function($R){return void 0===$R&&($R=0),this._vertexBuffer;},$p;}(),$BF=function($R){function $F(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,$F.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[];}$h($F,"laya.d3.core.ComponentNode",$c);var $i=$F.prototype;return $i.addComponent=function($R){var $F,$i=this._componentsMap.indexOf($R);if(-1===$i)$F=[],this._componentsMap.push($R),this._typeComponentsIndices.push($F);else if($F=this._typeComponentsIndices[$i],this._components[$F[0]].isSingleton)throw new Error("无法单实例创建"+$R+"组件，"+$R+"组件已存在！");var $j=$t.getInstance($R);return $F.push(this._components.length),this._components.push($j),$j instanceof laya.d3.component.Script&&this._scripts.push($j),$j._initialize(this),$j;},$i._removeComponent=function($R,$F){var $i=this._typeComponentsIndices[$R],$j=$i[$F],$t=this._components[$j];this._components.splice($j,1),$t instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($t),1),$i.splice($F,1),0===$i.length&&(this._typeComponentsIndices.splice($R,1),this._componentsMap.splice($R,1));for(var $p=0,$$=this._componentsMap.length;$p<$$;$p++)for(var $V=($i=this._typeComponentsIndices[$p]).length-1;0<=$V;$V--){var $N=$i[$V];if(!($j<$N))break;$i[$V]=--$N;}$t._destroy();},$i.getComponentByType=function($R,$F){void 0===$F&&($F=0);var $i=this._componentsMap.indexOf($R);return-1===$i?null:this._components[this._typeComponentsIndices[$i][$F]];},$i.getComponentsByType=function($R,$F){var $i=this._componentsMap.indexOf($R);if(-1!==$i){var $j=this._typeComponentsIndices[$i],$t=$j.length;$F.length=$t;for(var $p=0;$p<$t;$p++)$F[$p]=this._components[$j[$p]];}else $F.length=0;},$i.getComponentByIndex=function($R){return this._components[$R];},$i.removeComponentByType=function($R,$F){void 0===$F&&($F=0);var $i=this._componentsMap.indexOf($R);-1!==$i&&this._removeComponent($i,$F);},$i.removeComponentsByType=function($R){var $F=this._componentsMap.indexOf($R);if(-1!==$F)for(var $i=this._typeComponentsIndices[$F],$j=0,$t=$i.length;$j<$t;$i.length<$t?$t--:$j++)this._removeComponent($F,$j);},$i.removeAllComponent=function(){for(var $R=0,$F=this._componentsMap.length;$R<$F;this._componentsMap.length<$F?$F--:$R++)this.removeComponentsByType(this._componentsMap[$R]);},$i._updateComponents=function($R){for(var $F=0,$i=this._components.length;$F<$i;$F++){var $j=this._components[$F];!$j.started&&($j._start($R),$j.started=!0),$j.enable&&$j._update($R);}},$i._lateUpdateComponents=function($R){for(var $F=0;$F<this._components.length;$F++){var $i=this._components[$F];!$i.started&&($i._start($R),$i.started=!0),$i.enable&&$i._lateUpdate($R);}},$i._preRenderUpdateComponents=function($R){for(var $F=0;$F<this._components.length;$F++){var $i=this._components[$F];!$i.started&&($i._start($R),$i.started=!0),$i.enable&&$i._preRenderUpdate($R);}},$i._postRenderUpdateComponents=function($R){for(var $F=0;$F<this._components.length;$F++){var $i=this._components[$F];!$i.started&&($i._start($R),$i.started=!0),$i.enable&&$i._postRenderUpdate($R);}},$F;}(),$zF=function($j){function $R(){$R.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new $kF(),this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new $VF(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0;}$h($R,"laya.d3.core.material.BaseMaterial",$j);var $F=$R.prototype;return $w.imps($F,{"laya.d3.core.IClone":!0}),$F._addShaderDefine=function($R){this._shaderDefineValue|=$R;},$F._removeShaderDefine=function($R){this._shaderDefineValue&=~$R;},$F._addDisablePublicShaderDefine=function($R){this._disablePublicShaderDefine|=$R;},$F._removeDisablePublicShaderDefine=function($R){this._disablePublicShaderDefine&=~$R;},$F._setBuffer=function($R,$F){this._shaderValues.setValue($R,$F),this._values[$R]=$F;},$F._getBuffer=function($R){return this._values[$R];},$F._setMatrix4x4=function($R,$F){this._shaderValues.setValue($R,$F?$F.elements:null),this._values[$R]=$F;},$F._getMatrix4x4=function($R){return this._values[$R];},$F._setInt=function($R,$F){this._shaderValues.setValue($R,$F),this._values[$R]=$F;},$F._getInt=function($R){return this._values[$R];},$F._setNumber=function($R,$F){this._shaderValues.setValue($R,$F),this._values[$R]=$F;},$F._getNumber=function($R){return this._values[$R];},$F._setBool=function($R,$F){this._shaderValues.setValue($R,$F),this._values[$R]=$F;},$F._getBool=function($R){return this._values[$R];},$F._setVector2=function($R,$F){this._shaderValues.setValue($R,$F?$F.elements:null),this._values[$R]=$F;},$F._getVector2=function($R){return this._values[$R];},$F._setColor=function($R,$F){this._shaderValues.setValue($R,$F?$F.elements:null),this._values[$R]=$F;},$F._getColor=function($R){return this._values[$R];},$F._setTexture=function($R,$F){var $i=this._values[$R];this._values[$R]=$F,this._shaderValues.setValue($R,$F),0<this.referenceCount&&($i&&$i._removeReference(),$F&&$F._addReference());},$F._getTexture=function($R){return this._values[$R];},$F._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data);},$F._getShader=function($R,$F,$i){var $j=($R|$F)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile($j,$i,this._shaderDefineValue),this._shader;},$F._setRenderStateBlendDepth=function(){var $R=$L.mainContext;switch($Y.setDepthMask($R,this.depthWrite),0===this.depthTest?$Y.setDepthTest($R,!1):($Y.setDepthTest($R,!0),$Y.setDepthFunc($R,this.depthTest)),this.blend){case 0:$Y.setBlend($R,!1);break;case 1:$Y.setBlend($R,!0),$Y.setBlendFunc($R,this.srcBlend,this.dstBlend);break;case 2:$Y.setBlend($R,!0);}},$F._setRenderStateFrontFace=function($R,$F){var $i=$L.mainContext,$j=0;switch(this.cull){case 0:$Y.setCullFace($i,!1);break;case 1:$Y.setCullFace($i,!0),$j=$R?$F&&$F._isFrontFaceInvert?2305:2304:$F&&$F._isFrontFaceInvert?2304:2305,$Y.setFrontFace($i,$j);break;case 2:$Y.setCullFace($i,!0),$j=$R?$F&&$F._isFrontFaceInvert?2304:2305:$F&&$F._isFrontFaceInvert?2305:2304,$Y.setFrontFace($i,$j);}},$F.onAsynLoaded=function($R,$F,$i){var $j=$F[0],$t=$F[1];switch($j.version){case"LAYAMATERIAL:01":var $p=0,$$=0,$V=$j.props;for(var $N in $V)switch($N){case"vectors":var $c=$V[$N];for($p=0,$$=$c.length;$p<$$;$p++){var $q=$c[$p],$s=$q.value;switch($s.length){case 2:this[$q.name]=new $pF($s[0],$s[1]);break;case 3:this[$q.name]=new $$F($s[0],$s[1],$s[2]);break;case 4:this[$q.name]=new $VF($s[0],$s[1],$s[2],$s[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.");}}break;case"textures":var $k=$V[$N];for($p=0,$$=$k.length;$p<$$;$p++){var $h=$k[$p],$S=$h.path;$S&&(this[$h.name]=$m.getRes($t[$S]));}break;case"defines":var $x=$V[$N];for($p=0,$$=$x.length;$p<$$;$p++){var $a=this._shaderCompile.getMaterialDefineByName($x[$p]);this._addShaderDefine($a);}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[$N]=$V[$N];break;case"renderQueue":switch($V[$N]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3;}break;default:this[$N]=$V[$N];}break;case"LAYAMATERIAL:02":for($N in $V=$j.props)switch($N){case"vectors":for($p=0,$$=($c=$V[$N]).length;$p<$$;$p++)switch(($s=($q=$c[$p]).value).length){case 2:this[$q.name]=new $pF($s[0],$s[1]);break;case 3:this[$q.name]=new $$F($s[0],$s[1],$s[2]);break;case 4:this[$q.name]=new $VF($s[0],$s[1],$s[2],$s[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.");}break;case"textures":for($p=0,$$=($k=$V[$N]).length;$p<$$;$p++)($S=($h=$k[$p]).path)&&(this[$h.name]=$m.getRes($t[$S]));break;case"defines":for($p=0,$$=($x=$V[$N]).length;$p<$$;$p++)$a=this._shaderCompile.getMaterialDefineByName($x[$p]),this._addShaderDefine($a);break;default:this[$N]=$V[$N];}break;default:throw new Error("BaseMaterial:unkonwn version.");}this._endLoaded();},$F._addReference=function(){$j.prototype._addReference.call(this);for(var $R=0,$F=this._values.length;$R<$F;$R++){var $i=this._values[$R];$i&&$i instanceof laya.d3.resource.BaseTexture&&$i._addReference();}},$F._removeReference=function(){$j.prototype._removeReference.call(this);for(var $R=0,$F=this._values.length;$R<$F;$R++){var $i=this._values[$R];$i&&$i instanceof laya.d3.resource.BaseTexture&&$i._removeReference();}},$F.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null;},$F.setShaderName=function($R){var $F=$KF.nameKey.getID($R);if(-1===$F)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=$_F._preCompileShader[$F];},$F.cloneTo=function($R){var $F=$R;$F.name=this.name,$F.cull=this.cull,$F.blend=this.blend,$F.srcBlend=this.srcBlend,$F.dstBlend=this.dstBlend,$F.srcBlendRGB=this.srcBlendRGB,$F.dstBlendRGB=this.dstBlendRGB,$F.srcBlendAlpha=this.srcBlendAlpha,$F.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo($F.blendConstColor),$F.blendEquation=this.blendEquation,$F.blendEquationRGB=this.blendEquationRGB,$F.blendEquationAlpha=this.blendEquationAlpha,$F.depthTest=this.depthTest,$F.depthWrite=this.depthWrite,$F.renderQueue=this.renderQueue,$F._shader=this._shader,$F._disablePublicShaderDefine=this._disablePublicShaderDefine,$F._shaderDefineValue=this._shaderDefineValue;var $i,$j=0,$t=$F._shaderValues;$F._shaderValues.data.length=this._shaderValues.data.length;var $p=this._values.length,$$=$F._values;for($j=0,$i=$$.length=$p;$j<$i;$j++){var $V=this._values[$j];if($V)if("number"==typeof $V)$$[$j]=$V,$t.data[$j]=$V;else if("number"==typeof $V&&Math.floor($V)==$V)$$[$j]=$V,$t.data[$j]=$V;else if("boolean"==typeof $V)$$[$j]=$V,$t.data[$j]=$V;else if($V instanceof laya.d3.math.Vector2){var $N=$$[$j]||($$[$j]=new $pF());$V.cloneTo($N),$t.data[$j]=$N.elements;}else if($V instanceof laya.d3.math.Vector3){var $c=$$[$j]||($$[$j]=new $$F());$V.cloneTo($c),$t.data[$j]=$c.elements;}else if($V instanceof laya.d3.math.Vector4){var $q=$$[$j]||($$[$j]=new $VF());$V.cloneTo($q),$t.data[$j]=$q.elements;}else if($V instanceof laya.d3.math.Matrix4x4){var $s=$$[$j]||($$[$j]=new $RF());$V.cloneTo($s),$t.data[$j]=$s.elements;}else $V instanceof laya.d3.resource.BaseTexture&&($$[$j]=$V,$t.data[$j]=$V);}},$F.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$S(0,$F,"alphaTestValue",function(){return this._getNumber(0);},function($R){this._setNumber(0,$R);}),$S(0,$F,"alphaTest",function(){return this._alphaTest;},function($R){(this._alphaTest=$R)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST);}),$R.__init__=function(){$R.SHADERDEFINE_ALPHATEST=$R.shaderDefines.registerDefine("ALPHATEST");},$R.RENDERQUEUE_OPAQUE=2e3,$R.RENDERQUEUE_ALPHATEST=2450,$R.RENDERQUEUE_TRANSPARENT=3e3,$R.CULL_NONE=0,$R.CULL_FRONT=1,$R.CULL_BACK=2,$R.BLEND_DISABLE=0,$R.BLEND_ENABLE_ALL=1,$R.BLEND_ENABLE_SEPERATE=2,$R.BLENDPARAM_ZERO=0,$R.BLENDPARAM_ONE=1,$R.BLENDPARAM_SRC_COLOR=768,$R.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,$R.BLENDPARAM_DST_COLOR=774,$R.BLENDPARAM_ONE_MINUS_DST_COLOR=775,$R.BLENDPARAM_SRC_ALPHA=770,$R.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,$R.BLENDPARAM_DST_ALPHA=772,$R.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,$R.BLENDPARAM_SRC_ALPHA_SATURATE=776,$R.BLENDEQUATION_ADD=0,$R.BLENDEQUATION_SUBTRACT=1,$R.BLENDEQUATION_REVERSE_SUBTRACT=2,$R.DEPTHTEST_OFF=0,$R.DEPTHTEST_NEVER=512,$R.DEPTHTEST_LESS=513,$R.DEPTHTEST_EQUAL=514,$R.DEPTHTEST_LEQUAL=515,$R.DEPTHTEST_GREATER=516,$R.DEPTHTEST_NOTEQUAL=517,$R.DEPTHTEST_GEQUAL=518,$R.DEPTHTEST_ALWAYS=519,$R.SHADERDEFINE_ALPHATEST=1,$R.ALPHATESTVALUE=0,$s($R,["shaderDefines",function(){return this.shaderDefines=new $qF();}]),$R;}($a),$LF=function($R){function $F(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,$F.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1;}$h($F,"laya.d3.resource.BaseTexture",$a);var $i=$F.prototype;return $S(0,$i,"width",function(){return this._width;}),$S(0,$i,"repeat",function(){return this._repeat;},function($R){if(this._repeat!==$R&&(this._repeat=$R,this._source)){var $F=$L.mainContext;$Y.bindTexture($F,this._type,this._source),$d.isPOT(this._width,this._height)&&this._repeat?($F.texParameteri(this._type,10242,10497),$F.texParameteri(this._type,10243,10497)):($F.texParameteri(this._type,10242,33071),$F.texParameteri(this._type,10243,33071));}}),$S(0,$i,"height",function(){return this._height;}),$S(0,$i,"magFifter",function(){return this._magFifter;},function($R){(this._magFifter=$R)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter($R);}),$S(0,$i,"wrapModeV",function(){return this._wrapModeV;}),$S(0,$i,"size",function(){return this._size;}),$S(0,$i,"wrapModeU",function(){return this._wrapModeU;}),$S(0,$i,"mipmap",function(){return this._mipmap;},function($R){this._mipmap=$R,this._mipmap!=$R&&this._conchTexture&&this._conchTexture.setMipMap($R);}),$S(0,$i,"minFifter",function(){return this._minFifter;},function($R){this._minFifter=$R,this._minFifter!=$R&&this._conchTexture&&this._conchTexture.setMinFifter($R);}),$S(0,$i,"format",function(){return this._format;}),$S(0,$i,"source",function(){return this.activeResource(),this._source;}),$S(0,$i,"defaulteTexture",function(){return $EF.grayTexture;}),$F.WARPMODE_REPEAT=0,$F.WARPMODE_CLAMP=1,$F;}(),$YF=function($R){function $F(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,$F.__super.call(this),this._boundingBoxCorners=$j(8,null);}$h($F,"laya.d3.resource.models.BaseMesh",$a);var $i=$F.prototype;return $i._getPositions=function(){throw new Error("未Override,请重载该属性！");},$i._generateBoundingObject=function(){this._boundingSphere=new $UR(new $$F(),0),$UR.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new $AR(new $$F(),new $$F()),$AR.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners);},$i.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！");},$i.getRenderElement=function($R){throw new Error("未Override,请重载该属性！");},$S(0,$i,"subMeshCount",function(){return this._subMeshCount;}),$S(0,$i,"boundingBox",function(){return this._boundingBox;}),$S(0,$i,"boundingBoxCorners",function(){return this._boundingBoxCorners;}),$S(0,$i,"boundingSphere",function(){return this._boundingSphere;}),$F;}(),$fF=(function($R){function $F(){$F.__super.call(this);}$h($F,"laya.d3.component.Script",$JF);var $i=$F.prototype;$i.onTriggerEnter=function($R){},$i.onTriggerExit=function($R){},$i.onTriggerStay=function($R){},$S(0,$i,"isSingleton",function(){return $F._isSingleton;}),$F._isSingleton=!1;}(),function($R){function $F($R){this._owner=null,this._sharedMesh=null,$F.__super.call(this),this._owner=$R;}$h($F,"laya.d3.core.MeshFilter",$R);var $i=$F.prototype;return $i._sharedMeshLoaded=function(){this.event("loaded");},$i._destroy=function(){$R.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null);},$S(0,$i,"sharedMesh",function(){return this._sharedMesh;},function($R){var $F=this._sharedMesh;$F&&$F._removeReference(),(this._sharedMesh=$R)._addReference(),this.event("meshchanged",[this,$F,$R]),$R.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded);}),$S(0,$i,"_isAsyncLoaded",function(){return this._sharedMesh.loaded;}),$S(0,$i,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners;}),$S(0,$i,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere;}),$S(0,$i,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox;}),$F;}($dF)),$ZF=function($R){function $F($R){$F.__super.call(this,$R),$R.meshFilter.on("meshchanged",this,this._onMeshChanged);}$h($F,"laya.d3.core.MeshRender",$wF);var $i=$F.prototype;return $i._onMeshChanged=function($R,$F,$i){$i.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:$i.once("loaded",this,this._onMeshLoaed);},$i._onMeshLoaed=function($R,$F){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0;},$i._calculateBoundingSphereByInitSphere=function($R){var $F=NaN,$i=this._owner.transform,$j=$i.scale.elements,$t=Math.abs($j[0]),$p=Math.abs($j[1]),$$=Math.abs($j[2]);$F=$p<=$t&&$$<=$t?$t:$$<=$p?$p:$$,$$F.transformCoordinate($R.center,$i.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=$R.radius*$F;},$i._calculateBoundBoxByInitCorners=function($R){for(var $F=this._owner.transform.worldMatrix,$i=0;$i<8;$i++)$$F.transformCoordinate($R[$i],$F,$wF._tempBoundBoxCorners[$i]);$AR.createfromPoints($wF._tempBoundBoxCorners,this._boundingBox);},$i._calculateBoundingSphere=function(){var $R=this._owner.meshFilter.sharedMesh;null==$R||null==$R.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere($R.boundingSphere);},$i._calculateBoundingBox=function(){var $R=this._owner.meshFilter.sharedMesh;null==$R||null==$R.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners($R.boundingBoxCorners);},$i._renderUpdate=function($R){var $F=this._owner.transform;if($F){this._setShaderValueMatrix4x4(0,$F.worldMatrix);var $i=this._owner.getProjectionViewWorldMatrix($R);this._setShaderValueMatrix4x4(1,$i);}else this._setShaderValueMatrix4x4(0,$RF.DEFAULT),this._setShaderValueMatrix4x4(1,$R);return $mF.debugMode&&this._renderRenderableBoundBox(),!0;},$F;}(),$uF=function($F){function $j(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,$j.__super.call(this),this._renderState=new $r(),this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new $kF(),this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new $FR(),this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new $$F(.7,.7,.7),this.ambientColor=new $$F(.212,.227,.259),$L.shaderHighPrecision&&this.addShaderDefine($_F.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[];}$h($j,"laya.d3.core.scene.Scene",$F);var $R=$j.prototype;return $w.imps($R,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),$R._setUrl=function($R){this._url=$R;},$R._getGroup=function(){return this._group;},$R._setGroup=function($R){this._group=$R;},$R._display=function(){$w.stage._scenes.push(this),$w.stage._scenes.sort($j._sortScenes);for(var $R=0,$F=this._childs.length;$R<$F;$R++){var $i=this._childs[$R];$i.active&&$i._activeHierarchy();}},$R._unDisplay=function(){var $R=$w.stage._scenes;$R.splice($R.indexOf(this),1);for(var $F=0,$i=this._childs.length;$F<$i;$F++){var $j=this._childs[$F];$j.active&&$j._inActiveHierarchy();}},$R._addChild3D=function($R){$R.transform._onWorldTransform(),$R._setBelongScene(this),this.displayedInStage&&$R.active&&$R._activeHierarchy();},$R._removeChild3D=function($R){$R.transform.parent=null,this.displayedInStage&&$R.active&&$R._inActiveHierarchy(),$R._setUnBelongScene();},$R.initOctree=function($R,$F,$i,$j,$t){void 0===$t&&($t=6),this.treeSize=new $$F($R,$F,$i),this.treeLevel=$t,this.treeRoot=new $A(this,0),this.treeRoot.init($j,this.treeSize);},$R._prepareUpdateToRenderState=function($R,$F){$F.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,$F.scene=this;},$R._prepareSceneToRender=function($R){var $F=this._lights.length;if(0<$F)for(var $i=0,$j=0;$j<$F&&!(this._lights[$j]._prepareToScene($R)&&++$i>=this._enableLightCount);$j++);},$R._updateChilds=function($R){for(var $F=0,$i=this._childs.length;$F<$i;++$F)this._childs[$F]._update($R);},$R._preRenderScene=function($R,$F,$i){var $j,$t=$F._viewMatrix,$p=$F._projectionMatrix,$$=$F._projectionViewMatrix,$V=0,$N=$F.camera;for($N.useOcclusionCulling?this.treeRoot?$iR.renderObjectCullingOctree($i,this,$N,$t,$p,$$):$iR.renderObjectCulling($i,this,$N,$t,$p,$$):$iR.renderObjectCullingNoBoundFrustum(this,$N,$t,$p,$$),$V=0,$j=this._quenes.length;$V<$j;$V++)this._quenes[$V]&&this._quenes[$V]._preRender($F);},$R._clear=function($R,$F){var $i=$F._viewport,$j=$F.camera,$t=$i.x,$p=$j.renderTargetSize.height-$i.y-$i.height,$$=$i.width,$V=$i.height;$R.viewport($t,$p,$$,$V);var $N=256,$c=$j.renderTarget;switch($j.clearFlag){case 0:var $q=$j.clearColor;if($q){$R.enable(3089),$R.scissor($t,$p,$$,$V);var $s=$q.elements;$R.clearColor($s[0],$s[1],$s[2],$s[3]),$N|=16384;}if($c)switch($q||($N=16384),$c.depthStencilFormat){case 33189:$N|=256;break;case 36168:$N|=1024;break;case 34041:$N|=256,$N|=1024;}$R.clear($N),$q&&$R.disable(3089);break;case 1:case 2:if($c)switch($N=16384,$c.depthStencilFormat){case 33189:$N|=256;break;case 36168:$N|=1024;break;case 34041:$N|=256,$N|=1024;}$R.clear($N);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.");}},$R._renderScene=function($R,$F){var $i,$j,$t=$F.camera,$p=0;for($p=0;$p<2;$p++)($j=this._quenes[$p])&&($t.renderTarget?$j._render($F,!0):$j._render($F,!1));if(1===$t.clearFlag){var $$=$t.sky;$$&&($Y.setCullFace($R,!1),$Y.setDepthFunc($R,515),$Y.setDepthMask($R,!1),$$._render($F),$Y.setDepthFunc($R,513),$Y.setDepthMask($R,!0));}for($p=2,$i=this._quenes.length;$p<$i;$p++)($j=this._quenes[$p])&&($j._sortAlpha($F.camera.transform.position),$t.renderTarget?$j._render($F,!0):$j._render($F,!1));},$R._set3DRenderConfig=function($R){$R.disable(3042),$Y._blend=!1,$R.blendFunc(770,771),$Y._sFactor=770,$Y._dFactor=771,$R.disable(2929),$Y._depthTest=!1,$R.enable(2884),$Y._cullFace=!0,$R.depthMask(1),$Y._depthMask=!0,$R.frontFace(2304),$Y._frontFace=2304;},$R._set2DRenderConfig=function($R){$Y.setBlend($R,!0),$Y.setBlendFunc($R,1,771),$Y.setDepthTest($R,!1),$Y.setCullFace($R,!1),$Y.setDepthMask($R,!0),$Y.setFrontFace($R,2305),$R.viewport(0,0,$q.width,$q.height);},$R._parseCustomProps=function($R,$F,$i,$j){var $t=$j.customProps.lightmaps,$p=$t.length,$$=this._lightmaps;$$.length=$p;for(var $V=0;$V<$p;$V++)$$[$V]=$m.getRes($F[$t[$V].replace(".exr",".png")]);this.setlightmaps($$);var $N=$j.customProps.ambientColor;$N&&(this.ambientColor=new $$F($N[0],$N[1],$N[2]));var $c=$j.customProps.fogColor;$c&&(this.fogColor=new $$F($c[0],$c[1],$c[2]));},$R._addLight=function($R){this._lights.indexOf($R)<0&&this._lights.push($R);},$R._removeLight=function($R){var $F=this._lights.indexOf($R);0<=$F&&this._lights.splice($F,1);},$R._updateScene=function(){var $R=this._renderState;this._prepareUpdateToRenderState($L.mainContext,$R),this._updateComponents($R),this._updateChilds($R),this._lateUpdateComponents($R),this._time+=$R.elapsedTime/1e3,this._shaderValues.setValue(22,this._time);},$R._updateSceneConch=function(){var $R=this._renderState;this._prepareUpdateToRenderState($L.mainContext,$R),this._updateComponents($R),this._lateUpdateComponents($R),this._prepareSceneToRender($R);for(var $F=0,$i=this._cameraPool.length;$F<$i;$F++){var $j=this._cameraPool[$F];($R.camera=$j)._prepareCameraToRender();}},$R._preRenderShadow=function($R,$F,$i,$j,$t){this.treeRoot?$iR.renderShadowObjectCullingOctree(this,$F,$i,$j,$t):$iR.renderShadowObjectCulling(this,$F,$i,$j,$t);for(var $p=0,$$=$i.length;$p<$$;$p++)$i[$p]&&$i[$p]._preRender($R);},$R._renderShadowMap=function($R,$F,$i){var $j=this.parallelSplitShadowMaps[0];$j._calcAllLightCameraInfo($i);var $t,$p,$$,$V=$j.PSSMNum;if(this._preRenderShadow($F,$j._lightCulling,$j._shadowQuenes,$j._lightVPMatrix[0],$V),this.addShaderDefine($hF.SHADERDEFINE_CAST_SHADOW),1<$V)for(var $N=0;$N<$V;$N++)$t=$j.getRenderTarget($N+1),$j.beginRenderTarget($N+1),$R.clearColor(1,1,1,1),$R.clear(16640),$R.viewport(0,0,$t.width,$t.height),$F.camera=$$=$j.getLightCamera($N),$$._prepareCameraToRender(),$$._prepareCameraViewProject($$.viewMatrix,$$.projectionMatrix),$F._projectionViewMatrix=$j._lightVPMatrix[$N+1],($p=$j._shadowQuenes[$N])._preRender($F),$p._renderShadow($F,!1),$j.endRenderTarget($N+1);else $t=$j.getRenderTarget(1),$j.beginRenderTarget(1),$R.clearColor(1,1,1,1),$R.clear(16640),$R.viewport(0,0,$t.width,$t.height),$F.camera=$$=$j.getLightCamera(0),$$._prepareCameraToRender(),$$._prepareCameraViewProject($$.viewMatrix,$$.projectionMatrix),$F._projectionViewMatrix=$j._lightVPMatrix[0],($p=$j._shadowQuenes[0])._preRender($F),$p._renderShadow($F,!0),$j.endRenderTarget(1);this.removeShaderDefine($hF.SHADERDEFINE_CAST_SHADOW);},$R.addTreeNode=function($R){this.treeRoot.addTreeNode($R);},$R.removeTreeNode=function($R){this.treeSize&&$R._treeNode&&$R._treeNode.removeObject($R);},$R.setlightmaps=function($R){this._lightmaps=$R;for(var $F=0,$i=this._renderableSprite3Ds.length;$F<$i;$F++)this._renderableSprite3Ds[$F]._render._applyLightMapParams();},$R.getlightmaps=function(){return this._lightmaps;},$R.addChildAt=function($R,$F){if(!($R instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+($R&&$R.__className));if(!$R||this.destroyed||$R===this)return $R;if($R.zOrder&&this._set$P("hasZorder",!0),0<=$F&&$F<=this._childs.length){if($R._parent===this){var $i=this.getChildIndex($R);this._childs.splice($i,1),this._childs.splice($F,0,$R),this.conchModel&&(this.conchModel.removeChild($R.conchModel),this.conchModel.addChildAt($R.conchModel,$F)),this._childChanged();}else $R.parent&&$R.parent.removeChild($R),this._childs===$c.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($F,0,$R),this.conchModel&&this.conchModel.addChildAt($R.conchModel,$F),($R.parent=this)._addChild3D($R);return $R;}throw new Error("appendChildAt:The index is out of bounds");},$R.addChild=function($R){if(!($R instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$R||this.destroyed||$R===this)return $R;if($R.zOrder&&this._set$P("hasZorder",!0),$R._parent===this){var $F=this.getChildIndex($R);$F!==this._childs.length-1&&(this._childs.splice($F,1),this._childs.push($R),this.conchModel&&(this.conchModel.removeChild($R.conchModel),this.conchModel.addChildAt($R.conchModel,this._childs.length-1)),this._childChanged());}else $R.parent&&$R.parent.removeChild($R),this._childs===$c.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($R),this.conchModel&&this.conchModel.addChildAt($R.conchModel,this._childs.length-1),($R.parent=this)._childChanged(),this._addChild3D($R);return $R;},$R.removeChildAt=function($R){var $F=this.getChildAt($R);return $F&&(this._removeChild3D($F),this._childs.splice($R,1),this.conchModel&&this.conchModel.removeChild($F.conchModel),$F.parent=null),$F;},$R.removeChildren=function($R,$F){if(void 0===$R&&($R=0),void 0===$F&&($F=2147483647),this._childs&&0<this._childs.length){var $i=this._childs;if(0===$R&&$p<=$F){var $j=$i;this._childs=$c.ARRAY_EMPTY;}else $j=$i.splice($R,$F-$R);for(var $t=0,$p=$j.length;$t<$p;$t++)this._removeChild3D($j[$t]),$j[$t].parent=null,this.conchModel&&this.conchModel.removeChild($j[$t].conchModel);}return this;},$R.addFrustumCullingObject=function($R){this.treeRoot?this.addTreeNode($R):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push($R):this._cullingRenders[this._cullingRendersLength]=$R,$R._indexInSceneFrustumCullingObjects=this._cullingRendersLength++);},$R.removeFrustumCullingObject=function($R){if(this.treeRoot)this.removeTreeNode($R);else{this._cullingRendersLength--;var $F=$R._indexInSceneFrustumCullingObjects;if($F!==this._cullingRendersLength){var $i=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[$F]=$i)._indexInSceneFrustumCullingObjects=$F,$R._indexInSceneFrustumCullingObjects=-1;}}},$R.getRenderQueue=function($R){return $R<3e3?this._quenes[1]||(this._quenes[1]=new $C(this)):this._quenes[2]||(this._quenes[2]=new $C(this));},$R.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new $C(this);},$R.addShaderDefine=function($R){this._shaderDefineValue|=$R;},$R.removeShaderDefine=function($R){this._shaderDefineValue&=~$R;},$R.addScript=function($R){return this._addComponent($R);},$R.getScriptByType=function($R,$F){return void 0===$F&&($F=0),this._getComponentByType($R,$F);},$R.getScriptsByType=function($R,$F){this._getComponentsByType($R,$F);},$R.getScriptByIndex=function($R){return this._getComponentByIndex($R);},$R.removeScriptByType=function($R,$F){void 0===$F&&($F=0),this._removeComponentByType($R,$F);},$R.removeScriptsByType=function($R){this._removeComponentByType($R);},$R.removeAllScript=function(){this._removeAllComponent();},$R.render=function($R,$F,$i){($x._context.ctx._renderKey=0)<this._childs.length&&$R.addRenderObject(this);},$R.renderSubmit=function(){var $R=$L.mainContext,$F=this._renderState;this._set3DRenderConfig($R),this._prepareSceneToRender(this._renderState);var $i,$j=0,$t=0;if($mF.debugMode||$A.debugMode)for($j=0,$t=this._cameraPool.length;$j<$t;$j++)$i=this._cameraPool[$j],$mF._debugPhasorSprite.begin(1,$i),$i.activeInHierarchy&&$i._renderCamera($R,$F,this),$mF._debugPhasorSprite.end();else for($j=0,$t=this._cameraPool.length;$j<$t;$j++)($i=this._cameraPool[$j]).activeInHierarchy&&$i._renderCamera($R,$F,this);return this._set2DRenderConfig($R),1;},$R.onAsynLoaded=function($R,$F,$i){var $j=$F[0];if("Scene"!==$j.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var $t=$F[1];$aF._createNodeByJson(this,$j,this,$t),this.event("hierarchyloaded",[this]),this.__loaded=!0;},$R.destroy=function($R){void 0===$R&&($R=!0),this.destroyed||($F.prototype.destroy.call(this,$R),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,$m.clearRes(this.url),this.loaded||$mF._cancelLoadByUrl(this.url));},$R.getRenderType=function(){return 0;},$R.releaseRender=function(){},$R._addComponent=function($R){var $F,$i=this._componentsMap.indexOf($R);if(-1===$i)$F=[],this._componentsMap.push($R),this._typeComponentsIndices.push($F);else if($F=this._typeComponentsIndices[$i],this._components[$F[0]].isSingleton)throw new Error("无法单实例创建"+$R+"组件，"+$R+"组件已存在！");var $j=$t.getInstance($R);$F.push(this._components.length),this._components.push($j);return $j._initialize(this),$j;},$R._removeComponent=function($R,$F){var $i=this._typeComponentsIndices[$R],$j=$i[$F],$t=this._components[$j];this._components.splice($j,1),$i.splice($F,1),0===$i.length&&(this._typeComponentsIndices.splice($R,1),this._componentsMap.splice($R,1));for(var $p=0,$$=this._componentsMap.length;$p<$$;$p++)for(var $V=($i=this._typeComponentsIndices[$p]).length-1;0<=$V;$V--){var $N=$i[$V];if(!($j<$N))break;$i[$V]=--$N;}$t._destroy();},$R._getComponentByType=function($R,$F){void 0===$F&&($F=0);var $i=this._componentsMap.indexOf($R);return-1===$i?null:this._components[this._typeComponentsIndices[$i][$F]];},$R._getComponentsByType=function($R,$F){var $i=this._componentsMap.indexOf($R);if(-1!==$i){var $j=this._typeComponentsIndices[$i],$t=$j.length;$F.length=$t;for(var $p=0;$p<$t;$p++)$F[$p]=this._components[$j[$p]];}else $F.length=0;},$R._getComponentByIndex=function($R){return this._components[$R];},$R._removeComponentByType=function($R,$F){void 0===$F&&($F=0);var $i=this._componentsMap.indexOf($R);-1!==$i&&this._removeComponent($i,$F);},$R._removeComponentsByType=function($R){var $F=this._componentsMap.indexOf($R);if(-1!==$F)for(var $i=this._typeComponentsIndices[$F],$j=0,$t=$i.length;$j<$t;$i.length<$t?$t--:$j++)this._removeComponent($F,$j);},$R._removeAllComponent=function(){for(var $R=0,$F=this._componentsMap.length;$R<$F;this._componentsMap.length<$F?$F--:$R++)this._removeComponentsByType(this._componentsMap[$R]);},$R._updateComponents=function($R){for(var $F=0,$i=this._components.length;$F<$i;$F++){var $j=this._components[$F];!$j.started&&($j._start($R),$j.started=!0),$j.enable&&$j._update($R);}},$R._lateUpdateComponents=function($R){for(var $F=0;$F<this._components.length;$F++){var $i=this._components[$F];!$i.started&&($i._start($R),$i.started=!0),$i.enable&&$i._lateUpdate($R);}},$R._preRenderUpdateComponents=function($R){for(var $F=0;$F<this._components.length;$F++){var $i=this._components[$F];!$i.started&&($i._start($R),$i.started=!0),$i.enable&&$i._preRenderUpdate($R);}},$R._postRenderUpdateComponents=function($R){for(var $F=0;$F<this._components.length;$F++){var $i=this._components[$F];!$i.started&&($i._start($R),$i.started=!0),$i.enable&&$i._postRenderUpdate($R);}},$S(0,$R,"_loaded",null,function($R){this.__loaded=$R;}),$S(0,$R,"fogColor",function(){return this._fogColor;},function($R){this._fogColor=$R,this._shaderValues.setValue(0,$R.elements);}),$S(0,$R,"enableFog",function(){return this._enableFog;},function($R){this._enableFog!==$R&&((this._enableFog=$R)?(this.addShaderDefine($_F.SHADERDEFINE_FOG),this.removeShaderDefine($_F.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine($_F.SHADERDEFINE_FOG));}),$S(0,$R,"url",function(){return this._url;}),$S(0,$R,"loaded",function(){return this.__loaded;}),$S(0,$R,"enableDepthFog",function(){return this._enableDepthFog;},function($R){this._enableDepthFog!=$R&&((this._enableDepthFog=$R)?(this.addShaderDefine($_F.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine($_F.SHADERDEFINE_FOG)):this.removeShaderDefine($_F.SAHDERDEFINE_DEPTHFOG));}),$S(0,$R,"fogStart",function(){return this._fogStart;},function($R){this._fogStart=$R,this._shaderValues.setValue(1,$R);}),$S(0,$R,"fogRange",function(){return this._fogRange;},function($R){this._fogRange=$R,this._shaderValues.setValue(2,$R);}),$S(0,$R,"ambientColor",function(){return this._ambientColor;},function($R){this._ambientColor=$R,this._shaderValues.setValue(21,$R.elements);}),$S(0,$R,"scene",function(){return this;}),$S(0,$R,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice();}),$j._sortScenes=function($R,$F){if($R.parent!==$w.stage||$F.parent!==$w.stage)return $R.parent!==$w.stage&&$F.parent!==$w.stage?$j._sortScenes($R.parent,$F.parent):$R.parent===$w.stage?-1:1;var $i=$w.stage._childs;return $i.indexOf($R)-$i.indexOf($F);},$j.load=function($R){return $w.loader.create($R,null,null,$j);},$j.FOGCOLOR=0,$j.FOGSTART=1,$j.FOGRANGE=2,$j.LIGHTDIRECTION=3,$j.LIGHTDIRCOLOR=4,$j.POINTLIGHTPOS=5,$j.POINTLIGHTRANGE=6,$j.POINTLIGHTATTENUATION=7,$j.POINTLIGHTCOLOR=8,$j.SPOTLIGHTPOS=9,$j.SPOTLIGHTDIRECTION=10,$j.SPOTLIGHTSPOT=11,$j.SPOTLIGHTRANGE=12,$j.SPOTLIGHTATTENUATION=13,$j.SPOTLIGHTCOLOR=14,$j.SHADOWDISTANCE=15,$j.SHADOWLIGHTVIEWPROJECT=16,$j.SHADOWMAPPCFOFFSET=17,$j.SHADOWMAPTEXTURE1=18,$j.SHADOWMAPTEXTURE2=19,$j.SHADOWMAPTEXTURE3=20,$j.AMBIENTCOLOR=21,$j.TIME=22,$j;}($H),$vF=function($R){function $F($R){$F.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new $RF(),this._shaderValues=new $kF(),this._colliders=[],this._id=++$F._uniqueIDCounter,this._transform=new $XF(this),this.name=$R||"Sprite3D-"+$F._nameNumberCounter++,this.layer=$Z.currentCreationLayer,this.active=!0;}$h($F,"laya.d3.core.Sprite3D",$BF);var $i=$F.prototype;return $w.imps($i,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),$i._setUrl=function($R){this._url=$R;},$i._getGroup=function(){return this._group;},$i._setGroup=function($R){this._group=$R;},$i._addChild3D=function($R){$R.transform.parent=this.transform,this._hierarchyAnimator&&(!$R._hierarchyAnimator&&$R._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($R,!0,[$R.name])),this._scene&&($R._setBelongScene(this._scene),this._activeInHierarchy&&$R._active&&$R._activeHierarchy());},$i._removeChild3D=function($R){$R.transform.parent=null,this._scene&&(this._activeInHierarchy&&$R._active&&$R._inActiveHierarchy(),$R._setUnBelongScene()),this._hierarchyAnimator&&($R._hierarchyAnimator==this._hierarchyAnimator&&$R._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($R,!1,[$R.name]));},$i._parseBaseCustomProps=function($R){var $F=this.transform.localPosition;$R.translate?($F.fromArray($R.translate),$F.x*=100,$F.y*=100,$F.z*=100):$F.elements.fill(0),this.transform.localPosition=$F;var $i=this.transform.localRotation;$R.rotation?$i.fromArray($R.rotation):$i.fromArray([0,0,0,-1]),this.transform.localRotation=$i;var $j=this.transform.localScale;$R.scale?$j.fromArray($R.scale):$j.elements.fill(1),this.transform.localScale=$j;var $t=$R.layer;null!=$t&&(this.layer=$Z.getLayerByNumber($t));},$i._parseCustomComponent=function($R,$F,$i){for(var $j in $i){var $t=$i[$j];switch($j){case"Animator":var $p=this.addComponent(Animator);if($t.avatarPath)$p.avatar=$m.getRes($F[$t.avatarPath]);else{var $$=$t.avatar;if($$){$p.avatar=$m.getRes($F[$$.path]);var $V=$$.linkSprites;$V&&$R.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[$p,$V]);}}for(var $N=$t.clipPaths,$c=$N.length,$q=0;$q<$c;$q++)$p.addClip($m.getRes($F[$N[$q]]));$p.clip=$m.getRes($F[$N[0]]);var $s=$t.playOnWake;void 0!==$s&&($p.playOnWake=$s);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var $k=this.addComponent(SphereCollider);$k.isTrigger=$t.isTrigger;var $h=$k.center;$h.fromArray($t.center),$k.center=$h,$k.radius=$t.radius;break;case"BoxCollider":var $S=this.addComponent(BoxCollider);$S.isTrigger=$t.isTrigger,$S.center.fromArray($t.center);var $x=$S.size;$x.fromArray($t.size),$S.size=$x;break;case"MeshCollider":this.addComponent(MeshCollider);}}},$i._onRootNodeHierarchyLoaded=function($R,$F){for(var $i in $F){for(var $j=this,$t=$F[$i],$p=0,$$=$t.length;$p<$$;$p++){var $V=$t[$p];if(""===$V)break;if(!($j=$j.getChildByName($V)))break;}$j&&$R.linkSprite3DToAvatarNode($i,$j);}},$i._setHierarchyAnimator=function($R,$F){this._changeHierarchyAnimator($R);for(var $i=0,$j=this._childs.length;$i<$j;$i++){var $t=this._childs[$i];$t._hierarchyAnimator==$F&&$t._setHierarchyAnimator($R,$F);}},$i._clearHierarchyAnimator=function($R,$F){this._changeHierarchyAnimator($F);for(var $i=0,$j=this._childs.length;$i<$j;$i++){var $t=this._childs[$i];$t._hierarchyAnimator==$R&&$t._clearHierarchyAnimator($R,$F);}},$i._getAnimatorToLinkSprite3D=function($R,$F,$i){var $j=this.getComponentByType(Animator);if($j&&($j.avatar?$j.avatar._version||$R._setAnimatorToLinkAvatar($j,$F):$R._setAnimatorToLinkSprite3DNoAvatar($j,$F,$i)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){$i.unshift(this._parent.name);var $t=this._parent;$t._hierarchyAnimator&&$t._getAnimatorToLinkSprite3D($R,$F,$i);}},$i._setAnimatorToLinkSprite3DNoAvatar=function($R,$F,$i){var $j=0,$t=0;for($j=0,$t=$R.getClipCount();$j<$t;$j++)$R._handleSpriteOwnersBySprite($j,$F,$i,this);for($j=0,$t=this._childs.length;$j<$t;$j++){var $p=this._childs[$j],$$=$i.length;$i.push($p.name),$p._setAnimatorToLinkSprite3DNoAvatar($R,$F,$i),$i.splice($$,1);}},$i._changeHierarchyAnimator=function($R){this._hierarchyAnimator=$R;},$i._isLinkSpriteToAnimationNode=function($R,$F,$i){var $j=$R._avatarNodes.indexOf($F),$t=$R._cacheSpriteToNodesMap;if($i)this._transform.dummy=$F.transform,$R._cacheNodesToSpriteMap[$j]=$t.length,$t.push($j);else{this._transform.dummy=null;var $p=$R._cacheNodesToSpriteMap[$j];$R._cacheNodesToSpriteMap[$j]=null,$t.splice($p,1);}},$i._setBelongScene=function($R){this._scene=$R;for(var $F=0,$i=this._childs.length;$F<$i;$F++)this._childs[$F]._setBelongScene($R);},$i._setUnBelongScene=function(){this._scene=null;for(var $R=0,$F=this._childs.length;$R<$F;$R++)this._childs[$R]._setUnBelongScene();},$i._activeHierarchy=function(){var $R=0,$F=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),$R=0,$F=this._colliders.length;$R<$F;$R++)this._layer._addCollider(this._colliders[$R]);for(this.event("activeinhierarchychanged",!0),$R=0,$F=this._childs.length;$R<$F;$R++){var $i=this._childs[$R];$i._active&&$i._activeHierarchy();}},$i._inActiveHierarchy=function(){var $R=0,$F=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),$R=0,$F=this._colliders.length;$R<$F;$R++){var $i=this._colliders[$R];$i._clearCollsionMap(),this._layer._removeCollider($i);}for(this.event("activeinhierarchychanged",!1),$R=0,$F=this._childs.length;$R<$F;$R++){var $j=this._childs[$R];$j._active&&$j._inActiveHierarchy();}},$i.addComponent=function($R){var $F,$i=this._componentsMap.indexOf($R);if(-1===$i)$F=[],this._componentsMap.push($R),this._typeComponentsIndices.push($F);else if($F=this._typeComponentsIndices[$i],this._components[$F[0]].isSingleton)throw new Error("无法单实例创建"+$R+"组件，"+$R+"组件已存在！");var $j=$t.getInstance($R);return $F.push(this._components.length),this._components.push($j),$j instanceof laya.d3.component.Script&&this._scripts.push($j),$j._initialize(this),$j;},$i._removeComponent=function($R,$F){var $i,$j=0,$t=this._typeComponentsIndices[$R],$p=$t[$F],$$=this._components[$p];for($$ instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($$),1),$t.splice($F,1),0===$t.length&&(this._typeComponentsIndices.splice($R,1),this._componentsMap.splice($R,1)),$j=0,$i=this._componentsMap.length;$j<$i;$j++)for(var $V=($t=this._typeComponentsIndices[$j]).length-1;0<=$V;$V--){var $N=$t[$V];if(!($p<$N))break;$t[$V]=--$N;}$$._destroy();},$i._clearSelfRenderObjects=function(){},$i._addSelfRenderObjects=function(){},$i._parseCustomProps=function($R,$F,$i,$j){},$i._updateChilds=function($R){var $F=this._childs.length;if(0!==$F)for(var $i=0;$i<$F;++$i)this._childs[$i]._update($R);},$i._getSortID=function($R,$F){return 1e3*$F.id+$R._getVertexBuffer().vertexDeclaration.id;},$i._update=function($R){($R.owner=this)._activeInHierarchy&&(this._updateComponents($R),this._lateUpdateComponents($R),$_.spriteCount++,this._childs.length&&this._updateChilds($R));},$i.getProjectionViewWorldMatrix=function($R){return $RF.multiply($R,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix;},$i.loadHierarchy=function($R){this.addChild(laya.d3.core.Sprite3D.load($R));},$i.addChildAt=function($R,$F){if(!($R instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$R||this.destroyed||$R===this)return $R;if($R.zOrder&&this._set$P("hasZorder",!0),0<=$F&&$F<=this._childs.length){if($R._parent===this){var $i=this.getChildIndex($R);this._childs.splice($i,1),this._childs.splice($F,0,$R),this.conchModel&&(this.conchModel.removeChild($R.conchModel),this.conchModel.addChildAt($R.conchModel,$F)),this._childChanged();}else $R.parent&&$R.parent.removeChild($R),this._childs===$c.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($F,0,$R),this.conchModel&&this.conchModel.addChildAt($R.conchModel,$F),($R.parent=this)._addChild3D($R);return $R;}throw new Error("appendChildAt:The index is out of bounds");},$i.addChild=function($R){if(!($R instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$R||this.destroyed||$R===this)return $R;if($R.zOrder&&this._set$P("hasZorder",!0),$R._parent===this){var $F=this.getChildIndex($R);$F!==this._childs.length-1&&(this._childs.splice($F,1),this._childs.push($R),this.conchModel&&(this.conchModel.removeChild($R.conchModel),this.conchModel.addChildAt($R.conchModel,this._childs.length-1)),this._childChanged());}else $R.parent&&$R.parent.removeChild($R),this._childs===$c.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($R),this.conchModel&&this.conchModel.addChildAt($R.conchModel,this._childs.length-1),($R.parent=this)._childChanged(),this._addChild3D($R);return $R;},$i.removeChildAt=function($R){var $F=this.getChildAt($R);return $F&&(this._removeChild3D($F),this._childs.splice($R,1),this.conchModel&&this.conchModel.removeChild($F.conchModel),$F.parent=null),$F;},$i.removeChildren=function($R,$F){if(void 0===$R&&($R=0),void 0===$F&&($F=2147483647),this._childs&&0<this._childs.length){var $i=this._childs;if(0===$R&&$p<=$F){var $j=$i;this._childs=$c.ARRAY_EMPTY;}else $j=$i.splice($R,$F-$R);for(var $t=0,$p=$j.length;$t<$p;$t++)this._removeChild3D($j[$t]),$j[$t].parent=null,this.conchModel&&this.conchModel.removeChild($j[$t].conchModel);}return this;},$i.onAsynLoaded=function($R,$F,$i){var $j=$F[0];if("Sprite3D"!==$j.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var $t=$F[1];$aF._createNodeByJson(this,$j,this,$t),this.event("hierarchyloaded",[this]),this.__loaded=!0;},$i.cloneTo=function($R){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var $F=$R;$F.name=this.name,$F._destroyed=this._destroyed,$F.timer=this.timer,$F._$P=this._$P,$F.active=this._active;var $i=$F.transform.localPosition;this.transform.localPosition.cloneTo($i),$F.transform.localPosition=$i;var $j=$F.transform.localRotation;this.transform.localRotation.cloneTo($j),$F.transform.localRotation=$j;var $t=$F.transform.localScale;this.transform.localScale.cloneTo($t),$F.transform.localScale=$t,$F.isStatic=this.isStatic;var $p=0,$$=0;for($p=0,$$=this._componentsMap.length;$p<$$;$p++){var $V=$F.addComponent(this._componentsMap[$p]);this._components[$p]._cloneTo($V);}for($p=0,$$=this._childs.length;$p<$$;$p++)$F.addChild(this._childs[$p].clone());var $N=$F.getComponentByType(Animator);if($N){var $c=$N._linkSpritesData;if($c)for(var $q in $c){for(var $s=$c[$q],$k=$F,$h=0,$S=$s.length;$h<$S&&($k=$k.getChildByName($s[$h]));$h++);if($k){var $x=$N._avatarNodeMap[$q];$k._isLinkSpriteToAnimationNode($N,$x,!0);}}}},$i.clone=function(){var $R=new this.constructor();return this.cloneTo($R),$R;},$i.destroy=function($R){if(void 0===$R&&($R=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,$R);var $F,$i=0;for($i=0,$F=this._components.length;$i<$F;$i++)this._components[$i]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,$m.clearRes(this.url),this.loaded||$mF._cancelLoadByUrl(this.url);}},$i._handleSpriteToAvatar=function($R,$F){$R._avatarNodes;var $i=$R._avatarNodeMap[this.name];$i&&$i.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode($R,$i,$F);},$i._setAnimatorToLinkAvatar=function($R,$F){this._handleSpriteToAvatar($R,$F);for(var $i=0,$j=this._childs.length;$i<$j;$i++){this._childs[$i]._setAnimatorToLinkAvatar($R,$F);}},$S(0,$i,"activeInHierarchy",function(){return this._activeInHierarchy;}),$S(0,$i,"_loaded",null,function($R){this.__loaded=$R;}),$S(0,$i,"active",function(){return this._active;},function($R){this._active!==$R&&(this._active=$R,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&($R?this._activeHierarchy():this._inActiveHierarchy()));}),$S(0,$i,"componentsCount",function(){return this._components.length;}),$S(0,$i,"loaded",function(){return this.__loaded;}),$S(0,$i,"id",function(){return this._id;}),$S(0,$i,"url",function(){return this._url;}),$S(0,$i,"layer",function(){return this._layer;},function($R){if(this._layer!==$R){if(!$R)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var $F=0,$i=this._colliders.length;if(this._layer)for($F=0;$F<$i;$F++)this._layer._removeCollider(this._colliders[$F]);for($F=0;$F<$i;$F++)$R._addCollider(this._colliders[$F]);}this._layer=$R,this.event("layerchanged",$R);}}),$S(0,$i,"scene",function(){return this._scene;}),$S(0,$i,"transform",function(){return this._transform;}),$F.instantiate=function($R,$F,$i,$j,$t){void 0===$i&&($i=!0);var $p=$R.clone();$F&&$F.addChild($p);var $$=$p.transform;if($i){var $V=$$.worldMatrix;$R.transform.worldMatrix.cloneTo($V),$$.worldMatrix=$V;}else $j&&($$.position=$j),$t&&($$.rotation=$t);return $p;},$F.load=function($R){return $w.loader.create($R,null,null,$F);},$F.WORLDMATRIX=0,$F.MVPMATRIX=1,$F._uniqueIDCounter=0,$F._nameNumberCounter=0,$F;}(),$KF=function($R){function $q($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],$q.__super.call(this),!$R||!$F)throw"Shader Error";this._id=++$q._count,this._vs=$R,this._ps=$F,this._attributeMap=$i,this._sceneUniformMap=$j,this._cameraUniformMap=$t,this._spriteUniformMap=$p,this._materialUniformMap=$$,this._renderElementUniformMap=$V,this._precompile=$N,this._define=$c,this._precompile&&$q.extCompileObj&&$q.extCompileFunc?$q.extCompileFunc.call($q.extCompileObj,$R,$F,$c):this.recreateResource();}$h($q,"laya.d3.shader.Shader3D",$i);var $F=$q.prototype;return $F.recreateResource=function(){$f.now();this._compile(),this.completeCreate(),this.memorySize=0;},$F.disposeResource=function(){$L.mainContext.deleteShader(this._vshader),$L.mainContext.deleteShader(this._pshader),$L.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0;},$F._compile=function(){if(!$L.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var $R=[this._vs,this._ps],$F=$L.mainContext;if(this._program=$F.createProgram(),this._vshader=$q._createShader($F,$R[0],35633),this._pshader=$q._createShader($F,$R[1],35632),$F.attachShader(this._program,this._vshader),$F.attachShader(this._program,this._pshader),$F.linkProgram(this._program),!$x.isConchApp&&$_F.debugMode&&!$F.getProgramParameter(this._program,35714))throw $F.getProgramInfoLog(this._program);var $i,$j=0,$t=0,$p=0;for($p=$x.isConchApp?$F.getProgramParameterEx(this._vs,this._ps,"",35721):$F.getProgramParameter(this._program,35721),$j=0;$j<$p;$j++){var $$=null;$i={vartype:"attribute",ivartype:0,attrib:$$=$x.isConchApp?$F.getActiveAttribEx(this._vs,this._ps,"",$j):$F.getActiveAttrib(this._program,$j),location:$F.getAttribLocation(this._program,$$.name),name:$$.name,type:$$.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push($i);}var $V=0;for($V=$x.isConchApp?$F.getProgramParameterEx(this._vs,this._ps,"",35718):$F.getProgramParameter(this._program,35718),$j=0;$j<$V;$j++){var $N=null;$N=$x.isConchApp?$F.getActiveUniformEx(this._vs,this._ps,"",$j):$F.getActiveUniform(this._program,$j),0<($i={vartype:"uniform",ivartype:1,attrib:$$,location:$F.getUniformLocation(this._program,$N.name),name:$N.name,type:$N.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($i.name=$i.name.substr(0,$i.name.length-3),$i.isArray=!0,$i.location=$F.getUniformLocation(this._program,$i.name)),this._uniformParams.push($i);}for($j=0,$t=this._attributeParams.length;$j<$t;$j++)($i=this._attributeParams[$j]).indexOfParams=$j,$i.index=1,$i.value=[$i.location,null],$i.codename=$i.name,$i.name=null!=this._attributeMap[$i.codename]?this._attributeMap[$i.codename]:$i.codename,this._attributeParamsMap.push($i.name),this._attributeParamsMap.push($i),$i._this=this,$i.uploadedValue=[],$i.fun=this._attribute;for($j=0,$t=this._uniformParams.length;$j<$t;$j++)switch(($i=this._uniformParams[$j]).indexOfParams=$j,$i.index=1,$i.value=[$i.location,null],$i.codename=$i.name,null!=this._sceneUniformMap[$i.codename]?($i.name=this._sceneUniformMap[$i.codename],this._sceneUniformParamsMap.push($i.name),this._sceneUniformParamsMap.push($i)):null!=this._cameraUniformMap[$i.codename]?($i.name=this._cameraUniformMap[$i.codename],this._cameraUniformParamsMap.push($i.name),this._cameraUniformParamsMap.push($i)):null!=this._spriteUniformMap[$i.codename]?($i.name=this._spriteUniformMap[$i.codename],this._spriteUniformParamsMap.push($i.name),this._spriteUniformParamsMap.push($i)):null!=this._materialUniformMap[$i.codename]?($i.name=this._materialUniformMap[$i.codename],this._materialUniformParamsMap.push($i.name),this._materialUniformParamsMap.push($i)):null!=this._renderElementUniformMap[$i.codename]?($i.name=this._renderElementUniformMap[$i.codename],this._renderElementUniformParamsMap.push($i.name),this._renderElementUniformParamsMap.push($i)):console.log("Shader:can't find uinform name:"+$i.codename+" in shader file."),$i._this=this,$i.uploadedValue=[],$i.type){case 5124:$i.fun=$i.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$i.fun=$i.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$i.fun=$i.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$i.fun=$i.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$i.fun=$i.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$i.fun=this._uniform_sampler2D;break;case 35680:$i.fun=this._uniform_samplerCube;break;case 35676:$i.fun=this._uniformMatrix4fv;break;case 35670:$i.fun=this._uniform1i;break;case 35674:$i.fun=this._uinformMatrix2fv;break;case 35675:$i.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!");}}},$F._attribute=function($R,$F){var $i=$L.mainContext,$j=$V._enableAtributes,$t=$R.location;return $j[$t]||$i.enableVertexAttribArray($t),$i.vertexAttribPointer($t,$F[0],$F[1],$F[2],$F[3],$F[4]),$j[$t]=$V._bindVertexBuffer,1;},$F._uniform1f=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F?($L.mainContext.uniform1f($R.location,$i[0]=$F),1):0;},$F._uniform1fv=function($R,$F){if($F.length<4){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]||$i[2]!==$F[2]||$i[3]!==$F[3]?($L.mainContext.uniform1fv($R.location,$F),$i[0]=$F[0],$i[1]=$F[1],$i[2]=$F[2],$i[3]=$F[3],1):0;}return $L.mainContext.uniform1fv($R.location,$F),1;},$F._uniform_vec2=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]?($L.mainContext.uniform2f($R.location,$i[0]=$F[0],$i[1]=$F[1]),1):0;},$F._uniform_vec2v=function($R,$F){if($F.length<2){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]||$i[2]!==$F[2]||$i[3]!==$F[3]?($L.mainContext.uniform2fv($R.location,$F),$i[0]=$F[0],$i[1]=$F[1],$i[2]=$F[2],$i[3]=$F[3],1):0;}return $L.mainContext.uniform2fv($R.location,$F),1;},$F._uniform_vec3=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]||$i[2]!==$F[2]?($L.mainContext.uniform3f($R.location,$i[0]=$F[0],$i[1]=$F[1],$i[2]=$F[2]),1):0;},$F._uniform_vec3v=function($R,$F){return $L.mainContext.uniform3fv($R.location,$F),1;},$F._uniform_vec4=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]||$i[2]!==$F[2]||$i[3]!==$F[3]?($L.mainContext.uniform4f($R.location,$i[0]=$F[0],$i[1]=$F[1],$i[2]=$F[2],$i[3]=$F[3]),1):0;},$F._uniform_vec4v=function($R,$F){return $L.mainContext.uniform4fv($R.location,$F),1;},$F._uniformMatrix2fv=function($R,$F){return $L.mainContext.uniformMatrix2fv($R.location,!1,$F),1;},$F._uniformMatrix3fv=function($R,$F){return $L.mainContext.uniformMatrix3fv($R.location,!1,$F),1;},$F._uniformMatrix4fv=function($R,$F){return $L.mainContext.uniformMatrix4fv($R.location,!1,$F),1;},$F._uinformMatrix2fv=function($R,$F){return $L.mainContext.uniformMatrix2fv($R.location,!1,$F),1;},$F._uinformMatrix3fv=function($R,$F){return $L.mainContext.uniformMatrix3fv($R.location,!1,$F),1;},$F._uniform1i=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F?($L.mainContext.uniform1i($R.location,$i[0]=$F),1):0;},$F._uniform1iv=function($R,$F){return $L.mainContext.uniform1iv($R.location,$F),1;},$F._uniform_ivec2=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]?($L.mainContext.uniform2i($R.location,$i[0]=$F[0],$i[1]=$F[1]),1):0;},$F._uniform_ivec2v=function($R,$F){return $L.mainContext.uniform2iv($R.location,$F),1;},$F._uniform_vec3i=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]||$i[2]!==$F[2]?($L.mainContext.uniform3i($R.location,$i[0]=$F[0],$i[1]=$F[1],$i[2]=$F[2]),1):0;},$F._uniform_vec3vi=function($R,$F){return $L.mainContext.uniform3iv($R.location,$F),1;},$F._uniform_vec4i=function($R,$F){var $i=$R.uploadedValue;return $i[0]!==$F[0]||$i[1]!==$F[1]||$i[2]!==$F[2]||$i[3]!==$F[3]?($L.mainContext.uniform4i($R.location,$i[0]=$F[0],$i[1]=$F[1],$i[2]=$F[2],$i[3]=$F[3]),1):0;},$F._uniform_vec4vi=function($R,$F){return $L.mainContext.uniform4iv($R.location,$F),1;},$F._uniform_sampler2D=function($R,$F){var $i=$F.source||$F.defaulteTexture.source,$j=$L.mainContext,$t=$R.uploadedValue;if(null!=$t[0])return $j.activeTexture($q._TEXTURES[$t[0]]),$i&&$Y.bindTexture($j,3553,$i),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $t[0]=this._curActTexIndex,$j.uniform1i($R.location,this._curActTexIndex),$j.activeTexture($q._TEXTURES[this._curActTexIndex]),$i&&$Y.bindTexture($j,3553,$i),this._curActTexIndex++,1;},$F._uniform_samplerCube=function($R,$F){var $i=$F.source||$F.defaulteTexture.source,$j=$L.mainContext,$t=$R.uploadedValue;if(null!=$t[0])return $j.activeTexture($q._TEXTURES[$t[0]]),$i?$Y.bindTexture($j,34067,$i):$Y.bindTexture($j,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $t[0]=this._curActTexIndex,$j.uniform1i($R.location,this._curActTexIndex),$j.activeTexture($q._TEXTURES[this._curActTexIndex]),$i?$Y.bindTexture($j,34067,$i):$Y.bindTexture($j,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1;},$F._noSetValue=function($R){console.log("no....:"+$R.name);},$F.bind=function(){return $i.activeShader=this,($i.bindShader=this).activeResource(),$Y.UseProgram(this._program);},$F.uploadAttributes=function($R,$F){for(var $i,$j,$t=0,$p=0,$$=this._attributeParamsMap.length;$p<$$;$p+=2)$j=this._attributeParamsMap[$p+1],null!=($i=$R[this._attributeParamsMap[$p]])&&($F&&$F[$j.name]&&$F[$j.name].bind(),$t+=$j.fun.call(this,$j,$i));$_.shaderCall+=$t;},$F.uploadAttributesX=function($R,$F){for(var $i,$j,$t=0,$p=0,$$=this._attributeParamsMap.length;$p<$$;$p+=2)$j=this._attributeParamsMap[$p+1],null!=($i=$R[this._attributeParamsMap[$p]])&&($F._bind(),$t+=$j.fun.call(this,$j,$i));$_.shaderCall+=$t;},$F.uploadSceneUniforms=function($R){for(var $F,$i,$j=0,$t=0,$p=this._sceneUniformParamsMap.length;$t<$p;$t+=2)$i=this._sceneUniformParamsMap[$t+1],null!=($F=$R[this._sceneUniformParamsMap[$t]])&&($j+=$i.fun.call(this,$i,$F));$_.shaderCall+=$j;},$F.uploadCameraUniforms=function($R){for(var $F,$i,$j=0,$t=0,$p=this._cameraUniformParamsMap.length;$t<$p;$t+=2)$i=this._cameraUniformParamsMap[$t+1],null!=($F=$R[this._cameraUniformParamsMap[$t]])&&($j+=$i.fun.call(this,$i,$F));$_.shaderCall+=$j;},$F.uploadSpriteUniforms=function($R){for(var $F,$i,$j=0,$t=0,$p=this._spriteUniformParamsMap.length;$t<$p;$t+=2)$i=this._spriteUniformParamsMap[$t+1],null!=($F=$R[this._spriteUniformParamsMap[$t]])&&($j+=$i.fun.call(this,$i,$F));$_.shaderCall+=$j;},$F.uploadMaterialUniforms=function($R){for(var $F,$i,$j=0,$t=0,$p=this._materialUniformParamsMap.length;$t<$p;$t+=2)$i=this._materialUniformParamsMap[$t+1],null!=($F=$R[this._materialUniformParamsMap[$t]])&&($j+=$i.fun.call(this,$i,$F));$_.shaderCall+=$j;},$F.uploadRenderElementUniforms=function($R){for(var $F,$i,$j=0,$t=0,$p=this._renderElementUniformParamsMap.length;$t<$p;$t+=2)$i=this._renderElementUniformParamsMap[$t+1],null!=($F=$R[this._renderElementUniformParamsMap[$t]])&&($j+=$i.fun.call(this,$i,$F));$_.shaderCall+=$j;},$q.create=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){return new $q($R,$F,$i,$j,$t,$p,$$,$V,$N,$c);},$q.addInclude=function($R,$F){$J.addInclude($R,$F);},$q._createShader=function($R,$F,$i){var $j=$R.createShader($i);if($R.shaderSource($j,$F),$R.compileShader($j),$_F.debugMode&&!$R.getShaderParameter($j,35713))throw $R.getShaderInfoLog($j);return $j;},$q.PERIOD_RENDERELEMENT=0,$q.PERIOD_MATERIAL=1,$q.PERIOD_SPRITE=2,$q.PERIOD_CAMERA=3,$q.PERIOD_SCENE=4,$q._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],$q._count=0,$q._preCompile=!1,$q.extCompileFunc=null,$q.extCompileObj=null,$s($q,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680};},"nameKey",function(){return this.nameKey=new $T();}]),$q;}(),$eF=function($V){function $N(){this._transformUV=null,$N.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new $$F(.6,.6,.6)),this._setColor(10,new $$F(1,1,1)),this._setColor(11,new $VF(1,1,1,8)),this._setColor(12,new $$F(1,1,1)),this._setColor(7,new $VF(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new $VF(1,1,0,0)),this.renderMode=1;}$h($N,"laya.d3.core.material.StandardMaterial",$V);var $R=$N.prototype;return $R.disableLight=function(){this._addDisablePublicShaderDefine($_F.SHADERDEFINE_POINTLIGHT|$_F.SHADERDEFINE_SPOTLIGHT|$_F.SHADERDEFINE_DIRECTIONLIGHT);},$R.disableFog=function(){this._addDisablePublicShaderDefine($_F.SHADERDEFINE_FOG);},$R.onAsynLoaded=function($R,$F,$i){var $j=$F[0];if($j.version)$V.prototype.onAsynLoaded.call(this,$R,$F,$i);else{var $t=$F[1],$p=$j.props;for(var $$ in $p)this[$$]=$p[$$];$N._parseStandardMaterial($t,this,$j),this._endLoaded();}},$R.cloneTo=function($R){$V.prototype.cloneTo.call(this,$R);var $F=$R;this._transformUV&&($F._transformUV=this._transformUV.clone());},$S(0,$R,"ambientColor",function(){return this._getColor(9);},function($R){this._setColor(9,$R);}),$S(0,$R,"ambientTexture",function(){return this._getTexture(5);},function($R){$R?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,$R);}),$S(0,$R,"renderMode",null,function($R){switch($R){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($N.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.");}this._conchMaterial&&this._conchMaterial.setRenderMode($R);}),$S(0,$R,"reflectColor",function(){return this._getColor(12);},function($R){this._setColor(12,$R);}),$S(0,$R,"tilingOffset",function(){return this._getColor(15);},function($R){if($R){var $F=$R.elements;1!=$F[0]||1!=$F[1]||0!=$F[2]||0!=$F[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,$R);}),$S(0,$R,"albedo",function(){return this._getColor(7);},function($R){this._setColor(7,$R);}),$S(0,$R,"diffuseColor",function(){return this._getColor(10);},function($R){this._setColor(10,$R);}),$S(0,$R,"albedoColor",function(){return this._getColor(7);},function($R){this._setColor(7,$R);}),$S(0,$R,"specularColor",function(){return this._getColor(11);},function($R){this._setColor(11,$R);}),$S(0,$R,"diffuseTexture",function(){return this._getTexture(1);},function($R){$R?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,$R);}),$S(0,$R,"normalTexture",function(){return this._getTexture(2);},function($R){$R?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,$R);}),$S(0,$R,"specularTexture",function(){return this._getTexture(3);},function($R){$R?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,$R);}),$S(0,$R,"emissiveTexture",function(){return this._getTexture(4);},function($R){$R?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,$R);}),$S(0,$R,"reflectTexture",function(){return this._getTexture(6);},function($R){$R?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,$R);}),$S(0,$R,"transformUV",function(){return this._transformUV;},function($R){this._transformUV=$R,this._setMatrix4x4(13,$R.matrix),$R?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,$R.matrix.elements,0);}),$N.__init__=function(){$N.SHADERDEFINE_DIFFUSEMAP=$N.shaderDefines.registerDefine("DIFFUSEMAP"),$N.SHADERDEFINE_NORMALMAP=$N.shaderDefines.registerDefine("NORMALMAP"),$N.SHADERDEFINE_SPECULARMAP=$N.shaderDefines.registerDefine("SPECULARMAP"),$N.SHADERDEFINE_EMISSIVEMAP=$N.shaderDefines.registerDefine("EMISSIVEMAP"),$N.SHADERDEFINE_AMBIENTMAP=$N.shaderDefines.registerDefine("AMBIENTMAP"),$N.SHADERDEFINE_REFLECTMAP=$N.shaderDefines.registerDefine("REFLECTMAP"),$N.SHADERDEFINE_UVTRANSFORM=$N.shaderDefines.registerDefine("UVTRANSFORM"),$N.SHADERDEFINE_TILINGOFFSET=$N.shaderDefines.registerDefine("TILINGOFFSET"),$N.SHADERDEFINE_ADDTIVEFOG=$N.shaderDefines.registerDefine("ADDTIVEFOG");},$N.load=function($R){return $w.loader.create($R,null,null,$N);},$N._parseStandardMaterial=function($R,$F,$i){var $j=$i.customProps,$t=$j.ambientColor;$F.ambientColor=new $$F($t[0],$t[1],$t[2]);var $p=$j.diffuseColor;$F.diffuseColor=new $$F($p[0],$p[1],$p[2]);var $$=$j.specularColor;$F.specularColor=new $VF($$[0],$$[1],$$[2],$$[3]);var $V=$j.reflectColor;$F.reflectColor=new $$F($V[0],$V[1],$V[2]);var $N=$j.albedoColor;$N&&($F.albedo=new $VF($N[0],$N[1],$N[2],$N[3]));var $c=$j.diffuseTexture.texture2D;$c&&($F.diffuseTexture=$m.getRes($R[$c]));var $q=$j.normalTexture.texture2D;$q&&($F.normalTexture=$m.getRes($R[$q]));var $s=$j.specularTexture.texture2D;$s&&($F.specularTexture=$m.getRes($R[$s]));var $k=$j.emissiveTexture.texture2D;$k&&($F.emissiveTexture=$m.getRes($R[$k]));var $h=$j.ambientTexture.texture2D;$h&&($F.ambientTexture=$m.getRes($R[$h]));var $S=$j.reflectTexture.texture2D;$S&&($F.reflectTexture=$m.getRes($R[$S]));},$N.RENDERMODE_OPAQUE=1,$N.RENDERMODE_OPAQUEDOUBLEFACE=2,$N.RENDERMODE_CUTOUT=3,$N.RENDERMODE_CUTOUTDOUBLEFACE=4,$N.RENDERMODE_TRANSPARENT=13,$N.RENDERMODE_TRANSPARENTDOUBLEFACE=14,$N.RENDERMODE_ADDTIVE=15,$N.RENDERMODE_ADDTIVEDOUBLEFACE=16,$N.RENDERMODE_DEPTHREAD_TRANSPARENT=5,$N.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,$N.RENDERMODE_DEPTHREAD_ADDTIVE=7,$N.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,$N.RENDERMODE_NONDEPTH_TRANSPARENT=9,$N.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,$N.RENDERMODE_NONDEPTH_ADDTIVE=11,$N.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,$N.SHADERDEFINE_DIFFUSEMAP=0,$N.SHADERDEFINE_NORMALMAP=0,$N.SHADERDEFINE_SPECULARMAP=0,$N.SHADERDEFINE_EMISSIVEMAP=0,$N.SHADERDEFINE_AMBIENTMAP=0,$N.SHADERDEFINE_REFLECTMAP=0,$N.SHADERDEFINE_UVTRANSFORM=0,$N.SHADERDEFINE_TILINGOFFSET=0,$N.SHADERDEFINE_ADDTIVEFOG=0,$N.DIFFUSETEXTURE=1,$N.NORMALTEXTURE=2,$N.SPECULARTEXTURE=3,$N.EMISSIVETEXTURE=4,$N.AMBIENTTEXTURE=5,$N.REFLECTTEXTURE=6,$N.ALBEDO=7,$N.UVANIAGE=8,$N.MATERIALAMBIENT=9,$N.MATERIALDIFFUSE=10,$N.MATERIALSPECULAR=11,$N.MATERIALREFLECT=12,$N.UVMATRIX=13,$N.UVAGE=14,$N.TILINGOFFSET=15,$s($N,["defaultMaterial",function(){var $R=new $N();return $R.lock=!0,this.defaultMaterial=$R;},"shaderDefines",function(){return this.shaderDefines=new $qF($zF.shaderDefines);}]),$N;}($zF),$QF=function($R){function $$($R,$F,$i,$j,$t){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===$i&&($i=35044),void 0===$j&&($j=!1),$$.__super.call(this),this._indexType=$R,this._indexCount=$F,this._bufferUsage=$i,this._bufferType=34963,this._canRead=$j;var $p;if("ushort"==$R)this._indexTypeByteCount=2;else{if("ubyte"!=$R)throw new Error("unidentification index type.");this._indexTypeByteCount=1;}$p=this._indexTypeByteCount*$F,this._byteLength=$p,this._bind(),$V._gl.bufferData(this._bufferType,$p,this._bufferUsage),this.uri=$t,$j?("ushort"==$R?this._buffer=new Uint16Array($F):"ubyte"==$R&&(this._buffer=new Uint8Array($F)),this.memorySize=2*$p):this.memorySize=$p;}$h($$,"laya.d3.graphics.IndexBuffer3D",$R);var $F=$$.prototype;return $F.setData=function($R,$F,$i,$j){void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=4294967295);var $t=0;if("ushort"==this._indexType?($t=2,0===$i&&4294967295===$j||($R=new Uint16Array($R.buffer,$i*$t,$j))):"ubyte"==this._indexType&&($t=1,0===$i&&4294967295===$j||($R=new Uint8Array($R.buffer,$i*$t,$j))),this._bind(),$V._gl.bufferSubData(this._bufferType,$F*$t,$R),this._canRead)if(0!==$F||0!==$i||4294967295!==$j){var $p=this._buffer.length-$F;$p<$j&&($j=$p);for(var $$=0;$$<$j;$$++)this._buffer[$F+$$]=$R[$$];}else this._buffer=$R;},$F.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!");},$F.disposeResource=function(){$R.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0;},$S(0,$F,"indexType",function(){return this._indexType;}),$S(0,$F,"indexTypeByteCount",function(){return this._indexTypeByteCount;}),$S(0,$F,"indexCount",function(){return this._indexCount;}),$S(0,$F,"canRead",function(){return this._canRead;}),$$.INDEXTYPE_UBYTE="ubyte",$$.INDEXTYPE_USHORT="ushort",$$.create=function($R,$F,$i,$j,$t){return void 0===$i&&($i=35044),void 0===$j&&($j=!1),new $$($R,$F,$i,$j,$t);},$$;}($V),$bF=function($p){function $$($R,$F,$i,$j,$t){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===$j&&($j=!1),$$.__super.call(this),this._vertexDeclaration=$R,this._vertexCount=$F,this._bufferUsage=$i,this._bufferType=34962,this._canRead=$j,this.uri=$t,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*$F,this._bind(),$V._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),$j&&(this._buffer=new Float32Array(this._byteLength/4));}$h($$,"laya.d3.graphics.VertexBuffer3D",$p);var $R=$$.prototype;return $R.bindWithIndexBuffer=function($R){$R&&$R._bind(),this._bind();},$R.setData=function($R,$F,$i,$j){if(void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=4294967295),0===$i&&4294967295===$j||($R=new Float32Array($R.buffer,4*$i,$j)),this._bind(),$V._gl.bufferSubData(this._bufferType,4*$F,$R),this._canRead)if(0!==$F||0!==$i||4294967295!==$j){var $t=this._buffer.length-$F;$t<$j&&($j=$t);for(var $p=0;$p<$j;$p++)this._buffer[$F+$p]=$R[$p];}else this._buffer=$R;},$R.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!");},$R.disposeResource=function(){for(var $R=$L.mainContext,$F=this._vertexDeclaration.getVertexElements(),$i=$V._enableAtributes,$j=0,$t=$F.length;$j<$t;$j++)$i[$j]===this._glBuffer&&($R.disableVertexAttribArray($j),$i[$j]=null);$p.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0;},$S(0,$R,"vertexDeclaration",function(){return this._vertexDeclaration;}),$S(0,$R,"vertexCount",function(){return this._vertexCount;}),$S(0,$R,"canRead",function(){return this._canRead;}),$$.create=function($R,$F,$i,$j,$t){return void 0===$i&&($i=35044),void 0===$j&&($j=!1),new $$($R,$F,$i,$j,$t);},$$;}($V),$GF=function($R){function $J(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,$J.__super.call(this),this._type=3553;}$h($J,"laya.d3.resource.DataTexture2D",$LF);var $F=$J.prototype;return $F.genDebugMipmaps=function(){var $R=[];return $R.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),$R.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),$R.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),$R.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),$R.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),$R.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),$R.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),$R.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),$R.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),$R.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),$R;},$F._onTextureLoaded=function($R){},$F._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var $R=$L.mainContext,$F=this._source=$R.createTexture(),$i=this._width,$j=this._height,$t=$Y.curBindTexTarget,$p=$Y.curBindTexValue,$$=!1;if($Y.bindTexture($R,this._type,$F),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var $V=0;$R.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var $N=0;$N<this._mipmaps.length;$N++){if(this._mipmaps[$N].byteLength!=$c*$q*4)throw"mipmap size error  level:"+$N;$R.texSubImage2D(this._type,0,$J.simLodRect[$V++],$J.simLodRect[$V++],$J.simLodRect[$V++],$J.simLodRect[$V++],6408,5121,new Uint8Array(this._mipmaps[$N]));}this.minFifter=9729,this.magFifter=9729;}else{var $c=this._width,$q=this._height;for($V=0,$R.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),$N=0;$N<this._mipmaps.length;$N++){if(this._mipmaps[$N].byteLength!=$c*$q*4)throw"mipmap size error  level:"+$N;$R.texImage2D(this._type,$N,6408,$c,$q,0,6408,5121,new Uint8Array(this._mipmaps[$N])),($c/=2)<1&&($c=1),($q/=2)<1&&($q=1),this.minFifter=9987,this.magFifter=9729;}}this.mipmap=!1;}else if(this._image)6407==this._format&&$R.pixelStorei($R.UNPACK_ALIGNMENT,1),$R.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var $s=0,$k=!1,$h=!1;this._buffer.byteLength==4*$i*$j?($s=6408,$k=!0):this._buffer.byteLength==3*$i*$j?($s=6407,$h=!0):$s=this._format,$k||$h?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),$h&&$R.pixelStorei($R.UNPACK_ALIGNMENT,1),$R.texImage2D(this._type,0,$s,$i,$j,0,$s,5121,this._buffer)):$R&&$s==$R.ALPHA?($R.texImage2D(3553,0,$s,$i,$j,0,$s,$R.UNSIGNED_BYTE,this._buffer),$$=!0):0!=$s&&($R.compressedTexImage2D(3553,0,$s,$i,$j,0,this._buffer),$$=!0);}var $S=this._minFifter,$x=this._magFifter,$a=0==this._wrapModeU?10497:33071,$m=0==this._wrapModeV?10497:33071,$M=$d.isPOT($i,$j);$M?(this._mipmap||this._mipmaps?-1!==$S||($S=9987):-1!==$S||($S=9729),-1!==$x||($x=9729),$R.texParameteri(this._type,10241,$S),$R.texParameteri(this._type,10240,$x),$R.texParameteri(this._type,10242,$a),$R.texParameteri(this._type,10243,$m),this._mipmap&&$R.generateMipmap(this._type)):(-1!==$S||($S=9729),-1!==$x||($x=9729),$R.texParameteri(this._type,10241,$S),$R.texParameteri(this._type,10240,$x),$R.texParameteri(this._type,10242,33071),$R.texParameteri(this._type,10243,33071)),$t&&$p&&$Y.bindTexture($R,$t,$p),this.memorySize=$$?this._buffer.length:$M?$i*$j*4*(1+1/3):$i*$j*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1;},$F.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate();}else{this._recreateLock=!0;}},$F.onAsynLoaded=function($R,$F,$i){var $j;$i&&($j=$i[0].call(this,$F)),$j&&(this._width=$j.width,this._height=$j.height,this._buffer=$j.data),this._src=$R,this._size=new $xF(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded();},$F.getPixels=function(){return new Uint8Array(this._buffer);},$F.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&($L.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0);},$S(0,$F,"src",function(){return this._src;}),$J.create=function($R,$F,$i,$j,$t,$p,$$){if(void 0===$j&&($j=9729),void 0===$t&&($t=9729),void 0===$p&&($p=!0),!$R||$R.byteLength<$F*$i*4)throw"DataTexture2D create error";var $V=new $J();return $V.uri=$$,$V._buffer=$R,$V._width=$F,$V._height=$i,$V._mipmap=$p,$V._magFifter=$j,$V._minFifter=$t,$V._size=new $xF($V._width,$V._height),$V._conchTexture?alert("怎么给runtime传递datatexture数据"):$V.activeResource(),$V;},$J.load=function($R,$F,$i,$j,$t){if(void 0===$F&&($F=0),void 0===$i&&($i=0),void 0===$j&&($j=9729),void 0===$t&&($t=9729),"mipmaps"===$g.getFileExtension($R)){var $p=$w.loader.create($R,null,null,$J,[function($R){this._mipmaps=[];var $F=new Uint32Array($R);this._width=$F[0];var $i=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,$i=1024),this._width!=$i)throw"现在只支持512x256的环境贴图。当前的是"+$F[0];this._height=$F[1];for(var $j=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,$t=this._height,$p=8;;){var $$=$j*$t*4;if($p+$$>$R.byteLength)throw"load mipmaps data size error ";var $V=new Uint8Array($R,$p,$$);if(this._mipmaps.push($V),$p+=$$,1==$j&&1==$t)break;($j/=2)<1&&($j=1),($t/=2)<1&&($t=1);}return null;}]);if(laya.d3.resource.DataTexture2D.lodasatlas){$p.simLodInfo=new Float32Array(40);for(var $$=0;$$<$p.simLodInfo.length;)$p.simLodInfo[$$]=($J.simLodRect[$$]+.5)/1024,$$++,$p.simLodInfo[$$]=($J.simLodRect[$$]+.5)/256,$$++,$p.simLodInfo[$$]=Math.max($J.simLodRect[$$]-1,.1)/1024,$$++,$p.simLodInfo[$$]=Math.max($J.simLodRect[$$]-1.5,.1)/256,$$++;}return $p;}if("number"==typeof $F)return $w.loader.create($R,null,null,$J,[function($R){return this._width=$F,this._height=$i,this._buffer=$R,null;}]);if("function"==typeof $F)return $w.loader.create($R,null,null,$J,[$F]);throw new Error("unknown params.");},$J.lodasatlas=!1,$s($J,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1]);}]),$J;}(),$OF=function($R){function $F(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,$F.__super.call(this);}$h($F,"laya.d3.resource.models.PrimitiveMesh",$YF);var $i=$F.prototype;return $w.imps($i,{"laya.d3.core.render.IRenderable":!0}),$i._getVertexBuffer=function($R){return void 0===$R&&($R=0),0===$R?this._vertexBuffer:null;},$i._getVertexBuffers=function(){return null;},$i._getIndexBuffer=function(){return this._indexBuffer;},$i._getPositions=function(){var $R,$F=[],$i=this._vertexBuffer.vertexDeclaration.getVertexElements(),$j=0;for($j=0;$j<$i.length;$j++){var $t=$i[$j];if("vector3"===$t.elementFormat&&0===$t.elementUsage){$R=$t;break;}}var $p=this._vertexBuffer.getData();for($j=0;$j<$p.length;$j+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var $$=$j+$R.offset/4,$V=new $$F($p[$$+0],$p[$$+1],$p[$$+2]);$F.push($V);}return $F;},$i.getRenderElement=function($R){return this;},$i.getRenderElementsCount=function(){return 1;},$i.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0;},$i._beforeRender=function($R){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0;},$i._render=function($R){$L.mainContext.drawElements(4,this._numberIndices,5123,0),$_.drawCall++,$_.trianglesFaces+=this._numberIndices/3;},$S(0,$i,"_vertexBufferCount",function(){return 1;}),$S(0,$i,"triangleCount",function(){return this._indexBuffer.indexCount/3;}),$F;}(),$yF=function($R){function $F(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,$F.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[];}$h($F,"laya.d3.resource.models.Mesh",$YF);var $i=$F.prototype;return $i._getPositions=function(){var $R,$F,$i,$j,$t,$p=[],$$=0,$V=0,$N=0;if(0!==this._vertexBuffers.length){var $c=this._vertexBuffers.length;for($$=0;$$<$c;$$++){for($i=($R=this._vertexBuffers[$$]).vertexDeclaration.getVertexElements(),$V=0;$V<$i.length;$V++)if("vector3"===($j=$i[$V]).elementFormat&&0===$j.elementUsage){$F=$j;break;}for($t=$R.getData(),$V=0;$V<$t.length;$V+=$R.vertexDeclaration.vertexStride/4)$N=$V+$F.offset/4,$p.push(new $$F($t[$N+0],$t[$N+1],$t[$N+2]));}}else{var $q=this._subMeshes.length;for($$=0;$$<$q;$$++){for($i=($R=this._subMeshes[$$]._getVertexBuffer()).vertexDeclaration.getVertexElements(),$V=0;$V<$i.length;$V++)if("vector3"===($j=$i[$V]).elementFormat&&0===$j.elementUsage){$F=$j;break;}for($t=$R.getData(),$V=0;$V<$t.length;$V+=$R.vertexDeclaration.vertexStride/4)$N=$V+$F.offset/4,$p.push(new $$F($t[$N+0],$t[$N+1],$t[$N+2]));}}return $p;},$i._setSubMeshes=function($R){this._subMeshes=$R,this._subMeshCount=$R.length;for(var $F=0;$F<this._subMeshCount;$F++)$R[$F]._indexInMesh=$F;this._positions=this._getPositions(),this._generateBoundingObject();},$i.onAsynLoaded=function($R,$F,$i){var $j=$F[0],$t=$F[1];$rR.read($j,this,this._materials,this._subMeshes,$t),this.completeCreate(),this._endLoaded();},$i.getSubMesh=function($R){return this._subMeshes[$R];},$i.getSubMeshCount=function(){return this._subMeshes.length;},$i.getRenderElementsCount=function(){return this._subMeshes.length;},$i.getRenderElement=function($R){return this._subMeshes[$R];},$i.disposeResource=function(){for(var $R=0;$R<this._subMeshes.length;$R++)this._subMeshes[$R].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null;},$S(0,$i,"materials",function(){return this._materials.slice();}),$S(0,$i,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses;}),$F.load=function($R){return $w.loader.create($R,null,null,$F);},$F;}(),$EF=(function($R){function $c($R,$F,$i,$j,$t,$p,$$,$V,$N){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===$i&&($i=6408),void 0===$j&&($j=5121),void 0===$t&&($t=33189),void 0===$p&&($p=!1),void 0===$$&&($$=!1),void 0===$V&&($V=-1),void 0===$N&&($N=-1),$c.__super.call(this),this._type=3553,this._width=$R,this._height=$F,this._size=new $xF($R,$F),this._surfaceFormat=$i,this._surfaceType=$j,this._depthStencilFormat=$t,$x.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=$p,this._repeat=$$,this._minFifter=$V,this._magFifter=$N,this.activeResource(),this._alreadyResolved=!0;}$h($c,"laya.d3.resource.RenderTexture",$LF);var $F=$c.prototype;$F.recreateResource=function(){var $R=$L.mainContext;this._frameBuffer=$R.createFramebuffer(),this._source=$R.createTexture();var $F=$Y.curBindTexTarget,$i=$Y.curBindTexValue;$Y.bindTexture($R,this._type,this._source),$R.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var $j=this._minFifter,$t=this._magFifter,$p=this._repeat?10497:33071;if($d.isPOT(this._width,this._height)?(this._mipmap?-1!==$j||($j=9987):-1!==$j||($j=9729),-1!==$t||($t=9729),$R.texParameteri(this._type,10241,$j),$R.texParameteri(this._type,10240,$t),$R.texParameteri(this._type,10242,$p),$R.texParameteri(this._type,10243,$p),this._mipmap&&$R.generateMipmap(this._type)):(-1!==$j||($j=9729),-1!==$t||($t=9729),$R.texParameteri(this._type,10241,$j),$R.texParameteri(this._type,10240,$t),$R.texParameteri(this._type,10242,33071),$R.texParameteri(this._type,10243,33071)),$F&&$i&&$Y.bindTexture($R,$F,$i),$R.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=$R.createRenderbuffer(),$R.bindRenderbuffer(36161,this._depthStencilBuffer),$R.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),$R.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:$R.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$R.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$R.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer);}$R.framebufferTexture2D(36160,36064,3553,this._source,0),$R.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate();},$F.start=function(){$L.mainContext.bindFramebuffer(36160,this.frameBuffer),($c._currentRenderTarget=this)._alreadyResolved=!1;},$F.end=function(){$L.mainContext.bindFramebuffer(36160,null),$c._currentRenderTarget=null,this._alreadyResolved=!0;},$F.getData=function($R,$F,$i,$j){var $t=$L.mainContext;if($t.bindFramebuffer(36160,this._frameBuffer),!(36053===$t.checkFramebufferStatus(36160)))return $t.bindFramebuffer(36160,null),null;var $p=new Uint8Array(this._width*this._height*4);return $t.readPixels($R,$F,$i,$j,this._surfaceFormat,this._surfaceType,$p),$t.bindFramebuffer(36160,null),$p;},$F.disposeResource=function(){if(this._frameBuffer){var $R=$L.mainContext;$R.deleteTexture(this._source),$R.deleteFramebuffer(this._frameBuffer),$R.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0;}},$S(0,$F,"surfaceFormat",function(){return this._surfaceFormat;}),$S(0,$F,"surfaceType",function(){return this._surfaceType;}),$S(0,$F,"depthStencilFormat",function(){return this._depthStencilFormat;}),$S(0,$F,"source",function(){return this._alreadyResolved?$w.superGet($LF,this,"source"):null;}),$S(0,$F,"depthStencilBuffer",function(){return this._depthStencilBuffer;}),$S(0,$F,"frameBuffer",function(){return this._frameBuffer;}),$c._currentRenderTarget=null;}(),function($R){function $F($R){this._color=null,this._pixels=null,$F.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new $xF(this.width,this.height),this._color=$R,this._pixels=new Uint8Array([255*$R.x,255*$R.y,255*$R.z,255*$R.w]),this.uri="SolidColorTexture2D_"+this.id;}$h($F,"laya.d3.resource.SolidColorTexture2D",$LF);var $i=$F.prototype;return $i._createWebGlTexture=function(){var $R=$L.mainContext,$F=this._source=$R.createTexture(),$i=this._width,$j=this._height,$t=$Y.curBindTexTarget,$p=$Y.curBindTexValue;$Y.bindTexture($R,this._type,$F),$R.texImage2D(this._type,0,6408,$i,$j,0,6408,5121,this._pixels);var $$=this._minFifter,$V=this._magFifter,$N=this._repeat?10497:33071,$c=$d.isPOT($i,$j);$c?(this._mipmap?-1!==$$||($$=9987):-1!==$$||($$=9729),-1!==$V||($V=9729),$R.texParameteri(this._type,10241,$$),$R.texParameteri(this._type,10240,$V),$R.texParameteri(this._type,10242,$N),$R.texParameteri(this._type,10243,$N),this._mipmap&&$R.generateMipmap(this._type)):(-1!==$$||($$=9729),-1!==$V||($V=9729),$R.texParameteri(this._type,10241,$$),$R.texParameteri(this._type,10240,$V),$R.texParameteri(this._type,10242,33071),$R.texParameteri(this._type,10243,33071)),$t&&$p&&$Y.bindTexture($R,$t,$p),this.memorySize=$c?$i*$j*4*(1+1/3):$i*$j*4;},$i.recreateResource=function(){this._createWebGlTexture(),this.completeCreate();},$i.disposeResource=function(){this._source&&($L.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0);},$s($F,["magentaTexture",function(){var $R=new $F(new $VF(1,0,1,1));return $R.lock=!0,this.magentaTexture=$R;},"grayTexture",function(){var $R=new $F(new $VF(.5,.5,.5,1));return $R.lock=!0,this.grayTexture=$R;}]),$F;}()),$lF=function($R){function $t($R,$F,$i,$j){this._canRead=!1,this._image=null,this._pixels=null,void 0===$R&&($R=!1),void 0===$F&&($F=!0),void 0===$i&&($i=6408),void 0===$j&&($j=!0),$t.__super.call(this),this._type=3553,this._repeat=$F,this._canRead=$R,this._format=$i,this._mipmap=$j;}$h($t,"laya.d3.resource.Texture2D",$LF);var $F=$t.prototype;return $F._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $R=$L.mainContext,$F=this._source=$R.createTexture(),$i=this._width,$j=this._height,$t=$Y.curBindTexTarget,$p=$Y.curBindTexValue;switch($Y.bindTexture($R,this._type,$F),this._format){case 6407:case 6408:this._canRead?$R.texImage2D(this._type,0,this._format,$i,$j,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?$R.texImage2D(this._type,0,this._image._format,$i,$j,0,this._image._format,5121,this._image.atlasSource):$R.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case $L.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$R.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format);}var $$=this._minFifter,$V=this._magFifter,$N=this._repeat?10497:33071,$c=0==this._wrapModeU?10497:33071,$q=0==this._wrapModeV?10497:33071,$s=$d.isPOT($i,$j);$s?(this._mipmap?-1!==$$||($$=9987):-1!==$$||($$=9729),-1!==$V||($V=9729),$R.texParameteri(this._type,10241,$$),$R.texParameteri(this._type,10240,$V),$R.texParameteri(this._type,10242,$N),$R.texParameteri(this._type,10243,$N),$R.texParameteri(this._type,10242,$c),$R.texParameteri(this._type,10243,$q),this._mipmap&&$R.generateMipmap(this._type)):(-1!==$$||($$=9729),-1!==$V||($V=9729),$R.texParameteri(this._type,10241,$$),$R.texParameteri(this._type,10240,$V),$R.texParameteri(this._type,10242,33071),$R.texParameteri(this._type,10243,33071)),$t&&$p&&$Y.bindTexture($R,$t,$p),this._image.onload=null,this._image=null,this.memorySize=$s?$i*$j*4*(1+1/3):$i*$j*4;},$F.recreateResource=function(){this._createWebGlTexture(),this.completeCreate();},$F.onAsynLoaded=function($R,$F,$i){if($i){var $j=$i[0];void 0!==$j&&(this._canRead=$j);var $t=$i[1];void 0!==$t&&(this._repeat=$t);var $p=$i[2];void 0!==$p&&(this._format=$p);var $$=$i[3];void 0!==$$&&(this._mipmap=$$);var $V=$i.wrapModeU;void 0!==$V&&(this._wrapModeU=$V);var $N=$i.wrapModeV;void 0!==$N&&(this._wrapModeV=$N);}switch(this._format){case 6407:case 6408:var $c=(this._image=$F).width,$q=$F.height;this._width=$c,this._height=$q,this._size=new $xF($c,$q),this._canRead&&($x.isConchApp?$F instanceof $k.HTMLElement&&(this._pixels=new Uint8Array($F.getImageData(0,0,$c,$q))):($f.canvas.size($c,$q),$f.canvas.clear(),$f.context.drawImage($F,0,0,$c,$q),this._pixels=new Uint8Array($f.context.getImageData(0,0,$c,$q).data.buffer)));break;case $L.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var $s=new $X($F);$s.readUTFBytes(4),$s.readUTFBytes(2),$s.getInt16();$s.endian="bigEndian",this._width=$s.getInt16(),this._height=$s.getInt16(),this._size=new $xF(this._width,this._height);$s.getInt16(),$s.getInt16();this._image=new Uint8Array($F,$s.pos);}this.recreateResource(),this._endLoaded();},$F.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.");},$F.disposeResource=function(){this._source&&($L.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0);},$S(0,$F,"_src",function(){return this.url;}),$S(0,$F,"src",function(){return this.url;}),$t.load=function($R){return $w.loader.create($R,null,null,$t);},$t;}(),$WF=function($F){function $i($R,$F){$i.__super.call(this),void 0===$R&&($R=.3),void 0===$F&&($F=1e3),this._tempVector3=new $$F(),this._position=new $$F(),this._up=new $$F(),this._forward=new $$F(),this._right=new $$F(),this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=$xF.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=$R,this._farPlane=$F,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),$w.stage.on("resize",this,this._onScreenSizeChanged);}$h($i,"laya.d3.core.BaseCamera",$F);var $R=$i.prototype;return $R._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var $R=this.scene._cameraPool,$F=$R.length-1,$i=0;$i<$F;$i++)if($R[$i].renderingOrder>$R[$F].renderingOrder){var $j=$R[$i];$R[$i]=$R[$F],$R[$F]=$j;}},$R._calculateProjectionMatrix=function(){},$R._onScreenSizeChanged=function(){this._calculateProjectionMatrix();},$R._prepareCameraToRender=function(){$Z._currentCameraCullingMask=this.cullingMask;var $R=this._shaderValues;$R.setValue(0,this.transform.position.elements),$R.setValue(5,this.forward.elements),$R.setValue(6,this.up.elements);},$R._prepareCameraViewProject=function($R,$F){var $i=this._shaderValues;$i.setValue(1,$R.elements),$i.setValue(2,$F.elements);},$R._renderCamera=function($R,$F,$i){},$R.addLayer=function($R){29!==$R.number&&30!=$R.number&&(this.cullingMask=this.cullingMask|$R.mask);},$R.removeLayer=function($R){29!==$R.number&&30!=$R.number&&(this.cullingMask=this.cullingMask&~$R.mask);},$R.addAllLayers=function(){this.cullingMask=2147483647;},$R.removeAllLayers=function(){this.cullingMask=0|$Z.getLayerByNumber(29).mask|$Z.getLayerByNumber(30).mask;},$R.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix();},$R.moveForward=function($R){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=$R,this.transform.translate(this._tempVector3);},$R.moveRight=function($R){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=$R,this.transform.translate(this._tempVector3);},$R.moveVertical=function($R){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=$R,this.transform.translate(this._tempVector3,!1);},$R._addSelfRenderObjects=function(){var $R=this.scene._cameraPool,$F=$R.length;if(0<$F){for(var $i=$F-1;0<=$i;$i--)if(this.renderingOrder<=$R[$i].renderingOrder){$R.splice($i+1,0,this);break;}}else $R.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel);},$R._clearSelfRenderObjects=function(){var $R=this.scene._cameraPool;$R.splice($R.indexOf(this),1);},$R.destroy=function($R){void 0===$R&&($R=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,$w.stage.off("resize",this,this._onScreenSizeChanged),$F.prototype.destroy.call(this,$R);},$S(0,$R,"sky",function(){return this._sky;},function($R){(this._sky=$R)._ownerCamera=this;}),$S(0,$R,"forward",function(){var $R=this.transform.worldMatrix.elements,$F=this._forward.elements;return $F[0]=-$R[8],$F[1]=-$R[9],$F[2]=-$R[10],this._forward;}),$S(0,$R,"position",function(){var $R=this.transform.worldMatrix.elements,$F=this._position.elements;return $F[0]=$R[12],$F[1]=$R[13],$F[2]=$R[14],this._position;}),$S(0,$R,"renderTarget",function(){return this._renderTarget;},function($R){null!=(this._renderTarget=$R)&&(this._renderTargetSize=$R.size);}),$S(0,$R,"up",function(){var $R=this.transform.worldMatrix.elements,$F=this._up.elements;return $F[0]=$R[4],$F[1]=$R[5],$F[2]=$R[6],this._up;}),$S(0,$R,"right",function(){var $R=this.transform.worldMatrix.elements,$F=this._right.elements;return $F[0]=$R[0],$F[1]=$R[1],$F[2]=$R[2],this._right;}),$S(0,$R,"renderTargetSize",function(){return this._renderTargetSize;},function($R){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=$R,this._calculateProjectionMatrix();}),$S(0,$R,"fieldOfView",function(){return this._fieldOfView;},function($R){this._fieldOfView=$R,this._calculateProjectionMatrix();}),$S(0,$R,"nearPlane",function(){return this._nearPlane;},function($R){this._nearPlane=$R,this._calculateProjectionMatrix();}),$S(0,$R,"farPlane",function(){return this._farPlane;},function($R){this._farPlane=$R,this._calculateProjectionMatrix();}),$S(0,$R,"orthographic",function(){return this._orthographic;},function($R){this._orthographic=$R,this._calculateProjectionMatrix();}),$S(0,$R,"orthographicVerticalSize",function(){return this._orthographicVerticalSize;},function($R){this._orthographicVerticalSize=$R,this._calculateProjectionMatrix();}),$S(0,$R,"renderingOrder",function(){return this._renderingOrder;},function($R){this._renderingOrder=$R,this._sortCamerasByRenderingOrder();}),$i.CAMERAPOS=0,$i.VIEWMATRIX=1,$i.PROJECTMATRIX=2,$i.VPMATRIX=3,$i.VPMATRIX_NO_TRANSLATE=4,$i.CAMERADIRECTION=5,$i.CAMERAUP=6,$i.ENVIRONMENTDIFFUSE=7,$i.ENVIRONMENTSPECULAR=8,$i.SIMLODINFO=9,$i.DIFFUSEIRRADMATR=10,$i.DIFFUSEIRRADMATG=11,$i.DIFFUSEIRRADMATB=12,$i.HDREXPOSURE=13,$i.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",$i.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",$i.CLEARFLAG_SOLIDCOLOR=0,$i.CLEARFLAG_SKY=1,$i.CLEARFLAG_DEPTHONLY=2,$i.CLEARFLAG_NONE=3,$s($i,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new $RF(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1);},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new $RF();},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new $RF();}]),$i;}($vF),$oF=function($i){function $F($R){this._render=null,this._geometryFilter=null,$F.__super.call(this,$R);}$h($F,"laya.d3.core.RenderableSprite3D",$i);var $R=$F.prototype;return $R._addToInitStaticBatchManager=function(){},$R._setBelongScene=function($R){$i.prototype._setBelongScene.call(this,$R),$R._renderableSprite3Ds.push(this),this._render._applyLightMapParams();},$R._setUnBelongScene=function(){var $R=this._scene._renderableSprite3Ds,$F=$R.indexOf(this);$R.splice($F,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),$i.prototype._setUnBelongScene.call(this);},$R._update=function($R){($R.owner=this)._activeInHierarchy&&(this._updateComponents($R),this._render._updateOctreeNode(),this._lateUpdateComponents($R),$_.spriteCount++,this._childs.length&&this._updateChilds($R));},$R.destroy=function($R){void 0===$R&&($R=!0),$i.prototype.destroy.call(this,$R),this._render._destroy(),this._render=null;},$F.__init__=function(){$F.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=$F.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),$F.SAHDERDEFINE_LIGHTMAP=$F.shaderDefines.registerDefine("LIGHTMAP");},$F.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,$F.SAHDERDEFINE_LIGHTMAP=4,$F.LIGHTMAPSCALEOFFSET=2,$F.LIGHTMAP=3,$s($F,["shaderDefines",function(){return this.shaderDefines=new $qF();}]),$F;}($vF),$nF=(function($R){function $j($R,$F,$i){this._long=NaN,this._width=NaN,this._height=NaN,void 0===$R&&($R=1),void 0===$F&&($F=1),void 0===$i&&($i=1),$j.__super.call(this),this._long=$R,this._width=$F,this._height=$i,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject();}$h($j,"laya.d3.resource.models.BoxMesh",$OF);var $F=$j.prototype;$F.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var $R=$LR.vertexDeclaration,$F=($R.vertexStride,this._long/2),$i=this._height/2,$j=this._width/2,$t=new Float32Array([-$F,$i,-$j,0,1,0,0,0,$F,$i,-$j,0,1,0,1,0,$F,$i,$j,0,1,0,1,1,-$F,$i,$j,0,1,0,0,1,-$F,-$i,-$j,0,-1,0,0,1,$F,-$i,-$j,0,-1,0,1,1,$F,-$i,$j,0,-1,0,1,0,-$F,-$i,$j,0,-1,0,0,0,-$F,$i,-$j,-1,0,0,0,0,-$F,$i,$j,-1,0,0,1,0,-$F,-$i,$j,-1,0,0,1,1,-$F,-$i,-$j,-1,0,0,0,1,$F,$i,-$j,1,0,0,1,0,$F,$i,$j,1,0,0,0,0,$F,-$i,$j,1,0,0,0,1,$F,-$i,-$j,1,0,0,1,1,-$F,$i,$j,0,0,1,0,0,$F,$i,$j,0,0,1,1,0,$F,-$i,$j,0,0,1,1,1,-$F,-$i,$j,0,0,1,0,1,-$F,$i,-$j,0,0,-1,1,0,$F,$i,-$j,0,0,-1,0,0,$F,-$i,-$j,0,0,-1,0,1,-$F,-$i,-$j,0,0,-1,1,1]),$p=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new $bF($R,this._numberVertices,35044,!0),this._indexBuffer=new $QF("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData($t),this._indexBuffer.setData($p),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate();},$S(0,$F,"long",function(){return this._long;},function($R){this._long!==$R&&(this._long=$R,this.releaseResource(),this.activeResource());}),$S(0,$F,"width",function(){return this._width;},function($R){this._width!==$R&&(this._width=$R,this.releaseResource(),this.activeResource());}),$S(0,$F,"height",function(){return this._height;},function($R){this._height!==$R&&(this._height=$R,this.releaseResource(),this.activeResource());});}(),function($R){function $t($R,$F,$i,$j){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===$R&&($R=10),void 0===$F&&($F=10),void 0===$i&&($i=10),void 0===$j&&($j=10),$t.__super.call(this),this._long=$R,this._width=$F,this._stacks=$i,this._slices=$j,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject();}$h($t,"laya.d3.resource.models.PlaneMesh",$OF);var $F=$t.prototype;$F.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var $R=new Uint16Array(this._numberIndices),$F=$LR.vertexDeclaration,$i=$F.vertexStride/4,$j=new Float32Array(this._numberVertices*$i),$t=this._long/2,$p=this._width/2,$$=this._long/this._stacks,$V=this._width/this._slices,$N=0,$c=0;$c<=this._slices;$c++)for(var $q=0;$q<=this._stacks;$q++)$j[$N++]=$q*$$-$t,$j[$N++]=0,$j[$N++]=$c*$V-$p,$j[$N++]=0,$j[$N++]=1,$j[$N++]=0,$j[$N++]=1*$q/this._stacks,$j[$N++]=1*$c/this._slices;var $s=0;for($c=0;$c<this._slices;$c++)for($q=0;$q<this._stacks;$q++)$R[$s++]=($c+1)*(this._stacks+1)+$q,$R[$s++]=$c*(this._stacks+1)+$q,$R[$s++]=($c+1)*(this._stacks+1)+$q+1,$R[$s++]=$c*(this._stacks+1)+$q,$R[$s++]=$c*(this._stacks+1)+$q+1,$R[$s++]=($c+1)*(this._stacks+1)+$q+1;this._vertexBuffer=new $bF($F,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new $QF("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData($j),this._indexBuffer.setData($R),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate();},$S(0,$F,"long",function(){return this._long;},function($R){this._long!==$R&&(this._long=$R,this.releaseResource(),this.activeResource());}),$S(0,$F,"width",function(){return this._width;},function($R){this._width!==$R&&(this._width=$R,this.releaseResource(),this.activeResource());}),$S(0,$F,"stacks",function(){return this._stacks;},function($R){this._stacks!==$R&&(this._stacks=$R,this.releaseResource(),this.activeResource());}),$S(0,$F,"slices",function(){return this._slices;},function($R){this._slices!==$R&&(this._slices=$R,this.releaseResource(),this.activeResource());});}(),function($R){function $$($R,$F,$i){void 0===$R&&($R=0),void 0===$F&&($F=.3),void 0===$i&&($i=1e3),this._viewMatrix=new $RF(),this._projectionMatrix=new $RF(),this._projectionViewMatrix=new $RF(),this._viewport=new $NF(0,0,0,0),this._normalizedViewport=new $NF(0,0,1,1),this._aspectRatio=$R,this._boundFrustumUpdate=!0,this._boundFrustum=new $PR($RF.DEFAULT),$$.__super.call(this,$F,$i),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged);}$h($$,"laya.d3.core.Camera",$WF);var $F=$$.prototype;return $F._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0;},$F._parseCustomProps=function($R,$F,$i,$j){var $t=$i.clearColor;this.clearColor=new $VF($t[0],$t[1],$t[2],$t[3]);var $p=$i.viewport;this.normalizedViewport=new $NF($p[0],$p[1],$p[2],$p[3]);},$F._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var $R=this.orthographicVerticalSize*this.aspectRatio*.5,$F=.5*this.orthographicVerticalSize;$RF.createOrthoOffCenterRH(-$R,$R,-$F,$F,this.nearPlane,this.farPlane,this._projectionMatrix);}else $RF.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0;},$F._update=function($R){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,$R);},$F._renderCamera=function($R,$F,$i){var $j,$t;$i.parallelSplitShadowMaps[0]&&$i._renderShadowMap($R,$F,this),($F.camera=this)._prepareCameraToRender(),$i._preRenderUpdateComponents($F),$j=$F._viewMatrix=this.viewMatrix;var $p=this._renderTarget;$p?($p.start(),$RF.multiply($WF._invertYScaleMatrix,this._projectionMatrix,$WF._invertYProjectionMatrix),$RF.multiply($WF._invertYScaleMatrix,this.projectionViewMatrix,$WF._invertYProjectionViewMatrix),$t=$F._projectionMatrix=$WF._invertYProjectionMatrix,$F._projectionViewMatrix=$WF._invertYProjectionViewMatrix):($t=$F._projectionMatrix=this._projectionMatrix,$F._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject($j,$t),$F._viewport=this.viewport,$i._preRenderScene($R,$F,this.boundFrustum),$i._clear($R,$F),$i._renderScene($R,$F),$i._postRenderUpdateComponents($F),$p&&$p.end();},$F.viewportPointToRay=function($R,$F){$SF.calculateCursorRay($R,this.viewport,this._projectionMatrix,this.viewMatrix,null,$F);},$F.normalizedViewportPointToRay=function($R,$F){var $i=$$._tempVector20,$j=this.viewport,$t=$R.elements,$p=$i.elements;$p[0]=$t[0]*$j.width,$p[1]=$t[1]*$j.height,$SF.calculateCursorRay($i,this.viewport,this._projectionMatrix,this.viewMatrix,null,$F);},$F.worldToViewportPoint=function($R,$F){$RF.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project($R,this._projectionViewMatrix,$F);var $i=$F.elements;$i[0]=$i[0]/$w.stage.clientScaleX,$i[1]=$i[1]/$w.stage.clientScaleY;},$F.worldToNormalizedViewportPoint=function($R,$F){$RF.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project($R,this._projectionViewMatrix,$F);var $i=$F.elements;$i[0]=$i[0]/$w.stage.clientScaleX,$i[1]=$i[1]/$w.stage.clientScaleY;},$F.convertScreenCoordToOrthographicCoord=function($R,$F){if(this._orthographic){var $i=$r.clientWidth,$j=$r.clientHeight,$t=this.orthographicVerticalSize*this.aspectRatio/$i,$p=this.orthographicVerticalSize/$j,$$=$R.elements,$V=$F.elements;return $V[0]=(-$i/2+$$[0])*$t,$V[1]=($j/2-$$[1])*$p,$V[2]=(this.nearPlane-this.farPlane)*($$[2]+1)/2-this.nearPlane,$$F.transformCoordinate($F,this.transform.worldMatrix,$F),!0;}return!1;},$S(0,$F,"projectionViewMatrix",function(){return $RF.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix;}),$S(0,$F,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var $R=this.viewport;return $R.width/$R.height;},function($R){if($R<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=$R,this._calculateProjectionMatrix();}),$S(0,$F,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum;}),$S(0,$F,"needViewport",function(){var $R=this.normalizedViewport;return 0===$R.x&&0===$R.y&&1===$R.width&&1===$R.height;}),$S(0,$F,"viewport",function(){if(this._viewportExpressedInClipSpace){var $R=this._normalizedViewport,$F=this.renderTargetSize,$i=$F.width,$j=$F.height;this._viewport.x=$R.x*$i,this._viewport.y=$R.y*$j,this._viewport.width=$R.width*$i,this._viewport.height=$R.height*$j;}return this._viewport;},function($R){if(null!=this.renderTarget&&($R.x<0||$R.y<0||0==$R.width||0==$R.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=$R,this._calculateProjectionMatrix();}),$S(0,$F,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var $R=this._viewport,$F=this.renderTargetSize,$i=$F.width,$j=$F.height;this._normalizedViewport.x=$R.x/$i,this._normalizedViewport.y=$R.y/$j,this._normalizedViewport.width=$R.width/$i,this._normalizedViewport.height=$R.height/$j;}return this._normalizedViewport;},function($R){$R.x<0&&($R.x=0,console.warn("Camera: viewport.x must large than 0.0.")),$R.y<0&&($R.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<$R.x+$R.width&&($R.width=1-$R.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<$R.y+$R.height&&($R.height=1-$R.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=$R,this._calculateProjectionMatrix();}),$S(0,$F,"projectionMatrix",function(){return this._projectionMatrix;},function($R){this._projectionMatrix=$R,this._useUserProjectionMatrix=!0;}),$S(0,$F,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix;}),$s($$,["_tempVector20",function(){return this._tempVector20=new $pF();}]),$$;}()),$CF=function($i){function $j($R,$F){$j.__super.call(this,$F),this._geometryFilter=new $fF(this),this._render=new $ZF(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),$R&&(this._geometryFilter.sharedMesh=$R)instanceof laya.d3.resource.models.Mesh&&($R.loaded?this._render.sharedMaterials=$R.materials:$R.once("loaded",this,this._applyMeshMaterials));}$h($j,"laya.d3.core.MeshSprite3D",$i);var $R=$j.prototype;return $R._changeRenderObjectByMesh=function($R){var $F=this._render._renderElements,$i=$F[$R];$i||($i=$F[$R]=new $HF()),$i._render=this._render;var $j=this._render.sharedMaterials[$R];$j||($j=$eF.defaultMaterial);var $t=this._geometryFilter.sharedMesh.getRenderElement($R);return $i._mainSortID=this._getSortID($t,$j),$i._sprite3D=this,$i.renderObj=$t,$i._material=$j,$i;},$R._changeRenderObjectByMaterial=function($R,$F){var $i=this._render._renderElements[$R];$F||($F=$eF.defaultMaterial);var $j=this._geometryFilter.sharedMesh.getRenderElement($R);return $i._mainSortID=this._getSortID($j,$F),$i._sprite3D=this,$i.renderObj=$j,$i._material=$F,$i;},$R._changeRenderObjectsByMesh=function(){var $R=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=$R;for(var $F=0;$F<$R;$F++)this._changeRenderObjectByMesh($F);},$R._onMeshChanged=function($R){var $F=$R.sharedMesh;$F.loaded?this._changeRenderObjectsByMesh():$F.once("loaded",this,this._onMeshLoaded);},$R._onMeshLoaded=function($R){$R===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh();},$R._onMaterialChanged=function($R,$F,$i){$F<this._render._renderElements.length&&this._changeRenderObjectByMaterial($F,$i);},$R._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render);},$R._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render);},$R._parseCustomProps=function($R,$F,$i,$j){var $t=this.meshRender,$p=$i.lightmapIndex;null!=$p&&($t.lightmapIndex=$p);var $$,$V,$N=$i.lightmapScaleOffset;if($N&&($t.lightmapScaleOffset=new $VF($N[0],$N[1],$N[2],$N[3])),$j.instanceParams)($$=$j.instanceParams.loadPath)&&($V=$m.getRes($F[$$]),(this.meshFilter.sharedMesh=$V).loaded?$t.sharedMaterials=$V.materials:$V.once("loaded",this,this._applyMeshMaterials));else{($$=$i.meshPath)&&($V=$m.getRes($F[$$]),this.meshFilter.sharedMesh=$V);var $c=$i.materials;if($c){var $q=$t.sharedMaterials,$s=$c.length;$q.length=$s;for(var $k=0;$k<$s;$k++)$q[$k]=$m.getRes($F[$c[$k].path]);$t.sharedMaterials=$q;}}},$R._applyMeshMaterials=function($R){for(var $F=this._render.sharedMaterials,$i=$R.materials,$j=0,$t=$i.length;$j<$t;$j++)$F[$j]||($F[$j]=$i[$j]);this._render.sharedMaterials=$F;},$R._addToInitStaticBatchManager=function(){$j._staticBatchManager._addInitBatchSprite(this);},$R.cloneTo=function($R){var $F=$R;$F._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var $i=this._render,$j=$F._render;$j.enable=$i.enable,$j.sharedMaterials=$i.sharedMaterials,$j.castShadow=$i.castShadow;var $t=$i.lightmapScaleOffset;$t&&($j.lightmapScaleOffset=$t.clone()),$j.lightmapIndex=$i.lightmapIndex,$j.receiveShadow=$i.receiveShadow,$j.sortingFudge=$i.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,$R);},$R.destroy=function($R){if(void 0===$R&&($R=!0),!this.destroyed){var $F=this.meshFilter.sharedMesh;null!=$F&&($F.loaded||$F.off("loaded",this,this._applyMeshMaterials)),$i.prototype.destroy.call(this,$R),this._geometryFilter._destroy();}},$S(0,$R,"meshFilter",function(){return this._geometryFilter;}),$S(0,$R,"meshRender",function(){return this._render;}),$j.__init__=function(){$jR._staticBatchManagers.push($j._staticBatchManager);},$j.load=function($R){return $w.loader.create($R,null,null,$j);},$s($j,["_staticBatchManager",function(){return this._staticBatchManager=new $TF();}]),$j;}($oF);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($R,$F){"use strict";for(var $i in Object.defineProperty($F,"__esModule",{value:!0}),Laya){var $j=Laya[$i];$j&&$j.__isclass&&($F[$i]=$j);}}),function($R,$F,$tR){$tR.un,$tR.uns;var $i=$tR.static,$j=$tR.class,$p=$tR.getset,$x=$tR.__newvec,$V=laya.maths.Bezier,$s=laya.utils.Browser,$LR=laya.utils.Byte,$t=(laya.events.Event,laya.events.EventDispatcher),$$=laya.display.Graphics,$N=(laya.resource.HTMLCanvas,laya.utils.Handler),$c=laya.net.Loader,$k=laya.maths.MathUtil,$YR=laya.maths.Matrix,$a=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),$q=(laya.renders.RenderContext,laya.resource.Resource),$h=laya.utils.RunDriver,$pR=laya.display.Sprite,$S=laya.utils.Stat,$fR=laya.resource.Texture,$m=(laya.net.URL,laya.utils.Utils),$Y=function(){function $R(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0;}return $j($R,"laya.ani.AnimationContent"),$R;}(),$f=function(){function $R(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0;}return $j($R,"laya.ani.AnimationNodeContent"),$R;}(),$J=function(){function $R(){}return $j($R,"laya.ani.AnimationParser01"),$R.parse=function($R,$F){var $i=$F.__getBuffer(),$j=0,$t=0,$p=0,$$=0,$V=0,$N=0,$c=0,$q=$F.readUTFString();$R._aniClassName=$q;var $s,$k=$F.readUTFString().split("\n"),$h=$F.getUint8(),$S=$F.getUint32(),$x=$F.getUint32();0<$S&&($s=$i.slice($S,$x));var $a=new $LR($s);for(0<$x&&($R._publicExtData=$i.slice($x,$i.byteLength)),$R._useParent=!!$F.getUint8(),$R._anis.length=$h,$j=0;$j<$h;$j++){var $m=$R._anis[$j]=new $Y();$m.nodes=new Array();var $M=$m.name=$k[$F.getUint16()];$R._aniMap[$M]=$j,$m.bone3DMap={},$m.playTime=$F.getFloat32(),$m.playTime<=0&&console.error("播放时间不能为0  url="+$R.url+" name="+$m.name);var $J=$m.nodes.length=$F.getUint8();for($t=$m.totalKeyframeDatasLength=0;$t<$J;$t++){var $d=$m.nodes[$t]=new $f();$d.childs=[];var $w=$F.getInt16();0<=$w&&($d.name=$k[$w],$m.bone3DMap[$d.name]=$t),$d.keyFrame=new Array(),$d.parentIndex=$F.getInt16(),-1==$d.parentIndex?$d.parent=null:$d.parent=$m.nodes[$d.parentIndex],$d.lerpType=$F.getUint8();var $X=$F.getUint32();$a.pos=$X;var $H=$d.keyframeWidth=$a.getUint16();if($m.totalKeyframeDatasLength+=$H,0===$d.lerpType||1===$d.lerpType)for($d.interpolationMethod=[],$d.interpolationMethod.length=$H,$p=0;$p<$H;$p++)$d.interpolationMethod[$p]=$v.interpolation[$a.getUint8()];null!=$d.parent&&$d.parent.childs.push($d);var $_=$F.getUint16();0<$_&&($d.extenData=$i.slice($F.pos,$F.pos+$_),$F.pos+=$_);var $T,$g=$F.getUint16(),$B=0;for($p=0,$$=$d.keyFrame.length=$g;$p<$$;$p++){if(($T=$d.keyFrame[$p]=new $Z()).duration=$F.getFloat32(),$T.startTime=$B,2===$d.lerpType){$T.interpolationData=[];var $z,$L=$F.getUint8();switch($z=$F.getFloat32()){case 254:for($T.interpolationData.length=$H,$c=0;$c<$H;$c++)$T.interpolationData[$c]=0;break;case 255:for($T.interpolationData.length=$H,$c=0;$c<$H;$c++)$T.interpolationData[$c]=5;break;default:for($T.interpolationData.push($z),$N=1;$N<$L;$N++)$T.interpolationData.push($F.getFloat32());}}for($T.data=new Float32Array($H),$V=0;$V<$H;$V++)$T.data[$V]=$F.getFloat32(),-1e-8<$T.data[$V]&&$T.data[$V]<1e-8&&($T.data[$V]=0);$B+=$T.duration;}$T.startTime=$m.playTime,$d.playTime=$m.playTime,$R._calculateKeyFrame($d,$g,$H);}}},$R;}(),$d=function(){function $w(){}return $j($w,"laya.ani.AnimationParser02"),$w.READ_DATA=function(){$w._DATA.offset=$w._reader.getUint32(),$w._DATA.size=$w._reader.getUint32();},$w.READ_BLOCK=function(){for(var $R=$w._BLOCK.count=$w._reader.getUint16(),$F=$w._BLOCK.blockStarts=[],$i=$w._BLOCK.blockLengths=[],$j=0;$j<$R;$j++)$F.push($w._reader.getUint32()),$i.push($w._reader.getUint32());},$w.READ_STRINGS=function(){var $R=$w._reader.getUint32(),$F=$w._reader.getUint16(),$i=$w._reader.pos;$w._reader.pos=$R+$w._DATA.offset;for(var $j=0;$j<$F;$j++)$w._strings[$j]=$w._reader.readUTFString();$w._reader.pos=$i;},$w.parse=function($R,$F){$w._templet=$R;($w._reader=$F).__getBuffer();$w.READ_DATA(),$w.READ_BLOCK(),$w.READ_STRINGS();for(var $i=0,$j=$w._BLOCK.count;$i<$j;$i++){var $t=$F.getUint16(),$p=$w._strings[$t],$$=$w["READ_"+$p];if(null==$$)throw new Error("model file err,no this function:"+$t+" "+$p);$$.call();}},$w.READ_ANIMATIONS=function(){var $R=$w._reader,$F=$R.__getBuffer(),$i=0,$j=0,$t=0,$p=0,$$=$R.getUint16(),$V=[];for($V.length=$$,$i=0;$i<$$;$i++)$V[$i]=$v.interpolation[$R.getByte()];var $N=$R.getUint8();for($w._templet._anis.length=$N,$i=0;$i<$N;$i++){var $c=$w._templet._anis[$i]={};$c.nodes=new Array();var $q=$c.name=$w._strings[$R.getUint16()];$w._templet._aniMap[$q]=$i,$c.bone3DMap={},$c.playTime=$R.getFloat32();var $s=$c.nodes.length=$R.getInt16();for($j=$c.totalKeyframeDatasLength=0;$j<$s;$j++){var $k=$c.nodes[$j]={};$k.keyframeWidth=$$,$k.childs=[];var $h=$R.getUint16();0<=$h&&($k.name=$w._strings[$h],$c.bone3DMap[$k.name]=$j),$k.keyFrame=new Array(),$k.parentIndex=$R.getInt16(),-1==$k.parentIndex?$k.parent=null:$k.parent=$c.nodes[$k.parentIndex],$c.totalKeyframeDatasLength+=$$,$k.interpolationMethod=$V,null!=$k.parent&&$k.parent.childs.push($k);var $S=$R.getUint16(),$x=null,$a=null;for($t=0,$p=$k.keyFrame.length=$S;$t<$p;$t++){($x=$k.keyFrame[$t]={}).startTime=$R.getFloat32(),$a&&($a.duration=$x.startTime-$a.startTime);var $m=$w._DATA.offset,$M=$R.getUint32(),$J=4*$$,$d=$F.slice($m+$M,$m+$M+$J);$x.data=new Float32Array($d),$a=$x;}$x.duration=0,$k.playTime=$c.playTime,$w._templet._calculateKeyFrame($k,$S,$$);}}},$w._templet=null,$w._reader=null,$w._strings=[],$i($w,["_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]),$w;}(),$ZR=(function(){function $R(){}$j($R,"laya.ani.AnimationState"),$R.stopped=0,$R.paused=1,$R.playing=2;}(),function(){function $t(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new $oR(),this.resultMatrix=new $YR(),this._children=[];}$j($t,"laya.ani.bone.Bone");var $R=$t.prototype;return $R.setTempMatrix=function($R){this._tempMatrix=$R;var $F,$i=0;for($i=0,$F=this._children.length;$i<$F;$i++)this._children[$i].setTempMatrix(this._tempMatrix);},$R.update=function($R){var $F;if(this.rotation=this.transform.skX,$R)$F=this.resultTransform.getMatrix(),$YR.mul($F,$R,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone){if(this.inheritRotation&&this.inheritScale)$F=this.resultTransform.getMatrix(),$YR.mul($F,this.parentBone.resultMatrix,this.resultMatrix);else{var $i=this.parentBone,$j=NaN,$t=NaN,$p=NaN,$$=this.parentBone.resultMatrix;$F=this.resultTransform.getMatrix();var $V=$$.a*$F.tx+$$.c*$F.ty+$$.tx,$N=$$.b*$F.tx+$$.d*$F.ty+$$.ty,$c=new $YR();this.inheritRotation?($j=Math.atan2($i.resultMatrix.b,$i.resultMatrix.a),$t=Math.cos($j),$p=Math.sin($j),$c.setTo($t,$p,-$p,$t,0,0),$YR.mul(this._tempMatrix,$c,$YR.TEMP),$YR.TEMP.copyTo($c),$F=this.resultTransform.getMatrix(),$YR.mul($F,$c,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,$F=this.resultTransform.getMatrix(),$YR.TEMP.identity(),$YR.TEMP.d=this.d,$YR.mul($F,$YR.TEMP,this.resultMatrix)),this.resultMatrix.tx=$V,this.resultMatrix.ty=$N;}}else($F=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var $q,$s=0;for($s=0,$q=this._children.length;$s<$q;$s++)this._children[$s].update();},$R.updateChild=function(){var $R,$F=0;for($F=0,$R=this._children.length;$F<$R;$F++)this._children[$F].update();},$R.setRotation=function($R){this._sprite&&(this._sprite.rotation=180*$R/Math.PI);},$R.updateDraw=function($R,$F){$t.ShowBones&&!$t.ShowBones[this.name]||(this._sprite||(this._sprite=new $pR(),this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),$tR.stage.addChild(this._sprite)),this._sprite.x=$R+this.resultMatrix.tx,this._sprite.y=$F+this.resultMatrix.ty);var $i,$j=0;for($j=0,$i=this._children.length;$j<$i;$j++)this._children[$j].updateDraw($R,$F);},$R.addChild=function($R){this._children.push($R),$R.parentBone=this;},$R.findBone=function($R){if(this.name==$R)return this;var $F,$i,$j=0;for($j=0,$F=this._children.length;$j<$F;$j++)if($i=this._children[$j].findBone($R))return $i;return null;},$R.localToWorld=function($R){var $F=$R[0],$i=$R[1];$R[0]=$F*this.resultMatrix.a+$i*this.resultMatrix.c+this.resultMatrix.tx,$R[1]=$F*this.resultMatrix.b+$i*this.resultMatrix.d+this.resultMatrix.ty;},$t.ShowBones={},$t;}()),$uR=function(){function $x(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null;}$j($x,"laya.ani.bone.BoneSlot");var $R=$x.prototype;return $R.showSlotData=function($R,$F){void 0===$F&&($F=!0),this.currSlotData=$R,$F&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null;},$R.showDisplayByName=function($R){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName($R));},$R.replaceDisplayByName=function($R,$F){if(this.currSlotData){var $i;$i=this.currSlotData.getDisplayByName($R);var $j;$j=this.currSlotData.getDisplayByName($F),this.replaceDisplayByIndex($i,$j);}},$R.replaceDisplayByIndex=function($R,$F){this.currSlotData&&(this._replaceDic[$R]=$F,this.displayIndex==$R&&this.showDisplayByIndex($R));},$R.showDisplayByIndex=function($R){if(null!=this._replaceDic[$R]&&($R=this._replaceDic[$R]),this.currSlotData&&-1<$R&&$R<this.currSlotData.displayArr.length){if(this.displayIndex=$R,this.currDisplayData=this.currSlotData.displayArr[$R],this.currDisplayData){var $F=this.currDisplayData.name;this.currTexture=this.templet.getTexture($F),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!$a.isConchApp||$a.isConchApp&&"0.9.15"<$pR.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture));}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null;},$R.replaceSkin=function($R){this._diyTexture=$R,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null);},$R.setParentMatrix=function($R){this._parentMatrix=$R;},$R.draw=function($R,$F,$i,$j){if(void 0===$i&&($i=!1),void 0===$j&&($j=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var $t,$p=this.currTexture;switch(this._diyTexture&&($p=this._diyTexture),this.currDisplayData.type){case 0:if($R){var $$=this.getDisplayMatrix();if(this._parentMatrix){var $V=!1;if($$){var $N;if($YR.mul($$,this._parentMatrix,$YR.TEMP),$N=$i?(null==this._resultMatrix&&(this._resultMatrix=new $YR()),this._resultMatrix):new $YR(),!$a.isWebGL&&this.currDisplayData.uvs||$a.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var $c=$x._tempMatrix;$c.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($c.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($V=!0,$c.rotate(-Math.PI/2)),$YR.mul($c,$YR.TEMP,$N);}else $YR.TEMP.copyTo($N);$V?$R.drawTexture($p,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,$N):$R.drawTexture($p,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,$N);}}}break;case 1:if(null==($t=$i?(null==this._skinSprite&&(this._skinSprite=$x.createSkinMesh()),this._skinSprite):$x.createSkinMesh()))return;var $q;if(null==this.currDisplayData.bones){var $s,$k=this.currDisplayData.weights;this.deformData&&($k=this.deformData),$s=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$H.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$H.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=$k;this.currDisplayData.triangles.length;$q=this.currDisplayData.triangles,$t.init2($p,null,$q,this._mVerticleArr,$s);var $h,$S=this.getDisplayMatrix();if(this._parentMatrix)if($S)$YR.mul($S,this._parentMatrix,$YR.TEMP),$h=$i?(null==this._resultMatrix&&(this._resultMatrix=new $YR()),this._resultMatrix):new $YR(),$YR.TEMP.copyTo($h),$t.transform=$h;}else this.skinMesh($F,$t,$j);$R.drawSkin($t);break;case 2:if(null==($t=$i?(null==this._skinSprite&&(this._skinSprite=$x.createSkinMesh()),this._skinSprite):$x.createSkinMesh()))return;this.skinMesh($F,$t,$j),$R.drawSkin($t);}}},$R.skinMesh=function($R,$F,$i){var $j,$t=this.currTexture,$p=this.currDisplayData.bones;$j=this._diyTexture?($t=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$H.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$H.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var $$,$V,$N=this.currDisplayData.weights,$c=this.currDisplayData.triangles,$q=0,$s=0,$k=0,$h=NaN,$S=NaN,$x=0,$a=0,$m=[],$M=0,$J=0;if(this.deformData&&0<this.deformData.length){var $d=0;for($M=0,$J=$p.length;$M<$J;){for($k=$p[$M++]+$M,$s=$q=0;$M<$k;$M++)$V=$R[$p[$M]],$h=$N[$x]+this.deformData[$d++],$S=$N[$x+1]+this.deformData[$d++],$a=$N[$x+2],$q+=($h*$V.a+$S*$V.c+$V.tx)*$a,$s+=($h*$V.b+$S*$V.d+$V.ty)*$a,$x+=3;$m.push($q,$s);}}else for($M=0,$J=$p.length;$M<$J;){for($k=$p[$M++]+$M,$s=$q=0;$M<$k;$M++)$V=$R[$p[$M]],$h=$N[$x],$S=$N[$x+1],$a=$N[$x+2],$q+=($h*$V.a+$S*$V.c+$V.tx)*$a,$s+=($h*$V.b+$S*$V.d+$V.ty)*$a,$x+=3;$m.push($q,$s);}this._mVerticleArr=$m,$$=$c,$F.init2($t,null,$$,this._mVerticleArr,$j);},$R.drawBonePoint=function($R){$R&&this._parentMatrix&&$R.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000");},$R.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null;},$R.getMatrix=function(){return this._resultMatrix;},$R.copy=function(){var $R=new $x();return $R.type="copy",$R.name=this.name,$R.attachmentName=this.attachmentName,$R.srcDisplayIndex=this.srcDisplayIndex,$R.parent=this.parent,$R.displayIndex=this.displayIndex,$R.templet=this.templet,$R.currSlotData=this.currSlotData,$R.currTexture=this.currTexture,$R.currDisplayData=this.currDisplayData,$R;},$x.createSkinMesh=function(){return $a.isWebGL||$a.isConchApp?$h.skinAniSprite():($a.isWebGL,null);},$i($x,["_tempMatrix",function(){return this._tempMatrix=new $YR();}]),$x;}(),$vR=function(){function $R(){this.skinName=null,this.deformSlotDataList=[];}return $j($R,"laya.ani.bone.DeformAniData"),$R;}(),$KR=function(){function $R(){this.deformSlotDisplayList=[];}return $j($R,"laya.ani.bone.DeformSlotData"),$R;}(),$eR=function(){function $R(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[];}$j($R,"laya.ani.bone.DeformSlotDisplayData");var $F=$R.prototype;return $F.binarySearch1=function($R,$F){var $i=0,$j=$R.length-2;if(0==$j)return 1;for(var $t=$j>>>1;;){if($R[Math.floor($t+1)]<=$F?$i=$t+1:$j=$t,$i==$j)return $i+1;$t=$i+$j>>>1;}return 0;},$F.apply=function($R,$F,$i){if(void 0===$i&&($i=1),$R+=.05,!(this.timeList.length<=0)){var $j=0;if(!($R<this.timeList[0])){var $t=this.vectices[0].length,$p=[],$$=this.binarySearch1(this.timeList,$R);if(this.frameIndex=$$,$R>=this.timeList[this.timeList.length-1]){var $V=this.vectices[this.vectices.length-1];if($i<1)for($j=0;$j<$t;$j++)$p[$j]+=($V[$j]-$p[$j])*$i;else for($j=0;$j<$t;$j++)$p[$j]=$V[$j];this.deformData=$p;}else{this.tweenKeyList[this.frameIndex];var $N=this.vectices[this.frameIndex-1],$c=this.vectices[this.frameIndex],$q=this.timeList[this.frameIndex-1],$s=this.timeList[this.frameIndex];$i=this.tweenKeyList[$$-1]?($R-$q)/($s-$q):0;var $k=NaN;for($j=0;$j<$t;$j++)$k=$N[$j],$p[$j]=$k+($c[$j]-$k)*$i;this.deformData=$p;}}}},$R;}(),$QR=function(){function $R(){this.time=NaN,this.drawOrder=[];}return $j($R,"laya.ani.bone.DrawOrderData"),$R;}(),$bR=function(){function $R(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN;}return $j($R,"laya.ani.bone.EventData"),$R;}(),$M=function(){function $jR($R,$F){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=$R,this._targetBone=$F[$R.targetBoneIndex],this.isSpine=$R.isSpine,null==this._bones&&(this._bones=[]);for(var $i=this._bones.length=0,$j=$R.boneIndexs.length;$i<$j;$i++)this._bones.push($F[$R.boneIndexs[$i]]);this.name=$R.name,this.mix=$R.mix,this.bendDirection=$R.bendDirection;}$j($jR,"laya.ani.bone.IkConstraint");var $R=$jR.prototype;return $R.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix);}},$R._applyIk1=function($R,$F,$i,$j){var $t=$R.parentBone,$p=1/($t.resultMatrix.a*$t.resultMatrix.d-$t.resultMatrix.b*$t.resultMatrix.c),$$=$F-$t.resultMatrix.tx,$V=$i-$t.resultMatrix.ty,$N=($$*$t.resultMatrix.d-$V*$t.resultMatrix.c)*$p-$R.transform.x,$c=($V*$t.resultMatrix.a-$$*$t.resultMatrix.b)*$p-$R.transform.y,$q=Math.atan2($c,$N)*$jR.radDeg-0-$R.transform.skX;$R.transform.scX<0&&($q+=180),180<$q?$q-=360:$q<-180&&($q+=360),$R.transform.skX=$R.transform.skY=$R.transform.skX+$q*$j,$R.update();},$R.updatePos=function($R,$F){this._sp&&this._sp.pos($R,$F);},$R._applyIk2=function($R,$F,$i,$j,$t,$p){if(0!=$p){var $$=$R.resultTransform.x,$V=$R.resultTransform.y,$N=$R.transform.scX,$c=$R.transform.scY,$q=$F.transform.scX,$s=0,$k=0,$h=0;$h=$N<0?($N=-$N,$s=180,-1):($s=0,1),$c<0&&($c=-$c,$h=-$h),$k=$q<0?($q=-$q,180):0;var $S=$F.resultTransform.x,$x=NaN,$a=NaN,$m=NaN,$M=$R.resultMatrix.a,$J=$R.resultMatrix.c,$d=$R.resultMatrix.b,$w=$R.resultMatrix.d,$X=Math.abs($N-$c)<=1e-4;$m=$X?($a=$M*$S+$J*($x=$F.resultTransform.y)+$R.resultMatrix.tx,$d*$S+$w*$x+$R.resultMatrix.ty):($x=0,$a=$M*$S+$R.resultMatrix.tx,$d*$S+$R.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new $pR(),$tR.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($i,$j,15,"#ffff00"),this._sp.graphics.drawCircle($a,$m,15,"#ff00ff")),$R.setRotation(Math.atan2($m-$R.resultMatrix.ty,$a-$R.resultMatrix.tx));var $H=$R.parentBone;$M=$H.resultMatrix.a,$J=$H.resultMatrix.c,$d=$H.resultMatrix.b;var $_=1/($M*($w=$H.resultMatrix.d)-$J*$d),$T=$i-$H.resultMatrix.tx,$g=$j-$H.resultMatrix.ty,$B=($T*$w-$g*$J)*$_-$$,$z=($g*$M-$T*$d)*$_-$V,$L=(($T=$a-$H.resultMatrix.tx)*$w-($g=$m-$H.resultMatrix.ty)*$J)*$_-$$,$Y=($g*$M-$T*$d)*$_-$V,$f=Math.sqrt($L*$L+$Y*$Y),$Z=$F.length*$q,$u=NaN,$v=NaN;if($X){var $K=($B*$B+$z*$z-$f*$f-($Z*=$N)*$Z)/(2*$f*$Z);$K<-1?$K=-1:1<$K&&($K=1),$v=Math.acos($K)*$t,$M=$f+$Z*$K,$J=$Z*Math.sin($v),$u=Math.atan2($z*$M-$B*$J,$B*$M+$z*$J);}else{var $e=($M=$N*$Z)*$M,$Q=($J=$c*$Z)*$J,$b=$B*$B+$z*$z,$G=Math.atan2($z,$B),$O=-2*$Q*$f,$y=$Q-$e;if(0<($w=$O*$O-4*$y*($d=$Q*$f*$f+$e*$b-$e*$Q))){var $E=Math.sqrt($w);$O<0&&($E=-$E);var $l=($E=-($O+$E)/2)/$y,$W=$d/$E,$o=Math.abs($l)<Math.abs($W)?$l:$W;$o*$o<=$b&&($g=Math.sqrt($b-$o*$o)*$t,$u=$G-Math.atan2($g,$o),$v=Math.atan2($g/$c,($o-$f)/$N));}var $n=0,$C=Number.MAX_VALUE,$r=0,$A=0,$P=0,$U=0,$I=0,$D=0;$U<($w=($T=$f+$M)*$T)&&($P=0,$U=$w,$I=$T),($w=($T=$f-$M)*$T)<$C&&($n=Math.PI,$C=$w,$r=$T);var $RR=Math.acos(-$M*$f/($e-$Q));($w=($T=$M*Math.cos($RR)+$f)*$T+($g=$J*Math.sin($RR))*$g)<$C&&($n=$RR,$C=$w,$r=$T,$A=$g),$U<$w&&($P=$RR,$U=$w,$I=$T,$D=$g),$v=$b<=($C+$U)/2?($u=$G-Math.atan2($A*$t,$r),$n*$t):($u=$G-Math.atan2($D*$t,$I),$P*$t);}var $FR=Math.atan2($x,$S)*$h,$iR=$R.resultTransform.skX;180<($u=($u-$FR)*$jR.radDeg+$s-$iR)?$u-=360:$u<-180&&($u+=360),$R.resultTransform.x=$$,$R.resultTransform.y=$V,$R.resultTransform.skX=$R.resultTransform.skY=$iR+$u*$p,$iR=$F.resultTransform.skX,180<($v=(($v+$FR)*$jR.radDeg-0)*$h+$k-($iR%=360))?$v-=360:$v<-180&&($v+=360),$F.resultTransform.x=$S,$F.resultTransform.y=$x,$F.resultTransform.skX=$F.resultTransform.skY=$F.resultTransform.skY+$v*$p,$R.update();}},$R._applyIk3=function($R,$F,$i,$j,$t,$p){if(0!=$p){var $$,$V,$N=$F.resultMatrix.a*$F.length,$c=$F.resultMatrix.b*$F.length,$q=$N*$N+$c*$c,$s=Math.sqrt($q),$k=$R.resultMatrix.tx,$h=$R.resultMatrix.ty,$S=$F.resultMatrix.tx,$x=$F.resultMatrix.ty,$a=$S-$k,$m=$x-$h,$M=$a*$a+$m*$m,$J=Math.sqrt($M),$d=($a=$i-$R.resultMatrix.tx)*$a+($m=$j-$R.resultMatrix.ty)*$m,$w=Math.sqrt($d);if($s+$J<=$w||$w+$s<=$J||$w+$J<=$s){var $X=NaN;$S=$k+($X=$s+$J<=$w?1:-1)*($i-$k)*$J/$w,$x=$h+$X*($j-$h)*$J/$w;}else{var $H=($M-$q+$d)/(2*$d),$_=Math.sqrt($M-$H*$H*$d)/$w,$T=$k+$a*$H,$g=$h+$m*$H,$B=-$m*$_,$z=$a*$_;$x=0<$t?($S=$T-$B,$g-$z):($S=$T+$B,$g+$z);}$$=$S,$V=$x,this.isDebug&&(this._sp||(this._sp=new $pR(),$tR.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($k,$h,15,"#ff00ff"),this._sp.graphics.drawCircle($i,$j,15,"#ffff00"),this._sp.graphics.drawCircle($$,$V,15,"#ff00ff"));var $L,$Y;$L=Math.atan2($V-$R.resultMatrix.ty,$$-$R.resultMatrix.tx),$R.setRotation($L),($Y=$jR._tempMatrix).identity(),$Y.rotate($L),$Y.scale($R.resultMatrix.getScaleX(),$R.resultMatrix.getScaleY()),$Y.translate($R.resultMatrix.tx,$R.resultMatrix.ty),$Y.copyTo($R.resultMatrix),$R.updateChild();var $f,$Z;$f=Math.atan2($j-$V,$i-$$),$F.setRotation($f),($Z=$jR._tempMatrix).identity(),$Z.rotate($f),$Z.scale($F.resultMatrix.getScaleX(),$F.resultMatrix.getScaleY()),$Z.translate($$,$V),$Y.copyTo($F.resultMatrix),$F.updateChild();}},$i($jR,["radDeg",function(){return this.radDeg=180/Math.PI;},"degRad",function(){return this.degRad=Math.PI/180;},"_tempMatrix",function(){return this._tempMatrix=new $YR();}]),$jR;}(),$GR=function(){function $R(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[];}return $j($R,"laya.ani.bone.IkConstraintData"),$R;}(),$w=function(){function $Z($R,$F){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=$R,this.position=$R.position,this.spacing=$R.spacing,this.rotateMix=$R.rotateMix,this.translateMix=$R.translateMix,this.bones=[];for(var $i=this.data.bones,$j=0,$t=$i.length;$j<$t;$j++)this.bones.push($F[$i[$j]]);}$j($Z,"laya.ani.bone.PathConstraint");var $R=$Z.prototype;return $R.apply=function($R,$F){if(this.target){var $i=this.translateMix,$j=this.translateMix,$t=0<$j,$p=this.data.spacingMode,$$="length"==$p,$V=this.data.rotateMode,$N="tangent"==$V,$c="chainScale"==$V,$q=[],$s=this.bones.length,$k=$N?$s:$s+1,$h=[];(this._spaces=$h)[0]=this.position;var $S=this.spacing;if($c||$$)for(var $x=0,$a=$k-1;$x<$a;){var $m=this.bones[$x],$M=$m.length,$J=$M*$m.resultMatrix.a,$d=$M*$m.resultMatrix.b;$M=Math.sqrt($J*$J+$d*$d),$c&&($q[$x]=$M),$h[++$x]=$$?Math.max(0,$M+$S):$S;}else for($x=1;$x<$k;$x++)$h[$x]=$S;var $w=this.computeWorldPositions(this.target,$R,$F,$k,$N,"percent"==this.data.positionMode,"percent"==$p);if(this._debugKey){for($x=0;$x<$w.length;$x++)$F.drawCircle($w[$x++],$w[$x++],5,"#00ff00");var $X=[];for($x=0;$x<$w.length;$x++)$X.push($w[$x++],$w[$x++]);$F.drawLines(0,0,$X,"#ff0000");}var $H=$w[0],$_=$w[1],$T=this.data.offsetRotation,$g="chain"==$V&&0==$T,$B=NaN;for($x=0,$B=3;$x<$s;$x++,$B+=3){($m=this.bones[$x]).resultMatrix.tx+=($H-$m.resultMatrix.tx)*$i,$m.resultMatrix.ty+=($_-$m.resultMatrix.ty)*$i;var $z=($J=$w[$B])-$H,$L=($d=$w[$B+1])-$_;if($c&&0!=($M=$q[$x])){var $Y=(Math.sqrt($z*$z+$L*$L)/$M-1)*$j+1;$m.resultMatrix.a*=$Y,$m.resultMatrix.c*=$Y;}if($H=$J,$_=$d,$t){var $f=$m.resultMatrix.a,$Z=$m.resultMatrix.c,$u=$m.resultMatrix.b,$v=$m.resultMatrix.d,$K=NaN,$e=NaN,$Q=NaN;$K=$N?$w[$B-1]:0==$h[$x+1]?$w[$B+2]:Math.atan2($L,$z),$K-=Math.atan2($u,$f)-$T/180*Math.PI,$g&&($e=Math.cos($K),$Q=Math.sin($K),$H+=(($M=$m.length)*($e*$f-$Q*$u)-$z)*$j,$_+=($M*($Q*$f+$e*$u)-$L)*$j),$K>Math.PI?$K-=2*Math.PI:$K<-Math.PI&&($K+=2*Math.PI),$K*=$j,$e=Math.cos($K),$Q=Math.sin($K),$m.resultMatrix.a=$e*$f-$Q*$u,$m.resultMatrix.c=$e*$Z-$Q*$v,$m.resultMatrix.b=$Q*$f+$e*$u,$m.resultMatrix.d=$Q*$Z+$e*$v;}}}},$R.computeWorldVertices2=function($R,$F,$i,$j,$t,$p){var $$,$V,$N=$R.currDisplayData.bones,$c=$R.currDisplayData.weights,$q=$R.currDisplayData.triangles,$s=0,$k=0,$h=0,$S=0,$x=0,$a=0,$m=0,$M=0,$J=0,$d=0,$w=0;if(null!=$N){for($s=0;$s<$i;$s+=2)$k+=($S=$N[$k])+1,$h+=$S;var $X=$F;for($x=$p,$a=3*$h;$x<$j;$x+=2){for($M=$m=0,$S=$N[$k++],$S+=$k;$k<$S;$k++,$a+=3){$$=$X[$N[$k]].resultMatrix,$J=$c[$a],$d=$c[$a+1];var $H=$c[$a+2];$m+=($J*$$.a+$d*$$.c+$$.tx)*$H,$M+=($J*$$.b+$d*$$.d+$$.ty)*$H;}$t[$x]=$m,$t[$x+1]=$M;}}else{var $_,$T;if($q||($q=$c),$R.deformData&&($q=$R.deformData),$_=$R.parent,$F)for($w=$F.length,$s=0;$s<$w;$s++)if($F[$s].name==$_){$V=$F[$s];break;}$V&&($T=$V.resultMatrix),$T||($T=$Z._tempMt);var $g=$T.tx,$B=$T.ty,$z=$T.a,$L=$T.b,$Y=$T.c,$f=$T.d;for($V&&($f*=$V.d),$k=$i,$x=$p;$x<$j;$k+=2,$x+=2)$J=$q[$k],$d=$q[$k+1],$t[$x]=$J*$z+$d*$L+$g,$t[$x+1]=-($J*$Y+$d*$f+$B);}},$R.computeWorldPositions=function($R,$F,$i,$j,$t,$p,$$){$R.currDisplayData.bones,$R.currDisplayData.weights,$R.currDisplayData.triangles;var $V=[],$N=0,$c=$R.currDisplayData.verLen,$q=this.position,$s=this._spaces,$k=[],$h=[],$S=$c/6,$x=-1,$a=NaN,$m=0,$M=0,$J=NaN,$d=NaN,$w=NaN,$X=NaN;if($S--,$c-=4,this.computeWorldVertices2($R,$F,2,$c,$V,0),this._debugKey)for($N=0;$N<$V.length;)$i.drawCircle($V[$N++],$V[$N++],10,"#ff0000");$k=$V,this._curves.length=$S;var $H=this._curves,$_=$k[$a=0],$T=$k[1],$g=0,$B=0,$z=0,$L=0,$Y=0,$f=0,$Z=NaN,$u=NaN,$v=NaN,$K=NaN,$e=NaN,$Q=NaN,$b=NaN,$G=NaN,$O=0;for($N=0,$O=2;$N<$S;$N++,$O+=6)$g=$k[$O],$B=$k[$O+1],$z=$k[$O+2],$L=$k[$O+3],$e=2*($Z=.1875*($_-2*$g+$z))+($v=.09375*(3*($g-$z)-$_+($Y=$k[$O+4]))),$Q=2*($u=.1875*($T-2*$B+$L))+($K=.09375*(3*($B-$L)-$T+($f=$k[$O+5]))),$b=.75*($g-$_)+$Z+.16666667*$v,$G=.75*($B-$T)+$u+.16666667*$K,$a+=Math.sqrt($b*$b+$G*$G),$b+=$e,$G+=$Q,$e+=$v,$Q+=$K,$a+=Math.sqrt($b*$b+$G*$G),$b+=$e,$G+=$Q,$a+=Math.sqrt($b*$b+$G*$G),$b+=$e+$v,$G+=$Q+$K,$a+=Math.sqrt($b*$b+$G*$G),$H[$N]=$a,$_=$Y,$T=$f;if($p&&($q*=$a),$$)for($N=0;$N<$j;$N++)$s[$N]*=$a;var $y=this._segments,$E=0,$l=0;for($l=$M=$m=$N=0;$N<$j;$N++,$m+=3)if(($J=$q+=$d=$s[$N])<0)this.addBeforePosition($J,$k,0,$h,$m);else if($a<$J)this.addAfterPosition($J-$a,$k,$c-4,$h,$m);else{for(;;$M++)if(!(($X=$H[$M])<$J)){0==$M?$J/=$X:$J=($J-($w=$H[$M-1]))/($X-$w);break;}if($M!=$x){var $W=6*($x=$M);for($_=$k[$W],$T=$k[$W+1],$g=$k[$W+2],$B=$k[$W+3],$z=$k[$W+4],$L=$k[$W+5],$e=2*($Z=.03*($_-2*$g+$z))+($v=.006*(3*($g-$z)-$_+($Y=$k[$W+6]))),$Q=2*($u=.03*($T-2*$B+$L))+($K=.006*(3*($B-$L)-$T+($f=$k[$W+7]))),$b=.3*($g-$_)+$Z+.16666667*$v,$G=.3*($B-$T)+$u+.16666667*$K,$E=Math.sqrt($b*$b+$G*$G),$y[0]=$E,$W=1;$W<8;$W++)$b+=$e,$G+=$Q,$e+=$v,$Q+=$K,$E+=Math.sqrt($b*$b+$G*$G),$y[$W]=$E;$b+=$e,$G+=$Q,$E+=Math.sqrt($b*$b+$G*$G),$y[8]=$E,$b+=$e+$v,$G+=$Q+$K,$E+=Math.sqrt($b*$b+$G*$G),$y[9]=$E,$l=0;}for($J*=$E;;$l++)if(!(($X=$y[$l])<$J)){0==$l?$J/=$X:$J=$l+($J-($w=$y[$l-1]))/($X-$w);break;}this.addCurvePosition(.1*$J,$_,$T,$g,$B,$z,$L,$Y,$f,$h,$m,$t||0<$N&&0==$d);}return $h;},$R.addBeforePosition=function($R,$F,$i,$j,$t){var $p=$F[$i],$$=$F[$i+1],$V=$F[$i+2]-$p,$N=$F[$i+3]-$$,$c=Math.atan2($N,$V);$j[$t]=$p+$R*Math.cos($c),$j[$t+1]=$$+$R*Math.sin($c),$j[$t+2]=$c;},$R.addAfterPosition=function($R,$F,$i,$j,$t){var $p=$F[$i+2],$$=$F[$i+3],$V=$p-$F[$i],$N=$$-$F[$i+1],$c=Math.atan2($N,$V);$j[$t]=$p+$R*Math.cos($c),$j[$t+1]=$$+$R*Math.sin($c),$j[$t+2]=$c;},$R.addCurvePosition=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q,$s){0==$R&&($R=1e-4);var $k=$R*$R,$h=$k*$R,$S=1-$R,$x=$S*$S,$a=$x*$S,$m=$S*$R,$M=3*$m,$J=$S*$M,$d=$M*$R,$w=$F*$a+$j*$J+$p*$d+$V*$h,$X=$i*$a+$t*$J+$$*$d+$N*$h;$c[$q]=$w,$c[$q+1]=$X,$c[$q+2]=$s?Math.atan2($X-($i*$x+$t*$m*2+$$*$k),$w-($F*$x+$j*$m*2+$p*$k)):0;},$Z.NONE=-1,$Z.BEFORE=-2,$Z.AFTER=-3,$i($Z,["_tempMt",function(){return this._tempMt=new $YR();}]),$Z;}(),$OR=function(){function $R(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[];}return $j($R,"laya.ani.bone.PathConstraintData"),$R;}(),$yR=function(){function $R(){this.name=null,this.slotArr=[];}return $j($R,"laya.ani.bone.SkinData"),$R;}(),$ER=function(){function $R(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0;}$j($R,"laya.ani.bone.SkinSlotDisplayData");var $F=$R.prototype;return $F.createTexture=function($R){return this.texture||(this.texture=new $fR($R.bitmap,this.uvs),$R.bitmap.alphaTexture&&(this.texture.alphaTexture=new $fR($R.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=$R.height,this.texture.height=$R.width,this.texture.offsetX=-$R.offsetX,this.texture.offsetY=-$R.offsetY,this.texture.sourceWidth=$R.sourceHeight,this.texture.sourceHeight=$R.sourceWidth):(this.texture.width=$R.width,this.texture.height=$R.height,this.texture.offsetX=-$R.offsetX,this.texture.offsetY=-$R.offsetY,this.texture.sourceWidth=$R.sourceWidth,this.texture.sourceHeight=$R.sourceHeight),$a.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture;},$F.destory=function(){this.texture&&this.texture.destroy();},$R;}(),$lR=function(){function $R(){this.name=null,this.displayArr=[];}return $j($R,"laya.ani.bone.SlotData"),$R.prototype.getDisplayByName=function($R){for(var $F=0,$i=this.displayArr.length;$F<$i;$F++)if(this.displayArr[$F].attachmentName==$R)return $F;return-1;},$R;}(),$X=function(){function $R($R,$F){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=$x(2,0),this._data=$R,null==this._bones&&(this._bones=[]),this.target=$F[$R.targetIndex];var $i,$j=0;for($j=0,$i=$R.boneIndexs.length;$j<$i;$j++)this._bones.push($F[$R.boneIndexs[$j]]);this.rotateMix=$R.rotateMix,this.translateMix=$R.translateMix,this.scaleMix=$R.scaleMix,this.shearMix=$R.shearMix;}return $j($R,"laya.ani.bone.TfConstraint"),$R.prototype.apply=function(){for(var $R,$F=this.target.resultMatrix.a,$i=this.target.resultMatrix.b,$j=this.target.resultMatrix.c,$t=this.target.resultMatrix.d,$p=0,$$=this._bones.length;$p<$$;$p++){if($R=this._bones[$p],0<this.rotateMix){var $V=$R.resultMatrix.a,$N=$R.resultMatrix.b,$c=$R.resultMatrix.c,$q=$R.resultMatrix.d,$s=Math.atan2($j,$F)-Math.atan2($c,$V)+this._data.offsetRotation*Math.PI/180;$s>Math.PI?$s-=2*Math.PI:$s<-Math.PI&&($s+=2*Math.PI),$s*=this.rotateMix;var $k=Math.cos($s),$h=Math.sin($s);$R.resultMatrix.a=$k*$V-$h*$c,$R.resultMatrix.b=$k*$N-$h*$q,$R.resultMatrix.c=$h*$V+$k*$c,$R.resultMatrix.d=$h*$N+$k*$q;}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),$R.resultMatrix.tx+=(this._temp[0]-$R.resultMatrix.tx)*this.translateMix,$R.resultMatrix.ty+=(this._temp[1]-$R.resultMatrix.ty)*this.translateMix,$R.updateChild()),0<this.scaleMix){var $S=Math.sqrt($R.resultMatrix.a*$R.resultMatrix.a+$R.resultMatrix.c*$R.resultMatrix.c),$x=Math.sqrt($F*$F+$j*$j),$a=1e-5<$S?($S+($x-$S+this._data.offsetScaleX)*this.scaleMix)/$S:0;$R.resultMatrix.a*=$a,$R.resultMatrix.c*=$a,$S=Math.sqrt($R.resultMatrix.b*$R.resultMatrix.b+$R.resultMatrix.d*$R.resultMatrix.d),$x=Math.sqrt($i*$i+$t*$t),$a=1e-5<$S?($S+($x-$S+this._data.offsetScaleY)*this.scaleMix)/$S:0,$R.resultMatrix.b*=$a,$R.resultMatrix.d*=$a;}if(0<this.shearMix){$N=$R.resultMatrix.b,$q=$R.resultMatrix.d;var $m=Math.atan2($q,$N);($s=Math.atan2($t,$i)-Math.atan2($j,$F)-($m-Math.atan2($R.resultMatrix.c,$R.resultMatrix.a)))>Math.PI?$s-=2*Math.PI:$s<-Math.PI&&($s+=2*Math.PI),$s=$m+($s+this._data.offsetShearY*Math.PI/180)*this.shearMix,$a=Math.sqrt($N*$N+$q*$q),$R.resultMatrix.b=Math.cos($s)*$a,$R.resultMatrix.d=Math.sin($s)*$a;}}},$R;}(),$WR=function(){function $R(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[];}return $j($R,"laya.ani.bone.TfConstraintData"),$R;}(),$oR=function(){function $R(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null;}$j($R,"laya.ani.bone.Transform");var $F=$R.prototype;return $F.initData=function($R){null!=$R.x&&(this.x=$R.x),null!=$R.y&&(this.y=$R.y),null!=$R.skX&&(this.skX=$R.skX),null!=$R.skY&&(this.skY=$R.skY),null!=$R.scX&&(this.scX=$R.scX),null!=$R.scY&&(this.scY=$R.scY);},$F.getMatrix=function(){var $R;return($R=this.mMatrix?this.mMatrix:this.mMatrix=new $YR()).identity(),$R.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew($R,this.skewX*Math.PI/180,this.skewY*Math.PI/180),$R.rotate(this.skX*Math.PI/180),$R.translate(this.x,this.y),$R;},$F.skew=function($R,$F,$i){var $j=Math.sin($i),$t=Math.cos($i),$p=Math.sin($F),$$=Math.cos($F);return $R.setTo($R.a*$$-$R.b*$j,$R.a*$p+$R.b*$t,$R.c*$$-$R.d*$j,$R.c*$p+$R.d*$t,$R.tx*$$-$R.ty*$j,$R.tx*$p+$R.ty*$t),$R;},$R;}(),$H=function(){function $R(){}return $j($R,"laya.ani.bone.UVTools"),$R.getRelativeUV=function($R,$F,$i){var $j=$R[0],$t=$R[2]-$R[0],$p=$R[1],$$=$R[5]-$R[1];$i||($i=[]),$i.length=$F.length;var $V,$N=0;$V=$i.length;var $c=1/$t,$q=1/$$;for($N=0;$N<$V;$N+=2)$i[$N]=($F[$N]-$j)*$c,$i[$N+1]=($F[$N+1]-$p)*$q;return $i;},$R.getAbsoluteUV=function($R,$F,$i){if(0==$R[0]&&0==$R[1]&&1==$R[4]&&1==$R[5])return $i?($m.copyArray($i,$F),$i):$F;var $j=$R[0],$t=$R[2]-$R[0],$p=$R[1],$$=$R[5]-$R[1];$i||($i=[]),$i.length=$F.length;var $V,$N=0;for($V=$i.length,$N=0;$N<$V;$N+=2)$i[$N]=$F[$N]*$t+$j,$i[$N+1]=$F[$N+1]*$$+$p;return $i;},$R;}(),$Z=function(){function $R(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null;}return $j($R,"laya.ani.KeyFramesContent"),$R;}(),$_=function(){function $q(){}return $j($q,"laya.ani.math.BezierLerp"),$q.getBezierRate=function($R,$F,$i,$j,$t){var $p=$q._getBezierParamKey($F,$i,$j,$t),$$=100*$p+$R;if($q._bezierResultCache[$$])return $q._bezierResultCache[$$];var $V,$N=$q._getBezierPoints($F,$i,$j,$t,$p),$c=0;for($V=$N.length,$c=0;$c<$V;$c+=2)if($R<=$N[$c])return $q._bezierResultCache[$$]=$N[$c+1],$N[$c+1];return $q._bezierResultCache[$$]=1;},$q._getBezierParamKey=function($R,$F,$i,$j){return 100*(100*(100*(100*$R+$F)+$i)+$j);},$q._getBezierPoints=function($R,$F,$i,$j,$t){return $q._bezierPointsCache[$t]?$q._bezierPointsCache[$t]:($p=[0,0,$R,$F,$i,$j,1,1],$$=new $V().getBezierPoints($p,100,3),$q._bezierPointsCache[$t]=$$);var $p,$$;},$q._bezierResultCache={},$q._bezierPointsCache={},$q;}(),$T=function($R){function $F(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,$F.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1;}$j($F,"laya.ani.AnimationPlayer",$t);var $i=$F.prototype;return $tR.imps($i,{"laya.resource.IDestroy":!0}),$i._onTempletLoadedComputeFullKeyframeIndices=function($R,$F,$i){this._templet===$i&&this._cachePlayRate===$R&&this._cacheFrameRate===$F&&this._computeFullKeyframeIndices();},$i._computeFullKeyframeIndices=function(){for(var $R=this._fullFrames=[],$F=this._templet,$i=this._cacheFrameRateInterval*this._cachePlayRate,$j=0,$t=$F.getAnimationCount();$j<$t;$j++){for(var $p=[],$$=0,$V=$F.getAnimation($j).nodes.length;$$<$V;$$++){for(var $N=$F.getAnimation($j).nodes[$$],$c=Math.floor($N.playTime/$i+.01),$q=new Uint16Array($c+1),$s=-1,$k=0,$h=$N.keyFrame.length;$k<$h;$k++){var $S=$N.keyFrame[$k],$x=$S.startTime,$a=$x+$S.duration+$i;do{for(var $m=Math.floor($x/$i+.5),$M=$s+1;$M<$m;$M++)$q[$M]=$k;$q[$s=$m]=$k,$x+=$i;}while($x<=$a);}$p.push($q);}$R.push($p);}},$i._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration();},$i._calculatePlayDuration=function(){if(0!==this.state){var $R=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=$R),this._playEnd>$R&&(this._playEnd=$R),this._playDuration=this._playEnd-this._playStart;}},$i._setPlayParams=function($R,$F){this._currentTime=$R,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$F+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$F;},$i._setPlayParamsWhenStop=function($R,$F){this._currentTime=$R,this._currentKeyframeIndex=Math.max(Math.floor($R/$F+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$F,this._currentAnimationClipIndex=-1;},$i._update=function($R){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var $F=this._cacheFrameRateInterval*this._cachePlayRate,$i=0;this._startUpdateLoopCount!==$S.loopCount&&($i=$R*this.playbackRate,this._elapsedPlaybackTime+=$i);var $j=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=$j)return this._setPlayParamsWhenStop($j,$F),void this.event("stopped");if($i+=this._currentTime,0<$j){if($j<=$i)do{if($i-=$j,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($j,$F),this._stopWhenCircleFinish=!1,void this.event("stopped");$i<$j&&(this._setPlayParams($i,$F),this.event("complete"));}while($j<=$i);else this._setPlayParams($i,$F);}else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($j,$F),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete");}}},$i._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0;},$i.play=function($R,$F,$i,$j,$t){if(void 0===$R&&($R=0),void 0===$F&&($F=1),void 0===$i&&($i=2147483647),void 0===$j&&($j=0),void 0===$t&&($t=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if($i<0||$j<0||$t<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==$t&&$t<$j)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=$F,this._overallDuration=$i,this._playStart=$j,this._playEnd=$t,this._paused=!1,this._currentAnimationClipIndex=$R,this._currentKeyframeIndex=0,this._startUpdateLoopCount=$S.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0);},$i.playByFrame=function($R,$F,$i,$j,$t,$p){void 0===$R&&($R=0),void 0===$F&&($F=1),void 0===$i&&($i=2147483647),void 0===$j&&($j=0),void 0===$t&&($t=0),void 0===$p&&($p=30);var $$=1e3/$p;this.play($R,$F,$i,$j*$$,$t*$$);},$i.stop=function($R){void 0===$R&&($R=!0),$R?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0;},$p(0,$i,"playEnd",function(){return this._playEnd;}),$p(0,$i,"templet",function(){return this._templet;},function($R){0===!this.state&&this.stop(!0),this._templet!==$R&&((this._templet=$R).loaded?this._computeFullKeyframeIndices():$R.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]));}),$p(0,$i,"playStart",function(){return this._playStart;}),$p(0,$i,"playDuration",function(){return this._playDuration;}),$p(0,$i,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2;}),$p(0,$i,"currentKeyframeIndex",function(){return this._currentKeyframeIndex;}),$p(0,$i,"overallDuration",function(){return this._overallDuration;}),$p(0,$i,"currentFrameTime",function(){return this._currentFrameTime;}),$p(0,$i,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex;}),$p(0,$i,"currentPlayTime",function(){return this._currentTime+this._playStart;}),$p(0,$i,"cachePlayRate",function(){return this._cachePlayRate;},function($R){this._cachePlayRate!==$R&&(this._cachePlayRate=$R,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[$R,this._cacheFrameRate])));}),$p(0,$i,"cacheFrameRate",function(){return this._cacheFrameRate;},function($R){this._cacheFrameRate!==$R&&(this._cacheFrameRate=$R,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,$R])));}),$p(0,$i,"currentTime",null,function($R){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if($R<this._playStart||$R>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=$S.loopCount;var $F=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=$R,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$F),0),this._currentFrameTime=this._currentKeyframeIndex*$F;}}),$p(0,$i,"paused",function(){return this._paused;},function($R){(this._paused=$R)&&this.event("paused");}),$p(0,$i,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval;}),$p(0,$i,"destroyed",function(){return this._destroyed;}),$F;}(),$u=function($R){function $F(){$F.__super.call(this),$a.isConchNode&&(this.drawSkin=function($R){$R.transform||($R.transform=$YR.EMPTY),this._addCmd([$R]),this.setSkinMesh&&this.setSkinMesh($R._ps,$R.mVBData,$R.mEleNum,0,$R.mTexture,$R.transform);});}return $j($F,"laya.ani.GraphicsAni",$$),$F.prototype.drawSkin=function($R){var $F=[$R];this._saveToCmd($a._context._drawSkin,$F);},$F.create=function(){return $F._caches.pop()||new $F();},$F.recycle=function($R){$R.clear(),$F._caches.push($R);},$F._caches=[],$F;}(),$v=function($R){function $M(){this._aniMap={},this.unfixedLastAniIndex=-1,$M.__super.call(this),this._anis=new Array();}$j($M,"laya.ani.AnimationTemplet",$q);var $F=$M.prototype;return $F.parse=function($R){var $F=new $LR($R);this._aniVersion=$F.readUTFString(),$J.parse(this,$F);},$F._calculateKeyFrame=function($R,$F,$i){var $j=$R.keyFrame;$j[$F]=$j[0];for(var $t=0;$t<$F;$t++){var $p=$j[$t];$p.nextData=0===$p.duration?$p.data:$j[$t+1].data;}$j.length--;},$F.onAsynLoaded=function($R,$F,$i){var $j=new $LR($F);switch(this._aniVersion=$j.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":$d.parse(this,$j);break;default:$J.parse(this,$j);}this._endLoaded();},$F.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null;},$F.getAnimationCount=function(){return this._anis.length;},$F.getAnimation=function($R){return this._anis[$R];},$F.getAniDuration=function($R){return this._anis[$R].playTime;},$F.getNodes=function($R){return this._anis[$R].nodes;},$F.getNodeIndexWithName=function($R,$F){return this._anis[$R].bone3DMap[$F];},$F.getNodeCount=function($R){return this._anis[$R].nodes.length;},$F.getTotalkeyframesLength=function($R){return this._anis[$R].totalKeyframeDatasLength;},$F.getPublicExtData=function(){return this._publicExtData;},$F.getAnimationDataWithCache=function($R,$F,$i,$j){var $t=$F[$i];if($t){var $p=$t[$R];return $p?$p[$j]:null;}return null;},$F.setAnimationDataWithCache=function($R,$F,$i,$j,$t){var $p=$F[$i]||($F[$i]={});($p[$R]||($p[$R]=[]))[$j]=$t;},$F.getOriginalData=function($R,$F,$i,$j,$t){for(var $p=this._anis[$R].nodes,$$=0,$V=0,$N=$p.length,$c=0;$V<$N;$V++){var $q,$s=$p[$V];$q=$s.keyFrame[$i[$V][$j]],$s.dataOffset=$c;var $k=$t-$q.startTime,$h=$s.lerpType;if($h)switch($h){case 0:case 1:for($$=0;$$<$s.keyframeWidth;)$$+=$s.interpolationMethod[$$]($s,$$,$F,$c+$$,$q.data,$k,null,$q.duration,$q.nextData);break;case 2:var $S=$q.interpolationData,$x=$S.length,$a=0;for($$=0;$$<$x;){var $m=$S[$$];switch($m){case 6:case 7:$$+=$M.interpolation[$m]($s,$a,$F,$c+$a,$q.data,$k,null,$q.duration,$q.nextData,$S,$$+1);break;default:$$+=$M.interpolation[$m]($s,$a,$F,$c+$a,$q.data,$k,null,$q.duration,$q.nextData);}$a++;}}else for($$=0;$$<$s.keyframeWidth;)$$+=$s.interpolationMethod[$$]($s,$$,$F,$c+$$,$q.data,$k,null,$q.duration,$q.nextData);$c+=$s.keyframeWidth;}},$F.getNodesCurrentFrameIndex=function($R,$F){var $i=this._anis[$R].nodes;$R!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($i.length),this.unfixedCurrentTimes=new Float32Array($i.length),this.unfixedLastAniIndex=$R);for(var $j=0,$t=$i.length;$j<$t;$j++){var $p=$i[$j];for($F<this.unfixedCurrentTimes[$j]&&(this.unfixedCurrentFrameIndexes[$j]=0),this.unfixedCurrentTimes[$j]=$F;this.unfixedCurrentFrameIndexes[$j]<$p.keyFrame.length&&!($p.keyFrame[this.unfixedCurrentFrameIndexes[$j]].startTime>this.unfixedCurrentTimes[$j]);)this.unfixedCurrentFrameIndexes[$j]++;this.unfixedCurrentFrameIndexes[$j]--;}return this.unfixedCurrentFrameIndexes;},$F.getOriginalDataUnfixedRate=function($R,$F,$i){var $j=this._anis[$R].nodes;$R!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($j.length),this.unfixedCurrentTimes=new Float32Array($j.length),this.unfixedKeyframes=$x($j.length),this.unfixedLastAniIndex=$R);for(var $t=0,$p=0,$$=$j.length,$V=0;$p<$$;$p++){var $N=$j[$p];for($i<this.unfixedCurrentTimes[$p]&&(this.unfixedCurrentFrameIndexes[$p]=0),this.unfixedCurrentTimes[$p]=$i;this.unfixedCurrentFrameIndexes[$p]<$N.keyFrame.length&&!($N.keyFrame[this.unfixedCurrentFrameIndexes[$p]].startTime>this.unfixedCurrentTimes[$p]);)this.unfixedKeyframes[$p]=$N.keyFrame[this.unfixedCurrentFrameIndexes[$p]],this.unfixedCurrentFrameIndexes[$p]++;var $c=this.unfixedKeyframes[$p];$N.dataOffset=$V;var $q=$i-$c.startTime;if($N.lerpType)switch($N.lerpType){case 0:case 1:for($t=0;$t<$N.keyframeWidth;)$t+=$N.interpolationMethod[$t]($N,$t,$F,$V+$t,$c.data,$q,null,$c.duration,$c.nextData);break;case 2:var $s=$c.interpolationData,$k=$s.length,$h=0;for($t=0;$t<$k;){var $S=$s[$t];switch($S){case 6:case 7:$t+=$M.interpolation[$S]($N,$h,$F,$V+$h,$c.data,$q,null,$c.duration,$c.nextData,$s,$t+1);break;default:$t+=$M.interpolation[$S]($N,$h,$F,$V+$h,$c.data,$q,null,$c.duration,$c.nextData);}$h++;}}else for($t=0;$t<$N.keyframeWidth;)$t+=$N.interpolationMethod[$t]($N,$t,$F,$V+$t,$c.data,$q,null,$c.duration,$c.nextData);$V+=$N.keyframeWidth;}},$M._LinearInterpolation_0=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){var $q=0===$V?0:$p/$V;return $i[$j]=(1-$q)*$t[$F]+$q*$N[$F],1;},$M._QuaternionInterpolation_1=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){var $q=0===$V?0:$p/$V;return $k.slerpQuaternionArray($t,$F,$N,$F,$q,$i,$j),4;},$M._AngleInterpolation_2=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){return 0;},$M._RadiansInterpolation_3=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){return 0;},$M._Matrix4x4Interpolation_4=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){for(var $q=0;$q<16;$q++,$F++)$i[$j+$q]=$t[$F]+$p*$$[$F];return 16;},$M._NoInterpolation_5=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c){return $i[$j]=$t[$F],1;},$M._BezierInterpolation_6=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q){return void 0===$q&&($q=0),$i[$j]=$t[$F]+($N[$F]-$t[$F])*$_.getBezierRate($p/$V,$c[$q],$c[$q+1],$c[$q+2],$c[$q+3]),5;},$M._BezierInterpolation_7=function($R,$F,$i,$j,$t,$p,$$,$V,$N,$c,$q){return void 0===$q&&($q=0),$i[$j]=$c[$q+4]+$c[$q+5]*$_.getBezierRate((.001*$p+$c[$q+6])/$c[$q+7],$c[$q],$c[$q+1],$c[$q+2],$c[$q+3]),9;},$M.load=function($R){return $tR.loader.create($R,null,null,$M);},$M.interpolation=[$M._LinearInterpolation_0,$M._QuaternionInterpolation_1,$M._AngleInterpolation_2,$M._RadiansInterpolation_3,$M._Matrix4x4Interpolation_4,$M._NoInterpolation_5,$M._BezierInterpolation_6,$M._BezierInterpolation_7],$M;}(),$g=function($F){function $i($R,$F){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,$i.__super.call(this),void 0===$F&&($F=0),$R&&this.init($R,$F);}$j($i,"laya.ani.bone.Skeleton",$F);var $R=$i.prototype;return $R.init=function($R,$F){void 0===$F&&($F=0);var $i,$j,$t,$p=0,$$=0;if(1==$F)for(this._graphicsCache=[],$p=0,$$=$R.getAnimationCount();$p<$$;$p++)this._graphicsCache.push([]);if(this._yReverseMatrix=$R.yReverseMatrix,this._aniMode=$F,this._templet=$R,this._player=new $T(),this._player.cacheFrameRate=$R.rate,this._player.templet=$R,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=$R.mBoneArr,this._rootBone=$R.mRootBone,this._aniSectionDic=$R.aniSectionDic,0<$R.ikArr.length)for(this._ikArr=[],$p=0,$$=$R.ikArr.length;$p<$$;$p++)this._ikArr.push(new $M($R.ikArr[$p],this._boneList));if(0<$R.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),$p=0,$$=$R.pathArr.length;$p<$$;$p++)$i=$R.pathArr[$p],$j=new $w($i,this._boneList),($t=this._boneSlotDic[$i.name])&&(($j=new $w($i,this._boneList)).target=$t),this._pathDic[$i.name]=$j;if(0<$R.tfArr.length)for(this._tfArr=[],$p=0,$$=$R.tfArr.length;$p<$$;$p++)this._tfArr.push(new $X($R.tfArr[$p],this._boneList));if(0<$R.skinDataArray.length){var $V=this._templet.skinDataArray[this._skinIndex];this._skinName=$V.name;}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause);},$R.load=function($R,$F,$i){},$R._onLoaded=function(){},$R._parseComplete=function(){var $R=$B.TEMPLET_DICTIONARY[this._aniPath];$R&&(this.init($R,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this);},$R._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败");},$R._onPlay=function(){this.event("played");},$R._onStop=function(){var $R,$F=this._templet.eventAniArr[this._aniClipIndex];if($F&&this._eventIndex<$F.length)for(;this._eventIndex<$F.length;this._eventIndex++)($R=$F[this._eventIndex]).time>=this._player.playStart&&$R.time<=this._player.playEnd&&this.event("label",$R);this._eventIndex=0,this._drawOrder=null,this.event("stopped");},$R._onPause=function(){this.event("paused");},$R._parseSrcBoneMatrix=function(){var $R=0,$F=0;for($F=this._templet.srcBoneMatrixArr.length,$R=0;$R<$F;$R++)this._boneMatrixArray.push(new $YR());if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var $i,$j,$t=this._templet.boneSlotArray;for($R=0,$F=$t.length;$R<$F;$R++)$i=$t[$R],null==($j=this._bindBoneBoneSlotDic[$i.parent])&&(this._bindBoneBoneSlotDic[$i.parent]=$j=[]),this._boneSlotDic[$i.name]=$i=$i.copy(),$j.push($i),this._boneSlotArray.push($i);}},$R._emitMissedEvents=function($R,$F,$i){void 0===$i&&($i=0);var $j=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if($j){var $t,$p,$$=0;for($t=$j.length,$$=$i;$$<$t;$$++)($p=$j[$$]).time>=this._player.playStart&&$p.time<=this._player.playEnd&&this.event("label",$p);}},$R._update=function($R){if(void 0===$R&&($R=!0),!(this._pause||$R&&this._indexControl)){var $F=this.timer.currTimer,$i=this._player.currentKeyframeIndex,$j=$F-this._lastTime;if($R?this._player._update($j):$i=-1,this._lastTime=$F,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<$j&&this._clipIndex==$i&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var $t;this._lastUpdateAniClipIndex=this._aniClipIndex,$i>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var $p,$$=this._templet.eventAniArr[this._aniClipIndex];if($$&&this._eventIndex<$$.length&&(($t=$$[this._eventIndex]).time>=this._player.playStart&&$t.time<=this._player.playEnd?this._player.currentPlayTime>=$t.time&&(this.event("label",$t),this._eventIndex++):this._eventIndex++),0==this._aniMode){if($p=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$p&&(this.graphics=$p));var $V=0,$N=0;for($N=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,$N-1)&&0<$N;)$N--;if($N<this._clipIndex)for($V=$N;$V<this._clipIndex;$V++)this._createGraphics($V);}else if(1==this._aniMode){if($p=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$p&&(this.graphics=$p));for($N=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,$N-1)&&0<$N;)$N--;if($N<this._clipIndex)for($V=$N;$V<this._clipIndex;$V++)this._createGraphics($V);}this._createGraphics();}}},$R._createGraphics=function($R){void 0===$R&&($R=-1),-1==$R&&($R=this._clipIndex);var $F,$i,$j=$R*this._player.cacheFrameRateInterval,$t=this._templet.drawOrderAniArr[this._aniClipIndex];if($t&&0<$t.length)for(this._drawOrderIndex=0,$F=$t[this._drawOrderIndex];$j>=$F.time&&(this._drawOrder=$F.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=$t.length));)$F=$t[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=$u.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=$u.create(),$i=this.graphics;var $p=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],$R,$j);var $$,$V,$N,$c,$q=this._aniSectionDic[this._aniClipIndex],$s=0,$k=0,$h=0,$S=0,$x=0,$a=this._templet.srcBoneMatrixArr.length;for($x=$q[$k=0];$k<$a;$k++)$c=this._boneList[$k],$N=this._templet.srcBoneMatrixArr[$k],$c.resultTransform.scX=$N.scX*this._curOriginalData[$s++],$c.resultTransform.skX=$N.skX+this._curOriginalData[$s++],$c.resultTransform.skY=$N.skY+this._curOriginalData[$s++],$c.resultTransform.scY=$N.scY*this._curOriginalData[$s++],$c.resultTransform.x=$N.x+this._curOriginalData[$s++],$c.resultTransform.y=$N.y+this._curOriginalData[$s++],8===this._templet.tMatrixDataLen&&($c.resultTransform.skewX=$N.skewX+this._curOriginalData[$s++],$c.resultTransform.skewY=$N.skewY+this._curOriginalData[$s++]);var $m,$M={},$J={};for($x+=$q[1];$k<$x;$k++)$M[($m=$p[$k]).name]=this._curOriginalData[$s++],$J[$m.name]=this._curOriginalData[$s++],this._curOriginalData[$s++],this._curOriginalData[$s++],this._curOriginalData[$s++],this._curOriginalData[$s++];var $d,$w,$X={},$H={};for($x+=$q[2];$k<$x;$k++)$X[($m=$p[$k]).name]=this._curOriginalData[$s++],$H[$m.name]=this._curOriginalData[$s++],this._curOriginalData[$s++],this._curOriginalData[$s++],this._curOriginalData[$s++],this._curOriginalData[$s++];if(this._pathDic)for($x+=$q[3];$k<$x;$k++){if($m=$p[$k],$d=this._pathDic[$m.name])switch(new $LR($m.extenData).getByte()){case 1:$d.position=this._curOriginalData[$s++];break;case 2:$d.spacing=this._curOriginalData[$s++];break;case 3:$d.rotateMix=this._curOriginalData[$s++],$d.translateMix=this._curOriginalData[$s++];}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update($YR.TEMP.identity()),this._ikArr)for($k=0,$x=this._ikArr.length;$k<$x;$k++)$w=this._ikArr[$k],$X.hasOwnProperty($w.name)&&($w.bendDirection=$X[$w.name]),$H.hasOwnProperty($w.name)&&($w.mix=$H[$w.name]),$w.apply();if(this._pathDic)for(var $_ in this._pathDic)($d=this._pathDic[$_]).apply(this._boneList,$i);if(this._tfArr)for($k=0,$S=this._tfArr.length;$k<$S;$k++)this._tfArr[$k].apply();for($k=0,$S=this._boneList.length;$k<$S;$k++)if($c=this._boneList[$k],$V=this._bindBoneBoneSlotDic[$c.name],$c.resultMatrix.copyTo(this._boneMatrixArray[$k]),$V)for($h=0,$x=$V.length;$h<$x;$h++)($$=$V[$h])&&$$.setParentMatrix($c.resultMatrix);var $T,$g,$B,$z,$L={},$Y=this._templet.deformAniArr;if($Y&&0<$Y.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,$k=0,$x=this._boneSlotArray.length;$k<$x;$k++)($$=this._boneSlotArray[$k]).deformData=null;var $f,$Z=$Y[this._aniClipIndex];for($f in $T=$Z.default,this._setDeform($T,$L,this._boneSlotArray,$j),$Z)"default"!=$f&&$f!=this._skinName&&($T=$Z[$f],this._setDeform($T,$L,this._boneSlotArray,$j));$T=$Z[this._skinName],this._setDeform($T,$L,this._boneSlotArray,$j);}if(this._drawOrder)for($k=0,$x=this._drawOrder.length;$k<$x;$k++)$g=$M[($$=this._boneSlotArray[this._drawOrder[$k]]).name],$B=$J[$$.name],isNaN($B)||($i.save(),$i.alpha($B)),isNaN($g)||-2==$g||(this._templet.attachmentNames?$$.showDisplayByName(this._templet.attachmentNames[$g]):$$.showDisplayByIndex($g)),$L[this._drawOrder[$k]]?($z=$L[this._drawOrder[$k]],$$.currDisplayData&&$z[$$.currDisplayData.attachmentName]?$$.deformData=$z[$$.currDisplayData.attachmentName]:$$.deformData=null):$$.deformData=null,isNaN($B)?$$.draw($i,this._boneMatrixArray,2==this._aniMode):$$.draw($i,this._boneMatrixArray,2==this._aniMode,$B),isNaN($B)||$i.restore();else for($k=0,$x=this._boneSlotArray.length;$k<$x;$k++)$g=$M[($$=this._boneSlotArray[$k]).name],$B=$J[$$.name],isNaN($B)||($i.save(),$i.alpha($B)),isNaN($g)||-2==$g||(this._templet.attachmentNames?$$.showDisplayByName(this._templet.attachmentNames[$g]):$$.showDisplayByIndex($g)),$L[$k]?($z=$L[$k],$$.currDisplayData&&$z[$$.currDisplayData.attachmentName]?$$.deformData=$z[$$.currDisplayData.attachmentName]:$$.deformData=null):$$.deformData=null,isNaN($B)?$$.draw($i,this._boneMatrixArray,2==this._aniMode):$$.draw($i,this._boneMatrixArray,2==this._aniMode,$B),isNaN($B)||$i.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,$R,$i):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,$R,$i);},$R._setDeform=function($R,$F,$i,$j){if($R){var $t,$p,$$,$V=0,$N=0,$c=0;if($R)for($V=0,$N=$R.deformSlotDataList.length;$V<$N;$V++)for($t=$R.deformSlotDataList[$V],$c=0;$c<$t.deformSlotDisplayList.length;$c++)$$=$i[($p=$t.deformSlotDisplayList[$c]).slotIndex],$p.apply($j,$$),$F[$p.slotIndex]||($F[$p.slotIndex]={}),$F[$p.slotIndex][$p.attachment]=$p.deformData;}},$R.getAnimNum=function(){return this._templet.getAnimationCount();},$R.getAniNameByIndex=function($R){return this._templet.getAniNameByIndex($R);},$R.getSlotByName=function($R){return this._boneSlotDic[$R];},$R.showSkinByName=function($R,$F){void 0===$F&&($F=!0),this.showSkinByIndex(this._templet.getSkinIndexByName($R),$F);},$R.showSkinByIndex=function($R,$F){void 0===$F&&($F=!0);for(var $i=0;$i<this._boneSlotArray.length;$i++)this._boneSlotArray[$i].showSlotData(null,$F);if(this._templet.showSkinByIndex(this._boneSlotDic,$R,$F)){var $j=this._templet.skinDataArray[$R];this._skinIndex=$R,this._skinName=$j.name;}this._clearCache();},$R.showSlotSkinByIndex=function($R,$F){if(0!=this._aniMode){var $i=this.getSlotByName($R);$i&&$i.showDisplayByIndex($F),this._clearCache();}},$R.showSlotSkinByName=function($R,$F){if(0!=this._aniMode){var $i=this.getSlotByName($R);$i&&$i.showDisplayByName($F),this._clearCache();}},$R.replaceSlotSkinName=function($R,$F,$i){if(0!=this._aniMode){var $j=this.getSlotByName($R);$j&&$j.replaceDisplayByName($F,$i),this._clearCache();}},$R.replaceSlotSkinByIndex=function($R,$F,$i){if(0!=this._aniMode){var $j=this.getSlotByName($R);$j&&$j.replaceDisplayByIndex($F,$i),this._clearCache();}},$R.setSlotSkin=function($R,$F){if(0!=this._aniMode){var $i=this.getSlotByName($R);$i&&$i.replaceSkin($F),this._clearCache();}},$R._clearCache=function(){if(1==this._aniMode)for(var $R=0,$F=this._graphicsCache.length;$R<$F;$R++){for(var $i=0,$j=this._graphicsCache[$R].length;$i<$j;$i++){var $t=this._graphicsCache[$R][$i];$t!=this.graphics&&$u.recycle($t);}this._graphicsCache[$R].length=0;}},$R.play=function($R,$F,$i,$j,$t,$p){void 0===$i&&($i=!0),void 0===$j&&($j=0),void 0===$t&&($t=0),void 0===$p&&($p=!0),this._indexControl=!1;var $$=-1,$V=NaN;if($V=$F?2147483647:0,"string"==typeof $R)for(var $N=0,$c=this._templet.getAnimationCount();$N<$c;$N++){var $q=this._templet.getAnimation($N);if($q&&$R==$q.name){$$=$N;break;}}else $$=$R;-1<$$&&$$<this.getAnimNum()&&(this._aniClipIndex=$$,($i||this._pause||this._currAniIndex!=$$)&&(this._currAniIndex=$$,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength($$)),this._drawOrder=null,this._eventIndex=0,this._player.play($$,this._player.playbackRate,$V,$j,$t),$p&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=$s.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()));},$R.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update));},$R.playbackRate=function($R){this._player&&(this._player.playbackRate=$R);},$R.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update));},$R.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=$s.now(),this.timer.frameLoop(1,this,this._update,null,!0));},$R._getGrahicsDataWithCache=function($R,$F){return this._graphicsCache[$R][$F];},$R._setGrahicsDataWithCache=function($R,$F,$i){this._graphicsCache[$R][$F]=$i;},$R.destroy=function($R){void 0===$R&&($R=!0),$F.prototype.destroy.call(this,$R),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update);},$p(0,$R,"url",function(){return this._aniPath;},function($R){this.load($R);}),$p(0,$R,"index",function(){return this._index;},function($R){this.player&&(this._index=$R,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1));}),$p(0,$R,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total;}),$p(0,$R,"templet",function(){return this._templet;}),$p(0,$R,"player",function(){return this._player;}),$i.useSimpleMeshInCanvas=!1,$i;}($pR),$B=function($F){function $t(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,$t.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[];}$j($t,"laya.ani.bone.Templet",$F);var $R=$t.prototype;return $R.getLoadList=function(){return this._loadList;},$R.loadAni=function($R){this._skBufferUrl=$R,$tR.loader.load($R,$N.create(this,this.onComplete),null,"arraybuffer");},$R.onComplete=function($R){if(this._isDestroyed)this.destroy();else{var $F=$c.getRes(this._skBufferUrl);$F?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,$F)):this.event("error","load failed:"+this._skBufferUrl);}},$R.parseData=function($R,$F,$i){void 0===$i&&($i=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=$R,this._mainTexture&&$a.isWebGL&&$R.bitmap&&($R.bitmap.enableMerageInAtlas=!1),this._rate=$i,this.parse($F);},$R.buildArmature=function($R){return void 0===$R&&($R=0),new $g(this,$R);},$R.parse=function($R){$F.prototype.parse.call(this,$R),this._endLoaded(),this._aniVersion!=$t.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+$t.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0);},$R._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var $R=0;this._loadList=[];var $F,$i=new $LR(this.getPublicExtData()),$j=0,$t=0,$p=0,$$=$i.getInt32(),$V=$i.readUTFString(),$N=$V.split("\n");for($R=0;$R<$$;$R++)$F=this._path+$N[2*$R],$V=$N[2*$R+1],$i.getFloat32(),$i.getFloat32(),$j=$i.getFloat32(),$t=$i.getFloat32(),$p=$i.getFloat32(),isNaN($p)?0:$p,$p=$i.getFloat32(),isNaN($p)?0:$p,$p=$i.getFloat32(),isNaN($p)?$j:$p,$p=$i.getFloat32(),isNaN($p)?$t:$p,-1==this._loadList.indexOf($F)&&this._loadList.push($F);this.event("inited",this);}},$R._textureComplete=function(){for(var $R,$F,$i=0,$j=this._loadList.length;$i<$j;$i++)$F=this._loadList[$i],$R=this._textureDic[$F]=$c.getRes($F),$a.isWebGL&&$R&&$R.bitmap&&($R.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData();},$R._parsePublicExtData=function(){var $R=0,$F=0,$i=0,$j=0,$t=0;for($R=0,$t=this.getAnimationCount();$R<$t;$R++)this._graphicsCache.push([]);var $p;$p="Dragon"!=this._aniClassName;var $$,$V,$N=new $LR(this.getPublicExtData()),$c=0,$q=0,$s=0,$k=0,$h=0,$S=0,$x=0,$a=0,$m=0,$M=$N.getInt32(),$J=$N.readUTFString(),$d=$J.split("\n");for($R=0;$R<$M;$R++){if($$=this._mainTexture,$V=this._path+$d[2*$R],$J=$d[2*$R+1],null==this._mainTexture&&($$=this._textureDic[$V]),!$$)return this.event("error",this),void(this.isParseFail=!0);$c=$N.getFloat32(),$q=$N.getFloat32(),$s=$N.getFloat32(),$k=$N.getFloat32(),$m=$N.getFloat32(),$h=isNaN($m)?0:$m,$m=$N.getFloat32(),$S=isNaN($m)?0:$m,$m=$N.getFloat32(),$x=isNaN($m)?$s:$m,$m=$N.getFloat32(),$a=isNaN($m)?$k:$m,this.subTextureDic[$J]=$fR.create($$,$c,$q,$s,$k,-$h,-$S,$x,$a),$$.alphaTexture&&(this.subTextureDic[$J].alphaTexture=$fR.create($$.alphaTexture,$c,$q,$s,$k,-$h,-$S,$x,$a));}this._mainTexture=$$;var $w,$X,$H,$_,$T,$g=$N.getUint16();for($R=0;$R<$g;$R++)($w=[]).push($N.getUint16()),$w.push($N.getUint16()),$w.push($N.getUint16()),$w.push($N.getUint16()),this.aniSectionDic[$R]=$w;var $B,$z=$N.getInt16(),$L={};for($R=0;$R<$z;$R++)$X=new $ZR(),0==$R?$B=$X:$X.root=$B,$X.d=$p?-1:1,$_=$N.readUTFString(),$T=$N.readUTFString(),$X.length=$N.getFloat32(),1==$N.getByte()&&($X.inheritRotation=!1),1==$N.getByte()&&($X.inheritScale=!1),$X.name=$_,$T&&(($H=$L[$T])?$H.addChild($X):this.mRootBone=$X),$L[$_]=$X,this.mBoneArr.push($X);this.tMatrixDataLen=$N.getUint16();var $Y,$f,$Z=$N.getUint16(),$u=Math.floor($Z/this.tMatrixDataLen),$v=this.srcBoneMatrixArr;for($R=0;$R<$u;$R++)($Y=new $oR()).scX=$N.getFloat32(),$Y.skX=$N.getFloat32(),$Y.skY=$N.getFloat32(),$Y.scY=$N.getFloat32(),$Y.x=$N.getFloat32(),$Y.y=$N.getFloat32(),8===this.tMatrixDataLen&&($Y.skewX=$N.getFloat32(),$Y.skewY=$N.getFloat32()),$v.push($Y),($X=this.mBoneArr[$R]).transform=$Y;var $K,$e=$N.getUint16(),$Q=0;for($R=0;$R<$e;$R++){for($f=new $GR(),$Q=$N.getUint16(),$F=0;$F<$Q;$F++)$f.boneNames.push($N.readUTFString()),$f.boneIndexs.push($N.getInt16());$f.name=$N.readUTFString(),$f.targetBoneName=$N.readUTFString(),$f.targetBoneIndex=$N.getInt16(),$f.bendDirection=$N.getFloat32(),$f.mix=$N.getFloat32(),$f.isSpine=$p,this.ikArr.push($f);}var $b,$G=$N.getUint16(),$O=0;for($R=0;$R<$G;$R++){for($K=new $WR(),$O=$N.getUint16(),$F=0;$F<$O;$F++)$K.boneIndexs.push($N.getInt16());$K.name=$N.getUTFString(),$K.targetIndex=$N.getInt16(),$K.rotateMix=$N.getFloat32(),$K.translateMix=$N.getFloat32(),$K.scaleMix=$N.getFloat32(),$K.shearMix=$N.getFloat32(),$K.offsetRotation=$N.getFloat32(),$K.offsetX=$N.getFloat32(),$K.offsetY=$N.getFloat32(),$K.offsetScaleX=$N.getFloat32(),$K.offsetScaleY=$N.getFloat32(),$K.offsetShearY=$N.getFloat32(),this.tfArr.push($K);}var $y=$N.getUint16(),$E=0;for($R=0;$R<$y;$R++){for(($b=new $OR()).name=$N.readUTFString(),$E=$N.getUint16(),$F=0;$F<$E;$F++)$b.bones.push($N.getInt16());$b.target=$N.readUTFString(),$b.positionMode=$N.readUTFString(),$b.spacingMode=$N.readUTFString(),$b.rotateMode=$N.readUTFString(),$b.offsetRotation=$N.getFloat32(),$b.position=$N.getFloat32(),$b.spacing=$N.getFloat32(),$b.rotateMix=$N.getFloat32(),$b.translateMix=$N.getFloat32(),this.pathArr.push($b);}var $l,$W,$o,$n,$C,$r=0,$A=0,$P=0,$U=NaN,$I=0,$D=$N.getInt16();for($R=0;$R<$D;$R++){var $RR=$N.getUint8(),$FR={};this.deformAniArr.push($FR);for(var $iR=0;$iR<$RR;$iR++)for(($l=new $vR()).skinName=$N.getUTFString(),$FR[$l.skinName]=$l,$r=$N.getInt16(),$F=0;$F<$r;$F++)for($W=new $KR(),$l.deformSlotDataList.push($W),$A=$N.getInt16(),$i=0;$i<$A;$i++)for($o=new $eR(),$W.deformSlotDisplayList.push($o),$o.slotIndex=$N.getInt16(),$o.attachment=$N.getUTFString(),$P=$N.getInt16(),$j=0;$j<$P;$j++)for(1==$N.getByte()?$o.tweenKeyList.push(!0):$o.tweenKeyList.push(!1),$U=$N.getFloat32(),$o.timeList.push($U),$n=[],$o.vectices.push($n),$I=$N.getInt16(),$t=0;$t<$I;$t++)$n.push($N.getFloat32());}var $jR,$tR,$pR=$N.getInt16(),$$R=0,$VR=0;for($R=0;$R<$pR;$R++){for($$R=$N.getInt16(),$C=[],$F=0;$F<$$R;$F++){for(($jR=new $QR()).time=$N.getFloat32(),$VR=$N.getInt16(),$i=0;$i<$VR;$i++)$jR.drawOrder.push($N.getInt16());$C.push($jR);}this.drawOrderAniArr.push($C);}var $NR,$cR=$N.getInt16(),$qR=0;for($R=0;$R<$cR;$R++){for($qR=$N.getInt16(),$tR=[],$F=0;$F<$qR;$F++)($NR=new $bR()).name=$N.getUTFString(),$NR.intValue=$N.getInt32(),$NR.floatValue=$N.getFloat32(),$NR.stringValue=$N.getUTFString(),$NR.time=$N.getFloat32(),$tR.push($NR);this.eventAniArr.push($tR);}var $sR=$N.getInt16();if(0<$sR)for(this.attachmentNames=[],$R=0;$R<$sR;$R++)this.attachmentNames.push($N.getUTFString());var $kR,$hR,$SR=$N.getInt16();for($R=0;$R<$SR;$R++)($kR=new $uR()).name=$N.readUTFString(),$kR.parent=$N.readUTFString(),$kR.attachmentName=$N.readUTFString(),$kR.srcDisplayIndex=$kR.displayIndex=$N.getInt16(),($kR.templet=this).boneSlotDic[$kR.name]=$kR,null==($hR=this.bindBoneBoneSlotDic[$kR.parent])&&(this.bindBoneBoneSlotDic[$kR.parent]=$hR=[]),$hR.push($kR),this.boneSlotArray.push($kR);var $xR,$aR,$mR,$MR=$N.readUTFString().split("\n"),$JR=0,$dR=$N.getUint8(),$wR=0,$XR=0,$HR=0,$_R=0,$TR=0,$gR=0,$BR=0;for($R=0;$R<$dR;$R++){for(($xR=new $yR()).name=$MR[$JR++],$wR=$N.getUint8(),$F=0;$F<$wR;$F++){for(($aR=new $lR()).name=$MR[$JR++],$kR=this.boneSlotDic[$aR.name],$XR=$N.getUint8(),$i=0;$i<$XR;$i++){if($mR=new $ER(),this.skinSlotDisplayDataArr.push($mR),$mR.name=$MR[$JR++],$mR.attachmentName=$MR[$JR++],$mR.transform=new $oR(),$mR.transform.scX=$N.getFloat32(),$mR.transform.skX=$N.getFloat32(),$mR.transform.skY=$N.getFloat32(),$mR.transform.scY=$N.getFloat32(),$mR.transform.x=$N.getFloat32(),$mR.transform.y=$N.getFloat32(),$aR.displayArr.push($mR),$mR.width=$N.getFloat32(),$mR.height=$N.getFloat32(),$mR.type=$N.getUint8(),$mR.verLen=$N.getUint16(),0<($z=$N.getUint16()))for($mR.bones=[],$j=0;$j<$z;$j++){var $zR=$N.getUint16();$mR.bones.push($zR);}if(0<($HR=$N.getUint16()))for($mR.uvs=[],$j=0;$j<$HR;$j++)$mR.uvs.push($N.getFloat32());if(0<($_R=$N.getUint16()))for($mR.weights=[],$j=0;$j<$_R;$j++)$mR.weights.push($N.getFloat32());if(0<($TR=$N.getUint16()))for($mR.triangles=[],$j=0;$j<$TR;$j++)$mR.triangles.push($N.getUint16());if(0<($gR=$N.getUint16()))for($mR.vertices=[],$j=0;$j<$gR;$j++)$mR.vertices.push($N.getFloat32());if(0<($BR=$N.getUint16()))for($mR.lengths=[],$j=0;$j<$BR;$j++)$mR.lengths.push($N.getFloat32());}$xR.slotArr.push($aR);}this.skinDic[$xR.name]=$xR,this.skinDataArray.push($xR);}1==$N.getUint8()?(this.yReverseMatrix=new $YR(1,0,0,-1,0,0),$B&&$B.setTempMatrix(this.yReverseMatrix)):$B&&$B.setTempMatrix(new $YR()),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this);},$R.getTexture=function($R){var $F=this.subTextureDic[$R];return $F||($F=this.subTextureDic[$R.substr(0,$R.length-1)]),null==$F?this._mainTexture:$F;},$R.showSkinByIndex=function($R,$F,$i){if(void 0===$i&&($i=!0),$F<0&&$F>=this.skinDataArray.length)return!1;var $j,$t,$p=0,$$=0,$V=this.skinDataArray[$F];if($V){for($p=0,$$=$V.slotArr.length;$p<$$;$p++)($t=$V.slotArr[$p])&&($j=$R[$t.name])&&($j.showSlotData($t,$i),$i&&"undefined"!=$j.attachmentName&&"null"!=$j.attachmentName?$j.showDisplayByName($j.attachmentName):$j.showDisplayByIndex($j.displayIndex));return!0;}return!1;},$R.getSkinIndexByName=function($R){for(var $F=0,$i=this.skinDataArray.length;$F<$i;$F++)if(this.skinDataArray[$F].name==$R)return $F;return-1;},$R.getGrahicsDataWithCache=function($R,$F){return this._graphicsCache[$R][$F];},$R.setGrahicsDataWithCache=function($R,$F,$i){this._graphicsCache[$R][$F]=$i;},$R.destroy=function(){var $R;for(var $F in this._isDestroyed=!0,this.subTextureDic)($R=this.subTextureDic[$F])&&$R.destroy();for($F in this._textureDic)($R=this._textureDic[$F])&&$R.destroy();for(var $i=0,$j=this.skinSlotDisplayDataArr.length;$i<$j;$i++)this.skinSlotDisplayDataArr[$i].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete $t.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this);},$R.getAniNameByIndex=function($R){var $F=this.getAnimation($R);return $F?$F.name:null;},$p(0,$R,"rate",function(){return this._rate;},function($R){this._rate=$R;}),$t.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",$t.TEMPLET_DICTIONARY=null,$t;}($v);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($R,$F){"use strict";for(var $i in Object.defineProperty($F,"__esModule",{value:!0}),Laya){var $j=Laya[$i];$j&&$j.__isclass&&($F[$i]=$j);}});