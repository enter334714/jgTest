var G=wx.$E;import sdk from"../utils/qxMiniSDK";var config={game_id:256,game_pkg:G[610959],partner_label:G[610960],partner_id:G[610961],game_ver:G[610962],is_auth:!1,partner_game_id:317,partner_game_name:G[610963],partner_channel_id:130254};window.config=config;var E1CR_D6=E1C_6DR();var HOST=G[610964];var E1CR_6D=null;var E1C_D6R=null;var sysInfo=wx.getSystemInfoSync();var platform=sysInfo.platform;var partner_user_info=null;function E1C_6DR(){var n={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(G[610965]);var t=this;var a;a=wx.getStorageSync(G[610966])?0:(a=t.uuid(16,32),wx.setStorageSync(G[610966],a),1),wx.getStorageSync(G[610967])||(n=t.uuid(16,32),wx.setStorageSync(G[610967],n));var n=wx.getLaunchOptionsSync();var o=n.scene||"";a&&n.query&&n.query.ad_code&&wx.setStorageSync(G[610968],n.query.ad_code),t.log(G[582010],{install:a,scene:o});t=n.query&&n.query.invite?n.query.invite:"";n=n.query&&n.query.invite_type?n.query.invite_type:"";t&&(E1C_D6R={invite:t,invite_type:n,is_new:a,scene:o}),e&&this.checkGameVersion(e,function(e){r&&r(e)})},login:function(e,r){console.log(G[610969]),n[G[580696]]=typeof r==G[581003]?r:null;var t=this;r={game_id:config.partner_game_id,game_name:config.partner_game_name,channel_id:config.partner_channel_id};sdk.init(r,function(e){console.log(G[610970]+JSON.stringify(e)),sdk.login({},function(e){0==e.statusCode&&(partner_user_info=e.loginParams,t.do_login(partner_user_info),console.log(G[610971]+JSON.stringify(e)))})})},do_login:function(e){var a=this;var r=a.getPublicData();if(r[G[580823]]=e.statusCode,r[G[610972]]=e.statusCode,r[G[610973]]=e.userName,r[G[581200]]=e.timestamp,r[G[580721]]=e.sign,r[G[580718]]=e.userId,r[G[589894]]=e.guid,r[G[610974]]=e.cp_ext,r[G[591050]]=e.ext,E1C_D6R&&typeof E1C_D6R==G[580901])for(var t in E1C_D6R)r[t]=E1C_D6R[t];wx.request({url:G[607527]+HOST+G[610975],method:G[580665],dataType:G[581250],header:{"content-type":G[580830]},data:r,success:function(e){if(console.log(G[610976]+JSON.stringify(e)),200==e.statusCode){e=e.data;if(e.state){try{wx.setStorageSync(G[610977],e.data.sdk_token),wx.setStorageSync(G[610978],e.data.user_id),wx.setStorageSync(G[610979],e.data.username),e.data.ext&&wx.setStorageSync(G[610980],e.data.ext)}catch(e){}var r={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};n[G[580696]]&&n[G[580696]](0,r)}else n[G[580696]]&&n[G[580696]](1,{errMsg:e.msg});var t=sdk.onShareToArk({});a.getShareInfo(G[610981],function(e){console.log(G[610982]),wx.onShareAppMessage(function(){return a.logStartShare(G[610981]),{title:t.title,imageUrl:t.img,query:e.query+"&"+t.query}})})}else n[G[580696]]&&n[G[580696]](1,{errMsg:G[610983]})}})},share:function(e){n[G[580790]]=typeof callback==G[581003]?callback:null;var r=e.type||G[580790];console.log(G[610984]+r);var t=this;this.getShareInfo(r,function(e){t.logStartShare(r);e=e.query;sdk.shareToArk({query:e},function(e){0==e.statusCode&&console.log(G[610985])})})},logStartShare:function(e){var r=wx.getStorageSync(G[610977]);wx.request({url:G[607527]+HOST+G[610986],method:G[580665],dataType:G[581250],header:{"content-type":G[580830]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:E1CR_6D?E1CR_6D.server_id:"",role_id:E1CR_6D?E1CR_6D.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,t){console.log(G[610987]);wx.getStorageSync(G[610977]);wx.request({url:G[607527]+HOST+G[610988],method:G[580665],dataType:G[581250],header:{"content-type":G[580830]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(G[610989]+JSON.stringify(e)),200==e.statusCode&&(r=e.data).state?t&&t(r.data):t&&t({develop:0})}})},getShareInfo:function(e,r){console.log(G[610990]);var t=wx.getStorageSync(G[610977]);wx.request({url:G[607527]+HOST+G[610991],method:G[580665],dataType:G[581250],header:{"content-type":G[580830]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,type:e,server_id:E1CR_6D?E1CR_6D.server_id:"",role_id:E1CR_6D?E1CR_6D.role_id:"",no_log:1},success:function(e){console.log(G[610992]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):n[G[580790]]&&n[G[580790]](1,{errMsg:G[610993]+e.msg}):n[G[580790]]&&n[G[580790]](1,{errMsg:G[610994]})}})},updateShare:function(e,r,t,a,n,o){console.log(G[610995]);var i=wx.getStorageSync(G[610977]);wx.request({url:G[607527]+HOST+G[610996],method:G[580665],dataType:G[581250],header:{"content-type":G[580830]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:r,is_new:t,role_id:a,sever_id:n,scene:o},success:function(e){console.log(G[610997]+JSON.stringify(e))}})},msgCheck:function(e,t){console.log(G[610998]+e),sdk.msgSecCheck({scene:4,content:e},e=>{let r={data:{}};0==e.statusCode&&e.checkResult.result.suggest==G[587871]?(r.statusCode=200,r.data.state=1):(r.statusCode=200,r.data.state=0),t&&t(r)})},pay:function(e,r){this.startPay(e,r)},startPay:function(e,r){console.log(G[610999]+JSON.stringify(e));n[G[580772]]=typeof r==G[581003]?r:null;r=wx.getStorageSync(G[610977]);var t=wx.getStorageSync(G[610980]);r?(e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:r,session_key:t,platform:platform},this.order_data=e,(r=this.getPublicData())[G[611001]]=JSON.stringify(e),wx.request({url:G[607527]+HOST+G[611002],method:G[580665],dataType:G[581250],header:{"content-type":G[580830]},data:r,success:function(e){var r;console.log(G[611003]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?(r={amount:e.data.pay_data.amount,cpProductId:e.data.pay_data.cpProductId,productName:e.data.pay_data.productName,callbackURL:e.data.pay_data.callbackURL,cpOrderId:e.data.pay_data.cpOrderId,callbackInfo:e.data.pay_data.cpOrderId,chargeMount:"1",serverId:e.data.pay_data.serverId,serverName:e.data.pay_data.serverName,roleName:e.data.pay_data.roleName,roleId:e.data.pay_data.roleId,roleLevel:e.data.pay_data.roleLevel,vipLevel:0},sdk.recharge(r)):n[G[580772]]&&n[G[580772]](1,{errMsg:e.msg}):n[G[580696]]&&n[G[580696]](1,{errMsg:G[610983]})}})):n[G[580772]]&&n[G[580772]](1,{errMsg:G[611e3]})},logCreateRole:function(e){var r=wx.getStorageSync(G[610978]);var t=wx.getStorageSync(G[610979]);var a={};a[G[611004]]=r,a[G[611005]]=t,a[G[592602]]=e.roleid,a[G[611006]]=e.rolelevel,a[G[611007]]=e.rolename,a[G[580022]]=e.serverid,e.roleid&&e.serverid&&(E1CR_6D={role_id:e.roleid,server_id:e.serverid}),this.log(G[580149],a);r={roleId:e.roleid,roleName:e.rolename,roleLevel:e.rolelevel,serverId:e.serverid,serverName:e.servername,vipLevel:0,userMoney:0,fighting:"",roleCTime:Date.parse(new Date)/1e3};sdk.createRole(r).then(function(e){console.log(G[611008]+JSON.stringify(e))})},logEnterGame:function(e){var r=wx.getStorageSync(G[610978]);var t=wx.getStorageSync(G[610979]);var a={};a[G[611004]]=r,a[G[611005]]=t,a[G[592602]]=e.roleid,a[G[611006]]=e.rolelevel,a[G[611007]]=e.rolename,a[G[580022]]=e.serverid,e.roleid&&e.serverid&&(E1CR_6D={role_id:e.roleid,server_id:e.serverid}),this.log(G[587452],a),E1C_D6R&&this.updateShare(E1C_D6R.invite,E1C_D6R.invite_type,E1C_D6R.is_new,e.roleid,e.serverid,E1C_D6R.scene);r={roleId:e.roleid,roleName:e.rolename,roleLevel:e.rolelevel,serverId:e.serverid,serverName:e.servername,vipLevel:0,userMoney:0,fighting:"",roleCTime:Date.parse(new Date)/1e3};sdk.changeRole(r).then(function(e){console.log(G[611008]+JSON.stringify(e))})},logRoleUpLevel:function(e){var r=wx.getStorageSync(G[610978]);var t=wx.getStorageSync(G[610979]);var a={};a[G[611004]]=r,a[G[611005]]=t,a[G[592602]]=e.roleid,a[G[611006]]=e.rolelevel,a[G[611007]]=e.rolename,a[G[580022]]=e.serverid,e.roleid&&e.serverid&&(E1CR_6D={role_id:e.roleid,server_id:e.serverid}),this.log(G[611009],a);r={roleId:e.roleid,roleName:e.rolename,roleLevel:e.rolelevel,serverId:e.serverid,serverName:e.servername,vipLevel:0,userMoney:0,fighting:"",roleCTime:Date.parse(new Date)/1e3};sdk.upgradeRole(r).then(function(e){console.log(G[611008]+JSON.stringify(e))})},uuid:function(e,r){var t=G[611010].split("");var a,n=[];var o;if(e=e||t.length,r)for(a=0;a<r;a++)n[a]=t[0|Math.random()*e];else for(n[8]=n[13]=n[18]=n[23]="-",n[14]="4",a=0;a<36;a++)n[a]||(o=0|16*Math.random(),n[a]=t[19==a?3&o|8:o]);return n.join("")},getPublicData:function(){var e=wx.getStorageSync(G[610966]);var r=wx.getStorageSync(G[610967]);var t=wx.getStorageSync(G[610968]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:t,uuid:e,idfv:r,mac:G[611011],is_from_min:1,dname:sysInfo.model,net_type:0==sysInfo.wifiSignal?"4G":G[611012],os_ver:sysInfo.system,sdk_ver:sysInfo.version,game_ver:config.game_ver,device:sysInfo.platform==G[580109]?1:2}},log:function(e,r){var t=this.getPublicData();for(var a in r)t[a]=r[a];console.log(G[611013]+e),console.log(t),wx.request({url:G[607527]+HOST+G[611014]+e+G[611015]+encodeURIComponent(JSON.stringify(t))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){},setMessageToFriendQuery:function(e,r){e=e.activity_id;r(wx.setMessageToFriendQuery({shareMessageToFriendScene:e}))}}}function run(e,r,t){e in E1CR_D6&&E1CR_D6[e](r,t)}exports.init=function(e,r){run(G[580501],e,r)},exports.login=function(e){run(G[580696],"",e)},exports.login=function(e){run(G[580696],"",e)},exports.pay=function(e,r){run(G[580772],e,r)},exports.openService=function(){run(G[580791])},exports.logCreateRole=function(e,r,t,a,n){run(G[580785],{serverid:e,servername:r,roleid:t,rolename:a,rolelevel:n})},exports.logEnterGame=function(e,r,t,a,n){run(G[580787],{serverid:e,servername:r,roleid:t,rolename:a,rolelevel:n})},exports.logRoleUpLevel=function(e,r,t,a,n){run(G[580789],{serverid:e,servername:r,roleid:t,rolename:a,rolelevel:n})},exports.share=function(e){run(G[580790],{type:e})},exports.msgCheck=function(e,r){run(G[580646],e,r)},exports.downloadClient=function(){run(G[611016])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(G[611017])},exports.weiduanHelper=function(){run(G[580793])},exports.setMessageToFriendQuery=function(e,r){run(G[611018],e,r)};