var Laya=window.Laya=function(I_j,I_a){var I_k={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(I_a,I_b){return 1==arguments.length?I_k.__presubstr.call(this,I_a):I_k.__presubstr.call(this,I_a,0<I_b?I_b:this.length+I_b)},__init:function(I_a){I_a.forEach(function(I_a){I_a.__init$&&I_a.__init$()})},__isClass:function(I_a){return I_a&&(I_a.__isclass||I_a==Object||I_a==String||I_a==Array)},__newvec:function(I_a,I_b){var I_c=[];I_c.length=I_a;for(var I_d=0;I_d<I_a;I_d++)I_c[I_d]=I_b;return I_c},__extend:function(I_a,I_b){for(var I_c in I_b)if(I_b.hasOwnProperty(I_c)){var I_d=Object.getOwnPropertyDescriptor(I_b,I_c),I_e=I_d.get,I_f=I_d.set;I_e||I_f?I_e&&I_f?Object.defineProperty(I_a,I_c,I_d):(I_e&&Object.defineProperty(I_a,I_c,I_e),I_f&&Object.defineProperty(I_a,I_c,I_f)):I_a[I_c]=I_b[I_c]}function I_g(){I_k.un(this,"constructor",I_a)}I_g.prototype=I_b.prototype,I_a.prototype=new I_g,I_k.un(I_a.prototype,"__imps",I_k.__copy({},I_b.prototype.__imps))},__copy:function(I_a,I_b){if(!I_b)return null;for(var I_c in I_a=I_a||{},I_b)I_a[I_c]=I_b[I_c];return I_a},__package:function(I_a,I_b){if(!I_k.__packages[I_a]){I_k.__packages[I_a]=!0;var I_c=I_j,I_d=I_a.split(".");if(1<I_d.length)for(var I_e=0,I_f=I_d.length-1;I_e<I_f;I_e++){var I_g=I_c[I_d[I_e]];I_c=I_g||(I_c[I_d[I_e]]={})}I_c[I_d[I_d.length-1]]||(I_c[I_d[I_d.length-1]]=I_b||{})}},__hasOwnProperty:function(I_a,I_b){return I_b=I_b||this,Object.hasOwnProperty.call(I_b,I_a)||function I_a(I_b,I_c){if(Object.hasOwnProperty.call(I_c.prototype,I_b))return!0;var I_d=I_c.prototype.__super;return null==I_d?null:I_a(I_b,I_d)}(I_a,I_b.__class)},__typeof:function(I_a,I_b){if(!I_a||!I_b)return!1;if(I_b===String)return"string"==typeof I_a;if(I_b===Number)return"number"==typeof I_a;if(I_b.__interface__)I_b=I_b.__interface__;else if("string"!=typeof I_b)return I_a instanceof I_b;return I_a.__imps&&I_a.__imps[I_b]||I_a.__class==I_b},__as:function(I_a,I_b){return this.__typeof(I_a,I_b)?I_a:null},__int:function(I_a){return I_a?parseInt(I_a):0},interface:function(I_a,I_b){I_k.__package(I_a,{});var I_c=I_k.__internals,I_d=I_c[I_a]=I_c[I_a]||{self:I_a};if(I_b){var I_e=I_b.split(",");I_d.extend=[];for(var I_f=0;I_f<I_e.length;I_f++){var I_g=I_e[I_f];I_c[I_g]=I_c[I_g]||{self:I_g},I_d.extend.push(I_c[I_g])}}var I_h=I_j,I_i=I_a.split(".");for(I_f=0;I_f<I_i.length-1;I_f++)I_h=I_h[I_i[I_f]];I_h[I_i[I_i.length-1]]={__interface__:I_a}},class:function(I_a,I_b,I_c,I_d){if(I_c&&I_k.__extend(I_a,I_c),I_b)if(I_k.__package(I_b,I_a),I_k.__classmap[I_b]=I_a,0<I_b.indexOf(".")){if(0==I_b.indexOf("laya.")){var I_e=I_b.split(".");I_d=I_d||I_e[I_e.length-1],I_k[I_d]&&console.log("Warning!,this class["+I_d+"] already exist:",I_k[I_d]),I_k[I_d]=I_a}}else"Main"==I_b?I_j.Main=I_a:"MainWX"==I_b?I_j.MainWX=I_a:(I_k[I_b]&&console.log("Error!,this class["+I_b+"] already exist:",I_k[I_b]),I_k[I_b]=I_a);var I_f=I_k.un,I_g=I_a.prototype;I_f(I_g,"hasOwnProperty",I_k.__hasOwnProperty),I_f(I_g,"__class",I_a),I_f(I_g,"__super",I_c),I_f(I_g,"__className",I_b),I_f(I_a,"__super",I_c),I_f(I_a,"__className",I_b),I_f(I_a,"__isclass",!0),I_f(I_a,"super",function(I_a){this.__super.call(I_a)})},imps:function(I_a,I_b){if(!I_b)return null;var I_e=I_a.__imps||I_k.un(I_a,"__imps",{});function I_f(I_a){var I_b,I_c;if((I_b=I_k.__internals[I_a])&&(I_e[I_a]=!0,I_c=I_b.extend))for(var I_d=0;I_d<I_c.length;I_d++)I_f(I_c[I_d].self)}for(var I_c in I_b)I_f(I_c)},superSet:function(I_a,I_b,I_c,I_d){var I_e=I_a.prototype["_$set_"+I_c];I_e&&I_e.call(I_b,I_d)},superGet:function(I_a,I_b,I_c){var I_d=I_a.prototype["_$get_"+I_c];return I_d?I_d.call(I_b):null},getset:function(I_a,I_b,I_c,I_d,I_e){I_a?(I_d&&(I_b["_$GET_"+I_c]=I_d),I_e&&(I_b["_$SET_"+I_c]=I_e)):(I_d&&I_k.un(I_b,"_$get_"+I_c,I_d),I_e&&I_k.un(I_b,"_$set_"+I_c,I_e)),I_d&&I_e?Object.defineProperty(I_b,I_c,{get:I_d,set:I_e,enumerable:!1,configurable:!0}):(I_d&&Object.defineProperty(I_b,I_c,{get:I_d,enumerable:!1,configurable:!0}),I_e&&Object.defineProperty(I_b,I_c,{set:I_e,enumerable:!1,configurable:!0}))},static:function(I_c,I_d){for(var I_e=0,I_a=I_d.length;I_e<I_a;I_e+=2)if("length"==I_d[I_e])I_c.length=I_d[I_e+1].call(I_c);else{function I_b(){var I_b=I_d[I_e],I_a=I_d[I_e+1];Object.defineProperty(I_c,I_b,{get:function(){return delete this[I_b],this[I_b]=I_a.call(this)},set:function(I_a){delete this[I_b],this[I_b]=I_a},enumerable:!0,configurable:!0})}I_b()}},un:function(I_a,I_b,I_c){return I_c||(I_c=I_a[I_b]),I_k.__propun.value=I_c,Object.defineProperty(I_a,I_b,I_k.__propun),I_c},uns:function(I_b,I_a){I_a.forEach(function(I_a){I_k.un(I_b,I_a)})}};return I_j.console=I_j.console||{log:function(){}},I_j.trace=I_j.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),I_k}(window,document);!function(I_a,I_b,I_c){I_c.un,I_c.uns,I_c.static,I_c.class,I_c.getset,I_c.__newvec}(window,document,Laya),function(I_g,I_b,I_z){I_z.un,I_z.uns;var I_i=I_z.static,I_k=I_z.class,I_o=I_z.getset;I_z.__newvec;I_z.interface("laya.runtime.IMarket"),I_z.interface("laya.filters.IFilter"),I_z.interface("laya.display.ILayout"),I_z.interface("laya.resource.IDispose"),I_z.interface("laya.runtime.IPlatform"),I_z.interface("laya.resource.IDestroy"),I_z.interface("laya.runtime.IConchNode"),I_z.interface("laya.filters.IFilterAction"),I_z.interface("laya.runtime.ICPlatformClass"),I_z.interface("laya.resource.ICreateResource"),I_z.interface("laya.runtime.IConchRenderObject"),I_z.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var I_F=function(){function I_f(){}return I_k(I_f,"laya.utils.RunDriver"),I_f.FILTER_ACTIONS=[],I_f.pixelRatio=-1,I_f._charSizeTestDiv=null,I_f.now=function(){return Date.now()},I_f.getWindow=function(){return I_g},I_f.getPixelRatio=function(){if(I_f.pixelRatio<0){var I_a=I_O.context,I_b=I_a.backingStorePixelRatio||I_a.webkitBackingStorePixelRatio||I_a.mozBackingStorePixelRatio||I_a.msBackingStorePixelRatio||I_a.oBackingStorePixelRatio||I_a.backingStorePixelRatio||1;(I_f.pixelRatio=(I_O.window.devicePixelRatio||1)/I_b)<1&&(I_f.pixelRatio=1)}return I_f.pixelRatio},I_f.getIncludeStr=function(I_a){return null},I_f.createShaderCondition=function(I_a){var I_b="(function() {return "+I_a+";})";return I_z._runScript(I_b)},I_f.fontMap=[],I_f.measureText=function(I_a,I_b){var I_c=I_f.hanzi.test(I_a);if(I_c&&I_f.fontMap[I_b])return I_f.fontMap[I_b];var I_d=I_O.context;I_d.font=I_b;var I_e=I_d.measureText(I_a);return I_c&&(I_f.fontMap[I_b]=I_e),I_e},I_f.getWebGLContext=function(I_a){},I_f.beginFlush=function(){},I_f.endFinish=function(){},I_f.addToAtlas=null,I_f.flashFlushImage=function(I_a){},I_f.drawToCanvas=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=I_va.create("2D"),I_h=new I_K(I_c,I_d,I_g);return I_L.renders[I_b]._fun(I_a,I_h,I_e,I_f),I_g},I_f.createParticleTemplate2D=null,I_f.createGLTextur=null,I_f.createWebGLContext2D=null,I_f.changeWebGLSize=function(I_a,I_b){},I_f.createRenderSprite=function(I_a,I_b){return new I_L(I_a,I_b)},I_f.createFilterAction=function(I_a){return new I_v},I_f.createGraphics=function(){return new I_m},I_f.clear=function(I_a){I_J._context.ctx.clear()},I_f.cancelLoadByUrl=function(I_a){},I_f.clearAtlas=function(I_a){},I_f.isAtlas=function(I_a){return!1},I_f.addTextureToAtlas=function(I_a){},I_f.getTexturePixels=function(I_a,I_b,I_c,I_d,I_e){return null},I_f.skinAniSprite=function(){return null},I_f.update3DLoop=function(){},I_i(I_f,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),I_f}(),I_d=(I_o(1,I_z,"alertGlobalError",null,function(I_a){var I_f=0;I_O.window.onerror=I_a?function(I_a,I_b,I_c,I_d,I_e){I_f++<5&&I_e&&alert(I_e.stack||I_e)}:null}),I_z.init=function(I_a,I_b,I_c){for(var I_d=[],I_e=2,I_f=arguments.length;I_e<I_f;I_e++)I_d.push(arguments[I_e]);if(!I_z._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=I_z._arrayBufferSlice),I_z._isinit=!0,I_O.__init__(),I_M.__init__(),I_m.__init__(),I_z.timer=new I_Y,I_z.scaleTimer=new I_Y,I_z.loader=new I_ia,I_q.__init__(),I_e=0;for(var I_g=I_d.length;I_e<I_g;I_e++)I_d[I_e].enable&&I_d[I_e].enable();return I_n.__init__(),I_h.__init__(),I_N.__init__(),I_Q.beginCheck(),I_z._currentStage=I_z.stage=new I_ta,I_z.stage.conchModel&&I_z.stage.conchModel.setRootNode(),I_z._getUrlPath(),I_z.render=new I_J(0,0),I_z.stage.size(I_a,I_b),I_L.__init__(),I_l.__init__(),I_p.instance.__init__(I_z.stage,I_J.canvas),I_xa.__init__(),I_E.autoStopMusic=!0,I_C.__init__(),I_J.canvas}},I_z._getUrlPath=function(){var I_a=I_O.window.location,I_b=I_a.pathname;I_b=I_b&&":"==I_b.charAt(2)?I_b.substring(1):I_b,I_I.rootPath=I_I.basePath=I_I.getPath("file:"==I_a.protocol?I_b:I_a.protocol+"//"+I_a.host+I_a.pathname)},I_z._arrayBufferSlice=function(I_a,I_b){var I_c=new Uint8Array(this,I_a,I_b-I_a),I_d=new Uint8Array(I_c.length);return I_d.set(I_c),I_d.buffer},I_z._runScript=function(I_a){return I_O.window[I_z._evcode](I_a)},I_z.stage=null,I_z.timer=null,I_z.scaleTimer=null,I_z.loader=null,I_z.version="1.8.6",I_z.render=null,I_z._currentStage=null,I_z._isinit=!1,I_z.isDebug=!1,I_z.MiniAdpter={init:function(){I_g.navigator&&I_g.navigator.userAgent&&-1<I_g.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},I_i(I_z,["conchMarket",function(){return this.conchMarket=I_g.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=I_g.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function I_a(){}return I_k(I_a,"Config"),I_a.WebGLTextCacheCount=500,I_a.atlasEnable=!1,I_a.showCanvasMark=!1,I_a.animationInterval=50,I_a.isAntialias=!1,I_a.isAlpha=!1,I_a.premultipliedAlpha=!0,I_a.isStencil=!0,I_a.preserveDrawingBuffer=!1,I_a}()),I_j=function(){function I_j(){this._events=null}I_k(I_j,"laya.events.EventDispatcher");var I_a=I_j.prototype;return I_a.hasListener=function(I_a){return!!(this._events&&this._events[I_a])},I_a.event=function(I_a,I_b){if(!this._events||!this._events[I_a])return!1;var I_c=this._events[I_a];if(I_c.lock)I_c.queue||(I_c.queue=[]),I_c.queue.push(I_b);else{var I_d;for(I_c.lock=!0,I_c.cursor=I_c.head;I_c.cursor;)I_d=I_c.cursor,I_c.cursor=I_d.next,I_d.once&&I_j.delNode(I_c,I_d),null!=I_b?I_d.args?I_d.method.apply(I_d.caller,I_d.args.concat(I_b)):I_b instanceof Array?I_d.method.apply(I_d.caller,I_b):I_d.method.call(I_d.caller,I_b):I_d.method.apply(I_d.caller,I_d.args),I_d.once&&I_j.recoverHandler(I_d);I_c.lock=!1,!I_c.head&&this._events&&this._events[I_a]==I_c&&delete this._events[I_a],I_c.queue&&I_c.queue.length&&this.event(I_a,I_c.queue.shift())}return!0},I_a.on=function(I_a,I_b,I_c,I_d){return this._createListener(I_a,I_b,I_c,I_d,!1)},I_a.once=function(I_a,I_b,I_c,I_d){return this._createListener(I_a,I_b,I_c,I_d,!0)},I_a._createListener=function(I_a,I_b,I_c,I_d,I_e,I_f){void 0===I_f&&(I_f=!0),I_f&&this.off(I_a,I_b,I_c,I_e);var I_g=I_j.createHandler(I_b||this,I_c,I_d,I_e);this._events||(this._events={});var I_h=this._events,I_i=I_h[I_a];return I_i?I_i.tail?(I_g.prev=I_i.tail,I_i.tail.next=I_g,I_i.tail=I_g):I_i.head=I_i.tail=I_g:I_h[I_a]={head:I_g,tail:I_g,cursor:null,lock:!1},this},I_a.off=function(I_a,I_b,I_c,I_d){if(void 0===I_d&&(I_d=!1),!this._events||!this._events[I_a])return this;for(var I_e=this._events[I_a],I_f=I_e.head;I_f;){if((!I_b||I_f.caller===I_b)&&I_f.method===I_c&&(!I_d||I_f.once)){I_j.delNode(I_e,I_f),I_e.cursor==I_f&&(I_e.cursor=I_f.next),I_j.recoverHandler(I_f);break}I_f=I_f.next}return this},I_a.offAll=function(I_a){var I_b=this._events;if(!I_b)return this;if(I_a)this._recoverHandlers(I_b[I_a]),delete I_b[I_a];else{for(var I_c in I_b)this._recoverHandlers(I_b[I_c]);this._events=null}return this},I_a._recoverHandlers=function(I_a){if(I_a){for(var I_b=I_a.head;I_b;){I_j.delNode(I_a,I_b);var I_c=I_b.next;I_j.recoverHandler(I_b),I_b=I_c}I_a.cursor=null}},I_a.isMouseEvent=function(I_a){return I_j.MOUSE_EVENTS[I_a]},I_j.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},I_j.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},I_j.delNode=function(I_a,I_b){I_b.prev?I_b.prev.next=I_b.next:I_a.head=I_b.next,I_b.next?I_b.next.prev=I_b.prev:I_a.tail=I_b.prev},I_j.createHandler=function(I_a,I_b,I_c,I_d){var I_e=I_j._freeHandler;return I_e?(I_j._freeCount--,I_j._freeHandler=I_e.next,I_e.caller=I_a,I_e.method=I_b,I_e.args=I_c,I_e.once=I_d):I_e={caller:I_a,method:I_b,args:I_c,once:I_d},I_e.prev=I_e.next=null,I_e},I_j.recoverHandler=function(I_a){I_a.caller=I_a.method=I_a.args=I_a.prev=null,I_a.next=I_j._freeHandler,I_j._freeHandler=I_a,I_j._freeCount++},I_j._freeHandler=null,I_j._freeCount=0,I_j}(),I_u=function(){function I_e(I_a,I_b,I_c,I_d){this.once=!1,void(this._id=0)===I_d&&(I_d=!1),this.setTo(I_a,I_b,I_c,I_d)}I_k(I_e,"laya.utils.Handler");var I_a=I_e.prototype;return I_a.setTo=function(I_a,I_b,I_c,I_d){return this._id=I_e._gid++,this.caller=I_a,this.method=I_b,this.args=I_c,this.once=I_d,this},I_a.run=function(){if(null==this.method)return null;var I_a=this._id,I_b=this.method.apply(this.caller,this.args);return this._id===I_a&&this.once&&this.recover(),I_b},I_a.runWith=function(I_a){if(null==this.method)return null;var I_b=this._id;if(null==I_a)var I_c=this.method.apply(this.caller,this.args);else I_c=this.args||I_a.unshift?this.args?this.method.apply(this.caller,this.args.concat(I_a)):this.method.apply(this.caller,I_a):this.method.call(this.caller,I_a);return this._id===I_b&&this.once&&this.recover(),I_c},I_a.clear=function(){return this.caller=null,this.method=null,this.args=null,this},I_a.recover=function(){0<this._id&&(this._id=0,this.clear())},I_e.create=function(I_a,I_b,I_c,I_d){return void 0===I_d&&(I_d=!0),new I_e(I_a,I_b,I_c,I_d)},I_e._gid=1,I_e}(),I_D=function(){function I_a(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}I_k(I_a,"laya.display.BitmapFont");var I_b=I_a.prototype;return I_b.loadFont=function(I_a,I_b){this._path=I_a,this._complete=I_b,I_z.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],I_u.create(this,this.onLoaded))},I_b.onLoaded=function(){this.parseFont(I_ha.getRes(this._path),I_ha.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},I_b.parseFont=function(I_a,I_b){if(null!=I_a&&null!=I_b){this._texture=I_b;var I_c=I_a.getElementsByTagName("info");if(!I_c[0].getAttributeNode)return this.parseFont2(I_a,I_b);this.fontSize=parseInt(I_c[0].getAttributeNode("size").nodeValue);var I_d,I_e=I_c[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(I_e[0]),parseInt(I_e[1]),parseInt(I_e[2]),parseInt(I_e[3])],I_d=I_a.getElementsByTagName("char");var I_f=0;for(I_f=0;I_f<I_d.length;I_f++){var I_g=I_d[I_f],I_h=parseInt(I_g.getAttributeNode("id").nodeValue),I_i=parseInt(I_g.getAttributeNode("xoffset").nodeValue)/1,I_j=parseInt(I_g.getAttributeNode("yoffset").nodeValue)/1,I_k=parseInt(I_g.getAttributeNode("xadvance").nodeValue)/1,I_l=new I_B;I_l.x=parseInt(I_g.getAttributeNode("x").nodeValue),I_l.y=parseInt(I_g.getAttributeNode("y").nodeValue),I_l.width=parseInt(I_g.getAttributeNode("width").nodeValue),I_l.height=parseInt(I_g.getAttributeNode("height").nodeValue);var I_m=I_ka.create(I_b,I_l.x,I_l.y,I_l.width,I_l.height,I_i,I_j);this._maxWidth=Math.max(this._maxWidth,I_k+this.letterSpacing),this._fontCharDic[I_h]=I_m,this._fontWidthMap[I_h]=I_k}}},I_b.parseFont2=function(I_a,I_b){if(null!=I_a&&null!=I_b){this._texture=I_b;var I_c=I_a.getElementsByTagName("info");this.fontSize=parseInt(I_c[0].attributes.size.nodeValue);var I_d=I_c[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(I_d[0]),parseInt(I_d[1]),parseInt(I_d[2]),parseInt(I_d[3])];var I_e=I_a.getElementsByTagName("char"),I_f=0;for(I_f=0;I_f<I_e.length;I_f++){var I_g=I_e[I_f].attributes,I_h=parseInt(I_g.id.nodeValue),I_i=parseInt(I_g.xoffset.nodeValue)/1,I_j=parseInt(I_g.yoffset.nodeValue)/1,I_k=parseInt(I_g.xadvance.nodeValue)/1,I_l=new I_B;I_l.x=parseInt(I_g.x.nodeValue),I_l.y=parseInt(I_g.y.nodeValue),I_l.width=parseInt(I_g.width.nodeValue),I_l.height=parseInt(I_g.height.nodeValue);var I_m=I_ka.create(I_b,I_l.x,I_l.y,I_l.width,I_l.height,I_i,I_j);this._maxWidth=Math.max(this._maxWidth,I_k+this.letterSpacing),this._fontCharDic[I_h]=I_m,this._fontWidthMap[I_h]=I_k}}},I_b.getCharTexture=function(I_a){return this._fontCharDic[I_a.charCodeAt(0)]},I_b.destroy=function(){if(this._texture){for(var I_a in this._fontCharDic){var I_b=this._fontCharDic[I_a];I_b&&I_b.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},I_b.setSpaceWidth=function(I_a){this._spaceWidth=I_a},I_b.getCharWidth=function(I_a){var I_b=I_a.charCodeAt(0);return this._fontWidthMap[I_b]?this._fontWidthMap[I_b]+this.letterSpacing:" "==I_a?this._spaceWidth+this.letterSpacing:0},I_b.getTextWidth=function(I_a){for(var I_b=0,I_c=0,I_d=I_a.length;I_c<I_d;I_c++)I_b+=this.getCharWidth(I_a.charAt(I_c));return I_b},I_b.getMaxWidth=function(){return this._maxWidth},I_b.getMaxHeight=function(){return this.fontSize},I_b.drawText=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g,I_h=this.getTextWidth(I_a),I_i=0;"center"===I_e&&(I_i=(I_f-I_h)/2),"right"===I_e&&(I_i=I_f-I_h);for(var I_j=0,I_k=0,I_l=I_a.length;I_k<I_l;I_k++)(I_g=this.getCharTexture(I_a.charAt(I_k)))&&(I_b.graphics.drawTexture(I_g,I_c+I_j+I_i,I_d),I_j+=this.getCharWidth(I_a.charAt(I_k)))},I_a}(),I_h=function(){function I_c(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=I_c._TF_EMPTY}I_k(I_c,"laya.display.css.Style");var I_a=I_c.prototype;return I_a.getTransform=function(){return this._tf},I_a.setTransform=function(I_a){this._tf="none"!==I_a&&I_a?I_a:I_c._TF_EMPTY},I_a.setTranslateX=function(I_a){this._tf===I_c._TF_EMPTY&&(this._tf=new I_e),this._tf.translateX=I_a},I_a.setTranslateY=function(I_a){this._tf===I_c._TF_EMPTY&&(this._tf=new I_e),this._tf.translateY=I_a},I_a.setScaleX=function(I_a){this._tf===I_c._TF_EMPTY&&(this._tf=new I_e),this._tf.scaleX=I_a},I_a.setScale=function(I_a,I_b){this._tf===I_c._TF_EMPTY&&(this._tf=new I_e),this._tf.scaleX=I_a,this._tf.scaleY=I_b},I_a.setScaleY=function(I_a){this._tf===I_c._TF_EMPTY&&(this._tf=new I_e),this._tf.scaleY=I_a},I_a.setRotate=function(I_a){this._tf===I_c._TF_EMPTY&&(this._tf=new I_e),this._tf.rotate=I_a},I_a.setSkewX=function(I_a){this._tf===I_c._TF_EMPTY&&(this._tf=new I_e),this._tf.skewX=I_a},I_a.setSkewY=function(I_a){this._tf===I_c._TF_EMPTY&&(this._tf=new I_e),this._tf.skewY=I_a},I_a.destroy=function(){this.scrollRect=null},I_a.render=function(I_a,I_b,I_c,I_d){},I_a.getCSSStyle=function(){return I_ba.EMPTY},I_a._enableLayout=function(){return!1},I_o(0,I_a,"scaleX",function(){return this._tf.scaleX},function(I_a){this.setScaleX(I_a)}),I_o(0,I_a,"transform",function(){return this.getTransform()},function(I_a){this.setTransform(I_a)}),I_o(0,I_a,"translateX",function(){return this._tf.translateX},function(I_a){this.setTranslateX(I_a)}),I_o(0,I_a,"translateY",function(){return this._tf.translateY},function(I_a){this.setTranslateY(I_a)}),I_o(0,I_a,"scaleY",function(){return this._tf.scaleY},function(I_a){this.setScaleY(I_a)}),I_o(0,I_a,"block",function(){return 0!=(1&this._type)}),I_o(0,I_a,"skewY",function(){return this._tf.skewY},function(I_a){this.setSkewY(I_a)}),I_o(0,I_a,"rotate",function(){return this._tf.rotate},function(I_a){this.setRotate(I_a)}),I_o(0,I_a,"skewX",function(){return this._tf.skewX},function(I_a){this.setSkewX(I_a)}),I_o(0,I_a,"paddingLeft",function(){return 0}),I_o(0,I_a,"paddingTop",function(){return 0}),I_o(0,I_a,"absolute",function(){return!0}),I_c.__init__=function(){I_c._TF_EMPTY=new I_e,I_c.EMPTY=new I_c},I_c.EMPTY=null,I_c._TF_EMPTY=null,I_c}(),I_n=function(){function I_b(I_a){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=I_S.create(I_b.defaultColor),this.family=I_b.defaultFamily,this.stroke=I_b._STROKE,this.size=I_b.defaultSize,I_a&&I_a!==I_b.EMPTY&&I_a.copyTo(this)}I_k(I_b,"laya.display.css.Font");var I_a=I_b.prototype;return I_a.set=function(I_a){this._text=null;for(var I_b=I_a.split(" "),I_c=0,I_d=I_b.length;I_c<I_d;I_c++){var I_e=I_b[I_c];switch(I_e){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<I_e.indexOf("px")&&(this.size=parseInt(I_e),this.family=I_b[I_c+1],I_c++)}},I_a.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},I_a.copyTo=function(I_a){I_a._type=this._type,I_a._text=this._text,I_a._weight=this._weight,I_a._color=this._color,I_a.family=this.family,I_a.stroke=this.stroke!=I_b._STROKE?this.stroke.slice():I_b._STROKE,I_a.indent=this.indent,I_a.size=this.size},I_o(0,I_a,"password",function(){return 0!=(1024&this._type)},function(I_a){I_a?this._type|=1024:this._type&=-1025}),I_o(0,I_a,"color",function(){return this._color.strColor},function(I_a){this._color=I_S.create(I_a)}),I_o(0,I_a,"italic",function(){return 0!=(512&this._type)},function(I_a){I_a?this._type|=512:this._type&=-513}),I_o(0,I_a,"bold",function(){return 0!=(2048&this._type)},function(I_a){I_a?this._type|=2048:this._type&=-2049}),I_o(0,I_a,"weight",function(){return""+this._weight},function(I_a){var I_b=0;switch(I_a){case"normal":break;case"bold":this.bold=!0,I_b=700;break;case"bolder":I_b=800;break;case"lighter":I_b=100;break;default:I_b=parseInt(I_a)}this._weight=I_b,this._text=null}),I_o(0,I_a,"decoration",function(){return this._decoration?this._decoration.value:null},function(I_a){var I_b=I_a.split(" ");switch(this._decoration||(this._decoration={}),I_b[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=I_b[0]}I_b[1]&&(this._decoration.color=I_S.create(I_b)),this._decoration.value=I_a}),I_b.__init__=function(){I_b.EMPTY=new I_b(null)},I_b.EMPTY=null,I_b.defaultColor="#000000",I_b.defaultSize=12,I_b.defaultFamily="Arial",I_b.defaultFont="12px Arial",I_b._STROKE=[0,"#000000"],I_b._ITALIC=512,I_b._PASSWORD=1024,I_b._BOLD=2048,I_b}(),I_e=function(){function I_a(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return I_k(I_a,"laya.display.css.TransformInfo"),I_a}(),I_m=function(){function I_l(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,I_J.isConchNode){this._nativeObj=new I_g._conchGraphics,this.id=this._nativeObj.conchID}}I_k(I_l,"laya.display.Graphics");var I_a=I_l.prototype;return I_a.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},I_a.clear=function(I_a){void 0===I_a&&(I_a=!1);var I_b=0,I_c=0;if(I_a){var I_d=this._one;if(this._cmds){for(I_c=this._cmds.length,I_b=0;I_b<I_c;I_b++)!(I_d=this._cmds[I_b])||I_d.callee!==I_J._context._drawTexture&&I_d.callee!==I_J._context._drawTextureWithTransform||(I_d[0]=null,I_l._cache.push(I_d));this._cmds.length=0}else I_d&&(!I_d||I_d.callee!==I_J._context._drawTexture&&I_d.callee!==I_J._context._drawTextureWithTransform||(I_d[0]=null,I_l._cache.push(I_d)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(I_b=0,I_c=this._vectorgraphArray.length;I_b<I_c;I_b++)I__.getInstance().deleteShape(this._vectorgraphArray[I_b]);this._vectorgraphArray.length=0}},I_a._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},I_a._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new I_c,this._graphicBounds._graphics=this)},I_a._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},I_a._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},I_a.getBounds=function(I_a){return void 0===I_a&&(I_a=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(I_a)},I_a.getBoundPoints=function(I_a){return void 0===I_a&&(I_a=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(I_a)},I_a._addCmd=function(I_a){this._cmds=this._cmds||[],I_a.callee=I_a.shift(),this._cmds.push(I_a)},I_a.setFilters=function(I_a){this._saveToCmd(I_J._context._setFilters,I_a)},I_a.drawTexture=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){if(void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=0),void 0===I_e&&(I_e=0),void 0===I_g&&(I_g=1),!I_a||I_g<.01)return null;I_d||(I_d=I_a.sourceWidth),I_e||(I_e=I_a.sourceHeight),I_g=I_g<0?0:1<I_g?1:I_g;var I_h,I_i=!I_J.isWebGL&&(I_O.onFirefox||I_O.onEdge||I_O.onIE||I_O.onSafari)?.5:0,I_j=I_d/I_a.sourceWidth,I_k=I_e/I_a.sourceHeight;return I_d=I_a.width*I_j,I_e=I_a.height*I_k,I_a.loaded&&(I_d<=0||I_e<=0)?null:(I_b+=I_a.offsetX*I_j,I_c+=I_a.offsetY*I_k,this._sp&&(this._sp._renderType|=512),I_b-=I_i,I_c-=I_i,I_d+=2*I_i,I_e+=2*I_i,I_l._cache.length?((I_h=I_l._cache.pop())[0]=I_a,I_h[1]=I_b,I_h[2]=I_c,I_h[3]=I_d,I_h[4]=I_e,I_h[5]=I_f,I_h[6]=I_g):I_h=[I_a,I_b,I_c,I_d,I_e,I_f,I_g],I_h.callee=I_f||1!=I_g?I_J._context._drawTextureWithTransform:I_J._context._drawTexture,null!=this._one||I_f||1!=I_g?this._saveToCmd(I_h.callee,I_h):(this._one=I_h,this._render=this._renderOneImg),I_a.loaded||I_a.once("loaded",this,this._textureLoaded,[I_a,I_h]),this._repaint(),I_h)},I_a.cleanByTexture=function(I_a,I_b,I_c,I_d,I_e){if(void 0===I_d&&(I_d=0),void 0===I_e&&(I_e=0),!I_a)return this.clear();if(this._one&&this._render===this._renderOneImg){I_d||(I_d=I_a.sourceWidth),I_e||(I_e=I_a.sourceHeight);var I_f=I_d/I_a.sourceWidth,I_g=I_e/I_a.sourceHeight;I_d=I_a.width*I_f,I_e=I_a.height*I_g,I_b+=I_a.offsetX*I_f,I_c+=I_a.offsetY*I_g,this._one[0]=I_a,this._one[1]=I_b,this._one[2]=I_c,this._one[3]=I_d,this._one[4]=I_e,this._repaint()}else this.clear(),I_a&&this.drawTexture(I_a,I_b,I_c,I_d,I_e)},I_a.drawTextures=function(I_a,I_b){I_a&&this._saveToCmd(I_J._context._drawTextures,[I_a,I_b])},I_a.fillTexture=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){if(void 0===I_d&&(I_d=0),void 0===I_e&&(I_e=0),void 0===I_f&&(I_f="repeat"),I_a){var I_h=[I_a,I_b,I_c,I_d,I_e,I_f,I_g||I_A.EMPTY,{}];I_a.loaded||I_a.once("loaded",this,this._textureLoaded,[I_a,I_h]),this._saveToCmd(I_J._context._fillTexture,I_h)}},I_a._textureLoaded=function(I_a,I_b){I_b[3]=I_b[3]||I_a.width,I_b[4]=I_b[4]||I_a.height,this._repaint()},I_a.fillCircle=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){I_c.bitmap.enableMerageInAtlas=!1;var I_h=new Float32Array(2*(I_g+1)),I_i=new Float32Array(2*(I_g+1)),I_j=new Uint16Array(3*I_g),I_k=2*Math.PI/I_g,I_l=0;I_h[0]=I_d,I_h[1]=I_e,I_i[0]=I_d/I_c.width,I_i[1]=I_e/I_c.height;for(var I_m=2,I_n=0;I_n<I_g;I_n++){var I_o=I_f*Math.cos(I_l)+I_d,I_p=I_f*Math.sin(I_l)+I_e;I_h[I_m]=I_o,I_h[I_m+1]=I_p,I_i[I_m]=I_o/I_c.width,I_i[I_m+1]=I_p/I_c.height,I_l+=I_k,I_m+=2}for(I_n=I_m=0;I_n<I_g;I_n++)I_j[I_m++]=0,I_j[I_m++]=I_n+1,I_j[I_m++]=I_g+1<=I_n+2?1:I_n+2;this.drawTriangles(I_c,I_a,I_b,I_h,I_i,I_j)},I_a.drawTriangles=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){void 0===I_h&&(I_h=1),this._saveToCmd(I_J._context.drawTriangles,[I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j])},I_a._saveToCmd=function(I_a,I_b){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=I_b,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(I_b)),I_b.callee=I_a,this._repaint(),I_b},I_a.clipRect=function(I_a,I_b,I_c,I_d){this._saveToCmd(I_J._context._clipRect,[I_a,I_b,I_c,I_d])},I_a.fillText=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){void 0===I_g&&(I_g=0),this._saveToCmd(I_J._context._fillText,[I_a,I_b,I_c,I_d||I_n.defaultFont,I_e,I_f])},I_a.fillBorderText=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){this._saveToCmd(I_J._context._fillBorderText,[I_a,I_b,I_c,I_d||I_n.defaultFont,I_e,I_f,I_g,I_h])},I_a.strokeText=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this._saveToCmd(I_J._context._strokeText,[I_a,I_b,I_c,I_d||I_n.defaultFont,I_e,I_f,I_g])},I_a.alpha=function(I_a){I_a=I_a<0?0:1<I_a?1:I_a,this._saveToCmd(I_J._context._alpha,[I_a])},I_a.setAlpha=function(I_a){I_a=I_a<0?0:1<I_a?1:I_a,this._saveToCmd(I_J._context._setAlpha,[I_a])},I_a.transform=function(I_a,I_b,I_c){void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),this._saveToCmd(I_J._context._transform,[I_a,I_b,I_c])},I_a.rotate=function(I_a,I_b,I_c){void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),this._saveToCmd(I_J._context._rotate,[I_a,I_b,I_c])},I_a.scale=function(I_a,I_b,I_c,I_d){void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=0),this._saveToCmd(I_J._context._scale,[I_a,I_b,I_c,I_d])},I_a.translate=function(I_a,I_b){this._saveToCmd(I_J._context._translate,[I_a,I_b])},I_a.save=function(){this._saveToCmd(I_J._context._save,[])},I_a.restore=function(){this._saveToCmd(I_J._context._restore,[])},I_a.replaceText=function(I_a){this._repaint();var I_b=this._cmds;if(I_b){for(var I_c=I_b.length-1;-1<I_c;I_c--)if(this._isTextCmd(I_b[I_c].callee))return I_b[I_c][0].toUpperCase?I_b[I_c][0]=I_a:I_b[I_c][0].setText(I_a),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=I_a:this._one[0].setText(I_a),!0;return!1},I_a._isTextCmd=function(I_a){return I_a===I_J._context._fillText||I_a===I_J._context._fillBorderText||I_a===I_J._context._strokeText},I_a.replaceTextColor=function(I_a){this._repaint();var I_b=this._cmds;if(I_b)for(var I_c=I_b.length-1;-1<I_c;I_c--)this._isTextCmd(I_b[I_c].callee)&&(I_b[I_c][4]=I_a,I_b[I_c][0].toUpperCase||(I_b[I_c][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=I_a,this._one[0].toUpperCase||(this._one[0].changed=!0))},I_a.loadImage=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=this;void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=0),void 0===I_e&&(I_e=0);var I_h=I_ha.getRes(I_a);function I_i(I_a){I_a&&(I_g.drawTexture(I_a,I_b,I_c,I_d,I_e),null!=I_f&&I_f.call(I_g._sp,I_a))}I_h?I_i(I_h):I_z.loader.load(I_a,I_u.create(null,I_i),null,"image")},I_a._renderEmpty=function(I_a,I_b,I_c,I_d){},I_a._renderAll=function(I_a,I_b,I_c,I_d){for(var I_e,I_f=this._cmds,I_g=0,I_h=I_f.length;I_g<I_h;I_g++)(I_e=I_f[I_g]).callee.call(I_b,I_c,I_d,I_e)},I_a._renderOne=function(I_a,I_b,I_c,I_d){this._one.callee.call(I_b,I_c,I_d,this._one)},I_a._renderOneImg=function(I_a,I_b,I_c,I_d){this._one.callee.call(I_b,I_c,I_d,this._one),2305!==I_a._renderType&&(I_a._renderType|=1)},I_a.drawLine=function(I_a,I_b,I_c,I_d,I_e,I_f){void 0===I_f&&(I_f=1);var I_g=0;I_J.isWebGL&&(I_g=I__.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(I_g));var I_h=I_f%2==0?0:.5,I_i=[I_a+I_h,I_b+I_h,I_c+I_h,I_d+I_h,I_e,I_f,I_g];this._saveToCmd(I_J._context._drawLine,I_i)},I_a.drawLines=function(I_a,I_b,I_c,I_d,I_e){void 0===I_e&&(I_e=1);var I_f=0;if(I_c&&!(I_c.length<4)){I_J.isWebGL&&(I_f=I__.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(I_f));var I_g=I_e%2==0?0:.5,I_h=[I_a+I_g,I_b+I_g,I_c,I_d,I_e,I_f];this._saveToCmd(I_J._context._drawLines,I_h)}},I_a.drawCurves=function(I_a,I_b,I_c,I_d,I_e){void 0===I_e&&(I_e=1);var I_f=[I_a,I_b,I_c,I_d,I_e];this._saveToCmd(I_J._context._drawCurves,I_f)},I_a.drawRect=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){void 0===I_g&&(I_g=1);var I_h=I_f?I_g/2:0,I_i=I_f?I_g:0,I_j=[I_a+I_h,I_b+I_h,I_c-I_i,I_d-I_i,I_e,I_f,I_g];this._saveToCmd(I_J._context._drawRect,I_j)},I_a.drawCircle=function(I_a,I_b,I_c,I_d,I_e,I_f){void 0===I_f&&(I_f=1);var I_g=I_e?I_f/2:0,I_h=0;I_J.isWebGL&&(I_h=I__.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(I_h));var I_i=[I_a,I_b,I_c-I_g,I_d,I_e,I_f,I_h];this._saveToCmd(I_J._context._drawCircle,I_i)},I_a.drawPie=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){void 0===I_h&&(I_h=1);var I_i=I_g?I_h/2:0,I_j=I_g?I_h:0,I_k=0;I_J.isWebGL&&(I_k=I__.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(I_k));var I_l=[I_a+I_i,I_b+I_i,I_c-I_j,I_d,I_e,I_f,I_g,I_h,I_k];I_l[3]=I_$.toRadian(I_d),I_l[4]=I_$.toRadian(I_e),this._saveToCmd(I_J._context._drawPie,I_l)},I_a.drawPoly=function(I_a,I_b,I_c,I_d,I_e,I_f){void 0===I_f&&(I_f=1);var I_g=0,I_h=!1;I_J.isWebGL&&(I_g=I__.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(I_g),I_h=!(6<I_c.length));var I_i=I_e?I_f%2==0?0:.5:0,I_j=[I_a+I_i,I_b+I_i,I_c,I_d,I_e,I_f,I_g,I_h];this._saveToCmd(I_J._context._drawPoly,I_j)},I_a.drawPath=function(I_a,I_b,I_c,I_d,I_e){var I_f=[I_a,I_b,I_c,I_d,I_e];this._saveToCmd(I_J._context._drawPath,I_f)},I_o(0,I_a,"cmds",function(){return this._cmds},function(I_a){this._sp&&(this._sp._renderType|=512),this._cmds=I_a,this._render=this._renderAll,this._repaint()}),I_l.__init__=function(){if(I_J.isConchNode){for(var I_a=laya.display.Graphics.prototype,I_b=I_O.window.ConchGraphics.prototype,I_c=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],I_d=0,I_e=I_c.length;I_d<=I_e;I_d++){var I_f=I_c[I_d];I_a[I_f]=I_b[I_f]}I_a._saveToCmd=null,I_b.drawImageS&&(I_a.drawTextures=function(I_a,I_b){if(I_a&&I_a.loaded&&I_a.bitmap&&I_a.source){var I_c=I_a.uv,I_d=I_a.bitmap.width,I_e=I_a.bitmap.height;this.drawImageS(I_a.bitmap.source,I_c[0]*I_d,I_c[1]*I_e,(I_c[2]-I_c[0])*I_d,(I_c[5]-I_c[3])*I_e,I_a.offsetX,I_a.offsetY,I_a.width,I_a.height,I_b)}}),I_a.drawTexture=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){if(void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=0),void 0===I_e&&(I_e=0),void 0===I_g&&(I_g=1),I_a)if(I_a.loaded){if(I_a.loaded&&I_a.bitmap&&I_a.source&&(I_d||(I_d=I_a.sourceWidth),I_e||(I_e=I_a.sourceHeight),I_g=I_g<0?0:1<I_g?1:I_g,I_d=I_d-I_a.sourceWidth+I_a.width,I_e=I_e-I_a.sourceHeight+I_a.height,!(I_d<=0||I_e<=0))){I_b+=I_a.offsetX,I_c+=I_a.offsetY;var I_h=I_a.uv,I_i=I_a.bitmap.width,I_j=I_a.bitmap.height;I_h[4]<I_h[0]&&I_h[5]<I_h[1]?this.drawImageM(I_a.bitmap.source,I_h[4]*I_i,I_h[5]*I_j,(I_h[0]-I_h[4])*I_i,(I_h[1]-I_h[5])*I_j,I_b,I_c,I_d,I_e,I_f,I_g):this.drawImageM(I_a.bitmap.source,I_h[0]*I_i,I_h[1]*I_j,(I_h[2]-I_h[0])*I_i,(I_h[5]-I_h[3])*I_j,I_b,I_c,I_d,I_e,I_f,I_g),this._repaint()}}else I_a.once("loaded",this,function(){this.drawTexture(I_a,I_b,I_c,I_d,I_e,I_f)})},I_a.fillTexture=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){if(void 0===I_d&&(I_d=0),void 0===I_e&&(I_e=0),void 0===I_f&&(I_f="repeat"),I_a&&I_a.loaded){var I_h,I_i=I_J._context.ctx,I_j=I_a.bitmap.width,I_k=I_a.bitmap.height,I_l=I_a.uv;I_h=I_a.uv!=I_ka.DEF_UV?I_i.createPattern(I_a.bitmap.source,I_f,I_l[0]*I_j,I_l[1]*I_k,(I_l[2]-I_l[0])*I_j,(I_l[5]-I_l[3])*I_k):I_i.createPattern(I_a.bitmap.source,I_f);var I_m=0,I_n=0;I_g&&(I_b+=I_g.x%I_a.width,I_c+=I_g.y%I_a.height,I_m-=I_g.x%I_a.width,I_n-=I_g.y%I_a.height),this._fillImage(I_h,I_b,I_c,I_m,I_n,I_d,I_e)}}}},I_l._cache=[],I_l}(),I_c=function(){function I_v(){this._cacheBoundsType=!1}I_k(I_v,"laya.display.GraphicsBounds");var I_a=I_v.prototype;return I_a.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},I_a.reset=function(){this._temp&&(this._temp.length=0)},I_a.getBounds=function(I_a){return void 0===I_a&&(I_a=!1),(!this._bounds||!this._temp||this._temp.length<1||I_a!=this._cacheBoundsType)&&(this._bounds=I_B._getWrapRec(this.getBoundPoints(I_a),this._bounds)),this._cacheBoundsType=I_a,this._bounds},I_a.getBoundPoints=function(I_a){return void 0===I_a&&(I_a=!1),(!this._temp||this._temp.length<1||I_a!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(I_a)),this._cacheBoundsType=I_a,this._rstBoundPoints=I_$.copyArray(this._rstBoundPoints,this._temp)},I_a._getCmdPoints=function(I_a){void 0===I_a&&(I_a=!1);var I_b,I_c,I_d=I_J._context,I_e=this._graphics.cmds;if((I_b=this._temp||(this._temp=[])).length=0,I_e||null==this._graphics._one||(I_v._tempCmds.length=0,I_v._tempCmds.push(this._graphics._one),I_e=I_v._tempCmds),!I_e)return I_b;(I_c=I_v._tempMatrixArrays).length=0;var I_f=I_v._initMatrix;I_f.identity();for(var I_g,I_h,I_i=I_v._tempMatrix,I_j=NaN,I_k=NaN,I_l=NaN,I_m=NaN,I_n=NaN,I_o=NaN,I_p=0,I_s=I_e.length;I_p<I_s;I_p++)if((I_g=I_e[I_p]).callee)switch(I_g.callee){case I_d._save:case 7:I_c.push(I_f),I_f=I_f.clone();break;case I_d._restore:case 8:I_f=I_c.pop();break;case I_d._scale:case 5:I_i.identity(),I_i.translate(-I_g[2],-I_g[3]),I_i.scale(I_g[0],I_g[1]),I_i.translate(I_g[2],I_g[3]),this._switchMatrix(I_f,I_i);break;case I_d._rotate:case 3:I_i.identity(),I_i.translate(-I_g[1],-I_g[2]),I_i.rotate(I_g[0]),I_i.translate(I_g[1],I_g[2]),this._switchMatrix(I_f,I_i);break;case I_d._translate:case 6:I_i.identity(),I_i.translate(I_g[0],I_g[1]),this._switchMatrix(I_f,I_i);break;case I_d._transform:case 4:I_i.identity(),I_i.translate(-I_g[1],-I_g[2]),I_i.concat(I_g[0]),I_i.translate(I_g[1],I_g[2]),this._switchMatrix(I_f,I_i);break;case 16:case 24:I_v._addPointArrToRst(I_b,I_B._getBoundPointS(I_g[0],I_g[1],I_g[2],I_g[3]),I_f);break;case 17:I_f.copyTo(I_i),I_i.concat(I_g[4]),I_v._addPointArrToRst(I_b,I_B._getBoundPointS(I_g[0],I_g[1],I_g[2],I_g[3]),I_i);break;case I_d._drawTexture:I_h=I_g[0],I_a?I_g[3]&&I_g[4]?I_v._addPointArrToRst(I_b,I_B._getBoundPointS(I_g[1],I_g[2],I_g[3],I_g[4]),I_f):(I_h=I_g[0],I_v._addPointArrToRst(I_b,I_B._getBoundPointS(I_g[1],I_g[2],I_h.width,I_h.height),I_f)):(I_j=(I_g[3]||I_h.sourceWidth)/I_h.width,I_k=(I_g[4]||I_h.sourceHeight)/I_h.height,I_l=I_j*I_h.sourceWidth,I_m=I_k*I_h.sourceHeight,I_n=0<I_h.offsetX?I_h.offsetX:0,I_o=0<I_h.offsetY?I_h.offsetY:0,I_n*=I_j,I_o*=I_k,I_v._addPointArrToRst(I_b,I_B._getBoundPointS(I_g[1]-I_n,I_g[2]-I_o,I_l,I_m),I_f));break;case I_d._fillTexture:I_g[3]&&I_g[4]?I_v._addPointArrToRst(I_b,I_B._getBoundPointS(I_g[1],I_g[2],I_g[3],I_g[4]),I_f):(I_h=I_g[0],I_v._addPointArrToRst(I_b,I_B._getBoundPointS(I_g[1],I_g[2],I_h.width,I_h.height),I_f));break;case I_d._drawTextureWithTransform:var I_t;I_t=I_g[5]?(I_f.copyTo(I_i),I_i.concat(I_g[5]),I_i):I_f,I_a?I_g[3]&&I_g[4]?I_v._addPointArrToRst(I_b,I_B._getBoundPointS(I_g[1],I_g[2],I_g[3],I_g[4]),I_t):(I_h=I_g[0],I_v._addPointArrToRst(I_b,I_B._getBoundPointS(I_g[1],I_g[2],I_h.width,I_h.height),I_t)):(I_h=I_g[0],I_j=(I_g[3]||I_h.sourceWidth)/I_h.width,I_k=(I_g[4]||I_h.sourceHeight)/I_h.height,I_l=I_j*I_h.sourceWidth,I_m=I_k*I_h.sourceHeight,I_n=0<I_h.offsetX?I_h.offsetX:0,I_o=0<I_h.offsetY?I_h.offsetY:0,I_n*=I_j,I_o*=I_k,I_v._addPointArrToRst(I_b,I_B._getBoundPointS(I_g[1]-I_n,I_g[2]-I_o,I_l,I_m),I_t));break;case I_d._drawRect:case 13:I_v._addPointArrToRst(I_b,I_B._getBoundPointS(I_g[0],I_g[1],I_g[2],I_g[3]),I_f);break;case I_d._drawCircle:case I_d._fillCircle:case 14:I_v._addPointArrToRst(I_b,I_B._getBoundPointS(I_g[0]-I_g[2],I_g[1]-I_g[2],I_g[2]+I_g[2],I_g[2]+I_g[2]),I_f);break;case I_d._drawLine:case 20:I_v._tempPoints.length=0;var I_u;I_u=.5*I_g[5],I_g[0]==I_g[2]?I_v._tempPoints.push(I_g[0]+I_u,I_g[1],I_g[2]+I_u,I_g[3],I_g[0]-I_u,I_g[1],I_g[2]-I_u,I_g[3]):I_g[1]==I_g[3]?I_v._tempPoints.push(I_g[0],I_g[1]+I_u,I_g[2],I_g[3]+I_u,I_g[0],I_g[1]-I_u,I_g[2],I_g[3]-I_u):I_v._tempPoints.push(I_g[0],I_g[1],I_g[2],I_g[3]),I_v._addPointArrToRst(I_b,I_v._tempPoints,I_f);break;case I_d._drawCurves:case 22:I_v._addPointArrToRst(I_b,I_w.I.getBezierPoints(I_g[2]),I_f,I_g[0],I_g[1]);break;case I_d._drawPoly:case I_d._drawLines:case 18:I_v._addPointArrToRst(I_b,I_g[2],I_f,I_g[0],I_g[1]);break;case I_d._drawPath:case 19:I_v._addPointArrToRst(I_b,this._getPathPoints(I_g[2]),I_f,I_g[0],I_g[1]);break;case I_d._drawPie:case 15:I_v._addPointArrToRst(I_b,this._getPiePoints(I_g[0],I_g[1],I_g[2],I_g[3],I_g[4]),I_f)}return 200<I_b.length?I_b=I_$.copyArray(I_b,I_B._getWrapRec(I_b)._getBoundPoints()):8<I_b.length&&(I_b=I_x.scanPList(I_b)),I_b},I_a._switchMatrix=function(I_a,I_b){I_b.concat(I_a),I_b.copyTo(I_a)},I_a._getPiePoints=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_v._tempPoints;I_v._tempPoints.length=0,I_f.push(I_a,I_b);var I_g=(I_e-I_d)%(2*Math.PI)/10,I_h=NaN,I_i=I_d;for(I_h=0;I_h<=10;I_h++)I_f.push(I_a+I_c*Math.cos(I_i),I_b+I_c*Math.sin(I_i)),I_i+=I_g;return I_f},I_a._getPathPoints=function(I_a){var I_b,I_c,I_d=0,I_e=I_v._tempPoints;for(I_e.length=0,I_b=I_a.length,I_d=0;I_d<I_b;I_d++)1<(I_c=I_a[I_d]).length&&(I_e.push(I_c[1],I_c[2]),3<I_c.length&&I_e.push(I_c[3],I_c[4]));return I_e},I_v._addPointArrToRst=function(I_a,I_b,I_c,I_d,I_e){void 0===I_d&&(I_d=0),void 0===I_e&&(I_e=0);var I_f,I_g=0;for(I_f=I_b.length,I_g=0;I_g<I_f;I_g+=2)I_v._addPointToRst(I_a,I_b[I_g]+I_d,I_b[I_g+1]+I_e,I_c)},I_v._addPointToRst=function(I_a,I_b,I_c,I_d){var I_e=I_A.TEMP;I_e.setTo(I_b||0,I_c||0),I_d.transformPoint(I_e),I_a.push(I_e.x,I_e.y)},I_v._tempPoints=[],I_v._tempMatrixArrays=[],I_v._tempCmds=[],I_i(I_v,["_tempMatrix",function(){return this._tempMatrix=new I_G},"_initMatrix",function(){return this._initMatrix=new I_G}]),I_v}(),I_f=function(){function I_a(){}I_k(I_a,"laya.events.Event");var I_b=I_a.prototype;return I_b.setTo=function(I_a,I_b,I_c){return this.type=I_a,this.currentTarget=I_b,this.target=I_c,this},I_b.stopPropagation=function(){this._stoped=!0},I_o(0,I_b,"stageY",function(){return I_z.stage.mouseY}),I_o(0,I_b,"charCode",function(){return this.nativeEvent.charCode}),I_o(0,I_b,"touches",function(){var I_a=this.nativeEvent.touches;if(I_a)for(var I_b=I_z.stage,I_c=0,I_d=I_a.length;I_c<I_d;I_c++){var I_e=I_a[I_c],I_f=I_A.TEMP;I_f.setTo(I_e.clientX,I_e.clientY),I_b._canvasTransform.invertTransformPoint(I_f),I_b.transform.invertTransformPoint(I_f),I_e.stageX=I_f.x,I_e.stageY=I_f.y}return I_a}),I_o(0,I_b,"keyLocation",function(){return this.nativeEvent.keyLocation}),I_o(0,I_b,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),I_o(0,I_b,"altKey",function(){return this.nativeEvent.altKey}),I_o(0,I_b,"shiftKey",function(){return this.nativeEvent.shiftKey}),I_o(0,I_b,"stageX",function(){return I_z.stage.mouseX}),I_a.EMPTY=new I_a,I_a.MOUSE_DOWN="mousedown",I_a.MOUSE_UP="mouseup",I_a.CLICK="click",I_a.RIGHT_MOUSE_DOWN="rightmousedown",I_a.RIGHT_MOUSE_UP="rightmouseup",I_a.RIGHT_CLICK="rightclick",I_a.MOUSE_MOVE="mousemove",I_a.MOUSE_OVER="mouseover",I_a.MOUSE_OUT="mouseout",I_a.MOUSE_WHEEL="mousewheel",I_a.ROLL_OVER="mouseover",I_a.ROLL_OUT="mouseout",I_a.DOUBLE_CLICK="doubleclick",I_a.CHANGE="change",I_a.CHANGED="changed",I_a.RESIZE="resize",I_a.ADDED="added",I_a.REMOVED="removed",I_a.DISPLAY="display",I_a.UNDISPLAY="undisplay",I_a.ERROR="error",I_a.COMPLETE="complete",I_a.LOADED="loaded",I_a.INITED="inited",I_a.PROGRESS="progress",I_a.INPUT="input",I_a.RENDER="render",I_a.OPEN="open",I_a.MESSAGE="message",I_a.CLOSE="close",I_a.KEY_DOWN="keydown",I_a.KEY_PRESS="keypress",I_a.KEY_UP="keyup",I_a.FRAME="enterframe",I_a.DRAG_START="dragstart",I_a.DRAG_MOVE="dragmove",I_a.DRAG_END="dragend",I_a.ENTER="enter",I_a.SELECT="select",I_a.BLUR="blur",I_a.FOCUS="focus",I_a.VISIBILITY_CHANGE="visibilitychange",I_a.FOCUS_CHANGE="focuschange",I_a.PLAYED="played",I_a.PAUSED="paused",I_a.STOPPED="stopped",I_a.START="start",I_a.END="end",I_a.ENABLE_CHANGED="enablechanged",I_a.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",I_a.COMPONENT_ADDED="componentadded",I_a.COMPONENT_REMOVED="componentremoved",I_a.LAYER_CHANGED="layerchanged",I_a.HIERARCHY_LOADED="hierarchyloaded",I_a.RECOVERED="recovered",I_a.RELEASED="released",I_a.LINK="link",I_a.LABEL="label",I_a.FULL_SCREEN_CHANGE="fullscreenchange",I_a.DEVICE_LOST="devicelost",I_a.MESH_CHANGED="meshchanged",I_a.MATERIAL_CHANGED="materialchanged",I_a.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",I_a.ANIMATION_CHANGED="animationchanged",I_a.TRIGGER_ENTER="triggerenter",I_a.TRIGGER_STAY="triggerstay",I_a.TRIGGER_EXIT="triggerexit",I_a.TRAIL_FILTER_CHANGE="trailfilterchange",I_a.DOMINO_FILTER_CHANGE="dominofilterchange",I_a}(),I_l=(function(){function I_a(){}I_k(I_a,"laya.events.Keyboard"),I_a.NUMBER_0=48,I_a.NUMBER_1=49,I_a.NUMBER_2=50,I_a.NUMBER_3=51,I_a.NUMBER_4=52,I_a.NUMBER_5=53,I_a.NUMBER_6=54,I_a.NUMBER_7=55,I_a.NUMBER_8=56,I_a.NUMBER_9=57,I_a.A=65,I_a.B=66,I_a.C=67,I_a.D=68,I_a.E=69,I_a.F=70,I_a.G=71,I_a.H=72,I_a.I=73,I_a.J=74,I_a.K=75,I_a.L=76,I_a.M=77,I_a.N=78,I_a.O=79,I_a.P=80,I_a.Q=81,I_a.R=82,I_a.S=83,I_a.T=84,I_a.U=85,I_a.V=86,I_a.W=87,I_a.X=88,I_a.Y=89,I_a.Z=90,I_a.F1=112,I_a.F2=113,I_a.F3=114,I_a.F4=115,I_a.F5=116,I_a.F6=117,I_a.F7=118,I_a.F8=119,I_a.F9=120,I_a.F10=121,I_a.F11=122,I_a.F12=123,I_a.F13=124,I_a.F14=125,I_a.F15=126,I_a.NUMPAD=21,I_a.NUMPAD_0=96,I_a.NUMPAD_1=97,I_a.NUMPAD_2=98,I_a.NUMPAD_3=99,I_a.NUMPAD_4=100,I_a.NUMPAD_5=101,I_a.NUMPAD_6=102,I_a.NUMPAD_7=103,I_a.NUMPAD_8=104,I_a.NUMPAD_9=105,I_a.NUMPAD_ADD=107,I_a.NUMPAD_DECIMAL=110,I_a.NUMPAD_DIVIDE=111,I_a.NUMPAD_ENTER=108,I_a.NUMPAD_MULTIPLY=106,I_a.NUMPAD_SUBTRACT=109,I_a.SEMICOLON=186,I_a.EQUAL=187,I_a.COMMA=188,I_a.MINUS=189,I_a.PERIOD=190,I_a.SLASH=191,I_a.BACKQUOTE=192,I_a.LEFTBRACKET=219,I_a.BACKSLASH=220,I_a.RIGHTBRACKET=221,I_a.QUOTE=222,I_a.ALTERNATE=18,I_a.BACKSPACE=8,I_a.CAPS_LOCK=20,I_a.COMMAND=15,I_a.CONTROL=17,I_a.DELETE=46,I_a.ENTER=13,I_a.ESCAPE=27,I_a.PAGE_UP=33,I_a.PAGE_DOWN=34,I_a.END=35,I_a.HOME=36,I_a.LEFT=37,I_a.UP=38,I_a.RIGHT=39,I_a.DOWN=40,I_a.SHIFT=16,I_a.SPACE=32,I_a.TAB=9,I_a.INSERT=45}(),function(){function I_e(){}return I_k(I_e,"laya.events.KeyBoardManager"),I_e.__init__=function(){I_e._addEvent("keydown"),I_e._addEvent("keypress"),I_e._addEvent("keyup")},I_e._addEvent=function(I_b){I_O.document.addEventListener(I_b,function(I_a){laya.events.KeyBoardManager._dispatch(I_a,I_b)},!0)},I_e._dispatch=function(I_a,I_b){if(I_e.enabled){I_e._event._stoped=!1,I_e._event.nativeEvent=I_a,I_e._event.keyCode=I_a.keyCode||I_a.which||I_a.charCode,"keydown"===I_b?I_e._pressKeys[I_e._event.keyCode]=!0:"keyup"===I_b&&(I_e._pressKeys[I_e._event.keyCode]=null);for(var I_c=I_z.stage.focus&&null!=I_z.stage.focus.event&&I_z.stage.focus.displayedInStage?I_z.stage.focus:I_z.stage,I_d=I_c;I_d;)I_d.event(I_b,I_e._event.setTo(I_b,I_d,I_c)),I_d=I_d.parent}},I_e.hasKeyDown=function(I_a){return I_e._pressKeys[I_a]},I_e._pressKeys={},I_e.enabled=!0,I_i(I_e,["_event",function(){return this._event=new I_f}]),I_e}()),I_p=(function(){function I_a(){}I_k(I_a,"laya.events.KeyLocation"),I_a.STANDARD=0,I_a.LEFT=1,I_a.RIGHT=2,I_a.NUM_PAD=3}(),function(){function I_j(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=I_O.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new I_f,this._matrix=new I_G,this._point=new I_A,this._rect=new I_B,this._prePoint=new I_A,this._curTouchID=NaN}I_k(I_j,"laya.events.MouseManager");var I_a=I_j.prototype;return I_a.__init__=function(I_a,I_b){var I_c=this;this._stage=I_a;var I_d=this,I_e=this._eventList;I_b.oncontextmenu=function(I_a){if(I_j.enabled)return!1},I_b.addEventListener("mousedown",function(I_a){I_j.enabled&&(I_O.onIE||I_a.preventDefault(),I_e.push(I_a),I_d.mouseDownTime=I_O.now())}),I_b.addEventListener("mouseup",function(I_a){I_j.enabled&&(I_a.preventDefault(),I_e.push(I_a),I_d.mouseDownTime=-I_O.now())},!0),I_b.addEventListener("mousemove",function(I_a){if(I_j.enabled){I_a.preventDefault();var I_b=I_O.now();if(I_b-I_d._lastMoveTimer<10)return;I_d._lastMoveTimer=I_b,I_e.push(I_a)}},!0),I_b.addEventListener("mouseout",function(I_a){I_j.enabled&&I_e.push(I_a)}),I_b.addEventListener("mouseover",function(I_a){I_j.enabled&&I_e.push(I_a)}),I_b.addEventListener("touchstart",function(I_a){I_j.enabled&&(I_e.push(I_a),I_j._isFirstTouch||I_xa.isInputting||I_a.preventDefault(),I_d.mouseDownTime=I_O.now())}),I_b.addEventListener("touchend",function(I_a){I_j.enabled?(I_j._isFirstTouch||I_xa.isInputting||I_a.preventDefault(),I_j._isFirstTouch=!1,I_e.push(I_a),I_d.mouseDownTime=-I_O.now()):I_c._curTouchID=NaN},!0),I_b.addEventListener("touchmove",function(I_a){I_j.enabled&&(I_a.preventDefault(),I_e.push(I_a))},!0),I_b.addEventListener("touchcancel",function(I_a){I_j.enabled?(I_a.preventDefault(),I_e.push(I_a)):I_c._curTouchID=NaN},!0),I_b.addEventListener("mousewheel",function(I_a){I_j.enabled&&I_e.push(I_a)}),I_b.addEventListener("DOMMouseScroll",function(I_a){I_j.enabled&&I_e.push(I_a)})},I_a.initEvent=function(I_a,I_b){var I_c;this._event._stoped=!1,this._event.nativeEvent=I_b||I_a,this._target=null,this._point.setTo(I_a.pageX||I_a.clientX,I_a.pageY||I_a.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=I_a.identifier||0,this._tTouchID=this._event.touchId,(I_c=I_s.I._event)._stoped=!1,I_c.nativeEvent=this._event.nativeEvent,I_c.touchId=this._event.touchId},I_a.checkMouseWheel=function(I_a){this._event.delta=I_a.wheelDelta?.025*I_a.wheelDelta:-I_a.detail;for(var I_b=I_s.I.getLastOvers(),I_c=0,I_d=I_b.length;I_c<I_d;I_c++){var I_e=I_b[I_c];I_e.event("mousewheel",this._event.setTo("mousewheel",I_e,this._target))}},I_a.onMouseMove=function(I_a){I_s.I.onMouseMove(I_a,this._tTouchID)},I_a.onMouseDown=function(I_a){if(I_xa.isInputting&&I_z.stage.focus&&I_z.stage.focus.focus&&!I_z.stage.focus.contains(this._target)){var I_b=I_z.stage.focus._tf||I_z.stage.focus,I_c=I_a._tf||I_a;I_c instanceof laya.display.Input&&I_c.multiline==I_b.multiline?I_b._focusOut():I_b.focus=!1}I_s.I.onMouseDown(I_a,this._tTouchID,this._isLeftMouse)},I_a.onMouseUp=function(I_a){I_s.I.onMouseUp(I_a,this._tTouchID,this._isLeftMouse)},I_a.check=function(I_a,I_b,I_c,I_d){this._point.setTo(I_b,I_c),I_a.fromParentPoint(this._point),I_b=this._point.x,I_c=this._point.y;var I_e=I_a.scrollRect;if(I_e&&(this._rect.setTo(I_e.x,I_e.y,I_e.width,I_e.height),!this._rect.contains(I_b,I_c)))return!1;if(!this.disableMouseEvent){if(I_a.hitTestPrior&&!I_a.mouseThrough&&!this.hitTest(I_a,I_b,I_c))return!1;for(var I_f=I_a._childs.length-1;-1<I_f;I_f--){var I_g=I_a._childs[I_f];if(!I_g.destroyed&&I_g.mouseEnabled&&I_g.visible&&this.check(I_g,I_b,I_c,I_d))return!0}}var I_h=!(!I_a.hitTestPrior||I_a.mouseThrough||this.disableMouseEvent)||this.hitTest(I_a,I_b,I_c);return I_h?(this._target=I_a,I_d.call(this,I_a)):I_d===this.onMouseUp&&I_a===this._stage&&(this._target=this._stage,I_d.call(this,this._target)),I_h},I_a.hitTest=function(I_a,I_b,I_c){var I_d=!1;if(I_a.scrollRect&&(I_b-=I_a.scrollRect.x,I_c-=I_a.scrollRect.y),I_a.hitArea instanceof laya.utils.HitArea)return I_a.hitArea.isHit(I_b,I_c);if(0<I_a.width&&0<I_a.height||I_a.mouseThrough||I_a.hitArea)if(I_a.mouseThrough)I_d=I_a.getGraphicBounds().contains(I_b,I_c);else{var I_e=this._rect;I_a.hitArea?I_e=I_a.hitArea:I_e.setTo(0,0,I_a.width,I_a.height),I_d=I_e.contains(I_b,I_c)}return I_d},I_a.runEvent=function(){var I_a=this._eventList.length;if(I_a){this.mouseEventTime=I_O.now();var I_b,I_c=0,I_d=0,I_e=0;try{for(;I_c<I_a;){var I_f=this._eventList[I_c];switch("mousemove"!==I_f.type&&(this._prePoint.x=this._prePoint.y=-1e6),I_f.type){case"mousedown":this._touchIDs[0]=this._id++,I_j._isTouchRespond?I_j._isTouchRespond=!1:(this._isLeftMouse=0===I_f.button,this.initEvent(I_f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===I_f.button,this.initEvent(I_f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-I_f.clientX)+Math.abs(this._prePoint.y-I_f.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=I_f.clientX,this._prePoint.y=I_f.clientY,this.initEvent(I_f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":I_j._isTouchRespond=!0,this._isLeftMouse=!0;var I_g=I_f.changedTouches;for(I_d=0,I_e=I_g.length;I_d<I_e;I_d++)I_b=I_g[I_d],(I_j.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=I_b.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[I_b.identifier]=this._id++,this.initEvent(I_b,I_f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":I_j._isTouchRespond=!0,this._isLeftMouse=!0;var I_h=I_f.changedTouches;for(I_d=0,I_e=I_h.length;I_d<I_e;I_d++)if(I_b=I_h[I_d],I_j.multiTouchEnabled||I_b.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(I_b,I_f);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var I_i=I_f.changedTouches;for(I_d=0,I_e=I_i.length;I_d<I_e;I_d++)I_b=I_i[I_d],(I_j.multiTouchEnabled||I_b.identifier==this._curTouchID)&&(this.initEvent(I_b,I_f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(I_f);break;case"mouseout":I_s.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}I_c++}}catch(I_a){throw this._eventList.length=0,I_a}this._eventList.length=0}},I_j.enabled=!0,I_j.multiTouchEnabled=!0,I_j._isTouchRespond=!1,I_j._isFirstTouch=!0,I_i(I_j,["instance",function(){return this.instance=new I_j}]),I_j}()),I_s=function(){function I_o(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new I_f}I_k(I_o,"laya.events.TouchManager");var I_a=I_o.prototype;return I_a._clearTempArrs=function(){I_o._oldArr.length=0,I_o._newArr.length=0,I_o._tEleArr.length=0},I_a.getTouchFromArr=function(I_a,I_b){var I_c,I_d,I_e=0;for(I_c=I_b.length,I_e=0;I_e<I_c;I_e++)if((I_d=I_b[I_e]).id==I_a)return I_d;return null},I_a.removeTouchFromArr=function(I_a,I_b){var I_c=0;for(I_c=I_b.length-1;0<=I_c;I_c--)I_b[I_c].id==I_a&&I_b.splice(I_c,1)},I_a.createTouchO=function(I_a,I_b){var I_c;return(I_c=I_W.getItem("TouchData")||{}).id=I_b,I_c.tar=I_a,I_c},I_a.onMouseDown=function(I_a,I_b,I_c){var I_d,I_e,I_f,I_g;(void 0===I_c&&(I_c=!1),this.enable)&&(I_d=this.getTouchFromArr(I_b,this.preOvers),I_f=this.getEles(I_a,null,I_o._tEleArr),I_d?I_d.tar=I_a:(I_e=this.createTouchO(I_a,I_b),this.preOvers.push(I_e)),I_O.onMobile&&this.sendEvents(I_f,"mouseover",I_b),I_g=I_c?this.preDowns:this.preRightDowns,(I_d=this.getTouchFromArr(I_b,I_g))?I_d.tar=I_a:(I_e=this.createTouchO(I_a,I_b),I_g.push(I_e)),this.sendEvents(I_f,I_c?"mousedown":"rightmousedown",I_b),this._clearTempArrs())},I_a.sendEvents=function(I_a,I_b,I_c){void 0===I_c&&(I_c=0);var I_d,I_e,I_f,I_g=0;for(I_d=I_a.length,this._event._stoped=!1,I_e=I_a[0],I_g=0;I_g<I_d;I_g++){if((I_f=I_a[I_g]).destroyed)return;if(I_f.event(I_b,this._event.setTo(I_b,I_f,I_e)),this._event._stoped)break}},I_a.getEles=function(I_a,I_b,I_c){for(I_c?I_c.length=0:I_c=[];I_a&&I_a!=I_b;)I_c.push(I_a),I_a=I_a.parent;return I_c},I_a.checkMouseOutAndOverOfMove=function(I_a,I_b,I_c){if(void 0===I_c&&(I_c=0),I_b!=I_a){var I_d,I_e,I_f=0,I_g=0;if(I_b.contains(I_a))I_e=this.getEles(I_a,I_b,I_o._tEleArr),this.sendEvents(I_e,"mouseover",I_c);else if(I_a.contains(I_b))I_e=this.getEles(I_b,I_a,I_o._tEleArr),this.sendEvents(I_e,"mouseout",I_c);else{var I_h,I_i;(I_e=I_o._tEleArr).length=0,I_h=this.getEles(I_b,null,I_o._oldArr),I_i=this.getEles(I_a,null,I_o._newArr),I_g=I_h.length;var I_j=0;for(I_f=0;I_f<I_g;I_f++){if(I_d=I_h[I_f],0<=(I_j=I_i.indexOf(I_d))){I_i.splice(I_j,I_i.length-I_j);break}I_e.push(I_d)}0<I_e.length&&this.sendEvents(I_e,"mouseout",I_c),0<I_i.length&&this.sendEvents(I_i,"mouseover",I_c)}}},I_a.onMouseMove=function(I_a,I_b){var I_c,I_d;this.enable&&((I_c=this.getTouchFromArr(I_b,this.preOvers))?(this.checkMouseOutAndOverOfMove(I_a,I_c.tar),I_c.tar=I_a,I_d=this.getEles(I_a,null,I_o._tEleArr)):(I_d=this.getEles(I_a,null,I_o._tEleArr),this.sendEvents(I_d,"mouseover",I_b),this.preOvers.push(this.createTouchO(I_a,I_b))),this.sendEvents(I_d,"mousemove",I_b),this._clearTempArrs())},I_a.getLastOvers=function(){return(I_o._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,I_o._tEleArr):(I_o._tEleArr.push(I_z.stage),I_o._tEleArr)},I_a.stageMouseOut=function(){var I_a;I_a=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(I_a,"mouseout",0)},I_a.onMouseUp=function(I_a,I_b,I_c){if(void 0===I_c&&(I_c=!1),this.enable){var I_d,I_e,I_f,I_g,I_h,I_i,I_j=0,I_k=0,I_l=I_O.onMobile;if(I_e=this.getEles(I_a,null,I_o._tEleArr),this.sendEvents(I_e,I_c?"mouseup":"rightmouseup",I_b),I_i=I_c?this.preDowns:this.preRightDowns,I_d=this.getTouchFromArr(I_b,I_i)){var I_m,I_n=I_O.now();if(I_m=I_n-this._lastClickTime<300,this._lastClickTime=I_n,I_a==I_d.tar)I_h=I_e;else for(I_f=this.getEles(I_d.tar,null,I_o._oldArr),(I_h=I_o._newArr).length=0,I_k=I_f.length,I_j=0;I_j<I_k;I_j++)I_g=I_f[I_j],0<=I_e.indexOf(I_g)&&I_h.push(I_g);0<I_h.length&&this.sendEvents(I_h,I_c?"click":"rightclick",I_b),I_c&&I_m&&this.sendEvents(I_h,"doubleclick",I_b),this.removeTouchFromArr(I_b,I_i),I_d.tar=null,I_W.recover("TouchData",I_d)}else;(I_d=this.getTouchFromArr(I_b,this.preOvers))&&I_l&&((I_h=this.getEles(I_d.tar,null,I_h))&&0<I_h.length&&this.sendEvents(I_h,"mouseout",I_b),this.removeTouchFromArr(I_b,this.preOvers),I_d.tar=null,I_W.recover("TouchData",I_d)),this._clearTempArrs()}},I_o._oldArr=[],I_o._newArr=[],I_o._tEleArr=[],I_i(I_o,["I",function(){return this.I=new I_o}]),I_o}(),I_t=function(){function I_a(){this._action=null}I_k(I_a,"laya.filters.Filter");var I_b=I_a.prototype;return I_z.imps(I_b,{"laya.filters.IFilter":!0}),I_b.callNative=function(I_a){},I_o(0,I_b,"type",function(){return-1}),I_o(0,I_b,"action",function(){return this._action}),I_a.BLUR=16,I_a.COLOR=32,I_a.GLOW=8,I_a._filterStart=null,I_a._filterEnd=null,I_a._EndTarget=null,I_a._recycleScope=null,I_a._filter=null,I_a._useSrc=null,I_a._endSrc=null,I_a._useOut=null,I_a._endOut=null,I_a}(),I_v=function(){function I_a(){this.data=null}I_k(I_a,"laya.filters.ColorFilterAction");var I_b=I_a.prototype;return I_z.imps(I_b,{"laya.filters.IFilterAction":!0}),I_b.apply=function(I_a){var I_b=I_a.ctx.ctx,I_c=I_a.ctx.ctx.canvas;if(0==I_c.width||0==I_c.height)return I_c;for(var I_d,I_e=I_b.getImageData(0,0,I_c.width,I_c.height),I_f=I_e.data,I_g=0,I_h=I_f.length;I_g<I_h;I_g+=4)I_d=this.getColor(I_f[I_g],I_f[I_g+1],I_f[I_g+2],I_f[I_g+3]),0!=I_f[I_g+3]&&(I_f[I_g]=I_d[0],I_f[I_g+1]=I_d[1],I_f[I_g+2]=I_d[2],I_f[I_g+3]=I_d[3]);return I_b.putImageData(I_e,0,0),I_a},I_b.getColor=function(I_a,I_b,I_c,I_d){var I_e=[];if(this.data._mat&&this.data._alpha){var I_f=this.data._mat,I_g=this.data._alpha;I_e[0]=I_f[0]*I_a+I_f[1]*I_b+I_f[2]*I_c+I_f[3]*I_d+I_g[0],I_e[1]=I_f[4]*I_a+I_f[5]*I_b+I_f[6]*I_c+I_f[7]*I_d+I_g[1],I_e[2]=I_f[8]*I_a+I_f[9]*I_b+I_f[10]*I_c+I_f[11]*I_d+I_g[2],I_e[3]=I_f[12]*I_a+I_f[13]*I_b+I_f[14]*I_c+I_f[15]*I_d+I_g[3]}return I_e},I_a}(),I_w=(function(){function I_a(){}I_k(I_a,"laya.maths.Arith"),I_a.formatR=function(I_a){return I_a>Math.PI&&(I_a-=2*Math.PI),I_a<-Math.PI&&(I_a+=2*Math.PI),I_a},I_a.isPOT=function(I_a,I_b){return 0<I_a&&0==(I_a&I_a-1)&&0<I_b&&0==(I_b&I_b-1)},I_a.setMatToArray=function(I_a,I_b){I_a.a,I_a.b,I_a.c,I_a.d,I_a.tx,I_a.ty,I_b[0]=I_a.a,I_b[1]=I_a.b,I_b[4]=I_a.c,I_b[5]=I_a.d,I_b[12]=I_a.tx,I_b[13]=I_a.ty}}(),function(){function I_a(){this._controlPoints=[new I_A,new I_A,new I_A],this._calFun=this.getPoint2}I_k(I_a,"laya.maths.Bezier");var I_b=I_a.prototype;return I_b._switchPoint=function(I_a,I_b){var I_c=this._controlPoints.shift();I_c.setTo(I_a,I_b),this._controlPoints.push(I_c)},I_b.getPoint2=function(I_a,I_b){var I_c=this._controlPoints[0],I_d=this._controlPoints[1],I_e=this._controlPoints[2],I_f=Math.pow(1-I_a,2)*I_c.x+2*I_a*(1-I_a)*I_d.x+Math.pow(I_a,2)*I_e.x,I_g=Math.pow(1-I_a,2)*I_c.y+2*I_a*(1-I_a)*I_d.y+Math.pow(I_a,2)*I_e.y;I_b.push(I_f,I_g)},I_b.getPoint3=function(I_a,I_b){var I_c=this._controlPoints[0],I_d=this._controlPoints[1],I_e=this._controlPoints[2],I_f=this._controlPoints[3],I_g=Math.pow(1-I_a,3)*I_c.x+3*I_d.x*I_a*(1-I_a)*(1-I_a)+3*I_e.x*I_a*I_a*(1-I_a)+I_f.x*Math.pow(I_a,3),I_h=Math.pow(1-I_a,3)*I_c.y+3*I_d.y*I_a*(1-I_a)*(1-I_a)+3*I_e.y*I_a*I_a*(1-I_a)+I_f.y*Math.pow(I_a,3);I_b.push(I_g,I_h)},I_b.insertPoints=function(I_a,I_b){var I_c,I_d=NaN;for(I_c=1/(I_a=0<I_a?I_a:5),I_d=0;I_d<=1;I_d+=I_c)this._calFun(I_d,I_b)},I_b.getBezierPoints=function(I_a,I_b,I_c){void 0===I_b&&(I_b=5),void 0===I_c&&(I_c=2);var I_d,I_e,I_f=0;if((I_d=I_a.length)<2*(I_c+1))return[];switch(I_e=[],I_c){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=I_c;)this._controlPoints.push(new I_A);for(I_f=0;I_f<2*I_c;I_f+=2)this._switchPoint(I_a[I_f],I_a[I_f+1]);for(I_f=2*I_c;I_f<I_d;I_f+=2)this._switchPoint(I_a[I_f],I_a[I_f+1]),I_f/2%I_c==0&&this.insertPoints(I_b,I_e);return I_e},I_i(I_a,["I",function(){return this.I=new I_a}]),I_a}()),I_x=function(){function I_j(){}return I_k(I_j,"laya.maths.GrahamScan"),I_j.multiply=function(I_a,I_b,I_c){return(I_a.x-I_c.x)*(I_b.y-I_c.y)-(I_b.x-I_c.x)*(I_a.y-I_c.y)},I_j.dis=function(I_a,I_b){return(I_a.x-I_b.x)*(I_a.x-I_b.x)+(I_a.y-I_b.y)*(I_a.y-I_b.y)},I_j._getPoints=function(I_a,I_b,I_c){for(void 0===I_b&&(I_b=!1),I_j._mPointList||(I_j._mPointList=[]);I_j._mPointList.length<I_a;)I_j._mPointList.push(new I_A);return I_c||(I_c=[]),I_c.length=0,I_b?I_j.getFrom(I_c,I_j._mPointList,I_a):I_j.getFromR(I_c,I_j._mPointList,I_a),I_c},I_j.getFrom=function(I_a,I_b,I_c){var I_d=0;for(I_d=0;I_d<I_c;I_d++)I_a.push(I_b[I_d]);return I_a},I_j.getFromR=function(I_a,I_b,I_c){var I_d=0;for(I_d=0;I_d<I_c;I_d++)I_a.push(I_b.pop());return I_a},I_j.pListToPointList=function(I_a,I_b){void 0===I_b&&(I_b=!1);var I_c=0,I_d=I_a.length/2,I_e=I_j._getPoints(I_d,I_b,I_j._tempPointList);for(I_c=0;I_c<I_d;I_c++)I_e[I_c].setTo(I_a[I_c+I_c],I_a[I_c+I_c+1]);return I_e},I_j.pointListToPlist=function(I_a){var I_b,I_c=0,I_d=I_a.length,I_e=I_j._temPList;for(I_c=I_e.length=0;I_c<I_d;I_c++)I_b=I_a[I_c],I_e.push(I_b.x,I_b.y);return I_e},I_j.scanPList=function(I_a){return I_$.copyArray(I_a,I_j.pointListToPlist(I_j.scan(I_j.pListToPointList(I_a,!0))))},I_j.scan=function(I_a){var I_b,I_c,I_d,I_e=0,I_f=0,I_g=0,I_h=I_a.length,I_i={};for((I_c=I_j._temArr).length=0,I_e=(I_h=I_a.length)-1;0<=I_e;I_e--)I_d=(I_b=I_a[I_e]).x+"_"+I_b.y,I_i.hasOwnProperty(I_d)||(I_i[I_d]=!0,I_c.push(I_b));for(I_h=I_c.length,I_$.copyArray(I_a,I_c),I_e=1;I_e<I_h;I_e++)(I_a[I_e].y<I_a[I_g].y||I_a[I_e].y==I_a[I_g].y&&I_a[I_e].x<I_a[I_g].x)&&(I_g=I_e);for(I_b=I_a[0],I_a[0]=I_a[I_g],I_a[I_g]=I_b,I_e=1;I_e<I_h-1;I_e++){for(I_f=(I_g=I_e)+1;I_f<I_h;I_f++)(0<I_j.multiply(I_a[I_f],I_a[I_g],I_a[0])||0==I_j.multiply(I_a[I_f],I_a[I_g],I_a[0])&&I_j.dis(I_a[0],I_a[I_f])<I_j.dis(I_a[0],I_a[I_g]))&&(I_g=I_f);I_b=I_a[I_e],I_a[I_e]=I_a[I_g],I_a[I_g]=I_b}if((I_c=I_j._temArr).length=0,I_a.length<3)return I_$.copyArray(I_c,I_a);for(I_c.push(I_a[0],I_a[1],I_a[2]),I_e=3;I_e<I_h;I_e++){for(;2<=I_c.length&&0<=I_j.multiply(I_a[I_e],I_c[I_c.length-1],I_c[I_c.length-2]);)I_c.pop();I_a[I_e]&&I_c.push(I_a[I_e])}return I_c},I_j._mPointList=null,I_j._tempPointList=[],I_j._temPList=[],I_j._temArr=[],I_j}(),I_y=function(){function I_e(){}return I_k(I_e,"laya.maths.MathUtil"),I_e.subtractVector3=function(I_a,I_b,I_c){I_c[0]=I_a[0]-I_b[0],I_c[1]=I_a[1]-I_b[1],I_c[2]=I_a[2]-I_b[2]},I_e.lerp=function(I_a,I_b,I_c){return I_a*(1-I_c)+I_b*I_c},I_e.scaleVector3=function(I_a,I_b,I_c){I_c[0]=I_a[0]*I_b,I_c[1]=I_a[1]*I_b,I_c[2]=I_a[2]*I_b},I_e.lerpVector3=function(I_a,I_b,I_c,I_d){var I_e=I_a[0],I_f=I_a[1],I_g=I_a[2];I_d[0]=I_e+I_c*(I_b[0]-I_e),I_d[1]=I_f+I_c*(I_b[1]-I_f),I_d[2]=I_g+I_c*(I_b[2]-I_g)},I_e.lerpVector4=function(I_a,I_b,I_c,I_d){var I_e=I_a[0],I_f=I_a[1],I_g=I_a[2],I_h=I_a[3];I_d[0]=I_e+I_c*(I_b[0]-I_e),I_d[1]=I_f+I_c*(I_b[1]-I_f),I_d[2]=I_g+I_c*(I_b[2]-I_g),I_d[3]=I_h+I_c*(I_b[3]-I_h)},I_e.slerpQuaternionArray=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){var I_h,I_i,I_j,I_k,I_l,I_m=I_a[I_b+0],I_n=I_a[I_b+1],I_o=I_a[I_b+2],I_p=I_a[I_b+3],I_s=I_c[I_d+0],I_t=I_c[I_d+1],I_u=I_c[I_d+2],I_v=I_c[I_d+3];return(I_i=I_m*I_s+I_n*I_t+I_o*I_u+I_p*I_v)<0&&(I_i=-I_i,I_s=-I_s,I_t=-I_t,I_u=-I_u,I_v=-I_v),I_l=1e-6<1-I_i?(I_h=Math.acos(I_i),I_j=Math.sin(I_h),I_k=Math.sin((1-I_e)*I_h)/I_j,Math.sin(I_e*I_h)/I_j):(I_k=1-I_e,I_e),I_f[I_g+0]=I_k*I_m+I_l*I_s,I_f[I_g+1]=I_k*I_n+I_l*I_t,I_f[I_g+2]=I_k*I_o+I_l*I_u,I_f[I_g+3]=I_k*I_p+I_l*I_v,I_f},I_e.getRotation=function(I_a,I_b,I_c,I_d){return Math.atan2(I_d-I_b,I_c-I_a)/Math.PI*180},I_e.sortBigFirst=function(I_a,I_b){return I_a==I_b?0:I_a<I_b?1:-1},I_e.sortSmallFirst=function(I_a,I_b){return I_a==I_b?0:I_a<I_b?-1:1},I_e.sortNumBigFirst=function(I_a,I_b){return parseFloat(I_b)-parseFloat(I_a)},I_e.sortNumSmallFirst=function(I_a,I_b){return parseFloat(I_a)-parseFloat(I_b)},I_e.sortByKey=function(I_c,I_a,I_b){var I_d;return void 0===I_a&&(I_a=!1),void 0===I_b&&(I_b=!0),I_d=I_a?I_b?I_e.sortNumBigFirst:I_e.sortBigFirst:I_b?I_e.sortNumSmallFirst:I_e.sortSmallFirst,function(I_a,I_b){return I_d(I_a[I_c],I_b[I_c])}},I_e}(),I_G=function(){function I_c(I_a,I_b,I_c,I_d,I_e,I_f){this.inPool=!1,this.bTransform=!1,void 0===I_a&&(I_a=1),void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=1),void 0===I_e&&(I_e=0),void 0===I_f&&(I_f=0),this.a=I_a,this.b=I_b,this.c=I_c,this.d=I_d,this.tx=I_e,this.ty=I_f,this._checkTransform()}I_k(I_c,"laya.maths.Matrix");var I_a=I_c.prototype;return I_a.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},I_a._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},I_a.setTranslate=function(I_a,I_b){return this.tx=I_a,this.ty=I_b,this},I_a.translate=function(I_a,I_b){return this.tx+=I_a,this.ty+=I_b,this},I_a.scale=function(I_a,I_b){this.a*=I_a,this.d*=I_b,this.c*=I_a,this.b*=I_b,this.tx*=I_a,this.ty*=I_b,this.bTransform=!0},I_a.rotate=function(I_a){var I_b=Math.cos(I_a),I_c=Math.sin(I_a),I_d=this.a,I_e=this.c,I_f=this.tx;this.a=I_d*I_b-this.b*I_c,this.b=I_d*I_c+this.b*I_b,this.c=I_e*I_b-this.d*I_c,this.d=I_e*I_c+this.d*I_b,this.tx=I_f*I_b-this.ty*I_c,this.ty=I_f*I_c+this.ty*I_b,this.bTransform=!0},I_a.skew=function(I_a,I_b){var I_c=Math.tan(I_a),I_d=Math.tan(I_b),I_e=this.a,I_f=this.b;return this.a+=I_d*this.c,this.b+=I_d*this.d,this.c+=I_c*I_e,this.d+=I_c*I_f,this},I_a.invertTransformPoint=function(I_a){var I_b=this.a,I_c=this.b,I_d=this.c,I_e=this.d,I_f=this.tx,I_g=I_b*I_e-I_c*I_d,I_h=I_e/I_g,I_i=-I_c/I_g,I_j=-I_d/I_g,I_k=I_b/I_g,I_l=(I_d*this.ty-I_e*I_f)/I_g,I_m=-(I_b*this.ty-I_c*I_f)/I_g;return I_a.setTo(I_h*I_a.x+I_j*I_a.y+I_l,I_i*I_a.x+I_k*I_a.y+I_m)},I_a.transformPoint=function(I_a){return I_a.setTo(this.a*I_a.x+this.c*I_a.y+this.tx,this.b*I_a.x+this.d*I_a.y+this.ty)},I_a.transformPointN=function(I_a){return I_a.setTo(this.a*I_a.x+this.c*I_a.y,this.b*I_a.x+this.d*I_a.y)},I_a.transformPointArray=function(I_a,I_b){for(var I_c=I_a.length,I_d=0;I_d<I_c;I_d+=2){var I_e=I_a[I_d],I_f=I_a[I_d+1];I_b[I_d]=this.a*I_e+this.c*I_f+this.tx,I_b[I_d+1]=this.b*I_e+this.d*I_f+this.ty}return I_b},I_a.transformPointArrayScale=function(I_a,I_b){for(var I_c=I_a.length,I_d=0;I_d<I_c;I_d+=2){var I_e=I_a[I_d],I_f=I_a[I_d+1];I_b[I_d]=this.a*I_e+this.c*I_f,I_b[I_d+1]=this.b*I_e+this.d*I_f}return I_b},I_a.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},I_a.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},I_a.invert=function(){var I_a=this.a,I_b=this.b,I_c=this.c,I_d=this.d,I_e=this.tx,I_f=I_a*I_d-I_b*I_c;return this.a=I_d/I_f,this.b=-I_b/I_f,this.c=-I_c/I_f,this.d=I_a/I_f,this.tx=(I_c*this.ty-I_d*I_e)/I_f,this.ty=-(I_a*this.ty-I_b*I_e)/I_f,this},I_a.setTo=function(I_a,I_b,I_c,I_d,I_e,I_f){return this.a=I_a,this.b=I_b,this.c=I_c,this.d=I_d,this.tx=I_e,this.ty=I_f,this},I_a.concat=function(I_a){var I_b=this.a,I_c=this.c,I_d=this.tx;return this.a=I_b*I_a.a+this.b*I_a.c,this.b=I_b*I_a.b+this.b*I_a.d,this.c=I_c*I_a.a+this.d*I_a.c,this.d=I_c*I_a.b+this.d*I_a.d,this.tx=I_d*I_a.a+this.ty*I_a.c+I_a.tx,this.ty=I_d*I_a.b+this.ty*I_a.d+I_a.ty,this},I_a.scaleEx=function(I_a,I_b){var I_c=this.a,I_d=this.b,I_e=this.c,I_f=this.d;0!==I_d||0!==I_e?(this.a=I_a*I_c,this.b=I_a*I_d,this.c=I_b*I_e):(this.a=I_a*I_c,this.b=0*I_f,this.c=0*I_c),this.d=I_b*I_f,this.bTransform=!0},I_a.rotateEx=function(I_a){var I_b=Math.cos(I_a),I_c=Math.sin(I_a),I_d=this.a,I_e=this.b,I_f=this.c,I_g=this.d;0!==I_e||0!==I_f?(this.a=I_b*I_d+I_c*I_f,this.b=I_b*I_e+I_c*I_g,this.c=-I_c*I_d+I_b*I_f,this.d=-I_c*I_e+I_b*I_g):(this.a=I_b*I_d,this.b=I_c*I_g,this.c=-I_c*I_d,this.d=I_b*I_g),this.bTransform=!0},I_a.clone=function(){var I_a=I_c.create();return I_a.a=this.a,I_a.b=this.b,I_a.c=this.c,I_a.d=this.d,I_a.tx=this.tx,I_a.ty=this.ty,I_a.bTransform=this.bTransform,I_a},I_a.copyTo=function(I_a){return I_a.a=this.a,I_a.b=this.b,I_a.c=this.c,I_a.d=this.d,I_a.tx=this.tx,I_a.ty=this.ty,I_a.bTransform=this.bTransform,I_a},I_a.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},I_a.destroy=function(){if(!this.inPool){var I_a=I_c._cache;this.inPool=!0,I_a._length||(I_a._length=0),(I_a[I_a._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},I_c.mul=function(I_a,I_b,I_c){var I_d=I_a.a,I_e=I_a.b,I_f=I_a.c,I_g=I_a.d,I_h=I_a.tx,I_i=I_a.ty,I_j=I_b.a,I_k=I_b.b,I_l=I_b.c,I_m=I_b.d,I_n=I_b.tx,I_o=I_b.ty;return 0!==I_k||0!==I_l?(I_c.a=I_d*I_j+I_e*I_l,I_c.b=I_d*I_k+I_e*I_m,I_c.c=I_f*I_j+I_g*I_l,I_c.d=I_f*I_k+I_g*I_m,I_c.tx=I_j*I_h+I_l*I_i+I_n,I_c.ty=I_k*I_h+I_m*I_i+I_o):(I_c.a=I_d*I_j,I_c.b=I_e*I_m,I_c.c=I_f*I_j,I_c.d=I_g*I_m,I_c.tx=I_j*I_h+I_n,I_c.ty=I_m*I_i+I_o),I_c},I_c.mul16=function(I_a,I_b,I_c){var I_d=I_a.a,I_e=I_a.b,I_f=I_a.c,I_g=I_a.d,I_h=I_a.tx,I_i=I_a.ty,I_j=I_b.a,I_k=I_b.b,I_l=I_b.c,I_m=I_b.d,I_n=I_b.tx,I_o=I_b.ty;return 0!==I_k||0!==I_l?(I_c[0]=I_d*I_j+I_e*I_l,I_c[1]=I_d*I_k+I_e*I_m,I_c[4]=I_f*I_j+I_g*I_l,I_c[5]=I_f*I_k+I_g*I_m,I_c[12]=I_j*I_h+I_l*I_i+I_n,I_c[13]=I_k*I_h+I_m*I_i+I_o):(I_c[0]=I_d*I_j,I_c[1]=I_e*I_m,I_c[4]=I_f*I_j,I_c[5]=I_g*I_m,I_c[12]=I_j*I_h+I_n,I_c[13]=I_m*I_i+I_o),I_c},I_c.mulPre=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){var I_i=I_a.a,I_j=I_a.b,I_k=I_a.c,I_l=I_a.d,I_m=I_a.tx,I_n=I_a.ty;return 0!==I_c||0!==I_d?(I_h.a=I_i*I_b+I_j*I_d,I_h.b=I_i*I_c+I_j*I_e,I_h.c=I_k*I_b+I_l*I_d,I_h.d=I_k*I_c+I_l*I_e,I_h.tx=I_b*I_m+I_d*I_n+I_f,I_h.ty=I_c*I_m+I_e*I_n+I_g):(I_h.a=I_i*I_b,I_h.b=I_j*I_e,I_h.c=I_k*I_b,I_h.d=I_l*I_e,I_h.tx=I_b*I_m+I_f,I_h.ty=I_e*I_n+I_g),I_h},I_c.mulPos=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){var I_i=I_a.a,I_j=I_a.b,I_k=I_a.c,I_l=I_a.d,I_m=I_a.tx,I_n=I_a.ty;return 0!==I_j||0!==I_k?(I_h.a=I_b*I_i+I_c*I_k,I_h.b=I_b*I_j+I_c*I_l,I_h.c=I_d*I_i+I_e*I_k,I_h.d=I_d*I_j+I_e*I_l,I_h.tx=I_i*I_f+I_k*I_g+I_m,I_h.ty=I_j*I_f+I_l*I_g+I_n):(I_h.a=I_b*I_i,I_h.b=I_c*I_l,I_h.c=I_d*I_i,I_h.d=I_e*I_l,I_h.tx=I_i*I_f+I_m,I_h.ty=I_l*I_g+I_n),I_h},I_c.preMul=function(I_a,I_b,I_c){var I_d=I_a.a,I_e=I_a.b,I_f=I_a.c,I_g=I_a.d,I_h=I_b.a,I_i=I_b.b,I_j=I_b.c,I_k=I_b.d,I_l=I_b.tx,I_m=I_b.ty;return I_c.a=I_h*I_d,I_c.b=I_c.c=0,I_c.d=I_k*I_g,I_c.tx=I_l*I_d+I_a.tx,I_c.ty=I_m*I_g+I_a.ty,0===I_i&&0===I_j&&0===I_e&&0===I_f||(I_c.a+=I_i*I_f,I_c.d+=I_j*I_e,I_c.b+=I_h*I_e+I_i*I_g,I_c.c+=I_j*I_d+I_k*I_f,I_c.tx+=I_m*I_f,I_c.ty+=I_l*I_e),I_c},I_c.preMulXY=function(I_a,I_b,I_c,I_d){var I_e=I_a.a,I_f=I_a.b,I_g=I_a.c,I_h=I_a.d;return I_d.a=I_e,I_d.b=I_f,I_d.c=I_g,I_d.d=I_h,I_d.tx=I_b*I_e+I_a.tx+I_c*I_g,I_d.ty=I_c*I_h+I_a.ty+I_b*I_f,I_d},I_c.create=function(){var I_a=I_c._cache,I_b=I_a._length?I_a[--I_a._length]:new I_c;return I_b.inPool=!1,I_b},I_c.EMPTY=new I_c,I_c.TEMP=new I_c,I_c._cache=[],I_c}(),I_A=function(){function I_a(I_a,I_b){void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),this.x=I_a,this.y=I_b}I_k(I_a,"laya.maths.Point");var I_b=I_a.prototype;return I_b.setTo=function(I_a,I_b){return this.x=I_a,this.y=I_b,this},I_b.distance=function(I_a,I_b){return Math.sqrt((this.x-I_a)*(this.x-I_a)+(this.y-I_b)*(this.y-I_b))},I_b.toString=function(){return this.x+","+this.y},I_b.normalize=function(){var I_a=Math.sqrt(this.x*this.x+this.y*this.y);if(0<I_a){var I_b=1/I_a;this.x*=I_b,this.y*=I_b}},I_a.TEMP=new I_a,I_a.EMPTY=new I_a,I_a}(),I_B=function(){function I_j(I_a,I_b,I_c,I_d){void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=0),this.x=I_a,this.y=I_b,this.width=I_c,this.height=I_d}I_k(I_j,"laya.maths.Rectangle");var I_a=I_j.prototype;return I_a.setTo=function(I_a,I_b,I_c,I_d){return this.x=I_a,this.y=I_b,this.width=I_c,this.height=I_d,this},I_a.copyFrom=function(I_a){return this.x=I_a.x,this.y=I_a.y,this.width=I_a.width,this.height=I_a.height,this},I_a.contains=function(I_a,I_b){return!(this.width<=0||this.height<=0)&&(I_a>=this.x&&I_a<this.right&&I_b>=this.y&&I_b<this.bottom)},I_a.intersects=function(I_a){return!(I_a.x>this.x+this.width||I_a.x+I_a.width<this.x||I_a.y>this.y+this.height||I_a.y+I_a.height<this.y)},I_a.intersection=function(I_a,I_b){return this.intersects(I_a)?(I_b||(I_b=new I_j),I_b.x=Math.max(this.x,I_a.x),I_b.y=Math.max(this.y,I_a.y),I_b.width=Math.min(this.right,I_a.right)-I_b.x,I_b.height=Math.min(this.bottom,I_a.bottom)-I_b.y,I_b):null},I_a.union=function(I_a,I_b){return I_b||(I_b=new I_j),this.clone(I_b),I_a.width<=0||I_a.height<=0?I_b:(I_b.addPoint(I_a.x,I_a.y),I_b.addPoint(I_a.right,I_a.bottom),this)},I_a.clone=function(I_a){return I_a||(I_a=new I_j),I_a.x=this.x,I_a.y=this.y,I_a.width=this.width,I_a.height=this.height,I_a},I_a.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},I_a.equals=function(I_a){return!(!I_a||I_a.x!==this.x||I_a.y!==this.y||I_a.width!==this.width||I_a.height!==this.height)},I_a.addPoint=function(I_a,I_b){return this.x>I_a&&(this.width+=this.x-I_a,this.x=I_a),this.y>I_b&&(this.height+=this.y-I_b,this.y=I_b),this.width<I_a-this.x&&(this.width=I_a-this.x),this.height<I_b-this.y&&(this.height=I_b-this.y),this},I_a._getBoundPoints=function(){var I_a=I_j._temB;return(I_a.length=0)==this.width||0==this.height||I_a.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),I_a},I_a.isEmpty=function(){return this.width<=0||this.height<=0},I_o(0,I_a,"right",function(){return this.x+this.width}),I_o(0,I_a,"bottom",function(){return this.y+this.height}),I_j._getBoundPointS=function(I_a,I_b,I_c,I_d){var I_e=I_j._temA;return(I_e.length=0)==I_c||0==I_d||I_e.push(I_a,I_b,I_a+I_c,I_b,I_a,I_b+I_d,I_a+I_c,I_b+I_d),I_e},I_j._getWrapRec=function(I_a,I_b){if(!I_a||I_a.length<1)return I_b?I_b.setTo(0,0,0,0):I_j.TEMP.setTo(0,0,0,0);I_b=I_b||new I_j;var I_c,I_d,I_e,I_f,I_g,I_h=I_a.length,I_i=I_A.TEMP;for(I_e=I_g=-(I_d=I_f=99999),I_c=0;I_c<I_h;I_c+=2)I_i.x=I_a[I_c],I_i.y=I_a[I_c+1],I_d=I_d<I_i.x?I_d:I_i.x,I_f=I_f<I_i.y?I_f:I_i.y,I_e=I_e>I_i.x?I_e:I_i.x,I_g=I_g>I_i.y?I_g:I_i.y;return I_b.setTo(I_d,I_f,I_e-I_d,I_g-I_f)},I_j.EMPTY=new I_j,I_j.TEMP=new I_j,I_j._temB=[],I_j._temA=[],I_j}(),I_E=function(){function I_i(){}return I_k(I_i,"laya.media.SoundManager"),I_o(1,I_i,"useAudioMusic",function(){return I_i._useAudioMusic},function(I_a){I_i._useAudioMusic=I_a,I_i._musicClass=I_a?I_ca:null}),I_o(1,I_i,"autoStopMusic",function(){return I_i._autoStopMusic},function(I_a){I_z.stage.off("blur",null,I_i._stageOnBlur),I_z.stage.off("focus",null,I_i._stageOnFocus),I_z.stage.off("visibilitychange",null,I_i._visibilityChange),(I_i._autoStopMusic=I_a)&&(I_z.stage.on("blur",null,I_i._stageOnBlur),I_z.stage.on("focus",null,I_i._stageOnFocus),I_z.stage.on("visibilitychange",null,I_i._visibilityChange))}),I_o(1,I_i,"muted",function(){return I_i._muted},function(I_a){I_a!=I_i._muted&&(I_a&&I_i.stopAllSound(),I_i.musicMuted=I_a,I_i._muted=I_a)}),I_o(1,I_i,"musicMuted",function(){return I_i._musicMuted},function(I_a){I_a!=I_i._musicMuted&&(I_a?(I_i._tMusic&&I_i._musicChannel&&!I_i._musicChannel.isStopped?I_i._musicChannel.pause():I_i._musicChannel=null,I_i._musicMuted=I_a):(I_i._musicMuted=I_a,I_i._tMusic&&I_i._musicChannel&&I_i._musicChannel.resume()))}),I_o(1,I_i,"soundMuted",function(){return I_i._soundMuted},function(I_a){I_i._soundMuted=I_a}),I_i.addChannel=function(I_a){0<=I_i._channels.indexOf(I_a)||(I_i._channels.push(I_a),I_i.autoReleaseSound&&0!=I_i._notUsedCount&&I_i._notUsedUrls[I_a.url]&&(delete I_i._notUsedUrls[I_a.url],0==--I_i._notUsedCount&&I_z.timer.clear(I_i,I_i.disposeSoundIfNotUsed)))},I_i.removeChannel=function(I_a){var I_b=I_i._channels,I_c=I_b.indexOf(I_a);if(-1!=I_c&&(I_b.splice(I_c,1),I_i.autoReleaseSound)){var I_d=I_a.url,I_e=I_i.defaultIntervals[I_d]||2e4;if(0<I_e){var I_f=!0;for(I_c=I_b.length-1;0<=I_c;I_c--)if(I_b[I_c].url==I_d){I_f=!1;break}I_f&&(I_i._notUsedUrls[I_d]=Date.now()+I_e,0==I_i._notUsedCount++&&I_z.timer.loop(1e4,I_i,I_i.disposeSoundIfNotUsed))}}},I_i.disposeSoundIfNotUsed=function(){var I_a=I_i._notUsedUrls;if(0!=I_i._notUsedCount){var I_b=Date.now();for(var I_c in I_a)I_b>=I_a[I_c]&&(delete I_a[I_c],--I_i._notUsedCount,I_i.destroySound(I_c));if(0!=I_i._notUsedCount)return}I_z.timer.clear(I_i,I_i.disposeSoundIfNotUsed)},I_i._visibilityChange=function(){I_z.stage.isVisibility?I_i._stageOnFocus():I_i._stageOnBlur()},I_i._stageOnBlur=function(){I_i._isActive=!1,I_i._musicChannel&&(I_i._musicChannel.isStopped||(I_i._blurPaused=!0,I_i._musicChannel.pause())),I_i.stopAllSound(),I_z.stage.once("mousedown",null,I_i._stageOnFocus)},I_i._recoverWebAudio=function(){I_fa.ctx&&"running"!=I_fa.ctx.state&&I_fa.ctx.resume&&I_fa.ctx.resume()},I_i._stageOnFocus=function(){if(I_i._isActive=!0,I_i._recoverWebAudio(),I_z.stage.off("mousedown",null,I_i._stageOnFocus),I_i._blurPaused){var I_a=I_i._musicChannel;I_a&&I_i._music&&I_a.isStopped&&(I_i._blurPaused=!1,I_i._music._disposed?I_i.playMusic(I_a.url,I_a.loops,I_a.startHandler,I_a.completeHandler,I_a.startTime):I_a.audioBuffer?I_a.resume():I_i._music.play(I_a.startTime,I_a.loops,I_a.startHandler,I_a))}},I_i.playSound=function(I_a,I_b,I_c,I_d,I_e,I_f){if(void 0===I_b&&(I_b=1),void 0===I_f&&(I_f=0),!I_a)return null;if(I_i._muted)return null;if(I_i._recoverWebAudio(),I_a==I_i._tMusic){if(I_i._musicMuted)return null}else{if(!I_i._isActive)return null;if(I_i._soundMuted)return null}var I_g,I_h=I_i._pool[I_a];return I_e||(I_e=I_i._soundClass),I_h||((I_h=new I_e).load(I_a),I_i._pool[I_a]=I_h),(I_g=I_h.play(I_f,I_b,I_c))?(I_a==I_i._tMusic&&(I_i._music=I_h,I_i._isActive||(I_i._blurPaused=!0,I_g.pause())),I_g.url=I_a,I_g.volume=I_a==I_i._tMusic?I_i.musicVolume:I_i.soundVolume,I_g.completeHandler=I_d,I_g):null},I_i.destroySound=function(I_a){var I_b=I_i._pool[I_a];I_b&&(delete I_i._pool[I_a],I_b.dispose())},I_i.playMusic=function(I_a,I_b,I_c,I_d,I_e){return void 0===I_b&&(I_b=0),void 0===I_e&&(I_e=0),I_i._tMusic=I_a,I_i._musicChannel&&I_i._musicChannel.stop(),I_i._musicChannel=I_i.playSound(I_a,I_b,I_c,I_d,null,I_e)},I_i.stopSound=function(I_a){for(var I_b,I_c=I_i._channels.length-1;0<=I_c;I_c--)(I_b=I_i._channels[I_c]).url==I_a&&I_b.stop()},I_i.stopAll=function(){I_i._tMusic=null;var I_a=0;for(I_a=I_i._channels.length-1;0<=I_a;I_a--)I_i._channels[I_a].stop()},I_i.stopAllSound=function(){var I_a,I_b=0;for(I_b=I_i._channels.length-1;0<=I_b;I_b--)(I_a=I_i._channels[I_b]).url!=I_i._tMusic&&I_a.stop()},I_i.stopMusic=function(){I_i._musicChannel&&I_i._musicChannel.stop(),I_i._tMusic=null},I_i.setSoundVolume=function(I_a,I_b){if(I_b)I_i._setVolume(I_b,I_a);else{I_i.soundVolume=I_a;var I_c,I_d=0;for(I_d=I_i._channels.length-1;0<=I_d;I_d--)(I_c=I_i._channels[I_d]).url!=I_i._tMusic&&(I_c.volume=I_a)}},I_i.setMusicVolume=function(I_a){I_i.musicVolume=I_a,I_i._setVolume(I_i._tMusic,I_a)},I_i._setVolume=function(I_a,I_b){for(var I_c,I_d=I_i._channels.length-1;0<=I_d;I_d--)(I_c=I_i._channels[I_d]).url==I_a&&(I_c.volume=I_b)},I_i.musicVolume=1,I_i.soundVolume=1,I_i.playbackRate=1,I_i._useAudioMusic=!0,I_i._muted=!1,I_i._soundMuted=!1,I_i._musicMuted=!1,I_i._tMusic=null,I_i._musicChannel=null,I_i._music=null,I_i._channels=[],I_i._autoStopMusic=!1,I_i._blurPaused=!1,I_i._isActive=!0,I_i._soundClass=null,I_i._musicClass=null,I_i.autoReleaseSound=!0,I_i._pool={},I_i.defaultIntervals={},I_i._notUsedUrls={},I_i._notUsedCount=0,I_i}(),I_C=function(){var I_a;function I_c(){}return I_k(I_c,"laya.net.LocalStorage"),I_c.__init__=function(){I_c._baseClass||(I_c._baseClass=I_a).init(),I_c.items=I_c._baseClass.items,I_c.support=I_c._baseClass.support},I_c.setItem=function(I_a,I_b){I_c._baseClass.setItem(I_a,I_b)},I_c.getItem=function(I_a){return I_c._baseClass.getItem(I_a)},I_c.setJSON=function(I_a,I_b){I_c._baseClass.setJSON(I_a,I_b)},I_c.getJSON=function(I_a){return I_c._baseClass.getJSON(I_a)},I_c.removeItem=function(I_a){I_c._baseClass.removeItem(I_a)},I_c.clear=function(){I_c._baseClass.clear()},I_c._baseClass=null,I_c.items=null,I_c.support=!1,I_c.__init$=function(){I_a=function(){function I_c(){}return I_k(I_c,""),I_c.init=function(){try{I_c.support=!0,I_c.items=I_g.localStorage,I_c.setItem("laya","1"),I_c.removeItem("laya")}catch(I_a){I_c.support=!1}I_c.support||console.log("LocalStorage is not supprot or browser is private mode.")},I_c.setItem=function(I_a,I_b){try{I_c.support&&I_c.items.setItem(I_a,I_b)}catch(I_a){console.warn("set localStorage failed",I_a)}},I_c.getItem=function(I_a){return I_c.support?I_c.items.getItem(I_a):null},I_c.setJSON=function(I_a,I_b){try{I_c.support&&I_c.items.setItem(I_a,JSON.stringify(I_b))}catch(I_a){console.warn("set localStorage failed",I_a)}},I_c.getJSON=function(I_a){return JSON.parse(I_c.support?I_c.items.getItem(I_a):null)},I_c.removeItem=function(I_a){I_c.support&&I_c.items.removeItem(I_a)},I_c.clear=function(){I_c.support&&I_c.items.clear()},I_c.items=null,I_c.support=!1,I_c}()},I_c}(),I_H=(function(){function I_d(){}I_k(I_d,"laya.net.ResourceVersion"),I_d.enable=function(I_a,I_b,I_c){void 0===I_c&&(I_c=2),laya.net.ResourceVersion.type=I_c,I_z.loader.load(I_a,I_u.create(null,I_d.onManifestLoaded,[I_b]),null,"json"),I_I.customFormat=I_d.addVersionPrefix},I_d.onManifestLoaded=function(I_a,I_b){I_d.manifest=I_b,I_a.run(),I_b||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},I_d.addVersionPrefix=function(I_a){return I_d.manifest&&I_d.manifest[I_a]?2==I_d.type?I_d.manifest[I_a]:I_d.manifest[I_a]+"/"+I_a:I_a},I_d.FOLDER_VERSION=1,I_d.FILENAME_VERSION=2,I_d.manifest=null,I_d.type=1}(),function(){function I_a(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}I_k(I_a,"laya.net.TTFLoader");var I_b=I_a.prototype;return I_b.load=function(I_a){var I_b=(this._url=I_a).split(".ttf")[0].split("/");this.fontName=I_b[I_b.length-1],I_O.window.conch?this._loadConch():I_O.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},I_b._loadConch=function(){this._http=new I_ga,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},I_b._onHttpLoaded=function(I_a){I_O.window.conch.setFontFaceFromBuffer(this.fontName,I_a),this._clearHttp(),this._complete()},I_b._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},I_b._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},I_b._complete=function(){I_z.timer.clear(this,this._complete),I_z.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},I_b._checkComplete=function(){I_F.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},I_b._loadWithFontFace=function(){var I_a=new I_O.window.FontFace(this.fontName,"url('"+this._url+"')");I_O.window.document.fonts.add(I_a);var I_b=this;I_a.loaded.then(function(){I_b._complete()}),I_a.load()},I_b._createDiv=function(){this._div=I_O.createElement("div"),this._div.innerHTML="laya";var I_a=this._div.style;I_a.fontFamily=this.fontName,I_a.position="absolute",I_a.left="-100px",I_a.top="-100px",I_O.document.body.appendChild(this._div)},I_b._loadWithCSS=function(){var I_a=this,I_b=I_O.createElement("style");I_b.type="text/css",I_O.document.body.appendChild(I_b),I_b.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=I_F.measureText("LayaTTFFont",this._fontTxt).width;var I_c=this;I_b.onload=function(){I_z.timer.once(1e4,I_c,I_a._complete)},I_z.timer.loop(20,this,this._checkComplete),this._createDiv()},I_a._testString="LayaTTFFont",I_a}()),I_I=function(){function I_d(I_a){this._url=null,this._path=null,this._url=I_d.formatURL(I_a),this._path=I_d.getPath(I_a)}I_k(I_d,"laya.net.URL");var I_a=I_d.prototype;return I_o(0,I_a,"path",function(){return this._path}),I_o(0,I_a,"url",function(){return this._url}),I_d.formatURL=function(I_a,I_b){if(!I_a)return"null path";if(0<I_a.indexOf(":"))return I_a;null!=I_d.customFormat&&(I_a=I_d.customFormat(I_a,I_b));var I_c=I_a.charAt(0);if("."===I_c)return I_d.formatRelativePath((I_b||I_d.basePath)+I_a);if("~"===I_c)return I_d.rootPath+I_a.substring(1);if("d"===I_c){if(0===I_a.indexOf("data:image"))return I_a}else if("/"===I_c)return I_a;return(I_b||I_d.basePath)+I_a},I_d.formatRelativePath=function(I_a){for(var I_b=I_a.split("/"),I_c=0,I_d=I_b.length;I_c<I_d;I_c++)".."==I_b[I_c]&&(I_b.splice(I_c-1,2),I_c-=2);return I_b.join("/")},I_d.isAbsolute=function(I_a){return 0<I_a.indexOf(":")||"/"==I_a.charAt(0)},I_d.getPath=function(I_a){var I_b=I_a.lastIndexOf("/");return 0<I_b?I_a.substr(0,I_b+1):""},I_d.getFileName=function(I_a){var I_b=I_a.lastIndexOf("/");return 0<I_b?I_a.substr(I_b+1):I_a},I_d.version={},I_d.basePath="",I_d.rootPath="",I_d.customFormat=function(I_a){var I_b=I_d.version[I_a];return!I_J.isConchApp&&I_b&&(I_a+="?v="+I_b),I_a},I_d}(),I_J=function(){function I_e(I_a,I_b){this._timeId=0;var I_c=I_e._mainCanvas.source.style;I_c.position="absolute",I_c.top=I_c.left="0px",I_c.background="#000000",I_e._mainCanvas.source.id="layaCanvas";var I_d=laya.renders.Render.isWebGL;I_e._mainCanvas.source.width=I_a,I_e._mainCanvas.source.height=I_b,I_d&&I_e.WebGL.init(I_e._mainCanvas,I_a,I_b),I_O.container.appendChild(I_e._mainCanvas.source),(I_e._context=new I_K(I_a,I_b,I_d?null:I_e._mainCanvas)).ctx.setIsMainContext(),I_O.window.requestAnimationFrame(function I_a(I_b){I_O.window.requestAnimationFrame(I_a);I_z.stage._loop()}),I_z.stage.on("visibilitychange",this,this._onVisibilitychange)}I_k(I_e,"laya.renders.Render");var I_a=I_e.prototype;return I_a._onVisibilitychange=function(){I_z.stage.isVisibility?0!=this._timeId&&I_O.window.clearInterval(this._timeId):this._timeId=I_O.window.setInterval(this._enterFrame,1e3)},I_a._enterFrame=function(I_a){I_z.stage._loop()},I_o(1,I_e,"context",function(){return I_e._context}),I_o(1,I_e,"canvas",function(){return I_e._mainCanvas.source}),I_e._context=null,I_e._mainCanvas=null,I_e.WebGL=null,I_e.isConchNode=!1,I_e.isConchApp=!1,I_e.isConchWebGL=!1,I_e.isWebGL=!1,I_e.is3DMode=!1,I_e.optimizeTextureMemory=function(I_a,I_b){return!0},I_e.__init$=function(){I_g.ConchRenderType=I_g.ConchRenderType||1,I_g.ConchRenderType|=I_g.conch?4:0,I_e.isConchNode=5==(5&I_g.ConchRenderType),I_e.isConchApp=4==(4&I_g.ConchRenderType),I_e.isConchWebGL=6==I_g.ConchRenderType},I_e}(),I_K=function(){function I_g(I_a,I_b,I_c){this.x=0,this.y=0,this._drawTexture=function(I_a,I_b,I_c){I_c[0].loaded&&this.ctx.drawTexture(I_c[0],I_c[1],I_c[2],I_c[3],I_c[4],I_a,I_b)},this._fillTexture=function(I_a,I_b,I_c){I_c[0].loaded&&this.ctx.fillTexture(I_c[0],I_c[1]+I_a,I_c[2]+I_b,I_c[3],I_c[4],I_c[5],I_c[6],I_c[7])},this._drawTextureWithTransform=function(I_a,I_b,I_c){I_c[0].loaded&&this.ctx.drawTextureWithTransform(I_c[0],I_c[1],I_c[2],I_c[3],I_c[4],I_c[5],I_a,I_b,I_c[6])},this._fillQuadrangle=function(I_a,I_b,I_c){this.ctx.fillQuadrangle(I_c[0],I_c[1],I_c[2],I_c[3],I_c[4])},this._drawRect=function(I_a,I_b,I_c){var I_d=this.ctx;null!=I_c[4]&&(I_d.fillStyle=I_c[4],I_d.fillRect(I_a+I_c[0],I_b+I_c[1],I_c[2],I_c[3],null)),null!=I_c[5]&&(I_d.strokeStyle=I_c[5],I_d.lineWidth=I_c[6],I_d.strokeRect(I_a+I_c[0],I_b+I_c[1],I_c[2],I_c[3],I_c[6]))},this._drawPie=function(I_a,I_b,I_c){var I_d=this.ctx;I_J.isWebGL&&I_d.setPathId(I_c[8]),I_d.beginPath(),I_J.isWebGL?(I_d.movePath(I_c[0]+I_a,I_c[1]+I_b),I_d.moveTo(0,0)):I_d.moveTo(I_a+I_c[0],I_b+I_c[1]),I_d.arc(I_a+I_c[0],I_b+I_c[1],I_c[2],I_c[3],I_c[4]),I_d.closePath(),this._fillAndStroke(I_c[5],I_c[6],I_c[7],!0)},this._clipRect=function(I_a,I_b,I_c){this.ctx.clipRect(I_a+I_c[0],I_b+I_c[1],I_c[2],I_c[3])},this._fillRect=function(I_a,I_b,I_c){this.ctx.fillRect(I_a+I_c[0],I_b+I_c[1],I_c[2],I_c[3],I_c[4])},this._drawCircle=function(I_a,I_b,I_c){var I_d=this.ctx;I_J.isWebGL&&I_d.setPathId(I_c[6]),I_X.drawCall++,I_d.beginPath(),I_J.isWebGL&&I_d.movePath(I_c[0]+I_a,I_c[1]+I_b),I_d.arc(I_c[0]+I_a,I_c[1]+I_b,I_c[2],0,I_g.PI2),I_d.closePath(),this._fillAndStroke(I_c[3],I_c[4],I_c[5],!0)},this._fillCircle=function(I_a,I_b,I_c){I_X.drawCall++;var I_d=this.ctx;I_d.beginPath(),I_d.fillStyle=I_c[3],I_d.arc(I_c[0]+I_a,I_c[1]+I_b,I_c[2],0,I_g.PI2),I_d.fill()},this._setShader=function(I_a,I_b,I_c){this.ctx.setShader(I_c[0])},this._drawLine=function(I_a,I_b,I_c){var I_d=this.ctx;I_J.isWebGL&&I_d.setPathId(I_c[6]),I_d.beginPath(),I_d.strokeStyle=I_c[4],I_d.lineWidth=I_c[5],I_J.isWebGL?(I_d.movePath(I_a,I_b),I_d.moveTo(I_c[0],I_c[1]),I_d.lineTo(I_c[2],I_c[3])):(I_d.moveTo(I_a+I_c[0],I_b+I_c[1]),I_d.lineTo(I_a+I_c[2],I_b+I_c[3])),I_d.stroke()},this._drawLines=function(I_a,I_b,I_c){var I_d=this.ctx;I_J.isWebGL&&I_d.setPathId(I_c[5]),I_d.beginPath(),I_a+=I_c[0],I_b+=I_c[1],I_J.isWebGL&&I_d.movePath(I_a,I_b),I_d.strokeStyle=I_c[3],I_d.lineWidth=I_c[4];var I_e=I_c[2],I_f=2,I_g=I_e.length;if(I_J.isWebGL)for(I_d.moveTo(I_e[0],I_e[1]);I_f<I_g;)I_d.lineTo(I_e[I_f++],I_e[I_f++]);else for(I_d.moveTo(I_a+I_e[0],I_b+I_e[1]);I_f<I_g;)I_d.lineTo(I_a+I_e[I_f++],I_b+I_e[I_f++]);I_d.stroke()},this._drawLinesWebGL=function(I_a,I_b,I_c){this.ctx.drawLines(I_a+this.x+I_c[0],I_b+this.y+I_c[1],I_c[2],I_c[3],I_c[4])},this._drawCurves=function(I_a,I_b,I_c){this.ctx.drawCurves(I_a,I_b,I_c)},this._draw=function(I_a,I_b,I_c){I_c[0].call(null,this,I_a,I_b)},this._transformByMatrix=function(I_a,I_b,I_c){this.ctx.transformByMatrix(I_c[0])},this._setTransform=function(I_a,I_b,I_c){this.ctx.setTransform(I_c[0],I_c[1],I_c[2],I_c[3],I_c[4],I_c[5])},this._setTransformByMatrix=function(I_a,I_b,I_c){this.ctx.setTransformByMatrix(I_c[0])},this._save=function(I_a,I_b,I_c){this.ctx.save()},this._restore=function(I_a,I_b,I_c){this.ctx.restore()},this._translate=function(I_a,I_b,I_c){this.ctx.translate(I_c[0],I_c[1])},this._transform=function(I_a,I_b,I_c){this.ctx.translate(I_c[1]+I_a,I_c[2]+I_b);var I_d=I_c[0];this.ctx.transform(I_d.a,I_d.b,I_d.c,I_d.d,I_d.tx,I_d.ty),this.ctx.translate(-I_a-I_c[1],-I_b-I_c[2])},this._rotate=function(I_a,I_b,I_c){this.ctx.translate(I_c[1]+I_a,I_c[2]+I_b),this.ctx.rotate(I_c[0]),this.ctx.translate(-I_a-I_c[1],-I_b-I_c[2])},this._scale=function(I_a,I_b,I_c){this.ctx.translate(I_c[2]+I_a,I_c[3]+I_b),this.ctx.scale(I_c[0],I_c[1]),this.ctx.translate(-I_a-I_c[2],-I_b-I_c[3])},this._alpha=function(I_a,I_b,I_c){this.ctx.globalAlpha*=I_c[0]},this._setAlpha=function(I_a,I_b,I_c){this.ctx.globalAlpha=I_c[0]},this._fillText=function(I_a,I_b,I_c){this.ctx.fillText(I_c[0],I_c[1]+I_a,I_c[2]+I_b,I_c[3],I_c[4],I_c[5])},this._strokeText=function(I_a,I_b,I_c){this.ctx.strokeText(I_c[0],I_c[1]+I_a,I_c[2]+I_b,I_c[3],I_c[4],I_c[5],I_c[6])},this._fillBorderText=function(I_a,I_b,I_c){this.ctx.fillBorderText(I_c[0],I_c[1]+I_a,I_c[2]+I_b,I_c[3],I_c[4],I_c[5],I_c[6],I_c[7])},this._blendMode=function(I_a,I_b,I_c){this.ctx.globalCompositeOperation=I_c[0]},this._beginClip=function(I_a,I_b,I_c){this.ctx.beginClip&&this.ctx.beginClip(I_a+I_c[0],I_b+I_c[1],I_c[2],I_c[3])},this._setIBVB=function(I_a,I_b,I_c){this.ctx.setIBVB(I_c[0]+I_a,I_c[1]+I_b,I_c[2],I_c[3],I_c[4],I_c[5],I_c[6],I_c[7])},this._fillTrangles=function(I_a,I_b,I_c){this.ctx.fillTrangles(I_c[0],I_c[1]+I_a,I_c[2]+I_b,I_c[3],I_c[4])},this._drawPath=function(I_a,I_b,I_c){var I_d=this.ctx;I_J.isWebGL&&I_d.setPathId(-1),I_d.beginPath(),I_a+=I_c[0],I_b+=I_c[1],I_J.isWebGL&&I_d.movePath(I_a,I_b);for(var I_e=I_c[2],I_f=0,I_g=I_e.length;I_f<I_g;I_f++){var I_h=I_e[I_f];switch(I_h[0]){case"moveTo":I_J.isWebGL?I_d.moveTo(I_h[1],I_h[2]):I_d.moveTo(I_a+I_h[1],I_b+I_h[2]);break;case"lineTo":I_J.isWebGL?I_d.lineTo(I_h[1],I_h[2]):I_d.lineTo(I_a+I_h[1],I_b+I_h[2]);break;case"arcTo":I_J.isWebGL?I_d.arcTo(I_h[1],I_h[2],I_h[3],I_h[4],I_h[5]):I_d.arcTo(I_a+I_h[1],I_b+I_h[2],I_a+I_h[3],I_b+I_h[4],I_h[5]);break;case"closePath":I_d.closePath()}}var I_i=I_c[3];null!=I_i&&(I_d.fillStyle=I_i.fillStyle,I_d.fill());var I_j=I_c[4];null!=I_j&&(I_d.strokeStyle=I_j.strokeStyle,I_d.lineWidth=I_j.lineWidth||1,I_d.lineJoin=I_j.lineJoin,I_d.lineCap=I_j.lineCap,I_d.miterLimit=I_j.miterLimit,I_d.stroke())},this.drawPoly=function(I_a,I_b,I_c){this.ctx.drawPoly(I_a+this.x+I_c[0],I_b+this.y+I_c[1],I_c[2],I_c[3],I_c[4],I_c[5],I_c[6])},this._drawPoly=function(I_a,I_b,I_c){var I_d=this.ctx,I_e=I_c[2],I_f=2,I_g=I_e.length;if(I_J.isWebGL)for(I_d.setPathId(I_c[6]),I_d.beginPath(),I_a+=I_c[0],I_b+=I_c[1],I_d.movePath(I_a,I_b),I_d.moveTo(I_e[0],I_e[1]);I_f<I_g;)I_d.lineTo(I_e[I_f++],I_e[I_f++]);else for(I_d.beginPath(),I_a+=I_c[0],I_b+=I_c[1],I_d.moveTo(I_a+I_e[0],I_b+I_e[1]);I_f<I_g;)I_d.lineTo(I_a+I_e[I_f++],I_b+I_e[I_f++]);I_d.closePath(),this._fillAndStroke(I_c[3],I_c[4],I_c[5],I_c[7])},this._drawSkin=function(I_a,I_b,I_c){var I_d=I_c[0];if(I_d){var I_e=this.ctx;I_d.render(I_e,I_a,I_b)}},this._drawParticle=function(I_a,I_b,I_c){this.ctx.drawParticle(I_a+this.x,I_b+this.y,I_c[0])},this._setFilters=function(I_a,I_b,I_c){this.ctx.setFilters(I_c)},I_c?this.ctx=I_c.getContext("2d"):(I_c=I_va.create("3D"),this.ctx=I_F.createWebGLContext2D(I_c),I_c._setContext(this.ctx)),I_c.size(I_a,I_b),this.canvas=I_c}I_k(I_g,"laya.renders.RenderContext");var I_a=I_g.prototype;return I_a.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},I_a.drawTexture=function(I_a,I_b,I_c,I_d,I_e){I_a.loaded&&this.ctx.drawTexture(I_a,I_b,I_c,I_d,I_e,this.x,this.y)},I_a._drawTextures=function(I_a,I_b,I_c){I_c[0].loaded&&this.ctx.drawTextures(I_c[0],I_c[1],I_a+this.x,I_b+this.y)},I_a.drawTextureWithTransform=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){I_a.loaded&&this.ctx.drawTextureWithTransform(I_a,I_b,I_c,I_d,I_e,I_f,this.x,this.y,I_g)},I_a.fillQuadrangle=function(I_a,I_b,I_c,I_d,I_e){this.ctx.fillQuadrangle(I_a,I_b,I_c,I_d,I_e)},I_a.drawCanvas=function(I_a,I_b,I_c,I_d,I_e){this.ctx.drawCanvas(I_a,I_b+this.x,I_c+this.y,I_d,I_e)},I_a.drawRect=function(I_a,I_b,I_c,I_d,I_e,I_f){void 0===I_f&&(I_f=1);var I_g=this.ctx;I_g.strokeStyle=I_e,I_g.lineWidth=I_f,I_g.strokeRect(I_a+this.x,I_b+this.y,I_c,I_d,I_f)},I_a._fillAndStroke=function(I_a,I_b,I_c,I_d){void 0===I_d&&(I_d=!1);var I_e=this.ctx;null!=I_a&&(I_e.fillStyle=I_a,I_J.isWebGL?I_e.fill(I_d):I_e.fill()),null!=I_b&&0<I_c&&(I_e.strokeStyle=I_b,I_e.lineWidth=I_c,I_e.stroke())},I_a.clipRect=function(I_a,I_b,I_c,I_d){this.ctx.clipRect(I_a+this.x,I_b+this.y,I_c,I_d)},I_a.fillRect=function(I_a,I_b,I_c,I_d,I_e){this.ctx.fillRect(I_a+this.x,I_b+this.y,I_c,I_d,I_e)},I_a.drawCircle=function(I_a,I_b,I_c,I_d,I_e){void 0===I_e&&(I_e=1),I_X.drawCall++;var I_f=this.ctx;I_f.beginPath(),I_f.strokeStyle=I_d,I_f.lineWidth=I_e,I_f.arc(I_a+this.x,I_b+this.y,I_c,0,I_g.PI2),I_f.stroke()},I_a.drawTriangles=function(I_a,I_b,I_c){if(I_J.isWebGL)this.ctx.drawTriangles(I_c[0],I_a+I_c[1],I_b+I_c[2],I_c[3],I_c[4],I_c[5],I_c[6],I_c[7],I_c[8],I_c[9]);else{var I_d=I_c[5],I_e=0,I_f=I_d.length,I_g=this.ctx;for(I_e=0;I_e<I_f;I_e+=3){var I_h=2*I_d[I_e],I_i=2*I_d[I_e+1],I_j=2*I_d[I_e+2];I_g.drawTriangle(I_c[0],I_c[3],I_c[4],I_h,I_i,I_j,I_c[6],!0)}}},I_a.fillCircle=function(I_a,I_b,I_c,I_d){I_X.drawCall++;var I_e=this.ctx;I_e.beginPath(),I_e.fillStyle=I_d,I_e.arc(I_a+this.x,I_b+this.y,I_c,0,I_g.PI2),I_e.fill()},I_a.setShader=function(I_a){this.ctx.setShader(I_a)},I_a.drawLine=function(I_a,I_b,I_c,I_d,I_e,I_f){void 0===I_f&&(I_f=1);var I_g=this.ctx;I_g.beginPath(),I_g.strokeStyle=I_e,I_g.lineWidth=I_f,I_g.moveTo(this.x+I_a,this.y+I_b),I_g.lineTo(this.x+I_c,this.y+I_d),I_g.stroke()},I_a.clear=function(){this.ctx.clear()},I_a.transformByMatrix=function(I_a){this.ctx.transformByMatrix(I_a)},I_a.setTransform=function(I_a,I_b,I_c,I_d,I_e,I_f){this.ctx.setTransform(I_a,I_b,I_c,I_d,I_e,I_f)},I_a.setTransformByMatrix=function(I_a){this.ctx.setTransformByMatrix(I_a)},I_a.save=function(){this.ctx.save()},I_a.restore=function(){this.ctx.restore()},I_a.translate=function(I_a,I_b){this.ctx.translate(I_a,I_b)},I_a.transform=function(I_a,I_b,I_c,I_d,I_e,I_f){this.ctx.transform(I_a,I_b,I_c,I_d,I_e,I_f)},I_a.rotate=function(I_a){this.ctx.rotate(I_a)},I_a.scale=function(I_a,I_b){this.ctx.scale(I_a,I_b)},I_a.alpha=function(I_a){this.ctx.globalAlpha*=I_a},I_a.setAlpha=function(I_a){this.ctx.globalAlpha=I_a},I_a.fillWords=function(I_a,I_b,I_c,I_d,I_e,I_f){void 0===I_f&&(I_f=0),this.ctx.fillWords(I_a,I_b,I_c,I_d,I_e,I_f)},I_a.fillBorderWords=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this.ctx.fillBorderWords(I_a,I_b,I_c,I_d,I_e,I_f,I_g)},I_a.fillText=function(I_a,I_b,I_c,I_d,I_e,I_f){this.ctx.fillText(I_a,I_b+this.x,I_c+this.y,I_d,I_e,I_f)},I_a.strokeText=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this.ctx.strokeText(I_a,I_b+this.x,I_c+this.y,I_d,I_e,I_f,I_g)},I_a.blendMode=function(I_a){this.ctx.globalCompositeOperation=I_a},I_a.flush=function(){this.ctx.flush&&this.ctx.flush()},I_a.addRenderObject=function(I_a){this.ctx.addRenderObject(I_a)},I_a.beginClip=function(I_a,I_b,I_c,I_d){this.ctx.beginClip&&this.ctx.beginClip(I_a,I_b,I_c,I_d)},I_a.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},I_a.fillTrangles=function(I_a,I_b,I_c){this.ctx.fillTrangles(I_c[0],I_c[1],I_c[2],I_c[3],4<I_c.length?I_c[4]:null)},I_g.PI2=2*Math.PI,I_g}(),I_L=function(){function I_g(I_a,I_b){switch(this._next=I_b||I_g.NORENDER,I_a){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=I_t._filter);case 69905:return void(this._fun=I_g._initRenderFun)}this.onCreate(I_a)}I_k(I_g,"laya.renders.RenderSprite");var I_a=I_g.prototype;return I_a.onCreate=function(I_a){},I_a._style=function(I_a,I_b,I_c,I_d){I_a._style.render(I_a,I_b,I_c,I_d);var I_e=this._next;I_e._fun.call(I_e,I_a,I_b,I_c,I_d)},I_a._no=function(I_a,I_b,I_c,I_d){},I_a._custom=function(I_a,I_b,I_c,I_d){I_a.customRender(I_b,I_c,I_d);var I_e=I_a._style._tf;this._next._fun.call(this._next,I_a,I_b,I_c-I_e.translateX,I_d-I_e.translateY)},I_a._clip=function(I_a,I_b,I_c,I_d){var I_e=this._next;if(I_e!=I_g.NORENDER){var I_f=I_a._style.scrollRect;I_b.ctx.save(),I_b.ctx.clipRect(I_c,I_d,I_f.width,I_f.height),I_e._fun.call(I_e,I_a,I_b,I_c-I_f.x,I_d-I_f.y),I_b.ctx.restore()}},I_a._blend=function(I_a,I_b,I_c,I_d){var I_e=I_a._style;I_e.blendMode&&(I_b.ctx.globalCompositeOperation=I_e.blendMode);var I_f=this._next;I_f._fun.call(I_f,I_a,I_b,I_c,I_d),I_b.ctx.globalCompositeOperation="source-over"},I_a._mask=function(I_a,I_b,I_c,I_d){var I_e=this._next;I_e._fun.call(I_e,I_a,I_b,I_c,I_d);var I_f=I_a.mask;I_f&&(I_b.ctx.globalCompositeOperation="destination-in",(0<I_f.numChildren||!I_f.graphics._isOnlyOne())&&(I_f.cacheAsBitmap=!0),I_f.render(I_b,I_c-I_a.pivotX,I_d-I_a.pivotY)),I_b.ctx.globalCompositeOperation="source-over"},I_a._graphics=function(I_a,I_b,I_c,I_d){var I_e=I_a._style._tf;I_a._graphics&&I_a._graphics._render(I_a,I_b,I_c-I_e.translateX,I_d-I_e.translateY);var I_f=this._next;I_f._fun.call(I_f,I_a,I_b,I_c,I_d)},I_a._image=function(I_a,I_b,I_c,I_d){var I_e=I_a._style;I_b.ctx.drawTexture2(I_c,I_d,I_e._tf.translateX,I_e._tf.translateY,I_a.transform,I_e.alpha,I_e.blendMode,I_a._graphics._one)},I_a._image2=function(I_a,I_b,I_c,I_d){var I_e=I_a._style._tf;I_b.ctx.drawTexture2(I_c,I_d,I_e.translateX,I_e.translateY,I_a.transform,1,null,I_a._graphics._one)},I_a._alpha=function(I_a,I_b,I_c,I_d){var I_e;if(.01<(I_e=I_a._style.alpha)||I_a._needRepaint()){var I_f=I_b.ctx.globalAlpha;I_b.ctx.globalAlpha*=I_e;var I_g=this._next;I_g._fun.call(I_g,I_a,I_b,I_c,I_d),I_b.ctx.globalAlpha=I_f}},I_a._transform=function(I_a,I_b,I_c,I_d){var I_e=I_a.transform,I_f=this._next;I_e&&I_f!=I_g.NORENDER?(I_b.save(),I_b.transform(I_e.a,I_e.b,I_e.c,I_e.d,I_e.tx+I_c,I_e.ty+I_d),I_f._fun.call(I_f,I_a,I_b,0,0),I_b.restore()):I_f._fun.call(I_f,I_a,I_b,I_c,I_d)},I_a._childs=function(I_a,I_b,I_c,I_d){var I_e=I_a._style,I_f=I_e._tf;if(I_c=I_c-I_f.translateX+I_e.paddingLeft,I_d=I_d-I_f.translateY+I_e.paddingTop,I_e._calculation){var I_g=I_a._getWords();if(I_g){var I_h=I_e;I_h&&(I_h.stroke?I_b.fillBorderWords(I_g,I_c,I_d,I_h.font,I_h.color,I_h.strokeColor,I_h.stroke):I_b.fillWords(I_g,I_c,I_d,I_h.font,I_h.color,"none"!=I_h.textDecoration&&I_h.underLine?1:0))}}var I_i,I_j=I_a._childs,I_k=I_j.length;if(I_a.viewport||I_a.optimizeScrollRect&&I_a._style.scrollRect){var I_l=I_a.viewport||I_a._style.scrollRect,I_m=I_l.x,I_n=I_l.y,I_o=I_l.right,I_p=I_l.bottom,I_s=NaN,I_t=NaN;for(I_u=0;I_u<I_k;++I_u)(I_i=I_j[I_u]).visible&&(I_s=I_i._x)<I_o&&I_s+I_i.width>I_m&&(I_t=I_i._y)<I_p&&I_t+I_i.height>I_n&&I_i.render(I_b,I_c,I_d)}else for(var I_u=0;I_u<I_k;++I_u)(I_i=I_j[I_u])._style.visible&&I_i.render(I_b,I_c,I_d)},I_a._canvas=function(I_a,I_b,I_c,I_d){var I_e=I_a._$P.cacheCanvas;if(I_e){"bitmap"===I_e.type?I_X.canvasBitmap++:I_X.canvasNormal++;var I_f=I_e.ctx;if(I_a._needRepaint()||!I_f)this._canvas_repaint(I_a,I_b,I_c,I_d);else{var I_g=I_e._cacheRec;I_b.drawCanvas(I_f.canvas,I_c+I_g.x,I_d+I_g.y,I_g.width,I_g.height)}}else this._next._fun.call(this._next,I_a,I_b,I_c,I_d)},I_a._canvas_repaint=function(I_a,I_b,I_c,I_d){var I_e=I_a._$P.cacheCanvas,I_f=this._next;if(I_e){var I_g,I_h,I_i,I_j,I_k=I_e.ctx,I_l=I_a._needRepaint()||!I_k,I_m=I_e.type;if("bitmap"===I_m?I_X.canvasBitmap++:I_X.canvasNormal++,I_l){var I_n,I_o;I_e._cacheRec||(I_e._cacheRec=new I_B),I_J.isWebGL&&"bitmap"!==I_m?I_e._cacheRec.setTo(-I_a.pivotX,-I_a.pivotY,1,1):((I_j=I_a.getSelfBounds()).x=I_j.x-I_a.pivotX,I_j.y=I_j.y-I_a.pivotY,I_j.x=I_j.x-16,I_j.y=I_j.y-16,I_j.width=I_j.width+32,I_j.height=I_j.height+32,I_j.x=Math.floor(I_j.x+I_c)-I_c,I_j.y=Math.floor(I_j.y+I_d)-I_d,I_j.width=Math.floor(I_j.width),I_j.height=Math.floor(I_j.height),I_e._cacheRec.copyFrom(I_j)),I_j=I_e._cacheRec;var I_p,I_s=I_J.isWebGL?1:I_O.pixelRatio*I_z.stage.clientScaleX,I_t=I_J.isWebGL?1:I_O.pixelRatio*I_z.stage.clientScaleY;if(!I_J.isWebGL){var I_u,I_v=1,I_w=1;for(I_u=I_a;I_u&&I_u!=I_z.stage;)I_v*=I_u.scaleX,I_w*=I_u.scaleY,I_u=I_u.parent;I_J.isWebGL?(I_v<1&&(I_s*=I_v),I_w<1&&(I_t*=I_w)):(1<I_v&&(I_s*=I_v),1<I_w&&(I_t*=I_w))}if(I_a.scrollRect){var I_x=I_a.scrollRect;I_j.x-=I_x.x,I_j.y-=I_x.y}if(I_n=I_j.width*I_s,I_o=I_j.height*I_t,I_h=I_j.x,I_i=I_j.y,I_J.isWebGL&&"bitmap"===I_m&&(2048<I_n||2048<I_o))return console.warn("cache bitmap size larger than 2048,cache ignored"),I_e.ctx&&(I_W.recover("RenderContext",I_e.ctx),I_e.ctx.canvas.size(0,0),I_e.ctx=null),void I_f._fun.call(I_f,I_a,I_b,I_c,I_d);if(I_k||(I_k=I_e.ctx=I_W.getItem("RenderContext")||new I_K(I_n,I_o,I_va.create("AUTO"))),I_k.ctx.sprite=I_a,(I_g=I_k.canvas).clear(),(I_g.width!=I_n||I_g.height!=I_o)&&I_g.size(I_n,I_o),"bitmap"===I_m?I_g.context.asBitmap=!0:"normal"===I_m&&(I_g.context.asBitmap=!1),1!=I_s||1!=I_t){var I_y=I_k.ctx;I_y.save(),I_y.scale(I_s,I_t),!I_J.isConchWebGL&&I_J.isConchApp&&(I_p=I_a._$P.cf)&&I_y.setFilterMatrix&&I_y.setFilterMatrix(I_p._mat,I_p._alpha),I_f._fun.call(I_f,I_a,I_k,-I_h,-I_i),I_y.restore(),I_J.isConchApp&&!I_J.isConchWebGL||I_a._applyFilters()}else I_y=I_k.ctx,!I_J.isConchWebGL&&I_J.isConchApp&&(I_p=I_a._$P.cf)&&I_y.setFilterMatrix&&I_y.setFilterMatrix(I_p._mat,I_p._alpha),I_f._fun.call(I_f,I_a,I_k,-I_h,-I_i),I_J.isConchApp&&!I_J.isConchWebGL||I_a._applyFilters();I_a._$P.staticCache&&(I_e.reCache=!1),I_X.canvasReCache++}else I_h=(I_j=I_e._cacheRec).x,I_i=I_j.y,I_g=I_k.canvas;I_b.drawCanvas(I_g,I_c+I_h,I_d+I_i,I_j.width,I_j.height)}else I_f._fun.call(I_f,I_a,I_k,I_c,I_d)},I_g.__init__=function(){var I_a,I_b,I_c=0;for(I_b=I_F.createRenderSprite(69905,null),I_a=I_g.renders.length=4096,I_c=0;I_c<I_a;I_c++)I_g.renders[I_c]=I_b;I_g.renders[0]=I_F.createRenderSprite(0,null),function(I_a,I_b){for(var I_c=0,I_d=0;I_d<I_a.length;I_d++)I_c|=I_a[I_d],I_g.renders[I_c]=I_b}([1,512,4,2],new I_g(1,null)),I_g.renders[513]=I_F.createRenderSprite(513,null),I_g.renders[517]=new I_g(517,null)},I_g._initRenderFun=function(I_a,I_b,I_c,I_d){var I_e=I_a._renderType;(I_g.renders[I_e]=I_g._getTypeRender(I_e))._fun(I_a,I_b,I_c,I_d)},I_g._getTypeRender=function(I_a){for(var I_b=null,I_c=2048;1<I_c;)I_c&I_a&&(I_b=I_F.createRenderSprite(I_c,I_b)),I_c>>=1;return I_b},I_g.IMAGE=1,I_g.ALPHA=2,I_g.TRANSFORM=4,I_g.BLEND=8,I_g.CANVAS=16,I_g.FILTERS=32,I_g.MASK=64,I_g.CLIP=128,I_g.STYLE=256,I_g.GRAPHICS=512,I_g.CUSTOM=1024,I_g.CHILDS=2048,I_g.INIT=69905,I_g.renders=[],I_g.NORENDER=new I_g(0,null),I_g}(),I_M=function(){function I_h(){this._repaint=!1}I_k(I_h,"laya.resource.Context");var I_a=I_h.prototype;return I_a.replaceReset=function(){var I_a,I_b,I_c=0;for(I_a=I_h.replaceKeys.length,I_c=0;I_c<I_a;I_c++)I_b=I_h.replaceKeys[I_c],this[I_h.newKeys[I_c]]=this[I_b]},I_a.replaceResotre=function(){this.__restore(),this.__reset()},I_a.setIsMainContext=function(){},I_a.drawTextures=function(I_a,I_b,I_c,I_d){I_X.drawCall+=I_b.length/2;for(var I_e=I_a.width,I_f=I_a.height,I_g=0,I_h=I_b.length;I_g<I_h;I_g+=2)this.drawTexture(I_a,I_b[I_g],I_b[I_g+1],I_e,I_f,I_c,I_d)},I_a.drawCanvas=function(I_a,I_b,I_c,I_d,I_e){I_X.drawCall++,this.drawImage(I_a.source,I_b,I_c,I_d,I_e)},I_a.fillRect=function(I_a,I_b,I_c,I_d,I_e){I_X.drawCall++,I_e&&(this.fillStyle=I_e),this.__fillRect(I_a,I_b,I_c,I_d)},I_a.fillText=function(I_a,I_b,I_c,I_d,I_e,I_f){I_X.drawCall++,3<arguments.length&&null!=I_d&&(this.font=I_d,this.fillStyle=I_e,this.textAlign=I_f,this.textBaseline="top"),this.__fillText(I_a,I_b,I_c)},I_a.fillBorderText=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){I_X.drawCall++,this.font=I_d,this.fillStyle=I_e,this.textBaseline="top",this.strokeStyle=I_f,this.lineWidth=I_g,this.textAlign=I_h,this.__strokeText(I_a,I_b,I_c),this.__fillText(I_a,I_b,I_c)},I_a.strokeText=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){I_X.drawCall++,3<arguments.length&&null!=I_d&&(this.font=I_d,this.strokeStyle=I_e,this.lineWidth=I_f,this.textAlign=I_g,this.textBaseline="top"),this.__strokeText(I_a,I_b,I_c)},I_a.transformByMatrix=function(I_a){this.transform(I_a.a,I_a.b,I_a.c,I_a.d,I_a.tx,I_a.ty)},I_a.setTransformByMatrix=function(I_a){this.setTransform(I_a.a,I_a.b,I_a.c,I_a.d,I_a.tx,I_a.ty)},I_a.clipRect=function(I_a,I_b,I_c,I_d){I_X.drawCall++,this.beginPath(),this.rect(I_a,I_b,I_c,I_d),this.clip()},I_a.drawTexture=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){I_X.drawCall++;var I_h=I_a.uv,I_i=I_a.bitmap.width,I_j=I_a.bitmap.height;this.drawImage(I_a.source,I_h[0]*I_i,I_h[1]*I_j,(I_h[2]-I_h[0])*I_i,(I_h[5]-I_h[3])*I_j,I_b+I_f,I_c+I_g,I_d,I_e)},I_a.drawTextureWithTransform=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){I_X.drawCall++;var I_j=I_a.uv,I_k=I_a.bitmap.width,I_l=I_a.bitmap.height;this.save(),1!=I_i&&(this.globalAlpha*=I_i),I_f?(this.transform(I_f.a,I_f.b,I_f.c,I_f.d,I_f.tx+I_g,I_f.ty+I_h),this.drawImage(I_a.source,I_j[0]*I_k,I_j[1]*I_l,(I_j[2]-I_j[0])*I_k,(I_j[5]-I_j[3])*I_l,I_b,I_c,I_d,I_e)):this.drawImage(I_a.source,I_j[0]*I_k,I_j[1]*I_l,(I_j[2]-I_j[0])*I_k,(I_j[5]-I_j[3])*I_l,I_b+I_g,I_c+I_h,I_d,I_e),this.restore()},I_a.drawTexture2=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){var I_i=I_h[0];if(I_i.loaded&&I_i.bitmap&&I_i.source){I_X.drawCall++;var I_j=1!==I_f;if(I_j){var I_k=this.globalAlpha;this.globalAlpha*=I_f}var I_l=I_i.uv,I_m=I_i.bitmap.width,I_n=I_i.bitmap.height;I_e?(this.save(),this.transform(I_e.a,I_e.b,I_e.c,I_e.d,I_e.tx+I_a,I_e.ty+I_b),this.drawImage(I_i.source,I_l[0]*I_m,I_l[1]*I_n,(I_l[2]-I_l[0])*I_m,(I_l[5]-I_l[3])*I_n,I_h[1]-I_c,I_h[2]-I_d,I_h[3],I_h[4]),this.restore()):this.drawImage(I_i.source,I_l[0]*I_m,I_l[1]*I_n,(I_l[2]-I_l[0])*I_m,(I_l[5]-I_l[3])*I_n,I_h[1]-I_c+I_a,I_h[2]-I_d+I_b,I_h[3],I_h[4]),I_j&&(this.globalAlpha=I_k)}},I_a.fillTexture=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){if(!I_h.pat){if(I_a.uv!=I_ka.DEF_UV){var I_i=new I_va("2D");I_i.getContext("2d"),I_i.size(I_a.width,I_a.height),I_i.context.drawTexture(I_a,0,0,I_a.width,I_a.height,0,0),I_a=new I_ka(I_i)}I_h.pat=this.createPattern(I_a.bitmap.source,I_f)}var I_j=I_b,I_k=I_c,I_l=0,I_m=0;I_g&&(I_j+=I_g.x%I_a.width,I_k+=I_g.y%I_a.height,I_l-=I_g.x%I_a.width,I_m-=I_g.y%I_a.height),this.translate(I_j,I_k),this.fillRect(I_l,I_m,I_d,I_e,I_h.pat),this.translate(-I_j,-I_k)},I_a.drawTriangle=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){var I_i=I_a.bitmap,I_j=I_i.source,I_k=I_a.width,I_l=I_a.height,I_m=I_i.width,I_n=I_i.height,I_o=I_c[I_d]*I_m,I_p=I_c[I_e]*I_m,I_s=I_c[I_f]*I_m,I_t=I_c[I_d+1]*I_n,I_u=I_c[I_e+1]*I_n,I_v=I_c[I_f+1]*I_n,I_w=I_b[I_d],I_x=I_b[I_e],I_y=I_b[I_f],I_z=I_b[I_d+1],I_A=I_b[I_e+1],I_B=I_b[I_f+1];if(I_h){var I_C=(I_w+I_x+I_y)/3,I_D=(I_z+I_A+I_B)/3,I_E=I_w-I_C,I_F=I_z-I_D,I_G=Math.sqrt(I_E*I_E+I_F*I_F);I_w=I_C+I_E/I_G*(I_G+1),I_z=I_D+I_F/I_G*(I_G+1),I_F=I_A-I_D,I_x=I_C+(I_E=I_x-I_C)/(I_G=Math.sqrt(I_E*I_E+I_F*I_F))*(I_G+1),I_A=I_D+I_F/I_G*(I_G+1),I_F=I_B-I_D,I_y=I_C+(I_E=I_y-I_C)/(I_G=Math.sqrt(I_E*I_E+I_F*I_F))*(I_G+1),I_B=I_D+I_F/I_G*(I_G+1)}this.save(),I_g&&this.transform(I_g.a,I_g.b,I_g.c,I_g.d,I_g.tx,I_g.ty),this.beginPath(),this.moveTo(I_w,I_z),this.lineTo(I_x,I_A),this.lineTo(I_y,I_B),this.closePath(),this.clip();var I_H=1/(I_o*I_u+I_t*I_s+I_p*I_v-I_u*I_s-I_t*I_p-I_o*I_v),I_I=I_w*I_u+I_t*I_y+I_x*I_v-I_u*I_y-I_t*I_x-I_w*I_v,I_J=I_o*I_x+I_w*I_s+I_p*I_y-I_x*I_s-I_w*I_p-I_o*I_y,I_K=I_o*I_u*I_y+I_t*I_x*I_s+I_w*I_p*I_v-I_w*I_u*I_s-I_t*I_p*I_y-I_o*I_x*I_v,I_L=I_z*I_u+I_t*I_B+I_A*I_v-I_u*I_B-I_t*I_A-I_z*I_v,I_M=I_o*I_A+I_z*I_s+I_p*I_B-I_A*I_s-I_z*I_p-I_o*I_B,I_N=I_o*I_u*I_B+I_t*I_A*I_s+I_z*I_p*I_v-I_z*I_u*I_s-I_t*I_p*I_B-I_o*I_A*I_v;this.transform(I_I*I_H,I_L*I_H,I_J*I_H,I_M*I_H,I_K*I_H,I_N*I_H),this.drawImage(I_j,I_a.uv[0]*I_m,I_a.uv[1]*I_n,I_k,I_l,I_a.uv[0]*I_m,I_a.uv[1]*I_n,I_k,I_l),this.restore()},I_a.flush=function(){return 0},I_a.fillWords=function(I_a,I_b,I_c,I_d,I_e,I_f){I_d&&(this.font=I_d),I_e&&(this.fillStyle=I_e);this.textBaseline="top",this.textAlign="left";for(var I_g=0,I_h=I_a.length;I_g<I_h;I_g++){var I_i=I_a[I_g];if(this.__fillText(I_i.char,I_i.x+I_b,I_i.y+I_c),1===I_f){var I_j=I_i.height,I_k=.5*I_i.style.letterSpacing;I_k||(I_k=0),this.beginPath(),this.strokeStyle=I_e,this.lineWidth=1,this.moveTo(I_b+I_i.x-I_k+.5,I_c+I_i.y+I_j+.5),this.lineTo(I_b+I_i.x+I_i.width+I_k+.5,I_c+I_i.y+I_j+.5),this.stroke()}}},I_a.fillBorderWords=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){I_d&&(this.font=I_d),I_e&&(this.fillStyle=I_e),this.textBaseline="top",this.lineWidth=I_g,this.textAlign="left",this.strokeStyle=I_f;for(var I_h=0,I_i=I_a.length;I_h<I_i;I_h++){var I_j=I_a[I_h];this.__strokeText(I_j.char,I_j.x+I_b,I_j.y+I_c),this.__fillText(I_j.char,I_j.x+I_b,I_j.y+I_c)}},I_a.destroy=function(){this.canvas.width=this.canvas.height=0},I_a.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},I_a.drawCurves=function(I_a,I_b,I_c){this.beginPath(),this.strokeStyle=I_c[3],this.lineWidth=I_c[4];var I_d=I_c[2];I_a+=I_c[0],I_b+=I_c[1],this.moveTo(I_a+I_d[0],I_b+I_d[1]);for(var I_e=2,I_f=I_d.length;I_e<I_f;)this.quadraticCurveTo(I_a+I_d[I_e++],I_b+I_d[I_e++],I_a+I_d[I_e++],I_b+I_d[I_e++]);this.stroke()},I_h.__init__=function(I_b){var I_c=laya.resource.Context.prototype;if(!(I_b=I_b||CanvasRenderingContext2D.prototype).inited){I_b.inited=!0,I_b.__fillText=I_b.fillText,I_b.__fillRect=I_b.fillRect,I_b.__strokeText=I_b.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(I_a){I_b[I_a]=I_c[I_a]})}},I_h.replaceCanvasGetSet=function(I_a,I_b){var I_c=Object.getOwnPropertyDescriptor(I_a,I_b);if(!I_c||!I_c.configurable)return!1;var I_d,I_e={};for(I_d in I_c)"set"!=I_d&&(I_e[I_d]=I_c[I_d]);var I_f=I_c.set;return I_e.set=function(I_a){I_f.call(this,I_a);var I_b=this.getContext("2d");I_b&&"__reset"in I_b&&I_b.__reset()},Object.defineProperty(I_a,I_b,I_e),!0},I_h.replaceGetSet=function(I_a,I_b){var I_c=Object.getOwnPropertyDescriptor(I_a,I_b);if(!I_c||!I_c.configurable)return!1;var I_d,I_e={};for(I_d in I_c)"set"!=I_d&&(I_e[I_d]=I_c[I_d]);var I_f=I_c.set,I_g="___"+I_b+"__";return I_h.newKeys.push(I_g),I_e.set=function(I_a){I_a!=this[I_g]&&(this[I_g]=I_a,I_f.call(this,I_a))},Object.defineProperty(I_a,I_b,I_e),!0},I_h._default=new I_h,I_h.newKeys=[],I_i(I_h,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),I_h}(),I_N=function(){function I_f(I_a){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++I_f._uniqueIDCounter,this._name=I_a||"Content Manager",I_f._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,I_f._resourceManagers.push(this),this._resources=[],this._records={}}I_k(I_f,"laya.resource.ResourceManager");var I_a=I_f.prototype;return I_z.imps(I_a,{"laya.resource.IDispose":!0}),I_a.getResourceByIndex=function(I_a){return this._resources[I_a]},I_a.getResourcesLength=function(){return this._resources.length},I_a.addResource=function(I_a){return I_a.resourceManager&&I_a.resourceManager.removeResource(I_a),-1===this._resources.indexOf(I_a)&&((I_a._resourceManager=this)._resources.push(I_a),this.addRecord(I_a.uri,I_a.__className,I_a.memorySize),this.addSize(I_a.memorySize),!0)},I_a.removeResource=function(I_a){var I_b=this._resources.indexOf(I_a);return-1!==I_b&&(this._resources.splice(I_b,1),I_a._resourceManager=null,this._memorySize-=I_a.memorySize,this.addRecord(I_a.uri,I_a.__className,-I_a.memorySize),!0)},I_a.unload=function(){for(var I_a=this._resources.slice(0,this._resources.length),I_b=0;I_b<I_a.length;I_b++){I_a[I_b].destroy()}I_a.length=0},I_a.dispose=function(){if(this===I_f._systemResourceManager)throw new Error("systemResourceManager不能被释放！");I_f._resourceManagers.splice(I_f._resourceManagers.indexOf(this),1),I_f._isResourceManagersSorted=!1;for(var I_a=this._resources.slice(0,this._resources.length),I_b=0;I_b<I_a.length;I_b++){var I_c=I_a[I_b];I_c.resourceManager.removeResource(I_c),I_c.destroy()}I_a.length=0},I_a.addSize=function(I_a){I_a&&(this.autoRelease&&0<I_a&&this._memorySize+I_a>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=I_a)},I_a.addRecord=function(I_a,I_b,I_c){DEBUG&&I_c&&!I_a&&console.error(I_a,I_b,I_c),I_a&&(this._records.hasOwnProperty(I_b+"|"+I_a)||(this._records[I_b+"|"+I_a]=0),this._records[I_b+"|"+I_a]+=I_c,DEBUG&&this._records[I_b+"|"+I_a]<0&&console.error(I_a,I_b,this._records[I_b+"|"+I_a]))},I_a.garbageCollection=function(I_a){var I_b=this._resources;(I_b=I_b.slice()).sort(function(I_a,I_b){if(!I_a||!I_b)throw new Error("a或b不能为空！");return I_a.released&&I_b.released?0:I_a.released?1:I_b.released?-1:I_a._lastUseFrameCount-I_b._lastUseFrameCount});for(var I_c=I_X.loopCount,I_d=0,I_e=I_b.length;I_d<I_e;I_d++){var I_f=I_b[I_d];if(!(1<I_c-I_f._lastUseFrameCount))return void(this._memorySize>=I_a&&(this._isOverflow=!0));if(I_f.releaseResource(),this._memorySize<I_a)return void(this._isOverflow=!1)}},I_o(0,I_a,"id",function(){return this._id}),I_o(0,I_a,"name",function(){return this._name},function(I_a){!I_a&&""===I_a||this._name===I_a||(this._name=I_a,I_f._isResourceManagersSorted=!1)}),I_o(0,I_a,"memorySize",function(){return this._memorySize}),I_o(0,I_a,"records",function(){return this._records}),I_o(1,I_f,"systemResourceManager",function(){return I_f._systemResourceManager}),I_f.__init__=function(){I_f.currentResourceManager=I_f.systemResourceManager},I_f.getLoadedResourceManagerByIndex=function(I_a){return I_f._resourceManagers[I_a]},I_f.getLoadedResourceManagersCount=function(){return I_f._resourceManagers.length},I_f.recreateContentManagers=function(I_a){void 0===I_a&&(I_a=!1);for(var I_b=I_f.currentResourceManager,I_c=0;I_c<I_f._resourceManagers.length;I_c++){I_f.currentResourceManager=I_f._resourceManagers[I_c];for(var I_d=0;I_d<I_f.currentResourceManager._resources.length;I_d++)I_f.currentResourceManager._resources[I_d].releaseResource(I_a),I_f.currentResourceManager._resources[I_d].activeResource(I_a)}I_f.currentResourceManager=I_b},I_f.releaseContentManagers=function(I_a){void 0===I_a&&(I_a=!1);for(var I_b=I_f.currentResourceManager,I_c=0;I_c<I_f._resourceManagers.length;I_c++){I_f.currentResourceManager=I_f._resourceManagers[I_c];for(var I_d=0;I_d<I_f.currentResourceManager._resources.length;I_d++){var I_e=I_f.currentResourceManager._resources[I_d];!I_e.released&&I_e.releaseResource(I_a)}}I_f.currentResourceManager=I_b},I_f._uniqueIDCounter=0,I_f._isResourceManagersSorted=!1,I_f._resourceManagers=[],I_i(I_f,["_systemResourceManager",function(){return this._systemResourceManager=new I_f("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=I_f._systemResourceManager}]),I_f}(),I_O=(function(){function I_a(){}I_k(I_a,"laya.system.System"),I_a.changeDefinition=function(I_a,I_b){I_z[I_a]=I_b;var I_c=I_a+"=classObj";I_z._runScript(I_c)},I_a.__init__=function(){I_J.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function I_c(){}return I_k(I_c,"laya.utils.Browser"),I_o(1,I_c,"pixelRatio",function(){return I_c.__init__(),-1<I_c.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:I_F.getPixelRatio()}),I_o(1,I_c,"height",function(){return I_c.__init__(),(I_z.stage&&I_z.stage.canvasRotation?I_c.clientWidth:I_c.clientHeight)*I_c.pixelRatio}),I_o(1,I_c,"clientWidth",function(){return I_c.__init__(),I_c.window.innerWidth||I_c.document.body.clientWidth}),I_o(1,I_c,"window",function(){return I_c.__init__(),I_c._window}),I_o(1,I_c,"clientHeight",function(){return I_c.__init__(),I_c.window.innerHeight||I_c.document.body.clientHeight||I_c.document.documentElement.clientHeight}),I_o(1,I_c,"width",function(){return I_c.__init__(),(I_z.stage&&I_z.stage.canvasRotation?I_c.clientHeight:I_c.clientWidth)*I_c.pixelRatio}),I_o(1,I_c,"container",function(){return I_c.__init__(),I_c._container||((I_c._container=I_c.createElement("div")).id="layaContainer",I_c.document.body.appendChild(I_c._container)),I_c._container},function(I_a){I_c._container=I_a}),I_o(1,I_c,"document",function(){return I_c.__init__(),I_c._document}),I_c.__init__=function(){if(!I_c._window){I_c._window=I_F.getWindow(),I_c._document=I_c.window.document,I_c._window.addEventListener("message",function(I_a){laya.utils.Browser._onMessage(I_a)},!1),I_c.document.__createElement=I_c.document.createElement,I_g.requestAnimationFrame=I_g.requestAnimationFrame||I_g.webkitRequestAnimationFrame||I_g.mozRequestAnimationFrame||I_g.oRequestAnimationFrame||I_g.msRequestAnimationFrame||function(I_a){return I_g.setTimeout(I_a,1e3/60)};var I_a=I_g.document.body.style;I_a["-webkit-user-select"]="none",I_a["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",I_c.userAgent=I_c.window.navigator.userAgent,I_c.onIOS=!!(I_c.u=I_c.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),I_c.onMobile=-1<I_c.u.indexOf("Mobile"),I_c.onIPhone=-1<I_c.u.indexOf("iPhone"),I_c.onMac=-1<I_c.u.indexOf("Mac OS X"),I_c.onIPad=-1<I_c.u.indexOf("iPad"),I_c.onAndroid=-1<I_c.u.indexOf("Android")||-1<I_c.u.indexOf("Adr"),I_c.onWP=-1<I_c.u.indexOf("Windows Phone"),I_c.onQQBrowser=-1<I_c.u.indexOf("QQBrowser"),I_c.onMQQBrowser=-1<I_c.u.indexOf("MQQBrowser")||-1<I_c.u.indexOf("Mobile")&&-1<I_c.u.indexOf("QQ"),I_c.onIE=!!I_c.window.ActiveXObject||"ActiveXObject"in I_c.window,I_c.onWeiXin=-1<I_c.u.indexOf("MicroMessenger"),I_c.onPC=!I_c.onMobile,I_c.onSafari=-1<I_c.u.indexOf("Safari"),I_c.onFirefox=-1<I_c.u.indexOf("Firefox"),I_c.onEdge=-1<I_c.u.indexOf("Edge"),I_c.onMiniGame=-1<I_c.u.indexOf("MiniGame"),I_c.onLimixiu=-1<I_c.u.indexOf("limixiu"),I_c.httpProtocol="http:"==I_c.window.location.protocol,I_c.onMiniGame&&null==I_c.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),I_c.webAudioEnabled=!!(I_c.window.AudioContext||I_c.window.webkitAudioContext||I_c.window.mozAudioContext),I_c.soundType=I_c.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",I_ea=I_c.webAudioEnabled?I_fa:I_ca,I_c.webAudioEnabled&&I_fa.initWebAudio(),I_ca._initMusicAudio(),I_c.enableTouch="ontouchstart"in I_g||I_g.DocumentTouch&&I_b instanceof DocumentTouch,I_g.focus(),I_E._soundClass=I_ea,I_E._musicClass=I_ca,I_J._mainCanvas=I_J._mainCanvas||I_va.create("2D"),I_c.canvas||(I_c.canvas=I_va.create("2D"),I_c.context=I_c.canvas.getContext("2d"))}},I_c._onMessage=function(I_a){if(I_a.data&&"size"==I_a.data.name){if(I_c.window.innerWidth=I_a.data.width,I_c.window.innerHeight=I_a.data.height,I_c.window.__innerHeight=I_a.data.clientHeight,!I_c.document.createEvent)return void console.warn("no document.createEvent");var I_b=I_c.document.createEvent("HTMLEvents");return I_b.initEvent("resize",!1,!1),void I_c.window.dispatchEvent(I_b)}},I_c.createElement=function(I_a){return I_c.__init__(),I_c.document.__createElement(I_a)},I_c.getElementById=function(I_a){return I_c.__init__(),I_c.document.getElementById(I_a)},I_c.removeElement=function(I_a){I_a&&I_a.parentNode&&I_a.parentNode.removeChild(I_a)},I_c.now=function(){return I_F.now()},I_c._window=null,I_c._document=null,I_c._container=null,I_c.userAgent=null,I_c.u=null,I_c.onIOS=!1,I_c.onMac=!1,I_c.onMobile=!1,I_c.onIPhone=!1,I_c.onIPad=!1,I_c.onAndroid=!1,I_c.onWP=!1,I_c.onQQBrowser=!1,I_c.onMQQBrowser=!1,I_c.onSafari=!1,I_c.onFirefox=!1,I_c.onEdge=!1,I_c.onIE=!1,I_c.onWeiXin=!1,I_c.onMiniGame=!1,I_c.onLimixiu=!1,I_c.onPC=!1,I_c.httpProtocol=!1,I_c.webAudioEnabled=!1,I_c.soundType=null,I_c.enableTouch=!1,I_c.canvas=null,I_c.context=null,I_c.__init$=function(){},I_c}()),I_P=function(){function I_b(I_a){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,I_a?(this._u8d_=new Uint8Array(I_a),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}I_k(I_b,"laya.utils.Byte");var I_a=I_b.prototype;return I_a.___resizeBuffer=function(I_b){try{var I_a=new Uint8Array(I_b);null!=this._u8d_&&(this._u8d_.length<=I_b?I_a.set(this._u8d_):I_a.set(this._u8d_.subarray(0,I_b))),this._u8d_=I_a,this._d_=new DataView(I_a.buffer)}catch(I_a){throw"___resizeBuffer err:"+I_b}},I_a.getString=function(){return this.rUTF(this.getUint16())},I_a.getFloat32Array=function(I_a,I_b){var I_c=I_a+I_b;I_c=I_c>this._length?this._length:I_c;var I_d=new Float32Array(this._d_.buffer.slice(I_a,I_c));return this._pos_=I_c,I_d},I_a.getUint8Array=function(I_a,I_b){var I_c=I_a+I_b;I_c=I_c>this._length?this._length:I_c;var I_d=new Uint8Array(this._d_.buffer.slice(I_a,I_c));return this._pos_=I_c,I_d},I_a.getInt16Array=function(I_a,I_b){var I_c=I_a+I_b;I_c=I_c>this._length?this._length:I_c;var I_d=new Int16Array(this._d_.buffer.slice(I_a,I_c));return this._pos_=I_c,I_d},I_a.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var I_a=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,I_a},I_a.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var I_a=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,I_a},I_a.writeFloat32=function(I_a){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,I_a,this._xd_),this._pos_+=4},I_a.writeFloat64=function(I_a){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,I_a,this._xd_),this._pos_+=8},I_a.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var I_a=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,I_a},I_a.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var I_a=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,I_a},I_a.writeInt32=function(I_a){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,I_a,this._xd_),this._pos_+=4},I_a.writeUint32=function(I_a){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,I_a,this._xd_),this._pos_+=4},I_a.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var I_a=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,I_a},I_a.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var I_a=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,I_a},I_a.writeUint16=function(I_a){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,I_a,this._xd_),this._pos_+=2},I_a.writeInt16=function(I_a){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,I_a,this._xd_),this._pos_+=2},I_a.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},I_a.writeUint8=function(I_a){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,I_a),this._pos_++},I_a._getUInt8=function(I_a){return this._d_.getUint8(I_a)},I_a._getUint16=function(I_a){return this._d_.getUint16(I_a,this._xd_)},I_a._getMatrix=function(){return new I_G(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},I_a.rUTF=function(I_a){for(var I_b=[],I_c=this._pos_+I_a,I_d=0,I_e=0,I_f=0,I_g=String.fromCharCode,I_h=this._u8d_;this._pos_<I_c;)(I_d=I_h[this._pos_++])<128?0!=I_d&&I_b.push(I_g(I_d)):I_d<224?I_b.push(I_g((63&I_d)<<6|127&I_h[this._pos_++])):I_d<240?(I_e=I_h[this._pos_++],I_b.push(I_g((31&I_d)<<12|(127&I_e)<<6|127&I_h[this._pos_++]))):(I_e=I_h[this._pos_++],I_f=I_h[this._pos_++],I_b.push(I_g((15&I_d)<<18|(127&I_e)<<12|I_f<<6&127|127&I_h[this._pos_++]))),0;return I_b.join("")},I_a.getCustomString=function(I_a){for(var I_b=[],I_c=0,I_d=0,I_e=0,I_f=String.fromCharCode,I_g=this._u8d_;0<I_a;)if((I_d=I_g[this._pos_])<128)I_b.push(I_f(I_d)),this._pos_++,I_a--;else for(I_c=I_d-128,this._pos_++,I_a-=I_c;0<I_c;)I_d=I_g[this._pos_++],I_e=I_g[this._pos_++],I_b.push(I_f(I_e<<8|I_d)),I_c--;return I_b.join("")},I_a.clear=function(){this._pos_=0,this.length=0},I_a.__getBuffer=function(){return this._d_.buffer},I_a.writeUTFBytes=function(I_a){for(var I_b=0,I_c=(I_a+="").length;I_b<I_c;I_b++){var I_d=I_a.charCodeAt(I_b);I_d<=127?this.writeByte(I_d):I_d<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|I_d>>6,128|63&I_d],this._pos_),this._pos_+=2):I_d<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|I_d>>12,128|I_d>>6&63,128|63&I_d],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|I_d>>18,128|I_d>>12&63,128|I_d>>6&63,128|63&I_d],this._pos_),this._pos_+=4)}},I_a.writeUTFString=function(I_a){var I_b=this.pos;this.writeUint16(1),this.writeUTFBytes(I_a);var I_c=this.pos-I_b-2;if(65536<=I_c)throw"writeUTFString byte len more than 65536";this._d_.setUint16(I_b,I_c,this._xd_)},I_a.readUTFString=function(){return this.readUTFBytes(this.getUint16())},I_a.getUTFString=function(){return this.readUTFString()},I_a.readUTFBytes=function(I_a){if(void 0===I_a&&(I_a=-1),0==I_a)return"";var I_b=this.bytesAvailable;if(I_b<I_a)throw"readUTFBytes error - Out of bounds";return I_a=0<I_a?I_a:I_b,this.rUTF(I_a)},I_a.getUTFBytes=function(I_a){return void 0===I_a&&(I_a=-1),this.readUTFBytes(I_a)},I_a.writeByte=function(I_a){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,I_a),this._pos_+=1},I_a.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},I_a.getByte=function(){return this.readByte()},I_a.ensureWrite=function(I_a){this._length<I_a&&(this._length=I_a),this._allocated_<I_a&&(this.length=I_a)},I_a.writeArrayBuffer=function(I_a,I_b,I_c){if(void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),I_b<0||I_c<0)throw"writeArrayBuffer error - Out of bounds";0==I_c&&(I_c=I_a.byteLength-I_b),this.ensureWrite(this._pos_+I_c);var I_d=new Uint8Array(I_a);this._u8d_.set(I_d.subarray(I_b,I_b+I_c),this._pos_),this._pos_+=I_c},I_o(0,I_a,"buffer",function(){var I_a=this._d_.buffer;return I_a.byteLength==this.length?I_a:I_a.slice(0,this.length)}),I_o(0,I_a,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(I_a){this._xd_="littleEndian"==I_a}),I_o(0,I_a,"length",function(){return this._length},function(I_a){this._allocated_<I_a?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(I_a,2*this._allocated_))):this._allocated_>I_a&&this.___resizeBuffer(this._allocated_=I_a),this._length=I_a}),I_o(0,I_a,"pos",function(){return this._pos_},function(I_a){this._pos_=I_a}),I_o(0,I_a,"bytesAvailable",function(){return this._length-this._pos_}),I_b.getSystemEndian=function(){if(!I_b._sysEndian){var I_a=new ArrayBuffer(2);new DataView(I_a).setInt16(0,256,!0),I_b._sysEndian=256===new Int16Array(I_a)[0]?"littleEndian":"bigEndian"}return I_b._sysEndian},I_b.BIG_ENDIAN="bigEndian",I_b.LITTLE_ENDIAN="littleEndian",I_b._sysEndian=null,I_b}(),I_Q=function(){function I_e(){}return I_k(I_e,"laya.utils.CacheManager"),I_e.regCacheByFunction=function(I_a,I_b){var I_c;I_e.unRegCacheByFunction(I_a,I_b),I_c={tryDispose:I_a,getCacheList:I_b},I_e._cacheList.push(I_c)},I_e.unRegCacheByFunction=function(I_a,I_b){var I_c,I_d=0;for(I_c=I_e._cacheList.length,I_d=0;I_d<I_c;I_d++)if(I_e._cacheList[I_d].tryDispose==I_a&&I_e._cacheList[I_d].getCacheList==I_b)return void I_e._cacheList.splice(I_d,1)},I_e.forceDispose=function(){var I_a=0,I_b=I_e._cacheList.length;for(I_a=0;I_a<I_b;I_a++)I_e._cacheList[I_a].tryDispose(!0)},I_e.beginCheck=function(I_a){void 0===I_a&&(I_a=15e3),I_z.timer.loop(I_a,null,I_e._checkLoop)},I_e.stopCheck=function(){I_z.timer.clear(null,I_e._checkLoop)},I_e._checkLoop=function(){var I_a=I_e._cacheList;if(!(I_a.length<1)){var I_b,I_c=I_O.now(),I_d=0;for(I_b=I_d=I_a.length;0<I_d&&(I_a[I_e._index=++I_e._index%I_b].tryDispose(!1),!(I_O.now()-I_c>I_e.loopTimeLimit));)I_d--}},I_e.loopTimeLimit=2,I_e._cacheList=[],I_e._index=0,I_e}(),I_R=function(){function I_n(){}return I_k(I_n,"laya.utils.ClassUtils"),I_n.regClass=function(I_a,I_b){I_n._classMap[I_a]=I_b},I_n.getRegClass=function(I_a){return I_n._classMap[I_a]},I_n.getInstance=function(I_a){var I_b=I_n.getClass(I_a);return I_b?new I_b:(console.warn("[error] Undefined class:",I_a),null)},I_n.createByJson=function(I_a,I_b,I_c,I_d,I_e){"string"==typeof I_a&&(I_a=JSON.parse(I_a));var I_f=I_a.props;if(!I_b&&!(I_b=I_e?I_e.runWith(I_a):I_n.getInstance(I_f.runtime||I_a.type)))return null;var I_g=I_a.child;if(I_g)for(var I_h=0,I_i=I_g.length;I_h<I_i;I_h++){var I_j=I_g[I_h];if("render"!==I_j.props.name&&"render"!==I_j.props.renderType||!I_b._$set_itemRender)if("Graphic"==I_j.type)I_n.addGraphicsToSprite(I_j,I_b);else if(I_n.isDrawType(I_j.type))I_n.addGraphicToSprite(I_j,I_b,!0);else{var I_k=I_n.createByJson(I_j,null,I_c,I_d,I_e);"Script"==I_j.type?I_k.hasOwnProperty("owner")?I_k.owner=I_b:I_k.hasOwnProperty("target")&&(I_k.target=I_b):"mask"==I_j.props.renderType?I_b.mask=I_k:I_b.addChild(I_k)}else I_b.itemRender=I_j}if(I_f)for(var I_l in I_f){var I_m=I_f[I_l];"var"===I_l&&I_c?I_c[I_m]=I_b:I_m instanceof Array&&"function"==typeof I_b[I_l]?I_b[I_l].apply(I_b,I_m):I_b[I_l]=I_m}return I_d&&I_a.customProps&&I_d.runWith([I_b,I_a]),I_b.created&&I_b.created(),I_b},I_n.addGraphicsToSprite=function(I_a,I_b){var I_c;if((I_c=I_a.child)&&!(I_c.length<1)){var I_d;I_d=I_n._getGraphicsFromSprite(I_a,I_b);var I_e=0,I_f=0;I_a.props&&(I_e=I_n._getObjVar(I_a.props,"x",0),I_f=I_n._getObjVar(I_a.props,"y",0)),0!=I_e&&0!=I_f&&I_d.translate(I_e,I_f);var I_g,I_h=0;for(I_g=I_c.length,I_h=0;I_h<I_g;I_h++)I_n._addGraphicToGraphics(I_c[I_h],I_d);0!=I_e&&0!=I_f&&I_d.translate(-I_e,-I_f)}},I_n.addGraphicToSprite=function(I_a,I_b,I_c){var I_d;void 0===I_c&&(I_c=!1),I_d=I_c?I_n._getGraphicsFromSprite(I_a,I_b):I_b.graphics,I_n._addGraphicToGraphics(I_a,I_d)},I_n._getGraphicsFromSprite=function(I_a,I_b){var I_c,I_d;if(!I_a||!I_a.props)return I_b.graphics;switch(I_d=I_a.props.renderType){case"hit":case"unHit":var I_e;I_b.hitArea||(I_b.hitArea=new I_V),(I_e=I_b.hitArea)[I_d]||(I_e[I_d]=new I_m),I_c=I_e[I_d]}return I_c||(I_c=I_b.graphics),I_c},I_n._getTransformData=function(I_a){var I_b;(I_a.hasOwnProperty("pivotX")||I_a.hasOwnProperty("pivotY"))&&(I_b=I_b||new I_G).translate(-I_n._getObjVar(I_a,"pivotX",0),-I_n._getObjVar(I_a,"pivotY",0));var I_c=I_n._getObjVar(I_a,"scaleX",1),I_d=I_n._getObjVar(I_a,"scaleY",1),I_e=I_n._getObjVar(I_a,"rotation",0);I_n._getObjVar(I_a,"skewX",0),I_n._getObjVar(I_a,"skewY",0);return 1==I_c&&1==I_d&&0==I_e||((I_b=I_b||new I_G).scale(I_c,I_d),I_b.rotate(.0174532922222222*I_e)),I_b},I_n._addGraphicToGraphics=function(I_a,I_b){var I_c,I_d;if((I_c=I_a.props)&&(I_d=I_n.DrawTypeDic[I_a.type])){var I_e,I_f;I_e=I_b;var I_g=I_n._getParams(I_c,I_d[1],I_d[2],I_d[3]);((I_f=I_n._tM)||1!=I_n._alpha)&&(I_e.save(),I_f&&I_e.transform(I_f),1!=I_n._alpha&&I_e.alpha(I_n._alpha)),I_e[I_d[0]].apply(I_e,I_g),(I_f||1!=I_n._alpha)&&I_e.restore()}},I_n._adptLineData=function(I_a){return I_a[2]=parseFloat(I_a[0])+parseFloat(I_a[2]),I_a[3]=parseFloat(I_a[1])+parseFloat(I_a[3]),I_a},I_n._adptTextureData=function(I_a){return I_a[0]=I_ha.getRes(I_a[0]),I_a},I_n._adptLinesData=function(I_a){return I_a[2]=I_n._getPointListByStr(I_a[2]),I_a},I_n.isDrawType=function(I_a){return"Image"!=I_a&&I_n.DrawTypeDic.hasOwnProperty(I_a)},I_n._getParams=function(I_a,I_b,I_c,I_d){var I_e;void 0===I_c&&(I_c=0),(I_e=I_n._temParam).length=I_b.length;var I_f,I_g,I_h=0;for(I_f=I_b.length,I_h=0;I_h<I_f;I_h++)I_e[I_h]=I_n._getObjVar(I_a,I_b[I_h][0],I_b[I_h][1]);return I_n._alpha=I_n._getObjVar(I_a,"alpha",1),I_g=I_n._getTransformData(I_a),I_n._tM=I_g?(I_c||(I_c=0),I_g.translate(I_e[I_c],I_e[I_c+1]),I_e[I_c]=I_e[I_c+1]=0,I_g):null,I_d&&I_n[I_d]&&(I_e=I_n[I_d](I_e)),I_e},I_n._getPointListByStr=function(I_a){var I_b,I_c,I_d=0;for(I_c=(I_b=I_a.split(",")).length,I_d=0;I_d<I_c;I_d++)I_b[I_d]=parseFloat(I_b[I_d]);return I_b},I_n._getObjVar=function(I_a,I_b,I_c){return I_a.hasOwnProperty(I_b)?I_a[I_b]:I_c},I_n._temParam=[],I_n._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},I_n.getClass=function(I_a){var I_b=I_n._classMap[I_a]||I_a;return"string"==typeof I_b?I_z.__classmap[I_b]:I_b},I_n._tM=null,I_n._alpha=NaN,I_i(I_n,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),I_n}(),I_S=function(){function I_f(I_a){if(this._color=[],"string"==typeof I_a){null===(this.strColor=I_a)&&(I_a="#000000"),"#"==I_a.charAt(0)&&(I_a=I_a.substr(1));var I_b=I_a.length;if(3==I_b||4==I_b){for(var I_c="",I_d=0;I_d<I_b;I_d++)I_c+=I_a[I_d]+I_a[I_d];I_a=I_c}var I_e=this.numColor=parseInt(I_a,16);if(8==I_a.length)return void(this._color=[parseInt(I_a.substr(0,2),16)/255,((16711680&I_e)>>16)/255,((65280&I_e)>>8)/255,(255&I_e)/255])}else I_e=this.numColor=I_a,this.strColor=I_$.toHexColor(I_e);this._color=[((16711680&I_e)>>16)/255,((65280&I_e)>>8)/255,(255&I_e)/255,1],this._color.__id=++I_f._COLODID}return I_k(I_f,"laya.utils.Color"),I_f._initDefault=function(){for(var I_a in I_f._DEFAULT={},I_f._COLOR_MAP)I_f._SAVE[I_a]=I_f._DEFAULT[I_a]=new I_f(I_f._COLOR_MAP[I_a]);return I_f._DEFAULT},I_f._initSaveMap=function(){for(var I_a in I_f._SAVE_SIZE=0,I_f._SAVE={},I_f._DEFAULT)I_f._SAVE[I_a]=I_f._DEFAULT[I_a]},I_f.create=function(I_a){var I_b=I_f._SAVE[I_a+""];return null!=I_b?I_b:(I_f._SAVE_SIZE<1e3||I_f._initSaveMap(),I_f._SAVE[I_a+""]=new I_f(I_a))},I_f._SAVE={},I_f._SAVE_SIZE=0,I_f._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},I_f._DEFAULT=I_f._initDefault(),I_f._COLODID=1,I_f}(),I_T=(function(){function I_a(){this._values=[],this._keys=[]}I_k(I_a,"laya.utils.Dictionary");var I_b=I_a.prototype;I_b.set=function(I_a,I_b){var I_c=this.indexOf(I_a);0<=I_c?this._values[I_c]=I_b:(this._keys.push(I_a),this._values.push(I_b))},I_b.indexOf=function(I_a){var I_b=this._keys.indexOf(I_a);return 0<=I_b?I_b:(I_a="string"==typeof I_a?Number(I_a):"number"==typeof I_a?I_a.toString():I_a,this._keys.indexOf(I_a))},I_b.get=function(I_a){var I_b=this.indexOf(I_a);return I_b<0?null:this._values[I_b]},I_b.remove=function(I_a){var I_b=this.indexOf(I_a);return 0<=I_b&&(this._keys.splice(I_b,1),this._values.splice(I_b,1),!0)},I_b.clear=function(){this._values.length=0,this._keys.length=0},I_o(0,I_b,"values",function(){return this._values}),I_o(0,I_b,"keys",function(){return this._keys})}(),function(){function I_a(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}I_k(I_a,"laya.utils.Dragging");var I_b=I_a.prototype;return I_b.start=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){void 0===I_h&&(I_h=.92),this.clearTimer(),this.target=I_a,this.area=I_b,this.hasInertia=I_c,this.elasticDistance=I_b?I_d:0,this.elasticBackTime=I_e,this.data=I_f,this._disableMouseEvent=I_g,this.ratio=I_h,1!=I_a.globalScaleX||1!=I_a.globalScaleY?this._parent=I_a.parent:this._parent=I_z.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,I_z.stage.on("mouseup",this,this.onStageMouseUp),I_z.stage.on("mouseout",this,this.onStageMouseUp),I_z.timer.frameLoop(1,this,this.loop)},I_b.clearTimer=function(){I_z.timer.clear(this,this.loop),I_z.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},I_b.stop=function(){this._dragging&&(I_p.instance.disableMouseEvent=!1,I_z.stage.off("mouseup",this,this.onStageMouseUp),I_z.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},I_b.loop=function(){var I_a=this._parent.getMousePoint(),I_b=I_a.x,I_c=I_a.y,I_d=I_b-this._lastX,I_e=I_c-this._lastY;if(this._clickOnly){if(!(1<Math.abs(I_d*I_z.stage._canvasTransform.getScaleX())||1<Math.abs(I_e*I_z.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),I_p.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(I_d,I_e);0==I_d&&0==I_e||(this._lastX=I_b,this._lastY=I_c,this.target.x+=I_d*this._elasticRateX,this.target.y+=I_e*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},I_b.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var I_a=this.area.x-this.target.x;else I_a=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-I_a/this.elasticDistance),this.target.y<this.area.y)var I_b=this.area.y-this.target.y;else I_b=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-I_b/this.elasticDistance)}},I_b.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},I_b.onStageMouseUp=function(I_a){if(I_p.instance.disableMouseEvent=!1,I_z.stage.off("mouseup",this,this.onStageMouseUp),I_z.stage.off("mouseout",this,this.onStageMouseUp),I_z.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var I_b=this._offsets.length,I_c=Math.min(I_b,6),I_d=this._offsets.length-I_c,I_e=I_b-1;I_d<I_e;I_e--)this._offsetY+=this._offsets[I_e--],this._offsetX+=this._offsets[I_e];this._offsetX=this._offsetX/I_c*2,this._offsetY=this._offsetY/I_c*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),I_z.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},I_b.checkElastic=function(){var I_a=NaN,I_b=NaN;if(this.target.x<this.area.x?I_a=this.area.x:this.target.x>this.area.x+this.area.width&&(I_a=this.area.x+this.area.width),this.target.y<this.area.y?I_b=this.area.y:this.target.y>this.area.y+this.area.height&&(I_b=this.area.y+this.area.height),isNaN(I_a)&&isNaN(I_b))this.clear();else{var I_c={};isNaN(I_a)||(I_c.x=I_a),isNaN(I_b)||(I_c.y=I_b),this._tween=I_Z.to(this.target,I_c,this.elasticBackTime,I_U.sineOut,I_u.create(this,this.clear),0,!1,!1)}},I_b.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(I_z.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},I_b.clear=function(){if(this.target){this.clearTimer();var I_a=this.target;this.target=null,this._parent=null,I_a.event("dragend",this.data)}},I_a}()),I_U=function(){function I_h(){}return I_k(I_h,"laya.utils.Ease"),I_h.linearNone=function(I_a,I_b,I_c,I_d){return I_c*I_a/I_d+I_b},I_h.linearIn=function(I_a,I_b,I_c,I_d){return I_c*I_a/I_d+I_b},I_h.linearInOut=function(I_a,I_b,I_c,I_d){return I_c*I_a/I_d+I_b},I_h.linearOut=function(I_a,I_b,I_c,I_d){return I_c*I_a/I_d+I_b},I_h.bounceIn=function(I_a,I_b,I_c,I_d){return I_c-I_h.bounceOut(I_d-I_a,0,I_c,I_d)+I_b},I_h.bounceInOut=function(I_a,I_b,I_c,I_d){return I_a<.5*I_d?.5*I_h.bounceIn(2*I_a,0,I_c,I_d)+I_b:.5*I_h.bounceOut(2*I_a-I_d,0,I_c,I_d)+.5*I_c+I_b},I_h.bounceOut=function(I_a,I_b,I_c,I_d){return(I_a/=I_d)<1/2.75?I_c*(7.5625*I_a*I_a)+I_b:I_a<2/2.75?I_c*(7.5625*(I_a-=1.5/2.75)*I_a+.75)+I_b:I_a<2.5/2.75?I_c*(7.5625*(I_a-=2.25/2.75)*I_a+.9375)+I_b:I_c*(7.5625*(I_a-=2.625/2.75)*I_a+.984375)+I_b},I_h.backIn=function(I_a,I_b,I_c,I_d,I_e){return void 0===I_e&&(I_e=1.70158),I_c*(I_a/=I_d)*I_a*((I_e+1)*I_a-I_e)+I_b},I_h.backInOut=function(I_a,I_b,I_c,I_d,I_e){return void 0===I_e&&(I_e=1.70158),(I_a/=.5*I_d)<1?.5*I_c*(I_a*I_a*((1+(I_e*=1.525))*I_a-I_e))+I_b:I_c/2*((I_a-=2)*I_a*((1+(I_e*=1.525))*I_a+I_e)+2)+I_b},I_h.backOut=function(I_a,I_b,I_c,I_d,I_e){return void 0===I_e&&(I_e=1.70158),I_c*((I_a=I_a/I_d-1)*I_a*((I_e+1)*I_a+I_e)+1)+I_b},I_h.elasticIn=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g;return void 0===I_e&&(I_e=0),void 0===I_f&&(I_f=0),0==I_a?I_b:1==(I_a/=I_d)?I_b+I_c:(I_f||(I_f=.3*I_d),I_g=!I_e||0<I_c&&I_e<I_c||I_c<0&&I_e<-I_c?(I_e=I_c,I_f/4):I_f/I_h.PI2*Math.asin(I_c/I_e),-I_e*Math.pow(2,10*(I_a-=1))*Math.sin((I_a*I_d-I_g)*I_h.PI2/I_f)+I_b)},I_h.elasticInOut=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g;return void 0===I_e&&(I_e=0),void 0===I_f&&(I_f=0),0==I_a?I_b:2==(I_a/=.5*I_d)?I_b+I_c:(I_f||(I_f=I_d*(.3*1.5)),I_g=!I_e||0<I_c&&I_e<I_c||I_c<0&&I_e<-I_c?(I_e=I_c,I_f/4):I_f/I_h.PI2*Math.asin(I_c/I_e),I_a<1?I_e*Math.pow(2,10*(I_a-=1))*Math.sin((I_a*I_d-I_g)*I_h.PI2/I_f)*-.5+I_b:I_e*Math.pow(2,-10*(I_a-=1))*Math.sin((I_a*I_d-I_g)*I_h.PI2/I_f)*.5+I_c+I_b)},I_h.elasticOut=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g;return void 0===I_e&&(I_e=0),void 0===I_f&&(I_f=0),0==I_a?I_b:1==(I_a/=I_d)?I_b+I_c:(I_f||(I_f=.3*I_d),I_g=!I_e||0<I_c&&I_e<I_c||I_c<0&&I_e<-I_c?(I_e=I_c,I_f/4):I_f/I_h.PI2*Math.asin(I_c/I_e),I_e*Math.pow(2,-10*I_a)*Math.sin((I_a*I_d-I_g)*I_h.PI2/I_f)+I_c+I_b)},I_h.strongIn=function(I_a,I_b,I_c,I_d){return I_c*(I_a/=I_d)*I_a*I_a*I_a*I_a+I_b},I_h.strongInOut=function(I_a,I_b,I_c,I_d){return(I_a/=.5*I_d)<1?.5*I_c*I_a*I_a*I_a*I_a*I_a+I_b:.5*I_c*((I_a-=2)*I_a*I_a*I_a*I_a+2)+I_b},I_h.strongOut=function(I_a,I_b,I_c,I_d){return I_c*((I_a=I_a/I_d-1)*I_a*I_a*I_a*I_a+1)+I_b},I_h.sineInOut=function(I_a,I_b,I_c,I_d){return.5*-I_c*(Math.cos(Math.PI*I_a/I_d)-1)+I_b},I_h.sineIn=function(I_a,I_b,I_c,I_d){return-I_c*Math.cos(I_a/I_d*I_h.HALF_PI)+I_c+I_b},I_h.sineOut=function(I_a,I_b,I_c,I_d){return I_c*Math.sin(I_a/I_d*I_h.HALF_PI)+I_b},I_h.quintIn=function(I_a,I_b,I_c,I_d){return I_c*(I_a/=I_d)*I_a*I_a*I_a*I_a+I_b},I_h.quintInOut=function(I_a,I_b,I_c,I_d){return(I_a/=.5*I_d)<1?.5*I_c*I_a*I_a*I_a*I_a*I_a+I_b:.5*I_c*((I_a-=2)*I_a*I_a*I_a*I_a+2)+I_b},I_h.quintOut=function(I_a,I_b,I_c,I_d){return I_c*((I_a=I_a/I_d-1)*I_a*I_a*I_a*I_a+1)+I_b},I_h.quartIn=function(I_a,I_b,I_c,I_d){return I_c*(I_a/=I_d)*I_a*I_a*I_a+I_b},I_h.quartInOut=function(I_a,I_b,I_c,I_d){return(I_a/=.5*I_d)<1?.5*I_c*I_a*I_a*I_a*I_a+I_b:.5*-I_c*((I_a-=2)*I_a*I_a*I_a-2)+I_b},I_h.quartOut=function(I_a,I_b,I_c,I_d){return-I_c*((I_a=I_a/I_d-1)*I_a*I_a*I_a-1)+I_b},I_h.cubicIn=function(I_a,I_b,I_c,I_d){return I_c*(I_a/=I_d)*I_a*I_a+I_b},I_h.cubicInOut=function(I_a,I_b,I_c,I_d){return(I_a/=.5*I_d)<1?.5*I_c*I_a*I_a*I_a+I_b:.5*I_c*((I_a-=2)*I_a*I_a+2)+I_b},I_h.cubicOut=function(I_a,I_b,I_c,I_d){return I_c*((I_a=I_a/I_d-1)*I_a*I_a+1)+I_b},I_h.quadIn=function(I_a,I_b,I_c,I_d){return I_c*(I_a/=I_d)*I_a+I_b},I_h.quadInOut=function(I_a,I_b,I_c,I_d){return(I_a/=.5*I_d)<1?.5*I_c*I_a*I_a+I_b:.5*-I_c*(--I_a*(I_a-2)-1)+I_b},I_h.quadOut=function(I_a,I_b,I_c,I_d){return-I_c*(I_a/=I_d)*(I_a-2)+I_b},I_h.expoIn=function(I_a,I_b,I_c,I_d){return 0==I_a?I_b:I_c*Math.pow(2,10*(I_a/I_d-1))+I_b-.001*I_c},I_h.expoInOut=function(I_a,I_b,I_c,I_d){return 0==I_a?I_b:I_a==I_d?I_b+I_c:(I_a/=.5*I_d)<1?.5*I_c*Math.pow(2,10*(I_a-1))+I_b:.5*I_c*(2-Math.pow(2,-10*--I_a))+I_b},I_h.expoOut=function(I_a,I_b,I_c,I_d){return I_a==I_d?I_b+I_c:I_c*(1-Math.pow(2,-10*I_a/I_d))+I_b},I_h.circIn=function(I_a,I_b,I_c,I_d){return-I_c*(Math.sqrt(1-(I_a/=I_d)*I_a)-1)+I_b},I_h.circInOut=function(I_a,I_b,I_c,I_d){return(I_a/=.5*I_d)<1?.5*-I_c*(Math.sqrt(1-I_a*I_a)-1)+I_b:.5*I_c*(Math.sqrt(1-(I_a-=2)*I_a)+1)+I_b},I_h.circOut=function(I_a,I_b,I_c,I_d){return I_c*Math.sqrt(1-(I_a=I_a/I_d-1)*I_a)+I_b},I_h.HALF_PI=.5*Math.PI,I_h.PI2=2*Math.PI,I_h}(),I_V=function(){function I_l(){this._hit=null,this._unHit=null}I_k(I_l,"laya.utils.HitArea");var I_a=I_l.prototype;return I_a.isHit=function(I_a,I_b){return!!I_l.isHitGraphic(I_a,I_b,this.hit)&&!I_l.isHitGraphic(I_a,I_b,this.unHit)},I_a.contains=function(I_a,I_b){return this.isHit(I_a,I_b)},I_o(0,I_a,"hit",function(){return this._hit||(this._hit=new I_m),this._hit},function(I_a){this._hit=I_a}),I_o(0,I_a,"unHit",function(){return this._unHit||(this._unHit=new I_m),this._unHit},function(I_a){this._unHit=I_a}),I_l.isHitGraphic=function(I_a,I_b,I_c){if(!I_c)return!1;var I_d;if(!(I_d=I_c.cmds)&&I_c._one&&((I_d=I_l._cmds).length=1,I_d[0]=I_c._one),!I_d)return!1;var I_e,I_f,I_g=0;for(I_e=I_d.length,I_g=0;I_g<I_e;I_g++)if(I_f=I_d[I_g]){var I_h=I_J._context;switch(I_f.callee){case I_h._translate:case 6:I_a-=I_f[0],I_b-=I_f[1]}if(I_l.isHitCmd(I_a,I_b,I_f))return!0}return!1},I_l.isHitCmd=function(I_a,I_b,I_c){if(!I_c)return!1;var I_d=I_J._context,I_e=!1;switch(I_c.callee){case I_d._drawRect:case 13:I_l._rec.setTo(I_c[0],I_c[1],I_c[2],I_c[3]),I_e=I_l._rec.contains(I_a,I_b);break;case I_d._drawCircle:case I_d._fillCircle:case 14:I_e=(I_a-=I_c[0])*I_a+(I_b-=I_c[1])*I_b<I_c[2]*I_c[2];break;case I_d._drawPoly:case 18:I_a-=I_c[0],I_b-=I_c[1],I_e=I_l.ptInPolygon(I_a,I_b,I_c[2])}return I_e},I_l.ptInPolygon=function(I_a,I_b,I_c){var I_d;(I_d=I_l._ptPoint).setTo(I_a,I_b);var I_e,I_f=0,I_g=NaN,I_h=NaN,I_i=NaN,I_j=NaN;I_e=I_c.length;for(var I_k=0;I_k<I_e;I_k+=2){if(I_g=I_c[I_k],I_h=I_c[I_k+1],I_i=I_c[(I_k+2)%I_e],I_h!=(I_j=I_c[(I_k+3)%I_e]))if(!(I_d.y<Math.min(I_h,I_j)))if(!(I_d.y>=Math.max(I_h,I_j)))(I_d.y-I_h)*(I_i-I_g)/(I_j-I_h)+I_g>I_d.x&&I_f++}return I_f%2==1},I_l._cmds=[],I_i(I_l,["_rec",function(){return this._rec=new I_B},"_ptPoint",function(){return this._ptPoint=new I_A}]),I_l}(),I_W=(function(){function I_e(I_a,I_b,I_c,I_d){this.char=I_a,this.charNum=I_a.charCodeAt(0),this._x=this._y=0,this.width=I_b,this.height=I_c,this.style=I_d,this.isWord=!I_e._isWordRegExp.test(I_a)}I_k(I_e,"laya.utils.HTMLChar");var I_a=I_e.prototype;I_z.imps(I_a,{"laya.display.ILayout":!0}),I_a.setSprite=function(I_a){this._sprite=I_a},I_a.getSprite=function(){return this._sprite},I_a._isChar=function(){return!0},I_a._getCSSStyle=function(){return this.style},I_o(0,I_a,"width",function(){return this._w},function(I_a){this._w=I_a}),I_o(0,I_a,"x",function(){return this._x},function(I_a){this._sprite&&(this._sprite.x=I_a),this._x=I_a}),I_o(0,I_a,"y",function(){return this._y},function(I_a){this._sprite&&(this._sprite.y=I_a),this._y=I_a}),I_o(0,I_a,"height",function(){return this._h},function(I_a){this._h=I_a}),I_e._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function I_b(){}I_k(I_b,"laya.utils.Log"),I_b.enable=function(){I_b._logdiv||(I_b._logdiv=I_O.window.document.createElement("div"),I_O.window.document.body.appendChild(I_b._logdiv),I_b._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},I_b.toggle=function(){var I_a=I_b._logdiv.style;"1px"==I_a.width?I_a.width=I_a.height="50%":I_a.width=I_a.height="1px"},I_b.print=function(I_a){I_b._logdiv&&(I_b.maxCount<=I_b._count&&I_b.clear(),I_b._count++,I_b._logdiv.innerText+=I_a+"\n",I_b._logdiv.scrollTop=I_b._logdiv.scrollHeight)},I_b.clear=function(){I_b._logdiv.innerText="",I_b._count=0},I_b._logdiv=null,I_b._count=0,I_b.maxCount=20}(),function(){function I_b(){}I_k(I_b,"laya.utils.Mouse"),I_o(1,I_b,"cursor",function(){return I_b._style.cursor},function(I_a){I_b._style.cursor=I_a}),I_b.hide=function(){"none"!=I_b.cursor&&(I_b._preCursor=I_b.cursor,I_b.cursor="none")},I_b.show=function(){"none"==I_b.cursor&&(I_b.cursor=I_b._preCursor?I_b._preCursor:"auto")},I_b._preCursor=null,I_i(I_b,["_style",function(){return this._style=I_O.document.body.style}])}(),function(){function I_f(){}return I_k(I_f,"laya.utils.Pool"),I_f.getPoolBySign=function(I_a){return I_f._poolDic[I_a]||(I_f._poolDic[I_a]=[])},I_f.clearBySign=function(I_a){I_f._poolDic[I_a]&&(I_f._poolDic[I_a].length=0)},I_f.recover=function(I_a,I_b){I_b.__InPool||(I_b.__InPool=!0,I_f.getPoolBySign(I_a).push(I_b))},I_f.getItemByClass=function(I_a,I_b){var I_c=I_f.getPoolBySign(I_a),I_d=I_c.length?I_c.pop():new I_b;return I_d.__InPool=!1,I_d},I_f.getItemByCreateFun=function(I_a,I_b,I_c){var I_d=I_f.getPoolBySign(I_a),I_e=I_d.length?I_d.pop():I_b.call(I_c);return I_e.__InPool=!1,I_e},I_f.getItem=function(I_a){var I_b=I_f.getPoolBySign(I_a),I_c=I_b.length?I_b.pop():null;return I_c&&(I_c.__InPool=!1),I_c},I_f._poolDic={},I_f.InPoolSign="__InPool",I_f}()),I_X=function(){function I_i(){}return I_k(I_i,"laya.utils.Stat"),I_o(1,I_i,"onclick",null,function(I_a){I_i._sp&&I_i._sp.on("click",I_i._sp,I_a),I_i._canvas&&(I_i._canvas.source.onclick=I_a,I_i._canvas.source.style.pointerEvents="")}),I_i.show=function(I_a,I_b,I_c){if(void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),!I_J.isConchApp||I_J.isConchWebGL){if(I_J.isConchWebGL||I_O.onMiniGame||I_O.onLimixiu||(I_i._useCanvas=!0),I_i._show=!0,I_i._fpsData.length=60,I_i._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},I_i._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},I_i._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},I_i._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},I_J.isWebGL)if(I_i._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},I_J.is3DMode){if(I_i._view[0].title="FPS(3D)",I_i._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},I_i._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},I_i._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==I_c){var I_d=8;I_i._view[I_d++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},I_i._view[I_d++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},I_i._view[I_d++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},I_i._view[I_d++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},I_i._view[I_d++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},I_i._view[I_d++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},I_i._view[I_d++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},I_i._view[I_d++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},I_i._view[I_d++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==I_c){I_d=8;I_i._view[I_d++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},I_i._view[I_d++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},I_i._view[I_d++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},I_i._view[I_d++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},I_i._view[I_d++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},I_i._view[I_d++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},I_i._view[I_d++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else I_i._view[0].title="FPS(WebGL)",I_i._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else I_i._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};I_i._useCanvas?I_i.createUIPre(I_a,I_b):I_i.createUI(I_a,I_b),I_i.enable()}else I_O.window.conch.showFPS&&I_O.window.conch.showFPS(I_a,I_b)},I_i.createUIPre=function(I_a,I_b){var I_c=I_O.pixelRatio;I_i._width=170*I_c,I_i._vx=75*I_c,I_i._height=I_c*(12*I_i._view.length+3*I_c)+4,I_i._fontSize=12*I_c;for(var I_d=0;I_d<I_i._view.length;I_d++)I_i._view[I_d].x=4,I_i._view[I_d].y=I_d*I_i._fontSize+2*I_c;I_i._canvas||((I_i._canvas=new I_va("2D")).size(I_i._width,I_i._height),(I_i._ctx=I_i._canvas.getContext("2d")).textBaseline="top",I_i._ctx.font=I_i._fontSize+"px Sans-serif",I_i._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+I_a+"px;top:"+I_b+"px;width:"+I_i._width/I_c+"px;height:"+I_i._height/I_c+"px;"),I_i._first=!0,I_i.loop(),I_i._first=!1,I_O.container.appendChild(I_i._canvas.source)},I_i.createUI=function(I_a,I_b){var I_c=I_i._sp,I_d=I_O.pixelRatio;I_c||(I_c=new I_la,(I_i._leftText=new I_sa).pos(5,5),I_i._leftText.color="#ffffff",I_c.addChild(I_i._leftText),(I_i._txt=new I_sa).pos(80*I_d,5),I_i._txt.color="#ffffff",I_c.addChild(I_i._txt),I_i._sp=I_c),I_c.pos(I_a,I_b);for(var I_e="",I_f=0;I_f<I_i._view.length;I_f++){I_e+=I_i._view[I_f].title+"\n"}I_i._leftText.text=I_e;var I_g=170*I_d,I_h=I_d*(12*I_i._view.length+3*I_d)+4;I_i._txt.fontSize=I_i._fontSize*I_d,I_i._leftText.fontSize=I_i._fontSize*I_d,I_c.size(I_g,I_h),I_c.graphics.clear(),I_c.graphics.setAlpha(.5),I_c.graphics.drawRect(0,0,I_g,I_h,"#999999"),I_c.graphics.setAlpha(1),I_i.loop()},I_i.enable=function(){I_z.timer.frameLoop(1,I_i,I_i.loop)},I_i.hide=function(){I_i._show=!1,I_z.timer.clear(I_i,I_i.loop),I_i._canvas&&I_O.removeElement(I_i._canvas.source)},I_i.clear=function(){I_i.trianglesFaces=I_i.drawCall=I_i.shaderCall=I_i.spriteCount=I_i.spriteRenderUseCacheCount=I_i.treeNodeCollision=I_i.treeSpriteCollision=I_i.canvasNormal=I_i.canvasBitmap=I_i.canvasReCache=0},I_i.loop=function(){I_i._count++;var I_a=I_O.now();if(!(I_a-I_i._timer<1e3)){var I_b=I_i._count;if(I_i.FPS=Math.round(1e3*I_b/(I_a-I_i._timer)),I_i._show){I_i.trianglesFaces=Math.round(I_i.trianglesFaces/I_b),I_i.spriteCount=I_i._useCanvas?(I_i.drawCall=Math.round(I_i.drawCall/I_b)-2,I_i.shaderCall=Math.round(I_i.shaderCall/I_b),Math.round(I_i.spriteCount/I_b)-1):(I_i.drawCall=Math.round(I_i.drawCall/I_b)-2,I_i.shaderCall=Math.round(I_i.shaderCall/I_b)-4,Math.round(I_i.spriteCount/I_b)-4),I_i.spriteRenderUseCacheCount=Math.round(I_i.spriteRenderUseCacheCount/I_b),I_i.canvasNormal=Math.round(I_i.canvasNormal/I_b),I_i.canvasBitmap=Math.round(I_i.canvasBitmap/I_b),I_i.canvasReCache=Math.ceil(I_i.canvasReCache/I_b),I_i.treeNodeCollision=Math.round(I_i.treeNodeCollision/I_b),I_i.treeSpriteCollision=Math.round(I_i.treeSpriteCollision/I_b);var I_c=0<I_i.FPS?Math.floor(1e3/I_i.FPS).toString():" ";I_i._fpsStr=I_i.FPS+(I_i.renderSlow?" slow":"")+" "+I_c,I_i._spriteStr=I_i.spriteCount+(I_i.spriteRenderUseCacheCount?"/"+I_i.spriteRenderUseCacheCount:""),I_i._canvasStr=I_i.canvasReCache+"/"+I_i.canvasNormal+"/"+I_i.canvasBitmap,I_i.currentMemorySize=I_N.systemResourceManager.memorySize,I_i._useCanvas?I_i.renderInfoPre():I_i.renderInfo(),I_i.clear()}I_i._count=0,I_i._timer=I_a}},I_i.renderInfoPre=function(){if(I_i._canvas){var I_a=I_i._ctx;I_a.clearRect(I_i._first?0:I_i._vx,0,I_i._width,I_i._height);for(var I_b=I_J.WebGL.mainContext,I_c=0;I_c<I_i._view.length;I_c++){var I_d=I_i._view[I_c];I_i._first&&(I_a.fillStyle="white",I_a.fillText(I_d.title,I_d.x,I_d.y,null,null,null)),I_a.fillStyle=I_d.color;var I_e=-1;if((I_d=I_i._view[I_c]).varying){if(I_b)switch(I_d.varying){case 1:I_e=I_b.getParameter(I_b[I_d.value]);break;case 2:I_e=I_b.getExtension(I_d.value)}}else I_e=I_i[I_d.value];"M"==I_d.units&&(I_e=Math.floor(I_e/1048576*100)/100+" M"),"K"==I_d.units&&(I_e=Math.floor(I_e/1024*100)/100+" K"),"string"==I_d.units&&(I_e=I_e.match(/\d+\.?\d/i)),I_a.fillText(I_e+"",I_d.x+I_i._vx,I_d.y,null,null,null)}}},I_i.renderInfo=function(){for(var I_a="",I_b=I_J.WebGL.mainContext,I_c=0;I_c<I_i._view.length;I_c++){var I_d=I_i._view[I_c],I_e=-1;if(I_d.varying){if(I_b)switch(I_d.varying){case 1:I_e=I_b.getParameter(I_b[I_d.value]);break;case 2:I_e=I_b.getExtension(I_d.value)}}else I_e=I_i[I_d.value];"M"==I_d.units&&(I_e=Math.floor(I_e/1048576*100)/100+" M"),"K"==I_d.units&&(I_e=Math.floor(I_e/1024*100)/100+" K"),"string"==I_d.units&&(I_e=I_e.match(/\d+\.?\d/i)),I_a+=I_e+"\n"}I_i._txt.text=I_a},I_i.FPS=0,I_i.loopCount=0,I_i.shaderCall=0,I_i.drawCall=0,I_i.trianglesFaces=0,I_i.spriteCount=0,I_i.spriteRenderUseCacheCount=0,I_i.treeNodeCollision=0,I_i.treeSpriteCollision=0,I_i.canvasNormal=0,I_i.canvasBitmap=0,I_i.canvasReCache=0,I_i.renderSlow=!1,I_i.currentMemorySize=0,I_i._fpsStr=null,I_i._canvasStr=null,I_i._spriteStr=null,I_i._fpsData=[],I_i._timer=0,I_i._count=0,I_i._view=[],I_i._fontSize=12,I_i._txt=null,I_i._leftText=null,I_i._sp=null,I_i._show=!1,I_i._useCanvas=!1,I_i._canvas=null,I_i._ctx=null,I_i._first=!1,I_i._vx=NaN,I_i._width=0,I_i._height=100,I_i}(),I_Y=(function(){function I_a(){this._strsToID={},this._idToStrs=[],this._length=0}I_k(I_a,"laya.utils.StringKey");var I_b=I_a.prototype;I_b.add=function(I_a){var I_b=this._strsToID[I_a];return null!=I_b?I_b:(this._idToStrs[this._length]=I_a,this._strsToID[I_a]=this._length++)},I_b.getID=function(I_a){var I_b=this._strsToID[I_a];return null==I_b?-1:I_b},I_b.getName=function(I_a){var I_b=this._idToStrs[I_a];return null==I_b?void 0:I_b}}(),function(){var I_j;function I_a(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}I_k(I_a,"laya.utils.Timer");var I_b=I_a.prototype;return I_b._init=function(){I_z.timer&&I_z.timer.frameLoop(1,this,this._update)},I_b._now=function(){return Date.now()},I_b._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var I_a=this.currFrame=this.currFrame+this.scale,I_b=this._now();this._delta=(I_b-this._lastTimer)*this.scale;var I_c=this.currTimer=this.currTimer+this._delta;I_z.isDebug&&6e4<Math.abs(I_b-this._lastTimer)&&console.error("系统时间错误！"+(I_b-this._lastTimer)),this._lastTimer=I_b;var I_d=this._handlers;for(I_g=this._count=0,I_h=I_d.length;I_g<I_h;I_g++)if(null!==(I_i=I_d[I_g]).method){var I_e=I_i.userFrame?I_a:I_c;if(I_e>=I_i.exeTime)if(I_i.repeat)if(I_i.jumpFrame)for(;I_e>=I_i.exeTime;)I_i.exeTime+=I_i.delay,I_i.run(!1);else I_i.exeTime+=I_i.delay,I_i.run(!1),I_e>I_i.exeTime&&(I_i.exeTime+=Math.ceil((I_e-I_i.exeTime)/I_i.delay)*I_i.delay);else I_i.run(!0)}else this._count++;(30<this._count||I_a%200==0)&&this._clearHandlers();for(var I_f=this._laters,I_g=0,I_h=I_f.length-1;I_g<=I_h;I_g++){var I_i=I_f[I_g];this._isIgnoreRecover(I_i)||(null!==I_i.method&&(delete this._map[I_i.key],I_i.run(!1)),this._recoverHandler(I_i)),I_g===I_h&&(I_h=I_f.length-1)}I_f.length=0}},I_b._clearHandlers=function(){for(var I_a=this._handlers,I_b=0,I_c=I_a.length;I_b<I_c;I_b++){var I_d=I_a[I_b];null!==I_d.method?this._temp.push(I_d):this._isIgnoreRecover(I_d)?this._temp.push(I_d):this._recoverHandler(I_d)}this._handlers=this._temp,this._temp=I_a,this._temp.length=0},I_b._recoverHandler=function(I_a){this._map[I_a.key]==I_a&&delete this._map[I_a.key],I_a.recover()},I_b._create=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){if(!I_c)return I_e.apply(I_d,I_f),null;if(I_g){var I_i=this._getHandler(I_d,I_e);if(I_i)return I_i.repeat=I_b,I_i.userFrame=I_a,I_i.delay=I_c,I_i.ignoreRecover=I_h,I_i.caller=I_d,I_i.method=I_e,I_i.args=I_f,I_i.exeTime=I_c+(I_a?this.currFrame:this.currTimer+this._now()-this._lastTimer),I_i}return(I_i=I_j.create()).repeat=I_b,I_i.userFrame=I_a,I_i.delay=I_c,I_i.ignoreRecover=I_h,I_i.caller=I_d,I_i.method=I_e,I_i.args=I_f,I_i.exeTime=I_c+(I_a?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(I_i),this._handlers.push(I_i),I_i},I_b._indexHandler=function(I_a){var I_b=I_a.caller,I_c=I_a.method,I_d=I_b?I_b.$_GID||(I_b.$_GID=I_$.getGID()):0,I_e=I_c.$_TID||(I_c.$_TID=this._mid++);I_a.key=I_d+"_"+I_e,this._map[I_a.key]=I_a},I_b.once=function(I_a,I_b,I_c,I_d,I_e){void 0===I_e&&(I_e=!0),this._create(!1,!1,I_a,I_b,I_c,I_d,I_e,!1)},I_b.loop=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){void 0===I_e&&(I_e=!0),void 0===I_f&&(I_f=!1),void 0===I_g&&(I_g=!1);var I_h=this._create(!1,!0,I_a,I_b,I_c,I_d,I_e,I_g);I_h&&(I_h.jumpFrame=I_f)},I_b.frameOnce=function(I_a,I_b,I_c,I_d,I_e){void 0===I_e&&(I_e=!0),this._create(!0,!1,I_a,I_b,I_c,I_d,I_e,!1)},I_b.frameLoop=function(I_a,I_b,I_c,I_d,I_e,I_f){void 0===I_e&&(I_e=!0),void 0===I_f&&(I_f=!1),this._create(!0,!0,I_a,I_b,I_c,I_d,I_e,I_f)},I_b.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+I_j._freeCount},I_b.clear=function(I_a,I_b){var I_c=this._getHandler(I_a,I_b);return!(!I_c||this._isIgnoreRecover(I_c))&&(delete this._map[I_c.key],I_c.key=null,I_c.clear(),!0)},I_b.clearAll=function(I_a){if(I_a)for(var I_b=0,I_c=this._handlers.length;I_b<I_c;I_b++){var I_d=this._handlers[I_b];I_d.caller===I_a&&(this._isIgnoreRecover(I_d)||(delete this._map[I_d.key],I_d.key=null,I_d.clear()))}},I_b._getHandler=function(I_a,I_b){var I_c=I_a?I_a.$_GID||(I_a.$_GID=I_$.getGID()):0,I_d=I_b.$_TID||(I_b.$_TID=this._mid++);return this._map[I_c+"_"+I_d]},I_b._isIgnoreRecover=function(I_a){if(I_a.ignoreRecover||I_a.caller&&"IgnoreRecover"==I_a.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var I_b="";try{arguments.propertyIsEnumerable.caller}catch(I_a){I_b=I_a.stack}I_z.recordError("报错：核心定时器销毁忽略  "+I_b)}return!0}return!1},I_b.hasHandler=function(I_a,I_b){return this._map[I_a.$_GID+"_"+I_b.$_TID]},I_b.callLater=function(I_a,I_b,I_c){if(null==this._getHandler(I_a,I_b)){var I_d=I_j.create();I_d.caller=I_a,I_d.method=I_b,I_d.args=I_c,this._indexHandler(I_d),this._laters.push(I_d)}},I_b.runCallLater=function(I_a,I_b){var I_c=this._getHandler(I_a,I_b);I_c&&null!=I_c.method&&(this._isIgnoreRecover(I_c)||(delete this._map[I_c.key],I_c.run(!0)))},I_b.runTimer=function(I_a,I_b){this.runCallLater(I_a,I_b)},I_o(0,I_b,"delta",function(){return this._delta}),I_a.__init$=function(){I_j=function(){function I_b(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}I_k(I_b,"");var I_a=I_b.prototype;return I_a.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},I_a.recover=function(){this.clear(),this.args=I_b._freeHandler,I_b._freeHandler=this,I_b._freeCount++},I_a.run=function(I_a){var I_b=this.caller;if(I_b&&I_b.destroyed)return this.clear();var I_c=this.method,I_d=this.args;I_a&&this.clear(),null!=I_c&&(I_d?I_c.apply(I_b,I_d):I_c.call(I_b))},I_b._freeHandler=null,I_b._freeCount=0,I_b.create=function(){var I_a=I_b._freeHandler;return I_a?(I_b._freeHandler=I_a.args,--I_b._freeCount,I_a.args=null,I_a):new I_b},I_b}()},I_a}()),I_Z=function(){function I_l(){this.gid=0}I_k(I_l,"laya.utils.Tween");var I_a=I_l.prototype;return I_a.to=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){return void 0===I_f&&(I_f=0),void 0===I_g&&(I_g=!1),this._create(I_a,I_b,I_c,I_d,I_e,I_f,I_g,!0,!1,!0)},I_a.from=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){return void 0===I_f&&(I_f=0),void 0===I_g&&(I_g=!1),this._create(I_a,I_b,I_c,I_d,I_e,I_f,I_g,!1,!1,!0)},I_a._create=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){if(!I_a)throw new Error("Tween:target is null");this._target=I_a,this._duration=I_c,this._ease=I_d||I_b.ease||I_l.easeNone,this._complete=I_e||I_b.complete,this._delay=I_f,this._props=[],this._usedTimer=0,this._startTimer=I_O.now(),this._usedPool=I_i,this._delayParam=null,this.update=I_b.update;var I_k=I_a.$_GID||(I_a.$_GID=I_$.getGID());return I_l.tweenMap[I_k]?(I_g&&I_l.clearTween(I_a),I_l.tweenMap[I_k].push(this)):I_l.tweenMap[I_k]=[this],I_j?I_f<=0?this.firstStart(I_a,I_b,I_h):(this._delayParam=[I_a,I_b,I_h],I_z.scaleTimer.once(I_f,this,this.firstStart,this._delayParam)):this._initProps(I_a,I_b,I_h),this},I_a.firstStart=function(I_a,I_b,I_c){this._delayParam=null,I_a.destroyed?this.clear():(this._initProps(I_a,I_b,I_c),this._beginLoop())},I_a._initProps=function(I_a,I_b,I_c){for(var I_d in I_b)if("number"==typeof I_a[I_d]){var I_e=I_c?I_a[I_d]:I_b[I_d],I_f=I_c?I_b[I_d]:I_a[I_d];this._props.push([I_d,I_e,I_f-I_e]),I_c||(I_a[I_d]=I_e)}},I_a._beginLoop=function(){I_z.scaleTimer.frameLoop(1,this,this._doEase)},I_a._doEase=function(){this._updateEase(I_O.now())},I_a._updateEase=function(I_a){var I_b=this._target;if(I_b){if(I_b.destroyed)return I_l.clearTween(I_b);var I_c=this._usedTimer=I_a-this._startTimer-this._delay;if(!(I_c<0)){if(I_c>=this._duration)return this.complete();for(var I_d=0<I_c?this._ease(I_c,0,1,this._duration):0,I_e=this._props,I_f=0,I_g=I_e.length;I_f<I_g;I_f++){var I_h=I_e[I_f];I_b[I_h[0]]=I_h[1]+I_d*I_h[2]}this.update&&this.update.run()}}},I_a.complete=function(){if(this._target){I_z.scaleTimer.runTimer(this,this.firstStart);for(var I_a=this._target,I_b=this._props,I_c=this._complete,I_d=0,I_e=I_b.length;I_d<I_e;I_d++){var I_f=I_b[I_d];I_a[I_f[0]]=I_f[1]+I_f[2]}this.update&&this.update.run(),this.clear(),I_c&&I_c.run()}},I_a.pause=function(){I_z.scaleTimer.clear(this,this._beginLoop),I_z.scaleTimer.clear(this,this._doEase),I_z.scaleTimer.clear(this,this.firstStart);var I_a;(I_a=I_O.now()-this._startTimer-this._delay)<0&&(this._usedTimer=I_a)},I_a.setStartTime=function(I_a){this._startTimer=I_a},I_a.clear=function(){this._target&&(this._remove(),this._clear())},I_a._clear=function(){this.pause(),I_z.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,I_W.recover("tween",this))},I_a.recover=function(){this._usedPool=!0,this._clear()},I_a._remove=function(){var I_a=I_l.tweenMap[this._target.$_GID];if(I_a)for(var I_b=0,I_c=I_a.length;I_b<I_c;I_b++)if(I_a[I_b]===this){I_a.splice(I_b,1);break}},I_a.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=I_O.now(),this._delayParam)I_z.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var I_a=this._props,I_b=0,I_c=I_a.length;I_b<I_c;I_b++){var I_d=I_a[I_b];this._target[I_d[0]]=I_d[1]}I_z.scaleTimer.once(this._delay,this,this._beginLoop)}},I_a.resume=function(){this._usedTimer>=this._duration||(this._startTimer=I_O.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?I_z.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},I_o(0,I_a,"progress",null,function(I_a){var I_b=I_a*this._duration;this._startTimer=I_O.now()-this._delay-I_b}),I_l.to=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){return void 0===I_f&&(I_f=0),void 0===I_g&&(I_g=!1),void 0===I_h&&(I_h=!0),I_W.getItemByClass("tween",I_l)._create(I_a,I_b,I_c,I_d,I_e,I_f,I_g,!0,I_h,!0)},I_l.from=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){return void 0===I_f&&(I_f=0),void 0===I_g&&(I_g=!1),void 0===I_h&&(I_h=!0),I_W.getItemByClass("tween",I_l)._create(I_a,I_b,I_c,I_d,I_e,I_f,I_g,!1,I_h,!0)},I_l.clearAll=function(I_a){if(I_a&&I_a.$_GID){var I_b=I_l.tweenMap[I_a.$_GID];if(I_b){for(var I_c=0,I_d=I_b.length;I_c<I_d;I_c++)I_b[I_c]._clear();I_b.length=0}}},I_l.clear=function(I_a){I_a.clear()},I_l.clearTween=function(I_a){I_l.clearAll(I_a)},I_l.easeNone=function(I_a,I_b,I_c,I_d){return I_c*I_a/I_d+I_b},I_l.tweenMap={},I_l}(),I_$=function(){function I_h(){}return I_k(I_h,"laya.utils.Utils"),I_h.toRadian=function(I_a){return I_a*I_h._pi2},I_h.toAngle=function(I_a){return I_a*I_h._pi},I_h.toHexColor=function(I_a){if(I_a<0||isNaN(I_a))return null;for(var I_b=I_a.toString(16);I_b.length<6;)I_b="0"+I_b;return"#"+I_b},I_h.getGID=function(){return I_h._gid++},I_h.concatArray=function(I_a,I_b){if(!I_b)return I_a;if(!I_a)return I_b;var I_c=0,I_d=I_b.length;for(I_c=0;I_c<I_d;I_c++)I_a.push(I_b[I_c]);return I_a},I_h.clearArray=function(I_a){return I_a&&(I_a.length=0),I_a},I_h.copyArray=function(I_a,I_b){if(I_a||(I_a=[]),!I_b)return I_a;I_a.length=I_b.length;var I_c=0,I_d=I_b.length;for(I_c=0;I_c<I_d;I_c++)I_a[I_c]=I_b[I_c];return I_a},I_h.getGlobalRecByPoints=function(I_a,I_b,I_c,I_d,I_e){var I_f,I_g;return I_f=new I_A(I_b,I_c),I_f=I_a.localToGlobal(I_f),I_g=new I_A(I_d,I_e),I_g=I_a.localToGlobal(I_g),I_B._getWrapRec([I_f.x,I_f.y,I_g.x,I_g.y])},I_h.getGlobalPosAndScale=function(I_a){return I_h.getGlobalRecByPoints(I_a,0,0,1,1)},I_h.bind=function(I_a,I_b){return I_a.bind(I_b)},I_h.measureText=function(I_a,I_b){return I_F.measureText(I_a,I_b)},I_h.updateOrder=function(I_a){if(!I_a||I_a.length<2)return!1;for(var I_b,I_c=1,I_d=0,I_e=I_a.length,I_f=NaN;I_c<I_e;){for(I_b=I_a[I_d=I_c],I_f=I_a[I_d]._zOrder;-1<--I_d&&I_a[I_d]._zOrder>I_f;)I_a[I_d+1]=I_a[I_d];I_a[I_d+1]=I_b,I_c++}var I_g=I_b.parent.conchModel;if(I_g)if(null!=I_g.updateZOrder)I_g.updateZOrder();else{for(I_c=0;I_c<I_e;I_c++)I_g.removeChild(I_a[I_c].conchModel);for(I_c=0;I_c<I_e;I_c++)I_g.addChildAt(I_a[I_c].conchModel,I_c)}return!0},I_h.transPointList=function(I_a,I_b,I_c){var I_d=0,I_e=I_a.length;for(I_d=0;I_d<I_e;I_d+=2)I_a[I_d]+=I_b,I_a[I_d+1]+=I_c},I_h.parseInt=function(I_a,I_b){void 0===I_b&&(I_b=0);var I_c=I_O.window.parseInt(I_a,I_b);return isNaN(I_c)?0:I_c},I_h.getFileExtension=function(I_a){I_h._extReg.lastIndex=I_a.lastIndexOf(".");var I_b=I_h._extReg.exec(I_a);return I_b&&1<I_b.length?I_b[1].toLowerCase():null},I_h.getTransformRelativeToWindow=function(I_a,I_b,I_c){var I_d=I_z.stage,I_e=laya.utils.Utils.getGlobalPosAndScale(I_a),I_f=I_d._canvasTransform.clone(),I_g=I_f.tx,I_h=I_f.ty;I_f.rotate(-Math.PI/180*I_z.stage.canvasDegree),I_f.scale(I_z.stage.clientScaleX,I_z.stage.clientScaleY);var I_i=I_z.stage.canvasDegree%180!=0,I_j=NaN,I_k=NaN;I_i?(I_j=I_c+I_e.y,I_k=I_b+I_e.x,I_j*=I_f.d,I_k*=I_f.a,90==I_z.stage.canvasDegree?(I_j=I_g-I_j,I_k+=I_h):(I_j+=I_g,I_k=I_h-I_k)):(I_j=I_b+I_e.x,I_k=I_c+I_e.y,I_j*=I_f.a,I_k*=I_f.d,I_j+=I_g,I_k+=I_h);var I_l=NaN,I_m=NaN;return I_m=I_i?(I_l=I_f.d*I_e.height,I_f.a*I_e.width):(I_l=I_f.a*I_e.width,I_f.d*I_e.height),{x:I_j,y:I_k,scaleX:I_l,scaleY:I_m}},I_h.fitDOMElementInArea=function(I_a,I_b,I_c,I_d,I_e,I_f){I_a._fitLayaAirInitialized||(I_a._fitLayaAirInitialized=!0,I_a.style.transformOrigin=I_a.style.webKittransformOrigin="left top",I_a.style.position="absolute");var I_g=I_h.getTransformRelativeToWindow(I_b,I_c,I_d);I_a.style.transform=I_a.style.webkitTransform="scale("+I_g.scaleX+","+I_g.scaleY+") rotate("+I_z.stage.canvasDegree+"deg)",I_a.style.width=I_e+"px",I_a.style.height=I_f+"px",I_a.style.left=I_g.x+"px",I_a.style.top=I_g.y+"px"},I_h.isOkTextureList=function(I_a){if(!I_a)return!1;var I_b,I_c=0,I_d=I_a.length;for(I_c=0;I_c<I_d;I_c++)if(!(I_b=I_a[I_c])||!I_b.source)return!1;return!0},I_h.isOKCmdList=function(I_a){if(!I_a)return!1;var I_b,I_c,I_d=0,I_e=I_a.length,I_f=I_J._context;for(I_d=0;I_d<I_e;I_d++)switch((I_b=I_a[I_d]).callee){case I_f._drawTexture:case I_f._fillTexture:case I_f._drawTextureWithTransform:if(!(I_c=I_b[0])||!I_c.source)return!1}return!0},I_h._gid=1,I_h._pi=180/Math.PI,I_h._pi2=Math.PI/180,I_h._extReg=/\.(\w+)\??/g,I_h.parseXMLFromString=function(I_a){var I_b;if(I_a=I_a.replace(/>\s+</g,"><"),-1<(I_b=(new DOMParser).parseFromString(I_a,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(I_b.firstChild.firstChild.textContent);return I_b},I_h}(),I__=function(){function I_a(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],I_J.isWebGL&&I_Q.regCacheByFunction(I_$.bind(this.startDispose,this),I_$.bind(this.getCacheList,this))}I_k(I_a,"laya.utils.VectorGraphManager");var I_b=I_a.prototype;return I_b.getId=function(){return this._id++},I_b.addShape=function(I_a,I_b){this.shapeDic[I_a]=I_b,this.useDic[I_a]||(this.useDic[I_a]=!0)},I_b.addLine=function(I_a,I_b){this.shapeLineDic[I_a]=I_b,this.shapeLineDic[I_a]||(this.shapeLineDic[I_a]=!0)},I_b.getShape=function(I_a){this._checkKey&&null!=this.useDic[I_a]&&(this.useDic[I_a]=!0)},I_b.deleteShape=function(I_a){this.shapeDic[I_a]&&(this.shapeDic[I_a]=null,delete this.shapeDic[I_a]),this.shapeLineDic[I_a]&&(this.shapeLineDic[I_a]=null,delete this.shapeLineDic[I_a]),null!=this.useDic[I_a]&&delete this.useDic[I_a]},I_b.getCacheList=function(){var I_a,I_b=[];for(I_a in this.shapeDic)I_b.push(this.shapeDic[I_a]);for(I_a in this.shapeLineDic)I_b.push(this.shapeLineDic[I_a]);return I_b},I_b.startDispose=function(I_a){var I_b;for(I_b in this.useDic)this.useDic[I_b]=!1;this._checkKey=!0},I_b.endDispose=function(){if(this._checkKey){var I_a;for(I_a in this.useDic)this.useDic[I_a]||this.deleteShape(I_a);this._checkKey=!1}},I_a.getInstance=function(){return I_a.instance=I_a.instance||new I_a},I_a.instance=null,I_a}(),I_q=function(){function I_d(){this._obj=null,this._obj=I_d.supportWeakMap?new I_O.window.WeakMap:{},I_d.supportWeakMap||I_d._maps.push(this)}I_k(I_d,"laya.utils.WeakObject");var I_a=I_d.prototype;return I_a.set=function(I_a,I_b){if(null!=I_a)if(I_d.supportWeakMap){var I_c=I_a;"string"!=typeof I_a&&"number"!=typeof I_a||(I_c=I_d._keys[I_a])||(I_c=I_d._keys[I_a]={k:I_a}),this._obj.set(I_c,I_b)}else"string"==typeof I_a||"number"==typeof I_a?this._obj[I_a]=I_b:(I_a.$_GID||(I_a.$_GID=I_$.getGID()),this._obj[I_a.$_GID]=I_b)},I_a.get=function(I_a){if(null==I_a)return null;if(I_d.supportWeakMap){var I_b="string"==typeof I_a||"number"==typeof I_a?I_d._keys[I_a]:I_a;return I_b?this._obj.get(I_b):null}return"string"==typeof I_a||"number"==typeof I_a?this._obj[I_a]:this._obj[I_a.$_GID]},I_a.del=function(I_a){if(null!=I_a)if(I_d.supportWeakMap){var I_b="string"==typeof I_a||"number"==typeof I_a?I_d._keys[I_a]:I_a;if(!I_b)return;this._obj.delete(I_b)}else"string"==typeof I_a||"number"==typeof I_a?delete this._obj[I_a]:delete this._obj[this._obj.$_GID]},I_a.has=function(I_a){if(null==I_a)return!1;if(I_d.supportWeakMap){var I_b="string"==typeof I_a||"number"==typeof I_a?I_d._keys[I_a]:I_a;return this._obj.has(I_b)}return"string"==typeof I_a||"number"==typeof I_a?null!=this._obj[I_a]:null!=this._obj[this._obj.$_GID]},I_d.__init__=function(){(I_d.supportWeakMap=null!=I_O.window.WeakMap)||I_z.timer.loop(I_d.delInterval,null,I_d.clearCache)},I_d.clearCache=function(){for(var I_a=0,I_b=I_d._maps.length;I_a<I_b;I_a++){I_d._maps[I_a]._obj={}}},I_d.supportWeakMap=!1,I_d.delInterval=3e5,I_d._keys={},I_d._maps=[],I_i(I_d,["I",function(){return this.I=new I_d}]),I_d}(),I_r=function(){function I_a(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}I_k(I_a,"laya.utils.WordText");var I_b=I_a.prototype;return I_b.setText=function(I_a){this.changed=!0,this._text=I_a},I_b.toString=function(){return this._text},I_b.charCodeAt=function(I_a){return this._text?this._text.charCodeAt(I_a):NaN},I_b.charAt=function(I_a){return this._text?this._text.charAt(I_a):null},I_o(0,I_b,"length",function(){return this._text?this._text.length:0}),I_a}(),I_aa=function(I_a){function I_g(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,I_g.__super.call(this),this._childs=I_g.ARRAY_EMPTY,this._$P=I_g.PROP_EMPTY,this.timer=I_z.scaleTimer,this.conchModel=I_J.isConchNode?this.createConchModel():null}I_k(I_g,"laya.display.Node",I_j);var I_b=I_g.prototype;return I_b._setBit=function(I_a,I_b){1==I_a&&(this._getBit(I_a)!=I_b&&this._updateDisplayedInstage());I_b?this._bits|=I_a:this._bits&=~I_a},I_b._getBit=function(I_a){return 0!=(this._bits&I_a)},I_b._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},I_b._setUpNoticeType=function(I_a){var I_b=this;for(I_b._setBit(I_a,!0),I_b=I_b.parent;I_b;){if(I_b._getBit(I_a))return;I_b._setBit(I_a,!0),I_b=I_b.parent}},I_b.on=function(I_a,I_b,I_c,I_d){return"display"!==I_a&&"undisplay"!==I_a||this._getBit(1)||this._setUpNoticeType(1),this._createListener(I_a,I_b,I_c,I_d,!1)},I_b.once=function(I_a,I_b,I_c,I_d){return"display"!==I_a&&"undisplay"!==I_a||this._getBit(1)||this._setUpNoticeType(1),this._createListener(I_a,I_b,I_c,I_d,!0)},I_b.createConchModel=function(){return null},I_b.destroy=function(I_a){void 0===I_a&&(I_a=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(I_a?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},I_b.destroyChildren=function(){if(this._childs)for(var I_a=this._childs.length-1;-1<I_a;I_a--)this._childs[I_a].destroy(!0)},I_b.addChild=function(I_a){if(!I_a||this.destroyed||I_a===this)return I_a;if(I_a.zOrder&&this._set$P("hasZorder",!0),I_a._parent===this){var I_b=this.getChildIndex(I_a);I_b!==this._childs.length-1&&(this._childs.splice(I_b,1),this._childs.push(I_a),this.conchModel&&(this.conchModel.removeChild(I_a.conchModel),this.conchModel.addChildAt(I_a.conchModel,this._childs.length-1)),this._childChanged())}else I_a.parent&&I_a.parent.removeChild(I_a),this._childs===I_g.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(I_a),this.conchModel&&this.conchModel.addChildAt(I_a.conchModel,this._childs.length-1),(I_a.parent=this)._childChanged();return I_a},I_b.addChildren=function(I_a){for(var I_b=arguments,I_c=0,I_d=I_b.length;I_c<I_d;)this.addChild(I_b[I_c++])},I_b.addChildAt=function(I_a,I_b){if(!I_a||this.destroyed||I_a===this)return I_a;if(I_a.zOrder&&this._set$P("hasZorder",!0),0<=I_b&&I_b<=this._childs.length){if(I_a._parent===this){var I_c=this.getChildIndex(I_a);this._childs.splice(I_c,1),this._childs.splice(I_b,0,I_a),this.conchModel&&(this.conchModel.removeChild(I_a.conchModel),this.conchModel.addChildAt(I_a.conchModel,I_b)),this._childChanged()}else I_a.parent&&I_a.parent.removeChild(I_a),this._childs===I_g.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(I_b,0,I_a),this.conchModel&&this.conchModel.addChildAt(I_a.conchModel,I_b),I_a.parent=this;return I_a}throw new Error("appendChildAt:The index is out of bounds")},I_b.getChildIndex=function(I_a){return this._childs.indexOf(I_a)},I_b.getChildByName=function(I_a){var I_b=this._childs;if(I_b)for(var I_c=0,I_d=I_b.length;I_c<I_d;I_c++){var I_e=I_b[I_c];if(I_e.name===I_a)return I_e}return null},I_b._get$P=function(I_a){return this._$P[I_a]},I_b._set$P=function(I_a,I_b){return this.destroyed||(this._$P===I_g.PROP_EMPTY&&(this._$P={}),this._$P[I_a]=I_b),I_b},I_b.getChildAt=function(I_a){return this._childs[I_a]},I_b.setChildIndex=function(I_a,I_b){var I_c=this._childs;if(I_b<0||I_b>=I_c.length)throw new Error("setChildIndex:The index is out of bounds.");var I_d=this.getChildIndex(I_a);if(I_d<0)throw new Error("setChildIndex:node is must child of this object.");return I_c.splice(I_d,1),I_c.splice(I_b,0,I_a),this.conchModel&&(this.conchModel.removeChild(I_a.conchModel),this.conchModel.addChildAt(I_a.conchModel,I_b)),this._childChanged(),I_a},I_b._childChanged=function(I_a){},I_b.removeChild=function(I_a){if(!this._childs)return I_a;var I_b=this._childs.indexOf(I_a);return this.removeChildAt(I_b)},I_b.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},I_b.removeChildByName=function(I_a){var I_b=this.getChildByName(I_a);return I_b&&this.removeChild(I_b),I_b},I_b.removeChildAt=function(I_a){var I_b=this.getChildAt(I_a);if(I_b){for(var I_c=this._childs.length-1,I_d=I_a;I_d<I_c;++I_d)this._childs[I_d]=this._childs[I_d+1];this._childs.length=I_c,this.conchModel&&this.conchModel.removeChild(I_b.conchModel),I_b.parent=null}return I_b},I_b.removeChildren=function(I_a,I_b){if(void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=2147483647),this._childs&&0<this._childs.length){var I_c=this._childs;if(0===I_a&&I_f<=I_b){var I_d=I_c;this._childs=I_g.ARRAY_EMPTY}else I_d=I_c.splice(I_a,I_b-I_a);for(var I_e=0,I_f=I_d.length;I_e<I_f;I_e++)I_d[I_e].parent=null,this.conchModel&&this.conchModel.removeChild(I_d[I_e].conchModel)}return this},I_b.replaceChild=function(I_a,I_b){var I_c=this._childs.indexOf(I_b);return-1<I_c?(this._childs.splice(I_c,1,I_a),this.conchModel&&(this.conchModel.removeChild(I_b.conchModel),this.conchModel.addChildAt(I_a.conchModel,I_c)),I_b.parent=null,I_a.parent=this,I_a):null},I_b._updateDisplayedInstage=function(){var I_a;I_a=this;var I_b=I_z.stage;for(this._displayedInStage=!1;I_a;){if(I_a._getBit(1)){this._displayedInStage=I_a._displayedInStage;break}if(I_a==I_b||I_a._displayedInStage){this._displayedInStage=!0;break}I_a=I_a.parent}},I_b._setDisplay=function(I_a){this._displayedInStage!==I_a&&((this._displayedInStage=I_a)?this.event("display"):this.event("undisplay"))},I_b._displayChild=function(I_a,I_b){var I_c=I_a._childs;if(I_c)for(var I_d=0;I_d<I_c.length;I_d++){var I_e=I_c[I_d];I_e&&I_e._getBit(1)&&(0<I_e._childs.length?this._displayChild(I_e,I_b):I_e._setDisplay(I_b))}I_a._setDisplay(I_b)},I_b.contains=function(I_a){if(I_a===this)return!0;for(;I_a;){if(I_a.parent===this)return!0;I_a=I_a.parent}return!1},I_b.timerLoop=function(I_a,I_b,I_c,I_d,I_e,I_f){void 0===I_e&&(I_e=!0),void 0===I_f&&(I_f=!1),this.timer.loop(I_a,I_b,I_c,I_d,I_e,I_f)},I_b.timerOnce=function(I_a,I_b,I_c,I_d,I_e){void 0===I_e&&(I_e=!0),this.timer._create(!1,!1,I_a,I_b,I_c,I_d,I_e)},I_b.frameLoop=function(I_a,I_b,I_c,I_d,I_e){void 0===I_e&&(I_e=!0),this.timer._create(!0,!0,I_a,I_b,I_c,I_d,I_e)},I_b.frameOnce=function(I_a,I_b,I_c,I_d,I_e){void 0===I_e&&(I_e=!0),this.timer._create(!0,!1,I_a,I_b,I_c,I_d,I_e)},I_b.clearTimer=function(I_a,I_b){this.timer.clear(I_a,I_b)},I_o(0,I_b,"numChildren",function(){return this._childs.length}),I_o(0,I_b,"destroyed",function(){return this._destroyed}),I_o(0,I_b,"parent",function(){return this._parent},function(I_a){this._parent!==I_a&&(I_a?(this._parent=I_a,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),I_a.displayedInStage&&this._displayChild(this,!0)),I_a._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=I_a))}),I_o(0,I_b,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),I_g.ARRAY_EMPTY=[],I_g.PROP_EMPTY={},I_g.NOTICE_DISPLAY=1,I_g.MOUSEENABLE=2,I_g}(),I_ba=function(I_a){function I_m(I_a){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,I_m.__super.call(this),this._padding=I_m._PADDING,this._spacing=I_m._SPACING,this._aligns=I_m._ALIGNS,this._font=I_n.EMPTY,this._ower=I_a}I_k(I_m,"laya.display.css.CSSStyle",I_a);var I_b=I_m.prototype;return I_b.destroy=function(){this._ower=null,this._font=null,this._rect=null},I_b.inherit=function(I_a){this._font=I_a._font,this._spacing=I_a._spacing===I_m._SPACING?I_m._SPACING:I_a._spacing.slice(),this.lineHeight=I_a.lineHeight},I_b._widthAuto=function(){return 0!=(262144&this._type)},I_b.widthed=function(I_a){return 0!=(8&this._type)},I_b._calculation=function(I_a,I_b){if(I_b.indexOf("%")<0)return!1;var I_d=this._ower,I_e=I_d.parent,I_f=this._rect;function I_g(I_a,I_b,I_c){return I_a*I_c[0]+I_b*I_c[1]+I_c[2]}function I_c(I_a){var I_b=I_e.width,I_c=I_d.width;I_f.width&&(I_d.width=I_g(I_b,I_c,I_f.width)),I_f.height&&(I_d.height=I_g(I_b,I_c,I_f.height)),I_f.left&&(I_d.x=I_g(I_b,I_c,I_f.left)),I_f.top&&(I_d.y=I_g(I_b,I_c,I_f.top))}null===I_f&&(I_e._getCSSStyle()._type|=524288,I_e.on("resize",this,I_c),this._rect=I_f={input:{}});var I_h=I_b.split(" ");return I_h[0]=parseFloat(I_h[0])/100,1==I_h.length?I_h[1]=I_h[2]=0:(I_h[1]=parseFloat(I_h[1])/100,I_h[2]=parseFloat(I_h[2])),I_f[I_a]=I_h,I_f.input[I_a]=I_b,I_c(),!0},I_b.heighted=function(I_a){return 0!=(8192&this._type)},I_b.size=function(I_a,I_b){var I_c=this._ower,I_d=!1;-1!==I_a&&I_a!=this._ower.width&&(this._type|=8,this._ower.width=I_a,I_d=!0),-1!==I_b&&I_b!=this._ower.height&&(this._type|=8192,this._ower.height=I_b,I_d=!0),I_d&&(I_c._layoutLater(),524288&this._type&&I_c.event("resize",this))},I_b._getAlign=function(){return this._aligns[0]},I_b._getValign=function(){return this._aligns[1]},I_b._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},I_b._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new I_n(this._font))},I_b.render=function(I_a,I_b,I_c,I_d){var I_e=I_a.width,I_f=I_a.height;I_c-=I_a.pivotX,I_d-=I_a.pivotY,this._bgground&&null!=this._bgground.color&&I_b.ctx.fillRect(I_c,I_d,I_e,I_f,this._bgground.color),this._border&&this._border.color&&I_b.drawRect(I_c,I_d,I_e,I_f,this._border.color.strColor,this._border.size)},I_b.getCSSStyle=function(){return this},I_b.cssText=function(I_a){this.attrs(I_m.parseOneCSS(I_a,";"))},I_b.attrs=function(I_a){if(I_a)for(var I_b=0,I_c=I_a.length;I_b<I_c;I_b++){var I_d=I_a[I_b];this[I_d[0]]=I_d[1]}},I_b.setTransform=function(I_a){"none"===I_a?this._tf=I_h._TF_EMPTY:this.attrs(I_m.parseOneCSS(I_a,","))},I_b.translate=function(I_a,I_b){this._tf===I_h._TF_EMPTY&&(this._tf=new I_e),this._tf.translateX=I_a,this._tf.translateY=I_b},I_b.scale=function(I_a,I_b){this._tf===I_h._TF_EMPTY&&(this._tf=new I_e),this._tf.scaleX=I_a,this._tf.scaleY=I_b},I_b._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},I_o(0,I_b,"block",I_a.prototype._$get_block,function(I_a){I_a?this._type|=1:this._type&=-2}),I_o(0,I_b,"valign",function(){return I_m._valigndef[this._aligns[1]]},function(I_a){this._aligns===I_m._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=I_m._valigndef[I_a]}),I_o(0,I_b,"height",null,function(I_a){if(this._type|=8192,"string"==typeof I_a){if(this._calculation("height",I_a))return;I_a=parseInt(I_a)}this.size(-1,I_a)}),I_o(0,I_b,"width",null,function(I_a){if(this._type|=8,"string"==typeof I_a){var I_b=I_a.indexOf("auto");if(0<=I_b&&(this._type|=262144,I_a=I_a.substr(0,I_b)),this._calculation("width",I_a))return;I_a=parseInt(I_a)}this.size(I_a,-1)}),I_o(0,I_b,"fontWeight",function(){return this._font.weight},function(I_a){this._createFont().weight=I_a}),I_o(0,I_b,"left",null,function(I_a){var I_b=this._ower;if("string"==typeof I_a){if("center"===I_a?I_a="50% -50% 0":"right"===I_a&&(I_a="100% -100% 0"),this._calculation("left",I_a))return;I_a=parseInt(I_a)}I_b.x=I_a}),I_o(0,I_b,"_translate",null,function(I_a){this.translate(I_a[0],I_a[1])}),I_o(0,I_b,"absolute",function(){return 0!=(4&this._type)}),I_o(0,I_b,"top",null,function(I_a){var I_b=this._ower;if("string"==typeof I_a){if("middle"===I_a?I_a="50% -50% 0":"bottom"===I_a&&(I_a="100% -100% 0"),this._calculation("top",I_a))return;I_a=parseInt(I_a)}I_b.y=I_a}),I_o(0,I_b,"align",function(){return I_m._aligndef[this._aligns[0]]},function(I_a){this._aligns===I_m._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=I_m._aligndef[I_a]}),I_o(0,I_b,"bold",function(){return this._font.bold},function(I_a){this._createFont().bold=I_a}),I_o(0,I_b,"padding",function(){return this._padding},function(I_a){this._padding=I_a}),I_o(0,I_b,"leading",function(){return this._spacing[1]},function(I_a){"string"==typeof I_a&&(I_a=parseInt(I_a+"")),this._spacing===I_m._SPACING&&(this._spacing=[0,0]),this._spacing[1]=I_a}),I_o(0,I_b,"lineElement",function(){return 0!=(65536&this._type)},function(I_a){I_a?this._type|=65536:this._type&=-65537}),I_o(0,I_b,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(I_a){this.lineElement=!1,"right"===I_a?this._type|=32768:this._type&=-32769}),I_o(0,I_b,"textDecoration",function(){return this._font.decoration},function(I_a){this._createFont().decoration=I_a}),I_o(0,I_b,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(I_a){"nowrap"===I_a&&(this._type|=131072),"none"===I_a&&(this._type&=-131073)}),I_o(0,I_b,"background",null,function(I_a){I_a?(this._bgground||(this._bgground={}),this._bgground.color=I_a,this._ower.conchModel&&this._ower.conchModel.bgColor(I_a),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),I_o(0,I_b,"wordWrap",function(){return 0==(131072&this._type)},function(I_a){I_a?this._type&=-131073:this._type|=131072}),I_o(0,I_b,"color",function(){return this._font.color},function(I_a){this._createFont().color=I_a}),I_o(0,I_b,"password",function(){return this._font.password},function(I_a){this._createFont().password=I_a}),I_o(0,I_b,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(I_a){"none"===I_a?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=I_a),this._ower.conchModel&&this._ower.conchModel.bgColor(I_a),this._ower._renderType|=256}),I_o(0,I_b,"font",function(){return this._font.toString()},function(I_a){this._createFont().set(I_a)}),I_o(0,I_b,"weight",null,function(I_a){this._createFont().weight=I_a}),I_o(0,I_b,"letterSpacing",function(){return this._spacing[0]},function(I_a){"string"==typeof I_a&&(I_a=parseInt(I_a+"")),this._spacing===I_m._SPACING&&(this._spacing=[0,0]),this._spacing[0]=I_a}),I_o(0,I_b,"fontSize",function(){return this._font.size},function(I_a){this._createFont().size=I_a}),I_o(0,I_b,"italic",function(){return this._font.italic},function(I_a){this._createFont().italic=I_a}),I_o(0,I_b,"fontFamily",function(){return this._font.family},function(I_a){this._createFont().family=I_a}),I_o(0,I_b,"stroke",function(){return this._font.stroke[0]},function(I_a){this._createFont().stroke===I_n._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=I_a}),I_o(0,I_b,"strokeColor",function(){return this._font.stroke[1]},function(I_a){this._createFont().stroke===I_n._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=I_a}),I_o(0,I_b,"border",function(){return this._border?this._border.value:""},function(I_a){if("none"!=I_a){this._border||(this._border={});var I_b=(this._border.value=I_a).split(" ");if(this._border.color=I_S.create(I_b[I_b.length-1]),1==I_b.length)return this._border.size=1,void(this._border.type="solid");var I_c=0;0<I_b[0].indexOf("px")?(this._border.size=parseInt(I_b[0]),I_c++):this._border.size=1,this._border.type=I_b[I_c],this._ower._renderType|=256}else this._border=null}),I_o(0,I_b,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(I_a){I_a?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==I_a?null:I_S.create(I_a),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),I_o(0,I_b,"position",function(){return 4&this._type?"absolute":""},function(I_a){"absolute"==I_a?this._type|=4:this._type&=-5}),I_o(0,I_b,"display",null,function(I_a){switch(I_a){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),I_o(0,I_b,"paddingLeft",function(){return this.padding[3]}),I_o(0,I_b,"paddingTop",function(){return this.padding[0]}),I_o(0,I_b,"_scale",null,function(I_a){this._ower.scale(I_a[0],I_a[1])}),I_o(0,I_b,"_rotate",null,function(I_a){this._ower.rotation=I_a}),I_m.parseOneCSS=function(I_a,I_b){for(var I_c,I_d=[],I_e=I_a.split(I_b),I_f=0,I_g=I_e.length;I_f<I_g;I_f++){var I_h=I_e[I_f],I_i=I_h.indexOf(":"),I_j=I_h.substr(0,I_i).replace(/^\s+|\s+$/g,"");if(0!=I_j.length){var I_k=I_h.substr(I_i+1).replace(/^\s+|\s+$/g,""),I_l=[I_j,I_k];switch(I_j){case"italic":case"bold":I_l[1]="true"==I_k;break;case"line-height":I_l[0]="lineHeight",I_l[1]=parseInt(I_k);break;case"font-size":I_l[0]="fontSize",I_l[1]=parseInt(I_k);break;case"padding":1<(I_c=I_k.split(" ")).length||(I_c[1]=I_c[2]=I_c[3]=I_c[0]),I_l[1]=[parseInt(I_c[0]),parseInt(I_c[1]),parseInt(I_c[2]),parseInt(I_c[3])];break;case"rotate":I_l[0]="_rotate",I_l[1]=parseFloat(I_k);break;case"scale":I_c=I_k.split(" "),I_l[0]="_scale",I_l[1]=[parseFloat(I_c[0]),parseFloat(I_c[1])];break;case"translate":I_c=I_k.split(" "),I_l[0]="_translate",I_l[1]=[parseInt(I_c[0]),parseInt(I_c[1])];break;default:(I_l[0]=I_m._CSSTOVALUE[I_j])||(I_l[0]=I_j)}I_d.push(I_l)}}return I_d},I_m.parseCSS=function(I_a,I_b){for(var I_c;null!=(I_c=I_m._parseCSSRegExp.exec(I_a));)I_m.styleSheets[I_c[1]]=I_m.parseOneCSS(I_c[2],";")},I_m.EMPTY=new I_m(null),I_m._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},I_m._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),I_m._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},I_m._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},I_m.styleSheets={},I_m.ALIGN_CENTER=1,I_m.ALIGN_RIGHT=2,I_m.VALIGN_MIDDLE=1,I_m.VALIGN_BOTTOM=2,I_m._CSS_BLOCK=1,I_m._DISPLAY_NONE=2,I_m._ABSOLUTE=4,I_m._WIDTH_SET=8,I_m._PADDING=[0,0,0,0],I_m._RECT=[-1,-1,-1,-1],I_m._SPACING=[0,0],I_m._ALIGNS=[0,0,0],I_m.ADDLAYOUTED=512,I_m._NEWFONT=4096,I_m._HEIGHT_SET=8192,I_m._BACKGROUND_SET=16384,I_m._FLOAT_RIGHT=32768,I_m._LINE_ELEMENT=65536,I_m._NOWARP=131072,I_m._WIDTHAUTO=262144,I_m._LISTERRESZIE=524288,I_m}(I_h),I_ca=function(I_a){function I_g(){this.url=null,this.audio=null,this.loaded=!1,I_g.__super.call(this)}I_k(I_g,"laya.media.h5audio.AudioSound",I_j);var I_b=I_g.prototype;return I_b.dispose=function(){var I_a=I_g._audioCache[this.url];I_a&&(I_a.src="",delete I_g._audioCache[this.url])},I_b.load=function(I_a){var I_b;if(I_a=I_I.formatURL(I_a),(this.url=I_a)==I_E._tMusic?(I_g._initMusicAudio(),(I_b=I_g._musicAudio).src!=I_a&&(I_g._audioCache[I_b.src]=null,I_b=null)):I_b=I_g._audioCache[I_a],I_b&&2<=I_b.readyState)this.event("complete");else{I_b||(I_b=I_a==I_E._tMusic?(I_g._initMusicAudio(),I_g._musicAudio):I_O.createElement("audio"),(I_g._audioCache[I_a]=I_b).src=I_a),I_b.addEventListener("canplaythrough",I_d),I_b.addEventListener("error",I_e);var I_c=this;(this.audio=I_b).load?I_b.load():I_e()}function I_d(){I_f(),I_c.loaded=!0,I_c.event("complete")}function I_e(){I_b.load=null,I_f(),I_c.event("error")}function I_f(){I_b.removeEventListener("canplaythrough",I_d),I_b.removeEventListener("error",I_e)}},I_b.play=function(I_a,I_b,I_c){if(void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),!this.url)return null;var I_d,I_e;if(!(I_d=this.url==I_E._tMusic?I_g._musicAudio:I_g._audioCache[this.url]))return null;I_e=I_W.getItem("audio:"+this.url),I_J.isConchApp?I_e||((I_e=I_O.createElement("audio")).src=this.url):this.url==I_E._tMusic?(I_g._initMusicAudio(),(I_e=I_g._musicAudio).src=this.url):I_e=I_e||I_d.cloneNode(!0);var I_f=new I_ma(I_e);return I_f.url=this.url,I_f.loops=I_b,I_f.startTime=I_a,I_f.startHandler=I_c,I_f.play(!1),I_E.addChannel(I_f),I_f},I_o(0,I_b,"duration",function(){var I_a;return(I_a=I_g._audioCache[this.url])?I_a.duration:0}),I_g._initMusicAudio=function(){I_g._musicAudio||(I_g._musicAudio||(I_g._musicAudio=I_O.createElement("audio")),I_J.isConchApp||I_O.document.addEventListener("mousedown",I_g._makeMusicOK))},I_g._makeMusicOK=function(){I_O.document.removeEventListener("mousedown",I_g._makeMusicOK),I_g._musicAudio.src?I_g._musicAudio.play():(I_g._musicAudio.src="",I_g._musicAudio.load())},I_g._audioCache={},I_g._musicAudio=null,I_g}(),I_da=function(I_a){function I_b(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,I_b.__super.call(this)}I_k(I_b,"laya.media.SoundChannel",I_j);var I_c=I_b.prototype;return I_c.play=function(){},I_c.stop=function(){},I_c.pause=function(){},I_c.resume=function(){},I_c.__runComplete=function(I_a){I_a&&I_a.run()},I_o(0,I_c,"volume",function(){return 1},function(I_a){}),I_o(0,I_c,"position",function(){return 0}),I_o(0,I_c,"duration",function(){return 0}),I_b}(),I_ea=function(I_a){function I_b(){I_b.__super.call(this)}I_k(I_b,"laya.media.Sound",I_j);var I_c=I_b.prototype;return I_c.load=function(I_a){},I_c.play=function(I_a,I_b,I_c){return void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),null},I_c.dispose=function(){},I_o(0,I_c,"duration",function(){return 0}),I_b}(),I_fa=function(I_a){function I_e(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,I_e.__super.call(this)}I_k(I_e,"laya.media.webaudio.WebAudioSound",I_j);var I_b=I_e.prototype;return I_b.load=function(I_a){this.url=I_a,this.audioBuffer=I_e._dataCache[I_a],this.audioBuffer?this._loaded(this.audioBuffer):(I_e.e.on("loaded:"+I_a,this,this._loaded),I_e.e.on("err:"+I_a,this,this._err),I_e.__loadingSound[I_a]||(I_e.__loadingSound[I_a]=!0,I_z.loader.load(I_a,I_u.create(this,this.onloaded),null,I_ha.BUFFER,4,!1,null,!0)))},I_b.onloaded=function(I_a){I_a||this._err(),this._disposed?this._removeLoadEvents():(this.data=I_a,I_e.buffs.push({buffer:this.data,url:this.url}),I_e.decode())},I_b._err=function(){if(this._removeLoadEvents(),I_e.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var I_a,I_b,I_c,I_d=0;for(I_a=(I_b=this.__toPlays).length,I_d=0;I_d<I_a;I_d++)(I_c=I_b[I_d])[3]&&!I_c[3].isStopped&&I_c[3].event("error");this.__toPlays.length=0}},I_b._loaded=function(I_a){this._removeLoadEvents(),this._disposed||(this.audioBuffer=I_a,this.loaded=!0,this.event("complete"))},I_b._removeLoadEvents=function(){I_e.e.off("loaded:"+this.url,this,this._loaded),I_e.e.off("err:"+this.url,this,this._err)},I_b.__playAfterLoaded=function(){if(this.__toPlays){var I_a,I_b,I_c,I_d=0;for(I_a=(I_b=this.__toPlays).length,I_d=0;I_d<I_a;I_d++)(I_c=I_b[I_d])[3]&&!I_c[3].isStopped&&this.play(I_c[0],I_c[1],I_c[2],I_c[3]);this.__toPlays.length=0}},I_b.play=function(I_a,I_b,I_c,I_d){return void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),I_d=I_d||new I_na,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([I_a,I_b,I_c,I_d]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),I_d.url=this.url,I_d.loops=I_b,I_d.audioBuffer=this.audioBuffer,I_d.startTime=I_a,I_d.startHandler=I_c,I_d.play(!1),I_E.addChannel(I_d),I_d},I_b.dispose=function(){this._disposed=!0,delete I_e._dataCache[this.url],delete I_e.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},I_o(0,I_b,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),I_e.decode=function(){if(!(I_e.buffs.length<=0||I_e.isDecoding))if(I_e.isDecoding=!0,(I_e.tInfo=I_e.buffs.shift())&&I_e.tInfo.buffer&&I_e.tInfo.buffer.byteLength)try{I_e.ctx.decodeAudioData(I_e.tInfo.buffer,I_e._done,I_e._fail)}catch(I_a){console.error("decodeAudioData error  byteLength:"+I_e.tInfo.buffer.byteLength+"  url:"+I_e.tInfo.url)}else I_e._fail()},I_e._done=function(I_a){I_e.e.event("loaded:"+I_e.tInfo.url,I_a),I_e._dataCache[I_e.tInfo.url]=I_a,I_e.isDecoding=!1,I_e.decode()},I_e._fail=function(){I_e.e.event("err:"+I_e.tInfo.url,null),I_e.isDecoding=!1,I_e.decode()},I_e._playEmptySound=function(){if(null!=I_e.ctx){if(I_e._emptySource&&(I_e._emptySource.stop(),I_e._emptySource.disconnect(0),!I_na._tryCleanFailed))try{I_e._emptySource.buffer=null}catch(I_a){I_na._tryCleanFailed=!0}var I_a=I_e.ctx.createBufferSource();I_a.buffer=I_e._miniBuffer,I_a.connect(I_e.ctx.destination),I_a.start(0,0,0),I_e._emptySource=I_a}},I_e._unlock=function(){I_e._unlocked||(I_e._playEmptySound(),"running"==I_e.ctx.state?(I_O.document.removeEventListener("mousedown",I_e._unlock,!0),I_O.document.removeEventListener("touchend",I_e._unlock,!0),I_O.document.removeEventListener("touchstart",I_e._unlock,!0),I_e._unlocked=!0):"suspended"==I_e.ctx.state&&I_E._recoverWebAudio())},I_e.initWebAudio=function(){"running"!=I_e.ctx.state&&(I_e._unlock(),I_O.document.addEventListener("mousedown",I_e._unlock,!0),I_O.document.addEventListener("touchend",I_e._unlock,!0),I_O.document.addEventListener("touchstart",I_e._unlock,!0))},I_e._emptySource=null,I_e._dataCache={},I_e.buffs=[],I_e.isDecoding=!1,I_e._unlocked=!1,I_e.tInfo=null,I_e.__loadingSound={},I_i(I_e,["window",function(){return this.window=I_O.window},"webAudioEnabled",function(){return this.webAudioEnabled=I_e.window.AudioContext||I_e.window.webkitAudioContext||I_e.window.mozAudioContext},"ctx",function(){return this.ctx=I_e.webAudioEnabled?new(I_e.window.AudioContext||I_e.window.webkitAudioContext||I_e.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=I_e.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new I_j}]),I_e}(),I_ga=function(I_a){function I_b(){this._responseType=null,this._data=null,I_b.__super.call(this),this._http=new I_O.window.XMLHttpRequest}I_k(I_b,"laya.net.HttpRequest",I_j);var I_c=I_b.prototype;return I_c.send=function(I_a,I_b,I_c,I_d,I_e){void 0===I_c&&(I_c="get"),void 0===I_d&&(I_d="text"),this._responseType=I_d,this._data=null;var I_f=this,I_g=this._http;if(I_g.open(I_c,I_a,!0),I_e)for(var I_h=0;I_h<I_e.length;I_h++)I_g.setRequestHeader(I_e[I_h++],I_e[I_h]);else I_J.isConchApp||(I_b&&"string"!=typeof I_b?I_g.setRequestHeader("Content-Type","application/json"):I_g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));I_g.responseType="arraybuffer"!==I_d?"text":"arraybuffer",I_g.onerror=function(I_a){I_f._onError(I_a)},I_g.onabort=function(I_a){I_f._onAbort(I_a)},I_g.onprogress=function(I_a){I_f._onProgress(I_a)},I_g.onload=function(I_a){I_f._onLoad(I_a)},I_g.send(I_b)},I_c._onProgress=function(I_a){I_a&&I_a.lengthComputable&&this.event("progress",I_a.loaded/I_a.total)},I_c._onAbort=function(I_a){this.error("Request was aborted by user")},I_c._onError=function(I_a){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},I_c._onLoad=function(I_a){var I_b=this._http,I_c=void 0!==I_b.status?I_b.status:200;200===I_c||204===I_c||0===I_c?this.complete():this.error("["+I_b.status+"]"+I_b.statusText+":"+I_b.responseURL)},I_c.error=function(I_a){this.clear(),this.event("error",I_a)},I_c.complete=function(){this.clear();var I_b=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=I_$.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(I_a){I_b=!1,this.error(I_a.message)}I_b&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},I_c.clear=function(){var I_a=this._http;I_a.onerror=I_a.onabort=I_a.onprogress=I_a.onload=null},I_o(0,I_c,"url",function(){return this._http.responseURL}),I_o(0,I_c,"http",function(){return this._http}),I_o(0,I_c,"data",function(){return this._data}),I_b}(),I_ha=function(I_a){function I_C(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,I_C.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}I_k(I_C,"laya.net.Loader",I_j);var I_b=I_C.prototype;return I_b.load=function(I_a,I_b,I_c,I_d,I_e){if(I_a&&""!=I_a||console.error("Loader 加载的url不合法 "+I_a),void 0===I_c&&(I_c=!0),void 0===I_e&&(I_e=!1),0===(this._url=I_a).indexOf("data:image")?this._type=I_b="image":this._type=I_b||(I_b=this.getTypeFromUrl(I_a)),this._cache=I_c,this._data=null,!I_e&&I_C.loadedMap[I_a])return this._data=I_C.loadedMap[I_a],this.event("progress",1),void this.event("complete",this._data);if(I_d&&I_C.setGroup(I_a,I_d),null!=I_C.parserMap[I_b])return this._customParse=!0,void(I_C.parserMap[I_b]instanceof laya.utils.Handler?I_C.parserMap[I_b].runWith(this):I_C.parserMap[I_b].call(null,this));if("image"===I_b||"htmlimage"===I_b||"nativeimage"===I_b)return this._loadImage(I_a);if("ttf"===I_b)return this._loadTTF(I_a);switch(I_b){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:I_b}I_C.preLoadedMap[I_a]?this.onLoaded(I_C.preLoadedMap[I_a]):I_g.resMgrLoad(I_a,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},I_b.getTypeFromUrl=function(I_a){var I_b=I_$.getFileExtension(I_a);return I_b?I_C.typeMap[I_b]:(console.warn("Not recognize the resources suffix",I_a),"text")},I_b._loadTTF=function(I_a){I_a=I_I.formatURL(I_a);var I_b=new I_H;I_b.complete=I_u.create(this,this.onLoaded),I_b.load(I_a)},I_b._loadImage=function(I_a){I_g.imgMgrLoad(I_a,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},I_b._loadImageComplete=function(I_a,I_b,I_c){if(null!=I_c)if(I_c instanceof ArrayBuffer){var I_d=new DataView(I_c),I_e=new laya.webgl.resource.WebGLImage(new Uint8Array(I_c,8),I_a,0,!1,I_d.getUint32(0),I_d.getUint32(4));this.onLoaded(I_e)}else if(I_c instanceof I_ka)I_C.imgMgrSet[I_a]=I_b,I_g.imgMgrLock(I_a,I_C.imgMgrSet[I_a]),this._url=I_a,this.complete(I_c);else{var I_f=-1!=I_a.indexOf(".png",I_a.length-4)?6408:6407;I_e=new laya.webgl.resource.WebGLImage(I_c,I_a,I_f,!1,I_c.width,I_c.height);this.onLoaded(I_e)}else this.event("error","Load image failed")},I_b._loadSound=function(I_a){var I_b=new I_E._soundClass,I_c=this;function I_d(){I_b.offAll()}I_b.on("complete",this,function(){I_d(),I_c.onLoaded(I_b)}),I_b.on("error",this,function(){I_d(),I_b.dispose(),I_c.event("error","Load sound failed")}),I_b.load(I_a)},I_b.onProgress=function(I_a){"atlas"===this._type?this.event("progress",.3*I_a):this.event("progress",I_a)},I_b.onError=function(I_a){this.event("error",I_a)},I_b._loadedComplete=function(I_a,I_b,I_c){if(null!=I_c)switch(this._type){case"atlas":case"plf":case"json":var I_d=new I_P(I_c);this.onLoaded(JSON.parse(I_d.readUTFBytes()));break;case"font":I_d=new I_P(I_c);this.onLoaded(I_$.parseXMLFromString(I_d.readUTFBytes()));break;default:this.onLoaded(I_c)}else this.event("error",I_a)},I_b.onLoaded=function(I_a){var I_b=this._type;if("plf"==I_b)this.parsePLFData(I_a),this.complete(I_a);else if("image"===I_b){var I_c=new I_ka(I_a);I_c.url=this._url,this.complete(I_c)}else if("sound"===I_b||"htmlimage"===I_b||"nativeimage"===I_b)this.complete(I_a);else if("atlas"===I_b){if(!I_a.src&&!I_a._setContext){if(!this._data){if((this._data=I_a).meta&&I_a.meta.image)for(var I_d=I_a.meta.image.split(","),I_e=0<=this._url.indexOf("/")?"/":"\\",I_f=this._url.lastIndexOf(I_e),I_g=0<=I_f?this._url.substr(0,I_f+1):"",I_h=0,I_i=I_d.length;I_h<I_i;I_h++)I_d[I_h]=I_g+I_d[I_h];else I_d=[this._url.replace(".json",".png")];I_d.reverse(),I_a.toLoads=I_d,I_a.pics=[]}return this.event("progress",.3+1/I_d.length*.6),this._loadImage(I_d.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(I_a),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var I_j=this._data.frames,I_k=this._url.split("?")[0],I_l=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:I_k.substring(0,I_k.lastIndexOf("."))+"/",I_m=this._data.pics,I_n=I_I.formatURL(this._url),I_o=I_C.atlasMap[I_n]||(I_C.atlasMap[I_n]=[]);I_o.dir=I_l;var I_p=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var I_s in I_p=parseFloat(this._data.meta.scale),I_j){var I_t,I_u=I_j[I_s],I_v=I_m[I_u.frame.idx?I_u.frame.idx:0],I_w=I_I.formatURL(I_l+I_s);I_v.scaleRate=I_p,I_t=I_ka.create(I_v,I_u.frame.x,I_u.frame.y,I_u.frame.w,I_u.frame.h,I_u.spriteSourceSize.x,I_u.spriteSourceSize.y,I_u.sourceSize.w,I_u.sourceSize.h),I_C.cacheRes(I_w,I_t),I_C.keepCache(this._url,I_l+I_s),I_t.url=I_w,I_o.push(I_w)}else for(I_s in I_j)I_v=I_m[(I_u=I_j[I_s]).frame.idx?I_u.frame.idx:0],I_w=I_I.formatURL(I_l+I_s),I_C.cacheRes(I_w,I_ka.create(I_v,I_u.frame.x,I_u.frame.y,I_u.frame.w,I_u.frame.h,I_u.spriteSourceSize.x,I_u.spriteSourceSize.y,I_u.sourceSize.w,I_u.sourceSize.h)),I_C.loadedMap[I_w].url=I_w,I_C.keepCache(this._url,I_l+I_s),I_o.push(I_w);delete this._data.pics,this.complete(this._data)}else if("font"==I_b){if(!I_a.src)return this._data=I_a,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var I_x=new I_D;I_x.parseFont(this._data,I_a);var I_y=this._url.split(".fnt")[0].split("/"),I_z=I_y[I_y.length-1];I_sa.registerBitmapFont(I_z,I_x),this._data=I_x,this.complete(this._data)}else if("pkm"==I_b){var I_A=I_ya.create(I_a,this._url),I_B=new I_ka(I_A);I_B.url=this._url,this.complete(I_B)}else this.complete(I_a)},I_b.parsePLFData=function(I_a){var I_b,I_c,I_d;for(I_b in I_a)switch(I_d=I_a[I_b],I_b){case"json":case"text":for(I_c in I_d)I_C.preLoadedMap[I_I.formatURL(I_c)]=I_d[I_c];break;default:for(I_c in I_d)I_C.preLoadedMap[I_I.formatURL(I_c)]=I_d[I_c]}},I_b.complete=function(I_a){this._data=I_a,this._customParse?this.event("loaded",I_a instanceof Array?[I_a]:I_a):(I_C._loaders.push(this),I_C._isWorking||I_C.checkNext())},I_b.endLoad=function(I_a){I_a&&(this._data=I_a),this._cache&&I_C.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},I_o(0,I_b,"url",function(){return this._url}),I_o(0,I_b,"data",function(){return this._data}),I_o(0,I_b,"cache",function(){return this._cache}),I_o(0,I_b,"type",function(){return this._type}),I_C.checkNext=function(){I_C._isWorking=!0;for(var I_a=I_O.now();I_C._startIndex<I_C._loaders.length;)if(I_O.now(),I_C._loaders[I_C._startIndex].endLoad(),I_C._startIndex++,I_O.now()-I_a>I_C.maxTimeOut)return console.warn("loader callback cost a long time:"+(I_O.now()-I_a)+" url="+I_C._loaders[I_C._startIndex-1].url),void I_z.timer.frameOnce(1,null,I_C.checkNext);I_C._loaders.length=0,I_C._startIndex=0,I_C._isWorking=!1},I_C.clearRes=function(I_a,I_b){if(null!=I_a){void 0===I_b&&(I_b=!1),I_a=I_I.formatURL(I_a);var I_c=I_C.getAtlas(I_a);if(I_c){for(var I_d=0,I_e=I_c.length;I_d<I_e;I_d++){var I_f=I_c[I_d],I_g=I_C.getRes(I_f);delete I_C.loadedMap[I_f],I_C.clearCache(I_a.substring(I_I.basePath.length),I_f.substring(I_I.basePath.length)),I_g&&I_g.destroy(I_b)}I_c.length=0,delete I_C.atlasMap[I_a],delete I_C.loadedMap[I_a]}else{var I_h=I_C.loadedMap[I_a];I_h&&(delete I_C.loadedMap[I_a],I_h instanceof laya.resource.Texture&&I_h.bitmap&&I_h.destroy(I_b))}}},I_C.clearTextureRes=function(I_a){I_a=I_I.formatURL(I_a);var I_b=laya.net.Loader.getAtlas(I_a),I_c=I_b&&0<I_b.length?laya.net.Loader.getRes(I_b[0]):laya.net.Loader.getRes(I_a);I_c&&I_c.bitmap&&(I_J.isConchApp&&!I_J.isConchWebGL?I_c.bitmap.source.releaseTexture&&I_c.bitmap.source.releaseTexture():null==I_c.bitmap._atlaser&&I_c.bitmap.releaseResource(!0))},I_C.getRes=function(I_a){return I_C.loadedMap[I_I.formatURL(I_a)]},I_C.getAtlas=function(I_a){return I_C.atlasMap[I_I.formatURL(I_a)]},I_C.cacheRes=function(I_a,I_b){I_a=I_I.formatURL(I_a),null!=I_C.loadedMap[I_a]?console.warn("Resources already exist,is repeated loading:",I_a):I_C.loadedMap[I_a]=I_b},I_C.setGroup=function(I_a,I_b){I_C.groupMap[I_b]||(I_C.groupMap[I_b]=[]),I_C.groupMap[I_b].push(I_a)},I_C.clearResByGroup=function(I_a){if(I_C.groupMap[I_a]){var I_b=I_C.groupMap[I_a],I_c=0,I_d=I_b.length;for(I_c=0;I_c<I_d;I_c++)I_C.clearRes(I_b[I_c]);I_b.length=0}},I_C.keepCache=function(I_a,I_b){if(I_a&&I_b){var I_c=I_C.cacheSet[I_b];I_c?-1==I_c.indexOf(I_a)&&I_c.push(I_a):I_C.cacheSet[I_b]=[I_a]}},I_C.clearCache=function(I_a,I_b){if(I_a&&I_b){var I_c=I_C.cacheSet[I_b];if(I_c){var I_d=I_c.indexOf(I_a);if(-1!==I_d){var I_e=I_c.length-1;0==I_e?(delete I_C.cacheSet[I_b],0<I_C.imgMgrSet[I_b]?I_g.imgMgrFree(I_b,I_C.imgMgrSet[I_b]):I_C.clearRes(I_b,!0)):(I_c[I_d]=I_c[I_e],I_c.length=I_e)}}}},I_C.saveObject=function(I_a,I_b,I_c){if(I_b&&I_a){var I_d=I_C.objectSet[I_a];I_d?(console.warn("Loader.saveObject: "+I_a),I_d[0]=I_b,I_d[1]=I_c):I_C.objectSet[I_a]=[I_b,I_c,[]]}},I_C.findObject=function(I_a){if(I_a){var I_b=I_C.objectSet[I_a];if(I_b)return I_b[0]}return null},I_C.keepObject=function(I_a,I_b){if(I_a&&I_b){var I_c=I_C.objectSet[I_b];I_c&&-1===I_c[2].indexOf(I_a)&&I_c[2].push(I_a)}},I_C.clearObject=function(I_a,I_b){if(I_a&&I_b){var I_c=I_C.objectSet[I_b];if(I_c){var I_d=I_c[2],I_e=I_d.indexOf(I_a);if(-1!==I_e){var I_f=I_d.length-1;0==I_f?(delete I_C.objectSet[I_b],I_c[1]&&I_c[1].call(null,I_c[0])):(I_d[I_e]=I_d[I_f],I_d.length=I_f)}}}},I_C.TEXT="text",I_C.JSON="json",I_C.XML="xml",I_C.BUFFER="arraybuffer",I_C.IMAGE="image",I_C.SOUND="sound",I_C.ATLAS="atlas",I_C.FONT="font",I_C.TTF="ttf",I_C.PLF="plf",I_C.PKM="pkm",I_C.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},I_C.parserMap={},I_C.groupMap={},I_C.maxTimeOut=100,I_C.loadedMap={},I_C.preLoadedMap={},I_C.atlasMap={},I_C._loaders=[],I_C._isWorking=!1,I_C._startIndex=0,I_C.imgCache={},I_C.cacheSet={},I_C.objectSet={},I_C.imgMgrSet={},I_C}(),I_ia=function(I_a){var I_m;function I_n(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},I_n.__super.call(this);for(var I_a=0;I_a<this._maxPriority;I_a++)this._resInfos[I_a]=[]}I_k(I_n,"laya.net.LoaderManager",I_j);var I_b=I_n.prototype;return I_b.create=function(I_a,I_c,I_b,I_d,I_e,I_f,I_g,I_h){if(null==I_f&&(I_f=2),null==I_g&&(I_g=!0),I_a instanceof Array){var I_i=I_a,I_j=I_i.length,I_k=0;if(I_b)var I_l=I_u.create(I_b.caller,I_b.method,I_b.args,!1);for(var I_m=0;I_m<I_j;I_m++){var I_n=I_i[I_m];"string"==typeof I_n&&(I_n=I_i[I_m]={url:I_n}),I_n.progress=0}for(I_m=0;I_m<I_j;I_m++){I_n=I_i[I_m];var I_o=I_b?I_u.create(null,I_t,[I_n],!1):null,I_p=I_b||I_c?I_u.create(null,I_s,[I_n]):null;this._create(I_n.url,I_p,I_o,I_n.clas||I_d,I_n.params||I_e,null!=I_n.priority&&0<=I_n.priority?I_n.priority:I_f,I_g,I_n.group||I_h)}function I_s(I_a,I_b){I_k++,I_a.progress=1,I_k===I_j&&I_c&&I_c.run()}function I_t(I_a,I_b){I_a.progress=I_b;for(var I_c=0,I_d=0;I_d<I_j;I_d++){I_c+=I_i[I_d].progress}var I_e=I_c/I_j;I_l.runWith(I_e)}return!0}return this._create(I_a,I_c,I_b,I_d,I_e,I_f,I_g,I_h)},I_b._create=function(I_b,I_c,I_a,I_d,I_e,I_f,I_g,I_h){I_b&&""!=I_b||console.error("加载的url不合法 "+I_b),null==I_f&&(I_f=2),null==I_g&&(I_g=!0);var I_i=I_I.formatURL(I_b),I_j=this.getRes(I_i);if(I_j)!I_j.hasOwnProperty("loaded")||I_j.loaded?(I_a&&I_a.runWith(1),I_c&&I_c.run()):I_c&&I_z.loader._createListener(I_b,I_c.caller,I_c.method,I_c.args,!0,!1);else{var I_k=I_$.getFileExtension(I_b),I_l=I_n.createMap[I_k];if(!I_l)throw new Error("LoaderManager:unknown file("+I_b+") extension with: "+I_k+".");I_d||(I_d=I_l[0]);var I_m=I_l[1];if("atlas"==I_k)this.load(I_b,I_c,I_a,I_m,I_f,I_g);else{I_d===I_ka&&(I_m="htmlimage"),(I_j=I_d?new I_d:null).hasOwnProperty("_loaded")&&(I_j._loaded=!1),I_j._setUrl(I_b),I_h&&I_j._setGroup(I_h),this._createLoad(I_j,I_b,I_u.create(null,function(I_a){I_j&&!I_j.destroyed&&I_a&&I_j.onAsynLoaded.call(I_j,I_b,I_a,I_e),I_c&&I_c.run();I_z.loader.event(I_b)}),I_a,I_m,I_f,!1,I_h,!0),I_g&&this.cacheRes(I_i,I_j)}}return I_j},I_b.load=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){I_a&&""!=I_a||console.error("加载的url不合法 "+I_a);var I_i=this;if(null==I_e&&(I_e=2),null==I_f&&(I_f=!0),void 0===I_h&&(I_h=!1),I_a instanceof Array)return this._loadAssets(I_a,I_b,I_c,I_d,I_e,I_f,I_g);var I_j=I_ha.getRes(I_a);if(null!=I_j)I_z.timer.frameOnce(1,null,function(){I_c&&I_c.runWith(1),I_b&&I_b.runWith(I_j),I_i._loaderCount||I_i.event("complete")});else{var I_k=I_n._resMap[I_a];I_k?(I_b&&I_k._createListener("complete",I_b.caller,I_b.method,I_b.args,!1,!1),I_c&&I_k._createListener("progress",I_c.caller,I_c.method,I_c.args,!1,!1)):((I_k=this._infoPool.length?this._infoPool.pop():new I_m).url=I_a,I_k.type=I_d,I_k.cache=I_f,I_k.group=I_g,I_k.ignoreCache=I_h,I_k.priority=I_e,I_b&&I_k.on("complete",I_b.caller,I_b.method,I_b.args),I_c&&I_k.on("progress",I_c.caller,I_c.method,I_c.args),I_n._resMap[I_a]=I_k,I_e=I_e<this._maxPriority?0<=I_e?I_e:0:this._maxPriority-1,this._resInfos[I_e].push(I_k),this._next())}return this},I_b._createLoad=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){var I_j=this;if(null==I_f&&(I_f=2),null==I_g&&(I_g=!0),void 0===I_i&&(I_i=!1),I_b instanceof Array)return this._loadAssets(I_b,I_c,I_d,I_e,I_f,I_g,I_h);var I_k=I_ha.getRes(I_b);if(null!=I_k)I_z.timer.frameOnce(1,null,function(){I_d&&I_d.runWith(1),I_c&&I_c.runWith(I_k),I_j._loaderCount||I_j.event("complete")});else{var I_l=I_n._resMap[I_b];I_l?(I_c&&I_l._createListener("complete",I_c.caller,I_c.method,I_c.args,!1,!1),I_d&&I_l._createListener("progress",I_d.caller,I_d.method,I_d.args,!1,!1)):((I_l=this._infoPool.length?this._infoPool.pop():new I_m).url=I_b,I_l.clas=I_a,I_l.type=I_e,I_l.cache=I_g,I_l.group=I_h,I_l.ignoreCache=I_i,I_l.priority=I_f,I_c&&I_l.on("complete",I_c.caller,I_c.method,I_c.args),I_d&&I_l.on("progress",I_d.caller,I_d.method,I_d.args),I_n._resMap[I_b]=I_l,I_f=I_f<this._maxPriority?0<=I_f?I_f:0:this._maxPriority-1,this._resInfos[I_f].push(I_l),this._next())}return this},I_b._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var I_a=0;I_a<this._maxPriority;I_a++)for(var I_b=this._resInfos[I_a];0<I_b.length;){var I_c=I_b.shift();if(I_c)return this._doLoad(I_c)}this._loaderCount||this.event("complete")}},I_b._doLoad=function(I_b){this._loaderCount++;var I_c=this._loaders.length?this._loaders.pop():new I_ha;I_c.on("complete",null,I_e),I_c.on("progress",null,function(I_a){I_b.event("progress",I_a)}),I_c.on("error",null,function(I_a){I_e(null)});var I_d=this;function I_e(I_a){I_c.offAll(),I_c._data=null,I_c._customParse=!1,I_d._loaders.push(I_c),I_d._endLoad(I_b,I_a instanceof Array?[I_a]:I_a),I_d._loaderCount--,I_d._next()}I_c._class=I_b.clas,1<=I_b.priority?(I_c.priority=I_b.priority,I_c.realTime=!1):(I_c.priority=0,I_c.realTime=!0),I_c.load(I_b.url,I_b.type,I_b.cache,I_b.group,I_b.ignoreCache)},I_b._endLoad=function(I_a,I_b){var I_c=I_a.url;if(null==I_b){var I_d=this._failRes[I_c]||0;if(I_d<this.retryNum)return console.warn("[warn]Retry to load:",I_c),this._failRes[I_c]=I_d+1,void I_z.timer.once(this.retryDelay,this,this._addReTry,[I_a],!1);console.warn("[error]Failed to load:",I_c),this.event("error",I_c)}this._failRes[I_c]&&(this._failRes[I_c]=0),delete I_n._resMap[I_c],I_a.event("complete",I_b),I_a.offAll(),this._infoPool.push(I_a)},I_b._addReTry=function(I_a){this._resInfos[this._maxPriority-1].push(I_a),this._next()},I_b.clearRes=function(I_a,I_b){void 0===I_b&&(I_b=!1),I_ha.clearRes(I_a,I_b)},I_b.getRes=function(I_a){return I_ha.getRes(I_a)},I_b.cacheRes=function(I_a,I_b){I_ha.cacheRes(I_a,I_b)},I_b.clearTextureRes=function(I_a){I_ha.clearTextureRes(I_a)},I_b.setGroup=function(I_a,I_b){I_ha.setGroup(I_a,I_b)},I_b.clearResByGroup=function(I_a){I_ha.clearResByGroup(I_a)},I_b.clearUnLoaded=function(){for(var I_a=0;I_a<this._maxPriority;I_a++){for(var I_b=this._resInfos[I_a],I_c=I_b.length-1;-1<I_c;I_c--){var I_d=I_b[I_c];I_d&&(I_d.offAll(),this._infoPool.push(I_d))}I_b.length=0}this._loaderCount=0,I_n._resMap={}},I_b.cancelLoadByUrls=function(I_a){if(I_a)for(var I_b=0,I_c=I_a.length;I_b<I_c;I_b++)this.cancelLoadByUrl(I_a[I_b])},I_b.cancelLoadByUrl=function(I_a){for(var I_b=0;I_b<this._maxPriority;I_b++)for(var I_c=this._resInfos[I_b],I_d=I_c.length-1;-1<I_d;I_d--){var I_e=I_c[I_d];I_e&&I_e.url===I_a&&(I_c[I_d]=null,I_e.offAll(),this._infoPool.push(I_e))}I_n._resMap[I_a]&&delete I_n._resMap[I_a]},I_b._loadAssets=function(I_a,I_c,I_g,I_b,I_d,I_e,I_f){null==I_d&&(I_d=2),null==I_e&&(I_e=!0);for(var I_h=I_a.length,I_i=0,I_j=0,I_k=[],I_l=!0,I_m=0;I_m<I_h;I_m++){var I_n=I_a[I_m];if(!I_n)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+I_a);"string"==typeof I_n&&(I_n={url:I_n,type:I_b,size:1,priority:I_d}),I_n.size||(I_n.size=1),I_n.progress=0,I_j+=I_n.size,I_k.push(I_n);var I_o=I_g?I_u.create(null,I_t,[I_n],!1):null,I_p=I_c||I_g?I_u.create(null,I_s,[I_n]):null;this.load(I_n.url,I_p,I_o,I_n.type,null!=I_n.priority&&0<=I_n.priority?I_n.priority:2,I_e,I_n.group||I_f)}function I_s(I_a,I_b){I_i++,I_a.progress=1,I_b||(I_l=!1),I_i===I_h&&I_c&&I_c.runWith(I_l)}function I_t(I_a,I_b){if(null!=I_g){I_a.progress=I_b;for(var I_c=0,I_d=0;I_d<I_k.length;I_d++){var I_e=I_k[I_d];I_c+=I_e.size*I_e.progress}var I_f=I_c/I_j;I_g.runWith(I_f)}}return this},I_n.cacheRes=function(I_a,I_b){I_ha.cacheRes(I_a,I_b)},I_n._resMap={},I_i(I_n,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),I_n.__init$=function(){I_m=function(I_a){function I_b(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,I_b.__super.call(this)}return I_k(I_b,"",I_j),I_b}()},I_n}(),I_ja=(function(I_a){function I_e(I_a){I_e.__super.call(this),I_a||(I_a=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var I_b=0,I_c=0,I_d=0;I_d<20;I_d++)I_d%5!=4?this._mat[I_b++]=I_a[I_d]:this._alpha[I_c++]=I_a[I_d];this._action=I_F.createFilterAction(32),this._action.data=this}I_k(I_e,"laya.filters.ColorFilter",I_t);var I_b=I_e.prototype;I_z.imps(I_b,{"laya.filters.IFilter":!0}),I_b.callNative=function(I_a){I_a._$P.cf=this;I_a.conchModel&&I_a.conchModel.setFilterMatrix&&I_a.conchModel.setFilterMatrix(this._mat,this._alpha)},I_o(0,I_b,"type",function(){return 32}),I_o(0,I_b,"action",function(){return this._action})}(),function(I_a){function I_d(I_a,I_b,I_c){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===I_b&&(I_b=0),I_d.__super.call(this),this._byteClass=I_c||I_P,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,I_a&&0<I_b&&I_b<65535&&this.connect(I_a,I_b)}I_k(I_d,"laya.net.Socket",I_j);var I_b=I_d.prototype;I_b.connect=function(I_a,I_b){var I_c="ws://"+I_a+":"+I_b;I_c="https:"==I_O.window.location.protocol?"wss://"+I_a+":"+I_b:"ws://"+I_a+":"+I_b,this.connectByUrl(I_c)},I_b.connectByUrl=function(I_a){var I_b=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new I_O.window.WebSocket(I_a,this.protocols):this._socket=new I_O.window.WebSocket(I_a),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(I_a){I_b._onOpen(I_a)},this._socket.onmessage=function(I_a){I_b._onMessage(I_a)},this._socket.onclose=function(I_a){I_b._onClose(I_a)},this._socket.onerror=function(I_a){I_b._onError(I_a)}},I_b.cleanSocket=function(){try{this._socket.close()}catch(I_a){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},I_b.close=function(){if(null!=this._socket)try{this._socket.close()}catch(I_a){}},I_b._onOpen=function(I_a){this._connected=!0,this.event("open",I_a)},I_b._onMessage=function(I_a){if(I_a&&I_a.data){var I_b=I_a.data;if(this.disableInput&&I_b)this.event("message",I_b);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var I_c=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,I_b&&("string"==typeof I_b?this._input.writeUTFBytes(I_b):this._input.writeArrayBuffer(I_b),this._addInputPosition=this._input.pos,this._input.pos=I_c),this.event("message",I_b)}}},I_b._onClose=function(I_a){this._connected=!1,this.event("close",I_a)},I_b._onError=function(I_a){this.event("error",I_a)},I_b.send=function(I_a){this._socket.send(I_a)},I_b.flush=function(){if(this._output&&0<this._output.length){var I_b;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(I_a){I_b=I_a}this._output.endian=this.endian,this._output.clear(),I_b&&this.event("error",I_b)}},I_o(0,I_b,"input",function(){return this._input}),I_o(0,I_b,"output",function(){return this._output}),I_o(0,I_b,"connected",function(){return this._connected}),I_o(0,I_b,"endian",function(){return this._endian},function(I_a){this._endian=I_a,null!=this._input&&(this._input.endian=I_a),null!=this._output&&(this._output.endian=I_a)}),I_d.LITTLE_ENDIAN="littleEndian",I_d.BIG_ENDIAN="bigEndian"}(),function(I_a){function I_h(){I_h.__super.call(this),this._$1__id=++I_h._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(I_h._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,I_N.currentResourceManager&&I_N.currentResourceManager.addResource(this)}I_k(I_h,"laya.resource.Resource",I_j);var I_b=I_h.prototype;return I_z.imps(I_b,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),I_b._setUrl=function(I_a){var I_b;this._url!==I_a&&(this._url&&((I_b=I_h._urlResourcesMap[this._url]).splice(I_b.indexOf(this),1),0===I_b.length&&delete I_h._urlResourcesMap[this._url]),I_a&&((I_b=I_h._urlResourcesMap[I_a])||(I_h._urlResourcesMap[I_a]=I_b=[]),I_b.push(this)),this._url=I_a)},I_b._getGroup=function(){return this._group},I_b._setGroup=function(I_a){var I_b;this._group!==I_a&&(this._group&&((I_b=I_h._groupResourcesMap[this._group]).splice(I_b.indexOf(this),1),0===I_b.length&&delete I_h._groupResourcesMap[this._group]),I_a&&((I_b=I_h._groupResourcesMap[I_a])||(I_h._groupResourcesMap[I_a]=I_b=[]),I_b.push(this)),this._group=I_a)},I_b._addReference=function(){this._referenceCount++},I_b._removeReference=function(){this._referenceCount--},I_b._clearReference=function(){this._referenceCount=0},I_b._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},I_b.recreateResource=function(){this.completeCreate()},I_b.disposeResource=function(){},I_b.activeResource=function(I_a){void 0===I_a&&(I_a=!1),this._lastUseFrameCount=I_X.loopCount,!this._destroyed&&this.__loaded&&(this._released||I_a)&&this.recreateResource()},I_b.releaseResource=function(I_a){return void 0===I_a&&(I_a=!0),!(!I_a&&this.lock)&&(!(this._released&&!I_a)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},I_b.onAsynLoaded=function(I_a,I_b,I_c){throw new Error("Resource: must override this function!")},I_b.destroy=function(){var I_a;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete I_h._idResourcesMap[this.id],this._url&&((I_a=I_h._urlResourcesMap[this._url])&&(I_a.splice(I_a.indexOf(this),1),0===I_a.length&&delete I_h._urlResourcesMap[this.url]),I_ha.clearRes(this._url),this.__loaded||I_F.cancelLoadByUrl(this._url)),this._group&&((I_a=I_h._groupResourcesMap[this._group]).splice(I_a.indexOf(this),1),0===I_a.length&&delete I_h._groupResourcesMap[this.url]))},I_b.completeCreate=function(){this._released=!1,this.event("recovered",this)},I_b.dispose=function(){this.destroy()},I_o(0,I_b,"memorySize",function(){return this._memorySize},function(I_a){var I_b=I_a-this._memorySize;this._memorySize=I_a,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,I_b),this.resourceManager&&this.resourceManager.addSize(I_b)}),I_o(0,I_b,"_loaded",null,function(I_a){this.__loaded=I_a}),I_o(0,I_b,"loaded",function(){return this.__loaded}),I_o(0,I_b,"id",function(){return this._$1__id}),I_o(0,I_b,"destroyed",function(){return this._destroyed}),I_o(0,I_b,"group",function(){return this._getGroup()},function(I_a){this._setGroup(I_a)}),I_o(0,I_b,"resourceManager",function(){return this._resourceManager}),I_o(0,I_b,"url",function(){return this._url}),I_o(0,I_b,"released",function(){return this._released}),I_o(0,I_b,"referenceCount",function(){return this._referenceCount}),I_h.getResourceByID=function(I_a){return I_h._idResourcesMap[I_a]},I_h.getResourceByURL=function(I_a,I_b){return void 0===I_b&&(I_b=0),null==I_h._urlResourcesMap[I_a]?null:I_h._urlResourcesMap[I_a][I_b]},I_h.getResourceCountByURL=function(I_a){return I_h._urlResourcesMap[I_a].length},I_h.destroyUnusedResources=function(I_a){var I_b;if(I_a){var I_c=I_h._groupResourcesMap[I_a];if(I_c)for(var I_d=I_c.slice(),I_e=0,I_f=I_d.length;I_e<I_f;I_e++)(I_b=I_d[I_e]).lock||0!==I_b._referenceCount||I_b.destroy()}else for(var I_g in I_h._idResourcesMap)(I_b=I_h._idResourcesMap[I_g]).lock||0!==I_b._referenceCount||I_b.destroy()},I_h._uniqueIDCounter=0,I_h._idResourcesMap={},I_h._urlResourcesMap={},I_h._groupResourcesMap={},I_h}()),I_ka=function(I_a){function I_C(I_a,I_b){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,I_C.__super.call(this),I_a&&null!=I_a._addReference&&I_a._addReference(),this.setTo(I_a,I_b)}I_k(I_C,"laya.resource.Texture",I_j);var I_b=I_C.prototype;return I_b._setUrl=function(I_a){this.url=I_a},I_b.setTo=function(I_a,I_b){if(I_a instanceof I_g.HTMLElement){var I_c=I_va.create("2D",I_a);this.bitmap=I_c}else this.bitmap=I_a;if(this.uv=I_b||I_C.DEF_UV,I_a){this._w=I_a.width,this._h=I_a.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var I_d=this;if(this._loaded)I_F.addToAtlas&&I_F.addToAtlas(I_d);else{var I_e=I_a;I_e instanceof laya.resource.HTMLImage&&I_e.image&&I_e.image.addEventListener("load",function(I_a){I_F.addToAtlas&&I_F.addToAtlas(I_d)},!1)}}},I_b.active=function(){this.bitmap&&this.bitmap.activeResource()},I_b.destroy=function(I_a){if(void 0===I_a&&(I_a=!1),this.alphaTexture&&(this.alphaTexture.destroy(I_a),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var I_b=this.bitmap;I_a?(I_J.isConchApp&&I_b.source&&I_b.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,I_b.dispose(),I_b._clearReference()):(I_b._removeReference(),0==I_b.referenceCount&&(I_J.isConchApp&&I_b.source&&I_b.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,I_b.dispose())),this.url&&this===I_z.loader.getRes(this.url)&&I_z.loader.clearRes(this.url,I_a),this._loaded=!1}},I_b.load=function(I_a){var I_b=this;this._loaded=!1,I_a=I_I.customFormat(I_a);var I_c=this.bitmap||(this.bitmap=I_ya.create(I_a));I_c.uri=I_a,I_c&&I_c._addReference();var I_d=this;I_c.onload=function(){I_c.onload=null,I_d._loaded=!0,I_b.sourceWidth=I_b._w=I_c.width,I_b.sourceHeight=I_b._h=I_c.height,I_d.event("loaded",this),I_F.addToAtlas&&I_F.addToAtlas(I_d)}},I_b.addTextureToAtlas=function(I_a){I_F.addTextureToAtlas(this)},I_b.getPixels=function(I_a,I_b,I_c,I_d){if(I_J.isConchApp){var I_e=this.bitmap;if(I_e.source&&I_e.source.getImageData){var I_f=I_e.source.getImageData(I_a,I_b,I_c,I_d),I_g=new Uint8Array(I_f);return Array.from(I_g)}return null}return I_J.isWebGL?I_F.getTexturePixels(this,I_a,I_b,I_c,I_d):(I_O.canvas.size(I_c,I_d),I_O.canvas.clear(),I_O.context.drawTexture(this,-I_a,-I_b,this.width,this.height,0,0),I_O.context.getImageData(0,0,I_c,I_d).data)},I_b.onAsynLoaded=function(I_a,I_b){if(I_b){if("function"!=typeof I_b._addReference)throw new Error("bitmap._addReference is not a function. "+I_b.className+" "+typeof I_b._addReference+" "+I_b.constructor);I_b._addReference()}this.setTo(I_b,this.uv),this._loaded&&this.event("loaded",this)},I_o(0,I_b,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),I_o(0,I_b,"loaded",function(){return this._loaded}),I_o(0,I_b,"released",function(){return!this.bitmap||this.bitmap.released}),I_o(0,I_b,"width",function(){return this._w?this._w:this.uv&&this.uv!==I_C.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(I_a){this._w=I_a,this.sourceWidth||(this.sourceWidth=I_a)}),I_o(0,I_b,"repeat",function(){return!I_J.isWebGL||!this.bitmap||this.bitmap.repeat},function(I_a){I_a&&I_J.isWebGL&&this.bitmap&&(this.bitmap.repeat=I_a)&&(this.bitmap.enableMerageInAtlas=!1)}),I_o(0,I_b,"height",function(){return this._h?this._h:this.uv&&this.uv!==I_C.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(I_a){this._h=I_a,this.sourceHeight||(this.sourceHeight=I_a)}),I_o(0,I_b,"isLinearSampling",function(){return!I_J.isWebGL||9728!=this.bitmap.minFifter},function(I_a){!I_a&&I_J.isWebGL&&(I_a||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),I_C.moveUV=function(I_a,I_b,I_c){for(var I_d=0;I_d<8;I_d+=2)I_c[I_d]+=I_a,I_c[I_d+1]+=I_b;return I_c},I_C.create=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){void 0===I_f&&(I_f=0),void 0===I_g&&(I_g=0),void 0===I_h&&(I_h=0),void 0===I_i&&(I_i=0);var I_j=I_a instanceof laya.resource.Texture,I_k=I_j?I_a.uv:I_C.DEF_UV,I_l=I_j?I_a.bitmap:I_a,I_m=I_F.isAtlas(I_l);if(I_m){var I_n=I_l._atlaser,I_o=I_a._atlasID;if(-1==I_o)throw new Error("create texture error");I_l=I_n._inAtlasTextureBitmapValue[I_o],I_k=I_n._inAtlasTextureOriUVValue[I_o]}var I_p=new I_C(I_l,null);I_l.width&&I_b+I_d>I_l.width&&(I_d=I_l.width-I_b),I_l.height&&I_c+I_e>I_l.height&&(I_e=I_l.height-I_c),I_p.width=I_d,I_p.height=I_e,I_p.offsetX=I_f,I_p.offsetY=I_g,I_p.sourceWidth=I_h||I_d,I_p.sourceHeight=I_i||I_e;var I_s=1/I_l.width,I_t=1/I_l.height;I_b*=I_s,I_c*=I_t,I_d*=I_s,I_e*=I_t;var I_u=I_p.uv[0],I_v=I_p.uv[1],I_w=I_p.uv[4],I_x=I_p.uv[5],I_y=I_w-I_u,I_z=I_x-I_v,I_A=I_C.moveUV(I_k[0],I_k[1],[I_b,I_c,I_b+I_d,I_c,I_b+I_d,I_c+I_e,I_b,I_c+I_e]);I_p.uv=[I_u+I_A[0]*I_y,I_v+I_A[1]*I_z,I_w-(1-I_A[2])*I_y,I_v+I_A[3]*I_z,I_w-(1-I_A[4])*I_y,I_x-(1-I_A[5])*I_z,I_u+I_A[6]*I_y,I_x-(1-I_A[7])*I_z],I_m&&I_p.addTextureToAtlas();var I_B=I_l.scaleRate;return I_B&&1!=I_B?(I_p.sourceWidth/=I_B,I_p.sourceHeight/=I_B,I_p.width/=I_B,I_p.height/=I_B,I_p.scaleRate=I_B,I_p.offsetX/=I_B,I_p.offsetY/=I_B):I_p.scaleRate=1,I_p},I_C.createFromTexture=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_a.scaleRate;1!=I_f&&(I_b*=I_f,I_c*=I_f,I_d*=I_f,I_e*=I_f);var I_g=I_B.TEMP.setTo(I_b-I_a.offsetX,I_c-I_a.offsetY,I_d,I_e),I_h=I_g.intersection(I_C._rect1.setTo(0,0,I_a.width,I_a.height),I_C._rect2);if(!I_h)return null;var I_i=I_C.create(I_a,I_h.x,I_h.y,I_h.width,I_h.height,I_h.x-I_g.x,I_h.y-I_g.y,I_d,I_e);if(I_i.bitmap&&I_i.bitmap._removeReference)return I_i.bitmap._removeReference(),I_i;var I_j="bitmap:"+(I_i.bitmap?I_i.bitmap.constructor?I_i.bitmap.constructor.name:I_i.bitmap.__className:"")+", url:"+(I_a.url+" | "+(I_i.bitmap?I_i.bitmap.url:I_a.url))+", x="+I_b+",y="+I_c+",width="+I_d+",height="+I_e+", result="+(I_h?I_h.x+","+I_h.y+","+I_h.width+","+I_h.height:"null")+", rect="+I_g.x+","+I_g.y+","+I_g.width+","+I_g.height;throw new Error("报错：bitmap._removeReference is not a function  "+I_j)},I_C.DEF_UV=[0,0,1,0,1,1,0,1],I_C.INV_UV=[0,1,1,1,1,0,0,0],I_C._rect1=new I_B,I_C._rect2=new I_B,I_C}(),I_a=function(I_a){var I_h;function I_f(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,I_f.__super.call(this)}I_k(I_f,"laya.utils.TimeLine",I_j);var I_b=I_f.prototype;return I_b.to=function(I_a,I_b,I_c,I_d,I_e){return void 0===I_e&&(I_e=0),this._create(I_a,I_b,I_c,I_d,I_e,!0)},I_b.from=function(I_a,I_b,I_c,I_d,I_e){return void 0===I_e&&(I_e=0),this._create(I_a,I_b,I_c,I_d,I_e,!1)},I_b._create=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=I_W.getItemByClass("tweenData",I_h);return I_g.isTo=I_f,I_g.type=0,I_g.target=I_a,I_g.duration=I_c,I_g.data=I_b,I_g.startTime=this._startTime+I_e,I_g.endTime=I_g.startTime+I_g.duration,I_g.ease=I_d,this._startTime=Math.max(I_g.endTime,this._startTime),this._tweenDataList.push(I_g),this._startTimeSort=!0,this._endTimeSort=!0,this},I_b.addLabel=function(I_a,I_b){var I_c=I_W.getItemByClass("tweenData",I_h);return I_c.type=1,I_c.data=I_a,I_c.endTime=I_c.startTime=this._startTime+I_b,this._labelDic||(this._labelDic={}),this._labelDic[I_a]=I_c,this._tweenDataList.push(I_c),this},I_b.removeLabel=function(I_a){if(this._labelDic&&this._labelDic[I_a]){var I_b=this._labelDic[I_a];if(I_b){var I_c=this._tweenDataList.indexOf(I_b);-1<I_c&&this._tweenDataList.splice(I_c,1)}delete this._labelDic[I_a]}},I_b.gotoTime=function(I_a){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var I_b,I_c,I_d,I_e;for(var I_f in this._firstTweenDic)if(I_c=this._firstTweenDic[I_f])for(var I_g in I_c)I_c.diyTarget.hasOwnProperty(I_g)&&(I_c.diyTarget[I_g]=I_c[I_g]);for(I_f in this._tweenDic)(I_b=this._tweenDic[I_f]).clear(),delete this._tweenDic[I_f];if(this._index=0,this._gidIndex=0,this._currTime=I_a,this._lastTime=I_O.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=I_d=this._tweenDataList.concat(),I_d.sort(function(I_a,I_b){return I_a.endTime>I_b.endTime?1:I_a.endTime<I_b.endTime?-1:0})}else I_d=this._endTweenDataList;for(var I_h=0,I_i=I_d.length;I_h<I_i;I_h++)if(0==(I_e=I_d[I_h]).type){if(!(I_a>=I_e.endTime))break;this._index=Math.max(this._index,I_h+1);var I_j=I_e.data;if(I_e.isTo)for(var I_k in I_j)I_e.target[I_k]=I_j[I_k]}for(I_h=0,I_i=this._tweenDataList.length;I_h<I_i;I_h++)0==(I_e=this._tweenDataList[I_h]).type&&I_a>=I_e.startTime&&I_a<I_e.endTime&&(this._index=Math.max(this._index,I_h+1),this._gidIndex++,(I_b=I_W.getItemByClass("tween",I_Z))._create(I_e.target,I_e.data,I_e.duration,I_e.ease,I_u.create(this,this._animComplete,[this._gidIndex]),0,!1,I_e.isTo,!0,!1),I_b.setStartTime(this._currTime-(I_a-I_e.startTime)),I_b._updateEase(this._currTime),I_b.gid=this._gidIndex,this._tweenDic[this._gidIndex]=I_b)}},I_b.gotoLabel=function(I_a){if(null!=this._labelDic){var I_b=this._labelDic[I_a];I_b&&this.gotoTime(I_b.startTime)}},I_b.pause=function(){I_z.timer.clear(this,this._update)},I_b.resume=function(){this.play(this._currTime,this._loopKey)},I_b.play=function(I_a,I_b){if(void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(I_a,I_b){return I_a.startTime>I_b.startTime?1:I_a.startTime<I_b.startTime?-1:0});for(var I_c=0,I_d=this._tweenDataList.length;I_c<I_d;I_c++){var I_e=this._tweenDataList[I_c];if(null!=I_e&&0==I_e.type){var I_f=I_e.target,I_g=I_f.$_GID||(I_f.$_GID=I_$.getGID()),I_h=null;for(var I_i in null==this._firstTweenDic[I_g]?((I_h={}).diyTarget=I_f,this._firstTweenDic[I_g]=I_h):I_h=this._firstTweenDic[I_g],I_e.data)null==I_h[I_i]&&(I_h[I_i]=I_f[I_i])}}}"string"==typeof I_a?this.gotoLabel(I_a):this.gotoTime(I_a),this._loopKey=I_b,this._lastTime=I_O.now(),I_z.timer.frameLoop(1,this,this._update)}},I_b._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var I_a in this._tweenDic)(I_b=this._tweenDic[I_a]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var I_b,I_c=I_O.now(),I_d=I_c-this._lastTime,I_e=this._currTime+=I_d*this.scale;for(I_a in this._lastTime=I_c,this._tweenDic)(I_b=this._tweenDic[I_a])._updateEase(I_e);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var I_f=this._tweenDataList[this._index];I_e>=I_f.startTime&&(this._index++,0==I_f.type?(this._gidIndex++,(I_b=I_W.getItemByClass("tween",I_Z))._create(I_f.target,I_f.data,I_f.duration,I_f.ease,I_u.create(this,this._animComplete,[this._gidIndex]),0,!1,I_f.isTo,!0,!1),I_b.setStartTime(I_e),I_b.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=I_b)._updateEase(I_e)):this.event("label",I_f.data))}},I_b._animComplete=function(I_a){this._tweenDic[I_a]&&delete this._tweenDic[I_a]},I_b._complete=function(){this.event("complete")},I_b.reset=function(){var I_a;if(this._labelDic)for(I_a in this._labelDic)delete this._labelDic[I_a];for(I_a in this._tweenDic)this._tweenDic[I_a].clear(),delete this._tweenDic[I_a];for(I_a in this._firstTweenDic)delete this._firstTweenDic[I_a];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var I_b,I_c=0;for(I_b=this._tweenDataList.length,I_c=0;I_c<I_b;I_c++)this._tweenDataList[I_c]&&this._tweenDataList[I_c].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,I_z.timer.clear(this,this._update)},I_b.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},I_o(0,I_b,"index",function(){return this._frameIndex},function(I_a){this._frameIndex=I_a,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),I_o(0,I_b,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),I_f.to=function(I_a,I_b,I_c,I_d,I_e){return void 0===I_e&&(I_e=0),(new I_f).to(I_a,I_b,I_c,I_d,I_e)},I_f.from=function(I_a,I_b,I_c,I_d,I_e){return void 0===I_e&&(I_e=0),(new I_f).from(I_a,I_b,I_c,I_d,I_e)},I_f.__init$=function(){I_h=function(){function I_a(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return I_k(I_a,""),I_a.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,I_W.recover("tweenData",this)},I_a}()},I_f}(),I_la=function(I_e){function I_c(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,I_c.__super.call(this),this._style=I_h.EMPTY}I_k(I_c,"laya.display.Sprite",I_e);var I_a=I_c.prototype;return I_z.imps(I_a,{"laya.display.ILayout":!0}),I_a.createConchModel=function(){return new ConchNode},I_a.destroy=function(I_a){if(void 0===I_a&&(I_a=!0),this._releaseMem(),!this._destroyed){this.filters=null;var I_b=this.mask;I_b&&(this.mask=null,I_b.destroy(I_a))}I_e.prototype.destroy.call(this,I_a),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},I_a.updateZOrder=function(){I_$.updateOrder(this._childs)&&this.repaint()},I_a.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},I_a.setBounds=function(I_a){this._set$P("uBounds",I_a)},I_a.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new I_B),I_B._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},I_a.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new I_B),I_B._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},I_a._boundPointsToParent=function(I_a){void 0===I_a&&(I_a=!1);var I_b=0,I_c=0;this._style&&(I_b=this._style._tf.translateX,I_c=this._style._tf.translateY,I_a=I_a||0!==this._style._tf.rotate,this._style.scrollRect&&(I_b+=this._style.scrollRect.x,I_c+=this._style.scrollRect.y));var I_d=this._getBoundPointsM(I_a);if(!I_d||I_d.length<1)return I_d;if(8!=I_d.length&&(I_d=I_a?I_x.scanPList(I_d):I_B._getWrapRec(I_d,I_B.TEMP)._getBoundPoints()),!this.transform)return I_$.transPointList(I_d,this._x-I_b,this._y-I_c),I_d;var I_e=I_A.TEMP,I_f=0,I_g=I_d.length;for(I_f=0;I_f<I_g;I_f+=2)I_e.x=I_d[I_f],I_e.y=I_d[I_f+1],this.toParentPoint(I_e),I_d[I_f]=I_e.x,I_d[I_f+1]=I_e.y;return I_d},I_a.getGraphicBounds=function(I_a){return void 0===I_a&&(I_a=!1),this._graphics?this._graphics.getBounds(I_a):I_B.TEMP.setTo(0,0,0,0)},I_a._getBoundPointsM=function(I_a){if(void 0===I_a&&(I_a=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var I_b=I_$.clearArray(this._$P.temBM),I_c=I_B.TEMP;return I_c.copyFrom(this.scrollRect),I_$.concatArray(I_b,I_c._getBoundPoints()),I_b}for(var I_d,I_e,I_f,I_g=this._graphics?this._graphics.getBoundPoints():I_$.clearArray(this._$P.temBM),I_h=0,I_i=(I_f=this._childs).length;I_h<I_i;I_h++)(I_d=I_f[I_h])instanceof laya.display.Sprite&&1==I_d.visible&&(I_e=I_d._boundPointsToParent(I_a))&&(I_g=I_g?I_$.concatArray(I_g,I_e):I_e);return I_g},I_a.getStyle=function(){return this._style===I_h.EMPTY&&(this._style=new I_h),this._style},I_a.setStyle=function(I_a){this._style=I_a},I_a._adjustTransform=function(){this._tfChanged=!1;var I_a,I_b=this._style._tf,I_c=I_b.scaleX,I_d=I_b.scaleY;if(I_b.rotate||1!==I_c||1!==I_d||I_b.skewX||I_b.skewY){(I_a=this._transform||(this._transform=I_G.create())).bTransform=!0;var I_e=.0174532922222222*(I_b.rotate-I_b.skewX),I_f=.0174532922222222*(I_b.rotate+I_b.skewY),I_g=Math.cos(I_f),I_h=Math.sin(I_f),I_i=Math.sin(I_e),I_j=Math.cos(I_e);return I_a.a=I_c*I_g,I_a.b=I_c*I_h,I_a.c=-I_d*I_i,I_a.d=I_d*I_j,I_a.tx=I_a.ty=0,I_a}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,I_a},I_a.pos=function(I_a,I_b,I_c){if(void 0===I_c&&(I_c=!1),this._x!==I_a||this._y!==I_b){if(this.destroyed)return this;if(I_c){this._x=I_a,this._y=I_b,this.conchModel&&this.conchModel.pos(this._x,this._y);var I_d=this._parent;I_d&&0===I_d._repaint&&(I_d._repaint=1,I_d.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=I_a,this.y=I_b}return this},I_a.pivot=function(I_a,I_b){return this.pivotX=I_a,this.pivotY=I_b,this},I_a.size=function(I_a,I_b){return this.width=I_a,this.height=I_b,this},I_a.scale=function(I_a,I_b,I_c){void 0===I_c&&(I_c=!1);var I_d=this.getStyle(),I_e=I_d._tf;if(I_e.scaleX!=I_a||I_e.scaleY!=I_b){if(this.destroyed)return this;if(I_c){I_d.setScale(I_a,I_b),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(I_a,I_b),this._renderType|=4;var I_f=this._parent;I_f&&0===I_f._repaint&&(I_f._repaint=1,I_f.parentRepaint())}else this.scaleX=I_a,this.scaleY=I_b}return this},I_a.skew=function(I_a,I_b){return this.skewX=I_a,this.skewY=I_b,this},I_a.render=function(I_a,I_b,I_c){I_X.spriteCount++,I_L.renders[this._renderType]._fun(this,I_a,I_b+this._x,I_c+this._y),this._repaint=0},I_a.drawToCanvas=function(I_a,I_b,I_c,I_d){if(I_J.isConchNode){var I_e=I_va.create("2D");return new I_K(I_a,I_b,I_e).ctx.setCanvasType(1),this.conchModel.drawToCanvas(I_e.source,I_c,I_d),I_e}return I_F.drawToCanvas(this,this._renderType,I_a,I_b,I_c,I_d)},I_a.customRender=function(I_a,I_b,I_c){this._renderType|=1024},I_a._applyFilters=function(){var I_a;if(!I_J.isWebGL&&((I_a=this._$P.filters)&&!(I_a.length<1)))for(var I_b=0,I_c=I_a.length;I_b<I_c;I_b++)I_a[I_b].action.apply(this._$P.cacheCanvas)},I_a._isHaveGlowFilter=function(){var I_a,I_b=0;if(this.filters)for(I_b=0;I_b<this.filters.length;I_b++)if(8==this.filters[I_b].type)return!0;for(I_b=0,I_a=this._childs.length;I_b<I_a;I_b++)if(this._childs[I_b]._isHaveGlowFilter())return!0;return!1},I_a.localToGlobal=function(I_a,I_b){void 0===I_b&&(I_b=!1),!0===I_b&&(I_a=new I_A(I_a.x,I_a.y));for(var I_c=this;I_c&&I_c!=I_z.stage;)I_a=I_c.toParentPoint(I_a),I_c=I_c.parent;return I_a},I_a.globalToLocal=function(I_a,I_b){void 0===I_b&&(I_b=!1),I_b&&(I_a=new I_A(I_a.x,I_a.y));for(var I_c=this,I_d=[];I_c&&I_c!=I_z.stage;)I_d.push(I_c),I_c=I_c.parent;for(var I_e=I_d.length-1;0<=I_e;)I_a=(I_c=I_d[I_e]).fromParentPoint(I_a),I_e--;return I_a},I_a.toParentPoint=function(I_a){if(!I_a)return I_a;I_a.x-=this.pivotX,I_a.y-=this.pivotY,this.transform&&this._transform.transformPoint(I_a),I_a.x+=this._x,I_a.y+=this._y;var I_b=this._style.scrollRect;return I_b&&(I_a.x-=I_b.x,I_a.y-=I_b.y),I_a},I_a.fromParentPoint=function(I_a){if(!I_a)return I_a;I_a.x-=this._x,I_a.y-=this._y;var I_b=this._style.scrollRect;return I_b&&(I_a.x+=I_b.x,I_a.y+=I_b.y),this.transform&&this._transform.invertTransformPoint(I_a),I_a.x+=this.pivotX,I_a.y+=this.pivotY,I_a},I_a.on=function(I_a,I_b,I_c,I_d){return 1!==this._mouseEnableState&&this.isMouseEvent(I_a)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(I_a,I_b,I_c,I_d,!1)):I_e.prototype.on.call(this,I_a,I_b,I_c,I_d)},I_a.once=function(I_a,I_b,I_c,I_d){return 1!==this._mouseEnableState&&this.isMouseEvent(I_a)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(I_a,I_b,I_c,I_d,!0)):I_e.prototype.once.call(this,I_a,I_b,I_c,I_d)},I_a._$2__onDisplay=function(){if(1!==this._mouseEnableState){var I_a=this;for(I_a=I_a.parent;I_a&&1!==I_a._mouseEnableState&&!I_a._getBit(2);)I_a.mouseEnabled=!0,I_a._setBit(2,!0),I_a=I_a.parent}},I_a.loadImage=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=this;return void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=0),void 0===I_e&&(I_e=0),this.graphics.loadImage(I_a,I_b,I_c,I_d,I_e,function(I_a){I_g.destroyed||(I_g.size(I_b+(I_d||I_a.width),I_c+(I_e||I_a.height)),I_g.repaint(),I_f&&I_f.runWith(I_a))}),this},I_a.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},I_a._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},I_a._childChanged=function(I_a){this._childs.length?this._renderType|=2048:this._renderType&=-2049,I_a&&this._get$P("hasZorder")&&I_z.timer.callLater(this,this.updateZOrder),this.repaint()},I_a.parentRepaint=function(){var I_a=this._parent;I_a&&0===I_a._repaint&&(I_a._repaint=1,I_a.parentRepaint())},I_a.startDrag=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){void 0===I_b&&(I_b=!1),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=300),void 0===I_f&&(I_f=!1),void 0===I_g&&(I_g=.92),this._$P.dragging||this._set$P("dragging",new I_T),this._$P.dragging.start(this,I_a,I_b,I_c,I_d,I_e,I_f,I_g)},I_a.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},I_a._releaseMem=function(){if(this._$P){var I_a=this._$P.cacheCanvas;I_a&&I_a.ctx&&(I_W.recover("RenderContext",I_a.ctx),I_a.ctx.canvas.size(0,0),I_a.ctx=null);var I_b=this._$P._filterCache;I_b&&(I_b.destroy(),I_b.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},I_a._setDisplay=function(I_a){I_a||this._releaseMem(),I_e.prototype._setDisplay.call(this,I_a)},I_a.hitTestPoint=function(I_a,I_b){var I_c=this.globalToLocal(I_A.TEMP.setTo(I_a,I_b));return I_a=I_c.x,I_b=I_c.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?I_B.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(I_a,I_b)},I_a.getMousePoint=function(){return this.globalToLocal(I_A.TEMP.setTo(I_z.stage.mouseX,I_z.stage.mouseY))},I_a._getWords=function(){return null},I_a._addChildsToLayout=function(I_a){var I_b=this._getWords();if(null==I_b&&0==this._childs.length)return!1;if(I_b)for(var I_c=0,I_d=I_b.length;I_c<I_d;I_c++)I_a.push(I_b[I_c]);I_c=0;for(var I_e=this._childs.length;I_c<I_e;++I_c){var I_f=this._childs[I_c];I_f._style._enableLayout()&&I_f._addToLayout(I_a)}return!0},I_a._addToLayout=function(I_a){this._style.absolute||(this._style.block?I_a.push(this):this._addChildsToLayout(I_a)&&(this.x=this.y=0))},I_a._isChar=function(){return!1},I_a._getCSSStyle=function(){return this._style.getCSSStyle()},I_a._setAttributes=function(I_a,I_b){switch(I_a){case"x":this.x=parseFloat(I_b);break;case"y":this.y=parseFloat(I_b);break;case"width":this.width=parseFloat(I_b);break;case"height":this.height=parseFloat(I_b);break;default:this[I_a]=I_b}},I_a._layoutLater=function(){this.parent&&this.parent._layoutLater()},I_o(0,I_a,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(I_a){this._optimizeScrollRect!=I_a&&(this._optimizeScrollRect=I_a,this.conchModel&&this.conchModel.optimizeScrollRect(I_a))}),I_o(0,I_a,"customRenderEnable",null,function(I_a){if(I_a&&(this._renderType|=1024,I_J.isConchNode)){I_c.CustomList.push(this);var I_b=new I_va("2d");I_b._setContext(new CanvasRenderingContext2D),this.customContext=new I_K(0,0,I_b),I_b.context.setCanvasType&&I_b.context.setCanvasType(2),this.conchModel.custom(I_b.context)}}),I_o(0,I_a,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(I_a){this.cacheAs=I_a?this._$P.hasFilter?"none":"normal":"none"}),I_o(0,I_a,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(I_a){var I_b=this._$P.cacheCanvas;if(I_a!==(I_b?I_b.type:"none")){if("none"!==I_a)this._getBit(1)||this._setUpNoticeType(1),I_b||(I_b=this._set$P("cacheCanvas",I_W.getItemByClass("cacheCanvas",Object))),I_b.type=I_a,I_b.reCache=!0,this._renderType|=16,"bitmap"==I_a&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(I_b){var I_c=I_b;I_c&&I_c.ctx&&(I_W.recover("RenderContext",I_c.ctx),I_c.ctx.canvas.size(0,0),I_c.ctx=null),I_W.recover("cacheCanvas",I_b)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),I_o(0,I_a,"zOrder",function(){return this._zOrder},function(I_a){this._zOrder!=I_a&&(this._zOrder=I_a,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(I_a),this._parent&&(I_a&&this._parent._set$P("hasZorder",!0),I_z.timer.callLater(this._parent,this.updateZOrder)))}),I_o(0,I_a,"rotation",function(){return this._style._tf.rotate},function(I_a){var I_b=this.getStyle();if(I_b._tf.rotate!==I_a){I_b.setRotate(I_a),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(I_a),this._renderType|=4;var I_c=this._parent;I_c&&0===I_c._repaint&&(I_c._repaint=1,I_c.parentRepaint())}}),I_o(0,I_a,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(I_a){this._width!==I_a&&(this._width=I_a,this.conchModel&&this.conchModel.size(I_a,this._height),this.repaint())}),I_o(0,I_a,"x",function(){return this._x},function(I_a){if(this._x!==I_a){if(this.destroyed)return;this._x=I_a,this.conchModel&&this.conchModel.pos(I_a,this._y);var I_b=this._parent;I_b&&0===I_b._repaint&&(I_b._repaint=1,I_b.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),I_o(0,I_a,"globalScaleY",function(){for(var I_a=1,I_b=this;I_b&&I_b!==I_z.stage;)I_a*=I_b.scaleY,I_b=I_b.parent;return I_a}),I_o(0,I_a,"hitArea",function(){return this._$P.hitArea},function(I_a){this._set$P("hitArea",I_a)}),I_o(0,I_a,"staticCache",function(){return this._$P.staticCache},function(I_a){this._set$P("staticCache",I_a),I_a||this.reCache()}),I_o(0,I_a,"texture",function(){return this._texture},function(I_a){this._texture!=I_a&&(this._texture=I_a,this.graphics.cleanByTexture(I_a,0,0))}),I_o(0,I_a,"y",function(){return this._y},function(I_a){if(this._y!==I_a){if(this.destroyed)return;this._y=I_a,this.conchModel&&this.conchModel.pos(this._x,I_a);var I_b=this._parent;I_b&&0===I_b._repaint&&(I_b._repaint=1,I_b.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),I_o(0,I_a,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(I_a){this._height!==I_a&&(this._height=I_a,this.conchModel&&this.conchModel.size(this._width,I_a),this.repaint())}),I_o(0,I_a,"blendMode",function(){return this._style.blendMode},function(I_a){this.getStyle().blendMode=I_a,this.conchModel&&this.conchModel.blendMode(I_a),I_a&&"source-over"!=I_a?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),I_o(0,I_a,"scaleX",function(){return this._style._tf.scaleX},function(I_a){var I_b=this.getStyle();if(I_b._tf.scaleX!==I_a){I_b.setScaleX(I_a),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(I_a,I_b._tf.scaleY),this._renderType|=4;var I_c=this._parent;I_c&&0===I_c._repaint&&(I_c._repaint=1,I_c.parentRepaint())}}),I_o(0,I_a,"scaleY",function(){return this._style._tf.scaleY},function(I_a){var I_b=this.getStyle();if(I_b._tf.scaleY!==I_a){I_b.setScaleY(I_a),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(I_b._tf.scaleX,I_a),this._renderType|=4;var I_c=this._parent;I_c&&0===I_c._repaint&&(I_c._repaint=1,I_c.parentRepaint())}}),I_o(0,I_a,"stage",function(){return I_z.stage}),I_o(0,I_a,"skewX",function(){return this._style._tf.skewX},function(I_a){var I_b=this.getStyle();if(I_b._tf.skewX!==I_a){I_b.setSkewX(I_a),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(I_a,I_b._tf.skewY),this._renderType|=4;var I_c=this._parent;I_c&&0===I_c._repaint&&(I_c._repaint=1,I_c.parentRepaint())}}),I_o(0,I_a,"scrollRect",function(){return this._style.scrollRect},function(I_a){this.getStyle().scrollRect=I_a,this.repaint(),I_a?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(I_a.x,I_a.y,I_a.width,I_a.height)):(this._renderType&=-129,this.conchModel&&(I_c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),I_o(0,I_a,"skewY",function(){return this._style._tf.skewY},function(I_a){var I_b=this.getStyle();if(I_b._tf.skewY!==I_a){I_b.setSkewY(I_a),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(I_b._tf.skewX,I_a),this._renderType|=4;var I_c=this._parent;I_c&&0===I_c._repaint&&(I_c._repaint=1,I_c.parentRepaint())}}),I_o(0,I_a,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(I_a){this._tfChanged=!1,(this._transform=I_a)&&(this._x=I_a.tx,this._y=I_a.ty,I_a.tx=I_a.ty=0,this.conchModel&&this.conchModel.transform(I_a.a,I_a.b,I_a.c,I_a.d,this._x,this._y)),I_a?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),I_o(0,I_a,"pivotX",function(){return this._style._tf.translateX},function(I_a){this.getStyle().setTranslateX(I_a),this.conchModel&&this.conchModel.pivot(I_a,this._style._tf.translateY),this.repaint()}),I_o(0,I_a,"pivotY",function(){return this._style._tf.translateY},function(I_a){this.getStyle().setTranslateY(I_a),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,I_a),this.repaint()}),I_o(0,I_a,"alpha",function(){return this._style.alpha},function(I_a){this._style&&this._style.alpha!==I_a&&(I_a=I_a<0?0:1<I_a?1:I_a,this.getStyle().alpha=I_a,this.conchModel&&this.conchModel.alpha(I_a),1!==I_a?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),I_o(0,I_a,"visible",function(){return this._style.visible},function(I_a){this._style&&this._style.visible!==I_a&&(this.getStyle().visible=I_a,this.conchModel&&this.conchModel.visible(I_a),this.parentRepaint())}),I_o(0,I_a,"graphics",function(){return this._graphics||(this.graphics=I_F.createGraphics())},function(I_a){this._graphics&&(this._graphics._sp=null),(this._graphics=I_a)?(this._renderType&=-2,this._renderType|=512,(I_a._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(I_c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),I_o(0,I_a,"filters",function(){return this._$P.filters},function(I_a){I_a&&0===I_a.length&&(I_a=null),this._$P.filters!=I_a&&(this._set$P("filters",I_a?I_a.slice():null),I_J.isConchApp&&(this.conchModel&&(I_c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),I_J.isWebGL&&(I_a&&I_a.length?this._renderType|=32:this._renderType&=-33),I_a&&0<I_a.length?(this._getBit(1)||this._setUpNoticeType(1),I_J.isWebGL&&1==I_a.length&&I_a[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(I_J.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),I_o(0,I_a,"parent",I_e.prototype._$get_parent,function(I_a){I_z.superSet(I_aa,this,"parent",I_a),I_a&&this._getBit(2)&&this._$2__onDisplay()}),I_o(0,I_a,"mask",function(){return this._$P._mask},function(I_a){I_a&&this.mask&&this.mask._$P.maskParent||(I_a?(this.cacheAs="bitmap",this._set$P("_mask",I_a),I_a._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",I_a),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(I_a?I_a.conchModel:null),this._renderType|=64,this.parentRepaint())}),I_o(0,I_a,"mouseEnabled",function(){return 1<this._mouseEnableState},function(I_a){this._mouseEnableState=I_a?2:1}),I_o(0,I_a,"globalScaleX",function(){for(var I_a=1,I_b=this;I_b&&I_b!==I_z.stage;)I_a*=I_b.scaleX,I_b=I_b.parent;return I_a}),I_o(0,I_a,"mouseX",function(){return this.getMousePoint().x}),I_o(0,I_a,"mouseY",function(){return this.getMousePoint().y}),I_c.fromImage=function(I_a){return(new I_c).loadImage(I_a)},I_c._cachePool=[],I_c.CustomList=[],I_i(I_c,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=I_g.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),I_c}(I_aa),I_ma=function(I_a){function I_b(I_a){this._audio=null,this._onEnd=null,this._resumePlay=null,I_b.__super.call(this),this._onEnd=I_$.bind(this.__onEnd,this),this._resumePlay=I_$.bind(this.__resumePlay,this),I_a.addEventListener("ended",this._onEnd),this._audio=I_a}I_k(I_b,"laya.media.h5audio.AudioSoundChannel",I_da);var I_c=I_b.prototype;return I_c.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(I_z.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},I_c.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,I_O.container.appendChild(this._audio),this._audio.play()}catch(I_a){this.event("error")}},I_c.play=function(I_a){this.isStopped=!1;try{this._audio.playbackRate=I_E.playbackRate,this._audio.currentTime=this.startTime}catch(I_a){return void this._audio.addEventListener("canplay",this._resumePlay)}I_E.addChannel(this),I_O.container.appendChild(this._audio),!I_a&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},I_c.stop=function(){this.isStopped=!0,I_E.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&I_J.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),I_O.onIE||this._audio!=I_ca._musicAudio&&I_W.recover("audio:"+this.url,this._audio),I_O.removeElement(this._audio),this._audio=null)},I_c.pause=function(){this.isStopped=!0,I_E.removeChannel(this),"pause"in this._audio&&this._audio.pause()},I_c.resume=function(){this._audio&&(this.isStopped=!1,I_E.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},I_o(0,I_c,"position",function(){return this._audio?this._audio.currentTime:0}),I_o(0,I_c,"duration",function(){return this._audio?this._audio.duration:0}),I_o(0,I_c,"volume",function(){return this._audio?this._audio.volume:1},function(I_a){this._audio&&(this._audio.volume=I_a)}),I_b}(),I_na=function(I_a){function I_b(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=I_fa.ctx,I_b.__super.call(this),this._onPlayEnd=I_$.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}I_k(I_b,"laya.media.webaudio.WebAudioSoundChannel",I_da);var I_c=I_b.prototype;return I_c.play=function(I_a){if(I_E.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var I_b=this.context,I_c=this.gain,I_d=I_b.createBufferSource();(this.bufferSource=I_d).buffer=this.audioBuffer,I_d.connect(I_c),I_c&&I_c.disconnect(),I_c.connect(I_b.destination),I_d.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=I_O.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(I_d.loop=!0),I_d.playbackRate.setTargetAtTime?I_d.playbackRate.setTargetAtTime(I_E.playbackRate,this.context.currentTime,.1):I_d.playbackRate.value=I_E.playbackRate,I_d.start(0,this.startTime),!I_a&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},I_c.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(I_z.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},I_c._clearBufferSource=function(){if(this.bufferSource){var I_a=this.bufferSource;I_a.stop?I_a.stop(0):I_a.noteOff(0),I_a.disconnect(0),I_a.onended=null,I_b._tryCleanFailed||this._tryClearBuffer(I_a),this.bufferSource=null}},I_c._tryClearBuffer=function(I_a){try{I_a.buffer=null}catch(I_a){I_b._tryCleanFailed=!0}},I_c.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,I_E.removeChannel(this),this.startHandler=null,this.completeHandler=null},I_c.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,I_E.removeChannel(this)},I_c.resume=function(){this.startTime=this._pauseTime,this.play(!1)},I_o(0,I_c,"position",function(){return this.bufferSource?(I_O.now()-this._startTime)/1e3+this.startTime:0}),I_o(0,I_c,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),I_o(0,I_c,"volume",function(){return this._volume},function(I_a){this.isStopped||(this._volume=I_a,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(I_a,this.context.currentTime,.1):this.gain.gain.value=I_a)}),I_b._tryCleanFailed=!1,I_b}(),I_oa=function(I_a){function I_b(){I_b.__super.call(this),this._w=0,this._h=0}I_k(I_b,"laya.resource.Bitmap",I_ja);var I_c=I_b.prototype;return I_o(0,I_c,"width",function(){return this._w}),I_o(0,I_c,"height",function(){return this._h}),I_o(0,I_c,"source",function(){return this._source}),I_b}(),I_pa=function(I_b){function I_a(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,I_a.__super.call(this),this._interval=I_d.animationInterval,this._setUpNoticeType(1)}I_k(I_a,"laya.display.AnimationPlayerBase",I_b);var I_c=I_a.prototype;return I_c.play=function(I_a,I_b,I_c,I_d){void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=!0),void 0===I_c&&(I_c=""),void 0===I_d&&(I_d=!0),this._isPlaying=!0,this.index="string"==typeof I_a?this._getFrameByLabel(I_a):I_a,this.loop=I_b,this._actionName=I_c,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},I_c._getFrameByLabel=function(I_a){var I_b=0;for(I_b=0;I_b<this._count;I_b++)if(this._labels[I_b]&&0<=this._labels[I_b].indexOf(I_a))return I_b;return 0},I_c._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},I_c._setControlNode=function(I_a){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=I_a)&&I_a!=this&&(I_a.on("display",this,this._checkResumePlaying),I_a.on("undisplay",this,this._checkResumePlaying))},I_c._setDisplay=function(I_a){I_b.prototype._setDisplay.call(this,I_a),this._checkResumePlaying()},I_c._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},I_c.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},I_c.addLabel=function(I_a,I_b){this._labels||(this._labels={}),this._labels[I_b]||(this._labels[I_b]=[]),this._labels[I_b].push(I_a)},I_c.removeLabel=function(I_a){if(I_a){if(this._labels)for(var I_b in this._labels)this._removeLabelFromLabelList(this._labels[I_b],I_a)}else this._labels=null},I_c._removeLabelFromLabelList=function(I_a,I_b){if(I_a)for(var I_c=I_a.length-1;0<=I_c;I_c--)I_a[I_c]==I_b&&I_a.splice(I_c,1)},I_c.gotoAndStop=function(I_a){this.index="string"==typeof I_a?this._getFrameByLabel(I_a):I_a,this.stop()},I_c._displayToIndex=function(I_a){},I_c.clear=function(){this.stop(),this._labels=null},I_o(0,I_c,"interval",function(){return this._interval},function(I_a){this._interval!=I_a&&(this._frameRateChanged=!0,this._interval=I_a,this._isPlaying&&0<I_a&&this.timerLoop(I_a,this,this._frameLoop,null,!0,!0))}),I_o(0,I_c,"isPlaying",function(){return this._isPlaying}),I_o(0,I_c,"index",function(){return this._index},function(I_a){if(this._index=I_a,this._displayToIndex(I_a),this._labels&&this._labels[I_a])for(var I_b=this._labels[I_a],I_c=0,I_d=I_b.length;I_c<I_d;I_c++)this.event("label",I_b[I_c])}),I_o(0,I_c,"count",function(){return this._count}),I_a.WRAP_POSITIVE=0,I_a.WRAP_REVERSE=1,I_a.WRAP_PINGPONG=2,I_a}(I_la),I_sa=function(I_b){function I_n(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,I_n.__super.call(this),this.overflow=I_n.VISIBLE,this._style=new I_ba(this),this._style.wordWrap=!1}I_k(I_n,"laya.display.Text",I_b);var I_a=I_n.prototype;return I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,I_a),this._lines=null,this._words&&(this._words.length=0,this._words=null)},I_a._getBoundPointsM=function(I_a){void 0===I_a&&(I_a=!1);var I_b=I_B.TEMP;return I_b.setTo(0,0,this.width,this.height),I_b._getBoundPoints()},I_a.getGraphicBounds=function(I_a){void 0===I_a&&(I_a=!1);var I_b=I_B.TEMP;return I_b.setTo(0,0,this.width,this.height),I_b},I_a._getCSSStyle=function(){return this._style},I_a.lang=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k){if(I_a=I_n.langPacks&&I_n.langPacks[I_a]?I_n.langPacks[I_a]:I_a,arguments.length<2)this._text=I_a;else{for(var I_l=0,I_m=arguments.length;I_l<I_m;I_l++)I_a=I_a.replace("{"+I_l+"}",arguments[I_l+1]);this._text=I_a}},I_a._isPassWordMode=function(){var I_a=this._style.password;return"prompt"in this&&this.prompt==this._text&&(I_a=!1),I_a},I_a._getPassWordTxt=function(I_a){var I_b;I_b="";for(var I_c=I_a.length;0<I_c;I_c--)I_b+="●";return I_b},I_a.renderText=function(I_a,I_b){var I_c=this.graphics;I_c.clear(!0);var I_d=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(I_O.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);I_O.context.font=I_d;var I_e=this.padding,I_f=I_e[3],I_g="left",I_h=this._lines,I_i=this.leading+this._charSize.height,I_j=this._currBitmapFont;I_j&&(I_i=this.leading+I_j.getMaxHeight());var I_k=I_e[0];if(!I_j&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(I_g="right",I_f=this._width-I_e[1]):"center"==this.align&&(I_g="center",I_f=.5*this._width+I_e[3]-I_e[1])),0<this._height){var I_l=this._textHeight>this._height?"top":this.valign;"middle"===I_l?I_k=.5*(this._height-I_b*I_i)+I_e[0]-I_e[2]:"bottom"===I_l&&(I_k=this._height-I_b*I_i-I_e[2])}var I_m=this._style;if(I_j&&I_j.autoScaleSize)var I_n=I_j.fontSize/this.fontSize;if(this._clipPoint)if(I_c.save(),I_j&&I_j.autoScaleSize){var I_o=0,I_p=0;I_o=this._width?this._width-I_e[3]-I_e[1]:this._textWidth,I_p=this._height?this._height-I_e[0]-I_e[2]:this._textHeight,I_o*=I_n,I_p*=I_n,I_c.clipRect(I_e[3],I_e[0],I_o,I_p)}else I_c.clipRect(I_e[3],I_e[0],this._width?this._width-I_e[3]-I_e[1]:this._textWidth,this._height?this._height-I_e[0]-I_e[2]:this._textHeight);var I_s=I_m.password;"prompt"in this&&this.prompt==this._text&&(I_s=!1);for(var I_t=0,I_u=0,I_v=Math.min(this._lines.length,I_b+I_a)||1,I_w=I_a;I_w<I_v;I_w++){var I_x,I_y=I_h[I_w];if(I_s){var I_z=I_y.length;I_y="";for(var I_A=I_z;0<I_A;I_A--)I_y+="●"}if(I_t=I_f-(this._clipPoint?this._clipPoint.x:0),I_u=I_k+I_i*I_w-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(I_g,I_t,I_u,I_w),I_j){var I_B=this.width;I_j.autoScaleSize&&(I_B=this.width*I_n),I_j.drawText(I_y,this,I_t,I_u,this.align,I_B)}else I_J.isWebGL?(this._words||(this._words=[]),(I_x=this._words.length>I_w-I_a?this._words[I_w-I_a]:new I_r).setText(I_y)):I_x=I_y,I_m.stroke?I_c.fillBorderText(I_x,I_t,I_u,I_d,this.color,I_m.strokeColor,I_m.stroke,I_g):I_c.fillText(I_x,I_t,I_u,I_d,this.color,I_g)}if(I_j&&I_j.autoScaleSize){var I_C=1/I_n;this.scale(I_C,I_C)}this._clipPoint&&I_c.restore(),this._startX=I_f,this._startY=I_k},I_a.drawUnderline=function(I_a,I_b,I_c,I_d){var I_e=this._lineWidths[I_d];switch(I_a){case"center":I_b-=I_e/2;break;case"right":I_b-=I_e}I_c+=this._charSize.height,this._graphics.drawLine(I_b,I_c,I_b+I_e,I_c,this.underlineColor||this.color,1)},I_a.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);I_O.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new I_A(0,0)):this._clipPoint=null;var I_a=this._lines.length;if(this.overflow!=I_n.VISIBLE){var I_b=this.overflow==I_n.HIDDEN?Math.floor:Math.ceil;I_a=Math.min(I_a,I_b((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var I_c=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(I_c,I_a),this.repaint()},I_a.evalTextSize=function(){var I_a,I_b=NaN;I_a=Math.max.apply(this,this._lineWidths),I_b=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],I_a==this._textWidth&&I_b==this._textHeight||(this._textWidth=I_a,this._textHeight=I_b,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},I_a.checkEnabledViewportOrNot=function(){return this.overflow==I_n.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},I_a.changeText=function(I_a){this._text!==I_a&&(this.lang(I_a+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},I_a.parseLines=function(I_a){var I_b=this.wordWrap||this.overflow==I_n.HIDDEN;if(I_b)var I_c=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var I_d=I_O.context.measureText(I_n._testWord);I_J.isConchApp&&0===I_d.width&&0===I_d.height&&(I_d=I_O.context.measureText("W")),this._charSize.width=I_d.width,this._charSize.height=I_d.height||this.fontSize}for(var I_e=I_a.replace(/\r\n/g,"\n").split("\n"),I_f=0,I_g=I_e.length;I_f<I_g;I_f++){var I_h=I_e[I_f];I_b?this.parseLine(I_h,I_c):(this._lineWidths.push(this.getTextWidth(I_h)),this._lines.push(I_h))}},I_a.parseLine=function(I_a,I_b){I_O.context;var I_c,I_d=this._lines,I_e=0,I_f=NaN,I_g=NaN,I_h=0;if((I_f=this.getTextWidth(I_a))<=I_b)return I_d.push(I_a),void this._lineWidths.push(I_f);I_f=this._charSize.width,0==(I_e=Math.floor(I_b/I_f))&&(I_e=1),I_g=I_f=this.getTextWidth(I_a.substring(0,I_e));for(var I_i=I_e,I_j=I_a.length;I_i<I_j;I_i++)if(I_b<(I_g+=I_f=this.getTextWidth(I_a.charAt(I_i))))if(this.wordWrap){var I_k=I_a.substring(I_h,I_i);if(I_k.charCodeAt(I_k.length-1)<255?(I_c=/(?:\w|-)+$/.exec(I_k))&&(I_i=I_c.index+I_h,0==I_c.index?I_i+=I_k.length:I_k=I_a.substring(I_h,I_i)):I_n.RightToLeft&&(I_c=/([\u0600-\u06FF])+$/.exec(I_k))&&(I_i=I_c.index+I_h,0==I_c.index?I_i+=I_k.length:I_k=I_a.substring(I_h,I_i)),I_d.push(I_k),this._lineWidths.push(I_g-I_f),!((I_h=I_i)+I_e<I_j)){I_d.push(I_a.substring(I_h,I_j)),this._lineWidths.push(this.getTextWidth(I_d[I_d.length-1])),I_h=-1;break}I_i+=I_e,I_g=I_f=this.getTextWidth(I_a.substring(I_h,I_i)),I_i--}else if(this.overflow==I_n.HIDDEN)return I_d.push(I_a.substring(0,I_i)),void this._lineWidths.push(this.getTextWidth(I_d[I_d.length-1]));this.wordWrap&&-1!=I_h&&(I_d.push(I_a.substring(I_h,I_j)),this._lineWidths.push(this.getTextWidth(I_d[I_d.length-1])))},I_a.getTextWidth=function(I_a){return this._currBitmapFont?this._currBitmapFont.getTextWidth(I_a):I_O.context.measureText(I_a).width},I_a.getWordWrapWidth=function(){var I_a=this.padding,I_b=NaN;return(I_b=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(I_b=this.wordWrap?100:I_O.width),I_b<=0&&(I_b=100),I_b-I_a[3]-I_a[1]},I_a.getCharPoint=function(I_a,I_b){this._isChanged&&I_z.timer.runCallLater(this,this.typeset);for(var I_c=0,I_d=this._lines,I_e=0,I_f=0,I_g=I_d.length;I_f<I_g;I_f++){if(I_a<(I_c+=I_d[I_f].length)){var I_h=I_f;break}I_e=I_c}var I_i=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;I_O.context.font=I_i;var I_j=this.getTextWidth(this._text.substring(I_e,I_a));return(I_b||new I_A).setTo(this._startX+I_j-(this._clipPoint?this._clipPoint.x:0),this._startY+I_h*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},I_o(0,I_a,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(I_a){I_a!=this._width&&(I_z.superSet(I_la,this,"width",I_a),this.isChanged=!0)}),I_o(0,I_a,"textWidth",function(){return this._isChanged&&I_z.timer.runCallLater(this,this.typeset),this._textWidth}),I_o(0,I_a,"height",function(){return this._height?this._height:this.textHeight},function(I_a){I_a!=this._height&&(I_z.superSet(I_la,this,"height",I_a),this.isChanged=!0)}),I_o(0,I_a,"textHeight",function(){return this._isChanged&&I_z.timer.runCallLater(this,this.typeset),this._textHeight}),I_o(0,I_a,"padding",function(){return this._getCSSStyle().padding},function(I_a){this._getCSSStyle().padding=I_a,this.isChanged=!0}),I_o(0,I_a,"bold",function(){return this._getCSSStyle().bold},function(I_a){this._getCSSStyle().bold=I_a,this.isChanged=!0}),I_o(0,I_a,"text",function(){return this._text||""},function(I_a){this._text!==I_a&&(this.lang(I_a+""),this.isChanged=!0,this.event("change"))}),I_o(0,I_a,"color",function(){return this._getCSSStyle().color},function(I_a){this._getCSSStyle().color!=I_a&&(this._getCSSStyle().color=I_a,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),I_o(0,I_a,"font",function(){return this._getCSSStyle().fontFamily},function(I_a){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),I_n._bitmapFonts&&I_n._bitmapFonts[I_a]&&(this._currBitmapFont=I_n._bitmapFonts[I_a]),this._getCSSStyle().fontFamily=I_a,this.isChanged=!0}),I_o(0,I_a,"fontSize",function(){return this._getCSSStyle().fontSize},function(I_a){this._getCSSStyle().fontSize=I_a,this.isChanged=!0}),I_o(0,I_a,"italic",function(){return this._getCSSStyle().italic},function(I_a){this._getCSSStyle().italic=I_a,this.isChanged=!0}),I_o(0,I_a,"align",function(){return this._getCSSStyle().align},function(I_a){this._getCSSStyle().align=I_a,this.isChanged=!0}),I_o(0,I_a,"valign",function(){return this._getCSSStyle().valign},function(I_a){this._getCSSStyle().valign=I_a,this.isChanged=!0}),I_o(0,I_a,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(I_a){this._getCSSStyle().wordWrap=I_a,this.isChanged=!0}),I_o(0,I_a,"leading",function(){return this._getCSSStyle().leading},function(I_a){this._getCSSStyle().leading=I_a,this.isChanged=!0}),I_o(0,I_a,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(I_a){this._getCSSStyle().backgroundColor=I_a,this.isChanged=!0}),I_o(0,I_a,"borderColor",function(){return this._getCSSStyle().borderColor},function(I_a){this._getCSSStyle().borderColor=I_a,this.isChanged=!0}),I_o(0,I_a,"stroke",function(){return this._getCSSStyle().stroke},function(I_a){this._getCSSStyle().stroke=I_a,this.isChanged=!0}),I_o(0,I_a,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(I_a){this._getCSSStyle().strokeColor=I_a,this.isChanged=!0}),I_o(0,I_a,"isChanged",null,function(I_a){this._isChanged!==I_a&&(this._isChanged=I_a)&&I_z.timer.callLater(this,this.typeset)}),I_o(0,I_a,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(I_a){if(!(this.overflow!=I_n.SCROLL||this.textWidth<this._width)&&this._clipPoint){I_a=I_a<this.padding[3]?this.padding[3]:I_a;var I_b=this._textWidth-this._width;I_a=I_b<I_a?I_b:I_a;var I_c=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=I_a,this.renderText(this._lastVisibleLineIndex,I_c)}}),I_o(0,I_a,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(I_a){if(!(this.overflow!=I_n.SCROLL||this.textHeight<this._height)&&this._clipPoint){I_a=I_a<this.padding[0]?this.padding[0]:I_a;var I_b=this._textHeight-this._height,I_c=(I_a=I_b<I_a?I_b:I_a)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=I_c;var I_d=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=I_a,this.renderText(I_c,I_d)}}),I_o(0,I_a,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),I_o(0,I_a,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),I_o(0,I_a,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),I_o(0,I_a,"underlineColor",function(){return this._underlineColor},function(I_a){this._underlineColor=I_a,this._isChanged=!0,this.typeset()}),I_n.registerBitmapFont=function(I_a,I_b){I_n._bitmapFonts||(I_n._bitmapFonts={}),I_n._bitmapFonts[I_a]=I_b},I_n.unregisterBitmapFont=function(I_a,I_b){if(void 0===I_b&&(I_b=!0),I_n._bitmapFonts&&I_n._bitmapFonts[I_a]){var I_c=I_n._bitmapFonts[I_a];I_b&&I_c.destroy(),delete I_n._bitmapFonts[I_a]}},I_n.setTextRightToLeft=function(){var I_a;(I_a=I_O.canvas.source.style).display="none",I_a.position="absolute",I_a.direction="rtl",I_J._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,I_O.document.body.appendChild(I_O.canvas.source)},I_n.supportFont=function(I_a){I_O.context.font="10px sans-serif";var I_b=I_O.context.measureText("abcji").width;I_O.context.font="10px "+I_a;var I_c=I_O.context.measureText("abcji").width;return console.log(I_b,I_c),I_b!==I_c},I_n._testWord="游",I_n.langPacks=null,I_n.VISIBLE="visible",I_n.SCROLL="scroll",I_n.HIDDEN="hidden",I_n.CharacterCache=!0,I_n.RightToLeft=!1,I_n._bitmapFonts=null,I_i(I_n,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),I_n}(I_la),I_ta=function(I_l){function I_g(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",I_g.__super.call(this),this.offset=new I_A,this._canvasTransform=new I_G,this._previousOrientation=I_O.window.orientation;var I_b=this;this.transform=I_G.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var I_a=I_O.window,I_c=this;I_a.addEventListener("focus",function(){I_b._isFocused=!0,I_c.event("focus"),I_c.event("focuschange")}),I_a.addEventListener("blur",function(){I_b._isFocused=!1,I_c.event("blur"),I_c.event("focuschange"),I_c._isInputting()&&(I_xa.inputElement.target.focus=!1)});var I_d="visibilityState",I_e="visibilitychange",I_f=I_a.document;void 0!==I_f.hidden?(I_e="visibilitychange",I_d="visibilityState"):void 0!==I_f.mozHidden?(I_e="mozvisibilitychange",I_d="mozVisibilityState"):void 0!==I_f.msHidden?(I_e="msvisibilitychange",I_d="msVisibilityState"):void 0!==I_f.webkitHidden&&(I_e="webkitvisibilitychange",I_d="webkitVisibilityState"),I_a.document.addEventListener(I_e,function(){"hidden"==I_O.document[I_d]?I_c._setStageVisible(!1):I_c._setStageVisible(!0)}),I_a.document.addEventListener("qbrowserVisibilityChange",function(I_a){I_c._setStageVisible(!I_a.hidden)}),I_a.addEventListener("resize",function(){var I_a=I_O.window.orientation;null!=I_a&&I_a!=I_b._previousOrientation&&I_c._isInputting()&&(I_xa.inputElement.target.focus=!1),I_b._previousOrientation=I_a,I_c._isInputting()||I_c._resetCanvas()}),I_a.addEventListener("orientationchange",function(I_a){I_c._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),I_O.onMobile&&this.on("mousedown",this,this._onmouseMove)}I_k(I_g,"laya.display.Stage",I_l);var I_a=I_g.prototype;return I_a._setStageVisible=function(I_a){this._isVisibility!=I_a&&(this._isVisibility=I_a,this._isVisibility||this._isInputting()&&(I_xa.inputElement.target.focus=!1),this.event("visibilitychange"))},I_a._isInputting=function(){return I_O.onMobile&&I_xa.isInputting},I_a._changeCanvasSize=function(){this.setScreenSize(I_O.clientWidth*I_O.pixelRatio,I_O.clientHeight*I_O.pixelRatio)},I_a._resetCanvas=function(){if(this.screenAdaptationEnabled){var I_a=I_J._mainCanvas;I_a.source.style;I_a.size(1,1),I_z.timer.once(100,this,this._changeCanvasSize)}},I_a.setScreenSize=function(I_a,I_b){var I_c=!1;if("none"!==this._screenMode&&(I_c=(I_a/I_b<1?"vertical":"horizontal")!==this._screenMode)){var I_d=I_b;I_b=I_a,I_a=I_d}this.canvasRotation=I_c;var I_e=I_J._mainCanvas,I_f=I_e.source.style,I_g=this._canvasTransform.identity(),I_h=this._scaleMode,I_i=I_a/this.designWidth,I_j=I_b/this.designHeight,I_k=this.designWidth,I_l=this.designHeight,I_m=I_a,I_n=I_b,I_o=I_O.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,I_h){case"noscale":I_i=I_j=1,I_m=this.designWidth,I_n=this.designHeight;break;case"showall":I_i=I_j=Math.min(I_i,I_j),I_k=I_m=Math.round(this.designWidth*I_i),I_l=I_n=Math.round(this.designHeight*I_j);break;case"noborder":I_i=I_j=Math.max(I_i,I_j),I_m=Math.round(this.designWidth*I_i),I_n=Math.round(this.designHeight*I_j);break;case"full":I_i=I_j=1,this._width=I_k=I_a,this._height=I_l=I_b;break;case"fixedwidth":I_j=I_i,this._height=I_l=Math.round(I_b/I_i);break;case"fixedheight":I_i=I_j,this._width=I_k=Math.round(I_a/I_j);break;case"fixedauto":I_a/I_b<this.designWidth/this.designHeight?(I_j=I_i,this._height=I_l=Math.round(I_b/I_i)):(I_i=I_j,this._width=I_k=Math.round(I_a/I_j))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,I_k=I_k+1&2147483646,I_l=I_l+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),I_i*=this.scaleX,I_j*=this.scaleY,1===I_i&&1===I_j?this.transform.identity():(this.transform.a=this._formatData(I_i/(I_m/I_k)),this.transform.d=this._formatData(I_j/(I_n/I_l)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),I_e.size(I_k,I_l),I_F.changeWebGLSize(I_k,I_l),I_g.scale(I_m/I_k/I_o,I_n/I_l/I_o),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(I_a-I_m)/I_o:this.offset.x=.5*(I_a-I_m)/I_o,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(I_b-I_n)/I_o:this.offset.y=.5*(I_b-I_n)/I_o,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),I_g.translate(this.offset.x,this.offset.y),this.canvasDegree=0,I_c&&("horizontal"===this._screenMode?(I_g.rotate(Math.PI/2),I_g.translate(I_b/I_o,0),this.canvasDegree=90):(I_g.rotate(-Math.PI/2),I_g.translate(0,I_a/I_o),this.canvasDegree=-90)),I_g.a=this._formatData(I_g.a),I_g.d=this._formatData(I_g.d),I_g.tx=this._formatData(I_g.tx),I_g.ty=this._formatData(I_g.ty),I_f.transformOrigin=I_f.webkitTransformOrigin=I_f.msTransformOrigin=I_f.mozTransformOrigin=I_f.oTransformOrigin="0px 0px 0px",I_f.transform=I_f.webkitTransform=I_f.msTransform=I_f.mozTransform=I_f.oTransform="matrix("+I_g.toString()+")",I_g.translate(parseInt(I_f.left)||0,parseInt(I_f.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},I_a._formatData=function(I_a){return Math.abs(I_a)<1e-6?0:Math.abs(1-I_a)<.001?0<I_a?1:-1:I_a},I_a.getMousePoint=function(){return I_A.TEMP.setTo(this.mouseX,this.mouseY)},I_a.repaint=function(){this._repaint=1},I_a.parentRepaint=function(){},I_a._loop=function(){return this.render(I_J.context,0,0),!0},I_a._onmouseMove=function(I_a){this._mouseMoveTime=I_O.now()},I_a.getTimeFromFrameStart=function(){return I_O.now()-this._frameStartTime},I_a.render=function(I_a,I_b,I_c){if("sleep"===this._frameRate&&!I_J.isConchApp){var I_d=I_O.now();if(!(1e3<=I_d-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(I_X.loopCount++,I_p.instance.runEvent(),I_z.timer._update()));this._frameStartTime=I_d}if(this._renderCount++,I_J.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=I_O.now();var I_e="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),I_f=this._renderCount%2==0;if(I_X.renderSlow=!I_e,I_e||I_f||I_J.isConchApp){var I_g;I_X.loopCount++,I_p.instance.runEvent(),I_z.timer._update(),I_F.update3DLoop();var I_h=0,I_i=0;if(I_J.isConchNode)for(I_h=0,I_i=this._scenes.length;I_h<I_i;I_h++)(I_g=this._scenes[I_h])&&I_g._updateSceneConch();else for(I_h=0,I_i=this._scenes.length;I_h<I_i;I_h++)(I_g=this._scenes[I_h])&&I_g._updateScene();if(I_J.isConchNode){var I_j=I_la.CustomList;for(I_h=0,I_i=I_j.length;I_h<I_i;I_h++){var I_k=I_j[I_h];I_k.customRender(I_k.customContext,0,0)}return}}I_J.isConchNode||this.renderingEnabled&&(I_e||!I_f||I_J.isConchWebGL)&&(I_J.isWebGL?I_J.WebGL.mainContext&&!I_J.WebGL.mainContext.isContextLost()&&(I_a.clear(),I_l.prototype.render.call(this,I_a,I_b,I_c),I_X._show&&I_X._sp&&I_X._sp.render(I_a,I_b,I_c),I_F.clear(this._bgColor),I_F.beginFlush(),I_a.flush(),I_F.endFinish(),I__.instance&&I__.getInstance().endDispose()):(I_F.clear(this._bgColor),I_l.prototype.render.call(this,I_a,I_b,I_c),I_X._show&&I_X._sp&&I_X._sp.render(I_a,I_b,I_c)))}else this._renderCount%5==0&&(I_X.loopCount++,I_p.instance.runEvent(),I_z.timer._update())},I_a._requestFullscreen=function(){var I_a=I_O.document.documentElement;I_a.requestFullscreen?I_a.requestFullscreen():I_a.mozRequestFullScreen?I_a.mozRequestFullScreen():I_a.webkitRequestFullscreen?I_a.webkitRequestFullscreen():I_a.msRequestFullscreen&&I_a.msRequestFullscreen()},I_a._fullScreenChanged=function(){I_z.stage.event("fullscreenchange")},I_a.exitFullscreen=function(){var I_a=I_O.document;I_a.exitFullscreen?I_a.exitFullscreen():I_a.mozCancelFullScreen?I_a.mozCancelFullScreen():I_a.webkitExitFullscreen&&I_a.webkitExitFullscreen()},I_o(0,I_a,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),I_o(0,I_a,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),I_o(0,I_a,"frameRate",function(){return this._frameRate},function(I_a){if(this._frameRate=I_a,I_J.isConchApp)switch(this._frameRate){case"slow":I_O.window.conch&&I_O.window.conchConfig.setSlowFrame&&I_O.window.conchConfig.setSlowFrame(!0);break;case"fast":I_O.window.conch&&I_O.window.conchConfig.setSlowFrame&&I_O.window.conchConfig.setSlowFrame(!1);break;case"mouse":I_O.window.conch&&I_O.window.conchConfig.setMouseFrame&&I_O.window.conchConfig.setMouseFrame(2e3);break;case"sleep":I_O.window.conch&&I_O.window.conchConfig.setLimitFPS&&I_O.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),I_o(0,I_a,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),I_o(0,I_a,"width",I_l.prototype._$get_width,function(I_a){this.designWidth=I_a,I_z.superSet(I_la,this,"width",I_a),I_z.timer.callLater(this,this._changeCanvasSize)}),I_o(0,I_a,"alignH",function(){return this._alignH},function(I_a){this._alignH=I_a,I_z.timer.callLater(this,this._changeCanvasSize)}),I_o(0,I_a,"isFocused",function(){return this._isFocused}),I_o(0,I_a,"height",I_l.prototype._$get_height,function(I_a){this.designHeight=I_a,I_z.superSet(I_la,this,"height",I_a),I_z.timer.callLater(this,this._changeCanvasSize)}),I_o(0,I_a,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||I_G.create()},I_l.prototype._$set_transform),I_o(0,I_a,"isVisibility",function(){return this._isVisibility}),I_o(0,I_a,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),I_o(0,I_a,"scaleMode",function(){return this._scaleMode},function(I_a){this._scaleMode=I_a,I_z.timer.callLater(this,this._changeCanvasSize)}),I_o(0,I_a,"alignV",function(){return this._alignV},function(I_a){this._alignV=I_a,I_z.timer.callLater(this,this._changeCanvasSize)}),I_o(0,I_a,"bgColor",function(){return this._bgColor},function(I_a){this._bgColor=I_a,this.conchModel&&this.conchModel.bgColor(I_a),I_J.isWebGL&&(I_a?I_g._wgColor=I_S.create(I_a)._color:I_O.onMiniGame||(I_g._wgColor=null)),I_O.onLimixiu?I_g._wgColor=I_S.create(I_a)._color:I_J.canvas.style.background=I_a||"none"}),I_o(0,I_a,"mouseX",function(){return Math.round(I_p.instance.mouseX/this.clientScaleX)}),I_o(0,I_a,"mouseY",function(){return Math.round(I_p.instance.mouseY/this.clientScaleY)}),I_o(0,I_a,"screenMode",function(){return this._screenMode},function(I_a){this._screenMode=I_a}),I_o(0,I_a,"visible",I_l.prototype._$get_visible,function(I_a){this.visible!==I_a&&(I_z.superSet(I_la,this,"visible",I_a),I_J._mainCanvas.source.style.visibility=I_a?"visible":"hidden")}),I_o(0,I_a,"fullScreenEnabled",null,function(I_a){var I_b=I_O.document,I_c=I_J.canvas;I_a?(I_c.addEventListener("mousedown",this._requestFullscreen),I_c.addEventListener("touchstart",this._requestFullscreen),I_b.addEventListener("fullscreenchange",this._fullScreenChanged),I_b.addEventListener("mozfullscreenchange",this._fullScreenChanged),I_b.addEventListener("webkitfullscreenchange",this._fullScreenChanged),I_b.addEventListener("msfullscreenchange",this._fullScreenChanged)):(I_c.removeEventListener("mousedown",this._requestFullscreen),I_c.removeEventListener("touchstart",this._requestFullscreen),I_b.removeEventListener("fullscreenchange",this._fullScreenChanged),I_b.removeEventListener("mozfullscreenchange",this._fullScreenChanged),I_b.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),I_b.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),I_g.SCALE_NOSCALE="noscale",I_g.SCALE_EXACTFIT="exactfit",I_g.SCALE_SHOWALL="showall",I_g.SCALE_NOBORDER="noborder",I_g.SCALE_FULL="full",I_g.SCALE_FIXED_WIDTH="fixedwidth",I_g.SCALE_FIXED_HEIGHT="fixedheight",I_g.SCALE_FIXED_AUTO="fixedauto",I_g.ALIGN_LEFT="left",I_g.ALIGN_RIGHT="right",I_g.ALIGN_CENTER="center",I_g.ALIGN_TOP="top",I_g.ALIGN_MIDDLE="middle",I_g.ALIGN_BOTTOM="bottom",I_g.SCREEN_NONE="none",I_g.SCREEN_HORIZONTAL="horizontal",I_g.SCREEN_VERTICAL="vertical",I_g.FRAME_FAST="fast",I_g.FRAME_SLOW="slow",I_g.FRAME_MOUSE="mouse",I_g.FRAME_SLEEP="sleep",I_g.FRAME_MOUSE_THREDHOLD=2e3,I_i(I_g,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),I_g}(I_la),I_ua=(function(I_a){function I_b(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,I_b.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}I_k(I_b,"laya.media.SoundNode",I_la);var I_c=I_b.prototype;I_c._onParentChange=function(){this.target=this.parent},I_c.play=function(I_a,I_b){void 0===I_a&&(I_a=1),isNaN(I_a)&&(I_a=1),this.url&&(this.stop(),this._channel=I_E.playSound(this.url,I_a,null,I_b))},I_c.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},I_c._setPlayAction=function(I_a,I_b,I_c,I_d){void 0===I_d&&(I_d=!0),this[I_c]&&I_a&&(I_d?I_a.on(I_b,this,this[I_c]):I_a.off(I_b,this,this[I_c]))},I_c._setPlayActions=function(I_a,I_b,I_c,I_d){if(void 0===I_d&&(I_d=!0),I_a&&I_b){var I_e,I_f=I_b.split(","),I_g=0;for(I_e=I_f.length,I_g=0;I_g<I_e;I_g++)this._setPlayAction(I_a,I_f[I_g],I_c,I_d)}},I_o(0,I_c,"playEvent",null,function(I_a){(this._playEvents=I_a)&&this._tar&&this._setPlayActions(this._tar,I_a,"play")}),I_o(0,I_c,"target",null,function(I_a){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=I_a,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),I_o(0,I_c,"stopEvent",null,function(I_a){(this._stopEvents=I_a)&&this._tar&&this._setPlayActions(this._tar,I_a,"stop")})}(),function(I_a){function I_b(){this._src=null,this._onload=null,this._onerror=null,I_b.__super.call(this)}I_k(I_b,"laya.resource.FileBitmap",I_oa);var I_c=I_b.prototype;return I_o(0,I_c,"src",function(){return this._src},function(I_a){this._src=I_a}),I_o(0,I_c,"onload",null,function(I_a){}),I_o(0,I_c,"onerror",null,function(I_a){}),I_b}()),I_va=function(I_a){function I_c(I_a,I_b){this._is2D=!1,I_c.__super.call(this);var I_d=this;if(this._source=this,"2D"===I_a||"AUTO"===I_a&&!I_J.isWebGL){this._is2D=!0,this._source=I_b||I_O.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var I_e=this;I_e.getContext=function(I_a,I_b){if(I_d._ctx)return I_d._ctx;var I_c=I_d._ctx=I_d._source.getContext(I_a,I_b);return I_c&&(I_c._canvas=I_e,I_J.isFlash||I_O.onLimixiu||(I_c.size=function(I_a,I_b){})),I_c}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}I_k(I_c,"laya.resource.HTMLCanvas",I_oa);var I_b=I_c.prototype;return I_b.clear=function(){this._ctx&&this._ctx.clear()},I_b.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},I_b.release=function(){},I_b._setContext=function(I_a){this._ctx=I_a},I_b.getContext=function(I_a,I_b){return this._ctx?this._ctx:this._ctx=I_c._createContext(this)},I_b.getMemSize=function(){return 0},I_b.size=function(I_a,I_b){(this._w!=I_a||this._h!=I_b||this._source&&(this._source.width!=I_a||this._source.height!=I_b))&&(this._w=I_a,this._h=I_b,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(I_a,I_b),this._source&&(this._source.height=I_b,this._source.width=I_a))},I_b.getCanvas=function(){return this._source},I_b.toBase64=function(I_a,I_b,I_c){if(this._source)if(I_J.isConchApp&&this._source.toBase64)this._source.toBase64(I_a,I_b,I_c);else{var I_d=this._source.toDataURL(I_a,I_b);I_c.call(this,I_d)}},I_o(0,I_b,"context",function(){return this._ctx}),I_o(0,I_b,"asBitmap",null,function(I_a){}),I_c.create=function(I_a,I_b){return new I_c(I_a,I_b)},I_c.TYPE2D="2D",I_c.TYPE3D="3D",I_c.TYPEAUTO="AUTO",I_c._createContext=null,I_c}(),I_wa=(function(I_a){function I_i(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){throw I_i.__super.call(this),new Error("不允许new！")}I_k(I_i,"laya.resource.HTMLSubImage",I_oa),I_i.create=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){return void 0===I_h&&(I_h=!1),new I_i(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h)}}(),function(I_a){function I_l(){this._frames=null,this._url=null,I_l.__super.call(this),this._setControlNode(this)}I_k(I_l,"laya.display.Animation",I_a);var I_b=I_l.prototype;I_b.destroy=function(I_a){void 0===I_a&&(I_a=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,I_a),this._frames=null,this._labels=null},I_b.play=function(I_a,I_b,I_c,I_d){void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=!0),void 0===I_c&&(I_c=""),void 0===I_d&&(I_d=!0),I_c&&this._setFramesFromCache(I_c,I_d),this._isPlaying=!0,this.index="string"==typeof I_a?this._getFrameByLabel(I_a):I_a,this.loop=I_b,this._actionName=I_c,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},I_b._setFramesFromCache=function(I_a,I_b){var I_c;return void 0===I_b&&(I_b=!1),this._url&&(I_a=this._url+"#"+I_a),I_a&&I_l.framesMap[I_a]?((I_c=I_l.framesMap[I_a])instanceof Array?(this._frames=I_l.framesMap[I_a],this._count=this._frames.length):(I_c.nodeRoot&&(I_l.framesMap[I_a]=this._parseGraphicAnimationByData(I_c),I_c=I_l.framesMap[I_a]),this._frames=I_c.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=I_c.interval),this._labels=this._copyLabels(I_c.labels)),!0):(I_b&&console.log("ani not found:",I_a),!1)},I_b._copyLabels=function(I_a){if(!I_a)return null;var I_b,I_c;for(I_c in I_b={},I_a)I_b[I_c]=I_$.copyArray([],I_a[I_c]);return I_b},I_b._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&I_a.prototype._frameLoop.call(this)},I_b._displayToIndex=function(I_a){this._frames&&(this.graphics=this._frames[I_a])},I_b.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},I_b.loadImages=function(I_a,I_b){return void 0===I_b&&(I_b=""),this._url="",this._setFramesFromCache(I_b)||(this.frames=I_l.framesMap[I_b]?I_l.framesMap[I_b]:I_l.createFrames(I_a,I_b)),this},I_b.loadAtlas=function(I_b,I_c,I_d){void 0===I_d&&(I_d=""),this._url="";var I_e=this;function I_a(I_a){I_b===I_a&&(I_e.frames=I_l.framesMap[I_d]?I_l.framesMap[I_d]:I_l.createFrames(I_b,I_d),I_c&&I_c.run())}return I_e._setFramesFromCache(I_d)||(I_ha.getAtlas(I_b)?I_a(I_b):I_z.loader.load(I_b,I_u.create(null,I_a,[I_b]),null,"atlas")),this},I_b.loadAnimation=function(I_a,I_b,I_c){this._url=I_a;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,I_b&&I_b.run()):!I_c||I_ha.getAtlas(I_c)?this._loadAnimationData(I_a,I_b,I_c):I_z.loader.load(I_c,I_u.create(this,this._loadAnimationData,[I_a,I_b,I_c]),null,"atlas"),this},I_b._loadAnimationData=function(I_h,I_i,I_a){var I_j=this;if(!I_a||I_ha.getAtlas(I_a)){var I_k=this;I_ha.getRes(I_h)?I_b(I_h):I_z.loader.load(I_h,I_u.create(null,I_b,[I_h]),null,"json"),I_ha.clearRes(I_h)}else console.warn("atlas load fail:"+I_a);function I_b(I_a){if(I_ha.getRes(I_a)&&I_h===I_a){var I_b;if(I_l.framesMap[I_h+"#"])I_k._setFramesFromCache(I_j._actionName,!0),I_j.index=0,I_j._checkResumePlaying();else{var I_c=I_k._parseGraphicAnimation(I_ha.getRes(I_h));if(!I_c)return;var I_d,I_e=I_c.animationList,I_f=0,I_g=I_e.length;for(I_f=0;I_f<I_g;I_f++)I_b=I_e[I_f],I_l.framesMap[I_h+"#"+I_b.name]=I_b,I_d||(I_d=I_b);I_d&&(I_l.framesMap[I_h+"#"]=I_d,I_k._setFramesFromCache(I_j._actionName,!0),I_j.index=0),I_j._checkResumePlaying()}I_i&&I_i.run()}}},I_b._parseGraphicAnimation=function(I_a){return I_za.parseAnimationData(I_a)},I_b._parseGraphicAnimationByData=function(I_a){return I_za.parseAnimationByData(I_a)},I_o(0,I_b,"frames",function(){return this._frames},function(I_a){(this._frames=I_a)&&(this._count=I_a.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),I_o(0,I_b,"autoPlay",null,function(I_a){I_a?this.play():this.stop()}),I_o(0,I_b,"source",null,function(I_a){-1<I_a.indexOf(".ani")?this.loadAnimation(I_a):-1<I_a.indexOf(".json")||-1<I_a.indexOf("als")||-1<I_a.indexOf("atlas")?this.loadAtlas(I_a):this.loadImages(I_a.split(","))}),I_o(0,I_b,"autoAnimation",null,function(I_a){this.play(0,!0,I_a,!1)}),I_l.createFrames=function(I_a,I_b){var I_c,I_d,I_e=0,I_f=0;if("string"==typeof I_a){var I_g=I_ha.getAtlas(I_a);if(I_g&&I_g.length)for(I_c=[],I_e=0,I_f=I_g.length;I_e<I_f;I_e++)(I_d=new I_F.createGraphics).drawTexture(I_ha.getRes(I_g[I_e]),0,0),I_c.push(I_d)}else if(I_a instanceof Array)for(I_c=[],I_e=0,I_f=I_a.length;I_e<I_f;I_e++)(I_d=new I_F.createGraphics).loadImage(I_a[I_e],0,0),I_c.push(I_d);return I_b&&(I_l.framesMap[I_b]=I_c),I_c},I_l.clearCache=function(I_a){var I_b,I_c=I_l.framesMap,I_d=I_a+"#";for(I_b in I_c)I_b!==I_a&&0!=I_b.indexOf(I_d)||delete I_l.framesMap[I_b]},I_l.framesMap={}}(I_pa),function(I_a){function I_f(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,I_f.__super.call(this),null==I_f._sortIndexFun&&(I_f._sortIndexFun=I_y.sortByKey("index",!1,!0))}I_k(I_f,"laya.display.FrameAnimation",I_a);var I_b=I_f.prototype;return I_b._setUp=function(I_a,I_b){this._labels=null,this._animationNewFrames=null,this._targetDic=I_a,this._animationData=I_b,this.interval=1e3/I_b.frameRate,I_b.parsed?(this._count=I_b.count,this._labels=I_b.labels,this._animationNewFrames=I_b.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),I_b.parsed=!0,I_b.labels=this._labels,I_b.count=this._count,I_b.animationNewFrames=this._animationNewFrames},I_b.clear=function(){I_a.prototype.clear.call(this),this._targetDic=null,this._animationData=null},I_b._displayToIndex=function(I_a){if(this._animationData){I_a<0&&(I_a=0),I_a>this._count&&(I_a=this._count);var I_b=this._animationData.nodes,I_c=0,I_d=I_b.length;for(I_c=0;I_c<I_d;I_c++)this._displayNodeToFrame(I_b[I_c],I_a)}},I_b._displayNodeToFrame=function(I_a,I_b,I_c){I_c||(I_c=this._targetDic);var I_d=I_c[I_a.target];if(I_d){var I_e,I_f,I_g,I_h=I_a.frames,I_i=I_a.keys,I_j=0,I_k=I_i.length;for(I_j=0;I_j<I_k;I_j++)I_g=(I_f=I_h[I_e=I_i[I_j]]).length>I_b?I_f[I_b]:I_f[I_f.length-1],I_d[I_e]=I_g}},I_b._calculateDatas=function(){if(this._animationData){var I_a,I_b=this._animationData.nodes,I_c=0,I_d=I_b.length;for(I_c=this._count=0;I_c<I_d;I_c++)I_a=I_b[I_c],this._calculateNodeKeyFrames(I_a);this._count+=1}},I_b._calculateNodeKeyFrames=function(I_a){var I_b,I_c,I_d=I_a.keyframes,I_e=I_a.target;for(I_b in I_a.frames||(I_a.frames={}),I_a.keys?I_a.keys.length=0:I_a.keys=[],I_a.initValues||(I_a.initValues={}),I_d)I_c=I_d[I_b],I_a.frames[I_b]||(I_a.frames[I_b]=[]),this._targetDic&&this._targetDic[I_e]&&(I_a.initValues[I_b]=this._targetDic[I_e][I_b]),I_c.sort(I_f._sortIndexFun),I_a.keys.push(I_b),this._calculateNodePropFrames(I_c,I_a.frames[I_b],I_b,I_e)},I_b.resetToInitState=function(){if(this._targetDic&&this._animationData){var I_a,I_b,I_c=this._animationData.nodes,I_d=0,I_e=I_c.length;for(I_d=0;I_d<I_e;I_d++)if(I_b=(I_a=I_c[I_d]).initValues){var I_f,I_g=this._targetDic[I_a.target];if(I_g)for(I_f in I_b)I_g[I_f]=I_b[I_f]}}},I_b._calculateNodePropFrames=function(I_a,I_b,I_c,I_d){var I_e=0,I_f=I_a.length-1;if(0<I_f){for(I_b.length=I_a[I_f].index+1,I_e=0;I_e<I_f;I_e++)this._dealKeyFrame(I_a[I_e]),this._calculateFrameValues(I_a[I_e],I_a[I_e+1],I_b);this._dealKeyFrame(I_a[I_e])}0==I_f&&(I_b[I_a[0].index]=I_a[0].value,this._animationNewFrames&&(this._animationNewFrames[I_a[0].index]=!0))},I_b._dealKeyFrame=function(I_a){I_a.label&&""!=I_a.label&&this.addLabel(I_a.label,I_a.index)},I_b._calculateFrameValues=function(I_a,I_b,I_c){var I_d,I_e=0,I_f=I_a.index,I_g=I_b.index,I_h=I_a.value,I_i=I_b.value-I_a.value,I_j=I_g-I_f;if(I_g>this._count&&(this._count=I_g),I_a.tween)for(null==(I_d=I_U[I_a.tweenMethod])&&(I_d=I_U.linearNone),I_e=I_f;I_e<I_g;I_e++)I_c[I_e]=I_d(I_e-I_f,I_h,I_i,I_j),this._animationNewFrames&&(this._animationNewFrames[I_e]=!0);else for(I_e=I_f;I_e<I_g;I_e++)I_c[I_e]=I_h;this._animationNewFrames&&(this._animationNewFrames[I_a.index]=!0,this._animationNewFrames[I_b.index]=!0),I_c[I_b.index]=I_b.value},I_f._sortIndexFun=null,I_f}(I_pa)),I_xa=function(I_b){function I_e(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",I_e.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=I_sa.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}I_k(I_e,"laya.display.Input",I_b);var I_a=I_e.prototype;return I_a.setSelection=function(I_a,I_b){this.focus=!0,laya.display.Input.inputElement.selectionStart=I_a,laya.display.Input.inputElement.selectionEnd=I_b},I_a._onUnDisplay=function(I_a){this.focus=!1},I_a._onMouseDown=function(I_a){this.focus=!0},I_a._syncInputTransform=function(){var I_a=this.nativeInput,I_b=I_$.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),I_c=this._width-this.padding[1]-this.padding[3],I_d=this._height-this.padding[0]-this.padding[2];I_J.isConchApp?(I_a.setScale(I_b.scaleX,I_b.scaleY),I_a.setSize(I_c,I_d),I_a.setPos(I_b.x,I_b.y)):(I_e.inputContainer.style.transform=I_e.inputContainer.style.webkitTransform="scale("+I_b.scaleX+","+I_b.scaleY+") rotate("+I_z.stage.canvasDegree+"deg)",I_a.style.width=I_c+"px",I_a.style.height=I_d+"px",I_e.inputContainer.style.left=I_b.x+"px",I_e.inputContainer.style.top=I_b.y+"px")},I_a.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},I_a._setInputMethod=function(){I_e.input.parentElement&&I_e.inputContainer.removeChild(I_e.input),I_e.area.parentElement&&I_e.inputContainer.removeChild(I_e.area),I_e.inputElement=this._multiline?I_e.area:I_e.input,I_e.inputContainer.appendChild(I_e.inputElement),I_sa.RightToLeft&&(I_e.inputElement.style.direction="rtl")},I_a._focusIn=function(){laya.display.Input.isInputting=!0;var I_a=this.nativeInput;this._focus=!0;var I_b=I_a.style;I_b.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),I_a.readOnly=!this._editable,I_J.isConchApp&&(I_a.setType(this._type),I_a.setForbidEdit(!this._editable)),I_a.maxLength=this._maxChars;this.padding;if(I_a.type=this._type,I_a.value=this._content,I_a.placeholder=this._prompt,I_z.stage.off("keydown",this,this._onKeyDown),I_z.stage.on("keydown",this,this._onKeyDown),(I_z.stage.focus=this).event("focus"),I_O.onPC&&I_a.focus(),!I_O.onMiniGame){this._text;this._text=null}this.typeset(),I_a.setColor(this._originColor),I_a.setFontSize(this.fontSize),I_a.setFontFace(I_O.onIPhone&&I_sa._fontFamilyMap[this.font]||this.font),I_J.isConchApp&&I_a.setMultiAble&&I_a.setMultiAble(this._multiline),I_b.lineHeight=this.leading+this.fontSize+"px",I_b.fontStyle=this.italic?"italic":"normal",I_b.fontWeight=this.bold?"bold":"normal",I_b.textAlign=this.align,I_b.padding="0 0",this._syncInputTransform(),!I_J.isConchApp&&I_O.onPC&&I_z.timer.frameLoop(1,this,this._syncInputTransform)},I_a._setPromptColor=function(){(I_e.promptStyleDOM=I_O.getElementById("promptStyle"))||((I_e.promptStyleDOM=I_O.createElement("style")).setAttribute("id","promptStyle"),I_O.document.head.appendChild(I_e.promptStyleDOM)),I_e.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},I_a._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(I_z.superSet(I_sa,this,"text",this._content),I_z.superSet(I_sa,this,"color",this._originColor)):(I_z.superSet(I_sa,this,"text",this._prompt),I_z.superSet(I_sa,this,"color",this._promptColor)),I_z.stage.off("keydown",this,this._onKeyDown),I_z.stage.focus=null,this.event("blur"),I_J.isConchApp&&this.nativeInput.blur(),I_O.onPC&&I_z.timer.clear(this,this._syncInputTransform)},I_a._onKeyDown=function(I_a){13===I_a.keyCode&&(I_O.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},I_a.changeText=function(I_a){this._content=I_a,this._focus?(this.nativeInput.value=I_a||"",this.event("change")):I_b.prototype.changeText.call(this,I_a)},I_o(0,I_a,"color",I_b.prototype._$get_color,function(I_a){this._focus&&this.nativeInput.setColor(I_a),I_z.superSet(I_sa,this,"color",this._content?I_a:this._promptColor),this._originColor=I_a}),I_o(0,I_a,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(I_a){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),I_o(0,I_a,"multiline",function(){return this._multiline},function(I_a){this._multiline=I_a,this.valign=I_a?"top":"middle"}),I_o(0,I_a,"maxChars",function(){return this._maxChars},function(I_a){I_a<=0&&(I_a=1e5),this._maxChars=I_a}),I_o(0,I_a,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(I_a){I_z.superSet(I_sa,this,"color",this._originColor),I_a+="",this._focus?(this.nativeInput.value=I_a||"",this.event("change")):(this._multiline||(I_a=I_a.replace(/\r?\n/g,"")),(this._content=I_a)?I_z.superSet(I_sa,this,"text",I_a):(I_z.superSet(I_sa,this,"text",this._prompt),I_z.superSet(I_sa,this,"color",this.promptColor)))}),I_o(0,I_a,"nativeInput",function(){return this._multiline?I_e.area:I_e.input}),I_o(0,I_a,"prompt",function(){return this._prompt},function(I_a){!this._text&&I_a&&I_z.superSet(I_sa,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?I_z.superSet(I_sa,this,"text",this._text==this._prompt?I_a:this._text):I_z.superSet(I_sa,this,"text",I_a),this._prompt=I_sa.langPacks&&I_sa.langPacks[I_a]?I_sa.langPacks[I_a]:I_a}),I_o(0,I_a,"focus",function(){return this._focus},function(I_a){var I_b=this.nativeInput;this._focus!==I_a&&(I_a?(I_b.target?I_b.target._focusOut():this._setInputMethod(),(I_b.target=this)._focusIn()):(I_b.target=null,this._focusOut(),I_O.document.body.scrollTop=0,I_b.blur(),I_J.isConchApp?I_b.setPos(-1e4,-1e4):I_e.inputContainer.contains(I_b)&&I_e.inputContainer.removeChild(I_b)))}),I_o(0,I_a,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(I_a){I_a?(-1<(I_a="[^"+I_a+"]").indexOf("^^")&&(I_a=I_a.replace("^^","")),this._restrictPattern=new RegExp(I_a,"g")):this._restrictPattern=null}),I_o(0,I_a,"editable",function(){return this._editable},function(I_a){this._editable=I_a,I_J.isConchApp&&I_e.input.setForbidEdit(!I_a)}),I_o(0,I_a,"promptColor",function(){return this._promptColor},function(I_a){this._promptColor=I_a,this._content||I_z.superSet(I_sa,this,"color",I_a)}),I_o(0,I_a,"type",function(){return this._type},function(I_a){this._getCSSStyle().password="password"==I_a,this._type=I_a,I_J.isConchApp&&this.nativeInput.setType(I_a)}),I_o(0,I_a,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(I_a){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),I_o(0,I_a,"asPassword",function(){return this._getCSSStyle().password},function(I_a){this._getCSSStyle().password=I_a,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),I_e.__init__=function(){I_e._createInputElement(),I_O.onMobile&&I_J.canvas.addEventListener(I_e.IOS_IFRAME?I_O.onMiniGame?"touchend":"click":"touchend",I_e._popupInputMethod)},I_e._popupInputMethod=function(I_a){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},I_e._createInputElement=function(){I_e._initInput(I_e.area=I_O.createElement("textarea")),I_e._initInput(I_e.input=I_O.createElement("input")),(I_e.inputContainer=I_O.createElement("div")).style.position="absolute",I_e.inputContainer.style.zIndex=1e5,I_O.container.appendChild(I_e.inputContainer),I_e.inputContainer.setPos=function(I_a,I_b){I_e.inputContainer.style.left=I_a+"px",I_e.inputContainer.style.top=I_b+"px"}},I_e._initInput=function(I_b){var I_a=I_b.style;I_a.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",I_a.resize="none",I_a.backgroundColor="transparent",I_a.border="none",I_a.outline="none",I_a.zIndex=1,I_b.addEventListener("input",I_e._processInputting),I_b.addEventListener("mousemove",I_e._stopEvent),I_b.addEventListener("mousedown",I_e._stopEvent),I_b.addEventListener("touchmove",I_e._stopEvent),I_b.setFontFace=function(I_a){I_b.style.fontFamily=I_a},I_J.isConchApp||(I_b.setColor=function(I_a){I_b.style.color=I_a},I_b.setFontSize=function(I_a){I_b.style.fontSize=I_a+"px"})},I_e._processInputting=function(I_a){var I_b=laya.display.Input.inputElement.target;if(I_b){var I_c=laya.display.Input.inputElement.value;I_b._restrictPattern&&(I_c=I_c.replace(/\u2006|\x27/g,""),I_b._restrictPattern.test(I_c)&&(I_c=I_c.replace(I_b._restrictPattern,""),laya.display.Input.inputElement.value=I_c)),I_b._text=I_c,I_b.event("input")}},I_e._stopEvent=function(I_a){"touchmove"==I_a.type&&I_a.preventDefault(),I_a.stopPropagation&&I_a.stopPropagation()},I_e.TYPE_TEXT="text",I_e.TYPE_PASSWORD="password",I_e.TYPE_EMAIL="email",I_e.TYPE_URL="url",I_e.TYPE_NUMBER="number",I_e.TYPE_RANGE="range",I_e.TYPE_DATE="date",I_e.TYPE_MONTH="month",I_e.TYPE_WEEK="week",I_e.TYPE_TIME="time",I_e.TYPE_DATE_TIME="datetime",I_e.TYPE_DATE_TIME_LOCAL="datetime-local",I_e.TYPE_SEARCH="search",I_e.input=null,I_e.area=null,I_e.inputElement=null,I_e.inputContainer=null,I_e.confirmButton=null,I_e.promptStyleDOM=null,I_e.inputHeight=45,I_e.isInputting=!1,I_e.stageMatrix=null,I_i(I_e,["IOS_IFRAME",function(){return this.IOS_IFRAME=I_O.onIOS&&I_O.window.top!=I_O.window.self}]),I_e}(I_sa),I_ya=function(I_a){function I_c(I_a,I_b){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,I_c.__super.call(this),I_a&&this._init_(I_a,I_b)}I_k(I_c,"laya.resource.HTMLImage",I_ua);var I_b=I_c.prototype;return I_b._init_=function(I_a,I_b){this._src=I_a,this._source=new I_O.window.Image,I_b&&(I_b.onload&&(this.onload=I_b.onload),I_b.onerror&&(this.onerror=I_b.onerror),I_b.onCreate&&I_b.onCreate(this)),0!=I_a.indexOf("data:image")&&(this._source.crossOrigin=""),I_a&&(this._source.src=I_a)},I_b.recreateResource=function(){var I_a=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var I_b=this;this._source=new I_O.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(I_b._needReleaseAgain)return I_b._needReleaseAgain=!1,I_b._source.onload=null,void(I_b._source=null);I_b._source.onload=null,I_b.memorySize=I_a._w*I_a._h*4,I_b._recreateLock=!1,I_b.completeCreate()},this._source.src=this._src}},I_b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},I_b.onresize=function(){this._w=this._source.width,this._h=this._source.height},I_o(0,I_b,"onload",null,function(I_a){var I_b=this;this._onload=I_a,this._source&&(this._source.onload=null!=this._onload?function(){I_b.onresize(),I_b._onload()}:null)}),I_o(0,I_b,"onerror",null,function(I_a){var I_b=this;this._onerror=I_a,this._source&&(this._source.onerror=null!=this._onerror?function(){I_b._onerror()}:null)}),I_o(0,I_b,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(I_a){this._enableMerageInAtlas=I_a,I_J.isConchApp&&this._source&&(this._source.enableMerageInAtlas=I_a)}),I_c.create=function(I_a,I_b){return new I_c(I_a,I_b)},I_c}(),I_za=(function(I_f){function I_a(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,I_a.__super.call(this)}I_k(I_a,"laya.display.EffectAnimation",I_f);var I_b=I_a.prototype;I_b._onOtherBegin=function(I_a){I_a!=this&&this.stop()},I_b.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},I_b._onPlayAction=function(){this.play(0,!1)},I_b.play=function(I_a,I_b,I_c,I_d){void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=!0),void 0===I_c&&(I_c=""),void 0===I_d&&(I_d=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,I_a,I_b,I_c,I_d))},I_b._recordInitData=function(){if(this._aniKeys){var I_a,I_b,I_c=0;for(I_a=this._aniKeys.length,I_c=0;I_c<I_a;I_c++)I_b=this._aniKeys[I_c],this._initData[I_b]=this._target[I_b]}},I_b._displayToIndex=function(I_a){if(this._animationData){I_a<0&&(I_a=0),I_a>this._count&&(I_a=this._count);var I_b=this._animationData.nodes,I_c=0,I_d=I_b.length;for(I_d=1<I_d?1:I_d,I_c=0;I_c<I_d;I_c++)this._displayNodeToFrame(I_b[I_c],I_a)}},I_b._displayNodeToFrame=function(I_a,I_b,I_c){if(this._target){var I_d;I_d=this._target;var I_e,I_f,I_g,I_h,I_i=I_a.frames,I_j=I_a.keys,I_k=0,I_l=I_j.length;I_h=I_a.secondFrames;var I_m,I_n,I_o,I_p,I_s=0;for(I_k=0;I_k<I_l;I_k++)I_f=I_i[I_e=I_j[I_k]],I_g=-1==(I_s=I_h[I_e])?this._initData[I_e]:I_b<I_s?(I_o=(I_n=I_a.keyframes[I_e])[0]).tween?(null==(I_m=I_U[I_o.tweenMethod])&&(I_m=I_U.linearNone),I_p=I_n[1],I_m(I_b,this._initData[I_e],I_p.value-this._initData[I_e],I_p.index)):this._initData[I_e]:I_f.length>I_b?I_f[I_b]:I_f[I_f.length-1],I_d[I_e]=I_g}},I_b._calculateNodeKeyFrames=function(I_a){I_f.prototype._calculateNodeKeyFrames.call(this,I_a);var I_b,I_c,I_d,I_e=I_a.keyframes;I_a.target;for(I_b in I_d={},I_a.secondFrames=I_d,I_e)(I_c=I_e[I_b]).length<=1?I_d[I_b]=-1:I_d[I_b]=I_c[1].index},I_o(0,I_b,"target",function(){return this._target},function(I_a){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=I_a,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),I_o(0,I_b,"playEvent",null,function(I_a){(this._playEvents=I_a)&&this.addEvent()}),I_o(0,I_b,"effectData",null,function(I_a){var I_b;I_a&&((I_b=I_a.animations)&&I_b[0]&&(this._setUp({},I_b[0]),I_b[0].nodes&&I_b[0].nodes[0]&&(this._aniKeys=I_b[0].nodes[0].keys)))}),I_o(0,I_b,"effectClass",null,function(I_a){var I_b,I_c;(this._effectClass=I_R.getClass(I_a),this._effectClass)&&((I_b=this._effectClass.uiView)&&(I_c=I_b.animations)&&I_c[0]&&(this._setUp({},I_c[0]),I_c[0].nodes&&I_c[0].nodes[0]&&(this._aniKeys=I_c[0].nodes[0].keys)))}),I_a.EffectAnimationBegin="effectanimationbegin"}(I_wa),function(I_b){var I_D;function I_E(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,I_E.__super.call(this)}I_k(I_E,"laya.utils.GraphicAnimation",I_b);var I_a=I_E.prototype;return I_a._parseNodeList=function(I_a){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[I_a.compId]=I_a.props,I_a.compId&&this._nodeList.push(I_a.compId);var I_b=I_a.child;if(I_b){var I_c=0,I_d=I_b.length;for(I_c=0;I_c<I_d;I_c++)this._parseNodeList(I_b[I_c])}},I_a._calGraphicData=function(I_a){var I_b;if(this._setUp(null,I_a),this._createGraphicData(),this._nodeIDAniDic)for(I_b in this._nodeIDAniDic)this._nodeIDAniDic[I_b]=null},I_a._createGraphicData=function(){var I_a,I_b=[],I_c=0,I_d=this.count,I_e=this._animationNewFrames;for(I_e||(I_e=[]),I_c=0;I_c<I_d;I_c++)!I_e[I_c]&&I_a||(I_a=this._createFrameGraphic(I_c)),I_b.push(I_a);this._gList=I_b},I_a._createFrameGraphic=function(I_a){var I_b=I_F.createGraphics();return I_E._rootMatrix||(I_E._rootMatrix=new I_G),this._updateNodeGraphic(this._rootNode,I_a,I_E._rootMatrix,I_b),I_b},I_a._updateNodeGraphic=function(I_a,I_b,I_c,I_d,I_e){var I_f;void 0===I_e&&(I_e=1);var I_g,I_h,I_i,I_j=(I_f=this._nodeGDic[I_a.compId]=this._getNodeGraphicData(I_a.compId,I_b,this._nodeGDic[I_a.compId])).alpha*I_e;if(!(I_j<.01)&&(I_f.resultTransform||(I_f.resultTransform=I_G.create()),I_g=I_f.resultTransform,I_G.mul(I_f.transform,I_c,I_g),I_f.skin&&(I_h=this._getTextureByUrl(I_f.skin))&&(I_g._checkTransform()?(I_d.drawTexture(I_h,0,0,I_f.width,I_f.height,I_g,I_j),I_f.resultTransform=null):I_d.drawTexture(I_h,I_g.tx,I_g.ty,I_f.width,I_f.height,null,I_j)),I_i=I_a.child)){var I_k,I_l=0;for(I_k=I_i.length,I_l=0;I_l<I_k;I_l++)this._updateNodeGraphic(I_i[I_l],I_b,I_g,I_d,I_j)}},I_a._updateNoChilds=function(I_a,I_b){if(I_a.skin){var I_c=this._getTextureByUrl(I_a.skin);if(I_c){var I_d=I_a.transform;I_d._checkTransform();!I_d.bTransform?I_b.drawTexture(I_c,I_d.tx,I_d.ty,I_a.width,I_a.height,null,I_a.alpha):I_b.drawTexture(I_c,0,0,I_a.width,I_a.height,I_d.clone(),I_a.alpha)}}},I_a._updateNodeGraphic2=function(I_a,I_b,I_c){var I_d;if(I_d=this._nodeGDic[I_a.compId]=this._getNodeGraphicData(I_a.compId,I_b,this._nodeGDic[I_a.compId]),I_a.child){var I_e=I_d.transform;I_e._checkTransform();var I_f,I_g;I_g=(I_f=!I_e.bTransform)&&(0!=I_e.tx||0!=I_e.ty);var I_h,I_i,I_j;if((I_h=I_e.bTransform||1!=I_d.alpha)&&I_c.save(),1!=I_d.alpha&&I_c.alpha(I_d.alpha),I_f?I_g&&I_c.translate(I_e.tx,I_e.ty):I_c.transform(I_e.clone()),I_i=I_a.child,I_d.skin&&(I_j=this._getTextureByUrl(I_d.skin))&&I_c.drawTexture(I_j,0,0,I_d.width,I_d.height),I_i){var I_k,I_l=0;for(I_k=I_i.length,I_l=0;I_l<I_k;I_l++)this._updateNodeGraphic2(I_i[I_l],I_b,I_c)}I_h?I_c.restore():I_f?I_g&&I_c.translate(-I_e.tx,-I_e.ty):I_c.transform(I_e.clone().invert())}else this._updateNoChilds(I_d,I_c)},I_a._calculateNodeKeyFrames=function(I_a){I_b.prototype._calculateNodeKeyFrames.call(this,I_a),this._nodeIDAniDic[I_a.target]=I_a},I_a.getNodeDataByID=function(I_a){return this._nodeIDAniDic[I_a]},I_a._getParams=function(I_a,I_b,I_c,I_d){var I_e=I_E._temParam;I_e.length=I_b.length;var I_f=0,I_g=I_b.length;for(I_f=0;I_f<I_g;I_f++)I_e[I_f]=this._getObjVar(I_a,I_b[I_f][0],I_c,I_b[I_f][1],I_d);return I_e},I_a._getObjVar=function(I_a,I_b,I_c,I_d,I_e){if(I_a.hasOwnProperty(I_b)){var I_f=I_a[I_b];if(I_c>=I_f.length&&(I_c=I_f.length-1),null!=I_a[I_b][I_c])return I_a[I_b][I_c]}return I_e.hasOwnProperty(I_b)?I_e[I_b]:I_d},I_a._getNodeGraphicData=function(I_a,I_b,I_c){I_c||(I_c=I_D.create()),I_c.transform?I_c.transform.identity():I_c.transform=I_G.create();var I_d=this.getNodeDataByID(I_a);if(!I_d)return I_c;var I_e,I_f,I_g=I_d.frames,I_h=this._getParams(I_g,I_E._drawTextureCmd,I_b,this._nodeDefaultProps[I_a]),I_i=I_h[0],I_j=NaN,I_k=NaN,I_l=I_h[5],I_m=I_h[6],I_n=I_h[13],I_o=I_h[14],I_p=I_h[7],I_s=I_h[8],I_t=I_h[9],I_u=I_h[11],I_v=I_h[12];I_j=I_h[3],I_k=I_h[4],0!=I_j&&0!=I_k||(I_i=null),-1==I_j&&(I_j=0),-1==I_k&&(I_k=0),I_c.skin=I_i,I_c.width=I_j,I_c.height=I_k,I_i&&((I_e=this._getTextureByUrl(I_i))?(I_j||(I_j=I_e.sourceWidth),I_k||(I_k=I_e.sourceHeight)):console.warn("lost skin:",I_i,",you may load pics first")),I_c.alpha=I_h[10],I_f=I_c.transform,0!=I_n&&(I_l=I_n*I_j),0!=I_o&&(I_m=I_o*I_k),0==I_l&&0==I_m||I_f.translate(-I_l,-I_m);var I_w=null;if(I_t||1!==I_p||1!==I_s||I_u||I_v){(I_w=I_E._tempMt).identity(),I_w.bTransform=!0;var I_x=.0174532922222222*(I_t-I_u),I_y=.0174532922222222*(I_t+I_v),I_z=Math.cos(I_y),I_A=Math.sin(I_y),I_B=Math.sin(I_x),I_C=Math.cos(I_x);I_w.a=I_p*I_z,I_w.b=I_p*I_A,I_w.c=-I_s*I_B,I_w.d=I_s*I_C,I_w.tx=I_w.ty=0}return I_w&&(I_f=I_G.mul(I_f,I_w,I_f)),I_f.translate(I_h[1],I_h[2]),I_c},I_a._getTextureByUrl=function(I_a){return I_ha.getRes(I_a)},I_a.setAniData=function(I_a,I_b){if(I_a.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=I_a,this._parseNodeList(I_a);var I_c,I_d={},I_e=[],I_f=I_a.animations,I_g=0,I_h=I_f.length;for(I_g=0;I_g<I_h;I_g++)if(I_c=I_f[I_g],this._labels=null,(!I_b||I_b==I_c.name)&&I_c){try{this._calGraphicData(I_c)}catch(I_a){console.warn("parse animation fail:"+I_c.name+",empty animation created"),this._gList=[]}var I_i={};I_i.interval=1e3/I_c.frameRate,I_i.frames=this._gList,I_i.labels=this._labels,I_i.name=I_c.name,I_e.push(I_i),I_d[I_c.name]=I_i}this.animationList=I_e,this.animationDic=I_d}I_E._temParam.length=0},I_a.parseByData=function(I_a){var I_b,I_c;I_b=I_a.nodeRoot,I_c=I_a.aniO,delete I_a.nodeRoot,delete I_a.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=I_b,this._parseNodeList(I_b),this._labels=null;try{this._calGraphicData(I_c)}catch(I_a){console.warn("parse animation fail:"+I_c.name+",empty animation created"),this._gList=[]}var I_d=I_a;return I_d.interval=1e3/I_c.frameRate,I_d.frames=this._gList,I_d.labels=this._labels,I_d.name=I_c.name,I_d},I_a.setUpAniData=function(I_a){if(I_a.animations){var I_b,I_c={},I_d=[],I_e=I_a.animations,I_f=0,I_g=I_e.length;for(I_f=0;I_f<I_g;I_f++)if(I_b=I_e[I_f]){var I_h={};I_h.name=I_b.name,I_h.aniO=I_b,I_h.nodeRoot=I_a,I_d.push(I_h),I_c[I_b.name]=I_h}this.animationList=I_d,this.animationDic=I_c}},I_a._clear=function(){var I_a,I_b;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(I_a in this._nodeGDic)(I_b=this._nodeGDic[I_a])&&I_b.recover();this._nodeGDic=null},I_E.parseAnimationByData=function(I_a){var I_b;return I_E._I||(I_E._I=new I_E),I_b=I_E._I.parseByData(I_a),I_E._I._clear(),I_b},I_E.parseAnimationData=function(I_a){var I_b;return I_E._I||(I_E._I=new I_E),I_E._I.setUpAniData(I_a),(I_b={}).animationList=I_E._I.animationList,I_b.animationDic=I_E._I.animationDic,I_E._I._clear(),I_b},I_E._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],I_E._temParam=[],I_E._I=null,I_E._rootMatrix=null,I_i(I_E,["_tempMt",function(){return this._tempMt=new I_G}]),I_E.__init$=function(){I_D=function(){function I_a(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return I_k(I_a,""),I_a.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),I_W.recover("GraphicNode",this)},I_a.create=function(){return I_W.getItemByClass("GraphicNode",I_a)},I_a}()},I_E}(I_wa));I_z.__init([I_j,I_ia,I_J,I_O,I_Y,I_C,I_a,I_za])}(window,document,Laya),function(I_a,I_b,I_c){I_c.un,I_c.uns,I_c.static;var I_d=I_c.class;I_c.getset,I_c.__newvec;new(function(){function I_a(){}return I_d(I_a,"LayaMain"),I_a}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(I_a,I_b){"use strict";for(var I_c in Object.defineProperty(I_b,"__esModule",{value:!0}),Laya){var I_d=Laya[I_c];I_d&&I_d.__isclass&&(I_b[I_c]=I_d)}}),function(I_a,I_b,I_y){I_y.un,I_y.uns;var I_g=I_y.static,I_m=I_y.class,I_d=I_y.getset,I_f=I_y.__newvec,I_k=laya.maths.Arith,I_l=laya.maths.Bezier,I_c=laya.resource.Bitmap,I_n=laya.utils.Browser,I_i=laya.utils.Byte,I_o=laya.utils.Color,I_z=(laya.filters.ColorFilter,I_y.Config),I_e=laya.resource.Context,I_A=(laya.events.Event,laya.filters.Filter),I_h=laya.display.Graphics,I_j=laya.resource.HTMLCanvas,I_p=(laya.utils.HTMLChar,laya.resource.HTMLImage),I_s=laya.resource.HTMLSubImage,I_B=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),I_C=laya.maths.Point,I_D=laya.maths.Rectangle,I_t=laya.renders.Render,I_u=(laya.renders.RenderContext,laya.renders.RenderSprite),I_v=laya.resource.Resource,I_w=laya.resource.ResourceManager,I_x=laya.utils.RunDriver,I_E=laya.display.Sprite,I_F=laya.display.Stage,I_G=laya.utils.Stat,I_H=laya.utils.StringKey,I_I=(laya.display.css.Style,laya.system.System),I_J=laya.display.Text,I_K=laya.resource.Texture,I_L=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),I_M=laya.utils.VectorGraphManager;laya.utils.WordText;I_y.interface("laya.webgl.shapes.IShape"),I_y.interface("laya.webgl.submit.ISubmit"),I_y.interface("laya.webgl.text.ICharSegment"),I_y.interface("laya.webgl.canvas.save.ISaveData"),I_y.interface("laya.webgl.resource.IMergeAtlasBitmap"),I_y.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var I_N=function(){function I_a(){}I_m(I_a,"laya.filters.webgl.FilterActionGL");var I_b=I_a.prototype;return I_y.imps(I_b,{"laya.filters.IFilterActionGL":!0}),I_b.setValue=function(I_a){},I_b.setValueMix=function(I_a){},I_b.apply3d=function(I_a,I_b,I_c,I_d,I_e){return null},I_b.apply=function(I_a){return null},I_d(0,I_b,"typeMix",function(){return 0}),I_a}(),I_O=function(){function I_a(){}return I_m(I_a,"laya.webgl.shader.ShaderValue"),I_a}(),I_P=function(){var I_d,I_e;function I_a(I_a,I_b,I_c){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new I_e,void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),this._cells=null,this._rowInfo=null,this._init(I_a,I_b),this._atlasID=I_c}I_m(I_a,"laya.webgl.atlas.AtlasGrid");var I_b=I_a.prototype;return I_b.getAltasID=function(){return this._atlasID},I_b.setAltasID=function(I_a){0<=I_a&&(this._atlasID=I_a)},I_b.addTex=function(I_a,I_b,I_c){var I_d=this._get(I_b,I_c);return 0==I_d.ret||(this._fill(I_d.x,I_d.y,I_b,I_c,I_a),this._texCount++),I_d},I_b._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},I_b._init=function(I_a,I_b){if(this._width=I_a,this._height=I_b,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=I_f(this._height);for(var I_c=0;I_c<this._height;I_c++)this._rowInfo[I_c]=new I_d;return this._clear(),!0},I_b._get=function(I_a,I_b){var I_c=new I_R;if(I_a>=this._failSize.width&&I_b>=this._failSize.height)return I_c;for(var I_d=-1,I_e=-1,I_f=this._width,I_g=this._height,I_h=this._cells,I_i=0;I_i<I_g;I_i++)if(!(this._rowInfo[I_i].spaceCount<I_a))for(var I_j=0;I_j<I_f;){var I_k=3*(I_i*I_f+I_j);if(0!=I_h[I_k]||I_h[1+I_k]<I_a||I_h[2+I_k]<I_b)I_j+=I_h[1+I_k];else{I_d=I_j,I_e=I_i;for(var I_l=0;I_l<I_a;I_l++)if(I_h[3*I_l+I_k+2]<I_b){I_d=-1;break}if(!(I_d<0))return I_c.ret=!0,I_c.x=I_d,I_c.y=I_e,I_c;I_j+=I_h[1+I_k]}}return I_c},I_b._fill=function(I_a,I_b,I_c,I_d,I_e){var I_f=this._width,I_g=this._height;this._check(I_a+I_c<=I_f&&I_b+I_d<=I_g);for(var I_h=I_b;I_h<I_d+I_b;++I_h){this._check(this._rowInfo[I_h].spaceCount>=I_c),this._rowInfo[I_h].spaceCount-=I_c;for(var I_i=0;I_i<I_c;I_i++){var I_j=3*(I_a+I_h*I_f+I_i);this._check(0==this._cells[I_j]),this._cells[I_j]=I_e,this._cells[1+I_j]=I_c,this._cells[2+I_j]=I_d}}if(0<I_a)for(I_h=0;I_h<I_d;++I_h){var I_k=0;for(I_i=I_a-1;0<=I_i&&0==this._cells[3*((I_b+I_h)*I_f+I_i)];--I_i,++I_k);for(I_i=I_k;0<I_i;--I_i)this._cells[3*((I_b+I_h)*I_f+I_a-I_i)+1]=I_i,this._check(0<I_i)}if(0<I_b)for(I_i=I_a;I_i<I_a+I_c;++I_i){for(I_k=0,I_h=I_b-1;0<=I_h&&0==this._cells[3*(I_i+I_h*I_f)];--I_h,I_k++);for(I_h=I_k;0<I_h;--I_h)this._cells[3*(I_i+(I_b-I_h)*I_f)+2]=I_h,this._check(0<I_h)}},I_b._check=function(I_a){0==I_a&&console.log("xtexMerger 错误啦")},I_b._clear=function(){for(var I_a=this._texCount=0;I_a<this._height;I_a++)this._rowInfo[I_a].spaceCount=this._width;for(var I_b=0;I_b<this._height;I_b++)for(var I_c=0;I_c<this._width;I_c++){var I_d=3*(I_b*this._width+I_c);this._cells[I_d]=0,this._cells[1+I_d]=this._width-I_c,this._cells[2+I_d]=this._width-I_b}this._failSize.width=this._width+1,this._failSize.height=this._height+1},I_a.__init$=function(){I_d=function(){function I_a(){this.spaceCount=0}return I_m(I_a,""),I_a}(),I_e=function(){function I_a(){this.width=0,this.height=0}return I_m(I_a,""),I_a}()},I_a}(),I_Q=function(){function I_t(I_a,I_b,I_c,I_d){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=I_a,this._height=I_b,this._gridSize=I_c,this._maxAtlaserCount=I_d,this._gridNumX=I_a/I_c,this._gridNumY=I_b/I_c,this._curAtlasIndex=0,this._atlaserArray=[]}I_m(I_t,"laya.webgl.atlas.AtlasResourceManager");var I_a=I_t.prototype;return I_a.setAtlasParam=function(I_a,I_b,I_c,I_d){if(1==this._setAtlasParam)return I_t._sid_=0,this._width=I_a,this._height=I_b,this._gridSize=I_c,this._maxAtlaserCount=I_d,this._gridNumX=I_a/I_c,this._gridNumY=I_b/I_c,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},I_a.pushData=function(I_a){var I_b,I_c=I_a.bitmap,I_d=-1,I_e=null,I_f=0,I_g=0;for(I_f=0,I_b=this._atlaserArray.length;I_f<I_b&&(I_g=(this._curAtlasIndex+I_f)%I_b,-1==(I_d=(I_e=this._atlaserArray[I_g]).findBitmapIsExist(I_c)));I_f++);if(-1!=I_d){var I_h=I_e.InAtlasWebGLImagesOffsetValue[I_d];return I_o=I_h[0],I_p=I_h[1],I_e.addToAtlas(I_a,I_o,I_p),!0}this._setAtlasParam=!1;for(var I_i=Math.ceil((I_a.bitmap.width+2)/this._gridSize),I_j=Math.ceil((I_a.bitmap.height+2)/this._gridSize),I_k=!1,I_l=0;I_l<2;I_l++){var I_m=this._maxAtlaserCount;for(I_f=0;I_f<I_m;I_f++){I_g=(this._curAtlasIndex+I_f)%I_m,this._atlaserArray.length-1>=I_g||this._atlaserArray.push(new I_Da(this._gridNumX,this._gridNumY,this._width,this._height,I_t._sid_++));var I_n=this._atlaserArray[I_g],I_o=0,I_p=0,I_s=I_n.addTex(1,I_i,I_j);if(I_s.ret){I_o=I_s.x*this._gridSize+1,I_p=I_s.y*this._gridSize+1,I_c.lock=!0,I_n.addToAtlasTexture(I_c,I_o,I_p),I_n.addToAtlas(I_a,I_o,I_p),I_k=!0,this._curAtlasIndex=I_g;break}}if(I_k)break;this._atlaserArray.push(new I_Da(this._gridNumX,this._gridNumY,this._width,this._height,I_t._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return I_k||console.log(">>>AtlasManager pushData error"),I_k},I_a.addToAtlas=function(I_a){laya.webgl.atlas.AtlasResourceManager.instance.pushData(I_a)},I_a.garbageCollection=function(){if(!0===this._needGC){for(var I_a=this._atlaserArray.length-this._maxAtlaserCount,I_b=0;I_b<I_a;I_b++)this._atlaserArray[I_b].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+I_a),this._atlaserArray.splice(0,I_a),this._needGC=!1}return!0},I_a.freeAll=function(){for(var I_a=0,I_b=this._atlaserArray.length;I_a<I_b;I_a++)this._atlaserArray[I_a].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},I_a.getAtlaserCount=function(){return this._atlaserArray.length},I_a.getAtlaserByIndex=function(I_a){return this._atlaserArray[I_a]},I_d(1,I_t,"instance",function(){return I_t._Instance||(I_t._Instance=new I_t(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),I_t._Instance}),I_d(1,I_t,"enabled",function(){return I_z.atlasEnable}),I_d(1,I_t,"atlasLimitWidth",function(){return I_t._atlasLimitWidth},function(I_a){I_t._atlasLimitWidth=I_a}),I_d(1,I_t,"atlasLimitHeight",function(){return I_t._atlasLimitHeight},function(I_a){I_t._atlasLimitHeight=I_a}),I_t._enable=function(){I_z.atlasEnable=!0},I_t._disable=function(){I_z.atlasEnable=!1},I_t.__init__=function(){I_t.atlasTextureWidth=2048,I_t.atlasTextureHeight=2048,I_t.maxTextureCount=6,I_t.atlasLimitWidth=512,I_t.atlasLimitHeight=512},I_t._atlasLimitWidth=0,I_t._atlasLimitHeight=0,I_t.gridSize=16,I_t.atlasTextureWidth=0,I_t.atlasTextureHeight=0,I_t.maxTextureCount=0,I_t._atlasRestore=0,I_t.BOARDER_TYPE_NO=0,I_t.BOARDER_TYPE_RIGHT=1,I_t.BOARDER_TYPE_LEFT=2,I_t.BOARDER_TYPE_BOTTOM=4,I_t.BOARDER_TYPE_TOP=8,I_t.BOARDER_TYPE_ALL=15,I_t._sid_=0,I_t._Instance=null,I_t}(),I_R=function(){function I_a(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return I_m(I_a,"laya.webgl.atlas.MergeFillInfo"),I_a}(),I_S=function(){function I_b(){}return I_m(I_b,"laya.webgl.canvas.BlendMode"),I_b._init_=function(I_a){I_b.fns=[I_b.BlendNormal,I_b.BlendAdd,I_b.BlendMultiply,I_b.BlendScreen,I_b.BlendOverlay,I_b.BlendLight,I_b.BlendMask,I_b.BlendDestinationOut],I_b.targetFns=[I_b.BlendNormalTarget,I_b.BlendAddTarget,I_b.BlendMultiplyTarget,I_b.BlendScreenTarget,I_b.BlendOverlayTarget,I_b.BlendLightTarget,I_b.BlendMask,I_b.BlendDestinationOut]},I_b.BlendNormal=function(I_a){I_a.blendFunc(1,771)},I_b.BlendAdd=function(I_a){I_a.blendFunc(1,772)},I_b.BlendMultiply=function(I_a){I_a.blendFunc(774,771)},I_b.BlendScreen=function(I_a){I_a.blendFunc(1,1)},I_b.BlendOverlay=function(I_a){I_a.blendFunc(1,769)},I_b.BlendLight=function(I_a){I_a.blendFunc(1,1)},I_b.BlendNormalTarget=function(I_a){I_a.blendFunc(1,771)},I_b.BlendAddTarget=function(I_a){I_a.blendFunc(1,772)},I_b.BlendMultiplyTarget=function(I_a){I_a.blendFunc(774,771)},I_b.BlendScreenTarget=function(I_a){I_a.blendFunc(1,1)},I_b.BlendOverlayTarget=function(I_a){I_a.blendFunc(1,769)},I_b.BlendLightTarget=function(I_a){I_a.blendFunc(1,1)},I_b.BlendMask=function(I_a){I_a.blendFunc(0,770)},I_b.BlendDestinationOut=function(I_a){I_a.blendFunc(0,0)},I_b.activeBlendFunction=null,I_b.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],I_b.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},I_b.NORMAL="normal",I_b.ADD="add",I_b.MULTIPLY="multiply",I_b.SCREEN="screen",I_b.LIGHT="light",I_b.OVERLAY="overlay",I_b.DESTINATIONOUT="destination-out",I_b.fns=[],I_b.targetFns=[],I_b}(),I_T=function(){function I_c(I_a){this._color=I_o.create("black"),this.setValue(I_a)}I_m(I_c,"laya.webgl.canvas.DrawStyle");var I_a=I_c.prototype;return I_a.setValue=function(I_a){if(I_a){if("string"==typeof I_a)return void(this._color=I_o.create(I_a));if(I_a instanceof laya.utils.Color)return void(this._color=I_a)}},I_a.reset=function(){this._color=I_o.create("black")},I_a.equal=function(I_a){return"string"==typeof I_a?this._color.strColor===I_a:I_a instanceof laya.utils.Color&&this._color.numColor===I_a.numColor},I_a.toColorStr=function(){return this._color.strColor},I_c.create=function(I_a){var I_b;if(I_a&&("string"==typeof I_a?I_b=I_o.create(I_a):I_a instanceof laya.utils.Color&&(I_b=I_a),I_b))return I_b._drawStyle||(I_b._drawStyle=new I_c(I_a));return laya.webgl.canvas.DrawStyle.DEFAULT},I_g(I_c,["DEFAULT",function(){return this.DEFAULT=new I_c("#000000")}]),I_c}(),I_U=function(){function I_a(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];I_wa.mainContext;this.ib=I_qa.create(35048),this.vb=I_ra.create(5)}I_m(I_a,"laya.webgl.canvas.Path");var I_b=I_a.prototype;return I_b.addPoint=function(I_a,I_b){this.tempArray.push(I_a,I_b)},I_b.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},I_b.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},I_b.polygon=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g;return this.geomatrys.push(this._curGeomatry=I_g=new I_Ha(I_a,I_b,I_c,I_d,I_e,I_f)),I_d||(I_g.fill=!1),null==I_f&&(I_g.borderWidth=0),I_g},I_b.setGeomtry=function(I_a){this.geomatrys.push(this._curGeomatry=I_a)},I_b.drawLine=function(I_a,I_b,I_c,I_d,I_e){var I_f;return this.closePath?this.geomatrys.push(this._curGeomatry=I_f=new I_Ga(I_a,I_b,I_c,I_d,I_e)):this.geomatrys.push(this._curGeomatry=I_f=new I_Fa(I_a,I_b,I_c,I_d,I_e)),I_f.fill=!1,I_f},I_b.update=function(){var I_a=this.ib._byteLength,I_b=this.geomatrys.length;this.offset=I_a;for(var I_c=this.geoStart;I_c<I_b;I_c++)this.geomatrys[I_c].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=I_b,this.count=(this.ib._byteLength-I_a)/I_pa.BYTES_PIDX},I_b.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},I_b.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},I_a}(),I_V=function(){function I_h(){}I_m(I_h,"laya.webgl.canvas.save.SaveBase");var I_a=I_h.prototype;return I_y.imps(I_a,{"laya.webgl.canvas.save.ISaveData":!0}),I_a.isSaveMark=function(){return!1},I_a.restore=function(I_a){this._dataObj[this._valueName]=this._value,(I_h._cache[I_h._cache._length++]=this)._newSubmit&&(I_a._curSubmit=I_fa.RENDERBASE,I_a._renderKey=0)},I_h._createArray=function(){var I_a=[];return I_a._length=0,I_a},I_h._init=function(){var I_a=I_h._namemap={};return I_a[1]="ALPHA",I_a[2]="fillStyle",I_a[8]="font",I_a[256]="lineWidth",I_a[512]="strokeStyle",I_a[8192]="_mergeID",I_a[1024]=I_a[2048]=I_a[4096]=[],I_a[16384]="textBaseline",I_a[32768]="textAlign",I_a[65536]="_nBlendType",I_a[1048576]="shader",I_a[2097152]="filters",I_a},I_h.save=function(I_a,I_b,I_c,I_d){if((I_a._saveMark._saveuse&I_b)!==I_b){I_a._saveMark._saveuse|=I_b;var I_e=I_h._cache,I_f=0<I_e._length?I_e[--I_e._length]:new I_h;I_f._value=I_c[I_f._valueName=I_h._namemap[I_b]],I_f._dataObj=I_c,I_f._newSubmit=I_d;var I_g=I_a._save;I_g[I_g._length++]=I_f}},I_h._cache=laya.webgl.canvas.save.SaveBase._createArray(),I_h._namemap=I_h._init(),I_h}(),I_W=function(){function I_f(){this._clipRect=new I_D}I_m(I_f,"laya.webgl.canvas.save.SaveClipRect");var I_a=I_f.prototype;return I_y.imps(I_a,{"laya.webgl.canvas.save.ISaveData":!0}),I_a.isSaveMark=function(){return!1},I_a.restore=function(I_a){I_a._clipRect=this._clipSaveRect,(I_f._cache[I_f._cache._length++]=this)._submitScissor.submitLength=I_a._submits._length-this._submitScissor.submitIndex,I_a._curSubmit=I_fa.RENDERBASE,I_a._renderKey=0},I_f.save=function(I_a,I_b){if(131072!=(131072&I_a._saveMark._saveuse)){I_a._saveMark._saveuse|=131072;var I_c=I_f._cache,I_d=0<I_c._length?I_c[--I_c._length]:new I_f;I_d._clipSaveRect=I_a._clipRect,I_a._clipRect=I_d._clipRect.copyFrom(I_a._clipRect),I_d._submitScissor=I_b;var I_e=I_a._save;I_e[I_e._length++]=I_d}},I_g(I_f,["_cache",function(){return this._cache=I_V._createArray()}]),I_f}(),I_X=function(){function I_n(){this._contextX=0,this._contextY=0,this._clipRect=new I_D,this._rect=new I_D,this._matrix=new I_B}I_m(I_n,"laya.webgl.canvas.save.SaveClipRectStencil");var I_a=I_n.prototype;return I_y.imps(I_a,{"laya.webgl.canvas.save.ISaveData":!0}),I_a.isSaveMark=function(){return!1},I_a.restore=function(I_a){I_ka.restore(I_a,this._rect,this._saveMatrix,this._contextX,this._contextY),I_a._clipRect=this._clipSaveRect,I_a._curMat=this._saveMatrix,I_a._x=this._contextX,I_a._y=this._contextY,I_n._cache[I_n._cache._length++]=this,I_a._curSubmit=I_fa.RENDERBASE},I_n.save=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){if(262144!=(262144&I_a._saveMark._saveuse)){I_a._saveMark._saveuse|=262144;var I_k=I_n._cache,I_l=0<I_k._length?I_k[--I_k._length]:new I_n;I_l._clipSaveRect=I_a._clipRect,I_l._clipRect.setTo(I_g,I_h,I_i,I_j),I_a._clipRect=I_l._clipRect,I_l._rect.x=I_c,I_l._rect.y=I_d,I_l._rect.width=I_e,I_l._rect.height=I_f,I_l._contextX=I_a._x,I_l._contextY=I_a._y,I_l._saveMatrix=I_a._curMat,I_a._curMat.copyTo(I_l._matrix),I_a._curMat=I_l._matrix,I_l._submitStencil=I_b;var I_m=I_a._save;I_m[I_m._length++]=I_l}},I_g(I_n,["_cache",function(){return this._cache=I_V._createArray()}]),I_n}(),I_Y=function(){function I_d(){this._saveuse=0}I_m(I_d,"laya.webgl.canvas.save.SaveMark");var I_a=I_d.prototype;return I_y.imps(I_a,{"laya.webgl.canvas.save.ISaveData":!0}),I_a.isSaveMark=function(){return!0},I_a.restore=function(I_a){I_a._saveMark=this._preSaveMark,I_d._no[I_d._no._length++]=this},I_d.Create=function(I_a){var I_b=I_d._no,I_c=0<I_b._length?I_b[--I_b._length]:new I_d;return I_c._saveuse=0,I_c._preSaveMark=I_a._saveMark,I_a._saveMark=I_c},I_g(I_d,["_no",function(){return this._no=I_V._createArray()}]),I_d}(),I_Z=function(){function I_f(){this._matrix=new I_B}I_m(I_f,"laya.webgl.canvas.save.SaveTransform");var I_a=I_f.prototype;return I_y.imps(I_a,{"laya.webgl.canvas.save.ISaveData":!0}),I_a.isSaveMark=function(){return!1},I_a.restore=function(I_a){I_a._curMat=this._savematrix,I_f._no[I_f._no._length++]=this},I_f.save=function(I_a){var I_b=I_a._saveMark;if(2048!=(2048&I_b._saveuse)){I_b._saveuse|=2048;var I_c=I_f._no,I_d=0<I_c._length?I_c[--I_c._length]:new I_f;I_d._savematrix=I_a._curMat,I_a._curMat=I_a._curMat.copyTo(I_d._matrix);var I_e=I_a._save;I_e[I_e._length++]=I_d}},I_g(I_f,["_no",function(){return this._no=I_V._createArray()}]),I_f}(),I_$=function(){function I_e(){}I_m(I_e,"laya.webgl.canvas.save.SaveTranslate");var I_a=I_e.prototype;return I_y.imps(I_a,{"laya.webgl.canvas.save.ISaveData":!0}),I_a.isSaveMark=function(){return!1},I_a.restore=function(I_a){I_a._curMat;I_a._x=this._x,I_a._y=this._y,I_e._no[I_e._no._length++]=this},I_e.save=function(I_a){var I_b=I_e._no,I_c=0<I_b._length?I_b[--I_b._length]:new I_e;I_c._x=I_a._x,I_c._y=I_a._y;var I_d=I_a._save;I_d[I_d._length++]=I_c},I_g(I_e,["_no",function(){return this._no=I_V._createArray()}]),I_e}(),I__=function(){function I_a(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new I_D}I_m(I_a,"laya.webgl.resource.RenderTargetMAX");var I_b=I_a.prototype;return I_b.setSP=function(I_a){this._sp=I_a},I_b.size=function(I_a,I_b){var I_c=this;this._width!==I_a||this._height!==I_b?(this.repaint=!0,this._width=I_a,this._height=I_b,this.target?this.target.size(I_a,I_b):this.target=I_Ma.create(I_a,I_b),this.target.hasListener("recovered")||this.target.on("recovered",this,function(I_a){I_y.timer.callLater(I_c._sp,I_c._sp.repaint)})):this.target.size(I_a,I_b)},I_b._flushToTarget=function(I_a,I_b){if(!I_b._destroy){var I_c=I_ua.worldScissorTest,I_d=I_ua.worldClipRect;I_ua.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,I_ua.worldScissorTest=!1,I_wa.mainContext.disable(3089);var I_e=I_ua.worldAlpha,I_f=I_ua.worldMatrix4,I_g=I_ua.worldMatrix,I_h=I_ua.worldFilters,I_i=I_ua.worldShaderDefines;if(I_ua.worldMatrix=I_B.EMPTY,I_ua.restoreTempArray(),I_ua.worldMatrix4=I_ua.TEMPMAT4_ARRAY,I_ua.worldAlpha=1,I_ua.worldFilters=null,I_ua.worldShaderDefines=null,I_La.activeShader=null,I_b.start(),I_z.showCanvasMark?I_b.clear(0,1,0,.3):I_b.clear(0,0,0,0),I_a.flush(),I_b.end(),I_La.activeShader=null,I_ua.worldAlpha=I_e,I_ua.worldMatrix4=I_f,I_ua.worldMatrix=I_g,I_ua.worldFilters=I_h,I_ua.worldShaderDefines=I_i,I_ua.worldScissorTest=I_c){var I_j=I_ua.height-I_d.y-I_d.height;I_wa.mainContext.scissor(I_d.x,I_j,I_d.width,I_d.height),I_wa.mainContext.enable(3089)}I_ua.worldClipRect=I_d}},I_b.flush=function(I_a){this.repaint&&(this._flushToTarget(I_a,this.target),this.repaint=!1)},I_b.drawTo=function(I_a,I_b,I_c,I_d,I_e){I_a.drawTexture(this.target.getTexture(),I_b,I_c,I_d,I_e,0,0)},I_b.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},I_a}(),I_q=function(){function I_a(){this.ALPHA=1,this.shaderType=0,this.defines=new I_Ea}return I_m(I_a,"laya.webgl.shader.d2.Shader2D"),I_a.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},I_a.__init__=function(){var I_a,I_b;I_Ya.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),I_Ya.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),I_Ya.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),I_Ya.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),I_Ya.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),I_Ya.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),I_Ya.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),I_Ya.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),I_a="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",I_b='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',I_Ya.preCompile2D(0,1,I_a,I_b,null),I_a="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",I_b='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',I_Ya.preCompile2D(0,2,I_a,I_b,null),I_a="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",I_b="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",I_Ya.preCompile2D(0,4,I_a,I_b,null),I_a="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",I_b='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',I_Ya.preCompile2D(0,256,I_a,I_b,null),I_a="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",I_b="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",I_Ya.preCompile2D(0,512,I_a,I_b,null)},I_a}(),I_r=function(){function I_b(I_a,I_b,I_c){this._value=0,this._name2int=I_a,this._int2name=I_b,this._int2nameMap=I_c}I_m(I_b,"laya.webgl.shader.ShaderDefines");var I_a=I_b.prototype;return I_a.add=function(I_a){return"string"==typeof I_a&&(I_a=this._name2int[I_a]),this._value|=I_a,this._value},I_a.addInt=function(I_a){return this._value|=I_a,this._value},I_a.remove=function(I_a){return"string"==typeof I_a&&(I_a=this._name2int[I_a]),this._value&=~I_a,this._value},I_a.isDefine=function(I_a){return(this._value&I_a)===I_a},I_a.getValue=function(){return this._value},I_a.setValue=function(I_a){this._value=I_a},I_a.toNameDic=function(){var I_a=this._int2nameMap[this._value];return I_a||I_b._toText(this._value,this._int2name,this._int2nameMap)},I_b._reg=function(I_a,I_b,I_c,I_d){I_d[I_c[I_a]=I_b]=I_a},I_b._toText=function(I_a,I_b,I_c){var I_d=I_c[I_a];if(I_d)return I_d;for(var I_e={},I_f=1,I_g=0;I_g<32&&!(I_a<(I_f=1<<I_g));I_g++)if(I_a&I_f){var I_h=I_b[I_f];I_h&&(I_e[I_h]="")}return I_c[I_a]=I_e},I_b._toInt=function(I_a,I_b){for(var I_c=I_a.split("."),I_d=0,I_e=0,I_f=I_c.length;I_e<I_f;I_e++){var I_g=I_b[I_c[I_e]];if(!I_g)throw new Error("Defines to int err:"+I_a+"/"+I_c[I_e]);I_d|=I_g}return I_d},I_b}(),I_aa=function(){function I_g(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new I_B}I_m(I_g,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var I_a=I_g.prototype;return I_a.init=function(I_a,I_b,I_c){if(I_b)this._vs=I_b;else{this._vs=[];var I_d=I_a.width,I_e=I_a.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(I_d,0,1,0,1,1,1,1),this._vs.push(I_d,I_e,1,1,1,1,1,1),this._vs.push(0,I_e,0,1,1,1,1,1)}I_c?this._ps=I_c:(I_g._defaultPS||(I_g._defaultPS=[]).push(0,1,3,3,1,2),this._ps=I_g._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=I_a},I_a.init2=function(I_a,I_b,I_c,I_d,I_e){this.transform&&(this.transform=null),I_c?this._ps=I_c:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=I_d,this._uvs=I_e,this.mEleNum=this._ps.length,this.mTexture=I_a,(I_t.isConchNode||I_t.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},I_a._initMyData=function(){var I_a=0,I_b=0,I_c=4*this._verticles.length;this._vs=I_g._tempVS;var I_d=!1;if(I_t.isConchNode||I_t.isConchApp?(this._vs.length=I_c,I_d=!0):this._vs.length<I_c&&(this._vs.length=I_c,I_d=!0),I_g._tVSLen=I_c,I_d)for(;I_a<I_c;)this._vs[I_a]=this._verticles[I_b],this._vs[I_a+1]=this._verticles[I_b+1],this._vs[I_a+2]=this._uvs[I_b],this._vs[I_a+3]=this._uvs[I_b+1],this._vs[I_a+4]=1,this._vs[I_a+5]=1,this._vs[I_a+6]=1,this._vs[I_a+7]=1,I_a+=8,I_b+=2;else for(;I_a<I_c;)this._vs[I_a]=this._verticles[I_b],this._vs[I_a+1]=this._verticles[I_b+1],this._vs[I_a+2]=this._uvs[I_b],this._vs[I_a+3]=this._uvs[I_b+1],I_a+=8,I_b+=2},I_a.getData2=function(I_a,I_b,I_c){var I_d;this.mVBBuffer=I_a,this.mIBBuffer=I_b,this._initMyData(),I_a.appendEx2(this._vs,Float32Array,I_g._tVSLen,4),this._indexStart=I_b._byteLength,(I_d=I_g._tempIB).length<this._ps.length&&(I_d.length=this._ps.length);for(var I_e=0,I_f=this._ps.length;I_e<I_f;I_e++)I_d[I_e]=this._ps[I_e]+I_c;I_b.appendEx2(I_d,Uint16Array,this._ps.length,2)},I_a.getData=function(I_a,I_b,I_c){if(this.mVBBuffer=I_a,this.mIBBuffer=I_b,I_a.append(this.mVBData),this._indexStart=I_b._byteLength,this.mIBData.start!=I_c){for(var I_d=0,I_e=this._ps.length;I_d<I_e;I_d++)this.mIBData[I_d]=this._ps[I_d]+I_c;this.mIBData.start=I_c}I_b.append(this.mIBData)},I_a.render=function(I_a,I_b,I_c){if(I_t.isWebGL&&this.mTexture){I_a._renderKey=0,I_a._shader2D.glTexture=null,I_ba.getInstance().addSkinMesh(this);var I_d=I_fa.createShape(I_a,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,I_Aa.create(512,0));this.transform||(this.transform=I_B.EMPTY),this.transform.translate(I_b,I_c),I_B.mul(this.transform,I_a._curMat,this._tempMatrix),this.transform.translate(-I_b,-I_c);var I_e=I_d.shaderValue,I_f=I_e.u_mmat2||I_ua.getMatrArray();I_ua.mat2MatArray(this._tempMatrix,I_f),I_e.textureHost=this.mTexture,I_e.offsetX=0,I_e.offsetY=0,I_e.u_mmat2=I_f,I_e.ALPHA=I_a._shader2D.ALPHA,I_a._submits[I_a._submits._length++]=I_d}else I_t.isConchApp&&this.mTexture&&(this.transform||(this.transform=I_B.EMPTY),I_a.setSkinMesh&&I_a.setSkinMesh(I_b,I_c,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},I_g._tempVS=[],I_g._tempIB=[],I_g._defaultPS=null,I_g._tVSLen=0,I_g}(),I_ba=function(){function I_a(){this.ib=null,this.vb=null;I_wa.mainContext;this.ib=I_qa.create(35048),this.vb=I_ra.create(8)}I_m(I_a,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var I_b=I_a.prototype;return I_b.addSkinMesh=function(I_a){I_a.getData2(this.vb,this.ib,this.vb._byteLength/32)},I_b.reset=function(){this.vb.clear(),this.ib.clear()},I_a.getInstance=function(){return I_a.instance=I_a.instance||new I_a},I_a.instance=null,I_a}(),I_ca=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===I_i&&(I_i=0),this.x=I_a,this.y=I_b,this.width=I_c,this.height=I_d,this.edges=I_e,this.color=I_f,this.borderWidth=I_g,this.borderColor=I_h}I_m(I_a,"laya.webgl.shapes.BasePoly");var I_b=I_a.prototype;return I_y.imps(I_b,{"laya.webgl.shapes.IShape":!0}),I_b.getData=function(I_a,I_b,I_c){},I_b.rebuild=function(I_a){},I_b.setMatrix=function(I_a){},I_b.needUpdate=function(I_a){return!0},I_b.sector=function(I_a,I_b,I_c){var I_d=this.x,I_e=this.y,I_f=this.edges,I_g=(this.r1-this.r0)/I_f,I_h=this.width,I_i=this.height,I_j=this.color,I_k=(I_j>>16&255)/255,I_l=(I_j>>8&255)/255,I_m=(255&I_j)/255;I_a.push(I_d,I_e,I_k,I_l,I_m);for(var I_n=0;I_n<I_f+1;I_n++)I_a.push(I_d+Math.sin(I_g*I_n+this.r0)*I_h,I_e+Math.cos(I_g*I_n+this.r0)*I_i),I_a.push(I_k,I_l,I_m);for(I_n=0;I_n<I_f;I_n++)I_b.push(I_c,I_c+I_n+1,I_c+I_n+2)},I_b.createLine2=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g,I_h,I_i,I_j,I_k,I_l,I_m,I_n,I_o,I_p,I_s,I_t,I_u,I_v,I_w,I_x,I_y,I_z,I_A,I_B,I_C=I_a.concat(),I_D=I_e,I_E=this.borderColor,I_F=(I_E>>16&255)/255,I_G=(I_E>>8&255)/255,I_H=(255&I_E)/255,I_I=I_C.length/2,I_J=I_d,I_K=I_c/2;I_i=I_C[0],I_j=I_C[1],I_p=I_i-(I_k=I_C[2]),I_o=(I_o=-(I_j-(I_l=I_C[3])))/(I_B=Math.sqrt(I_o*I_o+I_p*I_p))*I_K,I_p=I_p/I_B*I_K,I_D.push(I_i-I_o+this.x,I_j-I_p+this.y,I_F,I_G,I_H,I_i+I_o+this.x,I_j+I_p+this.y,I_F,I_G,I_H);for(var I_L=1;I_L<I_I-1;I_L++)I_i=I_C[2*(I_L-1)],I_j=I_C[2*(I_L-1)+1],I_k=I_C[2*I_L],I_l=I_C[2*I_L+1],I_m=I_C[2*(I_L+1)],I_n=I_C[2*(I_L+1)+1],I_p=I_i-I_k,I_t=I_k-I_m,I_w=(-(I_o=(I_o=-(I_j-I_l))/(I_B=Math.sqrt(I_o*I_o+I_p*I_p))*I_K)+I_i)*(-(I_p=I_p/I_B*I_K)+I_l)-(-I_o+I_k)*(-I_p+I_j),I_z=(-(I_s=(I_s=-(I_l-I_n))/(I_B=Math.sqrt(I_s*I_s+I_t*I_t))*I_K)+I_m)*(-(I_t=I_t/I_B*I_K)+I_l)-(-I_s+I_k)*(-I_t+I_n),I_A=(I_u=-I_p+I_j-(-I_p+I_l))*(I_y=-I_s+I_k-(-I_s+I_m))-(I_x=-I_t+I_n-(-I_t+I_l))*(I_v=-I_o+I_k-(-I_o+I_i)),Math.abs(I_A)<.1?(I_A+=10.1,I_D.push(I_k-I_o+this.x,I_l-I_p+this.y,I_F,I_G,I_H,I_k+I_o+this.x,I_l+I_p+this.y,I_F,I_G,I_H)):(((I_g=(I_v*I_z-I_y*I_w)/I_A)-I_k)*(I_g-I_k)+((I_h=(I_x*I_w-I_u*I_z)/I_A)-I_l)+(I_h-I_l),I_D.push(I_g+this.x,I_h+this.y,I_F,I_G,I_H,I_k-(I_g-I_k)+this.x,I_l-(I_h-I_l)+this.y,I_F,I_G,I_H));I_i=I_C[I_C.length-4],I_j=I_C[I_C.length-3],I_p=I_i-(I_k=I_C[I_C.length-2]),I_o=(I_o=-(I_j-(I_l=I_C[I_C.length-1])))/(I_B=Math.sqrt(I_o*I_o+I_p*I_p))*I_K,I_p=I_p/I_B*I_K,I_D.push(I_k-I_o+this.x,I_l-I_p+this.y,I_F,I_G,I_H,I_k+I_o+this.x,I_l+I_p+this.y,I_F,I_G,I_H);var I_M=I_f;for(I_L=1;I_L<I_M;I_L++)I_b.push(I_J+2*(I_L-1),I_J+2*(I_L-1)+1,I_J+2*I_L+1,I_J+2*I_L+1,I_J+2*I_L,I_J+2*(I_L-1));return I_D},I_b.createLine=function(I_a,I_b,I_c,I_d){var I_e=I_a.concat(),I_f=I_a,I_g=this.borderColor,I_h=(I_g>>16&255)/255,I_i=(I_g>>8&255)/255,I_j=(255&I_g)/255;I_e.splice(0,5);var I_k,I_l,I_m,I_n,I_o,I_p,I_s,I_t,I_u,I_v,I_w,I_x,I_y,I_z,I_A,I_B,I_C,I_D,I_E,I_F,I_G=I_e.length/5,I_H=I_d,I_I=I_c/2;I_m=I_e[0],I_n=I_e[1],I_v=I_m-(I_o=I_e[5]),I_u=(I_u=-(I_n-(I_p=I_e[6])))/(I_F=Math.sqrt(I_u*I_u+I_v*I_v))*I_I,I_v=I_v/I_F*I_I,I_f.push(I_m-I_u,I_n-I_v,I_h,I_i,I_j,I_m+I_u,I_n+I_v,I_h,I_i,I_j);for(var I_J=1;I_J<I_G-1;I_J++)I_m=I_e[5*(I_J-1)],I_n=I_e[5*(I_J-1)+1],I_o=I_e[5*I_J],I_p=I_e[5*I_J+1],I_s=I_e[5*(I_J+1)],I_t=I_e[5*(I_J+1)+1],I_v=I_m-I_o,I_x=I_o-I_s,I_A=(-(I_u=(I_u=-(I_n-I_p))/(I_F=Math.sqrt(I_u*I_u+I_v*I_v))*I_I)+I_m)*(-(I_v=I_v/I_F*I_I)+I_p)-(-I_u+I_o)*(-I_v+I_n),I_D=(-(I_w=(I_w=-(I_p-I_t))/(I_F=Math.sqrt(I_w*I_w+I_x*I_x))*I_I)+I_s)*(-(I_x=I_x/I_F*I_I)+I_p)-(-I_w+I_o)*(-I_x+I_t),I_E=(I_y=-I_v+I_n-(-I_v+I_p))*(I_C=-I_w+I_o-(-I_w+I_s))-(I_B=-I_x+I_t-(-I_x+I_p))*(I_z=-I_u+I_o-(-I_u+I_m)),Math.abs(I_E)<.1?(I_E+=10.1,I_f.push(I_o-I_u,I_p-I_v,I_h,I_i,I_j,I_o+I_u,I_p+I_v,I_h,I_i,I_j)):(((I_k=(I_z*I_D-I_C*I_A)/I_E)-I_o)*(I_k-I_o)+((I_l=(I_B*I_A-I_y*I_D)/I_E)-I_p)+(I_l-I_p),I_f.push(I_k,I_l,I_h,I_i,I_j,I_o-(I_k-I_o),I_p-(I_l-I_p),I_h,I_i,I_j));I_m=I_e[I_e.length-10],I_n=I_e[I_e.length-9],I_v=I_m-(I_o=I_e[I_e.length-5]),I_u=(I_u=-(I_n-(I_p=I_e[I_e.length-4])))/(I_F=Math.sqrt(I_u*I_u+I_v*I_v))*I_I,I_v=I_v/I_F*I_I,I_f.push(I_o-I_u,I_p-I_v,I_h,I_i,I_j,I_o+I_u,I_p+I_v,I_h,I_i,I_j);var I_K=this.edges+1;for(I_J=1;I_J<I_K;I_J++)I_b.push(I_H+2*(I_J-1),I_H+2*(I_J-1)+1,I_H+2*I_J+1,I_H+2*I_J+1,I_H+2*I_J,I_H+2*(I_J-1));return I_f},I_b.createLoopLine=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=I_a.concat(),I_h=I_e||I_a,I_i=this.borderColor,I_j=(I_i>>16&255)/255,I_k=(I_i>>8&255)/255,I_l=(255&I_i)/255;I_g.splice(0,5);var I_m=[I_g[0],I_g[1]],I_n=[I_g[I_g.length-5],I_g[I_g.length-4]],I_o=I_n[0]+.5*(I_m[0]-I_n[0]),I_p=I_n[1]+.5*(I_m[1]-I_n[1]);I_g.unshift(I_o,I_p,0,0,0),I_g.push(I_o,I_p,0,0,0);var I_s,I_t,I_u,I_v,I_w,I_x,I_y,I_z,I_A,I_B,I_C,I_D,I_E,I_F,I_G,I_H,I_I,I_J,I_K,I_L,I_M=I_g.length/5,I_N=I_d,I_O=I_c/2;I_u=I_g[0],I_v=I_g[1],I_B=I_u-(I_w=I_g[5]),I_A=(I_A=-(I_v-(I_x=I_g[6])))/(I_L=Math.sqrt(I_A*I_A+I_B*I_B))*I_O,I_B=I_B/I_L*I_O,I_h.push(I_u-I_A,I_v-I_B,I_j,I_k,I_l,I_u+I_A,I_v+I_B,I_j,I_k,I_l);for(var I_P=1;I_P<I_M-1;I_P++)I_u=I_g[5*(I_P-1)],I_v=I_g[5*(I_P-1)+1],I_w=I_g[5*I_P],I_x=I_g[5*I_P+1],I_y=I_g[5*(I_P+1)],I_z=I_g[5*(I_P+1)+1],I_B=I_u-I_w,I_D=I_w-I_y,I_G=(-(I_A=(I_A=-(I_v-I_x))/(I_L=Math.sqrt(I_A*I_A+I_B*I_B))*I_O)+I_u)*(-(I_B=I_B/I_L*I_O)+I_x)-(-I_A+I_w)*(-I_B+I_v),I_J=(-(I_C=(I_C=-(I_x-I_z))/(I_L=Math.sqrt(I_C*I_C+I_D*I_D))*I_O)+I_y)*(-(I_D=I_D/I_L*I_O)+I_x)-(-I_C+I_w)*(-I_D+I_z),I_K=(I_E=-I_B+I_v-(-I_B+I_x))*(I_I=-I_C+I_w-(-I_C+I_y))-(I_H=-I_D+I_z-(-I_D+I_x))*(I_F=-I_A+I_w-(-I_A+I_u)),Math.abs(I_K)<.1?(I_K+=10.1,I_h.push(I_w-I_A,I_x-I_B,I_j,I_k,I_l,I_w+I_A,I_x+I_B,I_j,I_k,I_l)):(((I_s=(I_F*I_J-I_I*I_G)/I_K)-I_w)*(I_s-I_w)+((I_t=(I_H*I_G-I_E*I_J)/I_K)-I_x)+(I_t-I_x),I_h.push(I_s,I_t,I_j,I_k,I_l,I_w-(I_s-I_w),I_x-(I_t-I_x),I_j,I_k,I_l));I_f&&(I_b=I_f);var I_Q=this.edges+1;for(I_P=1;I_P<I_Q;I_P++)I_b.push(I_N+2*(I_P-1),I_N+2*(I_P-1)+1,I_N+2*I_P+1,I_N+2*I_P+1,I_N+2*I_P,I_N+2*(I_P-1));return I_b.push(I_N+2*(I_P-1),I_N+2*(I_P-1)+1,I_N+1,I_N+1,I_N,I_N+2*(I_P-1)),I_h},I_a}(),I_da=function(){function I_p(){}return I_m(I_p,"laya.webgl.shapes.Earcut"),I_p.earcut=function(I_a,I_b,I_c){I_c=I_c||2;var I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k=I_b&&I_b.length,I_l=I_k?I_b[0]*I_c:I_a.length,I_m=I_p.linkedList(I_a,0,I_l,I_c,!0),I_n=[];if(!I_m)return I_n;if(I_k&&(I_m=I_p.eliminateHoles(I_a,I_b,I_m,I_c)),I_a.length>80*I_c){I_d=I_f=I_a[0],I_e=I_g=I_a[1];for(var I_o=I_c;I_o<I_l;I_o+=I_c)(I_h=I_a[I_o])<I_d&&(I_d=I_h),(I_i=I_a[I_o+1])<I_e&&(I_e=I_i),I_f<I_h&&(I_f=I_h),I_g<I_i&&(I_g=I_i);I_j=0!==(I_j=Math.max(I_f-I_d,I_g-I_e))?1/I_j:0}return I_p.earcutLinked(I_m,I_n,I_c,I_d,I_e,I_j),I_n},I_p.linkedList=function(I_a,I_b,I_c,I_d,I_e){var I_f,I_g;if(I_e===0<I_p.signedArea(I_a,I_b,I_c,I_d))for(I_f=I_b;I_f<I_c;I_f+=I_d)I_g=I_p.insertNode(I_f,I_a[I_f],I_a[I_f+1],I_g);else for(I_f=I_c-I_d;I_b<=I_f;I_f-=I_d)I_g=I_p.insertNode(I_f,I_a[I_f],I_a[I_f+1],I_g);return I_g&&I_p.equals(I_g,I_g.next)&&(I_p.removeNode(I_g),I_g=I_g.next),I_g},I_p.filterPoints=function(I_a,I_b){if(!I_a)return I_a;I_b||(I_b=I_a);var I_c,I_d=I_a;do{if(I_c=!1,I_d.steiner||!I_p.equals(I_d,I_d.next)&&0!==I_p.area(I_d.prev,I_d,I_d.next))I_d=I_d.next;else{if(I_p.removeNode(I_d),(I_d=I_b=I_d.prev)===I_d.next)break;I_c=!0}}while(I_c||I_d!==I_b);return I_b},I_p.earcutLinked=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){if(I_a){!I_g&&I_f&&I_p.indexCurve(I_a,I_d,I_e,I_f);for(var I_h,I_i,I_j=I_a;I_a.prev!==I_a.next;)if(I_h=I_a.prev,I_i=I_a.next,I_f?I_p.isEarHashed(I_a,I_d,I_e,I_f):I_p.isEar(I_a))I_b.push(I_h.i/I_c),I_b.push(I_a.i/I_c),I_b.push(I_i.i/I_c),I_p.removeNode(I_a),I_a=I_i.next,I_j=I_i.next;else if((I_a=I_i)===I_j){I_g?1===I_g?(I_a=I_p.cureLocalIntersections(I_a,I_b,I_c),I_p.earcutLinked(I_a,I_b,I_c,I_d,I_e,I_f,2)):2===I_g&&I_p.splitEarcut(I_a,I_b,I_c,I_d,I_e,I_f):I_p.earcutLinked(I_p.filterPoints(I_a,null),I_b,I_c,I_d,I_e,I_f,1);break}}},I_p.isEar=function(I_a){var I_b=I_a.prev,I_c=I_a,I_d=I_a.next;if(0<=I_p.area(I_b,I_c,I_d))return!1;for(var I_e=I_a.next.next;I_e!==I_a.prev;){if(I_p.pointInTriangle(I_b.x,I_b.y,I_c.x,I_c.y,I_d.x,I_d.y,I_e.x,I_e.y)&&0<=I_p.area(I_e.prev,I_e,I_e.next))return!1;I_e=I_e.next}return!0},I_p.isEarHashed=function(I_a,I_b,I_c,I_d){var I_e=I_a.prev,I_f=I_a,I_g=I_a.next;if(0<=I_p.area(I_e,I_f,I_g))return!1;for(var I_h=I_e.x<I_f.x?I_e.x<I_g.x?I_e.x:I_g.x:I_f.x<I_g.x?I_f.x:I_g.x,I_i=I_e.y<I_f.y?I_e.y<I_g.y?I_e.y:I_g.y:I_f.y<I_g.y?I_f.y:I_g.y,I_j=I_e.x>I_f.x?I_e.x>I_g.x?I_e.x:I_g.x:I_f.x>I_g.x?I_f.x:I_g.x,I_k=I_e.y>I_f.y?I_e.y>I_g.y?I_e.y:I_g.y:I_f.y>I_g.y?I_f.y:I_g.y,I_l=I_p.zOrder(I_h,I_i,I_b,I_c,I_d),I_m=I_p.zOrder(I_j,I_k,I_b,I_c,I_d),I_n=I_a.nextZ;I_n&&I_n.z<=I_m;){if(I_n!==I_a.prev&&I_n!==I_a.next&&I_p.pointInTriangle(I_e.x,I_e.y,I_f.x,I_f.y,I_g.x,I_g.y,I_n.x,I_n.y)&&0<=I_p.area(I_n.prev,I_n,I_n.next))return!1;I_n=I_n.nextZ}for(I_n=I_a.prevZ;I_n&&I_n.z>=I_l;){if(I_n!==I_a.prev&&I_n!==I_a.next&&I_p.pointInTriangle(I_e.x,I_e.y,I_f.x,I_f.y,I_g.x,I_g.y,I_n.x,I_n.y)&&0<=I_p.area(I_n.prev,I_n,I_n.next))return!1;I_n=I_n.prevZ}return!0},I_p.cureLocalIntersections=function(I_a,I_b,I_c){var I_d=I_a;do{var I_e=I_d.prev,I_f=I_d.next.next;!I_p.equals(I_e,I_f)&&I_p.intersects(I_e,I_d,I_d.next,I_f)&&I_p.locallyInside(I_e,I_f)&&I_p.locallyInside(I_f,I_e)&&(I_b.push(I_e.i/I_c),I_b.push(I_d.i/I_c),I_b.push(I_f.i/I_c),I_p.removeNode(I_d),I_p.removeNode(I_d.next),I_d=I_a=I_f),I_d=I_d.next}while(I_d!==I_a);return I_d},I_p.splitEarcut=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=I_a;do{for(var I_h=I_g.next.next;I_h!==I_g.prev;){if(I_g.i!==I_h.i&&I_p.isValidDiagonal(I_g,I_h)){var I_i=I_p.splitPolygon(I_g,I_h);return I_g=I_p.filterPoints(I_g,I_g.next),I_i=I_p.filterPoints(I_i,I_i.next),I_p.earcutLinked(I_g,I_b,I_c,I_d,I_e,I_f),void I_p.earcutLinked(I_i,I_b,I_c,I_d,I_e,I_f)}I_h=I_h.next}I_g=I_g.next}while(I_g!==I_a)},I_p.eliminateHoles=function(I_a,I_b,I_c,I_d){var I_e,I_f,I_g,I_h,I_i,I_j=[];for(I_e=0,I_f=I_b.length;I_e<I_f;I_e++)I_g=I_b[I_e]*I_d,I_h=I_e<I_f-1?I_b[I_e+1]*I_d:I_a.length,(I_i=I_p.linkedList(I_a,I_g,I_h,I_d,!1))===I_i.next&&(I_i.steiner=!0),I_j.push(I_p.getLeftmost(I_i));for(I_j.sort(I_p.compareX),I_e=0;I_e<I_j.length;I_e++)I_p.eliminateHole(I_j[I_e],I_c),I_c=I_p.filterPoints(I_c,I_c.next);return I_c},I_p.compareX=function(I_a,I_b){return I_a.x-I_b.x},I_p.eliminateHole=function(I_a,I_b){if(I_b=I_p.findHoleBridge(I_a,I_b)){var I_c=I_p.splitPolygon(I_b,I_a);I_p.filterPoints(I_c,I_c.next)}},I_p.findHoleBridge=function(I_a,I_b){var I_c,I_d=I_b,I_e=I_a.x,I_f=I_a.y,I_g=-1/0;do{if(I_f<=I_d.y&&I_f>=I_d.next.y&&I_d.next.y!==I_d.y){var I_h=I_d.x+(I_f-I_d.y)*(I_d.next.x-I_d.x)/(I_d.next.y-I_d.y);if(I_h<=I_e&&I_g<I_h){if((I_g=I_h)===I_e){if(I_f===I_d.y)return I_d;if(I_f===I_d.next.y)return I_d.next}I_c=I_d.x<I_d.next.x?I_d:I_d.next}}I_d=I_d.next}while(I_d!==I_b);if(!I_c)return null;if(I_e===I_g)return I_c.prev;var I_i,I_j=I_c,I_k=I_c.x,I_l=I_c.y,I_m=1/0;for(I_d=I_c.next;I_d!==I_j;)I_e>=I_d.x&&I_d.x>=I_k&&I_e!==I_d.x&&I_p.pointInTriangle(I_f<I_l?I_e:I_g,I_f,I_k,I_l,I_f<I_l?I_g:I_e,I_f,I_d.x,I_d.y)&&((I_i=Math.abs(I_f-I_d.y)/(I_e-I_d.x))<I_m||I_i===I_m&&I_d.x>I_c.x)&&I_p.locallyInside(I_d,I_a)&&(I_c=I_d,I_m=I_i),I_d=I_d.next;return I_c},I_p.indexCurve=function(I_a,I_b,I_c,I_d){for(var I_e=I_a;null===I_e.z&&(I_e.z=I_p.zOrder(I_e.x,I_e.y,I_b,I_c,I_d)),I_e.prevZ=I_e.prev,I_e.nextZ=I_e.next,(I_e=I_e.next)!==I_a;);I_e.prevZ.nextZ=null,I_e.prevZ=null,I_p.sortLinked(I_e)},I_p.sortLinked=function(I_a){var I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j=1;do{for(I_c=I_a,I_f=I_a=null,I_g=0;I_c;){for(I_g++,I_d=I_c,I_b=I_h=0;I_b<I_j&&(I_h++,I_d=I_d.nextZ);I_b++);for(I_i=I_j;0<I_h||0<I_i&&I_d;)0!==I_h&&(0===I_i||!I_d||I_c.z<=I_d.z)?(I_c=(I_e=I_c).nextZ,I_h--):(I_d=(I_e=I_d).nextZ,I_i--),I_f?I_f.nextZ=I_e:I_a=I_e,I_e.prevZ=I_f,I_f=I_e;I_c=I_d}I_f.nextZ=null,I_j*=2}while(1<I_g);return I_a},I_p.zOrder=function(I_a,I_b,I_c,I_d,I_e){return(I_a=1431655765&((I_a=858993459&((I_a=252645135&((I_a=16711935&((I_a=32767*(I_a-I_c)*I_e)|I_a<<8))|I_a<<4))|I_a<<2))|I_a<<1))|(I_b=1431655765&((I_b=858993459&((I_b=252645135&((I_b=16711935&((I_b=32767*(I_b-I_d)*I_e)|I_b<<8))|I_b<<4))|I_b<<2))|I_b<<1))<<1},I_p.getLeftmost=function(I_a){for(var I_b=I_a,I_c=I_a;I_b.x<I_c.x&&(I_c=I_b),(I_b=I_b.next)!==I_a;);return I_c},I_p.pointInTriangle=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){return 0<=(I_e-I_g)*(I_b-I_h)-(I_a-I_g)*(I_f-I_h)&&0<=(I_a-I_g)*(I_d-I_h)-(I_c-I_g)*(I_b-I_h)&&0<=(I_c-I_g)*(I_f-I_h)-(I_e-I_g)*(I_d-I_h)},I_p.isValidDiagonal=function(I_a,I_b){return I_a.next.i!==I_b.i&&I_a.prev.i!==I_b.i&&!I_p.intersectsPolygon(I_a,I_b)&&I_p.locallyInside(I_a,I_b)&&I_p.locallyInside(I_b,I_a)&&I_p.middleInside(I_a,I_b)},I_p.area=function(I_a,I_b,I_c){return(I_b.y-I_a.y)*(I_c.x-I_b.x)-(I_b.x-I_a.x)*(I_c.y-I_b.y)},I_p.equals=function(I_a,I_b){return I_a.x===I_b.x&&I_a.y===I_b.y},I_p.intersects=function(I_a,I_b,I_c,I_d){return!!(I_p.equals(I_a,I_b)&&I_p.equals(I_c,I_d)||I_p.equals(I_a,I_d)&&I_p.equals(I_c,I_b))||0<I_p.area(I_a,I_b,I_c)!=0<I_p.area(I_a,I_b,I_d)&&0<I_p.area(I_c,I_d,I_a)!=0<I_p.area(I_c,I_d,I_b)},I_p.intersectsPolygon=function(I_a,I_b){var I_c=I_a;do{if(I_c.i!==I_a.i&&I_c.next.i!==I_a.i&&I_c.i!==I_b.i&&I_c.next.i!==I_b.i&&I_p.intersects(I_c,I_c.next,I_a,I_b))return!0;I_c=I_c.next}while(I_c!==I_a);return!1},I_p.locallyInside=function(I_a,I_b){return I_p.area(I_a.prev,I_a,I_a.next)<0?0<=I_p.area(I_a,I_b,I_a.next)&&0<=I_p.area(I_a,I_a.prev,I_b):I_p.area(I_a,I_b,I_a.prev)<0||I_p.area(I_a,I_a.next,I_b)<0},I_p.middleInside=function(I_a,I_b){for(var I_c=I_a,I_d=!1,I_e=(I_a.x+I_b.x)/2,I_f=(I_a.y+I_b.y)/2;I_c.y>I_f!=I_c.next.y>I_f&&I_c.next.y!==I_c.y&&I_e<(I_c.next.x-I_c.x)*(I_f-I_c.y)/(I_c.next.y-I_c.y)+I_c.x&&(I_d=!I_d),(I_c=I_c.next)!==I_a;);return I_d},I_p.splitPolygon=function(I_a,I_b){var I_c=new I_ea(I_a.i,I_a.x,I_a.y),I_d=new I_ea(I_b.i,I_b.x,I_b.y),I_e=I_a.next,I_f=I_b.prev;return(I_a.next=I_b).prev=I_a,(I_c.next=I_e).prev=I_c,(I_d.next=I_c).prev=I_d,(I_f.next=I_d).prev=I_f,I_d},I_p.insertNode=function(I_a,I_b,I_c,I_d){var I_e=new I_ea(I_a,I_b,I_c);return I_d?(I_e.next=I_d.next,(I_e.prev=I_d).next.prev=I_e,I_d.next=I_e):(I_e.prev=I_e).next=I_e,I_e},I_p.removeNode=function(I_a){I_a.next.prev=I_a.prev,I_a.prev.next=I_a.next,I_a.prevZ&&(I_a.prevZ.nextZ=I_a.nextZ),I_a.nextZ&&(I_a.nextZ.prevZ=I_a.prevZ)},I_p.signedArea=function(I_a,I_b,I_c,I_d){for(var I_e=0,I_f=I_b,I_g=I_c-I_d;I_f<I_c;I_f+=I_d)I_e+=(I_a[I_g]-I_a[I_f])*(I_a[I_f+1]+I_a[I_g+1]),I_g=I_f;return I_e},I_p}(),I_ea=function(){function I_a(I_a,I_b,I_c){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=I_a,this.x=I_b,this.y=I_c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return I_m(I_a,"laya.webgl.shapes.EarcutNode"),I_a}(),I_fa=(function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this.lineWidth=I_a,this.lineColor=I_b,this.lineAlpha=I_c,this.fillColor=I_d,this.fillAlpha=I_e,this.shape=I_g,this.fill=I_f}I_m(I_a,"laya.webgl.shapes.GeometryData");var I_b=I_a.prototype;I_b.clone=function(){return new I_a(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},I_b.getIndexData=function(){return null},I_b.getVertexData=function(){return null},I_b.destroy=function(){this.shape=null}}(),function(){function I_a(I_a){if(I_a instanceof Float32Array)this.points=I_a;else if(I_a instanceof Array){I_a.length;this.points=new Float32Array(I_a)}}I_m(I_a,"laya.webgl.shapes.Vertex");var I_b=I_a.prototype;I_y.imps(I_b,{"laya.webgl.shapes.IShape":!0}),I_b.getData=function(I_a,I_b,I_c){},I_b.needUpdate=function(I_a){return!1},I_b.rebuild=function(I_a){},I_b.setMatrix=function(I_a){}}(),function(){function I_i(I_a){void 0===I_a&&(I_a=1e4),this._renderType=I_a}I_m(I_i,"laya.webgl.submit.Submit");var I_a=I_i.prototype;return I_y.imps(I_a,{"laya.webgl.submit.ISubmit":!0}),I_a.releaseRender=function(){var I_a=I_i._cache;(I_a[I_a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},I_a.getRenderType=function(){return this._renderType},I_a.renderSubmit=function(){if(0===this._numEle)return 1;var I_a=this.shaderValue.textureHost;if(I_a){var I_b=I_a.source;if(!I_a.bitmap||!I_b)return 1;this.shaderValue.texture=I_b,I_a.alphaTexture&&I_a.alphaTexture.source&&(this.shaderValue.texture1=I_a.alphaTexture.source)}this._vb.bind_upload(this._ib);var I_c=I_wa.mainContext;return this.shaderValue.upload(),I_S.activeBlendFunction!==this._blendFn&&(I_c.enable(3042),this._blendFn(I_c),I_S.activeBlendFunction=this._blendFn),I_G.drawCall++,I_G.trianglesFaces+=this._numEle/3,I_c.drawElements(4,this._numEle,5123,this._startIdx),1},I_i.__init__=function(){var I_a=I_i.RENDERBASE=new I_i(-1);I_a.shaderValue=new I_Aa(0,0),I_a.shaderValue.ALPHA=-1234},I_i.createSubmit=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_i._cache._length?I_i._cache[--I_i._cache._length]:new I_i;null==I_c&&((I_c=I_f._selfVb||(I_f._selfVb=I_ra.create(-1))).clear(),I_d=0),I_f._ib=I_b,I_f._vb=I_c,I_f._startIdx=I_d*I_pa.BYTES_PIDX,I_f._numEle=0;var I_g=I_a._nBlendType;I_f._blendFn=I_a._targets?I_S.targetFns[I_g]:I_S.fns[I_g],I_f.shaderValue=I_e,I_f.shaderValue.setValue(I_a._shader2D);var I_h=I_a._shader2D.filters;return I_h&&I_f.shaderValue.setFilters(I_h),I_f},I_i.createShape=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=I_i._cache._length?I_i._cache[--I_i._cache._length]:new I_i;I_g._ib=I_b,I_g._vb=I_c,I_g._numEle=I_d,I_g._startIdx=I_e,I_g.shaderValue=I_f,I_g.shaderValue.setValue(I_a._shader2D);var I_h=I_a._nBlendType;return I_g._blendFn=I_a._targets?I_S.targetFns[I_h]:I_S.fns[I_h],I_g},I_i.TYPE_2D=1e4,I_i.TYPE_CANVAS=10003,I_i.TYPE_CMDSETRT=10004,I_i.TYPE_CUSTOM=10005,I_i.TYPE_BLURRT=10006,I_i.TYPE_CMDDESTORYPRERT=10007,I_i.TYPE_DISABLESTENCIL=10008,I_i.TYPE_OTHERIBVB=10009,I_i.TYPE_PRIMITIVE=10010,I_i.TYPE_RT=10011,I_i.TYPE_BLUR_RT=10012,I_i.TYPE_TARGET=10013,I_i.TYPE_CHANGE_VALUE=10014,I_i.TYPE_SHAPE=10015,I_i.TYPE_TEXTURE=10016,I_i.TYPE_FILLTEXTURE=10017,I_i.RENDERBASE=null,I_i._cache=((I_i._cache=[])._length=0,I_i._cache),I_i}()),I_ga=function(){function I_d(){this.fun=null,this.args=null}I_m(I_d,"laya.webgl.submit.SubmitCMD");var I_a=I_d.prototype;return I_y.imps(I_a,{"laya.webgl.submit.ISubmit":!0}),I_a.renderSubmit=function(){return this.fun.apply(null,this.args),1},I_a.getRenderType=function(){return 0},I_a.releaseRender=function(){var I_a=I_d._cache;I_a[I_a._length++]=this},I_d.create=function(I_a,I_b){var I_c=I_d._cache._length?I_d._cache[--I_d._cache._length]:new I_d;return I_c.fun=I_b,I_c.args=I_a,I_c},I_d._cache=((I_d._cache=[])._length=0,I_d._cache),I_d}(),I_ha=function(){function I_b(){this.variables={}}I_m(I_b,"laya.webgl.submit.SubmitCMDScope");var I_a=I_b.prototype;return I_a.getValue=function(I_a){return this.variables[I_a]},I_a.addValue=function(I_a,I_b){return this.variables[I_a]=I_b},I_a.setValue=function(I_a,I_b){return this.variables.hasOwnProperty(I_a)?this.variables[I_a]=I_b:null},I_a.clear=function(){for(var I_a in this.variables)delete this.variables[I_a]},I_a.recycle=function(){this.clear(),I_b.POOL.push(this)},I_b.create=function(){var I_a=I_b.POOL.pop();return I_a||(I_a=new I_b),I_a},I_b.POOL=[],I_b}(),I_ia=function(){function I_l(){this.offset=0,this.startIndex=0,this._mat=I_B.create()}I_m(I_l,"laya.webgl.submit.SubmitOtherIBVB");var I_a=I_l.prototype;return I_y.imps(I_a,{"laya.webgl.submit.ISubmit":!0}),I_a.releaseRender=function(){var I_a=I_l._cache;(I_a[I_a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},I_a.getRenderType=function(){return 10009},I_a.renderSubmit=function(){var I_a=this._shaderValue.textureHost;if(I_a){var I_b=I_a.source;if(!I_a.bitmap||!I_b)return 1;this._shaderValue.texture=I_b}this._vb.bind_upload(this._ib);var I_c=I_ua.worldMatrix4,I_d=I_B.TEMP;I_B.mulPre(this._mat,I_c[0],I_c[1],I_c[4],I_c[5],I_c[12],I_c[13],I_d);var I_e=I_ua.worldMatrix4=I_l.tempMatrix4;I_e[0]=I_d.a,I_e[1]=I_d.b,I_e[4]=I_d.c,I_e[5]=I_d.d,I_e[12]=I_d.tx,I_e[13]=I_d.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var I_f=I_wa.mainContext;return I_S.activeBlendFunction!==this._blendFn&&(I_f.enable(3042),this._blendFn(I_f),I_S.activeBlendFunction=this._blendFn),I_G.drawCall++,I_G.trianglesFaces+=this._numEle/3,I_f.drawElements(4,this._numEle,5123,this.startIndex),I_ua.worldMatrix4=I_c,I_La.activeShader=null,1},I_l.create=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){void 0===I_i&&(I_i=0);var I_j=I_l._cache._length?I_l._cache[--I_l._cache._length]:new I_l;I_j._ib=I_c,I_j._vb=I_b,I_j._numEle=I_d,I_j._shader=I_e,I_j._shaderValue=I_f;var I_k=I_a._nBlendType;switch(I_j._blendFn=I_a._targets?I_S.targetFns[I_k]:I_S.fns[I_k],I_i){case 0:I_j.offset=0,I_j.startIndex=I_h/(I_pa.BYTES_PE*I_b.vertexStride)*1.5,I_j.startIndex*=I_pa.BYTES_PIDX;break;case 1:I_j.startIndex=I_g,I_j.offset=I_h}return I_j},I_l._cache=((I_l._cache=[])._length=0,I_l._cache),I_l.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],I_l}(),I_ja=function(){function I_c(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new I_D,this.screenRect=new I_D}I_m(I_c,"laya.webgl.submit.SubmitScissor");var I_a=I_c.prototype;return I_y.imps(I_a,{"laya.webgl.submit.ISubmit":!0}),I_a._scissor=function(I_a,I_b,I_c,I_d){var I_e=I_ua.worldMatrix4,I_f=I_e[0],I_g=I_e[5],I_h=I_e[12],I_i=I_e[13];if(I_d*=I_g,(I_c*=I_f)<1||I_d<1)return!1;var I_j=(I_a=I_a*I_f+I_h)+I_c,I_k=(I_b=I_b*I_g+I_i)+I_d;I_a<0&&(I_c=I_j-(I_a=0)),I_b<0&&(I_d=I_k-(I_b=0));var I_l=I_ua.worldClipRect;if(I_a=Math.max(I_a,I_l.x),I_b=Math.max(I_b,I_l.y),I_c=Math.min(I_j,I_l.right)-I_a,I_d=Math.min(I_k,I_l.bottom)-I_b,I_c<1||I_d<1)return!1;var I_m=I_ua.worldScissorTest;return this.screenRect.copyFrom(I_l),I_l.x=I_a,I_l.y=I_b,I_l.width=I_c,I_l.height=I_d,I_ua.worldScissorTest=!0,I_b=I_ua.height-I_b-I_d,I_wa.mainContext.scissor(I_a,I_b,I_c,I_d),I_wa.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),I_m?(I_b=I_ua.height-this.screenRect.y-this.screenRect.height,I_wa.mainContext.scissor(this.screenRect.x,I_b,this.screenRect.width,this.screenRect.height),I_wa.mainContext.enable(3089)):(I_wa.mainContext.disable(3089),I_ua.worldScissorTest=!1),I_l.copyFrom(this.screenRect),!0},I_a._scissorWithTagart=function(I_a,I_b,I_c,I_d){if(I_c<1||I_d<1)return!1;var I_e=I_a+I_c,I_f=I_b+I_d;I_a<0&&(I_c=I_e-(I_a=0)),I_b<0&&(I_d=I_f-(I_b=0));var I_g=I_ua.worldClipRect;if(I_a=Math.max(I_a,I_g.x),I_b=Math.max(I_b,I_g.y),I_c=Math.min(I_e,I_g.right)-I_a,I_d=Math.min(I_f,I_g.bottom)-I_b,I_c<1||I_d<1)return!1;var I_h=I_ua.worldScissorTest;return this.screenRect.copyFrom(I_g),I_ua.worldScissorTest=!0,I_g.x=I_a,I_g.y=I_b,I_g.width=I_c,I_g.height=I_d,I_b=I_ua.height-I_b-I_d,I_wa.mainContext.scissor(I_a,I_b,I_c,I_d),I_wa.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),I_h?(I_b=I_ua.height-this.screenRect.y-this.screenRect.height,I_wa.mainContext.scissor(this.screenRect.x,I_b,this.screenRect.width,this.screenRect.height),I_wa.mainContext.enable(3089)):(I_wa.mainContext.disable(3089),I_ua.worldScissorTest=!1),I_g.copyFrom(this.screenRect),!0},I_a.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},I_a.getRenderType=function(){return 0},I_a.releaseRender=function(){var I_a=I_c._cache;(I_a[I_a._length++]=this).context=null},I_c.create=function(I_a){var I_b=I_c._cache._length?I_c._cache[--I_c._cache._length]:new I_c;return I_b.context=I_a,I_b},I_c._cache=((I_c._cache=[])._length=0,I_c._cache),I_c}(),I_ka=function(){function I_i(){this.step=0,this.blendMode=null,this.level=0}I_m(I_i,"laya.webgl.submit.SubmitStencil");var I_a=I_i.prototype;return I_y.imps(I_a,{"laya.webgl.submit.ISubmit":!0}),I_a.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},I_a.getRenderType=function(){return 0},I_a.releaseRender=function(){var I_a=I_i._cache;I_a[I_a._length++]=this},I_a.do1=function(){var I_a=I_wa.mainContext;I_a.enable(2960),I_a.clear(1024),I_a.colorMask(!1,!1,!1,!1),I_a.stencilFunc(514,this.level,255),I_a.stencilOp(7680,7680,7682)},I_a.do2=function(){var I_a=I_wa.mainContext;I_a.stencilFunc(514,this.level+1,255),I_a.colorMask(!0,!0,!0,!0),I_a.stencilOp(7680,7680,7680)},I_a.do3=function(){var I_a=I_wa.mainContext;I_a.colorMask(!0,!0,!0,!0),I_a.stencilOp(7680,7680,7680),I_a.clear(1024),I_a.disable(2960)},I_a.do4=function(){var I_a=I_wa.mainContext;0==this.level&&(I_a.enable(2960),I_a.clear(1024)),I_a.colorMask(!1,!1,!1,!1),I_a.stencilFunc(519,0,255),I_a.stencilOp(7680,7680,7682)},I_a.do5=function(){var I_a=I_wa.mainContext;I_a.stencilFunc(514,this.level,255),I_a.colorMask(!0,!0,!0,!0),I_a.stencilOp(7680,7680,7680)},I_a.do6=function(){var I_a=I_wa.mainContext;I_S.targetFns[I_S.TOINT[this.blendMode]](I_a)},I_a.do7=function(){var I_a=I_wa.mainContext;I_a.colorMask(!1,!1,!1,!1),I_a.stencilOp(7680,7680,7683)},I_a.do8=function(){var I_a=I_wa.mainContext;I_a.colorMask(!0,!0,!0,!0),I_a.stencilFunc(514,this.level,255),I_a.stencilOp(7680,7680,7680)},I_i.restore=function(I_a,I_b,I_c,I_d,I_e){var I_f;if((I_a._renderKey=0)<I_i._mask&&I_i._mask--,0==I_i._mask)I_f=laya.webgl.submit.SubmitStencil.create(3),I_a.addRenderObject(I_f),I_a._curSubmit=I_fa.RENDERBASE;else{I_f=laya.webgl.submit.SubmitStencil.create(7),I_a.addRenderObject(I_f);var I_g=I_a._vb;I_g._byteLength;if(I_sa.fillRectImgVb(I_g,null,I_b.x,I_b.y,I_b.width,I_b.height,I_K.DEF_UV,I_c,I_d,I_e,0,0)){I_a._shader2D.glTexture=null;var I_h=I_a._curSubmit=I_fa.createSubmit(I_a,I_a._ib,I_g,(I_g._byteLength-64)/32*3,I_Aa.create(2,0));I_h.shaderValue.ALPHA=1,I_a._submits[I_a._submits._length++]=I_h,I_a._curSubmit._numEle+=6,I_a._curSubmit=I_fa.RENDERBASE}else alert("clipRect calc stencil rect error");I_f=laya.webgl.submit.SubmitStencil.create(8),I_a.addRenderObject(I_f)}},I_i.restore2=function(I_a,I_b){var I_c;(I_a._renderKey=0)<I_i._mask&&I_i._mask--,0==I_i._mask?(I_c=laya.webgl.submit.SubmitStencil.create(3),I_a.addRenderObject(I_c),I_a._curSubmit=I_fa.RENDERBASE):(I_c=laya.webgl.submit.SubmitStencil.create(7),I_a.addRenderObject(I_c),I_a._submits[I_a._submits._length++]=I_b,I_c=laya.webgl.submit.SubmitStencil.create(8),I_a.addRenderObject(I_c))},I_i.create=function(I_a){var I_b=I_i._cache._length?I_i._cache[--I_i._cache._length]:new I_i;return 5==(I_b.step=I_a)&&++I_i._mask,I_b.level=I_i._mask,I_b},I_i._cache=((I_i._cache=[])._length=0,I_i._cache),I_i._mask=0,I_i}(),I_la=function(){function I_h(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}I_m(I_h,"laya.webgl.submit.SubmitTarget");var I_a=I_h.prototype;return I_y.imps(I_a,{"laya.webgl.submit.ISubmit":!0}),I_a.renderSubmit=function(){this._vb.bind_upload(this._ib);var I_a=this.scope.getValue(this.proName);return I_a&&(this.shaderValue.texture=I_a.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[I_a.width,I_a.height]),this.shaderValue.upload(),this.blend(),I_G.drawCall++,I_G.trianglesFaces+=this._numEle/3,I_wa.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},I_a.blend=function(){if(I_S.activeBlendFunction!==I_S.fns[this.blendType]){var I_a=I_wa.mainContext;I_a.enable(3042),I_S.fns[this.blendType](I_a),I_S.activeBlendFunction=I_S.fns[this.blendType]}},I_a.getRenderType=function(){return 0},I_a.releaseRender=function(){var I_a=I_h._cache;(I_a[I_a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},I_h.create=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=I_h._cache._length?I_h._cache[--I_h._cache._length]:new I_h;return I_g._ib=I_b,I_g._vb=I_c,I_g.proName=I_f,I_g._startIdx=I_d*I_pa.BYTES_PIDX,I_g._numEle=0,I_g.blendType=I_a._nBlendType,I_g.shaderValue=I_e,I_g.shaderValue.setValue(I_a._shader2D),I_g},I_h._cache=((I_h._cache=[])._length=0,I_h._cache),I_h}(),I_ma=function(){function I_a(){this._sourceStr=null}I_m(I_a,"laya.webgl.text.CharSegment");var I_b=I_a.prototype;return I_y.imps(I_b,{"laya.webgl.text.ICharSegment":!0}),I_b.textToSpit=function(I_a){this._sourceStr=I_a},I_b.getChar=function(I_a){return this._sourceStr.charAt(I_a)},I_b.getCharCode=function(I_a){return this._sourceStr.charCodeAt(I_a)},I_b.length=function(){return this._sourceStr.length},I_a}(),I_na=function(){var I_a;function I_G(){}return I_m(I_G,"laya.webgl.text.DrawText"),I_G.__init__=function(){I_G._charsTemp=new Array,I_G._drawValue=new I_a,I_G._charSeg=new I_ma},I_G.customCharSeg=function(I_a){I_G._charSeg=I_a},I_G.getChar=function(I_a,I_b,I_c){var I_d=I_Va.createOneChar(I_a,I_c);return-1!=I_b&&(I_G._charsCache[I_b]=I_d),I_d},I_G._drawSlow=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_l,I_m,I_n,I_o){var I_p,I_s,I_t=I_G._drawValue.value(I_f,I_h,I_i,I_j,I_m,I_n,I_o),I_u=0,I_v=0,I_w=I_G._charsTemp,I_x=0,I_y=NaN;if(I_d)for(I_w.length=I_d.length,I_u=0,I_v=I_d.length;I_u<I_v;I_u++)(I_s=I_d[I_u])&&(I_y=I_s.charNum+I_t.txtID,I_w[I_u]=I_p=I_G._charsCache[I_y]||I_G.getChar(I_s.char,I_y,I_t),I_p.active());else{var I_z=I_c instanceof laya.utils.WordText?I_c.toString():I_c;if(I_J.CharacterCache){I_G._charSeg.textToSpit(I_z);var I_A=I_G._charSeg.length();for(I_u=0,I_v=I_w.length=I_A;I_u<I_v;I_u++)I_y=I_G._charSeg.getCharCode(I_u)+I_t.txtID,I_w[I_u]=I_p=I_G._charsCache[I_y]||I_G.getChar(I_G._charSeg.getChar(I_u),I_y,I_t),I_p.active(),I_x+=I_p.cw}else I_w.length=0,(I_p=I_G.getChar(I_z,-1,I_t)).active(),I_x+=I_p.cw,I_w[0]=I_p}var I_B=0;null!==I_g&&"left"!==I_g&&(I_B=-("center"==I_g?I_x/2:I_x));var I_C,I_D,I_E=NaN,I_F=0;if(I_d)for(I_u=0,I_v=I_w.length;I_u<I_v;I_u++)I_p=I_w[I_u],I_s=I_d[I_u],I_p&&I_s&&!I_p.isSpace&&(I_E=I_p.borderSize,I_C=I_p.texture,I_b._drawText(I_C,I_k+I_B+I_s.x*I_m-I_E,I_l+I_s.y*I_n-I_E,I_C.width,I_C.height,I_e,0,0,0,0));else{for(I_u=0,I_v=I_w.length;I_u<I_v;I_u++)(I_p=I_w[I_u])&&!I_p.isSpace&&(I_E=I_p.borderSize,I_C=I_p.texture,I_b._drawText(I_C,I_k+I_B-I_E,I_l-I_E,I_C.width,I_C.height,I_e,0,0,0,0),I_a&&((I_D=I_a[I_F++])||(I_D=I_a[I_F-1]=[]),I_D[0]=I_C,I_D[1]=I_B-I_E,I_D[2]=-I_E)),I_B+=I_p.cw;I_a&&(I_a.length=I_F)}},I_G._drawFast=function(I_a,I_b,I_c,I_d,I_e){for(var I_f,I_g,I_h=0,I_i=I_a.length;I_h<I_i;I_h++)(I_f=(I_g=I_a[I_h])[0]).active(),I_b._drawText(I_f,I_d+I_g[1],I_e+I_g[2],I_f.width,I_f.height,I_c,0,0,0,0)},I_G.drawText=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_l){if(void 0===I_l&&(I_l=0),!(I_b&&0===I_b.length||I_c&&0===I_c.length)){var I_m=I_d.a,I_n=I_d.d;(0!==I_d.b||0!==I_d.c)&&(I_m=I_n=1);var I_o=1!==I_m||1!==I_n;if(I_o&&I_y.stage.transform){var I_p=I_y.stage.transform;I_o=I_p.a===I_m&&I_p.d===I_n}else I_o=!1;if(I_o){var I_s=(I_d=I_d.copyTo(I_za._tmpMatrix)).tx,I_t=I_d.ty;I_d.scale(1/I_m,1/I_n),I_d._checkTransform(),I_j*=I_m,I_k*=I_n,I_j+=I_s-I_d.tx,I_k+=I_t-I_d.ty}else I_m=I_n=1;if(I_c)I_G._drawSlow(null,I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_m,I_n,I_l);else{if(null===I_b.toUpperCase){var I_u=I_m+1e5*I_n,I_v=I_b;return void(I_v.changed||I_v.id!==I_u?(I_v.id=I_u,I_v.changed=!1,I_G._drawSlow(I_v.save,I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_m,I_n,I_l)):I_G._drawFast(I_v.save,I_a,I_d,I_j,I_k))}var I_w=I_b+I_e.toString()+I_g+I_h+I_i+I_m+I_n+I_f,I_x=I_G._textsCache[I_w];I_J.CharacterCache?I_x?I_G._drawFast(I_x,I_a,I_d,I_j,I_k):(I_G._textsCache.__length||(I_G._textsCache.__length=0),I_G._textsCache.__length>I_z.WebGLTextCacheCount&&((I_G._textsCache={}).__length=0,I_G._curPoolIndex=0),I_G._textCachesPool[I_G._curPoolIndex]?(I_x=I_G._textsCache[I_w]=I_G._textCachesPool[I_G._curPoolIndex]).length=0:I_G._textCachesPool[I_G._curPoolIndex]=I_x=I_G._textsCache[I_w]=[],I_G._textsCache.__length++,I_G._curPoolIndex++,I_G._drawSlow(I_x,I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_m,I_n,I_l)):I_G._drawSlow(I_x,I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_m,I_n,I_l)}}},I_G._charsTemp=null,I_G._textCachesPool=[],I_G._curPoolIndex=0,I_G._charsCache={},I_G._textsCache={},I_G._drawValue=null,I_G.d=[],I_G._charSeg=null,I_G.__init$=function(){I_a=function(){function I_i(){}return I_m(I_i,""),I_i.prototype.value=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this.font=I_a,this.fillColor=I_b,this.borderColor=I_c,this.lineWidth=I_d,this.scaleX=I_e,this.scaleY=I_f,this.underLine=I_g;var I_h=I_a.toString()+I_e+I_f+I_d+(I_b?I_b.toLowerCase():" ")+(I_c?I_c.toLowerCase():" ")+I_g;return this.txtID=I_i._keymap[I_h],this.txtID||(this.txtID=1e-7*++I_i._keymapCount,I_i._keymap[I_h]=this.txtID),this},I_i.clear=function(){I_i._keymap={},I_i._keymapCount=1},I_i._keymap={},I_i._keymapCount=1,I_i}()},I_G}(),I_oa=function(){function I_e(I_a){this._index=0,this._size=14,this._italic=-2,I_e._cache2=I_e._cache2||[],this.setFont(I_a||"14px Arial")}I_m(I_e,"laya.webgl.text.FontInContext");var I_a=I_e.prototype;return I_a.setFont=function(I_a){var I_b=I_e._cache2[I_a];if(I_b)this._words=I_b[0],this._size=I_b[1];else{this._words=I_a.split(" ");for(var I_c=0,I_d=this._words.length;I_c<I_d;I_c++)if(0<this._words[I_c].indexOf("px")){this._index=I_c;break}this._size=parseInt(this._words[this._index]),I_e._cache2[I_a]=[this._words,this._size]}this._text=null,this._italic=-2},I_a.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},I_a.hasType=function(I_a){for(var I_b=0,I_c=this._words.length;I_b<I_c;I_b++)if(this._words[I_b]===I_a)return I_b;return-1},I_a.removeType=function(I_a){for(var I_b=0,I_c=this._words.length;I_b<I_c;I_b++)if(this._words[I_b]===I_a){this._words.splice(I_b,1),this._index>I_b&&this._index--;break}this._text=null,this._italic=-2},I_a.copyTo=function(I_a){return I_a._text=this._text,I_a._size=this._size,I_a._index=this._index,I_a._words=this._words.slice(),I_a._italic=-2,I_a},I_a.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},I_d(0,I_a,"size",function(){return this._size},function(I_a){this._size=I_a,this._words[this._index]=I_a+"px",this._text=null}),I_e.create=function(I_a){var I_b=I_e._cache[I_a];return I_b||(I_b=I_e._cache[I_a]=new I_e(I_a))},I_e.EMPTY=new I_e,I_e._cache={},I_e._cache2=null,I_e}(),I_pa=function(){function I_a(){}return I_m(I_a,"laya.webgl.utils.CONST3D2D"),I_a.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],I_a.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],I_a.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],I_a._TMPARRAY=[],I_a._OFFSETX=0,I_a._OFFSETY=0,I_g(I_a,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),I_a}(),I_sa=function(){function I_o(){}return I_m(I_o,"laya.webgl.utils.GlUtils"),I_o.make2DProjection=function(I_a,I_b,I_c){return[2/I_a,0,0,0,0,-2/I_b,0,0,0,0,2/I_c,0,-1,1,0,1]},I_o.fillIBQuadrangle=function(I_a,I_b){if(65535/4<I_b)throw Error("IBQuadrangle count:"+I_b+" must<:"+Math.floor(65535/4));I_b=Math.floor(I_b),I_a._resizeBuffer(6*(I_b+1)*2,!1),I_a.byteLength=I_a.bufferLength;for(var I_c=I_a.getUint16Array(),I_d=0,I_e=0;I_e<I_b;I_e++)I_c[I_d++]=4*I_e,I_c[I_d++]=4*I_e+2,I_c[I_d++]=4*I_e+1,I_c[I_d++]=4*I_e,I_c[I_d++]=4*I_e+3,I_c[I_d++]=4*I_e+2;return I_a.setNeedUpload(),!0},I_o.expandIBQuadrangle=function(I_a,I_b){I_a.bufferLength>=6*I_b*2||I_o.fillIBQuadrangle(I_a,I_b)},I_o.mathCeilPowerOfTwo=function(I_a){return I_a--,I_a|=I_a>>1,I_a|=I_a>>2,I_a|=I_a>>4,I_a|=I_a>>8,I_a|=I_a>>16,++I_a},I_o.fillQuadrangleImgVb=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){var I_i=16+(I_a._byteLength>>2);I_a.byteLength=I_i<<2;var I_j=I_a.getFloat32Array();I_j[(I_i-=16)+2]=I_e[0],I_j[I_i+3]=I_e[1],I_j[I_i+6]=I_e[2],I_j[I_i+7]=I_e[3],I_j[I_i+10]=I_e[4],I_j[I_i+11]=I_e[5],I_j[I_i+14]=I_e[6],I_j[I_i+15]=I_e[7];var I_k=I_f.a,I_l=I_f.b,I_m=I_f.c,I_n=I_f.d;if(1!==I_k||0!==I_l||0!==I_m||1!==I_n){I_f.bTransform=!0;var I_o=I_f.tx+I_g,I_p=I_f.ty+I_h;I_j[I_i]=(I_d[0]+I_b)*I_k+(I_d[1]+I_c)*I_m+I_o,I_j[I_i+1]=(I_d[0]+I_b)*I_l+(I_d[1]+I_c)*I_n+I_p,I_j[I_i+4]=(I_d[2]+I_b)*I_k+(I_d[3]+I_c)*I_m+I_o,I_j[I_i+5]=(I_d[2]+I_b)*I_l+(I_d[3]+I_c)*I_n+I_p,I_j[I_i+8]=(I_d[4]+I_b)*I_k+(I_d[5]+I_c)*I_m+I_o,I_j[I_i+9]=(I_d[4]+I_b)*I_l+(I_d[5]+I_c)*I_n+I_p,I_j[I_i+12]=(I_d[6]+I_b)*I_k+(I_d[7]+I_c)*I_m+I_o,I_j[I_i+13]=(I_d[6]+I_b)*I_l+(I_d[7]+I_c)*I_n+I_p}else I_f.bTransform=!1,I_b+=I_f.tx+I_g,I_c+=I_f.ty+I_h,I_j[I_i]=I_b+I_d[0],I_j[I_i+1]=I_c+I_d[1],I_j[I_i+4]=I_b+I_d[2],I_j[I_i+5]=I_c+I_d[3],I_j[I_i+8]=I_b+I_d[4],I_j[I_i+9]=I_c+I_d[5],I_j[I_i+12]=I_b+I_d[6],I_j[I_i+13]=I_c+I_d[7];return I_a._upload=!0},I_o.fillTranglesVB=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){var I_h=(I_a._byteLength>>2)+I_d.length;I_a.byteLength=I_h<<2;var I_i=I_a.getFloat32Array();I_h-=I_d.length;for(var I_j=I_d.length,I_k=I_e.a,I_l=I_e.b,I_m=I_e.c,I_n=I_e.d,I_o=0;I_o<I_j;I_o+=4)if(I_i[I_h+I_o+2]=I_d[I_o+2],I_i[I_h+I_o+3]=I_d[I_o+3],1!==I_k||0!==I_l||0!==I_m||1!==I_n){I_e.bTransform=!0;var I_p=I_e.tx+I_f,I_s=I_e.ty+I_g;I_i[I_h+I_o]=(I_d[I_o]+I_b)*I_k+(I_d[I_o+1]+I_c)*I_m+I_p,I_i[I_h+I_o+1]=(I_d[I_o]+I_b)*I_l+(I_d[I_o+1]+I_c)*I_n+I_s}else I_e.bTransform=!1,I_b+=I_e.tx+I_f,I_c+=I_e.ty+I_g,I_i[I_h+I_o]=I_b+I_d[I_o],I_i[I_h+I_o+1]=I_c+I_d[I_o+1];return I_a._upload=!0},I_o.copyPreImgVb=function(I_a,I_b,I_c){var I_d=I_a._byteLength>>2;I_a.byteLength=I_d+16<<2;for(var I_e=I_a.getFloat32Array(),I_f=0,I_g=I_d-16;I_f<4;I_f++)I_e[I_d]=I_e[I_g]+I_b,++I_g,I_e[++I_d]=I_e[I_g]+I_c,++I_g,I_e[++I_d]=I_e[I_g],++I_g,I_e[++I_d]=I_e[I_g],++I_d,++I_g;I_a._upload=!0},I_o.fillRectImgVb=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_l,I_m){void 0===I_m&&(I_m=!1);var I_n,I_o,I_p,I_s,I_t,I_u,I_v,I_w,I_x,I_y,I_z,I_A,I_B,I_C,I_D,I_E,I_F=1,I_G=I_h.a,I_H=I_h.b,I_I=I_h.c,I_J=I_h.d,I_K=I_b&&I_b.width<99999999;if(1!==I_G||0!==I_H||0!==I_I||1!==I_J?(I_h.bTransform=!0,0===I_H&&0===I_I&&(I_F=23,I_x=I_e+I_c,I_y=I_f+I_d,I_n=I_G*I_c+(I_z=I_h.tx+I_i),I_p=I_G*I_x+I_z,I_o=I_J*I_d+(I_A=I_h.ty+I_j),I_s=I_J*I_y+I_A)):(I_F=23,I_h.bTransform=!1,I_p=(I_n=I_c+I_h.tx+I_i)+I_e,I_s=(I_o=I_d+I_h.ty+I_j)+I_f),I_K&&(I_t=I_b.x,I_u=I_b.y,I_v=I_b.width+I_t,I_w=I_b.height+I_u),1!==I_F){if(Math.min(I_n,I_p)>=I_v)return!1;if(Math.min(I_o,I_s)>=I_w)return!1;if(Math.max(I_p,I_n)<=I_t)return!1;if(Math.max(I_s,I_o)<=I_u)return!1}var I_L=I_a._byteLength>>2;I_a.byteLength=16+I_L<<2;var I_M=I_a.getFloat32Array();switch(I_M[2+I_L]=I_g[0],I_M[3+I_L]=I_g[1],I_M[6+I_L]=I_g[2],I_M[7+I_L]=I_g[3],I_M[10+I_L]=I_g[4],I_M[11+I_L]=I_g[5],I_M[14+I_L]=I_g[6],I_M[15+I_L]=I_g[7],I_F){case 1:I_z=I_h.tx+I_i,I_A=I_h.ty+I_j;var I_N=I_G*I_c,I_O=I_I*I_d,I_P=I_J*I_d,I_Q=I_H*I_c,I_R=I_G*(I_x=I_e+I_c),I_S=I_I*(I_y=I_f+I_d),I_T=I_J*I_y,I_U=I_H*I_x;I_m?(I_B=I_N+I_O+I_z,I_D=Math.round(I_B)-I_B,I_C=I_P+I_Q+I_A,I_E=Math.round(I_C)-I_C,I_M[I_L]=I_B+I_D,I_M[1+I_L]=I_C+I_E,I_M[4+I_L]=I_R+I_O+I_z+I_D,I_M[5+I_L]=I_P+I_U+I_A+I_E,I_M[8+I_L]=I_R+I_S+I_z+I_D,I_M[9+I_L]=I_T+I_U+I_A+I_E,I_M[12+I_L]=I_N+I_S+I_z+I_D,I_M[13+I_L]=I_T+I_Q+I_A+I_E):(I_M[I_L]=I_N+I_O+I_z,I_M[1+I_L]=I_P+I_Q+I_A,I_M[4+I_L]=I_R+I_O+I_z,I_M[5+I_L]=I_P+I_U+I_A,I_M[8+I_L]=I_R+I_S+I_z,I_M[9+I_L]=I_T+I_U+I_A,I_M[12+I_L]=I_N+I_S+I_z,I_M[13+I_L]=I_T+I_Q+I_A);break;case 23:I_m?(I_B=I_n+I_k,I_D=Math.round(I_B)-I_B,I_C=I_o,I_E=Math.round(I_C)-I_C,I_M[I_L]=I_B+I_D,I_M[1+I_L]=I_C+I_E,I_M[4+I_L]=I_p+I_k+I_D,I_M[5+I_L]=I_o+I_E,I_M[8+I_L]=I_p+I_D,I_M[9+I_L]=I_s+I_E,I_M[12+I_L]=I_n+I_D,I_M[13+I_L]=I_s+I_E):(I_M[I_L]=I_n+I_k,I_M[1+I_L]=I_o,I_M[4+I_L]=I_p+I_k,I_M[5+I_L]=I_o,I_M[8+I_L]=I_p,I_M[9+I_L]=I_s,I_M[12+I_L]=I_n,I_M[13+I_L]=I_s)}return I_a._upload=!0},I_o.fillLineVb=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){var I_i=.5*I_g,I_j=I_o._fillLineArray,I_k=-(I_d-I_f),I_l=I_c-I_e,I_m=Math.sqrt(I_k*I_k+I_l*I_l);I_k/=I_m,I_l/=I_m,I_k*=I_i,I_l*=I_i,I_j[0]=I_c-I_k,I_j[1]=I_d-I_l,I_j[4]=I_c+I_k,I_j[5]=I_d+I_l,I_j[8]=I_e+I_k,I_j[9]=I_f+I_l,I_j[12]=I_e-I_k,I_j[13]=I_f-I_l,I_h&&I_h.transformPointArray(I_j,I_j);var I_n=16+(I_a._byteLength>>2);return I_a.byteLength=I_n<<2,I_a.insertData(I_j,I_n-16),!0},I_o._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],I_o}(),I_ta=(function(){function I_i(){}I_m(I_i,"laya.webgl.utils.MatirxArray"),I_i.ArrayMul=function(I_a,I_b,I_c){if(I_a)if(I_b)for(var I_d=NaN,I_e=NaN,I_f=NaN,I_g=NaN,I_h=0;I_h<4;I_h++)I_d=I_a[I_h],I_e=I_a[I_h+4],I_f=I_a[I_h+8],I_g=I_a[I_h+12],I_c[I_h]=I_d*I_b[0]+I_e*I_b[1]+I_f*I_b[2]+I_g*I_b[3],I_c[I_h+4]=I_d*I_b[4]+I_e*I_b[5]+I_f*I_b[6]+I_g*I_b[7],I_c[I_h+8]=I_d*I_b[8]+I_e*I_b[9]+I_f*I_b[10]+I_g*I_b[11],I_c[I_h+12]=I_d*I_b[12]+I_e*I_b[13]+I_f*I_b[14]+I_g*I_b[15];else I_i.copyArray(I_a,I_c);else I_i.copyArray(I_b,I_c)},I_i.copyArray=function(I_a,I_b){if(I_a&&I_b)for(var I_c=0;I_c<I_a.length;I_c++)I_b[I_c]=I_a[I_c]}}(),function(){function I_b(I_a,I_b,I_c){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=I_a,this._vb=new I_ra(I_a,35048),I_b&&this._vb._resizeBuffer(I_b,!1),this._ib=new I_qa,I_c&&this._ib._resizeBuffer(I_c,!1)}I_m(I_b,"laya.webgl.utils.Mesh2D");var I_a=I_b.prototype;return I_a.cloneWithNewVB=function(){var I_a=new I_b(this._stride,0,0);return I_a._ib=this._ib,I_a._quadNum=this._quadNum,I_a._attribInfo=this._attribInfo,I_a},I_a.cloneWithNewVBIB=function(){var I_a=new I_b(this._stride,0,0);return I_a._attribInfo=this._attribInfo,I_a},I_a.getVBW=function(){return this._vb.setNeedUpload(),this._vb},I_a.getVBR=function(){return this._vb},I_a.getIBR=function(){return this._ib},I_a.getIBW=function(){return this._ib.setNeedUpload(),this._ib},I_a.createQuadIB=function(I_a){this._quadNum=I_a,this._ib._resizeBuffer(6*I_a*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var I_b=this._ib.getUint16Array(),I_c=0,I_d=0,I_e=0;I_e<I_a;I_e++)I_b[I_c++]=I_d,I_b[I_c++]=I_d+2,I_b[I_c++]=I_d+1,I_b[I_c++]=I_d,I_b[I_c++]=I_d+3,I_b[I_c++]=I_d+2,I_d+=4;this._ib.setNeedUpload()},I_a.setAttributes=function(I_a){if(this._attribInfo=I_a,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},I_a.getEleNum=function(){return this._ib.getBuffer().byteLength/2},I_a.releaseMesh=function(){},I_a.destroy=function(){},I_a.clearVB=function(){this._vb.clear()},I_b._gvaoid=0,I_b}()),I_ua=function(){function I_e(){}return I_m(I_e,"laya.webgl.utils.RenderState2D"),I_e.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},I_e.mat2MatArray=function(I_a,I_b){var I_c=I_a,I_d=I_b;return I_d[0]=I_c.a,I_d[1]=I_c.b,I_d[2]=I_e.EMPTYMAT4_ARRAY[2],I_d[3]=I_e.EMPTYMAT4_ARRAY[3],I_d[4]=I_c.c,I_d[5]=I_c.d,I_d[6]=I_e.EMPTYMAT4_ARRAY[6],I_d[7]=I_e.EMPTYMAT4_ARRAY[7],I_d[8]=I_e.EMPTYMAT4_ARRAY[8],I_d[9]=I_e.EMPTYMAT4_ARRAY[9],I_d[10]=I_e.EMPTYMAT4_ARRAY[10],I_d[11]=I_e.EMPTYMAT4_ARRAY[11],I_d[12]=I_c.tx,I_d[13]=I_c.ty,I_d[14]=I_e.EMPTYMAT4_ARRAY[14],I_d[15]=I_e.EMPTYMAT4_ARRAY[15],I_b},I_e.restoreTempArray=function(){I_e.TEMPMAT4_ARRAY[0]=1,I_e.TEMPMAT4_ARRAY[1]=0,I_e.TEMPMAT4_ARRAY[4]=0,I_e.TEMPMAT4_ARRAY[5]=1,I_e.TEMPMAT4_ARRAY[12]=0,I_e.TEMPMAT4_ARRAY[13]=0},I_e.clear=function(){I_e.worldScissorTest=!1,I_e.worldShaderDefines=null,I_e.worldFilters=null,I_e.worldAlpha=1,I_e.worldClipRect.x=I_e.worldClipRect.y=0,I_e.worldClipRect.width=I_e.width,I_e.worldClipRect.height=I_e.height,I_e.curRenderTarget=null},I_e._MAXSIZE=99999999,I_e.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],I_e.worldMatrix4=I_e.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],I_e.worldAlpha=1,I_e.worldScissorTest=!1,I_e.worldFilters=null,I_e.worldShaderDefines=null,I_e.curRenderTarget=null,I_e.width=0,I_e.height=0,I_g(I_e,["worldMatrix",function(){return this.worldMatrix=new I_B},"worldClipRect",function(){return this.worldClipRect=new I_D(0,0,99999999,99999999)}]),I_e}(),I_va=function(){var I_u,I_c;function I_v(I_a,I_b,I_c,I_d,I_e){var I_f=this;function I_g(I_a){var I_b=[],I_c=new I_u(I_b);return I_f._compileToTree(I_c,I_a.split("\n"),0,I_b,I_e),I_c}var I_h=I_n.now();this._VS=I_g(I_b),this._PS=I_g(I_c),this._nameMap=I_d,2<I_n.now()-I_h&&console.log("ShaderCompile use time:"+(I_n.now()-I_h)+"  size:"+I_b.length+"/"+I_c.length)}I_m(I_v,"laya.webgl.utils.ShaderCompile");var I_a=I_v.prototype;return I_a._compileToTree=function(I_a,I_b,I_c,I_d,I_e){var I_f,I_g,I_h,I_i,I_j,I_k,I_l,I_m=0,I_n=0,I_o=0,I_p=0;for(I_n=I_c;I_n<I_b.length;I_n++)if(!((I_h=I_b[I_n]).length<1)&&0!==(I_m=I_h.indexOf("//"))){if(0<=I_m&&(I_h=I_h.substr(0,I_m)),I_f=I_l||new I_u(I_d),I_l=null,I_f.text=I_h,I_f.noCompile=!0,0<=(I_m=I_h.indexOf("#"))){for(I_i="#",I_p=I_m+1,I_o=I_h.length;I_p<I_o;I_p++){var I_s=I_h.charAt(I_p);if(" "===I_s||"\t"===I_s||"\r"===I_s||"\n"===I_s||"?"===I_s)break;I_i+=I_s}switch(I_f.name=I_i){case"#ifdef":case"#ifndef":if(I_f.src=I_h,I_f.noCompile=null!=I_h.match(/[!&|()=<>]/),I_f.noCompile?console.log("function():Boolean{return "+I_h.substr(I_m+I_f.name.length)+"}"):(I_k=I_h.replace(/^\s*/,"").split(/\s+/),I_f.setCondition(I_k[1],"#ifdef"===I_i?1:2),I_f.text="//"+I_f.text),I_f.setParent(I_a),I_a=I_f,I_e)for(I_k=I_h.substr(I_p).split(I_v._splitToWordExps3),I_p=0;I_p<I_k.length;I_p++)(I_h=I_k[I_p]).length&&(I_e[I_h]=!0);continue;case"#if":if(I_f.src=I_h,I_f.noCompile=!0,I_f.setParent(I_a),I_a=I_f,I_e)for(I_k=I_h.substr(I_p).split(I_v._splitToWordExps3),I_p=0;I_p<I_k.length;I_p++)(I_h=I_k[I_p]).length&&"defined"!=I_h&&(I_e[I_h]=!0);continue;case"#else":I_f.src=I_h,I_g=(I_a=I_a.parent).childs[I_a.childs.length-1],I_f.noCompile=I_g.noCompile,I_f.noCompile||(I_f.condition=I_g.condition,I_f.conditionType=1==I_g.conditionType?2:1,I_f.text="//"+I_f.text+" "+I_g.text+" "+I_f.conditionType),I_f.setParent(I_a),I_a=I_f;continue;case"#endif":I_g=(I_a=I_a.parent).childs[I_a.childs.length-1],I_f.noCompile=I_g.noCompile,I_f.noCompile||(I_f.text="//"+I_f.text),I_f.setParent(I_a);continue;case"#include":I_k=I_v.splitToWords(I_h,null);var I_t=I_v.includes[I_k[1]];if(!I_t)throw"ShaderCompile error no this include file:"+I_k[1];if((I_m=I_k[0].indexOf("?"))<0){I_f.setParent(I_a),I_h=I_t.getWith("with"==I_k[2]?I_k[3]:null),this._compileToTree(I_f,I_h.split("\n"),0,I_d,I_e),I_f.text="";continue}I_f.setCondition(I_k[0].substr(I_m+1),1),I_f.text=I_t.getWith("with"==I_k[2]?I_k[3]:null);break;case"#import":I_j=(I_k=I_v.splitToWords(I_h,null))[1],I_d.push({node:I_f,file:I_v.includes[I_j],ofs:I_f.text.length});continue}}else{if((I_g=I_a.childs[I_a.childs.length-1])&&!I_g.name){0<I_d.length&&I_v.splitToWords(I_h,I_g),I_l=I_f,I_g.text+="\n"+I_h;continue}0<I_d.length&&I_v.splitToWords(I_h,I_f)}I_f.setParent(I_a)}},I_a.createShader=function(I_a,I_b,I_c){var I_d={},I_e="";if(I_a)for(var I_f in I_a)I_e+="#define "+I_f+"\n",I_d[I_f]=!0;var I_g=this._VS.toscript(I_d,[]),I_h=this._PS.toscript(I_d,[]);return(I_c||I_Ya.create)(I_e+I_g.join("\n"),I_e+I_h.join("\n"),I_b,this._nameMap)},I_v._parseOne=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g={type:I_v.shaderParamsMap[I_c[I_d+1]],name:I_c[I_d+2],size:isNaN(parseInt(I_c[I_d+3]))?1:parseInt(I_c[I_d+3])};return I_f&&("attribute"==I_e?I_a.push(I_g):I_b.push(I_g)),":"==I_c[I_d+3]&&(I_g.type=I_c[I_d+4],I_d+=2),I_d+=2},I_v.addInclude=function(I_a,I_b){if(!I_b||0===I_b.length)throw new Error("add shader include file err:"+I_a);if(I_v.includes[I_a])throw new Error("add shader include file err, has add:"+I_a);I_v.includes[I_a]=new I_c(I_b)},I_v.preGetParams=function(I_a,I_b){var I_c=[I_a,I_b],I_d={},I_e=[],I_f=[],I_g={},I_h=[];I_d.attributes=I_e,I_d.uniforms=I_f,I_d.defines=I_g;for(var I_i=0,I_j=0,I_k=0;I_k<2;I_k++){I_c[I_k]=I_c[I_k].replace(I_v._removeAnnotation,"");var I_l,I_m=I_c[I_k].match(I_v._reg);for(I_i=0,I_j=I_m.length;I_i<I_j;I_i++){var I_n=I_m[I_i];if("attribute"==I_n||"uniform"==I_n)I_i=I_v._parseOne(I_e,I_f,I_m,I_i,I_n,!0);else{if("#define"==I_n){I_h[I_n=I_m[++I_i]]=1;continue}if("#ifdef"==I_n){I_g[I_l=I_m[++I_i]]=I_g[I_l]||[];for(I_i++;I_i<I_j;I_i++)if("attribute"==(I_n=I_m[I_i])||"uniform"==I_n)I_i=I_v._parseOne(I_e,I_f,I_m,I_i,I_n,I_h[I_l]);else if("#else"==I_n)for(I_i++;I_i<I_j;I_i++)if("attribute"==(I_n=I_m[I_i])||"uniform"==I_n)I_i=I_v._parseOne(I_e,I_f,I_m,I_i,I_n,!I_h[I_l]);else if("#endif"==I_n)break}}}}return I_d},I_v.splitToWords=function(I_a,I_b){for(var I_c,I_d,I_e=[],I_f=-1,I_g=0,I_h=I_a.length;I_g<I_h;I_g++)if(I_c=I_a.charAt(I_g),0<=" \t=+-*/&%!<>()'\",;".indexOf(I_c)){if(0<=I_f&&1<I_g-I_f&&(I_d=I_a.substr(I_f,I_g-I_f),I_e.push(I_d)),'"'==I_c||"'"==I_c){var I_i=I_a.indexOf(I_c,I_g+1);if(I_i<0)throw"Sharder err:"+I_a;I_e.push(I_a.substr(I_g+1,I_i-I_g-1)),I_g=I_i,I_f=-1;continue}"("==I_c&&I_b&&0<I_e.length&&(I_d=I_e[I_e.length-1]+";","vec4;main;".indexOf(I_d)<0&&(I_b.useFuns+=I_d)),I_f=-1}else I_f<0&&(I_f=I_g);return I_f<I_h&&1<I_h-I_f&&(I_d=I_a.substr(I_f,I_h-I_f),I_e.push(I_d)),I_e},I_v.IFDEF_NO=0,I_v.IFDEF_YES=1,I_v.IFDEF_ELSE=2,I_v.IFDEF_PARENT=3,I_v._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),I_v._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),I_v._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),I_v.includes={},I_g(I_v,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),I_v.__init$=function(){I_u=function(){function I_c(I_a){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=I_a}I_m(I_c,"");var I_a=I_c.prototype;return I_a.setParent=function(I_a){I_a.childs.push(this),this.z=I_a.z+1,this.parent=I_a},I_a.setCondition=function(I_a,I_b){I_a&&(this.conditionType=I_b,I_a=I_a.replace(/(\s*$)/g,""),this.condition=function(){return this[I_a]},this.condition.__condition=I_a)},I_a.toscript=function(I_a,I_b){return this._toscript(I_a,I_b,++I_c.__id)},I_a._toscript=function(I_d,I_e,I_f){if(this.childs.length<1&&!this.text)return I_e;I_e.length;if(this.condition){var I_a=!!this.condition.call(I_d);if(2===this.conditionType&&(I_a=!I_a),!I_a)return I_e}if(this.text&&I_e.push(this.text),0<this.childs.length&&this.childs.forEach(function(I_a,I_b,I_c){I_a._toscript(I_d,I_e,I_f)}),0<this.includefiles.length&&0<this.useFuns.length)for(var I_b,I_c=0,I_g=this.includefiles.length;I_c<I_g;I_c++)this.includefiles[I_c].curUseID!=I_f&&0<(I_b=this.includefiles[I_c].file.getFunsScript(this.useFuns)).length&&(this.includefiles[I_c].curUseID=I_f,I_e[0]=I_b+I_e[0]);return I_e},I_c.__id=1,I_c}(),I_c=function(){function I_a(I_a){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=I_a;for(var I_b=0,I_c=0,I_d=0;!((I_b=I_a.indexOf("#begin",I_b))<0);){for(I_d=I_b+5;!((I_d=I_a.indexOf("#end",I_d))<0)&&"i"===I_a.charAt(I_d+4);)I_d+=5;if(I_d<0)throw"add include err,no #end:"+I_a;I_c=I_a.indexOf("\n",I_b);var I_e=I_v.splitToWords(I_a.substr(I_b,I_c-I_b),null);"code"==I_e[1]?this.codes[I_e[2]]=I_a.substr(I_c+1,I_d-I_c-1):"function"==I_e[1]&&(I_c=I_a.indexOf("function",I_b),I_c+="function".length,this.funs[I_e[3]]=I_a.substr(I_c+1,I_d-I_c-1),this.funnames+=I_e[3]+";"),I_b=I_d+1}}I_m(I_a,"");var I_b=I_a.prototype;return I_b.getWith=function(I_a){var I_b=I_a?this.codes[I_a]:this.script;if(!I_b)throw"get with error:"+I_a;return I_b},I_b.getFunsScript=function(I_a){var I_b="";for(var I_c in this.funs)0<=I_a.indexOf(I_c+";")&&(I_b+=this.funs[I_c]);return I_b},I_a}()},I_v}(),I_wa=function(){function I_g(){}return I_m(I_g,"laya.webgl.WebGL"),I_g._uint8ArraySlice=function(){for(var I_a=this.length,I_b=new Uint8Array(this.length),I_c=0;I_c<I_a;I_c++)I_b[I_c]=this[I_c];return I_b},I_g._float32ArraySlice=function(){for(var I_a=this.length,I_b=new Float32Array(this.length),I_c=0;I_c<I_a;I_c++)I_b[I_c]=this[I_c];return I_b},I_g._uint16ArraySlice=function(I_a){var I_b,I_c=arguments,I_d=0,I_e=0;if(0===I_c.length)for(I_d=this.length,I_b=new Uint16Array(I_d),I_e=0;I_e<I_d;I_e++)I_b[I_e]=this[I_e];else if(2===I_c.length){var I_f=I_c[0],I_g=I_c[1];if(I_f<I_g)for(I_d=I_g-I_f,I_b=new Uint16Array(I_d),I_e=I_f;I_e<I_g;I_e++)I_b[I_e-I_f]=this[I_e];else I_b=new Uint16Array(0)}return I_b},I_g.expandContext=function(){var I_a=I_e.prototype,I_b=CanvasRenderingContext2D.prototype;I_b.fillTrangles=I_a.fillTrangles,I_Za.__int__(null),I_b.setIBVB=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){void 0===I_i&&(I_i=0),void 0===I_j&&(I_j=0),null===I_c&&(this._ib=this._ib||I_qa.QuadrangleIB,I_c=this._ib,I_sa.expandIBQuadrangle(I_c,I_d._byteLength/64+8)),this._setIBVB(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j)},I_b.fillTrangles=function(I_a,I_b,I_c,I_d,I_e){this._curMat=this._curMat||I_B.create(),this._vb=this._vb||I_ra.create(),this._ib||(this._ib=I_qa.create(),I_sa.fillIBQuadrangle(this._ib,I_g/4));var I_f=this._vb,I_g=I_d.length>>4;I_sa.fillTranglesVB(I_f,I_b,I_c,I_d,I_e||this._curMat,0,0),I_sa.expandIBQuadrangle(this._ib,I_f._byteLength/64+8);var I_h=new I_Aa(1,0);I_h.textureHost=I_a;var I_i=new I__a("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");I_f._vertType=3,this._setIBVB(I_b,I_c,this._ib,I_f,6*I_g,I_e,I_i,I_h,0,0)}},I_g.enable=function(){if(I_n.__init__(),I_t.isConchApp&&!I_t.isConchWebGL)return I_x.skinAniSprite=function(){return new I_aa},I_g.expandContext(),!1;if(I_x.getWebGLContext=function(I_a){for(var I_b,I_c=["webgl","experimental-webgl","webkit-3d","moz-webgl"],I_d=0;I_d<I_c.length;I_d++){try{I_b=I_a.getContext(I_c[I_d],{stencil:I_z.isStencil,alpha:I_z.isAlpha,antialias:I_z.isAntialias,premultipliedAlpha:I_z.premultipliedAlpha,preserveDrawingBuffer:I_z.preserveDrawingBuffer})}catch(I_a){}if(I_b)return I_b}return null},null==(I_g.mainContext=I_x.getWebGLContext(I_t._mainCanvas)))return!1;if(I_t.isWebGL)return!0;I_p.create=function(I_a,I_b){return new I_ab(I_a,I_b)},I_s.create=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){return new I_Xa(I_a,I_b,I_c,I_d,I_e,I_f,I_g)},I_t.WebGL=I_g,I_t.isWebGL=!0,I_na.__init__(),I_x.createRenderSprite=function(I_a,I_b){return new I_Ba(I_a,I_b)},I_x.createWebGLContext2D=function(I_a){return new I_za(I_a)},I_x.changeWebGLSize=function(I_a,I_b){laya.webgl.WebGL.onStageResize(I_a,I_b)},I_x.createGraphics=function(){return new I_ya};var I_a=I_x.createFilterAction;return I_x.createFilterAction=I_a||function(I_a){return new I_Ca},I_x.clear=function(I_a){I_ua.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var I_b=I_t.context.ctx,I_c=0==I_b._submits._length||I_z.preserveDrawingBuffer?I_o.create(I_a)._color:I_F._wgColor;I_c&&I_b.clearBG(I_c[0],I_c[1],I_c[2],I_c[3]),I_ua.clear()},I_x.addToAtlas=function(I_a,I_b){void 0===I_b&&(I_b=!1);var I_c=I_a.bitmap;I_t.optimizeTextureMemory(I_a.url,I_a)?I_y.__typeof(I_c,"laya.webgl.resource.IMergeAtlasBitmap")&&I_c.allowMerageInAtlas&&I_c.on("recovered",I_a,I_a.addTextureToAtlas):I_c.enableMerageInAtlas=!1},I_x.isAtlas=function(I_a){return I_a instanceof laya.webgl.atlas.AtlasWebGLCanvas},I_Q._enable(),I_x.beginFlush=function(){for(var I_a=I_Q.instance,I_b=I_a.getAtlaserCount(),I_c=0;I_c<I_b;I_c++){var I_d=I_a.getAtlaserByIndex(I_c).texture;I_d._flashCacheImageNeedFlush&&I_x.flashFlushImage(I_d)}},I_x.drawToCanvas=function(I_a,I_b,I_c,I_d,I_e,I_f){(I_c<=0||I_d<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),I_c|=0,I_d|=0,I_e|=0,I_f|=0;var I_g=I_Ma.create(I_c,I_d,6408,5121,0,!1);I_g.start(),I_g.clear(0,0,0,0),I_t.context.clear(),I_u.renders[I_b]._fun(I_a,I_t.context,I_e,I_ua.height-I_d+I_f),I_t.context.flush(),I_g.end();var I_h=I_g.getData(0,0,I_c,I_d);if(I_g.recycle(),I_h.byteLength==I_c*I_d*4){var I_i=new I_Ua;I_i._canvas=I_n.createElement("canvas"),I_i.size(I_c,I_d);var I_j=I_i._canvas.getContext("2d");I_n.canvas.size(I_c,I_d);var I_k=I_n.context,I_l=I_k.createImageData(I_c,I_d);return I_l.data.set(new Uint8ClampedArray(I_h.buffer)),I_i._imgData=I_l,I_k.putImageData(I_l,0,0),I_j.save(),I_j.translate(0,I_d),I_j.scale(1,-1),I_j.drawImage(I_n.canvas.source,0,0),I_j.restore(),I_i}console.log("drawToCanvas error: w:"+I_c+",h:"+I_d+",datalen:"+I_h.byteLength)},I_x.createFilterAction=function(I_a){var I_b;switch(I_a){case 32:I_b=new I_Ca}return I_b},I_x.addTextureToAtlas=function(I_a){I_a._uvID++,I_Q._atlasRestore++,I_a.bitmap.enableMerageInAtlas&&I_Q.instance.addToAtlas(I_a)},I_x.getTexturePixels=function(I_a,I_b,I_c,I_d,I_e){I_t.context.ctx.clear();var I_f=new I_E;I_f.graphics.drawTexture(I_a,-I_b,-I_c);var I_g=I_Ma.create(I_d,I_e);I_g.start(),I_g.clear(0,0,0,0),I_f.render(I_t.context,0,0),I_t.context.ctx.flush(),I_g.end();for(var I_h=I_g.getData(0,0,I_d,I_e),I_i=[],I_j=0,I_k=I_e-1;0<=I_k;I_k--)for(var I_l=0;I_l<I_d;I_l++)I_j=4*(I_k*I_d+I_l),I_i.push(I_h[I_j]),I_i.push(I_h[I_j+1]),I_i.push(I_h[I_j+2]),I_i.push(I_h[I_j+3]);return I_i},I_x.skinAniSprite=function(){return new I_aa},I_j.create=function(I_a,I_b){var I_c=new I_Ua;return I_c._imgData=I_b,I_c.flipY=!1,I_c},I_A._filterStart=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_a.getValue("bounds"),I_g=I_Ma.create(I_f.width,I_f.height);if(I_g.start(),I_g.clear(0,0,0,0),I_a.addValue("src",I_g),I_a.addValue("ScissorTest",I_ua.worldScissorTest),I_ua.worldScissorTest){var I_h=new I_D;I_h.copyFrom(I_c.ctx._clipRect),I_a.addValue("clipRect",I_h),I_ua.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},I_A._filterEnd=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_a.getValue("bounds");I_a.getValue("src").end();var I_g=I_Ma.create(I_f.width,I_f.height);I_g.start(),I_g.clear(0,0,0,0),I_a.addValue("out",I_g),I_b._set$P("_filterCache",I_g),I_b._set$P("_isHaveGlowFilter",I_a.getValue("_isHaveGlowFilter"))},I_A._EndTarget=function(I_a,I_b){if(I_a.getValue("src").recycle(),I_a.getValue("out").end(),I_a.getValue("ScissorTest")){I_ua.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),I_b.ctx.save();var I_c=I_a.getValue("clipRect");I_b.ctx.clipRect(I_c.x,I_c.y,I_c.width,I_c.height)}},I_A._useSrc=function(I_a){var I_b=I_a.getValue("out");I_b.end(),(I_b=I_a.getValue("src")).start(),I_b.clear(0,0,0,0)},I_A._endSrc=function(I_a){I_a.getValue("src").end()},I_A._useOut=function(I_a){var I_b=I_a.getValue("src");I_b.end(),(I_b=I_a.getValue("out")).start(),I_b.clear(0,0,0,0)},I_A._endOut=function(I_a){I_a.getValue("out").end()},I_A._recycleScope=function(I_a){I_a.recycle()},I_A._filter=function(I_a,I_b,I_c,I_d){var I_e=this._next;if(I_e){var I_f,I_g,I_h=I_a.filters,I_i=I_h.length;if(1==I_i&&32==I_h[0].type)return I_b.ctx.save(),I_b.ctx.setFilters([I_h[0]]),I_e._fun.call(I_e,I_a,I_b,I_c,I_d),void I_b.ctx.restore();var I_j=I_ha.create(),I_k=I_C.TEMP,I_l=I_b.ctx._getTransformMatrix(),I_m=I_B.create();I_l.copyTo(I_m);var I_n=0,I_o=0,I_p=!1,I_s=I_a._$P._filterCache?I_a._$P._filterCache:null;if(!I_s||I_a._repaint){I_p=I_a._isHaveGlowFilter(),I_j.addValue("_isHaveGlowFilter",I_p),I_p&&(I_n=50,I_o=25),(I_g=new I_D).copyFrom(I_a.getSelfBounds()),I_g.x+=I_a.x,I_g.y+=I_a.y,I_g.x-=I_a.pivotX+4,I_g.y-=I_a.pivotY+4;var I_t=I_g.x,I_u=I_g.y;if(I_g.width+=I_n+8,I_g.height+=I_n+8,I_k.x=I_g.x*I_m.a+I_g.y*I_m.c,I_k.y=I_g.y*I_m.d+I_g.x*I_m.b,I_g.x=I_k.x,I_g.y=I_k.y,I_k.x=I_g.width*I_m.a+I_g.height*I_m.c,I_k.y=I_g.height*I_m.d+I_g.width*I_m.b,I_g.width=I_k.x,I_g.height=I_k.y,I_g.width<=0||I_g.height<=0)return;I_s&&I_s.recycle(),I_j.addValue("bounds",I_g);var I_v=I_ga.create([I_j,I_a,I_b,0,0],I_A._filterStart);I_b.addRenderObject(I_v),I_b.ctx._renderKey=0,I_b.ctx._shader2D.glTexture=null;var I_w=I_a.x-I_t+I_o,I_x=I_a.y-I_u+I_o;I_e._fun.call(I_e,I_a,I_b,I_w,I_x),I_v=I_ga.create([I_j,I_a,I_b,0,0],I_A._filterEnd),I_b.addRenderObject(I_v);for(var I_y=0;I_y<I_i;I_y++){0!=I_y&&(I_v=I_ga.create([I_j],I_A._useSrc),I_b.addRenderObject(I_v),I_f=I_Aa.create(1,0),I_B.TEMP.identity(),I_b.ctx.drawTarget(I_j,0,0,I_g.width,I_g.height,I_B.TEMP,"out",I_f,null,I_S.TOINT.overlay),I_v=I_ga.create([I_j],I_A._useOut),I_b.addRenderObject(I_v)),I_h[I_y].action.apply3d(I_j,I_a,I_b,0,0)}I_v=I_ga.create([I_j,I_b],I_A._EndTarget),I_b.addRenderObject(I_v)}else{if((I_p=!!I_a._$P._isHaveGlowFilter&&I_a._$P._isHaveGlowFilter)&&(I_n=50,I_o=25),(I_g=I_a.getBounds()).width<=0||I_g.height<=0)return;I_g.width+=I_n,I_g.height+=I_n,I_k.x=I_g.x*I_m.a+I_g.y*I_m.c,I_k.y=I_g.y*I_m.d+I_g.x*I_m.b,I_g.x=I_k.x,I_g.y=I_k.y,I_k.x=I_g.width*I_m.a+I_g.height*I_m.c,I_k.y=I_g.height*I_m.d+I_g.width*I_m.b,I_g.width=I_k.x,I_g.height=I_k.y,I_j.addValue("out",I_s)}I_c=I_c-I_o-I_a.x,I_d=I_d-I_o-I_a.y,I_k.setTo(I_c,I_d),I_m.transformPoint(I_k),I_c=I_k.x+I_g.x,I_d=I_k.y+I_g.y,I_f=I_Aa.create(1,0),I_B.TEMP.identity(),I_b.ctx.drawTarget(I_j,I_c,I_d,I_g.width,I_g.height,I_B.TEMP,"out",I_f,null,I_S.TOINT.overlay),I_v=I_ga.create([I_j],I_A._recycleScope),I_b.addRenderObject(I_v),I_m.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=I_g._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=I_g._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=I_g._uint8ArraySlice),!0},I_g.onStageResize=function(I_a,I_b){null!=I_g.mainContext&&(I_g.mainContext.viewport(0,0,I_a,I_b),I_ua.width=I_a,I_ua.height=I_b)},I_g.onInvalidGLRes=function(){I_Q.instance.freeAll(),I_w.releaseContentManagers(!0),I_g.doNodeRepaint(I_y.stage),I_g.mainContext.viewport(0,0,I_ua.width,I_ua.height),I_y.stage.event("devicelost")},I_g.doNodeRepaint=function(I_a){0==I_a.numChildren&&I_a.repaint();for(var I_b=0;I_b<I_a.numChildren;I_b++)I_g.doNodeRepaint(I_a.getChildAt(I_b))},I_g.init=function(I_a,I_b,I_c){I_g.mainCanvas=I_a,I_j._createContext=function(I_a){return new I_za(I_a)},I_Ua._createContext=function(I_a){return new I_za(I_a)};var I_d=laya.webgl.WebGL.mainContext;if(null!=I_d.getShaderPrecisionFormat){var I_e=I_d.getShaderPrecisionFormat(35633,36338),I_f=I_d.getShaderPrecisionFormat(35632,36338);I_g.shaderHighPrecision=!(!I_e.precision||!I_f.precision)}else I_g.shaderHighPrecision=!1;if(I_d.deleteTexture1=I_d.deleteTexture,I_d.deleteTexture=function(I_a){I_a==I_xa.curBindTexValue&&(I_xa.curBindTexValue=null),I_d.deleteTexture1(I_a)},I_g.onStageResize(I_b,I_c),null==I_g.mainContext)throw new Error("webGL getContext err!");I_I.__init__(),I_Q.__init__(),I_Ea.__init__(),I_fa.__init__(),I_za.__init__(),I_Aa.__init__(),I_q.__init__(),I_Za.__int__(I_d),I_S._init_(I_d),I_t.isConchApp&&conch.setOnInvalidGLRes(I_g.onInvalidGLRes)},I_g.mainCanvas=null,I_g.mainContext=null,I_g.antialias=!0,I_g.shaderHighPrecision=!1,I_g._bg_null=[0,0,0,0],I_g}(),I_xa=function(){function I_d(){}return I_m(I_d,"laya.webgl.WebGLContext"),I_d.UseProgram=function(I_a){return I_d._useProgram!==I_a&&(I_wa.mainContext.useProgram(I_a),I_d._useProgram=I_a,!0)},I_d.setDepthTest=function(I_a,I_b){I_b!==I_d._depthTest&&((I_d._depthTest=I_b)?I_a.enable(2929):I_a.disable(2929))},I_d.setDepthMask=function(I_a,I_b){I_b!==I_d._depthMask&&(I_d._depthMask=I_b,I_a.depthMask(I_b))},I_d.setDepthFunc=function(I_a,I_b){I_b!==I_d._depthFunc&&(I_d._depthFunc=I_b,I_a.depthFunc(I_b))},I_d.setBlend=function(I_a,I_b){I_b!==I_d._blend&&((I_d._blend=I_b)?I_a.enable(3042):I_a.disable(3042))},I_d.setBlendFunc=function(I_a,I_b,I_c){(I_b!==I_d._sFactor||I_c!==I_d._dFactor)&&(I_d._sFactor=I_b,I_d._dFactor=I_c,I_a.blendFunc(I_b,I_c))},I_d.setCullFace=function(I_a,I_b){I_b!==I_d._cullFace&&((I_d._cullFace=I_b)?I_a.enable(2884):I_a.disable(2884))},I_d.setFrontFace=function(I_a,I_b){I_b!==I_d._frontFace&&(I_d._frontFace=I_b,I_a.frontFace(I_b))},I_d.bindTexture=function(I_a,I_b,I_c){I_a.bindTexture(I_b,I_c),I_d.curBindTexTarget=I_b,I_d.curBindTexValue=I_c},I_d.DEPTH_BUFFER_BIT=256,I_d.STENCIL_BUFFER_BIT=1024,I_d.COLOR_BUFFER_BIT=16384,I_d.POINTS=0,I_d.LINES=1,I_d.LINE_LOOP=2,I_d.LINE_STRIP=3,I_d.TRIANGLES=4,I_d.TRIANGLE_STRIP=5,I_d.TRIANGLE_FAN=6,I_d.ZERO=0,I_d.ONE=1,I_d.SRC_COLOR=768,I_d.ONE_MINUS_SRC_COLOR=769,I_d.SRC_ALPHA=770,I_d.ONE_MINUS_SRC_ALPHA=771,I_d.DST_ALPHA=772,I_d.ONE_MINUS_DST_ALPHA=773,I_d.DST_COLOR=774,I_d.ONE_MINUS_DST_COLOR=775,I_d.SRC_ALPHA_SATURATE=776,I_d.FUNC_ADD=32774,I_d.BLEND_EQUATION=32777,I_d.BLEND_EQUATION_RGB=32777,I_d.BLEND_EQUATION_ALPHA=34877,I_d.FUNC_SUBTRACT=32778,I_d.FUNC_REVERSE_SUBTRACT=32779,I_d.BLEND_DST_RGB=32968,I_d.BLEND_SRC_RGB=32969,I_d.BLEND_DST_ALPHA=32970,I_d.BLEND_SRC_ALPHA=32971,I_d.CONSTANT_COLOR=32769,I_d.ONE_MINUS_CONSTANT_COLOR=32770,I_d.CONSTANT_ALPHA=32771,I_d.ONE_MINUS_CONSTANT_ALPHA=32772,I_d.BLEND_COLOR=32773,I_d.ARRAY_BUFFER=34962,I_d.ELEMENT_ARRAY_BUFFER=34963,I_d.ARRAY_BUFFER_BINDING=34964,I_d.ELEMENT_ARRAY_BUFFER_BINDING=34965,I_d.STREAM_DRAW=35040,I_d.STATIC_DRAW=35044,I_d.DYNAMIC_DRAW=35048,I_d.BUFFER_SIZE=34660,I_d.BUFFER_USAGE=34661,I_d.CURRENT_VERTEX_ATTRIB=34342,I_d.FRONT=1028,I_d.BACK=1029,I_d.CULL_FACE=2884,I_d.FRONT_AND_BACK=1032,I_d.BLEND=3042,I_d.DITHER=3024,I_d.STENCIL_TEST=2960,I_d.DEPTH_TEST=2929,I_d.SCISSOR_TEST=3089,I_d.POLYGON_OFFSET_FILL=32823,I_d.SAMPLE_ALPHA_TO_COVERAGE=32926,I_d.SAMPLE_COVERAGE=32928,I_d.NO_ERROR=0,I_d.INVALID_ENUM=1280,I_d.INVALID_VALUE=1281,I_d.INVALID_OPERATION=1282,I_d.OUT_OF_MEMORY=1285,I_d.CW=2304,I_d.CCW=2305,I_d.LINE_WIDTH=2849,I_d.ALIASED_POINT_SIZE_RANGE=33901,I_d.ALIASED_LINE_WIDTH_RANGE=33902,I_d.CULL_FACE_MODE=2885,I_d.FRONT_FACE=2886,I_d.DEPTH_RANGE=2928,I_d.DEPTH_WRITEMASK=2930,I_d.DEPTH_CLEAR_VALUE=2931,I_d.DEPTH_FUNC=2932,I_d.STENCIL_CLEAR_VALUE=2961,I_d.STENCIL_FUNC=2962,I_d.STENCIL_FAIL=2964,I_d.STENCIL_PASS_DEPTH_FAIL=2965,I_d.STENCIL_PASS_DEPTH_PASS=2966,I_d.STENCIL_REF=2967,I_d.STENCIL_VALUE_MASK=2963,I_d.STENCIL_WRITEMASK=2968,I_d.STENCIL_BACK_FUNC=34816,I_d.STENCIL_BACK_FAIL=34817,I_d.STENCIL_BACK_PASS_DEPTH_FAIL=34818,I_d.STENCIL_BACK_PASS_DEPTH_PASS=34819,I_d.STENCIL_BACK_REF=36003,I_d.STENCIL_BACK_VALUE_MASK=36004,I_d.STENCIL_BACK_WRITEMASK=36005,I_d.VIEWPORT=2978,I_d.SCISSOR_BOX=3088,I_d.COLOR_CLEAR_VALUE=3106,I_d.COLOR_WRITEMASK=3107,I_d.UNPACK_ALIGNMENT=3317,I_d.PACK_ALIGNMENT=3333,I_d.MAX_TEXTURE_SIZE=3379,I_d.MAX_VIEWPORT_DIMS=3386,I_d.SUBPIXEL_BITS=3408,I_d.RED_BITS=3410,I_d.GREEN_BITS=3411,I_d.BLUE_BITS=3412,I_d.ALPHA_BITS=3413,I_d.DEPTH_BITS=3414,I_d.STENCIL_BITS=3415,I_d.POLYGON_OFFSET_UNITS=10752,I_d.POLYGON_OFFSET_FACTOR=32824,I_d.TEXTURE_BINDING_2D=32873,I_d.SAMPLE_BUFFERS=32936,I_d.SAMPLES=32937,I_d.SAMPLE_COVERAGE_VALUE=32938,I_d.SAMPLE_COVERAGE_INVERT=32939,I_d.NUM_COMPRESSED_TEXTURE_FORMATS=34466,I_d.COMPRESSED_TEXTURE_FORMATS=34467,I_d.DONT_CARE=4352,I_d.FASTEST=4353,I_d.NICEST=4354,I_d.GENERATE_MIPMAP_HINT=33170,I_d.BYTE=5120,I_d.UNSIGNED_BYTE=5121,I_d.SHORT=5122,I_d.UNSIGNED_SHORT=5123,I_d.INT=5124,I_d.UNSIGNED_INT=5125,I_d.FLOAT=5126,I_d.DEPTH_COMPONENT=6402,I_d.ALPHA=6406,I_d.RGB=6407,I_d.RGBA=6408,I_d.LUMINANCE=6409,I_d.LUMINANCE_ALPHA=6410,I_d.UNSIGNED_SHORT_4_4_4_4=32819,I_d.UNSIGNED_SHORT_5_5_5_1=32820,I_d.UNSIGNED_SHORT_5_6_5=33635,I_d.FRAGMENT_SHADER=35632,I_d.VERTEX_SHADER=35633,I_d.MAX_VERTEX_ATTRIBS=34921,I_d.MAX_VERTEX_UNIFORM_VECTORS=36347,I_d.MAX_VARYING_VECTORS=36348,I_d.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,I_d.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,I_d.MAX_TEXTURE_IMAGE_UNITS=34930,I_d.MAX_FRAGMENT_UNIFORM_VECTORS=36349,I_d.SHADER_TYPE=35663,I_d.DELETE_STATUS=35712,I_d.LINK_STATUS=35714,I_d.VALIDATE_STATUS=35715,I_d.ATTACHED_SHADERS=35717,I_d.ACTIVE_UNIFORMS=35718,I_d.ACTIVE_ATTRIBUTES=35721,I_d.SHADING_LANGUAGE_VERSION=35724,I_d.CURRENT_PROGRAM=35725,I_d.NEVER=512,I_d.LESS=513,I_d.EQUAL=514,I_d.LEQUAL=515,I_d.GREATER=516,I_d.NOTEQUAL=517,I_d.GEQUAL=518,I_d.ALWAYS=519,I_d.KEEP=7680,I_d.REPLACE=7681,I_d.INCR=7682,I_d.DECR=7683,I_d.INVERT=5386,I_d.INCR_WRAP=34055,I_d.DECR_WRAP=34056,I_d.VENDOR=7936,I_d.RENDERER=7937,I_d.VERSION=7938,I_d.NEAREST=9728,I_d.LINEAR=9729,I_d.NEAREST_MIPMAP_NEAREST=9984,I_d.LINEAR_MIPMAP_NEAREST=9985,I_d.NEAREST_MIPMAP_LINEAR=9986,I_d.LINEAR_MIPMAP_LINEAR=9987,I_d.TEXTURE_MAG_FILTER=10240,I_d.TEXTURE_MIN_FILTER=10241,I_d.TEXTURE_WRAP_S=10242,I_d.TEXTURE_WRAP_T=10243,I_d.TEXTURE_2D=3553,I_d.TEXTURE=5890,I_d.TEXTURE_CUBE_MAP=34067,I_d.TEXTURE_BINDING_CUBE_MAP=34068,I_d.TEXTURE_CUBE_MAP_POSITIVE_X=34069,I_d.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,I_d.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,I_d.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,I_d.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,I_d.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,I_d.MAX_CUBE_MAP_TEXTURE_SIZE=34076,I_d.TEXTURE0=33984,I_d.TEXTURE1=33985,I_d.TEXTURE2=33986,I_d.TEXTURE3=33987,I_d.TEXTURE4=33988,I_d.TEXTURE5=33989,I_d.TEXTURE6=33990,I_d.TEXTURE7=33991,I_d.TEXTURE8=33992,I_d.TEXTURE9=33993,I_d.TEXTURE10=33994,I_d.TEXTURE11=33995,I_d.TEXTURE12=33996,I_d.TEXTURE13=33997,I_d.TEXTURE14=33998,I_d.TEXTURE15=33999,I_d.TEXTURE16=34e3,I_d.TEXTURE17=34001,I_d.TEXTURE18=34002,I_d.TEXTURE19=34003,I_d.TEXTURE20=34004,I_d.TEXTURE21=34005,I_d.TEXTURE22=34006,I_d.TEXTURE23=34007,I_d.TEXTURE24=34008,I_d.TEXTURE25=34009,I_d.TEXTURE26=34010,I_d.TEXTURE27=34011,I_d.TEXTURE28=34012,I_d.TEXTURE29=34013,I_d.TEXTURE30=34014,I_d.TEXTURE31=34015,I_d.ACTIVE_TEXTURE=34016,I_d.REPEAT=10497,I_d.CLAMP_TO_EDGE=33071,I_d.MIRRORED_REPEAT=33648,I_d.FLOAT_VEC2=35664,I_d.FLOAT_VEC3=35665,I_d.FLOAT_VEC4=35666,I_d.INT_VEC2=35667,I_d.INT_VEC3=35668,I_d.INT_VEC4=35669,I_d.BOOL=35670,I_d.BOOL_VEC2=35671,I_d.BOOL_VEC3=35672,I_d.BOOL_VEC4=35673,I_d.FLOAT_MAT2=35674,I_d.FLOAT_MAT3=35675,I_d.FLOAT_MAT4=35676,I_d.SAMPLER_2D=35678,I_d.SAMPLER_CUBE=35680,I_d.VERTEX_ATTRIB_ARRAY_ENABLED=34338,I_d.VERTEX_ATTRIB_ARRAY_SIZE=34339,I_d.VERTEX_ATTRIB_ARRAY_STRIDE=34340,I_d.VERTEX_ATTRIB_ARRAY_TYPE=34341,I_d.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,I_d.VERTEX_ATTRIB_ARRAY_POINTER=34373,I_d.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,I_d.COMPILE_STATUS=35713,I_d.LOW_FLOAT=36336,I_d.MEDIUM_FLOAT=36337,I_d.HIGH_FLOAT=36338,I_d.LOW_INT=36339,I_d.MEDIUM_INT=36340,I_d.HIGH_INT=36341,I_d.FRAMEBUFFER=36160,I_d.RENDERBUFFER=36161,I_d.RGBA4=32854,I_d.RGB5_A1=32855,I_d.RGB565=36194,I_d.DEPTH_COMPONENT16=33189,I_d.STENCIL_INDEX=6401,I_d.STENCIL_INDEX8=36168,I_d.DEPTH_STENCIL=34041,I_d.RENDERBUFFER_WIDTH=36162,I_d.RENDERBUFFER_HEIGHT=36163,I_d.RENDERBUFFER_INTERNAL_FORMAT=36164,I_d.RENDERBUFFER_RED_SIZE=36176,I_d.RENDERBUFFER_GREEN_SIZE=36177,I_d.RENDERBUFFER_BLUE_SIZE=36178,I_d.RENDERBUFFER_ALPHA_SIZE=36179,I_d.RENDERBUFFER_DEPTH_SIZE=36180,I_d.RENDERBUFFER_STENCIL_SIZE=36181,I_d.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,I_d.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,I_d.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,I_d.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,I_d.COLOR_ATTACHMENT0=36064,I_d.DEPTH_ATTACHMENT=36096,I_d.STENCIL_ATTACHMENT=36128,I_d.DEPTH_STENCIL_ATTACHMENT=33306,I_d.NONE=0,I_d.FRAMEBUFFER_COMPLETE=36053,I_d.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,I_d.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,I_d.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,I_d.FRAMEBUFFER_UNSUPPORTED=36061,I_d.FRAMEBUFFER_BINDING=36006,I_d.RENDERBUFFER_BINDING=36007,I_d.MAX_RENDERBUFFER_SIZE=34024,I_d.INVALID_FRAMEBUFFER_OPERATION=1286,I_d.UNPACK_FLIP_Y_WEBGL=37440,I_d.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,I_d.CONTEXT_LOST_WEBGL=37442,I_d.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,I_d.BROWSER_DEFAULT_WEBGL=37444,I_d._useProgram=null,I_d._depthTest=!0,I_d._depthMask=!0,I_d._blend=!1,I_d._cullFace=!1,I_d.curBindTexTarget=null,I_d.curBindTexValue=null,I_g(I_d,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),I_d}(),I_ya=function(I_a){function I_b(){I_b.__super.call(this)}I_m(I_b,"laya.webgl.display.GraphicsGL",I_h);var I_c=I_b.prototype;return I_c.setShader=function(I_a){this._saveToCmd(I_t.context._setShader,[I_a])},I_c.setIBVB=function(I_a,I_b,I_c,I_d,I_e,I_f){this._saveToCmd(I_t.context._setIBVB,[I_a,I_b,I_c,I_d,I_e,I_f])},I_c.drawParticle=function(I_a,I_b,I_c){var I_d=I_x.createParticleTemplate2D(I_c);I_d.x=I_a,I_d.y=I_b,this._saveToCmd(I_t.context._drawParticle,[I_d])},I_b}(),I_za=function(I_a){var I_c;function I_P(I_a){this._x=0,this._y=0,this._id=++I_P._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,I_P.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=I_P.MAXCLIPRECT,this.mOutPoint,this._canvas=I_a,this._canvas._addReference(),I_P._contextcount++,I_t.isFlash?(this._ib=I_qa.create(35044),I_sa.fillIBQuadrangle(this._ib,16)):this._ib=I_qa.QuadrangleIB,this.clear()}I_m(I_P,"laya.webgl.canvas.WebGLContext2D",I_e);var I_b=I_P.prototype;return I_b.setIsMainContext=function(){this._isMain=!0},I_b.clearBG=function(I_a,I_b,I_c,I_d){var I_e=I_wa.mainContext;I_e.clearColor(I_a,I_b,I_c,I_d),I_e.clear(16384)},I_b._getSubmits=function(){return this._submits},I_b._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var I_a=0,I_b=this._submits._length;I_a<I_b;I_a++)this._submits[I_a].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},I_b.destroy=function(){--I_P._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=I_qa.QuadrangleIB&&this._ib.releaseResource()},I_b.clear=function(){this._submits||(this._other=I_c.DEFAULT,this._curMat=I_B.create(),this._vb=I_ra.create(-1),this._submits=[],this._save=[I_Y.Create(this)],this._save.length=10,this._shader2D=new I_q,this._triangleMesh=I_Ka.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=I_c.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=I_P.MAXCLIPRECT,this._curSubmit=I_fa.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=I_T.DEFAULT;for(var I_a=0,I_b=this._submits._length;I_a<I_b;I_a++)this._submits[I_a].releaseRender(),this._submits[I_a]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},I_b.size=function(I_a,I_b){if(this._width!=I_a||this._height!=I_b)if(0==I_a||0==I_b){0!=this._vb._byteLength&&(this._width=I_a,this._height=I_b,this._vb.clear(),this._vb.upload());for(var I_c=0,I_d=this._submits._length;I_c<I_d;I_c++)this._submits[I_c].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=I_a,this._height=I_b,this._targets&&this._targets.size(I_a,I_b),this._canvas.memorySize-=this._canvas.memorySize;0===I_a&&0===I_b&&this._releaseMem()},I_b._getTransformMatrix=function(){return this._curMat},I_b.translate=function(I_a,I_b){0===I_a&&0===I_b||(I_$.save(this),this._curMat.bTransform&&(I_Z.save(this),this._curMat.transformPointN(I_C.TEMP.setTo(I_a,I_b)),I_a=I_C.TEMP.x,I_b=I_C.TEMP.y),this._x+=I_a,this._y+=I_b)},I_b.save=function(){this._save[this._save._length++]=I_Y.Create(this)},I_b.restore=function(){var I_a=this._save._length;if(!(I_a<1))for(var I_b=I_a-1;0<=I_b;I_b--){var I_c=this._save[I_b];if(I_c.restore(this),I_c.isSaveMark())return void(this._save._length=I_b)}},I_b._fillText=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){void 0===I_j&&(I_j=0);var I_k=this._shader2D,I_l=this._curSubmit.shaderValue,I_m=I_e?I_oa.create(I_e):this._other.font;if(I_Q.enabled)I_k.ALPHA!==I_l.ALPHA&&(I_k.glTexture=null),I_na.drawText(this,I_a,I_b,this._curMat,I_m,I_i||this._other.textAlign,I_f,I_g,I_h,I_c,I_d,I_j);else{this._shader2D.defines.getValue();var I_n=I_f?I_o.create(I_f)._color:I_k.colorAdd;I_k.ALPHA===I_l.ALPHA&&I_n===I_k.colorAdd&&I_l.colorAdd===I_k.colorAdd||(I_k.glTexture=null,I_k.colorAdd=I_n),I_na.drawText(this,I_a,I_b,this._curMat,I_m,I_i||this._other.textAlign,I_f,I_g,I_h,I_c,I_d,I_j)}},I_b.fillWords=function(I_a,I_b,I_c,I_d,I_e,I_f){this._fillText(null,I_a,I_b,I_c,I_d,I_e,null,-1,null,I_f)},I_b.fillBorderWords=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this._fillBorderText(null,I_a,I_b,I_c,I_d,I_e,I_f,I_g,null)},I_b.fillText=function(I_a,I_b,I_c,I_d,I_e,I_f){this._fillText(I_a,null,I_b,I_c,I_d,I_e,null,-1,I_f)},I_b.strokeText=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this._fillText(I_a,null,I_b,I_c,I_d,null,I_e,I_f||1,I_g)},I_b.fillBorderText=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){this._fillBorderText(I_a,null,I_b,I_c,I_d,I_e,I_f,I_g,I_h)},I_b._fillBorderText=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){if(!I_Q.enabled)return this._fillText(I_a,I_b,I_c,I_d,I_e,null,I_g,I_h||1,I_i),void this._fillText(I_a,I_b,I_c,I_d,I_e,I_f,null,-1,I_i);var I_j=this._shader2D,I_k=this._curSubmit.shaderValue;I_j.ALPHA!==I_k.ALPHA&&(I_j.glTexture=null);var I_l=I_e?(I_P._fontTemp.setFont(I_e),I_P._fontTemp):this._other.font;I_na.drawText(this,I_a,I_b,this._curMat,I_l,I_i||this._other.textAlign,I_f,I_g,I_h||1,I_c,I_d,0)},I_b.fillRect=function(I_a,I_b,I_c,I_d,I_e){var I_f=this._vb;if(I_sa.fillRectImgVb(I_f,this._clipRect,I_a,I_b,I_c,I_d,I_K.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var I_g=this._shader2D.fillStyle;I_e&&(this._shader2D.fillStyle=I_T.create(I_e));var I_h=this._shader2D,I_i=this._curSubmit.shaderValue;if(I_h.fillStyle!==I_i.fillStyle||I_h.ALPHA!==I_i.ALPHA){I_h.glTexture=null;var I_j=this._curSubmit=I_fa.createSubmit(this,this._ib,I_f,(I_f._byteLength-64)/32*3,I_Aa.create(2,0));I_j.shaderValue.color=I_h.fillStyle._color._color,I_j.shaderValue.ALPHA=I_h.ALPHA,this._submits[this._submits._length++]=I_j}this._curSubmit._numEle+=6,this._shader2D.fillStyle=I_g}},I_b.fillTexture=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){if(I_a.loaded&&I_a.bitmap&&I_a.source){var I_i=this._vb,I_j=I_a.bitmap.width,I_k=I_a.bitmap.height,I_l=I_a.uv,I_m=I_g.x%I_a.width,I_n=I_g.y%I_a.height;if(I_j!=I_h.w||I_k!=I_h.h){if(!I_h.w&&!I_h.h)switch(I_h.oy=I_h.ox=0,I_f){case"repeat":I_h.width=I_d,I_h.height=I_e;break;case"repeat-x":I_h.width=I_d,I_n<0?I_a.height+I_n>I_e?I_h.height=I_e:I_h.height=I_a.height+I_n:(I_h.oy=I_n,I_a.height+I_n>I_e?I_h.height=I_e-I_n:I_h.height=I_a.height);break;case"repeat-y":I_m<0?I_a.width+I_m>I_d?I_h.width=I_d:I_h.width=I_a.width+I_m:(I_h.ox=I_m,I_a.width+I_m>I_d?I_h.width=I_d-I_m:I_h.width=I_a.width),I_h.height=I_e;break;case"no-repeat":I_m<0?I_a.width+I_m>I_d?I_h.width=I_d:I_h.width=I_a.width+I_m:(I_h.ox=I_m,I_a.width+I_m>I_d?I_h.width=I_d-I_m:I_h.width=I_a.width),I_n<0?I_a.height+I_n>I_e?I_h.height=I_e:I_h.height=I_a.height+I_n:(I_h.oy=I_n,I_a.height+I_n>I_e?I_h.height=I_e-I_n:I_h.height=I_a.height);break;default:I_h.width=I_d,I_h.height=I_e}I_h.w=I_j,I_h.h=I_k,I_h.uv=[0,0,I_h.width/I_j,0,I_h.width/I_j,I_h.height/I_k,0,I_h.height/I_k]}if(I_b+=I_h.ox,I_c+=I_h.oy,I_m-=I_h.ox,I_n-=I_h.oy,I_sa.fillRectImgVb(I_i,this._clipRect,I_b,I_c,I_h.width,I_h.height,I_h.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var I_o=I_Ja.create(this,this._ib,I_i,(I_i._byteLength-64)/32*3,I_Aa.create(256,0)),I_p=(this._submits[this._submits._length++]=I_o).shaderValue;I_p.textureHost=I_a;var I_s=I_l[0]*I_j,I_t=I_l[1]*I_k,I_u=(I_l[2]-I_l[0])*I_j,I_v=(I_l[5]-I_l[3])*I_k,I_w=-I_m/I_j,I_x=-I_n/I_k;I_p.u_TexRange[0]=I_s/I_j,I_p.u_TexRange[1]=I_u/I_j,I_p.u_TexRange[2]=I_t/I_k,I_p.u_TexRange[3]=I_v/I_k,I_p.u_offset[0]=I_w,I_p.u_offset[1]=I_x,I_Q.enabled&&!this._isMain&&I_o.addTexture(I_a,(I_i._byteLength>>2)-16),(this._curSubmit=I_o)._renderType=10017,I_o._numEle+=6}}else this.sprite&&I_y.timer.callLater(this,this._repaintSprite)},I_b.setShader=function(I_a){I_V.save(this,1048576,this._shader2D,!0),this._shader2D.shader=I_a},I_b.setFilters=function(I_a){I_V.save(this,2097152,this._shader2D,!0),this._shader2D.filters=I_a,this._curSubmit=I_fa.RENDERBASE,this._renderKey=0,this._drawCount++},I_b.drawTexture=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this._drawTextureM(I_a,I_b,I_c,I_d,I_e,I_f,I_g,null,1)},I_b.addTextureVb=function(I_a,I_b,I_c){var I_d=this._curSubmit._vb||this._vb,I_e=I_d._byteLength>>2;I_d.byteLength=I_e+16<<2;for(var I_f=I_d.getFloat32Array(),I_g=0;I_g<16;I_g+=4)I_f[I_e++]=I_a[I_g]+I_b,I_f[I_e++]=I_a[I_g+1]+I_c,I_f[I_e++]=I_a[I_g+2],I_f[I_e++]=I_a[I_g+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),I_d._upload=!0},I_b.willDrawTexture=function(I_a,I_b){if(!(I_a.loaded&&I_a.bitmap&&I_a.source))return this.sprite&&I_y.timer.callLater(this,this._repaintSprite),0;var I_c=I_a.bitmap,I_d=I_c.id+this._shader2D.ALPHA*I_b+10016;if(I_d==this._renderKey)return I_d;var I_e=this._shader2D,I_f=I_e.ALPHA,I_g=this._curSubmit.shaderValue;I_e.ALPHA*=I_b,this._renderKey=I_d,this._drawCount++,I_e.glTexture=I_c;var I_h=this._vb,I_i=null,I_j=I_h._byteLength/32*3,I_k=I_g.textureHost&&I_g.textureHost==I_a&&I_g.textureHost.alphaTexture==I_a.alphaTexture;return I_i=I_Ja.create(this,this._ib,I_h,I_j,I_Aa.create(1,0)),(this._submits[this._submits._length++]=I_i).shaderValue.textureHost=I_a,I_i._renderType=10016,I_i._preIsSameTextureShader=10016===this._curSubmit._renderType&&I_e.ALPHA===I_g.ALPHA&&I_k,this._curSubmit=I_i,I_e.ALPHA=I_f,I_d},I_b.drawTextures=function(I_a,I_b,I_c,I_d){if(I_a.loaded&&I_a.bitmap&&I_a.source){var I_e=this._clipRect;if(this._clipRect=I_P.MAXCLIPRECT,this._drawTextureM(I_a,I_b[0],I_b[1],I_a.width,I_a.height,I_c,I_d,null,1)){if(this._clipRect=I_e,I_G.drawCall++,!(I_b.length<4)){for(var I_f=this._curSubmit._vb||this._vb,I_g=this._curMat.a,I_h=this._curMat.d,I_i=2,I_j=I_b.length;I_i<I_j;I_i+=2)I_sa.copyPreImgVb(I_f,(I_b[I_i]-I_b[I_i-2])*I_g,(I_b[I_i+1]-I_b[I_i-1])*I_h),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&I_y.timer.callLater(this,this._repaintSprite)},I_b._drawTextureM=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){if(!I_a.loaded||!I_a.source)return this.sprite&&I_y.timer.callLater(this,this._repaintSprite),!1;var I_j=this._curSubmit._vb||this._vb,I_k=I_a.bitmap;I_b+=I_f,I_c+=I_g,this._drawCount++;var I_l=I_k.id+this._shader2D.ALPHA*I_i+10016;if(I_l!=this._renderKey){this._renderKey=I_l;var I_m=this._curSubmit.shaderValue,I_n=this._shader2D,I_o=I_n.ALPHA;I_n.ALPHA*=I_i,I_n.glTexture=I_k;var I_p=this._vb,I_s=null,I_t=I_p._byteLength/32*3,I_u=I_m.textureHost&&I_m.textureHost==I_a&&I_m.textureHost.alphaTexture==I_a.alphaTexture;I_s=I_Ja.create(this,this._ib,I_p,I_t,I_Aa.create(1,0)),(this._submits[this._submits._length++]=I_s).shaderValue.textureHost=I_a,I_s._renderType=10016,I_s._preIsSameTextureShader=10016===this._curSubmit._renderType&&I_n.ALPHA===I_m.ALPHA&&I_u,this._curSubmit=I_s,I_j=this._curSubmit._vb||this._vb,I_n.ALPHA=I_o}return!!I_sa.fillRectImgVb(I_j,this._clipRect,I_b,I_c,I_d||I_a.width,I_e||I_a.height,I_a.uv,I_h||this._curMat,this._x,this._y,0,0)&&(I_Q.enabled&&!this._isMain&&this._curSubmit.addTexture(I_a,(I_j._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},I_b._repaintSprite=function(){this.sprite&&this.sprite.repaint()},I_b._drawText=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){var I_k=I_a.bitmap;this._drawCount++;var I_l=I_k.id+this._shader2D.ALPHA+10016;if(I_l!=this._renderKey){this._renderKey=I_l;var I_m=this._curSubmit.shaderValue,I_n=this._shader2D;I_n.glTexture=I_k;var I_o=this._vb,I_p=null,I_s=I_o._byteLength/32*3,I_t=I_m.textureHost&&I_m.textureHost==I_a&&I_m.textureHost.alphaTexture==I_a.alphaTexture;(I_p=I_Q.enabled?I_Ja.create(this,this._ib,I_o,I_s,I_Aa.create(1,0)):I_Ja.create(this,this._ib,I_o,I_s,I_$a.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&I_n.ALPHA===I_m.ALPHA&&I_t,(this._submits[this._submits._length++]=I_p).shaderValue.textureHost=I_a,I_p._renderType=10016,this._curSubmit=I_p}I_a.active();var I_u=this._curSubmit._vb||this._vb;I_sa.fillRectImgVb(I_u,this._clipRect,I_b+I_g,I_c+I_h,I_d||I_a.width,I_e||I_a.height,I_a.uv,I_f||this._curMat,this._x,this._y,I_i,I_j,!0)&&(I_Q.enabled&&!this._isMain&&this._curSubmit.addTexture(I_a,(I_u._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},I_b.drawTextureWithTransform=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){if(I_f){var I_j=this._curMat,I_k=this._x,I_l=this._y;(0!==I_g||0!==I_h)&&(this._x=I_g*I_j.a+I_h*I_j.c,this._y=I_h*I_j.d+I_g*I_j.b),I_f&&I_j.bTransform?(I_B.mul(I_f,I_j,I_P._tmpMatrix),(I_f=I_P._tmpMatrix)._checkTransform()):(this._x+=I_j.tx,this._y+=I_j.ty),this._drawTextureM(I_a,I_b,I_c,I_d,I_e,0,0,I_f,I_i),this._x=I_k,this._y=I_l}else this._drawTextureM(I_a,I_b,I_c,I_d,I_e,I_g,I_h,null,I_i)},I_b.fillQuadrangle=function(I_a,I_b,I_c,I_d,I_e){var I_f=this._curSubmit,I_g=this._vb,I_h=this._shader2D,I_i=I_f.shaderValue;if(this._renderKey=0,I_a.bitmap){var I_j=I_a.bitmap;I_h.glTexture==I_j&&I_h.ALPHA===I_i.ALPHA||(I_h.glTexture=I_j,(I_f=this._curSubmit=I_fa.createSubmit(this,this._ib,I_g,I_g._byteLength/32*3,I_Aa.create(1,0))).shaderValue.glTexture=I_j,this._submits[this._submits._length++]=I_f),I_sa.fillQuadrangleImgVb(I_g,I_b,I_c,I_d,I_a.uv,I_e||this._curMat,this._x,this._y)}else I_f.shaderValue.fillStyle&&I_f.shaderValue.fillStyle.equal(I_a)&&I_h.ALPHA===I_i.ALPHA||(I_h.glTexture=null,(I_f=this._curSubmit=I_fa.createSubmit(this,this._ib,I_g,I_g._byteLength/32*3,I_Aa.create(2,0))).shaderValue.defines.add(2),I_f.shaderValue.fillStyle=I_T.create(I_a),this._submits[this._submits._length++]=I_f),I_sa.fillQuadrangleImgVb(I_g,I_b,I_c,I_d,I_K.DEF_UV,I_e||this._curMat,this._x,this._y);I_f._numEle+=6},I_b.drawTexture2=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){if(0!=I_f){var I_i=this._curMat;if(this._x=I_a*I_i.a+I_b*I_i.c,this._y=I_b*I_i.d+I_a*I_i.b,I_e&&(I_e=I_i.bTransform||I_e.bTransform?(I_B.mul(I_e,I_i,I_P._tmpMatrix),I_P._tmpMatrix):(this._x+=I_e.tx+I_i.tx,this._y+=I_e.ty+I_i.ty,I_B.EMPTY)),1!==I_f||I_g){var I_j=this._shader2D.ALPHA,I_k=this._nBlendType;this._shader2D.ALPHA=I_f,I_g&&(this._nBlendType=I_S.TOINT(I_g)),this._drawTextureM(I_h[0],I_h[1]-I_c,I_h[2]-I_d,I_h[3],I_h[4],0,0,I_e,1),this._shader2D.ALPHA=I_j,this._nBlendType=I_k}else this._drawTextureM(I_h[0],I_h[1]-I_c,I_h[2]-I_d,I_h[3],I_h[4],0,0,I_e,1);this._x=this._y=0}},I_b.drawCanvas=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_a.context;if(this._renderKey=0,I_f._targets)this._submits[this._submits._length++]=I_Ia.create(I_f,0,null),this._curSubmit=I_fa.RENDERBASE,I_f._targets.drawTo(this,I_b,I_c,I_d,I_e);else{var I_g=this._submits[this._submits._length++]=I_Ia.create(I_f,this._shader2D.ALPHA,this._shader2D.filters),I_h=I_d/I_a.width,I_i=I_e/I_a.height,I_j=I_g._matrix;this._curMat.copyTo(I_j),1!=I_h&&1!=I_i&&I_j.scale(I_h,I_i);var I_k=I_j.tx,I_l=I_j.ty;I_j.tx=I_j.ty=0,I_j.transformPoint(I_C.TEMP.setTo(I_b,I_c)),I_j.translate(I_C.TEMP.x+I_k,I_C.TEMP.y+I_l),this._curSubmit=I_fa.RENDERBASE}I_z.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=I_f._targets?"yellow":"green",this.strokeRect(I_b-1,I_c-1,I_d+2,I_e+2,1),this.strokeRect(I_b,I_c,I_d,I_e,1),this.restore())},I_b.drawTarget=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){void 0===I_j&&(I_j=-1);var I_k=this._vb;if(I_sa.fillRectImgVb(I_k,this._clipRect,I_b,I_c,I_d,I_e,I_i||I_K.DEF_UV,I_f||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var I_l=this._curSubmit=I_la.create(this,this._ib,I_k,(I_k._byteLength-64)/32*3,I_h,I_g);I_l.blendType=-1==I_j?this._nBlendType:I_j,I_l.scope=I_a,this._submits[this._submits._length++]=I_l,this._curSubmit._numEle+=6}},I_b.mixRGBandAlpha=function(I_a){return this._mixRGBandAlpha(I_a,this._shader2D.ALPHA)},I_b._mixRGBandAlpha=function(I_a,I_b){var I_c=(4278190080&I_a)>>>24;return 0!=I_c?I_c*=I_b:I_c=255*I_b,16777215&I_a|I_c<<24},I_b.drawTriangles=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){if(!I_a.loaded||!I_a.source)return this.sprite&&I_y.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;I_a.bitmap;var I_k=this._mixRGBandAlpha(4294967295,I_h),I_l=(I_d.length,I_f.length);this._renderKey=-1;var I_m=this._curSubmit=I_Ja.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,I_Aa.create(1,0));return I_m.shaderValue.textureHost=I_a,I_m._renderType=10016,this._submits[this._submits._length++]=I_m,I_g?(I_P._tmpMatrix.a=I_g.a,I_P._tmpMatrix.b=I_g.b,I_P._tmpMatrix.c=I_g.c,I_P._tmpMatrix.d=I_g.d,I_P._tmpMatrix.tx=I_g.tx+I_b,I_P._tmpMatrix.ty=I_g.ty+I_c,I_B.mul(I_P._tmpMatrix,this._curMat,I_P._tmpMatrix)):(I_P._tmpMatrix.a=this._curMat.a,I_P._tmpMatrix.b=this._curMat.b,I_P._tmpMatrix.c=this._curMat.c,I_P._tmpMatrix.d=this._curMat.d,I_P._tmpMatrix.tx=this._curMat.tx+I_b,I_P._tmpMatrix.ty=this._curMat.ty+I_c),this._triangleMesh.addData(I_d,I_e,I_f,I_P._tmpMatrix,I_k,this),this._curSubmit._numEle+=I_l,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},I_b.transform=function(I_a,I_b,I_c,I_d,I_e,I_f){I_Z.save(this),I_B.mul(I_B.TEMP.setTo(I_a,I_b,I_c,I_d,I_e,I_f),this._curMat,this._curMat),this._curMat._checkTransform()},I_b.setTransformByMatrix=function(I_a){I_a.copyTo(this._curMat)},I_b.transformByMatrix=function(I_a){I_Z.save(this),I_B.mul(I_a,this._curMat,this._curMat),this._curMat._checkTransform()},I_b.rotate=function(I_a){I_Z.save(this),this._curMat.rotateEx(I_a)},I_b.scale=function(I_a,I_b){I_Z.save(this),this._curMat.scaleEx(I_a,I_b)},I_b.clipRect=function(I_a,I_b,I_c,I_d){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var I_e=I_ka.create(4);this.addRenderObject(I_e);var I_f=this._vb,I_g=I_f._byteLength>>2;if(I_sa.fillRectImgVb(I_f,null,I_a,I_b,I_c,I_d,I_K.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var I_h=this._curSubmit=I_fa.createSubmit(this,this._ib,I_f,(I_f._byteLength-64)/32*3,I_Aa.create(2,0));I_h.shaderValue.ALPHA=1,this._submits[this._submits._length++]=I_h,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var I_i=I_ka.create(5);this.addRenderObject(I_i);var I_j=I_f.getFloat32Array(),I_k=Math.min(Math.min(Math.min(I_j[0+I_g],I_j[4+I_g]),I_j[8+I_g]),I_j[12+I_g]),I_l=Math.max(Math.max(Math.max(I_j[0+I_g],I_j[4+I_g]),I_j[8+I_g]),I_j[12+I_g]),I_m=Math.min(Math.min(Math.min(I_j[1+I_g],I_j[5+I_g]),I_j[9+I_g]),I_j[13+I_g]),I_n=Math.max(Math.max(Math.max(I_j[1+I_g],I_j[5+I_g]),I_j[9+I_g]),I_j[13+I_g]);I_X.save(this,I_i,I_a,I_b,I_c,I_d,I_k,I_m,I_l-I_k,I_n-I_m),this._curSubmit=I_fa.RENDERBASE}else{I_c*=this._curMat.a,I_d*=this._curMat.d;var I_o=I_C.TEMP;this._curMat.transformPoint(I_o.setTo(I_a,I_b)),I_c<0&&(I_o.x=I_o.x+I_c,I_c=-I_c),I_d<0&&(I_o.y=I_o.y+I_d,I_d=-I_d),this._renderKey=0;var I_p=this._curSubmit=I_ja.create(this);(this._submits[this._submits._length++]=I_p).submitIndex=this._submits._length,I_p.submitLength=9999999,I_W.save(this,I_p);var I_s=this._clipRect,I_t=I_s.x,I_u=I_s.y,I_v=I_o.x+I_c,I_w=I_o.y+I_d;I_t<I_o.x&&(I_s.x=I_o.x),I_u<I_o.y&&(I_s.y=I_o.y),I_s.width=Math.min(I_v,I_t+I_s.width)-I_s.x,I_s.height=Math.min(I_w,I_u+I_s.height)-I_s.y,this._shader2D.glTexture=null,I_p.clipRect.copyFrom(I_s),this._curSubmit=I_fa.RENDERBASE}},I_b.setIBVB=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k){if(void 0===I_i&&(I_i=0),void 0===I_j&&(I_j=0),void 0===I_k&&(I_k=0),null===I_c){if(I_t.isFlash){var I_l=I_d;I_l._selfIB||(I_l._selfIB=I_qa.create(35044)),I_l._selfIB.clear(),I_c=I_l._selfIB}else I_c=this._ib;I_sa.expandIBQuadrangle(I_c,I_d._byteLength/(4*I_d.vertexStride*4))}if(!I_h||!I_g)throw Error("setIBVB must input:shader shaderValues");var I_m=I_ia.create(this,I_d,I_c,I_e,I_g,I_h,I_i,I_j,I_k);I_f||(I_f=I_B.EMPTY),I_f.translate(I_a,I_b),I_B.mul(I_f,this._curMat,I_m._mat),I_f.translate(-I_a,-I_b),this._submits[this._submits._length++]=I_m,this._curSubmit=I_fa.RENDERBASE,this._renderKey=0},I_b.addRenderObject=function(I_a){this._submits[this._submits._length++]=I_a},I_b.fillTrangles=function(I_a,I_b,I_c,I_d,I_e){var I_f=this._curSubmit,I_g=this._vb,I_h=this._shader2D,I_i=I_f.shaderValue,I_j=I_d.length>>4,I_k=I_a.bitmap;this._renderKey=0,I_h.glTexture==I_k&&I_h.ALPHA===I_i.ALPHA||((I_f=this._curSubmit=I_fa.createSubmit(this,this._ib,I_g,I_g._byteLength/32*3,I_Aa.create(1,0))).shaderValue.textureHost=I_a,this._submits[this._submits._length++]=I_f),I_sa.fillTranglesVB(I_g,I_b,I_c,I_d,I_e||this._curMat,this._x,this._y),I_f._numEle+=6*I_j},I_b.submitElement=function(I_a,I_b){var I_c=this._submits;for(I_b<0&&(I_b=I_c._length);I_a<I_b;)I_a+=I_c[I_a].renderSubmit()},I_b.finish=function(){I_wa.mainContext.finish()},I_b.flush=function(){var I_a=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(I_a>this._ib.bufferLength/12&&I_sa.expandIBQuadrangle(this._ib,I_a),!this._isMain&&I_Q.enabled&&I_Q._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=I_Q._atlasRestore;for(var I_b=this._submits,I_c=0,I_d=I_b._length;I_c<I_d;I_c++){var I_e=I_b[I_c];10016===I_e.getRenderType()&&I_e.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),I_ba.instance&&I_ba.getInstance().reset();var I_f;for(I_c=0,I_f=this.meshlist.length;I_c<I_f;I_c++){var I_g=this.meshlist[I_c];I_g.canReuse?I_g.releaseMesh():I_g.destroy()}return this.meshlist.length=0,this._curSubmit=I_fa.RENDERBASE,this._renderKey=0,this._triangleMesh=I_Ka.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},I_b.setPathId=function(I_a){if(this.mId=I_a,-1!=this.mId){this.mHaveKey=!1;var I_b=I_M.getInstance();I_b.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,I_b.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},I_b.movePath=function(I_a,I_b){var I_c=I_a,I_d=I_b;I_a=this._curMat.a*I_c+this._curMat.c*I_d+this._curMat.tx,I_b=this._curMat.b*I_c+this._curMat.d*I_d+this._curMat.ty,this.mX+=I_a,this.mY+=I_b},I_b.beginPath=function(){var I_a=this._getPath();I_a.tempArray.length=0,I_a.closePath=!1,this.mX=0,this.mY=0},I_b.closePath=function(){this._path.closePath=!0},I_b.fill=function(I_a){void 0===I_a&&(I_a=!1);var I_b=this._getPath();this.drawPoly(0,0,I_b.tempArray,this.fillStyle._color.numColor,0,0,I_a)},I_b.stroke=function(){var I_a=this._getPath();if(0<this.lineWidth){if(-1==this.mId)I_a.drawLine(0,0,I_a.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var I_b=I_M.getInstance().shapeLineDic[this.mId];I_b.rebuild(I_a.tempArray),I_a.setGeomtry(I_b)}else I_M.getInstance().addLine(this.mId,I_a.drawLine(0,0,I_a.tempArray,this.lineWidth,this.strokeStyle._color.numColor));I_a.update();var I_c=[this.mX,this.mY],I_d=I_fa.createShape(this,I_a.ib,I_a.vb,I_a.count,I_a.offset,I_Aa.create(4,0));I_d.shaderValue.ALPHA=this._shader2D.ALPHA,I_d.shaderValue.u_pos=I_c,I_d.shaderValue.u_mmat2=I_ua.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=I_d,this._renderKey=-1}},I_b.line=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=this._curSubmit,I_h=this._vb;if(I_sa.fillLineVb(I_h,this._clipRect,I_a,I_b,I_c,I_d,I_e,I_f)){this._renderKey=0;var I_i=this._shader2D,I_j=I_g.shaderValue;I_i.strokeStyle===I_j.strokeStyle&&I_i.ALPHA===I_j.ALPHA||(I_i.glTexture=null,(I_g=this._curSubmit=I_fa.createSubmit(this,this._ib,I_h,(I_h._byteLength-64)/32*3,I_Aa.create(2,0))).shaderValue.strokeStyle=I_i.strokeStyle,I_g.shaderValue.mainID=2,I_g.shaderValue.ALPHA=I_i.ALPHA,this._submits[this._submits._length++]=I_g),I_g._numEle+=6}},I_b.moveTo=function(I_a,I_b,I_c){void 0===I_c&&(I_c=!0);var I_d=this._getPath();if(I_c){var I_e=I_a,I_f=I_b;I_a=this._curMat.a*I_e+this._curMat.c*I_f,I_b=this._curMat.b*I_e+this._curMat.d*I_f}I_d.addPoint(I_a,I_b)},I_b.lineTo=function(I_a,I_b,I_c){void 0===I_c&&(I_c=!0);var I_d=this._getPath();if(I_c){var I_e=I_a,I_f=I_b;I_a=this._curMat.a*I_e+this._curMat.c*I_f,I_b=this._curMat.b*I_e+this._curMat.d*I_f}I_d.addPoint(I_a,I_b)},I_b.drawCurves=function(I_a,I_b,I_c){this.setPathId(-1),this.beginPath(),this.strokeStyle=I_c[3],this.lineWidth=I_c[4];var I_d=I_c[2];I_a+=I_c[0],I_b+=I_c[1],this.movePath(I_a,I_b),this.moveTo(I_d[0],I_d[1]);for(var I_e=2,I_f=I_d.length;I_e<I_f;)this.quadraticCurveTo(I_d[I_e++],I_d[I_e++],I_d[I_e++],I_d[I_e++]);this.stroke()},I_b.arcTo=function(I_a,I_b,I_c,I_d,I_e){if(-1==this.mId||!this.mHaveKey){var I_f=0,I_g=0,I_h=0,I_i=this._getPath();this._curMat.copyTo(I_P._tmpMatrix),I_P._tmpMatrix.tx=I_P._tmpMatrix.ty=0,I_P._tempPoint.setTo(I_i.getEndPointX(),I_i.getEndPointY()),I_P._tmpMatrix.invertTransformPoint(I_P._tempPoint);var I_j=I_P._tempPoint.x-I_a,I_k=I_P._tempPoint.y-I_b,I_l=Math.sqrt(I_j*I_j+I_k*I_k);if(!(I_l<=1e-6)){var I_m=I_j/I_l,I_n=I_k/I_l,I_o=I_c-I_a,I_p=I_d-I_b,I_s=I_o*I_o+I_p*I_p,I_t=Math.sqrt(I_s);if(!(I_t<=1e-6)){var I_u=I_o/I_t,I_v=I_p/I_t,I_w=I_m+I_u,I_x=I_n+I_v,I_y=Math.sqrt(I_w*I_w+I_x*I_x);if(!(I_y<=1e-6)){var I_z=I_w/I_y,I_A=I_x/I_y,I_B=Math.acos(I_z*I_m+I_A*I_n),I_C=Math.PI/2-I_B,I_D=(I_l=I_e/Math.tan(I_C))*I_m+I_a,I_E=I_l*I_n+I_b,I_F=Math.sqrt(I_l*I_l+I_e*I_e),I_G=I_a+I_z*I_F,I_H=I_b+I_A*I_F,I_I=0,I_J=0;if(0<=I_m*I_v-I_n*I_u){var I_K=2*I_C/I_P.SEGNUM;I_I=Math.sin(I_K),I_J=Math.cos(I_K)}else I_K=2*-I_C/I_P.SEGNUM,I_I=Math.sin(I_K),I_J=Math.cos(I_K);I_g=this._curMat.a*I_D+this._curMat.c*I_E,I_h=this._curMat.b*I_D+this._curMat.d*I_E,I_g==this._path.getEndPointX()&&I_h==this._path.getEndPointY()||I_i.addPoint(I_g,I_h);var I_L=I_D-I_G,I_M=I_E-I_H;for(I_f=0;I_f<I_P.SEGNUM;I_f++){var I_N=I_L*I_J+I_M*I_I,I_O=-I_L*I_I+I_M*I_J;I_g=I_N+I_G,I_h=I_O+I_H,I_a=this._curMat.a*I_g+this._curMat.c*I_h,I_h=I_b=this._curMat.b*I_g+this._curMat.d*I_h,(I_g=I_a)==this._path.getEndPointX()&&I_h==this._path.getEndPointY()||I_i.addPoint(I_g,I_h),I_L=I_N,I_M=I_O}}}}}},I_b.arc=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){if(void 0===I_f&&(I_f=!1),void 0===I_g&&(I_g=!0),-1!=this.mId){var I_h=I_M.getInstance().shapeDic[this.mId];if(I_h&&this.mHaveKey&&!I_h.needUpdate(this._curMat))return;I_b=I_a=0}var I_i,I_j=0,I_k=0,I_l=0,I_m=0,I_n=0,I_o=0,I_p=0;if(I_k=I_e-I_d,I_f)if(Math.abs(I_k)>=2*Math.PI)I_k=2*-Math.PI;else for(;0<I_k;)I_k-=2*Math.PI;else if(Math.abs(I_k)>=2*Math.PI)I_k=2*Math.PI;else for(;I_k<0;)I_k+=2*Math.PI;I_i=I_k/(I_p=I_c<101?Math.max(10,I_k*I_c/5):I_c<201?Math.max(10,I_k*I_c/20):Math.max(10,I_k*I_c/40))/2,I_l=Math.abs(4/3*(1-Math.cos(I_i))/Math.sin(I_i)),I_f&&(I_l=-I_l);var I_s=this._getPath(),I_t=NaN,I_u=NaN;for(I_o=0;I_o<=I_p;I_o++)I_j=I_d+I_k*(I_o/I_p),I_m=I_a+Math.cos(I_j)*I_c,I_n=I_b+Math.sin(I_j)*I_c,I_g&&(I_t=I_m,I_u=I_n,I_m=this._curMat.a*I_t+this._curMat.c*I_u,I_n=this._curMat.b*I_t+this._curMat.d*I_u),I_m==this._path.getEndPointX()&&I_n==this._path.getEndPointY()||I_s.addPoint(I_m,I_n);I_m=I_a+Math.cos(I_e)*I_c,I_n=I_b+Math.sin(I_e)*I_c,I_g&&(I_t=I_m,I_u=I_n,I_m=this._curMat.a*I_t+this._curMat.c*I_u,I_n=this._curMat.b*I_t+this._curMat.d*I_u),I_m==this._path.getEndPointX()&&I_n==this._path.getEndPointY()||I_s.addPoint(I_m,I_n)},I_b.quadraticCurveTo=function(I_a,I_b,I_c,I_d){var I_e=I_l.I,I_f=I_c,I_g=I_d;I_c=this._curMat.a*I_f+this._curMat.c*I_g,I_d=this._curMat.b*I_f+this._curMat.d*I_g,I_f=I_a,I_g=I_b,I_a=this._curMat.a*I_f+this._curMat.c*I_g,I_b=this._curMat.b*I_f+this._curMat.d*I_g;for(var I_h=I_e.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),I_a,I_b,I_c,I_d],30,2),I_i=0,I_j=I_h.length/2;I_i<I_j;I_i++)this.lineTo(I_h[2*I_i],I_h[2*I_i+1],!1);this.lineTo(I_c,I_d,!1)},I_b.rect=function(I_a,I_b,I_c,I_d){this._other=this._other.make(),this._other.path||(this._other.path=new I_U),this._other.path.rect(I_a,I_b,I_c,I_d)},I_b.strokeRect=function(I_a,I_b,I_c,I_d,I_e){var I_f=.5*I_e;this.line(I_a-I_f,I_b,I_a+I_c+I_f,I_b,I_e,this._curMat),this.line(I_a+I_c,I_b,I_a+I_c,I_b+I_d,I_e,this._curMat),this.line(I_a,I_b,I_a,I_b+I_d,I_e,this._curMat),this.line(I_a-I_f,I_b+I_d,I_a+I_c+I_f,I_b+I_d,I_e,this._curMat)},I_b.clip=function(){},I_b.drawPoly=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){void 0===I_g&&(I_g=!1),this._renderKey=0,this._shader2D.glTexture=null;var I_h=this._getPath();if(-1==this.mId)I_h.polygon(I_a,I_b,I_c,I_d,I_e||1,I_f);else if(this.mHaveKey){var I_i=I_M.getInstance().shapeDic[this.mId];I_i.setMatrix(this._curMat),I_i.rebuild(I_h.tempArray),I_h.setGeomtry(I_i)}else{var I_j=I_h.polygon(I_a,I_b,I_c,I_d,I_e||1,I_f);I_M.getInstance().addShape(this.mId,I_j),I_j.setMatrix(this._curMat)}I_h.update();var I_k,I_l=[this.mX,this.mY];if((I_k=I_fa.createShape(this,I_h.ib,I_h.vb,I_h.count,I_h.offset,I_Aa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,I_k.shaderValue.u_pos=I_l,I_k.shaderValue.u_mmat2=I_ua.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=I_k,0<I_e){if(this.mHaveLineKey){var I_m=I_M.getInstance().shapeLineDic[this.mId];I_m.rebuild(I_h.tempArray),I_h.setGeomtry(I_m)}else I_M.getInstance().addShape(this.mId,I_h.drawLine(I_a,I_b,I_c,I_e,I_f));I_h.update(),(I_k=I_fa.createShape(this,I_h.ib,I_h.vb,I_h.count,I_h.offset,I_Aa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,I_k.shaderValue.u_mmat2=I_ua.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=I_k}},I_b.drawParticle=function(I_a,I_b,I_c){I_c.x=I_a,I_c.y=I_b,this._submits[this._submits._length++]=I_c},I_b._getPath=function(){return this._path||(this._path=new I_U)},I_d(0,I_b,"globalCompositeOperation",function(){return I_S.NAMES[this._nBlendType]},function(I_a){var I_b=I_S.TOINT[I_a];null==I_b||this._nBlendType===I_b||(I_V.save(this,65536,this,!0),this._curSubmit=I_fa.RENDERBASE,this._renderKey=0,this._nBlendType=I_b)}),I_d(0,I_b,"strokeStyle",function(){return this._shader2D.strokeStyle},function(I_a){this._shader2D.strokeStyle.equal(I_a)||(I_V.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=I_T.create(I_a))}),I_d(0,I_b,"globalAlpha",function(){return this._shader2D.ALPHA},function(I_a){(I_a=Math.floor(1e3*I_a)/1e3)!=this._shader2D.ALPHA&&(I_V.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=I_a)}),I_d(0,I_b,"asBitmap",null,function(I_a){if(I_a){if(this._targets||(this._targets=new I__),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),I_d(0,I_b,"fillStyle",function(){return this._shader2D.fillStyle},function(I_a){this._shader2D.fillStyle.equal(I_a)||(I_V.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=I_T.create(I_a))}),I_d(0,I_b,"textAlign",function(){return this._other.textAlign},function(I_a){this._other.textAlign===I_a||(this._other=this._other.make(),I_V.save(this,32768,this._other,!1),this._other.textAlign=I_a)}),I_d(0,I_b,"lineWidth",function(){return this._other.lineWidth},function(I_a){this._other.lineWidth===I_a||(this._other=this._other.make(),I_V.save(this,256,this._other,!1),this._other.lineWidth=I_a)}),I_d(0,I_b,"textBaseline",function(){return this._other.textBaseline},function(I_a){this._other.textBaseline===I_a||(this._other=this._other.make(),I_V.save(this,16384,this._other,!1),this._other.textBaseline=I_a)}),I_d(0,I_b,"font",null,function(I_a){I_a!=this._other.font.toString()&&(this._other=this._other.make(),I_V.save(this,8,this._other,!1),this._other.font===I_oa.EMPTY?this._other.font=new I_oa(I_a):this._other.font.setFont(I_a))}),I_P.__init__=function(){I_c.DEFAULT=new I_c},I_P._tempPoint=new I_C,I_P._SUBMITVBSIZE=32e3,I_P._MAXSIZE=99999999,I_P._RECTVBSIZE=16,I_P.MAXCLIPRECT=new I_D(0,0,99999999,99999999),I_P._COUNT=0,I_P._tmpMatrix=new I_B,I_P.SEGNUM=32,I_P._contextcount=0,I_g(I_P,["_fontTemp",function(){return this._fontTemp=new I_oa},"_drawStyleTemp",function(){return this._drawStyleTemp=new I_T(null)}]),I_P.__init$=function(){I_c=function(){function I_a(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=I_oa.EMPTY}I_m(I_a,"");var I_b=I_a.prototype;return I_b.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=I_oa.EMPTY},I_b.make=function(){return this===I_a.DEFAULT?new I_a:this},I_a.DEFAULT=null,I_a}()},I_P}(),I_Aa=function(I_a){function I_d(I_a,I_b){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,I_d.__super.call(this),this.defines=new I_Ea,this.position=I_d._POSITION,this.mainID=I_a,this.subID=I_b,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=I_a|I_b,this._inClassCache=I_d._cache[this._cacheID],0<I_a&&!this._inClassCache&&(this._inClassCache=I_d._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}I_m(I_d,"laya.webgl.shader.d2.value.Value2D",I_O);var I_b=I_d.prototype;return I_b.setValue=function(I_a){},I_b.refresh=function(){var I_a=this.size;return I_a[0]=I_ua.width,I_a[1]=I_ua.height,this.alpha=this.ALPHA*I_ua.worldAlpha,this.mmat=I_ua.worldMatrix4,this},I_b._ShaderWithCompile=function(){return I_Ya.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,I__a.create)},I_b._withWorldShaderDefines=function(){var I_a=I_ua.worldShaderDefines,I_b=I_Ya.sharders[this.mainID|this.defines._value|I_a.getValue()];if(!I_b){var I_c,I_d={};for(I_c in this.defines.toNameDic())I_d[I_c]="";for(I_c in I_a.toNameDic())I_d[I_c]="";I_b=I_Ya.withCompile2D(0,this.mainID,I_d,this.mainID|this.defines._value|I_a.getValue(),I__a.create)}var I_e=I_ua.worldFilters;if(!I_e)return I_b;for(var I_f,I_g=I_e.length,I_h=0;I_h<I_g;I_h++)(I_f=I_e[I_h])&&I_f.action.setValue(this);return I_b},I_b.upload=function(){var I_a=I_ua;this.alpha=this.ALPHA*I_a.worldAlpha,I_ua.worldMatrix4!==I_ua.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),I_wa.shaderHighPrecision&&this.defines.add(1024);var I_b,I_c=I_a.worldShaderDefines?this._withWorldShaderDefines():I_Ya.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=I_a.width,this.size[1]=I_a.height,this.mmat=I_a.worldMatrix4,I_La.activeShader!==I_c?I_c._shaderValueWidth!==I_a.width||I_c._shaderValueHeight!==I_a.height?(I_c._shaderValueWidth=I_a.width,I_c._shaderValueHeight=I_a.height):I_b=I_c._params2dQuick2||I_c._make2dQuick2():I_c._shaderValueWidth!==I_a.width||I_c._shaderValueHeight!==I_a.height?(I_c._shaderValueWidth=I_a.width,I_c._shaderValueHeight=I_a.height):I_b=I_c._params2dQuick1||I_c._make2dQuick1(),I_c.upload(this,I_b)},I_b.setFilters=function(I_a){if(this.filters=I_a)for(var I_b,I_c=I_a.length,I_d=0;I_d<I_c;I_d++)(I_b=I_a[I_d])&&(this.defines.add(I_b.type),I_b.action.setValue(this))},I_b.clear=function(){this.defines.setValue(this.subID)},I_b.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},I_d._initone=function(I_a,I_b){I_d._typeClass[I_a]=I_b,I_d._cache[I_a]=[],I_d._cache[I_a]._length=0},I_d.__init__=function(){I_d._POSITION=[2,5126,!1,4*I_pa.BYTES_PE,0],I_d._TEXCOORD=[2,5126,!1,4*I_pa.BYTES_PE,2*I_pa.BYTES_PE],I_d._initone(2,I_Pa),I_d._initone(4,I_Sa),I_d._initone(256,I_Qa),I_d._initone(512,I_Oa),I_d._initone(1,I_Ra),I_d._initone(65,I_$a),I_d._initone(9,I_Ra)},I_d.create=function(I_a,I_b){var I_c=I_d._cache[I_a|I_b];return I_c._length?I_c[--I_c._length]:new I_d._typeClass[I_a|I_b](I_b)},I_d._POSITION=null,I_d._TEXCOORD=null,I_d._cache=[],I_d._typeClass=[],I_d.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],I_d}(),I_Ba=function(I_a){function I_s(I_a,I_b){I_s.__super.call(this,I_a,I_b)}I_m(I_s,"laya.webgl.utils.RenderSprite3D",I_u);var I_b=I_s.prototype;return I_b.onCreate=function(I_a){switch(I_a){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},I_b._mask=function(I_a,I_b,I_c,I_d){var I_e,I_f,I_g=this._next,I_h=I_a.mask;if(I_h){I_b.ctx.save();var I_i=I_b.ctx.globalCompositeOperation,I_j=new I_D;if(I_j.copyFrom(I_h.getBounds()),I_j.width=Math.round(I_j.width),I_j.height=Math.round(I_j.height),I_j.x=Math.round(I_j.x),I_j.y=Math.round(I_j.y),0<I_j.width&&0<I_j.height){var I_k=I_a._style._tf,I_l=I_ha.create();I_l.addValue("bounds",I_j),I_e=I_ga.create([I_l,I_b],laya.webgl.utils.RenderSprite3D.tmpTarget),I_b.addRenderObject(I_e),I_h.render(I_b,-I_j.x,-I_j.y),I_e=I_ga.create([I_l],laya.webgl.utils.RenderSprite3D.endTmpTarget),I_b.addRenderObject(I_e),I_b.ctx.save(),I_b.clipRect(I_c-I_k.translateX+I_j.x,I_d-I_k.translateY+I_j.y,I_j.width,I_j.height),I_g._fun.call(I_g,I_a,I_b,I_c,I_d),I_b.ctx.restore(),I_f=I_ka.create(6),I_i=I_b.ctx.globalCompositeOperation,I_f.blendMode="mask",I_b.addRenderObject(I_f),I_B.TEMP.identity();var I_m=I_Aa.create(1,0),I_n=I_K.INV_UV,I_o=I_j.width,I_p=I_j.height;(I_j.width<32||I_j.height<32)&&((I_n=I_s.tempUV)[0]=0,I_n[1]=0,I_n[2]=32<=I_j.width?1:I_j.width/32,I_n[3]=0,I_n[4]=32<=I_j.width?1:I_j.width/32,I_n[5]=32<=I_j.height?1:I_j.height/32,I_n[6]=0,I_n[7]=32<=I_j.height?1:I_j.height/32,I_j.width=32<=I_j.width?I_j.width:32,I_j.height=32<=I_j.height?I_j.height:32,I_n[1]*=-1,I_n[3]*=-1,I_n[5]*=-1,I_n[7]*=-1,I_n[1]+=1,I_n[3]+=1,I_n[5]+=1,I_n[7]+=1),I_b.ctx.drawTarget(I_l,I_c+I_j.x-I_k.translateX,I_d+I_j.y-I_k.translateY,I_o,I_p,I_B.TEMP,"tmpTarget",I_m,I_n,6),I_e=I_ga.create([I_l],laya.webgl.utils.RenderSprite3D.recycleTarget),I_b.addRenderObject(I_e),(I_f=I_ka.create(6)).blendMode=I_i,I_b.addRenderObject(I_f)}I_b.ctx.restore()}else I_g._fun.call(I_g,I_a,I_b,I_c,I_d)},I_b._blend=function(I_a,I_b,I_c,I_d){var I_e=I_a._style,I_f=this._next;I_e.blendMode?(I_b.ctx.save(),I_b.ctx.globalCompositeOperation=I_e.blendMode,I_f._fun.call(I_f,I_a,I_b,I_c,I_d),I_b.ctx.restore()):I_f._fun.call(I_f,I_a,I_b,I_c,I_d)},I_b._transform=function(I_a,I_b,I_c,I_d){var I_e=I_a.transform,I_f=this._next;if(I_e&&I_f!=I_u.NORENDER){var I_g=I_b.ctx;I_a._style;I_e.tx=I_c,I_e.ty=I_d;var I_h=I_g._getTransformMatrix(),I_i=I_h.clone();I_B.mul(I_e,I_h,I_h),I_h._checkTransform(),I_e.tx=I_e.ty=0,I_f._fun.call(I_f,I_a,I_b,0,0),I_i.copyTo(I_h),I_i.destroy()}else I_f._fun.call(I_f,I_a,I_b,I_c,I_d)},I_s.tmpTarget=function(I_a,I_b){var I_c=I_a.getValue("bounds"),I_d=I_Ma.create(I_c.width,I_c.height);I_d.start(),I_d.clear(0,0,0,0),I_a.addValue("tmpTarget",I_d)},I_s.endTmpTarget=function(I_a){I_a.getValue("tmpTarget").end()},I_s.recycleTarget=function(I_a){I_a.getValue("tmpTarget").recycle(),I_a.recycle()},I_g(I_s,["tempUV",function(){return this.tempUV=new Array(8)}]),I_s}(),I_Ca=function(I_a){function I_b(){this.data=null,I_b.__super.call(this)}I_m(I_b,"laya.filters.webgl.ColorFilterActionGL",I_N);var I_c=I_b.prototype;return I_y.imps(I_c,{"laya.filters.IFilterActionGL":!0}),I_c.setValue=function(I_a){I_a.colorMat=this.data._mat,I_a.colorAlpha=this.data._alpha},I_c.apply3d=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_a.getValue("bounds"),I_g=I_Aa.create(1,0);I_g.setFilters([this.data]);var I_h=I_B.TEMP;I_h.identity(),I_c.ctx.drawTarget(I_a,0,0,I_f.width,I_f.height,I_h,"src",I_g)},I_b}(),I_Da=function(I_a){function I_f(I_a,I_b,I_c,I_d,I_e){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,I_f.__super.call(this,I_a,I_b,I_e),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new I_Ta,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=I_c,this._atlasCanvas.height=I_d,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}I_m(I_f,"laya.webgl.atlas.Atlaser",I_P);var I_b=I_f.prototype;return I_b.computeUVinAtlasTexture=function(I_a,I_b,I_c,I_d){var I_e=I_Q.atlasTextureWidth,I_f=I_Q.atlasTextureHeight,I_g=I_c/I_e,I_h=I_d/I_f,I_i=(I_c+I_a.bitmap.width)/I_e,I_j=(I_d+I_a.bitmap.height)/I_f,I_k=I_a.bitmap.width/I_e,I_l=I_a.bitmap.height/I_f;I_a.uv=[I_g+I_b[0]*I_k,I_h+I_b[1]*I_l,I_i-(1-I_b[2])*I_k,I_h+I_b[3]*I_l,I_i-(1-I_b[4])*I_k,I_j-(1-I_b[5])*I_l,I_g+I_b[6]*I_k,I_j-(1-I_b[7])*I_l]},I_b.findBitmapIsExist=function(I_a){if(I_a instanceof laya.webgl.resource.WebGLImage){var I_b=I_a,I_c=I_b.url,I_d=this._InAtlasWebGLImagesKey[I_c||I_b.id];if(I_d)return I_d.offsetInfoID}return-1},I_b.addToAtlasTexture=function(I_a,I_b,I_c){if(I_a instanceof laya.webgl.resource.WebGLImage){var I_d=I_a,I_e=I_d.url;this._InAtlasWebGLImagesKey[I_e||I_d.id]={bitmap:I_a,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([I_b,I_c])}this._atlasCanvas.texSubImage2D(I_b,I_c,I_a.atlasSource),I_a.clearAtlasSource()},I_b.addToAtlas=function(I_a,I_b,I_c){I_a._atlasID=this._inAtlasTextureKey.length;var I_d=I_a.uv.slice(),I_e=I_a.bitmap;this._inAtlasTextureKey.push(I_a),this._inAtlasTextureOriUVValue.push(I_d),this._inAtlasTextureBitmapValue.push(I_e),this.computeUVinAtlasTexture(I_a,I_d,I_b,I_c),I_a.bitmap=this._atlasCanvas},I_b.clear=function(){for(var I_a=0,I_b=this._inAtlasTextureKey.length;I_a<I_b;I_a++)this._inAtlasTextureKey[I_a].bitmap=this._inAtlasTextureBitmapValue[I_a],this._inAtlasTextureKey[I_a].uv=this._inAtlasTextureOriUVValue[I_a],this._inAtlasTextureKey[I_a]._atlasID=-1,this._inAtlasTextureKey[I_a].bitmap.lock=!1,this._inAtlasTextureKey[I_a].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},I_b.dispose=function(){this.clear(),this._atlasCanvas.destroy()},I_d(0,I_b,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),I_d(0,I_b,"texture",function(){return this._atlasCanvas}),I_d(0,I_b,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),I_f}(),I_Ea=function(I_a){function I_c(){I_c.__super.call(this,I_c.__name2int,I_c.__int2name,I_c.__int2nameMap)}return I_m(I_c,"laya.webgl.shader.d2.ShaderDefines2D",I_r),I_c.__init__=function(){I_c.reg("TEXTURE2D",1),I_c.reg("COLOR2D",2),I_c.reg("PRIMITIVE",4),I_c.reg("GLOW_FILTER",8),I_c.reg("BLUR_FILTER",16),I_c.reg("COLOR_FILTER",32),I_c.reg("COLOR_ADD",64),I_c.reg("WORLDMAT",128),I_c.reg("FILLTEXTURE",256),I_c.reg("FSHIGHPRECISION",1024),I_c.reg("TXTALPHA",2048),I_c.reg("TXTCOMPRESS",4096)},I_c.reg=function(I_a,I_b){I_r._reg(I_a,I_b,I_c.__name2int,I_c.__int2name)},I_c.toText=function(I_a,I_b,I_c){return I_r._toText(I_a,I_b,I_c)},I_c.toInt=function(I_a){return I_r._toInt(I_a,I_c.__name2int)},I_c.TEXTURE2D=1,I_c.COLOR2D=2,I_c.PRIMITIVE=4,I_c.FILTERGLOW=8,I_c.FILTERBLUR=16,I_c.FILTERCOLOR=32,I_c.COLORADD=64,I_c.WORLDMAT=128,I_c.FILLTEXTURE=256,I_c.SKINMESH=512,I_c.SHADERDEFINE_FSHIGHPRECISION=1024,I_c.TXTALPHA=2048,I_c.TXTCOMPRESS=4096,I_c.__name2int={},I_c.__int2name=[],I_c.__int2nameMap=[],I_c}(),I_Fa=(function(I_a){function I_h(I_a,I_b,I_c,I_d,I_e,I_f,I_g){I_h.__super.call(this,I_a,I_b,I_c,I_d,40,I_e,I_f,I_g)}I_m(I_h,"laya.webgl.shapes.Ellipse",I_ca)}(),function(I_a){function I_f(I_a,I_b,I_c,I_d,I_e){this._points=[],this.rebuild(I_c),I_f.__super.call(this,I_a,I_b,0,0,0,I_e,I_d,I_e,0)}I_m(I_f,"laya.webgl.shapes.Line",I_ca);var I_b=I_f.prototype;return I_b.rebuild=function(I_a){var I_b=I_a.length;I_b!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(I_b/2-1)),this.mFloat32Array=new Float32Array(5*I_b)),this._points.length=0;for(var I_c=NaN,I_d=NaN,I_e=-1,I_f=-1,I_g=I_a.length/2,I_h=0;I_h<I_g;I_h++)I_c=I_a[2*I_h],I_d=I_a[2*I_h+1],(.01<Math.abs(I_e-I_c)||.01<Math.abs(I_f-I_d))&&this._points.push(I_c,I_d),I_e=I_c,I_f=I_d},I_b.getData=function(I_a,I_b,I_c){var I_d=[],I_e=[];0<this.borderWidth&&this.createLine2(this._points,I_d,this.borderWidth,I_c,I_e,this._points.length/2),this.mUint16Array.set(I_d,0),this.mFloat32Array.set(I_e,0),I_a.append(this.mUint16Array),I_b.append(this.mFloat32Array)},I_f}()),I_Ga=function(I_a){function I_l(I_a,I_b,I_c,I_d,I_e){this._points=[];for(var I_f=NaN,I_g=NaN,I_h=-1,I_i=-1,I_j=I_c.length/2-1,I_k=0;I_k<I_j;I_k++)I_f=I_c[2*I_k],I_g=I_c[2*I_k+1],(.01<Math.abs(I_h-I_f)||.01<Math.abs(I_i-I_g))&&this._points.push(I_f,I_g),I_h=I_f,I_i=I_g;I_f=I_c[2*I_j],I_g=I_c[2*I_j+1],I_h=this._points[0],I_i=this._points[1],(.01<Math.abs(I_h-I_f)||.01<Math.abs(I_i-I_g))&&this._points.push(I_f,I_g),I_l.__super.call(this,I_a,I_b,0,0,this._points.length/2,0,I_d,I_e)}I_m(I_l,"laya.webgl.shapes.LoopLine",I_ca);var I_b=I_l.prototype;return I_b.getData=function(I_a,I_b,I_c){if(0<this.borderWidth){for(var I_d=this.color,I_e=(I_d>>16&255)/255,I_f=(I_d>>8&255)/255,I_g=(255&I_d)/255,I_h=[],I_i=0,I_j=0,I_k=[],I_l=Math.floor(this._points.length/2),I_m=0;I_m<I_l;I_m++)I_i=this._points[2*I_m],I_j=this._points[2*I_m+1],I_h.push(this.x+I_i,this.y+I_j,I_e,I_f,I_g);this.createLoopLine(I_h,I_k,this.borderWidth,I_c+I_h.length/5),I_a.append(new Uint16Array(I_k)),I_b.append(new Float32Array(I_h))}},I_b.createLoopLine=function(I_a,I_b,I_c,I_d,I_e,I_f){I_a.length;var I_g=I_a.concat(),I_h=I_e||I_a,I_i=this.borderColor,I_j=(I_i>>16&255)/255,I_k=(I_i>>8&255)/255,I_l=(255&I_i)/255,I_m=[I_g[0],I_g[1]],I_n=[I_g[I_g.length-5],I_g[I_g.length-4]],I_o=I_n[0]+.5*(I_m[0]-I_n[0]),I_p=I_n[1]+.5*(I_m[1]-I_n[1]);I_g.unshift(I_o,I_p,0,0,0),I_g.push(I_o,I_p,0,0,0);var I_s,I_t,I_u,I_v,I_w,I_x,I_y,I_z,I_A,I_B,I_C,I_D,I_E,I_F,I_G,I_H,I_I,I_J,I_K,I_L,I_M=I_g.length/5,I_N=I_d,I_O=I_c/2;I_u=I_g[0],I_v=I_g[1],I_B=I_u-(I_w=I_g[5]),I_A=(I_A=-(I_v-(I_x=I_g[6])))/(I_L=Math.sqrt(I_A*I_A+I_B*I_B))*I_O,I_B=I_B/I_L*I_O,I_h.push(I_u-I_A,I_v-I_B,I_j,I_k,I_l,I_u+I_A,I_v+I_B,I_j,I_k,I_l);for(var I_P=1;I_P<I_M-1;I_P++)I_u=I_g[5*(I_P-1)],I_v=I_g[5*(I_P-1)+1],I_w=I_g[5*I_P],I_x=I_g[5*I_P+1],I_y=I_g[5*(I_P+1)],I_z=I_g[5*(I_P+1)+1],I_B=I_u-I_w,I_D=I_w-I_y,I_G=(-(I_A=(I_A=-(I_v-I_x))/(I_L=Math.sqrt(I_A*I_A+I_B*I_B))*I_O)+I_u)*(-(I_B=I_B/I_L*I_O)+I_x)-(-I_A+I_w)*(-I_B+I_v),I_J=(-(I_C=(I_C=-(I_x-I_z))/(I_L=Math.sqrt(I_C*I_C+I_D*I_D))*I_O)+I_y)*(-(I_D=I_D/I_L*I_O)+I_x)-(-I_C+I_w)*(-I_D+I_z),I_K=(I_E=-I_B+I_v-(-I_B+I_x))*(I_I=-I_C+I_w-(-I_C+I_y))-(I_H=-I_D+I_z-(-I_D+I_x))*(I_F=-I_A+I_w-(-I_A+I_u)),Math.abs(I_K)<.1?(I_K+=10.1,I_h.push(I_w-I_A,I_x-I_B,I_j,I_k,I_l,I_w+I_A,I_x+I_B,I_j,I_k,I_l)):(((I_s=(I_F*I_J-I_I*I_G)/I_K)-I_w)*(I_s-I_w)+((I_t=(I_H*I_G-I_E*I_J)/I_K)-I_x)+(I_t-I_x),I_h.push(I_s,I_t,I_j,I_k,I_l,I_w-(I_s-I_w),I_x-(I_t-I_x),I_j,I_k,I_l));I_f&&(I_b=I_f);var I_Q=this.edges+1;for(I_P=1;I_P<I_Q;I_P++)I_b.push(I_N+2*(I_P-1),I_N+2*(I_P-1)+1,I_N+2*I_P+1,I_N+2*I_P+1,I_N+2*I_P,I_N+2*(I_P-1));return I_b.push(I_N+2*(I_P-1),I_N+2*(I_P-1)+1,I_N+1,I_N+1,I_N,I_N+2*(I_P-1)),I_h},I_l}(),I_Ha=function(I_a){function I_g(I_a,I_b,I_c,I_d,I_e,I_f){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=I_B.create(),this._points=I_c.slice(0,I_c.length),I_g.__super.call(this,I_a,I_b,0,0,this._points.length/2,I_d,I_e,I_f)}I_m(I_g,"laya.webgl.shapes.Polygon",I_ca);var I_b=I_g.prototype;return I_b.rebuild=function(I_a){this._repaint||(this._points.length=0,this._points=this._points.concat(I_a))},I_b.setMatrix=function(I_a){I_a.copyTo(this._mat)},I_b.needUpdate=function(I_a){return this._repaint=this._mat.a==I_a.a&&this._mat.b==I_a.b&&this._mat.c==I_a.c&&this._mat.d==I_a.d&&this._mat.tx==I_a.tx&&this._mat.ty==I_a.ty,!this._repaint},I_b.getData=function(I_a,I_b,I_c){var I_d,I_e=0,I_f=this._points,I_g=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=I_c){for(this._start=I_c,I_d=[],I_g=this.earcutTriangles.length,I_e=0;I_e<I_g;I_e++)I_d.push(this.earcutTriangles[I_e]+I_c);this.mUint16Array=new Uint16Array(I_d)}}else{this._start=I_c,I_d=[];var I_h=[],I_i=[],I_j=this.color,I_k=(I_j>>16&255)/255,I_l=(I_j>>8&255)/255,I_m=(255&I_j)/255;for(I_g=Math.floor(I_f.length/2),I_e=0;I_e<I_g;I_e++)I_h.push(this.x+I_f[2*I_e],this.y+I_f[2*I_e+1],I_k,I_l,I_m),I_i.push(this.x+I_f[2*I_e],this.y+I_f[2*I_e+1]);for(this.earcutTriangles=I_da.earcut(I_i,null,2),I_g=this.earcutTriangles.length,I_e=0;I_e<I_g;I_e++)I_d.push(this.earcutTriangles[I_e]+I_c);this.mUint16Array=new Uint16Array(I_d),this.mFloat32Array=new Float32Array(I_h)}I_a.append(this.mUint16Array),I_b.append(this.mFloat32Array)},I_g}(),I_Ia=function(I_a){function I_f(){this._matrix=new I_B,this._matrix4=I_pa.defaultMatrix4.concat(),I_f.__super.call(this,1e4),this.shaderValue=new I_Aa(0,0)}I_m(I_f,"laya.webgl.submit.SubmitCanvas",I_fa);var I_b=I_f.prototype;return I_b.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var I_a=I_ua.worldAlpha,I_b=I_ua.worldMatrix4,I_c=I_ua.worldMatrix,I_d=I_ua.worldFilters,I_e=I_ua.worldShaderDefines,I_f=this.shaderValue,I_g=this._matrix,I_h=this._matrix4,I_i=I_B.TEMP;return I_B.mul(I_g,I_c,I_i),I_h[0]=I_i.a,I_h[1]=I_i.b,I_h[4]=I_i.c,I_h[5]=I_i.d,I_h[12]=I_i.tx,I_h[13]=I_i.ty,I_ua.worldMatrix=I_i.clone(),I_ua.worldMatrix4=I_h,I_ua.worldAlpha=I_ua.worldAlpha*I_f.alpha,I_f.filters&&I_f.filters.length&&(I_ua.worldFilters=I_f.filters,I_ua.worldShaderDefines=I_f.defines),this._ctx_src.flush(),I_ua.worldAlpha=I_a,I_ua.worldMatrix4=I_b,I_ua.worldMatrix.destroy(),I_ua.worldMatrix=I_c,I_ua.worldFilters=I_d,I_ua.worldShaderDefines=I_e,1},I_b.releaseRender=function(){var I_a=I_f._cache;this._ctx_src=null,I_a[I_a._length++]=this},I_b.getRenderType=function(){return 10003},I_f.create=function(I_a,I_b,I_c){var I_d=I_f._cache._length?I_f._cache[--I_f._cache._length]:new I_f;I_d._ctx_src=I_a;var I_e=I_d.shaderValue;return I_e.alpha=I_b,I_e.defines.setValue(0),I_c&&I_c.length&&I_e.setFilters(I_c),I_d},I_f._cache=((I_f._cache=[])._length=0,I_f._cache),I_f}(),I_Ja=function(I_a){function I_j(I_a){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===I_a&&(I_a=1e4),I_j.__super.call(this,I_a)}I_m(I_j,"laya.webgl.submit.SubmitTexture",I_fa);var I_b=I_j.prototype;return I_b.releaseRender=function(){var I_a=I_j._cache;(I_a[I_a._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},I_b.addTexture=function(I_a,I_b){this._texsID[this._texs.length]=I_a._uvID,this._texs.push(I_a),this._vbPos.push(I_b)},I_b.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var I_a=this.shaderValue.textureHost.bitmap;if(null!==I_a)for(var I_b=this._vb.getFloat32Array(),I_c=0,I_d=this._texs.length;I_c<I_d;I_c++){var I_e=this._texs[I_c];I_e.active();var I_f=I_e.uv;if(this._texsID[I_c]!==I_e._uvID){this._texsID[I_c]=I_e._uvID;var I_g=this._vbPos[I_c];I_b[I_g+2]=I_f[0],I_b[I_g+3]=I_f[1],I_b[I_g+6]=I_f[2],I_b[I_g+7]=I_f[3],I_b[I_g+10]=I_f[4],I_b[I_g+11]=I_f[5],I_b[I_g+14]=I_f[6],I_b[I_g+15]=I_f[7],this._vb.setNeedUpload()}I_e.bitmap!==I_a&&(this._isSameTexture=!1)}}},I_b.renderSubmit=function(){if(0===this._numEle)return I_j._shaderSet=!1,1;var I_a=this.shaderValue.textureHost;if(I_a){var I_b=I_a.source;if(!I_a.bitmap||!I_b)return I_j._shaderSet=!1,1;this.shaderValue.texture=I_b,I_a.alphaTexture&&I_a.alphaTexture.source&&(this.shaderValue.texture1=I_a.alphaTexture.source)}this._vb.bind_upload(this._ib);var I_c=I_wa.mainContext;if(I_S.activeBlendFunction!==this._blendFn&&(I_c.enable(3042),this._blendFn(I_c),I_S.activeBlendFunction=this._blendFn),I_G.drawCall++,I_G.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&I_La.activeShader&&I_j._shaderSet?(I_La.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&I_La.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),I_j._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var I_d=I_a.bitmap,I_e=0,I_f=I_La.activeShader,I_g=0,I_h=this._texs.length;I_g<I_h;I_g++){var I_i=this._texs[I_g];I_i.bitmap===I_d&&I_g+1!==I_h||(I_f.uploadTexture2D(I_i.source),I_c.drawElements(4,6*(I_g-I_e+1),5123,this._startIdx+6*I_e*I_pa.BYTES_PIDX),I_d=I_i.bitmap,I_e=I_g)}else I_c.drawElements(4,this._numEle,5123,this._startIdx);return 1},I_j.create=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_j._cache._length?I_j._cache[--I_j._cache._length]:new I_j;null==I_c&&((I_c=I_f._selfVb||(I_f._selfVb=I_ra.create(-1))).clear(),I_d=0),I_f._ib=I_b,I_f._vb=I_c,I_f._startIdx=I_d*I_pa.BYTES_PIDX,I_f._numEle=0;var I_g=I_a._nBlendType;I_f._blendFn=I_a._targets?I_S.targetFns[I_g]:I_S.fns[I_g],I_f.shaderValue=I_e,I_f.shaderValue.setValue(I_a._shader2D);var I_h=I_a._shader2D.filters;return I_h&&I_f.shaderValue.setFilters(I_h),I_f},I_j._cache=((I_j._cache=[])._length=0,I_j._cache),I_j._shaderSet=!0,I_j}(),I_Ka=function(I_a){function I_t(){I_t.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}I_m(I_t,"laya.webgl.utils.MeshTexture",I_ta);var I_b=I_t.prototype;return I_b.addData=function(I_a,I_b,I_c,I_d,I_e,I_f){for(var I_g=I_a.length/2,I_h=this._vb.needSize(I_g*I_t.const_stride)>>2,I_i=this._vb.getFloat32Array(),I_j=0,I_k=0;I_k<I_g;I_k++){var I_l=I_a[I_j],I_m=I_a[I_j+1],I_n=I_l*I_d.a+I_m*I_d.c+I_d.tx,I_o=I_l*I_d.b+I_m*I_d.d+I_d.ty;I_i[I_h++]=I_n,I_i[I_h++]=I_o,I_i[I_h++]=I_b[I_j],I_i[I_h++]=I_b[I_j+1],I_j+=2}this._vb.setNeedUpload();var I_p=this.vertNum;if(0<I_p){(I_g=I_c.length)>I_t.tmpIdx.length&&(I_t.tmpIdx=new Uint16Array(I_g));for(var I_s=0;I_s<I_g;I_s++)I_t.tmpIdx[I_s]=I_c[I_s]+I_p;this._ib.appendU16Array(I_t.tmpIdx,I_c.length)}else this._ib.append(I_c);this._ib.setNeedUpload(),this.vertNum+=I_g,this.indexNum+=I_c.length},I_b.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},I_b.destroy=function(){this._ib.destroy(),this._vb.destroy()},I_t.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new I_t},I_t.const_stride=16,I_t._POOL=[],I_g(I_t,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),I_t}(),I_La=function(I_a){function I_b(){I_b.__super.call(this),this.lock=!0}return I_m(I_b,"laya.webgl.shader.BaseShader",I_v),I_b.activeShader=null,I_b.bindShader=null,I_b}(),I_Ma=function(I_b){function I_k(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===I_c&&(I_c=6408),void 0===I_d&&(I_d=5121),void 0===I_e&&(I_e=34041),void 0===I_f&&(I_f=!1),void 0===I_g&&(I_g=!1),void 0===I_h&&(I_h=-1),void 0===I_i&&(I_i=-1),this._type=1,this._w=I_a,this._h=I_b,this._surfaceFormat=I_c,this._surfaceType=I_d,this._depthStencilFormat=I_e,I_t.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=I_f,this._repeat=I_g,this._minFifter=I_h,this._magFifter=I_i,this._createWebGLRenderTarget(),this.bitmap.lock=!0,I_k.__super.call(this,this.bitmap,I_K.INV_UV)}I_m(I_k,"laya.webgl.resource.RenderTarget2D",I_b);var I_a=I_k.prototype;return I_y.imps(I_a,{"laya.resource.IDispose":!0}),I_a.getType=function(){return this._type},I_a.getTexture=function(){return this},I_a.size=function(I_a,I_b){this._w==I_a&&this._h==I_b||(this._w=I_a,this._h=I_b,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},I_a.release=function(){this.destroy()},I_a.recycle=function(){I_k.POOL.push(this)},I_a.start=function(){var I_a=I_wa.mainContext;return this._preRenderTarget=I_ua.curRenderTarget,I_ua.curRenderTarget=this,I_a.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(I_a.viewport(0,0,this._w,this._h),this._svWidth=I_ua.width,this._svHeight=I_ua.height,I_ua.width=this._w,I_ua.height=this._h,I_La.activeShader=null),this},I_a.clear=function(I_a,I_b,I_c,I_d){void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=1);var I_e=I_wa.mainContext;I_e.clearColor(I_a,I_b,I_c,I_d);var I_f=16384;switch(this._depthStencilFormat){case 33189:I_f|=256;break;case 36168:I_f|=1024;break;case 34041:I_f|=256,I_f|=1024}I_e.clear(I_f)},I_a.end=function(){var I_a=I_wa.mainContext;I_a.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,I_ua.curRenderTarget=this._preRenderTarget,1==this._type?(I_a.viewport(0,0,this._svWidth,this._svHeight),I_ua.width=this._svWidth,I_ua.height=this._svHeight,I_La.activeShader=null):I_a.viewport(0,0,I_y.stage.width,I_y.stage.height)},I_a.getData=function(I_a,I_b,I_c,I_d){var I_e=I_wa.mainContext;if(I_e.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===I_e.checkFramebufferStatus(36160)))return I_e.bindFramebuffer(36160,null),null;var I_f=new Uint8Array(this._w*this._h*4);return I_e.readPixels(I_a,I_b,I_c,I_d,this._surfaceFormat,this._surfaceType,I_f),I_e.bindFramebuffer(36160,null),I_f},I_a.destroy=function(I_a){void 0===I_a&&(I_a=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,I_b.prototype.destroy.call(this))},I_a.dispose=function(){},I_a._createWebGLRenderTarget=function(){this.bitmap=new I_Wa(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(I_a){this.event("recovered")})},I_d(0,I_a,"surfaceFormat",function(){return this._surfaceFormat}),I_d(0,I_a,"magFifter",function(){return this._magFifter}),I_d(0,I_a,"surfaceType",function(){return this._surfaceType}),I_d(0,I_a,"mipMap",function(){return this._mipMap}),I_d(0,I_a,"depthStencilFormat",function(){return this._depthStencilFormat}),I_d(0,I_a,"minFifter",function(){return this._minFifter}),I_d(0,I_a,"source",function(){return this._alreadyResolved?I_y.superGet(I_K,this,"source"):null}),I_k.create=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){void 0===I_c&&(I_c=6408),void 0===I_d&&(I_d=5121),void 0===I_e&&(I_e=34041),void 0===I_f&&(I_f=!1),void 0===I_g&&(I_g=!1),void 0===I_h&&(I_h=-1),void 0===I_i&&(I_i=-1);var I_j=I_k.POOL.pop();return I_j||(I_j=new I_k(I_a,I_b)),I_j.bitmap&&I_j._w==I_a&&I_j._h==I_b&&I_j._surfaceFormat==I_c&&I_j._surfaceType==I_d&&I_j._depthStencilFormat==I_e&&I_j._mipMap==I_f&&I_j._repeat==I_g&&I_j._minFifter==I_h&&I_j._magFifter==I_i||(I_j._w=I_a,I_j._h=I_b,I_j._surfaceFormat=I_c,I_j._surfaceType=I_d,I_j._depthStencilFormat=I_e,I_t.isConchWebGL&&34041===I_j._depthStencilFormat&&(I_j._depthStencilFormat=33189),I_j._mipMap=I_f,I_j._repeat=I_g,I_j._minFifter=I_h,I_j._magFifter=I_i,I_j.release(),I_j._createWebGLRenderTarget()),I_j},I_k.TYPE2D=1,I_k.TYPE3D=2,I_k.POOL=[],I_k}(I_K),I_Na=function(I_a){function I_b(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,I_b.__super.call(this),I_b._gl=I_wa.mainContext}I_m(I_b,"laya.webgl.utils.Buffer",I_v);var I_c=I_b.prototype;return I_c._bind=function(){this.activeResource(),I_b._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(I_b._bindVertexBuffer=this._glBuffer),I_b._gl.bindBuffer(this._bufferType,I_b._bindActive[this._bufferType]=this._glBuffer),I_La.activeShader=null)},I_c.recreateResource=function(){this._glBuffer||(this._glBuffer=I_b._gl.createBuffer()),this.completeCreate()},I_c.disposeResource=function(){this._glBuffer&&(I_wa.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},I_d(0,I_c,"bufferUsage",function(){return this._bufferUsage}),I_b._gl=null,I_b._bindActive={},I_b._bindVertexBuffer=null,I_b._enableAtributes=[],I_b}(),I_Oa=function(I_a){function I_c(I_a){this.texcoord=null,this.offsetX=300,this.offsetY=0,I_c.__super.call(this,512,0);var I_b=8*I_pa.BYTES_PE;this.position=[2,5126,!1,I_b,0],this.texcoord=[2,5126,!1,I_b,2*I_pa.BYTES_PE],this.color=[4,5126,!1,I_b,4*I_pa.BYTES_PE]}return I_m(I_c,"laya.webgl.shader.d2.skinAnishader.SkinSV",I_Aa),I_c}(),I_Pa=function(I_a){function I_b(I_a){I_b.__super.call(this,2,0),this.color=[]}return I_m(I_b,"laya.webgl.shader.d2.value.Color2dSV",I_Aa),I_b.prototype.setValue=function(I_a){I_a.fillStyle&&(this.color=I_a.fillStyle._color._color),I_a.strokeStyle&&(this.color=I_a.strokeStyle._color._color)},I_b}(),I_Qa=function(I_a){function I_b(I_a){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=I_Aa._TEXCOORD,I_b.__super.call(this,256,0)}I_m(I_b,"laya.webgl.shader.d2.value.FillTextureSV",I_Aa);var I_c=I_b.prototype;return I_c.setValue=function(I_a){this.ALPHA=I_a.ALPHA,I_a.filters&&this.setFilters(I_a.filters)},I_c.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},I_b}(),I_Ra=function(I_a){function I_b(I_a){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=I_Aa._TEXCOORD,void 0===I_a&&(I_a=0),I_b.__super.call(this,1,I_a)}I_m(I_b,"laya.webgl.shader.d2.value.TextureSV",I_Aa);var I_c=I_b.prototype;return I_c.setValue=function(I_a){this.ALPHA=I_a.ALPHA,I_a.filters&&this.setFilters(I_a.filters)},I_c.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},I_b}(),I_Sa=function(I_a){function I_b(I_a){this.a_color=null,this.u_pos=[0,0],I_b.__super.call(this,4,0),this.position=[2,5126,!1,5*I_pa.BYTES_PE,0],this.a_color=[3,5126,!1,5*I_pa.BYTES_PE,2*I_pa.BYTES_PE]}return I_m(I_b,"laya.webgl.shader.d2.value.PrimitiveSV",I_Aa),I_b}(),I_Ta=function(I_a){function I_b(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,I_b.__super.call(this)}I_m(I_b,"laya.webgl.atlas.AtlasWebGLCanvas",I_a);var I_c=I_b.prototype;return I_c.recreateResource=function(){var I_a=I_wa.mainContext,I_b=this._source=I_a.createTexture(),I_c=I_xa.curBindTexTarget,I_d=I_xa.curBindTexValue;I_xa.bindTexture(I_a,3553,I_b),I_a.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),I_a.texParameteri(3553,10241,9729),I_a.texParameteri(3553,10240,9729),I_a.texParameteri(3553,10242,33071),I_a.texParameteri(3553,10243,33071),I_c&&I_d&&I_xa.bindTexture(I_a,I_c,I_d),this.memorySize=this._w*this._h*4,this.completeCreate()},I_c.disposeResource=function(){this._source&&(I_wa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},I_c.texSubImage2D=function(I_a,I_b,I_c){if(I_t.isFlash){this._flashCacheImage||(this._flashCacheImage=I_p.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var I_d=I_c.bitmapdata;this._flashCacheImage._image.copyPixels(I_d,0,0,I_d.width,I_d.height,I_a,I_b),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var I_e=I_wa.mainContext,I_f=I_xa.curBindTexTarget,I_g=I_xa.curBindTexValue;I_xa.bindTexture(I_e,3553,this._source),I_e.pixelStorei(37441,!0),0<=I_a-1&&I_e.texSubImage2D(3553,0,I_a-1,I_b,6408,5121,I_c),I_a+1<=this._w&&I_e.texSubImage2D(3553,0,I_a+1,I_b,6408,5121,I_c),0<=I_b-1&&I_e.texSubImage2D(3553,0,I_a,I_b-1,6408,5121,I_c),I_b+1<=this._h&&I_e.texSubImage2D(3553,0,I_a,I_b+1,6408,5121,I_c),I_e.texSubImage2D(3553,0,I_a,I_b,6408,5121,I_c),I_e.pixelStorei(37441,!1),I_f&&I_g&&I_xa.bindTexture(I_e,I_f,I_g)}},I_c.texSubImage2DPixel=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_wa.mainContext,I_g=I_xa.curBindTexTarget,I_h=I_xa.curBindTexValue;I_xa.bindTexture(I_f,3553,this._source);var I_i=new Uint8Array(I_e.data);I_f.pixelStorei(37441,!0),I_f.texSubImage2D(3553,0,I_a,I_b,I_c,I_d,6408,5121,I_i),I_f.pixelStorei(37441,!1),I_g&&I_h&&I_xa.bindTexture(I_f,I_g,I_h)},I_d(0,I_c,"width",I_a.prototype._$get_width,function(I_a){this._w=I_a}),I_d(0,I_c,"height",I_a.prototype._$get_height,function(I_a){this._h=I_a}),I_b}(I_c),I_Ua=function(I_a){function I_e(){this.flipY=!0,this.alwaysChange=!1,I_e.__super.call(this)}I_m(I_e,"laya.webgl.resource.WebGLCanvas",I_c);var I_b=I_e.prototype;return I_b.getCanvas=function(){return this._canvas},I_b.clear=function(){this._ctx&&this._ctx.clear()},I_b.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},I_b._setContext=function(I_a){this._ctx=I_a},I_b.getContext=function(I_a,I_b){return this._ctx?this._ctx:this._ctx=I_e._createContext(this)},I_b.size=function(I_a,I_b){this._w==I_a&&this._h==I_b||(this._w=I_a,this._h=I_b,this._ctx&&this._ctx.size(I_a,I_b),this._canvas&&(this._canvas.height=I_b,this._canvas.width=I_a))},I_b.activeResource=function(I_a){void 0===I_a&&(I_a=!1),this._source||this.recreateResource()},I_b.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},I_b.disposeResource=function(){this._source&&!this.iscpuSource&&(I_wa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},I_b.createWebGlTexture=function(){var I_a=I_wa.mainContext;this._canvas;var I_b=this._source=I_a.createTexture();this.iscpuSource=!1;var I_c=I_xa.curBindTexTarget,I_d=I_xa.curBindTexValue;I_xa.bindTexture(I_a,3553,I_b),I_a.pixelStorei(37440,this.flipY?1:0),I_e.premulAlpha&&I_a.pixelStorei(37441,!0),I_a.texImage2D(3553,0,6408,6408,5121,this._imgData),I_e.premulAlpha&&I_a.pixelStorei(37441,!1),I_a.texParameteri(3553,10240,9729),I_a.texParameteri(3553,10241,9729),I_a.texParameteri(3553,10242,33071),I_a.texParameteri(3553,10243,33071),I_a.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,I_c&&I_d&&I_xa.bindTexture(I_a,I_c,I_d)},I_b.reloadCanvasData=function(){var I_a=I_wa.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var I_b=I_xa.curBindTexTarget,I_c=I_xa.curBindTexValue;I_xa.bindTexture(I_a,3553,this._source),I_e.premulAlpha&&I_a.pixelStorei(37441,!0),I_a.texImage2D(3553,0,6408,6408,5121,this._imgData),I_e.premulAlpha&&I_a.pixelStorei(37441,!1),I_a.pixelStorei(37440,0),I_b&&I_c&&I_xa.bindTexture(I_a,I_b,I_c)},I_b.texSubImage2D=function(I_a,I_b,I_c){var I_d=I_wa.mainContext,I_e=I_xa.curBindTexTarget,I_f=I_xa.curBindTexValue;I_xa.bindTexture(I_d,3553,this._source),I_d.pixelStorei(37441,!0),I_d.texSubImage2D(3553,0,I_b,I_c,6408,5121,I_a._source),I_d.pixelStorei(37441,!1),I_e&&I_f&&I_xa.bindTexture(I_d,I_e,I_f)},I_b.toBase64=function(I_a,I_b,I_c){var I_d=null;this._canvas&&(I_d=this._canvas.toDataURL(I_a,I_b)),I_c.call(this,I_d)},I_d(0,I_b,"context",function(){return this._ctx}),I_d(0,I_b,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),I_d(0,I_b,"asBitmap",null,function(I_a){this._ctx&&(this._ctx.asBitmap=I_a)}),I_e._createContext=null,I_e.premulAlpha=!1,I_e}(),I_Va=function(I_a){function I_f(I_a,I_b){this.CborderSize=12,I_f.__super.call(this),this.char=I_a,this.isSpace=" "===I_a,this.xs=I_b.scaleX,this.ys=I_b.scaleY,this.font=I_b.font.toString(),this.fontSize=I_b.font.size,this.fillColor=I_b.fillColor,this.borderColor=I_b.borderColor,this.lineWidth=I_b.lineWidth,this.underLine=I_b.underLine;var I_c,I_d=I_t.isConchApp;I_d?((I_c=ConchTextCanvas)._source=ConchTextCanvas,I_c._source.canvas=ConchTextCanvas):I_c=I_n.canvas.source,this.canvas=I_c,this._enableMerageInAtlas=!0,this._ctx=I_d?I_c:this.canvas.getContext("2d",void 0);var I_e=I_L.measureText(this.char,this.font);this.cw=I_e.width*this.xs,this.ch=(I_e.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new I_K(this)}I_m(I_f,"laya.webgl.resource.WebGLCharImage",I_c);var I_b=I_f.prototype;return I_y.imps(I_b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),I_b.active=function(){this.texture.active()},I_b.recreateResource=function(){var I_a=I_t.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),I_a){var I_b=this.fontSize;1==this.xs&&1==this.ys||(I_b=parseInt(I_b*(this.xs>this.ys?this.xs:this.ys)+""));var I_c="normal 100 "+this.font;I_c=I_c.replace(I_f._fontSizeReg,I_b),this.borderColor&&(I_c+=" 1 "+this.borderColor),this._ctx.font=I_c,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,I_J.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var I_d=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(I_d,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},I_b.onresize=function(I_a,I_b){this._w=I_a,this._h=I_b,this._allowMerageInAtlas=!0},I_b.clearAtlasSource=function(){},I_d(0,I_b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),I_d(0,I_b,"atlasSource",function(){return this.canvas}),I_d(0,I_b,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(I_a){this._enableMerageInAtlas=I_a}),I_f.createOneChar=function(I_a,I_b){return new I_f(I_a,I_b)},I_f._fontSizeReg=new RegExp("\\d+(?=px)","g"),I_f}(),I_Wa=function(I_a){function I_j(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){void 0===I_c&&(I_c=6408),void 0===I_d&&(I_d=5121),void 0===I_e&&(I_e=34041),void 0===I_f&&(I_f=!1),void 0===I_g&&(I_g=!1),void 0===I_h&&(I_h=-1),void 0===I_i&&(I_i=1),I_j.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=I_a,this._h=I_b,this._surfaceFormat=I_c,this._surfaceType=I_d,this._depthStencilFormat=I_e,this._mipMap=I_f,this._repeat=I_g,this._minFifter=I_h,this._magFifter=I_i}I_m(I_j,"laya.webgl.resource.WebGLRenderTarget",I_c);var I_b=I_j.prototype;return I_b.recreateResource=function(){var I_a=I_wa.mainContext;this._frameBuffer||(this._frameBuffer=I_a.createFramebuffer()),this._source||(this._source=I_a.createTexture());var I_b=I_xa.curBindTexTarget,I_c=I_xa.curBindTexValue;I_xa.bindTexture(I_a,3553,this._source),I_a.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var I_d=this._minFifter,I_e=this._magFifter,I_f=this._repeat?10497:33071,I_g=I_k.isPOT(this._w,this._h);if(I_g?(this._mipMap?-1!==I_d||(I_d=9987):-1!==I_d||(I_d=9729),-1!==I_e||(I_e=9729),I_a.texParameteri(3553,10241,I_d),I_a.texParameteri(3553,10240,I_e),I_a.texParameteri(3553,10242,I_f),I_a.texParameteri(3553,10243,I_f),this._mipMap&&I_a.generateMipmap(3553)):(-1!==I_d||(I_d=9729),-1!==I_e||(I_e=9729),I_a.texParameteri(3553,10241,I_d),I_a.texParameteri(3553,10240,I_e),I_a.texParameteri(3553,10242,33071),I_a.texParameteri(3553,10243,33071)),I_a.bindFramebuffer(36160,this._frameBuffer),I_a.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=I_a.createRenderbuffer()),I_a.bindRenderbuffer(36161,this._depthStencilBuffer),I_a.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:I_a.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:I_a.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:I_a.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}I_a.bindFramebuffer(36160,null),I_b&&I_c&&I_xa.bindTexture(I_a,I_b,I_c),I_a.bindRenderbuffer(36161,null),I_g&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},I_b.disposeResource=function(){this._frameBuffer&&(I_wa.mainContext.deleteTexture(this._source),I_wa.mainContext.deleteFramebuffer(this._frameBuffer),I_wa.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},I_d(0,I_b,"depthStencilBuffer",function(){return this._depthStencilBuffer}),I_d(0,I_b,"frameBuffer",function(){return this._frameBuffer}),I_j}(),I_Xa=function(I_a){function I_h(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this.offsetX=0,this.offsetY=0,I_h.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=I_f,this.canvas=I_a,this._ctx=I_a.getContext("2d",void 0),this._w=I_d,this._h=I_e,this.offsetX=I_b,this.offsetY=I_c,this.src=I_g,this._enableMerageInAtlas=!0,I_Q.enabled&&this._w<I_Q.atlasLimitWidth&&this._h<I_Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}I_m(I_h,"laya.webgl.resource.WebGLSubImage",I_c);var I_b=I_h.prototype;return I_y.imps(I_b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),I_b.size=function(I_a,I_b){this._w=I_a,this._h=I_b,this._ctx&&this._ctx.size(I_a,I_b),this.canvas&&(this.canvas.height=I_b,this.canvas.width=I_a)},I_b.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},I_b.createWebGlTexture=function(){var I_a=I_wa.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var I_b=this._source=I_a.createTexture(),I_c=I_xa.curBindTexTarget,I_d=I_xa.curBindTexValue;I_xa.bindTexture(I_a,3553,I_b),I_a.pixelStorei(37441,!0),I_a.texImage2D(3553,0,6408,6408,5121,this.canvas),I_a.pixelStorei(37441,!1);var I_e=this.minFifter,I_f=this.magFifter,I_g=this.repeat?10497:33071,I_h=I_k.isPOT(this.width,this.height);I_h?(this.mipmap?-1!==I_e||(I_e=9987):-1!==I_e||(I_e=9729),-1!==I_f||(I_f=9729),I_a.texParameteri(3553,10240,I_f),I_a.texParameteri(3553,10241,I_e),I_a.texParameteri(3553,10242,I_g),I_a.texParameteri(3553,10243,I_g),this.mipmap&&I_a.generateMipmap(3553)):(-1!==I_e||(I_e=9729),-1!==I_f||(I_f=9729),I_a.texParameteri(3553,10241,I_e),I_a.texParameteri(3553,10240,I_f),I_a.texParameteri(3553,10242,33071),I_a.texParameteri(3553,10243,33071)),I_c&&I_d&&I_xa.bindTexture(I_a,I_c,I_d),this.canvas=null,I_h&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},I_b.disposeResource=function(){I_Q.enabled&&this._allowMerageInAtlas||!this._source||(I_wa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},I_b.clearAtlasSource=function(){},I_d(0,I_b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),I_d(0,I_b,"atlasSource",function(){return this.canvas}),I_d(0,I_b,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(I_a){this._allowMerageInAtlas=I_a}),I_h}(),I_Ya=function(I_a){function I_j(I_a,I_b,I_c,I_d){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,I_j.__super.call(this),!I_a||!I_b)throw"Shader Error";this._id=++I_j._count,this._vs=I_a,this._ps=I_b,this._nameMap=I_d||{},null!=I_c&&(I_j.sharders[I_c]=this)}I_m(I_j,"laya.webgl.shader.Shader",I_La);var I_b=I_j.prototype;return I_b.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},I_b.disposeResource=function(){I_wa.mainContext.deleteShader(this._vshader),I_wa.mainContext.deleteShader(this._pshader),I_wa.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},I_b._compile=function(){if(!I_wa.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var I_a=[this._vs,this._ps],I_b=I_wa.mainContext;if(this._program=I_b.createProgram(),this._vshader=I_j._createShader(I_b,I_a[0],35633),this._pshader=I_j._createShader(I_b,I_a[1],35632),I_b.attachShader(this._program,this._vshader),I_b.attachShader(this._program,this._pshader),I_b.linkProgram(this._program),!I_t.isConchApp&&!I_b.getProgramParameter(this._program,35714))throw I_b.getProgramInfoLog(this._program);var I_c,I_d,I_e=0,I_f=0;for(I_f=I_t.isConchApp?I_b.getProgramParameterEx(this._vs,this._ps,"",35721):I_b.getProgramParameter(this._program,35721),I_e=0;I_e<I_f;I_e++){var I_g=null;I_c={vartype:"attribute",glfun:null,ivartype:0,attrib:I_g=I_t.isConchApp?I_b.getActiveAttribEx(this._vs,this._ps,"",I_e):I_b.getActiveAttrib(this._program,I_e),location:I_b.getAttribLocation(this._program,I_g.name),name:I_g.name,type:I_g.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(I_c)}var I_h=0;for(I_h=I_t.isConchApp?I_b.getProgramParameterEx(this._vs,this._ps,"",35718):I_b.getProgramParameter(this._program,35718),I_e=0;I_e<I_h;I_e++){var I_i=null;I_i=I_t.isConchApp?I_b.getActiveUniformEx(this._vs,this._ps,"",I_e):I_b.getActiveUniform(this._program,I_e),0<(I_c={vartype:"uniform",glfun:null,ivartype:1,attrib:I_g,location:I_b.getUniformLocation(this._program,I_i.name),name:I_i.name,type:I_i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(I_c.name=I_c.name.substr(0,I_c.name.length-3),I_c.isArray=!0,I_c.location=I_b.getUniformLocation(this._program,I_c.name)),this._params.push(I_c)}for(I_e=0,I_d=this._params.length;I_e<I_d;I_e++)if((I_c=this._params[I_e]).indexOfParams=I_e,I_c.index=1,I_c.value=[I_c.location,null],I_c.codename=I_c.name,I_c.name=this._nameMap[I_c.codename]?this._nameMap[I_c.codename]:I_c.codename,(this._paramsMap[I_c.name]=I_c)._this=this,I_c.uploadedValue=[],"attribute"!==I_c.vartype)switch(I_c.type){case 5124:I_c.fun=I_c.isArray?this._uniform1iv:this._uniform1i;break;case 5126:I_c.fun=I_c.isArray?this._uniform1fv:this._uniform1f;break;case 35664:I_c.fun=I_c.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:I_c.fun=I_c.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:I_c.fun=I_c.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:I_c.fun=this._uniform_sampler2D;break;case 35680:I_c.fun=this._uniform_samplerCube;break;case 35676:I_c.glfun=I_b.uniformMatrix4fv,I_c.fun=this._uniformMatrix4fv;break;case 35670:I_c.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else I_c.fun=this._attribute}},I_b.getUniform=function(I_a){return this._paramsMap[I_a]},I_b._attribute=function(I_a,I_b){var I_c=I_wa.mainContext,I_d=I_Na._enableAtributes,I_e=I_a.location;return I_d[I_e]||I_c.enableVertexAttribArray(I_e),I_c.vertexAttribPointer(I_e,I_b[0],I_b[1],I_b[2],I_b[3],I_b[4]+this._offset),I_d[I_e]=I_Na._bindVertexBuffer,1},I_b._uniform1f=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b?(I_wa.mainContext.uniform1f(I_a.location,I_c[0]=I_b),1):0},I_b._uniform1fv=function(I_a,I_b){if(I_b.length<4){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]||I_c[2]!==I_b[2]||I_c[3]!==I_b[3]?(I_wa.mainContext.uniform1fv(I_a.location,I_b),I_c[0]=I_b[0],I_c[1]=I_b[1],I_c[2]=I_b[2],I_c[3]=I_b[3],1):0}return I_wa.mainContext.uniform1fv(I_a.location,I_b),1},I_b._uniform_vec2=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]?(I_wa.mainContext.uniform2f(I_a.location,I_c[0]=I_b[0],I_c[1]=I_b[1]),1):0},I_b._uniform_vec2v=function(I_a,I_b){if(I_b.length<2){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]||I_c[2]!==I_b[2]||I_c[3]!==I_b[3]?(I_wa.mainContext.uniform2fv(I_a.location,I_b),I_c[0]=I_b[0],I_c[1]=I_b[1],I_c[2]=I_b[2],I_c[3]=I_b[3],1):0}return I_wa.mainContext.uniform2fv(I_a.location,I_b),1},I_b._uniform_vec3=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]||I_c[2]!==I_b[2]?(I_wa.mainContext.uniform3f(I_a.location,I_c[0]=I_b[0],I_c[1]=I_b[1],I_c[2]=I_b[2]),1):0},I_b._uniform_vec3v=function(I_a,I_b){return I_wa.mainContext.uniform3fv(I_a.location,I_b),1},I_b._uniform_vec4=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]||I_c[2]!==I_b[2]||I_c[3]!==I_b[3]?(I_wa.mainContext.uniform4f(I_a.location,I_c[0]=I_b[0],I_c[1]=I_b[1],I_c[2]=I_b[2],I_c[3]=I_b[3]),1):0},I_b._uniform_vec4v=function(I_a,I_b){return I_wa.mainContext.uniform4fv(I_a.location,I_b),1},I_b._uniformMatrix2fv=function(I_a,I_b){return I_wa.mainContext.uniformMatrix2fv(I_a.location,!1,I_b),1},I_b._uniformMatrix3fv=function(I_a,I_b){return I_wa.mainContext.uniformMatrix3fv(I_a.location,!1,I_b),1},I_b._uniformMatrix4fv=function(I_a,I_b){return I_wa.mainContext.uniformMatrix4fv(I_a.location,!1,I_b),1},I_b._uniform1i=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b?(I_wa.mainContext.uniform1i(I_a.location,I_c[0]=I_b),1):0},I_b._uniform1iv=function(I_a,I_b){return I_wa.mainContext.uniform1iv(I_a.location,I_b),1},I_b._uniform_ivec2=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]?(I_wa.mainContext.uniform2i(I_a.location,I_c[0]=I_b[0],I_c[1]=I_b[1]),1):0},I_b._uniform_ivec2v=function(I_a,I_b){return I_wa.mainContext.uniform2iv(I_a.location,I_b),1},I_b._uniform_vec3i=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]||I_c[2]!==I_b[2]?(I_wa.mainContext.uniform3i(I_a.location,I_c[0]=I_b[0],I_c[1]=I_b[1],I_c[2]=I_b[2]),1):0},I_b._uniform_vec3vi=function(I_a,I_b){return I_wa.mainContext.uniform3iv(I_a.location,I_b),1},I_b._uniform_vec4i=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]||I_c[2]!==I_b[2]||I_c[3]!==I_b[3]?(I_wa.mainContext.uniform4i(I_a.location,I_c[0]=I_b[0],I_c[1]=I_b[1],I_c[2]=I_b[2],I_c[3]=I_b[3]),1):0},I_b._uniform_vec4vi=function(I_a,I_b){return I_wa.mainContext.uniform4iv(I_a.location,I_b),1},I_b._uniform_sampler2D=function(I_a,I_b){var I_c=I_wa.mainContext,I_d=I_a.uploadedValue;return null==I_d[0]?(I_d[0]=this._curActTexIndex,I_c.uniform1i(I_a.location,this._curActTexIndex),I_c.activeTexture(I_j._TEXTURES[this._curActTexIndex]),I_xa.bindTexture(I_c,3553,I_b),this._curActTexIndex++,1):(I_c.activeTexture(I_j._TEXTURES[I_d[0]]),I_xa.bindTexture(I_c,3553,I_b),0)},I_b._uniform_samplerCube=function(I_a,I_b){var I_c=I_wa.mainContext,I_d=I_a.uploadedValue;return null==I_d[0]?(I_d[0]=this._curActTexIndex,I_c.uniform1i(I_a.location,this._curActTexIndex),I_c.activeTexture(I_j._TEXTURES[this._curActTexIndex]),I_xa.bindTexture(I_c,34067,I_b),this._curActTexIndex++,1):(I_c.activeTexture(I_j._TEXTURES[I_d[0]]),I_xa.bindTexture(I_c,34067,I_b),0)},I_b._noSetValue=function(I_a){console.log("no....:"+I_a.name)},I_b.uploadOne=function(I_a,I_b){this.activeResource(),I_xa.UseProgram(this._program);var I_c=this._paramsMap[I_a];I_c.fun.call(this,I_c,I_b)},I_b.uploadTexture2D=function(I_a){I_G.shaderCall++;var I_b=I_wa.mainContext;I_b.activeTexture(33984),I_xa.bindTexture(I_b,3553,I_a)},I_b.uploadTexture2D1=function(I_a){I_G.shaderCall++;var I_b=I_wa.mainContext;I_b.activeTexture(33985),I_xa.bindTexture(I_b,3553,I_a)},I_b.upload=function(I_a,I_b){I_La.activeShader=I_La.bindShader=this,this._lastUseFrameCount===I_G.loopCount||this.activeResource(),I_xa.UseProgram(this._program),this._reCompile?(I_b=this._params,this._reCompile=!1):I_b=I_b||this._params;I_wa.mainContext;for(var I_c,I_d,I_e=I_b.length,I_f=0,I_g=0;I_g<I_e;I_g++)null!==(I_d=I_a[(I_c=I_b[I_g]).name])&&(I_f+=I_c.fun.call(this,I_c,I_d));I_G.shaderCall+=I_f},I_b.uploadArray=function(I_a,I_b,I_c){I_La.activeShader=this,(I_La.bindShader=this).activeResource(),I_xa.UseProgram(this._program);this._params;for(var I_d,I_e,I_f=0,I_g=I_b-2;0<=I_g;I_g-=2)(I_e=this._paramsMap[I_a[I_g]])&&null!=(I_d=I_a[I_g+1])&&(I_c&&I_c[I_e.name]&&I_c[I_e.name].bind(),I_f+=I_e.fun.call(this,I_e,I_d));I_G.shaderCall+=I_f},I_b.getParams=function(){return this._params},I_j.getShader=function(I_a){return I_j.sharders[I_a]},I_j.create=function(I_a,I_b,I_c,I_d){return new I_j(I_a,I_b,I_c,I_d)},I_j.withCompile=function(I_a,I_b,I_c,I_d){if(I_c&&I_j.sharders[I_c])return I_j.sharders[I_c];var I_e=I_j._preCompileShader[2e-4*I_a];if(!I_e)throw new Error("withCompile shader err!"+I_a);return I_e.createShader(I_b,I_c,I_d)},I_j.withCompile2D=function(I_a,I_b,I_c,I_d,I_e){if(I_d&&I_j.sharders[I_d])return I_j.sharders[I_d];var I_f=I_j._preCompileShader[2e-4*I_a+I_b];if(!I_f)throw new Error("withCompile shader err!"+I_a+" "+I_b);return I_f.createShader(I_c,I_d,I_e)},I_j.addInclude=function(I_a,I_b){I_va.addInclude(I_a,I_b)},I_j.preCompile=function(I_a,I_b,I_c,I_d){var I_e=2e-4*I_a;I_j._preCompileShader[I_e]=new I_va(I_e,I_b,I_c,I_d)},I_j.preCompile2D=function(I_a,I_b,I_c,I_d,I_e){var I_f=2e-4*I_a+I_b;I_j._preCompileShader[I_f]=new I_va(I_f,I_c,I_d,I_e)},I_j._createShader=function(I_a,I_b,I_c){var I_d=I_a.createShader(I_c);return I_a.shaderSource(I_d,I_b),I_a.compileShader(I_d),I_d},I_j._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],I_j._count=0,I_j._preCompileShader={},I_j.SHADERNAME2ID=2e-4,I_j.sharders=((I_j.sharders=[]).length=32,I_j.sharders),I_g(I_j,["nameKey",function(){return this.nameKey=new I_H}]),I_j}(),I_Za=function(I_a){function I_b(){this._maxsize=0,this._upload=!0,this._uploadSize=0,I_b.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}I_m(I_b,"laya.webgl.utils.Buffer2D",I_a);var I_c=I_b.prototype;return I_c.needSize=function(I_a){var I_b=this._byteLength;if(I_a){var I_c=this._byteLength+I_a;I_c<=this._buffer.byteLength||this._resizeBuffer(I_c<<1,!0),this._byteLength=I_c}return I_b},I_c._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),I_G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,I_Na._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),I_Na._gl.bufferSubData(this._bufferType,0,this._buffer)},I_c._bufferSubData=function(I_a,I_b,I_c){if(void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),this._maxsize=Math.max(this._maxsize,this._byteLength),I_G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,I_Na._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),I_b||I_c){var I_d=this._buffer.slice(I_b,I_c);I_Na._gl.bufferSubData(this._bufferType,I_a,I_d)}else I_Na._gl.bufferSubData(this._bufferType,I_a,this._buffer)},I_c._checkArrayUse=function(){},I_c._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},I_c._bind_subUpload=function(I_a,I_b,I_c){return void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(I_a,I_b,I_c),!0)},I_c._resizeBuffer=function(I_a,I_b){if(I_a<this._buffer.byteLength)return this;if(this.memorySize=I_a,I_b&&this._buffer&&0<this._buffer.byteLength){var I_c=new ArrayBuffer(I_a);new Uint8Array(I_c).set(new Uint8Array(this._buffer),0),this._buffer=I_c}else this._buffer=new ArrayBuffer(I_a);return this._checkArrayUse(),this._upload=!0,this},I_c.append=function(I_a){this._upload=!0;var I_b,I_c;I_b=I_a.byteLength,I_a instanceof Uint8Array?(this._resizeBuffer(this._byteLength+I_b,!0),I_c=new Uint8Array(this._buffer,this._byteLength)):I_a instanceof Uint16Array?(this._resizeBuffer(this._byteLength+I_b,!0),I_c=new Uint16Array(this._buffer,this._byteLength)):I_a instanceof Float32Array&&(this._resizeBuffer(this._byteLength+I_b,!0),I_c=new Float32Array(this._buffer,this._byteLength)),I_c.set(I_a,0),this._byteLength+=I_b,this._checkArrayUse()},I_c.appendU16Array=function(I_a,I_b){this._resizeBuffer(this._byteLength+2*I_b,!0);for(var I_c=new Uint16Array(this._buffer,this._byteLength,I_b),I_d=0;I_d<I_b;I_d++)I_c[I_d]=I_a[I_d];this._byteLength+=2*I_b,this._checkArrayUse()},I_c.appendEx=function(I_a,I_b){this._upload=!0;var I_c;I_c=I_a.byteLength,this._resizeBuffer(this._byteLength+I_c,!0),new I_b(this._buffer,this._byteLength).set(I_a,0),this._byteLength+=I_c,this._checkArrayUse()},I_c.appendEx2=function(I_a,I_b,I_c,I_d){void 0===I_d&&(I_d=1),this._upload=!0;var I_e,I_f;I_e=I_c*I_d,this._resizeBuffer(this._byteLength+I_e,!0),I_f=new I_b(this._buffer,this._byteLength);var I_g=0;for(I_g=0;I_g<I_c;I_g++)I_f[I_g]=I_a[I_g];this._byteLength+=I_e,this._checkArrayUse()},I_c.getBuffer=function(){return this._buffer},I_c.setNeedUpload=function(){this._upload=!0},I_c.getNeedUpload=function(){return this._upload},I_c.upload=function(){var I_a=this._bind_upload();return I_Na._gl.bindBuffer(this._bufferType,null),I_Na._bindActive[this._bufferType]=null,I_La.activeShader=null,I_a},I_c.subUpload=function(I_a,I_b,I_c){void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0);var I_d=this._bind_subUpload();return I_Na._gl.bindBuffer(this._bufferType,null),I_Na._bindActive[this._bufferType]=null,I_La.activeShader=null,I_d},I_c.disposeResource=function(){I_a.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},I_c.clear=function(){this._byteLength=0,this._upload=!0},I_d(0,I_c,"bufferLength",function(){return this._buffer.byteLength}),I_d(0,I_c,"byteLength",null,function(I_a){this._byteLength!==I_a&&(I_a<=this._buffer.byteLength||this._resizeBuffer(2*I_a+256,!0),this._byteLength=I_a)}),I_b.__int__=function(I_a){I_qa.QuadrangleIB=I_qa.create(35044),I_sa.fillIBQuadrangle(I_qa.QuadrangleIB,16)},I_b.FLOAT32=4,I_b.SHORT=2,I_b}(I_Na),I_$a=(function(I_b){function I_c(I_a){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,I_c.__super.call(this,9)}I_m(I_c,"laya.webgl.shader.d2.value.GlowSV",I_b);var I_a=I_c.prototype;I_a.setValue=function(I_a){I_b.prototype.setValue.call(this,I_a)},I_a.clear=function(){I_b.prototype.clear.call(this)}}(I_Ra),function(I_a){function I_b(I_a){I_b.__super.call(this,64),this.defines.add(64)}I_m(I_b,"laya.webgl.shader.d2.value.TextSV",I_a);var I_c=I_b.prototype;return I_c.release=function(){(I_b.pool[I_b._length++]=this).clear()},I_c.clear=function(){I_a.prototype.clear.call(this)},I_b.create=function(){return I_b._length?I_b.pool[--I_b._length]:new I_b(null)},I_b.pool=[],I_b._length=0,I_b}(I_Ra)),I__a=function(I_a){function I_e(I_a,I_b,I_c,I_d){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,I_e.__super.call(this,I_a,I_b,I_c,I_d)}I_m(I_e,"laya.webgl.shader.d2.Shader2X",I_a);var I_b=I_e.prototype;return I_b.upload2dQuick1=function(I_a){this.upload(I_a,this._params2dQuick1||this._make2dQuick1())},I_b._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var I_a,I_b=this._params,I_c=0,I_d=I_b.length;I_c<I_d;I_c++)I_a=I_b[I_c],(I_t.isFlash||"size"!==I_a.name&&"position"!==I_a.name&&"texcoord"!==I_a.name)&&this._params2dQuick1.push(I_a)}return this._params2dQuick1},I_b.disposeResource=function(){I_a.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},I_b.upload2dQuick2=function(I_a){this.upload(I_a,this._params2dQuick2||this._make2dQuick2())},I_b._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var I_a,I_b=this._params,I_c=0,I_d=I_b.length;I_c<I_d;I_c++)I_a=I_b[I_c],(I_t.isFlash||"size"!==I_a.name)&&this._params2dQuick2.push(I_a)}return this._params2dQuick2},I_e.create=function(I_a,I_b,I_c,I_d){return new I_e(I_a,I_b,I_c,I_d)},I_e}(I_Ya),I_qa=function(I_a){function I_b(I_a){this._uint8Array=null,this._uint16Array=null,void 0===I_a&&(I_a=35044),I_b.__super.call(this),this._bufferUsage=I_a,this._bufferType=34963,I_t.isFlash||(this._buffer=new ArrayBuffer(8))}I_m(I_b,"laya.webgl.utils.IndexBuffer2D",I_Za);var I_c=I_b.prototype;return I_c._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},I_c.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},I_c.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},I_c.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},I_b.QuadrangleIB=null,I_b.create=function(I_a){return void 0===I_a&&(I_a=35044),new I_b(I_a)},I_b}(),I_ra=function(I_a){function I_c(I_a,I_b){this._floatArray32=null,this._vertexStride=0,I_c.__super.call(this),this._vertexStride=I_a,this._bufferUsage=I_b,this._bufferType=34962,I_t.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}I_m(I_c,"laya.webgl.utils.VertexBuffer2D",I_a);var I_b=I_c.prototype;return I_b.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},I_b.bind=function(I_a){I_a&&I_a._bind(),this._bind()},I_b.insertData=function(I_a,I_b){this.getFloat32Array().set(I_a,I_b),this._upload=!0},I_b.bind_upload=function(I_a){I_a._bind_upload()||I_a._bind(),this._bind_upload()||this._bind()},I_b._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},I_b.disposeResource=function(){I_a.prototype.disposeResource.call(this)},I_b.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},I_d(0,I_b,"vertexStride",function(){return this._vertexStride}),I_c.create=function(I_a,I_b){return void 0===I_b&&(I_b=35048),new I_c(I_a,I_b)},I_c}(I_Za),I_ab=function(I_a){function I_h(I_a,I_b,I_c,I_d,I_e,I_f){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===I_c&&(I_c=6408),void 0===I_d&&(I_d=!0),I_h.__super.call(this,I_a,I_b),I_a){if(this._format=I_c,this._mipmap=I_d,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof I_a)this._url=I_a,this._src=I_a,this._image=new I_n.window.Image,I_b&&(I_b.onload&&(this.onload=I_b.onload),I_b.onerror&&(this.onerror=I_b.onerror),I_b.onCreate&&I_b.onCreate(this)),this._image.crossOrigin=I_a&&0==I_a.indexOf("data:")?null:"",I_a&&(this._image.src=I_a);else if(I_a instanceof ArrayBuffer){this._src=I_b,this._url=this._src;var I_g=new I_i(I_a);I_g.readUTFBytes(4),I_g.readUTFBytes(2),I_g.getInt16();I_g.endian="bigEndian",this._w=I_g.getInt16(),this._h=I_g.getInt16();I_g.getInt16(),I_g.getInt16();this._image=new Uint8Array(I_a,I_g.pos),this._format=I_wa.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,I_Q.enabled&&this._w<I_Q.atlasLimitWidth&&this._h<I_Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(I_a instanceof Uint8Array))return this._src=I_b,this._url=this._src,this._image=I_a.source||I_a,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=I_b,this._url=this._src,this._w=I_e,this._h=I_f,this._image=I_a,this._format=0===I_c?I_a.byteLength/(I_e*I_f)==4?6408:6407:I_c}this._$5__enableMerageInAtlas=!0}}I_m(I_h,"laya.webgl.resource.WebGLImage",I_p);var I_b=I_h.prototype;return I_y.imps(I_b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),I_b._init_=function(I_a,I_b){},I_b._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var I_a=I_wa.mainContext,I_b=this._source=I_a.createTexture(),I_c=I_xa.curBindTexTarget,I_d=I_xa.curBindTexValue;I_xa.bindTexture(I_a,3553,I_b);var I_e=this.minFifter,I_f=this.magFifter,I_g=this.repeat?10497:33071,I_h=I_k.isPOT(this._w,this._h),I_i=!1;switch(I_h?(this.mipmap?-1!==I_e||(I_e=9987):-1!==I_e||(I_e=9729),-1!==I_f||(I_f=9729),I_a.texParameteri(3553,10241,I_e),I_a.texParameteri(3553,10240,I_f),I_a.texParameteri(3553,10242,I_g),I_a.texParameteri(3553,10243,I_g),this.mipmap&&I_a.generateMipmap(3553)):(-1!==I_e||(I_e=9729),-1!==I_f||(I_f=9729),I_a.texParameteri(3553,10241,I_e),I_a.texParameteri(3553,10240,I_f),I_a.texParameteri(3553,10242,33071),I_a.texParameteri(3553,10243,33071)),I_a.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&I_a.pixelStorei(I_a.UNPACK_ALIGNMENT,1),I_a.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&I_a.pixelStorei(I_a.UNPACK_ALIGNMENT,1),I_a.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:I_i=!0,I_a.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case I_wa.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:I_i=!0,I_a.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}I_a.pixelStorei(37441,!1),I_c&&I_d&&I_xa.bindTexture(I_a,I_c,I_d),this.uri||(this.uri=this._url),I_i?this.memorySize=this._image.length:I_h&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},I_b.recreateResource=function(){var I_a=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var I_b=this;this._image=new I_n.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(I_b._needReleaseAgain)return I_b._needReleaseAgain=!1,I_b._image.onload=null,void(I_b._image=null);I_b._allowMerageInAtlas&&I_b._enableMerageInAtlas?(I_a.memorySize=0,I_a._recreateLock=!1):I_b._createWebGlTexture(),I_b.completeCreate()},this._image.src=this._src}},I_b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&I_wa.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},I_b.onresize=function(){this._w=this._image.width,this._h=this._image.height,I_Q.enabled&&this._w<I_Q.atlasLimitWidth&&this._h<I_Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},I_b.clearAtlasSource=function(){this._image=null},I_d(0,I_b,"format",function(){return this._format}),I_d(0,I_b,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(I_a){this._$5__enableMerageInAtlas=I_a}),I_d(0,I_b,"mipmap",function(){return this._mipmap}),I_d(0,I_b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),I_d(0,I_b,"atlasSource",function(){return this._image}),I_d(0,I_b,"onload",null,function(I_a){var I_b=this;this._onload=I_a,this._image&&(this._image.onload=null!=this._onload?function(){I_b.onresize(),I_b._onload()}:null)}),I_d(0,I_b,"onerror",null,function(I_a){var I_b=this;this._onerror=I_a,this._image&&(this._image.onerror=null!=this._onerror?function(){I_b._onerror()}:null)}),I_h}();I_y.__init([I_na,I_P,I_za,I_va])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(I_a,I_b){"use strict";for(var I_c in Object.defineProperty(I_b,"__esModule",{value:!0}),Laya){var I_d=Laya[I_c];I_d&&I_d.__isclass&&(I_b[I_c]=I_d)}}),function(I_f,I_a,I_d){I_d.un,I_d.uns;var I_e=I_d.static,I_g=I_d.class,I_h=I_d.getset,I_i=(I_d.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),I_o=laya.utils.ClassUtils,I_l=(laya.events.Event,laya.utils.HTMLChar),I_j=laya.net.Loader,I_k=(laya.display.Node,laya.maths.Rectangle),I_m=laya.renders.Render,I_n=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),I_p=laya.utils.Stat,I_L=laya.display.Text,I_s=laya.resource.Texture,I_t=laya.net.URL,I_u=laya.utils.Utils,I_v=function(){function I_n(){}return I_g(I_n,"laya.html.utils.HTMLParse"),I_n.parse=function(I_a,I_b,I_c){I_b=(I_b="<root>"+(I_b=I_b.replace(/<br>/g,"<br/>"))+"</root>").replace(I_n.spacePattern,I_n.char255);var I_d=I_u.parseXMLFromString(I_b);I_n._parseXML(I_a,I_d.childNodes[0].childNodes,I_c)},I_n._parseXML=function(I_a,I_b,I_c,I_d){var I_e=0,I_f=0;if(I_b.join||I_b.item)for(I_e=0,I_f=I_b.length;I_e<I_f;++I_e)I_n._parseXML(I_a,I_b[I_e],I_c,I_d);else{var I_g,I_h,I_i;if(3==I_b.nodeType)return void(I_a instanceof laya.html.dom.HTMLDivElement?(null==I_b.nodeName&&(I_b.nodeName="#text"),I_h=I_b.nodeName.toLowerCase(),0<(I_i=I_b.textContent.replace(/^\s+|\s+$/g,"")).length&&(I_g=I_o.getInstance(I_h))&&(I_a.addChild(I_g),I_g.innerTEXT=I_i.replace(I_n.char255AndOneSpacePattern," "))):0<(I_i=I_b.textContent.replace(/^\s+|\s+$/g,"")).length&&(I_a.innerTEXT=I_i.replace(I_n.char255AndOneSpacePattern," ")));if("#comment"==(I_h=I_b.nodeName.toLowerCase()))return;if(I_g=I_o.getInstance(I_h)){(I_g=I_a.addChild(I_g)).URI=I_c,I_g.href=I_d;var I_j=I_b.attributes;if(I_j&&0<I_j.length)for(I_e=0,I_f=I_j.length;I_e<I_f;++I_e){var I_k=I_j[I_e],I_l=I_k.nodeName,I_m=I_k.value;I_g._setAttributes(I_l,I_m)}I_n._parseXML(I_g,I_b.childNodes,I_c,I_g.href)}else I_n._parseXML(I_a,I_b.childNodes,I_c,I_d)}},I_n.char255=String.fromCharCode(255),I_n.spacePattern=/&nbsp;|&#160;/g,I_n.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),I_n}(),I_w=function(){function I_K(){}return I_g(I_K,"laya.html.utils.Layout"),I_K.later=function(I_a){null==I_K._will&&(I_K._will=[],I_d.stage.frameLoop(1,null,function(){if(!(I_K._will.length<1)){for(var I_a=0;I_a<I_K._will.length;I_a++)laya.html.utils.Layout.layout(I_K._will[I_a]);I_K._will.length=0}})),I_K._will.push(I_a)},I_K.layout=function(I_a){if(!I_a||!I_a._style)return null;if(0==(512&I_a._style._type))return null;I_a.getStyle()._type&=-513;var I_b=I_K._multiLineLayout(I_a);return I_m.isConchApp&&I_a.layaoutCallNative&&I_a.layaoutCallNative(),I_b},I_K._multiLineLayout=function(I_a){if(I_L.RightToLeft)return I_K._multiLineLayout2(I_a);var I_b=new Array;I_a._addChildsToLayout(I_b);var I_c,I_d,I_e,I_f,I_g,I_h=0,I_i=I_b.length,I_j=I_a._getCSSStyle(),I_k=I_j.letterSpacing,I_l=I_j.leading,I_m=I_j.lineHeight,I_n=I_j._widthAuto()||!I_j.wordWrap,I_o=I_n?999999:I_a.width,I_p=(I_a.height,0),I_s=I_j.italic?I_j.fontSize/3:0,I_t=I_j._getAlign(),I_u=I_j._getValign(),I_v=0!==I_u||0!==I_t||0!=I_m,I_w=0,I_x=0,I_y=0,I_z=0,I_A=new Array,I_B=I_A[0]=new I_M,I_C=!1,I_D=!1;I_B.h=0,I_j.italic&&(I_o-=I_j.fontSize/3);var I_E=0,I_F=!0;function I_G(){I_B.y=I_x,I_x+=I_B.h+I_l,0==I_B.h&&(I_x+=I_m),I_B.mWidth=I_E,I_E=0,I_B=new I_M,I_A.push(I_B),I_B.h=0,I_C=!(I_F=!(I_w=0))}for(I_h=0;I_h<I_i;I_h++)if(null!=(I_c=I_b[I_h]))if(I_F=!1,I_c instanceof laya.html.dom.HTMLBrElement)I_G(),I_B.y=I_x;else{if(I_c._isChar()){if((I_f=I_c).isWord)I_C=I_D||"\n"===I_f.char,I_B.wordStartIndex=I_B.elements.length;else{if(I_y=I_f.width+I_f.style.letterSpacin,0<I_A.length&&I_o<I_w+I_y&&0<I_B.wordStartIndex){var I_H;I_H=I_B.elements.length-I_B.wordStartIndex+1,I_B.elements.length=I_B.wordStartIndex,I_h-=I_H,I_G();continue}I_C=!1,I_E+=I_f.width}I_y=I_f.width+I_k,I_z=I_f.height,I_D=!1,(I_C=I_C||I_o<I_w+I_y)&&I_G(),I_B.minTextHeight=Math.min(I_B.minTextHeight,I_c.height)}else I_d=I_c._getCSSStyle(),I_g=I_c,I_e=I_d.padding,0===I_d._getCssFloat()||(I_v=!0),I_C=I_D||I_d.lineElement,I_y=I_g.width*I_g._style._tf.scaleX+I_e[1]+I_e[3]+I_k,I_z=I_g.height*I_g._style._tf.scaleY+I_e[0]+I_e[2],I_D=I_d.lineElement,(I_C=I_C||I_o<I_w+I_y&&I_d.wordWrap)&&I_G();I_B.elements.push(I_c),I_B.h=Math.max(I_B.h,I_z),I_c.x=I_w,I_c.y=I_x,I_w+=I_y,I_B.w=I_w-I_k,I_B.y=I_x,I_p=Math.max(I_w+I_s,I_p)}else I_F||(I_w+=I_K.DIV_ELEMENT_PADDING),I_B.wordStartIndex=I_B.elements.length;if(I_x=I_B.y+I_B.h,I_v){var I_I=0,I_J=I_o;for(I_n&&0<I_a.width&&(I_J=I_a.width),I_h=0,I_i=I_A.length;I_h<I_i;I_h++)I_A[I_h].updatePos(0,I_J,I_h,I_I,I_t,I_u,I_m),I_I+=Math.max(I_m,I_A[I_h].h+I_l);I_x=I_I}return I_n&&(I_a.width=I_p),I_x>I_a.height&&(I_a.height=I_x),[I_p,I_x]},I_K._multiLineLayout2=function(I_a){var I_b=new Array;I_a._addChildsToLayout(I_b);var I_c,I_d,I_e,I_f,I_g,I_h=0,I_i=I_b.length,I_j=I_a._getCSSStyle(),I_k=I_j.letterSpacing,I_l=I_j.leading,I_m=I_j.lineHeight,I_n=I_j._widthAuto()||!I_j.wordWrap,I_o=I_n?999999:I_a.width,I_p=(I_a.height,0),I_s=I_j.italic?I_j.fontSize/3:0,I_t=2-I_j._getAlign(),I_u=I_j._getValign(),I_v=0!==I_u||0!=I_t||0!=I_m,I_w=0,I_x=0,I_y=0,I_z=0,I_A=new Array,I_B=I_A[0]=new I_M,I_C=!1,I_D=!1;I_B.h=0,I_j.italic&&(I_o-=I_j.fontSize/3);var I_E=0,I_F=!0;function I_G(){I_B.y=I_x,I_x+=I_B.h+I_l,0==I_B.h&&(I_x+=I_m),I_B.mWidth=I_E,I_E=0,I_B=new I_M,I_A.push(I_B),I_B.h=0,I_C=!(I_F=!(I_w=0))}for(I_h=0;I_h<I_i;I_h++)if(null!=(I_c=I_b[I_h]))if(I_F=!1,I_c instanceof laya.html.dom.HTMLBrElement)I_G(),I_B.y=I_x;else{if(I_c._isChar()){if((I_f=I_c).isWord)I_C=I_D||"\n"===I_f.char,I_B.wordStartIndex=I_B.elements.length;else{if(0<I_A.length&&I_o<I_w+I_y&&0<I_B.wordStartIndex){var I_H;I_H=I_B.elements.length-I_B.wordStartIndex+1,I_B.elements.length=I_B.wordStartIndex,I_h-=I_H,I_G();continue}I_C=!1,I_E+=I_f.width}I_y=I_f.width+I_k,I_z=I_f.height,I_D=!1,(I_C=I_C||I_o<I_w+I_y)&&I_G(),I_B.minTextHeight=Math.min(I_B.minTextHeight,I_c.height)}else I_d=I_c._getCSSStyle(),I_g=I_c,I_e=I_d.padding,0===I_d._getCssFloat()||(I_v=!0),I_C=I_D||I_d.lineElement,I_y=I_g.width*I_g._style._tf.scaleX+I_e[1]+I_e[3]+I_k,I_z=I_g.height*I_g._style._tf.scaleY+I_e[0]+I_e[2],I_D=I_d.lineElement,(I_C=I_C||I_o<I_w+I_y&&I_d.wordWrap)&&I_G();I_B.elements.push(I_c),I_B.h=Math.max(I_B.h,I_z),I_c.x=I_w,I_c.y=I_x,I_w+=I_y,I_B.w=I_w-I_k,I_B.y=I_x,I_p=Math.max(I_w+I_s,I_p)}else I_F||(I_w+=I_K.DIV_ELEMENT_PADDING),I_B.wordStartIndex=I_B.elements.length;if(I_x=I_B.y+I_B.h,I_v){var I_I=0,I_J=I_o;for(I_h=0,I_i=I_A.length;I_h<I_i;I_h++)I_A[I_h].updatePos(0,I_J,I_h,I_I,I_t,I_u,I_m),I_I+=Math.max(I_m,I_A[I_h].h+I_l);I_x=I_I}for(I_n&&(I_a.width=I_p),I_x>I_a.height&&(I_a.height=I_x),I_h=0,I_i=I_A.length;I_h<I_i;I_h++)I_A[I_h].revertOrder(I_o);return[I_p,I_x]},I_K._will=null,I_K.DIV_ELEMENT_PADDING=0,I_K}(),I_M=function(){function I_a(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}I_g(I_a,"laya.html.utils.LayoutLine");var I_b=I_a.prototype;return I_b.updatePos=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){var I_h,I_i=0;0<this.elements.length&&(I_i=(I_h=this.elements[this.elements.length-1]).x+I_h.width-this.elements[0].x);var I_j=0,I_k=NaN;1===I_e&&(I_j=(I_b-I_i)/2),2===I_e&&(I_j=I_b-I_i),0===I_g||0!=I_f||(I_f=1);for(var I_l=0,I_m=this.elements.length;I_l<I_m;I_l++){var I_n=(I_h=this.elements[I_l])._getCSSStyle();switch(0!==I_j&&(I_h.x+=I_j),I_n._getValign()){case 0:I_h.y=I_d;break;case 1:var I_o=0;99999!=this.minTextHeight&&(I_o=this.minTextHeight);var I_p=(I_o+I_g)/2;I_p=Math.max(I_p,this.h),I_k=(laya.html.dom.HTMLImageElement,I_d+I_p-I_h.height),I_h.y=I_k;break;case 2:I_h.y=I_d+(I_g-I_h.height)}}},I_b.revertOrder=function(I_a){var I_b;if(0<this.elements.length){var I_c,I_d=0;for(I_c=this.elements.length,I_d=0;I_d<I_c;I_d++)(I_b=this.elements[I_d]).x=I_a-I_b.x-I_b.width}},I_a}(),I_x=function(I_c){function I_b(){this.URI=null,this._href=null,I_b.__super.call(this),this._text=I_b._EMPTYTEXT,this.setStyle(new I_i(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}I_g(I_b,"laya.html.dom.HTMLElement",I_c);var I_a=I_b.prototype;return I_a.layaoutCallNative=function(){var I_a=0;if(this._childs&&0<(I_a=this._childs.length))for(var I_b=0;I_b<I_a;I_b++)this._childs[I_b].layaoutCallNative&&this._childs[I_b].layaoutCallNative();var I_c=this._getWords();I_c?laya.html.dom.HTMLElement.fillWords(this,I_c,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},I_a.appendChild=function(I_a){return this.addChild(I_a)},I_a._getWords2=function(){var I_a=this._text.text;if(!I_a||0===I_a.length)return null;var I_b,I_c,I_d=0,I_e=0;if(this._text.drawWords)I_c=this._text.drawWords;else{for(I_e=(I_b=I_a.split(" ")).length-1,I_c=[],I_d=0;I_d<I_e;I_d++)I_c.push(I_b[I_d]," ");0<=I_e&&I_c.push(I_b[I_e]),this._text.drawWords=I_c}var I_f,I_g=this._text.words;if(I_g&&I_g.length===I_c.length)return I_g;null===I_g&&(this._text.words=I_g=[]),I_g.length=I_c.length;var I_h=this.style,I_i=I_h.font;for(I_d=0,I_e=I_c.length;I_d<I_e;I_d++){I_f=I_u.measureText(I_c[I_d],I_i);var I_j=I_g[I_d]=new I_l(I_c[I_d],I_f.width,I_f.height||I_h.fontSize,I_h);if(1<I_j.char.length&&(I_j.charNum=I_j.char),this.href){var I_k=new I_n;this.addChild(I_k),I_j.setSprite(I_k)}}return I_g},I_a._getWords=function(){if(!I_L.CharacterCache)return this._getWords2();var I_a=this._text.text;if(!I_a||0===I_a.length)return null;var I_b,I_c=this._text.words;if(I_c&&I_c.length===I_a.length)return I_c;null===I_c&&(this._text.words=I_c=[]),I_c.length=I_a.length;for(var I_d=this.style,I_e=I_d.font,I_f=0,I_g=I_a.length;I_f<I_g;I_f++)if(I_b=I_u.measureText(I_a.charAt(I_f),I_e)){var I_h=I_c[I_f]=new I_l(I_a.charAt(I_f),I_b.width,I_b.height||I_d.fontSize,I_d);if(this.href){var I_i=new I_n;this.addChild(I_i),I_h.setSprite(I_i)}}else console.warn("_getWords size is null"+I_a.charAt(I_f),I_e);return I_c},I_a.showLinkSprite=function(){var I_a=this._text.words;if(I_a)for(var I_b,I_c,I_d=[],I_e=0;I_e<I_a.length;I_e++)I_c=I_a[I_e],(I_b=new I_n).graphics.drawRect(0,0,I_c.width,I_c.height,"#ff0000"),I_b.width=I_c.width,I_b.height=I_c.height,this.addChild(I_b),I_d.push(I_b)},I_a._layoutLater=function(){var I_a=this.style;512&I_a._type||(I_a.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&I_a.block?(I_w.later(this),I_a._type|=512):this.parent&&this.parent._layoutLater())},I_a._setAttributes=function(I_a,I_b){switch(I_a){case"style":return void this.style.cssText(I_b);case"class":return void(this.className=I_b)}I_c.prototype._setAttributes.call(this,I_a,I_b)},I_a.updateHref=function(){if(null!=this._href){var I_a=this._getWords();if(I_a)for(var I_b,I_c,I_d=0;I_d<I_a.length;I_d++)(I_c=(I_b=I_a[I_d]).getSprite())&&(I_c.size(I_b.width,I_b.height),I_c.on("click",this,this.onLinkHandler))}},I_a.onLinkHandler=function(I_a){switch(I_a.type){case"click":for(var I_b=this;I_b;)I_b.event("link",[this.href]),I_b=I_b.parent}},I_a.formatURL=function(I_a){return this.URI?I_t.formatURL(I_a,this.URI?this.URI.path:null):I_a},I_h(0,I_a,"href",function(){return this._href},function(I_a){null!=(this._href=I_a)&&(this._getCSSStyle().underLine=1,this.updateHref())}),I_h(0,I_a,"color",null,function(I_a){this.style.color=I_a}),I_h(0,I_a,"onClick",null,function(I_a){I_d._runScript("fn=function(event){"+I_a+";}"),this.on("click",this,void 0)}),I_h(0,I_a,"id",null,function(I_a){I_y.document.setElementById(I_a,this)}),I_h(0,I_a,"innerTEXT",function(){return this._text.text},function(I_a){this.text=I_a}),I_h(0,I_a,"style",function(){return this._style}),I_h(0,I_a,"text",function(){return this._text.text},function(I_a){this._text==I_b._EMPTYTEXT?this._text={text:I_a,words:null}:(this._text.text=I_a,this._text.words&&(this._text.words.length=0)),I_m.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),I_h(0,I_a,"parent",I_c.prototype._$get_parent,function(I_a){if(I_a instanceof laya.html.dom.HTMLElement){var I_b=I_a;this.URI||(this.URI=I_b.URI),this.style.inherit(I_b.style)}I_d.superSet(I_n,this,"parent",I_a)}),I_h(0,I_a,"className",null,function(I_a){this.style.attrs(I_y.document.styleSheets["."+I_a])}),I_b.fillWords=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){I_a.graphics.clear();for(var I_h=0,I_i=I_b.length;I_h<I_i;I_h++){var I_j=I_b[I_h];I_a.graphics.fillText(I_j.char,I_j.x+I_c,I_j.y+I_d,I_e,I_f,"left",I_g)}},I_b._EMPTYTEXT={text:null,words:null},I_b}(I_n),I_b=(function(I_a){function I_b(){I_b.__super.call(this),this.style.lineElement=!0,this.style.block=!0}I_g(I_b,"laya.html.dom.HTMLBrElement",I_x)}(),function(I_a){function I_b(){this.contextHeight=NaN,this.contextWidth=NaN,I_b.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}I_g(I_b,"laya.html.dom.HTMLDivElement",I_a);var I_c=I_b.prototype;return I_c.appendHTML=function(I_a){I_v.parse(this,I_a,this.URI),this.layout()},I_c._addChildsToLayout=function(I_b){var I_a=this._getWords();if(null==I_a&&0==this._childs.length)return!1;I_a&&I_a.forEach(function(I_a){I_b.push(I_a)});for(var I_c=!0,I_d=0,I_e=this._childs.length;I_d<I_e;I_d++){var I_f=this._childs[I_d];I_c?I_c=!1:I_b.push(null),I_f._addToLayout(I_b)}return!0},I_c._addToLayout=function(I_a){this.layout()},I_c.layout=function(){if(this.style){this.style._type|=512;var I_a=I_w.layout(this);if(I_a){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new I_k);var I_b=this._$P.mHtmlBounds;I_b.x=I_b.y=0,I_b.width=this.contextWidth=I_a[0],I_b.height=this.contextHeight=I_a[1],this.setBounds(I_b)}}},I_h(0,I_c,"height",function(){return this._height?this._height:this.contextHeight},I_a.prototype._$set_height),I_h(0,I_c,"innerHTML",null,function(I_a){this.destroyChildren(),this.appendHTML(I_a)}),I_h(0,I_c,"width",function(){return this._width?this._width:this.contextWidth},function(I_a){var I_b=!1;I_b=0===I_a?I_a!=this._width:I_a!=this.width,I_d.superSet(I_x,this,"width",I_a),I_b&&this.layout()}),I_b}(I_x)),I_y=function(I_a){function I_b(){this.all=new Array,this.styleSheets=I_i.styleSheets,I_b.__super.call(this)}I_g(I_b,"laya.html.dom.HTMLDocument",I_x);var I_c=I_b.prototype;return I_c.getElementById=function(I_a){return this.all[I_a]},I_c.setElementById=function(I_a,I_b){this.all[I_a]=I_b},I_e(I_b,["document",function(){return this.document=new I_b}]),I_b}();(function(I_a){function I_b(){this._tex=null,this._url=null,this._renderArgs=[],I_b.__super.call(this),this.style.block=!0}I_g(I_b,"laya.html.dom.HTMLImageElement",I_x);var I_c=I_b.prototype;I_c._addToLayout=function(I_a){!this._style.absolute&&I_a.push(this)},I_c.render=function(I_a,I_b,I_c){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(I_p.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,I_a.ctx.drawTexture2(I_b,I_c,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},I_c.layaoutCallNative=function(){var I_a=0;if(this._childs&&0<(I_a=this._childs.length))for(var I_b=0;I_b<I_a;I_b++)this._childs[I_b].layaoutCallNative&&this._childs[I_b].layaoutCallNative()},I_h(0,I_c,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(I_a){this._width!==I_a&&(this._width=I_a,this._style.width=I_a,this.repaint())}),I_h(0,I_c,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(I_a){this._height!==I_a&&(this._height=I_a,this._style.height=I_a,this.repaint())}),I_c.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),I_j.clearCache(this,this._url),this._tex=null),I_x.prototype.destroy.call(this)},I_c.onloaded=function(){var I_a=this._style;I_a&&!I_a.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),I_a&&!I_a.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),I_m.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},I_c._loadImageComplete=function(I_a,I_b,I_c){if(!this._destroyed)if(null!=I_c)if(I_c instanceof ArrayBuffer){var I_d=new DataView(I_c);new laya.webgl.resource.WebGLImage(new Uint8Array(I_c,8),I_a,0,!1,I_d.getUint32(0),I_d.getUint32(4));this.onloaded()}else if(I_c instanceof I_s)I_j.imgMgrSet[I_a]=I_b,I_f.imgMgrLock(I_a,I_j.imgMgrSet[I_a]),this._url=I_a,this._tex=I_c,I_j.keepCache(this,I_a),I_j.cacheRes(I_a,this._tex),this.onloaded();else{var I_e=-1!=I_a.indexOf(".png",I_a.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(I_c,I_a,I_e,!1,I_c.width,I_c.height);this.onloaded()}else this.event("error","Load image failed")},I_h(0,I_c,"src",null,function(I_a){(I_a=this.formatURL(I_a),this._url!=I_a)&&(null!=this._tex&&(I_j.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=I_a,(this._tex=I_j.getRes(I_a))?(I_j.keepCache(this,I_a),this.onloaded()):I_f.imgMgrLoad(I_a,this._loadImageComplete.bind(this),2,!1))})})(),function(I_a){function I_b(){this.type=null,I_b.__super.call(this),this.visible=!1}I_g(I_b,"laya.html.dom.HTMLLinkElement",I_a);var I_c=I_b.prototype;I_c._onload=function(I_a){switch(this.type){case"text/css":I_i.parseCSS(I_a,this.URI)}},I_h(0,I_c,"href",I_a.prototype._$get_href,function(I_a){var I_b=this;I_a=this.formatURL(I_a),this.URI=new I_t(I_a);var I_c=new I_j;I_c.once("complete",null,function(I_a){I_b._onload(I_a)}),I_c.load(I_a,"text")}),I_b._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(I_x),function(I_a){function I_b(){I_b.__super.call(this),this.visible=!1}I_g(I_b,"laya.html.dom.HTMLStyleElement",I_a),I_h(0,I_b.prototype,"text",I_a.prototype._$get_text,function(I_a){I_i.parseCSS(I_a,null)})}(I_x),function(I_a){function I_b(){I_b.__super.call(this),this._getCSSStyle().valign="middle"}I_g(I_b,"laya.html.dom.HTMLIframeElement",I_a),I_h(0,I_b.prototype,"href",I_a.prototype._$get_href,function(I_c){var I_d=this;I_c=this.formatURL(I_c);var I_a=new I_j;I_a.once("complete",null,function(I_a){var I_b=I_d.URI;I_d.URI=new I_t(I_c),I_d.innerHTML=I_a,!I_b||(I_d.URI=I_b)}),I_a.load(I_c,"text")})}(I_b)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(I_a,I_b){"use strict";for(var I_c in Object.defineProperty(I_b,"__esModule",{value:!0}),Laya){var I_d=Laya[I_c];I_d&&I_d.__isclass&&(I_b[I_c]=I_d)}}),function(I_a,I_b,I_p){I_p.un,I_p.uns;var I_d=I_p.static,I_f=I_p.class,I_e=I_p.getset,I_c=(I_p.__newvec,laya.display.Animation),I_s=(laya.utils.Browser,laya.utils.ClassUtils),I_g=laya.filters.ColorFilter,I_h=laya.utils.Ease,I_i=laya.events.Event,I_j=(laya.events.EventDispatcher,laya.display.css.Font),I_k=laya.display.FrameAnimation,I_l=laya.display.Graphics,I_m=laya.utils.Handler,I_n=laya.display.Input,I_u=laya.net.Loader,I_o=(laya.display.Node,laya.maths.Point),I_t=laya.maths.Rectangle,I_v=laya.renders.Render,I_w=laya.display.Sprite,I_x=laya.display.Text,I_y=laya.resource.Texture,I_z=laya.utils.Tween,I_A=laya.utils.Utils,I_B=laya.utils.WeakObject;I_p.interface("laya.ui.IItem"),I_p.interface("laya.ui.ISelect"),I_p.interface("laya.ui.IRender"),I_p.interface("laya.ui.IComponent"),I_p.interface("laya.ui.IBox","IComponent");var I_C=function(){function I_a(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return I_f(I_a,"laya.ui.LayoutStyle"),I_d(I_a,["EMPTY",function(){return this.EMPTY=new I_a}]),I_a}(),I_D=function(){function I_a(){}return I_f(I_a,"laya.ui.Styles"),I_a.labelColor="#000000",I_a.buttonStateNum=3,I_a.scrollBarMinNum=15,I_a.scrollBarDelayTime=500,I_d(I_a,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),I_a}(),I_E=function(){function I_e(){}return I_f(I_e,"laya.ui.UIUtils"),I_e.fillArray=function(I_a,I_b,I_c){var I_d=I_a.concat();if(I_b)for(var I_e=I_b.split(","),I_f=0,I_g=Math.min(I_d.length,I_e.length);I_f<I_g;I_f++){var I_h=I_e[I_f];I_d[I_f]="true"==I_h||"false"!=I_h&&I_h,null!=I_c&&(I_d[I_f]=I_c(I_h))}return I_d},I_e.toColor=function(I_a){return I_A.toHexColor(I_a)},I_e.gray=function(I_a,I_b){void 0===I_b&&(I_b=!0),I_b?I_e.addFilter(I_a,I_e.grayFilter):I_e.clearFilter(I_a,I_g)},I_e.addFilter=function(I_a,I_b){var I_c=I_a.filters||[];I_c.push(I_b),I_a.filters=I_c},I_e.clearFilter=function(I_a,I_b){var I_c=I_a.filters;if(null!=I_c&&0<I_c.length){for(var I_d=I_c.length-1;-1<I_d;I_d--){var I_e=I_c[I_d];I_p.__typeof(I_e,I_b)&&I_c.splice(I_d,1)}I_a.filters=I_c}},I_e._getReplaceStr=function(I_a){return I_e.escapeSequence[I_a]},I_e.adptString=function(I_a){return I_a.replace(/\\(\w)/g,I_e._getReplaceStr)},I_e.getBindFun=function(I_a){var I_b=I_e._funMap.get(I_a);if(null==I_b){var I_c='"'+I_a+'"',I_d="(function(data){if(data==null)return;with(data){try{\nreturn "+(I_c=I_c.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";I_b=I_p._runScript(I_d),I_e._funMap.set(I_a,I_b)}return I_b},I_d(I_e,["grayFilter",function(){return this.grayFilter=new I_g([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new I_B}]),I_e}(),I_F=function(){function I_a(){}return I_f(I_a,"UIConfig"),I_a.touchScrollEnable=!0,I_a.mouseWheelEnable=!0,I_a.showButtons=!0,I_a.popupBgColor="#000000",I_a.popupBgAlpha=.5,I_a.closeDialogOnSide=!0,I_a}(),I_G=function(I_c){function I_t(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,I_t.__super.call(this),this._weakKeys=[]}I_f(I_t,"laya.ui.AutoBitmap",I_c);var I_a=I_t.prototype;return I_a.destroy=function(){if(I_u.clearObject(this,this._weakKey),this._weakKeys){for(var I_a=0,I_b=this._weakKeys.length;I_a<I_b;++I_a)I_u.clearObject(this,this._weakKeys[I_a]);this._weakKeys=null}I_c.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},I_a._setChanged=function(){this._isChanged||(this._isChanged=!0,I_p.timer.callLater(this,this.changeSource))},I_a.changeSource=function(){this._isChanged=!1;var I_a=this._source;if(I_a&&I_a.bitmap){var I_b=this.width,I_c=this.height,I_d=this._sizeGrid,I_e=I_a.sourceWidth,I_f=I_a.sourceHeight;if(!I_d||I_e===I_b&&I_f===I_c)this.cleanByTexture(I_a,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,I_b,I_c);else{I_u.clearObject(this,this._weakKey),I_a.$_GID||(I_a.$_GID=I_A.getGID());var I_g=I_a.$_GID+"."+I_b+"."+I_c+"."+I_d.join("."),I_h=I_u.findObject(I_g);if(I_A.isOKCmdList(I_h))return this._weakKey=I_g,I_u.keepObject(this,this._weakKey),void(this.cmds=I_h);this.clear();var I_i,I_j,I_k=I_d[0],I_l=I_d[1],I_m=I_d[2],I_n=I_d[3],I_o=I_d[4],I_p=!1;if(I_b==I_e&&(I_n=I_l=0),I_c==I_f&&(I_k=I_m=0),I_b<I_n+I_l){var I_s=I_b;I_p=!0,I_b=I_n+I_l,this.save(),this.clipRect(0,0,I_s,I_c)}I_n&&I_k&&(I_i=I_t.getTexture(I_a,0,0,I_n,I_k),I_j=this._weakKeys[0],I_i?(I_j!=I_i.weakKey&&(I_u.clearObject(this,I_j),I_u.keepObject(this,I_i.weakKey),this._weakKeys[0]=I_i.weakKey),this.drawTexture(I_i,0,0,I_n,I_k)):(I_u.clearObject(this,I_j),this._weakKeys[0]="")),I_l&&I_k&&(I_i=I_t.getTexture(I_a,I_e-I_l,0,I_l,I_k),I_j=this._weakKeys[1],I_i?(I_j!=I_i.weakKey&&(I_u.clearObject(this,I_j),I_u.keepObject(this,I_i.weakKey),this._weakKeys[1]=I_i.weakKey),this.drawTexture(I_i,I_b-I_l,0,I_l,I_k)):(I_u.clearObject(this,I_j),this._weakKeys[1]="")),I_n&&I_m&&(I_i=I_t.getTexture(I_a,0,I_f-I_m,I_n,I_m),I_j=this._weakKeys[2],I_i?(I_j!=I_i.weakKey&&(I_u.clearObject(this,I_j),I_u.keepObject(this,I_i.weakKey),this._weakKeys[2]=I_i.weakKey),this.drawTexture(I_i,0,I_c-I_m,I_n,I_m)):(I_u.clearObject(this,I_j),this._weakKeys[2]="")),I_l&&I_m&&(I_i=I_t.getTexture(I_a,I_e-I_l,I_f-I_m,I_l,I_m),I_j=this._weakKeys[3],I_i?(I_j!=I_i.weakKey&&(I_u.clearObject(this,I_j),I_u.keepObject(this,I_i.weakKey),this._weakKeys[3]=I_i.weakKey),this.drawTexture(I_i,I_b-I_l,I_c-I_m,I_l,I_m)):(I_u.clearObject(this,I_j),this._weakKeys[3]="")),I_k&&(I_i=I_t.getTexture(I_a,I_n,0,I_e-I_n-I_l,I_k),I_j=this._weakKeys[4],I_i?(I_j!=I_i.weakKey&&(I_u.clearObject(this,I_j),I_u.keepObject(this,I_i.weakKey),this._weakKeys[4]=I_i.weakKey),this.drawBitmap(I_o,I_i,I_n,0,I_b-I_n-I_l,I_k)):(I_u.clearObject(this,I_j),this._weakKeys[4]="")),I_m&&(I_i=I_t.getTexture(I_a,I_n,I_f-I_m,I_e-I_n-I_l,I_m),I_j=this._weakKeys[5],I_i?(I_j!=I_i.weakKey&&(I_u.clearObject(this,I_j),I_u.keepObject(this,I_i.weakKey),this._weakKeys[5]=I_i.weakKey),this.drawBitmap(I_o,I_i,I_n,I_c-I_m,I_b-I_n-I_l,I_m)):(I_u.clearObject(this,I_j),this._weakKeys[5]="")),I_n&&(I_i=I_t.getTexture(I_a,0,I_k,I_n,I_f-I_k-I_m),I_j=this._weakKeys[6],I_i?(I_j!=I_i.weakKey&&(I_u.clearObject(this,I_j),I_u.keepObject(this,I_i.weakKey),this._weakKeys[6]=I_i.weakKey),this.drawBitmap(I_o,I_i,0,I_k,I_n,I_c-I_k-I_m)):(I_u.clearObject(this,I_j),this._weakKeys[6]="")),I_l&&(I_i=I_t.getTexture(I_a,I_e-I_l,I_k,I_l,I_f-I_k-I_m),I_j=this._weakKeys[7],I_i?(I_j!=I_i.weakKey&&(I_u.clearObject(this,I_j),I_u.keepObject(this,I_i.weakKey),this._weakKeys[7]=I_i.weakKey),this.drawBitmap(I_o,I_i,I_b-I_l,I_k,I_l,I_c-I_k-I_m)):(I_u.clearObject(this,I_j),this._weakKeys[7]="")),I_i=I_t.getTexture(I_a,I_n,I_k,I_e-I_n-I_l,I_f-I_k-I_m),I_j=this._weakKeys[8],I_i?(I_j!=I_i.weakKey&&(I_u.clearObject(this,I_j),I_u.keepObject(this,I_i.weakKey),this._weakKeys[8]=I_i.weakKey),this.drawBitmap(I_o,I_i,I_n,I_k,I_b-I_n-I_l,I_c-I_k-I_m)):(I_u.clearObject(this,I_j),this._weakKeys[8]=""),I_p&&this.restore(),this.autoCacheCmd&&!I_v.isConchApp&&(I_u.saveObject(I_g,this.cmds,null),this._weakKey=I_g,I_u.keepObject(this,this._weakKey))}this._repaint()}},I_a.drawBitmap=function(I_a,I_b,I_c,I_d,I_e,I_f){void 0===I_e&&(I_e=0),void 0===I_f&&(I_f=0),I_e<.1||I_f<.1||(!I_a||I_b.width==I_e&&I_b.height==I_f?this.drawTexture(I_b,I_c,I_d,I_e,I_f):this.fillTexture(I_b,I_c,I_d,I_e,I_f))},I_a.clear=function(I_a){void 0===I_a&&(I_a=!0),I_c.prototype.clear.call(this,!1)},I_e(0,I_a,"sizeGrid",function(){return this._sizeGrid},function(I_a){this._sizeGrid=I_a,this._setChanged()}),I_e(0,I_a,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(I_a){this._width!=I_a&&(this._width=I_a,this._setChanged())}),I_e(0,I_a,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(I_a){this._height!=I_a&&(this._height=I_a,this._setChanged())}),I_e(0,I_a,"source",function(){return this._source},function(I_a){I_a?(this._source=I_a,this._setChanged()):(this._source=null,this.clear())}),I_t.getTexture=function(I_a,I_b,I_c,I_d,I_e){I_d<=0&&(I_d=1),I_e<=0&&(I_e=1),I_a.$_GID||(I_a.$_GID=I_A.getGID());var I_f=I_a.$_GID+"."+I_b+"."+I_c+"."+I_d+"."+I_e,I_g=I_u.findObject(I_f);if((!I_g||!I_g.source)&&(I_g=I_y.createFromTexture(I_a,I_b,I_c,I_d,I_e))){if(I_a.alphaTexture){var I_h=I_a.width/I_a.alphaTexture.width;I_g.alphaTexture=I_y.createFromTexture(I_a.alphaTexture,I_b/I_h,I_c/I_h,I_d/I_h,I_e/I_h)}I_u.saveObject(I_f,I_g),I_g.weakKey=I_f}return I_g},I_t}(I_l),I_H=(function(I_a){function I_b(){I_b.__super.call(this)}I_f(I_b,"laya.ui.UIEvent",I_i),I_b.SHOW_TIP="showtip",I_b.HIDE_TIP="hidetip"}(),function(I_b){function I_a(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,I_a.__super.call(this),this._layout=I_C.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}I_f(I_a,"laya.ui.Component",I_b);var I_c=I_a.prototype;return I_p.imps(I_c,{"laya.ui.IComponent":!0}),I_c.destroy=function(I_a){void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,I_a),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},I_c.preinitialize=function(){},I_c.createChildren=function(){},I_c.initialize=function(){},I_c.callLater=function(I_a,I_b){I_p.timer.callLater(this,I_a,I_b)},I_c.runCallLater=function(I_a){I_p.timer.runCallLater(this,I_a)},I_c.commitMeasure=function(){},I_c.changeSize=function(){this.event("resize")},I_c.getLayout=function(){return this._layout===I_C.EMPTY&&(this._layout=new I_C),this._layout},I_c._setLayoutEnabled=function(I_a){this._layout&&this._layout.enable!=I_a&&(this._layout.enable=I_a,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},I_c.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},I_c.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},I_c.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},I_c.resetLayoutX=function(){var I_a=this._layout;if(isNaN(I_a.anchorX)||(this.pivotX=I_a.anchorX*this.width),this.layoutEnabled){var I_b=this.parent;I_b&&(isNaN(I_a.centerX)?isNaN(I_a.left)?isNaN(I_a.right)||(this.x=Math.round(I_b.width-this.displayWidth-I_a.right+this.pivotX*this.scaleX)):(this.x=Math.round(I_a.left+this.pivotX*this.scaleX),isNaN(I_a.right)||(this.width=(I_b._width-I_a.left-I_a.right)/(this.scaleX||.01))):this.x=Math.round(.5*(I_b.width-this.displayWidth)+I_a.centerX+this.pivotX*this.scaleX))}},I_c.resetLayoutY=function(){var I_a=this._layout;if(isNaN(I_a.anchorY)||(this.pivotY=I_a.anchorY*this.height),this.layoutEnabled){var I_b=this.parent;I_b&&(isNaN(I_a.centerY)?isNaN(I_a.top)?isNaN(I_a.bottom)||(this.y=Math.round(I_b.height-this.displayHeight-I_a.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(I_a.top+this.pivotY*this.scaleY),isNaN(I_a.bottom)||(this.height=(I_b._height-I_a.top-I_a.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(I_b.height-this.displayHeight)+I_a.centerY+this.pivotY*this.scaleY))}},I_c.onMouseOver=function(I_a){I_p.stage.event("showtip",this._toolTip)},I_c.onMouseOut=function(I_a){I_p.stage.event("hidetip",this._toolTip)},I_e(0,I_c,"displayWidth",function(){return this.width*this.scaleX}),I_e(0,I_c,"width",function(){return this._width?this._width:this.measureWidth},function(I_a){this._width!=I_a&&(this._width=I_a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),I_e(0,I_c,"measureWidth",function(){var I_a=0;this.commitMeasure();for(var I_b=this.numChildren-1;-1<I_b;I_b--){var I_c=this.getChildAt(I_b);I_c.visible&&(I_a=Math.max(I_c.x+I_c.width*I_c.scaleX,I_a))}return I_a}),I_e(0,I_c,"displayHeight",function(){return this.height*this.scaleY}),I_e(0,I_c,"height",function(){return this._height?this._height:this.measureHeight},function(I_a){this._height!=I_a&&(this._height=I_a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),I_e(0,I_c,"dataSource",function(){return this._dataSource},function(I_a){for(var I_b in this._dataSource=I_a,this._dataSource)this.hasOwnProperty(I_b)&&"function"!=typeof this[I_b]&&(this[I_b]=this._dataSource[I_b])}),I_e(0,I_c,"scaleY",I_b.prototype._$get_scaleY,function(I_a){I_p.superGet(I_w,this,"scaleY")!=I_a&&(I_p.superSet(I_w,this,"scaleY",I_a),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),I_e(0,I_c,"measureHeight",function(){var I_a=0;this.commitMeasure();for(var I_b=this.numChildren-1;-1<I_b;I_b--){var I_c=this.getChildAt(I_b);I_c.visible&&(I_a=Math.max(I_c.y+I_c.height*I_c.scaleY,I_a))}return I_a}),I_e(0,I_c,"scaleX",I_b.prototype._$get_scaleX,function(I_a){I_p.superGet(I_w,this,"scaleX")!=I_a&&(I_p.superSet(I_w,this,"scaleX",I_a),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),I_e(0,I_c,"top",function(){return this._layout.top},function(I_a){I_a!=this._layout.top&&(this.getLayout().top=I_a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),I_e(0,I_c,"bottom",function(){return this._layout.bottom},function(I_a){I_a!=this._layout.bottom&&(this.getLayout().bottom=I_a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),I_e(0,I_c,"left",function(){return this._layout.left},function(I_a){I_a!=this._layout.left&&(this.getLayout().left=I_a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),I_e(0,I_c,"right",function(){return this._layout.right},function(I_a){I_a!=this._layout.right&&(this.getLayout().right=I_a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),I_e(0,I_c,"centerX",function(){return this._layout.centerX},function(I_a){I_a!=this._layout.centerX&&(this.getLayout().centerX=I_a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),I_e(0,I_c,"centerY",function(){return this._layout.centerY},function(I_a){I_a!=this._layout.centerY&&(this.getLayout().centerY=I_a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),I_e(0,I_c,"anchorX",function(){return this._layout.anchorX},function(I_a){I_a!=this._layout.anchorX&&(this.getLayout().anchorX=I_a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),I_e(0,I_c,"anchorY",function(){return this._layout.anchorY},function(I_a){I_a!=this._layout.anchorY&&(this.getLayout().anchorY=I_a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),I_e(0,I_c,"tag",function(){return this._tag},function(I_a){this._tag=I_a}),I_e(0,I_c,"toolTip",function(){return this._toolTip},function(I_a){this._toolTip!=I_a&&(null!=(this._toolTip=I_a)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),I_e(0,I_c,"comXml",function(){return this._comXml},function(I_a){this._comXml=I_a}),I_e(0,I_c,"gray",function(){return this._gray},function(I_a){I_a!==this._gray&&(this._gray=I_a,I_E.gray(this,I_a))}),I_e(0,I_c,"disabled",function(){return this._disabled},function(I_a){I_a!==this._disabled&&(this.gray=this._disabled=I_a,this.mouseEnabled=!I_a)}),I_a}(I_w)),I_I=function(I_a){function I_b(){this.lockLayer=null,this.popupEffect=function(I_a){I_a.scale(1,1),I_z.from(I_a,{x:I_p.stage.width/2,y:I_p.stage.height/2,scaleX:0,scaleY:0},300,I_h.backOut,I_m.create(this,this.doOpen,[I_a]))},this.closeEffect=function(I_a,I_b){I_z.to(I_a,{x:I_p.stage.width/2,y:I_p.stage.height/2,scaleX:0,scaleY:0},300,I_h.strongOut,I_m.create(this,this.doClose,[I_a,I_b]))},I_b.__super.call(this),this.maskLayer=new I_w,this.popupEffectHandler=I_m.create(this,this.popupEffect,null,!1),this.closeEffectHandler=I_m.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,I_p.stage.addChild(this),I_p.stage.on("resize",this,this._onResize),I_F.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}I_f(I_b,"laya.ui.DialogManager",I_w);var I_c=I_b.prototype;return I_c._closeOnSide=function(){var I_a=this.getChildAt(this.numChildren-1);I_a instanceof laya.ui.Dialog&&I_a.close("side")},I_c.setLockView=function(I_a){this.lockLayer||(this.lockLayer=new I_J,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(I_p.stage.width,I_p.stage.height)),this.lockLayer.removeChildren(),I_a&&(I_a.centerX=I_a.centerY=0,this.lockLayer.addChild(I_a))},I_c._onResize=function(I_a){var I_b=this.maskLayer.width=I_p.stage.width,I_c=this.maskLayer.height=I_p.stage.height;this.lockLayer&&this.lockLayer.size(I_b,I_c),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,I_b,I_c,I_F.popupBgColor),this.maskLayer.alpha=I_F.popupBgAlpha;for(var I_d=this.numChildren-1;-1<I_d;I_d--){var I_e=this.getChildAt(I_d);I_e.popupCenter&&this._centerDialog(I_e)}},I_c._centerDialog=function(I_a){I_a.x=Math.round((I_p.stage.width-I_a.width>>1)+I_a.pivotX),I_a.y=Math.round((I_p.stage.height-I_a.height>>1)+I_a.pivotY)},I_c.open=function(I_a,I_b,I_c){void 0===I_b&&(I_b=!1),void 0===I_c&&(I_c=!1),I_b&&this._closeAll(),I_a.popupCenter&&this._centerDialog(I_a),this.addChild(I_a),(I_a.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),I_c&&null!=I_a.popupEffect?I_a.popupEffect.runWith(I_a):this.doOpen(I_a),this.event("open")},I_c.doOpen=function(I_a){I_a.onOpened()},I_c.lock=function(I_a){this.lockLayer&&(I_a?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},I_c.close=function(I_a,I_b,I_c){void 0===I_c&&(I_c=!1),I_c&&null!=I_a.closeEffect?I_a.closeEffect.runWith([I_a,I_b]):this.doClose(I_a,I_b),this.event("close")},I_c.doClose=function(I_a,I_b){I_a.removeSelf(),I_a.isModal&&this._checkMask(),I_a.closeHandler&&I_a.closeHandler.runWith(I_b),I_a.onClosed(I_b)},I_c.closeAll=function(){this._closeAll(),this.event("close")},I_c._closeAll=function(){for(var I_a=this.numChildren-1;-1<I_a;I_a--){var I_b=this.getChildAt(I_a);I_b&&null!=I_b.close&&this.doClose(I_b)}},I_c.getDialogsByGroup=function(I_a){for(var I_b=[],I_c=this.numChildren-1;-1<I_c;I_c--){var I_d=this.getChildAt(I_c);I_d&&I_d.group===I_a&&I_b.push(I_d)}return I_b},I_c.closeByGroup=function(I_a){for(var I_b=[],I_c=this.numChildren-1;-1<I_c;I_c--){var I_d=this.getChildAt(I_c);I_d&&I_d.group===I_a&&(I_d.close(),I_b.push(I_d))}return I_b},I_c._checkMask=function(){this.maskLayer.removeSelf();for(var I_a=this.numChildren-1;-1<I_a;I_a--){var I_b=this.getChildAt(I_a);if(I_b&&I_b.isModal)return void this.addChildAt(this.maskLayer,I_a)}},I_b}(),I_J=function(I_a){function I_b(){I_b.__super.call(this)}I_f(I_b,"laya.ui.Box",I_a);var I_c=I_b.prototype;return I_p.imps(I_c,{"laya.ui.IBox":!0}),I_e(0,I_c,"dataSource",I_a.prototype._$get_dataSource,function(I_a){for(var I_b in this._dataSource=I_a){var I_c=this.getChildByName(I_b);I_c?I_c.dataSource=I_a[I_b]:this.hasOwnProperty(I_b)&&"function"!=typeof this[I_b]&&(this[I_b]=I_a[I_b])}}),I_b}(I_H),I_K=function(I_b){function I_c(I_a,I_b){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,I_c.__super.call(this),this._labelColors=I_D.buttonLabelColors,this._stateNum=I_D.buttonStateNum,void 0===I_b&&(I_b=""),this.skin=I_a,this.label=I_b}I_f(I_c,"laya.ui.Button",I_b);var I_a=I_c.prototype;return I_p.imps(I_a,{"laya.ui.ISelect":!0}),I_a.destroy=function(I_a){I_u.clearCache(this,this._skin),I_u.clearObject(this,this._weakKey),void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,I_a),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(I_a),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},I_a.createChildren=function(){this.graphics=this._bitmap=new I_G},I_a.createText=function(){this._text||(this._text=new I_x,this._text.overflow=I_x.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},I_a.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},I_a.onMouse=function(I_a){if(!1!==this.toggle||!this._selected)return"click"===I_a.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=I_c.stateMap[I_a.type]))},I_a.changeClips=function(){var I_a=I_u.getRes(this._skin);if(I_a&&this._skin&&""!=this._skin){I_u.clearObject(this,this._weakKey);var I_b=I_a.sourceWidth,I_c=I_a.sourceHeight/this._stateNum;I_a.$_GID||(I_a.$_GID=I_A.getGID());var I_d=I_a.$_GID+"-"+this._stateNum,I_e=I_u.findObject(I_d);if(I_A.isOkTextureList(I_e)||(I_e=null),I_e)this._weakKey=I_d,I_u.keepObject(this,this._weakKey),this._sources=I_e;else{if(this._sources=[],1===this._stateNum)this._sources.push(I_a);else for(var I_f=0;I_f<this._stateNum;I_f++){var I_g=I_y.createFromTexture(I_a,0,I_c*I_f,I_b,I_c);if(I_a.alphaTexture){var I_h=I_a.width/I_a.alphaTexture.width;I_g.alphaTexture=I_y.createFromTexture(I_a.alphaTexture,0/I_h,I_c*I_f/I_h,I_b/I_h,I_c/I_h)}this._sources.push(I_g)}I_u.saveObject(I_d,this._sources),this._weakKey=I_d,I_u.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||I_b,this._bitmap.height=this._height||I_c,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=I_b)}else console.warn("lose skin ",this._skin,this.name,this.__className)},I_a.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var I_a=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[I_a]),this.label&&(this._text.color=this._labelColors[I_a],this._strokeColors&&(this._text.strokeColor=this._strokeColors[I_a]))},I_a._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},I_e(0,I_a,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(I_a){this.createText(),this._text.strokeColor=I_a}),I_e(0,I_a,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),I_e(0,I_a,"skin",function(){return this._skin},function(I_a){this._skin!=I_a&&(I_u.clearCache(this,this._skin),this._skin=I_a,I_u.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),I_e(0,I_a,"state",function(){return this._state},function(I_a){this._state!=I_a&&(this._state=I_a,this._setStateChanged())}),I_e(0,I_a,"text",function(){return this.createText(),this._text}),I_e(0,I_a,"stateNum",function(){return this._stateNum},function(I_a){"string"==typeof I_a&&(I_a=parseInt(I_a)),this._stateNum!=I_a&&(this._stateNum=I_a<1?1:3<I_a?3:I_a,this.callLater(this.changeClips))}),I_e(0,I_a,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(I_a){this._strokeColors=I_E.fillArray(I_D.buttonLabelColors,I_a,String),this._setStateChanged()}),I_e(0,I_a,"labelColors",function(){return this._labelColors.join(",")},function(I_a){this._labelColors=I_E.fillArray(I_D.buttonLabelColors,I_a,String),this._setStateChanged()}),I_e(0,I_a,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),I_e(0,I_a,"label",function(){return this._text?this._text.text:null},function(I_a){(this._text||I_a)&&(this.createText(),this._text.text!=I_a&&(I_a&&!this._text.parent&&this.addChild(this._text),this._text.text=(I_a+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),I_e(0,I_a,"selected",function(){return this._selected},function(I_a){this._selected!=I_a&&(this._selected=I_a,this.state=this._selected?2:0,this.event("change"))}),I_e(0,I_a,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(I_a){this.createText(),this._text.padding=I_E.fillArray(I_D.labelPadding,I_a,Number)}),I_e(0,I_a,"labelSize",function(){return this.createText(),this._text.fontSize},function(I_a){this.createText(),this._text.fontSize=I_a}),I_e(0,I_a,"labelStroke",function(){return this.createText(),this._text.stroke},function(I_a){this.createText(),this._text.stroke=I_a}),I_e(0,I_a,"labelBold",function(){return this.createText(),this._text.bold},function(I_a){this.createText(),this._text.bold=I_a}),I_e(0,I_a,"labelFont",function(){return this.createText(),this._text.font},function(I_a){this.createText(),this._text.font=I_a}),I_e(0,I_a,"labelAlign",function(){return this.createText(),this._text.align},function(I_a){this.createText(),this._text.align=I_a}),I_e(0,I_a,"clickHandler",function(){return this._clickHandler},function(I_a){this._clickHandler=I_a}),I_e(0,I_a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(I_a){this._bitmap.sizeGrid=I_E.fillArray(I_D.defaultSizeGrid,I_a,Number)}),I_e(0,I_a,"width",I_b.prototype._$get_width,function(I_a){I_p.superSet(I_H,this,"width",I_a),this._autoSize&&(this._bitmap.width=I_a,this._text&&(this._text.width=I_a))}),I_e(0,I_a,"height",I_b.prototype._$get_height,function(I_a){I_p.superSet(I_H,this,"height",I_a),this._autoSize&&(this._bitmap.height=I_a,this._text&&(this._text.height=I_a))}),I_e(0,I_a,"dataSource",I_b.prototype._$get_dataSource,function(I_a){"number"==typeof(this._dataSource=I_a)||"string"==typeof I_a?this.label=I_a+"":I_p.superSet(I_H,this,"dataSource",I_a)}),I_e(0,I_a,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(I_a){this._bitmap._offset=I_a?I_E.fillArray([1,1],I_a,Number):[]}),I_d(I_c,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),I_c}(I_H),I_L=function(I_b){function I_d(I_a,I_b,I_c){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,I_d.__super.call(this),void 0===I_b&&(I_b=1),void 0===I_c&&(I_c=1),this._clipX=I_b,this._clipY=I_c,this.skin=I_a}I_f(I_d,"laya.ui.Clip",I_b);var I_a=I_d.prototype;return I_a.destroy=function(I_a){I_u.clearCache(this,this._skin),I_u.clearObject(this,this._weakKey),void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},I_a.dispose=function(){this.destroy(!0),I_p.loader.clearRes(this._skin)},I_a.createChildren=function(){this.graphics=this._bitmap=new I_G},I_a._onDisplay=function(I_a){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},I_a.changeClip=function(){if(this._clipChanged=!1,this._skin){var I_a=I_u.getRes(this._skin);I_a?this.loadComplete(this._skin,I_a):I_p.loader.load(this._skin,I_m.create(this,this.loadComplete,[this._skin]))}},I_a.loadComplete=function(I_a,I_b){if(I_a===this._skin&&I_b){I_u.clearObject(this,this._weakKey);var I_c=this._clipWidth||Math.ceil(I_b.sourceWidth/this._clipX),I_d=this._clipHeight||Math.ceil(I_b.sourceHeight/this._clipY),I_e=this._skin+I_c+I_d,I_f=I_u.findObject(I_e);if(I_A.isOkTextureList(I_f)||(I_f=null),I_f)this._weakKey=I_e,I_u.keepObject(this,this._weakKey),this._sources=I_f;else{this._sources=[];for(var I_g=0;I_g<this._clipY;I_g++)for(var I_h=0;I_h<this._clipX;I_h++){var I_i=I_y.createFromTexture(I_b,I_c*I_h,I_d*I_g,I_c,I_d);if(I_b.alphaTexture){var I_j=I_b.width/I_b.alphaTexture.width;I_i.alphaTexture=I_y.createFromTexture(I_b.alphaTexture,I_c*I_h/I_j,I_d*I_g/I_j,I_c/I_j,I_d/I_j)}this._sources.push(I_i)}I_u.saveObject(I_e,this._sources),this._weakKey=I_e,I_u.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},I_a.play=function(I_a,I_b){void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=-1),this._isPlaying=!0,this.index=I_a,this._toIndex=I_b,this._index++,I_p.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},I_a._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},I_a.stop=function(){this._isPlaying=!1,I_p.timer.clear(this,this._loop),this.event("complete")},I_a._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},I_e(0,I_a,"interval",function(){return this._interval},function(I_a){this._interval!=I_a&&(this._interval=I_a,this._isPlaying&&this.play())}),I_e(0,I_a,"skin",function(){return this._skin},function(I_a){this._skin!=I_a&&(I_u.clearCache(this,this._skin),(this._skin=I_a)?(I_u.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),I_e(0,I_a,"sources",function(){return this._sources},function(I_a){this._sources=I_a,this.index=this._index,this.event("loaded")}),I_e(0,I_a,"clipX",function(){return this._clipX},function(I_a){this._clipX=I_a||1,this._setClipChanged()}),I_e(0,I_a,"clipY",function(){return this._clipY},function(I_a){this._clipY=I_a||1,this._setClipChanged()}),I_e(0,I_a,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),I_e(0,I_a,"clipWidth",function(){return this._clipWidth},function(I_a){this._clipWidth=I_a,this._setClipChanged()}),I_e(0,I_a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(I_a){this._bitmap.sizeGrid=I_E.fillArray(I_D.defaultSizeGrid,I_a,Number)}),I_e(0,I_a,"group",function(){return this._group},function(I_a){I_a&&this._skin&&I_u.setGroup(this._skin,I_a),this._group=I_a}),I_e(0,I_a,"clipHeight",function(){return this._clipHeight},function(I_a){this._clipHeight=I_a,this._setClipChanged()}),I_e(0,I_a,"width",I_b.prototype._$get_width,function(I_a){I_p.superSet(I_H,this,"width",I_a),this._bitmap.width=I_a}),I_e(0,I_a,"height",I_b.prototype._$get_height,function(I_a){I_p.superSet(I_H,this,"height",I_a),this._bitmap.height=I_a}),I_e(0,I_a,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),I_e(0,I_a,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),I_e(0,I_a,"index",function(){return this._index},function(I_a){this._index=I_a,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[I_a]),this.event("change")}),I_e(0,I_a,"autoPlay",function(){return this._autoPlay},function(I_a){this._autoPlay!=I_a&&((this._autoPlay=I_a)?this.play():this.stop())}),I_e(0,I_a,"isPlaying",function(){return this._isPlaying},function(I_a){this._isPlaying=I_a}),I_e(0,I_a,"dataSource",I_b.prototype._$get_dataSource,function(I_a){"number"==typeof(this._dataSource=I_a)&&Math.floor(I_a)==I_a||"string"==typeof I_a?this.index=parseInt(I_a):I_p.superSet(I_H,this,"dataSource",I_a)}),I_e(0,I_a,"bitmap",function(){return this._bitmap}),I_d}(I_H),I_M=function(I_b){function I_a(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,I_a.__super.call(this)}I_f(I_a,"laya.ui.ColorPicker",I_b);var I_c=I_a.prototype;return I_c.destroy=function(I_a){void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,I_a),this._colorPanel&&this._colorPanel.destroy(I_a),this._colorButton&&this._colorButton.destroy(I_a),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},I_c.createChildren=function(){this.addChild(this._colorButton=new I_K),this._colorPanel=new I_J,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new I_w),this._colorPanel.addChild(this._colorBlock=new I_w),this._colorPanel.addChild(this._colorInput=new I_n)},I_c.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},I_c.onPanelMouseDown=function(I_a){I_a.stopPropagation()},I_c.changePanel=function(){this._panelChanged=!1;var I_a=this._colorPanel.graphics;I_a.clear(),I_a.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(I_a=this._colorTiles.graphics).clear();for(var I_b=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],I_c=0;I_c<12;I_c++)for(var I_d=0;I_d<20;I_d++){var I_e=0;I_e=0===I_d?I_b[I_c]:1===I_d?0:51*(((3*I_c+I_d/6)%3<<0)+3*(I_c/6<<0))<<16|I_d%6*51<<8|(I_c<<0)%6*51;var I_f=I_E.toColor(I_e);this._colors.push(I_f);var I_g=I_d*this._gridSize,I_h=I_c*this._gridSize;I_a.drawRect(I_g,I_h,this._gridSize,this._gridSize,I_f,"#000000")}},I_c.onColorButtonClick=function(I_a){this._colorPanel.parent?this.close():this.open()},I_c.open=function(){var I_a=this.localToGlobal(new I_o),I_b=I_a.x+this._colorPanel.width<=I_p.stage.width?I_a.x:I_p.stage.width-this._colorPanel.width,I_c=I_a.y+this._colorButton.height;I_c=I_c+this._colorPanel.height<=I_p.stage.height?I_c:I_a.y-this._colorPanel.height,this._colorPanel.pos(I_b,I_c),this._colorPanel.zOrder=1001,I_p._currentStage.addChild(this._colorPanel),I_p.stage.on("mousedown",this,this.removeColorBox)},I_c.close=function(){I_p.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},I_c.removeColorBox=function(I_a){this.close()},I_c.onColorFieldKeyDown=function(I_a){13==I_a.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),I_a.stopPropagation())},I_c.onColorInputChange=function(I_a){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},I_c.onColorTilesClick=function(I_a){this.selectedColor=this.getColorByMouse(),this.close()},I_c.onColorTilesMouseMove=function(I_a){this._colorInput.focus=!1;var I_b=this.getColorByMouse();this._colorInput.text=I_b,this.drawBlock(I_b)},I_c.getColorByMouse=function(){var I_a=this._colorTiles.getMousePoint(),I_b=Math.floor(I_a.x/this._gridSize),I_c=Math.floor(I_a.y/this._gridSize);return this._colors[20*I_c+I_b]},I_c.drawBlock=function(I_a){var I_b=this._colorBlock.graphics;I_b.clear();var I_c=I_a||"#ffffff";I_b.drawRect(0,0,50,20,I_c,this._borderColor),I_a||I_b.drawLine(0,0,50,20,"#ff0000")},I_c.changeColor=function(){var I_a=this.graphics;I_a.clear();var I_b=this._selectedColor||"#000000";I_a.drawRect(0,0,this._colorButton.width,this._colorButton.height,I_b)},I_c._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},I_e(0,I_c,"inputBgColor",function(){return this._inputBgColor},function(I_a){this._inputBgColor=I_a,this._setPanelChanged()}),I_e(0,I_c,"selectedColor",function(){return this._selectedColor},function(I_a){this._selectedColor!=I_a&&(this._selectedColor=this._colorInput.text=I_a,this.drawBlock(I_a),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",I_i.EMPTY.setTo("change",this,this)))}),I_e(0,I_c,"skin",function(){return this._colorButton.skin},function(I_a){this._colorButton.skin=I_a,this.changeColor()}),I_e(0,I_c,"bgColor",function(){return this._bgColor},function(I_a){this._bgColor=I_a,this._setPanelChanged()}),I_e(0,I_c,"borderColor",function(){return this._borderColor},function(I_a){this._borderColor=I_a,this._setPanelChanged()}),I_e(0,I_c,"inputColor",function(){return this._inputColor},function(I_a){this._inputColor=I_a,this._setPanelChanged()}),I_a}(I_H),I_N=function(I_b){function I_c(I_a,I_b){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,I_c.__super.call(this),this._itemColors=I_D.comboBoxItemColors,this.skin=I_a,this.labels=I_b}I_f(I_c,"laya.ui.ComboBox",I_b);var I_a=I_c.prototype;return I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,I_a),this._button&&this._button.destroy(I_a),this._list&&this._list.destroy(I_a),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},I_a.createChildren=function(){this.addChild(this._button=new I_K),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},I_a._createList=function(){this._list=new I_X,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},I_a._setListEvent=function(I_a){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=I_m.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},I_a.onListDown=function(I_a){I_a.stopPropagation()},I_a.onScrollBarDown=function(I_a){I_a.stopPropagation()},I_a.onButtonMouseDown=function(I_a){this.callLater(this.switchTo,[!this._isOpen])},I_a.changeList=function(){this._listChanged=!1;var I_a=this.width-2,I_b=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:I_a,height:this._itemHeight,fontSize:this._itemSize,color:I_b}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},I_a.onlistItemMouse=function(I_a,I_b){var I_c=I_a.type;if("mouseover"===I_c||"mouseout"===I_c){if(this._isCustomList)return;var I_d=this._list.getCell(I_b);if(!I_d)return;var I_e=I_d.getChildByName("label");I_e&&("mouseover"===I_c?(I_e.bgColor=this._itemColors[0],I_e.color=this._itemColors[1]):(I_e.bgColor=null,I_e.color=this._itemColors[2]))}else"click"===I_c&&(this.selectedIndex=I_b,this.isOpen=!1)},I_a.switchTo=function(I_a){this.isOpen=I_a},I_a.changeOpen=function(){this.isOpen=!this._isOpen},I_a.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var I_a=this._list.graphics;I_a.clear(),I_a.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var I_b=this._list.array||[],I_c=I_b.length=0,I_d=this._labels.length;I_c<I_d;I_c++)I_b.push({label:this._labels[I_c]});this._list.height=this._listHeight,this._list.array=I_b},I_a.changeSelected=function(){this._button.label=this.selectedLabel},I_a._onStageMouseWheel=function(I_a){this._list&&!this._list.contains(I_a.target)&&this.removeList(null)},I_a.removeList=function(I_a){I_p.stage.off("mousedown",this,this.removeList),I_p.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},I_e(0,I_a,"selectedIndex",function(){return this._selectedIndex},function(I_a){this._selectedIndex!=I_a&&(this._selectedIndex=I_a,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[I_i.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),I_e(0,I_a,"measureHeight",function(){return this._button.height}),I_e(0,I_a,"skin",function(){return this._button.skin},function(I_a){this._button.skin!=I_a&&(this._button.skin=I_a,this._listChanged=!0)}),I_e(0,I_a,"measureWidth",function(){return this._button.width}),I_e(0,I_a,"width",I_b.prototype._$get_width,function(I_a){I_p.superSet(I_H,this,"width",I_a),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),I_e(0,I_a,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(I_a){this.selectedIndex=this._labels.indexOf(I_a)}),I_e(0,I_a,"labels",function(){return this._labels.join(",")},function(I_a){0<this._labels.length&&(this.selectedIndex=-1),I_a?this._labels=I_a.split(","):this._labels.length=0,this._itemChanged=!0}),I_e(0,I_a,"height",I_b.prototype._$get_height,function(I_a){I_p.superSet(I_H,this,"height",I_a),this._button.height=this._height}),I_e(0,I_a,"selectHandler",function(){return this._selectHandler},function(I_a){this._selectHandler=I_a}),I_e(0,I_a,"visibleNum",function(){return this._visibleNum},function(I_a){this._visibleNum=I_a,this._listChanged=!0}),I_e(0,I_a,"labelBold",function(){return this._button.text.bold},function(I_a){this._button.text.bold=I_a}),I_e(0,I_a,"itemColors",function(){return String(this._itemColors)},function(I_a){this._itemColors=I_E.fillArray(this._itemColors,I_a,String),this._listChanged=!0}),I_e(0,I_a,"itemSize",function(){return this._itemSize},function(I_a){this._itemSize=I_a,this._listChanged=!0}),I_e(0,I_a,"scrollBar",function(){return this.list.scrollBar}),I_e(0,I_a,"isOpen",function(){return this._isOpen},function(I_a){if(this._isOpen!=I_a)if(this._isOpen=I_a,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var I_b=this.localToGlobal(I_o.TEMP.setTo(0,0)),I_c=I_b.y+this._button.height;I_c=I_c+this._listHeight<=I_p.stage.height?I_c:I_b.y-this._listHeight,this._list.pos(I_b.x,I_c),this._list.zOrder=1001,I_p._currentStage.addChild(this._list),I_p.stage.once("mousedown",this,this.removeList),I_p.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),I_e(0,I_a,"scrollBarSkin",function(){return this._scrollBarSkin},function(I_a){this._scrollBarSkin=I_a}),I_e(0,I_a,"sizeGrid",function(){return this._button.sizeGrid},function(I_a){this._button.sizeGrid=I_a}),I_e(0,I_a,"button",function(){return this._button}),I_e(0,I_a,"list",function(){return this._list||this._createList(),this._list},function(I_a){I_a&&(I_a.removeSelf(),this._isCustomList=!0,this._list=I_a,this._setListEvent(I_a),this._itemHeight=I_a.getCell(0).height+I_a.spaceY)}),I_e(0,I_a,"dataSource",I_b.prototype._$get_dataSource,function(I_a){"number"==typeof(this._dataSource=I_a)&&Math.floor(I_a)==I_a||"string"==typeof I_a?this.selectedIndex=parseInt(I_a):I_a instanceof Array?this.labels=I_a.join(","):I_p.superSet(I_H,this,"dataSource",I_a)}),I_e(0,I_a,"labelColors",function(){return this._button.labelColors},function(I_a){this._button.labelColors!=I_a&&(this._button.labelColors=I_a)}),I_e(0,I_a,"labelPadding",function(){return this._button.text.padding.join(",")},function(I_a){this._button.text.padding=I_E.fillArray(I_D.labelPadding,I_a,Number)}),I_e(0,I_a,"labelSize",function(){return this._button.text.fontSize},function(I_a){this._button.text.fontSize=I_a}),I_e(0,I_a,"labelFont",function(){return this._button.text.font},function(I_a){this._button.text.font=I_a}),I_e(0,I_a,"stateNum",function(){return this._button.stateNum},function(I_a){this._button.stateNum=I_a}),I_c}(I_H),I_O=function(I_b){function I_c(I_a){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,I_c.__super.call(this),this._showButtons=I_F.showButtons,this._touchScrollEnable=I_F.touchScrollEnable,this._mouseWheelEnable=I_F.mouseWheelEnable,this.skin=I_a,this.max=1}I_f(I_c,"laya.ui.ScrollBar",I_b);var I_a=I_c.prototype;return I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),this.stopScroll(),this.target=null,I_b.prototype.destroy.call(this,I_a),this.upButton&&this.upButton.destroy(I_a),this.downButton&&this.downButton.destroy(I_a),this.slider&&this.slider.destroy(I_a),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},I_a.createChildren=function(){this.addChild(this.slider=new I_P),this.addChild(this.upButton=new I_K),this.addChild(this.downButton=new I_K)},I_a.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},I_a.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},I_a.onButtonMouseDown=function(I_a){var I_b=I_a.currentTarget===this.upButton;this.slide(I_b),I_p.timer.once(I_D.scrollBarDelayTime,this,this.startLoop,[I_b]),I_p.stage.once("mouseup",this,this.onStageMouseUp)},I_a.startLoop=function(I_a){I_p.timer.frameLoop(1,this,this.slide,[I_a])},I_a.slide=function(I_a){I_a?this.value-=this._scrollSize:this.value+=this._scrollSize},I_a.onStageMouseUp=function(I_a){I_p.timer.clear(this,this.startLoop),I_p.timer.clear(this,this.slide)},I_a.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},I_a.changeSize=function(){I_b.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},I_a.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},I_a.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},I_a.setScroll=function(I_a,I_b,I_c){this.runCallLater(this.changeSize),this.slider.setSlider(I_a,I_b,I_c),this.slider.bar.visible=0<I_b,!this._hide&&this.autoHide&&(this.visible=!1)},I_a.onTargetMouseWheel=function(I_a){this.value-=I_a.delta*this._scrollSize,this.target=this._target},I_a.onTargetMouseDown=function(I_a){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new I_o),this._lastPoint.setTo(I_p.stage.mouseX,I_p.stage.mouseY),I_p.timer.clear(this,this.tweenMove),I_z.clearTween(this),I_p.stage.once("mouseup",this,this.onStageMouseUp2),I_p.stage.once("mouseout",this,this.onStageMouseUp2),I_p.timer.frameLoop(1,this,this.loop)},I_a.loop=function(){var I_a=I_p.stage.mouseY,I_b=I_p.stage.mouseX;if(this._lastOffset=this.isVertical?I_a-this._lastPoint.y:I_b-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?I_p.stage._canvasTransform.getScaleY():I_p.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=I_b,this._lastPoint.y=I_a,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},I_a.onStageMouseUp2=function(I_a){if(I_p.stage.off("mouseup",this,this.onStageMouseUp2),I_p.stage.off("mouseout",this,this.onStageMouseUp2),I_p.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?I_z.to(this,{value:this.min},this.elasticBackTime,I_h.sineOut,I_m.create(this,this.elasticOver)):this._value>this.max&&I_z.to(this,{value:this.max},this.elasticBackTime,I_h.sineOut,I_m.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?I_p.stage.mouseY-this._lastPoint.y:I_p.stage.mouseX-this._lastPoint.x);for(var I_b=0,I_c=Math.min(this._offsets.length,3),I_d=0;I_d<I_c;I_d++)I_b+=this._offsets[this._offsets.length-1-I_d];if(this._lastOffset=I_b/I_c,(I_b=Math.abs(this._lastOffset))<2)return void this.event("end");60<I_b&&(this._lastOffset=0<this._lastOffset?60:-60);var I_e=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));I_p.timer.frameLoop(1,this,this.tweenMove,[I_e])}},I_a.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&I_z.to(this,{alpha:0},500),this.event("end")},I_a.tweenMove=function(I_a){this._lastOffset*=this.rollRatio;var I_b=NaN;if(0<I_a&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,I_b=.5*-(this.min-I_a-this.value),this._lastOffset>I_b&&(this._lastOffset=I_b)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,I_b=.5*-(this.max+I_a-this.value),this._lastOffset<I_b&&(this._lastOffset=I_b))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(I_p.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?I_z.to(this,{value:this.min},this.elasticBackTime,I_h.sineOut,I_m.create(this,this.elasticOver)):this._value>this.max?I_z.to(this,{value:this.max},this.elasticBackTime,I_h.sineOut,I_m.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&I_z.to(this,{alpha:0},500)}},I_a.stopScroll=function(){this.onStageMouseUp2(null),I_p.timer.clear(this,this.tweenMove),I_z.clearTween(this)},I_e(0,I_a,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),I_e(0,I_a,"skin",function(){return this._skin},function(I_a){this._skin!=I_a&&(this._skin=I_a,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),I_e(0,I_a,"max",function(){return this.slider.max},function(I_a){this.slider.max=I_a}),I_e(0,I_a,"showButtons",function(){return this._showButtons},function(I_a){this._showButtons=I_a,this.callLater(this.changeScrollBar)}),I_e(0,I_a,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),I_e(0,I_a,"min",function(){return this.slider.min},function(I_a){this.slider.min=I_a}),I_e(0,I_a,"value",function(){return this._value},function(I_a){I_a!==this._value&&(this._value=I_a,this._isElastic||(this.slider._value!=I_a&&(this.slider._value=I_a,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),I_e(0,I_a,"isVertical",function(){return this.slider.isVertical},function(I_a){this.slider.isVertical=I_a}),I_e(0,I_a,"sizeGrid",function(){return this.slider.sizeGrid},function(I_a){this.slider.sizeGrid=I_a}),I_e(0,I_a,"scrollSize",function(){return this._scrollSize},function(I_a){this._scrollSize=I_a}),I_e(0,I_a,"dataSource",I_b.prototype._$get_dataSource,function(I_a){"number"==typeof(this._dataSource=I_a)||"string"==typeof I_a?this.value=Number(I_a):I_p.superSet(I_H,this,"dataSource",I_a)}),I_e(0,I_a,"thumbPercent",function(){return this._thumbPercent},function(I_a){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),I_a=1<=I_a?.99:I_a,this._thumbPercent=I_a,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*I_a,I_D.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*I_a,I_D.scrollBarMinNum))}),I_e(0,I_a,"target",function(){return this._target},function(I_a){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=I_a)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),I_e(0,I_a,"hide",function(){return this._hide},function(I_a){this._hide=I_a,this.visible=!I_a}),I_e(0,I_a,"touchScrollEnable",function(){return this._touchScrollEnable},function(I_a){this._touchScrollEnable=I_a,this.target=this._target}),I_e(0,I_a,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(I_a){this._mouseWheelEnable=I_a,this.target=this._target}),I_e(0,I_a,"tick",function(){return this.slider.tick},function(I_a){this.slider.tick=I_a}),I_c}(I_H),I_P=function(I_b){function I_c(I_a){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,I_c.__super.call(this),this.skin=I_a}I_f(I_c,"laya.ui.Slider",I_b);var I_a=I_c.prototype;return I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,I_a),this._bg&&this._bg.destroy(I_a),this._bar&&this._bar.destroy(I_a),this._progress&&this._progress.destroy(I_a),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},I_a.createChildren=function(){this.addChild(this._bg=new I_Q),this.addChild(this._bar=new I_K)},I_a.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},I_a.onBarMouseDown=function(I_a){this._globalSacle||(this._globalSacle=new I_o),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=I_p.stage.mouseX,this._ty=I_p.stage.mouseY,I_p.stage.on("mousemove",this,this.mouseMove),I_p.stage.once("mouseup",this,this.mouseUp),I_p.stage.once("mouseout",this,this.mouseUp),this.showValueText()},I_a.showValueText=function(){if(this.showLabel){var I_a=laya.ui.Slider.label;this.addChild(I_a),I_a.textField.changeText(this._value+""),this.isVertical?(I_a.x=this._bar.x+20,I_a.y=.5*(this._bar.height-I_a.height)+this._bar.y):(I_a.y=this._bar.y-20,I_a.x=.5*(this._bar.width-I_a.width)+this._bar.x)}},I_a.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},I_a.mouseUp=function(I_a){I_p.stage.off("mousemove",this,this.mouseMove),I_p.stage.off("mouseup",this,this.mouseUp),I_p.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},I_a.mouseMove=function(I_a){var I_b=this._value;this.isVertical?(this._bar.y+=(I_p.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(I_p.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=I_p.stage.mouseX,this._ty=I_p.stage.mouseY;var I_c=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*I_c)/I_c,this._value!=I_b&&this.sendChangeEvent(),this.showValueText()},I_a.sendChangeEvent=function(I_a){void 0===I_a&&(I_a="change"),this.event(I_a),this.changeHandler&&this.changeHandler.runWith(this._value)},I_a.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},I_a.changeSize=function(){I_b.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},I_a.setSlider=function(I_a,I_b,I_c){this._value=-1,this._min=I_a,this._max=I_a<I_b?I_b:I_a,this.value=I_c<I_a?I_a:I_b<I_c?I_b:I_c},I_a.changeValue=function(){var I_a=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*I_a)/I_a,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var I_b=this._max-this._min;0===I_b&&(I_b=1),this.isVertical?(this._bar.y=(this._value-this._min)/I_b*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/I_b*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},I_a.onBgMouseDown=function(I_a){var I_b=this._bg.getMousePoint();this.isVertical?this.value=I_b.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=I_b.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},I_e(0,I_a,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),I_e(0,I_a,"skin",function(){return this._skin},function(I_a){if(this._skin!=I_a){this._skin=I_a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var I_b=this._skin.replace(".png","$progress.png");I_u.getRes(I_b)&&(this._progress||(this.addChild(this._progress=new I_Q),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=I_b),this.setBarPoint(),this.callLater(this.changeValue)}}),I_e(0,I_a,"allowClickBack",function(){return this._allowClickBack},function(I_a){this._allowClickBack!=I_a&&((this._allowClickBack=I_a)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),I_e(0,I_a,"max",function(){return this._max},function(I_a){this._max!=I_a&&(this._max=I_a,this.callLater(this.changeValue))}),I_e(0,I_a,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),I_e(0,I_a,"tick",function(){return this._tick},function(I_a){this._tick!=I_a&&(this._tick=I_a,this.callLater(this.changeValue))}),I_e(0,I_a,"sizeGrid",function(){return this._bg.sizeGrid},function(I_a){this._bg.sizeGrid=I_a,this._bar.sizeGrid=I_a,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),I_e(0,I_a,"min",function(){return this._min},function(I_a){this._min!=I_a&&(this._min=I_a,this.callLater(this.changeValue))}),I_e(0,I_a,"value",function(){return this._value},function(I_a){if(this._value!=I_a){var I_b=this._value;this._value=I_a,this.changeValue(),this._value!=I_b&&this.sendChangeEvent()}}),I_e(0,I_a,"dataSource",I_b.prototype._$get_dataSource,function(I_a){"number"==typeof(this._dataSource=I_a)||"string"==typeof I_a?this.value=Number(I_a):I_p.superSet(I_H,this,"dataSource",I_a)}),I_e(0,I_a,"bar",function(){return this._bar}),I_d(I_c,["label",function(){return this.label=new I_R}]),I_c}(I_H),I_Q=function(I_b){function I_c(I_a){this._bitmap=null,this._skin=null,this._group=null,I_c.__super.call(this),this.skin=I_a}I_f(I_c,"laya.ui.Image",I_b);var I_a=I_c.prototype;return I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,I_u.clearCache(this,this._skin)},I_a.dispose=function(){this.destroy(!0),I_u.clearCache(this,this._skin)},I_a.createChildren=function(){this.graphics=this._bitmap=new I_G},I_a.setSource=function(I_a,I_b){I_a===this._skin&&I_b&&(this.source=I_b,this.onCompResize())},I_e(0,I_a,"source",function(){return this._bitmap.source},function(I_a){this._bitmap&&(this._bitmap.source=I_a,this.event("loaded"),this.repaint())}),I_e(0,I_a,"dataSource",I_b.prototype._$get_dataSource,function(I_a){"string"==typeof(this._dataSource=I_a)?this.skin=I_a:I_p.superSet(I_H,this,"dataSource",I_a)}),I_e(0,I_a,"measureHeight",function(){return this._bitmap.height}),I_e(0,I_a,"skin",function(){return this._skin},function(I_a){if(this._skin!=I_a)if(I_u.clearCache(this,this._skin),this._skin=I_a){I_u.keepCache(this,this._skin);var I_b=I_u.getRes(I_a);I_b?(this.source=I_b,this.onCompResize()):I_p.loader.load(this._skin,I_m.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),I_e(0,I_a,"group",function(){return this._group},function(I_a){I_a&&this._skin&&I_u.setGroup(this._skin,I_a),this._group=I_a}),I_e(0,I_a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(I_a){this._bitmap.sizeGrid=I_E.fillArray(I_D.defaultSizeGrid,I_a,Number)}),I_e(0,I_a,"measureWidth",function(){return this._bitmap.width}),I_e(0,I_a,"width",I_b.prototype._$get_width,function(I_a){I_p.superSet(I_H,this,"width",I_a),this._bitmap.width=0==I_a?1e-7:I_a}),I_e(0,I_a,"height",I_b.prototype._$get_height,function(I_a){I_p.superSet(I_H,this,"height",I_a),this._bitmap.height=0==I_a?1e-7:I_a}),I_c}(I_H),I_R=function(I_b){function I_c(I_a){this._tf=null,I_c.__super.call(this),void 0===I_a&&(I_a=""),I_j.defaultColor=I_D.labelColor,this.text=I_a}I_f(I_c,"laya.ui.Label",I_b);var I_a=I_c.prototype;return I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,I_a),this._tf=null},I_a.createChildren=function(){this.addChild(this._tf=new I_x)},I_a.changeText=function(I_a){this._tf.changeText(I_a)},I_e(0,I_a,"padding",function(){return this._tf.padding.join(",")},function(I_a){this._tf.padding=I_E.fillArray(I_D.labelPadding,I_a,Number)}),I_e(0,I_a,"bold",function(){return this._tf.bold},function(I_a){this._tf.bold=I_a}),I_e(0,I_a,"align",function(){return this._tf.align},function(I_a){this._tf.align=I_a}),I_e(0,I_a,"text",function(){return this._tf.text},function(I_a){this._tf.text!=I_a&&(I_a&&(I_a=I_E.adptString(I_a+"")),this._tf.text=I_a,this.event("change"),this._width&&this._height||this.onCompResize())}),I_e(0,I_a,"italic",function(){return this._tf.italic},function(I_a){this._tf.italic=I_a}),I_e(0,I_a,"wordWrap",function(){return this._tf.wordWrap},function(I_a){this._tf.wordWrap=I_a}),I_e(0,I_a,"font",function(){return this._tf.font},function(I_a){this._tf.font=I_a}),I_e(0,I_a,"dataSource",I_b.prototype._$get_dataSource,function(I_a){"number"==typeof(this._dataSource=I_a)||"string"==typeof I_a?this.text=I_a+"":I_p.superSet(I_H,this,"dataSource",I_a)}),I_e(0,I_a,"color",function(){return this._tf.color},function(I_a){this._tf.color=I_a}),I_e(0,I_a,"valign",function(){return this._tf.valign},function(I_a){this._tf.valign=I_a}),I_e(0,I_a,"leading",function(){return this._tf.leading},function(I_a){this._tf.leading=I_a}),I_e(0,I_a,"fontSize",function(){return this._tf.fontSize},function(I_a){this._tf.fontSize=I_a}),I_e(0,I_a,"bgColor",function(){return this._tf.bgColor},function(I_a){this._tf.bgColor=I_a}),I_e(0,I_a,"borderColor",function(){return this._tf.borderColor},function(I_a){this._tf.borderColor=I_a}),I_e(0,I_a,"stroke",function(){return this._tf.stroke},function(I_a){this._tf.stroke=I_a}),I_e(0,I_a,"strokeColor",function(){return this._tf.strokeColor},function(I_a){this._tf.strokeColor=I_a}),I_e(0,I_a,"textField",function(){return this._tf}),I_e(0,I_a,"measureWidth",function(){return this._tf.width}),I_e(0,I_a,"measureHeight",function(){return this._tf.height}),I_e(0,I_a,"width",function(){return this._width||this._tf.text?I_p.superGet(I_H,this,"width"):0},function(I_a){I_p.superSet(I_H,this,"width",I_a),this._tf.width=I_a}),I_e(0,I_a,"height",function(){return this._height||this._tf.text?I_p.superGet(I_H,this,"height"):0},function(I_a){I_p.superSet(I_H,this,"height",I_a),this._tf.height=I_a}),I_e(0,I_a,"overflow",function(){return this._tf.overflow},function(I_a){this._tf.overflow=I_a}),I_e(0,I_a,"underline",function(){return this._tf.underline},function(I_a){this._tf.underline=I_a}),I_e(0,I_a,"underlineColor",function(){return this._tf.underlineColor},function(I_a){this._tf.underlineColor=I_a}),I_c}(I_H),I_S=function(I_b){function I_c(I_a){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,I_c.__super.call(this),this.skin=I_a}I_f(I_c,"laya.ui.ProgressBar",I_b);var I_a=I_c.prototype;return I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,I_a),this._bg&&this._bg.destroy(I_a),this._bar&&this._bar.destroy(I_a),this._bg=this._bar=null,this.changeHandler=null},I_a.createChildren=function(){this.addChild(this._bg=new I_Q),this.addChild(this._bar=new I_Q)},I_a.changeValue=function(){if(this.sizeGrid){var I_a=this.sizeGrid.split(","),I_b=Number(I_a[3]),I_c=Number(I_a[1]),I_d=(this.width-I_b-I_c)*this._value;this._bar.width=I_b+I_c+I_d,this._bar.visible=this._bar.width>I_b+I_c}else this._bar.width=this.width*this._value},I_e(0,I_a,"measureHeight",function(){return this._bg.height}),I_e(0,I_a,"skin",function(){return this._skin},function(I_a){this._skin!=I_a&&(this._skin=I_a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),I_e(0,I_a,"measureWidth",function(){return this._bg.width}),I_e(0,I_a,"height",I_b.prototype._$get_height,function(I_a){I_p.superSet(I_H,this,"height",I_a),this._bg.height=this._height,this._bar.height=this._height}),I_e(0,I_a,"bar",function(){return this._bar}),I_e(0,I_a,"value",function(){return this._value},function(I_a){this._value!=I_a&&(I_a=1<I_a?1:I_a<0?0:I_a,this._value=I_a,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(I_a))}),I_e(0,I_a,"bg",function(){return this._bg}),I_e(0,I_a,"sizeGrid",function(){return this._bg.sizeGrid},function(I_a){this._bg.sizeGrid=this._bar.sizeGrid=I_a}),I_e(0,I_a,"width",I_b.prototype._$get_width,function(I_a){I_p.superSet(I_H,this,"width",I_a),this._bg.width=this._width,this.callLater(this.changeValue)}),I_e(0,I_a,"dataSource",I_b.prototype._$get_dataSource,function(I_a){"number"==typeof(this._dataSource=I_a)||"string"==typeof I_a?this.value=Number(I_a):I_p.superSet(I_H,this,"dataSource",I_a)}),I_c}(I_H),I_T=(function(I_a){function I_c(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,I_c.__super.call(this),this._tipBox=new I_H,this._tipBox.addChild(this._tipText=new I_x),this._tipText.x=this._tipText.y=5,this._tipText.color=I_c.tipTextColor,this._defaultTipHandler=this._showDefaultTip,I_p.stage.on("showtip",this,this._onStageShowTip),I_p.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}I_f(I_c,"laya.ui.TipManager",I_H);var I_b=I_c.prototype;I_b._onStageHideTip=function(I_a){I_p.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},I_b._onStageShowTip=function(I_a){I_p.timer.once(I_c.tipDelay,this,this._showTip,[I_a],!0)},I_b._showTip=function(I_a){if("string"==typeof I_a){var I_b=String(I_a);Boolean(I_b)&&this._defaultTipHandler(I_b)}else I_a instanceof laya.utils.Handler?I_a.run():"function"==typeof I_a&&I_a.apply();I_p.stage.on("mousemove",this,this._onStageMouseMove),I_p.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},I_b._onStageMouseDown=function(I_a){this.closeAll()},I_b._onStageMouseMove=function(I_a){this._showToStage(this,I_c.offsetX,I_c.offsetY)},I_b._showToStage=function(I_a,I_b,I_c){void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0);var I_d=I_a.getBounds();I_a.x=I_p.stage.mouseX+I_b,I_a.y=I_p.stage.mouseY+I_c,I_a.x+I_d.width>I_p.stage.width&&(I_a.x-=I_d.width+I_b),I_a.y+I_d.height>I_p.stage.height&&(I_a.y-=I_d.height+I_c)},I_b.closeAll=function(){I_p.timer.clear(this,this._showTip),I_p.stage.off("mousemove",this,this._onStageMouseMove),I_p.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},I_b.showDislayTip=function(I_a){this.addChild(I_a),this._showToStage(this),I_p._currentStage.addChild(this)},I_b._showDefaultTip=function(I_a){this._tipText.text=I_a;var I_b=this._tipBox.graphics;I_b.clear(),I_b.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,I_c.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),I_p._currentStage.addChild(this)},I_e(0,I_b,"defaultTipHandler",function(){return this._defaultTipHandler},function(I_a){this._defaultTipHandler=I_a}),I_c.offsetX=10,I_c.offsetY=15,I_c.tipTextColor="#ffffff",I_c.tipBackColor="#111111",I_c.tipDelay=200}(),function(I_a){var I_n;function I_o(){this._idMap=null,this._aniList=null,this._watchMap={},I_o.__super.call(this)}I_f(I_o,"laya.ui.View",I_J);var I_b=I_o.prototype;return I_b.createView=function(I_a){if(I_a.animations&&!this._idMap&&(this._idMap={}),I_o.createComp(I_a,this,this),I_a.animations){var I_b,I_c,I_d=[],I_e=I_a.animations,I_f=0,I_g=I_e.length;for(I_f=0;I_f<I_g;I_f++){switch(I_b=new I_k,I_c=I_e[I_f],I_b._setUp(this._idMap,I_c),(this[I_c.name]=I_b)._setControlNode(this),I_c.action){case 1:I_b.play(0,!1);break;case 2:I_b.play(0,!0)}I_d.push(I_b)}this._aniList=I_d}0<this._width&&null==I_a.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},I_b.onEvent=function(I_a,I_b){},I_b.loadUI=function(I_a){var I_b=I_o.uiMap[I_a];I_b&&this.createView(I_b)},I_b.destroy=function(I_a){void 0===I_a&&(I_a=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,I_a)},I_b.changeData=function(I_a){var I_b=this._watchMap[I_a];if(I_b){console.log("change",I_a);for(var I_c=0,I_d=I_b.length;I_c<I_d;I_c++){I_b[I_c].exe(this)}}},I_o._regs=function(){for(var I_a in I_o.uiClassMap)I_s.regClass(I_a,I_o.uiClassMap[I_a])},I_o.createComp=function(I_a,I_b,I_c,I_d){if(!(I_b=I_b||I_o.getCompInstance(I_a)))return console.warn("can not create:"+I_a.type),null;var I_e=I_a.child;if(I_e)for(var I_f=I_b instanceof laya.ui.List,I_g=0,I_h=I_e.length;I_g<I_h;I_g++){var I_i=I_e[I_g];if(!I_b.hasOwnProperty("itemRender")||"render"!=I_i.props.name&&"render"!==I_i.props.renderType)if("Graphic"==I_i.type)I_s.addGraphicsToSprite(I_i,I_b);else if(I_s.isDrawType(I_i.type))I_s.addGraphicToSprite(I_i,I_b,!0);else{if(I_f){var I_j=[],I_k=I_o.createComp(I_i,null,I_c,I_j);I_j.length&&(I_k._$bindData=I_j)}else I_k=I_o.createComp(I_i,null,I_c,I_d);"Script"==I_i.type?"owner"in I_k?I_k.owner=I_b:"target"in I_k&&(I_k.target=I_b):"mask"==I_i.props.renderType||"mask"==I_i.props.name?I_b.mask=I_k:I_k instanceof laya.display.Sprite&&I_b.addChild(I_k)}else I_b.itemRender=I_i}var I_l=I_a.props;for(var I_m in I_l){var I_n=I_l[I_m];I_o.eventDic[I_m]?I_n&&I_c&&I_b.on(I_m,I_c,I_c.onEvent,[I_n]):I_o.setCompValue(I_b,I_m,I_n,I_c,I_d)}return I_p.__typeof(I_b,"laya.ui.IItem")&&I_b.initItems(),I_a.compId&&I_c&&I_c._idMap&&(I_c._idMap[I_a.compId]=I_b),I_b},I_o.setCompValue=function(I_a,I_b,I_c,I_d,I_e){if("string"==typeof I_c&&-1<I_c.indexOf("${")){if(I_o._sheet||(I_o._sheet=I_s.getClass("laya.data.Table")),!I_o._sheet)return void console.warn("Can not find class Sheet");if(I_e)I_e.push(I_a,I_b,I_c);else if(I_d){-1==I_c.indexOf("].")&&(I_c=I_c.replace(".","[0]."));var I_f,I_g,I_h=new I_n(I_a,I_b,I_c);I_h.exe(I_d);for(var I_i=I_c.replace(/\[.*?\]\./g,".");null!=(I_f=I_o._parseWatchData.exec(I_i));){for(var I_j=I_f[1];null!=(I_g=I_o._parseKeyWord.exec(I_j));){var I_k=I_g[0],I_l=I_d._watchMap[I_k]||(I_d._watchMap[I_k]=[]);I_l.push(I_h),I_o._sheet.I.notifer.on(I_k,I_d,I_d.changeData,[I_k])}(I_l=I_d._watchMap[I_j]||(I_d._watchMap[I_j]=[])).push(I_h),I_o._sheet.I.notifer.on(I_j,I_d,I_d.changeData,[I_j])}}}else if("var"===I_b&&I_d)I_d[I_c]=I_a;else if("onClick"==I_b){var I_m=I_p._runScript("(function(){"+I_c+"})");I_a.on("click",I_d,I_m)}else I_a[I_b]="true"===I_c||"false"!==I_c&&I_c},I_o.getCompInstance=function(I_a){var I_b,I_c=I_a.props?I_a.props.runtime:null;return I_b=I_c?I_o.viewClassMap[I_c]||I_o.uiClassMap[I_c]||I_p.__classmap[I_c]:I_o.uiClassMap[I_a.type],I_a.props&&I_a.props.hasOwnProperty("renderType")&&"instance"==I_a.props.renderType?I_b.instance:I_b?new I_b:null},I_o.regComponent=function(I_a,I_b){I_o.uiClassMap[I_a]=I_b,I_s.regClass(I_a,I_b)},I_o.regViewRuntime=function(I_a,I_b){I_o.viewClassMap[I_a]=I_b},I_o.uiMap={},I_o.viewClassMap={},I_o._sheet=null,I_d(I_o,["uiClassMap",function(){return this.uiClassMap={ViewStack:I_aa,LinkButton:I_K,TextArea:I_ja,ColorPicker:I_M,Box:I_J,Button:I_K,CheckBox:I_U,Clip:I_L,ComboBox:I_N,Component:I_H,HScrollBar:I_Y,HSlider:I_$,Image:I_Q,Label:I_R,List:I_X,Panel:I_Z,ProgressBar:I_S,Radio:I_q,RadioGroup:I_ha,ScrollBar:I_O,Slider:I_P,Tab:I_ia,TextInput:I_ca,View:I_o,VScrollBar:I_ba,VSlider:I_da,Tree:I_r,HBox:I_fa,VBox:I_ga,Sprite:I_w,Animation:I_c,Text:I_x,FontClip:I_W}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),I_o.__init$=function(){I_o._regs(),I_n=function(){function I_a(I_a,I_b,I_c){this.comp=null,this.prop=null,this.value=null,this.comp=I_a,this.prop=I_b,this.value=I_c}return I_f(I_a,""),I_a.prototype.exe=function(I_a){var I_b=I_E.getBindFun(this.value);this.comp[this.prop]=I_b.call(this,I_a)},I_a}()},I_o}()),I_U=function(I_a){function I_c(I_a,I_b){void 0===I_b&&(I_b=""),I_c.__super.call(this,I_a,I_b)}I_f(I_c,"laya.ui.CheckBox",I_a);var I_b=I_c.prototype;return I_b.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},I_b.initialize=function(){I_a.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},I_e(0,I_b,"dataSource",I_a.prototype._$get_dataSource,function(I_a){"boolean"==typeof(this._dataSource=I_a)?this.selected=I_a:"string"==typeof I_a?this.selected="true"===I_a:I_p.superSet(I_K,this,"dataSource",I_a)}),I_c}(I_K),I_V=function(I_a){function I_b(){this._space=0,this._align="none",this._itemChanged=!1,I_b.__super.call(this)}I_f(I_b,"laya.ui.LayoutBox",I_J);var I_c=I_b.prototype;return I_c.addChild=function(I_a){return I_a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,I_a)},I_c.onResize=function(I_a){this._setItemChanged()},I_c.addChildAt=function(I_a,I_b){return I_a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,I_a,I_b)},I_c.removeChild=function(I_a){return I_a.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,I_a)},I_c.removeChildAt=function(I_a){return this.getChildAt(I_a).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,I_a)},I_c.refresh=function(){this._setItemChanged()},I_c.changeItems=function(){this._itemChanged=!1},I_c.sortItem=function(I_a){I_a&&I_a.sort(function(I_a,I_b){return I_a.y-I_b.y})},I_c._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},I_e(0,I_c,"space",function(){return this._space},function(I_a){this._space=I_a,this._setItemChanged()}),I_e(0,I_c,"align",function(){return this._align},function(I_a){this._align=I_a,this._setItemChanged()}),I_b}(),I_W=function(I_b){function I_c(I_a,I_b){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,I_c.__super.call(this),I_a&&(this.skin=I_a),I_b&&(this.sheet=I_b)}I_f(I_c,"laya.ui.FontClip",I_b);var I_a=I_c.prototype;return I_a.createChildren=function(){this._bitmap=new I_G,this.on("loaded",this,this._onClipLoaded)},I_a._onClipLoaded=function(){this.callLater(this.changeValue)},I_a.changeValue=function(){var I_a;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),I_a=this._sources[0]))){var I_b="horizontal"===this._direction;I_b?(this._wordsW=this._valueArr.length*(I_a.sourceWidth+this.spaceX),this._wordsH=I_a.sourceHeight):(this._wordsW=I_a.sourceWidth,this._wordsH=(I_a.sourceHeight+this.spaceY)*this._valueArr.length);var I_c=0;if(this._width)switch(this._align){case"center":I_c=.5*(this._width-this._wordsW);break;case"right":I_c=this._width-this._wordsW;break;default:I_c=0}for(var I_d=0,I_e=this._valueArr.length;I_d<I_e;I_d++){var I_f=this._indexMap[this._valueArr.charAt(I_d)];this.sources[I_f]&&(I_a=this.sources[I_f],I_b?this.graphics.drawTexture(I_a,I_c+I_d*(I_a.sourceWidth+this.spaceX),0,I_a.sourceWidth,I_a.sourceHeight):this.graphics.drawTexture(I_a,0+I_c,I_d*(I_a.sourceHeight+this.spaceY),I_a.sourceWidth,I_a.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),I_b.prototype.destroy.call(this,I_a)},I_e(0,I_a,"sheet",function(){return this._sheet},function(I_a){I_a+="";var I_b=(this._sheet=I_a).split(" ");this._clipX=String(I_b[0]).length,this.clipY=I_b.length,this._indexMap={};for(var I_c=0;I_c<this._clipY;I_c++)for(var I_d=I_b[I_c].split(""),I_e=0,I_f=I_d.length;I_e<I_f;I_e++)this._indexMap[I_d[I_e]]=I_c*this._clipX+I_e}),I_e(0,I_a,"height",I_b.prototype._$get_height,function(I_a){I_p.superSet(I_L,this,"height",I_a),this.callLater(this.changeValue)}),I_e(0,I_a,"direction",function(){return this._direction},function(I_a){this._direction=I_a,this.callLater(this.changeValue)}),I_e(0,I_a,"value",function(){return this._valueArr?this._valueArr:""},function(I_a){I_a+="",this._valueArr=I_a,this.callLater(this.changeValue)}),I_e(0,I_a,"width",I_b.prototype._$get_width,function(I_a){I_p.superSet(I_L,this,"width",I_a),this.callLater(this.changeValue)}),I_e(0,I_a,"spaceX",function(){return this._spaceX},function(I_a){this._spaceX=I_a,"horizontal"===this._direction&&this.callLater(this.changeValue)}),I_e(0,I_a,"spaceY",function(){return this._spaceY},function(I_a){this._spaceY=I_a,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),I_e(0,I_a,"align",function(){return this._align},function(I_a){this._align=I_a,this.callLater(this.changeValue)}),I_e(0,I_a,"measureWidth",function(){return this._wordsW}),I_e(0,I_a,"measureHeight",function(){return this._wordsH}),I_c}(I_L),I_X=function(I_a){function I_b(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new I_o,I_b.__super.call(this)}I_f(I_b,"laya.ui.List",I_a);var I_c=I_b.prototype;return I_p.imps(I_c,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),I_c.destroy=function(I_a){void 0===I_a&&(I_a=!0),this._content&&this._content.destroy(I_a),this._scrollBar&&this._scrollBar.destroy(I_a),laya.ui.Component.prototype.destroy.call(this,I_a),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},I_c.createChildren=function(){this.addChild(this._content=new I_J)},I_c.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=I_p.superGet(I_J,this,"cacheAs")),I_p.superSet(I_J,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},I_c.onScrollEnd=function(){I_p.superSet(I_J,this,"cacheAs",this._$P.cacheAs)},I_c._removePreScrollBar=function(){var I_a=this.removeChildByName("scrollBar");I_a&&I_a.destroy(!0)},I_c.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var I_a=this._getOneCell(),I_b=I_a.width+this._spaceX||1,I_c=I_a.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/I_b):Math.ceil(this._width/I_b)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/I_c):Math.round(this._height/I_c));var I_d=this._width?this._width:I_b*this.repeatX-this._spaceX,I_e=this._height?this._height:I_c*this.repeatY-this._spaceY;this._cellSize=this._isVertical?I_c:I_b,this._cellOffset=this._isVertical?I_c*Math.max(this._repeatY2,this._repeatY)-I_e-this._spaceY:I_b*Math.max(this._repeatX2,this._repeatX)-I_d-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=I_e:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=I_d),this.setContentSize(I_d,I_e);var I_f=this._isVertical?this.repeatX:this.repeatY,I_g=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,I_f,I_g),this._createdLine=I_g,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},I_c._getOneCell=function(){if(0===this._cells.length){var I_a=this.createItem();if(this._offset.setTo(I_a.x,I_a.y),this.cacheContent)return I_a;this._cells.push(I_a)}return this._cells[0]},I_c._createItems=function(I_a,I_b,I_c){var I_d=this._content,I_e=this._getOneCell(),I_f=I_e.width+this._spaceX,I_g=I_e.height+this._spaceY;if(this.cacheContent){var I_h=new I_J;I_h.cacheAsBitmap=!0,I_h.pos((this._isVertical?0:I_a)*I_f,(this._isVertical?I_a:0)*I_g),this._content.addChild(I_h),this._content.optimizeScrollRect=!0,I_d=I_h}else{for(var I_i=[],I_j=this._cells.length-1;-1<I_j;I_j--){var I_k=this._cells[I_j];I_k.removeSelf(),I_i.push(I_k)}this._cells.length=0}for(var I_l=I_a;I_l<I_c;I_l++)for(var I_m=0;I_m<I_b;I_m++)(I_e=I_i&&I_i.length?I_i.pop():this.createItem()).x=(this._isVertical?I_m:I_l)*I_f-I_d.x,I_e.y=(this._isVertical?I_l:I_m)*I_g-I_d.y,I_e.name="item"+(I_l*I_b+I_m),I_d.addChild(I_e),this.addCell(I_e)},I_c.createItem=function(){var I_a=[];if("function"==typeof this._itemRender)var I_b=new this._itemRender;else I_b=I_T.createComp(this._itemRender,null,null,I_a);if(0==I_a.length&&I_b._watchMap){var I_c=I_b._watchMap;for(var I_d in I_c)for(var I_e=I_c[I_d],I_f=0;I_f<I_e.length;I_f++){var I_g=I_e[I_f];I_a.push(I_g.comp,I_g.prop,I_g.value)}}return I_a.length&&(I_b._$bindData=I_a),I_b},I_c.addCell=function(I_a){I_a.on("click",this,this.onCellMouse),I_a.on("rightclick",this,this.onCellMouse),I_a.on("mouseover",this,this.onCellMouse),I_a.on("mouseout",this,this.onCellMouse),I_a.on("mousedown",this,this.onCellMouse),I_a.on("mouseup",this,this.onCellMouse),this._cells.push(I_a)},I_c.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var I_a=0,I_b=I_a=0;I_b<1e4;I_b++){var I_c=this.getChildByName("item"+I_b);if(!I_c)break;this.addCell(I_c),I_a++}this.repeatY=I_a}},I_c.setContentSize=function(I_a,I_b){this._content.width=I_a,this._content.height=I_b,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new I_t),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,I_a,I_b),this._content.scrollRect=this._content.scrollRect),this.event("resize")},I_c.onCellMouse=function(I_a){"mousedown"===I_a.type&&(this._isMoved=!1);var I_b=I_a.currentTarget,I_c=this._startIndex+this._cells.indexOf(I_b);I_c<0||("click"===I_a.type||"rightclick"===I_a.type?this.selectEnable&&!this._isMoved?this.selectedIndex=I_c:this.changeCellState(I_b,!0,0):"mouseover"!==I_a.type&&"mouseout"!==I_a.type||this._selectedIndex===I_c||this.changeCellState(I_b,"mouseover"===I_a.type,0),this.mouseHandler&&this.mouseHandler.runWith([I_a,I_c]))},I_c.changeCellState=function(I_a,I_b,I_c){var I_d=I_a.getChildByName("selectBox");I_d&&(this.selectEnable=!0,I_d.visible=I_b,I_d.index=I_c)},I_c.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},I_c.onScrollBarChange=function(I_a){this.runCallLater(this.changeCells);var I_b=this._scrollBar.value,I_c=this._isVertical?this.repeatX:this.repeatY,I_d=this._isVertical?this.repeatY:this.repeatX,I_e=Math.floor(I_b/this._cellSize);if(this.cacheContent)I_g=I_d+1,this._createdLine-I_e<I_g&&(this._createItems(this._createdLine,I_c,this._createdLine+I_g),this.renderItems(this._createdLine*I_c,0),this._createdLine+=I_g);else{var I_f=I_e*I_c,I_g=0;if(I_f>this._startIndex){I_g=I_f-this._startIndex;var I_h=!0,I_i=this._startIndex+I_c*(I_d+1);this._isMoved=!0}else I_f<this._startIndex&&(I_g=this._startIndex-I_f,I_h=!1,I_i=this._startIndex-1,this._isMoved=!0);for(var I_j=0;I_j<I_g;I_j++){if(I_h){var I_k=this._cells.shift();this._cells[this._cells.length]=I_k;var I_l=I_i+I_j}else I_k=this._cells.pop(),this._cells.unshift(I_k),I_l=I_i-I_j;var I_m=Math.floor(I_l/I_c)*this._cellSize;this._isVertical?I_k.y=I_m:I_k.x=I_m,this.renderItem(I_k,I_l)}this._startIndex=I_f,this.changeSelectStatus()}var I_n=this._content.scrollRect;this._isVertical?(I_n.y=I_b-this._offset.y,I_n.x=-this._offset.x):(I_n.y=-this._offset.y,I_n.x=I_b-this._offset.x),this._content.scrollRect=I_n},I_c.posCell=function(I_a,I_b){if(this._scrollBar){var I_c=this._isVertical?this.repeatX:this.repeatY,I_d=(this._isVertical?this.repeatY:this.repeatX,Math.floor(I_b/I_c)*this._cellSize);this._isVertical?I_a.y=I_d:I_a.x=I_d}},I_c.changeSelectStatus=function(){for(var I_a=0,I_b=this._cells.length;I_a<I_b;I_a++)this.changeCellState(this._cells[I_a],this._selectedIndex===this._startIndex+I_a,1)},I_c.renderItems=function(I_a,I_b){void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0);for(var I_c=I_a,I_d=I_b||this._cells.length;I_c<I_d;I_c++)this.renderItem(this._cells[I_c],this._startIndex+I_c);this.changeSelectStatus()},I_c.renderItem=function(I_a,I_b){this._array&&0<=I_b&&I_b<this._array.length?(I_a.visible=!0,I_a._$bindData?(I_a._dataSource=this._array[I_b],this._bindData(I_a,this._array[I_b])):I_a.dataSource=this._array[I_b],this.cacheContent||this.posCell(I_a,I_b),this.hasListener("render")&&this.event("render",[I_a,I_b]),this.renderHandler&&this.renderHandler.runWith([I_a,I_b])):(I_a.visible=!1,I_a.dataSource=null)},I_c._bindData=function(I_a,I_b){for(var I_c=I_a._$bindData,I_d=0,I_e=I_c.length;I_d<I_e;I_d++){var I_f=I_c[I_d++],I_g=I_c[I_d++],I_h=I_c[I_d],I_i=I_E.getBindFun(I_h);I_f[I_g]=I_i.call(this,I_b)}},I_c.refresh=function(){this.array=this._array},I_c.getItem=function(I_a){return-1<I_a&&I_a<this._array.length?this._array[I_a]:null},I_c.changeItem=function(I_a,I_b){-1<I_a&&I_a<this._array.length&&(this._array[I_a]=I_b,I_a>=this._startIndex&&I_a<this._startIndex+this._cells.length&&this.renderItem(this.getCell(I_a),I_a))},I_c.setItem=function(I_a,I_b){this.changeItem(I_a,I_b)},I_c.addItem=function(I_a){this._array.push(I_a),this.array=this._array},I_c.addItemAt=function(I_a,I_b){this._array.splice(I_b,0,I_a),this.array=this._array},I_c.deleteItem=function(I_a){this._array.splice(I_a,1),this.array=this._array},I_c.getCell=function(I_a){return this.runCallLater(this.changeCells),-1<I_a&&this._cells?this._cells[(I_a-this._startIndex)%this._cells.length]:null},I_c.scrollTo=function(I_a){if(this._scrollBar){var I_b=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(I_a/I_b)*this._cellSize}else this.startIndex=I_a},I_c.tweenTo=function(I_a,I_b,I_c){if(void 0===I_b&&(I_b=200),this._scrollBar){var I_d=this._isVertical?this.repeatX:this.repeatY;I_z.to(this._scrollBar,{value:Math.floor(I_a/I_d)*this._cellSize},I_b,null,I_c,0,!0)}else this.startIndex=I_a,I_c&&I_c.run()},I_c._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},I_c.commitMeasure=function(){this.runCallLater(this.changeCells)},I_e(0,I_c,"cacheAs",I_a.prototype._$get_cacheAs,function(I_a){I_p.superSet(I_J,this,"cacheAs",I_a),this._scrollBar&&(this._$P.cacheAs=null,"none"!==I_a?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),I_e(0,I_c,"content",function(){return this._content}),I_e(0,I_c,"height",I_a.prototype._$get_height,function(I_a){I_a!=this._height&&(I_p.superSet(I_J,this,"height",I_a),this._setCellChanged())}),I_e(0,I_c,"itemRender",function(){return this._itemRender},function(I_a){if(this._itemRender!=I_a){this._itemRender=I_a;for(var I_b=this._cells.length-1;-1<I_b;I_b--)this._cells[I_b].destroy();this._cells.length=0,this._setCellChanged()}}),I_e(0,I_c,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(I_a){this._removePreScrollBar();var I_b=new I_ba;I_b.name="scrollBar",I_b.right=0,I_a&&" "!=I_a&&(I_b.skin=I_a),this.scrollBar=I_b,this.addChild(I_b),this._setCellChanged()}),I_e(0,I_c,"page",function(){return this._page},function(I_a){this._page=I_a,this._array&&(this._page=0<I_a?I_a:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),I_e(0,I_c,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(I_a){this._removePreScrollBar();var I_b=new I_Y;I_b.name="scrollBar",I_b.bottom=0,I_a&&" "!=I_a&&(I_b.skin=I_a),this.scrollBar=I_b,this.addChild(I_b),this._setCellChanged()}),I_e(0,I_c,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(I_a){this._repeatX=I_a,this._setCellChanged()}),I_e(0,I_c,"scrollBar",function(){return this._scrollBar},function(I_a){this._scrollBar!=I_a&&(this._scrollBar=I_a)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),I_e(0,I_c,"width",I_a.prototype._$get_width,function(I_a){I_a!=this._width&&(I_p.superSet(I_J,this,"width",I_a),this._setCellChanged())}),I_e(0,I_c,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(I_a){this._repeatY=I_a,this._setCellChanged()}),I_e(0,I_c,"spaceX",function(){return this._spaceX},function(I_a){this._spaceX=I_a,this._setCellChanged()}),I_e(0,I_c,"spaceY",function(){return this._spaceY},function(I_a){this._spaceY=I_a,this._setCellChanged()}),I_e(0,I_c,"selectedIndex",function(){return this._selectedIndex},function(I_a){this._selectedIndex!=I_a&&(this._selectedIndex=I_a,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(I_a),this.startIndex=this._startIndex)}),I_e(0,I_c,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(I_a){this.selectedIndex=this._array.indexOf(I_a)}),I_e(0,I_c,"length",function(){return this._array?this._array.length:0}),I_e(0,I_c,"selection",function(){return this.getCell(this._selectedIndex)},function(I_a){this.selectedIndex=this._startIndex+this._cells.indexOf(I_a)}),I_e(0,I_c,"startIndex",function(){return this._startIndex},function(I_a){this._startIndex=0<I_a?I_a:0,this.callLater(this.renderItems)}),I_e(0,I_c,"array",function(){return this._array},function(I_a){this.runCallLater(this.changeCells),this._array=I_a||[];var I_b=this._array.length;if(this.totalPage=Math.ceil(I_b/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<I_b?this._selectedIndex:I_b-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var I_c=this._isVertical?this.repeatX:this.repeatY,I_d=this._isVertical?this.repeatY:this.repeatX,I_e=Math.ceil(I_b/I_c);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=I_d/I_e,this._scrollBar.setScroll(0,(I_e-I_d)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),I_e(0,I_c,"dataSource",I_a.prototype._$get_dataSource,function(I_a){"number"==typeof(this._dataSource=I_a)&&Math.floor(I_a)==I_a||"string"==typeof I_a?this.selectedIndex=parseInt(I_a):I_a instanceof Array?this.array=I_a:I_p.superSet(I_J,this,"dataSource",I_a)}),I_e(0,I_c,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),I_b}(I_J),I_Y=function(I_a){function I_b(){I_b.__super.call(this)}return I_f(I_b,"laya.ui.HScrollBar",I_a),I_b.prototype.initialize=function(){I_a.prototype.initialize.call(this),this.slider.isVertical=!1},I_b}(I_O),I_Z=function(I_a){function I_b(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,I_b.__super.call(this),this.width=this.height=100}I_f(I_b,"laya.ui.Panel",I_a);var I_c=I_b.prototype;return I_c.destroy=function(I_a){void 0===I_a&&(I_a=!0),laya.ui.Component.prototype.destroy.call(this,I_a),this._content&&this._content.destroy(I_a),this._vScrollBar&&this._vScrollBar.destroy(I_a),this._hScrollBar&&this._hScrollBar.destroy(I_a),this._vScrollBar=null,this._hScrollBar=null,this._content=null},I_c.destroyChildren=function(){this._content.destroyChildren()},I_c.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new I_J)},I_c.addChild=function(I_a){return I_a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(I_a)},I_c.onResize=function(){this._setScrollChanged()},I_c.addChildAt=function(I_a,I_b){return I_a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(I_a,I_b)},I_c.removeChild=function(I_a){return I_a.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(I_a)},I_c.removeChildAt=function(I_a){return this.getChildAt(I_a).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(I_a)},I_c.removeChildren=function(I_a,I_b){return void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=2147483647),this._content.removeChildren(I_a,I_b),this._setScrollChanged(),this},I_c.getChildAt=function(I_a){return this._content.getChildAt(I_a)},I_c.getChildByName=function(I_a){return this._content.getChildByName(I_a)},I_c.getChildIndex=function(I_a){return this._content.getChildIndex(I_a)},I_c.changeScroll=function(){this._scrollChanged=!1;var I_a=this.contentWidth||1,I_b=this.contentHeight||1,I_c=this._vScrollBar,I_d=this._hScrollBar,I_e=I_c&&I_b>this._height,I_f=I_d&&I_a>this._width,I_g=I_e?this._width-I_c.width:this._width,I_h=I_f?this._height-I_d.height:this._height;I_c&&(I_c.x=this._width-I_c.width,I_c.y=0,I_c.height=this._height-(I_f?I_d.height:0),I_c.scrollSize=Math.max(.033*this._height,1),I_c.thumbPercent=I_h/I_b,I_c.setScroll(0,I_b-I_h,I_c.value)),I_d&&(I_d.x=0,I_d.y=this._height-I_d.height,I_d.width=this._width-(I_e?I_c.width:0),I_d.scrollSize=Math.max(.033*this._width,1),I_d.thumbPercent=I_g/I_a,I_d.setScroll(0,I_a-I_g,I_d.value))},I_c.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},I_c.setContentSize=function(I_a,I_b){var I_c=this._content;I_c.width=I_a,I_c.height=I_b,I_c.scrollRect||(I_c.scrollRect=new I_t),I_c.scrollRect.setTo(0,0,I_a,I_b),I_c.scrollRect=I_c.scrollRect},I_c.onScrollBarChange=function(I_a){var I_b=this._content.scrollRect;if(I_b){var I_c=Math.round(I_a.value);I_a.isVertical?I_b.y=I_c:I_b.x=I_c,this._content.scrollRect=I_b}},I_c.scrollTo=function(I_a,I_b){void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),this.vScrollBar&&(this.vScrollBar.value=I_b),this.hScrollBar&&(this.hScrollBar.value=I_a)},I_c.refresh=function(){this.changeScroll()},I_c.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=I_p.superGet(I_J,this,"cacheAs")),I_p.superSet(I_J,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},I_c.onScrollEnd=function(){I_p.superSet(I_J,this,"cacheAs",this._$P.cacheAs)},I_c._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},I_e(0,I_c,"numChildren",function(){return this._content.numChildren}),I_e(0,I_c,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(I_a){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new I_Y),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=I_a}),I_e(0,I_c,"contentWidth",function(){for(var I_a=0,I_b=this._content.numChildren-1;-1<I_b;I_b--){var I_c=this._content.getChildAt(I_b);I_a=Math.max(I_c.x+I_c.width*I_c.scaleX,I_a)}return I_a}),I_e(0,I_c,"contentHeight",function(){for(var I_a=0,I_b=this._content.numChildren-1;-1<I_b;I_b--){var I_c=this._content.getChildAt(I_b);I_a=Math.max(I_c.y+I_c.height*I_c.scaleY,I_a)}return I_a}),I_e(0,I_c,"width",I_a.prototype._$get_width,function(I_a){I_p.superSet(I_J,this,"width",I_a),this._setScrollChanged()}),I_e(0,I_c,"hScrollBar",function(){return this._hScrollBar}),I_e(0,I_c,"content",function(){return this._content}),I_e(0,I_c,"height",I_a.prototype._$get_height,function(I_a){I_p.superSet(I_J,this,"height",I_a),this._setScrollChanged()}),I_e(0,I_c,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(I_a){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new I_ba),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=I_a}),I_e(0,I_c,"vScrollBar",function(){return this._vScrollBar}),I_e(0,I_c,"cacheAs",I_a.prototype._$get_cacheAs,function(I_a){I_p.superSet(I_J,this,"cacheAs",I_a),this._$P.cacheAs=null,"none"!==I_a?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),I_b}(I_J),I_$=function(I_a){function I_b(I_a){I_b.__super.call(this,I_a),this.isVertical=!1}return I_f(I_b,"laya.ui.HSlider",I_P),I_b}(),I__=function(I_a){function I_c(I_a,I_b){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,I_c.__super.call(this),this.skin=I_b,this.labels=I_a}I_f(I_c,"laya.ui.UIGroup",I_a);var I_b=I_c.prototype;return I_p.imps(I_b,{"laya.ui.IItem":!0}),I_b.preinitialize=function(){this.mouseEnabled=!0},I_b.destroy=function(I_a){void 0===I_a&&(I_a=!0),laya.ui.Component.prototype.destroy.call(this,I_a),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},I_b.addItem=function(I_a,I_b){void 0===I_b&&(I_b=!0);var I_c=I_a,I_d=this._items.length;if(I_c.name="item"+I_d,this.addChild(I_c),this.initItems(),I_b&&0<I_d){var I_e=this._items[I_d-1];"horizontal"==this._direction?I_c.x=I_e.x+I_e.width+this._space:I_c.y=I_e.y+I_e.height+this._space}else I_b&&(I_c.x=0,I_c.y=0);return I_d},I_b.delItem=function(I_a,I_b){void 0===I_b&&(I_b=!0);var I_c=this._items.indexOf(I_a);if(-1!=I_c){var I_d=I_a;this.removeChild(I_d);for(var I_e=I_c+1,I_f=this._items.length;I_e<I_f;I_e++){var I_g=this._items[I_e];I_g.name="item"+(I_e-1),I_b&&("horizontal"==this._direction?I_g.x-=I_d.width+this._space:I_g.y-=I_d.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var I_h;I_h=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=I_h}}},I_b.initItems=function(){this._items||(this._items=[]);for(var I_a=this._items.length=0;I_a<1e4;I_a++){var I_b=this.getChildByName("item"+I_a);if(null==I_b)break;this._items.push(I_b),I_b.selected=I_a===this._selectedIndex,I_b.clickHandler=I_m.create(this,this.itemClick,[I_a],!1)}},I_b.itemClick=function(I_a){this.selectedIndex=I_a},I_b.setSelect=function(I_a,I_b){this._items&&-1<I_a&&I_a<this._items.length&&(this._items[I_a].selected=I_b)},I_b.createItem=function(I_a,I_b){return null},I_b.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var I_a=0,I_b=0,I_c=this._items.length;I_b<I_c;I_b++){var I_d=this._items[I_b];this._skin&&(I_d.skin=this._skin),this._labelColors&&(I_d.labelColors=this._labelColors),this._labelSize&&(I_d.labelSize=this._labelSize),this._labelStroke&&(I_d.labelStroke=this._labelStroke),this._labelStrokeColor&&(I_d.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(I_d.strokeColors=this._strokeColors),this._labelBold&&(I_d.labelBold=this._labelBold),this._labelPadding&&(I_d.labelPadding=this._labelPadding),this._labelAlign&&(I_d.labelAlign=this._labelAlign),this._stateNum&&(I_d.stateNum=this._stateNum),this._labelFont&&(I_d.labelFont=this._labelFont),"horizontal"===this._direction?(I_d.y=0,I_d.x=I_a,I_a+=I_d.width+this._space):(I_d.x=0,I_d.y=I_a,I_a+=I_d.height+this._space)}this.changeSize()},I_b.commitMeasure=function(){this.runCallLater(this.changeLabels)},I_b._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},I_e(0,I_b,"labelStrokeColor",function(){return this._labelStrokeColor},function(I_a){this._labelStrokeColor!=I_a&&(this._labelStrokeColor=I_a,this._setLabelChanged())}),I_e(0,I_b,"skin",function(){return this._skin},function(I_a){this._skin!=I_a&&(this._skin=I_a,this._setLabelChanged())}),I_e(0,I_b,"selectedIndex",function(){return this._selectedIndex},function(I_a){this._selectedIndex!=I_a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=I_a,this.setSelect(I_a,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),I_e(0,I_b,"labels",function(){return this._labels},function(I_a){if(this._labels!=I_a){if(this._labels=I_a,this.removeChildren(),this._setLabelChanged(),this._labels)for(var I_b=this._labels.split(","),I_c=0,I_d=I_b.length;I_c<I_d;I_c++){var I_e=this.createItem(this._skin,I_b[I_c]);I_e.name="item"+I_c,this.addChild(I_e)}this.initItems()}}),I_e(0,I_b,"strokeColors",function(){return this._strokeColors},function(I_a){this._strokeColors!=I_a&&(this._strokeColors=I_a,this._setLabelChanged())}),I_e(0,I_b,"labelColors",function(){return this._labelColors},function(I_a){this._labelColors!=I_a&&(this._labelColors=I_a,this._setLabelChanged())}),I_e(0,I_b,"labelStroke",function(){return this._labelStroke},function(I_a){this._labelStroke!=I_a&&(this._labelStroke=I_a,this._setLabelChanged())}),I_e(0,I_b,"labelSize",function(){return this._labelSize},function(I_a){this._labelSize!=I_a&&(this._labelSize=I_a,this._setLabelChanged())}),I_e(0,I_b,"stateNum",function(){return this._stateNum},function(I_a){this._stateNum!=I_a&&(this._stateNum=I_a,this._setLabelChanged())}),I_e(0,I_b,"labelBold",function(){return this._labelBold},function(I_a){this._labelBold!=I_a&&(this._labelBold=I_a,this._setLabelChanged())}),I_e(0,I_b,"labelFont",function(){return this._labelFont},function(I_a){this._labelFont!=I_a&&(this._labelFont=I_a,this._setLabelChanged())}),I_e(0,I_b,"labelPadding",function(){return this._labelPadding},function(I_a){this._labelPadding!=I_a&&(this._labelPadding=I_a,this._setLabelChanged())}),I_e(0,I_b,"direction",function(){return this._direction},function(I_a){this._direction=I_a,this._setLabelChanged()}),I_e(0,I_b,"space",function(){return this._space},function(I_a){this._space=I_a,this._setLabelChanged()}),I_e(0,I_b,"items",function(){return this._items}),I_e(0,I_b,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(I_a){this.selectedIndex=this._items.indexOf(I_a)}),I_e(0,I_b,"dataSource",I_a.prototype._$get_dataSource,function(I_a){"number"==typeof(this._dataSource=I_a)&&Math.floor(I_a)==I_a||"string"==typeof I_a?this.selectedIndex=parseInt(I_a):I_a instanceof Array?this.labels=I_a.join(","):I_p.superSet(I_J,this,"dataSource",I_a)}),I_c}(I_J),I_q=function(I_b){function I_c(I_a,I_b){this._value=null,void 0===I_b&&(I_b=""),I_c.__super.call(this,I_a,I_b)}I_f(I_c,"laya.ui.Radio",I_b);var I_a=I_c.prototype;return I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,I_a),this._value=null},I_a.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},I_a.initialize=function(){I_b.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},I_a.onClick=function(I_a){this.selected=!0},I_e(0,I_a,"value",function(){return null!=this._value?this._value:this.label},function(I_a){this._value=I_a}),I_c}(I_K),I_r=function(I_a){function I_b(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,I_b.__super.call(this),this.width=this.height=200}I_f(I_b,"laya.ui.Tree",I_a);var I_c=I_b.prototype;return I_p.imps(I_c,{"laya.ui.IRender":!0}),I_c.destroy=function(I_a){void 0===I_a&&(I_a=!0),laya.ui.Component.prototype.destroy.call(this,I_a),this._list&&this._list.destroy(I_a),this._list=null,this._source=null,this._renderHandler=null},I_c.createChildren=function(){this.addChild(this._list=new I_X),this._list.renderHandler=I_m.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},I_c.onListChange=function(I_a){this.event("change")},I_c.getArray=function(){var I_a,I_b=[];for(var I_c in this._source)I_a=this._source[I_c],this.getParentOpenStatus(I_a)&&(I_a.x=this._spaceLeft*this.getDepth(I_a),I_b.push(I_a));return I_b},I_c.getDepth=function(I_a,I_b){return void 0===I_b&&(I_b=0),null==I_a.nodeParent?I_b:this.getDepth(I_a.nodeParent,I_b+1)},I_c.getParentOpenStatus=function(I_a){var I_b=I_a.nodeParent;return null==I_b||!!I_b.isOpen&&(null==I_b.nodeParent||this.getParentOpenStatus(I_b))},I_c.renderItem=function(I_a,I_b){var I_c=I_a.dataSource;if(I_c){I_a.left=I_c.x;var I_d=I_a.getChildByName("arrow");I_d&&(I_c.hasChild?(I_d.visible=!0,I_d.index=I_c.isOpen?1:0,I_d.tag=I_b,I_d.off("click",this,this.onArrowClick),I_d.on("click",this,this.onArrowClick)):I_d.visible=!1);var I_e=I_a.getChildByName("folder");I_e&&(2==I_e.clipY?I_e.index=I_c.isDirectory?0:1:I_e.index=I_c.isDirectory?I_c.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([I_a,I_b])}},I_c.onArrowClick=function(I_a){var I_b=I_a.currentTarget.tag;this._list.array[I_b].isOpen=!this._list.array[I_b].isOpen,this.event("open"),this._list.array=this.getArray()},I_c.setItemState=function(I_a,I_b){this._list.array[I_a]&&(this._list.array[I_a].isOpen=I_b,this._list.array=this.getArray())},I_c.fresh=function(){this._list.array=this.getArray(),this.repaint()},I_c.parseXml=function(I_a,I_b,I_c,I_d){var I_e,I_f=I_a.childNodes,I_g=I_f.length;if(!I_d){I_e={};var I_h,I_i=I_a.attributes;for(var I_j in I_i){var I_k=(I_h=I_i[I_j]).nodeName,I_l=I_h.nodeValue;I_e[I_k]="true"==I_l||"false"!=I_l&&I_l}I_e.nodeParent=I_c,0<I_g&&(I_e.isDirectory=!0),I_e.hasChild=0<I_g,I_b.push(I_e)}for(var I_m=0;I_m<I_g;I_m++){var I_n=I_f[I_m];this.parseXml(I_n,I_b,I_e,!1)}},I_c.parseOpenStatus=function(I_a,I_b){for(var I_c=0,I_d=I_b.length;I_c<I_d;I_c++){var I_e=I_b[I_c];if(I_e.isDirectory)for(var I_f=0,I_g=I_a.length;I_f<I_g;I_f++){var I_h=I_a[I_f];if(I_h.isDirectory&&this.isSameParent(I_h,I_e)&&I_e.label==I_h.label){I_e.isOpen=I_h.isOpen;break}}}},I_c.isSameParent=function(I_a,I_b){return null==I_a.nodeParent&&null==I_b.nodeParent||null!=I_a.nodeParent&&null!=I_b.nodeParent&&(I_a.nodeParent.label==I_b.nodeParent.label&&this.isSameParent(I_a.nodeParent,I_b.nodeParent))},I_c.filter=function(I_a){if(Boolean(I_a)){var I_b=[];this.getFilterSource(this._source,I_b,I_a),this._list.array=I_b}else this._list.array=this.getArray()},I_c.getFilterSource=function(I_a,I_b,I_c){var I_d;for(var I_e in I_c=I_c.toLocaleLowerCase(),I_a)!(I_d=I_a[I_e]).isDirectory&&-1<String(I_d.label).toLowerCase().indexOf(I_c)&&(I_d.x=0,I_b.push(I_d)),I_d.child&&0<I_d.child.length&&this.getFilterSource(I_d.child,I_b,I_c)},I_e(0,I_c,"spaceBottom",function(){return this._list.spaceY},function(I_a){this._list.spaceY=I_a}),I_e(0,I_c,"keepStatus",function(){return this._keepStatus},function(I_a){this._keepStatus=I_a}),I_e(0,I_c,"itemRender",function(){return this._list.itemRender},function(I_a){this._list.itemRender=I_a}),I_e(0,I_c,"array",function(){return this._list.array},function(I_a){this._keepStatus&&this._list.array&&I_a&&this.parseOpenStatus(this._list.array,I_a),this._source=I_a,this._list.array=this.getArray()}),I_e(0,I_c,"mouseHandler",function(){return this._list.mouseHandler},function(I_a){this._list.mouseHandler=I_a}),I_e(0,I_c,"dataSource",I_a.prototype._$get_dataSource,function(I_a){this._dataSource=I_a,I_p.superSet(I_J,this,"dataSource",I_a)}),I_e(0,I_c,"source",function(){return this._source}),I_e(0,I_c,"scrollBar",function(){return this._list.scrollBar}),I_e(0,I_c,"list",function(){return this._list}),I_e(0,I_c,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(I_a){this._list.vScrollBarSkin=I_a}),I_e(0,I_c,"renderHandler",function(){return this._renderHandler},function(I_a){this._renderHandler=I_a}),I_e(0,I_c,"selectedIndex",function(){return this._list.selectedIndex},function(I_a){this._list.selectedIndex=I_a}),I_e(0,I_c,"spaceLeft",function(){return this._spaceLeft},function(I_a){this._spaceLeft=I_a}),I_e(0,I_c,"selectedItem",function(){return this._list.selectedItem},function(I_a){this._list.selectedItem=I_a}),I_e(0,I_c,"width",I_a.prototype._$get_width,function(I_a){I_p.superSet(I_J,this,"width",I_a),this._list.width=I_a}),I_e(0,I_c,"height",I_a.prototype._$get_height,function(I_a){I_p.superSet(I_J,this,"height",I_a),this._list.height=I_a}),I_e(0,I_c,"xml",null,function(I_a){var I_b=[];this.parseXml(I_a.childNodes[0],I_b,null,!0),this.array=I_b}),I_e(0,I_c,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),I_b}(I_J),I_aa=function(I_a){function I_b(){this._items=null,this._selectedIndex=0,I_b.__super.call(this),this._setIndexHandler=I_m.create(this,this.setIndex,null,!1)}I_f(I_b,"laya.ui.ViewStack",I_a);var I_c=I_b.prototype;return I_p.imps(I_c,{"laya.ui.IItem":!0}),I_c.setItems=function(I_a){this.removeChildren();for(var I_b=0,I_c=0,I_d=I_a.length;I_c<I_d;I_c++){var I_e=I_a[I_c];I_e&&(I_e.name="item"+I_b,this.addChild(I_e),I_b++)}this.initItems()},I_c.addItem=function(I_a){I_a.name="item"+this._items.length,this.addChild(I_a),this.initItems()},I_c.initItems=function(){this._items=[];for(var I_a=0;I_a<1e4;I_a++){var I_b=this.getChildByName("item"+I_a);if(null==I_b)break;this._items.push(I_b),I_b.visible=I_a==this._selectedIndex}},I_c.setSelect=function(I_a,I_b){this._items&&-1<I_a&&I_a<this._items.length&&(this._items[I_a].visible=I_b)},I_c.setIndex=function(I_a){this.selectedIndex=I_a},I_e(0,I_c,"dataSource",I_a.prototype._$get_dataSource,function(I_a){if("number"==typeof(this._dataSource=I_a)&&Math.floor(I_a)==I_a||"string"==typeof I_a)this.selectedIndex=parseInt(I_a);else for(var I_b in this._dataSource)this.hasOwnProperty(I_b)&&(this[I_b]=this._dataSource[I_b])}),I_e(0,I_c,"selectedIndex",function(){return this._selectedIndex},function(I_a){this._selectedIndex!=I_a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=I_a,this.setSelect(this._selectedIndex,!0))}),I_e(0,I_c,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(I_a){this.selectedIndex=this._items.indexOf(I_a)}),I_e(0,I_c,"items",function(){return this._items}),I_e(0,I_c,"setIndexHandler",function(){return this._setIndexHandler},function(I_a){this._setIndexHandler=I_a}),I_b}(I_J),I_ba=function(I_a){function I_b(){I_b.__super.call(this)}return I_f(I_b,"laya.ui.VScrollBar",I_O),I_b}(),I_ca=function(I_b){function I_c(I_a){this._bg=null,this._skin=null,I_c.__super.call(this),void 0===I_a&&(I_a=""),this.text=I_a,this.skin=this.skin}I_f(I_c,"laya.ui.TextInput",I_b);var I_a=I_c.prototype;return I_a.preinitialize=function(){this.mouseEnabled=!0},I_a.destroy=function(I_a){I_u.clearCache(this,this._skin),void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,I_a),this._bg&&this._bg.destroy(),this._bg=null},I_a.createChildren=function(){this.addChild(this._tf=new I_n),this._tf.padding=I_D.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},I_a._onFocus=function(){this.event("focus",this)},I_a._onBlur=function(){this.event("blur",this)},I_a._onInput=function(){this.event("input",this)},I_a._onEnter=function(){this.event("enter",this)},I_a.initialize=function(){this.width=128,this.height=22},I_a.select=function(){this._tf.select()},I_a.setSelection=function(I_a,I_b){this._tf.setSelection(I_a,I_b)},I_e(0,I_a,"text",I_b.prototype._$get_text,function(I_a){this._tf.text!=I_a&&(I_a+="",this._tf.text=I_a,this.event("change"))}),I_e(0,I_a,"bg",function(){return this._bg},function(I_a){this.graphics=this._bg=I_a}),I_e(0,I_a,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(I_a){this._tf.inputElementYAdjuster=I_a}),I_e(0,I_a,"multiline",function(){return this._tf.multiline},function(I_a){this._tf.multiline=I_a}),I_e(0,I_a,"skin",function(){return this._skin},function(I_a){this._skin!=I_a&&(I_u.clearCache(this,this._skin),this._skin=I_a,this._bg||(this.graphics=this._bg=new I_G),I_u.keepCache(this,this._skin),this._bg.source=I_u.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),I_e(0,I_a,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(I_a){this._bg||(this.graphics=this._bg=new I_G),this._bg.sizeGrid=I_E.fillArray(I_D.defaultSizeGrid,I_a,Number)}),I_e(0,I_a,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(I_a){this._tf.inputElementXAdjuster=I_a}),I_e(0,I_a,"width",I_b.prototype._$get_width,function(I_a){I_p.superSet(I_R,this,"width",I_a),this._bg&&(this._bg.width=I_a)}),I_e(0,I_a,"height",I_b.prototype._$get_height,function(I_a){I_p.superSet(I_R,this,"height",I_a),this._bg&&(this._bg.height=I_a)}),I_e(0,I_a,"editable",function(){return this._tf.editable},function(I_a){this._tf.editable=I_a}),I_e(0,I_a,"restrict",function(){return this._tf.restrict},function(I_a){this._tf.restrict=I_a}),I_e(0,I_a,"prompt",function(){return this._tf.prompt},function(I_a){this._tf.prompt=I_a}),I_e(0,I_a,"promptColor",function(){return this._tf.promptColor},function(I_a){this._tf.promptColor=I_a}),I_e(0,I_a,"maxChars",function(){return this._tf.maxChars},function(I_a){this._tf.maxChars=I_a}),I_e(0,I_a,"focus",function(){return this._tf.focus},function(I_a){this._tf.focus=I_a}),I_e(0,I_a,"type",function(){return this._tf.type},function(I_a){this._tf.type=I_a}),I_e(0,I_a,"asPassword",function(){return this._tf.asPassword},function(I_a){this._tf.asPassword=I_a}),I_c}(I_R),I_da=function(I_a){function I_b(){I_b.__super.call(this)}return I_f(I_b,"laya.ui.VSlider",I_P),I_b}(),I_ea=function(I_a){function I_d(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,I_d.__super.call(this)}I_f(I_d,"laya.ui.Dialog",I_a);var I_b=I_d.prototype;return I_b.initialize=function(){this.popupEffect=I_d.manager.popupEffectHandler,this.closeEffect=I_d.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},I_b._dealDragArea=function(){var I_a=this.getChildByName("drag");I_a&&(this.dragArea=I_a.x+","+I_a.y+","+I_a.width+","+I_a.height,I_a.removeSelf())},I_b._onClick=function(I_a){var I_b=I_a.target;if(I_b)switch(I_b.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(I_b.name)}},I_b.show=function(I_a,I_b){void 0===I_a&&(I_a=!1),void 0===I_b&&(I_b=!0),this._open(!1,I_a,I_b)},I_b.popup=function(I_a,I_b){void 0===I_a&&(I_a=!1),void 0===I_b&&(I_b=!0),this._open(!0,I_a,I_b)},I_b._open=function(I_a,I_b,I_c){I_d.manager.lock(!1),this.isModal=I_a,I_d.manager.open(this,I_b,I_c)},I_b.onOpened=function(){},I_b.close=function(I_a,I_b){void 0===I_b&&(I_b=!0),I_d.manager.close(this,I_a,I_b)},I_b.onClosed=function(I_a){},I_b._onMouseDown=function(I_a){var I_b=this.getMousePoint();this._dragArea.contains(I_b.x,I_b.y)?this.startDrag():this.stopDrag()},I_e(0,I_b,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(I_a){if(I_a){var I_b=I_E.fillArray([0,0,0,0],I_a,Number);this._dragArea=new I_t(I_b[0],I_b[1],I_b[2],I_b[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),I_e(0,I_b,"isPopup",function(){return null!=this.parent}),I_e(0,I_b,"zOrder",I_a.prototype._$get_zOrder,function(I_a){I_p.superSet(I_T,this,"zOrder",I_a),I_d.manager._checkMask()}),I_e(1,I_d,"manager",function(){return I_d._manager=I_d._manager||new I_I},function(I_a){I_d._manager=I_a}),I_d.setLockView=function(I_a){I_d.manager.setLockView(I_a)},I_d.lock=function(I_a){I_d.manager.lock(I_a)},I_d.closeAll=function(){I_d.manager.closeAll()},I_d.getDialogsByGroup=function(I_a){return I_d.manager.getDialogsByGroup(I_a)},I_d.closeByGroup=function(I_a){return I_d.manager.closeByGroup(I_a)},I_d.CLOSE="close",I_d.CANCEL="cancel",I_d.SURE="sure",I_d.NO="no",I_d.OK="ok",I_d.YES="yes",I_d._manager=null,I_d}(I_T),I_fa=function(I_a){function I_b(){I_b.__super.call(this)}I_f(I_b,"laya.ui.HBox",I_a);var I_c=I_b.prototype;return I_c.sortItem=function(I_a){I_a&&I_a.sort(function(I_a,I_b){return I_a.x-I_b.x})},I_c.changeItems=function(){this._itemChanged=!1;for(var I_a=[],I_b=0,I_c=0,I_d=this.numChildren;I_c<I_d;I_c++){var I_e=this.getChildAt(I_c);I_e&&I_e.layoutEnabled&&(I_a.push(I_e),I_b=this._height?this._height:Math.max(I_b,I_e.height*I_e.scaleY))}this.sortItem(I_a);var I_f=0;for(I_c=0,I_d=I_a.length;I_c<I_d;I_c++)(I_e=I_a[I_c]).x=I_f,I_f+=I_e.width*I_e.scaleX+this._space,"top"==this._align?I_e.y=0:"middle"==this._align?I_e.y=.5*(I_b-I_e.height*I_e.scaleY):"bottom"==this._align&&(I_e.y=I_b-I_e.height*I_e.scaleY);this.changeSize()},I_e(0,I_c,"height",I_a.prototype._$get_height,function(I_a){this._height!=I_a&&(I_p.superSet(I_V,this,"height",I_a),this.callLater(this.changeItems))}),I_b.NONE="none",I_b.TOP="top",I_b.MIDDLE="middle",I_b.BOTTOM="bottom",I_b}(I_V),I_ga=function(I_a){function I_b(){I_b.__super.call(this)}I_f(I_b,"laya.ui.VBox",I_a);var I_c=I_b.prototype;return I_c.changeItems=function(){this._itemChanged=!1;for(var I_a=[],I_b=0,I_c=0,I_d=this.numChildren;I_c<I_d;I_c++){var I_e=this.getChildAt(I_c);I_e&&I_e.layoutEnabled&&(I_a.push(I_e),I_b=this._width?this._width:Math.max(I_b,I_e.width*I_e.scaleX))}this.sortItem(I_a);var I_f=0;for(I_c=0,I_d=I_a.length;I_c<I_d;I_c++)(I_e=I_a[I_c]).y=I_f,I_f+=I_e.height*I_e.scaleY+this._space,"left"==this._align?I_e.x=0:"center"==this._align?I_e.x=.5*(I_b-I_e.width*I_e.scaleX):"right"==this._align&&(I_e.x=I_b-I_e.width*I_e.scaleX);this.changeSize()},I_e(0,I_c,"width",I_a.prototype._$get_width,function(I_a){this._width!=I_a&&(I_p.superSet(I_V,this,"width",I_a),this.callLater(this.changeItems))}),I_b.NONE="none",I_b.LEFT="left",I_b.CENTER="center",I_b.RIGHT="right",I_b}(I_V),I_ha=function(I_a){function I_b(){I_b.__super.call(this)}return I_f(I_b,"laya.ui.RadioGroup",I__),I_b.prototype.createItem=function(I_a,I_b){return new I_q(I_a,I_b)},I_b}(),I_ia=function(I_a){function I_b(){I_b.__super.call(this)}return I_f(I_b,"laya.ui.Tab",I__),I_b.prototype.createItem=function(I_a,I_b){return new I_K(I_a,I_b)},I_b}(),I_ja=function(I_b){function I_c(I_a){this._vScrollBar=null,this._hScrollBar=null,void 0===I_a&&(I_a=""),I_c.__super.call(this,I_a)}I_f(I_c,"laya.ui.TextArea",I_b);var I_a=I_c.prototype;return I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,I_a),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},I_a.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},I_a.onVBarChanged=function(I_a){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},I_a.onHBarChanged=function(I_a){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},I_a.changeScroll=function(){var I_a=this._vScrollBar&&0<this._tf.maxScrollY,I_b=this._hScrollBar&&0<this._tf.maxScrollX,I_c=I_a?this._width-this._vScrollBar.width:this._width,I_d=I_b?this._height-this._hScrollBar.height:this._height,I_e=this._tf.padding||I_D.labelPadding;this._tf.width=I_c,this._tf.height=I_d,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-I_e[2],this._vScrollBar.y=I_e[1],this._vScrollBar.height=this._height-(I_b?this._hScrollBar.height:0)-I_e[1]-I_e[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=I_d/Math.max(this._tf.textHeight,I_d),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=I_a),this._hScrollBar&&(this._hScrollBar.x=I_e[0],this._hScrollBar.y=this._height-this._hScrollBar.height-I_e[3],this._hScrollBar.width=this._width-(I_a?this._vScrollBar.width:0)-I_e[0]-I_e[2],this._hScrollBar.scrollSize=Math.max(.033*I_c,1),this._hScrollBar.thumbPercent=I_c/Math.max(this._tf.textWidth,I_c),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=I_b)},I_a.scrollTo=function(I_a){this.commitMeasure(),this._tf.scrollY=I_a},I_e(0,I_a,"scrollY",function(){return this._tf.scrollY}),I_e(0,I_a,"width",I_b.prototype._$get_width,function(I_a){I_p.superSet(I_ca,this,"width",I_a),this.callLater(this.changeScroll)}),I_e(0,I_a,"hScrollBar",function(){return this._hScrollBar}),I_e(0,I_a,"height",I_b.prototype._$get_height,function(I_a){I_p.superSet(I_ca,this,"height",I_a),this.callLater(this.changeScroll)}),I_e(0,I_a,"maxScrollX",function(){return this._tf.maxScrollX}),I_e(0,I_a,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(I_a){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new I_ba),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=I_a}),I_e(0,I_a,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(I_a){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new I_Y),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=I_a}),I_e(0,I_a,"vScrollBar",function(){return this._vScrollBar}),I_e(0,I_a,"maxScrollY",function(){return this._tf.maxScrollY}),I_e(0,I_a,"scrollX",function(){return this._tf.scrollX}),I_c}(I_ca);!function(I_a){function I_b(){this._uiView=null,this.isCloseOther=!1,I_b.__super.call(this)}I_f(I_b,"laya.ui.AsynDialog",I_ea);var I_c=I_b.prototype;I_c.createView=function(I_a){this._uiView=I_a},I_c._open=function(I_a,I_b,I_c){this.isModal=I_a,this.isCloseOther=I_b,I_ea.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},I_c.onCreated=function(){this.createUI(),this.onOpen()},I_c.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},I_c.onOpen=function(){I_ea.manager.open(this,this.isCloseOther),I_ea.manager.lock(!1)},I_c.close=function(I_a,I_b){void 0===I_b&&(I_b=!0),I_ea.manager.close(this),this.onClose()},I_c.onClose=function(){},I_c.destroy=function(I_a){void 0===I_a&&(I_a=!0),laya.ui.View.prototype.destroy.call(this,I_a),this._uiView=null,this.onDestroy()},I_c.onDestroy=function(){}}();I_p.__init([I_T])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(I_a,I_b){"use strict";for(var I_c in Object.defineProperty(I_b,"__esModule",{value:!0}),Laya){var I_d=Laya[I_c];I_d&&I_d.__isclass&&(I_b[I_c]=I_d)}}),function(I_m,I_a,I_x){I_x.un,I_x.uns;var I_l=I_x.static,I_n=I_x.class,I_o=I_x.getset,I_d=I_x.__newvec,I_w=laya.maths.Arith,I_g=laya.webgl.atlas.AtlasResourceManager,I_c=laya.webgl.shader.BaseShader,I_H=laya.utils.Browser,I_h=laya.webgl.utils.Buffer,I_y=laya.utils.Byte,I_e=laya.utils.ClassUtils,I_i=I_x.Config,I_f=(laya.events.Event,laya.events.EventDispatcher),I_D=laya.utils.Handler,I_t=laya.net.Loader,I_b=laya.net.LoaderManager,I_j=(laya.maths.MathUtil,laya.display.Node),I_p=laya.renders.Render,I_k=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),I_s=laya.resource.Resource,I_u=laya.utils.RunDriver,I_v=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),I_z=laya.display.Sprite,I_A=laya.utils.Stat,I_B=laya.utils.StringKey,I_E=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),I_C=laya.utils.Utils,I_F=laya.webgl.WebGL,I_G=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;I_x.interface("laya.d3.core.IClone"),I_x.interface("laya.d3.graphics.IVertex"),I_x.interface("laya.d3.core.render.IUpdate"),I_x.interface("laya.d3.core.scene.ITreeNode"),I_x.interface("laya.d3.core.render.IRenderable");(function(){function I_K(){}I_n(I_K,"laya.d3.animation.AnimationClipParser01"),I_K.READ_DATA=function(){I_K._DATA.offset=I_K._reader.getUint32(),I_K._DATA.size=I_K._reader.getUint32()},I_K.READ_BLOCK=function(){for(var I_a=I_K._BLOCK.count=I_K._reader.getUint16(),I_b=I_K._BLOCK.blockStarts=[],I_c=I_K._BLOCK.blockLengths=[],I_d=0;I_d<I_a;I_d++)I_b.push(I_K._reader.getUint32()),I_c.push(I_K._reader.getUint32())},I_K.READ_STRINGS=function(){var I_a=I_K._reader.getUint32(),I_b=I_K._reader.getUint16(),I_c=I_K._reader.pos;I_K._reader.pos=I_a+I_K._DATA.offset;for(var I_d=0;I_d<I_b;I_d++)I_K._strings[I_d]=I_K._reader.readUTFString();I_K._reader.pos=I_c},I_K.parse=function(I_a,I_b){I_K._animationClip=I_a;(I_K._reader=I_b).__getBuffer();I_K.READ_DATA(),I_K.READ_BLOCK(),I_K.READ_STRINGS();for(var I_c=0,I_d=I_K._BLOCK.count;I_c<I_d;I_c++){var I_e=I_b.getUint16(),I_f=I_K._strings[I_e],I_g=I_K["READ_"+I_f];if(null==I_g)throw new Error("model file err,no this function:"+I_e+" "+I_f);I_g.call()}},I_K.READ_ANIMATIONS=function(){var I_a,I_b=0,I_c=0,I_d=I_K._reader,I_e=I_d.__getBuffer(),I_f=[],I_g=I_d.getUint8();for(I_f.length=I_g,I_b=0;I_b<I_g;I_b++)I_f[I_b]=I_d.getUint16();var I_h=[],I_i=I_d.getUint16();for(I_h.length=I_i,I_b=0;I_b<I_i;I_b++)I_h[I_b]=I_d.getFloat32();var I_j=I_K._animationClip;I_j.name=I_K._strings[I_d.getUint16()];var I_k=I_j._duration=I_d.getFloat32();I_j.islooping=!!I_d.getByte(),I_j._frameRate=I_d.getInt16();var I_l=I_d.getInt16(),I_m=I_j._nodes=new Array;I_m.length=I_l,(I_j._publicClipDatas=[]).length=I_l;var I_n=I_j._nodesMap={},I_o=0,I_p=0;for(I_b=0;I_b<I_l;I_b++){I_a=I_m[I_b]=new I_S;var I_s=I_d.getUint16(),I_t=I_a.path=[];for(I_t.length=I_s,I_c=0;I_c<I_s;I_c++)I_t[I_c]=I_K._strings[I_d.getUint16()];var I_u=I_t.join("/"),I_v=I_n[I_u];I_v||(I_n[I_u]=I_v=[]),I_v.push(I_a);var I_w=I_d.getInt16();-1!==I_w&&(I_a.componentType=I_K._strings[I_w]);var I_x=I_Q._propertyIndexDic[I_K._strings[I_d.getUint16()]];if(null==I_x)throw new Error("AnimationClipParser01:unknown property name.");var I_y=I_x<4,I_z=!I_y||I_y&&""===I_t[0];(I_a._cacheProperty=I_z)?I_o++:I_p++,I_a.propertyNameID=I_x;var I_A=I_f[I_d.getUint8()];I_a.keyFrameWidth=I_A/4;var I_B=I_a.keyFrames=[],I_C=I_B.length=I_d.getUint16(),I_D=null,I_E=NaN;for(I_c=0;I_c<I_C;I_c++){var I_F=I_B[I_c]=new I_R;I_E=I_F.startTime=I_h[I_d.getUint16()];var I_G=I_d.pos;I_F.inTangent=new Float32Array(I_e.slice(I_G,I_G+I_A)),I_d.pos+=I_A,I_G=I_d.pos,I_F.outTangent=new Float32Array(I_e.slice(I_G,I_G+I_A)),I_d.pos+=I_A,I_G=I_d.pos,I_F.data=new Float32Array(I_e.slice(I_G,I_G+I_A)),I_d.pos+=I_A,I_D&&(I_D.next=I_F,I_D.duration=I_E-I_D.startTime),I_D=I_F}I_F.next=null,I_F.duration=I_k-I_E}var I_H=I_j._nodeToCachePropertyMap=new Int32Array(I_l),I_I=I_j._cachePropertyMap=new Int32Array(I_o),I_J=I_j._unCachePropertyMap=new Int32Array(I_p);for(I_o=I_p=0,I_b=0;I_b<I_l;I_b++)(I_a=I_m[I_b])._cacheProperty?(I_H[I_b]=I_o,I_I[I_o++]=I_b):I_J[I_p++]=I_b},I_K._animationClip=null,I_K._reader=null,I_K._strings=[],I_l(I_K,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function I_O(){}I_n(I_O,"laya.d3.animation.AnimationClipParser02"),I_O.READ_DATA=function(){I_O._DATA.offset=I_O._reader.getUint32(),I_O._DATA.size=I_O._reader.getUint32()},I_O.READ_BLOCK=function(){for(var I_a=I_O._BLOCK.count=I_O._reader.getUint16(),I_b=I_O._BLOCK.blockStarts=[],I_c=I_O._BLOCK.blockLengths=[],I_d=0;I_d<I_a;I_d++)I_b.push(I_O._reader.getUint32()),I_c.push(I_O._reader.getUint32())},I_O.READ_STRINGS=function(){var I_a=I_O._reader.getUint32(),I_b=I_O._reader.getUint16(),I_c=I_O._reader.pos;I_O._reader.pos=I_a+I_O._DATA.offset;for(var I_d=0;I_d<I_b;I_d++)I_O._strings[I_d]=I_O._reader.readUTFString();I_O._reader.pos=I_c},I_O.parse=function(I_a,I_b){I_O._animationClip=I_a;(I_O._reader=I_b).__getBuffer();I_O.READ_DATA(),I_O.READ_BLOCK(),I_O.READ_STRINGS();for(var I_c=0,I_d=I_O._BLOCK.count;I_c<I_d;I_c++){var I_e=I_b.getUint16(),I_f=I_O._strings[I_e],I_g=I_O["READ_"+I_f];if(null==I_g)throw new Error("model file err,no this function:"+I_e+" "+I_f);I_g.call()}},I_O.READ_ANIMATIONS=function(){var I_a,I_b=0,I_c=0,I_d=I_O._reader,I_e=I_d.__getBuffer(),I_f=[],I_g=I_d.getUint8();for(I_f.length=I_g,I_b=0;I_b<I_g;I_b++)I_f[I_b]=I_d.getUint16();var I_h=[],I_i=I_d.getUint16();for(I_h.length=I_i,I_b=0;I_b<I_i;I_b++)I_h[I_b]=I_d.getFloat32();var I_j=I_O._animationClip;I_j.name=I_O._strings[I_d.getUint16()];var I_k=I_j._duration=I_d.getFloat32();I_j.islooping=!!I_d.getByte(),I_j._frameRate=I_d.getInt16();var I_l=I_d.getInt16(),I_m=I_j._nodes=new Array;I_m.length=I_l,(I_j._publicClipDatas=[]).length=I_l;var I_n=I_j._nodesMap={},I_o=0,I_p=0;for(I_b=0;I_b<I_l;I_b++){I_a=I_m[I_b]=new I_S;var I_s=I_d.getUint16(),I_t=I_a.path=[];for(I_t.length=I_s,I_c=0;I_c<I_s;I_c++)I_t[I_c]=I_O._strings[I_d.getUint16()];var I_u=I_t.join("/"),I_v=I_n[I_u];I_v||(I_n[I_u]=I_v=[]),I_v.push(I_a);var I_w=I_d.getInt16();-1!==I_w&&(I_a.componentType=I_O._strings[I_w]);var I_x=I_Q._propertyIndexDic[I_O._strings[I_d.getUint16()]];if(null==I_x)throw new Error("AnimationClipParser02:unknown property name.");var I_y=I_x<4,I_z=!I_y||I_y&&""===I_t[0];(I_a._cacheProperty=I_z)?I_o++:I_p++,I_a.propertyNameID=I_x;var I_A=I_f[I_d.getUint8()];I_a.keyFrameWidth=I_A/4;var I_B=I_a.keyFrames=[],I_C=I_B.length=I_d.getUint16(),I_D=null,I_E=NaN;for(I_c=0;I_c<I_C;I_c++){var I_F=I_B[I_c]=new I_R;I_E=I_F.startTime=I_h[I_d.getUint16()];var I_G=I_d.pos;I_F.inTangent=new Float32Array(I_e.slice(I_G,I_G+I_A)),I_d.pos+=I_A,I_G=I_d.pos,I_F.outTangent=new Float32Array(I_e.slice(I_G,I_G+I_A)),I_d.pos+=I_A,I_G=I_d.pos,I_F.data=new Float32Array(I_e.slice(I_G,I_G+I_A)),I_d.pos+=I_A,I_D&&(I_D.next=I_F,I_D.duration=I_E-I_D.startTime),I_D=I_F}I_F.next=null,I_F.duration=I_k-I_E}var I_H=I_d.getUint16();for(I_b=0;I_b<I_H;I_b++){var I_I,I_J=new I_P;I_J.time=I_d.getFloat32(),I_J.eventName=I_O._strings[I_d.getUint16()];var I_K=I_d.getUint16();for(0<I_K&&(I_J.params=I_I=[]),I_c=0;I_c<I_K;I_c++){switch(I_d.getByte()){case 0:I_I.push(!!I_d.getByte());break;case 1:I_I.push(I_d.getInt32());break;case 2:I_I.push(I_d.getFloat32());break;case 3:I_I.push(I_O._strings[I_d.getUint16()]);break;default:throw new Error("unknown type.")}}I_j.addEvent(I_J)}var I_L=I_j._nodeToCachePropertyMap=new Int32Array(I_l),I_M=I_j._cachePropertyMap=new Int32Array(I_o),I_N=I_j._unCachePropertyMap=new Int32Array(I_p);for(I_o=I_p=0,I_b=0;I_b<I_l;I_b++)(I_a=I_m[I_b])._cacheProperty?(I_L[I_b]=I_o,I_M[I_o++]=I_b):I_N[I_p++]=I_b},I_O._animationClip=null,I_O._reader=null,I_O._strings=[],I_l(I_O,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var I_P=function(){function I_a(){this.time=NaN,this.eventName=null,this.params=null}return I_n(I_a,"laya.d3.animation.AnimationEvent"),I_a}(),I_Q=function(){function I_d(){this._childs=[],this.transform=new I_ub(this)}I_n(I_d,"laya.d3.animation.AnimationNode");var I_a=I_d.prototype;return I_x.imps(I_a,{"laya.d3.core.IClone":!0}),I_a.addChild=function(I_a){I_a._parent=this,I_a.transform.setParent(this.transform),this._childs.push(I_a)},I_a.removeChild=function(I_a){var I_b=this._childs.indexOf(I_a);-1!==I_b&&this._childs.splice(I_b,1)},I_a.getChildByName=function(I_a){for(var I_b=0,I_c=this._childs.length;I_b<I_c;I_b++){var I_d=this._childs[I_b];if(I_d.name===I_a)return I_d}return null},I_a.getChildByIndex=function(I_a){return this._childs[I_a]},I_a.getChildCount=function(){return this._childs.length},I_a.cloneTo=function(I_a){var I_b=I_a;I_b.name=this.name;for(var I_c=0,I_d=this._childs.length;I_c<I_d;I_c++){var I_e=this._childs[I_c],I_f=I_e.clone();I_b.addChild(I_f);var I_g=I_e.transform,I_h=I_f.transform;I_h.setLocalPosition(I_g.getLocalPosition()),I_h.setLocalRotation(I_g.getLocalRotation()),I_h.setLocalScale(I_g.getLocalScale()),I_h._localRotationEuler=I_g._localRotationEuler,I_h._setWorldMatrixIgnoreUpdate(I_g.getWorldMatrix())}},I_a.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_d.__init__=function(){I_d.registerAnimationNodeProperty("localPosition",I_d._getLocalPosition,I_d._setLocalPosition),I_d.registerAnimationNodeProperty("localRotation",I_d._getLocalRotation,I_d._setLocalRotation),I_d.registerAnimationNodeProperty("localScale",I_d._getLocalScale,I_d._setLocalScale),I_d.registerAnimationNodeProperty("localRotationEuler",I_d._getLocalRotationEuler,I_d._setLocalRotationEuler),I_d.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",I_d._getParticleRenderSharedMaterialTintColor,I_d._setParticleRenderSharedMaterialTintColor),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",I_d._getMeshRenderSharedMaterialTilingOffset,I_d._setMeshRenderSharedMaterialTilingOffset),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",I_d._getMeshRenderSharedMaterialAlbedo,I_d._setMeshRenderSharedMaterialAlbedo),I_d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",I_d._getSkinnedMeshRenderSharedMaterialTilingOffset,I_d._setSkinnedMeshRenderSharedMaterialTilingOffset),I_d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",I_d._getSkinnedMeshRenderSharedMaterialAlbedo,I_d._setSkinnedMeshRenderSharedMaterialAlbedo),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",I_d._getMeshRenderSharedMaterialAlbedo,I_d._setMeshRenderSharedMaterialAlbedo),I_d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",I_d._getSkinnedMeshRenderSharedMaterialAlbedo,I_d._setSkinnedMeshRenderSharedMaterialAlbedo),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",I_d._getMeshRenderSharedMaterialIntensity,I_d._setMeshRenderSharedMaterialIntensity),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",I_d._getMeshRenderSharedMaterialAlpha,I_d._setMeshRenderSharedMaterialAlpha),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",I_d._getMeshRenderSharedMaterialAlphaColor,I_d._setMeshRenderSharedMaterialAlphaColor),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",I_d._getMeshRenderSharedMaterialBaseColor,I_d._setMeshRenderSharedMaterialBaseColor),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",I_d._getMeshRenderSharedMaterialDissolve,I_d._setMeshRenderSharedMaterialDissolve),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",I_d._getMeshRenderSharedMaterialDissolveSpeed,I_d._setMeshRenderSharedMaterialDissolveSpeed),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",I_d._getMeshRenderSharedMaterialMMultiplier,I_d._setMeshRenderSharedMaterialMMultiplier),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",I_d._getMeshRenderSharedMaterialBaseScrollSpeedX,I_d._setMeshRenderSharedMaterialBaseScrollSpeedX),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",I_d._getMeshRenderSharedMaterialBaseScrollSpeedY,I_d._setMeshRenderSharedMaterialBaseScrollSpeedY),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",I_d._getMeshRenderSharedMaterialSecondScrollSpeedX,I_d._setMeshRenderSharedMaterialSecondScrollSpeedX),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",I_d._getMeshRenderSharedMaterialSecondScrollSpeedY,I_d._setMeshRenderSharedMaterialSecondScrollSpeedY),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",I_d._getMeshRenderSharedMaterialDetailTilingOffset,I_d._setMeshRenderSharedMaterialDetailTilingOffset),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",I_d._getMeshRenderSharedMaterialDissolveTilingOffset,I_d._setMeshRenderSharedMaterialDissolveTilingOffset),I_d.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",I_d._getMeshRenderSharedMaterialMaskTilingOffset,I_d._setMeshRenderSharedMaterialMaskTilingOffset)},I_d.registerAnimationNodeProperty=function(I_a,I_b,I_c){if(I_d._propertyIndexDic[I_a])throw new Error("AnimationNode: this propertyName has registered.");I_d._propertyIndexDic[I_a]=I_d._propertyIDCounter,I_d._propertyGetFuncs[I_d._propertyIDCounter]=I_b,I_d._propertySetFuncs[I_d._propertyIDCounter]=I_c,I_d._propertyIDCounter++},I_d._getLocalPosition=function(I_a,I_b){return I_a?I_a.transform.getLocalPosition():I_b._transform.localPosition.elements},I_d._setLocalPosition=function(I_a,I_b,I_c){if(I_a)I_a.transform.setLocalPosition(I_c);else{var I_d=I_b._transform,I_e=I_d.localPosition;I_e.elements=I_c,I_d.localPosition=I_e}},I_d._getLocalRotation=function(I_a,I_b){return I_a?I_a.transform.getLocalRotation():I_b._transform.localRotation.elements},I_d._setLocalRotation=function(I_a,I_b,I_c){if(I_a)I_a.transform.setLocalRotation(I_c);else{var I_d=I_b._transform,I_e=I_d.localRotation;I_e.elements=I_c,I_d.localRotation=I_e}},I_d._getLocalScale=function(I_a,I_b){return I_a?I_a.transform.getLocalScale():I_b._transform.localScale.elements},I_d._setLocalScale=function(I_a,I_b,I_c){if(I_a)I_a.transform.setLocalScale(I_c);else{var I_d=I_b._transform,I_e=I_d.localScale;I_e.elements=I_c,I_d.localScale=I_e}},I_d._getLocalRotationEuler=function(I_a,I_b){return I_a?I_a.transform.getLocalRotationEuler():I_b._transform.localRotationEuler.elements},I_d._setLocalRotationEuler=function(I_a,I_b,I_c){if(I_a)I_a.transform.setLocalRotationEuler(I_c);else{var I_d=I_b._transform,I_e=I_d.localRotationEuler;I_e.elements=I_c,I_d.localRotationEuler=I_e}},I_d._getMeshRenderSharedMaterialTilingOffset=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return I_b.meshRender.sharedMaterial.tilingOffset.elements},I_d._setMeshRenderSharedMaterialTilingOffset=function(I_a,I_b,I_c){var I_d,I_e;if(I_a){var I_f=I_a.transform._entity;I_f&&((I_e=(I_d=I_f.owner.meshRender.material).tilingOffset).elements=I_c,I_d.tilingOffset=I_e)}else(I_e=(I_d=I_b.meshRender.material).tilingOffset).elements=I_c,I_d.tilingOffset=I_e},I_d._getMeshRenderSharedMaterialAlbedo=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.albedoColor.elements:null}return I_b.meshRender.sharedMaterial.albedoColor.elements},I_d._setMeshRenderSharedMaterialAlbedo=function(I_a,I_b,I_c){var I_d,I_e;if(I_a){var I_f=I_a.transform._entity;I_f&&((I_e=(I_d=I_f.owner.meshRender.material).albedoColor).elements=I_c,I_d.albedoColor=I_e)}else(I_e=(I_d=I_b.meshRender.material).albedoColor).elements=I_c,I_d.albedoColor=I_e},I_d._getSkinnedMeshRenderSharedMaterialTilingOffset=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return I_b.skinnedMeshRender.sharedMaterial.tilingOffset.elements},I_d._setSkinnedMeshRenderSharedMaterialTilingOffset=function(I_a,I_b,I_c){var I_d,I_e;if(I_a){var I_f=I_a.transform._entity;I_f&&((I_e=(I_d=I_f.owner.skinnedMeshRender.material).tilingOffset).elements=I_c,I_d.tilingOffset=I_e)}else(I_e=(I_d=I_b.skinnedMeshRender.material).tilingOffset).elements=I_c,I_d.tilingOffset=I_e},I_d._getSkinnedMeshRenderSharedMaterialAlbedo=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return I_b.skinnedMeshRender.sharedMaterial.albedoColor.elements},I_d._setSkinnedMeshRenderSharedMaterialAlbedo=function(I_a,I_b,I_c){var I_d,I_e;if(I_a){var I_f=I_a.transform._entity;I_f&&((I_e=(I_d=I_f.owner.skinnedMeshRender.material).albedoColor).elements=I_c,I_d.albedoColor=I_e)}else(I_e=(I_d=I_b.skinnedMeshRender.material).albedoColor).elements=I_c,I_d.albedoColor=I_e},I_d._getParticleRenderSharedMaterialTintColor=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.particleRender.sharedMaterial.tintColor.elements:null}return I_b.particleRender.sharedMaterial.tintColor.elements},I_d._setParticleRenderSharedMaterialTintColor=function(I_a,I_b,I_c){var I_d,I_e;if(I_a){var I_f=I_a.transform._entity;I_f&&((I_e=(I_d=I_f.owner.particleRender.material).tintColor).elements=I_c,I_d.tintColor=I_e)}else(I_e=(I_d=I_b.particleRender.material).tintColor).elements=I_c,I_d.tintColor=I_e},I_d._getMeshRenderSharedMaterialAlphaColor=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.alphaColor.elements:null}return I_b.meshRender.sharedMaterial.alphaColor.elements},I_d._setMeshRenderSharedMaterialAlphaColor=function(I_a,I_b,I_c){var I_d,I_e;if(I_a){var I_f=I_a.transform._entity;I_f&&((I_e=(I_d=I_f.owner.meshRender.material).alphaColor).elements=I_c,I_d.alphaColor=I_e)}else(I_e=(I_d=I_b.meshRender.material).alphaColor).elements=I_c,I_d.alphaColor=I_e},I_d._getMeshRenderSharedMaterialBaseColor=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.baseColor.elements:null}return I_b.meshRender.sharedMaterial.baseColor.elements},I_d._setMeshRenderSharedMaterialBaseColor=function(I_a,I_b,I_c){var I_d,I_e;if(I_a){var I_f=I_a.transform._entity;I_f&&((I_e=(I_d=I_f.owner.meshRender.material).baseColor).elements=I_c,I_d.baseColor=I_e)}else(I_e=(I_d=I_b.meshRender.material).baseColor).elements=I_c,I_d.baseColor=I_e},I_d._getMeshRenderSharedMaterialDissolve=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.dissolve:0}return I_b.meshRender.sharedMaterial.dissolve},I_d._setMeshRenderSharedMaterialDissolve=function(I_a,I_b,I_c){if(I_a){var I_d=I_a.transform._entity;I_d&&(I_d.owner.meshRender.material.dissolve=I_c[0])}else I_b.meshRender.material.dissolve=I_c[0]},I_d._getMeshRenderSharedMaterialDissolveSpeed=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.dissolveSpeed:0}return I_b.meshRender.sharedMaterial.dissolveSpeed},I_d._setMeshRenderSharedMaterialDissolveSpeed=function(I_a,I_b,I_c){if(I_a){var I_d=I_a.transform._entity;I_d&&(I_d.owner.meshRender.material.dissolveSpeed=I_c[0])}else I_b.meshRender.material.dissolveSpeed=I_c[0]},I_d._getMeshRenderSharedMaterialMMultiplier=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.mMultiplier:0}return I_b.meshRender.sharedMaterial.mMultiplier},I_d._setMeshRenderSharedMaterialMMultiplier=function(I_a,I_b,I_c){if(I_a){var I_d=I_a.transform._entity;I_d&&(I_d.owner.meshRender.material.mMultiplier=I_c[0])}else I_b.meshRender.material.mMultiplier=I_c[0]},I_d._getMeshRenderSharedMaterialBaseScrollSpeedX=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return I_b.meshRender.sharedMaterial.baseScrollSpeedX},I_d._setMeshRenderSharedMaterialBaseScrollSpeedX=function(I_a,I_b,I_c){if(I_a){var I_d=I_a.transform._entity;I_d&&(I_d.owner.meshRender.material.baseScrollSpeedX=I_c[0])}else I_b.meshRender.material.baseScrollSpeedX=I_c[0]},I_d._getMeshRenderSharedMaterialBaseScrollSpeedY=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return I_b.meshRender.sharedMaterial.baseScrollSpeedY},I_d._setMeshRenderSharedMaterialBaseScrollSpeedY=function(I_a,I_b,I_c){if(I_a){var I_d=I_a.transform._entity;I_d&&(I_d.owner.meshRender.material.baseScrollSpeedY=I_c[0])}else I_b.meshRender.material.baseScrollSpeedY=I_c[0]},I_d._getMeshRenderSharedMaterialSecondScrollSpeedX=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return I_b.meshRender.sharedMaterial.secondScrollSpeedX},I_d._setMeshRenderSharedMaterialSecondScrollSpeedX=function(I_a,I_b,I_c){if(I_a){var I_d=I_a.transform._entity;I_d&&(I_d.owner.meshRender.material.secondScrollSpeedX=I_c[0])}else I_b.meshRender.material.secondScrollSpeedX=I_c[0]},I_d._getMeshRenderSharedMaterialSecondScrollSpeedY=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return I_b.meshRender.sharedMaterial.secondScrollSpeedY},I_d._setMeshRenderSharedMaterialSecondScrollSpeedY=function(I_a,I_b,I_c){if(I_a){var I_d=I_a.transform._entity;I_d&&(I_d.owner.meshRender.material.secondScrollSpeedY=I_c[0])}else I_b.meshRender.material.secondScrollSpeedY=I_c[0]},I_d._getMeshRenderSharedMaterialAlpha=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.alpha:0}return I_b.meshRender.sharedMaterial.alpha},I_d._setMeshRenderSharedMaterialAlpha=function(I_a,I_b,I_c){if(I_a){var I_d=I_a.transform._entity;I_d&&(I_d.owner.meshRender.material.alpha=I_c[0])}else I_b.meshRender.material.alpha=I_c[0]},I_d._getMeshRenderSharedMaterialIntensity=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.intensity:0}return I_b.meshRender.sharedMaterial.intensity},I_d._setMeshRenderSharedMaterialIntensity=function(I_a,I_b,I_c){if(I_a){var I_d=I_a.transform._entity;I_d&&(I_d.owner.meshRender.material.intensity=I_c[0])}else I_b.meshRender.material.intensity=I_c[0]},I_d._getMeshRenderSharedMaterialDetailTilingOffset=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return I_b.meshRender.sharedMaterial.detailTilingOffset.elements},I_d._setMeshRenderSharedMaterialDetailTilingOffset=function(I_a,I_b,I_c){var I_d,I_e;if(I_a){var I_f=I_a.transform._entity;I_f&&((I_e=(I_d=I_f.owner.meshRender.material).detailTilingOffset).elements=I_c,I_d.detailTilingOffset=I_e)}else(I_e=(I_d=I_b.meshRender.material).detailTilingOffset).elements=I_c,I_d.detailTilingOffset=I_e},I_d._getMeshRenderSharedMaterialDissolveTilingOffset=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return I_b.meshRender.sharedMaterial.dissolveTilingOffset.elements},I_d._setMeshRenderSharedMaterialDissolveTilingOffset=function(I_a,I_b,I_c){var I_d,I_e;if(I_a){var I_f=I_a.transform._entity;I_f&&((I_e=(I_d=I_f.owner.meshRender.material).dissolveTilingOffset).elements=I_c,I_d.dissolveTilingOffset=I_e)}else(I_e=(I_d=I_b.meshRender.material).dissolveTilingOffset).elements=I_c,I_d.dissolveTilingOffset=I_e},I_d._getMeshRenderSharedMaterialMaskTilingOffset=function(I_a,I_b){if(I_a){var I_c=I_a.transform._entity;return I_c?I_c.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return I_b.meshRender.sharedMaterial.maskTilingOffset.elements},I_d._setMeshRenderSharedMaterialMaskTilingOffset=function(I_a,I_b,I_c){var I_d,I_e;if(I_a){var I_f=I_a.transform._entity;I_f&&((I_e=(I_d=I_f.owner.meshRender.material).maskTilingOffset).elements=I_c,I_d.maskTilingOffset=I_e)}else(I_e=(I_d=I_b.meshRender.material).maskTilingOffset).elements=I_c,I_d.maskTilingOffset=I_e},I_d._propertyIDCounter=0,I_d._propertyIndexDic={},I_d._propertySetFuncs=[],I_d._propertyGetFuncs=[],I_d}(),I_R=function(){function I_a(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return I_n(I_a,"laya.d3.animation.Keyframe"),I_a}(),I_S=function(){function I_a(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return I_n(I_a,"laya.d3.animation.KeyframeNode"),I_a}(),I_I=(function(){function I_a(){this._tempVector30=new I_gb,this._tempVector31=new I_gb,this._tempVector32=new I_gb,this._a=new I_gb,this._b=new I_gb,this._c=new I_gb,this._d=new I_gb}I_n(I_a,"laya.d3.core.glitter.SplineCurvePositionVelocity");var I_b=I_a.prototype;I_b.Init=function(I_a,I_b,I_c,I_d){I_a.cloneTo(this._d),I_b.cloneTo(this._c),I_gb.scale(I_a,2,this._a),I_gb.scale(I_c,2,this._tempVector30),I_gb.subtract(this._a,this._tempVector30,this._a),I_gb.add(this._a,I_b,this._a),I_gb.add(this._a,I_d,this._a),I_gb.scale(I_c,3,this._b),I_gb.scale(I_a,3,this._tempVector30),I_gb.subtract(this._b,this._tempVector30,this._b),I_gb.subtract(this._b,I_d,this._b),I_gb.scale(I_b,2,this._tempVector30),I_gb.subtract(this._b,this._tempVector30,this._b)},I_b.Slerp=function(I_a,I_b){I_gb.scale(this._a,I_a*I_a*I_a,this._tempVector30),I_gb.scale(this._b,I_a*I_a,this._tempVector31),I_gb.scale(this._c,I_a,this._tempVector32),I_gb.add(this._tempVector30,this._tempVector31,I_b),I_gb.add(I_b,this._tempVector32,I_b),I_gb.add(I_b,this._d,I_b)}}(),function(){function I_M(I_a,I_b,I_c,I_d){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=I_a,this._h=I_b,this._minHeight=I_c,this._maxHeight=I_d}I_n(I_M,"laya.d3.core.HeightMap");var I_a=I_M.prototype;I_a._inBounds=function(I_a,I_b){return 0<=I_a&&I_a<this._h&&0<=I_b&&I_b<this._w},I_a.getHeight=function(I_a,I_b){return this._inBounds(I_a,I_b)?this._datas[I_a][I_b]:NaN},I_o(0,I_a,"width",function(){return this._w}),I_o(0,I_a,"height",function(){return this._h}),I_o(0,I_a,"maxHeight",function(){return this._maxHeight}),I_o(0,I_a,"minHeight",function(){return this._minHeight}),I_M.creatFromMesh=function(I_a,I_b,I_c,I_d){for(var I_e=[],I_f=[],I_g=I_a.getSubMeshCount(),I_h=0;I_h<I_g;I_h++){for(var I_i=I_a.getSubMesh(I_h),I_j=I_i._getVertexBuffer(),I_k=I_j.getData(),I_l=[],I_m=0;I_m<I_k.length;I_m+=I_j.vertexDeclaration.vertexStride/4){var I_n=new I_gb(I_k[I_m+0],I_k[I_m+1],I_k[I_m+2]);I_l.push(I_n)}I_e.push(I_l);var I_o=I_i._getIndexBuffer();I_f.push(I_o.getData())}var I_p=I_a.boundingBox,I_s=I_p.min.x,I_t=I_p.min.z,I_u=I_p.max.x,I_v=I_p.max.z,I_w=I_p.min.y,I_x=I_p.max.y,I_y=I_u-I_s,I_z=I_v-I_t,I_A=I_d.elements[0]=I_y/(I_b-1),I_B=I_d.elements[1]=I_z/(I_c-1),I_C=new I_M(I_b,I_c,I_w,I_x),I_D=I_M._tempRay,I_E=I_D.direction.elements;I_E[0]=0,I_E[1]=-1,I_E[2]=0;var I_F=I_x+.1;I_D.origin.elements[1]=I_F;for(var I_G=0;I_G<I_c;I_G++){var I_H=I_t+I_G*I_B;I_C._datas[I_G]=[];for(var I_I=0;I_I<I_b;I_I++){var I_J=I_s+I_I*I_A,I_K=I_D.origin.elements;I_K[0]=I_J,I_K[2]=I_H;var I_L=I_M._getPosition(I_D,I_e,I_f);I_C._datas[I_G][I_I]=I_L===Number.MAX_VALUE?NaN:I_F-I_L}}return I_C},I_M.createFromImage=function(I_a,I_b,I_c){for(var I_d=I_a.width,I_e=I_a.height,I_f=new I_M(I_d,I_e,I_b,I_c),I_g=(I_c-I_b)/254,I_h=I_a.getPixels(),I_i=0,I_j=0;I_j<I_e;I_j++)for(var I_k=I_f._datas[I_j]=[],I_l=0;I_l<I_d;I_l++){var I_m=I_h[I_i++],I_n=I_h[I_i++],I_o=I_h[I_i++],I_p=I_h[I_i++];I_k[I_l]=255==I_m&&255==I_n&&255==I_o&&255==I_p?NaN:(I_m+I_n+I_o)/3*I_g+I_b}return I_f},I_M._getPosition=function(I_a,I_b,I_c){for(var I_d=Number.MAX_VALUE,I_e=0;I_e<I_b.length;I_e++)for(var I_f=I_b[I_e],I_g=I_c[I_e],I_h=0;I_h<I_g.length;I_h+=3){var I_i=I_f[I_g[I_h+0]],I_j=I_f[I_g[I_h+1]],I_k=I_f[I_g[I_h+2]],I_l=I_ob.rayIntersectsTriangle(I_a,I_i,I_j,I_k);!isNaN(I_l)&&I_l<I_d&&(I_d=I_l)}return I_d},I_l(I_M,["_tempRay",function(){return this._tempRay=new I_eb(new I_gb,new I_gb)}])}(),function(){function I_e(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}I_n(I_e,"laya.d3.core.Layer");var I_a=I_e.prototype;return I_a._binarySearchIndex=function(){for(var I_a=0,I_b=I_e._collsionTestList.length-1,I_c=0;I_a<=I_b;){I_c=Math.floor((I_a+I_b)/2);var I_d=I_e._collsionTestList[I_c];if(I_d==this._number)return I_c;I_d>this._number?I_b=I_c-1:I_a=I_c+1}return I_a},I_a._addCollider=function(I_a){0===this._colliders.length&&I_e._collsionTestList.splice(this._binarySearchIndex(),0,this._number),I_a._isRigidbody?(this._colliders.unshift(I_a),this._nonRigidbodyOffset++):this._colliders.push(I_a)},I_a._removeCollider=function(I_a){var I_b=this._colliders.indexOf(I_a);I_b<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(I_b,1),0===this._colliders.length&&I_e._collsionTestList.splice(I_e._collsionTestList.indexOf(this._number),1)},I_o(0,I_a,"number",function(){return this._number}),I_o(0,I_a,"visible",function(){return this._visible},function(I_a){this._visible=I_a,I_e._visibleLayers=I_a?I_e._visibleLayers|this.mask:I_e._visibleLayers&~this.mask}),I_o(0,I_a,"mask",function(){return this._mask}),I_o(1,I_e,"visibleLayers",function(){return I_e._visibleLayers},function(I_a){I_e._visibleLayers=I_a;for(var I_b=0,I_c=I_e._layerList.length;I_b<I_c;I_b++){var I_d=I_e._layerList[I_b];I_d._visible=0!=(I_d._mask&I_e._visibleLayers)}}),I_e.__init__=function(){I_e._layerList.length=31;for(var I_a=0;I_a<31;I_a++){var I_b=new I_e;I_e._layerList[I_a]=I_b,0===I_a?(I_b.name="Default Layer",I_b.visible=!0):(I_b.name="Layer-"+I_a,I_b.visible=!1),I_b._number=I_a,I_b._mask=Math.pow(2,I_a)}I_e.currentCreationLayer=I_e._layerList[0]},I_e.getLayerByNumber=function(I_a){if(I_a<0||30<I_a)throw new Error("无法返回指定Layer，该number超出范围！");return I_e._layerList[I_a]},I_e.getLayerByName=function(I_a){for(var I_b=0;I_b<31;I_b++)if(I_e._layerList[I_b].name===I_a)return I_e._layerList[I_b];throw new Error("无法返回指定Layer,该name不存在")},I_e.isVisible=function(I_a){return 0!=(I_a&I_e._currentCameraCullingMask&I_e._visibleLayers)},I_e._layerList=[],I_e._visibleLayers=2147483647,I_e._collsionTestList=[],I_e._currentCameraCullingMask=2147483647,I_e.maxCount=31,I_e.currentCreationLayer=null,I_e}()),I_J=(function(){function I_a(I_a,I_b,I_c){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=I_a,this._minCount=I_b,this._maxCount=I_c}I_n(I_a,"laya.d3.core.particleShuriKen.module.Burst");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b.cloneTo=function(I_a){var I_b=I_a;I_b._time=this._time,I_b._minCount=this._minCount,I_b._maxCount=this._maxCount},I_b.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_b,"time",function(){return this._time}),I_o(0,I_b,"minCount",function(){return this._minCount}),I_o(0,I_b,"maxCount",function(){return this._maxCount})}(),function(){function I_a(I_a){this._color=null,this.enbale=!1,this._color=I_a}I_n(I_a,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var I_b=I_a.prototype;I_b.cloneTo=function(I_a){var I_b=I_a;this._color.cloneTo(I_b._color),I_b.enbale=this.enbale},I_b.clone=function(){var I_a;switch(this._color.type){case 0:I_a=I_L.createByConstant(this._color.constant.clone());break;case 1:I_a=I_L.createByGradient(this._color.gradient.clone());break;case 2:I_a=I_L.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:I_a=I_L.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var I_b=new this.constructor(I_a);return I_b.enbale=this.enbale,I_b},I_o(0,I_b,"color",function(){return this._color})}(),function(){function I_a(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}I_n(I_a,"laya.d3.core.particleShuriKen.module.Emission");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),I_b._destroy=function(){this._bursts=null,this._destroyed=!0},I_b.getBurstsCount=function(){return this._bursts.length},I_b.getBurstByIndex=function(I_a){return this._bursts[I_a]},I_b.addBurst=function(I_a){var I_b=this._bursts.length;if(0<I_b)for(var I_c=0;I_c<I_b;I_c++)this._bursts[I_c].time>I_a.time&&this._bursts.splice(I_c,0,I_a);this._bursts.push(I_a)},I_b.removeBurst=function(I_a){var I_b=this._bursts.indexOf(I_a);-1!==I_b&&this._bursts.splice(I_b,1)},I_b.removeBurstByIndex=function(I_a){this._bursts.splice(I_a,1)},I_b.clearBurst=function(){this._bursts.length=0},I_b.cloneTo=function(I_a){var I_b=I_a,I_c=I_b._bursts;I_c.length=this._bursts.length;for(var I_d=0,I_e=this._bursts.length;I_d<I_e;I_d++){var I_f=I_c[I_d];I_f?this._bursts[I_d].cloneTo(I_f):I_c[I_d]=this._bursts[I_d].clone()}I_b._emissionRate=this._emissionRate,I_b.enbale=this.enbale},I_b.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_b,"destroyed",function(){return this._destroyed}),I_o(0,I_b,"emissionRate",function(){return this._emissionRate},function(I_a){if(I_a<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=I_a})}(),function(){function I_d(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}I_n(I_d,"laya.d3.core.particleShuriKen.module.FrameOverTime");var I_a=I_d.prototype;return I_x.imps(I_a,{"laya.d3.core.IClone":!0}),I_a.cloneTo=function(I_a){var I_b=I_a;I_b._type=this._type,I_b._constant=this._constant,this._overTime.cloneTo(I_b._overTime),I_b._constantMin=this._constantMin,I_b._constantMax=this._constantMax,this._overTimeMin.cloneTo(I_b._overTimeMin),this._overTimeMax.cloneTo(I_b._overTimeMax)},I_a.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_a,"frameOverTimeData",function(){return this._overTime}),I_o(0,I_a,"constant",function(){return this._constant}),I_o(0,I_a,"type",function(){return this._type}),I_o(0,I_a,"frameOverTimeDataMin",function(){return this._overTimeMin}),I_o(0,I_a,"constantMin",function(){return this._constantMin}),I_o(0,I_a,"frameOverTimeDataMax",function(){return this._overTimeMax}),I_o(0,I_a,"constantMax",function(){return this._constantMax}),I_d.createByConstant=function(I_a){var I_b=new I_d;return I_b._type=0,I_b._constant=I_a,I_b},I_d.createByOverTime=function(I_a){var I_b=new I_d;return I_b._type=1,I_b._overTime=I_a,I_b},I_d.createByRandomTwoConstant=function(I_a,I_b){var I_c=new I_d;return I_c._type=2,I_c._constantMin=I_a,I_c._constantMax=I_b,I_c},I_d.createByRandomTwoOverTime=function(I_a,I_b){var I_c=new I_d;return I_c._type=3,I_c._overTimeMin=I_a,I_c._overTimeMax=I_b,I_c},I_d}()),I_K=function(){function I_j(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}I_n(I_j,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var I_a=I_j.prototype;return I_x.imps(I_a,{"laya.d3.core.IClone":!0}),I_a.cloneTo=function(I_a){var I_b=I_a;I_b._type=this._type,I_b._separateAxes=this._separateAxes,I_b._constant=this._constant,this._constantSeparate.cloneTo(I_b._constantSeparate),this._gradient.cloneTo(I_b._gradient),this._gradientX.cloneTo(I_b._gradientX),this._gradientY.cloneTo(I_b._gradientY),this._gradientZ.cloneTo(I_b._gradientZ),I_b._constantMin=this._constantMin,I_b._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(I_b._constantMinSeparate),this._constantMaxSeparate.cloneTo(I_b._constantMaxSeparate),this._gradientMin.cloneTo(I_b._gradientMin),this._gradientMax.cloneTo(I_b._gradientMax),this._gradientXMin.cloneTo(I_b._gradientXMin),this._gradientXMax.cloneTo(I_b._gradientXMax),this._gradientYMin.cloneTo(I_b._gradientYMin),this._gradientYMax.cloneTo(I_b._gradientYMax),this._gradientZMin.cloneTo(I_b._gradientZMin),this._gradientZMax.cloneTo(I_b._gradientZMax)},I_a.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_a,"gradientZ",function(){return this._gradientZ}),I_o(0,I_a,"constant",function(){return this._constant}),I_o(0,I_a,"gradient",function(){return this._gradient}),I_o(0,I_a,"separateAxes",function(){return this._separateAxes}),I_o(0,I_a,"type",function(){return this._type}),I_o(0,I_a,"constantSeparate",function(){return this._constantSeparate}),I_o(0,I_a,"gradientX",function(){return this._gradientX}),I_o(0,I_a,"gradientY",function(){return this._gradientY}),I_o(0,I_a,"gradientW",function(){return this._gradientW}),I_o(0,I_a,"gradientMin",function(){return this._gradientMin}),I_o(0,I_a,"constantMin",function(){return this._constantMin}),I_o(0,I_a,"gradientMax",function(){return this._gradientMax}),I_o(0,I_a,"constantMax",function(){return this._constantMax}),I_o(0,I_a,"gradientWMin",function(){return this._gradientWMin}),I_o(0,I_a,"constantMinSeparate",function(){return this._constantMinSeparate}),I_o(0,I_a,"constantMaxSeparate",function(){return this._constantMaxSeparate}),I_o(0,I_a,"gradientXMin",function(){return this._gradientXMin}),I_o(0,I_a,"gradientXMax",function(){return this._gradientXMax}),I_o(0,I_a,"gradientWMax",function(){return this._gradientWMax}),I_o(0,I_a,"gradientYMin",function(){return this._gradientYMin}),I_o(0,I_a,"gradientYMax",function(){return this._gradientYMax}),I_o(0,I_a,"gradientZMin",function(){return this._gradientZMin}),I_o(0,I_a,"gradientZMax",function(){return this._gradientZMax}),I_j.createByConstant=function(I_a){var I_b=new I_j;return I_b._type=0,I_b._separateAxes=!1,I_b._constant=I_a,I_b},I_j.createByConstantSeparate=function(I_a){var I_b=new I_j;return I_b._type=0,I_b._separateAxes=!0,I_b._constantSeparate=I_a,I_b},I_j.createByGradient=function(I_a){var I_b=new I_j;return I_b._type=1,I_b._separateAxes=!1,I_b._gradient=I_a,I_b},I_j.createByGradientSeparate=function(I_a,I_b,I_c,I_d){var I_e=new I_j;return I_e._type=1,I_e._separateAxes=!0,I_e._gradientX=I_a,I_e._gradientY=I_b,I_e._gradientZ=I_c,I_e._gradientW=I_d,I_e},I_j.createByRandomTwoConstant=function(I_a,I_b){var I_c=new I_j;return I_c._type=2,I_c._separateAxes=!1,I_c._constantMin=I_a,I_c._constantMax=I_b,I_c},I_j.createByRandomTwoConstantSeparate=function(I_a,I_b){var I_c=new I_j;return I_c._type=2,I_c._separateAxes=!0,I_c._constantMinSeparate=I_a,I_c._constantMaxSeparate=I_b,I_c},I_j.createByRandomTwoGradient=function(I_a,I_b){var I_c=new I_j;return I_c._type=3,I_c._separateAxes=!1,I_c._gradientMin=I_a,I_c._gradientMax=I_b,I_c},I_j.createByRandomTwoGradientSeparate=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){var I_i=new I_j;return I_i._type=3,I_i._separateAxes=!0,I_i._gradientXMin=I_a,I_i._gradientXMax=I_b,I_i._gradientYMin=I_c,I_i._gradientYMax=I_d,I_i._gradientZMin=I_e,I_i._gradientZMax=I_f,I_i._gradientWMin=I_g,I_i._gradientWMax=I_h,I_i},I_j}(),I_L=function(){function I_d(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}I_n(I_d,"laya.d3.core.particleShuriKen.module.GradientColor");var I_a=I_d.prototype;return I_x.imps(I_a,{"laya.d3.core.IClone":!0}),I_a.cloneTo=function(I_a){var I_b=I_a;I_b._type=this._type,this._constant.cloneTo(I_b._constant),this._constantMin.cloneTo(I_b._constantMin),this._constantMax.cloneTo(I_b._constantMax),this._gradient.cloneTo(I_b._gradient),this._gradientMin.cloneTo(I_b._gradientMin),this._gradientMax.cloneTo(I_b._gradientMax)},I_a.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_a,"gradient",function(){return this._gradient}),I_o(0,I_a,"constant",function(){return this._constant}),I_o(0,I_a,"type",function(){return this._type}),I_o(0,I_a,"gradientMin",function(){return this._gradientMin}),I_o(0,I_a,"constantMin",function(){return this._constantMin}),I_o(0,I_a,"gradientMax",function(){return this._gradientMax}),I_o(0,I_a,"constantMax",function(){return this._constantMax}),I_d.createByConstant=function(I_a){var I_b=new I_d;return I_b._type=0,I_b._constant=I_a,I_b},I_d.createByGradient=function(I_a){var I_b=new I_d;return I_b._type=1,I_b._gradient=I_a,I_b},I_d.createByRandomTwoConstant=function(I_a,I_b){var I_c=new I_d;return I_c._type=2,I_c._constantMin=I_a,I_c._constantMax=I_b,I_c},I_d.createByRandomTwoGradient=function(I_a,I_b){var I_c=new I_d;return I_c._type=3,I_c._gradientMin=I_a,I_c._gradientMax=I_b,I_c},I_d}(),I_M=(function(){function I_a(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}I_n(I_a,"laya.d3.core.particleShuriKen.module.GradientDataColor");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b.addAlpha=function(I_a,I_b){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==I_a&&(I_a=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=I_a,this._alphaElements[this._alphaCurrentLength++]=I_b):DEBUG},I_b.addRGB=function(I_a,I_b){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==I_a&&(I_a=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=I_a,this._rgbElements[this._rgbCurrentLength++]=I_b.x,this._rgbElements[this._rgbCurrentLength++]=I_b.y,this._rgbElements[this._rgbCurrentLength++]=I_b.z):DEBUG},I_b.cloneTo=function(I_a){var I_b=I_a,I_c=0,I_d=0;I_b._alphaCurrentLength=this._alphaCurrentLength;var I_e=I_b._alphaElements;for(I_e.length=this._alphaElements.length,I_c=0,I_d=this._alphaElements.length;I_c<I_d;I_c++)I_e[I_c]=this._alphaElements[I_c];I_b._rgbCurrentLength=this._rgbCurrentLength;var I_f=I_b._rgbElements;for(I_f.length=this._rgbElements.length,I_c=0,I_d=this._rgbElements.length;I_c<I_d;I_c++)I_f[I_c]=this._rgbElements[I_c]},I_b.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_b,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),I_o(0,I_b,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function I_a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}I_n(I_a,"laya.d3.core.particleShuriKen.module.GradientDataInt");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b.add=function(I_a,I_b){this._currentLength<8?(6===this._currentLength&&1!==I_a&&(I_a=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=I_a,this._elements[this._currentLength++]=I_b):console.log("Warning:data count must lessEqual than 4")},I_b.cloneTo=function(I_a){var I_b=I_a;I_b._currentLength=this._currentLength;var I_c=I_b._elements;I_c.length=this._elements.length;for(var I_d=0,I_e=this._elements.length;I_d<I_e;I_d++)I_c[I_d]=this._elements[I_d]},I_b.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_b,"gradientCount",function(){return this._currentLength/2})}(),function(){function I_a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}I_n(I_a,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b.add=function(I_a,I_b){this._currentLength<8?(6===this._currentLength&&1!==I_a&&(I_a=1,DEBUG),this._elements[this._currentLength++]=I_a,this._elements[this._currentLength++]=I_b):DEBUG},I_b.getKeyByIndex=function(I_a){return this._elements[2*I_a]},I_b.getValueByIndex=function(I_a){return this._elements[2*I_a+1]},I_b.getAverageValue=function(){for(var I_a=0,I_b=this._currentLength-2;I_a<I_b;I_a+=2){this._elements[I_a+1];this._elements[I_a+3],this._elements[I_a+2]-this._elements[I_a]}return 0},I_b.cloneTo=function(I_a){var I_b=I_a;I_b._currentLength=this._currentLength;var I_c=I_b._elements;I_c.length=this._elements.length;for(var I_d=0,I_e=this._elements.length;I_d<I_e;I_d++)I_c[I_d]=this._elements[I_d]},I_b.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_b,"gradientCount",function(){return this._currentLength/2})}(),function(){function I_a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}I_n(I_a,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b.add=function(I_a,I_b){this._currentLength<8?(6===this._currentLength&&1!==I_a&&(I_a=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=I_a,this._elements[this._currentLength++]=I_b.x,this._elements[this._currentLength++]=I_b.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},I_b.cloneTo=function(I_a){var I_b=I_a;I_b._currentLength=this._currentLength;var I_c=I_b._elements;I_c.length=this._elements.length;for(var I_d=0,I_e=this._elements.length;I_d<I_e;I_d++)I_c[I_d]=this._elements[I_d]},I_b.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_b,"gradientCount",function(){return this._currentLength/3})}(),function(){function I_h(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}I_n(I_h,"laya.d3.core.particleShuriKen.module.GradientSize");var I_a=I_h.prototype;return I_x.imps(I_a,{"laya.d3.core.IClone":!0}),I_a.getMaxSizeInGradient=function(){var I_a=0,I_b=0,I_c=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(I_a=0,I_b=this._gradientX.gradientCount;I_a<I_b;I_a++)I_c=Math.max(I_c,this._gradientX.getValueByIndex(I_a));for(I_a=0,I_b=this._gradientY.gradientCount;I_a<I_b;I_a++)I_c=Math.max(I_c,this._gradientY.getValueByIndex(I_a))}else for(I_a=0,I_b=this._gradient.gradientCount;I_a<I_b;I_a++)I_c=Math.max(I_c,this._gradient.getValueByIndex(I_a));break;case 1:I_c=this._separateAxes?(I_c=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),I_c=Math.max(I_c,this._constantMinSeparate.y),Math.max(I_c,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(I_a=0,I_b=this._gradientXMin.gradientCount;I_a<I_b;I_a++)I_c=Math.max(I_c,this._gradientXMin.getValueByIndex(I_a));for(I_a=0,I_b=this._gradientXMax.gradientCount;I_a<I_b;I_a++)I_c=Math.max(I_c,this._gradientXMax.getValueByIndex(I_a));for(I_a=0,I_b=this._gradientYMin.gradientCount;I_a<I_b;I_a++)I_c=Math.max(I_c,this._gradientYMin.getValueByIndex(I_a));for(I_a=0,I_b=this._gradientZMax.gradientCount;I_a<I_b;I_a++)I_c=Math.max(I_c,this._gradientZMax.getValueByIndex(I_a))}else{for(I_a=0,I_b=this._gradientMin.gradientCount;I_a<I_b;I_a++)I_c=Math.max(I_c,this._gradientMin.getValueByIndex(I_a));for(I_a=0,I_b=this._gradientMax.gradientCount;I_a<I_b;I_a++)I_c=Math.max(I_c,this._gradientMax.getValueByIndex(I_a))}}return I_c},I_a.cloneTo=function(I_a){var I_b=I_a;I_b._type=this._type,I_b._separateAxes=this._separateAxes,this._gradient.cloneTo(I_b._gradient),this._gradientX.cloneTo(I_b._gradientX),this._gradientY.cloneTo(I_b._gradientY),this._gradientZ.cloneTo(I_b._gradientZ),I_b._constantMin=this._constantMin,I_b._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(I_b._constantMinSeparate),this._constantMaxSeparate.cloneTo(I_b._constantMaxSeparate),this._gradientMin.cloneTo(I_b._gradientMin),this._gradientMax.cloneTo(I_b._gradientMax),this._gradientXMin.cloneTo(I_b._gradientXMin),this._gradientXMax.cloneTo(I_b._gradientXMax),this._gradientYMin.cloneTo(I_b._gradientYMin),this._gradientYMax.cloneTo(I_b._gradientYMax),this._gradientZMin.cloneTo(I_b._gradientZMin),this._gradientZMax.cloneTo(I_b._gradientZMax)},I_a.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_a,"gradientZ",function(){return this._gradientZ}),I_o(0,I_a,"gradient",function(){return this._gradient}),I_o(0,I_a,"separateAxes",function(){return this._separateAxes}),I_o(0,I_a,"type",function(){return this._type}),I_o(0,I_a,"gradientMin",function(){return this._gradientMin}),I_o(0,I_a,"constantMin",function(){return this._constantMin}),I_o(0,I_a,"gradientX",function(){return this._gradientX}),I_o(0,I_a,"gradientY",function(){return this._gradientY}),I_o(0,I_a,"gradientMax",function(){return this._gradientMax}),I_o(0,I_a,"constantMax",function(){return this._constantMax}),I_o(0,I_a,"constantMinSeparate",function(){return this._constantMinSeparate}),I_o(0,I_a,"constantMaxSeparate",function(){return this._constantMaxSeparate}),I_o(0,I_a,"gradientXMin",function(){return this._gradientXMin}),I_o(0,I_a,"gradientXMax",function(){return this._gradientXMax}),I_o(0,I_a,"gradientYMin",function(){return this._gradientYMin}),I_o(0,I_a,"gradientYMax",function(){return this._gradientYMax}),I_o(0,I_a,"gradientZMin",function(){return this._gradientZMin}),I_o(0,I_a,"gradientZMax",function(){return this._gradientZMax}),I_h.createByGradient=function(I_a){var I_b=new I_h;return I_b._type=0,I_b._separateAxes=!1,I_b._gradient=I_a,I_b},I_h.createByGradientSeparate=function(I_a,I_b,I_c){var I_d=new I_h;return I_d._type=0,I_d._separateAxes=!0,I_d._gradientX=I_a,I_d._gradientY=I_b,I_d._gradientZ=I_c,I_d},I_h.createByRandomTwoConstant=function(I_a,I_b){var I_c=new I_h;return I_c._type=1,I_c._separateAxes=!1,I_c._constantMin=I_a,I_c._constantMax=I_b,I_c},I_h.createByRandomTwoConstantSeparate=function(I_a,I_b){var I_c=new I_h;return I_c._type=1,I_c._separateAxes=!0,I_c._constantMinSeparate=I_a,I_c._constantMaxSeparate=I_b,I_c},I_h.createByRandomTwoGradient=function(I_a,I_b){var I_c=new I_h;return I_c._type=2,I_c._separateAxes=!1,I_c._gradientMin=I_a,I_c._gradientMax=I_b,I_c},I_h.createByRandomTwoGradientSeparate=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=new I_h;return I_g._type=2,I_g._separateAxes=!0,I_g._gradientXMin=I_a,I_g._gradientXMax=I_b,I_g._gradientYMin=I_c,I_g._gradientYMax=I_d,I_g._gradientZMin=I_e,I_g._gradientZMax=I_f,I_g},I_h}()),I_N=function(){function I_h(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}I_n(I_h,"laya.d3.core.particleShuriKen.module.GradientVelocity");var I_a=I_h.prototype;return I_x.imps(I_a,{"laya.d3.core.IClone":!0}),I_a.cloneTo=function(I_a){var I_b=I_a;I_b._type=this._type,this._constant.cloneTo(I_b._constant),this._gradientX.cloneTo(I_b._gradientX),this._gradientY.cloneTo(I_b._gradientY),this._gradientZ.cloneTo(I_b._gradientZ),this._constantMin.cloneTo(I_b._constantMin),this._constantMax.cloneTo(I_b._constantMax),this._gradientXMin.cloneTo(I_b._gradientXMin),this._gradientXMax.cloneTo(I_b._gradientXMax),this._gradientYMin.cloneTo(I_b._gradientYMin),this._gradientYMax.cloneTo(I_b._gradientYMax),this._gradientZMin.cloneTo(I_b._gradientZMin),this._gradientZMax.cloneTo(I_b._gradientZMax)},I_a.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_a,"gradientZ",function(){return this._gradientZ}),I_o(0,I_a,"constant",function(){return this._constant}),I_o(0,I_a,"type",function(){return this._type}),I_o(0,I_a,"gradientXMax",function(){return this._gradientXMax}),I_o(0,I_a,"constantMin",function(){return this._constantMin}),I_o(0,I_a,"gradientX",function(){return this._gradientX}),I_o(0,I_a,"gradientY",function(){return this._gradientY}),I_o(0,I_a,"gradientXMin",function(){return this._gradientXMin}),I_o(0,I_a,"constantMax",function(){return this._constantMax}),I_o(0,I_a,"gradientYMin",function(){return this._gradientYMin}),I_o(0,I_a,"gradientYMax",function(){return this._gradientYMax}),I_o(0,I_a,"gradientZMin",function(){return this._gradientZMin}),I_o(0,I_a,"gradientZMax",function(){return this._gradientZMax}),I_h.createByConstant=function(I_a){var I_b=new I_h;return I_b._type=0,I_b._constant=I_a,I_b},I_h.createByGradient=function(I_a,I_b,I_c){var I_d=new I_h;return I_d._type=1,I_d._gradientX=I_a,I_d._gradientY=I_b,I_d._gradientZ=I_c,I_d},I_h.createByRandomTwoConstant=function(I_a,I_b){var I_c=new I_h;return I_c._type=2,I_c._constantMin=I_a,I_c._constantMax=I_b,I_c},I_h.createByRandomTwoGradient=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=new I_h;return I_g._type=3,I_g._gradientXMin=I_a,I_g._gradientXMax=I_b,I_g._gradientYMin=I_c,I_g._gradientYMax=I_d,I_g._gradientZMin=I_e,I_g._gradientZMax=I_f,I_g},I_h}(),I_O=(function(){function I_a(I_a){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=I_a}I_n(I_a,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b.cloneTo=function(I_a){var I_b=I_a;this._angularVelocity.cloneTo(I_b._angularVelocity),I_b.enbale=this.enbale},I_b.clone=function(){var I_a;switch(this._angularVelocity.type){case 0:I_a=this._angularVelocity.separateAxes?I_K.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):I_K.createByConstant(this._angularVelocity.constant);break;case 1:I_a=this._angularVelocity.separateAxes?I_K.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):I_K.createByGradient(this._angularVelocity.gradient.clone());break;case 2:I_a=this._angularVelocity.separateAxes?I_K.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):I_K.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:I_a=this._angularVelocity.separateAxes?I_K.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):I_K.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var I_b=new this.constructor(I_a);return I_b.enbale=this.enbale,I_b},I_o(0,I_b,"angularVelocity",function(){return this._angularVelocity})}(),function(){function I_a(){this.enable=!1,this.randomDirection=!1}I_n(I_a,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b._getShapeBoundBox=function(I_a){throw new Error("BaseShape: must override it.")},I_b._getSpeedBoundBox=function(I_a){throw new Error("BaseShape: must override it.")},I_b.generatePositionAndDirection=function(I_a,I_b,I_c,I_d){throw new Error("BaseShape: must override it.")},I_b._calculateProceduralBounds=function(I_a,I_b,I_c){this._getShapeBoundBox(I_a);var I_d=I_a.min,I_e=I_a.max;I_gb.multiply(I_d,I_b,I_d),I_gb.multiply(I_e,I_b,I_e);var I_f=new I_Za(new I_gb,new I_gb);this.randomDirection?(I_f.min=new I_gb(-1,-1,-1),I_f.max=new I_gb(1,1,1)):this._getSpeedBoundBox(I_f);var I_g=new I_Za(new I_gb,new I_gb),I_h=I_g.min,I_i=I_g.max;I_gb.scale(I_f.min,I_c.y,I_h),I_gb.scale(I_f.max,I_c.y,I_i),I_gb.add(I_a.min,I_h,I_h),I_gb.add(I_a.max,I_i,I_i),I_gb.min(I_a.min,I_h,I_a.min),I_gb.max(I_a.max,I_h,I_a.max);var I_j=new I_Za(new I_gb,new I_gb),I_k=I_j.min,I_l=I_j.max;I_gb.scale(I_f.min,I_c.x,I_k),I_gb.scale(I_f.max,I_c.x,I_l),I_gb.min(I_j.min,I_l,I_h),I_gb.max(I_j.min,I_l,I_i),I_gb.min(I_a.min,I_h,I_a.min),I_gb.max(I_a.max,I_h,I_a.max)},I_b.cloneTo=function(I_a){I_a.enable=this.enable},I_b.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_a}()),I_T=function(){function I_f(){}return I_n(I_f,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),I_f._randomPointUnitArcCircle=function(I_a,I_b,I_c){var I_d=I_b.elements,I_e=NaN;I_e=I_c?I_c.getFloat()*I_a:Math.random()*I_a,I_d[0]=Math.cos(I_e),I_d[1]=Math.sin(I_e)},I_f._randomPointInsideUnitArcCircle=function(I_a,I_b,I_c){var I_d=I_b.elements;I_f._randomPointUnitArcCircle(I_a,I_b,I_c);var I_e=NaN;I_e=I_c?Math.pow(I_c.getFloat(),.5):Math.pow(Math.random(),.5),I_d[0]=I_d[0]*I_e,I_d[1]=I_d[1]*I_e},I_f._randomPointUnitCircle=function(I_a,I_b){var I_c=I_a.elements,I_d=NaN;I_d=I_b?I_b.getFloat()*Math.PI*2:Math.random()*Math.PI*2,I_c[0]=Math.cos(I_d),I_c[1]=Math.sin(I_d)},I_f._randomPointInsideUnitCircle=function(I_a,I_b){var I_c=I_a.elements;I_f._randomPointUnitCircle(I_a);var I_d=NaN;I_d=I_b?Math.pow(I_b.getFloat(),.5):Math.pow(Math.random(),.5),I_c[0]=I_c[0]*I_d,I_c[1]=I_c[1]*I_d},I_f._randomPointUnitSphere=function(I_a,I_b){var I_c=I_a.elements,I_d=NaN,I_e=NaN;I_e=I_b?(I_d=I_c[2]=2*I_b.getFloat()-1,I_b.getFloat()*Math.PI*2):(I_d=I_c[2]=2*Math.random()-1,Math.random()*Math.PI*2);var I_f=Math.sqrt(1-I_d*I_d);I_c[0]=I_f*Math.cos(I_e),I_c[1]=I_f*Math.sin(I_e)},I_f._randomPointInsideUnitSphere=function(I_a,I_b){var I_c=I_a.elements;I_f._randomPointUnitSphere(I_a);var I_d=NaN;I_d=I_b?Math.pow(I_b.getFloat(),1/3):Math.pow(Math.random(),1/3),I_c[0]=I_c[0]*I_d,I_c[1]=I_c[1]*I_d,I_c[2]=I_c[2]*I_d},I_f._randomPointInsideHalfUnitBox=function(I_a,I_b){var I_c=I_a.elements;I_b?(I_c[0]=I_b.getFloat()-.5,I_c[1]=I_b.getFloat()-.5,I_c[2]=I_b.getFloat()-.5):(I_c[0]=Math.random()-.5,I_c[1]=Math.random()-.5,I_c[2]=Math.random()-.5)},I_f}(),I_U=(function(){function I_a(I_a){this._size=null,this.enbale=!1,this._size=I_a}I_n(I_a,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b.cloneTo=function(I_a){var I_b=I_a;this._size.cloneTo(I_b._size),I_b.enbale=this.enbale},I_b.clone=function(){var I_a;switch(this._size.type){case 0:I_a=this._size.separateAxes?I_M.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):I_M.createByGradient(this._size.gradient.clone());break;case 1:I_a=this._size.separateAxes?I_M.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):I_M.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:I_a=this._size.separateAxes?I_M.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):I_M.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var I_b=new this.constructor(I_a);return I_b.enbale=this.enbale,I_b},I_o(0,I_b,"size",function(){return this._size})}(),function(){function I_d(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}I_n(I_d,"laya.d3.core.particleShuriKen.module.StartFrame");var I_a=I_d.prototype;return I_x.imps(I_a,{"laya.d3.core.IClone":!0}),I_a.cloneTo=function(I_a){var I_b=I_a;I_b._type=this._type,I_b._constant=this._constant,I_b._constantMin=this._constantMin,I_b._constantMax=this._constantMax},I_a.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_a,"constant",function(){return this._constant}),I_o(0,I_a,"type",function(){return this._type}),I_o(0,I_a,"constantMin",function(){return this._constantMin}),I_o(0,I_a,"constantMax",function(){return this._constantMax}),I_d.createByConstant=function(I_a){var I_b=new I_d;return I_b._type=0,I_b._constant=I_a,I_b},I_d.createByRandomTwoConstant=function(I_a,I_b){var I_c=new I_d;return I_c._type=1,I_c._constantMin=I_a,I_c._constantMax=I_b,I_c},I_d}()),I_V=(function(){function I_a(I_a,I_b){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new I_fb(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=I_a,this._startFrame=I_b}I_n(I_a,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b.cloneTo=function(I_a){var I_b=I_a;this.tiles.cloneTo(I_b.tiles),I_b.type=this.type,I_b.randomRow=this.randomRow,this._frame.cloneTo(I_b._frame),this._startFrame.cloneTo(I_b._startFrame),I_b.cycles=this.cycles,I_b.enableUVChannels=this.enableUVChannels,I_b.enable=this.enable},I_b.clone=function(){var I_a,I_b;switch(this._frame.type){case 0:I_a=I_J.createByConstant(this._frame.constant);break;case 1:I_a=I_J.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:I_a=I_J.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:I_a=I_J.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:I_b=I_U.createByConstant(this._startFrame.constant);break;case 1:I_b=I_U.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var I_c=new this.constructor(I_a,I_b);return this.tiles.cloneTo(I_c.tiles),I_c.type=this.type,I_c.randomRow=this.randomRow,I_c.cycles=this.cycles,I_c.enableUVChannels=this.enableUVChannels,I_c.enable=this.enable,I_c},I_o(0,I_b,"frame",function(){return this._frame}),I_o(0,I_b,"startFrame",function(){return this._startFrame})}(),function(){function I_a(I_a){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=I_a}I_n(I_a,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b.cloneTo=function(I_a){var I_b=I_a;this._velocity.cloneTo(I_b._velocity),I_b.enbale=this.enbale,I_b.space=this.space},I_b.clone=function(){var I_a;switch(this._velocity.type){case 0:I_a=I_N.createByConstant(this._velocity.constant.clone());break;case 1:I_a=I_N.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:I_a=I_N.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:I_a=I_N.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var I_b=new this.constructor(I_a);return I_b.enbale=this.enbale,I_b.space=this.space,I_b},I_o(0,I_b,"velocity",function(){return this._velocity})}(),function(){function I_a(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new I_mb,this._vb=I_Ob.create(I_a._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=I_Nb.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=I_Lb.nameKey.getID("LINE"),this._shaderCompile=I_Ab._preCompileShader[this._sharderNameID]}I_n(I_a,"laya.d3.core.PhasorSpriter3D");var I_b=I_a.prototype;return I_b.line=function(I_a,I_b,I_c,I_d){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(I_a.x,I_a.y,I_a.z,I_b.x,I_b.y,I_b.z,I_b.w),this.addVertex(I_c.x,I_c.y,I_c.z,I_d.x,I_d.y,I_d.z,I_d.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},I_b.circle=function(I_a,I_b,I_c,I_d,I_e,I_f){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*I_b,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/I_b,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*I_a,Math.cos(this._tempNumver0)*I_a,0,I_c,I_d,I_e,I_f),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},I_b.plane=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=I_d/2,this._tempNumver1=I_e/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(I_a-this._tempNumver0,I_b+this._tempNumver1,I_c,I_f,I_g,I_h,I_i),this.addVertex(I_a+this._tempNumver0,I_b+this._tempNumver1,I_c,I_f,I_g,I_h,I_i),this.addVertex(I_a-this._tempNumver0,I_b-this._tempNumver1,I_c,I_f,I_g,I_h,I_i),this.addVertex(I_a+this._tempNumver0,I_b-this._tempNumver1,I_c,I_f,I_g,I_h,I_i),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},I_b.box=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=I_d/2,this._tempNumver1=I_e/2,this._tempNumver2=I_f/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(I_a-this._tempNumver0,I_b+this._tempNumver1,I_c+this._tempNumver2,I_g,I_h,I_i,I_j),this.addVertex(I_a+this._tempNumver0,I_b+this._tempNumver1,I_c+this._tempNumver2,I_g,I_h,I_i,I_j),this.addVertex(I_a-this._tempNumver0,I_b-this._tempNumver1,I_c+this._tempNumver2,I_g,I_h,I_i,I_j),this.addVertex(I_a+this._tempNumver0,I_b-this._tempNumver1,I_c+this._tempNumver2,I_g,I_h,I_i,I_j),this.addVertex(I_a+this._tempNumver0,I_b+this._tempNumver1,I_c-this._tempNumver2,I_g,I_h,I_i,I_j),this.addVertex(I_a-this._tempNumver0,I_b+this._tempNumver1,I_c-this._tempNumver2,I_g,I_h,I_i,I_j),this.addVertex(I_a+this._tempNumver0,I_b-this._tempNumver1,I_c-this._tempNumver2,I_g,I_h,I_i,I_j),this.addVertex(I_a-this._tempNumver0,I_b-this._tempNumver1,I_c-this._tempNumver2,I_g,I_h,I_i,I_j),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},I_b.cone=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*I_c+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*I_c>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/I_c,this.addVertexIndex(0,I_b,0,I_d,I_e,I_f,I_g,this._tempUint0),this.addVertexIndex(0,0,0,I_d,I_e,I_f,I_g,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<I_c;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(I_a*this._tempNumver2,0,I_a*this._tempNumver3,I_d,I_e,I_f,I_g,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==I_c-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(I_a*this._tempNumver2,0,I_a*this._tempNumver3,I_d,I_e,I_f,I_g,this._tempUint0+(this._tempInt0+I_c)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==I_c-1?this.addIndexes(this._tempUint1+I_c+2):this.addIndexes(this._tempUint1+this._tempInt0+I_c+1),this.addIndexes(this._tempUint1+this._tempInt0+I_c),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},I_b.boundingBoxLine=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(I_a,I_e,I_f,I_g,I_h,I_i,I_j),this.addVertex(I_d,I_e,I_f,I_g,I_h,I_i,I_j),this.addVertex(I_a,I_b,I_f,I_g,I_h,I_i,I_j),this.addVertex(I_d,I_b,I_f,I_g,I_h,I_i,I_j),this.addVertex(I_d,I_e,I_c,I_g,I_h,I_i,I_j),this.addVertex(I_a,I_e,I_c,I_g,I_h,I_i,I_j),this.addVertex(I_d,I_b,I_c,I_g,I_h,I_i,I_j),this.addVertex(I_a,I_b,I_c,I_g,I_h,I_i,I_j),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},I_b.addVertex=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=I_a,this._vbData[this._posInVBData+1]=I_b,this._vbData[this._posInVBData+2]=I_c,this._vbData[this._posInVBData+3]=I_d,this._vbData[this._posInVBData+4]=I_e,this._vbData[this._posInVBData+5]=I_f,this._vbData[this._posInVBData+6]=I_g,this._posInVBData+=this._floatSizePerVer,this},I_b.addVertexIndex=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){return this._hasBegun||this.addVertexIndexException(),this._vbData[I_h]=I_a,this._vbData[I_h+1]=I_b,this._vbData[I_h+2]=I_c,this._vbData[I_h+3]=I_d,this._vbData[I_h+4]=I_e,this._vbData[I_h+5]=I_f,this._vbData[I_h+6]=I_g,(I_h+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=I_h),this},I_b.addIndexes=function(I_a){var I_b=arguments;this._hasBegun||this.addVertexIndexException();for(var I_c=0;I_c<I_b.length;I_c++)this._ibData[this._posInIBData]=I_b[I_c],this._posInIBData++;return this},I_b.begin=function(I_a,I_b){return this._hasBegun&&this.beginException0(),1!==I_a&&4!==I_a&&this.beginException1(),this._primitiveType=I_a,this._camera=I_b,this._hasBegun=!0,this},I_b.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},I_b.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(I_a._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),I_A.drawCall++,I_F.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},I_b.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},I_b.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},I_b.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},I_b.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},I_b.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},I_b.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(28,[new I_ga(0,"vector3",0),new I_ga(12,"vector4",1)])}]),I_a}()),I_W=function(){function I_a(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++I_a._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new I_mb}I_n(I_a,"laya.d3.core.render.RenderElement");var I_b=I_a.prototype;return I_b.getDynamicBatchBakedVertexs=function(I_a){for(var I_b=this._renderObj._getVertexBuffer(I_a),I_c=I_b.getData().slice(),I_d=I_b.vertexDeclaration,I_e=I_d.getVertexElementByUsage(0).offset/4,I_f=I_d.getVertexElementByUsage(3).offset/4,I_g=this._sprite3D.transform,I_h=I_g.worldMatrix,I_i=I_g.rotation,I_j=I_d.vertexStride/4,I_k=0,I_l=I_c.length;I_k<I_l;I_k+=I_j){var I_m=I_k+I_e,I_n=I_k+I_f;I_sb.transformVector3ArrayToVector3ArrayCoordinate(I_c,I_m,I_h,I_c,I_m),I_sb.transformVector3ArrayByQuat(I_c,I_n,I_i,I_c,I_n)}return I_c},I_b.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},I_b._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},I_o(0,I_b,"id",function(){return this._id}),I_o(0,I_b,"renderObj",function(){return this._renderObj},function(I_a){this._renderObj!==I_a&&(this._renderObj=I_a)}),I_a._uniqueIDCounter=0,I_a}(),I_X=function(){function I_b(I_a){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++I_b._uniqueIDCounter,this._needSort=!1,this._scene=I_a,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}I_n(I_b,"laya.d3.core.render.RenderQueue");var I_a=I_b.prototype;return I_a._sortOpaqueFunc=function(I_a,I_b){if(I_a._render&&I_b._render){var I_c=I_a._material.renderQueue-I_b._material.renderQueue;return 0==I_c?I_a._render._distanceForSort-I_b._render._distanceForSort:I_c}return 0},I_a._sortAlphaFunc=function(I_a,I_b){if(I_a._render&&I_b._render){var I_c=I_a._material.renderQueue-I_b._material.renderQueue;return 0==I_c?I_b._render._distanceForSort-I_a._render._distanceForSort:I_c}return 0},I_a._begainRenderElement=function(I_a,I_b,I_c){return!!I_b._beforeRender(I_a)},I_a._sortAlpha=function(I_a){I_b._cameraPosition=I_a,this._finalElements.sort(this._sortAlphaFunc)},I_a._sortOpaque=function(I_a){I_b._cameraPosition=I_a,this._finalElements.sort(this._sortOpaqueFunc)},I_a._preRender=function(I_a){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},I_a._render=function(I_a,I_b){for(var I_c,I_d,I_e,I_f,I_g,I_h,I_i=I_A.loopCount,I_j=this._scene,I_k=I_a.camera,I_l=(I_k.id,!1),I_m=0,I_n=this._finalElements.length;I_m<I_n;I_m++){var I_o,I_p,I_s,I_t=this._finalElements[I_m];if(null!=I_t._onPreRenderFunction&&I_t._onPreRenderFunction.call(I_t._sprite3D,I_a),0===I_t._type){if(I_a.owner=I_s=I_t._sprite3D,I_a.renderElement=I_t,I_s._preRenderUpdateComponents(I_a),I_o=I_t.renderObj,I_p=I_t._material,this._begainRenderElement(I_a,I_o,I_p)){if(I_c=I_o._getVertexBuffers(),!(I_e=(I_d=I_o._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[I_d.id]){this._errorRecord[I_d.id]=1;var I_u="vertexBuffer:"+("("+I_d._destroyed+","+I_d._released+","+I_d._referenceCount+","+I_d._buffer+")")+", material:"+(I_p?I_p.__className+"("+I_p._destroyed+","+I_p._released+")":"null")+", owner:"+(I_s?I_s.__className+"("+I_s._destroyed+","+I_s._activeInHierarchy+","+I_s._displayedInStage+")":"null")+", renderObj:"+(I_o?I_o.__className+"("+I_o._destroyed+","+I_o._released+","+I_o._referenceCount+")":"")+", parent:, url:"+(I_s?I_s.url:"")+", disposeStack:"+I_d.disposeStack;I_x.recordError("报错：unknown vertexDeclaration  "+I_u)}continue}if(I_l=(I_f=I_a._shader=I_p._getShader(I_j._shaderDefineValue,I_e.shaderDefineValue,I_s._shaderDefineValue)).bind()||I_i!==I_f._uploadLoopCount,I_c){if(I_f._uploadVertexBuffer!==I_c||I_l){for(var I_v=0;I_v<I_c.length;I_v++){var I_w=I_c[I_v];I_f.uploadAttributesX(I_w.vertexDeclaration.shaderValues.data,I_w)}I_f._uploadVertexBuffer=I_c}}else(I_f._uploadVertexBuffer!==I_d||I_l)&&(I_f.uploadAttributes(I_e.shaderValues.data,null),I_f._uploadVertexBuffer=I_d);(I_f._uploadScene!==I_j||I_l)&&(I_f.uploadSceneUniforms(I_j._shaderValues.data),I_f._uploadScene=I_j),(I_k!==I_f._uploadCamera||I_f._uploadSprite3D!==I_s||I_l)&&(I_f.uploadSpriteUniforms(I_s._shaderValues.data),I_f._uploadSprite3D=I_s),(I_k!==I_f._uploadCamera||I_l)&&(I_f.uploadCameraUniforms(I_k._shaderValues.data),I_f._uploadCamera=I_k),(I_f._uploadMaterial!==I_p||I_l)&&(I_p._upload(),I_f._uploadMaterial=I_p),I_g!==I_p?(I_p._setRenderStateBlendDepth(),I_p._setRenderStateFrontFace(I_b,I_s.transform),I_g=I_p,I_h=I_s):I_h!==I_s&&(I_p._setRenderStateFrontFace(I_b,I_s.transform),I_h=I_s),I_o._render(I_a),I_f._uploadLoopCount=I_i}I_s._postRenderUpdateComponents(I_a)}else if(2===I_t._type){I_t.renderObj;I_a.owner=I_s=I_t._sprite3D,I_a.renderElement=I_t,I_a._batchIndexStart=I_t._tempBatchIndexStart,I_a._batchIndexEnd=I_t._tempBatchIndexEnd,I_o=I_t.renderObj,I_p=I_t._material,this._begainRenderElement(I_a,I_o,I_p)&&(I_e=(I_d=I_o._getVertexBuffer(0)).vertexDeclaration,I_l=(I_f=I_a._shader=I_p._getShader(I_j._shaderDefineValue,I_e.shaderDefineValue,I_s._shaderDefineValue)).bind()||I_i!==I_f._uploadLoopCount,(I_f._uploadVertexBuffer!==I_d||I_l)&&(I_f.uploadAttributes(I_e.shaderValues.data,null),I_f._uploadVertexBuffer=I_d),(I_f._uploadScene!==I_j||I_l)&&(I_f.uploadSceneUniforms(I_j._shaderValues.data),I_f._uploadScene=I_j),(I_k!==I_f._uploadCamera||I_f._uploadSprite3D!==I_s||I_l)&&(I_f.uploadSpriteUniforms(I_s._shaderValues.data),I_f._uploadSprite3D=I_s),(I_k!==I_f._uploadCamera||I_l)&&(I_f.uploadCameraUniforms(I_k._shaderValues.data),I_f._uploadCamera=I_k),(I_f._uploadMaterial!==I_p||I_l)&&(I_p._upload(),I_f._uploadMaterial=I_p),I_g!==I_p?(I_p._setRenderStateBlendDepth(),I_p._setRenderStateFrontFace(I_b,I_s.transform),I_g=I_p,I_h=I_s):I_h!==I_s&&(I_p._setRenderStateFrontFace(I_b,I_s.transform),I_h=I_s),I_o._render(I_a),I_f._uploadLoopCount=I_i)}}},I_a._renderShadow=function(I_a,I_b){for(var I_c,I_d,I_e,I_f,I_g,I_h=I_A.loopCount,I_i=this._scene,I_j=I_a.camera,I_k=!1,I_l=0,I_m=this._finalElements.length;I_l<I_m;I_l++){var I_n,I_o,I_p,I_s=this._finalElements[I_l];0===I_s._type&&(I_a.owner=I_p=I_s._sprite3D,I_b||I_p._projectionViewWorldUpdateCamera===I_j&&I_p._projectionViewWorldUpdateLoopCount===I_A.loopCount||(I_p._render._renderUpdate(I_a._projectionViewMatrix),I_p._projectionViewWorldUpdateLoopCount=I_A.loopCount,I_p._projectionViewWorldUpdateCamera=I_j),I_a.renderElement=I_s,I_p._preRenderUpdateComponents(I_a),I_n=I_s.renderObj,I_o=I_s._material,this._begainRenderElement(I_a,I_n,null)&&(I_d=(I_c=I_n._getVertexBuffer(0)).vertexDeclaration,I_k=(I_e=I_a._shader=I_o._getShader(I_i._shaderDefineValue,I_d.shaderDefineValue,I_p._shaderDefineValue)).bind()||I_h!==I_e._uploadLoopCount,(I_e._uploadVertexBuffer!==I_c||I_k)&&(I_e.uploadAttributes(I_d.shaderValues.data,null),I_e._uploadVertexBuffer=I_c),(I_j!==I_e._uploadCamera||I_e._uploadSprite3D!==I_p||I_k)&&(I_e.uploadSpriteUniforms(I_p._shaderValues.data),I_e._uploadSprite3D=I_p),(I_j!==I_e._uploadCamera||I_k)&&(I_e.uploadCameraUniforms(I_j._shaderValues.data),I_e._uploadCamera=I_j),(I_e._uploadMaterial!==I_o||I_k)&&(I_o._upload(),I_e._uploadMaterial=I_o),I_e._uploadRenderElement,I_f!==I_o?(I_o._setRenderStateFrontFace(!1,I_p.transform),I_f=I_o,I_g=I_p):I_g!==I_p&&(I_o._setRenderStateFrontFace(!1,I_p.transform),I_g=I_p),I_n._render(I_a),I_e._uploadLoopCount=I_h),I_p._postRenderUpdateComponents(I_a))}},I_a._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},I_a._addRenderElement=function(I_a){this._renderElements.push(I_a),this._needSort=!0},I_a._addDynamicBatchElement=function(I_a){this._dynamicBatchCombineRenderElements.push(I_a)},I_o(0,I_a,"id",function(){return this._id}),I_b._uniqueIDCounter=0,I_b._cameraPosition=null,I_b}(),I_Y=function(){function I_a(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return I_n(I_a,"laya.d3.core.render.RenderState"),I_a.clientWidth=0,I_a.clientHeight=0,I_a}(),I_Z=function(){function I_g(I_a,I_b){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new I__a(new I_gb,0),this._corners=[new I_gb,new I_gb,new I_gb,new I_gb,new I_gb,new I_gb,new I_gb,new I_gb],this._boundingBoxCenter=new I_gb,this._children=I_d(8),this._objects=[],this._tempBoundBoxCorners=[new I_gb,new I_gb,new I_gb,new I_gb,new I_gb,new I_gb,new I_gb,new I_gb],this._scene=I_a,this._currentDepth=I_b}I_n(I_g,"laya.d3.core.scene.OctreeNode");var I_a=I_g.prototype;return I_x.imps(I_a,{"laya.d3.core.scene.ITreeNode":!0}),I_a.init=function(I_a,I_b){var I_c=new I_gb,I_d=new I_gb;I_gb.scale(I_b,-.5,I_c),I_gb.scale(I_b,.5,I_d),I_gb.add(I_c,I_a,I_c),I_gb.add(I_d,I_a,I_d),this.exactBox=new I_Za(I_c,I_d),this.relaxBox=new I_Za(I_c,I_d)},I_a.addTreeNode=function(I_a){1===Collision.boxContainsBox(this._relaxBox,I_a.boundingBox)?this.addNodeDown(I_a,0):this.addObject(I_a)},I_a.addChild=function(I_a){var I_b=this._children[I_a];if(null==I_b){I_b=new I_g(this._scene,this._currentDepth+1),(this._children[I_a]=I_b)._parent=this,I_gb.subtract(this._exactBox.max,this._exactBox.min,I_g.tempSize),I_gb.multiply(I_g.tempSize,I_g._octreeSplit[I_a],I_g.tempCenter),I_gb.add(this._exactBox.min,I_g.tempCenter,I_g.tempCenter),I_gb.scale(I_g.tempSize,.25,I_g.tempSize);var I_c=new I_gb,I_d=new I_gb;I_gb.subtract(I_g.tempCenter,I_g.tempSize,I_c),I_gb.add(I_g.tempCenter,I_g.tempSize,I_d),I_b.exactBox=new I_Za(I_c,I_d),I_gb.scale(I_g.tempSize,I_g.relax,I_g.tempSize);var I_e=new I_gb,I_f=new I_gb;I_gb.subtract(I_g.tempCenter,I_g.tempSize,I_e),I_gb.add(I_g.tempCenter,I_g.tempSize,I_f),I_b.relaxBox=new I_Za(I_e,I_f)}return I_b},I_a.addObject=function(I_a){(I_a._treeNode=this)._objects.push(I_a)},I_a.removeObject=function(I_a){if(I_a._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var I_b=this._objects.indexOf(I_a);return-1!==I_b&&(this._objects.splice(I_b,1),!0)},I_a.clearObject=function(){this._objects.length=0},I_a.addNodeUp=function(I_a,I_b){this._parent&&1!==Collision.boxContainsBox(this._exactBox,I_a.boundingBox)?this._parent.addNodeUp(I_a,I_b-1):this.addNodeDown(I_a,I_b)},I_a.addNodeDown=function(I_a,I_b){if(I_b<this._scene.treeLevel){var I_c=this.inChildIndex(I_a.boundingBoxCenter),I_d=this.addChild(I_c);1===Collision.boxContainsBox(I_d._relaxBox,I_a.boundingBox)?I_d.addNodeDown(I_a,++I_b):this.addObject(I_a)}else this.addObject(I_a)},I_a.inChildIndex=function(I_a){return 4*(I_a.z<this._boundingBoxCenter.z?0:1)+2*(I_a.y<this._boundingBoxCenter.y?0:1)+(I_a.x<this._boundingBoxCenter.x?0:1)},I_a.updateObject=function(I_a){1===Collision.boxContainsBox(this._relaxBox,I_a.boundingBox)?(this.removeObject(I_a),I_a._treeNode=null,this.addNodeDown(I_a,this._currentDepth)):this._parent&&(this.removeObject(I_a),I_a._treeNode=null,this._parent.addNodeUp(I_a,this._currentDepth-1))},I_a.cullingObjects=function(I_a,I_b,I_c,I_d,I_e){var I_f,I_g=0,I_h=0,I_i=0,I_j=this._scene._dynamicBatchManager;for(I_g=0,I_f=this._objects.length;I_g<I_f;I_g++){var I_k=this._objects[I_g];if(I_I.isVisible(I_k._owner.layer.mask)&&I_k.enable){if(I_b&&(I_A.treeSpriteCollision+=1,0===I_a.containsBoundSphere(I_k.boundingSphere)))continue;I_k._renderUpdate(I_e),I_k._distanceForSort=I_gb.distance(I_k.boundingSphere.center,I_d)+I_k.sortingFudge;var I_l=I_k._renderElements;for(I_h=0,I_i=I_l.length;I_h<I_i;I_h++){var I_m=I_l[I_h],I_n=I_m._staticBatch;if(I_n&&I_n._material===I_m._material)I_n._addBatchRenderElement(I_m);else{var I_o=I_m.renderObj;I_o.triangleCount<10&&1===I_o._vertexBufferCount&&I_o._getIndexBuffer()&&I_m._material.renderQueue<2&&I_m._canDynamicBatch&&!I_k._owner.isStatic?I_j._addPrepareRenderElement(I_m):this._scene.getRenderQueue(I_m._material.renderQueue)._addRenderElement(I_m)}}}}for(I_g=0;I_g<8;I_g++){var I_p=this._children[I_g];if(null!=I_p){var I_s=I_b;if(I_b){var I_t=I_a.containsBoundBox(I_p._relaxBox);if(I_A.treeNodeCollision+=1,0===I_t)continue;I_s=2===I_t}I_p.cullingObjects(I_a,I_s,I_c,I_d,I_e)}}},I_a.cullingShadowObjects=function(I_a,I_b,I_c,I_d,I_e){var I_f,I_g=0,I_h=0,I_i=0;this._scene._dynamicBatchManager;for(I_g=0,I_f=this._objects.length;I_g<I_f;I_g++){var I_j=this._objects[I_g];if(I_j.castShadow&&I_I.isVisible(I_j._owner.layer.mask)&&I_j.enable){if(I_c&&0===I_a[0].containsBoundSphere(I_j.boundingSphere))continue;for(var I_k=1,I_l=I_a.length;I_k<I_l;I_k++){var I_m=I_b[I_k-1];if(0!==I_a[I_k].containsBoundSphere(I_j.boundingSphere)){var I_n=I_j._renderElements;for(I_h=0,I_i=I_n.length;I_h<I_i;I_h++)I_m._addRenderElement(I_n[I_h])}}}}for(I_g=0;I_g<8;I_g++){var I_o=this._children[I_g];if(null!=I_o){var I_p=I_c;if(I_c){var I_s=I_a[0].containsBoundBox(I_o._relaxBox);if(0===I_s)continue;I_p=2===I_s}I_o.cullingShadowObjects(I_a,I_b,I_p,I_d,I_e)}}},I_a.cullingShadowObjectsOnePSSM=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g,I_h=I_b[0],I_i=0,I_j=0,I_k=0;for(I_i=0,I_g=this._objects.length;I_i<I_g;I_i++){var I_l=this._objects[I_i];if(I_l.castShadow&&I_I.isVisible(I_l._owner.layer.mask)&&I_l.enable){if(I_d&&0===I_a.containsBoundSphere(I_l.boundingSphere))continue;I_l._renderUpdate(I_c);var I_m=I_l._renderElements;for(I_j=0,I_k=I_m.length;I_j<I_k;I_j++)I_h._addRenderElement(I_m[I_j])}}for(I_i=0;I_i<8;I_i++){var I_n=this._children[I_i];if(null!=I_n){var I_o=I_d;if(I_d){var I_p=I_a.containsBoundBox(I_n._relaxBox);if(0===I_p)continue;I_o=2===I_p}I_n.cullingShadowObjectsOnePSSM(I_a,I_b,I_c,I_o,I_e,I_f)}}},I_a.renderBoudingBox=function(I_a){this._renderBoudingBox(I_a);for(var I_b=0;I_b<8;++I_b){var I_c=this._children[I_b];I_c&&I_c.renderBoudingBox(I_a)}},I_a.buildAllChild=function(I_a){if(I_a<this._scene.treeLevel)for(var I_b=0;I_b<8;I_b++){this.addChild(I_b).buildAllChild(I_a+1)}},I_a._renderBoudingBox=function(I_a){},I_o(0,I_a,"exactBox",function(){return this._exactBox},function(I_a){this._exactBox=I_a,I_gb.add(I_a.min,I_a.max,this._boundingBoxCenter),I_gb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),I_o(0,I_a,"relaxBox",function(){return this._relaxBox},function(I_a){(this._relaxBox=I_a).getCorners(this._corners),I__a.createfromPoints(this._corners,this._boundingSphere)}),I_g.debugMode=!1,I_g.relax=1.15,I_g.CHILDNUM=8,I_l(I_g,["tempVector0",function(){return this.tempVector0=new I_gb},"tempSize",function(){return this.tempSize=new I_gb},"tempCenter",function(){return this.tempCenter=new I_gb},"_octreeSplit",function(){return this._octreeSplit=[new I_gb(.25,.25,.25),new I_gb(.75,.25,.25),new I_gb(.25,.75,.25),new I_gb(.75,.75,.25),new I_gb(.25,.25,.75),new I_gb(.75,.25,.75),new I_gb(.25,.75,.75),new I_gb(.75,.75,.75)]}]),I_g}(),I_$=(function(){function I_a(){}I_n(I_a,"laya.d3.core.scene.SceneManager")}(),function(){function I_a(I_a,I_b,I_c,I_d){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===I_a&&(I_a=1),void 0===I_b&&(I_b=1),void 0===I_c&&(I_c=1),void 0===I_d&&(I_d=1),this._r=I_a,this._g=I_b,this._b=I_c,this._a=I_d}return I_n(I_a,"laya.d3.core.trail.module.Color",null,"Color$1"),I_a.prototype.cloneTo=function(I_a){I_a._r=this._r,I_a._g=this._g,I_a._b=this._b,I_a._a=this._a},I_l(I_a,["RED",function(){return this.RED=new I_a(1,0,0,1)},"GREEN",function(){return this.GREEN=new I_a(0,1,0,1)},"BLUE",function(){return this.BLUE=new I_a(0,0,1,1)},"CYAN",function(){return this.CYAN=new I_a(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new I_a(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new I_a(1,0,1,1)},"GRAY",function(){return this.GRAY=new I_a(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new I_a(1,1,1,1)},"BLACK",function(){return this.BLACK=new I_a(0,0,0,1)}]),I_a}()),I__=(function(){function I_a(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}I_n(I_a,"laya.d3.core.trail.module.Gradient");var I_b=I_a.prototype;I_b.setKeys=function(I_a,I_b){var I_c,I_d;this._colorKeys=I_a;for(var I_e=this.index=0;I_e<I_a.length;I_e++){var I_f=(I_c=I_a[I_e]).color;this._colorKeyData[this.index++]=I_f._r,this._colorKeyData[this.index++]=I_f._g,this._colorKeyData[this.index++]=I_f._b,this._colorKeyData[this.index++]=I_c.time}this._alphaKeys=I_b;for(var I_g=this.index=0;I_g<I_b.length;I_g++)I_d=I_b[I_g],this._alphaKeyData[this.index++]=I_d.alpha,this._alphaKeyData[this.index++]=I_d.time},I_b.cloneTo=function(I_a){var I_b=0,I_c=0,I_d=this.colorKeys,I_e=[];for(I_b=0,I_c=I_d.length;I_b<I_c;I_b++){var I_f=new I_q;I_d[I_b].cloneTo(I_f),I_e.push(I_f)}var I_g=this.alphaKeys,I_h=[];for(I_b=0,I_c=I_g.length;I_b<I_c;I_b++){var I_i=new I__;I_g[I_b].cloneTo(I_i),I_h.push(I_i)}I_a.setKeys(I_e,I_h)},I_o(0,I_b,"mode",function(){return this._mode},function(I_a){this._mode=I_a}),I_o(0,I_b,"colorKeys",function(){return this._colorKeys},function(I_a){this._colorKeys=I_a;for(var I_b=this.index=0;I_b<I_a.length;I_b++){var I_c=I_a[I_b],I_d=I_c.color;this._colorKeyData[this.index++]=I_d._r,this._colorKeyData[this.index++]=I_d._g,this._colorKeyData[this.index++]=I_d._b,this._colorKeyData[this.index++]=I_c.time}}),I_o(0,I_b,"alphaKeys",function(){return this._alphaKeys},function(I_a){this._alphaKeys=I_a;for(var I_b=this.index=0;I_b<I_a.length;I_b++){var I_c=I_a[I_b];this._alphaKeyData[this.index++]=I_c.alpha,this._alphaKeyData[this.index++]=I_c.time}})}(),function(){function I_a(I_a,I_b){this._alpha=NaN,this._time=NaN,void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),this._alpha=I_a,this._time=I_b}I_n(I_a,"laya.d3.core.trail.module.GradientAlphaKey");var I_b=I_a.prototype;return I_b.cloneTo=function(I_a){I_a.alpha=this.alpha,I_a.time=this.time},I_o(0,I_b,"alpha",function(){return this._alpha},function(I_a){this._alpha=I_a}),I_o(0,I_b,"time",function(){return this._time},function(I_a){this._time=I_a}),I_a}()),I_q=function(){function I_a(I_a,I_b){this._color=null,this._time=NaN,void 0===I_b&&(I_b=0),this._color=I_a||new I_$,this._time=I_b}I_n(I_a,"laya.d3.core.trail.module.GradientColorKey");var I_b=I_a.prototype;return I_b.cloneTo=function(I_a){this.color.cloneTo(I_a.color),I_a.time=this.time},I_o(0,I_b,"color",function(){return this._color},function(I_a){this._color=I_a}),I_o(0,I_b,"time",function(){return this._time},function(I_a){this._time=I_a}),I_a}(),I_r=(function(){function I_a(){}I_n(I_a,"laya.d3.core.trail.module.GradientMode"),I_a.Blend=0,I_a.Fixed=1}(),function(){function I_a(){}I_n(I_a,"laya.d3.core.trail.module.TextureMode"),I_a.Stretch=0,I_a.Tile=1}(),function(){function I_a(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}I_n(I_a,"laya.d3.core.trail.module.TrailKeyFrame"),I_a.prototype.cloneTo=function(I_a){I_a.time=this.time,I_a.inTangent=this.inTangent,I_a.outTangent=this.outTangent,I_a.value=this.value}}(),function(){function I_b(I_a){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new I_gb,this._curPosition=new I_gb,this._delVector3=new I_gb,this._lastFixedVertexPosition=new I_gb,this._pointAtoBVector3=new I_gb,this._pointA=new I_gb,this._pointB=new I_gb,this._owner=I_a,this._id=I_b.renderElementCount++,0==this._id?I_a._owner.transform.position.cloneTo(this._lastPosition):I_a._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new I_Ob(I_r.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new I_Ob(I_r.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}I_n(I_b,"laya.d3.core.trail.TrailRenderElement");var I_a=I_b.prototype;I_x.imps(I_a,{"laya.d3.core.render.IRenderable":!0}),I_a._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},I_a._addTrailByFirstPosition=function(I_a,I_b){I_gb.subtract(I_b,I_a,this._delVector3),I_gb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),I_gb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),I_gb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(I_a),I_a.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},I_a._addTrailByNextPosition=function(I_a){I_gb.subtract(I_a,this._lastFixedVertexPosition,this._delVector3),I_gb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),I_gb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),I_gb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=I_gb.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=I_qa.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(I_a),I_a.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(I_a),this._virtualVerticesCount=2)},I_a._updateVerticesByPosition=function(I_a){this._pointe=I_a.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},I_a._updateVertexBuffer2=function(){var I_a,I_b=0,I_c=0,I_d=0;for(I_d=0,I_a=(this._verticesCount+this._virtualVerticesCount)/2;I_d<I_a;I_d++)I_c=0==this._owner.textureMode?(this._VerticesToTailLength[I_d]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[I_d],this._vertices2[I_b++]=1-I_c,this._vertices2[I_b++]=1-I_c;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},I_a._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},I_a._updateDisappear=function(){var I_a,I_b=0;for(I_b=this._curDisappearIndex,I_a=(this._verticesCount+this._virtualVerticesCount)/2;I_b<I_a;I_b++)this._owner._curtime-this._everyGroupVertexBirthTime[I_b]>=this._owner.time+I_qa.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},I_a._beforeRender=function(I_a){return this._camera=I_a.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),I_gb.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},I_a._render=function(I_a){this._isDead||(I_F.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),I_A.drawCall++,I_A.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},I_a._getVertexBuffer=function(I_a){return void 0===I_a&&(I_a=0),0===I_a?this._vertexBuffer1:1===I_a?this._vertexBuffer2:null},I_a._getVertexBuffers=function(){return this._vertexBuffers},I_a._getIndexBuffer=function(){return null},I_a.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},I_a._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},I_o(0,I_a,"_vertexBufferCount",function(){return this._vertexBuffers.length}),I_o(0,I_a,"triangleCount",function(){return 0}),I_b.renderElementCount=0}(),function(){function I_a(){}I_n(I_a,"laya.d3.core.trail.VertexTrail");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration1}),I_o(1,I_a,"vertexDeclaration1",function(){return I_a._vertexDeclaration1}),I_o(1,I_a,"vertexDeclaration2",function(){return I_a._vertexDeclaration2}),I_l(I_a,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new I_fa(32,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",41),new I_ga(24,"single",33),new I_ga(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new I_fa(4,[new I_ga(0,"single",38)])}]),I_a}()),I_aa=function(){function I_w(I_a){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=I_a}I_n(I_w,"laya.d3.graphics.DynamicBatch");var I_a=I_w.prototype;return I_x.imps(I_a,{"laya.d3.core.render.IRenderable":!0}),I_a._getVertexBuffer=function(I_a){return void 0===I_a&&(I_a=0),0===I_a?this._vertexBuffer:null},I_a._getIndexBuffer=function(){return this._indexBuffer},I_a._getCombineRenderElementFromPool=function(I_a,I_b,I_c){var I_d=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return I_d||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=I_d=new I_W,I_d._sprite3D=new I_Xb),I_d._sprite3D._render._renderUpdate(I_c),I_d},I_a._getRenderElement=function(I_a,I_b,I_c){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*I_w.maxVertexCount),this._indexDatas=new Uint16Array(I_w.maxIndexCount),this._vertexBuffer=I_Ob.create(this._vertexDeclaration,I_w.maxVertexCount,35048),this._indexBuffer=I_Nb.create("ushort",I_w.maxIndexCount,35048));for(var I_d=this._merageElements.length=0,I_e=0,I_f=0,I_g=this._combineRenderElements.length;I_f<I_g;I_f++){var I_h=this._combineRenderElements[I_f],I_i=I_h.getDynamicBatchBakedVertexs(0),I_j=I_h.getBakedIndices(),I_k=I_h._sprite3D.transform._isFrontFaceInvert,I_l=I_d/(this._vertexDeclaration.vertexStride/4),I_m=I_e,I_n=I_m+I_j.length;I_h._tempBatchIndexStart=I_m,I_h._tempBatchIndexEnd=I_n,this._indexDatas.set(I_j,I_e);var I_o=0;if(I_k)for(I_o=I_m;I_o<I_n;I_o+=3){this._indexDatas[I_o]=I_l+this._indexDatas[I_o];var I_p=this._indexDatas[I_o+1],I_s=this._indexDatas[I_o+2];this._indexDatas[I_o+1]=I_l+I_s,this._indexDatas[I_o+2]=I_l+I_p}else for(I_o=I_m;I_o<I_n;I_o+=3)this._indexDatas[I_o]=I_l+this._indexDatas[I_o],this._indexDatas[I_o+1]=I_l+this._indexDatas[I_o+1],this._indexDatas[I_o+2]=I_l+this._indexDatas[I_o+2];I_e+=I_j.length,this._vertexDatas.set(I_i,I_d),I_d+=I_i.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),I_f=this._combineRenderElementPoolIndex=0,I_g=this._materials.length;I_f<I_g;I_f++){var I_t=this._getCombineRenderElementFromPool(I_a,I_b,I_c);I_t._type=2,I_t._staticBatch=null;var I_u=(I_t.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[I_f]]._tempBatchIndexStart,I_v=I_f+1===this._materialToRenderElementsOffsets.length?I_e:this._combineRenderElements[this._materialToRenderElementsOffsets[I_f+1]]._tempBatchIndexStart;I_t._tempBatchIndexStart=I_u,I_t._tempBatchIndexEnd=I_v,I_t._material=this._materials[I_f],this._merageElements.push(I_t)}},I_a._addCombineRenderObjTest=function(I_a){var I_b=I_a.renderObj,I_c=this._currentCombineIndexCount+I_b._getIndexBuffer().indexCount,I_d=this._currentCombineVertexCount+I_b._getVertexBuffer().vertexCount;return!(I_w.maxVertexCount<I_d||I_w.maxIndexCount<I_c)},I_a._addCombineRenderObj=function(I_a){var I_b=I_a.renderObj;this._combineRenderElements.push(I_a),this._currentCombineIndexCount=this._currentCombineIndexCount+I_b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+I_b._getVertexBuffer().vertexCount},I_a._addCombineMaterial=function(I_a){this._materials.push(I_a)},I_a._addMaterialToRenderElementOffset=function(I_a){this._materialToRenderElementsOffsets.push(I_a)},I_a._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},I_a._addToRenderQueue=function(I_a,I_b,I_c,I_d){this._getRenderElement(I_b,I_c,I_d);for(var I_e=0,I_f=this._materials.length;I_e<I_f;I_e++)I_a.getRenderQueue(this._materials[I_e].renderQueue)._addDynamicBatchElement(this._merageElements[I_e])},I_a._beforeRender=function(I_a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},I_a._render=function(I_a){var I_b=I_a._batchIndexEnd-I_a._batchIndexStart;I_F.mainContext.drawElements(4,I_b,5123,2*I_a._batchIndexStart),I_A.drawCall++,I_A.trianglesFaces+=I_b/3},I_a._getVertexBuffers=function(){return null},I_o(0,I_a,"_vertexBufferCount",function(){return 1}),I_o(0,I_a,"triangleCount",function(){return this._indexBuffer.indexCount/3}),I_o(0,I_a,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),I_w.maxVertexCount=2e4,I_w.maxIndexCount=4e4,I_w.maxCombineTriangleCount=10,I_w}(),I_ba=function(){function I_w(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}I_n(I_w,"laya.d3.graphics.DynamicBatchManager");var I_a=I_w.prototype;return I_a.getDynamicBatch=function(I_a,I_b){var I_c,I_d=I_a.id.toString()+I_b;return this._dynamicBatches[I_d]?I_c=this._dynamicBatches[I_d]:this._dynamicBatches[I_d]=I_c=new I_aa(I_a),I_c},I_a._garbageCollection=function(){for(var I_a in this._dynamicBatches)0===this._dynamicBatches[I_a].combineRenderElementsCount&&delete this._dynamicBatches[I_a]},I_a._addPrepareRenderElement=function(I_a){this._prepareDynamicBatchCombineElements.push(I_a)},I_a._finishCombineDynamicBatch=function(I_a){var I_b,I_c,I_d;this._prepareDynamicBatchCombineElements.sort(I_w._sortPrepareDynamicBatch);for(var I_e,I_f,I_g,I_h,I_i,I_j=-1,I_k=!0,I_l=0,I_m=-1,I_n=0,I_o=this._prepareDynamicBatchCombineElements.length;I_n<I_o;I_n++){var I_p=(I_f=this._prepareDynamicBatchCombineElements[I_n]).renderObj._getVertexBuffer(0).vertexDeclaration,I_s=I_c!==I_p;I_s&&(I_l=0,I_c=I_p);var I_t=I_l!==I_j;if(I_t&&(I_j=I_l),(I_s||I_t)&&(I_g=this.getDynamicBatch(I_p,I_l),I_b=null),I_k)if(I_g._addCombineRenderObjTest(I_f)){if(I_b!==(I_e=I_f._material))I_h&&(I_a.getRenderQueue(I_i._material.renderQueue)._addRenderElement(I_i),I_i=I_h=null,I_m=-1),I_h=I_e,I_m=I_g.combineRenderElementsCount,I_i=I_f,I_b=I_e;else if(I_h){var I_u=I_i.renderObj,I_v=I_f.renderObj;I_u._getVertexBuffer().vertexCount+I_v._getVertexBuffer().vertexCount>I_aa.maxVertexCount||I_u._getIndexBuffer().indexCount+I_v._getIndexBuffer().indexCount>I_aa.maxIndexCount?(I_a.getRenderQueue(I_i._material.renderQueue)._addRenderElement(I_i),I_h=I_e,I_m=I_g.combineRenderElementsCount,I_i=I_f):(I_g._addCombineMaterial(I_h),I_g._addMaterialToRenderElementOffset(I_m),I_g._addCombineRenderObj(I_i),I_i=I_h=null,I_m=-1,I_g._addCombineRenderObj(I_f))}else I_g._addCombineRenderObj(I_f);I_k=!0}else I_h&&(I_a.getRenderQueue(I_i._material.renderQueue)._addRenderElement(I_i),I_i=I_h=null,I_m=-1),I_l++,I_k=!1;else I_d=this._prepareDynamicBatchCombineElements[I_n-1],I_g._addMaterialToRenderElementOffset(I_g.combineRenderElementsCount),I_b=I_d._material,I_g._addCombineMaterial(I_b),I_g._addCombineRenderObj(I_d),I_k=!0,I_b!==(I_e=I_f._material)?(I_h=I_e,I_m=I_g.combineRenderElementsCount,I_i=I_f):I_g._addCombineRenderObj(I_f),I_b=I_e}I_h&&(I_a.getRenderQueue(I_i._material.renderQueue)._addRenderElement(I_i),I_i=I_h=null,I_m=-1),this._prepareDynamicBatchCombineElements.length=0},I_a._clearRenderElements=function(){for(var I_a in this._dynamicBatches)this._dynamicBatches[I_a]._clearRenderElements()},I_a._addToRenderQueue=function(I_a,I_b,I_c,I_d){for(var I_e in this._dynamicBatches){var I_f=this._dynamicBatches[I_e];0<I_f.combineRenderElementsCount&&I_f._addToRenderQueue(I_a,I_b,I_c,I_d)}},I_a.dispose=function(){this._dynamicBatches=null},I_w._sortPrepareDynamicBatch=function(I_a,I_b){return I_a._mainSortID-I_b._mainSortID},I_w}(),I_ca=function(){function I_a(){}return I_n(I_a,"laya.d3.graphics.FrustumCulling"),I_a.renderShadowObjectCulling=function(I_a,I_b,I_c,I_d,I_e){var I_f=0,I_g=0,I_h=0,I_i=0;for(I_f=0,I_h=I_c.length;I_f<I_h;I_f++){var I_j=I_c[I_f];I_j&&I_j._clearRenderElements()}var I_k,I_l,I_m,I_n=I_a._cullingRenders;if(1<I_e){for(I_f=0,I_h=I_a._cullingRendersLength;I_f<I_h;I_f++)if((I_k=I_n[I_f]).castShadow&&I_I.isVisible(I_k._owner.layer.mask)&&I_k.enable)for(var I_o=1,I_p=I_b.length;I_o<I_p;I_o++)if(I_l=I_c[I_o-1],0!==I_b[I_o].containsBoundSphere(I_k.boundingSphere))for(I_g=0,I_i=(I_m=I_k._renderElements).length;I_g<I_i;I_g++)I_l._addRenderElement(I_m[I_g])}else for(I_f=0,I_h=I_a._cullingRendersLength;I_f<I_h;I_f++)if((I_k=I_n[I_f]).castShadow&&I_I.isVisible(I_k._owner.layer.mask)&&I_k.enable&&0!==I_b[0].containsBoundSphere(I_k.boundingSphere))for(I_k._renderUpdate(I_d),I_l=I_c[0],I_g=0,I_i=(I_m=I_k._renderElements).length;I_g<I_i;I_g++)I_l._addRenderElement(I_m[I_g])},I_a.renderShadowObjectCullingOctree=function(I_a,I_b,I_c,I_d,I_e){for(var I_f=0,I_g=I_c.length;I_f<I_g;I_f++){var I_h=I_c[I_f];I_h&&I_h._clearRenderElements()}1<I_e?I_a.treeRoot.cullingShadowObjects(I_b,I_c,!0,0,I_a):I_a.treeRoot.cullingShadowObjectsOnePSSM(I_b[0],I_c,I_d,!0,0,I_a)},I_a.renderObjectCulling=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=0,I_h=0,I_i=0,I_j=0,I_k=I_b._quenes,I_l=I_b._dynamicBatchManager,I_m=I_b._cullingRenders;for(I_g=0,I_h=I_k.length;I_g<I_h;I_g++){var I_n=I_k[I_g];I_n&&I_n._clearRenderElements()}var I_o=I_da._staticBatchManagers;for(I_g=0,I_h=I_o.length;I_g<I_h;I_g++)I_o[I_g]._clearRenderElements();I_l._clearRenderElements();var I_p=I_c.transform.position;for(I_g=0,I_h=I_b._cullingRendersLength;I_g<I_h;I_g++){var I_s=I_m[I_g];if(I_I.isVisible(I_s._owner.layer.mask)&&I_s.enable&&0!==I_a.containsBoundSphere(I_s.boundingSphere)&&I_s._renderUpdate(I_f)){I_s._distanceForSort=I_gb.distance(I_s.boundingSphere.center,I_p)+I_s.sortingFudge;var I_t=I_s._renderElements;for(I_i=0,I_j=I_t.length;I_i<I_j;I_i++){var I_u=I_t[I_i],I_v=I_u._staticBatch;if(I_v&&I_v._material===I_u._material)I_v._addBatchRenderElement(I_u);else{var I_w=I_u.renderObj;I_w.triangleCount<10&&1===I_w._vertexBufferCount&&I_w._getIndexBuffer()&&I_u._material.renderQueue<2&&I_u._canDynamicBatch&&!I_s._owner.isStatic?I_l._addPrepareRenderElement(I_u):I_b.getRenderQueue(I_u._material.renderQueue)._addRenderElement(I_u)}}}}for(I_g=0,I_h=I_o.length;I_g<I_h;I_g++)I_o[I_g]._addToRenderQueue(I_b,I_d,I_e,I_f);I_l._finishCombineDynamicBatch(I_b),I_l._addToRenderQueue(I_b,I_d,I_e,I_f)},I_a.renderObjectCullingOctree=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=0,I_h=0,I_i=I_b._quenes,I_j=I_b._dynamicBatchManager;for(I_g=0,I_h=I_i.length;I_g<I_h;I_g++){var I_k=I_i[I_g];I_k&&I_k._clearRenderElements()}var I_l=I_da._staticBatchManagers;for(I_g=0,I_h=I_l.length;I_g<I_h;I_g++)I_l[I_g]._clearRenderElements();for(I_j._clearRenderElements(),I_b._cullingRenders.length=0,I_b.treeRoot.cullingObjects(I_a,!0,0,I_c.transform.position,I_f),I_g=0,I_h=I_l.length;I_g<I_h;I_g++)I_l[I_g]._addToRenderQueue(I_b,I_d,I_e,I_f);I_j._finishCombineDynamicBatch(I_b),I_j._addToRenderQueue(I_b,I_d,I_e,I_f)},I_a.renderObjectCullingNoBoundFrustum=function(I_a,I_b,I_c,I_d,I_e){var I_f=0,I_g=0,I_h=0,I_i=0,I_j=I_a._quenes,I_k=I_a._dynamicBatchManager,I_l=I_a._cullingRenders;for(I_f=0,I_g=I_j.length;I_f<I_g;I_f++){var I_m=I_j[I_f];I_m&&I_m._clearRenderElements()}var I_n=I_da._staticBatchManagers;for(I_f=0,I_g=I_n.length;I_f<I_g;I_f++)I_n[I_f]._clearRenderElements();I_k._clearRenderElements();var I_o=I_b.transform.position;for(I_f=0,I_g=I_a._cullingRendersLength;I_f<I_g;I_f++){var I_p=I_l[I_f];if(I_I.isVisible(I_p._owner.layer.mask)&&I_p.enable){I_p._renderUpdate(I_e),I_p._distanceForSort=I_gb.distance(I_p.boundingSphere.center,I_o)+I_p.sortingFudge;var I_s=I_p._renderElements;for(I_h=0,I_i=I_s.length;I_h<I_i;I_h++){var I_t=I_s[I_h],I_u=I_t._staticBatch;if(I_u&&I_u._material===I_t._material)I_u._addBatchRenderElement(I_t);else{var I_v=I_t.renderObj;I_v.triangleCount<10&&1===I_v._vertexBufferCount&&I_v._getIndexBuffer()&&I_t._material.renderQueue<2&&I_t._canDynamicBatch&&!I_p._owner.isStatic?I_k._addPrepareRenderElement(I_t):I_a.getRenderQueue(I_t._material.renderQueue)._addRenderElement(I_t)}}}}for(I_f=0,I_g=I_n.length;I_f<I_g;I_f++)I_n[I_f]._addToRenderQueue(I_a,I_c,I_d,I_e);I_k._finishCombineDynamicBatch(I_a),I_k._addToRenderQueue(I_a,I_c,I_d,I_e)},I_a}(),I_da=function(){function I_f(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}I_n(I_f,"laya.d3.graphics.StaticBatchManager");var I_a=I_f.prototype;return I_a._finishInit=function(){for(var I_a in this._staticBatches)this._staticBatches[I_a]._finishInit();this._initBatchRenderElements.length=0},I_a._initStaticBatchs=function(I_a){throw new Error("StaticBatchManager:must override this function.")},I_a._addInitBatchSprite=function(I_a){for(var I_b=I_a._render._renderElements,I_c=0,I_d=I_b.length;I_c<I_d;I_c++)this._initBatchRenderElements.push(I_b[I_c])},I_a._clearRenderElements=function(){for(var I_a in this._staticBatches)this._staticBatches[I_a]._clearRenderElements()},I_a._garbageCollection=function(I_a){var I_b=I_a._staticBatch,I_c=I_b._initBatchRenderElements,I_d=I_c.indexOf(I_a);I_c.splice(I_d,1),0===I_c.length&&(I_b.dispose(),delete this._staticBatches[I_b._key])},I_a._addToRenderQueue=function(I_a,I_b,I_c,I_d){for(var I_e in this._staticBatches){var I_f=this._staticBatches[I_e];0<I_f._batchRenderElements.length&&I_f._updateToRenderQueue(I_a,I_d)}},I_a.dispose=function(){this._staticBatches=null},I_f._addToStaticBatchQueue=function(I_a){I_a instanceof laya.d3.core.RenderableSprite3D&&I_a._addToInitStaticBatchManager();for(var I_b=0,I_c=I_a.numChildren;I_b<I_c;I_b++)I_f._addToStaticBatchQueue(I_a._childs[I_b])},I_f.combine=function(I_a,I_b){var I_c,I_d=0,I_e=0;if(I_b)for(I_d=0,I_e=I_b.length;I_d<I_e;I_d++){I_b[I_d]._addToInitStaticBatchManager()}else I_a&&I_f._addToStaticBatchQueue(I_a);for(I_d=0,I_e=I_f._staticBatchManagers.length;I_d<I_e;I_d++)(I_c=I_f._staticBatchManagers[I_d])._initStaticBatchs(I_a),I_c._finishInit()},I_f._staticBatchManagers=[],I_f}(),I_ea=function(){function I_a(I_a,I_b,I_c){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=I_a,this._manager=I_b,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=I_c}I_n(I_a,"laya.d3.graphics.StaticBatch");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),I_b._binarySearch=function(I_a){for(var I_b=0,I_c=this._batchRenderElements.length-1,I_d=0;I_b<=I_c;)I_d=Math.floor((I_b+I_c)/2),this._compareBatchRenderElement(this._batchRenderElements[I_d],I_a)?I_c=I_d-1:I_b=I_d+1;return I_b},I_b._compareBatchRenderElement=function(I_a,I_b){throw new Error("StaticBatch:must override this function.")},I_b._getVertexDecLightMap=function(I_a){return I_a===I_Na.vertexDeclaration?I_Ia.vertexDeclaration:I_a===I_Ma.vertexDeclaration?I_Ha.vertexDeclaration:I_a===I_Ba.vertexDeclaration?I_wa.vertexDeclaration:I_a===I_Ra.vertexDeclaration?null:I_a===I_pa.vertexDeclaration?I_sa.vertexDeclaration:I_a===I_Pa.vertexDeclaration?I_Ka.vertexDeclaration:I_a===I_Fa.vertexDeclaration?I_Ga.vertexDeclaration:I_a===I_Oa.vertexDeclaration?I_Ja.vertexDeclaration:I_a===I_Ma.vertexDeclaration?I_Ha.vertexDeclaration:I_a===I_Ca.vertexDeclaration?I_xa.vertexDeclaration:I_a===I_Ra.vertexDeclaration?null:I_a===I_pa.vertexDeclaration?I_sa.vertexDeclaration:I_a===I_Qa.vertexDeclaration?I_La.vertexDeclaration:I_a===I_Fa.vertexDeclaration?I_Ga.vertexDeclaration:I_a},I_b._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},I_b._addBatchRenderElement=function(I_a){this._batchRenderElements.splice(this._binarySearch(I_a),0,I_a)},I_b._updateToRenderQueue=function(I_a,I_b){this._combineRenderElementPoolIndex=0,this._getRenderElement(I_a.getRenderQueue(this._material.renderQueue)._renderElements,I_a,I_b)},I_b._getRenderElement=function(I_a,I_b,I_c){throw new Error("StaticBatch:must override this function.")},I_b._finishInit=function(){throw new Error("StaticBatch:must override this function.")},I_b._clearRenderElements=function(){this._batchRenderElements.length=0},I_b.dispose=function(){},I_b._getVertexBuffer=function(I_a){return void 0===I_a&&(I_a=0),null},I_b._getIndexBuffer=function(){return null},I_b._beforeRender=function(I_a){return!0},I_b._render=function(I_a){},I_b._getVertexBuffers=function(){return null},I_o(0,I_b,"_vertexBufferCount",function(){return 1}),I_o(0,I_b,"triangleCount",function(){return 0}),I_a.combine=function(I_a){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),I_da.combine(I_a)},I_a.maxBatchVertexCount=65535,I_a}(),I_fa=function(){function I_g(I_a,I_b){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++I_g._uniqueIDCounter,this._id>I_g.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",I_g.maxVertexDeclaration);this._shaderValues=new I_mb,this._vertexElementsDic={},this._vertexStride=I_a,this._vertexElements=I_b;for(var I_c=0;I_c<I_b.length;I_c++){var I_d=I_b[I_c],I_e=I_d.elementUsage;this._vertexElementsDic[I_e]=I_d;var I_f=[I_g._getTypeSize(I_d.elementFormat)/4,5126,!1,this._vertexStride,I_d.offset];switch(this._shaderValues.setValue(I_e,I_f),I_e){case 1:this._addShaderDefine(I_Ab.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(I_Ab.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(I_Ab.SHADERDEFINE_UV1)}}}I_n(I_g,"laya.d3.graphics.VertexDeclaration");var I_a=I_g.prototype;return I_a._addShaderDefine=function(I_a){this._shaderDefineValue|=I_a},I_a._removeShaderDefine=function(I_a){this._shaderDefineValue&=~I_a},I_a.getVertexElements=function(){return this._vertexElements.slice()},I_a.getVertexElementByUsage=function(I_a){return this._vertexElementsDic[I_a]},I_a.unBinding=function(){},I_o(0,I_a,"shaderDefineValue",function(){return this._shaderDefineValue}),I_o(0,I_a,"id",function(){return this._id}),I_o(0,I_a,"vertexStride",function(){return this._vertexStride}),I_o(0,I_a,"shaderValues",function(){return this._shaderValues}),I_g._getTypeSize=function(I_a){switch(I_a){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},I_g.getVertexStride=function(I_a){for(var I_b=0,I_c=0;I_c<I_a.Length;I_c++){var I_d=I_a[I_c],I_e=I_d.offset+I_g._getTypeSize(I_d.elementFormat);I_b<I_e&&(I_b=I_e)}return I_b},I_g._maxVertexDeclarationBit=1e3,I_g._uniqueIDCounter=1,I_l(I_g,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),I_g}(),I_ga=function(){function I_a(I_a,I_b,I_c){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=I_a,this.elementFormat=I_b,this.elementUsage=I_c}return I_n(I_a,"laya.d3.graphics.VertexElement"),I_a}(),I_ha=(function(){function I_a(){}I_n(I_a,"laya.d3.graphics.VertexElementFormat"),I_a.Single="single",I_a.Vector2="vector2",I_a.Vector3="vector3",I_a.Vector4="vector4",I_a.Color="color",I_a.Byte4="byte4",I_a.Short2="short2",I_a.Short4="short4",I_a.NormalizedShort2="normalizedshort2",I_a.NormalizedShort4="normalizedshort4",I_a.HalfVector2="halfvector2",I_a.HalfVector4="halfvector4"}(),function(){function I_a(){}I_n(I_a,"laya.d3.graphics.VertexElementUsage"),I_a.POSITION0=0,I_a.COLOR0=1,I_a.TEXTURECOORDINATE0=2,I_a.NORMAL0=3,I_a.BINORMAL0=4,I_a.TANGENT0=5,I_a.BLENDINDICES0=6,I_a.BLENDWEIGHT0=7,I_a.DEPTH0=8,I_a.FOG0=9,I_a.POINTSIZE0=10,I_a.SAMPLE0=11,I_a.TESSELLATEFACTOR0=12,I_a.COLOR1=13,I_a.NEXTTEXTURECOORDINATE0=14,I_a.TEXTURECOORDINATE1=15,I_a.NEXTTEXTURECOORDINATE1=16,I_a.CORNERTEXTURECOORDINATE0=17,I_a.VELOCITY0=18,I_a.STARTCOLOR0=19,I_a.STARTSIZE=20,I_a.AGEADDSCALE0=21,I_a.STARTROTATION=22,I_a.ENDCOLOR0=23,I_a.STARTLIFETIME=24,I_a.TIME0=33,I_a.SHAPEPOSITIONSTARTLIFETIME=30,I_a.DIRECTIONTIME=32,I_a.SIZEROTATION0=27,I_a.RADIUS0=28,I_a.RADIAN0=29,I_a.STARTSPEED=31,I_a.RANDOM0=34,I_a.RANDOM1=35,I_a.SIMULATIONWORLDPOSTION=36,I_a.SIMULATIONWORLDROTATION=37,I_a.TEXTURECOORDINATE0X=38,I_a.TEXTURECOORDINATE0X1=39,I_a.TEXTURECOORDINATE0Y=40,I_a.OFFSETVECTOR=41}(),function(){function I_a(I_a,I_b,I_c){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=I_a,this._textureCoordinate0=I_b,this._time=I_c}I_n(I_a,"laya.d3.graphics.VertexGlitter");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate0}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"time",function(){return this._time}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(24,[new I_ga(0,"vector3",0),new I_ga(12,"vector2",2),new I_ga(20,"single",33)])}])}(),function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=I_a,this._position=I_b,this._velocity=I_c,this._startColor=I_d,this._endColor=I_e,this._sizeRotation=I_f,this._radius=I_g,this._radian=I_h,this._ageAddScale=I_i,this._time=I_j}I_n(I_a,"laya.d3.graphics.VertexParticle");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"endColor",function(){return this._endColor}),I_o(0,I_b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),I_o(0,I_b,"sizeRotation",function(){return this._sizeRotation}),I_o(0,I_b,"velocity",function(){return this._velocity}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"startColor",function(){return this._startColor}),I_o(0,I_b,"radius",function(){return this._radius}),I_o(0,I_b,"radian",function(){return this._radian}),I_o(0,I_b,"ageAddScale",function(){return this._ageAddScale}),I_o(0,I_b,"time",function(){return this._time}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(116,[new I_ga(0,"vector4",17),new I_ga(16,"vector3",0),new I_ga(28,"vector3",18),new I_ga(40,"vector4",19),new I_ga(56,"vector4",23),new I_ga(72,"vector3",27),new I_ga(84,"vector2",28),new I_ga(92,"vector4",29),new I_ga(108,"single",24),new I_ga(112,"single",33)])}])}(),function(){function I_a(I_a){this._position=null,this._position=I_a}I_n(I_a,"laya.d3.graphics.VertexPosition");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(12,[new I_ga(0,"vector3",0)])}]),I_a}()),I_ia=function(){function I_a(I_a,I_b){this._position=null,this._normal=null,this._position=I_a,this._normal=I_b}I_n(I_a,"laya.d3.graphics.VertexPositionNormal");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(24,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3)])}]),I_a}(),I_ja=function(){function I_a(I_a,I_b,I_c){this._position=null,this._normal=null,this._color=null,this._position=I_a,this._normal=I_b,this._color=I_c}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColor");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(40,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1)])}]),I_a}(),I_ka=function(){function I_a(I_a,I_b,I_c,I_d,I_e){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._blendIndex=I_d,this._blendWeight=I_e}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorSkin");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(72,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector4",7),new I_ga(56,"vector4",6)])}]),I_a}(),I_la=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._tangent=I_d,this._blendIndex=I_e,this._blendWeight=I_f}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(88,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector4",7),new I_ga(56,"vector4",6),new I_ga(72,"vector4",5)])}]),I_a}(),I_ma=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._tangent=I_d,this._blendIndex=I_e,this._blendWeight=I_f}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(84,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector4",7),new I_ga(56,"vector4",6),new I_ga(72,"vector3",5)])}]),I_a}(),I_na=function(){function I_a(I_a,I_b,I_c,I_d){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._tangent=I_d}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorSTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(56,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector4",5)])}]),I_a}(),I_oa=function(){function I_a(I_a,I_b,I_c,I_d){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._tangent=I_d}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(52,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector3",5)])}]),I_a}(),I_pa=function(){function I_a(I_a,I_b,I_c,I_d){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._textureCoordinate=I_d}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTexture");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(48,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector2",2)])}]),I_a}(),I_sa=function(){function I_a(I_a,I_b,I_c,I_d,I_e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._textureCoordinate0=I_d,this._textureCoordinate1=I_e}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(56,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector2",2),new I_ga(48,"vector2",15)])}]),I_a}(),I_ta=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._textureCoordinate0=I_d,this._textureCoordinate1=I_e,this._blendIndex=I_f,this._blendWeight=I_g}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(88,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector2",2),new I_ga(48,"vector2",15),new I_ga(56,"vector4",7),new I_ga(72,"vector4",6)])}]),I_a}(),I_ua=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._textureCoordinate0=I_d,this._textureCoordinate1=I_e,this._tangent=I_f,this._blendIndex=I_g,this._blendWeight=I_h}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(104,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector2",2),new I_ga(48,"vector2",15),new I_ga(56,"vector4",7),new I_ga(72,"vector4",6),new I_ga(88,"vector4",5)])}]),I_a}(),I_va=function(){function I_a(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_b.VertexPositionNormalColorTexture0SkinTangent=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){this._position=I_a,this._normal=I_b,this._color=I_c,this._textureCoordinate0=I_d,this._textureCoordinate1=I_e,this._tangent=I_f,this._blendIndex=I_g,this._blendWeight=I_h},I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(100,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector2",2),new I_ga(48,"vector2",15),new I_ga(56,"vector4",7),new I_ga(72,"vector4",6),new I_ga(88,"vector3",5)])}]),I_a}(),I_wa=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._textureCoordinate0=I_d,this._textureCoordinate1=I_e,this._tangent=I_f}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(72,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector2",2),new I_ga(48,"vector2",15),new I_ga(56,"vector4",5)])}]),I_a}(),I_xa=function(){function I_a(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_b.VertexPositionNormalColorTexture0Tangent=function(I_a,I_b,I_c,I_d,I_e,I_f){this._position=I_a,this._normal=I_b,this._color=I_c,this._textureCoordinate0=I_d,this._textureCoordinate1=I_e,this._tangent=I_f},I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(68,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector2",2),new I_ga(48,"vector2",15),new I_ga(56,"vector3",5)])}]),I_a}(),I_ya=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._textureCoordinate=I_d,this._blendIndex=I_e,this._blendWeight=I_f}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(80,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector2",2),new I_ga(48,"vector4",7),new I_ga(64,"vector4",6)])}]),I_a}(),I_za=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._textureCoordinate=I_d,this._tangent=I_e,this._blendIndex=I_f,this._blendWeight=I_g}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(96,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector2",2),new I_ga(48,"vector4",7),new I_ga(64,"vector4",6),new I_ga(80,"vector4",5)])}]),I_a}(),I_Aa=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._textureCoordinate=I_d,this._tangent=I_e,this._blendIndex=I_f,this._blendWeight=I_g}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(92,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector2",2),new I_ga(48,"vector4",7),new I_ga(64,"vector4",6),new I_ga(80,"vector3",5)])}]),I_a}(),I_Ba=function(){function I_a(I_a,I_b,I_c,I_d,I_e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._textureCoordinate=I_d,this._tangent=I_e}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(64,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector2",2),new I_ga(48,"vector4",5)])}]),I_a}(),I_Ca=function(){function I_a(I_a,I_b,I_c,I_d,I_e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._color=I_c,this._textureCoordinate=I_d,this._tangent=I_e}I_n(I_a,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"color",function(){return this._color}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(60,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",1),new I_ga(40,"vector2",2),new I_ga(48,"vector3",5)])}]),I_a}(),I_Da=function(){function I_a(I_a,I_b,I_c){this._position=null,this._normal=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._tangent=I_c}I_n(I_a,"laya.d3.graphics.VertexPositionNormalSTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(40,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector4",5)])}]),I_a}(),I_Ea=function(){function I_a(I_a,I_b,I_c){this._position=null,this._normal=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._tangent=I_c}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(36,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector3",5)])}]),I_a}(),I_Fa=function(){function I_a(I_a,I_b,I_c){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=I_a,this._normal=I_b,this._textureCoordinate=I_c}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTexture");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(32,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2)])}]),I_a}(),I_Ga=function(){function I_a(I_a,I_b,I_c,I_d){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=I_a,this._normal=I_b,this._textureCoordinate0=I_c,this._textureCoordinate1=I_d}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(40,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2),new I_ga(32,"vector2",15)])}]),I_a}(),I_Ha=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=I_a,this._normal=I_b,this._textureCoordinate0=I_c,this._textureCoordinate1=I_d,this._blendIndex=I_e,this._blendWeight=I_f}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(72,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2),new I_ga(32,"vector2",15),new I_ga(40,"vector4",7),new I_ga(56,"vector4",6)])}]),I_a}(),I_Ia=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._textureCoordinate0=I_c,this._textureCoordinate1=I_d,this._tangent=I_e,this._blendIndex=I_f,this._blendWeight=I_g}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(88,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2),new I_ga(32,"vector2",15),new I_ga(40,"vector4",7),new I_ga(56,"vector4",6),new I_ga(72,"vector4",5)])}]),I_a}(),I_Ja=function(){function I_a(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_b.VertexPositionNormalTexture0SkinTangent=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){this._position=I_a,this._normal=I_b,this._textureCoordinate0=I_c,this._textureCoordinate1=I_d,this._tangent=I_e,this._blendIndex=I_f,this._blendWeight=I_g},I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(84,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2),new I_ga(32,"vector2",15),new I_ga(40,"vector4",7),new I_ga(56,"vector4",6),new I_ga(72,"vector3",5)])}]),I_a}(),I_Ka=function(){function I_a(I_a,I_b,I_c,I_d,I_e){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._textureCoordinate0=I_c,this._textureCoordinate1=I_d,this._tangent=I_e}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(56,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2),new I_ga(32,"vector2",15),new I_ga(40,"vector4",5)])}]),I_a}(),I_La=function(){function I_a(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_b.VertexPositionNormalTexture0Tangent=function(I_a,I_b,I_c,I_d,I_e){this._position=I_a,this._normal=I_b,this._textureCoordinate0=I_c,this._textureCoordinate1=I_d,this._tangent=I_e},I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(52,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2),new I_ga(32,"vector2",15),new I_ga(40,"vector3",5)])}]),I_a}(),I_Ma=function(){function I_a(I_a,I_b,I_c,I_d,I_e){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=I_a,this._normal=I_b,this._textureCoordinate=I_c,this._blendIndex=I_d,this._blendWeight=I_e}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTextureSkin");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(64,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2),new I_ga(32,"vector4",7),new I_ga(48,"vector4",6)])}]),I_a}(),I_Na=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._textureCoordinate=I_c,this._tangent=I_d,this._blendIndex=I_e,this._blendWeight=I_f}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(80,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2),new I_ga(32,"vector4",7),new I_ga(48,"vector4",6),new I_ga(64,"vector4",5)])}]),I_a}(),I_Oa=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._textureCoordinate=I_c,this._tangent=I_d,this._blendIndex=I_e,this._blendWeight=I_f}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(76,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2),new I_ga(32,"vector4",7),new I_ga(48,"vector4",6),new I_ga(64,"vector3",5)])}]),I_a}(),I_Pa=function(){function I_a(I_a,I_b,I_c,I_d){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._textureCoordinate=I_c,this._tangent=I_d}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(48,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2),new I_ga(32,"vector4",5)])}]),I_a}(),I_Qa=function(){function I_a(I_a,I_b,I_c,I_d){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=I_a,this._normal=I_b,this._textureCoordinate=I_c,this._tangent=I_d}I_n(I_a,"laya.d3.graphics.VertexPositionNormalTextureTangent");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(44,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2),new I_ga(32,"vector3",5)])}]),I_a}(),I_Ra=function(){function I_a(I_a,I_b,I_c){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=I_a,this._normal=I_b,this._textureCoordinate=I_c}I_n(I_a,"laya.d3.graphics.VertexPositionNTBTexture");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(56,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector3",5),new I_ga(36,"vector3",4),new I_ga(48,"vector2",2)])}]),I_a}(),I_Sa=function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=I_a,this._normal=I_b,this._textureCoordinate0=I_d,this._textureCoordinate1=I_e,this._tangent=I_f,I_c=I_c,this._blendIndex=I_g,this._blendWeight=I_h}I_n(I_a,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"tangent",function(){return this._tangent}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(0,I_b,"textureCoordinate1",function(){return this._textureCoordinate1}),I_o(0,I_b,"blendIndex",function(){return this._blendIndex}),I_o(0,I_b,"blendWeight",function(){return this._blendWeight}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(96,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector3",5),new I_ga(36,"vector3",4),new I_ga(48,"vector2",2),new I_ga(56,"vector2",15),new I_ga(64,"vector4",7),new I_ga(80,"vector4",6)])}]),I_a}(),I_Ta=function(){function I_a(I_a,I_b,I_c){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=I_a,this._normal=I_b,this._textureCoordinate=I_c}I_n(I_a,"laya.d3.graphics.VertexPositionNTBTextureSkin");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"textureCoordinate",function(){return this._textureCoordinate}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(88,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector3",5),new I_ga(36,"vector3",4),new I_ga(48,"vector2",2),new I_ga(56,"vector4",7),new I_ga(72,"vector4",6)])}]),I_a}(),I_Ua=(function(){function I_a(I_a,I_b,I_c,I_d){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=I_a,this._normal=I_b,this._textureCoord0=I_c,this._textureCoord1=I_d}I_n(I_a,"laya.d3.graphics.VertexPositionTerrain");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"normal",function(){return this._normal}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"textureCoord0",function(){return this._textureCoord0}),I_o(0,I_b,"textureCoord1",function(){return this._textureCoord1}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(40,[new I_ga(0,"vector3",0),new I_ga(12,"vector3",3),new I_ga(24,"vector2",2),new I_ga(32,"vector2",15)])}])}(),function(){function I_a(I_a,I_b){this._position=null,this._textureCoordinate0=null,this._position=I_a,this._textureCoordinate0=I_b}I_n(I_a,"laya.d3.graphics.VertexPositionTexture0");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"position",function(){return this._position}),I_o(0,I_b,"textureCoordinate0",function(){return this._textureCoordinate0}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(20,[new I_ga(0,"vector3",0),new I_ga(12,"vector2",2)])}]),I_a}()),I_Va=(function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_l,I_m,I_n){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=I_a,this._positionStartLifeTime=I_b,this._velocity=I_c,this._startColor=I_d,this._startSize=I_e,this._startRotation0=I_f,this._startRotation1=I_g,this._startRotation2=I_h,this._startLifeTime=I_i,this._time=I_j,this._startSpeed=I_k,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=I_n}I_n(I_a,"laya.d3.graphics.VertexShurikenParticleBillboard");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),I_o(0,I_b,"random1",function(){return this._randoms1}),I_o(0,I_b,"startRotation2",function(){return this._startRotation2}),I_o(0,I_b,"positionStartLifeTime",function(){return this._positionStartLifeTime}),I_o(0,I_b,"velocity",function(){return this._velocity}),I_o(0,I_b,"random0",function(){return this._randoms0}),I_o(0,I_b,"startSize",function(){return this._startSize}),I_o(0,I_b,"startColor",function(){return this._startColor}),I_o(0,I_b,"startRotation0",function(){return this._startRotation0}),I_o(0,I_b,"startRotation1",function(){return this._startRotation1}),I_o(0,I_b,"startLifeTime",function(){return this._startLifeTime}),I_o(0,I_b,"time",function(){return this._time}),I_o(0,I_b,"startSpeed",function(){return this._startSpeed}),I_o(0,I_b,"simulationWorldPostion",function(){return this._simulationWorldPostion}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(152,[new I_ga(0,"vector4",17),new I_ga(16,"vector4",30),new I_ga(32,"vector4",32),new I_ga(48,"vector4",19),new I_ga(64,"vector3",20),new I_ga(76,"vector3",22),new I_ga(88,"single",31),new I_ga(92,"vector4",34),new I_ga(108,"vector4",35),new I_ga(124,"vector3",36),new I_ga(136,"vector4",37)])}])}(),function(){function I_a(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_l,I_m,I_n){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=I_a,this._positionStartLifeTime=I_b,this._velocity=I_c,this._startColor=I_d,this._startSize=I_e,this._startRotation0=I_f,this._startRotation1=I_g,this._startRotation2=I_h,this._startLifeTime=I_i,this._time=I_j,this._startSpeed=I_k,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=I_n}I_n(I_a,"laya.d3.graphics.VertexShurikenParticleMesh");var I_b=I_a.prototype;I_x.imps(I_b,{"laya.d3.graphics.IVertex":!0}),I_o(0,I_b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),I_o(0,I_b,"velocity",function(){return this._velocity}),I_o(0,I_b,"position",function(){return this._positionStartLifeTime}),I_o(0,I_b,"random0",function(){return this._randoms0}),I_o(0,I_b,"startSize",function(){return this._startSize}),I_o(0,I_b,"startColor",function(){return this._startColor}),I_o(0,I_b,"startRotation0",function(){return this._startRotation0}),I_o(0,I_b,"startRotation1",function(){return this._startRotation1}),I_o(0,I_b,"random1",function(){return this._randoms1}),I_o(0,I_b,"startRotation2",function(){return this._startRotation2}),I_o(0,I_b,"startLifeTime",function(){return this._startLifeTime}),I_o(0,I_b,"time",function(){return this._time}),I_o(0,I_b,"startSpeed",function(){return this._startSpeed}),I_o(0,I_b,"simulationWorldPostion",function(){return this._simulationWorldPostion}),I_o(0,I_b,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_o(1,I_a,"vertexDeclaration",function(){return I_a._vertexDeclaration}),I_l(I_a,["_vertexDeclaration",function(){return this._vertexDeclaration=new I_fa(172,[new I_ga(0,"vector3",0),new I_ga(12,"vector4",1),new I_ga(28,"vector2",2),new I_ga(36,"vector4",30),new I_ga(52,"vector4",32),new I_ga(68,"vector4",19),new I_ga(84,"vector3",20),new I_ga(96,"vector3",22),new I_ga(108,"single",31),new I_ga(112,"vector4",34),new I_ga(128,"vector4",35),new I_ga(144,"vector3",36),new I_ga(156,"vector4",37)])}])}(),function(){function I_v(I_a,I_b,I_c,I_d,I_e,I_f){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=I_c,this._materials=I_d,this._subMeshes=I_e,this._materialMap=I_f,this._version=I_b,this._onLoaded(I_a)}I_n(I_v,"laya.d3.loaders.LoadModelV01");var I_a=I_v.prototype;return I_a._onLoaded=function(I_a){this._readData=I_a,this.READ_BLOCK();for(var I_b=0;I_b<this._BLOCK.count;I_b++){var I_c=this._readData.getUint16(),I_d=this._strings[I_c],I_e=this["READ_"+I_d];if(null==I_e)throw new Error("model file err,no this function:"+I_c+" "+I_d);if(!I_e.call(this))break}return this._mesh},I_a.onError=function(){},I_a._readString=function(){return this._strings[this._readData.getUint16()]},I_a.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},I_a.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},I_a.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var I_a=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var I_b=0;I_b<this._STRINGS.size;I_b++)this._strings[I_b]=this._readData.readUTFString();return this._readData.pos=I_a,!0},I_a.READ_MATERIAL=function(){var I_a=this._readData.getUint16(),I_b=(this._readString(),this._readString());return this._materials[I_a]="null"!==I_b?I_t.getRes(this._materialMap[I_b]):new I_Eb,!0},I_a.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var I_a,I_b=this._readData.__getBuffer(),I_c=0,I_d=this._readData.getUint32(),I_e=this._readData.getUint32(),I_f=(new Float32Array(I_b.slice(I_d+this._DATA.offset,I_d+this._DATA.offset+I_e)),this._readData.getUint32()),I_g=this._readData.getUint32(),I_h=new Float32Array(I_b.slice(I_f+this._DATA.offset,I_f+this._DATA.offset+I_g));for(this.mesh._inverseBindPoses=[],I_c=0,I_a=I_h.length;I_c<I_a;I_c+=16){var I_i=new I_ab(I_h[I_c+0],I_h[I_c+1],I_h[I_c+2],I_h[I_c+3],I_h[I_c+4],I_h[I_c+5],I_h[I_c+6],I_h[I_c+7],I_h[I_c+8],I_h[I_c+9],I_h[I_c+10],I_h[I_c+11],I_h[I_c+12],I_h[I_c+13],I_h[I_c+14],I_h[I_c+15]);this.mesh._inverseBindPoses.push(I_i)}break;default:throw new Error("LoadModel:unknown version.")}return!0},I_a.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var I_a=this._readString();this._shaderAttributes=I_a.match(I_v._attrReg);var I_b=this._readData.getUint32(),I_c=this._readData.getUint32(),I_d=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),I_e=this._readData.getUint32(),I_f=this._readData.getUint32(),I_g=this._readData.getUint32(),I_h=this._readData.__getBuffer(),I_i=new I_jb(this._mesh),I_j=this._getVertexDeclaration(),I_k=I_Ob.create(I_j,I_e/I_j.vertexStride,35044,!0),I_l=I_d+this._DATA.offset,I_m=I_h.slice(I_l,I_l+I_e);I_k.setData(new Float32Array(I_m));for(var I_n=(I_i._vertexBuffer=I_k).vertexDeclaration.getVertexElements(),I_o=0;I_o<I_n.length;I_o++)I_i._bufferUsage[I_n[I_o].elementUsage]=I_k;var I_p=I_Nb.create("ushort",I_c/2,35044,!0),I_s=I_b+this._DATA.offset,I_t=I_h.slice(I_s,I_s+I_c);I_p.setData(new Uint16Array(I_t)),I_i._indexBuffer=I_p;var I_u=I_h.slice(I_f+this._DATA.offset,I_f+this._DATA.offset+I_g);return I_i._boneIndicesList[0]=new Uint8Array(I_u),this._subMeshes.push(I_i),!0},I_a.READ_DATAAREA=function(){return!1},I_a._getVertexDeclaration=function(){for(var I_a,I_b=!1,I_c=!1,I_d=!1,I_e=!1,I_f=!1,I_g=!1,I_h=!1,I_i=!1,I_j=!1,I_k=0;I_k<this._shaderAttributes.length;I_k+=8)switch(this._shaderAttributes[I_k]){case"POSITION":I_b=!0;break;case"NORMAL":I_c=!0;break;case"COLOR":I_d=!0;break;case"UV":I_e=!0;break;case"UV1":I_f=!0;break;case"BLENDWEIGHT":I_h=!0;break;case"BLENDINDICES":I_i=!0;break;case"TANGENT":I_g=!0;break;case"BINORMAL":I_j=!0}return I_b&&I_c&&I_d&&I_e&&I_f&&I_h&&I_i&&I_g?I_a=I_va.vertexDeclaration:I_b&&I_c&&I_d&&I_e&&I_f&&I_h&&I_i?I_a=I_ta.vertexDeclaration:I_b&&I_c&&I_e&&I_f&&I_h&&I_i&&I_g?I_a=I_Ja.vertexDeclaration:I_b&&I_c&&I_e&&I_f&&I_h&&I_i?I_a=I_Ha.vertexDeclaration:I_b&&I_c&&I_d&&I_e&&I_h&&I_i&&I_g?I_a=I_Aa.vertexDeclaration:I_b&&I_c&&I_d&&I_e&&I_h&&I_i?I_a=I_ya.vertexDeclaration:I_b&&I_c&&I_g&&I_j&&I_e&&I_h&&I_i?I_a=I_Ta.vertexDeclaration:I_b&&I_c&&I_e&&I_h&&I_i&&I_g?I_a=I_Oa.vertexDeclaration:I_b&&I_c&&I_e&&I_h&&I_i?I_a=I_Ma.vertexDeclaration:I_b&&I_c&&I_d&&I_h&&I_i&&I_g?I_a=I_ma.vertexDeclaration:I_b&&I_c&&I_d&&I_h&&I_i?I_a=I_ka.vertexDeclaration:I_b&&I_c&&I_d&&I_e&&I_f&&I_g?I_a=I_xa.vertexDeclaration:I_b&&I_c&&I_d&&I_e&&I_f?I_a=I_sa.vertexDeclaration:I_b&&I_c&&I_e&&I_f&&I_g?I_a=I_La.vertexDeclaration:I_b&&I_c&&I_e&&I_f?I_a=I_Ga.vertexDeclaration:I_b&&I_c&&I_d&&I_e&&I_g?I_a=I_Ca.vertexDeclaration:I_b&&I_c&&I_e&&I_g&&I_j?I_a=I_Ra.vertexDeclaration:I_b&&I_c&&I_d&&I_e?I_a=I_pa.vertexDeclaration:I_b&&I_c&&I_e&&I_g?I_a=I_Qa.vertexDeclaration:I_b&&I_c&&I_e?I_a=I_Fa.vertexDeclaration:I_b&&I_c&&I_d&&I_g?I_a=I_oa.vertexDeclaration:I_b&&I_c&&I_d&&(I_a=I_ja.vertexDeclaration),I_a},I_o(0,I_a,"mesh",function(){return this._mesh}),I_v._attrReg=new RegExp("(\\w+)|([:,;])","g"),I_v}()),I_Wa=function(){function I_z(){}return I_n(I_z,"laya.d3.loaders.LoadModelV02"),I_z.parse=function(I_a,I_b,I_c,I_d,I_e,I_f){I_z._mesh=I_c,I_z._materials=I_d,I_z._subMeshes=I_e,I_z._materialMap=I_f,I_z._version=I_b,I_z._readData=I_a,I_z.READ_DATA(),I_z.READ_BLOCK(),I_z.READ_STRINGS();for(var I_g=0,I_h=I_z._BLOCK.count;I_g<I_h;I_g++){I_z._readData.pos=I_z._BLOCK.blockStarts[I_g];var I_i=I_z._readData.getUint16(),I_j=I_z._strings[I_i],I_k=I_z["READ_"+I_j];if(null==I_k)throw new Error("model file err,no this function:"+I_i+" "+I_j);I_k.call()}I_z._strings.length=0,I_z._readData=null,I_z._version=null,I_z._mesh=null,I_z._materials=null,I_z._subMeshes=null,I_z._materialMap=null},I_z._readString=function(){return I_z._strings[I_z._readData.getUint16()]},I_z.READ_DATA=function(){I_z._DATA.offset=I_z._readData.getUint32(),I_z._DATA.size=I_z._readData.getUint32()},I_z.READ_BLOCK=function(){for(var I_a=I_z._BLOCK.count=I_z._readData.getUint16(),I_b=I_z._BLOCK.blockStarts=[],I_c=I_z._BLOCK.blockLengths=[],I_d=0;I_d<I_a;I_d++)I_b.push(I_z._readData.getUint32()),I_c.push(I_z._readData.getUint32())},I_z.READ_STRINGS=function(){var I_a=I_z._readData.getUint32(),I_b=I_z._readData.getUint16(),I_c=I_z._readData.pos;I_z._readData.pos=I_a+I_z._DATA.offset;for(var I_d=0;I_d<I_b;I_d++)I_z._strings[I_d]=I_z._readData.readUTFString();I_z._readData.pos=I_c},I_z.READ_MATERIAL=function(){I_z._readString(),I_z._readString();var I_a=I_z._readString();return""!==I_a&&I_z._materials.push(I_t.getRes(I_z._materialMap[I_a])),!0},I_z.READ_MESH=function(){I_z._readString();var I_a,I_b=I_z._readData.__getBuffer(),I_c=0,I_d=I_z._readData.getInt16(),I_e=I_z._DATA.offset;for(I_c=0;I_c<I_d;I_c++){var I_f=I_e+I_z._readData.getUint32(),I_g=I_z._readData.getUint32(),I_h=new Float32Array(I_b.slice(I_f,I_f+I_g)),I_i=I_z._readString().match(I_z._attrReg),I_j=I_z._getVertexDeclaration(I_i),I_k=I_Ob.create(I_j,4*I_h.length/I_j.vertexStride,35044,!0);I_k.setData(I_h),I_z._mesh._vertexBuffers.push(I_k)}var I_l=I_e+I_z._readData.getUint32(),I_m=I_z._readData.getUint32(),I_n=new Uint16Array(I_b.slice(I_l,I_l+I_m)),I_o=I_Nb.create("ushort",I_m/2,35044,!0);I_o.setData(I_n),I_z._mesh._indexBuffer=I_o;var I_p=I_z._mesh._boneNames=[],I_s=I_z._readData.getUint16();for(I_p.length=I_s,I_c=0;I_c<I_s;I_c++)I_p[I_c]=I_z._strings[I_z._readData.getUint16()];var I_t=I_z._readData.getUint32(),I_u=I_z._readData.getUint32(),I_v=(new Float32Array(I_b.slice(I_e+I_t,I_e+I_t+I_u)),I_z._readData.getUint32()),I_w=I_z._readData.getUint32(),I_x=new Float32Array(I_b.slice(I_e+I_v,I_e+I_v+I_w));for(I_z._mesh._inverseBindPoses=[],I_c=0,I_a=I_x.length;I_c<I_a;I_c+=16){var I_y=new I_ab(I_x[I_c+0],I_x[I_c+1],I_x[I_c+2],I_x[I_c+3],I_x[I_c+4],I_x[I_c+5],I_x[I_c+6],I_x[I_c+7],I_x[I_c+8],I_x[I_c+9],I_x[I_c+10],I_x[I_c+11],I_x[I_c+12],I_x[I_c+13],I_x[I_c+14],I_x[I_c+15]);I_z._mesh._inverseBindPoses.push(I_y)}return I_z._mesh._skinnedDatas=new Float32Array(16*I_x.length),!0},I_z.READ_SUBMESH=function(){var I_a=I_z._readData.__getBuffer(),I_b=new I_jb(I_z._mesh),I_c=I_z._readData.getInt16(),I_d=I_z._readData.getUint32(),I_e=I_z._readData.getUint32();I_b._vertexBuffer=I_z._mesh._vertexBuffers[I_c],I_b._vertexStart=I_d,I_b._vertexCount=I_e;var I_f=I_z._readData.getUint32(),I_g=I_z._readData.getUint32(),I_h=I_z._mesh._indexBuffer;I_b._indexBuffer=I_h,I_b._indexStart=I_f,I_b._indexCount=I_g,I_b._indices=new Uint16Array(I_h.getData().buffer,2*I_f,I_g);var I_i=I_z._DATA.offset,I_j=I_b._subIndexBufferStart,I_k=I_b._subIndexBufferCount,I_l=I_b._boneIndicesList,I_m=I_z._readData.getUint16();I_j.length=I_m,I_k.length=I_m,I_l.length=I_m;for(var I_n=0;I_n<I_m;I_n++){I_j[I_n]=I_z._readData.getUint32(),I_k[I_n]=I_z._readData.getUint32();var I_o=I_z._readData.getUint32(),I_p=I_z._readData.getUint32();I_b._boneIndicesList[I_n]=new Uint8Array(I_a.slice(I_i+I_o,I_i+I_o+I_p))}return I_z._subMeshes.push(I_b),!0},I_z._getVertexDeclaration=function(I_a){for(var I_b,I_c=!1,I_d=!1,I_e=!1,I_f=!1,I_g=!1,I_h=!1,I_i=!1,I_j=!1,I_k=!1,I_l=0;I_l<I_a.length;I_l++)switch(I_a[I_l]){case"POSITION":I_c=!0;break;case"NORMAL":I_d=!0;break;case"COLOR":I_e=!0;break;case"UV":I_f=!0;break;case"UV1":I_g=!0;break;case"BLENDWEIGHT":I_i=!0;break;case"BLENDINDICES":I_j=!0;break;case"TANGENT":I_h=!0;break;case"BINORMAL":I_k=!0}return I_c&&I_d&&I_e&&I_f&&I_g&&I_i&&I_j&&I_h?I_b=I_va.vertexDeclaration:I_c&&I_d&&I_e&&I_f&&I_g&&I_i&&I_j?I_b=I_ta.vertexDeclaration:I_c&&I_d&&I_f&&I_g&&I_i&&I_j&&I_h?I_b=I_Ja.vertexDeclaration:I_c&&I_d&&I_f&&I_g&&I_i&&I_j?I_b=I_Ha.vertexDeclaration:I_c&&I_d&&I_e&&I_f&&I_i&&I_j&&I_h?I_b=I_Aa.vertexDeclaration:I_c&&I_d&&I_e&&I_f&&I_i&&I_j?I_b=I_ya.vertexDeclaration:I_c&&I_d&&I_f&&I_i&&I_j&&I_h?I_b=I_Oa.vertexDeclaration:I_c&&I_d&&I_f&&I_i&&I_j?I_b=I_Ma.vertexDeclaration:I_c&&I_d&&I_e&&I_i&&I_j&&I_h?I_b=I_ma.vertexDeclaration:I_c&&I_d&&I_e&&I_i&&I_j?I_b=I_ka.vertexDeclaration:I_c&&I_d&&I_e&&I_f&&I_g&&I_h?I_b=I_xa.vertexDeclaration:I_c&&I_d&&I_e&&I_f&&I_g?I_b=I_sa.vertexDeclaration:I_c&&I_d&&I_f&&I_g&&I_h?I_b=I_La.vertexDeclaration:I_c&&I_d&&I_f&&I_g?I_b=I_Ga.vertexDeclaration:I_c&&I_d&&I_e&&I_f&&I_h?I_b=I_Ca.vertexDeclaration:I_c&&I_d&&I_f&&I_h&&I_k?I_b=I_Ra.vertexDeclaration:I_c&&I_d&&I_e&&I_f?I_b=I_pa.vertexDeclaration:I_c&&I_d&&I_f&&I_h?I_b=I_Qa.vertexDeclaration:I_c&&I_d&&I_f?I_b=I_Fa.vertexDeclaration:I_c&&I_d&&I_e&&I_h?I_b=I_oa.vertexDeclaration:I_c&&I_d&&I_e&&(I_b=I_ja.vertexDeclaration),I_b},I_z._attrReg=new RegExp("(\\w+)|([:,;])","g"),I_z._strings=[],I_z._readData=null,I_z._version=null,I_z._mesh=null,I_z._materials=null,I_z._subMeshes=null,I_z._materialMap=null,I_l(I_z,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),I_z}(),I_Xa=function(){function I_y(){}return I_n(I_y,"laya.d3.loaders.LoadModelV03"),I_y.parse=function(I_a,I_b,I_c,I_d,I_e){I_y._mesh=I_c,I_y._subMeshes=I_d,I_y._materialMap=I_e,I_y._version=I_b,I_y._readData=I_a,I_y.READ_DATA(),I_y.READ_BLOCK(),I_y.READ_STRINGS();for(var I_f=0,I_g=I_y._BLOCK.count;I_f<I_g;I_f++){I_y._readData.pos=I_y._BLOCK.blockStarts[I_f];var I_h=I_y._readData.getUint16(),I_i=I_y._strings[I_h],I_j=I_y["READ_"+I_i];if(null==I_j)throw new Error("model file err,no this function:"+I_h+" "+I_i);I_j.call()}I_y._strings.length=0,I_y._readData=null,I_y._version=null,I_y._mesh=null,I_y._subMeshes=null,I_y._materialMap=null},I_y._readString=function(){return I_y._strings[I_y._readData.getUint16()]},I_y.READ_DATA=function(){I_y._DATA.offset=I_y._readData.getUint32(),I_y._DATA.size=I_y._readData.getUint32()},I_y.READ_BLOCK=function(){for(var I_a=I_y._BLOCK.count=I_y._readData.getUint16(),I_b=I_y._BLOCK.blockStarts=[],I_c=I_y._BLOCK.blockLengths=[],I_d=0;I_d<I_a;I_d++)I_b.push(I_y._readData.getUint32()),I_c.push(I_y._readData.getUint32())},I_y.READ_STRINGS=function(){var I_a=I_y._readData.getUint32(),I_b=I_y._readData.getUint16(),I_c=I_y._readData.pos;I_y._readData.pos=I_a+I_y._DATA.offset;for(var I_d=0;I_d<I_b;I_d++)I_y._strings[I_d]=I_y._readData.readUTFString();I_y._readData.pos=I_c},I_y.READ_MESH=function(){var I_a,I_b=I_y._readString(),I_c=I_y._readData.__getBuffer(),I_d=0,I_e=I_y._readData.getInt16(),I_f=I_y._DATA.offset;for(I_d=0;I_d<I_e;I_d++){var I_g,I_h=I_f+I_y._readData.getUint32(),I_i=I_y._readData.getUint32(),I_j=new Float32Array(I_c.slice(I_h,I_h+I_i)),I_k=I_y._readString();switch(I_y._version){case"LAYAMODEL:03":I_g=I_y._vertexDeclarationMap_Discard[I_k];break;case"LAYAMODEL:0301":I_g=I_y._vertexDeclarationMap[I_k];break;default:throw new Error("LoadModelV03: unknown version.")}if(!I_g)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+I_y._version+"  bufferAttribute="+I_k+"  name="+I_b+"  url="+(I_y._mesh?I_y._mesh.url:"null"));var I_l=I_Ob.create(I_g,4*I_j.length/I_g.vertexStride,35044,!0,I_y._mesh._url+"_"+I_d);I_l.setData(I_j),I_y._mesh._vertexBuffers.push(I_l)}var I_m=I_f+I_y._readData.getUint32(),I_n=I_y._readData.getUint32(),I_o=new Uint16Array(I_c.slice(I_m,I_m+I_n)),I_p=I_Nb.create("ushort",I_n/2,35044,!0,I_y._mesh._url);I_p.setData(I_o),I_y._mesh._indexBuffer=I_p;var I_s=I_y._mesh._boneNames=[],I_t=I_y._readData.getUint16();for(I_s.length=I_t,I_d=0;I_d<I_t;I_d++)I_s[I_d]=I_y._strings[I_y._readData.getUint16()];I_y._readData.pos+=8;var I_u=I_y._readData.getUint32(),I_v=I_y._readData.getUint32(),I_w=new Float32Array(I_c.slice(I_f+I_u,I_f+I_u+I_v));for(I_y._mesh._inverseBindPoses=[],I_d=0,I_a=I_w.length;I_d<I_a;I_d+=16){var I_x=new I_ab(I_w[I_d+0],I_w[I_d+1],I_w[I_d+2],I_w[I_d+3],I_w[I_d+4],I_w[I_d+5],I_w[I_d+6],I_w[I_d+7],I_w[I_d+8],I_w[I_d+9],I_w[I_d+10],I_w[I_d+11],I_w[I_d+12],I_w[I_d+13],I_w[I_d+14],I_w[I_d+15]);I_y._mesh._inverseBindPoses.push(I_x)}return I_y._mesh._skinnedDatas=new Float32Array(16*I_w.length),!0},I_y.READ_SUBMESH=function(){var I_a=I_y._readData.__getBuffer(),I_b=new I_jb(I_y._mesh),I_c=I_y._readData.getInt16(),I_d=I_y._readData.getUint32(),I_e=I_y._readData.getUint32();I_b._vertexBuffer=I_y._mesh._vertexBuffers[I_c],I_b._vertexStart=I_d,I_b._vertexCount=I_e;var I_f=I_y._readData.getUint32(),I_g=I_y._readData.getUint32(),I_h=I_y._mesh._indexBuffer;I_b._indexBuffer=I_h,I_b._indexStart=I_f,I_b._indexCount=I_g,I_b._indices=new Uint16Array(I_h.getData().buffer,2*I_f,I_g);var I_i=I_y._DATA.offset,I_j=I_b._subIndexBufferStart,I_k=I_b._subIndexBufferCount,I_l=I_b._boneIndicesList,I_m=I_y._readData.getUint16();I_j.length=I_m,I_k.length=I_m,I_l.length=I_m;for(var I_n=0;I_n<I_m;I_n++){I_j[I_n]=I_y._readData.getUint32(),I_k[I_n]=I_y._readData.getUint32();var I_o=I_y._readData.getUint32(),I_p=I_y._readData.getUint32();I_l[I_n]=new Uint8Array(I_a.slice(I_i+I_o,I_i+I_o+I_p))}return I_y._subMeshes.push(I_b),!0},I_y._strings=[],I_y._readData=null,I_y._version=null,I_y._mesh=null,I_y._subMeshes=null,I_y._materialMap=null,I_l(I_y,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":I_va.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":I_ta.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":I_Sa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":I_Ja.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":I_Ha.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":I_Aa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":I_ya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":I_Oa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":I_Ma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":I_ma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":I_ka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":I_xa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":I_sa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":I_La.vertexDeclaration,"POSITION,NORMAL,UV,UV1":I_Ga.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":I_Ca.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":I_Ra.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":I_pa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":I_Qa.vertexDeclaration,"POSITION,NORMAL,UV":I_Fa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":I_oa.vertexDeclaration,"POSITION,NORMAL,COLOR":I_ja.vertexDeclaration,"POSITION,NORMAL,TANGENT":I_Ea.vertexDeclaration,"POSITION,NORMAL":I_ia.vertexDeclaration,"POSITION,UV":I_Ua.vertexDeclaration,POSITION:I_ha.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":I_ua.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":I_ta.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":I_Sa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":I_Ia.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":I_Ha.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":I_za.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":I_ya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":I_Na.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":I_Ma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":I_la.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":I_ka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":I_wa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":I_sa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":I_Ka.vertexDeclaration,"POSITION,NORMAL,UV,UV1":I_Ga.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":I_Ba.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":I_Ra.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":I_pa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":I_Pa.vertexDeclaration,"POSITION,NORMAL,UV":I_Fa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":I_na.vertexDeclaration,"POSITION,NORMAL,COLOR":I_ja.vertexDeclaration,"POSITION,NORMAL,TANGENT":I_Da.vertexDeclaration,"POSITION,NORMAL":I_ia.vertexDeclaration,"POSITION,UV":I_Ua.vertexDeclaration,POSITION:I_ha.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),I_y}(),I_Ya=function(){function I_h(){}return I_n(I_h,"laya.d3.loaders.MeshReader"),I_h.read=function(I_a,I_b,I_c,I_d,I_e){var I_f=new I_y(I_a);I_f.pos=0;var I_g=I_f.readUTFString();switch(I_g){case"LAYAMODEL:01":case"LAYASKINANI:01":I_h._readVersion01(I_f,I_g,I_b,I_c,I_d,I_e);break;case"LAYAMODEL:02":I_Wa.parse(I_f,I_g,I_b,I_c,I_d,I_e);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":I_Xa.parse(I_f,I_g,I_b,I_d,I_e);break;default:throw new Error("MeshReader: unknown mesh version.")}I_b._setSubMeshes(I_d)},I_h._readVersion01=function(I_a,I_b,I_c,I_d,I_e,I_f){new I_Va(I_a,I_b,I_c,I_d,I_e,I_f)},I_h}(),I_Za=function(){function I_a(I_a,I_b){this.min=null,this.max=null,this.min=I_a,this.max=I_b}I_n(I_a,"laya.d3.math.BoundBox");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b.getCorners=function(I_a){I_a.length=8;var I_b=this.min.elements,I_c=this.max.elements,I_d=I_b[0],I_e=I_b[1],I_f=I_b[2],I_g=I_c[0],I_h=I_c[1],I_i=I_c[2];I_a[0]=new I_gb(I_d,I_h,I_i),I_a[1]=new I_gb(I_g,I_h,I_i),I_a[2]=new I_gb(I_g,I_e,I_i),I_a[3]=new I_gb(I_d,I_e,I_i),I_a[4]=new I_gb(I_d,I_h,I_f),I_a[5]=new I_gb(I_g,I_h,I_f),I_a[6]=new I_gb(I_g,I_e,I_f),I_a[7]=new I_gb(I_d,I_e,I_f)},I_b.toDefault=function(){this.min.toDefault(),this.max.toDefault()},I_b.cloneTo=function(I_a){var I_b=I_a;this.min.cloneTo(I_b.min),this.max.cloneTo(I_b.max)},I_b.clone=function(){var I_a=new this.constructor(new I_gb,new I_gb);return this.cloneTo(I_a),I_a},I_a.createfromPoints=function(I_a,I_b){if(null==I_a)throw new Error("points");var I_c=I_b.min,I_d=I_b.max,I_e=I_c.elements;I_e[0]=Number.MAX_VALUE,I_e[1]=Number.MAX_VALUE,I_e[2]=Number.MAX_VALUE;var I_f=I_d.elements;I_f[0]=-Number.MAX_VALUE,I_f[1]=-Number.MAX_VALUE,I_f[2]=-Number.MAX_VALUE;for(var I_g=0,I_h=I_a.length;I_g<I_h;++I_g)I_gb.min(I_c,I_a[I_g],I_c),I_gb.max(I_d,I_a[I_g],I_d)},I_a.merge=function(I_a,I_b,I_c){I_gb.min(I_a.min,I_b.min,I_c.min),I_gb.max(I_a.max,I_b.max,I_c.max)},I_a}(),I_$a=function(){function I_j(I_a){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=I_a,this._near=new I_bb(new I_gb),this._far=new I_bb(new I_gb),this._left=new I_bb(new I_gb),this._right=new I_bb(new I_gb),this._top=new I_bb(new I_gb),this._bottom=new I_bb(new I_gb),I_j._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}I_n(I_j,"laya.d3.math.BoundFrustum");var I_a=I_j.prototype;return I_a.equalsBoundFrustum=function(I_a){return this._matrix.equalsOtherMatrix(I_a.matrix)},I_a.equalsObj=function(I_a){if(I_a instanceof laya.d3.math.BoundFrustum){var I_b=I_a;return this.equalsBoundFrustum(I_b)}return!1},I_a.getPlane=function(I_a){switch(I_a){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},I_a.getCorners=function(I_a){I_j._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(I_a[0]),I_j._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(I_a[1]),I_j._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(I_a[2]),I_j._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(I_a[3]),I_j._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(I_a[4]),I_j._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(I_a[5]),I_j._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(I_a[6]),I_j._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(I_a[7])},I_a.containsPoint=function(I_a){for(var I_b=I_bb.PlaneIntersectionType_Front,I_c=I_bb.PlaneIntersectionType_Front,I_d=0;I_d<6;I_d++){switch(I_d){case 0:I_c=Collision.intersectsPlaneAndPoint(this._near,I_a);break;case 1:I_c=Collision.intersectsPlaneAndPoint(this._far,I_a);break;case 2:I_c=Collision.intersectsPlaneAndPoint(this._left,I_a);break;case 3:I_c=Collision.intersectsPlaneAndPoint(this._right,I_a);break;case 4:I_c=Collision.intersectsPlaneAndPoint(this._top,I_a);break;case 5:I_c=Collision.intersectsPlaneAndPoint(this._bottom,I_a)}switch(I_c){case I_bb.PlaneIntersectionType_Back:return 0;case I_bb.PlaneIntersectionType_Intersecting:I_b=I_bb.PlaneIntersectionType_Intersecting}}switch(I_b){case I_bb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},I_a.containsBoundBox=function(I_a){for(var I_b,I_c=I_j._tempV30,I_d=I_j._tempV31,I_e=1,I_f=0;I_f<6;I_f++){if(I_b=this.getPlane(I_f),this._getBoxToPlanePVertexNVertex(I_a,I_b.normal,I_c,I_d),Collision.intersectsPlaneAndPoint(I_b,I_c)===I_bb.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(I_b,I_d)===I_bb.PlaneIntersectionType_Back&&(I_e=2)}return I_e},I_a.containsBoundSphere=function(I_a){for(var I_b=I_bb.PlaneIntersectionType_Front,I_c=I_bb.PlaneIntersectionType_Front,I_d=0;I_d<6;I_d++){switch(I_d){case 0:I_c=Collision.intersectsPlaneAndSphere(this._near,I_a);break;case 1:I_c=Collision.intersectsPlaneAndSphere(this._far,I_a);break;case 2:I_c=Collision.intersectsPlaneAndSphere(this._left,I_a);break;case 3:I_c=Collision.intersectsPlaneAndSphere(this._right,I_a);break;case 4:I_c=Collision.intersectsPlaneAndSphere(this._top,I_a);break;case 5:I_c=Collision.intersectsPlaneAndSphere(this._bottom,I_a)}switch(I_c){case I_bb.PlaneIntersectionType_Back:return 0;case I_bb.PlaneIntersectionType_Intersecting:I_b=I_bb.PlaneIntersectionType_Intersecting}}switch(I_b){case I_bb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},I_a._getBoxToPlanePVertexNVertex=function(I_a,I_b,I_c,I_d){var I_e=I_a.min,I_f=I_e.elements,I_g=I_a.max,I_h=I_g.elements,I_i=I_b.elements,I_j=I_i[0],I_k=I_i[1],I_l=I_i[2];I_e.cloneTo(I_c);var I_m=I_c.elements;0<=I_j&&(I_m[0]=I_h[0]),0<=I_k&&(I_m[1]=I_h[1]),0<=I_l&&(I_m[2]=I_h[2]),I_g.cloneTo(I_d);var I_n=I_d.elements;0<=I_j&&(I_n[0]=I_f[0]),0<=I_k&&(I_n[1]=I_f[1]),0<=I_l&&(I_n[2]=I_f[2])},I_o(0,I_a,"top",function(){return this._top}),I_o(0,I_a,"matrix",function(){return this._matrix},function(I_a){this._matrix=I_a,I_j._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),I_o(0,I_a,"near",function(){return this._near}),I_o(0,I_a,"far",function(){return this._far}),I_o(0,I_a,"left",function(){return this._left}),I_o(0,I_a,"right",function(){return this._right}),I_o(0,I_a,"bottom",function(){return this._bottom}),I_j._getPlanesFromMatrix=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){var I_h=I_a.elements,I_i=I_h[0],I_j=I_h[1],I_k=I_h[2],I_l=I_h[3],I_m=I_h[4],I_n=I_h[5],I_o=I_h[6],I_p=I_h[7],I_s=I_h[8],I_t=I_h[9],I_u=I_h[10],I_v=I_h[11],I_w=I_h[12],I_x=I_h[13],I_y=I_h[14],I_z=I_h[15],I_A=I_b.normal.elements;I_A[0]=I_l+I_k,I_A[1]=I_p+I_o,I_A[2]=I_v+I_u,I_b.distance=I_z+I_y,I_b.normalize();var I_B=I_c.normal.elements;I_B[0]=I_l-I_k,I_B[1]=I_p-I_o,I_B[2]=I_v-I_u,I_c.distance=I_z-I_y,I_c.normalize();var I_C=I_d.normal.elements;I_C[0]=I_l+I_i,I_C[1]=I_p+I_m,I_C[2]=I_v+I_s,I_d.distance=I_z+I_w,I_d.normalize();var I_D=I_e.normal.elements;I_D[0]=I_l-I_i,I_D[1]=I_p-I_m,I_D[2]=I_v-I_s,I_e.distance=I_z-I_w,I_e.normalize();var I_E=I_f.normal.elements;I_E[0]=I_l-I_j,I_E[1]=I_p-I_n,I_E[2]=I_v-I_t,I_f.distance=I_z-I_x,I_f.normalize();var I_F=I_g.normal.elements;I_F[0]=I_l+I_j,I_F[1]=I_p+I_n,I_F[2]=I_v+I_t,I_g.distance=I_z+I_x,I_g.normalize()},I_j._get3PlaneInterPoint=function(I_a,I_b,I_c){var I_d=I_a.normal,I_e=I_b.normal,I_f=I_c.normal;I_gb.cross(I_e,I_f,I_j._tempV30),I_gb.cross(I_f,I_d,I_j._tempV31),I_gb.cross(I_d,I_e,I_j._tempV32);var I_g=I_gb.dot(I_d,I_j._tempV30),I_h=I_gb.dot(I_e,I_j._tempV31),I_i=I_gb.dot(I_f,I_j._tempV32);return I_gb.scale(I_j._tempV30,-I_a.distance/I_g,I_j._tempV33),I_gb.scale(I_j._tempV31,-I_b.distance/I_h,I_j._tempV34),I_gb.scale(I_j._tempV32,-I_c.distance/I_i,I_j._tempV35),I_gb.add(I_j._tempV33,I_j._tempV34,I_j._tempV36),I_gb.add(I_j._tempV35,I_j._tempV36,I_j._tempV37),I_j._tempV37},I_l(I_j,["_tempV30",function(){return this._tempV30=new I_gb},"_tempV31",function(){return this._tempV31=new I_gb},"_tempV32",function(){return this._tempV32=new I_gb},"_tempV33",function(){return this._tempV33=new I_gb},"_tempV34",function(){return this._tempV34=new I_gb},"_tempV35",function(){return this._tempV35=new I_gb},"_tempV36",function(){return this._tempV36=new I_gb},"_tempV37",function(){return this._tempV37=new I_gb}]),I_j}(),I__a=function(){function I_k(I_a,I_b){this.center=null,this.radius=NaN,this.center=I_a,this.radius=I_b}I_n(I_k,"laya.d3.math.BoundSphere");var I_a=I_k.prototype;return I_x.imps(I_a,{"laya.d3.core.IClone":!0}),I_a.toDefault=function(){this.center.toDefault(),this.radius=0},I_a.intersectsRayDistance=function(I_a){return Collision.intersectsRayAndSphereRD(I_a,this)},I_a.intersectsRayPoint=function(I_a,I_b){return Collision.intersectsRayAndSphereRP(I_a,this,I_b)},I_a.cloneTo=function(I_a){var I_b=I_a;this.center.cloneTo(I_b.center),I_b.radius=this.radius},I_a.clone=function(){var I_a=new this.constructor(new I_gb,new I_gb);return this.cloneTo(I_a),I_a},I_k.createFromSubPoints=function(I_a,I_b,I_c,I_d){if(null==I_a)throw new Error("points");if(I_b<0||I_b>=I_a.length)throw new Error("start"+I_b+"Must be in the range [0, "+(I_a.length-1)+"]");if(I_c<0||I_b+I_c>I_a.length)throw new Error("count"+I_c+"Must be in the range <= "+I_a.length+"}");var I_e=I_b+I_c,I_f=I_k._tempVector3;I_f.elements[0]=0,I_f.elements[1]=0,I_f.elements[2]=0;for(var I_g=I_b;I_g<I_e;++I_g)I_gb.add(I_a[I_g],I_f,I_f);var I_h=I_d.center;I_gb.scale(I_f,1/I_c,I_h);var I_i=0;for(I_g=I_b;I_g<I_e;++I_g){var I_j=I_gb.distanceSquared(I_h,I_a[I_g]);I_i<I_j&&(I_i=I_j)}I_d.radius=Math.sqrt(I_i)},I_k.createfromPoints=function(I_a,I_b){if(null==I_a)throw new Error("points");I_k.createFromSubPoints(I_a,0,I_a.length,I_b)},I_l(I_k,["_tempVector3",function(){return this._tempVector3=new I_gb}]),I_k}(),I_qa=(function(){function I_a(){}I_n(I_a,"laya.d3.math.ContainmentType"),I_a.Disjoint=0,I_a.Contains=1,I_a.Intersects=2}(),function(){function I_c(){}return I_n(I_c,"laya.d3.math.MathUtils3D"),I_c.isZero=function(I_a){return Math.abs(I_a)<I_c.zeroTolerance},I_c.nearEqual=function(I_a,I_b){return!!I_c.isZero(I_a-I_b)},I_c.fastInvSqrt=function(I_a){return I_c.isZero(I_a)?I_a:1/Math.sqrt(I_a)},I_l(I_c,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),I_c}()),I_ra=function(){function I_i(){var I_a=this.elements=new Float32Array(9);I_a[0]=1,I_a[1]=0,I_a[2]=0,I_a[3]=0,I_a[4]=1,I_a[5]=0,I_a[6]=0,I_a[7]=0,I_a[8]=1}I_n(I_i,"laya.d3.math.Matrix3x3");var I_a=I_i.prototype;return I_x.imps(I_a,{"laya.d3.core.IClone":!0}),I_a.determinant=function(){var I_a=this.elements,I_b=I_a[0],I_c=I_a[1],I_d=I_a[2],I_e=I_a[3],I_f=I_a[4],I_g=I_a[5],I_h=I_a[6],I_i=I_a[7],I_j=I_a[8];return I_b*(I_j*I_f-I_g*I_i)+I_c*(-I_j*I_e+I_g*I_h)+I_d*(I_i*I_e-I_f*I_h)},I_a.translate=function(I_a,I_b){var I_c=I_b.elements,I_d=this.elements,I_e=I_a.elements,I_f=I_d[0],I_g=I_d[1],I_h=I_d[2],I_i=I_d[3],I_j=I_d[4],I_k=I_d[5],I_l=I_d[6],I_m=I_d[7],I_n=I_d[8],I_o=I_e[0],I_p=I_e[1];I_c[0]=I_f,I_c[1]=I_g,I_c[2]=I_h,I_c[3]=I_i,I_c[4]=I_j,I_c[5]=I_k,I_c[6]=I_o*I_f+I_p*I_i+I_l,I_c[7]=I_o*I_g+I_p*I_j+I_m,I_c[8]=I_o*I_h+I_p*I_k+I_n},I_a.rotate=function(I_a,I_b){var I_c=I_b.elements,I_d=this.elements,I_e=I_d[0],I_f=I_d[1],I_g=I_d[2],I_h=I_d[3],I_i=I_d[4],I_j=I_d[5],I_k=I_d[6],I_l=I_d[7],I_m=I_d[8],I_n=Math.sin(I_a),I_o=Math.cos(I_a);I_c[0]=I_o*I_e+I_n*I_h,I_c[1]=I_o*I_f+I_n*I_i,I_c[2]=I_o*I_g+I_n*I_j,I_c[3]=I_o*I_h-I_n*I_e,I_c[4]=I_o*I_i-I_n*I_f,I_c[5]=I_o*I_j-I_n*I_g,I_c[6]=I_k,I_c[7]=I_l,I_c[8]=I_m},I_a.scale=function(I_a,I_b){var I_c=I_b.elements,I_d=this.elements,I_e=I_a.elements,I_f=I_e[0],I_g=I_e[1];I_c[0]=I_f*I_d[0],I_c[1]=I_f*I_d[1],I_c[2]=I_f*I_d[2],I_c[3]=I_g*I_d[3],I_c[4]=I_g*I_d[4],I_c[5]=I_g*I_d[5],I_c[6]=I_d[6],I_c[7]=I_d[7],I_c[8]=I_d[8]},I_a.invert=function(I_a){var I_b=I_a.elements,I_c=this.elements,I_d=I_c[0],I_e=I_c[1],I_f=I_c[2],I_g=I_c[3],I_h=I_c[4],I_i=I_c[5],I_j=I_c[6],I_k=I_c[7],I_l=I_c[8],I_m=I_l*I_h-I_i*I_k,I_n=-I_l*I_g+I_i*I_j,I_o=I_k*I_g-I_h*I_j,I_p=I_d*I_m+I_e*I_n+I_f*I_o;I_p||(I_a=null),I_p=1/I_p,I_b[0]=I_m*I_p,I_b[1]=(-I_l*I_e+I_f*I_k)*I_p,I_b[2]=(I_i*I_e-I_f*I_h)*I_p,I_b[3]=I_n*I_p,I_b[4]=(I_l*I_d-I_f*I_j)*I_p,I_b[5]=(-I_i*I_d+I_f*I_g)*I_p,I_b[6]=I_o*I_p,I_b[7]=(-I_k*I_d+I_e*I_j)*I_p,I_b[8]=(I_h*I_d-I_e*I_g)*I_p},I_a.transpose=function(I_a){var I_b=I_a.elements,I_c=this.elements;if(I_a===this){var I_d=I_c[1],I_e=I_c[2],I_f=I_c[5];I_b[1]=I_c[3],I_b[2]=I_c[6],I_b[3]=I_d,I_b[5]=I_c[7],I_b[6]=I_e,I_b[7]=I_f}else I_b[0]=I_c[0],I_b[1]=I_c[3],I_b[2]=I_c[6],I_b[3]=I_c[1],I_b[4]=I_c[4],I_b[5]=I_c[7],I_b[6]=I_c[2],I_b[7]=I_c[5],I_b[8]=I_c[8]},I_a.identity=function(){var I_a=this.elements;I_a[0]=1,I_a[1]=0,I_a[2]=0,I_a[3]=0,I_a[4]=1,I_a[5]=0,I_a[6]=0,I_a[7]=0,I_a[8]=1},I_a.cloneTo=function(I_a){var I_b,I_c,I_d;if((I_c=this.elements)!==(I_d=I_a.elements))for(I_b=0;I_b<9;++I_b)I_d[I_b]=I_c[I_b]},I_a.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_i.createFromTranslation=function(I_a,I_b){I_b.elements;var I_c=I_a.elements;I_b[0]=1,I_b[1]=0,I_b[2]=0,I_b[3]=0,I_b[4]=1,I_b[5]=0,I_b[6]=I_c[0],I_b[7]=I_c[1],I_b[8]=1},I_i.createFromRotation=function(I_a,I_b){var I_c=I_b.elements,I_d=Math.sin(I_a),I_e=Math.cos(I_a);I_c[0]=I_e,I_c[1]=I_d,I_c[2]=0,I_c[3]=-I_d,I_c[4]=I_e,I_c[5]=0,I_c[6]=0,I_c[7]=0,I_c[8]=1},I_i.createFromScaling=function(I_a,I_b){var I_c=I_b.elements,I_d=I_a.elements;I_c[0]=I_d[0],I_c[1]=0,I_c[2]=0,I_c[3]=0,I_c[4]=I_d[1],I_c[5]=0,I_c[6]=0,I_c[7]=0,I_c[8]=1},I_i.createFromMatrix4x4=function(I_a,I_b){I_b[0]=I_a[0],I_b[1]=I_a[1],I_b[2]=I_a[2],I_b[3]=I_a[4],I_b[4]=I_a[5],I_b[5]=I_a[6],I_b[6]=I_a[8],I_b[7]=I_a[9],I_b[8]=I_a[10]},I_i.multiply=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements,I_g=I_e[0],I_h=I_e[1],I_i=I_e[2],I_j=I_e[3],I_k=I_e[4],I_l=I_e[5],I_m=I_e[6],I_n=I_e[7],I_o=I_e[8],I_p=I_f[0],I_s=I_f[1],I_t=I_f[2],I_u=I_f[3],I_v=I_f[4],I_w=I_f[5],I_x=I_f[6],I_y=I_f[7],I_z=I_f[8];I_d[0]=I_p*I_g+I_s*I_j+I_t*I_m,I_d[1]=I_p*I_h+I_s*I_k+I_t*I_n,I_d[2]=I_p*I_i+I_s*I_l+I_t*I_o,I_d[3]=I_u*I_g+I_v*I_j+I_w*I_m,I_d[4]=I_u*I_h+I_v*I_k+I_w*I_n,I_d[5]=I_u*I_i+I_v*I_l+I_w*I_o,I_d[6]=I_x*I_g+I_y*I_j+I_z*I_m,I_d[7]=I_x*I_h+I_y*I_k+I_z*I_n,I_d[8]=I_x*I_i+I_y*I_l+I_z*I_o},I_i.lookAt=function(I_a,I_b,I_c,I_d){I_gb.subtract(I_a,I_b,I_i._tempV30),I_gb.normalize(I_i._tempV30,I_i._tempV30),I_gb.cross(I_c,I_i._tempV30,I_i._tempV31),I_gb.normalize(I_i._tempV31,I_i._tempV31),I_gb.cross(I_i._tempV30,I_i._tempV31,I_i._tempV32);var I_e=I_i._tempV30.elements,I_f=I_i._tempV31.elements,I_g=I_i._tempV32.elements,I_h=I_d.elements;I_h[0]=I_f[0],I_h[3]=I_f[1],I_h[6]=I_f[2],I_h[1]=I_g[0],I_h[4]=I_g[1],I_h[7]=I_g[2],I_h[2]=I_e[0],I_h[5]=I_e[1],I_h[8]=I_e[2]},I_i.DEFAULT=new I_i,I_l(I_i,["_tempV30",function(){return this._tempV30=new I_gb},"_tempV31",function(){return this._tempV31=new I_gb},"_tempV32",function(){return this._tempV32=new I_gb}]),I_i}(),I_ab=function(){function I_B(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_l,I_m,I_n,I_o,I_p){void 0===I_a&&(I_a=1),void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=0),void 0===I_e&&(I_e=0),void 0===I_f&&(I_f=1),void 0===I_g&&(I_g=0),void 0===I_h&&(I_h=0),void 0===I_i&&(I_i=0),void 0===I_j&&(I_j=0),void 0===I_k&&(I_k=1),void 0===I_l&&(I_l=0),void 0===I_m&&(I_m=0),void 0===I_n&&(I_n=0),void 0===I_o&&(I_o=0),void 0===I_p&&(I_p=1);var I_s=this.elements=new Float32Array(16);I_s[0]=I_a,I_s[1]=I_b,I_s[2]=I_c,I_s[3]=I_d,I_s[4]=I_e,I_s[5]=I_f,I_s[6]=I_g,I_s[7]=I_h,I_s[8]=I_i,I_s[9]=I_j,I_s[10]=I_k,I_s[11]=I_l,I_s[12]=I_m,I_s[13]=I_n,I_s[14]=I_o,I_s[15]=I_p}I_n(I_B,"laya.d3.math.Matrix4x4");var I_a=I_B.prototype;return I_x.imps(I_a,{"laya.d3.core.IClone":!0}),I_a.getElementByRowColumn=function(I_a,I_b){if(I_a<0||3<I_a)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(I_b<0||3<I_b)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*I_a+I_b]},I_a.setElementByRowColumn=function(I_a,I_b,I_c){if(I_a<0||3<I_a)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(I_b<0||3<I_b)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*I_a+I_b]=I_c},I_a.equalsOtherMatrix=function(I_a){var I_b=this.elements,I_c=I_a.elements;return I_qa.nearEqual(I_b[0],I_c[0])&&I_qa.nearEqual(I_b[1],I_c[1])&&I_qa.nearEqual(I_b[2],I_c[2])&&I_qa.nearEqual(I_b[3],I_c[3])&&I_qa.nearEqual(I_b[4],I_c[4])&&I_qa.nearEqual(I_b[5],I_c[5])&&I_qa.nearEqual(I_b[6],I_c[6])&&I_qa.nearEqual(I_b[7],I_c[7])&&I_qa.nearEqual(I_b[8],I_c[8])&&I_qa.nearEqual(I_b[9],I_c[9])&&I_qa.nearEqual(I_b[10],I_c[10])&&I_qa.nearEqual(I_b[11],I_c[11])&&I_qa.nearEqual(I_b[12],I_c[12])&&I_qa.nearEqual(I_b[13],I_c[13])&&I_qa.nearEqual(I_b[14],I_c[14])&&I_qa.nearEqual(I_b[15],I_c[15])},I_a.decomposeTransRotScale=function(I_a,I_b,I_c){var I_d=I_B._tempMatrix4x4;return this.decomposeTransRotMatScale(I_a,I_d,I_c)?(I_cb.createFromMatrix4x4(I_d,I_b),!0):(I_b.identity(),!1)},I_a.decomposeTransRotMatScale=function(I_a,I_b,I_c){var I_d=this.elements,I_e=I_a.elements,I_f=I_b.elements,I_g=I_c.elements;I_e[0]=I_d[12],I_e[1]=I_d[13],I_e[2]=I_d[14];var I_h=I_d[0],I_i=I_d[1],I_j=I_d[2],I_k=I_d[4],I_l=I_d[5],I_m=I_d[6],I_n=I_d[8],I_o=I_d[9],I_p=I_d[10],I_s=I_g[0]=Math.sqrt(I_h*I_h+I_i*I_i+I_j*I_j),I_t=I_g[1]=Math.sqrt(I_k*I_k+I_l*I_l+I_m*I_m),I_u=I_g[2]=Math.sqrt(I_n*I_n+I_o*I_o+I_p*I_p);if(I_qa.isZero(I_s)||I_qa.isZero(I_t)||I_qa.isZero(I_u))return I_f[1]=I_f[2]=I_f[3]=I_f[4]=I_f[6]=I_f[7]=I_f[8]=I_f[9]=I_f[11]=I_f[12]=I_f[13]=I_f[14]=0,I_f[0]=I_f[5]=I_f[10]=I_f[15]=1,!1;var I_v=I_B._tempVector0,I_w=I_v.elements;I_w[0]=I_n/I_u,I_w[1]=I_o/I_u,I_w[2]=I_p/I_u;var I_x=I_B._tempVector1,I_y=I_x.elements;I_y[0]=I_h/I_s,I_y[1]=I_i/I_s,I_y[2]=I_j/I_s;var I_z=I_B._tempVector2;I_gb.cross(I_v,I_x,I_z);var I_A=I_B._tempVector1;return I_gb.cross(I_z,I_v,I_A),I_f[3]=I_f[7]=I_f[11]=I_f[12]=I_f[13]=I_f[14]=0,I_f[15]=1,I_f[0]=I_A.x,I_f[1]=I_A.y,I_f[2]=I_A.z,I_f[4]=I_z.x,I_f[5]=I_z.y,I_f[6]=I_z.z,I_f[8]=I_v.x,I_f[9]=I_v.y,I_f[10]=I_v.z,I_f[0]*I_h+I_f[1]*I_i+I_f[2]*I_j<0&&(I_g[0]=-I_s),I_f[4]*I_k+I_f[5]*I_l+I_f[6]*I_m<0&&(I_g[1]=-I_t),I_f[8]*I_n+I_f[9]*I_o+I_f[10]*I_p<0&&(I_g[2]=-I_u),!0},I_a.decomposeYawPitchRoll=function(I_a){var I_b=I_a.elements,I_c=Math.asin(-this.elements[9]);I_b[1]=I_c,Math.cos(I_c)>I_qa.zeroTolerance?(I_b[2]=Math.atan2(this.elements[1],this.elements[5]),I_b[0]=Math.atan2(this.elements[8],this.elements[10])):(I_b[2]=Math.atan2(-this.elements[4],this.elements[0]),I_b[0]=0)},I_a.normalize=function(){var I_a=this.elements,I_b=I_a[0],I_c=I_a[1],I_d=I_a[2],I_e=Math.sqrt(I_b*I_b+I_c*I_c+I_d*I_d);if(!I_e)return I_a[0]=0,I_a[1]=0,void(I_a[2]=0);1!=I_e&&(I_e=1/I_e,I_a[0]=I_b*I_e,I_a[1]=I_c*I_e,I_a[2]=I_d*I_e)},I_a.transpose=function(){var I_a,I_b;return I_b=(I_a=this.elements)[1],I_a[1]=I_a[4],I_a[4]=I_b,I_b=I_a[2],I_a[2]=I_a[8],I_a[8]=I_b,I_b=I_a[3],I_a[3]=I_a[12],I_a[12]=I_b,I_b=I_a[6],I_a[6]=I_a[9],I_a[9]=I_b,I_b=I_a[7],I_a[7]=I_a[13],I_a[13]=I_b,I_b=I_a[11],I_a[11]=I_a[14],I_a[14]=I_b,this},I_a.invert=function(I_a){var I_b=this.elements,I_c=I_a.elements,I_d=I_b[0],I_e=I_b[1],I_f=I_b[2],I_g=I_b[3],I_h=I_b[4],I_i=I_b[5],I_j=I_b[6],I_k=I_b[7],I_l=I_b[8],I_m=I_b[9],I_n=I_b[10],I_o=I_b[11],I_p=I_b[12],I_s=I_b[13],I_t=I_b[14],I_u=I_b[15],I_v=I_d*I_i-I_e*I_h,I_w=I_d*I_j-I_f*I_h,I_x=I_d*I_k-I_g*I_h,I_y=I_e*I_j-I_f*I_i,I_z=I_e*I_k-I_g*I_i,I_A=I_f*I_k-I_g*I_j,I_B=I_l*I_s-I_m*I_p,I_C=I_l*I_t-I_n*I_p,I_D=I_l*I_u-I_o*I_p,I_E=I_m*I_t-I_n*I_s,I_F=I_m*I_u-I_o*I_s,I_G=I_n*I_u-I_o*I_t,I_H=I_v*I_G-I_w*I_F+I_x*I_E+I_y*I_D-I_z*I_C+I_A*I_B;0!==Math.abs(I_H)&&(I_H=1/I_H,I_c[0]=(I_i*I_G-I_j*I_F+I_k*I_E)*I_H,I_c[1]=(I_f*I_F-I_e*I_G-I_g*I_E)*I_H,I_c[2]=(I_s*I_A-I_t*I_z+I_u*I_y)*I_H,I_c[3]=(I_n*I_z-I_m*I_A-I_o*I_y)*I_H,I_c[4]=(I_j*I_D-I_h*I_G-I_k*I_C)*I_H,I_c[5]=(I_d*I_G-I_f*I_D+I_g*I_C)*I_H,I_c[6]=(I_t*I_x-I_p*I_A-I_u*I_w)*I_H,I_c[7]=(I_l*I_A-I_n*I_x+I_o*I_w)*I_H,I_c[8]=(I_h*I_F-I_i*I_D+I_k*I_B)*I_H,I_c[9]=(I_e*I_D-I_d*I_F-I_g*I_B)*I_H,I_c[10]=(I_p*I_z-I_s*I_x+I_u*I_v)*I_H,I_c[11]=(I_m*I_x-I_l*I_z-I_o*I_v)*I_H,I_c[12]=(I_i*I_C-I_h*I_E-I_j*I_B)*I_H,I_c[13]=(I_d*I_E-I_e*I_C+I_f*I_B)*I_H,I_c[14]=(I_s*I_w-I_p*I_y-I_t*I_v)*I_H,I_c[15]=(I_l*I_y-I_m*I_w+I_n*I_v)*I_H)},I_a.identity=function(){var I_a=this.elements;I_a[1]=I_a[2]=I_a[3]=I_a[4]=I_a[6]=I_a[7]=I_a[8]=I_a[9]=I_a[11]=I_a[12]=I_a[13]=I_a[14]=0,I_a[0]=I_a[5]=I_a[10]=I_a[15]=1},I_a.cloneTo=function(I_a){var I_b,I_c,I_d;if((I_c=this.elements)!==(I_d=I_a.elements))for(I_b=0;I_b<16;++I_b)I_d[I_b]=I_c[I_b]},I_a.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_a.getTranslationVector=function(I_a){var I_b=this.elements,I_c=I_a.elements;I_c[0]=I_b[12],I_c[1]=I_b[13],I_c[2]=I_b[14]},I_a.setTranslationVector=function(I_a){var I_b=this.elements,I_c=I_a.elements;I_b[12]=I_c[0],I_b[13]=I_c[1],I_b[14]=I_c[2]},I_a.getForward=function(I_a){var I_b=this.elements,I_c=I_a.elements;I_c[0]=-I_b[8],I_c[1]=-I_b[9],I_c[2]=-I_b[10]},I_a.setForward=function(I_a){var I_b=this.elements,I_c=I_a.elements;I_b[8]=-I_c[0],I_b[9]=-I_c[1],I_b[10]=-I_c[2]},I_B.createRotationX=function(I_a,I_b){var I_c=I_b.elements,I_d=Math.sin(I_a),I_e=Math.cos(I_a);I_c[1]=I_c[2]=I_c[3]=I_c[4]=I_c[7]=I_c[8]=I_c[11]=I_c[12]=I_c[13]=I_c[14]=0,I_c[0]=I_c[15]=1,I_c[5]=I_c[10]=I_e,I_c[6]=I_d,I_c[9]=-I_d},I_B.createRotationY=function(I_a,I_b){var I_c=I_b.elements,I_d=Math.sin(I_a),I_e=Math.cos(I_a);I_c[1]=I_c[3]=I_c[4]=I_c[6]=I_c[7]=I_c[9]=I_c[11]=I_c[12]=I_c[13]=I_c[14]=0,I_c[5]=I_c[15]=1,I_c[0]=I_c[10]=I_e,I_c[2]=-I_d,I_c[8]=I_d},I_B.createRotationZ=function(I_a,I_b){var I_c=I_b.elements,I_d=Math.sin(I_a),I_e=Math.cos(I_a);I_c[2]=I_c[3]=I_c[6]=I_c[7]=I_c[8]=I_c[9]=I_c[11]=I_c[12]=I_c[13]=I_c[14]=0,I_c[10]=I_c[15]=1,I_c[0]=I_c[5]=I_e,I_c[1]=I_d,I_c[4]=-I_d},I_B.createRotationYawPitchRoll=function(I_a,I_b,I_c,I_d){I_cb.createFromYawPitchRoll(I_a,I_b,I_c,I_B._tempQuaternion),I_B.createRotationQuaternion(I_B._tempQuaternion,I_d)},I_B.createRotationAxis=function(I_a,I_b,I_c){var I_d=I_a.elements,I_e=I_d[0],I_f=I_d[1],I_g=I_d[2],I_h=Math.cos(I_b),I_i=Math.sin(I_b),I_j=I_e*I_e,I_k=I_f*I_f,I_l=I_g*I_g,I_m=I_e*I_f,I_n=I_e*I_g,I_o=I_f*I_g,I_p=I_c.elements;I_p[3]=I_p[7]=I_p[11]=I_p[12]=I_p[13]=I_p[14]=0,I_p[15]=1,I_p[0]=I_j+I_h*(1-I_j),I_p[1]=I_m-I_h*I_m+I_i*I_g,I_p[2]=I_n-I_h*I_n-I_i*I_f,I_p[4]=I_m-I_h*I_m-I_i*I_g,I_p[5]=I_k+I_h*(1-I_k),I_p[6]=I_o-I_h*I_o+I_i*I_e,I_p[8]=I_n-I_h*I_n+I_i*I_f,I_p[9]=I_o-I_h*I_o-I_i*I_e,I_p[10]=I_l+I_h*(1-I_l)},I_B.createRotationQuaternion=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements,I_e=I_c[0],I_f=I_c[1],I_g=I_c[2],I_h=I_c[3],I_i=I_e*I_e,I_j=I_f*I_f,I_k=I_g*I_g,I_l=I_e*I_f,I_m=I_g*I_h,I_n=I_g*I_e,I_o=I_f*I_h,I_p=I_f*I_g,I_s=I_e*I_h;I_d[3]=I_d[7]=I_d[11]=I_d[12]=I_d[13]=I_d[14]=0,I_d[15]=1,I_d[0]=1-2*(I_j+I_k),I_d[1]=2*(I_l+I_m),I_d[2]=2*(I_n-I_o),I_d[4]=2*(I_l-I_m),I_d[5]=1-2*(I_k+I_i),I_d[6]=2*(I_p+I_s),I_d[8]=2*(I_n+I_o),I_d[9]=2*(I_p-I_s),I_d[10]=1-2*(I_j+I_i)},I_B.createTranslate=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements;I_d[4]=I_d[8]=I_d[1]=I_d[9]=I_d[2]=I_d[6]=I_d[3]=I_d[7]=I_d[11]=0,I_d[0]=I_d[5]=I_d[10]=I_d[15]=1,I_d[12]=I_c[0],I_d[13]=I_c[1],I_d[14]=I_c[2]},I_B.createScaling=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements;I_d[0]=I_c[0],I_d[5]=I_c[1],I_d[10]=I_c[2],I_d[1]=I_d[4]=I_d[8]=I_d[12]=I_d[9]=I_d[13]=I_d[2]=I_d[6]=I_d[14]=I_d[3]=I_d[7]=I_d[11]=0,I_d[15]=1},I_B.multiply=function(I_a,I_b,I_c){var I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k;for(I_e=I_c.elements,I_f=I_a.elements,I_e===(I_g=I_b.elements)&&(I_g=I_g.slice()),I_d=0;I_d<4;I_d++)I_h=I_f[I_d],I_i=I_f[I_d+4],I_j=I_f[I_d+8],I_k=I_f[I_d+12],I_e[I_d]=I_h*I_g[0]+I_i*I_g[1]+I_j*I_g[2]+I_k*I_g[3],I_e[I_d+4]=I_h*I_g[4]+I_i*I_g[5]+I_j*I_g[6]+I_k*I_g[7],I_e[I_d+8]=I_h*I_g[8]+I_i*I_g[9]+I_j*I_g[10]+I_k*I_g[11],I_e[I_d+12]=I_h*I_g[12]+I_i*I_g[13]+I_j*I_g[14]+I_k*I_g[15]},I_B.createFromQuaternion=function(I_a,I_b){var I_c=I_b.elements,I_d=I_a.elements,I_e=I_d[0],I_f=I_d[1],I_g=I_d[2],I_h=I_d[3],I_i=I_e+I_e,I_j=I_f+I_f,I_k=I_g+I_g,I_l=I_e*I_i,I_m=I_f*I_i,I_n=I_f*I_j,I_o=I_g*I_i,I_p=I_g*I_j,I_s=I_g*I_k,I_t=I_h*I_i,I_u=I_h*I_j,I_v=I_h*I_k;I_c[0]=1-I_n-I_s,I_c[1]=I_m+I_v,I_c[2]=I_o-I_u,I_c[3]=0,I_c[4]=I_m-I_v,I_c[5]=1-I_l-I_s,I_c[6]=I_p+I_t,I_c[7]=0,I_c[8]=I_o+I_u,I_c[9]=I_p-I_t,I_c[10]=1-I_l-I_n,I_c[11]=0,I_c[12]=0,I_c[13]=0,I_c[14]=0,I_c[15]=1},I_B.createAffineTransformation=function(I_a,I_b,I_c,I_d){var I_e=I_a.elements,I_f=I_b.elements,I_g=I_c.elements,I_h=I_d.elements,I_i=I_f[0],I_j=I_f[1],I_k=I_f[2],I_l=I_f[3],I_m=I_i+I_i,I_n=I_j+I_j,I_o=I_k+I_k,I_p=I_i*I_m,I_s=I_i*I_n,I_t=I_i*I_o,I_u=I_j*I_n,I_v=I_j*I_o,I_w=I_k*I_o,I_x=I_l*I_m,I_y=I_l*I_n,I_z=I_l*I_o,I_A=I_g[0],I_B=I_g[1],I_C=I_g[2];I_h[0]=(1-(I_u+I_w))*I_A,I_h[1]=(I_s+I_z)*I_A,I_h[2]=(I_t-I_y)*I_A,I_h[3]=0,I_h[4]=(I_s-I_z)*I_B,I_h[5]=(1-(I_p+I_w))*I_B,I_h[6]=(I_v+I_x)*I_B,I_h[7]=0,I_h[8]=(I_t+I_y)*I_C,I_h[9]=(I_v-I_x)*I_C,I_h[10]=(1-(I_p+I_u))*I_C,I_h[11]=0,I_h[12]=I_e[0],I_h[13]=I_e[1],I_h[14]=I_e[2],I_h[15]=1},I_B.createLookAt=function(I_a,I_b,I_c,I_d){var I_e=I_d.elements,I_f=I_B._tempVector0,I_g=I_B._tempVector1,I_h=I_B._tempVector2;I_gb.subtract(I_a,I_b,I_h),I_gb.normalize(I_h,I_h),I_gb.cross(I_c,I_h,I_f),I_gb.normalize(I_f,I_f),I_gb.cross(I_h,I_f,I_g),I_d.identity(),I_e[0]=I_f.x,I_e[4]=I_f.y,I_e[8]=I_f.z,I_e[1]=I_g.x,I_e[5]=I_g.y,I_e[9]=I_g.z,I_e[2]=I_h.x,I_e[6]=I_h.y,I_e[10]=I_h.z,I_e[12]=-I_gb.dot(I_f,I_a),I_e[13]=-I_gb.dot(I_g,I_a),I_e[14]=-I_gb.dot(I_h,I_a)},I_B.createPerspective=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_e.elements,I_g=1/Math.tan(I_a/2),I_h=1/(I_c-I_d);I_f[0]=I_g/I_b,I_f[5]=I_g,I_f[10]=(I_d+I_c)*I_h,I_f[11]=-1,I_f[14]=2*I_d*I_c*I_h,I_f[1]=I_f[2]=I_f[3]=I_f[4]=I_f[6]=I_f[7]=I_f[8]=I_f[9]=I_f[12]=I_f[13]=I_f[15]=0},I_B.createOrthoOffCenterRH=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){var I_h=I_g.elements,I_i=1/(I_a-I_b),I_j=1/(I_c-I_d),I_k=1/(I_e-I_f);I_h[1]=I_h[2]=I_h[3]=I_h[4]=I_h[6]=I_h[7]=I_h[8]=I_h[9]=I_h[11]=0,I_h[15]=1,I_h[0]=-2*I_i,I_h[5]=-2*I_j,I_h[10]=2*I_k,I_h[12]=(I_a+I_b)*I_i,I_h[13]=(I_d+I_c)*I_j,I_h[14]=(I_f+I_e)*I_k},I_B.translation=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements;I_d[0]=I_d[5]=I_d[10]=I_d[15]=1,I_d[12]=I_c[0],I_d[13]=I_c[1],I_d[14]=I_c[2]},I_l(I_B,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new I_B},"_tempVector0",function(){return this._tempVector0=new I_gb},"_tempVector1",function(){return this._tempVector1=new I_gb},"_tempVector2",function(){return this._tempVector2=new I_gb},"_tempQuaternion",function(){return this._tempQuaternion=new I_cb},"DEFAULT",function(){return this.DEFAULT=new I_B},"ZERO",function(){return this.ZERO=new I_B(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),I_B}(),I_bb=(function(){function I_v(I_a,I_b){this.extents=null,this.transformation=null,this.extents=I_a,this.transformation=I_b}I_n(I_v,"laya.d3.math.OrientedBoundBox");var I_a=I_v.prototype;I_a.getCorners=function(I_a){var I_b=I_v._tempV30.elements,I_c=I_v._tempV31.elements,I_d=I_v._tempV32.elements,I_e=this.extents.elements;I_b[0]=I_e[0],I_b[1]=I_b[2]=0,I_c[1]=I_e[1],I_c[0]=I_c[2]=0,I_d[2]=I_e[2],I_d[0]=I_d[1]=0,I_gb.TransformNormal(I_v._tempV30,this.transformation,I_v._tempV30),I_gb.TransformNormal(I_v._tempV31,this.transformation,I_v._tempV31),I_gb.TransformNormal(I_v._tempV32,this.transformation,I_v._tempV32);var I_f=I_v._tempV33;this.transformation.getTranslationVector(I_f),I_a.length=8,I_gb.add(I_f,I_v._tempV30,I_v._tempV34),I_gb.add(I_v._tempV34,I_v._tempV31,I_v._tempV34),I_gb.add(I_v._tempV34,I_v._tempV32,I_a[0]),I_gb.add(I_f,I_v._tempV30,I_v._tempV34),I_gb.add(I_v._tempV34,I_v._tempV31,I_v._tempV34),I_gb.subtract(I_v._tempV34,I_v._tempV32,I_a[1]),I_gb.subtract(I_f,I_v._tempV30,I_v._tempV34),I_gb.add(I_v._tempV34,I_v._tempV31,I_v._tempV34),I_gb.subtract(I_v._tempV34,I_v._tempV32,I_a[2]),I_gb.subtract(I_f,I_v._tempV30,I_v._tempV34),I_gb.add(I_v._tempV34,I_v._tempV31,I_v._tempV34),I_gb.add(I_v._tempV34,I_v._tempV32,I_a[3]),I_gb.add(I_f,I_v._tempV30,I_v._tempV34),I_gb.subtract(I_v._tempV34,I_v._tempV31,I_v._tempV34),I_gb.add(I_v._tempV34,I_v._tempV32,I_a[4]),I_gb.add(I_f,I_v._tempV30,I_v._tempV34),I_gb.subtract(I_v._tempV34,I_v._tempV31,I_v._tempV34),I_gb.subtract(I_v._tempV34,I_v._tempV32,I_a[5]),I_gb.subtract(I_f,I_v._tempV30,I_v._tempV34),I_gb.subtract(I_v._tempV34,I_v._tempV31,I_v._tempV34),I_gb.subtract(I_v._tempV34,I_v._tempV32,I_a[6]),I_gb.subtract(I_f,I_v._tempV30,I_v._tempV34),I_gb.subtract(I_v._tempV34,I_v._tempV31,I_v._tempV34),I_gb.add(I_v._tempV34,I_v._tempV32,I_a[7])},I_a.transform=function(I_a){I_ab.multiply(this.transformation,I_a,this.transformation)},I_a.scale=function(I_a){I_gb.multiply(this.extents,I_a,this.extents)},I_a.translate=function(I_a){this.transformation.getTranslationVector(I_v._tempV30),I_gb.add(I_v._tempV30,I_a,I_v._tempV31),this.transformation.setTranslationVector(I_v._tempV31)},I_a.Size=function(I_a){I_gb.scale(this.extents,2,I_a)},I_a.getSize=function(I_a){var I_b=this.extents.elements;I_v._tempV30.x=I_b[0],I_v._tempV31.y=I_b[1],I_v._tempV32.z=I_b[2],I_gb.TransformNormal(I_v._tempV30,this.transformation,I_v._tempV30),I_gb.TransformNormal(I_v._tempV31,this.transformation,I_v._tempV31),I_gb.TransformNormal(I_v._tempV31,this.transformation,I_v._tempV32);var I_c=I_a.elements;I_c[0]=I_gb.scalarLength(I_v._tempV30),I_c[1]=I_gb.scalarLength(I_v._tempV31),I_c[2]=I_gb.scalarLength(I_v._tempV32)},I_a.getSizeSquared=function(I_a){var I_b=this.extents.elements;I_v._tempV30.x=I_b[0],I_v._tempV31.y=I_b[1],I_v._tempV32.z=I_b[2],I_gb.TransformNormal(I_v._tempV30,this.transformation,I_v._tempV30),I_gb.TransformNormal(I_v._tempV31,this.transformation,I_v._tempV31),I_gb.TransformNormal(I_v._tempV31,this.transformation,I_v._tempV32);var I_c=I_a.elements;I_c[0]=I_gb.scalarLengthSquared(I_v._tempV30),I_c[1]=I_gb.scalarLengthSquared(I_v._tempV31),I_c[2]=I_gb.scalarLengthSquared(I_v._tempV32)},I_a.getCenter=function(I_a){this.transformation.getTranslationVector(I_a)},I_a.containsPoint=function(I_a){var I_b=this.extents.elements,I_c=I_b[0],I_d=I_b[1],I_e=I_b[2];this.transformation.invert(I_v._tempM0),I_gb.transformCoordinate(I_a,I_v._tempM0,I_v._tempV30);var I_f=I_v._tempV30.elements,I_g=Math.abs(I_f[0]),I_h=Math.abs(I_f[1]),I_i=Math.abs(I_f[2]);return I_qa.nearEqual(I_g,I_c)&&I_qa.nearEqual(I_h,I_d)&&I_qa.nearEqual(I_i,I_e)?2:I_g<I_c&&I_h<I_d&&I_i<I_e?1:0},I_a.containsPoints=function(I_a){var I_b=this.extents.elements,I_c=I_b[0],I_d=I_b[1],I_e=I_b[2];this.transformation.invert(I_v._tempM0);for(var I_f=!0,I_g=!1,I_h=0;I_h<I_a.length;I_h++){I_gb.transformCoordinate(I_a[I_h],I_v._tempM0,I_v._tempV30);var I_i=I_v._tempV30.elements,I_j=Math.abs(I_i[0]),I_k=Math.abs(I_i[1]),I_l=Math.abs(I_i[2]);I_qa.nearEqual(I_j,I_c)&&I_qa.nearEqual(I_k,I_d)&&I_qa.nearEqual(I_l,I_e)&&(I_g=!0),I_j<I_c&&I_k<I_d&&I_l<I_e?I_g=!0:I_f=!1}return I_f?1:I_g?2:0},I_a.containsSphere=function(I_a,I_b){void 0===I_b&&(I_b=!1);var I_c=this.extents.elements,I_d=I_c[0],I_e=I_c[1],I_f=I_c[2],I_g=I_a.radius;this.transformation.invert(I_v._tempM0),I_gb.transformCoordinate(I_a.center,I_v._tempM0,I_v._tempV30);var I_h=NaN;if(I_h=I_b?I_g:(I_gb.scale(I_gb.UnitX,I_g,I_v._tempV31),I_gb.TransformNormal(I_v._tempV31,I_v._tempM0,I_v._tempV31),I_gb.scalarLength(I_v._tempV31)),I_gb.scale(this.extents,-1,I_v._tempV32),I_gb.Clamp(I_v._tempV30,I_v._tempV32,this.extents,I_v._tempV33),I_h*I_h<I_gb.distanceSquared(I_v._tempV30,I_v._tempV33))return 0;var I_i=I_v._tempV30.elements,I_j=I_i[0],I_k=I_i[1],I_l=I_i[2],I_m=I_v._tempV32.elements,I_n=I_m[0],I_o=I_m[1],I_p=I_m[2];return I_n+I_h<=I_j&&I_j<=I_d-I_h&&I_h<I_d-I_n&&I_o+I_h<=I_k&&I_k<=I_e-I_h&&I_h<I_e-I_o&&I_p+I_h<=I_l&&I_l<=I_f-I_h&&I_h<I_f-I_p?1:2},I_a.containsOrientedBoundBox=function(I_a){var I_b=0,I_c=0;I_a.getCorners(I_v._corners);var I_d=this.containsPoints(I_v._corners);if(0!=I_d)return I_d;var I_e=this.extents.elements;I_a.extents.cloneTo(I_v._tempV35);var I_f=I_v._tempV35.elements;I_v._getRows(this.transformation,I_v._rows1),I_v._getRows(I_a.transformation,I_v._rows2);var I_g=NaN;for(I_b=0;I_b<4;I_b++)for(I_c=0;I_c<4;I_c++)3==I_b||3==I_c?(I_v._tempM0.setElementByRowColumn(I_b,I_c,0),I_v._tempM1.setElementByRowColumn(I_b,I_c,0)):(I_g=I_gb.dot(I_v._rows1[I_b],I_v._rows2[I_c]),I_v._tempM0.setElementByRowColumn(I_b,I_c,I_g),I_v._tempM1.setElementByRowColumn(I_b,I_c,Math.abs(I_g)));I_a.getCenter(I_v._tempV34),this.getCenter(I_v._tempV36),I_gb.subtract(I_v._tempV34,I_v._tempV36,I_v._tempV30);var I_h=I_v._tempV31.elements;I_h[0]=I_gb.dot(I_v._tempV30,I_v._rows1[0]),I_h[1]=I_gb.dot(I_v._tempV30,I_v._rows1[1]),I_h[2]=I_gb.dot(I_v._tempV30,I_v._rows1[2]);var I_i=I_v._tempV32.elements,I_j=I_v._tempV33.elements;for(I_b=0;I_b<3;I_b++)if(I_i[0]=I_v._tempM1.getElementByRowColumn(I_b,0),I_i[1]=I_v._tempM1.getElementByRowColumn(I_b,1),I_i[2]=I_v._tempM1.getElementByRowColumn(I_b,2),I_e[I_b]+I_gb.dot(I_v._tempV35,I_v._tempV32)<Math.abs(I_h[I_b]))return 0;for(I_c=0;I_c<3;I_c++)if(I_i[0]=I_v._tempM1.getElementByRowColumn(0,I_c),I_i[1]=I_v._tempM1.getElementByRowColumn(1,I_c),I_i[2]=I_v._tempM1.getElementByRowColumn(2,I_c),I_j[0]=I_v._tempM0.getElementByRowColumn(0,I_c),I_j[1]=I_v._tempM0.getElementByRowColumn(1,I_c),I_j[2]=I_v._tempM0.getElementByRowColumn(2,I_c),I_gb.dot(this.extents,I_v._tempV32)+I_f[I_c]<Math.abs(I_gb.dot(I_v._tempV31,I_v._tempV33)))return 0;for(I_b=0;I_b<3;I_b++)for(I_c=0;I_c<3;I_c++){var I_k=(I_b+1)%3,I_l=(I_b+2)%3,I_m=(I_c+1)%3,I_n=(I_c+2)%3;if(I_e[I_k]*I_v._tempM1.getElementByRowColumn(I_l,I_c)+I_e[I_l]*I_v._tempM1.getElementByRowColumn(I_k,I_c)+(I_f[I_m]*I_v._tempM1.getElementByRowColumn(I_b,I_n)+I_f[I_n]*I_v._tempM1.getElementByRowColumn(I_b,I_m))<Math.abs(I_h[I_l]*I_v._tempM0.getElementByRowColumn(I_k,I_c)-I_h[I_k]*I_v._tempM0.getElementByRowColumn(I_l,I_c)))return 0}return 2},I_a.containsLine=function(I_a,I_b){I_v._corners[0]=I_a,I_v._corners[1]=I_b;var I_c=this.containsPoints(I_v._corners);if(0!=I_c)return I_c;var I_d=this.extents.elements,I_e=I_d[0],I_f=I_d[1],I_g=I_d[2];this.transformation.invert(I_v._tempM0),I_gb.transformCoordinate(I_a,I_v._tempM0,I_v._tempV30),I_gb.transformCoordinate(I_b,I_v._tempM0,I_v._tempV31),I_gb.add(I_v._tempV30,I_v._tempV31,I_v._tempV32),I_gb.scale(I_v._tempV32,.5,I_v._tempV32),I_gb.subtract(I_v._tempV30,I_v._tempV32,I_v._tempV33);var I_h=I_v._tempV33.elements,I_i=I_h[0],I_j=I_h[1],I_k=I_h[2],I_l=I_v._tempV34.elements,I_m=I_l[0]=Math.abs(I_h[0]),I_n=I_l[1]=Math.abs(I_h[1]),I_o=I_l[2]=Math.abs(I_h[2]),I_p=I_v._tempV32.elements,I_s=I_p[0],I_t=I_p[1],I_u=I_p[2];return Math.abs(I_s)>I_e+I_m?0:Math.abs(I_t)>I_f+I_n?0:Math.abs(I_u)>I_g+I_o?0:Math.abs(I_t*I_k-I_u*I_j)>I_f*I_o+I_g*I_n?0:Math.abs(I_s*I_k-I_u*I_i)>I_e*I_o+I_g*I_m?0:Math.abs(I_s*I_j-I_t*I_i)>I_e*I_n+I_f*I_m?0:2},I_a.containsBoundBox=function(I_a){var I_b=0,I_c=0,I_d=I_a.min,I_e=I_a.max;I_a.getCorners(I_v._corners);var I_f=this.containsPoints(I_v._corners);if(0!=I_f)return I_f;I_gb.subtract(I_e,I_d,I_v._tempV30),I_gb.scale(I_v._tempV30,.5,I_v._tempV30),I_gb.add(I_d,I_v._tempV30,I_v._tempV30),I_gb.subtract(I_e,I_v._tempV30,I_v._tempV31);var I_g=this.extents.elements,I_h=I_v._tempV31.elements;I_v._getRows(this.transformation,I_v._rows1),this.transformation.invert(I_v._tempM0);for(I_b=0;I_b<3;I_b++)for(I_c=0;I_c<3;I_c++)I_v._tempM1.setElementByRowColumn(I_b,I_c,Math.abs(I_v._tempM0.getElementByRowColumn(I_b,I_c)));this.getCenter(I_v._tempV35),I_gb.subtract(I_v._tempV30,I_v._tempV35,I_v._tempV32);var I_i=I_v._tempV31.elements;I_i[0]=I_gb.dot(I_v._tempV32,I_v._rows1[0]),I_i[1]=I_gb.dot(I_v._tempV32,I_v._rows1[1]),I_i[2]=I_gb.dot(I_v._tempV32,I_v._rows1[2]);var I_j=I_v._tempV33.elements,I_k=I_v._tempV34.elements;for(I_b=0;I_b<3;I_b++)if(I_j[0]=I_v._tempM1.getElementByRowColumn(I_b,0),I_j[1]=I_v._tempM1.getElementByRowColumn(I_b,1),I_j[2]=I_v._tempM1.getElementByRowColumn(I_b,2),I_g[I_b]+I_gb.dot(I_v._tempV31,I_v._tempV33)<Math.abs(I_i[I_b]))return 0;for(I_c=0;I_c<3;I_c++)if(I_j[0]=I_v._tempM1.getElementByRowColumn(0,I_c),I_j[1]=I_v._tempM1.getElementByRowColumn(1,I_c),I_j[2]=I_v._tempM1.getElementByRowColumn(2,I_c),I_k[0]=I_v._tempM0.getElementByRowColumn(0,I_c),I_k[1]=I_v._tempM0.getElementByRowColumn(1,I_c),I_k[2]=I_v._tempM0.getElementByRowColumn(2,I_c),I_gb.dot(this.extents,I_v._tempV33)+I_h[I_c]<Math.abs(I_gb.dot(I_v._tempV31,I_v._tempV34)))return 0;for(I_b=0;I_b<3;I_b++)for(I_c=0;I_c<3;I_c++){var I_l=(I_b+1)%3,I_m=(I_b+2)%3,I_n=(I_c+1)%3,I_o=(I_c+2)%3;if(I_g[I_l]*I_v._tempM1.getElementByRowColumn(I_m,I_c)+I_g[I_m]*I_v._tempM1.getElementByRowColumn(I_l,I_c)+(I_h[I_n]*I_v._tempM1.getElementByRowColumn(I_b,I_o)+I_h[I_o]*I_v._tempM1.getElementByRowColumn(I_b,I_n))<Math.abs(I_i[I_m]*I_v._tempM0.getElementByRowColumn(I_l,I_c)-I_i[I_l]*I_v._tempM0.getElementByRowColumn(I_m,I_c)))return 0}return 2},I_a.intersectsRay=function(I_a,I_b){I_gb.scale(this.extents,-1,I_v._tempV30),this.transformation.invert(I_v._tempM0),I_gb.TransformNormal(I_a.direction,I_v._tempM0,I_v._ray.direction),I_gb.transformCoordinate(I_a.origin,I_v._tempM0,I_v._ray.origin),I_v._boxBound1.min=I_v._tempV30,I_v._boxBound1.max=this.extents;var I_c=Collision.intersectsRayAndBoxRP(I_v._ray,I_v._boxBound1,I_b);return-1!==I_c&&I_gb.transformCoordinate(I_b,this.transformation,I_b),I_c},I_a._getLocalCorners=function(I_a){I_a.length=8;var I_b=this.extents.elements;I_v._tempV30.x=I_b[0],I_v._tempV31.y=I_b[1],I_v._tempV32.z=I_b[2],I_gb.add(I_v._tempV30,I_v._tempV31,I_v._tempV33),I_gb.add(I_v._tempV33,I_v._tempV32,I_a[0]),I_gb.add(I_v._tempV30,I_v._tempV31,I_v._tempV33),I_gb.subtract(I_v._tempV33,I_v._tempV32,I_a[1]),I_gb.subtract(I_v._tempV31,I_v._tempV30,I_v._tempV33),I_gb.subtract(I_v._tempV33,I_v._tempV30,I_a[2]),I_gb.subtract(I_v._tempV31,I_v._tempV30,I_v._tempV33),I_gb.add(I_v._tempV33,I_v._tempV32,I_a[3]),I_gb.subtract(I_v._tempV30,I_v._tempV31,I_v._tempV33),I_gb.add(I_v._tempV33,I_v._tempV32,I_a[4]),I_gb.subtract(I_v._tempV30,I_v._tempV31,I_v._tempV33),I_gb.subtract(I_v._tempV33,I_v._tempV32,I_a[5]),I_gb.scale(I_a[0],-1,I_a[6]),I_gb.subtract(I_v._tempV32,I_v._tempV30,I_v._tempV33),I_gb.subtract(I_v._tempV33,I_v._tempV31,I_a[7])},I_a.equals=function(I_a){return this.extents==I_a.extents&&this.transformation==I_a.transformation},I_a.cloneTo=function(I_a){var I_b=I_a;this.extents.cloneTo(I_b.extents),this.transformation.cloneTo(I_b.transformation)},I_v.createByBoundBox=function(I_a,I_b){var I_c=I_a.min,I_d=I_a.max;I_gb.subtract(I_d,I_c,I_v._tempV30),I_gb.scale(I_v._tempV30,.5,I_v._tempV30),I_gb.add(I_c,I_v._tempV30,I_v._tempV31),I_gb.subtract(I_d,I_v._tempV31,I_v._tempV32),I_ab.translation(I_v._tempV31,I_v._tempM0);var I_e=I_v._tempV32.clone(),I_f=I_v._tempM0.clone();I_b.extents=I_e,I_b.transformation=I_f},I_v.createByMinAndMaxVertex=function(I_a,I_b){return I_gb.subtract(I_b,I_a,I_v._tempV30),I_gb.scale(I_v._tempV30,.5,I_v._tempV30),I_gb.add(I_a,I_v._tempV30,I_v._tempV31),I_gb.subtract(I_b,I_v._tempV31,I_v._tempV32),I_ab.translation(I_v._tempV31,I_v._tempM0),new I_v(I_v._tempV32,I_v._tempM0)},I_v._getRows=function(I_a,I_b){I_b.length=3;var I_c=I_a.elements,I_d=I_b[0].elements;I_d[0]=I_c[0],I_d[1]=I_c[1],I_d[2]=I_c[2];var I_e=I_b[1].elements;I_e[0]=I_c[4],I_e[1]=I_c[5],I_e[2]=I_c[6];var I_f=I_b[2].elements;I_f[0]=I_c[8],I_f[1]=I_c[9],I_f[2]=I_c[10]},I_v.getObbtoObbMatrix4x4=function(I_a,I_b,I_c,I_d){var I_e=I_a.transformation,I_f=I_b.transformation;if(I_c){I_v._getRows(I_e,I_v._rows1),I_v._getRows(I_f,I_v._rows2);for(var I_g=0;I_g<3;I_g++)for(var I_h=0;I_h<3;I_h++)I_d.setElementByRowColumn(I_g,I_h,I_gb.dot(I_v._rows2[I_g],I_v._rows1[I_h]));I_b.getCenter(I_v._tempV30),I_a.getCenter(I_v._tempV31),I_gb.subtract(I_v._tempV30,I_v._tempV31,I_v._tempV32);var I_i=I_d.elements;I_i[12]=I_gb.dot(I_v._tempV32,I_v._rows1[0]),I_i[13]=I_gb.dot(I_v._tempV32,I_v._rows1[1]),I_i[14]=I_gb.dot(I_v._tempV32,I_v._rows1[2]),I_i[15]=1}else I_e.invert(I_v._tempM0),I_ab.multiply(I_f,I_v._tempM0,I_d)},I_v.merge=function(I_a,I_b,I_c){var I_d=I_a.extents,I_e=I_a.transformation;I_v.getObbtoObbMatrix4x4(I_a,I_b,I_c,I_v._tempM0),I_b._getLocalCorners(I_v._corners),I_gb.transformCoordinate(I_v._corners[0],I_v._tempM0,I_v._corners[0]),I_gb.transformCoordinate(I_v._corners[1],I_v._tempM0,I_v._corners[1]),I_gb.transformCoordinate(I_v._corners[2],I_v._tempM0,I_v._corners[2]),I_gb.transformCoordinate(I_v._corners[3],I_v._tempM0,I_v._corners[3]),I_gb.transformCoordinate(I_v._corners[4],I_v._tempM0,I_v._corners[4]),I_gb.transformCoordinate(I_v._corners[5],I_v._tempM0,I_v._corners[5]),I_gb.transformCoordinate(I_v._corners[6],I_v._tempM0,I_v._corners[6]),I_gb.transformCoordinate(I_v._corners[7],I_v._tempM0,I_v._corners[7]),I_gb.scale(I_d,-1,I_v._boxBound1.min),I_d.cloneTo(I_v._boxBound1.max),I_Za.createfromPoints(I_v._corners,I_v._boxBound2),I_Za.merge(I_v._boxBound2,I_v._boxBound1,I_v._boxBound3);var I_f=I_v._boxBound3.min,I_g=I_v._boxBound3.max;I_gb.subtract(I_g,I_f,I_v._tempV30),I_gb.scale(I_v._tempV30,.5,I_v._tempV30),I_gb.add(I_f,I_v._tempV30,I_v._tempV32),I_gb.subtract(I_g,I_v._tempV32,I_d),I_gb.transformCoordinate(I_v._tempV32,I_e,I_v._tempV33)},I_l(I_v,["_tempV30",function(){return this._tempV30=new I_gb},"_tempV31",function(){return this._tempV31=new I_gb},"_tempV32",function(){return this._tempV32=new I_gb},"_tempV33",function(){return this._tempV33=new I_gb},"_tempV34",function(){return this._tempV34=new I_gb},"_tempV35",function(){return this._tempV35=new I_gb},"_tempV36",function(){return this._tempV36=new I_gb},"_tempM0",function(){return this._tempM0=new I_ab},"_tempM1",function(){return this._tempM1=new I_ab},"_corners",function(){return this._corners=[new I_gb,new I_gb,new I_gb,new I_gb,new I_gb,new I_gb,new I_gb,new I_gb]},"_rows1",function(){return this._rows1=[new I_gb,new I_gb,new I_gb]},"_rows2",function(){return this._rows2=[new I_gb,new I_gb,new I_gb]},"_ray",function(){return this._ray=new I_eb(new I_gb,new I_gb)},"_boxBound1",function(){return this._boxBound1=new I_Za(new I_gb,new I_gb)},"_boxBound2",function(){return this._boxBound2=new I_Za(new I_gb,new I_gb)},"_boxBound3",function(){return this._boxBound3=new I_Za(new I_gb,new I_gb)}])}(),function(){function I_x(I_a,I_b){this.normal=null,this.distance=NaN,void 0===I_b&&(I_b=0),this.normal=I_a,this.distance=I_b}return I_n(I_x,"laya.d3.math.Plane"),I_x.prototype.normalize=function(){var I_a=this.normal.elements,I_b=I_a[0],I_c=I_a[1],I_d=I_a[2],I_e=1/Math.sqrt(I_b*I_b+I_c*I_c+I_d*I_d);I_a[0]=I_b*I_e,I_a[1]=I_c*I_e,I_a[2]=I_d*I_e,this.distance*=I_e},I_x.createPlaneBy3P=function(I_a,I_b,I_c){var I_d=I_a.elements,I_e=I_b.elements,I_f=I_c.elements,I_g=I_e[0]-I_d[0],I_h=I_e[1]-I_d[1],I_i=I_e[2]-I_d[2],I_j=I_f[0]-I_d[0],I_k=I_f[1]-I_d[1],I_l=I_f[2]-I_d[2],I_m=I_h*I_l-I_i*I_k,I_n=I_i*I_j-I_g*I_l,I_o=I_g*I_k-I_h*I_j,I_p=1/Math.sqrt(I_m*I_m+I_n*I_n+I_o*I_o),I_s=I_m*I_p,I_t=I_n*I_p,I_u=I_o*I_p,I_v=I_x._TEMPVec3.elements;I_v[0]=I_s,I_v[1]=I_t,I_v[2]=I_u;var I_w=-(I_s*I_d[0]+I_t*I_d[1]+I_u*I_d[2]);return new I_x(I_x._TEMPVec3,I_w)},I_x.PlaneIntersectionType_Back=0,I_x.PlaneIntersectionType_Front=1,I_x.PlaneIntersectionType_Intersecting=2,I_l(I_x,["_TEMPVec3",function(){return this._TEMPVec3=new I_gb}]),I_x}()),I_cb=function(){function I_e(I_a,I_b,I_c,I_d){this.elements=new Float32Array(4),void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=1),this.elements[0]=I_a,this.elements[1]=I_b,this.elements[2]=I_c,this.elements[3]=I_d}I_n(I_e,"laya.d3.math.Quaternion");var I_a=I_e.prototype;return I_x.imps(I_a,{"laya.d3.core.IClone":!0}),I_a.scaling=function(I_a,I_b){var I_c=I_b.elements,I_d=this.elements;I_c[0]=I_d[0]*I_a,I_c[1]=I_d[1]*I_a,I_c[2]=I_d[2]*I_a,I_c[3]=I_d[3]*I_a},I_a.normalize=function(I_a){var I_b=I_a.elements,I_c=this.elements,I_d=I_c[0],I_e=I_c[1],I_f=I_c[2],I_g=I_c[3],I_h=I_d*I_d+I_e*I_e+I_f*I_f+I_g*I_g;0<I_h&&(I_h=1/Math.sqrt(I_h),I_b[0]=I_d*I_h,I_b[1]=I_e*I_h,I_b[2]=I_f*I_h,I_b[3]=I_g*I_h)},I_a.length=function(){var I_a=this.elements,I_b=I_a[0],I_c=I_a[1],I_d=I_a[2],I_e=I_a[3];return Math.sqrt(I_b*I_b+I_c*I_c+I_d*I_d+I_e*I_e)},I_a.rotateX=function(I_a,I_b){var I_c=I_b.elements,I_d=this.elements;I_a*=.5;var I_e=I_d[0],I_f=I_d[1],I_g=I_d[2],I_h=I_d[3],I_i=Math.sin(I_a),I_j=Math.cos(I_a);I_c[0]=I_e*I_j+I_h*I_i,I_c[1]=I_f*I_j+I_g*I_i,I_c[2]=I_g*I_j-I_f*I_i,I_c[3]=I_h*I_j-I_e*I_i},I_a.rotateY=function(I_a,I_b){var I_c=I_b.elements,I_d=this.elements;I_a*=.5;var I_e=I_d[0],I_f=I_d[1],I_g=I_d[2],I_h=I_d[3],I_i=Math.sin(I_a),I_j=Math.cos(I_a);I_c[0]=I_e*I_j-I_g*I_i,I_c[1]=I_f*I_j+I_h*I_i,I_c[2]=I_g*I_j+I_e*I_i,I_c[3]=I_h*I_j-I_f*I_i},I_a.rotateZ=function(I_a,I_b){var I_c=I_b.elements,I_d=this.elements;I_a*=.5;var I_e=I_d[0],I_f=I_d[1],I_g=I_d[2],I_h=I_d[3],I_i=Math.sin(I_a),I_j=Math.cos(I_a);I_c[0]=I_e*I_j+I_f*I_i,I_c[1]=I_f*I_j-I_e*I_i,I_c[2]=I_g*I_j+I_h*I_i,I_c[3]=I_h*I_j-I_g*I_i},I_a.getYawPitchRoll=function(I_a){I_gb.transformQuat(I_gb.ForwardRH,this,I_e.TEMPVector31),I_gb.transformQuat(I_gb.Up,this,I_e.TEMPVector32);var I_b=I_e.TEMPVector32.elements;I_e.angleTo(I_gb.ZERO,I_e.TEMPVector31,I_e.TEMPVector33);var I_c=I_e.TEMPVector33.elements;I_c[0]==Math.PI/2?(I_c[1]=I_e.arcTanAngle(I_b[2],I_b[0]),I_c[2]=0):I_c[0]==-Math.PI/2?(I_c[1]=I_e.arcTanAngle(-I_b[2],-I_b[0]),I_c[2]=0):(I_ab.createRotationY(-I_c[1],I_e.TEMPMatrix0),I_ab.createRotationX(-I_c[0],I_e.TEMPMatrix1),I_gb.transformCoordinate(I_e.TEMPVector32,I_e.TEMPMatrix0,I_e.TEMPVector32),I_gb.transformCoordinate(I_e.TEMPVector32,I_e.TEMPMatrix1,I_e.TEMPVector32),I_c[2]=I_e.arcTanAngle(I_b[1],-I_b[0])),I_c[1]<=-Math.PI&&(I_c[1]=Math.PI),I_c[2]<=-Math.PI&&(I_c[2]=Math.PI),I_c[1]>=Math.PI&&I_c[2]>=Math.PI&&(I_c[1]=0,I_c[2]=0,I_c[0]=Math.PI-I_c[0]);var I_d=I_a.elements;I_d[0]=I_c[1],I_d[1]=I_c[0],I_d[2]=I_c[2]},I_a.invert=function(I_a){var I_b=I_a.elements,I_c=this.elements,I_d=I_c[0],I_e=I_c[1],I_f=I_c[2],I_g=I_c[3],I_h=I_d*I_d+I_e*I_e+I_f*I_f+I_g*I_g,I_i=I_h?1/I_h:0;I_b[0]=-I_d*I_i,I_b[1]=-I_e*I_i,I_b[2]=-I_f*I_i,I_b[3]=I_g*I_i},I_a.identity=function(){var I_a=this.elements;I_a[0]=0,I_a[1]=0,I_a[2]=0,I_a[3]=1},I_a.fromArray=function(I_a,I_b){void 0===I_b&&(I_b=0),this.elements[0]=I_a[I_b+0],this.elements[1]=I_a[I_b+1],this.elements[2]=I_a[I_b+2],this.elements[3]=I_a[I_b+3]},I_a.cloneTo=function(I_a){var I_b,I_c,I_d;if((I_c=this.elements)!==(I_d=I_a.elements))for(I_b=0;I_b<4;++I_b)I_d[I_b]=I_c[I_b]},I_a.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_a.equals=function(I_a){var I_b=this.elements,I_c=I_a.elements;return I_qa.nearEqual(I_b[0],I_c[0])&&I_qa.nearEqual(I_b[1],I_c[1])&&I_qa.nearEqual(I_b[2],I_c[2])&&I_qa.nearEqual(I_b[3],I_c[3])},I_a.lengthSquared=function(){var I_a=this.elements[0],I_b=this.elements[1],I_c=this.elements[2],I_d=this.elements[3];return I_a*I_a+I_b*I_b+I_c*I_c+I_d*I_d},I_o(0,I_a,"x",function(){return this.elements[0]}),I_o(0,I_a,"y",function(){return this.elements[1]}),I_o(0,I_a,"z",function(){return this.elements[2]}),I_o(0,I_a,"w",function(){return this.elements[3]}),I_e.createFromYawPitchRoll=function(I_a,I_b,I_c,I_d){var I_e=.5*I_c,I_f=.5*I_b,I_g=.5*I_a,I_h=Math.sin(I_e),I_i=Math.cos(I_e),I_j=Math.sin(I_f),I_k=Math.cos(I_f),I_l=Math.sin(I_g),I_m=Math.cos(I_g),I_n=I_d.elements;I_n[0]=I_m*I_j*I_i+I_l*I_k*I_h,I_n[1]=I_l*I_k*I_i-I_m*I_j*I_h,I_n[2]=I_m*I_k*I_h-I_l*I_j*I_i,I_n[3]=I_m*I_k*I_i+I_l*I_j*I_h},I_e.multiply=function(I_a,I_b,I_c){var I_d=I_a.elements,I_e=I_b.elements,I_f=I_c.elements,I_g=I_d[0],I_h=I_d[1],I_i=I_d[2],I_j=I_d[3],I_k=I_e[0],I_l=I_e[1],I_m=I_e[2],I_n=I_e[3],I_o=I_h*I_m-I_i*I_l,I_p=I_i*I_k-I_g*I_m,I_s=I_g*I_l-I_h*I_k,I_t=I_g*I_k+I_h*I_l+I_i*I_m;I_f[0]=I_g*I_n+I_k*I_j+I_o,I_f[1]=I_h*I_n+I_l*I_j+I_p,I_f[2]=I_i*I_n+I_m*I_j+I_s,I_f[3]=I_j*I_n-I_t},I_e.arcTanAngle=function(I_a,I_b){return 0==I_a?1==I_b?Math.PI/2:-Math.PI/2:0<I_a?Math.atan(I_b/I_a):I_a<0?0<I_b?Math.atan(I_b/I_a)+Math.PI:Math.atan(I_b/I_a)-Math.PI:0},I_e.angleTo=function(I_a,I_b,I_c){I_gb.subtract(I_b,I_a,I_e.TEMPVector30),I_gb.normalize(I_e.TEMPVector30,I_e.TEMPVector30),I_c.elements[0]=Math.asin(I_e.TEMPVector30.y),I_c.elements[1]=I_e.arcTanAngle(-I_e.TEMPVector30.z,-I_e.TEMPVector30.x)},I_e.createFromAxisAngle=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements;I_b*=.5;var I_f=Math.sin(I_b);I_d[0]=I_f*I_e[0],I_d[1]=I_f*I_e[1],I_d[2]=I_f*I_e[2],I_d[3]=Math.cos(I_b)},I_e.createFromMatrix3x3=function(I_a,I_b){var I_c,I_d=I_b.elements,I_e=I_a.elements,I_f=I_e[0]+I_e[4]+I_e[8];if(0<I_f)I_c=Math.sqrt(I_f+1),I_d[3]=.5*I_c,I_c=.5/I_c,I_d[0]=(I_e[5]-I_e[7])*I_c,I_d[1]=(I_e[6]-I_e[2])*I_c,I_d[2]=(I_e[1]-I_e[3])*I_c;else{var I_g=0;I_e[4]>I_e[0]&&(I_g=1),I_e[8]>I_e[3*I_g+I_g]&&(I_g=2);var I_h=(I_g+1)%3,I_i=(I_g+2)%3;I_c=Math.sqrt(I_e[3*I_g+I_g]-I_e[3*I_h+I_h]-I_e[3*I_i+I_i]+1),I_d[I_g]=.5*I_c,I_c=.5/I_c,I_d[3]=(I_e[3*I_h+I_i]-I_e[3*I_i+I_h])*I_c,I_d[I_h]=(I_e[3*I_h+I_g]+I_e[3*I_g+I_h])*I_c,I_d[I_i]=(I_e[3*I_i+I_g]+I_e[3*I_g+I_i])*I_c}},I_e.createFromMatrix4x4=function(I_a,I_b){var I_c,I_d,I_e=I_a.elements,I_f=I_b.elements,I_g=I_e[0]+I_e[5]+I_e[10];0<I_g?(I_c=Math.sqrt(I_g+1),I_f[3]=.5*I_c,I_c=.5/I_c,I_f[0]=(I_e[6]-I_e[9])*I_c,I_f[1]=(I_e[8]-I_e[2])*I_c,I_f[2]=(I_e[1]-I_e[4])*I_c):I_e[0]>=I_e[5]&&I_e[0]>=I_e[10]?(I_d=.5/(I_c=Math.sqrt(1+I_e[0]-I_e[5]-I_e[10])),I_f[0]=.5*I_c,I_f[1]=(I_e[1]+I_e[4])*I_d,I_f[2]=(I_e[2]+I_e[8])*I_d,I_f[3]=(I_e[6]-I_e[9])*I_d):I_e[5]>I_e[10]?(I_d=.5/(I_c=Math.sqrt(1+I_e[5]-I_e[0]-I_e[10])),I_f[0]=(I_e[4]+I_e[1])*I_d,I_f[1]=.5*I_c,I_f[2]=(I_e[9]+I_e[6])*I_d,I_f[3]=(I_e[8]-I_e[2])*I_d):(I_d=.5/(I_c=Math.sqrt(1+I_e[10]-I_e[0]-I_e[5])),I_f[0]=(I_e[8]+I_e[2])*I_d,I_f[1]=(I_e[9]+I_e[6])*I_d,I_f[2]=.5*I_c,I_f[3]=(I_e[1]-I_e[4])*I_d)},I_e.slerp=function(I_a,I_b,I_c,I_d){var I_e,I_f,I_g,I_h,I_i,I_j=I_a.elements,I_k=I_b.elements,I_l=I_d.elements,I_m=I_j[0],I_n=I_j[1],I_o=I_j[2],I_p=I_j[3],I_s=I_k[0],I_t=I_k[1],I_u=I_k[2],I_v=I_k[3];return(I_f=I_m*I_s+I_n*I_t+I_o*I_u+I_p*I_v)<0&&(I_f=-I_f,I_s=-I_s,I_t=-I_t,I_u=-I_u,I_v=-I_v),I_i=1e-6<1-I_f?(I_e=Math.acos(I_f),I_g=Math.sin(I_e),I_h=Math.sin((1-I_c)*I_e)/I_g,Math.sin(I_c*I_e)/I_g):(I_h=1-I_c,I_c),I_l[0]=I_h*I_m+I_i*I_s,I_l[1]=I_h*I_n+I_i*I_t,I_l[2]=I_h*I_o+I_i*I_u,I_l[3]=I_h*I_p+I_i*I_v,I_l},I_e.lerp=function(I_a,I_b,I_c,I_d){var I_e=I_d.elements,I_f=I_a.elements,I_g=I_b.elements,I_h=I_f[0],I_i=I_f[1],I_j=I_f[2],I_k=I_f[3];I_e[0]=I_h+I_c*(I_g[0]-I_h),I_e[1]=I_i+I_c*(I_g[1]-I_i),I_e[2]=I_j+I_c*(I_g[2]-I_j),I_e[3]=I_k+I_c*(I_g[3]-I_k)},I_e.add=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements;I_d[0]=I_e[0]+I_f[0],I_d[1]=I_e[1]+I_f[1],I_d[2]=I_e[2]+I_f[2],I_d[3]=I_e[3]+I_f[3]},I_e.dot=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements;return I_c[0]*I_d[0]+I_c[1]*I_d[1]+I_c[2]*I_d[2]+I_c[3]*I_d[3]},I_e.rotationLookAt=function(I_a,I_b,I_c){I_e.lookAt(I_gb.ZERO,I_a,I_b,I_c)},I_e.lookAt=function(I_a,I_b,I_c,I_d){I_ra.lookAt(I_a,I_b,I_c,I_e._tempMatrix3x3),I_e.rotationMatrix(I_e._tempMatrix3x3,I_d)},I_e.invert=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements,I_e=I_a.lengthSquared();I_qa.isZero(I_e)||(I_e=1/I_e,I_d[0]=-I_c[0]*I_e,I_d[1]=-I_c[1]*I_e,I_d[2]=-I_c[2]*I_e,I_d[3]=I_c[3]*I_e)},I_e.rotationMatrix=function(I_a,I_b){var I_c=I_a.elements,I_d=I_c[0],I_e=I_c[1],I_f=I_c[2],I_g=I_c[3],I_h=I_c[4],I_i=I_c[5],I_j=I_c[6],I_k=I_c[7],I_l=I_c[8],I_m=I_b.elements,I_n=NaN,I_o=NaN,I_p=I_d+I_h+I_l;0<I_p?(I_n=Math.sqrt(I_p+1),I_m[3]=.5*I_n,I_n=.5/I_n,I_m[0]=(I_i-I_k)*I_n,I_m[1]=(I_j-I_f)*I_n,I_m[2]=(I_e-I_g)*I_n):I_h<=I_d&&I_l<=I_d?(I_o=.5/(I_n=Math.sqrt(1+I_d-I_h-I_l)),I_m[0]=.5*I_n,I_m[1]=(I_e+I_g)*I_o,I_m[2]=(I_f+I_j)*I_o,I_m[3]=(I_i-I_k)*I_o):I_l<I_h?(I_o=.5/(I_n=Math.sqrt(1+I_h-I_d-I_l)),I_m[0]=(I_g+I_e)*I_o,I_m[1]=.5*I_n,I_m[2]=(I_k+I_i)*I_o,I_m[3]=(I_j-I_f)*I_o):(I_o=.5/(I_n=Math.sqrt(1+I_l-I_d-I_h)),I_m[0]=(I_j+I_f)*I_o,I_m[1]=(I_k+I_i)*I_o,I_m[2]=.5*I_n,I_m[3]=(I_e-I_g)*I_o)},I_e.DEFAULT=new I_e,I_l(I_e,["TEMPVector30",function(){return this.TEMPVector30=new I_gb},"TEMPVector31",function(){return this.TEMPVector31=new I_gb},"TEMPVector32",function(){return this.TEMPVector32=new I_gb},"TEMPVector33",function(){return this.TEMPVector33=new I_gb},"TEMPMatrix0",function(){return this.TEMPMatrix0=new I_ab},"TEMPMatrix1",function(){return this.TEMPMatrix1=new I_ab},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new I_ra},"NAN",function(){return this.NAN=new I_e(NaN,NaN,NaN,NaN)}]),I_e}(),I_db=function(){function I_a(I_a){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=I_a,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}I_n(I_a,"laya.d3.math.Rand");var I_b=I_a.prototype;return I_b.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},I_b.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},I_b.getSignedFloat=function(){return 2*this.getFloat()-1},I_o(0,I_b,"seed",function(){return this.seeds[0]},function(I_a){this.seeds[0]=I_a,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),I_a.getFloatFromInt=function(I_a){return 1/8388607*(8388607&I_a)},I_a.getByteFromInt=function(I_a){return(8388607&I_a)>>>15},I_a}(),I_eb=(function(){function I_e(I_a){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(I_a instanceof Array)||4!==I_a.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|I_a[0],this._state0L=0|I_a[1],this._state1U=0|I_a[2],this._state1L=0|I_a[3]}I_n(I_e,"laya.d3.math.RandX");var I_a=I_e.prototype;I_a.randomint=function(){var I_a=this._state0U,I_b=this._state0L,I_c=this._state1U,I_d=this._state1L,I_e=(I_d>>>0)+(I_b>>>0),I_f=I_c+I_a+(I_e/2>>>31)>>>0,I_g=I_e>>>0,I_h=0,I_i=0;I_h=(I_a^=I_h=I_a<<23|(-512&I_b)>>>9)^(this._state0U=I_c),I_i=(I_b^=I_i=I_b<<23)^(this._state0L=I_d);I_h^=I_a>>>18,I_i^=I_b>>>18|(262143&I_a)<<14;return I_h^=I_c>>>5,I_i^=I_d>>>5|(31&I_c)<<27,this._state1U=I_h,this._state1L=I_i,[I_f,I_g]},I_a.random=function(){var I_a=this.randomint(),I_b=I_a[0],I_c=1023<<20|I_b>>>12,I_d=0|(I_a[1]>>>12|(4095&I_b)<<20);return I_e._CONVERTION_BUFFER.setUint32(0,I_c,!1),I_e._CONVERTION_BUFFER.setUint32(4,I_d,!1),I_db._CONVERTION_BUFFER.getFloat64(0,!1)-1},I_l(I_e,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new I_db([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function I_a(I_a,I_b){this.origin=null,this.direction=null,this.origin=I_a,this.direction=I_b}return I_n(I_a,"laya.d3.math.Ray"),I_a}()),I_fb=function(){function I_a(I_a,I_b){this.elements=new Float32Array(2),void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0);var I_c=this.elements;I_c[0]=I_a,I_c[1]=I_b}I_n(I_a,"laya.d3.math.Vector2");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b.fromArray=function(I_a,I_b){void 0===I_b&&(I_b=0),this.elements[0]=I_a[I_b+0],this.elements[1]=I_a[I_b+1]},I_b.cloneTo=function(I_a){var I_b=I_a.elements,I_c=this.elements;I_b[0]=I_c[0],I_b[1]=I_c[1]},I_b.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_b,"x",function(){return this.elements[0]},function(I_a){this.elements[0]=I_a}),I_o(0,I_b,"y",function(){return this.elements[1]},function(I_a){this.elements[1]=I_a}),I_a.scale=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements;I_d[0]=I_e[0]*I_b,I_d[1]=I_e[1]*I_b},I_l(I_a,["ZERO",function(){return this.ZERO=new I_a(0,0)},"ONE",function(){return this.ONE=new I_a(1,1)}]),I_a}(),I_gb=function(){function I_k(I_a,I_b,I_c){this.elements=new Float32Array(3),void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0);var I_d=this.elements;I_d[0]=I_a,I_d[1]=I_b,I_d[2]=I_c}I_n(I_k,"laya.d3.math.Vector3");var I_a=I_k.prototype;return I_x.imps(I_a,{"laya.d3.core.IClone":!0}),I_a.fromArray=function(I_a,I_b){void 0===I_b&&(I_b=0),this.elements[0]=I_a[I_b+0],this.elements[1]=I_a[I_b+1],this.elements[2]=I_a[I_b+2]},I_a.cloneTo=function(I_a){var I_b=I_a.elements,I_c=this.elements;I_b[0]=I_c[0],I_b[1]=I_c[1],I_b[2]=I_c[2]},I_a.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_a.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},I_a.reset=function(I_a,I_b,I_c){this.elements[0]=I_a,this.elements[1]=I_b,this.elements[2]=I_c},I_o(0,I_a,"x",function(){return this.elements[0]},function(I_a){this.elements[0]=I_a}),I_o(0,I_a,"y",function(){return this.elements[1]},function(I_a){this.elements[1]=I_a}),I_o(0,I_a,"z",function(){return this.elements[2]},function(I_a){this.elements[2]=I_a}),I_k.distanceSquared=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements,I_e=I_c[0]-I_d[0],I_f=I_c[1]-I_d[1],I_g=I_c[2]-I_d[2];return I_e*I_e+I_f*I_f+I_g*I_g},I_k.distance=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements,I_e=I_c[0]-I_d[0],I_f=I_c[1]-I_d[1],I_g=I_c[2]-I_d[2];return Math.sqrt(I_e*I_e+I_f*I_f+I_g*I_g)},I_k.min=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements;I_d[0]=Math.min(I_e[0],I_f[0]),I_d[1]=Math.min(I_e[1],I_f[1]),I_d[2]=Math.min(I_e[2],I_f[2])},I_k.max=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements;I_d[0]=Math.max(I_e[0],I_f[0]),I_d[1]=Math.max(I_e[1],I_f[1]),I_d[2]=Math.max(I_e[2],I_f[2])},I_k.transformQuat=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements,I_g=I_e[0],I_h=I_e[1],I_i=I_e[2],I_j=I_f[0],I_k=I_f[1],I_l=I_f[2],I_m=I_f[3],I_n=I_m*I_g+I_k*I_i-I_l*I_h,I_o=I_m*I_h+I_l*I_g-I_j*I_i,I_p=I_m*I_i+I_j*I_h-I_k*I_g,I_s=-I_j*I_g-I_k*I_h-I_l*I_i;I_d[0]=I_n*I_m+I_s*-I_j+I_o*-I_l-I_p*-I_k,I_d[1]=I_o*I_m+I_s*-I_k+I_p*-I_j-I_n*-I_l,I_d[2]=I_p*I_m+I_s*-I_l+I_n*-I_k-I_o*-I_j},I_k.scalarLength=function(I_a){var I_b=I_a.elements,I_c=I_b[0],I_d=I_b[1],I_e=I_b[2];return Math.sqrt(I_c*I_c+I_d*I_d+I_e*I_e)},I_k.scalarLengthSquared=function(I_a){var I_b=I_a.elements,I_c=I_b[0],I_d=I_b[1],I_e=I_b[2];return I_c*I_c+I_d*I_d+I_e*I_e},I_k.normalize=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements,I_e=I_c[0],I_f=I_c[1],I_g=I_c[2],I_h=I_e*I_e+I_f*I_f+I_g*I_g;0<I_h&&(I_h=1/Math.sqrt(I_h),I_d[0]=I_c[0]*I_h,I_d[1]=I_c[1]*I_h,I_d[2]=I_c[2]*I_h)},I_k.multiply=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements;I_d[0]=I_e[0]*I_f[0],I_d[1]=I_e[1]*I_f[1],I_d[2]=I_e[2]*I_f[2]},I_k.scale=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements;I_d[0]=I_e[0]*I_b,I_d[1]=I_e[1]*I_b,I_d[2]=I_e[2]*I_b},I_k.lerp=function(I_a,I_b,I_c,I_d){var I_e=I_d.elements,I_f=I_a.elements,I_g=I_b.elements,I_h=I_f[0],I_i=I_f[1],I_j=I_f[2];I_e[0]=I_h+I_c*(I_g[0]-I_h),I_e[1]=I_i+I_c*(I_g[1]-I_i),I_e[2]=I_j+I_c*(I_g[2]-I_j)},I_k.transformV3ToV3=function(I_a,I_b,I_c){var I_d=I_k._tempVector4;I_k.transformV3ToV4(I_a,I_b,I_d);var I_e=I_d.elements,I_f=I_c.elements;I_f[0]=I_e[0],I_f[1]=I_e[1],I_f[2]=I_e[2]},I_k.transformV3ToV4=function(I_a,I_b,I_c){var I_d=I_a.elements,I_e=I_d[0],I_f=I_d[1],I_g=I_d[2],I_h=I_b.elements,I_i=I_c.elements;I_i[0]=I_e*I_h[0]+I_f*I_h[4]+I_g*I_h[8]+I_h[12],I_i[1]=I_e*I_h[1]+I_f*I_h[5]+I_g*I_h[9]+I_h[13],I_i[2]=I_e*I_h[2]+I_f*I_h[6]+I_g*I_h[10]+I_h[14],I_i[3]=I_e*I_h[3]+I_f*I_h[7]+I_g*I_h[11]+I_h[15]},I_k.TransformNormal=function(I_a,I_b,I_c){var I_d=I_a.elements,I_e=I_d[0],I_f=I_d[1],I_g=I_d[2],I_h=I_b.elements,I_i=I_c.elements;I_i[0]=I_e*I_h[0]+I_f*I_h[4]+I_g*I_h[8],I_i[1]=I_e*I_h[1]+I_f*I_h[5]+I_g*I_h[9],I_i[2]=I_e*I_h[2]+I_f*I_h[6]+I_g*I_h[10]},I_k.transformCoordinate=function(I_a,I_b,I_c){var I_d=I_k._tempVector4.elements,I_e=I_a.elements,I_f=I_e[0],I_g=I_e[1],I_h=I_e[2],I_i=I_b.elements;I_d[0]=I_f*I_i[0]+I_g*I_i[4]+I_h*I_i[8]+I_i[12],I_d[1]=I_f*I_i[1]+I_g*I_i[5]+I_h*I_i[9]+I_i[13],I_d[2]=I_f*I_i[2]+I_g*I_i[6]+I_h*I_i[10]+I_i[14],I_d[3]=1/(I_f*I_i[3]+I_g*I_i[7]+I_h*I_i[11]+I_i[15]);var I_j=I_c.elements;I_j[0]=I_d[0]*I_d[3],I_j[1]=I_d[1]*I_d[3],I_j[2]=I_d[2]*I_d[3]},I_k.Clamp=function(I_a,I_b,I_c,I_d){var I_e=I_a.elements,I_f=I_e[0],I_g=I_e[1],I_h=I_e[2],I_i=I_b.elements,I_j=I_i[0],I_k=I_i[1],I_l=I_i[2],I_m=I_c.elements,I_n=I_m[0],I_o=I_m[1],I_p=I_m[2],I_s=I_d.elements;I_f=(I_f=I_n<I_f?I_n:I_f)<I_j?I_j:I_f,I_g=(I_g=I_o<I_g?I_o:I_g)<I_k?I_k:I_g,I_h=(I_h=I_p<I_h?I_p:I_h)<I_l?I_l:I_h,I_s[0]=I_f,I_s[1]=I_g,I_s[2]=I_h},I_k.add=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements;I_d[0]=I_e[0]+I_f[0],I_d[1]=I_e[1]+I_f[1],I_d[2]=I_e[2]+I_f[2]},I_k.subtract=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements;I_d[0]=I_e[0]-I_f[0],I_d[1]=I_e[1]-I_f[1],I_d[2]=I_e[2]-I_f[2]},I_k.cross=function(I_a,I_b,I_c){var I_d=I_a.elements,I_e=I_b.elements,I_f=I_c.elements,I_g=I_d[0],I_h=I_d[1],I_i=I_d[2],I_j=I_e[0],I_k=I_e[1],I_l=I_e[2];I_f[0]=I_h*I_l-I_i*I_k,I_f[1]=I_i*I_j-I_g*I_l,I_f[2]=I_g*I_k-I_h*I_j},I_k.dot=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements;return I_c[0]*I_d[0]+I_c[1]*I_d[1]+I_c[2]*I_d[2]},I_k.equals=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements;return I_qa.nearEqual(Math.abs(I_c[0]),Math.abs(I_d[0]))&&I_qa.nearEqual(Math.abs(I_c[1]),Math.abs(I_d[1]))&&I_qa.nearEqual(Math.abs(I_c[2]),Math.abs(I_d[2]))},I_k.ZERO=new I_k(0,0,0),I_k.ONE=new I_k(1,1,1),I_k.NegativeUnitX=new I_k(-1,0,0),I_k.UnitX=new I_k(1,0,0),I_k.UnitY=new I_k(0,1,0),I_k.UnitZ=new I_k(0,0,1),I_k.ForwardRH=new I_k(0,0,-1),I_k.ForwardLH=new I_k(0,0,1),I_k.Up=new I_k(0,1,0),I_k.NAN=new I_k(NaN,NaN,NaN),I_l(I_k,["_tempVector4",function(){return this._tempVector4=new I_hb}]),I_k}(),I_hb=function(){function I_a(I_a,I_b,I_c,I_d){this.elements=new Float32Array(4),void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=0);var I_e=this.elements;I_e[0]=I_a,I_e[1]=I_b,I_e[2]=I_c,I_e[3]=I_d}I_n(I_a,"laya.d3.math.Vector4");var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b.fromArray=function(I_a,I_b){void 0===I_b&&(I_b=0),this.elements[0]=I_a[I_b+0],this.elements[1]=I_a[I_b+1],this.elements[2]=I_a[I_b+2],this.elements[3]=I_a[I_b+3]},I_b.cloneTo=function(I_a){var I_b=I_a.elements,I_c=this.elements;I_b[0]=I_c[0],I_b[1]=I_c[1],I_b[2]=I_c[2],I_b[3]=I_c[3]},I_b.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_b.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},I_b.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},I_o(0,I_b,"x",function(){return this.elements[0]},function(I_a){this.elements[0]=I_a}),I_o(0,I_b,"y",function(){return this.elements[1]},function(I_a){this.elements[1]=I_a}),I_o(0,I_b,"z",function(){return this.elements[2]},function(I_a){this.elements[2]=I_a}),I_o(0,I_b,"w",function(){return this.elements[3]},function(I_a){this.elements[3]=I_a}),I_a.lerp=function(I_a,I_b,I_c,I_d){var I_e=I_d.elements,I_f=I_a.elements,I_g=I_b.elements,I_h=I_f[0],I_i=I_f[1],I_j=I_f[2],I_k=I_f[3];I_e[0]=I_h+I_c*(I_g[0]-I_h),I_e[1]=I_i+I_c*(I_g[1]-I_i),I_e[2]=I_j+I_c*(I_g[2]-I_j),I_e[3]=I_k+I_c*(I_g[3]-I_k)},I_a.transformByM4x4=function(I_a,I_b,I_c){var I_d=I_a.elements,I_e=I_d[0],I_f=I_d[1],I_g=I_d[2],I_h=I_d[3],I_i=I_b.elements,I_j=I_c.elements;I_j[0]=I_e*I_i[0]+I_f*I_i[4]+I_g*I_i[8]+I_h*I_i[12],I_j[1]=I_e*I_i[1]+I_f*I_i[5]+I_g*I_i[9]+I_h*I_i[13],I_j[2]=I_e*I_i[2]+I_f*I_i[6]+I_g*I_i[10]+I_h*I_i[14],I_j[3]=I_e*I_i[3]+I_f*I_i[7]+I_g*I_i[11]+I_h*I_i[15]},I_a.equals=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements;return I_qa.nearEqual(Math.abs(I_c[0]),Math.abs(I_d[0]))&&I_qa.nearEqual(Math.abs(I_c[1]),Math.abs(I_d[1]))&&I_qa.nearEqual(Math.abs(I_c[2]),Math.abs(I_d[2]))&&I_qa.nearEqual(Math.abs(I_c[3]),Math.abs(I_d[3]))},I_a.normalize=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements,I_e=I_a.length();0<I_e&&(I_d[0]=I_c[0]*I_e,I_d[1]=I_c[1]*I_e,I_d[2]=I_c[2]*I_e,I_d[3]=I_c[3]*I_e)},I_a.add=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements;I_d[0]=I_e[0]+I_f[0],I_d[1]=I_e[1]+I_f[1],I_d[2]=I_e[2]+I_f[2],I_d[3]=I_e[3]+I_f[3]},I_a.subtract=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements;I_d[0]=I_e[0]-I_f[0],I_d[1]=I_e[1]-I_f[1],I_d[2]=I_e[2]-I_f[2],I_d[3]=I_e[3]-I_f[3]},I_a.multiply=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements;I_d[0]=I_e[0]*I_f[0],I_d[1]=I_e[1]*I_f[1],I_d[2]=I_e[2]*I_f[2],I_d[3]=I_e[3]*I_f[3]},I_a.scale=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements;I_d[0]=I_e[0]*I_b,I_d[1]=I_e[1]*I_b,I_d[2]=I_e[2]*I_b,I_d[3]=I_e[3]*I_b},I_a.Clamp=function(I_a,I_b,I_c,I_d){var I_e=I_a.elements,I_f=I_e[0],I_g=I_e[1],I_h=I_e[2],I_i=I_e[3],I_j=I_b.elements,I_k=I_j[0],I_l=I_j[1],I_m=I_j[2],I_n=I_j[3],I_o=I_c.elements,I_p=I_o[0],I_s=I_o[1],I_t=I_o[2],I_u=I_o[3],I_v=I_d.elements;I_f=(I_f=I_p<I_f?I_p:I_f)<I_k?I_k:I_f,I_g=(I_g=I_s<I_g?I_s:I_g)<I_l?I_l:I_g,I_h=(I_h=I_t<I_h?I_t:I_h)<I_m?I_m:I_h,I_i=(I_i=I_u<I_i?I_u:I_i)<I_n?I_n:I_i,I_v[0]=I_f,I_v[1]=I_g,I_v[2]=I_h,I_v[3]=I_i},I_a.distanceSquared=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements,I_e=I_c[0]-I_d[0],I_f=I_c[1]-I_d[1],I_g=I_c[2]-I_d[2],I_h=I_c[3]-I_d[3];return I_e*I_e+I_f*I_f+I_g*I_g+I_h*I_h},I_a.distance=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements,I_e=I_c[0]-I_d[0],I_f=I_c[1]-I_d[1],I_g=I_c[2]-I_d[2],I_h=I_c[3]-I_d[3];return Math.sqrt(I_e*I_e+I_f*I_f+I_g*I_g+I_h*I_h)},I_a.dot=function(I_a,I_b){var I_c=I_a.elements,I_d=I_b.elements;return I_c[0]*I_d[0]+I_c[1]*I_d[1]+I_c[2]*I_d[2]+I_c[3]*I_d[3]},I_a.min=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements;I_d[0]=Math.min(I_e[0],I_f[0]),I_d[1]=Math.min(I_e[1],I_f[1]),I_d[2]=Math.min(I_e[2],I_f[2]),I_d[3]=Math.min(I_e[3],I_f[3])},I_a.max=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b.elements;I_d[0]=Math.max(I_e[0],I_f[0]),I_d[1]=Math.max(I_e[1],I_f[1]),I_d[2]=Math.max(I_e[2],I_f[2]),I_d[3]=Math.max(I_e[3],I_f[3])},I_l(I_a,["ZERO",function(){return this.ZERO=new I_a},"ONE",function(){return this.ONE=new I_a(1,1,1,1)},"UnitX",function(){return this.UnitX=new I_a(1,0,0,0)},"UnitY",function(){return this.UnitY=new I_a(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new I_a(0,0,1,0)},"UnitW",function(){return this.UnitW=new I_a(0,0,0,1)}]),I_a}(),I_ib=function(){function I_f(I_a,I_b,I_c,I_d){this.minDepth=0,this.maxDepth=1,this.x=I_a,this.y=I_b,this.width=I_c,this.height=I_d}I_n(I_f,"laya.d3.math.Viewport");var I_a=I_f.prototype;return I_a.project=function(I_a,I_b,I_c){I_gb.transformV3ToV3(I_a,I_b,I_c);var I_d=I_a.elements,I_e=I_b.elements,I_f=I_c.elements,I_g=I_d[0]*I_e[3]+I_d[1]*I_e[7]+I_d[2]*I_e[11]+I_e[15];1!==I_g&&(I_f[0]=I_f[0]/I_g,I_f[1]=I_f[1]/I_g,I_f[2]=I_f[2]/I_g),I_f[0]=.5*(I_f[0]+1)*this.width+this.x,I_f[1]=.5*(1-I_f[1])*this.height+this.y,I_f[2]=I_f[2]*(this.maxDepth-this.minDepth)+this.minDepth},I_a.unprojectFromMat=function(I_a,I_b,I_c){var I_d=I_a.elements,I_e=I_b.elements,I_f=I_c.elements;I_f[0]=(I_d[0]-this.x)/this.width*2-1,I_f[1]=-((I_d[1]-this.y)/this.height*2-1);var I_g=(this.maxDepth-this.minDepth)/2;I_f[2]=(I_d[2]-this.minDepth-I_g)/I_g;var I_h=I_f[0]*I_e[3]+I_f[1]*I_e[7]+I_f[2]*I_e[11]+I_e[15];I_gb.transformV3ToV3(I_c,I_b,I_c),1!==I_h&&(I_f[0]=I_f[0]/I_h,I_f[1]=I_f[1]/I_h,I_f[2]=I_f[2]/I_h)},I_a.unprojectFromWVP=function(I_a,I_b,I_c,I_d,I_e){I_ab.multiply(I_b,I_c,I_f._tempMatrix4x4),I_d&&I_ab.multiply(I_f._tempMatrix4x4,I_d,I_f._tempMatrix4x4),I_f._tempMatrix4x4.invert(I_f._tempMatrix4x4),this.unprojectFromMat(I_a,I_f._tempMatrix4x4,I_e)},I_l(I_f,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new I_ab}]),I_f}(),I_jb=function(){function I_E(I_a){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=I_a,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}I_n(I_E,"laya.d3.resource.models.SubMesh");var I_a=I_E.prototype;return I_x.imps(I_a,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),I_a._getVertexBuffer=function(I_a){return void 0===I_a&&(I_a=0),0===I_a?this._vertexBuffer:null},I_a._getIndexBuffer=function(){return this._indexBuffer},I_a._getStaticBatchBakedVertexs=function(I_a,I_b){var I_c,I_d,I_e=this._vertexBuffer,I_f=I_e.vertexDeclaration,I_g=I_f.getVertexElementByUsage(0).offset/4,I_h=I_f.getVertexElementByUsage(3).offset/4,I_i=I_b.meshRender.lightmapScaleOffset,I_j=0,I_k=0,I_l=0,I_m=0,I_n=0,I_o=0;if(I_i)if(I_d=I_f.getVertexElementByUsage(15))I_l=I_f.vertexStride/4,I_c=0<this._vertexCount?I_e.getData().slice(this._vertexStart*I_l,(this._vertexStart+this._vertexCount)*I_l):I_e.getData().slice(),I_m=I_d.offset/4;else{I_l=(I_o=I_f.vertexStride/4)+2,I_c=this._vertexCount?new Float32Array(this._vertexCount*(I_e.vertexDeclaration.vertexStride/4+2)):new Float32Array(I_e.vertexCount*(I_e.vertexDeclaration.vertexStride/4+2)),I_m=(I_n=I_f.getVertexElementByUsage(2).offset/4)+2;var I_p=I_e.getData();for(I_j=0,I_k=I_p.length/I_o;I_j<I_k;I_j++){var I_s=0;I_s=0<this._vertexCount?(this._vertexStart+I_j)*I_o:I_j*I_o;var I_t=I_j*I_l,I_u=0;for(I_u=0;I_u<I_m;I_u++)I_c[I_t+I_u]=I_p[I_s+I_u];for(I_u=I_m;I_u<I_o;I_u++)I_c[I_t+I_u+2]=I_p[I_s+I_u]}}else I_l=I_f.vertexStride/4,I_c=this._vertexCount?I_e.getData().slice(this._vertexStart*I_l,(this._vertexStart+this._vertexCount)*I_l):I_e.getData().slice();if(I_a){var I_v=I_a.worldMatrix,I_w=I_E._tempMatrix4x40;I_v.invert(I_w);var I_x=I_E._tempMatrix4x41,I_y=I_b.transform.worldMatrix;I_ab.multiply(I_w,I_y,I_x)}else I_x=I_b.transform.worldMatrix;var I_z=I_E._tempQuaternion0;for(I_x.decomposeTransRotScale(I_E._tempVector30,I_z,I_E._tempVector31),I_j=0,I_k=I_c.length/I_l;I_j<I_k;I_j++){var I_A=I_j*I_l+I_g,I_B=I_j*I_l+I_h;if(I_sb.transformVector3ArrayToVector3ArrayCoordinate(I_c,I_A,I_x,I_c,I_A),I_sb.transformVector3ArrayByQuat(I_c,I_B,I_z,I_c,I_B),I_i){var I_C=I_j*I_l+I_m;if(I_d)I_sb.transformLightingMapTexcoordByUV1Array(I_c,I_C,I_i,I_c,I_C);else{var I_D=I_j*I_o+I_n;I_sb.transformLightingMapTexcoordByUV0Array(I_p,I_D,I_i,I_c,I_C)}}}return I_c},I_a._getVertexBuffers=function(){return null},I_a._beforeRender=function(I_a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},I_a._render=function(I_a){var I_b,I_c=0,I_d=I_a.renderElement;if(1<this._indexCount){var I_e=this._boneIndicesList.length;if(1<I_e){for(var I_f=0;I_f<I_e;I_f++)(I_b=I_d._skinAnimationDatas||this._skinAnimationDatas)&&(I_d._shaderValue.setValue(0,I_b[I_f]),I_a._shader.uploadRenderElementUniforms(I_d._shaderValue.data)),I_F.mainContext.drawElements(4,this._subIndexBufferCount[I_f],5123,2*this._subIndexBufferStart[I_f]);I_A.drawCall+=I_e}else(I_b=I_d._skinAnimationDatas||this._skinAnimationDatas)&&(I_d._shaderValue.setValue(0,I_b[0]),I_a._shader.uploadRenderElementUniforms(I_d._shaderValue.data)),I_F.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),I_A.drawCall++;I_c=this._indexCount}else I_c=this._indexBuffer.indexCount,(I_b=I_d._skinAnimationDatas||this._skinAnimationDatas)&&(I_d._shaderValue.setValue(0,I_b[0]),I_a._shader.uploadRenderElementUniforms(I_d._shaderValue.data)),I_F.mainContext.drawElements(4,I_c,5123,0),I_A.drawCall++;I_A.trianglesFaces+=I_c/3},I_a.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},I_a.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},I_o(0,I_a,"_vertexBufferCount",function(){return 1}),I_o(0,I_a,"triangleCount",function(){return this._indexBuffer.indexCount/3}),I_l(I_E,["_tempVector30",function(){return this._tempVector30=new I_gb},"_tempVector31",function(){return this._tempVector31=new I_gb},"_tempQuaternion0",function(){return this._tempQuaternion0=new I_cb},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new I_ab},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new I_ab}]),I_E}(),I_kb=function(){function I_a(I_a){this.defineCounter=0,this.defines=null,I_a?(this.defineCounter=I_a.defineCounter,this.defines=I_a.defines.slice()):(this.defineCounter=0,this.defines=[])}return I_n(I_a,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),I_a.prototype.registerDefine=function(I_a){var I_b=Math.pow(2,this.defineCounter++);return this.defines[I_b]=I_a,I_b},I_a}(),I_lb=function(){function I_a(){}return I_n(I_a,"laya.d3.shader.ShaderInit3D"),I_a.__init__=function(){var I_a,I_b;I_Ab._globalRegDefine("HIGHPRECISION",I_Ab.SHADERDEFINE_HIGHPRECISION),I_Ab._globalRegDefine("FOG",I_Ab.SHADERDEFINE_FOG),I_Ab._globalRegDefine("DIRECTIONLIGHT",I_Ab.SHADERDEFINE_DIRECTIONLIGHT),I_Ab._globalRegDefine("POINTLIGHT",I_Ab.SHADERDEFINE_POINTLIGHT),I_Ab._globalRegDefine("SPOTLIGHT",I_Ab.SHADERDEFINE_SPOTLIGHT),I_Ab._globalRegDefine("UV",I_Ab.SHADERDEFINE_UV0),I_Ab._globalRegDefine("COLOR",I_Ab.SHADERDEFINE_COLOR),I_Ab._globalRegDefine("UV1",I_Ab.SHADERDEFINE_UV1),I_Ab._globalRegDefine("CASTSHADOW",I_nb.SHADERDEFINE_CAST_SHADOW),I_Ab._globalRegDefine("SHADOWMAP_PSSM1",I_nb.SHADERDEFINE_SHADOW_PSSM1),I_Ab._globalRegDefine("SHADOWMAP_PSSM2",I_nb.SHADERDEFINE_SHADOW_PSSM2),I_Ab._globalRegDefine("SHADOWMAP_PSSM3",I_nb.SHADERDEFINE_SHADOW_PSSM3),I_Ab._globalRegDefine("SHADOWMAP_PCF_NO",I_nb.SHADERDEFINE_SHADOW_PCF_NO),I_Ab._globalRegDefine("SHADOWMAP_PCF1",I_nb.SHADERDEFINE_SHADOW_PCF1),I_Ab._globalRegDefine("SHADOWMAP_PCF2",I_nb.SHADERDEFINE_SHADOW_PCF2),I_Ab._globalRegDefine("SHADOWMAP_PCF3",I_nb.SHADERDEFINE_SHADOW_PCF3),I_Ab._globalRegDefine("DEPTHFOG",I_Ab.SAHDERDEFINE_DEPTHFOG),I_Lb.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),I_Lb.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),I_a={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},I_b={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var I_c=I_Lb.nameKey.add("SIMPLE");shaderCompile=I_Ab.add(I_c,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',I_a,I_b),I_Mb.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),I_Mb.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),I_Mb.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),I_Mb.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),I_Mb.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),I_Mb.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),I_Mb.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),I_Mb.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),I_Mb.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},I_a}(),I_mb=function(){function I_a(){this._data=null,this._data=[]}I_n(I_a,"laya.d3.shader.ValusArray");var I_b=I_a.prototype;return I_b.setValue=function(I_a,I_b){this._data[I_a]=I_b},I_o(0,I_b,"data",function(){return this._data}),I_a}(),I_nb=function(){function I_a(){}return I_a.SHADERDEFINE_RECEIVE_SHADOW=1,I_a.SHADERDEFINE_CAST_SHADOW=512,I_a.SHADERDEFINE_SHADOW_PSSM1=1024,I_a.SHADERDEFINE_SHADOW_PSSM2=2048,I_a.SHADERDEFINE_SHADOW_PSSM3=4096,I_a.SHADERDEFINE_SHADOW_PCF_NO=8192,I_a.SHADERDEFINE_SHADOW_PCF1=16384,I_a.SHADERDEFINE_SHADOW_PCF2=32768,I_a.SHADERDEFINE_SHADOW_PCF3=65536,I_a.MAX_PSSM_COUNT=3,I_a}(),I_ob=function(){function I_X(){}return I_n(I_X,"laya.d3.utils.Picker"),I_X.calculateCursorRay=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=I_a.elements[0],I_h=I_a.elements[1],I_i=I_X._tempVector30,I_j=I_i.elements;I_j[0]=I_g,I_j[1]=I_h,I_j[2]=I_b.minDepth;var I_k=I_X._tempVector31,I_l=I_k.elements;I_l[0]=I_g,I_l[1]=I_h,I_l[2]=I_b.maxDepth;var I_m=I_f.origin,I_n=I_X._tempVector32;I_b.unprojectFromWVP(I_i,I_c,I_d,I_e,I_m),I_b.unprojectFromWVP(I_k,I_c,I_d,I_e,I_n);var I_o=I_f.direction.elements;I_o[0]=I_n.x-I_m.x,I_o[1]=I_n.y-I_m.y,I_o[2]=I_n.z-I_m.z,I_gb.normalize(I_f.direction,I_f.direction)},I_X.rayIntersectsPositionsAndIndices=function(I_a,I_b,I_c,I_d,I_e){for(var I_f=I_c.vertexStride/4,I_g=I_c.getVertexElementByUsage(0).offset/4,I_h=Number.MAX_VALUE,I_i=-1,I_j=-1,I_k=-1,I_l=0;I_l<I_d.length;I_l+=3){var I_m=I_X._tempVector35,I_n=I_m.elements,I_o=I_d[I_l]*I_f,I_p=I_o+I_g;I_n[0]=I_b[I_p],I_n[1]=I_b[1+I_p],I_n[2]=I_b[2+I_p];var I_s=I_X._tempVector36,I_t=I_s.elements,I_u=I_d[I_l+1]*I_f,I_v=I_u+I_g;I_t[0]=I_b[I_v],I_t[1]=I_b[1+I_v],I_t[2]=I_b[2+I_v];var I_w=I_X._tempVector37,I_x=I_w.elements,I_y=I_d[I_l+2]*I_f,I_z=I_y+I_g;I_x[0]=I_b[I_z],I_x[1]=I_b[1+I_z],I_x[2]=I_b[2+I_z];var I_A=laya.d3.utils.Picker.rayIntersectsTriangle(I_a,I_m,I_s,I_w);!isNaN(I_A)&&I_A<I_h&&(I_h=I_A,I_i=I_o,I_j=I_u,I_k=I_y)}if(I_h===Number.MAX_VALUE)return I_e.position.toDefault(),I_e.distance=Number.MAX_VALUE,I_e.trianglePositions[0].toDefault(),I_e.trianglePositions[1].toDefault(),I_e.trianglePositions[2].toDefault(),I_e.triangleNormals[0].toDefault(),I_e.triangleNormals[1].toDefault(),I_e.triangleNormals[2].toDefault(),!1;I_e.distance=I_h,I_gb.scale(I_a.direction,I_h,I_e.position),I_gb.add(I_a.origin,I_e.position,I_e.position);var I_B=I_e.trianglePositions,I_C=I_B[0],I_D=I_B[1],I_E=I_B[2],I_F=I_C.elements,I_G=I_D.elements,I_H=I_E.elements,I_I=I_i+I_g;I_F[0]=I_b[I_I],I_F[1]=I_b[I_I+1],I_F[2]=I_b[I_I+2];var I_J=I_j+I_g;I_G[0]=I_b[I_J],I_G[1]=I_b[I_J+1],I_G[2]=I_b[I_J+2];var I_K=I_k+I_g;I_H[0]=I_b[I_K],I_H[1]=I_b[I_K+1],I_H[2]=I_b[I_K+2];var I_L=I_c.getVertexElementByUsage(3);if(I_L){var I_M=I_L.offset/4,I_N=I_e.triangleNormals,I_O=I_N[0],I_P=I_N[1],I_Q=I_N[2],I_R=I_O.elements,I_S=I_P.elements,I_T=I_Q.elements,I_U=I_i+I_M;I_R[0]=I_b[I_U],I_R[1]=I_b[I_U+1],I_R[2]=I_b[I_U+2];var I_V=I_j+I_M;I_S[0]=I_b[I_V],I_S[1]=I_b[I_V+1],I_S[2]=I_b[I_V+2];var I_W=I_k+I_M;I_T[0]=I_b[I_W],I_T[1]=I_b[I_W+1],I_T[2]=I_b[I_W+2]}return!0},I_X.rayIntersectsTriangle=function(I_a,I_b,I_c,I_d){var I_e=I_X._tempVector30,I_f=I_X._tempVector31;I_gb.subtract(I_c,I_b,I_e),I_gb.subtract(I_d,I_b,I_f);var I_g,I_h=I_X._tempVector32;if(I_gb.cross(I_a.direction,I_f,I_h),(I_g=I_gb.dot(I_e,I_h))>-Number.MIN_VALUE&&I_g<Number.MIN_VALUE)return Number.NaN;var I_i,I_j=1/I_g,I_k=I_X._tempVector33;if(I_gb.subtract(I_a.origin,I_b,I_k),I_i=I_gb.dot(I_k,I_h),(I_i*=I_j)<0||1<I_i)return Number.NaN;var I_l,I_m,I_n=I_X._tempVector34;return I_gb.cross(I_k,I_e,I_n),I_l=I_gb.dot(I_a.direction,I_n),(I_l*=I_j)<0||1<I_i+I_l?Number.NaN:(I_m=I_gb.dot(I_f,I_n),(I_m*=I_j)<0?Number.NaN:I_m)},I_l(I_X,["_tempVector30",function(){return this._tempVector30=new I_gb},"_tempVector31",function(){return this._tempVector31=new I_gb},"_tempVector32",function(){return this._tempVector32=new I_gb},"_tempVector33",function(){return this._tempVector33=new I_gb},"_tempVector34",function(){return this._tempVector34=new I_gb},"_tempVector35",function(){return this._tempVector35=new I_gb},"_tempVector36",function(){return this._tempVector36=new I_gb},"_tempVector37",function(){return this._tempVector37=new I_gb}]),I_X}(),I_pb=(function(){function I_a(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new I_gb,new I_gb,new I_gb],this.trianglePositions.length=3,this.triangleNormals=[new I_gb,new I_gb,new I_gb],this.triangleNormals.length=3,this.position=new I_gb}I_n(I_a,"laya.d3.utils.RaycastHit"),I_a.prototype.cloneTo=function(I_a){I_a.distance=this.distance,this.trianglePositions[0].cloneTo(I_a.trianglePositions[0]),this.trianglePositions[1].cloneTo(I_a.trianglePositions[1]),this.trianglePositions[2].cloneTo(I_a.trianglePositions[2]),this.triangleNormals[0].cloneTo(I_a.triangleNormals[0]),this.triangleNormals[1].cloneTo(I_a.triangleNormals[1]),this.triangleNormals[2].cloneTo(I_a.triangleNormals[2]),this.position.cloneTo(I_a.position),I_a.sprite3D=this.sprite3D}}(),function(){function I_a(I_a,I_b){this._width=0,this._height=0,this._width=I_a,this._height=I_b}I_n(I_a,"laya.d3.utils.Size");var I_b=I_a.prototype;return I_o(0,I_b,"width",function(){return-1===this._width?I_Y.clientWidth:this._width}),I_o(0,I_b,"height",function(){return-1===this._height?I_Y.clientHeight:this._height}),I_o(1,I_a,"fullScreen",function(){return new I_a(-1,-1)}),I_a}()),I_sb=function(){function I_I(){}return I_n(I_I,"laya.d3.utils.Utils3D"),I_I._rotationTransformScaleSkinAnimation=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_l){var I_m,I_n,I_o,I_p,I_s,I_t=I_I._tempArray16_0,I_u=I_I._tempArray16_1,I_v=I_I._tempArray16_2,I_w=I_d+I_d,I_x=I_e+I_e,I_y=I_f+I_f,I_z=I_d*I_w,I_A=I_e*I_w,I_B=I_e*I_x,I_C=I_f*I_w,I_D=I_f*I_x,I_E=I_f*I_y,I_F=I_g*I_w,I_G=I_g*I_x,I_H=I_g*I_y;for(I_t[15]=1,I_t[0]=1-I_B-I_E,I_t[1]=I_A+I_H,I_t[2]=I_C-I_G,I_t[4]=I_A-I_H,I_t[5]=1-I_z-I_E,I_t[6]=I_D+I_F,I_t[8]=I_C+I_G,I_t[9]=I_D-I_F,I_t[10]=1-I_z-I_B,I_u[15]=1,I_u[0]=I_h,I_u[5]=I_i,I_u[10]=I_j,I_m=0;I_m<4;I_m++)I_n=I_t[I_m],I_o=I_t[I_m+4],I_p=I_t[I_m+8],I_s=I_t[I_m+12],I_v[I_m]=I_n,I_v[I_m+4]=I_o,I_v[I_m+8]=I_p,I_v[I_m+12]=I_n*I_a+I_o*I_b+I_p*I_c+I_s;for(I_m=0;I_m<4;I_m++)I_n=I_v[I_m],I_o=I_v[I_m+4],I_p=I_v[I_m+8],I_s=I_v[I_m+12],I_k[I_m+I_l]=I_n*I_u[0]+I_o*I_u[1]+I_p*I_u[2]+I_s*I_u[3],I_k[I_m+I_l+4]=I_n*I_u[4]+I_o*I_u[5]+I_p*I_u[6]+I_s*I_u[7],I_k[I_m+I_l+8]=I_n*I_u[8]+I_o*I_u[9]+I_p*I_u[10]+I_s*I_u[11],I_k[I_m+I_l+12]=I_n*I_u[12]+I_o*I_u[13]+I_p*I_u[14]+I_s*I_u[15]},I_I._createNodeByJson=function(I_a,I_b,I_c,I_d){if(!I_c)switch(I_b.type){case"Sprite3D":I_c=new I_Kb;break;case"MeshSprite3D":I_c=new I_Xb;break;case"SkinnedMeshSprite3D":I_c=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":I_c=new ShuriKenParticle3D;break;case"TrailSprite3D":I_c=new TrailSprite3D;break;case"Terrain":I_c=new Terrain;break;case"Camera":I_c=new I_Wb;break;case"DirectionLight":I_c=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var I_e=I_b.props;if(I_e)for(var I_f in I_e)I_c[I_f]=I_e[I_f];var I_g=I_b.customProps;I_g&&(I_c instanceof laya.d3.core.Sprite3D?(I_c._parseBaseCustomProps(I_g),I_c._parseCustomProps(I_a,I_d,I_g,I_b),I_c._parseCustomComponent(I_a,I_d,I_b.components)):I_c._parseCustomProps(I_a,I_d,I_g,I_b));var I_h=I_b.child;if(I_h)for(var I_i=0,I_j=I_h.length;I_i<I_j;I_i++){var I_k=I_I._createNodeByJson(I_a,I_h[I_i],null,I_d);I_c.addChild(I_k)}return I_c},I_I._computeBoneAndAnimationDatasByBindPoseMatrxix=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g,I_h,I_i=0,I_j=0,I_k=I_a.length;for(I_g=0;I_g<I_k;I_i+=I_a[I_g].keyframeWidth,I_j+=16,I_g++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(I_b[I_i+0],I_b[I_i+1],I_b[I_i+2],I_b[I_i+3],I_b[I_i+4],I_b[I_i+5],I_b[I_i+6],I_b[I_i+7],I_b[I_i+8],I_b[I_i+9],I_d,I_j),0!=I_g&&(I_h=16*I_a[I_g].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(I_d,I_h,I_d,I_j,I_d,I_j));var I_l=I_c.length;for(I_g=0;I_g<I_l;I_g++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(I_d,16*I_f[I_g],I_c[I_g],I_e,16*I_g)},I_I._computeAnimationDatasByArrayAndMatrixFast=function(I_a,I_b,I_c,I_d){for(var I_e=0,I_f=I_a.length;I_e<I_f;I_e++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(I_b,16*I_d[I_e],I_a[I_e],I_c,16*I_e)},I_I._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(I_a,I_b,I_c,I_d,I_e){var I_f,I_g,I_h=0,I_i=0,I_j=I_a.length;for(I_f=0;I_f<I_j;I_h+=I_a[I_f].keyframeWidth,I_i+=16,I_f++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(I_b[I_h+7],I_b[I_h+8],I_b[I_h+9],I_b[I_h+3],I_b[I_h+4],I_b[I_h+5],I_b[I_h+6],I_b[I_h+0],I_b[I_h+1],I_b[I_h+2],I_d,I_i),0!=I_f&&(I_g=16*I_a[I_f].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(I_d,I_g,I_d,I_i,I_d,I_i));var I_k=I_c.length;for(I_f=0;I_f<I_k;I_f++){var I_l=16*I_f;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(I_d,I_l,I_c[I_f],I_e,I_l)}},I_I._computeAnimationDatasByArrayAndMatrixFastOld=function(I_a,I_b,I_c){for(var I_d=I_a.length,I_e=0;I_e<I_d;I_e++){var I_f=16*I_e;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(I_b,I_f,I_a[I_e],I_c,I_f)}},I_I._computeRootAnimationData=function(I_a,I_b,I_c){for(var I_d=0,I_e=0,I_f=0,I_g=I_a.length;I_d<I_g;I_e+=I_a[I_d].keyframeWidth,I_f+=16,I_d++)laya.d3.utils.Utils3D.createAffineTransformationArray(I_b[I_e+0],I_b[I_e+1],I_b[I_e+2],I_b[I_e+3],I_b[I_e+4],I_b[I_e+5],I_b[I_e+6],I_b[I_e+7],I_b[I_e+8],I_b[I_e+9],I_c,I_f)},I_I.transformVector3ArrayByQuat=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_c.elements,I_g=I_a[I_b],I_h=I_a[I_b+1],I_i=I_a[I_b+2],I_j=I_f[0],I_k=I_f[1],I_l=I_f[2],I_m=I_f[3],I_n=I_m*I_g+I_k*I_i-I_l*I_h,I_o=I_m*I_h+I_l*I_g-I_j*I_i,I_p=I_m*I_i+I_j*I_h-I_k*I_g,I_s=-I_j*I_g-I_k*I_h-I_l*I_i;I_d[I_e]=I_n*I_m+I_s*-I_j+I_o*-I_l-I_p*-I_k,I_d[I_e+1]=I_o*I_m+I_s*-I_k+I_p*-I_j-I_n*-I_l,I_d[I_e+2]=I_p*I_m+I_s*-I_l+I_n*-I_k-I_o*-I_j},I_I.mulMatrixByArray=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g,I_h,I_i,I_j,I_k;if(I_e===I_c){for(I_c=I_I._tempArray16_3,I_g=0;I_g<16;++I_g)I_c[I_g]=I_e[I_f+I_g];I_d=0}for(I_g=0;I_g<4;I_g++)I_h=I_a[I_b+I_g],I_i=I_a[I_b+I_g+4],I_j=I_a[I_b+I_g+8],I_k=I_a[I_b+I_g+12],I_e[I_f+I_g]=I_h*I_c[I_d+0]+I_i*I_c[I_d+1]+I_j*I_c[I_d+2]+I_k*I_c[I_d+3],I_e[I_f+I_g+4]=I_h*I_c[I_d+4]+I_i*I_c[I_d+5]+I_j*I_c[I_d+6]+I_k*I_c[I_d+7],I_e[I_f+I_g+8]=I_h*I_c[I_d+8]+I_i*I_c[I_d+9]+I_j*I_c[I_d+10]+I_k*I_c[I_d+11],I_e[I_f+I_g+12]=I_h*I_c[I_d+12]+I_i*I_c[I_d+13]+I_j*I_c[I_d+14]+I_k*I_c[I_d+15]},I_I.mulMatrixByArrayFast=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g,I_h,I_i,I_j,I_k;for(I_g=0;I_g<4;I_g++)I_h=I_a[I_b+I_g],I_i=I_a[I_b+I_g+4],I_j=I_a[I_b+I_g+8],I_k=I_a[I_b+I_g+12],I_e[I_f+I_g]=I_h*I_c[I_d+0]+I_i*I_c[I_d+1]+I_j*I_c[I_d+2]+I_k*I_c[I_d+3],I_e[I_f+I_g+4]=I_h*I_c[I_d+4]+I_i*I_c[I_d+5]+I_j*I_c[I_d+6]+I_k*I_c[I_d+7],I_e[I_f+I_g+8]=I_h*I_c[I_d+8]+I_i*I_c[I_d+9]+I_j*I_c[I_d+10]+I_k*I_c[I_d+11],I_e[I_f+I_g+12]=I_h*I_c[I_d+12]+I_i*I_c[I_d+13]+I_j*I_c[I_d+14]+I_k*I_c[I_d+15]},I_I.mulMatrixByArrayAndMatrixFast=function(I_a,I_b,I_c,I_d,I_e){var I_f,I_g,I_h,I_i,I_j,I_k=I_c.elements,I_l=I_k[0],I_m=I_k[1],I_n=I_k[2],I_o=I_k[3],I_p=I_k[4],I_s=I_k[5],I_t=I_k[6],I_u=I_k[7],I_v=I_k[8],I_w=I_k[9],I_x=I_k[10],I_y=I_k[11],I_z=I_k[12],I_A=I_k[13],I_B=I_k[14],I_C=I_k[15],I_D=I_b,I_E=I_b+4,I_F=I_b+8,I_G=I_b+12,I_H=I_e,I_I=I_e+4,I_J=I_e+8,I_K=I_e+12;for(I_f=0;I_f<4;I_f++)I_g=I_a[I_D+I_f],I_h=I_a[I_E+I_f],I_i=I_a[I_F+I_f],I_j=I_a[I_G+I_f],I_d[I_H+I_f]=I_g*I_l+I_h*I_m+I_i*I_n+I_j*I_o,I_d[I_I+I_f]=I_g*I_p+I_h*I_s+I_i*I_t+I_j*I_u,I_d[I_J+I_f]=I_g*I_v+I_h*I_w+I_i*I_x+I_j*I_y,I_d[I_K+I_f]=I_g*I_z+I_h*I_A+I_i*I_B+I_j*I_C},I_I.createAffineTransformationArray=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_l){var I_m=I_d+I_d,I_n=I_e+I_e,I_o=I_f+I_f,I_p=I_d*I_m,I_s=I_d*I_n,I_t=I_d*I_o,I_u=I_e*I_n,I_v=I_e*I_o,I_w=I_f*I_o,I_x=I_g*I_m,I_y=I_g*I_n,I_z=I_g*I_o;I_k[I_l+0]=(1-(I_u+I_w))*I_h,I_k[I_l+1]=(I_s+I_z)*I_h,I_k[I_l+2]=(I_t-I_y)*I_h,I_k[I_l+3]=0,I_k[I_l+4]=(I_s-I_z)*I_i,I_k[I_l+5]=(1-(I_p+I_w))*I_i,I_k[I_l+6]=(I_v+I_x)*I_i,I_k[I_l+7]=0,I_k[I_l+8]=(I_t+I_y)*I_j,I_k[I_l+9]=(I_v-I_x)*I_j,I_k[I_l+10]=(1-(I_p+I_u))*I_j,I_k[I_l+11]=0,I_k[I_l+12]=I_a,I_k[I_l+13]=I_b,I_k[I_l+14]=I_c,I_k[I_l+15]=1},I_I.transformVector3ArrayToVector3ArrayCoordinate=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_I._tempArray4_0,I_g=I_a[I_b+0],I_h=I_a[I_b+1],I_i=I_a[I_b+2],I_j=I_c.elements;I_f[0]=I_g*I_j[0]+I_h*I_j[4]+I_i*I_j[8]+I_j[12],I_f[1]=I_g*I_j[1]+I_h*I_j[5]+I_i*I_j[9]+I_j[13],I_f[2]=I_g*I_j[2]+I_h*I_j[6]+I_i*I_j[10]+I_j[14],I_f[3]=1/(I_g*I_j[3]+I_h*I_j[7]+I_i*I_j[11]+I_j[15]),I_d[I_e+0]=I_f[0]*I_f[3],I_d[I_e+1]=I_f[1]*I_f[3],I_d[I_e+2]=I_f[2]*I_f[3]},I_I.transformLightingMapTexcoordByUV0Array=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_c.elements;I_d[I_e+0]=I_a[I_b+0]*I_f[0]+I_f[2],I_d[I_e+1]=(I_a[I_b+1]-1)*I_f[1]+I_f[3]},I_I.transformLightingMapTexcoordByUV1Array=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_c.elements;I_d[I_e+0]=I_a[I_b+0]*I_f[0]+I_f[2],I_d[I_e+1]=1+I_a[I_b+1]*I_f[1]+I_f[3]},I_I.getURLVerion=function(I_a){var I_b=I_a.indexOf("?");return 0<=I_b?I_a.substr(I_b):null},I_I._quaternionCreateFromYawPitchRollArray=function(I_a,I_b,I_c,I_d){var I_e=.5*I_c,I_f=.5*I_b,I_g=.5*I_a,I_h=Math.sin(I_e),I_i=Math.cos(I_e),I_j=Math.sin(I_f),I_k=Math.cos(I_f),I_l=Math.sin(I_g),I_m=Math.cos(I_g);I_d[0]=I_m*I_j*I_i+I_l*I_k*I_h,I_d[1]=I_l*I_k*I_i-I_m*I_j*I_h,I_d[2]=I_m*I_k*I_h-I_l*I_j*I_i,I_d[3]=I_m*I_k*I_i+I_l*I_j*I_h},I_I._createAffineTransformationArray=function(I_a,I_b,I_c,I_d){var I_e=I_b[0],I_f=I_b[1],I_g=I_b[2],I_h=I_b[3],I_i=I_e+I_e,I_j=I_f+I_f,I_k=I_g+I_g,I_l=I_e*I_i,I_m=I_e*I_j,I_n=I_e*I_k,I_o=I_f*I_j,I_p=I_f*I_k,I_s=I_g*I_k,I_t=I_h*I_i,I_u=I_h*I_j,I_v=I_h*I_k,I_w=I_c[0],I_x=I_c[1],I_y=I_c[2];I_d[0]=(1-(I_o+I_s))*I_w,I_d[1]=(I_m+I_v)*I_w,I_d[2]=(I_n-I_u)*I_w,I_d[3]=0,I_d[4]=(I_m-I_v)*I_x,I_d[5]=(1-(I_l+I_s))*I_x,I_d[6]=(I_p+I_t)*I_x,I_d[7]=0,I_d[8]=(I_n+I_u)*I_y,I_d[9]=(I_p-I_t)*I_y,I_d[10]=(1-(I_l+I_o))*I_y,I_d[11]=0,I_d[12]=I_a[0],I_d[13]=I_a[1],I_d[14]=I_a[2],I_d[15]=1},I_I._mulMatrixArray=function(I_a,I_b,I_c,I_d){var I_e,I_f,I_g,I_h,I_i,I_j=I_b.elements,I_k=I_j[0],I_l=I_j[1],I_m=I_j[2],I_n=I_j[3],I_o=I_j[4],I_p=I_j[5],I_s=I_j[6],I_t=I_j[7],I_u=I_j[8],I_v=I_j[9],I_w=I_j[10],I_x=I_j[11],I_y=I_j[12],I_z=I_j[13],I_A=I_j[14],I_B=I_j[15],I_C=I_d,I_D=I_d+4,I_E=I_d+8,I_F=I_d+12;for(I_e=0;I_e<4;I_e++)I_f=I_a[I_e],I_g=I_a[I_e+4],I_h=I_a[I_e+8],I_i=I_a[I_e+12],I_c[I_C+I_e]=I_f*I_k+I_g*I_l+I_h*I_m+I_i*I_n,I_c[I_D+I_e]=I_f*I_o+I_g*I_p+I_h*I_s+I_i*I_t,I_c[I_E+I_e]=I_f*I_u+I_g*I_v+I_h*I_w+I_i*I_x,I_c[I_F+I_e]=I_f*I_y+I_g*I_z+I_h*I_A+I_i*I_B},I_I.getYawPitchRoll=function(I_a,I_b){I_I.transformQuat(I_gb.ForwardRH,I_a,I_cb.TEMPVector31),I_I.transformQuat(I_gb.Up,I_a,I_cb.TEMPVector32);var I_c=I_cb.TEMPVector32.elements;I_I.angleTo(I_gb.ZERO,I_cb.TEMPVector31,I_cb.TEMPVector33);var I_d=I_cb.TEMPVector33.elements;I_d[0]==Math.PI/2?(I_d[1]=I_I.arcTanAngle(I_c[2],I_c[0]),I_d[2]=0):I_d[0]==-Math.PI/2?(I_d[1]=I_I.arcTanAngle(-I_c[2],-I_c[0]),I_d[2]=0):(I_ab.createRotationY(-I_d[1],I_cb.TEMPMatrix0),I_ab.createRotationX(-I_d[0],I_cb.TEMPMatrix1),I_gb.transformCoordinate(I_cb.TEMPVector32,I_cb.TEMPMatrix0,I_cb.TEMPVector32),I_gb.transformCoordinate(I_cb.TEMPVector32,I_cb.TEMPMatrix1,I_cb.TEMPVector32),I_d[2]=I_I.arcTanAngle(I_c[1],-I_c[0])),I_d[1]<=-Math.PI&&(I_d[1]=Math.PI),I_d[2]<=-Math.PI&&(I_d[2]=Math.PI),I_d[1]>=Math.PI&&I_d[2]>=Math.PI&&(I_d[1]=0,I_d[2]=0,I_d[0]=Math.PI-I_d[0]),I_b[0]=I_d[1],I_b[1]=I_d[0],I_b[2]=I_d[2]},I_I.arcTanAngle=function(I_a,I_b){return 0==I_a?1==I_b?Math.PI/2:-Math.PI/2:0<I_a?Math.atan(I_b/I_a):I_a<0?0<I_b?Math.atan(I_b/I_a)+Math.PI:Math.atan(I_b/I_a)-Math.PI:0},I_I.angleTo=function(I_a,I_b,I_c){I_gb.subtract(I_b,I_a,I_cb.TEMPVector30),I_gb.normalize(I_cb.TEMPVector30,I_cb.TEMPVector30),I_c.elements[0]=Math.asin(I_cb.TEMPVector30.y),I_c.elements[1]=I_I.arcTanAngle(-I_cb.TEMPVector30.z,-I_cb.TEMPVector30.x)},I_I.transformQuat=function(I_a,I_b,I_c){var I_d=I_c.elements,I_e=I_a.elements,I_f=I_b,I_g=I_e[0],I_h=I_e[1],I_i=I_e[2],I_j=I_f[0],I_k=I_f[1],I_l=I_f[2],I_m=I_f[3],I_n=I_m*I_g+I_k*I_i-I_l*I_h,I_o=I_m*I_h+I_l*I_g-I_j*I_i,I_p=I_m*I_i+I_j*I_h-I_k*I_g,I_s=-I_j*I_g-I_k*I_h-I_l*I_i;I_d[0]=I_n*I_m+I_s*-I_j+I_o*-I_l-I_p*-I_k,I_d[1]=I_o*I_m+I_s*-I_k+I_p*-I_j-I_n*-I_l,I_d[2]=I_p*I_m+I_s*-I_l+I_n*-I_k-I_o*-I_j},I_I.quaterionNormalize=function(I_a,I_b){var I_c=I_a[0],I_d=I_a[1],I_e=I_a[2],I_f=I_a[3],I_g=I_c*I_c+I_d*I_d+I_e*I_e+I_f*I_f;0<I_g&&(I_g=1/Math.sqrt(I_g),I_b[0]=I_c*I_g,I_b[1]=I_d*I_g,I_b[2]=I_e*I_g,I_b[3]=I_f*I_g)},I_I.matrix4x4MultiplyFFF=function(I_a,I_b,I_c){var I_d,I_e,I_f,I_g,I_h;if(I_c===I_b)for(I_b=new Float32Array(16),I_d=0;I_d<16;++I_d)I_b[I_d]=I_c[I_d];for(I_d=0;I_d<4;I_d++)I_e=I_a[I_d],I_f=I_a[I_d+4],I_g=I_a[I_d+8],I_h=I_a[I_d+12],I_c[I_d]=I_e*I_b[0]+I_f*I_b[1]+I_g*I_b[2]+I_h*I_b[3],I_c[I_d+4]=I_e*I_b[4]+I_f*I_b[5]+I_g*I_b[6]+I_h*I_b[7],I_c[I_d+8]=I_e*I_b[8]+I_f*I_b[9]+I_g*I_b[10]+I_h*I_b[11],I_c[I_d+12]=I_e*I_b[12]+I_f*I_b[13]+I_g*I_b[14]+I_h*I_b[15]},I_I.matrix4x4MultiplyMFM=function(I_a,I_b,I_c){I_I.matrix4x4MultiplyFFF(I_a.elements,I_b,I_c.elements)},I_l(I_I,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new I_gb},"_tempVector3_1",function(){return this._tempVector3_1=new I_gb},"_tempVector3_2",function(){return this._tempVector3_2=new I_gb},"_tempVector3_3",function(){return this._tempVector3_3=new I_gb},"_tempVector3_4",function(){return this._tempVector3_4=new I_gb},"_tempVector3_5",function(){return this._tempVector3_5=new I_gb},"_tempVector3_6",function(){return this._tempVector3_6=new I_gb},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),I_I}(),I_tb=function(){function I_G(){}return I_n(I_G,"Laya3D"),I_G._cancelLoadByUrl=function(I_a){I_x.loader.cancelLoadByUrl(I_a),I_G._innerFirstLevelLoaderManager.cancelLoadByUrl(I_a),I_G._innerSecondLevelLoaderManager.cancelLoadByUrl(I_a),I_G._innerThirdLevelLoaderManager.cancelLoadByUrl(I_a),I_G._innerFourthLevelLoaderManager.cancelLoadByUrl(I_a)},I_G._changeWebGLSize=function(I_a,I_b){I_F.onStageResize(I_a,I_b),I_Y.clientWidth=I_a,I_Y.clientHeight=I_b},I_G.__init__=function(){var I_a=I_b.createMap;I_a.lh=[I_Kb,"SPRITE3DHIERARCHY"],I_a.ls=[I_Jb,"SPRITE3DHIERARCHY"],I_a.lm=[I_Rb,"MESH"],I_a.lmat=[I_Mb,"MATERIAL"],I_a.jpg=[I_Tb,"nativeimage"],I_a.jpeg=[I_Tb,"nativeimage"],I_a.png=[I_Tb,"nativeimage"],I_a.pkm=[I_Tb,"arraybuffer"],I_a.raw=[I_Pb,"arraybuffer"],I_a.mipmaps=[I_Pb,"arraybuffer"],I_t.parserMap.SPRITE3DHIERARCHY=I_G._loadHierarchy,I_t.parserMap.MESH=I_G._loadMesh,I_t.parserMap.MATERIAL=I_G._loadMaterial,I_t.parserMap.TEXTURECUBE=I_G._loadTextureCube,I_t.parserMap.TERRAIN=I_G._loadTerrain,I_G._innerFirstLevelLoaderManager.on("error",null,I_G._eventLoadManagerError),I_G._innerSecondLevelLoaderManager.on("error",null,I_G._eventLoadManagerError),I_G._innerThirdLevelLoaderManager.on("error",null,I_G._eventLoadManagerError),I_G._innerFourthLevelLoaderManager.on("error",null,I_G._eventLoadManagerError)},I_G.READ_BLOCK=function(){return I_G._readData.pos+=4,!0},I_G.READ_DATA=function(){return I_G._DATA.offset=I_G._readData.getUint32(),I_G._DATA.size=I_G._readData.getUint32(),!0},I_G.READ_STRINGS=function(){var I_a=[],I_b={offset:0,size:0};I_b.offset=I_G._readData.getUint16(),I_b.size=I_G._readData.getUint16();I_G._readData.pos;I_G._readData.pos=I_b.offset+I_G._DATA.offset;for(var I_c=0;I_c<I_b.size;I_c++){var I_d=I_G._readData.readUTFString();-1===I_d.lastIndexOf(".lmat")&&-1===I_d.lastIndexOf(".lpbr")||I_a.push(I_d)}return I_a},I_G.formatRelativePath=function(I_a,I_b){var I_c;if("."===I_b.charAt(0)){for(var I_d=(I_a+I_b).split("/"),I_e=0,I_f=I_d.length;I_e<I_f;I_e++)if(".."==I_d[I_e]){var I_g=I_e-1;0<I_g&&".."!==I_d[I_g]&&(I_d.splice(I_g,2),I_e-=2)}I_c=I_d.join("/")}else I_c=I_a+I_b;return null!=I_E.customFormat&&(I_c=I_E.customFormat(I_c,null)),I_c},I_G._eventLoadManagerError=function(I_a){I_x.loader.event("error",I_a)},I_G._addHierarchyInnerUrls=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g=I_G.formatRelativePath(I_d,I_e);I_c&&(I_g+=I_c),I_a.push({url:I_g,clas:I_f}),I_b[I_e]=I_g},I_G._getSprite3DHierarchyInnerUrls=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){var I_h,I_i=0,I_j=0;switch(I_a.type){case"Scene":var I_k=I_a.customProps.lightmaps;for(I_i=0,I_j=I_k.length;I_i<I_j;I_i++){var I_l=I_k[I_i].replace(".exr",".png");I_G._addHierarchyInnerUrls(I_d,I_e,I_f,I_g,I_l,I_Tb)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var I_m;if(I_a.instanceParams)(I_m=I_a.instanceParams.loadPath)&&I_G._addHierarchyInnerUrls(I_b,I_e,I_f,I_g,I_m,I_Rb);else{(I_m=(I_h=I_a.customProps).meshPath)&&I_G._addHierarchyInnerUrls(I_b,I_e,I_f,I_g,I_m,I_Rb);var I_n=I_h.materials;if(I_n)for(I_i=0,I_j=I_n.length;I_i<I_j;I_i++){for(var I_o=I_n[I_i],I_p=I_o.type.split("."),I_s=I_H.window,I_t=0,I_u=I_p.length;I_t<I_u;++I_t){I_s=I_s[this.clasPaths[I_t]]}if("function"!=typeof I_s)throw"_getSprite3DHierarchyInnerUrls 错误: "+I_o.type+" 不是类";I_G._addHierarchyInnerUrls(I_c,I_e,I_f,I_g,I_o.path,I_s)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var I_v=(I_h=I_a.customProps).meshPath;I_v&&I_G._addHierarchyInnerUrls(I_b,I_e,I_f,I_g,I_v,I_Rb);var I_w=I_h.material;if(I_w){I_p=I_w.type.split("."),I_s=I_H.window;for(I_t=0,I_u=I_p.length;I_t<I_u;++I_t){I_s=I_s[this.clasPaths[I_t]]}I_G._addHierarchyInnerUrls(I_c,I_e,I_f,I_g,I_w.path,I_s)}else{var I_x=I_h.materialPath;if(I_x)I_G._addHierarchyInnerUrls(I_c,I_e,I_f,I_g,I_x,ShurikenParticleMaterial);else{var I_y=I_h.texturePath;I_y&&I_G._addHierarchyInnerUrls(I_d,I_e,I_f,I_g,I_y,I_Tb)}}break;case"Terrain":I_G._addHierarchyInnerUrls(I_d,I_e,I_f,I_g,I_a.customProps.dataPath,TerrainRes)}var I_z=I_a.components;for(var I_A in I_z){var I_B=I_z[I_A];switch(I_A){case"Animator":var I_C=I_B.avatarPath;if(I_C)I_G._addHierarchyInnerUrls(I_d,I_e,I_f,I_g,I_C,Avatar);else{var I_D=I_B.avatar;I_D&&I_G._addHierarchyInnerUrls(I_d,I_e,I_f,I_g,I_D.path,Avatar)}var I_E=I_B.clipPaths;for(I_i=0,I_j=I_E.length;I_i<I_j;I_i++)I_G._addHierarchyInnerUrls(I_d,I_e,I_f,I_g,I_E[I_i],AnimationClip)}}var I_F=I_a.child;for(I_i=0,I_j=I_F.length;I_i<I_j;I_i++)I_G._getSprite3DHierarchyInnerUrls(I_F[I_i],I_b,I_c,I_d,I_e,I_f,I_g)},I_G._loadHierarchy=function(I_a){I_a.on("loaded",null,I_G._onHierarchylhLoaded,[I_a,I_a._class._getGroup()]),I_a.load(I_a.url,"json",!1,null,!0)},I_G._onHierarchylhLoaded=function(I_a,I_b,I_c){if(I_a._class.destroyed)I_a.endLoad();else{var I_d=I_a.url,I_e=I_sb.getURLVerion(I_d),I_f=I_E.getPath(I_d),I_g=[],I_h=[],I_i=[],I_j={};I_G._getSprite3DHierarchyInnerUrls(I_c,I_g,I_h,I_i,I_j,I_e,I_f);var I_k=I_g.length+I_h.length+I_i.length,I_l=I_k+1,I_m=1/I_l;if(I_G._onProcessChange(I_a,0,I_m,1),0<I_i.length){var I_n=I_k/I_l,I_o=I_D.create(null,I_G._onProcessChange,[I_a,I_m,I_n],!1);I_G._innerFourthLevelLoaderManager.create(I_i,I_D.create(null,I_G._onHierarchyInnerForthLevResouLoaded,[I_a,I_b,I_o,I_c,I_j,I_g,I_h,I_m+I_n*I_i.length,I_n]),I_o,null,null,1,!0,I_b)}else I_G._onHierarchyInnerForthLevResouLoaded(I_a,I_b,null,I_c,I_j,I_g,I_h,I_m,I_n)}},I_G._onHierarchyInnerForthLevResouLoaded=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){if(I_a._class.destroyed)I_a.endLoad();else if(I_c&&I_c.recover(),0<I_g.length){var I_j=I_D.create(null,I_G._onProcessChange,[I_a,I_h,I_i],!1);I_G._innerSecondLevelLoaderManager.create(I_g,I_D.create(null,I_G._onHierarchyInnerSecondLevResouLoaded,[I_a,I_b,I_j,I_d,I_e,I_f,I_h+I_i*I_g.length,I_i]),I_c,null,null,1,!0,I_b)}else I_G._onHierarchyInnerSecondLevResouLoaded(I_a,I_b,null,I_d,I_e,I_f,I_h,I_i)},I_G._onHierarchyInnerSecondLevResouLoaded=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h){if(I_a._class.destroyed)I_a.endLoad();else if(I_c&&I_c.recover(),0<I_f.length){var I_i=I_D.create(null,I_G._onProcessChange,[I_a,I_g,I_h],!1);I_G._innerFirstLevelLoaderManager.create(I_f,I_D.create(null,I_G._onHierarchyInnerFirstLevResouLoaded,[I_a,I_i,I_d,I_e]),I_c,null,null,1,!0,I_b)}else I_G._onHierarchyInnerFirstLevResouLoaded(I_a,null,I_d,I_e)},I_G._onHierarchyInnerFirstLevResouLoaded=function(I_a,I_b,I_c,I_d){I_b&&I_b.recover(),I_a.endLoad([I_c,I_d])},I_G._loadTerrain=function(I_a){I_a.on("loaded",null,I_G._onTerrainLtLoaded,[I_a,I_a._class._getGroup()]),I_a.load(I_a.url,"json",!1,null,!0)},I_G._onTerrainLtLoaded=function(I_a,I_b,I_c){if(I_a._class.destroyed)I_a.endLoad();else{var I_d,I_e,I_f=I_a.url,I_g=I_sb.getURLVerion(I_f),I_h=I_E.getPath(I_f),I_i=[],I_j={},I_k=0,I_l=0,I_m=I_c.heightData;I_d=I_m.url,I_e=I_G.formatRelativePath(I_h,I_d),I_g&&(I_e+=I_g),I_d=I_j[I_d]=I_e;var I_n=I_c.detailTexture;for(I_k=0,I_l=I_n.length;I_k<I_l;I_k++)I_i.push({url:I_n[I_k].diffuse});var I_o=I_c.normalMap;for(I_k=0,I_l=I_o.length;I_k<I_l;I_k++)I_i.push({url:I_o[I_k]});var I_p=I_c.alphaMap;for(I_k=0,I_l=I_p.length;I_k<I_l;I_k++)I_i.push({url:I_p[I_k],params:[!1,!1,6408,!0]});for(I_k=0,I_l=I_i.length;I_k<I_l;I_k++){var I_s=I_i[I_k].url;I_e=I_G.formatRelativePath(I_h,I_s),I_g&&(I_e+=I_g),I_i[I_k].url=I_e,I_j[I_s]=I_e}var I_t=I_i.length,I_u=I_t+2,I_v=1/I_u;I_G._onProcessChange(I_a,0,I_v,1);var I_w={heightMapLoaded:!1,texturesLoaded:!1},I_x=I_D.create(null,I_G._onProcessChange,[I_a,I_v,I_v],!1);I_G._innerFourthLevelLoaderManager.create(I_d,I_D.create(null,I_G._onTerrainHeightMapLoaded,[I_a,I_x,I_c,I_j,I_w]),I_x,null,[I_m.numX,I_m.numZ,I_m.bitType,I_m.value],1,!0,I_b);var I_y=I_D.create(null,I_G._onProcessChange,[I_a,2*I_v,I_t/I_u],!1);I_G._innerFourthLevelLoaderManager.create(I_i,I_D.create(null,I_G._onTerrainTexturesLoaded,[I_a,I_y,I_c,I_j,I_w]),I_y,null,null,1,!0,I_b)}},I_G._onTerrainHeightMapLoaded=function(I_a,I_b,I_c,I_d,I_e){I_e.heightMapLoaded=!0,I_e.texturesLoaded&&(I_a.endLoad([I_c,I_d]),I_b.recover())},I_G._onTerrainTexturesLoaded=function(I_a,I_b,I_c,I_d,I_e){I_e.texturesLoaded=!0,I_e.heightMapLoaded&&(I_a.endLoad([I_c,I_d]),I_b.recover())},I_G._loadMesh=function(I_a){I_a.on("loaded",null,I_G._onMeshLmLoaded,[I_a,I_a._class._getGroup()]),I_a.load(I_a.url,"arraybuffer",!1,null,!0)},I_G._onMeshLmLoaded=function(I_a,I_b,I_c){if(I_a._class.destroyed)I_a.endLoad();else{var I_d,I_e,I_f,I_g=I_a.url,I_h=I_sb.getURLVerion(I_g),I_i=I_E.getPath(I_g),I_j={},I_k=0,I_l=0;switch((I_G._readData=new I_y(I_c)).pos=0,I_G._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var I_m=I_G._readData.getUint32();I_G._readData.pos=I_G._readData.pos+4,I_l=I_G._readData.getUint16(),I_G._readData.pos=I_G._readData.pos+8*I_l;var I_n=I_G._readData.getUint32();for(I_l=I_G._readData.getUint16(),I_G._readData.pos=I_m+I_n,I_d=[],I_k=0;I_k<I_l;I_k++){var I_o=I_G._readData.readUTFString();-1!==I_o.lastIndexOf(".lmat")&&I_d.push(I_o)}break;default:for(I_G.READ_BLOCK(),I_k=0;I_k<2;I_k++){var I_p=I_G._readData.getUint16(),I_s=I_G._strings[I_p],I_t=I_G["READ_"+I_s];if(null==I_t)throw new Error("model file err,no this function:"+I_p+" "+I_s);1===I_k?I_d=I_t.call():I_t.call()}}for(I_k=0,I_f=I_d.length;I_k<I_f;I_k++){var I_u=I_d[I_k];I_e=I_G.formatRelativePath(I_i,I_u),I_h&&(I_e+=I_h),I_d[I_k]=I_e,I_j[I_u]=I_e}if(0<I_d.length){I_G._onProcessChange(I_a,0,.5,1);var I_v=I_D.create(null,I_G._onProcessChange,[I_a,.5,.5],!1);I_G._innerSecondLevelLoaderManager.create(I_d,I_D.create(null,I_G._onMeshMateialLoaded,[I_a,I_v,I_c,I_j]),I_v,null,null,1,!0,I_b)}else I_a.endLoad([I_c,I_j])}},I_G._onMeshMateialLoaded=function(I_a,I_b,I_c,I_d){I_a.endLoad([I_c,I_d]),I_b.recover()},I_G._getMaterialTexturePath=function(I_a,I_b,I_c){var I_d=I_a.length-4;return I_a.indexOf(".dds")!=I_d&&I_a.indexOf(".tga")!=I_d&&I_a.indexOf(".exr")!=I_d&&I_a.indexOf(".DDS")!=I_d&&I_a.indexOf(".TGA")!=I_d&&I_a.indexOf(".EXR")!=I_d||(I_a=I_a.substr(0,I_d)+".png"),I_a=I_G.formatRelativePath(I_c,I_a),I_b&&(I_a+=I_b),I_a},I_G._loadMaterial=function(I_a){I_a.on("loaded",null,I_G._onMaterilLmatLoaded,[I_a,I_a._class._getGroup()]),I_a.load(I_a.url,"json",!1,null,!0)},I_G._onMaterilLmatLoaded=function(I_a,I_b,I_c){if(I_a._class.destroyed)I_a.endLoad();else{var I_d,I_e=I_a.url,I_f=I_sb.getURLVerion(I_e),I_g=I_E.getPath(I_e),I_h=[],I_i={},I_j=I_c.customProps,I_k=I_c.version;if(I_k)switch(I_k){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var I_l=I_c.props.textures,I_m=0,I_n=I_l.length;I_m<I_n;I_m++){var I_o=I_l[I_m],I_p=I_o.path;if(I_p){var I_s=I_p.length-4;I_p.indexOf(".exr")!=I_s&&I_p.indexOf(".EXR")!=I_s||(I_p=I_p.substr(0,I_s)+".png"),I_d=I_G.formatRelativePath(I_g,I_p),I_f&&(I_d+=I_f),I_h.push({url:I_d,params:I_o.params}),I_i[I_p]=I_d}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var I_t=I_j.diffuseTexture.texture2D;if(I_t&&(I_d=I_G._getMaterialTexturePath(I_t,I_f,I_g),I_h.push(I_d),I_i[I_t]=I_d),I_j.normalTexture){var I_u=I_j.normalTexture.texture2D;I_u&&(I_d=I_G._getMaterialTexturePath(I_u,I_f,I_g),I_h.push(I_d),I_i[I_u]=I_d)}if(I_j.specularTexture){var I_v=I_j.specularTexture.texture2D;I_v&&(I_d=I_G._getMaterialTexturePath(I_v,I_f,I_g),I_h.push(I_d),I_i[I_v]=I_d)}if(I_j.emissiveTexture){var I_w=I_j.emissiveTexture.texture2D;I_w&&(I_d=I_G._getMaterialTexturePath(I_w,I_f,I_g),I_h.push(I_d),I_i[I_w]=I_d)}if(I_j.ambientTexture){var I_x=I_j.ambientTexture.texture2D;I_x&&(I_d=I_G._getMaterialTexturePath(I_x,I_f,I_g),I_h.push(I_d),I_i[I_x]=I_d)}if(I_j.reflectTexture){var I_y=I_j.reflectTexture.texture2D;I_y&&(I_d=I_G._getMaterialTexturePath(I_y,I_f,I_g),I_h.push(I_d),I_i[I_y]=I_d)}}var I_z=I_h.length,I_A=I_z+1,I_B=1/I_A;if(I_G._onProcessChange(I_a,0,I_B,1),0<I_z){var I_C=I_D.create(null,I_G._onProcessChange,[I_a,I_B,I_z/I_A],!1);I_G._innerFourthLevelLoaderManager.create(I_h,I_D.create(null,I_G._onMateialTexturesLoaded,[I_a,I_C,I_c,I_i]),I_C,I_Tb,null,1,!0,I_b)}else I_G._onMateialTexturesLoaded(I_a,null,I_c,null)}},I_G._onMateialTexturesLoaded=function(I_a,I_b,I_c,I_d){I_a.endLoad([I_c,I_d]),I_b&&I_b.recover()},I_G._loadTextureCube=function(I_a){I_a.on("loaded",null,I_G._onTextureCubeLtcLoaded,[I_a]),I_a.load(I_a.url,"json",!1,null,!0)},I_G._onTextureCubeLtcLoaded=function(I_a,I_b){if(I_a._class.destroyed)I_a.endLoad();else{var I_c=I_E.getPath(I_a.url),I_d=[I_G.formatRelativePath(I_c,I_b.px),I_G.formatRelativePath(I_c,I_b.nx),I_G.formatRelativePath(I_c,I_b.py),I_G.formatRelativePath(I_c,I_b.ny),I_G.formatRelativePath(I_c,I_b.pz),I_G.formatRelativePath(I_c,I_b.nz)];I_G._onProcessChange(I_a,0,1/7,1);var I_e=I_D.create(null,I_G._onProcessChange,[I_a,1/7,6/7],!1);I_G._innerFourthLevelLoaderManager.load(I_d,I_D.create(null,I_G._onTextureCubeImagesLoaded,[I_a,I_d,I_e]),I_e,"nativeimage")}},I_G._onTextureCubeImagesLoaded=function(I_a,I_b,I_c){var I_d=[];I_d.length=6;for(var I_e=0;I_e<6;I_e++){var I_f=I_b[I_e];I_d[I_e]=I_t.getRes(I_f),I_t.clearRes(I_f)}I_a.endLoad(I_d),I_c.recover()},I_G._onProcessChange=function(I_a,I_b,I_c,I_d){(I_d=I_b+I_d*I_c)<1&&I_a.event("progress",I_d)},I_G.init=function(I_a,I_b,I_c,I_d,I_e,I_f){if(void 0===I_c&&(I_c=!1),void 0===I_d&&(I_d=!1),void 0===I_e&&(I_e=!0),void 0===I_f&&(I_f=!0),I_u.update3DLoop=function(){},I_u.cancelLoadByUrl=function(I_a){I_G._cancelLoadByUrl(I_a)},I_i.isAntialias=I_c,I_i.isAlpha=I_d,I_i.premultipliedAlpha=I_e,I_i.isStencil=I_f,!I_F.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");I_u.changeWebGLSize=I_G._changeWebGLSize,I_p.is3DMode=!0,I_x.init(I_a,I_b),I_I.__init__(),I_lb.__init__(),I_Xb.__init__(),I_Q.__init__(),I_G.__init__(),I_g.maxTextureCount=2,(I_G.debugMode||I_Z.debugMode)&&(I_G._debugPhasorSprite=new I_V)},I_G.HIERARCHY="SPRITE3DHIERARCHY",I_G.MESH="MESH",I_G.MATERIAL="MATERIAL",I_G.PBRMATERIAL="PBRMTL",I_G.TEXTURECUBE="TEXTURECUBE",I_G.TERRAIN="TERRAIN",I_G._readData=null,I_G._debugPhasorSprite=null,I_G.debugMode=!1,I_l(I_G,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new I_b},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new I_b},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new I_b},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new I_b}]),I_G}(),I_ub=function(I_a){function I_e(I_a){I_e.__super.call(this),this._owner=I_a,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}I_n(I_e,"laya.d3.animation.AnimationTransform3D",I_f);var I_b=I_e.prototype;return I_b._getlocalMatrix=function(){return this._localUpdate&&(I_sb._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},I_b._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var I_a=0,I_b=this._childs.length;I_a<I_b;I_a++)this._childs[I_a]._onWorldTransform()}},I_b._setWorldMatrixAndUpdate=function(I_a){if(this._worldMatrix=I_a,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var I_b=this._getlocalMatrix(),I_c=0;I_c<16;++I_c)this._worldMatrix[I_c]=I_b[I_c];else I_sb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},I_b._setWorldMatrixNoUpdate=function(I_a){this._worldMatrix=I_a},I_b._setWorldMatrixIgnoreUpdate=function(I_a){this._worldMatrix=I_a,this._worldUpdate=!1},I_b.getLocalPosition=function(){return this._localPosition},I_b.setLocalPosition=function(I_a){if(this._parent)this._localPosition=I_a,this._localUpdate=!0,this._onWorldTransform();else{var I_b=this._entity.owner._transform,I_c=this._entity.localPosition,I_d=I_c.elements;I_d[0]=I_a[0],I_d[1]=I_a[1],I_d[2]=I_a[2],I_b.localPosition=I_c}},I_b.getLocalRotation=function(){if(this._localQuaternionUpdate){var I_a=this._localRotationEuler;I_sb._quaternionCreateFromYawPitchRollArray(I_a[1]/I_e._angleToRandin,I_a[0]/I_e._angleToRandin,I_a[2]/I_e._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},I_b.setLocalRotation=function(I_a){if(this._parent)this._localRotation=I_a,I_sb.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var I_b=this._entity.owner._transform,I_c=this._entity.localRotation,I_d=I_c.elements;I_d[0]=I_a[0],I_d[1]=I_a[1],I_d[2]=I_a[2],I_d[3]=I_a[3],I_b.localRotation=I_c}},I_b.getLocalScale=function(){return this._localScale},I_b.setLocalScale=function(I_a){if(this._parent)this._localScale=I_a,this._localUpdate=!0,this._onWorldTransform();else{var I_b=this._entity.owner._transform,I_c=this._entity.localScale,I_d=I_c.elements;I_d[0]=I_a[0],I_d[1]=I_a[1],I_d[2]=I_a[2],I_b.localScale=I_c}},I_b.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){I_sb.getYawPitchRoll(this._localRotation,I_e._tempVector3);var I_a=I_e._tempVector3,I_b=this._localRotationEuler;I_b[0]=I_a[1]*I_e._angleToRandin,I_b[1]=I_a[0]*I_e._angleToRandin,I_b[2]=I_a[2]*I_e._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},I_b.setLocalRotationEuler=function(I_a){if(this._parent)I_sb._quaternionCreateFromYawPitchRollArray(I_a[1]/I_e._angleToRandin,I_a[0]/I_e._angleToRandin,I_a[2]/I_e._angleToRandin,this._localRotation),this._localRotationEuler=I_a,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var I_b=this._entity.owner._transform,I_c=this._entity.localRotationEuler,I_d=I_c.elements;I_d[0]=I_a[0],I_d[1]=I_a[1],I_d[2]=I_a[2],I_b.localRotationEuler=I_c}},I_b.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)I_sb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var I_a=this._getlocalMatrix(),I_b=0;I_b<16;++I_b)this._worldMatrix[I_b]=I_a[I_b];this._worldUpdate=!1}return this._worldMatrix},I_b.setParent=function(I_a){if(this._parent!==I_a){if(this._parent){var I_b=this._parent._childs,I_c=I_b.indexOf(this);I_b.splice(I_c,1)}I_a&&(I_a._childs.push(this),I_a&&this._onWorldTransform()),this._parent=I_a}},I_l(I_e,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),I_e}(),I_vb=function(I_a){function I_b(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,I_b.__super.call(this),this._destroyed=!1,this._id=I_b._uniqueIDCounter,I_b._uniqueIDCounter++}I_n(I_b,"laya.d3.component.Component3D",I_f);var I_c=I_b.prototype;return I_x.imps(I_c,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),I_c._initialize=function(I_a){this._owner=I_a,this._enable=!0,this.started=!1,this._load(I_a)},I_c._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},I_c._load=function(I_a){},I_c._start=function(I_a){},I_c._update=function(I_a){},I_c._lateUpdate=function(I_a){},I_c._preRenderUpdate=function(I_a){},I_c._postRenderUpdate=function(I_a){},I_c._unload=function(I_a){this.offAll()},I_c._cloneTo=function(I_a){},I_o(0,I_c,"id",function(){return this._id}),I_o(0,I_c,"destroyed",function(){return this._destroyed}),I_o(0,I_c,"owner",function(){return this._owner}),I_o(0,I_c,"enable",function(){return this._enable},function(I_a){this._enable!==I_a&&(this._enable=I_a,this.event("enablechanged",this._enable))}),I_o(0,I_c,"isSingleton",function(){return I_b._isSingleton}),I_b._isSingleton=!0,I_b._uniqueIDCounter=1,I_b}(),I_wb=function(I_a){function I_b(){this._destroyed=!1,I_b.__super.call(this),this._destroyed=!1}I_n(I_b,"laya.d3.core.GeometryFilter",I_f);var I_c=I_b.prototype;return I_x.imps(I_c,{"laya.resource.IDestroy":!0}),I_c._destroy=function(){this.offAll(),this._destroyed=!0},I_o(0,I_c,"_isAsyncLoaded",function(){return!0}),I_o(0,I_c,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),I_o(0,I_c,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),I_o(0,I_c,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),I_o(0,I_c,"destroyed",function(){return this._destroyed}),I_b}(),I_xb=function(I_a){function I_d(I_a){I_d.__super.call(this),this._id=++I_d._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new I_Za(new I_gb,new I_gb),this._boundingBoxCenter=new I_gb,this._boundingSphere=new I__a(new I_gb,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=I_a,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}I_n(I_d,"laya.d3.core.render.BaseRender",I_f);var I_b=I_d.prototype;return I_x.imps(I_b,{"laya.resource.IDestroy":!0}),I_b._changeMaterialReference=function(I_a,I_b){I_a&&I_a._removeReference(),I_b._addReference()},I_b._getInstanceMaterial=function(I_a,I_b){var I_c=new I_a.constructor;return I_a.cloneTo(I_c),I_c.name=I_c.name+"(Instance)",this._materialsInstance[I_b]=!0,this._changeMaterialReference(this._materials[I_b],I_c),this._materials[I_b]=I_c},I_b._setShaderValuelightMap=function(I_a){this._setShaderValueTexture(3,I_a)},I_b._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},I_b._renderRenderableBoundBox=function(){var I_a=I_tb._debugPhasorSprite,I_b=this.boundingBox,I_c=I_d._tempBoundBoxCorners;I_b.getCorners(I_c),I_a.line(I_c[0],I_d._greenColor,I_c[1],I_d._greenColor),I_a.line(I_c[2],I_d._greenColor,I_c[3],I_d._greenColor),I_a.line(I_c[4],I_d._greenColor,I_c[5],I_d._greenColor),I_a.line(I_c[6],I_d._greenColor,I_c[7],I_d._greenColor),I_a.line(I_c[0],I_d._greenColor,I_c[3],I_d._greenColor),I_a.line(I_c[1],I_d._greenColor,I_c[2],I_d._greenColor),I_a.line(I_c[2],I_d._greenColor,I_c[6],I_d._greenColor),I_a.line(I_c[3],I_d._greenColor,I_c[7],I_d._greenColor),I_a.line(I_c[0],I_d._greenColor,I_c[4],I_d._greenColor),I_a.line(I_c[1],I_d._greenColor,I_c[5],I_d._greenColor),I_a.line(I_c[4],I_d._greenColor,I_c[7],I_d._greenColor),I_a.line(I_c[5],I_d._greenColor,I_c[6],I_d._greenColor)},I_b._calculateBoundingSphere=function(){throw"BaseRender: must override it."},I_b._calculateBoundingBox=function(){throw"BaseRender: must override it."},I_b._setShaderValueTexture=function(I_a,I_b){this._owner._shaderValues.setValue(I_a,I_b)},I_b._setShaderValueMatrix4x4=function(I_a,I_b){this._owner._shaderValues.setValue(I_a,I_b?I_b.elements:null)},I_b._setShaderValueColor=function(I_a,I_b){this._owner._shaderValues.setValue(I_a,I_b?I_b.elements:null)},I_b._setShaderValueBuffer=function(I_a,I_b){this._owner._shaderValues.setValue(I_a,I_b)},I_b._setShaderValueInt=function(I_a,I_b){this._owner._shaderValues.setValue(I_a,I_b)},I_b._setShaderValueBool=function(I_a,I_b){this._owner._shaderValues.setValue(I_a,I_b)},I_b._setShaderValueNumber=function(I_a,I_b){this._owner._shaderValues.setValue(I_a,I_b)},I_b._setShaderValueVector2=function(I_a,I_b){this._owner._shaderValues.setValue(I_a,I_b?I_b.elements:null)},I_b._addShaderDefine=function(I_a){this._owner._shaderDefineValue|=I_a},I_b._removeShaderDefine=function(I_a){this._owner._shaderDefineValue&=~I_a},I_b._renderUpdate=function(I_a){return!0},I_b._applyLightMapParams=function(){if(0<=this._lightmapIndex){var I_a=this._owner.scene;if(I_a){var I_b=I_a.getlightmaps()[this._lightmapIndex];I_b?(this._addShaderDefine(I_Vb.SAHDERDEFINE_LIGHTMAP),I_b.loaded?this._setShaderValuelightMap(I_b):I_b.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(I_Vb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(I_Vb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(I_Vb.SAHDERDEFINE_LIGHTMAP)},I_b._updateOctreeNode=function(){var I_a=this._treeNode;I_a&&this._octreeNodeNeedChange&&(I_a.updateObject(this),this._octreeNodeNeedChange=!1)},I_b._destroy=function(){this.offAll();var I_a=0,I_b=0;for(I_a=0,I_b=this._renderElements.length;I_a<I_b;I_a++)this._renderElements[I_a]._destroy();for(I_a=0,I_b=this._materials.length;I_a<I_b;I_a++)this._materials[I_a]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},I_o(0,I_b,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),I_o(0,I_b,"id",function(){return this._id}),I_o(0,I_b,"material",function(){var I_a=this._materials[0];if(I_a&&!this._materialsInstance[0]){var I_b=this._getInstanceMaterial(I_a,0);this.event("materialchanged",[this,0,I_b])}return this._materials[0]},function(I_a){this.sharedMaterial=I_a}),I_o(0,I_b,"sharedMaterial",function(){return this._materials[0]},function(I_a){var I_b=this._materials[0];I_b!==I_a&&(this._materials[0]=I_a,this._materialsInstance[0]=!1,this._changeMaterialReference(I_b,I_a),this.event("materialchanged",[this,0,I_a]))}),I_o(0,I_b,"lightmapIndex",function(){return this._lightmapIndex},function(I_a){this._lightmapIndex=I_a,this._applyLightMapParams()}),I_o(0,I_b,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(I_a){this._lightmapScaleOffset=I_a,this._setShaderValueColor(2,I_a),this._addShaderDefine(I_Vb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),I_o(0,I_b,"enable",function(){return this._enable},function(I_a){this._enable=I_a,this.event("enablechanged",[this,I_a])}),I_o(0,I_b,"materials",function(){for(var I_a=0,I_b=this._materials.length;I_a<I_b;I_a++)if(!this._materialsInstance[I_a]){var I_c=this._getInstanceMaterial(this._materials[I_a],I_a);this.event("materialchanged",[this,I_a,I_c])}return this._materials.slice()},function(I_a){this.sharedMaterials=I_a}),I_o(0,I_b,"sharedMaterials",function(){return this._materials.slice()},function(I_a){if(!I_a)throw new Error("MeshRender: shadredMaterials value can't be null.");var I_b=I_a.length;this._materialsInstance.length=I_b;for(var I_c=0;I_c<I_b;I_c++){var I_d=this._materials[I_c];I_d!==I_a[I_c]&&(this._materialsInstance[I_c]=!1,this._changeMaterialReference(I_d,I_a[I_c]),this.event("materialchanged",[this,I_c,I_a[I_c]]))}this._materials=I_a}),I_o(0,I_b,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),I_o(0,I_b,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var I_a=this.boundingBox;I_gb.add(I_a.min,I_a.max,this._boundingBoxCenter),I_gb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),I_o(0,I_b,"receiveShadow",function(){return this._receiveShadow},function(I_a){this._receiveShadow!==I_a&&((this._receiveShadow=I_a)?this._addShaderDefine(I_nb.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(I_nb.SHADERDEFINE_RECEIVE_SHADOW))}),I_o(0,I_b,"destroyed",function(){return this._destroyed}),I_d._uniqueIDCounter=0,I_l(I_d,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new I_gb,new I_gb,new I_gb,new I_gb,new I_gb,new I_gb,new I_gb,new I_gb]},"_greenColor",function(){return this._greenColor=new I_hb(0,1,0,1)}]),I_d}(),I_yb=function(I_a){function I_h(I_a){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,I_h.__super.call(this),this._localPosition=new I_gb,this._localRotation=new I_cb(0,0,0,1),this._localScale=new I_gb(1,1,1),this._localRotationEuler=new I_gb,this._localMatrix=new I_ab,this._position=new I_gb,this._rotation=new I_cb(0,0,0,1),this._scale=new I_gb(1,1,1),this._worldMatrix=new I_ab,this._forward=new I_gb,this._up=new I_gb,this._right=new I_gb,this._owner=I_a,this._childs=[]}I_n(I_h,"laya.d3.core.Transform3D",I_f);var I_b=I_h.prototype;return I_b._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)I_ab.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var I_a=I_h._tempVector30;I_gb.multiply(this.pivot,this._localScale,I_a);var I_b=I_h._tempVector31;I_gb.subtract(I_a,this.pivot,I_b);var I_c=I_h._tempVector32,I_d=this.localRotation;I_gb.transformQuat(I_a,I_d,I_c),I_gb.subtract(I_c,I_a,I_c);var I_e=I_h._tempVector33;I_gb.subtract(this._localPosition,I_b,I_e),I_gb.subtract(I_e,I_c,I_e),I_ab.createAffineTransformation(I_e,I_d,this._localScale,this._localMatrix)}},I_b._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var I_a=0,I_b=this._childs.length;I_a<I_b;I_a++)this._childs[I_a]._onWorldPositionRotationTransform()}},I_b._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var I_a=0,I_b=this._childs.length;I_a<I_b;I_a++)this._childs[I_a]._onWorldPositionScaleTransform()}},I_b._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var I_a=0,I_b=this._childs.length;I_a<I_b;I_a++)this._childs[I_a]._onWorldPositionTransform()}},I_b._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var I_a=0,I_b=this._childs.length;I_a<I_b;I_a++)this._childs[I_a]._onWorldPositionRotationTransform()}},I_b._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var I_a=0,I_b=this._childs.length;I_a<I_b;I_a++)this._childs[I_a]._onWorldPositionScaleTransform()}},I_b._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var I_a=0,I_b=this._childs.length;I_a<I_b;I_a++)this._childs[I_a]._onWorldTransform()}},I_b.translate=function(I_a,I_b){void 0===I_b&&(I_b=!0),I_b?(I_ab.createFromQuaternion(this.localRotation,I_h._tempMatrix0),I_gb.transformCoordinate(I_a,I_h._tempMatrix0,I_h._tempVector30),I_gb.add(this.localPosition,I_h._tempVector30,this._localPosition),this.localPosition=this._localPosition):(I_gb.add(this.position,I_a,this._position),this.position=this._position)},I_b.rotate=function(I_a,I_b,I_c){var I_d;void 0===I_b&&(I_b=!0),void 0===I_c&&(I_c=!0),I_d=I_c?I_a:(I_gb.scale(I_a,Math.PI/180,I_h._tempVector30),I_h._tempVector30),I_cb.createFromYawPitchRoll(I_d.y,I_d.x,I_d.z,I_h._tempQuaternion0),I_b?(I_cb.multiply(this._localRotation,I_h._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(I_cb.multiply(I_h._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},I_b.lookAt=function(I_a,I_b,I_c){void 0===I_c&&(I_c=!1);var I_d,I_e=I_a.elements;if(I_c){if(I_d=this._localPosition.elements,Math.abs(I_d[0]-I_e[0])<I_qa.zeroTolerance&&Math.abs(I_d[1]-I_e[1])<I_qa.zeroTolerance&&Math.abs(I_d[2]-I_e[2])<I_qa.zeroTolerance)return;I_cb.lookAt(this._localPosition,I_a,I_b,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var I_f=this.position;if(I_d=I_f.elements,Math.abs(I_d[0]-I_e[0])<I_qa.zeroTolerance&&Math.abs(I_d[1]-I_e[1])<I_qa.zeroTolerance&&Math.abs(I_d[2]-I_e[2])<I_qa.zeroTolerance)return;I_cb.lookAt(I_f,I_a,I_b,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},I_o(0,I_b,"_isFrontFaceInvert",function(){var I_a=this.scale,I_b=I_a.x<0;return I_a.y<0&&(I_b=!I_b),I_a.z<0&&(I_b=!I_b),I_b}),I_o(0,I_b,"owner",function(){return this._owner}),I_o(0,I_b,"localRotation",function(){if(this._localQuaternionUpdate){var I_a=this._localRotationEuler.elements;I_cb.createFromYawPitchRoll(I_a[1]/I_h._angleToRandin,I_a[0]/I_h._angleToRandin,I_a[2]/I_h._angleToRandin,this._localRotation)}return this._localRotation},function(I_a){this._localRotation=I_a,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),I_o(0,I_b,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?I_ab.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(I_a){null===this._parent?I_a.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),I_ab.multiply(this._localMatrix,I_a,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=I_a,this._worldUpdate=!1}),I_o(0,I_b,"worldNeedUpdate",function(){return this._worldUpdate}),I_o(0,I_b,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(I_a){this._localMatrix=I_a,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),I_o(0,I_b,"dummy",function(){return this._dummy},function(I_a){this._dummy!==I_a&&(this._dummy&&(this._dummy._entity=null),I_a&&(I_a._entity=this),this._dummy=I_a)}),I_o(0,I_b,"localPosition",function(){return this._localPosition},function(I_a){this._localPosition=I_a,this._localUpdate=!0,this._onWorldPositionTransform()}),I_o(0,I_b,"position",function(){if(this._positionUpdate){if(null!=this._parent){var I_a=this._parent.position;I_gb.multiply(this._localPosition,this._parent.scale,I_h._tempVector30),I_gb.transformQuat(I_h._tempVector30,this._parent.rotation,I_h._tempVector30),I_gb.add(I_a,I_h._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(I_a){if(null!=this._parent){I_gb.subtract(I_a,this._parent.position,this._localPosition);var I_b=this._parent.scale.elements,I_c=I_b[0],I_d=I_b[1],I_e=I_b[2];if(1!==I_c||1!==I_d||1!==I_e){var I_f=I_h._tempVector30,I_g=I_f.elements;I_g[0]=1/I_c,I_g[1]=1/I_d,I_g[2]=1/I_e,I_gb.multiply(this._localPosition,I_f,this._localPosition)}this._parent.rotation.invert(I_h._tempQuaternion0),I_gb.transformQuat(this._localPosition,I_h._tempQuaternion0,this._localPosition)}else I_a.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=I_a,this._positionUpdate=!1}),I_o(0,I_b,"localScale",function(){return this._localScale},function(I_a){this._localScale=I_a,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),I_o(0,I_b,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(I_h._tempVector30);var I_a=I_h._tempVector30.elements,I_b=this._localRotationEuler.elements;I_b[0]=I_a[1]*I_h._angleToRandin,I_b[1]=I_a[0]*I_h._angleToRandin,I_b[2]=I_a[2]*I_h._angleToRandin}return this._localRotationEuler},function(I_a){this._localRotationEuler=I_a,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),I_o(0,I_b,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?I_cb.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(I_a){null!=this._parent?(this._parent.rotation.invert(I_h._tempQuaternion0),I_cb.multiply(I_a,I_h._tempQuaternion0,this._localRotation)):I_a.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=I_a,this._rotationUpdate=!1}),I_o(0,I_b,"scale",function(){return this._scaleUpdate&&(null!==this._parent?I_gb.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(I_a){if(null!==this._parent){var I_b=this._parent.scale.elements,I_c=I_h._tempVector30.elements;I_c[0]=1/I_b[0],I_c[1]=1/I_b[1],I_c[2]=1/I_b[2],I_gb.multiply(I_a,I_h._tempVector30,this._localScale)}else I_a.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=I_a,this._scaleUpdate=!1}),I_o(0,I_b,"rotationEuler",null,function(I_a){I_cb.createFromYawPitchRoll(I_a.y,I_a.x,I_a.z,this._rotation),this.rotation=this._rotation}),I_o(0,I_b,"forward",function(){var I_a=this.worldMatrix.elements;return this._forward.elements[0]=-I_a[8],this._forward.elements[1]=-I_a[9],this._forward.elements[2]=-I_a[10],this._forward}),I_o(0,I_b,"up",function(){var I_a=this.worldMatrix.elements;return this._up.elements[0]=I_a[4],this._up.elements[1]=I_a[5],this._up.elements[2]=I_a[6],this._up}),I_o(0,I_b,"right",function(){var I_a=this.worldMatrix.elements;return this._right.elements[0]=I_a[0],this._right.elements[1]=I_a[1],this._right.elements[2]=I_a[2],this._right}),I_o(0,I_b,"parent",function(){return this._parent},function(I_a){if(this._parent!==I_a){if(this._parent){var I_b=this._parent._childs,I_c=I_b.indexOf(this);I_b.splice(I_c,1)}I_a&&(I_a._childs.push(this),I_a&&this._onWorldTransform()),this._parent=I_a}}),I_l(I_h,["_tempVector30",function(){return this._tempVector30=new I_gb},"_tempVector31",function(){return this._tempVector31=new I_gb},"_tempVector32",function(){return this._tempVector32=new I_gb},"_tempVector33",function(){return this._tempVector33=new I_gb},"_tempQuaternion0",function(){return this._tempQuaternion0=new I_cb},"_tempMatrix0",function(){return this._tempMatrix0=new I_ab},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),I_h}(),I_zb=(function(I_a){function I_b(){this._rotation=0,this._matNeedUpdte=!1,I_b.__super.call(this),this._matrix=new I_ab,this._offset=new I_fb,this._tiling=new I_fb(1,1)}I_n(I_b,"laya.d3.core.TransformUV",I_f);var I_c=I_b.prototype;I_x.imps(I_c,{"laya.d3.core.IClone":!0}),I_c._updateMatrix=function(){I_b._tempOffsetV3.elements[0]=this._offset.x,I_b._tempOffsetV3.elements[1]=this._offset.y,I_cb.createFromYawPitchRoll(0,0,this._rotation,I_b._tempRotationQua),I_b._tempTitlingV3.elements[0]=this._tiling.x,I_b._tempTitlingV3.elements[1]=this._tiling.y,I_ab.createAffineTransformation(I_b._tempOffsetV3,I_b._tempRotationQua,I_b._tempTitlingV3,this._matrix)},I_c.cloneTo=function(I_a){I_a._matrix=this._matrix.clone(),I_a._offset=this._offset.clone(),I_a._rotation=this._rotation,I_a._tiling=this._tiling.clone()},I_c.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_c,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),I_o(0,I_c,"tiling",function(){return this._tiling},function(I_a){this._tiling=I_a,this._matNeedUpdte=!0}),I_o(0,I_c,"offset",function(){return this._offset},function(I_a){this._offset=I_a,this._matNeedUpdte=!0}),I_o(0,I_c,"rotation",function(){return this._rotation},function(I_a){this._rotation=I_a,this._matNeedUpdte=!0}),I_l(I_b,["_tempOffsetV3",function(){return this._tempOffsetV3=new I_gb(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new I_cb},"_tempTitlingV3",function(){return this._tempTitlingV3=new I_gb(1,1,1)}])}(),function(I_c){function I_a(){this.x=NaN,this.y=NaN,this.z=NaN,I_a.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}I_n(I_a,"laya.d3.core.particleShuriKen.module.shape.BoxShape",I_c);var I_b=I_a.prototype;I_b._getShapeBoundBox=function(I_a){var I_b=I_a.min.elements;I_b[0]=.5*-this.x,I_b[1]=.5*-this.y,I_b[2]=.5*-this.z;var I_c=I_a.max.elements;I_c[0]=.5*this.x,I_c[1]=.5*this.y,I_c[2]=.5*this.z},I_b._getSpeedBoundBox=function(I_a){var I_b=I_a.min.elements;I_b[0]=0,I_b[1]=0,I_b[2]=0;var I_c=I_a.max.elements;I_c[0]=0,I_c[1]=1,I_c[2]=0},I_b.generatePositionAndDirection=function(I_a,I_b,I_c,I_d){var I_e=I_a.elements,I_f=I_b.elements;I_c?(I_c.seed=I_d[16],I_T._randomPointInsideHalfUnitBox(I_a,I_c),I_d[16]=I_c.seed):I_T._randomPointInsideHalfUnitBox(I_a),I_e[0]=this.x*I_e[0],I_e[1]=this.y*I_e[1],I_e[2]=this.z*I_e[2],this.randomDirection?I_c?(I_c.seed=I_d[17],I_T._randomPointUnitSphere(I_b,I_c),I_d[17]=I_c.seed):I_T._randomPointUnitSphere(I_b):(I_f[0]=0,I_f[1]=0,I_f[2]=1)},I_b.cloneTo=function(I_a){I_c.prototype.cloneTo.call(this,I_a);var I_b=I_a;I_b.x=this.x,I_b.y=this.y,I_b.z=this.z,I_b.randomDirection=this.randomDirection}}(I_O),function(I_c){function I_g(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,I_g.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}I_n(I_g,"laya.d3.core.particleShuriKen.module.shape.CircleShape",I_c);var I_a=I_g.prototype;I_a._getShapeBoundBox=function(I_a){var I_b=I_a.min.elements;I_b[0]=I_b[2]=-this.radius,I_b[1]=0;var I_c=I_a.max.elements;I_c[0]=I_c[2]=this.radius,I_c[1]=0},I_a._getSpeedBoundBox=function(I_a){var I_b=I_a.min.elements;I_b[0]=I_b[1]=-1,I_b[2]=0;var I_c=I_a.max.elements;I_c[0]=I_c[1]=1,I_c[2]=0},I_a.generatePositionAndDirection=function(I_a,I_b,I_c,I_d){var I_e=I_a.elements,I_f=I_g._tempPositionPoint.elements;I_c?(I_c.seed=I_d[16],this.emitFromEdge?I_T._randomPointUnitArcCircle(this.arc,I_g._tempPositionPoint,I_c):I_T._randomPointInsideUnitArcCircle(this.arc,I_g._tempPositionPoint,I_c),I_d[16]=I_c.seed):this.emitFromEdge?I_T._randomPointUnitArcCircle(this.arc,I_g._tempPositionPoint):I_T._randomPointInsideUnitArcCircle(this.arc,I_g._tempPositionPoint),I_e[0]=-I_f[0],I_e[1]=I_f[1],I_e[2]=0,I_gb.scale(I_a,this.radius,I_a),this.randomDirection?I_c?(I_c.seed=I_d[17],I_T._randomPointUnitSphere(I_b,I_c),I_d[17]=I_c.seed):I_T._randomPointUnitSphere(I_b):I_a.cloneTo(I_b)},I_a.cloneTo=function(I_a){I_c.prototype.cloneTo.call(this,I_a);var I_b=I_a;I_b.radius=this.radius,I_b.arc=this.arc,I_b.emitFromEdge=this.emitFromEdge,I_b.randomDirection=this.randomDirection},I_l(I_g,["_tempPositionPoint",function(){return this._tempPositionPoint=new I_fb}])}(I_O),function(I_c){function I_m(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,I_m.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}I_n(I_m,"laya.d3.core.particleShuriKen.module.shape.ConeShape",I_c);var I_a=I_m.prototype;I_a._getShapeBoundBox=function(I_a){var I_b=this.radius+this.length*Math.sin(this.angle),I_c=this.length*Math.cos(this.angle),I_d=I_a.min.elements;I_d[0]=I_d[1]=-I_b,I_d[2]=0;var I_e=I_a.max.elements;I_e[0]=I_e[1]=I_b,I_e[2]=I_c},I_a._getSpeedBoundBox=function(I_a){var I_b=Math.sin(this.angle),I_c=I_a.min.elements;I_c[0]=I_c[1]=-I_b,I_c[2]=0;var I_d=I_a.max.elements;I_d[0]=I_c[1]=I_b,I_d[2]=1},I_a.generatePositionAndDirection=function(I_a,I_b,I_c,I_d){var I_e,I_f=I_a.elements,I_g=I_b.elements,I_h=I_m._tempPositionPoint.elements,I_i=NaN,I_j=NaN,I_k=Math.cos(this.angle),I_l=Math.sin(this.angle);switch(this.emitType){case 0:I_c?(I_c.seed=I_d[16],I_T._randomPointInsideUnitCircle(I_m._tempPositionPoint,I_c),I_d[16]=I_c.seed):I_T._randomPointInsideUnitCircle(I_m._tempPositionPoint),I_i=I_h[0],I_j=I_h[1],I_f[0]=I_i*this.radius,I_f[1]=I_j*this.radius,I_f[2]=0,this.randomDirection?(I_c?(I_c.seed=I_d[17],I_T._randomPointInsideUnitCircle(I_m._tempDirectionPoint,I_c),I_d[17]=I_c.seed):I_T._randomPointInsideUnitCircle(I_m._tempDirectionPoint),I_e=I_m._tempDirectionPoint.elements,I_g[0]=I_e[0]*I_l,I_g[1]=I_e[1]*I_l):(I_g[0]=I_i*I_l,I_g[1]=I_j*I_l),I_g[2]=I_k;break;case 1:I_c?(I_c.seed=I_d[16],I_T._randomPointUnitCircle(I_m._tempPositionPoint,I_c),I_d[16]=I_c.seed):I_T._randomPointUnitCircle(I_m._tempPositionPoint),I_i=I_h[0],I_j=I_h[1],I_f[0]=I_i*this.radius,I_f[1]=I_j*this.radius,I_f[2]=0,this.randomDirection?(I_c?(I_c.seed=I_d[17],I_T._randomPointInsideUnitCircle(I_m._tempDirectionPoint,I_c),I_d[17]=I_c.seed):I_T._randomPointInsideUnitCircle(I_m._tempDirectionPoint),I_e=I_m._tempDirectionPoint.elements,I_g[0]=I_e[0]*I_l,I_g[1]=I_e[1]*I_l):(I_g[0]=I_i*I_l,I_g[1]=I_j*I_l),I_g[2]=I_k;break;case 2:I_c?(I_c.seed=I_d[16],I_T._randomPointInsideUnitCircle(I_m._tempPositionPoint,I_c)):I_T._randomPointInsideUnitCircle(I_m._tempPositionPoint),I_i=I_h[0],I_j=I_h[1],I_f[0]=I_i*this.radius,I_f[1]=I_j*this.radius,I_g[I_f[2]=0]=I_i*I_l,I_g[1]=I_j*I_l,I_g[2]=I_k,I_gb.normalize(I_b,I_b),I_c?(I_gb.scale(I_b,this.length*I_c.getFloat(),I_b),I_d[16]=I_c.seed):I_gb.scale(I_b,this.length*Math.random(),I_b),I_gb.add(I_a,I_b,I_a),this.randomDirection&&(I_c?(I_c.seed=I_d[17],I_T._randomPointUnitSphere(I_b,I_c),I_d[17]=I_c.seed):I_T._randomPointUnitSphere(I_b));break;case 3:I_c?(I_c.seed=I_d[16],I_T._randomPointUnitCircle(I_m._tempPositionPoint,I_c)):I_T._randomPointUnitCircle(I_m._tempPositionPoint),I_i=I_h[0],I_j=I_h[1],I_f[0]=I_i*this.radius,I_f[1]=I_j*this.radius,I_g[I_f[2]=0]=I_i*I_l,I_g[1]=I_j*I_l,I_g[2]=I_k,I_gb.normalize(I_b,I_b),I_c?(I_gb.scale(I_b,this.length*I_c.getFloat(),I_b),I_d[16]=I_c.seed):I_gb.scale(I_b,this.length*Math.random(),I_b),I_gb.add(I_a,I_b,I_a),this.randomDirection&&(I_c?(I_c.seed=I_d[17],I_T._randomPointUnitSphere(I_b,I_c),I_d[17]=I_c.seed):I_T._randomPointUnitSphere(I_b));break;default:throw new Error("ConeShape:emitType is invalid.")}},I_a.cloneTo=function(I_a){I_c.prototype.cloneTo.call(this,I_a);var I_b=I_a;I_b.angle=this.angle,I_b.radius=this.radius,I_b.length=this.length,I_b.emitType=this.emitType,I_b.randomDirection=this.randomDirection},I_l(I_m,["_tempPositionPoint",function(){return this._tempPositionPoint=new I_fb},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new I_fb}])}(I_O),function(I_c){function I_a(){this.radius=NaN,this.emitFromShell=!1,I_a.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}I_n(I_a,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",I_c);var I_b=I_a.prototype;I_b._getShapeBoundBox=function(I_a){var I_b=I_a.min.elements;I_b[0]=I_b[1]=I_b[2]=-this.radius;var I_c=I_a.max.elements;I_c[0]=I_c[1]=this.radius,I_c[2]=0},I_b._getSpeedBoundBox=function(I_a){var I_b=I_a.min.elements;I_b[0]=I_b[1]=-1,I_b[2]=0;var I_c=I_a.max.elements;I_c[0]=I_c[1]=I_c[2]=1},I_b.generatePositionAndDirection=function(I_a,I_b,I_c,I_d){var I_e=I_a.elements;I_c?(I_c.seed=I_d[16],this.emitFromShell?I_T._randomPointUnitSphere(I_a,I_c):I_T._randomPointInsideUnitSphere(I_a,I_c),I_d[16]=I_c.seed):this.emitFromShell?I_T._randomPointUnitSphere(I_a):I_T._randomPointInsideUnitSphere(I_a),I_gb.scale(I_a,this.radius,I_a);var I_f=I_e[2];I_f<0&&(I_e[2]=-1*I_f),this.randomDirection?I_c?(I_c.seed=I_d[17],I_T._randomPointUnitSphere(I_b,I_c),I_d[17]=I_c.seed):I_T._randomPointUnitSphere(I_b):I_a.cloneTo(I_b)},I_b.cloneTo=function(I_a){I_c.prototype.cloneTo.call(this,I_a);var I_b=I_a;I_b.radius=this.radius,I_b.emitFromShell=this.emitFromShell,I_b.randomDirection=this.randomDirection}}(I_O),function(I_c){function I_a(){this.radius=NaN,this.emitFromShell=!1,I_a.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}I_n(I_a,"laya.d3.core.particleShuriKen.module.shape.SphereShape",I_c);var I_b=I_a.prototype;I_b._getShapeBoundBox=function(I_a){var I_b=I_a.min.elements;I_b[0]=I_b[1]=I_b[2]=-this.radius;var I_c=I_a.max.elements;I_c[0]=I_c[1]=I_c[2]=this.radius},I_b._getSpeedBoundBox=function(I_a){var I_b=I_a.min.elements;I_b[0]=I_b[1]=I_b[2]=-1;var I_c=I_a.max.elements;I_c[0]=I_c[1]=I_c[2]=1},I_b.generatePositionAndDirection=function(I_a,I_b,I_c,I_d){I_c?(I_c.seed=I_d[16],this.emitFromShell?I_T._randomPointUnitSphere(I_a,I_c):I_T._randomPointInsideUnitSphere(I_a,I_c),I_d[16]=I_c.seed):this.emitFromShell?I_T._randomPointUnitSphere(I_a):I_T._randomPointInsideUnitSphere(I_a),I_gb.scale(I_a,this.radius,I_a),this.randomDirection?I_c?(I_c.seed=I_d[17],I_T._randomPointUnitSphere(I_b,I_c),I_d[17]=I_c.seed):I_T._randomPointUnitSphere(I_b):I_a.cloneTo(I_b)},I_b.cloneTo=function(I_a){I_c.prototype.cloneTo.call(this,I_a);var I_b=I_a;I_b.radius=this.radius,I_b.emitFromShell=this.emitFromShell,I_b.randomDirection=this.randomDirection}}(I_O),function(I_a){function I_b(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,I_b.__super.call(this)}return I_n(I_b,"laya.d3.core.render.SubMeshRenderElement",I_W),I_b}()),I_Ab=function(I_a){function I_s(I_a,I_b,I_c,I_d,I_e,I_f){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=I_a,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[I_nb.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[I_Vb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[I_Vb.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[I_Eb.SHADERDEFINE_ALPHATEST]="ALPHATEST";I_s.__super.call(this,I_a,I_b,I_c,null,{}),this._attributeMap=I_d;var I_g;for(I_g in I_e){var I_h=I_e[I_g];switch(I_h[1]){case 0:this._renderElementUniformMap[I_g]=I_h[0];break;case 1:this._materialUniformMap[I_g]=I_h[0];break;case 2:this._spriteUniformMap[I_g]=I_h[0];break;case 3:this._cameraUniformMap[I_g]=I_h[0];break;case 4:this._sceneUniformMap[I_g]=I_h[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}I_n(I_s,"laya.d3.shader.ShaderCompile3D",I_v);var I_b=I_s.prototype;return I_b._definesToNameDic=function(I_a,I_b){for(var I_c={},I_d=1,I_e=0;I_e<32&&!(I_a<(I_d=1<<I_e));I_e++)if(I_a&I_d){var I_f=I_b[I_d];I_f&&(I_c[I_f]="")}return I_c},I_b.withCompile=function(I_a,I_b,I_c,I_d){var I_e,I_f,I_g;if(I_f=this.sharders[I_a])if(I_g=I_f[I_b]){if(I_e=I_g[I_c])return I_e}else I_g=I_f[I_b]=[];else I_g=(I_f=this.sharders[I_a]=[])[I_b]=[];var I_h,I_i=this._definesToNameDic(I_a,I_s._globalInt2name),I_j=this._definesToNameDic(I_b,this._spriteInt2name),I_k=this._definesToNameDic(I_c,this._materialInt2name),I_l={},I_m="";if(I_i)for(I_h in I_i)I_m+="#define "+I_h+"\n",I_l[I_h]=!0;if(I_j)for(I_h in I_j)I_m+="#define "+I_h+"\n",I_l[I_h]=!0;if(I_k)for(I_h in I_k)I_m+="#define "+I_h+"\n",I_l[I_h]=!0;var I_n=I_Lb.nameKey.getName(this._name)+" compile ("+I_a+","+I_b+","+I_c+")",I_o=this._VS.toscript(I_l,[]),I_p=this._PS.toscript(I_l,[]);I_H.now();if(I_e=I_Lb.create(I_m+I_o.join("\n"),I_m+I_p.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,I_d,I_n),I_g[I_c]=I_e,laya.d3.shader.ShaderCompile3D.debugMode)I_H.now();return I_e},I_b.precompileShaderWithShaderDefine=function(I_a,I_b,I_c){this.withCompile(I_a,I_b,I_c,!0)},I_b.addMaterialDefines=function(I_a){var I_b=I_a.defines;for(var I_c in I_b){var I_d=I_b[I_c],I_e=parseInt(I_c);this._materialInt2name[I_e]=I_d,this._materialName2Int[I_d]=I_e}},I_b.addSpriteDefines=function(I_a){var I_b=I_a.defines;for(var I_c in I_b){var I_d=I_b[I_c],I_e=parseInt(I_c);this._spriteInt2name[I_e]=I_d,this._spriteName2Int[I_d]=I_e}},I_b.getMaterialDefineByName=function(I_a){return this._materialName2Int[I_a]},I_b.registerMaterialDefine=function(I_a){var I_b=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[I_b]=I_a,this._materialName2Int[I_a]=I_b},I_b.registerSpriteDefine=function(I_a){var I_b=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[I_b]=I_a,this._spriteName2Int[I_a]=I_b},I_s._globalRegDefine=function(I_a,I_b){I_s._globalInt2name[I_b]=I_a},I_s.add=function(I_a,I_b,I_c,I_d,I_e){return laya.d3.shader.ShaderCompile3D._preCompileShader[I_a]=new I_s(I_a,I_b,I_c,I_d,I_e,I_v.includes)},I_s.get=function(I_a){return laya.d3.shader.ShaderCompile3D._preCompileShader[I_Lb.nameKey.getID(I_a)]},I_s._preCompileShader={},I_s._globalInt2name=[],I_s.debugMode=!1,I_s.SHADERDEFINE_HIGHPRECISION=1,I_s.SHADERDEFINE_FOG=4,I_s.SHADERDEFINE_DIRECTIONLIGHT=8,I_s.SHADERDEFINE_POINTLIGHT=16,I_s.SHADERDEFINE_SPOTLIGHT=32,I_s.SHADERDEFINE_UV0=64,I_s.SHADERDEFINE_COLOR=128,I_s.SHADERDEFINE_UV1=256,I_s.SAHDERDEFINE_DEPTHFOG=131072,I_s}(),I_Bb=function(I_a){function I_o(){I_o.__super.call(this)}I_n(I_o,"laya.d3.graphics.MeshSprite3DStaticBatchManager",I_da);var I_b=I_o.prototype;return I_b._getStaticBatch=function(I_a,I_b,I_c,I_d){var I_e,I_f;return I_f=I_a?I_a.id.toString()+I_c.id.toString()+I_b.id.toString()+I_d.toString():I_c.id.toString()+I_b.id.toString()+I_d.toString(),this._staticBatches[I_f]?I_e=this._staticBatches[I_f]:this._staticBatches[I_f]=I_e=new I_Cb(I_f,this,I_a,I_b,I_c),I_e},I_b._initStaticBatchs=function(I_a){var I_b,I_c;this._initBatchRenderElements.sort(I_o._sortPrepareStaticBatch);for(var I_d,I_e=!1,I_f=0,I_g=0,I_h=this._initBatchRenderElements.length;I_g<I_h;I_g++){var I_i,I_j=this._initBatchRenderElements[I_g],I_k=I_j.renderObj._getVertexBuffer(0);I_j._sprite3D;if(I_c===I_k.vertexDeclaration&&I_b===I_j._material)if(I_e)I_d._addCombineBatchRenderObjTest(I_j)?(I_i=I_j._staticBatch)!==I_d&&(I_i&&I_i._deleteCombineBatchRenderObj(I_j),I_d._addCombineBatchRenderObj(I_j)):(I_e=!1,I_f++);else{var I_l=this._initBatchRenderElements[I_g-1],I_m=I_l.renderObj,I_n=I_j.renderObj;I_e=!(65535<I_m._getVertexBuffer().vertexCount+I_n._getVertexBuffer().vertexCount)&&(I_d=this._getStaticBatch(I_a,I_c,I_b,I_f),(I_i=I_l._staticBatch)!==I_d&&(I_i&&I_i._deleteCombineBatchRenderObj(I_l),I_d._addCombineBatchRenderObj(I_l)),(I_i=I_j._staticBatch)!==I_d&&(I_i&&I_i._deleteCombineBatchRenderObj(I_j),I_d._addCombineBatchRenderObj(I_j)),!0)}else I_e=!1,I_f=0;I_b=I_j._material,I_c=I_k.vertexDeclaration}},I_o._sortPrepareStaticBatch=function(I_a,I_b){var I_c=I_a._render,I_d=I_b._render,I_e=I_c.lightmapIndex-I_d.lightmapIndex;if(0!=I_e)return I_e;var I_f=I_c.receiveShadow-I_d.receiveShadow;if(0!=I_f)return I_f;var I_g=I_a._mainSortID-I_b._mainSortID;return 0==I_g?I_a.renderObj.triangleCount-I_b.renderObj.triangleCount:I_g},I_o}(),I_Cb=function(I_a){function I_f(I_a,I_b,I_c,I_d,I_e){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,I_f.__super.call(this,I_a,I_b,I_c),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=I_d,this._material=I_e}I_n(I_f,"laya.d3.graphics.SubMeshStaticBatch",I_ea);var I_b=I_f.prototype;return I_b._compareBatchRenderElement=function(I_a,I_b){return I_a._batchIndexStart>I_b._batchIndexStart},I_b._addCombineBatchRenderObjTest=function(I_a){var I_b=I_a.renderObj._vertexCount;return!(65535<(0<I_b?this._currentCombineVertexCount+I_b:this._currentCombineVertexCount+I_a.renderObj._getVertexBuffer().vertexCount))},I_b._addCombineBatchRenderObj=function(I_a){var I_b=I_a.renderObj,I_c=I_b._vertexCount;this._initBatchRenderElements.push(I_a),I_a._staticBatch=this,0<I_c?(this._currentCombineIndexCount+=I_b._indexCount,this._currentCombineVertexCount+=I_c):(this._currentCombineIndexCount=this._currentCombineIndexCount+I_b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+I_b._getVertexBuffer().vertexCount),this._needFinishCombine=!0},I_b._deleteCombineBatchRenderObj=function(I_a){var I_b=I_a.renderObj,I_c=this._initBatchRenderElements.indexOf(I_a);if(-1!==I_c){this._initBatchRenderElements.splice(I_c,1),I_a._staticBatch=null;var I_d=I_b._vertexCount;0<I_d?(this._currentCombineIndexCount=this._currentCombineIndexCount-I_b._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-I_d):(this._currentCombineIndexCount=this._currentCombineIndexCount-I_b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-I_b._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},I_b._finishInit=function(){if(this._needFinishCombine){var I_a=0,I_b=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var I_c=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),I_d=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=I_Ob.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=I_Nb.create("ushort",this._currentCombineIndexCount,35044);for(var I_e=0,I_f=this._initBatchRenderElements.length;I_e<I_f;I_e++){var I_g=this._initBatchRenderElements[I_e],I_h=I_g.renderObj,I_i=I_h._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,I_g._sprite3D),I_j=I_h.getIndices(),I_k=I_g._sprite3D.transform._isFrontFaceInvert,I_l=I_a/(this._vertexDeclaration.vertexStride/4)-I_h._vertexStart,I_m=I_b,I_n=I_m+I_j.length;I_g._batchIndexStart=I_m,I_g._batchIndexEnd=I_n,I_d.set(I_j,I_b);var I_o=0;if(I_k)for(I_o=I_m;I_o<I_n;I_o+=3){I_d[I_o]=I_l+I_d[I_o];var I_p=I_d[I_o+1],I_s=I_d[I_o+2];I_d[I_o+1]=I_l+I_s,I_d[I_o+2]=I_l+I_p}else for(I_o=I_m;I_o<I_n;I_o+=3)I_d[I_o]=I_l+I_d[I_o],I_d[I_o+1]=I_l+I_d[I_o+1],I_d[I_o+2]=I_l+I_d[I_o+2];I_b+=I_j.length,I_c.set(I_i,I_a),I_a+=I_i.length}this._vertexBuffer.setData(I_c),this._indexBuffer.setData(I_d),this._needFinishCombine=!1}},I_b._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new I_zb)},I_b._getRenderElement=function(I_a,I_b,I_c){for(var I_d,I_e,I_f=this._batchRenderElements.length,I_g=!0,I_h=0;I_h<I_f;I_h++){var I_i,I_j,I_k=(I_e=this._batchRenderElements[I_h])._sprite3D._render;if(0!==I_h&&(I_g=(I_i=(I_d=this._batchRenderElements[I_h-1])._sprite3D._render).lightmapIndex!==I_k.lightmapIndex||I_i.receiveShadow!==I_k.receiveShadow||I_d._batchIndexEnd!==I_e._batchIndexStart),I_g){(I_j=this._getCombineRenderElementFromPool()).renderObj=this,I_j._material=this._material,I_j._batchIndexStart=I_e._batchIndexStart,I_j._batchIndexEnd=I_e._batchIndexEnd;var I_l=I_k.lightmapIndex,I_m=I_l+1,I_n=this._batchOwnerIndices[I_m];I_n||(I_n=this._batchOwnerIndices[I_m]=[]);var I_o,I_p=I_n[I_e._render.receiveShadow?1:0];void 0===I_p?(I_n[I_k.receiveShadow?1:0]=this._batchOwners.length,(I_o=new I_Xb(null,"StaticBatchMeshSprite3D"))._scene=I_b,I_o._transform=this._rootOwner?this._rootOwner._transform:null,I_o._render.lightmapIndex=I_l,I_o._render.receiveShadow=I_e._render.receiveShadow,this._batchOwners.push(I_o)):I_o=this._batchOwners[I_p],I_o._render._renderUpdate(I_c),I_j._sprite3D=I_o,I_a.push(I_j)}else I_j._batchIndexEnd=I_e._batchIndexEnd}},I_b._beforeRender=function(I_a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},I_b._render=function(I_a){var I_b=I_a.renderElement,I_c=I_b._batchIndexStart,I_d=I_b._batchIndexEnd-I_c;I_F.mainContext.drawElements(4,I_d,5123,2*I_c),I_A.drawCall++,I_A.trianglesFaces+=I_d/3},I_b.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},I_b._getVertexBuffer=function(I_a){return void 0===I_a&&(I_a=0),this._vertexBuffer},I_f}(),I_Db=function(I_a){function I_b(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,I_b.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}I_n(I_b,"laya.d3.core.ComponentNode",I_j);var I_c=I_b.prototype;return I_c.addComponent=function(I_a){var I_b,I_c=this._componentsMap.indexOf(I_a);if(-1===I_c)I_b=[],this._componentsMap.push(I_a),this._typeComponentsIndices.push(I_b);else if(I_b=this._typeComponentsIndices[I_c],this._components[I_b[0]].isSingleton)throw new Error("无法单实例创建"+I_a+"组件，"+I_a+"组件已存在！");var I_d=I_e.getInstance(I_a);return I_b.push(this._components.length),this._components.push(I_d),I_d instanceof laya.d3.component.Script&&this._scripts.push(I_d),I_d._initialize(this),I_d},I_c._removeComponent=function(I_a,I_b){var I_c=this._typeComponentsIndices[I_a],I_d=I_c[I_b],I_e=this._components[I_d];this._components.splice(I_d,1),I_e instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(I_e),1),I_c.splice(I_b,1),0===I_c.length&&(this._typeComponentsIndices.splice(I_a,1),this._componentsMap.splice(I_a,1));for(var I_f=0,I_g=this._componentsMap.length;I_f<I_g;I_f++)for(var I_h=(I_c=this._typeComponentsIndices[I_f]).length-1;0<=I_h;I_h--){var I_i=I_c[I_h];if(!(I_d<I_i))break;I_c[I_h]=--I_i}I_e._destroy()},I_c.getComponentByType=function(I_a,I_b){void 0===I_b&&(I_b=0);var I_c=this._componentsMap.indexOf(I_a);return-1===I_c?null:this._components[this._typeComponentsIndices[I_c][I_b]]},I_c.getComponentsByType=function(I_a,I_b){var I_c=this._componentsMap.indexOf(I_a);if(-1!==I_c){var I_d=this._typeComponentsIndices[I_c],I_e=I_d.length;I_b.length=I_e;for(var I_f=0;I_f<I_e;I_f++)I_b[I_f]=this._components[I_d[I_f]]}else I_b.length=0},I_c.getComponentByIndex=function(I_a){return this._components[I_a]},I_c.removeComponentByType=function(I_a,I_b){void 0===I_b&&(I_b=0);var I_c=this._componentsMap.indexOf(I_a);-1!==I_c&&this._removeComponent(I_c,I_b)},I_c.removeComponentsByType=function(I_a){var I_b=this._componentsMap.indexOf(I_a);if(-1!==I_b)for(var I_c=this._typeComponentsIndices[I_b],I_d=0,I_e=I_c.length;I_d<I_e;I_c.length<I_e?I_e--:I_d++)this._removeComponent(I_b,I_d)},I_c.removeAllComponent=function(){for(var I_a=0,I_b=this._componentsMap.length;I_a<I_b;this._componentsMap.length<I_b?I_b--:I_a++)this.removeComponentsByType(this._componentsMap[I_a])},I_c._updateComponents=function(I_a){for(var I_b=0,I_c=this._components.length;I_b<I_c;I_b++){var I_d=this._components[I_b];!I_d.started&&(I_d._start(I_a),I_d.started=!0),I_d.enable&&I_d._update(I_a)}},I_c._lateUpdateComponents=function(I_a){for(var I_b=0;I_b<this._components.length;I_b++){var I_c=this._components[I_b];!I_c.started&&(I_c._start(I_a),I_c.started=!0),I_c.enable&&I_c._lateUpdate(I_a)}},I_c._preRenderUpdateComponents=function(I_a){for(var I_b=0;I_b<this._components.length;I_b++){var I_c=this._components[I_b];!I_c.started&&(I_c._start(I_a),I_c.started=!0),I_c.enable&&I_c._preRenderUpdate(I_a)}},I_c._postRenderUpdateComponents=function(I_a){for(var I_b=0;I_b<this._components.length;I_b++){var I_c=this._components[I_b];!I_c.started&&(I_c._start(I_a),I_c.started=!0),I_c.enable&&I_c._postRenderUpdate(I_a)}},I_b}(),I_Eb=function(I_d){function I_a(){I_a.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new I_mb,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new I_hb(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}I_n(I_a,"laya.d3.core.material.BaseMaterial",I_d);var I_b=I_a.prototype;return I_x.imps(I_b,{"laya.d3.core.IClone":!0}),I_b._addShaderDefine=function(I_a){this._shaderDefineValue|=I_a},I_b._removeShaderDefine=function(I_a){this._shaderDefineValue&=~I_a},I_b._addDisablePublicShaderDefine=function(I_a){this._disablePublicShaderDefine|=I_a},I_b._removeDisablePublicShaderDefine=function(I_a){this._disablePublicShaderDefine&=~I_a},I_b._setBuffer=function(I_a,I_b){this._shaderValues.setValue(I_a,I_b),this._values[I_a]=I_b},I_b._getBuffer=function(I_a){return this._values[I_a]},I_b._setMatrix4x4=function(I_a,I_b){this._shaderValues.setValue(I_a,I_b?I_b.elements:null),this._values[I_a]=I_b},I_b._getMatrix4x4=function(I_a){return this._values[I_a]},I_b._setInt=function(I_a,I_b){this._shaderValues.setValue(I_a,I_b),this._values[I_a]=I_b},I_b._getInt=function(I_a){return this._values[I_a]},I_b._setNumber=function(I_a,I_b){this._shaderValues.setValue(I_a,I_b),this._values[I_a]=I_b},I_b._getNumber=function(I_a){return this._values[I_a]},I_b._setBool=function(I_a,I_b){this._shaderValues.setValue(I_a,I_b),this._values[I_a]=I_b},I_b._getBool=function(I_a){return this._values[I_a]},I_b._setVector2=function(I_a,I_b){this._shaderValues.setValue(I_a,I_b?I_b.elements:null),this._values[I_a]=I_b},I_b._getVector2=function(I_a){return this._values[I_a]},I_b._setColor=function(I_a,I_b){this._shaderValues.setValue(I_a,I_b?I_b.elements:null),this._values[I_a]=I_b},I_b._getColor=function(I_a){return this._values[I_a]},I_b._setTexture=function(I_a,I_b){var I_c=this._values[I_a];this._values[I_a]=I_b,this._shaderValues.setValue(I_a,I_b),0<this.referenceCount&&(I_c&&I_c._removeReference(),I_b&&I_b._addReference())},I_b._getTexture=function(I_a){return this._values[I_a]},I_b._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},I_b._getShader=function(I_a,I_b,I_c){var I_d=(I_a|I_b)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(I_d,I_c,this._shaderDefineValue),this._shader},I_b._setRenderStateBlendDepth=function(){var I_a=I_F.mainContext;switch(I_G.setDepthMask(I_a,this.depthWrite),0===this.depthTest?I_G.setDepthTest(I_a,!1):(I_G.setDepthTest(I_a,!0),I_G.setDepthFunc(I_a,this.depthTest)),this.blend){case 0:I_G.setBlend(I_a,!1);break;case 1:I_G.setBlend(I_a,!0),I_G.setBlendFunc(I_a,this.srcBlend,this.dstBlend);break;case 2:I_G.setBlend(I_a,!0)}},I_b._setRenderStateFrontFace=function(I_a,I_b){var I_c=I_F.mainContext,I_d=0;switch(this.cull){case 0:I_G.setCullFace(I_c,!1);break;case 1:I_G.setCullFace(I_c,!0),I_d=I_a?I_b&&I_b._isFrontFaceInvert?2305:2304:I_b&&I_b._isFrontFaceInvert?2304:2305,I_G.setFrontFace(I_c,I_d);break;case 2:I_G.setCullFace(I_c,!0),I_d=I_a?I_b&&I_b._isFrontFaceInvert?2304:2305:I_b&&I_b._isFrontFaceInvert?2305:2304,I_G.setFrontFace(I_c,I_d)}},I_b.onAsynLoaded=function(I_a,I_b,I_c){var I_d=I_b[0],I_e=I_b[1];switch(I_d.version){case"LAYAMATERIAL:01":var I_f=0,I_g=0,I_h=I_d.props;for(var I_i in I_h)switch(I_i){case"vectors":var I_j=I_h[I_i];for(I_f=0,I_g=I_j.length;I_f<I_g;I_f++){var I_k=I_j[I_f],I_l=I_k.value;switch(I_l.length){case 2:this[I_k.name]=new I_fb(I_l[0],I_l[1]);break;case 3:this[I_k.name]=new I_gb(I_l[0],I_l[1],I_l[2]);break;case 4:this[I_k.name]=new I_hb(I_l[0],I_l[1],I_l[2],I_l[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var I_m=I_h[I_i];for(I_f=0,I_g=I_m.length;I_f<I_g;I_f++){var I_n=I_m[I_f],I_o=I_n.path;I_o&&(this[I_n.name]=I_t.getRes(I_e[I_o]))}break;case"defines":var I_p=I_h[I_i];for(I_f=0,I_g=I_p.length;I_f<I_g;I_f++){var I_s=this._shaderCompile.getMaterialDefineByName(I_p[I_f]);this._addShaderDefine(I_s)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[I_i]=I_h[I_i];break;case"renderQueue":switch(I_h[I_i]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[I_i]=I_h[I_i]}break;case"LAYAMATERIAL:02":for(I_i in I_h=I_d.props)switch(I_i){case"vectors":for(I_f=0,I_g=(I_j=I_h[I_i]).length;I_f<I_g;I_f++)switch((I_l=(I_k=I_j[I_f]).value).length){case 2:this[I_k.name]=new I_fb(I_l[0],I_l[1]);break;case 3:this[I_k.name]=new I_gb(I_l[0],I_l[1],I_l[2]);break;case 4:this[I_k.name]=new I_hb(I_l[0],I_l[1],I_l[2],I_l[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(I_f=0,I_g=(I_m=I_h[I_i]).length;I_f<I_g;I_f++)(I_o=(I_n=I_m[I_f]).path)&&(this[I_n.name]=I_t.getRes(I_e[I_o]));break;case"defines":for(I_f=0,I_g=(I_p=I_h[I_i]).length;I_f<I_g;I_f++)I_s=this._shaderCompile.getMaterialDefineByName(I_p[I_f]),this._addShaderDefine(I_s);break;default:this[I_i]=I_h[I_i]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},I_b._addReference=function(){I_d.prototype._addReference.call(this);for(var I_a=0,I_b=this._values.length;I_a<I_b;I_a++){var I_c=this._values[I_a];I_c&&I_c instanceof laya.d3.resource.BaseTexture&&I_c._addReference()}},I_b._removeReference=function(){I_d.prototype._removeReference.call(this);for(var I_a=0,I_b=this._values.length;I_a<I_b;I_a++){var I_c=this._values[I_a];I_c&&I_c instanceof laya.d3.resource.BaseTexture&&I_c._removeReference()}},I_b.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},I_b.setShaderName=function(I_a){var I_b=I_Lb.nameKey.getID(I_a);if(-1===I_b)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=I_Ab._preCompileShader[I_b]},I_b.cloneTo=function(I_a){var I_b=I_a;I_b.name=this.name,I_b.cull=this.cull,I_b.blend=this.blend,I_b.srcBlend=this.srcBlend,I_b.dstBlend=this.dstBlend,I_b.srcBlendRGB=this.srcBlendRGB,I_b.dstBlendRGB=this.dstBlendRGB,I_b.srcBlendAlpha=this.srcBlendAlpha,I_b.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(I_b.blendConstColor),I_b.blendEquation=this.blendEquation,I_b.blendEquationRGB=this.blendEquationRGB,I_b.blendEquationAlpha=this.blendEquationAlpha,I_b.depthTest=this.depthTest,I_b.depthWrite=this.depthWrite,I_b.renderQueue=this.renderQueue,I_b._shader=this._shader,I_b._disablePublicShaderDefine=this._disablePublicShaderDefine,I_b._shaderDefineValue=this._shaderDefineValue;var I_c,I_d=0,I_e=I_b._shaderValues;I_b._shaderValues.data.length=this._shaderValues.data.length;var I_f=this._values.length,I_g=I_b._values;for(I_d=0,I_c=I_g.length=I_f;I_d<I_c;I_d++){var I_h=this._values[I_d];if(I_h)if("number"==typeof I_h)I_g[I_d]=I_h,I_e.data[I_d]=I_h;else if("number"==typeof I_h&&Math.floor(I_h)==I_h)I_g[I_d]=I_h,I_e.data[I_d]=I_h;else if("boolean"==typeof I_h)I_g[I_d]=I_h,I_e.data[I_d]=I_h;else if(I_h instanceof laya.d3.math.Vector2){var I_i=I_g[I_d]||(I_g[I_d]=new I_fb);I_h.cloneTo(I_i),I_e.data[I_d]=I_i.elements}else if(I_h instanceof laya.d3.math.Vector3){var I_j=I_g[I_d]||(I_g[I_d]=new I_gb);I_h.cloneTo(I_j),I_e.data[I_d]=I_j.elements}else if(I_h instanceof laya.d3.math.Vector4){var I_k=I_g[I_d]||(I_g[I_d]=new I_hb);I_h.cloneTo(I_k),I_e.data[I_d]=I_k.elements}else if(I_h instanceof laya.d3.math.Matrix4x4){var I_l=I_g[I_d]||(I_g[I_d]=new I_ab);I_h.cloneTo(I_l),I_e.data[I_d]=I_l.elements}else I_h instanceof laya.d3.resource.BaseTexture&&(I_g[I_d]=I_h,I_e.data[I_d]=I_h)}},I_b.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_o(0,I_b,"alphaTestValue",function(){return this._getNumber(0)},function(I_a){this._setNumber(0,I_a)}),I_o(0,I_b,"alphaTest",function(){return this._alphaTest},function(I_a){(this._alphaTest=I_a)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),I_a.__init__=function(){I_a.SHADERDEFINE_ALPHATEST=I_a.shaderDefines.registerDefine("ALPHATEST")},I_a.RENDERQUEUE_OPAQUE=2e3,I_a.RENDERQUEUE_ALPHATEST=2450,I_a.RENDERQUEUE_TRANSPARENT=3e3,I_a.CULL_NONE=0,I_a.CULL_FRONT=1,I_a.CULL_BACK=2,I_a.BLEND_DISABLE=0,I_a.BLEND_ENABLE_ALL=1,I_a.BLEND_ENABLE_SEPERATE=2,I_a.BLENDPARAM_ZERO=0,I_a.BLENDPARAM_ONE=1,I_a.BLENDPARAM_SRC_COLOR=768,I_a.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,I_a.BLENDPARAM_DST_COLOR=774,I_a.BLENDPARAM_ONE_MINUS_DST_COLOR=775,I_a.BLENDPARAM_SRC_ALPHA=770,I_a.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,I_a.BLENDPARAM_DST_ALPHA=772,I_a.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,I_a.BLENDPARAM_SRC_ALPHA_SATURATE=776,I_a.BLENDEQUATION_ADD=0,I_a.BLENDEQUATION_SUBTRACT=1,I_a.BLENDEQUATION_REVERSE_SUBTRACT=2,I_a.DEPTHTEST_OFF=0,I_a.DEPTHTEST_NEVER=512,I_a.DEPTHTEST_LESS=513,I_a.DEPTHTEST_EQUAL=514,I_a.DEPTHTEST_LEQUAL=515,I_a.DEPTHTEST_GREATER=516,I_a.DEPTHTEST_NOTEQUAL=517,I_a.DEPTHTEST_GEQUAL=518,I_a.DEPTHTEST_ALWAYS=519,I_a.SHADERDEFINE_ALPHATEST=1,I_a.ALPHATESTVALUE=0,I_l(I_a,["shaderDefines",function(){return this.shaderDefines=new I_kb}]),I_a}(I_s),I_Fb=function(I_a){function I_b(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,I_b.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}I_n(I_b,"laya.d3.resource.BaseTexture",I_s);var I_c=I_b.prototype;return I_o(0,I_c,"width",function(){return this._width}),I_o(0,I_c,"repeat",function(){return this._repeat},function(I_a){if(this._repeat!==I_a&&(this._repeat=I_a,this._source)){var I_b=I_F.mainContext;I_G.bindTexture(I_b,this._type,this._source),I_w.isPOT(this._width,this._height)&&this._repeat?(I_b.texParameteri(this._type,10242,10497),I_b.texParameteri(this._type,10243,10497)):(I_b.texParameteri(this._type,10242,33071),I_b.texParameteri(this._type,10243,33071))}}),I_o(0,I_c,"height",function(){return this._height}),I_o(0,I_c,"magFifter",function(){return this._magFifter},function(I_a){(this._magFifter=I_a)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(I_a)}),I_o(0,I_c,"wrapModeV",function(){return this._wrapModeV}),I_o(0,I_c,"size",function(){return this._size}),I_o(0,I_c,"wrapModeU",function(){return this._wrapModeU}),I_o(0,I_c,"mipmap",function(){return this._mipmap},function(I_a){this._mipmap=I_a,this._mipmap!=I_a&&this._conchTexture&&this._conchTexture.setMipMap(I_a)}),I_o(0,I_c,"minFifter",function(){return this._minFifter},function(I_a){this._minFifter=I_a,this._minFifter!=I_a&&this._conchTexture&&this._conchTexture.setMinFifter(I_a)}),I_o(0,I_c,"format",function(){return this._format}),I_o(0,I_c,"source",function(){return this.activeResource(),this._source}),I_o(0,I_c,"defaulteTexture",function(){return I_Sb.grayTexture}),I_b.WARPMODE_REPEAT=0,I_b.WARPMODE_CLAMP=1,I_b}(),I_Gb=function(I_a){function I_b(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,I_b.__super.call(this),this._boundingBoxCorners=I_d(8,null)}I_n(I_b,"laya.d3.resource.models.BaseMesh",I_s);var I_c=I_b.prototype;return I_c._getPositions=function(){throw new Error("未Override,请重载该属性！")},I_c._generateBoundingObject=function(){this._boundingSphere=new I__a(new I_gb,0),I__a.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new I_Za(new I_gb,new I_gb),I_Za.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},I_c.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},I_c.getRenderElement=function(I_a){throw new Error("未Override,请重载该属性！")},I_o(0,I_c,"subMeshCount",function(){return this._subMeshCount}),I_o(0,I_c,"boundingBox",function(){return this._boundingBox}),I_o(0,I_c,"boundingBoxCorners",function(){return this._boundingBoxCorners}),I_o(0,I_c,"boundingSphere",function(){return this._boundingSphere}),I_b}(),I_Hb=(function(I_a){function I_b(){I_b.__super.call(this)}I_n(I_b,"laya.d3.component.Script",I_vb);var I_c=I_b.prototype;I_c.onTriggerEnter=function(I_a){},I_c.onTriggerExit=function(I_a){},I_c.onTriggerStay=function(I_a){},I_o(0,I_c,"isSingleton",function(){return I_b._isSingleton}),I_b._isSingleton=!1}(),function(I_a){function I_b(I_a){this._owner=null,this._sharedMesh=null,I_b.__super.call(this),this._owner=I_a}I_n(I_b,"laya.d3.core.MeshFilter",I_a);var I_c=I_b.prototype;return I_c._sharedMeshLoaded=function(){this.event("loaded")},I_c._destroy=function(){I_a.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},I_o(0,I_c,"sharedMesh",function(){return this._sharedMesh},function(I_a){var I_b=this._sharedMesh;I_b&&I_b._removeReference(),(this._sharedMesh=I_a)._addReference(),this.event("meshchanged",[this,I_b,I_a]),I_a.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),I_o(0,I_c,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),I_o(0,I_c,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),I_o(0,I_c,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),I_o(0,I_c,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),I_b}(I_wb)),I_Ib=function(I_a){function I_b(I_a){I_b.__super.call(this,I_a),I_a.meshFilter.on("meshchanged",this,this._onMeshChanged)}I_n(I_b,"laya.d3.core.MeshRender",I_xb);var I_c=I_b.prototype;return I_c._onMeshChanged=function(I_a,I_b,I_c){I_c.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:I_c.once("loaded",this,this._onMeshLoaed)},I_c._onMeshLoaed=function(I_a,I_b){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},I_c._calculateBoundingSphereByInitSphere=function(I_a){var I_b=NaN,I_c=this._owner.transform,I_d=I_c.scale.elements,I_e=Math.abs(I_d[0]),I_f=Math.abs(I_d[1]),I_g=Math.abs(I_d[2]);I_b=I_f<=I_e&&I_g<=I_e?I_e:I_g<=I_f?I_f:I_g,I_gb.transformCoordinate(I_a.center,I_c.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=I_a.radius*I_b},I_c._calculateBoundBoxByInitCorners=function(I_a){for(var I_b=this._owner.transform.worldMatrix,I_c=0;I_c<8;I_c++)I_gb.transformCoordinate(I_a[I_c],I_b,I_xb._tempBoundBoxCorners[I_c]);I_Za.createfromPoints(I_xb._tempBoundBoxCorners,this._boundingBox)},I_c._calculateBoundingSphere=function(){var I_a=this._owner.meshFilter.sharedMesh;null==I_a||null==I_a.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(I_a.boundingSphere)},I_c._calculateBoundingBox=function(){var I_a=this._owner.meshFilter.sharedMesh;null==I_a||null==I_a.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(I_a.boundingBoxCorners)},I_c._renderUpdate=function(I_a){var I_b=this._owner.transform;if(I_b){this._setShaderValueMatrix4x4(0,I_b.worldMatrix);var I_c=this._owner.getProjectionViewWorldMatrix(I_a);this._setShaderValueMatrix4x4(1,I_c)}else this._setShaderValueMatrix4x4(0,I_ab.DEFAULT),this._setShaderValueMatrix4x4(1,I_a);return I_tb.debugMode&&this._renderRenderableBoundBox(),!0},I_b}(),I_Jb=function(I_b){function I_d(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,I_d.__super.call(this),this._renderState=new I_Y,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new I_mb,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new I_ba,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new I_gb(.7,.7,.7),this.ambientColor=new I_gb(.212,.227,.259),I_F.shaderHighPrecision&&this.addShaderDefine(I_Ab.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}I_n(I_d,"laya.d3.core.scene.Scene",I_b);var I_a=I_d.prototype;return I_x.imps(I_a,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),I_a._setUrl=function(I_a){this._url=I_a},I_a._getGroup=function(){return this._group},I_a._setGroup=function(I_a){this._group=I_a},I_a._display=function(){I_x.stage._scenes.push(this),I_x.stage._scenes.sort(I_d._sortScenes);for(var I_a=0,I_b=this._childs.length;I_a<I_b;I_a++){var I_c=this._childs[I_a];I_c.active&&I_c._activeHierarchy()}},I_a._unDisplay=function(){var I_a=I_x.stage._scenes;I_a.splice(I_a.indexOf(this),1);for(var I_b=0,I_c=this._childs.length;I_b<I_c;I_b++){var I_d=this._childs[I_b];I_d.active&&I_d._inActiveHierarchy()}},I_a._addChild3D=function(I_a){I_a.transform._onWorldTransform(),I_a._setBelongScene(this),this.displayedInStage&&I_a.active&&I_a._activeHierarchy()},I_a._removeChild3D=function(I_a){I_a.transform.parent=null,this.displayedInStage&&I_a.active&&I_a._inActiveHierarchy(),I_a._setUnBelongScene()},I_a.initOctree=function(I_a,I_b,I_c,I_d,I_e){void 0===I_e&&(I_e=6),this.treeSize=new I_gb(I_a,I_b,I_c),this.treeLevel=I_e,this.treeRoot=new I_Z(this,0),this.treeRoot.init(I_d,this.treeSize)},I_a._prepareUpdateToRenderState=function(I_a,I_b){I_b.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,I_b.scene=this},I_a._prepareSceneToRender=function(I_a){var I_b=this._lights.length;if(0<I_b)for(var I_c=0,I_d=0;I_d<I_b&&!(this._lights[I_d]._prepareToScene(I_a)&&++I_c>=this._enableLightCount);I_d++);},I_a._updateChilds=function(I_a){for(var I_b=0,I_c=this._childs.length;I_b<I_c;++I_b)this._childs[I_b]._update(I_a)},I_a._preRenderScene=function(I_a,I_b,I_c){var I_d,I_e=I_b._viewMatrix,I_f=I_b._projectionMatrix,I_g=I_b._projectionViewMatrix,I_h=0,I_i=I_b.camera;for(I_i.useOcclusionCulling?this.treeRoot?I_ca.renderObjectCullingOctree(I_c,this,I_i,I_e,I_f,I_g):I_ca.renderObjectCulling(I_c,this,I_i,I_e,I_f,I_g):I_ca.renderObjectCullingNoBoundFrustum(this,I_i,I_e,I_f,I_g),I_h=0,I_d=this._quenes.length;I_h<I_d;I_h++)this._quenes[I_h]&&this._quenes[I_h]._preRender(I_b)},I_a._clear=function(I_a,I_b){var I_c=I_b._viewport,I_d=I_b.camera,I_e=I_c.x,I_f=I_d.renderTargetSize.height-I_c.y-I_c.height,I_g=I_c.width,I_h=I_c.height;I_a.viewport(I_e,I_f,I_g,I_h);var I_i=256,I_j=I_d.renderTarget;switch(I_d.clearFlag){case 0:var I_k=I_d.clearColor;if(I_k){I_a.enable(3089),I_a.scissor(I_e,I_f,I_g,I_h);var I_l=I_k.elements;I_a.clearColor(I_l[0],I_l[1],I_l[2],I_l[3]),I_i|=16384}if(I_j)switch(I_k||(I_i=16384),I_j.depthStencilFormat){case 33189:I_i|=256;break;case 36168:I_i|=1024;break;case 34041:I_i|=256,I_i|=1024}I_a.clear(I_i),I_k&&I_a.disable(3089);break;case 1:case 2:if(I_j)switch(I_i=16384,I_j.depthStencilFormat){case 33189:I_i|=256;break;case 36168:I_i|=1024;break;case 34041:I_i|=256,I_i|=1024}I_a.clear(I_i);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},I_a._renderScene=function(I_a,I_b){var I_c,I_d,I_e=I_b.camera,I_f=0;for(I_f=0;I_f<2;I_f++)(I_d=this._quenes[I_f])&&(I_e.renderTarget?I_d._render(I_b,!0):I_d._render(I_b,!1));if(1===I_e.clearFlag){var I_g=I_e.sky;I_g&&(I_G.setCullFace(I_a,!1),I_G.setDepthFunc(I_a,515),I_G.setDepthMask(I_a,!1),I_g._render(I_b),I_G.setDepthFunc(I_a,513),I_G.setDepthMask(I_a,!0))}for(I_f=2,I_c=this._quenes.length;I_f<I_c;I_f++)(I_d=this._quenes[I_f])&&(I_d._sortAlpha(I_b.camera.transform.position),I_e.renderTarget?I_d._render(I_b,!0):I_d._render(I_b,!1))},I_a._set3DRenderConfig=function(I_a){I_a.disable(3042),I_G._blend=!1,I_a.blendFunc(770,771),I_G._sFactor=770,I_G._dFactor=771,I_a.disable(2929),I_G._depthTest=!1,I_a.enable(2884),I_G._cullFace=!0,I_a.depthMask(1),I_G._depthMask=!0,I_a.frontFace(2304),I_G._frontFace=2304},I_a._set2DRenderConfig=function(I_a){I_G.setBlend(I_a,!0),I_G.setBlendFunc(I_a,1,771),I_G.setDepthTest(I_a,!1),I_G.setCullFace(I_a,!1),I_G.setDepthMask(I_a,!0),I_G.setFrontFace(I_a,2305),I_a.viewport(0,0,I_k.width,I_k.height)},I_a._parseCustomProps=function(I_a,I_b,I_c,I_d){var I_e=I_d.customProps.lightmaps,I_f=I_e.length,I_g=this._lightmaps;I_g.length=I_f;for(var I_h=0;I_h<I_f;I_h++)I_g[I_h]=I_t.getRes(I_b[I_e[I_h].replace(".exr",".png")]);this.setlightmaps(I_g);var I_i=I_d.customProps.ambientColor;I_i&&(this.ambientColor=new I_gb(I_i[0],I_i[1],I_i[2]));var I_j=I_d.customProps.fogColor;I_j&&(this.fogColor=new I_gb(I_j[0],I_j[1],I_j[2]))},I_a._addLight=function(I_a){this._lights.indexOf(I_a)<0&&this._lights.push(I_a)},I_a._removeLight=function(I_a){var I_b=this._lights.indexOf(I_a);0<=I_b&&this._lights.splice(I_b,1)},I_a._updateScene=function(){var I_a=this._renderState;this._prepareUpdateToRenderState(I_F.mainContext,I_a),this._updateComponents(I_a),this._updateChilds(I_a),this._lateUpdateComponents(I_a),this._time+=I_a.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},I_a._updateSceneConch=function(){var I_a=this._renderState;this._prepareUpdateToRenderState(I_F.mainContext,I_a),this._updateComponents(I_a),this._lateUpdateComponents(I_a),this._prepareSceneToRender(I_a);for(var I_b=0,I_c=this._cameraPool.length;I_b<I_c;I_b++){var I_d=this._cameraPool[I_b];(I_a.camera=I_d)._prepareCameraToRender()}},I_a._preRenderShadow=function(I_a,I_b,I_c,I_d,I_e){this.treeRoot?I_ca.renderShadowObjectCullingOctree(this,I_b,I_c,I_d,I_e):I_ca.renderShadowObjectCulling(this,I_b,I_c,I_d,I_e);for(var I_f=0,I_g=I_c.length;I_f<I_g;I_f++)I_c[I_f]&&I_c[I_f]._preRender(I_a)},I_a._renderShadowMap=function(I_a,I_b,I_c){var I_d=this.parallelSplitShadowMaps[0];I_d._calcAllLightCameraInfo(I_c);var I_e,I_f,I_g,I_h=I_d.PSSMNum;if(this._preRenderShadow(I_b,I_d._lightCulling,I_d._shadowQuenes,I_d._lightVPMatrix[0],I_h),this.addShaderDefine(I_nb.SHADERDEFINE_CAST_SHADOW),1<I_h)for(var I_i=0;I_i<I_h;I_i++)I_e=I_d.getRenderTarget(I_i+1),I_d.beginRenderTarget(I_i+1),I_a.clearColor(1,1,1,1),I_a.clear(16640),I_a.viewport(0,0,I_e.width,I_e.height),I_b.camera=I_g=I_d.getLightCamera(I_i),I_g._prepareCameraToRender(),I_g._prepareCameraViewProject(I_g.viewMatrix,I_g.projectionMatrix),I_b._projectionViewMatrix=I_d._lightVPMatrix[I_i+1],(I_f=I_d._shadowQuenes[I_i])._preRender(I_b),I_f._renderShadow(I_b,!1),I_d.endRenderTarget(I_i+1);else I_e=I_d.getRenderTarget(1),I_d.beginRenderTarget(1),I_a.clearColor(1,1,1,1),I_a.clear(16640),I_a.viewport(0,0,I_e.width,I_e.height),I_b.camera=I_g=I_d.getLightCamera(0),I_g._prepareCameraToRender(),I_g._prepareCameraViewProject(I_g.viewMatrix,I_g.projectionMatrix),I_b._projectionViewMatrix=I_d._lightVPMatrix[0],(I_f=I_d._shadowQuenes[0])._preRender(I_b),I_f._renderShadow(I_b,!0),I_d.endRenderTarget(1);this.removeShaderDefine(I_nb.SHADERDEFINE_CAST_SHADOW)},I_a.addTreeNode=function(I_a){this.treeRoot.addTreeNode(I_a)},I_a.removeTreeNode=function(I_a){this.treeSize&&I_a._treeNode&&I_a._treeNode.removeObject(I_a)},I_a.setlightmaps=function(I_a){this._lightmaps=I_a;for(var I_b=0,I_c=this._renderableSprite3Ds.length;I_b<I_c;I_b++)this._renderableSprite3Ds[I_b]._render._applyLightMapParams()},I_a.getlightmaps=function(){return this._lightmaps},I_a.addChildAt=function(I_a,I_b){if(!(I_a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(I_a&&I_a.__className));if(!I_a||this.destroyed||I_a===this)return I_a;if(I_a.zOrder&&this._set$P("hasZorder",!0),0<=I_b&&I_b<=this._childs.length){if(I_a._parent===this){var I_c=this.getChildIndex(I_a);this._childs.splice(I_c,1),this._childs.splice(I_b,0,I_a),this.conchModel&&(this.conchModel.removeChild(I_a.conchModel),this.conchModel.addChildAt(I_a.conchModel,I_b)),this._childChanged()}else I_a.parent&&I_a.parent.removeChild(I_a),this._childs===I_j.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(I_b,0,I_a),this.conchModel&&this.conchModel.addChildAt(I_a.conchModel,I_b),(I_a.parent=this)._addChild3D(I_a);return I_a}throw new Error("appendChildAt:The index is out of bounds")},I_a.addChild=function(I_a){if(!(I_a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!I_a||this.destroyed||I_a===this)return I_a;if(I_a.zOrder&&this._set$P("hasZorder",!0),I_a._parent===this){var I_b=this.getChildIndex(I_a);I_b!==this._childs.length-1&&(this._childs.splice(I_b,1),this._childs.push(I_a),this.conchModel&&(this.conchModel.removeChild(I_a.conchModel),this.conchModel.addChildAt(I_a.conchModel,this._childs.length-1)),this._childChanged())}else I_a.parent&&I_a.parent.removeChild(I_a),this._childs===I_j.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(I_a),this.conchModel&&this.conchModel.addChildAt(I_a.conchModel,this._childs.length-1),(I_a.parent=this)._childChanged(),this._addChild3D(I_a);return I_a},I_a.removeChildAt=function(I_a){var I_b=this.getChildAt(I_a);return I_b&&(this._removeChild3D(I_b),this._childs.splice(I_a,1),this.conchModel&&this.conchModel.removeChild(I_b.conchModel),I_b.parent=null),I_b},I_a.removeChildren=function(I_a,I_b){if(void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=2147483647),this._childs&&0<this._childs.length){var I_c=this._childs;if(0===I_a&&I_f<=I_b){var I_d=I_c;this._childs=I_j.ARRAY_EMPTY}else I_d=I_c.splice(I_a,I_b-I_a);for(var I_e=0,I_f=I_d.length;I_e<I_f;I_e++)this._removeChild3D(I_d[I_e]),I_d[I_e].parent=null,this.conchModel&&this.conchModel.removeChild(I_d[I_e].conchModel)}return this},I_a.addFrustumCullingObject=function(I_a){this.treeRoot?this.addTreeNode(I_a):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(I_a):this._cullingRenders[this._cullingRendersLength]=I_a,I_a._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},I_a.removeFrustumCullingObject=function(I_a){if(this.treeRoot)this.removeTreeNode(I_a);else{this._cullingRendersLength--;var I_b=I_a._indexInSceneFrustumCullingObjects;if(I_b!==this._cullingRendersLength){var I_c=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[I_b]=I_c)._indexInSceneFrustumCullingObjects=I_b,I_a._indexInSceneFrustumCullingObjects=-1}}},I_a.getRenderQueue=function(I_a){return I_a<3e3?this._quenes[1]||(this._quenes[1]=new I_X(this)):this._quenes[2]||(this._quenes[2]=new I_X(this))},I_a.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new I_X(this)},I_a.addShaderDefine=function(I_a){this._shaderDefineValue|=I_a},I_a.removeShaderDefine=function(I_a){this._shaderDefineValue&=~I_a},I_a.addScript=function(I_a){return this._addComponent(I_a)},I_a.getScriptByType=function(I_a,I_b){return void 0===I_b&&(I_b=0),this._getComponentByType(I_a,I_b)},I_a.getScriptsByType=function(I_a,I_b){this._getComponentsByType(I_a,I_b)},I_a.getScriptByIndex=function(I_a){return this._getComponentByIndex(I_a)},I_a.removeScriptByType=function(I_a,I_b){void 0===I_b&&(I_b=0),this._removeComponentByType(I_a,I_b)},I_a.removeScriptsByType=function(I_a){this._removeComponentByType(I_a)},I_a.removeAllScript=function(){this._removeAllComponent()},I_a.render=function(I_a,I_b,I_c){(I_p._context.ctx._renderKey=0)<this._childs.length&&I_a.addRenderObject(this)},I_a.renderSubmit=function(){var I_a=I_F.mainContext,I_b=this._renderState;this._set3DRenderConfig(I_a),this._prepareSceneToRender(this._renderState);var I_c,I_d=0,I_e=0;if(I_tb.debugMode||I_Z.debugMode)for(I_d=0,I_e=this._cameraPool.length;I_d<I_e;I_d++)I_c=this._cameraPool[I_d],I_tb._debugPhasorSprite.begin(1,I_c),I_c.activeInHierarchy&&I_c._renderCamera(I_a,I_b,this),I_tb._debugPhasorSprite.end();else for(I_d=0,I_e=this._cameraPool.length;I_d<I_e;I_d++)(I_c=this._cameraPool[I_d]).activeInHierarchy&&I_c._renderCamera(I_a,I_b,this);return this._set2DRenderConfig(I_a),1},I_a.onAsynLoaded=function(I_a,I_b,I_c){var I_d=I_b[0];if("Scene"!==I_d.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var I_e=I_b[1];I_sb._createNodeByJson(this,I_d,this,I_e),this.event("hierarchyloaded",[this]),this.__loaded=!0},I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),this.destroyed||(I_b.prototype.destroy.call(this,I_a),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,I_t.clearRes(this.url),this.loaded||I_tb._cancelLoadByUrl(this.url))},I_a.getRenderType=function(){return 0},I_a.releaseRender=function(){},I_a._addComponent=function(I_a){var I_b,I_c=this._componentsMap.indexOf(I_a);if(-1===I_c)I_b=[],this._componentsMap.push(I_a),this._typeComponentsIndices.push(I_b);else if(I_b=this._typeComponentsIndices[I_c],this._components[I_b[0]].isSingleton)throw new Error("无法单实例创建"+I_a+"组件，"+I_a+"组件已存在！");var I_d=I_e.getInstance(I_a);I_b.push(this._components.length),this._components.push(I_d);return I_d._initialize(this),I_d},I_a._removeComponent=function(I_a,I_b){var I_c=this._typeComponentsIndices[I_a],I_d=I_c[I_b],I_e=this._components[I_d];this._components.splice(I_d,1),I_c.splice(I_b,1),0===I_c.length&&(this._typeComponentsIndices.splice(I_a,1),this._componentsMap.splice(I_a,1));for(var I_f=0,I_g=this._componentsMap.length;I_f<I_g;I_f++)for(var I_h=(I_c=this._typeComponentsIndices[I_f]).length-1;0<=I_h;I_h--){var I_i=I_c[I_h];if(!(I_d<I_i))break;I_c[I_h]=--I_i}I_e._destroy()},I_a._getComponentByType=function(I_a,I_b){void 0===I_b&&(I_b=0);var I_c=this._componentsMap.indexOf(I_a);return-1===I_c?null:this._components[this._typeComponentsIndices[I_c][I_b]]},I_a._getComponentsByType=function(I_a,I_b){var I_c=this._componentsMap.indexOf(I_a);if(-1!==I_c){var I_d=this._typeComponentsIndices[I_c],I_e=I_d.length;I_b.length=I_e;for(var I_f=0;I_f<I_e;I_f++)I_b[I_f]=this._components[I_d[I_f]]}else I_b.length=0},I_a._getComponentByIndex=function(I_a){return this._components[I_a]},I_a._removeComponentByType=function(I_a,I_b){void 0===I_b&&(I_b=0);var I_c=this._componentsMap.indexOf(I_a);-1!==I_c&&this._removeComponent(I_c,I_b)},I_a._removeComponentsByType=function(I_a){var I_b=this._componentsMap.indexOf(I_a);if(-1!==I_b)for(var I_c=this._typeComponentsIndices[I_b],I_d=0,I_e=I_c.length;I_d<I_e;I_c.length<I_e?I_e--:I_d++)this._removeComponent(I_b,I_d)},I_a._removeAllComponent=function(){for(var I_a=0,I_b=this._componentsMap.length;I_a<I_b;this._componentsMap.length<I_b?I_b--:I_a++)this._removeComponentsByType(this._componentsMap[I_a])},I_a._updateComponents=function(I_a){for(var I_b=0,I_c=this._components.length;I_b<I_c;I_b++){var I_d=this._components[I_b];!I_d.started&&(I_d._start(I_a),I_d.started=!0),I_d.enable&&I_d._update(I_a)}},I_a._lateUpdateComponents=function(I_a){for(var I_b=0;I_b<this._components.length;I_b++){var I_c=this._components[I_b];!I_c.started&&(I_c._start(I_a),I_c.started=!0),I_c.enable&&I_c._lateUpdate(I_a)}},I_a._preRenderUpdateComponents=function(I_a){for(var I_b=0;I_b<this._components.length;I_b++){var I_c=this._components[I_b];!I_c.started&&(I_c._start(I_a),I_c.started=!0),I_c.enable&&I_c._preRenderUpdate(I_a)}},I_a._postRenderUpdateComponents=function(I_a){for(var I_b=0;I_b<this._components.length;I_b++){var I_c=this._components[I_b];!I_c.started&&(I_c._start(I_a),I_c.started=!0),I_c.enable&&I_c._postRenderUpdate(I_a)}},I_o(0,I_a,"_loaded",null,function(I_a){this.__loaded=I_a}),I_o(0,I_a,"fogColor",function(){return this._fogColor},function(I_a){this._fogColor=I_a,this._shaderValues.setValue(0,I_a.elements)}),I_o(0,I_a,"enableFog",function(){return this._enableFog},function(I_a){this._enableFog!==I_a&&((this._enableFog=I_a)?(this.addShaderDefine(I_Ab.SHADERDEFINE_FOG),this.removeShaderDefine(I_Ab.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(I_Ab.SHADERDEFINE_FOG))}),I_o(0,I_a,"url",function(){return this._url}),I_o(0,I_a,"loaded",function(){return this.__loaded}),I_o(0,I_a,"enableDepthFog",function(){return this._enableDepthFog},function(I_a){this._enableDepthFog!=I_a&&((this._enableDepthFog=I_a)?(this.addShaderDefine(I_Ab.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(I_Ab.SHADERDEFINE_FOG)):this.removeShaderDefine(I_Ab.SAHDERDEFINE_DEPTHFOG))}),I_o(0,I_a,"fogStart",function(){return this._fogStart},function(I_a){this._fogStart=I_a,this._shaderValues.setValue(1,I_a)}),I_o(0,I_a,"fogRange",function(){return this._fogRange},function(I_a){this._fogRange=I_a,this._shaderValues.setValue(2,I_a)}),I_o(0,I_a,"ambientColor",function(){return this._ambientColor},function(I_a){this._ambientColor=I_a,this._shaderValues.setValue(21,I_a.elements)}),I_o(0,I_a,"scene",function(){return this}),I_o(0,I_a,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),I_d._sortScenes=function(I_a,I_b){if(I_a.parent!==I_x.stage||I_b.parent!==I_x.stage)return I_a.parent!==I_x.stage&&I_b.parent!==I_x.stage?I_d._sortScenes(I_a.parent,I_b.parent):I_a.parent===I_x.stage?-1:1;var I_c=I_x.stage._childs;return I_c.indexOf(I_a)-I_c.indexOf(I_b)},I_d.load=function(I_a){return I_x.loader.create(I_a,null,null,I_d)},I_d.FOGCOLOR=0,I_d.FOGSTART=1,I_d.FOGRANGE=2,I_d.LIGHTDIRECTION=3,I_d.LIGHTDIRCOLOR=4,I_d.POINTLIGHTPOS=5,I_d.POINTLIGHTRANGE=6,I_d.POINTLIGHTATTENUATION=7,I_d.POINTLIGHTCOLOR=8,I_d.SPOTLIGHTPOS=9,I_d.SPOTLIGHTDIRECTION=10,I_d.SPOTLIGHTSPOT=11,I_d.SPOTLIGHTRANGE=12,I_d.SPOTLIGHTATTENUATION=13,I_d.SPOTLIGHTCOLOR=14,I_d.SHADOWDISTANCE=15,I_d.SHADOWLIGHTVIEWPROJECT=16,I_d.SHADOWMAPPCFOFFSET=17,I_d.SHADOWMAPTEXTURE1=18,I_d.SHADOWMAPTEXTURE2=19,I_d.SHADOWMAPTEXTURE3=20,I_d.AMBIENTCOLOR=21,I_d.TIME=22,I_d}(I_z),I_Kb=function(I_a){function I_b(I_a){I_b.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new I_ab,this._shaderValues=new I_mb,this._colliders=[],this._id=++I_b._uniqueIDCounter,this._transform=new I_yb(this),this.name=I_a||"Sprite3D-"+I_b._nameNumberCounter++,this.layer=I_I.currentCreationLayer,this.active=!0}I_n(I_b,"laya.d3.core.Sprite3D",I_Db);var I_c=I_b.prototype;return I_x.imps(I_c,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),I_c._setUrl=function(I_a){this._url=I_a},I_c._getGroup=function(){return this._group},I_c._setGroup=function(I_a){this._group=I_a},I_c._addChild3D=function(I_a){I_a.transform.parent=this.transform,this._hierarchyAnimator&&(!I_a._hierarchyAnimator&&I_a._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(I_a,!0,[I_a.name])),this._scene&&(I_a._setBelongScene(this._scene),this._activeInHierarchy&&I_a._active&&I_a._activeHierarchy())},I_c._removeChild3D=function(I_a){I_a.transform.parent=null,this._scene&&(this._activeInHierarchy&&I_a._active&&I_a._inActiveHierarchy(),I_a._setUnBelongScene()),this._hierarchyAnimator&&(I_a._hierarchyAnimator==this._hierarchyAnimator&&I_a._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(I_a,!1,[I_a.name]))},I_c._parseBaseCustomProps=function(I_a){var I_b=this.transform.localPosition;I_a.translate?(I_b.fromArray(I_a.translate),I_b.x*=100,I_b.y*=100,I_b.z*=100):I_b.elements.fill(0),this.transform.localPosition=I_b;var I_c=this.transform.localRotation;I_a.rotation?I_c.fromArray(I_a.rotation):I_c.fromArray([0,0,0,-1]),this.transform.localRotation=I_c;var I_d=this.transform.localScale;I_a.scale?I_d.fromArray(I_a.scale):I_d.elements.fill(1),this.transform.localScale=I_d;var I_e=I_a.layer;null!=I_e&&(this.layer=I_I.getLayerByNumber(I_e))},I_c._parseCustomComponent=function(I_a,I_b,I_c){for(var I_d in I_c){var I_e=I_c[I_d];switch(I_d){case"Animator":var I_f=this.addComponent(Animator);if(I_e.avatarPath)I_f.avatar=I_t.getRes(I_b[I_e.avatarPath]);else{var I_g=I_e.avatar;if(I_g){I_f.avatar=I_t.getRes(I_b[I_g.path]);var I_h=I_g.linkSprites;I_h&&I_a.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[I_f,I_h])}}for(var I_i=I_e.clipPaths,I_j=I_i.length,I_k=0;I_k<I_j;I_k++)I_f.addClip(I_t.getRes(I_b[I_i[I_k]]));I_f.clip=I_t.getRes(I_b[I_i[0]]);var I_l=I_e.playOnWake;void 0!==I_l&&(I_f.playOnWake=I_l);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var I_m=this.addComponent(SphereCollider);I_m.isTrigger=I_e.isTrigger;var I_n=I_m.center;I_n.fromArray(I_e.center),I_m.center=I_n,I_m.radius=I_e.radius;break;case"BoxCollider":var I_o=this.addComponent(BoxCollider);I_o.isTrigger=I_e.isTrigger,I_o.center.fromArray(I_e.center);var I_p=I_o.size;I_p.fromArray(I_e.size),I_o.size=I_p;break;case"MeshCollider":this.addComponent(MeshCollider)}}},I_c._onRootNodeHierarchyLoaded=function(I_a,I_b){for(var I_c in I_b){for(var I_d=this,I_e=I_b[I_c],I_f=0,I_g=I_e.length;I_f<I_g;I_f++){var I_h=I_e[I_f];if(""===I_h)break;if(!(I_d=I_d.getChildByName(I_h)))break}I_d&&I_a.linkSprite3DToAvatarNode(I_c,I_d)}},I_c._setHierarchyAnimator=function(I_a,I_b){this._changeHierarchyAnimator(I_a);for(var I_c=0,I_d=this._childs.length;I_c<I_d;I_c++){var I_e=this._childs[I_c];I_e._hierarchyAnimator==I_b&&I_e._setHierarchyAnimator(I_a,I_b)}},I_c._clearHierarchyAnimator=function(I_a,I_b){this._changeHierarchyAnimator(I_b);for(var I_c=0,I_d=this._childs.length;I_c<I_d;I_c++){var I_e=this._childs[I_c];I_e._hierarchyAnimator==I_a&&I_e._clearHierarchyAnimator(I_a,I_b)}},I_c._getAnimatorToLinkSprite3D=function(I_a,I_b,I_c){var I_d=this.getComponentByType(Animator);if(I_d&&(I_d.avatar?I_d.avatar._version||I_a._setAnimatorToLinkAvatar(I_d,I_b):I_a._setAnimatorToLinkSprite3DNoAvatar(I_d,I_b,I_c)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){I_c.unshift(this._parent.name);var I_e=this._parent;I_e._hierarchyAnimator&&I_e._getAnimatorToLinkSprite3D(I_a,I_b,I_c)}},I_c._setAnimatorToLinkSprite3DNoAvatar=function(I_a,I_b,I_c){var I_d=0,I_e=0;for(I_d=0,I_e=I_a.getClipCount();I_d<I_e;I_d++)I_a._handleSpriteOwnersBySprite(I_d,I_b,I_c,this);for(I_d=0,I_e=this._childs.length;I_d<I_e;I_d++){var I_f=this._childs[I_d],I_g=I_c.length;I_c.push(I_f.name),I_f._setAnimatorToLinkSprite3DNoAvatar(I_a,I_b,I_c),I_c.splice(I_g,1)}},I_c._changeHierarchyAnimator=function(I_a){this._hierarchyAnimator=I_a},I_c._isLinkSpriteToAnimationNode=function(I_a,I_b,I_c){var I_d=I_a._avatarNodes.indexOf(I_b),I_e=I_a._cacheSpriteToNodesMap;if(I_c)this._transform.dummy=I_b.transform,I_a._cacheNodesToSpriteMap[I_d]=I_e.length,I_e.push(I_d);else{this._transform.dummy=null;var I_f=I_a._cacheNodesToSpriteMap[I_d];I_a._cacheNodesToSpriteMap[I_d]=null,I_e.splice(I_f,1)}},I_c._setBelongScene=function(I_a){this._scene=I_a;for(var I_b=0,I_c=this._childs.length;I_b<I_c;I_b++)this._childs[I_b]._setBelongScene(I_a)},I_c._setUnBelongScene=function(){this._scene=null;for(var I_a=0,I_b=this._childs.length;I_a<I_b;I_a++)this._childs[I_a]._setUnBelongScene()},I_c._activeHierarchy=function(){var I_a=0,I_b=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),I_a=0,I_b=this._colliders.length;I_a<I_b;I_a++)this._layer._addCollider(this._colliders[I_a]);for(this.event("activeinhierarchychanged",!0),I_a=0,I_b=this._childs.length;I_a<I_b;I_a++){var I_c=this._childs[I_a];I_c._active&&I_c._activeHierarchy()}},I_c._inActiveHierarchy=function(){var I_a=0,I_b=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),I_a=0,I_b=this._colliders.length;I_a<I_b;I_a++){var I_c=this._colliders[I_a];I_c._clearCollsionMap(),this._layer._removeCollider(I_c)}for(this.event("activeinhierarchychanged",!1),I_a=0,I_b=this._childs.length;I_a<I_b;I_a++){var I_d=this._childs[I_a];I_d._active&&I_d._inActiveHierarchy()}},I_c.addComponent=function(I_a){var I_b,I_c=this._componentsMap.indexOf(I_a);if(-1===I_c)I_b=[],this._componentsMap.push(I_a),this._typeComponentsIndices.push(I_b);else if(I_b=this._typeComponentsIndices[I_c],this._components[I_b[0]].isSingleton)throw new Error("无法单实例创建"+I_a+"组件，"+I_a+"组件已存在！");var I_d=I_e.getInstance(I_a);return I_b.push(this._components.length),this._components.push(I_d),I_d instanceof laya.d3.component.Script&&this._scripts.push(I_d),I_d._initialize(this),I_d},I_c._removeComponent=function(I_a,I_b){var I_c,I_d=0,I_e=this._typeComponentsIndices[I_a],I_f=I_e[I_b],I_g=this._components[I_f];for(I_g instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(I_g),1),I_e.splice(I_b,1),0===I_e.length&&(this._typeComponentsIndices.splice(I_a,1),this._componentsMap.splice(I_a,1)),I_d=0,I_c=this._componentsMap.length;I_d<I_c;I_d++)for(var I_h=(I_e=this._typeComponentsIndices[I_d]).length-1;0<=I_h;I_h--){var I_i=I_e[I_h];if(!(I_f<I_i))break;I_e[I_h]=--I_i}I_g._destroy()},I_c._clearSelfRenderObjects=function(){},I_c._addSelfRenderObjects=function(){},I_c._parseCustomProps=function(I_a,I_b,I_c,I_d){},I_c._updateChilds=function(I_a){var I_b=this._childs.length;if(0!==I_b)for(var I_c=0;I_c<I_b;++I_c)this._childs[I_c]._update(I_a)},I_c._getSortID=function(I_a,I_b){return 1e3*I_b.id+I_a._getVertexBuffer().vertexDeclaration.id},I_c._update=function(I_a){(I_a.owner=this)._activeInHierarchy&&(this._updateComponents(I_a),this._lateUpdateComponents(I_a),I_A.spriteCount++,this._childs.length&&this._updateChilds(I_a))},I_c.getProjectionViewWorldMatrix=function(I_a){return I_ab.multiply(I_a,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},I_c.loadHierarchy=function(I_a){this.addChild(laya.d3.core.Sprite3D.load(I_a))},I_c.addChildAt=function(I_a,I_b){if(!(I_a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!I_a||this.destroyed||I_a===this)return I_a;if(I_a.zOrder&&this._set$P("hasZorder",!0),0<=I_b&&I_b<=this._childs.length){if(I_a._parent===this){var I_c=this.getChildIndex(I_a);this._childs.splice(I_c,1),this._childs.splice(I_b,0,I_a),this.conchModel&&(this.conchModel.removeChild(I_a.conchModel),this.conchModel.addChildAt(I_a.conchModel,I_b)),this._childChanged()}else I_a.parent&&I_a.parent.removeChild(I_a),this._childs===I_j.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(I_b,0,I_a),this.conchModel&&this.conchModel.addChildAt(I_a.conchModel,I_b),(I_a.parent=this)._addChild3D(I_a);return I_a}throw new Error("appendChildAt:The index is out of bounds")},I_c.addChild=function(I_a){if(!(I_a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!I_a||this.destroyed||I_a===this)return I_a;if(I_a.zOrder&&this._set$P("hasZorder",!0),I_a._parent===this){var I_b=this.getChildIndex(I_a);I_b!==this._childs.length-1&&(this._childs.splice(I_b,1),this._childs.push(I_a),this.conchModel&&(this.conchModel.removeChild(I_a.conchModel),this.conchModel.addChildAt(I_a.conchModel,this._childs.length-1)),this._childChanged())}else I_a.parent&&I_a.parent.removeChild(I_a),this._childs===I_j.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(I_a),this.conchModel&&this.conchModel.addChildAt(I_a.conchModel,this._childs.length-1),(I_a.parent=this)._childChanged(),this._addChild3D(I_a);return I_a},I_c.removeChildAt=function(I_a){var I_b=this.getChildAt(I_a);return I_b&&(this._removeChild3D(I_b),this._childs.splice(I_a,1),this.conchModel&&this.conchModel.removeChild(I_b.conchModel),I_b.parent=null),I_b},I_c.removeChildren=function(I_a,I_b){if(void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=2147483647),this._childs&&0<this._childs.length){var I_c=this._childs;if(0===I_a&&I_f<=I_b){var I_d=I_c;this._childs=I_j.ARRAY_EMPTY}else I_d=I_c.splice(I_a,I_b-I_a);for(var I_e=0,I_f=I_d.length;I_e<I_f;I_e++)this._removeChild3D(I_d[I_e]),I_d[I_e].parent=null,this.conchModel&&this.conchModel.removeChild(I_d[I_e].conchModel)}return this},I_c.onAsynLoaded=function(I_a,I_b,I_c){var I_d=I_b[0];if("Sprite3D"!==I_d.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var I_e=I_b[1];I_sb._createNodeByJson(this,I_d,this,I_e),this.event("hierarchyloaded",[this]),this.__loaded=!0},I_c.cloneTo=function(I_a){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var I_b=I_a;I_b.name=this.name,I_b._destroyed=this._destroyed,I_b.timer=this.timer,I_b._$P=this._$P,I_b.active=this._active;var I_c=I_b.transform.localPosition;this.transform.localPosition.cloneTo(I_c),I_b.transform.localPosition=I_c;var I_d=I_b.transform.localRotation;this.transform.localRotation.cloneTo(I_d),I_b.transform.localRotation=I_d;var I_e=I_b.transform.localScale;this.transform.localScale.cloneTo(I_e),I_b.transform.localScale=I_e,I_b.isStatic=this.isStatic;var I_f=0,I_g=0;for(I_f=0,I_g=this._componentsMap.length;I_f<I_g;I_f++){var I_h=I_b.addComponent(this._componentsMap[I_f]);this._components[I_f]._cloneTo(I_h)}for(I_f=0,I_g=this._childs.length;I_f<I_g;I_f++)I_b.addChild(this._childs[I_f].clone());var I_i=I_b.getComponentByType(Animator);if(I_i){var I_j=I_i._linkSpritesData;if(I_j)for(var I_k in I_j){for(var I_l=I_j[I_k],I_m=I_b,I_n=0,I_o=I_l.length;I_n<I_o&&(I_m=I_m.getChildByName(I_l[I_n]));I_n++);if(I_m){var I_p=I_i._avatarNodeMap[I_k];I_m._isLinkSpriteToAnimationNode(I_i,I_p,!0)}}}},I_c.clone=function(){var I_a=new this.constructor;return this.cloneTo(I_a),I_a},I_c.destroy=function(I_a){if(void 0===I_a&&(I_a=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,I_a);var I_b,I_c=0;for(I_c=0,I_b=this._components.length;I_c<I_b;I_c++)this._components[I_c]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,I_t.clearRes(this.url),this.loaded||I_tb._cancelLoadByUrl(this.url)}},I_c._handleSpriteToAvatar=function(I_a,I_b){I_a._avatarNodes;var I_c=I_a._avatarNodeMap[this.name];I_c&&I_c.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(I_a,I_c,I_b)},I_c._setAnimatorToLinkAvatar=function(I_a,I_b){this._handleSpriteToAvatar(I_a,I_b);for(var I_c=0,I_d=this._childs.length;I_c<I_d;I_c++){this._childs[I_c]._setAnimatorToLinkAvatar(I_a,I_b)}},I_o(0,I_c,"activeInHierarchy",function(){return this._activeInHierarchy}),I_o(0,I_c,"_loaded",null,function(I_a){this.__loaded=I_a}),I_o(0,I_c,"active",function(){return this._active},function(I_a){this._active!==I_a&&(this._active=I_a,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(I_a?this._activeHierarchy():this._inActiveHierarchy()))}),I_o(0,I_c,"componentsCount",function(){return this._components.length}),I_o(0,I_c,"loaded",function(){return this.__loaded}),I_o(0,I_c,"id",function(){return this._id}),I_o(0,I_c,"url",function(){return this._url}),I_o(0,I_c,"layer",function(){return this._layer},function(I_a){if(this._layer!==I_a){if(!I_a)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var I_b=0,I_c=this._colliders.length;if(this._layer)for(I_b=0;I_b<I_c;I_b++)this._layer._removeCollider(this._colliders[I_b]);for(I_b=0;I_b<I_c;I_b++)I_a._addCollider(this._colliders[I_b])}this._layer=I_a,this.event("layerchanged",I_a)}}),I_o(0,I_c,"scene",function(){return this._scene}),I_o(0,I_c,"transform",function(){return this._transform}),I_b.instantiate=function(I_a,I_b,I_c,I_d,I_e){void 0===I_c&&(I_c=!0);var I_f=I_a.clone();I_b&&I_b.addChild(I_f);var I_g=I_f.transform;if(I_c){var I_h=I_g.worldMatrix;I_a.transform.worldMatrix.cloneTo(I_h),I_g.worldMatrix=I_h}else I_d&&(I_g.position=I_d),I_e&&(I_g.rotation=I_e);return I_f},I_b.load=function(I_a){return I_x.loader.create(I_a,null,null,I_b)},I_b.WORLDMATRIX=0,I_b.MVPMATRIX=1,I_b._uniqueIDCounter=0,I_b._nameNumberCounter=0,I_b}(),I_Lb=function(I_a){function I_k(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],I_k.__super.call(this),!I_a||!I_b)throw"Shader Error";this._id=++I_k._count,this._vs=I_a,this._ps=I_b,this._attributeMap=I_c,this._sceneUniformMap=I_d,this._cameraUniformMap=I_e,this._spriteUniformMap=I_f,this._materialUniformMap=I_g,this._renderElementUniformMap=I_h,this._precompile=I_i,this._define=I_j,this._precompile&&I_k.extCompileObj&&I_k.extCompileFunc?I_k.extCompileFunc.call(I_k.extCompileObj,I_a,I_b,I_j):this.recreateResource()}I_n(I_k,"laya.d3.shader.Shader3D",I_c);var I_b=I_k.prototype;return I_b.recreateResource=function(){I_H.now();this._compile(),this.completeCreate(),this.memorySize=0},I_b.disposeResource=function(){I_F.mainContext.deleteShader(this._vshader),I_F.mainContext.deleteShader(this._pshader),I_F.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},I_b._compile=function(){if(!I_F.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var I_a=[this._vs,this._ps],I_b=I_F.mainContext;if(this._program=I_b.createProgram(),this._vshader=I_k._createShader(I_b,I_a[0],35633),this._pshader=I_k._createShader(I_b,I_a[1],35632),I_b.attachShader(this._program,this._vshader),I_b.attachShader(this._program,this._pshader),I_b.linkProgram(this._program),!I_p.isConchApp&&I_Ab.debugMode&&!I_b.getProgramParameter(this._program,35714))throw I_b.getProgramInfoLog(this._program);var I_c,I_d=0,I_e=0,I_f=0;for(I_f=I_p.isConchApp?I_b.getProgramParameterEx(this._vs,this._ps,"",35721):I_b.getProgramParameter(this._program,35721),I_d=0;I_d<I_f;I_d++){var I_g=null;I_c={vartype:"attribute",ivartype:0,attrib:I_g=I_p.isConchApp?I_b.getActiveAttribEx(this._vs,this._ps,"",I_d):I_b.getActiveAttrib(this._program,I_d),location:I_b.getAttribLocation(this._program,I_g.name),name:I_g.name,type:I_g.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(I_c)}var I_h=0;for(I_h=I_p.isConchApp?I_b.getProgramParameterEx(this._vs,this._ps,"",35718):I_b.getProgramParameter(this._program,35718),I_d=0;I_d<I_h;I_d++){var I_i=null;I_i=I_p.isConchApp?I_b.getActiveUniformEx(this._vs,this._ps,"",I_d):I_b.getActiveUniform(this._program,I_d),0<(I_c={vartype:"uniform",ivartype:1,attrib:I_g,location:I_b.getUniformLocation(this._program,I_i.name),name:I_i.name,type:I_i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(I_c.name=I_c.name.substr(0,I_c.name.length-3),I_c.isArray=!0,I_c.location=I_b.getUniformLocation(this._program,I_c.name)),this._uniformParams.push(I_c)}for(I_d=0,I_e=this._attributeParams.length;I_d<I_e;I_d++)(I_c=this._attributeParams[I_d]).indexOfParams=I_d,I_c.index=1,I_c.value=[I_c.location,null],I_c.codename=I_c.name,I_c.name=null!=this._attributeMap[I_c.codename]?this._attributeMap[I_c.codename]:I_c.codename,this._attributeParamsMap.push(I_c.name),this._attributeParamsMap.push(I_c),I_c._this=this,I_c.uploadedValue=[],I_c.fun=this._attribute;for(I_d=0,I_e=this._uniformParams.length;I_d<I_e;I_d++)switch((I_c=this._uniformParams[I_d]).indexOfParams=I_d,I_c.index=1,I_c.value=[I_c.location,null],I_c.codename=I_c.name,null!=this._sceneUniformMap[I_c.codename]?(I_c.name=this._sceneUniformMap[I_c.codename],this._sceneUniformParamsMap.push(I_c.name),this._sceneUniformParamsMap.push(I_c)):null!=this._cameraUniformMap[I_c.codename]?(I_c.name=this._cameraUniformMap[I_c.codename],this._cameraUniformParamsMap.push(I_c.name),this._cameraUniformParamsMap.push(I_c)):null!=this._spriteUniformMap[I_c.codename]?(I_c.name=this._spriteUniformMap[I_c.codename],this._spriteUniformParamsMap.push(I_c.name),this._spriteUniformParamsMap.push(I_c)):null!=this._materialUniformMap[I_c.codename]?(I_c.name=this._materialUniformMap[I_c.codename],this._materialUniformParamsMap.push(I_c.name),this._materialUniformParamsMap.push(I_c)):null!=this._renderElementUniformMap[I_c.codename]?(I_c.name=this._renderElementUniformMap[I_c.codename],this._renderElementUniformParamsMap.push(I_c.name),this._renderElementUniformParamsMap.push(I_c)):console.log("Shader:can't find uinform name:"+I_c.codename+" in shader file."),I_c._this=this,I_c.uploadedValue=[],I_c.type){case 5124:I_c.fun=I_c.isArray?this._uniform1iv:this._uniform1i;break;case 5126:I_c.fun=I_c.isArray?this._uniform1fv:this._uniform1f;break;case 35664:I_c.fun=I_c.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:I_c.fun=I_c.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:I_c.fun=I_c.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:I_c.fun=this._uniform_sampler2D;break;case 35680:I_c.fun=this._uniform_samplerCube;break;case 35676:I_c.fun=this._uniformMatrix4fv;break;case 35670:I_c.fun=this._uniform1i;break;case 35674:I_c.fun=this._uinformMatrix2fv;break;case 35675:I_c.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},I_b._attribute=function(I_a,I_b){var I_c=I_F.mainContext,I_d=I_h._enableAtributes,I_e=I_a.location;return I_d[I_e]||I_c.enableVertexAttribArray(I_e),I_c.vertexAttribPointer(I_e,I_b[0],I_b[1],I_b[2],I_b[3],I_b[4]),I_d[I_e]=I_h._bindVertexBuffer,1},I_b._uniform1f=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b?(I_F.mainContext.uniform1f(I_a.location,I_c[0]=I_b),1):0},I_b._uniform1fv=function(I_a,I_b){if(I_b.length<4){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]||I_c[2]!==I_b[2]||I_c[3]!==I_b[3]?(I_F.mainContext.uniform1fv(I_a.location,I_b),I_c[0]=I_b[0],I_c[1]=I_b[1],I_c[2]=I_b[2],I_c[3]=I_b[3],1):0}return I_F.mainContext.uniform1fv(I_a.location,I_b),1},I_b._uniform_vec2=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]?(I_F.mainContext.uniform2f(I_a.location,I_c[0]=I_b[0],I_c[1]=I_b[1]),1):0},I_b._uniform_vec2v=function(I_a,I_b){if(I_b.length<2){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]||I_c[2]!==I_b[2]||I_c[3]!==I_b[3]?(I_F.mainContext.uniform2fv(I_a.location,I_b),I_c[0]=I_b[0],I_c[1]=I_b[1],I_c[2]=I_b[2],I_c[3]=I_b[3],1):0}return I_F.mainContext.uniform2fv(I_a.location,I_b),1},I_b._uniform_vec3=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]||I_c[2]!==I_b[2]?(I_F.mainContext.uniform3f(I_a.location,I_c[0]=I_b[0],I_c[1]=I_b[1],I_c[2]=I_b[2]),1):0},I_b._uniform_vec3v=function(I_a,I_b){return I_F.mainContext.uniform3fv(I_a.location,I_b),1},I_b._uniform_vec4=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]||I_c[2]!==I_b[2]||I_c[3]!==I_b[3]?(I_F.mainContext.uniform4f(I_a.location,I_c[0]=I_b[0],I_c[1]=I_b[1],I_c[2]=I_b[2],I_c[3]=I_b[3]),1):0},I_b._uniform_vec4v=function(I_a,I_b){return I_F.mainContext.uniform4fv(I_a.location,I_b),1},I_b._uniformMatrix2fv=function(I_a,I_b){return I_F.mainContext.uniformMatrix2fv(I_a.location,!1,I_b),1},I_b._uniformMatrix3fv=function(I_a,I_b){return I_F.mainContext.uniformMatrix3fv(I_a.location,!1,I_b),1},I_b._uniformMatrix4fv=function(I_a,I_b){return I_F.mainContext.uniformMatrix4fv(I_a.location,!1,I_b),1},I_b._uinformMatrix2fv=function(I_a,I_b){return I_F.mainContext.uniformMatrix2fv(I_a.location,!1,I_b),1},I_b._uinformMatrix3fv=function(I_a,I_b){return I_F.mainContext.uniformMatrix3fv(I_a.location,!1,I_b),1},I_b._uniform1i=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b?(I_F.mainContext.uniform1i(I_a.location,I_c[0]=I_b),1):0},I_b._uniform1iv=function(I_a,I_b){return I_F.mainContext.uniform1iv(I_a.location,I_b),1},I_b._uniform_ivec2=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]?(I_F.mainContext.uniform2i(I_a.location,I_c[0]=I_b[0],I_c[1]=I_b[1]),1):0},I_b._uniform_ivec2v=function(I_a,I_b){return I_F.mainContext.uniform2iv(I_a.location,I_b),1},I_b._uniform_vec3i=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]||I_c[2]!==I_b[2]?(I_F.mainContext.uniform3i(I_a.location,I_c[0]=I_b[0],I_c[1]=I_b[1],I_c[2]=I_b[2]),1):0},I_b._uniform_vec3vi=function(I_a,I_b){return I_F.mainContext.uniform3iv(I_a.location,I_b),1},I_b._uniform_vec4i=function(I_a,I_b){var I_c=I_a.uploadedValue;return I_c[0]!==I_b[0]||I_c[1]!==I_b[1]||I_c[2]!==I_b[2]||I_c[3]!==I_b[3]?(I_F.mainContext.uniform4i(I_a.location,I_c[0]=I_b[0],I_c[1]=I_b[1],I_c[2]=I_b[2],I_c[3]=I_b[3]),1):0},I_b._uniform_vec4vi=function(I_a,I_b){return I_F.mainContext.uniform4iv(I_a.location,I_b),1},I_b._uniform_sampler2D=function(I_a,I_b){var I_c=I_b.source||I_b.defaulteTexture.source,I_d=I_F.mainContext,I_e=I_a.uploadedValue;if(null!=I_e[0])return I_d.activeTexture(I_k._TEXTURES[I_e[0]]),I_c&&I_G.bindTexture(I_d,3553,I_c),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return I_e[0]=this._curActTexIndex,I_d.uniform1i(I_a.location,this._curActTexIndex),I_d.activeTexture(I_k._TEXTURES[this._curActTexIndex]),I_c&&I_G.bindTexture(I_d,3553,I_c),this._curActTexIndex++,1},I_b._uniform_samplerCube=function(I_a,I_b){var I_c=I_b.source||I_b.defaulteTexture.source,I_d=I_F.mainContext,I_e=I_a.uploadedValue;if(null!=I_e[0])return I_d.activeTexture(I_k._TEXTURES[I_e[0]]),I_c?I_G.bindTexture(I_d,34067,I_c):I_G.bindTexture(I_d,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return I_e[0]=this._curActTexIndex,I_d.uniform1i(I_a.location,this._curActTexIndex),I_d.activeTexture(I_k._TEXTURES[this._curActTexIndex]),I_c?I_G.bindTexture(I_d,34067,I_c):I_G.bindTexture(I_d,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},I_b._noSetValue=function(I_a){console.log("no....:"+I_a.name)},I_b.bind=function(){return I_c.activeShader=this,(I_c.bindShader=this).activeResource(),I_G.UseProgram(this._program)},I_b.uploadAttributes=function(I_a,I_b){for(var I_c,I_d,I_e=0,I_f=0,I_g=this._attributeParamsMap.length;I_f<I_g;I_f+=2)I_d=this._attributeParamsMap[I_f+1],null!=(I_c=I_a[this._attributeParamsMap[I_f]])&&(I_b&&I_b[I_d.name]&&I_b[I_d.name].bind(),I_e+=I_d.fun.call(this,I_d,I_c));I_A.shaderCall+=I_e},I_b.uploadAttributesX=function(I_a,I_b){for(var I_c,I_d,I_e=0,I_f=0,I_g=this._attributeParamsMap.length;I_f<I_g;I_f+=2)I_d=this._attributeParamsMap[I_f+1],null!=(I_c=I_a[this._attributeParamsMap[I_f]])&&(I_b._bind(),I_e+=I_d.fun.call(this,I_d,I_c));I_A.shaderCall+=I_e},I_b.uploadSceneUniforms=function(I_a){for(var I_b,I_c,I_d=0,I_e=0,I_f=this._sceneUniformParamsMap.length;I_e<I_f;I_e+=2)I_c=this._sceneUniformParamsMap[I_e+1],null!=(I_b=I_a[this._sceneUniformParamsMap[I_e]])&&(I_d+=I_c.fun.call(this,I_c,I_b));I_A.shaderCall+=I_d},I_b.uploadCameraUniforms=function(I_a){for(var I_b,I_c,I_d=0,I_e=0,I_f=this._cameraUniformParamsMap.length;I_e<I_f;I_e+=2)I_c=this._cameraUniformParamsMap[I_e+1],null!=(I_b=I_a[this._cameraUniformParamsMap[I_e]])&&(I_d+=I_c.fun.call(this,I_c,I_b));I_A.shaderCall+=I_d},I_b.uploadSpriteUniforms=function(I_a){for(var I_b,I_c,I_d=0,I_e=0,I_f=this._spriteUniformParamsMap.length;I_e<I_f;I_e+=2)I_c=this._spriteUniformParamsMap[I_e+1],null!=(I_b=I_a[this._spriteUniformParamsMap[I_e]])&&(I_d+=I_c.fun.call(this,I_c,I_b));I_A.shaderCall+=I_d},I_b.uploadMaterialUniforms=function(I_a){for(var I_b,I_c,I_d=0,I_e=0,I_f=this._materialUniformParamsMap.length;I_e<I_f;I_e+=2)I_c=this._materialUniformParamsMap[I_e+1],null!=(I_b=I_a[this._materialUniformParamsMap[I_e]])&&(I_d+=I_c.fun.call(this,I_c,I_b));I_A.shaderCall+=I_d},I_b.uploadRenderElementUniforms=function(I_a){for(var I_b,I_c,I_d=0,I_e=0,I_f=this._renderElementUniformParamsMap.length;I_e<I_f;I_e+=2)I_c=this._renderElementUniformParamsMap[I_e+1],null!=(I_b=I_a[this._renderElementUniformParamsMap[I_e]])&&(I_d+=I_c.fun.call(this,I_c,I_b));I_A.shaderCall+=I_d},I_k.create=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){return new I_k(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j)},I_k.addInclude=function(I_a,I_b){I_v.addInclude(I_a,I_b)},I_k._createShader=function(I_a,I_b,I_c){var I_d=I_a.createShader(I_c);if(I_a.shaderSource(I_d,I_b),I_a.compileShader(I_d),I_Ab.debugMode&&!I_a.getShaderParameter(I_d,35713))throw I_a.getShaderInfoLog(I_d);return I_d},I_k.PERIOD_RENDERELEMENT=0,I_k.PERIOD_MATERIAL=1,I_k.PERIOD_SPRITE=2,I_k.PERIOD_CAMERA=3,I_k.PERIOD_SCENE=4,I_k._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],I_k._count=0,I_k._preCompile=!1,I_k.extCompileFunc=null,I_k.extCompileObj=null,I_l(I_k,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new I_B}]),I_k}(),I_Mb=function(I_h){function I_i(){this._transformUV=null,I_i.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new I_gb(.6,.6,.6)),this._setColor(10,new I_gb(1,1,1)),this._setColor(11,new I_hb(1,1,1,8)),this._setColor(12,new I_gb(1,1,1)),this._setColor(7,new I_hb(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new I_hb(1,1,0,0)),this.renderMode=1}I_n(I_i,"laya.d3.core.material.StandardMaterial",I_h);var I_a=I_i.prototype;return I_a.disableLight=function(){this._addDisablePublicShaderDefine(I_Ab.SHADERDEFINE_POINTLIGHT|I_Ab.SHADERDEFINE_SPOTLIGHT|I_Ab.SHADERDEFINE_DIRECTIONLIGHT)},I_a.disableFog=function(){this._addDisablePublicShaderDefine(I_Ab.SHADERDEFINE_FOG)},I_a.onAsynLoaded=function(I_a,I_b,I_c){var I_d=I_b[0];if(I_d.version)I_h.prototype.onAsynLoaded.call(this,I_a,I_b,I_c);else{var I_e=I_b[1],I_f=I_d.props;for(var I_g in I_f)this[I_g]=I_f[I_g];I_i._parseStandardMaterial(I_e,this,I_d),this._endLoaded()}},I_a.cloneTo=function(I_a){I_h.prototype.cloneTo.call(this,I_a);var I_b=I_a;this._transformUV&&(I_b._transformUV=this._transformUV.clone())},I_o(0,I_a,"ambientColor",function(){return this._getColor(9)},function(I_a){this._setColor(9,I_a)}),I_o(0,I_a,"ambientTexture",function(){return this._getTexture(5)},function(I_a){I_a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,I_a)}),I_o(0,I_a,"renderMode",null,function(I_a){switch(I_a){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(I_i.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(I_a)}),I_o(0,I_a,"reflectColor",function(){return this._getColor(12)},function(I_a){this._setColor(12,I_a)}),I_o(0,I_a,"tilingOffset",function(){return this._getColor(15)},function(I_a){if(I_a){var I_b=I_a.elements;1!=I_b[0]||1!=I_b[1]||0!=I_b[2]||0!=I_b[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,I_a)}),I_o(0,I_a,"albedo",function(){return this._getColor(7)},function(I_a){this._setColor(7,I_a)}),I_o(0,I_a,"diffuseColor",function(){return this._getColor(10)},function(I_a){this._setColor(10,I_a)}),I_o(0,I_a,"albedoColor",function(){return this._getColor(7)},function(I_a){this._setColor(7,I_a)}),I_o(0,I_a,"specularColor",function(){return this._getColor(11)},function(I_a){this._setColor(11,I_a)}),I_o(0,I_a,"diffuseTexture",function(){return this._getTexture(1)},function(I_a){I_a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,I_a)}),I_o(0,I_a,"normalTexture",function(){return this._getTexture(2)},function(I_a){I_a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,I_a)}),I_o(0,I_a,"specularTexture",function(){return this._getTexture(3)},function(I_a){I_a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,I_a)}),I_o(0,I_a,"emissiveTexture",function(){return this._getTexture(4)},function(I_a){I_a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,I_a)}),I_o(0,I_a,"reflectTexture",function(){return this._getTexture(6)},function(I_a){I_a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,I_a)}),I_o(0,I_a,"transformUV",function(){return this._transformUV},function(I_a){this._transformUV=I_a,this._setMatrix4x4(13,I_a.matrix),I_a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,I_a.matrix.elements,0)}),I_i.__init__=function(){I_i.SHADERDEFINE_DIFFUSEMAP=I_i.shaderDefines.registerDefine("DIFFUSEMAP"),I_i.SHADERDEFINE_NORMALMAP=I_i.shaderDefines.registerDefine("NORMALMAP"),I_i.SHADERDEFINE_SPECULARMAP=I_i.shaderDefines.registerDefine("SPECULARMAP"),I_i.SHADERDEFINE_EMISSIVEMAP=I_i.shaderDefines.registerDefine("EMISSIVEMAP"),I_i.SHADERDEFINE_AMBIENTMAP=I_i.shaderDefines.registerDefine("AMBIENTMAP"),I_i.SHADERDEFINE_REFLECTMAP=I_i.shaderDefines.registerDefine("REFLECTMAP"),I_i.SHADERDEFINE_UVTRANSFORM=I_i.shaderDefines.registerDefine("UVTRANSFORM"),I_i.SHADERDEFINE_TILINGOFFSET=I_i.shaderDefines.registerDefine("TILINGOFFSET"),I_i.SHADERDEFINE_ADDTIVEFOG=I_i.shaderDefines.registerDefine("ADDTIVEFOG")},I_i.load=function(I_a){return I_x.loader.create(I_a,null,null,I_i)},I_i._parseStandardMaterial=function(I_a,I_b,I_c){var I_d=I_c.customProps,I_e=I_d.ambientColor;I_b.ambientColor=new I_gb(I_e[0],I_e[1],I_e[2]);var I_f=I_d.diffuseColor;I_b.diffuseColor=new I_gb(I_f[0],I_f[1],I_f[2]);var I_g=I_d.specularColor;I_b.specularColor=new I_hb(I_g[0],I_g[1],I_g[2],I_g[3]);var I_h=I_d.reflectColor;I_b.reflectColor=new I_gb(I_h[0],I_h[1],I_h[2]);var I_i=I_d.albedoColor;I_i&&(I_b.albedo=new I_hb(I_i[0],I_i[1],I_i[2],I_i[3]));var I_j=I_d.diffuseTexture.texture2D;I_j&&(I_b.diffuseTexture=I_t.getRes(I_a[I_j]));var I_k=I_d.normalTexture.texture2D;I_k&&(I_b.normalTexture=I_t.getRes(I_a[I_k]));var I_l=I_d.specularTexture.texture2D;I_l&&(I_b.specularTexture=I_t.getRes(I_a[I_l]));var I_m=I_d.emissiveTexture.texture2D;I_m&&(I_b.emissiveTexture=I_t.getRes(I_a[I_m]));var I_n=I_d.ambientTexture.texture2D;I_n&&(I_b.ambientTexture=I_t.getRes(I_a[I_n]));var I_o=I_d.reflectTexture.texture2D;I_o&&(I_b.reflectTexture=I_t.getRes(I_a[I_o]))},I_i.RENDERMODE_OPAQUE=1,I_i.RENDERMODE_OPAQUEDOUBLEFACE=2,I_i.RENDERMODE_CUTOUT=3,I_i.RENDERMODE_CUTOUTDOUBLEFACE=4,I_i.RENDERMODE_TRANSPARENT=13,I_i.RENDERMODE_TRANSPARENTDOUBLEFACE=14,I_i.RENDERMODE_ADDTIVE=15,I_i.RENDERMODE_ADDTIVEDOUBLEFACE=16,I_i.RENDERMODE_DEPTHREAD_TRANSPARENT=5,I_i.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,I_i.RENDERMODE_DEPTHREAD_ADDTIVE=7,I_i.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,I_i.RENDERMODE_NONDEPTH_TRANSPARENT=9,I_i.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,I_i.RENDERMODE_NONDEPTH_ADDTIVE=11,I_i.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,I_i.SHADERDEFINE_DIFFUSEMAP=0,I_i.SHADERDEFINE_NORMALMAP=0,I_i.SHADERDEFINE_SPECULARMAP=0,I_i.SHADERDEFINE_EMISSIVEMAP=0,I_i.SHADERDEFINE_AMBIENTMAP=0,I_i.SHADERDEFINE_REFLECTMAP=0,I_i.SHADERDEFINE_UVTRANSFORM=0,I_i.SHADERDEFINE_TILINGOFFSET=0,I_i.SHADERDEFINE_ADDTIVEFOG=0,I_i.DIFFUSETEXTURE=1,I_i.NORMALTEXTURE=2,I_i.SPECULARTEXTURE=3,I_i.EMISSIVETEXTURE=4,I_i.AMBIENTTEXTURE=5,I_i.REFLECTTEXTURE=6,I_i.ALBEDO=7,I_i.UVANIAGE=8,I_i.MATERIALAMBIENT=9,I_i.MATERIALDIFFUSE=10,I_i.MATERIALSPECULAR=11,I_i.MATERIALREFLECT=12,I_i.UVMATRIX=13,I_i.UVAGE=14,I_i.TILINGOFFSET=15,I_l(I_i,["defaultMaterial",function(){var I_a=new I_i;return I_a.lock=!0,this.defaultMaterial=I_a},"shaderDefines",function(){return this.shaderDefines=new I_kb(I_Eb.shaderDefines)}]),I_i}(I_Eb),I_Nb=function(I_a){function I_g(I_a,I_b,I_c,I_d,I_e){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===I_c&&(I_c=35044),void 0===I_d&&(I_d=!1),I_g.__super.call(this),this._indexType=I_a,this._indexCount=I_b,this._bufferUsage=I_c,this._bufferType=34963,this._canRead=I_d;var I_f;if("ushort"==I_a)this._indexTypeByteCount=2;else{if("ubyte"!=I_a)throw new Error("unidentification index type.");this._indexTypeByteCount=1}I_f=this._indexTypeByteCount*I_b,this._byteLength=I_f,this._bind(),I_h._gl.bufferData(this._bufferType,I_f,this._bufferUsage),this.uri=I_e,I_d?("ushort"==I_a?this._buffer=new Uint16Array(I_b):"ubyte"==I_a&&(this._buffer=new Uint8Array(I_b)),this.memorySize=2*I_f):this.memorySize=I_f}I_n(I_g,"laya.d3.graphics.IndexBuffer3D",I_a);var I_b=I_g.prototype;return I_b.setData=function(I_a,I_b,I_c,I_d){void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=4294967295);var I_e=0;if("ushort"==this._indexType?(I_e=2,0===I_c&&4294967295===I_d||(I_a=new Uint16Array(I_a.buffer,I_c*I_e,I_d))):"ubyte"==this._indexType&&(I_e=1,0===I_c&&4294967295===I_d||(I_a=new Uint8Array(I_a.buffer,I_c*I_e,I_d))),this._bind(),I_h._gl.bufferSubData(this._bufferType,I_b*I_e,I_a),this._canRead)if(0!==I_b||0!==I_c||4294967295!==I_d){var I_f=this._buffer.length-I_b;I_f<I_d&&(I_d=I_f);for(var I_g=0;I_g<I_d;I_g++)this._buffer[I_b+I_g]=I_a[I_g]}else this._buffer=I_a},I_b.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},I_b.disposeResource=function(){I_a.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},I_o(0,I_b,"indexType",function(){return this._indexType}),I_o(0,I_b,"indexTypeByteCount",function(){return this._indexTypeByteCount}),I_o(0,I_b,"indexCount",function(){return this._indexCount}),I_o(0,I_b,"canRead",function(){return this._canRead}),I_g.INDEXTYPE_UBYTE="ubyte",I_g.INDEXTYPE_USHORT="ushort",I_g.create=function(I_a,I_b,I_c,I_d,I_e){return void 0===I_c&&(I_c=35044),void 0===I_d&&(I_d=!1),new I_g(I_a,I_b,I_c,I_d,I_e)},I_g}(I_h),I_Ob=function(I_f){function I_g(I_a,I_b,I_c,I_d,I_e){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===I_d&&(I_d=!1),I_g.__super.call(this),this._vertexDeclaration=I_a,this._vertexCount=I_b,this._bufferUsage=I_c,this._bufferType=34962,this._canRead=I_d,this.uri=I_e,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*I_b,this._bind(),I_h._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),I_d&&(this._buffer=new Float32Array(this._byteLength/4))}I_n(I_g,"laya.d3.graphics.VertexBuffer3D",I_f);var I_a=I_g.prototype;return I_a.bindWithIndexBuffer=function(I_a){I_a&&I_a._bind(),this._bind()},I_a.setData=function(I_a,I_b,I_c,I_d){if(void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=4294967295),0===I_c&&4294967295===I_d||(I_a=new Float32Array(I_a.buffer,4*I_c,I_d)),this._bind(),I_h._gl.bufferSubData(this._bufferType,4*I_b,I_a),this._canRead)if(0!==I_b||0!==I_c||4294967295!==I_d){var I_e=this._buffer.length-I_b;I_e<I_d&&(I_d=I_e);for(var I_f=0;I_f<I_d;I_f++)this._buffer[I_b+I_f]=I_a[I_f]}else this._buffer=I_a},I_a.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},I_a.disposeResource=function(){for(var I_a=I_F.mainContext,I_b=this._vertexDeclaration.getVertexElements(),I_c=I_h._enableAtributes,I_d=0,I_e=I_b.length;I_d<I_e;I_d++)I_c[I_d]===this._glBuffer&&(I_a.disableVertexAttribArray(I_d),I_c[I_d]=null);I_f.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},I_o(0,I_a,"vertexDeclaration",function(){return this._vertexDeclaration}),I_o(0,I_a,"vertexCount",function(){return this._vertexCount}),I_o(0,I_a,"canRead",function(){return this._canRead}),I_g.create=function(I_a,I_b,I_c,I_d,I_e){return void 0===I_c&&(I_c=35044),void 0===I_d&&(I_d=!1),new I_g(I_a,I_b,I_c,I_d,I_e)},I_g}(I_h),I_Pb=function(I_a){function I_v(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,I_v.__super.call(this),this._type=3553}I_n(I_v,"laya.d3.resource.DataTexture2D",I_Fb);var I_b=I_v.prototype;return I_b.genDebugMipmaps=function(){var I_a=[];return I_a.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),I_a.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),I_a.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),I_a.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),I_a.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),I_a.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),I_a.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),I_a.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),I_a.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),I_a.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),I_a},I_b._onTextureLoaded=function(I_a){},I_b._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var I_a=I_F.mainContext,I_b=this._source=I_a.createTexture(),I_c=this._width,I_d=this._height,I_e=I_G.curBindTexTarget,I_f=I_G.curBindTexValue,I_g=!1;if(I_G.bindTexture(I_a,this._type,I_b),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var I_h=0;I_a.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var I_i=0;I_i<this._mipmaps.length;I_i++){if(this._mipmaps[I_i].byteLength!=I_j*I_k*4)throw"mipmap size error  level:"+I_i;I_a.texSubImage2D(this._type,0,I_v.simLodRect[I_h++],I_v.simLodRect[I_h++],I_v.simLodRect[I_h++],I_v.simLodRect[I_h++],6408,5121,new Uint8Array(this._mipmaps[I_i]))}this.minFifter=9729,this.magFifter=9729}else{var I_j=this._width,I_k=this._height;for(I_h=0,I_a.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),I_i=0;I_i<this._mipmaps.length;I_i++){if(this._mipmaps[I_i].byteLength!=I_j*I_k*4)throw"mipmap size error  level:"+I_i;I_a.texImage2D(this._type,I_i,6408,I_j,I_k,0,6408,5121,new Uint8Array(this._mipmaps[I_i])),(I_j/=2)<1&&(I_j=1),(I_k/=2)<1&&(I_k=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&I_a.pixelStorei(I_a.UNPACK_ALIGNMENT,1),I_a.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var I_l=0,I_m=!1,I_n=!1;this._buffer.byteLength==4*I_c*I_d?(I_l=6408,I_m=!0):this._buffer.byteLength==3*I_c*I_d?(I_l=6407,I_n=!0):I_l=this._format,I_m||I_n?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),I_n&&I_a.pixelStorei(I_a.UNPACK_ALIGNMENT,1),I_a.texImage2D(this._type,0,I_l,I_c,I_d,0,I_l,5121,this._buffer)):I_a&&I_l==I_a.ALPHA?(I_a.texImage2D(3553,0,I_l,I_c,I_d,0,I_l,I_a.UNSIGNED_BYTE,this._buffer),I_g=!0):0!=I_l&&(I_a.compressedTexImage2D(3553,0,I_l,I_c,I_d,0,this._buffer),I_g=!0)}var I_o=this._minFifter,I_p=this._magFifter,I_s=0==this._wrapModeU?10497:33071,I_t=0==this._wrapModeV?10497:33071,I_u=I_w.isPOT(I_c,I_d);I_u?(this._mipmap||this._mipmaps?-1!==I_o||(I_o=9987):-1!==I_o||(I_o=9729),-1!==I_p||(I_p=9729),I_a.texParameteri(this._type,10241,I_o),I_a.texParameteri(this._type,10240,I_p),I_a.texParameteri(this._type,10242,I_s),I_a.texParameteri(this._type,10243,I_t),this._mipmap&&I_a.generateMipmap(this._type)):(-1!==I_o||(I_o=9729),-1!==I_p||(I_p=9729),I_a.texParameteri(this._type,10241,I_o),I_a.texParameteri(this._type,10240,I_p),I_a.texParameteri(this._type,10242,33071),I_a.texParameteri(this._type,10243,33071)),I_e&&I_f&&I_G.bindTexture(I_a,I_e,I_f),this.memorySize=I_g?this._buffer.length:I_u?I_c*I_d*4*(1+1/3):I_c*I_d*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},I_b.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},I_b.onAsynLoaded=function(I_a,I_b,I_c){var I_d;I_c&&(I_d=I_c[0].call(this,I_b)),I_d&&(this._width=I_d.width,this._height=I_d.height,this._buffer=I_d.data),this._src=I_a,this._size=new I_pb(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},I_b.getPixels=function(){return new Uint8Array(this._buffer)},I_b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(I_F.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},I_o(0,I_b,"src",function(){return this._src}),I_v.create=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){if(void 0===I_d&&(I_d=9729),void 0===I_e&&(I_e=9729),void 0===I_f&&(I_f=!0),!I_a||I_a.byteLength<I_b*I_c*4)throw"DataTexture2D create error";var I_h=new I_v;return I_h.uri=I_g,I_h._buffer=I_a,I_h._width=I_b,I_h._height=I_c,I_h._mipmap=I_f,I_h._magFifter=I_d,I_h._minFifter=I_e,I_h._size=new I_pb(I_h._width,I_h._height),I_h._conchTexture?alert("怎么给runtime传递datatexture数据"):I_h.activeResource(),I_h},I_v.load=function(I_a,I_b,I_c,I_d,I_e){if(void 0===I_b&&(I_b=0),void 0===I_c&&(I_c=0),void 0===I_d&&(I_d=9729),void 0===I_e&&(I_e=9729),"mipmaps"===I_C.getFileExtension(I_a)){var I_f=I_x.loader.create(I_a,null,null,I_v,[function(I_a){this._mipmaps=[];var I_b=new Uint32Array(I_a);this._width=I_b[0];var I_c=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,I_c=1024),this._width!=I_c)throw"现在只支持512x256的环境贴图。当前的是"+I_b[0];this._height=I_b[1];for(var I_d=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,I_e=this._height,I_f=8;;){var I_g=I_d*I_e*4;if(I_f+I_g>I_a.byteLength)throw"load mipmaps data size error ";var I_h=new Uint8Array(I_a,I_f,I_g);if(this._mipmaps.push(I_h),I_f+=I_g,1==I_d&&1==I_e)break;(I_d/=2)<1&&(I_d=1),(I_e/=2)<1&&(I_e=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){I_f.simLodInfo=new Float32Array(40);for(var I_g=0;I_g<I_f.simLodInfo.length;)I_f.simLodInfo[I_g]=(I_v.simLodRect[I_g]+.5)/1024,I_g++,I_f.simLodInfo[I_g]=(I_v.simLodRect[I_g]+.5)/256,I_g++,I_f.simLodInfo[I_g]=Math.max(I_v.simLodRect[I_g]-1,.1)/1024,I_g++,I_f.simLodInfo[I_g]=Math.max(I_v.simLodRect[I_g]-1.5,.1)/256,I_g++}return I_f}if("number"==typeof I_b)return I_x.loader.create(I_a,null,null,I_v,[function(I_a){return this._width=I_b,this._height=I_c,this._buffer=I_a,null}]);if("function"==typeof I_b)return I_x.loader.create(I_a,null,null,I_v,[I_b]);throw new Error("unknown params.")},I_v.lodasatlas=!1,I_l(I_v,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),I_v}(),I_Qb=function(I_a){function I_b(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,I_b.__super.call(this)}I_n(I_b,"laya.d3.resource.models.PrimitiveMesh",I_Gb);var I_c=I_b.prototype;return I_x.imps(I_c,{"laya.d3.core.render.IRenderable":!0}),I_c._getVertexBuffer=function(I_a){return void 0===I_a&&(I_a=0),0===I_a?this._vertexBuffer:null},I_c._getVertexBuffers=function(){return null},I_c._getIndexBuffer=function(){return this._indexBuffer},I_c._getPositions=function(){var I_a,I_b=[],I_c=this._vertexBuffer.vertexDeclaration.getVertexElements(),I_d=0;for(I_d=0;I_d<I_c.length;I_d++){var I_e=I_c[I_d];if("vector3"===I_e.elementFormat&&0===I_e.elementUsage){I_a=I_e;break}}var I_f=this._vertexBuffer.getData();for(I_d=0;I_d<I_f.length;I_d+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var I_g=I_d+I_a.offset/4,I_h=new I_gb(I_f[I_g+0],I_f[I_g+1],I_f[I_g+2]);I_b.push(I_h)}return I_b},I_c.getRenderElement=function(I_a){return this},I_c.getRenderElementsCount=function(){return 1},I_c.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},I_c._beforeRender=function(I_a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},I_c._render=function(I_a){I_F.mainContext.drawElements(4,this._numberIndices,5123,0),I_A.drawCall++,I_A.trianglesFaces+=this._numberIndices/3},I_o(0,I_c,"_vertexBufferCount",function(){return 1}),I_o(0,I_c,"triangleCount",function(){return this._indexBuffer.indexCount/3}),I_b}(),I_Rb=function(I_a){function I_b(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,I_b.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}I_n(I_b,"laya.d3.resource.models.Mesh",I_Gb);var I_c=I_b.prototype;return I_c._getPositions=function(){var I_a,I_b,I_c,I_d,I_e,I_f=[],I_g=0,I_h=0,I_i=0;if(0!==this._vertexBuffers.length){var I_j=this._vertexBuffers.length;for(I_g=0;I_g<I_j;I_g++){for(I_c=(I_a=this._vertexBuffers[I_g]).vertexDeclaration.getVertexElements(),I_h=0;I_h<I_c.length;I_h++)if("vector3"===(I_d=I_c[I_h]).elementFormat&&0===I_d.elementUsage){I_b=I_d;break}for(I_e=I_a.getData(),I_h=0;I_h<I_e.length;I_h+=I_a.vertexDeclaration.vertexStride/4)I_i=I_h+I_b.offset/4,I_f.push(new I_gb(I_e[I_i+0],I_e[I_i+1],I_e[I_i+2]))}}else{var I_k=this._subMeshes.length;for(I_g=0;I_g<I_k;I_g++){for(I_c=(I_a=this._subMeshes[I_g]._getVertexBuffer()).vertexDeclaration.getVertexElements(),I_h=0;I_h<I_c.length;I_h++)if("vector3"===(I_d=I_c[I_h]).elementFormat&&0===I_d.elementUsage){I_b=I_d;break}for(I_e=I_a.getData(),I_h=0;I_h<I_e.length;I_h+=I_a.vertexDeclaration.vertexStride/4)I_i=I_h+I_b.offset/4,I_f.push(new I_gb(I_e[I_i+0],I_e[I_i+1],I_e[I_i+2]))}}return I_f},I_c._setSubMeshes=function(I_a){this._subMeshes=I_a,this._subMeshCount=I_a.length;for(var I_b=0;I_b<this._subMeshCount;I_b++)I_a[I_b]._indexInMesh=I_b;this._positions=this._getPositions(),this._generateBoundingObject()},I_c.onAsynLoaded=function(I_a,I_b,I_c){var I_d=I_b[0],I_e=I_b[1];I_Ya.read(I_d,this,this._materials,this._subMeshes,I_e),this.completeCreate(),this._endLoaded()},I_c.getSubMesh=function(I_a){return this._subMeshes[I_a]},I_c.getSubMeshCount=function(){return this._subMeshes.length},I_c.getRenderElementsCount=function(){return this._subMeshes.length},I_c.getRenderElement=function(I_a){return this._subMeshes[I_a]},I_c.disposeResource=function(){for(var I_a=0;I_a<this._subMeshes.length;I_a++)this._subMeshes[I_a].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},I_o(0,I_c,"materials",function(){return this._materials.slice()}),I_o(0,I_c,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),I_b.load=function(I_a){return I_x.loader.create(I_a,null,null,I_b)},I_b}(),I_Sb=(function(I_a){function I_j(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===I_c&&(I_c=6408),void 0===I_d&&(I_d=5121),void 0===I_e&&(I_e=33189),void 0===I_f&&(I_f=!1),void 0===I_g&&(I_g=!1),void 0===I_h&&(I_h=-1),void 0===I_i&&(I_i=-1),I_j.__super.call(this),this._type=3553,this._width=I_a,this._height=I_b,this._size=new I_pb(I_a,I_b),this._surfaceFormat=I_c,this._surfaceType=I_d,this._depthStencilFormat=I_e,I_p.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=I_f,this._repeat=I_g,this._minFifter=I_h,this._magFifter=I_i,this.activeResource(),this._alreadyResolved=!0}I_n(I_j,"laya.d3.resource.RenderTexture",I_Fb);var I_b=I_j.prototype;I_b.recreateResource=function(){var I_a=I_F.mainContext;this._frameBuffer=I_a.createFramebuffer(),this._source=I_a.createTexture();var I_b=I_G.curBindTexTarget,I_c=I_G.curBindTexValue;I_G.bindTexture(I_a,this._type,this._source),I_a.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var I_d=this._minFifter,I_e=this._magFifter,I_f=this._repeat?10497:33071;if(I_w.isPOT(this._width,this._height)?(this._mipmap?-1!==I_d||(I_d=9987):-1!==I_d||(I_d=9729),-1!==I_e||(I_e=9729),I_a.texParameteri(this._type,10241,I_d),I_a.texParameteri(this._type,10240,I_e),I_a.texParameteri(this._type,10242,I_f),I_a.texParameteri(this._type,10243,I_f),this._mipmap&&I_a.generateMipmap(this._type)):(-1!==I_d||(I_d=9729),-1!==I_e||(I_e=9729),I_a.texParameteri(this._type,10241,I_d),I_a.texParameteri(this._type,10240,I_e),I_a.texParameteri(this._type,10242,33071),I_a.texParameteri(this._type,10243,33071)),I_b&&I_c&&I_G.bindTexture(I_a,I_b,I_c),I_a.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=I_a.createRenderbuffer(),I_a.bindRenderbuffer(36161,this._depthStencilBuffer),I_a.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),I_a.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:I_a.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:I_a.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:I_a.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}I_a.framebufferTexture2D(36160,36064,3553,this._source,0),I_a.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},I_b.start=function(){I_F.mainContext.bindFramebuffer(36160,this.frameBuffer),(I_j._currentRenderTarget=this)._alreadyResolved=!1},I_b.end=function(){I_F.mainContext.bindFramebuffer(36160,null),I_j._currentRenderTarget=null,this._alreadyResolved=!0},I_b.getData=function(I_a,I_b,I_c,I_d){var I_e=I_F.mainContext;if(I_e.bindFramebuffer(36160,this._frameBuffer),!(36053===I_e.checkFramebufferStatus(36160)))return I_e.bindFramebuffer(36160,null),null;var I_f=new Uint8Array(this._width*this._height*4);return I_e.readPixels(I_a,I_b,I_c,I_d,this._surfaceFormat,this._surfaceType,I_f),I_e.bindFramebuffer(36160,null),I_f},I_b.disposeResource=function(){if(this._frameBuffer){var I_a=I_F.mainContext;I_a.deleteTexture(this._source),I_a.deleteFramebuffer(this._frameBuffer),I_a.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},I_o(0,I_b,"surfaceFormat",function(){return this._surfaceFormat}),I_o(0,I_b,"surfaceType",function(){return this._surfaceType}),I_o(0,I_b,"depthStencilFormat",function(){return this._depthStencilFormat}),I_o(0,I_b,"source",function(){return this._alreadyResolved?I_x.superGet(I_Fb,this,"source"):null}),I_o(0,I_b,"depthStencilBuffer",function(){return this._depthStencilBuffer}),I_o(0,I_b,"frameBuffer",function(){return this._frameBuffer}),I_j._currentRenderTarget=null}(),function(I_a){function I_b(I_a){this._color=null,this._pixels=null,I_b.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new I_pb(this.width,this.height),this._color=I_a,this._pixels=new Uint8Array([255*I_a.x,255*I_a.y,255*I_a.z,255*I_a.w]),this.uri="SolidColorTexture2D_"+this.id}I_n(I_b,"laya.d3.resource.SolidColorTexture2D",I_Fb);var I_c=I_b.prototype;return I_c._createWebGlTexture=function(){var I_a=I_F.mainContext,I_b=this._source=I_a.createTexture(),I_c=this._width,I_d=this._height,I_e=I_G.curBindTexTarget,I_f=I_G.curBindTexValue;I_G.bindTexture(I_a,this._type,I_b),I_a.texImage2D(this._type,0,6408,I_c,I_d,0,6408,5121,this._pixels);var I_g=this._minFifter,I_h=this._magFifter,I_i=this._repeat?10497:33071,I_j=I_w.isPOT(I_c,I_d);I_j?(this._mipmap?-1!==I_g||(I_g=9987):-1!==I_g||(I_g=9729),-1!==I_h||(I_h=9729),I_a.texParameteri(this._type,10241,I_g),I_a.texParameteri(this._type,10240,I_h),I_a.texParameteri(this._type,10242,I_i),I_a.texParameteri(this._type,10243,I_i),this._mipmap&&I_a.generateMipmap(this._type)):(-1!==I_g||(I_g=9729),-1!==I_h||(I_h=9729),I_a.texParameteri(this._type,10241,I_g),I_a.texParameteri(this._type,10240,I_h),I_a.texParameteri(this._type,10242,33071),I_a.texParameteri(this._type,10243,33071)),I_e&&I_f&&I_G.bindTexture(I_a,I_e,I_f),this.memorySize=I_j?I_c*I_d*4*(1+1/3):I_c*I_d*4},I_c.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},I_c.disposeResource=function(){this._source&&(I_F.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},I_l(I_b,["magentaTexture",function(){var I_a=new I_b(new I_hb(1,0,1,1));return I_a.lock=!0,this.magentaTexture=I_a},"grayTexture",function(){var I_a=new I_b(new I_hb(.5,.5,.5,1));return I_a.lock=!0,this.grayTexture=I_a}]),I_b}()),I_Tb=function(I_a){function I_e(I_a,I_b,I_c,I_d){this._canRead=!1,this._image=null,this._pixels=null,void 0===I_a&&(I_a=!1),void 0===I_b&&(I_b=!0),void 0===I_c&&(I_c=6408),void 0===I_d&&(I_d=!0),I_e.__super.call(this),this._type=3553,this._repeat=I_b,this._canRead=I_a,this._format=I_c,this._mipmap=I_d}I_n(I_e,"laya.d3.resource.Texture2D",I_Fb);var I_b=I_e.prototype;return I_b._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var I_a=I_F.mainContext,I_b=this._source=I_a.createTexture(),I_c=this._width,I_d=this._height,I_e=I_G.curBindTexTarget,I_f=I_G.curBindTexValue;switch(I_G.bindTexture(I_a,this._type,I_b),this._format){case 6407:case 6408:this._canRead?I_a.texImage2D(this._type,0,this._format,I_c,I_d,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?I_a.texImage2D(this._type,0,this._image._format,I_c,I_d,0,this._image._format,5121,this._image.atlasSource):I_a.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case I_F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:I_a.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var I_g=this._minFifter,I_h=this._magFifter,I_i=this._repeat?10497:33071,I_j=0==this._wrapModeU?10497:33071,I_k=0==this._wrapModeV?10497:33071,I_l=I_w.isPOT(I_c,I_d);I_l?(this._mipmap?-1!==I_g||(I_g=9987):-1!==I_g||(I_g=9729),-1!==I_h||(I_h=9729),I_a.texParameteri(this._type,10241,I_g),I_a.texParameteri(this._type,10240,I_h),I_a.texParameteri(this._type,10242,I_i),I_a.texParameteri(this._type,10243,I_i),I_a.texParameteri(this._type,10242,I_j),I_a.texParameteri(this._type,10243,I_k),this._mipmap&&I_a.generateMipmap(this._type)):(-1!==I_g||(I_g=9729),-1!==I_h||(I_h=9729),I_a.texParameteri(this._type,10241,I_g),I_a.texParameteri(this._type,10240,I_h),I_a.texParameteri(this._type,10242,33071),I_a.texParameteri(this._type,10243,33071)),I_e&&I_f&&I_G.bindTexture(I_a,I_e,I_f),this._image.onload=null,this._image=null,this.memorySize=I_l?I_c*I_d*4*(1+1/3):I_c*I_d*4},I_b.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},I_b.onAsynLoaded=function(I_a,I_b,I_c){if(I_c){var I_d=I_c[0];void 0!==I_d&&(this._canRead=I_d);var I_e=I_c[1];void 0!==I_e&&(this._repeat=I_e);var I_f=I_c[2];void 0!==I_f&&(this._format=I_f);var I_g=I_c[3];void 0!==I_g&&(this._mipmap=I_g);var I_h=I_c.wrapModeU;void 0!==I_h&&(this._wrapModeU=I_h);var I_i=I_c.wrapModeV;void 0!==I_i&&(this._wrapModeV=I_i)}switch(this._format){case 6407:case 6408:var I_j=(this._image=I_b).width,I_k=I_b.height;this._width=I_j,this._height=I_k,this._size=new I_pb(I_j,I_k),this._canRead&&(I_p.isConchApp?I_b instanceof I_m.HTMLElement&&(this._pixels=new Uint8Array(I_b.getImageData(0,0,I_j,I_k))):(I_H.canvas.size(I_j,I_k),I_H.canvas.clear(),I_H.context.drawImage(I_b,0,0,I_j,I_k),this._pixels=new Uint8Array(I_H.context.getImageData(0,0,I_j,I_k).data.buffer)));break;case I_F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var I_l=new I_y(I_b);I_l.readUTFBytes(4),I_l.readUTFBytes(2),I_l.getInt16();I_l.endian="bigEndian",this._width=I_l.getInt16(),this._height=I_l.getInt16(),this._size=new I_pb(this._width,this._height);I_l.getInt16(),I_l.getInt16();this._image=new Uint8Array(I_b,I_l.pos)}this.recreateResource(),this._endLoaded()},I_b.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},I_b.disposeResource=function(){this._source&&(I_F.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},I_o(0,I_b,"_src",function(){return this.url}),I_o(0,I_b,"src",function(){return this.url}),I_e.load=function(I_a){return I_x.loader.create(I_a,null,null,I_e)},I_e}(),I_Ub=function(I_b){function I_c(I_a,I_b){I_c.__super.call(this),void 0===I_a&&(I_a=.3),void 0===I_b&&(I_b=1e3),this._tempVector3=new I_gb,this._position=new I_gb,this._up=new I_gb,this._forward=new I_gb,this._right=new I_gb,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=I_pb.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=I_a,this._farPlane=I_b,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),I_x.stage.on("resize",this,this._onScreenSizeChanged)}I_n(I_c,"laya.d3.core.BaseCamera",I_b);var I_a=I_c.prototype;return I_a._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var I_a=this.scene._cameraPool,I_b=I_a.length-1,I_c=0;I_c<I_b;I_c++)if(I_a[I_c].renderingOrder>I_a[I_b].renderingOrder){var I_d=I_a[I_c];I_a[I_c]=I_a[I_b],I_a[I_b]=I_d}},I_a._calculateProjectionMatrix=function(){},I_a._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},I_a._prepareCameraToRender=function(){I_I._currentCameraCullingMask=this.cullingMask;var I_a=this._shaderValues;I_a.setValue(0,this.transform.position.elements),I_a.setValue(5,this.forward.elements),I_a.setValue(6,this.up.elements)},I_a._prepareCameraViewProject=function(I_a,I_b){var I_c=this._shaderValues;I_c.setValue(1,I_a.elements),I_c.setValue(2,I_b.elements)},I_a._renderCamera=function(I_a,I_b,I_c){},I_a.addLayer=function(I_a){29!==I_a.number&&30!=I_a.number&&(this.cullingMask=this.cullingMask|I_a.mask)},I_a.removeLayer=function(I_a){29!==I_a.number&&30!=I_a.number&&(this.cullingMask=this.cullingMask&~I_a.mask)},I_a.addAllLayers=function(){this.cullingMask=2147483647},I_a.removeAllLayers=function(){this.cullingMask=0|I_I.getLayerByNumber(29).mask|I_I.getLayerByNumber(30).mask},I_a.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},I_a.moveForward=function(I_a){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=I_a,this.transform.translate(this._tempVector3)},I_a.moveRight=function(I_a){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=I_a,this.transform.translate(this._tempVector3)},I_a.moveVertical=function(I_a){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=I_a,this.transform.translate(this._tempVector3,!1)},I_a._addSelfRenderObjects=function(){var I_a=this.scene._cameraPool,I_b=I_a.length;if(0<I_b){for(var I_c=I_b-1;0<=I_c;I_c--)if(this.renderingOrder<=I_a[I_c].renderingOrder){I_a.splice(I_c+1,0,this);break}}else I_a.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},I_a._clearSelfRenderObjects=function(){var I_a=this.scene._cameraPool;I_a.splice(I_a.indexOf(this),1)},I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,I_x.stage.off("resize",this,this._onScreenSizeChanged),I_b.prototype.destroy.call(this,I_a)},I_o(0,I_a,"sky",function(){return this._sky},function(I_a){(this._sky=I_a)._ownerCamera=this}),I_o(0,I_a,"forward",function(){var I_a=this.transform.worldMatrix.elements,I_b=this._forward.elements;return I_b[0]=-I_a[8],I_b[1]=-I_a[9],I_b[2]=-I_a[10],this._forward}),I_o(0,I_a,"position",function(){var I_a=this.transform.worldMatrix.elements,I_b=this._position.elements;return I_b[0]=I_a[12],I_b[1]=I_a[13],I_b[2]=I_a[14],this._position}),I_o(0,I_a,"renderTarget",function(){return this._renderTarget},function(I_a){null!=(this._renderTarget=I_a)&&(this._renderTargetSize=I_a.size)}),I_o(0,I_a,"up",function(){var I_a=this.transform.worldMatrix.elements,I_b=this._up.elements;return I_b[0]=I_a[4],I_b[1]=I_a[5],I_b[2]=I_a[6],this._up}),I_o(0,I_a,"right",function(){var I_a=this.transform.worldMatrix.elements,I_b=this._right.elements;return I_b[0]=I_a[0],I_b[1]=I_a[1],I_b[2]=I_a[2],this._right}),I_o(0,I_a,"renderTargetSize",function(){return this._renderTargetSize},function(I_a){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=I_a,this._calculateProjectionMatrix()}),I_o(0,I_a,"fieldOfView",function(){return this._fieldOfView},function(I_a){this._fieldOfView=I_a,this._calculateProjectionMatrix()}),I_o(0,I_a,"nearPlane",function(){return this._nearPlane},function(I_a){this._nearPlane=I_a,this._calculateProjectionMatrix()}),I_o(0,I_a,"farPlane",function(){return this._farPlane},function(I_a){this._farPlane=I_a,this._calculateProjectionMatrix()}),I_o(0,I_a,"orthographic",function(){return this._orthographic},function(I_a){this._orthographic=I_a,this._calculateProjectionMatrix()}),I_o(0,I_a,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(I_a){this._orthographicVerticalSize=I_a,this._calculateProjectionMatrix()}),I_o(0,I_a,"renderingOrder",function(){return this._renderingOrder},function(I_a){this._renderingOrder=I_a,this._sortCamerasByRenderingOrder()}),I_c.CAMERAPOS=0,I_c.VIEWMATRIX=1,I_c.PROJECTMATRIX=2,I_c.VPMATRIX=3,I_c.VPMATRIX_NO_TRANSLATE=4,I_c.CAMERADIRECTION=5,I_c.CAMERAUP=6,I_c.ENVIRONMENTDIFFUSE=7,I_c.ENVIRONMENTSPECULAR=8,I_c.SIMLODINFO=9,I_c.DIFFUSEIRRADMATR=10,I_c.DIFFUSEIRRADMATG=11,I_c.DIFFUSEIRRADMATB=12,I_c.HDREXPOSURE=13,I_c.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",I_c.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",I_c.CLEARFLAG_SOLIDCOLOR=0,I_c.CLEARFLAG_SKY=1,I_c.CLEARFLAG_DEPTHONLY=2,I_c.CLEARFLAG_NONE=3,I_l(I_c,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new I_ab(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new I_ab},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new I_ab}]),I_c}(I_Kb),I_Vb=function(I_c){function I_b(I_a){this._render=null,this._geometryFilter=null,I_b.__super.call(this,I_a)}I_n(I_b,"laya.d3.core.RenderableSprite3D",I_c);var I_a=I_b.prototype;return I_a._addToInitStaticBatchManager=function(){},I_a._setBelongScene=function(I_a){I_c.prototype._setBelongScene.call(this,I_a),I_a._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},I_a._setUnBelongScene=function(){var I_a=this._scene._renderableSprite3Ds,I_b=I_a.indexOf(this);I_a.splice(I_b,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),I_c.prototype._setUnBelongScene.call(this)},I_a._update=function(I_a){(I_a.owner=this)._activeInHierarchy&&(this._updateComponents(I_a),this._render._updateOctreeNode(),this._lateUpdateComponents(I_a),I_A.spriteCount++,this._childs.length&&this._updateChilds(I_a))},I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),I_c.prototype.destroy.call(this,I_a),this._render._destroy(),this._render=null},I_b.__init__=function(){I_b.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=I_b.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),I_b.SAHDERDEFINE_LIGHTMAP=I_b.shaderDefines.registerDefine("LIGHTMAP")},I_b.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,I_b.SAHDERDEFINE_LIGHTMAP=4,I_b.LIGHTMAPSCALEOFFSET=2,I_b.LIGHTMAP=3,I_l(I_b,["shaderDefines",function(){return this.shaderDefines=new I_kb}]),I_b}(I_Kb),I_Wb=(function(I_a){function I_d(I_a,I_b,I_c){this._long=NaN,this._width=NaN,this._height=NaN,void 0===I_a&&(I_a=1),void 0===I_b&&(I_b=1),void 0===I_c&&(I_c=1),I_d.__super.call(this),this._long=I_a,this._width=I_b,this._height=I_c,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}I_n(I_d,"laya.d3.resource.models.BoxMesh",I_Qb);var I_b=I_d.prototype;I_b.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var I_a=I_Fa.vertexDeclaration,I_b=(I_a.vertexStride,this._long/2),I_c=this._height/2,I_d=this._width/2,I_e=new Float32Array([-I_b,I_c,-I_d,0,1,0,0,0,I_b,I_c,-I_d,0,1,0,1,0,I_b,I_c,I_d,0,1,0,1,1,-I_b,I_c,I_d,0,1,0,0,1,-I_b,-I_c,-I_d,0,-1,0,0,1,I_b,-I_c,-I_d,0,-1,0,1,1,I_b,-I_c,I_d,0,-1,0,1,0,-I_b,-I_c,I_d,0,-1,0,0,0,-I_b,I_c,-I_d,-1,0,0,0,0,-I_b,I_c,I_d,-1,0,0,1,0,-I_b,-I_c,I_d,-1,0,0,1,1,-I_b,-I_c,-I_d,-1,0,0,0,1,I_b,I_c,-I_d,1,0,0,1,0,I_b,I_c,I_d,1,0,0,0,0,I_b,-I_c,I_d,1,0,0,0,1,I_b,-I_c,-I_d,1,0,0,1,1,-I_b,I_c,I_d,0,0,1,0,0,I_b,I_c,I_d,0,0,1,1,0,I_b,-I_c,I_d,0,0,1,1,1,-I_b,-I_c,I_d,0,0,1,0,1,-I_b,I_c,-I_d,0,0,-1,1,0,I_b,I_c,-I_d,0,0,-1,0,0,I_b,-I_c,-I_d,0,0,-1,0,1,-I_b,-I_c,-I_d,0,0,-1,1,1]),I_f=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new I_Ob(I_a,this._numberVertices,35044,!0),this._indexBuffer=new I_Nb("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(I_e),this._indexBuffer.setData(I_f),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},I_o(0,I_b,"long",function(){return this._long},function(I_a){this._long!==I_a&&(this._long=I_a,this.releaseResource(),this.activeResource())}),I_o(0,I_b,"width",function(){return this._width},function(I_a){this._width!==I_a&&(this._width=I_a,this.releaseResource(),this.activeResource())}),I_o(0,I_b,"height",function(){return this._height},function(I_a){this._height!==I_a&&(this._height=I_a,this.releaseResource(),this.activeResource())})}(),function(I_a){function I_g(I_a,I_b,I_c){void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=.3),void 0===I_c&&(I_c=1e3),this._viewMatrix=new I_ab,this._projectionMatrix=new I_ab,this._projectionViewMatrix=new I_ab,this._viewport=new I_ib(0,0,0,0),this._normalizedViewport=new I_ib(0,0,1,1),this._aspectRatio=I_a,this._boundFrustumUpdate=!0,this._boundFrustum=new I_$a(I_ab.DEFAULT),I_g.__super.call(this,I_b,I_c),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}I_n(I_g,"laya.d3.core.Camera",I_Ub);var I_b=I_g.prototype;return I_b._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},I_b._parseCustomProps=function(I_a,I_b,I_c,I_d){var I_e=I_c.clearColor;this.clearColor=new I_hb(I_e[0],I_e[1],I_e[2],I_e[3]);var I_f=I_c.viewport;this.normalizedViewport=new I_ib(I_f[0],I_f[1],I_f[2],I_f[3])},I_b._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var I_a=this.orthographicVerticalSize*this.aspectRatio*.5,I_b=.5*this.orthographicVerticalSize;I_ab.createOrthoOffCenterRH(-I_a,I_a,-I_b,I_b,this.nearPlane,this.farPlane,this._projectionMatrix)}else I_ab.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},I_b._update=function(I_a){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,I_a)},I_b._renderCamera=function(I_a,I_b,I_c){var I_d,I_e;I_c.parallelSplitShadowMaps[0]&&I_c._renderShadowMap(I_a,I_b,this),(I_b.camera=this)._prepareCameraToRender(),I_c._preRenderUpdateComponents(I_b),I_d=I_b._viewMatrix=this.viewMatrix;var I_f=this._renderTarget;I_f?(I_f.start(),I_ab.multiply(I_Ub._invertYScaleMatrix,this._projectionMatrix,I_Ub._invertYProjectionMatrix),I_ab.multiply(I_Ub._invertYScaleMatrix,this.projectionViewMatrix,I_Ub._invertYProjectionViewMatrix),I_e=I_b._projectionMatrix=I_Ub._invertYProjectionMatrix,I_b._projectionViewMatrix=I_Ub._invertYProjectionViewMatrix):(I_e=I_b._projectionMatrix=this._projectionMatrix,I_b._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(I_d,I_e),I_b._viewport=this.viewport,I_c._preRenderScene(I_a,I_b,this.boundFrustum),I_c._clear(I_a,I_b),I_c._renderScene(I_a,I_b),I_c._postRenderUpdateComponents(I_b),I_f&&I_f.end()},I_b.viewportPointToRay=function(I_a,I_b){I_ob.calculateCursorRay(I_a,this.viewport,this._projectionMatrix,this.viewMatrix,null,I_b)},I_b.normalizedViewportPointToRay=function(I_a,I_b){var I_c=I_g._tempVector20,I_d=this.viewport,I_e=I_a.elements,I_f=I_c.elements;I_f[0]=I_e[0]*I_d.width,I_f[1]=I_e[1]*I_d.height,I_ob.calculateCursorRay(I_c,this.viewport,this._projectionMatrix,this.viewMatrix,null,I_b)},I_b.worldToViewportPoint=function(I_a,I_b){I_ab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(I_a,this._projectionViewMatrix,I_b);var I_c=I_b.elements;I_c[0]=I_c[0]/I_x.stage.clientScaleX,I_c[1]=I_c[1]/I_x.stage.clientScaleY},I_b.worldToNormalizedViewportPoint=function(I_a,I_b){I_ab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(I_a,this._projectionViewMatrix,I_b);var I_c=I_b.elements;I_c[0]=I_c[0]/I_x.stage.clientScaleX,I_c[1]=I_c[1]/I_x.stage.clientScaleY},I_b.convertScreenCoordToOrthographicCoord=function(I_a,I_b){if(this._orthographic){var I_c=I_Y.clientWidth,I_d=I_Y.clientHeight,I_e=this.orthographicVerticalSize*this.aspectRatio/I_c,I_f=this.orthographicVerticalSize/I_d,I_g=I_a.elements,I_h=I_b.elements;return I_h[0]=(-I_c/2+I_g[0])*I_e,I_h[1]=(I_d/2-I_g[1])*I_f,I_h[2]=(this.nearPlane-this.farPlane)*(I_g[2]+1)/2-this.nearPlane,I_gb.transformCoordinate(I_b,this.transform.worldMatrix,I_b),!0}return!1},I_o(0,I_b,"projectionViewMatrix",function(){return I_ab.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),I_o(0,I_b,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var I_a=this.viewport;return I_a.width/I_a.height},function(I_a){if(I_a<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=I_a,this._calculateProjectionMatrix()}),I_o(0,I_b,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),I_o(0,I_b,"needViewport",function(){var I_a=this.normalizedViewport;return 0===I_a.x&&0===I_a.y&&1===I_a.width&&1===I_a.height}),I_o(0,I_b,"viewport",function(){if(this._viewportExpressedInClipSpace){var I_a=this._normalizedViewport,I_b=this.renderTargetSize,I_c=I_b.width,I_d=I_b.height;this._viewport.x=I_a.x*I_c,this._viewport.y=I_a.y*I_d,this._viewport.width=I_a.width*I_c,this._viewport.height=I_a.height*I_d}return this._viewport},function(I_a){if(null!=this.renderTarget&&(I_a.x<0||I_a.y<0||0==I_a.width||0==I_a.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=I_a,this._calculateProjectionMatrix()}),I_o(0,I_b,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var I_a=this._viewport,I_b=this.renderTargetSize,I_c=I_b.width,I_d=I_b.height;this._normalizedViewport.x=I_a.x/I_c,this._normalizedViewport.y=I_a.y/I_d,this._normalizedViewport.width=I_a.width/I_c,this._normalizedViewport.height=I_a.height/I_d}return this._normalizedViewport},function(I_a){I_a.x<0&&(I_a.x=0,console.warn("Camera: viewport.x must large than 0.0.")),I_a.y<0&&(I_a.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<I_a.x+I_a.width&&(I_a.width=1-I_a.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<I_a.y+I_a.height&&(I_a.height=1-I_a.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=I_a,this._calculateProjectionMatrix()}),I_o(0,I_b,"projectionMatrix",function(){return this._projectionMatrix},function(I_a){this._projectionMatrix=I_a,this._useUserProjectionMatrix=!0}),I_o(0,I_b,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),I_l(I_g,["_tempVector20",function(){return this._tempVector20=new I_fb}]),I_g}()),I_Xb=function(I_c){function I_d(I_a,I_b){I_d.__super.call(this,I_b),this._geometryFilter=new I_Hb(this),this._render=new I_Ib(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),I_a&&(this._geometryFilter.sharedMesh=I_a)instanceof laya.d3.resource.models.Mesh&&(I_a.loaded?this._render.sharedMaterials=I_a.materials:I_a.once("loaded",this,this._applyMeshMaterials))}I_n(I_d,"laya.d3.core.MeshSprite3D",I_c);var I_a=I_d.prototype;return I_a._changeRenderObjectByMesh=function(I_a){var I_b=this._render._renderElements,I_c=I_b[I_a];I_c||(I_c=I_b[I_a]=new I_zb),I_c._render=this._render;var I_d=this._render.sharedMaterials[I_a];I_d||(I_d=I_Mb.defaultMaterial);var I_e=this._geometryFilter.sharedMesh.getRenderElement(I_a);return I_c._mainSortID=this._getSortID(I_e,I_d),I_c._sprite3D=this,I_c.renderObj=I_e,I_c._material=I_d,I_c},I_a._changeRenderObjectByMaterial=function(I_a,I_b){var I_c=this._render._renderElements[I_a];I_b||(I_b=I_Mb.defaultMaterial);var I_d=this._geometryFilter.sharedMesh.getRenderElement(I_a);return I_c._mainSortID=this._getSortID(I_d,I_b),I_c._sprite3D=this,I_c.renderObj=I_d,I_c._material=I_b,I_c},I_a._changeRenderObjectsByMesh=function(){var I_a=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=I_a;for(var I_b=0;I_b<I_a;I_b++)this._changeRenderObjectByMesh(I_b)},I_a._onMeshChanged=function(I_a){var I_b=I_a.sharedMesh;I_b.loaded?this._changeRenderObjectsByMesh():I_b.once("loaded",this,this._onMeshLoaded)},I_a._onMeshLoaded=function(I_a){I_a===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},I_a._onMaterialChanged=function(I_a,I_b,I_c){I_b<this._render._renderElements.length&&this._changeRenderObjectByMaterial(I_b,I_c)},I_a._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},I_a._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},I_a._parseCustomProps=function(I_a,I_b,I_c,I_d){var I_e=this.meshRender,I_f=I_c.lightmapIndex;null!=I_f&&(I_e.lightmapIndex=I_f);var I_g,I_h,I_i=I_c.lightmapScaleOffset;if(I_i&&(I_e.lightmapScaleOffset=new I_hb(I_i[0],I_i[1],I_i[2],I_i[3])),I_d.instanceParams)(I_g=I_d.instanceParams.loadPath)&&(I_h=I_t.getRes(I_b[I_g]),(this.meshFilter.sharedMesh=I_h).loaded?I_e.sharedMaterials=I_h.materials:I_h.once("loaded",this,this._applyMeshMaterials));else{(I_g=I_c.meshPath)&&(I_h=I_t.getRes(I_b[I_g]),this.meshFilter.sharedMesh=I_h);var I_j=I_c.materials;if(I_j){var I_k=I_e.sharedMaterials,I_l=I_j.length;I_k.length=I_l;for(var I_m=0;I_m<I_l;I_m++)I_k[I_m]=I_t.getRes(I_b[I_j[I_m].path]);I_e.sharedMaterials=I_k}}},I_a._applyMeshMaterials=function(I_a){for(var I_b=this._render.sharedMaterials,I_c=I_a.materials,I_d=0,I_e=I_c.length;I_d<I_e;I_d++)I_b[I_d]||(I_b[I_d]=I_c[I_d]);this._render.sharedMaterials=I_b},I_a._addToInitStaticBatchManager=function(){I_d._staticBatchManager._addInitBatchSprite(this)},I_a.cloneTo=function(I_a){var I_b=I_a;I_b._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var I_c=this._render,I_d=I_b._render;I_d.enable=I_c.enable,I_d.sharedMaterials=I_c.sharedMaterials,I_d.castShadow=I_c.castShadow;var I_e=I_c.lightmapScaleOffset;I_e&&(I_d.lightmapScaleOffset=I_e.clone()),I_d.lightmapIndex=I_c.lightmapIndex,I_d.receiveShadow=I_c.receiveShadow,I_d.sortingFudge=I_c.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,I_a)},I_a.destroy=function(I_a){if(void 0===I_a&&(I_a=!0),!this.destroyed){var I_b=this.meshFilter.sharedMesh;null!=I_b&&(I_b.loaded||I_b.off("loaded",this,this._applyMeshMaterials)),I_c.prototype.destroy.call(this,I_a),this._geometryFilter._destroy()}},I_o(0,I_a,"meshFilter",function(){return this._geometryFilter}),I_o(0,I_a,"meshRender",function(){return this._render}),I_d.__init__=function(){I_da._staticBatchManagers.push(I_d._staticBatchManager)},I_d.load=function(I_a){return I_x.loader.create(I_a,null,null,I_d)},I_l(I_d,["_staticBatchManager",function(){return this._staticBatchManager=new I_Bb}]),I_d}(I_Vb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(I_a,I_b){"use strict";for(var I_c in Object.defineProperty(I_b,"__esModule",{value:!0}),Laya){var I_d=Laya[I_c];I_d&&I_d.__isclass&&(I_b[I_c]=I_d)}}),function(I_a,I_b,I_ea){I_ea.un,I_ea.uns;var I_c=I_ea.static,I_d=I_ea.class,I_f=I_ea.getset,I_p=I_ea.__newvec,I_h=laya.maths.Bezier,I_l=laya.utils.Browser,I_Fa=laya.utils.Byte,I_e=(laya.events.Event,laya.events.EventDispatcher),I_g=laya.display.Graphics,I_i=(laya.resource.HTMLCanvas,laya.utils.Handler),I_j=laya.net.Loader,I_m=laya.maths.MathUtil,I_Ga=laya.maths.Matrix,I_s=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),I_k=(laya.renders.RenderContext,laya.resource.Resource),I_n=laya.utils.RunDriver,I_fa=laya.display.Sprite,I_o=laya.utils.Stat,I_Ha=laya.resource.Texture,I_t=(laya.net.URL,laya.utils.Utils),I_G=function(){function I_a(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return I_d(I_a,"laya.ani.AnimationContent"),I_a}(),I_H=function(){function I_a(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return I_d(I_a,"laya.ani.AnimationNodeContent"),I_a}(),I_v=function(){function I_a(){}return I_d(I_a,"laya.ani.AnimationParser01"),I_a.parse=function(I_a,I_b){var I_c=I_b.__getBuffer(),I_d=0,I_e=0,I_f=0,I_g=0,I_h=0,I_i=0,I_j=0,I_k=I_b.readUTFString();I_a._aniClassName=I_k;var I_l,I_m=I_b.readUTFString().split("\n"),I_n=I_b.getUint8(),I_o=I_b.getUint32(),I_p=I_b.getUint32();0<I_o&&(I_l=I_c.slice(I_o,I_p));var I_s=new I_Fa(I_l);for(0<I_p&&(I_a._publicExtData=I_c.slice(I_p,I_c.byteLength)),I_a._useParent=!!I_b.getUint8(),I_a._anis.length=I_n,I_d=0;I_d<I_n;I_d++){var I_t=I_a._anis[I_d]=new I_G;I_t.nodes=new Array;var I_u=I_t.name=I_m[I_b.getUint16()];I_a._aniMap[I_u]=I_d,I_t.bone3DMap={},I_t.playTime=I_b.getFloat32(),I_t.playTime<=0&&console.error("播放时间不能为0  url="+I_a.url+" name="+I_t.name);var I_v=I_t.nodes.length=I_b.getUint8();for(I_e=I_t.totalKeyframeDatasLength=0;I_e<I_v;I_e++){var I_w=I_t.nodes[I_e]=new I_H;I_w.childs=[];var I_x=I_b.getInt16();0<=I_x&&(I_w.name=I_m[I_x],I_t.bone3DMap[I_w.name]=I_e),I_w.keyFrame=new Array,I_w.parentIndex=I_b.getInt16(),-1==I_w.parentIndex?I_w.parent=null:I_w.parent=I_t.nodes[I_w.parentIndex],I_w.lerpType=I_b.getUint8();var I_y=I_b.getUint32();I_s.pos=I_y;var I_z=I_w.keyframeWidth=I_s.getUint16();if(I_t.totalKeyframeDatasLength+=I_z,0===I_w.lerpType||1===I_w.lerpType)for(I_w.interpolationMethod=[],I_w.interpolationMethod.length=I_z,I_f=0;I_f<I_z;I_f++)I_w.interpolationMethod[I_f]=I_K.interpolation[I_s.getUint8()];null!=I_w.parent&&I_w.parent.childs.push(I_w);var I_A=I_b.getUint16();0<I_A&&(I_w.extenData=I_c.slice(I_b.pos,I_b.pos+I_A),I_b.pos+=I_A);var I_B,I_C=I_b.getUint16(),I_D=0;for(I_f=0,I_g=I_w.keyFrame.length=I_C;I_f<I_g;I_f++){if((I_B=I_w.keyFrame[I_f]=new I_I).duration=I_b.getFloat32(),I_B.startTime=I_D,2===I_w.lerpType){I_B.interpolationData=[];var I_E,I_F=I_b.getUint8();switch(I_E=I_b.getFloat32()){case 254:for(I_B.interpolationData.length=I_z,I_j=0;I_j<I_z;I_j++)I_B.interpolationData[I_j]=0;break;case 255:for(I_B.interpolationData.length=I_z,I_j=0;I_j<I_z;I_j++)I_B.interpolationData[I_j]=5;break;default:for(I_B.interpolationData.push(I_E),I_i=1;I_i<I_F;I_i++)I_B.interpolationData.push(I_b.getFloat32())}}for(I_B.data=new Float32Array(I_z),I_h=0;I_h<I_z;I_h++)I_B.data[I_h]=I_b.getFloat32(),-1e-8<I_B.data[I_h]&&I_B.data[I_h]<1e-8&&(I_B.data[I_h]=0);I_D+=I_B.duration}I_B.startTime=I_t.playTime,I_w.playTime=I_t.playTime,I_a._calculateKeyFrame(I_w,I_C,I_z)}}},I_a}(),I_w=function(){function I_x(){}return I_d(I_x,"laya.ani.AnimationParser02"),I_x.READ_DATA=function(){I_x._DATA.offset=I_x._reader.getUint32(),I_x._DATA.size=I_x._reader.getUint32()},I_x.READ_BLOCK=function(){for(var I_a=I_x._BLOCK.count=I_x._reader.getUint16(),I_b=I_x._BLOCK.blockStarts=[],I_c=I_x._BLOCK.blockLengths=[],I_d=0;I_d<I_a;I_d++)I_b.push(I_x._reader.getUint32()),I_c.push(I_x._reader.getUint32())},I_x.READ_STRINGS=function(){var I_a=I_x._reader.getUint32(),I_b=I_x._reader.getUint16(),I_c=I_x._reader.pos;I_x._reader.pos=I_a+I_x._DATA.offset;for(var I_d=0;I_d<I_b;I_d++)I_x._strings[I_d]=I_x._reader.readUTFString();I_x._reader.pos=I_c},I_x.parse=function(I_a,I_b){I_x._templet=I_a;(I_x._reader=I_b).__getBuffer();I_x.READ_DATA(),I_x.READ_BLOCK(),I_x.READ_STRINGS();for(var I_c=0,I_d=I_x._BLOCK.count;I_c<I_d;I_c++){var I_e=I_b.getUint16(),I_f=I_x._strings[I_e],I_g=I_x["READ_"+I_f];if(null==I_g)throw new Error("model file err,no this function:"+I_e+" "+I_f);I_g.call()}},I_x.READ_ANIMATIONS=function(){var I_a=I_x._reader,I_b=I_a.__getBuffer(),I_c=0,I_d=0,I_e=0,I_f=0,I_g=I_a.getUint16(),I_h=[];for(I_h.length=I_g,I_c=0;I_c<I_g;I_c++)I_h[I_c]=I_K.interpolation[I_a.getByte()];var I_i=I_a.getUint8();for(I_x._templet._anis.length=I_i,I_c=0;I_c<I_i;I_c++){var I_j=I_x._templet._anis[I_c]={};I_j.nodes=new Array;var I_k=I_j.name=I_x._strings[I_a.getUint16()];I_x._templet._aniMap[I_k]=I_c,I_j.bone3DMap={},I_j.playTime=I_a.getFloat32();var I_l=I_j.nodes.length=I_a.getInt16();for(I_d=I_j.totalKeyframeDatasLength=0;I_d<I_l;I_d++){var I_m=I_j.nodes[I_d]={};I_m.keyframeWidth=I_g,I_m.childs=[];var I_n=I_a.getUint16();0<=I_n&&(I_m.name=I_x._strings[I_n],I_j.bone3DMap[I_m.name]=I_d),I_m.keyFrame=new Array,I_m.parentIndex=I_a.getInt16(),-1==I_m.parentIndex?I_m.parent=null:I_m.parent=I_j.nodes[I_m.parentIndex],I_j.totalKeyframeDatasLength+=I_g,I_m.interpolationMethod=I_h,null!=I_m.parent&&I_m.parent.childs.push(I_m);var I_o=I_a.getUint16(),I_p=null,I_s=null;for(I_e=0,I_f=I_m.keyFrame.length=I_o;I_e<I_f;I_e++){(I_p=I_m.keyFrame[I_e]={}).startTime=I_a.getFloat32(),I_s&&(I_s.duration=I_p.startTime-I_s.startTime);var I_t=I_x._DATA.offset,I_u=I_a.getUint32(),I_v=4*I_g,I_w=I_b.slice(I_t+I_u,I_t+I_u+I_v);I_p.data=new Float32Array(I_w),I_s=I_p}I_p.duration=0,I_m.playTime=I_j.playTime,I_x._templet._calculateKeyFrame(I_m,I_o,I_g)}}},I_x._templet=null,I_x._reader=null,I_x._strings=[],I_c(I_x,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),I_x}(),I_Ia=(function(){function I_a(){}I_d(I_a,"laya.ani.AnimationState"),I_a.stopped=0,I_a.paused=1,I_a.playing=2}(),function(){function I_e(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new I_Va,this.resultMatrix=new I_Ga,this._children=[]}I_d(I_e,"laya.ani.bone.Bone");var I_a=I_e.prototype;return I_a.setTempMatrix=function(I_a){this._tempMatrix=I_a;var I_b,I_c=0;for(I_c=0,I_b=this._children.length;I_c<I_b;I_c++)this._children[I_c].setTempMatrix(this._tempMatrix)},I_a.update=function(I_a){var I_b;if(this.rotation=this.transform.skX,I_a)I_b=this.resultTransform.getMatrix(),I_Ga.mul(I_b,I_a,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)I_b=this.resultTransform.getMatrix(),I_Ga.mul(I_b,this.parentBone.resultMatrix,this.resultMatrix);else{var I_c=this.parentBone,I_d=NaN,I_e=NaN,I_f=NaN,I_g=this.parentBone.resultMatrix;I_b=this.resultTransform.getMatrix();var I_h=I_g.a*I_b.tx+I_g.c*I_b.ty+I_g.tx,I_i=I_g.b*I_b.tx+I_g.d*I_b.ty+I_g.ty,I_j=new I_Ga;this.inheritRotation?(I_d=Math.atan2(I_c.resultMatrix.b,I_c.resultMatrix.a),I_e=Math.cos(I_d),I_f=Math.sin(I_d),I_j.setTo(I_e,I_f,-I_f,I_e,0,0),I_Ga.mul(this._tempMatrix,I_j,I_Ga.TEMP),I_Ga.TEMP.copyTo(I_j),I_b=this.resultTransform.getMatrix(),I_Ga.mul(I_b,I_j,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,I_b=this.resultTransform.getMatrix(),I_Ga.TEMP.identity(),I_Ga.TEMP.d=this.d,I_Ga.mul(I_b,I_Ga.TEMP,this.resultMatrix)),this.resultMatrix.tx=I_h,this.resultMatrix.ty=I_i}else(I_b=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var I_k,I_l=0;for(I_l=0,I_k=this._children.length;I_l<I_k;I_l++)this._children[I_l].update()},I_a.updateChild=function(){var I_a,I_b=0;for(I_b=0,I_a=this._children.length;I_b<I_a;I_b++)this._children[I_b].update()},I_a.setRotation=function(I_a){this._sprite&&(this._sprite.rotation=180*I_a/Math.PI)},I_a.updateDraw=function(I_a,I_b){I_e.ShowBones&&!I_e.ShowBones[this.name]||(this._sprite||(this._sprite=new I_fa,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),I_ea.stage.addChild(this._sprite)),this._sprite.x=I_a+this.resultMatrix.tx,this._sprite.y=I_b+this.resultMatrix.ty);var I_c,I_d=0;for(I_d=0,I_c=this._children.length;I_d<I_c;I_d++)this._children[I_d].updateDraw(I_a,I_b)},I_a.addChild=function(I_a){this._children.push(I_a),I_a.parentBone=this},I_a.findBone=function(I_a){if(this.name==I_a)return this;var I_b,I_c,I_d=0;for(I_d=0,I_b=this._children.length;I_d<I_b;I_d++)if(I_c=this._children[I_d].findBone(I_a))return I_c;return null},I_a.localToWorld=function(I_a){var I_b=I_a[0],I_c=I_a[1];I_a[0]=I_b*this.resultMatrix.a+I_c*this.resultMatrix.c+this.resultMatrix.tx,I_a[1]=I_b*this.resultMatrix.b+I_c*this.resultMatrix.d+this.resultMatrix.ty},I_e.ShowBones={},I_e}()),I_Ja=function(){function I_p(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}I_d(I_p,"laya.ani.bone.BoneSlot");var I_a=I_p.prototype;return I_a.showSlotData=function(I_a,I_b){void 0===I_b&&(I_b=!0),this.currSlotData=I_a,I_b&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},I_a.showDisplayByName=function(I_a){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(I_a))},I_a.replaceDisplayByName=function(I_a,I_b){if(this.currSlotData){var I_c;I_c=this.currSlotData.getDisplayByName(I_a);var I_d;I_d=this.currSlotData.getDisplayByName(I_b),this.replaceDisplayByIndex(I_c,I_d)}},I_a.replaceDisplayByIndex=function(I_a,I_b){this.currSlotData&&(this._replaceDic[I_a]=I_b,this.displayIndex==I_a&&this.showDisplayByIndex(I_a))},I_a.showDisplayByIndex=function(I_a){if(null!=this._replaceDic[I_a]&&(I_a=this._replaceDic[I_a]),this.currSlotData&&-1<I_a&&I_a<this.currSlotData.displayArr.length){if(this.displayIndex=I_a,this.currDisplayData=this.currSlotData.displayArr[I_a],this.currDisplayData){var I_b=this.currDisplayData.name;this.currTexture=this.templet.getTexture(I_b),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!I_s.isConchApp||I_s.isConchApp&&"0.9.15"<I_fa.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},I_a.replaceSkin=function(I_a){this._diyTexture=I_a,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},I_a.setParentMatrix=function(I_a){this._parentMatrix=I_a},I_a.draw=function(I_a,I_b,I_c,I_d){if(void 0===I_c&&(I_c=!1),void 0===I_d&&(I_d=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var I_e,I_f=this.currTexture;switch(this._diyTexture&&(I_f=this._diyTexture),this.currDisplayData.type){case 0:if(I_a){var I_g=this.getDisplayMatrix();if(this._parentMatrix){var I_h=!1;if(I_g){var I_i;if(I_Ga.mul(I_g,this._parentMatrix,I_Ga.TEMP),I_i=I_c?(null==this._resultMatrix&&(this._resultMatrix=new I_Ga),this._resultMatrix):new I_Ga,!I_s.isWebGL&&this.currDisplayData.uvs||I_s.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var I_j=I_p._tempMatrix;I_j.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(I_j.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(I_h=!0,I_j.rotate(-Math.PI/2)),I_Ga.mul(I_j,I_Ga.TEMP,I_i)}else I_Ga.TEMP.copyTo(I_i);I_h?I_a.drawTexture(I_f,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,I_i):I_a.drawTexture(I_f,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,I_i)}}}break;case 1:if(null==(I_e=I_c?(null==this._skinSprite&&(this._skinSprite=I_p.createSkinMesh()),this._skinSprite):I_p.createSkinMesh()))return;var I_k;if(null==this.currDisplayData.bones){var I_l,I_m=this.currDisplayData.weights;this.deformData&&(I_m=this.deformData),I_l=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=I_z.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=I_z.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=I_m;this.currDisplayData.triangles.length;I_k=this.currDisplayData.triangles,I_e.init2(I_f,null,I_k,this._mVerticleArr,I_l);var I_n,I_o=this.getDisplayMatrix();if(this._parentMatrix)if(I_o)I_Ga.mul(I_o,this._parentMatrix,I_Ga.TEMP),I_n=I_c?(null==this._resultMatrix&&(this._resultMatrix=new I_Ga),this._resultMatrix):new I_Ga,I_Ga.TEMP.copyTo(I_n),I_e.transform=I_n}else this.skinMesh(I_b,I_e,I_d);I_a.drawSkin(I_e);break;case 2:if(null==(I_e=I_c?(null==this._skinSprite&&(this._skinSprite=I_p.createSkinMesh()),this._skinSprite):I_p.createSkinMesh()))return;this.skinMesh(I_b,I_e,I_d),I_a.drawSkin(I_e)}}},I_a.skinMesh=function(I_a,I_b,I_c){var I_d,I_e=this.currTexture,I_f=this.currDisplayData.bones;I_d=this._diyTexture?(I_e=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=I_z.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=I_z.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var I_g,I_h,I_i=this.currDisplayData.weights,I_j=this.currDisplayData.triangles,I_k=0,I_l=0,I_m=0,I_n=NaN,I_o=NaN,I_p=0,I_s=0,I_t=[],I_u=0,I_v=0;if(this.deformData&&0<this.deformData.length){var I_w=0;for(I_u=0,I_v=I_f.length;I_u<I_v;){for(I_m=I_f[I_u++]+I_u,I_l=I_k=0;I_u<I_m;I_u++)I_h=I_a[I_f[I_u]],I_n=I_i[I_p]+this.deformData[I_w++],I_o=I_i[I_p+1]+this.deformData[I_w++],I_s=I_i[I_p+2],I_k+=(I_n*I_h.a+I_o*I_h.c+I_h.tx)*I_s,I_l+=(I_n*I_h.b+I_o*I_h.d+I_h.ty)*I_s,I_p+=3;I_t.push(I_k,I_l)}}else for(I_u=0,I_v=I_f.length;I_u<I_v;){for(I_m=I_f[I_u++]+I_u,I_l=I_k=0;I_u<I_m;I_u++)I_h=I_a[I_f[I_u]],I_n=I_i[I_p],I_o=I_i[I_p+1],I_s=I_i[I_p+2],I_k+=(I_n*I_h.a+I_o*I_h.c+I_h.tx)*I_s,I_l+=(I_n*I_h.b+I_o*I_h.d+I_h.ty)*I_s,I_p+=3;I_t.push(I_k,I_l)}this._mVerticleArr=I_t,I_g=I_j,I_b.init2(I_e,null,I_g,this._mVerticleArr,I_d)},I_a.drawBonePoint=function(I_a){I_a&&this._parentMatrix&&I_a.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},I_a.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},I_a.getMatrix=function(){return this._resultMatrix},I_a.copy=function(){var I_a=new I_p;return I_a.type="copy",I_a.name=this.name,I_a.attachmentName=this.attachmentName,I_a.srcDisplayIndex=this.srcDisplayIndex,I_a.parent=this.parent,I_a.displayIndex=this.displayIndex,I_a.templet=this.templet,I_a.currSlotData=this.currSlotData,I_a.currTexture=this.currTexture,I_a.currDisplayData=this.currDisplayData,I_a},I_p.createSkinMesh=function(){return I_s.isWebGL||I_s.isConchApp?I_n.skinAniSprite():(I_s.isWebGL,null)},I_c(I_p,["_tempMatrix",function(){return this._tempMatrix=new I_Ga}]),I_p}(),I_Ka=function(){function I_a(){this.skinName=null,this.deformSlotDataList=[]}return I_d(I_a,"laya.ani.bone.DeformAniData"),I_a}(),I_La=function(){function I_a(){this.deformSlotDisplayList=[]}return I_d(I_a,"laya.ani.bone.DeformSlotData"),I_a}(),I_Ma=function(){function I_a(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}I_d(I_a,"laya.ani.bone.DeformSlotDisplayData");var I_b=I_a.prototype;return I_b.binarySearch1=function(I_a,I_b){var I_c=0,I_d=I_a.length-2;if(0==I_d)return 1;for(var I_e=I_d>>>1;;){if(I_a[Math.floor(I_e+1)]<=I_b?I_c=I_e+1:I_d=I_e,I_c==I_d)return I_c+1;I_e=I_c+I_d>>>1}return 0},I_b.apply=function(I_a,I_b,I_c){if(void 0===I_c&&(I_c=1),I_a+=.05,!(this.timeList.length<=0)){var I_d=0;if(!(I_a<this.timeList[0])){var I_e=this.vectices[0].length,I_f=[],I_g=this.binarySearch1(this.timeList,I_a);if(this.frameIndex=I_g,I_a>=this.timeList[this.timeList.length-1]){var I_h=this.vectices[this.vectices.length-1];if(I_c<1)for(I_d=0;I_d<I_e;I_d++)I_f[I_d]+=(I_h[I_d]-I_f[I_d])*I_c;else for(I_d=0;I_d<I_e;I_d++)I_f[I_d]=I_h[I_d];this.deformData=I_f}else{this.tweenKeyList[this.frameIndex];var I_i=this.vectices[this.frameIndex-1],I_j=this.vectices[this.frameIndex],I_k=this.timeList[this.frameIndex-1],I_l=this.timeList[this.frameIndex];I_c=this.tweenKeyList[I_g-1]?(I_a-I_k)/(I_l-I_k):0;var I_m=NaN;for(I_d=0;I_d<I_e;I_d++)I_m=I_i[I_d],I_f[I_d]=I_m+(I_j[I_d]-I_m)*I_c;this.deformData=I_f}}}},I_a}(),I_Na=function(){function I_a(){this.time=NaN,this.drawOrder=[]}return I_d(I_a,"laya.ani.bone.DrawOrderData"),I_a}(),I_Oa=function(){function I_a(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return I_d(I_a,"laya.ani.bone.EventData"),I_a}(),I_u=function(){function I_da(I_a,I_b){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=I_a,this._targetBone=I_b[I_a.targetBoneIndex],this.isSpine=I_a.isSpine,null==this._bones&&(this._bones=[]);for(var I_c=this._bones.length=0,I_d=I_a.boneIndexs.length;I_c<I_d;I_c++)this._bones.push(I_b[I_a.boneIndexs[I_c]]);this.name=I_a.name,this.mix=I_a.mix,this.bendDirection=I_a.bendDirection}I_d(I_da,"laya.ani.bone.IkConstraint");var I_a=I_da.prototype;return I_a.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},I_a._applyIk1=function(I_a,I_b,I_c,I_d){var I_e=I_a.parentBone,I_f=1/(I_e.resultMatrix.a*I_e.resultMatrix.d-I_e.resultMatrix.b*I_e.resultMatrix.c),I_g=I_b-I_e.resultMatrix.tx,I_h=I_c-I_e.resultMatrix.ty,I_i=(I_g*I_e.resultMatrix.d-I_h*I_e.resultMatrix.c)*I_f-I_a.transform.x,I_j=(I_h*I_e.resultMatrix.a-I_g*I_e.resultMatrix.b)*I_f-I_a.transform.y,I_k=Math.atan2(I_j,I_i)*I_da.radDeg-0-I_a.transform.skX;I_a.transform.scX<0&&(I_k+=180),180<I_k?I_k-=360:I_k<-180&&(I_k+=360),I_a.transform.skX=I_a.transform.skY=I_a.transform.skX+I_k*I_d,I_a.update()},I_a.updatePos=function(I_a,I_b){this._sp&&this._sp.pos(I_a,I_b)},I_a._applyIk2=function(I_a,I_b,I_c,I_d,I_e,I_f){if(0!=I_f){var I_g=I_a.resultTransform.x,I_h=I_a.resultTransform.y,I_i=I_a.transform.scX,I_j=I_a.transform.scY,I_k=I_b.transform.scX,I_l=0,I_m=0,I_n=0;I_n=I_i<0?(I_i=-I_i,I_l=180,-1):(I_l=0,1),I_j<0&&(I_j=-I_j,I_n=-I_n),I_m=I_k<0?(I_k=-I_k,180):0;var I_o=I_b.resultTransform.x,I_p=NaN,I_s=NaN,I_t=NaN,I_u=I_a.resultMatrix.a,I_v=I_a.resultMatrix.c,I_w=I_a.resultMatrix.b,I_x=I_a.resultMatrix.d,I_y=Math.abs(I_i-I_j)<=1e-4;I_t=I_y?(I_s=I_u*I_o+I_v*(I_p=I_b.resultTransform.y)+I_a.resultMatrix.tx,I_w*I_o+I_x*I_p+I_a.resultMatrix.ty):(I_p=0,I_s=I_u*I_o+I_a.resultMatrix.tx,I_w*I_o+I_a.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new I_fa,I_ea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(I_c,I_d,15,"#ffff00"),this._sp.graphics.drawCircle(I_s,I_t,15,"#ff00ff")),I_a.setRotation(Math.atan2(I_t-I_a.resultMatrix.ty,I_s-I_a.resultMatrix.tx));var I_z=I_a.parentBone;I_u=I_z.resultMatrix.a,I_v=I_z.resultMatrix.c,I_w=I_z.resultMatrix.b;var I_A=1/(I_u*(I_x=I_z.resultMatrix.d)-I_v*I_w),I_B=I_c-I_z.resultMatrix.tx,I_C=I_d-I_z.resultMatrix.ty,I_D=(I_B*I_x-I_C*I_v)*I_A-I_g,I_E=(I_C*I_u-I_B*I_w)*I_A-I_h,I_F=((I_B=I_s-I_z.resultMatrix.tx)*I_x-(I_C=I_t-I_z.resultMatrix.ty)*I_v)*I_A-I_g,I_G=(I_C*I_u-I_B*I_w)*I_A-I_h,I_H=Math.sqrt(I_F*I_F+I_G*I_G),I_I=I_b.length*I_k,I_J=NaN,I_K=NaN;if(I_y){var I_L=(I_D*I_D+I_E*I_E-I_H*I_H-(I_I*=I_i)*I_I)/(2*I_H*I_I);I_L<-1?I_L=-1:1<I_L&&(I_L=1),I_K=Math.acos(I_L)*I_e,I_u=I_H+I_I*I_L,I_v=I_I*Math.sin(I_K),I_J=Math.atan2(I_E*I_u-I_D*I_v,I_D*I_u+I_E*I_v)}else{var I_M=(I_u=I_i*I_I)*I_u,I_N=(I_v=I_j*I_I)*I_v,I_O=I_D*I_D+I_E*I_E,I_P=Math.atan2(I_E,I_D),I_Q=-2*I_N*I_H,I_R=I_N-I_M;if(0<(I_x=I_Q*I_Q-4*I_R*(I_w=I_N*I_H*I_H+I_M*I_O-I_M*I_N))){var I_S=Math.sqrt(I_x);I_Q<0&&(I_S=-I_S);var I_T=(I_S=-(I_Q+I_S)/2)/I_R,I_U=I_w/I_S,I_V=Math.abs(I_T)<Math.abs(I_U)?I_T:I_U;I_V*I_V<=I_O&&(I_C=Math.sqrt(I_O-I_V*I_V)*I_e,I_J=I_P-Math.atan2(I_C,I_V),I_K=Math.atan2(I_C/I_j,(I_V-I_H)/I_i))}var I_W=0,I_X=Number.MAX_VALUE,I_Y=0,I_Z=0,I_$=0,I__=0,I_q=0,I_r=0;I__<(I_x=(I_B=I_H+I_u)*I_B)&&(I_$=0,I__=I_x,I_q=I_B),(I_x=(I_B=I_H-I_u)*I_B)<I_X&&(I_W=Math.PI,I_X=I_x,I_Y=I_B);var I_aa=Math.acos(-I_u*I_H/(I_M-I_N));(I_x=(I_B=I_u*Math.cos(I_aa)+I_H)*I_B+(I_C=I_v*Math.sin(I_aa))*I_C)<I_X&&(I_W=I_aa,I_X=I_x,I_Y=I_B,I_Z=I_C),I__<I_x&&(I_$=I_aa,I__=I_x,I_q=I_B,I_r=I_C),I_K=I_O<=(I_X+I__)/2?(I_J=I_P-Math.atan2(I_Z*I_e,I_Y),I_W*I_e):(I_J=I_P-Math.atan2(I_r*I_e,I_q),I_$*I_e)}var I_ba=Math.atan2(I_p,I_o)*I_n,I_ca=I_a.resultTransform.skX;180<(I_J=(I_J-I_ba)*I_da.radDeg+I_l-I_ca)?I_J-=360:I_J<-180&&(I_J+=360),I_a.resultTransform.x=I_g,I_a.resultTransform.y=I_h,I_a.resultTransform.skX=I_a.resultTransform.skY=I_ca+I_J*I_f,I_ca=I_b.resultTransform.skX,180<(I_K=((I_K+I_ba)*I_da.radDeg-0)*I_n+I_m-(I_ca%=360))?I_K-=360:I_K<-180&&(I_K+=360),I_b.resultTransform.x=I_o,I_b.resultTransform.y=I_p,I_b.resultTransform.skX=I_b.resultTransform.skY=I_b.resultTransform.skY+I_K*I_f,I_a.update()}},I_a._applyIk3=function(I_a,I_b,I_c,I_d,I_e,I_f){if(0!=I_f){var I_g,I_h,I_i=I_b.resultMatrix.a*I_b.length,I_j=I_b.resultMatrix.b*I_b.length,I_k=I_i*I_i+I_j*I_j,I_l=Math.sqrt(I_k),I_m=I_a.resultMatrix.tx,I_n=I_a.resultMatrix.ty,I_o=I_b.resultMatrix.tx,I_p=I_b.resultMatrix.ty,I_s=I_o-I_m,I_t=I_p-I_n,I_u=I_s*I_s+I_t*I_t,I_v=Math.sqrt(I_u),I_w=(I_s=I_c-I_a.resultMatrix.tx)*I_s+(I_t=I_d-I_a.resultMatrix.ty)*I_t,I_x=Math.sqrt(I_w);if(I_l+I_v<=I_x||I_x+I_l<=I_v||I_x+I_v<=I_l){var I_y=NaN;I_o=I_m+(I_y=I_l+I_v<=I_x?1:-1)*(I_c-I_m)*I_v/I_x,I_p=I_n+I_y*(I_d-I_n)*I_v/I_x}else{var I_z=(I_u-I_k+I_w)/(2*I_w),I_A=Math.sqrt(I_u-I_z*I_z*I_w)/I_x,I_B=I_m+I_s*I_z,I_C=I_n+I_t*I_z,I_D=-I_t*I_A,I_E=I_s*I_A;I_p=0<I_e?(I_o=I_B-I_D,I_C-I_E):(I_o=I_B+I_D,I_C+I_E)}I_g=I_o,I_h=I_p,this.isDebug&&(this._sp||(this._sp=new I_fa,I_ea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(I_m,I_n,15,"#ff00ff"),this._sp.graphics.drawCircle(I_c,I_d,15,"#ffff00"),this._sp.graphics.drawCircle(I_g,I_h,15,"#ff00ff"));var I_F,I_G;I_F=Math.atan2(I_h-I_a.resultMatrix.ty,I_g-I_a.resultMatrix.tx),I_a.setRotation(I_F),(I_G=I_da._tempMatrix).identity(),I_G.rotate(I_F),I_G.scale(I_a.resultMatrix.getScaleX(),I_a.resultMatrix.getScaleY()),I_G.translate(I_a.resultMatrix.tx,I_a.resultMatrix.ty),I_G.copyTo(I_a.resultMatrix),I_a.updateChild();var I_H,I_I;I_H=Math.atan2(I_d-I_h,I_c-I_g),I_b.setRotation(I_H),(I_I=I_da._tempMatrix).identity(),I_I.rotate(I_H),I_I.scale(I_b.resultMatrix.getScaleX(),I_b.resultMatrix.getScaleY()),I_I.translate(I_g,I_h),I_G.copyTo(I_b.resultMatrix),I_b.updateChild()}},I_c(I_da,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new I_Ga}]),I_da}(),I_Pa=function(){function I_a(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return I_d(I_a,"laya.ani.bone.IkConstraintData"),I_a}(),I_x=function(){function I_I(I_a,I_b){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=I_a,this.position=I_a.position,this.spacing=I_a.spacing,this.rotateMix=I_a.rotateMix,this.translateMix=I_a.translateMix,this.bones=[];for(var I_c=this.data.bones,I_d=0,I_e=I_c.length;I_d<I_e;I_d++)this.bones.push(I_b[I_c[I_d]])}I_d(I_I,"laya.ani.bone.PathConstraint");var I_a=I_I.prototype;return I_a.apply=function(I_a,I_b){if(this.target){var I_c=this.translateMix,I_d=this.translateMix,I_e=0<I_d,I_f=this.data.spacingMode,I_g="length"==I_f,I_h=this.data.rotateMode,I_i="tangent"==I_h,I_j="chainScale"==I_h,I_k=[],I_l=this.bones.length,I_m=I_i?I_l:I_l+1,I_n=[];(this._spaces=I_n)[0]=this.position;var I_o=this.spacing;if(I_j||I_g)for(var I_p=0,I_s=I_m-1;I_p<I_s;){var I_t=this.bones[I_p],I_u=I_t.length,I_v=I_u*I_t.resultMatrix.a,I_w=I_u*I_t.resultMatrix.b;I_u=Math.sqrt(I_v*I_v+I_w*I_w),I_j&&(I_k[I_p]=I_u),I_n[++I_p]=I_g?Math.max(0,I_u+I_o):I_o}else for(I_p=1;I_p<I_m;I_p++)I_n[I_p]=I_o;var I_x=this.computeWorldPositions(this.target,I_a,I_b,I_m,I_i,"percent"==this.data.positionMode,"percent"==I_f);if(this._debugKey){for(I_p=0;I_p<I_x.length;I_p++)I_b.drawCircle(I_x[I_p++],I_x[I_p++],5,"#00ff00");var I_y=[];for(I_p=0;I_p<I_x.length;I_p++)I_y.push(I_x[I_p++],I_x[I_p++]);I_b.drawLines(0,0,I_y,"#ff0000")}var I_z=I_x[0],I_A=I_x[1],I_B=this.data.offsetRotation,I_C="chain"==I_h&&0==I_B,I_D=NaN;for(I_p=0,I_D=3;I_p<I_l;I_p++,I_D+=3){(I_t=this.bones[I_p]).resultMatrix.tx+=(I_z-I_t.resultMatrix.tx)*I_c,I_t.resultMatrix.ty+=(I_A-I_t.resultMatrix.ty)*I_c;var I_E=(I_v=I_x[I_D])-I_z,I_F=(I_w=I_x[I_D+1])-I_A;if(I_j&&0!=(I_u=I_k[I_p])){var I_G=(Math.sqrt(I_E*I_E+I_F*I_F)/I_u-1)*I_d+1;I_t.resultMatrix.a*=I_G,I_t.resultMatrix.c*=I_G}if(I_z=I_v,I_A=I_w,I_e){var I_H=I_t.resultMatrix.a,I_I=I_t.resultMatrix.c,I_J=I_t.resultMatrix.b,I_K=I_t.resultMatrix.d,I_L=NaN,I_M=NaN,I_N=NaN;I_L=I_i?I_x[I_D-1]:0==I_n[I_p+1]?I_x[I_D+2]:Math.atan2(I_F,I_E),I_L-=Math.atan2(I_J,I_H)-I_B/180*Math.PI,I_C&&(I_M=Math.cos(I_L),I_N=Math.sin(I_L),I_z+=((I_u=I_t.length)*(I_M*I_H-I_N*I_J)-I_E)*I_d,I_A+=(I_u*(I_N*I_H+I_M*I_J)-I_F)*I_d),I_L>Math.PI?I_L-=2*Math.PI:I_L<-Math.PI&&(I_L+=2*Math.PI),I_L*=I_d,I_M=Math.cos(I_L),I_N=Math.sin(I_L),I_t.resultMatrix.a=I_M*I_H-I_N*I_J,I_t.resultMatrix.c=I_M*I_I-I_N*I_K,I_t.resultMatrix.b=I_N*I_H+I_M*I_J,I_t.resultMatrix.d=I_N*I_I+I_M*I_K}}}},I_a.computeWorldVertices2=function(I_a,I_b,I_c,I_d,I_e,I_f){var I_g,I_h,I_i=I_a.currDisplayData.bones,I_j=I_a.currDisplayData.weights,I_k=I_a.currDisplayData.triangles,I_l=0,I_m=0,I_n=0,I_o=0,I_p=0,I_s=0,I_t=0,I_u=0,I_v=0,I_w=0,I_x=0;if(null!=I_i){for(I_l=0;I_l<I_c;I_l+=2)I_m+=(I_o=I_i[I_m])+1,I_n+=I_o;var I_y=I_b;for(I_p=I_f,I_s=3*I_n;I_p<I_d;I_p+=2){for(I_u=I_t=0,I_o=I_i[I_m++],I_o+=I_m;I_m<I_o;I_m++,I_s+=3){I_g=I_y[I_i[I_m]].resultMatrix,I_v=I_j[I_s],I_w=I_j[I_s+1];var I_z=I_j[I_s+2];I_t+=(I_v*I_g.a+I_w*I_g.c+I_g.tx)*I_z,I_u+=(I_v*I_g.b+I_w*I_g.d+I_g.ty)*I_z}I_e[I_p]=I_t,I_e[I_p+1]=I_u}}else{var I_A,I_B;if(I_k||(I_k=I_j),I_a.deformData&&(I_k=I_a.deformData),I_A=I_a.parent,I_b)for(I_x=I_b.length,I_l=0;I_l<I_x;I_l++)if(I_b[I_l].name==I_A){I_h=I_b[I_l];break}I_h&&(I_B=I_h.resultMatrix),I_B||(I_B=I_I._tempMt);var I_C=I_B.tx,I_D=I_B.ty,I_E=I_B.a,I_F=I_B.b,I_G=I_B.c,I_H=I_B.d;for(I_h&&(I_H*=I_h.d),I_m=I_c,I_p=I_f;I_p<I_d;I_m+=2,I_p+=2)I_v=I_k[I_m],I_w=I_k[I_m+1],I_e[I_p]=I_v*I_E+I_w*I_F+I_C,I_e[I_p+1]=-(I_v*I_G+I_w*I_H+I_D)}},I_a.computeWorldPositions=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g){I_a.currDisplayData.bones,I_a.currDisplayData.weights,I_a.currDisplayData.triangles;var I_h=[],I_i=0,I_j=I_a.currDisplayData.verLen,I_k=this.position,I_l=this._spaces,I_m=[],I_n=[],I_o=I_j/6,I_p=-1,I_s=NaN,I_t=0,I_u=0,I_v=NaN,I_w=NaN,I_x=NaN,I_y=NaN;if(I_o--,I_j-=4,this.computeWorldVertices2(I_a,I_b,2,I_j,I_h,0),this._debugKey)for(I_i=0;I_i<I_h.length;)I_c.drawCircle(I_h[I_i++],I_h[I_i++],10,"#ff0000");I_m=I_h,this._curves.length=I_o;var I_z=this._curves,I_A=I_m[I_s=0],I_B=I_m[1],I_C=0,I_D=0,I_E=0,I_F=0,I_G=0,I_H=0,I_I=NaN,I_J=NaN,I_K=NaN,I_L=NaN,I_M=NaN,I_N=NaN,I_O=NaN,I_P=NaN,I_Q=0;for(I_i=0,I_Q=2;I_i<I_o;I_i++,I_Q+=6)I_C=I_m[I_Q],I_D=I_m[I_Q+1],I_E=I_m[I_Q+2],I_F=I_m[I_Q+3],I_M=2*(I_I=.1875*(I_A-2*I_C+I_E))+(I_K=.09375*(3*(I_C-I_E)-I_A+(I_G=I_m[I_Q+4]))),I_N=2*(I_J=.1875*(I_B-2*I_D+I_F))+(I_L=.09375*(3*(I_D-I_F)-I_B+(I_H=I_m[I_Q+5]))),I_O=.75*(I_C-I_A)+I_I+.16666667*I_K,I_P=.75*(I_D-I_B)+I_J+.16666667*I_L,I_s+=Math.sqrt(I_O*I_O+I_P*I_P),I_O+=I_M,I_P+=I_N,I_M+=I_K,I_N+=I_L,I_s+=Math.sqrt(I_O*I_O+I_P*I_P),I_O+=I_M,I_P+=I_N,I_s+=Math.sqrt(I_O*I_O+I_P*I_P),I_O+=I_M+I_K,I_P+=I_N+I_L,I_s+=Math.sqrt(I_O*I_O+I_P*I_P),I_z[I_i]=I_s,I_A=I_G,I_B=I_H;if(I_f&&(I_k*=I_s),I_g)for(I_i=0;I_i<I_d;I_i++)I_l[I_i]*=I_s;var I_R=this._segments,I_S=0,I_T=0;for(I_T=I_u=I_t=I_i=0;I_i<I_d;I_i++,I_t+=3)if((I_v=I_k+=I_w=I_l[I_i])<0)this.addBeforePosition(I_v,I_m,0,I_n,I_t);else if(I_s<I_v)this.addAfterPosition(I_v-I_s,I_m,I_j-4,I_n,I_t);else{for(;;I_u++)if(!((I_y=I_z[I_u])<I_v)){0==I_u?I_v/=I_y:I_v=(I_v-(I_x=I_z[I_u-1]))/(I_y-I_x);break}if(I_u!=I_p){var I_U=6*(I_p=I_u);for(I_A=I_m[I_U],I_B=I_m[I_U+1],I_C=I_m[I_U+2],I_D=I_m[I_U+3],I_E=I_m[I_U+4],I_F=I_m[I_U+5],I_M=2*(I_I=.03*(I_A-2*I_C+I_E))+(I_K=.006*(3*(I_C-I_E)-I_A+(I_G=I_m[I_U+6]))),I_N=2*(I_J=.03*(I_B-2*I_D+I_F))+(I_L=.006*(3*(I_D-I_F)-I_B+(I_H=I_m[I_U+7]))),I_O=.3*(I_C-I_A)+I_I+.16666667*I_K,I_P=.3*(I_D-I_B)+I_J+.16666667*I_L,I_S=Math.sqrt(I_O*I_O+I_P*I_P),I_R[0]=I_S,I_U=1;I_U<8;I_U++)I_O+=I_M,I_P+=I_N,I_M+=I_K,I_N+=I_L,I_S+=Math.sqrt(I_O*I_O+I_P*I_P),I_R[I_U]=I_S;I_O+=I_M,I_P+=I_N,I_S+=Math.sqrt(I_O*I_O+I_P*I_P),I_R[8]=I_S,I_O+=I_M+I_K,I_P+=I_N+I_L,I_S+=Math.sqrt(I_O*I_O+I_P*I_P),I_R[9]=I_S,I_T=0}for(I_v*=I_S;;I_T++)if(!((I_y=I_R[I_T])<I_v)){0==I_T?I_v/=I_y:I_v=I_T+(I_v-(I_x=I_R[I_T-1]))/(I_y-I_x);break}this.addCurvePosition(.1*I_v,I_A,I_B,I_C,I_D,I_E,I_F,I_G,I_H,I_n,I_t,I_e||0<I_i&&0==I_w)}return I_n},I_a.addBeforePosition=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_b[I_c],I_g=I_b[I_c+1],I_h=I_b[I_c+2]-I_f,I_i=I_b[I_c+3]-I_g,I_j=Math.atan2(I_i,I_h);I_d[I_e]=I_f+I_a*Math.cos(I_j),I_d[I_e+1]=I_g+I_a*Math.sin(I_j),I_d[I_e+2]=I_j},I_a.addAfterPosition=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_b[I_c+2],I_g=I_b[I_c+3],I_h=I_f-I_b[I_c],I_i=I_g-I_b[I_c+1],I_j=Math.atan2(I_i,I_h);I_d[I_e]=I_f+I_a*Math.cos(I_j),I_d[I_e+1]=I_g+I_a*Math.sin(I_j),I_d[I_e+2]=I_j},I_a.addCurvePosition=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k,I_l){0==I_a&&(I_a=1e-4);var I_m=I_a*I_a,I_n=I_m*I_a,I_o=1-I_a,I_p=I_o*I_o,I_s=I_p*I_o,I_t=I_o*I_a,I_u=3*I_t,I_v=I_o*I_u,I_w=I_u*I_a,I_x=I_b*I_s+I_d*I_v+I_f*I_w+I_h*I_n,I_y=I_c*I_s+I_e*I_v+I_g*I_w+I_i*I_n;I_j[I_k]=I_x,I_j[I_k+1]=I_y,I_j[I_k+2]=I_l?Math.atan2(I_y-(I_c*I_p+I_e*I_t*2+I_g*I_m),I_x-(I_b*I_p+I_d*I_t*2+I_f*I_m)):0},I_I.NONE=-1,I_I.BEFORE=-2,I_I.AFTER=-3,I_c(I_I,["_tempMt",function(){return this._tempMt=new I_Ga}]),I_I}(),I_Qa=function(){function I_a(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return I_d(I_a,"laya.ani.bone.PathConstraintData"),I_a}(),I_Ra=function(){function I_a(){this.name=null,this.slotArr=[]}return I_d(I_a,"laya.ani.bone.SkinData"),I_a}(),I_Sa=function(){function I_a(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}I_d(I_a,"laya.ani.bone.SkinSlotDisplayData");var I_b=I_a.prototype;return I_b.createTexture=function(I_a){return this.texture||(this.texture=new I_Ha(I_a.bitmap,this.uvs),I_a.bitmap.alphaTexture&&(this.texture.alphaTexture=new I_Ha(I_a.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=I_a.height,this.texture.height=I_a.width,this.texture.offsetX=-I_a.offsetX,this.texture.offsetY=-I_a.offsetY,this.texture.sourceWidth=I_a.sourceHeight,this.texture.sourceHeight=I_a.sourceWidth):(this.texture.width=I_a.width,this.texture.height=I_a.height,this.texture.offsetX=-I_a.offsetX,this.texture.offsetY=-I_a.offsetY,this.texture.sourceWidth=I_a.sourceWidth,this.texture.sourceHeight=I_a.sourceHeight),I_s.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},I_b.destory=function(){this.texture&&this.texture.destroy()},I_a}(),I_Ta=function(){function I_a(){this.name=null,this.displayArr=[]}return I_d(I_a,"laya.ani.bone.SlotData"),I_a.prototype.getDisplayByName=function(I_a){for(var I_b=0,I_c=this.displayArr.length;I_b<I_c;I_b++)if(this.displayArr[I_b].attachmentName==I_a)return I_b;return-1},I_a}(),I_y=function(){function I_a(I_a,I_b){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=I_p(2,0),this._data=I_a,null==this._bones&&(this._bones=[]),this.target=I_b[I_a.targetIndex];var I_c,I_d=0;for(I_d=0,I_c=I_a.boneIndexs.length;I_d<I_c;I_d++)this._bones.push(I_b[I_a.boneIndexs[I_d]]);this.rotateMix=I_a.rotateMix,this.translateMix=I_a.translateMix,this.scaleMix=I_a.scaleMix,this.shearMix=I_a.shearMix}return I_d(I_a,"laya.ani.bone.TfConstraint"),I_a.prototype.apply=function(){for(var I_a,I_b=this.target.resultMatrix.a,I_c=this.target.resultMatrix.b,I_d=this.target.resultMatrix.c,I_e=this.target.resultMatrix.d,I_f=0,I_g=this._bones.length;I_f<I_g;I_f++){if(I_a=this._bones[I_f],0<this.rotateMix){var I_h=I_a.resultMatrix.a,I_i=I_a.resultMatrix.b,I_j=I_a.resultMatrix.c,I_k=I_a.resultMatrix.d,I_l=Math.atan2(I_d,I_b)-Math.atan2(I_j,I_h)+this._data.offsetRotation*Math.PI/180;I_l>Math.PI?I_l-=2*Math.PI:I_l<-Math.PI&&(I_l+=2*Math.PI),I_l*=this.rotateMix;var I_m=Math.cos(I_l),I_n=Math.sin(I_l);I_a.resultMatrix.a=I_m*I_h-I_n*I_j,I_a.resultMatrix.b=I_m*I_i-I_n*I_k,I_a.resultMatrix.c=I_n*I_h+I_m*I_j,I_a.resultMatrix.d=I_n*I_i+I_m*I_k}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),I_a.resultMatrix.tx+=(this._temp[0]-I_a.resultMatrix.tx)*this.translateMix,I_a.resultMatrix.ty+=(this._temp[1]-I_a.resultMatrix.ty)*this.translateMix,I_a.updateChild()),0<this.scaleMix){var I_o=Math.sqrt(I_a.resultMatrix.a*I_a.resultMatrix.a+I_a.resultMatrix.c*I_a.resultMatrix.c),I_p=Math.sqrt(I_b*I_b+I_d*I_d),I_s=1e-5<I_o?(I_o+(I_p-I_o+this._data.offsetScaleX)*this.scaleMix)/I_o:0;I_a.resultMatrix.a*=I_s,I_a.resultMatrix.c*=I_s,I_o=Math.sqrt(I_a.resultMatrix.b*I_a.resultMatrix.b+I_a.resultMatrix.d*I_a.resultMatrix.d),I_p=Math.sqrt(I_c*I_c+I_e*I_e),I_s=1e-5<I_o?(I_o+(I_p-I_o+this._data.offsetScaleY)*this.scaleMix)/I_o:0,I_a.resultMatrix.b*=I_s,I_a.resultMatrix.d*=I_s}if(0<this.shearMix){I_i=I_a.resultMatrix.b,I_k=I_a.resultMatrix.d;var I_t=Math.atan2(I_k,I_i);(I_l=Math.atan2(I_e,I_c)-Math.atan2(I_d,I_b)-(I_t-Math.atan2(I_a.resultMatrix.c,I_a.resultMatrix.a)))>Math.PI?I_l-=2*Math.PI:I_l<-Math.PI&&(I_l+=2*Math.PI),I_l=I_t+(I_l+this._data.offsetShearY*Math.PI/180)*this.shearMix,I_s=Math.sqrt(I_i*I_i+I_k*I_k),I_a.resultMatrix.b=Math.cos(I_l)*I_s,I_a.resultMatrix.d=Math.sin(I_l)*I_s}}},I_a}(),I_Ua=function(){function I_a(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return I_d(I_a,"laya.ani.bone.TfConstraintData"),I_a}(),I_Va=function(){function I_a(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}I_d(I_a,"laya.ani.bone.Transform");var I_b=I_a.prototype;return I_b.initData=function(I_a){null!=I_a.x&&(this.x=I_a.x),null!=I_a.y&&(this.y=I_a.y),null!=I_a.skX&&(this.skX=I_a.skX),null!=I_a.skY&&(this.skY=I_a.skY),null!=I_a.scX&&(this.scX=I_a.scX),null!=I_a.scY&&(this.scY=I_a.scY)},I_b.getMatrix=function(){var I_a;return(I_a=this.mMatrix?this.mMatrix:this.mMatrix=new I_Ga).identity(),I_a.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(I_a,this.skewX*Math.PI/180,this.skewY*Math.PI/180),I_a.rotate(this.skX*Math.PI/180),I_a.translate(this.x,this.y),I_a},I_b.skew=function(I_a,I_b,I_c){var I_d=Math.sin(I_c),I_e=Math.cos(I_c),I_f=Math.sin(I_b),I_g=Math.cos(I_b);return I_a.setTo(I_a.a*I_g-I_a.b*I_d,I_a.a*I_f+I_a.b*I_e,I_a.c*I_g-I_a.d*I_d,I_a.c*I_f+I_a.d*I_e,I_a.tx*I_g-I_a.ty*I_d,I_a.tx*I_f+I_a.ty*I_e),I_a},I_a}(),I_z=function(){function I_a(){}return I_d(I_a,"laya.ani.bone.UVTools"),I_a.getRelativeUV=function(I_a,I_b,I_c){var I_d=I_a[0],I_e=I_a[2]-I_a[0],I_f=I_a[1],I_g=I_a[5]-I_a[1];I_c||(I_c=[]),I_c.length=I_b.length;var I_h,I_i=0;I_h=I_c.length;var I_j=1/I_e,I_k=1/I_g;for(I_i=0;I_i<I_h;I_i+=2)I_c[I_i]=(I_b[I_i]-I_d)*I_j,I_c[I_i+1]=(I_b[I_i+1]-I_f)*I_k;return I_c},I_a.getAbsoluteUV=function(I_a,I_b,I_c){if(0==I_a[0]&&0==I_a[1]&&1==I_a[4]&&1==I_a[5])return I_c?(I_t.copyArray(I_c,I_b),I_c):I_b;var I_d=I_a[0],I_e=I_a[2]-I_a[0],I_f=I_a[1],I_g=I_a[5]-I_a[1];I_c||(I_c=[]),I_c.length=I_b.length;var I_h,I_i=0;for(I_h=I_c.length,I_i=0;I_i<I_h;I_i+=2)I_c[I_i]=I_b[I_i]*I_e+I_d,I_c[I_i+1]=I_b[I_i+1]*I_g+I_f;return I_c},I_a}(),I_I=function(){function I_a(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return I_d(I_a,"laya.ani.KeyFramesContent"),I_a}(),I_A=function(){function I_k(){}return I_d(I_k,"laya.ani.math.BezierLerp"),I_k.getBezierRate=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_k._getBezierParamKey(I_b,I_c,I_d,I_e),I_g=100*I_f+I_a;if(I_k._bezierResultCache[I_g])return I_k._bezierResultCache[I_g];var I_h,I_i=I_k._getBezierPoints(I_b,I_c,I_d,I_e,I_f),I_j=0;for(I_h=I_i.length,I_j=0;I_j<I_h;I_j+=2)if(I_a<=I_i[I_j])return I_k._bezierResultCache[I_g]=I_i[I_j+1],I_i[I_j+1];return I_k._bezierResultCache[I_g]=1},I_k._getBezierParamKey=function(I_a,I_b,I_c,I_d){return 100*(100*(100*(100*I_a+I_b)+I_c)+I_d)},I_k._getBezierPoints=function(I_a,I_b,I_c,I_d,I_e){return I_k._bezierPointsCache[I_e]?I_k._bezierPointsCache[I_e]:(I_f=[0,0,I_a,I_b,I_c,I_d,1,1],I_g=(new I_h).getBezierPoints(I_f,100,3),I_k._bezierPointsCache[I_e]=I_g);var I_f,I_g},I_k._bezierResultCache={},I_k._bezierPointsCache={},I_k}(),I_B=function(I_a){function I_b(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,I_b.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}I_d(I_b,"laya.ani.AnimationPlayer",I_e);var I_c=I_b.prototype;return I_ea.imps(I_c,{"laya.resource.IDestroy":!0}),I_c._onTempletLoadedComputeFullKeyframeIndices=function(I_a,I_b,I_c){this._templet===I_c&&this._cachePlayRate===I_a&&this._cacheFrameRate===I_b&&this._computeFullKeyframeIndices()},I_c._computeFullKeyframeIndices=function(){for(var I_a=this._fullFrames=[],I_b=this._templet,I_c=this._cacheFrameRateInterval*this._cachePlayRate,I_d=0,I_e=I_b.getAnimationCount();I_d<I_e;I_d++){for(var I_f=[],I_g=0,I_h=I_b.getAnimation(I_d).nodes.length;I_g<I_h;I_g++){for(var I_i=I_b.getAnimation(I_d).nodes[I_g],I_j=Math.floor(I_i.playTime/I_c+.01),I_k=new Uint16Array(I_j+1),I_l=-1,I_m=0,I_n=I_i.keyFrame.length;I_m<I_n;I_m++){var I_o=I_i.keyFrame[I_m],I_p=I_o.startTime,I_s=I_p+I_o.duration+I_c;do{for(var I_t=Math.floor(I_p/I_c+.5),I_u=I_l+1;I_u<I_t;I_u++)I_k[I_u]=I_m;I_k[I_l=I_t]=I_m,I_p+=I_c}while(I_p<=I_s)}I_f.push(I_k)}I_a.push(I_f)}},I_c._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},I_c._calculatePlayDuration=function(){if(0!==this.state){var I_a=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=I_a),this._playEnd>I_a&&(this._playEnd=I_a),this._playDuration=this._playEnd-this._playStart}},I_c._setPlayParams=function(I_a,I_b){this._currentTime=I_a,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/I_b+.01),0),this._currentFrameTime=this._currentKeyframeIndex*I_b},I_c._setPlayParamsWhenStop=function(I_a,I_b){this._currentTime=I_a,this._currentKeyframeIndex=Math.max(Math.floor(I_a/I_b+.01),0),this._currentFrameTime=this._currentKeyframeIndex*I_b,this._currentAnimationClipIndex=-1},I_c._update=function(I_a){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var I_b=this._cacheFrameRateInterval*this._cachePlayRate,I_c=0;this._startUpdateLoopCount!==I_o.loopCount&&(I_c=I_a*this.playbackRate,this._elapsedPlaybackTime+=I_c);var I_d=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=I_d)return this._setPlayParamsWhenStop(I_d,I_b),void this.event("stopped");if(I_c+=this._currentTime,0<I_d)if(I_d<=I_c)do{if(I_c-=I_d,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(I_d,I_b),this._stopWhenCircleFinish=!1,void this.event("stopped");I_c<I_d&&(this._setPlayParams(I_c,I_b),this.event("complete"))}while(I_d<=I_c);else this._setPlayParams(I_c,I_b);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(I_d,I_b),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},I_c._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},I_c.play=function(I_a,I_b,I_c,I_d,I_e){if(void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=1),void 0===I_c&&(I_c=2147483647),void 0===I_d&&(I_d=0),void 0===I_e&&(I_e=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(I_c<0||I_d<0||I_e<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==I_e&&I_e<I_d)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=I_b,this._overallDuration=I_c,this._playStart=I_d,this._playEnd=I_e,this._paused=!1,this._currentAnimationClipIndex=I_a,this._currentKeyframeIndex=0,this._startUpdateLoopCount=I_o.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},I_c.playByFrame=function(I_a,I_b,I_c,I_d,I_e,I_f){void 0===I_a&&(I_a=0),void 0===I_b&&(I_b=1),void 0===I_c&&(I_c=2147483647),void 0===I_d&&(I_d=0),void 0===I_e&&(I_e=0),void 0===I_f&&(I_f=30);var I_g=1e3/I_f;this.play(I_a,I_b,I_c,I_d*I_g,I_e*I_g)},I_c.stop=function(I_a){void 0===I_a&&(I_a=!0),I_a?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},I_f(0,I_c,"playEnd",function(){return this._playEnd}),I_f(0,I_c,"templet",function(){return this._templet},function(I_a){0===!this.state&&this.stop(!0),this._templet!==I_a&&((this._templet=I_a).loaded?this._computeFullKeyframeIndices():I_a.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),I_f(0,I_c,"playStart",function(){return this._playStart}),I_f(0,I_c,"playDuration",function(){return this._playDuration}),I_f(0,I_c,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),I_f(0,I_c,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),I_f(0,I_c,"overallDuration",function(){return this._overallDuration}),I_f(0,I_c,"currentFrameTime",function(){return this._currentFrameTime}),I_f(0,I_c,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),I_f(0,I_c,"currentPlayTime",function(){return this._currentTime+this._playStart}),I_f(0,I_c,"cachePlayRate",function(){return this._cachePlayRate},function(I_a){this._cachePlayRate!==I_a&&(this._cachePlayRate=I_a,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[I_a,this._cacheFrameRate])))}),I_f(0,I_c,"cacheFrameRate",function(){return this._cacheFrameRate},function(I_a){this._cacheFrameRate!==I_a&&(this._cacheFrameRate=I_a,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,I_a])))}),I_f(0,I_c,"currentTime",null,function(I_a){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(I_a<this._playStart||I_a>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=I_o.loopCount;var I_b=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=I_a,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/I_b),0),this._currentFrameTime=this._currentKeyframeIndex*I_b}}),I_f(0,I_c,"paused",function(){return this._paused},function(I_a){(this._paused=I_a)&&this.event("paused")}),I_f(0,I_c,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),I_f(0,I_c,"destroyed",function(){return this._destroyed}),I_b}(),I_J=function(I_a){function I_b(){I_b.__super.call(this),I_s.isConchNode&&(this.drawSkin=function(I_a){I_a.transform||(I_a.transform=I_Ga.EMPTY),this._addCmd([I_a]),this.setSkinMesh&&this.setSkinMesh(I_a._ps,I_a.mVBData,I_a.mEleNum,0,I_a.mTexture,I_a.transform)})}return I_d(I_b,"laya.ani.GraphicsAni",I_g),I_b.prototype.drawSkin=function(I_a){var I_b=[I_a];this._saveToCmd(I_s._context._drawSkin,I_b)},I_b.create=function(){return I_b._caches.pop()||new I_b},I_b.recycle=function(I_a){I_a.clear(),I_b._caches.push(I_a)},I_b._caches=[],I_b}(),I_K=function(I_a){function I_u(){this._aniMap={},this.unfixedLastAniIndex=-1,I_u.__super.call(this),this._anis=new Array}I_d(I_u,"laya.ani.AnimationTemplet",I_k);var I_b=I_u.prototype;return I_b.parse=function(I_a){var I_b=new I_Fa(I_a);this._aniVersion=I_b.readUTFString(),I_v.parse(this,I_b)},I_b._calculateKeyFrame=function(I_a,I_b,I_c){var I_d=I_a.keyFrame;I_d[I_b]=I_d[0];for(var I_e=0;I_e<I_b;I_e++){var I_f=I_d[I_e];I_f.nextData=0===I_f.duration?I_f.data:I_d[I_e+1].data}I_d.length--},I_b.onAsynLoaded=function(I_a,I_b,I_c){var I_d=new I_Fa(I_b);switch(this._aniVersion=I_d.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":I_w.parse(this,I_d);break;default:I_v.parse(this,I_d)}this._endLoaded()},I_b.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},I_b.getAnimationCount=function(){return this._anis.length},I_b.getAnimation=function(I_a){return this._anis[I_a]},I_b.getAniDuration=function(I_a){return this._anis[I_a].playTime},I_b.getNodes=function(I_a){return this._anis[I_a].nodes},I_b.getNodeIndexWithName=function(I_a,I_b){return this._anis[I_a].bone3DMap[I_b]},I_b.getNodeCount=function(I_a){return this._anis[I_a].nodes.length},I_b.getTotalkeyframesLength=function(I_a){return this._anis[I_a].totalKeyframeDatasLength},I_b.getPublicExtData=function(){return this._publicExtData},I_b.getAnimationDataWithCache=function(I_a,I_b,I_c,I_d){var I_e=I_b[I_c];if(I_e){var I_f=I_e[I_a];return I_f?I_f[I_d]:null}return null},I_b.setAnimationDataWithCache=function(I_a,I_b,I_c,I_d,I_e){var I_f=I_b[I_c]||(I_b[I_c]={});(I_f[I_a]||(I_f[I_a]=[]))[I_d]=I_e},I_b.getOriginalData=function(I_a,I_b,I_c,I_d,I_e){for(var I_f=this._anis[I_a].nodes,I_g=0,I_h=0,I_i=I_f.length,I_j=0;I_h<I_i;I_h++){var I_k,I_l=I_f[I_h];I_k=I_l.keyFrame[I_c[I_h][I_d]],I_l.dataOffset=I_j;var I_m=I_e-I_k.startTime,I_n=I_l.lerpType;if(I_n)switch(I_n){case 0:case 1:for(I_g=0;I_g<I_l.keyframeWidth;)I_g+=I_l.interpolationMethod[I_g](I_l,I_g,I_b,I_j+I_g,I_k.data,I_m,null,I_k.duration,I_k.nextData);break;case 2:var I_o=I_k.interpolationData,I_p=I_o.length,I_s=0;for(I_g=0;I_g<I_p;){var I_t=I_o[I_g];switch(I_t){case 6:case 7:I_g+=I_u.interpolation[I_t](I_l,I_s,I_b,I_j+I_s,I_k.data,I_m,null,I_k.duration,I_k.nextData,I_o,I_g+1);break;default:I_g+=I_u.interpolation[I_t](I_l,I_s,I_b,I_j+I_s,I_k.data,I_m,null,I_k.duration,I_k.nextData)}I_s++}}else for(I_g=0;I_g<I_l.keyframeWidth;)I_g+=I_l.interpolationMethod[I_g](I_l,I_g,I_b,I_j+I_g,I_k.data,I_m,null,I_k.duration,I_k.nextData);I_j+=I_l.keyframeWidth}},I_b.getNodesCurrentFrameIndex=function(I_a,I_b){var I_c=this._anis[I_a].nodes;I_a!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(I_c.length),this.unfixedCurrentTimes=new Float32Array(I_c.length),this.unfixedLastAniIndex=I_a);for(var I_d=0,I_e=I_c.length;I_d<I_e;I_d++){var I_f=I_c[I_d];for(I_b<this.unfixedCurrentTimes[I_d]&&(this.unfixedCurrentFrameIndexes[I_d]=0),this.unfixedCurrentTimes[I_d]=I_b;this.unfixedCurrentFrameIndexes[I_d]<I_f.keyFrame.length&&!(I_f.keyFrame[this.unfixedCurrentFrameIndexes[I_d]].startTime>this.unfixedCurrentTimes[I_d]);)this.unfixedCurrentFrameIndexes[I_d]++;this.unfixedCurrentFrameIndexes[I_d]--}return this.unfixedCurrentFrameIndexes},I_b.getOriginalDataUnfixedRate=function(I_a,I_b,I_c){var I_d=this._anis[I_a].nodes;I_a!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(I_d.length),this.unfixedCurrentTimes=new Float32Array(I_d.length),this.unfixedKeyframes=I_p(I_d.length),this.unfixedLastAniIndex=I_a);for(var I_e=0,I_f=0,I_g=I_d.length,I_h=0;I_f<I_g;I_f++){var I_i=I_d[I_f];for(I_c<this.unfixedCurrentTimes[I_f]&&(this.unfixedCurrentFrameIndexes[I_f]=0),this.unfixedCurrentTimes[I_f]=I_c;this.unfixedCurrentFrameIndexes[I_f]<I_i.keyFrame.length&&!(I_i.keyFrame[this.unfixedCurrentFrameIndexes[I_f]].startTime>this.unfixedCurrentTimes[I_f]);)this.unfixedKeyframes[I_f]=I_i.keyFrame[this.unfixedCurrentFrameIndexes[I_f]],this.unfixedCurrentFrameIndexes[I_f]++;var I_j=this.unfixedKeyframes[I_f];I_i.dataOffset=I_h;var I_k=I_c-I_j.startTime;if(I_i.lerpType)switch(I_i.lerpType){case 0:case 1:for(I_e=0;I_e<I_i.keyframeWidth;)I_e+=I_i.interpolationMethod[I_e](I_i,I_e,I_b,I_h+I_e,I_j.data,I_k,null,I_j.duration,I_j.nextData);break;case 2:var I_l=I_j.interpolationData,I_m=I_l.length,I_n=0;for(I_e=0;I_e<I_m;){var I_o=I_l[I_e];switch(I_o){case 6:case 7:I_e+=I_u.interpolation[I_o](I_i,I_n,I_b,I_h+I_n,I_j.data,I_k,null,I_j.duration,I_j.nextData,I_l,I_e+1);break;default:I_e+=I_u.interpolation[I_o](I_i,I_n,I_b,I_h+I_n,I_j.data,I_k,null,I_j.duration,I_j.nextData)}I_n++}}else for(I_e=0;I_e<I_i.keyframeWidth;)I_e+=I_i.interpolationMethod[I_e](I_i,I_e,I_b,I_h+I_e,I_j.data,I_k,null,I_j.duration,I_j.nextData);I_h+=I_i.keyframeWidth}},I_u._LinearInterpolation_0=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){var I_k=0===I_h?0:I_f/I_h;return I_c[I_d]=(1-I_k)*I_e[I_b]+I_k*I_i[I_b],1},I_u._QuaternionInterpolation_1=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){var I_k=0===I_h?0:I_f/I_h;return I_m.slerpQuaternionArray(I_e,I_b,I_i,I_b,I_k,I_c,I_d),4},I_u._AngleInterpolation_2=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){return 0},I_u._RadiansInterpolation_3=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){return 0},I_u._Matrix4x4Interpolation_4=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){for(var I_k=0;I_k<16;I_k++,I_b++)I_c[I_d+I_k]=I_e[I_b]+I_f*I_g[I_b];return 16},I_u._NoInterpolation_5=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j){return I_c[I_d]=I_e[I_b],1},I_u._BezierInterpolation_6=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k){return void 0===I_k&&(I_k=0),I_c[I_d]=I_e[I_b]+(I_i[I_b]-I_e[I_b])*I_A.getBezierRate(I_f/I_h,I_j[I_k],I_j[I_k+1],I_j[I_k+2],I_j[I_k+3]),5},I_u._BezierInterpolation_7=function(I_a,I_b,I_c,I_d,I_e,I_f,I_g,I_h,I_i,I_j,I_k){return void 0===I_k&&(I_k=0),I_c[I_d]=I_j[I_k+4]+I_j[I_k+5]*I_A.getBezierRate((.001*I_f+I_j[I_k+6])/I_j[I_k+7],I_j[I_k],I_j[I_k+1],I_j[I_k+2],I_j[I_k+3]),9},I_u.load=function(I_a){return I_ea.loader.create(I_a,null,null,I_u)},I_u.interpolation=[I_u._LinearInterpolation_0,I_u._QuaternionInterpolation_1,I_u._AngleInterpolation_2,I_u._RadiansInterpolation_3,I_u._Matrix4x4Interpolation_4,I_u._NoInterpolation_5,I_u._BezierInterpolation_6,I_u._BezierInterpolation_7],I_u}(),I_C=function(I_b){function I_c(I_a,I_b){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,I_c.__super.call(this),void 0===I_b&&(I_b=0),I_a&&this.init(I_a,I_b)}I_d(I_c,"laya.ani.bone.Skeleton",I_b);var I_a=I_c.prototype;return I_a.init=function(I_a,I_b){void 0===I_b&&(I_b=0);var I_c,I_d,I_e,I_f=0,I_g=0;if(1==I_b)for(this._graphicsCache=[],I_f=0,I_g=I_a.getAnimationCount();I_f<I_g;I_f++)this._graphicsCache.push([]);if(this._yReverseMatrix=I_a.yReverseMatrix,this._aniMode=I_b,this._templet=I_a,this._player=new I_B,this._player.cacheFrameRate=I_a.rate,this._player.templet=I_a,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=I_a.mBoneArr,this._rootBone=I_a.mRootBone,this._aniSectionDic=I_a.aniSectionDic,0<I_a.ikArr.length)for(this._ikArr=[],I_f=0,I_g=I_a.ikArr.length;I_f<I_g;I_f++)this._ikArr.push(new I_u(I_a.ikArr[I_f],this._boneList));if(0<I_a.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),I_f=0,I_g=I_a.pathArr.length;I_f<I_g;I_f++)I_c=I_a.pathArr[I_f],I_d=new I_x(I_c,this._boneList),(I_e=this._boneSlotDic[I_c.name])&&((I_d=new I_x(I_c,this._boneList)).target=I_e),this._pathDic[I_c.name]=I_d;if(0<I_a.tfArr.length)for(this._tfArr=[],I_f=0,I_g=I_a.tfArr.length;I_f<I_g;I_f++)this._tfArr.push(new I_y(I_a.tfArr[I_f],this._boneList));if(0<I_a.skinDataArray.length){var I_h=this._templet.skinDataArray[this._skinIndex];this._skinName=I_h.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},I_a.load=function(I_a,I_b,I_c){},I_a._onLoaded=function(){},I_a._parseComplete=function(){var I_a=I_D.TEMPLET_DICTIONARY[this._aniPath];I_a&&(this.init(I_a,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},I_a._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},I_a._onPlay=function(){this.event("played")},I_a._onStop=function(){var I_a,I_b=this._templet.eventAniArr[this._aniClipIndex];if(I_b&&this._eventIndex<I_b.length)for(;this._eventIndex<I_b.length;this._eventIndex++)(I_a=I_b[this._eventIndex]).time>=this._player.playStart&&I_a.time<=this._player.playEnd&&this.event("label",I_a);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},I_a._onPause=function(){this.event("paused")},I_a._parseSrcBoneMatrix=function(){var I_a=0,I_b=0;for(I_b=this._templet.srcBoneMatrixArr.length,I_a=0;I_a<I_b;I_a++)this._boneMatrixArray.push(new I_Ga);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var I_c,I_d,I_e=this._templet.boneSlotArray;for(I_a=0,I_b=I_e.length;I_a<I_b;I_a++)I_c=I_e[I_a],null==(I_d=this._bindBoneBoneSlotDic[I_c.parent])&&(this._bindBoneBoneSlotDic[I_c.parent]=I_d=[]),this._boneSlotDic[I_c.name]=I_c=I_c.copy(),I_d.push(I_c),this._boneSlotArray.push(I_c)}},I_a._emitMissedEvents=function(I_a,I_b,I_c){void 0===I_c&&(I_c=0);var I_d=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(I_d){var I_e,I_f,I_g=0;for(I_e=I_d.length,I_g=I_c;I_g<I_e;I_g++)(I_f=I_d[I_g]).time>=this._player.playStart&&I_f.time<=this._player.playEnd&&this.event("label",I_f)}},I_a._update=function(I_a){if(void 0===I_a&&(I_a=!0),!(this._pause||I_a&&this._indexControl)){var I_b=this.timer.currTimer,I_c=this._player.currentKeyframeIndex,I_d=I_b-this._lastTime;if(I_a?this._player._update(I_d):I_c=-1,this._lastTime=I_b,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<I_d&&this._clipIndex==I_c&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var I_e;this._lastUpdateAniClipIndex=this._aniClipIndex,I_c>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var I_f,I_g=this._templet.eventAniArr[this._aniClipIndex];if(I_g&&this._eventIndex<I_g.length&&((I_e=I_g[this._eventIndex]).time>=this._player.playStart&&I_e.time<=this._player.playEnd?this._player.currentPlayTime>=I_e.time&&(this.event("label",I_e),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(I_f=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=I_f&&(this.graphics=I_f));var I_h=0,I_i=0;for(I_i=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,I_i-1)&&0<I_i;)I_i--;if(I_i<this._clipIndex)for(I_h=I_i;I_h<this._clipIndex;I_h++)this._createGraphics(I_h)}else if(1==this._aniMode){if(I_f=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=I_f&&(this.graphics=I_f));for(I_i=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,I_i-1)&&0<I_i;)I_i--;if(I_i<this._clipIndex)for(I_h=I_i;I_h<this._clipIndex;I_h++)this._createGraphics(I_h)}this._createGraphics()}}},I_a._createGraphics=function(I_a){void 0===I_a&&(I_a=-1),-1==I_a&&(I_a=this._clipIndex);var I_b,I_c,I_d=I_a*this._player.cacheFrameRateInterval,I_e=this._templet.drawOrderAniArr[this._aniClipIndex];if(I_e&&0<I_e.length)for(this._drawOrderIndex=0,I_b=I_e[this._drawOrderIndex];I_d>=I_b.time&&(this._drawOrder=I_b.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=I_e.length));)I_b=I_e[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=I_J.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=I_J.create(),I_c=this.graphics;var I_f=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],I_a,I_d);var I_g,I_h,I_i,I_j,I_k=this._aniSectionDic[this._aniClipIndex],I_l=0,I_m=0,I_n=0,I_o=0,I_p=0,I_s=this._templet.srcBoneMatrixArr.length;for(I_p=I_k[I_m=0];I_m<I_s;I_m++)I_j=this._boneList[I_m],I_i=this._templet.srcBoneMatrixArr[I_m],I_j.resultTransform.scX=I_i.scX*this._curOriginalData[I_l++],I_j.resultTransform.skX=I_i.skX+this._curOriginalData[I_l++],I_j.resultTransform.skY=I_i.skY+this._curOriginalData[I_l++],I_j.resultTransform.scY=I_i.scY*this._curOriginalData[I_l++],I_j.resultTransform.x=I_i.x+this._curOriginalData[I_l++],I_j.resultTransform.y=I_i.y+this._curOriginalData[I_l++],8===this._templet.tMatrixDataLen&&(I_j.resultTransform.skewX=I_i.skewX+this._curOriginalData[I_l++],I_j.resultTransform.skewY=I_i.skewY+this._curOriginalData[I_l++]);var I_t,I_u={},I_v={};for(I_p+=I_k[1];I_m<I_p;I_m++)I_u[(I_t=I_f[I_m]).name]=this._curOriginalData[I_l++],I_v[I_t.name]=this._curOriginalData[I_l++],this._curOriginalData[I_l++],this._curOriginalData[I_l++],this._curOriginalData[I_l++],this._curOriginalData[I_l++];var I_w,I_x,I_y={},I_z={};for(I_p+=I_k[2];I_m<I_p;I_m++)I_y[(I_t=I_f[I_m]).name]=this._curOriginalData[I_l++],I_z[I_t.name]=this._curOriginalData[I_l++],this._curOriginalData[I_l++],this._curOriginalData[I_l++],this._curOriginalData[I_l++],this._curOriginalData[I_l++];if(this._pathDic)for(I_p+=I_k[3];I_m<I_p;I_m++){if(I_t=I_f[I_m],I_w=this._pathDic[I_t.name])switch(new I_Fa(I_t.extenData).getByte()){case 1:I_w.position=this._curOriginalData[I_l++];break;case 2:I_w.spacing=this._curOriginalData[I_l++];break;case 3:I_w.rotateMix=this._curOriginalData[I_l++],I_w.translateMix=this._curOriginalData[I_l++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(I_Ga.TEMP.identity()),this._ikArr)for(I_m=0,I_p=this._ikArr.length;I_m<I_p;I_m++)I_x=this._ikArr[I_m],I_y.hasOwnProperty(I_x.name)&&(I_x.bendDirection=I_y[I_x.name]),I_z.hasOwnProperty(I_x.name)&&(I_x.mix=I_z[I_x.name]),I_x.apply();if(this._pathDic)for(var I_A in this._pathDic)(I_w=this._pathDic[I_A]).apply(this._boneList,I_c);if(this._tfArr)for(I_m=0,I_o=this._tfArr.length;I_m<I_o;I_m++)this._tfArr[I_m].apply();for(I_m=0,I_o=this._boneList.length;I_m<I_o;I_m++)if(I_j=this._boneList[I_m],I_h=this._bindBoneBoneSlotDic[I_j.name],I_j.resultMatrix.copyTo(this._boneMatrixArray[I_m]),I_h)for(I_n=0,I_p=I_h.length;I_n<I_p;I_n++)(I_g=I_h[I_n])&&I_g.setParentMatrix(I_j.resultMatrix);var I_B,I_C,I_D,I_E,I_F={},I_G=this._templet.deformAniArr;if(I_G&&0<I_G.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,I_m=0,I_p=this._boneSlotArray.length;I_m<I_p;I_m++)(I_g=this._boneSlotArray[I_m]).deformData=null;var I_H,I_I=I_G[this._aniClipIndex];for(I_H in I_B=I_I.default,this._setDeform(I_B,I_F,this._boneSlotArray,I_d),I_I)"default"!=I_H&&I_H!=this._skinName&&(I_B=I_I[I_H],this._setDeform(I_B,I_F,this._boneSlotArray,I_d));I_B=I_I[this._skinName],this._setDeform(I_B,I_F,this._boneSlotArray,I_d)}if(this._drawOrder)for(I_m=0,I_p=this._drawOrder.length;I_m<I_p;I_m++)I_C=I_u[(I_g=this._boneSlotArray[this._drawOrder[I_m]]).name],I_D=I_v[I_g.name],isNaN(I_D)||(I_c.save(),I_c.alpha(I_D)),isNaN(I_C)||-2==I_C||(this._templet.attachmentNames?I_g.showDisplayByName(this._templet.attachmentNames[I_C]):I_g.showDisplayByIndex(I_C)),I_F[this._drawOrder[I_m]]?(I_E=I_F[this._drawOrder[I_m]],I_g.currDisplayData&&I_E[I_g.currDisplayData.attachmentName]?I_g.deformData=I_E[I_g.currDisplayData.attachmentName]:I_g.deformData=null):I_g.deformData=null,isNaN(I_D)?I_g.draw(I_c,this._boneMatrixArray,2==this._aniMode):I_g.draw(I_c,this._boneMatrixArray,2==this._aniMode,I_D),isNaN(I_D)||I_c.restore();else for(I_m=0,I_p=this._boneSlotArray.length;I_m<I_p;I_m++)I_C=I_u[(I_g=this._boneSlotArray[I_m]).name],I_D=I_v[I_g.name],isNaN(I_D)||(I_c.save(),I_c.alpha(I_D)),isNaN(I_C)||-2==I_C||(this._templet.attachmentNames?I_g.showDisplayByName(this._templet.attachmentNames[I_C]):I_g.showDisplayByIndex(I_C)),I_F[I_m]?(I_E=I_F[I_m],I_g.currDisplayData&&I_E[I_g.currDisplayData.attachmentName]?I_g.deformData=I_E[I_g.currDisplayData.attachmentName]:I_g.deformData=null):I_g.deformData=null,isNaN(I_D)?I_g.draw(I_c,this._boneMatrixArray,2==this._aniMode):I_g.draw(I_c,this._boneMatrixArray,2==this._aniMode,I_D),isNaN(I_D)||I_c.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,I_a,I_c):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,I_a,I_c)},I_a._setDeform=function(I_a,I_b,I_c,I_d){if(I_a){var I_e,I_f,I_g,I_h=0,I_i=0,I_j=0;if(I_a)for(I_h=0,I_i=I_a.deformSlotDataList.length;I_h<I_i;I_h++)for(I_e=I_a.deformSlotDataList[I_h],I_j=0;I_j<I_e.deformSlotDisplayList.length;I_j++)I_g=I_c[(I_f=I_e.deformSlotDisplayList[I_j]).slotIndex],I_f.apply(I_d,I_g),I_b[I_f.slotIndex]||(I_b[I_f.slotIndex]={}),I_b[I_f.slotIndex][I_f.attachment]=I_f.deformData}},I_a.getAnimNum=function(){return this._templet.getAnimationCount()},I_a.getAniNameByIndex=function(I_a){return this._templet.getAniNameByIndex(I_a)},I_a.getSlotByName=function(I_a){return this._boneSlotDic[I_a]},I_a.showSkinByName=function(I_a,I_b){void 0===I_b&&(I_b=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(I_a),I_b)},I_a.showSkinByIndex=function(I_a,I_b){void 0===I_b&&(I_b=!0);for(var I_c=0;I_c<this._boneSlotArray.length;I_c++)this._boneSlotArray[I_c].showSlotData(null,I_b);if(this._templet.showSkinByIndex(this._boneSlotDic,I_a,I_b)){var I_d=this._templet.skinDataArray[I_a];this._skinIndex=I_a,this._skinName=I_d.name}this._clearCache()},I_a.showSlotSkinByIndex=function(I_a,I_b){if(0!=this._aniMode){var I_c=this.getSlotByName(I_a);I_c&&I_c.showDisplayByIndex(I_b),this._clearCache()}},I_a.showSlotSkinByName=function(I_a,I_b){if(0!=this._aniMode){var I_c=this.getSlotByName(I_a);I_c&&I_c.showDisplayByName(I_b),this._clearCache()}},I_a.replaceSlotSkinName=function(I_a,I_b,I_c){if(0!=this._aniMode){var I_d=this.getSlotByName(I_a);I_d&&I_d.replaceDisplayByName(I_b,I_c),this._clearCache()}},I_a.replaceSlotSkinByIndex=function(I_a,I_b,I_c){if(0!=this._aniMode){var I_d=this.getSlotByName(I_a);I_d&&I_d.replaceDisplayByIndex(I_b,I_c),this._clearCache()}},I_a.setSlotSkin=function(I_a,I_b){if(0!=this._aniMode){var I_c=this.getSlotByName(I_a);I_c&&I_c.replaceSkin(I_b),this._clearCache()}},I_a._clearCache=function(){if(1==this._aniMode)for(var I_a=0,I_b=this._graphicsCache.length;I_a<I_b;I_a++){for(var I_c=0,I_d=this._graphicsCache[I_a].length;I_c<I_d;I_c++){var I_e=this._graphicsCache[I_a][I_c];I_e!=this.graphics&&I_J.recycle(I_e)}this._graphicsCache[I_a].length=0}},I_a.play=function(I_a,I_b,I_c,I_d,I_e,I_f){void 0===I_c&&(I_c=!0),void 0===I_d&&(I_d=0),void 0===I_e&&(I_e=0),void 0===I_f&&(I_f=!0),this._indexControl=!1;var I_g=-1,I_h=NaN;if(I_h=I_b?2147483647:0,"string"==typeof I_a)for(var I_i=0,I_j=this._templet.getAnimationCount();I_i<I_j;I_i++){var I_k=this._templet.getAnimation(I_i);if(I_k&&I_a==I_k.name){I_g=I_i;break}}else I_g=I_a;-1<I_g&&I_g<this.getAnimNum()&&(this._aniClipIndex=I_g,(I_c||this._pause||this._currAniIndex!=I_g)&&(this._currAniIndex=I_g,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(I_g)),this._drawOrder=null,this._eventIndex=0,this._player.play(I_g,this._player.playbackRate,I_h,I_d,I_e),I_f&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=I_l.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},I_a.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},I_a.playbackRate=function(I_a){this._player&&(this._player.playbackRate=I_a)},I_a.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},I_a.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=I_l.now(),this.timer.frameLoop(1,this,this._update,null,!0))},I_a._getGrahicsDataWithCache=function(I_a,I_b){return this._graphicsCache[I_a][I_b]},I_a._setGrahicsDataWithCache=function(I_a,I_b,I_c){this._graphicsCache[I_a][I_b]=I_c},I_a.destroy=function(I_a){void 0===I_a&&(I_a=!0),I_b.prototype.destroy.call(this,I_a),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},I_f(0,I_a,"url",function(){return this._aniPath},function(I_a){this.load(I_a)}),I_f(0,I_a,"index",function(){return this._index},function(I_a){this.player&&(this._index=I_a,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),I_f(0,I_a,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),I_f(0,I_a,"templet",function(){return this._templet}),I_f(0,I_a,"player",function(){return this._player}),I_c.useSimpleMeshInCanvas=!1,I_c}(I_fa),I_D=function(I_b){function I_e(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,I_e.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}I_d(I_e,"laya.ani.bone.Templet",I_b);var I_a=I_e.prototype;return I_a.getLoadList=function(){return this._loadList},I_a.loadAni=function(I_a){this._skBufferUrl=I_a,I_ea.loader.load(I_a,I_i.create(this,this.onComplete),null,"arraybuffer")},I_a.onComplete=function(I_a){if(this._isDestroyed)this.destroy();else{var I_b=I_j.getRes(this._skBufferUrl);I_b?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,I_b)):this.event("error","load failed:"+this._skBufferUrl)}},I_a.parseData=function(I_a,I_b,I_c){void 0===I_c&&(I_c=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=I_a,this._mainTexture&&I_s.isWebGL&&I_a.bitmap&&(I_a.bitmap.enableMerageInAtlas=!1),this._rate=I_c,this.parse(I_b)},I_a.buildArmature=function(I_a){return void 0===I_a&&(I_a=0),new I_C(this,I_a)},I_a.parse=function(I_a){I_b.prototype.parse.call(this,I_a),this._endLoaded(),this._aniVersion!=I_e.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+I_e.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},I_a._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var I_a=0;this._loadList=[];var I_b,I_c=new I_Fa(this.getPublicExtData()),I_d=0,I_e=0,I_f=0,I_g=I_c.getInt32(),I_h=I_c.readUTFString(),I_i=I_h.split("\n");for(I_a=0;I_a<I_g;I_a++)I_b=this._path+I_i[2*I_a],I_h=I_i[2*I_a+1],I_c.getFloat32(),I_c.getFloat32(),I_d=I_c.getFloat32(),I_e=I_c.getFloat32(),I_f=I_c.getFloat32(),isNaN(I_f)?0:I_f,I_f=I_c.getFloat32(),isNaN(I_f)?0:I_f,I_f=I_c.getFloat32(),isNaN(I_f)?I_d:I_f,I_f=I_c.getFloat32(),isNaN(I_f)?I_e:I_f,-1==this._loadList.indexOf(I_b)&&this._loadList.push(I_b);this.event("inited",this)}},I_a._textureComplete=function(){for(var I_a,I_b,I_c=0,I_d=this._loadList.length;I_c<I_d;I_c++)I_b=this._loadList[I_c],I_a=this._textureDic[I_b]=I_j.getRes(I_b),I_s.isWebGL&&I_a&&I_a.bitmap&&(I_a.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},I_a._parsePublicExtData=function(){var I_a=0,I_b=0,I_c=0,I_d=0,I_e=0;for(I_a=0,I_e=this.getAnimationCount();I_a<I_e;I_a++)this._graphicsCache.push([]);var I_f;I_f="Dragon"!=this._aniClassName;var I_g,I_h,I_i=new I_Fa(this.getPublicExtData()),I_j=0,I_k=0,I_l=0,I_m=0,I_n=0,I_o=0,I_p=0,I_s=0,I_t=0,I_u=I_i.getInt32(),I_v=I_i.readUTFString(),I_w=I_v.split("\n");for(I_a=0;I_a<I_u;I_a++){if(I_g=this._mainTexture,I_h=this._path+I_w[2*I_a],I_v=I_w[2*I_a+1],null==this._mainTexture&&(I_g=this._textureDic[I_h]),!I_g)return this.event("error",this),void(this.isParseFail=!0);I_j=I_i.getFloat32(),I_k=I_i.getFloat32(),I_l=I_i.getFloat32(),I_m=I_i.getFloat32(),I_t=I_i.getFloat32(),I_n=isNaN(I_t)?0:I_t,I_t=I_i.getFloat32(),I_o=isNaN(I_t)?0:I_t,I_t=I_i.getFloat32(),I_p=isNaN(I_t)?I_l:I_t,I_t=I_i.getFloat32(),I_s=isNaN(I_t)?I_m:I_t,this.subTextureDic[I_v]=I_Ha.create(I_g,I_j,I_k,I_l,I_m,-I_n,-I_o,I_p,I_s),I_g.alphaTexture&&(this.subTextureDic[I_v].alphaTexture=I_Ha.create(I_g.alphaTexture,I_j,I_k,I_l,I_m,-I_n,-I_o,I_p,I_s))}this._mainTexture=I_g;var I_x,I_y,I_z,I_A,I_B,I_C=I_i.getUint16();for(I_a=0;I_a<I_C;I_a++)(I_x=[]).push(I_i.getUint16()),I_x.push(I_i.getUint16()),I_x.push(I_i.getUint16()),I_x.push(I_i.getUint16()),this.aniSectionDic[I_a]=I_x;var I_D,I_E=I_i.getInt16(),I_F={};for(I_a=0;I_a<I_E;I_a++)I_y=new I_Ia,0==I_a?I_D=I_y:I_y.root=I_D,I_y.d=I_f?-1:1,I_A=I_i.readUTFString(),I_B=I_i.readUTFString(),I_y.length=I_i.getFloat32(),1==I_i.getByte()&&(I_y.inheritRotation=!1),1==I_i.getByte()&&(I_y.inheritScale=!1),I_y.name=I_A,I_B&&((I_z=I_F[I_B])?I_z.addChild(I_y):this.mRootBone=I_y),I_F[I_A]=I_y,this.mBoneArr.push(I_y);this.tMatrixDataLen=I_i.getUint16();var I_G,I_H,I_I=I_i.getUint16(),I_J=Math.floor(I_I/this.tMatrixDataLen),I_K=this.srcBoneMatrixArr;for(I_a=0;I_a<I_J;I_a++)(I_G=new I_Va).scX=I_i.getFloat32(),I_G.skX=I_i.getFloat32(),I_G.skY=I_i.getFloat32(),I_G.scY=I_i.getFloat32(),I_G.x=I_i.getFloat32(),I_G.y=I_i.getFloat32(),8===this.tMatrixDataLen&&(I_G.skewX=I_i.getFloat32(),I_G.skewY=I_i.getFloat32()),I_K.push(I_G),(I_y=this.mBoneArr[I_a]).transform=I_G;var I_L,I_M=I_i.getUint16(),I_N=0;for(I_a=0;I_a<I_M;I_a++){for(I_H=new I_Pa,I_N=I_i.getUint16(),I_b=0;I_b<I_N;I_b++)I_H.boneNames.push(I_i.readUTFString()),I_H.boneIndexs.push(I_i.getInt16());I_H.name=I_i.readUTFString(),I_H.targetBoneName=I_i.readUTFString(),I_H.targetBoneIndex=I_i.getInt16(),I_H.bendDirection=I_i.getFloat32(),I_H.mix=I_i.getFloat32(),I_H.isSpine=I_f,this.ikArr.push(I_H)}var I_O,I_P=I_i.getUint16(),I_Q=0;for(I_a=0;I_a<I_P;I_a++){for(I_L=new I_Ua,I_Q=I_i.getUint16(),I_b=0;I_b<I_Q;I_b++)I_L.boneIndexs.push(I_i.getInt16());I_L.name=I_i.getUTFString(),I_L.targetIndex=I_i.getInt16(),I_L.rotateMix=I_i.getFloat32(),I_L.translateMix=I_i.getFloat32(),I_L.scaleMix=I_i.getFloat32(),I_L.shearMix=I_i.getFloat32(),I_L.offsetRotation=I_i.getFloat32(),I_L.offsetX=I_i.getFloat32(),I_L.offsetY=I_i.getFloat32(),I_L.offsetScaleX=I_i.getFloat32(),I_L.offsetScaleY=I_i.getFloat32(),I_L.offsetShearY=I_i.getFloat32(),this.tfArr.push(I_L)}var I_R=I_i.getUint16(),I_S=0;for(I_a=0;I_a<I_R;I_a++){for((I_O=new I_Qa).name=I_i.readUTFString(),I_S=I_i.getUint16(),I_b=0;I_b<I_S;I_b++)I_O.bones.push(I_i.getInt16());I_O.target=I_i.readUTFString(),I_O.positionMode=I_i.readUTFString(),I_O.spacingMode=I_i.readUTFString(),I_O.rotateMode=I_i.readUTFString(),I_O.offsetRotation=I_i.getFloat32(),I_O.position=I_i.getFloat32(),I_O.spacing=I_i.getFloat32(),I_O.rotateMix=I_i.getFloat32(),I_O.translateMix=I_i.getFloat32(),this.pathArr.push(I_O)}var I_T,I_U,I_V,I_W,I_X,I_Y=0,I_Z=0,I_$=0,I__=NaN,I_q=0,I_r=I_i.getInt16();for(I_a=0;I_a<I_r;I_a++){var I_aa=I_i.getUint8(),I_ba={};this.deformAniArr.push(I_ba);for(var I_ca=0;I_ca<I_aa;I_ca++)for((I_T=new I_Ka).skinName=I_i.getUTFString(),I_ba[I_T.skinName]=I_T,I_Y=I_i.getInt16(),I_b=0;I_b<I_Y;I_b++)for(I_U=new I_La,I_T.deformSlotDataList.push(I_U),I_Z=I_i.getInt16(),I_c=0;I_c<I_Z;I_c++)for(I_V=new I_Ma,I_U.deformSlotDisplayList.push(I_V),I_V.slotIndex=I_i.getInt16(),I_V.attachment=I_i.getUTFString(),I_$=I_i.getInt16(),I_d=0;I_d<I_$;I_d++)for(1==I_i.getByte()?I_V.tweenKeyList.push(!0):I_V.tweenKeyList.push(!1),I__=I_i.getFloat32(),I_V.timeList.push(I__),I_W=[],I_V.vectices.push(I_W),I_q=I_i.getInt16(),I_e=0;I_e<I_q;I_e++)I_W.push(I_i.getFloat32())}var I_da,I_ea,I_fa=I_i.getInt16(),I_ga=0,I_ha=0;for(I_a=0;I_a<I_fa;I_a++){for(I_ga=I_i.getInt16(),I_X=[],I_b=0;I_b<I_ga;I_b++){for((I_da=new I_Na).time=I_i.getFloat32(),I_ha=I_i.getInt16(),I_c=0;I_c<I_ha;I_c++)I_da.drawOrder.push(I_i.getInt16());I_X.push(I_da)}this.drawOrderAniArr.push(I_X)}var I_ia,I_ja=I_i.getInt16(),I_ka=0;for(I_a=0;I_a<I_ja;I_a++){for(I_ka=I_i.getInt16(),I_ea=[],I_b=0;I_b<I_ka;I_b++)(I_ia=new I_Oa).name=I_i.getUTFString(),I_ia.intValue=I_i.getInt32(),I_ia.floatValue=I_i.getFloat32(),I_ia.stringValue=I_i.getUTFString(),I_ia.time=I_i.getFloat32(),I_ea.push(I_ia);this.eventAniArr.push(I_ea)}var I_la=I_i.getInt16();if(0<I_la)for(this.attachmentNames=[],I_a=0;I_a<I_la;I_a++)this.attachmentNames.push(I_i.getUTFString());var I_ma,I_na,I_oa=I_i.getInt16();for(I_a=0;I_a<I_oa;I_a++)(I_ma=new I_Ja).name=I_i.readUTFString(),I_ma.parent=I_i.readUTFString(),I_ma.attachmentName=I_i.readUTFString(),I_ma.srcDisplayIndex=I_ma.displayIndex=I_i.getInt16(),(I_ma.templet=this).boneSlotDic[I_ma.name]=I_ma,null==(I_na=this.bindBoneBoneSlotDic[I_ma.parent])&&(this.bindBoneBoneSlotDic[I_ma.parent]=I_na=[]),I_na.push(I_ma),this.boneSlotArray.push(I_ma);var I_pa,I_sa,I_ta,I_ua=I_i.readUTFString().split("\n"),I_va=0,I_wa=I_i.getUint8(),I_xa=0,I_ya=0,I_za=0,I_Aa=0,I_Ba=0,I_Ca=0,I_Da=0;for(I_a=0;I_a<I_wa;I_a++){for((I_pa=new I_Ra).name=I_ua[I_va++],I_xa=I_i.getUint8(),I_b=0;I_b<I_xa;I_b++){for((I_sa=new I_Ta).name=I_ua[I_va++],I_ma=this.boneSlotDic[I_sa.name],I_ya=I_i.getUint8(),I_c=0;I_c<I_ya;I_c++){if(I_ta=new I_Sa,this.skinSlotDisplayDataArr.push(I_ta),I_ta.name=I_ua[I_va++],I_ta.attachmentName=I_ua[I_va++],I_ta.transform=new I_Va,I_ta.transform.scX=I_i.getFloat32(),I_ta.transform.skX=I_i.getFloat32(),I_ta.transform.skY=I_i.getFloat32(),I_ta.transform.scY=I_i.getFloat32(),I_ta.transform.x=I_i.getFloat32(),I_ta.transform.y=I_i.getFloat32(),I_sa.displayArr.push(I_ta),I_ta.width=I_i.getFloat32(),I_ta.height=I_i.getFloat32(),I_ta.type=I_i.getUint8(),I_ta.verLen=I_i.getUint16(),0<(I_E=I_i.getUint16()))for(I_ta.bones=[],I_d=0;I_d<I_E;I_d++){var I_Ea=I_i.getUint16();I_ta.bones.push(I_Ea)}if(0<(I_za=I_i.getUint16()))for(I_ta.uvs=[],I_d=0;I_d<I_za;I_d++)I_ta.uvs.push(I_i.getFloat32());if(0<(I_Aa=I_i.getUint16()))for(I_ta.weights=[],I_d=0;I_d<I_Aa;I_d++)I_ta.weights.push(I_i.getFloat32());if(0<(I_Ba=I_i.getUint16()))for(I_ta.triangles=[],I_d=0;I_d<I_Ba;I_d++)I_ta.triangles.push(I_i.getUint16());if(0<(I_Ca=I_i.getUint16()))for(I_ta.vertices=[],I_d=0;I_d<I_Ca;I_d++)I_ta.vertices.push(I_i.getFloat32());if(0<(I_Da=I_i.getUint16()))for(I_ta.lengths=[],I_d=0;I_d<I_Da;I_d++)I_ta.lengths.push(I_i.getFloat32())}I_pa.slotArr.push(I_sa)}this.skinDic[I_pa.name]=I_pa,this.skinDataArray.push(I_pa)}1==I_i.getUint8()?(this.yReverseMatrix=new I_Ga(1,0,0,-1,0,0),I_D&&I_D.setTempMatrix(this.yReverseMatrix)):I_D&&I_D.setTempMatrix(new I_Ga),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},I_a.getTexture=function(I_a){var I_b=this.subTextureDic[I_a];return I_b||(I_b=this.subTextureDic[I_a.substr(0,I_a.length-1)]),null==I_b?this._mainTexture:I_b},I_a.showSkinByIndex=function(I_a,I_b,I_c){if(void 0===I_c&&(I_c=!0),I_b<0&&I_b>=this.skinDataArray.length)return!1;var I_d,I_e,I_f=0,I_g=0,I_h=this.skinDataArray[I_b];if(I_h){for(I_f=0,I_g=I_h.slotArr.length;I_f<I_g;I_f++)(I_e=I_h.slotArr[I_f])&&(I_d=I_a[I_e.name])&&(I_d.showSlotData(I_e,I_c),I_c&&"undefined"!=I_d.attachmentName&&"null"!=I_d.attachmentName?I_d.showDisplayByName(I_d.attachmentName):I_d.showDisplayByIndex(I_d.displayIndex));return!0}return!1},I_a.getSkinIndexByName=function(I_a){for(var I_b=0,I_c=this.skinDataArray.length;I_b<I_c;I_b++)if(this.skinDataArray[I_b].name==I_a)return I_b;return-1},I_a.getGrahicsDataWithCache=function(I_a,I_b){return this._graphicsCache[I_a][I_b]},I_a.setGrahicsDataWithCache=function(I_a,I_b,I_c){this._graphicsCache[I_a][I_b]=I_c},I_a.destroy=function(){var I_a;for(var I_b in this._isDestroyed=!0,this.subTextureDic)(I_a=this.subTextureDic[I_b])&&I_a.destroy();for(I_b in this._textureDic)(I_a=this._textureDic[I_b])&&I_a.destroy();for(var I_c=0,I_d=this.skinSlotDisplayDataArr.length;I_c<I_d;I_c++)this.skinSlotDisplayDataArr[I_c].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete I_e.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},I_a.getAniNameByIndex=function(I_a){var I_b=this.getAnimation(I_a);return I_b?I_b.name:null},I_f(0,I_a,"rate",function(){return this._rate},function(I_a){this._rate=I_a}),I_e.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",I_e.TEMPLET_DICTIONARY=null,I_e}(I_K)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(I_a,I_b){"use strict";for(var I_c in Object.defineProperty(I_b,"__esModule",{value:!0}),Laya){var I_d=Laya[I_c];I_d&&I_d.__isclass&&(I_b[I_c]=I_d)}});