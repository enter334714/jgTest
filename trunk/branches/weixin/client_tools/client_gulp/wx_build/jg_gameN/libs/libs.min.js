var Laya=window.Laya=function(M$j,M$a){var M$k={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(M$a,M$b){return 1==arguments.length?M$k.__presubstr.call(this,M$a):M$k.__presubstr.call(this,M$a,0<M$b?M$b:this.length+M$b)},__init:function(M$a){M$a.forEach(function(M$a){M$a.__init$&&M$a.__init$()})},__isClass:function(M$a){return M$a&&(M$a.__isclass||M$a==Object||M$a==String||M$a==Array)},__newvec:function(M$a,M$b){var M$c=[];M$c.length=M$a;for(var M$d=0;M$d<M$a;M$d++)M$c[M$d]=M$b;return M$c},__extend:function(M$a,M$b){for(var M$c in M$b)if(M$b.hasOwnProperty(M$c)){var M$d=Object.getOwnPropertyDescriptor(M$b,M$c),M$e=M$d.get,M$f=M$d.set;M$e||M$f?M$e&&M$f?Object.defineProperty(M$a,M$c,M$d):(M$e&&Object.defineProperty(M$a,M$c,M$e),M$f&&Object.defineProperty(M$a,M$c,M$f)):M$a[M$c]=M$b[M$c]}function M$g(){M$k.un(this,"constructor",M$a)}M$g.prototype=M$b.prototype,M$a.prototype=new M$g,M$k.un(M$a.prototype,"__imps",M$k.__copy({},M$b.prototype.__imps))},__copy:function(M$a,M$b){if(!M$b)return null;for(var M$c in M$a=M$a||{},M$b)M$a[M$c]=M$b[M$c];return M$a},__package:function(M$a,M$b){if(!M$k.__packages[M$a]){M$k.__packages[M$a]=!0;var M$c=M$j,M$d=M$a.split(".");if(1<M$d.length)for(var M$e=0,M$f=M$d.length-1;M$e<M$f;M$e++){var M$g=M$c[M$d[M$e]];M$c=M$g||(M$c[M$d[M$e]]={})}M$c[M$d[M$d.length-1]]||(M$c[M$d[M$d.length-1]]=M$b||{})}},__hasOwnProperty:function(M$a,M$b){return M$b=M$b||this,Object.hasOwnProperty.call(M$b,M$a)||function M$a(M$b,M$c){if(Object.hasOwnProperty.call(M$c.prototype,M$b))return!0;var M$d=M$c.prototype.__super;return null==M$d?null:M$a(M$b,M$d)}(M$a,M$b.__class)},__typeof:function(M$a,M$b){if(!M$a||!M$b)return!1;if(M$b===String)return"string"==typeof M$a;if(M$b===Number)return"number"==typeof M$a;if(M$b.__interface__)M$b=M$b.__interface__;else if("string"!=typeof M$b)return M$a instanceof M$b;return M$a.__imps&&M$a.__imps[M$b]||M$a.__class==M$b},__as:function(M$a,M$b){return this.__typeof(M$a,M$b)?M$a:null},__int:function(M$a){return M$a?parseInt(M$a):0},interface:function(M$a,M$b){M$k.__package(M$a,{});var M$c=M$k.__internals,M$d=M$c[M$a]=M$c[M$a]||{self:M$a};if(M$b){var M$e=M$b.split(",");M$d.extend=[];for(var M$f=0;M$f<M$e.length;M$f++){var M$g=M$e[M$f];M$c[M$g]=M$c[M$g]||{self:M$g},M$d.extend.push(M$c[M$g])}}var M$h=M$j,M$i=M$a.split(".");for(M$f=0;M$f<M$i.length-1;M$f++)M$h=M$h[M$i[M$f]];M$h[M$i[M$i.length-1]]={__interface__:M$a}},class:function(M$a,M$b,M$c,M$d){if(M$c&&M$k.__extend(M$a,M$c),M$b)if(M$k.__package(M$b,M$a),M$k.__classmap[M$b]=M$a,0<M$b.indexOf(".")){if(0==M$b.indexOf("laya.")){var M$e=M$b.split(".");M$d=M$d||M$e[M$e.length-1],M$k[M$d]&&console.log("Warning!,this class["+M$d+"] already exist:",M$k[M$d]),M$k[M$d]=M$a}}else"Main"==M$b?M$j.Main=M$a:"MainWX"==M$b?M$j.MainWX=M$a:(M$k[M$b]&&console.log("Error!,this class["+M$b+"] already exist:",M$k[M$b]),M$k[M$b]=M$a);var M$f=M$k.un,M$g=M$a.prototype;M$f(M$g,"hasOwnProperty",M$k.__hasOwnProperty),M$f(M$g,"__class",M$a),M$f(M$g,"__super",M$c),M$f(M$g,"__className",M$b),M$f(M$a,"__super",M$c),M$f(M$a,"__className",M$b),M$f(M$a,"__isclass",!0),M$f(M$a,"super",function(M$a){this.__super.call(M$a)})},imps:function(M$a,M$b){if(!M$b)return null;var M$e=M$a.__imps||M$k.un(M$a,"__imps",{});function M$f(M$a){var M$b,M$c;if((M$b=M$k.__internals[M$a])&&(M$e[M$a]=!0,M$c=M$b.extend))for(var M$d=0;M$d<M$c.length;M$d++)M$f(M$c[M$d].self)}for(var M$c in M$b)M$f(M$c)},superSet:function(M$a,M$b,M$c,M$d){var M$e=M$a.prototype["_$set_"+M$c];M$e&&M$e.call(M$b,M$d)},superGet:function(M$a,M$b,M$c){var M$d=M$a.prototype["_$get_"+M$c];return M$d?M$d.call(M$b):null},getset:function(M$a,M$b,M$c,M$d,M$e){M$a?(M$d&&(M$b["_$GET_"+M$c]=M$d),M$e&&(M$b["_$SET_"+M$c]=M$e)):(M$d&&M$k.un(M$b,"_$get_"+M$c,M$d),M$e&&M$k.un(M$b,"_$set_"+M$c,M$e)),M$d&&M$e?Object.defineProperty(M$b,M$c,{get:M$d,set:M$e,enumerable:!1,configurable:!0}):(M$d&&Object.defineProperty(M$b,M$c,{get:M$d,enumerable:!1,configurable:!0}),M$e&&Object.defineProperty(M$b,M$c,{set:M$e,enumerable:!1,configurable:!0}))},static:function(M$c,M$d){for(var M$e=0,M$a=M$d.length;M$e<M$a;M$e+=2)if("length"==M$d[M$e])M$c.length=M$d[M$e+1].call(M$c);else{function M$b(){var M$b=M$d[M$e],M$a=M$d[M$e+1];Object.defineProperty(M$c,M$b,{get:function(){return delete this[M$b],this[M$b]=M$a.call(this)},set:function(M$a){delete this[M$b],this[M$b]=M$a},enumerable:!0,configurable:!0})}M$b()}},un:function(M$a,M$b,M$c){return M$c||(M$c=M$a[M$b]),M$k.__propun.value=M$c,Object.defineProperty(M$a,M$b,M$k.__propun),M$c},uns:function(M$b,M$a){M$a.forEach(function(M$a){M$k.un(M$b,M$a)})}};return M$j.console=M$j.console||{log:function(){}},M$j.trace=M$j.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),M$k}(window,document);!function(M$a,M$b,M$c){M$c.un,M$c.uns,M$c.static,M$c.class,M$c.getset,M$c.__newvec}(window,document,Laya),function(M$g,M$b,M$x){M$x.un,M$x.uns;var M$i=M$x.static,M$k=M$x.class,M$o=M$x.getset;M$x.__newvec;M$x.interface("laya.runtime.IMarket"),M$x.interface("laya.filters.IFilter"),M$x.interface("laya.display.ILayout"),M$x.interface("laya.resource.IDispose"),M$x.interface("laya.runtime.IPlatform"),M$x.interface("laya.resource.IDestroy"),M$x.interface("laya.runtime.IConchNode"),M$x.interface("laya.filters.IFilterAction"),M$x.interface("laya.runtime.ICPlatformClass"),M$x.interface("laya.resource.ICreateResource"),M$x.interface("laya.runtime.IConchRenderObject"),M$x.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var M$F=function(){function M$f(){}return M$k(M$f,"laya.utils.RunDriver"),M$f.FILTER_ACTIONS=[],M$f.pixelRatio=-1,M$f._charSizeTestDiv=null,M$f.now=function(){return Date.now()},M$f.getWindow=function(){return M$g},M$f.getPixelRatio=function(){if(M$f.pixelRatio<0){var M$a=M$O.context,M$b=M$a.backingStorePixelRatio||M$a.webkitBackingStorePixelRatio||M$a.mozBackingStorePixelRatio||M$a.msBackingStorePixelRatio||M$a.oBackingStorePixelRatio||M$a.backingStorePixelRatio||1;(M$f.pixelRatio=(M$O.window.devicePixelRatio||1)/M$b)<1&&(M$f.pixelRatio=1)}return M$f.pixelRatio},M$f.getIncludeStr=function(M$a){return null},M$f.createShaderCondition=function(M$a){var M$b="(function() {return "+M$a+";})";return M$x._runScript(M$b)},M$f.fontMap=[],M$f.measureText=function(M$a,M$b){var M$c=M$f.hanzi.test(M$a);if(M$c&&M$f.fontMap[M$b])return M$f.fontMap[M$b];var M$d=M$O.context;M$d.font=M$b;var M$e=M$d.measureText(M$a);return M$c&&(M$f.fontMap[M$b]=M$e),M$e},M$f.getWebGLContext=function(M$a){},M$f.beginFlush=function(){},M$f.endFinish=function(){},M$f.addToAtlas=null,M$f.flashFlushImage=function(M$a){},M$f.drawToCanvas=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=M$ta.create("2D"),M$h=new M$K(M$c,M$d,M$g);return M$L.renders[M$b]._fun(M$a,M$h,M$e,M$f),M$g},M$f.createParticleTemplate2D=null,M$f.createGLTextur=null,M$f.createWebGLContext2D=null,M$f.changeWebGLSize=function(M$a,M$b){},M$f.createRenderSprite=function(M$a,M$b){return new M$L(M$a,M$b)},M$f.createFilterAction=function(M$a){return new M$t},M$f.createGraphics=function(){return new M$m},M$f.clear=function(M$a){M$J._context.ctx.clear()},M$f.cancelLoadByUrl=function(M$a){},M$f.clearAtlas=function(M$a){},M$f.isAtlas=function(M$a){return!1},M$f.addTextureToAtlas=function(M$a){},M$f.getTexturePixels=function(M$a,M$b,M$c,M$d,M$e){return null},M$f.skinAniSprite=function(){return null},M$f.update3DLoop=function(){},M$i(M$f,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),M$f}(),M$d=(M$o(1,M$x,"alertGlobalError",null,function(M$a){var M$f=0;M$O.window.onerror=M$a?function(M$a,M$b,M$c,M$d,M$e){M$f++<5&&M$e&&alert(M$e.stack||M$e)}:null}),M$x.init=function(M$a,M$b,M$c){for(var M$d=[],M$e=2,M$f=arguments.length;M$e<M$f;M$e++)M$d.push(arguments[M$e]);if(!M$x._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=M$x._arrayBufferSlice),M$x._isinit=!0,M$O.__init__(),M$M.__init__(),M$m.__init__(),M$x.timer=new M$Y,M$x.scaleTimer=new M$Y,M$x.loader=new M$ia,M$y.__init__(),M$e=0;for(var M$g=M$d.length;M$e<M$g;M$e++)M$d[M$e].enable&&M$d[M$e].enable();return M$n.__init__(),M$h.__init__(),M$N.__init__(),M$Q.beginCheck(),M$x._currentStage=M$x.stage=new M$ra,M$x.stage.conchModel&&M$x.stage.conchModel.setRootNode(),M$x._getUrlPath(),M$x.render=new M$J(0,0),M$x.stage.size(M$a,M$b),M$L.__init__(),M$l.__init__(),M$p.instance.__init__(M$x.stage,M$J.canvas),M$va.__init__(),M$E.autoStopMusic=!0,M$C.__init__(),M$J.canvas}},M$x._getUrlPath=function(){var M$a=M$O.window.location,M$b=M$a.pathname;M$b=M$b&&":"==M$b.charAt(2)?M$b.substring(1):M$b,M$I.rootPath=M$I.basePath=M$I.getPath("file:"==M$a.protocol?M$b:M$a.protocol+"//"+M$a.host+M$a.pathname)},M$x._arrayBufferSlice=function(M$a,M$b){var M$c=new Uint8Array(this,M$a,M$b-M$a),M$d=new Uint8Array(M$c.length);return M$d.set(M$c),M$d.buffer},M$x._runScript=function(M$a){return M$O.window[M$x._evcode](M$a)},M$x.stage=null,M$x.timer=null,M$x.scaleTimer=null,M$x.loader=null,M$x.version="1.8.6",M$x.render=null,M$x._currentStage=null,M$x._isinit=!1,M$x.isDebug=!1,M$x.MiniAdpter={init:function(){M$g.navigator&&M$g.navigator.userAgent&&-1<M$g.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},M$i(M$x,["conchMarket",function(){return this.conchMarket=M$g.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=M$g.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function M$a(){}return M$k(M$a,"Config"),M$a.WebGLTextCacheCount=500,M$a.atlasEnable=!1,M$a.showCanvasMark=!1,M$a.animationInterval=50,M$a.isAntialias=!1,M$a.isAlpha=!1,M$a.premultipliedAlpha=!0,M$a.isStencil=!0,M$a.preserveDrawingBuffer=!1,M$a}()),M$j=function(){function M$j(){this._events=null}M$k(M$j,"laya.events.EventDispatcher");var M$a=M$j.prototype;return M$a.hasListener=function(M$a){return!!(this._events&&this._events[M$a])},M$a.event=function(M$a,M$b){if(!this._events||!this._events[M$a])return!1;var M$c=this._events[M$a];if(M$c.lock)M$c.queue||(M$c.queue=[]),M$c.queue.push(M$b);else{var M$d;for(M$c.lock=!0,M$c.cursor=M$c.head;M$c.cursor;)M$d=M$c.cursor,M$c.cursor=M$d.next,M$d.once&&M$j.delNode(M$c,M$d),null!=M$b?M$d.args?M$d.method.apply(M$d.caller,M$d.args.concat(M$b)):M$b instanceof Array?M$d.method.apply(M$d.caller,M$b):M$d.method.call(M$d.caller,M$b):M$d.method.apply(M$d.caller,M$d.args),M$d.once&&M$j.recoverHandler(M$d);M$c.lock=!1,!M$c.head&&this._events&&this._events[M$a]==M$c&&delete this._events[M$a],M$c.queue&&M$c.queue.length&&this.event(M$a,M$c.queue.shift())}return!0},M$a.on=function(M$a,M$b,M$c,M$d){return this._createListener(M$a,M$b,M$c,M$d,!1)},M$a.once=function(M$a,M$b,M$c,M$d){return this._createListener(M$a,M$b,M$c,M$d,!0)},M$a._createListener=function(M$a,M$b,M$c,M$d,M$e,M$f){void 0===M$f&&(M$f=!0),M$f&&this.off(M$a,M$b,M$c,M$e);var M$g=M$j.createHandler(M$b||this,M$c,M$d,M$e);this._events||(this._events={});var M$h=this._events,M$i=M$h[M$a];return M$i?M$i.tail?(M$g.prev=M$i.tail,M$i.tail.next=M$g,M$i.tail=M$g):M$i.head=M$i.tail=M$g:M$h[M$a]={head:M$g,tail:M$g,cursor:null,lock:!1},this},M$a.off=function(M$a,M$b,M$c,M$d){if(void 0===M$d&&(M$d=!1),!this._events||!this._events[M$a])return this;for(var M$e=this._events[M$a],M$f=M$e.head;M$f;){if((!M$b||M$f.caller===M$b)&&M$f.method===M$c&&(!M$d||M$f.once)){M$j.delNode(M$e,M$f),M$e.cursor==M$f&&(M$e.cursor=M$f.next),M$j.recoverHandler(M$f);break}M$f=M$f.next}return this},M$a.offAll=function(M$a){var M$b=this._events;if(!M$b)return this;if(M$a)this._recoverHandlers(M$b[M$a]),delete M$b[M$a];else{for(var M$c in M$b)this._recoverHandlers(M$b[M$c]);this._events=null}return this},M$a._recoverHandlers=function(M$a){if(M$a){for(var M$b=M$a.head;M$b;){M$j.delNode(M$a,M$b);var M$c=M$b.next;M$j.recoverHandler(M$b),M$b=M$c}M$a.cursor=null}},M$a.isMouseEvent=function(M$a){return M$j.MOUSE_EVENTS[M$a]},M$j.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},M$j.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},M$j.delNode=function(M$a,M$b){M$b.prev?M$b.prev.next=M$b.next:M$a.head=M$b.next,M$b.next?M$b.next.prev=M$b.prev:M$a.tail=M$b.prev},M$j.createHandler=function(M$a,M$b,M$c,M$d){var M$e=M$j._freeHandler;return M$e?(M$j._freeCount--,M$j._freeHandler=M$e.next,M$e.caller=M$a,M$e.method=M$b,M$e.args=M$c,M$e.once=M$d):M$e={caller:M$a,method:M$b,args:M$c,once:M$d},M$e.prev=M$e.next=null,M$e},M$j.recoverHandler=function(M$a){M$a.caller=M$a.method=M$a.args=M$a.prev=null,M$a.next=M$j._freeHandler,M$j._freeHandler=M$a,M$j._freeCount++},M$j._freeHandler=null,M$j._freeCount=0,M$j}(),M$s=function(){function M$e(M$a,M$b,M$c,M$d){this.once=!1,void(this._id=0)===M$d&&(M$d=!1),this.setTo(M$a,M$b,M$c,M$d)}M$k(M$e,"laya.utils.Handler");var M$a=M$e.prototype;return M$a.setTo=function(M$a,M$b,M$c,M$d){return this._id=M$e._gid++,this.caller=M$a,this.method=M$b,this.args=M$c,this.once=M$d,this},M$a.run=function(){if(null==this.method)return null;var M$a=this._id,M$b=this.method.apply(this.caller,this.args);return this._id===M$a&&this.once&&this.recover(),M$b},M$a.runWith=function(M$a){if(null==this.method)return null;var M$b=this._id;if(null==M$a)var M$c=this.method.apply(this.caller,this.args);else M$c=this.args||M$a.unshift?this.args?this.method.apply(this.caller,this.args.concat(M$a)):this.method.apply(this.caller,M$a):this.method.call(this.caller,M$a);return this._id===M$b&&this.once&&this.recover(),M$c},M$a.clear=function(){return this.caller=null,this.method=null,this.args=null,this},M$a.recover=function(){0<this._id&&(this._id=0,this.clear())},M$e.create=function(M$a,M$b,M$c,M$d){return void 0===M$d&&(M$d=!0),new M$e(M$a,M$b,M$c,M$d)},M$e._gid=1,M$e}(),M$D=function(){function M$a(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}M$k(M$a,"laya.display.BitmapFont");var M$b=M$a.prototype;return M$b.loadFont=function(M$a,M$b){this._path=M$a,this._complete=M$b,M$x.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],M$s.create(this,this.onLoaded))},M$b.onLoaded=function(){this.parseFont(M$ha.getRes(this._path),M$ha.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},M$b.parseFont=function(M$a,M$b){if(null!=M$a&&null!=M$b){this._texture=M$b;var M$c=M$a.getElementsByTagName("info");if(!M$c[0].getAttributeNode)return this.parseFont2(M$a,M$b);this.fontSize=parseInt(M$c[0].getAttributeNode("size").nodeValue);var M$d,M$e=M$c[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(M$e[0]),parseInt(M$e[1]),parseInt(M$e[2]),parseInt(M$e[3])],M$d=M$a.getElementsByTagName("char");var M$f=0;for(M$f=0;M$f<M$d.length;M$f++){var M$g=M$d[M$f],M$h=parseInt(M$g.getAttributeNode("id").nodeValue),M$i=parseInt(M$g.getAttributeNode("xoffset").nodeValue)/1,M$j=parseInt(M$g.getAttributeNode("yoffset").nodeValue)/1,M$k=parseInt(M$g.getAttributeNode("xadvance").nodeValue)/1,M$l=new M$B;M$l.x=parseInt(M$g.getAttributeNode("x").nodeValue),M$l.y=parseInt(M$g.getAttributeNode("y").nodeValue),M$l.width=parseInt(M$g.getAttributeNode("width").nodeValue),M$l.height=parseInt(M$g.getAttributeNode("height").nodeValue);var M$m=M$ka.create(M$b,M$l.x,M$l.y,M$l.width,M$l.height,M$i,M$j);this._maxWidth=Math.max(this._maxWidth,M$k+this.letterSpacing),this._fontCharDic[M$h]=M$m,this._fontWidthMap[M$h]=M$k}}},M$b.parseFont2=function(M$a,M$b){if(null!=M$a&&null!=M$b){this._texture=M$b;var M$c=M$a.getElementsByTagName("info");this.fontSize=parseInt(M$c[0].attributes.size.nodeValue);var M$d=M$c[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(M$d[0]),parseInt(M$d[1]),parseInt(M$d[2]),parseInt(M$d[3])];var M$e=M$a.getElementsByTagName("char"),M$f=0;for(M$f=0;M$f<M$e.length;M$f++){var M$g=M$e[M$f].attributes,M$h=parseInt(M$g.id.nodeValue),M$i=parseInt(M$g.xoffset.nodeValue)/1,M$j=parseInt(M$g.yoffset.nodeValue)/1,M$k=parseInt(M$g.xadvance.nodeValue)/1,M$l=new M$B;M$l.x=parseInt(M$g.x.nodeValue),M$l.y=parseInt(M$g.y.nodeValue),M$l.width=parseInt(M$g.width.nodeValue),M$l.height=parseInt(M$g.height.nodeValue);var M$m=M$ka.create(M$b,M$l.x,M$l.y,M$l.width,M$l.height,M$i,M$j);this._maxWidth=Math.max(this._maxWidth,M$k+this.letterSpacing),this._fontCharDic[M$h]=M$m,this._fontWidthMap[M$h]=M$k}}},M$b.getCharTexture=function(M$a){return this._fontCharDic[M$a.charCodeAt(0)]},M$b.destroy=function(){if(this._texture){for(var M$a in this._fontCharDic){var M$b=this._fontCharDic[M$a];M$b&&M$b.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},M$b.setSpaceWidth=function(M$a){this._spaceWidth=M$a},M$b.getCharWidth=function(M$a){var M$b=M$a.charCodeAt(0);return this._fontWidthMap[M$b]?this._fontWidthMap[M$b]+this.letterSpacing:" "==M$a?this._spaceWidth+this.letterSpacing:0},M$b.getTextWidth=function(M$a){for(var M$b=0,M$c=0,M$d=M$a.length;M$c<M$d;M$c++)M$b+=this.getCharWidth(M$a.charAt(M$c));return M$b},M$b.getMaxWidth=function(){return this._maxWidth},M$b.getMaxHeight=function(){return this.fontSize},M$b.drawText=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g,M$h=this.getTextWidth(M$a),M$i=0;"center"===M$e&&(M$i=(M$f-M$h)/2),"right"===M$e&&(M$i=M$f-M$h);for(var M$j=0,M$k=0,M$l=M$a.length;M$k<M$l;M$k++)(M$g=this.getCharTexture(M$a.charAt(M$k)))&&(M$b.graphics.drawTexture(M$g,M$c+M$j+M$i,M$d),M$j+=this.getCharWidth(M$a.charAt(M$k)))},M$a}(),M$h=function(){function M$c(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=M$c._TF_EMPTY}M$k(M$c,"laya.display.css.Style");var M$a=M$c.prototype;return M$a.getTransform=function(){return this._tf},M$a.setTransform=function(M$a){this._tf="none"!==M$a&&M$a?M$a:M$c._TF_EMPTY},M$a.setTranslateX=function(M$a){this._tf===M$c._TF_EMPTY&&(this._tf=new M$e),this._tf.translateX=M$a},M$a.setTranslateY=function(M$a){this._tf===M$c._TF_EMPTY&&(this._tf=new M$e),this._tf.translateY=M$a},M$a.setScaleX=function(M$a){this._tf===M$c._TF_EMPTY&&(this._tf=new M$e),this._tf.scaleX=M$a},M$a.setScale=function(M$a,M$b){this._tf===M$c._TF_EMPTY&&(this._tf=new M$e),this._tf.scaleX=M$a,this._tf.scaleY=M$b},M$a.setScaleY=function(M$a){this._tf===M$c._TF_EMPTY&&(this._tf=new M$e),this._tf.scaleY=M$a},M$a.setRotate=function(M$a){this._tf===M$c._TF_EMPTY&&(this._tf=new M$e),this._tf.rotate=M$a},M$a.setSkewX=function(M$a){this._tf===M$c._TF_EMPTY&&(this._tf=new M$e),this._tf.skewX=M$a},M$a.setSkewY=function(M$a){this._tf===M$c._TF_EMPTY&&(this._tf=new M$e),this._tf.skewY=M$a},M$a.destroy=function(){this.scrollRect=null},M$a.render=function(M$a,M$b,M$c,M$d){},M$a.getCSSStyle=function(){return M$ba.EMPTY},M$a._enableLayout=function(){return!1},M$o(0,M$a,"scaleX",function(){return this._tf.scaleX},function(M$a){this.setScaleX(M$a)}),M$o(0,M$a,"transform",function(){return this.getTransform()},function(M$a){this.setTransform(M$a)}),M$o(0,M$a,"translateX",function(){return this._tf.translateX},function(M$a){this.setTranslateX(M$a)}),M$o(0,M$a,"translateY",function(){return this._tf.translateY},function(M$a){this.setTranslateY(M$a)}),M$o(0,M$a,"scaleY",function(){return this._tf.scaleY},function(M$a){this.setScaleY(M$a)}),M$o(0,M$a,"block",function(){return 0!=(1&this._type)}),M$o(0,M$a,"skewY",function(){return this._tf.skewY},function(M$a){this.setSkewY(M$a)}),M$o(0,M$a,"rotate",function(){return this._tf.rotate},function(M$a){this.setRotate(M$a)}),M$o(0,M$a,"skewX",function(){return this._tf.skewX},function(M$a){this.setSkewX(M$a)}),M$o(0,M$a,"paddingLeft",function(){return 0}),M$o(0,M$a,"paddingTop",function(){return 0}),M$o(0,M$a,"absolute",function(){return!0}),M$c.__init__=function(){M$c._TF_EMPTY=new M$e,M$c.EMPTY=new M$c},M$c.EMPTY=null,M$c._TF_EMPTY=null,M$c}(),M$n=function(){function M$b(M$a){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=M$S.create(M$b.defaultColor),this.family=M$b.defaultFamily,this.stroke=M$b._STROKE,this.size=M$b.defaultSize,M$a&&M$a!==M$b.EMPTY&&M$a.copyTo(this)}M$k(M$b,"laya.display.css.Font");var M$a=M$b.prototype;return M$a.set=function(M$a){this._text=null;for(var M$b=M$a.split(" "),M$c=0,M$d=M$b.length;M$c<M$d;M$c++){var M$e=M$b[M$c];switch(M$e){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<M$e.indexOf("px")&&(this.size=parseInt(M$e),this.family=M$b[M$c+1],M$c++)}},M$a.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},M$a.copyTo=function(M$a){M$a._type=this._type,M$a._text=this._text,M$a._weight=this._weight,M$a._color=this._color,M$a.family=this.family,M$a.stroke=this.stroke!=M$b._STROKE?this.stroke.slice():M$b._STROKE,M$a.indent=this.indent,M$a.size=this.size},M$o(0,M$a,"password",function(){return 0!=(1024&this._type)},function(M$a){M$a?this._type|=1024:this._type&=-1025}),M$o(0,M$a,"color",function(){return this._color.strColor},function(M$a){this._color=M$S.create(M$a)}),M$o(0,M$a,"italic",function(){return 0!=(512&this._type)},function(M$a){M$a?this._type|=512:this._type&=-513}),M$o(0,M$a,"bold",function(){return 0!=(2048&this._type)},function(M$a){M$a?this._type|=2048:this._type&=-2049}),M$o(0,M$a,"weight",function(){return""+this._weight},function(M$a){var M$b=0;switch(M$a){case"normal":break;case"bold":this.bold=!0,M$b=700;break;case"bolder":M$b=800;break;case"lighter":M$b=100;break;default:M$b=parseInt(M$a)}this._weight=M$b,this._text=null}),M$o(0,M$a,"decoration",function(){return this._decoration?this._decoration.value:null},function(M$a){var M$b=M$a.split(" ");switch(this._decoration||(this._decoration={}),M$b[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=M$b[0]}M$b[1]&&(this._decoration.color=M$S.create(M$b)),this._decoration.value=M$a}),M$b.__init__=function(){M$b.EMPTY=new M$b(null)},M$b.EMPTY=null,M$b.defaultColor="#000000",M$b.defaultSize=12,M$b.defaultFamily="Arial",M$b.defaultFont="12px Arial",M$b._STROKE=[0,"#000000"],M$b._ITALIC=512,M$b._PASSWORD=1024,M$b._BOLD=2048,M$b}(),M$e=function(){function M$a(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return M$k(M$a,"laya.display.css.TransformInfo"),M$a}(),M$m=function(){function M$l(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,M$J.isConchNode){this._nativeObj=new M$g._conchGraphics,this.id=this._nativeObj.conchID}}M$k(M$l,"laya.display.Graphics");var M$a=M$l.prototype;return M$a.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},M$a.clear=function(M$a){void 0===M$a&&(M$a=!1);var M$b=0,M$c=0;if(M$a){var M$d=this._one;if(this._cmds){for(M$c=this._cmds.length,M$b=0;M$b<M$c;M$b++)!(M$d=this._cmds[M$b])||M$d.callee!==M$J._context._drawTexture&&M$d.callee!==M$J._context._drawTextureWithTransform||(M$d[0]=null,M$l._cache.push(M$d));this._cmds.length=0}else M$d&&(!M$d||M$d.callee!==M$J._context._drawTexture&&M$d.callee!==M$J._context._drawTextureWithTransform||(M$d[0]=null,M$l._cache.push(M$d)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(M$b=0,M$c=this._vectorgraphArray.length;M$b<M$c;M$b++)M$_.getInstance().deleteShape(this._vectorgraphArray[M$b]);this._vectorgraphArray.length=0}},M$a._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},M$a._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new M$c,this._graphicBounds._graphics=this)},M$a._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},M$a._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},M$a.getBounds=function(M$a){return void 0===M$a&&(M$a=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(M$a)},M$a.getBoundPoints=function(M$a){return void 0===M$a&&(M$a=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(M$a)},M$a._addCmd=function(M$a){this._cmds=this._cmds||[],M$a.callee=M$a.shift(),this._cmds.push(M$a)},M$a.setFilters=function(M$a){this._saveToCmd(M$J._context._setFilters,M$a)},M$a.drawTexture=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){if(void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=0),void 0===M$e&&(M$e=0),void 0===M$g&&(M$g=1),!M$a||M$g<.01)return null;M$d||(M$d=M$a.sourceWidth),M$e||(M$e=M$a.sourceHeight),M$g=M$g<0?0:1<M$g?1:M$g;var M$h,M$i=!M$J.isWebGL&&(M$O.onFirefox||M$O.onEdge||M$O.onIE||M$O.onSafari)?.5:0,M$j=M$d/M$a.sourceWidth,M$k=M$e/M$a.sourceHeight;return M$d=M$a.width*M$j,M$e=M$a.height*M$k,M$a.loaded&&(M$d<=0||M$e<=0)?null:(M$b+=M$a.offsetX*M$j,M$c+=M$a.offsetY*M$k,this._sp&&(this._sp._renderType|=512),M$b-=M$i,M$c-=M$i,M$d+=2*M$i,M$e+=2*M$i,M$l._cache.length?((M$h=M$l._cache.pop())[0]=M$a,M$h[1]=M$b,M$h[2]=M$c,M$h[3]=M$d,M$h[4]=M$e,M$h[5]=M$f,M$h[6]=M$g):M$h=[M$a,M$b,M$c,M$d,M$e,M$f,M$g],M$h.callee=M$f||1!=M$g?M$J._context._drawTextureWithTransform:M$J._context._drawTexture,null!=this._one||M$f||1!=M$g?this._saveToCmd(M$h.callee,M$h):(this._one=M$h,this._render=this._renderOneImg),M$a.loaded||M$a.once("loaded",this,this._textureLoaded,[M$a,M$h]),this._repaint(),M$h)},M$a.cleanByTexture=function(M$a,M$b,M$c,M$d,M$e){if(void 0===M$d&&(M$d=0),void 0===M$e&&(M$e=0),!M$a)return this.clear();if(this._one&&this._render===this._renderOneImg){M$d||(M$d=M$a.sourceWidth),M$e||(M$e=M$a.sourceHeight);var M$f=M$d/M$a.sourceWidth,M$g=M$e/M$a.sourceHeight;M$d=M$a.width*M$f,M$e=M$a.height*M$g,M$b+=M$a.offsetX*M$f,M$c+=M$a.offsetY*M$g,this._one[0]=M$a,this._one[1]=M$b,this._one[2]=M$c,this._one[3]=M$d,this._one[4]=M$e,this._repaint()}else this.clear(),M$a&&this.drawTexture(M$a,M$b,M$c,M$d,M$e)},M$a.drawTextures=function(M$a,M$b){M$a&&this._saveToCmd(M$J._context._drawTextures,[M$a,M$b])},M$a.fillTexture=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){if(void 0===M$d&&(M$d=0),void 0===M$e&&(M$e=0),void 0===M$f&&(M$f="repeat"),M$a){var M$h=[M$a,M$b,M$c,M$d,M$e,M$f,M$g||M$A.EMPTY,{}];M$a.loaded||M$a.once("loaded",this,this._textureLoaded,[M$a,M$h]),this._saveToCmd(M$J._context._fillTexture,M$h)}},M$a._textureLoaded=function(M$a,M$b){M$b[3]=M$b[3]||M$a.width,M$b[4]=M$b[4]||M$a.height,this._repaint()},M$a.fillCircle=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){M$c.bitmap.enableMerageInAtlas=!1;var M$h=new Float32Array(2*(M$g+1)),M$i=new Float32Array(2*(M$g+1)),M$j=new Uint16Array(3*M$g),M$k=2*Math.PI/M$g,M$l=0;M$h[0]=M$d,M$h[1]=M$e,M$i[0]=M$d/M$c.width,M$i[1]=M$e/M$c.height;for(var M$m=2,M$n=0;M$n<M$g;M$n++){var M$o=M$f*Math.cos(M$l)+M$d,M$p=M$f*Math.sin(M$l)+M$e;M$h[M$m]=M$o,M$h[M$m+1]=M$p,M$i[M$m]=M$o/M$c.width,M$i[M$m+1]=M$p/M$c.height,M$l+=M$k,M$m+=2}for(M$n=M$m=0;M$n<M$g;M$n++)M$j[M$m++]=0,M$j[M$m++]=M$n+1,M$j[M$m++]=M$g+1<=M$n+2?1:M$n+2;this.drawTriangles(M$c,M$a,M$b,M$h,M$i,M$j)},M$a.drawTriangles=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){void 0===M$h&&(M$h=1),this._saveToCmd(M$J._context.drawTriangles,[M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j])},M$a._saveToCmd=function(M$a,M$b){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=M$b,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(M$b)),M$b.callee=M$a,this._repaint(),M$b},M$a.clipRect=function(M$a,M$b,M$c,M$d){this._saveToCmd(M$J._context._clipRect,[M$a,M$b,M$c,M$d])},M$a.fillText=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){void 0===M$g&&(M$g=0),this._saveToCmd(M$J._context._fillText,[M$a,M$b,M$c,M$d||M$n.defaultFont,M$e,M$f])},M$a.fillBorderText=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){this._saveToCmd(M$J._context._fillBorderText,[M$a,M$b,M$c,M$d||M$n.defaultFont,M$e,M$f,M$g,M$h])},M$a.strokeText=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this._saveToCmd(M$J._context._strokeText,[M$a,M$b,M$c,M$d||M$n.defaultFont,M$e,M$f,M$g])},M$a.alpha=function(M$a){M$a=M$a<0?0:1<M$a?1:M$a,this._saveToCmd(M$J._context._alpha,[M$a])},M$a.setAlpha=function(M$a){M$a=M$a<0?0:1<M$a?1:M$a,this._saveToCmd(M$J._context._setAlpha,[M$a])},M$a.transform=function(M$a,M$b,M$c){void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),this._saveToCmd(M$J._context._transform,[M$a,M$b,M$c])},M$a.rotate=function(M$a,M$b,M$c){void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),this._saveToCmd(M$J._context._rotate,[M$a,M$b,M$c])},M$a.scale=function(M$a,M$b,M$c,M$d){void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=0),this._saveToCmd(M$J._context._scale,[M$a,M$b,M$c,M$d])},M$a.translate=function(M$a,M$b){this._saveToCmd(M$J._context._translate,[M$a,M$b])},M$a.save=function(){this._saveToCmd(M$J._context._save,[])},M$a.restore=function(){this._saveToCmd(M$J._context._restore,[])},M$a.replaceText=function(M$a){this._repaint();var M$b=this._cmds;if(M$b){for(var M$c=M$b.length-1;-1<M$c;M$c--)if(this._isTextCmd(M$b[M$c].callee))return M$b[M$c][0].toUpperCase?M$b[M$c][0]=M$a:M$b[M$c][0].setText(M$a),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=M$a:this._one[0].setText(M$a),!0;return!1},M$a._isTextCmd=function(M$a){return M$a===M$J._context._fillText||M$a===M$J._context._fillBorderText||M$a===M$J._context._strokeText},M$a.replaceTextColor=function(M$a){this._repaint();var M$b=this._cmds;if(M$b)for(var M$c=M$b.length-1;-1<M$c;M$c--)this._isTextCmd(M$b[M$c].callee)&&(M$b[M$c][4]=M$a,M$b[M$c][0].toUpperCase||(M$b[M$c][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=M$a,this._one[0].toUpperCase||(this._one[0].changed=!0))},M$a.loadImage=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=this;void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=0),void 0===M$e&&(M$e=0);var M$h=M$ha.getRes(M$a);function M$i(M$a){M$a&&(M$g.drawTexture(M$a,M$b,M$c,M$d,M$e),null!=M$f&&M$f.call(M$g._sp,M$a))}M$h?M$i(M$h):M$x.loader.load(M$a,M$s.create(null,M$i),null,"image")},M$a._renderEmpty=function(M$a,M$b,M$c,M$d){},M$a._renderAll=function(M$a,M$b,M$c,M$d){for(var M$e,M$f=this._cmds,M$g=0,M$h=M$f.length;M$g<M$h;M$g++)(M$e=M$f[M$g]).callee.call(M$b,M$c,M$d,M$e)},M$a._renderOne=function(M$a,M$b,M$c,M$d){this._one.callee.call(M$b,M$c,M$d,this._one)},M$a._renderOneImg=function(M$a,M$b,M$c,M$d){this._one.callee.call(M$b,M$c,M$d,this._one),2305!==M$a._renderType&&(M$a._renderType|=1)},M$a.drawLine=function(M$a,M$b,M$c,M$d,M$e,M$f){void 0===M$f&&(M$f=1);var M$g=0;M$J.isWebGL&&(M$g=M$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(M$g));var M$h=M$f%2==0?0:.5,M$i=[M$a+M$h,M$b+M$h,M$c+M$h,M$d+M$h,M$e,M$f,M$g];this._saveToCmd(M$J._context._drawLine,M$i)},M$a.drawLines=function(M$a,M$b,M$c,M$d,M$e){void 0===M$e&&(M$e=1);var M$f=0;if(M$c&&!(M$c.length<4)){M$J.isWebGL&&(M$f=M$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(M$f));var M$g=M$e%2==0?0:.5,M$h=[M$a+M$g,M$b+M$g,M$c,M$d,M$e,M$f];this._saveToCmd(M$J._context._drawLines,M$h)}},M$a.drawCurves=function(M$a,M$b,M$c,M$d,M$e){void 0===M$e&&(M$e=1);var M$f=[M$a,M$b,M$c,M$d,M$e];this._saveToCmd(M$J._context._drawCurves,M$f)},M$a.drawRect=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){void 0===M$g&&(M$g=1);var M$h=M$f?M$g/2:0,M$i=M$f?M$g:0,M$j=[M$a+M$h,M$b+M$h,M$c-M$i,M$d-M$i,M$e,M$f,M$g];this._saveToCmd(M$J._context._drawRect,M$j)},M$a.drawCircle=function(M$a,M$b,M$c,M$d,M$e,M$f){void 0===M$f&&(M$f=1);var M$g=M$e?M$f/2:0,M$h=0;M$J.isWebGL&&(M$h=M$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(M$h));var M$i=[M$a,M$b,M$c-M$g,M$d,M$e,M$f,M$h];this._saveToCmd(M$J._context._drawCircle,M$i)},M$a.drawPie=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){void 0===M$h&&(M$h=1);var M$i=M$g?M$h/2:0,M$j=M$g?M$h:0,M$k=0;M$J.isWebGL&&(M$k=M$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(M$k));var M$l=[M$a+M$i,M$b+M$i,M$c-M$j,M$d,M$e,M$f,M$g,M$h,M$k];M$l[3]=M$$.toRadian(M$d),M$l[4]=M$$.toRadian(M$e),this._saveToCmd(M$J._context._drawPie,M$l)},M$a.drawPoly=function(M$a,M$b,M$c,M$d,M$e,M$f){void 0===M$f&&(M$f=1);var M$g=0,M$h=!1;M$J.isWebGL&&(M$g=M$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(M$g),M$h=!(6<M$c.length));var M$i=M$e?M$f%2==0?0:.5:0,M$j=[M$a+M$i,M$b+M$i,M$c,M$d,M$e,M$f,M$g,M$h];this._saveToCmd(M$J._context._drawPoly,M$j)},M$a.drawPath=function(M$a,M$b,M$c,M$d,M$e){var M$f=[M$a,M$b,M$c,M$d,M$e];this._saveToCmd(M$J._context._drawPath,M$f)},M$o(0,M$a,"cmds",function(){return this._cmds},function(M$a){this._sp&&(this._sp._renderType|=512),this._cmds=M$a,this._render=this._renderAll,this._repaint()}),M$l.__init__=function(){if(M$J.isConchNode){for(var M$a=laya.display.Graphics.prototype,M$b=M$O.window.ConchGraphics.prototype,M$c=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],M$d=0,M$e=M$c.length;M$d<=M$e;M$d++){var M$f=M$c[M$d];M$a[M$f]=M$b[M$f]}M$a._saveToCmd=null,M$b.drawImageS&&(M$a.drawTextures=function(M$a,M$b){if(M$a&&M$a.loaded&&M$a.bitmap&&M$a.source){var M$c=M$a.uv,M$d=M$a.bitmap.width,M$e=M$a.bitmap.height;this.drawImageS(M$a.bitmap.source,M$c[0]*M$d,M$c[1]*M$e,(M$c[2]-M$c[0])*M$d,(M$c[5]-M$c[3])*M$e,M$a.offsetX,M$a.offsetY,M$a.width,M$a.height,M$b)}}),M$a.drawTexture=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){if(void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=0),void 0===M$e&&(M$e=0),void 0===M$g&&(M$g=1),M$a)if(M$a.loaded){if(M$a.loaded&&M$a.bitmap&&M$a.source&&(M$d||(M$d=M$a.sourceWidth),M$e||(M$e=M$a.sourceHeight),M$g=M$g<0?0:1<M$g?1:M$g,M$d=M$d-M$a.sourceWidth+M$a.width,M$e=M$e-M$a.sourceHeight+M$a.height,!(M$d<=0||M$e<=0))){M$b+=M$a.offsetX,M$c+=M$a.offsetY;var M$h=M$a.uv,M$i=M$a.bitmap.width,M$j=M$a.bitmap.height;M$h[4]<M$h[0]&&M$h[5]<M$h[1]?this.drawImageM(M$a.bitmap.source,M$h[4]*M$i,M$h[5]*M$j,(M$h[0]-M$h[4])*M$i,(M$h[1]-M$h[5])*M$j,M$b,M$c,M$d,M$e,M$f,M$g):this.drawImageM(M$a.bitmap.source,M$h[0]*M$i,M$h[1]*M$j,(M$h[2]-M$h[0])*M$i,(M$h[5]-M$h[3])*M$j,M$b,M$c,M$d,M$e,M$f,M$g),this._repaint()}}else M$a.once("loaded",this,function(){this.drawTexture(M$a,M$b,M$c,M$d,M$e,M$f)})},M$a.fillTexture=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){if(void 0===M$d&&(M$d=0),void 0===M$e&&(M$e=0),void 0===M$f&&(M$f="repeat"),M$a&&M$a.loaded){var M$h,M$i=M$J._context.ctx,M$j=M$a.bitmap.width,M$k=M$a.bitmap.height,M$l=M$a.uv;M$h=M$a.uv!=M$ka.DEF_UV?M$i.createPattern(M$a.bitmap.source,M$f,M$l[0]*M$j,M$l[1]*M$k,(M$l[2]-M$l[0])*M$j,(M$l[5]-M$l[3])*M$k):M$i.createPattern(M$a.bitmap.source,M$f);var M$m=0,M$n=0;M$g&&(M$b+=M$g.x%M$a.width,M$c+=M$g.y%M$a.height,M$m-=M$g.x%M$a.width,M$n-=M$g.y%M$a.height),this._fillImage(M$h,M$b,M$c,M$m,M$n,M$d,M$e)}}}},M$l._cache=[],M$l}(),M$c=function(){function M$t(){this._cacheBoundsType=!1}M$k(M$t,"laya.display.GraphicsBounds");var M$a=M$t.prototype;return M$a.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},M$a.reset=function(){this._temp&&(this._temp.length=0)},M$a.getBounds=function(M$a){return void 0===M$a&&(M$a=!1),(!this._bounds||!this._temp||this._temp.length<1||M$a!=this._cacheBoundsType)&&(this._bounds=M$B._getWrapRec(this.getBoundPoints(M$a),this._bounds)),this._cacheBoundsType=M$a,this._bounds},M$a.getBoundPoints=function(M$a){return void 0===M$a&&(M$a=!1),(!this._temp||this._temp.length<1||M$a!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(M$a)),this._cacheBoundsType=M$a,this._rstBoundPoints=M$$.copyArray(this._rstBoundPoints,this._temp)},M$a._getCmdPoints=function(M$a){void 0===M$a&&(M$a=!1);var M$b,M$c,M$d=M$J._context,M$e=this._graphics.cmds;if((M$b=this._temp||(this._temp=[])).length=0,M$e||null==this._graphics._one||(M$t._tempCmds.length=0,M$t._tempCmds.push(this._graphics._one),M$e=M$t._tempCmds),!M$e)return M$b;(M$c=M$t._tempMatrixArrays).length=0;var M$f=M$t._initMatrix;M$f.identity();for(var M$g,M$h,M$i=M$t._tempMatrix,M$j=NaN,M$k=NaN,M$l=NaN,M$m=NaN,M$n=NaN,M$o=NaN,M$p=0,M$q=M$e.length;M$p<M$q;M$p++)if((M$g=M$e[M$p]).callee)switch(M$g.callee){case M$d._save:case 7:M$c.push(M$f),M$f=M$f.clone();break;case M$d._restore:case 8:M$f=M$c.pop();break;case M$d._scale:case 5:M$i.identity(),M$i.translate(-M$g[2],-M$g[3]),M$i.scale(M$g[0],M$g[1]),M$i.translate(M$g[2],M$g[3]),this._switchMatrix(M$f,M$i);break;case M$d._rotate:case 3:M$i.identity(),M$i.translate(-M$g[1],-M$g[2]),M$i.rotate(M$g[0]),M$i.translate(M$g[1],M$g[2]),this._switchMatrix(M$f,M$i);break;case M$d._translate:case 6:M$i.identity(),M$i.translate(M$g[0],M$g[1]),this._switchMatrix(M$f,M$i);break;case M$d._transform:case 4:M$i.identity(),M$i.translate(-M$g[1],-M$g[2]),M$i.concat(M$g[0]),M$i.translate(M$g[1],M$g[2]),this._switchMatrix(M$f,M$i);break;case 16:case 24:M$t._addPointArrToRst(M$b,M$B._getBoundPointS(M$g[0],M$g[1],M$g[2],M$g[3]),M$f);break;case 17:M$f.copyTo(M$i),M$i.concat(M$g[4]),M$t._addPointArrToRst(M$b,M$B._getBoundPointS(M$g[0],M$g[1],M$g[2],M$g[3]),M$i);break;case M$d._drawTexture:M$h=M$g[0],M$a?M$g[3]&&M$g[4]?M$t._addPointArrToRst(M$b,M$B._getBoundPointS(M$g[1],M$g[2],M$g[3],M$g[4]),M$f):(M$h=M$g[0],M$t._addPointArrToRst(M$b,M$B._getBoundPointS(M$g[1],M$g[2],M$h.width,M$h.height),M$f)):(M$j=(M$g[3]||M$h.sourceWidth)/M$h.width,M$k=(M$g[4]||M$h.sourceHeight)/M$h.height,M$l=M$j*M$h.sourceWidth,M$m=M$k*M$h.sourceHeight,M$n=0<M$h.offsetX?M$h.offsetX:0,M$o=0<M$h.offsetY?M$h.offsetY:0,M$n*=M$j,M$o*=M$k,M$t._addPointArrToRst(M$b,M$B._getBoundPointS(M$g[1]-M$n,M$g[2]-M$o,M$l,M$m),M$f));break;case M$d._fillTexture:M$g[3]&&M$g[4]?M$t._addPointArrToRst(M$b,M$B._getBoundPointS(M$g[1],M$g[2],M$g[3],M$g[4]),M$f):(M$h=M$g[0],M$t._addPointArrToRst(M$b,M$B._getBoundPointS(M$g[1],M$g[2],M$h.width,M$h.height),M$f));break;case M$d._drawTextureWithTransform:var M$r;M$r=M$g[5]?(M$f.copyTo(M$i),M$i.concat(M$g[5]),M$i):M$f,M$a?M$g[3]&&M$g[4]?M$t._addPointArrToRst(M$b,M$B._getBoundPointS(M$g[1],M$g[2],M$g[3],M$g[4]),M$r):(M$h=M$g[0],M$t._addPointArrToRst(M$b,M$B._getBoundPointS(M$g[1],M$g[2],M$h.width,M$h.height),M$r)):(M$h=M$g[0],M$j=(M$g[3]||M$h.sourceWidth)/M$h.width,M$k=(M$g[4]||M$h.sourceHeight)/M$h.height,M$l=M$j*M$h.sourceWidth,M$m=M$k*M$h.sourceHeight,M$n=0<M$h.offsetX?M$h.offsetX:0,M$o=0<M$h.offsetY?M$h.offsetY:0,M$n*=M$j,M$o*=M$k,M$t._addPointArrToRst(M$b,M$B._getBoundPointS(M$g[1]-M$n,M$g[2]-M$o,M$l,M$m),M$r));break;case M$d._drawRect:case 13:M$t._addPointArrToRst(M$b,M$B._getBoundPointS(M$g[0],M$g[1],M$g[2],M$g[3]),M$f);break;case M$d._drawCircle:case M$d._fillCircle:case 14:M$t._addPointArrToRst(M$b,M$B._getBoundPointS(M$g[0]-M$g[2],M$g[1]-M$g[2],M$g[2]+M$g[2],M$g[2]+M$g[2]),M$f);break;case M$d._drawLine:case 20:M$t._tempPoints.length=0;var M$s;M$s=.5*M$g[5],M$g[0]==M$g[2]?M$t._tempPoints.push(M$g[0]+M$s,M$g[1],M$g[2]+M$s,M$g[3],M$g[0]-M$s,M$g[1],M$g[2]-M$s,M$g[3]):M$g[1]==M$g[3]?M$t._tempPoints.push(M$g[0],M$g[1]+M$s,M$g[2],M$g[3]+M$s,M$g[0],M$g[1]-M$s,M$g[2],M$g[3]-M$s):M$t._tempPoints.push(M$g[0],M$g[1],M$g[2],M$g[3]),M$t._addPointArrToRst(M$b,M$t._tempPoints,M$f);break;case M$d._drawCurves:case 22:M$t._addPointArrToRst(M$b,M$u.I.getBezierPoints(M$g[2]),M$f,M$g[0],M$g[1]);break;case M$d._drawPoly:case M$d._drawLines:case 18:M$t._addPointArrToRst(M$b,M$g[2],M$f,M$g[0],M$g[1]);break;case M$d._drawPath:case 19:M$t._addPointArrToRst(M$b,this._getPathPoints(M$g[2]),M$f,M$g[0],M$g[1]);break;case M$d._drawPie:case 15:M$t._addPointArrToRst(M$b,this._getPiePoints(M$g[0],M$g[1],M$g[2],M$g[3],M$g[4]),M$f)}return 200<M$b.length?M$b=M$$.copyArray(M$b,M$B._getWrapRec(M$b)._getBoundPoints()):8<M$b.length&&(M$b=M$v.scanPList(M$b)),M$b},M$a._switchMatrix=function(M$a,M$b){M$b.concat(M$a),M$b.copyTo(M$a)},M$a._getPiePoints=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$t._tempPoints;M$t._tempPoints.length=0,M$f.push(M$a,M$b);var M$g=(M$e-M$d)%(2*Math.PI)/10,M$h=NaN,M$i=M$d;for(M$h=0;M$h<=10;M$h++)M$f.push(M$a+M$c*Math.cos(M$i),M$b+M$c*Math.sin(M$i)),M$i+=M$g;return M$f},M$a._getPathPoints=function(M$a){var M$b,M$c,M$d=0,M$e=M$t._tempPoints;for(M$e.length=0,M$b=M$a.length,M$d=0;M$d<M$b;M$d++)1<(M$c=M$a[M$d]).length&&(M$e.push(M$c[1],M$c[2]),3<M$c.length&&M$e.push(M$c[3],M$c[4]));return M$e},M$t._addPointArrToRst=function(M$a,M$b,M$c,M$d,M$e){void 0===M$d&&(M$d=0),void 0===M$e&&(M$e=0);var M$f,M$g=0;for(M$f=M$b.length,M$g=0;M$g<M$f;M$g+=2)M$t._addPointToRst(M$a,M$b[M$g]+M$d,M$b[M$g+1]+M$e,M$c)},M$t._addPointToRst=function(M$a,M$b,M$c,M$d){var M$e=M$A.TEMP;M$e.setTo(M$b||0,M$c||0),M$d.transformPoint(M$e),M$a.push(M$e.x,M$e.y)},M$t._tempPoints=[],M$t._tempMatrixArrays=[],M$t._tempCmds=[],M$i(M$t,["_tempMatrix",function(){return this._tempMatrix=new M$G},"_initMatrix",function(){return this._initMatrix=new M$G}]),M$t}(),M$f=function(){function M$a(){}M$k(M$a,"laya.events.Event");var M$b=M$a.prototype;return M$b.setTo=function(M$a,M$b,M$c){return this.type=M$a,this.currentTarget=M$b,this.target=M$c,this},M$b.stopPropagation=function(){this._stoped=!0},M$o(0,M$b,"stageY",function(){return M$x.stage.mouseY}),M$o(0,M$b,"charCode",function(){return this.nativeEvent.charCode}),M$o(0,M$b,"touches",function(){var M$a=this.nativeEvent.touches;if(M$a)for(var M$b=M$x.stage,M$c=0,M$d=M$a.length;M$c<M$d;M$c++){var M$e=M$a[M$c],M$f=M$A.TEMP;M$f.setTo(M$e.clientX,M$e.clientY),M$b._canvasTransform.invertTransformPoint(M$f),M$b.transform.invertTransformPoint(M$f),M$e.stageX=M$f.x,M$e.stageY=M$f.y}return M$a}),M$o(0,M$b,"keyLocation",function(){return this.nativeEvent.keyLocation}),M$o(0,M$b,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),M$o(0,M$b,"altKey",function(){return this.nativeEvent.altKey}),M$o(0,M$b,"shiftKey",function(){return this.nativeEvent.shiftKey}),M$o(0,M$b,"stageX",function(){return M$x.stage.mouseX}),M$a.EMPTY=new M$a,M$a.MOUSE_DOWN="mousedown",M$a.MOUSE_UP="mouseup",M$a.CLICK="click",M$a.RIGHT_MOUSE_DOWN="rightmousedown",M$a.RIGHT_MOUSE_UP="rightmouseup",M$a.RIGHT_CLICK="rightclick",M$a.MOUSE_MOVE="mousemove",M$a.MOUSE_OVER="mouseover",M$a.MOUSE_OUT="mouseout",M$a.MOUSE_WHEEL="mousewheel",M$a.ROLL_OVER="mouseover",M$a.ROLL_OUT="mouseout",M$a.DOUBLE_CLICK="doubleclick",M$a.CHANGE="change",M$a.CHANGED="changed",M$a.RESIZE="resize",M$a.ADDED="added",M$a.REMOVED="removed",M$a.DISPLAY="display",M$a.UNDISPLAY="undisplay",M$a.ERROR="error",M$a.COMPLETE="complete",M$a.LOADED="loaded",M$a.INITED="inited",M$a.PROGRESS="progress",M$a.INPUT="input",M$a.RENDER="render",M$a.OPEN="open",M$a.MESSAGE="message",M$a.CLOSE="close",M$a.KEY_DOWN="keydown",M$a.KEY_PRESS="keypress",M$a.KEY_UP="keyup",M$a.FRAME="enterframe",M$a.DRAG_START="dragstart",M$a.DRAG_MOVE="dragmove",M$a.DRAG_END="dragend",M$a.ENTER="enter",M$a.SELECT="select",M$a.BLUR="blur",M$a.FOCUS="focus",M$a.VISIBILITY_CHANGE="visibilitychange",M$a.FOCUS_CHANGE="focuschange",M$a.PLAYED="played",M$a.PAUSED="paused",M$a.STOPPED="stopped",M$a.START="start",M$a.END="end",M$a.ENABLE_CHANGED="enablechanged",M$a.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",M$a.COMPONENT_ADDED="componentadded",M$a.COMPONENT_REMOVED="componentremoved",M$a.LAYER_CHANGED="layerchanged",M$a.HIERARCHY_LOADED="hierarchyloaded",M$a.RECOVERED="recovered",M$a.RELEASED="released",M$a.LINK="link",M$a.LABEL="label",M$a.FULL_SCREEN_CHANGE="fullscreenchange",M$a.DEVICE_LOST="devicelost",M$a.MESH_CHANGED="meshchanged",M$a.MATERIAL_CHANGED="materialchanged",M$a.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",M$a.ANIMATION_CHANGED="animationchanged",M$a.TRIGGER_ENTER="triggerenter",M$a.TRIGGER_STAY="triggerstay",M$a.TRIGGER_EXIT="triggerexit",M$a.TRAIL_FILTER_CHANGE="trailfilterchange",M$a.DOMINO_FILTER_CHANGE="dominofilterchange",M$a}(),M$l=(function(){function M$a(){}M$k(M$a,"laya.events.Keyboard"),M$a.NUMBER_0=48,M$a.NUMBER_1=49,M$a.NUMBER_2=50,M$a.NUMBER_3=51,M$a.NUMBER_4=52,M$a.NUMBER_5=53,M$a.NUMBER_6=54,M$a.NUMBER_7=55,M$a.NUMBER_8=56,M$a.NUMBER_9=57,M$a.A=65,M$a.B=66,M$a.C=67,M$a.D=68,M$a.E=69,M$a.F=70,M$a.G=71,M$a.H=72,M$a.I=73,M$a.J=74,M$a.K=75,M$a.L=76,M$a.M=77,M$a.N=78,M$a.O=79,M$a.P=80,M$a.Q=81,M$a.R=82,M$a.S=83,M$a.T=84,M$a.U=85,M$a.V=86,M$a.W=87,M$a.X=88,M$a.Y=89,M$a.Z=90,M$a.F1=112,M$a.F2=113,M$a.F3=114,M$a.F4=115,M$a.F5=116,M$a.F6=117,M$a.F7=118,M$a.F8=119,M$a.F9=120,M$a.F10=121,M$a.F11=122,M$a.F12=123,M$a.F13=124,M$a.F14=125,M$a.F15=126,M$a.NUMPAD=21,M$a.NUMPAD_0=96,M$a.NUMPAD_1=97,M$a.NUMPAD_2=98,M$a.NUMPAD_3=99,M$a.NUMPAD_4=100,M$a.NUMPAD_5=101,M$a.NUMPAD_6=102,M$a.NUMPAD_7=103,M$a.NUMPAD_8=104,M$a.NUMPAD_9=105,M$a.NUMPAD_ADD=107,M$a.NUMPAD_DECIMAL=110,M$a.NUMPAD_DIVIDE=111,M$a.NUMPAD_ENTER=108,M$a.NUMPAD_MULTIPLY=106,M$a.NUMPAD_SUBTRACT=109,M$a.SEMICOLON=186,M$a.EQUAL=187,M$a.COMMA=188,M$a.MINUS=189,M$a.PERIOD=190,M$a.SLASH=191,M$a.BACKQUOTE=192,M$a.LEFTBRACKET=219,M$a.BACKSLASH=220,M$a.RIGHTBRACKET=221,M$a.QUOTE=222,M$a.ALTERNATE=18,M$a.BACKSPACE=8,M$a.CAPS_LOCK=20,M$a.COMMAND=15,M$a.CONTROL=17,M$a.DELETE=46,M$a.ENTER=13,M$a.ESCAPE=27,M$a.PAGE_UP=33,M$a.PAGE_DOWN=34,M$a.END=35,M$a.HOME=36,M$a.LEFT=37,M$a.UP=38,M$a.RIGHT=39,M$a.DOWN=40,M$a.SHIFT=16,M$a.SPACE=32,M$a.TAB=9,M$a.INSERT=45}(),function(){function M$e(){}return M$k(M$e,"laya.events.KeyBoardManager"),M$e.__init__=function(){M$e._addEvent("keydown"),M$e._addEvent("keypress"),M$e._addEvent("keyup")},M$e._addEvent=function(M$b){M$O.document.addEventListener(M$b,function(M$a){laya.events.KeyBoardManager._dispatch(M$a,M$b)},!0)},M$e._dispatch=function(M$a,M$b){if(M$e.enabled){M$e._event._stoped=!1,M$e._event.nativeEvent=M$a,M$e._event.keyCode=M$a.keyCode||M$a.which||M$a.charCode,"keydown"===M$b?M$e._pressKeys[M$e._event.keyCode]=!0:"keyup"===M$b&&(M$e._pressKeys[M$e._event.keyCode]=null);for(var M$c=M$x.stage.focus&&null!=M$x.stage.focus.event&&M$x.stage.focus.displayedInStage?M$x.stage.focus:M$x.stage,M$d=M$c;M$d;)M$d.event(M$b,M$e._event.setTo(M$b,M$d,M$c)),M$d=M$d.parent}},M$e.hasKeyDown=function(M$a){return M$e._pressKeys[M$a]},M$e._pressKeys={},M$e.enabled=!0,M$i(M$e,["_event",function(){return this._event=new M$f}]),M$e}()),M$p=(function(){function M$a(){}M$k(M$a,"laya.events.KeyLocation"),M$a.STANDARD=0,M$a.LEFT=1,M$a.RIGHT=2,M$a.NUM_PAD=3}(),function(){function M$j(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=M$O.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new M$f,this._matrix=new M$G,this._point=new M$A,this._rect=new M$B,this._prePoint=new M$A,this._curTouchID=NaN}M$k(M$j,"laya.events.MouseManager");var M$a=M$j.prototype;return M$a.__init__=function(M$a,M$b){var M$c=this;this._stage=M$a;var M$d=this,M$e=this._eventList;M$b.oncontextmenu=function(M$a){if(M$j.enabled)return!1},M$b.addEventListener("mousedown",function(M$a){M$j.enabled&&(M$O.onIE||M$a.preventDefault(),M$e.push(M$a),M$d.mouseDownTime=M$O.now())}),M$b.addEventListener("mouseup",function(M$a){M$j.enabled&&(M$a.preventDefault(),M$e.push(M$a),M$d.mouseDownTime=-M$O.now())},!0),M$b.addEventListener("mousemove",function(M$a){if(M$j.enabled){M$a.preventDefault();var M$b=M$O.now();if(M$b-M$d._lastMoveTimer<10)return;M$d._lastMoveTimer=M$b,M$e.push(M$a)}},!0),M$b.addEventListener("mouseout",function(M$a){M$j.enabled&&M$e.push(M$a)}),M$b.addEventListener("mouseover",function(M$a){M$j.enabled&&M$e.push(M$a)}),M$b.addEventListener("touchstart",function(M$a){M$j.enabled&&(M$e.push(M$a),M$j._isFirstTouch||M$va.isInputting||M$a.preventDefault(),M$d.mouseDownTime=M$O.now())}),M$b.addEventListener("touchend",function(M$a){M$j.enabled?(M$j._isFirstTouch||M$va.isInputting||M$a.preventDefault(),M$j._isFirstTouch=!1,M$e.push(M$a),M$d.mouseDownTime=-M$O.now()):M$c._curTouchID=NaN},!0),M$b.addEventListener("touchmove",function(M$a){M$j.enabled&&(M$a.preventDefault(),M$e.push(M$a))},!0),M$b.addEventListener("touchcancel",function(M$a){M$j.enabled?(M$a.preventDefault(),M$e.push(M$a)):M$c._curTouchID=NaN},!0),M$b.addEventListener("mousewheel",function(M$a){M$j.enabled&&M$e.push(M$a)}),M$b.addEventListener("DOMMouseScroll",function(M$a){M$j.enabled&&M$e.push(M$a)})},M$a.initEvent=function(M$a,M$b){var M$c;this._event._stoped=!1,this._event.nativeEvent=M$b||M$a,this._target=null,this._point.setTo(M$a.pageX||M$a.clientX,M$a.pageY||M$a.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=M$a.identifier||0,this._tTouchID=this._event.touchId,(M$c=M$q.I._event)._stoped=!1,M$c.nativeEvent=this._event.nativeEvent,M$c.touchId=this._event.touchId},M$a.checkMouseWheel=function(M$a){this._event.delta=M$a.wheelDelta?.025*M$a.wheelDelta:-M$a.detail;for(var M$b=M$q.I.getLastOvers(),M$c=0,M$d=M$b.length;M$c<M$d;M$c++){var M$e=M$b[M$c];M$e.event("mousewheel",this._event.setTo("mousewheel",M$e,this._target))}},M$a.onMouseMove=function(M$a){M$q.I.onMouseMove(M$a,this._tTouchID)},M$a.onMouseDown=function(M$a){if(M$va.isInputting&&M$x.stage.focus&&M$x.stage.focus.focus&&!M$x.stage.focus.contains(this._target)){var M$b=M$x.stage.focus._tf||M$x.stage.focus,M$c=M$a._tf||M$a;M$c instanceof laya.display.Input&&M$c.multiline==M$b.multiline?M$b._focusOut():M$b.focus=!1}M$q.I.onMouseDown(M$a,this._tTouchID,this._isLeftMouse)},M$a.onMouseUp=function(M$a){M$q.I.onMouseUp(M$a,this._tTouchID,this._isLeftMouse)},M$a.check=function(M$a,M$b,M$c,M$d){this._point.setTo(M$b,M$c),M$a.fromParentPoint(this._point),M$b=this._point.x,M$c=this._point.y;var M$e=M$a.scrollRect;if(M$e&&(this._rect.setTo(M$e.x,M$e.y,M$e.width,M$e.height),!this._rect.contains(M$b,M$c)))return!1;if(!this.disableMouseEvent){if(M$a.hitTestPrior&&!M$a.mouseThrough&&!this.hitTest(M$a,M$b,M$c))return!1;for(var M$f=M$a._childs.length-1;-1<M$f;M$f--){var M$g=M$a._childs[M$f];if(!M$g.destroyed&&M$g.mouseEnabled&&M$g.visible&&this.check(M$g,M$b,M$c,M$d))return!0}}var M$h=!(!M$a.hitTestPrior||M$a.mouseThrough||this.disableMouseEvent)||this.hitTest(M$a,M$b,M$c);return M$h?(this._target=M$a,M$d.call(this,M$a)):M$d===this.onMouseUp&&M$a===this._stage&&(this._target=this._stage,M$d.call(this,this._target)),M$h},M$a.hitTest=function(M$a,M$b,M$c){var M$d=!1;if(M$a.scrollRect&&(M$b-=M$a.scrollRect.x,M$c-=M$a.scrollRect.y),M$a.hitArea instanceof laya.utils.HitArea)return M$a.hitArea.isHit(M$b,M$c);if(0<M$a.width&&0<M$a.height||M$a.mouseThrough||M$a.hitArea)if(M$a.mouseThrough)M$d=M$a.getGraphicBounds().contains(M$b,M$c);else{var M$e=this._rect;M$a.hitArea?M$e=M$a.hitArea:M$e.setTo(0,0,M$a.width,M$a.height),M$d=M$e.contains(M$b,M$c)}return M$d},M$a.runEvent=function(){var M$a=this._eventList.length;if(M$a){this.mouseEventTime=M$O.now();var M$b,M$c=0,M$d=0,M$e=0;try{for(;M$c<M$a;){var M$f=this._eventList[M$c];switch("mousemove"!==M$f.type&&(this._prePoint.x=this._prePoint.y=-1e6),M$f.type){case"mousedown":this._touchIDs[0]=this._id++,M$j._isTouchRespond?M$j._isTouchRespond=!1:(this._isLeftMouse=0===M$f.button,this.initEvent(M$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===M$f.button,this.initEvent(M$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-M$f.clientX)+Math.abs(this._prePoint.y-M$f.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=M$f.clientX,this._prePoint.y=M$f.clientY,this.initEvent(M$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":M$j._isTouchRespond=!0,this._isLeftMouse=!0;var M$g=M$f.changedTouches;for(M$d=0,M$e=M$g.length;M$d<M$e;M$d++)M$b=M$g[M$d],(M$j.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=M$b.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[M$b.identifier]=this._id++,this.initEvent(M$b,M$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":M$j._isTouchRespond=!0,this._isLeftMouse=!0;var M$h=M$f.changedTouches;for(M$d=0,M$e=M$h.length;M$d<M$e;M$d++)if(M$b=M$h[M$d],M$j.multiTouchEnabled||M$b.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(M$b,M$f);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var M$i=M$f.changedTouches;for(M$d=0,M$e=M$i.length;M$d<M$e;M$d++)M$b=M$i[M$d],(M$j.multiTouchEnabled||M$b.identifier==this._curTouchID)&&(this.initEvent(M$b,M$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(M$f);break;case"mouseout":M$q.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}M$c++}}catch(M$a){throw this._eventList.length=0,M$a}this._eventList.length=0}},M$j.enabled=!0,M$j.multiTouchEnabled=!0,M$j._isTouchRespond=!1,M$j._isFirstTouch=!0,M$i(M$j,["instance",function(){return this.instance=new M$j}]),M$j}()),M$q=function(){function M$o(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new M$f}M$k(M$o,"laya.events.TouchManager");var M$a=M$o.prototype;return M$a._clearTempArrs=function(){M$o._oldArr.length=0,M$o._newArr.length=0,M$o._tEleArr.length=0},M$a.getTouchFromArr=function(M$a,M$b){var M$c,M$d,M$e=0;for(M$c=M$b.length,M$e=0;M$e<M$c;M$e++)if((M$d=M$b[M$e]).id==M$a)return M$d;return null},M$a.removeTouchFromArr=function(M$a,M$b){var M$c=0;for(M$c=M$b.length-1;0<=M$c;M$c--)M$b[M$c].id==M$a&&M$b.splice(M$c,1)},M$a.createTouchO=function(M$a,M$b){var M$c;return(M$c=M$W.getItem("TouchData")||{}).id=M$b,M$c.tar=M$a,M$c},M$a.onMouseDown=function(M$a,M$b,M$c){var M$d,M$e,M$f,M$g;(void 0===M$c&&(M$c=!1),this.enable)&&(M$d=this.getTouchFromArr(M$b,this.preOvers),M$f=this.getEles(M$a,null,M$o._tEleArr),M$d?M$d.tar=M$a:(M$e=this.createTouchO(M$a,M$b),this.preOvers.push(M$e)),M$O.onMobile&&this.sendEvents(M$f,"mouseover",M$b),M$g=M$c?this.preDowns:this.preRightDowns,(M$d=this.getTouchFromArr(M$b,M$g))?M$d.tar=M$a:(M$e=this.createTouchO(M$a,M$b),M$g.push(M$e)),this.sendEvents(M$f,M$c?"mousedown":"rightmousedown",M$b),this._clearTempArrs())},M$a.sendEvents=function(M$a,M$b,M$c){void 0===M$c&&(M$c=0);var M$d,M$e,M$f,M$g=0;for(M$d=M$a.length,this._event._stoped=!1,M$e=M$a[0],M$g=0;M$g<M$d;M$g++){if((M$f=M$a[M$g]).destroyed)return;if(M$f.event(M$b,this._event.setTo(M$b,M$f,M$e)),this._event._stoped)break}},M$a.getEles=function(M$a,M$b,M$c){for(M$c?M$c.length=0:M$c=[];M$a&&M$a!=M$b;)M$c.push(M$a),M$a=M$a.parent;return M$c},M$a.checkMouseOutAndOverOfMove=function(M$a,M$b,M$c){if(void 0===M$c&&(M$c=0),M$b!=M$a){var M$d,M$e,M$f=0,M$g=0;if(M$b.contains(M$a))M$e=this.getEles(M$a,M$b,M$o._tEleArr),this.sendEvents(M$e,"mouseover",M$c);else if(M$a.contains(M$b))M$e=this.getEles(M$b,M$a,M$o._tEleArr),this.sendEvents(M$e,"mouseout",M$c);else{var M$h,M$i;(M$e=M$o._tEleArr).length=0,M$h=this.getEles(M$b,null,M$o._oldArr),M$i=this.getEles(M$a,null,M$o._newArr),M$g=M$h.length;var M$j=0;for(M$f=0;M$f<M$g;M$f++){if(M$d=M$h[M$f],0<=(M$j=M$i.indexOf(M$d))){M$i.splice(M$j,M$i.length-M$j);break}M$e.push(M$d)}0<M$e.length&&this.sendEvents(M$e,"mouseout",M$c),0<M$i.length&&this.sendEvents(M$i,"mouseover",M$c)}}},M$a.onMouseMove=function(M$a,M$b){var M$c,M$d;this.enable&&((M$c=this.getTouchFromArr(M$b,this.preOvers))?(this.checkMouseOutAndOverOfMove(M$a,M$c.tar),M$c.tar=M$a,M$d=this.getEles(M$a,null,M$o._tEleArr)):(M$d=this.getEles(M$a,null,M$o._tEleArr),this.sendEvents(M$d,"mouseover",M$b),this.preOvers.push(this.createTouchO(M$a,M$b))),this.sendEvents(M$d,"mousemove",M$b),this._clearTempArrs())},M$a.getLastOvers=function(){return(M$o._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,M$o._tEleArr):(M$o._tEleArr.push(M$x.stage),M$o._tEleArr)},M$a.stageMouseOut=function(){var M$a;M$a=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(M$a,"mouseout",0)},M$a.onMouseUp=function(M$a,M$b,M$c){if(void 0===M$c&&(M$c=!1),this.enable){var M$d,M$e,M$f,M$g,M$h,M$i,M$j=0,M$k=0,M$l=M$O.onMobile;if(M$e=this.getEles(M$a,null,M$o._tEleArr),this.sendEvents(M$e,M$c?"mouseup":"rightmouseup",M$b),M$i=M$c?this.preDowns:this.preRightDowns,M$d=this.getTouchFromArr(M$b,M$i)){var M$m,M$n=M$O.now();if(M$m=M$n-this._lastClickTime<300,this._lastClickTime=M$n,M$a==M$d.tar)M$h=M$e;else for(M$f=this.getEles(M$d.tar,null,M$o._oldArr),(M$h=M$o._newArr).length=0,M$k=M$f.length,M$j=0;M$j<M$k;M$j++)M$g=M$f[M$j],0<=M$e.indexOf(M$g)&&M$h.push(M$g);0<M$h.length&&this.sendEvents(M$h,M$c?"click":"rightclick",M$b),M$c&&M$m&&this.sendEvents(M$h,"doubleclick",M$b),this.removeTouchFromArr(M$b,M$i),M$d.tar=null,M$W.recover("TouchData",M$d)}else;(M$d=this.getTouchFromArr(M$b,this.preOvers))&&M$l&&((M$h=this.getEles(M$d.tar,null,M$h))&&0<M$h.length&&this.sendEvents(M$h,"mouseout",M$b),this.removeTouchFromArr(M$b,this.preOvers),M$d.tar=null,M$W.recover("TouchData",M$d)),this._clearTempArrs()}},M$o._oldArr=[],M$o._newArr=[],M$o._tEleArr=[],M$i(M$o,["I",function(){return this.I=new M$o}]),M$o}(),M$r=function(){function M$a(){this._action=null}M$k(M$a,"laya.filters.Filter");var M$b=M$a.prototype;return M$x.imps(M$b,{"laya.filters.IFilter":!0}),M$b.callNative=function(M$a){},M$o(0,M$b,"type",function(){return-1}),M$o(0,M$b,"action",function(){return this._action}),M$a.BLUR=16,M$a.COLOR=32,M$a.GLOW=8,M$a._filterStart=null,M$a._filterEnd=null,M$a._EndTarget=null,M$a._recycleScope=null,M$a._filter=null,M$a._useSrc=null,M$a._endSrc=null,M$a._useOut=null,M$a._endOut=null,M$a}(),M$t=function(){function M$a(){this.data=null}M$k(M$a,"laya.filters.ColorFilterAction");var M$b=M$a.prototype;return M$x.imps(M$b,{"laya.filters.IFilterAction":!0}),M$b.apply=function(M$a){var M$b=M$a.ctx.ctx,M$c=M$a.ctx.ctx.canvas;if(0==M$c.width||0==M$c.height)return M$c;for(var M$d,M$e=M$b.getImageData(0,0,M$c.width,M$c.height),M$f=M$e.data,M$g=0,M$h=M$f.length;M$g<M$h;M$g+=4)M$d=this.getColor(M$f[M$g],M$f[M$g+1],M$f[M$g+2],M$f[M$g+3]),0!=M$f[M$g+3]&&(M$f[M$g]=M$d[0],M$f[M$g+1]=M$d[1],M$f[M$g+2]=M$d[2],M$f[M$g+3]=M$d[3]);return M$b.putImageData(M$e,0,0),M$a},M$b.getColor=function(M$a,M$b,M$c,M$d){var M$e=[];if(this.data._mat&&this.data._alpha){var M$f=this.data._mat,M$g=this.data._alpha;M$e[0]=M$f[0]*M$a+M$f[1]*M$b+M$f[2]*M$c+M$f[3]*M$d+M$g[0],M$e[1]=M$f[4]*M$a+M$f[5]*M$b+M$f[6]*M$c+M$f[7]*M$d+M$g[1],M$e[2]=M$f[8]*M$a+M$f[9]*M$b+M$f[10]*M$c+M$f[11]*M$d+M$g[2],M$e[3]=M$f[12]*M$a+M$f[13]*M$b+M$f[14]*M$c+M$f[15]*M$d+M$g[3]}return M$e},M$a}(),M$u=(function(){function M$a(){}M$k(M$a,"laya.maths.Arith"),M$a.formatR=function(M$a){return M$a>Math.PI&&(M$a-=2*Math.PI),M$a<-Math.PI&&(M$a+=2*Math.PI),M$a},M$a.isPOT=function(M$a,M$b){return 0<M$a&&0==(M$a&M$a-1)&&0<M$b&&0==(M$b&M$b-1)},M$a.setMatToArray=function(M$a,M$b){M$a.a,M$a.b,M$a.c,M$a.d,M$a.tx,M$a.ty,M$b[0]=M$a.a,M$b[1]=M$a.b,M$b[4]=M$a.c,M$b[5]=M$a.d,M$b[12]=M$a.tx,M$b[13]=M$a.ty}}(),function(){function M$a(){this._controlPoints=[new M$A,new M$A,new M$A],this._calFun=this.getPoint2}M$k(M$a,"laya.maths.Bezier");var M$b=M$a.prototype;return M$b._switchPoint=function(M$a,M$b){var M$c=this._controlPoints.shift();M$c.setTo(M$a,M$b),this._controlPoints.push(M$c)},M$b.getPoint2=function(M$a,M$b){var M$c=this._controlPoints[0],M$d=this._controlPoints[1],M$e=this._controlPoints[2],M$f=Math.pow(1-M$a,2)*M$c.x+2*M$a*(1-M$a)*M$d.x+Math.pow(M$a,2)*M$e.x,M$g=Math.pow(1-M$a,2)*M$c.y+2*M$a*(1-M$a)*M$d.y+Math.pow(M$a,2)*M$e.y;M$b.push(M$f,M$g)},M$b.getPoint3=function(M$a,M$b){var M$c=this._controlPoints[0],M$d=this._controlPoints[1],M$e=this._controlPoints[2],M$f=this._controlPoints[3],M$g=Math.pow(1-M$a,3)*M$c.x+3*M$d.x*M$a*(1-M$a)*(1-M$a)+3*M$e.x*M$a*M$a*(1-M$a)+M$f.x*Math.pow(M$a,3),M$h=Math.pow(1-M$a,3)*M$c.y+3*M$d.y*M$a*(1-M$a)*(1-M$a)+3*M$e.y*M$a*M$a*(1-M$a)+M$f.y*Math.pow(M$a,3);M$b.push(M$g,M$h)},M$b.insertPoints=function(M$a,M$b){var M$c,M$d=NaN;for(M$c=1/(M$a=0<M$a?M$a:5),M$d=0;M$d<=1;M$d+=M$c)this._calFun(M$d,M$b)},M$b.getBezierPoints=function(M$a,M$b,M$c){void 0===M$b&&(M$b=5),void 0===M$c&&(M$c=2);var M$d,M$e,M$f=0;if((M$d=M$a.length)<2*(M$c+1))return[];switch(M$e=[],M$c){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=M$c;)this._controlPoints.push(new M$A);for(M$f=0;M$f<2*M$c;M$f+=2)this._switchPoint(M$a[M$f],M$a[M$f+1]);for(M$f=2*M$c;M$f<M$d;M$f+=2)this._switchPoint(M$a[M$f],M$a[M$f+1]),M$f/2%M$c==0&&this.insertPoints(M$b,M$e);return M$e},M$i(M$a,["I",function(){return this.I=new M$a}]),M$a}()),M$v=function(){function M$j(){}return M$k(M$j,"laya.maths.GrahamScan"),M$j.multiply=function(M$a,M$b,M$c){return(M$a.x-M$c.x)*(M$b.y-M$c.y)-(M$b.x-M$c.x)*(M$a.y-M$c.y)},M$j.dis=function(M$a,M$b){return(M$a.x-M$b.x)*(M$a.x-M$b.x)+(M$a.y-M$b.y)*(M$a.y-M$b.y)},M$j._getPoints=function(M$a,M$b,M$c){for(void 0===M$b&&(M$b=!1),M$j._mPointList||(M$j._mPointList=[]);M$j._mPointList.length<M$a;)M$j._mPointList.push(new M$A);return M$c||(M$c=[]),M$c.length=0,M$b?M$j.getFrom(M$c,M$j._mPointList,M$a):M$j.getFromR(M$c,M$j._mPointList,M$a),M$c},M$j.getFrom=function(M$a,M$b,M$c){var M$d=0;for(M$d=0;M$d<M$c;M$d++)M$a.push(M$b[M$d]);return M$a},M$j.getFromR=function(M$a,M$b,M$c){var M$d=0;for(M$d=0;M$d<M$c;M$d++)M$a.push(M$b.pop());return M$a},M$j.pListToPointList=function(M$a,M$b){void 0===M$b&&(M$b=!1);var M$c=0,M$d=M$a.length/2,M$e=M$j._getPoints(M$d,M$b,M$j._tempPointList);for(M$c=0;M$c<M$d;M$c++)M$e[M$c].setTo(M$a[M$c+M$c],M$a[M$c+M$c+1]);return M$e},M$j.pointListToPlist=function(M$a){var M$b,M$c=0,M$d=M$a.length,M$e=M$j._temPList;for(M$c=M$e.length=0;M$c<M$d;M$c++)M$b=M$a[M$c],M$e.push(M$b.x,M$b.y);return M$e},M$j.scanPList=function(M$a){return M$$.copyArray(M$a,M$j.pointListToPlist(M$j.scan(M$j.pListToPointList(M$a,!0))))},M$j.scan=function(M$a){var M$b,M$c,M$d,M$e=0,M$f=0,M$g=0,M$h=M$a.length,M$i={};for((M$c=M$j._temArr).length=0,M$e=(M$h=M$a.length)-1;0<=M$e;M$e--)M$d=(M$b=M$a[M$e]).x+"_"+M$b.y,M$i.hasOwnProperty(M$d)||(M$i[M$d]=!0,M$c.push(M$b));for(M$h=M$c.length,M$$.copyArray(M$a,M$c),M$e=1;M$e<M$h;M$e++)(M$a[M$e].y<M$a[M$g].y||M$a[M$e].y==M$a[M$g].y&&M$a[M$e].x<M$a[M$g].x)&&(M$g=M$e);for(M$b=M$a[0],M$a[0]=M$a[M$g],M$a[M$g]=M$b,M$e=1;M$e<M$h-1;M$e++){for(M$f=(M$g=M$e)+1;M$f<M$h;M$f++)(0<M$j.multiply(M$a[M$f],M$a[M$g],M$a[0])||0==M$j.multiply(M$a[M$f],M$a[M$g],M$a[0])&&M$j.dis(M$a[0],M$a[M$f])<M$j.dis(M$a[0],M$a[M$g]))&&(M$g=M$f);M$b=M$a[M$e],M$a[M$e]=M$a[M$g],M$a[M$g]=M$b}if((M$c=M$j._temArr).length=0,M$a.length<3)return M$$.copyArray(M$c,M$a);for(M$c.push(M$a[0],M$a[1],M$a[2]),M$e=3;M$e<M$h;M$e++){for(;2<=M$c.length&&0<=M$j.multiply(M$a[M$e],M$c[M$c.length-1],M$c[M$c.length-2]);)M$c.pop();M$a[M$e]&&M$c.push(M$a[M$e])}return M$c},M$j._mPointList=null,M$j._tempPointList=[],M$j._temPList=[],M$j._temArr=[],M$j}(),M$w=function(){function M$e(){}return M$k(M$e,"laya.maths.MathUtil"),M$e.subtractVector3=function(M$a,M$b,M$c){M$c[0]=M$a[0]-M$b[0],M$c[1]=M$a[1]-M$b[1],M$c[2]=M$a[2]-M$b[2]},M$e.lerp=function(M$a,M$b,M$c){return M$a*(1-M$c)+M$b*M$c},M$e.scaleVector3=function(M$a,M$b,M$c){M$c[0]=M$a[0]*M$b,M$c[1]=M$a[1]*M$b,M$c[2]=M$a[2]*M$b},M$e.lerpVector3=function(M$a,M$b,M$c,M$d){var M$e=M$a[0],M$f=M$a[1],M$g=M$a[2];M$d[0]=M$e+M$c*(M$b[0]-M$e),M$d[1]=M$f+M$c*(M$b[1]-M$f),M$d[2]=M$g+M$c*(M$b[2]-M$g)},M$e.lerpVector4=function(M$a,M$b,M$c,M$d){var M$e=M$a[0],M$f=M$a[1],M$g=M$a[2],M$h=M$a[3];M$d[0]=M$e+M$c*(M$b[0]-M$e),M$d[1]=M$f+M$c*(M$b[1]-M$f),M$d[2]=M$g+M$c*(M$b[2]-M$g),M$d[3]=M$h+M$c*(M$b[3]-M$h)},M$e.slerpQuaternionArray=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){var M$h,M$i,M$j,M$k,M$l,M$m=M$a[M$b+0],M$n=M$a[M$b+1],M$o=M$a[M$b+2],M$p=M$a[M$b+3],M$q=M$c[M$d+0],M$r=M$c[M$d+1],M$s=M$c[M$d+2],M$t=M$c[M$d+3];return(M$i=M$m*M$q+M$n*M$r+M$o*M$s+M$p*M$t)<0&&(M$i=-M$i,M$q=-M$q,M$r=-M$r,M$s=-M$s,M$t=-M$t),M$l=1e-6<1-M$i?(M$h=Math.acos(M$i),M$j=Math.sin(M$h),M$k=Math.sin((1-M$e)*M$h)/M$j,Math.sin(M$e*M$h)/M$j):(M$k=1-M$e,M$e),M$f[M$g+0]=M$k*M$m+M$l*M$q,M$f[M$g+1]=M$k*M$n+M$l*M$r,M$f[M$g+2]=M$k*M$o+M$l*M$s,M$f[M$g+3]=M$k*M$p+M$l*M$t,M$f},M$e.getRotation=function(M$a,M$b,M$c,M$d){return Math.atan2(M$d-M$b,M$c-M$a)/Math.PI*180},M$e.sortBigFirst=function(M$a,M$b){return M$a==M$b?0:M$a<M$b?1:-1},M$e.sortSmallFirst=function(M$a,M$b){return M$a==M$b?0:M$a<M$b?-1:1},M$e.sortNumBigFirst=function(M$a,M$b){return parseFloat(M$b)-parseFloat(M$a)},M$e.sortNumSmallFirst=function(M$a,M$b){return parseFloat(M$a)-parseFloat(M$b)},M$e.sortByKey=function(M$c,M$a,M$b){var M$d;return void 0===M$a&&(M$a=!1),void 0===M$b&&(M$b=!0),M$d=M$a?M$b?M$e.sortNumBigFirst:M$e.sortBigFirst:M$b?M$e.sortNumSmallFirst:M$e.sortSmallFirst,function(M$a,M$b){return M$d(M$a[M$c],M$b[M$c])}},M$e}(),M$G=function(){function M$c(M$a,M$b,M$c,M$d,M$e,M$f){this.inPool=!1,this.bTransform=!1,void 0===M$a&&(M$a=1),void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=1),void 0===M$e&&(M$e=0),void 0===M$f&&(M$f=0),this.a=M$a,this.b=M$b,this.c=M$c,this.d=M$d,this.tx=M$e,this.ty=M$f,this._checkTransform()}M$k(M$c,"laya.maths.Matrix");var M$a=M$c.prototype;return M$a.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},M$a._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},M$a.setTranslate=function(M$a,M$b){return this.tx=M$a,this.ty=M$b,this},M$a.translate=function(M$a,M$b){return this.tx+=M$a,this.ty+=M$b,this},M$a.scale=function(M$a,M$b){this.a*=M$a,this.d*=M$b,this.c*=M$a,this.b*=M$b,this.tx*=M$a,this.ty*=M$b,this.bTransform=!0},M$a.rotate=function(M$a){var M$b=Math.cos(M$a),M$c=Math.sin(M$a),M$d=this.a,M$e=this.c,M$f=this.tx;this.a=M$d*M$b-this.b*M$c,this.b=M$d*M$c+this.b*M$b,this.c=M$e*M$b-this.d*M$c,this.d=M$e*M$c+this.d*M$b,this.tx=M$f*M$b-this.ty*M$c,this.ty=M$f*M$c+this.ty*M$b,this.bTransform=!0},M$a.skew=function(M$a,M$b){var M$c=Math.tan(M$a),M$d=Math.tan(M$b),M$e=this.a,M$f=this.b;return this.a+=M$d*this.c,this.b+=M$d*this.d,this.c+=M$c*M$e,this.d+=M$c*M$f,this},M$a.invertTransformPoint=function(M$a){var M$b=this.a,M$c=this.b,M$d=this.c,M$e=this.d,M$f=this.tx,M$g=M$b*M$e-M$c*M$d,M$h=M$e/M$g,M$i=-M$c/M$g,M$j=-M$d/M$g,M$k=M$b/M$g,M$l=(M$d*this.ty-M$e*M$f)/M$g,M$m=-(M$b*this.ty-M$c*M$f)/M$g;return M$a.setTo(M$h*M$a.x+M$j*M$a.y+M$l,M$i*M$a.x+M$k*M$a.y+M$m)},M$a.transformPoint=function(M$a){return M$a.setTo(this.a*M$a.x+this.c*M$a.y+this.tx,this.b*M$a.x+this.d*M$a.y+this.ty)},M$a.transformPointN=function(M$a){return M$a.setTo(this.a*M$a.x+this.c*M$a.y,this.b*M$a.x+this.d*M$a.y)},M$a.transformPointArray=function(M$a,M$b){for(var M$c=M$a.length,M$d=0;M$d<M$c;M$d+=2){var M$e=M$a[M$d],M$f=M$a[M$d+1];M$b[M$d]=this.a*M$e+this.c*M$f+this.tx,M$b[M$d+1]=this.b*M$e+this.d*M$f+this.ty}return M$b},M$a.transformPointArrayScale=function(M$a,M$b){for(var M$c=M$a.length,M$d=0;M$d<M$c;M$d+=2){var M$e=M$a[M$d],M$f=M$a[M$d+1];M$b[M$d]=this.a*M$e+this.c*M$f,M$b[M$d+1]=this.b*M$e+this.d*M$f}return M$b},M$a.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},M$a.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},M$a.invert=function(){var M$a=this.a,M$b=this.b,M$c=this.c,M$d=this.d,M$e=this.tx,M$f=M$a*M$d-M$b*M$c;return this.a=M$d/M$f,this.b=-M$b/M$f,this.c=-M$c/M$f,this.d=M$a/M$f,this.tx=(M$c*this.ty-M$d*M$e)/M$f,this.ty=-(M$a*this.ty-M$b*M$e)/M$f,this},M$a.setTo=function(M$a,M$b,M$c,M$d,M$e,M$f){return this.a=M$a,this.b=M$b,this.c=M$c,this.d=M$d,this.tx=M$e,this.ty=M$f,this},M$a.concat=function(M$a){var M$b=this.a,M$c=this.c,M$d=this.tx;return this.a=M$b*M$a.a+this.b*M$a.c,this.b=M$b*M$a.b+this.b*M$a.d,this.c=M$c*M$a.a+this.d*M$a.c,this.d=M$c*M$a.b+this.d*M$a.d,this.tx=M$d*M$a.a+this.ty*M$a.c+M$a.tx,this.ty=M$d*M$a.b+this.ty*M$a.d+M$a.ty,this},M$a.scaleEx=function(M$a,M$b){var M$c=this.a,M$d=this.b,M$e=this.c,M$f=this.d;0!==M$d||0!==M$e?(this.a=M$a*M$c,this.b=M$a*M$d,this.c=M$b*M$e):(this.a=M$a*M$c,this.b=0*M$f,this.c=0*M$c),this.d=M$b*M$f,this.bTransform=!0},M$a.rotateEx=function(M$a){var M$b=Math.cos(M$a),M$c=Math.sin(M$a),M$d=this.a,M$e=this.b,M$f=this.c,M$g=this.d;0!==M$e||0!==M$f?(this.a=M$b*M$d+M$c*M$f,this.b=M$b*M$e+M$c*M$g,this.c=-M$c*M$d+M$b*M$f,this.d=-M$c*M$e+M$b*M$g):(this.a=M$b*M$d,this.b=M$c*M$g,this.c=-M$c*M$d,this.d=M$b*M$g),this.bTransform=!0},M$a.clone=function(){var M$a=M$c.create();return M$a.a=this.a,M$a.b=this.b,M$a.c=this.c,M$a.d=this.d,M$a.tx=this.tx,M$a.ty=this.ty,M$a.bTransform=this.bTransform,M$a},M$a.copyTo=function(M$a){return M$a.a=this.a,M$a.b=this.b,M$a.c=this.c,M$a.d=this.d,M$a.tx=this.tx,M$a.ty=this.ty,M$a.bTransform=this.bTransform,M$a},M$a.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},M$a.destroy=function(){if(!this.inPool){var M$a=M$c._cache;this.inPool=!0,M$a._length||(M$a._length=0),(M$a[M$a._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},M$c.mul=function(M$a,M$b,M$c){var M$d=M$a.a,M$e=M$a.b,M$f=M$a.c,M$g=M$a.d,M$h=M$a.tx,M$i=M$a.ty,M$j=M$b.a,M$k=M$b.b,M$l=M$b.c,M$m=M$b.d,M$n=M$b.tx,M$o=M$b.ty;return 0!==M$k||0!==M$l?(M$c.a=M$d*M$j+M$e*M$l,M$c.b=M$d*M$k+M$e*M$m,M$c.c=M$f*M$j+M$g*M$l,M$c.d=M$f*M$k+M$g*M$m,M$c.tx=M$j*M$h+M$l*M$i+M$n,M$c.ty=M$k*M$h+M$m*M$i+M$o):(M$c.a=M$d*M$j,M$c.b=M$e*M$m,M$c.c=M$f*M$j,M$c.d=M$g*M$m,M$c.tx=M$j*M$h+M$n,M$c.ty=M$m*M$i+M$o),M$c},M$c.mul16=function(M$a,M$b,M$c){var M$d=M$a.a,M$e=M$a.b,M$f=M$a.c,M$g=M$a.d,M$h=M$a.tx,M$i=M$a.ty,M$j=M$b.a,M$k=M$b.b,M$l=M$b.c,M$m=M$b.d,M$n=M$b.tx,M$o=M$b.ty;return 0!==M$k||0!==M$l?(M$c[0]=M$d*M$j+M$e*M$l,M$c[1]=M$d*M$k+M$e*M$m,M$c[4]=M$f*M$j+M$g*M$l,M$c[5]=M$f*M$k+M$g*M$m,M$c[12]=M$j*M$h+M$l*M$i+M$n,M$c[13]=M$k*M$h+M$m*M$i+M$o):(M$c[0]=M$d*M$j,M$c[1]=M$e*M$m,M$c[4]=M$f*M$j,M$c[5]=M$g*M$m,M$c[12]=M$j*M$h+M$n,M$c[13]=M$m*M$i+M$o),M$c},M$c.mulPre=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){var M$i=M$a.a,M$j=M$a.b,M$k=M$a.c,M$l=M$a.d,M$m=M$a.tx,M$n=M$a.ty;return 0!==M$c||0!==M$d?(M$h.a=M$i*M$b+M$j*M$d,M$h.b=M$i*M$c+M$j*M$e,M$h.c=M$k*M$b+M$l*M$d,M$h.d=M$k*M$c+M$l*M$e,M$h.tx=M$b*M$m+M$d*M$n+M$f,M$h.ty=M$c*M$m+M$e*M$n+M$g):(M$h.a=M$i*M$b,M$h.b=M$j*M$e,M$h.c=M$k*M$b,M$h.d=M$l*M$e,M$h.tx=M$b*M$m+M$f,M$h.ty=M$e*M$n+M$g),M$h},M$c.mulPos=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){var M$i=M$a.a,M$j=M$a.b,M$k=M$a.c,M$l=M$a.d,M$m=M$a.tx,M$n=M$a.ty;return 0!==M$j||0!==M$k?(M$h.a=M$b*M$i+M$c*M$k,M$h.b=M$b*M$j+M$c*M$l,M$h.c=M$d*M$i+M$e*M$k,M$h.d=M$d*M$j+M$e*M$l,M$h.tx=M$i*M$f+M$k*M$g+M$m,M$h.ty=M$j*M$f+M$l*M$g+M$n):(M$h.a=M$b*M$i,M$h.b=M$c*M$l,M$h.c=M$d*M$i,M$h.d=M$e*M$l,M$h.tx=M$i*M$f+M$m,M$h.ty=M$l*M$g+M$n),M$h},M$c.preMul=function(M$a,M$b,M$c){var M$d=M$a.a,M$e=M$a.b,M$f=M$a.c,M$g=M$a.d,M$h=M$b.a,M$i=M$b.b,M$j=M$b.c,M$k=M$b.d,M$l=M$b.tx,M$m=M$b.ty;return M$c.a=M$h*M$d,M$c.b=M$c.c=0,M$c.d=M$k*M$g,M$c.tx=M$l*M$d+M$a.tx,M$c.ty=M$m*M$g+M$a.ty,0===M$i&&0===M$j&&0===M$e&&0===M$f||(M$c.a+=M$i*M$f,M$c.d+=M$j*M$e,M$c.b+=M$h*M$e+M$i*M$g,M$c.c+=M$j*M$d+M$k*M$f,M$c.tx+=M$m*M$f,M$c.ty+=M$l*M$e),M$c},M$c.preMulXY=function(M$a,M$b,M$c,M$d){var M$e=M$a.a,M$f=M$a.b,M$g=M$a.c,M$h=M$a.d;return M$d.a=M$e,M$d.b=M$f,M$d.c=M$g,M$d.d=M$h,M$d.tx=M$b*M$e+M$a.tx+M$c*M$g,M$d.ty=M$c*M$h+M$a.ty+M$b*M$f,M$d},M$c.create=function(){var M$a=M$c._cache,M$b=M$a._length?M$a[--M$a._length]:new M$c;return M$b.inPool=!1,M$b},M$c.EMPTY=new M$c,M$c.TEMP=new M$c,M$c._cache=[],M$c}(),M$A=function(){function M$a(M$a,M$b){void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),this.x=M$a,this.y=M$b}M$k(M$a,"laya.maths.Point");var M$b=M$a.prototype;return M$b.setTo=function(M$a,M$b){return this.x=M$a,this.y=M$b,this},M$b.distance=function(M$a,M$b){return Math.sqrt((this.x-M$a)*(this.x-M$a)+(this.y-M$b)*(this.y-M$b))},M$b.toString=function(){return this.x+","+this.y},M$b.normalize=function(){var M$a=Math.sqrt(this.x*this.x+this.y*this.y);if(0<M$a){var M$b=1/M$a;this.x*=M$b,this.y*=M$b}},M$a.TEMP=new M$a,M$a.EMPTY=new M$a,M$a}(),M$B=function(){function M$j(M$a,M$b,M$c,M$d){void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=0),this.x=M$a,this.y=M$b,this.width=M$c,this.height=M$d}M$k(M$j,"laya.maths.Rectangle");var M$a=M$j.prototype;return M$a.setTo=function(M$a,M$b,M$c,M$d){return this.x=M$a,this.y=M$b,this.width=M$c,this.height=M$d,this},M$a.copyFrom=function(M$a){return this.x=M$a.x,this.y=M$a.y,this.width=M$a.width,this.height=M$a.height,this},M$a.contains=function(M$a,M$b){return!(this.width<=0||this.height<=0)&&(M$a>=this.x&&M$a<this.right&&M$b>=this.y&&M$b<this.bottom)},M$a.intersects=function(M$a){return!(M$a.x>this.x+this.width||M$a.x+M$a.width<this.x||M$a.y>this.y+this.height||M$a.y+M$a.height<this.y)},M$a.intersection=function(M$a,M$b){return this.intersects(M$a)?(M$b||(M$b=new M$j),M$b.x=Math.max(this.x,M$a.x),M$b.y=Math.max(this.y,M$a.y),M$b.width=Math.min(this.right,M$a.right)-M$b.x,M$b.height=Math.min(this.bottom,M$a.bottom)-M$b.y,M$b):null},M$a.union=function(M$a,M$b){return M$b||(M$b=new M$j),this.clone(M$b),M$a.width<=0||M$a.height<=0?M$b:(M$b.addPoint(M$a.x,M$a.y),M$b.addPoint(M$a.right,M$a.bottom),this)},M$a.clone=function(M$a){return M$a||(M$a=new M$j),M$a.x=this.x,M$a.y=this.y,M$a.width=this.width,M$a.height=this.height,M$a},M$a.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},M$a.equals=function(M$a){return!(!M$a||M$a.x!==this.x||M$a.y!==this.y||M$a.width!==this.width||M$a.height!==this.height)},M$a.addPoint=function(M$a,M$b){return this.x>M$a&&(this.width+=this.x-M$a,this.x=M$a),this.y>M$b&&(this.height+=this.y-M$b,this.y=M$b),this.width<M$a-this.x&&(this.width=M$a-this.x),this.height<M$b-this.y&&(this.height=M$b-this.y),this},M$a._getBoundPoints=function(){var M$a=M$j._temB;return(M$a.length=0)==this.width||0==this.height||M$a.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),M$a},M$a.isEmpty=function(){return this.width<=0||this.height<=0},M$o(0,M$a,"right",function(){return this.x+this.width}),M$o(0,M$a,"bottom",function(){return this.y+this.height}),M$j._getBoundPointS=function(M$a,M$b,M$c,M$d){var M$e=M$j._temA;return(M$e.length=0)==M$c||0==M$d||M$e.push(M$a,M$b,M$a+M$c,M$b,M$a,M$b+M$d,M$a+M$c,M$b+M$d),M$e},M$j._getWrapRec=function(M$a,M$b){if(!M$a||M$a.length<1)return M$b?M$b.setTo(0,0,0,0):M$j.TEMP.setTo(0,0,0,0);M$b=M$b||new M$j;var M$c,M$d,M$e,M$f,M$g,M$h=M$a.length,M$i=M$A.TEMP;for(M$e=M$g=-(M$d=M$f=99999),M$c=0;M$c<M$h;M$c+=2)M$i.x=M$a[M$c],M$i.y=M$a[M$c+1],M$d=M$d<M$i.x?M$d:M$i.x,M$f=M$f<M$i.y?M$f:M$i.y,M$e=M$e>M$i.x?M$e:M$i.x,M$g=M$g>M$i.y?M$g:M$i.y;return M$b.setTo(M$d,M$f,M$e-M$d,M$g-M$f)},M$j.EMPTY=new M$j,M$j.TEMP=new M$j,M$j._temB=[],M$j._temA=[],M$j}(),M$E=function(){function M$i(){}return M$k(M$i,"laya.media.SoundManager"),M$o(1,M$i,"useAudioMusic",function(){return M$i._useAudioMusic},function(M$a){M$i._useAudioMusic=M$a,M$i._musicClass=M$a?M$ca:null}),M$o(1,M$i,"autoStopMusic",function(){return M$i._autoStopMusic},function(M$a){M$x.stage.off("blur",null,M$i._stageOnBlur),M$x.stage.off("focus",null,M$i._stageOnFocus),M$x.stage.off("visibilitychange",null,M$i._visibilityChange),(M$i._autoStopMusic=M$a)&&(M$x.stage.on("blur",null,M$i._stageOnBlur),M$x.stage.on("focus",null,M$i._stageOnFocus),M$x.stage.on("visibilitychange",null,M$i._visibilityChange))}),M$o(1,M$i,"muted",function(){return M$i._muted},function(M$a){M$a!=M$i._muted&&(M$a&&M$i.stopAllSound(),M$i.musicMuted=M$a,M$i._muted=M$a)}),M$o(1,M$i,"musicMuted",function(){return M$i._musicMuted},function(M$a){M$a!=M$i._musicMuted&&(M$a?(M$i._tMusic&&M$i._musicChannel&&!M$i._musicChannel.isStopped?M$i._musicChannel.pause():M$i._musicChannel=null,M$i._musicMuted=M$a):(M$i._musicMuted=M$a,M$i._tMusic&&M$i._musicChannel&&M$i._musicChannel.resume()))}),M$o(1,M$i,"soundMuted",function(){return M$i._soundMuted},function(M$a){M$i._soundMuted=M$a}),M$i.addChannel=function(M$a){0<=M$i._channels.indexOf(M$a)||(M$i._channels.push(M$a),M$i.autoReleaseSound&&0!=M$i._notUsedCount&&M$i._notUsedUrls[M$a.url]&&(delete M$i._notUsedUrls[M$a.url],0==--M$i._notUsedCount&&M$x.timer.clear(M$i,M$i.disposeSoundIfNotUsed)))},M$i.removeChannel=function(M$a){var M$b=M$i._channels,M$c=M$b.indexOf(M$a);if(-1!=M$c&&(M$b.splice(M$c,1),M$i.autoReleaseSound)){var M$d=M$a.url,M$e=M$i.defaultIntervals[M$d]||2e4;if(0<M$e){var M$f=!0;for(M$c=M$b.length-1;0<=M$c;M$c--)if(M$b[M$c].url==M$d){M$f=!1;break}M$f&&(M$i._notUsedUrls[M$d]=Date.now()+M$e,0==M$i._notUsedCount++&&M$x.timer.loop(1e4,M$i,M$i.disposeSoundIfNotUsed))}}},M$i.disposeSoundIfNotUsed=function(){var M$a=M$i._notUsedUrls;if(0!=M$i._notUsedCount){var M$b=Date.now();for(var M$c in M$a)M$b>=M$a[M$c]&&(delete M$a[M$c],--M$i._notUsedCount,M$i.destroySound(M$c));if(0!=M$i._notUsedCount)return}M$x.timer.clear(M$i,M$i.disposeSoundIfNotUsed)},M$i._visibilityChange=function(){M$x.stage.isVisibility?M$i._stageOnFocus():M$i._stageOnBlur()},M$i._stageOnBlur=function(){M$i._isActive=!1,M$i._musicChannel&&(M$i._musicChannel.isStopped||(M$i._blurPaused=!0,M$i._musicChannel.pause())),M$i.stopAllSound(),M$x.stage.once("mousedown",null,M$i._stageOnFocus)},M$i._recoverWebAudio=function(){M$fa.ctx&&"running"!=M$fa.ctx.state&&M$fa.ctx.resume&&M$fa.ctx.resume()},M$i._stageOnFocus=function(){if(M$i._isActive=!0,M$i._recoverWebAudio(),M$x.stage.off("mousedown",null,M$i._stageOnFocus),M$i._blurPaused){var M$a=M$i._musicChannel;M$a&&M$i._music&&M$a.isStopped&&(M$i._blurPaused=!1,M$i._music._disposed?M$i.playMusic(M$a.url,M$a.loops,M$a.startHandler,M$a.completeHandler,M$a.startTime):M$a.audioBuffer?M$a.resume():M$i._music.play(M$a.startTime,M$a.loops,M$a.startHandler,M$a))}},M$i.playSound=function(M$a,M$b,M$c,M$d,M$e,M$f){if(void 0===M$b&&(M$b=1),void 0===M$f&&(M$f=0),!M$a)return null;if(M$i._muted)return null;if(M$i._recoverWebAudio(),M$a==M$i._tMusic){if(M$i._musicMuted)return null}else{if(!M$i._isActive)return null;if(M$i._soundMuted)return null}var M$g,M$h=M$i._pool[M$a];return M$e||(M$e=M$i._soundClass),M$h||((M$h=new M$e).load(M$a),M$i._pool[M$a]=M$h),(M$g=M$h.play(M$f,M$b,M$c))?(M$a==M$i._tMusic&&(M$i._music=M$h,M$i._isActive||(M$i._blurPaused=!0,M$g.pause())),M$g.url=M$a,M$g.volume=M$a==M$i._tMusic?M$i.musicVolume:M$i.soundVolume,M$g.completeHandler=M$d,M$g):null},M$i.destroySound=function(M$a){var M$b=M$i._pool[M$a];M$b&&(delete M$i._pool[M$a],M$b.dispose())},M$i.playMusic=function(M$a,M$b,M$c,M$d,M$e){return void 0===M$b&&(M$b=0),void 0===M$e&&(M$e=0),M$i._tMusic=M$a,M$i._musicChannel&&M$i._musicChannel.stop(),M$i._musicChannel=M$i.playSound(M$a,M$b,M$c,M$d,null,M$e)},M$i.stopSound=function(M$a){for(var M$b,M$c=M$i._channels.length-1;0<=M$c;M$c--)(M$b=M$i._channels[M$c]).url==M$a&&M$b.stop()},M$i.stopAll=function(){M$i._tMusic=null;var M$a=0;for(M$a=M$i._channels.length-1;0<=M$a;M$a--)M$i._channels[M$a].stop()},M$i.stopAllSound=function(){var M$a,M$b=0;for(M$b=M$i._channels.length-1;0<=M$b;M$b--)(M$a=M$i._channels[M$b]).url!=M$i._tMusic&&M$a.stop()},M$i.stopMusic=function(){M$i._musicChannel&&M$i._musicChannel.stop(),M$i._tMusic=null},M$i.setSoundVolume=function(M$a,M$b){if(M$b)M$i._setVolume(M$b,M$a);else{M$i.soundVolume=M$a;var M$c,M$d=0;for(M$d=M$i._channels.length-1;0<=M$d;M$d--)(M$c=M$i._channels[M$d]).url!=M$i._tMusic&&(M$c.volume=M$a)}},M$i.setMusicVolume=function(M$a){M$i.musicVolume=M$a,M$i._setVolume(M$i._tMusic,M$a)},M$i._setVolume=function(M$a,M$b){for(var M$c,M$d=M$i._channels.length-1;0<=M$d;M$d--)(M$c=M$i._channels[M$d]).url==M$a&&(M$c.volume=M$b)},M$i.musicVolume=1,M$i.soundVolume=1,M$i.playbackRate=1,M$i._useAudioMusic=!0,M$i._muted=!1,M$i._soundMuted=!1,M$i._musicMuted=!1,M$i._tMusic=null,M$i._musicChannel=null,M$i._music=null,M$i._channels=[],M$i._autoStopMusic=!1,M$i._blurPaused=!1,M$i._isActive=!0,M$i._soundClass=null,M$i._musicClass=null,M$i.autoReleaseSound=!0,M$i._pool={},M$i.defaultIntervals={},M$i._notUsedUrls={},M$i._notUsedCount=0,M$i}(),M$C=function(){var M$a;function M$c(){}return M$k(M$c,"laya.net.LocalStorage"),M$c.__init__=function(){M$c._baseClass||(M$c._baseClass=M$a).init(),M$c.items=M$c._baseClass.items,M$c.support=M$c._baseClass.support},M$c.setItem=function(M$a,M$b){M$c._baseClass.setItem(M$a,M$b)},M$c.getItem=function(M$a){return M$c._baseClass.getItem(M$a)},M$c.setJSON=function(M$a,M$b){M$c._baseClass.setJSON(M$a,M$b)},M$c.getJSON=function(M$a){return M$c._baseClass.getJSON(M$a)},M$c.removeItem=function(M$a){M$c._baseClass.removeItem(M$a)},M$c.clear=function(){M$c._baseClass.clear()},M$c._baseClass=null,M$c.items=null,M$c.support=!1,M$c.__init$=function(){M$a=function(){function M$c(){}return M$k(M$c,""),M$c.init=function(){try{M$c.support=!0,M$c.items=M$g.localStorage,M$c.setItem("laya","1"),M$c.removeItem("laya")}catch(M$a){M$c.support=!1}M$c.support||console.log("LocalStorage is not supprot or browser is private mode.")},M$c.setItem=function(M$a,M$b){try{M$c.support&&M$c.items.setItem(M$a,M$b)}catch(M$a){console.warn("set localStorage failed",M$a)}},M$c.getItem=function(M$a){return M$c.support?M$c.items.getItem(M$a):null},M$c.setJSON=function(M$a,M$b){try{M$c.support&&M$c.items.setItem(M$a,JSON.stringify(M$b))}catch(M$a){console.warn("set localStorage failed",M$a)}},M$c.getJSON=function(M$a){return JSON.parse(M$c.support?M$c.items.getItem(M$a):null)},M$c.removeItem=function(M$a){M$c.support&&M$c.items.removeItem(M$a)},M$c.clear=function(){M$c.support&&M$c.items.clear()},M$c.items=null,M$c.support=!1,M$c}()},M$c}(),M$H=(function(){function M$d(){}M$k(M$d,"laya.net.ResourceVersion"),M$d.enable=function(M$a,M$b,M$c){void 0===M$c&&(M$c=2),laya.net.ResourceVersion.type=M$c,M$x.loader.load(M$a,M$s.create(null,M$d.onManifestLoaded,[M$b]),null,"json"),M$I.customFormat=M$d.addVersionPrefix},M$d.onManifestLoaded=function(M$a,M$b){M$d.manifest=M$b,M$a.run(),M$b||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},M$d.addVersionPrefix=function(M$a){return M$d.manifest&&M$d.manifest[M$a]?2==M$d.type?M$d.manifest[M$a]:M$d.manifest[M$a]+"/"+M$a:M$a},M$d.FOLDER_VERSION=1,M$d.FILENAME_VERSION=2,M$d.manifest=null,M$d.type=1}(),function(){function M$a(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}M$k(M$a,"laya.net.TTFLoader");var M$b=M$a.prototype;return M$b.load=function(M$a){var M$b=(this._url=M$a).split(".ttf")[0].split("/");this.fontName=M$b[M$b.length-1],M$O.window.conch?this._loadConch():M$O.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},M$b._loadConch=function(){this._http=new M$ga,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},M$b._onHttpLoaded=function(M$a){M$O.window.conch.setFontFaceFromBuffer(this.fontName,M$a),this._clearHttp(),this._complete()},M$b._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},M$b._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},M$b._complete=function(){M$x.timer.clear(this,this._complete),M$x.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},M$b._checkComplete=function(){M$F.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},M$b._loadWithFontFace=function(){var M$a=new M$O.window.FontFace(this.fontName,"url('"+this._url+"')");M$O.window.document.fonts.add(M$a);var M$b=this;M$a.loaded.then(function(){M$b._complete()}),M$a.load()},M$b._createDiv=function(){this._div=M$O.createElement("div"),this._div.innerHTML="laya";var M$a=this._div.style;M$a.fontFamily=this.fontName,M$a.position="absolute",M$a.left="-100px",M$a.top="-100px",M$O.document.body.appendChild(this._div)},M$b._loadWithCSS=function(){var M$a=this,M$b=M$O.createElement("style");M$b.type="text/css",M$O.document.body.appendChild(M$b),M$b.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=M$F.measureText("LayaTTFFont",this._fontTxt).width;var M$c=this;M$b.onload=function(){M$x.timer.once(1e4,M$c,M$a._complete)},M$x.timer.loop(20,this,this._checkComplete),this._createDiv()},M$a._testString="LayaTTFFont",M$a}()),M$I=function(){function M$d(M$a){this._url=null,this._path=null,this._url=M$d.formatURL(M$a),this._path=M$d.getPath(M$a)}M$k(M$d,"laya.net.URL");var M$a=M$d.prototype;return M$o(0,M$a,"path",function(){return this._path}),M$o(0,M$a,"url",function(){return this._url}),M$d.formatURL=function(M$a,M$b){if(!M$a)return"null path";if(0<M$a.indexOf(":"))return M$a;null!=M$d.customFormat&&(M$a=M$d.customFormat(M$a,M$b));var M$c=M$a.charAt(0);if("."===M$c)return M$d.formatRelativePath((M$b||M$d.basePath)+M$a);if("~"===M$c)return M$d.rootPath+M$a.substring(1);if("d"===M$c){if(0===M$a.indexOf("data:image"))return M$a}else if("/"===M$c)return M$a;return(M$b||M$d.basePath)+M$a},M$d.formatRelativePath=function(M$a){for(var M$b=M$a.split("/"),M$c=0,M$d=M$b.length;M$c<M$d;M$c++)".."==M$b[M$c]&&(M$b.splice(M$c-1,2),M$c-=2);return M$b.join("/")},M$d.isAbsolute=function(M$a){return 0<M$a.indexOf(":")||"/"==M$a.charAt(0)},M$d.getPath=function(M$a){var M$b=M$a.lastIndexOf("/");return 0<M$b?M$a.substr(0,M$b+1):""},M$d.getFileName=function(M$a){var M$b=M$a.lastIndexOf("/");return 0<M$b?M$a.substr(M$b+1):M$a},M$d.version={},M$d.basePath="",M$d.rootPath="",M$d.customFormat=function(M$a){var M$b=M$d.version[M$a];return!M$J.isConchApp&&M$b&&(M$a+="?v="+M$b),M$a},M$d}(),M$J=function(){function M$e(M$a,M$b){this._timeId=0;var M$c=M$e._mainCanvas.source.style;M$c.position="absolute",M$c.top=M$c.left="0px",M$c.background="#000000",M$e._mainCanvas.source.id="layaCanvas";var M$d=laya.renders.Render.isWebGL;M$e._mainCanvas.source.width=M$a,M$e._mainCanvas.source.height=M$b,M$d&&M$e.WebGL.init(M$e._mainCanvas,M$a,M$b),M$O.container.appendChild(M$e._mainCanvas.source),(M$e._context=new M$K(M$a,M$b,M$d?null:M$e._mainCanvas)).ctx.setIsMainContext(),M$O.window.requestAnimationFrame(function M$a(M$b){M$O.window.requestAnimationFrame(M$a);M$x.stage._loop()}),M$x.stage.on("visibilitychange",this,this._onVisibilitychange)}M$k(M$e,"laya.renders.Render");var M$a=M$e.prototype;return M$a._onVisibilitychange=function(){M$x.stage.isVisibility?0!=this._timeId&&M$O.window.clearInterval(this._timeId):this._timeId=M$O.window.setInterval(this._enterFrame,1e3)},M$a._enterFrame=function(M$a){M$x.stage._loop()},M$o(1,M$e,"context",function(){return M$e._context}),M$o(1,M$e,"canvas",function(){return M$e._mainCanvas.source}),M$e._context=null,M$e._mainCanvas=null,M$e.WebGL=null,M$e.isConchNode=!1,M$e.isConchApp=!1,M$e.isConchWebGL=!1,M$e.isWebGL=!1,M$e.is3DMode=!1,M$e.optimizeTextureMemory=function(M$a,M$b){return!0},M$e.__init$=function(){M$g.ConchRenderType=M$g.ConchRenderType||1,M$g.ConchRenderType|=M$g.conch?4:0,M$e.isConchNode=5==(5&M$g.ConchRenderType),M$e.isConchApp=4==(4&M$g.ConchRenderType),M$e.isConchWebGL=6==M$g.ConchRenderType},M$e}(),M$K=function(){function M$g(M$a,M$b,M$c){this.x=0,this.y=0,this._drawTexture=function(M$a,M$b,M$c){M$c[0].loaded&&this.ctx.drawTexture(M$c[0],M$c[1],M$c[2],M$c[3],M$c[4],M$a,M$b)},this._fillTexture=function(M$a,M$b,M$c){M$c[0].loaded&&this.ctx.fillTexture(M$c[0],M$c[1]+M$a,M$c[2]+M$b,M$c[3],M$c[4],M$c[5],M$c[6],M$c[7])},this._drawTextureWithTransform=function(M$a,M$b,M$c){M$c[0].loaded&&this.ctx.drawTextureWithTransform(M$c[0],M$c[1],M$c[2],M$c[3],M$c[4],M$c[5],M$a,M$b,M$c[6])},this._fillQuadrangle=function(M$a,M$b,M$c){this.ctx.fillQuadrangle(M$c[0],M$c[1],M$c[2],M$c[3],M$c[4])},this._drawRect=function(M$a,M$b,M$c){var M$d=this.ctx;null!=M$c[4]&&(M$d.fillStyle=M$c[4],M$d.fillRect(M$a+M$c[0],M$b+M$c[1],M$c[2],M$c[3],null)),null!=M$c[5]&&(M$d.strokeStyle=M$c[5],M$d.lineWidth=M$c[6],M$d.strokeRect(M$a+M$c[0],M$b+M$c[1],M$c[2],M$c[3],M$c[6]))},this._drawPie=function(M$a,M$b,M$c){var M$d=this.ctx;M$J.isWebGL&&M$d.setPathId(M$c[8]),M$d.beginPath(),M$J.isWebGL?(M$d.movePath(M$c[0]+M$a,M$c[1]+M$b),M$d.moveTo(0,0)):M$d.moveTo(M$a+M$c[0],M$b+M$c[1]),M$d.arc(M$a+M$c[0],M$b+M$c[1],M$c[2],M$c[3],M$c[4]),M$d.closePath(),this._fillAndStroke(M$c[5],M$c[6],M$c[7],!0)},this._clipRect=function(M$a,M$b,M$c){this.ctx.clipRect(M$a+M$c[0],M$b+M$c[1],M$c[2],M$c[3])},this._fillRect=function(M$a,M$b,M$c){this.ctx.fillRect(M$a+M$c[0],M$b+M$c[1],M$c[2],M$c[3],M$c[4])},this._drawCircle=function(M$a,M$b,M$c){var M$d=this.ctx;M$J.isWebGL&&M$d.setPathId(M$c[6]),M$X.drawCall++,M$d.beginPath(),M$J.isWebGL&&M$d.movePath(M$c[0]+M$a,M$c[1]+M$b),M$d.arc(M$c[0]+M$a,M$c[1]+M$b,M$c[2],0,M$g.PI2),M$d.closePath(),this._fillAndStroke(M$c[3],M$c[4],M$c[5],!0)},this._fillCircle=function(M$a,M$b,M$c){M$X.drawCall++;var M$d=this.ctx;M$d.beginPath(),M$d.fillStyle=M$c[3],M$d.arc(M$c[0]+M$a,M$c[1]+M$b,M$c[2],0,M$g.PI2),M$d.fill()},this._setShader=function(M$a,M$b,M$c){this.ctx.setShader(M$c[0])},this._drawLine=function(M$a,M$b,M$c){var M$d=this.ctx;M$J.isWebGL&&M$d.setPathId(M$c[6]),M$d.beginPath(),M$d.strokeStyle=M$c[4],M$d.lineWidth=M$c[5],M$J.isWebGL?(M$d.movePath(M$a,M$b),M$d.moveTo(M$c[0],M$c[1]),M$d.lineTo(M$c[2],M$c[3])):(M$d.moveTo(M$a+M$c[0],M$b+M$c[1]),M$d.lineTo(M$a+M$c[2],M$b+M$c[3])),M$d.stroke()},this._drawLines=function(M$a,M$b,M$c){var M$d=this.ctx;M$J.isWebGL&&M$d.setPathId(M$c[5]),M$d.beginPath(),M$a+=M$c[0],M$b+=M$c[1],M$J.isWebGL&&M$d.movePath(M$a,M$b),M$d.strokeStyle=M$c[3],M$d.lineWidth=M$c[4];var M$e=M$c[2],M$f=2,M$g=M$e.length;if(M$J.isWebGL)for(M$d.moveTo(M$e[0],M$e[1]);M$f<M$g;)M$d.lineTo(M$e[M$f++],M$e[M$f++]);else for(M$d.moveTo(M$a+M$e[0],M$b+M$e[1]);M$f<M$g;)M$d.lineTo(M$a+M$e[M$f++],M$b+M$e[M$f++]);M$d.stroke()},this._drawLinesWebGL=function(M$a,M$b,M$c){this.ctx.drawLines(M$a+this.x+M$c[0],M$b+this.y+M$c[1],M$c[2],M$c[3],M$c[4])},this._drawCurves=function(M$a,M$b,M$c){this.ctx.drawCurves(M$a,M$b,M$c)},this._draw=function(M$a,M$b,M$c){M$c[0].call(null,this,M$a,M$b)},this._transformByMatrix=function(M$a,M$b,M$c){this.ctx.transformByMatrix(M$c[0])},this._setTransform=function(M$a,M$b,M$c){this.ctx.setTransform(M$c[0],M$c[1],M$c[2],M$c[3],M$c[4],M$c[5])},this._setTransformByMatrix=function(M$a,M$b,M$c){this.ctx.setTransformByMatrix(M$c[0])},this._save=function(M$a,M$b,M$c){this.ctx.save()},this._restore=function(M$a,M$b,M$c){this.ctx.restore()},this._translate=function(M$a,M$b,M$c){this.ctx.translate(M$c[0],M$c[1])},this._transform=function(M$a,M$b,M$c){this.ctx.translate(M$c[1]+M$a,M$c[2]+M$b);var M$d=M$c[0];this.ctx.transform(M$d.a,M$d.b,M$d.c,M$d.d,M$d.tx,M$d.ty),this.ctx.translate(-M$a-M$c[1],-M$b-M$c[2])},this._rotate=function(M$a,M$b,M$c){this.ctx.translate(M$c[1]+M$a,M$c[2]+M$b),this.ctx.rotate(M$c[0]),this.ctx.translate(-M$a-M$c[1],-M$b-M$c[2])},this._scale=function(M$a,M$b,M$c){this.ctx.translate(M$c[2]+M$a,M$c[3]+M$b),this.ctx.scale(M$c[0],M$c[1]),this.ctx.translate(-M$a-M$c[2],-M$b-M$c[3])},this._alpha=function(M$a,M$b,M$c){this.ctx.globalAlpha*=M$c[0]},this._setAlpha=function(M$a,M$b,M$c){this.ctx.globalAlpha=M$c[0]},this._fillText=function(M$a,M$b,M$c){this.ctx.fillText(M$c[0],M$c[1]+M$a,M$c[2]+M$b,M$c[3],M$c[4],M$c[5])},this._strokeText=function(M$a,M$b,M$c){this.ctx.strokeText(M$c[0],M$c[1]+M$a,M$c[2]+M$b,M$c[3],M$c[4],M$c[5],M$c[6])},this._fillBorderText=function(M$a,M$b,M$c){this.ctx.fillBorderText(M$c[0],M$c[1]+M$a,M$c[2]+M$b,M$c[3],M$c[4],M$c[5],M$c[6],M$c[7])},this._blendMode=function(M$a,M$b,M$c){this.ctx.globalCompositeOperation=M$c[0]},this._beginClip=function(M$a,M$b,M$c){this.ctx.beginClip&&this.ctx.beginClip(M$a+M$c[0],M$b+M$c[1],M$c[2],M$c[3])},this._setIBVB=function(M$a,M$b,M$c){this.ctx.setIBVB(M$c[0]+M$a,M$c[1]+M$b,M$c[2],M$c[3],M$c[4],M$c[5],M$c[6],M$c[7])},this._fillTrangles=function(M$a,M$b,M$c){this.ctx.fillTrangles(M$c[0],M$c[1]+M$a,M$c[2]+M$b,M$c[3],M$c[4])},this._drawPath=function(M$a,M$b,M$c){var M$d=this.ctx;M$J.isWebGL&&M$d.setPathId(-1),M$d.beginPath(),M$a+=M$c[0],M$b+=M$c[1],M$J.isWebGL&&M$d.movePath(M$a,M$b);for(var M$e=M$c[2],M$f=0,M$g=M$e.length;M$f<M$g;M$f++){var M$h=M$e[M$f];switch(M$h[0]){case"moveTo":M$J.isWebGL?M$d.moveTo(M$h[1],M$h[2]):M$d.moveTo(M$a+M$h[1],M$b+M$h[2]);break;case"lineTo":M$J.isWebGL?M$d.lineTo(M$h[1],M$h[2]):M$d.lineTo(M$a+M$h[1],M$b+M$h[2]);break;case"arcTo":M$J.isWebGL?M$d.arcTo(M$h[1],M$h[2],M$h[3],M$h[4],M$h[5]):M$d.arcTo(M$a+M$h[1],M$b+M$h[2],M$a+M$h[3],M$b+M$h[4],M$h[5]);break;case"closePath":M$d.closePath()}}var M$i=M$c[3];null!=M$i&&(M$d.fillStyle=M$i.fillStyle,M$d.fill());var M$j=M$c[4];null!=M$j&&(M$d.strokeStyle=M$j.strokeStyle,M$d.lineWidth=M$j.lineWidth||1,M$d.lineJoin=M$j.lineJoin,M$d.lineCap=M$j.lineCap,M$d.miterLimit=M$j.miterLimit,M$d.stroke())},this.drawPoly=function(M$a,M$b,M$c){this.ctx.drawPoly(M$a+this.x+M$c[0],M$b+this.y+M$c[1],M$c[2],M$c[3],M$c[4],M$c[5],M$c[6])},this._drawPoly=function(M$a,M$b,M$c){var M$d=this.ctx,M$e=M$c[2],M$f=2,M$g=M$e.length;if(M$J.isWebGL)for(M$d.setPathId(M$c[6]),M$d.beginPath(),M$a+=M$c[0],M$b+=M$c[1],M$d.movePath(M$a,M$b),M$d.moveTo(M$e[0],M$e[1]);M$f<M$g;)M$d.lineTo(M$e[M$f++],M$e[M$f++]);else for(M$d.beginPath(),M$a+=M$c[0],M$b+=M$c[1],M$d.moveTo(M$a+M$e[0],M$b+M$e[1]);M$f<M$g;)M$d.lineTo(M$a+M$e[M$f++],M$b+M$e[M$f++]);M$d.closePath(),this._fillAndStroke(M$c[3],M$c[4],M$c[5],M$c[7])},this._drawSkin=function(M$a,M$b,M$c){var M$d=M$c[0];if(M$d){var M$e=this.ctx;M$d.render(M$e,M$a,M$b)}},this._drawParticle=function(M$a,M$b,M$c){this.ctx.drawParticle(M$a+this.x,M$b+this.y,M$c[0])},this._setFilters=function(M$a,M$b,M$c){this.ctx.setFilters(M$c)},M$c?this.ctx=M$c.getContext("2d"):(M$c=M$ta.create("3D"),this.ctx=M$F.createWebGLContext2D(M$c),M$c._setContext(this.ctx)),M$c.size(M$a,M$b),this.canvas=M$c}M$k(M$g,"laya.renders.RenderContext");var M$a=M$g.prototype;return M$a.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},M$a.drawTexture=function(M$a,M$b,M$c,M$d,M$e){M$a.loaded&&this.ctx.drawTexture(M$a,M$b,M$c,M$d,M$e,this.x,this.y)},M$a._drawTextures=function(M$a,M$b,M$c){M$c[0].loaded&&this.ctx.drawTextures(M$c[0],M$c[1],M$a+this.x,M$b+this.y)},M$a.drawTextureWithTransform=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){M$a.loaded&&this.ctx.drawTextureWithTransform(M$a,M$b,M$c,M$d,M$e,M$f,this.x,this.y,M$g)},M$a.fillQuadrangle=function(M$a,M$b,M$c,M$d,M$e){this.ctx.fillQuadrangle(M$a,M$b,M$c,M$d,M$e)},M$a.drawCanvas=function(M$a,M$b,M$c,M$d,M$e){this.ctx.drawCanvas(M$a,M$b+this.x,M$c+this.y,M$d,M$e)},M$a.drawRect=function(M$a,M$b,M$c,M$d,M$e,M$f){void 0===M$f&&(M$f=1);var M$g=this.ctx;M$g.strokeStyle=M$e,M$g.lineWidth=M$f,M$g.strokeRect(M$a+this.x,M$b+this.y,M$c,M$d,M$f)},M$a._fillAndStroke=function(M$a,M$b,M$c,M$d){void 0===M$d&&(M$d=!1);var M$e=this.ctx;null!=M$a&&(M$e.fillStyle=M$a,M$J.isWebGL?M$e.fill(M$d):M$e.fill()),null!=M$b&&0<M$c&&(M$e.strokeStyle=M$b,M$e.lineWidth=M$c,M$e.stroke())},M$a.clipRect=function(M$a,M$b,M$c,M$d){this.ctx.clipRect(M$a+this.x,M$b+this.y,M$c,M$d)},M$a.fillRect=function(M$a,M$b,M$c,M$d,M$e){this.ctx.fillRect(M$a+this.x,M$b+this.y,M$c,M$d,M$e)},M$a.drawCircle=function(M$a,M$b,M$c,M$d,M$e){void 0===M$e&&(M$e=1),M$X.drawCall++;var M$f=this.ctx;M$f.beginPath(),M$f.strokeStyle=M$d,M$f.lineWidth=M$e,M$f.arc(M$a+this.x,M$b+this.y,M$c,0,M$g.PI2),M$f.stroke()},M$a.drawTriangles=function(M$a,M$b,M$c){if(M$J.isWebGL)this.ctx.drawTriangles(M$c[0],M$a+M$c[1],M$b+M$c[2],M$c[3],M$c[4],M$c[5],M$c[6],M$c[7],M$c[8],M$c[9]);else{var M$d=M$c[5],M$e=0,M$f=M$d.length,M$g=this.ctx;for(M$e=0;M$e<M$f;M$e+=3){var M$h=2*M$d[M$e],M$i=2*M$d[M$e+1],M$j=2*M$d[M$e+2];M$g.drawTriangle(M$c[0],M$c[3],M$c[4],M$h,M$i,M$j,M$c[6],!0)}}},M$a.fillCircle=function(M$a,M$b,M$c,M$d){M$X.drawCall++;var M$e=this.ctx;M$e.beginPath(),M$e.fillStyle=M$d,M$e.arc(M$a+this.x,M$b+this.y,M$c,0,M$g.PI2),M$e.fill()},M$a.setShader=function(M$a){this.ctx.setShader(M$a)},M$a.drawLine=function(M$a,M$b,M$c,M$d,M$e,M$f){void 0===M$f&&(M$f=1);var M$g=this.ctx;M$g.beginPath(),M$g.strokeStyle=M$e,M$g.lineWidth=M$f,M$g.moveTo(this.x+M$a,this.y+M$b),M$g.lineTo(this.x+M$c,this.y+M$d),M$g.stroke()},M$a.clear=function(){this.ctx.clear()},M$a.transformByMatrix=function(M$a){this.ctx.transformByMatrix(M$a)},M$a.setTransform=function(M$a,M$b,M$c,M$d,M$e,M$f){this.ctx.setTransform(M$a,M$b,M$c,M$d,M$e,M$f)},M$a.setTransformByMatrix=function(M$a){this.ctx.setTransformByMatrix(M$a)},M$a.save=function(){this.ctx.save()},M$a.restore=function(){this.ctx.restore()},M$a.translate=function(M$a,M$b){this.ctx.translate(M$a,M$b)},M$a.transform=function(M$a,M$b,M$c,M$d,M$e,M$f){this.ctx.transform(M$a,M$b,M$c,M$d,M$e,M$f)},M$a.rotate=function(M$a){this.ctx.rotate(M$a)},M$a.scale=function(M$a,M$b){this.ctx.scale(M$a,M$b)},M$a.alpha=function(M$a){this.ctx.globalAlpha*=M$a},M$a.setAlpha=function(M$a){this.ctx.globalAlpha=M$a},M$a.fillWords=function(M$a,M$b,M$c,M$d,M$e,M$f){void 0===M$f&&(M$f=0),this.ctx.fillWords(M$a,M$b,M$c,M$d,M$e,M$f)},M$a.fillBorderWords=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this.ctx.fillBorderWords(M$a,M$b,M$c,M$d,M$e,M$f,M$g)},M$a.fillText=function(M$a,M$b,M$c,M$d,M$e,M$f){this.ctx.fillText(M$a,M$b+this.x,M$c+this.y,M$d,M$e,M$f)},M$a.strokeText=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this.ctx.strokeText(M$a,M$b+this.x,M$c+this.y,M$d,M$e,M$f,M$g)},M$a.blendMode=function(M$a){this.ctx.globalCompositeOperation=M$a},M$a.flush=function(){this.ctx.flush&&this.ctx.flush()},M$a.addRenderObject=function(M$a){this.ctx.addRenderObject(M$a)},M$a.beginClip=function(M$a,M$b,M$c,M$d){this.ctx.beginClip&&this.ctx.beginClip(M$a,M$b,M$c,M$d)},M$a.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},M$a.fillTrangles=function(M$a,M$b,M$c){this.ctx.fillTrangles(M$c[0],M$c[1],M$c[2],M$c[3],4<M$c.length?M$c[4]:null)},M$g.PI2=2*Math.PI,M$g}(),M$L=function(){function M$g(M$a,M$b){switch(this._next=M$b||M$g.NORENDER,M$a){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=M$r._filter);case 69905:return void(this._fun=M$g._initRenderFun)}this.onCreate(M$a)}M$k(M$g,"laya.renders.RenderSprite");var M$a=M$g.prototype;return M$a.onCreate=function(M$a){},M$a._style=function(M$a,M$b,M$c,M$d){M$a._style.render(M$a,M$b,M$c,M$d);var M$e=this._next;M$e._fun.call(M$e,M$a,M$b,M$c,M$d)},M$a._no=function(M$a,M$b,M$c,M$d){},M$a._custom=function(M$a,M$b,M$c,M$d){M$a.customRender(M$b,M$c,M$d);var M$e=M$a._style._tf;this._next._fun.call(this._next,M$a,M$b,M$c-M$e.translateX,M$d-M$e.translateY)},M$a._clip=function(M$a,M$b,M$c,M$d){var M$e=this._next;if(M$e!=M$g.NORENDER){var M$f=M$a._style.scrollRect;M$b.ctx.save(),M$b.ctx.clipRect(M$c,M$d,M$f.width,M$f.height),M$e._fun.call(M$e,M$a,M$b,M$c-M$f.x,M$d-M$f.y),M$b.ctx.restore()}},M$a._blend=function(M$a,M$b,M$c,M$d){var M$e=M$a._style;M$e.blendMode&&(M$b.ctx.globalCompositeOperation=M$e.blendMode);var M$f=this._next;M$f._fun.call(M$f,M$a,M$b,M$c,M$d),M$b.ctx.globalCompositeOperation="source-over"},M$a._mask=function(M$a,M$b,M$c,M$d){var M$e=this._next;M$e._fun.call(M$e,M$a,M$b,M$c,M$d);var M$f=M$a.mask;M$f&&(M$b.ctx.globalCompositeOperation="destination-in",(0<M$f.numChildren||!M$f.graphics._isOnlyOne())&&(M$f.cacheAsBitmap=!0),M$f.render(M$b,M$c-M$a.pivotX,M$d-M$a.pivotY)),M$b.ctx.globalCompositeOperation="source-over"},M$a._graphics=function(M$a,M$b,M$c,M$d){var M$e=M$a._style._tf;M$a._graphics&&M$a._graphics._render(M$a,M$b,M$c-M$e.translateX,M$d-M$e.translateY);var M$f=this._next;M$f._fun.call(M$f,M$a,M$b,M$c,M$d)},M$a._image=function(M$a,M$b,M$c,M$d){var M$e=M$a._style;M$b.ctx.drawTexture2(M$c,M$d,M$e._tf.translateX,M$e._tf.translateY,M$a.transform,M$e.alpha,M$e.blendMode,M$a._graphics._one)},M$a._image2=function(M$a,M$b,M$c,M$d){var M$e=M$a._style._tf;M$b.ctx.drawTexture2(M$c,M$d,M$e.translateX,M$e.translateY,M$a.transform,1,null,M$a._graphics._one)},M$a._alpha=function(M$a,M$b,M$c,M$d){var M$e;if(.01<(M$e=M$a._style.alpha)||M$a._needRepaint()){var M$f=M$b.ctx.globalAlpha;M$b.ctx.globalAlpha*=M$e;var M$g=this._next;M$g._fun.call(M$g,M$a,M$b,M$c,M$d),M$b.ctx.globalAlpha=M$f}},M$a._transform=function(M$a,M$b,M$c,M$d){var M$e=M$a.transform,M$f=this._next;M$e&&M$f!=M$g.NORENDER?(M$b.save(),M$b.transform(M$e.a,M$e.b,M$e.c,M$e.d,M$e.tx+M$c,M$e.ty+M$d),M$f._fun.call(M$f,M$a,M$b,0,0),M$b.restore()):M$f._fun.call(M$f,M$a,M$b,M$c,M$d)},M$a._childs=function(M$a,M$b,M$c,M$d){var M$e=M$a._style,M$f=M$e._tf;if(M$c=M$c-M$f.translateX+M$e.paddingLeft,M$d=M$d-M$f.translateY+M$e.paddingTop,M$e._calculation){var M$g=M$a._getWords();if(M$g){var M$h=M$e;M$h&&(M$h.stroke?M$b.fillBorderWords(M$g,M$c,M$d,M$h.font,M$h.color,M$h.strokeColor,M$h.stroke):M$b.fillWords(M$g,M$c,M$d,M$h.font,M$h.color,"none"!=M$h.textDecoration&&M$h.underLine?1:0))}}var M$i,M$j=M$a._childs,M$k=M$j.length;if(M$a.viewport||M$a.optimizeScrollRect&&M$a._style.scrollRect){var M$l=M$a.viewport||M$a._style.scrollRect,M$m=M$l.x,M$n=M$l.y,M$o=M$l.right,M$p=M$l.bottom,M$q=NaN,M$r=NaN;for(M$s=0;M$s<M$k;++M$s)(M$i=M$j[M$s]).visible&&(M$q=M$i._x)<M$o&&M$q+M$i.width>M$m&&(M$r=M$i._y)<M$p&&M$r+M$i.height>M$n&&M$i.render(M$b,M$c,M$d)}else for(var M$s=0;M$s<M$k;++M$s)(M$i=M$j[M$s])._style.visible&&M$i.render(M$b,M$c,M$d)},M$a._canvas=function(M$a,M$b,M$c,M$d){var M$e=M$a._$P.cacheCanvas;if(M$e){"bitmap"===M$e.type?M$X.canvasBitmap++:M$X.canvasNormal++;var M$f=M$e.ctx;if(M$a._needRepaint()||!M$f)this._canvas_repaint(M$a,M$b,M$c,M$d);else{var M$g=M$e._cacheRec;M$b.drawCanvas(M$f.canvas,M$c+M$g.x,M$d+M$g.y,M$g.width,M$g.height)}}else this._next._fun.call(this._next,M$a,M$b,M$c,M$d)},M$a._canvas_repaint=function(M$a,M$b,M$c,M$d){var M$e=M$a._$P.cacheCanvas,M$f=this._next;if(M$e){var M$g,M$h,M$i,M$j,M$k=M$e.ctx,M$l=M$a._needRepaint()||!M$k,M$m=M$e.type;if("bitmap"===M$m?M$X.canvasBitmap++:M$X.canvasNormal++,M$l){var M$n,M$o;M$e._cacheRec||(M$e._cacheRec=new M$B),M$J.isWebGL&&"bitmap"!==M$m?M$e._cacheRec.setTo(-M$a.pivotX,-M$a.pivotY,1,1):((M$j=M$a.getSelfBounds()).x=M$j.x-M$a.pivotX,M$j.y=M$j.y-M$a.pivotY,M$j.x=M$j.x-16,M$j.y=M$j.y-16,M$j.width=M$j.width+32,M$j.height=M$j.height+32,M$j.x=Math.floor(M$j.x+M$c)-M$c,M$j.y=Math.floor(M$j.y+M$d)-M$d,M$j.width=Math.floor(M$j.width),M$j.height=Math.floor(M$j.height),M$e._cacheRec.copyFrom(M$j)),M$j=M$e._cacheRec;var M$p,M$q=M$J.isWebGL?1:M$O.pixelRatio*M$x.stage.clientScaleX,M$r=M$J.isWebGL?1:M$O.pixelRatio*M$x.stage.clientScaleY;if(!M$J.isWebGL){var M$s,M$t=1,M$u=1;for(M$s=M$a;M$s&&M$s!=M$x.stage;)M$t*=M$s.scaleX,M$u*=M$s.scaleY,M$s=M$s.parent;M$J.isWebGL?(M$t<1&&(M$q*=M$t),M$u<1&&(M$r*=M$u)):(1<M$t&&(M$q*=M$t),1<M$u&&(M$r*=M$u))}if(M$a.scrollRect){var M$v=M$a.scrollRect;M$j.x-=M$v.x,M$j.y-=M$v.y}if(M$n=M$j.width*M$q,M$o=M$j.height*M$r,M$h=M$j.x,M$i=M$j.y,M$J.isWebGL&&"bitmap"===M$m&&(2048<M$n||2048<M$o))return console.warn("cache bitmap size larger than 2048,cache ignored"),M$e.ctx&&(M$W.recover("RenderContext",M$e.ctx),M$e.ctx.canvas.size(0,0),M$e.ctx=null),void M$f._fun.call(M$f,M$a,M$b,M$c,M$d);if(M$k||(M$k=M$e.ctx=M$W.getItem("RenderContext")||new M$K(M$n,M$o,M$ta.create("AUTO"))),M$k.ctx.sprite=M$a,(M$g=M$k.canvas).clear(),(M$g.width!=M$n||M$g.height!=M$o)&&M$g.size(M$n,M$o),"bitmap"===M$m?M$g.context.asBitmap=!0:"normal"===M$m&&(M$g.context.asBitmap=!1),1!=M$q||1!=M$r){var M$w=M$k.ctx;M$w.save(),M$w.scale(M$q,M$r),!M$J.isConchWebGL&&M$J.isConchApp&&(M$p=M$a._$P.cf)&&M$w.setFilterMatrix&&M$w.setFilterMatrix(M$p._mat,M$p._alpha),M$f._fun.call(M$f,M$a,M$k,-M$h,-M$i),M$w.restore(),M$J.isConchApp&&!M$J.isConchWebGL||M$a._applyFilters()}else M$w=M$k.ctx,!M$J.isConchWebGL&&M$J.isConchApp&&(M$p=M$a._$P.cf)&&M$w.setFilterMatrix&&M$w.setFilterMatrix(M$p._mat,M$p._alpha),M$f._fun.call(M$f,M$a,M$k,-M$h,-M$i),M$J.isConchApp&&!M$J.isConchWebGL||M$a._applyFilters();M$a._$P.staticCache&&(M$e.reCache=!1),M$X.canvasReCache++}else M$h=(M$j=M$e._cacheRec).x,M$i=M$j.y,M$g=M$k.canvas;M$b.drawCanvas(M$g,M$c+M$h,M$d+M$i,M$j.width,M$j.height)}else M$f._fun.call(M$f,M$a,M$k,M$c,M$d)},M$g.__init__=function(){var M$a,M$b,M$c=0;for(M$b=M$F.createRenderSprite(69905,null),M$a=M$g.renders.length=4096,M$c=0;M$c<M$a;M$c++)M$g.renders[M$c]=M$b;M$g.renders[0]=M$F.createRenderSprite(0,null),function(M$a,M$b){for(var M$c=0,M$d=0;M$d<M$a.length;M$d++)M$c|=M$a[M$d],M$g.renders[M$c]=M$b}([1,512,4,2],new M$g(1,null)),M$g.renders[513]=M$F.createRenderSprite(513,null),M$g.renders[517]=new M$g(517,null)},M$g._initRenderFun=function(M$a,M$b,M$c,M$d){var M$e=M$a._renderType;(M$g.renders[M$e]=M$g._getTypeRender(M$e))._fun(M$a,M$b,M$c,M$d)},M$g._getTypeRender=function(M$a){for(var M$b=null,M$c=2048;1<M$c;)M$c&M$a&&(M$b=M$F.createRenderSprite(M$c,M$b)),M$c>>=1;return M$b},M$g.IMAGE=1,M$g.ALPHA=2,M$g.TRANSFORM=4,M$g.BLEND=8,M$g.CANVAS=16,M$g.FILTERS=32,M$g.MASK=64,M$g.CLIP=128,M$g.STYLE=256,M$g.GRAPHICS=512,M$g.CUSTOM=1024,M$g.CHILDS=2048,M$g.INIT=69905,M$g.renders=[],M$g.NORENDER=new M$g(0,null),M$g}(),M$M=function(){function M$h(){this._repaint=!1}M$k(M$h,"laya.resource.Context");var M$a=M$h.prototype;return M$a.replaceReset=function(){var M$a,M$b,M$c=0;for(M$a=M$h.replaceKeys.length,M$c=0;M$c<M$a;M$c++)M$b=M$h.replaceKeys[M$c],this[M$h.newKeys[M$c]]=this[M$b]},M$a.replaceResotre=function(){this.__restore(),this.__reset()},M$a.setIsMainContext=function(){},M$a.drawTextures=function(M$a,M$b,M$c,M$d){M$X.drawCall+=M$b.length/2;for(var M$e=M$a.width,M$f=M$a.height,M$g=0,M$h=M$b.length;M$g<M$h;M$g+=2)this.drawTexture(M$a,M$b[M$g],M$b[M$g+1],M$e,M$f,M$c,M$d)},M$a.drawCanvas=function(M$a,M$b,M$c,M$d,M$e){M$X.drawCall++,this.drawImage(M$a.source,M$b,M$c,M$d,M$e)},M$a.fillRect=function(M$a,M$b,M$c,M$d,M$e){M$X.drawCall++,M$e&&(this.fillStyle=M$e),this.__fillRect(M$a,M$b,M$c,M$d)},M$a.fillText=function(M$a,M$b,M$c,M$d,M$e,M$f){M$X.drawCall++,3<arguments.length&&null!=M$d&&(this.font=M$d,this.fillStyle=M$e,this.textAlign=M$f,this.textBaseline="top"),this.__fillText(M$a,M$b,M$c)},M$a.fillBorderText=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){M$X.drawCall++,this.font=M$d,this.fillStyle=M$e,this.textBaseline="top",this.strokeStyle=M$f,this.lineWidth=M$g,this.textAlign=M$h,this.__strokeText(M$a,M$b,M$c),this.__fillText(M$a,M$b,M$c)},M$a.strokeText=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){M$X.drawCall++,3<arguments.length&&null!=M$d&&(this.font=M$d,this.strokeStyle=M$e,this.lineWidth=M$f,this.textAlign=M$g,this.textBaseline="top"),this.__strokeText(M$a,M$b,M$c)},M$a.transformByMatrix=function(M$a){this.transform(M$a.a,M$a.b,M$a.c,M$a.d,M$a.tx,M$a.ty)},M$a.setTransformByMatrix=function(M$a){this.setTransform(M$a.a,M$a.b,M$a.c,M$a.d,M$a.tx,M$a.ty)},M$a.clipRect=function(M$a,M$b,M$c,M$d){M$X.drawCall++,this.beginPath(),this.rect(M$a,M$b,M$c,M$d),this.clip()},M$a.drawTexture=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){M$X.drawCall++;var M$h=M$a.uv,M$i=M$a.bitmap.width,M$j=M$a.bitmap.height;this.drawImage(M$a.source,M$h[0]*M$i,M$h[1]*M$j,(M$h[2]-M$h[0])*M$i,(M$h[5]-M$h[3])*M$j,M$b+M$f,M$c+M$g,M$d,M$e)},M$a.drawTextureWithTransform=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){M$X.drawCall++;var M$j=M$a.uv,M$k=M$a.bitmap.width,M$l=M$a.bitmap.height;this.save(),1!=M$i&&(this.globalAlpha*=M$i),M$f?(this.transform(M$f.a,M$f.b,M$f.c,M$f.d,M$f.tx+M$g,M$f.ty+M$h),this.drawImage(M$a.source,M$j[0]*M$k,M$j[1]*M$l,(M$j[2]-M$j[0])*M$k,(M$j[5]-M$j[3])*M$l,M$b,M$c,M$d,M$e)):this.drawImage(M$a.source,M$j[0]*M$k,M$j[1]*M$l,(M$j[2]-M$j[0])*M$k,(M$j[5]-M$j[3])*M$l,M$b+M$g,M$c+M$h,M$d,M$e),this.restore()},M$a.drawTexture2=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){var M$i=M$h[0];if(M$i.loaded&&M$i.bitmap&&M$i.source){M$X.drawCall++;var M$j=1!==M$f;if(M$j){var M$k=this.globalAlpha;this.globalAlpha*=M$f}var M$l=M$i.uv,M$m=M$i.bitmap.width,M$n=M$i.bitmap.height;M$e?(this.save(),this.transform(M$e.a,M$e.b,M$e.c,M$e.d,M$e.tx+M$a,M$e.ty+M$b),this.drawImage(M$i.source,M$l[0]*M$m,M$l[1]*M$n,(M$l[2]-M$l[0])*M$m,(M$l[5]-M$l[3])*M$n,M$h[1]-M$c,M$h[2]-M$d,M$h[3],M$h[4]),this.restore()):this.drawImage(M$i.source,M$l[0]*M$m,M$l[1]*M$n,(M$l[2]-M$l[0])*M$m,(M$l[5]-M$l[3])*M$n,M$h[1]-M$c+M$a,M$h[2]-M$d+M$b,M$h[3],M$h[4]),M$j&&(this.globalAlpha=M$k)}},M$a.fillTexture=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){if(!M$h.pat){if(M$a.uv!=M$ka.DEF_UV){var M$i=new M$ta("2D");M$i.getContext("2d"),M$i.size(M$a.width,M$a.height),M$i.context.drawTexture(M$a,0,0,M$a.width,M$a.height,0,0),M$a=new M$ka(M$i)}M$h.pat=this.createPattern(M$a.bitmap.source,M$f)}var M$j=M$b,M$k=M$c,M$l=0,M$m=0;M$g&&(M$j+=M$g.x%M$a.width,M$k+=M$g.y%M$a.height,M$l-=M$g.x%M$a.width,M$m-=M$g.y%M$a.height),this.translate(M$j,M$k),this.fillRect(M$l,M$m,M$d,M$e,M$h.pat),this.translate(-M$j,-M$k)},M$a.drawTriangle=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){var M$i=M$a.bitmap,M$j=M$i.source,M$k=M$a.width,M$l=M$a.height,M$m=M$i.width,M$n=M$i.height,M$o=M$c[M$d]*M$m,M$p=M$c[M$e]*M$m,M$q=M$c[M$f]*M$m,M$r=M$c[M$d+1]*M$n,M$s=M$c[M$e+1]*M$n,M$t=M$c[M$f+1]*M$n,M$u=M$b[M$d],M$v=M$b[M$e],M$w=M$b[M$f],M$x=M$b[M$d+1],M$A=M$b[M$e+1],M$B=M$b[M$f+1];if(M$h){var M$C=(M$u+M$v+M$w)/3,M$D=(M$x+M$A+M$B)/3,M$E=M$u-M$C,M$F=M$x-M$D,M$G=Math.sqrt(M$E*M$E+M$F*M$F);M$u=M$C+M$E/M$G*(M$G+1),M$x=M$D+M$F/M$G*(M$G+1),M$F=M$A-M$D,M$v=M$C+(M$E=M$v-M$C)/(M$G=Math.sqrt(M$E*M$E+M$F*M$F))*(M$G+1),M$A=M$D+M$F/M$G*(M$G+1),M$F=M$B-M$D,M$w=M$C+(M$E=M$w-M$C)/(M$G=Math.sqrt(M$E*M$E+M$F*M$F))*(M$G+1),M$B=M$D+M$F/M$G*(M$G+1)}this.save(),M$g&&this.transform(M$g.a,M$g.b,M$g.c,M$g.d,M$g.tx,M$g.ty),this.beginPath(),this.moveTo(M$u,M$x),this.lineTo(M$v,M$A),this.lineTo(M$w,M$B),this.closePath(),this.clip();var M$H=1/(M$o*M$s+M$r*M$q+M$p*M$t-M$s*M$q-M$r*M$p-M$o*M$t),M$I=M$u*M$s+M$r*M$w+M$v*M$t-M$s*M$w-M$r*M$v-M$u*M$t,M$J=M$o*M$v+M$u*M$q+M$p*M$w-M$v*M$q-M$u*M$p-M$o*M$w,M$K=M$o*M$s*M$w+M$r*M$v*M$q+M$u*M$p*M$t-M$u*M$s*M$q-M$r*M$p*M$w-M$o*M$v*M$t,M$L=M$x*M$s+M$r*M$B+M$A*M$t-M$s*M$B-M$r*M$A-M$x*M$t,M$M=M$o*M$A+M$x*M$q+M$p*M$B-M$A*M$q-M$x*M$p-M$o*M$B,M$N=M$o*M$s*M$B+M$r*M$A*M$q+M$x*M$p*M$t-M$x*M$s*M$q-M$r*M$p*M$B-M$o*M$A*M$t;this.transform(M$I*M$H,M$L*M$H,M$J*M$H,M$M*M$H,M$K*M$H,M$N*M$H),this.drawImage(M$j,M$a.uv[0]*M$m,M$a.uv[1]*M$n,M$k,M$l,M$a.uv[0]*M$m,M$a.uv[1]*M$n,M$k,M$l),this.restore()},M$a.flush=function(){return 0},M$a.fillWords=function(M$a,M$b,M$c,M$d,M$e,M$f){M$d&&(this.font=M$d),M$e&&(this.fillStyle=M$e);this.textBaseline="top",this.textAlign="left";for(var M$g=0,M$h=M$a.length;M$g<M$h;M$g++){var M$i=M$a[M$g];if(this.__fillText(M$i.char,M$i.x+M$b,M$i.y+M$c),1===M$f){var M$j=M$i.height,M$k=.5*M$i.style.letterSpacing;M$k||(M$k=0),this.beginPath(),this.strokeStyle=M$e,this.lineWidth=1,this.moveTo(M$b+M$i.x-M$k+.5,M$c+M$i.y+M$j+.5),this.lineTo(M$b+M$i.x+M$i.width+M$k+.5,M$c+M$i.y+M$j+.5),this.stroke()}}},M$a.fillBorderWords=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){M$d&&(this.font=M$d),M$e&&(this.fillStyle=M$e),this.textBaseline="top",this.lineWidth=M$g,this.textAlign="left",this.strokeStyle=M$f;for(var M$h=0,M$i=M$a.length;M$h<M$i;M$h++){var M$j=M$a[M$h];this.__strokeText(M$j.char,M$j.x+M$b,M$j.y+M$c),this.__fillText(M$j.char,M$j.x+M$b,M$j.y+M$c)}},M$a.destroy=function(){this.canvas.width=this.canvas.height=0},M$a.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},M$a.drawCurves=function(M$a,M$b,M$c){this.beginPath(),this.strokeStyle=M$c[3],this.lineWidth=M$c[4];var M$d=M$c[2];M$a+=M$c[0],M$b+=M$c[1],this.moveTo(M$a+M$d[0],M$b+M$d[1]);for(var M$e=2,M$f=M$d.length;M$e<M$f;)this.quadraticCurveTo(M$a+M$d[M$e++],M$b+M$d[M$e++],M$a+M$d[M$e++],M$b+M$d[M$e++]);this.stroke()},M$h.__init__=function(M$b){var M$c=laya.resource.Context.prototype;if(!(M$b=M$b||CanvasRenderingContext2D.prototype).inited){M$b.inited=!0,M$b.__fillText=M$b.fillText,M$b.__fillRect=M$b.fillRect,M$b.__strokeText=M$b.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(M$a){M$b[M$a]=M$c[M$a]})}},M$h.replaceCanvasGetSet=function(M$a,M$b){var M$c=Object.getOwnPropertyDescriptor(M$a,M$b);if(!M$c||!M$c.configurable)return!1;var M$d,M$e={};for(M$d in M$c)"set"!=M$d&&(M$e[M$d]=M$c[M$d]);var M$f=M$c.set;return M$e.set=function(M$a){M$f.call(this,M$a);var M$b=this.getContext("2d");M$b&&"__reset"in M$b&&M$b.__reset()},Object.defineProperty(M$a,M$b,M$e),!0},M$h.replaceGetSet=function(M$a,M$b){var M$c=Object.getOwnPropertyDescriptor(M$a,M$b);if(!M$c||!M$c.configurable)return!1;var M$d,M$e={};for(M$d in M$c)"set"!=M$d&&(M$e[M$d]=M$c[M$d]);var M$f=M$c.set,M$g="___"+M$b+"__";return M$h.newKeys.push(M$g),M$e.set=function(M$a){M$a!=this[M$g]&&(this[M$g]=M$a,M$f.call(this,M$a))},Object.defineProperty(M$a,M$b,M$e),!0},M$h._default=new M$h,M$h.newKeys=[],M$i(M$h,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),M$h}(),M$N=function(){function M$f(M$a){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++M$f._uniqueIDCounter,this._name=M$a||"Content Manager",M$f._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,M$f._resourceManagers.push(this),this._resources=[],this._records={}}M$k(M$f,"laya.resource.ResourceManager");var M$a=M$f.prototype;return M$x.imps(M$a,{"laya.resource.IDispose":!0}),M$a.getResourceByIndex=function(M$a){return this._resources[M$a]},M$a.getResourcesLength=function(){return this._resources.length},M$a.addResource=function(M$a){return M$a.resourceManager&&M$a.resourceManager.removeResource(M$a),-1===this._resources.indexOf(M$a)&&((M$a._resourceManager=this)._resources.push(M$a),this.addRecord(M$a.uri,M$a.__className,M$a.memorySize),this.addSize(M$a.memorySize),!0)},M$a.removeResource=function(M$a){var M$b=this._resources.indexOf(M$a);return-1!==M$b&&(this._resources.splice(M$b,1),M$a._resourceManager=null,this._memorySize-=M$a.memorySize,this.addRecord(M$a.uri,M$a.__className,-M$a.memorySize),!0)},M$a.unload=function(){for(var M$a=this._resources.slice(0,this._resources.length),M$b=0;M$b<M$a.length;M$b++){M$a[M$b].destroy()}M$a.length=0},M$a.dispose=function(){if(this===M$f._systemResourceManager)throw new Error("systemResourceManager不能被释放！");M$f._resourceManagers.splice(M$f._resourceManagers.indexOf(this),1),M$f._isResourceManagersSorted=!1;for(var M$a=this._resources.slice(0,this._resources.length),M$b=0;M$b<M$a.length;M$b++){var M$c=M$a[M$b];M$c.resourceManager.removeResource(M$c),M$c.destroy()}M$a.length=0},M$a.addSize=function(M$a){M$a&&(this.autoRelease&&0<M$a&&this._memorySize+M$a>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=M$a)},M$a.addRecord=function(M$a,M$b,M$c){DEBUG&&M$c&&!M$a&&console.error(M$a,M$b,M$c),M$a&&(this._records.hasOwnProperty(M$b+"|"+M$a)||(this._records[M$b+"|"+M$a]=0),this._records[M$b+"|"+M$a]+=M$c,DEBUG&&this._records[M$b+"|"+M$a]<0&&console.error(M$a,M$b,this._records[M$b+"|"+M$a]))},M$a.garbageCollection=function(M$a){var M$b=this._resources;(M$b=M$b.slice()).sort(function(M$a,M$b){if(!M$a||!M$b)throw new Error("a或b不能为空！");return M$a.released&&M$b.released?0:M$a.released?1:M$b.released?-1:M$a._lastUseFrameCount-M$b._lastUseFrameCount});for(var M$c=M$X.loopCount,M$d=0,M$e=M$b.length;M$d<M$e;M$d++){var M$f=M$b[M$d];if(!(1<M$c-M$f._lastUseFrameCount))return void(this._memorySize>=M$a&&(this._isOverflow=!0));if(M$f.releaseResource(),this._memorySize<M$a)return void(this._isOverflow=!1)}},M$o(0,M$a,"id",function(){return this._id}),M$o(0,M$a,"name",function(){return this._name},function(M$a){!M$a&&""===M$a||this._name===M$a||(this._name=M$a,M$f._isResourceManagersSorted=!1)}),M$o(0,M$a,"memorySize",function(){return this._memorySize}),M$o(0,M$a,"records",function(){return this._records}),M$o(1,M$f,"systemResourceManager",function(){return M$f._systemResourceManager}),M$f.__init__=function(){M$f.currentResourceManager=M$f.systemResourceManager},M$f.getLoadedResourceManagerByIndex=function(M$a){return M$f._resourceManagers[M$a]},M$f.getLoadedResourceManagersCount=function(){return M$f._resourceManagers.length},M$f.recreateContentManagers=function(M$a){void 0===M$a&&(M$a=!1);for(var M$b=M$f.currentResourceManager,M$c=0;M$c<M$f._resourceManagers.length;M$c++){M$f.currentResourceManager=M$f._resourceManagers[M$c];for(var M$d=0;M$d<M$f.currentResourceManager._resources.length;M$d++)M$f.currentResourceManager._resources[M$d].releaseResource(M$a),M$f.currentResourceManager._resources[M$d].activeResource(M$a)}M$f.currentResourceManager=M$b},M$f.releaseContentManagers=function(M$a){void 0===M$a&&(M$a=!1);for(var M$b=M$f.currentResourceManager,M$c=0;M$c<M$f._resourceManagers.length;M$c++){M$f.currentResourceManager=M$f._resourceManagers[M$c];for(var M$d=0;M$d<M$f.currentResourceManager._resources.length;M$d++){var M$e=M$f.currentResourceManager._resources[M$d];!M$e.released&&M$e.releaseResource(M$a)}}M$f.currentResourceManager=M$b},M$f._uniqueIDCounter=0,M$f._isResourceManagersSorted=!1,M$f._resourceManagers=[],M$i(M$f,["_systemResourceManager",function(){return this._systemResourceManager=new M$f("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=M$f._systemResourceManager}]),M$f}(),M$O=(function(){function M$a(){}M$k(M$a,"laya.system.System"),M$a.changeDefinition=function(M$a,M$b){M$x[M$a]=M$b;var M$c=M$a+"=classObj";M$x._runScript(M$c)},M$a.__init__=function(){M$J.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function M$c(){}return M$k(M$c,"laya.utils.Browser"),M$o(1,M$c,"pixelRatio",function(){return M$c.__init__(),-1<M$c.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:M$F.getPixelRatio()}),M$o(1,M$c,"height",function(){return M$c.__init__(),(M$x.stage&&M$x.stage.canvasRotation?M$c.clientWidth:M$c.clientHeight)*M$c.pixelRatio}),M$o(1,M$c,"clientWidth",function(){return M$c.__init__(),M$c.window.innerWidth||M$c.document.body.clientWidth}),M$o(1,M$c,"window",function(){return M$c.__init__(),M$c._window}),M$o(1,M$c,"clientHeight",function(){return M$c.__init__(),M$c.window.innerHeight||M$c.document.body.clientHeight||M$c.document.documentElement.clientHeight}),M$o(1,M$c,"width",function(){return M$c.__init__(),(M$x.stage&&M$x.stage.canvasRotation?M$c.clientHeight:M$c.clientWidth)*M$c.pixelRatio}),M$o(1,M$c,"container",function(){return M$c.__init__(),M$c._container||((M$c._container=M$c.createElement("div")).id="layaContainer",M$c.document.body.appendChild(M$c._container)),M$c._container},function(M$a){M$c._container=M$a}),M$o(1,M$c,"document",function(){return M$c.__init__(),M$c._document}),M$c.__init__=function(){if(!M$c._window){M$c._window=M$F.getWindow(),M$c._document=M$c.window.document,M$c._window.addEventListener("message",function(M$a){laya.utils.Browser._onMessage(M$a)},!1),M$c.document.__createElement=M$c.document.createElement,M$g.requestAnimationFrame=M$g.requestAnimationFrame||M$g.webkitRequestAnimationFrame||M$g.mozRequestAnimationFrame||M$g.oRequestAnimationFrame||M$g.msRequestAnimationFrame||function(M$a){return M$g.setTimeout(M$a,1e3/60)};var M$a=M$g.document.body.style;M$a["-webkit-user-select"]="none",M$a["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",M$c.userAgent=M$c.window.navigator.userAgent,M$c.onIOS=!!(M$c.u=M$c.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),M$c.onMobile=-1<M$c.u.indexOf("Mobile"),M$c.onIPhone=-1<M$c.u.indexOf("iPhone"),M$c.onMac=-1<M$c.u.indexOf("Mac OS X"),M$c.onIPad=-1<M$c.u.indexOf("iPad"),M$c.onAndroid=-1<M$c.u.indexOf("Android")||-1<M$c.u.indexOf("Adr"),M$c.onWP=-1<M$c.u.indexOf("Windows Phone"),M$c.onQQBrowser=-1<M$c.u.indexOf("QQBrowser"),M$c.onMQQBrowser=-1<M$c.u.indexOf("MQQBrowser")||-1<M$c.u.indexOf("Mobile")&&-1<M$c.u.indexOf("QQ"),M$c.onIE=!!M$c.window.ActiveXObject||"ActiveXObject"in M$c.window,M$c.onWeiXin=-1<M$c.u.indexOf("MicroMessenger"),M$c.onPC=!M$c.onMobile,M$c.onSafari=-1<M$c.u.indexOf("Safari"),M$c.onFirefox=-1<M$c.u.indexOf("Firefox"),M$c.onEdge=-1<M$c.u.indexOf("Edge"),M$c.onMiniGame=-1<M$c.u.indexOf("MiniGame"),M$c.onLimixiu=-1<M$c.u.indexOf("limixiu"),M$c.httpProtocol="http:"==M$c.window.location.protocol,M$c.onMiniGame&&null==M$c.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),M$c.webAudioEnabled=!!(M$c.window.AudioContext||M$c.window.webkitAudioContext||M$c.window.mozAudioContext),M$c.soundType=M$c.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",M$ea=M$c.webAudioEnabled?M$fa:M$ca,M$c.webAudioEnabled&&M$fa.initWebAudio(),M$ca._initMusicAudio(),M$c.enableTouch="ontouchstart"in M$g||M$g.DocumentTouch&&M$b instanceof DocumentTouch,M$g.focus(),M$E._soundClass=M$ea,M$E._musicClass=M$ca,M$J._mainCanvas=M$J._mainCanvas||M$ta.create("2D"),M$c.canvas||(M$c.canvas=M$ta.create("2D"),M$c.context=M$c.canvas.getContext("2d"))}},M$c._onMessage=function(M$a){if(M$a.data&&"size"==M$a.data.name){if(M$c.window.innerWidth=M$a.data.width,M$c.window.innerHeight=M$a.data.height,M$c.window.__innerHeight=M$a.data.clientHeight,!M$c.document.createEvent)return void console.warn("no document.createEvent");var M$b=M$c.document.createEvent("HTMLEvents");return M$b.initEvent("resize",!1,!1),void M$c.window.dispatchEvent(M$b)}},M$c.createElement=function(M$a){return M$c.__init__(),M$c.document.__createElement(M$a)},M$c.getElementById=function(M$a){return M$c.__init__(),M$c.document.getElementById(M$a)},M$c.removeElement=function(M$a){M$a&&M$a.parentNode&&M$a.parentNode.removeChild(M$a)},M$c.now=function(){return M$F.now()},M$c._window=null,M$c._document=null,M$c._container=null,M$c.userAgent=null,M$c.u=null,M$c.onIOS=!1,M$c.onMac=!1,M$c.onMobile=!1,M$c.onIPhone=!1,M$c.onIPad=!1,M$c.onAndroid=!1,M$c.onWP=!1,M$c.onQQBrowser=!1,M$c.onMQQBrowser=!1,M$c.onSafari=!1,M$c.onFirefox=!1,M$c.onEdge=!1,M$c.onIE=!1,M$c.onWeiXin=!1,M$c.onMiniGame=!1,M$c.onLimixiu=!1,M$c.onPC=!1,M$c.httpProtocol=!1,M$c.webAudioEnabled=!1,M$c.soundType=null,M$c.enableTouch=!1,M$c.canvas=null,M$c.context=null,M$c.__init$=function(){},M$c}()),M$P=function(){function M$b(M$a){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,M$a?(this._u8d_=new Uint8Array(M$a),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}M$k(M$b,"laya.utils.Byte");var M$a=M$b.prototype;return M$a.___resizeBuffer=function(M$b){try{var M$a=new Uint8Array(M$b);null!=this._u8d_&&(this._u8d_.length<=M$b?M$a.set(this._u8d_):M$a.set(this._u8d_.subarray(0,M$b))),this._u8d_=M$a,this._d_=new DataView(M$a.buffer)}catch(M$a){throw"___resizeBuffer err:"+M$b}},M$a.getString=function(){return this.rUTF(this.getUint16())},M$a.getFloat32Array=function(M$a,M$b){var M$c=M$a+M$b;M$c=M$c>this._length?this._length:M$c;var M$d=new Float32Array(this._d_.buffer.slice(M$a,M$c));return this._pos_=M$c,M$d},M$a.getUint8Array=function(M$a,M$b){var M$c=M$a+M$b;M$c=M$c>this._length?this._length:M$c;var M$d=new Uint8Array(this._d_.buffer.slice(M$a,M$c));return this._pos_=M$c,M$d},M$a.getInt16Array=function(M$a,M$b){var M$c=M$a+M$b;M$c=M$c>this._length?this._length:M$c;var M$d=new Int16Array(this._d_.buffer.slice(M$a,M$c));return this._pos_=M$c,M$d},M$a.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var M$a=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,M$a},M$a.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var M$a=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,M$a},M$a.writeFloat32=function(M$a){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,M$a,this._xd_),this._pos_+=4},M$a.writeFloat64=function(M$a){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,M$a,this._xd_),this._pos_+=8},M$a.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var M$a=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,M$a},M$a.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var M$a=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,M$a},M$a.writeInt32=function(M$a){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,M$a,this._xd_),this._pos_+=4},M$a.writeUint32=function(M$a){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,M$a,this._xd_),this._pos_+=4},M$a.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var M$a=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,M$a},M$a.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var M$a=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,M$a},M$a.writeUint16=function(M$a){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,M$a,this._xd_),this._pos_+=2},M$a.writeInt16=function(M$a){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,M$a,this._xd_),this._pos_+=2},M$a.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},M$a.writeUint8=function(M$a){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,M$a),this._pos_++},M$a._getUInt8=function(M$a){return this._d_.getUint8(M$a)},M$a._getUint16=function(M$a){return this._d_.getUint16(M$a,this._xd_)},M$a._getMatrix=function(){return new M$G(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},M$a.rUTF=function(M$a){for(var M$b=[],M$c=this._pos_+M$a,M$d=0,M$e=0,M$f=0,M$g=String.fromCharCode,M$h=this._u8d_;this._pos_<M$c;)(M$d=M$h[this._pos_++])<128?0!=M$d&&M$b.push(M$g(M$d)):M$d<224?M$b.push(M$g((63&M$d)<<6|127&M$h[this._pos_++])):M$d<240?(M$e=M$h[this._pos_++],M$b.push(M$g((31&M$d)<<12|(127&M$e)<<6|127&M$h[this._pos_++]))):(M$e=M$h[this._pos_++],M$f=M$h[this._pos_++],M$b.push(M$g((15&M$d)<<18|(127&M$e)<<12|M$f<<6&127|127&M$h[this._pos_++]))),0;return M$b.join("")},M$a.getCustomString=function(M$a){for(var M$b=[],M$c=0,M$d=0,M$e=0,M$f=String.fromCharCode,M$g=this._u8d_;0<M$a;)if((M$d=M$g[this._pos_])<128)M$b.push(M$f(M$d)),this._pos_++,M$a--;else for(M$c=M$d-128,this._pos_++,M$a-=M$c;0<M$c;)M$d=M$g[this._pos_++],M$e=M$g[this._pos_++],M$b.push(M$f(M$e<<8|M$d)),M$c--;return M$b.join("")},M$a.clear=function(){this._pos_=0,this.length=0},M$a.__getBuffer=function(){return this._d_.buffer},M$a.writeUTFBytes=function(M$a){for(var M$b=0,M$c=(M$a+="").length;M$b<M$c;M$b++){var M$d=M$a.charCodeAt(M$b);M$d<=127?this.writeByte(M$d):M$d<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|M$d>>6,128|63&M$d],this._pos_),this._pos_+=2):M$d<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|M$d>>12,128|M$d>>6&63,128|63&M$d],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|M$d>>18,128|M$d>>12&63,128|M$d>>6&63,128|63&M$d],this._pos_),this._pos_+=4)}},M$a.writeUTFString=function(M$a){var M$b=this.pos;this.writeUint16(1),this.writeUTFBytes(M$a);var M$c=this.pos-M$b-2;if(65536<=M$c)throw"writeUTFString byte len more than 65536";this._d_.setUint16(M$b,M$c,this._xd_)},M$a.readUTFString=function(){return this.readUTFBytes(this.getUint16())},M$a.getUTFString=function(){return this.readUTFString()},M$a.readUTFBytes=function(M$a){if(void 0===M$a&&(M$a=-1),0==M$a)return"";var M$b=this.bytesAvailable;if(M$b<M$a)throw"readUTFBytes error - Out of bounds";return M$a=0<M$a?M$a:M$b,this.rUTF(M$a)},M$a.getUTFBytes=function(M$a){return void 0===M$a&&(M$a=-1),this.readUTFBytes(M$a)},M$a.writeByte=function(M$a){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,M$a),this._pos_+=1},M$a.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},M$a.getByte=function(){return this.readByte()},M$a.ensureWrite=function(M$a){this._length<M$a&&(this._length=M$a),this._allocated_<M$a&&(this.length=M$a)},M$a.writeArrayBuffer=function(M$a,M$b,M$c){if(void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),M$b<0||M$c<0)throw"writeArrayBuffer error - Out of bounds";0==M$c&&(M$c=M$a.byteLength-M$b),this.ensureWrite(this._pos_+M$c);var M$d=new Uint8Array(M$a);this._u8d_.set(M$d.subarray(M$b,M$b+M$c),this._pos_),this._pos_+=M$c},M$o(0,M$a,"buffer",function(){var M$a=this._d_.buffer;return M$a.byteLength==this.length?M$a:M$a.slice(0,this.length)}),M$o(0,M$a,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(M$a){this._xd_="littleEndian"==M$a}),M$o(0,M$a,"length",function(){return this._length},function(M$a){this._allocated_<M$a?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(M$a,2*this._allocated_))):this._allocated_>M$a&&this.___resizeBuffer(this._allocated_=M$a),this._length=M$a}),M$o(0,M$a,"pos",function(){return this._pos_},function(M$a){this._pos_=M$a}),M$o(0,M$a,"bytesAvailable",function(){return this._length-this._pos_}),M$b.getSystemEndian=function(){if(!M$b._sysEndian){var M$a=new ArrayBuffer(2);new DataView(M$a).setInt16(0,256,!0),M$b._sysEndian=256===new Int16Array(M$a)[0]?"littleEndian":"bigEndian"}return M$b._sysEndian},M$b.BIG_ENDIAN="bigEndian",M$b.LITTLE_ENDIAN="littleEndian",M$b._sysEndian=null,M$b}(),M$Q=function(){function M$e(){}return M$k(M$e,"laya.utils.CacheManager"),M$e.regCacheByFunction=function(M$a,M$b){var M$c;M$e.unRegCacheByFunction(M$a,M$b),M$c={tryDispose:M$a,getCacheList:M$b},M$e._cacheList.push(M$c)},M$e.unRegCacheByFunction=function(M$a,M$b){var M$c,M$d=0;for(M$c=M$e._cacheList.length,M$d=0;M$d<M$c;M$d++)if(M$e._cacheList[M$d].tryDispose==M$a&&M$e._cacheList[M$d].getCacheList==M$b)return void M$e._cacheList.splice(M$d,1)},M$e.forceDispose=function(){var M$a=0,M$b=M$e._cacheList.length;for(M$a=0;M$a<M$b;M$a++)M$e._cacheList[M$a].tryDispose(!0)},M$e.beginCheck=function(M$a){void 0===M$a&&(M$a=15e3),M$x.timer.loop(M$a,null,M$e._checkLoop)},M$e.stopCheck=function(){M$x.timer.clear(null,M$e._checkLoop)},M$e._checkLoop=function(){var M$a=M$e._cacheList;if(!(M$a.length<1)){var M$b,M$c=M$O.now(),M$d=0;for(M$b=M$d=M$a.length;0<M$d&&(M$a[M$e._index=++M$e._index%M$b].tryDispose(!1),!(M$O.now()-M$c>M$e.loopTimeLimit));)M$d--}},M$e.loopTimeLimit=2,M$e._cacheList=[],M$e._index=0,M$e}(),M$R=function(){function M$n(){}return M$k(M$n,"laya.utils.ClassUtils"),M$n.regClass=function(M$a,M$b){M$n._classMap[M$a]=M$b},M$n.getRegClass=function(M$a){return M$n._classMap[M$a]},M$n.getInstance=function(M$a){var M$b=M$n.getClass(M$a);return M$b?new M$b:(console.warn("[error] Undefined class:",M$a),null)},M$n.createByJson=function(M$a,M$b,M$c,M$d,M$e){"string"==typeof M$a&&(M$a=JSON.parse(M$a));var M$f=M$a.props;if(!M$b&&!(M$b=M$e?M$e.runWith(M$a):M$n.getInstance(M$f.runtime||M$a.type)))return null;var M$g=M$a.child;if(M$g)for(var M$h=0,M$i=M$g.length;M$h<M$i;M$h++){var M$j=M$g[M$h];if("render"!==M$j.props.name&&"render"!==M$j.props.renderType||!M$b._$set_itemRender)if("Graphic"==M$j.type)M$n.addGraphicsToSprite(M$j,M$b);else if(M$n.isDrawType(M$j.type))M$n.addGraphicToSprite(M$j,M$b,!0);else{var M$k=M$n.createByJson(M$j,null,M$c,M$d,M$e);"Script"==M$j.type?M$k.hasOwnProperty("owner")?M$k.owner=M$b:M$k.hasOwnProperty("target")&&(M$k.target=M$b):"mask"==M$j.props.renderType?M$b.mask=M$k:M$b.addChild(M$k)}else M$b.itemRender=M$j}if(M$f)for(var M$l in M$f){var M$m=M$f[M$l];"var"===M$l&&M$c?M$c[M$m]=M$b:M$m instanceof Array&&"function"==typeof M$b[M$l]?M$b[M$l].apply(M$b,M$m):M$b[M$l]=M$m}return M$d&&M$a.customProps&&M$d.runWith([M$b,M$a]),M$b.created&&M$b.created(),M$b},M$n.addGraphicsToSprite=function(M$a,M$b){var M$c;if((M$c=M$a.child)&&!(M$c.length<1)){var M$d;M$d=M$n._getGraphicsFromSprite(M$a,M$b);var M$e=0,M$f=0;M$a.props&&(M$e=M$n._getObjVar(M$a.props,"x",0),M$f=M$n._getObjVar(M$a.props,"y",0)),0!=M$e&&0!=M$f&&M$d.translate(M$e,M$f);var M$g,M$h=0;for(M$g=M$c.length,M$h=0;M$h<M$g;M$h++)M$n._addGraphicToGraphics(M$c[M$h],M$d);0!=M$e&&0!=M$f&&M$d.translate(-M$e,-M$f)}},M$n.addGraphicToSprite=function(M$a,M$b,M$c){var M$d;void 0===M$c&&(M$c=!1),M$d=M$c?M$n._getGraphicsFromSprite(M$a,M$b):M$b.graphics,M$n._addGraphicToGraphics(M$a,M$d)},M$n._getGraphicsFromSprite=function(M$a,M$b){var M$c,M$d;if(!M$a||!M$a.props)return M$b.graphics;switch(M$d=M$a.props.renderType){case"hit":case"unHit":var M$e;M$b.hitArea||(M$b.hitArea=new M$V),(M$e=M$b.hitArea)[M$d]||(M$e[M$d]=new M$m),M$c=M$e[M$d]}return M$c||(M$c=M$b.graphics),M$c},M$n._getTransformData=function(M$a){var M$b;(M$a.hasOwnProperty("pivotX")||M$a.hasOwnProperty("pivotY"))&&(M$b=M$b||new M$G).translate(-M$n._getObjVar(M$a,"pivotX",0),-M$n._getObjVar(M$a,"pivotY",0));var M$c=M$n._getObjVar(M$a,"scaleX",1),M$d=M$n._getObjVar(M$a,"scaleY",1),M$e=M$n._getObjVar(M$a,"rotation",0);M$n._getObjVar(M$a,"skewX",0),M$n._getObjVar(M$a,"skewY",0);return 1==M$c&&1==M$d&&0==M$e||((M$b=M$b||new M$G).scale(M$c,M$d),M$b.rotate(.0174532922222222*M$e)),M$b},M$n._addGraphicToGraphics=function(M$a,M$b){var M$c,M$d;if((M$c=M$a.props)&&(M$d=M$n.DrawTypeDic[M$a.type])){var M$e,M$f;M$e=M$b;var M$g=M$n._getParams(M$c,M$d[1],M$d[2],M$d[3]);((M$f=M$n._tM)||1!=M$n._alpha)&&(M$e.save(),M$f&&M$e.transform(M$f),1!=M$n._alpha&&M$e.alpha(M$n._alpha)),M$e[M$d[0]].apply(M$e,M$g),(M$f||1!=M$n._alpha)&&M$e.restore()}},M$n._adptLineData=function(M$a){return M$a[2]=parseFloat(M$a[0])+parseFloat(M$a[2]),M$a[3]=parseFloat(M$a[1])+parseFloat(M$a[3]),M$a},M$n._adptTextureData=function(M$a){return M$a[0]=M$ha.getRes(M$a[0]),M$a},M$n._adptLinesData=function(M$a){return M$a[2]=M$n._getPointListByStr(M$a[2]),M$a},M$n.isDrawType=function(M$a){return"Image"!=M$a&&M$n.DrawTypeDic.hasOwnProperty(M$a)},M$n._getParams=function(M$a,M$b,M$c,M$d){var M$e;void 0===M$c&&(M$c=0),(M$e=M$n._temParam).length=M$b.length;var M$f,M$g,M$h=0;for(M$f=M$b.length,M$h=0;M$h<M$f;M$h++)M$e[M$h]=M$n._getObjVar(M$a,M$b[M$h][0],M$b[M$h][1]);return M$n._alpha=M$n._getObjVar(M$a,"alpha",1),M$g=M$n._getTransformData(M$a),M$n._tM=M$g?(M$c||(M$c=0),M$g.translate(M$e[M$c],M$e[M$c+1]),M$e[M$c]=M$e[M$c+1]=0,M$g):null,M$d&&M$n[M$d]&&(M$e=M$n[M$d](M$e)),M$e},M$n._getPointListByStr=function(M$a){var M$b,M$c,M$d=0;for(M$c=(M$b=M$a.split(",")).length,M$d=0;M$d<M$c;M$d++)M$b[M$d]=parseFloat(M$b[M$d]);return M$b},M$n._getObjVar=function(M$a,M$b,M$c){return M$a.hasOwnProperty(M$b)?M$a[M$b]:M$c},M$n._temParam=[],M$n._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},M$n.getClass=function(M$a){var M$b=M$n._classMap[M$a]||M$a;return"string"==typeof M$b?M$x.__classmap[M$b]:M$b},M$n._tM=null,M$n._alpha=NaN,M$i(M$n,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),M$n}(),M$S=function(){function M$f(M$a){if(this._color=[],"string"==typeof M$a){null===(this.strColor=M$a)&&(M$a="#000000"),"#"==M$a.charAt(0)&&(M$a=M$a.substr(1));var M$b=M$a.length;if(3==M$b||4==M$b){for(var M$c="",M$d=0;M$d<M$b;M$d++)M$c+=M$a[M$d]+M$a[M$d];M$a=M$c}var M$e=this.numColor=parseInt(M$a,16);if(8==M$a.length)return void(this._color=[parseInt(M$a.substr(0,2),16)/255,((16711680&M$e)>>16)/255,((65280&M$e)>>8)/255,(255&M$e)/255])}else M$e=this.numColor=M$a,this.strColor=M$$.toHexColor(M$e);this._color=[((16711680&M$e)>>16)/255,((65280&M$e)>>8)/255,(255&M$e)/255,1],this._color.__id=++M$f._COLODID}return M$k(M$f,"laya.utils.Color"),M$f._initDefault=function(){for(var M$a in M$f._DEFAULT={},M$f._COLOR_MAP)M$f._SAVE[M$a]=M$f._DEFAULT[M$a]=new M$f(M$f._COLOR_MAP[M$a]);return M$f._DEFAULT},M$f._initSaveMap=function(){for(var M$a in M$f._SAVE_SIZE=0,M$f._SAVE={},M$f._DEFAULT)M$f._SAVE[M$a]=M$f._DEFAULT[M$a]},M$f.create=function(M$a){var M$b=M$f._SAVE[M$a+""];return null!=M$b?M$b:(M$f._SAVE_SIZE<1e3||M$f._initSaveMap(),M$f._SAVE[M$a+""]=new M$f(M$a))},M$f._SAVE={},M$f._SAVE_SIZE=0,M$f._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},M$f._DEFAULT=M$f._initDefault(),M$f._COLODID=1,M$f}(),M$T=(function(){function M$a(){this._values=[],this._keys=[]}M$k(M$a,"laya.utils.Dictionary");var M$b=M$a.prototype;M$b.set=function(M$a,M$b){var M$c=this.indexOf(M$a);0<=M$c?this._values[M$c]=M$b:(this._keys.push(M$a),this._values.push(M$b))},M$b.indexOf=function(M$a){var M$b=this._keys.indexOf(M$a);return 0<=M$b?M$b:(M$a="string"==typeof M$a?Number(M$a):"number"==typeof M$a?M$a.toString():M$a,this._keys.indexOf(M$a))},M$b.get=function(M$a){var M$b=this.indexOf(M$a);return M$b<0?null:this._values[M$b]},M$b.remove=function(M$a){var M$b=this.indexOf(M$a);return 0<=M$b&&(this._keys.splice(M$b,1),this._values.splice(M$b,1),!0)},M$b.clear=function(){this._values.length=0,this._keys.length=0},M$o(0,M$b,"values",function(){return this._values}),M$o(0,M$b,"keys",function(){return this._keys})}(),function(){function M$a(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}M$k(M$a,"laya.utils.Dragging");var M$b=M$a.prototype;return M$b.start=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){void 0===M$h&&(M$h=.92),this.clearTimer(),this.target=M$a,this.area=M$b,this.hasInertia=M$c,this.elasticDistance=M$b?M$d:0,this.elasticBackTime=M$e,this.data=M$f,this._disableMouseEvent=M$g,this.ratio=M$h,1!=M$a.globalScaleX||1!=M$a.globalScaleY?this._parent=M$a.parent:this._parent=M$x.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,M$x.stage.on("mouseup",this,this.onStageMouseUp),M$x.stage.on("mouseout",this,this.onStageMouseUp),M$x.timer.frameLoop(1,this,this.loop)},M$b.clearTimer=function(){M$x.timer.clear(this,this.loop),M$x.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},M$b.stop=function(){this._dragging&&(M$p.instance.disableMouseEvent=!1,M$x.stage.off("mouseup",this,this.onStageMouseUp),M$x.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},M$b.loop=function(){var M$a=this._parent.getMousePoint(),M$b=M$a.x,M$c=M$a.y,M$d=M$b-this._lastX,M$e=M$c-this._lastY;if(this._clickOnly){if(!(1<Math.abs(M$d*M$x.stage._canvasTransform.getScaleX())||1<Math.abs(M$e*M$x.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),M$p.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(M$d,M$e);0==M$d&&0==M$e||(this._lastX=M$b,this._lastY=M$c,this.target.x+=M$d*this._elasticRateX,this.target.y+=M$e*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},M$b.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var M$a=this.area.x-this.target.x;else M$a=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-M$a/this.elasticDistance),this.target.y<this.area.y)var M$b=this.area.y-this.target.y;else M$b=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-M$b/this.elasticDistance)}},M$b.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},M$b.onStageMouseUp=function(M$a){if(M$p.instance.disableMouseEvent=!1,M$x.stage.off("mouseup",this,this.onStageMouseUp),M$x.stage.off("mouseout",this,this.onStageMouseUp),M$x.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var M$b=this._offsets.length,M$c=Math.min(M$b,6),M$d=this._offsets.length-M$c,M$e=M$b-1;M$d<M$e;M$e--)this._offsetY+=this._offsets[M$e--],this._offsetX+=this._offsets[M$e];this._offsetX=this._offsetX/M$c*2,this._offsetY=this._offsetY/M$c*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),M$x.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},M$b.checkElastic=function(){var M$a=NaN,M$b=NaN;if(this.target.x<this.area.x?M$a=this.area.x:this.target.x>this.area.x+this.area.width&&(M$a=this.area.x+this.area.width),this.target.y<this.area.y?M$b=this.area.y:this.target.y>this.area.y+this.area.height&&(M$b=this.area.y+this.area.height),isNaN(M$a)&&isNaN(M$b))this.clear();else{var M$c={};isNaN(M$a)||(M$c.x=M$a),isNaN(M$b)||(M$c.y=M$b),this._tween=M$Z.to(this.target,M$c,this.elasticBackTime,M$U.sineOut,M$s.create(this,this.clear),0,!1,!1)}},M$b.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(M$x.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},M$b.clear=function(){if(this.target){this.clearTimer();var M$a=this.target;this.target=null,this._parent=null,M$a.event("dragend",this.data)}},M$a}()),M$U=function(){function M$h(){}return M$k(M$h,"laya.utils.Ease"),M$h.linearNone=function(M$a,M$b,M$c,M$d){return M$c*M$a/M$d+M$b},M$h.linearIn=function(M$a,M$b,M$c,M$d){return M$c*M$a/M$d+M$b},M$h.linearInOut=function(M$a,M$b,M$c,M$d){return M$c*M$a/M$d+M$b},M$h.linearOut=function(M$a,M$b,M$c,M$d){return M$c*M$a/M$d+M$b},M$h.bounceIn=function(M$a,M$b,M$c,M$d){return M$c-M$h.bounceOut(M$d-M$a,0,M$c,M$d)+M$b},M$h.bounceInOut=function(M$a,M$b,M$c,M$d){return M$a<.5*M$d?.5*M$h.bounceIn(2*M$a,0,M$c,M$d)+M$b:.5*M$h.bounceOut(2*M$a-M$d,0,M$c,M$d)+.5*M$c+M$b},M$h.bounceOut=function(M$a,M$b,M$c,M$d){return(M$a/=M$d)<1/2.75?M$c*(7.5625*M$a*M$a)+M$b:M$a<2/2.75?M$c*(7.5625*(M$a-=1.5/2.75)*M$a+.75)+M$b:M$a<2.5/2.75?M$c*(7.5625*(M$a-=2.25/2.75)*M$a+.9375)+M$b:M$c*(7.5625*(M$a-=2.625/2.75)*M$a+.984375)+M$b},M$h.backIn=function(M$a,M$b,M$c,M$d,M$e){return void 0===M$e&&(M$e=1.70158),M$c*(M$a/=M$d)*M$a*((M$e+1)*M$a-M$e)+M$b},M$h.backInOut=function(M$a,M$b,M$c,M$d,M$e){return void 0===M$e&&(M$e=1.70158),(M$a/=.5*M$d)<1?.5*M$c*(M$a*M$a*((1+(M$e*=1.525))*M$a-M$e))+M$b:M$c/2*((M$a-=2)*M$a*((1+(M$e*=1.525))*M$a+M$e)+2)+M$b},M$h.backOut=function(M$a,M$b,M$c,M$d,M$e){return void 0===M$e&&(M$e=1.70158),M$c*((M$a=M$a/M$d-1)*M$a*((M$e+1)*M$a+M$e)+1)+M$b},M$h.elasticIn=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g;return void 0===M$e&&(M$e=0),void 0===M$f&&(M$f=0),0==M$a?M$b:1==(M$a/=M$d)?M$b+M$c:(M$f||(M$f=.3*M$d),M$g=!M$e||0<M$c&&M$e<M$c||M$c<0&&M$e<-M$c?(M$e=M$c,M$f/4):M$f/M$h.PI2*Math.asin(M$c/M$e),-M$e*Math.pow(2,10*(M$a-=1))*Math.sin((M$a*M$d-M$g)*M$h.PI2/M$f)+M$b)},M$h.elasticInOut=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g;return void 0===M$e&&(M$e=0),void 0===M$f&&(M$f=0),0==M$a?M$b:2==(M$a/=.5*M$d)?M$b+M$c:(M$f||(M$f=M$d*(.3*1.5)),M$g=!M$e||0<M$c&&M$e<M$c||M$c<0&&M$e<-M$c?(M$e=M$c,M$f/4):M$f/M$h.PI2*Math.asin(M$c/M$e),M$a<1?M$e*Math.pow(2,10*(M$a-=1))*Math.sin((M$a*M$d-M$g)*M$h.PI2/M$f)*-.5+M$b:M$e*Math.pow(2,-10*(M$a-=1))*Math.sin((M$a*M$d-M$g)*M$h.PI2/M$f)*.5+M$c+M$b)},M$h.elasticOut=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g;return void 0===M$e&&(M$e=0),void 0===M$f&&(M$f=0),0==M$a?M$b:1==(M$a/=M$d)?M$b+M$c:(M$f||(M$f=.3*M$d),M$g=!M$e||0<M$c&&M$e<M$c||M$c<0&&M$e<-M$c?(M$e=M$c,M$f/4):M$f/M$h.PI2*Math.asin(M$c/M$e),M$e*Math.pow(2,-10*M$a)*Math.sin((M$a*M$d-M$g)*M$h.PI2/M$f)+M$c+M$b)},M$h.strongIn=function(M$a,M$b,M$c,M$d){return M$c*(M$a/=M$d)*M$a*M$a*M$a*M$a+M$b},M$h.strongInOut=function(M$a,M$b,M$c,M$d){return(M$a/=.5*M$d)<1?.5*M$c*M$a*M$a*M$a*M$a*M$a+M$b:.5*M$c*((M$a-=2)*M$a*M$a*M$a*M$a+2)+M$b},M$h.strongOut=function(M$a,M$b,M$c,M$d){return M$c*((M$a=M$a/M$d-1)*M$a*M$a*M$a*M$a+1)+M$b},M$h.sineInOut=function(M$a,M$b,M$c,M$d){return.5*-M$c*(Math.cos(Math.PI*M$a/M$d)-1)+M$b},M$h.sineIn=function(M$a,M$b,M$c,M$d){return-M$c*Math.cos(M$a/M$d*M$h.HALF_PI)+M$c+M$b},M$h.sineOut=function(M$a,M$b,M$c,M$d){return M$c*Math.sin(M$a/M$d*M$h.HALF_PI)+M$b},M$h.quintIn=function(M$a,M$b,M$c,M$d){return M$c*(M$a/=M$d)*M$a*M$a*M$a*M$a+M$b},M$h.quintInOut=function(M$a,M$b,M$c,M$d){return(M$a/=.5*M$d)<1?.5*M$c*M$a*M$a*M$a*M$a*M$a+M$b:.5*M$c*((M$a-=2)*M$a*M$a*M$a*M$a+2)+M$b},M$h.quintOut=function(M$a,M$b,M$c,M$d){return M$c*((M$a=M$a/M$d-1)*M$a*M$a*M$a*M$a+1)+M$b},M$h.quartIn=function(M$a,M$b,M$c,M$d){return M$c*(M$a/=M$d)*M$a*M$a*M$a+M$b},M$h.quartInOut=function(M$a,M$b,M$c,M$d){return(M$a/=.5*M$d)<1?.5*M$c*M$a*M$a*M$a*M$a+M$b:.5*-M$c*((M$a-=2)*M$a*M$a*M$a-2)+M$b},M$h.quartOut=function(M$a,M$b,M$c,M$d){return-M$c*((M$a=M$a/M$d-1)*M$a*M$a*M$a-1)+M$b},M$h.cubicIn=function(M$a,M$b,M$c,M$d){return M$c*(M$a/=M$d)*M$a*M$a+M$b},M$h.cubicInOut=function(M$a,M$b,M$c,M$d){return(M$a/=.5*M$d)<1?.5*M$c*M$a*M$a*M$a+M$b:.5*M$c*((M$a-=2)*M$a*M$a+2)+M$b},M$h.cubicOut=function(M$a,M$b,M$c,M$d){return M$c*((M$a=M$a/M$d-1)*M$a*M$a+1)+M$b},M$h.quadIn=function(M$a,M$b,M$c,M$d){return M$c*(M$a/=M$d)*M$a+M$b},M$h.quadInOut=function(M$a,M$b,M$c,M$d){return(M$a/=.5*M$d)<1?.5*M$c*M$a*M$a+M$b:.5*-M$c*(--M$a*(M$a-2)-1)+M$b},M$h.quadOut=function(M$a,M$b,M$c,M$d){return-M$c*(M$a/=M$d)*(M$a-2)+M$b},M$h.expoIn=function(M$a,M$b,M$c,M$d){return 0==M$a?M$b:M$c*Math.pow(2,10*(M$a/M$d-1))+M$b-.001*M$c},M$h.expoInOut=function(M$a,M$b,M$c,M$d){return 0==M$a?M$b:M$a==M$d?M$b+M$c:(M$a/=.5*M$d)<1?.5*M$c*Math.pow(2,10*(M$a-1))+M$b:.5*M$c*(2-Math.pow(2,-10*--M$a))+M$b},M$h.expoOut=function(M$a,M$b,M$c,M$d){return M$a==M$d?M$b+M$c:M$c*(1-Math.pow(2,-10*M$a/M$d))+M$b},M$h.circIn=function(M$a,M$b,M$c,M$d){return-M$c*(Math.sqrt(1-(M$a/=M$d)*M$a)-1)+M$b},M$h.circInOut=function(M$a,M$b,M$c,M$d){return(M$a/=.5*M$d)<1?.5*-M$c*(Math.sqrt(1-M$a*M$a)-1)+M$b:.5*M$c*(Math.sqrt(1-(M$a-=2)*M$a)+1)+M$b},M$h.circOut=function(M$a,M$b,M$c,M$d){return M$c*Math.sqrt(1-(M$a=M$a/M$d-1)*M$a)+M$b},M$h.HALF_PI=.5*Math.PI,M$h.PI2=2*Math.PI,M$h}(),M$V=function(){function M$l(){this._hit=null,this._unHit=null}M$k(M$l,"laya.utils.HitArea");var M$a=M$l.prototype;return M$a.isHit=function(M$a,M$b){return!!M$l.isHitGraphic(M$a,M$b,this.hit)&&!M$l.isHitGraphic(M$a,M$b,this.unHit)},M$a.contains=function(M$a,M$b){return this.isHit(M$a,M$b)},M$o(0,M$a,"hit",function(){return this._hit||(this._hit=new M$m),this._hit},function(M$a){this._hit=M$a}),M$o(0,M$a,"unHit",function(){return this._unHit||(this._unHit=new M$m),this._unHit},function(M$a){this._unHit=M$a}),M$l.isHitGraphic=function(M$a,M$b,M$c){if(!M$c)return!1;var M$d;if(!(M$d=M$c.cmds)&&M$c._one&&((M$d=M$l._cmds).length=1,M$d[0]=M$c._one),!M$d)return!1;var M$e,M$f,M$g=0;for(M$e=M$d.length,M$g=0;M$g<M$e;M$g++)if(M$f=M$d[M$g]){var M$h=M$J._context;switch(M$f.callee){case M$h._translate:case 6:M$a-=M$f[0],M$b-=M$f[1]}if(M$l.isHitCmd(M$a,M$b,M$f))return!0}return!1},M$l.isHitCmd=function(M$a,M$b,M$c){if(!M$c)return!1;var M$d=M$J._context,M$e=!1;switch(M$c.callee){case M$d._drawRect:case 13:M$l._rec.setTo(M$c[0],M$c[1],M$c[2],M$c[3]),M$e=M$l._rec.contains(M$a,M$b);break;case M$d._drawCircle:case M$d._fillCircle:case 14:M$e=(M$a-=M$c[0])*M$a+(M$b-=M$c[1])*M$b<M$c[2]*M$c[2];break;case M$d._drawPoly:case 18:M$a-=M$c[0],M$b-=M$c[1],M$e=M$l.ptInPolygon(M$a,M$b,M$c[2])}return M$e},M$l.ptInPolygon=function(M$a,M$b,M$c){var M$d;(M$d=M$l._ptPoint).setTo(M$a,M$b);var M$e,M$f=0,M$g=NaN,M$h=NaN,M$i=NaN,M$j=NaN;M$e=M$c.length;for(var M$k=0;M$k<M$e;M$k+=2){if(M$g=M$c[M$k],M$h=M$c[M$k+1],M$i=M$c[(M$k+2)%M$e],M$h!=(M$j=M$c[(M$k+3)%M$e]))if(!(M$d.y<Math.min(M$h,M$j)))if(!(M$d.y>=Math.max(M$h,M$j)))(M$d.y-M$h)*(M$i-M$g)/(M$j-M$h)+M$g>M$d.x&&M$f++}return M$f%2==1},M$l._cmds=[],M$i(M$l,["_rec",function(){return this._rec=new M$B},"_ptPoint",function(){return this._ptPoint=new M$A}]),M$l}(),M$W=(function(){function M$e(M$a,M$b,M$c,M$d){this.char=M$a,this.charNum=M$a.charCodeAt(0),this._x=this._y=0,this.width=M$b,this.height=M$c,this.style=M$d,this.isWord=!M$e._isWordRegExp.test(M$a)}M$k(M$e,"laya.utils.HTMLChar");var M$a=M$e.prototype;M$x.imps(M$a,{"laya.display.ILayout":!0}),M$a.setSprite=function(M$a){this._sprite=M$a},M$a.getSprite=function(){return this._sprite},M$a._isChar=function(){return!0},M$a._getCSSStyle=function(){return this.style},M$o(0,M$a,"width",function(){return this._w},function(M$a){this._w=M$a}),M$o(0,M$a,"x",function(){return this._x},function(M$a){this._sprite&&(this._sprite.x=M$a),this._x=M$a}),M$o(0,M$a,"y",function(){return this._y},function(M$a){this._sprite&&(this._sprite.y=M$a),this._y=M$a}),M$o(0,M$a,"height",function(){return this._h},function(M$a){this._h=M$a}),M$e._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function M$b(){}M$k(M$b,"laya.utils.Log"),M$b.enable=function(){M$b._logdiv||(M$b._logdiv=M$O.window.document.createElement("div"),M$O.window.document.body.appendChild(M$b._logdiv),M$b._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},M$b.toggle=function(){var M$a=M$b._logdiv.style;"1px"==M$a.width?M$a.width=M$a.height="50%":M$a.width=M$a.height="1px"},M$b.print=function(M$a){M$b._logdiv&&(M$b.maxCount<=M$b._count&&M$b.clear(),M$b._count++,M$b._logdiv.innerText+=M$a+"\n",M$b._logdiv.scrollTop=M$b._logdiv.scrollHeight)},M$b.clear=function(){M$b._logdiv.innerText="",M$b._count=0},M$b._logdiv=null,M$b._count=0,M$b.maxCount=20}(),function(){function M$b(){}M$k(M$b,"laya.utils.Mouse"),M$o(1,M$b,"cursor",function(){return M$b._style.cursor},function(M$a){M$b._style.cursor=M$a}),M$b.hide=function(){"none"!=M$b.cursor&&(M$b._preCursor=M$b.cursor,M$b.cursor="none")},M$b.show=function(){"none"==M$b.cursor&&(M$b.cursor=M$b._preCursor?M$b._preCursor:"auto")},M$b._preCursor=null,M$i(M$b,["_style",function(){return this._style=M$O.document.body.style}])}(),function(){function M$f(){}return M$k(M$f,"laya.utils.Pool"),M$f.getPoolBySign=function(M$a){return M$f._poolDic[M$a]||(M$f._poolDic[M$a]=[])},M$f.clearBySign=function(M$a){M$f._poolDic[M$a]&&(M$f._poolDic[M$a].length=0)},M$f.recover=function(M$a,M$b){M$b.__InPool||(M$b.__InPool=!0,M$f.getPoolBySign(M$a).push(M$b))},M$f.getItemByClass=function(M$a,M$b){var M$c=M$f.getPoolBySign(M$a),M$d=M$c.length?M$c.pop():new M$b;return M$d.__InPool=!1,M$d},M$f.getItemByCreateFun=function(M$a,M$b,M$c){var M$d=M$f.getPoolBySign(M$a),M$e=M$d.length?M$d.pop():M$b.call(M$c);return M$e.__InPool=!1,M$e},M$f.getItem=function(M$a){var M$b=M$f.getPoolBySign(M$a),M$c=M$b.length?M$b.pop():null;return M$c&&(M$c.__InPool=!1),M$c},M$f._poolDic={},M$f.InPoolSign="__InPool",M$f}()),M$X=function(){function M$i(){}return M$k(M$i,"laya.utils.Stat"),M$o(1,M$i,"onclick",null,function(M$a){M$i._sp&&M$i._sp.on("click",M$i._sp,M$a),M$i._canvas&&(M$i._canvas.source.onclick=M$a,M$i._canvas.source.style.pointerEvents="")}),M$i.show=function(M$a,M$b,M$c){if(void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),!M$J.isConchApp||M$J.isConchWebGL){if(M$J.isConchWebGL||M$O.onMiniGame||M$O.onLimixiu||(M$i._useCanvas=!0),M$i._show=!0,M$i._fpsData.length=60,M$i._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},M$i._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},M$i._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},M$i._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},M$J.isWebGL)if(M$i._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},M$J.is3DMode){if(M$i._view[0].title="FPS(3D)",M$i._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},M$i._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},M$i._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==M$c){var M$d=8;M$i._view[M$d++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},M$i._view[M$d++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},M$i._view[M$d++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},M$i._view[M$d++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},M$i._view[M$d++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},M$i._view[M$d++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},M$i._view[M$d++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},M$i._view[M$d++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},M$i._view[M$d++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==M$c){M$d=8;M$i._view[M$d++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},M$i._view[M$d++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},M$i._view[M$d++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},M$i._view[M$d++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},M$i._view[M$d++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},M$i._view[M$d++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},M$i._view[M$d++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else M$i._view[0].title="FPS(WebGL)",M$i._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else M$i._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};M$i._useCanvas?M$i.createUIPre(M$a,M$b):M$i.createUI(M$a,M$b),M$i.enable()}else M$O.window.conch.showFPS&&M$O.window.conch.showFPS(M$a,M$b)},M$i.createUIPre=function(M$a,M$b){var M$c=M$O.pixelRatio;M$i._width=170*M$c,M$i._vx=75*M$c,M$i._height=M$c*(12*M$i._view.length+3*M$c)+4,M$i._fontSize=12*M$c;for(var M$d=0;M$d<M$i._view.length;M$d++)M$i._view[M$d].x=4,M$i._view[M$d].y=M$d*M$i._fontSize+2*M$c;M$i._canvas||((M$i._canvas=new M$ta("2D")).size(M$i._width,M$i._height),(M$i._ctx=M$i._canvas.getContext("2d")).textBaseline="top",M$i._ctx.font=M$i._fontSize+"px Sans-serif",M$i._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+M$a+"px;top:"+M$b+"px;width:"+M$i._width/M$c+"px;height:"+M$i._height/M$c+"px;"),M$i._first=!0,M$i.loop(),M$i._first=!1,M$O.container.appendChild(M$i._canvas.source)},M$i.createUI=function(M$a,M$b){var M$c=M$i._sp,M$d=M$O.pixelRatio;M$c||(M$c=new M$la,(M$i._leftText=new M$qa).pos(5,5),M$i._leftText.color="#ffffff",M$c.addChild(M$i._leftText),(M$i._txt=new M$qa).pos(80*M$d,5),M$i._txt.color="#ffffff",M$c.addChild(M$i._txt),M$i._sp=M$c),M$c.pos(M$a,M$b);for(var M$e="",M$f=0;M$f<M$i._view.length;M$f++){M$e+=M$i._view[M$f].title+"\n"}M$i._leftText.text=M$e;var M$g=170*M$d,M$h=M$d*(12*M$i._view.length+3*M$d)+4;M$i._txt.fontSize=M$i._fontSize*M$d,M$i._leftText.fontSize=M$i._fontSize*M$d,M$c.size(M$g,M$h),M$c.graphics.clear(),M$c.graphics.setAlpha(.5),M$c.graphics.drawRect(0,0,M$g,M$h,"#999999"),M$c.graphics.setAlpha(1),M$i.loop()},M$i.enable=function(){M$x.timer.frameLoop(1,M$i,M$i.loop)},M$i.hide=function(){M$i._show=!1,M$x.timer.clear(M$i,M$i.loop),M$i._canvas&&M$O.removeElement(M$i._canvas.source)},M$i.clear=function(){M$i.trianglesFaces=M$i.drawCall=M$i.shaderCall=M$i.spriteCount=M$i.spriteRenderUseCacheCount=M$i.treeNodeCollision=M$i.treeSpriteCollision=M$i.canvasNormal=M$i.canvasBitmap=M$i.canvasReCache=0},M$i.loop=function(){M$i._count++;var M$a=M$O.now();if(!(M$a-M$i._timer<1e3)){var M$b=M$i._count;if(M$i.FPS=Math.round(1e3*M$b/(M$a-M$i._timer)),M$i._show){M$i.trianglesFaces=Math.round(M$i.trianglesFaces/M$b),M$i.spriteCount=M$i._useCanvas?(M$i.drawCall=Math.round(M$i.drawCall/M$b)-2,M$i.shaderCall=Math.round(M$i.shaderCall/M$b),Math.round(M$i.spriteCount/M$b)-1):(M$i.drawCall=Math.round(M$i.drawCall/M$b)-2,M$i.shaderCall=Math.round(M$i.shaderCall/M$b)-4,Math.round(M$i.spriteCount/M$b)-4),M$i.spriteRenderUseCacheCount=Math.round(M$i.spriteRenderUseCacheCount/M$b),M$i.canvasNormal=Math.round(M$i.canvasNormal/M$b),M$i.canvasBitmap=Math.round(M$i.canvasBitmap/M$b),M$i.canvasReCache=Math.ceil(M$i.canvasReCache/M$b),M$i.treeNodeCollision=Math.round(M$i.treeNodeCollision/M$b),M$i.treeSpriteCollision=Math.round(M$i.treeSpriteCollision/M$b);var M$c=0<M$i.FPS?Math.floor(1e3/M$i.FPS).toString():" ";M$i._fpsStr=M$i.FPS+(M$i.renderSlow?" slow":"")+" "+M$c,M$i._spriteStr=M$i.spriteCount+(M$i.spriteRenderUseCacheCount?"/"+M$i.spriteRenderUseCacheCount:""),M$i._canvasStr=M$i.canvasReCache+"/"+M$i.canvasNormal+"/"+M$i.canvasBitmap,M$i.currentMemorySize=M$N.systemResourceManager.memorySize,M$i._useCanvas?M$i.renderInfoPre():M$i.renderInfo(),M$i.clear()}M$i._count=0,M$i._timer=M$a}},M$i.renderInfoPre=function(){if(M$i._canvas){var M$a=M$i._ctx;M$a.clearRect(M$i._first?0:M$i._vx,0,M$i._width,M$i._height);for(var M$b=M$J.WebGL.mainContext,M$c=0;M$c<M$i._view.length;M$c++){var M$d=M$i._view[M$c];M$i._first&&(M$a.fillStyle="white",M$a.fillText(M$d.title,M$d.x,M$d.y,null,null,null)),M$a.fillStyle=M$d.color;var M$e=-1;if((M$d=M$i._view[M$c]).varying){if(M$b)switch(M$d.varying){case 1:M$e=M$b.getParameter(M$b[M$d.value]);break;case 2:M$e=M$b.getExtension(M$d.value)}}else M$e=M$i[M$d.value];"M"==M$d.units&&(M$e=Math.floor(M$e/1048576*100)/100+" M"),"K"==M$d.units&&(M$e=Math.floor(M$e/1024*100)/100+" K"),"string"==M$d.units&&(M$e=M$e.match(/\d+\.?\d/i)),M$a.fillText(M$e+"",M$d.x+M$i._vx,M$d.y,null,null,null)}}},M$i.renderInfo=function(){for(var M$a="",M$b=M$J.WebGL.mainContext,M$c=0;M$c<M$i._view.length;M$c++){var M$d=M$i._view[M$c],M$e=-1;if(M$d.varying){if(M$b)switch(M$d.varying){case 1:M$e=M$b.getParameter(M$b[M$d.value]);break;case 2:M$e=M$b.getExtension(M$d.value)}}else M$e=M$i[M$d.value];"M"==M$d.units&&(M$e=Math.floor(M$e/1048576*100)/100+" M"),"K"==M$d.units&&(M$e=Math.floor(M$e/1024*100)/100+" K"),"string"==M$d.units&&(M$e=M$e.match(/\d+\.?\d/i)),M$a+=M$e+"\n"}M$i._txt.text=M$a},M$i.FPS=0,M$i.loopCount=0,M$i.shaderCall=0,M$i.drawCall=0,M$i.trianglesFaces=0,M$i.spriteCount=0,M$i.spriteRenderUseCacheCount=0,M$i.treeNodeCollision=0,M$i.treeSpriteCollision=0,M$i.canvasNormal=0,M$i.canvasBitmap=0,M$i.canvasReCache=0,M$i.renderSlow=!1,M$i.currentMemorySize=0,M$i._fpsStr=null,M$i._canvasStr=null,M$i._spriteStr=null,M$i._fpsData=[],M$i._timer=0,M$i._count=0,M$i._view=[],M$i._fontSize=12,M$i._txt=null,M$i._leftText=null,M$i._sp=null,M$i._show=!1,M$i._useCanvas=!1,M$i._canvas=null,M$i._ctx=null,M$i._first=!1,M$i._vx=NaN,M$i._width=0,M$i._height=100,M$i}(),M$Y=(function(){function M$a(){this._strsToID={},this._idToStrs=[],this._length=0}M$k(M$a,"laya.utils.StringKey");var M$b=M$a.prototype;M$b.add=function(M$a){var M$b=this._strsToID[M$a];return null!=M$b?M$b:(this._idToStrs[this._length]=M$a,this._strsToID[M$a]=this._length++)},M$b.getID=function(M$a){var M$b=this._strsToID[M$a];return null==M$b?-1:M$b},M$b.getName=function(M$a){var M$b=this._idToStrs[M$a];return null==M$b?void 0:M$b}}(),function(){var M$j;function M$a(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}M$k(M$a,"laya.utils.Timer");var M$b=M$a.prototype;return M$b._init=function(){M$x.timer&&M$x.timer.frameLoop(1,this,this._update)},M$b._now=function(){return Date.now()},M$b._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var M$a=this.currFrame=this.currFrame+this.scale,M$b=this._now();this._delta=(M$b-this._lastTimer)*this.scale;var M$c=this.currTimer=this.currTimer+this._delta;M$x.isDebug&&6e4<Math.abs(M$b-this._lastTimer)&&console.error("系统时间错误！"+(M$b-this._lastTimer)),this._lastTimer=M$b;var M$d=this._handlers;for(M$g=this._count=0,M$h=M$d.length;M$g<M$h;M$g++)if(null!==(M$i=M$d[M$g]).method){var M$e=M$i.userFrame?M$a:M$c;if(M$e>=M$i.exeTime)if(M$i.repeat)if(M$i.jumpFrame)for(;M$e>=M$i.exeTime;)M$i.exeTime+=M$i.delay,M$i.run(!1);else M$i.exeTime+=M$i.delay,M$i.run(!1),M$e>M$i.exeTime&&(M$i.exeTime+=Math.ceil((M$e-M$i.exeTime)/M$i.delay)*M$i.delay);else M$i.run(!0)}else this._count++;(30<this._count||M$a%200==0)&&this._clearHandlers();for(var M$f=this._laters,M$g=0,M$h=M$f.length-1;M$g<=M$h;M$g++){var M$i=M$f[M$g];this._isIgnoreRecover(M$i)||(null!==M$i.method&&(delete this._map[M$i.key],M$i.run(!1)),this._recoverHandler(M$i)),M$g===M$h&&(M$h=M$f.length-1)}M$f.length=0}},M$b._clearHandlers=function(){for(var M$a=this._handlers,M$b=0,M$c=M$a.length;M$b<M$c;M$b++){var M$d=M$a[M$b];null!==M$d.method?this._temp.push(M$d):this._isIgnoreRecover(M$d)?this._temp.push(M$d):this._recoverHandler(M$d)}this._handlers=this._temp,this._temp=M$a,this._temp.length=0},M$b._recoverHandler=function(M$a){this._map[M$a.key]==M$a&&delete this._map[M$a.key],M$a.recover()},M$b._create=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){if(!M$c)return M$e.apply(M$d,M$f),null;if(M$g){var M$i=this._getHandler(M$d,M$e);if(M$i)return M$i.repeat=M$b,M$i.userFrame=M$a,M$i.delay=M$c,M$i.ignoreRecover=M$h,M$i.caller=M$d,M$i.method=M$e,M$i.args=M$f,M$i.exeTime=M$c+(M$a?this.currFrame:this.currTimer+this._now()-this._lastTimer),M$i}return(M$i=M$j.create()).repeat=M$b,M$i.userFrame=M$a,M$i.delay=M$c,M$i.ignoreRecover=M$h,M$i.caller=M$d,M$i.method=M$e,M$i.args=M$f,M$i.exeTime=M$c+(M$a?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(M$i),this._handlers.push(M$i),M$i},M$b._indexHandler=function(M$a){var M$b=M$a.caller,M$c=M$a.method,M$d=M$b?M$b.$_GID||(M$b.$_GID=M$$.getGID()):0,M$e=M$c.$_TID||(M$c.$_TID=this._mid++);M$a.key=M$d+"_"+M$e,this._map[M$a.key]=M$a},M$b.once=function(M$a,M$b,M$c,M$d,M$e){void 0===M$e&&(M$e=!0),this._create(!1,!1,M$a,M$b,M$c,M$d,M$e,!1)},M$b.loop=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){void 0===M$e&&(M$e=!0),void 0===M$f&&(M$f=!1),void 0===M$g&&(M$g=!1);var M$h=this._create(!1,!0,M$a,M$b,M$c,M$d,M$e,M$g);M$h&&(M$h.jumpFrame=M$f)},M$b.frameOnce=function(M$a,M$b,M$c,M$d,M$e){void 0===M$e&&(M$e=!0),this._create(!0,!1,M$a,M$b,M$c,M$d,M$e,!1)},M$b.frameLoop=function(M$a,M$b,M$c,M$d,M$e,M$f){void 0===M$e&&(M$e=!0),void 0===M$f&&(M$f=!1),this._create(!0,!0,M$a,M$b,M$c,M$d,M$e,M$f)},M$b.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+M$j._freeCount},M$b.clear=function(M$a,M$b){var M$c=this._getHandler(M$a,M$b);return!(!M$c||this._isIgnoreRecover(M$c))&&(delete this._map[M$c.key],M$c.key=null,M$c.clear(),!0)},M$b.clearAll=function(M$a){if(M$a)for(var M$b=0,M$c=this._handlers.length;M$b<M$c;M$b++){var M$d=this._handlers[M$b];M$d.caller===M$a&&(this._isIgnoreRecover(M$d)||(delete this._map[M$d.key],M$d.key=null,M$d.clear()))}},M$b._getHandler=function(M$a,M$b){var M$c=M$a?M$a.$_GID||(M$a.$_GID=M$$.getGID()):0,M$d=M$b.$_TID||(M$b.$_TID=this._mid++);return this._map[M$c+"_"+M$d]},M$b._isIgnoreRecover=function(M$a){if(M$a.ignoreRecover||M$a.caller&&"IgnoreRecover"==M$a.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var M$b="";try{arguments.propertyIsEnumerable.caller}catch(M$a){M$b=M$a.stack}M$x.recordError("报错：核心定时器销毁忽略  "+M$b)}return!0}return!1},M$b.hasHandler=function(M$a,M$b){return this._map[M$a.$_GID+"_"+M$b.$_TID]},M$b.callLater=function(M$a,M$b,M$c){if(null==this._getHandler(M$a,M$b)){var M$d=M$j.create();M$d.caller=M$a,M$d.method=M$b,M$d.args=M$c,this._indexHandler(M$d),this._laters.push(M$d)}},M$b.runCallLater=function(M$a,M$b){var M$c=this._getHandler(M$a,M$b);M$c&&null!=M$c.method&&(this._isIgnoreRecover(M$c)||(delete this._map[M$c.key],M$c.run(!0)))},M$b.runTimer=function(M$a,M$b){this.runCallLater(M$a,M$b)},M$o(0,M$b,"delta",function(){return this._delta}),M$a.__init$=function(){M$j=function(){function M$b(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}M$k(M$b,"");var M$a=M$b.prototype;return M$a.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},M$a.recover=function(){this.clear(),this.args=M$b._freeHandler,M$b._freeHandler=this,M$b._freeCount++},M$a.run=function(M$a){var M$b=this.caller;if(M$b&&M$b.destroyed)return this.clear();var M$c=this.method,M$d=this.args;M$a&&this.clear(),null!=M$c&&(M$d?M$c.apply(M$b,M$d):M$c.call(M$b))},M$b._freeHandler=null,M$b._freeCount=0,M$b.create=function(){var M$a=M$b._freeHandler;return M$a?(M$b._freeHandler=M$a.args,--M$b._freeCount,M$a.args=null,M$a):new M$b},M$b}()},M$a}()),M$Z=function(){function M$l(){this.gid=0}M$k(M$l,"laya.utils.Tween");var M$a=M$l.prototype;return M$a.to=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){return void 0===M$f&&(M$f=0),void 0===M$g&&(M$g=!1),this._create(M$a,M$b,M$c,M$d,M$e,M$f,M$g,!0,!1,!0)},M$a.from=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){return void 0===M$f&&(M$f=0),void 0===M$g&&(M$g=!1),this._create(M$a,M$b,M$c,M$d,M$e,M$f,M$g,!1,!1,!0)},M$a._create=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){if(!M$a)throw new Error("Tween:target is null");this._target=M$a,this._duration=M$c,this._ease=M$d||M$b.ease||M$l.easeNone,this._complete=M$e||M$b.complete,this._delay=M$f,this._props=[],this._usedTimer=0,this._startTimer=M$O.now(),this._usedPool=M$i,this._delayParam=null,this.update=M$b.update;var M$k=M$a.$_GID||(M$a.$_GID=M$$.getGID());return M$l.tweenMap[M$k]?(M$g&&M$l.clearTween(M$a),M$l.tweenMap[M$k].push(this)):M$l.tweenMap[M$k]=[this],M$j?M$f<=0?this.firstStart(M$a,M$b,M$h):(this._delayParam=[M$a,M$b,M$h],M$x.scaleTimer.once(M$f,this,this.firstStart,this._delayParam)):this._initProps(M$a,M$b,M$h),this},M$a.firstStart=function(M$a,M$b,M$c){this._delayParam=null,M$a.destroyed?this.clear():(this._initProps(M$a,M$b,M$c),this._beginLoop())},M$a._initProps=function(M$a,M$b,M$c){for(var M$d in M$b)if("number"==typeof M$a[M$d]){var M$e=M$c?M$a[M$d]:M$b[M$d],M$f=M$c?M$b[M$d]:M$a[M$d];this._props.push([M$d,M$e,M$f-M$e]),M$c||(M$a[M$d]=M$e)}},M$a._beginLoop=function(){M$x.scaleTimer.frameLoop(1,this,this._doEase)},M$a._doEase=function(){this._updateEase(M$O.now())},M$a._updateEase=function(M$a){var M$b=this._target;if(M$b){if(M$b.destroyed)return M$l.clearTween(M$b);var M$c=this._usedTimer=M$a-this._startTimer-this._delay;if(!(M$c<0)){if(M$c>=this._duration)return this.complete();for(var M$d=0<M$c?this._ease(M$c,0,1,this._duration):0,M$e=this._props,M$f=0,M$g=M$e.length;M$f<M$g;M$f++){var M$h=M$e[M$f];M$b[M$h[0]]=M$h[1]+M$d*M$h[2]}this.update&&this.update.run()}}},M$a.complete=function(){if(this._target){M$x.scaleTimer.runTimer(this,this.firstStart);for(var M$a=this._target,M$b=this._props,M$c=this._complete,M$d=0,M$e=M$b.length;M$d<M$e;M$d++){var M$f=M$b[M$d];M$a[M$f[0]]=M$f[1]+M$f[2]}this.update&&this.update.run(),this.clear(),M$c&&M$c.run()}},M$a.pause=function(){M$x.scaleTimer.clear(this,this._beginLoop),M$x.scaleTimer.clear(this,this._doEase),M$x.scaleTimer.clear(this,this.firstStart);var M$a;(M$a=M$O.now()-this._startTimer-this._delay)<0&&(this._usedTimer=M$a)},M$a.setStartTime=function(M$a){this._startTimer=M$a},M$a.clear=function(){this._target&&(this._remove(),this._clear())},M$a._clear=function(){this.pause(),M$x.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,M$W.recover("tween",this))},M$a.recover=function(){this._usedPool=!0,this._clear()},M$a._remove=function(){var M$a=M$l.tweenMap[this._target.$_GID];if(M$a)for(var M$b=0,M$c=M$a.length;M$b<M$c;M$b++)if(M$a[M$b]===this){M$a.splice(M$b,1);break}},M$a.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=M$O.now(),this._delayParam)M$x.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var M$a=this._props,M$b=0,M$c=M$a.length;M$b<M$c;M$b++){var M$d=M$a[M$b];this._target[M$d[0]]=M$d[1]}M$x.scaleTimer.once(this._delay,this,this._beginLoop)}},M$a.resume=function(){this._usedTimer>=this._duration||(this._startTimer=M$O.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?M$x.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},M$o(0,M$a,"progress",null,function(M$a){var M$b=M$a*this._duration;this._startTimer=M$O.now()-this._delay-M$b}),M$l.to=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){return void 0===M$f&&(M$f=0),void 0===M$g&&(M$g=!1),void 0===M$h&&(M$h=!0),M$W.getItemByClass("tween",M$l)._create(M$a,M$b,M$c,M$d,M$e,M$f,M$g,!0,M$h,!0)},M$l.from=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){return void 0===M$f&&(M$f=0),void 0===M$g&&(M$g=!1),void 0===M$h&&(M$h=!0),M$W.getItemByClass("tween",M$l)._create(M$a,M$b,M$c,M$d,M$e,M$f,M$g,!1,M$h,!0)},M$l.clearAll=function(M$a){if(M$a&&M$a.$_GID){var M$b=M$l.tweenMap[M$a.$_GID];if(M$b){for(var M$c=0,M$d=M$b.length;M$c<M$d;M$c++)M$b[M$c]._clear();M$b.length=0}}},M$l.clear=function(M$a){M$a.clear()},M$l.clearTween=function(M$a){M$l.clearAll(M$a)},M$l.easeNone=function(M$a,M$b,M$c,M$d){return M$c*M$a/M$d+M$b},M$l.tweenMap={},M$l}(),M$$=function(){function M$h(){}return M$k(M$h,"laya.utils.Utils"),M$h.toRadian=function(M$a){return M$a*M$h._pi2},M$h.toAngle=function(M$a){return M$a*M$h._pi},M$h.toHexColor=function(M$a){if(M$a<0||isNaN(M$a))return null;for(var M$b=M$a.toString(16);M$b.length<6;)M$b="0"+M$b;return"#"+M$b},M$h.getGID=function(){return M$h._gid++},M$h.concatArray=function(M$a,M$b){if(!M$b)return M$a;if(!M$a)return M$b;var M$c=0,M$d=M$b.length;for(M$c=0;M$c<M$d;M$c++)M$a.push(M$b[M$c]);return M$a},M$h.clearArray=function(M$a){return M$a&&(M$a.length=0),M$a},M$h.copyArray=function(M$a,M$b){if(M$a||(M$a=[]),!M$b)return M$a;M$a.length=M$b.length;var M$c=0,M$d=M$b.length;for(M$c=0;M$c<M$d;M$c++)M$a[M$c]=M$b[M$c];return M$a},M$h.getGlobalRecByPoints=function(M$a,M$b,M$c,M$d,M$e){var M$f,M$g;return M$f=new M$A(M$b,M$c),M$f=M$a.localToGlobal(M$f),M$g=new M$A(M$d,M$e),M$g=M$a.localToGlobal(M$g),M$B._getWrapRec([M$f.x,M$f.y,M$g.x,M$g.y])},M$h.getGlobalPosAndScale=function(M$a){return M$h.getGlobalRecByPoints(M$a,0,0,1,1)},M$h.bind=function(M$a,M$b){return M$a.bind(M$b)},M$h.measureText=function(M$a,M$b){return M$F.measureText(M$a,M$b)},M$h.updateOrder=function(M$a){if(!M$a||M$a.length<2)return!1;for(var M$b,M$c=1,M$d=0,M$e=M$a.length,M$f=NaN;M$c<M$e;){for(M$b=M$a[M$d=M$c],M$f=M$a[M$d]._zOrder;-1<--M$d&&M$a[M$d]._zOrder>M$f;)M$a[M$d+1]=M$a[M$d];M$a[M$d+1]=M$b,M$c++}var M$g=M$b.parent.conchModel;if(M$g)if(null!=M$g.updateZOrder)M$g.updateZOrder();else{for(M$c=0;M$c<M$e;M$c++)M$g.removeChild(M$a[M$c].conchModel);for(M$c=0;M$c<M$e;M$c++)M$g.addChildAt(M$a[M$c].conchModel,M$c)}return!0},M$h.transPointList=function(M$a,M$b,M$c){var M$d=0,M$e=M$a.length;for(M$d=0;M$d<M$e;M$d+=2)M$a[M$d]+=M$b,M$a[M$d+1]+=M$c},M$h.parseInt=function(M$a,M$b){void 0===M$b&&(M$b=0);var M$c=M$O.window.parseInt(M$a,M$b);return isNaN(M$c)?0:M$c},M$h.getFileExtension=function(M$a){M$h._extReg.lastIndex=M$a.lastIndexOf(".");var M$b=M$h._extReg.exec(M$a);return M$b&&1<M$b.length?M$b[1].toLowerCase():null},M$h.getTransformRelativeToWindow=function(M$a,M$b,M$c){var M$d=M$x.stage,M$e=laya.utils.Utils.getGlobalPosAndScale(M$a),M$f=M$d._canvasTransform.clone(),M$g=M$f.tx,M$h=M$f.ty;M$f.rotate(-Math.PI/180*M$x.stage.canvasDegree),M$f.scale(M$x.stage.clientScaleX,M$x.stage.clientScaleY);var M$i=M$x.stage.canvasDegree%180!=0,M$j=NaN,M$k=NaN;M$i?(M$j=M$c+M$e.y,M$k=M$b+M$e.x,M$j*=M$f.d,M$k*=M$f.a,90==M$x.stage.canvasDegree?(M$j=M$g-M$j,M$k+=M$h):(M$j+=M$g,M$k=M$h-M$k)):(M$j=M$b+M$e.x,M$k=M$c+M$e.y,M$j*=M$f.a,M$k*=M$f.d,M$j+=M$g,M$k+=M$h);var M$l=NaN,M$m=NaN;return M$m=M$i?(M$l=M$f.d*M$e.height,M$f.a*M$e.width):(M$l=M$f.a*M$e.width,M$f.d*M$e.height),{x:M$j,y:M$k,scaleX:M$l,scaleY:M$m}},M$h.fitDOMElementInArea=function(M$a,M$b,M$c,M$d,M$e,M$f){M$a._fitLayaAirInitialized||(M$a._fitLayaAirInitialized=!0,M$a.style.transformOrigin=M$a.style.webKittransformOrigin="left top",M$a.style.position="absolute");var M$g=M$h.getTransformRelativeToWindow(M$b,M$c,M$d);M$a.style.transform=M$a.style.webkitTransform="scale("+M$g.scaleX+","+M$g.scaleY+") rotate("+M$x.stage.canvasDegree+"deg)",M$a.style.width=M$e+"px",M$a.style.height=M$f+"px",M$a.style.left=M$g.x+"px",M$a.style.top=M$g.y+"px"},M$h.isOkTextureList=function(M$a){if(!M$a)return!1;var M$b,M$c=0,M$d=M$a.length;for(M$c=0;M$c<M$d;M$c++)if(!(M$b=M$a[M$c])||!M$b.source)return!1;return!0},M$h.isOKCmdList=function(M$a){if(!M$a)return!1;var M$b,M$c,M$d=0,M$e=M$a.length,M$f=M$J._context;for(M$d=0;M$d<M$e;M$d++)switch((M$b=M$a[M$d]).callee){case M$f._drawTexture:case M$f._fillTexture:case M$f._drawTextureWithTransform:if(!(M$c=M$b[0])||!M$c.source)return!1}return!0},M$h._gid=1,M$h._pi=180/Math.PI,M$h._pi2=Math.PI/180,M$h._extReg=/\.(\w+)\??/g,M$h.parseXMLFromString=function(M$a){var M$b;if(M$a=M$a.replace(/>\s+</g,"><"),-1<(M$b=(new DOMParser).parseFromString(M$a,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(M$b.firstChild.firstChild.textContent);return M$b},M$h}(),M$_=function(){function M$a(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],M$J.isWebGL&&M$Q.regCacheByFunction(M$$.bind(this.startDispose,this),M$$.bind(this.getCacheList,this))}M$k(M$a,"laya.utils.VectorGraphManager");var M$b=M$a.prototype;return M$b.getId=function(){return this._id++},M$b.addShape=function(M$a,M$b){this.shapeDic[M$a]=M$b,this.useDic[M$a]||(this.useDic[M$a]=!0)},M$b.addLine=function(M$a,M$b){this.shapeLineDic[M$a]=M$b,this.shapeLineDic[M$a]||(this.shapeLineDic[M$a]=!0)},M$b.getShape=function(M$a){this._checkKey&&null!=this.useDic[M$a]&&(this.useDic[M$a]=!0)},M$b.deleteShape=function(M$a){this.shapeDic[M$a]&&(this.shapeDic[M$a]=null,delete this.shapeDic[M$a]),this.shapeLineDic[M$a]&&(this.shapeLineDic[M$a]=null,delete this.shapeLineDic[M$a]),null!=this.useDic[M$a]&&delete this.useDic[M$a]},M$b.getCacheList=function(){var M$a,M$b=[];for(M$a in this.shapeDic)M$b.push(this.shapeDic[M$a]);for(M$a in this.shapeLineDic)M$b.push(this.shapeLineDic[M$a]);return M$b},M$b.startDispose=function(M$a){var M$b;for(M$b in this.useDic)this.useDic[M$b]=!1;this._checkKey=!0},M$b.endDispose=function(){if(this._checkKey){var M$a;for(M$a in this.useDic)this.useDic[M$a]||this.deleteShape(M$a);this._checkKey=!1}},M$a.getInstance=function(){return M$a.instance=M$a.instance||new M$a},M$a.instance=null,M$a}(),M$y=function(){function M$d(){this._obj=null,this._obj=M$d.supportWeakMap?new M$O.window.WeakMap:{},M$d.supportWeakMap||M$d._maps.push(this)}M$k(M$d,"laya.utils.WeakObject");var M$a=M$d.prototype;return M$a.set=function(M$a,M$b){if(null!=M$a)if(M$d.supportWeakMap){var M$c=M$a;"string"!=typeof M$a&&"number"!=typeof M$a||(M$c=M$d._keys[M$a])||(M$c=M$d._keys[M$a]={k:M$a}),this._obj.set(M$c,M$b)}else"string"==typeof M$a||"number"==typeof M$a?this._obj[M$a]=M$b:(M$a.$_GID||(M$a.$_GID=M$$.getGID()),this._obj[M$a.$_GID]=M$b)},M$a.get=function(M$a){if(null==M$a)return null;if(M$d.supportWeakMap){var M$b="string"==typeof M$a||"number"==typeof M$a?M$d._keys[M$a]:M$a;return M$b?this._obj.get(M$b):null}return"string"==typeof M$a||"number"==typeof M$a?this._obj[M$a]:this._obj[M$a.$_GID]},M$a.del=function(M$a){if(null!=M$a)if(M$d.supportWeakMap){var M$b="string"==typeof M$a||"number"==typeof M$a?M$d._keys[M$a]:M$a;if(!M$b)return;this._obj.delete(M$b)}else"string"==typeof M$a||"number"==typeof M$a?delete this._obj[M$a]:delete this._obj[this._obj.$_GID]},M$a.has=function(M$a){if(null==M$a)return!1;if(M$d.supportWeakMap){var M$b="string"==typeof M$a||"number"==typeof M$a?M$d._keys[M$a]:M$a;return this._obj.has(M$b)}return"string"==typeof M$a||"number"==typeof M$a?null!=this._obj[M$a]:null!=this._obj[this._obj.$_GID]},M$d.__init__=function(){(M$d.supportWeakMap=null!=M$O.window.WeakMap)||M$x.timer.loop(M$d.delInterval,null,M$d.clearCache)},M$d.clearCache=function(){for(var M$a=0,M$b=M$d._maps.length;M$a<M$b;M$a++){M$d._maps[M$a]._obj={}}},M$d.supportWeakMap=!1,M$d.delInterval=3e5,M$d._keys={},M$d._maps=[],M$i(M$d,["I",function(){return this.I=new M$d}]),M$d}(),M$z=function(){function M$a(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}M$k(M$a,"laya.utils.WordText");var M$b=M$a.prototype;return M$b.setText=function(M$a){this.changed=!0,this._text=M$a},M$b.toString=function(){return this._text},M$b.charCodeAt=function(M$a){return this._text?this._text.charCodeAt(M$a):NaN},M$b.charAt=function(M$a){return this._text?this._text.charAt(M$a):null},M$o(0,M$b,"length",function(){return this._text?this._text.length:0}),M$a}(),M$aa=function(M$a){function M$g(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,M$g.__super.call(this),this._childs=M$g.ARRAY_EMPTY,this._$P=M$g.PROP_EMPTY,this.timer=M$x.scaleTimer,this.conchModel=M$J.isConchNode?this.createConchModel():null}M$k(M$g,"laya.display.Node",M$j);var M$b=M$g.prototype;return M$b._setBit=function(M$a,M$b){1==M$a&&(this._getBit(M$a)!=M$b&&this._updateDisplayedInstage());M$b?this._bits|=M$a:this._bits&=~M$a},M$b._getBit=function(M$a){return 0!=(this._bits&M$a)},M$b._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},M$b._setUpNoticeType=function(M$a){var M$b=this;for(M$b._setBit(M$a,!0),M$b=M$b.parent;M$b;){if(M$b._getBit(M$a))return;M$b._setBit(M$a,!0),M$b=M$b.parent}},M$b.on=function(M$a,M$b,M$c,M$d){return"display"!==M$a&&"undisplay"!==M$a||this._getBit(1)||this._setUpNoticeType(1),this._createListener(M$a,M$b,M$c,M$d,!1)},M$b.once=function(M$a,M$b,M$c,M$d){return"display"!==M$a&&"undisplay"!==M$a||this._getBit(1)||this._setUpNoticeType(1),this._createListener(M$a,M$b,M$c,M$d,!0)},M$b.createConchModel=function(){return null},M$b.destroy=function(M$a){void 0===M$a&&(M$a=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(M$a?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},M$b.destroyChildren=function(){if(this._childs)for(var M$a=this._childs.length-1;-1<M$a;M$a--)this._childs[M$a].destroy(!0)},M$b.addChild=function(M$a){if(!M$a||this.destroyed||M$a===this)return M$a;if(M$a.zOrder&&this._set$P("hasZorder",!0),M$a._parent===this){var M$b=this.getChildIndex(M$a);M$b!==this._childs.length-1&&(this._childs.splice(M$b,1),this._childs.push(M$a),this.conchModel&&(this.conchModel.removeChild(M$a.conchModel),this.conchModel.addChildAt(M$a.conchModel,this._childs.length-1)),this._childChanged())}else M$a.parent&&M$a.parent.removeChild(M$a),this._childs===M$g.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(M$a),this.conchModel&&this.conchModel.addChildAt(M$a.conchModel,this._childs.length-1),(M$a.parent=this)._childChanged();return M$a},M$b.addChildren=function(M$a){for(var M$b=arguments,M$c=0,M$d=M$b.length;M$c<M$d;)this.addChild(M$b[M$c++])},M$b.addChildAt=function(M$a,M$b){if(!M$a||this.destroyed||M$a===this)return M$a;if(M$a.zOrder&&this._set$P("hasZorder",!0),0<=M$b&&M$b<=this._childs.length){if(M$a._parent===this){var M$c=this.getChildIndex(M$a);this._childs.splice(M$c,1),this._childs.splice(M$b,0,M$a),this.conchModel&&(this.conchModel.removeChild(M$a.conchModel),this.conchModel.addChildAt(M$a.conchModel,M$b)),this._childChanged()}else M$a.parent&&M$a.parent.removeChild(M$a),this._childs===M$g.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(M$b,0,M$a),this.conchModel&&this.conchModel.addChildAt(M$a.conchModel,M$b),M$a.parent=this;return M$a}throw new Error("appendChildAt:The index is out of bounds")},M$b.getChildIndex=function(M$a){return this._childs.indexOf(M$a)},M$b.getChildByName=function(M$a){var M$b=this._childs;if(M$b)for(var M$c=0,M$d=M$b.length;M$c<M$d;M$c++){var M$e=M$b[M$c];if(M$e.name===M$a)return M$e}return null},M$b._get$P=function(M$a){return this._$P[M$a]},M$b._set$P=function(M$a,M$b){return this.destroyed||(this._$P===M$g.PROP_EMPTY&&(this._$P={}),this._$P[M$a]=M$b),M$b},M$b.getChildAt=function(M$a){return this._childs[M$a]},M$b.setChildIndex=function(M$a,M$b){var M$c=this._childs;if(M$b<0||M$b>=M$c.length)throw new Error("setChildIndex:The index is out of bounds.");var M$d=this.getChildIndex(M$a);if(M$d<0)throw new Error("setChildIndex:node is must child of this object.");return M$c.splice(M$d,1),M$c.splice(M$b,0,M$a),this.conchModel&&(this.conchModel.removeChild(M$a.conchModel),this.conchModel.addChildAt(M$a.conchModel,M$b)),this._childChanged(),M$a},M$b._childChanged=function(M$a){},M$b.removeChild=function(M$a){if(!this._childs)return M$a;var M$b=this._childs.indexOf(M$a);return this.removeChildAt(M$b)},M$b.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},M$b.removeChildByName=function(M$a){var M$b=this.getChildByName(M$a);return M$b&&this.removeChild(M$b),M$b},M$b.removeChildAt=function(M$a){var M$b=this.getChildAt(M$a);if(M$b){for(var M$c=this._childs.length-1,M$d=M$a;M$d<M$c;++M$d)this._childs[M$d]=this._childs[M$d+1];this._childs.length=M$c,this.conchModel&&this.conchModel.removeChild(M$b.conchModel),M$b.parent=null}return M$b},M$b.removeChildren=function(M$a,M$b){if(void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=2147483647),this._childs&&0<this._childs.length){var M$c=this._childs;if(0===M$a&&M$f<=M$b){var M$d=M$c;this._childs=M$g.ARRAY_EMPTY}else M$d=M$c.splice(M$a,M$b-M$a);for(var M$e=0,M$f=M$d.length;M$e<M$f;M$e++)M$d[M$e].parent=null,this.conchModel&&this.conchModel.removeChild(M$d[M$e].conchModel)}return this},M$b.replaceChild=function(M$a,M$b){var M$c=this._childs.indexOf(M$b);return-1<M$c?(this._childs.splice(M$c,1,M$a),this.conchModel&&(this.conchModel.removeChild(M$b.conchModel),this.conchModel.addChildAt(M$a.conchModel,M$c)),M$b.parent=null,M$a.parent=this,M$a):null},M$b._updateDisplayedInstage=function(){var M$a;M$a=this;var M$b=M$x.stage;for(this._displayedInStage=!1;M$a;){if(M$a._getBit(1)){this._displayedInStage=M$a._displayedInStage;break}if(M$a==M$b||M$a._displayedInStage){this._displayedInStage=!0;break}M$a=M$a.parent}},M$b._setDisplay=function(M$a){this._displayedInStage!==M$a&&((this._displayedInStage=M$a)?this.event("display"):this.event("undisplay"))},M$b._displayChild=function(M$a,M$b){var M$c=M$a._childs;if(M$c)for(var M$d=0;M$d<M$c.length;M$d++){var M$e=M$c[M$d];M$e&&M$e._getBit(1)&&(0<M$e._childs.length?this._displayChild(M$e,M$b):M$e._setDisplay(M$b))}M$a._setDisplay(M$b)},M$b.contains=function(M$a){if(M$a===this)return!0;for(;M$a;){if(M$a.parent===this)return!0;M$a=M$a.parent}return!1},M$b.timerLoop=function(M$a,M$b,M$c,M$d,M$e,M$f){void 0===M$e&&(M$e=!0),void 0===M$f&&(M$f=!1),this.timer.loop(M$a,M$b,M$c,M$d,M$e,M$f)},M$b.timerOnce=function(M$a,M$b,M$c,M$d,M$e){void 0===M$e&&(M$e=!0),this.timer._create(!1,!1,M$a,M$b,M$c,M$d,M$e)},M$b.frameLoop=function(M$a,M$b,M$c,M$d,M$e){void 0===M$e&&(M$e=!0),this.timer._create(!0,!0,M$a,M$b,M$c,M$d,M$e)},M$b.frameOnce=function(M$a,M$b,M$c,M$d,M$e){void 0===M$e&&(M$e=!0),this.timer._create(!0,!1,M$a,M$b,M$c,M$d,M$e)},M$b.clearTimer=function(M$a,M$b){this.timer.clear(M$a,M$b)},M$o(0,M$b,"numChildren",function(){return this._childs.length}),M$o(0,M$b,"destroyed",function(){return this._destroyed}),M$o(0,M$b,"parent",function(){return this._parent},function(M$a){this._parent!==M$a&&(M$a?(this._parent=M$a,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),M$a.displayedInStage&&this._displayChild(this,!0)),M$a._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=M$a))}),M$o(0,M$b,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),M$g.ARRAY_EMPTY=[],M$g.PROP_EMPTY={},M$g.NOTICE_DISPLAY=1,M$g.MOUSEENABLE=2,M$g}(),M$ba=function(M$a){function M$m(M$a){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,M$m.__super.call(this),this._padding=M$m._PADDING,this._spacing=M$m._SPACING,this._aligns=M$m._ALIGNS,this._font=M$n.EMPTY,this._ower=M$a}M$k(M$m,"laya.display.css.CSSStyle",M$a);var M$b=M$m.prototype;return M$b.destroy=function(){this._ower=null,this._font=null,this._rect=null},M$b.inherit=function(M$a){this._font=M$a._font,this._spacing=M$a._spacing===M$m._SPACING?M$m._SPACING:M$a._spacing.slice(),this.lineHeight=M$a.lineHeight},M$b._widthAuto=function(){return 0!=(262144&this._type)},M$b.widthed=function(M$a){return 0!=(8&this._type)},M$b._calculation=function(M$a,M$b){if(M$b.indexOf("%")<0)return!1;var M$d=this._ower,M$e=M$d.parent,M$f=this._rect;function M$g(M$a,M$b,M$c){return M$a*M$c[0]+M$b*M$c[1]+M$c[2]}function M$c(M$a){var M$b=M$e.width,M$c=M$d.width;M$f.width&&(M$d.width=M$g(M$b,M$c,M$f.width)),M$f.height&&(M$d.height=M$g(M$b,M$c,M$f.height)),M$f.left&&(M$d.x=M$g(M$b,M$c,M$f.left)),M$f.top&&(M$d.y=M$g(M$b,M$c,M$f.top))}null===M$f&&(M$e._getCSSStyle()._type|=524288,M$e.on("resize",this,M$c),this._rect=M$f={input:{}});var M$h=M$b.split(" ");return M$h[0]=parseFloat(M$h[0])/100,1==M$h.length?M$h[1]=M$h[2]=0:(M$h[1]=parseFloat(M$h[1])/100,M$h[2]=parseFloat(M$h[2])),M$f[M$a]=M$h,M$f.input[M$a]=M$b,M$c(),!0},M$b.heighted=function(M$a){return 0!=(8192&this._type)},M$b.size=function(M$a,M$b){var M$c=this._ower,M$d=!1;-1!==M$a&&M$a!=this._ower.width&&(this._type|=8,this._ower.width=M$a,M$d=!0),-1!==M$b&&M$b!=this._ower.height&&(this._type|=8192,this._ower.height=M$b,M$d=!0),M$d&&(M$c._layoutLater(),524288&this._type&&M$c.event("resize",this))},M$b._getAlign=function(){return this._aligns[0]},M$b._getValign=function(){return this._aligns[1]},M$b._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},M$b._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new M$n(this._font))},M$b.render=function(M$a,M$b,M$c,M$d){var M$e=M$a.width,M$f=M$a.height;M$c-=M$a.pivotX,M$d-=M$a.pivotY,this._bgground&&null!=this._bgground.color&&M$b.ctx.fillRect(M$c,M$d,M$e,M$f,this._bgground.color),this._border&&this._border.color&&M$b.drawRect(M$c,M$d,M$e,M$f,this._border.color.strColor,this._border.size)},M$b.getCSSStyle=function(){return this},M$b.cssText=function(M$a){this.attrs(M$m.parseOneCSS(M$a,";"))},M$b.attrs=function(M$a){if(M$a)for(var M$b=0,M$c=M$a.length;M$b<M$c;M$b++){var M$d=M$a[M$b];this[M$d[0]]=M$d[1]}},M$b.setTransform=function(M$a){"none"===M$a?this._tf=M$h._TF_EMPTY:this.attrs(M$m.parseOneCSS(M$a,","))},M$b.translate=function(M$a,M$b){this._tf===M$h._TF_EMPTY&&(this._tf=new M$e),this._tf.translateX=M$a,this._tf.translateY=M$b},M$b.scale=function(M$a,M$b){this._tf===M$h._TF_EMPTY&&(this._tf=new M$e),this._tf.scaleX=M$a,this._tf.scaleY=M$b},M$b._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},M$o(0,M$b,"block",M$a.prototype._$get_block,function(M$a){M$a?this._type|=1:this._type&=-2}),M$o(0,M$b,"valign",function(){return M$m._valigndef[this._aligns[1]]},function(M$a){this._aligns===M$m._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=M$m._valigndef[M$a]}),M$o(0,M$b,"height",null,function(M$a){if(this._type|=8192,"string"==typeof M$a){if(this._calculation("height",M$a))return;M$a=parseInt(M$a)}this.size(-1,M$a)}),M$o(0,M$b,"width",null,function(M$a){if(this._type|=8,"string"==typeof M$a){var M$b=M$a.indexOf("auto");if(0<=M$b&&(this._type|=262144,M$a=M$a.substr(0,M$b)),this._calculation("width",M$a))return;M$a=parseInt(M$a)}this.size(M$a,-1)}),M$o(0,M$b,"fontWeight",function(){return this._font.weight},function(M$a){this._createFont().weight=M$a}),M$o(0,M$b,"left",null,function(M$a){var M$b=this._ower;if("string"==typeof M$a){if("center"===M$a?M$a="50% -50% 0":"right"===M$a&&(M$a="100% -100% 0"),this._calculation("left",M$a))return;M$a=parseInt(M$a)}M$b.x=M$a}),M$o(0,M$b,"_translate",null,function(M$a){this.translate(M$a[0],M$a[1])}),M$o(0,M$b,"absolute",function(){return 0!=(4&this._type)}),M$o(0,M$b,"top",null,function(M$a){var M$b=this._ower;if("string"==typeof M$a){if("middle"===M$a?M$a="50% -50% 0":"bottom"===M$a&&(M$a="100% -100% 0"),this._calculation("top",M$a))return;M$a=parseInt(M$a)}M$b.y=M$a}),M$o(0,M$b,"align",function(){return M$m._aligndef[this._aligns[0]]},function(M$a){this._aligns===M$m._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=M$m._aligndef[M$a]}),M$o(0,M$b,"bold",function(){return this._font.bold},function(M$a){this._createFont().bold=M$a}),M$o(0,M$b,"padding",function(){return this._padding},function(M$a){this._padding=M$a}),M$o(0,M$b,"leading",function(){return this._spacing[1]},function(M$a){"string"==typeof M$a&&(M$a=parseInt(M$a+"")),this._spacing===M$m._SPACING&&(this._spacing=[0,0]),this._spacing[1]=M$a}),M$o(0,M$b,"lineElement",function(){return 0!=(65536&this._type)},function(M$a){M$a?this._type|=65536:this._type&=-65537}),M$o(0,M$b,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(M$a){this.lineElement=!1,"right"===M$a?this._type|=32768:this._type&=-32769}),M$o(0,M$b,"textDecoration",function(){return this._font.decoration},function(M$a){this._createFont().decoration=M$a}),M$o(0,M$b,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(M$a){"nowrap"===M$a&&(this._type|=131072),"none"===M$a&&(this._type&=-131073)}),M$o(0,M$b,"background",null,function(M$a){M$a?(this._bgground||(this._bgground={}),this._bgground.color=M$a,this._ower.conchModel&&this._ower.conchModel.bgColor(M$a),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),M$o(0,M$b,"wordWrap",function(){return 0==(131072&this._type)},function(M$a){M$a?this._type&=-131073:this._type|=131072}),M$o(0,M$b,"color",function(){return this._font.color},function(M$a){this._createFont().color=M$a}),M$o(0,M$b,"password",function(){return this._font.password},function(M$a){this._createFont().password=M$a}),M$o(0,M$b,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(M$a){"none"===M$a?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=M$a),this._ower.conchModel&&this._ower.conchModel.bgColor(M$a),this._ower._renderType|=256}),M$o(0,M$b,"font",function(){return this._font.toString()},function(M$a){this._createFont().set(M$a)}),M$o(0,M$b,"weight",null,function(M$a){this._createFont().weight=M$a}),M$o(0,M$b,"letterSpacing",function(){return this._spacing[0]},function(M$a){"string"==typeof M$a&&(M$a=parseInt(M$a+"")),this._spacing===M$m._SPACING&&(this._spacing=[0,0]),this._spacing[0]=M$a}),M$o(0,M$b,"fontSize",function(){return this._font.size},function(M$a){this._createFont().size=M$a}),M$o(0,M$b,"italic",function(){return this._font.italic},function(M$a){this._createFont().italic=M$a}),M$o(0,M$b,"fontFamily",function(){return this._font.family},function(M$a){this._createFont().family=M$a}),M$o(0,M$b,"stroke",function(){return this._font.stroke[0]},function(M$a){this._createFont().stroke===M$n._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=M$a}),M$o(0,M$b,"strokeColor",function(){return this._font.stroke[1]},function(M$a){this._createFont().stroke===M$n._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=M$a}),M$o(0,M$b,"border",function(){return this._border?this._border.value:""},function(M$a){if("none"!=M$a){this._border||(this._border={});var M$b=(this._border.value=M$a).split(" ");if(this._border.color=M$S.create(M$b[M$b.length-1]),1==M$b.length)return this._border.size=1,void(this._border.type="solid");var M$c=0;0<M$b[0].indexOf("px")?(this._border.size=parseInt(M$b[0]),M$c++):this._border.size=1,this._border.type=M$b[M$c],this._ower._renderType|=256}else this._border=null}),M$o(0,M$b,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(M$a){M$a?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==M$a?null:M$S.create(M$a),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),M$o(0,M$b,"position",function(){return 4&this._type?"absolute":""},function(M$a){"absolute"==M$a?this._type|=4:this._type&=-5}),M$o(0,M$b,"display",null,function(M$a){switch(M$a){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),M$o(0,M$b,"paddingLeft",function(){return this.padding[3]}),M$o(0,M$b,"paddingTop",function(){return this.padding[0]}),M$o(0,M$b,"_scale",null,function(M$a){this._ower.scale(M$a[0],M$a[1])}),M$o(0,M$b,"_rotate",null,function(M$a){this._ower.rotation=M$a}),M$m.parseOneCSS=function(M$a,M$b){for(var M$c,M$d=[],M$e=M$a.split(M$b),M$f=0,M$g=M$e.length;M$f<M$g;M$f++){var M$h=M$e[M$f],M$i=M$h.indexOf(":"),M$j=M$h.substr(0,M$i).replace(/^\s+|\s+$/g,"");if(0!=M$j.length){var M$k=M$h.substr(M$i+1).replace(/^\s+|\s+$/g,""),M$l=[M$j,M$k];switch(M$j){case"italic":case"bold":M$l[1]="true"==M$k;break;case"line-height":M$l[0]="lineHeight",M$l[1]=parseInt(M$k);break;case"font-size":M$l[0]="fontSize",M$l[1]=parseInt(M$k);break;case"padding":1<(M$c=M$k.split(" ")).length||(M$c[1]=M$c[2]=M$c[3]=M$c[0]),M$l[1]=[parseInt(M$c[0]),parseInt(M$c[1]),parseInt(M$c[2]),parseInt(M$c[3])];break;case"rotate":M$l[0]="_rotate",M$l[1]=parseFloat(M$k);break;case"scale":M$c=M$k.split(" "),M$l[0]="_scale",M$l[1]=[parseFloat(M$c[0]),parseFloat(M$c[1])];break;case"translate":M$c=M$k.split(" "),M$l[0]="_translate",M$l[1]=[parseInt(M$c[0]),parseInt(M$c[1])];break;default:(M$l[0]=M$m._CSSTOVALUE[M$j])||(M$l[0]=M$j)}M$d.push(M$l)}}return M$d},M$m.parseCSS=function(M$a,M$b){for(var M$c;null!=(M$c=M$m._parseCSSRegExp.exec(M$a));)M$m.styleSheets[M$c[1]]=M$m.parseOneCSS(M$c[2],";")},M$m.EMPTY=new M$m(null),M$m._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},M$m._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),M$m._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},M$m._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},M$m.styleSheets={},M$m.ALIGN_CENTER=1,M$m.ALIGN_RIGHT=2,M$m.VALIGN_MIDDLE=1,M$m.VALIGN_BOTTOM=2,M$m._CSS_BLOCK=1,M$m._DISPLAY_NONE=2,M$m._ABSOLUTE=4,M$m._WIDTH_SET=8,M$m._PADDING=[0,0,0,0],M$m._RECT=[-1,-1,-1,-1],M$m._SPACING=[0,0],M$m._ALIGNS=[0,0,0],M$m.ADDLAYOUTED=512,M$m._NEWFONT=4096,M$m._HEIGHT_SET=8192,M$m._BACKGROUND_SET=16384,M$m._FLOAT_RIGHT=32768,M$m._LINE_ELEMENT=65536,M$m._NOWARP=131072,M$m._WIDTHAUTO=262144,M$m._LISTERRESZIE=524288,M$m}(M$h),M$ca=function(M$a){function M$g(){this.url=null,this.audio=null,this.loaded=!1,M$g.__super.call(this)}M$k(M$g,"laya.media.h5audio.AudioSound",M$j);var M$b=M$g.prototype;return M$b.dispose=function(){var M$a=M$g._audioCache[this.url];M$a&&(M$a.src="",delete M$g._audioCache[this.url])},M$b.load=function(M$a){var M$b;if(M$a=M$I.formatURL(M$a),(this.url=M$a)==M$E._tMusic?(M$g._initMusicAudio(),(M$b=M$g._musicAudio).src!=M$a&&(M$g._audioCache[M$b.src]=null,M$b=null)):M$b=M$g._audioCache[M$a],M$b&&2<=M$b.readyState)this.event("complete");else{M$b||(M$b=M$a==M$E._tMusic?(M$g._initMusicAudio(),M$g._musicAudio):M$O.createElement("audio"),(M$g._audioCache[M$a]=M$b).src=M$a),M$b.addEventListener("canplaythrough",M$d),M$b.addEventListener("error",M$e);var M$c=this;(this.audio=M$b).load?M$b.load():M$e()}function M$d(){M$f(),M$c.loaded=!0,M$c.event("complete")}function M$e(){M$b.load=null,M$f(),M$c.event("error")}function M$f(){M$b.removeEventListener("canplaythrough",M$d),M$b.removeEventListener("error",M$e)}},M$b.play=function(M$a,M$b,M$c){if(void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),!this.url)return null;var M$d,M$e;if(!(M$d=this.url==M$E._tMusic?M$g._musicAudio:M$g._audioCache[this.url]))return null;M$e=M$W.getItem("audio:"+this.url),M$J.isConchApp?M$e||((M$e=M$O.createElement("audio")).src=this.url):this.url==M$E._tMusic?(M$g._initMusicAudio(),(M$e=M$g._musicAudio).src=this.url):M$e=M$e||M$d.cloneNode(!0);var M$f=new M$ma(M$e);return M$f.url=this.url,M$f.loops=M$b,M$f.startTime=M$a,M$f.startHandler=M$c,M$f.play(!1),M$E.addChannel(M$f),M$f},M$o(0,M$b,"duration",function(){var M$a;return(M$a=M$g._audioCache[this.url])?M$a.duration:0}),M$g._initMusicAudio=function(){M$g._musicAudio||(M$g._musicAudio||(M$g._musicAudio=M$O.createElement("audio")),M$J.isConchApp||M$O.document.addEventListener("mousedown",M$g._makeMusicOK))},M$g._makeMusicOK=function(){M$O.document.removeEventListener("mousedown",M$g._makeMusicOK),M$g._musicAudio.src?M$g._musicAudio.play():(M$g._musicAudio.src="",M$g._musicAudio.load())},M$g._audioCache={},M$g._musicAudio=null,M$g}(),M$da=function(M$a){function M$b(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,M$b.__super.call(this)}M$k(M$b,"laya.media.SoundChannel",M$j);var M$c=M$b.prototype;return M$c.play=function(){},M$c.stop=function(){},M$c.pause=function(){},M$c.resume=function(){},M$c.__runComplete=function(M$a){M$a&&M$a.run()},M$o(0,M$c,"volume",function(){return 1},function(M$a){}),M$o(0,M$c,"position",function(){return 0}),M$o(0,M$c,"duration",function(){return 0}),M$b}(),M$ea=function(M$a){function M$b(){M$b.__super.call(this)}M$k(M$b,"laya.media.Sound",M$j);var M$c=M$b.prototype;return M$c.load=function(M$a){},M$c.play=function(M$a,M$b,M$c){return void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),null},M$c.dispose=function(){},M$o(0,M$c,"duration",function(){return 0}),M$b}(),M$fa=function(M$a){function M$e(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,M$e.__super.call(this)}M$k(M$e,"laya.media.webaudio.WebAudioSound",M$j);var M$b=M$e.prototype;return M$b.load=function(M$a){this.url=M$a,this.audioBuffer=M$e._dataCache[M$a],this.audioBuffer?this._loaded(this.audioBuffer):(M$e.e.on("loaded:"+M$a,this,this._loaded),M$e.e.on("err:"+M$a,this,this._err),M$e.__loadingSound[M$a]||(M$e.__loadingSound[M$a]=!0,M$x.loader.load(M$a,M$s.create(this,this.onloaded),null,M$ha.BUFFER,4,!1,null,!0)))},M$b.onloaded=function(M$a){M$a||this._err(),this._disposed?this._removeLoadEvents():(this.data=M$a,M$e.buffs.push({buffer:this.data,url:this.url}),M$e.decode())},M$b._err=function(){if(this._removeLoadEvents(),M$e.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var M$a,M$b,M$c,M$d=0;for(M$a=(M$b=this.__toPlays).length,M$d=0;M$d<M$a;M$d++)(M$c=M$b[M$d])[3]&&!M$c[3].isStopped&&M$c[3].event("error");this.__toPlays.length=0}},M$b._loaded=function(M$a){this._removeLoadEvents(),this._disposed||(this.audioBuffer=M$a,this.loaded=!0,this.event("complete"))},M$b._removeLoadEvents=function(){M$e.e.off("loaded:"+this.url,this,this._loaded),M$e.e.off("err:"+this.url,this,this._err)},M$b.__playAfterLoaded=function(){if(this.__toPlays){var M$a,M$b,M$c,M$d=0;for(M$a=(M$b=this.__toPlays).length,M$d=0;M$d<M$a;M$d++)(M$c=M$b[M$d])[3]&&!M$c[3].isStopped&&this.play(M$c[0],M$c[1],M$c[2],M$c[3]);this.__toPlays.length=0}},M$b.play=function(M$a,M$b,M$c,M$d){return void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),M$d=M$d||new M$na,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([M$a,M$b,M$c,M$d]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),M$d.url=this.url,M$d.loops=M$b,M$d.audioBuffer=this.audioBuffer,M$d.startTime=M$a,M$d.startHandler=M$c,M$d.play(!1),M$E.addChannel(M$d),M$d},M$b.dispose=function(){this._disposed=!0,delete M$e._dataCache[this.url],delete M$e.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},M$o(0,M$b,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),M$e.decode=function(){if(!(M$e.buffs.length<=0||M$e.isDecoding))if(M$e.isDecoding=!0,(M$e.tInfo=M$e.buffs.shift())&&M$e.tInfo.buffer&&M$e.tInfo.buffer.byteLength)try{M$e.ctx.decodeAudioData(M$e.tInfo.buffer,M$e._done,M$e._fail)}catch(M$a){console.error("decodeAudioData error  byteLength:"+M$e.tInfo.buffer.byteLength+"  url:"+M$e.tInfo.url)}else M$e._fail()},M$e._done=function(M$a){M$e.e.event("loaded:"+M$e.tInfo.url,M$a),M$e._dataCache[M$e.tInfo.url]=M$a,M$e.isDecoding=!1,M$e.decode()},M$e._fail=function(){M$e.e.event("err:"+M$e.tInfo.url,null),M$e.isDecoding=!1,M$e.decode()},M$e._playEmptySound=function(){if(null!=M$e.ctx){if(M$e._emptySource&&(M$e._emptySource.stop(),M$e._emptySource.disconnect(0),!M$na._tryCleanFailed))try{M$e._emptySource.buffer=null}catch(M$a){M$na._tryCleanFailed=!0}var M$a=M$e.ctx.createBufferSource();M$a.buffer=M$e._miniBuffer,M$a.connect(M$e.ctx.destination),M$a.start(0,0,0),M$e._emptySource=M$a}},M$e._unlock=function(){M$e._unlocked||(M$e._playEmptySound(),"running"==M$e.ctx.state?(M$O.document.removeEventListener("mousedown",M$e._unlock,!0),M$O.document.removeEventListener("touchend",M$e._unlock,!0),M$O.document.removeEventListener("touchstart",M$e._unlock,!0),M$e._unlocked=!0):"suspended"==M$e.ctx.state&&M$E._recoverWebAudio())},M$e.initWebAudio=function(){"running"!=M$e.ctx.state&&(M$e._unlock(),M$O.document.addEventListener("mousedown",M$e._unlock,!0),M$O.document.addEventListener("touchend",M$e._unlock,!0),M$O.document.addEventListener("touchstart",M$e._unlock,!0))},M$e._emptySource=null,M$e._dataCache={},M$e.buffs=[],M$e.isDecoding=!1,M$e._unlocked=!1,M$e.tInfo=null,M$e.__loadingSound={},M$i(M$e,["window",function(){return this.window=M$O.window},"webAudioEnabled",function(){return this.webAudioEnabled=M$e.window.AudioContext||M$e.window.webkitAudioContext||M$e.window.mozAudioContext},"ctx",function(){return this.ctx=M$e.webAudioEnabled?new(M$e.window.AudioContext||M$e.window.webkitAudioContext||M$e.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=M$e.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new M$j}]),M$e}(),M$ga=function(M$a){function M$b(){this._responseType=null,this._data=null,M$b.__super.call(this),this._http=new M$O.window.XMLHttpRequest}M$k(M$b,"laya.net.HttpRequest",M$j);var M$c=M$b.prototype;return M$c.send=function(M$a,M$b,M$c,M$d,M$e){void 0===M$c&&(M$c="get"),void 0===M$d&&(M$d="text"),this._responseType=M$d,this._data=null;var M$f=this,M$g=this._http;if(M$g.open(M$c,M$a,!0),M$e)for(var M$h=0;M$h<M$e.length;M$h++)M$g.setRequestHeader(M$e[M$h++],M$e[M$h]);else M$J.isConchApp||(M$b&&"string"!=typeof M$b?M$g.setRequestHeader("Content-Type","application/json"):M$g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));M$g.responseType="arraybuffer"!==M$d?"text":"arraybuffer",M$g.onerror=function(M$a){M$f._onError(M$a)},M$g.onabort=function(M$a){M$f._onAbort(M$a)},M$g.onprogress=function(M$a){M$f._onProgress(M$a)},M$g.onload=function(M$a){M$f._onLoad(M$a)},M$g.send(M$b)},M$c._onProgress=function(M$a){M$a&&M$a.lengthComputable&&this.event("progress",M$a.loaded/M$a.total)},M$c._onAbort=function(M$a){this.error("Request was aborted by user")},M$c._onError=function(M$a){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},M$c._onLoad=function(M$a){var M$b=this._http,M$c=void 0!==M$b.status?M$b.status:200;200===M$c||204===M$c||0===M$c?this.complete():this.error("["+M$b.status+"]"+M$b.statusText+":"+M$b.responseURL)},M$c.error=function(M$a){this.clear(),this.event("error",M$a)},M$c.complete=function(){this.clear();var M$b=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=M$$.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(M$a){M$b=!1,this.error(M$a.message)}M$b&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},M$c.clear=function(){var M$a=this._http;M$a.onerror=M$a.onabort=M$a.onprogress=M$a.onload=null},M$o(0,M$c,"url",function(){return this._http.responseURL}),M$o(0,M$c,"http",function(){return this._http}),M$o(0,M$c,"data",function(){return this._data}),M$b}(),M$ha=function(M$a){function M$C(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,M$C.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}M$k(M$C,"laya.net.Loader",M$j);var M$b=M$C.prototype;return M$b.load=function(M$a,M$b,M$c,M$d,M$e){if(M$a&&""!=M$a||console.error("Loader 加载的url不合法 "+M$a),void 0===M$c&&(M$c=!0),void 0===M$e&&(M$e=!1),0===(this._url=M$a).indexOf("data:image")?this._type=M$b="image":this._type=M$b||(M$b=this.getTypeFromUrl(M$a)),this._cache=M$c,this._data=null,!M$e&&M$C.loadedMap[M$a])return this._data=M$C.loadedMap[M$a],this.event("progress",1),void this.event("complete",this._data);if(M$d&&M$C.setGroup(M$a,M$d),null!=M$C.parserMap[M$b])return this._customParse=!0,void(M$C.parserMap[M$b]instanceof laya.utils.Handler?M$C.parserMap[M$b].runWith(this):M$C.parserMap[M$b].call(null,this));if("image"===M$b||"htmlimage"===M$b||"nativeimage"===M$b)return this._loadImage(M$a);if("ttf"===M$b)return this._loadTTF(M$a);switch(M$b){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:M$b}M$C.preLoadedMap[M$a]?this.onLoaded(M$C.preLoadedMap[M$a]):M$g.resMgrLoad(M$a,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},M$b.getTypeFromUrl=function(M$a){var M$b=M$$.getFileExtension(M$a);return M$b?M$C.typeMap[M$b]:(console.warn("Not recognize the resources suffix",M$a),"text")},M$b._loadTTF=function(M$a){M$a=M$I.formatURL(M$a);var M$b=new M$H;M$b.complete=M$s.create(this,this.onLoaded),M$b.load(M$a)},M$b._loadImage=function(M$a){M$g.imgMgrLoad(M$a,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},M$b._loadImageComplete=function(M$a,M$b,M$c){if(null!=M$c)if(M$c instanceof ArrayBuffer){var M$d=new DataView(M$c),M$e=new laya.webgl.resource.WebGLImage(new Uint8Array(M$c,8),M$a,0,!1,M$d.getUint32(0),M$d.getUint32(4));this.onLoaded(M$e)}else if(M$c instanceof M$ka)M$C.imgMgrSet[M$a]=M$b,M$g.imgMgrLock(M$a,M$C.imgMgrSet[M$a]),this._url=M$a,this.complete(M$c);else{var M$f=-1!=M$a.indexOf(".png",M$a.length-4)?6408:6407;M$e=new laya.webgl.resource.WebGLImage(M$c,M$a,M$f,!1,M$c.width,M$c.height);this.onLoaded(M$e)}else this.event("error","Load image failed")},M$b._loadSound=function(M$a){var M$b=new M$E._soundClass,M$c=this;function M$d(){M$b.offAll()}M$b.on("complete",this,function(){M$d(),M$c.onLoaded(M$b)}),M$b.on("error",this,function(){M$d(),M$b.dispose(),M$c.event("error","Load sound failed")}),M$b.load(M$a)},M$b.onProgress=function(M$a){"atlas"===this._type?this.event("progress",.3*M$a):this.event("progress",M$a)},M$b.onError=function(M$a){this.event("error",M$a)},M$b._loadedComplete=function(M$a,M$b,M$c){if(null!=M$c)switch(this._type){case"atlas":case"plf":case"json":var M$d=new M$P(M$c);this.onLoaded(JSON.parse(M$d.readUTFBytes()));break;case"font":M$d=new M$P(M$c);this.onLoaded(M$$.parseXMLFromString(M$d.readUTFBytes()));break;default:this.onLoaded(M$c)}else this.event("error",M$a)},M$b.onLoaded=function(M$a){var M$b=this._type;if("plf"==M$b)this.parsePLFData(M$a),this.complete(M$a);else if("image"===M$b){var M$c=new M$ka(M$a);M$c.url=this._url,this.complete(M$c)}else if("sound"===M$b||"htmlimage"===M$b||"nativeimage"===M$b)this.complete(M$a);else if("atlas"===M$b){if(!M$a.src&&!M$a._setContext){if(!this._data){if((this._data=M$a).meta&&M$a.meta.image)for(var M$d=M$a.meta.image.split(","),M$e=0<=this._url.indexOf("/")?"/":"\\",M$f=this._url.lastIndexOf(M$e),M$g=0<=M$f?this._url.substr(0,M$f+1):"",M$h=0,M$i=M$d.length;M$h<M$i;M$h++)M$d[M$h]=M$g+M$d[M$h];else M$d=[this._url.replace(".json",".png")];M$d.reverse(),M$a.toLoads=M$d,M$a.pics=[]}return this.event("progress",.3+1/M$d.length*.6),this._loadImage(M$d.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(M$a),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var M$j=this._data.frames,M$k=this._url.split("?")[0],M$l=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:M$k.substring(0,M$k.lastIndexOf("."))+"/",M$m=this._data.pics,M$n=M$I.formatURL(this._url),M$o=M$C.atlasMap[M$n]||(M$C.atlasMap[M$n]=[]);M$o.dir=M$l;var M$p=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var M$q in M$p=parseFloat(this._data.meta.scale),M$j){var M$r,M$s=M$j[M$q],M$t=M$m[M$s.frame.idx?M$s.frame.idx:0],M$u=M$I.formatURL(M$l+M$q);M$t.scaleRate=M$p,M$r=M$ka.create(M$t,M$s.frame.x,M$s.frame.y,M$s.frame.w,M$s.frame.h,M$s.spriteSourceSize.x,M$s.spriteSourceSize.y,M$s.sourceSize.w,M$s.sourceSize.h),M$C.cacheRes(M$u,M$r),M$C.keepCache(this._url,M$l+M$q),M$r.url=M$u,M$o.push(M$u)}else for(M$q in M$j)M$t=M$m[(M$s=M$j[M$q]).frame.idx?M$s.frame.idx:0],M$u=M$I.formatURL(M$l+M$q),M$C.cacheRes(M$u,M$ka.create(M$t,M$s.frame.x,M$s.frame.y,M$s.frame.w,M$s.frame.h,M$s.spriteSourceSize.x,M$s.spriteSourceSize.y,M$s.sourceSize.w,M$s.sourceSize.h)),M$C.loadedMap[M$u].url=M$u,M$C.keepCache(this._url,M$l+M$q),M$o.push(M$u);delete this._data.pics,this.complete(this._data)}else if("font"==M$b){if(!M$a.src)return this._data=M$a,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var M$v=new M$D;M$v.parseFont(this._data,M$a);var M$w=this._url.split(".fnt")[0].split("/"),M$x=M$w[M$w.length-1];M$qa.registerBitmapFont(M$x,M$v),this._data=M$v,this.complete(this._data)}else if("pkm"==M$b){var M$A=M$wa.create(M$a,this._url),M$B=new M$ka(M$A);M$B.url=this._url,this.complete(M$B)}else this.complete(M$a)},M$b.parsePLFData=function(M$a){var M$b,M$c,M$d;for(M$b in M$a)switch(M$d=M$a[M$b],M$b){case"json":case"text":for(M$c in M$d)M$C.preLoadedMap[M$I.formatURL(M$c)]=M$d[M$c];break;default:for(M$c in M$d)M$C.preLoadedMap[M$I.formatURL(M$c)]=M$d[M$c]}},M$b.complete=function(M$a){this._data=M$a,this._customParse?this.event("loaded",M$a instanceof Array?[M$a]:M$a):(M$C._loaders.push(this),M$C._isWorking||M$C.checkNext())},M$b.endLoad=function(M$a){M$a&&(this._data=M$a),this._cache&&M$C.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},M$o(0,M$b,"url",function(){return this._url}),M$o(0,M$b,"data",function(){return this._data}),M$o(0,M$b,"cache",function(){return this._cache}),M$o(0,M$b,"type",function(){return this._type}),M$C.checkNext=function(){M$C._isWorking=!0;for(var M$a=M$O.now();M$C._startIndex<M$C._loaders.length;)if(M$O.now(),M$C._loaders[M$C._startIndex].endLoad(),M$C._startIndex++,M$O.now()-M$a>M$C.maxTimeOut)return console.warn("loader callback cost a long time:"+(M$O.now()-M$a)+" url="+M$C._loaders[M$C._startIndex-1].url),void M$x.timer.frameOnce(1,null,M$C.checkNext);M$C._loaders.length=0,M$C._startIndex=0,M$C._isWorking=!1},M$C.clearRes=function(M$a,M$b){if(null!=M$a){void 0===M$b&&(M$b=!1),M$a=M$I.formatURL(M$a);var M$c=M$C.getAtlas(M$a);if(M$c){for(var M$d=0,M$e=M$c.length;M$d<M$e;M$d++){var M$f=M$c[M$d],M$g=M$C.getRes(M$f);delete M$C.loadedMap[M$f],M$C.clearCache(M$a.substring(M$I.basePath.length),M$f.substring(M$I.basePath.length)),M$g&&M$g.destroy(M$b)}M$c.length=0,delete M$C.atlasMap[M$a],delete M$C.loadedMap[M$a]}else{var M$h=M$C.loadedMap[M$a];M$h&&(delete M$C.loadedMap[M$a],M$h instanceof laya.resource.Texture&&M$h.bitmap&&M$h.destroy(M$b))}}},M$C.clearTextureRes=function(M$a){M$a=M$I.formatURL(M$a);var M$b=laya.net.Loader.getAtlas(M$a),M$c=M$b&&0<M$b.length?laya.net.Loader.getRes(M$b[0]):laya.net.Loader.getRes(M$a);M$c&&M$c.bitmap&&(M$J.isConchApp&&!M$J.isConchWebGL?M$c.bitmap.source.releaseTexture&&M$c.bitmap.source.releaseTexture():null==M$c.bitmap._atlaser&&M$c.bitmap.releaseResource(!0))},M$C.getRes=function(M$a){return M$C.loadedMap[M$I.formatURL(M$a)]},M$C.getAtlas=function(M$a){return M$C.atlasMap[M$I.formatURL(M$a)]},M$C.cacheRes=function(M$a,M$b){M$a=M$I.formatURL(M$a),null!=M$C.loadedMap[M$a]?console.warn("Resources already exist,is repeated loading:",M$a):M$C.loadedMap[M$a]=M$b},M$C.setGroup=function(M$a,M$b){M$C.groupMap[M$b]||(M$C.groupMap[M$b]=[]),M$C.groupMap[M$b].push(M$a)},M$C.clearResByGroup=function(M$a){if(M$C.groupMap[M$a]){var M$b=M$C.groupMap[M$a],M$c=0,M$d=M$b.length;for(M$c=0;M$c<M$d;M$c++)M$C.clearRes(M$b[M$c]);M$b.length=0}},M$C.keepCache=function(M$a,M$b){if(M$a&&M$b){var M$c=M$C.cacheSet[M$b];M$c?-1==M$c.indexOf(M$a)&&M$c.push(M$a):M$C.cacheSet[M$b]=[M$a]}},M$C.clearCache=function(M$a,M$b){if(M$a&&M$b){var M$c=M$C.cacheSet[M$b];if(M$c){var M$d=M$c.indexOf(M$a);if(-1!==M$d){var M$e=M$c.length-1;0==M$e?(delete M$C.cacheSet[M$b],0<M$C.imgMgrSet[M$b]?M$g.imgMgrFree(M$b,M$C.imgMgrSet[M$b]):M$C.clearRes(M$b,!0)):(M$c[M$d]=M$c[M$e],M$c.length=M$e)}}}},M$C.saveObject=function(M$a,M$b,M$c){if(M$b&&M$a){var M$d=M$C.objectSet[M$a];M$d?(console.warn("Loader.saveObject: "+M$a),M$d[0]=M$b,M$d[1]=M$c):M$C.objectSet[M$a]=[M$b,M$c,[]]}},M$C.findObject=function(M$a){if(M$a){var M$b=M$C.objectSet[M$a];if(M$b)return M$b[0]}return null},M$C.keepObject=function(M$a,M$b){if(M$a&&M$b){var M$c=M$C.objectSet[M$b];M$c&&-1===M$c[2].indexOf(M$a)&&M$c[2].push(M$a)}},M$C.clearObject=function(M$a,M$b){if(M$a&&M$b){var M$c=M$C.objectSet[M$b];if(M$c){var M$d=M$c[2],M$e=M$d.indexOf(M$a);if(-1!==M$e){var M$f=M$d.length-1;0==M$f?(delete M$C.objectSet[M$b],M$c[1]&&M$c[1].call(null,M$c[0])):(M$d[M$e]=M$d[M$f],M$d.length=M$f)}}}},M$C.TEXT="text",M$C.JSON="json",M$C.XML="xml",M$C.BUFFER="arraybuffer",M$C.IMAGE="image",M$C.SOUND="sound",M$C.ATLAS="atlas",M$C.FONT="font",M$C.TTF="ttf",M$C.PLF="plf",M$C.PKM="pkm",M$C.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},M$C.parserMap={},M$C.groupMap={},M$C.maxTimeOut=100,M$C.loadedMap={},M$C.preLoadedMap={},M$C.atlasMap={},M$C._loaders=[],M$C._isWorking=!1,M$C._startIndex=0,M$C.imgCache={},M$C.cacheSet={},M$C.objectSet={},M$C.imgMgrSet={},M$C}(),M$ia=function(M$a){var M$m;function M$n(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},M$n.__super.call(this);for(var M$a=0;M$a<this._maxPriority;M$a++)this._resInfos[M$a]=[]}M$k(M$n,"laya.net.LoaderManager",M$j);var M$b=M$n.prototype;return M$b.create=function(M$a,M$c,M$b,M$d,M$e,M$f,M$g,M$h){if(null==M$f&&(M$f=2),null==M$g&&(M$g=!0),M$a instanceof Array){var M$i=M$a,M$j=M$i.length,M$k=0;if(M$b)var M$l=M$s.create(M$b.caller,M$b.method,M$b.args,!1);for(var M$m=0;M$m<M$j;M$m++){var M$n=M$i[M$m];"string"==typeof M$n&&(M$n=M$i[M$m]={url:M$n}),M$n.progress=0}for(M$m=0;M$m<M$j;M$m++){M$n=M$i[M$m];var M$o=M$b?M$s.create(null,M$r,[M$n],!1):null,M$p=M$b||M$c?M$s.create(null,M$q,[M$n]):null;this._create(M$n.url,M$p,M$o,M$n.clas||M$d,M$n.params||M$e,null!=M$n.priority&&0<=M$n.priority?M$n.priority:M$f,M$g,M$n.group||M$h)}function M$q(M$a,M$b){M$k++,M$a.progress=1,M$k===M$j&&M$c&&M$c.run()}function M$r(M$a,M$b){M$a.progress=M$b;for(var M$c=0,M$d=0;M$d<M$j;M$d++){M$c+=M$i[M$d].progress}var M$e=M$c/M$j;M$l.runWith(M$e)}return!0}return this._create(M$a,M$c,M$b,M$d,M$e,M$f,M$g,M$h)},M$b._create=function(M$b,M$c,M$a,M$d,M$e,M$f,M$g,M$h){M$b&&""!=M$b||console.error("加载的url不合法 "+M$b),null==M$f&&(M$f=2),null==M$g&&(M$g=!0);var M$i=M$I.formatURL(M$b),M$j=this.getRes(M$i);if(M$j)!M$j.hasOwnProperty("loaded")||M$j.loaded?(M$a&&M$a.runWith(1),M$c&&M$c.run()):M$c&&M$x.loader._createListener(M$b,M$c.caller,M$c.method,M$c.args,!0,!1);else{var M$k=M$$.getFileExtension(M$b),M$l=M$n.createMap[M$k];if(!M$l)throw new Error("LoaderManager:unknown file("+M$b+") extension with: "+M$k+".");M$d||(M$d=M$l[0]);var M$m=M$l[1];if("atlas"==M$k)this.load(M$b,M$c,M$a,M$m,M$f,M$g);else{M$d===M$ka&&(M$m="htmlimage"),(M$j=M$d?new M$d:null).hasOwnProperty("_loaded")&&(M$j._loaded=!1),M$j._setUrl(M$b),M$h&&M$j._setGroup(M$h),this._createLoad(M$j,M$b,M$s.create(null,function(M$a){M$j&&!M$j.destroyed&&M$a&&M$j.onAsynLoaded.call(M$j,M$b,M$a,M$e),M$c&&M$c.run();M$x.loader.event(M$b)}),M$a,M$m,M$f,!1,M$h,!0),M$g&&this.cacheRes(M$i,M$j)}}return M$j},M$b.load=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){M$a&&""!=M$a||console.error("加载的url不合法 "+M$a);var M$i=this;if(null==M$e&&(M$e=2),null==M$f&&(M$f=!0),void 0===M$h&&(M$h=!1),M$a instanceof Array)return this._loadAssets(M$a,M$b,M$c,M$d,M$e,M$f,M$g);var M$j=M$ha.getRes(M$a);if(null!=M$j)M$x.timer.frameOnce(1,null,function(){M$c&&M$c.runWith(1),M$b&&M$b.runWith(M$j),M$i._loaderCount||M$i.event("complete")});else{var M$k=M$n._resMap[M$a];M$k?(M$b&&M$k._createListener("complete",M$b.caller,M$b.method,M$b.args,!1,!1),M$c&&M$k._createListener("progress",M$c.caller,M$c.method,M$c.args,!1,!1)):((M$k=this._infoPool.length?this._infoPool.pop():new M$m).url=M$a,M$k.type=M$d,M$k.cache=M$f,M$k.group=M$g,M$k.ignoreCache=M$h,M$k.priority=M$e,M$b&&M$k.on("complete",M$b.caller,M$b.method,M$b.args),M$c&&M$k.on("progress",M$c.caller,M$c.method,M$c.args),M$n._resMap[M$a]=M$k,M$e=M$e<this._maxPriority?0<=M$e?M$e:0:this._maxPriority-1,this._resInfos[M$e].push(M$k),this._next())}return this},M$b._createLoad=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){var M$j=this;if(null==M$f&&(M$f=2),null==M$g&&(M$g=!0),void 0===M$i&&(M$i=!1),M$b instanceof Array)return this._loadAssets(M$b,M$c,M$d,M$e,M$f,M$g,M$h);var M$k=M$ha.getRes(M$b);if(null!=M$k)M$x.timer.frameOnce(1,null,function(){M$d&&M$d.runWith(1),M$c&&M$c.runWith(M$k),M$j._loaderCount||M$j.event("complete")});else{var M$l=M$n._resMap[M$b];M$l?(M$c&&M$l._createListener("complete",M$c.caller,M$c.method,M$c.args,!1,!1),M$d&&M$l._createListener("progress",M$d.caller,M$d.method,M$d.args,!1,!1)):((M$l=this._infoPool.length?this._infoPool.pop():new M$m).url=M$b,M$l.clas=M$a,M$l.type=M$e,M$l.cache=M$g,M$l.group=M$h,M$l.ignoreCache=M$i,M$l.priority=M$f,M$c&&M$l.on("complete",M$c.caller,M$c.method,M$c.args),M$d&&M$l.on("progress",M$d.caller,M$d.method,M$d.args),M$n._resMap[M$b]=M$l,M$f=M$f<this._maxPriority?0<=M$f?M$f:0:this._maxPriority-1,this._resInfos[M$f].push(M$l),this._next())}return this},M$b._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var M$a=0;M$a<this._maxPriority;M$a++)for(var M$b=this._resInfos[M$a];0<M$b.length;){var M$c=M$b.shift();if(M$c)return this._doLoad(M$c)}this._loaderCount||this.event("complete")}},M$b._doLoad=function(M$b){this._loaderCount++;var M$c=this._loaders.length?this._loaders.pop():new M$ha;M$c.on("complete",null,M$e),M$c.on("progress",null,function(M$a){M$b.event("progress",M$a)}),M$c.on("error",null,function(M$a){M$e(null)});var M$d=this;function M$e(M$a){M$c.offAll(),M$c._data=null,M$c._customParse=!1,M$d._loaders.push(M$c),M$d._endLoad(M$b,M$a instanceof Array?[M$a]:M$a),M$d._loaderCount--,M$d._next()}M$c._class=M$b.clas,1<=M$b.priority?(M$c.priority=M$b.priority,M$c.realTime=!1):(M$c.priority=0,M$c.realTime=!0),M$c.load(M$b.url,M$b.type,M$b.cache,M$b.group,M$b.ignoreCache)},M$b._endLoad=function(M$a,M$b){var M$c=M$a.url;if(null==M$b){var M$d=this._failRes[M$c]||0;if(M$d<this.retryNum)return console.warn("[warn]Retry to load:",M$c),this._failRes[M$c]=M$d+1,void M$x.timer.once(this.retryDelay,this,this._addReTry,[M$a],!1);console.warn("[error]Failed to load:",M$c),this.event("error",M$c)}this._failRes[M$c]&&(this._failRes[M$c]=0),delete M$n._resMap[M$c],M$a.event("complete",M$b),M$a.offAll(),this._infoPool.push(M$a)},M$b._addReTry=function(M$a){this._resInfos[this._maxPriority-1].push(M$a),this._next()},M$b.clearRes=function(M$a,M$b){void 0===M$b&&(M$b=!1),M$ha.clearRes(M$a,M$b)},M$b.getRes=function(M$a){return M$ha.getRes(M$a)},M$b.cacheRes=function(M$a,M$b){M$ha.cacheRes(M$a,M$b)},M$b.clearTextureRes=function(M$a){M$ha.clearTextureRes(M$a)},M$b.setGroup=function(M$a,M$b){M$ha.setGroup(M$a,M$b)},M$b.clearResByGroup=function(M$a){M$ha.clearResByGroup(M$a)},M$b.clearUnLoaded=function(){for(var M$a=0;M$a<this._maxPriority;M$a++){for(var M$b=this._resInfos[M$a],M$c=M$b.length-1;-1<M$c;M$c--){var M$d=M$b[M$c];M$d&&(M$d.offAll(),this._infoPool.push(M$d))}M$b.length=0}this._loaderCount=0,M$n._resMap={}},M$b.cancelLoadByUrls=function(M$a){if(M$a)for(var M$b=0,M$c=M$a.length;M$b<M$c;M$b++)this.cancelLoadByUrl(M$a[M$b])},M$b.cancelLoadByUrl=function(M$a){for(var M$b=0;M$b<this._maxPriority;M$b++)for(var M$c=this._resInfos[M$b],M$d=M$c.length-1;-1<M$d;M$d--){var M$e=M$c[M$d];M$e&&M$e.url===M$a&&(M$c[M$d]=null,M$e.offAll(),this._infoPool.push(M$e))}M$n._resMap[M$a]&&delete M$n._resMap[M$a]},M$b._loadAssets=function(M$a,M$c,M$g,M$b,M$d,M$e,M$f){null==M$d&&(M$d=2),null==M$e&&(M$e=!0);for(var M$h=M$a.length,M$i=0,M$j=0,M$k=[],M$l=!0,M$m=0;M$m<M$h;M$m++){var M$n=M$a[M$m];if(!M$n)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+M$a);"string"==typeof M$n&&(M$n={url:M$n,type:M$b,size:1,priority:M$d}),M$n.size||(M$n.size=1),M$n.progress=0,M$j+=M$n.size,M$k.push(M$n);var M$o=M$g?M$s.create(null,M$r,[M$n],!1):null,M$p=M$c||M$g?M$s.create(null,M$q,[M$n]):null;this.load(M$n.url,M$p,M$o,M$n.type,null!=M$n.priority&&0<=M$n.priority?M$n.priority:2,M$e,M$n.group||M$f)}function M$q(M$a,M$b){M$i++,M$a.progress=1,M$b||(M$l=!1),M$i===M$h&&M$c&&M$c.runWith(M$l)}function M$r(M$a,M$b){if(null!=M$g){M$a.progress=M$b;for(var M$c=0,M$d=0;M$d<M$k.length;M$d++){var M$e=M$k[M$d];M$c+=M$e.size*M$e.progress}var M$f=M$c/M$j;M$g.runWith(M$f)}}return this},M$n.cacheRes=function(M$a,M$b){M$ha.cacheRes(M$a,M$b)},M$n._resMap={},M$i(M$n,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),M$n.__init$=function(){M$m=function(M$a){function M$b(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,M$b.__super.call(this)}return M$k(M$b,"",M$j),M$b}()},M$n}(),M$ja=(function(M$a){function M$e(M$a){M$e.__super.call(this),M$a||(M$a=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var M$b=0,M$c=0,M$d=0;M$d<20;M$d++)M$d%5!=4?this._mat[M$b++]=M$a[M$d]:this._alpha[M$c++]=M$a[M$d];this._action=M$F.createFilterAction(32),this._action.data=this}M$k(M$e,"laya.filters.ColorFilter",M$r);var M$b=M$e.prototype;M$x.imps(M$b,{"laya.filters.IFilter":!0}),M$b.callNative=function(M$a){M$a._$P.cf=this;M$a.conchModel&&M$a.conchModel.setFilterMatrix&&M$a.conchModel.setFilterMatrix(this._mat,this._alpha)},M$o(0,M$b,"type",function(){return 32}),M$o(0,M$b,"action",function(){return this._action})}(),function(M$a){function M$d(M$a,M$b,M$c){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===M$b&&(M$b=0),M$d.__super.call(this),this._byteClass=M$c||M$P,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,M$a&&0<M$b&&M$b<65535&&this.connect(M$a,M$b)}M$k(M$d,"laya.net.Socket",M$j);var M$b=M$d.prototype;M$b.connect=function(M$a,M$b){var M$c="ws://"+M$a+":"+M$b;M$c="https:"==M$O.window.location.protocol?"wss://"+M$a+":"+M$b:"ws://"+M$a+":"+M$b,this.connectByUrl(M$c)},M$b.connectByUrl=function(M$a){var M$b=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new M$O.window.WebSocket(M$a,this.protocols):this._socket=new M$O.window.WebSocket(M$a),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(M$a){M$b._onOpen(M$a)},this._socket.onmessage=function(M$a){M$b._onMessage(M$a)},this._socket.onclose=function(M$a){M$b._onClose(M$a)},this._socket.onerror=function(M$a){M$b._onError(M$a)}},M$b.cleanSocket=function(){try{this._socket.close()}catch(M$a){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},M$b.close=function(){if(null!=this._socket)try{this._socket.close()}catch(M$a){}},M$b._onOpen=function(M$a){this._connected=!0,this.event("open",M$a)},M$b._onMessage=function(M$a){if(M$a&&M$a.data){var M$b=M$a.data;if(this.disableInput&&M$b)this.event("message",M$b);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var M$c=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,M$b&&("string"==typeof M$b?this._input.writeUTFBytes(M$b):this._input.writeArrayBuffer(M$b),this._addInputPosition=this._input.pos,this._input.pos=M$c),this.event("message",M$b)}}},M$b._onClose=function(M$a){this._connected=!1,this.event("close",M$a)},M$b._onError=function(M$a){this.event("error",M$a)},M$b.send=function(M$a){this._socket.send(M$a)},M$b.flush=function(){if(this._output&&0<this._output.length){var M$b;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(M$a){M$b=M$a}this._output.endian=this.endian,this._output.clear(),M$b&&this.event("error",M$b)}},M$o(0,M$b,"input",function(){return this._input}),M$o(0,M$b,"output",function(){return this._output}),M$o(0,M$b,"connected",function(){return this._connected}),M$o(0,M$b,"endian",function(){return this._endian},function(M$a){this._endian=M$a,null!=this._input&&(this._input.endian=M$a),null!=this._output&&(this._output.endian=M$a)}),M$d.LITTLE_ENDIAN="littleEndian",M$d.BIG_ENDIAN="bigEndian"}(),function(M$a){function M$h(){M$h.__super.call(this),this._$1__id=++M$h._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(M$h._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,M$N.currentResourceManager&&M$N.currentResourceManager.addResource(this)}M$k(M$h,"laya.resource.Resource",M$j);var M$b=M$h.prototype;return M$x.imps(M$b,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),M$b._setUrl=function(M$a){var M$b;this._url!==M$a&&(this._url&&((M$b=M$h._urlResourcesMap[this._url]).splice(M$b.indexOf(this),1),0===M$b.length&&delete M$h._urlResourcesMap[this._url]),M$a&&((M$b=M$h._urlResourcesMap[M$a])||(M$h._urlResourcesMap[M$a]=M$b=[]),M$b.push(this)),this._url=M$a)},M$b._getGroup=function(){return this._group},M$b._setGroup=function(M$a){var M$b;this._group!==M$a&&(this._group&&((M$b=M$h._groupResourcesMap[this._group]).splice(M$b.indexOf(this),1),0===M$b.length&&delete M$h._groupResourcesMap[this._group]),M$a&&((M$b=M$h._groupResourcesMap[M$a])||(M$h._groupResourcesMap[M$a]=M$b=[]),M$b.push(this)),this._group=M$a)},M$b._addReference=function(){this._referenceCount++},M$b._removeReference=function(){this._referenceCount--},M$b._clearReference=function(){this._referenceCount=0},M$b._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},M$b.recreateResource=function(){this.completeCreate()},M$b.disposeResource=function(){},M$b.activeResource=function(M$a){void 0===M$a&&(M$a=!1),this._lastUseFrameCount=M$X.loopCount,!this._destroyed&&this.__loaded&&(this._released||M$a)&&this.recreateResource()},M$b.releaseResource=function(M$a){return void 0===M$a&&(M$a=!0),!(!M$a&&this.lock)&&(!(this._released&&!M$a)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},M$b.onAsynLoaded=function(M$a,M$b,M$c){throw new Error("Resource: must override this function!")},M$b.destroy=function(){var M$a;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete M$h._idResourcesMap[this.id],this._url&&((M$a=M$h._urlResourcesMap[this._url])&&(M$a.splice(M$a.indexOf(this),1),0===M$a.length&&delete M$h._urlResourcesMap[this.url]),M$ha.clearRes(this._url),this.__loaded||M$F.cancelLoadByUrl(this._url)),this._group&&((M$a=M$h._groupResourcesMap[this._group]).splice(M$a.indexOf(this),1),0===M$a.length&&delete M$h._groupResourcesMap[this.url]))},M$b.completeCreate=function(){this._released=!1,this.event("recovered",this)},M$b.dispose=function(){this.destroy()},M$o(0,M$b,"memorySize",function(){return this._memorySize},function(M$a){var M$b=M$a-this._memorySize;this._memorySize=M$a,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,M$b),this.resourceManager&&this.resourceManager.addSize(M$b)}),M$o(0,M$b,"_loaded",null,function(M$a){this.__loaded=M$a}),M$o(0,M$b,"loaded",function(){return this.__loaded}),M$o(0,M$b,"id",function(){return this._$1__id}),M$o(0,M$b,"destroyed",function(){return this._destroyed}),M$o(0,M$b,"group",function(){return this._getGroup()},function(M$a){this._setGroup(M$a)}),M$o(0,M$b,"resourceManager",function(){return this._resourceManager}),M$o(0,M$b,"url",function(){return this._url}),M$o(0,M$b,"released",function(){return this._released}),M$o(0,M$b,"referenceCount",function(){return this._referenceCount}),M$h.getResourceByID=function(M$a){return M$h._idResourcesMap[M$a]},M$h.getResourceByURL=function(M$a,M$b){return void 0===M$b&&(M$b=0),null==M$h._urlResourcesMap[M$a]?null:M$h._urlResourcesMap[M$a][M$b]},M$h.getResourceCountByURL=function(M$a){return M$h._urlResourcesMap[M$a].length},M$h.destroyUnusedResources=function(M$a){var M$b;if(M$a){var M$c=M$h._groupResourcesMap[M$a];if(M$c)for(var M$d=M$c.slice(),M$e=0,M$f=M$d.length;M$e<M$f;M$e++)(M$b=M$d[M$e]).lock||0!==M$b._referenceCount||M$b.destroy()}else for(var M$g in M$h._idResourcesMap)(M$b=M$h._idResourcesMap[M$g]).lock||0!==M$b._referenceCount||M$b.destroy()},M$h._uniqueIDCounter=0,M$h._idResourcesMap={},M$h._urlResourcesMap={},M$h._groupResourcesMap={},M$h}()),M$ka=function(M$a){function M$C(M$a,M$b){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,M$C.__super.call(this),M$a&&null!=M$a._addReference&&M$a._addReference(),this.setTo(M$a,M$b)}M$k(M$C,"laya.resource.Texture",M$j);var M$b=M$C.prototype;return M$b._setUrl=function(M$a){this.url=M$a},M$b.setTo=function(M$a,M$b){if(M$a instanceof M$g.HTMLElement){var M$c=M$ta.create("2D",M$a);this.bitmap=M$c}else this.bitmap=M$a;if(this.uv=M$b||M$C.DEF_UV,M$a){this._w=M$a.width,this._h=M$a.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var M$d=this;if(this._loaded)M$F.addToAtlas&&M$F.addToAtlas(M$d);else{var M$e=M$a;M$e instanceof laya.resource.HTMLImage&&M$e.image&&M$e.image.addEventListener("load",function(M$a){M$F.addToAtlas&&M$F.addToAtlas(M$d)},!1)}}},M$b.active=function(){this.bitmap&&this.bitmap.activeResource()},M$b.destroy=function(M$a){if(void 0===M$a&&(M$a=!1),this.alphaTexture&&(this.alphaTexture.destroy(M$a),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var M$b=this.bitmap;M$a?(M$J.isConchApp&&M$b.source&&M$b.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,M$b.dispose(),M$b._clearReference()):(M$b._removeReference(),0==M$b.referenceCount&&(M$J.isConchApp&&M$b.source&&M$b.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,M$b.dispose())),this.url&&this===M$x.loader.getRes(this.url)&&M$x.loader.clearRes(this.url,M$a),this._loaded=!1}},M$b.load=function(M$a){var M$b=this;this._loaded=!1,M$a=M$I.customFormat(M$a);var M$c=this.bitmap||(this.bitmap=M$wa.create(M$a));M$c.uri=M$a,M$c&&M$c._addReference();var M$d=this;M$c.onload=function(){M$c.onload=null,M$d._loaded=!0,M$b.sourceWidth=M$b._w=M$c.width,M$b.sourceHeight=M$b._h=M$c.height,M$d.event("loaded",this),M$F.addToAtlas&&M$F.addToAtlas(M$d)}},M$b.addTextureToAtlas=function(M$a){M$F.addTextureToAtlas(this)},M$b.getPixels=function(M$a,M$b,M$c,M$d){if(M$J.isConchApp){var M$e=this.bitmap;if(M$e.source&&M$e.source.getImageData){var M$f=M$e.source.getImageData(M$a,M$b,M$c,M$d),M$g=new Uint8Array(M$f);return Array.from(M$g)}return null}return M$J.isWebGL?M$F.getTexturePixels(this,M$a,M$b,M$c,M$d):(M$O.canvas.size(M$c,M$d),M$O.canvas.clear(),M$O.context.drawTexture(this,-M$a,-M$b,this.width,this.height,0,0),M$O.context.getImageData(0,0,M$c,M$d).data)},M$b.onAsynLoaded=function(M$a,M$b){if(M$b){if("function"!=typeof M$b._addReference)throw new Error("bitmap._addReference is not a function. "+M$b.className+" "+typeof M$b._addReference+" "+M$b.constructor);M$b._addReference()}this.setTo(M$b,this.uv),this._loaded&&this.event("loaded",this)},M$o(0,M$b,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),M$o(0,M$b,"loaded",function(){return this._loaded}),M$o(0,M$b,"released",function(){return!this.bitmap||this.bitmap.released}),M$o(0,M$b,"width",function(){return this._w?this._w:this.uv&&this.uv!==M$C.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(M$a){this._w=M$a,this.sourceWidth||(this.sourceWidth=M$a)}),M$o(0,M$b,"repeat",function(){return!M$J.isWebGL||!this.bitmap||this.bitmap.repeat},function(M$a){M$a&&M$J.isWebGL&&this.bitmap&&(this.bitmap.repeat=M$a)&&(this.bitmap.enableMerageInAtlas=!1)}),M$o(0,M$b,"height",function(){return this._h?this._h:this.uv&&this.uv!==M$C.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(M$a){this._h=M$a,this.sourceHeight||(this.sourceHeight=M$a)}),M$o(0,M$b,"isLinearSampling",function(){return!M$J.isWebGL||9728!=this.bitmap.minFifter},function(M$a){!M$a&&M$J.isWebGL&&(M$a||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),M$C.moveUV=function(M$a,M$b,M$c){for(var M$d=0;M$d<8;M$d+=2)M$c[M$d]+=M$a,M$c[M$d+1]+=M$b;return M$c},M$C.create=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){void 0===M$f&&(M$f=0),void 0===M$g&&(M$g=0),void 0===M$h&&(M$h=0),void 0===M$i&&(M$i=0);var M$j=M$a instanceof laya.resource.Texture,M$k=M$j?M$a.uv:M$C.DEF_UV,M$l=M$j?M$a.bitmap:M$a,M$m=M$F.isAtlas(M$l);if(M$m){var M$n=M$l._atlaser,M$o=M$a._atlasID;if(-1==M$o)throw new Error("create texture error");M$l=M$n._inAtlasTextureBitmapValue[M$o],M$k=M$n._inAtlasTextureOriUVValue[M$o]}var M$p=new M$C(M$l,null);M$l.width&&M$b+M$d>M$l.width&&(M$d=M$l.width-M$b),M$l.height&&M$c+M$e>M$l.height&&(M$e=M$l.height-M$c),M$p.width=M$d,M$p.height=M$e,M$p.offsetX=M$f,M$p.offsetY=M$g,M$p.sourceWidth=M$h||M$d,M$p.sourceHeight=M$i||M$e;var M$q=1/M$l.width,M$r=1/M$l.height;M$b*=M$q,M$c*=M$r,M$d*=M$q,M$e*=M$r;var M$s=M$p.uv[0],M$t=M$p.uv[1],M$u=M$p.uv[4],M$v=M$p.uv[5],M$w=M$u-M$s,M$x=M$v-M$t,M$A=M$C.moveUV(M$k[0],M$k[1],[M$b,M$c,M$b+M$d,M$c,M$b+M$d,M$c+M$e,M$b,M$c+M$e]);M$p.uv=[M$s+M$A[0]*M$w,M$t+M$A[1]*M$x,M$u-(1-M$A[2])*M$w,M$t+M$A[3]*M$x,M$u-(1-M$A[4])*M$w,M$v-(1-M$A[5])*M$x,M$s+M$A[6]*M$w,M$v-(1-M$A[7])*M$x],M$m&&M$p.addTextureToAtlas();var M$B=M$l.scaleRate;return M$B&&1!=M$B?(M$p.sourceWidth/=M$B,M$p.sourceHeight/=M$B,M$p.width/=M$B,M$p.height/=M$B,M$p.scaleRate=M$B,M$p.offsetX/=M$B,M$p.offsetY/=M$B):M$p.scaleRate=1,M$p},M$C.createFromTexture=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$a.scaleRate;1!=M$f&&(M$b*=M$f,M$c*=M$f,M$d*=M$f,M$e*=M$f);var M$g=M$B.TEMP.setTo(M$b-M$a.offsetX,M$c-M$a.offsetY,M$d,M$e),M$h=M$g.intersection(M$C._rect1.setTo(0,0,M$a.width,M$a.height),M$C._rect2);if(!M$h)return null;var M$i=M$C.create(M$a,M$h.x,M$h.y,M$h.width,M$h.height,M$h.x-M$g.x,M$h.y-M$g.y,M$d,M$e);if(M$i.bitmap&&M$i.bitmap._removeReference)return M$i.bitmap._removeReference(),M$i;var M$j="bitmap:"+(M$i.bitmap?M$i.bitmap.constructor?M$i.bitmap.constructor.name:M$i.bitmap.__className:"")+", url:"+(M$a.url+" | "+(M$i.bitmap?M$i.bitmap.url:M$a.url))+", x="+M$b+",y="+M$c+",width="+M$d+",height="+M$e+", result="+(M$h?M$h.x+","+M$h.y+","+M$h.width+","+M$h.height:"null")+", rect="+M$g.x+","+M$g.y+","+M$g.width+","+M$g.height;throw new Error("报错：bitmap._removeReference is not a function  "+M$j)},M$C.DEF_UV=[0,0,1,0,1,1,0,1],M$C.INV_UV=[0,1,1,1,1,0,0,0],M$C._rect1=new M$B,M$C._rect2=new M$B,M$C}(),M$a=function(M$a){var M$h;function M$f(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,M$f.__super.call(this)}M$k(M$f,"laya.utils.TimeLine",M$j);var M$b=M$f.prototype;return M$b.to=function(M$a,M$b,M$c,M$d,M$e){return void 0===M$e&&(M$e=0),this._create(M$a,M$b,M$c,M$d,M$e,!0)},M$b.from=function(M$a,M$b,M$c,M$d,M$e){return void 0===M$e&&(M$e=0),this._create(M$a,M$b,M$c,M$d,M$e,!1)},M$b._create=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=M$W.getItemByClass("tweenData",M$h);return M$g.isTo=M$f,M$g.type=0,M$g.target=M$a,M$g.duration=M$c,M$g.data=M$b,M$g.startTime=this._startTime+M$e,M$g.endTime=M$g.startTime+M$g.duration,M$g.ease=M$d,this._startTime=Math.max(M$g.endTime,this._startTime),this._tweenDataList.push(M$g),this._startTimeSort=!0,this._endTimeSort=!0,this},M$b.addLabel=function(M$a,M$b){var M$c=M$W.getItemByClass("tweenData",M$h);return M$c.type=1,M$c.data=M$a,M$c.endTime=M$c.startTime=this._startTime+M$b,this._labelDic||(this._labelDic={}),this._labelDic[M$a]=M$c,this._tweenDataList.push(M$c),this},M$b.removeLabel=function(M$a){if(this._labelDic&&this._labelDic[M$a]){var M$b=this._labelDic[M$a];if(M$b){var M$c=this._tweenDataList.indexOf(M$b);-1<M$c&&this._tweenDataList.splice(M$c,1)}delete this._labelDic[M$a]}},M$b.gotoTime=function(M$a){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var M$b,M$c,M$d,M$e;for(var M$f in this._firstTweenDic)if(M$c=this._firstTweenDic[M$f])for(var M$g in M$c)M$c.diyTarget.hasOwnProperty(M$g)&&(M$c.diyTarget[M$g]=M$c[M$g]);for(M$f in this._tweenDic)(M$b=this._tweenDic[M$f]).clear(),delete this._tweenDic[M$f];if(this._index=0,this._gidIndex=0,this._currTime=M$a,this._lastTime=M$O.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=M$d=this._tweenDataList.concat(),M$d.sort(function(M$a,M$b){return M$a.endTime>M$b.endTime?1:M$a.endTime<M$b.endTime?-1:0})}else M$d=this._endTweenDataList;for(var M$h=0,M$i=M$d.length;M$h<M$i;M$h++)if(0==(M$e=M$d[M$h]).type){if(!(M$a>=M$e.endTime))break;this._index=Math.max(this._index,M$h+1);var M$j=M$e.data;if(M$e.isTo)for(var M$k in M$j)M$e.target[M$k]=M$j[M$k]}for(M$h=0,M$i=this._tweenDataList.length;M$h<M$i;M$h++)0==(M$e=this._tweenDataList[M$h]).type&&M$a>=M$e.startTime&&M$a<M$e.endTime&&(this._index=Math.max(this._index,M$h+1),this._gidIndex++,(M$b=M$W.getItemByClass("tween",M$Z))._create(M$e.target,M$e.data,M$e.duration,M$e.ease,M$s.create(this,this._animComplete,[this._gidIndex]),0,!1,M$e.isTo,!0,!1),M$b.setStartTime(this._currTime-(M$a-M$e.startTime)),M$b._updateEase(this._currTime),M$b.gid=this._gidIndex,this._tweenDic[this._gidIndex]=M$b)}},M$b.gotoLabel=function(M$a){if(null!=this._labelDic){var M$b=this._labelDic[M$a];M$b&&this.gotoTime(M$b.startTime)}},M$b.pause=function(){M$x.timer.clear(this,this._update)},M$b.resume=function(){this.play(this._currTime,this._loopKey)},M$b.play=function(M$a,M$b){if(void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(M$a,M$b){return M$a.startTime>M$b.startTime?1:M$a.startTime<M$b.startTime?-1:0});for(var M$c=0,M$d=this._tweenDataList.length;M$c<M$d;M$c++){var M$e=this._tweenDataList[M$c];if(null!=M$e&&0==M$e.type){var M$f=M$e.target,M$g=M$f.$_GID||(M$f.$_GID=M$$.getGID()),M$h=null;for(var M$i in null==this._firstTweenDic[M$g]?((M$h={}).diyTarget=M$f,this._firstTweenDic[M$g]=M$h):M$h=this._firstTweenDic[M$g],M$e.data)null==M$h[M$i]&&(M$h[M$i]=M$f[M$i])}}}"string"==typeof M$a?this.gotoLabel(M$a):this.gotoTime(M$a),this._loopKey=M$b,this._lastTime=M$O.now(),M$x.timer.frameLoop(1,this,this._update)}},M$b._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var M$a in this._tweenDic)(M$b=this._tweenDic[M$a]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var M$b,M$c=M$O.now(),M$d=M$c-this._lastTime,M$e=this._currTime+=M$d*this.scale;for(M$a in this._lastTime=M$c,this._tweenDic)(M$b=this._tweenDic[M$a])._updateEase(M$e);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var M$f=this._tweenDataList[this._index];M$e>=M$f.startTime&&(this._index++,0==M$f.type?(this._gidIndex++,(M$b=M$W.getItemByClass("tween",M$Z))._create(M$f.target,M$f.data,M$f.duration,M$f.ease,M$s.create(this,this._animComplete,[this._gidIndex]),0,!1,M$f.isTo,!0,!1),M$b.setStartTime(M$e),M$b.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=M$b)._updateEase(M$e)):this.event("label",M$f.data))}},M$b._animComplete=function(M$a){this._tweenDic[M$a]&&delete this._tweenDic[M$a]},M$b._complete=function(){this.event("complete")},M$b.reset=function(){var M$a;if(this._labelDic)for(M$a in this._labelDic)delete this._labelDic[M$a];for(M$a in this._tweenDic)this._tweenDic[M$a].clear(),delete this._tweenDic[M$a];for(M$a in this._firstTweenDic)delete this._firstTweenDic[M$a];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var M$b,M$c=0;for(M$b=this._tweenDataList.length,M$c=0;M$c<M$b;M$c++)this._tweenDataList[M$c]&&this._tweenDataList[M$c].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,M$x.timer.clear(this,this._update)},M$b.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},M$o(0,M$b,"index",function(){return this._frameIndex},function(M$a){this._frameIndex=M$a,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),M$o(0,M$b,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),M$f.to=function(M$a,M$b,M$c,M$d,M$e){return void 0===M$e&&(M$e=0),(new M$f).to(M$a,M$b,M$c,M$d,M$e)},M$f.from=function(M$a,M$b,M$c,M$d,M$e){return void 0===M$e&&(M$e=0),(new M$f).from(M$a,M$b,M$c,M$d,M$e)},M$f.__init$=function(){M$h=function(){function M$a(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return M$k(M$a,""),M$a.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,M$W.recover("tweenData",this)},M$a}()},M$f}(),M$la=function(M$e){function M$c(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,M$c.__super.call(this),this._style=M$h.EMPTY}M$k(M$c,"laya.display.Sprite",M$e);var M$a=M$c.prototype;return M$x.imps(M$a,{"laya.display.ILayout":!0}),M$a.createConchModel=function(){return new ConchNode},M$a.destroy=function(M$a){if(void 0===M$a&&(M$a=!0),this._releaseMem(),!this._destroyed){this.filters=null;var M$b=this.mask;M$b&&(this.mask=null,M$b.destroy(M$a))}M$e.prototype.destroy.call(this,M$a),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},M$a.updateZOrder=function(){M$$.updateOrder(this._childs)&&this.repaint()},M$a.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},M$a.setBounds=function(M$a){this._set$P("uBounds",M$a)},M$a.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new M$B),M$B._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},M$a.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new M$B),M$B._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},M$a._boundPointsToParent=function(M$a){void 0===M$a&&(M$a=!1);var M$b=0,M$c=0;this._style&&(M$b=this._style._tf.translateX,M$c=this._style._tf.translateY,M$a=M$a||0!==this._style._tf.rotate,this._style.scrollRect&&(M$b+=this._style.scrollRect.x,M$c+=this._style.scrollRect.y));var M$d=this._getBoundPointsM(M$a);if(!M$d||M$d.length<1)return M$d;if(8!=M$d.length&&(M$d=M$a?M$v.scanPList(M$d):M$B._getWrapRec(M$d,M$B.TEMP)._getBoundPoints()),!this.transform)return M$$.transPointList(M$d,this._x-M$b,this._y-M$c),M$d;var M$e=M$A.TEMP,M$f=0,M$g=M$d.length;for(M$f=0;M$f<M$g;M$f+=2)M$e.x=M$d[M$f],M$e.y=M$d[M$f+1],this.toParentPoint(M$e),M$d[M$f]=M$e.x,M$d[M$f+1]=M$e.y;return M$d},M$a.getGraphicBounds=function(M$a){return void 0===M$a&&(M$a=!1),this._graphics?this._graphics.getBounds(M$a):M$B.TEMP.setTo(0,0,0,0)},M$a._getBoundPointsM=function(M$a){if(void 0===M$a&&(M$a=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var M$b=M$$.clearArray(this._$P.temBM),M$c=M$B.TEMP;return M$c.copyFrom(this.scrollRect),M$$.concatArray(M$b,M$c._getBoundPoints()),M$b}for(var M$d,M$e,M$f,M$g=this._graphics?this._graphics.getBoundPoints():M$$.clearArray(this._$P.temBM),M$h=0,M$i=(M$f=this._childs).length;M$h<M$i;M$h++)(M$d=M$f[M$h])instanceof laya.display.Sprite&&1==M$d.visible&&(M$e=M$d._boundPointsToParent(M$a))&&(M$g=M$g?M$$.concatArray(M$g,M$e):M$e);return M$g},M$a.getStyle=function(){return this._style===M$h.EMPTY&&(this._style=new M$h),this._style},M$a.setStyle=function(M$a){this._style=M$a},M$a._adjustTransform=function(){this._tfChanged=!1;var M$a,M$b=this._style._tf,M$c=M$b.scaleX,M$d=M$b.scaleY;if(M$b.rotate||1!==M$c||1!==M$d||M$b.skewX||M$b.skewY){(M$a=this._transform||(this._transform=M$G.create())).bTransform=!0;var M$e=.0174532922222222*(M$b.rotate-M$b.skewX),M$f=.0174532922222222*(M$b.rotate+M$b.skewY),M$g=Math.cos(M$f),M$h=Math.sin(M$f),M$i=Math.sin(M$e),M$j=Math.cos(M$e);return M$a.a=M$c*M$g,M$a.b=M$c*M$h,M$a.c=-M$d*M$i,M$a.d=M$d*M$j,M$a.tx=M$a.ty=0,M$a}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,M$a},M$a.pos=function(M$a,M$b,M$c){if(void 0===M$c&&(M$c=!1),this._x!==M$a||this._y!==M$b){if(this.destroyed)return this;if(M$c){this._x=M$a,this._y=M$b,this.conchModel&&this.conchModel.pos(this._x,this._y);var M$d=this._parent;M$d&&0===M$d._repaint&&(M$d._repaint=1,M$d.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=M$a,this.y=M$b}return this},M$a.pivot=function(M$a,M$b){return this.pivotX=M$a,this.pivotY=M$b,this},M$a.size=function(M$a,M$b){return this.width=M$a,this.height=M$b,this},M$a.scale=function(M$a,M$b,M$c){void 0===M$c&&(M$c=!1);var M$d=this.getStyle(),M$e=M$d._tf;if(M$e.scaleX!=M$a||M$e.scaleY!=M$b){if(this.destroyed)return this;if(M$c){M$d.setScale(M$a,M$b),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(M$a,M$b),this._renderType|=4;var M$f=this._parent;M$f&&0===M$f._repaint&&(M$f._repaint=1,M$f.parentRepaint())}else this.scaleX=M$a,this.scaleY=M$b}return this},M$a.skew=function(M$a,M$b){return this.skewX=M$a,this.skewY=M$b,this},M$a.render=function(M$a,M$b,M$c){M$X.spriteCount++,M$L.renders[this._renderType]._fun(this,M$a,M$b+this._x,M$c+this._y),this._repaint=0},M$a.drawToCanvas=function(M$a,M$b,M$c,M$d){if(M$J.isConchNode){var M$e=M$ta.create("2D");return new M$K(M$a,M$b,M$e).ctx.setCanvasType(1),this.conchModel.drawToCanvas(M$e.source,M$c,M$d),M$e}return M$F.drawToCanvas(this,this._renderType,M$a,M$b,M$c,M$d)},M$a.customRender=function(M$a,M$b,M$c){this._renderType|=1024},M$a._applyFilters=function(){var M$a;if(!M$J.isWebGL&&((M$a=this._$P.filters)&&!(M$a.length<1)))for(var M$b=0,M$c=M$a.length;M$b<M$c;M$b++)M$a[M$b].action.apply(this._$P.cacheCanvas)},M$a._isHaveGlowFilter=function(){var M$a,M$b=0;if(this.filters)for(M$b=0;M$b<this.filters.length;M$b++)if(8==this.filters[M$b].type)return!0;for(M$b=0,M$a=this._childs.length;M$b<M$a;M$b++)if(this._childs[M$b]._isHaveGlowFilter())return!0;return!1},M$a.localToGlobal=function(M$a,M$b){void 0===M$b&&(M$b=!1),!0===M$b&&(M$a=new M$A(M$a.x,M$a.y));for(var M$c=this;M$c&&M$c!=M$x.stage;)M$a=M$c.toParentPoint(M$a),M$c=M$c.parent;return M$a},M$a.globalToLocal=function(M$a,M$b){void 0===M$b&&(M$b=!1),M$b&&(M$a=new M$A(M$a.x,M$a.y));for(var M$c=this,M$d=[];M$c&&M$c!=M$x.stage;)M$d.push(M$c),M$c=M$c.parent;for(var M$e=M$d.length-1;0<=M$e;)M$a=(M$c=M$d[M$e]).fromParentPoint(M$a),M$e--;return M$a},M$a.toParentPoint=function(M$a){if(!M$a)return M$a;M$a.x-=this.pivotX,M$a.y-=this.pivotY,this.transform&&this._transform.transformPoint(M$a),M$a.x+=this._x,M$a.y+=this._y;var M$b=this._style.scrollRect;return M$b&&(M$a.x-=M$b.x,M$a.y-=M$b.y),M$a},M$a.fromParentPoint=function(M$a){if(!M$a)return M$a;M$a.x-=this._x,M$a.y-=this._y;var M$b=this._style.scrollRect;return M$b&&(M$a.x+=M$b.x,M$a.y+=M$b.y),this.transform&&this._transform.invertTransformPoint(M$a),M$a.x+=this.pivotX,M$a.y+=this.pivotY,M$a},M$a.on=function(M$a,M$b,M$c,M$d){return 1!==this._mouseEnableState&&this.isMouseEvent(M$a)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(M$a,M$b,M$c,M$d,!1)):M$e.prototype.on.call(this,M$a,M$b,M$c,M$d)},M$a.once=function(M$a,M$b,M$c,M$d){return 1!==this._mouseEnableState&&this.isMouseEvent(M$a)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(M$a,M$b,M$c,M$d,!0)):M$e.prototype.once.call(this,M$a,M$b,M$c,M$d)},M$a._$2__onDisplay=function(){if(1!==this._mouseEnableState){var M$a=this;for(M$a=M$a.parent;M$a&&1!==M$a._mouseEnableState&&!M$a._getBit(2);)M$a.mouseEnabled=!0,M$a._setBit(2,!0),M$a=M$a.parent}},M$a.loadImage=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=this;return void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=0),void 0===M$e&&(M$e=0),this.graphics.loadImage(M$a,M$b,M$c,M$d,M$e,function(M$a){M$g.destroyed||(M$g.size(M$b+(M$d||M$a.width),M$c+(M$e||M$a.height)),M$g.repaint(),M$f&&M$f.runWith(M$a))}),this},M$a.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},M$a._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},M$a._childChanged=function(M$a){this._childs.length?this._renderType|=2048:this._renderType&=-2049,M$a&&this._get$P("hasZorder")&&M$x.timer.callLater(this,this.updateZOrder),this.repaint()},M$a.parentRepaint=function(){var M$a=this._parent;M$a&&0===M$a._repaint&&(M$a._repaint=1,M$a.parentRepaint())},M$a.startDrag=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){void 0===M$b&&(M$b=!1),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=300),void 0===M$f&&(M$f=!1),void 0===M$g&&(M$g=.92),this._$P.dragging||this._set$P("dragging",new M$T),this._$P.dragging.start(this,M$a,M$b,M$c,M$d,M$e,M$f,M$g)},M$a.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},M$a._releaseMem=function(){if(this._$P){var M$a=this._$P.cacheCanvas;M$a&&M$a.ctx&&(M$W.recover("RenderContext",M$a.ctx),M$a.ctx.canvas.size(0,0),M$a.ctx=null);var M$b=this._$P._filterCache;M$b&&(M$b.destroy(),M$b.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},M$a._setDisplay=function(M$a){M$a||this._releaseMem(),M$e.prototype._setDisplay.call(this,M$a)},M$a.hitTestPoint=function(M$a,M$b){var M$c=this.globalToLocal(M$A.TEMP.setTo(M$a,M$b));return M$a=M$c.x,M$b=M$c.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?M$B.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(M$a,M$b)},M$a.getMousePoint=function(){return this.globalToLocal(M$A.TEMP.setTo(M$x.stage.mouseX,M$x.stage.mouseY))},M$a._getWords=function(){return null},M$a._addChildsToLayout=function(M$a){var M$b=this._getWords();if(null==M$b&&0==this._childs.length)return!1;if(M$b)for(var M$c=0,M$d=M$b.length;M$c<M$d;M$c++)M$a.push(M$b[M$c]);M$c=0;for(var M$e=this._childs.length;M$c<M$e;++M$c){var M$f=this._childs[M$c];M$f._style._enableLayout()&&M$f._addToLayout(M$a)}return!0},M$a._addToLayout=function(M$a){this._style.absolute||(this._style.block?M$a.push(this):this._addChildsToLayout(M$a)&&(this.x=this.y=0))},M$a._isChar=function(){return!1},M$a._getCSSStyle=function(){return this._style.getCSSStyle()},M$a._setAttributes=function(M$a,M$b){switch(M$a){case"x":this.x=parseFloat(M$b);break;case"y":this.y=parseFloat(M$b);break;case"width":this.width=parseFloat(M$b);break;case"height":this.height=parseFloat(M$b);break;default:this[M$a]=M$b}},M$a._layoutLater=function(){this.parent&&this.parent._layoutLater()},M$o(0,M$a,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(M$a){this._optimizeScrollRect!=M$a&&(this._optimizeScrollRect=M$a,this.conchModel&&this.conchModel.optimizeScrollRect(M$a))}),M$o(0,M$a,"customRenderEnable",null,function(M$a){if(M$a&&(this._renderType|=1024,M$J.isConchNode)){M$c.CustomList.push(this);var M$b=new M$ta("2d");M$b._setContext(new CanvasRenderingContext2D),this.customContext=new M$K(0,0,M$b),M$b.context.setCanvasType&&M$b.context.setCanvasType(2),this.conchModel.custom(M$b.context)}}),M$o(0,M$a,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(M$a){this.cacheAs=M$a?this._$P.hasFilter?"none":"normal":"none"}),M$o(0,M$a,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(M$a){var M$b=this._$P.cacheCanvas;if(M$a!==(M$b?M$b.type:"none")){if("none"!==M$a)this._getBit(1)||this._setUpNoticeType(1),M$b||(M$b=this._set$P("cacheCanvas",M$W.getItemByClass("cacheCanvas",Object))),M$b.type=M$a,M$b.reCache=!0,this._renderType|=16,"bitmap"==M$a&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(M$b){var M$c=M$b;M$c&&M$c.ctx&&(M$W.recover("RenderContext",M$c.ctx),M$c.ctx.canvas.size(0,0),M$c.ctx=null),M$W.recover("cacheCanvas",M$b)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),M$o(0,M$a,"zOrder",function(){return this._zOrder},function(M$a){this._zOrder!=M$a&&(this._zOrder=M$a,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(M$a),this._parent&&(M$a&&this._parent._set$P("hasZorder",!0),M$x.timer.callLater(this._parent,this.updateZOrder)))}),M$o(0,M$a,"rotation",function(){return this._style._tf.rotate},function(M$a){var M$b=this.getStyle();if(M$b._tf.rotate!==M$a){M$b.setRotate(M$a),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(M$a),this._renderType|=4;var M$c=this._parent;M$c&&0===M$c._repaint&&(M$c._repaint=1,M$c.parentRepaint())}}),M$o(0,M$a,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(M$a){this._width!==M$a&&(this._width=M$a,this.conchModel&&this.conchModel.size(M$a,this._height),this.repaint())}),M$o(0,M$a,"x",function(){return this._x},function(M$a){if(this._x!==M$a){if(this.destroyed)return;this._x=M$a,this.conchModel&&this.conchModel.pos(M$a,this._y);var M$b=this._parent;M$b&&0===M$b._repaint&&(M$b._repaint=1,M$b.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),M$o(0,M$a,"globalScaleY",function(){for(var M$a=1,M$b=this;M$b&&M$b!==M$x.stage;)M$a*=M$b.scaleY,M$b=M$b.parent;return M$a}),M$o(0,M$a,"hitArea",function(){return this._$P.hitArea},function(M$a){this._set$P("hitArea",M$a)}),M$o(0,M$a,"staticCache",function(){return this._$P.staticCache},function(M$a){this._set$P("staticCache",M$a),M$a||this.reCache()}),M$o(0,M$a,"texture",function(){return this._texture},function(M$a){this._texture!=M$a&&(this._texture=M$a,this.graphics.cleanByTexture(M$a,0,0))}),M$o(0,M$a,"y",function(){return this._y},function(M$a){if(this._y!==M$a){if(this.destroyed)return;this._y=M$a,this.conchModel&&this.conchModel.pos(this._x,M$a);var M$b=this._parent;M$b&&0===M$b._repaint&&(M$b._repaint=1,M$b.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),M$o(0,M$a,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(M$a){this._height!==M$a&&(this._height=M$a,this.conchModel&&this.conchModel.size(this._width,M$a),this.repaint())}),M$o(0,M$a,"blendMode",function(){return this._style.blendMode},function(M$a){this.getStyle().blendMode=M$a,this.conchModel&&this.conchModel.blendMode(M$a),M$a&&"source-over"!=M$a?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),M$o(0,M$a,"scaleX",function(){return this._style._tf.scaleX},function(M$a){var M$b=this.getStyle();if(M$b._tf.scaleX!==M$a){M$b.setScaleX(M$a),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(M$a,M$b._tf.scaleY),this._renderType|=4;var M$c=this._parent;M$c&&0===M$c._repaint&&(M$c._repaint=1,M$c.parentRepaint())}}),M$o(0,M$a,"scaleY",function(){return this._style._tf.scaleY},function(M$a){var M$b=this.getStyle();if(M$b._tf.scaleY!==M$a){M$b.setScaleY(M$a),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(M$b._tf.scaleX,M$a),this._renderType|=4;var M$c=this._parent;M$c&&0===M$c._repaint&&(M$c._repaint=1,M$c.parentRepaint())}}),M$o(0,M$a,"stage",function(){return M$x.stage}),M$o(0,M$a,"skewX",function(){return this._style._tf.skewX},function(M$a){var M$b=this.getStyle();if(M$b._tf.skewX!==M$a){M$b.setSkewX(M$a),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(M$a,M$b._tf.skewY),this._renderType|=4;var M$c=this._parent;M$c&&0===M$c._repaint&&(M$c._repaint=1,M$c.parentRepaint())}}),M$o(0,M$a,"scrollRect",function(){return this._style.scrollRect},function(M$a){this.getStyle().scrollRect=M$a,this.repaint(),M$a?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(M$a.x,M$a.y,M$a.width,M$a.height)):(this._renderType&=-129,this.conchModel&&(M$c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),M$o(0,M$a,"skewY",function(){return this._style._tf.skewY},function(M$a){var M$b=this.getStyle();if(M$b._tf.skewY!==M$a){M$b.setSkewY(M$a),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(M$b._tf.skewX,M$a),this._renderType|=4;var M$c=this._parent;M$c&&0===M$c._repaint&&(M$c._repaint=1,M$c.parentRepaint())}}),M$o(0,M$a,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(M$a){this._tfChanged=!1,(this._transform=M$a)&&(this._x=M$a.tx,this._y=M$a.ty,M$a.tx=M$a.ty=0,this.conchModel&&this.conchModel.transform(M$a.a,M$a.b,M$a.c,M$a.d,this._x,this._y)),M$a?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),M$o(0,M$a,"pivotX",function(){return this._style._tf.translateX},function(M$a){this.getStyle().setTranslateX(M$a),this.conchModel&&this.conchModel.pivot(M$a,this._style._tf.translateY),this.repaint()}),M$o(0,M$a,"pivotY",function(){return this._style._tf.translateY},function(M$a){this.getStyle().setTranslateY(M$a),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,M$a),this.repaint()}),M$o(0,M$a,"alpha",function(){return this._style.alpha},function(M$a){this._style&&this._style.alpha!==M$a&&(M$a=M$a<0?0:1<M$a?1:M$a,this.getStyle().alpha=M$a,this.conchModel&&this.conchModel.alpha(M$a),1!==M$a?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),M$o(0,M$a,"visible",function(){return this._style.visible},function(M$a){this._style&&this._style.visible!==M$a&&(this.getStyle().visible=M$a,this.conchModel&&this.conchModel.visible(M$a),this.parentRepaint())}),M$o(0,M$a,"graphics",function(){return this._graphics||(this.graphics=M$F.createGraphics())},function(M$a){this._graphics&&(this._graphics._sp=null),(this._graphics=M$a)?(this._renderType&=-2,this._renderType|=512,(M$a._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(M$c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),M$o(0,M$a,"filters",function(){return this._$P.filters},function(M$a){M$a&&0===M$a.length&&(M$a=null),this._$P.filters!=M$a&&(this._set$P("filters",M$a?M$a.slice():null),M$J.isConchApp&&(this.conchModel&&(M$c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),M$J.isWebGL&&(M$a&&M$a.length?this._renderType|=32:this._renderType&=-33),M$a&&0<M$a.length?(this._getBit(1)||this._setUpNoticeType(1),M$J.isWebGL&&1==M$a.length&&M$a[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(M$J.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),M$o(0,M$a,"parent",M$e.prototype._$get_parent,function(M$a){M$x.superSet(M$aa,this,"parent",M$a),M$a&&this._getBit(2)&&this._$2__onDisplay()}),M$o(0,M$a,"mask",function(){return this._$P._mask},function(M$a){M$a&&this.mask&&this.mask._$P.maskParent||(M$a?(this.cacheAs="bitmap",this._set$P("_mask",M$a),M$a._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",M$a),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(M$a?M$a.conchModel:null),this._renderType|=64,this.parentRepaint())}),M$o(0,M$a,"mouseEnabled",function(){return 1<this._mouseEnableState},function(M$a){this._mouseEnableState=M$a?2:1}),M$o(0,M$a,"globalScaleX",function(){for(var M$a=1,M$b=this;M$b&&M$b!==M$x.stage;)M$a*=M$b.scaleX,M$b=M$b.parent;return M$a}),M$o(0,M$a,"mouseX",function(){return this.getMousePoint().x}),M$o(0,M$a,"mouseY",function(){return this.getMousePoint().y}),M$c.fromImage=function(M$a){return(new M$c).loadImage(M$a)},M$c._cachePool=[],M$c.CustomList=[],M$i(M$c,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=M$g.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),M$c}(M$aa),M$ma=function(M$a){function M$b(M$a){this._audio=null,this._onEnd=null,this._resumePlay=null,M$b.__super.call(this),this._onEnd=M$$.bind(this.__onEnd,this),this._resumePlay=M$$.bind(this.__resumePlay,this),M$a.addEventListener("ended",this._onEnd),this._audio=M$a}M$k(M$b,"laya.media.h5audio.AudioSoundChannel",M$da);var M$c=M$b.prototype;return M$c.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(M$x.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},M$c.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,M$O.container.appendChild(this._audio),this._audio.play()}catch(M$a){this.event("error")}},M$c.play=function(M$a){this.isStopped=!1;try{this._audio.playbackRate=M$E.playbackRate,this._audio.currentTime=this.startTime}catch(M$a){return void this._audio.addEventListener("canplay",this._resumePlay)}M$E.addChannel(this),M$O.container.appendChild(this._audio),!M$a&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},M$c.stop=function(){this.isStopped=!0,M$E.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&M$J.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),M$O.onIE||this._audio!=M$ca._musicAudio&&M$W.recover("audio:"+this.url,this._audio),M$O.removeElement(this._audio),this._audio=null)},M$c.pause=function(){this.isStopped=!0,M$E.removeChannel(this),"pause"in this._audio&&this._audio.pause()},M$c.resume=function(){this._audio&&(this.isStopped=!1,M$E.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},M$o(0,M$c,"position",function(){return this._audio?this._audio.currentTime:0}),M$o(0,M$c,"duration",function(){return this._audio?this._audio.duration:0}),M$o(0,M$c,"volume",function(){return this._audio?this._audio.volume:1},function(M$a){this._audio&&(this._audio.volume=M$a)}),M$b}(),M$na=function(M$a){function M$b(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=M$fa.ctx,M$b.__super.call(this),this._onPlayEnd=M$$.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}M$k(M$b,"laya.media.webaudio.WebAudioSoundChannel",M$da);var M$c=M$b.prototype;return M$c.play=function(M$a){if(M$E.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var M$b=this.context,M$c=this.gain,M$d=M$b.createBufferSource();(this.bufferSource=M$d).buffer=this.audioBuffer,M$d.connect(M$c),M$c&&M$c.disconnect(),M$c.connect(M$b.destination),M$d.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=M$O.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(M$d.loop=!0),M$d.playbackRate.setTargetAtTime?M$d.playbackRate.setTargetAtTime(M$E.playbackRate,this.context.currentTime,.1):M$d.playbackRate.value=M$E.playbackRate,M$d.start(0,this.startTime),!M$a&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},M$c.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(M$x.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},M$c._clearBufferSource=function(){if(this.bufferSource){var M$a=this.bufferSource;M$a.stop?M$a.stop(0):M$a.noteOff(0),M$a.disconnect(0),M$a.onended=null,M$b._tryCleanFailed||this._tryClearBuffer(M$a),this.bufferSource=null}},M$c._tryClearBuffer=function(M$a){try{M$a.buffer=null}catch(M$a){M$b._tryCleanFailed=!0}},M$c.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,M$E.removeChannel(this),this.startHandler=null,this.completeHandler=null},M$c.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,M$E.removeChannel(this)},M$c.resume=function(){this.startTime=this._pauseTime,this.play(!1)},M$o(0,M$c,"position",function(){return this.bufferSource?(M$O.now()-this._startTime)/1e3+this.startTime:0}),M$o(0,M$c,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),M$o(0,M$c,"volume",function(){return this._volume},function(M$a){this.isStopped||(this._volume=M$a,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(M$a,this.context.currentTime,.1):this.gain.gain.value=M$a)}),M$b._tryCleanFailed=!1,M$b}(),M$oa=function(M$a){function M$b(){M$b.__super.call(this),this._w=0,this._h=0}M$k(M$b,"laya.resource.Bitmap",M$ja);var M$c=M$b.prototype;return M$o(0,M$c,"width",function(){return this._w}),M$o(0,M$c,"height",function(){return this._h}),M$o(0,M$c,"source",function(){return this._source}),M$b}(),M$pa=function(M$b){function M$a(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,M$a.__super.call(this),this._interval=M$d.animationInterval,this._setUpNoticeType(1)}M$k(M$a,"laya.display.AnimationPlayerBase",M$b);var M$c=M$a.prototype;return M$c.play=function(M$a,M$b,M$c,M$d){void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=!0),void 0===M$c&&(M$c=""),void 0===M$d&&(M$d=!0),this._isPlaying=!0,this.index="string"==typeof M$a?this._getFrameByLabel(M$a):M$a,this.loop=M$b,this._actionName=M$c,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},M$c._getFrameByLabel=function(M$a){var M$b=0;for(M$b=0;M$b<this._count;M$b++)if(this._labels[M$b]&&0<=this._labels[M$b].indexOf(M$a))return M$b;return 0},M$c._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},M$c._setControlNode=function(M$a){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=M$a)&&M$a!=this&&(M$a.on("display",this,this._checkResumePlaying),M$a.on("undisplay",this,this._checkResumePlaying))},M$c._setDisplay=function(M$a){M$b.prototype._setDisplay.call(this,M$a),this._checkResumePlaying()},M$c._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},M$c.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},M$c.addLabel=function(M$a,M$b){this._labels||(this._labels={}),this._labels[M$b]||(this._labels[M$b]=[]),this._labels[M$b].push(M$a)},M$c.removeLabel=function(M$a){if(M$a){if(this._labels)for(var M$b in this._labels)this._removeLabelFromLabelList(this._labels[M$b],M$a)}else this._labels=null},M$c._removeLabelFromLabelList=function(M$a,M$b){if(M$a)for(var M$c=M$a.length-1;0<=M$c;M$c--)M$a[M$c]==M$b&&M$a.splice(M$c,1)},M$c.gotoAndStop=function(M$a){this.index="string"==typeof M$a?this._getFrameByLabel(M$a):M$a,this.stop()},M$c._displayToIndex=function(M$a){},M$c.clear=function(){this.stop(),this._labels=null},M$o(0,M$c,"interval",function(){return this._interval},function(M$a){this._interval!=M$a&&(this._frameRateChanged=!0,this._interval=M$a,this._isPlaying&&0<M$a&&this.timerLoop(M$a,this,this._frameLoop,null,!0,!0))}),M$o(0,M$c,"isPlaying",function(){return this._isPlaying}),M$o(0,M$c,"index",function(){return this._index},function(M$a){if(this._index=M$a,this._displayToIndex(M$a),this._labels&&this._labels[M$a])for(var M$b=this._labels[M$a],M$c=0,M$d=M$b.length;M$c<M$d;M$c++)this.event("label",M$b[M$c])}),M$o(0,M$c,"count",function(){return this._count}),M$a.WRAP_POSITIVE=0,M$a.WRAP_REVERSE=1,M$a.WRAP_PINGPONG=2,M$a}(M$la),M$qa=function(M$b){function M$n(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,M$n.__super.call(this),this.overflow=M$n.VISIBLE,this._style=new M$ba(this),this._style.wordWrap=!1}M$k(M$n,"laya.display.Text",M$b);var M$a=M$n.prototype;return M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,M$a),this._lines=null,this._words&&(this._words.length=0,this._words=null)},M$a._getBoundPointsM=function(M$a){void 0===M$a&&(M$a=!1);var M$b=M$B.TEMP;return M$b.setTo(0,0,this.width,this.height),M$b._getBoundPoints()},M$a.getGraphicBounds=function(M$a){void 0===M$a&&(M$a=!1);var M$b=M$B.TEMP;return M$b.setTo(0,0,this.width,this.height),M$b},M$a._getCSSStyle=function(){return this._style},M$a.lang=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k){if(M$a=M$n.langPacks&&M$n.langPacks[M$a]?M$n.langPacks[M$a]:M$a,arguments.length<2)this._text=M$a;else{for(var M$l=0,M$m=arguments.length;M$l<M$m;M$l++)M$a=M$a.replace("{"+M$l+"}",arguments[M$l+1]);this._text=M$a}},M$a._isPassWordMode=function(){var M$a=this._style.password;return"prompt"in this&&this.prompt==this._text&&(M$a=!1),M$a},M$a._getPassWordTxt=function(M$a){var M$b;M$b="";for(var M$c=M$a.length;0<M$c;M$c--)M$b+="●";return M$b},M$a.renderText=function(M$a,M$b){var M$c=this.graphics;M$c.clear(!0);var M$d=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(M$O.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);M$O.context.font=M$d;var M$e=this.padding,M$f=M$e[3],M$g="left",M$h=this._lines,M$i=this.leading+this._charSize.height,M$j=this._currBitmapFont;M$j&&(M$i=this.leading+M$j.getMaxHeight());var M$k=M$e[0];if(!M$j&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(M$g="right",M$f=this._width-M$e[1]):"center"==this.align&&(M$g="center",M$f=.5*this._width+M$e[3]-M$e[1])),0<this._height){var M$l=this._textHeight>this._height?"top":this.valign;"middle"===M$l?M$k=.5*(this._height-M$b*M$i)+M$e[0]-M$e[2]:"bottom"===M$l&&(M$k=this._height-M$b*M$i-M$e[2])}var M$m=this._style;if(M$j&&M$j.autoScaleSize)var M$n=M$j.fontSize/this.fontSize;if(this._clipPoint)if(M$c.save(),M$j&&M$j.autoScaleSize){var M$o=0,M$p=0;M$o=this._width?this._width-M$e[3]-M$e[1]:this._textWidth,M$p=this._height?this._height-M$e[0]-M$e[2]:this._textHeight,M$o*=M$n,M$p*=M$n,M$c.clipRect(M$e[3],M$e[0],M$o,M$p)}else M$c.clipRect(M$e[3],M$e[0],this._width?this._width-M$e[3]-M$e[1]:this._textWidth,this._height?this._height-M$e[0]-M$e[2]:this._textHeight);var M$q=M$m.password;"prompt"in this&&this.prompt==this._text&&(M$q=!1);for(var M$r=0,M$s=0,M$t=Math.min(this._lines.length,M$b+M$a)||1,M$u=M$a;M$u<M$t;M$u++){var M$v,M$w=M$h[M$u];if(M$q){var M$x=M$w.length;M$w="";for(var M$A=M$x;0<M$A;M$A--)M$w+="●"}if(M$r=M$f-(this._clipPoint?this._clipPoint.x:0),M$s=M$k+M$i*M$u-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(M$g,M$r,M$s,M$u),M$j){var M$B=this.width;M$j.autoScaleSize&&(M$B=this.width*M$n),M$j.drawText(M$w,this,M$r,M$s,this.align,M$B)}else M$J.isWebGL?(this._words||(this._words=[]),(M$v=this._words.length>M$u-M$a?this._words[M$u-M$a]:new M$z).setText(M$w)):M$v=M$w,M$m.stroke?M$c.fillBorderText(M$v,M$r,M$s,M$d,this.color,M$m.strokeColor,M$m.stroke,M$g):M$c.fillText(M$v,M$r,M$s,M$d,this.color,M$g)}if(M$j&&M$j.autoScaleSize){var M$C=1/M$n;this.scale(M$C,M$C)}this._clipPoint&&M$c.restore(),this._startX=M$f,this._startY=M$k},M$a.drawUnderline=function(M$a,M$b,M$c,M$d){var M$e=this._lineWidths[M$d];switch(M$a){case"center":M$b-=M$e/2;break;case"right":M$b-=M$e}M$c+=this._charSize.height,this._graphics.drawLine(M$b,M$c,M$b+M$e,M$c,this.underlineColor||this.color,1)},M$a.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);M$O.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new M$A(0,0)):this._clipPoint=null;var M$a=this._lines.length;if(this.overflow!=M$n.VISIBLE){var M$b=this.overflow==M$n.HIDDEN?Math.floor:Math.ceil;M$a=Math.min(M$a,M$b((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var M$c=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(M$c,M$a),this.repaint()},M$a.evalTextSize=function(){var M$a,M$b=NaN;M$a=Math.max.apply(this,this._lineWidths),M$b=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],M$a==this._textWidth&&M$b==this._textHeight||(this._textWidth=M$a,this._textHeight=M$b,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},M$a.checkEnabledViewportOrNot=function(){return this.overflow==M$n.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},M$a.changeText=function(M$a){this._text!==M$a&&(this.lang(M$a+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},M$a.parseLines=function(M$a){var M$b=this.wordWrap||this.overflow==M$n.HIDDEN;if(M$b)var M$c=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var M$d=M$O.context.measureText(M$n._testWord);M$J.isConchApp&&0===M$d.width&&0===M$d.height&&(M$d=M$O.context.measureText("W")),this._charSize.width=M$d.width,this._charSize.height=M$d.height||this.fontSize}for(var M$e=M$a.replace(/\r\n/g,"\n").split("\n"),M$f=0,M$g=M$e.length;M$f<M$g;M$f++){var M$h=M$e[M$f];M$b?this.parseLine(M$h,M$c):(this._lineWidths.push(this.getTextWidth(M$h)),this._lines.push(M$h))}},M$a.parseLine=function(M$a,M$b){M$O.context;var M$c,M$d=this._lines,M$e=0,M$f=NaN,M$g=NaN,M$h=0;if((M$f=this.getTextWidth(M$a))<=M$b)return M$d.push(M$a),void this._lineWidths.push(M$f);M$f=this._charSize.width,0==(M$e=Math.floor(M$b/M$f))&&(M$e=1),M$g=M$f=this.getTextWidth(M$a.substring(0,M$e));for(var M$i=M$e,M$j=M$a.length;M$i<M$j;M$i++)if(M$b<(M$g+=M$f=this.getTextWidth(M$a.charAt(M$i))))if(this.wordWrap){var M$k=M$a.substring(M$h,M$i);if(M$k.charCodeAt(M$k.length-1)<255?(M$c=/(?:\w|-)+$/.exec(M$k))&&(M$i=M$c.index+M$h,0==M$c.index?M$i+=M$k.length:M$k=M$a.substring(M$h,M$i)):M$n.RightToLeft&&(M$c=/([\u0600-\u06FF])+$/.exec(M$k))&&(M$i=M$c.index+M$h,0==M$c.index?M$i+=M$k.length:M$k=M$a.substring(M$h,M$i)),M$d.push(M$k),this._lineWidths.push(M$g-M$f),!((M$h=M$i)+M$e<M$j)){M$d.push(M$a.substring(M$h,M$j)),this._lineWidths.push(this.getTextWidth(M$d[M$d.length-1])),M$h=-1;break}M$i+=M$e,M$g=M$f=this.getTextWidth(M$a.substring(M$h,M$i)),M$i--}else if(this.overflow==M$n.HIDDEN)return M$d.push(M$a.substring(0,M$i)),void this._lineWidths.push(this.getTextWidth(M$d[M$d.length-1]));this.wordWrap&&-1!=M$h&&(M$d.push(M$a.substring(M$h,M$j)),this._lineWidths.push(this.getTextWidth(M$d[M$d.length-1])))},M$a.getTextWidth=function(M$a){return this._currBitmapFont?this._currBitmapFont.getTextWidth(M$a):M$O.context.measureText(M$a).width},M$a.getWordWrapWidth=function(){var M$a=this.padding,M$b=NaN;return(M$b=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(M$b=this.wordWrap?100:M$O.width),M$b<=0&&(M$b=100),M$b-M$a[3]-M$a[1]},M$a.getCharPoint=function(M$a,M$b){this._isChanged&&M$x.timer.runCallLater(this,this.typeset);for(var M$c=0,M$d=this._lines,M$e=0,M$f=0,M$g=M$d.length;M$f<M$g;M$f++){if(M$a<(M$c+=M$d[M$f].length)){var M$h=M$f;break}M$e=M$c}var M$i=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;M$O.context.font=M$i;var M$j=this.getTextWidth(this._text.substring(M$e,M$a));return(M$b||new M$A).setTo(this._startX+M$j-(this._clipPoint?this._clipPoint.x:0),this._startY+M$h*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},M$o(0,M$a,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(M$a){M$a!=this._width&&(M$x.superSet(M$la,this,"width",M$a),this.isChanged=!0)}),M$o(0,M$a,"textWidth",function(){return this._isChanged&&M$x.timer.runCallLater(this,this.typeset),this._textWidth}),M$o(0,M$a,"height",function(){return this._height?this._height:this.textHeight},function(M$a){M$a!=this._height&&(M$x.superSet(M$la,this,"height",M$a),this.isChanged=!0)}),M$o(0,M$a,"textHeight",function(){return this._isChanged&&M$x.timer.runCallLater(this,this.typeset),this._textHeight}),M$o(0,M$a,"padding",function(){return this._getCSSStyle().padding},function(M$a){this._getCSSStyle().padding=M$a,this.isChanged=!0}),M$o(0,M$a,"bold",function(){return this._getCSSStyle().bold},function(M$a){this._getCSSStyle().bold=M$a,this.isChanged=!0}),M$o(0,M$a,"text",function(){return this._text||""},function(M$a){this._text!==M$a&&(this.lang(M$a+""),this.isChanged=!0,this.event("change"))}),M$o(0,M$a,"color",function(){return this._getCSSStyle().color},function(M$a){this._getCSSStyle().color!=M$a&&(this._getCSSStyle().color=M$a,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),M$o(0,M$a,"font",function(){return this._getCSSStyle().fontFamily},function(M$a){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),M$n._bitmapFonts&&M$n._bitmapFonts[M$a]&&(this._currBitmapFont=M$n._bitmapFonts[M$a]),this._getCSSStyle().fontFamily=M$a,this.isChanged=!0}),M$o(0,M$a,"fontSize",function(){return this._getCSSStyle().fontSize},function(M$a){this._getCSSStyle().fontSize=M$a,this.isChanged=!0}),M$o(0,M$a,"italic",function(){return this._getCSSStyle().italic},function(M$a){this._getCSSStyle().italic=M$a,this.isChanged=!0}),M$o(0,M$a,"align",function(){return this._getCSSStyle().align},function(M$a){this._getCSSStyle().align=M$a,this.isChanged=!0}),M$o(0,M$a,"valign",function(){return this._getCSSStyle().valign},function(M$a){this._getCSSStyle().valign=M$a,this.isChanged=!0}),M$o(0,M$a,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(M$a){this._getCSSStyle().wordWrap=M$a,this.isChanged=!0}),M$o(0,M$a,"leading",function(){return this._getCSSStyle().leading},function(M$a){this._getCSSStyle().leading=M$a,this.isChanged=!0}),M$o(0,M$a,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(M$a){this._getCSSStyle().backgroundColor=M$a,this.isChanged=!0}),M$o(0,M$a,"borderColor",function(){return this._getCSSStyle().borderColor},function(M$a){this._getCSSStyle().borderColor=M$a,this.isChanged=!0}),M$o(0,M$a,"stroke",function(){return this._getCSSStyle().stroke},function(M$a){this._getCSSStyle().stroke=M$a,this.isChanged=!0}),M$o(0,M$a,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(M$a){this._getCSSStyle().strokeColor=M$a,this.isChanged=!0}),M$o(0,M$a,"isChanged",null,function(M$a){this._isChanged!==M$a&&(this._isChanged=M$a)&&M$x.timer.callLater(this,this.typeset)}),M$o(0,M$a,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(M$a){if(!(this.overflow!=M$n.SCROLL||this.textWidth<this._width)&&this._clipPoint){M$a=M$a<this.padding[3]?this.padding[3]:M$a;var M$b=this._textWidth-this._width;M$a=M$b<M$a?M$b:M$a;var M$c=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=M$a,this.renderText(this._lastVisibleLineIndex,M$c)}}),M$o(0,M$a,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(M$a){if(!(this.overflow!=M$n.SCROLL||this.textHeight<this._height)&&this._clipPoint){M$a=M$a<this.padding[0]?this.padding[0]:M$a;var M$b=this._textHeight-this._height,M$c=(M$a=M$b<M$a?M$b:M$a)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=M$c;var M$d=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=M$a,this.renderText(M$c,M$d)}}),M$o(0,M$a,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),M$o(0,M$a,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),M$o(0,M$a,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),M$o(0,M$a,"underlineColor",function(){return this._underlineColor},function(M$a){this._underlineColor=M$a,this._isChanged=!0,this.typeset()}),M$n.registerBitmapFont=function(M$a,M$b){M$n._bitmapFonts||(M$n._bitmapFonts={}),M$n._bitmapFonts[M$a]=M$b},M$n.unregisterBitmapFont=function(M$a,M$b){if(void 0===M$b&&(M$b=!0),M$n._bitmapFonts&&M$n._bitmapFonts[M$a]){var M$c=M$n._bitmapFonts[M$a];M$b&&M$c.destroy(),delete M$n._bitmapFonts[M$a]}},M$n.setTextRightToLeft=function(){var M$a;(M$a=M$O.canvas.source.style).display="none",M$a.position="absolute",M$a.direction="rtl",M$J._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,M$O.document.body.appendChild(M$O.canvas.source)},M$n.supportFont=function(M$a){M$O.context.font="10px sans-serif";var M$b=M$O.context.measureText("abcji").width;M$O.context.font="10px "+M$a;var M$c=M$O.context.measureText("abcji").width;return console.log(M$b,M$c),M$b!==M$c},M$n._testWord="游",M$n.langPacks=null,M$n.VISIBLE="visible",M$n.SCROLL="scroll",M$n.HIDDEN="hidden",M$n.CharacterCache=!0,M$n.RightToLeft=!1,M$n._bitmapFonts=null,M$i(M$n,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),M$n}(M$la),M$ra=function(M$l){function M$g(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",M$g.__super.call(this),this.offset=new M$A,this._canvasTransform=new M$G,this._previousOrientation=M$O.window.orientation;var M$b=this;this.transform=M$G.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var M$a=M$O.window,M$c=this;M$a.addEventListener("focus",function(){M$b._isFocused=!0,M$c.event("focus"),M$c.event("focuschange")}),M$a.addEventListener("blur",function(){M$b._isFocused=!1,M$c.event("blur"),M$c.event("focuschange"),M$c._isInputting()&&(M$va.inputElement.target.focus=!1)});var M$d="visibilityState",M$e="visibilitychange",M$f=M$a.document;void 0!==M$f.hidden?(M$e="visibilitychange",M$d="visibilityState"):void 0!==M$f.mozHidden?(M$e="mozvisibilitychange",M$d="mozVisibilityState"):void 0!==M$f.msHidden?(M$e="msvisibilitychange",M$d="msVisibilityState"):void 0!==M$f.webkitHidden&&(M$e="webkitvisibilitychange",M$d="webkitVisibilityState"),M$a.document.addEventListener(M$e,function(){"hidden"==M$O.document[M$d]?M$c._setStageVisible(!1):M$c._setStageVisible(!0)}),M$a.document.addEventListener("qbrowserVisibilityChange",function(M$a){M$c._setStageVisible(!M$a.hidden)}),M$a.addEventListener("resize",function(){var M$a=M$O.window.orientation;null!=M$a&&M$a!=M$b._previousOrientation&&M$c._isInputting()&&(M$va.inputElement.target.focus=!1),M$b._previousOrientation=M$a,M$c._isInputting()||M$c._resetCanvas()}),M$a.addEventListener("orientationchange",function(M$a){M$c._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),M$O.onMobile&&this.on("mousedown",this,this._onmouseMove)}M$k(M$g,"laya.display.Stage",M$l);var M$a=M$g.prototype;return M$a._setStageVisible=function(M$a){this._isVisibility!=M$a&&(this._isVisibility=M$a,this._isVisibility||this._isInputting()&&(M$va.inputElement.target.focus=!1),this.event("visibilitychange"))},M$a._isInputting=function(){return M$O.onMobile&&M$va.isInputting},M$a._changeCanvasSize=function(){this.setScreenSize(M$O.clientWidth*M$O.pixelRatio,M$O.clientHeight*M$O.pixelRatio)},M$a._resetCanvas=function(){if(this.screenAdaptationEnabled){var M$a=M$J._mainCanvas;M$a.source.style;M$a.size(1,1),M$x.timer.once(100,this,this._changeCanvasSize)}},M$a.setScreenSize=function(M$a,M$b){var M$c=!1;if("none"!==this._screenMode&&(M$c=(M$a/M$b<1?"vertical":"horizontal")!==this._screenMode)){var M$d=M$b;M$b=M$a,M$a=M$d}this.canvasRotation=M$c;var M$e=M$J._mainCanvas,M$f=M$e.source.style,M$g=this._canvasTransform.identity(),M$h=this._scaleMode,M$i=M$a/this.designWidth,M$j=M$b/this.designHeight,M$k=this.designWidth,M$l=this.designHeight,M$m=M$a,M$n=M$b,M$o=M$O.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,M$h){case"noscale":M$i=M$j=1,M$m=this.designWidth,M$n=this.designHeight;break;case"showall":M$i=M$j=Math.min(M$i,M$j),M$k=M$m=Math.round(this.designWidth*M$i),M$l=M$n=Math.round(this.designHeight*M$j);break;case"noborder":M$i=M$j=Math.max(M$i,M$j),M$m=Math.round(this.designWidth*M$i),M$n=Math.round(this.designHeight*M$j);break;case"full":M$i=M$j=1,this._width=M$k=M$a,this._height=M$l=M$b;break;case"fixedwidth":M$j=M$i,this._height=M$l=Math.round(M$b/M$i);break;case"fixedheight":M$i=M$j,this._width=M$k=Math.round(M$a/M$j);break;case"fixedauto":M$a/M$b<this.designWidth/this.designHeight?(M$j=M$i,this._height=M$l=Math.round(M$b/M$i)):(M$i=M$j,this._width=M$k=Math.round(M$a/M$j))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,M$k=M$k+1&2147483646,M$l=M$l+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),M$i*=this.scaleX,M$j*=this.scaleY,1===M$i&&1===M$j?this.transform.identity():(this.transform.a=this._formatData(M$i/(M$m/M$k)),this.transform.d=this._formatData(M$j/(M$n/M$l)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),M$e.size(M$k,M$l),M$F.changeWebGLSize(M$k,M$l),M$g.scale(M$m/M$k/M$o,M$n/M$l/M$o),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(M$a-M$m)/M$o:this.offset.x=.5*(M$a-M$m)/M$o,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(M$b-M$n)/M$o:this.offset.y=.5*(M$b-M$n)/M$o,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),M$g.translate(this.offset.x,this.offset.y),this.canvasDegree=0,M$c&&("horizontal"===this._screenMode?(M$g.rotate(Math.PI/2),M$g.translate(M$b/M$o,0),this.canvasDegree=90):(M$g.rotate(-Math.PI/2),M$g.translate(0,M$a/M$o),this.canvasDegree=-90)),M$g.a=this._formatData(M$g.a),M$g.d=this._formatData(M$g.d),M$g.tx=this._formatData(M$g.tx),M$g.ty=this._formatData(M$g.ty),M$f.transformOrigin=M$f.webkitTransformOrigin=M$f.msTransformOrigin=M$f.mozTransformOrigin=M$f.oTransformOrigin="0px 0px 0px",M$f.transform=M$f.webkitTransform=M$f.msTransform=M$f.mozTransform=M$f.oTransform="matrix("+M$g.toString()+")",M$g.translate(parseInt(M$f.left)||0,parseInt(M$f.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},M$a._formatData=function(M$a){return Math.abs(M$a)<1e-6?0:Math.abs(1-M$a)<.001?0<M$a?1:-1:M$a},M$a.getMousePoint=function(){return M$A.TEMP.setTo(this.mouseX,this.mouseY)},M$a.repaint=function(){this._repaint=1},M$a.parentRepaint=function(){},M$a._loop=function(){return this.render(M$J.context,0,0),!0},M$a._onmouseMove=function(M$a){this._mouseMoveTime=M$O.now()},M$a.getTimeFromFrameStart=function(){return M$O.now()-this._frameStartTime},M$a.render=function(M$a,M$b,M$c){if("sleep"===this._frameRate&&!M$J.isConchApp){var M$d=M$O.now();if(!(1e3<=M$d-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(M$X.loopCount++,M$p.instance.runEvent(),M$x.timer._update()));this._frameStartTime=M$d}if(this._renderCount++,M$J.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=M$O.now();var M$e="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),M$f=this._renderCount%2==0;if(M$X.renderSlow=!M$e,M$e||M$f||M$J.isConchApp){var M$g;M$X.loopCount++,M$p.instance.runEvent(),M$x.timer._update(),M$F.update3DLoop();var M$h=0,M$i=0;if(M$J.isConchNode)for(M$h=0,M$i=this._scenes.length;M$h<M$i;M$h++)(M$g=this._scenes[M$h])&&M$g._updateSceneConch();else for(M$h=0,M$i=this._scenes.length;M$h<M$i;M$h++)(M$g=this._scenes[M$h])&&M$g._updateScene();if(M$J.isConchNode){var M$j=M$la.CustomList;for(M$h=0,M$i=M$j.length;M$h<M$i;M$h++){var M$k=M$j[M$h];M$k.customRender(M$k.customContext,0,0)}return}}M$J.isConchNode||this.renderingEnabled&&(M$e||!M$f||M$J.isConchWebGL)&&(M$J.isWebGL?M$J.WebGL.mainContext&&!M$J.WebGL.mainContext.isContextLost()&&(M$a.clear(),M$l.prototype.render.call(this,M$a,M$b,M$c),M$X._show&&M$X._sp&&M$X._sp.render(M$a,M$b,M$c),M$F.clear(this._bgColor),M$F.beginFlush(),M$a.flush(),M$F.endFinish(),M$_.instance&&M$_.getInstance().endDispose()):(M$F.clear(this._bgColor),M$l.prototype.render.call(this,M$a,M$b,M$c),M$X._show&&M$X._sp&&M$X._sp.render(M$a,M$b,M$c)))}else this._renderCount%5==0&&(M$X.loopCount++,M$p.instance.runEvent(),M$x.timer._update())},M$a._requestFullscreen=function(){var M$a=M$O.document.documentElement;M$a.requestFullscreen?M$a.requestFullscreen():M$a.mozRequestFullScreen?M$a.mozRequestFullScreen():M$a.webkitRequestFullscreen?M$a.webkitRequestFullscreen():M$a.msRequestFullscreen&&M$a.msRequestFullscreen()},M$a._fullScreenChanged=function(){M$x.stage.event("fullscreenchange")},M$a.exitFullscreen=function(){var M$a=M$O.document;M$a.exitFullscreen?M$a.exitFullscreen():M$a.mozCancelFullScreen?M$a.mozCancelFullScreen():M$a.webkitExitFullscreen&&M$a.webkitExitFullscreen()},M$o(0,M$a,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),M$o(0,M$a,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),M$o(0,M$a,"frameRate",function(){return this._frameRate},function(M$a){if(this._frameRate=M$a,M$J.isConchApp)switch(this._frameRate){case"slow":M$O.window.conch&&M$O.window.conchConfig.setSlowFrame&&M$O.window.conchConfig.setSlowFrame(!0);break;case"fast":M$O.window.conch&&M$O.window.conchConfig.setSlowFrame&&M$O.window.conchConfig.setSlowFrame(!1);break;case"mouse":M$O.window.conch&&M$O.window.conchConfig.setMouseFrame&&M$O.window.conchConfig.setMouseFrame(2e3);break;case"sleep":M$O.window.conch&&M$O.window.conchConfig.setLimitFPS&&M$O.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),M$o(0,M$a,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),M$o(0,M$a,"width",M$l.prototype._$get_width,function(M$a){this.designWidth=M$a,M$x.superSet(M$la,this,"width",M$a),M$x.timer.callLater(this,this._changeCanvasSize)}),M$o(0,M$a,"alignH",function(){return this._alignH},function(M$a){this._alignH=M$a,M$x.timer.callLater(this,this._changeCanvasSize)}),M$o(0,M$a,"isFocused",function(){return this._isFocused}),M$o(0,M$a,"height",M$l.prototype._$get_height,function(M$a){this.designHeight=M$a,M$x.superSet(M$la,this,"height",M$a),M$x.timer.callLater(this,this._changeCanvasSize)}),M$o(0,M$a,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||M$G.create()},M$l.prototype._$set_transform),M$o(0,M$a,"isVisibility",function(){return this._isVisibility}),M$o(0,M$a,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),M$o(0,M$a,"scaleMode",function(){return this._scaleMode},function(M$a){this._scaleMode=M$a,M$x.timer.callLater(this,this._changeCanvasSize)}),M$o(0,M$a,"alignV",function(){return this._alignV},function(M$a){this._alignV=M$a,M$x.timer.callLater(this,this._changeCanvasSize)}),M$o(0,M$a,"bgColor",function(){return this._bgColor},function(M$a){this._bgColor=M$a,this.conchModel&&this.conchModel.bgColor(M$a),M$J.isWebGL&&(M$a?M$g._wgColor=M$S.create(M$a)._color:M$O.onMiniGame||(M$g._wgColor=null)),M$O.onLimixiu?M$g._wgColor=M$S.create(M$a)._color:M$J.canvas.style.background=M$a||"none"}),M$o(0,M$a,"mouseX",function(){return Math.round(M$p.instance.mouseX/this.clientScaleX)}),M$o(0,M$a,"mouseY",function(){return Math.round(M$p.instance.mouseY/this.clientScaleY)}),M$o(0,M$a,"screenMode",function(){return this._screenMode},function(M$a){this._screenMode=M$a}),M$o(0,M$a,"visible",M$l.prototype._$get_visible,function(M$a){this.visible!==M$a&&(M$x.superSet(M$la,this,"visible",M$a),M$J._mainCanvas.source.style.visibility=M$a?"visible":"hidden")}),M$o(0,M$a,"fullScreenEnabled",null,function(M$a){var M$b=M$O.document,M$c=M$J.canvas;M$a?(M$c.addEventListener("mousedown",this._requestFullscreen),M$c.addEventListener("touchstart",this._requestFullscreen),M$b.addEventListener("fullscreenchange",this._fullScreenChanged),M$b.addEventListener("mozfullscreenchange",this._fullScreenChanged),M$b.addEventListener("webkitfullscreenchange",this._fullScreenChanged),M$b.addEventListener("msfullscreenchange",this._fullScreenChanged)):(M$c.removeEventListener("mousedown",this._requestFullscreen),M$c.removeEventListener("touchstart",this._requestFullscreen),M$b.removeEventListener("fullscreenchange",this._fullScreenChanged),M$b.removeEventListener("mozfullscreenchange",this._fullScreenChanged),M$b.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),M$b.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),M$g.SCALE_NOSCALE="noscale",M$g.SCALE_EXACTFIT="exactfit",M$g.SCALE_SHOWALL="showall",M$g.SCALE_NOBORDER="noborder",M$g.SCALE_FULL="full",M$g.SCALE_FIXED_WIDTH="fixedwidth",M$g.SCALE_FIXED_HEIGHT="fixedheight",M$g.SCALE_FIXED_AUTO="fixedauto",M$g.ALIGN_LEFT="left",M$g.ALIGN_RIGHT="right",M$g.ALIGN_CENTER="center",M$g.ALIGN_TOP="top",M$g.ALIGN_MIDDLE="middle",M$g.ALIGN_BOTTOM="bottom",M$g.SCREEN_NONE="none",M$g.SCREEN_HORIZONTAL="horizontal",M$g.SCREEN_VERTICAL="vertical",M$g.FRAME_FAST="fast",M$g.FRAME_SLOW="slow",M$g.FRAME_MOUSE="mouse",M$g.FRAME_SLEEP="sleep",M$g.FRAME_MOUSE_THREDHOLD=2e3,M$i(M$g,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),M$g}(M$la),M$sa=(function(M$a){function M$b(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,M$b.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}M$k(M$b,"laya.media.SoundNode",M$la);var M$c=M$b.prototype;M$c._onParentChange=function(){this.target=this.parent},M$c.play=function(M$a,M$b){void 0===M$a&&(M$a=1),isNaN(M$a)&&(M$a=1),this.url&&(this.stop(),this._channel=M$E.playSound(this.url,M$a,null,M$b))},M$c.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},M$c._setPlayAction=function(M$a,M$b,M$c,M$d){void 0===M$d&&(M$d=!0),this[M$c]&&M$a&&(M$d?M$a.on(M$b,this,this[M$c]):M$a.off(M$b,this,this[M$c]))},M$c._setPlayActions=function(M$a,M$b,M$c,M$d){if(void 0===M$d&&(M$d=!0),M$a&&M$b){var M$e,M$f=M$b.split(","),M$g=0;for(M$e=M$f.length,M$g=0;M$g<M$e;M$g++)this._setPlayAction(M$a,M$f[M$g],M$c,M$d)}},M$o(0,M$c,"playEvent",null,function(M$a){(this._playEvents=M$a)&&this._tar&&this._setPlayActions(this._tar,M$a,"play")}),M$o(0,M$c,"target",null,function(M$a){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=M$a,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),M$o(0,M$c,"stopEvent",null,function(M$a){(this._stopEvents=M$a)&&this._tar&&this._setPlayActions(this._tar,M$a,"stop")})}(),function(M$a){function M$b(){this._src=null,this._onload=null,this._onerror=null,M$b.__super.call(this)}M$k(M$b,"laya.resource.FileBitmap",M$oa);var M$c=M$b.prototype;return M$o(0,M$c,"src",function(){return this._src},function(M$a){this._src=M$a}),M$o(0,M$c,"onload",null,function(M$a){}),M$o(0,M$c,"onerror",null,function(M$a){}),M$b}()),M$ta=function(M$a){function M$c(M$a,M$b){this._is2D=!1,M$c.__super.call(this);var M$d=this;if(this._source=this,"2D"===M$a||"AUTO"===M$a&&!M$J.isWebGL){this._is2D=!0,this._source=M$b||M$O.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var M$e=this;M$e.getContext=function(M$a,M$b){if(M$d._ctx)return M$d._ctx;var M$c=M$d._ctx=M$d._source.getContext(M$a,M$b);return M$c&&(M$c._canvas=M$e,M$J.isFlash||M$O.onLimixiu||(M$c.size=function(M$a,M$b){})),M$c}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}M$k(M$c,"laya.resource.HTMLCanvas",M$oa);var M$b=M$c.prototype;return M$b.clear=function(){this._ctx&&this._ctx.clear()},M$b.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},M$b.release=function(){},M$b._setContext=function(M$a){this._ctx=M$a},M$b.getContext=function(M$a,M$b){return this._ctx?this._ctx:this._ctx=M$c._createContext(this)},M$b.getMemSize=function(){return 0},M$b.size=function(M$a,M$b){(this._w!=M$a||this._h!=M$b||this._source&&(this._source.width!=M$a||this._source.height!=M$b))&&(this._w=M$a,this._h=M$b,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(M$a,M$b),this._source&&(this._source.height=M$b,this._source.width=M$a))},M$b.getCanvas=function(){return this._source},M$b.toBase64=function(M$a,M$b,M$c){if(this._source)if(M$J.isConchApp&&this._source.toBase64)this._source.toBase64(M$a,M$b,M$c);else{var M$d=this._source.toDataURL(M$a,M$b);M$c.call(this,M$d)}},M$o(0,M$b,"context",function(){return this._ctx}),M$o(0,M$b,"asBitmap",null,function(M$a){}),M$c.create=function(M$a,M$b){return new M$c(M$a,M$b)},M$c.TYPE2D="2D",M$c.TYPE3D="3D",M$c.TYPEAUTO="AUTO",M$c._createContext=null,M$c}(),M$ua=(function(M$a){function M$i(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){throw M$i.__super.call(this),new Error("不允许new！")}M$k(M$i,"laya.resource.HTMLSubImage",M$oa),M$i.create=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){return void 0===M$h&&(M$h=!1),new M$i(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h)}}(),function(M$a){function M$l(){this._frames=null,this._url=null,M$l.__super.call(this),this._setControlNode(this)}M$k(M$l,"laya.display.Animation",M$a);var M$b=M$l.prototype;M$b.destroy=function(M$a){void 0===M$a&&(M$a=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,M$a),this._frames=null,this._labels=null},M$b.play=function(M$a,M$b,M$c,M$d){void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=!0),void 0===M$c&&(M$c=""),void 0===M$d&&(M$d=!0),M$c&&this._setFramesFromCache(M$c,M$d),this._isPlaying=!0,this.index="string"==typeof M$a?this._getFrameByLabel(M$a):M$a,this.loop=M$b,this._actionName=M$c,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},M$b._setFramesFromCache=function(M$a,M$b){var M$c;return void 0===M$b&&(M$b=!1),this._url&&(M$a=this._url+"#"+M$a),M$a&&M$l.framesMap[M$a]?((M$c=M$l.framesMap[M$a])instanceof Array?(this._frames=M$l.framesMap[M$a],this._count=this._frames.length):(M$c.nodeRoot&&(M$l.framesMap[M$a]=this._parseGraphicAnimationByData(M$c),M$c=M$l.framesMap[M$a]),this._frames=M$c.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=M$c.interval),this._labels=this._copyLabels(M$c.labels)),!0):(M$b&&console.log("ani not found:",M$a),!1)},M$b._copyLabels=function(M$a){if(!M$a)return null;var M$b,M$c;for(M$c in M$b={},M$a)M$b[M$c]=M$$.copyArray([],M$a[M$c]);return M$b},M$b._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&M$a.prototype._frameLoop.call(this)},M$b._displayToIndex=function(M$a){this._frames&&(this.graphics=this._frames[M$a])},M$b.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},M$b.loadImages=function(M$a,M$b){return void 0===M$b&&(M$b=""),this._url="",this._setFramesFromCache(M$b)||(this.frames=M$l.framesMap[M$b]?M$l.framesMap[M$b]:M$l.createFrames(M$a,M$b)),this},M$b.loadAtlas=function(M$b,M$c,M$d){void 0===M$d&&(M$d=""),this._url="";var M$e=this;function M$a(M$a){M$b===M$a&&(M$e.frames=M$l.framesMap[M$d]?M$l.framesMap[M$d]:M$l.createFrames(M$b,M$d),M$c&&M$c.run())}return M$e._setFramesFromCache(M$d)||(M$ha.getAtlas(M$b)?M$a(M$b):M$x.loader.load(M$b,M$s.create(null,M$a,[M$b]),null,"atlas")),this},M$b.loadAnimation=function(M$a,M$b,M$c){this._url=M$a;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,M$b&&M$b.run()):!M$c||M$ha.getAtlas(M$c)?this._loadAnimationData(M$a,M$b,M$c):M$x.loader.load(M$c,M$s.create(this,this._loadAnimationData,[M$a,M$b,M$c]),null,"atlas"),this},M$b._loadAnimationData=function(M$h,M$i,M$a){var M$j=this;if(!M$a||M$ha.getAtlas(M$a)){var M$k=this;M$ha.getRes(M$h)?M$b(M$h):M$x.loader.load(M$h,M$s.create(null,M$b,[M$h]),null,"json"),M$ha.clearRes(M$h)}else console.warn("atlas load fail:"+M$a);function M$b(M$a){if(M$ha.getRes(M$a)&&M$h===M$a){var M$b;if(M$l.framesMap[M$h+"#"])M$k._setFramesFromCache(M$j._actionName,!0),M$j.index=0,M$j._checkResumePlaying();else{var M$c=M$k._parseGraphicAnimation(M$ha.getRes(M$h));if(!M$c)return;var M$d,M$e=M$c.animationList,M$f=0,M$g=M$e.length;for(M$f=0;M$f<M$g;M$f++)M$b=M$e[M$f],M$l.framesMap[M$h+"#"+M$b.name]=M$b,M$d||(M$d=M$b);M$d&&(M$l.framesMap[M$h+"#"]=M$d,M$k._setFramesFromCache(M$j._actionName,!0),M$j.index=0),M$j._checkResumePlaying()}M$i&&M$i.run()}}},M$b._parseGraphicAnimation=function(M$a){return M$xa.parseAnimationData(M$a)},M$b._parseGraphicAnimationByData=function(M$a){return M$xa.parseAnimationByData(M$a)},M$o(0,M$b,"frames",function(){return this._frames},function(M$a){(this._frames=M$a)&&(this._count=M$a.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),M$o(0,M$b,"autoPlay",null,function(M$a){M$a?this.play():this.stop()}),M$o(0,M$b,"source",null,function(M$a){-1<M$a.indexOf(".ani")?this.loadAnimation(M$a):-1<M$a.indexOf(".json")||-1<M$a.indexOf("als")||-1<M$a.indexOf("atlas")?this.loadAtlas(M$a):this.loadImages(M$a.split(","))}),M$o(0,M$b,"autoAnimation",null,function(M$a){this.play(0,!0,M$a,!1)}),M$l.createFrames=function(M$a,M$b){var M$c,M$d,M$e=0,M$f=0;if("string"==typeof M$a){var M$g=M$ha.getAtlas(M$a);if(M$g&&M$g.length)for(M$c=[],M$e=0,M$f=M$g.length;M$e<M$f;M$e++)(M$d=new M$F.createGraphics).drawTexture(M$ha.getRes(M$g[M$e]),0,0),M$c.push(M$d)}else if(M$a instanceof Array)for(M$c=[],M$e=0,M$f=M$a.length;M$e<M$f;M$e++)(M$d=new M$F.createGraphics).loadImage(M$a[M$e],0,0),M$c.push(M$d);return M$b&&(M$l.framesMap[M$b]=M$c),M$c},M$l.clearCache=function(M$a){var M$b,M$c=M$l.framesMap,M$d=M$a+"#";for(M$b in M$c)M$b!==M$a&&0!=M$b.indexOf(M$d)||delete M$l.framesMap[M$b]},M$l.framesMap={}}(M$pa),function(M$a){function M$f(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,M$f.__super.call(this),null==M$f._sortIndexFun&&(M$f._sortIndexFun=M$w.sortByKey("index",!1,!0))}M$k(M$f,"laya.display.FrameAnimation",M$a);var M$b=M$f.prototype;return M$b._setUp=function(M$a,M$b){this._labels=null,this._animationNewFrames=null,this._targetDic=M$a,this._animationData=M$b,this.interval=1e3/M$b.frameRate,M$b.parsed?(this._count=M$b.count,this._labels=M$b.labels,this._animationNewFrames=M$b.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),M$b.parsed=!0,M$b.labels=this._labels,M$b.count=this._count,M$b.animationNewFrames=this._animationNewFrames},M$b.clear=function(){M$a.prototype.clear.call(this),this._targetDic=null,this._animationData=null},M$b._displayToIndex=function(M$a){if(this._animationData){M$a<0&&(M$a=0),M$a>this._count&&(M$a=this._count);var M$b=this._animationData.nodes,M$c=0,M$d=M$b.length;for(M$c=0;M$c<M$d;M$c++)this._displayNodeToFrame(M$b[M$c],M$a)}},M$b._displayNodeToFrame=function(M$a,M$b,M$c){M$c||(M$c=this._targetDic);var M$d=M$c[M$a.target];if(M$d){var M$e,M$f,M$g,M$h=M$a.frames,M$i=M$a.keys,M$j=0,M$k=M$i.length;for(M$j=0;M$j<M$k;M$j++)M$g=(M$f=M$h[M$e=M$i[M$j]]).length>M$b?M$f[M$b]:M$f[M$f.length-1],M$d[M$e]=M$g}},M$b._calculateDatas=function(){if(this._animationData){var M$a,M$b=this._animationData.nodes,M$c=0,M$d=M$b.length;for(M$c=this._count=0;M$c<M$d;M$c++)M$a=M$b[M$c],this._calculateNodeKeyFrames(M$a);this._count+=1}},M$b._calculateNodeKeyFrames=function(M$a){var M$b,M$c,M$d=M$a.keyframes,M$e=M$a.target;for(M$b in M$a.frames||(M$a.frames={}),M$a.keys?M$a.keys.length=0:M$a.keys=[],M$a.initValues||(M$a.initValues={}),M$d)M$c=M$d[M$b],M$a.frames[M$b]||(M$a.frames[M$b]=[]),this._targetDic&&this._targetDic[M$e]&&(M$a.initValues[M$b]=this._targetDic[M$e][M$b]),M$c.sort(M$f._sortIndexFun),M$a.keys.push(M$b),this._calculateNodePropFrames(M$c,M$a.frames[M$b],M$b,M$e)},M$b.resetToInitState=function(){if(this._targetDic&&this._animationData){var M$a,M$b,M$c=this._animationData.nodes,M$d=0,M$e=M$c.length;for(M$d=0;M$d<M$e;M$d++)if(M$b=(M$a=M$c[M$d]).initValues){var M$f,M$g=this._targetDic[M$a.target];if(M$g)for(M$f in M$b)M$g[M$f]=M$b[M$f]}}},M$b._calculateNodePropFrames=function(M$a,M$b,M$c,M$d){var M$e=0,M$f=M$a.length-1;if(0<M$f){for(M$b.length=M$a[M$f].index+1,M$e=0;M$e<M$f;M$e++)this._dealKeyFrame(M$a[M$e]),this._calculateFrameValues(M$a[M$e],M$a[M$e+1],M$b);this._dealKeyFrame(M$a[M$e])}0==M$f&&(M$b[M$a[0].index]=M$a[0].value,this._animationNewFrames&&(this._animationNewFrames[M$a[0].index]=!0))},M$b._dealKeyFrame=function(M$a){M$a.label&&""!=M$a.label&&this.addLabel(M$a.label,M$a.index)},M$b._calculateFrameValues=function(M$a,M$b,M$c){var M$d,M$e=0,M$f=M$a.index,M$g=M$b.index,M$h=M$a.value,M$i=M$b.value-M$a.value,M$j=M$g-M$f;if(M$g>this._count&&(this._count=M$g),M$a.tween)for(null==(M$d=M$U[M$a.tweenMethod])&&(M$d=M$U.linearNone),M$e=M$f;M$e<M$g;M$e++)M$c[M$e]=M$d(M$e-M$f,M$h,M$i,M$j),this._animationNewFrames&&(this._animationNewFrames[M$e]=!0);else for(M$e=M$f;M$e<M$g;M$e++)M$c[M$e]=M$h;this._animationNewFrames&&(this._animationNewFrames[M$a.index]=!0,this._animationNewFrames[M$b.index]=!0),M$c[M$b.index]=M$b.value},M$f._sortIndexFun=null,M$f}(M$pa)),M$va=function(M$b){function M$e(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",M$e.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=M$qa.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}M$k(M$e,"laya.display.Input",M$b);var M$a=M$e.prototype;return M$a.setSelection=function(M$a,M$b){this.focus=!0,laya.display.Input.inputElement.selectionStart=M$a,laya.display.Input.inputElement.selectionEnd=M$b},M$a._onUnDisplay=function(M$a){this.focus=!1},M$a._onMouseDown=function(M$a){this.focus=!0},M$a._syncInputTransform=function(){var M$a=this.nativeInput,M$b=M$$.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),M$c=this._width-this.padding[1]-this.padding[3],M$d=this._height-this.padding[0]-this.padding[2];M$J.isConchApp?(M$a.setScale(M$b.scaleX,M$b.scaleY),M$a.setSize(M$c,M$d),M$a.setPos(M$b.x,M$b.y)):(M$e.inputContainer.style.transform=M$e.inputContainer.style.webkitTransform="scale("+M$b.scaleX+","+M$b.scaleY+") rotate("+M$x.stage.canvasDegree+"deg)",M$a.style.width=M$c+"px",M$a.style.height=M$d+"px",M$e.inputContainer.style.left=M$b.x+"px",M$e.inputContainer.style.top=M$b.y+"px")},M$a.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},M$a._setInputMethod=function(){M$e.input.parentElement&&M$e.inputContainer.removeChild(M$e.input),M$e.area.parentElement&&M$e.inputContainer.removeChild(M$e.area),M$e.inputElement=this._multiline?M$e.area:M$e.input,M$e.inputContainer.appendChild(M$e.inputElement),M$qa.RightToLeft&&(M$e.inputElement.style.direction="rtl")},M$a._focusIn=function(){laya.display.Input.isInputting=!0;var M$a=this.nativeInput;this._focus=!0;var M$b=M$a.style;M$b.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),M$a.readOnly=!this._editable,M$J.isConchApp&&(M$a.setType(this._type),M$a.setForbidEdit(!this._editable)),M$a.maxLength=this._maxChars;this.padding;if(M$a.type=this._type,M$a.value=this._content,M$a.placeholder=this._prompt,M$x.stage.off("keydown",this,this._onKeyDown),M$x.stage.on("keydown",this,this._onKeyDown),(M$x.stage.focus=this).event("focus"),M$O.onPC&&M$a.focus(),!M$O.onMiniGame){this._text;this._text=null}this.typeset(),M$a.setColor(this._originColor),M$a.setFontSize(this.fontSize),M$a.setFontFace(M$O.onIPhone&&M$qa._fontFamilyMap[this.font]||this.font),M$J.isConchApp&&M$a.setMultiAble&&M$a.setMultiAble(this._multiline),M$b.lineHeight=this.leading+this.fontSize+"px",M$b.fontStyle=this.italic?"italic":"normal",M$b.fontWeight=this.bold?"bold":"normal",M$b.textAlign=this.align,M$b.padding="0 0",this._syncInputTransform(),!M$J.isConchApp&&M$O.onPC&&M$x.timer.frameLoop(1,this,this._syncInputTransform)},M$a._setPromptColor=function(){(M$e.promptStyleDOM=M$O.getElementById("promptStyle"))||((M$e.promptStyleDOM=M$O.createElement("style")).setAttribute("id","promptStyle"),M$O.document.head.appendChild(M$e.promptStyleDOM)),M$e.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},M$a._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(M$x.superSet(M$qa,this,"text",this._content),M$x.superSet(M$qa,this,"color",this._originColor)):(M$x.superSet(M$qa,this,"text",this._prompt),M$x.superSet(M$qa,this,"color",this._promptColor)),M$x.stage.off("keydown",this,this._onKeyDown),M$x.stage.focus=null,this.event("blur"),M$J.isConchApp&&this.nativeInput.blur(),M$O.onPC&&M$x.timer.clear(this,this._syncInputTransform)},M$a._onKeyDown=function(M$a){13===M$a.keyCode&&(M$O.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},M$a.changeText=function(M$a){this._content=M$a,this._focus?(this.nativeInput.value=M$a||"",this.event("change")):M$b.prototype.changeText.call(this,M$a)},M$o(0,M$a,"color",M$b.prototype._$get_color,function(M$a){this._focus&&this.nativeInput.setColor(M$a),M$x.superSet(M$qa,this,"color",this._content?M$a:this._promptColor),this._originColor=M$a}),M$o(0,M$a,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(M$a){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),M$o(0,M$a,"multiline",function(){return this._multiline},function(M$a){this._multiline=M$a,this.valign=M$a?"top":"middle"}),M$o(0,M$a,"maxChars",function(){return this._maxChars},function(M$a){M$a<=0&&(M$a=1e5),this._maxChars=M$a}),M$o(0,M$a,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(M$a){M$x.superSet(M$qa,this,"color",this._originColor),M$a+="",this._focus?(this.nativeInput.value=M$a||"",this.event("change")):(this._multiline||(M$a=M$a.replace(/\r?\n/g,"")),(this._content=M$a)?M$x.superSet(M$qa,this,"text",M$a):(M$x.superSet(M$qa,this,"text",this._prompt),M$x.superSet(M$qa,this,"color",this.promptColor)))}),M$o(0,M$a,"nativeInput",function(){return this._multiline?M$e.area:M$e.input}),M$o(0,M$a,"prompt",function(){return this._prompt},function(M$a){!this._text&&M$a&&M$x.superSet(M$qa,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?M$x.superSet(M$qa,this,"text",this._text==this._prompt?M$a:this._text):M$x.superSet(M$qa,this,"text",M$a),this._prompt=M$qa.langPacks&&M$qa.langPacks[M$a]?M$qa.langPacks[M$a]:M$a}),M$o(0,M$a,"focus",function(){return this._focus},function(M$a){var M$b=this.nativeInput;this._focus!==M$a&&(M$a?(M$b.target?M$b.target._focusOut():this._setInputMethod(),(M$b.target=this)._focusIn()):(M$b.target=null,this._focusOut(),M$O.document.body.scrollTop=0,M$b.blur(),M$J.isConchApp?M$b.setPos(-1e4,-1e4):M$e.inputContainer.contains(M$b)&&M$e.inputContainer.removeChild(M$b)))}),M$o(0,M$a,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(M$a){M$a?(-1<(M$a="[^"+M$a+"]").indexOf("^^")&&(M$a=M$a.replace("^^","")),this._restrictPattern=new RegExp(M$a,"g")):this._restrictPattern=null}),M$o(0,M$a,"editable",function(){return this._editable},function(M$a){this._editable=M$a,M$J.isConchApp&&M$e.input.setForbidEdit(!M$a)}),M$o(0,M$a,"promptColor",function(){return this._promptColor},function(M$a){this._promptColor=M$a,this._content||M$x.superSet(M$qa,this,"color",M$a)}),M$o(0,M$a,"type",function(){return this._type},function(M$a){this._getCSSStyle().password="password"==M$a,this._type=M$a,M$J.isConchApp&&this.nativeInput.setType(M$a)}),M$o(0,M$a,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(M$a){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),M$o(0,M$a,"asPassword",function(){return this._getCSSStyle().password},function(M$a){this._getCSSStyle().password=M$a,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),M$e.__init__=function(){M$e._createInputElement(),M$O.onMobile&&M$J.canvas.addEventListener(M$e.IOS_IFRAME?M$O.onMiniGame?"touchend":"click":"touchend",M$e._popupInputMethod)},M$e._popupInputMethod=function(M$a){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},M$e._createInputElement=function(){M$e._initInput(M$e.area=M$O.createElement("textarea")),M$e._initInput(M$e.input=M$O.createElement("input")),(M$e.inputContainer=M$O.createElement("div")).style.position="absolute",M$e.inputContainer.style.zIndex=1e5,M$O.container.appendChild(M$e.inputContainer),M$e.inputContainer.setPos=function(M$a,M$b){M$e.inputContainer.style.left=M$a+"px",M$e.inputContainer.style.top=M$b+"px"}},M$e._initInput=function(M$b){var M$a=M$b.style;M$a.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",M$a.resize="none",M$a.backgroundColor="transparent",M$a.border="none",M$a.outline="none",M$a.zIndex=1,M$b.addEventListener("input",M$e._processInputting),M$b.addEventListener("mousemove",M$e._stopEvent),M$b.addEventListener("mousedown",M$e._stopEvent),M$b.addEventListener("touchmove",M$e._stopEvent),M$b.setFontFace=function(M$a){M$b.style.fontFamily=M$a},M$J.isConchApp||(M$b.setColor=function(M$a){M$b.style.color=M$a},M$b.setFontSize=function(M$a){M$b.style.fontSize=M$a+"px"})},M$e._processInputting=function(M$a){var M$b=laya.display.Input.inputElement.target;if(M$b){var M$c=laya.display.Input.inputElement.value;M$b._restrictPattern&&(M$c=M$c.replace(/\u2006|\x27/g,""),M$b._restrictPattern.test(M$c)&&(M$c=M$c.replace(M$b._restrictPattern,""),laya.display.Input.inputElement.value=M$c)),M$b._text=M$c,M$b.event("input")}},M$e._stopEvent=function(M$a){"touchmove"==M$a.type&&M$a.preventDefault(),M$a.stopPropagation&&M$a.stopPropagation()},M$e.TYPE_TEXT="text",M$e.TYPE_PASSWORD="password",M$e.TYPE_EMAIL="email",M$e.TYPE_URL="url",M$e.TYPE_NUMBER="number",M$e.TYPE_RANGE="range",M$e.TYPE_DATE="date",M$e.TYPE_MONTH="month",M$e.TYPE_WEEK="week",M$e.TYPE_TIME="time",M$e.TYPE_DATE_TIME="datetime",M$e.TYPE_DATE_TIME_LOCAL="datetime-local",M$e.TYPE_SEARCH="search",M$e.input=null,M$e.area=null,M$e.inputElement=null,M$e.inputContainer=null,M$e.confirmButton=null,M$e.promptStyleDOM=null,M$e.inputHeight=45,M$e.isInputting=!1,M$e.stageMatrix=null,M$i(M$e,["IOS_IFRAME",function(){return this.IOS_IFRAME=M$O.onIOS&&M$O.window.top!=M$O.window.self}]),M$e}(M$qa),M$wa=function(M$a){function M$c(M$a,M$b){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,M$c.__super.call(this),M$a&&this._init_(M$a,M$b)}M$k(M$c,"laya.resource.HTMLImage",M$sa);var M$b=M$c.prototype;return M$b._init_=function(M$a,M$b){this._src=M$a,this._source=new M$O.window.Image,M$b&&(M$b.onload&&(this.onload=M$b.onload),M$b.onerror&&(this.onerror=M$b.onerror),M$b.onCreate&&M$b.onCreate(this)),0!=M$a.indexOf("data:image")&&(this._source.crossOrigin=""),M$a&&(this._source.src=M$a)},M$b.recreateResource=function(){var M$a=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var M$b=this;this._source=new M$O.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(M$b._needReleaseAgain)return M$b._needReleaseAgain=!1,M$b._source.onload=null,void(M$b._source=null);M$b._source.onload=null,M$b.memorySize=M$a._w*M$a._h*4,M$b._recreateLock=!1,M$b.completeCreate()},this._source.src=this._src}},M$b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},M$b.onresize=function(){this._w=this._source.width,this._h=this._source.height},M$o(0,M$b,"onload",null,function(M$a){var M$b=this;this._onload=M$a,this._source&&(this._source.onload=null!=this._onload?function(){M$b.onresize(),M$b._onload()}:null)}),M$o(0,M$b,"onerror",null,function(M$a){var M$b=this;this._onerror=M$a,this._source&&(this._source.onerror=null!=this._onerror?function(){M$b._onerror()}:null)}),M$o(0,M$b,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(M$a){this._enableMerageInAtlas=M$a,M$J.isConchApp&&this._source&&(this._source.enableMerageInAtlas=M$a)}),M$c.create=function(M$a,M$b){return new M$c(M$a,M$b)},M$c}(),M$xa=(function(M$f){function M$a(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,M$a.__super.call(this)}M$k(M$a,"laya.display.EffectAnimation",M$f);var M$b=M$a.prototype;M$b._onOtherBegin=function(M$a){M$a!=this&&this.stop()},M$b.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},M$b._onPlayAction=function(){this.play(0,!1)},M$b.play=function(M$a,M$b,M$c,M$d){void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=!0),void 0===M$c&&(M$c=""),void 0===M$d&&(M$d=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,M$a,M$b,M$c,M$d))},M$b._recordInitData=function(){if(this._aniKeys){var M$a,M$b,M$c=0;for(M$a=this._aniKeys.length,M$c=0;M$c<M$a;M$c++)M$b=this._aniKeys[M$c],this._initData[M$b]=this._target[M$b]}},M$b._displayToIndex=function(M$a){if(this._animationData){M$a<0&&(M$a=0),M$a>this._count&&(M$a=this._count);var M$b=this._animationData.nodes,M$c=0,M$d=M$b.length;for(M$d=1<M$d?1:M$d,M$c=0;M$c<M$d;M$c++)this._displayNodeToFrame(M$b[M$c],M$a)}},M$b._displayNodeToFrame=function(M$a,M$b,M$c){if(this._target){var M$d;M$d=this._target;var M$e,M$f,M$g,M$h,M$i=M$a.frames,M$j=M$a.keys,M$k=0,M$l=M$j.length;M$h=M$a.secondFrames;var M$m,M$n,M$o,M$p,M$q=0;for(M$k=0;M$k<M$l;M$k++)M$f=M$i[M$e=M$j[M$k]],M$g=-1==(M$q=M$h[M$e])?this._initData[M$e]:M$b<M$q?(M$o=(M$n=M$a.keyframes[M$e])[0]).tween?(null==(M$m=M$U[M$o.tweenMethod])&&(M$m=M$U.linearNone),M$p=M$n[1],M$m(M$b,this._initData[M$e],M$p.value-this._initData[M$e],M$p.index)):this._initData[M$e]:M$f.length>M$b?M$f[M$b]:M$f[M$f.length-1],M$d[M$e]=M$g}},M$b._calculateNodeKeyFrames=function(M$a){M$f.prototype._calculateNodeKeyFrames.call(this,M$a);var M$b,M$c,M$d,M$e=M$a.keyframes;M$a.target;for(M$b in M$d={},M$a.secondFrames=M$d,M$e)(M$c=M$e[M$b]).length<=1?M$d[M$b]=-1:M$d[M$b]=M$c[1].index},M$o(0,M$b,"target",function(){return this._target},function(M$a){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=M$a,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),M$o(0,M$b,"playEvent",null,function(M$a){(this._playEvents=M$a)&&this.addEvent()}),M$o(0,M$b,"effectData",null,function(M$a){var M$b;M$a&&((M$b=M$a.animations)&&M$b[0]&&(this._setUp({},M$b[0]),M$b[0].nodes&&M$b[0].nodes[0]&&(this._aniKeys=M$b[0].nodes[0].keys)))}),M$o(0,M$b,"effectClass",null,function(M$a){var M$b,M$c;(this._effectClass=M$R.getClass(M$a),this._effectClass)&&((M$b=this._effectClass.uiView)&&(M$c=M$b.animations)&&M$c[0]&&(this._setUp({},M$c[0]),M$c[0].nodes&&M$c[0].nodes[0]&&(this._aniKeys=M$c[0].nodes[0].keys)))}),M$a.EffectAnimationBegin="effectanimationbegin"}(M$ua),function(M$b){var M$D;function M$E(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,M$E.__super.call(this)}M$k(M$E,"laya.utils.GraphicAnimation",M$b);var M$a=M$E.prototype;return M$a._parseNodeList=function(M$a){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[M$a.compId]=M$a.props,M$a.compId&&this._nodeList.push(M$a.compId);var M$b=M$a.child;if(M$b){var M$c=0,M$d=M$b.length;for(M$c=0;M$c<M$d;M$c++)this._parseNodeList(M$b[M$c])}},M$a._calGraphicData=function(M$a){var M$b;if(this._setUp(null,M$a),this._createGraphicData(),this._nodeIDAniDic)for(M$b in this._nodeIDAniDic)this._nodeIDAniDic[M$b]=null},M$a._createGraphicData=function(){var M$a,M$b=[],M$c=0,M$d=this.count,M$e=this._animationNewFrames;for(M$e||(M$e=[]),M$c=0;M$c<M$d;M$c++)!M$e[M$c]&&M$a||(M$a=this._createFrameGraphic(M$c)),M$b.push(M$a);this._gList=M$b},M$a._createFrameGraphic=function(M$a){var M$b=M$F.createGraphics();return M$E._rootMatrix||(M$E._rootMatrix=new M$G),this._updateNodeGraphic(this._rootNode,M$a,M$E._rootMatrix,M$b),M$b},M$a._updateNodeGraphic=function(M$a,M$b,M$c,M$d,M$e){var M$f;void 0===M$e&&(M$e=1);var M$g,M$h,M$i,M$j=(M$f=this._nodeGDic[M$a.compId]=this._getNodeGraphicData(M$a.compId,M$b,this._nodeGDic[M$a.compId])).alpha*M$e;if(!(M$j<.01)&&(M$f.resultTransform||(M$f.resultTransform=M$G.create()),M$g=M$f.resultTransform,M$G.mul(M$f.transform,M$c,M$g),M$f.skin&&(M$h=this._getTextureByUrl(M$f.skin))&&(M$g._checkTransform()?(M$d.drawTexture(M$h,0,0,M$f.width,M$f.height,M$g,M$j),M$f.resultTransform=null):M$d.drawTexture(M$h,M$g.tx,M$g.ty,M$f.width,M$f.height,null,M$j)),M$i=M$a.child)){var M$k,M$l=0;for(M$k=M$i.length,M$l=0;M$l<M$k;M$l++)this._updateNodeGraphic(M$i[M$l],M$b,M$g,M$d,M$j)}},M$a._updateNoChilds=function(M$a,M$b){if(M$a.skin){var M$c=this._getTextureByUrl(M$a.skin);if(M$c){var M$d=M$a.transform;M$d._checkTransform();!M$d.bTransform?M$b.drawTexture(M$c,M$d.tx,M$d.ty,M$a.width,M$a.height,null,M$a.alpha):M$b.drawTexture(M$c,0,0,M$a.width,M$a.height,M$d.clone(),M$a.alpha)}}},M$a._updateNodeGraphic2=function(M$a,M$b,M$c){var M$d;if(M$d=this._nodeGDic[M$a.compId]=this._getNodeGraphicData(M$a.compId,M$b,this._nodeGDic[M$a.compId]),M$a.child){var M$e=M$d.transform;M$e._checkTransform();var M$f,M$g;M$g=(M$f=!M$e.bTransform)&&(0!=M$e.tx||0!=M$e.ty);var M$h,M$i,M$j;if((M$h=M$e.bTransform||1!=M$d.alpha)&&M$c.save(),1!=M$d.alpha&&M$c.alpha(M$d.alpha),M$f?M$g&&M$c.translate(M$e.tx,M$e.ty):M$c.transform(M$e.clone()),M$i=M$a.child,M$d.skin&&(M$j=this._getTextureByUrl(M$d.skin))&&M$c.drawTexture(M$j,0,0,M$d.width,M$d.height),M$i){var M$k,M$l=0;for(M$k=M$i.length,M$l=0;M$l<M$k;M$l++)this._updateNodeGraphic2(M$i[M$l],M$b,M$c)}M$h?M$c.restore():M$f?M$g&&M$c.translate(-M$e.tx,-M$e.ty):M$c.transform(M$e.clone().invert())}else this._updateNoChilds(M$d,M$c)},M$a._calculateNodeKeyFrames=function(M$a){M$b.prototype._calculateNodeKeyFrames.call(this,M$a),this._nodeIDAniDic[M$a.target]=M$a},M$a.getNodeDataByID=function(M$a){return this._nodeIDAniDic[M$a]},M$a._getParams=function(M$a,M$b,M$c,M$d){var M$e=M$E._temParam;M$e.length=M$b.length;var M$f=0,M$g=M$b.length;for(M$f=0;M$f<M$g;M$f++)M$e[M$f]=this._getObjVar(M$a,M$b[M$f][0],M$c,M$b[M$f][1],M$d);return M$e},M$a._getObjVar=function(M$a,M$b,M$c,M$d,M$e){if(M$a.hasOwnProperty(M$b)){var M$f=M$a[M$b];if(M$c>=M$f.length&&(M$c=M$f.length-1),null!=M$a[M$b][M$c])return M$a[M$b][M$c]}return M$e.hasOwnProperty(M$b)?M$e[M$b]:M$d},M$a._getNodeGraphicData=function(M$a,M$b,M$c){M$c||(M$c=M$D.create()),M$c.transform?M$c.transform.identity():M$c.transform=M$G.create();var M$d=this.getNodeDataByID(M$a);if(!M$d)return M$c;var M$e,M$f,M$g=M$d.frames,M$h=this._getParams(M$g,M$E._drawTextureCmd,M$b,this._nodeDefaultProps[M$a]),M$i=M$h[0],M$j=NaN,M$k=NaN,M$l=M$h[5],M$m=M$h[6],M$n=M$h[13],M$o=M$h[14],M$p=M$h[7],M$q=M$h[8],M$r=M$h[9],M$s=M$h[11],M$t=M$h[12];M$j=M$h[3],M$k=M$h[4],0!=M$j&&0!=M$k||(M$i=null),-1==M$j&&(M$j=0),-1==M$k&&(M$k=0),M$c.skin=M$i,M$c.width=M$j,M$c.height=M$k,M$i&&((M$e=this._getTextureByUrl(M$i))?(M$j||(M$j=M$e.sourceWidth),M$k||(M$k=M$e.sourceHeight)):console.warn("lost skin:",M$i,",you may load pics first")),M$c.alpha=M$h[10],M$f=M$c.transform,0!=M$n&&(M$l=M$n*M$j),0!=M$o&&(M$m=M$o*M$k),0==M$l&&0==M$m||M$f.translate(-M$l,-M$m);var M$u=null;if(M$r||1!==M$p||1!==M$q||M$s||M$t){(M$u=M$E._tempMt).identity(),M$u.bTransform=!0;var M$v=.0174532922222222*(M$r-M$s),M$w=.0174532922222222*(M$r+M$t),M$x=Math.cos(M$w),M$A=Math.sin(M$w),M$B=Math.sin(M$v),M$C=Math.cos(M$v);M$u.a=M$p*M$x,M$u.b=M$p*M$A,M$u.c=-M$q*M$B,M$u.d=M$q*M$C,M$u.tx=M$u.ty=0}return M$u&&(M$f=M$G.mul(M$f,M$u,M$f)),M$f.translate(M$h[1],M$h[2]),M$c},M$a._getTextureByUrl=function(M$a){return M$ha.getRes(M$a)},M$a.setAniData=function(M$a,M$b){if(M$a.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=M$a,this._parseNodeList(M$a);var M$c,M$d={},M$e=[],M$f=M$a.animations,M$g=0,M$h=M$f.length;for(M$g=0;M$g<M$h;M$g++)if(M$c=M$f[M$g],this._labels=null,(!M$b||M$b==M$c.name)&&M$c){try{this._calGraphicData(M$c)}catch(M$a){console.warn("parse animation fail:"+M$c.name+",empty animation created"),this._gList=[]}var M$i={};M$i.interval=1e3/M$c.frameRate,M$i.frames=this._gList,M$i.labels=this._labels,M$i.name=M$c.name,M$e.push(M$i),M$d[M$c.name]=M$i}this.animationList=M$e,this.animationDic=M$d}M$E._temParam.length=0},M$a.parseByData=function(M$a){var M$b,M$c;M$b=M$a.nodeRoot,M$c=M$a.aniO,delete M$a.nodeRoot,delete M$a.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=M$b,this._parseNodeList(M$b),this._labels=null;try{this._calGraphicData(M$c)}catch(M$a){console.warn("parse animation fail:"+M$c.name+",empty animation created"),this._gList=[]}var M$d=M$a;return M$d.interval=1e3/M$c.frameRate,M$d.frames=this._gList,M$d.labels=this._labels,M$d.name=M$c.name,M$d},M$a.setUpAniData=function(M$a){if(M$a.animations){var M$b,M$c={},M$d=[],M$e=M$a.animations,M$f=0,M$g=M$e.length;for(M$f=0;M$f<M$g;M$f++)if(M$b=M$e[M$f]){var M$h={};M$h.name=M$b.name,M$h.aniO=M$b,M$h.nodeRoot=M$a,M$d.push(M$h),M$c[M$b.name]=M$h}this.animationList=M$d,this.animationDic=M$c}},M$a._clear=function(){var M$a,M$b;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(M$a in this._nodeGDic)(M$b=this._nodeGDic[M$a])&&M$b.recover();this._nodeGDic=null},M$E.parseAnimationByData=function(M$a){var M$b;return M$E._I||(M$E._I=new M$E),M$b=M$E._I.parseByData(M$a),M$E._I._clear(),M$b},M$E.parseAnimationData=function(M$a){var M$b;return M$E._I||(M$E._I=new M$E),M$E._I.setUpAniData(M$a),(M$b={}).animationList=M$E._I.animationList,M$b.animationDic=M$E._I.animationDic,M$E._I._clear(),M$b},M$E._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],M$E._temParam=[],M$E._I=null,M$E._rootMatrix=null,M$i(M$E,["_tempMt",function(){return this._tempMt=new M$G}]),M$E.__init$=function(){M$D=function(){function M$a(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return M$k(M$a,""),M$a.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),M$W.recover("GraphicNode",this)},M$a.create=function(){return M$W.getItemByClass("GraphicNode",M$a)},M$a}()},M$E}(M$ua));M$x.__init([M$j,M$ia,M$J,M$O,M$Y,M$C,M$a,M$xa])}(window,document,Laya),function(M$a,M$b,M$c){M$c.un,M$c.uns,M$c.static;var M$d=M$c.class;M$c.getset,M$c.__newvec;new(function(){function M$a(){}return M$d(M$a,"LayaMain"),M$a}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(M$a,M$b){"use strict";for(var M$c in Object.defineProperty(M$b,"__esModule",{value:!0}),Laya){var M$d=Laya[M$c];M$d&&M$d.__isclass&&(M$b[M$c]=M$d)}}),function(M$a,M$b,M$w){M$w.un,M$w.uns;var M$g=M$w.static,M$m=M$w.class,M$d=M$w.getset,M$f=M$w.__newvec,M$k=laya.maths.Arith,M$l=laya.maths.Bezier,M$c=laya.resource.Bitmap,M$n=laya.utils.Browser,M$i=laya.utils.Byte,M$o=laya.utils.Color,M$x=(laya.filters.ColorFilter,M$w.Config),M$e=laya.resource.Context,M$A=(laya.events.Event,laya.filters.Filter),M$h=laya.display.Graphics,M$j=laya.resource.HTMLCanvas,M$p=(laya.utils.HTMLChar,laya.resource.HTMLImage),M$q=laya.resource.HTMLSubImage,M$B=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),M$C=laya.maths.Point,M$D=laya.maths.Rectangle,M$r=laya.renders.Render,M$s=(laya.renders.RenderContext,laya.renders.RenderSprite),M$t=laya.resource.Resource,M$u=laya.resource.ResourceManager,M$v=laya.utils.RunDriver,M$E=laya.display.Sprite,M$F=laya.display.Stage,M$G=laya.utils.Stat,M$H=laya.utils.StringKey,M$I=(laya.display.css.Style,laya.system.System),M$J=laya.display.Text,M$K=laya.resource.Texture,M$L=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),M$M=laya.utils.VectorGraphManager;laya.utils.WordText;M$w.interface("laya.webgl.shapes.IShape"),M$w.interface("laya.webgl.submit.ISubmit"),M$w.interface("laya.webgl.text.ICharSegment"),M$w.interface("laya.webgl.canvas.save.ISaveData"),M$w.interface("laya.webgl.resource.IMergeAtlasBitmap"),M$w.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var M$N=function(){function M$a(){}M$m(M$a,"laya.filters.webgl.FilterActionGL");var M$b=M$a.prototype;return M$w.imps(M$b,{"laya.filters.IFilterActionGL":!0}),M$b.setValue=function(M$a){},M$b.setValueMix=function(M$a){},M$b.apply3d=function(M$a,M$b,M$c,M$d,M$e){return null},M$b.apply=function(M$a){return null},M$d(0,M$b,"typeMix",function(){return 0}),M$a}(),M$O=function(){function M$a(){}return M$m(M$a,"laya.webgl.shader.ShaderValue"),M$a}(),M$P=function(){var M$d,M$e;function M$a(M$a,M$b,M$c){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new M$e,void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),this._cells=null,this._rowInfo=null,this._init(M$a,M$b),this._atlasID=M$c}M$m(M$a,"laya.webgl.atlas.AtlasGrid");var M$b=M$a.prototype;return M$b.getAltasID=function(){return this._atlasID},M$b.setAltasID=function(M$a){0<=M$a&&(this._atlasID=M$a)},M$b.addTex=function(M$a,M$b,M$c){var M$d=this._get(M$b,M$c);return 0==M$d.ret||(this._fill(M$d.x,M$d.y,M$b,M$c,M$a),this._texCount++),M$d},M$b._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},M$b._init=function(M$a,M$b){if(this._width=M$a,this._height=M$b,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=M$f(this._height);for(var M$c=0;M$c<this._height;M$c++)this._rowInfo[M$c]=new M$d;return this._clear(),!0},M$b._get=function(M$a,M$b){var M$c=new M$R;if(M$a>=this._failSize.width&&M$b>=this._failSize.height)return M$c;for(var M$d=-1,M$e=-1,M$f=this._width,M$g=this._height,M$h=this._cells,M$i=0;M$i<M$g;M$i++)if(!(this._rowInfo[M$i].spaceCount<M$a))for(var M$j=0;M$j<M$f;){var M$k=3*(M$i*M$f+M$j);if(0!=M$h[M$k]||M$h[1+M$k]<M$a||M$h[2+M$k]<M$b)M$j+=M$h[1+M$k];else{M$d=M$j,M$e=M$i;for(var M$l=0;M$l<M$a;M$l++)if(M$h[3*M$l+M$k+2]<M$b){M$d=-1;break}if(!(M$d<0))return M$c.ret=!0,M$c.x=M$d,M$c.y=M$e,M$c;M$j+=M$h[1+M$k]}}return M$c},M$b._fill=function(M$a,M$b,M$c,M$d,M$e){var M$f=this._width,M$g=this._height;this._check(M$a+M$c<=M$f&&M$b+M$d<=M$g);for(var M$h=M$b;M$h<M$d+M$b;++M$h){this._check(this._rowInfo[M$h].spaceCount>=M$c),this._rowInfo[M$h].spaceCount-=M$c;for(var M$i=0;M$i<M$c;M$i++){var M$j=3*(M$a+M$h*M$f+M$i);this._check(0==this._cells[M$j]),this._cells[M$j]=M$e,this._cells[1+M$j]=M$c,this._cells[2+M$j]=M$d}}if(0<M$a)for(M$h=0;M$h<M$d;++M$h){var M$k=0;for(M$i=M$a-1;0<=M$i&&0==this._cells[3*((M$b+M$h)*M$f+M$i)];--M$i,++M$k);for(M$i=M$k;0<M$i;--M$i)this._cells[3*((M$b+M$h)*M$f+M$a-M$i)+1]=M$i,this._check(0<M$i)}if(0<M$b)for(M$i=M$a;M$i<M$a+M$c;++M$i){for(M$k=0,M$h=M$b-1;0<=M$h&&0==this._cells[3*(M$i+M$h*M$f)];--M$h,M$k++);for(M$h=M$k;0<M$h;--M$h)this._cells[3*(M$i+(M$b-M$h)*M$f)+2]=M$h,this._check(0<M$h)}},M$b._check=function(M$a){0==M$a&&console.log("xtexMerger 错误啦")},M$b._clear=function(){for(var M$a=this._texCount=0;M$a<this._height;M$a++)this._rowInfo[M$a].spaceCount=this._width;for(var M$b=0;M$b<this._height;M$b++)for(var M$c=0;M$c<this._width;M$c++){var M$d=3*(M$b*this._width+M$c);this._cells[M$d]=0,this._cells[1+M$d]=this._width-M$c,this._cells[2+M$d]=this._width-M$b}this._failSize.width=this._width+1,this._failSize.height=this._height+1},M$a.__init$=function(){M$d=function(){function M$a(){this.spaceCount=0}return M$m(M$a,""),M$a}(),M$e=function(){function M$a(){this.width=0,this.height=0}return M$m(M$a,""),M$a}()},M$a}(),M$Q=function(){function M$r(M$a,M$b,M$c,M$d){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=M$a,this._height=M$b,this._gridSize=M$c,this._maxAtlaserCount=M$d,this._gridNumX=M$a/M$c,this._gridNumY=M$b/M$c,this._curAtlasIndex=0,this._atlaserArray=[]}M$m(M$r,"laya.webgl.atlas.AtlasResourceManager");var M$a=M$r.prototype;return M$a.setAtlasParam=function(M$a,M$b,M$c,M$d){if(1==this._setAtlasParam)return M$r._sid_=0,this._width=M$a,this._height=M$b,this._gridSize=M$c,this._maxAtlaserCount=M$d,this._gridNumX=M$a/M$c,this._gridNumY=M$b/M$c,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},M$a.pushData=function(M$a){var M$b,M$c=M$a.bitmap,M$d=-1,M$e=null,M$f=0,M$g=0;for(M$f=0,M$b=this._atlaserArray.length;M$f<M$b&&(M$g=(this._curAtlasIndex+M$f)%M$b,-1==(M$d=(M$e=this._atlaserArray[M$g]).findBitmapIsExist(M$c)));M$f++);if(-1!=M$d){var M$h=M$e.InAtlasWebGLImagesOffsetValue[M$d];return M$o=M$h[0],M$p=M$h[1],M$e.addToAtlas(M$a,M$o,M$p),!0}this._setAtlasParam=!1;for(var M$i=Math.ceil((M$a.bitmap.width+2)/this._gridSize),M$j=Math.ceil((M$a.bitmap.height+2)/this._gridSize),M$k=!1,M$l=0;M$l<2;M$l++){var M$m=this._maxAtlaserCount;for(M$f=0;M$f<M$m;M$f++){M$g=(this._curAtlasIndex+M$f)%M$m,this._atlaserArray.length-1>=M$g||this._atlaserArray.push(new M$Da(this._gridNumX,this._gridNumY,this._width,this._height,M$r._sid_++));var M$n=this._atlaserArray[M$g],M$o=0,M$p=0,M$q=M$n.addTex(1,M$i,M$j);if(M$q.ret){M$o=M$q.x*this._gridSize+1,M$p=M$q.y*this._gridSize+1,M$c.lock=!0,M$n.addToAtlasTexture(M$c,M$o,M$p),M$n.addToAtlas(M$a,M$o,M$p),M$k=!0,this._curAtlasIndex=M$g;break}}if(M$k)break;this._atlaserArray.push(new M$Da(this._gridNumX,this._gridNumY,this._width,this._height,M$r._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return M$k||console.log(">>>AtlasManager pushData error"),M$k},M$a.addToAtlas=function(M$a){laya.webgl.atlas.AtlasResourceManager.instance.pushData(M$a)},M$a.garbageCollection=function(){if(!0===this._needGC){for(var M$a=this._atlaserArray.length-this._maxAtlaserCount,M$b=0;M$b<M$a;M$b++)this._atlaserArray[M$b].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+M$a),this._atlaserArray.splice(0,M$a),this._needGC=!1}return!0},M$a.freeAll=function(){for(var M$a=0,M$b=this._atlaserArray.length;M$a<M$b;M$a++)this._atlaserArray[M$a].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},M$a.getAtlaserCount=function(){return this._atlaserArray.length},M$a.getAtlaserByIndex=function(M$a){return this._atlaserArray[M$a]},M$d(1,M$r,"instance",function(){return M$r._Instance||(M$r._Instance=new M$r(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),M$r._Instance}),M$d(1,M$r,"enabled",function(){return M$x.atlasEnable}),M$d(1,M$r,"atlasLimitWidth",function(){return M$r._atlasLimitWidth},function(M$a){M$r._atlasLimitWidth=M$a}),M$d(1,M$r,"atlasLimitHeight",function(){return M$r._atlasLimitHeight},function(M$a){M$r._atlasLimitHeight=M$a}),M$r._enable=function(){M$x.atlasEnable=!0},M$r._disable=function(){M$x.atlasEnable=!1},M$r.__init__=function(){M$r.atlasTextureWidth=2048,M$r.atlasTextureHeight=2048,M$r.maxTextureCount=6,M$r.atlasLimitWidth=512,M$r.atlasLimitHeight=512},M$r._atlasLimitWidth=0,M$r._atlasLimitHeight=0,M$r.gridSize=16,M$r.atlasTextureWidth=0,M$r.atlasTextureHeight=0,M$r.maxTextureCount=0,M$r._atlasRestore=0,M$r.BOARDER_TYPE_NO=0,M$r.BOARDER_TYPE_RIGHT=1,M$r.BOARDER_TYPE_LEFT=2,M$r.BOARDER_TYPE_BOTTOM=4,M$r.BOARDER_TYPE_TOP=8,M$r.BOARDER_TYPE_ALL=15,M$r._sid_=0,M$r._Instance=null,M$r}(),M$R=function(){function M$a(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return M$m(M$a,"laya.webgl.atlas.MergeFillInfo"),M$a}(),M$S=function(){function M$b(){}return M$m(M$b,"laya.webgl.canvas.BlendMode"),M$b._init_=function(M$a){M$b.fns=[M$b.BlendNormal,M$b.BlendAdd,M$b.BlendMultiply,M$b.BlendScreen,M$b.BlendOverlay,M$b.BlendLight,M$b.BlendMask,M$b.BlendDestinationOut],M$b.targetFns=[M$b.BlendNormalTarget,M$b.BlendAddTarget,M$b.BlendMultiplyTarget,M$b.BlendScreenTarget,M$b.BlendOverlayTarget,M$b.BlendLightTarget,M$b.BlendMask,M$b.BlendDestinationOut]},M$b.BlendNormal=function(M$a){M$a.blendFunc(1,771)},M$b.BlendAdd=function(M$a){M$a.blendFunc(1,772)},M$b.BlendMultiply=function(M$a){M$a.blendFunc(774,771)},M$b.BlendScreen=function(M$a){M$a.blendFunc(1,1)},M$b.BlendOverlay=function(M$a){M$a.blendFunc(1,769)},M$b.BlendLight=function(M$a){M$a.blendFunc(1,1)},M$b.BlendNormalTarget=function(M$a){M$a.blendFunc(1,771)},M$b.BlendAddTarget=function(M$a){M$a.blendFunc(1,772)},M$b.BlendMultiplyTarget=function(M$a){M$a.blendFunc(774,771)},M$b.BlendScreenTarget=function(M$a){M$a.blendFunc(1,1)},M$b.BlendOverlayTarget=function(M$a){M$a.blendFunc(1,769)},M$b.BlendLightTarget=function(M$a){M$a.blendFunc(1,1)},M$b.BlendMask=function(M$a){M$a.blendFunc(0,770)},M$b.BlendDestinationOut=function(M$a){M$a.blendFunc(0,0)},M$b.activeBlendFunction=null,M$b.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],M$b.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},M$b.NORMAL="normal",M$b.ADD="add",M$b.MULTIPLY="multiply",M$b.SCREEN="screen",M$b.LIGHT="light",M$b.OVERLAY="overlay",M$b.DESTINATIONOUT="destination-out",M$b.fns=[],M$b.targetFns=[],M$b}(),M$T=function(){function M$c(M$a){this._color=M$o.create("black"),this.setValue(M$a)}M$m(M$c,"laya.webgl.canvas.DrawStyle");var M$a=M$c.prototype;return M$a.setValue=function(M$a){if(M$a){if("string"==typeof M$a)return void(this._color=M$o.create(M$a));if(M$a instanceof laya.utils.Color)return void(this._color=M$a)}},M$a.reset=function(){this._color=M$o.create("black")},M$a.equal=function(M$a){return"string"==typeof M$a?this._color.strColor===M$a:M$a instanceof laya.utils.Color&&this._color.numColor===M$a.numColor},M$a.toColorStr=function(){return this._color.strColor},M$c.create=function(M$a){var M$b;if(M$a&&("string"==typeof M$a?M$b=M$o.create(M$a):M$a instanceof laya.utils.Color&&(M$b=M$a),M$b))return M$b._drawStyle||(M$b._drawStyle=new M$c(M$a));return laya.webgl.canvas.DrawStyle.DEFAULT},M$g(M$c,["DEFAULT",function(){return this.DEFAULT=new M$c("#000000")}]),M$c}(),M$U=function(){function M$a(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];M$ua.mainContext;this.ib=M$ya.create(35048),this.vb=M$za.create(5)}M$m(M$a,"laya.webgl.canvas.Path");var M$b=M$a.prototype;return M$b.addPoint=function(M$a,M$b){this.tempArray.push(M$a,M$b)},M$b.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},M$b.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},M$b.polygon=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g;return this.geomatrys.push(this._curGeomatry=M$g=new M$Ha(M$a,M$b,M$c,M$d,M$e,M$f)),M$d||(M$g.fill=!1),null==M$f&&(M$g.borderWidth=0),M$g},M$b.setGeomtry=function(M$a){this.geomatrys.push(this._curGeomatry=M$a)},M$b.drawLine=function(M$a,M$b,M$c,M$d,M$e){var M$f;return this.closePath?this.geomatrys.push(this._curGeomatry=M$f=new M$Ga(M$a,M$b,M$c,M$d,M$e)):this.geomatrys.push(this._curGeomatry=M$f=new M$Fa(M$a,M$b,M$c,M$d,M$e)),M$f.fill=!1,M$f},M$b.update=function(){var M$a=this.ib._byteLength,M$b=this.geomatrys.length;this.offset=M$a;for(var M$c=this.geoStart;M$c<M$b;M$c++)this.geomatrys[M$c].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=M$b,this.count=(this.ib._byteLength-M$a)/M$pa.BYTES_PIDX},M$b.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},M$b.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},M$a}(),M$V=function(){function M$h(){}M$m(M$h,"laya.webgl.canvas.save.SaveBase");var M$a=M$h.prototype;return M$w.imps(M$a,{"laya.webgl.canvas.save.ISaveData":!0}),M$a.isSaveMark=function(){return!1},M$a.restore=function(M$a){this._dataObj[this._valueName]=this._value,(M$h._cache[M$h._cache._length++]=this)._newSubmit&&(M$a._curSubmit=M$fa.RENDERBASE,M$a._renderKey=0)},M$h._createArray=function(){var M$a=[];return M$a._length=0,M$a},M$h._init=function(){var M$a=M$h._namemap={};return M$a[1]="ALPHA",M$a[2]="fillStyle",M$a[8]="font",M$a[256]="lineWidth",M$a[512]="strokeStyle",M$a[8192]="_mergeID",M$a[1024]=M$a[2048]=M$a[4096]=[],M$a[16384]="textBaseline",M$a[32768]="textAlign",M$a[65536]="_nBlendType",M$a[1048576]="shader",M$a[2097152]="filters",M$a},M$h.save=function(M$a,M$b,M$c,M$d){if((M$a._saveMark._saveuse&M$b)!==M$b){M$a._saveMark._saveuse|=M$b;var M$e=M$h._cache,M$f=0<M$e._length?M$e[--M$e._length]:new M$h;M$f._value=M$c[M$f._valueName=M$h._namemap[M$b]],M$f._dataObj=M$c,M$f._newSubmit=M$d;var M$g=M$a._save;M$g[M$g._length++]=M$f}},M$h._cache=laya.webgl.canvas.save.SaveBase._createArray(),M$h._namemap=M$h._init(),M$h}(),M$W=function(){function M$f(){this._clipRect=new M$D}M$m(M$f,"laya.webgl.canvas.save.SaveClipRect");var M$a=M$f.prototype;return M$w.imps(M$a,{"laya.webgl.canvas.save.ISaveData":!0}),M$a.isSaveMark=function(){return!1},M$a.restore=function(M$a){M$a._clipRect=this._clipSaveRect,(M$f._cache[M$f._cache._length++]=this)._submitScissor.submitLength=M$a._submits._length-this._submitScissor.submitIndex,M$a._curSubmit=M$fa.RENDERBASE,M$a._renderKey=0},M$f.save=function(M$a,M$b){if(131072!=(131072&M$a._saveMark._saveuse)){M$a._saveMark._saveuse|=131072;var M$c=M$f._cache,M$d=0<M$c._length?M$c[--M$c._length]:new M$f;M$d._clipSaveRect=M$a._clipRect,M$a._clipRect=M$d._clipRect.copyFrom(M$a._clipRect),M$d._submitScissor=M$b;var M$e=M$a._save;M$e[M$e._length++]=M$d}},M$g(M$f,["_cache",function(){return this._cache=M$V._createArray()}]),M$f}(),M$X=function(){function M$n(){this._contextX=0,this._contextY=0,this._clipRect=new M$D,this._rect=new M$D,this._matrix=new M$B}M$m(M$n,"laya.webgl.canvas.save.SaveClipRectStencil");var M$a=M$n.prototype;return M$w.imps(M$a,{"laya.webgl.canvas.save.ISaveData":!0}),M$a.isSaveMark=function(){return!1},M$a.restore=function(M$a){M$ka.restore(M$a,this._rect,this._saveMatrix,this._contextX,this._contextY),M$a._clipRect=this._clipSaveRect,M$a._curMat=this._saveMatrix,M$a._x=this._contextX,M$a._y=this._contextY,M$n._cache[M$n._cache._length++]=this,M$a._curSubmit=M$fa.RENDERBASE},M$n.save=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){if(262144!=(262144&M$a._saveMark._saveuse)){M$a._saveMark._saveuse|=262144;var M$k=M$n._cache,M$l=0<M$k._length?M$k[--M$k._length]:new M$n;M$l._clipSaveRect=M$a._clipRect,M$l._clipRect.setTo(M$g,M$h,M$i,M$j),M$a._clipRect=M$l._clipRect,M$l._rect.x=M$c,M$l._rect.y=M$d,M$l._rect.width=M$e,M$l._rect.height=M$f,M$l._contextX=M$a._x,M$l._contextY=M$a._y,M$l._saveMatrix=M$a._curMat,M$a._curMat.copyTo(M$l._matrix),M$a._curMat=M$l._matrix,M$l._submitStencil=M$b;var M$m=M$a._save;M$m[M$m._length++]=M$l}},M$g(M$n,["_cache",function(){return this._cache=M$V._createArray()}]),M$n}(),M$Y=function(){function M$d(){this._saveuse=0}M$m(M$d,"laya.webgl.canvas.save.SaveMark");var M$a=M$d.prototype;return M$w.imps(M$a,{"laya.webgl.canvas.save.ISaveData":!0}),M$a.isSaveMark=function(){return!0},M$a.restore=function(M$a){M$a._saveMark=this._preSaveMark,M$d._no[M$d._no._length++]=this},M$d.Create=function(M$a){var M$b=M$d._no,M$c=0<M$b._length?M$b[--M$b._length]:new M$d;return M$c._saveuse=0,M$c._preSaveMark=M$a._saveMark,M$a._saveMark=M$c},M$g(M$d,["_no",function(){return this._no=M$V._createArray()}]),M$d}(),M$Z=function(){function M$f(){this._matrix=new M$B}M$m(M$f,"laya.webgl.canvas.save.SaveTransform");var M$a=M$f.prototype;return M$w.imps(M$a,{"laya.webgl.canvas.save.ISaveData":!0}),M$a.isSaveMark=function(){return!1},M$a.restore=function(M$a){M$a._curMat=this._savematrix,M$f._no[M$f._no._length++]=this},M$f.save=function(M$a){var M$b=M$a._saveMark;if(2048!=(2048&M$b._saveuse)){M$b._saveuse|=2048;var M$c=M$f._no,M$d=0<M$c._length?M$c[--M$c._length]:new M$f;M$d._savematrix=M$a._curMat,M$a._curMat=M$a._curMat.copyTo(M$d._matrix);var M$e=M$a._save;M$e[M$e._length++]=M$d}},M$g(M$f,["_no",function(){return this._no=M$V._createArray()}]),M$f}(),M$$=function(){function M$e(){}M$m(M$e,"laya.webgl.canvas.save.SaveTranslate");var M$a=M$e.prototype;return M$w.imps(M$a,{"laya.webgl.canvas.save.ISaveData":!0}),M$a.isSaveMark=function(){return!1},M$a.restore=function(M$a){M$a._curMat;M$a._x=this._x,M$a._y=this._y,M$e._no[M$e._no._length++]=this},M$e.save=function(M$a){var M$b=M$e._no,M$c=0<M$b._length?M$b[--M$b._length]:new M$e;M$c._x=M$a._x,M$c._y=M$a._y;var M$d=M$a._save;M$d[M$d._length++]=M$c},M$g(M$e,["_no",function(){return this._no=M$V._createArray()}]),M$e}(),M$_=function(){function M$a(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new M$D}M$m(M$a,"laya.webgl.resource.RenderTargetMAX");var M$b=M$a.prototype;return M$b.setSP=function(M$a){this._sp=M$a},M$b.size=function(M$a,M$b){var M$c=this;this._width!==M$a||this._height!==M$b?(this.repaint=!0,this._width=M$a,this._height=M$b,this.target?this.target.size(M$a,M$b):this.target=M$Ma.create(M$a,M$b),this.target.hasListener("recovered")||this.target.on("recovered",this,function(M$a){M$w.timer.callLater(M$c._sp,M$c._sp.repaint)})):this.target.size(M$a,M$b)},M$b._flushToTarget=function(M$a,M$b){if(!M$b._destroy){var M$c=M$sa.worldScissorTest,M$d=M$sa.worldClipRect;M$sa.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,M$sa.worldScissorTest=!1,M$ua.mainContext.disable(3089);var M$e=M$sa.worldAlpha,M$f=M$sa.worldMatrix4,M$g=M$sa.worldMatrix,M$h=M$sa.worldFilters,M$i=M$sa.worldShaderDefines;if(M$sa.worldMatrix=M$B.EMPTY,M$sa.restoreTempArray(),M$sa.worldMatrix4=M$sa.TEMPMAT4_ARRAY,M$sa.worldAlpha=1,M$sa.worldFilters=null,M$sa.worldShaderDefines=null,M$La.activeShader=null,M$b.start(),M$x.showCanvasMark?M$b.clear(0,1,0,.3):M$b.clear(0,0,0,0),M$a.flush(),M$b.end(),M$La.activeShader=null,M$sa.worldAlpha=M$e,M$sa.worldMatrix4=M$f,M$sa.worldMatrix=M$g,M$sa.worldFilters=M$h,M$sa.worldShaderDefines=M$i,M$sa.worldScissorTest=M$c){var M$j=M$sa.height-M$d.y-M$d.height;M$ua.mainContext.scissor(M$d.x,M$j,M$d.width,M$d.height),M$ua.mainContext.enable(3089)}M$sa.worldClipRect=M$d}},M$b.flush=function(M$a){this.repaint&&(this._flushToTarget(M$a,this.target),this.repaint=!1)},M$b.drawTo=function(M$a,M$b,M$c,M$d,M$e){M$a.drawTexture(this.target.getTexture(),M$b,M$c,M$d,M$e,0,0)},M$b.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},M$a}(),M$y=function(){function M$a(){this.ALPHA=1,this.shaderType=0,this.defines=new M$Ea}return M$m(M$a,"laya.webgl.shader.d2.Shader2D"),M$a.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},M$a.__init__=function(){var M$a,M$b;M$Ya.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),M$Ya.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),M$Ya.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),M$Ya.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),M$Ya.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),M$Ya.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),M$Ya.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),M$Ya.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),M$a="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",M$b='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',M$Ya.preCompile2D(0,1,M$a,M$b,null),M$a="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",M$b='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',M$Ya.preCompile2D(0,2,M$a,M$b,null),M$a="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",M$b="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",M$Ya.preCompile2D(0,4,M$a,M$b,null),M$a="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",M$b='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',M$Ya.preCompile2D(0,256,M$a,M$b,null),M$a="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",M$b="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",M$Ya.preCompile2D(0,512,M$a,M$b,null)},M$a}(),M$z=function(){function M$b(M$a,M$b,M$c){this._value=0,this._name2int=M$a,this._int2name=M$b,this._int2nameMap=M$c}M$m(M$b,"laya.webgl.shader.ShaderDefines");var M$a=M$b.prototype;return M$a.add=function(M$a){return"string"==typeof M$a&&(M$a=this._name2int[M$a]),this._value|=M$a,this._value},M$a.addInt=function(M$a){return this._value|=M$a,this._value},M$a.remove=function(M$a){return"string"==typeof M$a&&(M$a=this._name2int[M$a]),this._value&=~M$a,this._value},M$a.isDefine=function(M$a){return(this._value&M$a)===M$a},M$a.getValue=function(){return this._value},M$a.setValue=function(M$a){this._value=M$a},M$a.toNameDic=function(){var M$a=this._int2nameMap[this._value];return M$a||M$b._toText(this._value,this._int2name,this._int2nameMap)},M$b._reg=function(M$a,M$b,M$c,M$d){M$d[M$c[M$a]=M$b]=M$a},M$b._toText=function(M$a,M$b,M$c){var M$d=M$c[M$a];if(M$d)return M$d;for(var M$e={},M$f=1,M$g=0;M$g<32&&!(M$a<(M$f=1<<M$g));M$g++)if(M$a&M$f){var M$h=M$b[M$f];M$h&&(M$e[M$h]="")}return M$c[M$a]=M$e},M$b._toInt=function(M$a,M$b){for(var M$c=M$a.split("."),M$d=0,M$e=0,M$f=M$c.length;M$e<M$f;M$e++){var M$g=M$b[M$c[M$e]];if(!M$g)throw new Error("Defines to int err:"+M$a+"/"+M$c[M$e]);M$d|=M$g}return M$d},M$b}(),M$aa=function(){function M$g(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new M$B}M$m(M$g,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var M$a=M$g.prototype;return M$a.init=function(M$a,M$b,M$c){if(M$b)this._vs=M$b;else{this._vs=[];var M$d=M$a.width,M$e=M$a.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(M$d,0,1,0,1,1,1,1),this._vs.push(M$d,M$e,1,1,1,1,1,1),this._vs.push(0,M$e,0,1,1,1,1,1)}M$c?this._ps=M$c:(M$g._defaultPS||(M$g._defaultPS=[]).push(0,1,3,3,1,2),this._ps=M$g._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=M$a},M$a.init2=function(M$a,M$b,M$c,M$d,M$e){this.transform&&(this.transform=null),M$c?this._ps=M$c:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=M$d,this._uvs=M$e,this.mEleNum=this._ps.length,this.mTexture=M$a,(M$r.isConchNode||M$r.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},M$a._initMyData=function(){var M$a=0,M$b=0,M$c=4*this._verticles.length;this._vs=M$g._tempVS;var M$d=!1;if(M$r.isConchNode||M$r.isConchApp?(this._vs.length=M$c,M$d=!0):this._vs.length<M$c&&(this._vs.length=M$c,M$d=!0),M$g._tVSLen=M$c,M$d)for(;M$a<M$c;)this._vs[M$a]=this._verticles[M$b],this._vs[M$a+1]=this._verticles[M$b+1],this._vs[M$a+2]=this._uvs[M$b],this._vs[M$a+3]=this._uvs[M$b+1],this._vs[M$a+4]=1,this._vs[M$a+5]=1,this._vs[M$a+6]=1,this._vs[M$a+7]=1,M$a+=8,M$b+=2;else for(;M$a<M$c;)this._vs[M$a]=this._verticles[M$b],this._vs[M$a+1]=this._verticles[M$b+1],this._vs[M$a+2]=this._uvs[M$b],this._vs[M$a+3]=this._uvs[M$b+1],M$a+=8,M$b+=2},M$a.getData2=function(M$a,M$b,M$c){var M$d;this.mVBBuffer=M$a,this.mIBBuffer=M$b,this._initMyData(),M$a.appendEx2(this._vs,Float32Array,M$g._tVSLen,4),this._indexStart=M$b._byteLength,(M$d=M$g._tempIB).length<this._ps.length&&(M$d.length=this._ps.length);for(var M$e=0,M$f=this._ps.length;M$e<M$f;M$e++)M$d[M$e]=this._ps[M$e]+M$c;M$b.appendEx2(M$d,Uint16Array,this._ps.length,2)},M$a.getData=function(M$a,M$b,M$c){if(this.mVBBuffer=M$a,this.mIBBuffer=M$b,M$a.append(this.mVBData),this._indexStart=M$b._byteLength,this.mIBData.start!=M$c){for(var M$d=0,M$e=this._ps.length;M$d<M$e;M$d++)this.mIBData[M$d]=this._ps[M$d]+M$c;this.mIBData.start=M$c}M$b.append(this.mIBData)},M$a.render=function(M$a,M$b,M$c){if(M$r.isWebGL&&this.mTexture){M$a._renderKey=0,M$a._shader2D.glTexture=null,M$ba.getInstance().addSkinMesh(this);var M$d=M$fa.createShape(M$a,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,M$Aa.create(512,0));this.transform||(this.transform=M$B.EMPTY),this.transform.translate(M$b,M$c),M$B.mul(this.transform,M$a._curMat,this._tempMatrix),this.transform.translate(-M$b,-M$c);var M$e=M$d.shaderValue,M$f=M$e.u_mmat2||M$sa.getMatrArray();M$sa.mat2MatArray(this._tempMatrix,M$f),M$e.textureHost=this.mTexture,M$e.offsetX=0,M$e.offsetY=0,M$e.u_mmat2=M$f,M$e.ALPHA=M$a._shader2D.ALPHA,M$a._submits[M$a._submits._length++]=M$d}else M$r.isConchApp&&this.mTexture&&(this.transform||(this.transform=M$B.EMPTY),M$a.setSkinMesh&&M$a.setSkinMesh(M$b,M$c,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},M$g._tempVS=[],M$g._tempIB=[],M$g._defaultPS=null,M$g._tVSLen=0,M$g}(),M$ba=function(){function M$a(){this.ib=null,this.vb=null;M$ua.mainContext;this.ib=M$ya.create(35048),this.vb=M$za.create(8)}M$m(M$a,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var M$b=M$a.prototype;return M$b.addSkinMesh=function(M$a){M$a.getData2(this.vb,this.ib,this.vb._byteLength/32)},M$b.reset=function(){this.vb.clear(),this.ib.clear()},M$a.getInstance=function(){return M$a.instance=M$a.instance||new M$a},M$a.instance=null,M$a}(),M$ca=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===M$i&&(M$i=0),this.x=M$a,this.y=M$b,this.width=M$c,this.height=M$d,this.edges=M$e,this.color=M$f,this.borderWidth=M$g,this.borderColor=M$h}M$m(M$a,"laya.webgl.shapes.BasePoly");var M$b=M$a.prototype;return M$w.imps(M$b,{"laya.webgl.shapes.IShape":!0}),M$b.getData=function(M$a,M$b,M$c){},M$b.rebuild=function(M$a){},M$b.setMatrix=function(M$a){},M$b.needUpdate=function(M$a){return!0},M$b.sector=function(M$a,M$b,M$c){var M$d=this.x,M$e=this.y,M$f=this.edges,M$g=(this.r1-this.r0)/M$f,M$h=this.width,M$i=this.height,M$j=this.color,M$k=(M$j>>16&255)/255,M$l=(M$j>>8&255)/255,M$m=(255&M$j)/255;M$a.push(M$d,M$e,M$k,M$l,M$m);for(var M$n=0;M$n<M$f+1;M$n++)M$a.push(M$d+Math.sin(M$g*M$n+this.r0)*M$h,M$e+Math.cos(M$g*M$n+this.r0)*M$i),M$a.push(M$k,M$l,M$m);for(M$n=0;M$n<M$f;M$n++)M$b.push(M$c,M$c+M$n+1,M$c+M$n+2)},M$b.createLine2=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g,M$h,M$i,M$j,M$k,M$l,M$m,M$n,M$o,M$p,M$q,M$r,M$s,M$t,M$u,M$v,M$w,M$x,M$A,M$B,M$C=M$a.concat(),M$D=M$e,M$E=this.borderColor,M$F=(M$E>>16&255)/255,M$G=(M$E>>8&255)/255,M$H=(255&M$E)/255,M$I=M$C.length/2,M$J=M$d,M$K=M$c/2;M$i=M$C[0],M$j=M$C[1],M$p=M$i-(M$k=M$C[2]),M$o=(M$o=-(M$j-(M$l=M$C[3])))/(M$B=Math.sqrt(M$o*M$o+M$p*M$p))*M$K,M$p=M$p/M$B*M$K,M$D.push(M$i-M$o+this.x,M$j-M$p+this.y,M$F,M$G,M$H,M$i+M$o+this.x,M$j+M$p+this.y,M$F,M$G,M$H);for(var M$L=1;M$L<M$I-1;M$L++)M$i=M$C[2*(M$L-1)],M$j=M$C[2*(M$L-1)+1],M$k=M$C[2*M$L],M$l=M$C[2*M$L+1],M$m=M$C[2*(M$L+1)],M$n=M$C[2*(M$L+1)+1],M$p=M$i-M$k,M$r=M$k-M$m,M$u=(-(M$o=(M$o=-(M$j-M$l))/(M$B=Math.sqrt(M$o*M$o+M$p*M$p))*M$K)+M$i)*(-(M$p=M$p/M$B*M$K)+M$l)-(-M$o+M$k)*(-M$p+M$j),M$x=(-(M$q=(M$q=-(M$l-M$n))/(M$B=Math.sqrt(M$q*M$q+M$r*M$r))*M$K)+M$m)*(-(M$r=M$r/M$B*M$K)+M$l)-(-M$q+M$k)*(-M$r+M$n),M$A=(M$s=-M$p+M$j-(-M$p+M$l))*(M$w=-M$q+M$k-(-M$q+M$m))-(M$v=-M$r+M$n-(-M$r+M$l))*(M$t=-M$o+M$k-(-M$o+M$i)),Math.abs(M$A)<.1?(M$A+=10.1,M$D.push(M$k-M$o+this.x,M$l-M$p+this.y,M$F,M$G,M$H,M$k+M$o+this.x,M$l+M$p+this.y,M$F,M$G,M$H)):(((M$g=(M$t*M$x-M$w*M$u)/M$A)-M$k)*(M$g-M$k)+((M$h=(M$v*M$u-M$s*M$x)/M$A)-M$l)+(M$h-M$l),M$D.push(M$g+this.x,M$h+this.y,M$F,M$G,M$H,M$k-(M$g-M$k)+this.x,M$l-(M$h-M$l)+this.y,M$F,M$G,M$H));M$i=M$C[M$C.length-4],M$j=M$C[M$C.length-3],M$p=M$i-(M$k=M$C[M$C.length-2]),M$o=(M$o=-(M$j-(M$l=M$C[M$C.length-1])))/(M$B=Math.sqrt(M$o*M$o+M$p*M$p))*M$K,M$p=M$p/M$B*M$K,M$D.push(M$k-M$o+this.x,M$l-M$p+this.y,M$F,M$G,M$H,M$k+M$o+this.x,M$l+M$p+this.y,M$F,M$G,M$H);var M$M=M$f;for(M$L=1;M$L<M$M;M$L++)M$b.push(M$J+2*(M$L-1),M$J+2*(M$L-1)+1,M$J+2*M$L+1,M$J+2*M$L+1,M$J+2*M$L,M$J+2*(M$L-1));return M$D},M$b.createLine=function(M$a,M$b,M$c,M$d){var M$e=M$a.concat(),M$f=M$a,M$g=this.borderColor,M$h=(M$g>>16&255)/255,M$i=(M$g>>8&255)/255,M$j=(255&M$g)/255;M$e.splice(0,5);var M$k,M$l,M$m,M$n,M$o,M$p,M$q,M$r,M$s,M$t,M$u,M$v,M$w,M$x,M$A,M$B,M$C,M$D,M$E,M$F,M$G=M$e.length/5,M$H=M$d,M$I=M$c/2;M$m=M$e[0],M$n=M$e[1],M$t=M$m-(M$o=M$e[5]),M$s=(M$s=-(M$n-(M$p=M$e[6])))/(M$F=Math.sqrt(M$s*M$s+M$t*M$t))*M$I,M$t=M$t/M$F*M$I,M$f.push(M$m-M$s,M$n-M$t,M$h,M$i,M$j,M$m+M$s,M$n+M$t,M$h,M$i,M$j);for(var M$J=1;M$J<M$G-1;M$J++)M$m=M$e[5*(M$J-1)],M$n=M$e[5*(M$J-1)+1],M$o=M$e[5*M$J],M$p=M$e[5*M$J+1],M$q=M$e[5*(M$J+1)],M$r=M$e[5*(M$J+1)+1],M$t=M$m-M$o,M$v=M$o-M$q,M$A=(-(M$s=(M$s=-(M$n-M$p))/(M$F=Math.sqrt(M$s*M$s+M$t*M$t))*M$I)+M$m)*(-(M$t=M$t/M$F*M$I)+M$p)-(-M$s+M$o)*(-M$t+M$n),M$D=(-(M$u=(M$u=-(M$p-M$r))/(M$F=Math.sqrt(M$u*M$u+M$v*M$v))*M$I)+M$q)*(-(M$v=M$v/M$F*M$I)+M$p)-(-M$u+M$o)*(-M$v+M$r),M$E=(M$w=-M$t+M$n-(-M$t+M$p))*(M$C=-M$u+M$o-(-M$u+M$q))-(M$B=-M$v+M$r-(-M$v+M$p))*(M$x=-M$s+M$o-(-M$s+M$m)),Math.abs(M$E)<.1?(M$E+=10.1,M$f.push(M$o-M$s,M$p-M$t,M$h,M$i,M$j,M$o+M$s,M$p+M$t,M$h,M$i,M$j)):(((M$k=(M$x*M$D-M$C*M$A)/M$E)-M$o)*(M$k-M$o)+((M$l=(M$B*M$A-M$w*M$D)/M$E)-M$p)+(M$l-M$p),M$f.push(M$k,M$l,M$h,M$i,M$j,M$o-(M$k-M$o),M$p-(M$l-M$p),M$h,M$i,M$j));M$m=M$e[M$e.length-10],M$n=M$e[M$e.length-9],M$t=M$m-(M$o=M$e[M$e.length-5]),M$s=(M$s=-(M$n-(M$p=M$e[M$e.length-4])))/(M$F=Math.sqrt(M$s*M$s+M$t*M$t))*M$I,M$t=M$t/M$F*M$I,M$f.push(M$o-M$s,M$p-M$t,M$h,M$i,M$j,M$o+M$s,M$p+M$t,M$h,M$i,M$j);var M$K=this.edges+1;for(M$J=1;M$J<M$K;M$J++)M$b.push(M$H+2*(M$J-1),M$H+2*(M$J-1)+1,M$H+2*M$J+1,M$H+2*M$J+1,M$H+2*M$J,M$H+2*(M$J-1));return M$f},M$b.createLoopLine=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=M$a.concat(),M$h=M$e||M$a,M$i=this.borderColor,M$j=(M$i>>16&255)/255,M$k=(M$i>>8&255)/255,M$l=(255&M$i)/255;M$g.splice(0,5);var M$m=[M$g[0],M$g[1]],M$n=[M$g[M$g.length-5],M$g[M$g.length-4]],M$o=M$n[0]+.5*(M$m[0]-M$n[0]),M$p=M$n[1]+.5*(M$m[1]-M$n[1]);M$g.unshift(M$o,M$p,0,0,0),M$g.push(M$o,M$p,0,0,0);var M$q,M$r,M$s,M$t,M$u,M$v,M$w,M$x,M$A,M$B,M$C,M$D,M$E,M$F,M$G,M$H,M$I,M$J,M$K,M$L,M$M=M$g.length/5,M$N=M$d,M$O=M$c/2;M$s=M$g[0],M$t=M$g[1],M$B=M$s-(M$u=M$g[5]),M$A=(M$A=-(M$t-(M$v=M$g[6])))/(M$L=Math.sqrt(M$A*M$A+M$B*M$B))*M$O,M$B=M$B/M$L*M$O,M$h.push(M$s-M$A,M$t-M$B,M$j,M$k,M$l,M$s+M$A,M$t+M$B,M$j,M$k,M$l);for(var M$P=1;M$P<M$M-1;M$P++)M$s=M$g[5*(M$P-1)],M$t=M$g[5*(M$P-1)+1],M$u=M$g[5*M$P],M$v=M$g[5*M$P+1],M$w=M$g[5*(M$P+1)],M$x=M$g[5*(M$P+1)+1],M$B=M$s-M$u,M$D=M$u-M$w,M$G=(-(M$A=(M$A=-(M$t-M$v))/(M$L=Math.sqrt(M$A*M$A+M$B*M$B))*M$O)+M$s)*(-(M$B=M$B/M$L*M$O)+M$v)-(-M$A+M$u)*(-M$B+M$t),M$J=(-(M$C=(M$C=-(M$v-M$x))/(M$L=Math.sqrt(M$C*M$C+M$D*M$D))*M$O)+M$w)*(-(M$D=M$D/M$L*M$O)+M$v)-(-M$C+M$u)*(-M$D+M$x),M$K=(M$E=-M$B+M$t-(-M$B+M$v))*(M$I=-M$C+M$u-(-M$C+M$w))-(M$H=-M$D+M$x-(-M$D+M$v))*(M$F=-M$A+M$u-(-M$A+M$s)),Math.abs(M$K)<.1?(M$K+=10.1,M$h.push(M$u-M$A,M$v-M$B,M$j,M$k,M$l,M$u+M$A,M$v+M$B,M$j,M$k,M$l)):(((M$q=(M$F*M$J-M$I*M$G)/M$K)-M$u)*(M$q-M$u)+((M$r=(M$H*M$G-M$E*M$J)/M$K)-M$v)+(M$r-M$v),M$h.push(M$q,M$r,M$j,M$k,M$l,M$u-(M$q-M$u),M$v-(M$r-M$v),M$j,M$k,M$l));M$f&&(M$b=M$f);var M$Q=this.edges+1;for(M$P=1;M$P<M$Q;M$P++)M$b.push(M$N+2*(M$P-1),M$N+2*(M$P-1)+1,M$N+2*M$P+1,M$N+2*M$P+1,M$N+2*M$P,M$N+2*(M$P-1));return M$b.push(M$N+2*(M$P-1),M$N+2*(M$P-1)+1,M$N+1,M$N+1,M$N,M$N+2*(M$P-1)),M$h},M$a}(),M$da=function(){function M$p(){}return M$m(M$p,"laya.webgl.shapes.Earcut"),M$p.earcut=function(M$a,M$b,M$c){M$c=M$c||2;var M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k=M$b&&M$b.length,M$l=M$k?M$b[0]*M$c:M$a.length,M$m=M$p.linkedList(M$a,0,M$l,M$c,!0),M$n=[];if(!M$m)return M$n;if(M$k&&(M$m=M$p.eliminateHoles(M$a,M$b,M$m,M$c)),M$a.length>80*M$c){M$d=M$f=M$a[0],M$e=M$g=M$a[1];for(var M$o=M$c;M$o<M$l;M$o+=M$c)(M$h=M$a[M$o])<M$d&&(M$d=M$h),(M$i=M$a[M$o+1])<M$e&&(M$e=M$i),M$f<M$h&&(M$f=M$h),M$g<M$i&&(M$g=M$i);M$j=0!==(M$j=Math.max(M$f-M$d,M$g-M$e))?1/M$j:0}return M$p.earcutLinked(M$m,M$n,M$c,M$d,M$e,M$j),M$n},M$p.linkedList=function(M$a,M$b,M$c,M$d,M$e){var M$f,M$g;if(M$e===0<M$p.signedArea(M$a,M$b,M$c,M$d))for(M$f=M$b;M$f<M$c;M$f+=M$d)M$g=M$p.insertNode(M$f,M$a[M$f],M$a[M$f+1],M$g);else for(M$f=M$c-M$d;M$b<=M$f;M$f-=M$d)M$g=M$p.insertNode(M$f,M$a[M$f],M$a[M$f+1],M$g);return M$g&&M$p.equals(M$g,M$g.next)&&(M$p.removeNode(M$g),M$g=M$g.next),M$g},M$p.filterPoints=function(M$a,M$b){if(!M$a)return M$a;M$b||(M$b=M$a);var M$c,M$d=M$a;do{if(M$c=!1,M$d.steiner||!M$p.equals(M$d,M$d.next)&&0!==M$p.area(M$d.prev,M$d,M$d.next))M$d=M$d.next;else{if(M$p.removeNode(M$d),(M$d=M$b=M$d.prev)===M$d.next)break;M$c=!0}}while(M$c||M$d!==M$b);return M$b},M$p.earcutLinked=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){if(M$a){!M$g&&M$f&&M$p.indexCurve(M$a,M$d,M$e,M$f);for(var M$h,M$i,M$j=M$a;M$a.prev!==M$a.next;)if(M$h=M$a.prev,M$i=M$a.next,M$f?M$p.isEarHashed(M$a,M$d,M$e,M$f):M$p.isEar(M$a))M$b.push(M$h.i/M$c),M$b.push(M$a.i/M$c),M$b.push(M$i.i/M$c),M$p.removeNode(M$a),M$a=M$i.next,M$j=M$i.next;else if((M$a=M$i)===M$j){M$g?1===M$g?(M$a=M$p.cureLocalIntersections(M$a,M$b,M$c),M$p.earcutLinked(M$a,M$b,M$c,M$d,M$e,M$f,2)):2===M$g&&M$p.splitEarcut(M$a,M$b,M$c,M$d,M$e,M$f):M$p.earcutLinked(M$p.filterPoints(M$a,null),M$b,M$c,M$d,M$e,M$f,1);break}}},M$p.isEar=function(M$a){var M$b=M$a.prev,M$c=M$a,M$d=M$a.next;if(0<=M$p.area(M$b,M$c,M$d))return!1;for(var M$e=M$a.next.next;M$e!==M$a.prev;){if(M$p.pointInTriangle(M$b.x,M$b.y,M$c.x,M$c.y,M$d.x,M$d.y,M$e.x,M$e.y)&&0<=M$p.area(M$e.prev,M$e,M$e.next))return!1;M$e=M$e.next}return!0},M$p.isEarHashed=function(M$a,M$b,M$c,M$d){var M$e=M$a.prev,M$f=M$a,M$g=M$a.next;if(0<=M$p.area(M$e,M$f,M$g))return!1;for(var M$h=M$e.x<M$f.x?M$e.x<M$g.x?M$e.x:M$g.x:M$f.x<M$g.x?M$f.x:M$g.x,M$i=M$e.y<M$f.y?M$e.y<M$g.y?M$e.y:M$g.y:M$f.y<M$g.y?M$f.y:M$g.y,M$j=M$e.x>M$f.x?M$e.x>M$g.x?M$e.x:M$g.x:M$f.x>M$g.x?M$f.x:M$g.x,M$k=M$e.y>M$f.y?M$e.y>M$g.y?M$e.y:M$g.y:M$f.y>M$g.y?M$f.y:M$g.y,M$l=M$p.zOrder(M$h,M$i,M$b,M$c,M$d),M$m=M$p.zOrder(M$j,M$k,M$b,M$c,M$d),M$n=M$a.nextZ;M$n&&M$n.z<=M$m;){if(M$n!==M$a.prev&&M$n!==M$a.next&&M$p.pointInTriangle(M$e.x,M$e.y,M$f.x,M$f.y,M$g.x,M$g.y,M$n.x,M$n.y)&&0<=M$p.area(M$n.prev,M$n,M$n.next))return!1;M$n=M$n.nextZ}for(M$n=M$a.prevZ;M$n&&M$n.z>=M$l;){if(M$n!==M$a.prev&&M$n!==M$a.next&&M$p.pointInTriangle(M$e.x,M$e.y,M$f.x,M$f.y,M$g.x,M$g.y,M$n.x,M$n.y)&&0<=M$p.area(M$n.prev,M$n,M$n.next))return!1;M$n=M$n.prevZ}return!0},M$p.cureLocalIntersections=function(M$a,M$b,M$c){var M$d=M$a;do{var M$e=M$d.prev,M$f=M$d.next.next;!M$p.equals(M$e,M$f)&&M$p.intersects(M$e,M$d,M$d.next,M$f)&&M$p.locallyInside(M$e,M$f)&&M$p.locallyInside(M$f,M$e)&&(M$b.push(M$e.i/M$c),M$b.push(M$d.i/M$c),M$b.push(M$f.i/M$c),M$p.removeNode(M$d),M$p.removeNode(M$d.next),M$d=M$a=M$f),M$d=M$d.next}while(M$d!==M$a);return M$d},M$p.splitEarcut=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=M$a;do{for(var M$h=M$g.next.next;M$h!==M$g.prev;){if(M$g.i!==M$h.i&&M$p.isValidDiagonal(M$g,M$h)){var M$i=M$p.splitPolygon(M$g,M$h);return M$g=M$p.filterPoints(M$g,M$g.next),M$i=M$p.filterPoints(M$i,M$i.next),M$p.earcutLinked(M$g,M$b,M$c,M$d,M$e,M$f),void M$p.earcutLinked(M$i,M$b,M$c,M$d,M$e,M$f)}M$h=M$h.next}M$g=M$g.next}while(M$g!==M$a)},M$p.eliminateHoles=function(M$a,M$b,M$c,M$d){var M$e,M$f,M$g,M$h,M$i,M$j=[];for(M$e=0,M$f=M$b.length;M$e<M$f;M$e++)M$g=M$b[M$e]*M$d,M$h=M$e<M$f-1?M$b[M$e+1]*M$d:M$a.length,(M$i=M$p.linkedList(M$a,M$g,M$h,M$d,!1))===M$i.next&&(M$i.steiner=!0),M$j.push(M$p.getLeftmost(M$i));for(M$j.sort(M$p.compareX),M$e=0;M$e<M$j.length;M$e++)M$p.eliminateHole(M$j[M$e],M$c),M$c=M$p.filterPoints(M$c,M$c.next);return M$c},M$p.compareX=function(M$a,M$b){return M$a.x-M$b.x},M$p.eliminateHole=function(M$a,M$b){if(M$b=M$p.findHoleBridge(M$a,M$b)){var M$c=M$p.splitPolygon(M$b,M$a);M$p.filterPoints(M$c,M$c.next)}},M$p.findHoleBridge=function(M$a,M$b){var M$c,M$d=M$b,M$e=M$a.x,M$f=M$a.y,M$g=-1/0;do{if(M$f<=M$d.y&&M$f>=M$d.next.y&&M$d.next.y!==M$d.y){var M$h=M$d.x+(M$f-M$d.y)*(M$d.next.x-M$d.x)/(M$d.next.y-M$d.y);if(M$h<=M$e&&M$g<M$h){if((M$g=M$h)===M$e){if(M$f===M$d.y)return M$d;if(M$f===M$d.next.y)return M$d.next}M$c=M$d.x<M$d.next.x?M$d:M$d.next}}M$d=M$d.next}while(M$d!==M$b);if(!M$c)return null;if(M$e===M$g)return M$c.prev;var M$i,M$j=M$c,M$k=M$c.x,M$l=M$c.y,M$m=1/0;for(M$d=M$c.next;M$d!==M$j;)M$e>=M$d.x&&M$d.x>=M$k&&M$e!==M$d.x&&M$p.pointInTriangle(M$f<M$l?M$e:M$g,M$f,M$k,M$l,M$f<M$l?M$g:M$e,M$f,M$d.x,M$d.y)&&((M$i=Math.abs(M$f-M$d.y)/(M$e-M$d.x))<M$m||M$i===M$m&&M$d.x>M$c.x)&&M$p.locallyInside(M$d,M$a)&&(M$c=M$d,M$m=M$i),M$d=M$d.next;return M$c},M$p.indexCurve=function(M$a,M$b,M$c,M$d){for(var M$e=M$a;null===M$e.z&&(M$e.z=M$p.zOrder(M$e.x,M$e.y,M$b,M$c,M$d)),M$e.prevZ=M$e.prev,M$e.nextZ=M$e.next,(M$e=M$e.next)!==M$a;);M$e.prevZ.nextZ=null,M$e.prevZ=null,M$p.sortLinked(M$e)},M$p.sortLinked=function(M$a){var M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j=1;do{for(M$c=M$a,M$f=M$a=null,M$g=0;M$c;){for(M$g++,M$d=M$c,M$b=M$h=0;M$b<M$j&&(M$h++,M$d=M$d.nextZ);M$b++);for(M$i=M$j;0<M$h||0<M$i&&M$d;)0!==M$h&&(0===M$i||!M$d||M$c.z<=M$d.z)?(M$c=(M$e=M$c).nextZ,M$h--):(M$d=(M$e=M$d).nextZ,M$i--),M$f?M$f.nextZ=M$e:M$a=M$e,M$e.prevZ=M$f,M$f=M$e;M$c=M$d}M$f.nextZ=null,M$j*=2}while(1<M$g);return M$a},M$p.zOrder=function(M$a,M$b,M$c,M$d,M$e){return(M$a=1431655765&((M$a=858993459&((M$a=252645135&((M$a=16711935&((M$a=32767*(M$a-M$c)*M$e)|M$a<<8))|M$a<<4))|M$a<<2))|M$a<<1))|(M$b=1431655765&((M$b=858993459&((M$b=252645135&((M$b=16711935&((M$b=32767*(M$b-M$d)*M$e)|M$b<<8))|M$b<<4))|M$b<<2))|M$b<<1))<<1},M$p.getLeftmost=function(M$a){for(var M$b=M$a,M$c=M$a;M$b.x<M$c.x&&(M$c=M$b),(M$b=M$b.next)!==M$a;);return M$c},M$p.pointInTriangle=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){return 0<=(M$e-M$g)*(M$b-M$h)-(M$a-M$g)*(M$f-M$h)&&0<=(M$a-M$g)*(M$d-M$h)-(M$c-M$g)*(M$b-M$h)&&0<=(M$c-M$g)*(M$f-M$h)-(M$e-M$g)*(M$d-M$h)},M$p.isValidDiagonal=function(M$a,M$b){return M$a.next.i!==M$b.i&&M$a.prev.i!==M$b.i&&!M$p.intersectsPolygon(M$a,M$b)&&M$p.locallyInside(M$a,M$b)&&M$p.locallyInside(M$b,M$a)&&M$p.middleInside(M$a,M$b)},M$p.area=function(M$a,M$b,M$c){return(M$b.y-M$a.y)*(M$c.x-M$b.x)-(M$b.x-M$a.x)*(M$c.y-M$b.y)},M$p.equals=function(M$a,M$b){return M$a.x===M$b.x&&M$a.y===M$b.y},M$p.intersects=function(M$a,M$b,M$c,M$d){return!!(M$p.equals(M$a,M$b)&&M$p.equals(M$c,M$d)||M$p.equals(M$a,M$d)&&M$p.equals(M$c,M$b))||0<M$p.area(M$a,M$b,M$c)!=0<M$p.area(M$a,M$b,M$d)&&0<M$p.area(M$c,M$d,M$a)!=0<M$p.area(M$c,M$d,M$b)},M$p.intersectsPolygon=function(M$a,M$b){var M$c=M$a;do{if(M$c.i!==M$a.i&&M$c.next.i!==M$a.i&&M$c.i!==M$b.i&&M$c.next.i!==M$b.i&&M$p.intersects(M$c,M$c.next,M$a,M$b))return!0;M$c=M$c.next}while(M$c!==M$a);return!1},M$p.locallyInside=function(M$a,M$b){return M$p.area(M$a.prev,M$a,M$a.next)<0?0<=M$p.area(M$a,M$b,M$a.next)&&0<=M$p.area(M$a,M$a.prev,M$b):M$p.area(M$a,M$b,M$a.prev)<0||M$p.area(M$a,M$a.next,M$b)<0},M$p.middleInside=function(M$a,M$b){for(var M$c=M$a,M$d=!1,M$e=(M$a.x+M$b.x)/2,M$f=(M$a.y+M$b.y)/2;M$c.y>M$f!=M$c.next.y>M$f&&M$c.next.y!==M$c.y&&M$e<(M$c.next.x-M$c.x)*(M$f-M$c.y)/(M$c.next.y-M$c.y)+M$c.x&&(M$d=!M$d),(M$c=M$c.next)!==M$a;);return M$d},M$p.splitPolygon=function(M$a,M$b){var M$c=new M$ea(M$a.i,M$a.x,M$a.y),M$d=new M$ea(M$b.i,M$b.x,M$b.y),M$e=M$a.next,M$f=M$b.prev;return(M$a.next=M$b).prev=M$a,(M$c.next=M$e).prev=M$c,(M$d.next=M$c).prev=M$d,(M$f.next=M$d).prev=M$f,M$d},M$p.insertNode=function(M$a,M$b,M$c,M$d){var M$e=new M$ea(M$a,M$b,M$c);return M$d?(M$e.next=M$d.next,(M$e.prev=M$d).next.prev=M$e,M$d.next=M$e):(M$e.prev=M$e).next=M$e,M$e},M$p.removeNode=function(M$a){M$a.next.prev=M$a.prev,M$a.prev.next=M$a.next,M$a.prevZ&&(M$a.prevZ.nextZ=M$a.nextZ),M$a.nextZ&&(M$a.nextZ.prevZ=M$a.prevZ)},M$p.signedArea=function(M$a,M$b,M$c,M$d){for(var M$e=0,M$f=M$b,M$g=M$c-M$d;M$f<M$c;M$f+=M$d)M$e+=(M$a[M$g]-M$a[M$f])*(M$a[M$f+1]+M$a[M$g+1]),M$g=M$f;return M$e},M$p}(),M$ea=function(){function M$a(M$a,M$b,M$c){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=M$a,this.x=M$b,this.y=M$c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return M$m(M$a,"laya.webgl.shapes.EarcutNode"),M$a}(),M$fa=(function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this.lineWidth=M$a,this.lineColor=M$b,this.lineAlpha=M$c,this.fillColor=M$d,this.fillAlpha=M$e,this.shape=M$g,this.fill=M$f}M$m(M$a,"laya.webgl.shapes.GeometryData");var M$b=M$a.prototype;M$b.clone=function(){return new M$a(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},M$b.getIndexData=function(){return null},M$b.getVertexData=function(){return null},M$b.destroy=function(){this.shape=null}}(),function(){function M$a(M$a){if(M$a instanceof Float32Array)this.points=M$a;else if(M$a instanceof Array){M$a.length;this.points=new Float32Array(M$a)}}M$m(M$a,"laya.webgl.shapes.Vertex");var M$b=M$a.prototype;M$w.imps(M$b,{"laya.webgl.shapes.IShape":!0}),M$b.getData=function(M$a,M$b,M$c){},M$b.needUpdate=function(M$a){return!1},M$b.rebuild=function(M$a){},M$b.setMatrix=function(M$a){}}(),function(){function M$i(M$a){void 0===M$a&&(M$a=1e4),this._renderType=M$a}M$m(M$i,"laya.webgl.submit.Submit");var M$a=M$i.prototype;return M$w.imps(M$a,{"laya.webgl.submit.ISubmit":!0}),M$a.releaseRender=function(){var M$a=M$i._cache;(M$a[M$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},M$a.getRenderType=function(){return this._renderType},M$a.renderSubmit=function(){if(0===this._numEle)return 1;var M$a=this.shaderValue.textureHost;if(M$a){var M$b=M$a.source;if(!M$a.bitmap||!M$b)return 1;this.shaderValue.texture=M$b,M$a.alphaTexture&&M$a.alphaTexture.source&&(this.shaderValue.texture1=M$a.alphaTexture.source)}this._vb.bind_upload(this._ib);var M$c=M$ua.mainContext;return this.shaderValue.upload(),M$S.activeBlendFunction!==this._blendFn&&(M$c.enable(3042),this._blendFn(M$c),M$S.activeBlendFunction=this._blendFn),M$G.drawCall++,M$G.trianglesFaces+=this._numEle/3,M$c.drawElements(4,this._numEle,5123,this._startIdx),1},M$i.__init__=function(){var M$a=M$i.RENDERBASE=new M$i(-1);M$a.shaderValue=new M$Aa(0,0),M$a.shaderValue.ALPHA=-1234},M$i.createSubmit=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$i._cache._length?M$i._cache[--M$i._cache._length]:new M$i;null==M$c&&((M$c=M$f._selfVb||(M$f._selfVb=M$za.create(-1))).clear(),M$d=0),M$f._ib=M$b,M$f._vb=M$c,M$f._startIdx=M$d*M$pa.BYTES_PIDX,M$f._numEle=0;var M$g=M$a._nBlendType;M$f._blendFn=M$a._targets?M$S.targetFns[M$g]:M$S.fns[M$g],M$f.shaderValue=M$e,M$f.shaderValue.setValue(M$a._shader2D);var M$h=M$a._shader2D.filters;return M$h&&M$f.shaderValue.setFilters(M$h),M$f},M$i.createShape=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=M$i._cache._length?M$i._cache[--M$i._cache._length]:new M$i;M$g._ib=M$b,M$g._vb=M$c,M$g._numEle=M$d,M$g._startIdx=M$e,M$g.shaderValue=M$f,M$g.shaderValue.setValue(M$a._shader2D);var M$h=M$a._nBlendType;return M$g._blendFn=M$a._targets?M$S.targetFns[M$h]:M$S.fns[M$h],M$g},M$i.TYPE_2D=1e4,M$i.TYPE_CANVAS=10003,M$i.TYPE_CMDSETRT=10004,M$i.TYPE_CUSTOM=10005,M$i.TYPE_BLURRT=10006,M$i.TYPE_CMDDESTORYPRERT=10007,M$i.TYPE_DISABLESTENCIL=10008,M$i.TYPE_OTHERIBVB=10009,M$i.TYPE_PRIMITIVE=10010,M$i.TYPE_RT=10011,M$i.TYPE_BLUR_RT=10012,M$i.TYPE_TARGET=10013,M$i.TYPE_CHANGE_VALUE=10014,M$i.TYPE_SHAPE=10015,M$i.TYPE_TEXTURE=10016,M$i.TYPE_FILLTEXTURE=10017,M$i.RENDERBASE=null,M$i._cache=((M$i._cache=[])._length=0,M$i._cache),M$i}()),M$ga=function(){function M$d(){this.fun=null,this.args=null}M$m(M$d,"laya.webgl.submit.SubmitCMD");var M$a=M$d.prototype;return M$w.imps(M$a,{"laya.webgl.submit.ISubmit":!0}),M$a.renderSubmit=function(){return this.fun.apply(null,this.args),1},M$a.getRenderType=function(){return 0},M$a.releaseRender=function(){var M$a=M$d._cache;M$a[M$a._length++]=this},M$d.create=function(M$a,M$b){var M$c=M$d._cache._length?M$d._cache[--M$d._cache._length]:new M$d;return M$c.fun=M$b,M$c.args=M$a,M$c},M$d._cache=((M$d._cache=[])._length=0,M$d._cache),M$d}(),M$ha=function(){function M$b(){this.variables={}}M$m(M$b,"laya.webgl.submit.SubmitCMDScope");var M$a=M$b.prototype;return M$a.getValue=function(M$a){return this.variables[M$a]},M$a.addValue=function(M$a,M$b){return this.variables[M$a]=M$b},M$a.setValue=function(M$a,M$b){return this.variables.hasOwnProperty(M$a)?this.variables[M$a]=M$b:null},M$a.clear=function(){for(var M$a in this.variables)delete this.variables[M$a]},M$a.recycle=function(){this.clear(),M$b.POOL.push(this)},M$b.create=function(){var M$a=M$b.POOL.pop();return M$a||(M$a=new M$b),M$a},M$b.POOL=[],M$b}(),M$ia=function(){function M$l(){this.offset=0,this.startIndex=0,this._mat=M$B.create()}M$m(M$l,"laya.webgl.submit.SubmitOtherIBVB");var M$a=M$l.prototype;return M$w.imps(M$a,{"laya.webgl.submit.ISubmit":!0}),M$a.releaseRender=function(){var M$a=M$l._cache;(M$a[M$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},M$a.getRenderType=function(){return 10009},M$a.renderSubmit=function(){var M$a=this._shaderValue.textureHost;if(M$a){var M$b=M$a.source;if(!M$a.bitmap||!M$b)return 1;this._shaderValue.texture=M$b}this._vb.bind_upload(this._ib);var M$c=M$sa.worldMatrix4,M$d=M$B.TEMP;M$B.mulPre(this._mat,M$c[0],M$c[1],M$c[4],M$c[5],M$c[12],M$c[13],M$d);var M$e=M$sa.worldMatrix4=M$l.tempMatrix4;M$e[0]=M$d.a,M$e[1]=M$d.b,M$e[4]=M$d.c,M$e[5]=M$d.d,M$e[12]=M$d.tx,M$e[13]=M$d.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var M$f=M$ua.mainContext;return M$S.activeBlendFunction!==this._blendFn&&(M$f.enable(3042),this._blendFn(M$f),M$S.activeBlendFunction=this._blendFn),M$G.drawCall++,M$G.trianglesFaces+=this._numEle/3,M$f.drawElements(4,this._numEle,5123,this.startIndex),M$sa.worldMatrix4=M$c,M$La.activeShader=null,1},M$l.create=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){void 0===M$i&&(M$i=0);var M$j=M$l._cache._length?M$l._cache[--M$l._cache._length]:new M$l;M$j._ib=M$c,M$j._vb=M$b,M$j._numEle=M$d,M$j._shader=M$e,M$j._shaderValue=M$f;var M$k=M$a._nBlendType;switch(M$j._blendFn=M$a._targets?M$S.targetFns[M$k]:M$S.fns[M$k],M$i){case 0:M$j.offset=0,M$j.startIndex=M$h/(M$pa.BYTES_PE*M$b.vertexStride)*1.5,M$j.startIndex*=M$pa.BYTES_PIDX;break;case 1:M$j.startIndex=M$g,M$j.offset=M$h}return M$j},M$l._cache=((M$l._cache=[])._length=0,M$l._cache),M$l.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],M$l}(),M$ja=function(){function M$c(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new M$D,this.screenRect=new M$D}M$m(M$c,"laya.webgl.submit.SubmitScissor");var M$a=M$c.prototype;return M$w.imps(M$a,{"laya.webgl.submit.ISubmit":!0}),M$a._scissor=function(M$a,M$b,M$c,M$d){var M$e=M$sa.worldMatrix4,M$f=M$e[0],M$g=M$e[5],M$h=M$e[12],M$i=M$e[13];if(M$d*=M$g,(M$c*=M$f)<1||M$d<1)return!1;var M$j=(M$a=M$a*M$f+M$h)+M$c,M$k=(M$b=M$b*M$g+M$i)+M$d;M$a<0&&(M$c=M$j-(M$a=0)),M$b<0&&(M$d=M$k-(M$b=0));var M$l=M$sa.worldClipRect;if(M$a=Math.max(M$a,M$l.x),M$b=Math.max(M$b,M$l.y),M$c=Math.min(M$j,M$l.right)-M$a,M$d=Math.min(M$k,M$l.bottom)-M$b,M$c<1||M$d<1)return!1;var M$m=M$sa.worldScissorTest;return this.screenRect.copyFrom(M$l),M$l.x=M$a,M$l.y=M$b,M$l.width=M$c,M$l.height=M$d,M$sa.worldScissorTest=!0,M$b=M$sa.height-M$b-M$d,M$ua.mainContext.scissor(M$a,M$b,M$c,M$d),M$ua.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),M$m?(M$b=M$sa.height-this.screenRect.y-this.screenRect.height,M$ua.mainContext.scissor(this.screenRect.x,M$b,this.screenRect.width,this.screenRect.height),M$ua.mainContext.enable(3089)):(M$ua.mainContext.disable(3089),M$sa.worldScissorTest=!1),M$l.copyFrom(this.screenRect),!0},M$a._scissorWithTagart=function(M$a,M$b,M$c,M$d){if(M$c<1||M$d<1)return!1;var M$e=M$a+M$c,M$f=M$b+M$d;M$a<0&&(M$c=M$e-(M$a=0)),M$b<0&&(M$d=M$f-(M$b=0));var M$g=M$sa.worldClipRect;if(M$a=Math.max(M$a,M$g.x),M$b=Math.max(M$b,M$g.y),M$c=Math.min(M$e,M$g.right)-M$a,M$d=Math.min(M$f,M$g.bottom)-M$b,M$c<1||M$d<1)return!1;var M$h=M$sa.worldScissorTest;return this.screenRect.copyFrom(M$g),M$sa.worldScissorTest=!0,M$g.x=M$a,M$g.y=M$b,M$g.width=M$c,M$g.height=M$d,M$b=M$sa.height-M$b-M$d,M$ua.mainContext.scissor(M$a,M$b,M$c,M$d),M$ua.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),M$h?(M$b=M$sa.height-this.screenRect.y-this.screenRect.height,M$ua.mainContext.scissor(this.screenRect.x,M$b,this.screenRect.width,this.screenRect.height),M$ua.mainContext.enable(3089)):(M$ua.mainContext.disable(3089),M$sa.worldScissorTest=!1),M$g.copyFrom(this.screenRect),!0},M$a.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},M$a.getRenderType=function(){return 0},M$a.releaseRender=function(){var M$a=M$c._cache;(M$a[M$a._length++]=this).context=null},M$c.create=function(M$a){var M$b=M$c._cache._length?M$c._cache[--M$c._cache._length]:new M$c;return M$b.context=M$a,M$b},M$c._cache=((M$c._cache=[])._length=0,M$c._cache),M$c}(),M$ka=function(){function M$i(){this.step=0,this.blendMode=null,this.level=0}M$m(M$i,"laya.webgl.submit.SubmitStencil");var M$a=M$i.prototype;return M$w.imps(M$a,{"laya.webgl.submit.ISubmit":!0}),M$a.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},M$a.getRenderType=function(){return 0},M$a.releaseRender=function(){var M$a=M$i._cache;M$a[M$a._length++]=this},M$a.do1=function(){var M$a=M$ua.mainContext;M$a.enable(2960),M$a.clear(1024),M$a.colorMask(!1,!1,!1,!1),M$a.stencilFunc(514,this.level,255),M$a.stencilOp(7680,7680,7682)},M$a.do2=function(){var M$a=M$ua.mainContext;M$a.stencilFunc(514,this.level+1,255),M$a.colorMask(!0,!0,!0,!0),M$a.stencilOp(7680,7680,7680)},M$a.do3=function(){var M$a=M$ua.mainContext;M$a.colorMask(!0,!0,!0,!0),M$a.stencilOp(7680,7680,7680),M$a.clear(1024),M$a.disable(2960)},M$a.do4=function(){var M$a=M$ua.mainContext;0==this.level&&(M$a.enable(2960),M$a.clear(1024)),M$a.colorMask(!1,!1,!1,!1),M$a.stencilFunc(519,0,255),M$a.stencilOp(7680,7680,7682)},M$a.do5=function(){var M$a=M$ua.mainContext;M$a.stencilFunc(514,this.level,255),M$a.colorMask(!0,!0,!0,!0),M$a.stencilOp(7680,7680,7680)},M$a.do6=function(){var M$a=M$ua.mainContext;M$S.targetFns[M$S.TOINT[this.blendMode]](M$a)},M$a.do7=function(){var M$a=M$ua.mainContext;M$a.colorMask(!1,!1,!1,!1),M$a.stencilOp(7680,7680,7683)},M$a.do8=function(){var M$a=M$ua.mainContext;M$a.colorMask(!0,!0,!0,!0),M$a.stencilFunc(514,this.level,255),M$a.stencilOp(7680,7680,7680)},M$i.restore=function(M$a,M$b,M$c,M$d,M$e){var M$f;if((M$a._renderKey=0)<M$i._mask&&M$i._mask--,0==M$i._mask)M$f=laya.webgl.submit.SubmitStencil.create(3),M$a.addRenderObject(M$f),M$a._curSubmit=M$fa.RENDERBASE;else{M$f=laya.webgl.submit.SubmitStencil.create(7),M$a.addRenderObject(M$f);var M$g=M$a._vb;M$g._byteLength;if(M$qa.fillRectImgVb(M$g,null,M$b.x,M$b.y,M$b.width,M$b.height,M$K.DEF_UV,M$c,M$d,M$e,0,0)){M$a._shader2D.glTexture=null;var M$h=M$a._curSubmit=M$fa.createSubmit(M$a,M$a._ib,M$g,(M$g._byteLength-64)/32*3,M$Aa.create(2,0));M$h.shaderValue.ALPHA=1,M$a._submits[M$a._submits._length++]=M$h,M$a._curSubmit._numEle+=6,M$a._curSubmit=M$fa.RENDERBASE}else alert("clipRect calc stencil rect error");M$f=laya.webgl.submit.SubmitStencil.create(8),M$a.addRenderObject(M$f)}},M$i.restore2=function(M$a,M$b){var M$c;(M$a._renderKey=0)<M$i._mask&&M$i._mask--,0==M$i._mask?(M$c=laya.webgl.submit.SubmitStencil.create(3),M$a.addRenderObject(M$c),M$a._curSubmit=M$fa.RENDERBASE):(M$c=laya.webgl.submit.SubmitStencil.create(7),M$a.addRenderObject(M$c),M$a._submits[M$a._submits._length++]=M$b,M$c=laya.webgl.submit.SubmitStencil.create(8),M$a.addRenderObject(M$c))},M$i.create=function(M$a){var M$b=M$i._cache._length?M$i._cache[--M$i._cache._length]:new M$i;return 5==(M$b.step=M$a)&&++M$i._mask,M$b.level=M$i._mask,M$b},M$i._cache=((M$i._cache=[])._length=0,M$i._cache),M$i._mask=0,M$i}(),M$la=function(){function M$h(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}M$m(M$h,"laya.webgl.submit.SubmitTarget");var M$a=M$h.prototype;return M$w.imps(M$a,{"laya.webgl.submit.ISubmit":!0}),M$a.renderSubmit=function(){this._vb.bind_upload(this._ib);var M$a=this.scope.getValue(this.proName);return M$a&&(this.shaderValue.texture=M$a.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[M$a.width,M$a.height]),this.shaderValue.upload(),this.blend(),M$G.drawCall++,M$G.trianglesFaces+=this._numEle/3,M$ua.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},M$a.blend=function(){if(M$S.activeBlendFunction!==M$S.fns[this.blendType]){var M$a=M$ua.mainContext;M$a.enable(3042),M$S.fns[this.blendType](M$a),M$S.activeBlendFunction=M$S.fns[this.blendType]}},M$a.getRenderType=function(){return 0},M$a.releaseRender=function(){var M$a=M$h._cache;(M$a[M$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},M$h.create=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=M$h._cache._length?M$h._cache[--M$h._cache._length]:new M$h;return M$g._ib=M$b,M$g._vb=M$c,M$g.proName=M$f,M$g._startIdx=M$d*M$pa.BYTES_PIDX,M$g._numEle=0,M$g.blendType=M$a._nBlendType,M$g.shaderValue=M$e,M$g.shaderValue.setValue(M$a._shader2D),M$g},M$h._cache=((M$h._cache=[])._length=0,M$h._cache),M$h}(),M$ma=function(){function M$a(){this._sourceStr=null}M$m(M$a,"laya.webgl.text.CharSegment");var M$b=M$a.prototype;return M$w.imps(M$b,{"laya.webgl.text.ICharSegment":!0}),M$b.textToSpit=function(M$a){this._sourceStr=M$a},M$b.getChar=function(M$a){return this._sourceStr.charAt(M$a)},M$b.getCharCode=function(M$a){return this._sourceStr.charCodeAt(M$a)},M$b.length=function(){return this._sourceStr.length},M$a}(),M$na=function(){var M$a;function M$G(){}return M$m(M$G,"laya.webgl.text.DrawText"),M$G.__init__=function(){M$G._charsTemp=new Array,M$G._drawValue=new M$a,M$G._charSeg=new M$ma},M$G.customCharSeg=function(M$a){M$G._charSeg=M$a},M$G.getChar=function(M$a,M$b,M$c){var M$d=M$Va.createOneChar(M$a,M$c);return-1!=M$b&&(M$G._charsCache[M$b]=M$d),M$d},M$G._drawSlow=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$l,M$m,M$n,M$o){var M$p,M$q,M$r=M$G._drawValue.value(M$f,M$h,M$i,M$j,M$m,M$n,M$o),M$s=0,M$t=0,M$u=M$G._charsTemp,M$v=0,M$w=NaN;if(M$d)for(M$u.length=M$d.length,M$s=0,M$t=M$d.length;M$s<M$t;M$s++)(M$q=M$d[M$s])&&(M$w=M$q.charNum+M$r.txtID,M$u[M$s]=M$p=M$G._charsCache[M$w]||M$G.getChar(M$q.char,M$w,M$r),M$p.active());else{var M$x=M$c instanceof laya.utils.WordText?M$c.toString():M$c;if(M$J.CharacterCache){M$G._charSeg.textToSpit(M$x);var M$A=M$G._charSeg.length();for(M$s=0,M$t=M$u.length=M$A;M$s<M$t;M$s++)M$w=M$G._charSeg.getCharCode(M$s)+M$r.txtID,M$u[M$s]=M$p=M$G._charsCache[M$w]||M$G.getChar(M$G._charSeg.getChar(M$s),M$w,M$r),M$p.active(),M$v+=M$p.cw}else M$u.length=0,(M$p=M$G.getChar(M$x,-1,M$r)).active(),M$v+=M$p.cw,M$u[0]=M$p}var M$B=0;null!==M$g&&"left"!==M$g&&(M$B=-("center"==M$g?M$v/2:M$v));var M$C,M$D,M$E=NaN,M$F=0;if(M$d)for(M$s=0,M$t=M$u.length;M$s<M$t;M$s++)M$p=M$u[M$s],M$q=M$d[M$s],M$p&&M$q&&!M$p.isSpace&&(M$E=M$p.borderSize,M$C=M$p.texture,M$b._drawText(M$C,M$k+M$B+M$q.x*M$m-M$E,M$l+M$q.y*M$n-M$E,M$C.width,M$C.height,M$e,0,0,0,0));else{for(M$s=0,M$t=M$u.length;M$s<M$t;M$s++)(M$p=M$u[M$s])&&!M$p.isSpace&&(M$E=M$p.borderSize,M$C=M$p.texture,M$b._drawText(M$C,M$k+M$B-M$E,M$l-M$E,M$C.width,M$C.height,M$e,0,0,0,0),M$a&&((M$D=M$a[M$F++])||(M$D=M$a[M$F-1]=[]),M$D[0]=M$C,M$D[1]=M$B-M$E,M$D[2]=-M$E)),M$B+=M$p.cw;M$a&&(M$a.length=M$F)}},M$G._drawFast=function(M$a,M$b,M$c,M$d,M$e){for(var M$f,M$g,M$h=0,M$i=M$a.length;M$h<M$i;M$h++)(M$f=(M$g=M$a[M$h])[0]).active(),M$b._drawText(M$f,M$d+M$g[1],M$e+M$g[2],M$f.width,M$f.height,M$c,0,0,0,0)},M$G.drawText=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$l){if(void 0===M$l&&(M$l=0),!(M$b&&0===M$b.length||M$c&&0===M$c.length)){var M$m=M$d.a,M$n=M$d.d;(0!==M$d.b||0!==M$d.c)&&(M$m=M$n=1);var M$o=1!==M$m||1!==M$n;if(M$o&&M$w.stage.transform){var M$p=M$w.stage.transform;M$o=M$p.a===M$m&&M$p.d===M$n}else M$o=!1;if(M$o){var M$q=(M$d=M$d.copyTo(M$xa._tmpMatrix)).tx,M$r=M$d.ty;M$d.scale(1/M$m,1/M$n),M$d._checkTransform(),M$j*=M$m,M$k*=M$n,M$j+=M$q-M$d.tx,M$k+=M$r-M$d.ty}else M$m=M$n=1;if(M$c)M$G._drawSlow(null,M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$m,M$n,M$l);else{if(null===M$b.toUpperCase){var M$s=M$m+1e5*M$n,M$t=M$b;return void(M$t.changed||M$t.id!==M$s?(M$t.id=M$s,M$t.changed=!1,M$G._drawSlow(M$t.save,M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$m,M$n,M$l)):M$G._drawFast(M$t.save,M$a,M$d,M$j,M$k))}var M$u=M$b+M$e.toString()+M$g+M$h+M$i+M$m+M$n+M$f,M$v=M$G._textsCache[M$u];M$J.CharacterCache?M$v?M$G._drawFast(M$v,M$a,M$d,M$j,M$k):(M$G._textsCache.__length||(M$G._textsCache.__length=0),M$G._textsCache.__length>M$x.WebGLTextCacheCount&&((M$G._textsCache={}).__length=0,M$G._curPoolIndex=0),M$G._textCachesPool[M$G._curPoolIndex]?(M$v=M$G._textsCache[M$u]=M$G._textCachesPool[M$G._curPoolIndex]).length=0:M$G._textCachesPool[M$G._curPoolIndex]=M$v=M$G._textsCache[M$u]=[],M$G._textsCache.__length++,M$G._curPoolIndex++,M$G._drawSlow(M$v,M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$m,M$n,M$l)):M$G._drawSlow(M$v,M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$m,M$n,M$l)}}},M$G._charsTemp=null,M$G._textCachesPool=[],M$G._curPoolIndex=0,M$G._charsCache={},M$G._textsCache={},M$G._drawValue=null,M$G.d=[],M$G._charSeg=null,M$G.__init$=function(){M$a=function(){function M$i(){}return M$m(M$i,""),M$i.prototype.value=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this.font=M$a,this.fillColor=M$b,this.borderColor=M$c,this.lineWidth=M$d,this.scaleX=M$e,this.scaleY=M$f,this.underLine=M$g;var M$h=M$a.toString()+M$e+M$f+M$d+(M$b?M$b.toLowerCase():" ")+(M$c?M$c.toLowerCase():" ")+M$g;return this.txtID=M$i._keymap[M$h],this.txtID||(this.txtID=1e-7*++M$i._keymapCount,M$i._keymap[M$h]=this.txtID),this},M$i.clear=function(){M$i._keymap={},M$i._keymapCount=1},M$i._keymap={},M$i._keymapCount=1,M$i}()},M$G}(),M$oa=function(){function M$e(M$a){this._index=0,this._size=14,this._italic=-2,M$e._cache2=M$e._cache2||[],this.setFont(M$a||"14px Arial")}M$m(M$e,"laya.webgl.text.FontInContext");var M$a=M$e.prototype;return M$a.setFont=function(M$a){var M$b=M$e._cache2[M$a];if(M$b)this._words=M$b[0],this._size=M$b[1];else{this._words=M$a.split(" ");for(var M$c=0,M$d=this._words.length;M$c<M$d;M$c++)if(0<this._words[M$c].indexOf("px")){this._index=M$c;break}this._size=parseInt(this._words[this._index]),M$e._cache2[M$a]=[this._words,this._size]}this._text=null,this._italic=-2},M$a.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},M$a.hasType=function(M$a){for(var M$b=0,M$c=this._words.length;M$b<M$c;M$b++)if(this._words[M$b]===M$a)return M$b;return-1},M$a.removeType=function(M$a){for(var M$b=0,M$c=this._words.length;M$b<M$c;M$b++)if(this._words[M$b]===M$a){this._words.splice(M$b,1),this._index>M$b&&this._index--;break}this._text=null,this._italic=-2},M$a.copyTo=function(M$a){return M$a._text=this._text,M$a._size=this._size,M$a._index=this._index,M$a._words=this._words.slice(),M$a._italic=-2,M$a},M$a.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},M$d(0,M$a,"size",function(){return this._size},function(M$a){this._size=M$a,this._words[this._index]=M$a+"px",this._text=null}),M$e.create=function(M$a){var M$b=M$e._cache[M$a];return M$b||(M$b=M$e._cache[M$a]=new M$e(M$a))},M$e.EMPTY=new M$e,M$e._cache={},M$e._cache2=null,M$e}(),M$pa=function(){function M$a(){}return M$m(M$a,"laya.webgl.utils.CONST3D2D"),M$a.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],M$a.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],M$a.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],M$a._TMPARRAY=[],M$a._OFFSETX=0,M$a._OFFSETY=0,M$g(M$a,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),M$a}(),M$qa=function(){function M$o(){}return M$m(M$o,"laya.webgl.utils.GlUtils"),M$o.make2DProjection=function(M$a,M$b,M$c){return[2/M$a,0,0,0,0,-2/M$b,0,0,0,0,2/M$c,0,-1,1,0,1]},M$o.fillIBQuadrangle=function(M$a,M$b){if(65535/4<M$b)throw Error("IBQuadrangle count:"+M$b+" must<:"+Math.floor(65535/4));M$b=Math.floor(M$b),M$a._resizeBuffer(6*(M$b+1)*2,!1),M$a.byteLength=M$a.bufferLength;for(var M$c=M$a.getUint16Array(),M$d=0,M$e=0;M$e<M$b;M$e++)M$c[M$d++]=4*M$e,M$c[M$d++]=4*M$e+2,M$c[M$d++]=4*M$e+1,M$c[M$d++]=4*M$e,M$c[M$d++]=4*M$e+3,M$c[M$d++]=4*M$e+2;return M$a.setNeedUpload(),!0},M$o.expandIBQuadrangle=function(M$a,M$b){M$a.bufferLength>=6*M$b*2||M$o.fillIBQuadrangle(M$a,M$b)},M$o.mathCeilPowerOfTwo=function(M$a){return M$a--,M$a|=M$a>>1,M$a|=M$a>>2,M$a|=M$a>>4,M$a|=M$a>>8,M$a|=M$a>>16,++M$a},M$o.fillQuadrangleImgVb=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){var M$i=16+(M$a._byteLength>>2);M$a.byteLength=M$i<<2;var M$j=M$a.getFloat32Array();M$j[(M$i-=16)+2]=M$e[0],M$j[M$i+3]=M$e[1],M$j[M$i+6]=M$e[2],M$j[M$i+7]=M$e[3],M$j[M$i+10]=M$e[4],M$j[M$i+11]=M$e[5],M$j[M$i+14]=M$e[6],M$j[M$i+15]=M$e[7];var M$k=M$f.a,M$l=M$f.b,M$m=M$f.c,M$n=M$f.d;if(1!==M$k||0!==M$l||0!==M$m||1!==M$n){M$f.bTransform=!0;var M$o=M$f.tx+M$g,M$p=M$f.ty+M$h;M$j[M$i]=(M$d[0]+M$b)*M$k+(M$d[1]+M$c)*M$m+M$o,M$j[M$i+1]=(M$d[0]+M$b)*M$l+(M$d[1]+M$c)*M$n+M$p,M$j[M$i+4]=(M$d[2]+M$b)*M$k+(M$d[3]+M$c)*M$m+M$o,M$j[M$i+5]=(M$d[2]+M$b)*M$l+(M$d[3]+M$c)*M$n+M$p,M$j[M$i+8]=(M$d[4]+M$b)*M$k+(M$d[5]+M$c)*M$m+M$o,M$j[M$i+9]=(M$d[4]+M$b)*M$l+(M$d[5]+M$c)*M$n+M$p,M$j[M$i+12]=(M$d[6]+M$b)*M$k+(M$d[7]+M$c)*M$m+M$o,M$j[M$i+13]=(M$d[6]+M$b)*M$l+(M$d[7]+M$c)*M$n+M$p}else M$f.bTransform=!1,M$b+=M$f.tx+M$g,M$c+=M$f.ty+M$h,M$j[M$i]=M$b+M$d[0],M$j[M$i+1]=M$c+M$d[1],M$j[M$i+4]=M$b+M$d[2],M$j[M$i+5]=M$c+M$d[3],M$j[M$i+8]=M$b+M$d[4],M$j[M$i+9]=M$c+M$d[5],M$j[M$i+12]=M$b+M$d[6],M$j[M$i+13]=M$c+M$d[7];return M$a._upload=!0},M$o.fillTranglesVB=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){var M$h=(M$a._byteLength>>2)+M$d.length;M$a.byteLength=M$h<<2;var M$i=M$a.getFloat32Array();M$h-=M$d.length;for(var M$j=M$d.length,M$k=M$e.a,M$l=M$e.b,M$m=M$e.c,M$n=M$e.d,M$o=0;M$o<M$j;M$o+=4)if(M$i[M$h+M$o+2]=M$d[M$o+2],M$i[M$h+M$o+3]=M$d[M$o+3],1!==M$k||0!==M$l||0!==M$m||1!==M$n){M$e.bTransform=!0;var M$p=M$e.tx+M$f,M$q=M$e.ty+M$g;M$i[M$h+M$o]=(M$d[M$o]+M$b)*M$k+(M$d[M$o+1]+M$c)*M$m+M$p,M$i[M$h+M$o+1]=(M$d[M$o]+M$b)*M$l+(M$d[M$o+1]+M$c)*M$n+M$q}else M$e.bTransform=!1,M$b+=M$e.tx+M$f,M$c+=M$e.ty+M$g,M$i[M$h+M$o]=M$b+M$d[M$o],M$i[M$h+M$o+1]=M$c+M$d[M$o+1];return M$a._upload=!0},M$o.copyPreImgVb=function(M$a,M$b,M$c){var M$d=M$a._byteLength>>2;M$a.byteLength=M$d+16<<2;for(var M$e=M$a.getFloat32Array(),M$f=0,M$g=M$d-16;M$f<4;M$f++)M$e[M$d]=M$e[M$g]+M$b,++M$g,M$e[++M$d]=M$e[M$g]+M$c,++M$g,M$e[++M$d]=M$e[M$g],++M$g,M$e[++M$d]=M$e[M$g],++M$d,++M$g;M$a._upload=!0},M$o.fillRectImgVb=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$l,M$m){void 0===M$m&&(M$m=!1);var M$n,M$o,M$p,M$q,M$r,M$s,M$t,M$u,M$v,M$w,M$x,M$A,M$B,M$C,M$D,M$E,M$F=1,M$G=M$h.a,M$H=M$h.b,M$I=M$h.c,M$J=M$h.d,M$K=M$b&&M$b.width<99999999;if(1!==M$G||0!==M$H||0!==M$I||1!==M$J?(M$h.bTransform=!0,0===M$H&&0===M$I&&(M$F=23,M$v=M$e+M$c,M$w=M$f+M$d,M$n=M$G*M$c+(M$x=M$h.tx+M$i),M$p=M$G*M$v+M$x,M$o=M$J*M$d+(M$A=M$h.ty+M$j),M$q=M$J*M$w+M$A)):(M$F=23,M$h.bTransform=!1,M$p=(M$n=M$c+M$h.tx+M$i)+M$e,M$q=(M$o=M$d+M$h.ty+M$j)+M$f),M$K&&(M$r=M$b.x,M$s=M$b.y,M$t=M$b.width+M$r,M$u=M$b.height+M$s),1!==M$F){if(Math.min(M$n,M$p)>=M$t)return!1;if(Math.min(M$o,M$q)>=M$u)return!1;if(Math.max(M$p,M$n)<=M$r)return!1;if(Math.max(M$q,M$o)<=M$s)return!1}var M$L=M$a._byteLength>>2;M$a.byteLength=16+M$L<<2;var M$M=M$a.getFloat32Array();switch(M$M[2+M$L]=M$g[0],M$M[3+M$L]=M$g[1],M$M[6+M$L]=M$g[2],M$M[7+M$L]=M$g[3],M$M[10+M$L]=M$g[4],M$M[11+M$L]=M$g[5],M$M[14+M$L]=M$g[6],M$M[15+M$L]=M$g[7],M$F){case 1:M$x=M$h.tx+M$i,M$A=M$h.ty+M$j;var M$N=M$G*M$c,M$O=M$I*M$d,M$P=M$J*M$d,M$Q=M$H*M$c,M$R=M$G*(M$v=M$e+M$c),M$S=M$I*(M$w=M$f+M$d),M$T=M$J*M$w,M$U=M$H*M$v;M$m?(M$B=M$N+M$O+M$x,M$D=Math.round(M$B)-M$B,M$C=M$P+M$Q+M$A,M$E=Math.round(M$C)-M$C,M$M[M$L]=M$B+M$D,M$M[1+M$L]=M$C+M$E,M$M[4+M$L]=M$R+M$O+M$x+M$D,M$M[5+M$L]=M$P+M$U+M$A+M$E,M$M[8+M$L]=M$R+M$S+M$x+M$D,M$M[9+M$L]=M$T+M$U+M$A+M$E,M$M[12+M$L]=M$N+M$S+M$x+M$D,M$M[13+M$L]=M$T+M$Q+M$A+M$E):(M$M[M$L]=M$N+M$O+M$x,M$M[1+M$L]=M$P+M$Q+M$A,M$M[4+M$L]=M$R+M$O+M$x,M$M[5+M$L]=M$P+M$U+M$A,M$M[8+M$L]=M$R+M$S+M$x,M$M[9+M$L]=M$T+M$U+M$A,M$M[12+M$L]=M$N+M$S+M$x,M$M[13+M$L]=M$T+M$Q+M$A);break;case 23:M$m?(M$B=M$n+M$k,M$D=Math.round(M$B)-M$B,M$C=M$o,M$E=Math.round(M$C)-M$C,M$M[M$L]=M$B+M$D,M$M[1+M$L]=M$C+M$E,M$M[4+M$L]=M$p+M$k+M$D,M$M[5+M$L]=M$o+M$E,M$M[8+M$L]=M$p+M$D,M$M[9+M$L]=M$q+M$E,M$M[12+M$L]=M$n+M$D,M$M[13+M$L]=M$q+M$E):(M$M[M$L]=M$n+M$k,M$M[1+M$L]=M$o,M$M[4+M$L]=M$p+M$k,M$M[5+M$L]=M$o,M$M[8+M$L]=M$p,M$M[9+M$L]=M$q,M$M[12+M$L]=M$n,M$M[13+M$L]=M$q)}return M$a._upload=!0},M$o.fillLineVb=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){var M$i=.5*M$g,M$j=M$o._fillLineArray,M$k=-(M$d-M$f),M$l=M$c-M$e,M$m=Math.sqrt(M$k*M$k+M$l*M$l);M$k/=M$m,M$l/=M$m,M$k*=M$i,M$l*=M$i,M$j[0]=M$c-M$k,M$j[1]=M$d-M$l,M$j[4]=M$c+M$k,M$j[5]=M$d+M$l,M$j[8]=M$e+M$k,M$j[9]=M$f+M$l,M$j[12]=M$e-M$k,M$j[13]=M$f-M$l,M$h&&M$h.transformPointArray(M$j,M$j);var M$n=16+(M$a._byteLength>>2);return M$a.byteLength=M$n<<2,M$a.insertData(M$j,M$n-16),!0},M$o._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],M$o}(),M$ra=(function(){function M$i(){}M$m(M$i,"laya.webgl.utils.MatirxArray"),M$i.ArrayMul=function(M$a,M$b,M$c){if(M$a)if(M$b)for(var M$d=NaN,M$e=NaN,M$f=NaN,M$g=NaN,M$h=0;M$h<4;M$h++)M$d=M$a[M$h],M$e=M$a[M$h+4],M$f=M$a[M$h+8],M$g=M$a[M$h+12],M$c[M$h]=M$d*M$b[0]+M$e*M$b[1]+M$f*M$b[2]+M$g*M$b[3],M$c[M$h+4]=M$d*M$b[4]+M$e*M$b[5]+M$f*M$b[6]+M$g*M$b[7],M$c[M$h+8]=M$d*M$b[8]+M$e*M$b[9]+M$f*M$b[10]+M$g*M$b[11],M$c[M$h+12]=M$d*M$b[12]+M$e*M$b[13]+M$f*M$b[14]+M$g*M$b[15];else M$i.copyArray(M$a,M$c);else M$i.copyArray(M$b,M$c)},M$i.copyArray=function(M$a,M$b){if(M$a&&M$b)for(var M$c=0;M$c<M$a.length;M$c++)M$b[M$c]=M$a[M$c]}}(),function(){function M$b(M$a,M$b,M$c){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=M$a,this._vb=new M$za(M$a,35048),M$b&&this._vb._resizeBuffer(M$b,!1),this._ib=new M$ya,M$c&&this._ib._resizeBuffer(M$c,!1)}M$m(M$b,"laya.webgl.utils.Mesh2D");var M$a=M$b.prototype;return M$a.cloneWithNewVB=function(){var M$a=new M$b(this._stride,0,0);return M$a._ib=this._ib,M$a._quadNum=this._quadNum,M$a._attribInfo=this._attribInfo,M$a},M$a.cloneWithNewVBIB=function(){var M$a=new M$b(this._stride,0,0);return M$a._attribInfo=this._attribInfo,M$a},M$a.getVBW=function(){return this._vb.setNeedUpload(),this._vb},M$a.getVBR=function(){return this._vb},M$a.getIBR=function(){return this._ib},M$a.getIBW=function(){return this._ib.setNeedUpload(),this._ib},M$a.createQuadIB=function(M$a){this._quadNum=M$a,this._ib._resizeBuffer(6*M$a*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var M$b=this._ib.getUint16Array(),M$c=0,M$d=0,M$e=0;M$e<M$a;M$e++)M$b[M$c++]=M$d,M$b[M$c++]=M$d+2,M$b[M$c++]=M$d+1,M$b[M$c++]=M$d,M$b[M$c++]=M$d+3,M$b[M$c++]=M$d+2,M$d+=4;this._ib.setNeedUpload()},M$a.setAttributes=function(M$a){if(this._attribInfo=M$a,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},M$a.getEleNum=function(){return this._ib.getBuffer().byteLength/2},M$a.releaseMesh=function(){},M$a.destroy=function(){},M$a.clearVB=function(){this._vb.clear()},M$b._gvaoid=0,M$b}()),M$sa=function(){function M$e(){}return M$m(M$e,"laya.webgl.utils.RenderState2D"),M$e.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},M$e.mat2MatArray=function(M$a,M$b){var M$c=M$a,M$d=M$b;return M$d[0]=M$c.a,M$d[1]=M$c.b,M$d[2]=M$e.EMPTYMAT4_ARRAY[2],M$d[3]=M$e.EMPTYMAT4_ARRAY[3],M$d[4]=M$c.c,M$d[5]=M$c.d,M$d[6]=M$e.EMPTYMAT4_ARRAY[6],M$d[7]=M$e.EMPTYMAT4_ARRAY[7],M$d[8]=M$e.EMPTYMAT4_ARRAY[8],M$d[9]=M$e.EMPTYMAT4_ARRAY[9],M$d[10]=M$e.EMPTYMAT4_ARRAY[10],M$d[11]=M$e.EMPTYMAT4_ARRAY[11],M$d[12]=M$c.tx,M$d[13]=M$c.ty,M$d[14]=M$e.EMPTYMAT4_ARRAY[14],M$d[15]=M$e.EMPTYMAT4_ARRAY[15],M$b},M$e.restoreTempArray=function(){M$e.TEMPMAT4_ARRAY[0]=1,M$e.TEMPMAT4_ARRAY[1]=0,M$e.TEMPMAT4_ARRAY[4]=0,M$e.TEMPMAT4_ARRAY[5]=1,M$e.TEMPMAT4_ARRAY[12]=0,M$e.TEMPMAT4_ARRAY[13]=0},M$e.clear=function(){M$e.worldScissorTest=!1,M$e.worldShaderDefines=null,M$e.worldFilters=null,M$e.worldAlpha=1,M$e.worldClipRect.x=M$e.worldClipRect.y=0,M$e.worldClipRect.width=M$e.width,M$e.worldClipRect.height=M$e.height,M$e.curRenderTarget=null},M$e._MAXSIZE=99999999,M$e.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],M$e.worldMatrix4=M$e.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],M$e.worldAlpha=1,M$e.worldScissorTest=!1,M$e.worldFilters=null,M$e.worldShaderDefines=null,M$e.curRenderTarget=null,M$e.width=0,M$e.height=0,M$g(M$e,["worldMatrix",function(){return this.worldMatrix=new M$B},"worldClipRect",function(){return this.worldClipRect=new M$D(0,0,99999999,99999999)}]),M$e}(),M$ta=function(){var M$s,M$c;function M$t(M$a,M$b,M$c,M$d,M$e){var M$f=this;function M$g(M$a){var M$b=[],M$c=new M$s(M$b);return M$f._compileToTree(M$c,M$a.split("\n"),0,M$b,M$e),M$c}var M$h=M$n.now();this._VS=M$g(M$b),this._PS=M$g(M$c),this._nameMap=M$d,2<M$n.now()-M$h&&console.log("ShaderCompile use time:"+(M$n.now()-M$h)+"  size:"+M$b.length+"/"+M$c.length)}M$m(M$t,"laya.webgl.utils.ShaderCompile");var M$a=M$t.prototype;return M$a._compileToTree=function(M$a,M$b,M$c,M$d,M$e){var M$f,M$g,M$h,M$i,M$j,M$k,M$l,M$m=0,M$n=0,M$o=0,M$p=0;for(M$n=M$c;M$n<M$b.length;M$n++)if(!((M$h=M$b[M$n]).length<1)&&0!==(M$m=M$h.indexOf("//"))){if(0<=M$m&&(M$h=M$h.substr(0,M$m)),M$f=M$l||new M$s(M$d),M$l=null,M$f.text=M$h,M$f.noCompile=!0,0<=(M$m=M$h.indexOf("#"))){for(M$i="#",M$p=M$m+1,M$o=M$h.length;M$p<M$o;M$p++){var M$q=M$h.charAt(M$p);if(" "===M$q||"\t"===M$q||"\r"===M$q||"\n"===M$q||"?"===M$q)break;M$i+=M$q}switch(M$f.name=M$i){case"#ifdef":case"#ifndef":if(M$f.src=M$h,M$f.noCompile=null!=M$h.match(/[!&|()=<>]/),M$f.noCompile?console.log("function():Boolean{return "+M$h.substr(M$m+M$f.name.length)+"}"):(M$k=M$h.replace(/^\s*/,"").split(/\s+/),M$f.setCondition(M$k[1],"#ifdef"===M$i?1:2),M$f.text="//"+M$f.text),M$f.setParent(M$a),M$a=M$f,M$e)for(M$k=M$h.substr(M$p).split(M$t._splitToWordExps3),M$p=0;M$p<M$k.length;M$p++)(M$h=M$k[M$p]).length&&(M$e[M$h]=!0);continue;case"#if":if(M$f.src=M$h,M$f.noCompile=!0,M$f.setParent(M$a),M$a=M$f,M$e)for(M$k=M$h.substr(M$p).split(M$t._splitToWordExps3),M$p=0;M$p<M$k.length;M$p++)(M$h=M$k[M$p]).length&&"defined"!=M$h&&(M$e[M$h]=!0);continue;case"#else":M$f.src=M$h,M$g=(M$a=M$a.parent).childs[M$a.childs.length-1],M$f.noCompile=M$g.noCompile,M$f.noCompile||(M$f.condition=M$g.condition,M$f.conditionType=1==M$g.conditionType?2:1,M$f.text="//"+M$f.text+" "+M$g.text+" "+M$f.conditionType),M$f.setParent(M$a),M$a=M$f;continue;case"#endif":M$g=(M$a=M$a.parent).childs[M$a.childs.length-1],M$f.noCompile=M$g.noCompile,M$f.noCompile||(M$f.text="//"+M$f.text),M$f.setParent(M$a);continue;case"#include":M$k=M$t.splitToWords(M$h,null);var M$r=M$t.includes[M$k[1]];if(!M$r)throw"ShaderCompile error no this include file:"+M$k[1];if((M$m=M$k[0].indexOf("?"))<0){M$f.setParent(M$a),M$h=M$r.getWith("with"==M$k[2]?M$k[3]:null),this._compileToTree(M$f,M$h.split("\n"),0,M$d,M$e),M$f.text="";continue}M$f.setCondition(M$k[0].substr(M$m+1),1),M$f.text=M$r.getWith("with"==M$k[2]?M$k[3]:null);break;case"#import":M$j=(M$k=M$t.splitToWords(M$h,null))[1],M$d.push({node:M$f,file:M$t.includes[M$j],ofs:M$f.text.length});continue}}else{if((M$g=M$a.childs[M$a.childs.length-1])&&!M$g.name){0<M$d.length&&M$t.splitToWords(M$h,M$g),M$l=M$f,M$g.text+="\n"+M$h;continue}0<M$d.length&&M$t.splitToWords(M$h,M$f)}M$f.setParent(M$a)}},M$a.createShader=function(M$a,M$b,M$c){var M$d={},M$e="";if(M$a)for(var M$f in M$a)M$e+="#define "+M$f+"\n",M$d[M$f]=!0;var M$g=this._VS.toscript(M$d,[]),M$h=this._PS.toscript(M$d,[]);return(M$c||M$Ya.create)(M$e+M$g.join("\n"),M$e+M$h.join("\n"),M$b,this._nameMap)},M$t._parseOne=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g={type:M$t.shaderParamsMap[M$c[M$d+1]],name:M$c[M$d+2],size:isNaN(parseInt(M$c[M$d+3]))?1:parseInt(M$c[M$d+3])};return M$f&&("attribute"==M$e?M$a.push(M$g):M$b.push(M$g)),":"==M$c[M$d+3]&&(M$g.type=M$c[M$d+4],M$d+=2),M$d+=2},M$t.addInclude=function(M$a,M$b){if(!M$b||0===M$b.length)throw new Error("add shader include file err:"+M$a);if(M$t.includes[M$a])throw new Error("add shader include file err, has add:"+M$a);M$t.includes[M$a]=new M$c(M$b)},M$t.preGetParams=function(M$a,M$b){var M$c=[M$a,M$b],M$d={},M$e=[],M$f=[],M$g={},M$h=[];M$d.attributes=M$e,M$d.uniforms=M$f,M$d.defines=M$g;for(var M$i=0,M$j=0,M$k=0;M$k<2;M$k++){M$c[M$k]=M$c[M$k].replace(M$t._removeAnnotation,"");var M$l,M$m=M$c[M$k].match(M$t._reg);for(M$i=0,M$j=M$m.length;M$i<M$j;M$i++){var M$n=M$m[M$i];if("attribute"==M$n||"uniform"==M$n)M$i=M$t._parseOne(M$e,M$f,M$m,M$i,M$n,!0);else{if("#define"==M$n){M$h[M$n=M$m[++M$i]]=1;continue}if("#ifdef"==M$n){M$g[M$l=M$m[++M$i]]=M$g[M$l]||[];for(M$i++;M$i<M$j;M$i++)if("attribute"==(M$n=M$m[M$i])||"uniform"==M$n)M$i=M$t._parseOne(M$e,M$f,M$m,M$i,M$n,M$h[M$l]);else if("#else"==M$n)for(M$i++;M$i<M$j;M$i++)if("attribute"==(M$n=M$m[M$i])||"uniform"==M$n)M$i=M$t._parseOne(M$e,M$f,M$m,M$i,M$n,!M$h[M$l]);else if("#endif"==M$n)break}}}}return M$d},M$t.splitToWords=function(M$a,M$b){for(var M$c,M$d,M$e=[],M$f=-1,M$g=0,M$h=M$a.length;M$g<M$h;M$g++)if(M$c=M$a.charAt(M$g),0<=" \t=+-*/&%!<>()'\",;".indexOf(M$c)){if(0<=M$f&&1<M$g-M$f&&(M$d=M$a.substr(M$f,M$g-M$f),M$e.push(M$d)),'"'==M$c||"'"==M$c){var M$i=M$a.indexOf(M$c,M$g+1);if(M$i<0)throw"Sharder err:"+M$a;M$e.push(M$a.substr(M$g+1,M$i-M$g-1)),M$g=M$i,M$f=-1;continue}"("==M$c&&M$b&&0<M$e.length&&(M$d=M$e[M$e.length-1]+";","vec4;main;".indexOf(M$d)<0&&(M$b.useFuns+=M$d)),M$f=-1}else M$f<0&&(M$f=M$g);return M$f<M$h&&1<M$h-M$f&&(M$d=M$a.substr(M$f,M$h-M$f),M$e.push(M$d)),M$e},M$t.IFDEF_NO=0,M$t.IFDEF_YES=1,M$t.IFDEF_ELSE=2,M$t.IFDEF_PARENT=3,M$t._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),M$t._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),M$t._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),M$t.includes={},M$g(M$t,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),M$t.__init$=function(){M$s=function(){function M$c(M$a){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=M$a}M$m(M$c,"");var M$a=M$c.prototype;return M$a.setParent=function(M$a){M$a.childs.push(this),this.z=M$a.z+1,this.parent=M$a},M$a.setCondition=function(M$a,M$b){M$a&&(this.conditionType=M$b,M$a=M$a.replace(/(\s*$)/g,""),this.condition=function(){return this[M$a]},this.condition.__condition=M$a)},M$a.toscript=function(M$a,M$b){return this._toscript(M$a,M$b,++M$c.__id)},M$a._toscript=function(M$d,M$e,M$f){if(this.childs.length<1&&!this.text)return M$e;M$e.length;if(this.condition){var M$a=!!this.condition.call(M$d);if(2===this.conditionType&&(M$a=!M$a),!M$a)return M$e}if(this.text&&M$e.push(this.text),0<this.childs.length&&this.childs.forEach(function(M$a,M$b,M$c){M$a._toscript(M$d,M$e,M$f)}),0<this.includefiles.length&&0<this.useFuns.length)for(var M$b,M$c=0,M$g=this.includefiles.length;M$c<M$g;M$c++)this.includefiles[M$c].curUseID!=M$f&&0<(M$b=this.includefiles[M$c].file.getFunsScript(this.useFuns)).length&&(this.includefiles[M$c].curUseID=M$f,M$e[0]=M$b+M$e[0]);return M$e},M$c.__id=1,M$c}(),M$c=function(){function M$a(M$a){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=M$a;for(var M$b=0,M$c=0,M$d=0;!((M$b=M$a.indexOf("#begin",M$b))<0);){for(M$d=M$b+5;!((M$d=M$a.indexOf("#end",M$d))<0)&&"i"===M$a.charAt(M$d+4);)M$d+=5;if(M$d<0)throw"add include err,no #end:"+M$a;M$c=M$a.indexOf("\n",M$b);var M$e=M$t.splitToWords(M$a.substr(M$b,M$c-M$b),null);"code"==M$e[1]?this.codes[M$e[2]]=M$a.substr(M$c+1,M$d-M$c-1):"function"==M$e[1]&&(M$c=M$a.indexOf("function",M$b),M$c+="function".length,this.funs[M$e[3]]=M$a.substr(M$c+1,M$d-M$c-1),this.funnames+=M$e[3]+";"),M$b=M$d+1}}M$m(M$a,"");var M$b=M$a.prototype;return M$b.getWith=function(M$a){var M$b=M$a?this.codes[M$a]:this.script;if(!M$b)throw"get with error:"+M$a;return M$b},M$b.getFunsScript=function(M$a){var M$b="";for(var M$c in this.funs)0<=M$a.indexOf(M$c+";")&&(M$b+=this.funs[M$c]);return M$b},M$a}()},M$t}(),M$ua=function(){function M$g(){}return M$m(M$g,"laya.webgl.WebGL"),M$g._uint8ArraySlice=function(){for(var M$a=this.length,M$b=new Uint8Array(this.length),M$c=0;M$c<M$a;M$c++)M$b[M$c]=this[M$c];return M$b},M$g._float32ArraySlice=function(){for(var M$a=this.length,M$b=new Float32Array(this.length),M$c=0;M$c<M$a;M$c++)M$b[M$c]=this[M$c];return M$b},M$g._uint16ArraySlice=function(M$a){var M$b,M$c=arguments,M$d=0,M$e=0;if(0===M$c.length)for(M$d=this.length,M$b=new Uint16Array(M$d),M$e=0;M$e<M$d;M$e++)M$b[M$e]=this[M$e];else if(2===M$c.length){var M$f=M$c[0],M$g=M$c[1];if(M$f<M$g)for(M$d=M$g-M$f,M$b=new Uint16Array(M$d),M$e=M$f;M$e<M$g;M$e++)M$b[M$e-M$f]=this[M$e];else M$b=new Uint16Array(0)}return M$b},M$g.expandContext=function(){var M$a=M$e.prototype,M$b=CanvasRenderingContext2D.prototype;M$b.fillTrangles=M$a.fillTrangles,M$Za.__int__(null),M$b.setIBVB=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){void 0===M$i&&(M$i=0),void 0===M$j&&(M$j=0),null===M$c&&(this._ib=this._ib||M$ya.QuadrangleIB,M$c=this._ib,M$qa.expandIBQuadrangle(M$c,M$d._byteLength/64+8)),this._setIBVB(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j)},M$b.fillTrangles=function(M$a,M$b,M$c,M$d,M$e){this._curMat=this._curMat||M$B.create(),this._vb=this._vb||M$za.create(),this._ib||(this._ib=M$ya.create(),M$qa.fillIBQuadrangle(this._ib,M$g/4));var M$f=this._vb,M$g=M$d.length>>4;M$qa.fillTranglesVB(M$f,M$b,M$c,M$d,M$e||this._curMat,0,0),M$qa.expandIBQuadrangle(this._ib,M$f._byteLength/64+8);var M$h=new M$Aa(1,0);M$h.textureHost=M$a;var M$i=new M$_a("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");M$f._vertType=3,this._setIBVB(M$b,M$c,this._ib,M$f,6*M$g,M$e,M$i,M$h,0,0)}},M$g.enable=function(){if(M$n.__init__(),M$r.isConchApp&&!M$r.isConchWebGL)return M$v.skinAniSprite=function(){return new M$aa},M$g.expandContext(),!1;if(M$v.getWebGLContext=function(M$a){for(var M$b,M$c=["webgl","experimental-webgl","webkit-3d","moz-webgl"],M$d=0;M$d<M$c.length;M$d++){try{M$b=M$a.getContext(M$c[M$d],{stencil:M$x.isStencil,alpha:M$x.isAlpha,antialias:M$x.isAntialias,premultipliedAlpha:M$x.premultipliedAlpha,preserveDrawingBuffer:M$x.preserveDrawingBuffer})}catch(M$a){}if(M$b)return M$b}return null},null==(M$g.mainContext=M$v.getWebGLContext(M$r._mainCanvas)))return!1;if(M$r.isWebGL)return!0;M$p.create=function(M$a,M$b){return new M$ab(M$a,M$b)},M$q.create=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){return new M$Xa(M$a,M$b,M$c,M$d,M$e,M$f,M$g)},M$r.WebGL=M$g,M$r.isWebGL=!0,M$na.__init__(),M$v.createRenderSprite=function(M$a,M$b){return new M$Ba(M$a,M$b)},M$v.createWebGLContext2D=function(M$a){return new M$xa(M$a)},M$v.changeWebGLSize=function(M$a,M$b){laya.webgl.WebGL.onStageResize(M$a,M$b)},M$v.createGraphics=function(){return new M$wa};var M$a=M$v.createFilterAction;return M$v.createFilterAction=M$a||function(M$a){return new M$Ca},M$v.clear=function(M$a){M$sa.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var M$b=M$r.context.ctx,M$c=0==M$b._submits._length||M$x.preserveDrawingBuffer?M$o.create(M$a)._color:M$F._wgColor;M$c&&M$b.clearBG(M$c[0],M$c[1],M$c[2],M$c[3]),M$sa.clear()},M$v.addToAtlas=function(M$a,M$b){void 0===M$b&&(M$b=!1);var M$c=M$a.bitmap;M$r.optimizeTextureMemory(M$a.url,M$a)?M$w.__typeof(M$c,"laya.webgl.resource.IMergeAtlasBitmap")&&M$c.allowMerageInAtlas&&M$c.on("recovered",M$a,M$a.addTextureToAtlas):M$c.enableMerageInAtlas=!1},M$v.isAtlas=function(M$a){return M$a instanceof laya.webgl.atlas.AtlasWebGLCanvas},M$Q._enable(),M$v.beginFlush=function(){for(var M$a=M$Q.instance,M$b=M$a.getAtlaserCount(),M$c=0;M$c<M$b;M$c++){var M$d=M$a.getAtlaserByIndex(M$c).texture;M$d._flashCacheImageNeedFlush&&M$v.flashFlushImage(M$d)}},M$v.drawToCanvas=function(M$a,M$b,M$c,M$d,M$e,M$f){(M$c<=0||M$d<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),M$c|=0,M$d|=0,M$e|=0,M$f|=0;var M$g=M$Ma.create(M$c,M$d,6408,5121,0,!1);M$g.start(),M$g.clear(0,0,0,0),M$r.context.clear(),M$s.renders[M$b]._fun(M$a,M$r.context,M$e,M$sa.height-M$d+M$f),M$r.context.flush(),M$g.end();var M$h=M$g.getData(0,0,M$c,M$d);if(M$g.recycle(),M$h.byteLength==M$c*M$d*4){var M$i=new M$Ua;M$i._canvas=M$n.createElement("canvas"),M$i.size(M$c,M$d);var M$j=M$i._canvas.getContext("2d");M$n.canvas.size(M$c,M$d);var M$k=M$n.context,M$l=M$k.createImageData(M$c,M$d);return M$l.data.set(new Uint8ClampedArray(M$h.buffer)),M$i._imgData=M$l,M$k.putImageData(M$l,0,0),M$j.save(),M$j.translate(0,M$d),M$j.scale(1,-1),M$j.drawImage(M$n.canvas.source,0,0),M$j.restore(),M$i}console.log("drawToCanvas error: w:"+M$c+",h:"+M$d+",datalen:"+M$h.byteLength)},M$v.createFilterAction=function(M$a){var M$b;switch(M$a){case 32:M$b=new M$Ca}return M$b},M$v.addTextureToAtlas=function(M$a){M$a._uvID++,M$Q._atlasRestore++,M$a.bitmap.enableMerageInAtlas&&M$Q.instance.addToAtlas(M$a)},M$v.getTexturePixels=function(M$a,M$b,M$c,M$d,M$e){M$r.context.ctx.clear();var M$f=new M$E;M$f.graphics.drawTexture(M$a,-M$b,-M$c);var M$g=M$Ma.create(M$d,M$e);M$g.start(),M$g.clear(0,0,0,0),M$f.render(M$r.context,0,0),M$r.context.ctx.flush(),M$g.end();for(var M$h=M$g.getData(0,0,M$d,M$e),M$i=[],M$j=0,M$k=M$e-1;0<=M$k;M$k--)for(var M$l=0;M$l<M$d;M$l++)M$j=4*(M$k*M$d+M$l),M$i.push(M$h[M$j]),M$i.push(M$h[M$j+1]),M$i.push(M$h[M$j+2]),M$i.push(M$h[M$j+3]);return M$i},M$v.skinAniSprite=function(){return new M$aa},M$j.create=function(M$a,M$b){var M$c=new M$Ua;return M$c._imgData=M$b,M$c.flipY=!1,M$c},M$A._filterStart=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$a.getValue("bounds"),M$g=M$Ma.create(M$f.width,M$f.height);if(M$g.start(),M$g.clear(0,0,0,0),M$a.addValue("src",M$g),M$a.addValue("ScissorTest",M$sa.worldScissorTest),M$sa.worldScissorTest){var M$h=new M$D;M$h.copyFrom(M$c.ctx._clipRect),M$a.addValue("clipRect",M$h),M$sa.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},M$A._filterEnd=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$a.getValue("bounds");M$a.getValue("src").end();var M$g=M$Ma.create(M$f.width,M$f.height);M$g.start(),M$g.clear(0,0,0,0),M$a.addValue("out",M$g),M$b._set$P("_filterCache",M$g),M$b._set$P("_isHaveGlowFilter",M$a.getValue("_isHaveGlowFilter"))},M$A._EndTarget=function(M$a,M$b){if(M$a.getValue("src").recycle(),M$a.getValue("out").end(),M$a.getValue("ScissorTest")){M$sa.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),M$b.ctx.save();var M$c=M$a.getValue("clipRect");M$b.ctx.clipRect(M$c.x,M$c.y,M$c.width,M$c.height)}},M$A._useSrc=function(M$a){var M$b=M$a.getValue("out");M$b.end(),(M$b=M$a.getValue("src")).start(),M$b.clear(0,0,0,0)},M$A._endSrc=function(M$a){M$a.getValue("src").end()},M$A._useOut=function(M$a){var M$b=M$a.getValue("src");M$b.end(),(M$b=M$a.getValue("out")).start(),M$b.clear(0,0,0,0)},M$A._endOut=function(M$a){M$a.getValue("out").end()},M$A._recycleScope=function(M$a){M$a.recycle()},M$A._filter=function(M$a,M$b,M$c,M$d){var M$e=this._next;if(M$e){var M$f,M$g,M$h=M$a.filters,M$i=M$h.length;if(1==M$i&&32==M$h[0].type)return M$b.ctx.save(),M$b.ctx.setFilters([M$h[0]]),M$e._fun.call(M$e,M$a,M$b,M$c,M$d),void M$b.ctx.restore();var M$j=M$ha.create(),M$k=M$C.TEMP,M$l=M$b.ctx._getTransformMatrix(),M$m=M$B.create();M$l.copyTo(M$m);var M$n=0,M$o=0,M$p=!1,M$q=M$a._$P._filterCache?M$a._$P._filterCache:null;if(!M$q||M$a._repaint){M$p=M$a._isHaveGlowFilter(),M$j.addValue("_isHaveGlowFilter",M$p),M$p&&(M$n=50,M$o=25),(M$g=new M$D).copyFrom(M$a.getSelfBounds()),M$g.x+=M$a.x,M$g.y+=M$a.y,M$g.x-=M$a.pivotX+4,M$g.y-=M$a.pivotY+4;var M$r=M$g.x,M$s=M$g.y;if(M$g.width+=M$n+8,M$g.height+=M$n+8,M$k.x=M$g.x*M$m.a+M$g.y*M$m.c,M$k.y=M$g.y*M$m.d+M$g.x*M$m.b,M$g.x=M$k.x,M$g.y=M$k.y,M$k.x=M$g.width*M$m.a+M$g.height*M$m.c,M$k.y=M$g.height*M$m.d+M$g.width*M$m.b,M$g.width=M$k.x,M$g.height=M$k.y,M$g.width<=0||M$g.height<=0)return;M$q&&M$q.recycle(),M$j.addValue("bounds",M$g);var M$t=M$ga.create([M$j,M$a,M$b,0,0],M$A._filterStart);M$b.addRenderObject(M$t),M$b.ctx._renderKey=0,M$b.ctx._shader2D.glTexture=null;var M$u=M$a.x-M$r+M$o,M$v=M$a.y-M$s+M$o;M$e._fun.call(M$e,M$a,M$b,M$u,M$v),M$t=M$ga.create([M$j,M$a,M$b,0,0],M$A._filterEnd),M$b.addRenderObject(M$t);for(var M$w=0;M$w<M$i;M$w++){0!=M$w&&(M$t=M$ga.create([M$j],M$A._useSrc),M$b.addRenderObject(M$t),M$f=M$Aa.create(1,0),M$B.TEMP.identity(),M$b.ctx.drawTarget(M$j,0,0,M$g.width,M$g.height,M$B.TEMP,"out",M$f,null,M$S.TOINT.overlay),M$t=M$ga.create([M$j],M$A._useOut),M$b.addRenderObject(M$t)),M$h[M$w].action.apply3d(M$j,M$a,M$b,0,0)}M$t=M$ga.create([M$j,M$b],M$A._EndTarget),M$b.addRenderObject(M$t)}else{if((M$p=!!M$a._$P._isHaveGlowFilter&&M$a._$P._isHaveGlowFilter)&&(M$n=50,M$o=25),(M$g=M$a.getBounds()).width<=0||M$g.height<=0)return;M$g.width+=M$n,M$g.height+=M$n,M$k.x=M$g.x*M$m.a+M$g.y*M$m.c,M$k.y=M$g.y*M$m.d+M$g.x*M$m.b,M$g.x=M$k.x,M$g.y=M$k.y,M$k.x=M$g.width*M$m.a+M$g.height*M$m.c,M$k.y=M$g.height*M$m.d+M$g.width*M$m.b,M$g.width=M$k.x,M$g.height=M$k.y,M$j.addValue("out",M$q)}M$c=M$c-M$o-M$a.x,M$d=M$d-M$o-M$a.y,M$k.setTo(M$c,M$d),M$m.transformPoint(M$k),M$c=M$k.x+M$g.x,M$d=M$k.y+M$g.y,M$f=M$Aa.create(1,0),M$B.TEMP.identity(),M$b.ctx.drawTarget(M$j,M$c,M$d,M$g.width,M$g.height,M$B.TEMP,"out",M$f,null,M$S.TOINT.overlay),M$t=M$ga.create([M$j],M$A._recycleScope),M$b.addRenderObject(M$t),M$m.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=M$g._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=M$g._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=M$g._uint8ArraySlice),!0},M$g.onStageResize=function(M$a,M$b){null!=M$g.mainContext&&(M$g.mainContext.viewport(0,0,M$a,M$b),M$sa.width=M$a,M$sa.height=M$b)},M$g.onInvalidGLRes=function(){M$Q.instance.freeAll(),M$u.releaseContentManagers(!0),M$g.doNodeRepaint(M$w.stage),M$g.mainContext.viewport(0,0,M$sa.width,M$sa.height),M$w.stage.event("devicelost")},M$g.doNodeRepaint=function(M$a){0==M$a.numChildren&&M$a.repaint();for(var M$b=0;M$b<M$a.numChildren;M$b++)M$g.doNodeRepaint(M$a.getChildAt(M$b))},M$g.init=function(M$a,M$b,M$c){M$g.mainCanvas=M$a,M$j._createContext=function(M$a){return new M$xa(M$a)},M$Ua._createContext=function(M$a){return new M$xa(M$a)};var M$d=laya.webgl.WebGL.mainContext;if(null!=M$d.getShaderPrecisionFormat){var M$e=M$d.getShaderPrecisionFormat(35633,36338),M$f=M$d.getShaderPrecisionFormat(35632,36338);M$g.shaderHighPrecision=!(!M$e.precision||!M$f.precision)}else M$g.shaderHighPrecision=!1;if(M$d.deleteTexture1=M$d.deleteTexture,M$d.deleteTexture=function(M$a){M$a==M$va.curBindTexValue&&(M$va.curBindTexValue=null),M$d.deleteTexture1(M$a)},M$g.onStageResize(M$b,M$c),null==M$g.mainContext)throw new Error("webGL getContext err!");M$I.__init__(),M$Q.__init__(),M$Ea.__init__(),M$fa.__init__(),M$xa.__init__(),M$Aa.__init__(),M$y.__init__(),M$Za.__int__(M$d),M$S._init_(M$d),M$r.isConchApp&&conch.setOnInvalidGLRes(M$g.onInvalidGLRes)},M$g.mainCanvas=null,M$g.mainContext=null,M$g.antialias=!0,M$g.shaderHighPrecision=!1,M$g._bg_null=[0,0,0,0],M$g}(),M$va=function(){function M$d(){}return M$m(M$d,"laya.webgl.WebGLContext"),M$d.UseProgram=function(M$a){return M$d._useProgram!==M$a&&(M$ua.mainContext.useProgram(M$a),M$d._useProgram=M$a,!0)},M$d.setDepthTest=function(M$a,M$b){M$b!==M$d._depthTest&&((M$d._depthTest=M$b)?M$a.enable(2929):M$a.disable(2929))},M$d.setDepthMask=function(M$a,M$b){M$b!==M$d._depthMask&&(M$d._depthMask=M$b,M$a.depthMask(M$b))},M$d.setDepthFunc=function(M$a,M$b){M$b!==M$d._depthFunc&&(M$d._depthFunc=M$b,M$a.depthFunc(M$b))},M$d.setBlend=function(M$a,M$b){M$b!==M$d._blend&&((M$d._blend=M$b)?M$a.enable(3042):M$a.disable(3042))},M$d.setBlendFunc=function(M$a,M$b,M$c){(M$b!==M$d._sFactor||M$c!==M$d._dFactor)&&(M$d._sFactor=M$b,M$d._dFactor=M$c,M$a.blendFunc(M$b,M$c))},M$d.setCullFace=function(M$a,M$b){M$b!==M$d._cullFace&&((M$d._cullFace=M$b)?M$a.enable(2884):M$a.disable(2884))},M$d.setFrontFace=function(M$a,M$b){M$b!==M$d._frontFace&&(M$d._frontFace=M$b,M$a.frontFace(M$b))},M$d.bindTexture=function(M$a,M$b,M$c){M$a.bindTexture(M$b,M$c),M$d.curBindTexTarget=M$b,M$d.curBindTexValue=M$c},M$d.DEPTH_BUFFER_BIT=256,M$d.STENCIL_BUFFER_BIT=1024,M$d.COLOR_BUFFER_BIT=16384,M$d.POINTS=0,M$d.LINES=1,M$d.LINE_LOOP=2,M$d.LINE_STRIP=3,M$d.TRIANGLES=4,M$d.TRIANGLE_STRIP=5,M$d.TRIANGLE_FAN=6,M$d.ZERO=0,M$d.ONE=1,M$d.SRC_COLOR=768,M$d.ONE_MINUS_SRC_COLOR=769,M$d.SRC_ALPHA=770,M$d.ONE_MINUS_SRC_ALPHA=771,M$d.DST_ALPHA=772,M$d.ONE_MINUS_DST_ALPHA=773,M$d.DST_COLOR=774,M$d.ONE_MINUS_DST_COLOR=775,M$d.SRC_ALPHA_SATURATE=776,M$d.FUNC_ADD=32774,M$d.BLEND_EQUATION=32777,M$d.BLEND_EQUATION_RGB=32777,M$d.BLEND_EQUATION_ALPHA=34877,M$d.FUNC_SUBTRACT=32778,M$d.FUNC_REVERSE_SUBTRACT=32779,M$d.BLEND_DST_RGB=32968,M$d.BLEND_SRC_RGB=32969,M$d.BLEND_DST_ALPHA=32970,M$d.BLEND_SRC_ALPHA=32971,M$d.CONSTANT_COLOR=32769,M$d.ONE_MINUS_CONSTANT_COLOR=32770,M$d.CONSTANT_ALPHA=32771,M$d.ONE_MINUS_CONSTANT_ALPHA=32772,M$d.BLEND_COLOR=32773,M$d.ARRAY_BUFFER=34962,M$d.ELEMENT_ARRAY_BUFFER=34963,M$d.ARRAY_BUFFER_BINDING=34964,M$d.ELEMENT_ARRAY_BUFFER_BINDING=34965,M$d.STREAM_DRAW=35040,M$d.STATIC_DRAW=35044,M$d.DYNAMIC_DRAW=35048,M$d.BUFFER_SIZE=34660,M$d.BUFFER_USAGE=34661,M$d.CURRENT_VERTEX_ATTRIB=34342,M$d.FRONT=1028,M$d.BACK=1029,M$d.CULL_FACE=2884,M$d.FRONT_AND_BACK=1032,M$d.BLEND=3042,M$d.DITHER=3024,M$d.STENCIL_TEST=2960,M$d.DEPTH_TEST=2929,M$d.SCISSOR_TEST=3089,M$d.POLYGON_OFFSET_FILL=32823,M$d.SAMPLE_ALPHA_TO_COVERAGE=32926,M$d.SAMPLE_COVERAGE=32928,M$d.NO_ERROR=0,M$d.INVALID_ENUM=1280,M$d.INVALID_VALUE=1281,M$d.INVALID_OPERATION=1282,M$d.OUT_OF_MEMORY=1285,M$d.CW=2304,M$d.CCW=2305,M$d.LINE_WIDTH=2849,M$d.ALIASED_POINT_SIZE_RANGE=33901,M$d.ALIASED_LINE_WIDTH_RANGE=33902,M$d.CULL_FACE_MODE=2885,M$d.FRONT_FACE=2886,M$d.DEPTH_RANGE=2928,M$d.DEPTH_WRITEMASK=2930,M$d.DEPTH_CLEAR_VALUE=2931,M$d.DEPTH_FUNC=2932,M$d.STENCIL_CLEAR_VALUE=2961,M$d.STENCIL_FUNC=2962,M$d.STENCIL_FAIL=2964,M$d.STENCIL_PASS_DEPTH_FAIL=2965,M$d.STENCIL_PASS_DEPTH_PASS=2966,M$d.STENCIL_REF=2967,M$d.STENCIL_VALUE_MASK=2963,M$d.STENCIL_WRITEMASK=2968,M$d.STENCIL_BACK_FUNC=34816,M$d.STENCIL_BACK_FAIL=34817,M$d.STENCIL_BACK_PASS_DEPTH_FAIL=34818,M$d.STENCIL_BACK_PASS_DEPTH_PASS=34819,M$d.STENCIL_BACK_REF=36003,M$d.STENCIL_BACK_VALUE_MASK=36004,M$d.STENCIL_BACK_WRITEMASK=36005,M$d.VIEWPORT=2978,M$d.SCISSOR_BOX=3088,M$d.COLOR_CLEAR_VALUE=3106,M$d.COLOR_WRITEMASK=3107,M$d.UNPACK_ALIGNMENT=3317,M$d.PACK_ALIGNMENT=3333,M$d.MAX_TEXTURE_SIZE=3379,M$d.MAX_VIEWPORT_DIMS=3386,M$d.SUBPIXEL_BITS=3408,M$d.RED_BITS=3410,M$d.GREEN_BITS=3411,M$d.BLUE_BITS=3412,M$d.ALPHA_BITS=3413,M$d.DEPTH_BITS=3414,M$d.STENCIL_BITS=3415,M$d.POLYGON_OFFSET_UNITS=10752,M$d.POLYGON_OFFSET_FACTOR=32824,M$d.TEXTURE_BINDING_2D=32873,M$d.SAMPLE_BUFFERS=32936,M$d.SAMPLES=32937,M$d.SAMPLE_COVERAGE_VALUE=32938,M$d.SAMPLE_COVERAGE_INVERT=32939,M$d.NUM_COMPRESSED_TEXTURE_FORMATS=34466,M$d.COMPRESSED_TEXTURE_FORMATS=34467,M$d.DONT_CARE=4352,M$d.FASTEST=4353,M$d.NICEST=4354,M$d.GENERATE_MIPMAP_HINT=33170,M$d.BYTE=5120,M$d.UNSIGNED_BYTE=5121,M$d.SHORT=5122,M$d.UNSIGNED_SHORT=5123,M$d.INT=5124,M$d.UNSIGNED_INT=5125,M$d.FLOAT=5126,M$d.DEPTH_COMPONENT=6402,M$d.ALPHA=6406,M$d.RGB=6407,M$d.RGBA=6408,M$d.LUMINANCE=6409,M$d.LUMINANCE_ALPHA=6410,M$d.UNSIGNED_SHORT_4_4_4_4=32819,M$d.UNSIGNED_SHORT_5_5_5_1=32820,M$d.UNSIGNED_SHORT_5_6_5=33635,M$d.FRAGMENT_SHADER=35632,M$d.VERTEX_SHADER=35633,M$d.MAX_VERTEX_ATTRIBS=34921,M$d.MAX_VERTEX_UNIFORM_VECTORS=36347,M$d.MAX_VARYING_VECTORS=36348,M$d.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,M$d.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,M$d.MAX_TEXTURE_IMAGE_UNITS=34930,M$d.MAX_FRAGMENT_UNIFORM_VECTORS=36349,M$d.SHADER_TYPE=35663,M$d.DELETE_STATUS=35712,M$d.LINK_STATUS=35714,M$d.VALIDATE_STATUS=35715,M$d.ATTACHED_SHADERS=35717,M$d.ACTIVE_UNIFORMS=35718,M$d.ACTIVE_ATTRIBUTES=35721,M$d.SHADING_LANGUAGE_VERSION=35724,M$d.CURRENT_PROGRAM=35725,M$d.NEVER=512,M$d.LESS=513,M$d.EQUAL=514,M$d.LEQUAL=515,M$d.GREATER=516,M$d.NOTEQUAL=517,M$d.GEQUAL=518,M$d.ALWAYS=519,M$d.KEEP=7680,M$d.REPLACE=7681,M$d.INCR=7682,M$d.DECR=7683,M$d.INVERT=5386,M$d.INCR_WRAP=34055,M$d.DECR_WRAP=34056,M$d.VENDOR=7936,M$d.RENDERER=7937,M$d.VERSION=7938,M$d.NEAREST=9728,M$d.LINEAR=9729,M$d.NEAREST_MIPMAP_NEAREST=9984,M$d.LINEAR_MIPMAP_NEAREST=9985,M$d.NEAREST_MIPMAP_LINEAR=9986,M$d.LINEAR_MIPMAP_LINEAR=9987,M$d.TEXTURE_MAG_FILTER=10240,M$d.TEXTURE_MIN_FILTER=10241,M$d.TEXTURE_WRAP_S=10242,M$d.TEXTURE_WRAP_T=10243,M$d.TEXTURE_2D=3553,M$d.TEXTURE=5890,M$d.TEXTURE_CUBE_MAP=34067,M$d.TEXTURE_BINDING_CUBE_MAP=34068,M$d.TEXTURE_CUBE_MAP_POSITIVE_X=34069,M$d.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,M$d.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,M$d.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,M$d.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,M$d.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,M$d.MAX_CUBE_MAP_TEXTURE_SIZE=34076,M$d.TEXTURE0=33984,M$d.TEXTURE1=33985,M$d.TEXTURE2=33986,M$d.TEXTURE3=33987,M$d.TEXTURE4=33988,M$d.TEXTURE5=33989,M$d.TEXTURE6=33990,M$d.TEXTURE7=33991,M$d.TEXTURE8=33992,M$d.TEXTURE9=33993,M$d.TEXTURE10=33994,M$d.TEXTURE11=33995,M$d.TEXTURE12=33996,M$d.TEXTURE13=33997,M$d.TEXTURE14=33998,M$d.TEXTURE15=33999,M$d.TEXTURE16=34e3,M$d.TEXTURE17=34001,M$d.TEXTURE18=34002,M$d.TEXTURE19=34003,M$d.TEXTURE20=34004,M$d.TEXTURE21=34005,M$d.TEXTURE22=34006,M$d.TEXTURE23=34007,M$d.TEXTURE24=34008,M$d.TEXTURE25=34009,M$d.TEXTURE26=34010,M$d.TEXTURE27=34011,M$d.TEXTURE28=34012,M$d.TEXTURE29=34013,M$d.TEXTURE30=34014,M$d.TEXTURE31=34015,M$d.ACTIVE_TEXTURE=34016,M$d.REPEAT=10497,M$d.CLAMP_TO_EDGE=33071,M$d.MIRRORED_REPEAT=33648,M$d.FLOAT_VEC2=35664,M$d.FLOAT_VEC3=35665,M$d.FLOAT_VEC4=35666,M$d.INT_VEC2=35667,M$d.INT_VEC3=35668,M$d.INT_VEC4=35669,M$d.BOOL=35670,M$d.BOOL_VEC2=35671,M$d.BOOL_VEC3=35672,M$d.BOOL_VEC4=35673,M$d.FLOAT_MAT2=35674,M$d.FLOAT_MAT3=35675,M$d.FLOAT_MAT4=35676,M$d.SAMPLER_2D=35678,M$d.SAMPLER_CUBE=35680,M$d.VERTEX_ATTRIB_ARRAY_ENABLED=34338,M$d.VERTEX_ATTRIB_ARRAY_SIZE=34339,M$d.VERTEX_ATTRIB_ARRAY_STRIDE=34340,M$d.VERTEX_ATTRIB_ARRAY_TYPE=34341,M$d.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,M$d.VERTEX_ATTRIB_ARRAY_POINTER=34373,M$d.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,M$d.COMPILE_STATUS=35713,M$d.LOW_FLOAT=36336,M$d.MEDIUM_FLOAT=36337,M$d.HIGH_FLOAT=36338,M$d.LOW_INT=36339,M$d.MEDIUM_INT=36340,M$d.HIGH_INT=36341,M$d.FRAMEBUFFER=36160,M$d.RENDERBUFFER=36161,M$d.RGBA4=32854,M$d.RGB5_A1=32855,M$d.RGB565=36194,M$d.DEPTH_COMPONENT16=33189,M$d.STENCIL_INDEX=6401,M$d.STENCIL_INDEX8=36168,M$d.DEPTH_STENCIL=34041,M$d.RENDERBUFFER_WIDTH=36162,M$d.RENDERBUFFER_HEIGHT=36163,M$d.RENDERBUFFER_INTERNAL_FORMAT=36164,M$d.RENDERBUFFER_RED_SIZE=36176,M$d.RENDERBUFFER_GREEN_SIZE=36177,M$d.RENDERBUFFER_BLUE_SIZE=36178,M$d.RENDERBUFFER_ALPHA_SIZE=36179,M$d.RENDERBUFFER_DEPTH_SIZE=36180,M$d.RENDERBUFFER_STENCIL_SIZE=36181,M$d.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,M$d.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,M$d.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,M$d.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,M$d.COLOR_ATTACHMENT0=36064,M$d.DEPTH_ATTACHMENT=36096,M$d.STENCIL_ATTACHMENT=36128,M$d.DEPTH_STENCIL_ATTACHMENT=33306,M$d.NONE=0,M$d.FRAMEBUFFER_COMPLETE=36053,M$d.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,M$d.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,M$d.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,M$d.FRAMEBUFFER_UNSUPPORTED=36061,M$d.FRAMEBUFFER_BINDING=36006,M$d.RENDERBUFFER_BINDING=36007,M$d.MAX_RENDERBUFFER_SIZE=34024,M$d.INVALID_FRAMEBUFFER_OPERATION=1286,M$d.UNPACK_FLIP_Y_WEBGL=37440,M$d.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,M$d.CONTEXT_LOST_WEBGL=37442,M$d.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,M$d.BROWSER_DEFAULT_WEBGL=37444,M$d._useProgram=null,M$d._depthTest=!0,M$d._depthMask=!0,M$d._blend=!1,M$d._cullFace=!1,M$d.curBindTexTarget=null,M$d.curBindTexValue=null,M$g(M$d,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),M$d}(),M$wa=function(M$a){function M$b(){M$b.__super.call(this)}M$m(M$b,"laya.webgl.display.GraphicsGL",M$h);var M$c=M$b.prototype;return M$c.setShader=function(M$a){this._saveToCmd(M$r.context._setShader,[M$a])},M$c.setIBVB=function(M$a,M$b,M$c,M$d,M$e,M$f){this._saveToCmd(M$r.context._setIBVB,[M$a,M$b,M$c,M$d,M$e,M$f])},M$c.drawParticle=function(M$a,M$b,M$c){var M$d=M$v.createParticleTemplate2D(M$c);M$d.x=M$a,M$d.y=M$b,this._saveToCmd(M$r.context._drawParticle,[M$d])},M$b}(),M$xa=function(M$a){var M$c;function M$P(M$a){this._x=0,this._y=0,this._id=++M$P._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,M$P.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=M$P.MAXCLIPRECT,this.mOutPoint,this._canvas=M$a,this._canvas._addReference(),M$P._contextcount++,M$r.isFlash?(this._ib=M$ya.create(35044),M$qa.fillIBQuadrangle(this._ib,16)):this._ib=M$ya.QuadrangleIB,this.clear()}M$m(M$P,"laya.webgl.canvas.WebGLContext2D",M$e);var M$b=M$P.prototype;return M$b.setIsMainContext=function(){this._isMain=!0},M$b.clearBG=function(M$a,M$b,M$c,M$d){var M$e=M$ua.mainContext;M$e.clearColor(M$a,M$b,M$c,M$d),M$e.clear(16384)},M$b._getSubmits=function(){return this._submits},M$b._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var M$a=0,M$b=this._submits._length;M$a<M$b;M$a++)this._submits[M$a].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},M$b.destroy=function(){--M$P._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=M$ya.QuadrangleIB&&this._ib.releaseResource()},M$b.clear=function(){this._submits||(this._other=M$c.DEFAULT,this._curMat=M$B.create(),this._vb=M$za.create(-1),this._submits=[],this._save=[M$Y.Create(this)],this._save.length=10,this._shader2D=new M$y,this._triangleMesh=M$Ka.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=M$c.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=M$P.MAXCLIPRECT,this._curSubmit=M$fa.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=M$T.DEFAULT;for(var M$a=0,M$b=this._submits._length;M$a<M$b;M$a++)this._submits[M$a].releaseRender(),this._submits[M$a]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},M$b.size=function(M$a,M$b){if(this._width!=M$a||this._height!=M$b)if(0==M$a||0==M$b){0!=this._vb._byteLength&&(this._width=M$a,this._height=M$b,this._vb.clear(),this._vb.upload());for(var M$c=0,M$d=this._submits._length;M$c<M$d;M$c++)this._submits[M$c].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=M$a,this._height=M$b,this._targets&&this._targets.size(M$a,M$b),this._canvas.memorySize-=this._canvas.memorySize;0===M$a&&0===M$b&&this._releaseMem()},M$b._getTransformMatrix=function(){return this._curMat},M$b.translate=function(M$a,M$b){0===M$a&&0===M$b||(M$$.save(this),this._curMat.bTransform&&(M$Z.save(this),this._curMat.transformPointN(M$C.TEMP.setTo(M$a,M$b)),M$a=M$C.TEMP.x,M$b=M$C.TEMP.y),this._x+=M$a,this._y+=M$b)},M$b.save=function(){this._save[this._save._length++]=M$Y.Create(this)},M$b.restore=function(){var M$a=this._save._length;if(!(M$a<1))for(var M$b=M$a-1;0<=M$b;M$b--){var M$c=this._save[M$b];if(M$c.restore(this),M$c.isSaveMark())return void(this._save._length=M$b)}},M$b._fillText=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){void 0===M$j&&(M$j=0);var M$k=this._shader2D,M$l=this._curSubmit.shaderValue,M$m=M$e?M$oa.create(M$e):this._other.font;if(M$Q.enabled)M$k.ALPHA!==M$l.ALPHA&&(M$k.glTexture=null),M$na.drawText(this,M$a,M$b,this._curMat,M$m,M$i||this._other.textAlign,M$f,M$g,M$h,M$c,M$d,M$j);else{this._shader2D.defines.getValue();var M$n=M$f?M$o.create(M$f)._color:M$k.colorAdd;M$k.ALPHA===M$l.ALPHA&&M$n===M$k.colorAdd&&M$l.colorAdd===M$k.colorAdd||(M$k.glTexture=null,M$k.colorAdd=M$n),M$na.drawText(this,M$a,M$b,this._curMat,M$m,M$i||this._other.textAlign,M$f,M$g,M$h,M$c,M$d,M$j)}},M$b.fillWords=function(M$a,M$b,M$c,M$d,M$e,M$f){this._fillText(null,M$a,M$b,M$c,M$d,M$e,null,-1,null,M$f)},M$b.fillBorderWords=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this._fillBorderText(null,M$a,M$b,M$c,M$d,M$e,M$f,M$g,null)},M$b.fillText=function(M$a,M$b,M$c,M$d,M$e,M$f){this._fillText(M$a,null,M$b,M$c,M$d,M$e,null,-1,M$f)},M$b.strokeText=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this._fillText(M$a,null,M$b,M$c,M$d,null,M$e,M$f||1,M$g)},M$b.fillBorderText=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){this._fillBorderText(M$a,null,M$b,M$c,M$d,M$e,M$f,M$g,M$h)},M$b._fillBorderText=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){if(!M$Q.enabled)return this._fillText(M$a,M$b,M$c,M$d,M$e,null,M$g,M$h||1,M$i),void this._fillText(M$a,M$b,M$c,M$d,M$e,M$f,null,-1,M$i);var M$j=this._shader2D,M$k=this._curSubmit.shaderValue;M$j.ALPHA!==M$k.ALPHA&&(M$j.glTexture=null);var M$l=M$e?(M$P._fontTemp.setFont(M$e),M$P._fontTemp):this._other.font;M$na.drawText(this,M$a,M$b,this._curMat,M$l,M$i||this._other.textAlign,M$f,M$g,M$h||1,M$c,M$d,0)},M$b.fillRect=function(M$a,M$b,M$c,M$d,M$e){var M$f=this._vb;if(M$qa.fillRectImgVb(M$f,this._clipRect,M$a,M$b,M$c,M$d,M$K.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var M$g=this._shader2D.fillStyle;M$e&&(this._shader2D.fillStyle=M$T.create(M$e));var M$h=this._shader2D,M$i=this._curSubmit.shaderValue;if(M$h.fillStyle!==M$i.fillStyle||M$h.ALPHA!==M$i.ALPHA){M$h.glTexture=null;var M$j=this._curSubmit=M$fa.createSubmit(this,this._ib,M$f,(M$f._byteLength-64)/32*3,M$Aa.create(2,0));M$j.shaderValue.color=M$h.fillStyle._color._color,M$j.shaderValue.ALPHA=M$h.ALPHA,this._submits[this._submits._length++]=M$j}this._curSubmit._numEle+=6,this._shader2D.fillStyle=M$g}},M$b.fillTexture=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){if(M$a.loaded&&M$a.bitmap&&M$a.source){var M$i=this._vb,M$j=M$a.bitmap.width,M$k=M$a.bitmap.height,M$l=M$a.uv,M$m=M$g.x%M$a.width,M$n=M$g.y%M$a.height;if(M$j!=M$h.w||M$k!=M$h.h){if(!M$h.w&&!M$h.h)switch(M$h.oy=M$h.ox=0,M$f){case"repeat":M$h.width=M$d,M$h.height=M$e;break;case"repeat-x":M$h.width=M$d,M$n<0?M$a.height+M$n>M$e?M$h.height=M$e:M$h.height=M$a.height+M$n:(M$h.oy=M$n,M$a.height+M$n>M$e?M$h.height=M$e-M$n:M$h.height=M$a.height);break;case"repeat-y":M$m<0?M$a.width+M$m>M$d?M$h.width=M$d:M$h.width=M$a.width+M$m:(M$h.ox=M$m,M$a.width+M$m>M$d?M$h.width=M$d-M$m:M$h.width=M$a.width),M$h.height=M$e;break;case"no-repeat":M$m<0?M$a.width+M$m>M$d?M$h.width=M$d:M$h.width=M$a.width+M$m:(M$h.ox=M$m,M$a.width+M$m>M$d?M$h.width=M$d-M$m:M$h.width=M$a.width),M$n<0?M$a.height+M$n>M$e?M$h.height=M$e:M$h.height=M$a.height+M$n:(M$h.oy=M$n,M$a.height+M$n>M$e?M$h.height=M$e-M$n:M$h.height=M$a.height);break;default:M$h.width=M$d,M$h.height=M$e}M$h.w=M$j,M$h.h=M$k,M$h.uv=[0,0,M$h.width/M$j,0,M$h.width/M$j,M$h.height/M$k,0,M$h.height/M$k]}if(M$b+=M$h.ox,M$c+=M$h.oy,M$m-=M$h.ox,M$n-=M$h.oy,M$qa.fillRectImgVb(M$i,this._clipRect,M$b,M$c,M$h.width,M$h.height,M$h.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var M$o=M$Ja.create(this,this._ib,M$i,(M$i._byteLength-64)/32*3,M$Aa.create(256,0)),M$p=(this._submits[this._submits._length++]=M$o).shaderValue;M$p.textureHost=M$a;var M$q=M$l[0]*M$j,M$r=M$l[1]*M$k,M$s=(M$l[2]-M$l[0])*M$j,M$t=(M$l[5]-M$l[3])*M$k,M$u=-M$m/M$j,M$v=-M$n/M$k;M$p.u_TexRange[0]=M$q/M$j,M$p.u_TexRange[1]=M$s/M$j,M$p.u_TexRange[2]=M$r/M$k,M$p.u_TexRange[3]=M$t/M$k,M$p.u_offset[0]=M$u,M$p.u_offset[1]=M$v,M$Q.enabled&&!this._isMain&&M$o.addTexture(M$a,(M$i._byteLength>>2)-16),(this._curSubmit=M$o)._renderType=10017,M$o._numEle+=6}}else this.sprite&&M$w.timer.callLater(this,this._repaintSprite)},M$b.setShader=function(M$a){M$V.save(this,1048576,this._shader2D,!0),this._shader2D.shader=M$a},M$b.setFilters=function(M$a){M$V.save(this,2097152,this._shader2D,!0),this._shader2D.filters=M$a,this._curSubmit=M$fa.RENDERBASE,this._renderKey=0,this._drawCount++},M$b.drawTexture=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this._drawTextureM(M$a,M$b,M$c,M$d,M$e,M$f,M$g,null,1)},M$b.addTextureVb=function(M$a,M$b,M$c){var M$d=this._curSubmit._vb||this._vb,M$e=M$d._byteLength>>2;M$d.byteLength=M$e+16<<2;for(var M$f=M$d.getFloat32Array(),M$g=0;M$g<16;M$g+=4)M$f[M$e++]=M$a[M$g]+M$b,M$f[M$e++]=M$a[M$g+1]+M$c,M$f[M$e++]=M$a[M$g+2],M$f[M$e++]=M$a[M$g+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),M$d._upload=!0},M$b.willDrawTexture=function(M$a,M$b){if(!(M$a.loaded&&M$a.bitmap&&M$a.source))return this.sprite&&M$w.timer.callLater(this,this._repaintSprite),0;var M$c=M$a.bitmap,M$d=M$c.id+this._shader2D.ALPHA*M$b+10016;if(M$d==this._renderKey)return M$d;var M$e=this._shader2D,M$f=M$e.ALPHA,M$g=this._curSubmit.shaderValue;M$e.ALPHA*=M$b,this._renderKey=M$d,this._drawCount++,M$e.glTexture=M$c;var M$h=this._vb,M$i=null,M$j=M$h._byteLength/32*3,M$k=M$g.textureHost&&M$g.textureHost==M$a&&M$g.textureHost.alphaTexture==M$a.alphaTexture;return M$i=M$Ja.create(this,this._ib,M$h,M$j,M$Aa.create(1,0)),(this._submits[this._submits._length++]=M$i).shaderValue.textureHost=M$a,M$i._renderType=10016,M$i._preIsSameTextureShader=10016===this._curSubmit._renderType&&M$e.ALPHA===M$g.ALPHA&&M$k,this._curSubmit=M$i,M$e.ALPHA=M$f,M$d},M$b.drawTextures=function(M$a,M$b,M$c,M$d){if(M$a.loaded&&M$a.bitmap&&M$a.source){var M$e=this._clipRect;if(this._clipRect=M$P.MAXCLIPRECT,this._drawTextureM(M$a,M$b[0],M$b[1],M$a.width,M$a.height,M$c,M$d,null,1)){if(this._clipRect=M$e,M$G.drawCall++,!(M$b.length<4)){for(var M$f=this._curSubmit._vb||this._vb,M$g=this._curMat.a,M$h=this._curMat.d,M$i=2,M$j=M$b.length;M$i<M$j;M$i+=2)M$qa.copyPreImgVb(M$f,(M$b[M$i]-M$b[M$i-2])*M$g,(M$b[M$i+1]-M$b[M$i-1])*M$h),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&M$w.timer.callLater(this,this._repaintSprite)},M$b._drawTextureM=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){if(!M$a.loaded||!M$a.source)return this.sprite&&M$w.timer.callLater(this,this._repaintSprite),!1;var M$j=this._curSubmit._vb||this._vb,M$k=M$a.bitmap;M$b+=M$f,M$c+=M$g,this._drawCount++;var M$l=M$k.id+this._shader2D.ALPHA*M$i+10016;if(M$l!=this._renderKey){this._renderKey=M$l;var M$m=this._curSubmit.shaderValue,M$n=this._shader2D,M$o=M$n.ALPHA;M$n.ALPHA*=M$i,M$n.glTexture=M$k;var M$p=this._vb,M$q=null,M$r=M$p._byteLength/32*3,M$s=M$m.textureHost&&M$m.textureHost==M$a&&M$m.textureHost.alphaTexture==M$a.alphaTexture;M$q=M$Ja.create(this,this._ib,M$p,M$r,M$Aa.create(1,0)),(this._submits[this._submits._length++]=M$q).shaderValue.textureHost=M$a,M$q._renderType=10016,M$q._preIsSameTextureShader=10016===this._curSubmit._renderType&&M$n.ALPHA===M$m.ALPHA&&M$s,this._curSubmit=M$q,M$j=this._curSubmit._vb||this._vb,M$n.ALPHA=M$o}return!!M$qa.fillRectImgVb(M$j,this._clipRect,M$b,M$c,M$d||M$a.width,M$e||M$a.height,M$a.uv,M$h||this._curMat,this._x,this._y,0,0)&&(M$Q.enabled&&!this._isMain&&this._curSubmit.addTexture(M$a,(M$j._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},M$b._repaintSprite=function(){this.sprite&&this.sprite.repaint()},M$b._drawText=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){var M$k=M$a.bitmap;this._drawCount++;var M$l=M$k.id+this._shader2D.ALPHA+10016;if(M$l!=this._renderKey){this._renderKey=M$l;var M$m=this._curSubmit.shaderValue,M$n=this._shader2D;M$n.glTexture=M$k;var M$o=this._vb,M$p=null,M$q=M$o._byteLength/32*3,M$r=M$m.textureHost&&M$m.textureHost==M$a&&M$m.textureHost.alphaTexture==M$a.alphaTexture;(M$p=M$Q.enabled?M$Ja.create(this,this._ib,M$o,M$q,M$Aa.create(1,0)):M$Ja.create(this,this._ib,M$o,M$q,M$$a.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&M$n.ALPHA===M$m.ALPHA&&M$r,(this._submits[this._submits._length++]=M$p).shaderValue.textureHost=M$a,M$p._renderType=10016,this._curSubmit=M$p}M$a.active();var M$s=this._curSubmit._vb||this._vb;M$qa.fillRectImgVb(M$s,this._clipRect,M$b+M$g,M$c+M$h,M$d||M$a.width,M$e||M$a.height,M$a.uv,M$f||this._curMat,this._x,this._y,M$i,M$j,!0)&&(M$Q.enabled&&!this._isMain&&this._curSubmit.addTexture(M$a,(M$s._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},M$b.drawTextureWithTransform=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){if(M$f){var M$j=this._curMat,M$k=this._x,M$l=this._y;(0!==M$g||0!==M$h)&&(this._x=M$g*M$j.a+M$h*M$j.c,this._y=M$h*M$j.d+M$g*M$j.b),M$f&&M$j.bTransform?(M$B.mul(M$f,M$j,M$P._tmpMatrix),(M$f=M$P._tmpMatrix)._checkTransform()):(this._x+=M$j.tx,this._y+=M$j.ty),this._drawTextureM(M$a,M$b,M$c,M$d,M$e,0,0,M$f,M$i),this._x=M$k,this._y=M$l}else this._drawTextureM(M$a,M$b,M$c,M$d,M$e,M$g,M$h,null,M$i)},M$b.fillQuadrangle=function(M$a,M$b,M$c,M$d,M$e){var M$f=this._curSubmit,M$g=this._vb,M$h=this._shader2D,M$i=M$f.shaderValue;if(this._renderKey=0,M$a.bitmap){var M$j=M$a.bitmap;M$h.glTexture==M$j&&M$h.ALPHA===M$i.ALPHA||(M$h.glTexture=M$j,(M$f=this._curSubmit=M$fa.createSubmit(this,this._ib,M$g,M$g._byteLength/32*3,M$Aa.create(1,0))).shaderValue.glTexture=M$j,this._submits[this._submits._length++]=M$f),M$qa.fillQuadrangleImgVb(M$g,M$b,M$c,M$d,M$a.uv,M$e||this._curMat,this._x,this._y)}else M$f.shaderValue.fillStyle&&M$f.shaderValue.fillStyle.equal(M$a)&&M$h.ALPHA===M$i.ALPHA||(M$h.glTexture=null,(M$f=this._curSubmit=M$fa.createSubmit(this,this._ib,M$g,M$g._byteLength/32*3,M$Aa.create(2,0))).shaderValue.defines.add(2),M$f.shaderValue.fillStyle=M$T.create(M$a),this._submits[this._submits._length++]=M$f),M$qa.fillQuadrangleImgVb(M$g,M$b,M$c,M$d,M$K.DEF_UV,M$e||this._curMat,this._x,this._y);M$f._numEle+=6},M$b.drawTexture2=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){if(0!=M$f){var M$i=this._curMat;if(this._x=M$a*M$i.a+M$b*M$i.c,this._y=M$b*M$i.d+M$a*M$i.b,M$e&&(M$e=M$i.bTransform||M$e.bTransform?(M$B.mul(M$e,M$i,M$P._tmpMatrix),M$P._tmpMatrix):(this._x+=M$e.tx+M$i.tx,this._y+=M$e.ty+M$i.ty,M$B.EMPTY)),1!==M$f||M$g){var M$j=this._shader2D.ALPHA,M$k=this._nBlendType;this._shader2D.ALPHA=M$f,M$g&&(this._nBlendType=M$S.TOINT(M$g)),this._drawTextureM(M$h[0],M$h[1]-M$c,M$h[2]-M$d,M$h[3],M$h[4],0,0,M$e,1),this._shader2D.ALPHA=M$j,this._nBlendType=M$k}else this._drawTextureM(M$h[0],M$h[1]-M$c,M$h[2]-M$d,M$h[3],M$h[4],0,0,M$e,1);this._x=this._y=0}},M$b.drawCanvas=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$a.context;if(this._renderKey=0,M$f._targets)this._submits[this._submits._length++]=M$Ia.create(M$f,0,null),this._curSubmit=M$fa.RENDERBASE,M$f._targets.drawTo(this,M$b,M$c,M$d,M$e);else{var M$g=this._submits[this._submits._length++]=M$Ia.create(M$f,this._shader2D.ALPHA,this._shader2D.filters),M$h=M$d/M$a.width,M$i=M$e/M$a.height,M$j=M$g._matrix;this._curMat.copyTo(M$j),1!=M$h&&1!=M$i&&M$j.scale(M$h,M$i);var M$k=M$j.tx,M$l=M$j.ty;M$j.tx=M$j.ty=0,M$j.transformPoint(M$C.TEMP.setTo(M$b,M$c)),M$j.translate(M$C.TEMP.x+M$k,M$C.TEMP.y+M$l),this._curSubmit=M$fa.RENDERBASE}M$x.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=M$f._targets?"yellow":"green",this.strokeRect(M$b-1,M$c-1,M$d+2,M$e+2,1),this.strokeRect(M$b,M$c,M$d,M$e,1),this.restore())},M$b.drawTarget=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){void 0===M$j&&(M$j=-1);var M$k=this._vb;if(M$qa.fillRectImgVb(M$k,this._clipRect,M$b,M$c,M$d,M$e,M$i||M$K.DEF_UV,M$f||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var M$l=this._curSubmit=M$la.create(this,this._ib,M$k,(M$k._byteLength-64)/32*3,M$h,M$g);M$l.blendType=-1==M$j?this._nBlendType:M$j,M$l.scope=M$a,this._submits[this._submits._length++]=M$l,this._curSubmit._numEle+=6}},M$b.mixRGBandAlpha=function(M$a){return this._mixRGBandAlpha(M$a,this._shader2D.ALPHA)},M$b._mixRGBandAlpha=function(M$a,M$b){var M$c=(4278190080&M$a)>>>24;return 0!=M$c?M$c*=M$b:M$c=255*M$b,16777215&M$a|M$c<<24},M$b.drawTriangles=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){if(!M$a.loaded||!M$a.source)return this.sprite&&M$w.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;M$a.bitmap;var M$k=this._mixRGBandAlpha(4294967295,M$h),M$l=(M$d.length,M$f.length);this._renderKey=-1;var M$m=this._curSubmit=M$Ja.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,M$Aa.create(1,0));return M$m.shaderValue.textureHost=M$a,M$m._renderType=10016,this._submits[this._submits._length++]=M$m,M$g?(M$P._tmpMatrix.a=M$g.a,M$P._tmpMatrix.b=M$g.b,M$P._tmpMatrix.c=M$g.c,M$P._tmpMatrix.d=M$g.d,M$P._tmpMatrix.tx=M$g.tx+M$b,M$P._tmpMatrix.ty=M$g.ty+M$c,M$B.mul(M$P._tmpMatrix,this._curMat,M$P._tmpMatrix)):(M$P._tmpMatrix.a=this._curMat.a,M$P._tmpMatrix.b=this._curMat.b,M$P._tmpMatrix.c=this._curMat.c,M$P._tmpMatrix.d=this._curMat.d,M$P._tmpMatrix.tx=this._curMat.tx+M$b,M$P._tmpMatrix.ty=this._curMat.ty+M$c),this._triangleMesh.addData(M$d,M$e,M$f,M$P._tmpMatrix,M$k,this),this._curSubmit._numEle+=M$l,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},M$b.transform=function(M$a,M$b,M$c,M$d,M$e,M$f){M$Z.save(this),M$B.mul(M$B.TEMP.setTo(M$a,M$b,M$c,M$d,M$e,M$f),this._curMat,this._curMat),this._curMat._checkTransform()},M$b.setTransformByMatrix=function(M$a){M$a.copyTo(this._curMat)},M$b.transformByMatrix=function(M$a){M$Z.save(this),M$B.mul(M$a,this._curMat,this._curMat),this._curMat._checkTransform()},M$b.rotate=function(M$a){M$Z.save(this),this._curMat.rotateEx(M$a)},M$b.scale=function(M$a,M$b){M$Z.save(this),this._curMat.scaleEx(M$a,M$b)},M$b.clipRect=function(M$a,M$b,M$c,M$d){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var M$e=M$ka.create(4);this.addRenderObject(M$e);var M$f=this._vb,M$g=M$f._byteLength>>2;if(M$qa.fillRectImgVb(M$f,null,M$a,M$b,M$c,M$d,M$K.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var M$h=this._curSubmit=M$fa.createSubmit(this,this._ib,M$f,(M$f._byteLength-64)/32*3,M$Aa.create(2,0));M$h.shaderValue.ALPHA=1,this._submits[this._submits._length++]=M$h,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var M$i=M$ka.create(5);this.addRenderObject(M$i);var M$j=M$f.getFloat32Array(),M$k=Math.min(Math.min(Math.min(M$j[0+M$g],M$j[4+M$g]),M$j[8+M$g]),M$j[12+M$g]),M$l=Math.max(Math.max(Math.max(M$j[0+M$g],M$j[4+M$g]),M$j[8+M$g]),M$j[12+M$g]),M$m=Math.min(Math.min(Math.min(M$j[1+M$g],M$j[5+M$g]),M$j[9+M$g]),M$j[13+M$g]),M$n=Math.max(Math.max(Math.max(M$j[1+M$g],M$j[5+M$g]),M$j[9+M$g]),M$j[13+M$g]);M$X.save(this,M$i,M$a,M$b,M$c,M$d,M$k,M$m,M$l-M$k,M$n-M$m),this._curSubmit=M$fa.RENDERBASE}else{M$c*=this._curMat.a,M$d*=this._curMat.d;var M$o=M$C.TEMP;this._curMat.transformPoint(M$o.setTo(M$a,M$b)),M$c<0&&(M$o.x=M$o.x+M$c,M$c=-M$c),M$d<0&&(M$o.y=M$o.y+M$d,M$d=-M$d),this._renderKey=0;var M$p=this._curSubmit=M$ja.create(this);(this._submits[this._submits._length++]=M$p).submitIndex=this._submits._length,M$p.submitLength=9999999,M$W.save(this,M$p);var M$q=this._clipRect,M$r=M$q.x,M$s=M$q.y,M$t=M$o.x+M$c,M$u=M$o.y+M$d;M$r<M$o.x&&(M$q.x=M$o.x),M$s<M$o.y&&(M$q.y=M$o.y),M$q.width=Math.min(M$t,M$r+M$q.width)-M$q.x,M$q.height=Math.min(M$u,M$s+M$q.height)-M$q.y,this._shader2D.glTexture=null,M$p.clipRect.copyFrom(M$q),this._curSubmit=M$fa.RENDERBASE}},M$b.setIBVB=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k){if(void 0===M$i&&(M$i=0),void 0===M$j&&(M$j=0),void 0===M$k&&(M$k=0),null===M$c){if(M$r.isFlash){var M$l=M$d;M$l._selfIB||(M$l._selfIB=M$ya.create(35044)),M$l._selfIB.clear(),M$c=M$l._selfIB}else M$c=this._ib;M$qa.expandIBQuadrangle(M$c,M$d._byteLength/(4*M$d.vertexStride*4))}if(!M$h||!M$g)throw Error("setIBVB must input:shader shaderValues");var M$m=M$ia.create(this,M$d,M$c,M$e,M$g,M$h,M$i,M$j,M$k);M$f||(M$f=M$B.EMPTY),M$f.translate(M$a,M$b),M$B.mul(M$f,this._curMat,M$m._mat),M$f.translate(-M$a,-M$b),this._submits[this._submits._length++]=M$m,this._curSubmit=M$fa.RENDERBASE,this._renderKey=0},M$b.addRenderObject=function(M$a){this._submits[this._submits._length++]=M$a},M$b.fillTrangles=function(M$a,M$b,M$c,M$d,M$e){var M$f=this._curSubmit,M$g=this._vb,M$h=this._shader2D,M$i=M$f.shaderValue,M$j=M$d.length>>4,M$k=M$a.bitmap;this._renderKey=0,M$h.glTexture==M$k&&M$h.ALPHA===M$i.ALPHA||((M$f=this._curSubmit=M$fa.createSubmit(this,this._ib,M$g,M$g._byteLength/32*3,M$Aa.create(1,0))).shaderValue.textureHost=M$a,this._submits[this._submits._length++]=M$f),M$qa.fillTranglesVB(M$g,M$b,M$c,M$d,M$e||this._curMat,this._x,this._y),M$f._numEle+=6*M$j},M$b.submitElement=function(M$a,M$b){var M$c=this._submits;for(M$b<0&&(M$b=M$c._length);M$a<M$b;)M$a+=M$c[M$a].renderSubmit()},M$b.finish=function(){M$ua.mainContext.finish()},M$b.flush=function(){var M$a=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(M$a>this._ib.bufferLength/12&&M$qa.expandIBQuadrangle(this._ib,M$a),!this._isMain&&M$Q.enabled&&M$Q._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=M$Q._atlasRestore;for(var M$b=this._submits,M$c=0,M$d=M$b._length;M$c<M$d;M$c++){var M$e=M$b[M$c];10016===M$e.getRenderType()&&M$e.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),M$ba.instance&&M$ba.getInstance().reset();var M$f;for(M$c=0,M$f=this.meshlist.length;M$c<M$f;M$c++){var M$g=this.meshlist[M$c];M$g.canReuse?M$g.releaseMesh():M$g.destroy()}return this.meshlist.length=0,this._curSubmit=M$fa.RENDERBASE,this._renderKey=0,this._triangleMesh=M$Ka.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},M$b.setPathId=function(M$a){if(this.mId=M$a,-1!=this.mId){this.mHaveKey=!1;var M$b=M$M.getInstance();M$b.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,M$b.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},M$b.movePath=function(M$a,M$b){var M$c=M$a,M$d=M$b;M$a=this._curMat.a*M$c+this._curMat.c*M$d+this._curMat.tx,M$b=this._curMat.b*M$c+this._curMat.d*M$d+this._curMat.ty,this.mX+=M$a,this.mY+=M$b},M$b.beginPath=function(){var M$a=this._getPath();M$a.tempArray.length=0,M$a.closePath=!1,this.mX=0,this.mY=0},M$b.closePath=function(){this._path.closePath=!0},M$b.fill=function(M$a){void 0===M$a&&(M$a=!1);var M$b=this._getPath();this.drawPoly(0,0,M$b.tempArray,this.fillStyle._color.numColor,0,0,M$a)},M$b.stroke=function(){var M$a=this._getPath();if(0<this.lineWidth){if(-1==this.mId)M$a.drawLine(0,0,M$a.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var M$b=M$M.getInstance().shapeLineDic[this.mId];M$b.rebuild(M$a.tempArray),M$a.setGeomtry(M$b)}else M$M.getInstance().addLine(this.mId,M$a.drawLine(0,0,M$a.tempArray,this.lineWidth,this.strokeStyle._color.numColor));M$a.update();var M$c=[this.mX,this.mY],M$d=M$fa.createShape(this,M$a.ib,M$a.vb,M$a.count,M$a.offset,M$Aa.create(4,0));M$d.shaderValue.ALPHA=this._shader2D.ALPHA,M$d.shaderValue.u_pos=M$c,M$d.shaderValue.u_mmat2=M$sa.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=M$d,this._renderKey=-1}},M$b.line=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=this._curSubmit,M$h=this._vb;if(M$qa.fillLineVb(M$h,this._clipRect,M$a,M$b,M$c,M$d,M$e,M$f)){this._renderKey=0;var M$i=this._shader2D,M$j=M$g.shaderValue;M$i.strokeStyle===M$j.strokeStyle&&M$i.ALPHA===M$j.ALPHA||(M$i.glTexture=null,(M$g=this._curSubmit=M$fa.createSubmit(this,this._ib,M$h,(M$h._byteLength-64)/32*3,M$Aa.create(2,0))).shaderValue.strokeStyle=M$i.strokeStyle,M$g.shaderValue.mainID=2,M$g.shaderValue.ALPHA=M$i.ALPHA,this._submits[this._submits._length++]=M$g),M$g._numEle+=6}},M$b.moveTo=function(M$a,M$b,M$c){void 0===M$c&&(M$c=!0);var M$d=this._getPath();if(M$c){var M$e=M$a,M$f=M$b;M$a=this._curMat.a*M$e+this._curMat.c*M$f,M$b=this._curMat.b*M$e+this._curMat.d*M$f}M$d.addPoint(M$a,M$b)},M$b.lineTo=function(M$a,M$b,M$c){void 0===M$c&&(M$c=!0);var M$d=this._getPath();if(M$c){var M$e=M$a,M$f=M$b;M$a=this._curMat.a*M$e+this._curMat.c*M$f,M$b=this._curMat.b*M$e+this._curMat.d*M$f}M$d.addPoint(M$a,M$b)},M$b.drawCurves=function(M$a,M$b,M$c){this.setPathId(-1),this.beginPath(),this.strokeStyle=M$c[3],this.lineWidth=M$c[4];var M$d=M$c[2];M$a+=M$c[0],M$b+=M$c[1],this.movePath(M$a,M$b),this.moveTo(M$d[0],M$d[1]);for(var M$e=2,M$f=M$d.length;M$e<M$f;)this.quadraticCurveTo(M$d[M$e++],M$d[M$e++],M$d[M$e++],M$d[M$e++]);this.stroke()},M$b.arcTo=function(M$a,M$b,M$c,M$d,M$e){if(-1==this.mId||!this.mHaveKey){var M$f=0,M$g=0,M$h=0,M$i=this._getPath();this._curMat.copyTo(M$P._tmpMatrix),M$P._tmpMatrix.tx=M$P._tmpMatrix.ty=0,M$P._tempPoint.setTo(M$i.getEndPointX(),M$i.getEndPointY()),M$P._tmpMatrix.invertTransformPoint(M$P._tempPoint);var M$j=M$P._tempPoint.x-M$a,M$k=M$P._tempPoint.y-M$b,M$l=Math.sqrt(M$j*M$j+M$k*M$k);if(!(M$l<=1e-6)){var M$m=M$j/M$l,M$n=M$k/M$l,M$o=M$c-M$a,M$p=M$d-M$b,M$q=M$o*M$o+M$p*M$p,M$r=Math.sqrt(M$q);if(!(M$r<=1e-6)){var M$s=M$o/M$r,M$t=M$p/M$r,M$u=M$m+M$s,M$v=M$n+M$t,M$w=Math.sqrt(M$u*M$u+M$v*M$v);if(!(M$w<=1e-6)){var M$x=M$u/M$w,M$A=M$v/M$w,M$B=Math.acos(M$x*M$m+M$A*M$n),M$C=Math.PI/2-M$B,M$D=(M$l=M$e/Math.tan(M$C))*M$m+M$a,M$E=M$l*M$n+M$b,M$F=Math.sqrt(M$l*M$l+M$e*M$e),M$G=M$a+M$x*M$F,M$H=M$b+M$A*M$F,M$I=0,M$J=0;if(0<=M$m*M$t-M$n*M$s){var M$K=2*M$C/M$P.SEGNUM;M$I=Math.sin(M$K),M$J=Math.cos(M$K)}else M$K=2*-M$C/M$P.SEGNUM,M$I=Math.sin(M$K),M$J=Math.cos(M$K);M$g=this._curMat.a*M$D+this._curMat.c*M$E,M$h=this._curMat.b*M$D+this._curMat.d*M$E,M$g==this._path.getEndPointX()&&M$h==this._path.getEndPointY()||M$i.addPoint(M$g,M$h);var M$L=M$D-M$G,M$M=M$E-M$H;for(M$f=0;M$f<M$P.SEGNUM;M$f++){var M$N=M$L*M$J+M$M*M$I,M$O=-M$L*M$I+M$M*M$J;M$g=M$N+M$G,M$h=M$O+M$H,M$a=this._curMat.a*M$g+this._curMat.c*M$h,M$h=M$b=this._curMat.b*M$g+this._curMat.d*M$h,(M$g=M$a)==this._path.getEndPointX()&&M$h==this._path.getEndPointY()||M$i.addPoint(M$g,M$h),M$L=M$N,M$M=M$O}}}}}},M$b.arc=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){if(void 0===M$f&&(M$f=!1),void 0===M$g&&(M$g=!0),-1!=this.mId){var M$h=M$M.getInstance().shapeDic[this.mId];if(M$h&&this.mHaveKey&&!M$h.needUpdate(this._curMat))return;M$b=M$a=0}var M$i,M$j=0,M$k=0,M$l=0,M$m=0,M$n=0,M$o=0,M$p=0;if(M$k=M$e-M$d,M$f)if(Math.abs(M$k)>=2*Math.PI)M$k=2*-Math.PI;else for(;0<M$k;)M$k-=2*Math.PI;else if(Math.abs(M$k)>=2*Math.PI)M$k=2*Math.PI;else for(;M$k<0;)M$k+=2*Math.PI;M$i=M$k/(M$p=M$c<101?Math.max(10,M$k*M$c/5):M$c<201?Math.max(10,M$k*M$c/20):Math.max(10,M$k*M$c/40))/2,M$l=Math.abs(4/3*(1-Math.cos(M$i))/Math.sin(M$i)),M$f&&(M$l=-M$l);var M$q=this._getPath(),M$r=NaN,M$s=NaN;for(M$o=0;M$o<=M$p;M$o++)M$j=M$d+M$k*(M$o/M$p),M$m=M$a+Math.cos(M$j)*M$c,M$n=M$b+Math.sin(M$j)*M$c,M$g&&(M$r=M$m,M$s=M$n,M$m=this._curMat.a*M$r+this._curMat.c*M$s,M$n=this._curMat.b*M$r+this._curMat.d*M$s),M$m==this._path.getEndPointX()&&M$n==this._path.getEndPointY()||M$q.addPoint(M$m,M$n);M$m=M$a+Math.cos(M$e)*M$c,M$n=M$b+Math.sin(M$e)*M$c,M$g&&(M$r=M$m,M$s=M$n,M$m=this._curMat.a*M$r+this._curMat.c*M$s,M$n=this._curMat.b*M$r+this._curMat.d*M$s),M$m==this._path.getEndPointX()&&M$n==this._path.getEndPointY()||M$q.addPoint(M$m,M$n)},M$b.quadraticCurveTo=function(M$a,M$b,M$c,M$d){var M$e=M$l.I,M$f=M$c,M$g=M$d;M$c=this._curMat.a*M$f+this._curMat.c*M$g,M$d=this._curMat.b*M$f+this._curMat.d*M$g,M$f=M$a,M$g=M$b,M$a=this._curMat.a*M$f+this._curMat.c*M$g,M$b=this._curMat.b*M$f+this._curMat.d*M$g;for(var M$h=M$e.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),M$a,M$b,M$c,M$d],30,2),M$i=0,M$j=M$h.length/2;M$i<M$j;M$i++)this.lineTo(M$h[2*M$i],M$h[2*M$i+1],!1);this.lineTo(M$c,M$d,!1)},M$b.rect=function(M$a,M$b,M$c,M$d){this._other=this._other.make(),this._other.path||(this._other.path=new M$U),this._other.path.rect(M$a,M$b,M$c,M$d)},M$b.strokeRect=function(M$a,M$b,M$c,M$d,M$e){var M$f=.5*M$e;this.line(M$a-M$f,M$b,M$a+M$c+M$f,M$b,M$e,this._curMat),this.line(M$a+M$c,M$b,M$a+M$c,M$b+M$d,M$e,this._curMat),this.line(M$a,M$b,M$a,M$b+M$d,M$e,this._curMat),this.line(M$a-M$f,M$b+M$d,M$a+M$c+M$f,M$b+M$d,M$e,this._curMat)},M$b.clip=function(){},M$b.drawPoly=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){void 0===M$g&&(M$g=!1),this._renderKey=0,this._shader2D.glTexture=null;var M$h=this._getPath();if(-1==this.mId)M$h.polygon(M$a,M$b,M$c,M$d,M$e||1,M$f);else if(this.mHaveKey){var M$i=M$M.getInstance().shapeDic[this.mId];M$i.setMatrix(this._curMat),M$i.rebuild(M$h.tempArray),M$h.setGeomtry(M$i)}else{var M$j=M$h.polygon(M$a,M$b,M$c,M$d,M$e||1,M$f);M$M.getInstance().addShape(this.mId,M$j),M$j.setMatrix(this._curMat)}M$h.update();var M$k,M$l=[this.mX,this.mY];if((M$k=M$fa.createShape(this,M$h.ib,M$h.vb,M$h.count,M$h.offset,M$Aa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,M$k.shaderValue.u_pos=M$l,M$k.shaderValue.u_mmat2=M$sa.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=M$k,0<M$e){if(this.mHaveLineKey){var M$m=M$M.getInstance().shapeLineDic[this.mId];M$m.rebuild(M$h.tempArray),M$h.setGeomtry(M$m)}else M$M.getInstance().addShape(this.mId,M$h.drawLine(M$a,M$b,M$c,M$e,M$f));M$h.update(),(M$k=M$fa.createShape(this,M$h.ib,M$h.vb,M$h.count,M$h.offset,M$Aa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,M$k.shaderValue.u_mmat2=M$sa.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=M$k}},M$b.drawParticle=function(M$a,M$b,M$c){M$c.x=M$a,M$c.y=M$b,this._submits[this._submits._length++]=M$c},M$b._getPath=function(){return this._path||(this._path=new M$U)},M$d(0,M$b,"globalCompositeOperation",function(){return M$S.NAMES[this._nBlendType]},function(M$a){var M$b=M$S.TOINT[M$a];null==M$b||this._nBlendType===M$b||(M$V.save(this,65536,this,!0),this._curSubmit=M$fa.RENDERBASE,this._renderKey=0,this._nBlendType=M$b)}),M$d(0,M$b,"strokeStyle",function(){return this._shader2D.strokeStyle},function(M$a){this._shader2D.strokeStyle.equal(M$a)||(M$V.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=M$T.create(M$a))}),M$d(0,M$b,"globalAlpha",function(){return this._shader2D.ALPHA},function(M$a){(M$a=Math.floor(1e3*M$a)/1e3)!=this._shader2D.ALPHA&&(M$V.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=M$a)}),M$d(0,M$b,"asBitmap",null,function(M$a){if(M$a){if(this._targets||(this._targets=new M$_),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),M$d(0,M$b,"fillStyle",function(){return this._shader2D.fillStyle},function(M$a){this._shader2D.fillStyle.equal(M$a)||(M$V.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=M$T.create(M$a))}),M$d(0,M$b,"textAlign",function(){return this._other.textAlign},function(M$a){this._other.textAlign===M$a||(this._other=this._other.make(),M$V.save(this,32768,this._other,!1),this._other.textAlign=M$a)}),M$d(0,M$b,"lineWidth",function(){return this._other.lineWidth},function(M$a){this._other.lineWidth===M$a||(this._other=this._other.make(),M$V.save(this,256,this._other,!1),this._other.lineWidth=M$a)}),M$d(0,M$b,"textBaseline",function(){return this._other.textBaseline},function(M$a){this._other.textBaseline===M$a||(this._other=this._other.make(),M$V.save(this,16384,this._other,!1),this._other.textBaseline=M$a)}),M$d(0,M$b,"font",null,function(M$a){M$a!=this._other.font.toString()&&(this._other=this._other.make(),M$V.save(this,8,this._other,!1),this._other.font===M$oa.EMPTY?this._other.font=new M$oa(M$a):this._other.font.setFont(M$a))}),M$P.__init__=function(){M$c.DEFAULT=new M$c},M$P._tempPoint=new M$C,M$P._SUBMITVBSIZE=32e3,M$P._MAXSIZE=99999999,M$P._RECTVBSIZE=16,M$P.MAXCLIPRECT=new M$D(0,0,99999999,99999999),M$P._COUNT=0,M$P._tmpMatrix=new M$B,M$P.SEGNUM=32,M$P._contextcount=0,M$g(M$P,["_fontTemp",function(){return this._fontTemp=new M$oa},"_drawStyleTemp",function(){return this._drawStyleTemp=new M$T(null)}]),M$P.__init$=function(){M$c=function(){function M$a(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=M$oa.EMPTY}M$m(M$a,"");var M$b=M$a.prototype;return M$b.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=M$oa.EMPTY},M$b.make=function(){return this===M$a.DEFAULT?new M$a:this},M$a.DEFAULT=null,M$a}()},M$P}(),M$Aa=function(M$a){function M$d(M$a,M$b){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,M$d.__super.call(this),this.defines=new M$Ea,this.position=M$d._POSITION,this.mainID=M$a,this.subID=M$b,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=M$a|M$b,this._inClassCache=M$d._cache[this._cacheID],0<M$a&&!this._inClassCache&&(this._inClassCache=M$d._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}M$m(M$d,"laya.webgl.shader.d2.value.Value2D",M$O);var M$b=M$d.prototype;return M$b.setValue=function(M$a){},M$b.refresh=function(){var M$a=this.size;return M$a[0]=M$sa.width,M$a[1]=M$sa.height,this.alpha=this.ALPHA*M$sa.worldAlpha,this.mmat=M$sa.worldMatrix4,this},M$b._ShaderWithCompile=function(){return M$Ya.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,M$_a.create)},M$b._withWorldShaderDefines=function(){var M$a=M$sa.worldShaderDefines,M$b=M$Ya.sharders[this.mainID|this.defines._value|M$a.getValue()];if(!M$b){var M$c,M$d={};for(M$c in this.defines.toNameDic())M$d[M$c]="";for(M$c in M$a.toNameDic())M$d[M$c]="";M$b=M$Ya.withCompile2D(0,this.mainID,M$d,this.mainID|this.defines._value|M$a.getValue(),M$_a.create)}var M$e=M$sa.worldFilters;if(!M$e)return M$b;for(var M$f,M$g=M$e.length,M$h=0;M$h<M$g;M$h++)(M$f=M$e[M$h])&&M$f.action.setValue(this);return M$b},M$b.upload=function(){var M$a=M$sa;this.alpha=this.ALPHA*M$a.worldAlpha,M$sa.worldMatrix4!==M$sa.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),M$ua.shaderHighPrecision&&this.defines.add(1024);var M$b,M$c=M$a.worldShaderDefines?this._withWorldShaderDefines():M$Ya.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=M$a.width,this.size[1]=M$a.height,this.mmat=M$a.worldMatrix4,M$La.activeShader!==M$c?M$c._shaderValueWidth!==M$a.width||M$c._shaderValueHeight!==M$a.height?(M$c._shaderValueWidth=M$a.width,M$c._shaderValueHeight=M$a.height):M$b=M$c._params2dQuick2||M$c._make2dQuick2():M$c._shaderValueWidth!==M$a.width||M$c._shaderValueHeight!==M$a.height?(M$c._shaderValueWidth=M$a.width,M$c._shaderValueHeight=M$a.height):M$b=M$c._params2dQuick1||M$c._make2dQuick1(),M$c.upload(this,M$b)},M$b.setFilters=function(M$a){if(this.filters=M$a)for(var M$b,M$c=M$a.length,M$d=0;M$d<M$c;M$d++)(M$b=M$a[M$d])&&(this.defines.add(M$b.type),M$b.action.setValue(this))},M$b.clear=function(){this.defines.setValue(this.subID)},M$b.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},M$d._initone=function(M$a,M$b){M$d._typeClass[M$a]=M$b,M$d._cache[M$a]=[],M$d._cache[M$a]._length=0},M$d.__init__=function(){M$d._POSITION=[2,5126,!1,4*M$pa.BYTES_PE,0],M$d._TEXCOORD=[2,5126,!1,4*M$pa.BYTES_PE,2*M$pa.BYTES_PE],M$d._initone(2,M$Pa),M$d._initone(4,M$Sa),M$d._initone(256,M$Qa),M$d._initone(512,M$Oa),M$d._initone(1,M$Ra),M$d._initone(65,M$$a),M$d._initone(9,M$Ra)},M$d.create=function(M$a,M$b){var M$c=M$d._cache[M$a|M$b];return M$c._length?M$c[--M$c._length]:new M$d._typeClass[M$a|M$b](M$b)},M$d._POSITION=null,M$d._TEXCOORD=null,M$d._cache=[],M$d._typeClass=[],M$d.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],M$d}(),M$Ba=function(M$a){function M$q(M$a,M$b){M$q.__super.call(this,M$a,M$b)}M$m(M$q,"laya.webgl.utils.RenderSprite3D",M$s);var M$b=M$q.prototype;return M$b.onCreate=function(M$a){switch(M$a){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},M$b._mask=function(M$a,M$b,M$c,M$d){var M$e,M$f,M$g=this._next,M$h=M$a.mask;if(M$h){M$b.ctx.save();var M$i=M$b.ctx.globalCompositeOperation,M$j=new M$D;if(M$j.copyFrom(M$h.getBounds()),M$j.width=Math.round(M$j.width),M$j.height=Math.round(M$j.height),M$j.x=Math.round(M$j.x),M$j.y=Math.round(M$j.y),0<M$j.width&&0<M$j.height){var M$k=M$a._style._tf,M$l=M$ha.create();M$l.addValue("bounds",M$j),M$e=M$ga.create([M$l,M$b],laya.webgl.utils.RenderSprite3D.tmpTarget),M$b.addRenderObject(M$e),M$h.render(M$b,-M$j.x,-M$j.y),M$e=M$ga.create([M$l],laya.webgl.utils.RenderSprite3D.endTmpTarget),M$b.addRenderObject(M$e),M$b.ctx.save(),M$b.clipRect(M$c-M$k.translateX+M$j.x,M$d-M$k.translateY+M$j.y,M$j.width,M$j.height),M$g._fun.call(M$g,M$a,M$b,M$c,M$d),M$b.ctx.restore(),M$f=M$ka.create(6),M$i=M$b.ctx.globalCompositeOperation,M$f.blendMode="mask",M$b.addRenderObject(M$f),M$B.TEMP.identity();var M$m=M$Aa.create(1,0),M$n=M$K.INV_UV,M$o=M$j.width,M$p=M$j.height;(M$j.width<32||M$j.height<32)&&((M$n=M$q.tempUV)[0]=0,M$n[1]=0,M$n[2]=32<=M$j.width?1:M$j.width/32,M$n[3]=0,M$n[4]=32<=M$j.width?1:M$j.width/32,M$n[5]=32<=M$j.height?1:M$j.height/32,M$n[6]=0,M$n[7]=32<=M$j.height?1:M$j.height/32,M$j.width=32<=M$j.width?M$j.width:32,M$j.height=32<=M$j.height?M$j.height:32,M$n[1]*=-1,M$n[3]*=-1,M$n[5]*=-1,M$n[7]*=-1,M$n[1]+=1,M$n[3]+=1,M$n[5]+=1,M$n[7]+=1),M$b.ctx.drawTarget(M$l,M$c+M$j.x-M$k.translateX,M$d+M$j.y-M$k.translateY,M$o,M$p,M$B.TEMP,"tmpTarget",M$m,M$n,6),M$e=M$ga.create([M$l],laya.webgl.utils.RenderSprite3D.recycleTarget),M$b.addRenderObject(M$e),(M$f=M$ka.create(6)).blendMode=M$i,M$b.addRenderObject(M$f)}M$b.ctx.restore()}else M$g._fun.call(M$g,M$a,M$b,M$c,M$d)},M$b._blend=function(M$a,M$b,M$c,M$d){var M$e=M$a._style,M$f=this._next;M$e.blendMode?(M$b.ctx.save(),M$b.ctx.globalCompositeOperation=M$e.blendMode,M$f._fun.call(M$f,M$a,M$b,M$c,M$d),M$b.ctx.restore()):M$f._fun.call(M$f,M$a,M$b,M$c,M$d)},M$b._transform=function(M$a,M$b,M$c,M$d){var M$e=M$a.transform,M$f=this._next;if(M$e&&M$f!=M$s.NORENDER){var M$g=M$b.ctx;M$a._style;M$e.tx=M$c,M$e.ty=M$d;var M$h=M$g._getTransformMatrix(),M$i=M$h.clone();M$B.mul(M$e,M$h,M$h),M$h._checkTransform(),M$e.tx=M$e.ty=0,M$f._fun.call(M$f,M$a,M$b,0,0),M$i.copyTo(M$h),M$i.destroy()}else M$f._fun.call(M$f,M$a,M$b,M$c,M$d)},M$q.tmpTarget=function(M$a,M$b){var M$c=M$a.getValue("bounds"),M$d=M$Ma.create(M$c.width,M$c.height);M$d.start(),M$d.clear(0,0,0,0),M$a.addValue("tmpTarget",M$d)},M$q.endTmpTarget=function(M$a){M$a.getValue("tmpTarget").end()},M$q.recycleTarget=function(M$a){M$a.getValue("tmpTarget").recycle(),M$a.recycle()},M$g(M$q,["tempUV",function(){return this.tempUV=new Array(8)}]),M$q}(),M$Ca=function(M$a){function M$b(){this.data=null,M$b.__super.call(this)}M$m(M$b,"laya.filters.webgl.ColorFilterActionGL",M$N);var M$c=M$b.prototype;return M$w.imps(M$c,{"laya.filters.IFilterActionGL":!0}),M$c.setValue=function(M$a){M$a.colorMat=this.data._mat,M$a.colorAlpha=this.data._alpha},M$c.apply3d=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$a.getValue("bounds"),M$g=M$Aa.create(1,0);M$g.setFilters([this.data]);var M$h=M$B.TEMP;M$h.identity(),M$c.ctx.drawTarget(M$a,0,0,M$f.width,M$f.height,M$h,"src",M$g)},M$b}(),M$Da=function(M$a){function M$f(M$a,M$b,M$c,M$d,M$e){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,M$f.__super.call(this,M$a,M$b,M$e),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new M$Ta,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=M$c,this._atlasCanvas.height=M$d,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}M$m(M$f,"laya.webgl.atlas.Atlaser",M$P);var M$b=M$f.prototype;return M$b.computeUVinAtlasTexture=function(M$a,M$b,M$c,M$d){var M$e=M$Q.atlasTextureWidth,M$f=M$Q.atlasTextureHeight,M$g=M$c/M$e,M$h=M$d/M$f,M$i=(M$c+M$a.bitmap.width)/M$e,M$j=(M$d+M$a.bitmap.height)/M$f,M$k=M$a.bitmap.width/M$e,M$l=M$a.bitmap.height/M$f;M$a.uv=[M$g+M$b[0]*M$k,M$h+M$b[1]*M$l,M$i-(1-M$b[2])*M$k,M$h+M$b[3]*M$l,M$i-(1-M$b[4])*M$k,M$j-(1-M$b[5])*M$l,M$g+M$b[6]*M$k,M$j-(1-M$b[7])*M$l]},M$b.findBitmapIsExist=function(M$a){if(M$a instanceof laya.webgl.resource.WebGLImage){var M$b=M$a,M$c=M$b.url,M$d=this._InAtlasWebGLImagesKey[M$c||M$b.id];if(M$d)return M$d.offsetInfoID}return-1},M$b.addToAtlasTexture=function(M$a,M$b,M$c){if(M$a instanceof laya.webgl.resource.WebGLImage){var M$d=M$a,M$e=M$d.url;this._InAtlasWebGLImagesKey[M$e||M$d.id]={bitmap:M$a,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([M$b,M$c])}this._atlasCanvas.texSubImage2D(M$b,M$c,M$a.atlasSource),M$a.clearAtlasSource()},M$b.addToAtlas=function(M$a,M$b,M$c){M$a._atlasID=this._inAtlasTextureKey.length;var M$d=M$a.uv.slice(),M$e=M$a.bitmap;this._inAtlasTextureKey.push(M$a),this._inAtlasTextureOriUVValue.push(M$d),this._inAtlasTextureBitmapValue.push(M$e),this.computeUVinAtlasTexture(M$a,M$d,M$b,M$c),M$a.bitmap=this._atlasCanvas},M$b.clear=function(){for(var M$a=0,M$b=this._inAtlasTextureKey.length;M$a<M$b;M$a++)this._inAtlasTextureKey[M$a].bitmap=this._inAtlasTextureBitmapValue[M$a],this._inAtlasTextureKey[M$a].uv=this._inAtlasTextureOriUVValue[M$a],this._inAtlasTextureKey[M$a]._atlasID=-1,this._inAtlasTextureKey[M$a].bitmap.lock=!1,this._inAtlasTextureKey[M$a].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},M$b.dispose=function(){this.clear(),this._atlasCanvas.destroy()},M$d(0,M$b,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),M$d(0,M$b,"texture",function(){return this._atlasCanvas}),M$d(0,M$b,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),M$f}(),M$Ea=function(M$a){function M$c(){M$c.__super.call(this,M$c.__name2int,M$c.__int2name,M$c.__int2nameMap)}return M$m(M$c,"laya.webgl.shader.d2.ShaderDefines2D",M$z),M$c.__init__=function(){M$c.reg("TEXTURE2D",1),M$c.reg("COLOR2D",2),M$c.reg("PRIMITIVE",4),M$c.reg("GLOW_FILTER",8),M$c.reg("BLUR_FILTER",16),M$c.reg("COLOR_FILTER",32),M$c.reg("COLOR_ADD",64),M$c.reg("WORLDMAT",128),M$c.reg("FILLTEXTURE",256),M$c.reg("FSHIGHPRECISION",1024),M$c.reg("TXTALPHA",2048),M$c.reg("TXTCOMPRESS",4096)},M$c.reg=function(M$a,M$b){M$z._reg(M$a,M$b,M$c.__name2int,M$c.__int2name)},M$c.toText=function(M$a,M$b,M$c){return M$z._toText(M$a,M$b,M$c)},M$c.toInt=function(M$a){return M$z._toInt(M$a,M$c.__name2int)},M$c.TEXTURE2D=1,M$c.COLOR2D=2,M$c.PRIMITIVE=4,M$c.FILTERGLOW=8,M$c.FILTERBLUR=16,M$c.FILTERCOLOR=32,M$c.COLORADD=64,M$c.WORLDMAT=128,M$c.FILLTEXTURE=256,M$c.SKINMESH=512,M$c.SHADERDEFINE_FSHIGHPRECISION=1024,M$c.TXTALPHA=2048,M$c.TXTCOMPRESS=4096,M$c.__name2int={},M$c.__int2name=[],M$c.__int2nameMap=[],M$c}(),M$Fa=(function(M$a){function M$h(M$a,M$b,M$c,M$d,M$e,M$f,M$g){M$h.__super.call(this,M$a,M$b,M$c,M$d,40,M$e,M$f,M$g)}M$m(M$h,"laya.webgl.shapes.Ellipse",M$ca)}(),function(M$a){function M$f(M$a,M$b,M$c,M$d,M$e){this._points=[],this.rebuild(M$c),M$f.__super.call(this,M$a,M$b,0,0,0,M$e,M$d,M$e,0)}M$m(M$f,"laya.webgl.shapes.Line",M$ca);var M$b=M$f.prototype;return M$b.rebuild=function(M$a){var M$b=M$a.length;M$b!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(M$b/2-1)),this.mFloat32Array=new Float32Array(5*M$b)),this._points.length=0;for(var M$c=NaN,M$d=NaN,M$e=-1,M$f=-1,M$g=M$a.length/2,M$h=0;M$h<M$g;M$h++)M$c=M$a[2*M$h],M$d=M$a[2*M$h+1],(.01<Math.abs(M$e-M$c)||.01<Math.abs(M$f-M$d))&&this._points.push(M$c,M$d),M$e=M$c,M$f=M$d},M$b.getData=function(M$a,M$b,M$c){var M$d=[],M$e=[];0<this.borderWidth&&this.createLine2(this._points,M$d,this.borderWidth,M$c,M$e,this._points.length/2),this.mUint16Array.set(M$d,0),this.mFloat32Array.set(M$e,0),M$a.append(this.mUint16Array),M$b.append(this.mFloat32Array)},M$f}()),M$Ga=function(M$a){function M$l(M$a,M$b,M$c,M$d,M$e){this._points=[];for(var M$f=NaN,M$g=NaN,M$h=-1,M$i=-1,M$j=M$c.length/2-1,M$k=0;M$k<M$j;M$k++)M$f=M$c[2*M$k],M$g=M$c[2*M$k+1],(.01<Math.abs(M$h-M$f)||.01<Math.abs(M$i-M$g))&&this._points.push(M$f,M$g),M$h=M$f,M$i=M$g;M$f=M$c[2*M$j],M$g=M$c[2*M$j+1],M$h=this._points[0],M$i=this._points[1],(.01<Math.abs(M$h-M$f)||.01<Math.abs(M$i-M$g))&&this._points.push(M$f,M$g),M$l.__super.call(this,M$a,M$b,0,0,this._points.length/2,0,M$d,M$e)}M$m(M$l,"laya.webgl.shapes.LoopLine",M$ca);var M$b=M$l.prototype;return M$b.getData=function(M$a,M$b,M$c){if(0<this.borderWidth){for(var M$d=this.color,M$e=(M$d>>16&255)/255,M$f=(M$d>>8&255)/255,M$g=(255&M$d)/255,M$h=[],M$i=0,M$j=0,M$k=[],M$l=Math.floor(this._points.length/2),M$m=0;M$m<M$l;M$m++)M$i=this._points[2*M$m],M$j=this._points[2*M$m+1],M$h.push(this.x+M$i,this.y+M$j,M$e,M$f,M$g);this.createLoopLine(M$h,M$k,this.borderWidth,M$c+M$h.length/5),M$a.append(new Uint16Array(M$k)),M$b.append(new Float32Array(M$h))}},M$b.createLoopLine=function(M$a,M$b,M$c,M$d,M$e,M$f){M$a.length;var M$g=M$a.concat(),M$h=M$e||M$a,M$i=this.borderColor,M$j=(M$i>>16&255)/255,M$k=(M$i>>8&255)/255,M$l=(255&M$i)/255,M$m=[M$g[0],M$g[1]],M$n=[M$g[M$g.length-5],M$g[M$g.length-4]],M$o=M$n[0]+.5*(M$m[0]-M$n[0]),M$p=M$n[1]+.5*(M$m[1]-M$n[1]);M$g.unshift(M$o,M$p,0,0,0),M$g.push(M$o,M$p,0,0,0);var M$q,M$r,M$s,M$t,M$u,M$v,M$w,M$x,M$A,M$B,M$C,M$D,M$E,M$F,M$G,M$H,M$I,M$J,M$K,M$L,M$M=M$g.length/5,M$N=M$d,M$O=M$c/2;M$s=M$g[0],M$t=M$g[1],M$B=M$s-(M$u=M$g[5]),M$A=(M$A=-(M$t-(M$v=M$g[6])))/(M$L=Math.sqrt(M$A*M$A+M$B*M$B))*M$O,M$B=M$B/M$L*M$O,M$h.push(M$s-M$A,M$t-M$B,M$j,M$k,M$l,M$s+M$A,M$t+M$B,M$j,M$k,M$l);for(var M$P=1;M$P<M$M-1;M$P++)M$s=M$g[5*(M$P-1)],M$t=M$g[5*(M$P-1)+1],M$u=M$g[5*M$P],M$v=M$g[5*M$P+1],M$w=M$g[5*(M$P+1)],M$x=M$g[5*(M$P+1)+1],M$B=M$s-M$u,M$D=M$u-M$w,M$G=(-(M$A=(M$A=-(M$t-M$v))/(M$L=Math.sqrt(M$A*M$A+M$B*M$B))*M$O)+M$s)*(-(M$B=M$B/M$L*M$O)+M$v)-(-M$A+M$u)*(-M$B+M$t),M$J=(-(M$C=(M$C=-(M$v-M$x))/(M$L=Math.sqrt(M$C*M$C+M$D*M$D))*M$O)+M$w)*(-(M$D=M$D/M$L*M$O)+M$v)-(-M$C+M$u)*(-M$D+M$x),M$K=(M$E=-M$B+M$t-(-M$B+M$v))*(M$I=-M$C+M$u-(-M$C+M$w))-(M$H=-M$D+M$x-(-M$D+M$v))*(M$F=-M$A+M$u-(-M$A+M$s)),Math.abs(M$K)<.1?(M$K+=10.1,M$h.push(M$u-M$A,M$v-M$B,M$j,M$k,M$l,M$u+M$A,M$v+M$B,M$j,M$k,M$l)):(((M$q=(M$F*M$J-M$I*M$G)/M$K)-M$u)*(M$q-M$u)+((M$r=(M$H*M$G-M$E*M$J)/M$K)-M$v)+(M$r-M$v),M$h.push(M$q,M$r,M$j,M$k,M$l,M$u-(M$q-M$u),M$v-(M$r-M$v),M$j,M$k,M$l));M$f&&(M$b=M$f);var M$Q=this.edges+1;for(M$P=1;M$P<M$Q;M$P++)M$b.push(M$N+2*(M$P-1),M$N+2*(M$P-1)+1,M$N+2*M$P+1,M$N+2*M$P+1,M$N+2*M$P,M$N+2*(M$P-1));return M$b.push(M$N+2*(M$P-1),M$N+2*(M$P-1)+1,M$N+1,M$N+1,M$N,M$N+2*(M$P-1)),M$h},M$l}(),M$Ha=function(M$a){function M$g(M$a,M$b,M$c,M$d,M$e,M$f){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=M$B.create(),this._points=M$c.slice(0,M$c.length),M$g.__super.call(this,M$a,M$b,0,0,this._points.length/2,M$d,M$e,M$f)}M$m(M$g,"laya.webgl.shapes.Polygon",M$ca);var M$b=M$g.prototype;return M$b.rebuild=function(M$a){this._repaint||(this._points.length=0,this._points=this._points.concat(M$a))},M$b.setMatrix=function(M$a){M$a.copyTo(this._mat)},M$b.needUpdate=function(M$a){return this._repaint=this._mat.a==M$a.a&&this._mat.b==M$a.b&&this._mat.c==M$a.c&&this._mat.d==M$a.d&&this._mat.tx==M$a.tx&&this._mat.ty==M$a.ty,!this._repaint},M$b.getData=function(M$a,M$b,M$c){var M$d,M$e=0,M$f=this._points,M$g=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=M$c){for(this._start=M$c,M$d=[],M$g=this.earcutTriangles.length,M$e=0;M$e<M$g;M$e++)M$d.push(this.earcutTriangles[M$e]+M$c);this.mUint16Array=new Uint16Array(M$d)}}else{this._start=M$c,M$d=[];var M$h=[],M$i=[],M$j=this.color,M$k=(M$j>>16&255)/255,M$l=(M$j>>8&255)/255,M$m=(255&M$j)/255;for(M$g=Math.floor(M$f.length/2),M$e=0;M$e<M$g;M$e++)M$h.push(this.x+M$f[2*M$e],this.y+M$f[2*M$e+1],M$k,M$l,M$m),M$i.push(this.x+M$f[2*M$e],this.y+M$f[2*M$e+1]);for(this.earcutTriangles=M$da.earcut(M$i,null,2),M$g=this.earcutTriangles.length,M$e=0;M$e<M$g;M$e++)M$d.push(this.earcutTriangles[M$e]+M$c);this.mUint16Array=new Uint16Array(M$d),this.mFloat32Array=new Float32Array(M$h)}M$a.append(this.mUint16Array),M$b.append(this.mFloat32Array)},M$g}(),M$Ia=function(M$a){function M$f(){this._matrix=new M$B,this._matrix4=M$pa.defaultMatrix4.concat(),M$f.__super.call(this,1e4),this.shaderValue=new M$Aa(0,0)}M$m(M$f,"laya.webgl.submit.SubmitCanvas",M$fa);var M$b=M$f.prototype;return M$b.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var M$a=M$sa.worldAlpha,M$b=M$sa.worldMatrix4,M$c=M$sa.worldMatrix,M$d=M$sa.worldFilters,M$e=M$sa.worldShaderDefines,M$f=this.shaderValue,M$g=this._matrix,M$h=this._matrix4,M$i=M$B.TEMP;return M$B.mul(M$g,M$c,M$i),M$h[0]=M$i.a,M$h[1]=M$i.b,M$h[4]=M$i.c,M$h[5]=M$i.d,M$h[12]=M$i.tx,M$h[13]=M$i.ty,M$sa.worldMatrix=M$i.clone(),M$sa.worldMatrix4=M$h,M$sa.worldAlpha=M$sa.worldAlpha*M$f.alpha,M$f.filters&&M$f.filters.length&&(M$sa.worldFilters=M$f.filters,M$sa.worldShaderDefines=M$f.defines),this._ctx_src.flush(),M$sa.worldAlpha=M$a,M$sa.worldMatrix4=M$b,M$sa.worldMatrix.destroy(),M$sa.worldMatrix=M$c,M$sa.worldFilters=M$d,M$sa.worldShaderDefines=M$e,1},M$b.releaseRender=function(){var M$a=M$f._cache;this._ctx_src=null,M$a[M$a._length++]=this},M$b.getRenderType=function(){return 10003},M$f.create=function(M$a,M$b,M$c){var M$d=M$f._cache._length?M$f._cache[--M$f._cache._length]:new M$f;M$d._ctx_src=M$a;var M$e=M$d.shaderValue;return M$e.alpha=M$b,M$e.defines.setValue(0),M$c&&M$c.length&&M$e.setFilters(M$c),M$d},M$f._cache=((M$f._cache=[])._length=0,M$f._cache),M$f}(),M$Ja=function(M$a){function M$j(M$a){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===M$a&&(M$a=1e4),M$j.__super.call(this,M$a)}M$m(M$j,"laya.webgl.submit.SubmitTexture",M$fa);var M$b=M$j.prototype;return M$b.releaseRender=function(){var M$a=M$j._cache;(M$a[M$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},M$b.addTexture=function(M$a,M$b){this._texsID[this._texs.length]=M$a._uvID,this._texs.push(M$a),this._vbPos.push(M$b)},M$b.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var M$a=this.shaderValue.textureHost.bitmap;if(null!==M$a)for(var M$b=this._vb.getFloat32Array(),M$c=0,M$d=this._texs.length;M$c<M$d;M$c++){var M$e=this._texs[M$c];M$e.active();var M$f=M$e.uv;if(this._texsID[M$c]!==M$e._uvID){this._texsID[M$c]=M$e._uvID;var M$g=this._vbPos[M$c];M$b[M$g+2]=M$f[0],M$b[M$g+3]=M$f[1],M$b[M$g+6]=M$f[2],M$b[M$g+7]=M$f[3],M$b[M$g+10]=M$f[4],M$b[M$g+11]=M$f[5],M$b[M$g+14]=M$f[6],M$b[M$g+15]=M$f[7],this._vb.setNeedUpload()}M$e.bitmap!==M$a&&(this._isSameTexture=!1)}}},M$b.renderSubmit=function(){if(0===this._numEle)return M$j._shaderSet=!1,1;var M$a=this.shaderValue.textureHost;if(M$a){var M$b=M$a.source;if(!M$a.bitmap||!M$b)return M$j._shaderSet=!1,1;this.shaderValue.texture=M$b,M$a.alphaTexture&&M$a.alphaTexture.source&&(this.shaderValue.texture1=M$a.alphaTexture.source)}this._vb.bind_upload(this._ib);var M$c=M$ua.mainContext;if(M$S.activeBlendFunction!==this._blendFn&&(M$c.enable(3042),this._blendFn(M$c),M$S.activeBlendFunction=this._blendFn),M$G.drawCall++,M$G.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&M$La.activeShader&&M$j._shaderSet?(M$La.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&M$La.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),M$j._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var M$d=M$a.bitmap,M$e=0,M$f=M$La.activeShader,M$g=0,M$h=this._texs.length;M$g<M$h;M$g++){var M$i=this._texs[M$g];M$i.bitmap===M$d&&M$g+1!==M$h||(M$f.uploadTexture2D(M$i.source),M$c.drawElements(4,6*(M$g-M$e+1),5123,this._startIdx+6*M$e*M$pa.BYTES_PIDX),M$d=M$i.bitmap,M$e=M$g)}else M$c.drawElements(4,this._numEle,5123,this._startIdx);return 1},M$j.create=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$j._cache._length?M$j._cache[--M$j._cache._length]:new M$j;null==M$c&&((M$c=M$f._selfVb||(M$f._selfVb=M$za.create(-1))).clear(),M$d=0),M$f._ib=M$b,M$f._vb=M$c,M$f._startIdx=M$d*M$pa.BYTES_PIDX,M$f._numEle=0;var M$g=M$a._nBlendType;M$f._blendFn=M$a._targets?M$S.targetFns[M$g]:M$S.fns[M$g],M$f.shaderValue=M$e,M$f.shaderValue.setValue(M$a._shader2D);var M$h=M$a._shader2D.filters;return M$h&&M$f.shaderValue.setFilters(M$h),M$f},M$j._cache=((M$j._cache=[])._length=0,M$j._cache),M$j._shaderSet=!0,M$j}(),M$Ka=function(M$a){function M$r(){M$r.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}M$m(M$r,"laya.webgl.utils.MeshTexture",M$ra);var M$b=M$r.prototype;return M$b.addData=function(M$a,M$b,M$c,M$d,M$e,M$f){for(var M$g=M$a.length/2,M$h=this._vb.needSize(M$g*M$r.const_stride)>>2,M$i=this._vb.getFloat32Array(),M$j=0,M$k=0;M$k<M$g;M$k++){var M$l=M$a[M$j],M$m=M$a[M$j+1],M$n=M$l*M$d.a+M$m*M$d.c+M$d.tx,M$o=M$l*M$d.b+M$m*M$d.d+M$d.ty;M$i[M$h++]=M$n,M$i[M$h++]=M$o,M$i[M$h++]=M$b[M$j],M$i[M$h++]=M$b[M$j+1],M$j+=2}this._vb.setNeedUpload();var M$p=this.vertNum;if(0<M$p){(M$g=M$c.length)>M$r.tmpIdx.length&&(M$r.tmpIdx=new Uint16Array(M$g));for(var M$q=0;M$q<M$g;M$q++)M$r.tmpIdx[M$q]=M$c[M$q]+M$p;this._ib.appendU16Array(M$r.tmpIdx,M$c.length)}else this._ib.append(M$c);this._ib.setNeedUpload(),this.vertNum+=M$g,this.indexNum+=M$c.length},M$b.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},M$b.destroy=function(){this._ib.destroy(),this._vb.destroy()},M$r.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new M$r},M$r.const_stride=16,M$r._POOL=[],M$g(M$r,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),M$r}(),M$La=function(M$a){function M$b(){M$b.__super.call(this),this.lock=!0}return M$m(M$b,"laya.webgl.shader.BaseShader",M$t),M$b.activeShader=null,M$b.bindShader=null,M$b}(),M$Ma=function(M$b){function M$k(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===M$c&&(M$c=6408),void 0===M$d&&(M$d=5121),void 0===M$e&&(M$e=34041),void 0===M$f&&(M$f=!1),void 0===M$g&&(M$g=!1),void 0===M$h&&(M$h=-1),void 0===M$i&&(M$i=-1),this._type=1,this._w=M$a,this._h=M$b,this._surfaceFormat=M$c,this._surfaceType=M$d,this._depthStencilFormat=M$e,M$r.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=M$f,this._repeat=M$g,this._minFifter=M$h,this._magFifter=M$i,this._createWebGLRenderTarget(),this.bitmap.lock=!0,M$k.__super.call(this,this.bitmap,M$K.INV_UV)}M$m(M$k,"laya.webgl.resource.RenderTarget2D",M$b);var M$a=M$k.prototype;return M$w.imps(M$a,{"laya.resource.IDispose":!0}),M$a.getType=function(){return this._type},M$a.getTexture=function(){return this},M$a.size=function(M$a,M$b){this._w==M$a&&this._h==M$b||(this._w=M$a,this._h=M$b,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},M$a.release=function(){this.destroy()},M$a.recycle=function(){M$k.POOL.push(this)},M$a.start=function(){var M$a=M$ua.mainContext;return this._preRenderTarget=M$sa.curRenderTarget,M$sa.curRenderTarget=this,M$a.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(M$a.viewport(0,0,this._w,this._h),this._svWidth=M$sa.width,this._svHeight=M$sa.height,M$sa.width=this._w,M$sa.height=this._h,M$La.activeShader=null),this},M$a.clear=function(M$a,M$b,M$c,M$d){void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=1);var M$e=M$ua.mainContext;M$e.clearColor(M$a,M$b,M$c,M$d);var M$f=16384;switch(this._depthStencilFormat){case 33189:M$f|=256;break;case 36168:M$f|=1024;break;case 34041:M$f|=256,M$f|=1024}M$e.clear(M$f)},M$a.end=function(){var M$a=M$ua.mainContext;M$a.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,M$sa.curRenderTarget=this._preRenderTarget,1==this._type?(M$a.viewport(0,0,this._svWidth,this._svHeight),M$sa.width=this._svWidth,M$sa.height=this._svHeight,M$La.activeShader=null):M$a.viewport(0,0,M$w.stage.width,M$w.stage.height)},M$a.getData=function(M$a,M$b,M$c,M$d){var M$e=M$ua.mainContext;if(M$e.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===M$e.checkFramebufferStatus(36160)))return M$e.bindFramebuffer(36160,null),null;var M$f=new Uint8Array(this._w*this._h*4);return M$e.readPixels(M$a,M$b,M$c,M$d,this._surfaceFormat,this._surfaceType,M$f),M$e.bindFramebuffer(36160,null),M$f},M$a.destroy=function(M$a){void 0===M$a&&(M$a=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,M$b.prototype.destroy.call(this))},M$a.dispose=function(){},M$a._createWebGLRenderTarget=function(){this.bitmap=new M$Wa(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(M$a){this.event("recovered")})},M$d(0,M$a,"surfaceFormat",function(){return this._surfaceFormat}),M$d(0,M$a,"magFifter",function(){return this._magFifter}),M$d(0,M$a,"surfaceType",function(){return this._surfaceType}),M$d(0,M$a,"mipMap",function(){return this._mipMap}),M$d(0,M$a,"depthStencilFormat",function(){return this._depthStencilFormat}),M$d(0,M$a,"minFifter",function(){return this._minFifter}),M$d(0,M$a,"source",function(){return this._alreadyResolved?M$w.superGet(M$K,this,"source"):null}),M$k.create=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){void 0===M$c&&(M$c=6408),void 0===M$d&&(M$d=5121),void 0===M$e&&(M$e=34041),void 0===M$f&&(M$f=!1),void 0===M$g&&(M$g=!1),void 0===M$h&&(M$h=-1),void 0===M$i&&(M$i=-1);var M$j=M$k.POOL.pop();return M$j||(M$j=new M$k(M$a,M$b)),M$j.bitmap&&M$j._w==M$a&&M$j._h==M$b&&M$j._surfaceFormat==M$c&&M$j._surfaceType==M$d&&M$j._depthStencilFormat==M$e&&M$j._mipMap==M$f&&M$j._repeat==M$g&&M$j._minFifter==M$h&&M$j._magFifter==M$i||(M$j._w=M$a,M$j._h=M$b,M$j._surfaceFormat=M$c,M$j._surfaceType=M$d,M$j._depthStencilFormat=M$e,M$r.isConchWebGL&&34041===M$j._depthStencilFormat&&(M$j._depthStencilFormat=33189),M$j._mipMap=M$f,M$j._repeat=M$g,M$j._minFifter=M$h,M$j._magFifter=M$i,M$j.release(),M$j._createWebGLRenderTarget()),M$j},M$k.TYPE2D=1,M$k.TYPE3D=2,M$k.POOL=[],M$k}(M$K),M$Na=function(M$a){function M$b(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,M$b.__super.call(this),M$b._gl=M$ua.mainContext}M$m(M$b,"laya.webgl.utils.Buffer",M$t);var M$c=M$b.prototype;return M$c._bind=function(){this.activeResource(),M$b._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(M$b._bindVertexBuffer=this._glBuffer),M$b._gl.bindBuffer(this._bufferType,M$b._bindActive[this._bufferType]=this._glBuffer),M$La.activeShader=null)},M$c.recreateResource=function(){this._glBuffer||(this._glBuffer=M$b._gl.createBuffer()),this.completeCreate()},M$c.disposeResource=function(){this._glBuffer&&(M$ua.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},M$d(0,M$c,"bufferUsage",function(){return this._bufferUsage}),M$b._gl=null,M$b._bindActive={},M$b._bindVertexBuffer=null,M$b._enableAtributes=[],M$b}(),M$Oa=function(M$a){function M$c(M$a){this.texcoord=null,this.offsetX=300,this.offsetY=0,M$c.__super.call(this,512,0);var M$b=8*M$pa.BYTES_PE;this.position=[2,5126,!1,M$b,0],this.texcoord=[2,5126,!1,M$b,2*M$pa.BYTES_PE],this.color=[4,5126,!1,M$b,4*M$pa.BYTES_PE]}return M$m(M$c,"laya.webgl.shader.d2.skinAnishader.SkinSV",M$Aa),M$c}(),M$Pa=function(M$a){function M$b(M$a){M$b.__super.call(this,2,0),this.color=[]}return M$m(M$b,"laya.webgl.shader.d2.value.Color2dSV",M$Aa),M$b.prototype.setValue=function(M$a){M$a.fillStyle&&(this.color=M$a.fillStyle._color._color),M$a.strokeStyle&&(this.color=M$a.strokeStyle._color._color)},M$b}(),M$Qa=function(M$a){function M$b(M$a){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=M$Aa._TEXCOORD,M$b.__super.call(this,256,0)}M$m(M$b,"laya.webgl.shader.d2.value.FillTextureSV",M$Aa);var M$c=M$b.prototype;return M$c.setValue=function(M$a){this.ALPHA=M$a.ALPHA,M$a.filters&&this.setFilters(M$a.filters)},M$c.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},M$b}(),M$Ra=function(M$a){function M$b(M$a){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=M$Aa._TEXCOORD,void 0===M$a&&(M$a=0),M$b.__super.call(this,1,M$a)}M$m(M$b,"laya.webgl.shader.d2.value.TextureSV",M$Aa);var M$c=M$b.prototype;return M$c.setValue=function(M$a){this.ALPHA=M$a.ALPHA,M$a.filters&&this.setFilters(M$a.filters)},M$c.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},M$b}(),M$Sa=function(M$a){function M$b(M$a){this.a_color=null,this.u_pos=[0,0],M$b.__super.call(this,4,0),this.position=[2,5126,!1,5*M$pa.BYTES_PE,0],this.a_color=[3,5126,!1,5*M$pa.BYTES_PE,2*M$pa.BYTES_PE]}return M$m(M$b,"laya.webgl.shader.d2.value.PrimitiveSV",M$Aa),M$b}(),M$Ta=function(M$a){function M$b(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,M$b.__super.call(this)}M$m(M$b,"laya.webgl.atlas.AtlasWebGLCanvas",M$a);var M$c=M$b.prototype;return M$c.recreateResource=function(){var M$a=M$ua.mainContext,M$b=this._source=M$a.createTexture(),M$c=M$va.curBindTexTarget,M$d=M$va.curBindTexValue;M$va.bindTexture(M$a,3553,M$b),M$a.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),M$a.texParameteri(3553,10241,9729),M$a.texParameteri(3553,10240,9729),M$a.texParameteri(3553,10242,33071),M$a.texParameteri(3553,10243,33071),M$c&&M$d&&M$va.bindTexture(M$a,M$c,M$d),this.memorySize=this._w*this._h*4,this.completeCreate()},M$c.disposeResource=function(){this._source&&(M$ua.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},M$c.texSubImage2D=function(M$a,M$b,M$c){if(M$r.isFlash){this._flashCacheImage||(this._flashCacheImage=M$p.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var M$d=M$c.bitmapdata;this._flashCacheImage._image.copyPixels(M$d,0,0,M$d.width,M$d.height,M$a,M$b),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var M$e=M$ua.mainContext,M$f=M$va.curBindTexTarget,M$g=M$va.curBindTexValue;M$va.bindTexture(M$e,3553,this._source),M$e.pixelStorei(37441,!0),0<=M$a-1&&M$e.texSubImage2D(3553,0,M$a-1,M$b,6408,5121,M$c),M$a+1<=this._w&&M$e.texSubImage2D(3553,0,M$a+1,M$b,6408,5121,M$c),0<=M$b-1&&M$e.texSubImage2D(3553,0,M$a,M$b-1,6408,5121,M$c),M$b+1<=this._h&&M$e.texSubImage2D(3553,0,M$a,M$b+1,6408,5121,M$c),M$e.texSubImage2D(3553,0,M$a,M$b,6408,5121,M$c),M$e.pixelStorei(37441,!1),M$f&&M$g&&M$va.bindTexture(M$e,M$f,M$g)}},M$c.texSubImage2DPixel=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$ua.mainContext,M$g=M$va.curBindTexTarget,M$h=M$va.curBindTexValue;M$va.bindTexture(M$f,3553,this._source);var M$i=new Uint8Array(M$e.data);M$f.pixelStorei(37441,!0),M$f.texSubImage2D(3553,0,M$a,M$b,M$c,M$d,6408,5121,M$i),M$f.pixelStorei(37441,!1),M$g&&M$h&&M$va.bindTexture(M$f,M$g,M$h)},M$d(0,M$c,"width",M$a.prototype._$get_width,function(M$a){this._w=M$a}),M$d(0,M$c,"height",M$a.prototype._$get_height,function(M$a){this._h=M$a}),M$b}(M$c),M$Ua=function(M$a){function M$e(){this.flipY=!0,this.alwaysChange=!1,M$e.__super.call(this)}M$m(M$e,"laya.webgl.resource.WebGLCanvas",M$c);var M$b=M$e.prototype;return M$b.getCanvas=function(){return this._canvas},M$b.clear=function(){this._ctx&&this._ctx.clear()},M$b.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},M$b._setContext=function(M$a){this._ctx=M$a},M$b.getContext=function(M$a,M$b){return this._ctx?this._ctx:this._ctx=M$e._createContext(this)},M$b.size=function(M$a,M$b){this._w==M$a&&this._h==M$b||(this._w=M$a,this._h=M$b,this._ctx&&this._ctx.size(M$a,M$b),this._canvas&&(this._canvas.height=M$b,this._canvas.width=M$a))},M$b.activeResource=function(M$a){void 0===M$a&&(M$a=!1),this._source||this.recreateResource()},M$b.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},M$b.disposeResource=function(){this._source&&!this.iscpuSource&&(M$ua.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},M$b.createWebGlTexture=function(){var M$a=M$ua.mainContext;this._canvas;var M$b=this._source=M$a.createTexture();this.iscpuSource=!1;var M$c=M$va.curBindTexTarget,M$d=M$va.curBindTexValue;M$va.bindTexture(M$a,3553,M$b),M$a.pixelStorei(37440,this.flipY?1:0),M$e.premulAlpha&&M$a.pixelStorei(37441,!0),M$a.texImage2D(3553,0,6408,6408,5121,this._imgData),M$e.premulAlpha&&M$a.pixelStorei(37441,!1),M$a.texParameteri(3553,10240,9729),M$a.texParameteri(3553,10241,9729),M$a.texParameteri(3553,10242,33071),M$a.texParameteri(3553,10243,33071),M$a.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,M$c&&M$d&&M$va.bindTexture(M$a,M$c,M$d)},M$b.reloadCanvasData=function(){var M$a=M$ua.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var M$b=M$va.curBindTexTarget,M$c=M$va.curBindTexValue;M$va.bindTexture(M$a,3553,this._source),M$e.premulAlpha&&M$a.pixelStorei(37441,!0),M$a.texImage2D(3553,0,6408,6408,5121,this._imgData),M$e.premulAlpha&&M$a.pixelStorei(37441,!1),M$a.pixelStorei(37440,0),M$b&&M$c&&M$va.bindTexture(M$a,M$b,M$c)},M$b.texSubImage2D=function(M$a,M$b,M$c){var M$d=M$ua.mainContext,M$e=M$va.curBindTexTarget,M$f=M$va.curBindTexValue;M$va.bindTexture(M$d,3553,this._source),M$d.pixelStorei(37441,!0),M$d.texSubImage2D(3553,0,M$b,M$c,6408,5121,M$a._source),M$d.pixelStorei(37441,!1),M$e&&M$f&&M$va.bindTexture(M$d,M$e,M$f)},M$b.toBase64=function(M$a,M$b,M$c){var M$d=null;this._canvas&&(M$d=this._canvas.toDataURL(M$a,M$b)),M$c.call(this,M$d)},M$d(0,M$b,"context",function(){return this._ctx}),M$d(0,M$b,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),M$d(0,M$b,"asBitmap",null,function(M$a){this._ctx&&(this._ctx.asBitmap=M$a)}),M$e._createContext=null,M$e.premulAlpha=!1,M$e}(),M$Va=function(M$a){function M$f(M$a,M$b){this.CborderSize=12,M$f.__super.call(this),this.char=M$a,this.isSpace=" "===M$a,this.xs=M$b.scaleX,this.ys=M$b.scaleY,this.font=M$b.font.toString(),this.fontSize=M$b.font.size,this.fillColor=M$b.fillColor,this.borderColor=M$b.borderColor,this.lineWidth=M$b.lineWidth,this.underLine=M$b.underLine;var M$c,M$d=M$r.isConchApp;M$d?((M$c=ConchTextCanvas)._source=ConchTextCanvas,M$c._source.canvas=ConchTextCanvas):M$c=M$n.canvas.source,this.canvas=M$c,this._enableMerageInAtlas=!0,this._ctx=M$d?M$c:this.canvas.getContext("2d",void 0);var M$e=M$L.measureText(this.char,this.font);this.cw=M$e.width*this.xs,this.ch=(M$e.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new M$K(this)}M$m(M$f,"laya.webgl.resource.WebGLCharImage",M$c);var M$b=M$f.prototype;return M$w.imps(M$b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),M$b.active=function(){this.texture.active()},M$b.recreateResource=function(){var M$a=M$r.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),M$a){var M$b=this.fontSize;1==this.xs&&1==this.ys||(M$b=parseInt(M$b*(this.xs>this.ys?this.xs:this.ys)+""));var M$c="normal 100 "+this.font;M$c=M$c.replace(M$f._fontSizeReg,M$b),this.borderColor&&(M$c+=" 1 "+this.borderColor),this._ctx.font=M$c,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,M$J.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var M$d=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(M$d,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},M$b.onresize=function(M$a,M$b){this._w=M$a,this._h=M$b,this._allowMerageInAtlas=!0},M$b.clearAtlasSource=function(){},M$d(0,M$b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),M$d(0,M$b,"atlasSource",function(){return this.canvas}),M$d(0,M$b,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(M$a){this._enableMerageInAtlas=M$a}),M$f.createOneChar=function(M$a,M$b){return new M$f(M$a,M$b)},M$f._fontSizeReg=new RegExp("\\d+(?=px)","g"),M$f}(),M$Wa=function(M$a){function M$j(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){void 0===M$c&&(M$c=6408),void 0===M$d&&(M$d=5121),void 0===M$e&&(M$e=34041),void 0===M$f&&(M$f=!1),void 0===M$g&&(M$g=!1),void 0===M$h&&(M$h=-1),void 0===M$i&&(M$i=1),M$j.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=M$a,this._h=M$b,this._surfaceFormat=M$c,this._surfaceType=M$d,this._depthStencilFormat=M$e,this._mipMap=M$f,this._repeat=M$g,this._minFifter=M$h,this._magFifter=M$i}M$m(M$j,"laya.webgl.resource.WebGLRenderTarget",M$c);var M$b=M$j.prototype;return M$b.recreateResource=function(){var M$a=M$ua.mainContext;this._frameBuffer||(this._frameBuffer=M$a.createFramebuffer()),this._source||(this._source=M$a.createTexture());var M$b=M$va.curBindTexTarget,M$c=M$va.curBindTexValue;M$va.bindTexture(M$a,3553,this._source),M$a.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var M$d=this._minFifter,M$e=this._magFifter,M$f=this._repeat?10497:33071,M$g=M$k.isPOT(this._w,this._h);if(M$g?(this._mipMap?-1!==M$d||(M$d=9987):-1!==M$d||(M$d=9729),-1!==M$e||(M$e=9729),M$a.texParameteri(3553,10241,M$d),M$a.texParameteri(3553,10240,M$e),M$a.texParameteri(3553,10242,M$f),M$a.texParameteri(3553,10243,M$f),this._mipMap&&M$a.generateMipmap(3553)):(-1!==M$d||(M$d=9729),-1!==M$e||(M$e=9729),M$a.texParameteri(3553,10241,M$d),M$a.texParameteri(3553,10240,M$e),M$a.texParameteri(3553,10242,33071),M$a.texParameteri(3553,10243,33071)),M$a.bindFramebuffer(36160,this._frameBuffer),M$a.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=M$a.createRenderbuffer()),M$a.bindRenderbuffer(36161,this._depthStencilBuffer),M$a.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:M$a.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:M$a.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:M$a.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}M$a.bindFramebuffer(36160,null),M$b&&M$c&&M$va.bindTexture(M$a,M$b,M$c),M$a.bindRenderbuffer(36161,null),M$g&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},M$b.disposeResource=function(){this._frameBuffer&&(M$ua.mainContext.deleteTexture(this._source),M$ua.mainContext.deleteFramebuffer(this._frameBuffer),M$ua.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},M$d(0,M$b,"depthStencilBuffer",function(){return this._depthStencilBuffer}),M$d(0,M$b,"frameBuffer",function(){return this._frameBuffer}),M$j}(),M$Xa=function(M$a){function M$h(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this.offsetX=0,this.offsetY=0,M$h.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=M$f,this.canvas=M$a,this._ctx=M$a.getContext("2d",void 0),this._w=M$d,this._h=M$e,this.offsetX=M$b,this.offsetY=M$c,this.src=M$g,this._enableMerageInAtlas=!0,M$Q.enabled&&this._w<M$Q.atlasLimitWidth&&this._h<M$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}M$m(M$h,"laya.webgl.resource.WebGLSubImage",M$c);var M$b=M$h.prototype;return M$w.imps(M$b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),M$b.size=function(M$a,M$b){this._w=M$a,this._h=M$b,this._ctx&&this._ctx.size(M$a,M$b),this.canvas&&(this.canvas.height=M$b,this.canvas.width=M$a)},M$b.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},M$b.createWebGlTexture=function(){var M$a=M$ua.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var M$b=this._source=M$a.createTexture(),M$c=M$va.curBindTexTarget,M$d=M$va.curBindTexValue;M$va.bindTexture(M$a,3553,M$b),M$a.pixelStorei(37441,!0),M$a.texImage2D(3553,0,6408,6408,5121,this.canvas),M$a.pixelStorei(37441,!1);var M$e=this.minFifter,M$f=this.magFifter,M$g=this.repeat?10497:33071,M$h=M$k.isPOT(this.width,this.height);M$h?(this.mipmap?-1!==M$e||(M$e=9987):-1!==M$e||(M$e=9729),-1!==M$f||(M$f=9729),M$a.texParameteri(3553,10240,M$f),M$a.texParameteri(3553,10241,M$e),M$a.texParameteri(3553,10242,M$g),M$a.texParameteri(3553,10243,M$g),this.mipmap&&M$a.generateMipmap(3553)):(-1!==M$e||(M$e=9729),-1!==M$f||(M$f=9729),M$a.texParameteri(3553,10241,M$e),M$a.texParameteri(3553,10240,M$f),M$a.texParameteri(3553,10242,33071),M$a.texParameteri(3553,10243,33071)),M$c&&M$d&&M$va.bindTexture(M$a,M$c,M$d),this.canvas=null,M$h&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},M$b.disposeResource=function(){M$Q.enabled&&this._allowMerageInAtlas||!this._source||(M$ua.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},M$b.clearAtlasSource=function(){},M$d(0,M$b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),M$d(0,M$b,"atlasSource",function(){return this.canvas}),M$d(0,M$b,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(M$a){this._allowMerageInAtlas=M$a}),M$h}(),M$Ya=function(M$a){function M$j(M$a,M$b,M$c,M$d){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,M$j.__super.call(this),!M$a||!M$b)throw"Shader Error";this._id=++M$j._count,this._vs=M$a,this._ps=M$b,this._nameMap=M$d||{},null!=M$c&&(M$j.sharders[M$c]=this)}M$m(M$j,"laya.webgl.shader.Shader",M$La);var M$b=M$j.prototype;return M$b.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},M$b.disposeResource=function(){M$ua.mainContext.deleteShader(this._vshader),M$ua.mainContext.deleteShader(this._pshader),M$ua.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},M$b._compile=function(){if(!M$ua.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var M$a=[this._vs,this._ps],M$b=M$ua.mainContext;if(this._program=M$b.createProgram(),this._vshader=M$j._createShader(M$b,M$a[0],35633),this._pshader=M$j._createShader(M$b,M$a[1],35632),M$b.attachShader(this._program,this._vshader),M$b.attachShader(this._program,this._pshader),M$b.linkProgram(this._program),!M$r.isConchApp&&!M$b.getProgramParameter(this._program,35714))throw M$b.getProgramInfoLog(this._program);var M$c,M$d,M$e=0,M$f=0;for(M$f=M$r.isConchApp?M$b.getProgramParameterEx(this._vs,this._ps,"",35721):M$b.getProgramParameter(this._program,35721),M$e=0;M$e<M$f;M$e++){var M$g=null;M$c={vartype:"attribute",glfun:null,ivartype:0,attrib:M$g=M$r.isConchApp?M$b.getActiveAttribEx(this._vs,this._ps,"",M$e):M$b.getActiveAttrib(this._program,M$e),location:M$b.getAttribLocation(this._program,M$g.name),name:M$g.name,type:M$g.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(M$c)}var M$h=0;for(M$h=M$r.isConchApp?M$b.getProgramParameterEx(this._vs,this._ps,"",35718):M$b.getProgramParameter(this._program,35718),M$e=0;M$e<M$h;M$e++){var M$i=null;M$i=M$r.isConchApp?M$b.getActiveUniformEx(this._vs,this._ps,"",M$e):M$b.getActiveUniform(this._program,M$e),0<(M$c={vartype:"uniform",glfun:null,ivartype:1,attrib:M$g,location:M$b.getUniformLocation(this._program,M$i.name),name:M$i.name,type:M$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(M$c.name=M$c.name.substr(0,M$c.name.length-3),M$c.isArray=!0,M$c.location=M$b.getUniformLocation(this._program,M$c.name)),this._params.push(M$c)}for(M$e=0,M$d=this._params.length;M$e<M$d;M$e++)if((M$c=this._params[M$e]).indexOfParams=M$e,M$c.index=1,M$c.value=[M$c.location,null],M$c.codename=M$c.name,M$c.name=this._nameMap[M$c.codename]?this._nameMap[M$c.codename]:M$c.codename,(this._paramsMap[M$c.name]=M$c)._this=this,M$c.uploadedValue=[],"attribute"!==M$c.vartype)switch(M$c.type){case 5124:M$c.fun=M$c.isArray?this._uniform1iv:this._uniform1i;break;case 5126:M$c.fun=M$c.isArray?this._uniform1fv:this._uniform1f;break;case 35664:M$c.fun=M$c.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:M$c.fun=M$c.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:M$c.fun=M$c.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:M$c.fun=this._uniform_sampler2D;break;case 35680:M$c.fun=this._uniform_samplerCube;break;case 35676:M$c.glfun=M$b.uniformMatrix4fv,M$c.fun=this._uniformMatrix4fv;break;case 35670:M$c.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else M$c.fun=this._attribute}},M$b.getUniform=function(M$a){return this._paramsMap[M$a]},M$b._attribute=function(M$a,M$b){var M$c=M$ua.mainContext,M$d=M$Na._enableAtributes,M$e=M$a.location;return M$d[M$e]||M$c.enableVertexAttribArray(M$e),M$c.vertexAttribPointer(M$e,M$b[0],M$b[1],M$b[2],M$b[3],M$b[4]+this._offset),M$d[M$e]=M$Na._bindVertexBuffer,1},M$b._uniform1f=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b?(M$ua.mainContext.uniform1f(M$a.location,M$c[0]=M$b),1):0},M$b._uniform1fv=function(M$a,M$b){if(M$b.length<4){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]||M$c[2]!==M$b[2]||M$c[3]!==M$b[3]?(M$ua.mainContext.uniform1fv(M$a.location,M$b),M$c[0]=M$b[0],M$c[1]=M$b[1],M$c[2]=M$b[2],M$c[3]=M$b[3],1):0}return M$ua.mainContext.uniform1fv(M$a.location,M$b),1},M$b._uniform_vec2=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]?(M$ua.mainContext.uniform2f(M$a.location,M$c[0]=M$b[0],M$c[1]=M$b[1]),1):0},M$b._uniform_vec2v=function(M$a,M$b){if(M$b.length<2){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]||M$c[2]!==M$b[2]||M$c[3]!==M$b[3]?(M$ua.mainContext.uniform2fv(M$a.location,M$b),M$c[0]=M$b[0],M$c[1]=M$b[1],M$c[2]=M$b[2],M$c[3]=M$b[3],1):0}return M$ua.mainContext.uniform2fv(M$a.location,M$b),1},M$b._uniform_vec3=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]||M$c[2]!==M$b[2]?(M$ua.mainContext.uniform3f(M$a.location,M$c[0]=M$b[0],M$c[1]=M$b[1],M$c[2]=M$b[2]),1):0},M$b._uniform_vec3v=function(M$a,M$b){return M$ua.mainContext.uniform3fv(M$a.location,M$b),1},M$b._uniform_vec4=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]||M$c[2]!==M$b[2]||M$c[3]!==M$b[3]?(M$ua.mainContext.uniform4f(M$a.location,M$c[0]=M$b[0],M$c[1]=M$b[1],M$c[2]=M$b[2],M$c[3]=M$b[3]),1):0},M$b._uniform_vec4v=function(M$a,M$b){return M$ua.mainContext.uniform4fv(M$a.location,M$b),1},M$b._uniformMatrix2fv=function(M$a,M$b){return M$ua.mainContext.uniformMatrix2fv(M$a.location,!1,M$b),1},M$b._uniformMatrix3fv=function(M$a,M$b){return M$ua.mainContext.uniformMatrix3fv(M$a.location,!1,M$b),1},M$b._uniformMatrix4fv=function(M$a,M$b){return M$ua.mainContext.uniformMatrix4fv(M$a.location,!1,M$b),1},M$b._uniform1i=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b?(M$ua.mainContext.uniform1i(M$a.location,M$c[0]=M$b),1):0},M$b._uniform1iv=function(M$a,M$b){return M$ua.mainContext.uniform1iv(M$a.location,M$b),1},M$b._uniform_ivec2=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]?(M$ua.mainContext.uniform2i(M$a.location,M$c[0]=M$b[0],M$c[1]=M$b[1]),1):0},M$b._uniform_ivec2v=function(M$a,M$b){return M$ua.mainContext.uniform2iv(M$a.location,M$b),1},M$b._uniform_vec3i=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]||M$c[2]!==M$b[2]?(M$ua.mainContext.uniform3i(M$a.location,M$c[0]=M$b[0],M$c[1]=M$b[1],M$c[2]=M$b[2]),1):0},M$b._uniform_vec3vi=function(M$a,M$b){return M$ua.mainContext.uniform3iv(M$a.location,M$b),1},M$b._uniform_vec4i=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]||M$c[2]!==M$b[2]||M$c[3]!==M$b[3]?(M$ua.mainContext.uniform4i(M$a.location,M$c[0]=M$b[0],M$c[1]=M$b[1],M$c[2]=M$b[2],M$c[3]=M$b[3]),1):0},M$b._uniform_vec4vi=function(M$a,M$b){return M$ua.mainContext.uniform4iv(M$a.location,M$b),1},M$b._uniform_sampler2D=function(M$a,M$b){var M$c=M$ua.mainContext,M$d=M$a.uploadedValue;return null==M$d[0]?(M$d[0]=this._curActTexIndex,M$c.uniform1i(M$a.location,this._curActTexIndex),M$c.activeTexture(M$j._TEXTURES[this._curActTexIndex]),M$va.bindTexture(M$c,3553,M$b),this._curActTexIndex++,1):(M$c.activeTexture(M$j._TEXTURES[M$d[0]]),M$va.bindTexture(M$c,3553,M$b),0)},M$b._uniform_samplerCube=function(M$a,M$b){var M$c=M$ua.mainContext,M$d=M$a.uploadedValue;return null==M$d[0]?(M$d[0]=this._curActTexIndex,M$c.uniform1i(M$a.location,this._curActTexIndex),M$c.activeTexture(M$j._TEXTURES[this._curActTexIndex]),M$va.bindTexture(M$c,34067,M$b),this._curActTexIndex++,1):(M$c.activeTexture(M$j._TEXTURES[M$d[0]]),M$va.bindTexture(M$c,34067,M$b),0)},M$b._noSetValue=function(M$a){console.log("no....:"+M$a.name)},M$b.uploadOne=function(M$a,M$b){this.activeResource(),M$va.UseProgram(this._program);var M$c=this._paramsMap[M$a];M$c.fun.call(this,M$c,M$b)},M$b.uploadTexture2D=function(M$a){M$G.shaderCall++;var M$b=M$ua.mainContext;M$b.activeTexture(33984),M$va.bindTexture(M$b,3553,M$a)},M$b.uploadTexture2D1=function(M$a){M$G.shaderCall++;var M$b=M$ua.mainContext;M$b.activeTexture(33985),M$va.bindTexture(M$b,3553,M$a)},M$b.upload=function(M$a,M$b){M$La.activeShader=M$La.bindShader=this,this._lastUseFrameCount===M$G.loopCount||this.activeResource(),M$va.UseProgram(this._program),this._reCompile?(M$b=this._params,this._reCompile=!1):M$b=M$b||this._params;M$ua.mainContext;for(var M$c,M$d,M$e=M$b.length,M$f=0,M$g=0;M$g<M$e;M$g++)null!==(M$d=M$a[(M$c=M$b[M$g]).name])&&(M$f+=M$c.fun.call(this,M$c,M$d));M$G.shaderCall+=M$f},M$b.uploadArray=function(M$a,M$b,M$c){M$La.activeShader=this,(M$La.bindShader=this).activeResource(),M$va.UseProgram(this._program);this._params;for(var M$d,M$e,M$f=0,M$g=M$b-2;0<=M$g;M$g-=2)(M$e=this._paramsMap[M$a[M$g]])&&null!=(M$d=M$a[M$g+1])&&(M$c&&M$c[M$e.name]&&M$c[M$e.name].bind(),M$f+=M$e.fun.call(this,M$e,M$d));M$G.shaderCall+=M$f},M$b.getParams=function(){return this._params},M$j.getShader=function(M$a){return M$j.sharders[M$a]},M$j.create=function(M$a,M$b,M$c,M$d){return new M$j(M$a,M$b,M$c,M$d)},M$j.withCompile=function(M$a,M$b,M$c,M$d){if(M$c&&M$j.sharders[M$c])return M$j.sharders[M$c];var M$e=M$j._preCompileShader[2e-4*M$a];if(!M$e)throw new Error("withCompile shader err!"+M$a);return M$e.createShader(M$b,M$c,M$d)},M$j.withCompile2D=function(M$a,M$b,M$c,M$d,M$e){if(M$d&&M$j.sharders[M$d])return M$j.sharders[M$d];var M$f=M$j._preCompileShader[2e-4*M$a+M$b];if(!M$f)throw new Error("withCompile shader err!"+M$a+" "+M$b);return M$f.createShader(M$c,M$d,M$e)},M$j.addInclude=function(M$a,M$b){M$ta.addInclude(M$a,M$b)},M$j.preCompile=function(M$a,M$b,M$c,M$d){var M$e=2e-4*M$a;M$j._preCompileShader[M$e]=new M$ta(M$e,M$b,M$c,M$d)},M$j.preCompile2D=function(M$a,M$b,M$c,M$d,M$e){var M$f=2e-4*M$a+M$b;M$j._preCompileShader[M$f]=new M$ta(M$f,M$c,M$d,M$e)},M$j._createShader=function(M$a,M$b,M$c){var M$d=M$a.createShader(M$c);return M$a.shaderSource(M$d,M$b),M$a.compileShader(M$d),M$d},M$j._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],M$j._count=0,M$j._preCompileShader={},M$j.SHADERNAME2ID=2e-4,M$j.sharders=((M$j.sharders=[]).length=32,M$j.sharders),M$g(M$j,["nameKey",function(){return this.nameKey=new M$H}]),M$j}(),M$Za=function(M$a){function M$b(){this._maxsize=0,this._upload=!0,this._uploadSize=0,M$b.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}M$m(M$b,"laya.webgl.utils.Buffer2D",M$a);var M$c=M$b.prototype;return M$c.needSize=function(M$a){var M$b=this._byteLength;if(M$a){var M$c=this._byteLength+M$a;M$c<=this._buffer.byteLength||this._resizeBuffer(M$c<<1,!0),this._byteLength=M$c}return M$b},M$c._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),M$G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,M$Na._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),M$Na._gl.bufferSubData(this._bufferType,0,this._buffer)},M$c._bufferSubData=function(M$a,M$b,M$c){if(void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),this._maxsize=Math.max(this._maxsize,this._byteLength),M$G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,M$Na._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),M$b||M$c){var M$d=this._buffer.slice(M$b,M$c);M$Na._gl.bufferSubData(this._bufferType,M$a,M$d)}else M$Na._gl.bufferSubData(this._bufferType,M$a,this._buffer)},M$c._checkArrayUse=function(){},M$c._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},M$c._bind_subUpload=function(M$a,M$b,M$c){return void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(M$a,M$b,M$c),!0)},M$c._resizeBuffer=function(M$a,M$b){if(M$a<this._buffer.byteLength)return this;if(this.memorySize=M$a,M$b&&this._buffer&&0<this._buffer.byteLength){var M$c=new ArrayBuffer(M$a);new Uint8Array(M$c).set(new Uint8Array(this._buffer),0),this._buffer=M$c}else this._buffer=new ArrayBuffer(M$a);return this._checkArrayUse(),this._upload=!0,this},M$c.append=function(M$a){this._upload=!0;var M$b,M$c;M$b=M$a.byteLength,M$a instanceof Uint8Array?(this._resizeBuffer(this._byteLength+M$b,!0),M$c=new Uint8Array(this._buffer,this._byteLength)):M$a instanceof Uint16Array?(this._resizeBuffer(this._byteLength+M$b,!0),M$c=new Uint16Array(this._buffer,this._byteLength)):M$a instanceof Float32Array&&(this._resizeBuffer(this._byteLength+M$b,!0),M$c=new Float32Array(this._buffer,this._byteLength)),M$c.set(M$a,0),this._byteLength+=M$b,this._checkArrayUse()},M$c.appendU16Array=function(M$a,M$b){this._resizeBuffer(this._byteLength+2*M$b,!0);for(var M$c=new Uint16Array(this._buffer,this._byteLength,M$b),M$d=0;M$d<M$b;M$d++)M$c[M$d]=M$a[M$d];this._byteLength+=2*M$b,this._checkArrayUse()},M$c.appendEx=function(M$a,M$b){this._upload=!0;var M$c;M$c=M$a.byteLength,this._resizeBuffer(this._byteLength+M$c,!0),new M$b(this._buffer,this._byteLength).set(M$a,0),this._byteLength+=M$c,this._checkArrayUse()},M$c.appendEx2=function(M$a,M$b,M$c,M$d){void 0===M$d&&(M$d=1),this._upload=!0;var M$e,M$f;M$e=M$c*M$d,this._resizeBuffer(this._byteLength+M$e,!0),M$f=new M$b(this._buffer,this._byteLength);var M$g=0;for(M$g=0;M$g<M$c;M$g++)M$f[M$g]=M$a[M$g];this._byteLength+=M$e,this._checkArrayUse()},M$c.getBuffer=function(){return this._buffer},M$c.setNeedUpload=function(){this._upload=!0},M$c.getNeedUpload=function(){return this._upload},M$c.upload=function(){var M$a=this._bind_upload();return M$Na._gl.bindBuffer(this._bufferType,null),M$Na._bindActive[this._bufferType]=null,M$La.activeShader=null,M$a},M$c.subUpload=function(M$a,M$b,M$c){void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0);var M$d=this._bind_subUpload();return M$Na._gl.bindBuffer(this._bufferType,null),M$Na._bindActive[this._bufferType]=null,M$La.activeShader=null,M$d},M$c.disposeResource=function(){M$a.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},M$c.clear=function(){this._byteLength=0,this._upload=!0},M$d(0,M$c,"bufferLength",function(){return this._buffer.byteLength}),M$d(0,M$c,"byteLength",null,function(M$a){this._byteLength!==M$a&&(M$a<=this._buffer.byteLength||this._resizeBuffer(2*M$a+256,!0),this._byteLength=M$a)}),M$b.__int__=function(M$a){M$ya.QuadrangleIB=M$ya.create(35044),M$qa.fillIBQuadrangle(M$ya.QuadrangleIB,16)},M$b.FLOAT32=4,M$b.SHORT=2,M$b}(M$Na),M$$a=(function(M$b){function M$c(M$a){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,M$c.__super.call(this,9)}M$m(M$c,"laya.webgl.shader.d2.value.GlowSV",M$b);var M$a=M$c.prototype;M$a.setValue=function(M$a){M$b.prototype.setValue.call(this,M$a)},M$a.clear=function(){M$b.prototype.clear.call(this)}}(M$Ra),function(M$a){function M$b(M$a){M$b.__super.call(this,64),this.defines.add(64)}M$m(M$b,"laya.webgl.shader.d2.value.TextSV",M$a);var M$c=M$b.prototype;return M$c.release=function(){(M$b.pool[M$b._length++]=this).clear()},M$c.clear=function(){M$a.prototype.clear.call(this)},M$b.create=function(){return M$b._length?M$b.pool[--M$b._length]:new M$b(null)},M$b.pool=[],M$b._length=0,M$b}(M$Ra)),M$_a=function(M$a){function M$e(M$a,M$b,M$c,M$d){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,M$e.__super.call(this,M$a,M$b,M$c,M$d)}M$m(M$e,"laya.webgl.shader.d2.Shader2X",M$a);var M$b=M$e.prototype;return M$b.upload2dQuick1=function(M$a){this.upload(M$a,this._params2dQuick1||this._make2dQuick1())},M$b._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var M$a,M$b=this._params,M$c=0,M$d=M$b.length;M$c<M$d;M$c++)M$a=M$b[M$c],(M$r.isFlash||"size"!==M$a.name&&"position"!==M$a.name&&"texcoord"!==M$a.name)&&this._params2dQuick1.push(M$a)}return this._params2dQuick1},M$b.disposeResource=function(){M$a.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},M$b.upload2dQuick2=function(M$a){this.upload(M$a,this._params2dQuick2||this._make2dQuick2())},M$b._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var M$a,M$b=this._params,M$c=0,M$d=M$b.length;M$c<M$d;M$c++)M$a=M$b[M$c],(M$r.isFlash||"size"!==M$a.name)&&this._params2dQuick2.push(M$a)}return this._params2dQuick2},M$e.create=function(M$a,M$b,M$c,M$d){return new M$e(M$a,M$b,M$c,M$d)},M$e}(M$Ya),M$ya=function(M$a){function M$b(M$a){this._uint8Array=null,this._uint16Array=null,void 0===M$a&&(M$a=35044),M$b.__super.call(this),this._bufferUsage=M$a,this._bufferType=34963,M$r.isFlash||(this._buffer=new ArrayBuffer(8))}M$m(M$b,"laya.webgl.utils.IndexBuffer2D",M$Za);var M$c=M$b.prototype;return M$c._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},M$c.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},M$c.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},M$c.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},M$b.QuadrangleIB=null,M$b.create=function(M$a){return void 0===M$a&&(M$a=35044),new M$b(M$a)},M$b}(),M$za=function(M$a){function M$c(M$a,M$b){this._floatArray32=null,this._vertexStride=0,M$c.__super.call(this),this._vertexStride=M$a,this._bufferUsage=M$b,this._bufferType=34962,M$r.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}M$m(M$c,"laya.webgl.utils.VertexBuffer2D",M$a);var M$b=M$c.prototype;return M$b.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},M$b.bind=function(M$a){M$a&&M$a._bind(),this._bind()},M$b.insertData=function(M$a,M$b){this.getFloat32Array().set(M$a,M$b),this._upload=!0},M$b.bind_upload=function(M$a){M$a._bind_upload()||M$a._bind(),this._bind_upload()||this._bind()},M$b._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},M$b.disposeResource=function(){M$a.prototype.disposeResource.call(this)},M$b.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},M$d(0,M$b,"vertexStride",function(){return this._vertexStride}),M$c.create=function(M$a,M$b){return void 0===M$b&&(M$b=35048),new M$c(M$a,M$b)},M$c}(M$Za),M$ab=function(M$a){function M$h(M$a,M$b,M$c,M$d,M$e,M$f){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===M$c&&(M$c=6408),void 0===M$d&&(M$d=!0),M$h.__super.call(this,M$a,M$b),M$a){if(this._format=M$c,this._mipmap=M$d,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof M$a)this._url=M$a,this._src=M$a,this._image=new M$n.window.Image,M$b&&(M$b.onload&&(this.onload=M$b.onload),M$b.onerror&&(this.onerror=M$b.onerror),M$b.onCreate&&M$b.onCreate(this)),this._image.crossOrigin=M$a&&0==M$a.indexOf("data:")?null:"",M$a&&(this._image.src=M$a);else if(M$a instanceof ArrayBuffer){this._src=M$b,this._url=this._src;var M$g=new M$i(M$a);M$g.readUTFBytes(4),M$g.readUTFBytes(2),M$g.getInt16();M$g.endian="bigEndian",this._w=M$g.getInt16(),this._h=M$g.getInt16();M$g.getInt16(),M$g.getInt16();this._image=new Uint8Array(M$a,M$g.pos),this._format=M$ua.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,M$Q.enabled&&this._w<M$Q.atlasLimitWidth&&this._h<M$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(M$a instanceof Uint8Array))return this._src=M$b,this._url=this._src,this._image=M$a.source||M$a,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=M$b,this._url=this._src,this._w=M$e,this._h=M$f,this._image=M$a,this._format=0===M$c?M$a.byteLength/(M$e*M$f)==4?6408:6407:M$c}this._$5__enableMerageInAtlas=!0}}M$m(M$h,"laya.webgl.resource.WebGLImage",M$p);var M$b=M$h.prototype;return M$w.imps(M$b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),M$b._init_=function(M$a,M$b){},M$b._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var M$a=M$ua.mainContext,M$b=this._source=M$a.createTexture(),M$c=M$va.curBindTexTarget,M$d=M$va.curBindTexValue;M$va.bindTexture(M$a,3553,M$b);var M$e=this.minFifter,M$f=this.magFifter,M$g=this.repeat?10497:33071,M$h=M$k.isPOT(this._w,this._h),M$i=!1;switch(M$h?(this.mipmap?-1!==M$e||(M$e=9987):-1!==M$e||(M$e=9729),-1!==M$f||(M$f=9729),M$a.texParameteri(3553,10241,M$e),M$a.texParameteri(3553,10240,M$f),M$a.texParameteri(3553,10242,M$g),M$a.texParameteri(3553,10243,M$g),this.mipmap&&M$a.generateMipmap(3553)):(-1!==M$e||(M$e=9729),-1!==M$f||(M$f=9729),M$a.texParameteri(3553,10241,M$e),M$a.texParameteri(3553,10240,M$f),M$a.texParameteri(3553,10242,33071),M$a.texParameteri(3553,10243,33071)),M$a.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&M$a.pixelStorei(M$a.UNPACK_ALIGNMENT,1),M$a.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&M$a.pixelStorei(M$a.UNPACK_ALIGNMENT,1),M$a.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:M$i=!0,M$a.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case M$ua.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:M$i=!0,M$a.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}M$a.pixelStorei(37441,!1),M$c&&M$d&&M$va.bindTexture(M$a,M$c,M$d),this.uri||(this.uri=this._url),M$i?this.memorySize=this._image.length:M$h&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},M$b.recreateResource=function(){var M$a=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var M$b=this;this._image=new M$n.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(M$b._needReleaseAgain)return M$b._needReleaseAgain=!1,M$b._image.onload=null,void(M$b._image=null);M$b._allowMerageInAtlas&&M$b._enableMerageInAtlas?(M$a.memorySize=0,M$a._recreateLock=!1):M$b._createWebGlTexture(),M$b.completeCreate()},this._image.src=this._src}},M$b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&M$ua.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},M$b.onresize=function(){this._w=this._image.width,this._h=this._image.height,M$Q.enabled&&this._w<M$Q.atlasLimitWidth&&this._h<M$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},M$b.clearAtlasSource=function(){this._image=null},M$d(0,M$b,"format",function(){return this._format}),M$d(0,M$b,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(M$a){this._$5__enableMerageInAtlas=M$a}),M$d(0,M$b,"mipmap",function(){return this._mipmap}),M$d(0,M$b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),M$d(0,M$b,"atlasSource",function(){return this._image}),M$d(0,M$b,"onload",null,function(M$a){var M$b=this;this._onload=M$a,this._image&&(this._image.onload=null!=this._onload?function(){M$b.onresize(),M$b._onload()}:null)}),M$d(0,M$b,"onerror",null,function(M$a){var M$b=this;this._onerror=M$a,this._image&&(this._image.onerror=null!=this._onerror?function(){M$b._onerror()}:null)}),M$h}();M$w.__init([M$na,M$P,M$xa,M$ta])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(M$a,M$b){"use strict";for(var M$c in Object.defineProperty(M$b,"__esModule",{value:!0}),Laya){var M$d=Laya[M$c];M$d&&M$d.__isclass&&(M$b[M$c]=M$d)}}),function(M$f,M$a,M$d){M$d.un,M$d.uns;var M$e=M$d.static,M$g=M$d.class,M$h=M$d.getset,M$i=(M$d.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),M$o=laya.utils.ClassUtils,M$l=(laya.events.Event,laya.utils.HTMLChar),M$j=laya.net.Loader,M$k=(laya.display.Node,laya.maths.Rectangle),M$m=laya.renders.Render,M$n=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),M$p=laya.utils.Stat,M$L=laya.display.Text,M$q=laya.resource.Texture,M$r=laya.net.URL,M$s=laya.utils.Utils,M$t=function(){function M$n(){}return M$g(M$n,"laya.html.utils.HTMLParse"),M$n.parse=function(M$a,M$b,M$c){M$b=(M$b="<root>"+(M$b=M$b.replace(/<br>/g,"<br/>"))+"</root>").replace(M$n.spacePattern,M$n.char255);var M$d=M$s.parseXMLFromString(M$b);M$n._parseXML(M$a,M$d.childNodes[0].childNodes,M$c)},M$n._parseXML=function(M$a,M$b,M$c,M$d){var M$e=0,M$f=0;if(M$b.join||M$b.item)for(M$e=0,M$f=M$b.length;M$e<M$f;++M$e)M$n._parseXML(M$a,M$b[M$e],M$c,M$d);else{var M$g,M$h,M$i;if(3==M$b.nodeType)return void(M$a instanceof laya.html.dom.HTMLDivElement?(null==M$b.nodeName&&(M$b.nodeName="#text"),M$h=M$b.nodeName.toLowerCase(),0<(M$i=M$b.textContent.replace(/^\s+|\s+$/g,"")).length&&(M$g=M$o.getInstance(M$h))&&(M$a.addChild(M$g),M$g.innerTEXT=M$i.replace(M$n.char255AndOneSpacePattern," "))):0<(M$i=M$b.textContent.replace(/^\s+|\s+$/g,"")).length&&(M$a.innerTEXT=M$i.replace(M$n.char255AndOneSpacePattern," ")));if("#comment"==(M$h=M$b.nodeName.toLowerCase()))return;if(M$g=M$o.getInstance(M$h)){(M$g=M$a.addChild(M$g)).URI=M$c,M$g.href=M$d;var M$j=M$b.attributes;if(M$j&&0<M$j.length)for(M$e=0,M$f=M$j.length;M$e<M$f;++M$e){var M$k=M$j[M$e],M$l=M$k.nodeName,M$m=M$k.value;M$g._setAttributes(M$l,M$m)}M$n._parseXML(M$g,M$b.childNodes,M$c,M$g.href)}else M$n._parseXML(M$a,M$b.childNodes,M$c,M$d)}},M$n.char255=String.fromCharCode(255),M$n.spacePattern=/&nbsp;|&#160;/g,M$n.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),M$n}(),M$u=function(){function M$K(){}return M$g(M$K,"laya.html.utils.Layout"),M$K.later=function(M$a){null==M$K._will&&(M$K._will=[],M$d.stage.frameLoop(1,null,function(){if(!(M$K._will.length<1)){for(var M$a=0;M$a<M$K._will.length;M$a++)laya.html.utils.Layout.layout(M$K._will[M$a]);M$K._will.length=0}})),M$K._will.push(M$a)},M$K.layout=function(M$a){if(!M$a||!M$a._style)return null;if(0==(512&M$a._style._type))return null;M$a.getStyle()._type&=-513;var M$b=M$K._multiLineLayout(M$a);return M$m.isConchApp&&M$a.layaoutCallNative&&M$a.layaoutCallNative(),M$b},M$K._multiLineLayout=function(M$a){if(M$L.RightToLeft)return M$K._multiLineLayout2(M$a);var M$b=new Array;M$a._addChildsToLayout(M$b);var M$c,M$d,M$e,M$f,M$g,M$h=0,M$i=M$b.length,M$j=M$a._getCSSStyle(),M$k=M$j.letterSpacing,M$l=M$j.leading,M$m=M$j.lineHeight,M$n=M$j._widthAuto()||!M$j.wordWrap,M$o=M$n?999999:M$a.width,M$p=(M$a.height,0),M$q=M$j.italic?M$j.fontSize/3:0,M$r=M$j._getAlign(),M$s=M$j._getValign(),M$t=0!==M$s||0!==M$r||0!=M$m,M$u=0,M$v=0,M$w=0,M$x=0,M$A=new Array,M$B=M$A[0]=new M$M,M$C=!1,M$D=!1;M$B.h=0,M$j.italic&&(M$o-=M$j.fontSize/3);var M$E=0,M$F=!0;function M$G(){M$B.y=M$v,M$v+=M$B.h+M$l,0==M$B.h&&(M$v+=M$m),M$B.mWidth=M$E,M$E=0,M$B=new M$M,M$A.push(M$B),M$B.h=0,M$C=!(M$F=!(M$u=0))}for(M$h=0;M$h<M$i;M$h++)if(null!=(M$c=M$b[M$h]))if(M$F=!1,M$c instanceof laya.html.dom.HTMLBrElement)M$G(),M$B.y=M$v;else{if(M$c._isChar()){if((M$f=M$c).isWord)M$C=M$D||"\n"===M$f.char,M$B.wordStartIndex=M$B.elements.length;else{if(M$w=M$f.width+M$f.style.letterSpacin,0<M$A.length&&M$o<M$u+M$w&&0<M$B.wordStartIndex){var M$H;M$H=M$B.elements.length-M$B.wordStartIndex+1,M$B.elements.length=M$B.wordStartIndex,M$h-=M$H,M$G();continue}M$C=!1,M$E+=M$f.width}M$w=M$f.width+M$k,M$x=M$f.height,M$D=!1,(M$C=M$C||M$o<M$u+M$w)&&M$G(),M$B.minTextHeight=Math.min(M$B.minTextHeight,M$c.height)}else M$d=M$c._getCSSStyle(),M$g=M$c,M$e=M$d.padding,0===M$d._getCssFloat()||(M$t=!0),M$C=M$D||M$d.lineElement,M$w=M$g.width*M$g._style._tf.scaleX+M$e[1]+M$e[3]+M$k,M$x=M$g.height*M$g._style._tf.scaleY+M$e[0]+M$e[2],M$D=M$d.lineElement,(M$C=M$C||M$o<M$u+M$w&&M$d.wordWrap)&&M$G();M$B.elements.push(M$c),M$B.h=Math.max(M$B.h,M$x),M$c.x=M$u,M$c.y=M$v,M$u+=M$w,M$B.w=M$u-M$k,M$B.y=M$v,M$p=Math.max(M$u+M$q,M$p)}else M$F||(M$u+=M$K.DIV_ELEMENT_PADDING),M$B.wordStartIndex=M$B.elements.length;if(M$v=M$B.y+M$B.h,M$t){var M$I=0,M$J=M$o;for(M$n&&0<M$a.width&&(M$J=M$a.width),M$h=0,M$i=M$A.length;M$h<M$i;M$h++)M$A[M$h].updatePos(0,M$J,M$h,M$I,M$r,M$s,M$m),M$I+=Math.max(M$m,M$A[M$h].h+M$l);M$v=M$I}return M$n&&(M$a.width=M$p),M$v>M$a.height&&(M$a.height=M$v),[M$p,M$v]},M$K._multiLineLayout2=function(M$a){var M$b=new Array;M$a._addChildsToLayout(M$b);var M$c,M$d,M$e,M$f,M$g,M$h=0,M$i=M$b.length,M$j=M$a._getCSSStyle(),M$k=M$j.letterSpacing,M$l=M$j.leading,M$m=M$j.lineHeight,M$n=M$j._widthAuto()||!M$j.wordWrap,M$o=M$n?999999:M$a.width,M$p=(M$a.height,0),M$q=M$j.italic?M$j.fontSize/3:0,M$r=2-M$j._getAlign(),M$s=M$j._getValign(),M$t=0!==M$s||0!=M$r||0!=M$m,M$u=0,M$v=0,M$w=0,M$x=0,M$A=new Array,M$B=M$A[0]=new M$M,M$C=!1,M$D=!1;M$B.h=0,M$j.italic&&(M$o-=M$j.fontSize/3);var M$E=0,M$F=!0;function M$G(){M$B.y=M$v,M$v+=M$B.h+M$l,0==M$B.h&&(M$v+=M$m),M$B.mWidth=M$E,M$E=0,M$B=new M$M,M$A.push(M$B),M$B.h=0,M$C=!(M$F=!(M$u=0))}for(M$h=0;M$h<M$i;M$h++)if(null!=(M$c=M$b[M$h]))if(M$F=!1,M$c instanceof laya.html.dom.HTMLBrElement)M$G(),M$B.y=M$v;else{if(M$c._isChar()){if((M$f=M$c).isWord)M$C=M$D||"\n"===M$f.char,M$B.wordStartIndex=M$B.elements.length;else{if(0<M$A.length&&M$o<M$u+M$w&&0<M$B.wordStartIndex){var M$H;M$H=M$B.elements.length-M$B.wordStartIndex+1,M$B.elements.length=M$B.wordStartIndex,M$h-=M$H,M$G();continue}M$C=!1,M$E+=M$f.width}M$w=M$f.width+M$k,M$x=M$f.height,M$D=!1,(M$C=M$C||M$o<M$u+M$w)&&M$G(),M$B.minTextHeight=Math.min(M$B.minTextHeight,M$c.height)}else M$d=M$c._getCSSStyle(),M$g=M$c,M$e=M$d.padding,0===M$d._getCssFloat()||(M$t=!0),M$C=M$D||M$d.lineElement,M$w=M$g.width*M$g._style._tf.scaleX+M$e[1]+M$e[3]+M$k,M$x=M$g.height*M$g._style._tf.scaleY+M$e[0]+M$e[2],M$D=M$d.lineElement,(M$C=M$C||M$o<M$u+M$w&&M$d.wordWrap)&&M$G();M$B.elements.push(M$c),M$B.h=Math.max(M$B.h,M$x),M$c.x=M$u,M$c.y=M$v,M$u+=M$w,M$B.w=M$u-M$k,M$B.y=M$v,M$p=Math.max(M$u+M$q,M$p)}else M$F||(M$u+=M$K.DIV_ELEMENT_PADDING),M$B.wordStartIndex=M$B.elements.length;if(M$v=M$B.y+M$B.h,M$t){var M$I=0,M$J=M$o;for(M$h=0,M$i=M$A.length;M$h<M$i;M$h++)M$A[M$h].updatePos(0,M$J,M$h,M$I,M$r,M$s,M$m),M$I+=Math.max(M$m,M$A[M$h].h+M$l);M$v=M$I}for(M$n&&(M$a.width=M$p),M$v>M$a.height&&(M$a.height=M$v),M$h=0,M$i=M$A.length;M$h<M$i;M$h++)M$A[M$h].revertOrder(M$o);return[M$p,M$v]},M$K._will=null,M$K.DIV_ELEMENT_PADDING=0,M$K}(),M$M=function(){function M$a(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}M$g(M$a,"laya.html.utils.LayoutLine");var M$b=M$a.prototype;return M$b.updatePos=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){var M$h,M$i=0;0<this.elements.length&&(M$i=(M$h=this.elements[this.elements.length-1]).x+M$h.width-this.elements[0].x);var M$j=0,M$k=NaN;1===M$e&&(M$j=(M$b-M$i)/2),2===M$e&&(M$j=M$b-M$i),0===M$g||0!=M$f||(M$f=1);for(var M$l=0,M$m=this.elements.length;M$l<M$m;M$l++){var M$n=(M$h=this.elements[M$l])._getCSSStyle();switch(0!==M$j&&(M$h.x+=M$j),M$n._getValign()){case 0:M$h.y=M$d;break;case 1:var M$o=0;99999!=this.minTextHeight&&(M$o=this.minTextHeight);var M$p=(M$o+M$g)/2;M$p=Math.max(M$p,this.h),M$k=(laya.html.dom.HTMLImageElement,M$d+M$p-M$h.height),M$h.y=M$k;break;case 2:M$h.y=M$d+(M$g-M$h.height)}}},M$b.revertOrder=function(M$a){var M$b;if(0<this.elements.length){var M$c,M$d=0;for(M$c=this.elements.length,M$d=0;M$d<M$c;M$d++)(M$b=this.elements[M$d]).x=M$a-M$b.x-M$b.width}},M$a}(),M$v=function(M$c){function M$b(){this.URI=null,this._href=null,M$b.__super.call(this),this._text=M$b._EMPTYTEXT,this.setStyle(new M$i(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}M$g(M$b,"laya.html.dom.HTMLElement",M$c);var M$a=M$b.prototype;return M$a.layaoutCallNative=function(){var M$a=0;if(this._childs&&0<(M$a=this._childs.length))for(var M$b=0;M$b<M$a;M$b++)this._childs[M$b].layaoutCallNative&&this._childs[M$b].layaoutCallNative();var M$c=this._getWords();M$c?laya.html.dom.HTMLElement.fillWords(this,M$c,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},M$a.appendChild=function(M$a){return this.addChild(M$a)},M$a._getWords2=function(){var M$a=this._text.text;if(!M$a||0===M$a.length)return null;var M$b,M$c,M$d=0,M$e=0;if(this._text.drawWords)M$c=this._text.drawWords;else{for(M$e=(M$b=M$a.split(" ")).length-1,M$c=[],M$d=0;M$d<M$e;M$d++)M$c.push(M$b[M$d]," ");0<=M$e&&M$c.push(M$b[M$e]),this._text.drawWords=M$c}var M$f,M$g=this._text.words;if(M$g&&M$g.length===M$c.length)return M$g;null===M$g&&(this._text.words=M$g=[]),M$g.length=M$c.length;var M$h=this.style,M$i=M$h.font;for(M$d=0,M$e=M$c.length;M$d<M$e;M$d++){M$f=M$s.measureText(M$c[M$d],M$i);var M$j=M$g[M$d]=new M$l(M$c[M$d],M$f.width,M$f.height||M$h.fontSize,M$h);if(1<M$j.char.length&&(M$j.charNum=M$j.char),this.href){var M$k=new M$n;this.addChild(M$k),M$j.setSprite(M$k)}}return M$g},M$a._getWords=function(){if(!M$L.CharacterCache)return this._getWords2();var M$a=this._text.text;if(!M$a||0===M$a.length)return null;var M$b,M$c=this._text.words;if(M$c&&M$c.length===M$a.length)return M$c;null===M$c&&(this._text.words=M$c=[]),M$c.length=M$a.length;for(var M$d=this.style,M$e=M$d.font,M$f=0,M$g=M$a.length;M$f<M$g;M$f++)if(M$b=M$s.measureText(M$a.charAt(M$f),M$e)){var M$h=M$c[M$f]=new M$l(M$a.charAt(M$f),M$b.width,M$b.height||M$d.fontSize,M$d);if(this.href){var M$i=new M$n;this.addChild(M$i),M$h.setSprite(M$i)}}else console.warn("_getWords size is null"+M$a.charAt(M$f),M$e);return M$c},M$a.showLinkSprite=function(){var M$a=this._text.words;if(M$a)for(var M$b,M$c,M$d=[],M$e=0;M$e<M$a.length;M$e++)M$c=M$a[M$e],(M$b=new M$n).graphics.drawRect(0,0,M$c.width,M$c.height,"#ff0000"),M$b.width=M$c.width,M$b.height=M$c.height,this.addChild(M$b),M$d.push(M$b)},M$a._layoutLater=function(){var M$a=this.style;512&M$a._type||(M$a.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&M$a.block?(M$u.later(this),M$a._type|=512):this.parent&&this.parent._layoutLater())},M$a._setAttributes=function(M$a,M$b){switch(M$a){case"style":return void this.style.cssText(M$b);case"class":return void(this.className=M$b)}M$c.prototype._setAttributes.call(this,M$a,M$b)},M$a.updateHref=function(){if(null!=this._href){var M$a=this._getWords();if(M$a)for(var M$b,M$c,M$d=0;M$d<M$a.length;M$d++)(M$c=(M$b=M$a[M$d]).getSprite())&&(M$c.size(M$b.width,M$b.height),M$c.on("click",this,this.onLinkHandler))}},M$a.onLinkHandler=function(M$a){switch(M$a.type){case"click":for(var M$b=this;M$b;)M$b.event("link",[this.href]),M$b=M$b.parent}},M$a.formatURL=function(M$a){return this.URI?M$r.formatURL(M$a,this.URI?this.URI.path:null):M$a},M$h(0,M$a,"href",function(){return this._href},function(M$a){null!=(this._href=M$a)&&(this._getCSSStyle().underLine=1,this.updateHref())}),M$h(0,M$a,"color",null,function(M$a){this.style.color=M$a}),M$h(0,M$a,"onClick",null,function(M$a){M$d._runScript("fn=function(event){"+M$a+";}"),this.on("click",this,void 0)}),M$h(0,M$a,"id",null,function(M$a){M$w.document.setElementById(M$a,this)}),M$h(0,M$a,"innerTEXT",function(){return this._text.text},function(M$a){this.text=M$a}),M$h(0,M$a,"style",function(){return this._style}),M$h(0,M$a,"text",function(){return this._text.text},function(M$a){this._text==M$b._EMPTYTEXT?this._text={text:M$a,words:null}:(this._text.text=M$a,this._text.words&&(this._text.words.length=0)),M$m.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),M$h(0,M$a,"parent",M$c.prototype._$get_parent,function(M$a){if(M$a instanceof laya.html.dom.HTMLElement){var M$b=M$a;this.URI||(this.URI=M$b.URI),this.style.inherit(M$b.style)}M$d.superSet(M$n,this,"parent",M$a)}),M$h(0,M$a,"className",null,function(M$a){this.style.attrs(M$w.document.styleSheets["."+M$a])}),M$b.fillWords=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){M$a.graphics.clear();for(var M$h=0,M$i=M$b.length;M$h<M$i;M$h++){var M$j=M$b[M$h];M$a.graphics.fillText(M$j.char,M$j.x+M$c,M$j.y+M$d,M$e,M$f,"left",M$g)}},M$b._EMPTYTEXT={text:null,words:null},M$b}(M$n),M$b=(function(M$a){function M$b(){M$b.__super.call(this),this.style.lineElement=!0,this.style.block=!0}M$g(M$b,"laya.html.dom.HTMLBrElement",M$v)}(),function(M$a){function M$b(){this.contextHeight=NaN,this.contextWidth=NaN,M$b.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}M$g(M$b,"laya.html.dom.HTMLDivElement",M$a);var M$c=M$b.prototype;return M$c.appendHTML=function(M$a){M$t.parse(this,M$a,this.URI),this.layout()},M$c._addChildsToLayout=function(M$b){var M$a=this._getWords();if(null==M$a&&0==this._childs.length)return!1;M$a&&M$a.forEach(function(M$a){M$b.push(M$a)});for(var M$c=!0,M$d=0,M$e=this._childs.length;M$d<M$e;M$d++){var M$f=this._childs[M$d];M$c?M$c=!1:M$b.push(null),M$f._addToLayout(M$b)}return!0},M$c._addToLayout=function(M$a){this.layout()},M$c.layout=function(){if(this.style){this.style._type|=512;var M$a=M$u.layout(this);if(M$a){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new M$k);var M$b=this._$P.mHtmlBounds;M$b.x=M$b.y=0,M$b.width=this.contextWidth=M$a[0],M$b.height=this.contextHeight=M$a[1],this.setBounds(M$b)}}},M$h(0,M$c,"height",function(){return this._height?this._height:this.contextHeight},M$a.prototype._$set_height),M$h(0,M$c,"innerHTML",null,function(M$a){this.destroyChildren(),this.appendHTML(M$a)}),M$h(0,M$c,"width",function(){return this._width?this._width:this.contextWidth},function(M$a){var M$b=!1;M$b=0===M$a?M$a!=this._width:M$a!=this.width,M$d.superSet(M$v,this,"width",M$a),M$b&&this.layout()}),M$b}(M$v)),M$w=function(M$a){function M$b(){this.all=new Array,this.styleSheets=M$i.styleSheets,M$b.__super.call(this)}M$g(M$b,"laya.html.dom.HTMLDocument",M$v);var M$c=M$b.prototype;return M$c.getElementById=function(M$a){return this.all[M$a]},M$c.setElementById=function(M$a,M$b){this.all[M$a]=M$b},M$e(M$b,["document",function(){return this.document=new M$b}]),M$b}();(function(M$a){function M$b(){this._tex=null,this._url=null,this._renderArgs=[],M$b.__super.call(this),this.style.block=!0}M$g(M$b,"laya.html.dom.HTMLImageElement",M$v);var M$c=M$b.prototype;M$c._addToLayout=function(M$a){!this._style.absolute&&M$a.push(this)},M$c.render=function(M$a,M$b,M$c){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(M$p.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,M$a.ctx.drawTexture2(M$b,M$c,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},M$c.layaoutCallNative=function(){var M$a=0;if(this._childs&&0<(M$a=this._childs.length))for(var M$b=0;M$b<M$a;M$b++)this._childs[M$b].layaoutCallNative&&this._childs[M$b].layaoutCallNative()},M$h(0,M$c,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(M$a){this._width!==M$a&&(this._width=M$a,this._style.width=M$a,this.repaint())}),M$h(0,M$c,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(M$a){this._height!==M$a&&(this._height=M$a,this._style.height=M$a,this.repaint())}),M$c.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),M$j.clearCache(this,this._url),this._tex=null),M$v.prototype.destroy.call(this)},M$c.onloaded=function(){var M$a=this._style;M$a&&!M$a.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),M$a&&!M$a.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),M$m.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},M$c._loadImageComplete=function(M$a,M$b,M$c){if(!this._destroyed)if(null!=M$c)if(M$c instanceof ArrayBuffer){var M$d=new DataView(M$c);new laya.webgl.resource.WebGLImage(new Uint8Array(M$c,8),M$a,0,!1,M$d.getUint32(0),M$d.getUint32(4));this.onloaded()}else if(M$c instanceof M$q)M$j.imgMgrSet[M$a]=M$b,M$f.imgMgrLock(M$a,M$j.imgMgrSet[M$a]),this._url=M$a,this._tex=M$c,M$j.keepCache(this,M$a),M$j.cacheRes(M$a,this._tex),this.onloaded();else{var M$e=-1!=M$a.indexOf(".png",M$a.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(M$c,M$a,M$e,!1,M$c.width,M$c.height);this.onloaded()}else this.event("error","Load image failed")},M$h(0,M$c,"src",null,function(M$a){(M$a=this.formatURL(M$a),this._url!=M$a)&&(null!=this._tex&&(M$j.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=M$a,(this._tex=M$j.getRes(M$a))?(M$j.keepCache(this,M$a),this.onloaded()):M$f.imgMgrLoad(M$a,this._loadImageComplete.bind(this),2,!1))})})(),function(M$a){function M$b(){this.type=null,M$b.__super.call(this),this.visible=!1}M$g(M$b,"laya.html.dom.HTMLLinkElement",M$a);var M$c=M$b.prototype;M$c._onload=function(M$a){switch(this.type){case"text/css":M$i.parseCSS(M$a,this.URI)}},M$h(0,M$c,"href",M$a.prototype._$get_href,function(M$a){var M$b=this;M$a=this.formatURL(M$a),this.URI=new M$r(M$a);var M$c=new M$j;M$c.once("complete",null,function(M$a){M$b._onload(M$a)}),M$c.load(M$a,"text")}),M$b._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(M$v),function(M$a){function M$b(){M$b.__super.call(this),this.visible=!1}M$g(M$b,"laya.html.dom.HTMLStyleElement",M$a),M$h(0,M$b.prototype,"text",M$a.prototype._$get_text,function(M$a){M$i.parseCSS(M$a,null)})}(M$v),function(M$a){function M$b(){M$b.__super.call(this),this._getCSSStyle().valign="middle"}M$g(M$b,"laya.html.dom.HTMLIframeElement",M$a),M$h(0,M$b.prototype,"href",M$a.prototype._$get_href,function(M$c){var M$d=this;M$c=this.formatURL(M$c);var M$a=new M$j;M$a.once("complete",null,function(M$a){var M$b=M$d.URI;M$d.URI=new M$r(M$c),M$d.innerHTML=M$a,!M$b||(M$d.URI=M$b)}),M$a.load(M$c,"text")})}(M$b)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(M$a,M$b){"use strict";for(var M$c in Object.defineProperty(M$b,"__esModule",{value:!0}),Laya){var M$d=Laya[M$c];M$d&&M$d.__isclass&&(M$b[M$c]=M$d)}}),function(M$a,M$b,M$p){M$p.un,M$p.uns;var M$d=M$p.static,M$f=M$p.class,M$e=M$p.getset,M$c=(M$p.__newvec,laya.display.Animation),M$q=(laya.utils.Browser,laya.utils.ClassUtils),M$g=laya.filters.ColorFilter,M$h=laya.utils.Ease,M$i=laya.events.Event,M$j=(laya.events.EventDispatcher,laya.display.css.Font),M$k=laya.display.FrameAnimation,M$l=laya.display.Graphics,M$m=laya.utils.Handler,M$n=laya.display.Input,M$s=laya.net.Loader,M$o=(laya.display.Node,laya.maths.Point),M$r=laya.maths.Rectangle,M$t=laya.renders.Render,M$u=laya.display.Sprite,M$v=laya.display.Text,M$w=laya.resource.Texture,M$x=laya.utils.Tween,M$A=laya.utils.Utils,M$B=laya.utils.WeakObject;M$p.interface("laya.ui.IItem"),M$p.interface("laya.ui.ISelect"),M$p.interface("laya.ui.IRender"),M$p.interface("laya.ui.IComponent"),M$p.interface("laya.ui.IBox","IComponent");var M$C=function(){function M$a(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return M$f(M$a,"laya.ui.LayoutStyle"),M$d(M$a,["EMPTY",function(){return this.EMPTY=new M$a}]),M$a}(),M$D=function(){function M$a(){}return M$f(M$a,"laya.ui.Styles"),M$a.labelColor="#000000",M$a.buttonStateNum=3,M$a.scrollBarMinNum=15,M$a.scrollBarDelayTime=500,M$d(M$a,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),M$a}(),M$E=function(){function M$e(){}return M$f(M$e,"laya.ui.UIUtils"),M$e.fillArray=function(M$a,M$b,M$c){var M$d=M$a.concat();if(M$b)for(var M$e=M$b.split(","),M$f=0,M$g=Math.min(M$d.length,M$e.length);M$f<M$g;M$f++){var M$h=M$e[M$f];M$d[M$f]="true"==M$h||"false"!=M$h&&M$h,null!=M$c&&(M$d[M$f]=M$c(M$h))}return M$d},M$e.toColor=function(M$a){return M$A.toHexColor(M$a)},M$e.gray=function(M$a,M$b){void 0===M$b&&(M$b=!0),M$b?M$e.addFilter(M$a,M$e.grayFilter):M$e.clearFilter(M$a,M$g)},M$e.addFilter=function(M$a,M$b){var M$c=M$a.filters||[];M$c.push(M$b),M$a.filters=M$c},M$e.clearFilter=function(M$a,M$b){var M$c=M$a.filters;if(null!=M$c&&0<M$c.length){for(var M$d=M$c.length-1;-1<M$d;M$d--){var M$e=M$c[M$d];M$p.__typeof(M$e,M$b)&&M$c.splice(M$d,1)}M$a.filters=M$c}},M$e._getReplaceStr=function(M$a){return M$e.escapeSequence[M$a]},M$e.adptString=function(M$a){return M$a.replace(/\\(\w)/g,M$e._getReplaceStr)},M$e.getBindFun=function(M$a){var M$b=M$e._funMap.get(M$a);if(null==M$b){var M$c='"'+M$a+'"',M$d="(function(data){if(data==null)return;with(data){try{\nreturn "+(M$c=M$c.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";M$b=M$p._runScript(M$d),M$e._funMap.set(M$a,M$b)}return M$b},M$d(M$e,["grayFilter",function(){return this.grayFilter=new M$g([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new M$B}]),M$e}(),M$F=function(){function M$a(){}return M$f(M$a,"UIConfig"),M$a.touchScrollEnable=!0,M$a.mouseWheelEnable=!0,M$a.showButtons=!0,M$a.popupBgColor="#000000",M$a.popupBgAlpha=.5,M$a.closeDialogOnSide=!0,M$a}(),M$G=function(M$c){function M$r(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,M$r.__super.call(this),this._weakKeys=[]}M$f(M$r,"laya.ui.AutoBitmap",M$c);var M$a=M$r.prototype;return M$a.destroy=function(){if(M$s.clearObject(this,this._weakKey),this._weakKeys){for(var M$a=0,M$b=this._weakKeys.length;M$a<M$b;++M$a)M$s.clearObject(this,this._weakKeys[M$a]);this._weakKeys=null}M$c.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},M$a._setChanged=function(){this._isChanged||(this._isChanged=!0,M$p.timer.callLater(this,this.changeSource))},M$a.changeSource=function(){this._isChanged=!1;var M$a=this._source;if(M$a&&M$a.bitmap){var M$b=this.width,M$c=this.height,M$d=this._sizeGrid,M$e=M$a.sourceWidth,M$f=M$a.sourceHeight;if(!M$d||M$e===M$b&&M$f===M$c)this.cleanByTexture(M$a,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,M$b,M$c);else{M$s.clearObject(this,this._weakKey),M$a.$_GID||(M$a.$_GID=M$A.getGID());var M$g=M$a.$_GID+"."+M$b+"."+M$c+"."+M$d.join("."),M$h=M$s.findObject(M$g);if(M$A.isOKCmdList(M$h))return this._weakKey=M$g,M$s.keepObject(this,this._weakKey),void(this.cmds=M$h);this.clear();var M$i,M$j,M$k=M$d[0],M$l=M$d[1],M$m=M$d[2],M$n=M$d[3],M$o=M$d[4],M$p=!1;if(M$b==M$e&&(M$n=M$l=0),M$c==M$f&&(M$k=M$m=0),M$b<M$n+M$l){var M$q=M$b;M$p=!0,M$b=M$n+M$l,this.save(),this.clipRect(0,0,M$q,M$c)}M$n&&M$k&&(M$i=M$r.getTexture(M$a,0,0,M$n,M$k),M$j=this._weakKeys[0],M$i?(M$j!=M$i.weakKey&&(M$s.clearObject(this,M$j),M$s.keepObject(this,M$i.weakKey),this._weakKeys[0]=M$i.weakKey),this.drawTexture(M$i,0,0,M$n,M$k)):(M$s.clearObject(this,M$j),this._weakKeys[0]="")),M$l&&M$k&&(M$i=M$r.getTexture(M$a,M$e-M$l,0,M$l,M$k),M$j=this._weakKeys[1],M$i?(M$j!=M$i.weakKey&&(M$s.clearObject(this,M$j),M$s.keepObject(this,M$i.weakKey),this._weakKeys[1]=M$i.weakKey),this.drawTexture(M$i,M$b-M$l,0,M$l,M$k)):(M$s.clearObject(this,M$j),this._weakKeys[1]="")),M$n&&M$m&&(M$i=M$r.getTexture(M$a,0,M$f-M$m,M$n,M$m),M$j=this._weakKeys[2],M$i?(M$j!=M$i.weakKey&&(M$s.clearObject(this,M$j),M$s.keepObject(this,M$i.weakKey),this._weakKeys[2]=M$i.weakKey),this.drawTexture(M$i,0,M$c-M$m,M$n,M$m)):(M$s.clearObject(this,M$j),this._weakKeys[2]="")),M$l&&M$m&&(M$i=M$r.getTexture(M$a,M$e-M$l,M$f-M$m,M$l,M$m),M$j=this._weakKeys[3],M$i?(M$j!=M$i.weakKey&&(M$s.clearObject(this,M$j),M$s.keepObject(this,M$i.weakKey),this._weakKeys[3]=M$i.weakKey),this.drawTexture(M$i,M$b-M$l,M$c-M$m,M$l,M$m)):(M$s.clearObject(this,M$j),this._weakKeys[3]="")),M$k&&(M$i=M$r.getTexture(M$a,M$n,0,M$e-M$n-M$l,M$k),M$j=this._weakKeys[4],M$i?(M$j!=M$i.weakKey&&(M$s.clearObject(this,M$j),M$s.keepObject(this,M$i.weakKey),this._weakKeys[4]=M$i.weakKey),this.drawBitmap(M$o,M$i,M$n,0,M$b-M$n-M$l,M$k)):(M$s.clearObject(this,M$j),this._weakKeys[4]="")),M$m&&(M$i=M$r.getTexture(M$a,M$n,M$f-M$m,M$e-M$n-M$l,M$m),M$j=this._weakKeys[5],M$i?(M$j!=M$i.weakKey&&(M$s.clearObject(this,M$j),M$s.keepObject(this,M$i.weakKey),this._weakKeys[5]=M$i.weakKey),this.drawBitmap(M$o,M$i,M$n,M$c-M$m,M$b-M$n-M$l,M$m)):(M$s.clearObject(this,M$j),this._weakKeys[5]="")),M$n&&(M$i=M$r.getTexture(M$a,0,M$k,M$n,M$f-M$k-M$m),M$j=this._weakKeys[6],M$i?(M$j!=M$i.weakKey&&(M$s.clearObject(this,M$j),M$s.keepObject(this,M$i.weakKey),this._weakKeys[6]=M$i.weakKey),this.drawBitmap(M$o,M$i,0,M$k,M$n,M$c-M$k-M$m)):(M$s.clearObject(this,M$j),this._weakKeys[6]="")),M$l&&(M$i=M$r.getTexture(M$a,M$e-M$l,M$k,M$l,M$f-M$k-M$m),M$j=this._weakKeys[7],M$i?(M$j!=M$i.weakKey&&(M$s.clearObject(this,M$j),M$s.keepObject(this,M$i.weakKey),this._weakKeys[7]=M$i.weakKey),this.drawBitmap(M$o,M$i,M$b-M$l,M$k,M$l,M$c-M$k-M$m)):(M$s.clearObject(this,M$j),this._weakKeys[7]="")),M$i=M$r.getTexture(M$a,M$n,M$k,M$e-M$n-M$l,M$f-M$k-M$m),M$j=this._weakKeys[8],M$i?(M$j!=M$i.weakKey&&(M$s.clearObject(this,M$j),M$s.keepObject(this,M$i.weakKey),this._weakKeys[8]=M$i.weakKey),this.drawBitmap(M$o,M$i,M$n,M$k,M$b-M$n-M$l,M$c-M$k-M$m)):(M$s.clearObject(this,M$j),this._weakKeys[8]=""),M$p&&this.restore(),this.autoCacheCmd&&!M$t.isConchApp&&(M$s.saveObject(M$g,this.cmds,null),this._weakKey=M$g,M$s.keepObject(this,this._weakKey))}this._repaint()}},M$a.drawBitmap=function(M$a,M$b,M$c,M$d,M$e,M$f){void 0===M$e&&(M$e=0),void 0===M$f&&(M$f=0),M$e<.1||M$f<.1||(!M$a||M$b.width==M$e&&M$b.height==M$f?this.drawTexture(M$b,M$c,M$d,M$e,M$f):this.fillTexture(M$b,M$c,M$d,M$e,M$f))},M$a.clear=function(M$a){void 0===M$a&&(M$a=!0),M$c.prototype.clear.call(this,!1)},M$e(0,M$a,"sizeGrid",function(){return this._sizeGrid},function(M$a){this._sizeGrid=M$a,this._setChanged()}),M$e(0,M$a,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(M$a){this._width!=M$a&&(this._width=M$a,this._setChanged())}),M$e(0,M$a,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(M$a){this._height!=M$a&&(this._height=M$a,this._setChanged())}),M$e(0,M$a,"source",function(){return this._source},function(M$a){M$a?(this._source=M$a,this._setChanged()):(this._source=null,this.clear())}),M$r.getTexture=function(M$a,M$b,M$c,M$d,M$e){M$d<=0&&(M$d=1),M$e<=0&&(M$e=1),M$a.$_GID||(M$a.$_GID=M$A.getGID());var M$f=M$a.$_GID+"."+M$b+"."+M$c+"."+M$d+"."+M$e,M$g=M$s.findObject(M$f);if((!M$g||!M$g.source)&&(M$g=M$w.createFromTexture(M$a,M$b,M$c,M$d,M$e))){if(M$a.alphaTexture){var M$h=M$a.width/M$a.alphaTexture.width;M$g.alphaTexture=M$w.createFromTexture(M$a.alphaTexture,M$b/M$h,M$c/M$h,M$d/M$h,M$e/M$h)}M$s.saveObject(M$f,M$g),M$g.weakKey=M$f}return M$g},M$r}(M$l),M$H=(function(M$a){function M$b(){M$b.__super.call(this)}M$f(M$b,"laya.ui.UIEvent",M$i),M$b.SHOW_TIP="showtip",M$b.HIDE_TIP="hidetip"}(),function(M$b){function M$a(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,M$a.__super.call(this),this._layout=M$C.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}M$f(M$a,"laya.ui.Component",M$b);var M$c=M$a.prototype;return M$p.imps(M$c,{"laya.ui.IComponent":!0}),M$c.destroy=function(M$a){void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,M$a),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},M$c.preinitialize=function(){},M$c.createChildren=function(){},M$c.initialize=function(){},M$c.callLater=function(M$a,M$b){M$p.timer.callLater(this,M$a,M$b)},M$c.runCallLater=function(M$a){M$p.timer.runCallLater(this,M$a)},M$c.commitMeasure=function(){},M$c.changeSize=function(){this.event("resize")},M$c.getLayout=function(){return this._layout===M$C.EMPTY&&(this._layout=new M$C),this._layout},M$c._setLayoutEnabled=function(M$a){this._layout&&this._layout.enable!=M$a&&(this._layout.enable=M$a,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},M$c.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},M$c.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},M$c.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},M$c.resetLayoutX=function(){var M$a=this._layout;if(isNaN(M$a.anchorX)||(this.pivotX=M$a.anchorX*this.width),this.layoutEnabled){var M$b=this.parent;M$b&&(isNaN(M$a.centerX)?isNaN(M$a.left)?isNaN(M$a.right)||(this.x=Math.round(M$b.width-this.displayWidth-M$a.right+this.pivotX*this.scaleX)):(this.x=Math.round(M$a.left+this.pivotX*this.scaleX),isNaN(M$a.right)||(this.width=(M$b._width-M$a.left-M$a.right)/(this.scaleX||.01))):this.x=Math.round(.5*(M$b.width-this.displayWidth)+M$a.centerX+this.pivotX*this.scaleX))}},M$c.resetLayoutY=function(){var M$a=this._layout;if(isNaN(M$a.anchorY)||(this.pivotY=M$a.anchorY*this.height),this.layoutEnabled){var M$b=this.parent;M$b&&(isNaN(M$a.centerY)?isNaN(M$a.top)?isNaN(M$a.bottom)||(this.y=Math.round(M$b.height-this.displayHeight-M$a.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(M$a.top+this.pivotY*this.scaleY),isNaN(M$a.bottom)||(this.height=(M$b._height-M$a.top-M$a.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(M$b.height-this.displayHeight)+M$a.centerY+this.pivotY*this.scaleY))}},M$c.onMouseOver=function(M$a){M$p.stage.event("showtip",this._toolTip)},M$c.onMouseOut=function(M$a){M$p.stage.event("hidetip",this._toolTip)},M$e(0,M$c,"displayWidth",function(){return this.width*this.scaleX}),M$e(0,M$c,"width",function(){return this._width?this._width:this.measureWidth},function(M$a){this._width!=M$a&&(this._width=M$a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),M$e(0,M$c,"measureWidth",function(){var M$a=0;this.commitMeasure();for(var M$b=this.numChildren-1;-1<M$b;M$b--){var M$c=this.getChildAt(M$b);M$c.visible&&(M$a=Math.max(M$c.x+M$c.width*M$c.scaleX,M$a))}return M$a}),M$e(0,M$c,"displayHeight",function(){return this.height*this.scaleY}),M$e(0,M$c,"height",function(){return this._height?this._height:this.measureHeight},function(M$a){this._height!=M$a&&(this._height=M$a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),M$e(0,M$c,"dataSource",function(){return this._dataSource},function(M$a){for(var M$b in this._dataSource=M$a,this._dataSource)this.hasOwnProperty(M$b)&&"function"!=typeof this[M$b]&&(this[M$b]=this._dataSource[M$b])}),M$e(0,M$c,"scaleY",M$b.prototype._$get_scaleY,function(M$a){M$p.superGet(M$u,this,"scaleY")!=M$a&&(M$p.superSet(M$u,this,"scaleY",M$a),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),M$e(0,M$c,"measureHeight",function(){var M$a=0;this.commitMeasure();for(var M$b=this.numChildren-1;-1<M$b;M$b--){var M$c=this.getChildAt(M$b);M$c.visible&&(M$a=Math.max(M$c.y+M$c.height*M$c.scaleY,M$a))}return M$a}),M$e(0,M$c,"scaleX",M$b.prototype._$get_scaleX,function(M$a){M$p.superGet(M$u,this,"scaleX")!=M$a&&(M$p.superSet(M$u,this,"scaleX",M$a),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),M$e(0,M$c,"top",function(){return this._layout.top},function(M$a){M$a!=this._layout.top&&(this.getLayout().top=M$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),M$e(0,M$c,"bottom",function(){return this._layout.bottom},function(M$a){M$a!=this._layout.bottom&&(this.getLayout().bottom=M$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),M$e(0,M$c,"left",function(){return this._layout.left},function(M$a){M$a!=this._layout.left&&(this.getLayout().left=M$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),M$e(0,M$c,"right",function(){return this._layout.right},function(M$a){M$a!=this._layout.right&&(this.getLayout().right=M$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),M$e(0,M$c,"centerX",function(){return this._layout.centerX},function(M$a){M$a!=this._layout.centerX&&(this.getLayout().centerX=M$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),M$e(0,M$c,"centerY",function(){return this._layout.centerY},function(M$a){M$a!=this._layout.centerY&&(this.getLayout().centerY=M$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),M$e(0,M$c,"anchorX",function(){return this._layout.anchorX},function(M$a){M$a!=this._layout.anchorX&&(this.getLayout().anchorX=M$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),M$e(0,M$c,"anchorY",function(){return this._layout.anchorY},function(M$a){M$a!=this._layout.anchorY&&(this.getLayout().anchorY=M$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),M$e(0,M$c,"tag",function(){return this._tag},function(M$a){this._tag=M$a}),M$e(0,M$c,"toolTip",function(){return this._toolTip},function(M$a){this._toolTip!=M$a&&(null!=(this._toolTip=M$a)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),M$e(0,M$c,"comXml",function(){return this._comXml},function(M$a){this._comXml=M$a}),M$e(0,M$c,"gray",function(){return this._gray},function(M$a){M$a!==this._gray&&(this._gray=M$a,M$E.gray(this,M$a))}),M$e(0,M$c,"disabled",function(){return this._disabled},function(M$a){M$a!==this._disabled&&(this.gray=this._disabled=M$a,this.mouseEnabled=!M$a)}),M$a}(M$u)),M$I=function(M$a){function M$b(){this.lockLayer=null,this.popupEffect=function(M$a){M$a.scale(1,1),M$x.from(M$a,{x:M$p.stage.width/2,y:M$p.stage.height/2,scaleX:0,scaleY:0},300,M$h.backOut,M$m.create(this,this.doOpen,[M$a]))},this.closeEffect=function(M$a,M$b){M$x.to(M$a,{x:M$p.stage.width/2,y:M$p.stage.height/2,scaleX:0,scaleY:0},300,M$h.strongOut,M$m.create(this,this.doClose,[M$a,M$b]))},M$b.__super.call(this),this.maskLayer=new M$u,this.popupEffectHandler=M$m.create(this,this.popupEffect,null,!1),this.closeEffectHandler=M$m.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,M$p.stage.addChild(this),M$p.stage.on("resize",this,this._onResize),M$F.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}M$f(M$b,"laya.ui.DialogManager",M$u);var M$c=M$b.prototype;return M$c._closeOnSide=function(){var M$a=this.getChildAt(this.numChildren-1);M$a instanceof laya.ui.Dialog&&M$a.close("side")},M$c.setLockView=function(M$a){this.lockLayer||(this.lockLayer=new M$J,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(M$p.stage.width,M$p.stage.height)),this.lockLayer.removeChildren(),M$a&&(M$a.centerX=M$a.centerY=0,this.lockLayer.addChild(M$a))},M$c._onResize=function(M$a){var M$b=this.maskLayer.width=M$p.stage.width,M$c=this.maskLayer.height=M$p.stage.height;this.lockLayer&&this.lockLayer.size(M$b,M$c),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,M$b,M$c,M$F.popupBgColor),this.maskLayer.alpha=M$F.popupBgAlpha;for(var M$d=this.numChildren-1;-1<M$d;M$d--){var M$e=this.getChildAt(M$d);M$e.popupCenter&&this._centerDialog(M$e)}},M$c._centerDialog=function(M$a){M$a.x=Math.round((M$p.stage.width-M$a.width>>1)+M$a.pivotX),M$a.y=Math.round((M$p.stage.height-M$a.height>>1)+M$a.pivotY)},M$c.open=function(M$a,M$b,M$c){void 0===M$b&&(M$b=!1),void 0===M$c&&(M$c=!1),M$b&&this._closeAll(),M$a.popupCenter&&this._centerDialog(M$a),this.addChild(M$a),(M$a.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),M$c&&null!=M$a.popupEffect?M$a.popupEffect.runWith(M$a):this.doOpen(M$a),this.event("open")},M$c.doOpen=function(M$a){M$a.onOpened()},M$c.lock=function(M$a){this.lockLayer&&(M$a?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},M$c.close=function(M$a,M$b,M$c){void 0===M$c&&(M$c=!1),M$c&&null!=M$a.closeEffect?M$a.closeEffect.runWith([M$a,M$b]):this.doClose(M$a,M$b),this.event("close")},M$c.doClose=function(M$a,M$b){M$a.removeSelf(),M$a.isModal&&this._checkMask(),M$a.closeHandler&&M$a.closeHandler.runWith(M$b),M$a.onClosed(M$b)},M$c.closeAll=function(){this._closeAll(),this.event("close")},M$c._closeAll=function(){for(var M$a=this.numChildren-1;-1<M$a;M$a--){var M$b=this.getChildAt(M$a);M$b&&null!=M$b.close&&this.doClose(M$b)}},M$c.getDialogsByGroup=function(M$a){for(var M$b=[],M$c=this.numChildren-1;-1<M$c;M$c--){var M$d=this.getChildAt(M$c);M$d&&M$d.group===M$a&&M$b.push(M$d)}return M$b},M$c.closeByGroup=function(M$a){for(var M$b=[],M$c=this.numChildren-1;-1<M$c;M$c--){var M$d=this.getChildAt(M$c);M$d&&M$d.group===M$a&&(M$d.close(),M$b.push(M$d))}return M$b},M$c._checkMask=function(){this.maskLayer.removeSelf();for(var M$a=this.numChildren-1;-1<M$a;M$a--){var M$b=this.getChildAt(M$a);if(M$b&&M$b.isModal)return void this.addChildAt(this.maskLayer,M$a)}},M$b}(),M$J=function(M$a){function M$b(){M$b.__super.call(this)}M$f(M$b,"laya.ui.Box",M$a);var M$c=M$b.prototype;return M$p.imps(M$c,{"laya.ui.IBox":!0}),M$e(0,M$c,"dataSource",M$a.prototype._$get_dataSource,function(M$a){for(var M$b in this._dataSource=M$a){var M$c=this.getChildByName(M$b);M$c?M$c.dataSource=M$a[M$b]:this.hasOwnProperty(M$b)&&"function"!=typeof this[M$b]&&(this[M$b]=M$a[M$b])}}),M$b}(M$H),M$K=function(M$b){function M$c(M$a,M$b){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,M$c.__super.call(this),this._labelColors=M$D.buttonLabelColors,this._stateNum=M$D.buttonStateNum,void 0===M$b&&(M$b=""),this.skin=M$a,this.label=M$b}M$f(M$c,"laya.ui.Button",M$b);var M$a=M$c.prototype;return M$p.imps(M$a,{"laya.ui.ISelect":!0}),M$a.destroy=function(M$a){M$s.clearCache(this,this._skin),M$s.clearObject(this,this._weakKey),void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,M$a),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(M$a),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},M$a.createChildren=function(){this.graphics=this._bitmap=new M$G},M$a.createText=function(){this._text||(this._text=new M$v,this._text.overflow=M$v.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},M$a.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},M$a.onMouse=function(M$a){if(!1!==this.toggle||!this._selected)return"click"===M$a.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=M$c.stateMap[M$a.type]))},M$a.changeClips=function(){var M$a=M$s.getRes(this._skin);if(M$a&&this._skin&&""!=this._skin){M$s.clearObject(this,this._weakKey);var M$b=M$a.sourceWidth,M$c=M$a.sourceHeight/this._stateNum;M$a.$_GID||(M$a.$_GID=M$A.getGID());var M$d=M$a.$_GID+"-"+this._stateNum,M$e=M$s.findObject(M$d);if(M$A.isOkTextureList(M$e)||(M$e=null),M$e)this._weakKey=M$d,M$s.keepObject(this,this._weakKey),this._sources=M$e;else{if(this._sources=[],1===this._stateNum)this._sources.push(M$a);else for(var M$f=0;M$f<this._stateNum;M$f++){var M$g=M$w.createFromTexture(M$a,0,M$c*M$f,M$b,M$c);if(M$a.alphaTexture){var M$h=M$a.width/M$a.alphaTexture.width;M$g.alphaTexture=M$w.createFromTexture(M$a.alphaTexture,0/M$h,M$c*M$f/M$h,M$b/M$h,M$c/M$h)}this._sources.push(M$g)}M$s.saveObject(M$d,this._sources),this._weakKey=M$d,M$s.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||M$b,this._bitmap.height=this._height||M$c,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=M$b)}else console.warn("lose skin ",this._skin,this.name,this.__className)},M$a.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var M$a=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[M$a]),this.label&&(this._text.color=this._labelColors[M$a],this._strokeColors&&(this._text.strokeColor=this._strokeColors[M$a]))},M$a._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},M$e(0,M$a,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(M$a){this.createText(),this._text.strokeColor=M$a}),M$e(0,M$a,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),M$e(0,M$a,"skin",function(){return this._skin},function(M$a){this._skin!=M$a&&(M$s.clearCache(this,this._skin),this._skin=M$a,M$s.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),M$e(0,M$a,"state",function(){return this._state},function(M$a){this._state!=M$a&&(this._state=M$a,this._setStateChanged())}),M$e(0,M$a,"text",function(){return this.createText(),this._text}),M$e(0,M$a,"stateNum",function(){return this._stateNum},function(M$a){"string"==typeof M$a&&(M$a=parseInt(M$a)),this._stateNum!=M$a&&(this._stateNum=M$a<1?1:3<M$a?3:M$a,this.callLater(this.changeClips))}),M$e(0,M$a,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(M$a){this._strokeColors=M$E.fillArray(M$D.buttonLabelColors,M$a,String),this._setStateChanged()}),M$e(0,M$a,"labelColors",function(){return this._labelColors.join(",")},function(M$a){this._labelColors=M$E.fillArray(M$D.buttonLabelColors,M$a,String),this._setStateChanged()}),M$e(0,M$a,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),M$e(0,M$a,"label",function(){return this._text?this._text.text:null},function(M$a){(this._text||M$a)&&(this.createText(),this._text.text!=M$a&&(M$a&&!this._text.parent&&this.addChild(this._text),this._text.text=(M$a+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),M$e(0,M$a,"selected",function(){return this._selected},function(M$a){this._selected!=M$a&&(this._selected=M$a,this.state=this._selected?2:0,this.event("change"))}),M$e(0,M$a,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(M$a){this.createText(),this._text.padding=M$E.fillArray(M$D.labelPadding,M$a,Number)}),M$e(0,M$a,"labelSize",function(){return this.createText(),this._text.fontSize},function(M$a){this.createText(),this._text.fontSize=M$a}),M$e(0,M$a,"labelStroke",function(){return this.createText(),this._text.stroke},function(M$a){this.createText(),this._text.stroke=M$a}),M$e(0,M$a,"labelBold",function(){return this.createText(),this._text.bold},function(M$a){this.createText(),this._text.bold=M$a}),M$e(0,M$a,"labelFont",function(){return this.createText(),this._text.font},function(M$a){this.createText(),this._text.font=M$a}),M$e(0,M$a,"labelAlign",function(){return this.createText(),this._text.align},function(M$a){this.createText(),this._text.align=M$a}),M$e(0,M$a,"clickHandler",function(){return this._clickHandler},function(M$a){this._clickHandler=M$a}),M$e(0,M$a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(M$a){this._bitmap.sizeGrid=M$E.fillArray(M$D.defaultSizeGrid,M$a,Number)}),M$e(0,M$a,"width",M$b.prototype._$get_width,function(M$a){M$p.superSet(M$H,this,"width",M$a),this._autoSize&&(this._bitmap.width=M$a,this._text&&(this._text.width=M$a))}),M$e(0,M$a,"height",M$b.prototype._$get_height,function(M$a){M$p.superSet(M$H,this,"height",M$a),this._autoSize&&(this._bitmap.height=M$a,this._text&&(this._text.height=M$a))}),M$e(0,M$a,"dataSource",M$b.prototype._$get_dataSource,function(M$a){"number"==typeof(this._dataSource=M$a)||"string"==typeof M$a?this.label=M$a+"":M$p.superSet(M$H,this,"dataSource",M$a)}),M$e(0,M$a,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(M$a){this._bitmap._offset=M$a?M$E.fillArray([1,1],M$a,Number):[]}),M$d(M$c,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),M$c}(M$H),M$L=function(M$b){function M$d(M$a,M$b,M$c){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,M$d.__super.call(this),void 0===M$b&&(M$b=1),void 0===M$c&&(M$c=1),this._clipX=M$b,this._clipY=M$c,this.skin=M$a}M$f(M$d,"laya.ui.Clip",M$b);var M$a=M$d.prototype;return M$a.destroy=function(M$a){M$s.clearCache(this,this._skin),M$s.clearObject(this,this._weakKey),void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},M$a.dispose=function(){this.destroy(!0),M$p.loader.clearRes(this._skin)},M$a.createChildren=function(){this.graphics=this._bitmap=new M$G},M$a._onDisplay=function(M$a){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},M$a.changeClip=function(){if(this._clipChanged=!1,this._skin){var M$a=M$s.getRes(this._skin);M$a?this.loadComplete(this._skin,M$a):M$p.loader.load(this._skin,M$m.create(this,this.loadComplete,[this._skin]))}},M$a.loadComplete=function(M$a,M$b){if(M$a===this._skin&&M$b){M$s.clearObject(this,this._weakKey);var M$c=this._clipWidth||Math.ceil(M$b.sourceWidth/this._clipX),M$d=this._clipHeight||Math.ceil(M$b.sourceHeight/this._clipY),M$e=this._skin+M$c+M$d,M$f=M$s.findObject(M$e);if(M$A.isOkTextureList(M$f)||(M$f=null),M$f)this._weakKey=M$e,M$s.keepObject(this,this._weakKey),this._sources=M$f;else{this._sources=[];for(var M$g=0;M$g<this._clipY;M$g++)for(var M$h=0;M$h<this._clipX;M$h++){var M$i=M$w.createFromTexture(M$b,M$c*M$h,M$d*M$g,M$c,M$d);if(M$b.alphaTexture){var M$j=M$b.width/M$b.alphaTexture.width;M$i.alphaTexture=M$w.createFromTexture(M$b.alphaTexture,M$c*M$h/M$j,M$d*M$g/M$j,M$c/M$j,M$d/M$j)}this._sources.push(M$i)}M$s.saveObject(M$e,this._sources),this._weakKey=M$e,M$s.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},M$a.play=function(M$a,M$b){void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=-1),this._isPlaying=!0,this.index=M$a,this._toIndex=M$b,this._index++,M$p.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},M$a._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},M$a.stop=function(){this._isPlaying=!1,M$p.timer.clear(this,this._loop),this.event("complete")},M$a._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},M$e(0,M$a,"interval",function(){return this._interval},function(M$a){this._interval!=M$a&&(this._interval=M$a,this._isPlaying&&this.play())}),M$e(0,M$a,"skin",function(){return this._skin},function(M$a){this._skin!=M$a&&(M$s.clearCache(this,this._skin),(this._skin=M$a)?(M$s.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),M$e(0,M$a,"sources",function(){return this._sources},function(M$a){this._sources=M$a,this.index=this._index,this.event("loaded")}),M$e(0,M$a,"clipX",function(){return this._clipX},function(M$a){this._clipX=M$a||1,this._setClipChanged()}),M$e(0,M$a,"clipY",function(){return this._clipY},function(M$a){this._clipY=M$a||1,this._setClipChanged()}),M$e(0,M$a,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),M$e(0,M$a,"clipWidth",function(){return this._clipWidth},function(M$a){this._clipWidth=M$a,this._setClipChanged()}),M$e(0,M$a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(M$a){this._bitmap.sizeGrid=M$E.fillArray(M$D.defaultSizeGrid,M$a,Number)}),M$e(0,M$a,"group",function(){return this._group},function(M$a){M$a&&this._skin&&M$s.setGroup(this._skin,M$a),this._group=M$a}),M$e(0,M$a,"clipHeight",function(){return this._clipHeight},function(M$a){this._clipHeight=M$a,this._setClipChanged()}),M$e(0,M$a,"width",M$b.prototype._$get_width,function(M$a){M$p.superSet(M$H,this,"width",M$a),this._bitmap.width=M$a}),M$e(0,M$a,"height",M$b.prototype._$get_height,function(M$a){M$p.superSet(M$H,this,"height",M$a),this._bitmap.height=M$a}),M$e(0,M$a,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),M$e(0,M$a,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),M$e(0,M$a,"index",function(){return this._index},function(M$a){this._index=M$a,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[M$a]),this.event("change")}),M$e(0,M$a,"autoPlay",function(){return this._autoPlay},function(M$a){this._autoPlay!=M$a&&((this._autoPlay=M$a)?this.play():this.stop())}),M$e(0,M$a,"isPlaying",function(){return this._isPlaying},function(M$a){this._isPlaying=M$a}),M$e(0,M$a,"dataSource",M$b.prototype._$get_dataSource,function(M$a){"number"==typeof(this._dataSource=M$a)&&Math.floor(M$a)==M$a||"string"==typeof M$a?this.index=parseInt(M$a):M$p.superSet(M$H,this,"dataSource",M$a)}),M$e(0,M$a,"bitmap",function(){return this._bitmap}),M$d}(M$H),M$M=function(M$b){function M$a(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,M$a.__super.call(this)}M$f(M$a,"laya.ui.ColorPicker",M$b);var M$c=M$a.prototype;return M$c.destroy=function(M$a){void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,M$a),this._colorPanel&&this._colorPanel.destroy(M$a),this._colorButton&&this._colorButton.destroy(M$a),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},M$c.createChildren=function(){this.addChild(this._colorButton=new M$K),this._colorPanel=new M$J,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new M$u),this._colorPanel.addChild(this._colorBlock=new M$u),this._colorPanel.addChild(this._colorInput=new M$n)},M$c.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},M$c.onPanelMouseDown=function(M$a){M$a.stopPropagation()},M$c.changePanel=function(){this._panelChanged=!1;var M$a=this._colorPanel.graphics;M$a.clear(),M$a.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(M$a=this._colorTiles.graphics).clear();for(var M$b=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],M$c=0;M$c<12;M$c++)for(var M$d=0;M$d<20;M$d++){var M$e=0;M$e=0===M$d?M$b[M$c]:1===M$d?0:51*(((3*M$c+M$d/6)%3<<0)+3*(M$c/6<<0))<<16|M$d%6*51<<8|(M$c<<0)%6*51;var M$f=M$E.toColor(M$e);this._colors.push(M$f);var M$g=M$d*this._gridSize,M$h=M$c*this._gridSize;M$a.drawRect(M$g,M$h,this._gridSize,this._gridSize,M$f,"#000000")}},M$c.onColorButtonClick=function(M$a){this._colorPanel.parent?this.close():this.open()},M$c.open=function(){var M$a=this.localToGlobal(new M$o),M$b=M$a.x+this._colorPanel.width<=M$p.stage.width?M$a.x:M$p.stage.width-this._colorPanel.width,M$c=M$a.y+this._colorButton.height;M$c=M$c+this._colorPanel.height<=M$p.stage.height?M$c:M$a.y-this._colorPanel.height,this._colorPanel.pos(M$b,M$c),this._colorPanel.zOrder=1001,M$p._currentStage.addChild(this._colorPanel),M$p.stage.on("mousedown",this,this.removeColorBox)},M$c.close=function(){M$p.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},M$c.removeColorBox=function(M$a){this.close()},M$c.onColorFieldKeyDown=function(M$a){13==M$a.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),M$a.stopPropagation())},M$c.onColorInputChange=function(M$a){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},M$c.onColorTilesClick=function(M$a){this.selectedColor=this.getColorByMouse(),this.close()},M$c.onColorTilesMouseMove=function(M$a){this._colorInput.focus=!1;var M$b=this.getColorByMouse();this._colorInput.text=M$b,this.drawBlock(M$b)},M$c.getColorByMouse=function(){var M$a=this._colorTiles.getMousePoint(),M$b=Math.floor(M$a.x/this._gridSize),M$c=Math.floor(M$a.y/this._gridSize);return this._colors[20*M$c+M$b]},M$c.drawBlock=function(M$a){var M$b=this._colorBlock.graphics;M$b.clear();var M$c=M$a||"#ffffff";M$b.drawRect(0,0,50,20,M$c,this._borderColor),M$a||M$b.drawLine(0,0,50,20,"#ff0000")},M$c.changeColor=function(){var M$a=this.graphics;M$a.clear();var M$b=this._selectedColor||"#000000";M$a.drawRect(0,0,this._colorButton.width,this._colorButton.height,M$b)},M$c._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},M$e(0,M$c,"inputBgColor",function(){return this._inputBgColor},function(M$a){this._inputBgColor=M$a,this._setPanelChanged()}),M$e(0,M$c,"selectedColor",function(){return this._selectedColor},function(M$a){this._selectedColor!=M$a&&(this._selectedColor=this._colorInput.text=M$a,this.drawBlock(M$a),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",M$i.EMPTY.setTo("change",this,this)))}),M$e(0,M$c,"skin",function(){return this._colorButton.skin},function(M$a){this._colorButton.skin=M$a,this.changeColor()}),M$e(0,M$c,"bgColor",function(){return this._bgColor},function(M$a){this._bgColor=M$a,this._setPanelChanged()}),M$e(0,M$c,"borderColor",function(){return this._borderColor},function(M$a){this._borderColor=M$a,this._setPanelChanged()}),M$e(0,M$c,"inputColor",function(){return this._inputColor},function(M$a){this._inputColor=M$a,this._setPanelChanged()}),M$a}(M$H),M$N=function(M$b){function M$c(M$a,M$b){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,M$c.__super.call(this),this._itemColors=M$D.comboBoxItemColors,this.skin=M$a,this.labels=M$b}M$f(M$c,"laya.ui.ComboBox",M$b);var M$a=M$c.prototype;return M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,M$a),this._button&&this._button.destroy(M$a),this._list&&this._list.destroy(M$a),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},M$a.createChildren=function(){this.addChild(this._button=new M$K),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},M$a._createList=function(){this._list=new M$X,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},M$a._setListEvent=function(M$a){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=M$m.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},M$a.onListDown=function(M$a){M$a.stopPropagation()},M$a.onScrollBarDown=function(M$a){M$a.stopPropagation()},M$a.onButtonMouseDown=function(M$a){this.callLater(this.switchTo,[!this._isOpen])},M$a.changeList=function(){this._listChanged=!1;var M$a=this.width-2,M$b=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:M$a,height:this._itemHeight,fontSize:this._itemSize,color:M$b}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},M$a.onlistItemMouse=function(M$a,M$b){var M$c=M$a.type;if("mouseover"===M$c||"mouseout"===M$c){if(this._isCustomList)return;var M$d=this._list.getCell(M$b);if(!M$d)return;var M$e=M$d.getChildByName("label");M$e&&("mouseover"===M$c?(M$e.bgColor=this._itemColors[0],M$e.color=this._itemColors[1]):(M$e.bgColor=null,M$e.color=this._itemColors[2]))}else"click"===M$c&&(this.selectedIndex=M$b,this.isOpen=!1)},M$a.switchTo=function(M$a){this.isOpen=M$a},M$a.changeOpen=function(){this.isOpen=!this._isOpen},M$a.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var M$a=this._list.graphics;M$a.clear(),M$a.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var M$b=this._list.array||[],M$c=M$b.length=0,M$d=this._labels.length;M$c<M$d;M$c++)M$b.push({label:this._labels[M$c]});this._list.height=this._listHeight,this._list.array=M$b},M$a.changeSelected=function(){this._button.label=this.selectedLabel},M$a._onStageMouseWheel=function(M$a){this._list&&!this._list.contains(M$a.target)&&this.removeList(null)},M$a.removeList=function(M$a){M$p.stage.off("mousedown",this,this.removeList),M$p.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},M$e(0,M$a,"selectedIndex",function(){return this._selectedIndex},function(M$a){this._selectedIndex!=M$a&&(this._selectedIndex=M$a,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[M$i.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),M$e(0,M$a,"measureHeight",function(){return this._button.height}),M$e(0,M$a,"skin",function(){return this._button.skin},function(M$a){this._button.skin!=M$a&&(this._button.skin=M$a,this._listChanged=!0)}),M$e(0,M$a,"measureWidth",function(){return this._button.width}),M$e(0,M$a,"width",M$b.prototype._$get_width,function(M$a){M$p.superSet(M$H,this,"width",M$a),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),M$e(0,M$a,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(M$a){this.selectedIndex=this._labels.indexOf(M$a)}),M$e(0,M$a,"labels",function(){return this._labels.join(",")},function(M$a){0<this._labels.length&&(this.selectedIndex=-1),M$a?this._labels=M$a.split(","):this._labels.length=0,this._itemChanged=!0}),M$e(0,M$a,"height",M$b.prototype._$get_height,function(M$a){M$p.superSet(M$H,this,"height",M$a),this._button.height=this._height}),M$e(0,M$a,"selectHandler",function(){return this._selectHandler},function(M$a){this._selectHandler=M$a}),M$e(0,M$a,"visibleNum",function(){return this._visibleNum},function(M$a){this._visibleNum=M$a,this._listChanged=!0}),M$e(0,M$a,"labelBold",function(){return this._button.text.bold},function(M$a){this._button.text.bold=M$a}),M$e(0,M$a,"itemColors",function(){return String(this._itemColors)},function(M$a){this._itemColors=M$E.fillArray(this._itemColors,M$a,String),this._listChanged=!0}),M$e(0,M$a,"itemSize",function(){return this._itemSize},function(M$a){this._itemSize=M$a,this._listChanged=!0}),M$e(0,M$a,"scrollBar",function(){return this.list.scrollBar}),M$e(0,M$a,"isOpen",function(){return this._isOpen},function(M$a){if(this._isOpen!=M$a)if(this._isOpen=M$a,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var M$b=this.localToGlobal(M$o.TEMP.setTo(0,0)),M$c=M$b.y+this._button.height;M$c=M$c+this._listHeight<=M$p.stage.height?M$c:M$b.y-this._listHeight,this._list.pos(M$b.x,M$c),this._list.zOrder=1001,M$p._currentStage.addChild(this._list),M$p.stage.once("mousedown",this,this.removeList),M$p.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),M$e(0,M$a,"scrollBarSkin",function(){return this._scrollBarSkin},function(M$a){this._scrollBarSkin=M$a}),M$e(0,M$a,"sizeGrid",function(){return this._button.sizeGrid},function(M$a){this._button.sizeGrid=M$a}),M$e(0,M$a,"button",function(){return this._button}),M$e(0,M$a,"list",function(){return this._list||this._createList(),this._list},function(M$a){M$a&&(M$a.removeSelf(),this._isCustomList=!0,this._list=M$a,this._setListEvent(M$a),this._itemHeight=M$a.getCell(0).height+M$a.spaceY)}),M$e(0,M$a,"dataSource",M$b.prototype._$get_dataSource,function(M$a){"number"==typeof(this._dataSource=M$a)&&Math.floor(M$a)==M$a||"string"==typeof M$a?this.selectedIndex=parseInt(M$a):M$a instanceof Array?this.labels=M$a.join(","):M$p.superSet(M$H,this,"dataSource",M$a)}),M$e(0,M$a,"labelColors",function(){return this._button.labelColors},function(M$a){this._button.labelColors!=M$a&&(this._button.labelColors=M$a)}),M$e(0,M$a,"labelPadding",function(){return this._button.text.padding.join(",")},function(M$a){this._button.text.padding=M$E.fillArray(M$D.labelPadding,M$a,Number)}),M$e(0,M$a,"labelSize",function(){return this._button.text.fontSize},function(M$a){this._button.text.fontSize=M$a}),M$e(0,M$a,"labelFont",function(){return this._button.text.font},function(M$a){this._button.text.font=M$a}),M$e(0,M$a,"stateNum",function(){return this._button.stateNum},function(M$a){this._button.stateNum=M$a}),M$c}(M$H),M$O=function(M$b){function M$c(M$a){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,M$c.__super.call(this),this._showButtons=M$F.showButtons,this._touchScrollEnable=M$F.touchScrollEnable,this._mouseWheelEnable=M$F.mouseWheelEnable,this.skin=M$a,this.max=1}M$f(M$c,"laya.ui.ScrollBar",M$b);var M$a=M$c.prototype;return M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),this.stopScroll(),this.target=null,M$b.prototype.destroy.call(this,M$a),this.upButton&&this.upButton.destroy(M$a),this.downButton&&this.downButton.destroy(M$a),this.slider&&this.slider.destroy(M$a),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},M$a.createChildren=function(){this.addChild(this.slider=new M$P),this.addChild(this.upButton=new M$K),this.addChild(this.downButton=new M$K)},M$a.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},M$a.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},M$a.onButtonMouseDown=function(M$a){var M$b=M$a.currentTarget===this.upButton;this.slide(M$b),M$p.timer.once(M$D.scrollBarDelayTime,this,this.startLoop,[M$b]),M$p.stage.once("mouseup",this,this.onStageMouseUp)},M$a.startLoop=function(M$a){M$p.timer.frameLoop(1,this,this.slide,[M$a])},M$a.slide=function(M$a){M$a?this.value-=this._scrollSize:this.value+=this._scrollSize},M$a.onStageMouseUp=function(M$a){M$p.timer.clear(this,this.startLoop),M$p.timer.clear(this,this.slide)},M$a.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},M$a.changeSize=function(){M$b.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},M$a.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},M$a.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},M$a.setScroll=function(M$a,M$b,M$c){this.runCallLater(this.changeSize),this.slider.setSlider(M$a,M$b,M$c),this.slider.bar.visible=0<M$b,!this._hide&&this.autoHide&&(this.visible=!1)},M$a.onTargetMouseWheel=function(M$a){this.value-=M$a.delta*this._scrollSize,this.target=this._target},M$a.onTargetMouseDown=function(M$a){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new M$o),this._lastPoint.setTo(M$p.stage.mouseX,M$p.stage.mouseY),M$p.timer.clear(this,this.tweenMove),M$x.clearTween(this),M$p.stage.once("mouseup",this,this.onStageMouseUp2),M$p.stage.once("mouseout",this,this.onStageMouseUp2),M$p.timer.frameLoop(1,this,this.loop)},M$a.loop=function(){var M$a=M$p.stage.mouseY,M$b=M$p.stage.mouseX;if(this._lastOffset=this.isVertical?M$a-this._lastPoint.y:M$b-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?M$p.stage._canvasTransform.getScaleY():M$p.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=M$b,this._lastPoint.y=M$a,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},M$a.onStageMouseUp2=function(M$a){if(M$p.stage.off("mouseup",this,this.onStageMouseUp2),M$p.stage.off("mouseout",this,this.onStageMouseUp2),M$p.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?M$x.to(this,{value:this.min},this.elasticBackTime,M$h.sineOut,M$m.create(this,this.elasticOver)):this._value>this.max&&M$x.to(this,{value:this.max},this.elasticBackTime,M$h.sineOut,M$m.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?M$p.stage.mouseY-this._lastPoint.y:M$p.stage.mouseX-this._lastPoint.x);for(var M$b=0,M$c=Math.min(this._offsets.length,3),M$d=0;M$d<M$c;M$d++)M$b+=this._offsets[this._offsets.length-1-M$d];if(this._lastOffset=M$b/M$c,(M$b=Math.abs(this._lastOffset))<2)return void this.event("end");60<M$b&&(this._lastOffset=0<this._lastOffset?60:-60);var M$e=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));M$p.timer.frameLoop(1,this,this.tweenMove,[M$e])}},M$a.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&M$x.to(this,{alpha:0},500),this.event("end")},M$a.tweenMove=function(M$a){this._lastOffset*=this.rollRatio;var M$b=NaN;if(0<M$a&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,M$b=.5*-(this.min-M$a-this.value),this._lastOffset>M$b&&(this._lastOffset=M$b)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,M$b=.5*-(this.max+M$a-this.value),this._lastOffset<M$b&&(this._lastOffset=M$b))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(M$p.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?M$x.to(this,{value:this.min},this.elasticBackTime,M$h.sineOut,M$m.create(this,this.elasticOver)):this._value>this.max?M$x.to(this,{value:this.max},this.elasticBackTime,M$h.sineOut,M$m.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&M$x.to(this,{alpha:0},500)}},M$a.stopScroll=function(){this.onStageMouseUp2(null),M$p.timer.clear(this,this.tweenMove),M$x.clearTween(this)},M$e(0,M$a,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),M$e(0,M$a,"skin",function(){return this._skin},function(M$a){this._skin!=M$a&&(this._skin=M$a,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),M$e(0,M$a,"max",function(){return this.slider.max},function(M$a){this.slider.max=M$a}),M$e(0,M$a,"showButtons",function(){return this._showButtons},function(M$a){this._showButtons=M$a,this.callLater(this.changeScrollBar)}),M$e(0,M$a,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),M$e(0,M$a,"min",function(){return this.slider.min},function(M$a){this.slider.min=M$a}),M$e(0,M$a,"value",function(){return this._value},function(M$a){M$a!==this._value&&(this._value=M$a,this._isElastic||(this.slider._value!=M$a&&(this.slider._value=M$a,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),M$e(0,M$a,"isVertical",function(){return this.slider.isVertical},function(M$a){this.slider.isVertical=M$a}),M$e(0,M$a,"sizeGrid",function(){return this.slider.sizeGrid},function(M$a){this.slider.sizeGrid=M$a}),M$e(0,M$a,"scrollSize",function(){return this._scrollSize},function(M$a){this._scrollSize=M$a}),M$e(0,M$a,"dataSource",M$b.prototype._$get_dataSource,function(M$a){"number"==typeof(this._dataSource=M$a)||"string"==typeof M$a?this.value=Number(M$a):M$p.superSet(M$H,this,"dataSource",M$a)}),M$e(0,M$a,"thumbPercent",function(){return this._thumbPercent},function(M$a){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),M$a=1<=M$a?.99:M$a,this._thumbPercent=M$a,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*M$a,M$D.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*M$a,M$D.scrollBarMinNum))}),M$e(0,M$a,"target",function(){return this._target},function(M$a){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=M$a)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),M$e(0,M$a,"hide",function(){return this._hide},function(M$a){this._hide=M$a,this.visible=!M$a}),M$e(0,M$a,"touchScrollEnable",function(){return this._touchScrollEnable},function(M$a){this._touchScrollEnable=M$a,this.target=this._target}),M$e(0,M$a,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(M$a){this._mouseWheelEnable=M$a,this.target=this._target}),M$e(0,M$a,"tick",function(){return this.slider.tick},function(M$a){this.slider.tick=M$a}),M$c}(M$H),M$P=function(M$b){function M$c(M$a){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,M$c.__super.call(this),this.skin=M$a}M$f(M$c,"laya.ui.Slider",M$b);var M$a=M$c.prototype;return M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,M$a),this._bg&&this._bg.destroy(M$a),this._bar&&this._bar.destroy(M$a),this._progress&&this._progress.destroy(M$a),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},M$a.createChildren=function(){this.addChild(this._bg=new M$Q),this.addChild(this._bar=new M$K)},M$a.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},M$a.onBarMouseDown=function(M$a){this._globalSacle||(this._globalSacle=new M$o),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=M$p.stage.mouseX,this._ty=M$p.stage.mouseY,M$p.stage.on("mousemove",this,this.mouseMove),M$p.stage.once("mouseup",this,this.mouseUp),M$p.stage.once("mouseout",this,this.mouseUp),this.showValueText()},M$a.showValueText=function(){if(this.showLabel){var M$a=laya.ui.Slider.label;this.addChild(M$a),M$a.textField.changeText(this._value+""),this.isVertical?(M$a.x=this._bar.x+20,M$a.y=.5*(this._bar.height-M$a.height)+this._bar.y):(M$a.y=this._bar.y-20,M$a.x=.5*(this._bar.width-M$a.width)+this._bar.x)}},M$a.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},M$a.mouseUp=function(M$a){M$p.stage.off("mousemove",this,this.mouseMove),M$p.stage.off("mouseup",this,this.mouseUp),M$p.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},M$a.mouseMove=function(M$a){var M$b=this._value;this.isVertical?(this._bar.y+=(M$p.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(M$p.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=M$p.stage.mouseX,this._ty=M$p.stage.mouseY;var M$c=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*M$c)/M$c,this._value!=M$b&&this.sendChangeEvent(),this.showValueText()},M$a.sendChangeEvent=function(M$a){void 0===M$a&&(M$a="change"),this.event(M$a),this.changeHandler&&this.changeHandler.runWith(this._value)},M$a.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},M$a.changeSize=function(){M$b.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},M$a.setSlider=function(M$a,M$b,M$c){this._value=-1,this._min=M$a,this._max=M$a<M$b?M$b:M$a,this.value=M$c<M$a?M$a:M$b<M$c?M$b:M$c},M$a.changeValue=function(){var M$a=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*M$a)/M$a,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var M$b=this._max-this._min;0===M$b&&(M$b=1),this.isVertical?(this._bar.y=(this._value-this._min)/M$b*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/M$b*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},M$a.onBgMouseDown=function(M$a){var M$b=this._bg.getMousePoint();this.isVertical?this.value=M$b.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=M$b.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},M$e(0,M$a,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),M$e(0,M$a,"skin",function(){return this._skin},function(M$a){if(this._skin!=M$a){this._skin=M$a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var M$b=this._skin.replace(".png","$progress.png");M$s.getRes(M$b)&&(this._progress||(this.addChild(this._progress=new M$Q),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=M$b),this.setBarPoint(),this.callLater(this.changeValue)}}),M$e(0,M$a,"allowClickBack",function(){return this._allowClickBack},function(M$a){this._allowClickBack!=M$a&&((this._allowClickBack=M$a)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),M$e(0,M$a,"max",function(){return this._max},function(M$a){this._max!=M$a&&(this._max=M$a,this.callLater(this.changeValue))}),M$e(0,M$a,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),M$e(0,M$a,"tick",function(){return this._tick},function(M$a){this._tick!=M$a&&(this._tick=M$a,this.callLater(this.changeValue))}),M$e(0,M$a,"sizeGrid",function(){return this._bg.sizeGrid},function(M$a){this._bg.sizeGrid=M$a,this._bar.sizeGrid=M$a,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),M$e(0,M$a,"min",function(){return this._min},function(M$a){this._min!=M$a&&(this._min=M$a,this.callLater(this.changeValue))}),M$e(0,M$a,"value",function(){return this._value},function(M$a){if(this._value!=M$a){var M$b=this._value;this._value=M$a,this.changeValue(),this._value!=M$b&&this.sendChangeEvent()}}),M$e(0,M$a,"dataSource",M$b.prototype._$get_dataSource,function(M$a){"number"==typeof(this._dataSource=M$a)||"string"==typeof M$a?this.value=Number(M$a):M$p.superSet(M$H,this,"dataSource",M$a)}),M$e(0,M$a,"bar",function(){return this._bar}),M$d(M$c,["label",function(){return this.label=new M$R}]),M$c}(M$H),M$Q=function(M$b){function M$c(M$a){this._bitmap=null,this._skin=null,this._group=null,M$c.__super.call(this),this.skin=M$a}M$f(M$c,"laya.ui.Image",M$b);var M$a=M$c.prototype;return M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,M$s.clearCache(this,this._skin)},M$a.dispose=function(){this.destroy(!0),M$s.clearCache(this,this._skin)},M$a.createChildren=function(){this.graphics=this._bitmap=new M$G},M$a.setSource=function(M$a,M$b){M$a===this._skin&&M$b&&(this.source=M$b,this.onCompResize())},M$e(0,M$a,"source",function(){return this._bitmap.source},function(M$a){this._bitmap&&(this._bitmap.source=M$a,this.event("loaded"),this.repaint())}),M$e(0,M$a,"dataSource",M$b.prototype._$get_dataSource,function(M$a){"string"==typeof(this._dataSource=M$a)?this.skin=M$a:M$p.superSet(M$H,this,"dataSource",M$a)}),M$e(0,M$a,"measureHeight",function(){return this._bitmap.height}),M$e(0,M$a,"skin",function(){return this._skin},function(M$a){if(this._skin!=M$a)if(M$s.clearCache(this,this._skin),this._skin=M$a){M$s.keepCache(this,this._skin);var M$b=M$s.getRes(M$a);M$b?(this.source=M$b,this.onCompResize()):M$p.loader.load(this._skin,M$m.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),M$e(0,M$a,"group",function(){return this._group},function(M$a){M$a&&this._skin&&M$s.setGroup(this._skin,M$a),this._group=M$a}),M$e(0,M$a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(M$a){this._bitmap.sizeGrid=M$E.fillArray(M$D.defaultSizeGrid,M$a,Number)}),M$e(0,M$a,"measureWidth",function(){return this._bitmap.width}),M$e(0,M$a,"width",M$b.prototype._$get_width,function(M$a){M$p.superSet(M$H,this,"width",M$a),this._bitmap.width=0==M$a?1e-7:M$a}),M$e(0,M$a,"height",M$b.prototype._$get_height,function(M$a){M$p.superSet(M$H,this,"height",M$a),this._bitmap.height=0==M$a?1e-7:M$a}),M$c}(M$H),M$R=function(M$b){function M$c(M$a){this._tf=null,M$c.__super.call(this),void 0===M$a&&(M$a=""),M$j.defaultColor=M$D.labelColor,this.text=M$a}M$f(M$c,"laya.ui.Label",M$b);var M$a=M$c.prototype;return M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,M$a),this._tf=null},M$a.createChildren=function(){this.addChild(this._tf=new M$v)},M$a.changeText=function(M$a){this._tf.changeText(M$a)},M$e(0,M$a,"padding",function(){return this._tf.padding.join(",")},function(M$a){this._tf.padding=M$E.fillArray(M$D.labelPadding,M$a,Number)}),M$e(0,M$a,"bold",function(){return this._tf.bold},function(M$a){this._tf.bold=M$a}),M$e(0,M$a,"align",function(){return this._tf.align},function(M$a){this._tf.align=M$a}),M$e(0,M$a,"text",function(){return this._tf.text},function(M$a){this._tf.text!=M$a&&(M$a&&(M$a=M$E.adptString(M$a+"")),this._tf.text=M$a,this.event("change"),this._width&&this._height||this.onCompResize())}),M$e(0,M$a,"italic",function(){return this._tf.italic},function(M$a){this._tf.italic=M$a}),M$e(0,M$a,"wordWrap",function(){return this._tf.wordWrap},function(M$a){this._tf.wordWrap=M$a}),M$e(0,M$a,"font",function(){return this._tf.font},function(M$a){this._tf.font=M$a}),M$e(0,M$a,"dataSource",M$b.prototype._$get_dataSource,function(M$a){"number"==typeof(this._dataSource=M$a)||"string"==typeof M$a?this.text=M$a+"":M$p.superSet(M$H,this,"dataSource",M$a)}),M$e(0,M$a,"color",function(){return this._tf.color},function(M$a){this._tf.color=M$a}),M$e(0,M$a,"valign",function(){return this._tf.valign},function(M$a){this._tf.valign=M$a}),M$e(0,M$a,"leading",function(){return this._tf.leading},function(M$a){this._tf.leading=M$a}),M$e(0,M$a,"fontSize",function(){return this._tf.fontSize},function(M$a){this._tf.fontSize=M$a}),M$e(0,M$a,"bgColor",function(){return this._tf.bgColor},function(M$a){this._tf.bgColor=M$a}),M$e(0,M$a,"borderColor",function(){return this._tf.borderColor},function(M$a){this._tf.borderColor=M$a}),M$e(0,M$a,"stroke",function(){return this._tf.stroke},function(M$a){this._tf.stroke=M$a}),M$e(0,M$a,"strokeColor",function(){return this._tf.strokeColor},function(M$a){this._tf.strokeColor=M$a}),M$e(0,M$a,"textField",function(){return this._tf}),M$e(0,M$a,"measureWidth",function(){return this._tf.width}),M$e(0,M$a,"measureHeight",function(){return this._tf.height}),M$e(0,M$a,"width",function(){return this._width||this._tf.text?M$p.superGet(M$H,this,"width"):0},function(M$a){M$p.superSet(M$H,this,"width",M$a),this._tf.width=M$a}),M$e(0,M$a,"height",function(){return this._height||this._tf.text?M$p.superGet(M$H,this,"height"):0},function(M$a){M$p.superSet(M$H,this,"height",M$a),this._tf.height=M$a}),M$e(0,M$a,"overflow",function(){return this._tf.overflow},function(M$a){this._tf.overflow=M$a}),M$e(0,M$a,"underline",function(){return this._tf.underline},function(M$a){this._tf.underline=M$a}),M$e(0,M$a,"underlineColor",function(){return this._tf.underlineColor},function(M$a){this._tf.underlineColor=M$a}),M$c}(M$H),M$S=function(M$b){function M$c(M$a){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,M$c.__super.call(this),this.skin=M$a}M$f(M$c,"laya.ui.ProgressBar",M$b);var M$a=M$c.prototype;return M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,M$a),this._bg&&this._bg.destroy(M$a),this._bar&&this._bar.destroy(M$a),this._bg=this._bar=null,this.changeHandler=null},M$a.createChildren=function(){this.addChild(this._bg=new M$Q),this.addChild(this._bar=new M$Q)},M$a.changeValue=function(){if(this.sizeGrid){var M$a=this.sizeGrid.split(","),M$b=Number(M$a[3]),M$c=Number(M$a[1]),M$d=(this.width-M$b-M$c)*this._value;this._bar.width=M$b+M$c+M$d,this._bar.visible=this._bar.width>M$b+M$c}else this._bar.width=this.width*this._value},M$e(0,M$a,"measureHeight",function(){return this._bg.height}),M$e(0,M$a,"skin",function(){return this._skin},function(M$a){this._skin!=M$a&&(this._skin=M$a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),M$e(0,M$a,"measureWidth",function(){return this._bg.width}),M$e(0,M$a,"height",M$b.prototype._$get_height,function(M$a){M$p.superSet(M$H,this,"height",M$a),this._bg.height=this._height,this._bar.height=this._height}),M$e(0,M$a,"bar",function(){return this._bar}),M$e(0,M$a,"value",function(){return this._value},function(M$a){this._value!=M$a&&(M$a=1<M$a?1:M$a<0?0:M$a,this._value=M$a,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(M$a))}),M$e(0,M$a,"bg",function(){return this._bg}),M$e(0,M$a,"sizeGrid",function(){return this._bg.sizeGrid},function(M$a){this._bg.sizeGrid=this._bar.sizeGrid=M$a}),M$e(0,M$a,"width",M$b.prototype._$get_width,function(M$a){M$p.superSet(M$H,this,"width",M$a),this._bg.width=this._width,this.callLater(this.changeValue)}),M$e(0,M$a,"dataSource",M$b.prototype._$get_dataSource,function(M$a){"number"==typeof(this._dataSource=M$a)||"string"==typeof M$a?this.value=Number(M$a):M$p.superSet(M$H,this,"dataSource",M$a)}),M$c}(M$H),M$T=(function(M$a){function M$c(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,M$c.__super.call(this),this._tipBox=new M$H,this._tipBox.addChild(this._tipText=new M$v),this._tipText.x=this._tipText.y=5,this._tipText.color=M$c.tipTextColor,this._defaultTipHandler=this._showDefaultTip,M$p.stage.on("showtip",this,this._onStageShowTip),M$p.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}M$f(M$c,"laya.ui.TipManager",M$H);var M$b=M$c.prototype;M$b._onStageHideTip=function(M$a){M$p.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},M$b._onStageShowTip=function(M$a){M$p.timer.once(M$c.tipDelay,this,this._showTip,[M$a],!0)},M$b._showTip=function(M$a){if("string"==typeof M$a){var M$b=String(M$a);Boolean(M$b)&&this._defaultTipHandler(M$b)}else M$a instanceof laya.utils.Handler?M$a.run():"function"==typeof M$a&&M$a.apply();M$p.stage.on("mousemove",this,this._onStageMouseMove),M$p.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},M$b._onStageMouseDown=function(M$a){this.closeAll()},M$b._onStageMouseMove=function(M$a){this._showToStage(this,M$c.offsetX,M$c.offsetY)},M$b._showToStage=function(M$a,M$b,M$c){void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0);var M$d=M$a.getBounds();M$a.x=M$p.stage.mouseX+M$b,M$a.y=M$p.stage.mouseY+M$c,M$a.x+M$d.width>M$p.stage.width&&(M$a.x-=M$d.width+M$b),M$a.y+M$d.height>M$p.stage.height&&(M$a.y-=M$d.height+M$c)},M$b.closeAll=function(){M$p.timer.clear(this,this._showTip),M$p.stage.off("mousemove",this,this._onStageMouseMove),M$p.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},M$b.showDislayTip=function(M$a){this.addChild(M$a),this._showToStage(this),M$p._currentStage.addChild(this)},M$b._showDefaultTip=function(M$a){this._tipText.text=M$a;var M$b=this._tipBox.graphics;M$b.clear(),M$b.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,M$c.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),M$p._currentStage.addChild(this)},M$e(0,M$b,"defaultTipHandler",function(){return this._defaultTipHandler},function(M$a){this._defaultTipHandler=M$a}),M$c.offsetX=10,M$c.offsetY=15,M$c.tipTextColor="#ffffff",M$c.tipBackColor="#111111",M$c.tipDelay=200}(),function(M$a){var M$n;function M$o(){this._idMap=null,this._aniList=null,this._watchMap={},M$o.__super.call(this)}M$f(M$o,"laya.ui.View",M$J);var M$b=M$o.prototype;return M$b.createView=function(M$a){if(M$a.animations&&!this._idMap&&(this._idMap={}),M$o.createComp(M$a,this,this),M$a.animations){var M$b,M$c,M$d=[],M$e=M$a.animations,M$f=0,M$g=M$e.length;for(M$f=0;M$f<M$g;M$f++){switch(M$b=new M$k,M$c=M$e[M$f],M$b._setUp(this._idMap,M$c),(this[M$c.name]=M$b)._setControlNode(this),M$c.action){case 1:M$b.play(0,!1);break;case 2:M$b.play(0,!0)}M$d.push(M$b)}this._aniList=M$d}0<this._width&&null==M$a.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},M$b.onEvent=function(M$a,M$b){},M$b.loadUI=function(M$a){var M$b=M$o.uiMap[M$a];M$b&&this.createView(M$b)},M$b.destroy=function(M$a){void 0===M$a&&(M$a=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,M$a)},M$b.changeData=function(M$a){var M$b=this._watchMap[M$a];if(M$b){console.log("change",M$a);for(var M$c=0,M$d=M$b.length;M$c<M$d;M$c++){M$b[M$c].exe(this)}}},M$o._regs=function(){for(var M$a in M$o.uiClassMap)M$q.regClass(M$a,M$o.uiClassMap[M$a])},M$o.createComp=function(M$a,M$b,M$c,M$d){if(!(M$b=M$b||M$o.getCompInstance(M$a)))return console.warn("can not create:"+M$a.type),null;var M$e=M$a.child;if(M$e)for(var M$f=M$b instanceof laya.ui.List,M$g=0,M$h=M$e.length;M$g<M$h;M$g++){var M$i=M$e[M$g];if(!M$b.hasOwnProperty("itemRender")||"render"!=M$i.props.name&&"render"!==M$i.props.renderType)if("Graphic"==M$i.type)M$q.addGraphicsToSprite(M$i,M$b);else if(M$q.isDrawType(M$i.type))M$q.addGraphicToSprite(M$i,M$b,!0);else{if(M$f){var M$j=[],M$k=M$o.createComp(M$i,null,M$c,M$j);M$j.length&&(M$k._$bindData=M$j)}else M$k=M$o.createComp(M$i,null,M$c,M$d);"Script"==M$i.type?"owner"in M$k?M$k.owner=M$b:"target"in M$k&&(M$k.target=M$b):"mask"==M$i.props.renderType||"mask"==M$i.props.name?M$b.mask=M$k:M$k instanceof laya.display.Sprite&&M$b.addChild(M$k)}else M$b.itemRender=M$i}var M$l=M$a.props;for(var M$m in M$l){var M$n=M$l[M$m];M$o.eventDic[M$m]?M$n&&M$c&&M$b.on(M$m,M$c,M$c.onEvent,[M$n]):M$o.setCompValue(M$b,M$m,M$n,M$c,M$d)}return M$p.__typeof(M$b,"laya.ui.IItem")&&M$b.initItems(),M$a.compId&&M$c&&M$c._idMap&&(M$c._idMap[M$a.compId]=M$b),M$b},M$o.setCompValue=function(M$a,M$b,M$c,M$d,M$e){if("string"==typeof M$c&&-1<M$c.indexOf("${")){if(M$o._sheet||(M$o._sheet=M$q.getClass("laya.data.Table")),!M$o._sheet)return void console.warn("Can not find class Sheet");if(M$e)M$e.push(M$a,M$b,M$c);else if(M$d){-1==M$c.indexOf("].")&&(M$c=M$c.replace(".","[0]."));var M$f,M$g,M$h=new M$n(M$a,M$b,M$c);M$h.exe(M$d);for(var M$i=M$c.replace(/\[.*?\]\./g,".");null!=(M$f=M$o._parseWatchData.exec(M$i));){for(var M$j=M$f[1];null!=(M$g=M$o._parseKeyWord.exec(M$j));){var M$k=M$g[0],M$l=M$d._watchMap[M$k]||(M$d._watchMap[M$k]=[]);M$l.push(M$h),M$o._sheet.I.notifer.on(M$k,M$d,M$d.changeData,[M$k])}(M$l=M$d._watchMap[M$j]||(M$d._watchMap[M$j]=[])).push(M$h),M$o._sheet.I.notifer.on(M$j,M$d,M$d.changeData,[M$j])}}}else if("var"===M$b&&M$d)M$d[M$c]=M$a;else if("onClick"==M$b){var M$m=M$p._runScript("(function(){"+M$c+"})");M$a.on("click",M$d,M$m)}else M$a[M$b]="true"===M$c||"false"!==M$c&&M$c},M$o.getCompInstance=function(M$a){var M$b,M$c=M$a.props?M$a.props.runtime:null;return M$b=M$c?M$o.viewClassMap[M$c]||M$o.uiClassMap[M$c]||M$p.__classmap[M$c]:M$o.uiClassMap[M$a.type],M$a.props&&M$a.props.hasOwnProperty("renderType")&&"instance"==M$a.props.renderType?M$b.instance:M$b?new M$b:null},M$o.regComponent=function(M$a,M$b){M$o.uiClassMap[M$a]=M$b,M$q.regClass(M$a,M$b)},M$o.regViewRuntime=function(M$a,M$b){M$o.viewClassMap[M$a]=M$b},M$o.uiMap={},M$o.viewClassMap={},M$o._sheet=null,M$d(M$o,["uiClassMap",function(){return this.uiClassMap={ViewStack:M$aa,LinkButton:M$K,TextArea:M$ja,ColorPicker:M$M,Box:M$J,Button:M$K,CheckBox:M$U,Clip:M$L,ComboBox:M$N,Component:M$H,HScrollBar:M$Y,HSlider:M$$,Image:M$Q,Label:M$R,List:M$X,Panel:M$Z,ProgressBar:M$S,Radio:M$y,RadioGroup:M$ha,ScrollBar:M$O,Slider:M$P,Tab:M$ia,TextInput:M$ca,View:M$o,VScrollBar:M$ba,VSlider:M$da,Tree:M$z,HBox:M$fa,VBox:M$ga,Sprite:M$u,Animation:M$c,Text:M$v,FontClip:M$W}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),M$o.__init$=function(){M$o._regs(),M$n=function(){function M$a(M$a,M$b,M$c){this.comp=null,this.prop=null,this.value=null,this.comp=M$a,this.prop=M$b,this.value=M$c}return M$f(M$a,""),M$a.prototype.exe=function(M$a){var M$b=M$E.getBindFun(this.value);this.comp[this.prop]=M$b.call(this,M$a)},M$a}()},M$o}()),M$U=function(M$a){function M$c(M$a,M$b){void 0===M$b&&(M$b=""),M$c.__super.call(this,M$a,M$b)}M$f(M$c,"laya.ui.CheckBox",M$a);var M$b=M$c.prototype;return M$b.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},M$b.initialize=function(){M$a.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},M$e(0,M$b,"dataSource",M$a.prototype._$get_dataSource,function(M$a){"boolean"==typeof(this._dataSource=M$a)?this.selected=M$a:"string"==typeof M$a?this.selected="true"===M$a:M$p.superSet(M$K,this,"dataSource",M$a)}),M$c}(M$K),M$V=function(M$a){function M$b(){this._space=0,this._align="none",this._itemChanged=!1,M$b.__super.call(this)}M$f(M$b,"laya.ui.LayoutBox",M$J);var M$c=M$b.prototype;return M$c.addChild=function(M$a){return M$a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,M$a)},M$c.onResize=function(M$a){this._setItemChanged()},M$c.addChildAt=function(M$a,M$b){return M$a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,M$a,M$b)},M$c.removeChild=function(M$a){return M$a.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,M$a)},M$c.removeChildAt=function(M$a){return this.getChildAt(M$a).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,M$a)},M$c.refresh=function(){this._setItemChanged()},M$c.changeItems=function(){this._itemChanged=!1},M$c.sortItem=function(M$a){M$a&&M$a.sort(function(M$a,M$b){return M$a.y-M$b.y})},M$c._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},M$e(0,M$c,"space",function(){return this._space},function(M$a){this._space=M$a,this._setItemChanged()}),M$e(0,M$c,"align",function(){return this._align},function(M$a){this._align=M$a,this._setItemChanged()}),M$b}(),M$W=function(M$b){function M$c(M$a,M$b){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,M$c.__super.call(this),M$a&&(this.skin=M$a),M$b&&(this.sheet=M$b)}M$f(M$c,"laya.ui.FontClip",M$b);var M$a=M$c.prototype;return M$a.createChildren=function(){this._bitmap=new M$G,this.on("loaded",this,this._onClipLoaded)},M$a._onClipLoaded=function(){this.callLater(this.changeValue)},M$a.changeValue=function(){var M$a;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),M$a=this._sources[0]))){var M$b="horizontal"===this._direction;M$b?(this._wordsW=this._valueArr.length*(M$a.sourceWidth+this.spaceX),this._wordsH=M$a.sourceHeight):(this._wordsW=M$a.sourceWidth,this._wordsH=(M$a.sourceHeight+this.spaceY)*this._valueArr.length);var M$c=0;if(this._width)switch(this._align){case"center":M$c=.5*(this._width-this._wordsW);break;case"right":M$c=this._width-this._wordsW;break;default:M$c=0}for(var M$d=0,M$e=this._valueArr.length;M$d<M$e;M$d++){var M$f=this._indexMap[this._valueArr.charAt(M$d)];this.sources[M$f]&&(M$a=this.sources[M$f],M$b?this.graphics.drawTexture(M$a,M$c+M$d*(M$a.sourceWidth+this.spaceX),0,M$a.sourceWidth,M$a.sourceHeight):this.graphics.drawTexture(M$a,0+M$c,M$d*(M$a.sourceHeight+this.spaceY),M$a.sourceWidth,M$a.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),M$b.prototype.destroy.call(this,M$a)},M$e(0,M$a,"sheet",function(){return this._sheet},function(M$a){M$a+="";var M$b=(this._sheet=M$a).split(" ");this._clipX=String(M$b[0]).length,this.clipY=M$b.length,this._indexMap={};for(var M$c=0;M$c<this._clipY;M$c++)for(var M$d=M$b[M$c].split(""),M$e=0,M$f=M$d.length;M$e<M$f;M$e++)this._indexMap[M$d[M$e]]=M$c*this._clipX+M$e}),M$e(0,M$a,"height",M$b.prototype._$get_height,function(M$a){M$p.superSet(M$L,this,"height",M$a),this.callLater(this.changeValue)}),M$e(0,M$a,"direction",function(){return this._direction},function(M$a){this._direction=M$a,this.callLater(this.changeValue)}),M$e(0,M$a,"value",function(){return this._valueArr?this._valueArr:""},function(M$a){M$a+="",this._valueArr=M$a,this.callLater(this.changeValue)}),M$e(0,M$a,"width",M$b.prototype._$get_width,function(M$a){M$p.superSet(M$L,this,"width",M$a),this.callLater(this.changeValue)}),M$e(0,M$a,"spaceX",function(){return this._spaceX},function(M$a){this._spaceX=M$a,"horizontal"===this._direction&&this.callLater(this.changeValue)}),M$e(0,M$a,"spaceY",function(){return this._spaceY},function(M$a){this._spaceY=M$a,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),M$e(0,M$a,"align",function(){return this._align},function(M$a){this._align=M$a,this.callLater(this.changeValue)}),M$e(0,M$a,"measureWidth",function(){return this._wordsW}),M$e(0,M$a,"measureHeight",function(){return this._wordsH}),M$c}(M$L),M$X=function(M$a){function M$b(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new M$o,M$b.__super.call(this)}M$f(M$b,"laya.ui.List",M$a);var M$c=M$b.prototype;return M$p.imps(M$c,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),M$c.destroy=function(M$a){void 0===M$a&&(M$a=!0),this._content&&this._content.destroy(M$a),this._scrollBar&&this._scrollBar.destroy(M$a),laya.ui.Component.prototype.destroy.call(this,M$a),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},M$c.createChildren=function(){this.addChild(this._content=new M$J)},M$c.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=M$p.superGet(M$J,this,"cacheAs")),M$p.superSet(M$J,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},M$c.onScrollEnd=function(){M$p.superSet(M$J,this,"cacheAs",this._$P.cacheAs)},M$c._removePreScrollBar=function(){var M$a=this.removeChildByName("scrollBar");M$a&&M$a.destroy(!0)},M$c.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var M$a=this._getOneCell(),M$b=M$a.width+this._spaceX||1,M$c=M$a.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/M$b):Math.ceil(this._width/M$b)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/M$c):Math.round(this._height/M$c));var M$d=this._width?this._width:M$b*this.repeatX-this._spaceX,M$e=this._height?this._height:M$c*this.repeatY-this._spaceY;this._cellSize=this._isVertical?M$c:M$b,this._cellOffset=this._isVertical?M$c*Math.max(this._repeatY2,this._repeatY)-M$e-this._spaceY:M$b*Math.max(this._repeatX2,this._repeatX)-M$d-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=M$e:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=M$d),this.setContentSize(M$d,M$e);var M$f=this._isVertical?this.repeatX:this.repeatY,M$g=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,M$f,M$g),this._createdLine=M$g,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},M$c._getOneCell=function(){if(0===this._cells.length){var M$a=this.createItem();if(this._offset.setTo(M$a.x,M$a.y),this.cacheContent)return M$a;this._cells.push(M$a)}return this._cells[0]},M$c._createItems=function(M$a,M$b,M$c){var M$d=this._content,M$e=this._getOneCell(),M$f=M$e.width+this._spaceX,M$g=M$e.height+this._spaceY;if(this.cacheContent){var M$h=new M$J;M$h.cacheAsBitmap=!0,M$h.pos((this._isVertical?0:M$a)*M$f,(this._isVertical?M$a:0)*M$g),this._content.addChild(M$h),this._content.optimizeScrollRect=!0,M$d=M$h}else{for(var M$i=[],M$j=this._cells.length-1;-1<M$j;M$j--){var M$k=this._cells[M$j];M$k.removeSelf(),M$i.push(M$k)}this._cells.length=0}for(var M$l=M$a;M$l<M$c;M$l++)for(var M$m=0;M$m<M$b;M$m++)(M$e=M$i&&M$i.length?M$i.pop():this.createItem()).x=(this._isVertical?M$m:M$l)*M$f-M$d.x,M$e.y=(this._isVertical?M$l:M$m)*M$g-M$d.y,M$e.name="item"+(M$l*M$b+M$m),M$d.addChild(M$e),this.addCell(M$e)},M$c.createItem=function(){var M$a=[];if("function"==typeof this._itemRender)var M$b=new this._itemRender;else M$b=M$T.createComp(this._itemRender,null,null,M$a);if(0==M$a.length&&M$b._watchMap){var M$c=M$b._watchMap;for(var M$d in M$c)for(var M$e=M$c[M$d],M$f=0;M$f<M$e.length;M$f++){var M$g=M$e[M$f];M$a.push(M$g.comp,M$g.prop,M$g.value)}}return M$a.length&&(M$b._$bindData=M$a),M$b},M$c.addCell=function(M$a){M$a.on("click",this,this.onCellMouse),M$a.on("rightclick",this,this.onCellMouse),M$a.on("mouseover",this,this.onCellMouse),M$a.on("mouseout",this,this.onCellMouse),M$a.on("mousedown",this,this.onCellMouse),M$a.on("mouseup",this,this.onCellMouse),this._cells.push(M$a)},M$c.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var M$a=0,M$b=M$a=0;M$b<1e4;M$b++){var M$c=this.getChildByName("item"+M$b);if(!M$c)break;this.addCell(M$c),M$a++}this.repeatY=M$a}},M$c.setContentSize=function(M$a,M$b){this._content.width=M$a,this._content.height=M$b,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new M$r),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,M$a,M$b),this._content.scrollRect=this._content.scrollRect),this.event("resize")},M$c.onCellMouse=function(M$a){"mousedown"===M$a.type&&(this._isMoved=!1);var M$b=M$a.currentTarget,M$c=this._startIndex+this._cells.indexOf(M$b);M$c<0||("click"===M$a.type||"rightclick"===M$a.type?this.selectEnable&&!this._isMoved?this.selectedIndex=M$c:this.changeCellState(M$b,!0,0):"mouseover"!==M$a.type&&"mouseout"!==M$a.type||this._selectedIndex===M$c||this.changeCellState(M$b,"mouseover"===M$a.type,0),this.mouseHandler&&this.mouseHandler.runWith([M$a,M$c]))},M$c.changeCellState=function(M$a,M$b,M$c){var M$d=M$a.getChildByName("selectBox");M$d&&(this.selectEnable=!0,M$d.visible=M$b,M$d.index=M$c)},M$c.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},M$c.onScrollBarChange=function(M$a){this.runCallLater(this.changeCells);var M$b=this._scrollBar.value,M$c=this._isVertical?this.repeatX:this.repeatY,M$d=this._isVertical?this.repeatY:this.repeatX,M$e=Math.floor(M$b/this._cellSize);if(this.cacheContent)M$g=M$d+1,this._createdLine-M$e<M$g&&(this._createItems(this._createdLine,M$c,this._createdLine+M$g),this.renderItems(this._createdLine*M$c,0),this._createdLine+=M$g);else{var M$f=M$e*M$c,M$g=0;if(M$f>this._startIndex){M$g=M$f-this._startIndex;var M$h=!0,M$i=this._startIndex+M$c*(M$d+1);this._isMoved=!0}else M$f<this._startIndex&&(M$g=this._startIndex-M$f,M$h=!1,M$i=this._startIndex-1,this._isMoved=!0);for(var M$j=0;M$j<M$g;M$j++){if(M$h){var M$k=this._cells.shift();this._cells[this._cells.length]=M$k;var M$l=M$i+M$j}else M$k=this._cells.pop(),this._cells.unshift(M$k),M$l=M$i-M$j;var M$m=Math.floor(M$l/M$c)*this._cellSize;this._isVertical?M$k.y=M$m:M$k.x=M$m,this.renderItem(M$k,M$l)}this._startIndex=M$f,this.changeSelectStatus()}var M$n=this._content.scrollRect;this._isVertical?(M$n.y=M$b-this._offset.y,M$n.x=-this._offset.x):(M$n.y=-this._offset.y,M$n.x=M$b-this._offset.x),this._content.scrollRect=M$n},M$c.posCell=function(M$a,M$b){if(this._scrollBar){var M$c=this._isVertical?this.repeatX:this.repeatY,M$d=(this._isVertical?this.repeatY:this.repeatX,Math.floor(M$b/M$c)*this._cellSize);this._isVertical?M$a.y=M$d:M$a.x=M$d}},M$c.changeSelectStatus=function(){for(var M$a=0,M$b=this._cells.length;M$a<M$b;M$a++)this.changeCellState(this._cells[M$a],this._selectedIndex===this._startIndex+M$a,1)},M$c.renderItems=function(M$a,M$b){void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0);for(var M$c=M$a,M$d=M$b||this._cells.length;M$c<M$d;M$c++)this.renderItem(this._cells[M$c],this._startIndex+M$c);this.changeSelectStatus()},M$c.renderItem=function(M$a,M$b){this._array&&0<=M$b&&M$b<this._array.length?(M$a.visible=!0,M$a._$bindData?(M$a._dataSource=this._array[M$b],this._bindData(M$a,this._array[M$b])):M$a.dataSource=this._array[M$b],this.cacheContent||this.posCell(M$a,M$b),this.hasListener("render")&&this.event("render",[M$a,M$b]),this.renderHandler&&this.renderHandler.runWith([M$a,M$b])):(M$a.visible=!1,M$a.dataSource=null)},M$c._bindData=function(M$a,M$b){for(var M$c=M$a._$bindData,M$d=0,M$e=M$c.length;M$d<M$e;M$d++){var M$f=M$c[M$d++],M$g=M$c[M$d++],M$h=M$c[M$d],M$i=M$E.getBindFun(M$h);M$f[M$g]=M$i.call(this,M$b)}},M$c.refresh=function(){this.array=this._array},M$c.getItem=function(M$a){return-1<M$a&&M$a<this._array.length?this._array[M$a]:null},M$c.changeItem=function(M$a,M$b){-1<M$a&&M$a<this._array.length&&(this._array[M$a]=M$b,M$a>=this._startIndex&&M$a<this._startIndex+this._cells.length&&this.renderItem(this.getCell(M$a),M$a))},M$c.setItem=function(M$a,M$b){this.changeItem(M$a,M$b)},M$c.addItem=function(M$a){this._array.push(M$a),this.array=this._array},M$c.addItemAt=function(M$a,M$b){this._array.splice(M$b,0,M$a),this.array=this._array},M$c.deleteItem=function(M$a){this._array.splice(M$a,1),this.array=this._array},M$c.getCell=function(M$a){return this.runCallLater(this.changeCells),-1<M$a&&this._cells?this._cells[(M$a-this._startIndex)%this._cells.length]:null},M$c.scrollTo=function(M$a){if(this._scrollBar){var M$b=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(M$a/M$b)*this._cellSize}else this.startIndex=M$a},M$c.tweenTo=function(M$a,M$b,M$c){if(void 0===M$b&&(M$b=200),this._scrollBar){var M$d=this._isVertical?this.repeatX:this.repeatY;M$x.to(this._scrollBar,{value:Math.floor(M$a/M$d)*this._cellSize},M$b,null,M$c,0,!0)}else this.startIndex=M$a,M$c&&M$c.run()},M$c._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},M$c.commitMeasure=function(){this.runCallLater(this.changeCells)},M$e(0,M$c,"cacheAs",M$a.prototype._$get_cacheAs,function(M$a){M$p.superSet(M$J,this,"cacheAs",M$a),this._scrollBar&&(this._$P.cacheAs=null,"none"!==M$a?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),M$e(0,M$c,"content",function(){return this._content}),M$e(0,M$c,"height",M$a.prototype._$get_height,function(M$a){M$a!=this._height&&(M$p.superSet(M$J,this,"height",M$a),this._setCellChanged())}),M$e(0,M$c,"itemRender",function(){return this._itemRender},function(M$a){if(this._itemRender!=M$a){this._itemRender=M$a;for(var M$b=this._cells.length-1;-1<M$b;M$b--)this._cells[M$b].destroy();this._cells.length=0,this._setCellChanged()}}),M$e(0,M$c,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(M$a){this._removePreScrollBar();var M$b=new M$ba;M$b.name="scrollBar",M$b.right=0,M$a&&" "!=M$a&&(M$b.skin=M$a),this.scrollBar=M$b,this.addChild(M$b),this._setCellChanged()}),M$e(0,M$c,"page",function(){return this._page},function(M$a){this._page=M$a,this._array&&(this._page=0<M$a?M$a:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),M$e(0,M$c,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(M$a){this._removePreScrollBar();var M$b=new M$Y;M$b.name="scrollBar",M$b.bottom=0,M$a&&" "!=M$a&&(M$b.skin=M$a),this.scrollBar=M$b,this.addChild(M$b),this._setCellChanged()}),M$e(0,M$c,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(M$a){this._repeatX=M$a,this._setCellChanged()}),M$e(0,M$c,"scrollBar",function(){return this._scrollBar},function(M$a){this._scrollBar!=M$a&&(this._scrollBar=M$a)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),M$e(0,M$c,"width",M$a.prototype._$get_width,function(M$a){M$a!=this._width&&(M$p.superSet(M$J,this,"width",M$a),this._setCellChanged())}),M$e(0,M$c,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(M$a){this._repeatY=M$a,this._setCellChanged()}),M$e(0,M$c,"spaceX",function(){return this._spaceX},function(M$a){this._spaceX=M$a,this._setCellChanged()}),M$e(0,M$c,"spaceY",function(){return this._spaceY},function(M$a){this._spaceY=M$a,this._setCellChanged()}),M$e(0,M$c,"selectedIndex",function(){return this._selectedIndex},function(M$a){this._selectedIndex!=M$a&&(this._selectedIndex=M$a,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(M$a),this.startIndex=this._startIndex)}),M$e(0,M$c,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(M$a){this.selectedIndex=this._array.indexOf(M$a)}),M$e(0,M$c,"length",function(){return this._array?this._array.length:0}),M$e(0,M$c,"selection",function(){return this.getCell(this._selectedIndex)},function(M$a){this.selectedIndex=this._startIndex+this._cells.indexOf(M$a)}),M$e(0,M$c,"startIndex",function(){return this._startIndex},function(M$a){this._startIndex=0<M$a?M$a:0,this.callLater(this.renderItems)}),M$e(0,M$c,"array",function(){return this._array},function(M$a){this.runCallLater(this.changeCells),this._array=M$a||[];var M$b=this._array.length;if(this.totalPage=Math.ceil(M$b/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<M$b?this._selectedIndex:M$b-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var M$c=this._isVertical?this.repeatX:this.repeatY,M$d=this._isVertical?this.repeatY:this.repeatX,M$e=Math.ceil(M$b/M$c);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=M$d/M$e,this._scrollBar.setScroll(0,(M$e-M$d)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),M$e(0,M$c,"dataSource",M$a.prototype._$get_dataSource,function(M$a){"number"==typeof(this._dataSource=M$a)&&Math.floor(M$a)==M$a||"string"==typeof M$a?this.selectedIndex=parseInt(M$a):M$a instanceof Array?this.array=M$a:M$p.superSet(M$J,this,"dataSource",M$a)}),M$e(0,M$c,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),M$b}(M$J),M$Y=function(M$a){function M$b(){M$b.__super.call(this)}return M$f(M$b,"laya.ui.HScrollBar",M$a),M$b.prototype.initialize=function(){M$a.prototype.initialize.call(this),this.slider.isVertical=!1},M$b}(M$O),M$Z=function(M$a){function M$b(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,M$b.__super.call(this),this.width=this.height=100}M$f(M$b,"laya.ui.Panel",M$a);var M$c=M$b.prototype;return M$c.destroy=function(M$a){void 0===M$a&&(M$a=!0),laya.ui.Component.prototype.destroy.call(this,M$a),this._content&&this._content.destroy(M$a),this._vScrollBar&&this._vScrollBar.destroy(M$a),this._hScrollBar&&this._hScrollBar.destroy(M$a),this._vScrollBar=null,this._hScrollBar=null,this._content=null},M$c.destroyChildren=function(){this._content.destroyChildren()},M$c.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new M$J)},M$c.addChild=function(M$a){return M$a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(M$a)},M$c.onResize=function(){this._setScrollChanged()},M$c.addChildAt=function(M$a,M$b){return M$a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(M$a,M$b)},M$c.removeChild=function(M$a){return M$a.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(M$a)},M$c.removeChildAt=function(M$a){return this.getChildAt(M$a).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(M$a)},M$c.removeChildren=function(M$a,M$b){return void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=2147483647),this._content.removeChildren(M$a,M$b),this._setScrollChanged(),this},M$c.getChildAt=function(M$a){return this._content.getChildAt(M$a)},M$c.getChildByName=function(M$a){return this._content.getChildByName(M$a)},M$c.getChildIndex=function(M$a){return this._content.getChildIndex(M$a)},M$c.changeScroll=function(){this._scrollChanged=!1;var M$a=this.contentWidth||1,M$b=this.contentHeight||1,M$c=this._vScrollBar,M$d=this._hScrollBar,M$e=M$c&&M$b>this._height,M$f=M$d&&M$a>this._width,M$g=M$e?this._width-M$c.width:this._width,M$h=M$f?this._height-M$d.height:this._height;M$c&&(M$c.x=this._width-M$c.width,M$c.y=0,M$c.height=this._height-(M$f?M$d.height:0),M$c.scrollSize=Math.max(.033*this._height,1),M$c.thumbPercent=M$h/M$b,M$c.setScroll(0,M$b-M$h,M$c.value)),M$d&&(M$d.x=0,M$d.y=this._height-M$d.height,M$d.width=this._width-(M$e?M$c.width:0),M$d.scrollSize=Math.max(.033*this._width,1),M$d.thumbPercent=M$g/M$a,M$d.setScroll(0,M$a-M$g,M$d.value))},M$c.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},M$c.setContentSize=function(M$a,M$b){var M$c=this._content;M$c.width=M$a,M$c.height=M$b,M$c.scrollRect||(M$c.scrollRect=new M$r),M$c.scrollRect.setTo(0,0,M$a,M$b),M$c.scrollRect=M$c.scrollRect},M$c.onScrollBarChange=function(M$a){var M$b=this._content.scrollRect;if(M$b){var M$c=Math.round(M$a.value);M$a.isVertical?M$b.y=M$c:M$b.x=M$c,this._content.scrollRect=M$b}},M$c.scrollTo=function(M$a,M$b){void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),this.vScrollBar&&(this.vScrollBar.value=M$b),this.hScrollBar&&(this.hScrollBar.value=M$a)},M$c.refresh=function(){this.changeScroll()},M$c.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=M$p.superGet(M$J,this,"cacheAs")),M$p.superSet(M$J,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},M$c.onScrollEnd=function(){M$p.superSet(M$J,this,"cacheAs",this._$P.cacheAs)},M$c._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},M$e(0,M$c,"numChildren",function(){return this._content.numChildren}),M$e(0,M$c,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(M$a){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new M$Y),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=M$a}),M$e(0,M$c,"contentWidth",function(){for(var M$a=0,M$b=this._content.numChildren-1;-1<M$b;M$b--){var M$c=this._content.getChildAt(M$b);M$a=Math.max(M$c.x+M$c.width*M$c.scaleX,M$a)}return M$a}),M$e(0,M$c,"contentHeight",function(){for(var M$a=0,M$b=this._content.numChildren-1;-1<M$b;M$b--){var M$c=this._content.getChildAt(M$b);M$a=Math.max(M$c.y+M$c.height*M$c.scaleY,M$a)}return M$a}),M$e(0,M$c,"width",M$a.prototype._$get_width,function(M$a){M$p.superSet(M$J,this,"width",M$a),this._setScrollChanged()}),M$e(0,M$c,"hScrollBar",function(){return this._hScrollBar}),M$e(0,M$c,"content",function(){return this._content}),M$e(0,M$c,"height",M$a.prototype._$get_height,function(M$a){M$p.superSet(M$J,this,"height",M$a),this._setScrollChanged()}),M$e(0,M$c,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(M$a){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new M$ba),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=M$a}),M$e(0,M$c,"vScrollBar",function(){return this._vScrollBar}),M$e(0,M$c,"cacheAs",M$a.prototype._$get_cacheAs,function(M$a){M$p.superSet(M$J,this,"cacheAs",M$a),this._$P.cacheAs=null,"none"!==M$a?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),M$b}(M$J),M$$=function(M$a){function M$b(M$a){M$b.__super.call(this,M$a),this.isVertical=!1}return M$f(M$b,"laya.ui.HSlider",M$P),M$b}(),M$_=function(M$a){function M$c(M$a,M$b){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,M$c.__super.call(this),this.skin=M$b,this.labels=M$a}M$f(M$c,"laya.ui.UIGroup",M$a);var M$b=M$c.prototype;return M$p.imps(M$b,{"laya.ui.IItem":!0}),M$b.preinitialize=function(){this.mouseEnabled=!0},M$b.destroy=function(M$a){void 0===M$a&&(M$a=!0),laya.ui.Component.prototype.destroy.call(this,M$a),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},M$b.addItem=function(M$a,M$b){void 0===M$b&&(M$b=!0);var M$c=M$a,M$d=this._items.length;if(M$c.name="item"+M$d,this.addChild(M$c),this.initItems(),M$b&&0<M$d){var M$e=this._items[M$d-1];"horizontal"==this._direction?M$c.x=M$e.x+M$e.width+this._space:M$c.y=M$e.y+M$e.height+this._space}else M$b&&(M$c.x=0,M$c.y=0);return M$d},M$b.delItem=function(M$a,M$b){void 0===M$b&&(M$b=!0);var M$c=this._items.indexOf(M$a);if(-1!=M$c){var M$d=M$a;this.removeChild(M$d);for(var M$e=M$c+1,M$f=this._items.length;M$e<M$f;M$e++){var M$g=this._items[M$e];M$g.name="item"+(M$e-1),M$b&&("horizontal"==this._direction?M$g.x-=M$d.width+this._space:M$g.y-=M$d.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var M$h;M$h=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=M$h}}},M$b.initItems=function(){this._items||(this._items=[]);for(var M$a=this._items.length=0;M$a<1e4;M$a++){var M$b=this.getChildByName("item"+M$a);if(null==M$b)break;this._items.push(M$b),M$b.selected=M$a===this._selectedIndex,M$b.clickHandler=M$m.create(this,this.itemClick,[M$a],!1)}},M$b.itemClick=function(M$a){this.selectedIndex=M$a},M$b.setSelect=function(M$a,M$b){this._items&&-1<M$a&&M$a<this._items.length&&(this._items[M$a].selected=M$b)},M$b.createItem=function(M$a,M$b){return null},M$b.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var M$a=0,M$b=0,M$c=this._items.length;M$b<M$c;M$b++){var M$d=this._items[M$b];this._skin&&(M$d.skin=this._skin),this._labelColors&&(M$d.labelColors=this._labelColors),this._labelSize&&(M$d.labelSize=this._labelSize),this._labelStroke&&(M$d.labelStroke=this._labelStroke),this._labelStrokeColor&&(M$d.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(M$d.strokeColors=this._strokeColors),this._labelBold&&(M$d.labelBold=this._labelBold),this._labelPadding&&(M$d.labelPadding=this._labelPadding),this._labelAlign&&(M$d.labelAlign=this._labelAlign),this._stateNum&&(M$d.stateNum=this._stateNum),this._labelFont&&(M$d.labelFont=this._labelFont),"horizontal"===this._direction?(M$d.y=0,M$d.x=M$a,M$a+=M$d.width+this._space):(M$d.x=0,M$d.y=M$a,M$a+=M$d.height+this._space)}this.changeSize()},M$b.commitMeasure=function(){this.runCallLater(this.changeLabels)},M$b._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},M$e(0,M$b,"labelStrokeColor",function(){return this._labelStrokeColor},function(M$a){this._labelStrokeColor!=M$a&&(this._labelStrokeColor=M$a,this._setLabelChanged())}),M$e(0,M$b,"skin",function(){return this._skin},function(M$a){this._skin!=M$a&&(this._skin=M$a,this._setLabelChanged())}),M$e(0,M$b,"selectedIndex",function(){return this._selectedIndex},function(M$a){this._selectedIndex!=M$a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=M$a,this.setSelect(M$a,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),M$e(0,M$b,"labels",function(){return this._labels},function(M$a){if(this._labels!=M$a){if(this._labels=M$a,this.removeChildren(),this._setLabelChanged(),this._labels)for(var M$b=this._labels.split(","),M$c=0,M$d=M$b.length;M$c<M$d;M$c++){var M$e=this.createItem(this._skin,M$b[M$c]);M$e.name="item"+M$c,this.addChild(M$e)}this.initItems()}}),M$e(0,M$b,"strokeColors",function(){return this._strokeColors},function(M$a){this._strokeColors!=M$a&&(this._strokeColors=M$a,this._setLabelChanged())}),M$e(0,M$b,"labelColors",function(){return this._labelColors},function(M$a){this._labelColors!=M$a&&(this._labelColors=M$a,this._setLabelChanged())}),M$e(0,M$b,"labelStroke",function(){return this._labelStroke},function(M$a){this._labelStroke!=M$a&&(this._labelStroke=M$a,this._setLabelChanged())}),M$e(0,M$b,"labelSize",function(){return this._labelSize},function(M$a){this._labelSize!=M$a&&(this._labelSize=M$a,this._setLabelChanged())}),M$e(0,M$b,"stateNum",function(){return this._stateNum},function(M$a){this._stateNum!=M$a&&(this._stateNum=M$a,this._setLabelChanged())}),M$e(0,M$b,"labelBold",function(){return this._labelBold},function(M$a){this._labelBold!=M$a&&(this._labelBold=M$a,this._setLabelChanged())}),M$e(0,M$b,"labelFont",function(){return this._labelFont},function(M$a){this._labelFont!=M$a&&(this._labelFont=M$a,this._setLabelChanged())}),M$e(0,M$b,"labelPadding",function(){return this._labelPadding},function(M$a){this._labelPadding!=M$a&&(this._labelPadding=M$a,this._setLabelChanged())}),M$e(0,M$b,"direction",function(){return this._direction},function(M$a){this._direction=M$a,this._setLabelChanged()}),M$e(0,M$b,"space",function(){return this._space},function(M$a){this._space=M$a,this._setLabelChanged()}),M$e(0,M$b,"items",function(){return this._items}),M$e(0,M$b,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(M$a){this.selectedIndex=this._items.indexOf(M$a)}),M$e(0,M$b,"dataSource",M$a.prototype._$get_dataSource,function(M$a){"number"==typeof(this._dataSource=M$a)&&Math.floor(M$a)==M$a||"string"==typeof M$a?this.selectedIndex=parseInt(M$a):M$a instanceof Array?this.labels=M$a.join(","):M$p.superSet(M$J,this,"dataSource",M$a)}),M$c}(M$J),M$y=function(M$b){function M$c(M$a,M$b){this._value=null,void 0===M$b&&(M$b=""),M$c.__super.call(this,M$a,M$b)}M$f(M$c,"laya.ui.Radio",M$b);var M$a=M$c.prototype;return M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,M$a),this._value=null},M$a.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},M$a.initialize=function(){M$b.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},M$a.onClick=function(M$a){this.selected=!0},M$e(0,M$a,"value",function(){return null!=this._value?this._value:this.label},function(M$a){this._value=M$a}),M$c}(M$K),M$z=function(M$a){function M$b(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,M$b.__super.call(this),this.width=this.height=200}M$f(M$b,"laya.ui.Tree",M$a);var M$c=M$b.prototype;return M$p.imps(M$c,{"laya.ui.IRender":!0}),M$c.destroy=function(M$a){void 0===M$a&&(M$a=!0),laya.ui.Component.prototype.destroy.call(this,M$a),this._list&&this._list.destroy(M$a),this._list=null,this._source=null,this._renderHandler=null},M$c.createChildren=function(){this.addChild(this._list=new M$X),this._list.renderHandler=M$m.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},M$c.onListChange=function(M$a){this.event("change")},M$c.getArray=function(){var M$a,M$b=[];for(var M$c in this._source)M$a=this._source[M$c],this.getParentOpenStatus(M$a)&&(M$a.x=this._spaceLeft*this.getDepth(M$a),M$b.push(M$a));return M$b},M$c.getDepth=function(M$a,M$b){return void 0===M$b&&(M$b=0),null==M$a.nodeParent?M$b:this.getDepth(M$a.nodeParent,M$b+1)},M$c.getParentOpenStatus=function(M$a){var M$b=M$a.nodeParent;return null==M$b||!!M$b.isOpen&&(null==M$b.nodeParent||this.getParentOpenStatus(M$b))},M$c.renderItem=function(M$a,M$b){var M$c=M$a.dataSource;if(M$c){M$a.left=M$c.x;var M$d=M$a.getChildByName("arrow");M$d&&(M$c.hasChild?(M$d.visible=!0,M$d.index=M$c.isOpen?1:0,M$d.tag=M$b,M$d.off("click",this,this.onArrowClick),M$d.on("click",this,this.onArrowClick)):M$d.visible=!1);var M$e=M$a.getChildByName("folder");M$e&&(2==M$e.clipY?M$e.index=M$c.isDirectory?0:1:M$e.index=M$c.isDirectory?M$c.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([M$a,M$b])}},M$c.onArrowClick=function(M$a){var M$b=M$a.currentTarget.tag;this._list.array[M$b].isOpen=!this._list.array[M$b].isOpen,this.event("open"),this._list.array=this.getArray()},M$c.setItemState=function(M$a,M$b){this._list.array[M$a]&&(this._list.array[M$a].isOpen=M$b,this._list.array=this.getArray())},M$c.fresh=function(){this._list.array=this.getArray(),this.repaint()},M$c.parseXml=function(M$a,M$b,M$c,M$d){var M$e,M$f=M$a.childNodes,M$g=M$f.length;if(!M$d){M$e={};var M$h,M$i=M$a.attributes;for(var M$j in M$i){var M$k=(M$h=M$i[M$j]).nodeName,M$l=M$h.nodeValue;M$e[M$k]="true"==M$l||"false"!=M$l&&M$l}M$e.nodeParent=M$c,0<M$g&&(M$e.isDirectory=!0),M$e.hasChild=0<M$g,M$b.push(M$e)}for(var M$m=0;M$m<M$g;M$m++){var M$n=M$f[M$m];this.parseXml(M$n,M$b,M$e,!1)}},M$c.parseOpenStatus=function(M$a,M$b){for(var M$c=0,M$d=M$b.length;M$c<M$d;M$c++){var M$e=M$b[M$c];if(M$e.isDirectory)for(var M$f=0,M$g=M$a.length;M$f<M$g;M$f++){var M$h=M$a[M$f];if(M$h.isDirectory&&this.isSameParent(M$h,M$e)&&M$e.label==M$h.label){M$e.isOpen=M$h.isOpen;break}}}},M$c.isSameParent=function(M$a,M$b){return null==M$a.nodeParent&&null==M$b.nodeParent||null!=M$a.nodeParent&&null!=M$b.nodeParent&&(M$a.nodeParent.label==M$b.nodeParent.label&&this.isSameParent(M$a.nodeParent,M$b.nodeParent))},M$c.filter=function(M$a){if(Boolean(M$a)){var M$b=[];this.getFilterSource(this._source,M$b,M$a),this._list.array=M$b}else this._list.array=this.getArray()},M$c.getFilterSource=function(M$a,M$b,M$c){var M$d;for(var M$e in M$c=M$c.toLocaleLowerCase(),M$a)!(M$d=M$a[M$e]).isDirectory&&-1<String(M$d.label).toLowerCase().indexOf(M$c)&&(M$d.x=0,M$b.push(M$d)),M$d.child&&0<M$d.child.length&&this.getFilterSource(M$d.child,M$b,M$c)},M$e(0,M$c,"spaceBottom",function(){return this._list.spaceY},function(M$a){this._list.spaceY=M$a}),M$e(0,M$c,"keepStatus",function(){return this._keepStatus},function(M$a){this._keepStatus=M$a}),M$e(0,M$c,"itemRender",function(){return this._list.itemRender},function(M$a){this._list.itemRender=M$a}),M$e(0,M$c,"array",function(){return this._list.array},function(M$a){this._keepStatus&&this._list.array&&M$a&&this.parseOpenStatus(this._list.array,M$a),this._source=M$a,this._list.array=this.getArray()}),M$e(0,M$c,"mouseHandler",function(){return this._list.mouseHandler},function(M$a){this._list.mouseHandler=M$a}),M$e(0,M$c,"dataSource",M$a.prototype._$get_dataSource,function(M$a){this._dataSource=M$a,M$p.superSet(M$J,this,"dataSource",M$a)}),M$e(0,M$c,"source",function(){return this._source}),M$e(0,M$c,"scrollBar",function(){return this._list.scrollBar}),M$e(0,M$c,"list",function(){return this._list}),M$e(0,M$c,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(M$a){this._list.vScrollBarSkin=M$a}),M$e(0,M$c,"renderHandler",function(){return this._renderHandler},function(M$a){this._renderHandler=M$a}),M$e(0,M$c,"selectedIndex",function(){return this._list.selectedIndex},function(M$a){this._list.selectedIndex=M$a}),M$e(0,M$c,"spaceLeft",function(){return this._spaceLeft},function(M$a){this._spaceLeft=M$a}),M$e(0,M$c,"selectedItem",function(){return this._list.selectedItem},function(M$a){this._list.selectedItem=M$a}),M$e(0,M$c,"width",M$a.prototype._$get_width,function(M$a){M$p.superSet(M$J,this,"width",M$a),this._list.width=M$a}),M$e(0,M$c,"height",M$a.prototype._$get_height,function(M$a){M$p.superSet(M$J,this,"height",M$a),this._list.height=M$a}),M$e(0,M$c,"xml",null,function(M$a){var M$b=[];this.parseXml(M$a.childNodes[0],M$b,null,!0),this.array=M$b}),M$e(0,M$c,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),M$b}(M$J),M$aa=function(M$a){function M$b(){this._items=null,this._selectedIndex=0,M$b.__super.call(this),this._setIndexHandler=M$m.create(this,this.setIndex,null,!1)}M$f(M$b,"laya.ui.ViewStack",M$a);var M$c=M$b.prototype;return M$p.imps(M$c,{"laya.ui.IItem":!0}),M$c.setItems=function(M$a){this.removeChildren();for(var M$b=0,M$c=0,M$d=M$a.length;M$c<M$d;M$c++){var M$e=M$a[M$c];M$e&&(M$e.name="item"+M$b,this.addChild(M$e),M$b++)}this.initItems()},M$c.addItem=function(M$a){M$a.name="item"+this._items.length,this.addChild(M$a),this.initItems()},M$c.initItems=function(){this._items=[];for(var M$a=0;M$a<1e4;M$a++){var M$b=this.getChildByName("item"+M$a);if(null==M$b)break;this._items.push(M$b),M$b.visible=M$a==this._selectedIndex}},M$c.setSelect=function(M$a,M$b){this._items&&-1<M$a&&M$a<this._items.length&&(this._items[M$a].visible=M$b)},M$c.setIndex=function(M$a){this.selectedIndex=M$a},M$e(0,M$c,"dataSource",M$a.prototype._$get_dataSource,function(M$a){if("number"==typeof(this._dataSource=M$a)&&Math.floor(M$a)==M$a||"string"==typeof M$a)this.selectedIndex=parseInt(M$a);else for(var M$b in this._dataSource)this.hasOwnProperty(M$b)&&(this[M$b]=this._dataSource[M$b])}),M$e(0,M$c,"selectedIndex",function(){return this._selectedIndex},function(M$a){this._selectedIndex!=M$a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=M$a,this.setSelect(this._selectedIndex,!0))}),M$e(0,M$c,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(M$a){this.selectedIndex=this._items.indexOf(M$a)}),M$e(0,M$c,"items",function(){return this._items}),M$e(0,M$c,"setIndexHandler",function(){return this._setIndexHandler},function(M$a){this._setIndexHandler=M$a}),M$b}(M$J),M$ba=function(M$a){function M$b(){M$b.__super.call(this)}return M$f(M$b,"laya.ui.VScrollBar",M$O),M$b}(),M$ca=function(M$b){function M$c(M$a){this._bg=null,this._skin=null,M$c.__super.call(this),void 0===M$a&&(M$a=""),this.text=M$a,this.skin=this.skin}M$f(M$c,"laya.ui.TextInput",M$b);var M$a=M$c.prototype;return M$a.preinitialize=function(){this.mouseEnabled=!0},M$a.destroy=function(M$a){M$s.clearCache(this,this._skin),void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,M$a),this._bg&&this._bg.destroy(),this._bg=null},M$a.createChildren=function(){this.addChild(this._tf=new M$n),this._tf.padding=M$D.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},M$a._onFocus=function(){this.event("focus",this)},M$a._onBlur=function(){this.event("blur",this)},M$a._onInput=function(){this.event("input",this)},M$a._onEnter=function(){this.event("enter",this)},M$a.initialize=function(){this.width=128,this.height=22},M$a.select=function(){this._tf.select()},M$a.setSelection=function(M$a,M$b){this._tf.setSelection(M$a,M$b)},M$e(0,M$a,"text",M$b.prototype._$get_text,function(M$a){this._tf.text!=M$a&&(M$a+="",this._tf.text=M$a,this.event("change"))}),M$e(0,M$a,"bg",function(){return this._bg},function(M$a){this.graphics=this._bg=M$a}),M$e(0,M$a,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(M$a){this._tf.inputElementYAdjuster=M$a}),M$e(0,M$a,"multiline",function(){return this._tf.multiline},function(M$a){this._tf.multiline=M$a}),M$e(0,M$a,"skin",function(){return this._skin},function(M$a){this._skin!=M$a&&(M$s.clearCache(this,this._skin),this._skin=M$a,this._bg||(this.graphics=this._bg=new M$G),M$s.keepCache(this,this._skin),this._bg.source=M$s.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),M$e(0,M$a,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(M$a){this._bg||(this.graphics=this._bg=new M$G),this._bg.sizeGrid=M$E.fillArray(M$D.defaultSizeGrid,M$a,Number)}),M$e(0,M$a,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(M$a){this._tf.inputElementXAdjuster=M$a}),M$e(0,M$a,"width",M$b.prototype._$get_width,function(M$a){M$p.superSet(M$R,this,"width",M$a),this._bg&&(this._bg.width=M$a)}),M$e(0,M$a,"height",M$b.prototype._$get_height,function(M$a){M$p.superSet(M$R,this,"height",M$a),this._bg&&(this._bg.height=M$a)}),M$e(0,M$a,"editable",function(){return this._tf.editable},function(M$a){this._tf.editable=M$a}),M$e(0,M$a,"restrict",function(){return this._tf.restrict},function(M$a){this._tf.restrict=M$a}),M$e(0,M$a,"prompt",function(){return this._tf.prompt},function(M$a){this._tf.prompt=M$a}),M$e(0,M$a,"promptColor",function(){return this._tf.promptColor},function(M$a){this._tf.promptColor=M$a}),M$e(0,M$a,"maxChars",function(){return this._tf.maxChars},function(M$a){this._tf.maxChars=M$a}),M$e(0,M$a,"focus",function(){return this._tf.focus},function(M$a){this._tf.focus=M$a}),M$e(0,M$a,"type",function(){return this._tf.type},function(M$a){this._tf.type=M$a}),M$e(0,M$a,"asPassword",function(){return this._tf.asPassword},function(M$a){this._tf.asPassword=M$a}),M$c}(M$R),M$da=function(M$a){function M$b(){M$b.__super.call(this)}return M$f(M$b,"laya.ui.VSlider",M$P),M$b}(),M$ea=function(M$a){function M$d(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,M$d.__super.call(this)}M$f(M$d,"laya.ui.Dialog",M$a);var M$b=M$d.prototype;return M$b.initialize=function(){this.popupEffect=M$d.manager.popupEffectHandler,this.closeEffect=M$d.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},M$b._dealDragArea=function(){var M$a=this.getChildByName("drag");M$a&&(this.dragArea=M$a.x+","+M$a.y+","+M$a.width+","+M$a.height,M$a.removeSelf())},M$b._onClick=function(M$a){var M$b=M$a.target;if(M$b)switch(M$b.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(M$b.name)}},M$b.show=function(M$a,M$b){void 0===M$a&&(M$a=!1),void 0===M$b&&(M$b=!0),this._open(!1,M$a,M$b)},M$b.popup=function(M$a,M$b){void 0===M$a&&(M$a=!1),void 0===M$b&&(M$b=!0),this._open(!0,M$a,M$b)},M$b._open=function(M$a,M$b,M$c){M$d.manager.lock(!1),this.isModal=M$a,M$d.manager.open(this,M$b,M$c)},M$b.onOpened=function(){},M$b.close=function(M$a,M$b){void 0===M$b&&(M$b=!0),M$d.manager.close(this,M$a,M$b)},M$b.onClosed=function(M$a){},M$b._onMouseDown=function(M$a){var M$b=this.getMousePoint();this._dragArea.contains(M$b.x,M$b.y)?this.startDrag():this.stopDrag()},M$e(0,M$b,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(M$a){if(M$a){var M$b=M$E.fillArray([0,0,0,0],M$a,Number);this._dragArea=new M$r(M$b[0],M$b[1],M$b[2],M$b[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),M$e(0,M$b,"isPopup",function(){return null!=this.parent}),M$e(0,M$b,"zOrder",M$a.prototype._$get_zOrder,function(M$a){M$p.superSet(M$T,this,"zOrder",M$a),M$d.manager._checkMask()}),M$e(1,M$d,"manager",function(){return M$d._manager=M$d._manager||new M$I},function(M$a){M$d._manager=M$a}),M$d.setLockView=function(M$a){M$d.manager.setLockView(M$a)},M$d.lock=function(M$a){M$d.manager.lock(M$a)},M$d.closeAll=function(){M$d.manager.closeAll()},M$d.getDialogsByGroup=function(M$a){return M$d.manager.getDialogsByGroup(M$a)},M$d.closeByGroup=function(M$a){return M$d.manager.closeByGroup(M$a)},M$d.CLOSE="close",M$d.CANCEL="cancel",M$d.SURE="sure",M$d.NO="no",M$d.OK="ok",M$d.YES="yes",M$d._manager=null,M$d}(M$T),M$fa=function(M$a){function M$b(){M$b.__super.call(this)}M$f(M$b,"laya.ui.HBox",M$a);var M$c=M$b.prototype;return M$c.sortItem=function(M$a){M$a&&M$a.sort(function(M$a,M$b){return M$a.x-M$b.x})},M$c.changeItems=function(){this._itemChanged=!1;for(var M$a=[],M$b=0,M$c=0,M$d=this.numChildren;M$c<M$d;M$c++){var M$e=this.getChildAt(M$c);M$e&&M$e.layoutEnabled&&(M$a.push(M$e),M$b=this._height?this._height:Math.max(M$b,M$e.height*M$e.scaleY))}this.sortItem(M$a);var M$f=0;for(M$c=0,M$d=M$a.length;M$c<M$d;M$c++)(M$e=M$a[M$c]).x=M$f,M$f+=M$e.width*M$e.scaleX+this._space,"top"==this._align?M$e.y=0:"middle"==this._align?M$e.y=.5*(M$b-M$e.height*M$e.scaleY):"bottom"==this._align&&(M$e.y=M$b-M$e.height*M$e.scaleY);this.changeSize()},M$e(0,M$c,"height",M$a.prototype._$get_height,function(M$a){this._height!=M$a&&(M$p.superSet(M$V,this,"height",M$a),this.callLater(this.changeItems))}),M$b.NONE="none",M$b.TOP="top",M$b.MIDDLE="middle",M$b.BOTTOM="bottom",M$b}(M$V),M$ga=function(M$a){function M$b(){M$b.__super.call(this)}M$f(M$b,"laya.ui.VBox",M$a);var M$c=M$b.prototype;return M$c.changeItems=function(){this._itemChanged=!1;for(var M$a=[],M$b=0,M$c=0,M$d=this.numChildren;M$c<M$d;M$c++){var M$e=this.getChildAt(M$c);M$e&&M$e.layoutEnabled&&(M$a.push(M$e),M$b=this._width?this._width:Math.max(M$b,M$e.width*M$e.scaleX))}this.sortItem(M$a);var M$f=0;for(M$c=0,M$d=M$a.length;M$c<M$d;M$c++)(M$e=M$a[M$c]).y=M$f,M$f+=M$e.height*M$e.scaleY+this._space,"left"==this._align?M$e.x=0:"center"==this._align?M$e.x=.5*(M$b-M$e.width*M$e.scaleX):"right"==this._align&&(M$e.x=M$b-M$e.width*M$e.scaleX);this.changeSize()},M$e(0,M$c,"width",M$a.prototype._$get_width,function(M$a){this._width!=M$a&&(M$p.superSet(M$V,this,"width",M$a),this.callLater(this.changeItems))}),M$b.NONE="none",M$b.LEFT="left",M$b.CENTER="center",M$b.RIGHT="right",M$b}(M$V),M$ha=function(M$a){function M$b(){M$b.__super.call(this)}return M$f(M$b,"laya.ui.RadioGroup",M$_),M$b.prototype.createItem=function(M$a,M$b){return new M$y(M$a,M$b)},M$b}(),M$ia=function(M$a){function M$b(){M$b.__super.call(this)}return M$f(M$b,"laya.ui.Tab",M$_),M$b.prototype.createItem=function(M$a,M$b){return new M$K(M$a,M$b)},M$b}(),M$ja=function(M$b){function M$c(M$a){this._vScrollBar=null,this._hScrollBar=null,void 0===M$a&&(M$a=""),M$c.__super.call(this,M$a)}M$f(M$c,"laya.ui.TextArea",M$b);var M$a=M$c.prototype;return M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,M$a),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},M$a.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},M$a.onVBarChanged=function(M$a){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},M$a.onHBarChanged=function(M$a){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},M$a.changeScroll=function(){var M$a=this._vScrollBar&&0<this._tf.maxScrollY,M$b=this._hScrollBar&&0<this._tf.maxScrollX,M$c=M$a?this._width-this._vScrollBar.width:this._width,M$d=M$b?this._height-this._hScrollBar.height:this._height,M$e=this._tf.padding||M$D.labelPadding;this._tf.width=M$c,this._tf.height=M$d,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-M$e[2],this._vScrollBar.y=M$e[1],this._vScrollBar.height=this._height-(M$b?this._hScrollBar.height:0)-M$e[1]-M$e[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=M$d/Math.max(this._tf.textHeight,M$d),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=M$a),this._hScrollBar&&(this._hScrollBar.x=M$e[0],this._hScrollBar.y=this._height-this._hScrollBar.height-M$e[3],this._hScrollBar.width=this._width-(M$a?this._vScrollBar.width:0)-M$e[0]-M$e[2],this._hScrollBar.scrollSize=Math.max(.033*M$c,1),this._hScrollBar.thumbPercent=M$c/Math.max(this._tf.textWidth,M$c),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=M$b)},M$a.scrollTo=function(M$a){this.commitMeasure(),this._tf.scrollY=M$a},M$e(0,M$a,"scrollY",function(){return this._tf.scrollY}),M$e(0,M$a,"width",M$b.prototype._$get_width,function(M$a){M$p.superSet(M$ca,this,"width",M$a),this.callLater(this.changeScroll)}),M$e(0,M$a,"hScrollBar",function(){return this._hScrollBar}),M$e(0,M$a,"height",M$b.prototype._$get_height,function(M$a){M$p.superSet(M$ca,this,"height",M$a),this.callLater(this.changeScroll)}),M$e(0,M$a,"maxScrollX",function(){return this._tf.maxScrollX}),M$e(0,M$a,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(M$a){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new M$ba),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=M$a}),M$e(0,M$a,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(M$a){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new M$Y),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=M$a}),M$e(0,M$a,"vScrollBar",function(){return this._vScrollBar}),M$e(0,M$a,"maxScrollY",function(){return this._tf.maxScrollY}),M$e(0,M$a,"scrollX",function(){return this._tf.scrollX}),M$c}(M$ca);!function(M$a){function M$b(){this._uiView=null,this.isCloseOther=!1,M$b.__super.call(this)}M$f(M$b,"laya.ui.AsynDialog",M$ea);var M$c=M$b.prototype;M$c.createView=function(M$a){this._uiView=M$a},M$c._open=function(M$a,M$b,M$c){this.isModal=M$a,this.isCloseOther=M$b,M$ea.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},M$c.onCreated=function(){this.createUI(),this.onOpen()},M$c.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},M$c.onOpen=function(){M$ea.manager.open(this,this.isCloseOther),M$ea.manager.lock(!1)},M$c.close=function(M$a,M$b){void 0===M$b&&(M$b=!0),M$ea.manager.close(this),this.onClose()},M$c.onClose=function(){},M$c.destroy=function(M$a){void 0===M$a&&(M$a=!0),laya.ui.View.prototype.destroy.call(this,M$a),this._uiView=null,this.onDestroy()},M$c.onDestroy=function(){}}();M$p.__init([M$T])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(M$a,M$b){"use strict";for(var M$c in Object.defineProperty(M$b,"__esModule",{value:!0}),Laya){var M$d=Laya[M$c];M$d&&M$d.__isclass&&(M$b[M$c]=M$d)}}),function(M$m,M$a,M$v){M$v.un,M$v.uns;var M$l=M$v.static,M$n=M$v.class,M$o=M$v.getset,M$d=M$v.__newvec,M$u=laya.maths.Arith,M$g=laya.webgl.atlas.AtlasResourceManager,M$c=laya.webgl.shader.BaseShader,M$H=laya.utils.Browser,M$h=laya.webgl.utils.Buffer,M$w=laya.utils.Byte,M$e=laya.utils.ClassUtils,M$i=M$v.Config,M$f=(laya.events.Event,laya.events.EventDispatcher),M$D=laya.utils.Handler,M$r=laya.net.Loader,M$b=laya.net.LoaderManager,M$j=(laya.maths.MathUtil,laya.display.Node),M$p=laya.renders.Render,M$k=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),M$q=laya.resource.Resource,M$s=laya.utils.RunDriver,M$t=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),M$x=laya.display.Sprite,M$A=laya.utils.Stat,M$B=laya.utils.StringKey,M$E=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),M$C=laya.utils.Utils,M$F=laya.webgl.WebGL,M$G=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;M$v.interface("laya.d3.core.IClone"),M$v.interface("laya.d3.graphics.IVertex"),M$v.interface("laya.d3.core.render.IUpdate"),M$v.interface("laya.d3.core.scene.ITreeNode"),M$v.interface("laya.d3.core.render.IRenderable");(function(){function M$K(){}M$n(M$K,"laya.d3.animation.AnimationClipParser01"),M$K.READ_DATA=function(){M$K._DATA.offset=M$K._reader.getUint32(),M$K._DATA.size=M$K._reader.getUint32()},M$K.READ_BLOCK=function(){for(var M$a=M$K._BLOCK.count=M$K._reader.getUint16(),M$b=M$K._BLOCK.blockStarts=[],M$c=M$K._BLOCK.blockLengths=[],M$d=0;M$d<M$a;M$d++)M$b.push(M$K._reader.getUint32()),M$c.push(M$K._reader.getUint32())},M$K.READ_STRINGS=function(){var M$a=M$K._reader.getUint32(),M$b=M$K._reader.getUint16(),M$c=M$K._reader.pos;M$K._reader.pos=M$a+M$K._DATA.offset;for(var M$d=0;M$d<M$b;M$d++)M$K._strings[M$d]=M$K._reader.readUTFString();M$K._reader.pos=M$c},M$K.parse=function(M$a,M$b){M$K._animationClip=M$a;(M$K._reader=M$b).__getBuffer();M$K.READ_DATA(),M$K.READ_BLOCK(),M$K.READ_STRINGS();for(var M$c=0,M$d=M$K._BLOCK.count;M$c<M$d;M$c++){var M$e=M$b.getUint16(),M$f=M$K._strings[M$e],M$g=M$K["READ_"+M$f];if(null==M$g)throw new Error("model file err,no this function:"+M$e+" "+M$f);M$g.call()}},M$K.READ_ANIMATIONS=function(){var M$a,M$b=0,M$c=0,M$d=M$K._reader,M$e=M$d.__getBuffer(),M$f=[],M$g=M$d.getUint8();for(M$f.length=M$g,M$b=0;M$b<M$g;M$b++)M$f[M$b]=M$d.getUint16();var M$h=[],M$i=M$d.getUint16();for(M$h.length=M$i,M$b=0;M$b<M$i;M$b++)M$h[M$b]=M$d.getFloat32();var M$j=M$K._animationClip;M$j.name=M$K._strings[M$d.getUint16()];var M$k=M$j._duration=M$d.getFloat32();M$j.islooping=!!M$d.getByte(),M$j._frameRate=M$d.getInt16();var M$l=M$d.getInt16(),M$m=M$j._nodes=new Array;M$m.length=M$l,(M$j._publicClipDatas=[]).length=M$l;var M$n=M$j._nodesMap={},M$o=0,M$p=0;for(M$b=0;M$b<M$l;M$b++){M$a=M$m[M$b]=new M$S;var M$q=M$d.getUint16(),M$r=M$a.path=[];for(M$r.length=M$q,M$c=0;M$c<M$q;M$c++)M$r[M$c]=M$K._strings[M$d.getUint16()];var M$s=M$r.join("/"),M$t=M$n[M$s];M$t||(M$n[M$s]=M$t=[]),M$t.push(M$a);var M$u=M$d.getInt16();-1!==M$u&&(M$a.componentType=M$K._strings[M$u]);var M$v=M$Q._propertyIndexDic[M$K._strings[M$d.getUint16()]];if(null==M$v)throw new Error("AnimationClipParser01:unknown property name.");var M$w=M$v<4,M$x=!M$w||M$w&&""===M$r[0];(M$a._cacheProperty=M$x)?M$o++:M$p++,M$a.propertyNameID=M$v;var M$A=M$f[M$d.getUint8()];M$a.keyFrameWidth=M$A/4;var M$B=M$a.keyFrames=[],M$C=M$B.length=M$d.getUint16(),M$D=null,M$E=NaN;for(M$c=0;M$c<M$C;M$c++){var M$F=M$B[M$c]=new M$R;M$E=M$F.startTime=M$h[M$d.getUint16()];var M$G=M$d.pos;M$F.inTangent=new Float32Array(M$e.slice(M$G,M$G+M$A)),M$d.pos+=M$A,M$G=M$d.pos,M$F.outTangent=new Float32Array(M$e.slice(M$G,M$G+M$A)),M$d.pos+=M$A,M$G=M$d.pos,M$F.data=new Float32Array(M$e.slice(M$G,M$G+M$A)),M$d.pos+=M$A,M$D&&(M$D.next=M$F,M$D.duration=M$E-M$D.startTime),M$D=M$F}M$F.next=null,M$F.duration=M$k-M$E}var M$H=M$j._nodeToCachePropertyMap=new Int32Array(M$l),M$I=M$j._cachePropertyMap=new Int32Array(M$o),M$J=M$j._unCachePropertyMap=new Int32Array(M$p);for(M$o=M$p=0,M$b=0;M$b<M$l;M$b++)(M$a=M$m[M$b])._cacheProperty?(M$H[M$b]=M$o,M$I[M$o++]=M$b):M$J[M$p++]=M$b},M$K._animationClip=null,M$K._reader=null,M$K._strings=[],M$l(M$K,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function M$O(){}M$n(M$O,"laya.d3.animation.AnimationClipParser02"),M$O.READ_DATA=function(){M$O._DATA.offset=M$O._reader.getUint32(),M$O._DATA.size=M$O._reader.getUint32()},M$O.READ_BLOCK=function(){for(var M$a=M$O._BLOCK.count=M$O._reader.getUint16(),M$b=M$O._BLOCK.blockStarts=[],M$c=M$O._BLOCK.blockLengths=[],M$d=0;M$d<M$a;M$d++)M$b.push(M$O._reader.getUint32()),M$c.push(M$O._reader.getUint32())},M$O.READ_STRINGS=function(){var M$a=M$O._reader.getUint32(),M$b=M$O._reader.getUint16(),M$c=M$O._reader.pos;M$O._reader.pos=M$a+M$O._DATA.offset;for(var M$d=0;M$d<M$b;M$d++)M$O._strings[M$d]=M$O._reader.readUTFString();M$O._reader.pos=M$c},M$O.parse=function(M$a,M$b){M$O._animationClip=M$a;(M$O._reader=M$b).__getBuffer();M$O.READ_DATA(),M$O.READ_BLOCK(),M$O.READ_STRINGS();for(var M$c=0,M$d=M$O._BLOCK.count;M$c<M$d;M$c++){var M$e=M$b.getUint16(),M$f=M$O._strings[M$e],M$g=M$O["READ_"+M$f];if(null==M$g)throw new Error("model file err,no this function:"+M$e+" "+M$f);M$g.call()}},M$O.READ_ANIMATIONS=function(){var M$a,M$b=0,M$c=0,M$d=M$O._reader,M$e=M$d.__getBuffer(),M$f=[],M$g=M$d.getUint8();for(M$f.length=M$g,M$b=0;M$b<M$g;M$b++)M$f[M$b]=M$d.getUint16();var M$h=[],M$i=M$d.getUint16();for(M$h.length=M$i,M$b=0;M$b<M$i;M$b++)M$h[M$b]=M$d.getFloat32();var M$j=M$O._animationClip;M$j.name=M$O._strings[M$d.getUint16()];var M$k=M$j._duration=M$d.getFloat32();M$j.islooping=!!M$d.getByte(),M$j._frameRate=M$d.getInt16();var M$l=M$d.getInt16(),M$m=M$j._nodes=new Array;M$m.length=M$l,(M$j._publicClipDatas=[]).length=M$l;var M$n=M$j._nodesMap={},M$o=0,M$p=0;for(M$b=0;M$b<M$l;M$b++){M$a=M$m[M$b]=new M$S;var M$q=M$d.getUint16(),M$r=M$a.path=[];for(M$r.length=M$q,M$c=0;M$c<M$q;M$c++)M$r[M$c]=M$O._strings[M$d.getUint16()];var M$s=M$r.join("/"),M$t=M$n[M$s];M$t||(M$n[M$s]=M$t=[]),M$t.push(M$a);var M$u=M$d.getInt16();-1!==M$u&&(M$a.componentType=M$O._strings[M$u]);var M$v=M$Q._propertyIndexDic[M$O._strings[M$d.getUint16()]];if(null==M$v)throw new Error("AnimationClipParser02:unknown property name.");var M$w=M$v<4,M$x=!M$w||M$w&&""===M$r[0];(M$a._cacheProperty=M$x)?M$o++:M$p++,M$a.propertyNameID=M$v;var M$A=M$f[M$d.getUint8()];M$a.keyFrameWidth=M$A/4;var M$B=M$a.keyFrames=[],M$C=M$B.length=M$d.getUint16(),M$D=null,M$E=NaN;for(M$c=0;M$c<M$C;M$c++){var M$F=M$B[M$c]=new M$R;M$E=M$F.startTime=M$h[M$d.getUint16()];var M$G=M$d.pos;M$F.inTangent=new Float32Array(M$e.slice(M$G,M$G+M$A)),M$d.pos+=M$A,M$G=M$d.pos,M$F.outTangent=new Float32Array(M$e.slice(M$G,M$G+M$A)),M$d.pos+=M$A,M$G=M$d.pos,M$F.data=new Float32Array(M$e.slice(M$G,M$G+M$A)),M$d.pos+=M$A,M$D&&(M$D.next=M$F,M$D.duration=M$E-M$D.startTime),M$D=M$F}M$F.next=null,M$F.duration=M$k-M$E}var M$H=M$d.getUint16();for(M$b=0;M$b<M$H;M$b++){var M$I,M$J=new M$P;M$J.time=M$d.getFloat32(),M$J.eventName=M$O._strings[M$d.getUint16()];var M$K=M$d.getUint16();for(0<M$K&&(M$J.params=M$I=[]),M$c=0;M$c<M$K;M$c++){switch(M$d.getByte()){case 0:M$I.push(!!M$d.getByte());break;case 1:M$I.push(M$d.getInt32());break;case 2:M$I.push(M$d.getFloat32());break;case 3:M$I.push(M$O._strings[M$d.getUint16()]);break;default:throw new Error("unknown type.")}}M$j.addEvent(M$J)}var M$L=M$j._nodeToCachePropertyMap=new Int32Array(M$l),M$M=M$j._cachePropertyMap=new Int32Array(M$o),M$N=M$j._unCachePropertyMap=new Int32Array(M$p);for(M$o=M$p=0,M$b=0;M$b<M$l;M$b++)(M$a=M$m[M$b])._cacheProperty?(M$L[M$b]=M$o,M$M[M$o++]=M$b):M$N[M$p++]=M$b},M$O._animationClip=null,M$O._reader=null,M$O._strings=[],M$l(M$O,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var M$P=function(){function M$a(){this.time=NaN,this.eventName=null,this.params=null}return M$n(M$a,"laya.d3.animation.AnimationEvent"),M$a}(),M$Q=function(){function M$d(){this._childs=[],this.transform=new M$sb(this)}M$n(M$d,"laya.d3.animation.AnimationNode");var M$a=M$d.prototype;return M$v.imps(M$a,{"laya.d3.core.IClone":!0}),M$a.addChild=function(M$a){M$a._parent=this,M$a.transform.setParent(this.transform),this._childs.push(M$a)},M$a.removeChild=function(M$a){var M$b=this._childs.indexOf(M$a);-1!==M$b&&this._childs.splice(M$b,1)},M$a.getChildByName=function(M$a){for(var M$b=0,M$c=this._childs.length;M$b<M$c;M$b++){var M$d=this._childs[M$b];if(M$d.name===M$a)return M$d}return null},M$a.getChildByIndex=function(M$a){return this._childs[M$a]},M$a.getChildCount=function(){return this._childs.length},M$a.cloneTo=function(M$a){var M$b=M$a;M$b.name=this.name;for(var M$c=0,M$d=this._childs.length;M$c<M$d;M$c++){var M$e=this._childs[M$c],M$f=M$e.clone();M$b.addChild(M$f);var M$g=M$e.transform,M$h=M$f.transform;M$h.setLocalPosition(M$g.getLocalPosition()),M$h.setLocalRotation(M$g.getLocalRotation()),M$h.setLocalScale(M$g.getLocalScale()),M$h._localRotationEuler=M$g._localRotationEuler,M$h._setWorldMatrixIgnoreUpdate(M$g.getWorldMatrix())}},M$a.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$d.__init__=function(){M$d.registerAnimationNodeProperty("localPosition",M$d._getLocalPosition,M$d._setLocalPosition),M$d.registerAnimationNodeProperty("localRotation",M$d._getLocalRotation,M$d._setLocalRotation),M$d.registerAnimationNodeProperty("localScale",M$d._getLocalScale,M$d._setLocalScale),M$d.registerAnimationNodeProperty("localRotationEuler",M$d._getLocalRotationEuler,M$d._setLocalRotationEuler),M$d.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",M$d._getParticleRenderSharedMaterialTintColor,M$d._setParticleRenderSharedMaterialTintColor),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",M$d._getMeshRenderSharedMaterialTilingOffset,M$d._setMeshRenderSharedMaterialTilingOffset),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",M$d._getMeshRenderSharedMaterialAlbedo,M$d._setMeshRenderSharedMaterialAlbedo),M$d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",M$d._getSkinnedMeshRenderSharedMaterialTilingOffset,M$d._setSkinnedMeshRenderSharedMaterialTilingOffset),M$d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",M$d._getSkinnedMeshRenderSharedMaterialAlbedo,M$d._setSkinnedMeshRenderSharedMaterialAlbedo),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",M$d._getMeshRenderSharedMaterialAlbedo,M$d._setMeshRenderSharedMaterialAlbedo),M$d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",M$d._getSkinnedMeshRenderSharedMaterialAlbedo,M$d._setSkinnedMeshRenderSharedMaterialAlbedo),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",M$d._getMeshRenderSharedMaterialIntensity,M$d._setMeshRenderSharedMaterialIntensity),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",M$d._getMeshRenderSharedMaterialAlpha,M$d._setMeshRenderSharedMaterialAlpha),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",M$d._getMeshRenderSharedMaterialAlphaColor,M$d._setMeshRenderSharedMaterialAlphaColor),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",M$d._getMeshRenderSharedMaterialBaseColor,M$d._setMeshRenderSharedMaterialBaseColor),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",M$d._getMeshRenderSharedMaterialDissolve,M$d._setMeshRenderSharedMaterialDissolve),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",M$d._getMeshRenderSharedMaterialDissolveSpeed,M$d._setMeshRenderSharedMaterialDissolveSpeed),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",M$d._getMeshRenderSharedMaterialMMultiplier,M$d._setMeshRenderSharedMaterialMMultiplier),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",M$d._getMeshRenderSharedMaterialBaseScrollSpeedX,M$d._setMeshRenderSharedMaterialBaseScrollSpeedX),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",M$d._getMeshRenderSharedMaterialBaseScrollSpeedY,M$d._setMeshRenderSharedMaterialBaseScrollSpeedY),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",M$d._getMeshRenderSharedMaterialSecondScrollSpeedX,M$d._setMeshRenderSharedMaterialSecondScrollSpeedX),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",M$d._getMeshRenderSharedMaterialSecondScrollSpeedY,M$d._setMeshRenderSharedMaterialSecondScrollSpeedY),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",M$d._getMeshRenderSharedMaterialDetailTilingOffset,M$d._setMeshRenderSharedMaterialDetailTilingOffset),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",M$d._getMeshRenderSharedMaterialDissolveTilingOffset,M$d._setMeshRenderSharedMaterialDissolveTilingOffset),M$d.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",M$d._getMeshRenderSharedMaterialMaskTilingOffset,M$d._setMeshRenderSharedMaterialMaskTilingOffset)},M$d.registerAnimationNodeProperty=function(M$a,M$b,M$c){if(M$d._propertyIndexDic[M$a])throw new Error("AnimationNode: this propertyName has registered.");M$d._propertyIndexDic[M$a]=M$d._propertyIDCounter,M$d._propertyGetFuncs[M$d._propertyIDCounter]=M$b,M$d._propertySetFuncs[M$d._propertyIDCounter]=M$c,M$d._propertyIDCounter++},M$d._getLocalPosition=function(M$a,M$b){return M$a?M$a.transform.getLocalPosition():M$b._transform.localPosition.elements},M$d._setLocalPosition=function(M$a,M$b,M$c){if(M$a)M$a.transform.setLocalPosition(M$c);else{var M$d=M$b._transform,M$e=M$d.localPosition;M$e.elements=M$c,M$d.localPosition=M$e}},M$d._getLocalRotation=function(M$a,M$b){return M$a?M$a.transform.getLocalRotation():M$b._transform.localRotation.elements},M$d._setLocalRotation=function(M$a,M$b,M$c){if(M$a)M$a.transform.setLocalRotation(M$c);else{var M$d=M$b._transform,M$e=M$d.localRotation;M$e.elements=M$c,M$d.localRotation=M$e}},M$d._getLocalScale=function(M$a,M$b){return M$a?M$a.transform.getLocalScale():M$b._transform.localScale.elements},M$d._setLocalScale=function(M$a,M$b,M$c){if(M$a)M$a.transform.setLocalScale(M$c);else{var M$d=M$b._transform,M$e=M$d.localScale;M$e.elements=M$c,M$d.localScale=M$e}},M$d._getLocalRotationEuler=function(M$a,M$b){return M$a?M$a.transform.getLocalRotationEuler():M$b._transform.localRotationEuler.elements},M$d._setLocalRotationEuler=function(M$a,M$b,M$c){if(M$a)M$a.transform.setLocalRotationEuler(M$c);else{var M$d=M$b._transform,M$e=M$d.localRotationEuler;M$e.elements=M$c,M$d.localRotationEuler=M$e}},M$d._getMeshRenderSharedMaterialTilingOffset=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return M$b.meshRender.sharedMaterial.tilingOffset.elements},M$d._setMeshRenderSharedMaterialTilingOffset=function(M$a,M$b,M$c){var M$d,M$e;if(M$a){var M$f=M$a.transform._entity;M$f&&((M$e=(M$d=M$f.owner.meshRender.material).tilingOffset).elements=M$c,M$d.tilingOffset=M$e)}else(M$e=(M$d=M$b.meshRender.material).tilingOffset).elements=M$c,M$d.tilingOffset=M$e},M$d._getMeshRenderSharedMaterialAlbedo=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.albedoColor.elements:null}return M$b.meshRender.sharedMaterial.albedoColor.elements},M$d._setMeshRenderSharedMaterialAlbedo=function(M$a,M$b,M$c){var M$d,M$e;if(M$a){var M$f=M$a.transform._entity;M$f&&((M$e=(M$d=M$f.owner.meshRender.material).albedoColor).elements=M$c,M$d.albedoColor=M$e)}else(M$e=(M$d=M$b.meshRender.material).albedoColor).elements=M$c,M$d.albedoColor=M$e},M$d._getSkinnedMeshRenderSharedMaterialTilingOffset=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return M$b.skinnedMeshRender.sharedMaterial.tilingOffset.elements},M$d._setSkinnedMeshRenderSharedMaterialTilingOffset=function(M$a,M$b,M$c){var M$d,M$e;if(M$a){var M$f=M$a.transform._entity;M$f&&((M$e=(M$d=M$f.owner.skinnedMeshRender.material).tilingOffset).elements=M$c,M$d.tilingOffset=M$e)}else(M$e=(M$d=M$b.skinnedMeshRender.material).tilingOffset).elements=M$c,M$d.tilingOffset=M$e},M$d._getSkinnedMeshRenderSharedMaterialAlbedo=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return M$b.skinnedMeshRender.sharedMaterial.albedoColor.elements},M$d._setSkinnedMeshRenderSharedMaterialAlbedo=function(M$a,M$b,M$c){var M$d,M$e;if(M$a){var M$f=M$a.transform._entity;M$f&&((M$e=(M$d=M$f.owner.skinnedMeshRender.material).albedoColor).elements=M$c,M$d.albedoColor=M$e)}else(M$e=(M$d=M$b.skinnedMeshRender.material).albedoColor).elements=M$c,M$d.albedoColor=M$e},M$d._getParticleRenderSharedMaterialTintColor=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.particleRender.sharedMaterial.tintColor.elements:null}return M$b.particleRender.sharedMaterial.tintColor.elements},M$d._setParticleRenderSharedMaterialTintColor=function(M$a,M$b,M$c){var M$d,M$e;if(M$a){var M$f=M$a.transform._entity;M$f&&((M$e=(M$d=M$f.owner.particleRender.material).tintColor).elements=M$c,M$d.tintColor=M$e)}else(M$e=(M$d=M$b.particleRender.material).tintColor).elements=M$c,M$d.tintColor=M$e},M$d._getMeshRenderSharedMaterialAlphaColor=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.alphaColor.elements:null}return M$b.meshRender.sharedMaterial.alphaColor.elements},M$d._setMeshRenderSharedMaterialAlphaColor=function(M$a,M$b,M$c){var M$d,M$e;if(M$a){var M$f=M$a.transform._entity;M$f&&((M$e=(M$d=M$f.owner.meshRender.material).alphaColor).elements=M$c,M$d.alphaColor=M$e)}else(M$e=(M$d=M$b.meshRender.material).alphaColor).elements=M$c,M$d.alphaColor=M$e},M$d._getMeshRenderSharedMaterialBaseColor=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.baseColor.elements:null}return M$b.meshRender.sharedMaterial.baseColor.elements},M$d._setMeshRenderSharedMaterialBaseColor=function(M$a,M$b,M$c){var M$d,M$e;if(M$a){var M$f=M$a.transform._entity;M$f&&((M$e=(M$d=M$f.owner.meshRender.material).baseColor).elements=M$c,M$d.baseColor=M$e)}else(M$e=(M$d=M$b.meshRender.material).baseColor).elements=M$c,M$d.baseColor=M$e},M$d._getMeshRenderSharedMaterialDissolve=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.dissolve:0}return M$b.meshRender.sharedMaterial.dissolve},M$d._setMeshRenderSharedMaterialDissolve=function(M$a,M$b,M$c){if(M$a){var M$d=M$a.transform._entity;M$d&&(M$d.owner.meshRender.material.dissolve=M$c[0])}else M$b.meshRender.material.dissolve=M$c[0]},M$d._getMeshRenderSharedMaterialDissolveSpeed=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.dissolveSpeed:0}return M$b.meshRender.sharedMaterial.dissolveSpeed},M$d._setMeshRenderSharedMaterialDissolveSpeed=function(M$a,M$b,M$c){if(M$a){var M$d=M$a.transform._entity;M$d&&(M$d.owner.meshRender.material.dissolveSpeed=M$c[0])}else M$b.meshRender.material.dissolveSpeed=M$c[0]},M$d._getMeshRenderSharedMaterialMMultiplier=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.mMultiplier:0}return M$b.meshRender.sharedMaterial.mMultiplier},M$d._setMeshRenderSharedMaterialMMultiplier=function(M$a,M$b,M$c){if(M$a){var M$d=M$a.transform._entity;M$d&&(M$d.owner.meshRender.material.mMultiplier=M$c[0])}else M$b.meshRender.material.mMultiplier=M$c[0]},M$d._getMeshRenderSharedMaterialBaseScrollSpeedX=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return M$b.meshRender.sharedMaterial.baseScrollSpeedX},M$d._setMeshRenderSharedMaterialBaseScrollSpeedX=function(M$a,M$b,M$c){if(M$a){var M$d=M$a.transform._entity;M$d&&(M$d.owner.meshRender.material.baseScrollSpeedX=M$c[0])}else M$b.meshRender.material.baseScrollSpeedX=M$c[0]},M$d._getMeshRenderSharedMaterialBaseScrollSpeedY=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return M$b.meshRender.sharedMaterial.baseScrollSpeedY},M$d._setMeshRenderSharedMaterialBaseScrollSpeedY=function(M$a,M$b,M$c){if(M$a){var M$d=M$a.transform._entity;M$d&&(M$d.owner.meshRender.material.baseScrollSpeedY=M$c[0])}else M$b.meshRender.material.baseScrollSpeedY=M$c[0]},M$d._getMeshRenderSharedMaterialSecondScrollSpeedX=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return M$b.meshRender.sharedMaterial.secondScrollSpeedX},M$d._setMeshRenderSharedMaterialSecondScrollSpeedX=function(M$a,M$b,M$c){if(M$a){var M$d=M$a.transform._entity;M$d&&(M$d.owner.meshRender.material.secondScrollSpeedX=M$c[0])}else M$b.meshRender.material.secondScrollSpeedX=M$c[0]},M$d._getMeshRenderSharedMaterialSecondScrollSpeedY=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return M$b.meshRender.sharedMaterial.secondScrollSpeedY},M$d._setMeshRenderSharedMaterialSecondScrollSpeedY=function(M$a,M$b,M$c){if(M$a){var M$d=M$a.transform._entity;M$d&&(M$d.owner.meshRender.material.secondScrollSpeedY=M$c[0])}else M$b.meshRender.material.secondScrollSpeedY=M$c[0]},M$d._getMeshRenderSharedMaterialAlpha=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.alpha:0}return M$b.meshRender.sharedMaterial.alpha},M$d._setMeshRenderSharedMaterialAlpha=function(M$a,M$b,M$c){if(M$a){var M$d=M$a.transform._entity;M$d&&(M$d.owner.meshRender.material.alpha=M$c[0])}else M$b.meshRender.material.alpha=M$c[0]},M$d._getMeshRenderSharedMaterialIntensity=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.intensity:0}return M$b.meshRender.sharedMaterial.intensity},M$d._setMeshRenderSharedMaterialIntensity=function(M$a,M$b,M$c){if(M$a){var M$d=M$a.transform._entity;M$d&&(M$d.owner.meshRender.material.intensity=M$c[0])}else M$b.meshRender.material.intensity=M$c[0]},M$d._getMeshRenderSharedMaterialDetailTilingOffset=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return M$b.meshRender.sharedMaterial.detailTilingOffset.elements},M$d._setMeshRenderSharedMaterialDetailTilingOffset=function(M$a,M$b,M$c){var M$d,M$e;if(M$a){var M$f=M$a.transform._entity;M$f&&((M$e=(M$d=M$f.owner.meshRender.material).detailTilingOffset).elements=M$c,M$d.detailTilingOffset=M$e)}else(M$e=(M$d=M$b.meshRender.material).detailTilingOffset).elements=M$c,M$d.detailTilingOffset=M$e},M$d._getMeshRenderSharedMaterialDissolveTilingOffset=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return M$b.meshRender.sharedMaterial.dissolveTilingOffset.elements},M$d._setMeshRenderSharedMaterialDissolveTilingOffset=function(M$a,M$b,M$c){var M$d,M$e;if(M$a){var M$f=M$a.transform._entity;M$f&&((M$e=(M$d=M$f.owner.meshRender.material).dissolveTilingOffset).elements=M$c,M$d.dissolveTilingOffset=M$e)}else(M$e=(M$d=M$b.meshRender.material).dissolveTilingOffset).elements=M$c,M$d.dissolveTilingOffset=M$e},M$d._getMeshRenderSharedMaterialMaskTilingOffset=function(M$a,M$b){if(M$a){var M$c=M$a.transform._entity;return M$c?M$c.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return M$b.meshRender.sharedMaterial.maskTilingOffset.elements},M$d._setMeshRenderSharedMaterialMaskTilingOffset=function(M$a,M$b,M$c){var M$d,M$e;if(M$a){var M$f=M$a.transform._entity;M$f&&((M$e=(M$d=M$f.owner.meshRender.material).maskTilingOffset).elements=M$c,M$d.maskTilingOffset=M$e)}else(M$e=(M$d=M$b.meshRender.material).maskTilingOffset).elements=M$c,M$d.maskTilingOffset=M$e},M$d._propertyIDCounter=0,M$d._propertyIndexDic={},M$d._propertySetFuncs=[],M$d._propertyGetFuncs=[],M$d}(),M$R=function(){function M$a(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return M$n(M$a,"laya.d3.animation.Keyframe"),M$a}(),M$S=function(){function M$a(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return M$n(M$a,"laya.d3.animation.KeyframeNode"),M$a}(),M$I=(function(){function M$a(){this._tempVector30=new M$gb,this._tempVector31=new M$gb,this._tempVector32=new M$gb,this._a=new M$gb,this._b=new M$gb,this._c=new M$gb,this._d=new M$gb}M$n(M$a,"laya.d3.core.glitter.SplineCurvePositionVelocity");var M$b=M$a.prototype;M$b.Init=function(M$a,M$b,M$c,M$d){M$a.cloneTo(this._d),M$b.cloneTo(this._c),M$gb.scale(M$a,2,this._a),M$gb.scale(M$c,2,this._tempVector30),M$gb.subtract(this._a,this._tempVector30,this._a),M$gb.add(this._a,M$b,this._a),M$gb.add(this._a,M$d,this._a),M$gb.scale(M$c,3,this._b),M$gb.scale(M$a,3,this._tempVector30),M$gb.subtract(this._b,this._tempVector30,this._b),M$gb.subtract(this._b,M$d,this._b),M$gb.scale(M$b,2,this._tempVector30),M$gb.subtract(this._b,this._tempVector30,this._b)},M$b.Slerp=function(M$a,M$b){M$gb.scale(this._a,M$a*M$a*M$a,this._tempVector30),M$gb.scale(this._b,M$a*M$a,this._tempVector31),M$gb.scale(this._c,M$a,this._tempVector32),M$gb.add(this._tempVector30,this._tempVector31,M$b),M$gb.add(M$b,this._tempVector32,M$b),M$gb.add(M$b,this._d,M$b)}}(),function(){function M$M(M$a,M$b,M$c,M$d){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=M$a,this._h=M$b,this._minHeight=M$c,this._maxHeight=M$d}M$n(M$M,"laya.d3.core.HeightMap");var M$a=M$M.prototype;M$a._inBounds=function(M$a,M$b){return 0<=M$a&&M$a<this._h&&0<=M$b&&M$b<this._w},M$a.getHeight=function(M$a,M$b){return this._inBounds(M$a,M$b)?this._datas[M$a][M$b]:NaN},M$o(0,M$a,"width",function(){return this._w}),M$o(0,M$a,"height",function(){return this._h}),M$o(0,M$a,"maxHeight",function(){return this._maxHeight}),M$o(0,M$a,"minHeight",function(){return this._minHeight}),M$M.creatFromMesh=function(M$a,M$b,M$c,M$d){for(var M$e=[],M$f=[],M$g=M$a.getSubMeshCount(),M$h=0;M$h<M$g;M$h++){for(var M$i=M$a.getSubMesh(M$h),M$j=M$i._getVertexBuffer(),M$k=M$j.getData(),M$l=[],M$m=0;M$m<M$k.length;M$m+=M$j.vertexDeclaration.vertexStride/4){var M$n=new M$gb(M$k[M$m+0],M$k[M$m+1],M$k[M$m+2]);M$l.push(M$n)}M$e.push(M$l);var M$o=M$i._getIndexBuffer();M$f.push(M$o.getData())}var M$p=M$a.boundingBox,M$q=M$p.min.x,M$r=M$p.min.z,M$s=M$p.max.x,M$t=M$p.max.z,M$u=M$p.min.y,M$v=M$p.max.y,M$w=M$s-M$q,M$x=M$t-M$r,M$A=M$d.elements[0]=M$w/(M$b-1),M$B=M$d.elements[1]=M$x/(M$c-1),M$C=new M$M(M$b,M$c,M$u,M$v),M$D=M$M._tempRay,M$E=M$D.direction.elements;M$E[0]=0,M$E[1]=-1,M$E[2]=0;var M$F=M$v+.1;M$D.origin.elements[1]=M$F;for(var M$G=0;M$G<M$c;M$G++){var M$H=M$r+M$G*M$B;M$C._datas[M$G]=[];for(var M$I=0;M$I<M$b;M$I++){var M$J=M$q+M$I*M$A,M$K=M$D.origin.elements;M$K[0]=M$J,M$K[2]=M$H;var M$L=M$M._getPosition(M$D,M$e,M$f);M$C._datas[M$G][M$I]=M$L===Number.MAX_VALUE?NaN:M$F-M$L}}return M$C},M$M.createFromImage=function(M$a,M$b,M$c){for(var M$d=M$a.width,M$e=M$a.height,M$f=new M$M(M$d,M$e,M$b,M$c),M$g=(M$c-M$b)/254,M$h=M$a.getPixels(),M$i=0,M$j=0;M$j<M$e;M$j++)for(var M$k=M$f._datas[M$j]=[],M$l=0;M$l<M$d;M$l++){var M$m=M$h[M$i++],M$n=M$h[M$i++],M$o=M$h[M$i++],M$p=M$h[M$i++];M$k[M$l]=255==M$m&&255==M$n&&255==M$o&&255==M$p?NaN:(M$m+M$n+M$o)/3*M$g+M$b}return M$f},M$M._getPosition=function(M$a,M$b,M$c){for(var M$d=Number.MAX_VALUE,M$e=0;M$e<M$b.length;M$e++)for(var M$f=M$b[M$e],M$g=M$c[M$e],M$h=0;M$h<M$g.length;M$h+=3){var M$i=M$f[M$g[M$h+0]],M$j=M$f[M$g[M$h+1]],M$k=M$f[M$g[M$h+2]],M$l=M$ob.rayIntersectsTriangle(M$a,M$i,M$j,M$k);!isNaN(M$l)&&M$l<M$d&&(M$d=M$l)}return M$d},M$l(M$M,["_tempRay",function(){return this._tempRay=new M$eb(new M$gb,new M$gb)}])}(),function(){function M$e(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}M$n(M$e,"laya.d3.core.Layer");var M$a=M$e.prototype;return M$a._binarySearchIndex=function(){for(var M$a=0,M$b=M$e._collsionTestList.length-1,M$c=0;M$a<=M$b;){M$c=Math.floor((M$a+M$b)/2);var M$d=M$e._collsionTestList[M$c];if(M$d==this._number)return M$c;M$d>this._number?M$b=M$c-1:M$a=M$c+1}return M$a},M$a._addCollider=function(M$a){0===this._colliders.length&&M$e._collsionTestList.splice(this._binarySearchIndex(),0,this._number),M$a._isRigidbody?(this._colliders.unshift(M$a),this._nonRigidbodyOffset++):this._colliders.push(M$a)},M$a._removeCollider=function(M$a){var M$b=this._colliders.indexOf(M$a);M$b<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(M$b,1),0===this._colliders.length&&M$e._collsionTestList.splice(M$e._collsionTestList.indexOf(this._number),1)},M$o(0,M$a,"number",function(){return this._number}),M$o(0,M$a,"visible",function(){return this._visible},function(M$a){this._visible=M$a,M$e._visibleLayers=M$a?M$e._visibleLayers|this.mask:M$e._visibleLayers&~this.mask}),M$o(0,M$a,"mask",function(){return this._mask}),M$o(1,M$e,"visibleLayers",function(){return M$e._visibleLayers},function(M$a){M$e._visibleLayers=M$a;for(var M$b=0,M$c=M$e._layerList.length;M$b<M$c;M$b++){var M$d=M$e._layerList[M$b];M$d._visible=0!=(M$d._mask&M$e._visibleLayers)}}),M$e.__init__=function(){M$e._layerList.length=31;for(var M$a=0;M$a<31;M$a++){var M$b=new M$e;M$e._layerList[M$a]=M$b,0===M$a?(M$b.name="Default Layer",M$b.visible=!0):(M$b.name="Layer-"+M$a,M$b.visible=!1),M$b._number=M$a,M$b._mask=Math.pow(2,M$a)}M$e.currentCreationLayer=M$e._layerList[0]},M$e.getLayerByNumber=function(M$a){if(M$a<0||30<M$a)throw new Error("无法返回指定Layer，该number超出范围！");return M$e._layerList[M$a]},M$e.getLayerByName=function(M$a){for(var M$b=0;M$b<31;M$b++)if(M$e._layerList[M$b].name===M$a)return M$e._layerList[M$b];throw new Error("无法返回指定Layer,该name不存在")},M$e.isVisible=function(M$a){return 0!=(M$a&M$e._currentCameraCullingMask&M$e._visibleLayers)},M$e._layerList=[],M$e._visibleLayers=2147483647,M$e._collsionTestList=[],M$e._currentCameraCullingMask=2147483647,M$e.maxCount=31,M$e.currentCreationLayer=null,M$e}()),M$J=(function(){function M$a(M$a,M$b,M$c){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=M$a,this._minCount=M$b,this._maxCount=M$c}M$n(M$a,"laya.d3.core.particleShuriKen.module.Burst");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b.cloneTo=function(M$a){var M$b=M$a;M$b._time=this._time,M$b._minCount=this._minCount,M$b._maxCount=this._maxCount},M$b.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$b,"time",function(){return this._time}),M$o(0,M$b,"minCount",function(){return this._minCount}),M$o(0,M$b,"maxCount",function(){return this._maxCount})}(),function(){function M$a(M$a){this._color=null,this.enbale=!1,this._color=M$a}M$n(M$a,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var M$b=M$a.prototype;M$b.cloneTo=function(M$a){var M$b=M$a;this._color.cloneTo(M$b._color),M$b.enbale=this.enbale},M$b.clone=function(){var M$a;switch(this._color.type){case 0:M$a=M$L.createByConstant(this._color.constant.clone());break;case 1:M$a=M$L.createByGradient(this._color.gradient.clone());break;case 2:M$a=M$L.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:M$a=M$L.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var M$b=new this.constructor(M$a);return M$b.enbale=this.enbale,M$b},M$o(0,M$b,"color",function(){return this._color})}(),function(){function M$a(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}M$n(M$a,"laya.d3.core.particleShuriKen.module.Emission");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),M$b._destroy=function(){this._bursts=null,this._destroyed=!0},M$b.getBurstsCount=function(){return this._bursts.length},M$b.getBurstByIndex=function(M$a){return this._bursts[M$a]},M$b.addBurst=function(M$a){var M$b=this._bursts.length;if(0<M$b)for(var M$c=0;M$c<M$b;M$c++)this._bursts[M$c].time>M$a.time&&this._bursts.splice(M$c,0,M$a);this._bursts.push(M$a)},M$b.removeBurst=function(M$a){var M$b=this._bursts.indexOf(M$a);-1!==M$b&&this._bursts.splice(M$b,1)},M$b.removeBurstByIndex=function(M$a){this._bursts.splice(M$a,1)},M$b.clearBurst=function(){this._bursts.length=0},M$b.cloneTo=function(M$a){var M$b=M$a,M$c=M$b._bursts;M$c.length=this._bursts.length;for(var M$d=0,M$e=this._bursts.length;M$d<M$e;M$d++){var M$f=M$c[M$d];M$f?this._bursts[M$d].cloneTo(M$f):M$c[M$d]=this._bursts[M$d].clone()}M$b._emissionRate=this._emissionRate,M$b.enbale=this.enbale},M$b.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$b,"destroyed",function(){return this._destroyed}),M$o(0,M$b,"emissionRate",function(){return this._emissionRate},function(M$a){if(M$a<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=M$a})}(),function(){function M$d(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}M$n(M$d,"laya.d3.core.particleShuriKen.module.FrameOverTime");var M$a=M$d.prototype;return M$v.imps(M$a,{"laya.d3.core.IClone":!0}),M$a.cloneTo=function(M$a){var M$b=M$a;M$b._type=this._type,M$b._constant=this._constant,this._overTime.cloneTo(M$b._overTime),M$b._constantMin=this._constantMin,M$b._constantMax=this._constantMax,this._overTimeMin.cloneTo(M$b._overTimeMin),this._overTimeMax.cloneTo(M$b._overTimeMax)},M$a.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$a,"frameOverTimeData",function(){return this._overTime}),M$o(0,M$a,"constant",function(){return this._constant}),M$o(0,M$a,"type",function(){return this._type}),M$o(0,M$a,"frameOverTimeDataMin",function(){return this._overTimeMin}),M$o(0,M$a,"constantMin",function(){return this._constantMin}),M$o(0,M$a,"frameOverTimeDataMax",function(){return this._overTimeMax}),M$o(0,M$a,"constantMax",function(){return this._constantMax}),M$d.createByConstant=function(M$a){var M$b=new M$d;return M$b._type=0,M$b._constant=M$a,M$b},M$d.createByOverTime=function(M$a){var M$b=new M$d;return M$b._type=1,M$b._overTime=M$a,M$b},M$d.createByRandomTwoConstant=function(M$a,M$b){var M$c=new M$d;return M$c._type=2,M$c._constantMin=M$a,M$c._constantMax=M$b,M$c},M$d.createByRandomTwoOverTime=function(M$a,M$b){var M$c=new M$d;return M$c._type=3,M$c._overTimeMin=M$a,M$c._overTimeMax=M$b,M$c},M$d}()),M$K=function(){function M$j(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}M$n(M$j,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var M$a=M$j.prototype;return M$v.imps(M$a,{"laya.d3.core.IClone":!0}),M$a.cloneTo=function(M$a){var M$b=M$a;M$b._type=this._type,M$b._separateAxes=this._separateAxes,M$b._constant=this._constant,this._constantSeparate.cloneTo(M$b._constantSeparate),this._gradient.cloneTo(M$b._gradient),this._gradientX.cloneTo(M$b._gradientX),this._gradientY.cloneTo(M$b._gradientY),this._gradientZ.cloneTo(M$b._gradientZ),M$b._constantMin=this._constantMin,M$b._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(M$b._constantMinSeparate),this._constantMaxSeparate.cloneTo(M$b._constantMaxSeparate),this._gradientMin.cloneTo(M$b._gradientMin),this._gradientMax.cloneTo(M$b._gradientMax),this._gradientXMin.cloneTo(M$b._gradientXMin),this._gradientXMax.cloneTo(M$b._gradientXMax),this._gradientYMin.cloneTo(M$b._gradientYMin),this._gradientYMax.cloneTo(M$b._gradientYMax),this._gradientZMin.cloneTo(M$b._gradientZMin),this._gradientZMax.cloneTo(M$b._gradientZMax)},M$a.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$a,"gradientZ",function(){return this._gradientZ}),M$o(0,M$a,"constant",function(){return this._constant}),M$o(0,M$a,"gradient",function(){return this._gradient}),M$o(0,M$a,"separateAxes",function(){return this._separateAxes}),M$o(0,M$a,"type",function(){return this._type}),M$o(0,M$a,"constantSeparate",function(){return this._constantSeparate}),M$o(0,M$a,"gradientX",function(){return this._gradientX}),M$o(0,M$a,"gradientY",function(){return this._gradientY}),M$o(0,M$a,"gradientW",function(){return this._gradientW}),M$o(0,M$a,"gradientMin",function(){return this._gradientMin}),M$o(0,M$a,"constantMin",function(){return this._constantMin}),M$o(0,M$a,"gradientMax",function(){return this._gradientMax}),M$o(0,M$a,"constantMax",function(){return this._constantMax}),M$o(0,M$a,"gradientWMin",function(){return this._gradientWMin}),M$o(0,M$a,"constantMinSeparate",function(){return this._constantMinSeparate}),M$o(0,M$a,"constantMaxSeparate",function(){return this._constantMaxSeparate}),M$o(0,M$a,"gradientXMin",function(){return this._gradientXMin}),M$o(0,M$a,"gradientXMax",function(){return this._gradientXMax}),M$o(0,M$a,"gradientWMax",function(){return this._gradientWMax}),M$o(0,M$a,"gradientYMin",function(){return this._gradientYMin}),M$o(0,M$a,"gradientYMax",function(){return this._gradientYMax}),M$o(0,M$a,"gradientZMin",function(){return this._gradientZMin}),M$o(0,M$a,"gradientZMax",function(){return this._gradientZMax}),M$j.createByConstant=function(M$a){var M$b=new M$j;return M$b._type=0,M$b._separateAxes=!1,M$b._constant=M$a,M$b},M$j.createByConstantSeparate=function(M$a){var M$b=new M$j;return M$b._type=0,M$b._separateAxes=!0,M$b._constantSeparate=M$a,M$b},M$j.createByGradient=function(M$a){var M$b=new M$j;return M$b._type=1,M$b._separateAxes=!1,M$b._gradient=M$a,M$b},M$j.createByGradientSeparate=function(M$a,M$b,M$c,M$d){var M$e=new M$j;return M$e._type=1,M$e._separateAxes=!0,M$e._gradientX=M$a,M$e._gradientY=M$b,M$e._gradientZ=M$c,M$e._gradientW=M$d,M$e},M$j.createByRandomTwoConstant=function(M$a,M$b){var M$c=new M$j;return M$c._type=2,M$c._separateAxes=!1,M$c._constantMin=M$a,M$c._constantMax=M$b,M$c},M$j.createByRandomTwoConstantSeparate=function(M$a,M$b){var M$c=new M$j;return M$c._type=2,M$c._separateAxes=!0,M$c._constantMinSeparate=M$a,M$c._constantMaxSeparate=M$b,M$c},M$j.createByRandomTwoGradient=function(M$a,M$b){var M$c=new M$j;return M$c._type=3,M$c._separateAxes=!1,M$c._gradientMin=M$a,M$c._gradientMax=M$b,M$c},M$j.createByRandomTwoGradientSeparate=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){var M$i=new M$j;return M$i._type=3,M$i._separateAxes=!0,M$i._gradientXMin=M$a,M$i._gradientXMax=M$b,M$i._gradientYMin=M$c,M$i._gradientYMax=M$d,M$i._gradientZMin=M$e,M$i._gradientZMax=M$f,M$i._gradientWMin=M$g,M$i._gradientWMax=M$h,M$i},M$j}(),M$L=function(){function M$d(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}M$n(M$d,"laya.d3.core.particleShuriKen.module.GradientColor");var M$a=M$d.prototype;return M$v.imps(M$a,{"laya.d3.core.IClone":!0}),M$a.cloneTo=function(M$a){var M$b=M$a;M$b._type=this._type,this._constant.cloneTo(M$b._constant),this._constantMin.cloneTo(M$b._constantMin),this._constantMax.cloneTo(M$b._constantMax),this._gradient.cloneTo(M$b._gradient),this._gradientMin.cloneTo(M$b._gradientMin),this._gradientMax.cloneTo(M$b._gradientMax)},M$a.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$a,"gradient",function(){return this._gradient}),M$o(0,M$a,"constant",function(){return this._constant}),M$o(0,M$a,"type",function(){return this._type}),M$o(0,M$a,"gradientMin",function(){return this._gradientMin}),M$o(0,M$a,"constantMin",function(){return this._constantMin}),M$o(0,M$a,"gradientMax",function(){return this._gradientMax}),M$o(0,M$a,"constantMax",function(){return this._constantMax}),M$d.createByConstant=function(M$a){var M$b=new M$d;return M$b._type=0,M$b._constant=M$a,M$b},M$d.createByGradient=function(M$a){var M$b=new M$d;return M$b._type=1,M$b._gradient=M$a,M$b},M$d.createByRandomTwoConstant=function(M$a,M$b){var M$c=new M$d;return M$c._type=2,M$c._constantMin=M$a,M$c._constantMax=M$b,M$c},M$d.createByRandomTwoGradient=function(M$a,M$b){var M$c=new M$d;return M$c._type=3,M$c._gradientMin=M$a,M$c._gradientMax=M$b,M$c},M$d}(),M$M=(function(){function M$a(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}M$n(M$a,"laya.d3.core.particleShuriKen.module.GradientDataColor");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b.addAlpha=function(M$a,M$b){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==M$a&&(M$a=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=M$a,this._alphaElements[this._alphaCurrentLength++]=M$b):DEBUG},M$b.addRGB=function(M$a,M$b){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==M$a&&(M$a=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=M$a,this._rgbElements[this._rgbCurrentLength++]=M$b.x,this._rgbElements[this._rgbCurrentLength++]=M$b.y,this._rgbElements[this._rgbCurrentLength++]=M$b.z):DEBUG},M$b.cloneTo=function(M$a){var M$b=M$a,M$c=0,M$d=0;M$b._alphaCurrentLength=this._alphaCurrentLength;var M$e=M$b._alphaElements;for(M$e.length=this._alphaElements.length,M$c=0,M$d=this._alphaElements.length;M$c<M$d;M$c++)M$e[M$c]=this._alphaElements[M$c];M$b._rgbCurrentLength=this._rgbCurrentLength;var M$f=M$b._rgbElements;for(M$f.length=this._rgbElements.length,M$c=0,M$d=this._rgbElements.length;M$c<M$d;M$c++)M$f[M$c]=this._rgbElements[M$c]},M$b.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$b,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),M$o(0,M$b,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function M$a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}M$n(M$a,"laya.d3.core.particleShuriKen.module.GradientDataInt");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b.add=function(M$a,M$b){this._currentLength<8?(6===this._currentLength&&1!==M$a&&(M$a=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=M$a,this._elements[this._currentLength++]=M$b):console.log("Warning:data count must lessEqual than 4")},M$b.cloneTo=function(M$a){var M$b=M$a;M$b._currentLength=this._currentLength;var M$c=M$b._elements;M$c.length=this._elements.length;for(var M$d=0,M$e=this._elements.length;M$d<M$e;M$d++)M$c[M$d]=this._elements[M$d]},M$b.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$b,"gradientCount",function(){return this._currentLength/2})}(),function(){function M$a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}M$n(M$a,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b.add=function(M$a,M$b){this._currentLength<8?(6===this._currentLength&&1!==M$a&&(M$a=1,DEBUG),this._elements[this._currentLength++]=M$a,this._elements[this._currentLength++]=M$b):DEBUG},M$b.getKeyByIndex=function(M$a){return this._elements[2*M$a]},M$b.getValueByIndex=function(M$a){return this._elements[2*M$a+1]},M$b.getAverageValue=function(){for(var M$a=0,M$b=this._currentLength-2;M$a<M$b;M$a+=2){this._elements[M$a+1];this._elements[M$a+3],this._elements[M$a+2]-this._elements[M$a]}return 0},M$b.cloneTo=function(M$a){var M$b=M$a;M$b._currentLength=this._currentLength;var M$c=M$b._elements;M$c.length=this._elements.length;for(var M$d=0,M$e=this._elements.length;M$d<M$e;M$d++)M$c[M$d]=this._elements[M$d]},M$b.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$b,"gradientCount",function(){return this._currentLength/2})}(),function(){function M$a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}M$n(M$a,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b.add=function(M$a,M$b){this._currentLength<8?(6===this._currentLength&&1!==M$a&&(M$a=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=M$a,this._elements[this._currentLength++]=M$b.x,this._elements[this._currentLength++]=M$b.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},M$b.cloneTo=function(M$a){var M$b=M$a;M$b._currentLength=this._currentLength;var M$c=M$b._elements;M$c.length=this._elements.length;for(var M$d=0,M$e=this._elements.length;M$d<M$e;M$d++)M$c[M$d]=this._elements[M$d]},M$b.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$b,"gradientCount",function(){return this._currentLength/3})}(),function(){function M$h(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}M$n(M$h,"laya.d3.core.particleShuriKen.module.GradientSize");var M$a=M$h.prototype;return M$v.imps(M$a,{"laya.d3.core.IClone":!0}),M$a.getMaxSizeInGradient=function(){var M$a=0,M$b=0,M$c=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(M$a=0,M$b=this._gradientX.gradientCount;M$a<M$b;M$a++)M$c=Math.max(M$c,this._gradientX.getValueByIndex(M$a));for(M$a=0,M$b=this._gradientY.gradientCount;M$a<M$b;M$a++)M$c=Math.max(M$c,this._gradientY.getValueByIndex(M$a))}else for(M$a=0,M$b=this._gradient.gradientCount;M$a<M$b;M$a++)M$c=Math.max(M$c,this._gradient.getValueByIndex(M$a));break;case 1:M$c=this._separateAxes?(M$c=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),M$c=Math.max(M$c,this._constantMinSeparate.y),Math.max(M$c,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(M$a=0,M$b=this._gradientXMin.gradientCount;M$a<M$b;M$a++)M$c=Math.max(M$c,this._gradientXMin.getValueByIndex(M$a));for(M$a=0,M$b=this._gradientXMax.gradientCount;M$a<M$b;M$a++)M$c=Math.max(M$c,this._gradientXMax.getValueByIndex(M$a));for(M$a=0,M$b=this._gradientYMin.gradientCount;M$a<M$b;M$a++)M$c=Math.max(M$c,this._gradientYMin.getValueByIndex(M$a));for(M$a=0,M$b=this._gradientZMax.gradientCount;M$a<M$b;M$a++)M$c=Math.max(M$c,this._gradientZMax.getValueByIndex(M$a))}else{for(M$a=0,M$b=this._gradientMin.gradientCount;M$a<M$b;M$a++)M$c=Math.max(M$c,this._gradientMin.getValueByIndex(M$a));for(M$a=0,M$b=this._gradientMax.gradientCount;M$a<M$b;M$a++)M$c=Math.max(M$c,this._gradientMax.getValueByIndex(M$a))}}return M$c},M$a.cloneTo=function(M$a){var M$b=M$a;M$b._type=this._type,M$b._separateAxes=this._separateAxes,this._gradient.cloneTo(M$b._gradient),this._gradientX.cloneTo(M$b._gradientX),this._gradientY.cloneTo(M$b._gradientY),this._gradientZ.cloneTo(M$b._gradientZ),M$b._constantMin=this._constantMin,M$b._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(M$b._constantMinSeparate),this._constantMaxSeparate.cloneTo(M$b._constantMaxSeparate),this._gradientMin.cloneTo(M$b._gradientMin),this._gradientMax.cloneTo(M$b._gradientMax),this._gradientXMin.cloneTo(M$b._gradientXMin),this._gradientXMax.cloneTo(M$b._gradientXMax),this._gradientYMin.cloneTo(M$b._gradientYMin),this._gradientYMax.cloneTo(M$b._gradientYMax),this._gradientZMin.cloneTo(M$b._gradientZMin),this._gradientZMax.cloneTo(M$b._gradientZMax)},M$a.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$a,"gradientZ",function(){return this._gradientZ}),M$o(0,M$a,"gradient",function(){return this._gradient}),M$o(0,M$a,"separateAxes",function(){return this._separateAxes}),M$o(0,M$a,"type",function(){return this._type}),M$o(0,M$a,"gradientMin",function(){return this._gradientMin}),M$o(0,M$a,"constantMin",function(){return this._constantMin}),M$o(0,M$a,"gradientX",function(){return this._gradientX}),M$o(0,M$a,"gradientY",function(){return this._gradientY}),M$o(0,M$a,"gradientMax",function(){return this._gradientMax}),M$o(0,M$a,"constantMax",function(){return this._constantMax}),M$o(0,M$a,"constantMinSeparate",function(){return this._constantMinSeparate}),M$o(0,M$a,"constantMaxSeparate",function(){return this._constantMaxSeparate}),M$o(0,M$a,"gradientXMin",function(){return this._gradientXMin}),M$o(0,M$a,"gradientXMax",function(){return this._gradientXMax}),M$o(0,M$a,"gradientYMin",function(){return this._gradientYMin}),M$o(0,M$a,"gradientYMax",function(){return this._gradientYMax}),M$o(0,M$a,"gradientZMin",function(){return this._gradientZMin}),M$o(0,M$a,"gradientZMax",function(){return this._gradientZMax}),M$h.createByGradient=function(M$a){var M$b=new M$h;return M$b._type=0,M$b._separateAxes=!1,M$b._gradient=M$a,M$b},M$h.createByGradientSeparate=function(M$a,M$b,M$c){var M$d=new M$h;return M$d._type=0,M$d._separateAxes=!0,M$d._gradientX=M$a,M$d._gradientY=M$b,M$d._gradientZ=M$c,M$d},M$h.createByRandomTwoConstant=function(M$a,M$b){var M$c=new M$h;return M$c._type=1,M$c._separateAxes=!1,M$c._constantMin=M$a,M$c._constantMax=M$b,M$c},M$h.createByRandomTwoConstantSeparate=function(M$a,M$b){var M$c=new M$h;return M$c._type=1,M$c._separateAxes=!0,M$c._constantMinSeparate=M$a,M$c._constantMaxSeparate=M$b,M$c},M$h.createByRandomTwoGradient=function(M$a,M$b){var M$c=new M$h;return M$c._type=2,M$c._separateAxes=!1,M$c._gradientMin=M$a,M$c._gradientMax=M$b,M$c},M$h.createByRandomTwoGradientSeparate=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=new M$h;return M$g._type=2,M$g._separateAxes=!0,M$g._gradientXMin=M$a,M$g._gradientXMax=M$b,M$g._gradientYMin=M$c,M$g._gradientYMax=M$d,M$g._gradientZMin=M$e,M$g._gradientZMax=M$f,M$g},M$h}()),M$N=function(){function M$h(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}M$n(M$h,"laya.d3.core.particleShuriKen.module.GradientVelocity");var M$a=M$h.prototype;return M$v.imps(M$a,{"laya.d3.core.IClone":!0}),M$a.cloneTo=function(M$a){var M$b=M$a;M$b._type=this._type,this._constant.cloneTo(M$b._constant),this._gradientX.cloneTo(M$b._gradientX),this._gradientY.cloneTo(M$b._gradientY),this._gradientZ.cloneTo(M$b._gradientZ),this._constantMin.cloneTo(M$b._constantMin),this._constantMax.cloneTo(M$b._constantMax),this._gradientXMin.cloneTo(M$b._gradientXMin),this._gradientXMax.cloneTo(M$b._gradientXMax),this._gradientYMin.cloneTo(M$b._gradientYMin),this._gradientYMax.cloneTo(M$b._gradientYMax),this._gradientZMin.cloneTo(M$b._gradientZMin),this._gradientZMax.cloneTo(M$b._gradientZMax)},M$a.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$a,"gradientZ",function(){return this._gradientZ}),M$o(0,M$a,"constant",function(){return this._constant}),M$o(0,M$a,"type",function(){return this._type}),M$o(0,M$a,"gradientXMax",function(){return this._gradientXMax}),M$o(0,M$a,"constantMin",function(){return this._constantMin}),M$o(0,M$a,"gradientX",function(){return this._gradientX}),M$o(0,M$a,"gradientY",function(){return this._gradientY}),M$o(0,M$a,"gradientXMin",function(){return this._gradientXMin}),M$o(0,M$a,"constantMax",function(){return this._constantMax}),M$o(0,M$a,"gradientYMin",function(){return this._gradientYMin}),M$o(0,M$a,"gradientYMax",function(){return this._gradientYMax}),M$o(0,M$a,"gradientZMin",function(){return this._gradientZMin}),M$o(0,M$a,"gradientZMax",function(){return this._gradientZMax}),M$h.createByConstant=function(M$a){var M$b=new M$h;return M$b._type=0,M$b._constant=M$a,M$b},M$h.createByGradient=function(M$a,M$b,M$c){var M$d=new M$h;return M$d._type=1,M$d._gradientX=M$a,M$d._gradientY=M$b,M$d._gradientZ=M$c,M$d},M$h.createByRandomTwoConstant=function(M$a,M$b){var M$c=new M$h;return M$c._type=2,M$c._constantMin=M$a,M$c._constantMax=M$b,M$c},M$h.createByRandomTwoGradient=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=new M$h;return M$g._type=3,M$g._gradientXMin=M$a,M$g._gradientXMax=M$b,M$g._gradientYMin=M$c,M$g._gradientYMax=M$d,M$g._gradientZMin=M$e,M$g._gradientZMax=M$f,M$g},M$h}(),M$O=(function(){function M$a(M$a){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=M$a}M$n(M$a,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b.cloneTo=function(M$a){var M$b=M$a;this._angularVelocity.cloneTo(M$b._angularVelocity),M$b.enbale=this.enbale},M$b.clone=function(){var M$a;switch(this._angularVelocity.type){case 0:M$a=this._angularVelocity.separateAxes?M$K.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):M$K.createByConstant(this._angularVelocity.constant);break;case 1:M$a=this._angularVelocity.separateAxes?M$K.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):M$K.createByGradient(this._angularVelocity.gradient.clone());break;case 2:M$a=this._angularVelocity.separateAxes?M$K.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):M$K.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:M$a=this._angularVelocity.separateAxes?M$K.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):M$K.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var M$b=new this.constructor(M$a);return M$b.enbale=this.enbale,M$b},M$o(0,M$b,"angularVelocity",function(){return this._angularVelocity})}(),function(){function M$a(){this.enable=!1,this.randomDirection=!1}M$n(M$a,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b._getShapeBoundBox=function(M$a){throw new Error("BaseShape: must override it.")},M$b._getSpeedBoundBox=function(M$a){throw new Error("BaseShape: must override it.")},M$b.generatePositionAndDirection=function(M$a,M$b,M$c,M$d){throw new Error("BaseShape: must override it.")},M$b._calculateProceduralBounds=function(M$a,M$b,M$c){this._getShapeBoundBox(M$a);var M$d=M$a.min,M$e=M$a.max;M$gb.multiply(M$d,M$b,M$d),M$gb.multiply(M$e,M$b,M$e);var M$f=new M$Za(new M$gb,new M$gb);this.randomDirection?(M$f.min=new M$gb(-1,-1,-1),M$f.max=new M$gb(1,1,1)):this._getSpeedBoundBox(M$f);var M$g=new M$Za(new M$gb,new M$gb),M$h=M$g.min,M$i=M$g.max;M$gb.scale(M$f.min,M$c.y,M$h),M$gb.scale(M$f.max,M$c.y,M$i),M$gb.add(M$a.min,M$h,M$h),M$gb.add(M$a.max,M$i,M$i),M$gb.min(M$a.min,M$h,M$a.min),M$gb.max(M$a.max,M$h,M$a.max);var M$j=new M$Za(new M$gb,new M$gb),M$k=M$j.min,M$l=M$j.max;M$gb.scale(M$f.min,M$c.x,M$k),M$gb.scale(M$f.max,M$c.x,M$l),M$gb.min(M$j.min,M$l,M$h),M$gb.max(M$j.min,M$l,M$i),M$gb.min(M$a.min,M$h,M$a.min),M$gb.max(M$a.max,M$h,M$a.max)},M$b.cloneTo=function(M$a){M$a.enable=this.enable},M$b.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$a}()),M$T=function(){function M$f(){}return M$n(M$f,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),M$f._randomPointUnitArcCircle=function(M$a,M$b,M$c){var M$d=M$b.elements,M$e=NaN;M$e=M$c?M$c.getFloat()*M$a:Math.random()*M$a,M$d[0]=Math.cos(M$e),M$d[1]=Math.sin(M$e)},M$f._randomPointInsideUnitArcCircle=function(M$a,M$b,M$c){var M$d=M$b.elements;M$f._randomPointUnitArcCircle(M$a,M$b,M$c);var M$e=NaN;M$e=M$c?Math.pow(M$c.getFloat(),.5):Math.pow(Math.random(),.5),M$d[0]=M$d[0]*M$e,M$d[1]=M$d[1]*M$e},M$f._randomPointUnitCircle=function(M$a,M$b){var M$c=M$a.elements,M$d=NaN;M$d=M$b?M$b.getFloat()*Math.PI*2:Math.random()*Math.PI*2,M$c[0]=Math.cos(M$d),M$c[1]=Math.sin(M$d)},M$f._randomPointInsideUnitCircle=function(M$a,M$b){var M$c=M$a.elements;M$f._randomPointUnitCircle(M$a);var M$d=NaN;M$d=M$b?Math.pow(M$b.getFloat(),.5):Math.pow(Math.random(),.5),M$c[0]=M$c[0]*M$d,M$c[1]=M$c[1]*M$d},M$f._randomPointUnitSphere=function(M$a,M$b){var M$c=M$a.elements,M$d=NaN,M$e=NaN;M$e=M$b?(M$d=M$c[2]=2*M$b.getFloat()-1,M$b.getFloat()*Math.PI*2):(M$d=M$c[2]=2*Math.random()-1,Math.random()*Math.PI*2);var M$f=Math.sqrt(1-M$d*M$d);M$c[0]=M$f*Math.cos(M$e),M$c[1]=M$f*Math.sin(M$e)},M$f._randomPointInsideUnitSphere=function(M$a,M$b){var M$c=M$a.elements;M$f._randomPointUnitSphere(M$a);var M$d=NaN;M$d=M$b?Math.pow(M$b.getFloat(),1/3):Math.pow(Math.random(),1/3),M$c[0]=M$c[0]*M$d,M$c[1]=M$c[1]*M$d,M$c[2]=M$c[2]*M$d},M$f._randomPointInsideHalfUnitBox=function(M$a,M$b){var M$c=M$a.elements;M$b?(M$c[0]=M$b.getFloat()-.5,M$c[1]=M$b.getFloat()-.5,M$c[2]=M$b.getFloat()-.5):(M$c[0]=Math.random()-.5,M$c[1]=Math.random()-.5,M$c[2]=Math.random()-.5)},M$f}(),M$U=(function(){function M$a(M$a){this._size=null,this.enbale=!1,this._size=M$a}M$n(M$a,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b.cloneTo=function(M$a){var M$b=M$a;this._size.cloneTo(M$b._size),M$b.enbale=this.enbale},M$b.clone=function(){var M$a;switch(this._size.type){case 0:M$a=this._size.separateAxes?M$M.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):M$M.createByGradient(this._size.gradient.clone());break;case 1:M$a=this._size.separateAxes?M$M.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):M$M.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:M$a=this._size.separateAxes?M$M.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):M$M.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var M$b=new this.constructor(M$a);return M$b.enbale=this.enbale,M$b},M$o(0,M$b,"size",function(){return this._size})}(),function(){function M$d(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}M$n(M$d,"laya.d3.core.particleShuriKen.module.StartFrame");var M$a=M$d.prototype;return M$v.imps(M$a,{"laya.d3.core.IClone":!0}),M$a.cloneTo=function(M$a){var M$b=M$a;M$b._type=this._type,M$b._constant=this._constant,M$b._constantMin=this._constantMin,M$b._constantMax=this._constantMax},M$a.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$a,"constant",function(){return this._constant}),M$o(0,M$a,"type",function(){return this._type}),M$o(0,M$a,"constantMin",function(){return this._constantMin}),M$o(0,M$a,"constantMax",function(){return this._constantMax}),M$d.createByConstant=function(M$a){var M$b=new M$d;return M$b._type=0,M$b._constant=M$a,M$b},M$d.createByRandomTwoConstant=function(M$a,M$b){var M$c=new M$d;return M$c._type=1,M$c._constantMin=M$a,M$c._constantMax=M$b,M$c},M$d}()),M$V=(function(){function M$a(M$a,M$b){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new M$fb(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=M$a,this._startFrame=M$b}M$n(M$a,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b.cloneTo=function(M$a){var M$b=M$a;this.tiles.cloneTo(M$b.tiles),M$b.type=this.type,M$b.randomRow=this.randomRow,this._frame.cloneTo(M$b._frame),this._startFrame.cloneTo(M$b._startFrame),M$b.cycles=this.cycles,M$b.enableUVChannels=this.enableUVChannels,M$b.enable=this.enable},M$b.clone=function(){var M$a,M$b;switch(this._frame.type){case 0:M$a=M$J.createByConstant(this._frame.constant);break;case 1:M$a=M$J.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:M$a=M$J.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:M$a=M$J.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:M$b=M$U.createByConstant(this._startFrame.constant);break;case 1:M$b=M$U.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var M$c=new this.constructor(M$a,M$b);return this.tiles.cloneTo(M$c.tiles),M$c.type=this.type,M$c.randomRow=this.randomRow,M$c.cycles=this.cycles,M$c.enableUVChannels=this.enableUVChannels,M$c.enable=this.enable,M$c},M$o(0,M$b,"frame",function(){return this._frame}),M$o(0,M$b,"startFrame",function(){return this._startFrame})}(),function(){function M$a(M$a){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=M$a}M$n(M$a,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b.cloneTo=function(M$a){var M$b=M$a;this._velocity.cloneTo(M$b._velocity),M$b.enbale=this.enbale,M$b.space=this.space},M$b.clone=function(){var M$a;switch(this._velocity.type){case 0:M$a=M$N.createByConstant(this._velocity.constant.clone());break;case 1:M$a=M$N.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:M$a=M$N.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:M$a=M$N.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var M$b=new this.constructor(M$a);return M$b.enbale=this.enbale,M$b.space=this.space,M$b},M$o(0,M$b,"velocity",function(){return this._velocity})}(),function(){function M$a(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new M$mb,this._vb=M$Ob.create(M$a._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=M$Nb.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=M$Lb.nameKey.getID("LINE"),this._shaderCompile=M$Ab._preCompileShader[this._sharderNameID]}M$n(M$a,"laya.d3.core.PhasorSpriter3D");var M$b=M$a.prototype;return M$b.line=function(M$a,M$b,M$c,M$d){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(M$a.x,M$a.y,M$a.z,M$b.x,M$b.y,M$b.z,M$b.w),this.addVertex(M$c.x,M$c.y,M$c.z,M$d.x,M$d.y,M$d.z,M$d.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},M$b.circle=function(M$a,M$b,M$c,M$d,M$e,M$f){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*M$b,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/M$b,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*M$a,Math.cos(this._tempNumver0)*M$a,0,M$c,M$d,M$e,M$f),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},M$b.plane=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=M$d/2,this._tempNumver1=M$e/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(M$a-this._tempNumver0,M$b+this._tempNumver1,M$c,M$f,M$g,M$h,M$i),this.addVertex(M$a+this._tempNumver0,M$b+this._tempNumver1,M$c,M$f,M$g,M$h,M$i),this.addVertex(M$a-this._tempNumver0,M$b-this._tempNumver1,M$c,M$f,M$g,M$h,M$i),this.addVertex(M$a+this._tempNumver0,M$b-this._tempNumver1,M$c,M$f,M$g,M$h,M$i),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},M$b.box=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=M$d/2,this._tempNumver1=M$e/2,this._tempNumver2=M$f/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(M$a-this._tempNumver0,M$b+this._tempNumver1,M$c+this._tempNumver2,M$g,M$h,M$i,M$j),this.addVertex(M$a+this._tempNumver0,M$b+this._tempNumver1,M$c+this._tempNumver2,M$g,M$h,M$i,M$j),this.addVertex(M$a-this._tempNumver0,M$b-this._tempNumver1,M$c+this._tempNumver2,M$g,M$h,M$i,M$j),this.addVertex(M$a+this._tempNumver0,M$b-this._tempNumver1,M$c+this._tempNumver2,M$g,M$h,M$i,M$j),this.addVertex(M$a+this._tempNumver0,M$b+this._tempNumver1,M$c-this._tempNumver2,M$g,M$h,M$i,M$j),this.addVertex(M$a-this._tempNumver0,M$b+this._tempNumver1,M$c-this._tempNumver2,M$g,M$h,M$i,M$j),this.addVertex(M$a+this._tempNumver0,M$b-this._tempNumver1,M$c-this._tempNumver2,M$g,M$h,M$i,M$j),this.addVertex(M$a-this._tempNumver0,M$b-this._tempNumver1,M$c-this._tempNumver2,M$g,M$h,M$i,M$j),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},M$b.cone=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*M$c+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*M$c>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/M$c,this.addVertexIndex(0,M$b,0,M$d,M$e,M$f,M$g,this._tempUint0),this.addVertexIndex(0,0,0,M$d,M$e,M$f,M$g,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<M$c;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(M$a*this._tempNumver2,0,M$a*this._tempNumver3,M$d,M$e,M$f,M$g,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==M$c-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(M$a*this._tempNumver2,0,M$a*this._tempNumver3,M$d,M$e,M$f,M$g,this._tempUint0+(this._tempInt0+M$c)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==M$c-1?this.addIndexes(this._tempUint1+M$c+2):this.addIndexes(this._tempUint1+this._tempInt0+M$c+1),this.addIndexes(this._tempUint1+this._tempInt0+M$c),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},M$b.boundingBoxLine=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(M$a,M$e,M$f,M$g,M$h,M$i,M$j),this.addVertex(M$d,M$e,M$f,M$g,M$h,M$i,M$j),this.addVertex(M$a,M$b,M$f,M$g,M$h,M$i,M$j),this.addVertex(M$d,M$b,M$f,M$g,M$h,M$i,M$j),this.addVertex(M$d,M$e,M$c,M$g,M$h,M$i,M$j),this.addVertex(M$a,M$e,M$c,M$g,M$h,M$i,M$j),this.addVertex(M$d,M$b,M$c,M$g,M$h,M$i,M$j),this.addVertex(M$a,M$b,M$c,M$g,M$h,M$i,M$j),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},M$b.addVertex=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=M$a,this._vbData[this._posInVBData+1]=M$b,this._vbData[this._posInVBData+2]=M$c,this._vbData[this._posInVBData+3]=M$d,this._vbData[this._posInVBData+4]=M$e,this._vbData[this._posInVBData+5]=M$f,this._vbData[this._posInVBData+6]=M$g,this._posInVBData+=this._floatSizePerVer,this},M$b.addVertexIndex=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){return this._hasBegun||this.addVertexIndexException(),this._vbData[M$h]=M$a,this._vbData[M$h+1]=M$b,this._vbData[M$h+2]=M$c,this._vbData[M$h+3]=M$d,this._vbData[M$h+4]=M$e,this._vbData[M$h+5]=M$f,this._vbData[M$h+6]=M$g,(M$h+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=M$h),this},M$b.addIndexes=function(M$a){var M$b=arguments;this._hasBegun||this.addVertexIndexException();for(var M$c=0;M$c<M$b.length;M$c++)this._ibData[this._posInIBData]=M$b[M$c],this._posInIBData++;return this},M$b.begin=function(M$a,M$b){return this._hasBegun&&this.beginException0(),1!==M$a&&4!==M$a&&this.beginException1(),this._primitiveType=M$a,this._camera=M$b,this._hasBegun=!0,this},M$b.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},M$b.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(M$a._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),M$A.drawCall++,M$F.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},M$b.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},M$b.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},M$b.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},M$b.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},M$b.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},M$b.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(28,[new M$ga(0,"vector3",0),new M$ga(12,"vector4",1)])}]),M$a}()),M$W=function(){function M$a(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++M$a._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new M$mb}M$n(M$a,"laya.d3.core.render.RenderElement");var M$b=M$a.prototype;return M$b.getDynamicBatchBakedVertexs=function(M$a){for(var M$b=this._renderObj._getVertexBuffer(M$a),M$c=M$b.getData().slice(),M$d=M$b.vertexDeclaration,M$e=M$d.getVertexElementByUsage(0).offset/4,M$f=M$d.getVertexElementByUsage(3).offset/4,M$g=this._sprite3D.transform,M$h=M$g.worldMatrix,M$i=M$g.rotation,M$j=M$d.vertexStride/4,M$k=0,M$l=M$c.length;M$k<M$l;M$k+=M$j){var M$m=M$k+M$e,M$n=M$k+M$f;M$qb.transformVector3ArrayToVector3ArrayCoordinate(M$c,M$m,M$h,M$c,M$m),M$qb.transformVector3ArrayByQuat(M$c,M$n,M$i,M$c,M$n)}return M$c},M$b.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},M$b._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},M$o(0,M$b,"id",function(){return this._id}),M$o(0,M$b,"renderObj",function(){return this._renderObj},function(M$a){this._renderObj!==M$a&&(this._renderObj=M$a)}),M$a._uniqueIDCounter=0,M$a}(),M$X=function(){function M$b(M$a){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++M$b._uniqueIDCounter,this._needSort=!1,this._scene=M$a,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}M$n(M$b,"laya.d3.core.render.RenderQueue");var M$a=M$b.prototype;return M$a._sortOpaqueFunc=function(M$a,M$b){if(M$a._render&&M$b._render){var M$c=M$a._material.renderQueue-M$b._material.renderQueue;return 0==M$c?M$a._render._distanceForSort-M$b._render._distanceForSort:M$c}return 0},M$a._sortAlphaFunc=function(M$a,M$b){if(M$a._render&&M$b._render){var M$c=M$a._material.renderQueue-M$b._material.renderQueue;return 0==M$c?M$b._render._distanceForSort-M$a._render._distanceForSort:M$c}return 0},M$a._begainRenderElement=function(M$a,M$b,M$c){return!!M$b._beforeRender(M$a)},M$a._sortAlpha=function(M$a){M$b._cameraPosition=M$a,this._finalElements.sort(this._sortAlphaFunc)},M$a._sortOpaque=function(M$a){M$b._cameraPosition=M$a,this._finalElements.sort(this._sortOpaqueFunc)},M$a._preRender=function(M$a){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},M$a._render=function(M$a,M$b){for(var M$c,M$d,M$e,M$f,M$g,M$h,M$i=M$A.loopCount,M$j=this._scene,M$k=M$a.camera,M$l=(M$k.id,!1),M$m=0,M$n=this._finalElements.length;M$m<M$n;M$m++){var M$o,M$p,M$q,M$r=this._finalElements[M$m];if(null!=M$r._onPreRenderFunction&&M$r._onPreRenderFunction.call(M$r._sprite3D,M$a),0===M$r._type){if(M$a.owner=M$q=M$r._sprite3D,M$a.renderElement=M$r,M$q._preRenderUpdateComponents(M$a),M$o=M$r.renderObj,M$p=M$r._material,this._begainRenderElement(M$a,M$o,M$p)){if(M$c=M$o._getVertexBuffers(),!(M$e=(M$d=M$o._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[M$d.id]){this._errorRecord[M$d.id]=1;var M$s="vertexBuffer:"+("("+M$d._destroyed+","+M$d._released+","+M$d._referenceCount+","+M$d._buffer+")")+", material:"+(M$p?M$p.__className+"("+M$p._destroyed+","+M$p._released+")":"null")+", owner:"+(M$q?M$q.__className+"("+M$q._destroyed+","+M$q._activeInHierarchy+","+M$q._displayedInStage+")":"null")+", renderObj:"+(M$o?M$o.__className+"("+M$o._destroyed+","+M$o._released+","+M$o._referenceCount+")":"")+", parent:, url:"+(M$q?M$q.url:"")+", disposeStack:"+M$d.disposeStack;M$v.recordError("报错：unknown vertexDeclaration  "+M$s)}continue}if(M$l=(M$f=M$a._shader=M$p._getShader(M$j._shaderDefineValue,M$e.shaderDefineValue,M$q._shaderDefineValue)).bind()||M$i!==M$f._uploadLoopCount,M$c){if(M$f._uploadVertexBuffer!==M$c||M$l){for(var M$t=0;M$t<M$c.length;M$t++){var M$u=M$c[M$t];M$f.uploadAttributesX(M$u.vertexDeclaration.shaderValues.data,M$u)}M$f._uploadVertexBuffer=M$c}}else(M$f._uploadVertexBuffer!==M$d||M$l)&&(M$f.uploadAttributes(M$e.shaderValues.data,null),M$f._uploadVertexBuffer=M$d);(M$f._uploadScene!==M$j||M$l)&&(M$f.uploadSceneUniforms(M$j._shaderValues.data),M$f._uploadScene=M$j),(M$k!==M$f._uploadCamera||M$f._uploadSprite3D!==M$q||M$l)&&(M$f.uploadSpriteUniforms(M$q._shaderValues.data),M$f._uploadSprite3D=M$q),(M$k!==M$f._uploadCamera||M$l)&&(M$f.uploadCameraUniforms(M$k._shaderValues.data),M$f._uploadCamera=M$k),(M$f._uploadMaterial!==M$p||M$l)&&(M$p._upload(),M$f._uploadMaterial=M$p),M$g!==M$p?(M$p._setRenderStateBlendDepth(),M$p._setRenderStateFrontFace(M$b,M$q.transform),M$g=M$p,M$h=M$q):M$h!==M$q&&(M$p._setRenderStateFrontFace(M$b,M$q.transform),M$h=M$q),M$o._render(M$a),M$f._uploadLoopCount=M$i}M$q._postRenderUpdateComponents(M$a)}else if(2===M$r._type){M$r.renderObj;M$a.owner=M$q=M$r._sprite3D,M$a.renderElement=M$r,M$a._batchIndexStart=M$r._tempBatchIndexStart,M$a._batchIndexEnd=M$r._tempBatchIndexEnd,M$o=M$r.renderObj,M$p=M$r._material,this._begainRenderElement(M$a,M$o,M$p)&&(M$e=(M$d=M$o._getVertexBuffer(0)).vertexDeclaration,M$l=(M$f=M$a._shader=M$p._getShader(M$j._shaderDefineValue,M$e.shaderDefineValue,M$q._shaderDefineValue)).bind()||M$i!==M$f._uploadLoopCount,(M$f._uploadVertexBuffer!==M$d||M$l)&&(M$f.uploadAttributes(M$e.shaderValues.data,null),M$f._uploadVertexBuffer=M$d),(M$f._uploadScene!==M$j||M$l)&&(M$f.uploadSceneUniforms(M$j._shaderValues.data),M$f._uploadScene=M$j),(M$k!==M$f._uploadCamera||M$f._uploadSprite3D!==M$q||M$l)&&(M$f.uploadSpriteUniforms(M$q._shaderValues.data),M$f._uploadSprite3D=M$q),(M$k!==M$f._uploadCamera||M$l)&&(M$f.uploadCameraUniforms(M$k._shaderValues.data),M$f._uploadCamera=M$k),(M$f._uploadMaterial!==M$p||M$l)&&(M$p._upload(),M$f._uploadMaterial=M$p),M$g!==M$p?(M$p._setRenderStateBlendDepth(),M$p._setRenderStateFrontFace(M$b,M$q.transform),M$g=M$p,M$h=M$q):M$h!==M$q&&(M$p._setRenderStateFrontFace(M$b,M$q.transform),M$h=M$q),M$o._render(M$a),M$f._uploadLoopCount=M$i)}}},M$a._renderShadow=function(M$a,M$b){for(var M$c,M$d,M$e,M$f,M$g,M$h=M$A.loopCount,M$i=this._scene,M$j=M$a.camera,M$k=!1,M$l=0,M$m=this._finalElements.length;M$l<M$m;M$l++){var M$n,M$o,M$p,M$q=this._finalElements[M$l];0===M$q._type&&(M$a.owner=M$p=M$q._sprite3D,M$b||M$p._projectionViewWorldUpdateCamera===M$j&&M$p._projectionViewWorldUpdateLoopCount===M$A.loopCount||(M$p._render._renderUpdate(M$a._projectionViewMatrix),M$p._projectionViewWorldUpdateLoopCount=M$A.loopCount,M$p._projectionViewWorldUpdateCamera=M$j),M$a.renderElement=M$q,M$p._preRenderUpdateComponents(M$a),M$n=M$q.renderObj,M$o=M$q._material,this._begainRenderElement(M$a,M$n,null)&&(M$d=(M$c=M$n._getVertexBuffer(0)).vertexDeclaration,M$k=(M$e=M$a._shader=M$o._getShader(M$i._shaderDefineValue,M$d.shaderDefineValue,M$p._shaderDefineValue)).bind()||M$h!==M$e._uploadLoopCount,(M$e._uploadVertexBuffer!==M$c||M$k)&&(M$e.uploadAttributes(M$d.shaderValues.data,null),M$e._uploadVertexBuffer=M$c),(M$j!==M$e._uploadCamera||M$e._uploadSprite3D!==M$p||M$k)&&(M$e.uploadSpriteUniforms(M$p._shaderValues.data),M$e._uploadSprite3D=M$p),(M$j!==M$e._uploadCamera||M$k)&&(M$e.uploadCameraUniforms(M$j._shaderValues.data),M$e._uploadCamera=M$j),(M$e._uploadMaterial!==M$o||M$k)&&(M$o._upload(),M$e._uploadMaterial=M$o),M$e._uploadRenderElement,M$f!==M$o?(M$o._setRenderStateFrontFace(!1,M$p.transform),M$f=M$o,M$g=M$p):M$g!==M$p&&(M$o._setRenderStateFrontFace(!1,M$p.transform),M$g=M$p),M$n._render(M$a),M$e._uploadLoopCount=M$h),M$p._postRenderUpdateComponents(M$a))}},M$a._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},M$a._addRenderElement=function(M$a){this._renderElements.push(M$a),this._needSort=!0},M$a._addDynamicBatchElement=function(M$a){this._dynamicBatchCombineRenderElements.push(M$a)},M$o(0,M$a,"id",function(){return this._id}),M$b._uniqueIDCounter=0,M$b._cameraPosition=null,M$b}(),M$Y=function(){function M$a(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return M$n(M$a,"laya.d3.core.render.RenderState"),M$a.clientWidth=0,M$a.clientHeight=0,M$a}(),M$Z=function(){function M$g(M$a,M$b){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new M$_a(new M$gb,0),this._corners=[new M$gb,new M$gb,new M$gb,new M$gb,new M$gb,new M$gb,new M$gb,new M$gb],this._boundingBoxCenter=new M$gb,this._children=M$d(8),this._objects=[],this._tempBoundBoxCorners=[new M$gb,new M$gb,new M$gb,new M$gb,new M$gb,new M$gb,new M$gb,new M$gb],this._scene=M$a,this._currentDepth=M$b}M$n(M$g,"laya.d3.core.scene.OctreeNode");var M$a=M$g.prototype;return M$v.imps(M$a,{"laya.d3.core.scene.ITreeNode":!0}),M$a.init=function(M$a,M$b){var M$c=new M$gb,M$d=new M$gb;M$gb.scale(M$b,-.5,M$c),M$gb.scale(M$b,.5,M$d),M$gb.add(M$c,M$a,M$c),M$gb.add(M$d,M$a,M$d),this.exactBox=new M$Za(M$c,M$d),this.relaxBox=new M$Za(M$c,M$d)},M$a.addTreeNode=function(M$a){1===Collision.boxContainsBox(this._relaxBox,M$a.boundingBox)?this.addNodeDown(M$a,0):this.addObject(M$a)},M$a.addChild=function(M$a){var M$b=this._children[M$a];if(null==M$b){M$b=new M$g(this._scene,this._currentDepth+1),(this._children[M$a]=M$b)._parent=this,M$gb.subtract(this._exactBox.max,this._exactBox.min,M$g.tempSize),M$gb.multiply(M$g.tempSize,M$g._octreeSplit[M$a],M$g.tempCenter),M$gb.add(this._exactBox.min,M$g.tempCenter,M$g.tempCenter),M$gb.scale(M$g.tempSize,.25,M$g.tempSize);var M$c=new M$gb,M$d=new M$gb;M$gb.subtract(M$g.tempCenter,M$g.tempSize,M$c),M$gb.add(M$g.tempCenter,M$g.tempSize,M$d),M$b.exactBox=new M$Za(M$c,M$d),M$gb.scale(M$g.tempSize,M$g.relax,M$g.tempSize);var M$e=new M$gb,M$f=new M$gb;M$gb.subtract(M$g.tempCenter,M$g.tempSize,M$e),M$gb.add(M$g.tempCenter,M$g.tempSize,M$f),M$b.relaxBox=new M$Za(M$e,M$f)}return M$b},M$a.addObject=function(M$a){(M$a._treeNode=this)._objects.push(M$a)},M$a.removeObject=function(M$a){if(M$a._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var M$b=this._objects.indexOf(M$a);return-1!==M$b&&(this._objects.splice(M$b,1),!0)},M$a.clearObject=function(){this._objects.length=0},M$a.addNodeUp=function(M$a,M$b){this._parent&&1!==Collision.boxContainsBox(this._exactBox,M$a.boundingBox)?this._parent.addNodeUp(M$a,M$b-1):this.addNodeDown(M$a,M$b)},M$a.addNodeDown=function(M$a,M$b){if(M$b<this._scene.treeLevel){var M$c=this.inChildIndex(M$a.boundingBoxCenter),M$d=this.addChild(M$c);1===Collision.boxContainsBox(M$d._relaxBox,M$a.boundingBox)?M$d.addNodeDown(M$a,++M$b):this.addObject(M$a)}else this.addObject(M$a)},M$a.inChildIndex=function(M$a){return 4*(M$a.z<this._boundingBoxCenter.z?0:1)+2*(M$a.y<this._boundingBoxCenter.y?0:1)+(M$a.x<this._boundingBoxCenter.x?0:1)},M$a.updateObject=function(M$a){1===Collision.boxContainsBox(this._relaxBox,M$a.boundingBox)?(this.removeObject(M$a),M$a._treeNode=null,this.addNodeDown(M$a,this._currentDepth)):this._parent&&(this.removeObject(M$a),M$a._treeNode=null,this._parent.addNodeUp(M$a,this._currentDepth-1))},M$a.cullingObjects=function(M$a,M$b,M$c,M$d,M$e){var M$f,M$g=0,M$h=0,M$i=0,M$j=this._scene._dynamicBatchManager;for(M$g=0,M$f=this._objects.length;M$g<M$f;M$g++){var M$k=this._objects[M$g];if(M$I.isVisible(M$k._owner.layer.mask)&&M$k.enable){if(M$b&&(M$A.treeSpriteCollision+=1,0===M$a.containsBoundSphere(M$k.boundingSphere)))continue;M$k._renderUpdate(M$e),M$k._distanceForSort=M$gb.distance(M$k.boundingSphere.center,M$d)+M$k.sortingFudge;var M$l=M$k._renderElements;for(M$h=0,M$i=M$l.length;M$h<M$i;M$h++){var M$m=M$l[M$h],M$n=M$m._staticBatch;if(M$n&&M$n._material===M$m._material)M$n._addBatchRenderElement(M$m);else{var M$o=M$m.renderObj;M$o.triangleCount<10&&1===M$o._vertexBufferCount&&M$o._getIndexBuffer()&&M$m._material.renderQueue<2&&M$m._canDynamicBatch&&!M$k._owner.isStatic?M$j._addPrepareRenderElement(M$m):this._scene.getRenderQueue(M$m._material.renderQueue)._addRenderElement(M$m)}}}}for(M$g=0;M$g<8;M$g++){var M$p=this._children[M$g];if(null!=M$p){var M$q=M$b;if(M$b){var M$r=M$a.containsBoundBox(M$p._relaxBox);if(M$A.treeNodeCollision+=1,0===M$r)continue;M$q=2===M$r}M$p.cullingObjects(M$a,M$q,M$c,M$d,M$e)}}},M$a.cullingShadowObjects=function(M$a,M$b,M$c,M$d,M$e){var M$f,M$g=0,M$h=0,M$i=0;this._scene._dynamicBatchManager;for(M$g=0,M$f=this._objects.length;M$g<M$f;M$g++){var M$j=this._objects[M$g];if(M$j.castShadow&&M$I.isVisible(M$j._owner.layer.mask)&&M$j.enable){if(M$c&&0===M$a[0].containsBoundSphere(M$j.boundingSphere))continue;for(var M$k=1,M$l=M$a.length;M$k<M$l;M$k++){var M$m=M$b[M$k-1];if(0!==M$a[M$k].containsBoundSphere(M$j.boundingSphere)){var M$n=M$j._renderElements;for(M$h=0,M$i=M$n.length;M$h<M$i;M$h++)M$m._addRenderElement(M$n[M$h])}}}}for(M$g=0;M$g<8;M$g++){var M$o=this._children[M$g];if(null!=M$o){var M$p=M$c;if(M$c){var M$q=M$a[0].containsBoundBox(M$o._relaxBox);if(0===M$q)continue;M$p=2===M$q}M$o.cullingShadowObjects(M$a,M$b,M$p,M$d,M$e)}}},M$a.cullingShadowObjectsOnePSSM=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g,M$h=M$b[0],M$i=0,M$j=0,M$k=0;for(M$i=0,M$g=this._objects.length;M$i<M$g;M$i++){var M$l=this._objects[M$i];if(M$l.castShadow&&M$I.isVisible(M$l._owner.layer.mask)&&M$l.enable){if(M$d&&0===M$a.containsBoundSphere(M$l.boundingSphere))continue;M$l._renderUpdate(M$c);var M$m=M$l._renderElements;for(M$j=0,M$k=M$m.length;M$j<M$k;M$j++)M$h._addRenderElement(M$m[M$j])}}for(M$i=0;M$i<8;M$i++){var M$n=this._children[M$i];if(null!=M$n){var M$o=M$d;if(M$d){var M$p=M$a.containsBoundBox(M$n._relaxBox);if(0===M$p)continue;M$o=2===M$p}M$n.cullingShadowObjectsOnePSSM(M$a,M$b,M$c,M$o,M$e,M$f)}}},M$a.renderBoudingBox=function(M$a){this._renderBoudingBox(M$a);for(var M$b=0;M$b<8;++M$b){var M$c=this._children[M$b];M$c&&M$c.renderBoudingBox(M$a)}},M$a.buildAllChild=function(M$a){if(M$a<this._scene.treeLevel)for(var M$b=0;M$b<8;M$b++){this.addChild(M$b).buildAllChild(M$a+1)}},M$a._renderBoudingBox=function(M$a){},M$o(0,M$a,"exactBox",function(){return this._exactBox},function(M$a){this._exactBox=M$a,M$gb.add(M$a.min,M$a.max,this._boundingBoxCenter),M$gb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),M$o(0,M$a,"relaxBox",function(){return this._relaxBox},function(M$a){(this._relaxBox=M$a).getCorners(this._corners),M$_a.createfromPoints(this._corners,this._boundingSphere)}),M$g.debugMode=!1,M$g.relax=1.15,M$g.CHILDNUM=8,M$l(M$g,["tempVector0",function(){return this.tempVector0=new M$gb},"tempSize",function(){return this.tempSize=new M$gb},"tempCenter",function(){return this.tempCenter=new M$gb},"_octreeSplit",function(){return this._octreeSplit=[new M$gb(.25,.25,.25),new M$gb(.75,.25,.25),new M$gb(.25,.75,.25),new M$gb(.75,.75,.25),new M$gb(.25,.25,.75),new M$gb(.75,.25,.75),new M$gb(.25,.75,.75),new M$gb(.75,.75,.75)]}]),M$g}(),M$$=(function(){function M$a(){}M$n(M$a,"laya.d3.core.scene.SceneManager")}(),function(){function M$a(M$a,M$b,M$c,M$d){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===M$a&&(M$a=1),void 0===M$b&&(M$b=1),void 0===M$c&&(M$c=1),void 0===M$d&&(M$d=1),this._r=M$a,this._g=M$b,this._b=M$c,this._a=M$d}return M$n(M$a,"laya.d3.core.trail.module.Color",null,"Color$1"),M$a.prototype.cloneTo=function(M$a){M$a._r=this._r,M$a._g=this._g,M$a._b=this._b,M$a._a=this._a},M$l(M$a,["RED",function(){return this.RED=new M$a(1,0,0,1)},"GREEN",function(){return this.GREEN=new M$a(0,1,0,1)},"BLUE",function(){return this.BLUE=new M$a(0,0,1,1)},"CYAN",function(){return this.CYAN=new M$a(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new M$a(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new M$a(1,0,1,1)},"GRAY",function(){return this.GRAY=new M$a(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new M$a(1,1,1,1)},"BLACK",function(){return this.BLACK=new M$a(0,0,0,1)}]),M$a}()),M$_=(function(){function M$a(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}M$n(M$a,"laya.d3.core.trail.module.Gradient");var M$b=M$a.prototype;M$b.setKeys=function(M$a,M$b){var M$c,M$d;this._colorKeys=M$a;for(var M$e=this.index=0;M$e<M$a.length;M$e++){var M$f=(M$c=M$a[M$e]).color;this._colorKeyData[this.index++]=M$f._r,this._colorKeyData[this.index++]=M$f._g,this._colorKeyData[this.index++]=M$f._b,this._colorKeyData[this.index++]=M$c.time}this._alphaKeys=M$b;for(var M$g=this.index=0;M$g<M$b.length;M$g++)M$d=M$b[M$g],this._alphaKeyData[this.index++]=M$d.alpha,this._alphaKeyData[this.index++]=M$d.time},M$b.cloneTo=function(M$a){var M$b=0,M$c=0,M$d=this.colorKeys,M$e=[];for(M$b=0,M$c=M$d.length;M$b<M$c;M$b++){var M$f=new M$y;M$d[M$b].cloneTo(M$f),M$e.push(M$f)}var M$g=this.alphaKeys,M$h=[];for(M$b=0,M$c=M$g.length;M$b<M$c;M$b++){var M$i=new M$_;M$g[M$b].cloneTo(M$i),M$h.push(M$i)}M$a.setKeys(M$e,M$h)},M$o(0,M$b,"mode",function(){return this._mode},function(M$a){this._mode=M$a}),M$o(0,M$b,"colorKeys",function(){return this._colorKeys},function(M$a){this._colorKeys=M$a;for(var M$b=this.index=0;M$b<M$a.length;M$b++){var M$c=M$a[M$b],M$d=M$c.color;this._colorKeyData[this.index++]=M$d._r,this._colorKeyData[this.index++]=M$d._g,this._colorKeyData[this.index++]=M$d._b,this._colorKeyData[this.index++]=M$c.time}}),M$o(0,M$b,"alphaKeys",function(){return this._alphaKeys},function(M$a){this._alphaKeys=M$a;for(var M$b=this.index=0;M$b<M$a.length;M$b++){var M$c=M$a[M$b];this._alphaKeyData[this.index++]=M$c.alpha,this._alphaKeyData[this.index++]=M$c.time}})}(),function(){function M$a(M$a,M$b){this._alpha=NaN,this._time=NaN,void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),this._alpha=M$a,this._time=M$b}M$n(M$a,"laya.d3.core.trail.module.GradientAlphaKey");var M$b=M$a.prototype;return M$b.cloneTo=function(M$a){M$a.alpha=this.alpha,M$a.time=this.time},M$o(0,M$b,"alpha",function(){return this._alpha},function(M$a){this._alpha=M$a}),M$o(0,M$b,"time",function(){return this._time},function(M$a){this._time=M$a}),M$a}()),M$y=function(){function M$a(M$a,M$b){this._color=null,this._time=NaN,void 0===M$b&&(M$b=0),this._color=M$a||new M$$,this._time=M$b}M$n(M$a,"laya.d3.core.trail.module.GradientColorKey");var M$b=M$a.prototype;return M$b.cloneTo=function(M$a){this.color.cloneTo(M$a.color),M$a.time=this.time},M$o(0,M$b,"color",function(){return this._color},function(M$a){this._color=M$a}),M$o(0,M$b,"time",function(){return this._time},function(M$a){this._time=M$a}),M$a}(),M$z=(function(){function M$a(){}M$n(M$a,"laya.d3.core.trail.module.GradientMode"),M$a.Blend=0,M$a.Fixed=1}(),function(){function M$a(){}M$n(M$a,"laya.d3.core.trail.module.TextureMode"),M$a.Stretch=0,M$a.Tile=1}(),function(){function M$a(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}M$n(M$a,"laya.d3.core.trail.module.TrailKeyFrame"),M$a.prototype.cloneTo=function(M$a){M$a.time=this.time,M$a.inTangent=this.inTangent,M$a.outTangent=this.outTangent,M$a.value=this.value}}(),function(){function M$b(M$a){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new M$gb,this._curPosition=new M$gb,this._delVector3=new M$gb,this._lastFixedVertexPosition=new M$gb,this._pointAtoBVector3=new M$gb,this._pointA=new M$gb,this._pointB=new M$gb,this._owner=M$a,this._id=M$b.renderElementCount++,0==this._id?M$a._owner.transform.position.cloneTo(this._lastPosition):M$a._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new M$Ob(M$z.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new M$Ob(M$z.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}M$n(M$b,"laya.d3.core.trail.TrailRenderElement");var M$a=M$b.prototype;M$v.imps(M$a,{"laya.d3.core.render.IRenderable":!0}),M$a._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},M$a._addTrailByFirstPosition=function(M$a,M$b){M$gb.subtract(M$b,M$a,this._delVector3),M$gb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),M$gb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),M$gb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(M$a),M$a.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},M$a._addTrailByNextPosition=function(M$a){M$gb.subtract(M$a,this._lastFixedVertexPosition,this._delVector3),M$gb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),M$gb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),M$gb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=M$gb.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=M$ya.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(M$a),M$a.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(M$a),this._virtualVerticesCount=2)},M$a._updateVerticesByPosition=function(M$a){this._pointe=M$a.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},M$a._updateVertexBuffer2=function(){var M$a,M$b=0,M$c=0,M$d=0;for(M$d=0,M$a=(this._verticesCount+this._virtualVerticesCount)/2;M$d<M$a;M$d++)M$c=0==this._owner.textureMode?(this._VerticesToTailLength[M$d]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[M$d],this._vertices2[M$b++]=1-M$c,this._vertices2[M$b++]=1-M$c;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},M$a._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},M$a._updateDisappear=function(){var M$a,M$b=0;for(M$b=this._curDisappearIndex,M$a=(this._verticesCount+this._virtualVerticesCount)/2;M$b<M$a;M$b++)this._owner._curtime-this._everyGroupVertexBirthTime[M$b]>=this._owner.time+M$ya.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},M$a._beforeRender=function(M$a){return this._camera=M$a.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),M$gb.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},M$a._render=function(M$a){this._isDead||(M$F.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),M$A.drawCall++,M$A.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},M$a._getVertexBuffer=function(M$a){return void 0===M$a&&(M$a=0),0===M$a?this._vertexBuffer1:1===M$a?this._vertexBuffer2:null},M$a._getVertexBuffers=function(){return this._vertexBuffers},M$a._getIndexBuffer=function(){return null},M$a.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},M$a._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},M$o(0,M$a,"_vertexBufferCount",function(){return this._vertexBuffers.length}),M$o(0,M$a,"triangleCount",function(){return 0}),M$b.renderElementCount=0}(),function(){function M$a(){}M$n(M$a,"laya.d3.core.trail.VertexTrail");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration1}),M$o(1,M$a,"vertexDeclaration1",function(){return M$a._vertexDeclaration1}),M$o(1,M$a,"vertexDeclaration2",function(){return M$a._vertexDeclaration2}),M$l(M$a,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new M$fa(32,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",41),new M$ga(24,"single",33),new M$ga(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new M$fa(4,[new M$ga(0,"single",38)])}]),M$a}()),M$aa=function(){function M$u(M$a){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=M$a}M$n(M$u,"laya.d3.graphics.DynamicBatch");var M$a=M$u.prototype;return M$v.imps(M$a,{"laya.d3.core.render.IRenderable":!0}),M$a._getVertexBuffer=function(M$a){return void 0===M$a&&(M$a=0),0===M$a?this._vertexBuffer:null},M$a._getIndexBuffer=function(){return this._indexBuffer},M$a._getCombineRenderElementFromPool=function(M$a,M$b,M$c){var M$d=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return M$d||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=M$d=new M$W,M$d._sprite3D=new M$Xb),M$d._sprite3D._render._renderUpdate(M$c),M$d},M$a._getRenderElement=function(M$a,M$b,M$c){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*M$u.maxVertexCount),this._indexDatas=new Uint16Array(M$u.maxIndexCount),this._vertexBuffer=M$Ob.create(this._vertexDeclaration,M$u.maxVertexCount,35048),this._indexBuffer=M$Nb.create("ushort",M$u.maxIndexCount,35048));for(var M$d=this._merageElements.length=0,M$e=0,M$f=0,M$g=this._combineRenderElements.length;M$f<M$g;M$f++){var M$h=this._combineRenderElements[M$f],M$i=M$h.getDynamicBatchBakedVertexs(0),M$j=M$h.getBakedIndices(),M$k=M$h._sprite3D.transform._isFrontFaceInvert,M$l=M$d/(this._vertexDeclaration.vertexStride/4),M$m=M$e,M$n=M$m+M$j.length;M$h._tempBatchIndexStart=M$m,M$h._tempBatchIndexEnd=M$n,this._indexDatas.set(M$j,M$e);var M$o=0;if(M$k)for(M$o=M$m;M$o<M$n;M$o+=3){this._indexDatas[M$o]=M$l+this._indexDatas[M$o];var M$p=this._indexDatas[M$o+1],M$q=this._indexDatas[M$o+2];this._indexDatas[M$o+1]=M$l+M$q,this._indexDatas[M$o+2]=M$l+M$p}else for(M$o=M$m;M$o<M$n;M$o+=3)this._indexDatas[M$o]=M$l+this._indexDatas[M$o],this._indexDatas[M$o+1]=M$l+this._indexDatas[M$o+1],this._indexDatas[M$o+2]=M$l+this._indexDatas[M$o+2];M$e+=M$j.length,this._vertexDatas.set(M$i,M$d),M$d+=M$i.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),M$f=this._combineRenderElementPoolIndex=0,M$g=this._materials.length;M$f<M$g;M$f++){var M$r=this._getCombineRenderElementFromPool(M$a,M$b,M$c);M$r._type=2,M$r._staticBatch=null;var M$s=(M$r.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[M$f]]._tempBatchIndexStart,M$t=M$f+1===this._materialToRenderElementsOffsets.length?M$e:this._combineRenderElements[this._materialToRenderElementsOffsets[M$f+1]]._tempBatchIndexStart;M$r._tempBatchIndexStart=M$s,M$r._tempBatchIndexEnd=M$t,M$r._material=this._materials[M$f],this._merageElements.push(M$r)}},M$a._addCombineRenderObjTest=function(M$a){var M$b=M$a.renderObj,M$c=this._currentCombineIndexCount+M$b._getIndexBuffer().indexCount,M$d=this._currentCombineVertexCount+M$b._getVertexBuffer().vertexCount;return!(M$u.maxVertexCount<M$d||M$u.maxIndexCount<M$c)},M$a._addCombineRenderObj=function(M$a){var M$b=M$a.renderObj;this._combineRenderElements.push(M$a),this._currentCombineIndexCount=this._currentCombineIndexCount+M$b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+M$b._getVertexBuffer().vertexCount},M$a._addCombineMaterial=function(M$a){this._materials.push(M$a)},M$a._addMaterialToRenderElementOffset=function(M$a){this._materialToRenderElementsOffsets.push(M$a)},M$a._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},M$a._addToRenderQueue=function(M$a,M$b,M$c,M$d){this._getRenderElement(M$b,M$c,M$d);for(var M$e=0,M$f=this._materials.length;M$e<M$f;M$e++)M$a.getRenderQueue(this._materials[M$e].renderQueue)._addDynamicBatchElement(this._merageElements[M$e])},M$a._beforeRender=function(M$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},M$a._render=function(M$a){var M$b=M$a._batchIndexEnd-M$a._batchIndexStart;M$F.mainContext.drawElements(4,M$b,5123,2*M$a._batchIndexStart),M$A.drawCall++,M$A.trianglesFaces+=M$b/3},M$a._getVertexBuffers=function(){return null},M$o(0,M$a,"_vertexBufferCount",function(){return 1}),M$o(0,M$a,"triangleCount",function(){return this._indexBuffer.indexCount/3}),M$o(0,M$a,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),M$u.maxVertexCount=2e4,M$u.maxIndexCount=4e4,M$u.maxCombineTriangleCount=10,M$u}(),M$ba=function(){function M$u(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}M$n(M$u,"laya.d3.graphics.DynamicBatchManager");var M$a=M$u.prototype;return M$a.getDynamicBatch=function(M$a,M$b){var M$c,M$d=M$a.id.toString()+M$b;return this._dynamicBatches[M$d]?M$c=this._dynamicBatches[M$d]:this._dynamicBatches[M$d]=M$c=new M$aa(M$a),M$c},M$a._garbageCollection=function(){for(var M$a in this._dynamicBatches)0===this._dynamicBatches[M$a].combineRenderElementsCount&&delete this._dynamicBatches[M$a]},M$a._addPrepareRenderElement=function(M$a){this._prepareDynamicBatchCombineElements.push(M$a)},M$a._finishCombineDynamicBatch=function(M$a){var M$b,M$c,M$d;this._prepareDynamicBatchCombineElements.sort(M$u._sortPrepareDynamicBatch);for(var M$e,M$f,M$g,M$h,M$i,M$j=-1,M$k=!0,M$l=0,M$m=-1,M$n=0,M$o=this._prepareDynamicBatchCombineElements.length;M$n<M$o;M$n++){var M$p=(M$f=this._prepareDynamicBatchCombineElements[M$n]).renderObj._getVertexBuffer(0).vertexDeclaration,M$q=M$c!==M$p;M$q&&(M$l=0,M$c=M$p);var M$r=M$l!==M$j;if(M$r&&(M$j=M$l),(M$q||M$r)&&(M$g=this.getDynamicBatch(M$p,M$l),M$b=null),M$k)if(M$g._addCombineRenderObjTest(M$f)){if(M$b!==(M$e=M$f._material))M$h&&(M$a.getRenderQueue(M$i._material.renderQueue)._addRenderElement(M$i),M$i=M$h=null,M$m=-1),M$h=M$e,M$m=M$g.combineRenderElementsCount,M$i=M$f,M$b=M$e;else if(M$h){var M$s=M$i.renderObj,M$t=M$f.renderObj;M$s._getVertexBuffer().vertexCount+M$t._getVertexBuffer().vertexCount>M$aa.maxVertexCount||M$s._getIndexBuffer().indexCount+M$t._getIndexBuffer().indexCount>M$aa.maxIndexCount?(M$a.getRenderQueue(M$i._material.renderQueue)._addRenderElement(M$i),M$h=M$e,M$m=M$g.combineRenderElementsCount,M$i=M$f):(M$g._addCombineMaterial(M$h),M$g._addMaterialToRenderElementOffset(M$m),M$g._addCombineRenderObj(M$i),M$i=M$h=null,M$m=-1,M$g._addCombineRenderObj(M$f))}else M$g._addCombineRenderObj(M$f);M$k=!0}else M$h&&(M$a.getRenderQueue(M$i._material.renderQueue)._addRenderElement(M$i),M$i=M$h=null,M$m=-1),M$l++,M$k=!1;else M$d=this._prepareDynamicBatchCombineElements[M$n-1],M$g._addMaterialToRenderElementOffset(M$g.combineRenderElementsCount),M$b=M$d._material,M$g._addCombineMaterial(M$b),M$g._addCombineRenderObj(M$d),M$k=!0,M$b!==(M$e=M$f._material)?(M$h=M$e,M$m=M$g.combineRenderElementsCount,M$i=M$f):M$g._addCombineRenderObj(M$f),M$b=M$e}M$h&&(M$a.getRenderQueue(M$i._material.renderQueue)._addRenderElement(M$i),M$i=M$h=null,M$m=-1),this._prepareDynamicBatchCombineElements.length=0},M$a._clearRenderElements=function(){for(var M$a in this._dynamicBatches)this._dynamicBatches[M$a]._clearRenderElements()},M$a._addToRenderQueue=function(M$a,M$b,M$c,M$d){for(var M$e in this._dynamicBatches){var M$f=this._dynamicBatches[M$e];0<M$f.combineRenderElementsCount&&M$f._addToRenderQueue(M$a,M$b,M$c,M$d)}},M$a.dispose=function(){this._dynamicBatches=null},M$u._sortPrepareDynamicBatch=function(M$a,M$b){return M$a._mainSortID-M$b._mainSortID},M$u}(),M$ca=function(){function M$a(){}return M$n(M$a,"laya.d3.graphics.FrustumCulling"),M$a.renderShadowObjectCulling=function(M$a,M$b,M$c,M$d,M$e){var M$f=0,M$g=0,M$h=0,M$i=0;for(M$f=0,M$h=M$c.length;M$f<M$h;M$f++){var M$j=M$c[M$f];M$j&&M$j._clearRenderElements()}var M$k,M$l,M$m,M$n=M$a._cullingRenders;if(1<M$e){for(M$f=0,M$h=M$a._cullingRendersLength;M$f<M$h;M$f++)if((M$k=M$n[M$f]).castShadow&&M$I.isVisible(M$k._owner.layer.mask)&&M$k.enable)for(var M$o=1,M$p=M$b.length;M$o<M$p;M$o++)if(M$l=M$c[M$o-1],0!==M$b[M$o].containsBoundSphere(M$k.boundingSphere))for(M$g=0,M$i=(M$m=M$k._renderElements).length;M$g<M$i;M$g++)M$l._addRenderElement(M$m[M$g])}else for(M$f=0,M$h=M$a._cullingRendersLength;M$f<M$h;M$f++)if((M$k=M$n[M$f]).castShadow&&M$I.isVisible(M$k._owner.layer.mask)&&M$k.enable&&0!==M$b[0].containsBoundSphere(M$k.boundingSphere))for(M$k._renderUpdate(M$d),M$l=M$c[0],M$g=0,M$i=(M$m=M$k._renderElements).length;M$g<M$i;M$g++)M$l._addRenderElement(M$m[M$g])},M$a.renderShadowObjectCullingOctree=function(M$a,M$b,M$c,M$d,M$e){for(var M$f=0,M$g=M$c.length;M$f<M$g;M$f++){var M$h=M$c[M$f];M$h&&M$h._clearRenderElements()}1<M$e?M$a.treeRoot.cullingShadowObjects(M$b,M$c,!0,0,M$a):M$a.treeRoot.cullingShadowObjectsOnePSSM(M$b[0],M$c,M$d,!0,0,M$a)},M$a.renderObjectCulling=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=0,M$h=0,M$i=0,M$j=0,M$k=M$b._quenes,M$l=M$b._dynamicBatchManager,M$m=M$b._cullingRenders;for(M$g=0,M$h=M$k.length;M$g<M$h;M$g++){var M$n=M$k[M$g];M$n&&M$n._clearRenderElements()}var M$o=M$da._staticBatchManagers;for(M$g=0,M$h=M$o.length;M$g<M$h;M$g++)M$o[M$g]._clearRenderElements();M$l._clearRenderElements();var M$p=M$c.transform.position;for(M$g=0,M$h=M$b._cullingRendersLength;M$g<M$h;M$g++){var M$q=M$m[M$g];if(M$I.isVisible(M$q._owner.layer.mask)&&M$q.enable&&0!==M$a.containsBoundSphere(M$q.boundingSphere)&&M$q._renderUpdate(M$f)){M$q._distanceForSort=M$gb.distance(M$q.boundingSphere.center,M$p)+M$q.sortingFudge;var M$r=M$q._renderElements;for(M$i=0,M$j=M$r.length;M$i<M$j;M$i++){var M$s=M$r[M$i],M$t=M$s._staticBatch;if(M$t&&M$t._material===M$s._material)M$t._addBatchRenderElement(M$s);else{var M$u=M$s.renderObj;M$u.triangleCount<10&&1===M$u._vertexBufferCount&&M$u._getIndexBuffer()&&M$s._material.renderQueue<2&&M$s._canDynamicBatch&&!M$q._owner.isStatic?M$l._addPrepareRenderElement(M$s):M$b.getRenderQueue(M$s._material.renderQueue)._addRenderElement(M$s)}}}}for(M$g=0,M$h=M$o.length;M$g<M$h;M$g++)M$o[M$g]._addToRenderQueue(M$b,M$d,M$e,M$f);M$l._finishCombineDynamicBatch(M$b),M$l._addToRenderQueue(M$b,M$d,M$e,M$f)},M$a.renderObjectCullingOctree=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=0,M$h=0,M$i=M$b._quenes,M$j=M$b._dynamicBatchManager;for(M$g=0,M$h=M$i.length;M$g<M$h;M$g++){var M$k=M$i[M$g];M$k&&M$k._clearRenderElements()}var M$l=M$da._staticBatchManagers;for(M$g=0,M$h=M$l.length;M$g<M$h;M$g++)M$l[M$g]._clearRenderElements();for(M$j._clearRenderElements(),M$b._cullingRenders.length=0,M$b.treeRoot.cullingObjects(M$a,!0,0,M$c.transform.position,M$f),M$g=0,M$h=M$l.length;M$g<M$h;M$g++)M$l[M$g]._addToRenderQueue(M$b,M$d,M$e,M$f);M$j._finishCombineDynamicBatch(M$b),M$j._addToRenderQueue(M$b,M$d,M$e,M$f)},M$a.renderObjectCullingNoBoundFrustum=function(M$a,M$b,M$c,M$d,M$e){var M$f=0,M$g=0,M$h=0,M$i=0,M$j=M$a._quenes,M$k=M$a._dynamicBatchManager,M$l=M$a._cullingRenders;for(M$f=0,M$g=M$j.length;M$f<M$g;M$f++){var M$m=M$j[M$f];M$m&&M$m._clearRenderElements()}var M$n=M$da._staticBatchManagers;for(M$f=0,M$g=M$n.length;M$f<M$g;M$f++)M$n[M$f]._clearRenderElements();M$k._clearRenderElements();var M$o=M$b.transform.position;for(M$f=0,M$g=M$a._cullingRendersLength;M$f<M$g;M$f++){var M$p=M$l[M$f];if(M$I.isVisible(M$p._owner.layer.mask)&&M$p.enable){M$p._renderUpdate(M$e),M$p._distanceForSort=M$gb.distance(M$p.boundingSphere.center,M$o)+M$p.sortingFudge;var M$q=M$p._renderElements;for(M$h=0,M$i=M$q.length;M$h<M$i;M$h++){var M$r=M$q[M$h],M$s=M$r._staticBatch;if(M$s&&M$s._material===M$r._material)M$s._addBatchRenderElement(M$r);else{var M$t=M$r.renderObj;M$t.triangleCount<10&&1===M$t._vertexBufferCount&&M$t._getIndexBuffer()&&M$r._material.renderQueue<2&&M$r._canDynamicBatch&&!M$p._owner.isStatic?M$k._addPrepareRenderElement(M$r):M$a.getRenderQueue(M$r._material.renderQueue)._addRenderElement(M$r)}}}}for(M$f=0,M$g=M$n.length;M$f<M$g;M$f++)M$n[M$f]._addToRenderQueue(M$a,M$c,M$d,M$e);M$k._finishCombineDynamicBatch(M$a),M$k._addToRenderQueue(M$a,M$c,M$d,M$e)},M$a}(),M$da=function(){function M$f(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}M$n(M$f,"laya.d3.graphics.StaticBatchManager");var M$a=M$f.prototype;return M$a._finishInit=function(){for(var M$a in this._staticBatches)this._staticBatches[M$a]._finishInit();this._initBatchRenderElements.length=0},M$a._initStaticBatchs=function(M$a){throw new Error("StaticBatchManager:must override this function.")},M$a._addInitBatchSprite=function(M$a){for(var M$b=M$a._render._renderElements,M$c=0,M$d=M$b.length;M$c<M$d;M$c++)this._initBatchRenderElements.push(M$b[M$c])},M$a._clearRenderElements=function(){for(var M$a in this._staticBatches)this._staticBatches[M$a]._clearRenderElements()},M$a._garbageCollection=function(M$a){var M$b=M$a._staticBatch,M$c=M$b._initBatchRenderElements,M$d=M$c.indexOf(M$a);M$c.splice(M$d,1),0===M$c.length&&(M$b.dispose(),delete this._staticBatches[M$b._key])},M$a._addToRenderQueue=function(M$a,M$b,M$c,M$d){for(var M$e in this._staticBatches){var M$f=this._staticBatches[M$e];0<M$f._batchRenderElements.length&&M$f._updateToRenderQueue(M$a,M$d)}},M$a.dispose=function(){this._staticBatches=null},M$f._addToStaticBatchQueue=function(M$a){M$a instanceof laya.d3.core.RenderableSprite3D&&M$a._addToInitStaticBatchManager();for(var M$b=0,M$c=M$a.numChildren;M$b<M$c;M$b++)M$f._addToStaticBatchQueue(M$a._childs[M$b])},M$f.combine=function(M$a,M$b){var M$c,M$d=0,M$e=0;if(M$b)for(M$d=0,M$e=M$b.length;M$d<M$e;M$d++){M$b[M$d]._addToInitStaticBatchManager()}else M$a&&M$f._addToStaticBatchQueue(M$a);for(M$d=0,M$e=M$f._staticBatchManagers.length;M$d<M$e;M$d++)(M$c=M$f._staticBatchManagers[M$d])._initStaticBatchs(M$a),M$c._finishInit()},M$f._staticBatchManagers=[],M$f}(),M$ea=function(){function M$a(M$a,M$b,M$c){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=M$a,this._manager=M$b,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=M$c}M$n(M$a,"laya.d3.graphics.StaticBatch");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),M$b._binarySearch=function(M$a){for(var M$b=0,M$c=this._batchRenderElements.length-1,M$d=0;M$b<=M$c;)M$d=Math.floor((M$b+M$c)/2),this._compareBatchRenderElement(this._batchRenderElements[M$d],M$a)?M$c=M$d-1:M$b=M$d+1;return M$b},M$b._compareBatchRenderElement=function(M$a,M$b){throw new Error("StaticBatch:must override this function.")},M$b._getVertexDecLightMap=function(M$a){return M$a===M$Na.vertexDeclaration?M$Ia.vertexDeclaration:M$a===M$Ma.vertexDeclaration?M$Ha.vertexDeclaration:M$a===M$Ba.vertexDeclaration?M$ua.vertexDeclaration:M$a===M$Ra.vertexDeclaration?null:M$a===M$pa.vertexDeclaration?M$qa.vertexDeclaration:M$a===M$Pa.vertexDeclaration?M$Ka.vertexDeclaration:M$a===M$Fa.vertexDeclaration?M$Ga.vertexDeclaration:M$a===M$Oa.vertexDeclaration?M$Ja.vertexDeclaration:M$a===M$Ma.vertexDeclaration?M$Ha.vertexDeclaration:M$a===M$Ca.vertexDeclaration?M$va.vertexDeclaration:M$a===M$Ra.vertexDeclaration?null:M$a===M$pa.vertexDeclaration?M$qa.vertexDeclaration:M$a===M$Qa.vertexDeclaration?M$La.vertexDeclaration:M$a===M$Fa.vertexDeclaration?M$Ga.vertexDeclaration:M$a},M$b._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},M$b._addBatchRenderElement=function(M$a){this._batchRenderElements.splice(this._binarySearch(M$a),0,M$a)},M$b._updateToRenderQueue=function(M$a,M$b){this._combineRenderElementPoolIndex=0,this._getRenderElement(M$a.getRenderQueue(this._material.renderQueue)._renderElements,M$a,M$b)},M$b._getRenderElement=function(M$a,M$b,M$c){throw new Error("StaticBatch:must override this function.")},M$b._finishInit=function(){throw new Error("StaticBatch:must override this function.")},M$b._clearRenderElements=function(){this._batchRenderElements.length=0},M$b.dispose=function(){},M$b._getVertexBuffer=function(M$a){return void 0===M$a&&(M$a=0),null},M$b._getIndexBuffer=function(){return null},M$b._beforeRender=function(M$a){return!0},M$b._render=function(M$a){},M$b._getVertexBuffers=function(){return null},M$o(0,M$b,"_vertexBufferCount",function(){return 1}),M$o(0,M$b,"triangleCount",function(){return 0}),M$a.combine=function(M$a){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),M$da.combine(M$a)},M$a.maxBatchVertexCount=65535,M$a}(),M$fa=function(){function M$g(M$a,M$b){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++M$g._uniqueIDCounter,this._id>M$g.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",M$g.maxVertexDeclaration);this._shaderValues=new M$mb,this._vertexElementsDic={},this._vertexStride=M$a,this._vertexElements=M$b;for(var M$c=0;M$c<M$b.length;M$c++){var M$d=M$b[M$c],M$e=M$d.elementUsage;this._vertexElementsDic[M$e]=M$d;var M$f=[M$g._getTypeSize(M$d.elementFormat)/4,5126,!1,this._vertexStride,M$d.offset];switch(this._shaderValues.setValue(M$e,M$f),M$e){case 1:this._addShaderDefine(M$Ab.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(M$Ab.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(M$Ab.SHADERDEFINE_UV1)}}}M$n(M$g,"laya.d3.graphics.VertexDeclaration");var M$a=M$g.prototype;return M$a._addShaderDefine=function(M$a){this._shaderDefineValue|=M$a},M$a._removeShaderDefine=function(M$a){this._shaderDefineValue&=~M$a},M$a.getVertexElements=function(){return this._vertexElements.slice()},M$a.getVertexElementByUsage=function(M$a){return this._vertexElementsDic[M$a]},M$a.unBinding=function(){},M$o(0,M$a,"shaderDefineValue",function(){return this._shaderDefineValue}),M$o(0,M$a,"id",function(){return this._id}),M$o(0,M$a,"vertexStride",function(){return this._vertexStride}),M$o(0,M$a,"shaderValues",function(){return this._shaderValues}),M$g._getTypeSize=function(M$a){switch(M$a){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},M$g.getVertexStride=function(M$a){for(var M$b=0,M$c=0;M$c<M$a.Length;M$c++){var M$d=M$a[M$c],M$e=M$d.offset+M$g._getTypeSize(M$d.elementFormat);M$b<M$e&&(M$b=M$e)}return M$b},M$g._maxVertexDeclarationBit=1e3,M$g._uniqueIDCounter=1,M$l(M$g,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),M$g}(),M$ga=function(){function M$a(M$a,M$b,M$c){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=M$a,this.elementFormat=M$b,this.elementUsage=M$c}return M$n(M$a,"laya.d3.graphics.VertexElement"),M$a}(),M$ha=(function(){function M$a(){}M$n(M$a,"laya.d3.graphics.VertexElementFormat"),M$a.Single="single",M$a.Vector2="vector2",M$a.Vector3="vector3",M$a.Vector4="vector4",M$a.Color="color",M$a.Byte4="byte4",M$a.Short2="short2",M$a.Short4="short4",M$a.NormalizedShort2="normalizedshort2",M$a.NormalizedShort4="normalizedshort4",M$a.HalfVector2="halfvector2",M$a.HalfVector4="halfvector4"}(),function(){function M$a(){}M$n(M$a,"laya.d3.graphics.VertexElementUsage"),M$a.POSITION0=0,M$a.COLOR0=1,M$a.TEXTURECOORDINATE0=2,M$a.NORMAL0=3,M$a.BINORMAL0=4,M$a.TANGENT0=5,M$a.BLENDINDICES0=6,M$a.BLENDWEIGHT0=7,M$a.DEPTH0=8,M$a.FOG0=9,M$a.POINTSIZE0=10,M$a.SAMPLE0=11,M$a.TESSELLATEFACTOR0=12,M$a.COLOR1=13,M$a.NEXTTEXTURECOORDINATE0=14,M$a.TEXTURECOORDINATE1=15,M$a.NEXTTEXTURECOORDINATE1=16,M$a.CORNERTEXTURECOORDINATE0=17,M$a.VELOCITY0=18,M$a.STARTCOLOR0=19,M$a.STARTSIZE=20,M$a.AGEADDSCALE0=21,M$a.STARTROTATION=22,M$a.ENDCOLOR0=23,M$a.STARTLIFETIME=24,M$a.TIME0=33,M$a.SHAPEPOSITIONSTARTLIFETIME=30,M$a.DIRECTIONTIME=32,M$a.SIZEROTATION0=27,M$a.RADIUS0=28,M$a.RADIAN0=29,M$a.STARTSPEED=31,M$a.RANDOM0=34,M$a.RANDOM1=35,M$a.SIMULATIONWORLDPOSTION=36,M$a.SIMULATIONWORLDROTATION=37,M$a.TEXTURECOORDINATE0X=38,M$a.TEXTURECOORDINATE0X1=39,M$a.TEXTURECOORDINATE0Y=40,M$a.OFFSETVECTOR=41}(),function(){function M$a(M$a,M$b,M$c){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=M$a,this._textureCoordinate0=M$b,this._time=M$c}M$n(M$a,"laya.d3.graphics.VertexGlitter");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate0}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"time",function(){return this._time}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(24,[new M$ga(0,"vector3",0),new M$ga(12,"vector2",2),new M$ga(20,"single",33)])}])}(),function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=M$a,this._position=M$b,this._velocity=M$c,this._startColor=M$d,this._endColor=M$e,this._sizeRotation=M$f,this._radius=M$g,this._radian=M$h,this._ageAddScale=M$i,this._time=M$j}M$n(M$a,"laya.d3.graphics.VertexParticle");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"endColor",function(){return this._endColor}),M$o(0,M$b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),M$o(0,M$b,"sizeRotation",function(){return this._sizeRotation}),M$o(0,M$b,"velocity",function(){return this._velocity}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"startColor",function(){return this._startColor}),M$o(0,M$b,"radius",function(){return this._radius}),M$o(0,M$b,"radian",function(){return this._radian}),M$o(0,M$b,"ageAddScale",function(){return this._ageAddScale}),M$o(0,M$b,"time",function(){return this._time}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(116,[new M$ga(0,"vector4",17),new M$ga(16,"vector3",0),new M$ga(28,"vector3",18),new M$ga(40,"vector4",19),new M$ga(56,"vector4",23),new M$ga(72,"vector3",27),new M$ga(84,"vector2",28),new M$ga(92,"vector4",29),new M$ga(108,"single",24),new M$ga(112,"single",33)])}])}(),function(){function M$a(M$a){this._position=null,this._position=M$a}M$n(M$a,"laya.d3.graphics.VertexPosition");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(12,[new M$ga(0,"vector3",0)])}]),M$a}()),M$ia=function(){function M$a(M$a,M$b){this._position=null,this._normal=null,this._position=M$a,this._normal=M$b}M$n(M$a,"laya.d3.graphics.VertexPositionNormal");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(24,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3)])}]),M$a}(),M$ja=function(){function M$a(M$a,M$b,M$c){this._position=null,this._normal=null,this._color=null,this._position=M$a,this._normal=M$b,this._color=M$c}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColor");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(40,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1)])}]),M$a}(),M$ka=function(){function M$a(M$a,M$b,M$c,M$d,M$e){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._blendIndex=M$d,this._blendWeight=M$e}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorSkin");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(72,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector4",7),new M$ga(56,"vector4",6)])}]),M$a}(),M$la=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._tangent=M$d,this._blendIndex=M$e,this._blendWeight=M$f}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(88,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector4",7),new M$ga(56,"vector4",6),new M$ga(72,"vector4",5)])}]),M$a}(),M$ma=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._tangent=M$d,this._blendIndex=M$e,this._blendWeight=M$f}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(84,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector4",7),new M$ga(56,"vector4",6),new M$ga(72,"vector3",5)])}]),M$a}(),M$na=function(){function M$a(M$a,M$b,M$c,M$d){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._tangent=M$d}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorSTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(56,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector4",5)])}]),M$a}(),M$oa=function(){function M$a(M$a,M$b,M$c,M$d){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._tangent=M$d}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(52,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector3",5)])}]),M$a}(),M$pa=function(){function M$a(M$a,M$b,M$c,M$d){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._textureCoordinate=M$d}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTexture");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(48,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector2",2)])}]),M$a}(),M$qa=function(){function M$a(M$a,M$b,M$c,M$d,M$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._textureCoordinate0=M$d,this._textureCoordinate1=M$e}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(56,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector2",2),new M$ga(48,"vector2",15)])}]),M$a}(),M$ra=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._textureCoordinate0=M$d,this._textureCoordinate1=M$e,this._blendIndex=M$f,this._blendWeight=M$g}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(88,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector2",2),new M$ga(48,"vector2",15),new M$ga(56,"vector4",7),new M$ga(72,"vector4",6)])}]),M$a}(),M$sa=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._textureCoordinate0=M$d,this._textureCoordinate1=M$e,this._tangent=M$f,this._blendIndex=M$g,this._blendWeight=M$h}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(104,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector2",2),new M$ga(48,"vector2",15),new M$ga(56,"vector4",7),new M$ga(72,"vector4",6),new M$ga(88,"vector4",5)])}]),M$a}(),M$ta=function(){function M$a(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$b.VertexPositionNormalColorTexture0SkinTangent=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){this._position=M$a,this._normal=M$b,this._color=M$c,this._textureCoordinate0=M$d,this._textureCoordinate1=M$e,this._tangent=M$f,this._blendIndex=M$g,this._blendWeight=M$h},M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(100,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector2",2),new M$ga(48,"vector2",15),new M$ga(56,"vector4",7),new M$ga(72,"vector4",6),new M$ga(88,"vector3",5)])}]),M$a}(),M$ua=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._textureCoordinate0=M$d,this._textureCoordinate1=M$e,this._tangent=M$f}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(72,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector2",2),new M$ga(48,"vector2",15),new M$ga(56,"vector4",5)])}]),M$a}(),M$va=function(){function M$a(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$b.VertexPositionNormalColorTexture0Tangent=function(M$a,M$b,M$c,M$d,M$e,M$f){this._position=M$a,this._normal=M$b,this._color=M$c,this._textureCoordinate0=M$d,this._textureCoordinate1=M$e,this._tangent=M$f},M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(68,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector2",2),new M$ga(48,"vector2",15),new M$ga(56,"vector3",5)])}]),M$a}(),M$wa=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._textureCoordinate=M$d,this._blendIndex=M$e,this._blendWeight=M$f}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(80,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector2",2),new M$ga(48,"vector4",7),new M$ga(64,"vector4",6)])}]),M$a}(),M$xa=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._textureCoordinate=M$d,this._tangent=M$e,this._blendIndex=M$f,this._blendWeight=M$g}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(96,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector2",2),new M$ga(48,"vector4",7),new M$ga(64,"vector4",6),new M$ga(80,"vector4",5)])}]),M$a}(),M$Aa=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._textureCoordinate=M$d,this._tangent=M$e,this._blendIndex=M$f,this._blendWeight=M$g}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(92,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector2",2),new M$ga(48,"vector4",7),new M$ga(64,"vector4",6),new M$ga(80,"vector3",5)])}]),M$a}(),M$Ba=function(){function M$a(M$a,M$b,M$c,M$d,M$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._textureCoordinate=M$d,this._tangent=M$e}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(64,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector2",2),new M$ga(48,"vector4",5)])}]),M$a}(),M$Ca=function(){function M$a(M$a,M$b,M$c,M$d,M$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._color=M$c,this._textureCoordinate=M$d,this._tangent=M$e}M$n(M$a,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"color",function(){return this._color}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(60,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",1),new M$ga(40,"vector2",2),new M$ga(48,"vector3",5)])}]),M$a}(),M$Da=function(){function M$a(M$a,M$b,M$c){this._position=null,this._normal=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._tangent=M$c}M$n(M$a,"laya.d3.graphics.VertexPositionNormalSTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(40,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector4",5)])}]),M$a}(),M$Ea=function(){function M$a(M$a,M$b,M$c){this._position=null,this._normal=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._tangent=M$c}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(36,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector3",5)])}]),M$a}(),M$Fa=function(){function M$a(M$a,M$b,M$c){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=M$a,this._normal=M$b,this._textureCoordinate=M$c}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTexture");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(32,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2)])}]),M$a}(),M$Ga=function(){function M$a(M$a,M$b,M$c,M$d){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=M$a,this._normal=M$b,this._textureCoordinate0=M$c,this._textureCoordinate1=M$d}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(40,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2),new M$ga(32,"vector2",15)])}]),M$a}(),M$Ha=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=M$a,this._normal=M$b,this._textureCoordinate0=M$c,this._textureCoordinate1=M$d,this._blendIndex=M$e,this._blendWeight=M$f}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(72,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2),new M$ga(32,"vector2",15),new M$ga(40,"vector4",7),new M$ga(56,"vector4",6)])}]),M$a}(),M$Ia=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._textureCoordinate0=M$c,this._textureCoordinate1=M$d,this._tangent=M$e,this._blendIndex=M$f,this._blendWeight=M$g}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(88,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2),new M$ga(32,"vector2",15),new M$ga(40,"vector4",7),new M$ga(56,"vector4",6),new M$ga(72,"vector4",5)])}]),M$a}(),M$Ja=function(){function M$a(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$b.VertexPositionNormalTexture0SkinTangent=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){this._position=M$a,this._normal=M$b,this._textureCoordinate0=M$c,this._textureCoordinate1=M$d,this._tangent=M$e,this._blendIndex=M$f,this._blendWeight=M$g},M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(84,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2),new M$ga(32,"vector2",15),new M$ga(40,"vector4",7),new M$ga(56,"vector4",6),new M$ga(72,"vector3",5)])}]),M$a}(),M$Ka=function(){function M$a(M$a,M$b,M$c,M$d,M$e){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._textureCoordinate0=M$c,this._textureCoordinate1=M$d,this._tangent=M$e}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(56,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2),new M$ga(32,"vector2",15),new M$ga(40,"vector4",5)])}]),M$a}(),M$La=function(){function M$a(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$b.VertexPositionNormalTexture0Tangent=function(M$a,M$b,M$c,M$d,M$e){this._position=M$a,this._normal=M$b,this._textureCoordinate0=M$c,this._textureCoordinate1=M$d,this._tangent=M$e},M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(52,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2),new M$ga(32,"vector2",15),new M$ga(40,"vector3",5)])}]),M$a}(),M$Ma=function(){function M$a(M$a,M$b,M$c,M$d,M$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=M$a,this._normal=M$b,this._textureCoordinate=M$c,this._blendIndex=M$d,this._blendWeight=M$e}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTextureSkin");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(64,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2),new M$ga(32,"vector4",7),new M$ga(48,"vector4",6)])}]),M$a}(),M$Na=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._textureCoordinate=M$c,this._tangent=M$d,this._blendIndex=M$e,this._blendWeight=M$f}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(80,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2),new M$ga(32,"vector4",7),new M$ga(48,"vector4",6),new M$ga(64,"vector4",5)])}]),M$a}(),M$Oa=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._textureCoordinate=M$c,this._tangent=M$d,this._blendIndex=M$e,this._blendWeight=M$f}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(76,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2),new M$ga(32,"vector4",7),new M$ga(48,"vector4",6),new M$ga(64,"vector3",5)])}]),M$a}(),M$Pa=function(){function M$a(M$a,M$b,M$c,M$d){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._textureCoordinate=M$c,this._tangent=M$d}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(48,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2),new M$ga(32,"vector4",5)])}]),M$a}(),M$Qa=function(){function M$a(M$a,M$b,M$c,M$d){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=M$a,this._normal=M$b,this._textureCoordinate=M$c,this._tangent=M$d}M$n(M$a,"laya.d3.graphics.VertexPositionNormalTextureTangent");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(44,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2),new M$ga(32,"vector3",5)])}]),M$a}(),M$Ra=function(){function M$a(M$a,M$b,M$c){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=M$a,this._normal=M$b,this._textureCoordinate=M$c}M$n(M$a,"laya.d3.graphics.VertexPositionNTBTexture");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(56,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector3",5),new M$ga(36,"vector3",4),new M$ga(48,"vector2",2)])}]),M$a}(),M$Sa=function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=M$a,this._normal=M$b,this._textureCoordinate0=M$d,this._textureCoordinate1=M$e,this._tangent=M$f,M$c=M$c,this._blendIndex=M$g,this._blendWeight=M$h}M$n(M$a,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"tangent",function(){return this._tangent}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(0,M$b,"textureCoordinate1",function(){return this._textureCoordinate1}),M$o(0,M$b,"blendIndex",function(){return this._blendIndex}),M$o(0,M$b,"blendWeight",function(){return this._blendWeight}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(96,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector3",5),new M$ga(36,"vector3",4),new M$ga(48,"vector2",2),new M$ga(56,"vector2",15),new M$ga(64,"vector4",7),new M$ga(80,"vector4",6)])}]),M$a}(),M$Ta=function(){function M$a(M$a,M$b,M$c){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=M$a,this._normal=M$b,this._textureCoordinate=M$c}M$n(M$a,"laya.d3.graphics.VertexPositionNTBTextureSkin");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"textureCoordinate",function(){return this._textureCoordinate}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(88,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector3",5),new M$ga(36,"vector3",4),new M$ga(48,"vector2",2),new M$ga(56,"vector4",7),new M$ga(72,"vector4",6)])}]),M$a}(),M$Ua=(function(){function M$a(M$a,M$b,M$c,M$d){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=M$a,this._normal=M$b,this._textureCoord0=M$c,this._textureCoord1=M$d}M$n(M$a,"laya.d3.graphics.VertexPositionTerrain");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"normal",function(){return this._normal}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"textureCoord0",function(){return this._textureCoord0}),M$o(0,M$b,"textureCoord1",function(){return this._textureCoord1}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(40,[new M$ga(0,"vector3",0),new M$ga(12,"vector3",3),new M$ga(24,"vector2",2),new M$ga(32,"vector2",15)])}])}(),function(){function M$a(M$a,M$b){this._position=null,this._textureCoordinate0=null,this._position=M$a,this._textureCoordinate0=M$b}M$n(M$a,"laya.d3.graphics.VertexPositionTexture0");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"position",function(){return this._position}),M$o(0,M$b,"textureCoordinate0",function(){return this._textureCoordinate0}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(20,[new M$ga(0,"vector3",0),new M$ga(12,"vector2",2)])}]),M$a}()),M$Va=(function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$l,M$m,M$n){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=M$a,this._positionStartLifeTime=M$b,this._velocity=M$c,this._startColor=M$d,this._startSize=M$e,this._startRotation0=M$f,this._startRotation1=M$g,this._startRotation2=M$h,this._startLifeTime=M$i,this._time=M$j,this._startSpeed=M$k,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=M$n}M$n(M$a,"laya.d3.graphics.VertexShurikenParticleBillboard");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),M$o(0,M$b,"random1",function(){return this._randoms1}),M$o(0,M$b,"startRotation2",function(){return this._startRotation2}),M$o(0,M$b,"positionStartLifeTime",function(){return this._positionStartLifeTime}),M$o(0,M$b,"velocity",function(){return this._velocity}),M$o(0,M$b,"random0",function(){return this._randoms0}),M$o(0,M$b,"startSize",function(){return this._startSize}),M$o(0,M$b,"startColor",function(){return this._startColor}),M$o(0,M$b,"startRotation0",function(){return this._startRotation0}),M$o(0,M$b,"startRotation1",function(){return this._startRotation1}),M$o(0,M$b,"startLifeTime",function(){return this._startLifeTime}),M$o(0,M$b,"time",function(){return this._time}),M$o(0,M$b,"startSpeed",function(){return this._startSpeed}),M$o(0,M$b,"simulationWorldPostion",function(){return this._simulationWorldPostion}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(152,[new M$ga(0,"vector4",17),new M$ga(16,"vector4",30),new M$ga(32,"vector4",32),new M$ga(48,"vector4",19),new M$ga(64,"vector3",20),new M$ga(76,"vector3",22),new M$ga(88,"single",31),new M$ga(92,"vector4",34),new M$ga(108,"vector4",35),new M$ga(124,"vector3",36),new M$ga(136,"vector4",37)])}])}(),function(){function M$a(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$l,M$m,M$n){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=M$a,this._positionStartLifeTime=M$b,this._velocity=M$c,this._startColor=M$d,this._startSize=M$e,this._startRotation0=M$f,this._startRotation1=M$g,this._startRotation2=M$h,this._startLifeTime=M$i,this._time=M$j,this._startSpeed=M$k,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=M$n}M$n(M$a,"laya.d3.graphics.VertexShurikenParticleMesh");var M$b=M$a.prototype;M$v.imps(M$b,{"laya.d3.graphics.IVertex":!0}),M$o(0,M$b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),M$o(0,M$b,"velocity",function(){return this._velocity}),M$o(0,M$b,"position",function(){return this._positionStartLifeTime}),M$o(0,M$b,"random0",function(){return this._randoms0}),M$o(0,M$b,"startSize",function(){return this._startSize}),M$o(0,M$b,"startColor",function(){return this._startColor}),M$o(0,M$b,"startRotation0",function(){return this._startRotation0}),M$o(0,M$b,"startRotation1",function(){return this._startRotation1}),M$o(0,M$b,"random1",function(){return this._randoms1}),M$o(0,M$b,"startRotation2",function(){return this._startRotation2}),M$o(0,M$b,"startLifeTime",function(){return this._startLifeTime}),M$o(0,M$b,"time",function(){return this._time}),M$o(0,M$b,"startSpeed",function(){return this._startSpeed}),M$o(0,M$b,"simulationWorldPostion",function(){return this._simulationWorldPostion}),M$o(0,M$b,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$o(1,M$a,"vertexDeclaration",function(){return M$a._vertexDeclaration}),M$l(M$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new M$fa(172,[new M$ga(0,"vector3",0),new M$ga(12,"vector4",1),new M$ga(28,"vector2",2),new M$ga(36,"vector4",30),new M$ga(52,"vector4",32),new M$ga(68,"vector4",19),new M$ga(84,"vector3",20),new M$ga(96,"vector3",22),new M$ga(108,"single",31),new M$ga(112,"vector4",34),new M$ga(128,"vector4",35),new M$ga(144,"vector3",36),new M$ga(156,"vector4",37)])}])}(),function(){function M$t(M$a,M$b,M$c,M$d,M$e,M$f){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=M$c,this._materials=M$d,this._subMeshes=M$e,this._materialMap=M$f,this._version=M$b,this._onLoaded(M$a)}M$n(M$t,"laya.d3.loaders.LoadModelV01");var M$a=M$t.prototype;return M$a._onLoaded=function(M$a){this._readData=M$a,this.READ_BLOCK();for(var M$b=0;M$b<this._BLOCK.count;M$b++){var M$c=this._readData.getUint16(),M$d=this._strings[M$c],M$e=this["READ_"+M$d];if(null==M$e)throw new Error("model file err,no this function:"+M$c+" "+M$d);if(!M$e.call(this))break}return this._mesh},M$a.onError=function(){},M$a._readString=function(){return this._strings[this._readData.getUint16()]},M$a.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},M$a.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},M$a.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var M$a=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var M$b=0;M$b<this._STRINGS.size;M$b++)this._strings[M$b]=this._readData.readUTFString();return this._readData.pos=M$a,!0},M$a.READ_MATERIAL=function(){var M$a=this._readData.getUint16(),M$b=(this._readString(),this._readString());return this._materials[M$a]="null"!==M$b?M$r.getRes(this._materialMap[M$b]):new M$Eb,!0},M$a.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var M$a,M$b=this._readData.__getBuffer(),M$c=0,M$d=this._readData.getUint32(),M$e=this._readData.getUint32(),M$f=(new Float32Array(M$b.slice(M$d+this._DATA.offset,M$d+this._DATA.offset+M$e)),this._readData.getUint32()),M$g=this._readData.getUint32(),M$h=new Float32Array(M$b.slice(M$f+this._DATA.offset,M$f+this._DATA.offset+M$g));for(this.mesh._inverseBindPoses=[],M$c=0,M$a=M$h.length;M$c<M$a;M$c+=16){var M$i=new M$ab(M$h[M$c+0],M$h[M$c+1],M$h[M$c+2],M$h[M$c+3],M$h[M$c+4],M$h[M$c+5],M$h[M$c+6],M$h[M$c+7],M$h[M$c+8],M$h[M$c+9],M$h[M$c+10],M$h[M$c+11],M$h[M$c+12],M$h[M$c+13],M$h[M$c+14],M$h[M$c+15]);this.mesh._inverseBindPoses.push(M$i)}break;default:throw new Error("LoadModel:unknown version.")}return!0},M$a.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var M$a=this._readString();this._shaderAttributes=M$a.match(M$t._attrReg);var M$b=this._readData.getUint32(),M$c=this._readData.getUint32(),M$d=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),M$e=this._readData.getUint32(),M$f=this._readData.getUint32(),M$g=this._readData.getUint32(),M$h=this._readData.__getBuffer(),M$i=new M$jb(this._mesh),M$j=this._getVertexDeclaration(),M$k=M$Ob.create(M$j,M$e/M$j.vertexStride,35044,!0),M$l=M$d+this._DATA.offset,M$m=M$h.slice(M$l,M$l+M$e);M$k.setData(new Float32Array(M$m));for(var M$n=(M$i._vertexBuffer=M$k).vertexDeclaration.getVertexElements(),M$o=0;M$o<M$n.length;M$o++)M$i._bufferUsage[M$n[M$o].elementUsage]=M$k;var M$p=M$Nb.create("ushort",M$c/2,35044,!0),M$q=M$b+this._DATA.offset,M$r=M$h.slice(M$q,M$q+M$c);M$p.setData(new Uint16Array(M$r)),M$i._indexBuffer=M$p;var M$s=M$h.slice(M$f+this._DATA.offset,M$f+this._DATA.offset+M$g);return M$i._boneIndicesList[0]=new Uint8Array(M$s),this._subMeshes.push(M$i),!0},M$a.READ_DATAAREA=function(){return!1},M$a._getVertexDeclaration=function(){for(var M$a,M$b=!1,M$c=!1,M$d=!1,M$e=!1,M$f=!1,M$g=!1,M$h=!1,M$i=!1,M$j=!1,M$k=0;M$k<this._shaderAttributes.length;M$k+=8)switch(this._shaderAttributes[M$k]){case"POSITION":M$b=!0;break;case"NORMAL":M$c=!0;break;case"COLOR":M$d=!0;break;case"UV":M$e=!0;break;case"UV1":M$f=!0;break;case"BLENDWEIGHT":M$h=!0;break;case"BLENDINDICES":M$i=!0;break;case"TANGENT":M$g=!0;break;case"BINORMAL":M$j=!0}return M$b&&M$c&&M$d&&M$e&&M$f&&M$h&&M$i&&M$g?M$a=M$ta.vertexDeclaration:M$b&&M$c&&M$d&&M$e&&M$f&&M$h&&M$i?M$a=M$ra.vertexDeclaration:M$b&&M$c&&M$e&&M$f&&M$h&&M$i&&M$g?M$a=M$Ja.vertexDeclaration:M$b&&M$c&&M$e&&M$f&&M$h&&M$i?M$a=M$Ha.vertexDeclaration:M$b&&M$c&&M$d&&M$e&&M$h&&M$i&&M$g?M$a=M$Aa.vertexDeclaration:M$b&&M$c&&M$d&&M$e&&M$h&&M$i?M$a=M$wa.vertexDeclaration:M$b&&M$c&&M$g&&M$j&&M$e&&M$h&&M$i?M$a=M$Ta.vertexDeclaration:M$b&&M$c&&M$e&&M$h&&M$i&&M$g?M$a=M$Oa.vertexDeclaration:M$b&&M$c&&M$e&&M$h&&M$i?M$a=M$Ma.vertexDeclaration:M$b&&M$c&&M$d&&M$h&&M$i&&M$g?M$a=M$ma.vertexDeclaration:M$b&&M$c&&M$d&&M$h&&M$i?M$a=M$ka.vertexDeclaration:M$b&&M$c&&M$d&&M$e&&M$f&&M$g?M$a=M$va.vertexDeclaration:M$b&&M$c&&M$d&&M$e&&M$f?M$a=M$qa.vertexDeclaration:M$b&&M$c&&M$e&&M$f&&M$g?M$a=M$La.vertexDeclaration:M$b&&M$c&&M$e&&M$f?M$a=M$Ga.vertexDeclaration:M$b&&M$c&&M$d&&M$e&&M$g?M$a=M$Ca.vertexDeclaration:M$b&&M$c&&M$e&&M$g&&M$j?M$a=M$Ra.vertexDeclaration:M$b&&M$c&&M$d&&M$e?M$a=M$pa.vertexDeclaration:M$b&&M$c&&M$e&&M$g?M$a=M$Qa.vertexDeclaration:M$b&&M$c&&M$e?M$a=M$Fa.vertexDeclaration:M$b&&M$c&&M$d&&M$g?M$a=M$oa.vertexDeclaration:M$b&&M$c&&M$d&&(M$a=M$ja.vertexDeclaration),M$a},M$o(0,M$a,"mesh",function(){return this._mesh}),M$t._attrReg=new RegExp("(\\w+)|([:,;])","g"),M$t}()),M$Wa=function(){function M$x(){}return M$n(M$x,"laya.d3.loaders.LoadModelV02"),M$x.parse=function(M$a,M$b,M$c,M$d,M$e,M$f){M$x._mesh=M$c,M$x._materials=M$d,M$x._subMeshes=M$e,M$x._materialMap=M$f,M$x._version=M$b,M$x._readData=M$a,M$x.READ_DATA(),M$x.READ_BLOCK(),M$x.READ_STRINGS();for(var M$g=0,M$h=M$x._BLOCK.count;M$g<M$h;M$g++){M$x._readData.pos=M$x._BLOCK.blockStarts[M$g];var M$i=M$x._readData.getUint16(),M$j=M$x._strings[M$i],M$k=M$x["READ_"+M$j];if(null==M$k)throw new Error("model file err,no this function:"+M$i+" "+M$j);M$k.call()}M$x._strings.length=0,M$x._readData=null,M$x._version=null,M$x._mesh=null,M$x._materials=null,M$x._subMeshes=null,M$x._materialMap=null},M$x._readString=function(){return M$x._strings[M$x._readData.getUint16()]},M$x.READ_DATA=function(){M$x._DATA.offset=M$x._readData.getUint32(),M$x._DATA.size=M$x._readData.getUint32()},M$x.READ_BLOCK=function(){for(var M$a=M$x._BLOCK.count=M$x._readData.getUint16(),M$b=M$x._BLOCK.blockStarts=[],M$c=M$x._BLOCK.blockLengths=[],M$d=0;M$d<M$a;M$d++)M$b.push(M$x._readData.getUint32()),M$c.push(M$x._readData.getUint32())},M$x.READ_STRINGS=function(){var M$a=M$x._readData.getUint32(),M$b=M$x._readData.getUint16(),M$c=M$x._readData.pos;M$x._readData.pos=M$a+M$x._DATA.offset;for(var M$d=0;M$d<M$b;M$d++)M$x._strings[M$d]=M$x._readData.readUTFString();M$x._readData.pos=M$c},M$x.READ_MATERIAL=function(){M$x._readString(),M$x._readString();var M$a=M$x._readString();return""!==M$a&&M$x._materials.push(M$r.getRes(M$x._materialMap[M$a])),!0},M$x.READ_MESH=function(){M$x._readString();var M$a,M$b=M$x._readData.__getBuffer(),M$c=0,M$d=M$x._readData.getInt16(),M$e=M$x._DATA.offset;for(M$c=0;M$c<M$d;M$c++){var M$f=M$e+M$x._readData.getUint32(),M$g=M$x._readData.getUint32(),M$h=new Float32Array(M$b.slice(M$f,M$f+M$g)),M$i=M$x._readString().match(M$x._attrReg),M$j=M$x._getVertexDeclaration(M$i),M$k=M$Ob.create(M$j,4*M$h.length/M$j.vertexStride,35044,!0);M$k.setData(M$h),M$x._mesh._vertexBuffers.push(M$k)}var M$l=M$e+M$x._readData.getUint32(),M$m=M$x._readData.getUint32(),M$n=new Uint16Array(M$b.slice(M$l,M$l+M$m)),M$o=M$Nb.create("ushort",M$m/2,35044,!0);M$o.setData(M$n),M$x._mesh._indexBuffer=M$o;var M$p=M$x._mesh._boneNames=[],M$q=M$x._readData.getUint16();for(M$p.length=M$q,M$c=0;M$c<M$q;M$c++)M$p[M$c]=M$x._strings[M$x._readData.getUint16()];var M$r=M$x._readData.getUint32(),M$s=M$x._readData.getUint32(),M$t=(new Float32Array(M$b.slice(M$e+M$r,M$e+M$r+M$s)),M$x._readData.getUint32()),M$u=M$x._readData.getUint32(),M$v=new Float32Array(M$b.slice(M$e+M$t,M$e+M$t+M$u));for(M$x._mesh._inverseBindPoses=[],M$c=0,M$a=M$v.length;M$c<M$a;M$c+=16){var M$w=new M$ab(M$v[M$c+0],M$v[M$c+1],M$v[M$c+2],M$v[M$c+3],M$v[M$c+4],M$v[M$c+5],M$v[M$c+6],M$v[M$c+7],M$v[M$c+8],M$v[M$c+9],M$v[M$c+10],M$v[M$c+11],M$v[M$c+12],M$v[M$c+13],M$v[M$c+14],M$v[M$c+15]);M$x._mesh._inverseBindPoses.push(M$w)}return M$x._mesh._skinnedDatas=new Float32Array(16*M$v.length),!0},M$x.READ_SUBMESH=function(){var M$a=M$x._readData.__getBuffer(),M$b=new M$jb(M$x._mesh),M$c=M$x._readData.getInt16(),M$d=M$x._readData.getUint32(),M$e=M$x._readData.getUint32();M$b._vertexBuffer=M$x._mesh._vertexBuffers[M$c],M$b._vertexStart=M$d,M$b._vertexCount=M$e;var M$f=M$x._readData.getUint32(),M$g=M$x._readData.getUint32(),M$h=M$x._mesh._indexBuffer;M$b._indexBuffer=M$h,M$b._indexStart=M$f,M$b._indexCount=M$g,M$b._indices=new Uint16Array(M$h.getData().buffer,2*M$f,M$g);var M$i=M$x._DATA.offset,M$j=M$b._subIndexBufferStart,M$k=M$b._subIndexBufferCount,M$l=M$b._boneIndicesList,M$m=M$x._readData.getUint16();M$j.length=M$m,M$k.length=M$m,M$l.length=M$m;for(var M$n=0;M$n<M$m;M$n++){M$j[M$n]=M$x._readData.getUint32(),M$k[M$n]=M$x._readData.getUint32();var M$o=M$x._readData.getUint32(),M$p=M$x._readData.getUint32();M$b._boneIndicesList[M$n]=new Uint8Array(M$a.slice(M$i+M$o,M$i+M$o+M$p))}return M$x._subMeshes.push(M$b),!0},M$x._getVertexDeclaration=function(M$a){for(var M$b,M$c=!1,M$d=!1,M$e=!1,M$f=!1,M$g=!1,M$h=!1,M$i=!1,M$j=!1,M$k=!1,M$l=0;M$l<M$a.length;M$l++)switch(M$a[M$l]){case"POSITION":M$c=!0;break;case"NORMAL":M$d=!0;break;case"COLOR":M$e=!0;break;case"UV":M$f=!0;break;case"UV1":M$g=!0;break;case"BLENDWEIGHT":M$i=!0;break;case"BLENDINDICES":M$j=!0;break;case"TANGENT":M$h=!0;break;case"BINORMAL":M$k=!0}return M$c&&M$d&&M$e&&M$f&&M$g&&M$i&&M$j&&M$h?M$b=M$ta.vertexDeclaration:M$c&&M$d&&M$e&&M$f&&M$g&&M$i&&M$j?M$b=M$ra.vertexDeclaration:M$c&&M$d&&M$f&&M$g&&M$i&&M$j&&M$h?M$b=M$Ja.vertexDeclaration:M$c&&M$d&&M$f&&M$g&&M$i&&M$j?M$b=M$Ha.vertexDeclaration:M$c&&M$d&&M$e&&M$f&&M$i&&M$j&&M$h?M$b=M$Aa.vertexDeclaration:M$c&&M$d&&M$e&&M$f&&M$i&&M$j?M$b=M$wa.vertexDeclaration:M$c&&M$d&&M$f&&M$i&&M$j&&M$h?M$b=M$Oa.vertexDeclaration:M$c&&M$d&&M$f&&M$i&&M$j?M$b=M$Ma.vertexDeclaration:M$c&&M$d&&M$e&&M$i&&M$j&&M$h?M$b=M$ma.vertexDeclaration:M$c&&M$d&&M$e&&M$i&&M$j?M$b=M$ka.vertexDeclaration:M$c&&M$d&&M$e&&M$f&&M$g&&M$h?M$b=M$va.vertexDeclaration:M$c&&M$d&&M$e&&M$f&&M$g?M$b=M$qa.vertexDeclaration:M$c&&M$d&&M$f&&M$g&&M$h?M$b=M$La.vertexDeclaration:M$c&&M$d&&M$f&&M$g?M$b=M$Ga.vertexDeclaration:M$c&&M$d&&M$e&&M$f&&M$h?M$b=M$Ca.vertexDeclaration:M$c&&M$d&&M$f&&M$h&&M$k?M$b=M$Ra.vertexDeclaration:M$c&&M$d&&M$e&&M$f?M$b=M$pa.vertexDeclaration:M$c&&M$d&&M$f&&M$h?M$b=M$Qa.vertexDeclaration:M$c&&M$d&&M$f?M$b=M$Fa.vertexDeclaration:M$c&&M$d&&M$e&&M$h?M$b=M$oa.vertexDeclaration:M$c&&M$d&&M$e&&(M$b=M$ja.vertexDeclaration),M$b},M$x._attrReg=new RegExp("(\\w+)|([:,;])","g"),M$x._strings=[],M$x._readData=null,M$x._version=null,M$x._mesh=null,M$x._materials=null,M$x._subMeshes=null,M$x._materialMap=null,M$l(M$x,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),M$x}(),M$Xa=function(){function M$w(){}return M$n(M$w,"laya.d3.loaders.LoadModelV03"),M$w.parse=function(M$a,M$b,M$c,M$d,M$e){M$w._mesh=M$c,M$w._subMeshes=M$d,M$w._materialMap=M$e,M$w._version=M$b,M$w._readData=M$a,M$w.READ_DATA(),M$w.READ_BLOCK(),M$w.READ_STRINGS();for(var M$f=0,M$g=M$w._BLOCK.count;M$f<M$g;M$f++){M$w._readData.pos=M$w._BLOCK.blockStarts[M$f];var M$h=M$w._readData.getUint16(),M$i=M$w._strings[M$h],M$j=M$w["READ_"+M$i];if(null==M$j)throw new Error("model file err,no this function:"+M$h+" "+M$i);M$j.call()}M$w._strings.length=0,M$w._readData=null,M$w._version=null,M$w._mesh=null,M$w._subMeshes=null,M$w._materialMap=null},M$w._readString=function(){return M$w._strings[M$w._readData.getUint16()]},M$w.READ_DATA=function(){M$w._DATA.offset=M$w._readData.getUint32(),M$w._DATA.size=M$w._readData.getUint32()},M$w.READ_BLOCK=function(){for(var M$a=M$w._BLOCK.count=M$w._readData.getUint16(),M$b=M$w._BLOCK.blockStarts=[],M$c=M$w._BLOCK.blockLengths=[],M$d=0;M$d<M$a;M$d++)M$b.push(M$w._readData.getUint32()),M$c.push(M$w._readData.getUint32())},M$w.READ_STRINGS=function(){var M$a=M$w._readData.getUint32(),M$b=M$w._readData.getUint16(),M$c=M$w._readData.pos;M$w._readData.pos=M$a+M$w._DATA.offset;for(var M$d=0;M$d<M$b;M$d++)M$w._strings[M$d]=M$w._readData.readUTFString();M$w._readData.pos=M$c},M$w.READ_MESH=function(){var M$a,M$b=M$w._readString(),M$c=M$w._readData.__getBuffer(),M$d=0,M$e=M$w._readData.getInt16(),M$f=M$w._DATA.offset;for(M$d=0;M$d<M$e;M$d++){var M$g,M$h=M$f+M$w._readData.getUint32(),M$i=M$w._readData.getUint32(),M$j=new Float32Array(M$c.slice(M$h,M$h+M$i)),M$k=M$w._readString();switch(M$w._version){case"LAYAMODEL:03":M$g=M$w._vertexDeclarationMap_Discard[M$k];break;case"LAYAMODEL:0301":M$g=M$w._vertexDeclarationMap[M$k];break;default:throw new Error("LoadModelV03: unknown version.")}if(!M$g)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+M$w._version+"  bufferAttribute="+M$k+"  name="+M$b+"  url="+(M$w._mesh?M$w._mesh.url:"null"));var M$l=M$Ob.create(M$g,4*M$j.length/M$g.vertexStride,35044,!0,M$w._mesh._url+"_"+M$d);M$l.setData(M$j),M$w._mesh._vertexBuffers.push(M$l)}var M$m=M$f+M$w._readData.getUint32(),M$n=M$w._readData.getUint32(),M$o=new Uint16Array(M$c.slice(M$m,M$m+M$n)),M$p=M$Nb.create("ushort",M$n/2,35044,!0,M$w._mesh._url);M$p.setData(M$o),M$w._mesh._indexBuffer=M$p;var M$q=M$w._mesh._boneNames=[],M$r=M$w._readData.getUint16();for(M$q.length=M$r,M$d=0;M$d<M$r;M$d++)M$q[M$d]=M$w._strings[M$w._readData.getUint16()];M$w._readData.pos+=8;var M$s=M$w._readData.getUint32(),M$t=M$w._readData.getUint32(),M$u=new Float32Array(M$c.slice(M$f+M$s,M$f+M$s+M$t));for(M$w._mesh._inverseBindPoses=[],M$d=0,M$a=M$u.length;M$d<M$a;M$d+=16){var M$v=new M$ab(M$u[M$d+0],M$u[M$d+1],M$u[M$d+2],M$u[M$d+3],M$u[M$d+4],M$u[M$d+5],M$u[M$d+6],M$u[M$d+7],M$u[M$d+8],M$u[M$d+9],M$u[M$d+10],M$u[M$d+11],M$u[M$d+12],M$u[M$d+13],M$u[M$d+14],M$u[M$d+15]);M$w._mesh._inverseBindPoses.push(M$v)}return M$w._mesh._skinnedDatas=new Float32Array(16*M$u.length),!0},M$w.READ_SUBMESH=function(){var M$a=M$w._readData.__getBuffer(),M$b=new M$jb(M$w._mesh),M$c=M$w._readData.getInt16(),M$d=M$w._readData.getUint32(),M$e=M$w._readData.getUint32();M$b._vertexBuffer=M$w._mesh._vertexBuffers[M$c],M$b._vertexStart=M$d,M$b._vertexCount=M$e;var M$f=M$w._readData.getUint32(),M$g=M$w._readData.getUint32(),M$h=M$w._mesh._indexBuffer;M$b._indexBuffer=M$h,M$b._indexStart=M$f,M$b._indexCount=M$g,M$b._indices=new Uint16Array(M$h.getData().buffer,2*M$f,M$g);var M$i=M$w._DATA.offset,M$j=M$b._subIndexBufferStart,M$k=M$b._subIndexBufferCount,M$l=M$b._boneIndicesList,M$m=M$w._readData.getUint16();M$j.length=M$m,M$k.length=M$m,M$l.length=M$m;for(var M$n=0;M$n<M$m;M$n++){M$j[M$n]=M$w._readData.getUint32(),M$k[M$n]=M$w._readData.getUint32();var M$o=M$w._readData.getUint32(),M$p=M$w._readData.getUint32();M$l[M$n]=new Uint8Array(M$a.slice(M$i+M$o,M$i+M$o+M$p))}return M$w._subMeshes.push(M$b),!0},M$w._strings=[],M$w._readData=null,M$w._version=null,M$w._mesh=null,M$w._subMeshes=null,M$w._materialMap=null,M$l(M$w,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":M$ta.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":M$ra.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":M$Sa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":M$Ja.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":M$Ha.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":M$Aa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":M$wa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":M$Oa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":M$Ma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":M$ma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":M$ka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":M$va.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":M$qa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":M$La.vertexDeclaration,"POSITION,NORMAL,UV,UV1":M$Ga.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":M$Ca.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":M$Ra.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":M$pa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":M$Qa.vertexDeclaration,"POSITION,NORMAL,UV":M$Fa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":M$oa.vertexDeclaration,"POSITION,NORMAL,COLOR":M$ja.vertexDeclaration,"POSITION,NORMAL,TANGENT":M$Ea.vertexDeclaration,"POSITION,NORMAL":M$ia.vertexDeclaration,"POSITION,UV":M$Ua.vertexDeclaration,POSITION:M$ha.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":M$sa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":M$ra.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":M$Sa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":M$Ia.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":M$Ha.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":M$xa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":M$wa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":M$Na.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":M$Ma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":M$la.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":M$ka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":M$ua.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":M$qa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":M$Ka.vertexDeclaration,"POSITION,NORMAL,UV,UV1":M$Ga.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":M$Ba.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":M$Ra.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":M$pa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":M$Pa.vertexDeclaration,"POSITION,NORMAL,UV":M$Fa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":M$na.vertexDeclaration,"POSITION,NORMAL,COLOR":M$ja.vertexDeclaration,"POSITION,NORMAL,TANGENT":M$Da.vertexDeclaration,"POSITION,NORMAL":M$ia.vertexDeclaration,"POSITION,UV":M$Ua.vertexDeclaration,POSITION:M$ha.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),M$w}(),M$Ya=function(){function M$h(){}return M$n(M$h,"laya.d3.loaders.MeshReader"),M$h.read=function(M$a,M$b,M$c,M$d,M$e){var M$f=new M$w(M$a);M$f.pos=0;var M$g=M$f.readUTFString();switch(M$g){case"LAYAMODEL:01":case"LAYASKINANI:01":M$h._readVersion01(M$f,M$g,M$b,M$c,M$d,M$e);break;case"LAYAMODEL:02":M$Wa.parse(M$f,M$g,M$b,M$c,M$d,M$e);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":M$Xa.parse(M$f,M$g,M$b,M$d,M$e);break;default:throw new Error("MeshReader: unknown mesh version.")}M$b._setSubMeshes(M$d)},M$h._readVersion01=function(M$a,M$b,M$c,M$d,M$e,M$f){new M$Va(M$a,M$b,M$c,M$d,M$e,M$f)},M$h}(),M$Za=function(){function M$a(M$a,M$b){this.min=null,this.max=null,this.min=M$a,this.max=M$b}M$n(M$a,"laya.d3.math.BoundBox");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b.getCorners=function(M$a){M$a.length=8;var M$b=this.min.elements,M$c=this.max.elements,M$d=M$b[0],M$e=M$b[1],M$f=M$b[2],M$g=M$c[0],M$h=M$c[1],M$i=M$c[2];M$a[0]=new M$gb(M$d,M$h,M$i),M$a[1]=new M$gb(M$g,M$h,M$i),M$a[2]=new M$gb(M$g,M$e,M$i),M$a[3]=new M$gb(M$d,M$e,M$i),M$a[4]=new M$gb(M$d,M$h,M$f),M$a[5]=new M$gb(M$g,M$h,M$f),M$a[6]=new M$gb(M$g,M$e,M$f),M$a[7]=new M$gb(M$d,M$e,M$f)},M$b.toDefault=function(){this.min.toDefault(),this.max.toDefault()},M$b.cloneTo=function(M$a){var M$b=M$a;this.min.cloneTo(M$b.min),this.max.cloneTo(M$b.max)},M$b.clone=function(){var M$a=new this.constructor(new M$gb,new M$gb);return this.cloneTo(M$a),M$a},M$a.createfromPoints=function(M$a,M$b){if(null==M$a)throw new Error("points");var M$c=M$b.min,M$d=M$b.max,M$e=M$c.elements;M$e[0]=Number.MAX_VALUE,M$e[1]=Number.MAX_VALUE,M$e[2]=Number.MAX_VALUE;var M$f=M$d.elements;M$f[0]=-Number.MAX_VALUE,M$f[1]=-Number.MAX_VALUE,M$f[2]=-Number.MAX_VALUE;for(var M$g=0,M$h=M$a.length;M$g<M$h;++M$g)M$gb.min(M$c,M$a[M$g],M$c),M$gb.max(M$d,M$a[M$g],M$d)},M$a.merge=function(M$a,M$b,M$c){M$gb.min(M$a.min,M$b.min,M$c.min),M$gb.max(M$a.max,M$b.max,M$c.max)},M$a}(),M$$a=function(){function M$j(M$a){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=M$a,this._near=new M$bb(new M$gb),this._far=new M$bb(new M$gb),this._left=new M$bb(new M$gb),this._right=new M$bb(new M$gb),this._top=new M$bb(new M$gb),this._bottom=new M$bb(new M$gb),M$j._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}M$n(M$j,"laya.d3.math.BoundFrustum");var M$a=M$j.prototype;return M$a.equalsBoundFrustum=function(M$a){return this._matrix.equalsOtherMatrix(M$a.matrix)},M$a.equalsObj=function(M$a){if(M$a instanceof laya.d3.math.BoundFrustum){var M$b=M$a;return this.equalsBoundFrustum(M$b)}return!1},M$a.getPlane=function(M$a){switch(M$a){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},M$a.getCorners=function(M$a){M$j._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(M$a[0]),M$j._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(M$a[1]),M$j._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(M$a[2]),M$j._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(M$a[3]),M$j._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(M$a[4]),M$j._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(M$a[5]),M$j._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(M$a[6]),M$j._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(M$a[7])},M$a.containsPoint=function(M$a){for(var M$b=M$bb.PlaneIntersectionType_Front,M$c=M$bb.PlaneIntersectionType_Front,M$d=0;M$d<6;M$d++){switch(M$d){case 0:M$c=Collision.intersectsPlaneAndPoint(this._near,M$a);break;case 1:M$c=Collision.intersectsPlaneAndPoint(this._far,M$a);break;case 2:M$c=Collision.intersectsPlaneAndPoint(this._left,M$a);break;case 3:M$c=Collision.intersectsPlaneAndPoint(this._right,M$a);break;case 4:M$c=Collision.intersectsPlaneAndPoint(this._top,M$a);break;case 5:M$c=Collision.intersectsPlaneAndPoint(this._bottom,M$a)}switch(M$c){case M$bb.PlaneIntersectionType_Back:return 0;case M$bb.PlaneIntersectionType_Intersecting:M$b=M$bb.PlaneIntersectionType_Intersecting}}switch(M$b){case M$bb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},M$a.containsBoundBox=function(M$a){for(var M$b,M$c=M$j._tempV30,M$d=M$j._tempV31,M$e=1,M$f=0;M$f<6;M$f++){if(M$b=this.getPlane(M$f),this._getBoxToPlanePVertexNVertex(M$a,M$b.normal,M$c,M$d),Collision.intersectsPlaneAndPoint(M$b,M$c)===M$bb.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(M$b,M$d)===M$bb.PlaneIntersectionType_Back&&(M$e=2)}return M$e},M$a.containsBoundSphere=function(M$a){for(var M$b=M$bb.PlaneIntersectionType_Front,M$c=M$bb.PlaneIntersectionType_Front,M$d=0;M$d<6;M$d++){switch(M$d){case 0:M$c=Collision.intersectsPlaneAndSphere(this._near,M$a);break;case 1:M$c=Collision.intersectsPlaneAndSphere(this._far,M$a);break;case 2:M$c=Collision.intersectsPlaneAndSphere(this._left,M$a);break;case 3:M$c=Collision.intersectsPlaneAndSphere(this._right,M$a);break;case 4:M$c=Collision.intersectsPlaneAndSphere(this._top,M$a);break;case 5:M$c=Collision.intersectsPlaneAndSphere(this._bottom,M$a)}switch(M$c){case M$bb.PlaneIntersectionType_Back:return 0;case M$bb.PlaneIntersectionType_Intersecting:M$b=M$bb.PlaneIntersectionType_Intersecting}}switch(M$b){case M$bb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},M$a._getBoxToPlanePVertexNVertex=function(M$a,M$b,M$c,M$d){var M$e=M$a.min,M$f=M$e.elements,M$g=M$a.max,M$h=M$g.elements,M$i=M$b.elements,M$j=M$i[0],M$k=M$i[1],M$l=M$i[2];M$e.cloneTo(M$c);var M$m=M$c.elements;0<=M$j&&(M$m[0]=M$h[0]),0<=M$k&&(M$m[1]=M$h[1]),0<=M$l&&(M$m[2]=M$h[2]),M$g.cloneTo(M$d);var M$n=M$d.elements;0<=M$j&&(M$n[0]=M$f[0]),0<=M$k&&(M$n[1]=M$f[1]),0<=M$l&&(M$n[2]=M$f[2])},M$o(0,M$a,"top",function(){return this._top}),M$o(0,M$a,"matrix",function(){return this._matrix},function(M$a){this._matrix=M$a,M$j._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),M$o(0,M$a,"near",function(){return this._near}),M$o(0,M$a,"far",function(){return this._far}),M$o(0,M$a,"left",function(){return this._left}),M$o(0,M$a,"right",function(){return this._right}),M$o(0,M$a,"bottom",function(){return this._bottom}),M$j._getPlanesFromMatrix=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){var M$h=M$a.elements,M$i=M$h[0],M$j=M$h[1],M$k=M$h[2],M$l=M$h[3],M$m=M$h[4],M$n=M$h[5],M$o=M$h[6],M$p=M$h[7],M$q=M$h[8],M$r=M$h[9],M$s=M$h[10],M$t=M$h[11],M$u=M$h[12],M$v=M$h[13],M$w=M$h[14],M$x=M$h[15],M$A=M$b.normal.elements;M$A[0]=M$l+M$k,M$A[1]=M$p+M$o,M$A[2]=M$t+M$s,M$b.distance=M$x+M$w,M$b.normalize();var M$B=M$c.normal.elements;M$B[0]=M$l-M$k,M$B[1]=M$p-M$o,M$B[2]=M$t-M$s,M$c.distance=M$x-M$w,M$c.normalize();var M$C=M$d.normal.elements;M$C[0]=M$l+M$i,M$C[1]=M$p+M$m,M$C[2]=M$t+M$q,M$d.distance=M$x+M$u,M$d.normalize();var M$D=M$e.normal.elements;M$D[0]=M$l-M$i,M$D[1]=M$p-M$m,M$D[2]=M$t-M$q,M$e.distance=M$x-M$u,M$e.normalize();var M$E=M$f.normal.elements;M$E[0]=M$l-M$j,M$E[1]=M$p-M$n,M$E[2]=M$t-M$r,M$f.distance=M$x-M$v,M$f.normalize();var M$F=M$g.normal.elements;M$F[0]=M$l+M$j,M$F[1]=M$p+M$n,M$F[2]=M$t+M$r,M$g.distance=M$x+M$v,M$g.normalize()},M$j._get3PlaneInterPoint=function(M$a,M$b,M$c){var M$d=M$a.normal,M$e=M$b.normal,M$f=M$c.normal;M$gb.cross(M$e,M$f,M$j._tempV30),M$gb.cross(M$f,M$d,M$j._tempV31),M$gb.cross(M$d,M$e,M$j._tempV32);var M$g=M$gb.dot(M$d,M$j._tempV30),M$h=M$gb.dot(M$e,M$j._tempV31),M$i=M$gb.dot(M$f,M$j._tempV32);return M$gb.scale(M$j._tempV30,-M$a.distance/M$g,M$j._tempV33),M$gb.scale(M$j._tempV31,-M$b.distance/M$h,M$j._tempV34),M$gb.scale(M$j._tempV32,-M$c.distance/M$i,M$j._tempV35),M$gb.add(M$j._tempV33,M$j._tempV34,M$j._tempV36),M$gb.add(M$j._tempV35,M$j._tempV36,M$j._tempV37),M$j._tempV37},M$l(M$j,["_tempV30",function(){return this._tempV30=new M$gb},"_tempV31",function(){return this._tempV31=new M$gb},"_tempV32",function(){return this._tempV32=new M$gb},"_tempV33",function(){return this._tempV33=new M$gb},"_tempV34",function(){return this._tempV34=new M$gb},"_tempV35",function(){return this._tempV35=new M$gb},"_tempV36",function(){return this._tempV36=new M$gb},"_tempV37",function(){return this._tempV37=new M$gb}]),M$j}(),M$_a=function(){function M$k(M$a,M$b){this.center=null,this.radius=NaN,this.center=M$a,this.radius=M$b}M$n(M$k,"laya.d3.math.BoundSphere");var M$a=M$k.prototype;return M$v.imps(M$a,{"laya.d3.core.IClone":!0}),M$a.toDefault=function(){this.center.toDefault(),this.radius=0},M$a.intersectsRayDistance=function(M$a){return Collision.intersectsRayAndSphereRD(M$a,this)},M$a.intersectsRayPoint=function(M$a,M$b){return Collision.intersectsRayAndSphereRP(M$a,this,M$b)},M$a.cloneTo=function(M$a){var M$b=M$a;this.center.cloneTo(M$b.center),M$b.radius=this.radius},M$a.clone=function(){var M$a=new this.constructor(new M$gb,new M$gb);return this.cloneTo(M$a),M$a},M$k.createFromSubPoints=function(M$a,M$b,M$c,M$d){if(null==M$a)throw new Error("points");if(M$b<0||M$b>=M$a.length)throw new Error("start"+M$b+"Must be in the range [0, "+(M$a.length-1)+"]");if(M$c<0||M$b+M$c>M$a.length)throw new Error("count"+M$c+"Must be in the range <= "+M$a.length+"}");var M$e=M$b+M$c,M$f=M$k._tempVector3;M$f.elements[0]=0,M$f.elements[1]=0,M$f.elements[2]=0;for(var M$g=M$b;M$g<M$e;++M$g)M$gb.add(M$a[M$g],M$f,M$f);var M$h=M$d.center;M$gb.scale(M$f,1/M$c,M$h);var M$i=0;for(M$g=M$b;M$g<M$e;++M$g){var M$j=M$gb.distanceSquared(M$h,M$a[M$g]);M$i<M$j&&(M$i=M$j)}M$d.radius=Math.sqrt(M$i)},M$k.createfromPoints=function(M$a,M$b){if(null==M$a)throw new Error("points");M$k.createFromSubPoints(M$a,0,M$a.length,M$b)},M$l(M$k,["_tempVector3",function(){return this._tempVector3=new M$gb}]),M$k}(),M$ya=(function(){function M$a(){}M$n(M$a,"laya.d3.math.ContainmentType"),M$a.Disjoint=0,M$a.Contains=1,M$a.Intersects=2}(),function(){function M$c(){}return M$n(M$c,"laya.d3.math.MathUtils3D"),M$c.isZero=function(M$a){return Math.abs(M$a)<M$c.zeroTolerance},M$c.nearEqual=function(M$a,M$b){return!!M$c.isZero(M$a-M$b)},M$c.fastInvSqrt=function(M$a){return M$c.isZero(M$a)?M$a:1/Math.sqrt(M$a)},M$l(M$c,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),M$c}()),M$za=function(){function M$i(){var M$a=this.elements=new Float32Array(9);M$a[0]=1,M$a[1]=0,M$a[2]=0,M$a[3]=0,M$a[4]=1,M$a[5]=0,M$a[6]=0,M$a[7]=0,M$a[8]=1}M$n(M$i,"laya.d3.math.Matrix3x3");var M$a=M$i.prototype;return M$v.imps(M$a,{"laya.d3.core.IClone":!0}),M$a.determinant=function(){var M$a=this.elements,M$b=M$a[0],M$c=M$a[1],M$d=M$a[2],M$e=M$a[3],M$f=M$a[4],M$g=M$a[5],M$h=M$a[6],M$i=M$a[7],M$j=M$a[8];return M$b*(M$j*M$f-M$g*M$i)+M$c*(-M$j*M$e+M$g*M$h)+M$d*(M$i*M$e-M$f*M$h)},M$a.translate=function(M$a,M$b){var M$c=M$b.elements,M$d=this.elements,M$e=M$a.elements,M$f=M$d[0],M$g=M$d[1],M$h=M$d[2],M$i=M$d[3],M$j=M$d[4],M$k=M$d[5],M$l=M$d[6],M$m=M$d[7],M$n=M$d[8],M$o=M$e[0],M$p=M$e[1];M$c[0]=M$f,M$c[1]=M$g,M$c[2]=M$h,M$c[3]=M$i,M$c[4]=M$j,M$c[5]=M$k,M$c[6]=M$o*M$f+M$p*M$i+M$l,M$c[7]=M$o*M$g+M$p*M$j+M$m,M$c[8]=M$o*M$h+M$p*M$k+M$n},M$a.rotate=function(M$a,M$b){var M$c=M$b.elements,M$d=this.elements,M$e=M$d[0],M$f=M$d[1],M$g=M$d[2],M$h=M$d[3],M$i=M$d[4],M$j=M$d[5],M$k=M$d[6],M$l=M$d[7],M$m=M$d[8],M$n=Math.sin(M$a),M$o=Math.cos(M$a);M$c[0]=M$o*M$e+M$n*M$h,M$c[1]=M$o*M$f+M$n*M$i,M$c[2]=M$o*M$g+M$n*M$j,M$c[3]=M$o*M$h-M$n*M$e,M$c[4]=M$o*M$i-M$n*M$f,M$c[5]=M$o*M$j-M$n*M$g,M$c[6]=M$k,M$c[7]=M$l,M$c[8]=M$m},M$a.scale=function(M$a,M$b){var M$c=M$b.elements,M$d=this.elements,M$e=M$a.elements,M$f=M$e[0],M$g=M$e[1];M$c[0]=M$f*M$d[0],M$c[1]=M$f*M$d[1],M$c[2]=M$f*M$d[2],M$c[3]=M$g*M$d[3],M$c[4]=M$g*M$d[4],M$c[5]=M$g*M$d[5],M$c[6]=M$d[6],M$c[7]=M$d[7],M$c[8]=M$d[8]},M$a.invert=function(M$a){var M$b=M$a.elements,M$c=this.elements,M$d=M$c[0],M$e=M$c[1],M$f=M$c[2],M$g=M$c[3],M$h=M$c[4],M$i=M$c[5],M$j=M$c[6],M$k=M$c[7],M$l=M$c[8],M$m=M$l*M$h-M$i*M$k,M$n=-M$l*M$g+M$i*M$j,M$o=M$k*M$g-M$h*M$j,M$p=M$d*M$m+M$e*M$n+M$f*M$o;M$p||(M$a=null),M$p=1/M$p,M$b[0]=M$m*M$p,M$b[1]=(-M$l*M$e+M$f*M$k)*M$p,M$b[2]=(M$i*M$e-M$f*M$h)*M$p,M$b[3]=M$n*M$p,M$b[4]=(M$l*M$d-M$f*M$j)*M$p,M$b[5]=(-M$i*M$d+M$f*M$g)*M$p,M$b[6]=M$o*M$p,M$b[7]=(-M$k*M$d+M$e*M$j)*M$p,M$b[8]=(M$h*M$d-M$e*M$g)*M$p},M$a.transpose=function(M$a){var M$b=M$a.elements,M$c=this.elements;if(M$a===this){var M$d=M$c[1],M$e=M$c[2],M$f=M$c[5];M$b[1]=M$c[3],M$b[2]=M$c[6],M$b[3]=M$d,M$b[5]=M$c[7],M$b[6]=M$e,M$b[7]=M$f}else M$b[0]=M$c[0],M$b[1]=M$c[3],M$b[2]=M$c[6],M$b[3]=M$c[1],M$b[4]=M$c[4],M$b[5]=M$c[7],M$b[6]=M$c[2],M$b[7]=M$c[5],M$b[8]=M$c[8]},M$a.identity=function(){var M$a=this.elements;M$a[0]=1,M$a[1]=0,M$a[2]=0,M$a[3]=0,M$a[4]=1,M$a[5]=0,M$a[6]=0,M$a[7]=0,M$a[8]=1},M$a.cloneTo=function(M$a){var M$b,M$c,M$d;if((M$c=this.elements)!==(M$d=M$a.elements))for(M$b=0;M$b<9;++M$b)M$d[M$b]=M$c[M$b]},M$a.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$i.createFromTranslation=function(M$a,M$b){M$b.elements;var M$c=M$a.elements;M$b[0]=1,M$b[1]=0,M$b[2]=0,M$b[3]=0,M$b[4]=1,M$b[5]=0,M$b[6]=M$c[0],M$b[7]=M$c[1],M$b[8]=1},M$i.createFromRotation=function(M$a,M$b){var M$c=M$b.elements,M$d=Math.sin(M$a),M$e=Math.cos(M$a);M$c[0]=M$e,M$c[1]=M$d,M$c[2]=0,M$c[3]=-M$d,M$c[4]=M$e,M$c[5]=0,M$c[6]=0,M$c[7]=0,M$c[8]=1},M$i.createFromScaling=function(M$a,M$b){var M$c=M$b.elements,M$d=M$a.elements;M$c[0]=M$d[0],M$c[1]=0,M$c[2]=0,M$c[3]=0,M$c[4]=M$d[1],M$c[5]=0,M$c[6]=0,M$c[7]=0,M$c[8]=1},M$i.createFromMatrix4x4=function(M$a,M$b){M$b[0]=M$a[0],M$b[1]=M$a[1],M$b[2]=M$a[2],M$b[3]=M$a[4],M$b[4]=M$a[5],M$b[5]=M$a[6],M$b[6]=M$a[8],M$b[7]=M$a[9],M$b[8]=M$a[10]},M$i.multiply=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements,M$g=M$e[0],M$h=M$e[1],M$i=M$e[2],M$j=M$e[3],M$k=M$e[4],M$l=M$e[5],M$m=M$e[6],M$n=M$e[7],M$o=M$e[8],M$p=M$f[0],M$q=M$f[1],M$r=M$f[2],M$s=M$f[3],M$t=M$f[4],M$u=M$f[5],M$v=M$f[6],M$w=M$f[7],M$x=M$f[8];M$d[0]=M$p*M$g+M$q*M$j+M$r*M$m,M$d[1]=M$p*M$h+M$q*M$k+M$r*M$n,M$d[2]=M$p*M$i+M$q*M$l+M$r*M$o,M$d[3]=M$s*M$g+M$t*M$j+M$u*M$m,M$d[4]=M$s*M$h+M$t*M$k+M$u*M$n,M$d[5]=M$s*M$i+M$t*M$l+M$u*M$o,M$d[6]=M$v*M$g+M$w*M$j+M$x*M$m,M$d[7]=M$v*M$h+M$w*M$k+M$x*M$n,M$d[8]=M$v*M$i+M$w*M$l+M$x*M$o},M$i.lookAt=function(M$a,M$b,M$c,M$d){M$gb.subtract(M$a,M$b,M$i._tempV30),M$gb.normalize(M$i._tempV30,M$i._tempV30),M$gb.cross(M$c,M$i._tempV30,M$i._tempV31),M$gb.normalize(M$i._tempV31,M$i._tempV31),M$gb.cross(M$i._tempV30,M$i._tempV31,M$i._tempV32);var M$e=M$i._tempV30.elements,M$f=M$i._tempV31.elements,M$g=M$i._tempV32.elements,M$h=M$d.elements;M$h[0]=M$f[0],M$h[3]=M$f[1],M$h[6]=M$f[2],M$h[1]=M$g[0],M$h[4]=M$g[1],M$h[7]=M$g[2],M$h[2]=M$e[0],M$h[5]=M$e[1],M$h[8]=M$e[2]},M$i.DEFAULT=new M$i,M$l(M$i,["_tempV30",function(){return this._tempV30=new M$gb},"_tempV31",function(){return this._tempV31=new M$gb},"_tempV32",function(){return this._tempV32=new M$gb}]),M$i}(),M$ab=function(){function M$B(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$l,M$m,M$n,M$o,M$p){void 0===M$a&&(M$a=1),void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=0),void 0===M$e&&(M$e=0),void 0===M$f&&(M$f=1),void 0===M$g&&(M$g=0),void 0===M$h&&(M$h=0),void 0===M$i&&(M$i=0),void 0===M$j&&(M$j=0),void 0===M$k&&(M$k=1),void 0===M$l&&(M$l=0),void 0===M$m&&(M$m=0),void 0===M$n&&(M$n=0),void 0===M$o&&(M$o=0),void 0===M$p&&(M$p=1);var M$q=this.elements=new Float32Array(16);M$q[0]=M$a,M$q[1]=M$b,M$q[2]=M$c,M$q[3]=M$d,M$q[4]=M$e,M$q[5]=M$f,M$q[6]=M$g,M$q[7]=M$h,M$q[8]=M$i,M$q[9]=M$j,M$q[10]=M$k,M$q[11]=M$l,M$q[12]=M$m,M$q[13]=M$n,M$q[14]=M$o,M$q[15]=M$p}M$n(M$B,"laya.d3.math.Matrix4x4");var M$a=M$B.prototype;return M$v.imps(M$a,{"laya.d3.core.IClone":!0}),M$a.getElementByRowColumn=function(M$a,M$b){if(M$a<0||3<M$a)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(M$b<0||3<M$b)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*M$a+M$b]},M$a.setElementByRowColumn=function(M$a,M$b,M$c){if(M$a<0||3<M$a)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(M$b<0||3<M$b)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*M$a+M$b]=M$c},M$a.equalsOtherMatrix=function(M$a){var M$b=this.elements,M$c=M$a.elements;return M$ya.nearEqual(M$b[0],M$c[0])&&M$ya.nearEqual(M$b[1],M$c[1])&&M$ya.nearEqual(M$b[2],M$c[2])&&M$ya.nearEqual(M$b[3],M$c[3])&&M$ya.nearEqual(M$b[4],M$c[4])&&M$ya.nearEqual(M$b[5],M$c[5])&&M$ya.nearEqual(M$b[6],M$c[6])&&M$ya.nearEqual(M$b[7],M$c[7])&&M$ya.nearEqual(M$b[8],M$c[8])&&M$ya.nearEqual(M$b[9],M$c[9])&&M$ya.nearEqual(M$b[10],M$c[10])&&M$ya.nearEqual(M$b[11],M$c[11])&&M$ya.nearEqual(M$b[12],M$c[12])&&M$ya.nearEqual(M$b[13],M$c[13])&&M$ya.nearEqual(M$b[14],M$c[14])&&M$ya.nearEqual(M$b[15],M$c[15])},M$a.decomposeTransRotScale=function(M$a,M$b,M$c){var M$d=M$B._tempMatrix4x4;return this.decomposeTransRotMatScale(M$a,M$d,M$c)?(M$cb.createFromMatrix4x4(M$d,M$b),!0):(M$b.identity(),!1)},M$a.decomposeTransRotMatScale=function(M$a,M$b,M$c){var M$d=this.elements,M$e=M$a.elements,M$f=M$b.elements,M$g=M$c.elements;M$e[0]=M$d[12],M$e[1]=M$d[13],M$e[2]=M$d[14];var M$h=M$d[0],M$i=M$d[1],M$j=M$d[2],M$k=M$d[4],M$l=M$d[5],M$m=M$d[6],M$n=M$d[8],M$o=M$d[9],M$p=M$d[10],M$q=M$g[0]=Math.sqrt(M$h*M$h+M$i*M$i+M$j*M$j),M$r=M$g[1]=Math.sqrt(M$k*M$k+M$l*M$l+M$m*M$m),M$s=M$g[2]=Math.sqrt(M$n*M$n+M$o*M$o+M$p*M$p);if(M$ya.isZero(M$q)||M$ya.isZero(M$r)||M$ya.isZero(M$s))return M$f[1]=M$f[2]=M$f[3]=M$f[4]=M$f[6]=M$f[7]=M$f[8]=M$f[9]=M$f[11]=M$f[12]=M$f[13]=M$f[14]=0,M$f[0]=M$f[5]=M$f[10]=M$f[15]=1,!1;var M$t=M$B._tempVector0,M$u=M$t.elements;M$u[0]=M$n/M$s,M$u[1]=M$o/M$s,M$u[2]=M$p/M$s;var M$v=M$B._tempVector1,M$w=M$v.elements;M$w[0]=M$h/M$q,M$w[1]=M$i/M$q,M$w[2]=M$j/M$q;var M$x=M$B._tempVector2;M$gb.cross(M$t,M$v,M$x);var M$A=M$B._tempVector1;return M$gb.cross(M$x,M$t,M$A),M$f[3]=M$f[7]=M$f[11]=M$f[12]=M$f[13]=M$f[14]=0,M$f[15]=1,M$f[0]=M$A.x,M$f[1]=M$A.y,M$f[2]=M$A.z,M$f[4]=M$x.x,M$f[5]=M$x.y,M$f[6]=M$x.z,M$f[8]=M$t.x,M$f[9]=M$t.y,M$f[10]=M$t.z,M$f[0]*M$h+M$f[1]*M$i+M$f[2]*M$j<0&&(M$g[0]=-M$q),M$f[4]*M$k+M$f[5]*M$l+M$f[6]*M$m<0&&(M$g[1]=-M$r),M$f[8]*M$n+M$f[9]*M$o+M$f[10]*M$p<0&&(M$g[2]=-M$s),!0},M$a.decomposeYawPitchRoll=function(M$a){var M$b=M$a.elements,M$c=Math.asin(-this.elements[9]);M$b[1]=M$c,Math.cos(M$c)>M$ya.zeroTolerance?(M$b[2]=Math.atan2(this.elements[1],this.elements[5]),M$b[0]=Math.atan2(this.elements[8],this.elements[10])):(M$b[2]=Math.atan2(-this.elements[4],this.elements[0]),M$b[0]=0)},M$a.normalize=function(){var M$a=this.elements,M$b=M$a[0],M$c=M$a[1],M$d=M$a[2],M$e=Math.sqrt(M$b*M$b+M$c*M$c+M$d*M$d);if(!M$e)return M$a[0]=0,M$a[1]=0,void(M$a[2]=0);1!=M$e&&(M$e=1/M$e,M$a[0]=M$b*M$e,M$a[1]=M$c*M$e,M$a[2]=M$d*M$e)},M$a.transpose=function(){var M$a,M$b;return M$b=(M$a=this.elements)[1],M$a[1]=M$a[4],M$a[4]=M$b,M$b=M$a[2],M$a[2]=M$a[8],M$a[8]=M$b,M$b=M$a[3],M$a[3]=M$a[12],M$a[12]=M$b,M$b=M$a[6],M$a[6]=M$a[9],M$a[9]=M$b,M$b=M$a[7],M$a[7]=M$a[13],M$a[13]=M$b,M$b=M$a[11],M$a[11]=M$a[14],M$a[14]=M$b,this},M$a.invert=function(M$a){var M$b=this.elements,M$c=M$a.elements,M$d=M$b[0],M$e=M$b[1],M$f=M$b[2],M$g=M$b[3],M$h=M$b[4],M$i=M$b[5],M$j=M$b[6],M$k=M$b[7],M$l=M$b[8],M$m=M$b[9],M$n=M$b[10],M$o=M$b[11],M$p=M$b[12],M$q=M$b[13],M$r=M$b[14],M$s=M$b[15],M$t=M$d*M$i-M$e*M$h,M$u=M$d*M$j-M$f*M$h,M$v=M$d*M$k-M$g*M$h,M$w=M$e*M$j-M$f*M$i,M$x=M$e*M$k-M$g*M$i,M$A=M$f*M$k-M$g*M$j,M$B=M$l*M$q-M$m*M$p,M$C=M$l*M$r-M$n*M$p,M$D=M$l*M$s-M$o*M$p,M$E=M$m*M$r-M$n*M$q,M$F=M$m*M$s-M$o*M$q,M$G=M$n*M$s-M$o*M$r,M$H=M$t*M$G-M$u*M$F+M$v*M$E+M$w*M$D-M$x*M$C+M$A*M$B;0!==Math.abs(M$H)&&(M$H=1/M$H,M$c[0]=(M$i*M$G-M$j*M$F+M$k*M$E)*M$H,M$c[1]=(M$f*M$F-M$e*M$G-M$g*M$E)*M$H,M$c[2]=(M$q*M$A-M$r*M$x+M$s*M$w)*M$H,M$c[3]=(M$n*M$x-M$m*M$A-M$o*M$w)*M$H,M$c[4]=(M$j*M$D-M$h*M$G-M$k*M$C)*M$H,M$c[5]=(M$d*M$G-M$f*M$D+M$g*M$C)*M$H,M$c[6]=(M$r*M$v-M$p*M$A-M$s*M$u)*M$H,M$c[7]=(M$l*M$A-M$n*M$v+M$o*M$u)*M$H,M$c[8]=(M$h*M$F-M$i*M$D+M$k*M$B)*M$H,M$c[9]=(M$e*M$D-M$d*M$F-M$g*M$B)*M$H,M$c[10]=(M$p*M$x-M$q*M$v+M$s*M$t)*M$H,M$c[11]=(M$m*M$v-M$l*M$x-M$o*M$t)*M$H,M$c[12]=(M$i*M$C-M$h*M$E-M$j*M$B)*M$H,M$c[13]=(M$d*M$E-M$e*M$C+M$f*M$B)*M$H,M$c[14]=(M$q*M$u-M$p*M$w-M$r*M$t)*M$H,M$c[15]=(M$l*M$w-M$m*M$u+M$n*M$t)*M$H)},M$a.identity=function(){var M$a=this.elements;M$a[1]=M$a[2]=M$a[3]=M$a[4]=M$a[6]=M$a[7]=M$a[8]=M$a[9]=M$a[11]=M$a[12]=M$a[13]=M$a[14]=0,M$a[0]=M$a[5]=M$a[10]=M$a[15]=1},M$a.cloneTo=function(M$a){var M$b,M$c,M$d;if((M$c=this.elements)!==(M$d=M$a.elements))for(M$b=0;M$b<16;++M$b)M$d[M$b]=M$c[M$b]},M$a.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$a.getTranslationVector=function(M$a){var M$b=this.elements,M$c=M$a.elements;M$c[0]=M$b[12],M$c[1]=M$b[13],M$c[2]=M$b[14]},M$a.setTranslationVector=function(M$a){var M$b=this.elements,M$c=M$a.elements;M$b[12]=M$c[0],M$b[13]=M$c[1],M$b[14]=M$c[2]},M$a.getForward=function(M$a){var M$b=this.elements,M$c=M$a.elements;M$c[0]=-M$b[8],M$c[1]=-M$b[9],M$c[2]=-M$b[10]},M$a.setForward=function(M$a){var M$b=this.elements,M$c=M$a.elements;M$b[8]=-M$c[0],M$b[9]=-M$c[1],M$b[10]=-M$c[2]},M$B.createRotationX=function(M$a,M$b){var M$c=M$b.elements,M$d=Math.sin(M$a),M$e=Math.cos(M$a);M$c[1]=M$c[2]=M$c[3]=M$c[4]=M$c[7]=M$c[8]=M$c[11]=M$c[12]=M$c[13]=M$c[14]=0,M$c[0]=M$c[15]=1,M$c[5]=M$c[10]=M$e,M$c[6]=M$d,M$c[9]=-M$d},M$B.createRotationY=function(M$a,M$b){var M$c=M$b.elements,M$d=Math.sin(M$a),M$e=Math.cos(M$a);M$c[1]=M$c[3]=M$c[4]=M$c[6]=M$c[7]=M$c[9]=M$c[11]=M$c[12]=M$c[13]=M$c[14]=0,M$c[5]=M$c[15]=1,M$c[0]=M$c[10]=M$e,M$c[2]=-M$d,M$c[8]=M$d},M$B.createRotationZ=function(M$a,M$b){var M$c=M$b.elements,M$d=Math.sin(M$a),M$e=Math.cos(M$a);M$c[2]=M$c[3]=M$c[6]=M$c[7]=M$c[8]=M$c[9]=M$c[11]=M$c[12]=M$c[13]=M$c[14]=0,M$c[10]=M$c[15]=1,M$c[0]=M$c[5]=M$e,M$c[1]=M$d,M$c[4]=-M$d},M$B.createRotationYawPitchRoll=function(M$a,M$b,M$c,M$d){M$cb.createFromYawPitchRoll(M$a,M$b,M$c,M$B._tempQuaternion),M$B.createRotationQuaternion(M$B._tempQuaternion,M$d)},M$B.createRotationAxis=function(M$a,M$b,M$c){var M$d=M$a.elements,M$e=M$d[0],M$f=M$d[1],M$g=M$d[2],M$h=Math.cos(M$b),M$i=Math.sin(M$b),M$j=M$e*M$e,M$k=M$f*M$f,M$l=M$g*M$g,M$m=M$e*M$f,M$n=M$e*M$g,M$o=M$f*M$g,M$p=M$c.elements;M$p[3]=M$p[7]=M$p[11]=M$p[12]=M$p[13]=M$p[14]=0,M$p[15]=1,M$p[0]=M$j+M$h*(1-M$j),M$p[1]=M$m-M$h*M$m+M$i*M$g,M$p[2]=M$n-M$h*M$n-M$i*M$f,M$p[4]=M$m-M$h*M$m-M$i*M$g,M$p[5]=M$k+M$h*(1-M$k),M$p[6]=M$o-M$h*M$o+M$i*M$e,M$p[8]=M$n-M$h*M$n+M$i*M$f,M$p[9]=M$o-M$h*M$o-M$i*M$e,M$p[10]=M$l+M$h*(1-M$l)},M$B.createRotationQuaternion=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements,M$e=M$c[0],M$f=M$c[1],M$g=M$c[2],M$h=M$c[3],M$i=M$e*M$e,M$j=M$f*M$f,M$k=M$g*M$g,M$l=M$e*M$f,M$m=M$g*M$h,M$n=M$g*M$e,M$o=M$f*M$h,M$p=M$f*M$g,M$q=M$e*M$h;M$d[3]=M$d[7]=M$d[11]=M$d[12]=M$d[13]=M$d[14]=0,M$d[15]=1,M$d[0]=1-2*(M$j+M$k),M$d[1]=2*(M$l+M$m),M$d[2]=2*(M$n-M$o),M$d[4]=2*(M$l-M$m),M$d[5]=1-2*(M$k+M$i),M$d[6]=2*(M$p+M$q),M$d[8]=2*(M$n+M$o),M$d[9]=2*(M$p-M$q),M$d[10]=1-2*(M$j+M$i)},M$B.createTranslate=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements;M$d[4]=M$d[8]=M$d[1]=M$d[9]=M$d[2]=M$d[6]=M$d[3]=M$d[7]=M$d[11]=0,M$d[0]=M$d[5]=M$d[10]=M$d[15]=1,M$d[12]=M$c[0],M$d[13]=M$c[1],M$d[14]=M$c[2]},M$B.createScaling=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements;M$d[0]=M$c[0],M$d[5]=M$c[1],M$d[10]=M$c[2],M$d[1]=M$d[4]=M$d[8]=M$d[12]=M$d[9]=M$d[13]=M$d[2]=M$d[6]=M$d[14]=M$d[3]=M$d[7]=M$d[11]=0,M$d[15]=1},M$B.multiply=function(M$a,M$b,M$c){var M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k;for(M$e=M$c.elements,M$f=M$a.elements,M$e===(M$g=M$b.elements)&&(M$g=M$g.slice()),M$d=0;M$d<4;M$d++)M$h=M$f[M$d],M$i=M$f[M$d+4],M$j=M$f[M$d+8],M$k=M$f[M$d+12],M$e[M$d]=M$h*M$g[0]+M$i*M$g[1]+M$j*M$g[2]+M$k*M$g[3],M$e[M$d+4]=M$h*M$g[4]+M$i*M$g[5]+M$j*M$g[6]+M$k*M$g[7],M$e[M$d+8]=M$h*M$g[8]+M$i*M$g[9]+M$j*M$g[10]+M$k*M$g[11],M$e[M$d+12]=M$h*M$g[12]+M$i*M$g[13]+M$j*M$g[14]+M$k*M$g[15]},M$B.createFromQuaternion=function(M$a,M$b){var M$c=M$b.elements,M$d=M$a.elements,M$e=M$d[0],M$f=M$d[1],M$g=M$d[2],M$h=M$d[3],M$i=M$e+M$e,M$j=M$f+M$f,M$k=M$g+M$g,M$l=M$e*M$i,M$m=M$f*M$i,M$n=M$f*M$j,M$o=M$g*M$i,M$p=M$g*M$j,M$q=M$g*M$k,M$r=M$h*M$i,M$s=M$h*M$j,M$t=M$h*M$k;M$c[0]=1-M$n-M$q,M$c[1]=M$m+M$t,M$c[2]=M$o-M$s,M$c[3]=0,M$c[4]=M$m-M$t,M$c[5]=1-M$l-M$q,M$c[6]=M$p+M$r,M$c[7]=0,M$c[8]=M$o+M$s,M$c[9]=M$p-M$r,M$c[10]=1-M$l-M$n,M$c[11]=0,M$c[12]=0,M$c[13]=0,M$c[14]=0,M$c[15]=1},M$B.createAffineTransformation=function(M$a,M$b,M$c,M$d){var M$e=M$a.elements,M$f=M$b.elements,M$g=M$c.elements,M$h=M$d.elements,M$i=M$f[0],M$j=M$f[1],M$k=M$f[2],M$l=M$f[3],M$m=M$i+M$i,M$n=M$j+M$j,M$o=M$k+M$k,M$p=M$i*M$m,M$q=M$i*M$n,M$r=M$i*M$o,M$s=M$j*M$n,M$t=M$j*M$o,M$u=M$k*M$o,M$v=M$l*M$m,M$w=M$l*M$n,M$x=M$l*M$o,M$A=M$g[0],M$B=M$g[1],M$C=M$g[2];M$h[0]=(1-(M$s+M$u))*M$A,M$h[1]=(M$q+M$x)*M$A,M$h[2]=(M$r-M$w)*M$A,M$h[3]=0,M$h[4]=(M$q-M$x)*M$B,M$h[5]=(1-(M$p+M$u))*M$B,M$h[6]=(M$t+M$v)*M$B,M$h[7]=0,M$h[8]=(M$r+M$w)*M$C,M$h[9]=(M$t-M$v)*M$C,M$h[10]=(1-(M$p+M$s))*M$C,M$h[11]=0,M$h[12]=M$e[0],M$h[13]=M$e[1],M$h[14]=M$e[2],M$h[15]=1},M$B.createLookAt=function(M$a,M$b,M$c,M$d){var M$e=M$d.elements,M$f=M$B._tempVector0,M$g=M$B._tempVector1,M$h=M$B._tempVector2;M$gb.subtract(M$a,M$b,M$h),M$gb.normalize(M$h,M$h),M$gb.cross(M$c,M$h,M$f),M$gb.normalize(M$f,M$f),M$gb.cross(M$h,M$f,M$g),M$d.identity(),M$e[0]=M$f.x,M$e[4]=M$f.y,M$e[8]=M$f.z,M$e[1]=M$g.x,M$e[5]=M$g.y,M$e[9]=M$g.z,M$e[2]=M$h.x,M$e[6]=M$h.y,M$e[10]=M$h.z,M$e[12]=-M$gb.dot(M$f,M$a),M$e[13]=-M$gb.dot(M$g,M$a),M$e[14]=-M$gb.dot(M$h,M$a)},M$B.createPerspective=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$e.elements,M$g=1/Math.tan(M$a/2),M$h=1/(M$c-M$d);M$f[0]=M$g/M$b,M$f[5]=M$g,M$f[10]=(M$d+M$c)*M$h,M$f[11]=-1,M$f[14]=2*M$d*M$c*M$h,M$f[1]=M$f[2]=M$f[3]=M$f[4]=M$f[6]=M$f[7]=M$f[8]=M$f[9]=M$f[12]=M$f[13]=M$f[15]=0},M$B.createOrthoOffCenterRH=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){var M$h=M$g.elements,M$i=1/(M$a-M$b),M$j=1/(M$c-M$d),M$k=1/(M$e-M$f);M$h[1]=M$h[2]=M$h[3]=M$h[4]=M$h[6]=M$h[7]=M$h[8]=M$h[9]=M$h[11]=0,M$h[15]=1,M$h[0]=-2*M$i,M$h[5]=-2*M$j,M$h[10]=2*M$k,M$h[12]=(M$a+M$b)*M$i,M$h[13]=(M$d+M$c)*M$j,M$h[14]=(M$f+M$e)*M$k},M$B.translation=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements;M$d[0]=M$d[5]=M$d[10]=M$d[15]=1,M$d[12]=M$c[0],M$d[13]=M$c[1],M$d[14]=M$c[2]},M$l(M$B,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new M$B},"_tempVector0",function(){return this._tempVector0=new M$gb},"_tempVector1",function(){return this._tempVector1=new M$gb},"_tempVector2",function(){return this._tempVector2=new M$gb},"_tempQuaternion",function(){return this._tempQuaternion=new M$cb},"DEFAULT",function(){return this.DEFAULT=new M$B},"ZERO",function(){return this.ZERO=new M$B(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),M$B}(),M$bb=(function(){function M$t(M$a,M$b){this.extents=null,this.transformation=null,this.extents=M$a,this.transformation=M$b}M$n(M$t,"laya.d3.math.OrientedBoundBox");var M$a=M$t.prototype;M$a.getCorners=function(M$a){var M$b=M$t._tempV30.elements,M$c=M$t._tempV31.elements,M$d=M$t._tempV32.elements,M$e=this.extents.elements;M$b[0]=M$e[0],M$b[1]=M$b[2]=0,M$c[1]=M$e[1],M$c[0]=M$c[2]=0,M$d[2]=M$e[2],M$d[0]=M$d[1]=0,M$gb.TransformNormal(M$t._tempV30,this.transformation,M$t._tempV30),M$gb.TransformNormal(M$t._tempV31,this.transformation,M$t._tempV31),M$gb.TransformNormal(M$t._tempV32,this.transformation,M$t._tempV32);var M$f=M$t._tempV33;this.transformation.getTranslationVector(M$f),M$a.length=8,M$gb.add(M$f,M$t._tempV30,M$t._tempV34),M$gb.add(M$t._tempV34,M$t._tempV31,M$t._tempV34),M$gb.add(M$t._tempV34,M$t._tempV32,M$a[0]),M$gb.add(M$f,M$t._tempV30,M$t._tempV34),M$gb.add(M$t._tempV34,M$t._tempV31,M$t._tempV34),M$gb.subtract(M$t._tempV34,M$t._tempV32,M$a[1]),M$gb.subtract(M$f,M$t._tempV30,M$t._tempV34),M$gb.add(M$t._tempV34,M$t._tempV31,M$t._tempV34),M$gb.subtract(M$t._tempV34,M$t._tempV32,M$a[2]),M$gb.subtract(M$f,M$t._tempV30,M$t._tempV34),M$gb.add(M$t._tempV34,M$t._tempV31,M$t._tempV34),M$gb.add(M$t._tempV34,M$t._tempV32,M$a[3]),M$gb.add(M$f,M$t._tempV30,M$t._tempV34),M$gb.subtract(M$t._tempV34,M$t._tempV31,M$t._tempV34),M$gb.add(M$t._tempV34,M$t._tempV32,M$a[4]),M$gb.add(M$f,M$t._tempV30,M$t._tempV34),M$gb.subtract(M$t._tempV34,M$t._tempV31,M$t._tempV34),M$gb.subtract(M$t._tempV34,M$t._tempV32,M$a[5]),M$gb.subtract(M$f,M$t._tempV30,M$t._tempV34),M$gb.subtract(M$t._tempV34,M$t._tempV31,M$t._tempV34),M$gb.subtract(M$t._tempV34,M$t._tempV32,M$a[6]),M$gb.subtract(M$f,M$t._tempV30,M$t._tempV34),M$gb.subtract(M$t._tempV34,M$t._tempV31,M$t._tempV34),M$gb.add(M$t._tempV34,M$t._tempV32,M$a[7])},M$a.transform=function(M$a){M$ab.multiply(this.transformation,M$a,this.transformation)},M$a.scale=function(M$a){M$gb.multiply(this.extents,M$a,this.extents)},M$a.translate=function(M$a){this.transformation.getTranslationVector(M$t._tempV30),M$gb.add(M$t._tempV30,M$a,M$t._tempV31),this.transformation.setTranslationVector(M$t._tempV31)},M$a.Size=function(M$a){M$gb.scale(this.extents,2,M$a)},M$a.getSize=function(M$a){var M$b=this.extents.elements;M$t._tempV30.x=M$b[0],M$t._tempV31.y=M$b[1],M$t._tempV32.z=M$b[2],M$gb.TransformNormal(M$t._tempV30,this.transformation,M$t._tempV30),M$gb.TransformNormal(M$t._tempV31,this.transformation,M$t._tempV31),M$gb.TransformNormal(M$t._tempV31,this.transformation,M$t._tempV32);var M$c=M$a.elements;M$c[0]=M$gb.scalarLength(M$t._tempV30),M$c[1]=M$gb.scalarLength(M$t._tempV31),M$c[2]=M$gb.scalarLength(M$t._tempV32)},M$a.getSizeSquared=function(M$a){var M$b=this.extents.elements;M$t._tempV30.x=M$b[0],M$t._tempV31.y=M$b[1],M$t._tempV32.z=M$b[2],M$gb.TransformNormal(M$t._tempV30,this.transformation,M$t._tempV30),M$gb.TransformNormal(M$t._tempV31,this.transformation,M$t._tempV31),M$gb.TransformNormal(M$t._tempV31,this.transformation,M$t._tempV32);var M$c=M$a.elements;M$c[0]=M$gb.scalarLengthSquared(M$t._tempV30),M$c[1]=M$gb.scalarLengthSquared(M$t._tempV31),M$c[2]=M$gb.scalarLengthSquared(M$t._tempV32)},M$a.getCenter=function(M$a){this.transformation.getTranslationVector(M$a)},M$a.containsPoint=function(M$a){var M$b=this.extents.elements,M$c=M$b[0],M$d=M$b[1],M$e=M$b[2];this.transformation.invert(M$t._tempM0),M$gb.transformCoordinate(M$a,M$t._tempM0,M$t._tempV30);var M$f=M$t._tempV30.elements,M$g=Math.abs(M$f[0]),M$h=Math.abs(M$f[1]),M$i=Math.abs(M$f[2]);return M$ya.nearEqual(M$g,M$c)&&M$ya.nearEqual(M$h,M$d)&&M$ya.nearEqual(M$i,M$e)?2:M$g<M$c&&M$h<M$d&&M$i<M$e?1:0},M$a.containsPoints=function(M$a){var M$b=this.extents.elements,M$c=M$b[0],M$d=M$b[1],M$e=M$b[2];this.transformation.invert(M$t._tempM0);for(var M$f=!0,M$g=!1,M$h=0;M$h<M$a.length;M$h++){M$gb.transformCoordinate(M$a[M$h],M$t._tempM0,M$t._tempV30);var M$i=M$t._tempV30.elements,M$j=Math.abs(M$i[0]),M$k=Math.abs(M$i[1]),M$l=Math.abs(M$i[2]);M$ya.nearEqual(M$j,M$c)&&M$ya.nearEqual(M$k,M$d)&&M$ya.nearEqual(M$l,M$e)&&(M$g=!0),M$j<M$c&&M$k<M$d&&M$l<M$e?M$g=!0:M$f=!1}return M$f?1:M$g?2:0},M$a.containsSphere=function(M$a,M$b){void 0===M$b&&(M$b=!1);var M$c=this.extents.elements,M$d=M$c[0],M$e=M$c[1],M$f=M$c[2],M$g=M$a.radius;this.transformation.invert(M$t._tempM0),M$gb.transformCoordinate(M$a.center,M$t._tempM0,M$t._tempV30);var M$h=NaN;if(M$h=M$b?M$g:(M$gb.scale(M$gb.UnitX,M$g,M$t._tempV31),M$gb.TransformNormal(M$t._tempV31,M$t._tempM0,M$t._tempV31),M$gb.scalarLength(M$t._tempV31)),M$gb.scale(this.extents,-1,M$t._tempV32),M$gb.Clamp(M$t._tempV30,M$t._tempV32,this.extents,M$t._tempV33),M$h*M$h<M$gb.distanceSquared(M$t._tempV30,M$t._tempV33))return 0;var M$i=M$t._tempV30.elements,M$j=M$i[0],M$k=M$i[1],M$l=M$i[2],M$m=M$t._tempV32.elements,M$n=M$m[0],M$o=M$m[1],M$p=M$m[2];return M$n+M$h<=M$j&&M$j<=M$d-M$h&&M$h<M$d-M$n&&M$o+M$h<=M$k&&M$k<=M$e-M$h&&M$h<M$e-M$o&&M$p+M$h<=M$l&&M$l<=M$f-M$h&&M$h<M$f-M$p?1:2},M$a.containsOrientedBoundBox=function(M$a){var M$b=0,M$c=0;M$a.getCorners(M$t._corners);var M$d=this.containsPoints(M$t._corners);if(0!=M$d)return M$d;var M$e=this.extents.elements;M$a.extents.cloneTo(M$t._tempV35);var M$f=M$t._tempV35.elements;M$t._getRows(this.transformation,M$t._rows1),M$t._getRows(M$a.transformation,M$t._rows2);var M$g=NaN;for(M$b=0;M$b<4;M$b++)for(M$c=0;M$c<4;M$c++)3==M$b||3==M$c?(M$t._tempM0.setElementByRowColumn(M$b,M$c,0),M$t._tempM1.setElementByRowColumn(M$b,M$c,0)):(M$g=M$gb.dot(M$t._rows1[M$b],M$t._rows2[M$c]),M$t._tempM0.setElementByRowColumn(M$b,M$c,M$g),M$t._tempM1.setElementByRowColumn(M$b,M$c,Math.abs(M$g)));M$a.getCenter(M$t._tempV34),this.getCenter(M$t._tempV36),M$gb.subtract(M$t._tempV34,M$t._tempV36,M$t._tempV30);var M$h=M$t._tempV31.elements;M$h[0]=M$gb.dot(M$t._tempV30,M$t._rows1[0]),M$h[1]=M$gb.dot(M$t._tempV30,M$t._rows1[1]),M$h[2]=M$gb.dot(M$t._tempV30,M$t._rows1[2]);var M$i=M$t._tempV32.elements,M$j=M$t._tempV33.elements;for(M$b=0;M$b<3;M$b++)if(M$i[0]=M$t._tempM1.getElementByRowColumn(M$b,0),M$i[1]=M$t._tempM1.getElementByRowColumn(M$b,1),M$i[2]=M$t._tempM1.getElementByRowColumn(M$b,2),M$e[M$b]+M$gb.dot(M$t._tempV35,M$t._tempV32)<Math.abs(M$h[M$b]))return 0;for(M$c=0;M$c<3;M$c++)if(M$i[0]=M$t._tempM1.getElementByRowColumn(0,M$c),M$i[1]=M$t._tempM1.getElementByRowColumn(1,M$c),M$i[2]=M$t._tempM1.getElementByRowColumn(2,M$c),M$j[0]=M$t._tempM0.getElementByRowColumn(0,M$c),M$j[1]=M$t._tempM0.getElementByRowColumn(1,M$c),M$j[2]=M$t._tempM0.getElementByRowColumn(2,M$c),M$gb.dot(this.extents,M$t._tempV32)+M$f[M$c]<Math.abs(M$gb.dot(M$t._tempV31,M$t._tempV33)))return 0;for(M$b=0;M$b<3;M$b++)for(M$c=0;M$c<3;M$c++){var M$k=(M$b+1)%3,M$l=(M$b+2)%3,M$m=(M$c+1)%3,M$n=(M$c+2)%3;if(M$e[M$k]*M$t._tempM1.getElementByRowColumn(M$l,M$c)+M$e[M$l]*M$t._tempM1.getElementByRowColumn(M$k,M$c)+(M$f[M$m]*M$t._tempM1.getElementByRowColumn(M$b,M$n)+M$f[M$n]*M$t._tempM1.getElementByRowColumn(M$b,M$m))<Math.abs(M$h[M$l]*M$t._tempM0.getElementByRowColumn(M$k,M$c)-M$h[M$k]*M$t._tempM0.getElementByRowColumn(M$l,M$c)))return 0}return 2},M$a.containsLine=function(M$a,M$b){M$t._corners[0]=M$a,M$t._corners[1]=M$b;var M$c=this.containsPoints(M$t._corners);if(0!=M$c)return M$c;var M$d=this.extents.elements,M$e=M$d[0],M$f=M$d[1],M$g=M$d[2];this.transformation.invert(M$t._tempM0),M$gb.transformCoordinate(M$a,M$t._tempM0,M$t._tempV30),M$gb.transformCoordinate(M$b,M$t._tempM0,M$t._tempV31),M$gb.add(M$t._tempV30,M$t._tempV31,M$t._tempV32),M$gb.scale(M$t._tempV32,.5,M$t._tempV32),M$gb.subtract(M$t._tempV30,M$t._tempV32,M$t._tempV33);var M$h=M$t._tempV33.elements,M$i=M$h[0],M$j=M$h[1],M$k=M$h[2],M$l=M$t._tempV34.elements,M$m=M$l[0]=Math.abs(M$h[0]),M$n=M$l[1]=Math.abs(M$h[1]),M$o=M$l[2]=Math.abs(M$h[2]),M$p=M$t._tempV32.elements,M$q=M$p[0],M$r=M$p[1],M$s=M$p[2];return Math.abs(M$q)>M$e+M$m?0:Math.abs(M$r)>M$f+M$n?0:Math.abs(M$s)>M$g+M$o?0:Math.abs(M$r*M$k-M$s*M$j)>M$f*M$o+M$g*M$n?0:Math.abs(M$q*M$k-M$s*M$i)>M$e*M$o+M$g*M$m?0:Math.abs(M$q*M$j-M$r*M$i)>M$e*M$n+M$f*M$m?0:2},M$a.containsBoundBox=function(M$a){var M$b=0,M$c=0,M$d=M$a.min,M$e=M$a.max;M$a.getCorners(M$t._corners);var M$f=this.containsPoints(M$t._corners);if(0!=M$f)return M$f;M$gb.subtract(M$e,M$d,M$t._tempV30),M$gb.scale(M$t._tempV30,.5,M$t._tempV30),M$gb.add(M$d,M$t._tempV30,M$t._tempV30),M$gb.subtract(M$e,M$t._tempV30,M$t._tempV31);var M$g=this.extents.elements,M$h=M$t._tempV31.elements;M$t._getRows(this.transformation,M$t._rows1),this.transformation.invert(M$t._tempM0);for(M$b=0;M$b<3;M$b++)for(M$c=0;M$c<3;M$c++)M$t._tempM1.setElementByRowColumn(M$b,M$c,Math.abs(M$t._tempM0.getElementByRowColumn(M$b,M$c)));this.getCenter(M$t._tempV35),M$gb.subtract(M$t._tempV30,M$t._tempV35,M$t._tempV32);var M$i=M$t._tempV31.elements;M$i[0]=M$gb.dot(M$t._tempV32,M$t._rows1[0]),M$i[1]=M$gb.dot(M$t._tempV32,M$t._rows1[1]),M$i[2]=M$gb.dot(M$t._tempV32,M$t._rows1[2]);var M$j=M$t._tempV33.elements,M$k=M$t._tempV34.elements;for(M$b=0;M$b<3;M$b++)if(M$j[0]=M$t._tempM1.getElementByRowColumn(M$b,0),M$j[1]=M$t._tempM1.getElementByRowColumn(M$b,1),M$j[2]=M$t._tempM1.getElementByRowColumn(M$b,2),M$g[M$b]+M$gb.dot(M$t._tempV31,M$t._tempV33)<Math.abs(M$i[M$b]))return 0;for(M$c=0;M$c<3;M$c++)if(M$j[0]=M$t._tempM1.getElementByRowColumn(0,M$c),M$j[1]=M$t._tempM1.getElementByRowColumn(1,M$c),M$j[2]=M$t._tempM1.getElementByRowColumn(2,M$c),M$k[0]=M$t._tempM0.getElementByRowColumn(0,M$c),M$k[1]=M$t._tempM0.getElementByRowColumn(1,M$c),M$k[2]=M$t._tempM0.getElementByRowColumn(2,M$c),M$gb.dot(this.extents,M$t._tempV33)+M$h[M$c]<Math.abs(M$gb.dot(M$t._tempV31,M$t._tempV34)))return 0;for(M$b=0;M$b<3;M$b++)for(M$c=0;M$c<3;M$c++){var M$l=(M$b+1)%3,M$m=(M$b+2)%3,M$n=(M$c+1)%3,M$o=(M$c+2)%3;if(M$g[M$l]*M$t._tempM1.getElementByRowColumn(M$m,M$c)+M$g[M$m]*M$t._tempM1.getElementByRowColumn(M$l,M$c)+(M$h[M$n]*M$t._tempM1.getElementByRowColumn(M$b,M$o)+M$h[M$o]*M$t._tempM1.getElementByRowColumn(M$b,M$n))<Math.abs(M$i[M$m]*M$t._tempM0.getElementByRowColumn(M$l,M$c)-M$i[M$l]*M$t._tempM0.getElementByRowColumn(M$m,M$c)))return 0}return 2},M$a.intersectsRay=function(M$a,M$b){M$gb.scale(this.extents,-1,M$t._tempV30),this.transformation.invert(M$t._tempM0),M$gb.TransformNormal(M$a.direction,M$t._tempM0,M$t._ray.direction),M$gb.transformCoordinate(M$a.origin,M$t._tempM0,M$t._ray.origin),M$t._boxBound1.min=M$t._tempV30,M$t._boxBound1.max=this.extents;var M$c=Collision.intersectsRayAndBoxRP(M$t._ray,M$t._boxBound1,M$b);return-1!==M$c&&M$gb.transformCoordinate(M$b,this.transformation,M$b),M$c},M$a._getLocalCorners=function(M$a){M$a.length=8;var M$b=this.extents.elements;M$t._tempV30.x=M$b[0],M$t._tempV31.y=M$b[1],M$t._tempV32.z=M$b[2],M$gb.add(M$t._tempV30,M$t._tempV31,M$t._tempV33),M$gb.add(M$t._tempV33,M$t._tempV32,M$a[0]),M$gb.add(M$t._tempV30,M$t._tempV31,M$t._tempV33),M$gb.subtract(M$t._tempV33,M$t._tempV32,M$a[1]),M$gb.subtract(M$t._tempV31,M$t._tempV30,M$t._tempV33),M$gb.subtract(M$t._tempV33,M$t._tempV30,M$a[2]),M$gb.subtract(M$t._tempV31,M$t._tempV30,M$t._tempV33),M$gb.add(M$t._tempV33,M$t._tempV32,M$a[3]),M$gb.subtract(M$t._tempV30,M$t._tempV31,M$t._tempV33),M$gb.add(M$t._tempV33,M$t._tempV32,M$a[4]),M$gb.subtract(M$t._tempV30,M$t._tempV31,M$t._tempV33),M$gb.subtract(M$t._tempV33,M$t._tempV32,M$a[5]),M$gb.scale(M$a[0],-1,M$a[6]),M$gb.subtract(M$t._tempV32,M$t._tempV30,M$t._tempV33),M$gb.subtract(M$t._tempV33,M$t._tempV31,M$a[7])},M$a.equals=function(M$a){return this.extents==M$a.extents&&this.transformation==M$a.transformation},M$a.cloneTo=function(M$a){var M$b=M$a;this.extents.cloneTo(M$b.extents),this.transformation.cloneTo(M$b.transformation)},M$t.createByBoundBox=function(M$a,M$b){var M$c=M$a.min,M$d=M$a.max;M$gb.subtract(M$d,M$c,M$t._tempV30),M$gb.scale(M$t._tempV30,.5,M$t._tempV30),M$gb.add(M$c,M$t._tempV30,M$t._tempV31),M$gb.subtract(M$d,M$t._tempV31,M$t._tempV32),M$ab.translation(M$t._tempV31,M$t._tempM0);var M$e=M$t._tempV32.clone(),M$f=M$t._tempM0.clone();M$b.extents=M$e,M$b.transformation=M$f},M$t.createByMinAndMaxVertex=function(M$a,M$b){return M$gb.subtract(M$b,M$a,M$t._tempV30),M$gb.scale(M$t._tempV30,.5,M$t._tempV30),M$gb.add(M$a,M$t._tempV30,M$t._tempV31),M$gb.subtract(M$b,M$t._tempV31,M$t._tempV32),M$ab.translation(M$t._tempV31,M$t._tempM0),new M$t(M$t._tempV32,M$t._tempM0)},M$t._getRows=function(M$a,M$b){M$b.length=3;var M$c=M$a.elements,M$d=M$b[0].elements;M$d[0]=M$c[0],M$d[1]=M$c[1],M$d[2]=M$c[2];var M$e=M$b[1].elements;M$e[0]=M$c[4],M$e[1]=M$c[5],M$e[2]=M$c[6];var M$f=M$b[2].elements;M$f[0]=M$c[8],M$f[1]=M$c[9],M$f[2]=M$c[10]},M$t.getObbtoObbMatrix4x4=function(M$a,M$b,M$c,M$d){var M$e=M$a.transformation,M$f=M$b.transformation;if(M$c){M$t._getRows(M$e,M$t._rows1),M$t._getRows(M$f,M$t._rows2);for(var M$g=0;M$g<3;M$g++)for(var M$h=0;M$h<3;M$h++)M$d.setElementByRowColumn(M$g,M$h,M$gb.dot(M$t._rows2[M$g],M$t._rows1[M$h]));M$b.getCenter(M$t._tempV30),M$a.getCenter(M$t._tempV31),M$gb.subtract(M$t._tempV30,M$t._tempV31,M$t._tempV32);var M$i=M$d.elements;M$i[12]=M$gb.dot(M$t._tempV32,M$t._rows1[0]),M$i[13]=M$gb.dot(M$t._tempV32,M$t._rows1[1]),M$i[14]=M$gb.dot(M$t._tempV32,M$t._rows1[2]),M$i[15]=1}else M$e.invert(M$t._tempM0),M$ab.multiply(M$f,M$t._tempM0,M$d)},M$t.merge=function(M$a,M$b,M$c){var M$d=M$a.extents,M$e=M$a.transformation;M$t.getObbtoObbMatrix4x4(M$a,M$b,M$c,M$t._tempM0),M$b._getLocalCorners(M$t._corners),M$gb.transformCoordinate(M$t._corners[0],M$t._tempM0,M$t._corners[0]),M$gb.transformCoordinate(M$t._corners[1],M$t._tempM0,M$t._corners[1]),M$gb.transformCoordinate(M$t._corners[2],M$t._tempM0,M$t._corners[2]),M$gb.transformCoordinate(M$t._corners[3],M$t._tempM0,M$t._corners[3]),M$gb.transformCoordinate(M$t._corners[4],M$t._tempM0,M$t._corners[4]),M$gb.transformCoordinate(M$t._corners[5],M$t._tempM0,M$t._corners[5]),M$gb.transformCoordinate(M$t._corners[6],M$t._tempM0,M$t._corners[6]),M$gb.transformCoordinate(M$t._corners[7],M$t._tempM0,M$t._corners[7]),M$gb.scale(M$d,-1,M$t._boxBound1.min),M$d.cloneTo(M$t._boxBound1.max),M$Za.createfromPoints(M$t._corners,M$t._boxBound2),M$Za.merge(M$t._boxBound2,M$t._boxBound1,M$t._boxBound3);var M$f=M$t._boxBound3.min,M$g=M$t._boxBound3.max;M$gb.subtract(M$g,M$f,M$t._tempV30),M$gb.scale(M$t._tempV30,.5,M$t._tempV30),M$gb.add(M$f,M$t._tempV30,M$t._tempV32),M$gb.subtract(M$g,M$t._tempV32,M$d),M$gb.transformCoordinate(M$t._tempV32,M$e,M$t._tempV33)},M$l(M$t,["_tempV30",function(){return this._tempV30=new M$gb},"_tempV31",function(){return this._tempV31=new M$gb},"_tempV32",function(){return this._tempV32=new M$gb},"_tempV33",function(){return this._tempV33=new M$gb},"_tempV34",function(){return this._tempV34=new M$gb},"_tempV35",function(){return this._tempV35=new M$gb},"_tempV36",function(){return this._tempV36=new M$gb},"_tempM0",function(){return this._tempM0=new M$ab},"_tempM1",function(){return this._tempM1=new M$ab},"_corners",function(){return this._corners=[new M$gb,new M$gb,new M$gb,new M$gb,new M$gb,new M$gb,new M$gb,new M$gb]},"_rows1",function(){return this._rows1=[new M$gb,new M$gb,new M$gb]},"_rows2",function(){return this._rows2=[new M$gb,new M$gb,new M$gb]},"_ray",function(){return this._ray=new M$eb(new M$gb,new M$gb)},"_boxBound1",function(){return this._boxBound1=new M$Za(new M$gb,new M$gb)},"_boxBound2",function(){return this._boxBound2=new M$Za(new M$gb,new M$gb)},"_boxBound3",function(){return this._boxBound3=new M$Za(new M$gb,new M$gb)}])}(),function(){function M$v(M$a,M$b){this.normal=null,this.distance=NaN,void 0===M$b&&(M$b=0),this.normal=M$a,this.distance=M$b}return M$n(M$v,"laya.d3.math.Plane"),M$v.prototype.normalize=function(){var M$a=this.normal.elements,M$b=M$a[0],M$c=M$a[1],M$d=M$a[2],M$e=1/Math.sqrt(M$b*M$b+M$c*M$c+M$d*M$d);M$a[0]=M$b*M$e,M$a[1]=M$c*M$e,M$a[2]=M$d*M$e,this.distance*=M$e},M$v.createPlaneBy3P=function(M$a,M$b,M$c){var M$d=M$a.elements,M$e=M$b.elements,M$f=M$c.elements,M$g=M$e[0]-M$d[0],M$h=M$e[1]-M$d[1],M$i=M$e[2]-M$d[2],M$j=M$f[0]-M$d[0],M$k=M$f[1]-M$d[1],M$l=M$f[2]-M$d[2],M$m=M$h*M$l-M$i*M$k,M$n=M$i*M$j-M$g*M$l,M$o=M$g*M$k-M$h*M$j,M$p=1/Math.sqrt(M$m*M$m+M$n*M$n+M$o*M$o),M$q=M$m*M$p,M$r=M$n*M$p,M$s=M$o*M$p,M$t=M$v._TEMPVec3.elements;M$t[0]=M$q,M$t[1]=M$r,M$t[2]=M$s;var M$u=-(M$q*M$d[0]+M$r*M$d[1]+M$s*M$d[2]);return new M$v(M$v._TEMPVec3,M$u)},M$v.PlaneIntersectionType_Back=0,M$v.PlaneIntersectionType_Front=1,M$v.PlaneIntersectionType_Intersecting=2,M$l(M$v,["_TEMPVec3",function(){return this._TEMPVec3=new M$gb}]),M$v}()),M$cb=function(){function M$e(M$a,M$b,M$c,M$d){this.elements=new Float32Array(4),void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=1),this.elements[0]=M$a,this.elements[1]=M$b,this.elements[2]=M$c,this.elements[3]=M$d}M$n(M$e,"laya.d3.math.Quaternion");var M$a=M$e.prototype;return M$v.imps(M$a,{"laya.d3.core.IClone":!0}),M$a.scaling=function(M$a,M$b){var M$c=M$b.elements,M$d=this.elements;M$c[0]=M$d[0]*M$a,M$c[1]=M$d[1]*M$a,M$c[2]=M$d[2]*M$a,M$c[3]=M$d[3]*M$a},M$a.normalize=function(M$a){var M$b=M$a.elements,M$c=this.elements,M$d=M$c[0],M$e=M$c[1],M$f=M$c[2],M$g=M$c[3],M$h=M$d*M$d+M$e*M$e+M$f*M$f+M$g*M$g;0<M$h&&(M$h=1/Math.sqrt(M$h),M$b[0]=M$d*M$h,M$b[1]=M$e*M$h,M$b[2]=M$f*M$h,M$b[3]=M$g*M$h)},M$a.length=function(){var M$a=this.elements,M$b=M$a[0],M$c=M$a[1],M$d=M$a[2],M$e=M$a[3];return Math.sqrt(M$b*M$b+M$c*M$c+M$d*M$d+M$e*M$e)},M$a.rotateX=function(M$a,M$b){var M$c=M$b.elements,M$d=this.elements;M$a*=.5;var M$e=M$d[0],M$f=M$d[1],M$g=M$d[2],M$h=M$d[3],M$i=Math.sin(M$a),M$j=Math.cos(M$a);M$c[0]=M$e*M$j+M$h*M$i,M$c[1]=M$f*M$j+M$g*M$i,M$c[2]=M$g*M$j-M$f*M$i,M$c[3]=M$h*M$j-M$e*M$i},M$a.rotateY=function(M$a,M$b){var M$c=M$b.elements,M$d=this.elements;M$a*=.5;var M$e=M$d[0],M$f=M$d[1],M$g=M$d[2],M$h=M$d[3],M$i=Math.sin(M$a),M$j=Math.cos(M$a);M$c[0]=M$e*M$j-M$g*M$i,M$c[1]=M$f*M$j+M$h*M$i,M$c[2]=M$g*M$j+M$e*M$i,M$c[3]=M$h*M$j-M$f*M$i},M$a.rotateZ=function(M$a,M$b){var M$c=M$b.elements,M$d=this.elements;M$a*=.5;var M$e=M$d[0],M$f=M$d[1],M$g=M$d[2],M$h=M$d[3],M$i=Math.sin(M$a),M$j=Math.cos(M$a);M$c[0]=M$e*M$j+M$f*M$i,M$c[1]=M$f*M$j-M$e*M$i,M$c[2]=M$g*M$j+M$h*M$i,M$c[3]=M$h*M$j-M$g*M$i},M$a.getYawPitchRoll=function(M$a){M$gb.transformQuat(M$gb.ForwardRH,this,M$e.TEMPVector31),M$gb.transformQuat(M$gb.Up,this,M$e.TEMPVector32);var M$b=M$e.TEMPVector32.elements;M$e.angleTo(M$gb.ZERO,M$e.TEMPVector31,M$e.TEMPVector33);var M$c=M$e.TEMPVector33.elements;M$c[0]==Math.PI/2?(M$c[1]=M$e.arcTanAngle(M$b[2],M$b[0]),M$c[2]=0):M$c[0]==-Math.PI/2?(M$c[1]=M$e.arcTanAngle(-M$b[2],-M$b[0]),M$c[2]=0):(M$ab.createRotationY(-M$c[1],M$e.TEMPMatrix0),M$ab.createRotationX(-M$c[0],M$e.TEMPMatrix1),M$gb.transformCoordinate(M$e.TEMPVector32,M$e.TEMPMatrix0,M$e.TEMPVector32),M$gb.transformCoordinate(M$e.TEMPVector32,M$e.TEMPMatrix1,M$e.TEMPVector32),M$c[2]=M$e.arcTanAngle(M$b[1],-M$b[0])),M$c[1]<=-Math.PI&&(M$c[1]=Math.PI),M$c[2]<=-Math.PI&&(M$c[2]=Math.PI),M$c[1]>=Math.PI&&M$c[2]>=Math.PI&&(M$c[1]=0,M$c[2]=0,M$c[0]=Math.PI-M$c[0]);var M$d=M$a.elements;M$d[0]=M$c[1],M$d[1]=M$c[0],M$d[2]=M$c[2]},M$a.invert=function(M$a){var M$b=M$a.elements,M$c=this.elements,M$d=M$c[0],M$e=M$c[1],M$f=M$c[2],M$g=M$c[3],M$h=M$d*M$d+M$e*M$e+M$f*M$f+M$g*M$g,M$i=M$h?1/M$h:0;M$b[0]=-M$d*M$i,M$b[1]=-M$e*M$i,M$b[2]=-M$f*M$i,M$b[3]=M$g*M$i},M$a.identity=function(){var M$a=this.elements;M$a[0]=0,M$a[1]=0,M$a[2]=0,M$a[3]=1},M$a.fromArray=function(M$a,M$b){void 0===M$b&&(M$b=0),this.elements[0]=M$a[M$b+0],this.elements[1]=M$a[M$b+1],this.elements[2]=M$a[M$b+2],this.elements[3]=M$a[M$b+3]},M$a.cloneTo=function(M$a){var M$b,M$c,M$d;if((M$c=this.elements)!==(M$d=M$a.elements))for(M$b=0;M$b<4;++M$b)M$d[M$b]=M$c[M$b]},M$a.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$a.equals=function(M$a){var M$b=this.elements,M$c=M$a.elements;return M$ya.nearEqual(M$b[0],M$c[0])&&M$ya.nearEqual(M$b[1],M$c[1])&&M$ya.nearEqual(M$b[2],M$c[2])&&M$ya.nearEqual(M$b[3],M$c[3])},M$a.lengthSquared=function(){var M$a=this.elements[0],M$b=this.elements[1],M$c=this.elements[2],M$d=this.elements[3];return M$a*M$a+M$b*M$b+M$c*M$c+M$d*M$d},M$o(0,M$a,"x",function(){return this.elements[0]}),M$o(0,M$a,"y",function(){return this.elements[1]}),M$o(0,M$a,"z",function(){return this.elements[2]}),M$o(0,M$a,"w",function(){return this.elements[3]}),M$e.createFromYawPitchRoll=function(M$a,M$b,M$c,M$d){var M$e=.5*M$c,M$f=.5*M$b,M$g=.5*M$a,M$h=Math.sin(M$e),M$i=Math.cos(M$e),M$j=Math.sin(M$f),M$k=Math.cos(M$f),M$l=Math.sin(M$g),M$m=Math.cos(M$g),M$n=M$d.elements;M$n[0]=M$m*M$j*M$i+M$l*M$k*M$h,M$n[1]=M$l*M$k*M$i-M$m*M$j*M$h,M$n[2]=M$m*M$k*M$h-M$l*M$j*M$i,M$n[3]=M$m*M$k*M$i+M$l*M$j*M$h},M$e.multiply=function(M$a,M$b,M$c){var M$d=M$a.elements,M$e=M$b.elements,M$f=M$c.elements,M$g=M$d[0],M$h=M$d[1],M$i=M$d[2],M$j=M$d[3],M$k=M$e[0],M$l=M$e[1],M$m=M$e[2],M$n=M$e[3],M$o=M$h*M$m-M$i*M$l,M$p=M$i*M$k-M$g*M$m,M$q=M$g*M$l-M$h*M$k,M$r=M$g*M$k+M$h*M$l+M$i*M$m;M$f[0]=M$g*M$n+M$k*M$j+M$o,M$f[1]=M$h*M$n+M$l*M$j+M$p,M$f[2]=M$i*M$n+M$m*M$j+M$q,M$f[3]=M$j*M$n-M$r},M$e.arcTanAngle=function(M$a,M$b){return 0==M$a?1==M$b?Math.PI/2:-Math.PI/2:0<M$a?Math.atan(M$b/M$a):M$a<0?0<M$b?Math.atan(M$b/M$a)+Math.PI:Math.atan(M$b/M$a)-Math.PI:0},M$e.angleTo=function(M$a,M$b,M$c){M$gb.subtract(M$b,M$a,M$e.TEMPVector30),M$gb.normalize(M$e.TEMPVector30,M$e.TEMPVector30),M$c.elements[0]=Math.asin(M$e.TEMPVector30.y),M$c.elements[1]=M$e.arcTanAngle(-M$e.TEMPVector30.z,-M$e.TEMPVector30.x)},M$e.createFromAxisAngle=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements;M$b*=.5;var M$f=Math.sin(M$b);M$d[0]=M$f*M$e[0],M$d[1]=M$f*M$e[1],M$d[2]=M$f*M$e[2],M$d[3]=Math.cos(M$b)},M$e.createFromMatrix3x3=function(M$a,M$b){var M$c,M$d=M$b.elements,M$e=M$a.elements,M$f=M$e[0]+M$e[4]+M$e[8];if(0<M$f)M$c=Math.sqrt(M$f+1),M$d[3]=.5*M$c,M$c=.5/M$c,M$d[0]=(M$e[5]-M$e[7])*M$c,M$d[1]=(M$e[6]-M$e[2])*M$c,M$d[2]=(M$e[1]-M$e[3])*M$c;else{var M$g=0;M$e[4]>M$e[0]&&(M$g=1),M$e[8]>M$e[3*M$g+M$g]&&(M$g=2);var M$h=(M$g+1)%3,M$i=(M$g+2)%3;M$c=Math.sqrt(M$e[3*M$g+M$g]-M$e[3*M$h+M$h]-M$e[3*M$i+M$i]+1),M$d[M$g]=.5*M$c,M$c=.5/M$c,M$d[3]=(M$e[3*M$h+M$i]-M$e[3*M$i+M$h])*M$c,M$d[M$h]=(M$e[3*M$h+M$g]+M$e[3*M$g+M$h])*M$c,M$d[M$i]=(M$e[3*M$i+M$g]+M$e[3*M$g+M$i])*M$c}},M$e.createFromMatrix4x4=function(M$a,M$b){var M$c,M$d,M$e=M$a.elements,M$f=M$b.elements,M$g=M$e[0]+M$e[5]+M$e[10];0<M$g?(M$c=Math.sqrt(M$g+1),M$f[3]=.5*M$c,M$c=.5/M$c,M$f[0]=(M$e[6]-M$e[9])*M$c,M$f[1]=(M$e[8]-M$e[2])*M$c,M$f[2]=(M$e[1]-M$e[4])*M$c):M$e[0]>=M$e[5]&&M$e[0]>=M$e[10]?(M$d=.5/(M$c=Math.sqrt(1+M$e[0]-M$e[5]-M$e[10])),M$f[0]=.5*M$c,M$f[1]=(M$e[1]+M$e[4])*M$d,M$f[2]=(M$e[2]+M$e[8])*M$d,M$f[3]=(M$e[6]-M$e[9])*M$d):M$e[5]>M$e[10]?(M$d=.5/(M$c=Math.sqrt(1+M$e[5]-M$e[0]-M$e[10])),M$f[0]=(M$e[4]+M$e[1])*M$d,M$f[1]=.5*M$c,M$f[2]=(M$e[9]+M$e[6])*M$d,M$f[3]=(M$e[8]-M$e[2])*M$d):(M$d=.5/(M$c=Math.sqrt(1+M$e[10]-M$e[0]-M$e[5])),M$f[0]=(M$e[8]+M$e[2])*M$d,M$f[1]=(M$e[9]+M$e[6])*M$d,M$f[2]=.5*M$c,M$f[3]=(M$e[1]-M$e[4])*M$d)},M$e.slerp=function(M$a,M$b,M$c,M$d){var M$e,M$f,M$g,M$h,M$i,M$j=M$a.elements,M$k=M$b.elements,M$l=M$d.elements,M$m=M$j[0],M$n=M$j[1],M$o=M$j[2],M$p=M$j[3],M$q=M$k[0],M$r=M$k[1],M$s=M$k[2],M$t=M$k[3];return(M$f=M$m*M$q+M$n*M$r+M$o*M$s+M$p*M$t)<0&&(M$f=-M$f,M$q=-M$q,M$r=-M$r,M$s=-M$s,M$t=-M$t),M$i=1e-6<1-M$f?(M$e=Math.acos(M$f),M$g=Math.sin(M$e),M$h=Math.sin((1-M$c)*M$e)/M$g,Math.sin(M$c*M$e)/M$g):(M$h=1-M$c,M$c),M$l[0]=M$h*M$m+M$i*M$q,M$l[1]=M$h*M$n+M$i*M$r,M$l[2]=M$h*M$o+M$i*M$s,M$l[3]=M$h*M$p+M$i*M$t,M$l},M$e.lerp=function(M$a,M$b,M$c,M$d){var M$e=M$d.elements,M$f=M$a.elements,M$g=M$b.elements,M$h=M$f[0],M$i=M$f[1],M$j=M$f[2],M$k=M$f[3];M$e[0]=M$h+M$c*(M$g[0]-M$h),M$e[1]=M$i+M$c*(M$g[1]-M$i),M$e[2]=M$j+M$c*(M$g[2]-M$j),M$e[3]=M$k+M$c*(M$g[3]-M$k)},M$e.add=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements;M$d[0]=M$e[0]+M$f[0],M$d[1]=M$e[1]+M$f[1],M$d[2]=M$e[2]+M$f[2],M$d[3]=M$e[3]+M$f[3]},M$e.dot=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements;return M$c[0]*M$d[0]+M$c[1]*M$d[1]+M$c[2]*M$d[2]+M$c[3]*M$d[3]},M$e.rotationLookAt=function(M$a,M$b,M$c){M$e.lookAt(M$gb.ZERO,M$a,M$b,M$c)},M$e.lookAt=function(M$a,M$b,M$c,M$d){M$za.lookAt(M$a,M$b,M$c,M$e._tempMatrix3x3),M$e.rotationMatrix(M$e._tempMatrix3x3,M$d)},M$e.invert=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements,M$e=M$a.lengthSquared();M$ya.isZero(M$e)||(M$e=1/M$e,M$d[0]=-M$c[0]*M$e,M$d[1]=-M$c[1]*M$e,M$d[2]=-M$c[2]*M$e,M$d[3]=M$c[3]*M$e)},M$e.rotationMatrix=function(M$a,M$b){var M$c=M$a.elements,M$d=M$c[0],M$e=M$c[1],M$f=M$c[2],M$g=M$c[3],M$h=M$c[4],M$i=M$c[5],M$j=M$c[6],M$k=M$c[7],M$l=M$c[8],M$m=M$b.elements,M$n=NaN,M$o=NaN,M$p=M$d+M$h+M$l;0<M$p?(M$n=Math.sqrt(M$p+1),M$m[3]=.5*M$n,M$n=.5/M$n,M$m[0]=(M$i-M$k)*M$n,M$m[1]=(M$j-M$f)*M$n,M$m[2]=(M$e-M$g)*M$n):M$h<=M$d&&M$l<=M$d?(M$o=.5/(M$n=Math.sqrt(1+M$d-M$h-M$l)),M$m[0]=.5*M$n,M$m[1]=(M$e+M$g)*M$o,M$m[2]=(M$f+M$j)*M$o,M$m[3]=(M$i-M$k)*M$o):M$l<M$h?(M$o=.5/(M$n=Math.sqrt(1+M$h-M$d-M$l)),M$m[0]=(M$g+M$e)*M$o,M$m[1]=.5*M$n,M$m[2]=(M$k+M$i)*M$o,M$m[3]=(M$j-M$f)*M$o):(M$o=.5/(M$n=Math.sqrt(1+M$l-M$d-M$h)),M$m[0]=(M$j+M$f)*M$o,M$m[1]=(M$k+M$i)*M$o,M$m[2]=.5*M$n,M$m[3]=(M$e-M$g)*M$o)},M$e.DEFAULT=new M$e,M$l(M$e,["TEMPVector30",function(){return this.TEMPVector30=new M$gb},"TEMPVector31",function(){return this.TEMPVector31=new M$gb},"TEMPVector32",function(){return this.TEMPVector32=new M$gb},"TEMPVector33",function(){return this.TEMPVector33=new M$gb},"TEMPMatrix0",function(){return this.TEMPMatrix0=new M$ab},"TEMPMatrix1",function(){return this.TEMPMatrix1=new M$ab},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new M$za},"NAN",function(){return this.NAN=new M$e(NaN,NaN,NaN,NaN)}]),M$e}(),M$db=function(){function M$a(M$a){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=M$a,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}M$n(M$a,"laya.d3.math.Rand");var M$b=M$a.prototype;return M$b.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},M$b.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},M$b.getSignedFloat=function(){return 2*this.getFloat()-1},M$o(0,M$b,"seed",function(){return this.seeds[0]},function(M$a){this.seeds[0]=M$a,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),M$a.getFloatFromInt=function(M$a){return 1/8388607*(8388607&M$a)},M$a.getByteFromInt=function(M$a){return(8388607&M$a)>>>15},M$a}(),M$eb=(function(){function M$e(M$a){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(M$a instanceof Array)||4!==M$a.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|M$a[0],this._state0L=0|M$a[1],this._state1U=0|M$a[2],this._state1L=0|M$a[3]}M$n(M$e,"laya.d3.math.RandX");var M$a=M$e.prototype;M$a.randomint=function(){var M$a=this._state0U,M$b=this._state0L,M$c=this._state1U,M$d=this._state1L,M$e=(M$d>>>0)+(M$b>>>0),M$f=M$c+M$a+(M$e/2>>>31)>>>0,M$g=M$e>>>0,M$h=0,M$i=0;M$h=(M$a^=M$h=M$a<<23|(-512&M$b)>>>9)^(this._state0U=M$c),M$i=(M$b^=M$i=M$b<<23)^(this._state0L=M$d);M$h^=M$a>>>18,M$i^=M$b>>>18|(262143&M$a)<<14;return M$h^=M$c>>>5,M$i^=M$d>>>5|(31&M$c)<<27,this._state1U=M$h,this._state1L=M$i,[M$f,M$g]},M$a.random=function(){var M$a=this.randomint(),M$b=M$a[0],M$c=1023<<20|M$b>>>12,M$d=0|(M$a[1]>>>12|(4095&M$b)<<20);return M$e._CONVERTION_BUFFER.setUint32(0,M$c,!1),M$e._CONVERTION_BUFFER.setUint32(4,M$d,!1),M$db._CONVERTION_BUFFER.getFloat64(0,!1)-1},M$l(M$e,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new M$db([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function M$a(M$a,M$b){this.origin=null,this.direction=null,this.origin=M$a,this.direction=M$b}return M$n(M$a,"laya.d3.math.Ray"),M$a}()),M$fb=function(){function M$a(M$a,M$b){this.elements=new Float32Array(2),void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0);var M$c=this.elements;M$c[0]=M$a,M$c[1]=M$b}M$n(M$a,"laya.d3.math.Vector2");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b.fromArray=function(M$a,M$b){void 0===M$b&&(M$b=0),this.elements[0]=M$a[M$b+0],this.elements[1]=M$a[M$b+1]},M$b.cloneTo=function(M$a){var M$b=M$a.elements,M$c=this.elements;M$b[0]=M$c[0],M$b[1]=M$c[1]},M$b.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$b,"x",function(){return this.elements[0]},function(M$a){this.elements[0]=M$a}),M$o(0,M$b,"y",function(){return this.elements[1]},function(M$a){this.elements[1]=M$a}),M$a.scale=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements;M$d[0]=M$e[0]*M$b,M$d[1]=M$e[1]*M$b},M$l(M$a,["ZERO",function(){return this.ZERO=new M$a(0,0)},"ONE",function(){return this.ONE=new M$a(1,1)}]),M$a}(),M$gb=function(){function M$k(M$a,M$b,M$c){this.elements=new Float32Array(3),void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0);var M$d=this.elements;M$d[0]=M$a,M$d[1]=M$b,M$d[2]=M$c}M$n(M$k,"laya.d3.math.Vector3");var M$a=M$k.prototype;return M$v.imps(M$a,{"laya.d3.core.IClone":!0}),M$a.fromArray=function(M$a,M$b){void 0===M$b&&(M$b=0),this.elements[0]=M$a[M$b+0],this.elements[1]=M$a[M$b+1],this.elements[2]=M$a[M$b+2]},M$a.cloneTo=function(M$a){var M$b=M$a.elements,M$c=this.elements;M$b[0]=M$c[0],M$b[1]=M$c[1],M$b[2]=M$c[2]},M$a.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$a.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},M$a.reset=function(M$a,M$b,M$c){this.elements[0]=M$a,this.elements[1]=M$b,this.elements[2]=M$c},M$o(0,M$a,"x",function(){return this.elements[0]},function(M$a){this.elements[0]=M$a}),M$o(0,M$a,"y",function(){return this.elements[1]},function(M$a){this.elements[1]=M$a}),M$o(0,M$a,"z",function(){return this.elements[2]},function(M$a){this.elements[2]=M$a}),M$k.distanceSquared=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements,M$e=M$c[0]-M$d[0],M$f=M$c[1]-M$d[1],M$g=M$c[2]-M$d[2];return M$e*M$e+M$f*M$f+M$g*M$g},M$k.distance=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements,M$e=M$c[0]-M$d[0],M$f=M$c[1]-M$d[1],M$g=M$c[2]-M$d[2];return Math.sqrt(M$e*M$e+M$f*M$f+M$g*M$g)},M$k.min=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements;M$d[0]=Math.min(M$e[0],M$f[0]),M$d[1]=Math.min(M$e[1],M$f[1]),M$d[2]=Math.min(M$e[2],M$f[2])},M$k.max=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements;M$d[0]=Math.max(M$e[0],M$f[0]),M$d[1]=Math.max(M$e[1],M$f[1]),M$d[2]=Math.max(M$e[2],M$f[2])},M$k.transformQuat=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements,M$g=M$e[0],M$h=M$e[1],M$i=M$e[2],M$j=M$f[0],M$k=M$f[1],M$l=M$f[2],M$m=M$f[3],M$n=M$m*M$g+M$k*M$i-M$l*M$h,M$o=M$m*M$h+M$l*M$g-M$j*M$i,M$p=M$m*M$i+M$j*M$h-M$k*M$g,M$q=-M$j*M$g-M$k*M$h-M$l*M$i;M$d[0]=M$n*M$m+M$q*-M$j+M$o*-M$l-M$p*-M$k,M$d[1]=M$o*M$m+M$q*-M$k+M$p*-M$j-M$n*-M$l,M$d[2]=M$p*M$m+M$q*-M$l+M$n*-M$k-M$o*-M$j},M$k.scalarLength=function(M$a){var M$b=M$a.elements,M$c=M$b[0],M$d=M$b[1],M$e=M$b[2];return Math.sqrt(M$c*M$c+M$d*M$d+M$e*M$e)},M$k.scalarLengthSquared=function(M$a){var M$b=M$a.elements,M$c=M$b[0],M$d=M$b[1],M$e=M$b[2];return M$c*M$c+M$d*M$d+M$e*M$e},M$k.normalize=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements,M$e=M$c[0],M$f=M$c[1],M$g=M$c[2],M$h=M$e*M$e+M$f*M$f+M$g*M$g;0<M$h&&(M$h=1/Math.sqrt(M$h),M$d[0]=M$c[0]*M$h,M$d[1]=M$c[1]*M$h,M$d[2]=M$c[2]*M$h)},M$k.multiply=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements;M$d[0]=M$e[0]*M$f[0],M$d[1]=M$e[1]*M$f[1],M$d[2]=M$e[2]*M$f[2]},M$k.scale=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements;M$d[0]=M$e[0]*M$b,M$d[1]=M$e[1]*M$b,M$d[2]=M$e[2]*M$b},M$k.lerp=function(M$a,M$b,M$c,M$d){var M$e=M$d.elements,M$f=M$a.elements,M$g=M$b.elements,M$h=M$f[0],M$i=M$f[1],M$j=M$f[2];M$e[0]=M$h+M$c*(M$g[0]-M$h),M$e[1]=M$i+M$c*(M$g[1]-M$i),M$e[2]=M$j+M$c*(M$g[2]-M$j)},M$k.transformV3ToV3=function(M$a,M$b,M$c){var M$d=M$k._tempVector4;M$k.transformV3ToV4(M$a,M$b,M$d);var M$e=M$d.elements,M$f=M$c.elements;M$f[0]=M$e[0],M$f[1]=M$e[1],M$f[2]=M$e[2]},M$k.transformV3ToV4=function(M$a,M$b,M$c){var M$d=M$a.elements,M$e=M$d[0],M$f=M$d[1],M$g=M$d[2],M$h=M$b.elements,M$i=M$c.elements;M$i[0]=M$e*M$h[0]+M$f*M$h[4]+M$g*M$h[8]+M$h[12],M$i[1]=M$e*M$h[1]+M$f*M$h[5]+M$g*M$h[9]+M$h[13],M$i[2]=M$e*M$h[2]+M$f*M$h[6]+M$g*M$h[10]+M$h[14],M$i[3]=M$e*M$h[3]+M$f*M$h[7]+M$g*M$h[11]+M$h[15]},M$k.TransformNormal=function(M$a,M$b,M$c){var M$d=M$a.elements,M$e=M$d[0],M$f=M$d[1],M$g=M$d[2],M$h=M$b.elements,M$i=M$c.elements;M$i[0]=M$e*M$h[0]+M$f*M$h[4]+M$g*M$h[8],M$i[1]=M$e*M$h[1]+M$f*M$h[5]+M$g*M$h[9],M$i[2]=M$e*M$h[2]+M$f*M$h[6]+M$g*M$h[10]},M$k.transformCoordinate=function(M$a,M$b,M$c){var M$d=M$k._tempVector4.elements,M$e=M$a.elements,M$f=M$e[0],M$g=M$e[1],M$h=M$e[2],M$i=M$b.elements;M$d[0]=M$f*M$i[0]+M$g*M$i[4]+M$h*M$i[8]+M$i[12],M$d[1]=M$f*M$i[1]+M$g*M$i[5]+M$h*M$i[9]+M$i[13],M$d[2]=M$f*M$i[2]+M$g*M$i[6]+M$h*M$i[10]+M$i[14],M$d[3]=1/(M$f*M$i[3]+M$g*M$i[7]+M$h*M$i[11]+M$i[15]);var M$j=M$c.elements;M$j[0]=M$d[0]*M$d[3],M$j[1]=M$d[1]*M$d[3],M$j[2]=M$d[2]*M$d[3]},M$k.Clamp=function(M$a,M$b,M$c,M$d){var M$e=M$a.elements,M$f=M$e[0],M$g=M$e[1],M$h=M$e[2],M$i=M$b.elements,M$j=M$i[0],M$k=M$i[1],M$l=M$i[2],M$m=M$c.elements,M$n=M$m[0],M$o=M$m[1],M$p=M$m[2],M$q=M$d.elements;M$f=(M$f=M$n<M$f?M$n:M$f)<M$j?M$j:M$f,M$g=(M$g=M$o<M$g?M$o:M$g)<M$k?M$k:M$g,M$h=(M$h=M$p<M$h?M$p:M$h)<M$l?M$l:M$h,M$q[0]=M$f,M$q[1]=M$g,M$q[2]=M$h},M$k.add=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements;M$d[0]=M$e[0]+M$f[0],M$d[1]=M$e[1]+M$f[1],M$d[2]=M$e[2]+M$f[2]},M$k.subtract=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements;M$d[0]=M$e[0]-M$f[0],M$d[1]=M$e[1]-M$f[1],M$d[2]=M$e[2]-M$f[2]},M$k.cross=function(M$a,M$b,M$c){var M$d=M$a.elements,M$e=M$b.elements,M$f=M$c.elements,M$g=M$d[0],M$h=M$d[1],M$i=M$d[2],M$j=M$e[0],M$k=M$e[1],M$l=M$e[2];M$f[0]=M$h*M$l-M$i*M$k,M$f[1]=M$i*M$j-M$g*M$l,M$f[2]=M$g*M$k-M$h*M$j},M$k.dot=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements;return M$c[0]*M$d[0]+M$c[1]*M$d[1]+M$c[2]*M$d[2]},M$k.equals=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements;return M$ya.nearEqual(Math.abs(M$c[0]),Math.abs(M$d[0]))&&M$ya.nearEqual(Math.abs(M$c[1]),Math.abs(M$d[1]))&&M$ya.nearEqual(Math.abs(M$c[2]),Math.abs(M$d[2]))},M$k.ZERO=new M$k(0,0,0),M$k.ONE=new M$k(1,1,1),M$k.NegativeUnitX=new M$k(-1,0,0),M$k.UnitX=new M$k(1,0,0),M$k.UnitY=new M$k(0,1,0),M$k.UnitZ=new M$k(0,0,1),M$k.ForwardRH=new M$k(0,0,-1),M$k.ForwardLH=new M$k(0,0,1),M$k.Up=new M$k(0,1,0),M$k.NAN=new M$k(NaN,NaN,NaN),M$l(M$k,["_tempVector4",function(){return this._tempVector4=new M$hb}]),M$k}(),M$hb=function(){function M$a(M$a,M$b,M$c,M$d){this.elements=new Float32Array(4),void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=0);var M$e=this.elements;M$e[0]=M$a,M$e[1]=M$b,M$e[2]=M$c,M$e[3]=M$d}M$n(M$a,"laya.d3.math.Vector4");var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b.fromArray=function(M$a,M$b){void 0===M$b&&(M$b=0),this.elements[0]=M$a[M$b+0],this.elements[1]=M$a[M$b+1],this.elements[2]=M$a[M$b+2],this.elements[3]=M$a[M$b+3]},M$b.cloneTo=function(M$a){var M$b=M$a.elements,M$c=this.elements;M$b[0]=M$c[0],M$b[1]=M$c[1],M$b[2]=M$c[2],M$b[3]=M$c[3]},M$b.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$b.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},M$b.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},M$o(0,M$b,"x",function(){return this.elements[0]},function(M$a){this.elements[0]=M$a}),M$o(0,M$b,"y",function(){return this.elements[1]},function(M$a){this.elements[1]=M$a}),M$o(0,M$b,"z",function(){return this.elements[2]},function(M$a){this.elements[2]=M$a}),M$o(0,M$b,"w",function(){return this.elements[3]},function(M$a){this.elements[3]=M$a}),M$a.lerp=function(M$a,M$b,M$c,M$d){var M$e=M$d.elements,M$f=M$a.elements,M$g=M$b.elements,M$h=M$f[0],M$i=M$f[1],M$j=M$f[2],M$k=M$f[3];M$e[0]=M$h+M$c*(M$g[0]-M$h),M$e[1]=M$i+M$c*(M$g[1]-M$i),M$e[2]=M$j+M$c*(M$g[2]-M$j),M$e[3]=M$k+M$c*(M$g[3]-M$k)},M$a.transformByM4x4=function(M$a,M$b,M$c){var M$d=M$a.elements,M$e=M$d[0],M$f=M$d[1],M$g=M$d[2],M$h=M$d[3],M$i=M$b.elements,M$j=M$c.elements;M$j[0]=M$e*M$i[0]+M$f*M$i[4]+M$g*M$i[8]+M$h*M$i[12],M$j[1]=M$e*M$i[1]+M$f*M$i[5]+M$g*M$i[9]+M$h*M$i[13],M$j[2]=M$e*M$i[2]+M$f*M$i[6]+M$g*M$i[10]+M$h*M$i[14],M$j[3]=M$e*M$i[3]+M$f*M$i[7]+M$g*M$i[11]+M$h*M$i[15]},M$a.equals=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements;return M$ya.nearEqual(Math.abs(M$c[0]),Math.abs(M$d[0]))&&M$ya.nearEqual(Math.abs(M$c[1]),Math.abs(M$d[1]))&&M$ya.nearEqual(Math.abs(M$c[2]),Math.abs(M$d[2]))&&M$ya.nearEqual(Math.abs(M$c[3]),Math.abs(M$d[3]))},M$a.normalize=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements,M$e=M$a.length();0<M$e&&(M$d[0]=M$c[0]*M$e,M$d[1]=M$c[1]*M$e,M$d[2]=M$c[2]*M$e,M$d[3]=M$c[3]*M$e)},M$a.add=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements;M$d[0]=M$e[0]+M$f[0],M$d[1]=M$e[1]+M$f[1],M$d[2]=M$e[2]+M$f[2],M$d[3]=M$e[3]+M$f[3]},M$a.subtract=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements;M$d[0]=M$e[0]-M$f[0],M$d[1]=M$e[1]-M$f[1],M$d[2]=M$e[2]-M$f[2],M$d[3]=M$e[3]-M$f[3]},M$a.multiply=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements;M$d[0]=M$e[0]*M$f[0],M$d[1]=M$e[1]*M$f[1],M$d[2]=M$e[2]*M$f[2],M$d[3]=M$e[3]*M$f[3]},M$a.scale=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements;M$d[0]=M$e[0]*M$b,M$d[1]=M$e[1]*M$b,M$d[2]=M$e[2]*M$b,M$d[3]=M$e[3]*M$b},M$a.Clamp=function(M$a,M$b,M$c,M$d){var M$e=M$a.elements,M$f=M$e[0],M$g=M$e[1],M$h=M$e[2],M$i=M$e[3],M$j=M$b.elements,M$k=M$j[0],M$l=M$j[1],M$m=M$j[2],M$n=M$j[3],M$o=M$c.elements,M$p=M$o[0],M$q=M$o[1],M$r=M$o[2],M$s=M$o[3],M$t=M$d.elements;M$f=(M$f=M$p<M$f?M$p:M$f)<M$k?M$k:M$f,M$g=(M$g=M$q<M$g?M$q:M$g)<M$l?M$l:M$g,M$h=(M$h=M$r<M$h?M$r:M$h)<M$m?M$m:M$h,M$i=(M$i=M$s<M$i?M$s:M$i)<M$n?M$n:M$i,M$t[0]=M$f,M$t[1]=M$g,M$t[2]=M$h,M$t[3]=M$i},M$a.distanceSquared=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements,M$e=M$c[0]-M$d[0],M$f=M$c[1]-M$d[1],M$g=M$c[2]-M$d[2],M$h=M$c[3]-M$d[3];return M$e*M$e+M$f*M$f+M$g*M$g+M$h*M$h},M$a.distance=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements,M$e=M$c[0]-M$d[0],M$f=M$c[1]-M$d[1],M$g=M$c[2]-M$d[2],M$h=M$c[3]-M$d[3];return Math.sqrt(M$e*M$e+M$f*M$f+M$g*M$g+M$h*M$h)},M$a.dot=function(M$a,M$b){var M$c=M$a.elements,M$d=M$b.elements;return M$c[0]*M$d[0]+M$c[1]*M$d[1]+M$c[2]*M$d[2]+M$c[3]*M$d[3]},M$a.min=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements;M$d[0]=Math.min(M$e[0],M$f[0]),M$d[1]=Math.min(M$e[1],M$f[1]),M$d[2]=Math.min(M$e[2],M$f[2]),M$d[3]=Math.min(M$e[3],M$f[3])},M$a.max=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b.elements;M$d[0]=Math.max(M$e[0],M$f[0]),M$d[1]=Math.max(M$e[1],M$f[1]),M$d[2]=Math.max(M$e[2],M$f[2]),M$d[3]=Math.max(M$e[3],M$f[3])},M$l(M$a,["ZERO",function(){return this.ZERO=new M$a},"ONE",function(){return this.ONE=new M$a(1,1,1,1)},"UnitX",function(){return this.UnitX=new M$a(1,0,0,0)},"UnitY",function(){return this.UnitY=new M$a(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new M$a(0,0,1,0)},"UnitW",function(){return this.UnitW=new M$a(0,0,0,1)}]),M$a}(),M$ib=function(){function M$f(M$a,M$b,M$c,M$d){this.minDepth=0,this.maxDepth=1,this.x=M$a,this.y=M$b,this.width=M$c,this.height=M$d}M$n(M$f,"laya.d3.math.Viewport");var M$a=M$f.prototype;return M$a.project=function(M$a,M$b,M$c){M$gb.transformV3ToV3(M$a,M$b,M$c);var M$d=M$a.elements,M$e=M$b.elements,M$f=M$c.elements,M$g=M$d[0]*M$e[3]+M$d[1]*M$e[7]+M$d[2]*M$e[11]+M$e[15];1!==M$g&&(M$f[0]=M$f[0]/M$g,M$f[1]=M$f[1]/M$g,M$f[2]=M$f[2]/M$g),M$f[0]=.5*(M$f[0]+1)*this.width+this.x,M$f[1]=.5*(1-M$f[1])*this.height+this.y,M$f[2]=M$f[2]*(this.maxDepth-this.minDepth)+this.minDepth},M$a.unprojectFromMat=function(M$a,M$b,M$c){var M$d=M$a.elements,M$e=M$b.elements,M$f=M$c.elements;M$f[0]=(M$d[0]-this.x)/this.width*2-1,M$f[1]=-((M$d[1]-this.y)/this.height*2-1);var M$g=(this.maxDepth-this.minDepth)/2;M$f[2]=(M$d[2]-this.minDepth-M$g)/M$g;var M$h=M$f[0]*M$e[3]+M$f[1]*M$e[7]+M$f[2]*M$e[11]+M$e[15];M$gb.transformV3ToV3(M$c,M$b,M$c),1!==M$h&&(M$f[0]=M$f[0]/M$h,M$f[1]=M$f[1]/M$h,M$f[2]=M$f[2]/M$h)},M$a.unprojectFromWVP=function(M$a,M$b,M$c,M$d,M$e){M$ab.multiply(M$b,M$c,M$f._tempMatrix4x4),M$d&&M$ab.multiply(M$f._tempMatrix4x4,M$d,M$f._tempMatrix4x4),M$f._tempMatrix4x4.invert(M$f._tempMatrix4x4),this.unprojectFromMat(M$a,M$f._tempMatrix4x4,M$e)},M$l(M$f,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new M$ab}]),M$f}(),M$jb=function(){function M$E(M$a){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=M$a,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}M$n(M$E,"laya.d3.resource.models.SubMesh");var M$a=M$E.prototype;return M$v.imps(M$a,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),M$a._getVertexBuffer=function(M$a){return void 0===M$a&&(M$a=0),0===M$a?this._vertexBuffer:null},M$a._getIndexBuffer=function(){return this._indexBuffer},M$a._getStaticBatchBakedVertexs=function(M$a,M$b){var M$c,M$d,M$e=this._vertexBuffer,M$f=M$e.vertexDeclaration,M$g=M$f.getVertexElementByUsage(0).offset/4,M$h=M$f.getVertexElementByUsage(3).offset/4,M$i=M$b.meshRender.lightmapScaleOffset,M$j=0,M$k=0,M$l=0,M$m=0,M$n=0,M$o=0;if(M$i)if(M$d=M$f.getVertexElementByUsage(15))M$l=M$f.vertexStride/4,M$c=0<this._vertexCount?M$e.getData().slice(this._vertexStart*M$l,(this._vertexStart+this._vertexCount)*M$l):M$e.getData().slice(),M$m=M$d.offset/4;else{M$l=(M$o=M$f.vertexStride/4)+2,M$c=this._vertexCount?new Float32Array(this._vertexCount*(M$e.vertexDeclaration.vertexStride/4+2)):new Float32Array(M$e.vertexCount*(M$e.vertexDeclaration.vertexStride/4+2)),M$m=(M$n=M$f.getVertexElementByUsage(2).offset/4)+2;var M$p=M$e.getData();for(M$j=0,M$k=M$p.length/M$o;M$j<M$k;M$j++){var M$q=0;M$q=0<this._vertexCount?(this._vertexStart+M$j)*M$o:M$j*M$o;var M$r=M$j*M$l,M$s=0;for(M$s=0;M$s<M$m;M$s++)M$c[M$r+M$s]=M$p[M$q+M$s];for(M$s=M$m;M$s<M$o;M$s++)M$c[M$r+M$s+2]=M$p[M$q+M$s]}}else M$l=M$f.vertexStride/4,M$c=this._vertexCount?M$e.getData().slice(this._vertexStart*M$l,(this._vertexStart+this._vertexCount)*M$l):M$e.getData().slice();if(M$a){var M$t=M$a.worldMatrix,M$u=M$E._tempMatrix4x40;M$t.invert(M$u);var M$v=M$E._tempMatrix4x41,M$w=M$b.transform.worldMatrix;M$ab.multiply(M$u,M$w,M$v)}else M$v=M$b.transform.worldMatrix;var M$x=M$E._tempQuaternion0;for(M$v.decomposeTransRotScale(M$E._tempVector30,M$x,M$E._tempVector31),M$j=0,M$k=M$c.length/M$l;M$j<M$k;M$j++){var M$A=M$j*M$l+M$g,M$B=M$j*M$l+M$h;if(M$qb.transformVector3ArrayToVector3ArrayCoordinate(M$c,M$A,M$v,M$c,M$A),M$qb.transformVector3ArrayByQuat(M$c,M$B,M$x,M$c,M$B),M$i){var M$C=M$j*M$l+M$m;if(M$d)M$qb.transformLightingMapTexcoordByUV1Array(M$c,M$C,M$i,M$c,M$C);else{var M$D=M$j*M$o+M$n;M$qb.transformLightingMapTexcoordByUV0Array(M$p,M$D,M$i,M$c,M$C)}}}return M$c},M$a._getVertexBuffers=function(){return null},M$a._beforeRender=function(M$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},M$a._render=function(M$a){var M$b,M$c=0,M$d=M$a.renderElement;if(1<this._indexCount){var M$e=this._boneIndicesList.length;if(1<M$e){for(var M$f=0;M$f<M$e;M$f++)(M$b=M$d._skinAnimationDatas||this._skinAnimationDatas)&&(M$d._shaderValue.setValue(0,M$b[M$f]),M$a._shader.uploadRenderElementUniforms(M$d._shaderValue.data)),M$F.mainContext.drawElements(4,this._subIndexBufferCount[M$f],5123,2*this._subIndexBufferStart[M$f]);M$A.drawCall+=M$e}else(M$b=M$d._skinAnimationDatas||this._skinAnimationDatas)&&(M$d._shaderValue.setValue(0,M$b[0]),M$a._shader.uploadRenderElementUniforms(M$d._shaderValue.data)),M$F.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),M$A.drawCall++;M$c=this._indexCount}else M$c=this._indexBuffer.indexCount,(M$b=M$d._skinAnimationDatas||this._skinAnimationDatas)&&(M$d._shaderValue.setValue(0,M$b[0]),M$a._shader.uploadRenderElementUniforms(M$d._shaderValue.data)),M$F.mainContext.drawElements(4,M$c,5123,0),M$A.drawCall++;M$A.trianglesFaces+=M$c/3},M$a.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},M$a.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},M$o(0,M$a,"_vertexBufferCount",function(){return 1}),M$o(0,M$a,"triangleCount",function(){return this._indexBuffer.indexCount/3}),M$l(M$E,["_tempVector30",function(){return this._tempVector30=new M$gb},"_tempVector31",function(){return this._tempVector31=new M$gb},"_tempQuaternion0",function(){return this._tempQuaternion0=new M$cb},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new M$ab},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new M$ab}]),M$E}(),M$kb=function(){function M$a(M$a){this.defineCounter=0,this.defines=null,M$a?(this.defineCounter=M$a.defineCounter,this.defines=M$a.defines.slice()):(this.defineCounter=0,this.defines=[])}return M$n(M$a,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),M$a.prototype.registerDefine=function(M$a){var M$b=Math.pow(2,this.defineCounter++);return this.defines[M$b]=M$a,M$b},M$a}(),M$lb=function(){function M$a(){}return M$n(M$a,"laya.d3.shader.ShaderInit3D"),M$a.__init__=function(){var M$a,M$b;M$Ab._globalRegDefine("HIGHPRECISION",M$Ab.SHADERDEFINE_HIGHPRECISION),M$Ab._globalRegDefine("FOG",M$Ab.SHADERDEFINE_FOG),M$Ab._globalRegDefine("DIRECTIONLIGHT",M$Ab.SHADERDEFINE_DIRECTIONLIGHT),M$Ab._globalRegDefine("POINTLIGHT",M$Ab.SHADERDEFINE_POINTLIGHT),M$Ab._globalRegDefine("SPOTLIGHT",M$Ab.SHADERDEFINE_SPOTLIGHT),M$Ab._globalRegDefine("UV",M$Ab.SHADERDEFINE_UV0),M$Ab._globalRegDefine("COLOR",M$Ab.SHADERDEFINE_COLOR),M$Ab._globalRegDefine("UV1",M$Ab.SHADERDEFINE_UV1),M$Ab._globalRegDefine("CASTSHADOW",M$nb.SHADERDEFINE_CAST_SHADOW),M$Ab._globalRegDefine("SHADOWMAP_PSSM1",M$nb.SHADERDEFINE_SHADOW_PSSM1),M$Ab._globalRegDefine("SHADOWMAP_PSSM2",M$nb.SHADERDEFINE_SHADOW_PSSM2),M$Ab._globalRegDefine("SHADOWMAP_PSSM3",M$nb.SHADERDEFINE_SHADOW_PSSM3),M$Ab._globalRegDefine("SHADOWMAP_PCF_NO",M$nb.SHADERDEFINE_SHADOW_PCF_NO),M$Ab._globalRegDefine("SHADOWMAP_PCF1",M$nb.SHADERDEFINE_SHADOW_PCF1),M$Ab._globalRegDefine("SHADOWMAP_PCF2",M$nb.SHADERDEFINE_SHADOW_PCF2),M$Ab._globalRegDefine("SHADOWMAP_PCF3",M$nb.SHADERDEFINE_SHADOW_PCF3),M$Ab._globalRegDefine("DEPTHFOG",M$Ab.SAHDERDEFINE_DEPTHFOG),M$Lb.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),M$Lb.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),M$a={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},M$b={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var M$c=M$Lb.nameKey.add("SIMPLE");shaderCompile=M$Ab.add(M$c,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',M$a,M$b),M$Mb.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),M$Mb.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),M$Mb.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),M$Mb.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),M$Mb.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),M$Mb.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),M$Mb.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),M$Mb.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),M$Mb.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},M$a}(),M$mb=function(){function M$a(){this._data=null,this._data=[]}M$n(M$a,"laya.d3.shader.ValusArray");var M$b=M$a.prototype;return M$b.setValue=function(M$a,M$b){this._data[M$a]=M$b},M$o(0,M$b,"data",function(){return this._data}),M$a}(),M$nb=function(){function M$a(){}return M$a.SHADERDEFINE_RECEIVE_SHADOW=1,M$a.SHADERDEFINE_CAST_SHADOW=512,M$a.SHADERDEFINE_SHADOW_PSSM1=1024,M$a.SHADERDEFINE_SHADOW_PSSM2=2048,M$a.SHADERDEFINE_SHADOW_PSSM3=4096,M$a.SHADERDEFINE_SHADOW_PCF_NO=8192,M$a.SHADERDEFINE_SHADOW_PCF1=16384,M$a.SHADERDEFINE_SHADOW_PCF2=32768,M$a.SHADERDEFINE_SHADOW_PCF3=65536,M$a.MAX_PSSM_COUNT=3,M$a}(),M$ob=function(){function M$X(){}return M$n(M$X,"laya.d3.utils.Picker"),M$X.calculateCursorRay=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=M$a.elements[0],M$h=M$a.elements[1],M$i=M$X._tempVector30,M$j=M$i.elements;M$j[0]=M$g,M$j[1]=M$h,M$j[2]=M$b.minDepth;var M$k=M$X._tempVector31,M$l=M$k.elements;M$l[0]=M$g,M$l[1]=M$h,M$l[2]=M$b.maxDepth;var M$m=M$f.origin,M$n=M$X._tempVector32;M$b.unprojectFromWVP(M$i,M$c,M$d,M$e,M$m),M$b.unprojectFromWVP(M$k,M$c,M$d,M$e,M$n);var M$o=M$f.direction.elements;M$o[0]=M$n.x-M$m.x,M$o[1]=M$n.y-M$m.y,M$o[2]=M$n.z-M$m.z,M$gb.normalize(M$f.direction,M$f.direction)},M$X.rayIntersectsPositionsAndIndices=function(M$a,M$b,M$c,M$d,M$e){for(var M$f=M$c.vertexStride/4,M$g=M$c.getVertexElementByUsage(0).offset/4,M$h=Number.MAX_VALUE,M$i=-1,M$j=-1,M$k=-1,M$l=0;M$l<M$d.length;M$l+=3){var M$m=M$X._tempVector35,M$n=M$m.elements,M$o=M$d[M$l]*M$f,M$p=M$o+M$g;M$n[0]=M$b[M$p],M$n[1]=M$b[1+M$p],M$n[2]=M$b[2+M$p];var M$q=M$X._tempVector36,M$r=M$q.elements,M$s=M$d[M$l+1]*M$f,M$t=M$s+M$g;M$r[0]=M$b[M$t],M$r[1]=M$b[1+M$t],M$r[2]=M$b[2+M$t];var M$u=M$X._tempVector37,M$v=M$u.elements,M$w=M$d[M$l+2]*M$f,M$x=M$w+M$g;M$v[0]=M$b[M$x],M$v[1]=M$b[1+M$x],M$v[2]=M$b[2+M$x];var M$A=laya.d3.utils.Picker.rayIntersectsTriangle(M$a,M$m,M$q,M$u);!isNaN(M$A)&&M$A<M$h&&(M$h=M$A,M$i=M$o,M$j=M$s,M$k=M$w)}if(M$h===Number.MAX_VALUE)return M$e.position.toDefault(),M$e.distance=Number.MAX_VALUE,M$e.trianglePositions[0].toDefault(),M$e.trianglePositions[1].toDefault(),M$e.trianglePositions[2].toDefault(),M$e.triangleNormals[0].toDefault(),M$e.triangleNormals[1].toDefault(),M$e.triangleNormals[2].toDefault(),!1;M$e.distance=M$h,M$gb.scale(M$a.direction,M$h,M$e.position),M$gb.add(M$a.origin,M$e.position,M$e.position);var M$B=M$e.trianglePositions,M$C=M$B[0],M$D=M$B[1],M$E=M$B[2],M$F=M$C.elements,M$G=M$D.elements,M$H=M$E.elements,M$I=M$i+M$g;M$F[0]=M$b[M$I],M$F[1]=M$b[M$I+1],M$F[2]=M$b[M$I+2];var M$J=M$j+M$g;M$G[0]=M$b[M$J],M$G[1]=M$b[M$J+1],M$G[2]=M$b[M$J+2];var M$K=M$k+M$g;M$H[0]=M$b[M$K],M$H[1]=M$b[M$K+1],M$H[2]=M$b[M$K+2];var M$L=M$c.getVertexElementByUsage(3);if(M$L){var M$M=M$L.offset/4,M$N=M$e.triangleNormals,M$O=M$N[0],M$P=M$N[1],M$Q=M$N[2],M$R=M$O.elements,M$S=M$P.elements,M$T=M$Q.elements,M$U=M$i+M$M;M$R[0]=M$b[M$U],M$R[1]=M$b[M$U+1],M$R[2]=M$b[M$U+2];var M$V=M$j+M$M;M$S[0]=M$b[M$V],M$S[1]=M$b[M$V+1],M$S[2]=M$b[M$V+2];var M$W=M$k+M$M;M$T[0]=M$b[M$W],M$T[1]=M$b[M$W+1],M$T[2]=M$b[M$W+2]}return!0},M$X.rayIntersectsTriangle=function(M$a,M$b,M$c,M$d){var M$e=M$X._tempVector30,M$f=M$X._tempVector31;M$gb.subtract(M$c,M$b,M$e),M$gb.subtract(M$d,M$b,M$f);var M$g,M$h=M$X._tempVector32;if(M$gb.cross(M$a.direction,M$f,M$h),(M$g=M$gb.dot(M$e,M$h))>-Number.MIN_VALUE&&M$g<Number.MIN_VALUE)return Number.NaN;var M$i,M$j=1/M$g,M$k=M$X._tempVector33;if(M$gb.subtract(M$a.origin,M$b,M$k),M$i=M$gb.dot(M$k,M$h),(M$i*=M$j)<0||1<M$i)return Number.NaN;var M$l,M$m,M$n=M$X._tempVector34;return M$gb.cross(M$k,M$e,M$n),M$l=M$gb.dot(M$a.direction,M$n),(M$l*=M$j)<0||1<M$i+M$l?Number.NaN:(M$m=M$gb.dot(M$f,M$n),(M$m*=M$j)<0?Number.NaN:M$m)},M$l(M$X,["_tempVector30",function(){return this._tempVector30=new M$gb},"_tempVector31",function(){return this._tempVector31=new M$gb},"_tempVector32",function(){return this._tempVector32=new M$gb},"_tempVector33",function(){return this._tempVector33=new M$gb},"_tempVector34",function(){return this._tempVector34=new M$gb},"_tempVector35",function(){return this._tempVector35=new M$gb},"_tempVector36",function(){return this._tempVector36=new M$gb},"_tempVector37",function(){return this._tempVector37=new M$gb}]),M$X}(),M$pb=(function(){function M$a(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new M$gb,new M$gb,new M$gb],this.trianglePositions.length=3,this.triangleNormals=[new M$gb,new M$gb,new M$gb],this.triangleNormals.length=3,this.position=new M$gb}M$n(M$a,"laya.d3.utils.RaycastHit"),M$a.prototype.cloneTo=function(M$a){M$a.distance=this.distance,this.trianglePositions[0].cloneTo(M$a.trianglePositions[0]),this.trianglePositions[1].cloneTo(M$a.trianglePositions[1]),this.trianglePositions[2].cloneTo(M$a.trianglePositions[2]),this.triangleNormals[0].cloneTo(M$a.triangleNormals[0]),this.triangleNormals[1].cloneTo(M$a.triangleNormals[1]),this.triangleNormals[2].cloneTo(M$a.triangleNormals[2]),this.position.cloneTo(M$a.position),M$a.sprite3D=this.sprite3D}}(),function(){function M$a(M$a,M$b){this._width=0,this._height=0,this._width=M$a,this._height=M$b}M$n(M$a,"laya.d3.utils.Size");var M$b=M$a.prototype;return M$o(0,M$b,"width",function(){return-1===this._width?M$Y.clientWidth:this._width}),M$o(0,M$b,"height",function(){return-1===this._height?M$Y.clientHeight:this._height}),M$o(1,M$a,"fullScreen",function(){return new M$a(-1,-1)}),M$a}()),M$qb=function(){function M$I(){}return M$n(M$I,"laya.d3.utils.Utils3D"),M$I._rotationTransformScaleSkinAnimation=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$l){var M$m,M$n,M$o,M$p,M$q,M$r=M$I._tempArray16_0,M$s=M$I._tempArray16_1,M$t=M$I._tempArray16_2,M$u=M$d+M$d,M$v=M$e+M$e,M$w=M$f+M$f,M$x=M$d*M$u,M$A=M$e*M$u,M$B=M$e*M$v,M$C=M$f*M$u,M$D=M$f*M$v,M$E=M$f*M$w,M$F=M$g*M$u,M$G=M$g*M$v,M$H=M$g*M$w;for(M$r[15]=1,M$r[0]=1-M$B-M$E,M$r[1]=M$A+M$H,M$r[2]=M$C-M$G,M$r[4]=M$A-M$H,M$r[5]=1-M$x-M$E,M$r[6]=M$D+M$F,M$r[8]=M$C+M$G,M$r[9]=M$D-M$F,M$r[10]=1-M$x-M$B,M$s[15]=1,M$s[0]=M$h,M$s[5]=M$i,M$s[10]=M$j,M$m=0;M$m<4;M$m++)M$n=M$r[M$m],M$o=M$r[M$m+4],M$p=M$r[M$m+8],M$q=M$r[M$m+12],M$t[M$m]=M$n,M$t[M$m+4]=M$o,M$t[M$m+8]=M$p,M$t[M$m+12]=M$n*M$a+M$o*M$b+M$p*M$c+M$q;for(M$m=0;M$m<4;M$m++)M$n=M$t[M$m],M$o=M$t[M$m+4],M$p=M$t[M$m+8],M$q=M$t[M$m+12],M$k[M$m+M$l]=M$n*M$s[0]+M$o*M$s[1]+M$p*M$s[2]+M$q*M$s[3],M$k[M$m+M$l+4]=M$n*M$s[4]+M$o*M$s[5]+M$p*M$s[6]+M$q*M$s[7],M$k[M$m+M$l+8]=M$n*M$s[8]+M$o*M$s[9]+M$p*M$s[10]+M$q*M$s[11],M$k[M$m+M$l+12]=M$n*M$s[12]+M$o*M$s[13]+M$p*M$s[14]+M$q*M$s[15]},M$I._createNodeByJson=function(M$a,M$b,M$c,M$d){if(!M$c)switch(M$b.type){case"Sprite3D":M$c=new M$Kb;break;case"MeshSprite3D":M$c=new M$Xb;break;case"SkinnedMeshSprite3D":M$c=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":M$c=new ShuriKenParticle3D;break;case"TrailSprite3D":M$c=new TrailSprite3D;break;case"Terrain":M$c=new Terrain;break;case"Camera":M$c=new M$Wb;break;case"DirectionLight":M$c=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var M$e=M$b.props;if(M$e)for(var M$f in M$e)M$c[M$f]=M$e[M$f];var M$g=M$b.customProps;M$g&&(M$c instanceof laya.d3.core.Sprite3D?(M$c._parseBaseCustomProps(M$g),M$c._parseCustomProps(M$a,M$d,M$g,M$b),M$c._parseCustomComponent(M$a,M$d,M$b.components)):M$c._parseCustomProps(M$a,M$d,M$g,M$b));var M$h=M$b.child;if(M$h)for(var M$i=0,M$j=M$h.length;M$i<M$j;M$i++){var M$k=M$I._createNodeByJson(M$a,M$h[M$i],null,M$d);M$c.addChild(M$k)}return M$c},M$I._computeBoneAndAnimationDatasByBindPoseMatrxix=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g,M$h,M$i=0,M$j=0,M$k=M$a.length;for(M$g=0;M$g<M$k;M$i+=M$a[M$g].keyframeWidth,M$j+=16,M$g++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(M$b[M$i+0],M$b[M$i+1],M$b[M$i+2],M$b[M$i+3],M$b[M$i+4],M$b[M$i+5],M$b[M$i+6],M$b[M$i+7],M$b[M$i+8],M$b[M$i+9],M$d,M$j),0!=M$g&&(M$h=16*M$a[M$g].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(M$d,M$h,M$d,M$j,M$d,M$j));var M$l=M$c.length;for(M$g=0;M$g<M$l;M$g++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(M$d,16*M$f[M$g],M$c[M$g],M$e,16*M$g)},M$I._computeAnimationDatasByArrayAndMatrixFast=function(M$a,M$b,M$c,M$d){for(var M$e=0,M$f=M$a.length;M$e<M$f;M$e++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(M$b,16*M$d[M$e],M$a[M$e],M$c,16*M$e)},M$I._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(M$a,M$b,M$c,M$d,M$e){var M$f,M$g,M$h=0,M$i=0,M$j=M$a.length;for(M$f=0;M$f<M$j;M$h+=M$a[M$f].keyframeWidth,M$i+=16,M$f++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(M$b[M$h+7],M$b[M$h+8],M$b[M$h+9],M$b[M$h+3],M$b[M$h+4],M$b[M$h+5],M$b[M$h+6],M$b[M$h+0],M$b[M$h+1],M$b[M$h+2],M$d,M$i),0!=M$f&&(M$g=16*M$a[M$f].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(M$d,M$g,M$d,M$i,M$d,M$i));var M$k=M$c.length;for(M$f=0;M$f<M$k;M$f++){var M$l=16*M$f;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(M$d,M$l,M$c[M$f],M$e,M$l)}},M$I._computeAnimationDatasByArrayAndMatrixFastOld=function(M$a,M$b,M$c){for(var M$d=M$a.length,M$e=0;M$e<M$d;M$e++){var M$f=16*M$e;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(M$b,M$f,M$a[M$e],M$c,M$f)}},M$I._computeRootAnimationData=function(M$a,M$b,M$c){for(var M$d=0,M$e=0,M$f=0,M$g=M$a.length;M$d<M$g;M$e+=M$a[M$d].keyframeWidth,M$f+=16,M$d++)laya.d3.utils.Utils3D.createAffineTransformationArray(M$b[M$e+0],M$b[M$e+1],M$b[M$e+2],M$b[M$e+3],M$b[M$e+4],M$b[M$e+5],M$b[M$e+6],M$b[M$e+7],M$b[M$e+8],M$b[M$e+9],M$c,M$f)},M$I.transformVector3ArrayByQuat=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$c.elements,M$g=M$a[M$b],M$h=M$a[M$b+1],M$i=M$a[M$b+2],M$j=M$f[0],M$k=M$f[1],M$l=M$f[2],M$m=M$f[3],M$n=M$m*M$g+M$k*M$i-M$l*M$h,M$o=M$m*M$h+M$l*M$g-M$j*M$i,M$p=M$m*M$i+M$j*M$h-M$k*M$g,M$q=-M$j*M$g-M$k*M$h-M$l*M$i;M$d[M$e]=M$n*M$m+M$q*-M$j+M$o*-M$l-M$p*-M$k,M$d[M$e+1]=M$o*M$m+M$q*-M$k+M$p*-M$j-M$n*-M$l,M$d[M$e+2]=M$p*M$m+M$q*-M$l+M$n*-M$k-M$o*-M$j},M$I.mulMatrixByArray=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g,M$h,M$i,M$j,M$k;if(M$e===M$c){for(M$c=M$I._tempArray16_3,M$g=0;M$g<16;++M$g)M$c[M$g]=M$e[M$f+M$g];M$d=0}for(M$g=0;M$g<4;M$g++)M$h=M$a[M$b+M$g],M$i=M$a[M$b+M$g+4],M$j=M$a[M$b+M$g+8],M$k=M$a[M$b+M$g+12],M$e[M$f+M$g]=M$h*M$c[M$d+0]+M$i*M$c[M$d+1]+M$j*M$c[M$d+2]+M$k*M$c[M$d+3],M$e[M$f+M$g+4]=M$h*M$c[M$d+4]+M$i*M$c[M$d+5]+M$j*M$c[M$d+6]+M$k*M$c[M$d+7],M$e[M$f+M$g+8]=M$h*M$c[M$d+8]+M$i*M$c[M$d+9]+M$j*M$c[M$d+10]+M$k*M$c[M$d+11],M$e[M$f+M$g+12]=M$h*M$c[M$d+12]+M$i*M$c[M$d+13]+M$j*M$c[M$d+14]+M$k*M$c[M$d+15]},M$I.mulMatrixByArrayFast=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g,M$h,M$i,M$j,M$k;for(M$g=0;M$g<4;M$g++)M$h=M$a[M$b+M$g],M$i=M$a[M$b+M$g+4],M$j=M$a[M$b+M$g+8],M$k=M$a[M$b+M$g+12],M$e[M$f+M$g]=M$h*M$c[M$d+0]+M$i*M$c[M$d+1]+M$j*M$c[M$d+2]+M$k*M$c[M$d+3],M$e[M$f+M$g+4]=M$h*M$c[M$d+4]+M$i*M$c[M$d+5]+M$j*M$c[M$d+6]+M$k*M$c[M$d+7],M$e[M$f+M$g+8]=M$h*M$c[M$d+8]+M$i*M$c[M$d+9]+M$j*M$c[M$d+10]+M$k*M$c[M$d+11],M$e[M$f+M$g+12]=M$h*M$c[M$d+12]+M$i*M$c[M$d+13]+M$j*M$c[M$d+14]+M$k*M$c[M$d+15]},M$I.mulMatrixByArrayAndMatrixFast=function(M$a,M$b,M$c,M$d,M$e){var M$f,M$g,M$h,M$i,M$j,M$k=M$c.elements,M$l=M$k[0],M$m=M$k[1],M$n=M$k[2],M$o=M$k[3],M$p=M$k[4],M$q=M$k[5],M$r=M$k[6],M$s=M$k[7],M$t=M$k[8],M$u=M$k[9],M$v=M$k[10],M$w=M$k[11],M$x=M$k[12],M$A=M$k[13],M$B=M$k[14],M$C=M$k[15],M$D=M$b,M$E=M$b+4,M$F=M$b+8,M$G=M$b+12,M$H=M$e,M$I=M$e+4,M$J=M$e+8,M$K=M$e+12;for(M$f=0;M$f<4;M$f++)M$g=M$a[M$D+M$f],M$h=M$a[M$E+M$f],M$i=M$a[M$F+M$f],M$j=M$a[M$G+M$f],M$d[M$H+M$f]=M$g*M$l+M$h*M$m+M$i*M$n+M$j*M$o,M$d[M$I+M$f]=M$g*M$p+M$h*M$q+M$i*M$r+M$j*M$s,M$d[M$J+M$f]=M$g*M$t+M$h*M$u+M$i*M$v+M$j*M$w,M$d[M$K+M$f]=M$g*M$x+M$h*M$A+M$i*M$B+M$j*M$C},M$I.createAffineTransformationArray=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$l){var M$m=M$d+M$d,M$n=M$e+M$e,M$o=M$f+M$f,M$p=M$d*M$m,M$q=M$d*M$n,M$r=M$d*M$o,M$s=M$e*M$n,M$t=M$e*M$o,M$u=M$f*M$o,M$v=M$g*M$m,M$w=M$g*M$n,M$x=M$g*M$o;M$k[M$l+0]=(1-(M$s+M$u))*M$h,M$k[M$l+1]=(M$q+M$x)*M$h,M$k[M$l+2]=(M$r-M$w)*M$h,M$k[M$l+3]=0,M$k[M$l+4]=(M$q-M$x)*M$i,M$k[M$l+5]=(1-(M$p+M$u))*M$i,M$k[M$l+6]=(M$t+M$v)*M$i,M$k[M$l+7]=0,M$k[M$l+8]=(M$r+M$w)*M$j,M$k[M$l+9]=(M$t-M$v)*M$j,M$k[M$l+10]=(1-(M$p+M$s))*M$j,M$k[M$l+11]=0,M$k[M$l+12]=M$a,M$k[M$l+13]=M$b,M$k[M$l+14]=M$c,M$k[M$l+15]=1},M$I.transformVector3ArrayToVector3ArrayCoordinate=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$I._tempArray4_0,M$g=M$a[M$b+0],M$h=M$a[M$b+1],M$i=M$a[M$b+2],M$j=M$c.elements;M$f[0]=M$g*M$j[0]+M$h*M$j[4]+M$i*M$j[8]+M$j[12],M$f[1]=M$g*M$j[1]+M$h*M$j[5]+M$i*M$j[9]+M$j[13],M$f[2]=M$g*M$j[2]+M$h*M$j[6]+M$i*M$j[10]+M$j[14],M$f[3]=1/(M$g*M$j[3]+M$h*M$j[7]+M$i*M$j[11]+M$j[15]),M$d[M$e+0]=M$f[0]*M$f[3],M$d[M$e+1]=M$f[1]*M$f[3],M$d[M$e+2]=M$f[2]*M$f[3]},M$I.transformLightingMapTexcoordByUV0Array=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$c.elements;M$d[M$e+0]=M$a[M$b+0]*M$f[0]+M$f[2],M$d[M$e+1]=(M$a[M$b+1]-1)*M$f[1]+M$f[3]},M$I.transformLightingMapTexcoordByUV1Array=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$c.elements;M$d[M$e+0]=M$a[M$b+0]*M$f[0]+M$f[2],M$d[M$e+1]=1+M$a[M$b+1]*M$f[1]+M$f[3]},M$I.getURLVerion=function(M$a){var M$b=M$a.indexOf("?");return 0<=M$b?M$a.substr(M$b):null},M$I._quaternionCreateFromYawPitchRollArray=function(M$a,M$b,M$c,M$d){var M$e=.5*M$c,M$f=.5*M$b,M$g=.5*M$a,M$h=Math.sin(M$e),M$i=Math.cos(M$e),M$j=Math.sin(M$f),M$k=Math.cos(M$f),M$l=Math.sin(M$g),M$m=Math.cos(M$g);M$d[0]=M$m*M$j*M$i+M$l*M$k*M$h,M$d[1]=M$l*M$k*M$i-M$m*M$j*M$h,M$d[2]=M$m*M$k*M$h-M$l*M$j*M$i,M$d[3]=M$m*M$k*M$i+M$l*M$j*M$h},M$I._createAffineTransformationArray=function(M$a,M$b,M$c,M$d){var M$e=M$b[0],M$f=M$b[1],M$g=M$b[2],M$h=M$b[3],M$i=M$e+M$e,M$j=M$f+M$f,M$k=M$g+M$g,M$l=M$e*M$i,M$m=M$e*M$j,M$n=M$e*M$k,M$o=M$f*M$j,M$p=M$f*M$k,M$q=M$g*M$k,M$r=M$h*M$i,M$s=M$h*M$j,M$t=M$h*M$k,M$u=M$c[0],M$v=M$c[1],M$w=M$c[2];M$d[0]=(1-(M$o+M$q))*M$u,M$d[1]=(M$m+M$t)*M$u,M$d[2]=(M$n-M$s)*M$u,M$d[3]=0,M$d[4]=(M$m-M$t)*M$v,M$d[5]=(1-(M$l+M$q))*M$v,M$d[6]=(M$p+M$r)*M$v,M$d[7]=0,M$d[8]=(M$n+M$s)*M$w,M$d[9]=(M$p-M$r)*M$w,M$d[10]=(1-(M$l+M$o))*M$w,M$d[11]=0,M$d[12]=M$a[0],M$d[13]=M$a[1],M$d[14]=M$a[2],M$d[15]=1},M$I._mulMatrixArray=function(M$a,M$b,M$c,M$d){var M$e,M$f,M$g,M$h,M$i,M$j=M$b.elements,M$k=M$j[0],M$l=M$j[1],M$m=M$j[2],M$n=M$j[3],M$o=M$j[4],M$p=M$j[5],M$q=M$j[6],M$r=M$j[7],M$s=M$j[8],M$t=M$j[9],M$u=M$j[10],M$v=M$j[11],M$w=M$j[12],M$x=M$j[13],M$A=M$j[14],M$B=M$j[15],M$C=M$d,M$D=M$d+4,M$E=M$d+8,M$F=M$d+12;for(M$e=0;M$e<4;M$e++)M$f=M$a[M$e],M$g=M$a[M$e+4],M$h=M$a[M$e+8],M$i=M$a[M$e+12],M$c[M$C+M$e]=M$f*M$k+M$g*M$l+M$h*M$m+M$i*M$n,M$c[M$D+M$e]=M$f*M$o+M$g*M$p+M$h*M$q+M$i*M$r,M$c[M$E+M$e]=M$f*M$s+M$g*M$t+M$h*M$u+M$i*M$v,M$c[M$F+M$e]=M$f*M$w+M$g*M$x+M$h*M$A+M$i*M$B},M$I.getYawPitchRoll=function(M$a,M$b){M$I.transformQuat(M$gb.ForwardRH,M$a,M$cb.TEMPVector31),M$I.transformQuat(M$gb.Up,M$a,M$cb.TEMPVector32);var M$c=M$cb.TEMPVector32.elements;M$I.angleTo(M$gb.ZERO,M$cb.TEMPVector31,M$cb.TEMPVector33);var M$d=M$cb.TEMPVector33.elements;M$d[0]==Math.PI/2?(M$d[1]=M$I.arcTanAngle(M$c[2],M$c[0]),M$d[2]=0):M$d[0]==-Math.PI/2?(M$d[1]=M$I.arcTanAngle(-M$c[2],-M$c[0]),M$d[2]=0):(M$ab.createRotationY(-M$d[1],M$cb.TEMPMatrix0),M$ab.createRotationX(-M$d[0],M$cb.TEMPMatrix1),M$gb.transformCoordinate(M$cb.TEMPVector32,M$cb.TEMPMatrix0,M$cb.TEMPVector32),M$gb.transformCoordinate(M$cb.TEMPVector32,M$cb.TEMPMatrix1,M$cb.TEMPVector32),M$d[2]=M$I.arcTanAngle(M$c[1],-M$c[0])),M$d[1]<=-Math.PI&&(M$d[1]=Math.PI),M$d[2]<=-Math.PI&&(M$d[2]=Math.PI),M$d[1]>=Math.PI&&M$d[2]>=Math.PI&&(M$d[1]=0,M$d[2]=0,M$d[0]=Math.PI-M$d[0]),M$b[0]=M$d[1],M$b[1]=M$d[0],M$b[2]=M$d[2]},M$I.arcTanAngle=function(M$a,M$b){return 0==M$a?1==M$b?Math.PI/2:-Math.PI/2:0<M$a?Math.atan(M$b/M$a):M$a<0?0<M$b?Math.atan(M$b/M$a)+Math.PI:Math.atan(M$b/M$a)-Math.PI:0},M$I.angleTo=function(M$a,M$b,M$c){M$gb.subtract(M$b,M$a,M$cb.TEMPVector30),M$gb.normalize(M$cb.TEMPVector30,M$cb.TEMPVector30),M$c.elements[0]=Math.asin(M$cb.TEMPVector30.y),M$c.elements[1]=M$I.arcTanAngle(-M$cb.TEMPVector30.z,-M$cb.TEMPVector30.x)},M$I.transformQuat=function(M$a,M$b,M$c){var M$d=M$c.elements,M$e=M$a.elements,M$f=M$b,M$g=M$e[0],M$h=M$e[1],M$i=M$e[2],M$j=M$f[0],M$k=M$f[1],M$l=M$f[2],M$m=M$f[3],M$n=M$m*M$g+M$k*M$i-M$l*M$h,M$o=M$m*M$h+M$l*M$g-M$j*M$i,M$p=M$m*M$i+M$j*M$h-M$k*M$g,M$q=-M$j*M$g-M$k*M$h-M$l*M$i;M$d[0]=M$n*M$m+M$q*-M$j+M$o*-M$l-M$p*-M$k,M$d[1]=M$o*M$m+M$q*-M$k+M$p*-M$j-M$n*-M$l,M$d[2]=M$p*M$m+M$q*-M$l+M$n*-M$k-M$o*-M$j},M$I.quaterionNormalize=function(M$a,M$b){var M$c=M$a[0],M$d=M$a[1],M$e=M$a[2],M$f=M$a[3],M$g=M$c*M$c+M$d*M$d+M$e*M$e+M$f*M$f;0<M$g&&(M$g=1/Math.sqrt(M$g),M$b[0]=M$c*M$g,M$b[1]=M$d*M$g,M$b[2]=M$e*M$g,M$b[3]=M$f*M$g)},M$I.matrix4x4MultiplyFFF=function(M$a,M$b,M$c){var M$d,M$e,M$f,M$g,M$h;if(M$c===M$b)for(M$b=new Float32Array(16),M$d=0;M$d<16;++M$d)M$b[M$d]=M$c[M$d];for(M$d=0;M$d<4;M$d++)M$e=M$a[M$d],M$f=M$a[M$d+4],M$g=M$a[M$d+8],M$h=M$a[M$d+12],M$c[M$d]=M$e*M$b[0]+M$f*M$b[1]+M$g*M$b[2]+M$h*M$b[3],M$c[M$d+4]=M$e*M$b[4]+M$f*M$b[5]+M$g*M$b[6]+M$h*M$b[7],M$c[M$d+8]=M$e*M$b[8]+M$f*M$b[9]+M$g*M$b[10]+M$h*M$b[11],M$c[M$d+12]=M$e*M$b[12]+M$f*M$b[13]+M$g*M$b[14]+M$h*M$b[15]},M$I.matrix4x4MultiplyMFM=function(M$a,M$b,M$c){M$I.matrix4x4MultiplyFFF(M$a.elements,M$b,M$c.elements)},M$l(M$I,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new M$gb},"_tempVector3_1",function(){return this._tempVector3_1=new M$gb},"_tempVector3_2",function(){return this._tempVector3_2=new M$gb},"_tempVector3_3",function(){return this._tempVector3_3=new M$gb},"_tempVector3_4",function(){return this._tempVector3_4=new M$gb},"_tempVector3_5",function(){return this._tempVector3_5=new M$gb},"_tempVector3_6",function(){return this._tempVector3_6=new M$gb},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),M$I}(),M$rb=function(){function M$G(){}return M$n(M$G,"Laya3D"),M$G._cancelLoadByUrl=function(M$a){M$v.loader.cancelLoadByUrl(M$a),M$G._innerFirstLevelLoaderManager.cancelLoadByUrl(M$a),M$G._innerSecondLevelLoaderManager.cancelLoadByUrl(M$a),M$G._innerThirdLevelLoaderManager.cancelLoadByUrl(M$a),M$G._innerFourthLevelLoaderManager.cancelLoadByUrl(M$a)},M$G._changeWebGLSize=function(M$a,M$b){M$F.onStageResize(M$a,M$b),M$Y.clientWidth=M$a,M$Y.clientHeight=M$b},M$G.__init__=function(){var M$a=M$b.createMap;M$a.lh=[M$Kb,"SPRITE3DHIERARCHY"],M$a.ls=[M$Jb,"SPRITE3DHIERARCHY"],M$a.lm=[M$Rb,"MESH"],M$a.lmat=[M$Mb,"MATERIAL"],M$a.jpg=[M$Tb,"nativeimage"],M$a.jpeg=[M$Tb,"nativeimage"],M$a.png=[M$Tb,"nativeimage"],M$a.pkm=[M$Tb,"arraybuffer"],M$a.raw=[M$Pb,"arraybuffer"],M$a.mipmaps=[M$Pb,"arraybuffer"],M$r.parserMap.SPRITE3DHIERARCHY=M$G._loadHierarchy,M$r.parserMap.MESH=M$G._loadMesh,M$r.parserMap.MATERIAL=M$G._loadMaterial,M$r.parserMap.TEXTURECUBE=M$G._loadTextureCube,M$r.parserMap.TERRAIN=M$G._loadTerrain,M$G._innerFirstLevelLoaderManager.on("error",null,M$G._eventLoadManagerError),M$G._innerSecondLevelLoaderManager.on("error",null,M$G._eventLoadManagerError),M$G._innerThirdLevelLoaderManager.on("error",null,M$G._eventLoadManagerError),M$G._innerFourthLevelLoaderManager.on("error",null,M$G._eventLoadManagerError)},M$G.READ_BLOCK=function(){return M$G._readData.pos+=4,!0},M$G.READ_DATA=function(){return M$G._DATA.offset=M$G._readData.getUint32(),M$G._DATA.size=M$G._readData.getUint32(),!0},M$G.READ_STRINGS=function(){var M$a=[],M$b={offset:0,size:0};M$b.offset=M$G._readData.getUint16(),M$b.size=M$G._readData.getUint16();M$G._readData.pos;M$G._readData.pos=M$b.offset+M$G._DATA.offset;for(var M$c=0;M$c<M$b.size;M$c++){var M$d=M$G._readData.readUTFString();-1===M$d.lastIndexOf(".lmat")&&-1===M$d.lastIndexOf(".lpbr")||M$a.push(M$d)}return M$a},M$G.formatRelativePath=function(M$a,M$b){var M$c;if("."===M$b.charAt(0)){for(var M$d=(M$a+M$b).split("/"),M$e=0,M$f=M$d.length;M$e<M$f;M$e++)if(".."==M$d[M$e]){var M$g=M$e-1;0<M$g&&".."!==M$d[M$g]&&(M$d.splice(M$g,2),M$e-=2)}M$c=M$d.join("/")}else M$c=M$a+M$b;return null!=M$E.customFormat&&(M$c=M$E.customFormat(M$c,null)),M$c},M$G._eventLoadManagerError=function(M$a){M$v.loader.event("error",M$a)},M$G._addHierarchyInnerUrls=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g=M$G.formatRelativePath(M$d,M$e);M$c&&(M$g+=M$c),M$a.push({url:M$g,clas:M$f}),M$b[M$e]=M$g},M$G._getSprite3DHierarchyInnerUrls=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){var M$h,M$i=0,M$j=0;switch(M$a.type){case"Scene":var M$k=M$a.customProps.lightmaps;for(M$i=0,M$j=M$k.length;M$i<M$j;M$i++){var M$l=M$k[M$i].replace(".exr",".png");M$G._addHierarchyInnerUrls(M$d,M$e,M$f,M$g,M$l,M$Tb)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var M$m;if(M$a.instanceParams)(M$m=M$a.instanceParams.loadPath)&&M$G._addHierarchyInnerUrls(M$b,M$e,M$f,M$g,M$m,M$Rb);else{(M$m=(M$h=M$a.customProps).meshPath)&&M$G._addHierarchyInnerUrls(M$b,M$e,M$f,M$g,M$m,M$Rb);var M$n=M$h.materials;if(M$n)for(M$i=0,M$j=M$n.length;M$i<M$j;M$i++){for(var M$o=M$n[M$i],M$p=M$o.type.split("."),M$q=M$H.window,M$r=0,M$s=M$p.length;M$r<M$s;++M$r){M$q=M$q[this.clasPaths[M$r]]}if("function"!=typeof M$q)throw"_getSprite3DHierarchyInnerUrls 错误: "+M$o.type+" 不是类";M$G._addHierarchyInnerUrls(M$c,M$e,M$f,M$g,M$o.path,M$q)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var M$t=(M$h=M$a.customProps).meshPath;M$t&&M$G._addHierarchyInnerUrls(M$b,M$e,M$f,M$g,M$t,M$Rb);var M$u=M$h.material;if(M$u){M$p=M$u.type.split("."),M$q=M$H.window;for(M$r=0,M$s=M$p.length;M$r<M$s;++M$r){M$q=M$q[this.clasPaths[M$r]]}M$G._addHierarchyInnerUrls(M$c,M$e,M$f,M$g,M$u.path,M$q)}else{var M$v=M$h.materialPath;if(M$v)M$G._addHierarchyInnerUrls(M$c,M$e,M$f,M$g,M$v,ShurikenParticleMaterial);else{var M$w=M$h.texturePath;M$w&&M$G._addHierarchyInnerUrls(M$d,M$e,M$f,M$g,M$w,M$Tb)}}break;case"Terrain":M$G._addHierarchyInnerUrls(M$d,M$e,M$f,M$g,M$a.customProps.dataPath,TerrainRes)}var M$x=M$a.components;for(var M$A in M$x){var M$B=M$x[M$A];switch(M$A){case"Animator":var M$C=M$B.avatarPath;if(M$C)M$G._addHierarchyInnerUrls(M$d,M$e,M$f,M$g,M$C,Avatar);else{var M$D=M$B.avatar;M$D&&M$G._addHierarchyInnerUrls(M$d,M$e,M$f,M$g,M$D.path,Avatar)}var M$E=M$B.clipPaths;for(M$i=0,M$j=M$E.length;M$i<M$j;M$i++)M$G._addHierarchyInnerUrls(M$d,M$e,M$f,M$g,M$E[M$i],AnimationClip)}}var M$F=M$a.child;for(M$i=0,M$j=M$F.length;M$i<M$j;M$i++)M$G._getSprite3DHierarchyInnerUrls(M$F[M$i],M$b,M$c,M$d,M$e,M$f,M$g)},M$G._loadHierarchy=function(M$a){M$a.on("loaded",null,M$G._onHierarchylhLoaded,[M$a,M$a._class._getGroup()]),M$a.load(M$a.url,"json",!1,null,!0)},M$G._onHierarchylhLoaded=function(M$a,M$b,M$c){if(M$a._class.destroyed)M$a.endLoad();else{var M$d=M$a.url,M$e=M$qb.getURLVerion(M$d),M$f=M$E.getPath(M$d),M$g=[],M$h=[],M$i=[],M$j={};M$G._getSprite3DHierarchyInnerUrls(M$c,M$g,M$h,M$i,M$j,M$e,M$f);var M$k=M$g.length+M$h.length+M$i.length,M$l=M$k+1,M$m=1/M$l;if(M$G._onProcessChange(M$a,0,M$m,1),0<M$i.length){var M$n=M$k/M$l,M$o=M$D.create(null,M$G._onProcessChange,[M$a,M$m,M$n],!1);M$G._innerFourthLevelLoaderManager.create(M$i,M$D.create(null,M$G._onHierarchyInnerForthLevResouLoaded,[M$a,M$b,M$o,M$c,M$j,M$g,M$h,M$m+M$n*M$i.length,M$n]),M$o,null,null,1,!0,M$b)}else M$G._onHierarchyInnerForthLevResouLoaded(M$a,M$b,null,M$c,M$j,M$g,M$h,M$m,M$n)}},M$G._onHierarchyInnerForthLevResouLoaded=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){if(M$a._class.destroyed)M$a.endLoad();else if(M$c&&M$c.recover(),0<M$g.length){var M$j=M$D.create(null,M$G._onProcessChange,[M$a,M$h,M$i],!1);M$G._innerSecondLevelLoaderManager.create(M$g,M$D.create(null,M$G._onHierarchyInnerSecondLevResouLoaded,[M$a,M$b,M$j,M$d,M$e,M$f,M$h+M$i*M$g.length,M$i]),M$c,null,null,1,!0,M$b)}else M$G._onHierarchyInnerSecondLevResouLoaded(M$a,M$b,null,M$d,M$e,M$f,M$h,M$i)},M$G._onHierarchyInnerSecondLevResouLoaded=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h){if(M$a._class.destroyed)M$a.endLoad();else if(M$c&&M$c.recover(),0<M$f.length){var M$i=M$D.create(null,M$G._onProcessChange,[M$a,M$g,M$h],!1);M$G._innerFirstLevelLoaderManager.create(M$f,M$D.create(null,M$G._onHierarchyInnerFirstLevResouLoaded,[M$a,M$i,M$d,M$e]),M$c,null,null,1,!0,M$b)}else M$G._onHierarchyInnerFirstLevResouLoaded(M$a,null,M$d,M$e)},M$G._onHierarchyInnerFirstLevResouLoaded=function(M$a,M$b,M$c,M$d){M$b&&M$b.recover(),M$a.endLoad([M$c,M$d])},M$G._loadTerrain=function(M$a){M$a.on("loaded",null,M$G._onTerrainLtLoaded,[M$a,M$a._class._getGroup()]),M$a.load(M$a.url,"json",!1,null,!0)},M$G._onTerrainLtLoaded=function(M$a,M$b,M$c){if(M$a._class.destroyed)M$a.endLoad();else{var M$d,M$e,M$f=M$a.url,M$g=M$qb.getURLVerion(M$f),M$h=M$E.getPath(M$f),M$i=[],M$j={},M$k=0,M$l=0,M$m=M$c.heightData;M$d=M$m.url,M$e=M$G.formatRelativePath(M$h,M$d),M$g&&(M$e+=M$g),M$d=M$j[M$d]=M$e;var M$n=M$c.detailTexture;for(M$k=0,M$l=M$n.length;M$k<M$l;M$k++)M$i.push({url:M$n[M$k].diffuse});var M$o=M$c.normalMap;for(M$k=0,M$l=M$o.length;M$k<M$l;M$k++)M$i.push({url:M$o[M$k]});var M$p=M$c.alphaMap;for(M$k=0,M$l=M$p.length;M$k<M$l;M$k++)M$i.push({url:M$p[M$k],params:[!1,!1,6408,!0]});for(M$k=0,M$l=M$i.length;M$k<M$l;M$k++){var M$q=M$i[M$k].url;M$e=M$G.formatRelativePath(M$h,M$q),M$g&&(M$e+=M$g),M$i[M$k].url=M$e,M$j[M$q]=M$e}var M$r=M$i.length,M$s=M$r+2,M$t=1/M$s;M$G._onProcessChange(M$a,0,M$t,1);var M$u={heightMapLoaded:!1,texturesLoaded:!1},M$v=M$D.create(null,M$G._onProcessChange,[M$a,M$t,M$t],!1);M$G._innerFourthLevelLoaderManager.create(M$d,M$D.create(null,M$G._onTerrainHeightMapLoaded,[M$a,M$v,M$c,M$j,M$u]),M$v,null,[M$m.numX,M$m.numZ,M$m.bitType,M$m.value],1,!0,M$b);var M$w=M$D.create(null,M$G._onProcessChange,[M$a,2*M$t,M$r/M$s],!1);M$G._innerFourthLevelLoaderManager.create(M$i,M$D.create(null,M$G._onTerrainTexturesLoaded,[M$a,M$w,M$c,M$j,M$u]),M$w,null,null,1,!0,M$b)}},M$G._onTerrainHeightMapLoaded=function(M$a,M$b,M$c,M$d,M$e){M$e.heightMapLoaded=!0,M$e.texturesLoaded&&(M$a.endLoad([M$c,M$d]),M$b.recover())},M$G._onTerrainTexturesLoaded=function(M$a,M$b,M$c,M$d,M$e){M$e.texturesLoaded=!0,M$e.heightMapLoaded&&(M$a.endLoad([M$c,M$d]),M$b.recover())},M$G._loadMesh=function(M$a){M$a.on("loaded",null,M$G._onMeshLmLoaded,[M$a,M$a._class._getGroup()]),M$a.load(M$a.url,"arraybuffer",!1,null,!0)},M$G._onMeshLmLoaded=function(M$a,M$b,M$c){if(M$a._class.destroyed)M$a.endLoad();else{var M$d,M$e,M$f,M$g=M$a.url,M$h=M$qb.getURLVerion(M$g),M$i=M$E.getPath(M$g),M$j={},M$k=0,M$l=0;switch((M$G._readData=new M$w(M$c)).pos=0,M$G._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var M$m=M$G._readData.getUint32();M$G._readData.pos=M$G._readData.pos+4,M$l=M$G._readData.getUint16(),M$G._readData.pos=M$G._readData.pos+8*M$l;var M$n=M$G._readData.getUint32();for(M$l=M$G._readData.getUint16(),M$G._readData.pos=M$m+M$n,M$d=[],M$k=0;M$k<M$l;M$k++){var M$o=M$G._readData.readUTFString();-1!==M$o.lastIndexOf(".lmat")&&M$d.push(M$o)}break;default:for(M$G.READ_BLOCK(),M$k=0;M$k<2;M$k++){var M$p=M$G._readData.getUint16(),M$q=M$G._strings[M$p],M$r=M$G["READ_"+M$q];if(null==M$r)throw new Error("model file err,no this function:"+M$p+" "+M$q);1===M$k?M$d=M$r.call():M$r.call()}}for(M$k=0,M$f=M$d.length;M$k<M$f;M$k++){var M$s=M$d[M$k];M$e=M$G.formatRelativePath(M$i,M$s),M$h&&(M$e+=M$h),M$d[M$k]=M$e,M$j[M$s]=M$e}if(0<M$d.length){M$G._onProcessChange(M$a,0,.5,1);var M$t=M$D.create(null,M$G._onProcessChange,[M$a,.5,.5],!1);M$G._innerSecondLevelLoaderManager.create(M$d,M$D.create(null,M$G._onMeshMateialLoaded,[M$a,M$t,M$c,M$j]),M$t,null,null,1,!0,M$b)}else M$a.endLoad([M$c,M$j])}},M$G._onMeshMateialLoaded=function(M$a,M$b,M$c,M$d){M$a.endLoad([M$c,M$d]),M$b.recover()},M$G._getMaterialTexturePath=function(M$a,M$b,M$c){var M$d=M$a.length-4;return M$a.indexOf(".dds")!=M$d&&M$a.indexOf(".tga")!=M$d&&M$a.indexOf(".exr")!=M$d&&M$a.indexOf(".DDS")!=M$d&&M$a.indexOf(".TGA")!=M$d&&M$a.indexOf(".EXR")!=M$d||(M$a=M$a.substr(0,M$d)+".png"),M$a=M$G.formatRelativePath(M$c,M$a),M$b&&(M$a+=M$b),M$a},M$G._loadMaterial=function(M$a){M$a.on("loaded",null,M$G._onMaterilLmatLoaded,[M$a,M$a._class._getGroup()]),M$a.load(M$a.url,"json",!1,null,!0)},M$G._onMaterilLmatLoaded=function(M$a,M$b,M$c){if(M$a._class.destroyed)M$a.endLoad();else{var M$d,M$e=M$a.url,M$f=M$qb.getURLVerion(M$e),M$g=M$E.getPath(M$e),M$h=[],M$i={},M$j=M$c.customProps,M$k=M$c.version;if(M$k)switch(M$k){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var M$l=M$c.props.textures,M$m=0,M$n=M$l.length;M$m<M$n;M$m++){var M$o=M$l[M$m],M$p=M$o.path;if(M$p){var M$q=M$p.length-4;M$p.indexOf(".exr")!=M$q&&M$p.indexOf(".EXR")!=M$q||(M$p=M$p.substr(0,M$q)+".png"),M$d=M$G.formatRelativePath(M$g,M$p),M$f&&(M$d+=M$f),M$h.push({url:M$d,params:M$o.params}),M$i[M$p]=M$d}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var M$r=M$j.diffuseTexture.texture2D;if(M$r&&(M$d=M$G._getMaterialTexturePath(M$r,M$f,M$g),M$h.push(M$d),M$i[M$r]=M$d),M$j.normalTexture){var M$s=M$j.normalTexture.texture2D;M$s&&(M$d=M$G._getMaterialTexturePath(M$s,M$f,M$g),M$h.push(M$d),M$i[M$s]=M$d)}if(M$j.specularTexture){var M$t=M$j.specularTexture.texture2D;M$t&&(M$d=M$G._getMaterialTexturePath(M$t,M$f,M$g),M$h.push(M$d),M$i[M$t]=M$d)}if(M$j.emissiveTexture){var M$u=M$j.emissiveTexture.texture2D;M$u&&(M$d=M$G._getMaterialTexturePath(M$u,M$f,M$g),M$h.push(M$d),M$i[M$u]=M$d)}if(M$j.ambientTexture){var M$v=M$j.ambientTexture.texture2D;M$v&&(M$d=M$G._getMaterialTexturePath(M$v,M$f,M$g),M$h.push(M$d),M$i[M$v]=M$d)}if(M$j.reflectTexture){var M$w=M$j.reflectTexture.texture2D;M$w&&(M$d=M$G._getMaterialTexturePath(M$w,M$f,M$g),M$h.push(M$d),M$i[M$w]=M$d)}}var M$x=M$h.length,M$A=M$x+1,M$B=1/M$A;if(M$G._onProcessChange(M$a,0,M$B,1),0<M$x){var M$C=M$D.create(null,M$G._onProcessChange,[M$a,M$B,M$x/M$A],!1);M$G._innerFourthLevelLoaderManager.create(M$h,M$D.create(null,M$G._onMateialTexturesLoaded,[M$a,M$C,M$c,M$i]),M$C,M$Tb,null,1,!0,M$b)}else M$G._onMateialTexturesLoaded(M$a,null,M$c,null)}},M$G._onMateialTexturesLoaded=function(M$a,M$b,M$c,M$d){M$a.endLoad([M$c,M$d]),M$b&&M$b.recover()},M$G._loadTextureCube=function(M$a){M$a.on("loaded",null,M$G._onTextureCubeLtcLoaded,[M$a]),M$a.load(M$a.url,"json",!1,null,!0)},M$G._onTextureCubeLtcLoaded=function(M$a,M$b){if(M$a._class.destroyed)M$a.endLoad();else{var M$c=M$E.getPath(M$a.url),M$d=[M$G.formatRelativePath(M$c,M$b.px),M$G.formatRelativePath(M$c,M$b.nx),M$G.formatRelativePath(M$c,M$b.py),M$G.formatRelativePath(M$c,M$b.ny),M$G.formatRelativePath(M$c,M$b.pz),M$G.formatRelativePath(M$c,M$b.nz)];M$G._onProcessChange(M$a,0,1/7,1);var M$e=M$D.create(null,M$G._onProcessChange,[M$a,1/7,6/7],!1);M$G._innerFourthLevelLoaderManager.load(M$d,M$D.create(null,M$G._onTextureCubeImagesLoaded,[M$a,M$d,M$e]),M$e,"nativeimage")}},M$G._onTextureCubeImagesLoaded=function(M$a,M$b,M$c){var M$d=[];M$d.length=6;for(var M$e=0;M$e<6;M$e++){var M$f=M$b[M$e];M$d[M$e]=M$r.getRes(M$f),M$r.clearRes(M$f)}M$a.endLoad(M$d),M$c.recover()},M$G._onProcessChange=function(M$a,M$b,M$c,M$d){(M$d=M$b+M$d*M$c)<1&&M$a.event("progress",M$d)},M$G.init=function(M$a,M$b,M$c,M$d,M$e,M$f){if(void 0===M$c&&(M$c=!1),void 0===M$d&&(M$d=!1),void 0===M$e&&(M$e=!0),void 0===M$f&&(M$f=!0),M$s.update3DLoop=function(){},M$s.cancelLoadByUrl=function(M$a){M$G._cancelLoadByUrl(M$a)},M$i.isAntialias=M$c,M$i.isAlpha=M$d,M$i.premultipliedAlpha=M$e,M$i.isStencil=M$f,!M$F.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");M$s.changeWebGLSize=M$G._changeWebGLSize,M$p.is3DMode=!0,M$v.init(M$a,M$b),M$I.__init__(),M$lb.__init__(),M$Xb.__init__(),M$Q.__init__(),M$G.__init__(),M$g.maxTextureCount=2,(M$G.debugMode||M$Z.debugMode)&&(M$G._debugPhasorSprite=new M$V)},M$G.HIERARCHY="SPRITE3DHIERARCHY",M$G.MESH="MESH",M$G.MATERIAL="MATERIAL",M$G.PBRMATERIAL="PBRMTL",M$G.TEXTURECUBE="TEXTURECUBE",M$G.TERRAIN="TERRAIN",M$G._readData=null,M$G._debugPhasorSprite=null,M$G.debugMode=!1,M$l(M$G,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new M$b},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new M$b},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new M$b},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new M$b}]),M$G}(),M$sb=function(M$a){function M$e(M$a){M$e.__super.call(this),this._owner=M$a,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}M$n(M$e,"laya.d3.animation.AnimationTransform3D",M$f);var M$b=M$e.prototype;return M$b._getlocalMatrix=function(){return this._localUpdate&&(M$qb._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},M$b._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var M$a=0,M$b=this._childs.length;M$a<M$b;M$a++)this._childs[M$a]._onWorldTransform()}},M$b._setWorldMatrixAndUpdate=function(M$a){if(this._worldMatrix=M$a,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var M$b=this._getlocalMatrix(),M$c=0;M$c<16;++M$c)this._worldMatrix[M$c]=M$b[M$c];else M$qb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},M$b._setWorldMatrixNoUpdate=function(M$a){this._worldMatrix=M$a},M$b._setWorldMatrixIgnoreUpdate=function(M$a){this._worldMatrix=M$a,this._worldUpdate=!1},M$b.getLocalPosition=function(){return this._localPosition},M$b.setLocalPosition=function(M$a){if(this._parent)this._localPosition=M$a,this._localUpdate=!0,this._onWorldTransform();else{var M$b=this._entity.owner._transform,M$c=this._entity.localPosition,M$d=M$c.elements;M$d[0]=M$a[0],M$d[1]=M$a[1],M$d[2]=M$a[2],M$b.localPosition=M$c}},M$b.getLocalRotation=function(){if(this._localQuaternionUpdate){var M$a=this._localRotationEuler;M$qb._quaternionCreateFromYawPitchRollArray(M$a[1]/M$e._angleToRandin,M$a[0]/M$e._angleToRandin,M$a[2]/M$e._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},M$b.setLocalRotation=function(M$a){if(this._parent)this._localRotation=M$a,M$qb.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var M$b=this._entity.owner._transform,M$c=this._entity.localRotation,M$d=M$c.elements;M$d[0]=M$a[0],M$d[1]=M$a[1],M$d[2]=M$a[2],M$d[3]=M$a[3],M$b.localRotation=M$c}},M$b.getLocalScale=function(){return this._localScale},M$b.setLocalScale=function(M$a){if(this._parent)this._localScale=M$a,this._localUpdate=!0,this._onWorldTransform();else{var M$b=this._entity.owner._transform,M$c=this._entity.localScale,M$d=M$c.elements;M$d[0]=M$a[0],M$d[1]=M$a[1],M$d[2]=M$a[2],M$b.localScale=M$c}},M$b.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){M$qb.getYawPitchRoll(this._localRotation,M$e._tempVector3);var M$a=M$e._tempVector3,M$b=this._localRotationEuler;M$b[0]=M$a[1]*M$e._angleToRandin,M$b[1]=M$a[0]*M$e._angleToRandin,M$b[2]=M$a[2]*M$e._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},M$b.setLocalRotationEuler=function(M$a){if(this._parent)M$qb._quaternionCreateFromYawPitchRollArray(M$a[1]/M$e._angleToRandin,M$a[0]/M$e._angleToRandin,M$a[2]/M$e._angleToRandin,this._localRotation),this._localRotationEuler=M$a,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var M$b=this._entity.owner._transform,M$c=this._entity.localRotationEuler,M$d=M$c.elements;M$d[0]=M$a[0],M$d[1]=M$a[1],M$d[2]=M$a[2],M$b.localRotationEuler=M$c}},M$b.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)M$qb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var M$a=this._getlocalMatrix(),M$b=0;M$b<16;++M$b)this._worldMatrix[M$b]=M$a[M$b];this._worldUpdate=!1}return this._worldMatrix},M$b.setParent=function(M$a){if(this._parent!==M$a){if(this._parent){var M$b=this._parent._childs,M$c=M$b.indexOf(this);M$b.splice(M$c,1)}M$a&&(M$a._childs.push(this),M$a&&this._onWorldTransform()),this._parent=M$a}},M$l(M$e,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),M$e}(),M$tb=function(M$a){function M$b(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,M$b.__super.call(this),this._destroyed=!1,this._id=M$b._uniqueIDCounter,M$b._uniqueIDCounter++}M$n(M$b,"laya.d3.component.Component3D",M$f);var M$c=M$b.prototype;return M$v.imps(M$c,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),M$c._initialize=function(M$a){this._owner=M$a,this._enable=!0,this.started=!1,this._load(M$a)},M$c._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},M$c._load=function(M$a){},M$c._start=function(M$a){},M$c._update=function(M$a){},M$c._lateUpdate=function(M$a){},M$c._preRenderUpdate=function(M$a){},M$c._postRenderUpdate=function(M$a){},M$c._unload=function(M$a){this.offAll()},M$c._cloneTo=function(M$a){},M$o(0,M$c,"id",function(){return this._id}),M$o(0,M$c,"destroyed",function(){return this._destroyed}),M$o(0,M$c,"owner",function(){return this._owner}),M$o(0,M$c,"enable",function(){return this._enable},function(M$a){this._enable!==M$a&&(this._enable=M$a,this.event("enablechanged",this._enable))}),M$o(0,M$c,"isSingleton",function(){return M$b._isSingleton}),M$b._isSingleton=!0,M$b._uniqueIDCounter=1,M$b}(),M$ub=function(M$a){function M$b(){this._destroyed=!1,M$b.__super.call(this),this._destroyed=!1}M$n(M$b,"laya.d3.core.GeometryFilter",M$f);var M$c=M$b.prototype;return M$v.imps(M$c,{"laya.resource.IDestroy":!0}),M$c._destroy=function(){this.offAll(),this._destroyed=!0},M$o(0,M$c,"_isAsyncLoaded",function(){return!0}),M$o(0,M$c,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),M$o(0,M$c,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),M$o(0,M$c,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),M$o(0,M$c,"destroyed",function(){return this._destroyed}),M$b}(),M$vb=function(M$a){function M$d(M$a){M$d.__super.call(this),this._id=++M$d._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new M$Za(new M$gb,new M$gb),this._boundingBoxCenter=new M$gb,this._boundingSphere=new M$_a(new M$gb,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=M$a,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}M$n(M$d,"laya.d3.core.render.BaseRender",M$f);var M$b=M$d.prototype;return M$v.imps(M$b,{"laya.resource.IDestroy":!0}),M$b._changeMaterialReference=function(M$a,M$b){M$a&&M$a._removeReference(),M$b._addReference()},M$b._getInstanceMaterial=function(M$a,M$b){var M$c=new M$a.constructor;return M$a.cloneTo(M$c),M$c.name=M$c.name+"(Instance)",this._materialsInstance[M$b]=!0,this._changeMaterialReference(this._materials[M$b],M$c),this._materials[M$b]=M$c},M$b._setShaderValuelightMap=function(M$a){this._setShaderValueTexture(3,M$a)},M$b._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},M$b._renderRenderableBoundBox=function(){var M$a=M$rb._debugPhasorSprite,M$b=this.boundingBox,M$c=M$d._tempBoundBoxCorners;M$b.getCorners(M$c),M$a.line(M$c[0],M$d._greenColor,M$c[1],M$d._greenColor),M$a.line(M$c[2],M$d._greenColor,M$c[3],M$d._greenColor),M$a.line(M$c[4],M$d._greenColor,M$c[5],M$d._greenColor),M$a.line(M$c[6],M$d._greenColor,M$c[7],M$d._greenColor),M$a.line(M$c[0],M$d._greenColor,M$c[3],M$d._greenColor),M$a.line(M$c[1],M$d._greenColor,M$c[2],M$d._greenColor),M$a.line(M$c[2],M$d._greenColor,M$c[6],M$d._greenColor),M$a.line(M$c[3],M$d._greenColor,M$c[7],M$d._greenColor),M$a.line(M$c[0],M$d._greenColor,M$c[4],M$d._greenColor),M$a.line(M$c[1],M$d._greenColor,M$c[5],M$d._greenColor),M$a.line(M$c[4],M$d._greenColor,M$c[7],M$d._greenColor),M$a.line(M$c[5],M$d._greenColor,M$c[6],M$d._greenColor)},M$b._calculateBoundingSphere=function(){throw"BaseRender: must override it."},M$b._calculateBoundingBox=function(){throw"BaseRender: must override it."},M$b._setShaderValueTexture=function(M$a,M$b){this._owner._shaderValues.setValue(M$a,M$b)},M$b._setShaderValueMatrix4x4=function(M$a,M$b){this._owner._shaderValues.setValue(M$a,M$b?M$b.elements:null)},M$b._setShaderValueColor=function(M$a,M$b){this._owner._shaderValues.setValue(M$a,M$b?M$b.elements:null)},M$b._setShaderValueBuffer=function(M$a,M$b){this._owner._shaderValues.setValue(M$a,M$b)},M$b._setShaderValueInt=function(M$a,M$b){this._owner._shaderValues.setValue(M$a,M$b)},M$b._setShaderValueBool=function(M$a,M$b){this._owner._shaderValues.setValue(M$a,M$b)},M$b._setShaderValueNumber=function(M$a,M$b){this._owner._shaderValues.setValue(M$a,M$b)},M$b._setShaderValueVector2=function(M$a,M$b){this._owner._shaderValues.setValue(M$a,M$b?M$b.elements:null)},M$b._addShaderDefine=function(M$a){this._owner._shaderDefineValue|=M$a},M$b._removeShaderDefine=function(M$a){this._owner._shaderDefineValue&=~M$a},M$b._renderUpdate=function(M$a){return!0},M$b._applyLightMapParams=function(){if(0<=this._lightmapIndex){var M$a=this._owner.scene;if(M$a){var M$b=M$a.getlightmaps()[this._lightmapIndex];M$b?(this._addShaderDefine(M$Vb.SAHDERDEFINE_LIGHTMAP),M$b.loaded?this._setShaderValuelightMap(M$b):M$b.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(M$Vb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(M$Vb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(M$Vb.SAHDERDEFINE_LIGHTMAP)},M$b._updateOctreeNode=function(){var M$a=this._treeNode;M$a&&this._octreeNodeNeedChange&&(M$a.updateObject(this),this._octreeNodeNeedChange=!1)},M$b._destroy=function(){this.offAll();var M$a=0,M$b=0;for(M$a=0,M$b=this._renderElements.length;M$a<M$b;M$a++)this._renderElements[M$a]._destroy();for(M$a=0,M$b=this._materials.length;M$a<M$b;M$a++)this._materials[M$a]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},M$o(0,M$b,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),M$o(0,M$b,"id",function(){return this._id}),M$o(0,M$b,"material",function(){var M$a=this._materials[0];if(M$a&&!this._materialsInstance[0]){var M$b=this._getInstanceMaterial(M$a,0);this.event("materialchanged",[this,0,M$b])}return this._materials[0]},function(M$a){this.sharedMaterial=M$a}),M$o(0,M$b,"sharedMaterial",function(){return this._materials[0]},function(M$a){var M$b=this._materials[0];M$b!==M$a&&(this._materials[0]=M$a,this._materialsInstance[0]=!1,this._changeMaterialReference(M$b,M$a),this.event("materialchanged",[this,0,M$a]))}),M$o(0,M$b,"lightmapIndex",function(){return this._lightmapIndex},function(M$a){this._lightmapIndex=M$a,this._applyLightMapParams()}),M$o(0,M$b,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(M$a){this._lightmapScaleOffset=M$a,this._setShaderValueColor(2,M$a),this._addShaderDefine(M$Vb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),M$o(0,M$b,"enable",function(){return this._enable},function(M$a){this._enable=M$a,this.event("enablechanged",[this,M$a])}),M$o(0,M$b,"materials",function(){for(var M$a=0,M$b=this._materials.length;M$a<M$b;M$a++)if(!this._materialsInstance[M$a]){var M$c=this._getInstanceMaterial(this._materials[M$a],M$a);this.event("materialchanged",[this,M$a,M$c])}return this._materials.slice()},function(M$a){this.sharedMaterials=M$a}),M$o(0,M$b,"sharedMaterials",function(){return this._materials.slice()},function(M$a){if(!M$a)throw new Error("MeshRender: shadredMaterials value can't be null.");var M$b=M$a.length;this._materialsInstance.length=M$b;for(var M$c=0;M$c<M$b;M$c++){var M$d=this._materials[M$c];M$d!==M$a[M$c]&&(this._materialsInstance[M$c]=!1,this._changeMaterialReference(M$d,M$a[M$c]),this.event("materialchanged",[this,M$c,M$a[M$c]]))}this._materials=M$a}),M$o(0,M$b,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),M$o(0,M$b,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var M$a=this.boundingBox;M$gb.add(M$a.min,M$a.max,this._boundingBoxCenter),M$gb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),M$o(0,M$b,"receiveShadow",function(){return this._receiveShadow},function(M$a){this._receiveShadow!==M$a&&((this._receiveShadow=M$a)?this._addShaderDefine(M$nb.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(M$nb.SHADERDEFINE_RECEIVE_SHADOW))}),M$o(0,M$b,"destroyed",function(){return this._destroyed}),M$d._uniqueIDCounter=0,M$l(M$d,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new M$gb,new M$gb,new M$gb,new M$gb,new M$gb,new M$gb,new M$gb,new M$gb]},"_greenColor",function(){return this._greenColor=new M$hb(0,1,0,1)}]),M$d}(),M$wb=function(M$a){function M$h(M$a){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,M$h.__super.call(this),this._localPosition=new M$gb,this._localRotation=new M$cb(0,0,0,1),this._localScale=new M$gb(1,1,1),this._localRotationEuler=new M$gb,this._localMatrix=new M$ab,this._position=new M$gb,this._rotation=new M$cb(0,0,0,1),this._scale=new M$gb(1,1,1),this._worldMatrix=new M$ab,this._forward=new M$gb,this._up=new M$gb,this._right=new M$gb,this._owner=M$a,this._childs=[]}M$n(M$h,"laya.d3.core.Transform3D",M$f);var M$b=M$h.prototype;return M$b._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)M$ab.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var M$a=M$h._tempVector30;M$gb.multiply(this.pivot,this._localScale,M$a);var M$b=M$h._tempVector31;M$gb.subtract(M$a,this.pivot,M$b);var M$c=M$h._tempVector32,M$d=this.localRotation;M$gb.transformQuat(M$a,M$d,M$c),M$gb.subtract(M$c,M$a,M$c);var M$e=M$h._tempVector33;M$gb.subtract(this._localPosition,M$b,M$e),M$gb.subtract(M$e,M$c,M$e),M$ab.createAffineTransformation(M$e,M$d,this._localScale,this._localMatrix)}},M$b._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var M$a=0,M$b=this._childs.length;M$a<M$b;M$a++)this._childs[M$a]._onWorldPositionRotationTransform()}},M$b._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var M$a=0,M$b=this._childs.length;M$a<M$b;M$a++)this._childs[M$a]._onWorldPositionScaleTransform()}},M$b._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var M$a=0,M$b=this._childs.length;M$a<M$b;M$a++)this._childs[M$a]._onWorldPositionTransform()}},M$b._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var M$a=0,M$b=this._childs.length;M$a<M$b;M$a++)this._childs[M$a]._onWorldPositionRotationTransform()}},M$b._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var M$a=0,M$b=this._childs.length;M$a<M$b;M$a++)this._childs[M$a]._onWorldPositionScaleTransform()}},M$b._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var M$a=0,M$b=this._childs.length;M$a<M$b;M$a++)this._childs[M$a]._onWorldTransform()}},M$b.translate=function(M$a,M$b){void 0===M$b&&(M$b=!0),M$b?(M$ab.createFromQuaternion(this.localRotation,M$h._tempMatrix0),M$gb.transformCoordinate(M$a,M$h._tempMatrix0,M$h._tempVector30),M$gb.add(this.localPosition,M$h._tempVector30,this._localPosition),this.localPosition=this._localPosition):(M$gb.add(this.position,M$a,this._position),this.position=this._position)},M$b.rotate=function(M$a,M$b,M$c){var M$d;void 0===M$b&&(M$b=!0),void 0===M$c&&(M$c=!0),M$d=M$c?M$a:(M$gb.scale(M$a,Math.PI/180,M$h._tempVector30),M$h._tempVector30),M$cb.createFromYawPitchRoll(M$d.y,M$d.x,M$d.z,M$h._tempQuaternion0),M$b?(M$cb.multiply(this._localRotation,M$h._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(M$cb.multiply(M$h._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},M$b.lookAt=function(M$a,M$b,M$c){void 0===M$c&&(M$c=!1);var M$d,M$e=M$a.elements;if(M$c){if(M$d=this._localPosition.elements,Math.abs(M$d[0]-M$e[0])<M$ya.zeroTolerance&&Math.abs(M$d[1]-M$e[1])<M$ya.zeroTolerance&&Math.abs(M$d[2]-M$e[2])<M$ya.zeroTolerance)return;M$cb.lookAt(this._localPosition,M$a,M$b,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var M$f=this.position;if(M$d=M$f.elements,Math.abs(M$d[0]-M$e[0])<M$ya.zeroTolerance&&Math.abs(M$d[1]-M$e[1])<M$ya.zeroTolerance&&Math.abs(M$d[2]-M$e[2])<M$ya.zeroTolerance)return;M$cb.lookAt(M$f,M$a,M$b,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},M$o(0,M$b,"_isFrontFaceInvert",function(){var M$a=this.scale,M$b=M$a.x<0;return M$a.y<0&&(M$b=!M$b),M$a.z<0&&(M$b=!M$b),M$b}),M$o(0,M$b,"owner",function(){return this._owner}),M$o(0,M$b,"localRotation",function(){if(this._localQuaternionUpdate){var M$a=this._localRotationEuler.elements;M$cb.createFromYawPitchRoll(M$a[1]/M$h._angleToRandin,M$a[0]/M$h._angleToRandin,M$a[2]/M$h._angleToRandin,this._localRotation)}return this._localRotation},function(M$a){this._localRotation=M$a,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),M$o(0,M$b,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?M$ab.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(M$a){null===this._parent?M$a.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),M$ab.multiply(this._localMatrix,M$a,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=M$a,this._worldUpdate=!1}),M$o(0,M$b,"worldNeedUpdate",function(){return this._worldUpdate}),M$o(0,M$b,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(M$a){this._localMatrix=M$a,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),M$o(0,M$b,"dummy",function(){return this._dummy},function(M$a){this._dummy!==M$a&&(this._dummy&&(this._dummy._entity=null),M$a&&(M$a._entity=this),this._dummy=M$a)}),M$o(0,M$b,"localPosition",function(){return this._localPosition},function(M$a){this._localPosition=M$a,this._localUpdate=!0,this._onWorldPositionTransform()}),M$o(0,M$b,"position",function(){if(this._positionUpdate){if(null!=this._parent){var M$a=this._parent.position;M$gb.multiply(this._localPosition,this._parent.scale,M$h._tempVector30),M$gb.transformQuat(M$h._tempVector30,this._parent.rotation,M$h._tempVector30),M$gb.add(M$a,M$h._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(M$a){if(null!=this._parent){M$gb.subtract(M$a,this._parent.position,this._localPosition);var M$b=this._parent.scale.elements,M$c=M$b[0],M$d=M$b[1],M$e=M$b[2];if(1!==M$c||1!==M$d||1!==M$e){var M$f=M$h._tempVector30,M$g=M$f.elements;M$g[0]=1/M$c,M$g[1]=1/M$d,M$g[2]=1/M$e,M$gb.multiply(this._localPosition,M$f,this._localPosition)}this._parent.rotation.invert(M$h._tempQuaternion0),M$gb.transformQuat(this._localPosition,M$h._tempQuaternion0,this._localPosition)}else M$a.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=M$a,this._positionUpdate=!1}),M$o(0,M$b,"localScale",function(){return this._localScale},function(M$a){this._localScale=M$a,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),M$o(0,M$b,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(M$h._tempVector30);var M$a=M$h._tempVector30.elements,M$b=this._localRotationEuler.elements;M$b[0]=M$a[1]*M$h._angleToRandin,M$b[1]=M$a[0]*M$h._angleToRandin,M$b[2]=M$a[2]*M$h._angleToRandin}return this._localRotationEuler},function(M$a){this._localRotationEuler=M$a,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),M$o(0,M$b,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?M$cb.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(M$a){null!=this._parent?(this._parent.rotation.invert(M$h._tempQuaternion0),M$cb.multiply(M$a,M$h._tempQuaternion0,this._localRotation)):M$a.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=M$a,this._rotationUpdate=!1}),M$o(0,M$b,"scale",function(){return this._scaleUpdate&&(null!==this._parent?M$gb.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(M$a){if(null!==this._parent){var M$b=this._parent.scale.elements,M$c=M$h._tempVector30.elements;M$c[0]=1/M$b[0],M$c[1]=1/M$b[1],M$c[2]=1/M$b[2],M$gb.multiply(M$a,M$h._tempVector30,this._localScale)}else M$a.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=M$a,this._scaleUpdate=!1}),M$o(0,M$b,"rotationEuler",null,function(M$a){M$cb.createFromYawPitchRoll(M$a.y,M$a.x,M$a.z,this._rotation),this.rotation=this._rotation}),M$o(0,M$b,"forward",function(){var M$a=this.worldMatrix.elements;return this._forward.elements[0]=-M$a[8],this._forward.elements[1]=-M$a[9],this._forward.elements[2]=-M$a[10],this._forward}),M$o(0,M$b,"up",function(){var M$a=this.worldMatrix.elements;return this._up.elements[0]=M$a[4],this._up.elements[1]=M$a[5],this._up.elements[2]=M$a[6],this._up}),M$o(0,M$b,"right",function(){var M$a=this.worldMatrix.elements;return this._right.elements[0]=M$a[0],this._right.elements[1]=M$a[1],this._right.elements[2]=M$a[2],this._right}),M$o(0,M$b,"parent",function(){return this._parent},function(M$a){if(this._parent!==M$a){if(this._parent){var M$b=this._parent._childs,M$c=M$b.indexOf(this);M$b.splice(M$c,1)}M$a&&(M$a._childs.push(this),M$a&&this._onWorldTransform()),this._parent=M$a}}),M$l(M$h,["_tempVector30",function(){return this._tempVector30=new M$gb},"_tempVector31",function(){return this._tempVector31=new M$gb},"_tempVector32",function(){return this._tempVector32=new M$gb},"_tempVector33",function(){return this._tempVector33=new M$gb},"_tempQuaternion0",function(){return this._tempQuaternion0=new M$cb},"_tempMatrix0",function(){return this._tempMatrix0=new M$ab},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),M$h}(),M$xb=(function(M$a){function M$b(){this._rotation=0,this._matNeedUpdte=!1,M$b.__super.call(this),this._matrix=new M$ab,this._offset=new M$fb,this._tiling=new M$fb(1,1)}M$n(M$b,"laya.d3.core.TransformUV",M$f);var M$c=M$b.prototype;M$v.imps(M$c,{"laya.d3.core.IClone":!0}),M$c._updateMatrix=function(){M$b._tempOffsetV3.elements[0]=this._offset.x,M$b._tempOffsetV3.elements[1]=this._offset.y,M$cb.createFromYawPitchRoll(0,0,this._rotation,M$b._tempRotationQua),M$b._tempTitlingV3.elements[0]=this._tiling.x,M$b._tempTitlingV3.elements[1]=this._tiling.y,M$ab.createAffineTransformation(M$b._tempOffsetV3,M$b._tempRotationQua,M$b._tempTitlingV3,this._matrix)},M$c.cloneTo=function(M$a){M$a._matrix=this._matrix.clone(),M$a._offset=this._offset.clone(),M$a._rotation=this._rotation,M$a._tiling=this._tiling.clone()},M$c.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$c,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),M$o(0,M$c,"tiling",function(){return this._tiling},function(M$a){this._tiling=M$a,this._matNeedUpdte=!0}),M$o(0,M$c,"offset",function(){return this._offset},function(M$a){this._offset=M$a,this._matNeedUpdte=!0}),M$o(0,M$c,"rotation",function(){return this._rotation},function(M$a){this._rotation=M$a,this._matNeedUpdte=!0}),M$l(M$b,["_tempOffsetV3",function(){return this._tempOffsetV3=new M$gb(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new M$cb},"_tempTitlingV3",function(){return this._tempTitlingV3=new M$gb(1,1,1)}])}(),function(M$c){function M$a(){this.x=NaN,this.y=NaN,this.z=NaN,M$a.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}M$n(M$a,"laya.d3.core.particleShuriKen.module.shape.BoxShape",M$c);var M$b=M$a.prototype;M$b._getShapeBoundBox=function(M$a){var M$b=M$a.min.elements;M$b[0]=.5*-this.x,M$b[1]=.5*-this.y,M$b[2]=.5*-this.z;var M$c=M$a.max.elements;M$c[0]=.5*this.x,M$c[1]=.5*this.y,M$c[2]=.5*this.z},M$b._getSpeedBoundBox=function(M$a){var M$b=M$a.min.elements;M$b[0]=0,M$b[1]=0,M$b[2]=0;var M$c=M$a.max.elements;M$c[0]=0,M$c[1]=1,M$c[2]=0},M$b.generatePositionAndDirection=function(M$a,M$b,M$c,M$d){var M$e=M$a.elements,M$f=M$b.elements;M$c?(M$c.seed=M$d[16],M$T._randomPointInsideHalfUnitBox(M$a,M$c),M$d[16]=M$c.seed):M$T._randomPointInsideHalfUnitBox(M$a),M$e[0]=this.x*M$e[0],M$e[1]=this.y*M$e[1],M$e[2]=this.z*M$e[2],this.randomDirection?M$c?(M$c.seed=M$d[17],M$T._randomPointUnitSphere(M$b,M$c),M$d[17]=M$c.seed):M$T._randomPointUnitSphere(M$b):(M$f[0]=0,M$f[1]=0,M$f[2]=1)},M$b.cloneTo=function(M$a){M$c.prototype.cloneTo.call(this,M$a);var M$b=M$a;M$b.x=this.x,M$b.y=this.y,M$b.z=this.z,M$b.randomDirection=this.randomDirection}}(M$O),function(M$c){function M$g(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,M$g.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}M$n(M$g,"laya.d3.core.particleShuriKen.module.shape.CircleShape",M$c);var M$a=M$g.prototype;M$a._getShapeBoundBox=function(M$a){var M$b=M$a.min.elements;M$b[0]=M$b[2]=-this.radius,M$b[1]=0;var M$c=M$a.max.elements;M$c[0]=M$c[2]=this.radius,M$c[1]=0},M$a._getSpeedBoundBox=function(M$a){var M$b=M$a.min.elements;M$b[0]=M$b[1]=-1,M$b[2]=0;var M$c=M$a.max.elements;M$c[0]=M$c[1]=1,M$c[2]=0},M$a.generatePositionAndDirection=function(M$a,M$b,M$c,M$d){var M$e=M$a.elements,M$f=M$g._tempPositionPoint.elements;M$c?(M$c.seed=M$d[16],this.emitFromEdge?M$T._randomPointUnitArcCircle(this.arc,M$g._tempPositionPoint,M$c):M$T._randomPointInsideUnitArcCircle(this.arc,M$g._tempPositionPoint,M$c),M$d[16]=M$c.seed):this.emitFromEdge?M$T._randomPointUnitArcCircle(this.arc,M$g._tempPositionPoint):M$T._randomPointInsideUnitArcCircle(this.arc,M$g._tempPositionPoint),M$e[0]=-M$f[0],M$e[1]=M$f[1],M$e[2]=0,M$gb.scale(M$a,this.radius,M$a),this.randomDirection?M$c?(M$c.seed=M$d[17],M$T._randomPointUnitSphere(M$b,M$c),M$d[17]=M$c.seed):M$T._randomPointUnitSphere(M$b):M$a.cloneTo(M$b)},M$a.cloneTo=function(M$a){M$c.prototype.cloneTo.call(this,M$a);var M$b=M$a;M$b.radius=this.radius,M$b.arc=this.arc,M$b.emitFromEdge=this.emitFromEdge,M$b.randomDirection=this.randomDirection},M$l(M$g,["_tempPositionPoint",function(){return this._tempPositionPoint=new M$fb}])}(M$O),function(M$c){function M$m(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,M$m.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}M$n(M$m,"laya.d3.core.particleShuriKen.module.shape.ConeShape",M$c);var M$a=M$m.prototype;M$a._getShapeBoundBox=function(M$a){var M$b=this.radius+this.length*Math.sin(this.angle),M$c=this.length*Math.cos(this.angle),M$d=M$a.min.elements;M$d[0]=M$d[1]=-M$b,M$d[2]=0;var M$e=M$a.max.elements;M$e[0]=M$e[1]=M$b,M$e[2]=M$c},M$a._getSpeedBoundBox=function(M$a){var M$b=Math.sin(this.angle),M$c=M$a.min.elements;M$c[0]=M$c[1]=-M$b,M$c[2]=0;var M$d=M$a.max.elements;M$d[0]=M$c[1]=M$b,M$d[2]=1},M$a.generatePositionAndDirection=function(M$a,M$b,M$c,M$d){var M$e,M$f=M$a.elements,M$g=M$b.elements,M$h=M$m._tempPositionPoint.elements,M$i=NaN,M$j=NaN,M$k=Math.cos(this.angle),M$l=Math.sin(this.angle);switch(this.emitType){case 0:M$c?(M$c.seed=M$d[16],M$T._randomPointInsideUnitCircle(M$m._tempPositionPoint,M$c),M$d[16]=M$c.seed):M$T._randomPointInsideUnitCircle(M$m._tempPositionPoint),M$i=M$h[0],M$j=M$h[1],M$f[0]=M$i*this.radius,M$f[1]=M$j*this.radius,M$f[2]=0,this.randomDirection?(M$c?(M$c.seed=M$d[17],M$T._randomPointInsideUnitCircle(M$m._tempDirectionPoint,M$c),M$d[17]=M$c.seed):M$T._randomPointInsideUnitCircle(M$m._tempDirectionPoint),M$e=M$m._tempDirectionPoint.elements,M$g[0]=M$e[0]*M$l,M$g[1]=M$e[1]*M$l):(M$g[0]=M$i*M$l,M$g[1]=M$j*M$l),M$g[2]=M$k;break;case 1:M$c?(M$c.seed=M$d[16],M$T._randomPointUnitCircle(M$m._tempPositionPoint,M$c),M$d[16]=M$c.seed):M$T._randomPointUnitCircle(M$m._tempPositionPoint),M$i=M$h[0],M$j=M$h[1],M$f[0]=M$i*this.radius,M$f[1]=M$j*this.radius,M$f[2]=0,this.randomDirection?(M$c?(M$c.seed=M$d[17],M$T._randomPointInsideUnitCircle(M$m._tempDirectionPoint,M$c),M$d[17]=M$c.seed):M$T._randomPointInsideUnitCircle(M$m._tempDirectionPoint),M$e=M$m._tempDirectionPoint.elements,M$g[0]=M$e[0]*M$l,M$g[1]=M$e[1]*M$l):(M$g[0]=M$i*M$l,M$g[1]=M$j*M$l),M$g[2]=M$k;break;case 2:M$c?(M$c.seed=M$d[16],M$T._randomPointInsideUnitCircle(M$m._tempPositionPoint,M$c)):M$T._randomPointInsideUnitCircle(M$m._tempPositionPoint),M$i=M$h[0],M$j=M$h[1],M$f[0]=M$i*this.radius,M$f[1]=M$j*this.radius,M$g[M$f[2]=0]=M$i*M$l,M$g[1]=M$j*M$l,M$g[2]=M$k,M$gb.normalize(M$b,M$b),M$c?(M$gb.scale(M$b,this.length*M$c.getFloat(),M$b),M$d[16]=M$c.seed):M$gb.scale(M$b,this.length*Math.random(),M$b),M$gb.add(M$a,M$b,M$a),this.randomDirection&&(M$c?(M$c.seed=M$d[17],M$T._randomPointUnitSphere(M$b,M$c),M$d[17]=M$c.seed):M$T._randomPointUnitSphere(M$b));break;case 3:M$c?(M$c.seed=M$d[16],M$T._randomPointUnitCircle(M$m._tempPositionPoint,M$c)):M$T._randomPointUnitCircle(M$m._tempPositionPoint),M$i=M$h[0],M$j=M$h[1],M$f[0]=M$i*this.radius,M$f[1]=M$j*this.radius,M$g[M$f[2]=0]=M$i*M$l,M$g[1]=M$j*M$l,M$g[2]=M$k,M$gb.normalize(M$b,M$b),M$c?(M$gb.scale(M$b,this.length*M$c.getFloat(),M$b),M$d[16]=M$c.seed):M$gb.scale(M$b,this.length*Math.random(),M$b),M$gb.add(M$a,M$b,M$a),this.randomDirection&&(M$c?(M$c.seed=M$d[17],M$T._randomPointUnitSphere(M$b,M$c),M$d[17]=M$c.seed):M$T._randomPointUnitSphere(M$b));break;default:throw new Error("ConeShape:emitType is invalid.")}},M$a.cloneTo=function(M$a){M$c.prototype.cloneTo.call(this,M$a);var M$b=M$a;M$b.angle=this.angle,M$b.radius=this.radius,M$b.length=this.length,M$b.emitType=this.emitType,M$b.randomDirection=this.randomDirection},M$l(M$m,["_tempPositionPoint",function(){return this._tempPositionPoint=new M$fb},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new M$fb}])}(M$O),function(M$c){function M$a(){this.radius=NaN,this.emitFromShell=!1,M$a.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}M$n(M$a,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",M$c);var M$b=M$a.prototype;M$b._getShapeBoundBox=function(M$a){var M$b=M$a.min.elements;M$b[0]=M$b[1]=M$b[2]=-this.radius;var M$c=M$a.max.elements;M$c[0]=M$c[1]=this.radius,M$c[2]=0},M$b._getSpeedBoundBox=function(M$a){var M$b=M$a.min.elements;M$b[0]=M$b[1]=-1,M$b[2]=0;var M$c=M$a.max.elements;M$c[0]=M$c[1]=M$c[2]=1},M$b.generatePositionAndDirection=function(M$a,M$b,M$c,M$d){var M$e=M$a.elements;M$c?(M$c.seed=M$d[16],this.emitFromShell?M$T._randomPointUnitSphere(M$a,M$c):M$T._randomPointInsideUnitSphere(M$a,M$c),M$d[16]=M$c.seed):this.emitFromShell?M$T._randomPointUnitSphere(M$a):M$T._randomPointInsideUnitSphere(M$a),M$gb.scale(M$a,this.radius,M$a);var M$f=M$e[2];M$f<0&&(M$e[2]=-1*M$f),this.randomDirection?M$c?(M$c.seed=M$d[17],M$T._randomPointUnitSphere(M$b,M$c),M$d[17]=M$c.seed):M$T._randomPointUnitSphere(M$b):M$a.cloneTo(M$b)},M$b.cloneTo=function(M$a){M$c.prototype.cloneTo.call(this,M$a);var M$b=M$a;M$b.radius=this.radius,M$b.emitFromShell=this.emitFromShell,M$b.randomDirection=this.randomDirection}}(M$O),function(M$c){function M$a(){this.radius=NaN,this.emitFromShell=!1,M$a.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}M$n(M$a,"laya.d3.core.particleShuriKen.module.shape.SphereShape",M$c);var M$b=M$a.prototype;M$b._getShapeBoundBox=function(M$a){var M$b=M$a.min.elements;M$b[0]=M$b[1]=M$b[2]=-this.radius;var M$c=M$a.max.elements;M$c[0]=M$c[1]=M$c[2]=this.radius},M$b._getSpeedBoundBox=function(M$a){var M$b=M$a.min.elements;M$b[0]=M$b[1]=M$b[2]=-1;var M$c=M$a.max.elements;M$c[0]=M$c[1]=M$c[2]=1},M$b.generatePositionAndDirection=function(M$a,M$b,M$c,M$d){M$c?(M$c.seed=M$d[16],this.emitFromShell?M$T._randomPointUnitSphere(M$a,M$c):M$T._randomPointInsideUnitSphere(M$a,M$c),M$d[16]=M$c.seed):this.emitFromShell?M$T._randomPointUnitSphere(M$a):M$T._randomPointInsideUnitSphere(M$a),M$gb.scale(M$a,this.radius,M$a),this.randomDirection?M$c?(M$c.seed=M$d[17],M$T._randomPointUnitSphere(M$b,M$c),M$d[17]=M$c.seed):M$T._randomPointUnitSphere(M$b):M$a.cloneTo(M$b)},M$b.cloneTo=function(M$a){M$c.prototype.cloneTo.call(this,M$a);var M$b=M$a;M$b.radius=this.radius,M$b.emitFromShell=this.emitFromShell,M$b.randomDirection=this.randomDirection}}(M$O),function(M$a){function M$b(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,M$b.__super.call(this)}return M$n(M$b,"laya.d3.core.render.SubMeshRenderElement",M$W),M$b}()),M$Ab=function(M$a){function M$q(M$a,M$b,M$c,M$d,M$e,M$f){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=M$a,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[M$nb.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[M$Vb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[M$Vb.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[M$Eb.SHADERDEFINE_ALPHATEST]="ALPHATEST";M$q.__super.call(this,M$a,M$b,M$c,null,{}),this._attributeMap=M$d;var M$g;for(M$g in M$e){var M$h=M$e[M$g];switch(M$h[1]){case 0:this._renderElementUniformMap[M$g]=M$h[0];break;case 1:this._materialUniformMap[M$g]=M$h[0];break;case 2:this._spriteUniformMap[M$g]=M$h[0];break;case 3:this._cameraUniformMap[M$g]=M$h[0];break;case 4:this._sceneUniformMap[M$g]=M$h[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}M$n(M$q,"laya.d3.shader.ShaderCompile3D",M$t);var M$b=M$q.prototype;return M$b._definesToNameDic=function(M$a,M$b){for(var M$c={},M$d=1,M$e=0;M$e<32&&!(M$a<(M$d=1<<M$e));M$e++)if(M$a&M$d){var M$f=M$b[M$d];M$f&&(M$c[M$f]="")}return M$c},M$b.withCompile=function(M$a,M$b,M$c,M$d){var M$e,M$f,M$g;if(M$f=this.sharders[M$a])if(M$g=M$f[M$b]){if(M$e=M$g[M$c])return M$e}else M$g=M$f[M$b]=[];else M$g=(M$f=this.sharders[M$a]=[])[M$b]=[];var M$h,M$i=this._definesToNameDic(M$a,M$q._globalInt2name),M$j=this._definesToNameDic(M$b,this._spriteInt2name),M$k=this._definesToNameDic(M$c,this._materialInt2name),M$l={},M$m="";if(M$i)for(M$h in M$i)M$m+="#define "+M$h+"\n",M$l[M$h]=!0;if(M$j)for(M$h in M$j)M$m+="#define "+M$h+"\n",M$l[M$h]=!0;if(M$k)for(M$h in M$k)M$m+="#define "+M$h+"\n",M$l[M$h]=!0;var M$n=M$Lb.nameKey.getName(this._name)+" compile ("+M$a+","+M$b+","+M$c+")",M$o=this._VS.toscript(M$l,[]),M$p=this._PS.toscript(M$l,[]);M$H.now();if(M$e=M$Lb.create(M$m+M$o.join("\n"),M$m+M$p.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,M$d,M$n),M$g[M$c]=M$e,laya.d3.shader.ShaderCompile3D.debugMode)M$H.now();return M$e},M$b.precompileShaderWithShaderDefine=function(M$a,M$b,M$c){this.withCompile(M$a,M$b,M$c,!0)},M$b.addMaterialDefines=function(M$a){var M$b=M$a.defines;for(var M$c in M$b){var M$d=M$b[M$c],M$e=parseInt(M$c);this._materialInt2name[M$e]=M$d,this._materialName2Int[M$d]=M$e}},M$b.addSpriteDefines=function(M$a){var M$b=M$a.defines;for(var M$c in M$b){var M$d=M$b[M$c],M$e=parseInt(M$c);this._spriteInt2name[M$e]=M$d,this._spriteName2Int[M$d]=M$e}},M$b.getMaterialDefineByName=function(M$a){return this._materialName2Int[M$a]},M$b.registerMaterialDefine=function(M$a){var M$b=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[M$b]=M$a,this._materialName2Int[M$a]=M$b},M$b.registerSpriteDefine=function(M$a){var M$b=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[M$b]=M$a,this._spriteName2Int[M$a]=M$b},M$q._globalRegDefine=function(M$a,M$b){M$q._globalInt2name[M$b]=M$a},M$q.add=function(M$a,M$b,M$c,M$d,M$e){return laya.d3.shader.ShaderCompile3D._preCompileShader[M$a]=new M$q(M$a,M$b,M$c,M$d,M$e,M$t.includes)},M$q.get=function(M$a){return laya.d3.shader.ShaderCompile3D._preCompileShader[M$Lb.nameKey.getID(M$a)]},M$q._preCompileShader={},M$q._globalInt2name=[],M$q.debugMode=!1,M$q.SHADERDEFINE_HIGHPRECISION=1,M$q.SHADERDEFINE_FOG=4,M$q.SHADERDEFINE_DIRECTIONLIGHT=8,M$q.SHADERDEFINE_POINTLIGHT=16,M$q.SHADERDEFINE_SPOTLIGHT=32,M$q.SHADERDEFINE_UV0=64,M$q.SHADERDEFINE_COLOR=128,M$q.SHADERDEFINE_UV1=256,M$q.SAHDERDEFINE_DEPTHFOG=131072,M$q}(),M$Bb=function(M$a){function M$o(){M$o.__super.call(this)}M$n(M$o,"laya.d3.graphics.MeshSprite3DStaticBatchManager",M$da);var M$b=M$o.prototype;return M$b._getStaticBatch=function(M$a,M$b,M$c,M$d){var M$e,M$f;return M$f=M$a?M$a.id.toString()+M$c.id.toString()+M$b.id.toString()+M$d.toString():M$c.id.toString()+M$b.id.toString()+M$d.toString(),this._staticBatches[M$f]?M$e=this._staticBatches[M$f]:this._staticBatches[M$f]=M$e=new M$Cb(M$f,this,M$a,M$b,M$c),M$e},M$b._initStaticBatchs=function(M$a){var M$b,M$c;this._initBatchRenderElements.sort(M$o._sortPrepareStaticBatch);for(var M$d,M$e=!1,M$f=0,M$g=0,M$h=this._initBatchRenderElements.length;M$g<M$h;M$g++){var M$i,M$j=this._initBatchRenderElements[M$g],M$k=M$j.renderObj._getVertexBuffer(0);M$j._sprite3D;if(M$c===M$k.vertexDeclaration&&M$b===M$j._material)if(M$e)M$d._addCombineBatchRenderObjTest(M$j)?(M$i=M$j._staticBatch)!==M$d&&(M$i&&M$i._deleteCombineBatchRenderObj(M$j),M$d._addCombineBatchRenderObj(M$j)):(M$e=!1,M$f++);else{var M$l=this._initBatchRenderElements[M$g-1],M$m=M$l.renderObj,M$n=M$j.renderObj;M$e=!(65535<M$m._getVertexBuffer().vertexCount+M$n._getVertexBuffer().vertexCount)&&(M$d=this._getStaticBatch(M$a,M$c,M$b,M$f),(M$i=M$l._staticBatch)!==M$d&&(M$i&&M$i._deleteCombineBatchRenderObj(M$l),M$d._addCombineBatchRenderObj(M$l)),(M$i=M$j._staticBatch)!==M$d&&(M$i&&M$i._deleteCombineBatchRenderObj(M$j),M$d._addCombineBatchRenderObj(M$j)),!0)}else M$e=!1,M$f=0;M$b=M$j._material,M$c=M$k.vertexDeclaration}},M$o._sortPrepareStaticBatch=function(M$a,M$b){var M$c=M$a._render,M$d=M$b._render,M$e=M$c.lightmapIndex-M$d.lightmapIndex;if(0!=M$e)return M$e;var M$f=M$c.receiveShadow-M$d.receiveShadow;if(0!=M$f)return M$f;var M$g=M$a._mainSortID-M$b._mainSortID;return 0==M$g?M$a.renderObj.triangleCount-M$b.renderObj.triangleCount:M$g},M$o}(),M$Cb=function(M$a){function M$f(M$a,M$b,M$c,M$d,M$e){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,M$f.__super.call(this,M$a,M$b,M$c),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=M$d,this._material=M$e}M$n(M$f,"laya.d3.graphics.SubMeshStaticBatch",M$ea);var M$b=M$f.prototype;return M$b._compareBatchRenderElement=function(M$a,M$b){return M$a._batchIndexStart>M$b._batchIndexStart},M$b._addCombineBatchRenderObjTest=function(M$a){var M$b=M$a.renderObj._vertexCount;return!(65535<(0<M$b?this._currentCombineVertexCount+M$b:this._currentCombineVertexCount+M$a.renderObj._getVertexBuffer().vertexCount))},M$b._addCombineBatchRenderObj=function(M$a){var M$b=M$a.renderObj,M$c=M$b._vertexCount;this._initBatchRenderElements.push(M$a),M$a._staticBatch=this,0<M$c?(this._currentCombineIndexCount+=M$b._indexCount,this._currentCombineVertexCount+=M$c):(this._currentCombineIndexCount=this._currentCombineIndexCount+M$b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+M$b._getVertexBuffer().vertexCount),this._needFinishCombine=!0},M$b._deleteCombineBatchRenderObj=function(M$a){var M$b=M$a.renderObj,M$c=this._initBatchRenderElements.indexOf(M$a);if(-1!==M$c){this._initBatchRenderElements.splice(M$c,1),M$a._staticBatch=null;var M$d=M$b._vertexCount;0<M$d?(this._currentCombineIndexCount=this._currentCombineIndexCount-M$b._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-M$d):(this._currentCombineIndexCount=this._currentCombineIndexCount-M$b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-M$b._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},M$b._finishInit=function(){if(this._needFinishCombine){var M$a=0,M$b=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var M$c=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),M$d=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=M$Ob.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=M$Nb.create("ushort",this._currentCombineIndexCount,35044);for(var M$e=0,M$f=this._initBatchRenderElements.length;M$e<M$f;M$e++){var M$g=this._initBatchRenderElements[M$e],M$h=M$g.renderObj,M$i=M$h._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,M$g._sprite3D),M$j=M$h.getIndices(),M$k=M$g._sprite3D.transform._isFrontFaceInvert,M$l=M$a/(this._vertexDeclaration.vertexStride/4)-M$h._vertexStart,M$m=M$b,M$n=M$m+M$j.length;M$g._batchIndexStart=M$m,M$g._batchIndexEnd=M$n,M$d.set(M$j,M$b);var M$o=0;if(M$k)for(M$o=M$m;M$o<M$n;M$o+=3){M$d[M$o]=M$l+M$d[M$o];var M$p=M$d[M$o+1],M$q=M$d[M$o+2];M$d[M$o+1]=M$l+M$q,M$d[M$o+2]=M$l+M$p}else for(M$o=M$m;M$o<M$n;M$o+=3)M$d[M$o]=M$l+M$d[M$o],M$d[M$o+1]=M$l+M$d[M$o+1],M$d[M$o+2]=M$l+M$d[M$o+2];M$b+=M$j.length,M$c.set(M$i,M$a),M$a+=M$i.length}this._vertexBuffer.setData(M$c),this._indexBuffer.setData(M$d),this._needFinishCombine=!1}},M$b._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new M$xb)},M$b._getRenderElement=function(M$a,M$b,M$c){for(var M$d,M$e,M$f=this._batchRenderElements.length,M$g=!0,M$h=0;M$h<M$f;M$h++){var M$i,M$j,M$k=(M$e=this._batchRenderElements[M$h])._sprite3D._render;if(0!==M$h&&(M$g=(M$i=(M$d=this._batchRenderElements[M$h-1])._sprite3D._render).lightmapIndex!==M$k.lightmapIndex||M$i.receiveShadow!==M$k.receiveShadow||M$d._batchIndexEnd!==M$e._batchIndexStart),M$g){(M$j=this._getCombineRenderElementFromPool()).renderObj=this,M$j._material=this._material,M$j._batchIndexStart=M$e._batchIndexStart,M$j._batchIndexEnd=M$e._batchIndexEnd;var M$l=M$k.lightmapIndex,M$m=M$l+1,M$n=this._batchOwnerIndices[M$m];M$n||(M$n=this._batchOwnerIndices[M$m]=[]);var M$o,M$p=M$n[M$e._render.receiveShadow?1:0];void 0===M$p?(M$n[M$k.receiveShadow?1:0]=this._batchOwners.length,(M$o=new M$Xb(null,"StaticBatchMeshSprite3D"))._scene=M$b,M$o._transform=this._rootOwner?this._rootOwner._transform:null,M$o._render.lightmapIndex=M$l,M$o._render.receiveShadow=M$e._render.receiveShadow,this._batchOwners.push(M$o)):M$o=this._batchOwners[M$p],M$o._render._renderUpdate(M$c),M$j._sprite3D=M$o,M$a.push(M$j)}else M$j._batchIndexEnd=M$e._batchIndexEnd}},M$b._beforeRender=function(M$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},M$b._render=function(M$a){var M$b=M$a.renderElement,M$c=M$b._batchIndexStart,M$d=M$b._batchIndexEnd-M$c;M$F.mainContext.drawElements(4,M$d,5123,2*M$c),M$A.drawCall++,M$A.trianglesFaces+=M$d/3},M$b.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},M$b._getVertexBuffer=function(M$a){return void 0===M$a&&(M$a=0),this._vertexBuffer},M$f}(),M$Db=function(M$a){function M$b(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,M$b.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}M$n(M$b,"laya.d3.core.ComponentNode",M$j);var M$c=M$b.prototype;return M$c.addComponent=function(M$a){var M$b,M$c=this._componentsMap.indexOf(M$a);if(-1===M$c)M$b=[],this._componentsMap.push(M$a),this._typeComponentsIndices.push(M$b);else if(M$b=this._typeComponentsIndices[M$c],this._components[M$b[0]].isSingleton)throw new Error("无法单实例创建"+M$a+"组件，"+M$a+"组件已存在！");var M$d=M$e.getInstance(M$a);return M$b.push(this._components.length),this._components.push(M$d),M$d instanceof laya.d3.component.Script&&this._scripts.push(M$d),M$d._initialize(this),M$d},M$c._removeComponent=function(M$a,M$b){var M$c=this._typeComponentsIndices[M$a],M$d=M$c[M$b],M$e=this._components[M$d];this._components.splice(M$d,1),M$e instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(M$e),1),M$c.splice(M$b,1),0===M$c.length&&(this._typeComponentsIndices.splice(M$a,1),this._componentsMap.splice(M$a,1));for(var M$f=0,M$g=this._componentsMap.length;M$f<M$g;M$f++)for(var M$h=(M$c=this._typeComponentsIndices[M$f]).length-1;0<=M$h;M$h--){var M$i=M$c[M$h];if(!(M$d<M$i))break;M$c[M$h]=--M$i}M$e._destroy()},M$c.getComponentByType=function(M$a,M$b){void 0===M$b&&(M$b=0);var M$c=this._componentsMap.indexOf(M$a);return-1===M$c?null:this._components[this._typeComponentsIndices[M$c][M$b]]},M$c.getComponentsByType=function(M$a,M$b){var M$c=this._componentsMap.indexOf(M$a);if(-1!==M$c){var M$d=this._typeComponentsIndices[M$c],M$e=M$d.length;M$b.length=M$e;for(var M$f=0;M$f<M$e;M$f++)M$b[M$f]=this._components[M$d[M$f]]}else M$b.length=0},M$c.getComponentByIndex=function(M$a){return this._components[M$a]},M$c.removeComponentByType=function(M$a,M$b){void 0===M$b&&(M$b=0);var M$c=this._componentsMap.indexOf(M$a);-1!==M$c&&this._removeComponent(M$c,M$b)},M$c.removeComponentsByType=function(M$a){var M$b=this._componentsMap.indexOf(M$a);if(-1!==M$b)for(var M$c=this._typeComponentsIndices[M$b],M$d=0,M$e=M$c.length;M$d<M$e;M$c.length<M$e?M$e--:M$d++)this._removeComponent(M$b,M$d)},M$c.removeAllComponent=function(){for(var M$a=0,M$b=this._componentsMap.length;M$a<M$b;this._componentsMap.length<M$b?M$b--:M$a++)this.removeComponentsByType(this._componentsMap[M$a])},M$c._updateComponents=function(M$a){for(var M$b=0,M$c=this._components.length;M$b<M$c;M$b++){var M$d=this._components[M$b];!M$d.started&&(M$d._start(M$a),M$d.started=!0),M$d.enable&&M$d._update(M$a)}},M$c._lateUpdateComponents=function(M$a){for(var M$b=0;M$b<this._components.length;M$b++){var M$c=this._components[M$b];!M$c.started&&(M$c._start(M$a),M$c.started=!0),M$c.enable&&M$c._lateUpdate(M$a)}},M$c._preRenderUpdateComponents=function(M$a){for(var M$b=0;M$b<this._components.length;M$b++){var M$c=this._components[M$b];!M$c.started&&(M$c._start(M$a),M$c.started=!0),M$c.enable&&M$c._preRenderUpdate(M$a)}},M$c._postRenderUpdateComponents=function(M$a){for(var M$b=0;M$b<this._components.length;M$b++){var M$c=this._components[M$b];!M$c.started&&(M$c._start(M$a),M$c.started=!0),M$c.enable&&M$c._postRenderUpdate(M$a)}},M$b}(),M$Eb=function(M$d){function M$a(){M$a.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new M$mb,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new M$hb(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}M$n(M$a,"laya.d3.core.material.BaseMaterial",M$d);var M$b=M$a.prototype;return M$v.imps(M$b,{"laya.d3.core.IClone":!0}),M$b._addShaderDefine=function(M$a){this._shaderDefineValue|=M$a},M$b._removeShaderDefine=function(M$a){this._shaderDefineValue&=~M$a},M$b._addDisablePublicShaderDefine=function(M$a){this._disablePublicShaderDefine|=M$a},M$b._removeDisablePublicShaderDefine=function(M$a){this._disablePublicShaderDefine&=~M$a},M$b._setBuffer=function(M$a,M$b){this._shaderValues.setValue(M$a,M$b),this._values[M$a]=M$b},M$b._getBuffer=function(M$a){return this._values[M$a]},M$b._setMatrix4x4=function(M$a,M$b){this._shaderValues.setValue(M$a,M$b?M$b.elements:null),this._values[M$a]=M$b},M$b._getMatrix4x4=function(M$a){return this._values[M$a]},M$b._setInt=function(M$a,M$b){this._shaderValues.setValue(M$a,M$b),this._values[M$a]=M$b},M$b._getInt=function(M$a){return this._values[M$a]},M$b._setNumber=function(M$a,M$b){this._shaderValues.setValue(M$a,M$b),this._values[M$a]=M$b},M$b._getNumber=function(M$a){return this._values[M$a]},M$b._setBool=function(M$a,M$b){this._shaderValues.setValue(M$a,M$b),this._values[M$a]=M$b},M$b._getBool=function(M$a){return this._values[M$a]},M$b._setVector2=function(M$a,M$b){this._shaderValues.setValue(M$a,M$b?M$b.elements:null),this._values[M$a]=M$b},M$b._getVector2=function(M$a){return this._values[M$a]},M$b._setColor=function(M$a,M$b){this._shaderValues.setValue(M$a,M$b?M$b.elements:null),this._values[M$a]=M$b},M$b._getColor=function(M$a){return this._values[M$a]},M$b._setTexture=function(M$a,M$b){var M$c=this._values[M$a];this._values[M$a]=M$b,this._shaderValues.setValue(M$a,M$b),0<this.referenceCount&&(M$c&&M$c._removeReference(),M$b&&M$b._addReference())},M$b._getTexture=function(M$a){return this._values[M$a]},M$b._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},M$b._getShader=function(M$a,M$b,M$c){var M$d=(M$a|M$b)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(M$d,M$c,this._shaderDefineValue),this._shader},M$b._setRenderStateBlendDepth=function(){var M$a=M$F.mainContext;switch(M$G.setDepthMask(M$a,this.depthWrite),0===this.depthTest?M$G.setDepthTest(M$a,!1):(M$G.setDepthTest(M$a,!0),M$G.setDepthFunc(M$a,this.depthTest)),this.blend){case 0:M$G.setBlend(M$a,!1);break;case 1:M$G.setBlend(M$a,!0),M$G.setBlendFunc(M$a,this.srcBlend,this.dstBlend);break;case 2:M$G.setBlend(M$a,!0)}},M$b._setRenderStateFrontFace=function(M$a,M$b){var M$c=M$F.mainContext,M$d=0;switch(this.cull){case 0:M$G.setCullFace(M$c,!1);break;case 1:M$G.setCullFace(M$c,!0),M$d=M$a?M$b&&M$b._isFrontFaceInvert?2305:2304:M$b&&M$b._isFrontFaceInvert?2304:2305,M$G.setFrontFace(M$c,M$d);break;case 2:M$G.setCullFace(M$c,!0),M$d=M$a?M$b&&M$b._isFrontFaceInvert?2304:2305:M$b&&M$b._isFrontFaceInvert?2305:2304,M$G.setFrontFace(M$c,M$d)}},M$b.onAsynLoaded=function(M$a,M$b,M$c){var M$d=M$b[0],M$e=M$b[1];switch(M$d.version){case"LAYAMATERIAL:01":var M$f=0,M$g=0,M$h=M$d.props;for(var M$i in M$h)switch(M$i){case"vectors":var M$j=M$h[M$i];for(M$f=0,M$g=M$j.length;M$f<M$g;M$f++){var M$k=M$j[M$f],M$l=M$k.value;switch(M$l.length){case 2:this[M$k.name]=new M$fb(M$l[0],M$l[1]);break;case 3:this[M$k.name]=new M$gb(M$l[0],M$l[1],M$l[2]);break;case 4:this[M$k.name]=new M$hb(M$l[0],M$l[1],M$l[2],M$l[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var M$m=M$h[M$i];for(M$f=0,M$g=M$m.length;M$f<M$g;M$f++){var M$n=M$m[M$f],M$o=M$n.path;M$o&&(this[M$n.name]=M$r.getRes(M$e[M$o]))}break;case"defines":var M$p=M$h[M$i];for(M$f=0,M$g=M$p.length;M$f<M$g;M$f++){var M$q=this._shaderCompile.getMaterialDefineByName(M$p[M$f]);this._addShaderDefine(M$q)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[M$i]=M$h[M$i];break;case"renderQueue":switch(M$h[M$i]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[M$i]=M$h[M$i]}break;case"LAYAMATERIAL:02":for(M$i in M$h=M$d.props)switch(M$i){case"vectors":for(M$f=0,M$g=(M$j=M$h[M$i]).length;M$f<M$g;M$f++)switch((M$l=(M$k=M$j[M$f]).value).length){case 2:this[M$k.name]=new M$fb(M$l[0],M$l[1]);break;case 3:this[M$k.name]=new M$gb(M$l[0],M$l[1],M$l[2]);break;case 4:this[M$k.name]=new M$hb(M$l[0],M$l[1],M$l[2],M$l[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(M$f=0,M$g=(M$m=M$h[M$i]).length;M$f<M$g;M$f++)(M$o=(M$n=M$m[M$f]).path)&&(this[M$n.name]=M$r.getRes(M$e[M$o]));break;case"defines":for(M$f=0,M$g=(M$p=M$h[M$i]).length;M$f<M$g;M$f++)M$q=this._shaderCompile.getMaterialDefineByName(M$p[M$f]),this._addShaderDefine(M$q);break;default:this[M$i]=M$h[M$i]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},M$b._addReference=function(){M$d.prototype._addReference.call(this);for(var M$a=0,M$b=this._values.length;M$a<M$b;M$a++){var M$c=this._values[M$a];M$c&&M$c instanceof laya.d3.resource.BaseTexture&&M$c._addReference()}},M$b._removeReference=function(){M$d.prototype._removeReference.call(this);for(var M$a=0,M$b=this._values.length;M$a<M$b;M$a++){var M$c=this._values[M$a];M$c&&M$c instanceof laya.d3.resource.BaseTexture&&M$c._removeReference()}},M$b.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},M$b.setShaderName=function(M$a){var M$b=M$Lb.nameKey.getID(M$a);if(-1===M$b)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=M$Ab._preCompileShader[M$b]},M$b.cloneTo=function(M$a){var M$b=M$a;M$b.name=this.name,M$b.cull=this.cull,M$b.blend=this.blend,M$b.srcBlend=this.srcBlend,M$b.dstBlend=this.dstBlend,M$b.srcBlendRGB=this.srcBlendRGB,M$b.dstBlendRGB=this.dstBlendRGB,M$b.srcBlendAlpha=this.srcBlendAlpha,M$b.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(M$b.blendConstColor),M$b.blendEquation=this.blendEquation,M$b.blendEquationRGB=this.blendEquationRGB,M$b.blendEquationAlpha=this.blendEquationAlpha,M$b.depthTest=this.depthTest,M$b.depthWrite=this.depthWrite,M$b.renderQueue=this.renderQueue,M$b._shader=this._shader,M$b._disablePublicShaderDefine=this._disablePublicShaderDefine,M$b._shaderDefineValue=this._shaderDefineValue;var M$c,M$d=0,M$e=M$b._shaderValues;M$b._shaderValues.data.length=this._shaderValues.data.length;var M$f=this._values.length,M$g=M$b._values;for(M$d=0,M$c=M$g.length=M$f;M$d<M$c;M$d++){var M$h=this._values[M$d];if(M$h)if("number"==typeof M$h)M$g[M$d]=M$h,M$e.data[M$d]=M$h;else if("number"==typeof M$h&&Math.floor(M$h)==M$h)M$g[M$d]=M$h,M$e.data[M$d]=M$h;else if("boolean"==typeof M$h)M$g[M$d]=M$h,M$e.data[M$d]=M$h;else if(M$h instanceof laya.d3.math.Vector2){var M$i=M$g[M$d]||(M$g[M$d]=new M$fb);M$h.cloneTo(M$i),M$e.data[M$d]=M$i.elements}else if(M$h instanceof laya.d3.math.Vector3){var M$j=M$g[M$d]||(M$g[M$d]=new M$gb);M$h.cloneTo(M$j),M$e.data[M$d]=M$j.elements}else if(M$h instanceof laya.d3.math.Vector4){var M$k=M$g[M$d]||(M$g[M$d]=new M$hb);M$h.cloneTo(M$k),M$e.data[M$d]=M$k.elements}else if(M$h instanceof laya.d3.math.Matrix4x4){var M$l=M$g[M$d]||(M$g[M$d]=new M$ab);M$h.cloneTo(M$l),M$e.data[M$d]=M$l.elements}else M$h instanceof laya.d3.resource.BaseTexture&&(M$g[M$d]=M$h,M$e.data[M$d]=M$h)}},M$b.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$o(0,M$b,"alphaTestValue",function(){return this._getNumber(0)},function(M$a){this._setNumber(0,M$a)}),M$o(0,M$b,"alphaTest",function(){return this._alphaTest},function(M$a){(this._alphaTest=M$a)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),M$a.__init__=function(){M$a.SHADERDEFINE_ALPHATEST=M$a.shaderDefines.registerDefine("ALPHATEST")},M$a.RENDERQUEUE_OPAQUE=2e3,M$a.RENDERQUEUE_ALPHATEST=2450,M$a.RENDERQUEUE_TRANSPARENT=3e3,M$a.CULL_NONE=0,M$a.CULL_FRONT=1,M$a.CULL_BACK=2,M$a.BLEND_DISABLE=0,M$a.BLEND_ENABLE_ALL=1,M$a.BLEND_ENABLE_SEPERATE=2,M$a.BLENDPARAM_ZERO=0,M$a.BLENDPARAM_ONE=1,M$a.BLENDPARAM_SRC_COLOR=768,M$a.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,M$a.BLENDPARAM_DST_COLOR=774,M$a.BLENDPARAM_ONE_MINUS_DST_COLOR=775,M$a.BLENDPARAM_SRC_ALPHA=770,M$a.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,M$a.BLENDPARAM_DST_ALPHA=772,M$a.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,M$a.BLENDPARAM_SRC_ALPHA_SATURATE=776,M$a.BLENDEQUATION_ADD=0,M$a.BLENDEQUATION_SUBTRACT=1,M$a.BLENDEQUATION_REVERSE_SUBTRACT=2,M$a.DEPTHTEST_OFF=0,M$a.DEPTHTEST_NEVER=512,M$a.DEPTHTEST_LESS=513,M$a.DEPTHTEST_EQUAL=514,M$a.DEPTHTEST_LEQUAL=515,M$a.DEPTHTEST_GREATER=516,M$a.DEPTHTEST_NOTEQUAL=517,M$a.DEPTHTEST_GEQUAL=518,M$a.DEPTHTEST_ALWAYS=519,M$a.SHADERDEFINE_ALPHATEST=1,M$a.ALPHATESTVALUE=0,M$l(M$a,["shaderDefines",function(){return this.shaderDefines=new M$kb}]),M$a}(M$q),M$Fb=function(M$a){function M$b(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,M$b.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}M$n(M$b,"laya.d3.resource.BaseTexture",M$q);var M$c=M$b.prototype;return M$o(0,M$c,"width",function(){return this._width}),M$o(0,M$c,"repeat",function(){return this._repeat},function(M$a){if(this._repeat!==M$a&&(this._repeat=M$a,this._source)){var M$b=M$F.mainContext;M$G.bindTexture(M$b,this._type,this._source),M$u.isPOT(this._width,this._height)&&this._repeat?(M$b.texParameteri(this._type,10242,10497),M$b.texParameteri(this._type,10243,10497)):(M$b.texParameteri(this._type,10242,33071),M$b.texParameteri(this._type,10243,33071))}}),M$o(0,M$c,"height",function(){return this._height}),M$o(0,M$c,"magFifter",function(){return this._magFifter},function(M$a){(this._magFifter=M$a)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(M$a)}),M$o(0,M$c,"wrapModeV",function(){return this._wrapModeV}),M$o(0,M$c,"size",function(){return this._size}),M$o(0,M$c,"wrapModeU",function(){return this._wrapModeU}),M$o(0,M$c,"mipmap",function(){return this._mipmap},function(M$a){this._mipmap=M$a,this._mipmap!=M$a&&this._conchTexture&&this._conchTexture.setMipMap(M$a)}),M$o(0,M$c,"minFifter",function(){return this._minFifter},function(M$a){this._minFifter=M$a,this._minFifter!=M$a&&this._conchTexture&&this._conchTexture.setMinFifter(M$a)}),M$o(0,M$c,"format",function(){return this._format}),M$o(0,M$c,"source",function(){return this.activeResource(),this._source}),M$o(0,M$c,"defaulteTexture",function(){return M$Sb.grayTexture}),M$b.WARPMODE_REPEAT=0,M$b.WARPMODE_CLAMP=1,M$b}(),M$Gb=function(M$a){function M$b(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,M$b.__super.call(this),this._boundingBoxCorners=M$d(8,null)}M$n(M$b,"laya.d3.resource.models.BaseMesh",M$q);var M$c=M$b.prototype;return M$c._getPositions=function(){throw new Error("未Override,请重载该属性！")},M$c._generateBoundingObject=function(){this._boundingSphere=new M$_a(new M$gb,0),M$_a.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new M$Za(new M$gb,new M$gb),M$Za.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},M$c.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},M$c.getRenderElement=function(M$a){throw new Error("未Override,请重载该属性！")},M$o(0,M$c,"subMeshCount",function(){return this._subMeshCount}),M$o(0,M$c,"boundingBox",function(){return this._boundingBox}),M$o(0,M$c,"boundingBoxCorners",function(){return this._boundingBoxCorners}),M$o(0,M$c,"boundingSphere",function(){return this._boundingSphere}),M$b}(),M$Hb=(function(M$a){function M$b(){M$b.__super.call(this)}M$n(M$b,"laya.d3.component.Script",M$tb);var M$c=M$b.prototype;M$c.onTriggerEnter=function(M$a){},M$c.onTriggerExit=function(M$a){},M$c.onTriggerStay=function(M$a){},M$o(0,M$c,"isSingleton",function(){return M$b._isSingleton}),M$b._isSingleton=!1}(),function(M$a){function M$b(M$a){this._owner=null,this._sharedMesh=null,M$b.__super.call(this),this._owner=M$a}M$n(M$b,"laya.d3.core.MeshFilter",M$a);var M$c=M$b.prototype;return M$c._sharedMeshLoaded=function(){this.event("loaded")},M$c._destroy=function(){M$a.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},M$o(0,M$c,"sharedMesh",function(){return this._sharedMesh},function(M$a){var M$b=this._sharedMesh;M$b&&M$b._removeReference(),(this._sharedMesh=M$a)._addReference(),this.event("meshchanged",[this,M$b,M$a]),M$a.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),M$o(0,M$c,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),M$o(0,M$c,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),M$o(0,M$c,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),M$o(0,M$c,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),M$b}(M$ub)),M$Ib=function(M$a){function M$b(M$a){M$b.__super.call(this,M$a),M$a.meshFilter.on("meshchanged",this,this._onMeshChanged)}M$n(M$b,"laya.d3.core.MeshRender",M$vb);var M$c=M$b.prototype;return M$c._onMeshChanged=function(M$a,M$b,M$c){M$c.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:M$c.once("loaded",this,this._onMeshLoaed)},M$c._onMeshLoaed=function(M$a,M$b){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},M$c._calculateBoundingSphereByInitSphere=function(M$a){var M$b=NaN,M$c=this._owner.transform,M$d=M$c.scale.elements,M$e=Math.abs(M$d[0]),M$f=Math.abs(M$d[1]),M$g=Math.abs(M$d[2]);M$b=M$f<=M$e&&M$g<=M$e?M$e:M$g<=M$f?M$f:M$g,M$gb.transformCoordinate(M$a.center,M$c.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=M$a.radius*M$b},M$c._calculateBoundBoxByInitCorners=function(M$a){for(var M$b=this._owner.transform.worldMatrix,M$c=0;M$c<8;M$c++)M$gb.transformCoordinate(M$a[M$c],M$b,M$vb._tempBoundBoxCorners[M$c]);M$Za.createfromPoints(M$vb._tempBoundBoxCorners,this._boundingBox)},M$c._calculateBoundingSphere=function(){var M$a=this._owner.meshFilter.sharedMesh;null==M$a||null==M$a.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(M$a.boundingSphere)},M$c._calculateBoundingBox=function(){var M$a=this._owner.meshFilter.sharedMesh;null==M$a||null==M$a.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(M$a.boundingBoxCorners)},M$c._renderUpdate=function(M$a){var M$b=this._owner.transform;if(M$b){this._setShaderValueMatrix4x4(0,M$b.worldMatrix);var M$c=this._owner.getProjectionViewWorldMatrix(M$a);this._setShaderValueMatrix4x4(1,M$c)}else this._setShaderValueMatrix4x4(0,M$ab.DEFAULT),this._setShaderValueMatrix4x4(1,M$a);return M$rb.debugMode&&this._renderRenderableBoundBox(),!0},M$b}(),M$Jb=function(M$b){function M$d(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,M$d.__super.call(this),this._renderState=new M$Y,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new M$mb,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new M$ba,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new M$gb(.7,.7,.7),this.ambientColor=new M$gb(.212,.227,.259),M$F.shaderHighPrecision&&this.addShaderDefine(M$Ab.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}M$n(M$d,"laya.d3.core.scene.Scene",M$b);var M$a=M$d.prototype;return M$v.imps(M$a,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),M$a._setUrl=function(M$a){this._url=M$a},M$a._getGroup=function(){return this._group},M$a._setGroup=function(M$a){this._group=M$a},M$a._display=function(){M$v.stage._scenes.push(this),M$v.stage._scenes.sort(M$d._sortScenes);for(var M$a=0,M$b=this._childs.length;M$a<M$b;M$a++){var M$c=this._childs[M$a];M$c.active&&M$c._activeHierarchy()}},M$a._unDisplay=function(){var M$a=M$v.stage._scenes;M$a.splice(M$a.indexOf(this),1);for(var M$b=0,M$c=this._childs.length;M$b<M$c;M$b++){var M$d=this._childs[M$b];M$d.active&&M$d._inActiveHierarchy()}},M$a._addChild3D=function(M$a){M$a.transform._onWorldTransform(),M$a._setBelongScene(this),this.displayedInStage&&M$a.active&&M$a._activeHierarchy()},M$a._removeChild3D=function(M$a){M$a.transform.parent=null,this.displayedInStage&&M$a.active&&M$a._inActiveHierarchy(),M$a._setUnBelongScene()},M$a.initOctree=function(M$a,M$b,M$c,M$d,M$e){void 0===M$e&&(M$e=6),this.treeSize=new M$gb(M$a,M$b,M$c),this.treeLevel=M$e,this.treeRoot=new M$Z(this,0),this.treeRoot.init(M$d,this.treeSize)},M$a._prepareUpdateToRenderState=function(M$a,M$b){M$b.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,M$b.scene=this},M$a._prepareSceneToRender=function(M$a){var M$b=this._lights.length;if(0<M$b)for(var M$c=0,M$d=0;M$d<M$b&&!(this._lights[M$d]._prepareToScene(M$a)&&++M$c>=this._enableLightCount);M$d++);},M$a._updateChilds=function(M$a){for(var M$b=0,M$c=this._childs.length;M$b<M$c;++M$b)this._childs[M$b]._update(M$a)},M$a._preRenderScene=function(M$a,M$b,M$c){var M$d,M$e=M$b._viewMatrix,M$f=M$b._projectionMatrix,M$g=M$b._projectionViewMatrix,M$h=0,M$i=M$b.camera;for(M$i.useOcclusionCulling?this.treeRoot?M$ca.renderObjectCullingOctree(M$c,this,M$i,M$e,M$f,M$g):M$ca.renderObjectCulling(M$c,this,M$i,M$e,M$f,M$g):M$ca.renderObjectCullingNoBoundFrustum(this,M$i,M$e,M$f,M$g),M$h=0,M$d=this._quenes.length;M$h<M$d;M$h++)this._quenes[M$h]&&this._quenes[M$h]._preRender(M$b)},M$a._clear=function(M$a,M$b){var M$c=M$b._viewport,M$d=M$b.camera,M$e=M$c.x,M$f=M$d.renderTargetSize.height-M$c.y-M$c.height,M$g=M$c.width,M$h=M$c.height;M$a.viewport(M$e,M$f,M$g,M$h);var M$i=256,M$j=M$d.renderTarget;switch(M$d.clearFlag){case 0:var M$k=M$d.clearColor;if(M$k){M$a.enable(3089),M$a.scissor(M$e,M$f,M$g,M$h);var M$l=M$k.elements;M$a.clearColor(M$l[0],M$l[1],M$l[2],M$l[3]),M$i|=16384}if(M$j)switch(M$k||(M$i=16384),M$j.depthStencilFormat){case 33189:M$i|=256;break;case 36168:M$i|=1024;break;case 34041:M$i|=256,M$i|=1024}M$a.clear(M$i),M$k&&M$a.disable(3089);break;case 1:case 2:if(M$j)switch(M$i=16384,M$j.depthStencilFormat){case 33189:M$i|=256;break;case 36168:M$i|=1024;break;case 34041:M$i|=256,M$i|=1024}M$a.clear(M$i);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},M$a._renderScene=function(M$a,M$b){var M$c,M$d,M$e=M$b.camera,M$f=0;for(M$f=0;M$f<2;M$f++)(M$d=this._quenes[M$f])&&(M$e.renderTarget?M$d._render(M$b,!0):M$d._render(M$b,!1));if(1===M$e.clearFlag){var M$g=M$e.sky;M$g&&(M$G.setCullFace(M$a,!1),M$G.setDepthFunc(M$a,515),M$G.setDepthMask(M$a,!1),M$g._render(M$b),M$G.setDepthFunc(M$a,513),M$G.setDepthMask(M$a,!0))}for(M$f=2,M$c=this._quenes.length;M$f<M$c;M$f++)(M$d=this._quenes[M$f])&&(M$d._sortAlpha(M$b.camera.transform.position),M$e.renderTarget?M$d._render(M$b,!0):M$d._render(M$b,!1))},M$a._set3DRenderConfig=function(M$a){M$a.disable(3042),M$G._blend=!1,M$a.blendFunc(770,771),M$G._sFactor=770,M$G._dFactor=771,M$a.disable(2929),M$G._depthTest=!1,M$a.enable(2884),M$G._cullFace=!0,M$a.depthMask(1),M$G._depthMask=!0,M$a.frontFace(2304),M$G._frontFace=2304},M$a._set2DRenderConfig=function(M$a){M$G.setBlend(M$a,!0),M$G.setBlendFunc(M$a,1,771),M$G.setDepthTest(M$a,!1),M$G.setCullFace(M$a,!1),M$G.setDepthMask(M$a,!0),M$G.setFrontFace(M$a,2305),M$a.viewport(0,0,M$k.width,M$k.height)},M$a._parseCustomProps=function(M$a,M$b,M$c,M$d){var M$e=M$d.customProps.lightmaps,M$f=M$e.length,M$g=this._lightmaps;M$g.length=M$f;for(var M$h=0;M$h<M$f;M$h++)M$g[M$h]=M$r.getRes(M$b[M$e[M$h].replace(".exr",".png")]);this.setlightmaps(M$g);var M$i=M$d.customProps.ambientColor;M$i&&(this.ambientColor=new M$gb(M$i[0],M$i[1],M$i[2]));var M$j=M$d.customProps.fogColor;M$j&&(this.fogColor=new M$gb(M$j[0],M$j[1],M$j[2]))},M$a._addLight=function(M$a){this._lights.indexOf(M$a)<0&&this._lights.push(M$a)},M$a._removeLight=function(M$a){var M$b=this._lights.indexOf(M$a);0<=M$b&&this._lights.splice(M$b,1)},M$a._updateScene=function(){var M$a=this._renderState;this._prepareUpdateToRenderState(M$F.mainContext,M$a),this._updateComponents(M$a),this._updateChilds(M$a),this._lateUpdateComponents(M$a),this._time+=M$a.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},M$a._updateSceneConch=function(){var M$a=this._renderState;this._prepareUpdateToRenderState(M$F.mainContext,M$a),this._updateComponents(M$a),this._lateUpdateComponents(M$a),this._prepareSceneToRender(M$a);for(var M$b=0,M$c=this._cameraPool.length;M$b<M$c;M$b++){var M$d=this._cameraPool[M$b];(M$a.camera=M$d)._prepareCameraToRender()}},M$a._preRenderShadow=function(M$a,M$b,M$c,M$d,M$e){this.treeRoot?M$ca.renderShadowObjectCullingOctree(this,M$b,M$c,M$d,M$e):M$ca.renderShadowObjectCulling(this,M$b,M$c,M$d,M$e);for(var M$f=0,M$g=M$c.length;M$f<M$g;M$f++)M$c[M$f]&&M$c[M$f]._preRender(M$a)},M$a._renderShadowMap=function(M$a,M$b,M$c){var M$d=this.parallelSplitShadowMaps[0];M$d._calcAllLightCameraInfo(M$c);var M$e,M$f,M$g,M$h=M$d.PSSMNum;if(this._preRenderShadow(M$b,M$d._lightCulling,M$d._shadowQuenes,M$d._lightVPMatrix[0],M$h),this.addShaderDefine(M$nb.SHADERDEFINE_CAST_SHADOW),1<M$h)for(var M$i=0;M$i<M$h;M$i++)M$e=M$d.getRenderTarget(M$i+1),M$d.beginRenderTarget(M$i+1),M$a.clearColor(1,1,1,1),M$a.clear(16640),M$a.viewport(0,0,M$e.width,M$e.height),M$b.camera=M$g=M$d.getLightCamera(M$i),M$g._prepareCameraToRender(),M$g._prepareCameraViewProject(M$g.viewMatrix,M$g.projectionMatrix),M$b._projectionViewMatrix=M$d._lightVPMatrix[M$i+1],(M$f=M$d._shadowQuenes[M$i])._preRender(M$b),M$f._renderShadow(M$b,!1),M$d.endRenderTarget(M$i+1);else M$e=M$d.getRenderTarget(1),M$d.beginRenderTarget(1),M$a.clearColor(1,1,1,1),M$a.clear(16640),M$a.viewport(0,0,M$e.width,M$e.height),M$b.camera=M$g=M$d.getLightCamera(0),M$g._prepareCameraToRender(),M$g._prepareCameraViewProject(M$g.viewMatrix,M$g.projectionMatrix),M$b._projectionViewMatrix=M$d._lightVPMatrix[0],(M$f=M$d._shadowQuenes[0])._preRender(M$b),M$f._renderShadow(M$b,!0),M$d.endRenderTarget(1);this.removeShaderDefine(M$nb.SHADERDEFINE_CAST_SHADOW)},M$a.addTreeNode=function(M$a){this.treeRoot.addTreeNode(M$a)},M$a.removeTreeNode=function(M$a){this.treeSize&&M$a._treeNode&&M$a._treeNode.removeObject(M$a)},M$a.setlightmaps=function(M$a){this._lightmaps=M$a;for(var M$b=0,M$c=this._renderableSprite3Ds.length;M$b<M$c;M$b++)this._renderableSprite3Ds[M$b]._render._applyLightMapParams()},M$a.getlightmaps=function(){return this._lightmaps},M$a.addChildAt=function(M$a,M$b){if(!(M$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(M$a&&M$a.__className));if(!M$a||this.destroyed||M$a===this)return M$a;if(M$a.zOrder&&this._set$P("hasZorder",!0),0<=M$b&&M$b<=this._childs.length){if(M$a._parent===this){var M$c=this.getChildIndex(M$a);this._childs.splice(M$c,1),this._childs.splice(M$b,0,M$a),this.conchModel&&(this.conchModel.removeChild(M$a.conchModel),this.conchModel.addChildAt(M$a.conchModel,M$b)),this._childChanged()}else M$a.parent&&M$a.parent.removeChild(M$a),this._childs===M$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(M$b,0,M$a),this.conchModel&&this.conchModel.addChildAt(M$a.conchModel,M$b),(M$a.parent=this)._addChild3D(M$a);return M$a}throw new Error("appendChildAt:The index is out of bounds")},M$a.addChild=function(M$a){if(!(M$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!M$a||this.destroyed||M$a===this)return M$a;if(M$a.zOrder&&this._set$P("hasZorder",!0),M$a._parent===this){var M$b=this.getChildIndex(M$a);M$b!==this._childs.length-1&&(this._childs.splice(M$b,1),this._childs.push(M$a),this.conchModel&&(this.conchModel.removeChild(M$a.conchModel),this.conchModel.addChildAt(M$a.conchModel,this._childs.length-1)),this._childChanged())}else M$a.parent&&M$a.parent.removeChild(M$a),this._childs===M$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(M$a),this.conchModel&&this.conchModel.addChildAt(M$a.conchModel,this._childs.length-1),(M$a.parent=this)._childChanged(),this._addChild3D(M$a);return M$a},M$a.removeChildAt=function(M$a){var M$b=this.getChildAt(M$a);return M$b&&(this._removeChild3D(M$b),this._childs.splice(M$a,1),this.conchModel&&this.conchModel.removeChild(M$b.conchModel),M$b.parent=null),M$b},M$a.removeChildren=function(M$a,M$b){if(void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=2147483647),this._childs&&0<this._childs.length){var M$c=this._childs;if(0===M$a&&M$f<=M$b){var M$d=M$c;this._childs=M$j.ARRAY_EMPTY}else M$d=M$c.splice(M$a,M$b-M$a);for(var M$e=0,M$f=M$d.length;M$e<M$f;M$e++)this._removeChild3D(M$d[M$e]),M$d[M$e].parent=null,this.conchModel&&this.conchModel.removeChild(M$d[M$e].conchModel)}return this},M$a.addFrustumCullingObject=function(M$a){this.treeRoot?this.addTreeNode(M$a):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(M$a):this._cullingRenders[this._cullingRendersLength]=M$a,M$a._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},M$a.removeFrustumCullingObject=function(M$a){if(this.treeRoot)this.removeTreeNode(M$a);else{this._cullingRendersLength--;var M$b=M$a._indexInSceneFrustumCullingObjects;if(M$b!==this._cullingRendersLength){var M$c=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[M$b]=M$c)._indexInSceneFrustumCullingObjects=M$b,M$a._indexInSceneFrustumCullingObjects=-1}}},M$a.getRenderQueue=function(M$a){return M$a<3e3?this._quenes[1]||(this._quenes[1]=new M$X(this)):this._quenes[2]||(this._quenes[2]=new M$X(this))},M$a.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new M$X(this)},M$a.addShaderDefine=function(M$a){this._shaderDefineValue|=M$a},M$a.removeShaderDefine=function(M$a){this._shaderDefineValue&=~M$a},M$a.addScript=function(M$a){return this._addComponent(M$a)},M$a.getScriptByType=function(M$a,M$b){return void 0===M$b&&(M$b=0),this._getComponentByType(M$a,M$b)},M$a.getScriptsByType=function(M$a,M$b){this._getComponentsByType(M$a,M$b)},M$a.getScriptByIndex=function(M$a){return this._getComponentByIndex(M$a)},M$a.removeScriptByType=function(M$a,M$b){void 0===M$b&&(M$b=0),this._removeComponentByType(M$a,M$b)},M$a.removeScriptsByType=function(M$a){this._removeComponentByType(M$a)},M$a.removeAllScript=function(){this._removeAllComponent()},M$a.render=function(M$a,M$b,M$c){(M$p._context.ctx._renderKey=0)<this._childs.length&&M$a.addRenderObject(this)},M$a.renderSubmit=function(){var M$a=M$F.mainContext,M$b=this._renderState;this._set3DRenderConfig(M$a),this._prepareSceneToRender(this._renderState);var M$c,M$d=0,M$e=0;if(M$rb.debugMode||M$Z.debugMode)for(M$d=0,M$e=this._cameraPool.length;M$d<M$e;M$d++)M$c=this._cameraPool[M$d],M$rb._debugPhasorSprite.begin(1,M$c),M$c.activeInHierarchy&&M$c._renderCamera(M$a,M$b,this),M$rb._debugPhasorSprite.end();else for(M$d=0,M$e=this._cameraPool.length;M$d<M$e;M$d++)(M$c=this._cameraPool[M$d]).activeInHierarchy&&M$c._renderCamera(M$a,M$b,this);return this._set2DRenderConfig(M$a),1},M$a.onAsynLoaded=function(M$a,M$b,M$c){var M$d=M$b[0];if("Scene"!==M$d.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var M$e=M$b[1];M$qb._createNodeByJson(this,M$d,this,M$e),this.event("hierarchyloaded",[this]),this.__loaded=!0},M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),this.destroyed||(M$b.prototype.destroy.call(this,M$a),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,M$r.clearRes(this.url),this.loaded||M$rb._cancelLoadByUrl(this.url))},M$a.getRenderType=function(){return 0},M$a.releaseRender=function(){},M$a._addComponent=function(M$a){var M$b,M$c=this._componentsMap.indexOf(M$a);if(-1===M$c)M$b=[],this._componentsMap.push(M$a),this._typeComponentsIndices.push(M$b);else if(M$b=this._typeComponentsIndices[M$c],this._components[M$b[0]].isSingleton)throw new Error("无法单实例创建"+M$a+"组件，"+M$a+"组件已存在！");var M$d=M$e.getInstance(M$a);M$b.push(this._components.length),this._components.push(M$d);return M$d._initialize(this),M$d},M$a._removeComponent=function(M$a,M$b){var M$c=this._typeComponentsIndices[M$a],M$d=M$c[M$b],M$e=this._components[M$d];this._components.splice(M$d,1),M$c.splice(M$b,1),0===M$c.length&&(this._typeComponentsIndices.splice(M$a,1),this._componentsMap.splice(M$a,1));for(var M$f=0,M$g=this._componentsMap.length;M$f<M$g;M$f++)for(var M$h=(M$c=this._typeComponentsIndices[M$f]).length-1;0<=M$h;M$h--){var M$i=M$c[M$h];if(!(M$d<M$i))break;M$c[M$h]=--M$i}M$e._destroy()},M$a._getComponentByType=function(M$a,M$b){void 0===M$b&&(M$b=0);var M$c=this._componentsMap.indexOf(M$a);return-1===M$c?null:this._components[this._typeComponentsIndices[M$c][M$b]]},M$a._getComponentsByType=function(M$a,M$b){var M$c=this._componentsMap.indexOf(M$a);if(-1!==M$c){var M$d=this._typeComponentsIndices[M$c],M$e=M$d.length;M$b.length=M$e;for(var M$f=0;M$f<M$e;M$f++)M$b[M$f]=this._components[M$d[M$f]]}else M$b.length=0},M$a._getComponentByIndex=function(M$a){return this._components[M$a]},M$a._removeComponentByType=function(M$a,M$b){void 0===M$b&&(M$b=0);var M$c=this._componentsMap.indexOf(M$a);-1!==M$c&&this._removeComponent(M$c,M$b)},M$a._removeComponentsByType=function(M$a){var M$b=this._componentsMap.indexOf(M$a);if(-1!==M$b)for(var M$c=this._typeComponentsIndices[M$b],M$d=0,M$e=M$c.length;M$d<M$e;M$c.length<M$e?M$e--:M$d++)this._removeComponent(M$b,M$d)},M$a._removeAllComponent=function(){for(var M$a=0,M$b=this._componentsMap.length;M$a<M$b;this._componentsMap.length<M$b?M$b--:M$a++)this._removeComponentsByType(this._componentsMap[M$a])},M$a._updateComponents=function(M$a){for(var M$b=0,M$c=this._components.length;M$b<M$c;M$b++){var M$d=this._components[M$b];!M$d.started&&(M$d._start(M$a),M$d.started=!0),M$d.enable&&M$d._update(M$a)}},M$a._lateUpdateComponents=function(M$a){for(var M$b=0;M$b<this._components.length;M$b++){var M$c=this._components[M$b];!M$c.started&&(M$c._start(M$a),M$c.started=!0),M$c.enable&&M$c._lateUpdate(M$a)}},M$a._preRenderUpdateComponents=function(M$a){for(var M$b=0;M$b<this._components.length;M$b++){var M$c=this._components[M$b];!M$c.started&&(M$c._start(M$a),M$c.started=!0),M$c.enable&&M$c._preRenderUpdate(M$a)}},M$a._postRenderUpdateComponents=function(M$a){for(var M$b=0;M$b<this._components.length;M$b++){var M$c=this._components[M$b];!M$c.started&&(M$c._start(M$a),M$c.started=!0),M$c.enable&&M$c._postRenderUpdate(M$a)}},M$o(0,M$a,"_loaded",null,function(M$a){this.__loaded=M$a}),M$o(0,M$a,"fogColor",function(){return this._fogColor},function(M$a){this._fogColor=M$a,this._shaderValues.setValue(0,M$a.elements)}),M$o(0,M$a,"enableFog",function(){return this._enableFog},function(M$a){this._enableFog!==M$a&&((this._enableFog=M$a)?(this.addShaderDefine(M$Ab.SHADERDEFINE_FOG),this.removeShaderDefine(M$Ab.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(M$Ab.SHADERDEFINE_FOG))}),M$o(0,M$a,"url",function(){return this._url}),M$o(0,M$a,"loaded",function(){return this.__loaded}),M$o(0,M$a,"enableDepthFog",function(){return this._enableDepthFog},function(M$a){this._enableDepthFog!=M$a&&((this._enableDepthFog=M$a)?(this.addShaderDefine(M$Ab.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(M$Ab.SHADERDEFINE_FOG)):this.removeShaderDefine(M$Ab.SAHDERDEFINE_DEPTHFOG))}),M$o(0,M$a,"fogStart",function(){return this._fogStart},function(M$a){this._fogStart=M$a,this._shaderValues.setValue(1,M$a)}),M$o(0,M$a,"fogRange",function(){return this._fogRange},function(M$a){this._fogRange=M$a,this._shaderValues.setValue(2,M$a)}),M$o(0,M$a,"ambientColor",function(){return this._ambientColor},function(M$a){this._ambientColor=M$a,this._shaderValues.setValue(21,M$a.elements)}),M$o(0,M$a,"scene",function(){return this}),M$o(0,M$a,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),M$d._sortScenes=function(M$a,M$b){if(M$a.parent!==M$v.stage||M$b.parent!==M$v.stage)return M$a.parent!==M$v.stage&&M$b.parent!==M$v.stage?M$d._sortScenes(M$a.parent,M$b.parent):M$a.parent===M$v.stage?-1:1;var M$c=M$v.stage._childs;return M$c.indexOf(M$a)-M$c.indexOf(M$b)},M$d.load=function(M$a){return M$v.loader.create(M$a,null,null,M$d)},M$d.FOGCOLOR=0,M$d.FOGSTART=1,M$d.FOGRANGE=2,M$d.LIGHTDIRECTION=3,M$d.LIGHTDIRCOLOR=4,M$d.POINTLIGHTPOS=5,M$d.POINTLIGHTRANGE=6,M$d.POINTLIGHTATTENUATION=7,M$d.POINTLIGHTCOLOR=8,M$d.SPOTLIGHTPOS=9,M$d.SPOTLIGHTDIRECTION=10,M$d.SPOTLIGHTSPOT=11,M$d.SPOTLIGHTRANGE=12,M$d.SPOTLIGHTATTENUATION=13,M$d.SPOTLIGHTCOLOR=14,M$d.SHADOWDISTANCE=15,M$d.SHADOWLIGHTVIEWPROJECT=16,M$d.SHADOWMAPPCFOFFSET=17,M$d.SHADOWMAPTEXTURE1=18,M$d.SHADOWMAPTEXTURE2=19,M$d.SHADOWMAPTEXTURE3=20,M$d.AMBIENTCOLOR=21,M$d.TIME=22,M$d}(M$x),M$Kb=function(M$a){function M$b(M$a){M$b.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new M$ab,this._shaderValues=new M$mb,this._colliders=[],this._id=++M$b._uniqueIDCounter,this._transform=new M$wb(this),this.name=M$a||"Sprite3D-"+M$b._nameNumberCounter++,this.layer=M$I.currentCreationLayer,this.active=!0}M$n(M$b,"laya.d3.core.Sprite3D",M$Db);var M$c=M$b.prototype;return M$v.imps(M$c,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),M$c._setUrl=function(M$a){this._url=M$a},M$c._getGroup=function(){return this._group},M$c._setGroup=function(M$a){this._group=M$a},M$c._addChild3D=function(M$a){M$a.transform.parent=this.transform,this._hierarchyAnimator&&(!M$a._hierarchyAnimator&&M$a._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(M$a,!0,[M$a.name])),this._scene&&(M$a._setBelongScene(this._scene),this._activeInHierarchy&&M$a._active&&M$a._activeHierarchy())},M$c._removeChild3D=function(M$a){M$a.transform.parent=null,this._scene&&(this._activeInHierarchy&&M$a._active&&M$a._inActiveHierarchy(),M$a._setUnBelongScene()),this._hierarchyAnimator&&(M$a._hierarchyAnimator==this._hierarchyAnimator&&M$a._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(M$a,!1,[M$a.name]))},M$c._parseBaseCustomProps=function(M$a){var M$b=this.transform.localPosition;M$a.translate?(M$b.fromArray(M$a.translate),M$b.x*=100,M$b.y*=100,M$b.z*=100):M$b.elements.fill(0),this.transform.localPosition=M$b;var M$c=this.transform.localRotation;M$a.rotation?M$c.fromArray(M$a.rotation):M$c.fromArray([0,0,0,-1]),this.transform.localRotation=M$c;var M$d=this.transform.localScale;M$a.scale?M$d.fromArray(M$a.scale):M$d.elements.fill(1),this.transform.localScale=M$d;var M$e=M$a.layer;null!=M$e&&(this.layer=M$I.getLayerByNumber(M$e))},M$c._parseCustomComponent=function(M$a,M$b,M$c){for(var M$d in M$c){var M$e=M$c[M$d];switch(M$d){case"Animator":var M$f=this.addComponent(Animator);if(M$e.avatarPath)M$f.avatar=M$r.getRes(M$b[M$e.avatarPath]);else{var M$g=M$e.avatar;if(M$g){M$f.avatar=M$r.getRes(M$b[M$g.path]);var M$h=M$g.linkSprites;M$h&&M$a.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[M$f,M$h])}}for(var M$i=M$e.clipPaths,M$j=M$i.length,M$k=0;M$k<M$j;M$k++)M$f.addClip(M$r.getRes(M$b[M$i[M$k]]));M$f.clip=M$r.getRes(M$b[M$i[0]]);var M$l=M$e.playOnWake;void 0!==M$l&&(M$f.playOnWake=M$l);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var M$m=this.addComponent(SphereCollider);M$m.isTrigger=M$e.isTrigger;var M$n=M$m.center;M$n.fromArray(M$e.center),M$m.center=M$n,M$m.radius=M$e.radius;break;case"BoxCollider":var M$o=this.addComponent(BoxCollider);M$o.isTrigger=M$e.isTrigger,M$o.center.fromArray(M$e.center);var M$p=M$o.size;M$p.fromArray(M$e.size),M$o.size=M$p;break;case"MeshCollider":this.addComponent(MeshCollider)}}},M$c._onRootNodeHierarchyLoaded=function(M$a,M$b){for(var M$c in M$b){for(var M$d=this,M$e=M$b[M$c],M$f=0,M$g=M$e.length;M$f<M$g;M$f++){var M$h=M$e[M$f];if(""===M$h)break;if(!(M$d=M$d.getChildByName(M$h)))break}M$d&&M$a.linkSprite3DToAvatarNode(M$c,M$d)}},M$c._setHierarchyAnimator=function(M$a,M$b){this._changeHierarchyAnimator(M$a);for(var M$c=0,M$d=this._childs.length;M$c<M$d;M$c++){var M$e=this._childs[M$c];M$e._hierarchyAnimator==M$b&&M$e._setHierarchyAnimator(M$a,M$b)}},M$c._clearHierarchyAnimator=function(M$a,M$b){this._changeHierarchyAnimator(M$b);for(var M$c=0,M$d=this._childs.length;M$c<M$d;M$c++){var M$e=this._childs[M$c];M$e._hierarchyAnimator==M$a&&M$e._clearHierarchyAnimator(M$a,M$b)}},M$c._getAnimatorToLinkSprite3D=function(M$a,M$b,M$c){var M$d=this.getComponentByType(Animator);if(M$d&&(M$d.avatar?M$d.avatar._version||M$a._setAnimatorToLinkAvatar(M$d,M$b):M$a._setAnimatorToLinkSprite3DNoAvatar(M$d,M$b,M$c)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){M$c.unshift(this._parent.name);var M$e=this._parent;M$e._hierarchyAnimator&&M$e._getAnimatorToLinkSprite3D(M$a,M$b,M$c)}},M$c._setAnimatorToLinkSprite3DNoAvatar=function(M$a,M$b,M$c){var M$d=0,M$e=0;for(M$d=0,M$e=M$a.getClipCount();M$d<M$e;M$d++)M$a._handleSpriteOwnersBySprite(M$d,M$b,M$c,this);for(M$d=0,M$e=this._childs.length;M$d<M$e;M$d++){var M$f=this._childs[M$d],M$g=M$c.length;M$c.push(M$f.name),M$f._setAnimatorToLinkSprite3DNoAvatar(M$a,M$b,M$c),M$c.splice(M$g,1)}},M$c._changeHierarchyAnimator=function(M$a){this._hierarchyAnimator=M$a},M$c._isLinkSpriteToAnimationNode=function(M$a,M$b,M$c){var M$d=M$a._avatarNodes.indexOf(M$b),M$e=M$a._cacheSpriteToNodesMap;if(M$c)this._transform.dummy=M$b.transform,M$a._cacheNodesToSpriteMap[M$d]=M$e.length,M$e.push(M$d);else{this._transform.dummy=null;var M$f=M$a._cacheNodesToSpriteMap[M$d];M$a._cacheNodesToSpriteMap[M$d]=null,M$e.splice(M$f,1)}},M$c._setBelongScene=function(M$a){this._scene=M$a;for(var M$b=0,M$c=this._childs.length;M$b<M$c;M$b++)this._childs[M$b]._setBelongScene(M$a)},M$c._setUnBelongScene=function(){this._scene=null;for(var M$a=0,M$b=this._childs.length;M$a<M$b;M$a++)this._childs[M$a]._setUnBelongScene()},M$c._activeHierarchy=function(){var M$a=0,M$b=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),M$a=0,M$b=this._colliders.length;M$a<M$b;M$a++)this._layer._addCollider(this._colliders[M$a]);for(this.event("activeinhierarchychanged",!0),M$a=0,M$b=this._childs.length;M$a<M$b;M$a++){var M$c=this._childs[M$a];M$c._active&&M$c._activeHierarchy()}},M$c._inActiveHierarchy=function(){var M$a=0,M$b=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),M$a=0,M$b=this._colliders.length;M$a<M$b;M$a++){var M$c=this._colliders[M$a];M$c._clearCollsionMap(),this._layer._removeCollider(M$c)}for(this.event("activeinhierarchychanged",!1),M$a=0,M$b=this._childs.length;M$a<M$b;M$a++){var M$d=this._childs[M$a];M$d._active&&M$d._inActiveHierarchy()}},M$c.addComponent=function(M$a){var M$b,M$c=this._componentsMap.indexOf(M$a);if(-1===M$c)M$b=[],this._componentsMap.push(M$a),this._typeComponentsIndices.push(M$b);else if(M$b=this._typeComponentsIndices[M$c],this._components[M$b[0]].isSingleton)throw new Error("无法单实例创建"+M$a+"组件，"+M$a+"组件已存在！");var M$d=M$e.getInstance(M$a);return M$b.push(this._components.length),this._components.push(M$d),M$d instanceof laya.d3.component.Script&&this._scripts.push(M$d),M$d._initialize(this),M$d},M$c._removeComponent=function(M$a,M$b){var M$c,M$d=0,M$e=this._typeComponentsIndices[M$a],M$f=M$e[M$b],M$g=this._components[M$f];for(M$g instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(M$g),1),M$e.splice(M$b,1),0===M$e.length&&(this._typeComponentsIndices.splice(M$a,1),this._componentsMap.splice(M$a,1)),M$d=0,M$c=this._componentsMap.length;M$d<M$c;M$d++)for(var M$h=(M$e=this._typeComponentsIndices[M$d]).length-1;0<=M$h;M$h--){var M$i=M$e[M$h];if(!(M$f<M$i))break;M$e[M$h]=--M$i}M$g._destroy()},M$c._clearSelfRenderObjects=function(){},M$c._addSelfRenderObjects=function(){},M$c._parseCustomProps=function(M$a,M$b,M$c,M$d){},M$c._updateChilds=function(M$a){var M$b=this._childs.length;if(0!==M$b)for(var M$c=0;M$c<M$b;++M$c)this._childs[M$c]._update(M$a)},M$c._getSortID=function(M$a,M$b){return 1e3*M$b.id+M$a._getVertexBuffer().vertexDeclaration.id},M$c._update=function(M$a){(M$a.owner=this)._activeInHierarchy&&(this._updateComponents(M$a),this._lateUpdateComponents(M$a),M$A.spriteCount++,this._childs.length&&this._updateChilds(M$a))},M$c.getProjectionViewWorldMatrix=function(M$a){return M$ab.multiply(M$a,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},M$c.loadHierarchy=function(M$a){this.addChild(laya.d3.core.Sprite3D.load(M$a))},M$c.addChildAt=function(M$a,M$b){if(!(M$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!M$a||this.destroyed||M$a===this)return M$a;if(M$a.zOrder&&this._set$P("hasZorder",!0),0<=M$b&&M$b<=this._childs.length){if(M$a._parent===this){var M$c=this.getChildIndex(M$a);this._childs.splice(M$c,1),this._childs.splice(M$b,0,M$a),this.conchModel&&(this.conchModel.removeChild(M$a.conchModel),this.conchModel.addChildAt(M$a.conchModel,M$b)),this._childChanged()}else M$a.parent&&M$a.parent.removeChild(M$a),this._childs===M$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(M$b,0,M$a),this.conchModel&&this.conchModel.addChildAt(M$a.conchModel,M$b),(M$a.parent=this)._addChild3D(M$a);return M$a}throw new Error("appendChildAt:The index is out of bounds")},M$c.addChild=function(M$a){if(!(M$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!M$a||this.destroyed||M$a===this)return M$a;if(M$a.zOrder&&this._set$P("hasZorder",!0),M$a._parent===this){var M$b=this.getChildIndex(M$a);M$b!==this._childs.length-1&&(this._childs.splice(M$b,1),this._childs.push(M$a),this.conchModel&&(this.conchModel.removeChild(M$a.conchModel),this.conchModel.addChildAt(M$a.conchModel,this._childs.length-1)),this._childChanged())}else M$a.parent&&M$a.parent.removeChild(M$a),this._childs===M$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(M$a),this.conchModel&&this.conchModel.addChildAt(M$a.conchModel,this._childs.length-1),(M$a.parent=this)._childChanged(),this._addChild3D(M$a);return M$a},M$c.removeChildAt=function(M$a){var M$b=this.getChildAt(M$a);return M$b&&(this._removeChild3D(M$b),this._childs.splice(M$a,1),this.conchModel&&this.conchModel.removeChild(M$b.conchModel),M$b.parent=null),M$b},M$c.removeChildren=function(M$a,M$b){if(void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=2147483647),this._childs&&0<this._childs.length){var M$c=this._childs;if(0===M$a&&M$f<=M$b){var M$d=M$c;this._childs=M$j.ARRAY_EMPTY}else M$d=M$c.splice(M$a,M$b-M$a);for(var M$e=0,M$f=M$d.length;M$e<M$f;M$e++)this._removeChild3D(M$d[M$e]),M$d[M$e].parent=null,this.conchModel&&this.conchModel.removeChild(M$d[M$e].conchModel)}return this},M$c.onAsynLoaded=function(M$a,M$b,M$c){var M$d=M$b[0];if("Sprite3D"!==M$d.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var M$e=M$b[1];M$qb._createNodeByJson(this,M$d,this,M$e),this.event("hierarchyloaded",[this]),this.__loaded=!0},M$c.cloneTo=function(M$a){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var M$b=M$a;M$b.name=this.name,M$b._destroyed=this._destroyed,M$b.timer=this.timer,M$b._$P=this._$P,M$b.active=this._active;var M$c=M$b.transform.localPosition;this.transform.localPosition.cloneTo(M$c),M$b.transform.localPosition=M$c;var M$d=M$b.transform.localRotation;this.transform.localRotation.cloneTo(M$d),M$b.transform.localRotation=M$d;var M$e=M$b.transform.localScale;this.transform.localScale.cloneTo(M$e),M$b.transform.localScale=M$e,M$b.isStatic=this.isStatic;var M$f=0,M$g=0;for(M$f=0,M$g=this._componentsMap.length;M$f<M$g;M$f++){var M$h=M$b.addComponent(this._componentsMap[M$f]);this._components[M$f]._cloneTo(M$h)}for(M$f=0,M$g=this._childs.length;M$f<M$g;M$f++)M$b.addChild(this._childs[M$f].clone());var M$i=M$b.getComponentByType(Animator);if(M$i){var M$j=M$i._linkSpritesData;if(M$j)for(var M$k in M$j){for(var M$l=M$j[M$k],M$m=M$b,M$n=0,M$o=M$l.length;M$n<M$o&&(M$m=M$m.getChildByName(M$l[M$n]));M$n++);if(M$m){var M$p=M$i._avatarNodeMap[M$k];M$m._isLinkSpriteToAnimationNode(M$i,M$p,!0)}}}},M$c.clone=function(){var M$a=new this.constructor;return this.cloneTo(M$a),M$a},M$c.destroy=function(M$a){if(void 0===M$a&&(M$a=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,M$a);var M$b,M$c=0;for(M$c=0,M$b=this._components.length;M$c<M$b;M$c++)this._components[M$c]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,M$r.clearRes(this.url),this.loaded||M$rb._cancelLoadByUrl(this.url)}},M$c._handleSpriteToAvatar=function(M$a,M$b){M$a._avatarNodes;var M$c=M$a._avatarNodeMap[this.name];M$c&&M$c.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(M$a,M$c,M$b)},M$c._setAnimatorToLinkAvatar=function(M$a,M$b){this._handleSpriteToAvatar(M$a,M$b);for(var M$c=0,M$d=this._childs.length;M$c<M$d;M$c++){this._childs[M$c]._setAnimatorToLinkAvatar(M$a,M$b)}},M$o(0,M$c,"activeInHierarchy",function(){return this._activeInHierarchy}),M$o(0,M$c,"_loaded",null,function(M$a){this.__loaded=M$a}),M$o(0,M$c,"active",function(){return this._active},function(M$a){this._active!==M$a&&(this._active=M$a,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(M$a?this._activeHierarchy():this._inActiveHierarchy()))}),M$o(0,M$c,"componentsCount",function(){return this._components.length}),M$o(0,M$c,"loaded",function(){return this.__loaded}),M$o(0,M$c,"id",function(){return this._id}),M$o(0,M$c,"url",function(){return this._url}),M$o(0,M$c,"layer",function(){return this._layer},function(M$a){if(this._layer!==M$a){if(!M$a)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var M$b=0,M$c=this._colliders.length;if(this._layer)for(M$b=0;M$b<M$c;M$b++)this._layer._removeCollider(this._colliders[M$b]);for(M$b=0;M$b<M$c;M$b++)M$a._addCollider(this._colliders[M$b])}this._layer=M$a,this.event("layerchanged",M$a)}}),M$o(0,M$c,"scene",function(){return this._scene}),M$o(0,M$c,"transform",function(){return this._transform}),M$b.instantiate=function(M$a,M$b,M$c,M$d,M$e){void 0===M$c&&(M$c=!0);var M$f=M$a.clone();M$b&&M$b.addChild(M$f);var M$g=M$f.transform;if(M$c){var M$h=M$g.worldMatrix;M$a.transform.worldMatrix.cloneTo(M$h),M$g.worldMatrix=M$h}else M$d&&(M$g.position=M$d),M$e&&(M$g.rotation=M$e);return M$f},M$b.load=function(M$a){return M$v.loader.create(M$a,null,null,M$b)},M$b.WORLDMATRIX=0,M$b.MVPMATRIX=1,M$b._uniqueIDCounter=0,M$b._nameNumberCounter=0,M$b}(),M$Lb=function(M$a){function M$k(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],M$k.__super.call(this),!M$a||!M$b)throw"Shader Error";this._id=++M$k._count,this._vs=M$a,this._ps=M$b,this._attributeMap=M$c,this._sceneUniformMap=M$d,this._cameraUniformMap=M$e,this._spriteUniformMap=M$f,this._materialUniformMap=M$g,this._renderElementUniformMap=M$h,this._precompile=M$i,this._define=M$j,this._precompile&&M$k.extCompileObj&&M$k.extCompileFunc?M$k.extCompileFunc.call(M$k.extCompileObj,M$a,M$b,M$j):this.recreateResource()}M$n(M$k,"laya.d3.shader.Shader3D",M$c);var M$b=M$k.prototype;return M$b.recreateResource=function(){M$H.now();this._compile(),this.completeCreate(),this.memorySize=0},M$b.disposeResource=function(){M$F.mainContext.deleteShader(this._vshader),M$F.mainContext.deleteShader(this._pshader),M$F.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},M$b._compile=function(){if(!M$F.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var M$a=[this._vs,this._ps],M$b=M$F.mainContext;if(this._program=M$b.createProgram(),this._vshader=M$k._createShader(M$b,M$a[0],35633),this._pshader=M$k._createShader(M$b,M$a[1],35632),M$b.attachShader(this._program,this._vshader),M$b.attachShader(this._program,this._pshader),M$b.linkProgram(this._program),!M$p.isConchApp&&M$Ab.debugMode&&!M$b.getProgramParameter(this._program,35714))throw M$b.getProgramInfoLog(this._program);var M$c,M$d=0,M$e=0,M$f=0;for(M$f=M$p.isConchApp?M$b.getProgramParameterEx(this._vs,this._ps,"",35721):M$b.getProgramParameter(this._program,35721),M$d=0;M$d<M$f;M$d++){var M$g=null;M$c={vartype:"attribute",ivartype:0,attrib:M$g=M$p.isConchApp?M$b.getActiveAttribEx(this._vs,this._ps,"",M$d):M$b.getActiveAttrib(this._program,M$d),location:M$b.getAttribLocation(this._program,M$g.name),name:M$g.name,type:M$g.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(M$c)}var M$h=0;for(M$h=M$p.isConchApp?M$b.getProgramParameterEx(this._vs,this._ps,"",35718):M$b.getProgramParameter(this._program,35718),M$d=0;M$d<M$h;M$d++){var M$i=null;M$i=M$p.isConchApp?M$b.getActiveUniformEx(this._vs,this._ps,"",M$d):M$b.getActiveUniform(this._program,M$d),0<(M$c={vartype:"uniform",ivartype:1,attrib:M$g,location:M$b.getUniformLocation(this._program,M$i.name),name:M$i.name,type:M$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(M$c.name=M$c.name.substr(0,M$c.name.length-3),M$c.isArray=!0,M$c.location=M$b.getUniformLocation(this._program,M$c.name)),this._uniformParams.push(M$c)}for(M$d=0,M$e=this._attributeParams.length;M$d<M$e;M$d++)(M$c=this._attributeParams[M$d]).indexOfParams=M$d,M$c.index=1,M$c.value=[M$c.location,null],M$c.codename=M$c.name,M$c.name=null!=this._attributeMap[M$c.codename]?this._attributeMap[M$c.codename]:M$c.codename,this._attributeParamsMap.push(M$c.name),this._attributeParamsMap.push(M$c),M$c._this=this,M$c.uploadedValue=[],M$c.fun=this._attribute;for(M$d=0,M$e=this._uniformParams.length;M$d<M$e;M$d++)switch((M$c=this._uniformParams[M$d]).indexOfParams=M$d,M$c.index=1,M$c.value=[M$c.location,null],M$c.codename=M$c.name,null!=this._sceneUniformMap[M$c.codename]?(M$c.name=this._sceneUniformMap[M$c.codename],this._sceneUniformParamsMap.push(M$c.name),this._sceneUniformParamsMap.push(M$c)):null!=this._cameraUniformMap[M$c.codename]?(M$c.name=this._cameraUniformMap[M$c.codename],this._cameraUniformParamsMap.push(M$c.name),this._cameraUniformParamsMap.push(M$c)):null!=this._spriteUniformMap[M$c.codename]?(M$c.name=this._spriteUniformMap[M$c.codename],this._spriteUniformParamsMap.push(M$c.name),this._spriteUniformParamsMap.push(M$c)):null!=this._materialUniformMap[M$c.codename]?(M$c.name=this._materialUniformMap[M$c.codename],this._materialUniformParamsMap.push(M$c.name),this._materialUniformParamsMap.push(M$c)):null!=this._renderElementUniformMap[M$c.codename]?(M$c.name=this._renderElementUniformMap[M$c.codename],this._renderElementUniformParamsMap.push(M$c.name),this._renderElementUniformParamsMap.push(M$c)):console.log("Shader:can't find uinform name:"+M$c.codename+" in shader file."),M$c._this=this,M$c.uploadedValue=[],M$c.type){case 5124:M$c.fun=M$c.isArray?this._uniform1iv:this._uniform1i;break;case 5126:M$c.fun=M$c.isArray?this._uniform1fv:this._uniform1f;break;case 35664:M$c.fun=M$c.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:M$c.fun=M$c.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:M$c.fun=M$c.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:M$c.fun=this._uniform_sampler2D;break;case 35680:M$c.fun=this._uniform_samplerCube;break;case 35676:M$c.fun=this._uniformMatrix4fv;break;case 35670:M$c.fun=this._uniform1i;break;case 35674:M$c.fun=this._uinformMatrix2fv;break;case 35675:M$c.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},M$b._attribute=function(M$a,M$b){var M$c=M$F.mainContext,M$d=M$h._enableAtributes,M$e=M$a.location;return M$d[M$e]||M$c.enableVertexAttribArray(M$e),M$c.vertexAttribPointer(M$e,M$b[0],M$b[1],M$b[2],M$b[3],M$b[4]),M$d[M$e]=M$h._bindVertexBuffer,1},M$b._uniform1f=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b?(M$F.mainContext.uniform1f(M$a.location,M$c[0]=M$b),1):0},M$b._uniform1fv=function(M$a,M$b){if(M$b.length<4){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]||M$c[2]!==M$b[2]||M$c[3]!==M$b[3]?(M$F.mainContext.uniform1fv(M$a.location,M$b),M$c[0]=M$b[0],M$c[1]=M$b[1],M$c[2]=M$b[2],M$c[3]=M$b[3],1):0}return M$F.mainContext.uniform1fv(M$a.location,M$b),1},M$b._uniform_vec2=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]?(M$F.mainContext.uniform2f(M$a.location,M$c[0]=M$b[0],M$c[1]=M$b[1]),1):0},M$b._uniform_vec2v=function(M$a,M$b){if(M$b.length<2){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]||M$c[2]!==M$b[2]||M$c[3]!==M$b[3]?(M$F.mainContext.uniform2fv(M$a.location,M$b),M$c[0]=M$b[0],M$c[1]=M$b[1],M$c[2]=M$b[2],M$c[3]=M$b[3],1):0}return M$F.mainContext.uniform2fv(M$a.location,M$b),1},M$b._uniform_vec3=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]||M$c[2]!==M$b[2]?(M$F.mainContext.uniform3f(M$a.location,M$c[0]=M$b[0],M$c[1]=M$b[1],M$c[2]=M$b[2]),1):0},M$b._uniform_vec3v=function(M$a,M$b){return M$F.mainContext.uniform3fv(M$a.location,M$b),1},M$b._uniform_vec4=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]||M$c[2]!==M$b[2]||M$c[3]!==M$b[3]?(M$F.mainContext.uniform4f(M$a.location,M$c[0]=M$b[0],M$c[1]=M$b[1],M$c[2]=M$b[2],M$c[3]=M$b[3]),1):0},M$b._uniform_vec4v=function(M$a,M$b){return M$F.mainContext.uniform4fv(M$a.location,M$b),1},M$b._uniformMatrix2fv=function(M$a,M$b){return M$F.mainContext.uniformMatrix2fv(M$a.location,!1,M$b),1},M$b._uniformMatrix3fv=function(M$a,M$b){return M$F.mainContext.uniformMatrix3fv(M$a.location,!1,M$b),1},M$b._uniformMatrix4fv=function(M$a,M$b){return M$F.mainContext.uniformMatrix4fv(M$a.location,!1,M$b),1},M$b._uinformMatrix2fv=function(M$a,M$b){return M$F.mainContext.uniformMatrix2fv(M$a.location,!1,M$b),1},M$b._uinformMatrix3fv=function(M$a,M$b){return M$F.mainContext.uniformMatrix3fv(M$a.location,!1,M$b),1},M$b._uniform1i=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b?(M$F.mainContext.uniform1i(M$a.location,M$c[0]=M$b),1):0},M$b._uniform1iv=function(M$a,M$b){return M$F.mainContext.uniform1iv(M$a.location,M$b),1},M$b._uniform_ivec2=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]?(M$F.mainContext.uniform2i(M$a.location,M$c[0]=M$b[0],M$c[1]=M$b[1]),1):0},M$b._uniform_ivec2v=function(M$a,M$b){return M$F.mainContext.uniform2iv(M$a.location,M$b),1},M$b._uniform_vec3i=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]||M$c[2]!==M$b[2]?(M$F.mainContext.uniform3i(M$a.location,M$c[0]=M$b[0],M$c[1]=M$b[1],M$c[2]=M$b[2]),1):0},M$b._uniform_vec3vi=function(M$a,M$b){return M$F.mainContext.uniform3iv(M$a.location,M$b),1},M$b._uniform_vec4i=function(M$a,M$b){var M$c=M$a.uploadedValue;return M$c[0]!==M$b[0]||M$c[1]!==M$b[1]||M$c[2]!==M$b[2]||M$c[3]!==M$b[3]?(M$F.mainContext.uniform4i(M$a.location,M$c[0]=M$b[0],M$c[1]=M$b[1],M$c[2]=M$b[2],M$c[3]=M$b[3]),1):0},M$b._uniform_vec4vi=function(M$a,M$b){return M$F.mainContext.uniform4iv(M$a.location,M$b),1},M$b._uniform_sampler2D=function(M$a,M$b){var M$c=M$b.source||M$b.defaulteTexture.source,M$d=M$F.mainContext,M$e=M$a.uploadedValue;if(null!=M$e[0])return M$d.activeTexture(M$k._TEXTURES[M$e[0]]),M$c&&M$G.bindTexture(M$d,3553,M$c),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return M$e[0]=this._curActTexIndex,M$d.uniform1i(M$a.location,this._curActTexIndex),M$d.activeTexture(M$k._TEXTURES[this._curActTexIndex]),M$c&&M$G.bindTexture(M$d,3553,M$c),this._curActTexIndex++,1},M$b._uniform_samplerCube=function(M$a,M$b){var M$c=M$b.source||M$b.defaulteTexture.source,M$d=M$F.mainContext,M$e=M$a.uploadedValue;if(null!=M$e[0])return M$d.activeTexture(M$k._TEXTURES[M$e[0]]),M$c?M$G.bindTexture(M$d,34067,M$c):M$G.bindTexture(M$d,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return M$e[0]=this._curActTexIndex,M$d.uniform1i(M$a.location,this._curActTexIndex),M$d.activeTexture(M$k._TEXTURES[this._curActTexIndex]),M$c?M$G.bindTexture(M$d,34067,M$c):M$G.bindTexture(M$d,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},M$b._noSetValue=function(M$a){console.log("no....:"+M$a.name)},M$b.bind=function(){return M$c.activeShader=this,(M$c.bindShader=this).activeResource(),M$G.UseProgram(this._program)},M$b.uploadAttributes=function(M$a,M$b){for(var M$c,M$d,M$e=0,M$f=0,M$g=this._attributeParamsMap.length;M$f<M$g;M$f+=2)M$d=this._attributeParamsMap[M$f+1],null!=(M$c=M$a[this._attributeParamsMap[M$f]])&&(M$b&&M$b[M$d.name]&&M$b[M$d.name].bind(),M$e+=M$d.fun.call(this,M$d,M$c));M$A.shaderCall+=M$e},M$b.uploadAttributesX=function(M$a,M$b){for(var M$c,M$d,M$e=0,M$f=0,M$g=this._attributeParamsMap.length;M$f<M$g;M$f+=2)M$d=this._attributeParamsMap[M$f+1],null!=(M$c=M$a[this._attributeParamsMap[M$f]])&&(M$b._bind(),M$e+=M$d.fun.call(this,M$d,M$c));M$A.shaderCall+=M$e},M$b.uploadSceneUniforms=function(M$a){for(var M$b,M$c,M$d=0,M$e=0,M$f=this._sceneUniformParamsMap.length;M$e<M$f;M$e+=2)M$c=this._sceneUniformParamsMap[M$e+1],null!=(M$b=M$a[this._sceneUniformParamsMap[M$e]])&&(M$d+=M$c.fun.call(this,M$c,M$b));M$A.shaderCall+=M$d},M$b.uploadCameraUniforms=function(M$a){for(var M$b,M$c,M$d=0,M$e=0,M$f=this._cameraUniformParamsMap.length;M$e<M$f;M$e+=2)M$c=this._cameraUniformParamsMap[M$e+1],null!=(M$b=M$a[this._cameraUniformParamsMap[M$e]])&&(M$d+=M$c.fun.call(this,M$c,M$b));M$A.shaderCall+=M$d},M$b.uploadSpriteUniforms=function(M$a){for(var M$b,M$c,M$d=0,M$e=0,M$f=this._spriteUniformParamsMap.length;M$e<M$f;M$e+=2)M$c=this._spriteUniformParamsMap[M$e+1],null!=(M$b=M$a[this._spriteUniformParamsMap[M$e]])&&(M$d+=M$c.fun.call(this,M$c,M$b));M$A.shaderCall+=M$d},M$b.uploadMaterialUniforms=function(M$a){for(var M$b,M$c,M$d=0,M$e=0,M$f=this._materialUniformParamsMap.length;M$e<M$f;M$e+=2)M$c=this._materialUniformParamsMap[M$e+1],null!=(M$b=M$a[this._materialUniformParamsMap[M$e]])&&(M$d+=M$c.fun.call(this,M$c,M$b));M$A.shaderCall+=M$d},M$b.uploadRenderElementUniforms=function(M$a){for(var M$b,M$c,M$d=0,M$e=0,M$f=this._renderElementUniformParamsMap.length;M$e<M$f;M$e+=2)M$c=this._renderElementUniformParamsMap[M$e+1],null!=(M$b=M$a[this._renderElementUniformParamsMap[M$e]])&&(M$d+=M$c.fun.call(this,M$c,M$b));M$A.shaderCall+=M$d},M$k.create=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){return new M$k(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j)},M$k.addInclude=function(M$a,M$b){M$t.addInclude(M$a,M$b)},M$k._createShader=function(M$a,M$b,M$c){var M$d=M$a.createShader(M$c);if(M$a.shaderSource(M$d,M$b),M$a.compileShader(M$d),M$Ab.debugMode&&!M$a.getShaderParameter(M$d,35713))throw M$a.getShaderInfoLog(M$d);return M$d},M$k.PERIOD_RENDERELEMENT=0,M$k.PERIOD_MATERIAL=1,M$k.PERIOD_SPRITE=2,M$k.PERIOD_CAMERA=3,M$k.PERIOD_SCENE=4,M$k._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],M$k._count=0,M$k._preCompile=!1,M$k.extCompileFunc=null,M$k.extCompileObj=null,M$l(M$k,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new M$B}]),M$k}(),M$Mb=function(M$h){function M$i(){this._transformUV=null,M$i.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new M$gb(.6,.6,.6)),this._setColor(10,new M$gb(1,1,1)),this._setColor(11,new M$hb(1,1,1,8)),this._setColor(12,new M$gb(1,1,1)),this._setColor(7,new M$hb(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new M$hb(1,1,0,0)),this.renderMode=1}M$n(M$i,"laya.d3.core.material.StandardMaterial",M$h);var M$a=M$i.prototype;return M$a.disableLight=function(){this._addDisablePublicShaderDefine(M$Ab.SHADERDEFINE_POINTLIGHT|M$Ab.SHADERDEFINE_SPOTLIGHT|M$Ab.SHADERDEFINE_DIRECTIONLIGHT)},M$a.disableFog=function(){this._addDisablePublicShaderDefine(M$Ab.SHADERDEFINE_FOG)},M$a.onAsynLoaded=function(M$a,M$b,M$c){var M$d=M$b[0];if(M$d.version)M$h.prototype.onAsynLoaded.call(this,M$a,M$b,M$c);else{var M$e=M$b[1],M$f=M$d.props;for(var M$g in M$f)this[M$g]=M$f[M$g];M$i._parseStandardMaterial(M$e,this,M$d),this._endLoaded()}},M$a.cloneTo=function(M$a){M$h.prototype.cloneTo.call(this,M$a);var M$b=M$a;this._transformUV&&(M$b._transformUV=this._transformUV.clone())},M$o(0,M$a,"ambientColor",function(){return this._getColor(9)},function(M$a){this._setColor(9,M$a)}),M$o(0,M$a,"ambientTexture",function(){return this._getTexture(5)},function(M$a){M$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,M$a)}),M$o(0,M$a,"renderMode",null,function(M$a){switch(M$a){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(M$i.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(M$a)}),M$o(0,M$a,"reflectColor",function(){return this._getColor(12)},function(M$a){this._setColor(12,M$a)}),M$o(0,M$a,"tilingOffset",function(){return this._getColor(15)},function(M$a){if(M$a){var M$b=M$a.elements;1!=M$b[0]||1!=M$b[1]||0!=M$b[2]||0!=M$b[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,M$a)}),M$o(0,M$a,"albedo",function(){return this._getColor(7)},function(M$a){this._setColor(7,M$a)}),M$o(0,M$a,"diffuseColor",function(){return this._getColor(10)},function(M$a){this._setColor(10,M$a)}),M$o(0,M$a,"albedoColor",function(){return this._getColor(7)},function(M$a){this._setColor(7,M$a)}),M$o(0,M$a,"specularColor",function(){return this._getColor(11)},function(M$a){this._setColor(11,M$a)}),M$o(0,M$a,"diffuseTexture",function(){return this._getTexture(1)},function(M$a){M$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,M$a)}),M$o(0,M$a,"normalTexture",function(){return this._getTexture(2)},function(M$a){M$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,M$a)}),M$o(0,M$a,"specularTexture",function(){return this._getTexture(3)},function(M$a){M$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,M$a)}),M$o(0,M$a,"emissiveTexture",function(){return this._getTexture(4)},function(M$a){M$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,M$a)}),M$o(0,M$a,"reflectTexture",function(){return this._getTexture(6)},function(M$a){M$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,M$a)}),M$o(0,M$a,"transformUV",function(){return this._transformUV},function(M$a){this._transformUV=M$a,this._setMatrix4x4(13,M$a.matrix),M$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,M$a.matrix.elements,0)}),M$i.__init__=function(){M$i.SHADERDEFINE_DIFFUSEMAP=M$i.shaderDefines.registerDefine("DIFFUSEMAP"),M$i.SHADERDEFINE_NORMALMAP=M$i.shaderDefines.registerDefine("NORMALMAP"),M$i.SHADERDEFINE_SPECULARMAP=M$i.shaderDefines.registerDefine("SPECULARMAP"),M$i.SHADERDEFINE_EMISSIVEMAP=M$i.shaderDefines.registerDefine("EMISSIVEMAP"),M$i.SHADERDEFINE_AMBIENTMAP=M$i.shaderDefines.registerDefine("AMBIENTMAP"),M$i.SHADERDEFINE_REFLECTMAP=M$i.shaderDefines.registerDefine("REFLECTMAP"),M$i.SHADERDEFINE_UVTRANSFORM=M$i.shaderDefines.registerDefine("UVTRANSFORM"),M$i.SHADERDEFINE_TILINGOFFSET=M$i.shaderDefines.registerDefine("TILINGOFFSET"),M$i.SHADERDEFINE_ADDTIVEFOG=M$i.shaderDefines.registerDefine("ADDTIVEFOG")},M$i.load=function(M$a){return M$v.loader.create(M$a,null,null,M$i)},M$i._parseStandardMaterial=function(M$a,M$b,M$c){var M$d=M$c.customProps,M$e=M$d.ambientColor;M$b.ambientColor=new M$gb(M$e[0],M$e[1],M$e[2]);var M$f=M$d.diffuseColor;M$b.diffuseColor=new M$gb(M$f[0],M$f[1],M$f[2]);var M$g=M$d.specularColor;M$b.specularColor=new M$hb(M$g[0],M$g[1],M$g[2],M$g[3]);var M$h=M$d.reflectColor;M$b.reflectColor=new M$gb(M$h[0],M$h[1],M$h[2]);var M$i=M$d.albedoColor;M$i&&(M$b.albedo=new M$hb(M$i[0],M$i[1],M$i[2],M$i[3]));var M$j=M$d.diffuseTexture.texture2D;M$j&&(M$b.diffuseTexture=M$r.getRes(M$a[M$j]));var M$k=M$d.normalTexture.texture2D;M$k&&(M$b.normalTexture=M$r.getRes(M$a[M$k]));var M$l=M$d.specularTexture.texture2D;M$l&&(M$b.specularTexture=M$r.getRes(M$a[M$l]));var M$m=M$d.emissiveTexture.texture2D;M$m&&(M$b.emissiveTexture=M$r.getRes(M$a[M$m]));var M$n=M$d.ambientTexture.texture2D;M$n&&(M$b.ambientTexture=M$r.getRes(M$a[M$n]));var M$o=M$d.reflectTexture.texture2D;M$o&&(M$b.reflectTexture=M$r.getRes(M$a[M$o]))},M$i.RENDERMODE_OPAQUE=1,M$i.RENDERMODE_OPAQUEDOUBLEFACE=2,M$i.RENDERMODE_CUTOUT=3,M$i.RENDERMODE_CUTOUTDOUBLEFACE=4,M$i.RENDERMODE_TRANSPARENT=13,M$i.RENDERMODE_TRANSPARENTDOUBLEFACE=14,M$i.RENDERMODE_ADDTIVE=15,M$i.RENDERMODE_ADDTIVEDOUBLEFACE=16,M$i.RENDERMODE_DEPTHREAD_TRANSPARENT=5,M$i.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,M$i.RENDERMODE_DEPTHREAD_ADDTIVE=7,M$i.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,M$i.RENDERMODE_NONDEPTH_TRANSPARENT=9,M$i.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,M$i.RENDERMODE_NONDEPTH_ADDTIVE=11,M$i.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,M$i.SHADERDEFINE_DIFFUSEMAP=0,M$i.SHADERDEFINE_NORMALMAP=0,M$i.SHADERDEFINE_SPECULARMAP=0,M$i.SHADERDEFINE_EMISSIVEMAP=0,M$i.SHADERDEFINE_AMBIENTMAP=0,M$i.SHADERDEFINE_REFLECTMAP=0,M$i.SHADERDEFINE_UVTRANSFORM=0,M$i.SHADERDEFINE_TILINGOFFSET=0,M$i.SHADERDEFINE_ADDTIVEFOG=0,M$i.DIFFUSETEXTURE=1,M$i.NORMALTEXTURE=2,M$i.SPECULARTEXTURE=3,M$i.EMISSIVETEXTURE=4,M$i.AMBIENTTEXTURE=5,M$i.REFLECTTEXTURE=6,M$i.ALBEDO=7,M$i.UVANIAGE=8,M$i.MATERIALAMBIENT=9,M$i.MATERIALDIFFUSE=10,M$i.MATERIALSPECULAR=11,M$i.MATERIALREFLECT=12,M$i.UVMATRIX=13,M$i.UVAGE=14,M$i.TILINGOFFSET=15,M$l(M$i,["defaultMaterial",function(){var M$a=new M$i;return M$a.lock=!0,this.defaultMaterial=M$a},"shaderDefines",function(){return this.shaderDefines=new M$kb(M$Eb.shaderDefines)}]),M$i}(M$Eb),M$Nb=function(M$a){function M$g(M$a,M$b,M$c,M$d,M$e){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===M$c&&(M$c=35044),void 0===M$d&&(M$d=!1),M$g.__super.call(this),this._indexType=M$a,this._indexCount=M$b,this._bufferUsage=M$c,this._bufferType=34963,this._canRead=M$d;var M$f;if("ushort"==M$a)this._indexTypeByteCount=2;else{if("ubyte"!=M$a)throw new Error("unidentification index type.");this._indexTypeByteCount=1}M$f=this._indexTypeByteCount*M$b,this._byteLength=M$f,this._bind(),M$h._gl.bufferData(this._bufferType,M$f,this._bufferUsage),this.uri=M$e,M$d?("ushort"==M$a?this._buffer=new Uint16Array(M$b):"ubyte"==M$a&&(this._buffer=new Uint8Array(M$b)),this.memorySize=2*M$f):this.memorySize=M$f}M$n(M$g,"laya.d3.graphics.IndexBuffer3D",M$a);var M$b=M$g.prototype;return M$b.setData=function(M$a,M$b,M$c,M$d){void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=4294967295);var M$e=0;if("ushort"==this._indexType?(M$e=2,0===M$c&&4294967295===M$d||(M$a=new Uint16Array(M$a.buffer,M$c*M$e,M$d))):"ubyte"==this._indexType&&(M$e=1,0===M$c&&4294967295===M$d||(M$a=new Uint8Array(M$a.buffer,M$c*M$e,M$d))),this._bind(),M$h._gl.bufferSubData(this._bufferType,M$b*M$e,M$a),this._canRead)if(0!==M$b||0!==M$c||4294967295!==M$d){var M$f=this._buffer.length-M$b;M$f<M$d&&(M$d=M$f);for(var M$g=0;M$g<M$d;M$g++)this._buffer[M$b+M$g]=M$a[M$g]}else this._buffer=M$a},M$b.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},M$b.disposeResource=function(){M$a.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},M$o(0,M$b,"indexType",function(){return this._indexType}),M$o(0,M$b,"indexTypeByteCount",function(){return this._indexTypeByteCount}),M$o(0,M$b,"indexCount",function(){return this._indexCount}),M$o(0,M$b,"canRead",function(){return this._canRead}),M$g.INDEXTYPE_UBYTE="ubyte",M$g.INDEXTYPE_USHORT="ushort",M$g.create=function(M$a,M$b,M$c,M$d,M$e){return void 0===M$c&&(M$c=35044),void 0===M$d&&(M$d=!1),new M$g(M$a,M$b,M$c,M$d,M$e)},M$g}(M$h),M$Ob=function(M$f){function M$g(M$a,M$b,M$c,M$d,M$e){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===M$d&&(M$d=!1),M$g.__super.call(this),this._vertexDeclaration=M$a,this._vertexCount=M$b,this._bufferUsage=M$c,this._bufferType=34962,this._canRead=M$d,this.uri=M$e,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*M$b,this._bind(),M$h._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),M$d&&(this._buffer=new Float32Array(this._byteLength/4))}M$n(M$g,"laya.d3.graphics.VertexBuffer3D",M$f);var M$a=M$g.prototype;return M$a.bindWithIndexBuffer=function(M$a){M$a&&M$a._bind(),this._bind()},M$a.setData=function(M$a,M$b,M$c,M$d){if(void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=4294967295),0===M$c&&4294967295===M$d||(M$a=new Float32Array(M$a.buffer,4*M$c,M$d)),this._bind(),M$h._gl.bufferSubData(this._bufferType,4*M$b,M$a),this._canRead)if(0!==M$b||0!==M$c||4294967295!==M$d){var M$e=this._buffer.length-M$b;M$e<M$d&&(M$d=M$e);for(var M$f=0;M$f<M$d;M$f++)this._buffer[M$b+M$f]=M$a[M$f]}else this._buffer=M$a},M$a.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},M$a.disposeResource=function(){for(var M$a=M$F.mainContext,M$b=this._vertexDeclaration.getVertexElements(),M$c=M$h._enableAtributes,M$d=0,M$e=M$b.length;M$d<M$e;M$d++)M$c[M$d]===this._glBuffer&&(M$a.disableVertexAttribArray(M$d),M$c[M$d]=null);M$f.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},M$o(0,M$a,"vertexDeclaration",function(){return this._vertexDeclaration}),M$o(0,M$a,"vertexCount",function(){return this._vertexCount}),M$o(0,M$a,"canRead",function(){return this._canRead}),M$g.create=function(M$a,M$b,M$c,M$d,M$e){return void 0===M$c&&(M$c=35044),void 0===M$d&&(M$d=!1),new M$g(M$a,M$b,M$c,M$d,M$e)},M$g}(M$h),M$Pb=function(M$a){function M$t(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,M$t.__super.call(this),this._type=3553}M$n(M$t,"laya.d3.resource.DataTexture2D",M$Fb);var M$b=M$t.prototype;return M$b.genDebugMipmaps=function(){var M$a=[];return M$a.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),M$a.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),M$a.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),M$a.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),M$a.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),M$a.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),M$a.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),M$a.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),M$a.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),M$a.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),M$a},M$b._onTextureLoaded=function(M$a){},M$b._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var M$a=M$F.mainContext,M$b=this._source=M$a.createTexture(),M$c=this._width,M$d=this._height,M$e=M$G.curBindTexTarget,M$f=M$G.curBindTexValue,M$g=!1;if(M$G.bindTexture(M$a,this._type,M$b),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var M$h=0;M$a.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var M$i=0;M$i<this._mipmaps.length;M$i++){if(this._mipmaps[M$i].byteLength!=M$j*M$k*4)throw"mipmap size error  level:"+M$i;M$a.texSubImage2D(this._type,0,M$t.simLodRect[M$h++],M$t.simLodRect[M$h++],M$t.simLodRect[M$h++],M$t.simLodRect[M$h++],6408,5121,new Uint8Array(this._mipmaps[M$i]))}this.minFifter=9729,this.magFifter=9729}else{var M$j=this._width,M$k=this._height;for(M$h=0,M$a.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),M$i=0;M$i<this._mipmaps.length;M$i++){if(this._mipmaps[M$i].byteLength!=M$j*M$k*4)throw"mipmap size error  level:"+M$i;M$a.texImage2D(this._type,M$i,6408,M$j,M$k,0,6408,5121,new Uint8Array(this._mipmaps[M$i])),(M$j/=2)<1&&(M$j=1),(M$k/=2)<1&&(M$k=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&M$a.pixelStorei(M$a.UNPACK_ALIGNMENT,1),M$a.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var M$l=0,M$m=!1,M$n=!1;this._buffer.byteLength==4*M$c*M$d?(M$l=6408,M$m=!0):this._buffer.byteLength==3*M$c*M$d?(M$l=6407,M$n=!0):M$l=this._format,M$m||M$n?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),M$n&&M$a.pixelStorei(M$a.UNPACK_ALIGNMENT,1),M$a.texImage2D(this._type,0,M$l,M$c,M$d,0,M$l,5121,this._buffer)):M$a&&M$l==M$a.ALPHA?(M$a.texImage2D(3553,0,M$l,M$c,M$d,0,M$l,M$a.UNSIGNED_BYTE,this._buffer),M$g=!0):0!=M$l&&(M$a.compressedTexImage2D(3553,0,M$l,M$c,M$d,0,this._buffer),M$g=!0)}var M$o=this._minFifter,M$p=this._magFifter,M$q=0==this._wrapModeU?10497:33071,M$r=0==this._wrapModeV?10497:33071,M$s=M$u.isPOT(M$c,M$d);M$s?(this._mipmap||this._mipmaps?-1!==M$o||(M$o=9987):-1!==M$o||(M$o=9729),-1!==M$p||(M$p=9729),M$a.texParameteri(this._type,10241,M$o),M$a.texParameteri(this._type,10240,M$p),M$a.texParameteri(this._type,10242,M$q),M$a.texParameteri(this._type,10243,M$r),this._mipmap&&M$a.generateMipmap(this._type)):(-1!==M$o||(M$o=9729),-1!==M$p||(M$p=9729),M$a.texParameteri(this._type,10241,M$o),M$a.texParameteri(this._type,10240,M$p),M$a.texParameteri(this._type,10242,33071),M$a.texParameteri(this._type,10243,33071)),M$e&&M$f&&M$G.bindTexture(M$a,M$e,M$f),this.memorySize=M$g?this._buffer.length:M$s?M$c*M$d*4*(1+1/3):M$c*M$d*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},M$b.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},M$b.onAsynLoaded=function(M$a,M$b,M$c){var M$d;M$c&&(M$d=M$c[0].call(this,M$b)),M$d&&(this._width=M$d.width,this._height=M$d.height,this._buffer=M$d.data),this._src=M$a,this._size=new M$pb(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},M$b.getPixels=function(){return new Uint8Array(this._buffer)},M$b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(M$F.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},M$o(0,M$b,"src",function(){return this._src}),M$t.create=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){if(void 0===M$d&&(M$d=9729),void 0===M$e&&(M$e=9729),void 0===M$f&&(M$f=!0),!M$a||M$a.byteLength<M$b*M$c*4)throw"DataTexture2D create error";var M$h=new M$t;return M$h.uri=M$g,M$h._buffer=M$a,M$h._width=M$b,M$h._height=M$c,M$h._mipmap=M$f,M$h._magFifter=M$d,M$h._minFifter=M$e,M$h._size=new M$pb(M$h._width,M$h._height),M$h._conchTexture?alert("怎么给runtime传递datatexture数据"):M$h.activeResource(),M$h},M$t.load=function(M$a,M$b,M$c,M$d,M$e){if(void 0===M$b&&(M$b=0),void 0===M$c&&(M$c=0),void 0===M$d&&(M$d=9729),void 0===M$e&&(M$e=9729),"mipmaps"===M$C.getFileExtension(M$a)){var M$f=M$v.loader.create(M$a,null,null,M$t,[function(M$a){this._mipmaps=[];var M$b=new Uint32Array(M$a);this._width=M$b[0];var M$c=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,M$c=1024),this._width!=M$c)throw"现在只支持512x256的环境贴图。当前的是"+M$b[0];this._height=M$b[1];for(var M$d=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,M$e=this._height,M$f=8;;){var M$g=M$d*M$e*4;if(M$f+M$g>M$a.byteLength)throw"load mipmaps data size error ";var M$h=new Uint8Array(M$a,M$f,M$g);if(this._mipmaps.push(M$h),M$f+=M$g,1==M$d&&1==M$e)break;(M$d/=2)<1&&(M$d=1),(M$e/=2)<1&&(M$e=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){M$f.simLodInfo=new Float32Array(40);for(var M$g=0;M$g<M$f.simLodInfo.length;)M$f.simLodInfo[M$g]=(M$t.simLodRect[M$g]+.5)/1024,M$g++,M$f.simLodInfo[M$g]=(M$t.simLodRect[M$g]+.5)/256,M$g++,M$f.simLodInfo[M$g]=Math.max(M$t.simLodRect[M$g]-1,.1)/1024,M$g++,M$f.simLodInfo[M$g]=Math.max(M$t.simLodRect[M$g]-1.5,.1)/256,M$g++}return M$f}if("number"==typeof M$b)return M$v.loader.create(M$a,null,null,M$t,[function(M$a){return this._width=M$b,this._height=M$c,this._buffer=M$a,null}]);if("function"==typeof M$b)return M$v.loader.create(M$a,null,null,M$t,[M$b]);throw new Error("unknown params.")},M$t.lodasatlas=!1,M$l(M$t,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),M$t}(),M$Qb=function(M$a){function M$b(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,M$b.__super.call(this)}M$n(M$b,"laya.d3.resource.models.PrimitiveMesh",M$Gb);var M$c=M$b.prototype;return M$v.imps(M$c,{"laya.d3.core.render.IRenderable":!0}),M$c._getVertexBuffer=function(M$a){return void 0===M$a&&(M$a=0),0===M$a?this._vertexBuffer:null},M$c._getVertexBuffers=function(){return null},M$c._getIndexBuffer=function(){return this._indexBuffer},M$c._getPositions=function(){var M$a,M$b=[],M$c=this._vertexBuffer.vertexDeclaration.getVertexElements(),M$d=0;for(M$d=0;M$d<M$c.length;M$d++){var M$e=M$c[M$d];if("vector3"===M$e.elementFormat&&0===M$e.elementUsage){M$a=M$e;break}}var M$f=this._vertexBuffer.getData();for(M$d=0;M$d<M$f.length;M$d+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var M$g=M$d+M$a.offset/4,M$h=new M$gb(M$f[M$g+0],M$f[M$g+1],M$f[M$g+2]);M$b.push(M$h)}return M$b},M$c.getRenderElement=function(M$a){return this},M$c.getRenderElementsCount=function(){return 1},M$c.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},M$c._beforeRender=function(M$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},M$c._render=function(M$a){M$F.mainContext.drawElements(4,this._numberIndices,5123,0),M$A.drawCall++,M$A.trianglesFaces+=this._numberIndices/3},M$o(0,M$c,"_vertexBufferCount",function(){return 1}),M$o(0,M$c,"triangleCount",function(){return this._indexBuffer.indexCount/3}),M$b}(),M$Rb=function(M$a){function M$b(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,M$b.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}M$n(M$b,"laya.d3.resource.models.Mesh",M$Gb);var M$c=M$b.prototype;return M$c._getPositions=function(){var M$a,M$b,M$c,M$d,M$e,M$f=[],M$g=0,M$h=0,M$i=0;if(0!==this._vertexBuffers.length){var M$j=this._vertexBuffers.length;for(M$g=0;M$g<M$j;M$g++){for(M$c=(M$a=this._vertexBuffers[M$g]).vertexDeclaration.getVertexElements(),M$h=0;M$h<M$c.length;M$h++)if("vector3"===(M$d=M$c[M$h]).elementFormat&&0===M$d.elementUsage){M$b=M$d;break}for(M$e=M$a.getData(),M$h=0;M$h<M$e.length;M$h+=M$a.vertexDeclaration.vertexStride/4)M$i=M$h+M$b.offset/4,M$f.push(new M$gb(M$e[M$i+0],M$e[M$i+1],M$e[M$i+2]))}}else{var M$k=this._subMeshes.length;for(M$g=0;M$g<M$k;M$g++){for(M$c=(M$a=this._subMeshes[M$g]._getVertexBuffer()).vertexDeclaration.getVertexElements(),M$h=0;M$h<M$c.length;M$h++)if("vector3"===(M$d=M$c[M$h]).elementFormat&&0===M$d.elementUsage){M$b=M$d;break}for(M$e=M$a.getData(),M$h=0;M$h<M$e.length;M$h+=M$a.vertexDeclaration.vertexStride/4)M$i=M$h+M$b.offset/4,M$f.push(new M$gb(M$e[M$i+0],M$e[M$i+1],M$e[M$i+2]))}}return M$f},M$c._setSubMeshes=function(M$a){this._subMeshes=M$a,this._subMeshCount=M$a.length;for(var M$b=0;M$b<this._subMeshCount;M$b++)M$a[M$b]._indexInMesh=M$b;this._positions=this._getPositions(),this._generateBoundingObject()},M$c.onAsynLoaded=function(M$a,M$b,M$c){var M$d=M$b[0],M$e=M$b[1];M$Ya.read(M$d,this,this._materials,this._subMeshes,M$e),this.completeCreate(),this._endLoaded()},M$c.getSubMesh=function(M$a){return this._subMeshes[M$a]},M$c.getSubMeshCount=function(){return this._subMeshes.length},M$c.getRenderElementsCount=function(){return this._subMeshes.length},M$c.getRenderElement=function(M$a){return this._subMeshes[M$a]},M$c.disposeResource=function(){for(var M$a=0;M$a<this._subMeshes.length;M$a++)this._subMeshes[M$a].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},M$o(0,M$c,"materials",function(){return this._materials.slice()}),M$o(0,M$c,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),M$b.load=function(M$a){return M$v.loader.create(M$a,null,null,M$b)},M$b}(),M$Sb=(function(M$a){function M$j(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===M$c&&(M$c=6408),void 0===M$d&&(M$d=5121),void 0===M$e&&(M$e=33189),void 0===M$f&&(M$f=!1),void 0===M$g&&(M$g=!1),void 0===M$h&&(M$h=-1),void 0===M$i&&(M$i=-1),M$j.__super.call(this),this._type=3553,this._width=M$a,this._height=M$b,this._size=new M$pb(M$a,M$b),this._surfaceFormat=M$c,this._surfaceType=M$d,this._depthStencilFormat=M$e,M$p.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=M$f,this._repeat=M$g,this._minFifter=M$h,this._magFifter=M$i,this.activeResource(),this._alreadyResolved=!0}M$n(M$j,"laya.d3.resource.RenderTexture",M$Fb);var M$b=M$j.prototype;M$b.recreateResource=function(){var M$a=M$F.mainContext;this._frameBuffer=M$a.createFramebuffer(),this._source=M$a.createTexture();var M$b=M$G.curBindTexTarget,M$c=M$G.curBindTexValue;M$G.bindTexture(M$a,this._type,this._source),M$a.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var M$d=this._minFifter,M$e=this._magFifter,M$f=this._repeat?10497:33071;if(M$u.isPOT(this._width,this._height)?(this._mipmap?-1!==M$d||(M$d=9987):-1!==M$d||(M$d=9729),-1!==M$e||(M$e=9729),M$a.texParameteri(this._type,10241,M$d),M$a.texParameteri(this._type,10240,M$e),M$a.texParameteri(this._type,10242,M$f),M$a.texParameteri(this._type,10243,M$f),this._mipmap&&M$a.generateMipmap(this._type)):(-1!==M$d||(M$d=9729),-1!==M$e||(M$e=9729),M$a.texParameteri(this._type,10241,M$d),M$a.texParameteri(this._type,10240,M$e),M$a.texParameteri(this._type,10242,33071),M$a.texParameteri(this._type,10243,33071)),M$b&&M$c&&M$G.bindTexture(M$a,M$b,M$c),M$a.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=M$a.createRenderbuffer(),M$a.bindRenderbuffer(36161,this._depthStencilBuffer),M$a.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),M$a.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:M$a.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:M$a.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:M$a.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}M$a.framebufferTexture2D(36160,36064,3553,this._source,0),M$a.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},M$b.start=function(){M$F.mainContext.bindFramebuffer(36160,this.frameBuffer),(M$j._currentRenderTarget=this)._alreadyResolved=!1},M$b.end=function(){M$F.mainContext.bindFramebuffer(36160,null),M$j._currentRenderTarget=null,this._alreadyResolved=!0},M$b.getData=function(M$a,M$b,M$c,M$d){var M$e=M$F.mainContext;if(M$e.bindFramebuffer(36160,this._frameBuffer),!(36053===M$e.checkFramebufferStatus(36160)))return M$e.bindFramebuffer(36160,null),null;var M$f=new Uint8Array(this._width*this._height*4);return M$e.readPixels(M$a,M$b,M$c,M$d,this._surfaceFormat,this._surfaceType,M$f),M$e.bindFramebuffer(36160,null),M$f},M$b.disposeResource=function(){if(this._frameBuffer){var M$a=M$F.mainContext;M$a.deleteTexture(this._source),M$a.deleteFramebuffer(this._frameBuffer),M$a.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},M$o(0,M$b,"surfaceFormat",function(){return this._surfaceFormat}),M$o(0,M$b,"surfaceType",function(){return this._surfaceType}),M$o(0,M$b,"depthStencilFormat",function(){return this._depthStencilFormat}),M$o(0,M$b,"source",function(){return this._alreadyResolved?M$v.superGet(M$Fb,this,"source"):null}),M$o(0,M$b,"depthStencilBuffer",function(){return this._depthStencilBuffer}),M$o(0,M$b,"frameBuffer",function(){return this._frameBuffer}),M$j._currentRenderTarget=null}(),function(M$a){function M$b(M$a){this._color=null,this._pixels=null,M$b.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new M$pb(this.width,this.height),this._color=M$a,this._pixels=new Uint8Array([255*M$a.x,255*M$a.y,255*M$a.z,255*M$a.w]),this.uri="SolidColorTexture2D_"+this.id}M$n(M$b,"laya.d3.resource.SolidColorTexture2D",M$Fb);var M$c=M$b.prototype;return M$c._createWebGlTexture=function(){var M$a=M$F.mainContext,M$b=this._source=M$a.createTexture(),M$c=this._width,M$d=this._height,M$e=M$G.curBindTexTarget,M$f=M$G.curBindTexValue;M$G.bindTexture(M$a,this._type,M$b),M$a.texImage2D(this._type,0,6408,M$c,M$d,0,6408,5121,this._pixels);var M$g=this._minFifter,M$h=this._magFifter,M$i=this._repeat?10497:33071,M$j=M$u.isPOT(M$c,M$d);M$j?(this._mipmap?-1!==M$g||(M$g=9987):-1!==M$g||(M$g=9729),-1!==M$h||(M$h=9729),M$a.texParameteri(this._type,10241,M$g),M$a.texParameteri(this._type,10240,M$h),M$a.texParameteri(this._type,10242,M$i),M$a.texParameteri(this._type,10243,M$i),this._mipmap&&M$a.generateMipmap(this._type)):(-1!==M$g||(M$g=9729),-1!==M$h||(M$h=9729),M$a.texParameteri(this._type,10241,M$g),M$a.texParameteri(this._type,10240,M$h),M$a.texParameteri(this._type,10242,33071),M$a.texParameteri(this._type,10243,33071)),M$e&&M$f&&M$G.bindTexture(M$a,M$e,M$f),this.memorySize=M$j?M$c*M$d*4*(1+1/3):M$c*M$d*4},M$c.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},M$c.disposeResource=function(){this._source&&(M$F.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},M$l(M$b,["magentaTexture",function(){var M$a=new M$b(new M$hb(1,0,1,1));return M$a.lock=!0,this.magentaTexture=M$a},"grayTexture",function(){var M$a=new M$b(new M$hb(.5,.5,.5,1));return M$a.lock=!0,this.grayTexture=M$a}]),M$b}()),M$Tb=function(M$a){function M$e(M$a,M$b,M$c,M$d){this._canRead=!1,this._image=null,this._pixels=null,void 0===M$a&&(M$a=!1),void 0===M$b&&(M$b=!0),void 0===M$c&&(M$c=6408),void 0===M$d&&(M$d=!0),M$e.__super.call(this),this._type=3553,this._repeat=M$b,this._canRead=M$a,this._format=M$c,this._mipmap=M$d}M$n(M$e,"laya.d3.resource.Texture2D",M$Fb);var M$b=M$e.prototype;return M$b._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var M$a=M$F.mainContext,M$b=this._source=M$a.createTexture(),M$c=this._width,M$d=this._height,M$e=M$G.curBindTexTarget,M$f=M$G.curBindTexValue;switch(M$G.bindTexture(M$a,this._type,M$b),this._format){case 6407:case 6408:this._canRead?M$a.texImage2D(this._type,0,this._format,M$c,M$d,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?M$a.texImage2D(this._type,0,this._image._format,M$c,M$d,0,this._image._format,5121,this._image.atlasSource):M$a.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case M$F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:M$a.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var M$g=this._minFifter,M$h=this._magFifter,M$i=this._repeat?10497:33071,M$j=0==this._wrapModeU?10497:33071,M$k=0==this._wrapModeV?10497:33071,M$l=M$u.isPOT(M$c,M$d);M$l?(this._mipmap?-1!==M$g||(M$g=9987):-1!==M$g||(M$g=9729),-1!==M$h||(M$h=9729),M$a.texParameteri(this._type,10241,M$g),M$a.texParameteri(this._type,10240,M$h),M$a.texParameteri(this._type,10242,M$i),M$a.texParameteri(this._type,10243,M$i),M$a.texParameteri(this._type,10242,M$j),M$a.texParameteri(this._type,10243,M$k),this._mipmap&&M$a.generateMipmap(this._type)):(-1!==M$g||(M$g=9729),-1!==M$h||(M$h=9729),M$a.texParameteri(this._type,10241,M$g),M$a.texParameteri(this._type,10240,M$h),M$a.texParameteri(this._type,10242,33071),M$a.texParameteri(this._type,10243,33071)),M$e&&M$f&&M$G.bindTexture(M$a,M$e,M$f),this._image.onload=null,this._image=null,this.memorySize=M$l?M$c*M$d*4*(1+1/3):M$c*M$d*4},M$b.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},M$b.onAsynLoaded=function(M$a,M$b,M$c){if(M$c){var M$d=M$c[0];void 0!==M$d&&(this._canRead=M$d);var M$e=M$c[1];void 0!==M$e&&(this._repeat=M$e);var M$f=M$c[2];void 0!==M$f&&(this._format=M$f);var M$g=M$c[3];void 0!==M$g&&(this._mipmap=M$g);var M$h=M$c.wrapModeU;void 0!==M$h&&(this._wrapModeU=M$h);var M$i=M$c.wrapModeV;void 0!==M$i&&(this._wrapModeV=M$i)}switch(this._format){case 6407:case 6408:var M$j=(this._image=M$b).width,M$k=M$b.height;this._width=M$j,this._height=M$k,this._size=new M$pb(M$j,M$k),this._canRead&&(M$p.isConchApp?M$b instanceof M$m.HTMLElement&&(this._pixels=new Uint8Array(M$b.getImageData(0,0,M$j,M$k))):(M$H.canvas.size(M$j,M$k),M$H.canvas.clear(),M$H.context.drawImage(M$b,0,0,M$j,M$k),this._pixels=new Uint8Array(M$H.context.getImageData(0,0,M$j,M$k).data.buffer)));break;case M$F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var M$l=new M$w(M$b);M$l.readUTFBytes(4),M$l.readUTFBytes(2),M$l.getInt16();M$l.endian="bigEndian",this._width=M$l.getInt16(),this._height=M$l.getInt16(),this._size=new M$pb(this._width,this._height);M$l.getInt16(),M$l.getInt16();this._image=new Uint8Array(M$b,M$l.pos)}this.recreateResource(),this._endLoaded()},M$b.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},M$b.disposeResource=function(){this._source&&(M$F.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},M$o(0,M$b,"_src",function(){return this.url}),M$o(0,M$b,"src",function(){return this.url}),M$e.load=function(M$a){return M$v.loader.create(M$a,null,null,M$e)},M$e}(),M$Ub=function(M$b){function M$c(M$a,M$b){M$c.__super.call(this),void 0===M$a&&(M$a=.3),void 0===M$b&&(M$b=1e3),this._tempVector3=new M$gb,this._position=new M$gb,this._up=new M$gb,this._forward=new M$gb,this._right=new M$gb,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=M$pb.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=M$a,this._farPlane=M$b,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),M$v.stage.on("resize",this,this._onScreenSizeChanged)}M$n(M$c,"laya.d3.core.BaseCamera",M$b);var M$a=M$c.prototype;return M$a._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var M$a=this.scene._cameraPool,M$b=M$a.length-1,M$c=0;M$c<M$b;M$c++)if(M$a[M$c].renderingOrder>M$a[M$b].renderingOrder){var M$d=M$a[M$c];M$a[M$c]=M$a[M$b],M$a[M$b]=M$d}},M$a._calculateProjectionMatrix=function(){},M$a._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},M$a._prepareCameraToRender=function(){M$I._currentCameraCullingMask=this.cullingMask;var M$a=this._shaderValues;M$a.setValue(0,this.transform.position.elements),M$a.setValue(5,this.forward.elements),M$a.setValue(6,this.up.elements)},M$a._prepareCameraViewProject=function(M$a,M$b){var M$c=this._shaderValues;M$c.setValue(1,M$a.elements),M$c.setValue(2,M$b.elements)},M$a._renderCamera=function(M$a,M$b,M$c){},M$a.addLayer=function(M$a){29!==M$a.number&&30!=M$a.number&&(this.cullingMask=this.cullingMask|M$a.mask)},M$a.removeLayer=function(M$a){29!==M$a.number&&30!=M$a.number&&(this.cullingMask=this.cullingMask&~M$a.mask)},M$a.addAllLayers=function(){this.cullingMask=2147483647},M$a.removeAllLayers=function(){this.cullingMask=0|M$I.getLayerByNumber(29).mask|M$I.getLayerByNumber(30).mask},M$a.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},M$a.moveForward=function(M$a){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=M$a,this.transform.translate(this._tempVector3)},M$a.moveRight=function(M$a){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=M$a,this.transform.translate(this._tempVector3)},M$a.moveVertical=function(M$a){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=M$a,this.transform.translate(this._tempVector3,!1)},M$a._addSelfRenderObjects=function(){var M$a=this.scene._cameraPool,M$b=M$a.length;if(0<M$b){for(var M$c=M$b-1;0<=M$c;M$c--)if(this.renderingOrder<=M$a[M$c].renderingOrder){M$a.splice(M$c+1,0,this);break}}else M$a.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},M$a._clearSelfRenderObjects=function(){var M$a=this.scene._cameraPool;M$a.splice(M$a.indexOf(this),1)},M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,M$v.stage.off("resize",this,this._onScreenSizeChanged),M$b.prototype.destroy.call(this,M$a)},M$o(0,M$a,"sky",function(){return this._sky},function(M$a){(this._sky=M$a)._ownerCamera=this}),M$o(0,M$a,"forward",function(){var M$a=this.transform.worldMatrix.elements,M$b=this._forward.elements;return M$b[0]=-M$a[8],M$b[1]=-M$a[9],M$b[2]=-M$a[10],this._forward}),M$o(0,M$a,"position",function(){var M$a=this.transform.worldMatrix.elements,M$b=this._position.elements;return M$b[0]=M$a[12],M$b[1]=M$a[13],M$b[2]=M$a[14],this._position}),M$o(0,M$a,"renderTarget",function(){return this._renderTarget},function(M$a){null!=(this._renderTarget=M$a)&&(this._renderTargetSize=M$a.size)}),M$o(0,M$a,"up",function(){var M$a=this.transform.worldMatrix.elements,M$b=this._up.elements;return M$b[0]=M$a[4],M$b[1]=M$a[5],M$b[2]=M$a[6],this._up}),M$o(0,M$a,"right",function(){var M$a=this.transform.worldMatrix.elements,M$b=this._right.elements;return M$b[0]=M$a[0],M$b[1]=M$a[1],M$b[2]=M$a[2],this._right}),M$o(0,M$a,"renderTargetSize",function(){return this._renderTargetSize},function(M$a){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=M$a,this._calculateProjectionMatrix()}),M$o(0,M$a,"fieldOfView",function(){return this._fieldOfView},function(M$a){this._fieldOfView=M$a,this._calculateProjectionMatrix()}),M$o(0,M$a,"nearPlane",function(){return this._nearPlane},function(M$a){this._nearPlane=M$a,this._calculateProjectionMatrix()}),M$o(0,M$a,"farPlane",function(){return this._farPlane},function(M$a){this._farPlane=M$a,this._calculateProjectionMatrix()}),M$o(0,M$a,"orthographic",function(){return this._orthographic},function(M$a){this._orthographic=M$a,this._calculateProjectionMatrix()}),M$o(0,M$a,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(M$a){this._orthographicVerticalSize=M$a,this._calculateProjectionMatrix()}),M$o(0,M$a,"renderingOrder",function(){return this._renderingOrder},function(M$a){this._renderingOrder=M$a,this._sortCamerasByRenderingOrder()}),M$c.CAMERAPOS=0,M$c.VIEWMATRIX=1,M$c.PROJECTMATRIX=2,M$c.VPMATRIX=3,M$c.VPMATRIX_NO_TRANSLATE=4,M$c.CAMERADIRECTION=5,M$c.CAMERAUP=6,M$c.ENVIRONMENTDIFFUSE=7,M$c.ENVIRONMENTSPECULAR=8,M$c.SIMLODINFO=9,M$c.DIFFUSEIRRADMATR=10,M$c.DIFFUSEIRRADMATG=11,M$c.DIFFUSEIRRADMATB=12,M$c.HDREXPOSURE=13,M$c.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",M$c.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",M$c.CLEARFLAG_SOLIDCOLOR=0,M$c.CLEARFLAG_SKY=1,M$c.CLEARFLAG_DEPTHONLY=2,M$c.CLEARFLAG_NONE=3,M$l(M$c,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new M$ab(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new M$ab},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new M$ab}]),M$c}(M$Kb),M$Vb=function(M$c){function M$b(M$a){this._render=null,this._geometryFilter=null,M$b.__super.call(this,M$a)}M$n(M$b,"laya.d3.core.RenderableSprite3D",M$c);var M$a=M$b.prototype;return M$a._addToInitStaticBatchManager=function(){},M$a._setBelongScene=function(M$a){M$c.prototype._setBelongScene.call(this,M$a),M$a._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},M$a._setUnBelongScene=function(){var M$a=this._scene._renderableSprite3Ds,M$b=M$a.indexOf(this);M$a.splice(M$b,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),M$c.prototype._setUnBelongScene.call(this)},M$a._update=function(M$a){(M$a.owner=this)._activeInHierarchy&&(this._updateComponents(M$a),this._render._updateOctreeNode(),this._lateUpdateComponents(M$a),M$A.spriteCount++,this._childs.length&&this._updateChilds(M$a))},M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),M$c.prototype.destroy.call(this,M$a),this._render._destroy(),this._render=null},M$b.__init__=function(){M$b.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=M$b.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),M$b.SAHDERDEFINE_LIGHTMAP=M$b.shaderDefines.registerDefine("LIGHTMAP")},M$b.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,M$b.SAHDERDEFINE_LIGHTMAP=4,M$b.LIGHTMAPSCALEOFFSET=2,M$b.LIGHTMAP=3,M$l(M$b,["shaderDefines",function(){return this.shaderDefines=new M$kb}]),M$b}(M$Kb),M$Wb=(function(M$a){function M$d(M$a,M$b,M$c){this._long=NaN,this._width=NaN,this._height=NaN,void 0===M$a&&(M$a=1),void 0===M$b&&(M$b=1),void 0===M$c&&(M$c=1),M$d.__super.call(this),this._long=M$a,this._width=M$b,this._height=M$c,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}M$n(M$d,"laya.d3.resource.models.BoxMesh",M$Qb);var M$b=M$d.prototype;M$b.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var M$a=M$Fa.vertexDeclaration,M$b=(M$a.vertexStride,this._long/2),M$c=this._height/2,M$d=this._width/2,M$e=new Float32Array([-M$b,M$c,-M$d,0,1,0,0,0,M$b,M$c,-M$d,0,1,0,1,0,M$b,M$c,M$d,0,1,0,1,1,-M$b,M$c,M$d,0,1,0,0,1,-M$b,-M$c,-M$d,0,-1,0,0,1,M$b,-M$c,-M$d,0,-1,0,1,1,M$b,-M$c,M$d,0,-1,0,1,0,-M$b,-M$c,M$d,0,-1,0,0,0,-M$b,M$c,-M$d,-1,0,0,0,0,-M$b,M$c,M$d,-1,0,0,1,0,-M$b,-M$c,M$d,-1,0,0,1,1,-M$b,-M$c,-M$d,-1,0,0,0,1,M$b,M$c,-M$d,1,0,0,1,0,M$b,M$c,M$d,1,0,0,0,0,M$b,-M$c,M$d,1,0,0,0,1,M$b,-M$c,-M$d,1,0,0,1,1,-M$b,M$c,M$d,0,0,1,0,0,M$b,M$c,M$d,0,0,1,1,0,M$b,-M$c,M$d,0,0,1,1,1,-M$b,-M$c,M$d,0,0,1,0,1,-M$b,M$c,-M$d,0,0,-1,1,0,M$b,M$c,-M$d,0,0,-1,0,0,M$b,-M$c,-M$d,0,0,-1,0,1,-M$b,-M$c,-M$d,0,0,-1,1,1]),M$f=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new M$Ob(M$a,this._numberVertices,35044,!0),this._indexBuffer=new M$Nb("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(M$e),this._indexBuffer.setData(M$f),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},M$o(0,M$b,"long",function(){return this._long},function(M$a){this._long!==M$a&&(this._long=M$a,this.releaseResource(),this.activeResource())}),M$o(0,M$b,"width",function(){return this._width},function(M$a){this._width!==M$a&&(this._width=M$a,this.releaseResource(),this.activeResource())}),M$o(0,M$b,"height",function(){return this._height},function(M$a){this._height!==M$a&&(this._height=M$a,this.releaseResource(),this.activeResource())})}(),function(M$a){function M$g(M$a,M$b,M$c){void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=.3),void 0===M$c&&(M$c=1e3),this._viewMatrix=new M$ab,this._projectionMatrix=new M$ab,this._projectionViewMatrix=new M$ab,this._viewport=new M$ib(0,0,0,0),this._normalizedViewport=new M$ib(0,0,1,1),this._aspectRatio=M$a,this._boundFrustumUpdate=!0,this._boundFrustum=new M$$a(M$ab.DEFAULT),M$g.__super.call(this,M$b,M$c),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}M$n(M$g,"laya.d3.core.Camera",M$Ub);var M$b=M$g.prototype;return M$b._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},M$b._parseCustomProps=function(M$a,M$b,M$c,M$d){var M$e=M$c.clearColor;this.clearColor=new M$hb(M$e[0],M$e[1],M$e[2],M$e[3]);var M$f=M$c.viewport;this.normalizedViewport=new M$ib(M$f[0],M$f[1],M$f[2],M$f[3])},M$b._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var M$a=this.orthographicVerticalSize*this.aspectRatio*.5,M$b=.5*this.orthographicVerticalSize;M$ab.createOrthoOffCenterRH(-M$a,M$a,-M$b,M$b,this.nearPlane,this.farPlane,this._projectionMatrix)}else M$ab.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},M$b._update=function(M$a){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,M$a)},M$b._renderCamera=function(M$a,M$b,M$c){var M$d,M$e;M$c.parallelSplitShadowMaps[0]&&M$c._renderShadowMap(M$a,M$b,this),(M$b.camera=this)._prepareCameraToRender(),M$c._preRenderUpdateComponents(M$b),M$d=M$b._viewMatrix=this.viewMatrix;var M$f=this._renderTarget;M$f?(M$f.start(),M$ab.multiply(M$Ub._invertYScaleMatrix,this._projectionMatrix,M$Ub._invertYProjectionMatrix),M$ab.multiply(M$Ub._invertYScaleMatrix,this.projectionViewMatrix,M$Ub._invertYProjectionViewMatrix),M$e=M$b._projectionMatrix=M$Ub._invertYProjectionMatrix,M$b._projectionViewMatrix=M$Ub._invertYProjectionViewMatrix):(M$e=M$b._projectionMatrix=this._projectionMatrix,M$b._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(M$d,M$e),M$b._viewport=this.viewport,M$c._preRenderScene(M$a,M$b,this.boundFrustum),M$c._clear(M$a,M$b),M$c._renderScene(M$a,M$b),M$c._postRenderUpdateComponents(M$b),M$f&&M$f.end()},M$b.viewportPointToRay=function(M$a,M$b){M$ob.calculateCursorRay(M$a,this.viewport,this._projectionMatrix,this.viewMatrix,null,M$b)},M$b.normalizedViewportPointToRay=function(M$a,M$b){var M$c=M$g._tempVector20,M$d=this.viewport,M$e=M$a.elements,M$f=M$c.elements;M$f[0]=M$e[0]*M$d.width,M$f[1]=M$e[1]*M$d.height,M$ob.calculateCursorRay(M$c,this.viewport,this._projectionMatrix,this.viewMatrix,null,M$b)},M$b.worldToViewportPoint=function(M$a,M$b){M$ab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(M$a,this._projectionViewMatrix,M$b);var M$c=M$b.elements;M$c[0]=M$c[0]/M$v.stage.clientScaleX,M$c[1]=M$c[1]/M$v.stage.clientScaleY},M$b.worldToNormalizedViewportPoint=function(M$a,M$b){M$ab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(M$a,this._projectionViewMatrix,M$b);var M$c=M$b.elements;M$c[0]=M$c[0]/M$v.stage.clientScaleX,M$c[1]=M$c[1]/M$v.stage.clientScaleY},M$b.convertScreenCoordToOrthographicCoord=function(M$a,M$b){if(this._orthographic){var M$c=M$Y.clientWidth,M$d=M$Y.clientHeight,M$e=this.orthographicVerticalSize*this.aspectRatio/M$c,M$f=this.orthographicVerticalSize/M$d,M$g=M$a.elements,M$h=M$b.elements;return M$h[0]=(-M$c/2+M$g[0])*M$e,M$h[1]=(M$d/2-M$g[1])*M$f,M$h[2]=(this.nearPlane-this.farPlane)*(M$g[2]+1)/2-this.nearPlane,M$gb.transformCoordinate(M$b,this.transform.worldMatrix,M$b),!0}return!1},M$o(0,M$b,"projectionViewMatrix",function(){return M$ab.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),M$o(0,M$b,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var M$a=this.viewport;return M$a.width/M$a.height},function(M$a){if(M$a<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=M$a,this._calculateProjectionMatrix()}),M$o(0,M$b,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),M$o(0,M$b,"needViewport",function(){var M$a=this.normalizedViewport;return 0===M$a.x&&0===M$a.y&&1===M$a.width&&1===M$a.height}),M$o(0,M$b,"viewport",function(){if(this._viewportExpressedInClipSpace){var M$a=this._normalizedViewport,M$b=this.renderTargetSize,M$c=M$b.width,M$d=M$b.height;this._viewport.x=M$a.x*M$c,this._viewport.y=M$a.y*M$d,this._viewport.width=M$a.width*M$c,this._viewport.height=M$a.height*M$d}return this._viewport},function(M$a){if(null!=this.renderTarget&&(M$a.x<0||M$a.y<0||0==M$a.width||0==M$a.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=M$a,this._calculateProjectionMatrix()}),M$o(0,M$b,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var M$a=this._viewport,M$b=this.renderTargetSize,M$c=M$b.width,M$d=M$b.height;this._normalizedViewport.x=M$a.x/M$c,this._normalizedViewport.y=M$a.y/M$d,this._normalizedViewport.width=M$a.width/M$c,this._normalizedViewport.height=M$a.height/M$d}return this._normalizedViewport},function(M$a){M$a.x<0&&(M$a.x=0,console.warn("Camera: viewport.x must large than 0.0.")),M$a.y<0&&(M$a.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<M$a.x+M$a.width&&(M$a.width=1-M$a.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<M$a.y+M$a.height&&(M$a.height=1-M$a.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=M$a,this._calculateProjectionMatrix()}),M$o(0,M$b,"projectionMatrix",function(){return this._projectionMatrix},function(M$a){this._projectionMatrix=M$a,this._useUserProjectionMatrix=!0}),M$o(0,M$b,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),M$l(M$g,["_tempVector20",function(){return this._tempVector20=new M$fb}]),M$g}()),M$Xb=function(M$c){function M$d(M$a,M$b){M$d.__super.call(this,M$b),this._geometryFilter=new M$Hb(this),this._render=new M$Ib(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),M$a&&(this._geometryFilter.sharedMesh=M$a)instanceof laya.d3.resource.models.Mesh&&(M$a.loaded?this._render.sharedMaterials=M$a.materials:M$a.once("loaded",this,this._applyMeshMaterials))}M$n(M$d,"laya.d3.core.MeshSprite3D",M$c);var M$a=M$d.prototype;return M$a._changeRenderObjectByMesh=function(M$a){var M$b=this._render._renderElements,M$c=M$b[M$a];M$c||(M$c=M$b[M$a]=new M$xb),M$c._render=this._render;var M$d=this._render.sharedMaterials[M$a];M$d||(M$d=M$Mb.defaultMaterial);var M$e=this._geometryFilter.sharedMesh.getRenderElement(M$a);return M$c._mainSortID=this._getSortID(M$e,M$d),M$c._sprite3D=this,M$c.renderObj=M$e,M$c._material=M$d,M$c},M$a._changeRenderObjectByMaterial=function(M$a,M$b){var M$c=this._render._renderElements[M$a];M$b||(M$b=M$Mb.defaultMaterial);var M$d=this._geometryFilter.sharedMesh.getRenderElement(M$a);return M$c._mainSortID=this._getSortID(M$d,M$b),M$c._sprite3D=this,M$c.renderObj=M$d,M$c._material=M$b,M$c},M$a._changeRenderObjectsByMesh=function(){var M$a=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=M$a;for(var M$b=0;M$b<M$a;M$b++)this._changeRenderObjectByMesh(M$b)},M$a._onMeshChanged=function(M$a){var M$b=M$a.sharedMesh;M$b.loaded?this._changeRenderObjectsByMesh():M$b.once("loaded",this,this._onMeshLoaded)},M$a._onMeshLoaded=function(M$a){M$a===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},M$a._onMaterialChanged=function(M$a,M$b,M$c){M$b<this._render._renderElements.length&&this._changeRenderObjectByMaterial(M$b,M$c)},M$a._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},M$a._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},M$a._parseCustomProps=function(M$a,M$b,M$c,M$d){var M$e=this.meshRender,M$f=M$c.lightmapIndex;null!=M$f&&(M$e.lightmapIndex=M$f);var M$g,M$h,M$i=M$c.lightmapScaleOffset;if(M$i&&(M$e.lightmapScaleOffset=new M$hb(M$i[0],M$i[1],M$i[2],M$i[3])),M$d.instanceParams)(M$g=M$d.instanceParams.loadPath)&&(M$h=M$r.getRes(M$b[M$g]),(this.meshFilter.sharedMesh=M$h).loaded?M$e.sharedMaterials=M$h.materials:M$h.once("loaded",this,this._applyMeshMaterials));else{(M$g=M$c.meshPath)&&(M$h=M$r.getRes(M$b[M$g]),this.meshFilter.sharedMesh=M$h);var M$j=M$c.materials;if(M$j){var M$k=M$e.sharedMaterials,M$l=M$j.length;M$k.length=M$l;for(var M$m=0;M$m<M$l;M$m++)M$k[M$m]=M$r.getRes(M$b[M$j[M$m].path]);M$e.sharedMaterials=M$k}}},M$a._applyMeshMaterials=function(M$a){for(var M$b=this._render.sharedMaterials,M$c=M$a.materials,M$d=0,M$e=M$c.length;M$d<M$e;M$d++)M$b[M$d]||(M$b[M$d]=M$c[M$d]);this._render.sharedMaterials=M$b},M$a._addToInitStaticBatchManager=function(){M$d._staticBatchManager._addInitBatchSprite(this)},M$a.cloneTo=function(M$a){var M$b=M$a;M$b._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var M$c=this._render,M$d=M$b._render;M$d.enable=M$c.enable,M$d.sharedMaterials=M$c.sharedMaterials,M$d.castShadow=M$c.castShadow;var M$e=M$c.lightmapScaleOffset;M$e&&(M$d.lightmapScaleOffset=M$e.clone()),M$d.lightmapIndex=M$c.lightmapIndex,M$d.receiveShadow=M$c.receiveShadow,M$d.sortingFudge=M$c.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,M$a)},M$a.destroy=function(M$a){if(void 0===M$a&&(M$a=!0),!this.destroyed){var M$b=this.meshFilter.sharedMesh;null!=M$b&&(M$b.loaded||M$b.off("loaded",this,this._applyMeshMaterials)),M$c.prototype.destroy.call(this,M$a),this._geometryFilter._destroy()}},M$o(0,M$a,"meshFilter",function(){return this._geometryFilter}),M$o(0,M$a,"meshRender",function(){return this._render}),M$d.__init__=function(){M$da._staticBatchManagers.push(M$d._staticBatchManager)},M$d.load=function(M$a){return M$v.loader.create(M$a,null,null,M$d)},M$l(M$d,["_staticBatchManager",function(){return this._staticBatchManager=new M$Bb}]),M$d}(M$Vb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(M$a,M$b){"use strict";for(var M$c in Object.defineProperty(M$b,"__esModule",{value:!0}),Laya){var M$d=Laya[M$c];M$d&&M$d.__isclass&&(M$b[M$c]=M$d)}}),function(M$a,M$b,M$ea){M$ea.un,M$ea.uns;var M$c=M$ea.static,M$d=M$ea.class,M$f=M$ea.getset,M$p=M$ea.__newvec,M$h=laya.maths.Bezier,M$l=laya.utils.Browser,M$Fa=laya.utils.Byte,M$e=(laya.events.Event,laya.events.EventDispatcher),M$g=laya.display.Graphics,M$i=(laya.resource.HTMLCanvas,laya.utils.Handler),M$j=laya.net.Loader,M$m=laya.maths.MathUtil,M$Ga=laya.maths.Matrix,M$q=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),M$k=(laya.renders.RenderContext,laya.resource.Resource),M$n=laya.utils.RunDriver,M$fa=laya.display.Sprite,M$o=laya.utils.Stat,M$Ha=laya.resource.Texture,M$r=(laya.net.URL,laya.utils.Utils),M$G=function(){function M$a(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return M$d(M$a,"laya.ani.AnimationContent"),M$a}(),M$H=function(){function M$a(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return M$d(M$a,"laya.ani.AnimationNodeContent"),M$a}(),M$t=function(){function M$a(){}return M$d(M$a,"laya.ani.AnimationParser01"),M$a.parse=function(M$a,M$b){var M$c=M$b.__getBuffer(),M$d=0,M$e=0,M$f=0,M$g=0,M$h=0,M$i=0,M$j=0,M$k=M$b.readUTFString();M$a._aniClassName=M$k;var M$l,M$m=M$b.readUTFString().split("\n"),M$n=M$b.getUint8(),M$o=M$b.getUint32(),M$p=M$b.getUint32();0<M$o&&(M$l=M$c.slice(M$o,M$p));var M$q=new M$Fa(M$l);for(0<M$p&&(M$a._publicExtData=M$c.slice(M$p,M$c.byteLength)),M$a._useParent=!!M$b.getUint8(),M$a._anis.length=M$n,M$d=0;M$d<M$n;M$d++){var M$r=M$a._anis[M$d]=new M$G;M$r.nodes=new Array;var M$s=M$r.name=M$m[M$b.getUint16()];M$a._aniMap[M$s]=M$d,M$r.bone3DMap={},M$r.playTime=M$b.getFloat32(),M$r.playTime<=0&&console.error("播放时间不能为0  url="+M$a.url+" name="+M$r.name);var M$t=M$r.nodes.length=M$b.getUint8();for(M$e=M$r.totalKeyframeDatasLength=0;M$e<M$t;M$e++){var M$u=M$r.nodes[M$e]=new M$H;M$u.childs=[];var M$v=M$b.getInt16();0<=M$v&&(M$u.name=M$m[M$v],M$r.bone3DMap[M$u.name]=M$e),M$u.keyFrame=new Array,M$u.parentIndex=M$b.getInt16(),-1==M$u.parentIndex?M$u.parent=null:M$u.parent=M$r.nodes[M$u.parentIndex],M$u.lerpType=M$b.getUint8();var M$w=M$b.getUint32();M$q.pos=M$w;var M$x=M$u.keyframeWidth=M$q.getUint16();if(M$r.totalKeyframeDatasLength+=M$x,0===M$u.lerpType||1===M$u.lerpType)for(M$u.interpolationMethod=[],M$u.interpolationMethod.length=M$x,M$f=0;M$f<M$x;M$f++)M$u.interpolationMethod[M$f]=M$K.interpolation[M$q.getUint8()];null!=M$u.parent&&M$u.parent.childs.push(M$u);var M$A=M$b.getUint16();0<M$A&&(M$u.extenData=M$c.slice(M$b.pos,M$b.pos+M$A),M$b.pos+=M$A);var M$B,M$C=M$b.getUint16(),M$D=0;for(M$f=0,M$g=M$u.keyFrame.length=M$C;M$f<M$g;M$f++){if((M$B=M$u.keyFrame[M$f]=new M$I).duration=M$b.getFloat32(),M$B.startTime=M$D,2===M$u.lerpType){M$B.interpolationData=[];var M$E,M$F=M$b.getUint8();switch(M$E=M$b.getFloat32()){case 254:for(M$B.interpolationData.length=M$x,M$j=0;M$j<M$x;M$j++)M$B.interpolationData[M$j]=0;break;case 255:for(M$B.interpolationData.length=M$x,M$j=0;M$j<M$x;M$j++)M$B.interpolationData[M$j]=5;break;default:for(M$B.interpolationData.push(M$E),M$i=1;M$i<M$F;M$i++)M$B.interpolationData.push(M$b.getFloat32())}}for(M$B.data=new Float32Array(M$x),M$h=0;M$h<M$x;M$h++)M$B.data[M$h]=M$b.getFloat32(),-1e-8<M$B.data[M$h]&&M$B.data[M$h]<1e-8&&(M$B.data[M$h]=0);M$D+=M$B.duration}M$B.startTime=M$r.playTime,M$u.playTime=M$r.playTime,M$a._calculateKeyFrame(M$u,M$C,M$x)}}},M$a}(),M$u=function(){function M$v(){}return M$d(M$v,"laya.ani.AnimationParser02"),M$v.READ_DATA=function(){M$v._DATA.offset=M$v._reader.getUint32(),M$v._DATA.size=M$v._reader.getUint32()},M$v.READ_BLOCK=function(){for(var M$a=M$v._BLOCK.count=M$v._reader.getUint16(),M$b=M$v._BLOCK.blockStarts=[],M$c=M$v._BLOCK.blockLengths=[],M$d=0;M$d<M$a;M$d++)M$b.push(M$v._reader.getUint32()),M$c.push(M$v._reader.getUint32())},M$v.READ_STRINGS=function(){var M$a=M$v._reader.getUint32(),M$b=M$v._reader.getUint16(),M$c=M$v._reader.pos;M$v._reader.pos=M$a+M$v._DATA.offset;for(var M$d=0;M$d<M$b;M$d++)M$v._strings[M$d]=M$v._reader.readUTFString();M$v._reader.pos=M$c},M$v.parse=function(M$a,M$b){M$v._templet=M$a;(M$v._reader=M$b).__getBuffer();M$v.READ_DATA(),M$v.READ_BLOCK(),M$v.READ_STRINGS();for(var M$c=0,M$d=M$v._BLOCK.count;M$c<M$d;M$c++){var M$e=M$b.getUint16(),M$f=M$v._strings[M$e],M$g=M$v["READ_"+M$f];if(null==M$g)throw new Error("model file err,no this function:"+M$e+" "+M$f);M$g.call()}},M$v.READ_ANIMATIONS=function(){var M$a=M$v._reader,M$b=M$a.__getBuffer(),M$c=0,M$d=0,M$e=0,M$f=0,M$g=M$a.getUint16(),M$h=[];for(M$h.length=M$g,M$c=0;M$c<M$g;M$c++)M$h[M$c]=M$K.interpolation[M$a.getByte()];var M$i=M$a.getUint8();for(M$v._templet._anis.length=M$i,M$c=0;M$c<M$i;M$c++){var M$j=M$v._templet._anis[M$c]={};M$j.nodes=new Array;var M$k=M$j.name=M$v._strings[M$a.getUint16()];M$v._templet._aniMap[M$k]=M$c,M$j.bone3DMap={},M$j.playTime=M$a.getFloat32();var M$l=M$j.nodes.length=M$a.getInt16();for(M$d=M$j.totalKeyframeDatasLength=0;M$d<M$l;M$d++){var M$m=M$j.nodes[M$d]={};M$m.keyframeWidth=M$g,M$m.childs=[];var M$n=M$a.getUint16();0<=M$n&&(M$m.name=M$v._strings[M$n],M$j.bone3DMap[M$m.name]=M$d),M$m.keyFrame=new Array,M$m.parentIndex=M$a.getInt16(),-1==M$m.parentIndex?M$m.parent=null:M$m.parent=M$j.nodes[M$m.parentIndex],M$j.totalKeyframeDatasLength+=M$g,M$m.interpolationMethod=M$h,null!=M$m.parent&&M$m.parent.childs.push(M$m);var M$o=M$a.getUint16(),M$p=null,M$q=null;for(M$e=0,M$f=M$m.keyFrame.length=M$o;M$e<M$f;M$e++){(M$p=M$m.keyFrame[M$e]={}).startTime=M$a.getFloat32(),M$q&&(M$q.duration=M$p.startTime-M$q.startTime);var M$r=M$v._DATA.offset,M$s=M$a.getUint32(),M$t=4*M$g,M$u=M$b.slice(M$r+M$s,M$r+M$s+M$t);M$p.data=new Float32Array(M$u),M$q=M$p}M$p.duration=0,M$m.playTime=M$j.playTime,M$v._templet._calculateKeyFrame(M$m,M$o,M$g)}}},M$v._templet=null,M$v._reader=null,M$v._strings=[],M$c(M$v,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),M$v}(),M$Ia=(function(){function M$a(){}M$d(M$a,"laya.ani.AnimationState"),M$a.stopped=0,M$a.paused=1,M$a.playing=2}(),function(){function M$e(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new M$Va,this.resultMatrix=new M$Ga,this._children=[]}M$d(M$e,"laya.ani.bone.Bone");var M$a=M$e.prototype;return M$a.setTempMatrix=function(M$a){this._tempMatrix=M$a;var M$b,M$c=0;for(M$c=0,M$b=this._children.length;M$c<M$b;M$c++)this._children[M$c].setTempMatrix(this._tempMatrix)},M$a.update=function(M$a){var M$b;if(this.rotation=this.transform.skX,M$a)M$b=this.resultTransform.getMatrix(),M$Ga.mul(M$b,M$a,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)M$b=this.resultTransform.getMatrix(),M$Ga.mul(M$b,this.parentBone.resultMatrix,this.resultMatrix);else{var M$c=this.parentBone,M$d=NaN,M$e=NaN,M$f=NaN,M$g=this.parentBone.resultMatrix;M$b=this.resultTransform.getMatrix();var M$h=M$g.a*M$b.tx+M$g.c*M$b.ty+M$g.tx,M$i=M$g.b*M$b.tx+M$g.d*M$b.ty+M$g.ty,M$j=new M$Ga;this.inheritRotation?(M$d=Math.atan2(M$c.resultMatrix.b,M$c.resultMatrix.a),M$e=Math.cos(M$d),M$f=Math.sin(M$d),M$j.setTo(M$e,M$f,-M$f,M$e,0,0),M$Ga.mul(this._tempMatrix,M$j,M$Ga.TEMP),M$Ga.TEMP.copyTo(M$j),M$b=this.resultTransform.getMatrix(),M$Ga.mul(M$b,M$j,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,M$b=this.resultTransform.getMatrix(),M$Ga.TEMP.identity(),M$Ga.TEMP.d=this.d,M$Ga.mul(M$b,M$Ga.TEMP,this.resultMatrix)),this.resultMatrix.tx=M$h,this.resultMatrix.ty=M$i}else(M$b=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var M$k,M$l=0;for(M$l=0,M$k=this._children.length;M$l<M$k;M$l++)this._children[M$l].update()},M$a.updateChild=function(){var M$a,M$b=0;for(M$b=0,M$a=this._children.length;M$b<M$a;M$b++)this._children[M$b].update()},M$a.setRotation=function(M$a){this._sprite&&(this._sprite.rotation=180*M$a/Math.PI)},M$a.updateDraw=function(M$a,M$b){M$e.ShowBones&&!M$e.ShowBones[this.name]||(this._sprite||(this._sprite=new M$fa,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),M$ea.stage.addChild(this._sprite)),this._sprite.x=M$a+this.resultMatrix.tx,this._sprite.y=M$b+this.resultMatrix.ty);var M$c,M$d=0;for(M$d=0,M$c=this._children.length;M$d<M$c;M$d++)this._children[M$d].updateDraw(M$a,M$b)},M$a.addChild=function(M$a){this._children.push(M$a),M$a.parentBone=this},M$a.findBone=function(M$a){if(this.name==M$a)return this;var M$b,M$c,M$d=0;for(M$d=0,M$b=this._children.length;M$d<M$b;M$d++)if(M$c=this._children[M$d].findBone(M$a))return M$c;return null},M$a.localToWorld=function(M$a){var M$b=M$a[0],M$c=M$a[1];M$a[0]=M$b*this.resultMatrix.a+M$c*this.resultMatrix.c+this.resultMatrix.tx,M$a[1]=M$b*this.resultMatrix.b+M$c*this.resultMatrix.d+this.resultMatrix.ty},M$e.ShowBones={},M$e}()),M$Ja=function(){function M$p(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}M$d(M$p,"laya.ani.bone.BoneSlot");var M$a=M$p.prototype;return M$a.showSlotData=function(M$a,M$b){void 0===M$b&&(M$b=!0),this.currSlotData=M$a,M$b&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},M$a.showDisplayByName=function(M$a){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(M$a))},M$a.replaceDisplayByName=function(M$a,M$b){if(this.currSlotData){var M$c;M$c=this.currSlotData.getDisplayByName(M$a);var M$d;M$d=this.currSlotData.getDisplayByName(M$b),this.replaceDisplayByIndex(M$c,M$d)}},M$a.replaceDisplayByIndex=function(M$a,M$b){this.currSlotData&&(this._replaceDic[M$a]=M$b,this.displayIndex==M$a&&this.showDisplayByIndex(M$a))},M$a.showDisplayByIndex=function(M$a){if(null!=this._replaceDic[M$a]&&(M$a=this._replaceDic[M$a]),this.currSlotData&&-1<M$a&&M$a<this.currSlotData.displayArr.length){if(this.displayIndex=M$a,this.currDisplayData=this.currSlotData.displayArr[M$a],this.currDisplayData){var M$b=this.currDisplayData.name;this.currTexture=this.templet.getTexture(M$b),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!M$q.isConchApp||M$q.isConchApp&&"0.9.15"<M$fa.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},M$a.replaceSkin=function(M$a){this._diyTexture=M$a,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},M$a.setParentMatrix=function(M$a){this._parentMatrix=M$a},M$a.draw=function(M$a,M$b,M$c,M$d){if(void 0===M$c&&(M$c=!1),void 0===M$d&&(M$d=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var M$e,M$f=this.currTexture;switch(this._diyTexture&&(M$f=this._diyTexture),this.currDisplayData.type){case 0:if(M$a){var M$g=this.getDisplayMatrix();if(this._parentMatrix){var M$h=!1;if(M$g){var M$i;if(M$Ga.mul(M$g,this._parentMatrix,M$Ga.TEMP),M$i=M$c?(null==this._resultMatrix&&(this._resultMatrix=new M$Ga),this._resultMatrix):new M$Ga,!M$q.isWebGL&&this.currDisplayData.uvs||M$q.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var M$j=M$p._tempMatrix;M$j.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(M$j.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(M$h=!0,M$j.rotate(-Math.PI/2)),M$Ga.mul(M$j,M$Ga.TEMP,M$i)}else M$Ga.TEMP.copyTo(M$i);M$h?M$a.drawTexture(M$f,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,M$i):M$a.drawTexture(M$f,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,M$i)}}}break;case 1:if(null==(M$e=M$c?(null==this._skinSprite&&(this._skinSprite=M$p.createSkinMesh()),this._skinSprite):M$p.createSkinMesh()))return;var M$k;if(null==this.currDisplayData.bones){var M$l,M$m=this.currDisplayData.weights;this.deformData&&(M$m=this.deformData),M$l=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=M$x.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=M$x.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=M$m;this.currDisplayData.triangles.length;M$k=this.currDisplayData.triangles,M$e.init2(M$f,null,M$k,this._mVerticleArr,M$l);var M$n,M$o=this.getDisplayMatrix();if(this._parentMatrix)if(M$o)M$Ga.mul(M$o,this._parentMatrix,M$Ga.TEMP),M$n=M$c?(null==this._resultMatrix&&(this._resultMatrix=new M$Ga),this._resultMatrix):new M$Ga,M$Ga.TEMP.copyTo(M$n),M$e.transform=M$n}else this.skinMesh(M$b,M$e,M$d);M$a.drawSkin(M$e);break;case 2:if(null==(M$e=M$c?(null==this._skinSprite&&(this._skinSprite=M$p.createSkinMesh()),this._skinSprite):M$p.createSkinMesh()))return;this.skinMesh(M$b,M$e,M$d),M$a.drawSkin(M$e)}}},M$a.skinMesh=function(M$a,M$b,M$c){var M$d,M$e=this.currTexture,M$f=this.currDisplayData.bones;M$d=this._diyTexture?(M$e=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=M$x.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=M$x.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var M$g,M$h,M$i=this.currDisplayData.weights,M$j=this.currDisplayData.triangles,M$k=0,M$l=0,M$m=0,M$n=NaN,M$o=NaN,M$p=0,M$q=0,M$r=[],M$s=0,M$t=0;if(this.deformData&&0<this.deformData.length){var M$u=0;for(M$s=0,M$t=M$f.length;M$s<M$t;){for(M$m=M$f[M$s++]+M$s,M$l=M$k=0;M$s<M$m;M$s++)M$h=M$a[M$f[M$s]],M$n=M$i[M$p]+this.deformData[M$u++],M$o=M$i[M$p+1]+this.deformData[M$u++],M$q=M$i[M$p+2],M$k+=(M$n*M$h.a+M$o*M$h.c+M$h.tx)*M$q,M$l+=(M$n*M$h.b+M$o*M$h.d+M$h.ty)*M$q,M$p+=3;M$r.push(M$k,M$l)}}else for(M$s=0,M$t=M$f.length;M$s<M$t;){for(M$m=M$f[M$s++]+M$s,M$l=M$k=0;M$s<M$m;M$s++)M$h=M$a[M$f[M$s]],M$n=M$i[M$p],M$o=M$i[M$p+1],M$q=M$i[M$p+2],M$k+=(M$n*M$h.a+M$o*M$h.c+M$h.tx)*M$q,M$l+=(M$n*M$h.b+M$o*M$h.d+M$h.ty)*M$q,M$p+=3;M$r.push(M$k,M$l)}this._mVerticleArr=M$r,M$g=M$j,M$b.init2(M$e,null,M$g,this._mVerticleArr,M$d)},M$a.drawBonePoint=function(M$a){M$a&&this._parentMatrix&&M$a.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},M$a.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},M$a.getMatrix=function(){return this._resultMatrix},M$a.copy=function(){var M$a=new M$p;return M$a.type="copy",M$a.name=this.name,M$a.attachmentName=this.attachmentName,M$a.srcDisplayIndex=this.srcDisplayIndex,M$a.parent=this.parent,M$a.displayIndex=this.displayIndex,M$a.templet=this.templet,M$a.currSlotData=this.currSlotData,M$a.currTexture=this.currTexture,M$a.currDisplayData=this.currDisplayData,M$a},M$p.createSkinMesh=function(){return M$q.isWebGL||M$q.isConchApp?M$n.skinAniSprite():(M$q.isWebGL,null)},M$c(M$p,["_tempMatrix",function(){return this._tempMatrix=new M$Ga}]),M$p}(),M$Ka=function(){function M$a(){this.skinName=null,this.deformSlotDataList=[]}return M$d(M$a,"laya.ani.bone.DeformAniData"),M$a}(),M$La=function(){function M$a(){this.deformSlotDisplayList=[]}return M$d(M$a,"laya.ani.bone.DeformSlotData"),M$a}(),M$Ma=function(){function M$a(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}M$d(M$a,"laya.ani.bone.DeformSlotDisplayData");var M$b=M$a.prototype;return M$b.binarySearch1=function(M$a,M$b){var M$c=0,M$d=M$a.length-2;if(0==M$d)return 1;for(var M$e=M$d>>>1;;){if(M$a[Math.floor(M$e+1)]<=M$b?M$c=M$e+1:M$d=M$e,M$c==M$d)return M$c+1;M$e=M$c+M$d>>>1}return 0},M$b.apply=function(M$a,M$b,M$c){if(void 0===M$c&&(M$c=1),M$a+=.05,!(this.timeList.length<=0)){var M$d=0;if(!(M$a<this.timeList[0])){var M$e=this.vectices[0].length,M$f=[],M$g=this.binarySearch1(this.timeList,M$a);if(this.frameIndex=M$g,M$a>=this.timeList[this.timeList.length-1]){var M$h=this.vectices[this.vectices.length-1];if(M$c<1)for(M$d=0;M$d<M$e;M$d++)M$f[M$d]+=(M$h[M$d]-M$f[M$d])*M$c;else for(M$d=0;M$d<M$e;M$d++)M$f[M$d]=M$h[M$d];this.deformData=M$f}else{this.tweenKeyList[this.frameIndex];var M$i=this.vectices[this.frameIndex-1],M$j=this.vectices[this.frameIndex],M$k=this.timeList[this.frameIndex-1],M$l=this.timeList[this.frameIndex];M$c=this.tweenKeyList[M$g-1]?(M$a-M$k)/(M$l-M$k):0;var M$m=NaN;for(M$d=0;M$d<M$e;M$d++)M$m=M$i[M$d],M$f[M$d]=M$m+(M$j[M$d]-M$m)*M$c;this.deformData=M$f}}}},M$a}(),M$Na=function(){function M$a(){this.time=NaN,this.drawOrder=[]}return M$d(M$a,"laya.ani.bone.DrawOrderData"),M$a}(),M$Oa=function(){function M$a(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return M$d(M$a,"laya.ani.bone.EventData"),M$a}(),M$s=function(){function M$da(M$a,M$b){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=M$a,this._targetBone=M$b[M$a.targetBoneIndex],this.isSpine=M$a.isSpine,null==this._bones&&(this._bones=[]);for(var M$c=this._bones.length=0,M$d=M$a.boneIndexs.length;M$c<M$d;M$c++)this._bones.push(M$b[M$a.boneIndexs[M$c]]);this.name=M$a.name,this.mix=M$a.mix,this.bendDirection=M$a.bendDirection}M$d(M$da,"laya.ani.bone.IkConstraint");var M$a=M$da.prototype;return M$a.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},M$a._applyIk1=function(M$a,M$b,M$c,M$d){var M$e=M$a.parentBone,M$f=1/(M$e.resultMatrix.a*M$e.resultMatrix.d-M$e.resultMatrix.b*M$e.resultMatrix.c),M$g=M$b-M$e.resultMatrix.tx,M$h=M$c-M$e.resultMatrix.ty,M$i=(M$g*M$e.resultMatrix.d-M$h*M$e.resultMatrix.c)*M$f-M$a.transform.x,M$j=(M$h*M$e.resultMatrix.a-M$g*M$e.resultMatrix.b)*M$f-M$a.transform.y,M$k=Math.atan2(M$j,M$i)*M$da.radDeg-0-M$a.transform.skX;M$a.transform.scX<0&&(M$k+=180),180<M$k?M$k-=360:M$k<-180&&(M$k+=360),M$a.transform.skX=M$a.transform.skY=M$a.transform.skX+M$k*M$d,M$a.update()},M$a.updatePos=function(M$a,M$b){this._sp&&this._sp.pos(M$a,M$b)},M$a._applyIk2=function(M$a,M$b,M$c,M$d,M$e,M$f){if(0!=M$f){var M$g=M$a.resultTransform.x,M$h=M$a.resultTransform.y,M$i=M$a.transform.scX,M$j=M$a.transform.scY,M$k=M$b.transform.scX,M$l=0,M$m=0,M$n=0;M$n=M$i<0?(M$i=-M$i,M$l=180,-1):(M$l=0,1),M$j<0&&(M$j=-M$j,M$n=-M$n),M$m=M$k<0?(M$k=-M$k,180):0;var M$o=M$b.resultTransform.x,M$p=NaN,M$q=NaN,M$r=NaN,M$s=M$a.resultMatrix.a,M$t=M$a.resultMatrix.c,M$u=M$a.resultMatrix.b,M$v=M$a.resultMatrix.d,M$w=Math.abs(M$i-M$j)<=1e-4;M$r=M$w?(M$q=M$s*M$o+M$t*(M$p=M$b.resultTransform.y)+M$a.resultMatrix.tx,M$u*M$o+M$v*M$p+M$a.resultMatrix.ty):(M$p=0,M$q=M$s*M$o+M$a.resultMatrix.tx,M$u*M$o+M$a.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new M$fa,M$ea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(M$c,M$d,15,"#ffff00"),this._sp.graphics.drawCircle(M$q,M$r,15,"#ff00ff")),M$a.setRotation(Math.atan2(M$r-M$a.resultMatrix.ty,M$q-M$a.resultMatrix.tx));var M$x=M$a.parentBone;M$s=M$x.resultMatrix.a,M$t=M$x.resultMatrix.c,M$u=M$x.resultMatrix.b;var M$A=1/(M$s*(M$v=M$x.resultMatrix.d)-M$t*M$u),M$B=M$c-M$x.resultMatrix.tx,M$C=M$d-M$x.resultMatrix.ty,M$D=(M$B*M$v-M$C*M$t)*M$A-M$g,M$E=(M$C*M$s-M$B*M$u)*M$A-M$h,M$F=((M$B=M$q-M$x.resultMatrix.tx)*M$v-(M$C=M$r-M$x.resultMatrix.ty)*M$t)*M$A-M$g,M$G=(M$C*M$s-M$B*M$u)*M$A-M$h,M$H=Math.sqrt(M$F*M$F+M$G*M$G),M$I=M$b.length*M$k,M$J=NaN,M$K=NaN;if(M$w){var M$L=(M$D*M$D+M$E*M$E-M$H*M$H-(M$I*=M$i)*M$I)/(2*M$H*M$I);M$L<-1?M$L=-1:1<M$L&&(M$L=1),M$K=Math.acos(M$L)*M$e,M$s=M$H+M$I*M$L,M$t=M$I*Math.sin(M$K),M$J=Math.atan2(M$E*M$s-M$D*M$t,M$D*M$s+M$E*M$t)}else{var M$M=(M$s=M$i*M$I)*M$s,M$N=(M$t=M$j*M$I)*M$t,M$O=M$D*M$D+M$E*M$E,M$P=Math.atan2(M$E,M$D),M$Q=-2*M$N*M$H,M$R=M$N-M$M;if(0<(M$v=M$Q*M$Q-4*M$R*(M$u=M$N*M$H*M$H+M$M*M$O-M$M*M$N))){var M$S=Math.sqrt(M$v);M$Q<0&&(M$S=-M$S);var M$T=(M$S=-(M$Q+M$S)/2)/M$R,M$U=M$u/M$S,M$V=Math.abs(M$T)<Math.abs(M$U)?M$T:M$U;M$V*M$V<=M$O&&(M$C=Math.sqrt(M$O-M$V*M$V)*M$e,M$J=M$P-Math.atan2(M$C,M$V),M$K=Math.atan2(M$C/M$j,(M$V-M$H)/M$i))}var M$W=0,M$X=Number.MAX_VALUE,M$Y=0,M$Z=0,M$$=0,M$_=0,M$y=0,M$z=0;M$_<(M$v=(M$B=M$H+M$s)*M$B)&&(M$$=0,M$_=M$v,M$y=M$B),(M$v=(M$B=M$H-M$s)*M$B)<M$X&&(M$W=Math.PI,M$X=M$v,M$Y=M$B);var M$aa=Math.acos(-M$s*M$H/(M$M-M$N));(M$v=(M$B=M$s*Math.cos(M$aa)+M$H)*M$B+(M$C=M$t*Math.sin(M$aa))*M$C)<M$X&&(M$W=M$aa,M$X=M$v,M$Y=M$B,M$Z=M$C),M$_<M$v&&(M$$=M$aa,M$_=M$v,M$y=M$B,M$z=M$C),M$K=M$O<=(M$X+M$_)/2?(M$J=M$P-Math.atan2(M$Z*M$e,M$Y),M$W*M$e):(M$J=M$P-Math.atan2(M$z*M$e,M$y),M$$*M$e)}var M$ba=Math.atan2(M$p,M$o)*M$n,M$ca=M$a.resultTransform.skX;180<(M$J=(M$J-M$ba)*M$da.radDeg+M$l-M$ca)?M$J-=360:M$J<-180&&(M$J+=360),M$a.resultTransform.x=M$g,M$a.resultTransform.y=M$h,M$a.resultTransform.skX=M$a.resultTransform.skY=M$ca+M$J*M$f,M$ca=M$b.resultTransform.skX,180<(M$K=((M$K+M$ba)*M$da.radDeg-0)*M$n+M$m-(M$ca%=360))?M$K-=360:M$K<-180&&(M$K+=360),M$b.resultTransform.x=M$o,M$b.resultTransform.y=M$p,M$b.resultTransform.skX=M$b.resultTransform.skY=M$b.resultTransform.skY+M$K*M$f,M$a.update()}},M$a._applyIk3=function(M$a,M$b,M$c,M$d,M$e,M$f){if(0!=M$f){var M$g,M$h,M$i=M$b.resultMatrix.a*M$b.length,M$j=M$b.resultMatrix.b*M$b.length,M$k=M$i*M$i+M$j*M$j,M$l=Math.sqrt(M$k),M$m=M$a.resultMatrix.tx,M$n=M$a.resultMatrix.ty,M$o=M$b.resultMatrix.tx,M$p=M$b.resultMatrix.ty,M$q=M$o-M$m,M$r=M$p-M$n,M$s=M$q*M$q+M$r*M$r,M$t=Math.sqrt(M$s),M$u=(M$q=M$c-M$a.resultMatrix.tx)*M$q+(M$r=M$d-M$a.resultMatrix.ty)*M$r,M$v=Math.sqrt(M$u);if(M$l+M$t<=M$v||M$v+M$l<=M$t||M$v+M$t<=M$l){var M$w=NaN;M$o=M$m+(M$w=M$l+M$t<=M$v?1:-1)*(M$c-M$m)*M$t/M$v,M$p=M$n+M$w*(M$d-M$n)*M$t/M$v}else{var M$x=(M$s-M$k+M$u)/(2*M$u),M$A=Math.sqrt(M$s-M$x*M$x*M$u)/M$v,M$B=M$m+M$q*M$x,M$C=M$n+M$r*M$x,M$D=-M$r*M$A,M$E=M$q*M$A;M$p=0<M$e?(M$o=M$B-M$D,M$C-M$E):(M$o=M$B+M$D,M$C+M$E)}M$g=M$o,M$h=M$p,this.isDebug&&(this._sp||(this._sp=new M$fa,M$ea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(M$m,M$n,15,"#ff00ff"),this._sp.graphics.drawCircle(M$c,M$d,15,"#ffff00"),this._sp.graphics.drawCircle(M$g,M$h,15,"#ff00ff"));var M$F,M$G;M$F=Math.atan2(M$h-M$a.resultMatrix.ty,M$g-M$a.resultMatrix.tx),M$a.setRotation(M$F),(M$G=M$da._tempMatrix).identity(),M$G.rotate(M$F),M$G.scale(M$a.resultMatrix.getScaleX(),M$a.resultMatrix.getScaleY()),M$G.translate(M$a.resultMatrix.tx,M$a.resultMatrix.ty),M$G.copyTo(M$a.resultMatrix),M$a.updateChild();var M$H,M$I;M$H=Math.atan2(M$d-M$h,M$c-M$g),M$b.setRotation(M$H),(M$I=M$da._tempMatrix).identity(),M$I.rotate(M$H),M$I.scale(M$b.resultMatrix.getScaleX(),M$b.resultMatrix.getScaleY()),M$I.translate(M$g,M$h),M$G.copyTo(M$b.resultMatrix),M$b.updateChild()}},M$c(M$da,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new M$Ga}]),M$da}(),M$Pa=function(){function M$a(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return M$d(M$a,"laya.ani.bone.IkConstraintData"),M$a}(),M$v=function(){function M$I(M$a,M$b){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=M$a,this.position=M$a.position,this.spacing=M$a.spacing,this.rotateMix=M$a.rotateMix,this.translateMix=M$a.translateMix,this.bones=[];for(var M$c=this.data.bones,M$d=0,M$e=M$c.length;M$d<M$e;M$d++)this.bones.push(M$b[M$c[M$d]])}M$d(M$I,"laya.ani.bone.PathConstraint");var M$a=M$I.prototype;return M$a.apply=function(M$a,M$b){if(this.target){var M$c=this.translateMix,M$d=this.translateMix,M$e=0<M$d,M$f=this.data.spacingMode,M$g="length"==M$f,M$h=this.data.rotateMode,M$i="tangent"==M$h,M$j="chainScale"==M$h,M$k=[],M$l=this.bones.length,M$m=M$i?M$l:M$l+1,M$n=[];(this._spaces=M$n)[0]=this.position;var M$o=this.spacing;if(M$j||M$g)for(var M$p=0,M$q=M$m-1;M$p<M$q;){var M$r=this.bones[M$p],M$s=M$r.length,M$t=M$s*M$r.resultMatrix.a,M$u=M$s*M$r.resultMatrix.b;M$s=Math.sqrt(M$t*M$t+M$u*M$u),M$j&&(M$k[M$p]=M$s),M$n[++M$p]=M$g?Math.max(0,M$s+M$o):M$o}else for(M$p=1;M$p<M$m;M$p++)M$n[M$p]=M$o;var M$v=this.computeWorldPositions(this.target,M$a,M$b,M$m,M$i,"percent"==this.data.positionMode,"percent"==M$f);if(this._debugKey){for(M$p=0;M$p<M$v.length;M$p++)M$b.drawCircle(M$v[M$p++],M$v[M$p++],5,"#00ff00");var M$w=[];for(M$p=0;M$p<M$v.length;M$p++)M$w.push(M$v[M$p++],M$v[M$p++]);M$b.drawLines(0,0,M$w,"#ff0000")}var M$x=M$v[0],M$A=M$v[1],M$B=this.data.offsetRotation,M$C="chain"==M$h&&0==M$B,M$D=NaN;for(M$p=0,M$D=3;M$p<M$l;M$p++,M$D+=3){(M$r=this.bones[M$p]).resultMatrix.tx+=(M$x-M$r.resultMatrix.tx)*M$c,M$r.resultMatrix.ty+=(M$A-M$r.resultMatrix.ty)*M$c;var M$E=(M$t=M$v[M$D])-M$x,M$F=(M$u=M$v[M$D+1])-M$A;if(M$j&&0!=(M$s=M$k[M$p])){var M$G=(Math.sqrt(M$E*M$E+M$F*M$F)/M$s-1)*M$d+1;M$r.resultMatrix.a*=M$G,M$r.resultMatrix.c*=M$G}if(M$x=M$t,M$A=M$u,M$e){var M$H=M$r.resultMatrix.a,M$I=M$r.resultMatrix.c,M$J=M$r.resultMatrix.b,M$K=M$r.resultMatrix.d,M$L=NaN,M$M=NaN,M$N=NaN;M$L=M$i?M$v[M$D-1]:0==M$n[M$p+1]?M$v[M$D+2]:Math.atan2(M$F,M$E),M$L-=Math.atan2(M$J,M$H)-M$B/180*Math.PI,M$C&&(M$M=Math.cos(M$L),M$N=Math.sin(M$L),M$x+=((M$s=M$r.length)*(M$M*M$H-M$N*M$J)-M$E)*M$d,M$A+=(M$s*(M$N*M$H+M$M*M$J)-M$F)*M$d),M$L>Math.PI?M$L-=2*Math.PI:M$L<-Math.PI&&(M$L+=2*Math.PI),M$L*=M$d,M$M=Math.cos(M$L),M$N=Math.sin(M$L),M$r.resultMatrix.a=M$M*M$H-M$N*M$J,M$r.resultMatrix.c=M$M*M$I-M$N*M$K,M$r.resultMatrix.b=M$N*M$H+M$M*M$J,M$r.resultMatrix.d=M$N*M$I+M$M*M$K}}}},M$a.computeWorldVertices2=function(M$a,M$b,M$c,M$d,M$e,M$f){var M$g,M$h,M$i=M$a.currDisplayData.bones,M$j=M$a.currDisplayData.weights,M$k=M$a.currDisplayData.triangles,M$l=0,M$m=0,M$n=0,M$o=0,M$p=0,M$q=0,M$r=0,M$s=0,M$t=0,M$u=0,M$v=0;if(null!=M$i){for(M$l=0;M$l<M$c;M$l+=2)M$m+=(M$o=M$i[M$m])+1,M$n+=M$o;var M$w=M$b;for(M$p=M$f,M$q=3*M$n;M$p<M$d;M$p+=2){for(M$s=M$r=0,M$o=M$i[M$m++],M$o+=M$m;M$m<M$o;M$m++,M$q+=3){M$g=M$w[M$i[M$m]].resultMatrix,M$t=M$j[M$q],M$u=M$j[M$q+1];var M$x=M$j[M$q+2];M$r+=(M$t*M$g.a+M$u*M$g.c+M$g.tx)*M$x,M$s+=(M$t*M$g.b+M$u*M$g.d+M$g.ty)*M$x}M$e[M$p]=M$r,M$e[M$p+1]=M$s}}else{var M$A,M$B;if(M$k||(M$k=M$j),M$a.deformData&&(M$k=M$a.deformData),M$A=M$a.parent,M$b)for(M$v=M$b.length,M$l=0;M$l<M$v;M$l++)if(M$b[M$l].name==M$A){M$h=M$b[M$l];break}M$h&&(M$B=M$h.resultMatrix),M$B||(M$B=M$I._tempMt);var M$C=M$B.tx,M$D=M$B.ty,M$E=M$B.a,M$F=M$B.b,M$G=M$B.c,M$H=M$B.d;for(M$h&&(M$H*=M$h.d),M$m=M$c,M$p=M$f;M$p<M$d;M$m+=2,M$p+=2)M$t=M$k[M$m],M$u=M$k[M$m+1],M$e[M$p]=M$t*M$E+M$u*M$F+M$C,M$e[M$p+1]=-(M$t*M$G+M$u*M$H+M$D)}},M$a.computeWorldPositions=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g){M$a.currDisplayData.bones,M$a.currDisplayData.weights,M$a.currDisplayData.triangles;var M$h=[],M$i=0,M$j=M$a.currDisplayData.verLen,M$k=this.position,M$l=this._spaces,M$m=[],M$n=[],M$o=M$j/6,M$p=-1,M$q=NaN,M$r=0,M$s=0,M$t=NaN,M$u=NaN,M$v=NaN,M$w=NaN;if(M$o--,M$j-=4,this.computeWorldVertices2(M$a,M$b,2,M$j,M$h,0),this._debugKey)for(M$i=0;M$i<M$h.length;)M$c.drawCircle(M$h[M$i++],M$h[M$i++],10,"#ff0000");M$m=M$h,this._curves.length=M$o;var M$x=this._curves,M$A=M$m[M$q=0],M$B=M$m[1],M$C=0,M$D=0,M$E=0,M$F=0,M$G=0,M$H=0,M$I=NaN,M$J=NaN,M$K=NaN,M$L=NaN,M$M=NaN,M$N=NaN,M$O=NaN,M$P=NaN,M$Q=0;for(M$i=0,M$Q=2;M$i<M$o;M$i++,M$Q+=6)M$C=M$m[M$Q],M$D=M$m[M$Q+1],M$E=M$m[M$Q+2],M$F=M$m[M$Q+3],M$M=2*(M$I=.1875*(M$A-2*M$C+M$E))+(M$K=.09375*(3*(M$C-M$E)-M$A+(M$G=M$m[M$Q+4]))),M$N=2*(M$J=.1875*(M$B-2*M$D+M$F))+(M$L=.09375*(3*(M$D-M$F)-M$B+(M$H=M$m[M$Q+5]))),M$O=.75*(M$C-M$A)+M$I+.16666667*M$K,M$P=.75*(M$D-M$B)+M$J+.16666667*M$L,M$q+=Math.sqrt(M$O*M$O+M$P*M$P),M$O+=M$M,M$P+=M$N,M$M+=M$K,M$N+=M$L,M$q+=Math.sqrt(M$O*M$O+M$P*M$P),M$O+=M$M,M$P+=M$N,M$q+=Math.sqrt(M$O*M$O+M$P*M$P),M$O+=M$M+M$K,M$P+=M$N+M$L,M$q+=Math.sqrt(M$O*M$O+M$P*M$P),M$x[M$i]=M$q,M$A=M$G,M$B=M$H;if(M$f&&(M$k*=M$q),M$g)for(M$i=0;M$i<M$d;M$i++)M$l[M$i]*=M$q;var M$R=this._segments,M$S=0,M$T=0;for(M$T=M$s=M$r=M$i=0;M$i<M$d;M$i++,M$r+=3)if((M$t=M$k+=M$u=M$l[M$i])<0)this.addBeforePosition(M$t,M$m,0,M$n,M$r);else if(M$q<M$t)this.addAfterPosition(M$t-M$q,M$m,M$j-4,M$n,M$r);else{for(;;M$s++)if(!((M$w=M$x[M$s])<M$t)){0==M$s?M$t/=M$w:M$t=(M$t-(M$v=M$x[M$s-1]))/(M$w-M$v);break}if(M$s!=M$p){var M$U=6*(M$p=M$s);for(M$A=M$m[M$U],M$B=M$m[M$U+1],M$C=M$m[M$U+2],M$D=M$m[M$U+3],M$E=M$m[M$U+4],M$F=M$m[M$U+5],M$M=2*(M$I=.03*(M$A-2*M$C+M$E))+(M$K=.006*(3*(M$C-M$E)-M$A+(M$G=M$m[M$U+6]))),M$N=2*(M$J=.03*(M$B-2*M$D+M$F))+(M$L=.006*(3*(M$D-M$F)-M$B+(M$H=M$m[M$U+7]))),M$O=.3*(M$C-M$A)+M$I+.16666667*M$K,M$P=.3*(M$D-M$B)+M$J+.16666667*M$L,M$S=Math.sqrt(M$O*M$O+M$P*M$P),M$R[0]=M$S,M$U=1;M$U<8;M$U++)M$O+=M$M,M$P+=M$N,M$M+=M$K,M$N+=M$L,M$S+=Math.sqrt(M$O*M$O+M$P*M$P),M$R[M$U]=M$S;M$O+=M$M,M$P+=M$N,M$S+=Math.sqrt(M$O*M$O+M$P*M$P),M$R[8]=M$S,M$O+=M$M+M$K,M$P+=M$N+M$L,M$S+=Math.sqrt(M$O*M$O+M$P*M$P),M$R[9]=M$S,M$T=0}for(M$t*=M$S;;M$T++)if(!((M$w=M$R[M$T])<M$t)){0==M$T?M$t/=M$w:M$t=M$T+(M$t-(M$v=M$R[M$T-1]))/(M$w-M$v);break}this.addCurvePosition(.1*M$t,M$A,M$B,M$C,M$D,M$E,M$F,M$G,M$H,M$n,M$r,M$e||0<M$i&&0==M$u)}return M$n},M$a.addBeforePosition=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$b[M$c],M$g=M$b[M$c+1],M$h=M$b[M$c+2]-M$f,M$i=M$b[M$c+3]-M$g,M$j=Math.atan2(M$i,M$h);M$d[M$e]=M$f+M$a*Math.cos(M$j),M$d[M$e+1]=M$g+M$a*Math.sin(M$j),M$d[M$e+2]=M$j},M$a.addAfterPosition=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$b[M$c+2],M$g=M$b[M$c+3],M$h=M$f-M$b[M$c],M$i=M$g-M$b[M$c+1],M$j=Math.atan2(M$i,M$h);M$d[M$e]=M$f+M$a*Math.cos(M$j),M$d[M$e+1]=M$g+M$a*Math.sin(M$j),M$d[M$e+2]=M$j},M$a.addCurvePosition=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k,M$l){0==M$a&&(M$a=1e-4);var M$m=M$a*M$a,M$n=M$m*M$a,M$o=1-M$a,M$p=M$o*M$o,M$q=M$p*M$o,M$r=M$o*M$a,M$s=3*M$r,M$t=M$o*M$s,M$u=M$s*M$a,M$v=M$b*M$q+M$d*M$t+M$f*M$u+M$h*M$n,M$w=M$c*M$q+M$e*M$t+M$g*M$u+M$i*M$n;M$j[M$k]=M$v,M$j[M$k+1]=M$w,M$j[M$k+2]=M$l?Math.atan2(M$w-(M$c*M$p+M$e*M$r*2+M$g*M$m),M$v-(M$b*M$p+M$d*M$r*2+M$f*M$m)):0},M$I.NONE=-1,M$I.BEFORE=-2,M$I.AFTER=-3,M$c(M$I,["_tempMt",function(){return this._tempMt=new M$Ga}]),M$I}(),M$Qa=function(){function M$a(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return M$d(M$a,"laya.ani.bone.PathConstraintData"),M$a}(),M$Ra=function(){function M$a(){this.name=null,this.slotArr=[]}return M$d(M$a,"laya.ani.bone.SkinData"),M$a}(),M$Sa=function(){function M$a(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}M$d(M$a,"laya.ani.bone.SkinSlotDisplayData");var M$b=M$a.prototype;return M$b.createTexture=function(M$a){return this.texture||(this.texture=new M$Ha(M$a.bitmap,this.uvs),M$a.bitmap.alphaTexture&&(this.texture.alphaTexture=new M$Ha(M$a.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=M$a.height,this.texture.height=M$a.width,this.texture.offsetX=-M$a.offsetX,this.texture.offsetY=-M$a.offsetY,this.texture.sourceWidth=M$a.sourceHeight,this.texture.sourceHeight=M$a.sourceWidth):(this.texture.width=M$a.width,this.texture.height=M$a.height,this.texture.offsetX=-M$a.offsetX,this.texture.offsetY=-M$a.offsetY,this.texture.sourceWidth=M$a.sourceWidth,this.texture.sourceHeight=M$a.sourceHeight),M$q.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},M$b.destory=function(){this.texture&&this.texture.destroy()},M$a}(),M$Ta=function(){function M$a(){this.name=null,this.displayArr=[]}return M$d(M$a,"laya.ani.bone.SlotData"),M$a.prototype.getDisplayByName=function(M$a){for(var M$b=0,M$c=this.displayArr.length;M$b<M$c;M$b++)if(this.displayArr[M$b].attachmentName==M$a)return M$b;return-1},M$a}(),M$w=function(){function M$a(M$a,M$b){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=M$p(2,0),this._data=M$a,null==this._bones&&(this._bones=[]),this.target=M$b[M$a.targetIndex];var M$c,M$d=0;for(M$d=0,M$c=M$a.boneIndexs.length;M$d<M$c;M$d++)this._bones.push(M$b[M$a.boneIndexs[M$d]]);this.rotateMix=M$a.rotateMix,this.translateMix=M$a.translateMix,this.scaleMix=M$a.scaleMix,this.shearMix=M$a.shearMix}return M$d(M$a,"laya.ani.bone.TfConstraint"),M$a.prototype.apply=function(){for(var M$a,M$b=this.target.resultMatrix.a,M$c=this.target.resultMatrix.b,M$d=this.target.resultMatrix.c,M$e=this.target.resultMatrix.d,M$f=0,M$g=this._bones.length;M$f<M$g;M$f++){if(M$a=this._bones[M$f],0<this.rotateMix){var M$h=M$a.resultMatrix.a,M$i=M$a.resultMatrix.b,M$j=M$a.resultMatrix.c,M$k=M$a.resultMatrix.d,M$l=Math.atan2(M$d,M$b)-Math.atan2(M$j,M$h)+this._data.offsetRotation*Math.PI/180;M$l>Math.PI?M$l-=2*Math.PI:M$l<-Math.PI&&(M$l+=2*Math.PI),M$l*=this.rotateMix;var M$m=Math.cos(M$l),M$n=Math.sin(M$l);M$a.resultMatrix.a=M$m*M$h-M$n*M$j,M$a.resultMatrix.b=M$m*M$i-M$n*M$k,M$a.resultMatrix.c=M$n*M$h+M$m*M$j,M$a.resultMatrix.d=M$n*M$i+M$m*M$k}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),M$a.resultMatrix.tx+=(this._temp[0]-M$a.resultMatrix.tx)*this.translateMix,M$a.resultMatrix.ty+=(this._temp[1]-M$a.resultMatrix.ty)*this.translateMix,M$a.updateChild()),0<this.scaleMix){var M$o=Math.sqrt(M$a.resultMatrix.a*M$a.resultMatrix.a+M$a.resultMatrix.c*M$a.resultMatrix.c),M$p=Math.sqrt(M$b*M$b+M$d*M$d),M$q=1e-5<M$o?(M$o+(M$p-M$o+this._data.offsetScaleX)*this.scaleMix)/M$o:0;M$a.resultMatrix.a*=M$q,M$a.resultMatrix.c*=M$q,M$o=Math.sqrt(M$a.resultMatrix.b*M$a.resultMatrix.b+M$a.resultMatrix.d*M$a.resultMatrix.d),M$p=Math.sqrt(M$c*M$c+M$e*M$e),M$q=1e-5<M$o?(M$o+(M$p-M$o+this._data.offsetScaleY)*this.scaleMix)/M$o:0,M$a.resultMatrix.b*=M$q,M$a.resultMatrix.d*=M$q}if(0<this.shearMix){M$i=M$a.resultMatrix.b,M$k=M$a.resultMatrix.d;var M$r=Math.atan2(M$k,M$i);(M$l=Math.atan2(M$e,M$c)-Math.atan2(M$d,M$b)-(M$r-Math.atan2(M$a.resultMatrix.c,M$a.resultMatrix.a)))>Math.PI?M$l-=2*Math.PI:M$l<-Math.PI&&(M$l+=2*Math.PI),M$l=M$r+(M$l+this._data.offsetShearY*Math.PI/180)*this.shearMix,M$q=Math.sqrt(M$i*M$i+M$k*M$k),M$a.resultMatrix.b=Math.cos(M$l)*M$q,M$a.resultMatrix.d=Math.sin(M$l)*M$q}}},M$a}(),M$Ua=function(){function M$a(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return M$d(M$a,"laya.ani.bone.TfConstraintData"),M$a}(),M$Va=function(){function M$a(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}M$d(M$a,"laya.ani.bone.Transform");var M$b=M$a.prototype;return M$b.initData=function(M$a){null!=M$a.x&&(this.x=M$a.x),null!=M$a.y&&(this.y=M$a.y),null!=M$a.skX&&(this.skX=M$a.skX),null!=M$a.skY&&(this.skY=M$a.skY),null!=M$a.scX&&(this.scX=M$a.scX),null!=M$a.scY&&(this.scY=M$a.scY)},M$b.getMatrix=function(){var M$a;return(M$a=this.mMatrix?this.mMatrix:this.mMatrix=new M$Ga).identity(),M$a.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(M$a,this.skewX*Math.PI/180,this.skewY*Math.PI/180),M$a.rotate(this.skX*Math.PI/180),M$a.translate(this.x,this.y),M$a},M$b.skew=function(M$a,M$b,M$c){var M$d=Math.sin(M$c),M$e=Math.cos(M$c),M$f=Math.sin(M$b),M$g=Math.cos(M$b);return M$a.setTo(M$a.a*M$g-M$a.b*M$d,M$a.a*M$f+M$a.b*M$e,M$a.c*M$g-M$a.d*M$d,M$a.c*M$f+M$a.d*M$e,M$a.tx*M$g-M$a.ty*M$d,M$a.tx*M$f+M$a.ty*M$e),M$a},M$a}(),M$x=function(){function M$a(){}return M$d(M$a,"laya.ani.bone.UVTools"),M$a.getRelativeUV=function(M$a,M$b,M$c){var M$d=M$a[0],M$e=M$a[2]-M$a[0],M$f=M$a[1],M$g=M$a[5]-M$a[1];M$c||(M$c=[]),M$c.length=M$b.length;var M$h,M$i=0;M$h=M$c.length;var M$j=1/M$e,M$k=1/M$g;for(M$i=0;M$i<M$h;M$i+=2)M$c[M$i]=(M$b[M$i]-M$d)*M$j,M$c[M$i+1]=(M$b[M$i+1]-M$f)*M$k;return M$c},M$a.getAbsoluteUV=function(M$a,M$b,M$c){if(0==M$a[0]&&0==M$a[1]&&1==M$a[4]&&1==M$a[5])return M$c?(M$r.copyArray(M$c,M$b),M$c):M$b;var M$d=M$a[0],M$e=M$a[2]-M$a[0],M$f=M$a[1],M$g=M$a[5]-M$a[1];M$c||(M$c=[]),M$c.length=M$b.length;var M$h,M$i=0;for(M$h=M$c.length,M$i=0;M$i<M$h;M$i+=2)M$c[M$i]=M$b[M$i]*M$e+M$d,M$c[M$i+1]=M$b[M$i+1]*M$g+M$f;return M$c},M$a}(),M$I=function(){function M$a(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return M$d(M$a,"laya.ani.KeyFramesContent"),M$a}(),M$A=function(){function M$k(){}return M$d(M$k,"laya.ani.math.BezierLerp"),M$k.getBezierRate=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$k._getBezierParamKey(M$b,M$c,M$d,M$e),M$g=100*M$f+M$a;if(M$k._bezierResultCache[M$g])return M$k._bezierResultCache[M$g];var M$h,M$i=M$k._getBezierPoints(M$b,M$c,M$d,M$e,M$f),M$j=0;for(M$h=M$i.length,M$j=0;M$j<M$h;M$j+=2)if(M$a<=M$i[M$j])return M$k._bezierResultCache[M$g]=M$i[M$j+1],M$i[M$j+1];return M$k._bezierResultCache[M$g]=1},M$k._getBezierParamKey=function(M$a,M$b,M$c,M$d){return 100*(100*(100*(100*M$a+M$b)+M$c)+M$d)},M$k._getBezierPoints=function(M$a,M$b,M$c,M$d,M$e){return M$k._bezierPointsCache[M$e]?M$k._bezierPointsCache[M$e]:(M$f=[0,0,M$a,M$b,M$c,M$d,1,1],M$g=(new M$h).getBezierPoints(M$f,100,3),M$k._bezierPointsCache[M$e]=M$g);var M$f,M$g},M$k._bezierResultCache={},M$k._bezierPointsCache={},M$k}(),M$B=function(M$a){function M$b(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,M$b.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}M$d(M$b,"laya.ani.AnimationPlayer",M$e);var M$c=M$b.prototype;return M$ea.imps(M$c,{"laya.resource.IDestroy":!0}),M$c._onTempletLoadedComputeFullKeyframeIndices=function(M$a,M$b,M$c){this._templet===M$c&&this._cachePlayRate===M$a&&this._cacheFrameRate===M$b&&this._computeFullKeyframeIndices()},M$c._computeFullKeyframeIndices=function(){for(var M$a=this._fullFrames=[],M$b=this._templet,M$c=this._cacheFrameRateInterval*this._cachePlayRate,M$d=0,M$e=M$b.getAnimationCount();M$d<M$e;M$d++){for(var M$f=[],M$g=0,M$h=M$b.getAnimation(M$d).nodes.length;M$g<M$h;M$g++){for(var M$i=M$b.getAnimation(M$d).nodes[M$g],M$j=Math.floor(M$i.playTime/M$c+.01),M$k=new Uint16Array(M$j+1),M$l=-1,M$m=0,M$n=M$i.keyFrame.length;M$m<M$n;M$m++){var M$o=M$i.keyFrame[M$m],M$p=M$o.startTime,M$q=M$p+M$o.duration+M$c;do{for(var M$r=Math.floor(M$p/M$c+.5),M$s=M$l+1;M$s<M$r;M$s++)M$k[M$s]=M$m;M$k[M$l=M$r]=M$m,M$p+=M$c}while(M$p<=M$q)}M$f.push(M$k)}M$a.push(M$f)}},M$c._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},M$c._calculatePlayDuration=function(){if(0!==this.state){var M$a=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=M$a),this._playEnd>M$a&&(this._playEnd=M$a),this._playDuration=this._playEnd-this._playStart}},M$c._setPlayParams=function(M$a,M$b){this._currentTime=M$a,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/M$b+.01),0),this._currentFrameTime=this._currentKeyframeIndex*M$b},M$c._setPlayParamsWhenStop=function(M$a,M$b){this._currentTime=M$a,this._currentKeyframeIndex=Math.max(Math.floor(M$a/M$b+.01),0),this._currentFrameTime=this._currentKeyframeIndex*M$b,this._currentAnimationClipIndex=-1},M$c._update=function(M$a){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var M$b=this._cacheFrameRateInterval*this._cachePlayRate,M$c=0;this._startUpdateLoopCount!==M$o.loopCount&&(M$c=M$a*this.playbackRate,this._elapsedPlaybackTime+=M$c);var M$d=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=M$d)return this._setPlayParamsWhenStop(M$d,M$b),void this.event("stopped");if(M$c+=this._currentTime,0<M$d)if(M$d<=M$c)do{if(M$c-=M$d,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(M$d,M$b),this._stopWhenCircleFinish=!1,void this.event("stopped");M$c<M$d&&(this._setPlayParams(M$c,M$b),this.event("complete"))}while(M$d<=M$c);else this._setPlayParams(M$c,M$b);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(M$d,M$b),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},M$c._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},M$c.play=function(M$a,M$b,M$c,M$d,M$e){if(void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=1),void 0===M$c&&(M$c=2147483647),void 0===M$d&&(M$d=0),void 0===M$e&&(M$e=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(M$c<0||M$d<0||M$e<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==M$e&&M$e<M$d)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=M$b,this._overallDuration=M$c,this._playStart=M$d,this._playEnd=M$e,this._paused=!1,this._currentAnimationClipIndex=M$a,this._currentKeyframeIndex=0,this._startUpdateLoopCount=M$o.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},M$c.playByFrame=function(M$a,M$b,M$c,M$d,M$e,M$f){void 0===M$a&&(M$a=0),void 0===M$b&&(M$b=1),void 0===M$c&&(M$c=2147483647),void 0===M$d&&(M$d=0),void 0===M$e&&(M$e=0),void 0===M$f&&(M$f=30);var M$g=1e3/M$f;this.play(M$a,M$b,M$c,M$d*M$g,M$e*M$g)},M$c.stop=function(M$a){void 0===M$a&&(M$a=!0),M$a?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},M$f(0,M$c,"playEnd",function(){return this._playEnd}),M$f(0,M$c,"templet",function(){return this._templet},function(M$a){0===!this.state&&this.stop(!0),this._templet!==M$a&&((this._templet=M$a).loaded?this._computeFullKeyframeIndices():M$a.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),M$f(0,M$c,"playStart",function(){return this._playStart}),M$f(0,M$c,"playDuration",function(){return this._playDuration}),M$f(0,M$c,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),M$f(0,M$c,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),M$f(0,M$c,"overallDuration",function(){return this._overallDuration}),M$f(0,M$c,"currentFrameTime",function(){return this._currentFrameTime}),M$f(0,M$c,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),M$f(0,M$c,"currentPlayTime",function(){return this._currentTime+this._playStart}),M$f(0,M$c,"cachePlayRate",function(){return this._cachePlayRate},function(M$a){this._cachePlayRate!==M$a&&(this._cachePlayRate=M$a,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[M$a,this._cacheFrameRate])))}),M$f(0,M$c,"cacheFrameRate",function(){return this._cacheFrameRate},function(M$a){this._cacheFrameRate!==M$a&&(this._cacheFrameRate=M$a,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,M$a])))}),M$f(0,M$c,"currentTime",null,function(M$a){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(M$a<this._playStart||M$a>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=M$o.loopCount;var M$b=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=M$a,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/M$b),0),this._currentFrameTime=this._currentKeyframeIndex*M$b}}),M$f(0,M$c,"paused",function(){return this._paused},function(M$a){(this._paused=M$a)&&this.event("paused")}),M$f(0,M$c,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),M$f(0,M$c,"destroyed",function(){return this._destroyed}),M$b}(),M$J=function(M$a){function M$b(){M$b.__super.call(this),M$q.isConchNode&&(this.drawSkin=function(M$a){M$a.transform||(M$a.transform=M$Ga.EMPTY),this._addCmd([M$a]),this.setSkinMesh&&this.setSkinMesh(M$a._ps,M$a.mVBData,M$a.mEleNum,0,M$a.mTexture,M$a.transform)})}return M$d(M$b,"laya.ani.GraphicsAni",M$g),M$b.prototype.drawSkin=function(M$a){var M$b=[M$a];this._saveToCmd(M$q._context._drawSkin,M$b)},M$b.create=function(){return M$b._caches.pop()||new M$b},M$b.recycle=function(M$a){M$a.clear(),M$b._caches.push(M$a)},M$b._caches=[],M$b}(),M$K=function(M$a){function M$s(){this._aniMap={},this.unfixedLastAniIndex=-1,M$s.__super.call(this),this._anis=new Array}M$d(M$s,"laya.ani.AnimationTemplet",M$k);var M$b=M$s.prototype;return M$b.parse=function(M$a){var M$b=new M$Fa(M$a);this._aniVersion=M$b.readUTFString(),M$t.parse(this,M$b)},M$b._calculateKeyFrame=function(M$a,M$b,M$c){var M$d=M$a.keyFrame;M$d[M$b]=M$d[0];for(var M$e=0;M$e<M$b;M$e++){var M$f=M$d[M$e];M$f.nextData=0===M$f.duration?M$f.data:M$d[M$e+1].data}M$d.length--},M$b.onAsynLoaded=function(M$a,M$b,M$c){var M$d=new M$Fa(M$b);switch(this._aniVersion=M$d.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":M$u.parse(this,M$d);break;default:M$t.parse(this,M$d)}this._endLoaded()},M$b.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},M$b.getAnimationCount=function(){return this._anis.length},M$b.getAnimation=function(M$a){return this._anis[M$a]},M$b.getAniDuration=function(M$a){return this._anis[M$a].playTime},M$b.getNodes=function(M$a){return this._anis[M$a].nodes},M$b.getNodeIndexWithName=function(M$a,M$b){return this._anis[M$a].bone3DMap[M$b]},M$b.getNodeCount=function(M$a){return this._anis[M$a].nodes.length},M$b.getTotalkeyframesLength=function(M$a){return this._anis[M$a].totalKeyframeDatasLength},M$b.getPublicExtData=function(){return this._publicExtData},M$b.getAnimationDataWithCache=function(M$a,M$b,M$c,M$d){var M$e=M$b[M$c];if(M$e){var M$f=M$e[M$a];return M$f?M$f[M$d]:null}return null},M$b.setAnimationDataWithCache=function(M$a,M$b,M$c,M$d,M$e){var M$f=M$b[M$c]||(M$b[M$c]={});(M$f[M$a]||(M$f[M$a]=[]))[M$d]=M$e},M$b.getOriginalData=function(M$a,M$b,M$c,M$d,M$e){for(var M$f=this._anis[M$a].nodes,M$g=0,M$h=0,M$i=M$f.length,M$j=0;M$h<M$i;M$h++){var M$k,M$l=M$f[M$h];M$k=M$l.keyFrame[M$c[M$h][M$d]],M$l.dataOffset=M$j;var M$m=M$e-M$k.startTime,M$n=M$l.lerpType;if(M$n)switch(M$n){case 0:case 1:for(M$g=0;M$g<M$l.keyframeWidth;)M$g+=M$l.interpolationMethod[M$g](M$l,M$g,M$b,M$j+M$g,M$k.data,M$m,null,M$k.duration,M$k.nextData);break;case 2:var M$o=M$k.interpolationData,M$p=M$o.length,M$q=0;for(M$g=0;M$g<M$p;){var M$r=M$o[M$g];switch(M$r){case 6:case 7:M$g+=M$s.interpolation[M$r](M$l,M$q,M$b,M$j+M$q,M$k.data,M$m,null,M$k.duration,M$k.nextData,M$o,M$g+1);break;default:M$g+=M$s.interpolation[M$r](M$l,M$q,M$b,M$j+M$q,M$k.data,M$m,null,M$k.duration,M$k.nextData)}M$q++}}else for(M$g=0;M$g<M$l.keyframeWidth;)M$g+=M$l.interpolationMethod[M$g](M$l,M$g,M$b,M$j+M$g,M$k.data,M$m,null,M$k.duration,M$k.nextData);M$j+=M$l.keyframeWidth}},M$b.getNodesCurrentFrameIndex=function(M$a,M$b){var M$c=this._anis[M$a].nodes;M$a!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(M$c.length),this.unfixedCurrentTimes=new Float32Array(M$c.length),this.unfixedLastAniIndex=M$a);for(var M$d=0,M$e=M$c.length;M$d<M$e;M$d++){var M$f=M$c[M$d];for(M$b<this.unfixedCurrentTimes[M$d]&&(this.unfixedCurrentFrameIndexes[M$d]=0),this.unfixedCurrentTimes[M$d]=M$b;this.unfixedCurrentFrameIndexes[M$d]<M$f.keyFrame.length&&!(M$f.keyFrame[this.unfixedCurrentFrameIndexes[M$d]].startTime>this.unfixedCurrentTimes[M$d]);)this.unfixedCurrentFrameIndexes[M$d]++;this.unfixedCurrentFrameIndexes[M$d]--}return this.unfixedCurrentFrameIndexes},M$b.getOriginalDataUnfixedRate=function(M$a,M$b,M$c){var M$d=this._anis[M$a].nodes;M$a!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(M$d.length),this.unfixedCurrentTimes=new Float32Array(M$d.length),this.unfixedKeyframes=M$p(M$d.length),this.unfixedLastAniIndex=M$a);for(var M$e=0,M$f=0,M$g=M$d.length,M$h=0;M$f<M$g;M$f++){var M$i=M$d[M$f];for(M$c<this.unfixedCurrentTimes[M$f]&&(this.unfixedCurrentFrameIndexes[M$f]=0),this.unfixedCurrentTimes[M$f]=M$c;this.unfixedCurrentFrameIndexes[M$f]<M$i.keyFrame.length&&!(M$i.keyFrame[this.unfixedCurrentFrameIndexes[M$f]].startTime>this.unfixedCurrentTimes[M$f]);)this.unfixedKeyframes[M$f]=M$i.keyFrame[this.unfixedCurrentFrameIndexes[M$f]],this.unfixedCurrentFrameIndexes[M$f]++;var M$j=this.unfixedKeyframes[M$f];M$i.dataOffset=M$h;var M$k=M$c-M$j.startTime;if(M$i.lerpType)switch(M$i.lerpType){case 0:case 1:for(M$e=0;M$e<M$i.keyframeWidth;)M$e+=M$i.interpolationMethod[M$e](M$i,M$e,M$b,M$h+M$e,M$j.data,M$k,null,M$j.duration,M$j.nextData);break;case 2:var M$l=M$j.interpolationData,M$m=M$l.length,M$n=0;for(M$e=0;M$e<M$m;){var M$o=M$l[M$e];switch(M$o){case 6:case 7:M$e+=M$s.interpolation[M$o](M$i,M$n,M$b,M$h+M$n,M$j.data,M$k,null,M$j.duration,M$j.nextData,M$l,M$e+1);break;default:M$e+=M$s.interpolation[M$o](M$i,M$n,M$b,M$h+M$n,M$j.data,M$k,null,M$j.duration,M$j.nextData)}M$n++}}else for(M$e=0;M$e<M$i.keyframeWidth;)M$e+=M$i.interpolationMethod[M$e](M$i,M$e,M$b,M$h+M$e,M$j.data,M$k,null,M$j.duration,M$j.nextData);M$h+=M$i.keyframeWidth}},M$s._LinearInterpolation_0=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){var M$k=0===M$h?0:M$f/M$h;return M$c[M$d]=(1-M$k)*M$e[M$b]+M$k*M$i[M$b],1},M$s._QuaternionInterpolation_1=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){var M$k=0===M$h?0:M$f/M$h;return M$m.slerpQuaternionArray(M$e,M$b,M$i,M$b,M$k,M$c,M$d),4},M$s._AngleInterpolation_2=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){return 0},M$s._RadiansInterpolation_3=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){return 0},M$s._Matrix4x4Interpolation_4=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){for(var M$k=0;M$k<16;M$k++,M$b++)M$c[M$d+M$k]=M$e[M$b]+M$f*M$g[M$b];return 16},M$s._NoInterpolation_5=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j){return M$c[M$d]=M$e[M$b],1},M$s._BezierInterpolation_6=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k){return void 0===M$k&&(M$k=0),M$c[M$d]=M$e[M$b]+(M$i[M$b]-M$e[M$b])*M$A.getBezierRate(M$f/M$h,M$j[M$k],M$j[M$k+1],M$j[M$k+2],M$j[M$k+3]),5},M$s._BezierInterpolation_7=function(M$a,M$b,M$c,M$d,M$e,M$f,M$g,M$h,M$i,M$j,M$k){return void 0===M$k&&(M$k=0),M$c[M$d]=M$j[M$k+4]+M$j[M$k+5]*M$A.getBezierRate((.001*M$f+M$j[M$k+6])/M$j[M$k+7],M$j[M$k],M$j[M$k+1],M$j[M$k+2],M$j[M$k+3]),9},M$s.load=function(M$a){return M$ea.loader.create(M$a,null,null,M$s)},M$s.interpolation=[M$s._LinearInterpolation_0,M$s._QuaternionInterpolation_1,M$s._AngleInterpolation_2,M$s._RadiansInterpolation_3,M$s._Matrix4x4Interpolation_4,M$s._NoInterpolation_5,M$s._BezierInterpolation_6,M$s._BezierInterpolation_7],M$s}(),M$C=function(M$b){function M$c(M$a,M$b){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,M$c.__super.call(this),void 0===M$b&&(M$b=0),M$a&&this.init(M$a,M$b)}M$d(M$c,"laya.ani.bone.Skeleton",M$b);var M$a=M$c.prototype;return M$a.init=function(M$a,M$b){void 0===M$b&&(M$b=0);var M$c,M$d,M$e,M$f=0,M$g=0;if(1==M$b)for(this._graphicsCache=[],M$f=0,M$g=M$a.getAnimationCount();M$f<M$g;M$f++)this._graphicsCache.push([]);if(this._yReverseMatrix=M$a.yReverseMatrix,this._aniMode=M$b,this._templet=M$a,this._player=new M$B,this._player.cacheFrameRate=M$a.rate,this._player.templet=M$a,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=M$a.mBoneArr,this._rootBone=M$a.mRootBone,this._aniSectionDic=M$a.aniSectionDic,0<M$a.ikArr.length)for(this._ikArr=[],M$f=0,M$g=M$a.ikArr.length;M$f<M$g;M$f++)this._ikArr.push(new M$s(M$a.ikArr[M$f],this._boneList));if(0<M$a.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),M$f=0,M$g=M$a.pathArr.length;M$f<M$g;M$f++)M$c=M$a.pathArr[M$f],M$d=new M$v(M$c,this._boneList),(M$e=this._boneSlotDic[M$c.name])&&((M$d=new M$v(M$c,this._boneList)).target=M$e),this._pathDic[M$c.name]=M$d;if(0<M$a.tfArr.length)for(this._tfArr=[],M$f=0,M$g=M$a.tfArr.length;M$f<M$g;M$f++)this._tfArr.push(new M$w(M$a.tfArr[M$f],this._boneList));if(0<M$a.skinDataArray.length){var M$h=this._templet.skinDataArray[this._skinIndex];this._skinName=M$h.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},M$a.load=function(M$a,M$b,M$c){},M$a._onLoaded=function(){},M$a._parseComplete=function(){var M$a=M$D.TEMPLET_DICTIONARY[this._aniPath];M$a&&(this.init(M$a,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},M$a._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},M$a._onPlay=function(){this.event("played")},M$a._onStop=function(){var M$a,M$b=this._templet.eventAniArr[this._aniClipIndex];if(M$b&&this._eventIndex<M$b.length)for(;this._eventIndex<M$b.length;this._eventIndex++)(M$a=M$b[this._eventIndex]).time>=this._player.playStart&&M$a.time<=this._player.playEnd&&this.event("label",M$a);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},M$a._onPause=function(){this.event("paused")},M$a._parseSrcBoneMatrix=function(){var M$a=0,M$b=0;for(M$b=this._templet.srcBoneMatrixArr.length,M$a=0;M$a<M$b;M$a++)this._boneMatrixArray.push(new M$Ga);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var M$c,M$d,M$e=this._templet.boneSlotArray;for(M$a=0,M$b=M$e.length;M$a<M$b;M$a++)M$c=M$e[M$a],null==(M$d=this._bindBoneBoneSlotDic[M$c.parent])&&(this._bindBoneBoneSlotDic[M$c.parent]=M$d=[]),this._boneSlotDic[M$c.name]=M$c=M$c.copy(),M$d.push(M$c),this._boneSlotArray.push(M$c)}},M$a._emitMissedEvents=function(M$a,M$b,M$c){void 0===M$c&&(M$c=0);var M$d=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(M$d){var M$e,M$f,M$g=0;for(M$e=M$d.length,M$g=M$c;M$g<M$e;M$g++)(M$f=M$d[M$g]).time>=this._player.playStart&&M$f.time<=this._player.playEnd&&this.event("label",M$f)}},M$a._update=function(M$a){if(void 0===M$a&&(M$a=!0),!(this._pause||M$a&&this._indexControl)){var M$b=this.timer.currTimer,M$c=this._player.currentKeyframeIndex,M$d=M$b-this._lastTime;if(M$a?this._player._update(M$d):M$c=-1,this._lastTime=M$b,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<M$d&&this._clipIndex==M$c&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var M$e;this._lastUpdateAniClipIndex=this._aniClipIndex,M$c>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var M$f,M$g=this._templet.eventAniArr[this._aniClipIndex];if(M$g&&this._eventIndex<M$g.length&&((M$e=M$g[this._eventIndex]).time>=this._player.playStart&&M$e.time<=this._player.playEnd?this._player.currentPlayTime>=M$e.time&&(this.event("label",M$e),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(M$f=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=M$f&&(this.graphics=M$f));var M$h=0,M$i=0;for(M$i=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,M$i-1)&&0<M$i;)M$i--;if(M$i<this._clipIndex)for(M$h=M$i;M$h<this._clipIndex;M$h++)this._createGraphics(M$h)}else if(1==this._aniMode){if(M$f=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=M$f&&(this.graphics=M$f));for(M$i=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,M$i-1)&&0<M$i;)M$i--;if(M$i<this._clipIndex)for(M$h=M$i;M$h<this._clipIndex;M$h++)this._createGraphics(M$h)}this._createGraphics()}}},M$a._createGraphics=function(M$a){void 0===M$a&&(M$a=-1),-1==M$a&&(M$a=this._clipIndex);var M$b,M$c,M$d=M$a*this._player.cacheFrameRateInterval,M$e=this._templet.drawOrderAniArr[this._aniClipIndex];if(M$e&&0<M$e.length)for(this._drawOrderIndex=0,M$b=M$e[this._drawOrderIndex];M$d>=M$b.time&&(this._drawOrder=M$b.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=M$e.length));)M$b=M$e[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=M$J.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=M$J.create(),M$c=this.graphics;var M$f=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],M$a,M$d);var M$g,M$h,M$i,M$j,M$k=this._aniSectionDic[this._aniClipIndex],M$l=0,M$m=0,M$n=0,M$o=0,M$p=0,M$q=this._templet.srcBoneMatrixArr.length;for(M$p=M$k[M$m=0];M$m<M$q;M$m++)M$j=this._boneList[M$m],M$i=this._templet.srcBoneMatrixArr[M$m],M$j.resultTransform.scX=M$i.scX*this._curOriginalData[M$l++],M$j.resultTransform.skX=M$i.skX+this._curOriginalData[M$l++],M$j.resultTransform.skY=M$i.skY+this._curOriginalData[M$l++],M$j.resultTransform.scY=M$i.scY*this._curOriginalData[M$l++],M$j.resultTransform.x=M$i.x+this._curOriginalData[M$l++],M$j.resultTransform.y=M$i.y+this._curOriginalData[M$l++],8===this._templet.tMatrixDataLen&&(M$j.resultTransform.skewX=M$i.skewX+this._curOriginalData[M$l++],M$j.resultTransform.skewY=M$i.skewY+this._curOriginalData[M$l++]);var M$r,M$s={},M$t={};for(M$p+=M$k[1];M$m<M$p;M$m++)M$s[(M$r=M$f[M$m]).name]=this._curOriginalData[M$l++],M$t[M$r.name]=this._curOriginalData[M$l++],this._curOriginalData[M$l++],this._curOriginalData[M$l++],this._curOriginalData[M$l++],this._curOriginalData[M$l++];var M$u,M$v,M$w={},M$x={};for(M$p+=M$k[2];M$m<M$p;M$m++)M$w[(M$r=M$f[M$m]).name]=this._curOriginalData[M$l++],M$x[M$r.name]=this._curOriginalData[M$l++],this._curOriginalData[M$l++],this._curOriginalData[M$l++],this._curOriginalData[M$l++],this._curOriginalData[M$l++];if(this._pathDic)for(M$p+=M$k[3];M$m<M$p;M$m++){if(M$r=M$f[M$m],M$u=this._pathDic[M$r.name])switch(new M$Fa(M$r.extenData).getByte()){case 1:M$u.position=this._curOriginalData[M$l++];break;case 2:M$u.spacing=this._curOriginalData[M$l++];break;case 3:M$u.rotateMix=this._curOriginalData[M$l++],M$u.translateMix=this._curOriginalData[M$l++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(M$Ga.TEMP.identity()),this._ikArr)for(M$m=0,M$p=this._ikArr.length;M$m<M$p;M$m++)M$v=this._ikArr[M$m],M$w.hasOwnProperty(M$v.name)&&(M$v.bendDirection=M$w[M$v.name]),M$x.hasOwnProperty(M$v.name)&&(M$v.mix=M$x[M$v.name]),M$v.apply();if(this._pathDic)for(var M$A in this._pathDic)(M$u=this._pathDic[M$A]).apply(this._boneList,M$c);if(this._tfArr)for(M$m=0,M$o=this._tfArr.length;M$m<M$o;M$m++)this._tfArr[M$m].apply();for(M$m=0,M$o=this._boneList.length;M$m<M$o;M$m++)if(M$j=this._boneList[M$m],M$h=this._bindBoneBoneSlotDic[M$j.name],M$j.resultMatrix.copyTo(this._boneMatrixArray[M$m]),M$h)for(M$n=0,M$p=M$h.length;M$n<M$p;M$n++)(M$g=M$h[M$n])&&M$g.setParentMatrix(M$j.resultMatrix);var M$B,M$C,M$D,M$E,M$F={},M$G=this._templet.deformAniArr;if(M$G&&0<M$G.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,M$m=0,M$p=this._boneSlotArray.length;M$m<M$p;M$m++)(M$g=this._boneSlotArray[M$m]).deformData=null;var M$H,M$I=M$G[this._aniClipIndex];for(M$H in M$B=M$I.default,this._setDeform(M$B,M$F,this._boneSlotArray,M$d),M$I)"default"!=M$H&&M$H!=this._skinName&&(M$B=M$I[M$H],this._setDeform(M$B,M$F,this._boneSlotArray,M$d));M$B=M$I[this._skinName],this._setDeform(M$B,M$F,this._boneSlotArray,M$d)}if(this._drawOrder)for(M$m=0,M$p=this._drawOrder.length;M$m<M$p;M$m++)M$C=M$s[(M$g=this._boneSlotArray[this._drawOrder[M$m]]).name],M$D=M$t[M$g.name],isNaN(M$D)||(M$c.save(),M$c.alpha(M$D)),isNaN(M$C)||-2==M$C||(this._templet.attachmentNames?M$g.showDisplayByName(this._templet.attachmentNames[M$C]):M$g.showDisplayByIndex(M$C)),M$F[this._drawOrder[M$m]]?(M$E=M$F[this._drawOrder[M$m]],M$g.currDisplayData&&M$E[M$g.currDisplayData.attachmentName]?M$g.deformData=M$E[M$g.currDisplayData.attachmentName]:M$g.deformData=null):M$g.deformData=null,isNaN(M$D)?M$g.draw(M$c,this._boneMatrixArray,2==this._aniMode):M$g.draw(M$c,this._boneMatrixArray,2==this._aniMode,M$D),isNaN(M$D)||M$c.restore();else for(M$m=0,M$p=this._boneSlotArray.length;M$m<M$p;M$m++)M$C=M$s[(M$g=this._boneSlotArray[M$m]).name],M$D=M$t[M$g.name],isNaN(M$D)||(M$c.save(),M$c.alpha(M$D)),isNaN(M$C)||-2==M$C||(this._templet.attachmentNames?M$g.showDisplayByName(this._templet.attachmentNames[M$C]):M$g.showDisplayByIndex(M$C)),M$F[M$m]?(M$E=M$F[M$m],M$g.currDisplayData&&M$E[M$g.currDisplayData.attachmentName]?M$g.deformData=M$E[M$g.currDisplayData.attachmentName]:M$g.deformData=null):M$g.deformData=null,isNaN(M$D)?M$g.draw(M$c,this._boneMatrixArray,2==this._aniMode):M$g.draw(M$c,this._boneMatrixArray,2==this._aniMode,M$D),isNaN(M$D)||M$c.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,M$a,M$c):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,M$a,M$c)},M$a._setDeform=function(M$a,M$b,M$c,M$d){if(M$a){var M$e,M$f,M$g,M$h=0,M$i=0,M$j=0;if(M$a)for(M$h=0,M$i=M$a.deformSlotDataList.length;M$h<M$i;M$h++)for(M$e=M$a.deformSlotDataList[M$h],M$j=0;M$j<M$e.deformSlotDisplayList.length;M$j++)M$g=M$c[(M$f=M$e.deformSlotDisplayList[M$j]).slotIndex],M$f.apply(M$d,M$g),M$b[M$f.slotIndex]||(M$b[M$f.slotIndex]={}),M$b[M$f.slotIndex][M$f.attachment]=M$f.deformData}},M$a.getAnimNum=function(){return this._templet.getAnimationCount()},M$a.getAniNameByIndex=function(M$a){return this._templet.getAniNameByIndex(M$a)},M$a.getSlotByName=function(M$a){return this._boneSlotDic[M$a]},M$a.showSkinByName=function(M$a,M$b){void 0===M$b&&(M$b=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(M$a),M$b)},M$a.showSkinByIndex=function(M$a,M$b){void 0===M$b&&(M$b=!0);for(var M$c=0;M$c<this._boneSlotArray.length;M$c++)this._boneSlotArray[M$c].showSlotData(null,M$b);if(this._templet.showSkinByIndex(this._boneSlotDic,M$a,M$b)){var M$d=this._templet.skinDataArray[M$a];this._skinIndex=M$a,this._skinName=M$d.name}this._clearCache()},M$a.showSlotSkinByIndex=function(M$a,M$b){if(0!=this._aniMode){var M$c=this.getSlotByName(M$a);M$c&&M$c.showDisplayByIndex(M$b),this._clearCache()}},M$a.showSlotSkinByName=function(M$a,M$b){if(0!=this._aniMode){var M$c=this.getSlotByName(M$a);M$c&&M$c.showDisplayByName(M$b),this._clearCache()}},M$a.replaceSlotSkinName=function(M$a,M$b,M$c){if(0!=this._aniMode){var M$d=this.getSlotByName(M$a);M$d&&M$d.replaceDisplayByName(M$b,M$c),this._clearCache()}},M$a.replaceSlotSkinByIndex=function(M$a,M$b,M$c){if(0!=this._aniMode){var M$d=this.getSlotByName(M$a);M$d&&M$d.replaceDisplayByIndex(M$b,M$c),this._clearCache()}},M$a.setSlotSkin=function(M$a,M$b){if(0!=this._aniMode){var M$c=this.getSlotByName(M$a);M$c&&M$c.replaceSkin(M$b),this._clearCache()}},M$a._clearCache=function(){if(1==this._aniMode)for(var M$a=0,M$b=this._graphicsCache.length;M$a<M$b;M$a++){for(var M$c=0,M$d=this._graphicsCache[M$a].length;M$c<M$d;M$c++){var M$e=this._graphicsCache[M$a][M$c];M$e!=this.graphics&&M$J.recycle(M$e)}this._graphicsCache[M$a].length=0}},M$a.play=function(M$a,M$b,M$c,M$d,M$e,M$f){void 0===M$c&&(M$c=!0),void 0===M$d&&(M$d=0),void 0===M$e&&(M$e=0),void 0===M$f&&(M$f=!0),this._indexControl=!1;var M$g=-1,M$h=NaN;if(M$h=M$b?2147483647:0,"string"==typeof M$a)for(var M$i=0,M$j=this._templet.getAnimationCount();M$i<M$j;M$i++){var M$k=this._templet.getAnimation(M$i);if(M$k&&M$a==M$k.name){M$g=M$i;break}}else M$g=M$a;-1<M$g&&M$g<this.getAnimNum()&&(this._aniClipIndex=M$g,(M$c||this._pause||this._currAniIndex!=M$g)&&(this._currAniIndex=M$g,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(M$g)),this._drawOrder=null,this._eventIndex=0,this._player.play(M$g,this._player.playbackRate,M$h,M$d,M$e),M$f&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=M$l.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},M$a.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},M$a.playbackRate=function(M$a){this._player&&(this._player.playbackRate=M$a)},M$a.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},M$a.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=M$l.now(),this.timer.frameLoop(1,this,this._update,null,!0))},M$a._getGrahicsDataWithCache=function(M$a,M$b){return this._graphicsCache[M$a][M$b]},M$a._setGrahicsDataWithCache=function(M$a,M$b,M$c){this._graphicsCache[M$a][M$b]=M$c},M$a.destroy=function(M$a){void 0===M$a&&(M$a=!0),M$b.prototype.destroy.call(this,M$a),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},M$f(0,M$a,"url",function(){return this._aniPath},function(M$a){this.load(M$a)}),M$f(0,M$a,"index",function(){return this._index},function(M$a){this.player&&(this._index=M$a,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),M$f(0,M$a,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),M$f(0,M$a,"templet",function(){return this._templet}),M$f(0,M$a,"player",function(){return this._player}),M$c.useSimpleMeshInCanvas=!1,M$c}(M$fa),M$D=function(M$b){function M$e(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,M$e.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}M$d(M$e,"laya.ani.bone.Templet",M$b);var M$a=M$e.prototype;return M$a.getLoadList=function(){return this._loadList},M$a.loadAni=function(M$a){this._skBufferUrl=M$a,M$ea.loader.load(M$a,M$i.create(this,this.onComplete),null,"arraybuffer")},M$a.onComplete=function(M$a){if(this._isDestroyed)this.destroy();else{var M$b=M$j.getRes(this._skBufferUrl);M$b?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,M$b)):this.event("error","load failed:"+this._skBufferUrl)}},M$a.parseData=function(M$a,M$b,M$c){void 0===M$c&&(M$c=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=M$a,this._mainTexture&&M$q.isWebGL&&M$a.bitmap&&(M$a.bitmap.enableMerageInAtlas=!1),this._rate=M$c,this.parse(M$b)},M$a.buildArmature=function(M$a){return void 0===M$a&&(M$a=0),new M$C(this,M$a)},M$a.parse=function(M$a){M$b.prototype.parse.call(this,M$a),this._endLoaded(),this._aniVersion!=M$e.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+M$e.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},M$a._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var M$a=0;this._loadList=[];var M$b,M$c=new M$Fa(this.getPublicExtData()),M$d=0,M$e=0,M$f=0,M$g=M$c.getInt32(),M$h=M$c.readUTFString(),M$i=M$h.split("\n");for(M$a=0;M$a<M$g;M$a++)M$b=this._path+M$i[2*M$a],M$h=M$i[2*M$a+1],M$c.getFloat32(),M$c.getFloat32(),M$d=M$c.getFloat32(),M$e=M$c.getFloat32(),M$f=M$c.getFloat32(),isNaN(M$f)?0:M$f,M$f=M$c.getFloat32(),isNaN(M$f)?0:M$f,M$f=M$c.getFloat32(),isNaN(M$f)?M$d:M$f,M$f=M$c.getFloat32(),isNaN(M$f)?M$e:M$f,-1==this._loadList.indexOf(M$b)&&this._loadList.push(M$b);this.event("inited",this)}},M$a._textureComplete=function(){for(var M$a,M$b,M$c=0,M$d=this._loadList.length;M$c<M$d;M$c++)M$b=this._loadList[M$c],M$a=this._textureDic[M$b]=M$j.getRes(M$b),M$q.isWebGL&&M$a&&M$a.bitmap&&(M$a.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},M$a._parsePublicExtData=function(){var M$a=0,M$b=0,M$c=0,M$d=0,M$e=0;for(M$a=0,M$e=this.getAnimationCount();M$a<M$e;M$a++)this._graphicsCache.push([]);var M$f;M$f="Dragon"!=this._aniClassName;var M$g,M$h,M$i=new M$Fa(this.getPublicExtData()),M$j=0,M$k=0,M$l=0,M$m=0,M$n=0,M$o=0,M$p=0,M$q=0,M$r=0,M$s=M$i.getInt32(),M$t=M$i.readUTFString(),M$u=M$t.split("\n");for(M$a=0;M$a<M$s;M$a++){if(M$g=this._mainTexture,M$h=this._path+M$u[2*M$a],M$t=M$u[2*M$a+1],null==this._mainTexture&&(M$g=this._textureDic[M$h]),!M$g)return this.event("error",this),void(this.isParseFail=!0);M$j=M$i.getFloat32(),M$k=M$i.getFloat32(),M$l=M$i.getFloat32(),M$m=M$i.getFloat32(),M$r=M$i.getFloat32(),M$n=isNaN(M$r)?0:M$r,M$r=M$i.getFloat32(),M$o=isNaN(M$r)?0:M$r,M$r=M$i.getFloat32(),M$p=isNaN(M$r)?M$l:M$r,M$r=M$i.getFloat32(),M$q=isNaN(M$r)?M$m:M$r,this.subTextureDic[M$t]=M$Ha.create(M$g,M$j,M$k,M$l,M$m,-M$n,-M$o,M$p,M$q),M$g.alphaTexture&&(this.subTextureDic[M$t].alphaTexture=M$Ha.create(M$g.alphaTexture,M$j,M$k,M$l,M$m,-M$n,-M$o,M$p,M$q))}this._mainTexture=M$g;var M$v,M$w,M$x,M$A,M$B,M$C=M$i.getUint16();for(M$a=0;M$a<M$C;M$a++)(M$v=[]).push(M$i.getUint16()),M$v.push(M$i.getUint16()),M$v.push(M$i.getUint16()),M$v.push(M$i.getUint16()),this.aniSectionDic[M$a]=M$v;var M$D,M$E=M$i.getInt16(),M$F={};for(M$a=0;M$a<M$E;M$a++)M$w=new M$Ia,0==M$a?M$D=M$w:M$w.root=M$D,M$w.d=M$f?-1:1,M$A=M$i.readUTFString(),M$B=M$i.readUTFString(),M$w.length=M$i.getFloat32(),1==M$i.getByte()&&(M$w.inheritRotation=!1),1==M$i.getByte()&&(M$w.inheritScale=!1),M$w.name=M$A,M$B&&((M$x=M$F[M$B])?M$x.addChild(M$w):this.mRootBone=M$w),M$F[M$A]=M$w,this.mBoneArr.push(M$w);this.tMatrixDataLen=M$i.getUint16();var M$G,M$H,M$I=M$i.getUint16(),M$J=Math.floor(M$I/this.tMatrixDataLen),M$K=this.srcBoneMatrixArr;for(M$a=0;M$a<M$J;M$a++)(M$G=new M$Va).scX=M$i.getFloat32(),M$G.skX=M$i.getFloat32(),M$G.skY=M$i.getFloat32(),M$G.scY=M$i.getFloat32(),M$G.x=M$i.getFloat32(),M$G.y=M$i.getFloat32(),8===this.tMatrixDataLen&&(M$G.skewX=M$i.getFloat32(),M$G.skewY=M$i.getFloat32()),M$K.push(M$G),(M$w=this.mBoneArr[M$a]).transform=M$G;var M$L,M$M=M$i.getUint16(),M$N=0;for(M$a=0;M$a<M$M;M$a++){for(M$H=new M$Pa,M$N=M$i.getUint16(),M$b=0;M$b<M$N;M$b++)M$H.boneNames.push(M$i.readUTFString()),M$H.boneIndexs.push(M$i.getInt16());M$H.name=M$i.readUTFString(),M$H.targetBoneName=M$i.readUTFString(),M$H.targetBoneIndex=M$i.getInt16(),M$H.bendDirection=M$i.getFloat32(),M$H.mix=M$i.getFloat32(),M$H.isSpine=M$f,this.ikArr.push(M$H)}var M$O,M$P=M$i.getUint16(),M$Q=0;for(M$a=0;M$a<M$P;M$a++){for(M$L=new M$Ua,M$Q=M$i.getUint16(),M$b=0;M$b<M$Q;M$b++)M$L.boneIndexs.push(M$i.getInt16());M$L.name=M$i.getUTFString(),M$L.targetIndex=M$i.getInt16(),M$L.rotateMix=M$i.getFloat32(),M$L.translateMix=M$i.getFloat32(),M$L.scaleMix=M$i.getFloat32(),M$L.shearMix=M$i.getFloat32(),M$L.offsetRotation=M$i.getFloat32(),M$L.offsetX=M$i.getFloat32(),M$L.offsetY=M$i.getFloat32(),M$L.offsetScaleX=M$i.getFloat32(),M$L.offsetScaleY=M$i.getFloat32(),M$L.offsetShearY=M$i.getFloat32(),this.tfArr.push(M$L)}var M$R=M$i.getUint16(),M$S=0;for(M$a=0;M$a<M$R;M$a++){for((M$O=new M$Qa).name=M$i.readUTFString(),M$S=M$i.getUint16(),M$b=0;M$b<M$S;M$b++)M$O.bones.push(M$i.getInt16());M$O.target=M$i.readUTFString(),M$O.positionMode=M$i.readUTFString(),M$O.spacingMode=M$i.readUTFString(),M$O.rotateMode=M$i.readUTFString(),M$O.offsetRotation=M$i.getFloat32(),M$O.position=M$i.getFloat32(),M$O.spacing=M$i.getFloat32(),M$O.rotateMix=M$i.getFloat32(),M$O.translateMix=M$i.getFloat32(),this.pathArr.push(M$O)}var M$T,M$U,M$V,M$W,M$X,M$Y=0,M$Z=0,M$$=0,M$_=NaN,M$y=0,M$z=M$i.getInt16();for(M$a=0;M$a<M$z;M$a++){var M$aa=M$i.getUint8(),M$ba={};this.deformAniArr.push(M$ba);for(var M$ca=0;M$ca<M$aa;M$ca++)for((M$T=new M$Ka).skinName=M$i.getUTFString(),M$ba[M$T.skinName]=M$T,M$Y=M$i.getInt16(),M$b=0;M$b<M$Y;M$b++)for(M$U=new M$La,M$T.deformSlotDataList.push(M$U),M$Z=M$i.getInt16(),M$c=0;M$c<M$Z;M$c++)for(M$V=new M$Ma,M$U.deformSlotDisplayList.push(M$V),M$V.slotIndex=M$i.getInt16(),M$V.attachment=M$i.getUTFString(),M$$=M$i.getInt16(),M$d=0;M$d<M$$;M$d++)for(1==M$i.getByte()?M$V.tweenKeyList.push(!0):M$V.tweenKeyList.push(!1),M$_=M$i.getFloat32(),M$V.timeList.push(M$_),M$W=[],M$V.vectices.push(M$W),M$y=M$i.getInt16(),M$e=0;M$e<M$y;M$e++)M$W.push(M$i.getFloat32())}var M$da,M$ea,M$fa=M$i.getInt16(),M$ga=0,M$ha=0;for(M$a=0;M$a<M$fa;M$a++){for(M$ga=M$i.getInt16(),M$X=[],M$b=0;M$b<M$ga;M$b++){for((M$da=new M$Na).time=M$i.getFloat32(),M$ha=M$i.getInt16(),M$c=0;M$c<M$ha;M$c++)M$da.drawOrder.push(M$i.getInt16());M$X.push(M$da)}this.drawOrderAniArr.push(M$X)}var M$ia,M$ja=M$i.getInt16(),M$ka=0;for(M$a=0;M$a<M$ja;M$a++){for(M$ka=M$i.getInt16(),M$ea=[],M$b=0;M$b<M$ka;M$b++)(M$ia=new M$Oa).name=M$i.getUTFString(),M$ia.intValue=M$i.getInt32(),M$ia.floatValue=M$i.getFloat32(),M$ia.stringValue=M$i.getUTFString(),M$ia.time=M$i.getFloat32(),M$ea.push(M$ia);this.eventAniArr.push(M$ea)}var M$la=M$i.getInt16();if(0<M$la)for(this.attachmentNames=[],M$a=0;M$a<M$la;M$a++)this.attachmentNames.push(M$i.getUTFString());var M$ma,M$na,M$oa=M$i.getInt16();for(M$a=0;M$a<M$oa;M$a++)(M$ma=new M$Ja).name=M$i.readUTFString(),M$ma.parent=M$i.readUTFString(),M$ma.attachmentName=M$i.readUTFString(),M$ma.srcDisplayIndex=M$ma.displayIndex=M$i.getInt16(),(M$ma.templet=this).boneSlotDic[M$ma.name]=M$ma,null==(M$na=this.bindBoneBoneSlotDic[M$ma.parent])&&(this.bindBoneBoneSlotDic[M$ma.parent]=M$na=[]),M$na.push(M$ma),this.boneSlotArray.push(M$ma);var M$pa,M$qa,M$ra,M$sa=M$i.readUTFString().split("\n"),M$ta=0,M$ua=M$i.getUint8(),M$va=0,M$wa=0,M$xa=0,M$Aa=0,M$Ba=0,M$Ca=0,M$Da=0;for(M$a=0;M$a<M$ua;M$a++){for((M$pa=new M$Ra).name=M$sa[M$ta++],M$va=M$i.getUint8(),M$b=0;M$b<M$va;M$b++){for((M$qa=new M$Ta).name=M$sa[M$ta++],M$ma=this.boneSlotDic[M$qa.name],M$wa=M$i.getUint8(),M$c=0;M$c<M$wa;M$c++){if(M$ra=new M$Sa,this.skinSlotDisplayDataArr.push(M$ra),M$ra.name=M$sa[M$ta++],M$ra.attachmentName=M$sa[M$ta++],M$ra.transform=new M$Va,M$ra.transform.scX=M$i.getFloat32(),M$ra.transform.skX=M$i.getFloat32(),M$ra.transform.skY=M$i.getFloat32(),M$ra.transform.scY=M$i.getFloat32(),M$ra.transform.x=M$i.getFloat32(),M$ra.transform.y=M$i.getFloat32(),M$qa.displayArr.push(M$ra),M$ra.width=M$i.getFloat32(),M$ra.height=M$i.getFloat32(),M$ra.type=M$i.getUint8(),M$ra.verLen=M$i.getUint16(),0<(M$E=M$i.getUint16()))for(M$ra.bones=[],M$d=0;M$d<M$E;M$d++){var M$Ea=M$i.getUint16();M$ra.bones.push(M$Ea)}if(0<(M$xa=M$i.getUint16()))for(M$ra.uvs=[],M$d=0;M$d<M$xa;M$d++)M$ra.uvs.push(M$i.getFloat32());if(0<(M$Aa=M$i.getUint16()))for(M$ra.weights=[],M$d=0;M$d<M$Aa;M$d++)M$ra.weights.push(M$i.getFloat32());if(0<(M$Ba=M$i.getUint16()))for(M$ra.triangles=[],M$d=0;M$d<M$Ba;M$d++)M$ra.triangles.push(M$i.getUint16());if(0<(M$Ca=M$i.getUint16()))for(M$ra.vertices=[],M$d=0;M$d<M$Ca;M$d++)M$ra.vertices.push(M$i.getFloat32());if(0<(M$Da=M$i.getUint16()))for(M$ra.lengths=[],M$d=0;M$d<M$Da;M$d++)M$ra.lengths.push(M$i.getFloat32())}M$pa.slotArr.push(M$qa)}this.skinDic[M$pa.name]=M$pa,this.skinDataArray.push(M$pa)}1==M$i.getUint8()?(this.yReverseMatrix=new M$Ga(1,0,0,-1,0,0),M$D&&M$D.setTempMatrix(this.yReverseMatrix)):M$D&&M$D.setTempMatrix(new M$Ga),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},M$a.getTexture=function(M$a){var M$b=this.subTextureDic[M$a];return M$b||(M$b=this.subTextureDic[M$a.substr(0,M$a.length-1)]),null==M$b?this._mainTexture:M$b},M$a.showSkinByIndex=function(M$a,M$b,M$c){if(void 0===M$c&&(M$c=!0),M$b<0&&M$b>=this.skinDataArray.length)return!1;var M$d,M$e,M$f=0,M$g=0,M$h=this.skinDataArray[M$b];if(M$h){for(M$f=0,M$g=M$h.slotArr.length;M$f<M$g;M$f++)(M$e=M$h.slotArr[M$f])&&(M$d=M$a[M$e.name])&&(M$d.showSlotData(M$e,M$c),M$c&&"undefined"!=M$d.attachmentName&&"null"!=M$d.attachmentName?M$d.showDisplayByName(M$d.attachmentName):M$d.showDisplayByIndex(M$d.displayIndex));return!0}return!1},M$a.getSkinIndexByName=function(M$a){for(var M$b=0,M$c=this.skinDataArray.length;M$b<M$c;M$b++)if(this.skinDataArray[M$b].name==M$a)return M$b;return-1},M$a.getGrahicsDataWithCache=function(M$a,M$b){return this._graphicsCache[M$a][M$b]},M$a.setGrahicsDataWithCache=function(M$a,M$b,M$c){this._graphicsCache[M$a][M$b]=M$c},M$a.destroy=function(){var M$a;for(var M$b in this._isDestroyed=!0,this.subTextureDic)(M$a=this.subTextureDic[M$b])&&M$a.destroy();for(M$b in this._textureDic)(M$a=this._textureDic[M$b])&&M$a.destroy();for(var M$c=0,M$d=this.skinSlotDisplayDataArr.length;M$c<M$d;M$c++)this.skinSlotDisplayDataArr[M$c].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete M$e.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},M$a.getAniNameByIndex=function(M$a){var M$b=this.getAnimation(M$a);return M$b?M$b.name:null},M$f(0,M$a,"rate",function(){return this._rate},function(M$a){this._rate=M$a}),M$e.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",M$e.TEMPLET_DICTIONARY=null,M$e}(M$K)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(M$a,M$b){"use strict";for(var M$c in Object.defineProperty(M$b,"__esModule",{value:!0}),Laya){var M$d=Laya[M$c];M$d&&M$d.__isclass&&(M$b[M$c]=M$d)}});