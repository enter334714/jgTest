var Laya=window.Laya=function(n$j,n$a){var n$k={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(n$a,n$b){return 1==arguments.length?n$k.__presubstr.call(this,n$a):n$k.__presubstr.call(this,n$a,0<n$b?n$b:this.length+n$b)},__init:function(n$a){n$a.forEach(function(n$a){n$a.__init$&&n$a.__init$()})},__isClass:function(n$a){return n$a&&(n$a.__isclass||n$a==Object||n$a==String||n$a==Array)},__newvec:function(n$a,n$b){var n$c=[];n$c.length=n$a;for(var n$d=0;n$d<n$a;n$d++)n$c[n$d]=n$b;return n$c},__extend:function(n$a,n$b){for(var n$c in n$b)if(n$b.hasOwnProperty(n$c)){var n$d=Object.getOwnPropertyDescriptor(n$b,n$c),n$e=n$d.get,n$f=n$d.set;n$e||n$f?n$e&&n$f?Object.defineProperty(n$a,n$c,n$d):(n$e&&Object.defineProperty(n$a,n$c,n$e),n$f&&Object.defineProperty(n$a,n$c,n$f)):n$a[n$c]=n$b[n$c]}function n$g(){n$k.un(this,"constructor",n$a)}n$g.prototype=n$b.prototype,n$a.prototype=new n$g,n$k.un(n$a.prototype,"__imps",n$k.__copy({},n$b.prototype.__imps))},__copy:function(n$a,n$b){if(!n$b)return null;for(var n$c in n$a=n$a||{},n$b)n$a[n$c]=n$b[n$c];return n$a},__package:function(n$a,n$b){if(!n$k.__packages[n$a]){n$k.__packages[n$a]=!0;var n$c=n$j,n$d=n$a.split(".");if(1<n$d.length)for(var n$e=0,n$f=n$d.length-1;n$e<n$f;n$e++){var n$g=n$c[n$d[n$e]];n$c=n$g||(n$c[n$d[n$e]]={})}n$c[n$d[n$d.length-1]]||(n$c[n$d[n$d.length-1]]=n$b||{})}},__hasOwnProperty:function(n$a,n$b){return n$b=n$b||this,Object.hasOwnProperty.call(n$b,n$a)||function n$a(n$b,n$c){if(Object.hasOwnProperty.call(n$c.prototype,n$b))return!0;var n$d=n$c.prototype.__super;return null==n$d?null:n$a(n$b,n$d)}(n$a,n$b.__class)},__typeof:function(n$a,n$b){if(!n$a||!n$b)return!1;if(n$b===String)return"string"==typeof n$a;if(n$b===Number)return"number"==typeof n$a;if(n$b.__interface__)n$b=n$b.__interface__;else if("string"!=typeof n$b)return n$a instanceof n$b;return n$a.__imps&&n$a.__imps[n$b]||n$a.__class==n$b},__as:function(n$a,n$b){return this.__typeof(n$a,n$b)?n$a:null},__int:function(n$a){return n$a?parseInt(n$a):0},interface:function(n$a,n$b){n$k.__package(n$a,{});var n$c=n$k.__internals,n$d=n$c[n$a]=n$c[n$a]||{self:n$a};if(n$b){var n$e=n$b.split(",");n$d.extend=[];for(var n$f=0;n$f<n$e.length;n$f++){var n$g=n$e[n$f];n$c[n$g]=n$c[n$g]||{self:n$g},n$d.extend.push(n$c[n$g])}}var n$h=n$j,n$i=n$a.split(".");for(n$f=0;n$f<n$i.length-1;n$f++)n$h=n$h[n$i[n$f]];n$h[n$i[n$i.length-1]]={__interface__:n$a}},class:function(n$a,n$b,n$c,n$d){if(n$c&&n$k.__extend(n$a,n$c),n$b)if(n$k.__package(n$b,n$a),n$k.__classmap[n$b]=n$a,0<n$b.indexOf(".")){if(0==n$b.indexOf("laya.")){var n$e=n$b.split(".");n$d=n$d||n$e[n$e.length-1],n$k[n$d]&&console.log("Warning!,this class["+n$d+"] already exist:",n$k[n$d]),n$k[n$d]=n$a}}else"Main"==n$b?n$j.Main=n$a:"MainWX"==n$b?n$j.MainWX=n$a:(n$k[n$b]&&console.log("Error!,this class["+n$b+"] already exist:",n$k[n$b]),n$k[n$b]=n$a);var n$f=n$k.un,n$g=n$a.prototype;n$f(n$g,"hasOwnProperty",n$k.__hasOwnProperty),n$f(n$g,"__class",n$a),n$f(n$g,"__super",n$c),n$f(n$g,"__className",n$b),n$f(n$a,"__super",n$c),n$f(n$a,"__className",n$b),n$f(n$a,"__isclass",!0),n$f(n$a,"super",function(n$a){this.__super.call(n$a)})},imps:function(n$a,n$b){if(!n$b)return null;var n$e=n$a.__imps||n$k.un(n$a,"__imps",{});function n$f(n$a){var n$b,n$c;if((n$b=n$k.__internals[n$a])&&(n$e[n$a]=!0,n$c=n$b.extend))for(var n$d=0;n$d<n$c.length;n$d++)n$f(n$c[n$d].self)}for(var n$c in n$b)n$f(n$c)},superSet:function(n$a,n$b,n$c,n$d){var n$e=n$a.prototype["_$set_"+n$c];n$e&&n$e.call(n$b,n$d)},superGet:function(n$a,n$b,n$c){var n$d=n$a.prototype["_$get_"+n$c];return n$d?n$d.call(n$b):null},getset:function(n$a,n$b,n$c,n$d,n$e){n$a?(n$d&&(n$b["_$GET_"+n$c]=n$d),n$e&&(n$b["_$SET_"+n$c]=n$e)):(n$d&&n$k.un(n$b,"_$get_"+n$c,n$d),n$e&&n$k.un(n$b,"_$set_"+n$c,n$e)),n$d&&n$e?Object.defineProperty(n$b,n$c,{get:n$d,set:n$e,enumerable:!1,configurable:!0}):(n$d&&Object.defineProperty(n$b,n$c,{get:n$d,enumerable:!1,configurable:!0}),n$e&&Object.defineProperty(n$b,n$c,{set:n$e,enumerable:!1,configurable:!0}))},static:function(n$c,n$d){for(var n$e=0,n$a=n$d.length;n$e<n$a;n$e+=2)if("length"==n$d[n$e])n$c.length=n$d[n$e+1].call(n$c);else{function n$b(){var n$b=n$d[n$e],n$a=n$d[n$e+1];Object.defineProperty(n$c,n$b,{get:function(){return delete this[n$b],this[n$b]=n$a.call(this)},set:function(n$a){delete this[n$b],this[n$b]=n$a},enumerable:!0,configurable:!0})}n$b()}},un:function(n$a,n$b,n$c){return n$c||(n$c=n$a[n$b]),n$k.__propun.value=n$c,Object.defineProperty(n$a,n$b,n$k.__propun),n$c},uns:function(n$b,n$a){n$a.forEach(function(n$a){n$k.un(n$b,n$a)})}};return n$j.console=n$j.console||{log:function(){}},n$j.trace=n$j.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),n$k}(window,document);!function(n$a,n$b,n$c){n$c.un,n$c.uns,n$c.static,n$c.class,n$c.getset,n$c.__newvec}(window,document,Laya),function(n$g,n$b,n$x){n$x.un,n$x.uns;var n$i=n$x.static,n$k=n$x.class,n$o=n$x.getset;n$x.__newvec;n$x.interface("laya.runtime.IMarket"),n$x.interface("laya.filters.IFilter"),n$x.interface("laya.display.ILayout"),n$x.interface("laya.resource.IDispose"),n$x.interface("laya.runtime.IPlatform"),n$x.interface("laya.resource.IDestroy"),n$x.interface("laya.runtime.IConchNode"),n$x.interface("laya.filters.IFilterAction"),n$x.interface("laya.runtime.ICPlatformClass"),n$x.interface("laya.resource.ICreateResource"),n$x.interface("laya.runtime.IConchRenderObject"),n$x.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var n$F=function(){function n$f(){}return n$k(n$f,"laya.utils.RunDriver"),n$f.FILTER_ACTIONS=[],n$f.pixelRatio=-1,n$f._charSizeTestDiv=null,n$f.now=function(){return Date.now()},n$f.getWindow=function(){return n$g},n$f.getPixelRatio=function(){if(n$f.pixelRatio<0){var n$a=n$O.context,n$b=n$a.backingStorePixelRatio||n$a.webkitBackingStorePixelRatio||n$a.mozBackingStorePixelRatio||n$a.msBackingStorePixelRatio||n$a.oBackingStorePixelRatio||n$a.backingStorePixelRatio||1;(n$f.pixelRatio=(n$O.window.devicePixelRatio||1)/n$b)<1&&(n$f.pixelRatio=1)}return n$f.pixelRatio},n$f.getIncludeStr=function(n$a){return null},n$f.createShaderCondition=function(n$a){var n$b="(function() {return "+n$a+";})";return n$x._runScript(n$b)},n$f.fontMap=[],n$f.measureText=function(n$a,n$b){var n$c=n$f.hanzi.test(n$a);if(n$c&&n$f.fontMap[n$b])return n$f.fontMap[n$b];var n$d=n$O.context;n$d.font=n$b;var n$e=n$d.measureText(n$a);return n$c&&(n$f.fontMap[n$b]=n$e),n$e},n$f.getWebGLContext=function(n$a){},n$f.beginFlush=function(){},n$f.endFinish=function(){},n$f.addToAtlas=null,n$f.flashFlushImage=function(n$a){},n$f.drawToCanvas=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=n$ta.create("2D"),n$h=new n$K(n$c,n$d,n$g);return n$L.renders[n$b]._fun(n$a,n$h,n$e,n$f),n$g},n$f.createParticleTemplate2D=null,n$f.createGLTextur=null,n$f.createWebGLContext2D=null,n$f.changeWebGLSize=function(n$a,n$b){},n$f.createRenderSprite=function(n$a,n$b){return new n$L(n$a,n$b)},n$f.createFilterAction=function(n$a){return new n$t},n$f.createGraphics=function(){return new n$m},n$f.clear=function(n$a){n$J._context.ctx.clear()},n$f.cancelLoadByUrl=function(n$a){},n$f.clearAtlas=function(n$a){},n$f.isAtlas=function(n$a){return!1},n$f.addTextureToAtlas=function(n$a){},n$f.getTexturePixels=function(n$a,n$b,n$c,n$d,n$e){return null},n$f.skinAniSprite=function(){return null},n$f.update3DLoop=function(){},n$i(n$f,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),n$f}(),n$d=(n$o(1,n$x,"alertGlobalError",null,function(n$a){var n$f=0;n$O.window.onerror=n$a?function(n$a,n$b,n$c,n$d,n$e){n$f++<5&&n$e&&alert(n$e.stack||n$e)}:null}),n$x.init=function(n$a,n$b,n$c){for(var n$d=[],n$e=2,n$f=arguments.length;n$e<n$f;n$e++)n$d.push(arguments[n$e]);if(!n$x._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=n$x._arrayBufferSlice),n$x._isinit=!0,n$O.__init__(),n$M.__init__(),n$m.__init__(),n$x.timer=new n$Y,n$x.scaleTimer=new n$Y,n$x.loader=new n$ia,n$A.__init__(),n$e=0;for(var n$g=n$d.length;n$e<n$g;n$e++)n$d[n$e].enable&&n$d[n$e].enable();return n$n.__init__(),n$h.__init__(),n$N.__init__(),n$Q.beginCheck(),n$x._currentStage=n$x.stage=new n$ra,n$x.stage.conchModel&&n$x.stage.conchModel.setRootNode(),n$x._getUrlPath(),n$x.render=new n$J(0,0),n$x.stage.size(n$a,n$b),n$L.__init__(),n$l.__init__(),n$p.instance.__init__(n$x.stage,n$J.canvas),n$va.__init__(),n$E.autoStopMusic=!0,n$C.__init__(),n$J.canvas}},n$x._getUrlPath=function(){var n$a=n$O.window.location,n$b=n$a.pathname;n$b=n$b&&":"==n$b.charAt(2)?n$b.substring(1):n$b,n$I.rootPath=n$I.basePath=n$I.getPath("file:"==n$a.protocol?n$b:n$a.protocol+"//"+n$a.host+n$a.pathname)},n$x._arrayBufferSlice=function(n$a,n$b){var n$c=new Uint8Array(this,n$a,n$b-n$a),n$d=new Uint8Array(n$c.length);return n$d.set(n$c),n$d.buffer},n$x._runScript=function(n$a){return n$O.window[n$x._evcode](n$a)},n$x.stage=null,n$x.timer=null,n$x.scaleTimer=null,n$x.loader=null,n$x.version="1.8.6",n$x.render=null,n$x._currentStage=null,n$x._isinit=!1,n$x.isDebug=!1,n$x.MiniAdpter={init:function(){n$g.navigator&&n$g.navigator.userAgent&&-1<n$g.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},n$i(n$x,["conchMarket",function(){return this.conchMarket=n$g.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=n$g.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function n$a(){}return n$k(n$a,"Config"),n$a.WebGLTextCacheCount=500,n$a.atlasEnable=!1,n$a.showCanvasMark=!1,n$a.animationInterval=50,n$a.isAntialias=!1,n$a.isAlpha=!1,n$a.premultipliedAlpha=!0,n$a.isStencil=!0,n$a.preserveDrawingBuffer=!1,n$a}()),n$j=function(){function n$j(){this._events=null}n$k(n$j,"laya.events.EventDispatcher");var n$a=n$j.prototype;return n$a.hasListener=function(n$a){return!!(this._events&&this._events[n$a])},n$a.event=function(n$a,n$b){if(!this._events||!this._events[n$a])return!1;var n$c=this._events[n$a];if(n$c.lock)n$c.queue||(n$c.queue=[]),n$c.queue.push(n$b);else{var n$d;for(n$c.lock=!0,n$c.cursor=n$c.head;n$c.cursor;)n$d=n$c.cursor,n$c.cursor=n$d.next,n$d.once&&n$j.delNode(n$c,n$d),null!=n$b?n$d.args?n$d.method.apply(n$d.caller,n$d.args.concat(n$b)):n$b instanceof Array?n$d.method.apply(n$d.caller,n$b):n$d.method.call(n$d.caller,n$b):n$d.method.apply(n$d.caller,n$d.args),n$d.once&&n$j.recoverHandler(n$d);n$c.lock=!1,!n$c.head&&this._events&&this._events[n$a]==n$c&&delete this._events[n$a],n$c.queue&&n$c.queue.length&&this.event(n$a,n$c.queue.shift())}return!0},n$a.on=function(n$a,n$b,n$c,n$d){return this._createListener(n$a,n$b,n$c,n$d,!1)},n$a.once=function(n$a,n$b,n$c,n$d){return this._createListener(n$a,n$b,n$c,n$d,!0)},n$a._createListener=function(n$a,n$b,n$c,n$d,n$e,n$f){void 0===n$f&&(n$f=!0),n$f&&this.off(n$a,n$b,n$c,n$e);var n$g=n$j.createHandler(n$b||this,n$c,n$d,n$e);this._events||(this._events={});var n$h=this._events,n$i=n$h[n$a];return n$i?n$i.tail?(n$g.prev=n$i.tail,n$i.tail.next=n$g,n$i.tail=n$g):n$i.head=n$i.tail=n$g:n$h[n$a]={head:n$g,tail:n$g,cursor:null,lock:!1},this},n$a.off=function(n$a,n$b,n$c,n$d){if(void 0===n$d&&(n$d=!1),!this._events||!this._events[n$a])return this;for(var n$e=this._events[n$a],n$f=n$e.head;n$f;){if((!n$b||n$f.caller===n$b)&&n$f.method===n$c&&(!n$d||n$f.once)){n$j.delNode(n$e,n$f),n$e.cursor==n$f&&(n$e.cursor=n$f.next),n$j.recoverHandler(n$f);break}n$f=n$f.next}return this},n$a.offAll=function(n$a){var n$b=this._events;if(!n$b)return this;if(n$a)this._recoverHandlers(n$b[n$a]),delete n$b[n$a];else{for(var n$c in n$b)this._recoverHandlers(n$b[n$c]);this._events=null}return this},n$a._recoverHandlers=function(n$a){if(n$a){for(var n$b=n$a.head;n$b;){n$j.delNode(n$a,n$b);var n$c=n$b.next;n$j.recoverHandler(n$b),n$b=n$c}n$a.cursor=null}},n$a.isMouseEvent=function(n$a){return n$j.MOUSE_EVENTS[n$a]},n$j.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},n$j.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},n$j.delNode=function(n$a,n$b){n$b.prev?n$b.prev.next=n$b.next:n$a.head=n$b.next,n$b.next?n$b.next.prev=n$b.prev:n$a.tail=n$b.prev},n$j.createHandler=function(n$a,n$b,n$c,n$d){var n$e=n$j._freeHandler;return n$e?(n$j._freeCount--,n$j._freeHandler=n$e.next,n$e.caller=n$a,n$e.method=n$b,n$e.args=n$c,n$e.once=n$d):n$e={caller:n$a,method:n$b,args:n$c,once:n$d},n$e.prev=n$e.next=null,n$e},n$j.recoverHandler=function(n$a){n$a.caller=n$a.method=n$a.args=n$a.prev=null,n$a.next=n$j._freeHandler,n$j._freeHandler=n$a,n$j._freeCount++},n$j._freeHandler=null,n$j._freeCount=0,n$j}(),n$s=function(){function n$e(n$a,n$b,n$c,n$d){this.once=!1,void(this._id=0)===n$d&&(n$d=!1),this.setTo(n$a,n$b,n$c,n$d)}n$k(n$e,"laya.utils.Handler");var n$a=n$e.prototype;return n$a.setTo=function(n$a,n$b,n$c,n$d){return this._id=n$e._gid++,this.caller=n$a,this.method=n$b,this.args=n$c,this.once=n$d,this},n$a.run=function(){if(null==this.method)return null;var n$a=this._id,n$b=this.method.apply(this.caller,this.args);return this._id===n$a&&this.once&&this.recover(),n$b},n$a.runWith=function(n$a){if(null==this.method)return null;var n$b=this._id;if(null==n$a)var n$c=this.method.apply(this.caller,this.args);else n$c=this.args||n$a.unshift?this.args?this.method.apply(this.caller,this.args.concat(n$a)):this.method.apply(this.caller,n$a):this.method.call(this.caller,n$a);return this._id===n$b&&this.once&&this.recover(),n$c},n$a.clear=function(){return this.caller=null,this.method=null,this.args=null,this},n$a.recover=function(){0<this._id&&(this._id=0,this.clear())},n$e.create=function(n$a,n$b,n$c,n$d){return void 0===n$d&&(n$d=!0),new n$e(n$a,n$b,n$c,n$d)},n$e._gid=1,n$e}(),n$D=function(){function n$a(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}n$k(n$a,"laya.display.BitmapFont");var n$b=n$a.prototype;return n$b.loadFont=function(n$a,n$b){this._path=n$a,this._complete=n$b,n$x.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],n$s.create(this,this.onLoaded))},n$b.onLoaded=function(){this.parseFont(n$ha.getRes(this._path),n$ha.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},n$b.parseFont=function(n$a,n$b){if(null!=n$a&&null!=n$b){this._texture=n$b;var n$c=n$a.getElementsByTagName("info");if(!n$c[0].getAttributeNode)return this.parseFont2(n$a,n$b);this.fontSize=parseInt(n$c[0].getAttributeNode("size").nodeValue);var n$d,n$e=n$c[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(n$e[0]),parseInt(n$e[1]),parseInt(n$e[2]),parseInt(n$e[3])],n$d=n$a.getElementsByTagName("char");var n$f=0;for(n$f=0;n$f<n$d.length;n$f++){var n$g=n$d[n$f],n$h=parseInt(n$g.getAttributeNode("id").nodeValue),n$i=parseInt(n$g.getAttributeNode("xoffset").nodeValue)/1,n$j=parseInt(n$g.getAttributeNode("yoffset").nodeValue)/1,n$k=parseInt(n$g.getAttributeNode("xadvance").nodeValue)/1,n$l=new n$z;n$l.x=parseInt(n$g.getAttributeNode("x").nodeValue),n$l.y=parseInt(n$g.getAttributeNode("y").nodeValue),n$l.width=parseInt(n$g.getAttributeNode("width").nodeValue),n$l.height=parseInt(n$g.getAttributeNode("height").nodeValue);var n$m=n$ka.create(n$b,n$l.x,n$l.y,n$l.width,n$l.height,n$i,n$j);this._maxWidth=Math.max(this._maxWidth,n$k+this.letterSpacing),this._fontCharDic[n$h]=n$m,this._fontWidthMap[n$h]=n$k}}},n$b.parseFont2=function(n$a,n$b){if(null!=n$a&&null!=n$b){this._texture=n$b;var n$c=n$a.getElementsByTagName("info");this.fontSize=parseInt(n$c[0].attributes.size.nodeValue);var n$d=n$c[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(n$d[0]),parseInt(n$d[1]),parseInt(n$d[2]),parseInt(n$d[3])];var n$e=n$a.getElementsByTagName("char"),n$f=0;for(n$f=0;n$f<n$e.length;n$f++){var n$g=n$e[n$f].attributes,n$h=parseInt(n$g.id.nodeValue),n$i=parseInt(n$g.xoffset.nodeValue)/1,n$j=parseInt(n$g.yoffset.nodeValue)/1,n$k=parseInt(n$g.xadvance.nodeValue)/1,n$l=new n$z;n$l.x=parseInt(n$g.x.nodeValue),n$l.y=parseInt(n$g.y.nodeValue),n$l.width=parseInt(n$g.width.nodeValue),n$l.height=parseInt(n$g.height.nodeValue);var n$m=n$ka.create(n$b,n$l.x,n$l.y,n$l.width,n$l.height,n$i,n$j);this._maxWidth=Math.max(this._maxWidth,n$k+this.letterSpacing),this._fontCharDic[n$h]=n$m,this._fontWidthMap[n$h]=n$k}}},n$b.getCharTexture=function(n$a){return this._fontCharDic[n$a.charCodeAt(0)]},n$b.destroy=function(){if(this._texture){for(var n$a in this._fontCharDic){var n$b=this._fontCharDic[n$a];n$b&&n$b.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},n$b.setSpaceWidth=function(n$a){this._spaceWidth=n$a},n$b.getCharWidth=function(n$a){var n$b=n$a.charCodeAt(0);return this._fontWidthMap[n$b]?this._fontWidthMap[n$b]+this.letterSpacing:" "==n$a?this._spaceWidth+this.letterSpacing:0},n$b.getTextWidth=function(n$a){for(var n$b=0,n$c=0,n$d=n$a.length;n$c<n$d;n$c++)n$b+=this.getCharWidth(n$a.charAt(n$c));return n$b},n$b.getMaxWidth=function(){return this._maxWidth},n$b.getMaxHeight=function(){return this.fontSize},n$b.drawText=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g,n$h=this.getTextWidth(n$a),n$i=0;"center"===n$e&&(n$i=(n$f-n$h)/2),"right"===n$e&&(n$i=n$f-n$h);for(var n$j=0,n$k=0,n$l=n$a.length;n$k<n$l;n$k++)(n$g=this.getCharTexture(n$a.charAt(n$k)))&&(n$b.graphics.drawTexture(n$g,n$c+n$j+n$i,n$d),n$j+=this.getCharWidth(n$a.charAt(n$k)))},n$a}(),n$h=function(){function n$c(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=n$c._TF_EMPTY}n$k(n$c,"laya.display.css.Style");var n$a=n$c.prototype;return n$a.getTransform=function(){return this._tf},n$a.setTransform=function(n$a){this._tf="none"!==n$a&&n$a?n$a:n$c._TF_EMPTY},n$a.setTranslateX=function(n$a){this._tf===n$c._TF_EMPTY&&(this._tf=new n$e),this._tf.translateX=n$a},n$a.setTranslateY=function(n$a){this._tf===n$c._TF_EMPTY&&(this._tf=new n$e),this._tf.translateY=n$a},n$a.setScaleX=function(n$a){this._tf===n$c._TF_EMPTY&&(this._tf=new n$e),this._tf.scaleX=n$a},n$a.setScale=function(n$a,n$b){this._tf===n$c._TF_EMPTY&&(this._tf=new n$e),this._tf.scaleX=n$a,this._tf.scaleY=n$b},n$a.setScaleY=function(n$a){this._tf===n$c._TF_EMPTY&&(this._tf=new n$e),this._tf.scaleY=n$a},n$a.setRotate=function(n$a){this._tf===n$c._TF_EMPTY&&(this._tf=new n$e),this._tf.rotate=n$a},n$a.setSkewX=function(n$a){this._tf===n$c._TF_EMPTY&&(this._tf=new n$e),this._tf.skewX=n$a},n$a.setSkewY=function(n$a){this._tf===n$c._TF_EMPTY&&(this._tf=new n$e),this._tf.skewY=n$a},n$a.destroy=function(){this.scrollRect=null},n$a.render=function(n$a,n$b,n$c,n$d){},n$a.getCSSStyle=function(){return n$ba.EMPTY},n$a._enableLayout=function(){return!1},n$o(0,n$a,"scaleX",function(){return this._tf.scaleX},function(n$a){this.setScaleX(n$a)}),n$o(0,n$a,"transform",function(){return this.getTransform()},function(n$a){this.setTransform(n$a)}),n$o(0,n$a,"translateX",function(){return this._tf.translateX},function(n$a){this.setTranslateX(n$a)}),n$o(0,n$a,"translateY",function(){return this._tf.translateY},function(n$a){this.setTranslateY(n$a)}),n$o(0,n$a,"scaleY",function(){return this._tf.scaleY},function(n$a){this.setScaleY(n$a)}),n$o(0,n$a,"block",function(){return 0!=(1&this._type)}),n$o(0,n$a,"skewY",function(){return this._tf.skewY},function(n$a){this.setSkewY(n$a)}),n$o(0,n$a,"rotate",function(){return this._tf.rotate},function(n$a){this.setRotate(n$a)}),n$o(0,n$a,"skewX",function(){return this._tf.skewX},function(n$a){this.setSkewX(n$a)}),n$o(0,n$a,"paddingLeft",function(){return 0}),n$o(0,n$a,"paddingTop",function(){return 0}),n$o(0,n$a,"absolute",function(){return!0}),n$c.__init__=function(){n$c._TF_EMPTY=new n$e,n$c.EMPTY=new n$c},n$c.EMPTY=null,n$c._TF_EMPTY=null,n$c}(),n$n=function(){function n$b(n$a){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=n$S.create(n$b.defaultColor),this.family=n$b.defaultFamily,this.stroke=n$b._STROKE,this.size=n$b.defaultSize,n$a&&n$a!==n$b.EMPTY&&n$a.copyTo(this)}n$k(n$b,"laya.display.css.Font");var n$a=n$b.prototype;return n$a.set=function(n$a){this._text=null;for(var n$b=n$a.split(" "),n$c=0,n$d=n$b.length;n$c<n$d;n$c++){var n$e=n$b[n$c];switch(n$e){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<n$e.indexOf("px")&&(this.size=parseInt(n$e),this.family=n$b[n$c+1],n$c++)}},n$a.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},n$a.copyTo=function(n$a){n$a._type=this._type,n$a._text=this._text,n$a._weight=this._weight,n$a._color=this._color,n$a.family=this.family,n$a.stroke=this.stroke!=n$b._STROKE?this.stroke.slice():n$b._STROKE,n$a.indent=this.indent,n$a.size=this.size},n$o(0,n$a,"password",function(){return 0!=(1024&this._type)},function(n$a){n$a?this._type|=1024:this._type&=-1025}),n$o(0,n$a,"color",function(){return this._color.strColor},function(n$a){this._color=n$S.create(n$a)}),n$o(0,n$a,"italic",function(){return 0!=(512&this._type)},function(n$a){n$a?this._type|=512:this._type&=-513}),n$o(0,n$a,"bold",function(){return 0!=(2048&this._type)},function(n$a){n$a?this._type|=2048:this._type&=-2049}),n$o(0,n$a,"weight",function(){return""+this._weight},function(n$a){var n$b=0;switch(n$a){case"normal":break;case"bold":this.bold=!0,n$b=700;break;case"bolder":n$b=800;break;case"lighter":n$b=100;break;default:n$b=parseInt(n$a)}this._weight=n$b,this._text=null}),n$o(0,n$a,"decoration",function(){return this._decoration?this._decoration.value:null},function(n$a){var n$b=n$a.split(" ");switch(this._decoration||(this._decoration={}),n$b[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=n$b[0]}n$b[1]&&(this._decoration.color=n$S.create(n$b)),this._decoration.value=n$a}),n$b.__init__=function(){n$b.EMPTY=new n$b(null)},n$b.EMPTY=null,n$b.defaultColor="#000000",n$b.defaultSize=12,n$b.defaultFamily="Arial",n$b.defaultFont="12px Arial",n$b._STROKE=[0,"#000000"],n$b._ITALIC=512,n$b._PASSWORD=1024,n$b._BOLD=2048,n$b}(),n$e=function(){function n$a(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return n$k(n$a,"laya.display.css.TransformInfo"),n$a}(),n$m=function(){function n$l(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,n$J.isConchNode){this._nativeObj=new n$g._conchGraphics,this.id=this._nativeObj.conchID}}n$k(n$l,"laya.display.Graphics");var n$a=n$l.prototype;return n$a.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},n$a.clear=function(n$a){void 0===n$a&&(n$a=!1);var n$b=0,n$c=0;if(n$a){var n$d=this._one;if(this._cmds){for(n$c=this._cmds.length,n$b=0;n$b<n$c;n$b++)!(n$d=this._cmds[n$b])||n$d.callee!==n$J._context._drawTexture&&n$d.callee!==n$J._context._drawTextureWithTransform||(n$d[0]=null,n$l._cache.push(n$d));this._cmds.length=0}else n$d&&(!n$d||n$d.callee!==n$J._context._drawTexture&&n$d.callee!==n$J._context._drawTextureWithTransform||(n$d[0]=null,n$l._cache.push(n$d)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(n$b=0,n$c=this._vectorgraphArray.length;n$b<n$c;n$b++)n$_.getInstance().deleteShape(this._vectorgraphArray[n$b]);this._vectorgraphArray.length=0}},n$a._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},n$a._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new n$c,this._graphicBounds._graphics=this)},n$a._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},n$a._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},n$a.getBounds=function(n$a){return void 0===n$a&&(n$a=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(n$a)},n$a.getBoundPoints=function(n$a){return void 0===n$a&&(n$a=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(n$a)},n$a._addCmd=function(n$a){this._cmds=this._cmds||[],n$a.callee=n$a.shift(),this._cmds.push(n$a)},n$a.setFilters=function(n$a){this._saveToCmd(n$J._context._setFilters,n$a)},n$a.drawTexture=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){if(void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=0),void 0===n$e&&(n$e=0),void 0===n$g&&(n$g=1),!n$a||n$g<.01)return null;n$d||(n$d=n$a.sourceWidth),n$e||(n$e=n$a.sourceHeight),n$g=n$g<0?0:1<n$g?1:n$g;var n$h,n$i=!n$J.isWebGL&&(n$O.onFirefox||n$O.onEdge||n$O.onIE||n$O.onSafari)?.5:0,n$j=n$d/n$a.sourceWidth,n$k=n$e/n$a.sourceHeight;return n$d=n$a.width*n$j,n$e=n$a.height*n$k,n$a.loaded&&(n$d<=0||n$e<=0)?null:(n$b+=n$a.offsetX*n$j,n$c+=n$a.offsetY*n$k,this._sp&&(this._sp._renderType|=512),n$b-=n$i,n$c-=n$i,n$d+=2*n$i,n$e+=2*n$i,n$l._cache.length?((n$h=n$l._cache.pop())[0]=n$a,n$h[1]=n$b,n$h[2]=n$c,n$h[3]=n$d,n$h[4]=n$e,n$h[5]=n$f,n$h[6]=n$g):n$h=[n$a,n$b,n$c,n$d,n$e,n$f,n$g],n$h.callee=n$f||1!=n$g?n$J._context._drawTextureWithTransform:n$J._context._drawTexture,null!=this._one||n$f||1!=n$g?this._saveToCmd(n$h.callee,n$h):(this._one=n$h,this._render=this._renderOneImg),n$a.loaded||n$a.once("loaded",this,this._textureLoaded,[n$a,n$h]),this._repaint(),n$h)},n$a.cleanByTexture=function(n$a,n$b,n$c,n$d,n$e){if(void 0===n$d&&(n$d=0),void 0===n$e&&(n$e=0),!n$a)return this.clear();if(this._one&&this._render===this._renderOneImg){n$d||(n$d=n$a.sourceWidth),n$e||(n$e=n$a.sourceHeight);var n$f=n$d/n$a.sourceWidth,n$g=n$e/n$a.sourceHeight;n$d=n$a.width*n$f,n$e=n$a.height*n$g,n$b+=n$a.offsetX*n$f,n$c+=n$a.offsetY*n$g,this._one[0]=n$a,this._one[1]=n$b,this._one[2]=n$c,this._one[3]=n$d,this._one[4]=n$e,this._repaint()}else this.clear(),n$a&&this.drawTexture(n$a,n$b,n$c,n$d,n$e)},n$a.drawTextures=function(n$a,n$b){n$a&&this._saveToCmd(n$J._context._drawTextures,[n$a,n$b])},n$a.fillTexture=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){if(void 0===n$d&&(n$d=0),void 0===n$e&&(n$e=0),void 0===n$f&&(n$f="repeat"),n$a){var n$h=[n$a,n$b,n$c,n$d,n$e,n$f,n$g||n$y.EMPTY,{}];n$a.loaded||n$a.once("loaded",this,this._textureLoaded,[n$a,n$h]),this._saveToCmd(n$J._context._fillTexture,n$h)}},n$a._textureLoaded=function(n$a,n$b){n$b[3]=n$b[3]||n$a.width,n$b[4]=n$b[4]||n$a.height,this._repaint()},n$a.fillCircle=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){n$c.bitmap.enableMerageInAtlas=!1;var n$h=new Float32Array(2*(n$g+1)),n$i=new Float32Array(2*(n$g+1)),n$j=new Uint16Array(3*n$g),n$k=2*Math.PI/n$g,n$l=0;n$h[0]=n$d,n$h[1]=n$e,n$i[0]=n$d/n$c.width,n$i[1]=n$e/n$c.height;for(var n$m=2,n$n=0;n$n<n$g;n$n++){var n$o=n$f*Math.cos(n$l)+n$d,n$p=n$f*Math.sin(n$l)+n$e;n$h[n$m]=n$o,n$h[n$m+1]=n$p,n$i[n$m]=n$o/n$c.width,n$i[n$m+1]=n$p/n$c.height,n$l+=n$k,n$m+=2}for(n$n=n$m=0;n$n<n$g;n$n++)n$j[n$m++]=0,n$j[n$m++]=n$n+1,n$j[n$m++]=n$g+1<=n$n+2?1:n$n+2;this.drawTriangles(n$c,n$a,n$b,n$h,n$i,n$j)},n$a.drawTriangles=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){void 0===n$h&&(n$h=1),this._saveToCmd(n$J._context.drawTriangles,[n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j])},n$a._saveToCmd=function(n$a,n$b){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=n$b,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(n$b)),n$b.callee=n$a,this._repaint(),n$b},n$a.clipRect=function(n$a,n$b,n$c,n$d){this._saveToCmd(n$J._context._clipRect,[n$a,n$b,n$c,n$d])},n$a.fillText=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){void 0===n$g&&(n$g=0),this._saveToCmd(n$J._context._fillText,[n$a,n$b,n$c,n$d||n$n.defaultFont,n$e,n$f])},n$a.fillBorderText=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){this._saveToCmd(n$J._context._fillBorderText,[n$a,n$b,n$c,n$d||n$n.defaultFont,n$e,n$f,n$g,n$h])},n$a.strokeText=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this._saveToCmd(n$J._context._strokeText,[n$a,n$b,n$c,n$d||n$n.defaultFont,n$e,n$f,n$g])},n$a.alpha=function(n$a){n$a=n$a<0?0:1<n$a?1:n$a,this._saveToCmd(n$J._context._alpha,[n$a])},n$a.setAlpha=function(n$a){n$a=n$a<0?0:1<n$a?1:n$a,this._saveToCmd(n$J._context._setAlpha,[n$a])},n$a.transform=function(n$a,n$b,n$c){void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),this._saveToCmd(n$J._context._transform,[n$a,n$b,n$c])},n$a.rotate=function(n$a,n$b,n$c){void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),this._saveToCmd(n$J._context._rotate,[n$a,n$b,n$c])},n$a.scale=function(n$a,n$b,n$c,n$d){void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=0),this._saveToCmd(n$J._context._scale,[n$a,n$b,n$c,n$d])},n$a.translate=function(n$a,n$b){this._saveToCmd(n$J._context._translate,[n$a,n$b])},n$a.save=function(){this._saveToCmd(n$J._context._save,[])},n$a.restore=function(){this._saveToCmd(n$J._context._restore,[])},n$a.replaceText=function(n$a){this._repaint();var n$b=this._cmds;if(n$b){for(var n$c=n$b.length-1;-1<n$c;n$c--)if(this._isTextCmd(n$b[n$c].callee))return n$b[n$c][0].toUpperCase?n$b[n$c][0]=n$a:n$b[n$c][0].setText(n$a),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=n$a:this._one[0].setText(n$a),!0;return!1},n$a._isTextCmd=function(n$a){return n$a===n$J._context._fillText||n$a===n$J._context._fillBorderText||n$a===n$J._context._strokeText},n$a.replaceTextColor=function(n$a){this._repaint();var n$b=this._cmds;if(n$b)for(var n$c=n$b.length-1;-1<n$c;n$c--)this._isTextCmd(n$b[n$c].callee)&&(n$b[n$c][4]=n$a,n$b[n$c][0].toUpperCase||(n$b[n$c][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=n$a,this._one[0].toUpperCase||(this._one[0].changed=!0))},n$a.loadImage=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=this;void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=0),void 0===n$e&&(n$e=0);var n$h=n$ha.getRes(n$a);function n$i(n$a){n$a&&(n$g.drawTexture(n$a,n$b,n$c,n$d,n$e),null!=n$f&&n$f.call(n$g._sp,n$a))}n$h?n$i(n$h):n$x.loader.load(n$a,n$s.create(null,n$i),null,"image")},n$a._renderEmpty=function(n$a,n$b,n$c,n$d){},n$a._renderAll=function(n$a,n$b,n$c,n$d){for(var n$e,n$f=this._cmds,n$g=0,n$h=n$f.length;n$g<n$h;n$g++)(n$e=n$f[n$g]).callee.call(n$b,n$c,n$d,n$e)},n$a._renderOne=function(n$a,n$b,n$c,n$d){this._one.callee.call(n$b,n$c,n$d,this._one)},n$a._renderOneImg=function(n$a,n$b,n$c,n$d){this._one.callee.call(n$b,n$c,n$d,this._one),2305!==n$a._renderType&&(n$a._renderType|=1)},n$a.drawLine=function(n$a,n$b,n$c,n$d,n$e,n$f){void 0===n$f&&(n$f=1);var n$g=0;n$J.isWebGL&&(n$g=n$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(n$g));var n$h=n$f%2==0?0:.5,n$i=[n$a+n$h,n$b+n$h,n$c+n$h,n$d+n$h,n$e,n$f,n$g];this._saveToCmd(n$J._context._drawLine,n$i)},n$a.drawLines=function(n$a,n$b,n$c,n$d,n$e){void 0===n$e&&(n$e=1);var n$f=0;if(n$c&&!(n$c.length<4)){n$J.isWebGL&&(n$f=n$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(n$f));var n$g=n$e%2==0?0:.5,n$h=[n$a+n$g,n$b+n$g,n$c,n$d,n$e,n$f];this._saveToCmd(n$J._context._drawLines,n$h)}},n$a.drawCurves=function(n$a,n$b,n$c,n$d,n$e){void 0===n$e&&(n$e=1);var n$f=[n$a,n$b,n$c,n$d,n$e];this._saveToCmd(n$J._context._drawCurves,n$f)},n$a.drawRect=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){void 0===n$g&&(n$g=1);var n$h=n$f?n$g/2:0,n$i=n$f?n$g:0,n$j=[n$a+n$h,n$b+n$h,n$c-n$i,n$d-n$i,n$e,n$f,n$g];this._saveToCmd(n$J._context._drawRect,n$j)},n$a.drawCircle=function(n$a,n$b,n$c,n$d,n$e,n$f){void 0===n$f&&(n$f=1);var n$g=n$e?n$f/2:0,n$h=0;n$J.isWebGL&&(n$h=n$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(n$h));var n$i=[n$a,n$b,n$c-n$g,n$d,n$e,n$f,n$h];this._saveToCmd(n$J._context._drawCircle,n$i)},n$a.drawPie=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){void 0===n$h&&(n$h=1);var n$i=n$g?n$h/2:0,n$j=n$g?n$h:0,n$k=0;n$J.isWebGL&&(n$k=n$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(n$k));var n$l=[n$a+n$i,n$b+n$i,n$c-n$j,n$d,n$e,n$f,n$g,n$h,n$k];n$l[3]=n$$.toRadian(n$d),n$l[4]=n$$.toRadian(n$e),this._saveToCmd(n$J._context._drawPie,n$l)},n$a.drawPoly=function(n$a,n$b,n$c,n$d,n$e,n$f){void 0===n$f&&(n$f=1);var n$g=0,n$h=!1;n$J.isWebGL&&(n$g=n$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(n$g),n$h=!(6<n$c.length));var n$i=n$e?n$f%2==0?0:.5:0,n$j=[n$a+n$i,n$b+n$i,n$c,n$d,n$e,n$f,n$g,n$h];this._saveToCmd(n$J._context._drawPoly,n$j)},n$a.drawPath=function(n$a,n$b,n$c,n$d,n$e){var n$f=[n$a,n$b,n$c,n$d,n$e];this._saveToCmd(n$J._context._drawPath,n$f)},n$o(0,n$a,"cmds",function(){return this._cmds},function(n$a){this._sp&&(this._sp._renderType|=512),this._cmds=n$a,this._render=this._renderAll,this._repaint()}),n$l.__init__=function(){if(n$J.isConchNode){for(var n$a=laya.display.Graphics.prototype,n$b=n$O.window.ConchGraphics.prototype,n$c=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],n$d=0,n$e=n$c.length;n$d<=n$e;n$d++){var n$f=n$c[n$d];n$a[n$f]=n$b[n$f]}n$a._saveToCmd=null,n$b.drawImageS&&(n$a.drawTextures=function(n$a,n$b){if(n$a&&n$a.loaded&&n$a.bitmap&&n$a.source){var n$c=n$a.uv,n$d=n$a.bitmap.width,n$e=n$a.bitmap.height;this.drawImageS(n$a.bitmap.source,n$c[0]*n$d,n$c[1]*n$e,(n$c[2]-n$c[0])*n$d,(n$c[5]-n$c[3])*n$e,n$a.offsetX,n$a.offsetY,n$a.width,n$a.height,n$b)}}),n$a.drawTexture=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){if(void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=0),void 0===n$e&&(n$e=0),void 0===n$g&&(n$g=1),n$a)if(n$a.loaded){if(n$a.loaded&&n$a.bitmap&&n$a.source&&(n$d||(n$d=n$a.sourceWidth),n$e||(n$e=n$a.sourceHeight),n$g=n$g<0?0:1<n$g?1:n$g,n$d=n$d-n$a.sourceWidth+n$a.width,n$e=n$e-n$a.sourceHeight+n$a.height,!(n$d<=0||n$e<=0))){n$b+=n$a.offsetX,n$c+=n$a.offsetY;var n$h=n$a.uv,n$i=n$a.bitmap.width,n$j=n$a.bitmap.height;n$h[4]<n$h[0]&&n$h[5]<n$h[1]?this.drawImageM(n$a.bitmap.source,n$h[4]*n$i,n$h[5]*n$j,(n$h[0]-n$h[4])*n$i,(n$h[1]-n$h[5])*n$j,n$b,n$c,n$d,n$e,n$f,n$g):this.drawImageM(n$a.bitmap.source,n$h[0]*n$i,n$h[1]*n$j,(n$h[2]-n$h[0])*n$i,(n$h[5]-n$h[3])*n$j,n$b,n$c,n$d,n$e,n$f,n$g),this._repaint()}}else n$a.once("loaded",this,function(){this.drawTexture(n$a,n$b,n$c,n$d,n$e,n$f)})},n$a.fillTexture=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){if(void 0===n$d&&(n$d=0),void 0===n$e&&(n$e=0),void 0===n$f&&(n$f="repeat"),n$a&&n$a.loaded){var n$h,n$i=n$J._context.ctx,n$j=n$a.bitmap.width,n$k=n$a.bitmap.height,n$l=n$a.uv;n$h=n$a.uv!=n$ka.DEF_UV?n$i.createPattern(n$a.bitmap.source,n$f,n$l[0]*n$j,n$l[1]*n$k,(n$l[2]-n$l[0])*n$j,(n$l[5]-n$l[3])*n$k):n$i.createPattern(n$a.bitmap.source,n$f);var n$m=0,n$n=0;n$g&&(n$b+=n$g.x%n$a.width,n$c+=n$g.y%n$a.height,n$m-=n$g.x%n$a.width,n$n-=n$g.y%n$a.height),this._fillImage(n$h,n$b,n$c,n$m,n$n,n$d,n$e)}}}},n$l._cache=[],n$l}(),n$c=function(){function n$t(){this._cacheBoundsType=!1}n$k(n$t,"laya.display.GraphicsBounds");var n$a=n$t.prototype;return n$a.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},n$a.reset=function(){this._temp&&(this._temp.length=0)},n$a.getBounds=function(n$a){return void 0===n$a&&(n$a=!1),(!this._bounds||!this._temp||this._temp.length<1||n$a!=this._cacheBoundsType)&&(this._bounds=n$z._getWrapRec(this.getBoundPoints(n$a),this._bounds)),this._cacheBoundsType=n$a,this._bounds},n$a.getBoundPoints=function(n$a){return void 0===n$a&&(n$a=!1),(!this._temp||this._temp.length<1||n$a!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(n$a)),this._cacheBoundsType=n$a,this._rstBoundPoints=n$$.copyArray(this._rstBoundPoints,this._temp)},n$a._getCmdPoints=function(n$a){void 0===n$a&&(n$a=!1);var n$b,n$c,n$d=n$J._context,n$e=this._graphics.cmds;if((n$b=this._temp||(this._temp=[])).length=0,n$e||null==this._graphics._one||(n$t._tempCmds.length=0,n$t._tempCmds.push(this._graphics._one),n$e=n$t._tempCmds),!n$e)return n$b;(n$c=n$t._tempMatrixArrays).length=0;var n$f=n$t._initMatrix;n$f.identity();for(var n$g,n$h,n$i=n$t._tempMatrix,n$j=NaN,n$k=NaN,n$l=NaN,n$m=NaN,n$n=NaN,n$o=NaN,n$p=0,n$q=n$e.length;n$p<n$q;n$p++)if((n$g=n$e[n$p]).callee)switch(n$g.callee){case n$d._save:case 7:n$c.push(n$f),n$f=n$f.clone();break;case n$d._restore:case 8:n$f=n$c.pop();break;case n$d._scale:case 5:n$i.identity(),n$i.translate(-n$g[2],-n$g[3]),n$i.scale(n$g[0],n$g[1]),n$i.translate(n$g[2],n$g[3]),this._switchMatrix(n$f,n$i);break;case n$d._rotate:case 3:n$i.identity(),n$i.translate(-n$g[1],-n$g[2]),n$i.rotate(n$g[0]),n$i.translate(n$g[1],n$g[2]),this._switchMatrix(n$f,n$i);break;case n$d._translate:case 6:n$i.identity(),n$i.translate(n$g[0],n$g[1]),this._switchMatrix(n$f,n$i);break;case n$d._transform:case 4:n$i.identity(),n$i.translate(-n$g[1],-n$g[2]),n$i.concat(n$g[0]),n$i.translate(n$g[1],n$g[2]),this._switchMatrix(n$f,n$i);break;case 16:case 24:n$t._addPointArrToRst(n$b,n$z._getBoundPointS(n$g[0],n$g[1],n$g[2],n$g[3]),n$f);break;case 17:n$f.copyTo(n$i),n$i.concat(n$g[4]),n$t._addPointArrToRst(n$b,n$z._getBoundPointS(n$g[0],n$g[1],n$g[2],n$g[3]),n$i);break;case n$d._drawTexture:n$h=n$g[0],n$a?n$g[3]&&n$g[4]?n$t._addPointArrToRst(n$b,n$z._getBoundPointS(n$g[1],n$g[2],n$g[3],n$g[4]),n$f):(n$h=n$g[0],n$t._addPointArrToRst(n$b,n$z._getBoundPointS(n$g[1],n$g[2],n$h.width,n$h.height),n$f)):(n$j=(n$g[3]||n$h.sourceWidth)/n$h.width,n$k=(n$g[4]||n$h.sourceHeight)/n$h.height,n$l=n$j*n$h.sourceWidth,n$m=n$k*n$h.sourceHeight,n$n=0<n$h.offsetX?n$h.offsetX:0,n$o=0<n$h.offsetY?n$h.offsetY:0,n$n*=n$j,n$o*=n$k,n$t._addPointArrToRst(n$b,n$z._getBoundPointS(n$g[1]-n$n,n$g[2]-n$o,n$l,n$m),n$f));break;case n$d._fillTexture:n$g[3]&&n$g[4]?n$t._addPointArrToRst(n$b,n$z._getBoundPointS(n$g[1],n$g[2],n$g[3],n$g[4]),n$f):(n$h=n$g[0],n$t._addPointArrToRst(n$b,n$z._getBoundPointS(n$g[1],n$g[2],n$h.width,n$h.height),n$f));break;case n$d._drawTextureWithTransform:var n$r;n$r=n$g[5]?(n$f.copyTo(n$i),n$i.concat(n$g[5]),n$i):n$f,n$a?n$g[3]&&n$g[4]?n$t._addPointArrToRst(n$b,n$z._getBoundPointS(n$g[1],n$g[2],n$g[3],n$g[4]),n$r):(n$h=n$g[0],n$t._addPointArrToRst(n$b,n$z._getBoundPointS(n$g[1],n$g[2],n$h.width,n$h.height),n$r)):(n$h=n$g[0],n$j=(n$g[3]||n$h.sourceWidth)/n$h.width,n$k=(n$g[4]||n$h.sourceHeight)/n$h.height,n$l=n$j*n$h.sourceWidth,n$m=n$k*n$h.sourceHeight,n$n=0<n$h.offsetX?n$h.offsetX:0,n$o=0<n$h.offsetY?n$h.offsetY:0,n$n*=n$j,n$o*=n$k,n$t._addPointArrToRst(n$b,n$z._getBoundPointS(n$g[1]-n$n,n$g[2]-n$o,n$l,n$m),n$r));break;case n$d._drawRect:case 13:n$t._addPointArrToRst(n$b,n$z._getBoundPointS(n$g[0],n$g[1],n$g[2],n$g[3]),n$f);break;case n$d._drawCircle:case n$d._fillCircle:case 14:n$t._addPointArrToRst(n$b,n$z._getBoundPointS(n$g[0]-n$g[2],n$g[1]-n$g[2],n$g[2]+n$g[2],n$g[2]+n$g[2]),n$f);break;case n$d._drawLine:case 20:n$t._tempPoints.length=0;var n$s;n$s=.5*n$g[5],n$g[0]==n$g[2]?n$t._tempPoints.push(n$g[0]+n$s,n$g[1],n$g[2]+n$s,n$g[3],n$g[0]-n$s,n$g[1],n$g[2]-n$s,n$g[3]):n$g[1]==n$g[3]?n$t._tempPoints.push(n$g[0],n$g[1]+n$s,n$g[2],n$g[3]+n$s,n$g[0],n$g[1]-n$s,n$g[2],n$g[3]-n$s):n$t._tempPoints.push(n$g[0],n$g[1],n$g[2],n$g[3]),n$t._addPointArrToRst(n$b,n$t._tempPoints,n$f);break;case n$d._drawCurves:case 22:n$t._addPointArrToRst(n$b,n$u.I.getBezierPoints(n$g[2]),n$f,n$g[0],n$g[1]);break;case n$d._drawPoly:case n$d._drawLines:case 18:n$t._addPointArrToRst(n$b,n$g[2],n$f,n$g[0],n$g[1]);break;case n$d._drawPath:case 19:n$t._addPointArrToRst(n$b,this._getPathPoints(n$g[2]),n$f,n$g[0],n$g[1]);break;case n$d._drawPie:case 15:n$t._addPointArrToRst(n$b,this._getPiePoints(n$g[0],n$g[1],n$g[2],n$g[3],n$g[4]),n$f)}return 200<n$b.length?n$b=n$$.copyArray(n$b,n$z._getWrapRec(n$b)._getBoundPoints()):8<n$b.length&&(n$b=n$v.scanPList(n$b)),n$b},n$a._switchMatrix=function(n$a,n$b){n$b.concat(n$a),n$b.copyTo(n$a)},n$a._getPiePoints=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$t._tempPoints;n$t._tempPoints.length=0,n$f.push(n$a,n$b);var n$g=(n$e-n$d)%(2*Math.PI)/10,n$h=NaN,n$i=n$d;for(n$h=0;n$h<=10;n$h++)n$f.push(n$a+n$c*Math.cos(n$i),n$b+n$c*Math.sin(n$i)),n$i+=n$g;return n$f},n$a._getPathPoints=function(n$a){var n$b,n$c,n$d=0,n$e=n$t._tempPoints;for(n$e.length=0,n$b=n$a.length,n$d=0;n$d<n$b;n$d++)1<(n$c=n$a[n$d]).length&&(n$e.push(n$c[1],n$c[2]),3<n$c.length&&n$e.push(n$c[3],n$c[4]));return n$e},n$t._addPointArrToRst=function(n$a,n$b,n$c,n$d,n$e){void 0===n$d&&(n$d=0),void 0===n$e&&(n$e=0);var n$f,n$g=0;for(n$f=n$b.length,n$g=0;n$g<n$f;n$g+=2)n$t._addPointToRst(n$a,n$b[n$g]+n$d,n$b[n$g+1]+n$e,n$c)},n$t._addPointToRst=function(n$a,n$b,n$c,n$d){var n$e=n$y.TEMP;n$e.setTo(n$b||0,n$c||0),n$d.transformPoint(n$e),n$a.push(n$e.x,n$e.y)},n$t._tempPoints=[],n$t._tempMatrixArrays=[],n$t._tempCmds=[],n$i(n$t,["_tempMatrix",function(){return this._tempMatrix=new n$G},"_initMatrix",function(){return this._initMatrix=new n$G}]),n$t}(),n$f=function(){function n$a(){}n$k(n$a,"laya.events.Event");var n$b=n$a.prototype;return n$b.setTo=function(n$a,n$b,n$c){return this.type=n$a,this.currentTarget=n$b,this.target=n$c,this},n$b.stopPropagation=function(){this._stoped=!0},n$o(0,n$b,"stageY",function(){return n$x.stage.mouseY}),n$o(0,n$b,"charCode",function(){return this.nativeEvent.charCode}),n$o(0,n$b,"touches",function(){var n$a=this.nativeEvent.touches;if(n$a)for(var n$b=n$x.stage,n$c=0,n$d=n$a.length;n$c<n$d;n$c++){var n$e=n$a[n$c],n$f=n$y.TEMP;n$f.setTo(n$e.clientX,n$e.clientY),n$b._canvasTransform.invertTransformPoint(n$f),n$b.transform.invertTransformPoint(n$f),n$e.stageX=n$f.x,n$e.stageY=n$f.y}return n$a}),n$o(0,n$b,"keyLocation",function(){return this.nativeEvent.keyLocation}),n$o(0,n$b,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),n$o(0,n$b,"altKey",function(){return this.nativeEvent.altKey}),n$o(0,n$b,"shiftKey",function(){return this.nativeEvent.shiftKey}),n$o(0,n$b,"stageX",function(){return n$x.stage.mouseX}),n$a.EMPTY=new n$a,n$a.MOUSE_DOWN="mousedown",n$a.MOUSE_UP="mouseup",n$a.CLICK="click",n$a.RIGHT_MOUSE_DOWN="rightmousedown",n$a.RIGHT_MOUSE_UP="rightmouseup",n$a.RIGHT_CLICK="rightclick",n$a.MOUSE_MOVE="mousemove",n$a.MOUSE_OVER="mouseover",n$a.MOUSE_OUT="mouseout",n$a.MOUSE_WHEEL="mousewheel",n$a.ROLL_OVER="mouseover",n$a.ROLL_OUT="mouseout",n$a.DOUBLE_CLICK="doubleclick",n$a.CHANGE="change",n$a.CHANGED="changed",n$a.RESIZE="resize",n$a.ADDED="added",n$a.REMOVED="removed",n$a.DISPLAY="display",n$a.UNDISPLAY="undisplay",n$a.ERROR="error",n$a.COMPLETE="complete",n$a.LOADED="loaded",n$a.INITED="inited",n$a.PROGRESS="progress",n$a.INPUT="input",n$a.RENDER="render",n$a.OPEN="open",n$a.MESSAGE="message",n$a.CLOSE="close",n$a.KEY_DOWN="keydown",n$a.KEY_PRESS="keypress",n$a.KEY_UP="keyup",n$a.FRAME="enterframe",n$a.DRAG_START="dragstart",n$a.DRAG_MOVE="dragmove",n$a.DRAG_END="dragend",n$a.ENTER="enter",n$a.SELECT="select",n$a.BLUR="blur",n$a.FOCUS="focus",n$a.VISIBILITY_CHANGE="visibilitychange",n$a.FOCUS_CHANGE="focuschange",n$a.PLAYED="played",n$a.PAUSED="paused",n$a.STOPPED="stopped",n$a.START="start",n$a.END="end",n$a.ENABLE_CHANGED="enablechanged",n$a.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",n$a.COMPONENT_ADDED="componentadded",n$a.COMPONENT_REMOVED="componentremoved",n$a.LAYER_CHANGED="layerchanged",n$a.HIERARCHY_LOADED="hierarchyloaded",n$a.RECOVERED="recovered",n$a.RELEASED="released",n$a.LINK="link",n$a.LABEL="label",n$a.FULL_SCREEN_CHANGE="fullscreenchange",n$a.DEVICE_LOST="devicelost",n$a.MESH_CHANGED="meshchanged",n$a.MATERIAL_CHANGED="materialchanged",n$a.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",n$a.ANIMATION_CHANGED="animationchanged",n$a.TRIGGER_ENTER="triggerenter",n$a.TRIGGER_STAY="triggerstay",n$a.TRIGGER_EXIT="triggerexit",n$a.TRAIL_FILTER_CHANGE="trailfilterchange",n$a.DOMINO_FILTER_CHANGE="dominofilterchange",n$a}(),n$l=(function(){function n$a(){}n$k(n$a,"laya.events.Keyboard"),n$a.NUMBER_0=48,n$a.NUMBER_1=49,n$a.NUMBER_2=50,n$a.NUMBER_3=51,n$a.NUMBER_4=52,n$a.NUMBER_5=53,n$a.NUMBER_6=54,n$a.NUMBER_7=55,n$a.NUMBER_8=56,n$a.NUMBER_9=57,n$a.A=65,n$a.B=66,n$a.C=67,n$a.D=68,n$a.E=69,n$a.F=70,n$a.G=71,n$a.H=72,n$a.I=73,n$a.J=74,n$a.K=75,n$a.L=76,n$a.M=77,n$a.N=78,n$a.O=79,n$a.P=80,n$a.Q=81,n$a.R=82,n$a.S=83,n$a.T=84,n$a.U=85,n$a.V=86,n$a.W=87,n$a.X=88,n$a.Y=89,n$a.Z=90,n$a.F1=112,n$a.F2=113,n$a.F3=114,n$a.F4=115,n$a.F5=116,n$a.F6=117,n$a.F7=118,n$a.F8=119,n$a.F9=120,n$a.F10=121,n$a.F11=122,n$a.F12=123,n$a.F13=124,n$a.F14=125,n$a.F15=126,n$a.NUMPAD=21,n$a.NUMPAD_0=96,n$a.NUMPAD_1=97,n$a.NUMPAD_2=98,n$a.NUMPAD_3=99,n$a.NUMPAD_4=100,n$a.NUMPAD_5=101,n$a.NUMPAD_6=102,n$a.NUMPAD_7=103,n$a.NUMPAD_8=104,n$a.NUMPAD_9=105,n$a.NUMPAD_ADD=107,n$a.NUMPAD_DECIMAL=110,n$a.NUMPAD_DIVIDE=111,n$a.NUMPAD_ENTER=108,n$a.NUMPAD_MULTIPLY=106,n$a.NUMPAD_SUBTRACT=109,n$a.SEMICOLON=186,n$a.EQUAL=187,n$a.COMMA=188,n$a.MINUS=189,n$a.PERIOD=190,n$a.SLASH=191,n$a.BACKQUOTE=192,n$a.LEFTBRACKET=219,n$a.BACKSLASH=220,n$a.RIGHTBRACKET=221,n$a.QUOTE=222,n$a.ALTERNATE=18,n$a.BACKSPACE=8,n$a.CAPS_LOCK=20,n$a.COMMAND=15,n$a.CONTROL=17,n$a.DELETE=46,n$a.ENTER=13,n$a.ESCAPE=27,n$a.PAGE_UP=33,n$a.PAGE_DOWN=34,n$a.END=35,n$a.HOME=36,n$a.LEFT=37,n$a.UP=38,n$a.RIGHT=39,n$a.DOWN=40,n$a.SHIFT=16,n$a.SPACE=32,n$a.TAB=9,n$a.INSERT=45}(),function(){function n$e(){}return n$k(n$e,"laya.events.KeyBoardManager"),n$e.__init__=function(){n$e._addEvent("keydown"),n$e._addEvent("keypress"),n$e._addEvent("keyup")},n$e._addEvent=function(n$b){n$O.document.addEventListener(n$b,function(n$a){laya.events.KeyBoardManager._dispatch(n$a,n$b)},!0)},n$e._dispatch=function(n$a,n$b){if(n$e.enabled){n$e._event._stoped=!1,n$e._event.nativeEvent=n$a,n$e._event.keyCode=n$a.keyCode||n$a.which||n$a.charCode,"keydown"===n$b?n$e._pressKeys[n$e._event.keyCode]=!0:"keyup"===n$b&&(n$e._pressKeys[n$e._event.keyCode]=null);for(var n$c=n$x.stage.focus&&null!=n$x.stage.focus.event&&n$x.stage.focus.displayedInStage?n$x.stage.focus:n$x.stage,n$d=n$c;n$d;)n$d.event(n$b,n$e._event.setTo(n$b,n$d,n$c)),n$d=n$d.parent}},n$e.hasKeyDown=function(n$a){return n$e._pressKeys[n$a]},n$e._pressKeys={},n$e.enabled=!0,n$i(n$e,["_event",function(){return this._event=new n$f}]),n$e}()),n$p=(function(){function n$a(){}n$k(n$a,"laya.events.KeyLocation"),n$a.STANDARD=0,n$a.LEFT=1,n$a.RIGHT=2,n$a.NUM_PAD=3}(),function(){function n$j(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=n$O.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new n$f,this._matrix=new n$G,this._point=new n$y,this._rect=new n$z,this._prePoint=new n$y,this._curTouchID=NaN}n$k(n$j,"laya.events.MouseManager");var n$a=n$j.prototype;return n$a.__init__=function(n$a,n$b){var n$c=this;this._stage=n$a;var n$d=this,n$e=this._eventList;n$b.oncontextmenu=function(n$a){if(n$j.enabled)return!1},n$b.addEventListener("mousedown",function(n$a){n$j.enabled&&(n$O.onIE||n$a.preventDefault(),n$e.push(n$a),n$d.mouseDownTime=n$O.now())}),n$b.addEventListener("mouseup",function(n$a){n$j.enabled&&(n$a.preventDefault(),n$e.push(n$a),n$d.mouseDownTime=-n$O.now())},!0),n$b.addEventListener("mousemove",function(n$a){if(n$j.enabled){n$a.preventDefault();var n$b=n$O.now();if(n$b-n$d._lastMoveTimer<10)return;n$d._lastMoveTimer=n$b,n$e.push(n$a)}},!0),n$b.addEventListener("mouseout",function(n$a){n$j.enabled&&n$e.push(n$a)}),n$b.addEventListener("mouseover",function(n$a){n$j.enabled&&n$e.push(n$a)}),n$b.addEventListener("touchstart",function(n$a){n$j.enabled&&(n$e.push(n$a),n$j._isFirstTouch||n$va.isInputting||n$a.preventDefault(),n$d.mouseDownTime=n$O.now())}),n$b.addEventListener("touchend",function(n$a){n$j.enabled?(n$j._isFirstTouch||n$va.isInputting||n$a.preventDefault(),n$j._isFirstTouch=!1,n$e.push(n$a),n$d.mouseDownTime=-n$O.now()):n$c._curTouchID=NaN},!0),n$b.addEventListener("touchmove",function(n$a){n$j.enabled&&(n$a.preventDefault(),n$e.push(n$a))},!0),n$b.addEventListener("touchcancel",function(n$a){n$j.enabled?(n$a.preventDefault(),n$e.push(n$a)):n$c._curTouchID=NaN},!0),n$b.addEventListener("mousewheel",function(n$a){n$j.enabled&&n$e.push(n$a)}),n$b.addEventListener("DOMMouseScroll",function(n$a){n$j.enabled&&n$e.push(n$a)})},n$a.initEvent=function(n$a,n$b){var n$c;this._event._stoped=!1,this._event.nativeEvent=n$b||n$a,this._target=null,this._point.setTo(n$a.pageX||n$a.clientX,n$a.pageY||n$a.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=n$a.identifier||0,this._tTouchID=this._event.touchId,(n$c=n$q.I._event)._stoped=!1,n$c.nativeEvent=this._event.nativeEvent,n$c.touchId=this._event.touchId},n$a.checkMouseWheel=function(n$a){this._event.delta=n$a.wheelDelta?.025*n$a.wheelDelta:-n$a.detail;for(var n$b=n$q.I.getLastOvers(),n$c=0,n$d=n$b.length;n$c<n$d;n$c++){var n$e=n$b[n$c];n$e.event("mousewheel",this._event.setTo("mousewheel",n$e,this._target))}},n$a.onMouseMove=function(n$a){n$q.I.onMouseMove(n$a,this._tTouchID)},n$a.onMouseDown=function(n$a){if(n$va.isInputting&&n$x.stage.focus&&n$x.stage.focus.focus&&!n$x.stage.focus.contains(this._target)){var n$b=n$x.stage.focus._tf||n$x.stage.focus,n$c=n$a._tf||n$a;n$c instanceof laya.display.Input&&n$c.multiline==n$b.multiline?n$b._focusOut():n$b.focus=!1}n$q.I.onMouseDown(n$a,this._tTouchID,this._isLeftMouse)},n$a.onMouseUp=function(n$a){n$q.I.onMouseUp(n$a,this._tTouchID,this._isLeftMouse)},n$a.check=function(n$a,n$b,n$c,n$d){this._point.setTo(n$b,n$c),n$a.fromParentPoint(this._point),n$b=this._point.x,n$c=this._point.y;var n$e=n$a.scrollRect;if(n$e&&(this._rect.setTo(n$e.x,n$e.y,n$e.width,n$e.height),!this._rect.contains(n$b,n$c)))return!1;if(!this.disableMouseEvent){if(n$a.hitTestPrior&&!n$a.mouseThrough&&!this.hitTest(n$a,n$b,n$c))return!1;for(var n$f=n$a._childs.length-1;-1<n$f;n$f--){var n$g=n$a._childs[n$f];if(!n$g.destroyed&&n$g.mouseEnabled&&n$g.visible&&this.check(n$g,n$b,n$c,n$d))return!0}}var n$h=!(!n$a.hitTestPrior||n$a.mouseThrough||this.disableMouseEvent)||this.hitTest(n$a,n$b,n$c);return n$h?(this._target=n$a,n$d.call(this,n$a)):n$d===this.onMouseUp&&n$a===this._stage&&(this._target=this._stage,n$d.call(this,this._target)),n$h},n$a.hitTest=function(n$a,n$b,n$c){var n$d=!1;if(n$a.scrollRect&&(n$b-=n$a.scrollRect.x,n$c-=n$a.scrollRect.y),n$a.hitArea instanceof laya.utils.HitArea)return n$a.hitArea.isHit(n$b,n$c);if(0<n$a.width&&0<n$a.height||n$a.mouseThrough||n$a.hitArea)if(n$a.mouseThrough)n$d=n$a.getGraphicBounds().contains(n$b,n$c);else{var n$e=this._rect;n$a.hitArea?n$e=n$a.hitArea:n$e.setTo(0,0,n$a.width,n$a.height),n$d=n$e.contains(n$b,n$c)}return n$d},n$a.runEvent=function(){var n$a=this._eventList.length;if(n$a){this.mouseEventTime=n$O.now();var n$b,n$c=0,n$d=0,n$e=0;try{for(;n$c<n$a;){var n$f=this._eventList[n$c];switch("mousemove"!==n$f.type&&(this._prePoint.x=this._prePoint.y=-1e6),n$f.type){case"mousedown":this._touchIDs[0]=this._id++,n$j._isTouchRespond?n$j._isTouchRespond=!1:(this._isLeftMouse=0===n$f.button,this.initEvent(n$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===n$f.button,this.initEvent(n$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-n$f.clientX)+Math.abs(this._prePoint.y-n$f.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=n$f.clientX,this._prePoint.y=n$f.clientY,this.initEvent(n$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":n$j._isTouchRespond=!0,this._isLeftMouse=!0;var n$g=n$f.changedTouches;for(n$d=0,n$e=n$g.length;n$d<n$e;n$d++)n$b=n$g[n$d],(n$j.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=n$b.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[n$b.identifier]=this._id++,this.initEvent(n$b,n$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":n$j._isTouchRespond=!0,this._isLeftMouse=!0;var n$h=n$f.changedTouches;for(n$d=0,n$e=n$h.length;n$d<n$e;n$d++)if(n$b=n$h[n$d],n$j.multiTouchEnabled||n$b.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(n$b,n$f);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var n$i=n$f.changedTouches;for(n$d=0,n$e=n$i.length;n$d<n$e;n$d++)n$b=n$i[n$d],(n$j.multiTouchEnabled||n$b.identifier==this._curTouchID)&&(this.initEvent(n$b,n$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(n$f);break;case"mouseout":n$q.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}n$c++}}catch(n$a){throw this._eventList.length=0,n$a}this._eventList.length=0}},n$j.enabled=!0,n$j.multiTouchEnabled=!0,n$j._isTouchRespond=!1,n$j._isFirstTouch=!0,n$i(n$j,["instance",function(){return this.instance=new n$j}]),n$j}()),n$q=function(){function n$o(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new n$f}n$k(n$o,"laya.events.TouchManager");var n$a=n$o.prototype;return n$a._clearTempArrs=function(){n$o._oldArr.length=0,n$o._newArr.length=0,n$o._tEleArr.length=0},n$a.getTouchFromArr=function(n$a,n$b){var n$c,n$d,n$e=0;for(n$c=n$b.length,n$e=0;n$e<n$c;n$e++)if((n$d=n$b[n$e]).id==n$a)return n$d;return null},n$a.removeTouchFromArr=function(n$a,n$b){var n$c=0;for(n$c=n$b.length-1;0<=n$c;n$c--)n$b[n$c].id==n$a&&n$b.splice(n$c,1)},n$a.createTouchO=function(n$a,n$b){var n$c;return(n$c=n$W.getItem("TouchData")||{}).id=n$b,n$c.tar=n$a,n$c},n$a.onMouseDown=function(n$a,n$b,n$c){var n$d,n$e,n$f,n$g;(void 0===n$c&&(n$c=!1),this.enable)&&(n$d=this.getTouchFromArr(n$b,this.preOvers),n$f=this.getEles(n$a,null,n$o._tEleArr),n$d?n$d.tar=n$a:(n$e=this.createTouchO(n$a,n$b),this.preOvers.push(n$e)),n$O.onMobile&&this.sendEvents(n$f,"mouseover",n$b),n$g=n$c?this.preDowns:this.preRightDowns,(n$d=this.getTouchFromArr(n$b,n$g))?n$d.tar=n$a:(n$e=this.createTouchO(n$a,n$b),n$g.push(n$e)),this.sendEvents(n$f,n$c?"mousedown":"rightmousedown",n$b),this._clearTempArrs())},n$a.sendEvents=function(n$a,n$b,n$c){void 0===n$c&&(n$c=0);var n$d,n$e,n$f,n$g=0;for(n$d=n$a.length,this._event._stoped=!1,n$e=n$a[0],n$g=0;n$g<n$d;n$g++){if((n$f=n$a[n$g]).destroyed)return;if(n$f.event(n$b,this._event.setTo(n$b,n$f,n$e)),this._event._stoped)break}},n$a.getEles=function(n$a,n$b,n$c){for(n$c?n$c.length=0:n$c=[];n$a&&n$a!=n$b;)n$c.push(n$a),n$a=n$a.parent;return n$c},n$a.checkMouseOutAndOverOfMove=function(n$a,n$b,n$c){if(void 0===n$c&&(n$c=0),n$b!=n$a){var n$d,n$e,n$f=0,n$g=0;if(n$b.contains(n$a))n$e=this.getEles(n$a,n$b,n$o._tEleArr),this.sendEvents(n$e,"mouseover",n$c);else if(n$a.contains(n$b))n$e=this.getEles(n$b,n$a,n$o._tEleArr),this.sendEvents(n$e,"mouseout",n$c);else{var n$h,n$i;(n$e=n$o._tEleArr).length=0,n$h=this.getEles(n$b,null,n$o._oldArr),n$i=this.getEles(n$a,null,n$o._newArr),n$g=n$h.length;var n$j=0;for(n$f=0;n$f<n$g;n$f++){if(n$d=n$h[n$f],0<=(n$j=n$i.indexOf(n$d))){n$i.splice(n$j,n$i.length-n$j);break}n$e.push(n$d)}0<n$e.length&&this.sendEvents(n$e,"mouseout",n$c),0<n$i.length&&this.sendEvents(n$i,"mouseover",n$c)}}},n$a.onMouseMove=function(n$a,n$b){var n$c,n$d;this.enable&&((n$c=this.getTouchFromArr(n$b,this.preOvers))?(this.checkMouseOutAndOverOfMove(n$a,n$c.tar),n$c.tar=n$a,n$d=this.getEles(n$a,null,n$o._tEleArr)):(n$d=this.getEles(n$a,null,n$o._tEleArr),this.sendEvents(n$d,"mouseover",n$b),this.preOvers.push(this.createTouchO(n$a,n$b))),this.sendEvents(n$d,"mousemove",n$b),this._clearTempArrs())},n$a.getLastOvers=function(){return(n$o._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,n$o._tEleArr):(n$o._tEleArr.push(n$x.stage),n$o._tEleArr)},n$a.stageMouseOut=function(){var n$a;n$a=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(n$a,"mouseout",0)},n$a.onMouseUp=function(n$a,n$b,n$c){if(void 0===n$c&&(n$c=!1),this.enable){var n$d,n$e,n$f,n$g,n$h,n$i,n$j=0,n$k=0,n$l=n$O.onMobile;if(n$e=this.getEles(n$a,null,n$o._tEleArr),this.sendEvents(n$e,n$c?"mouseup":"rightmouseup",n$b),n$i=n$c?this.preDowns:this.preRightDowns,n$d=this.getTouchFromArr(n$b,n$i)){var n$m,n$n=n$O.now();if(n$m=n$n-this._lastClickTime<300,this._lastClickTime=n$n,n$a==n$d.tar)n$h=n$e;else for(n$f=this.getEles(n$d.tar,null,n$o._oldArr),(n$h=n$o._newArr).length=0,n$k=n$f.length,n$j=0;n$j<n$k;n$j++)n$g=n$f[n$j],0<=n$e.indexOf(n$g)&&n$h.push(n$g);0<n$h.length&&this.sendEvents(n$h,n$c?"click":"rightclick",n$b),n$c&&n$m&&this.sendEvents(n$h,"doubleclick",n$b),this.removeTouchFromArr(n$b,n$i),n$d.tar=null,n$W.recover("TouchData",n$d)}else;(n$d=this.getTouchFromArr(n$b,this.preOvers))&&n$l&&((n$h=this.getEles(n$d.tar,null,n$h))&&0<n$h.length&&this.sendEvents(n$h,"mouseout",n$b),this.removeTouchFromArr(n$b,this.preOvers),n$d.tar=null,n$W.recover("TouchData",n$d)),this._clearTempArrs()}},n$o._oldArr=[],n$o._newArr=[],n$o._tEleArr=[],n$i(n$o,["I",function(){return this.I=new n$o}]),n$o}(),n$r=function(){function n$a(){this._action=null}n$k(n$a,"laya.filters.Filter");var n$b=n$a.prototype;return n$x.imps(n$b,{"laya.filters.IFilter":!0}),n$b.callNative=function(n$a){},n$o(0,n$b,"type",function(){return-1}),n$o(0,n$b,"action",function(){return this._action}),n$a.BLUR=16,n$a.COLOR=32,n$a.GLOW=8,n$a._filterStart=null,n$a._filterEnd=null,n$a._EndTarget=null,n$a._recycleScope=null,n$a._filter=null,n$a._useSrc=null,n$a._endSrc=null,n$a._useOut=null,n$a._endOut=null,n$a}(),n$t=function(){function n$a(){this.data=null}n$k(n$a,"laya.filters.ColorFilterAction");var n$b=n$a.prototype;return n$x.imps(n$b,{"laya.filters.IFilterAction":!0}),n$b.apply=function(n$a){var n$b=n$a.ctx.ctx,n$c=n$a.ctx.ctx.canvas;if(0==n$c.width||0==n$c.height)return n$c;for(var n$d,n$e=n$b.getImageData(0,0,n$c.width,n$c.height),n$f=n$e.data,n$g=0,n$h=n$f.length;n$g<n$h;n$g+=4)n$d=this.getColor(n$f[n$g],n$f[n$g+1],n$f[n$g+2],n$f[n$g+3]),0!=n$f[n$g+3]&&(n$f[n$g]=n$d[0],n$f[n$g+1]=n$d[1],n$f[n$g+2]=n$d[2],n$f[n$g+3]=n$d[3]);return n$b.putImageData(n$e,0,0),n$a},n$b.getColor=function(n$a,n$b,n$c,n$d){var n$e=[];if(this.data._mat&&this.data._alpha){var n$f=this.data._mat,n$g=this.data._alpha;n$e[0]=n$f[0]*n$a+n$f[1]*n$b+n$f[2]*n$c+n$f[3]*n$d+n$g[0],n$e[1]=n$f[4]*n$a+n$f[5]*n$b+n$f[6]*n$c+n$f[7]*n$d+n$g[1],n$e[2]=n$f[8]*n$a+n$f[9]*n$b+n$f[10]*n$c+n$f[11]*n$d+n$g[2],n$e[3]=n$f[12]*n$a+n$f[13]*n$b+n$f[14]*n$c+n$f[15]*n$d+n$g[3]}return n$e},n$a}(),n$u=(function(){function n$a(){}n$k(n$a,"laya.maths.Arith"),n$a.formatR=function(n$a){return n$a>Math.PI&&(n$a-=2*Math.PI),n$a<-Math.PI&&(n$a+=2*Math.PI),n$a},n$a.isPOT=function(n$a,n$b){return 0<n$a&&0==(n$a&n$a-1)&&0<n$b&&0==(n$b&n$b-1)},n$a.setMatToArray=function(n$a,n$b){n$a.a,n$a.b,n$a.c,n$a.d,n$a.tx,n$a.ty,n$b[0]=n$a.a,n$b[1]=n$a.b,n$b[4]=n$a.c,n$b[5]=n$a.d,n$b[12]=n$a.tx,n$b[13]=n$a.ty}}(),function(){function n$a(){this._controlPoints=[new n$y,new n$y,new n$y],this._calFun=this.getPoint2}n$k(n$a,"laya.maths.Bezier");var n$b=n$a.prototype;return n$b._switchPoint=function(n$a,n$b){var n$c=this._controlPoints.shift();n$c.setTo(n$a,n$b),this._controlPoints.push(n$c)},n$b.getPoint2=function(n$a,n$b){var n$c=this._controlPoints[0],n$d=this._controlPoints[1],n$e=this._controlPoints[2],n$f=Math.pow(1-n$a,2)*n$c.x+2*n$a*(1-n$a)*n$d.x+Math.pow(n$a,2)*n$e.x,n$g=Math.pow(1-n$a,2)*n$c.y+2*n$a*(1-n$a)*n$d.y+Math.pow(n$a,2)*n$e.y;n$b.push(n$f,n$g)},n$b.getPoint3=function(n$a,n$b){var n$c=this._controlPoints[0],n$d=this._controlPoints[1],n$e=this._controlPoints[2],n$f=this._controlPoints[3],n$g=Math.pow(1-n$a,3)*n$c.x+3*n$d.x*n$a*(1-n$a)*(1-n$a)+3*n$e.x*n$a*n$a*(1-n$a)+n$f.x*Math.pow(n$a,3),n$h=Math.pow(1-n$a,3)*n$c.y+3*n$d.y*n$a*(1-n$a)*(1-n$a)+3*n$e.y*n$a*n$a*(1-n$a)+n$f.y*Math.pow(n$a,3);n$b.push(n$g,n$h)},n$b.insertPoints=function(n$a,n$b){var n$c,n$d=NaN;for(n$c=1/(n$a=0<n$a?n$a:5),n$d=0;n$d<=1;n$d+=n$c)this._calFun(n$d,n$b)},n$b.getBezierPoints=function(n$a,n$b,n$c){void 0===n$b&&(n$b=5),void 0===n$c&&(n$c=2);var n$d,n$e,n$f=0;if((n$d=n$a.length)<2*(n$c+1))return[];switch(n$e=[],n$c){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=n$c;)this._controlPoints.push(new n$y);for(n$f=0;n$f<2*n$c;n$f+=2)this._switchPoint(n$a[n$f],n$a[n$f+1]);for(n$f=2*n$c;n$f<n$d;n$f+=2)this._switchPoint(n$a[n$f],n$a[n$f+1]),n$f/2%n$c==0&&this.insertPoints(n$b,n$e);return n$e},n$i(n$a,["I",function(){return this.I=new n$a}]),n$a}()),n$v=function(){function n$j(){}return n$k(n$j,"laya.maths.GrahamScan"),n$j.multiply=function(n$a,n$b,n$c){return(n$a.x-n$c.x)*(n$b.y-n$c.y)-(n$b.x-n$c.x)*(n$a.y-n$c.y)},n$j.dis=function(n$a,n$b){return(n$a.x-n$b.x)*(n$a.x-n$b.x)+(n$a.y-n$b.y)*(n$a.y-n$b.y)},n$j._getPoints=function(n$a,n$b,n$c){for(void 0===n$b&&(n$b=!1),n$j._mPointList||(n$j._mPointList=[]);n$j._mPointList.length<n$a;)n$j._mPointList.push(new n$y);return n$c||(n$c=[]),n$c.length=0,n$b?n$j.getFrom(n$c,n$j._mPointList,n$a):n$j.getFromR(n$c,n$j._mPointList,n$a),n$c},n$j.getFrom=function(n$a,n$b,n$c){var n$d=0;for(n$d=0;n$d<n$c;n$d++)n$a.push(n$b[n$d]);return n$a},n$j.getFromR=function(n$a,n$b,n$c){var n$d=0;for(n$d=0;n$d<n$c;n$d++)n$a.push(n$b.pop());return n$a},n$j.pListToPointList=function(n$a,n$b){void 0===n$b&&(n$b=!1);var n$c=0,n$d=n$a.length/2,n$e=n$j._getPoints(n$d,n$b,n$j._tempPointList);for(n$c=0;n$c<n$d;n$c++)n$e[n$c].setTo(n$a[n$c+n$c],n$a[n$c+n$c+1]);return n$e},n$j.pointListToPlist=function(n$a){var n$b,n$c=0,n$d=n$a.length,n$e=n$j._temPList;for(n$c=n$e.length=0;n$c<n$d;n$c++)n$b=n$a[n$c],n$e.push(n$b.x,n$b.y);return n$e},n$j.scanPList=function(n$a){return n$$.copyArray(n$a,n$j.pointListToPlist(n$j.scan(n$j.pListToPointList(n$a,!0))))},n$j.scan=function(n$a){var n$b,n$c,n$d,n$e=0,n$f=0,n$g=0,n$h=n$a.length,n$i={};for((n$c=n$j._temArr).length=0,n$e=(n$h=n$a.length)-1;0<=n$e;n$e--)n$d=(n$b=n$a[n$e]).x+"_"+n$b.y,n$i.hasOwnProperty(n$d)||(n$i[n$d]=!0,n$c.push(n$b));for(n$h=n$c.length,n$$.copyArray(n$a,n$c),n$e=1;n$e<n$h;n$e++)(n$a[n$e].y<n$a[n$g].y||n$a[n$e].y==n$a[n$g].y&&n$a[n$e].x<n$a[n$g].x)&&(n$g=n$e);for(n$b=n$a[0],n$a[0]=n$a[n$g],n$a[n$g]=n$b,n$e=1;n$e<n$h-1;n$e++){for(n$f=(n$g=n$e)+1;n$f<n$h;n$f++)(0<n$j.multiply(n$a[n$f],n$a[n$g],n$a[0])||0==n$j.multiply(n$a[n$f],n$a[n$g],n$a[0])&&n$j.dis(n$a[0],n$a[n$f])<n$j.dis(n$a[0],n$a[n$g]))&&(n$g=n$f);n$b=n$a[n$e],n$a[n$e]=n$a[n$g],n$a[n$g]=n$b}if((n$c=n$j._temArr).length=0,n$a.length<3)return n$$.copyArray(n$c,n$a);for(n$c.push(n$a[0],n$a[1],n$a[2]),n$e=3;n$e<n$h;n$e++){for(;2<=n$c.length&&0<=n$j.multiply(n$a[n$e],n$c[n$c.length-1],n$c[n$c.length-2]);)n$c.pop();n$a[n$e]&&n$c.push(n$a[n$e])}return n$c},n$j._mPointList=null,n$j._tempPointList=[],n$j._temPList=[],n$j._temArr=[],n$j}(),n$w=function(){function n$e(){}return n$k(n$e,"laya.maths.MathUtil"),n$e.subtractVector3=function(n$a,n$b,n$c){n$c[0]=n$a[0]-n$b[0],n$c[1]=n$a[1]-n$b[1],n$c[2]=n$a[2]-n$b[2]},n$e.lerp=function(n$a,n$b,n$c){return n$a*(1-n$c)+n$b*n$c},n$e.scaleVector3=function(n$a,n$b,n$c){n$c[0]=n$a[0]*n$b,n$c[1]=n$a[1]*n$b,n$c[2]=n$a[2]*n$b},n$e.lerpVector3=function(n$a,n$b,n$c,n$d){var n$e=n$a[0],n$f=n$a[1],n$g=n$a[2];n$d[0]=n$e+n$c*(n$b[0]-n$e),n$d[1]=n$f+n$c*(n$b[1]-n$f),n$d[2]=n$g+n$c*(n$b[2]-n$g)},n$e.lerpVector4=function(n$a,n$b,n$c,n$d){var n$e=n$a[0],n$f=n$a[1],n$g=n$a[2],n$h=n$a[3];n$d[0]=n$e+n$c*(n$b[0]-n$e),n$d[1]=n$f+n$c*(n$b[1]-n$f),n$d[2]=n$g+n$c*(n$b[2]-n$g),n$d[3]=n$h+n$c*(n$b[3]-n$h)},n$e.slerpQuaternionArray=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){var n$h,n$i,n$j,n$k,n$l,n$m=n$a[n$b+0],n$n=n$a[n$b+1],n$o=n$a[n$b+2],n$p=n$a[n$b+3],n$q=n$c[n$d+0],n$r=n$c[n$d+1],n$s=n$c[n$d+2],n$t=n$c[n$d+3];return(n$i=n$m*n$q+n$n*n$r+n$o*n$s+n$p*n$t)<0&&(n$i=-n$i,n$q=-n$q,n$r=-n$r,n$s=-n$s,n$t=-n$t),n$l=1e-6<1-n$i?(n$h=Math.acos(n$i),n$j=Math.sin(n$h),n$k=Math.sin((1-n$e)*n$h)/n$j,Math.sin(n$e*n$h)/n$j):(n$k=1-n$e,n$e),n$f[n$g+0]=n$k*n$m+n$l*n$q,n$f[n$g+1]=n$k*n$n+n$l*n$r,n$f[n$g+2]=n$k*n$o+n$l*n$s,n$f[n$g+3]=n$k*n$p+n$l*n$t,n$f},n$e.getRotation=function(n$a,n$b,n$c,n$d){return Math.atan2(n$d-n$b,n$c-n$a)/Math.PI*180},n$e.sortBigFirst=function(n$a,n$b){return n$a==n$b?0:n$a<n$b?1:-1},n$e.sortSmallFirst=function(n$a,n$b){return n$a==n$b?0:n$a<n$b?-1:1},n$e.sortNumBigFirst=function(n$a,n$b){return parseFloat(n$b)-parseFloat(n$a)},n$e.sortNumSmallFirst=function(n$a,n$b){return parseFloat(n$a)-parseFloat(n$b)},n$e.sortByKey=function(n$c,n$a,n$b){var n$d;return void 0===n$a&&(n$a=!1),void 0===n$b&&(n$b=!0),n$d=n$a?n$b?n$e.sortNumBigFirst:n$e.sortBigFirst:n$b?n$e.sortNumSmallFirst:n$e.sortSmallFirst,function(n$a,n$b){return n$d(n$a[n$c],n$b[n$c])}},n$e}(),n$G=function(){function n$c(n$a,n$b,n$c,n$d,n$e,n$f){this.inPool=!1,this.bTransform=!1,void 0===n$a&&(n$a=1),void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=1),void 0===n$e&&(n$e=0),void 0===n$f&&(n$f=0),this.a=n$a,this.b=n$b,this.c=n$c,this.d=n$d,this.tx=n$e,this.ty=n$f,this._checkTransform()}n$k(n$c,"laya.maths.Matrix");var n$a=n$c.prototype;return n$a.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},n$a._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},n$a.setTranslate=function(n$a,n$b){return this.tx=n$a,this.ty=n$b,this},n$a.translate=function(n$a,n$b){return this.tx+=n$a,this.ty+=n$b,this},n$a.scale=function(n$a,n$b){this.a*=n$a,this.d*=n$b,this.c*=n$a,this.b*=n$b,this.tx*=n$a,this.ty*=n$b,this.bTransform=!0},n$a.rotate=function(n$a){var n$b=Math.cos(n$a),n$c=Math.sin(n$a),n$d=this.a,n$e=this.c,n$f=this.tx;this.a=n$d*n$b-this.b*n$c,this.b=n$d*n$c+this.b*n$b,this.c=n$e*n$b-this.d*n$c,this.d=n$e*n$c+this.d*n$b,this.tx=n$f*n$b-this.ty*n$c,this.ty=n$f*n$c+this.ty*n$b,this.bTransform=!0},n$a.skew=function(n$a,n$b){var n$c=Math.tan(n$a),n$d=Math.tan(n$b),n$e=this.a,n$f=this.b;return this.a+=n$d*this.c,this.b+=n$d*this.d,this.c+=n$c*n$e,this.d+=n$c*n$f,this},n$a.invertTransformPoint=function(n$a){var n$b=this.a,n$c=this.b,n$d=this.c,n$e=this.d,n$f=this.tx,n$g=n$b*n$e-n$c*n$d,n$h=n$e/n$g,n$i=-n$c/n$g,n$j=-n$d/n$g,n$k=n$b/n$g,n$l=(n$d*this.ty-n$e*n$f)/n$g,n$m=-(n$b*this.ty-n$c*n$f)/n$g;return n$a.setTo(n$h*n$a.x+n$j*n$a.y+n$l,n$i*n$a.x+n$k*n$a.y+n$m)},n$a.transformPoint=function(n$a){return n$a.setTo(this.a*n$a.x+this.c*n$a.y+this.tx,this.b*n$a.x+this.d*n$a.y+this.ty)},n$a.transformPointN=function(n$a){return n$a.setTo(this.a*n$a.x+this.c*n$a.y,this.b*n$a.x+this.d*n$a.y)},n$a.transformPointArray=function(n$a,n$b){for(var n$c=n$a.length,n$d=0;n$d<n$c;n$d+=2){var n$e=n$a[n$d],n$f=n$a[n$d+1];n$b[n$d]=this.a*n$e+this.c*n$f+this.tx,n$b[n$d+1]=this.b*n$e+this.d*n$f+this.ty}return n$b},n$a.transformPointArrayScale=function(n$a,n$b){for(var n$c=n$a.length,n$d=0;n$d<n$c;n$d+=2){var n$e=n$a[n$d],n$f=n$a[n$d+1];n$b[n$d]=this.a*n$e+this.c*n$f,n$b[n$d+1]=this.b*n$e+this.d*n$f}return n$b},n$a.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},n$a.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},n$a.invert=function(){var n$a=this.a,n$b=this.b,n$c=this.c,n$d=this.d,n$e=this.tx,n$f=n$a*n$d-n$b*n$c;return this.a=n$d/n$f,this.b=-n$b/n$f,this.c=-n$c/n$f,this.d=n$a/n$f,this.tx=(n$c*this.ty-n$d*n$e)/n$f,this.ty=-(n$a*this.ty-n$b*n$e)/n$f,this},n$a.setTo=function(n$a,n$b,n$c,n$d,n$e,n$f){return this.a=n$a,this.b=n$b,this.c=n$c,this.d=n$d,this.tx=n$e,this.ty=n$f,this},n$a.concat=function(n$a){var n$b=this.a,n$c=this.c,n$d=this.tx;return this.a=n$b*n$a.a+this.b*n$a.c,this.b=n$b*n$a.b+this.b*n$a.d,this.c=n$c*n$a.a+this.d*n$a.c,this.d=n$c*n$a.b+this.d*n$a.d,this.tx=n$d*n$a.a+this.ty*n$a.c+n$a.tx,this.ty=n$d*n$a.b+this.ty*n$a.d+n$a.ty,this},n$a.scaleEx=function(n$a,n$b){var n$c=this.a,n$d=this.b,n$e=this.c,n$f=this.d;0!==n$d||0!==n$e?(this.a=n$a*n$c,this.b=n$a*n$d,this.c=n$b*n$e):(this.a=n$a*n$c,this.b=0*n$f,this.c=0*n$c),this.d=n$b*n$f,this.bTransform=!0},n$a.rotateEx=function(n$a){var n$b=Math.cos(n$a),n$c=Math.sin(n$a),n$d=this.a,n$e=this.b,n$f=this.c,n$g=this.d;0!==n$e||0!==n$f?(this.a=n$b*n$d+n$c*n$f,this.b=n$b*n$e+n$c*n$g,this.c=-n$c*n$d+n$b*n$f,this.d=-n$c*n$e+n$b*n$g):(this.a=n$b*n$d,this.b=n$c*n$g,this.c=-n$c*n$d,this.d=n$b*n$g),this.bTransform=!0},n$a.clone=function(){var n$a=n$c.create();return n$a.a=this.a,n$a.b=this.b,n$a.c=this.c,n$a.d=this.d,n$a.tx=this.tx,n$a.ty=this.ty,n$a.bTransform=this.bTransform,n$a},n$a.copyTo=function(n$a){return n$a.a=this.a,n$a.b=this.b,n$a.c=this.c,n$a.d=this.d,n$a.tx=this.tx,n$a.ty=this.ty,n$a.bTransform=this.bTransform,n$a},n$a.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},n$a.destroy=function(){if(!this.inPool){var n$a=n$c._cache;this.inPool=!0,n$a._length||(n$a._length=0),(n$a[n$a._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},n$c.mul=function(n$a,n$b,n$c){var n$d=n$a.a,n$e=n$a.b,n$f=n$a.c,n$g=n$a.d,n$h=n$a.tx,n$i=n$a.ty,n$j=n$b.a,n$k=n$b.b,n$l=n$b.c,n$m=n$b.d,n$n=n$b.tx,n$o=n$b.ty;return 0!==n$k||0!==n$l?(n$c.a=n$d*n$j+n$e*n$l,n$c.b=n$d*n$k+n$e*n$m,n$c.c=n$f*n$j+n$g*n$l,n$c.d=n$f*n$k+n$g*n$m,n$c.tx=n$j*n$h+n$l*n$i+n$n,n$c.ty=n$k*n$h+n$m*n$i+n$o):(n$c.a=n$d*n$j,n$c.b=n$e*n$m,n$c.c=n$f*n$j,n$c.d=n$g*n$m,n$c.tx=n$j*n$h+n$n,n$c.ty=n$m*n$i+n$o),n$c},n$c.mul16=function(n$a,n$b,n$c){var n$d=n$a.a,n$e=n$a.b,n$f=n$a.c,n$g=n$a.d,n$h=n$a.tx,n$i=n$a.ty,n$j=n$b.a,n$k=n$b.b,n$l=n$b.c,n$m=n$b.d,n$n=n$b.tx,n$o=n$b.ty;return 0!==n$k||0!==n$l?(n$c[0]=n$d*n$j+n$e*n$l,n$c[1]=n$d*n$k+n$e*n$m,n$c[4]=n$f*n$j+n$g*n$l,n$c[5]=n$f*n$k+n$g*n$m,n$c[12]=n$j*n$h+n$l*n$i+n$n,n$c[13]=n$k*n$h+n$m*n$i+n$o):(n$c[0]=n$d*n$j,n$c[1]=n$e*n$m,n$c[4]=n$f*n$j,n$c[5]=n$g*n$m,n$c[12]=n$j*n$h+n$n,n$c[13]=n$m*n$i+n$o),n$c},n$c.mulPre=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){var n$i=n$a.a,n$j=n$a.b,n$k=n$a.c,n$l=n$a.d,n$m=n$a.tx,n$n=n$a.ty;return 0!==n$c||0!==n$d?(n$h.a=n$i*n$b+n$j*n$d,n$h.b=n$i*n$c+n$j*n$e,n$h.c=n$k*n$b+n$l*n$d,n$h.d=n$k*n$c+n$l*n$e,n$h.tx=n$b*n$m+n$d*n$n+n$f,n$h.ty=n$c*n$m+n$e*n$n+n$g):(n$h.a=n$i*n$b,n$h.b=n$j*n$e,n$h.c=n$k*n$b,n$h.d=n$l*n$e,n$h.tx=n$b*n$m+n$f,n$h.ty=n$e*n$n+n$g),n$h},n$c.mulPos=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){var n$i=n$a.a,n$j=n$a.b,n$k=n$a.c,n$l=n$a.d,n$m=n$a.tx,n$n=n$a.ty;return 0!==n$j||0!==n$k?(n$h.a=n$b*n$i+n$c*n$k,n$h.b=n$b*n$j+n$c*n$l,n$h.c=n$d*n$i+n$e*n$k,n$h.d=n$d*n$j+n$e*n$l,n$h.tx=n$i*n$f+n$k*n$g+n$m,n$h.ty=n$j*n$f+n$l*n$g+n$n):(n$h.a=n$b*n$i,n$h.b=n$c*n$l,n$h.c=n$d*n$i,n$h.d=n$e*n$l,n$h.tx=n$i*n$f+n$m,n$h.ty=n$l*n$g+n$n),n$h},n$c.preMul=function(n$a,n$b,n$c){var n$d=n$a.a,n$e=n$a.b,n$f=n$a.c,n$g=n$a.d,n$h=n$b.a,n$i=n$b.b,n$j=n$b.c,n$k=n$b.d,n$l=n$b.tx,n$m=n$b.ty;return n$c.a=n$h*n$d,n$c.b=n$c.c=0,n$c.d=n$k*n$g,n$c.tx=n$l*n$d+n$a.tx,n$c.ty=n$m*n$g+n$a.ty,0===n$i&&0===n$j&&0===n$e&&0===n$f||(n$c.a+=n$i*n$f,n$c.d+=n$j*n$e,n$c.b+=n$h*n$e+n$i*n$g,n$c.c+=n$j*n$d+n$k*n$f,n$c.tx+=n$m*n$f,n$c.ty+=n$l*n$e),n$c},n$c.preMulXY=function(n$a,n$b,n$c,n$d){var n$e=n$a.a,n$f=n$a.b,n$g=n$a.c,n$h=n$a.d;return n$d.a=n$e,n$d.b=n$f,n$d.c=n$g,n$d.d=n$h,n$d.tx=n$b*n$e+n$a.tx+n$c*n$g,n$d.ty=n$c*n$h+n$a.ty+n$b*n$f,n$d},n$c.create=function(){var n$a=n$c._cache,n$b=n$a._length?n$a[--n$a._length]:new n$c;return n$b.inPool=!1,n$b},n$c.EMPTY=new n$c,n$c.TEMP=new n$c,n$c._cache=[],n$c}(),n$y=function(){function n$a(n$a,n$b){void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),this.x=n$a,this.y=n$b}n$k(n$a,"laya.maths.Point");var n$b=n$a.prototype;return n$b.setTo=function(n$a,n$b){return this.x=n$a,this.y=n$b,this},n$b.distance=function(n$a,n$b){return Math.sqrt((this.x-n$a)*(this.x-n$a)+(this.y-n$b)*(this.y-n$b))},n$b.toString=function(){return this.x+","+this.y},n$b.normalize=function(){var n$a=Math.sqrt(this.x*this.x+this.y*this.y);if(0<n$a){var n$b=1/n$a;this.x*=n$b,this.y*=n$b}},n$a.TEMP=new n$a,n$a.EMPTY=new n$a,n$a}(),n$z=function(){function n$j(n$a,n$b,n$c,n$d){void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=0),this.x=n$a,this.y=n$b,this.width=n$c,this.height=n$d}n$k(n$j,"laya.maths.Rectangle");var n$a=n$j.prototype;return n$a.setTo=function(n$a,n$b,n$c,n$d){return this.x=n$a,this.y=n$b,this.width=n$c,this.height=n$d,this},n$a.copyFrom=function(n$a){return this.x=n$a.x,this.y=n$a.y,this.width=n$a.width,this.height=n$a.height,this},n$a.contains=function(n$a,n$b){return!(this.width<=0||this.height<=0)&&(n$a>=this.x&&n$a<this.right&&n$b>=this.y&&n$b<this.bottom)},n$a.intersects=function(n$a){return!(n$a.x>this.x+this.width||n$a.x+n$a.width<this.x||n$a.y>this.y+this.height||n$a.y+n$a.height<this.y)},n$a.intersection=function(n$a,n$b){return this.intersects(n$a)?(n$b||(n$b=new n$j),n$b.x=Math.max(this.x,n$a.x),n$b.y=Math.max(this.y,n$a.y),n$b.width=Math.min(this.right,n$a.right)-n$b.x,n$b.height=Math.min(this.bottom,n$a.bottom)-n$b.y,n$b):null},n$a.union=function(n$a,n$b){return n$b||(n$b=new n$j),this.clone(n$b),n$a.width<=0||n$a.height<=0?n$b:(n$b.addPoint(n$a.x,n$a.y),n$b.addPoint(n$a.right,n$a.bottom),this)},n$a.clone=function(n$a){return n$a||(n$a=new n$j),n$a.x=this.x,n$a.y=this.y,n$a.width=this.width,n$a.height=this.height,n$a},n$a.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},n$a.equals=function(n$a){return!(!n$a||n$a.x!==this.x||n$a.y!==this.y||n$a.width!==this.width||n$a.height!==this.height)},n$a.addPoint=function(n$a,n$b){return this.x>n$a&&(this.width+=this.x-n$a,this.x=n$a),this.y>n$b&&(this.height+=this.y-n$b,this.y=n$b),this.width<n$a-this.x&&(this.width=n$a-this.x),this.height<n$b-this.y&&(this.height=n$b-this.y),this},n$a._getBoundPoints=function(){var n$a=n$j._temB;return(n$a.length=0)==this.width||0==this.height||n$a.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),n$a},n$a.isEmpty=function(){return this.width<=0||this.height<=0},n$o(0,n$a,"right",function(){return this.x+this.width}),n$o(0,n$a,"bottom",function(){return this.y+this.height}),n$j._getBoundPointS=function(n$a,n$b,n$c,n$d){var n$e=n$j._temA;return(n$e.length=0)==n$c||0==n$d||n$e.push(n$a,n$b,n$a+n$c,n$b,n$a,n$b+n$d,n$a+n$c,n$b+n$d),n$e},n$j._getWrapRec=function(n$a,n$b){if(!n$a||n$a.length<1)return n$b?n$b.setTo(0,0,0,0):n$j.TEMP.setTo(0,0,0,0);n$b=n$b||new n$j;var n$c,n$d,n$e,n$f,n$g,n$h=n$a.length,n$i=n$y.TEMP;for(n$e=n$g=-(n$d=n$f=99999),n$c=0;n$c<n$h;n$c+=2)n$i.x=n$a[n$c],n$i.y=n$a[n$c+1],n$d=n$d<n$i.x?n$d:n$i.x,n$f=n$f<n$i.y?n$f:n$i.y,n$e=n$e>n$i.x?n$e:n$i.x,n$g=n$g>n$i.y?n$g:n$i.y;return n$b.setTo(n$d,n$f,n$e-n$d,n$g-n$f)},n$j.EMPTY=new n$j,n$j.TEMP=new n$j,n$j._temB=[],n$j._temA=[],n$j}(),n$E=function(){function n$i(){}return n$k(n$i,"laya.media.SoundManager"),n$o(1,n$i,"useAudioMusic",function(){return n$i._useAudioMusic},function(n$a){n$i._useAudioMusic=n$a,n$i._musicClass=n$a?n$ca:null}),n$o(1,n$i,"autoStopMusic",function(){return n$i._autoStopMusic},function(n$a){n$x.stage.off("blur",null,n$i._stageOnBlur),n$x.stage.off("focus",null,n$i._stageOnFocus),n$x.stage.off("visibilitychange",null,n$i._visibilityChange),(n$i._autoStopMusic=n$a)&&(n$x.stage.on("blur",null,n$i._stageOnBlur),n$x.stage.on("focus",null,n$i._stageOnFocus),n$x.stage.on("visibilitychange",null,n$i._visibilityChange))}),n$o(1,n$i,"muted",function(){return n$i._muted},function(n$a){n$a!=n$i._muted&&(n$a&&n$i.stopAllSound(),n$i.musicMuted=n$a,n$i._muted=n$a)}),n$o(1,n$i,"musicMuted",function(){return n$i._musicMuted},function(n$a){n$a!=n$i._musicMuted&&(n$a?(n$i._tMusic&&n$i._musicChannel&&!n$i._musicChannel.isStopped?n$i._musicChannel.pause():n$i._musicChannel=null,n$i._musicMuted=n$a):(n$i._musicMuted=n$a,n$i._tMusic&&n$i._musicChannel&&n$i._musicChannel.resume()))}),n$o(1,n$i,"soundMuted",function(){return n$i._soundMuted},function(n$a){n$i._soundMuted=n$a}),n$i.addChannel=function(n$a){0<=n$i._channels.indexOf(n$a)||(n$i._channels.push(n$a),n$i.autoReleaseSound&&0!=n$i._notUsedCount&&n$i._notUsedUrls[n$a.url]&&(delete n$i._notUsedUrls[n$a.url],0==--n$i._notUsedCount&&n$x.timer.clear(n$i,n$i.disposeSoundIfNotUsed)))},n$i.removeChannel=function(n$a){var n$b=n$i._channels,n$c=n$b.indexOf(n$a);if(-1!=n$c&&(n$b.splice(n$c,1),n$i.autoReleaseSound)){var n$d=n$a.url,n$e=n$i.defaultIntervals[n$d]||2e4;if(0<n$e){var n$f=!0;for(n$c=n$b.length-1;0<=n$c;n$c--)if(n$b[n$c].url==n$d){n$f=!1;break}n$f&&(n$i._notUsedUrls[n$d]=Date.now()+n$e,0==n$i._notUsedCount++&&n$x.timer.loop(1e4,n$i,n$i.disposeSoundIfNotUsed))}}},n$i.disposeSoundIfNotUsed=function(){var n$a=n$i._notUsedUrls;if(0!=n$i._notUsedCount){var n$b=Date.now();for(var n$c in n$a)n$b>=n$a[n$c]&&(delete n$a[n$c],--n$i._notUsedCount,n$i.destroySound(n$c));if(0!=n$i._notUsedCount)return}n$x.timer.clear(n$i,n$i.disposeSoundIfNotUsed)},n$i._visibilityChange=function(){n$x.stage.isVisibility?n$i._stageOnFocus():n$i._stageOnBlur()},n$i._stageOnBlur=function(){n$i._isActive=!1,n$i._musicChannel&&(n$i._musicChannel.isStopped||(n$i._blurPaused=!0,n$i._musicChannel.pause())),n$i.stopAllSound(),n$x.stage.once("mousedown",null,n$i._stageOnFocus)},n$i._recoverWebAudio=function(){n$fa.ctx&&"running"!=n$fa.ctx.state&&n$fa.ctx.resume&&n$fa.ctx.resume()},n$i._stageOnFocus=function(){if(n$i._isActive=!0,n$i._recoverWebAudio(),n$x.stage.off("mousedown",null,n$i._stageOnFocus),n$i._blurPaused){var n$a=n$i._musicChannel;n$a&&n$i._music&&n$a.isStopped&&(n$i._blurPaused=!1,n$i._music._disposed?n$i.playMusic(n$a.url,n$a.loops,n$a.startHandler,n$a.completeHandler,n$a.startTime):n$a.audioBuffer?n$a.resume():n$i._music.play(n$a.startTime,n$a.loops,n$a.startHandler,n$a))}},n$i.playSound=function(n$a,n$b,n$c,n$d,n$e,n$f){if(void 0===n$b&&(n$b=1),void 0===n$f&&(n$f=0),!n$a)return null;if(n$i._muted)return null;if(n$i._recoverWebAudio(),n$a==n$i._tMusic){if(n$i._musicMuted)return null}else{if(!n$i._isActive)return null;if(n$i._soundMuted)return null}var n$g,n$h=n$i._pool[n$a];return n$e||(n$e=n$i._soundClass),n$h||((n$h=new n$e).load(n$a),n$i._pool[n$a]=n$h),(n$g=n$h.play(n$f,n$b,n$c))?(n$a==n$i._tMusic&&(n$i._music=n$h,n$i._isActive||(n$i._blurPaused=!0,n$g.pause())),n$g.url=n$a,n$g.volume=n$a==n$i._tMusic?n$i.musicVolume:n$i.soundVolume,n$g.completeHandler=n$d,n$g):null},n$i.destroySound=function(n$a){var n$b=n$i._pool[n$a];n$b&&(delete n$i._pool[n$a],n$b.dispose())},n$i.playMusic=function(n$a,n$b,n$c,n$d,n$e){return void 0===n$b&&(n$b=0),void 0===n$e&&(n$e=0),n$i._tMusic=n$a,n$i._musicChannel&&n$i._musicChannel.stop(),n$i._musicChannel=n$i.playSound(n$a,n$b,n$c,n$d,null,n$e)},n$i.stopSound=function(n$a){for(var n$b,n$c=n$i._channels.length-1;0<=n$c;n$c--)(n$b=n$i._channels[n$c]).url==n$a&&n$b.stop()},n$i.stopAll=function(){n$i._tMusic=null;var n$a=0;for(n$a=n$i._channels.length-1;0<=n$a;n$a--)n$i._channels[n$a].stop()},n$i.stopAllSound=function(){var n$a,n$b=0;for(n$b=n$i._channels.length-1;0<=n$b;n$b--)(n$a=n$i._channels[n$b]).url!=n$i._tMusic&&n$a.stop()},n$i.stopMusic=function(){n$i._musicChannel&&n$i._musicChannel.stop(),n$i._tMusic=null},n$i.setSoundVolume=function(n$a,n$b){if(n$b)n$i._setVolume(n$b,n$a);else{n$i.soundVolume=n$a;var n$c,n$d=0;for(n$d=n$i._channels.length-1;0<=n$d;n$d--)(n$c=n$i._channels[n$d]).url!=n$i._tMusic&&(n$c.volume=n$a)}},n$i.setMusicVolume=function(n$a){n$i.musicVolume=n$a,n$i._setVolume(n$i._tMusic,n$a)},n$i._setVolume=function(n$a,n$b){for(var n$c,n$d=n$i._channels.length-1;0<=n$d;n$d--)(n$c=n$i._channels[n$d]).url==n$a&&(n$c.volume=n$b)},n$i.musicVolume=1,n$i.soundVolume=1,n$i.playbackRate=1,n$i._useAudioMusic=!0,n$i._muted=!1,n$i._soundMuted=!1,n$i._musicMuted=!1,n$i._tMusic=null,n$i._musicChannel=null,n$i._music=null,n$i._channels=[],n$i._autoStopMusic=!1,n$i._blurPaused=!1,n$i._isActive=!0,n$i._soundClass=null,n$i._musicClass=null,n$i.autoReleaseSound=!0,n$i._pool={},n$i.defaultIntervals={},n$i._notUsedUrls={},n$i._notUsedCount=0,n$i}(),n$C=function(){var n$a;function n$c(){}return n$k(n$c,"laya.net.LocalStorage"),n$c.__init__=function(){n$c._baseClass||(n$c._baseClass=n$a).init(),n$c.items=n$c._baseClass.items,n$c.support=n$c._baseClass.support},n$c.setItem=function(n$a,n$b){n$c._baseClass.setItem(n$a,n$b)},n$c.getItem=function(n$a){return n$c._baseClass.getItem(n$a)},n$c.setJSON=function(n$a,n$b){n$c._baseClass.setJSON(n$a,n$b)},n$c.getJSON=function(n$a){return n$c._baseClass.getJSON(n$a)},n$c.removeItem=function(n$a){n$c._baseClass.removeItem(n$a)},n$c.clear=function(){n$c._baseClass.clear()},n$c._baseClass=null,n$c.items=null,n$c.support=!1,n$c.__init$=function(){n$a=function(){function n$c(){}return n$k(n$c,""),n$c.init=function(){try{n$c.support=!0,n$c.items=n$g.localStorage,n$c.setItem("laya","1"),n$c.removeItem("laya")}catch(n$a){n$c.support=!1}n$c.support||console.log("LocalStorage is not supprot or browser is private mode.")},n$c.setItem=function(n$a,n$b){try{n$c.support&&n$c.items.setItem(n$a,n$b)}catch(n$a){console.warn("set localStorage failed",n$a)}},n$c.getItem=function(n$a){return n$c.support?n$c.items.getItem(n$a):null},n$c.setJSON=function(n$a,n$b){try{n$c.support&&n$c.items.setItem(n$a,JSON.stringify(n$b))}catch(n$a){console.warn("set localStorage failed",n$a)}},n$c.getJSON=function(n$a){return JSON.parse(n$c.support?n$c.items.getItem(n$a):null)},n$c.removeItem=function(n$a){n$c.support&&n$c.items.removeItem(n$a)},n$c.clear=function(){n$c.support&&n$c.items.clear()},n$c.items=null,n$c.support=!1,n$c}()},n$c}(),n$H=(function(){function n$d(){}n$k(n$d,"laya.net.ResourceVersion"),n$d.enable=function(n$a,n$b,n$c){void 0===n$c&&(n$c=2),laya.net.ResourceVersion.type=n$c,n$x.loader.load(n$a,n$s.create(null,n$d.onManifestLoaded,[n$b]),null,"json"),n$I.customFormat=n$d.addVersionPrefix},n$d.onManifestLoaded=function(n$a,n$b){n$d.manifest=n$b,n$a.run(),n$b||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},n$d.addVersionPrefix=function(n$a){return n$d.manifest&&n$d.manifest[n$a]?2==n$d.type?n$d.manifest[n$a]:n$d.manifest[n$a]+"/"+n$a:n$a},n$d.FOLDER_VERSION=1,n$d.FILENAME_VERSION=2,n$d.manifest=null,n$d.type=1}(),function(){function n$a(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}n$k(n$a,"laya.net.TTFLoader");var n$b=n$a.prototype;return n$b.load=function(n$a){var n$b=(this._url=n$a).split(".ttf")[0].split("/");this.fontName=n$b[n$b.length-1],n$O.window.conch?this._loadConch():n$O.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},n$b._loadConch=function(){this._http=new n$ga,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},n$b._onHttpLoaded=function(n$a){n$O.window.conch.setFontFaceFromBuffer(this.fontName,n$a),this._clearHttp(),this._complete()},n$b._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},n$b._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},n$b._complete=function(){n$x.timer.clear(this,this._complete),n$x.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},n$b._checkComplete=function(){n$F.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},n$b._loadWithFontFace=function(){var n$a=new n$O.window.FontFace(this.fontName,"url('"+this._url+"')");n$O.window.document.fonts.add(n$a);var n$b=this;n$a.loaded.then(function(){n$b._complete()}),n$a.load()},n$b._createDiv=function(){this._div=n$O.createElement("div"),this._div.innerHTML="laya";var n$a=this._div.style;n$a.fontFamily=this.fontName,n$a.position="absolute",n$a.left="-100px",n$a.top="-100px",n$O.document.body.appendChild(this._div)},n$b._loadWithCSS=function(){var n$a=this,n$b=n$O.createElement("style");n$b.type="text/css",n$O.document.body.appendChild(n$b),n$b.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=n$F.measureText("LayaTTFFont",this._fontTxt).width;var n$c=this;n$b.onload=function(){n$x.timer.once(1e4,n$c,n$a._complete)},n$x.timer.loop(20,this,this._checkComplete),this._createDiv()},n$a._testString="LayaTTFFont",n$a}()),n$I=function(){function n$d(n$a){this._url=null,this._path=null,this._url=n$d.formatURL(n$a),this._path=n$d.getPath(n$a)}n$k(n$d,"laya.net.URL");var n$a=n$d.prototype;return n$o(0,n$a,"path",function(){return this._path}),n$o(0,n$a,"url",function(){return this._url}),n$d.formatURL=function(n$a,n$b){if(!n$a)return"null path";if(0<n$a.indexOf(":"))return n$a;null!=n$d.customFormat&&(n$a=n$d.customFormat(n$a,n$b));var n$c=n$a.charAt(0);if("."===n$c)return n$d.formatRelativePath((n$b||n$d.basePath)+n$a);if("~"===n$c)return n$d.rootPath+n$a.substring(1);if("d"===n$c){if(0===n$a.indexOf("data:image"))return n$a}else if("/"===n$c)return n$a;return(n$b||n$d.basePath)+n$a},n$d.formatRelativePath=function(n$a){for(var n$b=n$a.split("/"),n$c=0,n$d=n$b.length;n$c<n$d;n$c++)".."==n$b[n$c]&&(n$b.splice(n$c-1,2),n$c-=2);return n$b.join("/")},n$d.isAbsolute=function(n$a){return 0<n$a.indexOf(":")||"/"==n$a.charAt(0)},n$d.getPath=function(n$a){var n$b=n$a.lastIndexOf("/");return 0<n$b?n$a.substr(0,n$b+1):""},n$d.getFileName=function(n$a){var n$b=n$a.lastIndexOf("/");return 0<n$b?n$a.substr(n$b+1):n$a},n$d.version={},n$d.basePath="",n$d.rootPath="",n$d.customFormat=function(n$a){var n$b=n$d.version[n$a];return!n$J.isConchApp&&n$b&&(n$a+="?v="+n$b),n$a},n$d}(),n$J=function(){function n$e(n$a,n$b){this._timeId=0;var n$c=n$e._mainCanvas.source.style;n$c.position="absolute",n$c.top=n$c.left="0px",n$c.background="#000000",n$e._mainCanvas.source.id="layaCanvas";var n$d=laya.renders.Render.isWebGL;n$e._mainCanvas.source.width=n$a,n$e._mainCanvas.source.height=n$b,n$d&&n$e.WebGL.init(n$e._mainCanvas,n$a,n$b),n$O.container.appendChild(n$e._mainCanvas.source),(n$e._context=new n$K(n$a,n$b,n$d?null:n$e._mainCanvas)).ctx.setIsMainContext(),n$O.window.requestAnimationFrame(function n$a(n$b){n$O.window.requestAnimationFrame(n$a);n$x.stage._loop()}),n$x.stage.on("visibilitychange",this,this._onVisibilitychange)}n$k(n$e,"laya.renders.Render");var n$a=n$e.prototype;return n$a._onVisibilitychange=function(){n$x.stage.isVisibility?0!=this._timeId&&n$O.window.clearInterval(this._timeId):this._timeId=n$O.window.setInterval(this._enterFrame,1e3)},n$a._enterFrame=function(n$a){n$x.stage._loop()},n$o(1,n$e,"context",function(){return n$e._context}),n$o(1,n$e,"canvas",function(){return n$e._mainCanvas.source}),n$e._context=null,n$e._mainCanvas=null,n$e.WebGL=null,n$e.isConchNode=!1,n$e.isConchApp=!1,n$e.isConchWebGL=!1,n$e.isWebGL=!1,n$e.is3DMode=!1,n$e.optimizeTextureMemory=function(n$a,n$b){return!0},n$e.__init$=function(){n$g.ConchRenderType=n$g.ConchRenderType||1,n$g.ConchRenderType|=n$g.conch?4:0,n$e.isConchNode=5==(5&n$g.ConchRenderType),n$e.isConchApp=4==(4&n$g.ConchRenderType),n$e.isConchWebGL=6==n$g.ConchRenderType},n$e}(),n$K=function(){function n$g(n$a,n$b,n$c){this.x=0,this.y=0,this._drawTexture=function(n$a,n$b,n$c){n$c[0].loaded&&this.ctx.drawTexture(n$c[0],n$c[1],n$c[2],n$c[3],n$c[4],n$a,n$b)},this._fillTexture=function(n$a,n$b,n$c){n$c[0].loaded&&this.ctx.fillTexture(n$c[0],n$c[1]+n$a,n$c[2]+n$b,n$c[3],n$c[4],n$c[5],n$c[6],n$c[7])},this._drawTextureWithTransform=function(n$a,n$b,n$c){n$c[0].loaded&&this.ctx.drawTextureWithTransform(n$c[0],n$c[1],n$c[2],n$c[3],n$c[4],n$c[5],n$a,n$b,n$c[6])},this._fillQuadrangle=function(n$a,n$b,n$c){this.ctx.fillQuadrangle(n$c[0],n$c[1],n$c[2],n$c[3],n$c[4])},this._drawRect=function(n$a,n$b,n$c){var n$d=this.ctx;null!=n$c[4]&&(n$d.fillStyle=n$c[4],n$d.fillRect(n$a+n$c[0],n$b+n$c[1],n$c[2],n$c[3],null)),null!=n$c[5]&&(n$d.strokeStyle=n$c[5],n$d.lineWidth=n$c[6],n$d.strokeRect(n$a+n$c[0],n$b+n$c[1],n$c[2],n$c[3],n$c[6]))},this._drawPie=function(n$a,n$b,n$c){var n$d=this.ctx;n$J.isWebGL&&n$d.setPathId(n$c[8]),n$d.beginPath(),n$J.isWebGL?(n$d.movePath(n$c[0]+n$a,n$c[1]+n$b),n$d.moveTo(0,0)):n$d.moveTo(n$a+n$c[0],n$b+n$c[1]),n$d.arc(n$a+n$c[0],n$b+n$c[1],n$c[2],n$c[3],n$c[4]),n$d.closePath(),this._fillAndStroke(n$c[5],n$c[6],n$c[7],!0)},this._clipRect=function(n$a,n$b,n$c){this.ctx.clipRect(n$a+n$c[0],n$b+n$c[1],n$c[2],n$c[3])},this._fillRect=function(n$a,n$b,n$c){this.ctx.fillRect(n$a+n$c[0],n$b+n$c[1],n$c[2],n$c[3],n$c[4])},this._drawCircle=function(n$a,n$b,n$c){var n$d=this.ctx;n$J.isWebGL&&n$d.setPathId(n$c[6]),n$X.drawCall++,n$d.beginPath(),n$J.isWebGL&&n$d.movePath(n$c[0]+n$a,n$c[1]+n$b),n$d.arc(n$c[0]+n$a,n$c[1]+n$b,n$c[2],0,n$g.PI2),n$d.closePath(),this._fillAndStroke(n$c[3],n$c[4],n$c[5],!0)},this._fillCircle=function(n$a,n$b,n$c){n$X.drawCall++;var n$d=this.ctx;n$d.beginPath(),n$d.fillStyle=n$c[3],n$d.arc(n$c[0]+n$a,n$c[1]+n$b,n$c[2],0,n$g.PI2),n$d.fill()},this._setShader=function(n$a,n$b,n$c){this.ctx.setShader(n$c[0])},this._drawLine=function(n$a,n$b,n$c){var n$d=this.ctx;n$J.isWebGL&&n$d.setPathId(n$c[6]),n$d.beginPath(),n$d.strokeStyle=n$c[4],n$d.lineWidth=n$c[5],n$J.isWebGL?(n$d.movePath(n$a,n$b),n$d.moveTo(n$c[0],n$c[1]),n$d.lineTo(n$c[2],n$c[3])):(n$d.moveTo(n$a+n$c[0],n$b+n$c[1]),n$d.lineTo(n$a+n$c[2],n$b+n$c[3])),n$d.stroke()},this._drawLines=function(n$a,n$b,n$c){var n$d=this.ctx;n$J.isWebGL&&n$d.setPathId(n$c[5]),n$d.beginPath(),n$a+=n$c[0],n$b+=n$c[1],n$J.isWebGL&&n$d.movePath(n$a,n$b),n$d.strokeStyle=n$c[3],n$d.lineWidth=n$c[4];var n$e=n$c[2],n$f=2,n$g=n$e.length;if(n$J.isWebGL)for(n$d.moveTo(n$e[0],n$e[1]);n$f<n$g;)n$d.lineTo(n$e[n$f++],n$e[n$f++]);else for(n$d.moveTo(n$a+n$e[0],n$b+n$e[1]);n$f<n$g;)n$d.lineTo(n$a+n$e[n$f++],n$b+n$e[n$f++]);n$d.stroke()},this._drawLinesWebGL=function(n$a,n$b,n$c){this.ctx.drawLines(n$a+this.x+n$c[0],n$b+this.y+n$c[1],n$c[2],n$c[3],n$c[4])},this._drawCurves=function(n$a,n$b,n$c){this.ctx.drawCurves(n$a,n$b,n$c)},this._draw=function(n$a,n$b,n$c){n$c[0].call(null,this,n$a,n$b)},this._transformByMatrix=function(n$a,n$b,n$c){this.ctx.transformByMatrix(n$c[0])},this._setTransform=function(n$a,n$b,n$c){this.ctx.setTransform(n$c[0],n$c[1],n$c[2],n$c[3],n$c[4],n$c[5])},this._setTransformByMatrix=function(n$a,n$b,n$c){this.ctx.setTransformByMatrix(n$c[0])},this._save=function(n$a,n$b,n$c){this.ctx.save()},this._restore=function(n$a,n$b,n$c){this.ctx.restore()},this._translate=function(n$a,n$b,n$c){this.ctx.translate(n$c[0],n$c[1])},this._transform=function(n$a,n$b,n$c){this.ctx.translate(n$c[1]+n$a,n$c[2]+n$b);var n$d=n$c[0];this.ctx.transform(n$d.a,n$d.b,n$d.c,n$d.d,n$d.tx,n$d.ty),this.ctx.translate(-n$a-n$c[1],-n$b-n$c[2])},this._rotate=function(n$a,n$b,n$c){this.ctx.translate(n$c[1]+n$a,n$c[2]+n$b),this.ctx.rotate(n$c[0]),this.ctx.translate(-n$a-n$c[1],-n$b-n$c[2])},this._scale=function(n$a,n$b,n$c){this.ctx.translate(n$c[2]+n$a,n$c[3]+n$b),this.ctx.scale(n$c[0],n$c[1]),this.ctx.translate(-n$a-n$c[2],-n$b-n$c[3])},this._alpha=function(n$a,n$b,n$c){this.ctx.globalAlpha*=n$c[0]},this._setAlpha=function(n$a,n$b,n$c){this.ctx.globalAlpha=n$c[0]},this._fillText=function(n$a,n$b,n$c){this.ctx.fillText(n$c[0],n$c[1]+n$a,n$c[2]+n$b,n$c[3],n$c[4],n$c[5])},this._strokeText=function(n$a,n$b,n$c){this.ctx.strokeText(n$c[0],n$c[1]+n$a,n$c[2]+n$b,n$c[3],n$c[4],n$c[5],n$c[6])},this._fillBorderText=function(n$a,n$b,n$c){this.ctx.fillBorderText(n$c[0],n$c[1]+n$a,n$c[2]+n$b,n$c[3],n$c[4],n$c[5],n$c[6],n$c[7])},this._blendMode=function(n$a,n$b,n$c){this.ctx.globalCompositeOperation=n$c[0]},this._beginClip=function(n$a,n$b,n$c){this.ctx.beginClip&&this.ctx.beginClip(n$a+n$c[0],n$b+n$c[1],n$c[2],n$c[3])},this._setIBVB=function(n$a,n$b,n$c){this.ctx.setIBVB(n$c[0]+n$a,n$c[1]+n$b,n$c[2],n$c[3],n$c[4],n$c[5],n$c[6],n$c[7])},this._fillTrangles=function(n$a,n$b,n$c){this.ctx.fillTrangles(n$c[0],n$c[1]+n$a,n$c[2]+n$b,n$c[3],n$c[4])},this._drawPath=function(n$a,n$b,n$c){var n$d=this.ctx;n$J.isWebGL&&n$d.setPathId(-1),n$d.beginPath(),n$a+=n$c[0],n$b+=n$c[1],n$J.isWebGL&&n$d.movePath(n$a,n$b);for(var n$e=n$c[2],n$f=0,n$g=n$e.length;n$f<n$g;n$f++){var n$h=n$e[n$f];switch(n$h[0]){case"moveTo":n$J.isWebGL?n$d.moveTo(n$h[1],n$h[2]):n$d.moveTo(n$a+n$h[1],n$b+n$h[2]);break;case"lineTo":n$J.isWebGL?n$d.lineTo(n$h[1],n$h[2]):n$d.lineTo(n$a+n$h[1],n$b+n$h[2]);break;case"arcTo":n$J.isWebGL?n$d.arcTo(n$h[1],n$h[2],n$h[3],n$h[4],n$h[5]):n$d.arcTo(n$a+n$h[1],n$b+n$h[2],n$a+n$h[3],n$b+n$h[4],n$h[5]);break;case"closePath":n$d.closePath()}}var n$i=n$c[3];null!=n$i&&(n$d.fillStyle=n$i.fillStyle,n$d.fill());var n$j=n$c[4];null!=n$j&&(n$d.strokeStyle=n$j.strokeStyle,n$d.lineWidth=n$j.lineWidth||1,n$d.lineJoin=n$j.lineJoin,n$d.lineCap=n$j.lineCap,n$d.miterLimit=n$j.miterLimit,n$d.stroke())},this.drawPoly=function(n$a,n$b,n$c){this.ctx.drawPoly(n$a+this.x+n$c[0],n$b+this.y+n$c[1],n$c[2],n$c[3],n$c[4],n$c[5],n$c[6])},this._drawPoly=function(n$a,n$b,n$c){var n$d=this.ctx,n$e=n$c[2],n$f=2,n$g=n$e.length;if(n$J.isWebGL)for(n$d.setPathId(n$c[6]),n$d.beginPath(),n$a+=n$c[0],n$b+=n$c[1],n$d.movePath(n$a,n$b),n$d.moveTo(n$e[0],n$e[1]);n$f<n$g;)n$d.lineTo(n$e[n$f++],n$e[n$f++]);else for(n$d.beginPath(),n$a+=n$c[0],n$b+=n$c[1],n$d.moveTo(n$a+n$e[0],n$b+n$e[1]);n$f<n$g;)n$d.lineTo(n$a+n$e[n$f++],n$b+n$e[n$f++]);n$d.closePath(),this._fillAndStroke(n$c[3],n$c[4],n$c[5],n$c[7])},this._drawSkin=function(n$a,n$b,n$c){var n$d=n$c[0];if(n$d){var n$e=this.ctx;n$d.render(n$e,n$a,n$b)}},this._drawParticle=function(n$a,n$b,n$c){this.ctx.drawParticle(n$a+this.x,n$b+this.y,n$c[0])},this._setFilters=function(n$a,n$b,n$c){this.ctx.setFilters(n$c)},n$c?this.ctx=n$c.getContext("2d"):(n$c=n$ta.create("3D"),this.ctx=n$F.createWebGLContext2D(n$c),n$c._setContext(this.ctx)),n$c.size(n$a,n$b),this.canvas=n$c}n$k(n$g,"laya.renders.RenderContext");var n$a=n$g.prototype;return n$a.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},n$a.drawTexture=function(n$a,n$b,n$c,n$d,n$e){n$a.loaded&&this.ctx.drawTexture(n$a,n$b,n$c,n$d,n$e,this.x,this.y)},n$a._drawTextures=function(n$a,n$b,n$c){n$c[0].loaded&&this.ctx.drawTextures(n$c[0],n$c[1],n$a+this.x,n$b+this.y)},n$a.drawTextureWithTransform=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){n$a.loaded&&this.ctx.drawTextureWithTransform(n$a,n$b,n$c,n$d,n$e,n$f,this.x,this.y,n$g)},n$a.fillQuadrangle=function(n$a,n$b,n$c,n$d,n$e){this.ctx.fillQuadrangle(n$a,n$b,n$c,n$d,n$e)},n$a.drawCanvas=function(n$a,n$b,n$c,n$d,n$e){this.ctx.drawCanvas(n$a,n$b+this.x,n$c+this.y,n$d,n$e)},n$a.drawRect=function(n$a,n$b,n$c,n$d,n$e,n$f){void 0===n$f&&(n$f=1);var n$g=this.ctx;n$g.strokeStyle=n$e,n$g.lineWidth=n$f,n$g.strokeRect(n$a+this.x,n$b+this.y,n$c,n$d,n$f)},n$a._fillAndStroke=function(n$a,n$b,n$c,n$d){void 0===n$d&&(n$d=!1);var n$e=this.ctx;null!=n$a&&(n$e.fillStyle=n$a,n$J.isWebGL?n$e.fill(n$d):n$e.fill()),null!=n$b&&0<n$c&&(n$e.strokeStyle=n$b,n$e.lineWidth=n$c,n$e.stroke())},n$a.clipRect=function(n$a,n$b,n$c,n$d){this.ctx.clipRect(n$a+this.x,n$b+this.y,n$c,n$d)},n$a.fillRect=function(n$a,n$b,n$c,n$d,n$e){this.ctx.fillRect(n$a+this.x,n$b+this.y,n$c,n$d,n$e)},n$a.drawCircle=function(n$a,n$b,n$c,n$d,n$e){void 0===n$e&&(n$e=1),n$X.drawCall++;var n$f=this.ctx;n$f.beginPath(),n$f.strokeStyle=n$d,n$f.lineWidth=n$e,n$f.arc(n$a+this.x,n$b+this.y,n$c,0,n$g.PI2),n$f.stroke()},n$a.drawTriangles=function(n$a,n$b,n$c){if(n$J.isWebGL)this.ctx.drawTriangles(n$c[0],n$a+n$c[1],n$b+n$c[2],n$c[3],n$c[4],n$c[5],n$c[6],n$c[7],n$c[8],n$c[9]);else{var n$d=n$c[5],n$e=0,n$f=n$d.length,n$g=this.ctx;for(n$e=0;n$e<n$f;n$e+=3){var n$h=2*n$d[n$e],n$i=2*n$d[n$e+1],n$j=2*n$d[n$e+2];n$g.drawTriangle(n$c[0],n$c[3],n$c[4],n$h,n$i,n$j,n$c[6],!0)}}},n$a.fillCircle=function(n$a,n$b,n$c,n$d){n$X.drawCall++;var n$e=this.ctx;n$e.beginPath(),n$e.fillStyle=n$d,n$e.arc(n$a+this.x,n$b+this.y,n$c,0,n$g.PI2),n$e.fill()},n$a.setShader=function(n$a){this.ctx.setShader(n$a)},n$a.drawLine=function(n$a,n$b,n$c,n$d,n$e,n$f){void 0===n$f&&(n$f=1);var n$g=this.ctx;n$g.beginPath(),n$g.strokeStyle=n$e,n$g.lineWidth=n$f,n$g.moveTo(this.x+n$a,this.y+n$b),n$g.lineTo(this.x+n$c,this.y+n$d),n$g.stroke()},n$a.clear=function(){this.ctx.clear()},n$a.transformByMatrix=function(n$a){this.ctx.transformByMatrix(n$a)},n$a.setTransform=function(n$a,n$b,n$c,n$d,n$e,n$f){this.ctx.setTransform(n$a,n$b,n$c,n$d,n$e,n$f)},n$a.setTransformByMatrix=function(n$a){this.ctx.setTransformByMatrix(n$a)},n$a.save=function(){this.ctx.save()},n$a.restore=function(){this.ctx.restore()},n$a.translate=function(n$a,n$b){this.ctx.translate(n$a,n$b)},n$a.transform=function(n$a,n$b,n$c,n$d,n$e,n$f){this.ctx.transform(n$a,n$b,n$c,n$d,n$e,n$f)},n$a.rotate=function(n$a){this.ctx.rotate(n$a)},n$a.scale=function(n$a,n$b){this.ctx.scale(n$a,n$b)},n$a.alpha=function(n$a){this.ctx.globalAlpha*=n$a},n$a.setAlpha=function(n$a){this.ctx.globalAlpha=n$a},n$a.fillWords=function(n$a,n$b,n$c,n$d,n$e,n$f){void 0===n$f&&(n$f=0),this.ctx.fillWords(n$a,n$b,n$c,n$d,n$e,n$f)},n$a.fillBorderWords=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this.ctx.fillBorderWords(n$a,n$b,n$c,n$d,n$e,n$f,n$g)},n$a.fillText=function(n$a,n$b,n$c,n$d,n$e,n$f){this.ctx.fillText(n$a,n$b+this.x,n$c+this.y,n$d,n$e,n$f)},n$a.strokeText=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this.ctx.strokeText(n$a,n$b+this.x,n$c+this.y,n$d,n$e,n$f,n$g)},n$a.blendMode=function(n$a){this.ctx.globalCompositeOperation=n$a},n$a.flush=function(){this.ctx.flush&&this.ctx.flush()},n$a.addRenderObject=function(n$a){this.ctx.addRenderObject(n$a)},n$a.beginClip=function(n$a,n$b,n$c,n$d){this.ctx.beginClip&&this.ctx.beginClip(n$a,n$b,n$c,n$d)},n$a.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},n$a.fillTrangles=function(n$a,n$b,n$c){this.ctx.fillTrangles(n$c[0],n$c[1],n$c[2],n$c[3],4<n$c.length?n$c[4]:null)},n$g.PI2=2*Math.PI,n$g}(),n$L=function(){function n$g(n$a,n$b){switch(this._next=n$b||n$g.NORENDER,n$a){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=n$r._filter);case 69905:return void(this._fun=n$g._initRenderFun)}this.onCreate(n$a)}n$k(n$g,"laya.renders.RenderSprite");var n$a=n$g.prototype;return n$a.onCreate=function(n$a){},n$a._style=function(n$a,n$b,n$c,n$d){n$a._style.render(n$a,n$b,n$c,n$d);var n$e=this._next;n$e._fun.call(n$e,n$a,n$b,n$c,n$d)},n$a._no=function(n$a,n$b,n$c,n$d){},n$a._custom=function(n$a,n$b,n$c,n$d){n$a.customRender(n$b,n$c,n$d);var n$e=n$a._style._tf;this._next._fun.call(this._next,n$a,n$b,n$c-n$e.translateX,n$d-n$e.translateY)},n$a._clip=function(n$a,n$b,n$c,n$d){var n$e=this._next;if(n$e!=n$g.NORENDER){var n$f=n$a._style.scrollRect;n$b.ctx.save(),n$b.ctx.clipRect(n$c,n$d,n$f.width,n$f.height),n$e._fun.call(n$e,n$a,n$b,n$c-n$f.x,n$d-n$f.y),n$b.ctx.restore()}},n$a._blend=function(n$a,n$b,n$c,n$d){var n$e=n$a._style;n$e.blendMode&&(n$b.ctx.globalCompositeOperation=n$e.blendMode);var n$f=this._next;n$f._fun.call(n$f,n$a,n$b,n$c,n$d),n$b.ctx.globalCompositeOperation="source-over"},n$a._mask=function(n$a,n$b,n$c,n$d){var n$e=this._next;n$e._fun.call(n$e,n$a,n$b,n$c,n$d);var n$f=n$a.mask;n$f&&(n$b.ctx.globalCompositeOperation="destination-in",(0<n$f.numChildren||!n$f.graphics._isOnlyOne())&&(n$f.cacheAsBitmap=!0),n$f.render(n$b,n$c-n$a.pivotX,n$d-n$a.pivotY)),n$b.ctx.globalCompositeOperation="source-over"},n$a._graphics=function(n$a,n$b,n$c,n$d){var n$e=n$a._style._tf;n$a._graphics&&n$a._graphics._render(n$a,n$b,n$c-n$e.translateX,n$d-n$e.translateY);var n$f=this._next;n$f._fun.call(n$f,n$a,n$b,n$c,n$d)},n$a._image=function(n$a,n$b,n$c,n$d){var n$e=n$a._style;n$b.ctx.drawTexture2(n$c,n$d,n$e._tf.translateX,n$e._tf.translateY,n$a.transform,n$e.alpha,n$e.blendMode,n$a._graphics._one)},n$a._image2=function(n$a,n$b,n$c,n$d){var n$e=n$a._style._tf;n$b.ctx.drawTexture2(n$c,n$d,n$e.translateX,n$e.translateY,n$a.transform,1,null,n$a._graphics._one)},n$a._alpha=function(n$a,n$b,n$c,n$d){var n$e;if(.01<(n$e=n$a._style.alpha)||n$a._needRepaint()){var n$f=n$b.ctx.globalAlpha;n$b.ctx.globalAlpha*=n$e;var n$g=this._next;n$g._fun.call(n$g,n$a,n$b,n$c,n$d),n$b.ctx.globalAlpha=n$f}},n$a._transform=function(n$a,n$b,n$c,n$d){var n$e=n$a.transform,n$f=this._next;n$e&&n$f!=n$g.NORENDER?(n$b.save(),n$b.transform(n$e.a,n$e.b,n$e.c,n$e.d,n$e.tx+n$c,n$e.ty+n$d),n$f._fun.call(n$f,n$a,n$b,0,0),n$b.restore()):n$f._fun.call(n$f,n$a,n$b,n$c,n$d)},n$a._childs=function(n$a,n$b,n$c,n$d){var n$e=n$a._style,n$f=n$e._tf;if(n$c=n$c-n$f.translateX+n$e.paddingLeft,n$d=n$d-n$f.translateY+n$e.paddingTop,n$e._calculation){var n$g=n$a._getWords();if(n$g){var n$h=n$e;n$h&&(n$h.stroke?n$b.fillBorderWords(n$g,n$c,n$d,n$h.font,n$h.color,n$h.strokeColor,n$h.stroke):n$b.fillWords(n$g,n$c,n$d,n$h.font,n$h.color,"none"!=n$h.textDecoration&&n$h.underLine?1:0))}}var n$i,n$j=n$a._childs,n$k=n$j.length;if(n$a.viewport||n$a.optimizeScrollRect&&n$a._style.scrollRect){var n$l=n$a.viewport||n$a._style.scrollRect,n$m=n$l.x,n$n=n$l.y,n$o=n$l.right,n$p=n$l.bottom,n$q=NaN,n$r=NaN;for(n$s=0;n$s<n$k;++n$s)(n$i=n$j[n$s]).visible&&(n$q=n$i._x)<n$o&&n$q+n$i.width>n$m&&(n$r=n$i._y)<n$p&&n$r+n$i.height>n$n&&n$i.render(n$b,n$c,n$d)}else for(var n$s=0;n$s<n$k;++n$s)(n$i=n$j[n$s])._style.visible&&n$i.render(n$b,n$c,n$d)},n$a._canvas=function(n$a,n$b,n$c,n$d){var n$e=n$a._$P.cacheCanvas;if(n$e){"bitmap"===n$e.type?n$X.canvasBitmap++:n$X.canvasNormal++;var n$f=n$e.ctx;if(n$a._needRepaint()||!n$f)this._canvas_repaint(n$a,n$b,n$c,n$d);else{var n$g=n$e._cacheRec;n$b.drawCanvas(n$f.canvas,n$c+n$g.x,n$d+n$g.y,n$g.width,n$g.height)}}else this._next._fun.call(this._next,n$a,n$b,n$c,n$d)},n$a._canvas_repaint=function(n$a,n$b,n$c,n$d){var n$e=n$a._$P.cacheCanvas,n$f=this._next;if(n$e){var n$g,n$h,n$i,n$j,n$k=n$e.ctx,n$l=n$a._needRepaint()||!n$k,n$m=n$e.type;if("bitmap"===n$m?n$X.canvasBitmap++:n$X.canvasNormal++,n$l){var n$n,n$o;n$e._cacheRec||(n$e._cacheRec=new n$z),n$J.isWebGL&&"bitmap"!==n$m?n$e._cacheRec.setTo(-n$a.pivotX,-n$a.pivotY,1,1):((n$j=n$a.getSelfBounds()).x=n$j.x-n$a.pivotX,n$j.y=n$j.y-n$a.pivotY,n$j.x=n$j.x-16,n$j.y=n$j.y-16,n$j.width=n$j.width+32,n$j.height=n$j.height+32,n$j.x=Math.floor(n$j.x+n$c)-n$c,n$j.y=Math.floor(n$j.y+n$d)-n$d,n$j.width=Math.floor(n$j.width),n$j.height=Math.floor(n$j.height),n$e._cacheRec.copyFrom(n$j)),n$j=n$e._cacheRec;var n$p,n$q=n$J.isWebGL?1:n$O.pixelRatio*n$x.stage.clientScaleX,n$r=n$J.isWebGL?1:n$O.pixelRatio*n$x.stage.clientScaleY;if(!n$J.isWebGL){var n$s,n$t=1,n$u=1;for(n$s=n$a;n$s&&n$s!=n$x.stage;)n$t*=n$s.scaleX,n$u*=n$s.scaleY,n$s=n$s.parent;n$J.isWebGL?(n$t<1&&(n$q*=n$t),n$u<1&&(n$r*=n$u)):(1<n$t&&(n$q*=n$t),1<n$u&&(n$r*=n$u))}if(n$a.scrollRect){var n$v=n$a.scrollRect;n$j.x-=n$v.x,n$j.y-=n$v.y}if(n$n=n$j.width*n$q,n$o=n$j.height*n$r,n$h=n$j.x,n$i=n$j.y,n$J.isWebGL&&"bitmap"===n$m&&(2048<n$n||2048<n$o))return console.warn("cache bitmap size larger than 2048,cache ignored"),n$e.ctx&&(n$W.recover("RenderContext",n$e.ctx),n$e.ctx.canvas.size(0,0),n$e.ctx=null),void n$f._fun.call(n$f,n$a,n$b,n$c,n$d);if(n$k||(n$k=n$e.ctx=n$W.getItem("RenderContext")||new n$K(n$n,n$o,n$ta.create("AUTO"))),n$k.ctx.sprite=n$a,(n$g=n$k.canvas).clear(),(n$g.width!=n$n||n$g.height!=n$o)&&n$g.size(n$n,n$o),"bitmap"===n$m?n$g.context.asBitmap=!0:"normal"===n$m&&(n$g.context.asBitmap=!1),1!=n$q||1!=n$r){var n$w=n$k.ctx;n$w.save(),n$w.scale(n$q,n$r),!n$J.isConchWebGL&&n$J.isConchApp&&(n$p=n$a._$P.cf)&&n$w.setFilterMatrix&&n$w.setFilterMatrix(n$p._mat,n$p._alpha),n$f._fun.call(n$f,n$a,n$k,-n$h,-n$i),n$w.restore(),n$J.isConchApp&&!n$J.isConchWebGL||n$a._applyFilters()}else n$w=n$k.ctx,!n$J.isConchWebGL&&n$J.isConchApp&&(n$p=n$a._$P.cf)&&n$w.setFilterMatrix&&n$w.setFilterMatrix(n$p._mat,n$p._alpha),n$f._fun.call(n$f,n$a,n$k,-n$h,-n$i),n$J.isConchApp&&!n$J.isConchWebGL||n$a._applyFilters();n$a._$P.staticCache&&(n$e.reCache=!1),n$X.canvasReCache++}else n$h=(n$j=n$e._cacheRec).x,n$i=n$j.y,n$g=n$k.canvas;n$b.drawCanvas(n$g,n$c+n$h,n$d+n$i,n$j.width,n$j.height)}else n$f._fun.call(n$f,n$a,n$k,n$c,n$d)},n$g.__init__=function(){var n$a,n$b,n$c=0;for(n$b=n$F.createRenderSprite(69905,null),n$a=n$g.renders.length=4096,n$c=0;n$c<n$a;n$c++)n$g.renders[n$c]=n$b;n$g.renders[0]=n$F.createRenderSprite(0,null),function(n$a,n$b){for(var n$c=0,n$d=0;n$d<n$a.length;n$d++)n$c|=n$a[n$d],n$g.renders[n$c]=n$b}([1,512,4,2],new n$g(1,null)),n$g.renders[513]=n$F.createRenderSprite(513,null),n$g.renders[517]=new n$g(517,null)},n$g._initRenderFun=function(n$a,n$b,n$c,n$d){var n$e=n$a._renderType;(n$g.renders[n$e]=n$g._getTypeRender(n$e))._fun(n$a,n$b,n$c,n$d)},n$g._getTypeRender=function(n$a){for(var n$b=null,n$c=2048;1<n$c;)n$c&n$a&&(n$b=n$F.createRenderSprite(n$c,n$b)),n$c>>=1;return n$b},n$g.IMAGE=1,n$g.ALPHA=2,n$g.TRANSFORM=4,n$g.BLEND=8,n$g.CANVAS=16,n$g.FILTERS=32,n$g.MASK=64,n$g.CLIP=128,n$g.STYLE=256,n$g.GRAPHICS=512,n$g.CUSTOM=1024,n$g.CHILDS=2048,n$g.INIT=69905,n$g.renders=[],n$g.NORENDER=new n$g(0,null),n$g}(),n$M=function(){function n$h(){this._repaint=!1}n$k(n$h,"laya.resource.Context");var n$a=n$h.prototype;return n$a.replaceReset=function(){var n$a,n$b,n$c=0;for(n$a=n$h.replaceKeys.length,n$c=0;n$c<n$a;n$c++)n$b=n$h.replaceKeys[n$c],this[n$h.newKeys[n$c]]=this[n$b]},n$a.replaceResotre=function(){this.__restore(),this.__reset()},n$a.setIsMainContext=function(){},n$a.drawTextures=function(n$a,n$b,n$c,n$d){n$X.drawCall+=n$b.length/2;for(var n$e=n$a.width,n$f=n$a.height,n$g=0,n$h=n$b.length;n$g<n$h;n$g+=2)this.drawTexture(n$a,n$b[n$g],n$b[n$g+1],n$e,n$f,n$c,n$d)},n$a.drawCanvas=function(n$a,n$b,n$c,n$d,n$e){n$X.drawCall++,this.drawImage(n$a.source,n$b,n$c,n$d,n$e)},n$a.fillRect=function(n$a,n$b,n$c,n$d,n$e){n$X.drawCall++,n$e&&(this.fillStyle=n$e),this.__fillRect(n$a,n$b,n$c,n$d)},n$a.fillText=function(n$a,n$b,n$c,n$d,n$e,n$f){n$X.drawCall++,3<arguments.length&&null!=n$d&&(this.font=n$d,this.fillStyle=n$e,this.textAlign=n$f,this.textBaseline="top"),this.__fillText(n$a,n$b,n$c)},n$a.fillBorderText=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){n$X.drawCall++,this.font=n$d,this.fillStyle=n$e,this.textBaseline="top",this.strokeStyle=n$f,this.lineWidth=n$g,this.textAlign=n$h,this.__strokeText(n$a,n$b,n$c),this.__fillText(n$a,n$b,n$c)},n$a.strokeText=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){n$X.drawCall++,3<arguments.length&&null!=n$d&&(this.font=n$d,this.strokeStyle=n$e,this.lineWidth=n$f,this.textAlign=n$g,this.textBaseline="top"),this.__strokeText(n$a,n$b,n$c)},n$a.transformByMatrix=function(n$a){this.transform(n$a.a,n$a.b,n$a.c,n$a.d,n$a.tx,n$a.ty)},n$a.setTransformByMatrix=function(n$a){this.setTransform(n$a.a,n$a.b,n$a.c,n$a.d,n$a.tx,n$a.ty)},n$a.clipRect=function(n$a,n$b,n$c,n$d){n$X.drawCall++,this.beginPath(),this.rect(n$a,n$b,n$c,n$d),this.clip()},n$a.drawTexture=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){n$X.drawCall++;var n$h=n$a.uv,n$i=n$a.bitmap.width,n$j=n$a.bitmap.height;this.drawImage(n$a.source,n$h[0]*n$i,n$h[1]*n$j,(n$h[2]-n$h[0])*n$i,(n$h[5]-n$h[3])*n$j,n$b+n$f,n$c+n$g,n$d,n$e)},n$a.drawTextureWithTransform=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){n$X.drawCall++;var n$j=n$a.uv,n$k=n$a.bitmap.width,n$l=n$a.bitmap.height;this.save(),1!=n$i&&(this.globalAlpha*=n$i),n$f?(this.transform(n$f.a,n$f.b,n$f.c,n$f.d,n$f.tx+n$g,n$f.ty+n$h),this.drawImage(n$a.source,n$j[0]*n$k,n$j[1]*n$l,(n$j[2]-n$j[0])*n$k,(n$j[5]-n$j[3])*n$l,n$b,n$c,n$d,n$e)):this.drawImage(n$a.source,n$j[0]*n$k,n$j[1]*n$l,(n$j[2]-n$j[0])*n$k,(n$j[5]-n$j[3])*n$l,n$b+n$g,n$c+n$h,n$d,n$e),this.restore()},n$a.drawTexture2=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){var n$i=n$h[0];if(n$i.loaded&&n$i.bitmap&&n$i.source){n$X.drawCall++;var n$j=1!==n$f;if(n$j){var n$k=this.globalAlpha;this.globalAlpha*=n$f}var n$l=n$i.uv,n$m=n$i.bitmap.width,n$n=n$i.bitmap.height;n$e?(this.save(),this.transform(n$e.a,n$e.b,n$e.c,n$e.d,n$e.tx+n$a,n$e.ty+n$b),this.drawImage(n$i.source,n$l[0]*n$m,n$l[1]*n$n,(n$l[2]-n$l[0])*n$m,(n$l[5]-n$l[3])*n$n,n$h[1]-n$c,n$h[2]-n$d,n$h[3],n$h[4]),this.restore()):this.drawImage(n$i.source,n$l[0]*n$m,n$l[1]*n$n,(n$l[2]-n$l[0])*n$m,(n$l[5]-n$l[3])*n$n,n$h[1]-n$c+n$a,n$h[2]-n$d+n$b,n$h[3],n$h[4]),n$j&&(this.globalAlpha=n$k)}},n$a.fillTexture=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){if(!n$h.pat){if(n$a.uv!=n$ka.DEF_UV){var n$i=new n$ta("2D");n$i.getContext("2d"),n$i.size(n$a.width,n$a.height),n$i.context.drawTexture(n$a,0,0,n$a.width,n$a.height,0,0),n$a=new n$ka(n$i)}n$h.pat=this.createPattern(n$a.bitmap.source,n$f)}var n$j=n$b,n$k=n$c,n$l=0,n$m=0;n$g&&(n$j+=n$g.x%n$a.width,n$k+=n$g.y%n$a.height,n$l-=n$g.x%n$a.width,n$m-=n$g.y%n$a.height),this.translate(n$j,n$k),this.fillRect(n$l,n$m,n$d,n$e,n$h.pat),this.translate(-n$j,-n$k)},n$a.drawTriangle=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){var n$i=n$a.bitmap,n$j=n$i.source,n$k=n$a.width,n$l=n$a.height,n$m=n$i.width,n$n=n$i.height,n$o=n$c[n$d]*n$m,n$p=n$c[n$e]*n$m,n$q=n$c[n$f]*n$m,n$r=n$c[n$d+1]*n$n,n$s=n$c[n$e+1]*n$n,n$t=n$c[n$f+1]*n$n,n$u=n$b[n$d],n$v=n$b[n$e],n$w=n$b[n$f],n$x=n$b[n$d+1],n$y=n$b[n$e+1],n$z=n$b[n$f+1];if(n$h){var n$C=(n$u+n$v+n$w)/3,n$D=(n$x+n$y+n$z)/3,n$E=n$u-n$C,n$F=n$x-n$D,n$G=Math.sqrt(n$E*n$E+n$F*n$F);n$u=n$C+n$E/n$G*(n$G+1),n$x=n$D+n$F/n$G*(n$G+1),n$F=n$y-n$D,n$v=n$C+(n$E=n$v-n$C)/(n$G=Math.sqrt(n$E*n$E+n$F*n$F))*(n$G+1),n$y=n$D+n$F/n$G*(n$G+1),n$F=n$z-n$D,n$w=n$C+(n$E=n$w-n$C)/(n$G=Math.sqrt(n$E*n$E+n$F*n$F))*(n$G+1),n$z=n$D+n$F/n$G*(n$G+1)}this.save(),n$g&&this.transform(n$g.a,n$g.b,n$g.c,n$g.d,n$g.tx,n$g.ty),this.beginPath(),this.moveTo(n$u,n$x),this.lineTo(n$v,n$y),this.lineTo(n$w,n$z),this.closePath(),this.clip();var n$H=1/(n$o*n$s+n$r*n$q+n$p*n$t-n$s*n$q-n$r*n$p-n$o*n$t),n$I=n$u*n$s+n$r*n$w+n$v*n$t-n$s*n$w-n$r*n$v-n$u*n$t,n$J=n$o*n$v+n$u*n$q+n$p*n$w-n$v*n$q-n$u*n$p-n$o*n$w,n$K=n$o*n$s*n$w+n$r*n$v*n$q+n$u*n$p*n$t-n$u*n$s*n$q-n$r*n$p*n$w-n$o*n$v*n$t,n$L=n$x*n$s+n$r*n$z+n$y*n$t-n$s*n$z-n$r*n$y-n$x*n$t,n$M=n$o*n$y+n$x*n$q+n$p*n$z-n$y*n$q-n$x*n$p-n$o*n$z,n$N=n$o*n$s*n$z+n$r*n$y*n$q+n$x*n$p*n$t-n$x*n$s*n$q-n$r*n$p*n$z-n$o*n$y*n$t;this.transform(n$I*n$H,n$L*n$H,n$J*n$H,n$M*n$H,n$K*n$H,n$N*n$H),this.drawImage(n$j,n$a.uv[0]*n$m,n$a.uv[1]*n$n,n$k,n$l,n$a.uv[0]*n$m,n$a.uv[1]*n$n,n$k,n$l),this.restore()},n$a.flush=function(){return 0},n$a.fillWords=function(n$a,n$b,n$c,n$d,n$e,n$f){n$d&&(this.font=n$d),n$e&&(this.fillStyle=n$e);this.textBaseline="top",this.textAlign="left";for(var n$g=0,n$h=n$a.length;n$g<n$h;n$g++){var n$i=n$a[n$g];if(this.__fillText(n$i.char,n$i.x+n$b,n$i.y+n$c),1===n$f){var n$j=n$i.height,n$k=.5*n$i.style.letterSpacing;n$k||(n$k=0),this.beginPath(),this.strokeStyle=n$e,this.lineWidth=1,this.moveTo(n$b+n$i.x-n$k+.5,n$c+n$i.y+n$j+.5),this.lineTo(n$b+n$i.x+n$i.width+n$k+.5,n$c+n$i.y+n$j+.5),this.stroke()}}},n$a.fillBorderWords=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){n$d&&(this.font=n$d),n$e&&(this.fillStyle=n$e),this.textBaseline="top",this.lineWidth=n$g,this.textAlign="left",this.strokeStyle=n$f;for(var n$h=0,n$i=n$a.length;n$h<n$i;n$h++){var n$j=n$a[n$h];this.__strokeText(n$j.char,n$j.x+n$b,n$j.y+n$c),this.__fillText(n$j.char,n$j.x+n$b,n$j.y+n$c)}},n$a.destroy=function(){this.canvas.width=this.canvas.height=0},n$a.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},n$a.drawCurves=function(n$a,n$b,n$c){this.beginPath(),this.strokeStyle=n$c[3],this.lineWidth=n$c[4];var n$d=n$c[2];n$a+=n$c[0],n$b+=n$c[1],this.moveTo(n$a+n$d[0],n$b+n$d[1]);for(var n$e=2,n$f=n$d.length;n$e<n$f;)this.quadraticCurveTo(n$a+n$d[n$e++],n$b+n$d[n$e++],n$a+n$d[n$e++],n$b+n$d[n$e++]);this.stroke()},n$h.__init__=function(n$b){var n$c=laya.resource.Context.prototype;if(!(n$b=n$b||CanvasRenderingContext2D.prototype).inited){n$b.inited=!0,n$b.__fillText=n$b.fillText,n$b.__fillRect=n$b.fillRect,n$b.__strokeText=n$b.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(n$a){n$b[n$a]=n$c[n$a]})}},n$h.replaceCanvasGetSet=function(n$a,n$b){var n$c=Object.getOwnPropertyDescriptor(n$a,n$b);if(!n$c||!n$c.configurable)return!1;var n$d,n$e={};for(n$d in n$c)"set"!=n$d&&(n$e[n$d]=n$c[n$d]);var n$f=n$c.set;return n$e.set=function(n$a){n$f.call(this,n$a);var n$b=this.getContext("2d");n$b&&"__reset"in n$b&&n$b.__reset()},Object.defineProperty(n$a,n$b,n$e),!0},n$h.replaceGetSet=function(n$a,n$b){var n$c=Object.getOwnPropertyDescriptor(n$a,n$b);if(!n$c||!n$c.configurable)return!1;var n$d,n$e={};for(n$d in n$c)"set"!=n$d&&(n$e[n$d]=n$c[n$d]);var n$f=n$c.set,n$g="___"+n$b+"__";return n$h.newKeys.push(n$g),n$e.set=function(n$a){n$a!=this[n$g]&&(this[n$g]=n$a,n$f.call(this,n$a))},Object.defineProperty(n$a,n$b,n$e),!0},n$h._default=new n$h,n$h.newKeys=[],n$i(n$h,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),n$h}(),n$N=function(){function n$f(n$a){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++n$f._uniqueIDCounter,this._name=n$a||"Content Manager",n$f._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,n$f._resourceManagers.push(this),this._resources=[],this._records={}}n$k(n$f,"laya.resource.ResourceManager");var n$a=n$f.prototype;return n$x.imps(n$a,{"laya.resource.IDispose":!0}),n$a.getResourceByIndex=function(n$a){return this._resources[n$a]},n$a.getResourcesLength=function(){return this._resources.length},n$a.addResource=function(n$a){return n$a.resourceManager&&n$a.resourceManager.removeResource(n$a),-1===this._resources.indexOf(n$a)&&((n$a._resourceManager=this)._resources.push(n$a),this.addRecord(n$a.uri,n$a.__className,n$a.memorySize),this.addSize(n$a.memorySize),!0)},n$a.removeResource=function(n$a){var n$b=this._resources.indexOf(n$a);return-1!==n$b&&(this._resources.splice(n$b,1),n$a._resourceManager=null,this._memorySize-=n$a.memorySize,this.addRecord(n$a.uri,n$a.__className,-n$a.memorySize),!0)},n$a.unload=function(){for(var n$a=this._resources.slice(0,this._resources.length),n$b=0;n$b<n$a.length;n$b++){n$a[n$b].destroy()}n$a.length=0},n$a.dispose=function(){if(this===n$f._systemResourceManager)throw new Error("systemResourceManager不能被释放！");n$f._resourceManagers.splice(n$f._resourceManagers.indexOf(this),1),n$f._isResourceManagersSorted=!1;for(var n$a=this._resources.slice(0,this._resources.length),n$b=0;n$b<n$a.length;n$b++){var n$c=n$a[n$b];n$c.resourceManager.removeResource(n$c),n$c.destroy()}n$a.length=0},n$a.addSize=function(n$a){n$a&&(this.autoRelease&&0<n$a&&this._memorySize+n$a>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=n$a)},n$a.addRecord=function(n$a,n$b,n$c){DEBUG&&n$c&&!n$a&&console.error(n$a,n$b,n$c),n$a&&(this._records.hasOwnProperty(n$b+"|"+n$a)||(this._records[n$b+"|"+n$a]=0),this._records[n$b+"|"+n$a]+=n$c,DEBUG&&this._records[n$b+"|"+n$a]<0&&console.error(n$a,n$b,this._records[n$b+"|"+n$a]))},n$a.garbageCollection=function(n$a){var n$b=this._resources;(n$b=n$b.slice()).sort(function(n$a,n$b){if(!n$a||!n$b)throw new Error("a或b不能为空！");return n$a.released&&n$b.released?0:n$a.released?1:n$b.released?-1:n$a._lastUseFrameCount-n$b._lastUseFrameCount});for(var n$c=n$X.loopCount,n$d=0,n$e=n$b.length;n$d<n$e;n$d++){var n$f=n$b[n$d];if(!(1<n$c-n$f._lastUseFrameCount))return void(this._memorySize>=n$a&&(this._isOverflow=!0));if(n$f.releaseResource(),this._memorySize<n$a)return void(this._isOverflow=!1)}},n$o(0,n$a,"id",function(){return this._id}),n$o(0,n$a,"name",function(){return this._name},function(n$a){!n$a&&""===n$a||this._name===n$a||(this._name=n$a,n$f._isResourceManagersSorted=!1)}),n$o(0,n$a,"memorySize",function(){return this._memorySize}),n$o(0,n$a,"records",function(){return this._records}),n$o(1,n$f,"systemResourceManager",function(){return n$f._systemResourceManager}),n$f.__init__=function(){n$f.currentResourceManager=n$f.systemResourceManager},n$f.getLoadedResourceManagerByIndex=function(n$a){return n$f._resourceManagers[n$a]},n$f.getLoadedResourceManagersCount=function(){return n$f._resourceManagers.length},n$f.recreateContentManagers=function(n$a){void 0===n$a&&(n$a=!1);for(var n$b=n$f.currentResourceManager,n$c=0;n$c<n$f._resourceManagers.length;n$c++){n$f.currentResourceManager=n$f._resourceManagers[n$c];for(var n$d=0;n$d<n$f.currentResourceManager._resources.length;n$d++)n$f.currentResourceManager._resources[n$d].releaseResource(n$a),n$f.currentResourceManager._resources[n$d].activeResource(n$a)}n$f.currentResourceManager=n$b},n$f.releaseContentManagers=function(n$a){void 0===n$a&&(n$a=!1);for(var n$b=n$f.currentResourceManager,n$c=0;n$c<n$f._resourceManagers.length;n$c++){n$f.currentResourceManager=n$f._resourceManagers[n$c];for(var n$d=0;n$d<n$f.currentResourceManager._resources.length;n$d++){var n$e=n$f.currentResourceManager._resources[n$d];!n$e.released&&n$e.releaseResource(n$a)}}n$f.currentResourceManager=n$b},n$f._uniqueIDCounter=0,n$f._isResourceManagersSorted=!1,n$f._resourceManagers=[],n$i(n$f,["_systemResourceManager",function(){return this._systemResourceManager=new n$f("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=n$f._systemResourceManager}]),n$f}(),n$O=(function(){function n$a(){}n$k(n$a,"laya.system.System"),n$a.changeDefinition=function(n$a,n$b){n$x[n$a]=n$b;var n$c=n$a+"=classObj";n$x._runScript(n$c)},n$a.__init__=function(){n$J.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function n$c(){}return n$k(n$c,"laya.utils.Browser"),n$o(1,n$c,"pixelRatio",function(){return n$c.__init__(),-1<n$c.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:n$F.getPixelRatio()}),n$o(1,n$c,"height",function(){return n$c.__init__(),(n$x.stage&&n$x.stage.canvasRotation?n$c.clientWidth:n$c.clientHeight)*n$c.pixelRatio}),n$o(1,n$c,"clientWidth",function(){return n$c.__init__(),n$c.window.innerWidth||n$c.document.body.clientWidth}),n$o(1,n$c,"window",function(){return n$c.__init__(),n$c._window}),n$o(1,n$c,"clientHeight",function(){return n$c.__init__(),n$c.window.innerHeight||n$c.document.body.clientHeight||n$c.document.documentElement.clientHeight}),n$o(1,n$c,"width",function(){return n$c.__init__(),(n$x.stage&&n$x.stage.canvasRotation?n$c.clientHeight:n$c.clientWidth)*n$c.pixelRatio}),n$o(1,n$c,"container",function(){return n$c.__init__(),n$c._container||((n$c._container=n$c.createElement("div")).id="layaContainer",n$c.document.body.appendChild(n$c._container)),n$c._container},function(n$a){n$c._container=n$a}),n$o(1,n$c,"document",function(){return n$c.__init__(),n$c._document}),n$c.__init__=function(){if(!n$c._window){n$c._window=n$F.getWindow(),n$c._document=n$c.window.document,n$c._window.addEventListener("message",function(n$a){laya.utils.Browser._onMessage(n$a)},!1),n$c.document.__createElement=n$c.document.createElement,n$g.requestAnimationFrame=n$g.requestAnimationFrame||n$g.webkitRequestAnimationFrame||n$g.mozRequestAnimationFrame||n$g.oRequestAnimationFrame||n$g.msRequestAnimationFrame||function(n$a){return n$g.setTimeout(n$a,1e3/60)};var n$a=n$g.document.body.style;n$a["-webkit-user-select"]="none",n$a["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",n$c.userAgent=n$c.window.navigator.userAgent,n$c.onIOS=!!(n$c.u=n$c.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),n$c.onMobile=-1<n$c.u.indexOf("Mobile"),n$c.onIPhone=-1<n$c.u.indexOf("iPhone"),n$c.onMac=-1<n$c.u.indexOf("Mac OS X"),n$c.onIPad=-1<n$c.u.indexOf("iPad"),n$c.onAndroid=-1<n$c.u.indexOf("Android")||-1<n$c.u.indexOf("Adr"),n$c.onWP=-1<n$c.u.indexOf("Windows Phone"),n$c.onQQBrowser=-1<n$c.u.indexOf("QQBrowser"),n$c.onMQQBrowser=-1<n$c.u.indexOf("MQQBrowser")||-1<n$c.u.indexOf("Mobile")&&-1<n$c.u.indexOf("QQ"),n$c.onIE=!!n$c.window.ActiveXObject||"ActiveXObject"in n$c.window,n$c.onWeiXin=-1<n$c.u.indexOf("MicroMessenger"),n$c.onPC=!n$c.onMobile,n$c.onSafari=-1<n$c.u.indexOf("Safari"),n$c.onFirefox=-1<n$c.u.indexOf("Firefox"),n$c.onEdge=-1<n$c.u.indexOf("Edge"),n$c.onMiniGame=-1<n$c.u.indexOf("MiniGame"),n$c.onLimixiu=-1<n$c.u.indexOf("limixiu"),n$c.httpProtocol="http:"==n$c.window.location.protocol,n$c.onMiniGame&&null==n$c.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),n$c.webAudioEnabled=!!(n$c.window.AudioContext||n$c.window.webkitAudioContext||n$c.window.mozAudioContext),n$c.soundType=n$c.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",n$ea=n$c.webAudioEnabled?n$fa:n$ca,n$c.webAudioEnabled&&n$fa.initWebAudio(),n$ca._initMusicAudio(),n$c.enableTouch="ontouchstart"in n$g||n$g.DocumentTouch&&n$b instanceof DocumentTouch,n$g.focus(),n$E._soundClass=n$ea,n$E._musicClass=n$ca,n$J._mainCanvas=n$J._mainCanvas||n$ta.create("2D"),n$c.canvas||(n$c.canvas=n$ta.create("2D"),n$c.context=n$c.canvas.getContext("2d"))}},n$c._onMessage=function(n$a){if(n$a.data&&"size"==n$a.data.name){if(n$c.window.innerWidth=n$a.data.width,n$c.window.innerHeight=n$a.data.height,n$c.window.__innerHeight=n$a.data.clientHeight,!n$c.document.createEvent)return void console.warn("no document.createEvent");var n$b=n$c.document.createEvent("HTMLEvents");return n$b.initEvent("resize",!1,!1),void n$c.window.dispatchEvent(n$b)}},n$c.createElement=function(n$a){return n$c.__init__(),n$c.document.__createElement(n$a)},n$c.getElementById=function(n$a){return n$c.__init__(),n$c.document.getElementById(n$a)},n$c.removeElement=function(n$a){n$a&&n$a.parentNode&&n$a.parentNode.removeChild(n$a)},n$c.now=function(){return n$F.now()},n$c._window=null,n$c._document=null,n$c._container=null,n$c.userAgent=null,n$c.u=null,n$c.onIOS=!1,n$c.onMac=!1,n$c.onMobile=!1,n$c.onIPhone=!1,n$c.onIPad=!1,n$c.onAndroid=!1,n$c.onWP=!1,n$c.onQQBrowser=!1,n$c.onMQQBrowser=!1,n$c.onSafari=!1,n$c.onFirefox=!1,n$c.onEdge=!1,n$c.onIE=!1,n$c.onWeiXin=!1,n$c.onMiniGame=!1,n$c.onLimixiu=!1,n$c.onPC=!1,n$c.httpProtocol=!1,n$c.webAudioEnabled=!1,n$c.soundType=null,n$c.enableTouch=!1,n$c.canvas=null,n$c.context=null,n$c.__init$=function(){},n$c}()),n$P=function(){function n$b(n$a){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,n$a?(this._u8d_=new Uint8Array(n$a),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}n$k(n$b,"laya.utils.Byte");var n$a=n$b.prototype;return n$a.___resizeBuffer=function(n$b){try{var n$a=new Uint8Array(n$b);null!=this._u8d_&&(this._u8d_.length<=n$b?n$a.set(this._u8d_):n$a.set(this._u8d_.subarray(0,n$b))),this._u8d_=n$a,this._d_=new DataView(n$a.buffer)}catch(n$a){throw"___resizeBuffer err:"+n$b}},n$a.getString=function(){return this.rUTF(this.getUint16())},n$a.getFloat32Array=function(n$a,n$b){var n$c=n$a+n$b;n$c=n$c>this._length?this._length:n$c;var n$d=new Float32Array(this._d_.buffer.slice(n$a,n$c));return this._pos_=n$c,n$d},n$a.getUint8Array=function(n$a,n$b){var n$c=n$a+n$b;n$c=n$c>this._length?this._length:n$c;var n$d=new Uint8Array(this._d_.buffer.slice(n$a,n$c));return this._pos_=n$c,n$d},n$a.getInt16Array=function(n$a,n$b){var n$c=n$a+n$b;n$c=n$c>this._length?this._length:n$c;var n$d=new Int16Array(this._d_.buffer.slice(n$a,n$c));return this._pos_=n$c,n$d},n$a.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var n$a=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,n$a},n$a.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var n$a=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,n$a},n$a.writeFloat32=function(n$a){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,n$a,this._xd_),this._pos_+=4},n$a.writeFloat64=function(n$a){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,n$a,this._xd_),this._pos_+=8},n$a.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var n$a=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,n$a},n$a.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var n$a=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,n$a},n$a.writeInt32=function(n$a){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,n$a,this._xd_),this._pos_+=4},n$a.writeUint32=function(n$a){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,n$a,this._xd_),this._pos_+=4},n$a.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var n$a=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,n$a},n$a.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var n$a=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,n$a},n$a.writeUint16=function(n$a){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,n$a,this._xd_),this._pos_+=2},n$a.writeInt16=function(n$a){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,n$a,this._xd_),this._pos_+=2},n$a.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},n$a.writeUint8=function(n$a){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,n$a),this._pos_++},n$a._getUInt8=function(n$a){return this._d_.getUint8(n$a)},n$a._getUint16=function(n$a){return this._d_.getUint16(n$a,this._xd_)},n$a._getMatrix=function(){return new n$G(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},n$a.rUTF=function(n$a){for(var n$b=[],n$c=this._pos_+n$a,n$d=0,n$e=0,n$f=0,n$g=String.fromCharCode,n$h=this._u8d_;this._pos_<n$c;)(n$d=n$h[this._pos_++])<128?0!=n$d&&n$b.push(n$g(n$d)):n$d<224?n$b.push(n$g((63&n$d)<<6|127&n$h[this._pos_++])):n$d<240?(n$e=n$h[this._pos_++],n$b.push(n$g((31&n$d)<<12|(127&n$e)<<6|127&n$h[this._pos_++]))):(n$e=n$h[this._pos_++],n$f=n$h[this._pos_++],n$b.push(n$g((15&n$d)<<18|(127&n$e)<<12|n$f<<6&127|127&n$h[this._pos_++]))),0;return n$b.join("")},n$a.getCustomString=function(n$a){for(var n$b=[],n$c=0,n$d=0,n$e=0,n$f=String.fromCharCode,n$g=this._u8d_;0<n$a;)if((n$d=n$g[this._pos_])<128)n$b.push(n$f(n$d)),this._pos_++,n$a--;else for(n$c=n$d-128,this._pos_++,n$a-=n$c;0<n$c;)n$d=n$g[this._pos_++],n$e=n$g[this._pos_++],n$b.push(n$f(n$e<<8|n$d)),n$c--;return n$b.join("")},n$a.clear=function(){this._pos_=0,this.length=0},n$a.__getBuffer=function(){return this._d_.buffer},n$a.writeUTFBytes=function(n$a){for(var n$b=0,n$c=(n$a+="").length;n$b<n$c;n$b++){var n$d=n$a.charCodeAt(n$b);n$d<=127?this.writeByte(n$d):n$d<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|n$d>>6,128|63&n$d],this._pos_),this._pos_+=2):n$d<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|n$d>>12,128|n$d>>6&63,128|63&n$d],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|n$d>>18,128|n$d>>12&63,128|n$d>>6&63,128|63&n$d],this._pos_),this._pos_+=4)}},n$a.writeUTFString=function(n$a){var n$b=this.pos;this.writeUint16(1),this.writeUTFBytes(n$a);var n$c=this.pos-n$b-2;if(65536<=n$c)throw"writeUTFString byte len more than 65536";this._d_.setUint16(n$b,n$c,this._xd_)},n$a.readUTFString=function(){return this.readUTFBytes(this.getUint16())},n$a.getUTFString=function(){return this.readUTFString()},n$a.readUTFBytes=function(n$a){if(void 0===n$a&&(n$a=-1),0==n$a)return"";var n$b=this.bytesAvailable;if(n$b<n$a)throw"readUTFBytes error - Out of bounds";return n$a=0<n$a?n$a:n$b,this.rUTF(n$a)},n$a.getUTFBytes=function(n$a){return void 0===n$a&&(n$a=-1),this.readUTFBytes(n$a)},n$a.writeByte=function(n$a){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,n$a),this._pos_+=1},n$a.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},n$a.getByte=function(){return this.readByte()},n$a.ensureWrite=function(n$a){this._length<n$a&&(this._length=n$a),this._allocated_<n$a&&(this.length=n$a)},n$a.writeArrayBuffer=function(n$a,n$b,n$c){if(void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),n$b<0||n$c<0)throw"writeArrayBuffer error - Out of bounds";0==n$c&&(n$c=n$a.byteLength-n$b),this.ensureWrite(this._pos_+n$c);var n$d=new Uint8Array(n$a);this._u8d_.set(n$d.subarray(n$b,n$b+n$c),this._pos_),this._pos_+=n$c},n$o(0,n$a,"buffer",function(){var n$a=this._d_.buffer;return n$a.byteLength==this.length?n$a:n$a.slice(0,this.length)}),n$o(0,n$a,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(n$a){this._xd_="littleEndian"==n$a}),n$o(0,n$a,"length",function(){return this._length},function(n$a){this._allocated_<n$a?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(n$a,2*this._allocated_))):this._allocated_>n$a&&this.___resizeBuffer(this._allocated_=n$a),this._length=n$a}),n$o(0,n$a,"pos",function(){return this._pos_},function(n$a){this._pos_=n$a}),n$o(0,n$a,"bytesAvailable",function(){return this._length-this._pos_}),n$b.getSystemEndian=function(){if(!n$b._sysEndian){var n$a=new ArrayBuffer(2);new DataView(n$a).setInt16(0,256,!0),n$b._sysEndian=256===new Int16Array(n$a)[0]?"littleEndian":"bigEndian"}return n$b._sysEndian},n$b.BIG_ENDIAN="bigEndian",n$b.LITTLE_ENDIAN="littleEndian",n$b._sysEndian=null,n$b}(),n$Q=function(){function n$e(){}return n$k(n$e,"laya.utils.CacheManager"),n$e.regCacheByFunction=function(n$a,n$b){var n$c;n$e.unRegCacheByFunction(n$a,n$b),n$c={tryDispose:n$a,getCacheList:n$b},n$e._cacheList.push(n$c)},n$e.unRegCacheByFunction=function(n$a,n$b){var n$c,n$d=0;for(n$c=n$e._cacheList.length,n$d=0;n$d<n$c;n$d++)if(n$e._cacheList[n$d].tryDispose==n$a&&n$e._cacheList[n$d].getCacheList==n$b)return void n$e._cacheList.splice(n$d,1)},n$e.forceDispose=function(){var n$a=0,n$b=n$e._cacheList.length;for(n$a=0;n$a<n$b;n$a++)n$e._cacheList[n$a].tryDispose(!0)},n$e.beginCheck=function(n$a){void 0===n$a&&(n$a=15e3),n$x.timer.loop(n$a,null,n$e._checkLoop)},n$e.stopCheck=function(){n$x.timer.clear(null,n$e._checkLoop)},n$e._checkLoop=function(){var n$a=n$e._cacheList;if(!(n$a.length<1)){var n$b,n$c=n$O.now(),n$d=0;for(n$b=n$d=n$a.length;0<n$d&&(n$a[n$e._index=++n$e._index%n$b].tryDispose(!1),!(n$O.now()-n$c>n$e.loopTimeLimit));)n$d--}},n$e.loopTimeLimit=2,n$e._cacheList=[],n$e._index=0,n$e}(),n$R=function(){function n$n(){}return n$k(n$n,"laya.utils.ClassUtils"),n$n.regClass=function(n$a,n$b){n$n._classMap[n$a]=n$b},n$n.getRegClass=function(n$a){return n$n._classMap[n$a]},n$n.getInstance=function(n$a){var n$b=n$n.getClass(n$a);return n$b?new n$b:(console.warn("[error] Undefined class:",n$a),null)},n$n.createByJson=function(n$a,n$b,n$c,n$d,n$e){"string"==typeof n$a&&(n$a=JSON.parse(n$a));var n$f=n$a.props;if(!n$b&&!(n$b=n$e?n$e.runWith(n$a):n$n.getInstance(n$f.runtime||n$a.type)))return null;var n$g=n$a.child;if(n$g)for(var n$h=0,n$i=n$g.length;n$h<n$i;n$h++){var n$j=n$g[n$h];if("render"!==n$j.props.name&&"render"!==n$j.props.renderType||!n$b._$set_itemRender)if("Graphic"==n$j.type)n$n.addGraphicsToSprite(n$j,n$b);else if(n$n.isDrawType(n$j.type))n$n.addGraphicToSprite(n$j,n$b,!0);else{var n$k=n$n.createByJson(n$j,null,n$c,n$d,n$e);"Script"==n$j.type?n$k.hasOwnProperty("owner")?n$k.owner=n$b:n$k.hasOwnProperty("target")&&(n$k.target=n$b):"mask"==n$j.props.renderType?n$b.mask=n$k:n$b.addChild(n$k)}else n$b.itemRender=n$j}if(n$f)for(var n$l in n$f){var n$m=n$f[n$l];"var"===n$l&&n$c?n$c[n$m]=n$b:n$m instanceof Array&&"function"==typeof n$b[n$l]?n$b[n$l].apply(n$b,n$m):n$b[n$l]=n$m}return n$d&&n$a.customProps&&n$d.runWith([n$b,n$a]),n$b.created&&n$b.created(),n$b},n$n.addGraphicsToSprite=function(n$a,n$b){var n$c;if((n$c=n$a.child)&&!(n$c.length<1)){var n$d;n$d=n$n._getGraphicsFromSprite(n$a,n$b);var n$e=0,n$f=0;n$a.props&&(n$e=n$n._getObjVar(n$a.props,"x",0),n$f=n$n._getObjVar(n$a.props,"y",0)),0!=n$e&&0!=n$f&&n$d.translate(n$e,n$f);var n$g,n$h=0;for(n$g=n$c.length,n$h=0;n$h<n$g;n$h++)n$n._addGraphicToGraphics(n$c[n$h],n$d);0!=n$e&&0!=n$f&&n$d.translate(-n$e,-n$f)}},n$n.addGraphicToSprite=function(n$a,n$b,n$c){var n$d;void 0===n$c&&(n$c=!1),n$d=n$c?n$n._getGraphicsFromSprite(n$a,n$b):n$b.graphics,n$n._addGraphicToGraphics(n$a,n$d)},n$n._getGraphicsFromSprite=function(n$a,n$b){var n$c,n$d;if(!n$a||!n$a.props)return n$b.graphics;switch(n$d=n$a.props.renderType){case"hit":case"unHit":var n$e;n$b.hitArea||(n$b.hitArea=new n$V),(n$e=n$b.hitArea)[n$d]||(n$e[n$d]=new n$m),n$c=n$e[n$d]}return n$c||(n$c=n$b.graphics),n$c},n$n._getTransformData=function(n$a){var n$b;(n$a.hasOwnProperty("pivotX")||n$a.hasOwnProperty("pivotY"))&&(n$b=n$b||new n$G).translate(-n$n._getObjVar(n$a,"pivotX",0),-n$n._getObjVar(n$a,"pivotY",0));var n$c=n$n._getObjVar(n$a,"scaleX",1),n$d=n$n._getObjVar(n$a,"scaleY",1),n$e=n$n._getObjVar(n$a,"rotation",0);n$n._getObjVar(n$a,"skewX",0),n$n._getObjVar(n$a,"skewY",0);return 1==n$c&&1==n$d&&0==n$e||((n$b=n$b||new n$G).scale(n$c,n$d),n$b.rotate(.0174532922222222*n$e)),n$b},n$n._addGraphicToGraphics=function(n$a,n$b){var n$c,n$d;if((n$c=n$a.props)&&(n$d=n$n.DrawTypeDic[n$a.type])){var n$e,n$f;n$e=n$b;var n$g=n$n._getParams(n$c,n$d[1],n$d[2],n$d[3]);((n$f=n$n._tM)||1!=n$n._alpha)&&(n$e.save(),n$f&&n$e.transform(n$f),1!=n$n._alpha&&n$e.alpha(n$n._alpha)),n$e[n$d[0]].apply(n$e,n$g),(n$f||1!=n$n._alpha)&&n$e.restore()}},n$n._adptLineData=function(n$a){return n$a[2]=parseFloat(n$a[0])+parseFloat(n$a[2]),n$a[3]=parseFloat(n$a[1])+parseFloat(n$a[3]),n$a},n$n._adptTextureData=function(n$a){return n$a[0]=n$ha.getRes(n$a[0]),n$a},n$n._adptLinesData=function(n$a){return n$a[2]=n$n._getPointListByStr(n$a[2]),n$a},n$n.isDrawType=function(n$a){return"Image"!=n$a&&n$n.DrawTypeDic.hasOwnProperty(n$a)},n$n._getParams=function(n$a,n$b,n$c,n$d){var n$e;void 0===n$c&&(n$c=0),(n$e=n$n._temParam).length=n$b.length;var n$f,n$g,n$h=0;for(n$f=n$b.length,n$h=0;n$h<n$f;n$h++)n$e[n$h]=n$n._getObjVar(n$a,n$b[n$h][0],n$b[n$h][1]);return n$n._alpha=n$n._getObjVar(n$a,"alpha",1),n$g=n$n._getTransformData(n$a),n$n._tM=n$g?(n$c||(n$c=0),n$g.translate(n$e[n$c],n$e[n$c+1]),n$e[n$c]=n$e[n$c+1]=0,n$g):null,n$d&&n$n[n$d]&&(n$e=n$n[n$d](n$e)),n$e},n$n._getPointListByStr=function(n$a){var n$b,n$c,n$d=0;for(n$c=(n$b=n$a.split(",")).length,n$d=0;n$d<n$c;n$d++)n$b[n$d]=parseFloat(n$b[n$d]);return n$b},n$n._getObjVar=function(n$a,n$b,n$c){return n$a.hasOwnProperty(n$b)?n$a[n$b]:n$c},n$n._temParam=[],n$n._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},n$n.getClass=function(n$a){var n$b=n$n._classMap[n$a]||n$a;return"string"==typeof n$b?n$x.__classmap[n$b]:n$b},n$n._tM=null,n$n._alpha=NaN,n$i(n$n,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),n$n}(),n$S=function(){function n$f(n$a){if(this._color=[],"string"==typeof n$a){null===(this.strColor=n$a)&&(n$a="#000000"),"#"==n$a.charAt(0)&&(n$a=n$a.substr(1));var n$b=n$a.length;if(3==n$b||4==n$b){for(var n$c="",n$d=0;n$d<n$b;n$d++)n$c+=n$a[n$d]+n$a[n$d];n$a=n$c}var n$e=this.numColor=parseInt(n$a,16);if(8==n$a.length)return void(this._color=[parseInt(n$a.substr(0,2),16)/255,((16711680&n$e)>>16)/255,((65280&n$e)>>8)/255,(255&n$e)/255])}else n$e=this.numColor=n$a,this.strColor=n$$.toHexColor(n$e);this._color=[((16711680&n$e)>>16)/255,((65280&n$e)>>8)/255,(255&n$e)/255,1],this._color.__id=++n$f._COLODID}return n$k(n$f,"laya.utils.Color"),n$f._initDefault=function(){for(var n$a in n$f._DEFAULT={},n$f._COLOR_MAP)n$f._SAVE[n$a]=n$f._DEFAULT[n$a]=new n$f(n$f._COLOR_MAP[n$a]);return n$f._DEFAULT},n$f._initSaveMap=function(){for(var n$a in n$f._SAVE_SIZE=0,n$f._SAVE={},n$f._DEFAULT)n$f._SAVE[n$a]=n$f._DEFAULT[n$a]},n$f.create=function(n$a){var n$b=n$f._SAVE[n$a+""];return null!=n$b?n$b:(n$f._SAVE_SIZE<1e3||n$f._initSaveMap(),n$f._SAVE[n$a+""]=new n$f(n$a))},n$f._SAVE={},n$f._SAVE_SIZE=0,n$f._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},n$f._DEFAULT=n$f._initDefault(),n$f._COLODID=1,n$f}(),n$T=(function(){function n$a(){this._values=[],this._keys=[]}n$k(n$a,"laya.utils.Dictionary");var n$b=n$a.prototype;n$b.set=function(n$a,n$b){var n$c=this.indexOf(n$a);0<=n$c?this._values[n$c]=n$b:(this._keys.push(n$a),this._values.push(n$b))},n$b.indexOf=function(n$a){var n$b=this._keys.indexOf(n$a);return 0<=n$b?n$b:(n$a="string"==typeof n$a?Number(n$a):"number"==typeof n$a?n$a.toString():n$a,this._keys.indexOf(n$a))},n$b.get=function(n$a){var n$b=this.indexOf(n$a);return n$b<0?null:this._values[n$b]},n$b.remove=function(n$a){var n$b=this.indexOf(n$a);return 0<=n$b&&(this._keys.splice(n$b,1),this._values.splice(n$b,1),!0)},n$b.clear=function(){this._values.length=0,this._keys.length=0},n$o(0,n$b,"values",function(){return this._values}),n$o(0,n$b,"keys",function(){return this._keys})}(),function(){function n$a(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}n$k(n$a,"laya.utils.Dragging");var n$b=n$a.prototype;return n$b.start=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){void 0===n$h&&(n$h=.92),this.clearTimer(),this.target=n$a,this.area=n$b,this.hasInertia=n$c,this.elasticDistance=n$b?n$d:0,this.elasticBackTime=n$e,this.data=n$f,this._disableMouseEvent=n$g,this.ratio=n$h,1!=n$a.globalScaleX||1!=n$a.globalScaleY?this._parent=n$a.parent:this._parent=n$x.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,n$x.stage.on("mouseup",this,this.onStageMouseUp),n$x.stage.on("mouseout",this,this.onStageMouseUp),n$x.timer.frameLoop(1,this,this.loop)},n$b.clearTimer=function(){n$x.timer.clear(this,this.loop),n$x.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},n$b.stop=function(){this._dragging&&(n$p.instance.disableMouseEvent=!1,n$x.stage.off("mouseup",this,this.onStageMouseUp),n$x.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},n$b.loop=function(){var n$a=this._parent.getMousePoint(),n$b=n$a.x,n$c=n$a.y,n$d=n$b-this._lastX,n$e=n$c-this._lastY;if(this._clickOnly){if(!(1<Math.abs(n$d*n$x.stage._canvasTransform.getScaleX())||1<Math.abs(n$e*n$x.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),n$p.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(n$d,n$e);0==n$d&&0==n$e||(this._lastX=n$b,this._lastY=n$c,this.target.x+=n$d*this._elasticRateX,this.target.y+=n$e*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},n$b.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var n$a=this.area.x-this.target.x;else n$a=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-n$a/this.elasticDistance),this.target.y<this.area.y)var n$b=this.area.y-this.target.y;else n$b=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-n$b/this.elasticDistance)}},n$b.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},n$b.onStageMouseUp=function(n$a){if(n$p.instance.disableMouseEvent=!1,n$x.stage.off("mouseup",this,this.onStageMouseUp),n$x.stage.off("mouseout",this,this.onStageMouseUp),n$x.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var n$b=this._offsets.length,n$c=Math.min(n$b,6),n$d=this._offsets.length-n$c,n$e=n$b-1;n$d<n$e;n$e--)this._offsetY+=this._offsets[n$e--],this._offsetX+=this._offsets[n$e];this._offsetX=this._offsetX/n$c*2,this._offsetY=this._offsetY/n$c*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),n$x.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},n$b.checkElastic=function(){var n$a=NaN,n$b=NaN;if(this.target.x<this.area.x?n$a=this.area.x:this.target.x>this.area.x+this.area.width&&(n$a=this.area.x+this.area.width),this.target.y<this.area.y?n$b=this.area.y:this.target.y>this.area.y+this.area.height&&(n$b=this.area.y+this.area.height),isNaN(n$a)&&isNaN(n$b))this.clear();else{var n$c={};isNaN(n$a)||(n$c.x=n$a),isNaN(n$b)||(n$c.y=n$b),this._tween=n$Z.to(this.target,n$c,this.elasticBackTime,n$U.sineOut,n$s.create(this,this.clear),0,!1,!1)}},n$b.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(n$x.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},n$b.clear=function(){if(this.target){this.clearTimer();var n$a=this.target;this.target=null,this._parent=null,n$a.event("dragend",this.data)}},n$a}()),n$U=function(){function n$h(){}return n$k(n$h,"laya.utils.Ease"),n$h.linearNone=function(n$a,n$b,n$c,n$d){return n$c*n$a/n$d+n$b},n$h.linearIn=function(n$a,n$b,n$c,n$d){return n$c*n$a/n$d+n$b},n$h.linearInOut=function(n$a,n$b,n$c,n$d){return n$c*n$a/n$d+n$b},n$h.linearOut=function(n$a,n$b,n$c,n$d){return n$c*n$a/n$d+n$b},n$h.bounceIn=function(n$a,n$b,n$c,n$d){return n$c-n$h.bounceOut(n$d-n$a,0,n$c,n$d)+n$b},n$h.bounceInOut=function(n$a,n$b,n$c,n$d){return n$a<.5*n$d?.5*n$h.bounceIn(2*n$a,0,n$c,n$d)+n$b:.5*n$h.bounceOut(2*n$a-n$d,0,n$c,n$d)+.5*n$c+n$b},n$h.bounceOut=function(n$a,n$b,n$c,n$d){return(n$a/=n$d)<1/2.75?n$c*(7.5625*n$a*n$a)+n$b:n$a<2/2.75?n$c*(7.5625*(n$a-=1.5/2.75)*n$a+.75)+n$b:n$a<2.5/2.75?n$c*(7.5625*(n$a-=2.25/2.75)*n$a+.9375)+n$b:n$c*(7.5625*(n$a-=2.625/2.75)*n$a+.984375)+n$b},n$h.backIn=function(n$a,n$b,n$c,n$d,n$e){return void 0===n$e&&(n$e=1.70158),n$c*(n$a/=n$d)*n$a*((n$e+1)*n$a-n$e)+n$b},n$h.backInOut=function(n$a,n$b,n$c,n$d,n$e){return void 0===n$e&&(n$e=1.70158),(n$a/=.5*n$d)<1?.5*n$c*(n$a*n$a*((1+(n$e*=1.525))*n$a-n$e))+n$b:n$c/2*((n$a-=2)*n$a*((1+(n$e*=1.525))*n$a+n$e)+2)+n$b},n$h.backOut=function(n$a,n$b,n$c,n$d,n$e){return void 0===n$e&&(n$e=1.70158),n$c*((n$a=n$a/n$d-1)*n$a*((n$e+1)*n$a+n$e)+1)+n$b},n$h.elasticIn=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g;return void 0===n$e&&(n$e=0),void 0===n$f&&(n$f=0),0==n$a?n$b:1==(n$a/=n$d)?n$b+n$c:(n$f||(n$f=.3*n$d),n$g=!n$e||0<n$c&&n$e<n$c||n$c<0&&n$e<-n$c?(n$e=n$c,n$f/4):n$f/n$h.PI2*Math.asin(n$c/n$e),-n$e*Math.pow(2,10*(n$a-=1))*Math.sin((n$a*n$d-n$g)*n$h.PI2/n$f)+n$b)},n$h.elasticInOut=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g;return void 0===n$e&&(n$e=0),void 0===n$f&&(n$f=0),0==n$a?n$b:2==(n$a/=.5*n$d)?n$b+n$c:(n$f||(n$f=n$d*(.3*1.5)),n$g=!n$e||0<n$c&&n$e<n$c||n$c<0&&n$e<-n$c?(n$e=n$c,n$f/4):n$f/n$h.PI2*Math.asin(n$c/n$e),n$a<1?n$e*Math.pow(2,10*(n$a-=1))*Math.sin((n$a*n$d-n$g)*n$h.PI2/n$f)*-.5+n$b:n$e*Math.pow(2,-10*(n$a-=1))*Math.sin((n$a*n$d-n$g)*n$h.PI2/n$f)*.5+n$c+n$b)},n$h.elasticOut=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g;return void 0===n$e&&(n$e=0),void 0===n$f&&(n$f=0),0==n$a?n$b:1==(n$a/=n$d)?n$b+n$c:(n$f||(n$f=.3*n$d),n$g=!n$e||0<n$c&&n$e<n$c||n$c<0&&n$e<-n$c?(n$e=n$c,n$f/4):n$f/n$h.PI2*Math.asin(n$c/n$e),n$e*Math.pow(2,-10*n$a)*Math.sin((n$a*n$d-n$g)*n$h.PI2/n$f)+n$c+n$b)},n$h.strongIn=function(n$a,n$b,n$c,n$d){return n$c*(n$a/=n$d)*n$a*n$a*n$a*n$a+n$b},n$h.strongInOut=function(n$a,n$b,n$c,n$d){return(n$a/=.5*n$d)<1?.5*n$c*n$a*n$a*n$a*n$a*n$a+n$b:.5*n$c*((n$a-=2)*n$a*n$a*n$a*n$a+2)+n$b},n$h.strongOut=function(n$a,n$b,n$c,n$d){return n$c*((n$a=n$a/n$d-1)*n$a*n$a*n$a*n$a+1)+n$b},n$h.sineInOut=function(n$a,n$b,n$c,n$d){return.5*-n$c*(Math.cos(Math.PI*n$a/n$d)-1)+n$b},n$h.sineIn=function(n$a,n$b,n$c,n$d){return-n$c*Math.cos(n$a/n$d*n$h.HALF_PI)+n$c+n$b},n$h.sineOut=function(n$a,n$b,n$c,n$d){return n$c*Math.sin(n$a/n$d*n$h.HALF_PI)+n$b},n$h.quintIn=function(n$a,n$b,n$c,n$d){return n$c*(n$a/=n$d)*n$a*n$a*n$a*n$a+n$b},n$h.quintInOut=function(n$a,n$b,n$c,n$d){return(n$a/=.5*n$d)<1?.5*n$c*n$a*n$a*n$a*n$a*n$a+n$b:.5*n$c*((n$a-=2)*n$a*n$a*n$a*n$a+2)+n$b},n$h.quintOut=function(n$a,n$b,n$c,n$d){return n$c*((n$a=n$a/n$d-1)*n$a*n$a*n$a*n$a+1)+n$b},n$h.quartIn=function(n$a,n$b,n$c,n$d){return n$c*(n$a/=n$d)*n$a*n$a*n$a+n$b},n$h.quartInOut=function(n$a,n$b,n$c,n$d){return(n$a/=.5*n$d)<1?.5*n$c*n$a*n$a*n$a*n$a+n$b:.5*-n$c*((n$a-=2)*n$a*n$a*n$a-2)+n$b},n$h.quartOut=function(n$a,n$b,n$c,n$d){return-n$c*((n$a=n$a/n$d-1)*n$a*n$a*n$a-1)+n$b},n$h.cubicIn=function(n$a,n$b,n$c,n$d){return n$c*(n$a/=n$d)*n$a*n$a+n$b},n$h.cubicInOut=function(n$a,n$b,n$c,n$d){return(n$a/=.5*n$d)<1?.5*n$c*n$a*n$a*n$a+n$b:.5*n$c*((n$a-=2)*n$a*n$a+2)+n$b},n$h.cubicOut=function(n$a,n$b,n$c,n$d){return n$c*((n$a=n$a/n$d-1)*n$a*n$a+1)+n$b},n$h.quadIn=function(n$a,n$b,n$c,n$d){return n$c*(n$a/=n$d)*n$a+n$b},n$h.quadInOut=function(n$a,n$b,n$c,n$d){return(n$a/=.5*n$d)<1?.5*n$c*n$a*n$a+n$b:.5*-n$c*(--n$a*(n$a-2)-1)+n$b},n$h.quadOut=function(n$a,n$b,n$c,n$d){return-n$c*(n$a/=n$d)*(n$a-2)+n$b},n$h.expoIn=function(n$a,n$b,n$c,n$d){return 0==n$a?n$b:n$c*Math.pow(2,10*(n$a/n$d-1))+n$b-.001*n$c},n$h.expoInOut=function(n$a,n$b,n$c,n$d){return 0==n$a?n$b:n$a==n$d?n$b+n$c:(n$a/=.5*n$d)<1?.5*n$c*Math.pow(2,10*(n$a-1))+n$b:.5*n$c*(2-Math.pow(2,-10*--n$a))+n$b},n$h.expoOut=function(n$a,n$b,n$c,n$d){return n$a==n$d?n$b+n$c:n$c*(1-Math.pow(2,-10*n$a/n$d))+n$b},n$h.circIn=function(n$a,n$b,n$c,n$d){return-n$c*(Math.sqrt(1-(n$a/=n$d)*n$a)-1)+n$b},n$h.circInOut=function(n$a,n$b,n$c,n$d){return(n$a/=.5*n$d)<1?.5*-n$c*(Math.sqrt(1-n$a*n$a)-1)+n$b:.5*n$c*(Math.sqrt(1-(n$a-=2)*n$a)+1)+n$b},n$h.circOut=function(n$a,n$b,n$c,n$d){return n$c*Math.sqrt(1-(n$a=n$a/n$d-1)*n$a)+n$b},n$h.HALF_PI=.5*Math.PI,n$h.PI2=2*Math.PI,n$h}(),n$V=function(){function n$l(){this._hit=null,this._unHit=null}n$k(n$l,"laya.utils.HitArea");var n$a=n$l.prototype;return n$a.isHit=function(n$a,n$b){return!!n$l.isHitGraphic(n$a,n$b,this.hit)&&!n$l.isHitGraphic(n$a,n$b,this.unHit)},n$a.contains=function(n$a,n$b){return this.isHit(n$a,n$b)},n$o(0,n$a,"hit",function(){return this._hit||(this._hit=new n$m),this._hit},function(n$a){this._hit=n$a}),n$o(0,n$a,"unHit",function(){return this._unHit||(this._unHit=new n$m),this._unHit},function(n$a){this._unHit=n$a}),n$l.isHitGraphic=function(n$a,n$b,n$c){if(!n$c)return!1;var n$d;if(!(n$d=n$c.cmds)&&n$c._one&&((n$d=n$l._cmds).length=1,n$d[0]=n$c._one),!n$d)return!1;var n$e,n$f,n$g=0;for(n$e=n$d.length,n$g=0;n$g<n$e;n$g++)if(n$f=n$d[n$g]){var n$h=n$J._context;switch(n$f.callee){case n$h._translate:case 6:n$a-=n$f[0],n$b-=n$f[1]}if(n$l.isHitCmd(n$a,n$b,n$f))return!0}return!1},n$l.isHitCmd=function(n$a,n$b,n$c){if(!n$c)return!1;var n$d=n$J._context,n$e=!1;switch(n$c.callee){case n$d._drawRect:case 13:n$l._rec.setTo(n$c[0],n$c[1],n$c[2],n$c[3]),n$e=n$l._rec.contains(n$a,n$b);break;case n$d._drawCircle:case n$d._fillCircle:case 14:n$e=(n$a-=n$c[0])*n$a+(n$b-=n$c[1])*n$b<n$c[2]*n$c[2];break;case n$d._drawPoly:case 18:n$a-=n$c[0],n$b-=n$c[1],n$e=n$l.ptInPolygon(n$a,n$b,n$c[2])}return n$e},n$l.ptInPolygon=function(n$a,n$b,n$c){var n$d;(n$d=n$l._ptPoint).setTo(n$a,n$b);var n$e,n$f=0,n$g=NaN,n$h=NaN,n$i=NaN,n$j=NaN;n$e=n$c.length;for(var n$k=0;n$k<n$e;n$k+=2){if(n$g=n$c[n$k],n$h=n$c[n$k+1],n$i=n$c[(n$k+2)%n$e],n$h!=(n$j=n$c[(n$k+3)%n$e]))if(!(n$d.y<Math.min(n$h,n$j)))if(!(n$d.y>=Math.max(n$h,n$j)))(n$d.y-n$h)*(n$i-n$g)/(n$j-n$h)+n$g>n$d.x&&n$f++}return n$f%2==1},n$l._cmds=[],n$i(n$l,["_rec",function(){return this._rec=new n$z},"_ptPoint",function(){return this._ptPoint=new n$y}]),n$l}(),n$W=(function(){function n$e(n$a,n$b,n$c,n$d){this.char=n$a,this.charNum=n$a.charCodeAt(0),this._x=this._y=0,this.width=n$b,this.height=n$c,this.style=n$d,this.isWord=!n$e._isWordRegExp.test(n$a)}n$k(n$e,"laya.utils.HTMLChar");var n$a=n$e.prototype;n$x.imps(n$a,{"laya.display.ILayout":!0}),n$a.setSprite=function(n$a){this._sprite=n$a},n$a.getSprite=function(){return this._sprite},n$a._isChar=function(){return!0},n$a._getCSSStyle=function(){return this.style},n$o(0,n$a,"width",function(){return this._w},function(n$a){this._w=n$a}),n$o(0,n$a,"x",function(){return this._x},function(n$a){this._sprite&&(this._sprite.x=n$a),this._x=n$a}),n$o(0,n$a,"y",function(){return this._y},function(n$a){this._sprite&&(this._sprite.y=n$a),this._y=n$a}),n$o(0,n$a,"height",function(){return this._h},function(n$a){this._h=n$a}),n$e._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function n$b(){}n$k(n$b,"laya.utils.Log"),n$b.enable=function(){n$b._logdiv||(n$b._logdiv=n$O.window.document.createElement("div"),n$O.window.document.body.appendChild(n$b._logdiv),n$b._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},n$b.toggle=function(){var n$a=n$b._logdiv.style;"1px"==n$a.width?n$a.width=n$a.height="50%":n$a.width=n$a.height="1px"},n$b.print=function(n$a){n$b._logdiv&&(n$b.maxCount<=n$b._count&&n$b.clear(),n$b._count++,n$b._logdiv.innerText+=n$a+"\n",n$b._logdiv.scrollTop=n$b._logdiv.scrollHeight)},n$b.clear=function(){n$b._logdiv.innerText="",n$b._count=0},n$b._logdiv=null,n$b._count=0,n$b.maxCount=20}(),function(){function n$b(){}n$k(n$b,"laya.utils.Mouse"),n$o(1,n$b,"cursor",function(){return n$b._style.cursor},function(n$a){n$b._style.cursor=n$a}),n$b.hide=function(){"none"!=n$b.cursor&&(n$b._preCursor=n$b.cursor,n$b.cursor="none")},n$b.show=function(){"none"==n$b.cursor&&(n$b.cursor=n$b._preCursor?n$b._preCursor:"auto")},n$b._preCursor=null,n$i(n$b,["_style",function(){return this._style=n$O.document.body.style}])}(),function(){function n$f(){}return n$k(n$f,"laya.utils.Pool"),n$f.getPoolBySign=function(n$a){return n$f._poolDic[n$a]||(n$f._poolDic[n$a]=[])},n$f.clearBySign=function(n$a){n$f._poolDic[n$a]&&(n$f._poolDic[n$a].length=0)},n$f.recover=function(n$a,n$b){n$b.__InPool||(n$b.__InPool=!0,n$f.getPoolBySign(n$a).push(n$b))},n$f.getItemByClass=function(n$a,n$b){var n$c=n$f.getPoolBySign(n$a),n$d=n$c.length?n$c.pop():new n$b;return n$d.__InPool=!1,n$d},n$f.getItemByCreateFun=function(n$a,n$b,n$c){var n$d=n$f.getPoolBySign(n$a),n$e=n$d.length?n$d.pop():n$b.call(n$c);return n$e.__InPool=!1,n$e},n$f.getItem=function(n$a){var n$b=n$f.getPoolBySign(n$a),n$c=n$b.length?n$b.pop():null;return n$c&&(n$c.__InPool=!1),n$c},n$f._poolDic={},n$f.InPoolSign="__InPool",n$f}()),n$X=function(){function n$i(){}return n$k(n$i,"laya.utils.Stat"),n$o(1,n$i,"onclick",null,function(n$a){n$i._sp&&n$i._sp.on("click",n$i._sp,n$a),n$i._canvas&&(n$i._canvas.source.onclick=n$a,n$i._canvas.source.style.pointerEvents="")}),n$i.show=function(n$a,n$b,n$c){if(void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),!n$J.isConchApp||n$J.isConchWebGL){if(n$J.isConchWebGL||n$O.onMiniGame||n$O.onLimixiu||(n$i._useCanvas=!0),n$i._show=!0,n$i._fpsData.length=60,n$i._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},n$i._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},n$i._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},n$i._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},n$J.isWebGL)if(n$i._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},n$J.is3DMode){if(n$i._view[0].title="FPS(3D)",n$i._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},n$i._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},n$i._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==n$c){var n$d=8;n$i._view[n$d++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},n$i._view[n$d++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},n$i._view[n$d++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},n$i._view[n$d++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},n$i._view[n$d++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},n$i._view[n$d++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},n$i._view[n$d++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},n$i._view[n$d++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},n$i._view[n$d++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==n$c){n$d=8;n$i._view[n$d++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},n$i._view[n$d++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},n$i._view[n$d++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},n$i._view[n$d++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},n$i._view[n$d++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},n$i._view[n$d++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},n$i._view[n$d++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else n$i._view[0].title="FPS(WebGL)",n$i._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else n$i._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};n$i._useCanvas?n$i.createUIPre(n$a,n$b):n$i.createUI(n$a,n$b),n$i.enable()}else n$O.window.conch.showFPS&&n$O.window.conch.showFPS(n$a,n$b)},n$i.createUIPre=function(n$a,n$b){var n$c=n$O.pixelRatio;n$i._width=170*n$c,n$i._vx=75*n$c,n$i._height=n$c*(12*n$i._view.length+3*n$c)+4,n$i._fontSize=12*n$c;for(var n$d=0;n$d<n$i._view.length;n$d++)n$i._view[n$d].x=4,n$i._view[n$d].y=n$d*n$i._fontSize+2*n$c;n$i._canvas||((n$i._canvas=new n$ta("2D")).size(n$i._width,n$i._height),(n$i._ctx=n$i._canvas.getContext("2d")).textBaseline="top",n$i._ctx.font=n$i._fontSize+"px Sans-serif",n$i._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+n$a+"px;top:"+n$b+"px;width:"+n$i._width/n$c+"px;height:"+n$i._height/n$c+"px;"),n$i._first=!0,n$i.loop(),n$i._first=!1,n$O.container.appendChild(n$i._canvas.source)},n$i.createUI=function(n$a,n$b){var n$c=n$i._sp,n$d=n$O.pixelRatio;n$c||(n$c=new n$la,(n$i._leftText=new n$qa).pos(5,5),n$i._leftText.color="#ffffff",n$c.addChild(n$i._leftText),(n$i._txt=new n$qa).pos(80*n$d,5),n$i._txt.color="#ffffff",n$c.addChild(n$i._txt),n$i._sp=n$c),n$c.pos(n$a,n$b);for(var n$e="",n$f=0;n$f<n$i._view.length;n$f++){n$e+=n$i._view[n$f].title+"\n"}n$i._leftText.text=n$e;var n$g=170*n$d,n$h=n$d*(12*n$i._view.length+3*n$d)+4;n$i._txt.fontSize=n$i._fontSize*n$d,n$i._leftText.fontSize=n$i._fontSize*n$d,n$c.size(n$g,n$h),n$c.graphics.clear(),n$c.graphics.setAlpha(.5),n$c.graphics.drawRect(0,0,n$g,n$h,"#999999"),n$c.graphics.setAlpha(1),n$i.loop()},n$i.enable=function(){n$x.timer.frameLoop(1,n$i,n$i.loop)},n$i.hide=function(){n$i._show=!1,n$x.timer.clear(n$i,n$i.loop),n$i._canvas&&n$O.removeElement(n$i._canvas.source)},n$i.clear=function(){n$i.trianglesFaces=n$i.drawCall=n$i.shaderCall=n$i.spriteCount=n$i.spriteRenderUseCacheCount=n$i.treeNodeCollision=n$i.treeSpriteCollision=n$i.canvasNormal=n$i.canvasBitmap=n$i.canvasReCache=0},n$i.loop=function(){n$i._count++;var n$a=n$O.now();if(!(n$a-n$i._timer<1e3)){var n$b=n$i._count;if(n$i.FPS=Math.round(1e3*n$b/(n$a-n$i._timer)),n$i._show){n$i.trianglesFaces=Math.round(n$i.trianglesFaces/n$b),n$i.spriteCount=n$i._useCanvas?(n$i.drawCall=Math.round(n$i.drawCall/n$b)-2,n$i.shaderCall=Math.round(n$i.shaderCall/n$b),Math.round(n$i.spriteCount/n$b)-1):(n$i.drawCall=Math.round(n$i.drawCall/n$b)-2,n$i.shaderCall=Math.round(n$i.shaderCall/n$b)-4,Math.round(n$i.spriteCount/n$b)-4),n$i.spriteRenderUseCacheCount=Math.round(n$i.spriteRenderUseCacheCount/n$b),n$i.canvasNormal=Math.round(n$i.canvasNormal/n$b),n$i.canvasBitmap=Math.round(n$i.canvasBitmap/n$b),n$i.canvasReCache=Math.ceil(n$i.canvasReCache/n$b),n$i.treeNodeCollision=Math.round(n$i.treeNodeCollision/n$b),n$i.treeSpriteCollision=Math.round(n$i.treeSpriteCollision/n$b);var n$c=0<n$i.FPS?Math.floor(1e3/n$i.FPS).toString():" ";n$i._fpsStr=n$i.FPS+(n$i.renderSlow?" slow":"")+" "+n$c,n$i._spriteStr=n$i.spriteCount+(n$i.spriteRenderUseCacheCount?"/"+n$i.spriteRenderUseCacheCount:""),n$i._canvasStr=n$i.canvasReCache+"/"+n$i.canvasNormal+"/"+n$i.canvasBitmap,n$i.currentMemorySize=n$N.systemResourceManager.memorySize,n$i._useCanvas?n$i.renderInfoPre():n$i.renderInfo(),n$i.clear()}n$i._count=0,n$i._timer=n$a}},n$i.renderInfoPre=function(){if(n$i._canvas){var n$a=n$i._ctx;n$a.clearRect(n$i._first?0:n$i._vx,0,n$i._width,n$i._height);for(var n$b=n$J.WebGL.mainContext,n$c=0;n$c<n$i._view.length;n$c++){var n$d=n$i._view[n$c];n$i._first&&(n$a.fillStyle="white",n$a.fillText(n$d.title,n$d.x,n$d.y,null,null,null)),n$a.fillStyle=n$d.color;var n$e=-1;if((n$d=n$i._view[n$c]).varying){if(n$b)switch(n$d.varying){case 1:n$e=n$b.getParameter(n$b[n$d.value]);break;case 2:n$e=n$b.getExtension(n$d.value)}}else n$e=n$i[n$d.value];"M"==n$d.units&&(n$e=Math.floor(n$e/1048576*100)/100+" M"),"K"==n$d.units&&(n$e=Math.floor(n$e/1024*100)/100+" K"),"string"==n$d.units&&(n$e=n$e.match(/\d+\.?\d/i)),n$a.fillText(n$e+"",n$d.x+n$i._vx,n$d.y,null,null,null)}}},n$i.renderInfo=function(){for(var n$a="",n$b=n$J.WebGL.mainContext,n$c=0;n$c<n$i._view.length;n$c++){var n$d=n$i._view[n$c],n$e=-1;if(n$d.varying){if(n$b)switch(n$d.varying){case 1:n$e=n$b.getParameter(n$b[n$d.value]);break;case 2:n$e=n$b.getExtension(n$d.value)}}else n$e=n$i[n$d.value];"M"==n$d.units&&(n$e=Math.floor(n$e/1048576*100)/100+" M"),"K"==n$d.units&&(n$e=Math.floor(n$e/1024*100)/100+" K"),"string"==n$d.units&&(n$e=n$e.match(/\d+\.?\d/i)),n$a+=n$e+"\n"}n$i._txt.text=n$a},n$i.FPS=0,n$i.loopCount=0,n$i.shaderCall=0,n$i.drawCall=0,n$i.trianglesFaces=0,n$i.spriteCount=0,n$i.spriteRenderUseCacheCount=0,n$i.treeNodeCollision=0,n$i.treeSpriteCollision=0,n$i.canvasNormal=0,n$i.canvasBitmap=0,n$i.canvasReCache=0,n$i.renderSlow=!1,n$i.currentMemorySize=0,n$i._fpsStr=null,n$i._canvasStr=null,n$i._spriteStr=null,n$i._fpsData=[],n$i._timer=0,n$i._count=0,n$i._view=[],n$i._fontSize=12,n$i._txt=null,n$i._leftText=null,n$i._sp=null,n$i._show=!1,n$i._useCanvas=!1,n$i._canvas=null,n$i._ctx=null,n$i._first=!1,n$i._vx=NaN,n$i._width=0,n$i._height=100,n$i}(),n$Y=(function(){function n$a(){this._strsToID={},this._idToStrs=[],this._length=0}n$k(n$a,"laya.utils.StringKey");var n$b=n$a.prototype;n$b.add=function(n$a){var n$b=this._strsToID[n$a];return null!=n$b?n$b:(this._idToStrs[this._length]=n$a,this._strsToID[n$a]=this._length++)},n$b.getID=function(n$a){var n$b=this._strsToID[n$a];return null==n$b?-1:n$b},n$b.getName=function(n$a){var n$b=this._idToStrs[n$a];return null==n$b?void 0:n$b}}(),function(){var n$j;function n$a(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}n$k(n$a,"laya.utils.Timer");var n$b=n$a.prototype;return n$b._init=function(){n$x.timer&&n$x.timer.frameLoop(1,this,this._update)},n$b._now=function(){return Date.now()},n$b._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var n$a=this.currFrame=this.currFrame+this.scale,n$b=this._now();this._delta=(n$b-this._lastTimer)*this.scale;var n$c=this.currTimer=this.currTimer+this._delta;n$x.isDebug&&6e4<Math.abs(n$b-this._lastTimer)&&console.error("系统时间错误！"+(n$b-this._lastTimer)),this._lastTimer=n$b;var n$d=this._handlers;for(n$g=this._count=0,n$h=n$d.length;n$g<n$h;n$g++)if(null!==(n$i=n$d[n$g]).method){var n$e=n$i.userFrame?n$a:n$c;if(n$e>=n$i.exeTime)if(n$i.repeat)if(n$i.jumpFrame)for(;n$e>=n$i.exeTime;)n$i.exeTime+=n$i.delay,n$i.run(!1);else n$i.exeTime+=n$i.delay,n$i.run(!1),n$e>n$i.exeTime&&(n$i.exeTime+=Math.ceil((n$e-n$i.exeTime)/n$i.delay)*n$i.delay);else n$i.run(!0)}else this._count++;(30<this._count||n$a%200==0)&&this._clearHandlers();for(var n$f=this._laters,n$g=0,n$h=n$f.length-1;n$g<=n$h;n$g++){var n$i=n$f[n$g];this._isIgnoreRecover(n$i)||(null!==n$i.method&&(delete this._map[n$i.key],n$i.run(!1)),this._recoverHandler(n$i)),n$g===n$h&&(n$h=n$f.length-1)}n$f.length=0}},n$b._clearHandlers=function(){for(var n$a=this._handlers,n$b=0,n$c=n$a.length;n$b<n$c;n$b++){var n$d=n$a[n$b];null!==n$d.method?this._temp.push(n$d):this._isIgnoreRecover(n$d)?this._temp.push(n$d):this._recoverHandler(n$d)}this._handlers=this._temp,this._temp=n$a,this._temp.length=0},n$b._recoverHandler=function(n$a){this._map[n$a.key]==n$a&&delete this._map[n$a.key],n$a.recover()},n$b._create=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){if(!n$c)return n$e.apply(n$d,n$f),null;if(n$g){var n$i=this._getHandler(n$d,n$e);if(n$i)return n$i.repeat=n$b,n$i.userFrame=n$a,n$i.delay=n$c,n$i.ignoreRecover=n$h,n$i.caller=n$d,n$i.method=n$e,n$i.args=n$f,n$i.exeTime=n$c+(n$a?this.currFrame:this.currTimer+this._now()-this._lastTimer),n$i}return(n$i=n$j.create()).repeat=n$b,n$i.userFrame=n$a,n$i.delay=n$c,n$i.ignoreRecover=n$h,n$i.caller=n$d,n$i.method=n$e,n$i.args=n$f,n$i.exeTime=n$c+(n$a?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(n$i),this._handlers.push(n$i),n$i},n$b._indexHandler=function(n$a){var n$b=n$a.caller,n$c=n$a.method,n$d=n$b?n$b.$_GID||(n$b.$_GID=n$$.getGID()):0,n$e=n$c.$_TID||(n$c.$_TID=this._mid++);n$a.key=n$d+"_"+n$e,this._map[n$a.key]=n$a},n$b.once=function(n$a,n$b,n$c,n$d,n$e){void 0===n$e&&(n$e=!0),this._create(!1,!1,n$a,n$b,n$c,n$d,n$e,!1)},n$b.loop=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){void 0===n$e&&(n$e=!0),void 0===n$f&&(n$f=!1),void 0===n$g&&(n$g=!1);var n$h=this._create(!1,!0,n$a,n$b,n$c,n$d,n$e,n$g);n$h&&(n$h.jumpFrame=n$f)},n$b.frameOnce=function(n$a,n$b,n$c,n$d,n$e){void 0===n$e&&(n$e=!0),this._create(!0,!1,n$a,n$b,n$c,n$d,n$e,!1)},n$b.frameLoop=function(n$a,n$b,n$c,n$d,n$e,n$f){void 0===n$e&&(n$e=!0),void 0===n$f&&(n$f=!1),this._create(!0,!0,n$a,n$b,n$c,n$d,n$e,n$f)},n$b.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+n$j._freeCount},n$b.clear=function(n$a,n$b){var n$c=this._getHandler(n$a,n$b);return!(!n$c||this._isIgnoreRecover(n$c))&&(delete this._map[n$c.key],n$c.key=null,n$c.clear(),!0)},n$b.clearAll=function(n$a){if(n$a)for(var n$b=0,n$c=this._handlers.length;n$b<n$c;n$b++){var n$d=this._handlers[n$b];n$d.caller===n$a&&(this._isIgnoreRecover(n$d)||(delete this._map[n$d.key],n$d.key=null,n$d.clear()))}},n$b._getHandler=function(n$a,n$b){var n$c=n$a?n$a.$_GID||(n$a.$_GID=n$$.getGID()):0,n$d=n$b.$_TID||(n$b.$_TID=this._mid++);return this._map[n$c+"_"+n$d]},n$b._isIgnoreRecover=function(n$a){if(n$a.ignoreRecover||n$a.caller&&"IgnoreRecover"==n$a.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var n$b="";try{arguments.propertyIsEnumerable.caller}catch(n$a){n$b=n$a.stack}n$x.recordError("报错：核心定时器销毁忽略  "+n$b)}return!0}return!1},n$b.hasHandler=function(n$a,n$b){return this._map[n$a.$_GID+"_"+n$b.$_TID]},n$b.callLater=function(n$a,n$b,n$c){if(null==this._getHandler(n$a,n$b)){var n$d=n$j.create();n$d.caller=n$a,n$d.method=n$b,n$d.args=n$c,this._indexHandler(n$d),this._laters.push(n$d)}},n$b.runCallLater=function(n$a,n$b){var n$c=this._getHandler(n$a,n$b);n$c&&null!=n$c.method&&(this._isIgnoreRecover(n$c)||(delete this._map[n$c.key],n$c.run(!0)))},n$b.runTimer=function(n$a,n$b){this.runCallLater(n$a,n$b)},n$o(0,n$b,"delta",function(){return this._delta}),n$a.__init$=function(){n$j=function(){function n$b(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}n$k(n$b,"");var n$a=n$b.prototype;return n$a.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},n$a.recover=function(){this.clear(),this.args=n$b._freeHandler,n$b._freeHandler=this,n$b._freeCount++},n$a.run=function(n$a){var n$b=this.caller;if(n$b&&n$b.destroyed)return this.clear();var n$c=this.method,n$d=this.args;n$a&&this.clear(),null!=n$c&&(n$d?n$c.apply(n$b,n$d):n$c.call(n$b))},n$b._freeHandler=null,n$b._freeCount=0,n$b.create=function(){var n$a=n$b._freeHandler;return n$a?(n$b._freeHandler=n$a.args,--n$b._freeCount,n$a.args=null,n$a):new n$b},n$b}()},n$a}()),n$Z=function(){function n$l(){this.gid=0}n$k(n$l,"laya.utils.Tween");var n$a=n$l.prototype;return n$a.to=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){return void 0===n$f&&(n$f=0),void 0===n$g&&(n$g=!1),this._create(n$a,n$b,n$c,n$d,n$e,n$f,n$g,!0,!1,!0)},n$a.from=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){return void 0===n$f&&(n$f=0),void 0===n$g&&(n$g=!1),this._create(n$a,n$b,n$c,n$d,n$e,n$f,n$g,!1,!1,!0)},n$a._create=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){if(!n$a)throw new Error("Tween:target is null");this._target=n$a,this._duration=n$c,this._ease=n$d||n$b.ease||n$l.easeNone,this._complete=n$e||n$b.complete,this._delay=n$f,this._props=[],this._usedTimer=0,this._startTimer=n$O.now(),this._usedPool=n$i,this._delayParam=null,this.update=n$b.update;var n$k=n$a.$_GID||(n$a.$_GID=n$$.getGID());return n$l.tweenMap[n$k]?(n$g&&n$l.clearTween(n$a),n$l.tweenMap[n$k].push(this)):n$l.tweenMap[n$k]=[this],n$j?n$f<=0?this.firstStart(n$a,n$b,n$h):(this._delayParam=[n$a,n$b,n$h],n$x.scaleTimer.once(n$f,this,this.firstStart,this._delayParam)):this._initProps(n$a,n$b,n$h),this},n$a.firstStart=function(n$a,n$b,n$c){this._delayParam=null,n$a.destroyed?this.clear():(this._initProps(n$a,n$b,n$c),this._beginLoop())},n$a._initProps=function(n$a,n$b,n$c){for(var n$d in n$b)if("number"==typeof n$a[n$d]){var n$e=n$c?n$a[n$d]:n$b[n$d],n$f=n$c?n$b[n$d]:n$a[n$d];this._props.push([n$d,n$e,n$f-n$e]),n$c||(n$a[n$d]=n$e)}},n$a._beginLoop=function(){n$x.scaleTimer.frameLoop(1,this,this._doEase)},n$a._doEase=function(){this._updateEase(n$O.now())},n$a._updateEase=function(n$a){var n$b=this._target;if(n$b){if(n$b.destroyed)return n$l.clearTween(n$b);var n$c=this._usedTimer=n$a-this._startTimer-this._delay;if(!(n$c<0)){if(n$c>=this._duration)return this.complete();for(var n$d=0<n$c?this._ease(n$c,0,1,this._duration):0,n$e=this._props,n$f=0,n$g=n$e.length;n$f<n$g;n$f++){var n$h=n$e[n$f];n$b[n$h[0]]=n$h[1]+n$d*n$h[2]}this.update&&this.update.run()}}},n$a.complete=function(){if(this._target){n$x.scaleTimer.runTimer(this,this.firstStart);for(var n$a=this._target,n$b=this._props,n$c=this._complete,n$d=0,n$e=n$b.length;n$d<n$e;n$d++){var n$f=n$b[n$d];n$a[n$f[0]]=n$f[1]+n$f[2]}this.update&&this.update.run(),this.clear(),n$c&&n$c.run()}},n$a.pause=function(){n$x.scaleTimer.clear(this,this._beginLoop),n$x.scaleTimer.clear(this,this._doEase),n$x.scaleTimer.clear(this,this.firstStart);var n$a;(n$a=n$O.now()-this._startTimer-this._delay)<0&&(this._usedTimer=n$a)},n$a.setStartTime=function(n$a){this._startTimer=n$a},n$a.clear=function(){this._target&&(this._remove(),this._clear())},n$a._clear=function(){this.pause(),n$x.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,n$W.recover("tween",this))},n$a.recover=function(){this._usedPool=!0,this._clear()},n$a._remove=function(){var n$a=n$l.tweenMap[this._target.$_GID];if(n$a)for(var n$b=0,n$c=n$a.length;n$b<n$c;n$b++)if(n$a[n$b]===this){n$a.splice(n$b,1);break}},n$a.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=n$O.now(),this._delayParam)n$x.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var n$a=this._props,n$b=0,n$c=n$a.length;n$b<n$c;n$b++){var n$d=n$a[n$b];this._target[n$d[0]]=n$d[1]}n$x.scaleTimer.once(this._delay,this,this._beginLoop)}},n$a.resume=function(){this._usedTimer>=this._duration||(this._startTimer=n$O.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?n$x.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},n$o(0,n$a,"progress",null,function(n$a){var n$b=n$a*this._duration;this._startTimer=n$O.now()-this._delay-n$b}),n$l.to=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){return void 0===n$f&&(n$f=0),void 0===n$g&&(n$g=!1),void 0===n$h&&(n$h=!0),n$W.getItemByClass("tween",n$l)._create(n$a,n$b,n$c,n$d,n$e,n$f,n$g,!0,n$h,!0)},n$l.from=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){return void 0===n$f&&(n$f=0),void 0===n$g&&(n$g=!1),void 0===n$h&&(n$h=!0),n$W.getItemByClass("tween",n$l)._create(n$a,n$b,n$c,n$d,n$e,n$f,n$g,!1,n$h,!0)},n$l.clearAll=function(n$a){if(n$a&&n$a.$_GID){var n$b=n$l.tweenMap[n$a.$_GID];if(n$b){for(var n$c=0,n$d=n$b.length;n$c<n$d;n$c++)n$b[n$c]._clear();n$b.length=0}}},n$l.clear=function(n$a){n$a.clear()},n$l.clearTween=function(n$a){n$l.clearAll(n$a)},n$l.easeNone=function(n$a,n$b,n$c,n$d){return n$c*n$a/n$d+n$b},n$l.tweenMap={},n$l}(),n$$=function(){function n$h(){}return n$k(n$h,"laya.utils.Utils"),n$h.toRadian=function(n$a){return n$a*n$h._pi2},n$h.toAngle=function(n$a){return n$a*n$h._pi},n$h.toHexColor=function(n$a){if(n$a<0||isNaN(n$a))return null;for(var n$b=n$a.toString(16);n$b.length<6;)n$b="0"+n$b;return"#"+n$b},n$h.getGID=function(){return n$h._gid++},n$h.concatArray=function(n$a,n$b){if(!n$b)return n$a;if(!n$a)return n$b;var n$c=0,n$d=n$b.length;for(n$c=0;n$c<n$d;n$c++)n$a.push(n$b[n$c]);return n$a},n$h.clearArray=function(n$a){return n$a&&(n$a.length=0),n$a},n$h.copyArray=function(n$a,n$b){if(n$a||(n$a=[]),!n$b)return n$a;n$a.length=n$b.length;var n$c=0,n$d=n$b.length;for(n$c=0;n$c<n$d;n$c++)n$a[n$c]=n$b[n$c];return n$a},n$h.getGlobalRecByPoints=function(n$a,n$b,n$c,n$d,n$e){var n$f,n$g;return n$f=new n$y(n$b,n$c),n$f=n$a.localToGlobal(n$f),n$g=new n$y(n$d,n$e),n$g=n$a.localToGlobal(n$g),n$z._getWrapRec([n$f.x,n$f.y,n$g.x,n$g.y])},n$h.getGlobalPosAndScale=function(n$a){return n$h.getGlobalRecByPoints(n$a,0,0,1,1)},n$h.bind=function(n$a,n$b){return n$a.bind(n$b)},n$h.measureText=function(n$a,n$b){return n$F.measureText(n$a,n$b)},n$h.updateOrder=function(n$a){if(!n$a||n$a.length<2)return!1;for(var n$b,n$c=1,n$d=0,n$e=n$a.length,n$f=NaN;n$c<n$e;){for(n$b=n$a[n$d=n$c],n$f=n$a[n$d]._zOrder;-1<--n$d&&n$a[n$d]._zOrder>n$f;)n$a[n$d+1]=n$a[n$d];n$a[n$d+1]=n$b,n$c++}var n$g=n$b.parent.conchModel;if(n$g)if(null!=n$g.updateZOrder)n$g.updateZOrder();else{for(n$c=0;n$c<n$e;n$c++)n$g.removeChild(n$a[n$c].conchModel);for(n$c=0;n$c<n$e;n$c++)n$g.addChildAt(n$a[n$c].conchModel,n$c)}return!0},n$h.transPointList=function(n$a,n$b,n$c){var n$d=0,n$e=n$a.length;for(n$d=0;n$d<n$e;n$d+=2)n$a[n$d]+=n$b,n$a[n$d+1]+=n$c},n$h.parseInt=function(n$a,n$b){void 0===n$b&&(n$b=0);var n$c=n$O.window.parseInt(n$a,n$b);return isNaN(n$c)?0:n$c},n$h.getFileExtension=function(n$a){n$h._extReg.lastIndex=n$a.lastIndexOf(".");var n$b=n$h._extReg.exec(n$a);return n$b&&1<n$b.length?n$b[1].toLowerCase():null},n$h.getTransformRelativeToWindow=function(n$a,n$b,n$c){var n$d=n$x.stage,n$e=laya.utils.Utils.getGlobalPosAndScale(n$a),n$f=n$d._canvasTransform.clone(),n$g=n$f.tx,n$h=n$f.ty;n$f.rotate(-Math.PI/180*n$x.stage.canvasDegree),n$f.scale(n$x.stage.clientScaleX,n$x.stage.clientScaleY);var n$i=n$x.stage.canvasDegree%180!=0,n$j=NaN,n$k=NaN;n$i?(n$j=n$c+n$e.y,n$k=n$b+n$e.x,n$j*=n$f.d,n$k*=n$f.a,90==n$x.stage.canvasDegree?(n$j=n$g-n$j,n$k+=n$h):(n$j+=n$g,n$k=n$h-n$k)):(n$j=n$b+n$e.x,n$k=n$c+n$e.y,n$j*=n$f.a,n$k*=n$f.d,n$j+=n$g,n$k+=n$h);var n$l=NaN,n$m=NaN;return n$m=n$i?(n$l=n$f.d*n$e.height,n$f.a*n$e.width):(n$l=n$f.a*n$e.width,n$f.d*n$e.height),{x:n$j,y:n$k,scaleX:n$l,scaleY:n$m}},n$h.fitDOMElementInArea=function(n$a,n$b,n$c,n$d,n$e,n$f){n$a._fitLayaAirInitialized||(n$a._fitLayaAirInitialized=!0,n$a.style.transformOrigin=n$a.style.webKittransformOrigin="left top",n$a.style.position="absolute");var n$g=n$h.getTransformRelativeToWindow(n$b,n$c,n$d);n$a.style.transform=n$a.style.webkitTransform="scale("+n$g.scaleX+","+n$g.scaleY+") rotate("+n$x.stage.canvasDegree+"deg)",n$a.style.width=n$e+"px",n$a.style.height=n$f+"px",n$a.style.left=n$g.x+"px",n$a.style.top=n$g.y+"px"},n$h.isOkTextureList=function(n$a){if(!n$a)return!1;var n$b,n$c=0,n$d=n$a.length;for(n$c=0;n$c<n$d;n$c++)if(!(n$b=n$a[n$c])||!n$b.source)return!1;return!0},n$h.isOKCmdList=function(n$a){if(!n$a)return!1;var n$b,n$c,n$d=0,n$e=n$a.length,n$f=n$J._context;for(n$d=0;n$d<n$e;n$d++)switch((n$b=n$a[n$d]).callee){case n$f._drawTexture:case n$f._fillTexture:case n$f._drawTextureWithTransform:if(!(n$c=n$b[0])||!n$c.source)return!1}return!0},n$h._gid=1,n$h._pi=180/Math.PI,n$h._pi2=Math.PI/180,n$h._extReg=/\.(\w+)\??/g,n$h.parseXMLFromString=function(n$a){var n$b;if(n$a=n$a.replace(/>\s+</g,"><"),-1<(n$b=(new DOMParser).parseFromString(n$a,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(n$b.firstChild.firstChild.textContent);return n$b},n$h}(),n$_=function(){function n$a(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],n$J.isWebGL&&n$Q.regCacheByFunction(n$$.bind(this.startDispose,this),n$$.bind(this.getCacheList,this))}n$k(n$a,"laya.utils.VectorGraphManager");var n$b=n$a.prototype;return n$b.getId=function(){return this._id++},n$b.addShape=function(n$a,n$b){this.shapeDic[n$a]=n$b,this.useDic[n$a]||(this.useDic[n$a]=!0)},n$b.addLine=function(n$a,n$b){this.shapeLineDic[n$a]=n$b,this.shapeLineDic[n$a]||(this.shapeLineDic[n$a]=!0)},n$b.getShape=function(n$a){this._checkKey&&null!=this.useDic[n$a]&&(this.useDic[n$a]=!0)},n$b.deleteShape=function(n$a){this.shapeDic[n$a]&&(this.shapeDic[n$a]=null,delete this.shapeDic[n$a]),this.shapeLineDic[n$a]&&(this.shapeLineDic[n$a]=null,delete this.shapeLineDic[n$a]),null!=this.useDic[n$a]&&delete this.useDic[n$a]},n$b.getCacheList=function(){var n$a,n$b=[];for(n$a in this.shapeDic)n$b.push(this.shapeDic[n$a]);for(n$a in this.shapeLineDic)n$b.push(this.shapeLineDic[n$a]);return n$b},n$b.startDispose=function(n$a){var n$b;for(n$b in this.useDic)this.useDic[n$b]=!1;this._checkKey=!0},n$b.endDispose=function(){if(this._checkKey){var n$a;for(n$a in this.useDic)this.useDic[n$a]||this.deleteShape(n$a);this._checkKey=!1}},n$a.getInstance=function(){return n$a.instance=n$a.instance||new n$a},n$a.instance=null,n$a}(),n$A=function(){function n$d(){this._obj=null,this._obj=n$d.supportWeakMap?new n$O.window.WeakMap:{},n$d.supportWeakMap||n$d._maps.push(this)}n$k(n$d,"laya.utils.WeakObject");var n$a=n$d.prototype;return n$a.set=function(n$a,n$b){if(null!=n$a)if(n$d.supportWeakMap){var n$c=n$a;"string"!=typeof n$a&&"number"!=typeof n$a||(n$c=n$d._keys[n$a])||(n$c=n$d._keys[n$a]={k:n$a}),this._obj.set(n$c,n$b)}else"string"==typeof n$a||"number"==typeof n$a?this._obj[n$a]=n$b:(n$a.$_GID||(n$a.$_GID=n$$.getGID()),this._obj[n$a.$_GID]=n$b)},n$a.get=function(n$a){if(null==n$a)return null;if(n$d.supportWeakMap){var n$b="string"==typeof n$a||"number"==typeof n$a?n$d._keys[n$a]:n$a;return n$b?this._obj.get(n$b):null}return"string"==typeof n$a||"number"==typeof n$a?this._obj[n$a]:this._obj[n$a.$_GID]},n$a.del=function(n$a){if(null!=n$a)if(n$d.supportWeakMap){var n$b="string"==typeof n$a||"number"==typeof n$a?n$d._keys[n$a]:n$a;if(!n$b)return;this._obj.delete(n$b)}else"string"==typeof n$a||"number"==typeof n$a?delete this._obj[n$a]:delete this._obj[this._obj.$_GID]},n$a.has=function(n$a){if(null==n$a)return!1;if(n$d.supportWeakMap){var n$b="string"==typeof n$a||"number"==typeof n$a?n$d._keys[n$a]:n$a;return this._obj.has(n$b)}return"string"==typeof n$a||"number"==typeof n$a?null!=this._obj[n$a]:null!=this._obj[this._obj.$_GID]},n$d.__init__=function(){(n$d.supportWeakMap=null!=n$O.window.WeakMap)||n$x.timer.loop(n$d.delInterval,null,n$d.clearCache)},n$d.clearCache=function(){for(var n$a=0,n$b=n$d._maps.length;n$a<n$b;n$a++){n$d._maps[n$a]._obj={}}},n$d.supportWeakMap=!1,n$d.delInterval=3e5,n$d._keys={},n$d._maps=[],n$i(n$d,["I",function(){return this.I=new n$d}]),n$d}(),n$B=function(){function n$a(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}n$k(n$a,"laya.utils.WordText");var n$b=n$a.prototype;return n$b.setText=function(n$a){this.changed=!0,this._text=n$a},n$b.toString=function(){return this._text},n$b.charCodeAt=function(n$a){return this._text?this._text.charCodeAt(n$a):NaN},n$b.charAt=function(n$a){return this._text?this._text.charAt(n$a):null},n$o(0,n$b,"length",function(){return this._text?this._text.length:0}),n$a}(),n$aa=function(n$a){function n$g(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,n$g.__super.call(this),this._childs=n$g.ARRAY_EMPTY,this._$P=n$g.PROP_EMPTY,this.timer=n$x.scaleTimer,this.conchModel=n$J.isConchNode?this.createConchModel():null}n$k(n$g,"laya.display.Node",n$j);var n$b=n$g.prototype;return n$b._setBit=function(n$a,n$b){1==n$a&&(this._getBit(n$a)!=n$b&&this._updateDisplayedInstage());n$b?this._bits|=n$a:this._bits&=~n$a},n$b._getBit=function(n$a){return 0!=(this._bits&n$a)},n$b._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},n$b._setUpNoticeType=function(n$a){var n$b=this;for(n$b._setBit(n$a,!0),n$b=n$b.parent;n$b;){if(n$b._getBit(n$a))return;n$b._setBit(n$a,!0),n$b=n$b.parent}},n$b.on=function(n$a,n$b,n$c,n$d){return"display"!==n$a&&"undisplay"!==n$a||this._getBit(1)||this._setUpNoticeType(1),this._createListener(n$a,n$b,n$c,n$d,!1)},n$b.once=function(n$a,n$b,n$c,n$d){return"display"!==n$a&&"undisplay"!==n$a||this._getBit(1)||this._setUpNoticeType(1),this._createListener(n$a,n$b,n$c,n$d,!0)},n$b.createConchModel=function(){return null},n$b.destroy=function(n$a){void 0===n$a&&(n$a=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(n$a?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},n$b.destroyChildren=function(){if(this._childs)for(var n$a=this._childs.length-1;-1<n$a;n$a--)this._childs[n$a].destroy(!0)},n$b.addChild=function(n$a){if(!n$a||this.destroyed||n$a===this)return n$a;if(n$a.zOrder&&this._set$P("hasZorder",!0),n$a._parent===this){var n$b=this.getChildIndex(n$a);n$b!==this._childs.length-1&&(this._childs.splice(n$b,1),this._childs.push(n$a),this.conchModel&&(this.conchModel.removeChild(n$a.conchModel),this.conchModel.addChildAt(n$a.conchModel,this._childs.length-1)),this._childChanged())}else n$a.parent&&n$a.parent.removeChild(n$a),this._childs===n$g.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(n$a),this.conchModel&&this.conchModel.addChildAt(n$a.conchModel,this._childs.length-1),(n$a.parent=this)._childChanged();return n$a},n$b.addChildren=function(n$a){for(var n$b=arguments,n$c=0,n$d=n$b.length;n$c<n$d;)this.addChild(n$b[n$c++])},n$b.addChildAt=function(n$a,n$b){if(!n$a||this.destroyed||n$a===this)return n$a;if(n$a.zOrder&&this._set$P("hasZorder",!0),0<=n$b&&n$b<=this._childs.length){if(n$a._parent===this){var n$c=this.getChildIndex(n$a);this._childs.splice(n$c,1),this._childs.splice(n$b,0,n$a),this.conchModel&&(this.conchModel.removeChild(n$a.conchModel),this.conchModel.addChildAt(n$a.conchModel,n$b)),this._childChanged()}else n$a.parent&&n$a.parent.removeChild(n$a),this._childs===n$g.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(n$b,0,n$a),this.conchModel&&this.conchModel.addChildAt(n$a.conchModel,n$b),n$a.parent=this;return n$a}throw new Error("appendChildAt:The index is out of bounds")},n$b.getChildIndex=function(n$a){return this._childs.indexOf(n$a)},n$b.getChildByName=function(n$a){var n$b=this._childs;if(n$b)for(var n$c=0,n$d=n$b.length;n$c<n$d;n$c++){var n$e=n$b[n$c];if(n$e.name===n$a)return n$e}return null},n$b._get$P=function(n$a){return this._$P[n$a]},n$b._set$P=function(n$a,n$b){return this.destroyed||(this._$P===n$g.PROP_EMPTY&&(this._$P={}),this._$P[n$a]=n$b),n$b},n$b.getChildAt=function(n$a){return this._childs[n$a]},n$b.setChildIndex=function(n$a,n$b){var n$c=this._childs;if(n$b<0||n$b>=n$c.length)throw new Error("setChildIndex:The index is out of bounds.");var n$d=this.getChildIndex(n$a);if(n$d<0)throw new Error("setChildIndex:node is must child of this object.");return n$c.splice(n$d,1),n$c.splice(n$b,0,n$a),this.conchModel&&(this.conchModel.removeChild(n$a.conchModel),this.conchModel.addChildAt(n$a.conchModel,n$b)),this._childChanged(),n$a},n$b._childChanged=function(n$a){},n$b.removeChild=function(n$a){if(!this._childs)return n$a;var n$b=this._childs.indexOf(n$a);return this.removeChildAt(n$b)},n$b.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},n$b.removeChildByName=function(n$a){var n$b=this.getChildByName(n$a);return n$b&&this.removeChild(n$b),n$b},n$b.removeChildAt=function(n$a){var n$b=this.getChildAt(n$a);if(n$b){for(var n$c=this._childs.length-1,n$d=n$a;n$d<n$c;++n$d)this._childs[n$d]=this._childs[n$d+1];this._childs.length=n$c,this.conchModel&&this.conchModel.removeChild(n$b.conchModel),n$b.parent=null}return n$b},n$b.removeChildren=function(n$a,n$b){if(void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=2147483647),this._childs&&0<this._childs.length){var n$c=this._childs;if(0===n$a&&n$f<=n$b){var n$d=n$c;this._childs=n$g.ARRAY_EMPTY}else n$d=n$c.splice(n$a,n$b-n$a);for(var n$e=0,n$f=n$d.length;n$e<n$f;n$e++)n$d[n$e].parent=null,this.conchModel&&this.conchModel.removeChild(n$d[n$e].conchModel)}return this},n$b.replaceChild=function(n$a,n$b){var n$c=this._childs.indexOf(n$b);return-1<n$c?(this._childs.splice(n$c,1,n$a),this.conchModel&&(this.conchModel.removeChild(n$b.conchModel),this.conchModel.addChildAt(n$a.conchModel,n$c)),n$b.parent=null,n$a.parent=this,n$a):null},n$b._updateDisplayedInstage=function(){var n$a;n$a=this;var n$b=n$x.stage;for(this._displayedInStage=!1;n$a;){if(n$a._getBit(1)){this._displayedInStage=n$a._displayedInStage;break}if(n$a==n$b||n$a._displayedInStage){this._displayedInStage=!0;break}n$a=n$a.parent}},n$b._setDisplay=function(n$a){this._displayedInStage!==n$a&&((this._displayedInStage=n$a)?this.event("display"):this.event("undisplay"))},n$b._displayChild=function(n$a,n$b){var n$c=n$a._childs;if(n$c)for(var n$d=0;n$d<n$c.length;n$d++){var n$e=n$c[n$d];n$e&&n$e._getBit(1)&&(0<n$e._childs.length?this._displayChild(n$e,n$b):n$e._setDisplay(n$b))}n$a._setDisplay(n$b)},n$b.contains=function(n$a){if(n$a===this)return!0;for(;n$a;){if(n$a.parent===this)return!0;n$a=n$a.parent}return!1},n$b.timerLoop=function(n$a,n$b,n$c,n$d,n$e,n$f){void 0===n$e&&(n$e=!0),void 0===n$f&&(n$f=!1),this.timer.loop(n$a,n$b,n$c,n$d,n$e,n$f)},n$b.timerOnce=function(n$a,n$b,n$c,n$d,n$e){void 0===n$e&&(n$e=!0),this.timer._create(!1,!1,n$a,n$b,n$c,n$d,n$e)},n$b.frameLoop=function(n$a,n$b,n$c,n$d,n$e){void 0===n$e&&(n$e=!0),this.timer._create(!0,!0,n$a,n$b,n$c,n$d,n$e)},n$b.frameOnce=function(n$a,n$b,n$c,n$d,n$e){void 0===n$e&&(n$e=!0),this.timer._create(!0,!1,n$a,n$b,n$c,n$d,n$e)},n$b.clearTimer=function(n$a,n$b){this.timer.clear(n$a,n$b)},n$o(0,n$b,"numChildren",function(){return this._childs.length}),n$o(0,n$b,"destroyed",function(){return this._destroyed}),n$o(0,n$b,"parent",function(){return this._parent},function(n$a){this._parent!==n$a&&(n$a?(this._parent=n$a,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),n$a.displayedInStage&&this._displayChild(this,!0)),n$a._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=n$a))}),n$o(0,n$b,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),n$g.ARRAY_EMPTY=[],n$g.PROP_EMPTY={},n$g.NOTICE_DISPLAY=1,n$g.MOUSEENABLE=2,n$g}(),n$ba=function(n$a){function n$m(n$a){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,n$m.__super.call(this),this._padding=n$m._PADDING,this._spacing=n$m._SPACING,this._aligns=n$m._ALIGNS,this._font=n$n.EMPTY,this._ower=n$a}n$k(n$m,"laya.display.css.CSSStyle",n$a);var n$b=n$m.prototype;return n$b.destroy=function(){this._ower=null,this._font=null,this._rect=null},n$b.inherit=function(n$a){this._font=n$a._font,this._spacing=n$a._spacing===n$m._SPACING?n$m._SPACING:n$a._spacing.slice(),this.lineHeight=n$a.lineHeight},n$b._widthAuto=function(){return 0!=(262144&this._type)},n$b.widthed=function(n$a){return 0!=(8&this._type)},n$b._calculation=function(n$a,n$b){if(n$b.indexOf("%")<0)return!1;var n$d=this._ower,n$e=n$d.parent,n$f=this._rect;function n$g(n$a,n$b,n$c){return n$a*n$c[0]+n$b*n$c[1]+n$c[2]}function n$c(n$a){var n$b=n$e.width,n$c=n$d.width;n$f.width&&(n$d.width=n$g(n$b,n$c,n$f.width)),n$f.height&&(n$d.height=n$g(n$b,n$c,n$f.height)),n$f.left&&(n$d.x=n$g(n$b,n$c,n$f.left)),n$f.top&&(n$d.y=n$g(n$b,n$c,n$f.top))}null===n$f&&(n$e._getCSSStyle()._type|=524288,n$e.on("resize",this,n$c),this._rect=n$f={input:{}});var n$h=n$b.split(" ");return n$h[0]=parseFloat(n$h[0])/100,1==n$h.length?n$h[1]=n$h[2]=0:(n$h[1]=parseFloat(n$h[1])/100,n$h[2]=parseFloat(n$h[2])),n$f[n$a]=n$h,n$f.input[n$a]=n$b,n$c(),!0},n$b.heighted=function(n$a){return 0!=(8192&this._type)},n$b.size=function(n$a,n$b){var n$c=this._ower,n$d=!1;-1!==n$a&&n$a!=this._ower.width&&(this._type|=8,this._ower.width=n$a,n$d=!0),-1!==n$b&&n$b!=this._ower.height&&(this._type|=8192,this._ower.height=n$b,n$d=!0),n$d&&(n$c._layoutLater(),524288&this._type&&n$c.event("resize",this))},n$b._getAlign=function(){return this._aligns[0]},n$b._getValign=function(){return this._aligns[1]},n$b._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},n$b._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new n$n(this._font))},n$b.render=function(n$a,n$b,n$c,n$d){var n$e=n$a.width,n$f=n$a.height;n$c-=n$a.pivotX,n$d-=n$a.pivotY,this._bgground&&null!=this._bgground.color&&n$b.ctx.fillRect(n$c,n$d,n$e,n$f,this._bgground.color),this._border&&this._border.color&&n$b.drawRect(n$c,n$d,n$e,n$f,this._border.color.strColor,this._border.size)},n$b.getCSSStyle=function(){return this},n$b.cssText=function(n$a){this.attrs(n$m.parseOneCSS(n$a,";"))},n$b.attrs=function(n$a){if(n$a)for(var n$b=0,n$c=n$a.length;n$b<n$c;n$b++){var n$d=n$a[n$b];this[n$d[0]]=n$d[1]}},n$b.setTransform=function(n$a){"none"===n$a?this._tf=n$h._TF_EMPTY:this.attrs(n$m.parseOneCSS(n$a,","))},n$b.translate=function(n$a,n$b){this._tf===n$h._TF_EMPTY&&(this._tf=new n$e),this._tf.translateX=n$a,this._tf.translateY=n$b},n$b.scale=function(n$a,n$b){this._tf===n$h._TF_EMPTY&&(this._tf=new n$e),this._tf.scaleX=n$a,this._tf.scaleY=n$b},n$b._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},n$o(0,n$b,"block",n$a.prototype._$get_block,function(n$a){n$a?this._type|=1:this._type&=-2}),n$o(0,n$b,"valign",function(){return n$m._valigndef[this._aligns[1]]},function(n$a){this._aligns===n$m._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=n$m._valigndef[n$a]}),n$o(0,n$b,"height",null,function(n$a){if(this._type|=8192,"string"==typeof n$a){if(this._calculation("height",n$a))return;n$a=parseInt(n$a)}this.size(-1,n$a)}),n$o(0,n$b,"width",null,function(n$a){if(this._type|=8,"string"==typeof n$a){var n$b=n$a.indexOf("auto");if(0<=n$b&&(this._type|=262144,n$a=n$a.substr(0,n$b)),this._calculation("width",n$a))return;n$a=parseInt(n$a)}this.size(n$a,-1)}),n$o(0,n$b,"fontWeight",function(){return this._font.weight},function(n$a){this._createFont().weight=n$a}),n$o(0,n$b,"left",null,function(n$a){var n$b=this._ower;if("string"==typeof n$a){if("center"===n$a?n$a="50% -50% 0":"right"===n$a&&(n$a="100% -100% 0"),this._calculation("left",n$a))return;n$a=parseInt(n$a)}n$b.x=n$a}),n$o(0,n$b,"_translate",null,function(n$a){this.translate(n$a[0],n$a[1])}),n$o(0,n$b,"absolute",function(){return 0!=(4&this._type)}),n$o(0,n$b,"top",null,function(n$a){var n$b=this._ower;if("string"==typeof n$a){if("middle"===n$a?n$a="50% -50% 0":"bottom"===n$a&&(n$a="100% -100% 0"),this._calculation("top",n$a))return;n$a=parseInt(n$a)}n$b.y=n$a}),n$o(0,n$b,"align",function(){return n$m._aligndef[this._aligns[0]]},function(n$a){this._aligns===n$m._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=n$m._aligndef[n$a]}),n$o(0,n$b,"bold",function(){return this._font.bold},function(n$a){this._createFont().bold=n$a}),n$o(0,n$b,"padding",function(){return this._padding},function(n$a){this._padding=n$a}),n$o(0,n$b,"leading",function(){return this._spacing[1]},function(n$a){"string"==typeof n$a&&(n$a=parseInt(n$a+"")),this._spacing===n$m._SPACING&&(this._spacing=[0,0]),this._spacing[1]=n$a}),n$o(0,n$b,"lineElement",function(){return 0!=(65536&this._type)},function(n$a){n$a?this._type|=65536:this._type&=-65537}),n$o(0,n$b,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(n$a){this.lineElement=!1,"right"===n$a?this._type|=32768:this._type&=-32769}),n$o(0,n$b,"textDecoration",function(){return this._font.decoration},function(n$a){this._createFont().decoration=n$a}),n$o(0,n$b,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(n$a){"nowrap"===n$a&&(this._type|=131072),"none"===n$a&&(this._type&=-131073)}),n$o(0,n$b,"background",null,function(n$a){n$a?(this._bgground||(this._bgground={}),this._bgground.color=n$a,this._ower.conchModel&&this._ower.conchModel.bgColor(n$a),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),n$o(0,n$b,"wordWrap",function(){return 0==(131072&this._type)},function(n$a){n$a?this._type&=-131073:this._type|=131072}),n$o(0,n$b,"color",function(){return this._font.color},function(n$a){this._createFont().color=n$a}),n$o(0,n$b,"password",function(){return this._font.password},function(n$a){this._createFont().password=n$a}),n$o(0,n$b,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(n$a){"none"===n$a?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=n$a),this._ower.conchModel&&this._ower.conchModel.bgColor(n$a),this._ower._renderType|=256}),n$o(0,n$b,"font",function(){return this._font.toString()},function(n$a){this._createFont().set(n$a)}),n$o(0,n$b,"weight",null,function(n$a){this._createFont().weight=n$a}),n$o(0,n$b,"letterSpacing",function(){return this._spacing[0]},function(n$a){"string"==typeof n$a&&(n$a=parseInt(n$a+"")),this._spacing===n$m._SPACING&&(this._spacing=[0,0]),this._spacing[0]=n$a}),n$o(0,n$b,"fontSize",function(){return this._font.size},function(n$a){this._createFont().size=n$a}),n$o(0,n$b,"italic",function(){return this._font.italic},function(n$a){this._createFont().italic=n$a}),n$o(0,n$b,"fontFamily",function(){return this._font.family},function(n$a){this._createFont().family=n$a}),n$o(0,n$b,"stroke",function(){return this._font.stroke[0]},function(n$a){this._createFont().stroke===n$n._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=n$a}),n$o(0,n$b,"strokeColor",function(){return this._font.stroke[1]},function(n$a){this._createFont().stroke===n$n._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=n$a}),n$o(0,n$b,"border",function(){return this._border?this._border.value:""},function(n$a){if("none"!=n$a){this._border||(this._border={});var n$b=(this._border.value=n$a).split(" ");if(this._border.color=n$S.create(n$b[n$b.length-1]),1==n$b.length)return this._border.size=1,void(this._border.type="solid");var n$c=0;0<n$b[0].indexOf("px")?(this._border.size=parseInt(n$b[0]),n$c++):this._border.size=1,this._border.type=n$b[n$c],this._ower._renderType|=256}else this._border=null}),n$o(0,n$b,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(n$a){n$a?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==n$a?null:n$S.create(n$a),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),n$o(0,n$b,"position",function(){return 4&this._type?"absolute":""},function(n$a){"absolute"==n$a?this._type|=4:this._type&=-5}),n$o(0,n$b,"display",null,function(n$a){switch(n$a){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),n$o(0,n$b,"paddingLeft",function(){return this.padding[3]}),n$o(0,n$b,"paddingTop",function(){return this.padding[0]}),n$o(0,n$b,"_scale",null,function(n$a){this._ower.scale(n$a[0],n$a[1])}),n$o(0,n$b,"_rotate",null,function(n$a){this._ower.rotation=n$a}),n$m.parseOneCSS=function(n$a,n$b){for(var n$c,n$d=[],n$e=n$a.split(n$b),n$f=0,n$g=n$e.length;n$f<n$g;n$f++){var n$h=n$e[n$f],n$i=n$h.indexOf(":"),n$j=n$h.substr(0,n$i).replace(/^\s+|\s+$/g,"");if(0!=n$j.length){var n$k=n$h.substr(n$i+1).replace(/^\s+|\s+$/g,""),n$l=[n$j,n$k];switch(n$j){case"italic":case"bold":n$l[1]="true"==n$k;break;case"line-height":n$l[0]="lineHeight",n$l[1]=parseInt(n$k);break;case"font-size":n$l[0]="fontSize",n$l[1]=parseInt(n$k);break;case"padding":1<(n$c=n$k.split(" ")).length||(n$c[1]=n$c[2]=n$c[3]=n$c[0]),n$l[1]=[parseInt(n$c[0]),parseInt(n$c[1]),parseInt(n$c[2]),parseInt(n$c[3])];break;case"rotate":n$l[0]="_rotate",n$l[1]=parseFloat(n$k);break;case"scale":n$c=n$k.split(" "),n$l[0]="_scale",n$l[1]=[parseFloat(n$c[0]),parseFloat(n$c[1])];break;case"translate":n$c=n$k.split(" "),n$l[0]="_translate",n$l[1]=[parseInt(n$c[0]),parseInt(n$c[1])];break;default:(n$l[0]=n$m._CSSTOVALUE[n$j])||(n$l[0]=n$j)}n$d.push(n$l)}}return n$d},n$m.parseCSS=function(n$a,n$b){for(var n$c;null!=(n$c=n$m._parseCSSRegExp.exec(n$a));)n$m.styleSheets[n$c[1]]=n$m.parseOneCSS(n$c[2],";")},n$m.EMPTY=new n$m(null),n$m._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},n$m._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),n$m._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},n$m._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},n$m.styleSheets={},n$m.ALIGN_CENTER=1,n$m.ALIGN_RIGHT=2,n$m.VALIGN_MIDDLE=1,n$m.VALIGN_BOTTOM=2,n$m._CSS_BLOCK=1,n$m._DISPLAY_NONE=2,n$m._ABSOLUTE=4,n$m._WIDTH_SET=8,n$m._PADDING=[0,0,0,0],n$m._RECT=[-1,-1,-1,-1],n$m._SPACING=[0,0],n$m._ALIGNS=[0,0,0],n$m.ADDLAYOUTED=512,n$m._NEWFONT=4096,n$m._HEIGHT_SET=8192,n$m._BACKGROUND_SET=16384,n$m._FLOAT_RIGHT=32768,n$m._LINE_ELEMENT=65536,n$m._NOWARP=131072,n$m._WIDTHAUTO=262144,n$m._LISTERRESZIE=524288,n$m}(n$h),n$ca=function(n$a){function n$g(){this.url=null,this.audio=null,this.loaded=!1,n$g.__super.call(this)}n$k(n$g,"laya.media.h5audio.AudioSound",n$j);var n$b=n$g.prototype;return n$b.dispose=function(){var n$a=n$g._audioCache[this.url];n$a&&(n$a.src="",delete n$g._audioCache[this.url])},n$b.load=function(n$a){var n$b;if(n$a=n$I.formatURL(n$a),(this.url=n$a)==n$E._tMusic?(n$g._initMusicAudio(),(n$b=n$g._musicAudio).src!=n$a&&(n$g._audioCache[n$b.src]=null,n$b=null)):n$b=n$g._audioCache[n$a],n$b&&2<=n$b.readyState)this.event("complete");else{n$b||(n$b=n$a==n$E._tMusic?(n$g._initMusicAudio(),n$g._musicAudio):n$O.createElement("audio"),(n$g._audioCache[n$a]=n$b).src=n$a),n$b.addEventListener("canplaythrough",n$d),n$b.addEventListener("error",n$e);var n$c=this;(this.audio=n$b).load?n$b.load():n$e()}function n$d(){n$f(),n$c.loaded=!0,n$c.event("complete")}function n$e(){n$b.load=null,n$f(),n$c.event("error")}function n$f(){n$b.removeEventListener("canplaythrough",n$d),n$b.removeEventListener("error",n$e)}},n$b.play=function(n$a,n$b,n$c){if(void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),!this.url)return null;var n$d,n$e;if(!(n$d=this.url==n$E._tMusic?n$g._musicAudio:n$g._audioCache[this.url]))return null;n$e=n$W.getItem("audio:"+this.url),n$J.isConchApp?n$e||((n$e=n$O.createElement("audio")).src=this.url):this.url==n$E._tMusic?(n$g._initMusicAudio(),(n$e=n$g._musicAudio).src=this.url):n$e=n$e||n$d.cloneNode(!0);var n$f=new n$ma(n$e);return n$f.url=this.url,n$f.loops=n$b,n$f.startTime=n$a,n$f.startHandler=n$c,n$f.play(!1),n$E.addChannel(n$f),n$f},n$o(0,n$b,"duration",function(){var n$a;return(n$a=n$g._audioCache[this.url])?n$a.duration:0}),n$g._initMusicAudio=function(){n$g._musicAudio||(n$g._musicAudio||(n$g._musicAudio=n$O.createElement("audio")),n$J.isConchApp||n$O.document.addEventListener("mousedown",n$g._makeMusicOK))},n$g._makeMusicOK=function(){n$O.document.removeEventListener("mousedown",n$g._makeMusicOK),n$g._musicAudio.src?n$g._musicAudio.play():(n$g._musicAudio.src="",n$g._musicAudio.load())},n$g._audioCache={},n$g._musicAudio=null,n$g}(),n$da=function(n$a){function n$b(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,n$b.__super.call(this)}n$k(n$b,"laya.media.SoundChannel",n$j);var n$c=n$b.prototype;return n$c.play=function(){},n$c.stop=function(){},n$c.pause=function(){},n$c.resume=function(){},n$c.__runComplete=function(n$a){n$a&&n$a.run()},n$o(0,n$c,"volume",function(){return 1},function(n$a){}),n$o(0,n$c,"position",function(){return 0}),n$o(0,n$c,"duration",function(){return 0}),n$b}(),n$ea=function(n$a){function n$b(){n$b.__super.call(this)}n$k(n$b,"laya.media.Sound",n$j);var n$c=n$b.prototype;return n$c.load=function(n$a){},n$c.play=function(n$a,n$b,n$c){return void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),null},n$c.dispose=function(){},n$o(0,n$c,"duration",function(){return 0}),n$b}(),n$fa=function(n$a){function n$e(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,n$e.__super.call(this)}n$k(n$e,"laya.media.webaudio.WebAudioSound",n$j);var n$b=n$e.prototype;return n$b.load=function(n$a){this.url=n$a,this.audioBuffer=n$e._dataCache[n$a],this.audioBuffer?this._loaded(this.audioBuffer):(n$e.e.on("loaded:"+n$a,this,this._loaded),n$e.e.on("err:"+n$a,this,this._err),n$e.__loadingSound[n$a]||(n$e.__loadingSound[n$a]=!0,n$x.loader.load(n$a,n$s.create(this,this.onloaded),null,n$ha.BUFFER,4,!1,null,!0)))},n$b.onloaded=function(n$a){n$a||this._err(),this._disposed?this._removeLoadEvents():(this.data=n$a,n$e.buffs.push({buffer:this.data,url:this.url}),n$e.decode())},n$b._err=function(){if(this._removeLoadEvents(),n$e.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var n$a,n$b,n$c,n$d=0;for(n$a=(n$b=this.__toPlays).length,n$d=0;n$d<n$a;n$d++)(n$c=n$b[n$d])[3]&&!n$c[3].isStopped&&n$c[3].event("error");this.__toPlays.length=0}},n$b._loaded=function(n$a){this._removeLoadEvents(),this._disposed||(this.audioBuffer=n$a,this.loaded=!0,this.event("complete"))},n$b._removeLoadEvents=function(){n$e.e.off("loaded:"+this.url,this,this._loaded),n$e.e.off("err:"+this.url,this,this._err)},n$b.__playAfterLoaded=function(){if(this.__toPlays){var n$a,n$b,n$c,n$d=0;for(n$a=(n$b=this.__toPlays).length,n$d=0;n$d<n$a;n$d++)(n$c=n$b[n$d])[3]&&!n$c[3].isStopped&&this.play(n$c[0],n$c[1],n$c[2],n$c[3]);this.__toPlays.length=0}},n$b.play=function(n$a,n$b,n$c,n$d){return void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),n$d=n$d||new n$na,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([n$a,n$b,n$c,n$d]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),n$d.url=this.url,n$d.loops=n$b,n$d.audioBuffer=this.audioBuffer,n$d.startTime=n$a,n$d.startHandler=n$c,n$d.play(!1),n$E.addChannel(n$d),n$d},n$b.dispose=function(){this._disposed=!0,delete n$e._dataCache[this.url],delete n$e.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},n$o(0,n$b,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),n$e.decode=function(){if(!(n$e.buffs.length<=0||n$e.isDecoding))if(n$e.isDecoding=!0,(n$e.tInfo=n$e.buffs.shift())&&n$e.tInfo.buffer&&n$e.tInfo.buffer.byteLength)try{n$e.ctx.decodeAudioData(n$e.tInfo.buffer,n$e._done,n$e._fail)}catch(n$a){console.error("decodeAudioData error  byteLength:"+n$e.tInfo.buffer.byteLength+"  url:"+n$e.tInfo.url)}else n$e._fail()},n$e._done=function(n$a){n$e.e.event("loaded:"+n$e.tInfo.url,n$a),n$e._dataCache[n$e.tInfo.url]=n$a,n$e.isDecoding=!1,n$e.decode()},n$e._fail=function(){n$e.e.event("err:"+n$e.tInfo.url,null),n$e.isDecoding=!1,n$e.decode()},n$e._playEmptySound=function(){if(null!=n$e.ctx){if(n$e._emptySource&&(n$e._emptySource.stop(),n$e._emptySource.disconnect(0),!n$na._tryCleanFailed))try{n$e._emptySource.buffer=null}catch(n$a){n$na._tryCleanFailed=!0}var n$a=n$e.ctx.createBufferSource();n$a.buffer=n$e._miniBuffer,n$a.connect(n$e.ctx.destination),n$a.start(0,0,0),n$e._emptySource=n$a}},n$e._unlock=function(){n$e._unlocked||(n$e._playEmptySound(),"running"==n$e.ctx.state?(n$O.document.removeEventListener("mousedown",n$e._unlock,!0),n$O.document.removeEventListener("touchend",n$e._unlock,!0),n$O.document.removeEventListener("touchstart",n$e._unlock,!0),n$e._unlocked=!0):"suspended"==n$e.ctx.state&&n$E._recoverWebAudio())},n$e.initWebAudio=function(){"running"!=n$e.ctx.state&&(n$e._unlock(),n$O.document.addEventListener("mousedown",n$e._unlock,!0),n$O.document.addEventListener("touchend",n$e._unlock,!0),n$O.document.addEventListener("touchstart",n$e._unlock,!0))},n$e._emptySource=null,n$e._dataCache={},n$e.buffs=[],n$e.isDecoding=!1,n$e._unlocked=!1,n$e.tInfo=null,n$e.__loadingSound={},n$i(n$e,["window",function(){return this.window=n$O.window},"webAudioEnabled",function(){return this.webAudioEnabled=n$e.window.AudioContext||n$e.window.webkitAudioContext||n$e.window.mozAudioContext},"ctx",function(){return this.ctx=n$e.webAudioEnabled?new(n$e.window.AudioContext||n$e.window.webkitAudioContext||n$e.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=n$e.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new n$j}]),n$e}(),n$ga=function(n$a){function n$b(){this._responseType=null,this._data=null,n$b.__super.call(this),this._http=new n$O.window.XMLHttpRequest}n$k(n$b,"laya.net.HttpRequest",n$j);var n$c=n$b.prototype;return n$c.send=function(n$a,n$b,n$c,n$d,n$e){void 0===n$c&&(n$c="get"),void 0===n$d&&(n$d="text"),this._responseType=n$d,this._data=null;var n$f=this,n$g=this._http;if(n$g.open(n$c,n$a,!0),n$e)for(var n$h=0;n$h<n$e.length;n$h++)n$g.setRequestHeader(n$e[n$h++],n$e[n$h]);else n$J.isConchApp||(n$b&&"string"!=typeof n$b?n$g.setRequestHeader("Content-Type","application/json"):n$g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));n$g.responseType="arraybuffer"!==n$d?"text":"arraybuffer",n$g.onerror=function(n$a){n$f._onError(n$a)},n$g.onabort=function(n$a){n$f._onAbort(n$a)},n$g.onprogress=function(n$a){n$f._onProgress(n$a)},n$g.onload=function(n$a){n$f._onLoad(n$a)},n$g.send(n$b)},n$c._onProgress=function(n$a){n$a&&n$a.lengthComputable&&this.event("progress",n$a.loaded/n$a.total)},n$c._onAbort=function(n$a){this.error("Request was aborted by user")},n$c._onError=function(n$a){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},n$c._onLoad=function(n$a){var n$b=this._http,n$c=void 0!==n$b.status?n$b.status:200;200===n$c||204===n$c||0===n$c?this.complete():this.error("["+n$b.status+"]"+n$b.statusText+":"+n$b.responseURL)},n$c.error=function(n$a){this.clear(),this.event("error",n$a)},n$c.complete=function(){this.clear();var n$b=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=n$$.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(n$a){n$b=!1,this.error(n$a.message)}n$b&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},n$c.clear=function(){var n$a=this._http;n$a.onerror=n$a.onabort=n$a.onprogress=n$a.onload=null},n$o(0,n$c,"url",function(){return this._http.responseURL}),n$o(0,n$c,"http",function(){return this._http}),n$o(0,n$c,"data",function(){return this._data}),n$b}(),n$ha=function(n$a){function n$C(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,n$C.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}n$k(n$C,"laya.net.Loader",n$j);var n$b=n$C.prototype;return n$b.load=function(n$a,n$b,n$c,n$d,n$e){if(n$a&&""!=n$a||console.error("Loader 加载的url不合法 "+n$a),void 0===n$c&&(n$c=!0),void 0===n$e&&(n$e=!1),0===(this._url=n$a).indexOf("data:image")?this._type=n$b="image":this._type=n$b||(n$b=this.getTypeFromUrl(n$a)),this._cache=n$c,this._data=null,!n$e&&n$C.loadedMap[n$a])return this._data=n$C.loadedMap[n$a],this.event("progress",1),void this.event("complete",this._data);if(n$d&&n$C.setGroup(n$a,n$d),null!=n$C.parserMap[n$b])return this._customParse=!0,void(n$C.parserMap[n$b]instanceof laya.utils.Handler?n$C.parserMap[n$b].runWith(this):n$C.parserMap[n$b].call(null,this));if("image"===n$b||"htmlimage"===n$b||"nativeimage"===n$b)return this._loadImage(n$a);if("ttf"===n$b)return this._loadTTF(n$a);switch(n$b){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:n$b}n$C.preLoadedMap[n$a]?this.onLoaded(n$C.preLoadedMap[n$a]):n$g.resMgrLoad(n$a,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},n$b.getTypeFromUrl=function(n$a){var n$b=n$$.getFileExtension(n$a);return n$b?n$C.typeMap[n$b]:(console.warn("Not recognize the resources suffix",n$a),"text")},n$b._loadTTF=function(n$a){n$a=n$I.formatURL(n$a);var n$b=new n$H;n$b.complete=n$s.create(this,this.onLoaded),n$b.load(n$a)},n$b._loadImage=function(n$a){n$g.imgMgrLoad(n$a,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},n$b._loadImageComplete=function(n$a,n$b,n$c){if(null!=n$c)if(n$c instanceof ArrayBuffer){var n$d=new DataView(n$c),n$e=new laya.webgl.resource.WebGLImage(new Uint8Array(n$c,8),n$a,0,!1,n$d.getUint32(0),n$d.getUint32(4));this.onLoaded(n$e)}else if(n$c instanceof n$ka)n$C.imgMgrSet[n$a]=n$b,n$g.imgMgrLock(n$a,n$C.imgMgrSet[n$a]),this._url=n$a,this.complete(n$c);else{var n$f=-1!=n$a.indexOf(".png",n$a.length-4)?6408:6407;n$e=new laya.webgl.resource.WebGLImage(n$c,n$a,n$f,!1,n$c.width,n$c.height);this.onLoaded(n$e)}else this.event("error","Load image failed")},n$b._loadSound=function(n$a){var n$b=new n$E._soundClass,n$c=this;function n$d(){n$b.offAll()}n$b.on("complete",this,function(){n$d(),n$c.onLoaded(n$b)}),n$b.on("error",this,function(){n$d(),n$b.dispose(),n$c.event("error","Load sound failed")}),n$b.load(n$a)},n$b.onProgress=function(n$a){"atlas"===this._type?this.event("progress",.3*n$a):this.event("progress",n$a)},n$b.onError=function(n$a){this.event("error",n$a)},n$b._loadedComplete=function(n$a,n$b,n$c){if(null!=n$c)switch(this._type){case"atlas":case"plf":case"json":var n$d=new n$P(n$c);this.onLoaded(JSON.parse(n$d.readUTFBytes()));break;case"font":n$d=new n$P(n$c);this.onLoaded(n$$.parseXMLFromString(n$d.readUTFBytes()));break;default:this.onLoaded(n$c)}else this.event("error",n$a)},n$b.onLoaded=function(n$a){var n$b=this._type;if("plf"==n$b)this.parsePLFData(n$a),this.complete(n$a);else if("image"===n$b){var n$c=new n$ka(n$a);n$c.url=this._url,this.complete(n$c)}else if("sound"===n$b||"htmlimage"===n$b||"nativeimage"===n$b)this.complete(n$a);else if("atlas"===n$b){if(!n$a.src&&!n$a._setContext){if(!this._data){if((this._data=n$a).meta&&n$a.meta.image)for(var n$d=n$a.meta.image.split(","),n$e=0<=this._url.indexOf("/")?"/":"\\",n$f=this._url.lastIndexOf(n$e),n$g=0<=n$f?this._url.substr(0,n$f+1):"",n$h=0,n$i=n$d.length;n$h<n$i;n$h++)n$d[n$h]=n$g+n$d[n$h];else n$d=[this._url.replace(".json",".png")];n$d.reverse(),n$a.toLoads=n$d,n$a.pics=[]}return this.event("progress",.3+1/n$d.length*.6),this._loadImage(n$d.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(n$a),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var n$j=this._data.frames,n$k=this._url.split("?")[0],n$l=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:n$k.substring(0,n$k.lastIndexOf("."))+"/",n$m=this._data.pics,n$n=n$I.formatURL(this._url),n$o=n$C.atlasMap[n$n]||(n$C.atlasMap[n$n]=[]);n$o.dir=n$l;var n$p=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var n$q in n$p=parseFloat(this._data.meta.scale),n$j){var n$r,n$s=n$j[n$q],n$t=n$m[n$s.frame.idx?n$s.frame.idx:0],n$u=n$I.formatURL(n$l+n$q);n$t.scaleRate=n$p,n$r=n$ka.create(n$t,n$s.frame.x,n$s.frame.y,n$s.frame.w,n$s.frame.h,n$s.spriteSourceSize.x,n$s.spriteSourceSize.y,n$s.sourceSize.w,n$s.sourceSize.h),n$C.cacheRes(n$u,n$r),n$C.keepCache(this._url,n$l+n$q),n$r.url=n$u,n$o.push(n$u)}else for(n$q in n$j)n$t=n$m[(n$s=n$j[n$q]).frame.idx?n$s.frame.idx:0],n$u=n$I.formatURL(n$l+n$q),n$C.cacheRes(n$u,n$ka.create(n$t,n$s.frame.x,n$s.frame.y,n$s.frame.w,n$s.frame.h,n$s.spriteSourceSize.x,n$s.spriteSourceSize.y,n$s.sourceSize.w,n$s.sourceSize.h)),n$C.loadedMap[n$u].url=n$u,n$C.keepCache(this._url,n$l+n$q),n$o.push(n$u);delete this._data.pics,this.complete(this._data)}else if("font"==n$b){if(!n$a.src)return this._data=n$a,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var n$v=new n$D;n$v.parseFont(this._data,n$a);var n$w=this._url.split(".fnt")[0].split("/"),n$x=n$w[n$w.length-1];n$qa.registerBitmapFont(n$x,n$v),this._data=n$v,this.complete(this._data)}else if("pkm"==n$b){var n$y=n$wa.create(n$a,this._url),n$z=new n$ka(n$y);n$z.url=this._url,this.complete(n$z)}else this.complete(n$a)},n$b.parsePLFData=function(n$a){var n$b,n$c,n$d;for(n$b in n$a)switch(n$d=n$a[n$b],n$b){case"json":case"text":for(n$c in n$d)n$C.preLoadedMap[n$I.formatURL(n$c)]=n$d[n$c];break;default:for(n$c in n$d)n$C.preLoadedMap[n$I.formatURL(n$c)]=n$d[n$c]}},n$b.complete=function(n$a){this._data=n$a,this._customParse?this.event("loaded",n$a instanceof Array?[n$a]:n$a):(n$C._loaders.push(this),n$C._isWorking||n$C.checkNext())},n$b.endLoad=function(n$a){n$a&&(this._data=n$a),this._cache&&n$C.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},n$o(0,n$b,"url",function(){return this._url}),n$o(0,n$b,"data",function(){return this._data}),n$o(0,n$b,"cache",function(){return this._cache}),n$o(0,n$b,"type",function(){return this._type}),n$C.checkNext=function(){n$C._isWorking=!0;for(var n$a=n$O.now();n$C._startIndex<n$C._loaders.length;)if(n$O.now(),n$C._loaders[n$C._startIndex].endLoad(),n$C._startIndex++,n$O.now()-n$a>n$C.maxTimeOut)return console.warn("loader callback cost a long time:"+(n$O.now()-n$a)+" url="+n$C._loaders[n$C._startIndex-1].url),void n$x.timer.frameOnce(1,null,n$C.checkNext);n$C._loaders.length=0,n$C._startIndex=0,n$C._isWorking=!1},n$C.clearRes=function(n$a,n$b){if(null!=n$a){void 0===n$b&&(n$b=!1),n$a=n$I.formatURL(n$a);var n$c=n$C.getAtlas(n$a);if(n$c){for(var n$d=0,n$e=n$c.length;n$d<n$e;n$d++){var n$f=n$c[n$d],n$g=n$C.getRes(n$f);delete n$C.loadedMap[n$f],n$C.clearCache(n$a.substring(n$I.basePath.length),n$f.substring(n$I.basePath.length)),n$g&&n$g.destroy(n$b)}n$c.length=0,delete n$C.atlasMap[n$a],delete n$C.loadedMap[n$a]}else{var n$h=n$C.loadedMap[n$a];n$h&&(delete n$C.loadedMap[n$a],n$h instanceof laya.resource.Texture&&n$h.bitmap&&n$h.destroy(n$b))}}},n$C.clearTextureRes=function(n$a){n$a=n$I.formatURL(n$a);var n$b=laya.net.Loader.getAtlas(n$a),n$c=n$b&&0<n$b.length?laya.net.Loader.getRes(n$b[0]):laya.net.Loader.getRes(n$a);n$c&&n$c.bitmap&&(n$J.isConchApp&&!n$J.isConchWebGL?n$c.bitmap.source.releaseTexture&&n$c.bitmap.source.releaseTexture():null==n$c.bitmap._atlaser&&n$c.bitmap.releaseResource(!0))},n$C.getRes=function(n$a){return n$C.loadedMap[n$I.formatURL(n$a)]},n$C.getAtlas=function(n$a){return n$C.atlasMap[n$I.formatURL(n$a)]},n$C.cacheRes=function(n$a,n$b){n$a=n$I.formatURL(n$a),null!=n$C.loadedMap[n$a]?console.warn("Resources already exist,is repeated loading:",n$a):n$C.loadedMap[n$a]=n$b},n$C.setGroup=function(n$a,n$b){n$C.groupMap[n$b]||(n$C.groupMap[n$b]=[]),n$C.groupMap[n$b].push(n$a)},n$C.clearResByGroup=function(n$a){if(n$C.groupMap[n$a]){var n$b=n$C.groupMap[n$a],n$c=0,n$d=n$b.length;for(n$c=0;n$c<n$d;n$c++)n$C.clearRes(n$b[n$c]);n$b.length=0}},n$C.keepCache=function(n$a,n$b){if(n$a&&n$b){var n$c=n$C.cacheSet[n$b];n$c?-1==n$c.indexOf(n$a)&&n$c.push(n$a):n$C.cacheSet[n$b]=[n$a]}},n$C.clearCache=function(n$a,n$b){if(n$a&&n$b){var n$c=n$C.cacheSet[n$b];if(n$c){var n$d=n$c.indexOf(n$a);if(-1!==n$d){var n$e=n$c.length-1;0==n$e?(delete n$C.cacheSet[n$b],0<n$C.imgMgrSet[n$b]?n$g.imgMgrFree(n$b,n$C.imgMgrSet[n$b]):n$C.clearRes(n$b,!0)):(n$c[n$d]=n$c[n$e],n$c.length=n$e)}}}},n$C.saveObject=function(n$a,n$b,n$c){if(n$b&&n$a){var n$d=n$C.objectSet[n$a];n$d?(console.warn("Loader.saveObject: "+n$a),n$d[0]=n$b,n$d[1]=n$c):n$C.objectSet[n$a]=[n$b,n$c,[]]}},n$C.findObject=function(n$a){if(n$a){var n$b=n$C.objectSet[n$a];if(n$b)return n$b[0]}return null},n$C.keepObject=function(n$a,n$b){if(n$a&&n$b){var n$c=n$C.objectSet[n$b];n$c&&-1===n$c[2].indexOf(n$a)&&n$c[2].push(n$a)}},n$C.clearObject=function(n$a,n$b){if(n$a&&n$b){var n$c=n$C.objectSet[n$b];if(n$c){var n$d=n$c[2],n$e=n$d.indexOf(n$a);if(-1!==n$e){var n$f=n$d.length-1;0==n$f?(delete n$C.objectSet[n$b],n$c[1]&&n$c[1].call(null,n$c[0])):(n$d[n$e]=n$d[n$f],n$d.length=n$f)}}}},n$C.TEXT="text",n$C.JSON="json",n$C.XML="xml",n$C.BUFFER="arraybuffer",n$C.IMAGE="image",n$C.SOUND="sound",n$C.ATLAS="atlas",n$C.FONT="font",n$C.TTF="ttf",n$C.PLF="plf",n$C.PKM="pkm",n$C.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},n$C.parserMap={},n$C.groupMap={},n$C.maxTimeOut=100,n$C.loadedMap={},n$C.preLoadedMap={},n$C.atlasMap={},n$C._loaders=[],n$C._isWorking=!1,n$C._startIndex=0,n$C.imgCache={},n$C.cacheSet={},n$C.objectSet={},n$C.imgMgrSet={},n$C}(),n$ia=function(n$a){var n$m;function n$n(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},n$n.__super.call(this);for(var n$a=0;n$a<this._maxPriority;n$a++)this._resInfos[n$a]=[]}n$k(n$n,"laya.net.LoaderManager",n$j);var n$b=n$n.prototype;return n$b.create=function(n$a,n$c,n$b,n$d,n$e,n$f,n$g,n$h){if(null==n$f&&(n$f=2),null==n$g&&(n$g=!0),n$a instanceof Array){var n$i=n$a,n$j=n$i.length,n$k=0;if(n$b)var n$l=n$s.create(n$b.caller,n$b.method,n$b.args,!1);for(var n$m=0;n$m<n$j;n$m++){var n$n=n$i[n$m];"string"==typeof n$n&&(n$n=n$i[n$m]={url:n$n}),n$n.progress=0}for(n$m=0;n$m<n$j;n$m++){n$n=n$i[n$m];var n$o=n$b?n$s.create(null,n$r,[n$n],!1):null,n$p=n$b||n$c?n$s.create(null,n$q,[n$n]):null;this._create(n$n.url,n$p,n$o,n$n.clas||n$d,n$n.params||n$e,null!=n$n.priority&&0<=n$n.priority?n$n.priority:n$f,n$g,n$n.group||n$h)}function n$q(n$a,n$b){n$k++,n$a.progress=1,n$k===n$j&&n$c&&n$c.run()}function n$r(n$a,n$b){n$a.progress=n$b;for(var n$c=0,n$d=0;n$d<n$j;n$d++){n$c+=n$i[n$d].progress}var n$e=n$c/n$j;n$l.runWith(n$e)}return!0}return this._create(n$a,n$c,n$b,n$d,n$e,n$f,n$g,n$h)},n$b._create=function(n$b,n$c,n$a,n$d,n$e,n$f,n$g,n$h){n$b&&""!=n$b||console.error("加载的url不合法 "+n$b),null==n$f&&(n$f=2),null==n$g&&(n$g=!0);var n$i=n$I.formatURL(n$b),n$j=this.getRes(n$i);if(n$j)!n$j.hasOwnProperty("loaded")||n$j.loaded?(n$a&&n$a.runWith(1),n$c&&n$c.run()):n$c&&n$x.loader._createListener(n$b,n$c.caller,n$c.method,n$c.args,!0,!1);else{var n$k=n$$.getFileExtension(n$b),n$l=n$n.createMap[n$k];if(!n$l)throw new Error("LoaderManager:unknown file("+n$b+") extension with: "+n$k+".");n$d||(n$d=n$l[0]);var n$m=n$l[1];if("atlas"==n$k)this.load(n$b,n$c,n$a,n$m,n$f,n$g);else{n$d===n$ka&&(n$m="htmlimage"),(n$j=n$d?new n$d:null).hasOwnProperty("_loaded")&&(n$j._loaded=!1),n$j._setUrl(n$b),n$h&&n$j._setGroup(n$h),this._createLoad(n$j,n$b,n$s.create(null,function(n$a){n$j&&!n$j.destroyed&&n$a&&n$j.onAsynLoaded.call(n$j,n$b,n$a,n$e),n$c&&n$c.run();n$x.loader.event(n$b)}),n$a,n$m,n$f,!1,n$h,!0),n$g&&this.cacheRes(n$i,n$j)}}return n$j},n$b.load=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){n$a&&""!=n$a||console.error("加载的url不合法 "+n$a);var n$i=this;if(null==n$e&&(n$e=2),null==n$f&&(n$f=!0),void 0===n$h&&(n$h=!1),n$a instanceof Array)return this._loadAssets(n$a,n$b,n$c,n$d,n$e,n$f,n$g);var n$j=n$ha.getRes(n$a);if(null!=n$j)n$x.timer.frameOnce(1,null,function(){n$c&&n$c.runWith(1),n$b&&n$b.runWith(n$j),n$i._loaderCount||n$i.event("complete")});else{var n$k=n$n._resMap[n$a];n$k?(n$b&&n$k._createListener("complete",n$b.caller,n$b.method,n$b.args,!1,!1),n$c&&n$k._createListener("progress",n$c.caller,n$c.method,n$c.args,!1,!1)):((n$k=this._infoPool.length?this._infoPool.pop():new n$m).url=n$a,n$k.type=n$d,n$k.cache=n$f,n$k.group=n$g,n$k.ignoreCache=n$h,n$k.priority=n$e,n$b&&n$k.on("complete",n$b.caller,n$b.method,n$b.args),n$c&&n$k.on("progress",n$c.caller,n$c.method,n$c.args),n$n._resMap[n$a]=n$k,n$e=n$e<this._maxPriority?0<=n$e?n$e:0:this._maxPriority-1,this._resInfos[n$e].push(n$k),this._next())}return this},n$b._createLoad=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){var n$j=this;if(null==n$f&&(n$f=2),null==n$g&&(n$g=!0),void 0===n$i&&(n$i=!1),n$b instanceof Array)return this._loadAssets(n$b,n$c,n$d,n$e,n$f,n$g,n$h);var n$k=n$ha.getRes(n$b);if(null!=n$k)n$x.timer.frameOnce(1,null,function(){n$d&&n$d.runWith(1),n$c&&n$c.runWith(n$k),n$j._loaderCount||n$j.event("complete")});else{var n$l=n$n._resMap[n$b];n$l?(n$c&&n$l._createListener("complete",n$c.caller,n$c.method,n$c.args,!1,!1),n$d&&n$l._createListener("progress",n$d.caller,n$d.method,n$d.args,!1,!1)):((n$l=this._infoPool.length?this._infoPool.pop():new n$m).url=n$b,n$l.clas=n$a,n$l.type=n$e,n$l.cache=n$g,n$l.group=n$h,n$l.ignoreCache=n$i,n$l.priority=n$f,n$c&&n$l.on("complete",n$c.caller,n$c.method,n$c.args),n$d&&n$l.on("progress",n$d.caller,n$d.method,n$d.args),n$n._resMap[n$b]=n$l,n$f=n$f<this._maxPriority?0<=n$f?n$f:0:this._maxPriority-1,this._resInfos[n$f].push(n$l),this._next())}return this},n$b._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var n$a=0;n$a<this._maxPriority;n$a++)for(var n$b=this._resInfos[n$a];0<n$b.length;){var n$c=n$b.shift();if(n$c)return this._doLoad(n$c)}this._loaderCount||this.event("complete")}},n$b._doLoad=function(n$b){this._loaderCount++;var n$c=this._loaders.length?this._loaders.pop():new n$ha;n$c.on("complete",null,n$e),n$c.on("progress",null,function(n$a){n$b.event("progress",n$a)}),n$c.on("error",null,function(n$a){n$e(null)});var n$d=this;function n$e(n$a){n$c.offAll(),n$c._data=null,n$c._customParse=!1,n$d._loaders.push(n$c),n$d._endLoad(n$b,n$a instanceof Array?[n$a]:n$a),n$d._loaderCount--,n$d._next()}n$c._class=n$b.clas,1<=n$b.priority?(n$c.priority=n$b.priority,n$c.realTime=!1):(n$c.priority=0,n$c.realTime=!0),n$c.load(n$b.url,n$b.type,n$b.cache,n$b.group,n$b.ignoreCache)},n$b._endLoad=function(n$a,n$b){var n$c=n$a.url;if(null==n$b){var n$d=this._failRes[n$c]||0;if(n$d<this.retryNum)return console.warn("[warn]Retry to load:",n$c),this._failRes[n$c]=n$d+1,void n$x.timer.once(this.retryDelay,this,this._addReTry,[n$a],!1);console.warn("[error]Failed to load:",n$c),this.event("error",n$c)}this._failRes[n$c]&&(this._failRes[n$c]=0),delete n$n._resMap[n$c],n$a.event("complete",n$b),n$a.offAll(),this._infoPool.push(n$a)},n$b._addReTry=function(n$a){this._resInfos[this._maxPriority-1].push(n$a),this._next()},n$b.clearRes=function(n$a,n$b){void 0===n$b&&(n$b=!1),n$ha.clearRes(n$a,n$b)},n$b.getRes=function(n$a){return n$ha.getRes(n$a)},n$b.cacheRes=function(n$a,n$b){n$ha.cacheRes(n$a,n$b)},n$b.clearTextureRes=function(n$a){n$ha.clearTextureRes(n$a)},n$b.setGroup=function(n$a,n$b){n$ha.setGroup(n$a,n$b)},n$b.clearResByGroup=function(n$a){n$ha.clearResByGroup(n$a)},n$b.clearUnLoaded=function(){for(var n$a=0;n$a<this._maxPriority;n$a++){for(var n$b=this._resInfos[n$a],n$c=n$b.length-1;-1<n$c;n$c--){var n$d=n$b[n$c];n$d&&(n$d.offAll(),this._infoPool.push(n$d))}n$b.length=0}this._loaderCount=0,n$n._resMap={}},n$b.cancelLoadByUrls=function(n$a){if(n$a)for(var n$b=0,n$c=n$a.length;n$b<n$c;n$b++)this.cancelLoadByUrl(n$a[n$b])},n$b.cancelLoadByUrl=function(n$a){for(var n$b=0;n$b<this._maxPriority;n$b++)for(var n$c=this._resInfos[n$b],n$d=n$c.length-1;-1<n$d;n$d--){var n$e=n$c[n$d];n$e&&n$e.url===n$a&&(n$c[n$d]=null,n$e.offAll(),this._infoPool.push(n$e))}n$n._resMap[n$a]&&delete n$n._resMap[n$a]},n$b._loadAssets=function(n$a,n$c,n$g,n$b,n$d,n$e,n$f){null==n$d&&(n$d=2),null==n$e&&(n$e=!0);for(var n$h=n$a.length,n$i=0,n$j=0,n$k=[],n$l=!0,n$m=0;n$m<n$h;n$m++){var n$n=n$a[n$m];if(!n$n)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+n$a);"string"==typeof n$n&&(n$n={url:n$n,type:n$b,size:1,priority:n$d}),n$n.size||(n$n.size=1),n$n.progress=0,n$j+=n$n.size,n$k.push(n$n);var n$o=n$g?n$s.create(null,n$r,[n$n],!1):null,n$p=n$c||n$g?n$s.create(null,n$q,[n$n]):null;this.load(n$n.url,n$p,n$o,n$n.type,null!=n$n.priority&&0<=n$n.priority?n$n.priority:2,n$e,n$n.group||n$f)}function n$q(n$a,n$b){n$i++,n$a.progress=1,n$b||(n$l=!1),n$i===n$h&&n$c&&n$c.runWith(n$l)}function n$r(n$a,n$b){if(null!=n$g){n$a.progress=n$b;for(var n$c=0,n$d=0;n$d<n$k.length;n$d++){var n$e=n$k[n$d];n$c+=n$e.size*n$e.progress}var n$f=n$c/n$j;n$g.runWith(n$f)}}return this},n$n.cacheRes=function(n$a,n$b){n$ha.cacheRes(n$a,n$b)},n$n._resMap={},n$i(n$n,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),n$n.__init$=function(){n$m=function(n$a){function n$b(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,n$b.__super.call(this)}return n$k(n$b,"",n$j),n$b}()},n$n}(),n$ja=(function(n$a){function n$e(n$a){n$e.__super.call(this),n$a||(n$a=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var n$b=0,n$c=0,n$d=0;n$d<20;n$d++)n$d%5!=4?this._mat[n$b++]=n$a[n$d]:this._alpha[n$c++]=n$a[n$d];this._action=n$F.createFilterAction(32),this._action.data=this}n$k(n$e,"laya.filters.ColorFilter",n$r);var n$b=n$e.prototype;n$x.imps(n$b,{"laya.filters.IFilter":!0}),n$b.callNative=function(n$a){n$a._$P.cf=this;n$a.conchModel&&n$a.conchModel.setFilterMatrix&&n$a.conchModel.setFilterMatrix(this._mat,this._alpha)},n$o(0,n$b,"type",function(){return 32}),n$o(0,n$b,"action",function(){return this._action})}(),function(n$a){function n$d(n$a,n$b,n$c){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===n$b&&(n$b=0),n$d.__super.call(this),this._byteClass=n$c||n$P,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,n$a&&0<n$b&&n$b<65535&&this.connect(n$a,n$b)}n$k(n$d,"laya.net.Socket",n$j);var n$b=n$d.prototype;n$b.connect=function(n$a,n$b){var n$c="ws://"+n$a+":"+n$b;n$c="https:"==n$O.window.location.protocol?"wss://"+n$a+":"+n$b:"ws://"+n$a+":"+n$b,this.connectByUrl(n$c)},n$b.connectByUrl=function(n$a){var n$b=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new n$O.window.WebSocket(n$a,this.protocols):this._socket=new n$O.window.WebSocket(n$a),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(n$a){n$b._onOpen(n$a)},this._socket.onmessage=function(n$a){n$b._onMessage(n$a)},this._socket.onclose=function(n$a){n$b._onClose(n$a)},this._socket.onerror=function(n$a){n$b._onError(n$a)}},n$b.cleanSocket=function(){try{this._socket.close()}catch(n$a){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},n$b.close=function(){if(null!=this._socket)try{this._socket.close()}catch(n$a){}},n$b._onOpen=function(n$a){this._connected=!0,this.event("open",n$a)},n$b._onMessage=function(n$a){if(n$a&&n$a.data){var n$b=n$a.data;if(this.disableInput&&n$b)this.event("message",n$b);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var n$c=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,n$b&&("string"==typeof n$b?this._input.writeUTFBytes(n$b):this._input.writeArrayBuffer(n$b),this._addInputPosition=this._input.pos,this._input.pos=n$c),this.event("message",n$b)}}},n$b._onClose=function(n$a){this._connected=!1,this.event("close",n$a)},n$b._onError=function(n$a){this.event("error",n$a)},n$b.send=function(n$a){this._socket.send(n$a)},n$b.flush=function(){if(this._output&&0<this._output.length){var n$b;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(n$a){n$b=n$a}this._output.endian=this.endian,this._output.clear(),n$b&&this.event("error",n$b)}},n$o(0,n$b,"input",function(){return this._input}),n$o(0,n$b,"output",function(){return this._output}),n$o(0,n$b,"connected",function(){return this._connected}),n$o(0,n$b,"endian",function(){return this._endian},function(n$a){this._endian=n$a,null!=this._input&&(this._input.endian=n$a),null!=this._output&&(this._output.endian=n$a)}),n$d.LITTLE_ENDIAN="littleEndian",n$d.BIG_ENDIAN="bigEndian"}(),function(n$a){function n$h(){n$h.__super.call(this),this._$1__id=++n$h._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(n$h._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,n$N.currentResourceManager&&n$N.currentResourceManager.addResource(this)}n$k(n$h,"laya.resource.Resource",n$j);var n$b=n$h.prototype;return n$x.imps(n$b,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),n$b._setUrl=function(n$a){var n$b;this._url!==n$a&&(this._url&&((n$b=n$h._urlResourcesMap[this._url]).splice(n$b.indexOf(this),1),0===n$b.length&&delete n$h._urlResourcesMap[this._url]),n$a&&((n$b=n$h._urlResourcesMap[n$a])||(n$h._urlResourcesMap[n$a]=n$b=[]),n$b.push(this)),this._url=n$a)},n$b._getGroup=function(){return this._group},n$b._setGroup=function(n$a){var n$b;this._group!==n$a&&(this._group&&((n$b=n$h._groupResourcesMap[this._group]).splice(n$b.indexOf(this),1),0===n$b.length&&delete n$h._groupResourcesMap[this._group]),n$a&&((n$b=n$h._groupResourcesMap[n$a])||(n$h._groupResourcesMap[n$a]=n$b=[]),n$b.push(this)),this._group=n$a)},n$b._addReference=function(){this._referenceCount++},n$b._removeReference=function(){this._referenceCount--},n$b._clearReference=function(){this._referenceCount=0},n$b._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},n$b.recreateResource=function(){this.completeCreate()},n$b.disposeResource=function(){},n$b.activeResource=function(n$a){void 0===n$a&&(n$a=!1),this._lastUseFrameCount=n$X.loopCount,!this._destroyed&&this.__loaded&&(this._released||n$a)&&this.recreateResource()},n$b.releaseResource=function(n$a){return void 0===n$a&&(n$a=!0),!(!n$a&&this.lock)&&(!(this._released&&!n$a)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},n$b.onAsynLoaded=function(n$a,n$b,n$c){throw new Error("Resource: must override this function!")},n$b.destroy=function(){var n$a;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete n$h._idResourcesMap[this.id],this._url&&((n$a=n$h._urlResourcesMap[this._url])&&(n$a.splice(n$a.indexOf(this),1),0===n$a.length&&delete n$h._urlResourcesMap[this.url]),n$ha.clearRes(this._url),this.__loaded||n$F.cancelLoadByUrl(this._url)),this._group&&((n$a=n$h._groupResourcesMap[this._group]).splice(n$a.indexOf(this),1),0===n$a.length&&delete n$h._groupResourcesMap[this.url]))},n$b.completeCreate=function(){this._released=!1,this.event("recovered",this)},n$b.dispose=function(){this.destroy()},n$o(0,n$b,"memorySize",function(){return this._memorySize},function(n$a){var n$b=n$a-this._memorySize;this._memorySize=n$a,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,n$b),this.resourceManager&&this.resourceManager.addSize(n$b)}),n$o(0,n$b,"_loaded",null,function(n$a){this.__loaded=n$a}),n$o(0,n$b,"loaded",function(){return this.__loaded}),n$o(0,n$b,"id",function(){return this._$1__id}),n$o(0,n$b,"destroyed",function(){return this._destroyed}),n$o(0,n$b,"group",function(){return this._getGroup()},function(n$a){this._setGroup(n$a)}),n$o(0,n$b,"resourceManager",function(){return this._resourceManager}),n$o(0,n$b,"url",function(){return this._url}),n$o(0,n$b,"released",function(){return this._released}),n$o(0,n$b,"referenceCount",function(){return this._referenceCount}),n$h.getResourceByID=function(n$a){return n$h._idResourcesMap[n$a]},n$h.getResourceByURL=function(n$a,n$b){return void 0===n$b&&(n$b=0),null==n$h._urlResourcesMap[n$a]?null:n$h._urlResourcesMap[n$a][n$b]},n$h.getResourceCountByURL=function(n$a){return n$h._urlResourcesMap[n$a].length},n$h.destroyUnusedResources=function(n$a){var n$b;if(n$a){var n$c=n$h._groupResourcesMap[n$a];if(n$c)for(var n$d=n$c.slice(),n$e=0,n$f=n$d.length;n$e<n$f;n$e++)(n$b=n$d[n$e]).lock||0!==n$b._referenceCount||n$b.destroy()}else for(var n$g in n$h._idResourcesMap)(n$b=n$h._idResourcesMap[n$g]).lock||0!==n$b._referenceCount||n$b.destroy()},n$h._uniqueIDCounter=0,n$h._idResourcesMap={},n$h._urlResourcesMap={},n$h._groupResourcesMap={},n$h}()),n$ka=function(n$a){function n$C(n$a,n$b){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,n$C.__super.call(this),n$a&&null!=n$a._addReference&&n$a._addReference(),this.setTo(n$a,n$b)}n$k(n$C,"laya.resource.Texture",n$j);var n$b=n$C.prototype;return n$b._setUrl=function(n$a){this.url=n$a},n$b.setTo=function(n$a,n$b){if(n$a instanceof n$g.HTMLElement){var n$c=n$ta.create("2D",n$a);this.bitmap=n$c}else this.bitmap=n$a;if(this.uv=n$b||n$C.DEF_UV,n$a){this._w=n$a.width,this._h=n$a.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var n$d=this;if(this._loaded)n$F.addToAtlas&&n$F.addToAtlas(n$d);else{var n$e=n$a;n$e instanceof laya.resource.HTMLImage&&n$e.image&&n$e.image.addEventListener("load",function(n$a){n$F.addToAtlas&&n$F.addToAtlas(n$d)},!1)}}},n$b.active=function(){this.bitmap&&this.bitmap.activeResource()},n$b.destroy=function(n$a){if(void 0===n$a&&(n$a=!1),this.alphaTexture&&(this.alphaTexture.destroy(n$a),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var n$b=this.bitmap;n$a?(n$J.isConchApp&&n$b.source&&n$b.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,n$b.dispose(),n$b._clearReference()):(n$b._removeReference(),0==n$b.referenceCount&&(n$J.isConchApp&&n$b.source&&n$b.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,n$b.dispose())),this.url&&this===n$x.loader.getRes(this.url)&&n$x.loader.clearRes(this.url,n$a),this._loaded=!1}},n$b.load=function(n$a){var n$b=this;this._loaded=!1,n$a=n$I.customFormat(n$a);var n$c=this.bitmap||(this.bitmap=n$wa.create(n$a));n$c.uri=n$a,n$c&&n$c._addReference();var n$d=this;n$c.onload=function(){n$c.onload=null,n$d._loaded=!0,n$b.sourceWidth=n$b._w=n$c.width,n$b.sourceHeight=n$b._h=n$c.height,n$d.event("loaded",this),n$F.addToAtlas&&n$F.addToAtlas(n$d)}},n$b.addTextureToAtlas=function(n$a){n$F.addTextureToAtlas(this)},n$b.getPixels=function(n$a,n$b,n$c,n$d){if(n$J.isConchApp){var n$e=this.bitmap;if(n$e.source&&n$e.source.getImageData){var n$f=n$e.source.getImageData(n$a,n$b,n$c,n$d),n$g=new Uint8Array(n$f);return Array.from(n$g)}return null}return n$J.isWebGL?n$F.getTexturePixels(this,n$a,n$b,n$c,n$d):(n$O.canvas.size(n$c,n$d),n$O.canvas.clear(),n$O.context.drawTexture(this,-n$a,-n$b,this.width,this.height,0,0),n$O.context.getImageData(0,0,n$c,n$d).data)},n$b.onAsynLoaded=function(n$a,n$b){if(n$b){if("function"!=typeof n$b._addReference)throw new Error("bitmap._addReference is not a function. "+n$b.className+" "+typeof n$b._addReference+" "+n$b.constructor);n$b._addReference()}this.setTo(n$b,this.uv),this._loaded&&this.event("loaded",this)},n$o(0,n$b,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),n$o(0,n$b,"loaded",function(){return this._loaded}),n$o(0,n$b,"released",function(){return!this.bitmap||this.bitmap.released}),n$o(0,n$b,"width",function(){return this._w?this._w:this.uv&&this.uv!==n$C.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(n$a){this._w=n$a,this.sourceWidth||(this.sourceWidth=n$a)}),n$o(0,n$b,"repeat",function(){return!n$J.isWebGL||!this.bitmap||this.bitmap.repeat},function(n$a){n$a&&n$J.isWebGL&&this.bitmap&&(this.bitmap.repeat=n$a)&&(this.bitmap.enableMerageInAtlas=!1)}),n$o(0,n$b,"height",function(){return this._h?this._h:this.uv&&this.uv!==n$C.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(n$a){this._h=n$a,this.sourceHeight||(this.sourceHeight=n$a)}),n$o(0,n$b,"isLinearSampling",function(){return!n$J.isWebGL||9728!=this.bitmap.minFifter},function(n$a){!n$a&&n$J.isWebGL&&(n$a||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),n$C.moveUV=function(n$a,n$b,n$c){for(var n$d=0;n$d<8;n$d+=2)n$c[n$d]+=n$a,n$c[n$d+1]+=n$b;return n$c},n$C.create=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){void 0===n$f&&(n$f=0),void 0===n$g&&(n$g=0),void 0===n$h&&(n$h=0),void 0===n$i&&(n$i=0);var n$j=n$a instanceof laya.resource.Texture,n$k=n$j?n$a.uv:n$C.DEF_UV,n$l=n$j?n$a.bitmap:n$a,n$m=n$F.isAtlas(n$l);if(n$m){var n$n=n$l._atlaser,n$o=n$a._atlasID;if(-1==n$o)throw new Error("create texture error");n$l=n$n._inAtlasTextureBitmapValue[n$o],n$k=n$n._inAtlasTextureOriUVValue[n$o]}var n$p=new n$C(n$l,null);n$l.width&&n$b+n$d>n$l.width&&(n$d=n$l.width-n$b),n$l.height&&n$c+n$e>n$l.height&&(n$e=n$l.height-n$c),n$p.width=n$d,n$p.height=n$e,n$p.offsetX=n$f,n$p.offsetY=n$g,n$p.sourceWidth=n$h||n$d,n$p.sourceHeight=n$i||n$e;var n$q=1/n$l.width,n$r=1/n$l.height;n$b*=n$q,n$c*=n$r,n$d*=n$q,n$e*=n$r;var n$s=n$p.uv[0],n$t=n$p.uv[1],n$u=n$p.uv[4],n$v=n$p.uv[5],n$w=n$u-n$s,n$x=n$v-n$t,n$y=n$C.moveUV(n$k[0],n$k[1],[n$b,n$c,n$b+n$d,n$c,n$b+n$d,n$c+n$e,n$b,n$c+n$e]);n$p.uv=[n$s+n$y[0]*n$w,n$t+n$y[1]*n$x,n$u-(1-n$y[2])*n$w,n$t+n$y[3]*n$x,n$u-(1-n$y[4])*n$w,n$v-(1-n$y[5])*n$x,n$s+n$y[6]*n$w,n$v-(1-n$y[7])*n$x],n$m&&n$p.addTextureToAtlas();var n$z=n$l.scaleRate;return n$z&&1!=n$z?(n$p.sourceWidth/=n$z,n$p.sourceHeight/=n$z,n$p.width/=n$z,n$p.height/=n$z,n$p.scaleRate=n$z,n$p.offsetX/=n$z,n$p.offsetY/=n$z):n$p.scaleRate=1,n$p},n$C.createFromTexture=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$a.scaleRate;1!=n$f&&(n$b*=n$f,n$c*=n$f,n$d*=n$f,n$e*=n$f);var n$g=n$z.TEMP.setTo(n$b-n$a.offsetX,n$c-n$a.offsetY,n$d,n$e),n$h=n$g.intersection(n$C._rect1.setTo(0,0,n$a.width,n$a.height),n$C._rect2);if(!n$h)return null;var n$i=n$C.create(n$a,n$h.x,n$h.y,n$h.width,n$h.height,n$h.x-n$g.x,n$h.y-n$g.y,n$d,n$e);if(n$i.bitmap&&n$i.bitmap._removeReference)return n$i.bitmap._removeReference(),n$i;var n$j="bitmap:"+(n$i.bitmap?n$i.bitmap.constructor?n$i.bitmap.constructor.name:n$i.bitmap.__className:"")+", url:"+(n$a.url+" | "+(n$i.bitmap?n$i.bitmap.url:n$a.url))+", x="+n$b+",y="+n$c+",width="+n$d+",height="+n$e+", result="+(n$h?n$h.x+","+n$h.y+","+n$h.width+","+n$h.height:"null")+", rect="+n$g.x+","+n$g.y+","+n$g.width+","+n$g.height;throw new Error("报错：bitmap._removeReference is not a function  "+n$j)},n$C.DEF_UV=[0,0,1,0,1,1,0,1],n$C.INV_UV=[0,1,1,1,1,0,0,0],n$C._rect1=new n$z,n$C._rect2=new n$z,n$C}(),n$a=function(n$a){var n$h;function n$f(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,n$f.__super.call(this)}n$k(n$f,"laya.utils.TimeLine",n$j);var n$b=n$f.prototype;return n$b.to=function(n$a,n$b,n$c,n$d,n$e){return void 0===n$e&&(n$e=0),this._create(n$a,n$b,n$c,n$d,n$e,!0)},n$b.from=function(n$a,n$b,n$c,n$d,n$e){return void 0===n$e&&(n$e=0),this._create(n$a,n$b,n$c,n$d,n$e,!1)},n$b._create=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=n$W.getItemByClass("tweenData",n$h);return n$g.isTo=n$f,n$g.type=0,n$g.target=n$a,n$g.duration=n$c,n$g.data=n$b,n$g.startTime=this._startTime+n$e,n$g.endTime=n$g.startTime+n$g.duration,n$g.ease=n$d,this._startTime=Math.max(n$g.endTime,this._startTime),this._tweenDataList.push(n$g),this._startTimeSort=!0,this._endTimeSort=!0,this},n$b.addLabel=function(n$a,n$b){var n$c=n$W.getItemByClass("tweenData",n$h);return n$c.type=1,n$c.data=n$a,n$c.endTime=n$c.startTime=this._startTime+n$b,this._labelDic||(this._labelDic={}),this._labelDic[n$a]=n$c,this._tweenDataList.push(n$c),this},n$b.removeLabel=function(n$a){if(this._labelDic&&this._labelDic[n$a]){var n$b=this._labelDic[n$a];if(n$b){var n$c=this._tweenDataList.indexOf(n$b);-1<n$c&&this._tweenDataList.splice(n$c,1)}delete this._labelDic[n$a]}},n$b.gotoTime=function(n$a){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var n$b,n$c,n$d,n$e;for(var n$f in this._firstTweenDic)if(n$c=this._firstTweenDic[n$f])for(var n$g in n$c)n$c.diyTarget.hasOwnProperty(n$g)&&(n$c.diyTarget[n$g]=n$c[n$g]);for(n$f in this._tweenDic)(n$b=this._tweenDic[n$f]).clear(),delete this._tweenDic[n$f];if(this._index=0,this._gidIndex=0,this._currTime=n$a,this._lastTime=n$O.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=n$d=this._tweenDataList.concat(),n$d.sort(function(n$a,n$b){return n$a.endTime>n$b.endTime?1:n$a.endTime<n$b.endTime?-1:0})}else n$d=this._endTweenDataList;for(var n$h=0,n$i=n$d.length;n$h<n$i;n$h++)if(0==(n$e=n$d[n$h]).type){if(!(n$a>=n$e.endTime))break;this._index=Math.max(this._index,n$h+1);var n$j=n$e.data;if(n$e.isTo)for(var n$k in n$j)n$e.target[n$k]=n$j[n$k]}for(n$h=0,n$i=this._tweenDataList.length;n$h<n$i;n$h++)0==(n$e=this._tweenDataList[n$h]).type&&n$a>=n$e.startTime&&n$a<n$e.endTime&&(this._index=Math.max(this._index,n$h+1),this._gidIndex++,(n$b=n$W.getItemByClass("tween",n$Z))._create(n$e.target,n$e.data,n$e.duration,n$e.ease,n$s.create(this,this._animComplete,[this._gidIndex]),0,!1,n$e.isTo,!0,!1),n$b.setStartTime(this._currTime-(n$a-n$e.startTime)),n$b._updateEase(this._currTime),n$b.gid=this._gidIndex,this._tweenDic[this._gidIndex]=n$b)}},n$b.gotoLabel=function(n$a){if(null!=this._labelDic){var n$b=this._labelDic[n$a];n$b&&this.gotoTime(n$b.startTime)}},n$b.pause=function(){n$x.timer.clear(this,this._update)},n$b.resume=function(){this.play(this._currTime,this._loopKey)},n$b.play=function(n$a,n$b){if(void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(n$a,n$b){return n$a.startTime>n$b.startTime?1:n$a.startTime<n$b.startTime?-1:0});for(var n$c=0,n$d=this._tweenDataList.length;n$c<n$d;n$c++){var n$e=this._tweenDataList[n$c];if(null!=n$e&&0==n$e.type){var n$f=n$e.target,n$g=n$f.$_GID||(n$f.$_GID=n$$.getGID()),n$h=null;for(var n$i in null==this._firstTweenDic[n$g]?((n$h={}).diyTarget=n$f,this._firstTweenDic[n$g]=n$h):n$h=this._firstTweenDic[n$g],n$e.data)null==n$h[n$i]&&(n$h[n$i]=n$f[n$i])}}}"string"==typeof n$a?this.gotoLabel(n$a):this.gotoTime(n$a),this._loopKey=n$b,this._lastTime=n$O.now(),n$x.timer.frameLoop(1,this,this._update)}},n$b._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var n$a in this._tweenDic)(n$b=this._tweenDic[n$a]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var n$b,n$c=n$O.now(),n$d=n$c-this._lastTime,n$e=this._currTime+=n$d*this.scale;for(n$a in this._lastTime=n$c,this._tweenDic)(n$b=this._tweenDic[n$a])._updateEase(n$e);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var n$f=this._tweenDataList[this._index];n$e>=n$f.startTime&&(this._index++,0==n$f.type?(this._gidIndex++,(n$b=n$W.getItemByClass("tween",n$Z))._create(n$f.target,n$f.data,n$f.duration,n$f.ease,n$s.create(this,this._animComplete,[this._gidIndex]),0,!1,n$f.isTo,!0,!1),n$b.setStartTime(n$e),n$b.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=n$b)._updateEase(n$e)):this.event("label",n$f.data))}},n$b._animComplete=function(n$a){this._tweenDic[n$a]&&delete this._tweenDic[n$a]},n$b._complete=function(){this.event("complete")},n$b.reset=function(){var n$a;if(this._labelDic)for(n$a in this._labelDic)delete this._labelDic[n$a];for(n$a in this._tweenDic)this._tweenDic[n$a].clear(),delete this._tweenDic[n$a];for(n$a in this._firstTweenDic)delete this._firstTweenDic[n$a];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var n$b,n$c=0;for(n$b=this._tweenDataList.length,n$c=0;n$c<n$b;n$c++)this._tweenDataList[n$c]&&this._tweenDataList[n$c].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,n$x.timer.clear(this,this._update)},n$b.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},n$o(0,n$b,"index",function(){return this._frameIndex},function(n$a){this._frameIndex=n$a,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),n$o(0,n$b,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),n$f.to=function(n$a,n$b,n$c,n$d,n$e){return void 0===n$e&&(n$e=0),(new n$f).to(n$a,n$b,n$c,n$d,n$e)},n$f.from=function(n$a,n$b,n$c,n$d,n$e){return void 0===n$e&&(n$e=0),(new n$f).from(n$a,n$b,n$c,n$d,n$e)},n$f.__init$=function(){n$h=function(){function n$a(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return n$k(n$a,""),n$a.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,n$W.recover("tweenData",this)},n$a}()},n$f}(),n$la=function(n$e){function n$c(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,n$c.__super.call(this),this._style=n$h.EMPTY}n$k(n$c,"laya.display.Sprite",n$e);var n$a=n$c.prototype;return n$x.imps(n$a,{"laya.display.ILayout":!0}),n$a.createConchModel=function(){return new ConchNode},n$a.destroy=function(n$a){if(void 0===n$a&&(n$a=!0),this._releaseMem(),!this._destroyed){this.filters=null;var n$b=this.mask;n$b&&(this.mask=null,n$b.destroy(n$a))}n$e.prototype.destroy.call(this,n$a),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},n$a.updateZOrder=function(){n$$.updateOrder(this._childs)&&this.repaint()},n$a.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},n$a.setBounds=function(n$a){this._set$P("uBounds",n$a)},n$a.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new n$z),n$z._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},n$a.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new n$z),n$z._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},n$a._boundPointsToParent=function(n$a){void 0===n$a&&(n$a=!1);var n$b=0,n$c=0;this._style&&(n$b=this._style._tf.translateX,n$c=this._style._tf.translateY,n$a=n$a||0!==this._style._tf.rotate,this._style.scrollRect&&(n$b+=this._style.scrollRect.x,n$c+=this._style.scrollRect.y));var n$d=this._getBoundPointsM(n$a);if(!n$d||n$d.length<1)return n$d;if(8!=n$d.length&&(n$d=n$a?n$v.scanPList(n$d):n$z._getWrapRec(n$d,n$z.TEMP)._getBoundPoints()),!this.transform)return n$$.transPointList(n$d,this._x-n$b,this._y-n$c),n$d;var n$e=n$y.TEMP,n$f=0,n$g=n$d.length;for(n$f=0;n$f<n$g;n$f+=2)n$e.x=n$d[n$f],n$e.y=n$d[n$f+1],this.toParentPoint(n$e),n$d[n$f]=n$e.x,n$d[n$f+1]=n$e.y;return n$d},n$a.getGraphicBounds=function(n$a){return void 0===n$a&&(n$a=!1),this._graphics?this._graphics.getBounds(n$a):n$z.TEMP.setTo(0,0,0,0)},n$a._getBoundPointsM=function(n$a){if(void 0===n$a&&(n$a=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var n$b=n$$.clearArray(this._$P.temBM),n$c=n$z.TEMP;return n$c.copyFrom(this.scrollRect),n$$.concatArray(n$b,n$c._getBoundPoints()),n$b}for(var n$d,n$e,n$f,n$g=this._graphics?this._graphics.getBoundPoints():n$$.clearArray(this._$P.temBM),n$h=0,n$i=(n$f=this._childs).length;n$h<n$i;n$h++)(n$d=n$f[n$h])instanceof laya.display.Sprite&&1==n$d.visible&&(n$e=n$d._boundPointsToParent(n$a))&&(n$g=n$g?n$$.concatArray(n$g,n$e):n$e);return n$g},n$a.getStyle=function(){return this._style===n$h.EMPTY&&(this._style=new n$h),this._style},n$a.setStyle=function(n$a){this._style=n$a},n$a._adjustTransform=function(){this._tfChanged=!1;var n$a,n$b=this._style._tf,n$c=n$b.scaleX,n$d=n$b.scaleY;if(n$b.rotate||1!==n$c||1!==n$d||n$b.skewX||n$b.skewY){(n$a=this._transform||(this._transform=n$G.create())).bTransform=!0;var n$e=.0174532922222222*(n$b.rotate-n$b.skewX),n$f=.0174532922222222*(n$b.rotate+n$b.skewY),n$g=Math.cos(n$f),n$h=Math.sin(n$f),n$i=Math.sin(n$e),n$j=Math.cos(n$e);return n$a.a=n$c*n$g,n$a.b=n$c*n$h,n$a.c=-n$d*n$i,n$a.d=n$d*n$j,n$a.tx=n$a.ty=0,n$a}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,n$a},n$a.pos=function(n$a,n$b,n$c){if(void 0===n$c&&(n$c=!1),this._x!==n$a||this._y!==n$b){if(this.destroyed)return this;if(n$c){this._x=n$a,this._y=n$b,this.conchModel&&this.conchModel.pos(this._x,this._y);var n$d=this._parent;n$d&&0===n$d._repaint&&(n$d._repaint=1,n$d.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=n$a,this.y=n$b}return this},n$a.pivot=function(n$a,n$b){return this.pivotX=n$a,this.pivotY=n$b,this},n$a.size=function(n$a,n$b){return this.width=n$a,this.height=n$b,this},n$a.scale=function(n$a,n$b,n$c){void 0===n$c&&(n$c=!1);var n$d=this.getStyle(),n$e=n$d._tf;if(n$e.scaleX!=n$a||n$e.scaleY!=n$b){if(this.destroyed)return this;if(n$c){n$d.setScale(n$a,n$b),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(n$a,n$b),this._renderType|=4;var n$f=this._parent;n$f&&0===n$f._repaint&&(n$f._repaint=1,n$f.parentRepaint())}else this.scaleX=n$a,this.scaleY=n$b}return this},n$a.skew=function(n$a,n$b){return this.skewX=n$a,this.skewY=n$b,this},n$a.render=function(n$a,n$b,n$c){n$X.spriteCount++,n$L.renders[this._renderType]._fun(this,n$a,n$b+this._x,n$c+this._y),this._repaint=0},n$a.drawToCanvas=function(n$a,n$b,n$c,n$d){if(n$J.isConchNode){var n$e=n$ta.create("2D");return new n$K(n$a,n$b,n$e).ctx.setCanvasType(1),this.conchModel.drawToCanvas(n$e.source,n$c,n$d),n$e}return n$F.drawToCanvas(this,this._renderType,n$a,n$b,n$c,n$d)},n$a.customRender=function(n$a,n$b,n$c){this._renderType|=1024},n$a._applyFilters=function(){var n$a;if(!n$J.isWebGL&&((n$a=this._$P.filters)&&!(n$a.length<1)))for(var n$b=0,n$c=n$a.length;n$b<n$c;n$b++)n$a[n$b].action.apply(this._$P.cacheCanvas)},n$a._isHaveGlowFilter=function(){var n$a,n$b=0;if(this.filters)for(n$b=0;n$b<this.filters.length;n$b++)if(8==this.filters[n$b].type)return!0;for(n$b=0,n$a=this._childs.length;n$b<n$a;n$b++)if(this._childs[n$b]._isHaveGlowFilter())return!0;return!1},n$a.localToGlobal=function(n$a,n$b){void 0===n$b&&(n$b=!1),!0===n$b&&(n$a=new n$y(n$a.x,n$a.y));for(var n$c=this;n$c&&n$c!=n$x.stage;)n$a=n$c.toParentPoint(n$a),n$c=n$c.parent;return n$a},n$a.globalToLocal=function(n$a,n$b){void 0===n$b&&(n$b=!1),n$b&&(n$a=new n$y(n$a.x,n$a.y));for(var n$c=this,n$d=[];n$c&&n$c!=n$x.stage;)n$d.push(n$c),n$c=n$c.parent;for(var n$e=n$d.length-1;0<=n$e;)n$a=(n$c=n$d[n$e]).fromParentPoint(n$a),n$e--;return n$a},n$a.toParentPoint=function(n$a){if(!n$a)return n$a;n$a.x-=this.pivotX,n$a.y-=this.pivotY,this.transform&&this._transform.transformPoint(n$a),n$a.x+=this._x,n$a.y+=this._y;var n$b=this._style.scrollRect;return n$b&&(n$a.x-=n$b.x,n$a.y-=n$b.y),n$a},n$a.fromParentPoint=function(n$a){if(!n$a)return n$a;n$a.x-=this._x,n$a.y-=this._y;var n$b=this._style.scrollRect;return n$b&&(n$a.x+=n$b.x,n$a.y+=n$b.y),this.transform&&this._transform.invertTransformPoint(n$a),n$a.x+=this.pivotX,n$a.y+=this.pivotY,n$a},n$a.on=function(n$a,n$b,n$c,n$d){return 1!==this._mouseEnableState&&this.isMouseEvent(n$a)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(n$a,n$b,n$c,n$d,!1)):n$e.prototype.on.call(this,n$a,n$b,n$c,n$d)},n$a.once=function(n$a,n$b,n$c,n$d){return 1!==this._mouseEnableState&&this.isMouseEvent(n$a)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(n$a,n$b,n$c,n$d,!0)):n$e.prototype.once.call(this,n$a,n$b,n$c,n$d)},n$a._$2__onDisplay=function(){if(1!==this._mouseEnableState){var n$a=this;for(n$a=n$a.parent;n$a&&1!==n$a._mouseEnableState&&!n$a._getBit(2);)n$a.mouseEnabled=!0,n$a._setBit(2,!0),n$a=n$a.parent}},n$a.loadImage=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=this;return void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=0),void 0===n$e&&(n$e=0),this.graphics.loadImage(n$a,n$b,n$c,n$d,n$e,function(n$a){n$g.destroyed||(n$g.size(n$b+(n$d||n$a.width),n$c+(n$e||n$a.height)),n$g.repaint(),n$f&&n$f.runWith(n$a))}),this},n$a.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},n$a._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},n$a._childChanged=function(n$a){this._childs.length?this._renderType|=2048:this._renderType&=-2049,n$a&&this._get$P("hasZorder")&&n$x.timer.callLater(this,this.updateZOrder),this.repaint()},n$a.parentRepaint=function(){var n$a=this._parent;n$a&&0===n$a._repaint&&(n$a._repaint=1,n$a.parentRepaint())},n$a.startDrag=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){void 0===n$b&&(n$b=!1),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=300),void 0===n$f&&(n$f=!1),void 0===n$g&&(n$g=.92),this._$P.dragging||this._set$P("dragging",new n$T),this._$P.dragging.start(this,n$a,n$b,n$c,n$d,n$e,n$f,n$g)},n$a.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},n$a._releaseMem=function(){if(this._$P){var n$a=this._$P.cacheCanvas;n$a&&n$a.ctx&&(n$W.recover("RenderContext",n$a.ctx),n$a.ctx.canvas.size(0,0),n$a.ctx=null);var n$b=this._$P._filterCache;n$b&&(n$b.destroy(),n$b.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},n$a._setDisplay=function(n$a){n$a||this._releaseMem(),n$e.prototype._setDisplay.call(this,n$a)},n$a.hitTestPoint=function(n$a,n$b){var n$c=this.globalToLocal(n$y.TEMP.setTo(n$a,n$b));return n$a=n$c.x,n$b=n$c.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?n$z.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(n$a,n$b)},n$a.getMousePoint=function(){return this.globalToLocal(n$y.TEMP.setTo(n$x.stage.mouseX,n$x.stage.mouseY))},n$a._getWords=function(){return null},n$a._addChildsToLayout=function(n$a){var n$b=this._getWords();if(null==n$b&&0==this._childs.length)return!1;if(n$b)for(var n$c=0,n$d=n$b.length;n$c<n$d;n$c++)n$a.push(n$b[n$c]);n$c=0;for(var n$e=this._childs.length;n$c<n$e;++n$c){var n$f=this._childs[n$c];n$f._style._enableLayout()&&n$f._addToLayout(n$a)}return!0},n$a._addToLayout=function(n$a){this._style.absolute||(this._style.block?n$a.push(this):this._addChildsToLayout(n$a)&&(this.x=this.y=0))},n$a._isChar=function(){return!1},n$a._getCSSStyle=function(){return this._style.getCSSStyle()},n$a._setAttributes=function(n$a,n$b){switch(n$a){case"x":this.x=parseFloat(n$b);break;case"y":this.y=parseFloat(n$b);break;case"width":this.width=parseFloat(n$b);break;case"height":this.height=parseFloat(n$b);break;default:this[n$a]=n$b}},n$a._layoutLater=function(){this.parent&&this.parent._layoutLater()},n$o(0,n$a,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(n$a){this._optimizeScrollRect!=n$a&&(this._optimizeScrollRect=n$a,this.conchModel&&this.conchModel.optimizeScrollRect(n$a))}),n$o(0,n$a,"customRenderEnable",null,function(n$a){if(n$a&&(this._renderType|=1024,n$J.isConchNode)){n$c.CustomList.push(this);var n$b=new n$ta("2d");n$b._setContext(new CanvasRenderingContext2D),this.customContext=new n$K(0,0,n$b),n$b.context.setCanvasType&&n$b.context.setCanvasType(2),this.conchModel.custom(n$b.context)}}),n$o(0,n$a,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(n$a){this.cacheAs=n$a?this._$P.hasFilter?"none":"normal":"none"}),n$o(0,n$a,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(n$a){var n$b=this._$P.cacheCanvas;if(n$a!==(n$b?n$b.type:"none")){if("none"!==n$a)this._getBit(1)||this._setUpNoticeType(1),n$b||(n$b=this._set$P("cacheCanvas",n$W.getItemByClass("cacheCanvas",Object))),n$b.type=n$a,n$b.reCache=!0,this._renderType|=16,"bitmap"==n$a&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(n$b){var n$c=n$b;n$c&&n$c.ctx&&(n$W.recover("RenderContext",n$c.ctx),n$c.ctx.canvas.size(0,0),n$c.ctx=null),n$W.recover("cacheCanvas",n$b)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),n$o(0,n$a,"zOrder",function(){return this._zOrder},function(n$a){this._zOrder!=n$a&&(this._zOrder=n$a,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(n$a),this._parent&&(n$a&&this._parent._set$P("hasZorder",!0),n$x.timer.callLater(this._parent,this.updateZOrder)))}),n$o(0,n$a,"rotation",function(){return this._style._tf.rotate},function(n$a){var n$b=this.getStyle();if(n$b._tf.rotate!==n$a){n$b.setRotate(n$a),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(n$a),this._renderType|=4;var n$c=this._parent;n$c&&0===n$c._repaint&&(n$c._repaint=1,n$c.parentRepaint())}}),n$o(0,n$a,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(n$a){this._width!==n$a&&(this._width=n$a,this.conchModel&&this.conchModel.size(n$a,this._height),this.repaint())}),n$o(0,n$a,"x",function(){return this._x},function(n$a){if(this._x!==n$a){if(this.destroyed)return;this._x=n$a,this.conchModel&&this.conchModel.pos(n$a,this._y);var n$b=this._parent;n$b&&0===n$b._repaint&&(n$b._repaint=1,n$b.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),n$o(0,n$a,"globalScaleY",function(){for(var n$a=1,n$b=this;n$b&&n$b!==n$x.stage;)n$a*=n$b.scaleY,n$b=n$b.parent;return n$a}),n$o(0,n$a,"hitArea",function(){return this._$P.hitArea},function(n$a){this._set$P("hitArea",n$a)}),n$o(0,n$a,"staticCache",function(){return this._$P.staticCache},function(n$a){this._set$P("staticCache",n$a),n$a||this.reCache()}),n$o(0,n$a,"texture",function(){return this._texture},function(n$a){this._texture!=n$a&&(this._texture=n$a,this.graphics.cleanByTexture(n$a,0,0))}),n$o(0,n$a,"y",function(){return this._y},function(n$a){if(this._y!==n$a){if(this.destroyed)return;this._y=n$a,this.conchModel&&this.conchModel.pos(this._x,n$a);var n$b=this._parent;n$b&&0===n$b._repaint&&(n$b._repaint=1,n$b.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),n$o(0,n$a,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(n$a){this._height!==n$a&&(this._height=n$a,this.conchModel&&this.conchModel.size(this._width,n$a),this.repaint())}),n$o(0,n$a,"blendMode",function(){return this._style.blendMode},function(n$a){this.getStyle().blendMode=n$a,this.conchModel&&this.conchModel.blendMode(n$a),n$a&&"source-over"!=n$a?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),n$o(0,n$a,"scaleX",function(){return this._style._tf.scaleX},function(n$a){var n$b=this.getStyle();if(n$b._tf.scaleX!==n$a){n$b.setScaleX(n$a),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(n$a,n$b._tf.scaleY),this._renderType|=4;var n$c=this._parent;n$c&&0===n$c._repaint&&(n$c._repaint=1,n$c.parentRepaint())}}),n$o(0,n$a,"scaleY",function(){return this._style._tf.scaleY},function(n$a){var n$b=this.getStyle();if(n$b._tf.scaleY!==n$a){n$b.setScaleY(n$a),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(n$b._tf.scaleX,n$a),this._renderType|=4;var n$c=this._parent;n$c&&0===n$c._repaint&&(n$c._repaint=1,n$c.parentRepaint())}}),n$o(0,n$a,"stage",function(){return n$x.stage}),n$o(0,n$a,"skewX",function(){return this._style._tf.skewX},function(n$a){var n$b=this.getStyle();if(n$b._tf.skewX!==n$a){n$b.setSkewX(n$a),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(n$a,n$b._tf.skewY),this._renderType|=4;var n$c=this._parent;n$c&&0===n$c._repaint&&(n$c._repaint=1,n$c.parentRepaint())}}),n$o(0,n$a,"scrollRect",function(){return this._style.scrollRect},function(n$a){this.getStyle().scrollRect=n$a,this.repaint(),n$a?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(n$a.x,n$a.y,n$a.width,n$a.height)):(this._renderType&=-129,this.conchModel&&(n$c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),n$o(0,n$a,"skewY",function(){return this._style._tf.skewY},function(n$a){var n$b=this.getStyle();if(n$b._tf.skewY!==n$a){n$b.setSkewY(n$a),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(n$b._tf.skewX,n$a),this._renderType|=4;var n$c=this._parent;n$c&&0===n$c._repaint&&(n$c._repaint=1,n$c.parentRepaint())}}),n$o(0,n$a,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(n$a){this._tfChanged=!1,(this._transform=n$a)&&(this._x=n$a.tx,this._y=n$a.ty,n$a.tx=n$a.ty=0,this.conchModel&&this.conchModel.transform(n$a.a,n$a.b,n$a.c,n$a.d,this._x,this._y)),n$a?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),n$o(0,n$a,"pivotX",function(){return this._style._tf.translateX},function(n$a){this.getStyle().setTranslateX(n$a),this.conchModel&&this.conchModel.pivot(n$a,this._style._tf.translateY),this.repaint()}),n$o(0,n$a,"pivotY",function(){return this._style._tf.translateY},function(n$a){this.getStyle().setTranslateY(n$a),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,n$a),this.repaint()}),n$o(0,n$a,"alpha",function(){return this._style.alpha},function(n$a){this._style&&this._style.alpha!==n$a&&(n$a=n$a<0?0:1<n$a?1:n$a,this.getStyle().alpha=n$a,this.conchModel&&this.conchModel.alpha(n$a),1!==n$a?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),n$o(0,n$a,"visible",function(){return this._style.visible},function(n$a){this._style&&this._style.visible!==n$a&&(this.getStyle().visible=n$a,this.conchModel&&this.conchModel.visible(n$a),this.parentRepaint())}),n$o(0,n$a,"graphics",function(){return this._graphics||(this.graphics=n$F.createGraphics())},function(n$a){this._graphics&&(this._graphics._sp=null),(this._graphics=n$a)?(this._renderType&=-2,this._renderType|=512,(n$a._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(n$c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),n$o(0,n$a,"filters",function(){return this._$P.filters},function(n$a){n$a&&0===n$a.length&&(n$a=null),this._$P.filters!=n$a&&(this._set$P("filters",n$a?n$a.slice():null),n$J.isConchApp&&(this.conchModel&&(n$c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),n$J.isWebGL&&(n$a&&n$a.length?this._renderType|=32:this._renderType&=-33),n$a&&0<n$a.length?(this._getBit(1)||this._setUpNoticeType(1),n$J.isWebGL&&1==n$a.length&&n$a[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(n$J.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),n$o(0,n$a,"parent",n$e.prototype._$get_parent,function(n$a){n$x.superSet(n$aa,this,"parent",n$a),n$a&&this._getBit(2)&&this._$2__onDisplay()}),n$o(0,n$a,"mask",function(){return this._$P._mask},function(n$a){n$a&&this.mask&&this.mask._$P.maskParent||(n$a?(this.cacheAs="bitmap",this._set$P("_mask",n$a),n$a._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",n$a),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(n$a?n$a.conchModel:null),this._renderType|=64,this.parentRepaint())}),n$o(0,n$a,"mouseEnabled",function(){return 1<this._mouseEnableState},function(n$a){this._mouseEnableState=n$a?2:1}),n$o(0,n$a,"globalScaleX",function(){for(var n$a=1,n$b=this;n$b&&n$b!==n$x.stage;)n$a*=n$b.scaleX,n$b=n$b.parent;return n$a}),n$o(0,n$a,"mouseX",function(){return this.getMousePoint().x}),n$o(0,n$a,"mouseY",function(){return this.getMousePoint().y}),n$c.fromImage=function(n$a){return(new n$c).loadImage(n$a)},n$c._cachePool=[],n$c.CustomList=[],n$i(n$c,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=n$g.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),n$c}(n$aa),n$ma=function(n$a){function n$b(n$a){this._audio=null,this._onEnd=null,this._resumePlay=null,n$b.__super.call(this),this._onEnd=n$$.bind(this.__onEnd,this),this._resumePlay=n$$.bind(this.__resumePlay,this),n$a.addEventListener("ended",this._onEnd),this._audio=n$a}n$k(n$b,"laya.media.h5audio.AudioSoundChannel",n$da);var n$c=n$b.prototype;return n$c.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(n$x.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},n$c.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,n$O.container.appendChild(this._audio),this._audio.play()}catch(n$a){this.event("error")}},n$c.play=function(n$a){this.isStopped=!1;try{this._audio.playbackRate=n$E.playbackRate,this._audio.currentTime=this.startTime}catch(n$a){return void this._audio.addEventListener("canplay",this._resumePlay)}n$E.addChannel(this),n$O.container.appendChild(this._audio),!n$a&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},n$c.stop=function(){this.isStopped=!0,n$E.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&n$J.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),n$O.onIE||this._audio!=n$ca._musicAudio&&n$W.recover("audio:"+this.url,this._audio),n$O.removeElement(this._audio),this._audio=null)},n$c.pause=function(){this.isStopped=!0,n$E.removeChannel(this),"pause"in this._audio&&this._audio.pause()},n$c.resume=function(){this._audio&&(this.isStopped=!1,n$E.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},n$o(0,n$c,"position",function(){return this._audio?this._audio.currentTime:0}),n$o(0,n$c,"duration",function(){return this._audio?this._audio.duration:0}),n$o(0,n$c,"volume",function(){return this._audio?this._audio.volume:1},function(n$a){this._audio&&(this._audio.volume=n$a)}),n$b}(),n$na=function(n$a){function n$b(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=n$fa.ctx,n$b.__super.call(this),this._onPlayEnd=n$$.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}n$k(n$b,"laya.media.webaudio.WebAudioSoundChannel",n$da);var n$c=n$b.prototype;return n$c.play=function(n$a){if(n$E.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var n$b=this.context,n$c=this.gain,n$d=n$b.createBufferSource();(this.bufferSource=n$d).buffer=this.audioBuffer,n$d.connect(n$c),n$c&&n$c.disconnect(),n$c.connect(n$b.destination),n$d.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=n$O.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(n$d.loop=!0),n$d.playbackRate.setTargetAtTime?n$d.playbackRate.setTargetAtTime(n$E.playbackRate,this.context.currentTime,.1):n$d.playbackRate.value=n$E.playbackRate,n$d.start(0,this.startTime),!n$a&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},n$c.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(n$x.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},n$c._clearBufferSource=function(){if(this.bufferSource){var n$a=this.bufferSource;n$a.stop?n$a.stop(0):n$a.noteOff(0),n$a.disconnect(0),n$a.onended=null,n$b._tryCleanFailed||this._tryClearBuffer(n$a),this.bufferSource=null}},n$c._tryClearBuffer=function(n$a){try{n$a.buffer=null}catch(n$a){n$b._tryCleanFailed=!0}},n$c.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,n$E.removeChannel(this),this.startHandler=null,this.completeHandler=null},n$c.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,n$E.removeChannel(this)},n$c.resume=function(){this.startTime=this._pauseTime,this.play(!1)},n$o(0,n$c,"position",function(){return this.bufferSource?(n$O.now()-this._startTime)/1e3+this.startTime:0}),n$o(0,n$c,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),n$o(0,n$c,"volume",function(){return this._volume},function(n$a){this.isStopped||(this._volume=n$a,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(n$a,this.context.currentTime,.1):this.gain.gain.value=n$a)}),n$b._tryCleanFailed=!1,n$b}(),n$oa=function(n$a){function n$b(){n$b.__super.call(this),this._w=0,this._h=0}n$k(n$b,"laya.resource.Bitmap",n$ja);var n$c=n$b.prototype;return n$o(0,n$c,"width",function(){return this._w}),n$o(0,n$c,"height",function(){return this._h}),n$o(0,n$c,"source",function(){return this._source}),n$b}(),n$pa=function(n$b){function n$a(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,n$a.__super.call(this),this._interval=n$d.animationInterval,this._setUpNoticeType(1)}n$k(n$a,"laya.display.AnimationPlayerBase",n$b);var n$c=n$a.prototype;return n$c.play=function(n$a,n$b,n$c,n$d){void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=!0),void 0===n$c&&(n$c=""),void 0===n$d&&(n$d=!0),this._isPlaying=!0,this.index="string"==typeof n$a?this._getFrameByLabel(n$a):n$a,this.loop=n$b,this._actionName=n$c,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},n$c._getFrameByLabel=function(n$a){var n$b=0;for(n$b=0;n$b<this._count;n$b++)if(this._labels[n$b]&&0<=this._labels[n$b].indexOf(n$a))return n$b;return 0},n$c._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},n$c._setControlNode=function(n$a){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=n$a)&&n$a!=this&&(n$a.on("display",this,this._checkResumePlaying),n$a.on("undisplay",this,this._checkResumePlaying))},n$c._setDisplay=function(n$a){n$b.prototype._setDisplay.call(this,n$a),this._checkResumePlaying()},n$c._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},n$c.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},n$c.addLabel=function(n$a,n$b){this._labels||(this._labels={}),this._labels[n$b]||(this._labels[n$b]=[]),this._labels[n$b].push(n$a)},n$c.removeLabel=function(n$a){if(n$a){if(this._labels)for(var n$b in this._labels)this._removeLabelFromLabelList(this._labels[n$b],n$a)}else this._labels=null},n$c._removeLabelFromLabelList=function(n$a,n$b){if(n$a)for(var n$c=n$a.length-1;0<=n$c;n$c--)n$a[n$c]==n$b&&n$a.splice(n$c,1)},n$c.gotoAndStop=function(n$a){this.index="string"==typeof n$a?this._getFrameByLabel(n$a):n$a,this.stop()},n$c._displayToIndex=function(n$a){},n$c.clear=function(){this.stop(),this._labels=null},n$o(0,n$c,"interval",function(){return this._interval},function(n$a){this._interval!=n$a&&(this._frameRateChanged=!0,this._interval=n$a,this._isPlaying&&0<n$a&&this.timerLoop(n$a,this,this._frameLoop,null,!0,!0))}),n$o(0,n$c,"isPlaying",function(){return this._isPlaying}),n$o(0,n$c,"index",function(){return this._index},function(n$a){if(this._index=n$a,this._displayToIndex(n$a),this._labels&&this._labels[n$a])for(var n$b=this._labels[n$a],n$c=0,n$d=n$b.length;n$c<n$d;n$c++)this.event("label",n$b[n$c])}),n$o(0,n$c,"count",function(){return this._count}),n$a.WRAP_POSITIVE=0,n$a.WRAP_REVERSE=1,n$a.WRAP_PINGPONG=2,n$a}(n$la),n$qa=function(n$b){function n$n(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,n$n.__super.call(this),this.overflow=n$n.VISIBLE,this._style=new n$ba(this),this._style.wordWrap=!1}n$k(n$n,"laya.display.Text",n$b);var n$a=n$n.prototype;return n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,n$a),this._lines=null,this._words&&(this._words.length=0,this._words=null)},n$a._getBoundPointsM=function(n$a){void 0===n$a&&(n$a=!1);var n$b=n$z.TEMP;return n$b.setTo(0,0,this.width,this.height),n$b._getBoundPoints()},n$a.getGraphicBounds=function(n$a){void 0===n$a&&(n$a=!1);var n$b=n$z.TEMP;return n$b.setTo(0,0,this.width,this.height),n$b},n$a._getCSSStyle=function(){return this._style},n$a.lang=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k){if(n$a=n$n.langPacks&&n$n.langPacks[n$a]?n$n.langPacks[n$a]:n$a,arguments.length<2)this._text=n$a;else{for(var n$l=0,n$m=arguments.length;n$l<n$m;n$l++)n$a=n$a.replace("{"+n$l+"}",arguments[n$l+1]);this._text=n$a}},n$a._isPassWordMode=function(){var n$a=this._style.password;return"prompt"in this&&this.prompt==this._text&&(n$a=!1),n$a},n$a._getPassWordTxt=function(n$a){var n$b;n$b="";for(var n$c=n$a.length;0<n$c;n$c--)n$b+="●";return n$b},n$a.renderText=function(n$a,n$b){var n$c=this.graphics;n$c.clear(!0);var n$d=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(n$O.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);n$O.context.font=n$d;var n$e=this.padding,n$f=n$e[3],n$g="left",n$h=this._lines,n$i=this.leading+this._charSize.height,n$j=this._currBitmapFont;n$j&&(n$i=this.leading+n$j.getMaxHeight());var n$k=n$e[0];if(!n$j&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(n$g="right",n$f=this._width-n$e[1]):"center"==this.align&&(n$g="center",n$f=.5*this._width+n$e[3]-n$e[1])),0<this._height){var n$l=this._textHeight>this._height?"top":this.valign;"middle"===n$l?n$k=.5*(this._height-n$b*n$i)+n$e[0]-n$e[2]:"bottom"===n$l&&(n$k=this._height-n$b*n$i-n$e[2])}var n$m=this._style;if(n$j&&n$j.autoScaleSize)var n$n=n$j.fontSize/this.fontSize;if(this._clipPoint)if(n$c.save(),n$j&&n$j.autoScaleSize){var n$o=0,n$p=0;n$o=this._width?this._width-n$e[3]-n$e[1]:this._textWidth,n$p=this._height?this._height-n$e[0]-n$e[2]:this._textHeight,n$o*=n$n,n$p*=n$n,n$c.clipRect(n$e[3],n$e[0],n$o,n$p)}else n$c.clipRect(n$e[3],n$e[0],this._width?this._width-n$e[3]-n$e[1]:this._textWidth,this._height?this._height-n$e[0]-n$e[2]:this._textHeight);var n$q=n$m.password;"prompt"in this&&this.prompt==this._text&&(n$q=!1);for(var n$r=0,n$s=0,n$t=Math.min(this._lines.length,n$b+n$a)||1,n$u=n$a;n$u<n$t;n$u++){var n$v,n$w=n$h[n$u];if(n$q){var n$x=n$w.length;n$w="";for(var n$y=n$x;0<n$y;n$y--)n$w+="●"}if(n$r=n$f-(this._clipPoint?this._clipPoint.x:0),n$s=n$k+n$i*n$u-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(n$g,n$r,n$s,n$u),n$j){var n$z=this.width;n$j.autoScaleSize&&(n$z=this.width*n$n),n$j.drawText(n$w,this,n$r,n$s,this.align,n$z)}else n$J.isWebGL?(this._words||(this._words=[]),(n$v=this._words.length>n$u-n$a?this._words[n$u-n$a]:new n$B).setText(n$w)):n$v=n$w,n$m.stroke?n$c.fillBorderText(n$v,n$r,n$s,n$d,this.color,n$m.strokeColor,n$m.stroke,n$g):n$c.fillText(n$v,n$r,n$s,n$d,this.color,n$g)}if(n$j&&n$j.autoScaleSize){var n$C=1/n$n;this.scale(n$C,n$C)}this._clipPoint&&n$c.restore(),this._startX=n$f,this._startY=n$k},n$a.drawUnderline=function(n$a,n$b,n$c,n$d){var n$e=this._lineWidths[n$d];switch(n$a){case"center":n$b-=n$e/2;break;case"right":n$b-=n$e}n$c+=this._charSize.height,this._graphics.drawLine(n$b,n$c,n$b+n$e,n$c,this.underlineColor||this.color,1)},n$a.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);n$O.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new n$y(0,0)):this._clipPoint=null;var n$a=this._lines.length;if(this.overflow!=n$n.VISIBLE){var n$b=this.overflow==n$n.HIDDEN?Math.floor:Math.ceil;n$a=Math.min(n$a,n$b((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var n$c=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(n$c,n$a),this.repaint()},n$a.evalTextSize=function(){var n$a,n$b=NaN;n$a=Math.max.apply(this,this._lineWidths),n$b=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],n$a==this._textWidth&&n$b==this._textHeight||(this._textWidth=n$a,this._textHeight=n$b,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},n$a.checkEnabledViewportOrNot=function(){return this.overflow==n$n.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},n$a.changeText=function(n$a){this._text!==n$a&&(this.lang(n$a+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},n$a.parseLines=function(n$a){var n$b=this.wordWrap||this.overflow==n$n.HIDDEN;if(n$b)var n$c=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var n$d=n$O.context.measureText(n$n._testWord);n$J.isConchApp&&0===n$d.width&&0===n$d.height&&(n$d=n$O.context.measureText("W")),this._charSize.width=n$d.width,this._charSize.height=n$d.height||this.fontSize}for(var n$e=n$a.replace(/\r\n/g,"\n").split("\n"),n$f=0,n$g=n$e.length;n$f<n$g;n$f++){var n$h=n$e[n$f];n$b?this.parseLine(n$h,n$c):(this._lineWidths.push(this.getTextWidth(n$h)),this._lines.push(n$h))}},n$a.parseLine=function(n$a,n$b){n$O.context;var n$c,n$d=this._lines,n$e=0,n$f=NaN,n$g=NaN,n$h=0;if((n$f=this.getTextWidth(n$a))<=n$b)return n$d.push(n$a),void this._lineWidths.push(n$f);n$f=this._charSize.width,0==(n$e=Math.floor(n$b/n$f))&&(n$e=1),n$g=n$f=this.getTextWidth(n$a.substring(0,n$e));for(var n$i=n$e,n$j=n$a.length;n$i<n$j;n$i++)if(n$b<(n$g+=n$f=this.getTextWidth(n$a.charAt(n$i))))if(this.wordWrap){var n$k=n$a.substring(n$h,n$i);if(n$k.charCodeAt(n$k.length-1)<255?(n$c=/(?:\w|-)+$/.exec(n$k))&&(n$i=n$c.index+n$h,0==n$c.index?n$i+=n$k.length:n$k=n$a.substring(n$h,n$i)):n$n.RightToLeft&&(n$c=/([\u0600-\u06FF])+$/.exec(n$k))&&(n$i=n$c.index+n$h,0==n$c.index?n$i+=n$k.length:n$k=n$a.substring(n$h,n$i)),n$d.push(n$k),this._lineWidths.push(n$g-n$f),!((n$h=n$i)+n$e<n$j)){n$d.push(n$a.substring(n$h,n$j)),this._lineWidths.push(this.getTextWidth(n$d[n$d.length-1])),n$h=-1;break}n$i+=n$e,n$g=n$f=this.getTextWidth(n$a.substring(n$h,n$i)),n$i--}else if(this.overflow==n$n.HIDDEN)return n$d.push(n$a.substring(0,n$i)),void this._lineWidths.push(this.getTextWidth(n$d[n$d.length-1]));this.wordWrap&&-1!=n$h&&(n$d.push(n$a.substring(n$h,n$j)),this._lineWidths.push(this.getTextWidth(n$d[n$d.length-1])))},n$a.getTextWidth=function(n$a){return this._currBitmapFont?this._currBitmapFont.getTextWidth(n$a):n$O.context.measureText(n$a).width},n$a.getWordWrapWidth=function(){var n$a=this.padding,n$b=NaN;return(n$b=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(n$b=this.wordWrap?100:n$O.width),n$b<=0&&(n$b=100),n$b-n$a[3]-n$a[1]},n$a.getCharPoint=function(n$a,n$b){this._isChanged&&n$x.timer.runCallLater(this,this.typeset);for(var n$c=0,n$d=this._lines,n$e=0,n$f=0,n$g=n$d.length;n$f<n$g;n$f++){if(n$a<(n$c+=n$d[n$f].length)){var n$h=n$f;break}n$e=n$c}var n$i=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;n$O.context.font=n$i;var n$j=this.getTextWidth(this._text.substring(n$e,n$a));return(n$b||new n$y).setTo(this._startX+n$j-(this._clipPoint?this._clipPoint.x:0),this._startY+n$h*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},n$o(0,n$a,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(n$a){n$a!=this._width&&(n$x.superSet(n$la,this,"width",n$a),this.isChanged=!0)}),n$o(0,n$a,"textWidth",function(){return this._isChanged&&n$x.timer.runCallLater(this,this.typeset),this._textWidth}),n$o(0,n$a,"height",function(){return this._height?this._height:this.textHeight},function(n$a){n$a!=this._height&&(n$x.superSet(n$la,this,"height",n$a),this.isChanged=!0)}),n$o(0,n$a,"textHeight",function(){return this._isChanged&&n$x.timer.runCallLater(this,this.typeset),this._textHeight}),n$o(0,n$a,"padding",function(){return this._getCSSStyle().padding},function(n$a){this._getCSSStyle().padding=n$a,this.isChanged=!0}),n$o(0,n$a,"bold",function(){return this._getCSSStyle().bold},function(n$a){this._getCSSStyle().bold=n$a,this.isChanged=!0}),n$o(0,n$a,"text",function(){return this._text||""},function(n$a){this._text!==n$a&&(this.lang(n$a+""),this.isChanged=!0,this.event("change"))}),n$o(0,n$a,"color",function(){return this._getCSSStyle().color},function(n$a){this._getCSSStyle().color!=n$a&&(this._getCSSStyle().color=n$a,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),n$o(0,n$a,"font",function(){return this._getCSSStyle().fontFamily},function(n$a){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),n$n._bitmapFonts&&n$n._bitmapFonts[n$a]&&(this._currBitmapFont=n$n._bitmapFonts[n$a]),this._getCSSStyle().fontFamily=n$a,this.isChanged=!0}),n$o(0,n$a,"fontSize",function(){return this._getCSSStyle().fontSize},function(n$a){this._getCSSStyle().fontSize=n$a,this.isChanged=!0}),n$o(0,n$a,"italic",function(){return this._getCSSStyle().italic},function(n$a){this._getCSSStyle().italic=n$a,this.isChanged=!0}),n$o(0,n$a,"align",function(){return this._getCSSStyle().align},function(n$a){this._getCSSStyle().align=n$a,this.isChanged=!0}),n$o(0,n$a,"valign",function(){return this._getCSSStyle().valign},function(n$a){this._getCSSStyle().valign=n$a,this.isChanged=!0}),n$o(0,n$a,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(n$a){this._getCSSStyle().wordWrap=n$a,this.isChanged=!0}),n$o(0,n$a,"leading",function(){return this._getCSSStyle().leading},function(n$a){this._getCSSStyle().leading=n$a,this.isChanged=!0}),n$o(0,n$a,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(n$a){this._getCSSStyle().backgroundColor=n$a,this.isChanged=!0}),n$o(0,n$a,"borderColor",function(){return this._getCSSStyle().borderColor},function(n$a){this._getCSSStyle().borderColor=n$a,this.isChanged=!0}),n$o(0,n$a,"stroke",function(){return this._getCSSStyle().stroke},function(n$a){this._getCSSStyle().stroke=n$a,this.isChanged=!0}),n$o(0,n$a,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(n$a){this._getCSSStyle().strokeColor=n$a,this.isChanged=!0}),n$o(0,n$a,"isChanged",null,function(n$a){this._isChanged!==n$a&&(this._isChanged=n$a)&&n$x.timer.callLater(this,this.typeset)}),n$o(0,n$a,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(n$a){if(!(this.overflow!=n$n.SCROLL||this.textWidth<this._width)&&this._clipPoint){n$a=n$a<this.padding[3]?this.padding[3]:n$a;var n$b=this._textWidth-this._width;n$a=n$b<n$a?n$b:n$a;var n$c=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=n$a,this.renderText(this._lastVisibleLineIndex,n$c)}}),n$o(0,n$a,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(n$a){if(!(this.overflow!=n$n.SCROLL||this.textHeight<this._height)&&this._clipPoint){n$a=n$a<this.padding[0]?this.padding[0]:n$a;var n$b=this._textHeight-this._height,n$c=(n$a=n$b<n$a?n$b:n$a)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=n$c;var n$d=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=n$a,this.renderText(n$c,n$d)}}),n$o(0,n$a,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),n$o(0,n$a,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),n$o(0,n$a,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),n$o(0,n$a,"underlineColor",function(){return this._underlineColor},function(n$a){this._underlineColor=n$a,this._isChanged=!0,this.typeset()}),n$n.registerBitmapFont=function(n$a,n$b){n$n._bitmapFonts||(n$n._bitmapFonts={}),n$n._bitmapFonts[n$a]=n$b},n$n.unregisterBitmapFont=function(n$a,n$b){if(void 0===n$b&&(n$b=!0),n$n._bitmapFonts&&n$n._bitmapFonts[n$a]){var n$c=n$n._bitmapFonts[n$a];n$b&&n$c.destroy(),delete n$n._bitmapFonts[n$a]}},n$n.setTextRightToLeft=function(){var n$a;(n$a=n$O.canvas.source.style).display="none",n$a.position="absolute",n$a.direction="rtl",n$J._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,n$O.document.body.appendChild(n$O.canvas.source)},n$n.supportFont=function(n$a){n$O.context.font="10px sans-serif";var n$b=n$O.context.measureText("abcji").width;n$O.context.font="10px "+n$a;var n$c=n$O.context.measureText("abcji").width;return console.log(n$b,n$c),n$b!==n$c},n$n._testWord="游",n$n.langPacks=null,n$n.VISIBLE="visible",n$n.SCROLL="scroll",n$n.HIDDEN="hidden",n$n.CharacterCache=!0,n$n.RightToLeft=!1,n$n._bitmapFonts=null,n$i(n$n,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),n$n}(n$la),n$ra=function(n$l){function n$g(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",n$g.__super.call(this),this.offset=new n$y,this._canvasTransform=new n$G,this._previousOrientation=n$O.window.orientation;var n$b=this;this.transform=n$G.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var n$a=n$O.window,n$c=this;n$a.addEventListener("focus",function(){n$b._isFocused=!0,n$c.event("focus"),n$c.event("focuschange")}),n$a.addEventListener("blur",function(){n$b._isFocused=!1,n$c.event("blur"),n$c.event("focuschange"),n$c._isInputting()&&(n$va.inputElement.target.focus=!1)});var n$d="visibilityState",n$e="visibilitychange",n$f=n$a.document;void 0!==n$f.hidden?(n$e="visibilitychange",n$d="visibilityState"):void 0!==n$f.mozHidden?(n$e="mozvisibilitychange",n$d="mozVisibilityState"):void 0!==n$f.msHidden?(n$e="msvisibilitychange",n$d="msVisibilityState"):void 0!==n$f.webkitHidden&&(n$e="webkitvisibilitychange",n$d="webkitVisibilityState"),n$a.document.addEventListener(n$e,function(){"hidden"==n$O.document[n$d]?n$c._setStageVisible(!1):n$c._setStageVisible(!0)}),n$a.document.addEventListener("qbrowserVisibilityChange",function(n$a){n$c._setStageVisible(!n$a.hidden)}),n$a.addEventListener("resize",function(){var n$a=n$O.window.orientation;null!=n$a&&n$a!=n$b._previousOrientation&&n$c._isInputting()&&(n$va.inputElement.target.focus=!1),n$b._previousOrientation=n$a,n$c._isInputting()||n$c._resetCanvas()}),n$a.addEventListener("orientationchange",function(n$a){n$c._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),n$O.onMobile&&this.on("mousedown",this,this._onmouseMove)}n$k(n$g,"laya.display.Stage",n$l);var n$a=n$g.prototype;return n$a._setStageVisible=function(n$a){this._isVisibility!=n$a&&(this._isVisibility=n$a,this._isVisibility||this._isInputting()&&(n$va.inputElement.target.focus=!1),this.event("visibilitychange"))},n$a._isInputting=function(){return n$O.onMobile&&n$va.isInputting},n$a._changeCanvasSize=function(){this.setScreenSize(n$O.clientWidth*n$O.pixelRatio,n$O.clientHeight*n$O.pixelRatio)},n$a._resetCanvas=function(){if(this.screenAdaptationEnabled){var n$a=n$J._mainCanvas;n$a.source.style;n$a.size(1,1),n$x.timer.once(100,this,this._changeCanvasSize)}},n$a.setScreenSize=function(n$a,n$b){var n$c=!1;if("none"!==this._screenMode&&(n$c=(n$a/n$b<1?"vertical":"horizontal")!==this._screenMode)){var n$d=n$b;n$b=n$a,n$a=n$d}this.canvasRotation=n$c;var n$e=n$J._mainCanvas,n$f=n$e.source.style,n$g=this._canvasTransform.identity(),n$h=this._scaleMode,n$i=n$a/this.designWidth,n$j=n$b/this.designHeight,n$k=this.designWidth,n$l=this.designHeight,n$m=n$a,n$n=n$b,n$o=n$O.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,n$h){case"noscale":n$i=n$j=1,n$m=this.designWidth,n$n=this.designHeight;break;case"showall":n$i=n$j=Math.min(n$i,n$j),n$k=n$m=Math.round(this.designWidth*n$i),n$l=n$n=Math.round(this.designHeight*n$j);break;case"noborder":n$i=n$j=Math.max(n$i,n$j),n$m=Math.round(this.designWidth*n$i),n$n=Math.round(this.designHeight*n$j);break;case"full":n$i=n$j=1,this._width=n$k=n$a,this._height=n$l=n$b;break;case"fixedwidth":n$j=n$i,this._height=n$l=Math.round(n$b/n$i);break;case"fixedheight":n$i=n$j,this._width=n$k=Math.round(n$a/n$j);break;case"fixedauto":n$a/n$b<this.designWidth/this.designHeight?(n$j=n$i,this._height=n$l=Math.round(n$b/n$i)):(n$i=n$j,this._width=n$k=Math.round(n$a/n$j))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,n$k=n$k+1&2147483646,n$l=n$l+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),n$i*=this.scaleX,n$j*=this.scaleY,1===n$i&&1===n$j?this.transform.identity():(this.transform.a=this._formatData(n$i/(n$m/n$k)),this.transform.d=this._formatData(n$j/(n$n/n$l)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),n$e.size(n$k,n$l),n$F.changeWebGLSize(n$k,n$l),n$g.scale(n$m/n$k/n$o,n$n/n$l/n$o),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(n$a-n$m)/n$o:this.offset.x=.5*(n$a-n$m)/n$o,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(n$b-n$n)/n$o:this.offset.y=.5*(n$b-n$n)/n$o,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),n$g.translate(this.offset.x,this.offset.y),this.canvasDegree=0,n$c&&("horizontal"===this._screenMode?(n$g.rotate(Math.PI/2),n$g.translate(n$b/n$o,0),this.canvasDegree=90):(n$g.rotate(-Math.PI/2),n$g.translate(0,n$a/n$o),this.canvasDegree=-90)),n$g.a=this._formatData(n$g.a),n$g.d=this._formatData(n$g.d),n$g.tx=this._formatData(n$g.tx),n$g.ty=this._formatData(n$g.ty),n$f.transformOrigin=n$f.webkitTransformOrigin=n$f.msTransformOrigin=n$f.mozTransformOrigin=n$f.oTransformOrigin="0px 0px 0px",n$f.transform=n$f.webkitTransform=n$f.msTransform=n$f.mozTransform=n$f.oTransform="matrix("+n$g.toString()+")",n$g.translate(parseInt(n$f.left)||0,parseInt(n$f.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},n$a._formatData=function(n$a){return Math.abs(n$a)<1e-6?0:Math.abs(1-n$a)<.001?0<n$a?1:-1:n$a},n$a.getMousePoint=function(){return n$y.TEMP.setTo(this.mouseX,this.mouseY)},n$a.repaint=function(){this._repaint=1},n$a.parentRepaint=function(){},n$a._loop=function(){return this.render(n$J.context,0,0),!0},n$a._onmouseMove=function(n$a){this._mouseMoveTime=n$O.now()},n$a.getTimeFromFrameStart=function(){return n$O.now()-this._frameStartTime},n$a.render=function(n$a,n$b,n$c){if("sleep"===this._frameRate&&!n$J.isConchApp){var n$d=n$O.now();if(!(1e3<=n$d-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(n$X.loopCount++,n$p.instance.runEvent(),n$x.timer._update()));this._frameStartTime=n$d}if(this._renderCount++,n$J.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=n$O.now();var n$e="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),n$f=this._renderCount%2==0;if(n$X.renderSlow=!n$e,n$e||n$f||n$J.isConchApp){var n$g;n$X.loopCount++,n$p.instance.runEvent(),n$x.timer._update(),n$F.update3DLoop();var n$h=0,n$i=0;if(n$J.isConchNode)for(n$h=0,n$i=this._scenes.length;n$h<n$i;n$h++)(n$g=this._scenes[n$h])&&n$g._updateSceneConch();else for(n$h=0,n$i=this._scenes.length;n$h<n$i;n$h++)(n$g=this._scenes[n$h])&&n$g._updateScene();if(n$J.isConchNode){var n$j=n$la.CustomList;for(n$h=0,n$i=n$j.length;n$h<n$i;n$h++){var n$k=n$j[n$h];n$k.customRender(n$k.customContext,0,0)}return}}n$J.isConchNode||this.renderingEnabled&&(n$e||!n$f||n$J.isConchWebGL)&&(n$J.isWebGL?n$J.WebGL.mainContext&&!n$J.WebGL.mainContext.isContextLost()&&(n$a.clear(),n$l.prototype.render.call(this,n$a,n$b,n$c),n$X._show&&n$X._sp&&n$X._sp.render(n$a,n$b,n$c),n$F.clear(this._bgColor),n$F.beginFlush(),n$a.flush(),n$F.endFinish(),n$_.instance&&n$_.getInstance().endDispose()):(n$F.clear(this._bgColor),n$l.prototype.render.call(this,n$a,n$b,n$c),n$X._show&&n$X._sp&&n$X._sp.render(n$a,n$b,n$c)))}else this._renderCount%5==0&&(n$X.loopCount++,n$p.instance.runEvent(),n$x.timer._update())},n$a._requestFullscreen=function(){var n$a=n$O.document.documentElement;n$a.requestFullscreen?n$a.requestFullscreen():n$a.mozRequestFullScreen?n$a.mozRequestFullScreen():n$a.webkitRequestFullscreen?n$a.webkitRequestFullscreen():n$a.msRequestFullscreen&&n$a.msRequestFullscreen()},n$a._fullScreenChanged=function(){n$x.stage.event("fullscreenchange")},n$a.exitFullscreen=function(){var n$a=n$O.document;n$a.exitFullscreen?n$a.exitFullscreen():n$a.mozCancelFullScreen?n$a.mozCancelFullScreen():n$a.webkitExitFullscreen&&n$a.webkitExitFullscreen()},n$o(0,n$a,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),n$o(0,n$a,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),n$o(0,n$a,"frameRate",function(){return this._frameRate},function(n$a){if(this._frameRate=n$a,n$J.isConchApp)switch(this._frameRate){case"slow":n$O.window.conch&&n$O.window.conchConfig.setSlowFrame&&n$O.window.conchConfig.setSlowFrame(!0);break;case"fast":n$O.window.conch&&n$O.window.conchConfig.setSlowFrame&&n$O.window.conchConfig.setSlowFrame(!1);break;case"mouse":n$O.window.conch&&n$O.window.conchConfig.setMouseFrame&&n$O.window.conchConfig.setMouseFrame(2e3);break;case"sleep":n$O.window.conch&&n$O.window.conchConfig.setLimitFPS&&n$O.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),n$o(0,n$a,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),n$o(0,n$a,"width",n$l.prototype._$get_width,function(n$a){this.designWidth=n$a,n$x.superSet(n$la,this,"width",n$a),n$x.timer.callLater(this,this._changeCanvasSize)}),n$o(0,n$a,"alignH",function(){return this._alignH},function(n$a){this._alignH=n$a,n$x.timer.callLater(this,this._changeCanvasSize)}),n$o(0,n$a,"isFocused",function(){return this._isFocused}),n$o(0,n$a,"height",n$l.prototype._$get_height,function(n$a){this.designHeight=n$a,n$x.superSet(n$la,this,"height",n$a),n$x.timer.callLater(this,this._changeCanvasSize)}),n$o(0,n$a,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||n$G.create()},n$l.prototype._$set_transform),n$o(0,n$a,"isVisibility",function(){return this._isVisibility}),n$o(0,n$a,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),n$o(0,n$a,"scaleMode",function(){return this._scaleMode},function(n$a){this._scaleMode=n$a,n$x.timer.callLater(this,this._changeCanvasSize)}),n$o(0,n$a,"alignV",function(){return this._alignV},function(n$a){this._alignV=n$a,n$x.timer.callLater(this,this._changeCanvasSize)}),n$o(0,n$a,"bgColor",function(){return this._bgColor},function(n$a){this._bgColor=n$a,this.conchModel&&this.conchModel.bgColor(n$a),n$J.isWebGL&&(n$a?n$g._wgColor=n$S.create(n$a)._color:n$O.onMiniGame||(n$g._wgColor=null)),n$O.onLimixiu?n$g._wgColor=n$S.create(n$a)._color:n$J.canvas.style.background=n$a||"none"}),n$o(0,n$a,"mouseX",function(){return Math.round(n$p.instance.mouseX/this.clientScaleX)}),n$o(0,n$a,"mouseY",function(){return Math.round(n$p.instance.mouseY/this.clientScaleY)}),n$o(0,n$a,"screenMode",function(){return this._screenMode},function(n$a){this._screenMode=n$a}),n$o(0,n$a,"visible",n$l.prototype._$get_visible,function(n$a){this.visible!==n$a&&(n$x.superSet(n$la,this,"visible",n$a),n$J._mainCanvas.source.style.visibility=n$a?"visible":"hidden")}),n$o(0,n$a,"fullScreenEnabled",null,function(n$a){var n$b=n$O.document,n$c=n$J.canvas;n$a?(n$c.addEventListener("mousedown",this._requestFullscreen),n$c.addEventListener("touchstart",this._requestFullscreen),n$b.addEventListener("fullscreenchange",this._fullScreenChanged),n$b.addEventListener("mozfullscreenchange",this._fullScreenChanged),n$b.addEventListener("webkitfullscreenchange",this._fullScreenChanged),n$b.addEventListener("msfullscreenchange",this._fullScreenChanged)):(n$c.removeEventListener("mousedown",this._requestFullscreen),n$c.removeEventListener("touchstart",this._requestFullscreen),n$b.removeEventListener("fullscreenchange",this._fullScreenChanged),n$b.removeEventListener("mozfullscreenchange",this._fullScreenChanged),n$b.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),n$b.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),n$g.SCALE_NOSCALE="noscale",n$g.SCALE_EXACTFIT="exactfit",n$g.SCALE_SHOWALL="showall",n$g.SCALE_NOBORDER="noborder",n$g.SCALE_FULL="full",n$g.SCALE_FIXED_WIDTH="fixedwidth",n$g.SCALE_FIXED_HEIGHT="fixedheight",n$g.SCALE_FIXED_AUTO="fixedauto",n$g.ALIGN_LEFT="left",n$g.ALIGN_RIGHT="right",n$g.ALIGN_CENTER="center",n$g.ALIGN_TOP="top",n$g.ALIGN_MIDDLE="middle",n$g.ALIGN_BOTTOM="bottom",n$g.SCREEN_NONE="none",n$g.SCREEN_HORIZONTAL="horizontal",n$g.SCREEN_VERTICAL="vertical",n$g.FRAME_FAST="fast",n$g.FRAME_SLOW="slow",n$g.FRAME_MOUSE="mouse",n$g.FRAME_SLEEP="sleep",n$g.FRAME_MOUSE_THREDHOLD=2e3,n$i(n$g,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),n$g}(n$la),n$sa=(function(n$a){function n$b(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,n$b.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}n$k(n$b,"laya.media.SoundNode",n$la);var n$c=n$b.prototype;n$c._onParentChange=function(){this.target=this.parent},n$c.play=function(n$a,n$b){void 0===n$a&&(n$a=1),isNaN(n$a)&&(n$a=1),this.url&&(this.stop(),this._channel=n$E.playSound(this.url,n$a,null,n$b))},n$c.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},n$c._setPlayAction=function(n$a,n$b,n$c,n$d){void 0===n$d&&(n$d=!0),this[n$c]&&n$a&&(n$d?n$a.on(n$b,this,this[n$c]):n$a.off(n$b,this,this[n$c]))},n$c._setPlayActions=function(n$a,n$b,n$c,n$d){if(void 0===n$d&&(n$d=!0),n$a&&n$b){var n$e,n$f=n$b.split(","),n$g=0;for(n$e=n$f.length,n$g=0;n$g<n$e;n$g++)this._setPlayAction(n$a,n$f[n$g],n$c,n$d)}},n$o(0,n$c,"playEvent",null,function(n$a){(this._playEvents=n$a)&&this._tar&&this._setPlayActions(this._tar,n$a,"play")}),n$o(0,n$c,"target",null,function(n$a){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=n$a,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),n$o(0,n$c,"stopEvent",null,function(n$a){(this._stopEvents=n$a)&&this._tar&&this._setPlayActions(this._tar,n$a,"stop")})}(),function(n$a){function n$b(){this._src=null,this._onload=null,this._onerror=null,n$b.__super.call(this)}n$k(n$b,"laya.resource.FileBitmap",n$oa);var n$c=n$b.prototype;return n$o(0,n$c,"src",function(){return this._src},function(n$a){this._src=n$a}),n$o(0,n$c,"onload",null,function(n$a){}),n$o(0,n$c,"onerror",null,function(n$a){}),n$b}()),n$ta=function(n$a){function n$c(n$a,n$b){this._is2D=!1,n$c.__super.call(this);var n$d=this;if(this._source=this,"2D"===n$a||"AUTO"===n$a&&!n$J.isWebGL){this._is2D=!0,this._source=n$b||n$O.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var n$e=this;n$e.getContext=function(n$a,n$b){if(n$d._ctx)return n$d._ctx;var n$c=n$d._ctx=n$d._source.getContext(n$a,n$b);return n$c&&(n$c._canvas=n$e,n$J.isFlash||n$O.onLimixiu||(n$c.size=function(n$a,n$b){})),n$c}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}n$k(n$c,"laya.resource.HTMLCanvas",n$oa);var n$b=n$c.prototype;return n$b.clear=function(){this._ctx&&this._ctx.clear()},n$b.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},n$b.release=function(){},n$b._setContext=function(n$a){this._ctx=n$a},n$b.getContext=function(n$a,n$b){return this._ctx?this._ctx:this._ctx=n$c._createContext(this)},n$b.getMemSize=function(){return 0},n$b.size=function(n$a,n$b){(this._w!=n$a||this._h!=n$b||this._source&&(this._source.width!=n$a||this._source.height!=n$b))&&(this._w=n$a,this._h=n$b,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(n$a,n$b),this._source&&(this._source.height=n$b,this._source.width=n$a))},n$b.getCanvas=function(){return this._source},n$b.toBase64=function(n$a,n$b,n$c){if(this._source)if(n$J.isConchApp&&this._source.toBase64)this._source.toBase64(n$a,n$b,n$c);else{var n$d=this._source.toDataURL(n$a,n$b);n$c.call(this,n$d)}},n$o(0,n$b,"context",function(){return this._ctx}),n$o(0,n$b,"asBitmap",null,function(n$a){}),n$c.create=function(n$a,n$b){return new n$c(n$a,n$b)},n$c.TYPE2D="2D",n$c.TYPE3D="3D",n$c.TYPEAUTO="AUTO",n$c._createContext=null,n$c}(),n$ua=(function(n$a){function n$i(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){throw n$i.__super.call(this),new Error("不允许new！")}n$k(n$i,"laya.resource.HTMLSubImage",n$oa),n$i.create=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){return void 0===n$h&&(n$h=!1),new n$i(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h)}}(),function(n$a){function n$l(){this._frames=null,this._url=null,n$l.__super.call(this),this._setControlNode(this)}n$k(n$l,"laya.display.Animation",n$a);var n$b=n$l.prototype;n$b.destroy=function(n$a){void 0===n$a&&(n$a=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,n$a),this._frames=null,this._labels=null},n$b.play=function(n$a,n$b,n$c,n$d){void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=!0),void 0===n$c&&(n$c=""),void 0===n$d&&(n$d=!0),n$c&&this._setFramesFromCache(n$c,n$d),this._isPlaying=!0,this.index="string"==typeof n$a?this._getFrameByLabel(n$a):n$a,this.loop=n$b,this._actionName=n$c,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},n$b._setFramesFromCache=function(n$a,n$b){var n$c;return void 0===n$b&&(n$b=!1),this._url&&(n$a=this._url+"#"+n$a),n$a&&n$l.framesMap[n$a]?((n$c=n$l.framesMap[n$a])instanceof Array?(this._frames=n$l.framesMap[n$a],this._count=this._frames.length):(n$c.nodeRoot&&(n$l.framesMap[n$a]=this._parseGraphicAnimationByData(n$c),n$c=n$l.framesMap[n$a]),this._frames=n$c.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=n$c.interval),this._labels=this._copyLabels(n$c.labels)),!0):(n$b&&console.log("ani not found:",n$a),!1)},n$b._copyLabels=function(n$a){if(!n$a)return null;var n$b,n$c;for(n$c in n$b={},n$a)n$b[n$c]=n$$.copyArray([],n$a[n$c]);return n$b},n$b._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&n$a.prototype._frameLoop.call(this)},n$b._displayToIndex=function(n$a){this._frames&&(this.graphics=this._frames[n$a])},n$b.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},n$b.loadImages=function(n$a,n$b){return void 0===n$b&&(n$b=""),this._url="",this._setFramesFromCache(n$b)||(this.frames=n$l.framesMap[n$b]?n$l.framesMap[n$b]:n$l.createFrames(n$a,n$b)),this},n$b.loadAtlas=function(n$b,n$c,n$d){void 0===n$d&&(n$d=""),this._url="";var n$e=this;function n$a(n$a){n$b===n$a&&(n$e.frames=n$l.framesMap[n$d]?n$l.framesMap[n$d]:n$l.createFrames(n$b,n$d),n$c&&n$c.run())}return n$e._setFramesFromCache(n$d)||(n$ha.getAtlas(n$b)?n$a(n$b):n$x.loader.load(n$b,n$s.create(null,n$a,[n$b]),null,"atlas")),this},n$b.loadAnimation=function(n$a,n$b,n$c){this._url=n$a;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,n$b&&n$b.run()):!n$c||n$ha.getAtlas(n$c)?this._loadAnimationData(n$a,n$b,n$c):n$x.loader.load(n$c,n$s.create(this,this._loadAnimationData,[n$a,n$b,n$c]),null,"atlas"),this},n$b._loadAnimationData=function(n$h,n$i,n$a){var n$j=this;if(!n$a||n$ha.getAtlas(n$a)){var n$k=this;n$ha.getRes(n$h)?n$b(n$h):n$x.loader.load(n$h,n$s.create(null,n$b,[n$h]),null,"json"),n$ha.clearRes(n$h)}else console.warn("atlas load fail:"+n$a);function n$b(n$a){if(n$ha.getRes(n$a)&&n$h===n$a){var n$b;if(n$l.framesMap[n$h+"#"])n$k._setFramesFromCache(n$j._actionName,!0),n$j.index=0,n$j._checkResumePlaying();else{var n$c=n$k._parseGraphicAnimation(n$ha.getRes(n$h));if(!n$c)return;var n$d,n$e=n$c.animationList,n$f=0,n$g=n$e.length;for(n$f=0;n$f<n$g;n$f++)n$b=n$e[n$f],n$l.framesMap[n$h+"#"+n$b.name]=n$b,n$d||(n$d=n$b);n$d&&(n$l.framesMap[n$h+"#"]=n$d,n$k._setFramesFromCache(n$j._actionName,!0),n$j.index=0),n$j._checkResumePlaying()}n$i&&n$i.run()}}},n$b._parseGraphicAnimation=function(n$a){return n$xa.parseAnimationData(n$a)},n$b._parseGraphicAnimationByData=function(n$a){return n$xa.parseAnimationByData(n$a)},n$o(0,n$b,"frames",function(){return this._frames},function(n$a){(this._frames=n$a)&&(this._count=n$a.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),n$o(0,n$b,"autoPlay",null,function(n$a){n$a?this.play():this.stop()}),n$o(0,n$b,"source",null,function(n$a){-1<n$a.indexOf(".ani")?this.loadAnimation(n$a):-1<n$a.indexOf(".json")||-1<n$a.indexOf("als")||-1<n$a.indexOf("atlas")?this.loadAtlas(n$a):this.loadImages(n$a.split(","))}),n$o(0,n$b,"autoAnimation",null,function(n$a){this.play(0,!0,n$a,!1)}),n$l.createFrames=function(n$a,n$b){var n$c,n$d,n$e=0,n$f=0;if("string"==typeof n$a){var n$g=n$ha.getAtlas(n$a);if(n$g&&n$g.length)for(n$c=[],n$e=0,n$f=n$g.length;n$e<n$f;n$e++)(n$d=new n$F.createGraphics).drawTexture(n$ha.getRes(n$g[n$e]),0,0),n$c.push(n$d)}else if(n$a instanceof Array)for(n$c=[],n$e=0,n$f=n$a.length;n$e<n$f;n$e++)(n$d=new n$F.createGraphics).loadImage(n$a[n$e],0,0),n$c.push(n$d);return n$b&&(n$l.framesMap[n$b]=n$c),n$c},n$l.clearCache=function(n$a){var n$b,n$c=n$l.framesMap,n$d=n$a+"#";for(n$b in n$c)n$b!==n$a&&0!=n$b.indexOf(n$d)||delete n$l.framesMap[n$b]},n$l.framesMap={}}(n$pa),function(n$a){function n$f(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,n$f.__super.call(this),null==n$f._sortIndexFun&&(n$f._sortIndexFun=n$w.sortByKey("index",!1,!0))}n$k(n$f,"laya.display.FrameAnimation",n$a);var n$b=n$f.prototype;return n$b._setUp=function(n$a,n$b){this._labels=null,this._animationNewFrames=null,this._targetDic=n$a,this._animationData=n$b,this.interval=1e3/n$b.frameRate,n$b.parsed?(this._count=n$b.count,this._labels=n$b.labels,this._animationNewFrames=n$b.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),n$b.parsed=!0,n$b.labels=this._labels,n$b.count=this._count,n$b.animationNewFrames=this._animationNewFrames},n$b.clear=function(){n$a.prototype.clear.call(this),this._targetDic=null,this._animationData=null},n$b._displayToIndex=function(n$a){if(this._animationData){n$a<0&&(n$a=0),n$a>this._count&&(n$a=this._count);var n$b=this._animationData.nodes,n$c=0,n$d=n$b.length;for(n$c=0;n$c<n$d;n$c++)this._displayNodeToFrame(n$b[n$c],n$a)}},n$b._displayNodeToFrame=function(n$a,n$b,n$c){n$c||(n$c=this._targetDic);var n$d=n$c[n$a.target];if(n$d){var n$e,n$f,n$g,n$h=n$a.frames,n$i=n$a.keys,n$j=0,n$k=n$i.length;for(n$j=0;n$j<n$k;n$j++)n$g=(n$f=n$h[n$e=n$i[n$j]]).length>n$b?n$f[n$b]:n$f[n$f.length-1],n$d[n$e]=n$g}},n$b._calculateDatas=function(){if(this._animationData){var n$a,n$b=this._animationData.nodes,n$c=0,n$d=n$b.length;for(n$c=this._count=0;n$c<n$d;n$c++)n$a=n$b[n$c],this._calculateNodeKeyFrames(n$a);this._count+=1}},n$b._calculateNodeKeyFrames=function(n$a){var n$b,n$c,n$d=n$a.keyframes,n$e=n$a.target;for(n$b in n$a.frames||(n$a.frames={}),n$a.keys?n$a.keys.length=0:n$a.keys=[],n$a.initValues||(n$a.initValues={}),n$d)n$c=n$d[n$b],n$a.frames[n$b]||(n$a.frames[n$b]=[]),this._targetDic&&this._targetDic[n$e]&&(n$a.initValues[n$b]=this._targetDic[n$e][n$b]),n$c.sort(n$f._sortIndexFun),n$a.keys.push(n$b),this._calculateNodePropFrames(n$c,n$a.frames[n$b],n$b,n$e)},n$b.resetToInitState=function(){if(this._targetDic&&this._animationData){var n$a,n$b,n$c=this._animationData.nodes,n$d=0,n$e=n$c.length;for(n$d=0;n$d<n$e;n$d++)if(n$b=(n$a=n$c[n$d]).initValues){var n$f,n$g=this._targetDic[n$a.target];if(n$g)for(n$f in n$b)n$g[n$f]=n$b[n$f]}}},n$b._calculateNodePropFrames=function(n$a,n$b,n$c,n$d){var n$e=0,n$f=n$a.length-1;if(0<n$f){for(n$b.length=n$a[n$f].index+1,n$e=0;n$e<n$f;n$e++)this._dealKeyFrame(n$a[n$e]),this._calculateFrameValues(n$a[n$e],n$a[n$e+1],n$b);this._dealKeyFrame(n$a[n$e])}0==n$f&&(n$b[n$a[0].index]=n$a[0].value,this._animationNewFrames&&(this._animationNewFrames[n$a[0].index]=!0))},n$b._dealKeyFrame=function(n$a){n$a.label&&""!=n$a.label&&this.addLabel(n$a.label,n$a.index)},n$b._calculateFrameValues=function(n$a,n$b,n$c){var n$d,n$e=0,n$f=n$a.index,n$g=n$b.index,n$h=n$a.value,n$i=n$b.value-n$a.value,n$j=n$g-n$f;if(n$g>this._count&&(this._count=n$g),n$a.tween)for(null==(n$d=n$U[n$a.tweenMethod])&&(n$d=n$U.linearNone),n$e=n$f;n$e<n$g;n$e++)n$c[n$e]=n$d(n$e-n$f,n$h,n$i,n$j),this._animationNewFrames&&(this._animationNewFrames[n$e]=!0);else for(n$e=n$f;n$e<n$g;n$e++)n$c[n$e]=n$h;this._animationNewFrames&&(this._animationNewFrames[n$a.index]=!0,this._animationNewFrames[n$b.index]=!0),n$c[n$b.index]=n$b.value},n$f._sortIndexFun=null,n$f}(n$pa)),n$va=function(n$b){function n$e(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",n$e.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=n$qa.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}n$k(n$e,"laya.display.Input",n$b);var n$a=n$e.prototype;return n$a.setSelection=function(n$a,n$b){this.focus=!0,laya.display.Input.inputElement.selectionStart=n$a,laya.display.Input.inputElement.selectionEnd=n$b},n$a._onUnDisplay=function(n$a){this.focus=!1},n$a._onMouseDown=function(n$a){this.focus=!0},n$a._syncInputTransform=function(){var n$a=this.nativeInput,n$b=n$$.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),n$c=this._width-this.padding[1]-this.padding[3],n$d=this._height-this.padding[0]-this.padding[2];n$J.isConchApp?(n$a.setScale(n$b.scaleX,n$b.scaleY),n$a.setSize(n$c,n$d),n$a.setPos(n$b.x,n$b.y)):(n$e.inputContainer.style.transform=n$e.inputContainer.style.webkitTransform="scale("+n$b.scaleX+","+n$b.scaleY+") rotate("+n$x.stage.canvasDegree+"deg)",n$a.style.width=n$c+"px",n$a.style.height=n$d+"px",n$e.inputContainer.style.left=n$b.x+"px",n$e.inputContainer.style.top=n$b.y+"px")},n$a.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},n$a._setInputMethod=function(){n$e.input.parentElement&&n$e.inputContainer.removeChild(n$e.input),n$e.area.parentElement&&n$e.inputContainer.removeChild(n$e.area),n$e.inputElement=this._multiline?n$e.area:n$e.input,n$e.inputContainer.appendChild(n$e.inputElement),n$qa.RightToLeft&&(n$e.inputElement.style.direction="rtl")},n$a._focusIn=function(){laya.display.Input.isInputting=!0;var n$a=this.nativeInput;this._focus=!0;var n$b=n$a.style;n$b.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),n$a.readOnly=!this._editable,n$J.isConchApp&&(n$a.setType(this._type),n$a.setForbidEdit(!this._editable)),n$a.maxLength=this._maxChars;this.padding;if(n$a.type=this._type,n$a.value=this._content,n$a.placeholder=this._prompt,n$x.stage.off("keydown",this,this._onKeyDown),n$x.stage.on("keydown",this,this._onKeyDown),(n$x.stage.focus=this).event("focus"),n$O.onPC&&n$a.focus(),!n$O.onMiniGame){this._text;this._text=null}this.typeset(),n$a.setColor(this._originColor),n$a.setFontSize(this.fontSize),n$a.setFontFace(n$O.onIPhone&&n$qa._fontFamilyMap[this.font]||this.font),n$J.isConchApp&&n$a.setMultiAble&&n$a.setMultiAble(this._multiline),n$b.lineHeight=this.leading+this.fontSize+"px",n$b.fontStyle=this.italic?"italic":"normal",n$b.fontWeight=this.bold?"bold":"normal",n$b.textAlign=this.align,n$b.padding="0 0",this._syncInputTransform(),!n$J.isConchApp&&n$O.onPC&&n$x.timer.frameLoop(1,this,this._syncInputTransform)},n$a._setPromptColor=function(){(n$e.promptStyleDOM=n$O.getElementById("promptStyle"))||((n$e.promptStyleDOM=n$O.createElement("style")).setAttribute("id","promptStyle"),n$O.document.head.appendChild(n$e.promptStyleDOM)),n$e.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},n$a._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(n$x.superSet(n$qa,this,"text",this._content),n$x.superSet(n$qa,this,"color",this._originColor)):(n$x.superSet(n$qa,this,"text",this._prompt),n$x.superSet(n$qa,this,"color",this._promptColor)),n$x.stage.off("keydown",this,this._onKeyDown),n$x.stage.focus=null,this.event("blur"),n$J.isConchApp&&this.nativeInput.blur(),n$O.onPC&&n$x.timer.clear(this,this._syncInputTransform)},n$a._onKeyDown=function(n$a){13===n$a.keyCode&&(n$O.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},n$a.changeText=function(n$a){this._content=n$a,this._focus?(this.nativeInput.value=n$a||"",this.event("change")):n$b.prototype.changeText.call(this,n$a)},n$o(0,n$a,"color",n$b.prototype._$get_color,function(n$a){this._focus&&this.nativeInput.setColor(n$a),n$x.superSet(n$qa,this,"color",this._content?n$a:this._promptColor),this._originColor=n$a}),n$o(0,n$a,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(n$a){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),n$o(0,n$a,"multiline",function(){return this._multiline},function(n$a){this._multiline=n$a,this.valign=n$a?"top":"middle"}),n$o(0,n$a,"maxChars",function(){return this._maxChars},function(n$a){n$a<=0&&(n$a=1e5),this._maxChars=n$a}),n$o(0,n$a,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(n$a){n$x.superSet(n$qa,this,"color",this._originColor),n$a+="",this._focus?(this.nativeInput.value=n$a||"",this.event("change")):(this._multiline||(n$a=n$a.replace(/\r?\n/g,"")),(this._content=n$a)?n$x.superSet(n$qa,this,"text",n$a):(n$x.superSet(n$qa,this,"text",this._prompt),n$x.superSet(n$qa,this,"color",this.promptColor)))}),n$o(0,n$a,"nativeInput",function(){return this._multiline?n$e.area:n$e.input}),n$o(0,n$a,"prompt",function(){return this._prompt},function(n$a){!this._text&&n$a&&n$x.superSet(n$qa,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?n$x.superSet(n$qa,this,"text",this._text==this._prompt?n$a:this._text):n$x.superSet(n$qa,this,"text",n$a),this._prompt=n$qa.langPacks&&n$qa.langPacks[n$a]?n$qa.langPacks[n$a]:n$a}),n$o(0,n$a,"focus",function(){return this._focus},function(n$a){var n$b=this.nativeInput;this._focus!==n$a&&(n$a?(n$b.target?n$b.target._focusOut():this._setInputMethod(),(n$b.target=this)._focusIn()):(n$b.target=null,this._focusOut(),n$O.document.body.scrollTop=0,n$b.blur(),n$J.isConchApp?n$b.setPos(-1e4,-1e4):n$e.inputContainer.contains(n$b)&&n$e.inputContainer.removeChild(n$b)))}),n$o(0,n$a,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(n$a){n$a?(-1<(n$a="[^"+n$a+"]").indexOf("^^")&&(n$a=n$a.replace("^^","")),this._restrictPattern=new RegExp(n$a,"g")):this._restrictPattern=null}),n$o(0,n$a,"editable",function(){return this._editable},function(n$a){this._editable=n$a,n$J.isConchApp&&n$e.input.setForbidEdit(!n$a)}),n$o(0,n$a,"promptColor",function(){return this._promptColor},function(n$a){this._promptColor=n$a,this._content||n$x.superSet(n$qa,this,"color",n$a)}),n$o(0,n$a,"type",function(){return this._type},function(n$a){this._getCSSStyle().password="password"==n$a,this._type=n$a,n$J.isConchApp&&this.nativeInput.setType(n$a)}),n$o(0,n$a,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(n$a){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),n$o(0,n$a,"asPassword",function(){return this._getCSSStyle().password},function(n$a){this._getCSSStyle().password=n$a,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),n$e.__init__=function(){n$e._createInputElement(),n$O.onMobile&&n$J.canvas.addEventListener(n$e.IOS_IFRAME?n$O.onMiniGame?"touchend":"click":"touchend",n$e._popupInputMethod)},n$e._popupInputMethod=function(n$a){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},n$e._createInputElement=function(){n$e._initInput(n$e.area=n$O.createElement("textarea")),n$e._initInput(n$e.input=n$O.createElement("input")),(n$e.inputContainer=n$O.createElement("div")).style.position="absolute",n$e.inputContainer.style.zIndex=1e5,n$O.container.appendChild(n$e.inputContainer),n$e.inputContainer.setPos=function(n$a,n$b){n$e.inputContainer.style.left=n$a+"px",n$e.inputContainer.style.top=n$b+"px"}},n$e._initInput=function(n$b){var n$a=n$b.style;n$a.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",n$a.resize="none",n$a.backgroundColor="transparent",n$a.border="none",n$a.outline="none",n$a.zIndex=1,n$b.addEventListener("input",n$e._processInputting),n$b.addEventListener("mousemove",n$e._stopEvent),n$b.addEventListener("mousedown",n$e._stopEvent),n$b.addEventListener("touchmove",n$e._stopEvent),n$b.setFontFace=function(n$a){n$b.style.fontFamily=n$a},n$J.isConchApp||(n$b.setColor=function(n$a){n$b.style.color=n$a},n$b.setFontSize=function(n$a){n$b.style.fontSize=n$a+"px"})},n$e._processInputting=function(n$a){var n$b=laya.display.Input.inputElement.target;if(n$b){var n$c=laya.display.Input.inputElement.value;n$b._restrictPattern&&(n$c=n$c.replace(/\u2006|\x27/g,""),n$b._restrictPattern.test(n$c)&&(n$c=n$c.replace(n$b._restrictPattern,""),laya.display.Input.inputElement.value=n$c)),n$b._text=n$c,n$b.event("input")}},n$e._stopEvent=function(n$a){"touchmove"==n$a.type&&n$a.preventDefault(),n$a.stopPropagation&&n$a.stopPropagation()},n$e.TYPE_TEXT="text",n$e.TYPE_PASSWORD="password",n$e.TYPE_EMAIL="email",n$e.TYPE_URL="url",n$e.TYPE_NUMBER="number",n$e.TYPE_RANGE="range",n$e.TYPE_DATE="date",n$e.TYPE_MONTH="month",n$e.TYPE_WEEK="week",n$e.TYPE_TIME="time",n$e.TYPE_DATE_TIME="datetime",n$e.TYPE_DATE_TIME_LOCAL="datetime-local",n$e.TYPE_SEARCH="search",n$e.input=null,n$e.area=null,n$e.inputElement=null,n$e.inputContainer=null,n$e.confirmButton=null,n$e.promptStyleDOM=null,n$e.inputHeight=45,n$e.isInputting=!1,n$e.stageMatrix=null,n$i(n$e,["IOS_IFRAME",function(){return this.IOS_IFRAME=n$O.onIOS&&n$O.window.top!=n$O.window.self}]),n$e}(n$qa),n$wa=function(n$a){function n$c(n$a,n$b){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,n$c.__super.call(this),n$a&&this._init_(n$a,n$b)}n$k(n$c,"laya.resource.HTMLImage",n$sa);var n$b=n$c.prototype;return n$b._init_=function(n$a,n$b){this._src=n$a,this._source=new n$O.window.Image,n$b&&(n$b.onload&&(this.onload=n$b.onload),n$b.onerror&&(this.onerror=n$b.onerror),n$b.onCreate&&n$b.onCreate(this)),0!=n$a.indexOf("data:image")&&(this._source.crossOrigin=""),n$a&&(this._source.src=n$a)},n$b.recreateResource=function(){var n$a=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var n$b=this;this._source=new n$O.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(n$b._needReleaseAgain)return n$b._needReleaseAgain=!1,n$b._source.onload=null,void(n$b._source=null);n$b._source.onload=null,n$b.memorySize=n$a._w*n$a._h*4,n$b._recreateLock=!1,n$b.completeCreate()},this._source.src=this._src}},n$b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},n$b.onresize=function(){this._w=this._source.width,this._h=this._source.height},n$o(0,n$b,"onload",null,function(n$a){var n$b=this;this._onload=n$a,this._source&&(this._source.onload=null!=this._onload?function(){n$b.onresize(),n$b._onload()}:null)}),n$o(0,n$b,"onerror",null,function(n$a){var n$b=this;this._onerror=n$a,this._source&&(this._source.onerror=null!=this._onerror?function(){n$b._onerror()}:null)}),n$o(0,n$b,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(n$a){this._enableMerageInAtlas=n$a,n$J.isConchApp&&this._source&&(this._source.enableMerageInAtlas=n$a)}),n$c.create=function(n$a,n$b){return new n$c(n$a,n$b)},n$c}(),n$xa=(function(n$f){function n$a(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,n$a.__super.call(this)}n$k(n$a,"laya.display.EffectAnimation",n$f);var n$b=n$a.prototype;n$b._onOtherBegin=function(n$a){n$a!=this&&this.stop()},n$b.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},n$b._onPlayAction=function(){this.play(0,!1)},n$b.play=function(n$a,n$b,n$c,n$d){void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=!0),void 0===n$c&&(n$c=""),void 0===n$d&&(n$d=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,n$a,n$b,n$c,n$d))},n$b._recordInitData=function(){if(this._aniKeys){var n$a,n$b,n$c=0;for(n$a=this._aniKeys.length,n$c=0;n$c<n$a;n$c++)n$b=this._aniKeys[n$c],this._initData[n$b]=this._target[n$b]}},n$b._displayToIndex=function(n$a){if(this._animationData){n$a<0&&(n$a=0),n$a>this._count&&(n$a=this._count);var n$b=this._animationData.nodes,n$c=0,n$d=n$b.length;for(n$d=1<n$d?1:n$d,n$c=0;n$c<n$d;n$c++)this._displayNodeToFrame(n$b[n$c],n$a)}},n$b._displayNodeToFrame=function(n$a,n$b,n$c){if(this._target){var n$d;n$d=this._target;var n$e,n$f,n$g,n$h,n$i=n$a.frames,n$j=n$a.keys,n$k=0,n$l=n$j.length;n$h=n$a.secondFrames;var n$m,n$n,n$o,n$p,n$q=0;for(n$k=0;n$k<n$l;n$k++)n$f=n$i[n$e=n$j[n$k]],n$g=-1==(n$q=n$h[n$e])?this._initData[n$e]:n$b<n$q?(n$o=(n$n=n$a.keyframes[n$e])[0]).tween?(null==(n$m=n$U[n$o.tweenMethod])&&(n$m=n$U.linearNone),n$p=n$n[1],n$m(n$b,this._initData[n$e],n$p.value-this._initData[n$e],n$p.index)):this._initData[n$e]:n$f.length>n$b?n$f[n$b]:n$f[n$f.length-1],n$d[n$e]=n$g}},n$b._calculateNodeKeyFrames=function(n$a){n$f.prototype._calculateNodeKeyFrames.call(this,n$a);var n$b,n$c,n$d,n$e=n$a.keyframes;n$a.target;for(n$b in n$d={},n$a.secondFrames=n$d,n$e)(n$c=n$e[n$b]).length<=1?n$d[n$b]=-1:n$d[n$b]=n$c[1].index},n$o(0,n$b,"target",function(){return this._target},function(n$a){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=n$a,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),n$o(0,n$b,"playEvent",null,function(n$a){(this._playEvents=n$a)&&this.addEvent()}),n$o(0,n$b,"effectData",null,function(n$a){var n$b;n$a&&((n$b=n$a.animations)&&n$b[0]&&(this._setUp({},n$b[0]),n$b[0].nodes&&n$b[0].nodes[0]&&(this._aniKeys=n$b[0].nodes[0].keys)))}),n$o(0,n$b,"effectClass",null,function(n$a){var n$b,n$c;(this._effectClass=n$R.getClass(n$a),this._effectClass)&&((n$b=this._effectClass.uiView)&&(n$c=n$b.animations)&&n$c[0]&&(this._setUp({},n$c[0]),n$c[0].nodes&&n$c[0].nodes[0]&&(this._aniKeys=n$c[0].nodes[0].keys)))}),n$a.EffectAnimationBegin="effectanimationbegin"}(n$ua),function(n$b){var n$D;function n$E(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,n$E.__super.call(this)}n$k(n$E,"laya.utils.GraphicAnimation",n$b);var n$a=n$E.prototype;return n$a._parseNodeList=function(n$a){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[n$a.compId]=n$a.props,n$a.compId&&this._nodeList.push(n$a.compId);var n$b=n$a.child;if(n$b){var n$c=0,n$d=n$b.length;for(n$c=0;n$c<n$d;n$c++)this._parseNodeList(n$b[n$c])}},n$a._calGraphicData=function(n$a){var n$b;if(this._setUp(null,n$a),this._createGraphicData(),this._nodeIDAniDic)for(n$b in this._nodeIDAniDic)this._nodeIDAniDic[n$b]=null},n$a._createGraphicData=function(){var n$a,n$b=[],n$c=0,n$d=this.count,n$e=this._animationNewFrames;for(n$e||(n$e=[]),n$c=0;n$c<n$d;n$c++)!n$e[n$c]&&n$a||(n$a=this._createFrameGraphic(n$c)),n$b.push(n$a);this._gList=n$b},n$a._createFrameGraphic=function(n$a){var n$b=n$F.createGraphics();return n$E._rootMatrix||(n$E._rootMatrix=new n$G),this._updateNodeGraphic(this._rootNode,n$a,n$E._rootMatrix,n$b),n$b},n$a._updateNodeGraphic=function(n$a,n$b,n$c,n$d,n$e){var n$f;void 0===n$e&&(n$e=1);var n$g,n$h,n$i,n$j=(n$f=this._nodeGDic[n$a.compId]=this._getNodeGraphicData(n$a.compId,n$b,this._nodeGDic[n$a.compId])).alpha*n$e;if(!(n$j<.01)&&(n$f.resultTransform||(n$f.resultTransform=n$G.create()),n$g=n$f.resultTransform,n$G.mul(n$f.transform,n$c,n$g),n$f.skin&&(n$h=this._getTextureByUrl(n$f.skin))&&(n$g._checkTransform()?(n$d.drawTexture(n$h,0,0,n$f.width,n$f.height,n$g,n$j),n$f.resultTransform=null):n$d.drawTexture(n$h,n$g.tx,n$g.ty,n$f.width,n$f.height,null,n$j)),n$i=n$a.child)){var n$k,n$l=0;for(n$k=n$i.length,n$l=0;n$l<n$k;n$l++)this._updateNodeGraphic(n$i[n$l],n$b,n$g,n$d,n$j)}},n$a._updateNoChilds=function(n$a,n$b){if(n$a.skin){var n$c=this._getTextureByUrl(n$a.skin);if(n$c){var n$d=n$a.transform;n$d._checkTransform();!n$d.bTransform?n$b.drawTexture(n$c,n$d.tx,n$d.ty,n$a.width,n$a.height,null,n$a.alpha):n$b.drawTexture(n$c,0,0,n$a.width,n$a.height,n$d.clone(),n$a.alpha)}}},n$a._updateNodeGraphic2=function(n$a,n$b,n$c){var n$d;if(n$d=this._nodeGDic[n$a.compId]=this._getNodeGraphicData(n$a.compId,n$b,this._nodeGDic[n$a.compId]),n$a.child){var n$e=n$d.transform;n$e._checkTransform();var n$f,n$g;n$g=(n$f=!n$e.bTransform)&&(0!=n$e.tx||0!=n$e.ty);var n$h,n$i,n$j;if((n$h=n$e.bTransform||1!=n$d.alpha)&&n$c.save(),1!=n$d.alpha&&n$c.alpha(n$d.alpha),n$f?n$g&&n$c.translate(n$e.tx,n$e.ty):n$c.transform(n$e.clone()),n$i=n$a.child,n$d.skin&&(n$j=this._getTextureByUrl(n$d.skin))&&n$c.drawTexture(n$j,0,0,n$d.width,n$d.height),n$i){var n$k,n$l=0;for(n$k=n$i.length,n$l=0;n$l<n$k;n$l++)this._updateNodeGraphic2(n$i[n$l],n$b,n$c)}n$h?n$c.restore():n$f?n$g&&n$c.translate(-n$e.tx,-n$e.ty):n$c.transform(n$e.clone().invert())}else this._updateNoChilds(n$d,n$c)},n$a._calculateNodeKeyFrames=function(n$a){n$b.prototype._calculateNodeKeyFrames.call(this,n$a),this._nodeIDAniDic[n$a.target]=n$a},n$a.getNodeDataByID=function(n$a){return this._nodeIDAniDic[n$a]},n$a._getParams=function(n$a,n$b,n$c,n$d){var n$e=n$E._temParam;n$e.length=n$b.length;var n$f=0,n$g=n$b.length;for(n$f=0;n$f<n$g;n$f++)n$e[n$f]=this._getObjVar(n$a,n$b[n$f][0],n$c,n$b[n$f][1],n$d);return n$e},n$a._getObjVar=function(n$a,n$b,n$c,n$d,n$e){if(n$a.hasOwnProperty(n$b)){var n$f=n$a[n$b];if(n$c>=n$f.length&&(n$c=n$f.length-1),null!=n$a[n$b][n$c])return n$a[n$b][n$c]}return n$e.hasOwnProperty(n$b)?n$e[n$b]:n$d},n$a._getNodeGraphicData=function(n$a,n$b,n$c){n$c||(n$c=n$D.create()),n$c.transform?n$c.transform.identity():n$c.transform=n$G.create();var n$d=this.getNodeDataByID(n$a);if(!n$d)return n$c;var n$e,n$f,n$g=n$d.frames,n$h=this._getParams(n$g,n$E._drawTextureCmd,n$b,this._nodeDefaultProps[n$a]),n$i=n$h[0],n$j=NaN,n$k=NaN,n$l=n$h[5],n$m=n$h[6],n$n=n$h[13],n$o=n$h[14],n$p=n$h[7],n$q=n$h[8],n$r=n$h[9],n$s=n$h[11],n$t=n$h[12];n$j=n$h[3],n$k=n$h[4],0!=n$j&&0!=n$k||(n$i=null),-1==n$j&&(n$j=0),-1==n$k&&(n$k=0),n$c.skin=n$i,n$c.width=n$j,n$c.height=n$k,n$i&&((n$e=this._getTextureByUrl(n$i))?(n$j||(n$j=n$e.sourceWidth),n$k||(n$k=n$e.sourceHeight)):console.warn("lost skin:",n$i,",you may load pics first")),n$c.alpha=n$h[10],n$f=n$c.transform,0!=n$n&&(n$l=n$n*n$j),0!=n$o&&(n$m=n$o*n$k),0==n$l&&0==n$m||n$f.translate(-n$l,-n$m);var n$u=null;if(n$r||1!==n$p||1!==n$q||n$s||n$t){(n$u=n$E._tempMt).identity(),n$u.bTransform=!0;var n$v=.0174532922222222*(n$r-n$s),n$w=.0174532922222222*(n$r+n$t),n$x=Math.cos(n$w),n$y=Math.sin(n$w),n$z=Math.sin(n$v),n$C=Math.cos(n$v);n$u.a=n$p*n$x,n$u.b=n$p*n$y,n$u.c=-n$q*n$z,n$u.d=n$q*n$C,n$u.tx=n$u.ty=0}return n$u&&(n$f=n$G.mul(n$f,n$u,n$f)),n$f.translate(n$h[1],n$h[2]),n$c},n$a._getTextureByUrl=function(n$a){return n$ha.getRes(n$a)},n$a.setAniData=function(n$a,n$b){if(n$a.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=n$a,this._parseNodeList(n$a);var n$c,n$d={},n$e=[],n$f=n$a.animations,n$g=0,n$h=n$f.length;for(n$g=0;n$g<n$h;n$g++)if(n$c=n$f[n$g],this._labels=null,(!n$b||n$b==n$c.name)&&n$c){try{this._calGraphicData(n$c)}catch(n$a){console.warn("parse animation fail:"+n$c.name+",empty animation created"),this._gList=[]}var n$i={};n$i.interval=1e3/n$c.frameRate,n$i.frames=this._gList,n$i.labels=this._labels,n$i.name=n$c.name,n$e.push(n$i),n$d[n$c.name]=n$i}this.animationList=n$e,this.animationDic=n$d}n$E._temParam.length=0},n$a.parseByData=function(n$a){var n$b,n$c;n$b=n$a.nodeRoot,n$c=n$a.aniO,delete n$a.nodeRoot,delete n$a.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=n$b,this._parseNodeList(n$b),this._labels=null;try{this._calGraphicData(n$c)}catch(n$a){console.warn("parse animation fail:"+n$c.name+",empty animation created"),this._gList=[]}var n$d=n$a;return n$d.interval=1e3/n$c.frameRate,n$d.frames=this._gList,n$d.labels=this._labels,n$d.name=n$c.name,n$d},n$a.setUpAniData=function(n$a){if(n$a.animations){var n$b,n$c={},n$d=[],n$e=n$a.animations,n$f=0,n$g=n$e.length;for(n$f=0;n$f<n$g;n$f++)if(n$b=n$e[n$f]){var n$h={};n$h.name=n$b.name,n$h.aniO=n$b,n$h.nodeRoot=n$a,n$d.push(n$h),n$c[n$b.name]=n$h}this.animationList=n$d,this.animationDic=n$c}},n$a._clear=function(){var n$a,n$b;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(n$a in this._nodeGDic)(n$b=this._nodeGDic[n$a])&&n$b.recover();this._nodeGDic=null},n$E.parseAnimationByData=function(n$a){var n$b;return n$E._I||(n$E._I=new n$E),n$b=n$E._I.parseByData(n$a),n$E._I._clear(),n$b},n$E.parseAnimationData=function(n$a){var n$b;return n$E._I||(n$E._I=new n$E),n$E._I.setUpAniData(n$a),(n$b={}).animationList=n$E._I.animationList,n$b.animationDic=n$E._I.animationDic,n$E._I._clear(),n$b},n$E._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],n$E._temParam=[],n$E._I=null,n$E._rootMatrix=null,n$i(n$E,["_tempMt",function(){return this._tempMt=new n$G}]),n$E.__init$=function(){n$D=function(){function n$a(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return n$k(n$a,""),n$a.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),n$W.recover("GraphicNode",this)},n$a.create=function(){return n$W.getItemByClass("GraphicNode",n$a)},n$a}()},n$E}(n$ua));n$x.__init([n$j,n$ia,n$J,n$O,n$Y,n$C,n$a,n$xa])}(window,document,Laya),function(n$a,n$b,n$c){n$c.un,n$c.uns,n$c.static;var n$d=n$c.class;n$c.getset,n$c.__newvec;new(function(){function n$a(){}return n$d(n$a,"LayaMain"),n$a}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(n$a,n$b){"use strict";for(var n$c in Object.defineProperty(n$b,"__esModule",{value:!0}),Laya){var n$d=Laya[n$c];n$d&&n$d.__isclass&&(n$b[n$c]=n$d)}}),function(n$a,n$b,n$w){n$w.un,n$w.uns;var n$g=n$w.static,n$m=n$w.class,n$d=n$w.getset,n$f=n$w.__newvec,n$k=laya.maths.Arith,n$l=laya.maths.Bezier,n$c=laya.resource.Bitmap,n$n=laya.utils.Browser,n$i=laya.utils.Byte,n$o=laya.utils.Color,n$x=(laya.filters.ColorFilter,n$w.Config),n$e=laya.resource.Context,n$y=(laya.events.Event,laya.filters.Filter),n$h=laya.display.Graphics,n$j=laya.resource.HTMLCanvas,n$p=(laya.utils.HTMLChar,laya.resource.HTMLImage),n$q=laya.resource.HTMLSubImage,n$z=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),n$C=laya.maths.Point,n$D=laya.maths.Rectangle,n$r=laya.renders.Render,n$s=(laya.renders.RenderContext,laya.renders.RenderSprite),n$t=laya.resource.Resource,n$u=laya.resource.ResourceManager,n$v=laya.utils.RunDriver,n$E=laya.display.Sprite,n$F=laya.display.Stage,n$G=laya.utils.Stat,n$H=laya.utils.StringKey,n$I=(laya.display.css.Style,laya.system.System),n$J=laya.display.Text,n$K=laya.resource.Texture,n$L=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),n$M=laya.utils.VectorGraphManager;laya.utils.WordText;n$w.interface("laya.webgl.shapes.IShape"),n$w.interface("laya.webgl.submit.ISubmit"),n$w.interface("laya.webgl.text.ICharSegment"),n$w.interface("laya.webgl.canvas.save.ISaveData"),n$w.interface("laya.webgl.resource.IMergeAtlasBitmap"),n$w.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var n$N=function(){function n$a(){}n$m(n$a,"laya.filters.webgl.FilterActionGL");var n$b=n$a.prototype;return n$w.imps(n$b,{"laya.filters.IFilterActionGL":!0}),n$b.setValue=function(n$a){},n$b.setValueMix=function(n$a){},n$b.apply3d=function(n$a,n$b,n$c,n$d,n$e){return null},n$b.apply=function(n$a){return null},n$d(0,n$b,"typeMix",function(){return 0}),n$a}(),n$O=function(){function n$a(){}return n$m(n$a,"laya.webgl.shader.ShaderValue"),n$a}(),n$P=function(){var n$d,n$e;function n$a(n$a,n$b,n$c){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new n$e,void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),this._cells=null,this._rowInfo=null,this._init(n$a,n$b),this._atlasID=n$c}n$m(n$a,"laya.webgl.atlas.AtlasGrid");var n$b=n$a.prototype;return n$b.getAltasID=function(){return this._atlasID},n$b.setAltasID=function(n$a){0<=n$a&&(this._atlasID=n$a)},n$b.addTex=function(n$a,n$b,n$c){var n$d=this._get(n$b,n$c);return 0==n$d.ret||(this._fill(n$d.x,n$d.y,n$b,n$c,n$a),this._texCount++),n$d},n$b._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},n$b._init=function(n$a,n$b){if(this._width=n$a,this._height=n$b,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=n$f(this._height);for(var n$c=0;n$c<this._height;n$c++)this._rowInfo[n$c]=new n$d;return this._clear(),!0},n$b._get=function(n$a,n$b){var n$c=new n$R;if(n$a>=this._failSize.width&&n$b>=this._failSize.height)return n$c;for(var n$d=-1,n$e=-1,n$f=this._width,n$g=this._height,n$h=this._cells,n$i=0;n$i<n$g;n$i++)if(!(this._rowInfo[n$i].spaceCount<n$a))for(var n$j=0;n$j<n$f;){var n$k=3*(n$i*n$f+n$j);if(0!=n$h[n$k]||n$h[1+n$k]<n$a||n$h[2+n$k]<n$b)n$j+=n$h[1+n$k];else{n$d=n$j,n$e=n$i;for(var n$l=0;n$l<n$a;n$l++)if(n$h[3*n$l+n$k+2]<n$b){n$d=-1;break}if(!(n$d<0))return n$c.ret=!0,n$c.x=n$d,n$c.y=n$e,n$c;n$j+=n$h[1+n$k]}}return n$c},n$b._fill=function(n$a,n$b,n$c,n$d,n$e){var n$f=this._width,n$g=this._height;this._check(n$a+n$c<=n$f&&n$b+n$d<=n$g);for(var n$h=n$b;n$h<n$d+n$b;++n$h){this._check(this._rowInfo[n$h].spaceCount>=n$c),this._rowInfo[n$h].spaceCount-=n$c;for(var n$i=0;n$i<n$c;n$i++){var n$j=3*(n$a+n$h*n$f+n$i);this._check(0==this._cells[n$j]),this._cells[n$j]=n$e,this._cells[1+n$j]=n$c,this._cells[2+n$j]=n$d}}if(0<n$a)for(n$h=0;n$h<n$d;++n$h){var n$k=0;for(n$i=n$a-1;0<=n$i&&0==this._cells[3*((n$b+n$h)*n$f+n$i)];--n$i,++n$k);for(n$i=n$k;0<n$i;--n$i)this._cells[3*((n$b+n$h)*n$f+n$a-n$i)+1]=n$i,this._check(0<n$i)}if(0<n$b)for(n$i=n$a;n$i<n$a+n$c;++n$i){for(n$k=0,n$h=n$b-1;0<=n$h&&0==this._cells[3*(n$i+n$h*n$f)];--n$h,n$k++);for(n$h=n$k;0<n$h;--n$h)this._cells[3*(n$i+(n$b-n$h)*n$f)+2]=n$h,this._check(0<n$h)}},n$b._check=function(n$a){0==n$a&&console.log("xtexMerger 错误啦")},n$b._clear=function(){for(var n$a=this._texCount=0;n$a<this._height;n$a++)this._rowInfo[n$a].spaceCount=this._width;for(var n$b=0;n$b<this._height;n$b++)for(var n$c=0;n$c<this._width;n$c++){var n$d=3*(n$b*this._width+n$c);this._cells[n$d]=0,this._cells[1+n$d]=this._width-n$c,this._cells[2+n$d]=this._width-n$b}this._failSize.width=this._width+1,this._failSize.height=this._height+1},n$a.__init$=function(){n$d=function(){function n$a(){this.spaceCount=0}return n$m(n$a,""),n$a}(),n$e=function(){function n$a(){this.width=0,this.height=0}return n$m(n$a,""),n$a}()},n$a}(),n$Q=function(){function n$r(n$a,n$b,n$c,n$d){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=n$a,this._height=n$b,this._gridSize=n$c,this._maxAtlaserCount=n$d,this._gridNumX=n$a/n$c,this._gridNumY=n$b/n$c,this._curAtlasIndex=0,this._atlaserArray=[]}n$m(n$r,"laya.webgl.atlas.AtlasResourceManager");var n$a=n$r.prototype;return n$a.setAtlasParam=function(n$a,n$b,n$c,n$d){if(1==this._setAtlasParam)return n$r._sid_=0,this._width=n$a,this._height=n$b,this._gridSize=n$c,this._maxAtlaserCount=n$d,this._gridNumX=n$a/n$c,this._gridNumY=n$b/n$c,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},n$a.pushData=function(n$a){var n$b,n$c=n$a.bitmap,n$d=-1,n$e=null,n$f=0,n$g=0;for(n$f=0,n$b=this._atlaserArray.length;n$f<n$b&&(n$g=(this._curAtlasIndex+n$f)%n$b,-1==(n$d=(n$e=this._atlaserArray[n$g]).findBitmapIsExist(n$c)));n$f++);if(-1!=n$d){var n$h=n$e.InAtlasWebGLImagesOffsetValue[n$d];return n$o=n$h[0],n$p=n$h[1],n$e.addToAtlas(n$a,n$o,n$p),!0}this._setAtlasParam=!1;for(var n$i=Math.ceil((n$a.bitmap.width+2)/this._gridSize),n$j=Math.ceil((n$a.bitmap.height+2)/this._gridSize),n$k=!1,n$l=0;n$l<2;n$l++){var n$m=this._maxAtlaserCount;for(n$f=0;n$f<n$m;n$f++){n$g=(this._curAtlasIndex+n$f)%n$m,this._atlaserArray.length-1>=n$g||this._atlaserArray.push(new n$Da(this._gridNumX,this._gridNumY,this._width,this._height,n$r._sid_++));var n$n=this._atlaserArray[n$g],n$o=0,n$p=0,n$q=n$n.addTex(1,n$i,n$j);if(n$q.ret){n$o=n$q.x*this._gridSize+1,n$p=n$q.y*this._gridSize+1,n$c.lock=!0,n$n.addToAtlasTexture(n$c,n$o,n$p),n$n.addToAtlas(n$a,n$o,n$p),n$k=!0,this._curAtlasIndex=n$g;break}}if(n$k)break;this._atlaserArray.push(new n$Da(this._gridNumX,this._gridNumY,this._width,this._height,n$r._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return n$k||console.log(">>>AtlasManager pushData error"),n$k},n$a.addToAtlas=function(n$a){laya.webgl.atlas.AtlasResourceManager.instance.pushData(n$a)},n$a.garbageCollection=function(){if(!0===this._needGC){for(var n$a=this._atlaserArray.length-this._maxAtlaserCount,n$b=0;n$b<n$a;n$b++)this._atlaserArray[n$b].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+n$a),this._atlaserArray.splice(0,n$a),this._needGC=!1}return!0},n$a.freeAll=function(){for(var n$a=0,n$b=this._atlaserArray.length;n$a<n$b;n$a++)this._atlaserArray[n$a].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},n$a.getAtlaserCount=function(){return this._atlaserArray.length},n$a.getAtlaserByIndex=function(n$a){return this._atlaserArray[n$a]},n$d(1,n$r,"instance",function(){return n$r._Instance||(n$r._Instance=new n$r(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),n$r._Instance}),n$d(1,n$r,"enabled",function(){return n$x.atlasEnable}),n$d(1,n$r,"atlasLimitWidth",function(){return n$r._atlasLimitWidth},function(n$a){n$r._atlasLimitWidth=n$a}),n$d(1,n$r,"atlasLimitHeight",function(){return n$r._atlasLimitHeight},function(n$a){n$r._atlasLimitHeight=n$a}),n$r._enable=function(){n$x.atlasEnable=!0},n$r._disable=function(){n$x.atlasEnable=!1},n$r.__init__=function(){n$r.atlasTextureWidth=2048,n$r.atlasTextureHeight=2048,n$r.maxTextureCount=6,n$r.atlasLimitWidth=512,n$r.atlasLimitHeight=512},n$r._atlasLimitWidth=0,n$r._atlasLimitHeight=0,n$r.gridSize=16,n$r.atlasTextureWidth=0,n$r.atlasTextureHeight=0,n$r.maxTextureCount=0,n$r._atlasRestore=0,n$r.BOARDER_TYPE_NO=0,n$r.BOARDER_TYPE_RIGHT=1,n$r.BOARDER_TYPE_LEFT=2,n$r.BOARDER_TYPE_BOTTOM=4,n$r.BOARDER_TYPE_TOP=8,n$r.BOARDER_TYPE_ALL=15,n$r._sid_=0,n$r._Instance=null,n$r}(),n$R=function(){function n$a(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return n$m(n$a,"laya.webgl.atlas.MergeFillInfo"),n$a}(),n$S=function(){function n$b(){}return n$m(n$b,"laya.webgl.canvas.BlendMode"),n$b._init_=function(n$a){n$b.fns=[n$b.BlendNormal,n$b.BlendAdd,n$b.BlendMultiply,n$b.BlendScreen,n$b.BlendOverlay,n$b.BlendLight,n$b.BlendMask,n$b.BlendDestinationOut],n$b.targetFns=[n$b.BlendNormalTarget,n$b.BlendAddTarget,n$b.BlendMultiplyTarget,n$b.BlendScreenTarget,n$b.BlendOverlayTarget,n$b.BlendLightTarget,n$b.BlendMask,n$b.BlendDestinationOut]},n$b.BlendNormal=function(n$a){n$a.blendFunc(1,771)},n$b.BlendAdd=function(n$a){n$a.blendFunc(1,772)},n$b.BlendMultiply=function(n$a){n$a.blendFunc(774,771)},n$b.BlendScreen=function(n$a){n$a.blendFunc(1,1)},n$b.BlendOverlay=function(n$a){n$a.blendFunc(1,769)},n$b.BlendLight=function(n$a){n$a.blendFunc(1,1)},n$b.BlendNormalTarget=function(n$a){n$a.blendFunc(1,771)},n$b.BlendAddTarget=function(n$a){n$a.blendFunc(1,772)},n$b.BlendMultiplyTarget=function(n$a){n$a.blendFunc(774,771)},n$b.BlendScreenTarget=function(n$a){n$a.blendFunc(1,1)},n$b.BlendOverlayTarget=function(n$a){n$a.blendFunc(1,769)},n$b.BlendLightTarget=function(n$a){n$a.blendFunc(1,1)},n$b.BlendMask=function(n$a){n$a.blendFunc(0,770)},n$b.BlendDestinationOut=function(n$a){n$a.blendFunc(0,0)},n$b.activeBlendFunction=null,n$b.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],n$b.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},n$b.NORMAL="normal",n$b.ADD="add",n$b.MULTIPLY="multiply",n$b.SCREEN="screen",n$b.LIGHT="light",n$b.OVERLAY="overlay",n$b.DESTINATIONOUT="destination-out",n$b.fns=[],n$b.targetFns=[],n$b}(),n$T=function(){function n$c(n$a){this._color=n$o.create("black"),this.setValue(n$a)}n$m(n$c,"laya.webgl.canvas.DrawStyle");var n$a=n$c.prototype;return n$a.setValue=function(n$a){if(n$a){if("string"==typeof n$a)return void(this._color=n$o.create(n$a));if(n$a instanceof laya.utils.Color)return void(this._color=n$a)}},n$a.reset=function(){this._color=n$o.create("black")},n$a.equal=function(n$a){return"string"==typeof n$a?this._color.strColor===n$a:n$a instanceof laya.utils.Color&&this._color.numColor===n$a.numColor},n$a.toColorStr=function(){return this._color.strColor},n$c.create=function(n$a){var n$b;if(n$a&&("string"==typeof n$a?n$b=n$o.create(n$a):n$a instanceof laya.utils.Color&&(n$b=n$a),n$b))return n$b._drawStyle||(n$b._drawStyle=new n$c(n$a));return laya.webgl.canvas.DrawStyle.DEFAULT},n$g(n$c,["DEFAULT",function(){return this.DEFAULT=new n$c("#000000")}]),n$c}(),n$U=function(){function n$a(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];n$ua.mainContext;this.ib=n$Aa.create(35048),this.vb=n$Ba.create(5)}n$m(n$a,"laya.webgl.canvas.Path");var n$b=n$a.prototype;return n$b.addPoint=function(n$a,n$b){this.tempArray.push(n$a,n$b)},n$b.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},n$b.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},n$b.polygon=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g;return this.geomatrys.push(this._curGeomatry=n$g=new n$Ha(n$a,n$b,n$c,n$d,n$e,n$f)),n$d||(n$g.fill=!1),null==n$f&&(n$g.borderWidth=0),n$g},n$b.setGeomtry=function(n$a){this.geomatrys.push(this._curGeomatry=n$a)},n$b.drawLine=function(n$a,n$b,n$c,n$d,n$e){var n$f;return this.closePath?this.geomatrys.push(this._curGeomatry=n$f=new n$Ga(n$a,n$b,n$c,n$d,n$e)):this.geomatrys.push(this._curGeomatry=n$f=new n$Fa(n$a,n$b,n$c,n$d,n$e)),n$f.fill=!1,n$f},n$b.update=function(){var n$a=this.ib._byteLength,n$b=this.geomatrys.length;this.offset=n$a;for(var n$c=this.geoStart;n$c<n$b;n$c++)this.geomatrys[n$c].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=n$b,this.count=(this.ib._byteLength-n$a)/n$pa.BYTES_PIDX},n$b.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},n$b.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},n$a}(),n$V=function(){function n$h(){}n$m(n$h,"laya.webgl.canvas.save.SaveBase");var n$a=n$h.prototype;return n$w.imps(n$a,{"laya.webgl.canvas.save.ISaveData":!0}),n$a.isSaveMark=function(){return!1},n$a.restore=function(n$a){this._dataObj[this._valueName]=this._value,(n$h._cache[n$h._cache._length++]=this)._newSubmit&&(n$a._curSubmit=n$fa.RENDERBASE,n$a._renderKey=0)},n$h._createArray=function(){var n$a=[];return n$a._length=0,n$a},n$h._init=function(){var n$a=n$h._namemap={};return n$a[1]="ALPHA",n$a[2]="fillStyle",n$a[8]="font",n$a[256]="lineWidth",n$a[512]="strokeStyle",n$a[8192]="_mergeID",n$a[1024]=n$a[2048]=n$a[4096]=[],n$a[16384]="textBaseline",n$a[32768]="textAlign",n$a[65536]="_nBlendType",n$a[1048576]="shader",n$a[2097152]="filters",n$a},n$h.save=function(n$a,n$b,n$c,n$d){if((n$a._saveMark._saveuse&n$b)!==n$b){n$a._saveMark._saveuse|=n$b;var n$e=n$h._cache,n$f=0<n$e._length?n$e[--n$e._length]:new n$h;n$f._value=n$c[n$f._valueName=n$h._namemap[n$b]],n$f._dataObj=n$c,n$f._newSubmit=n$d;var n$g=n$a._save;n$g[n$g._length++]=n$f}},n$h._cache=laya.webgl.canvas.save.SaveBase._createArray(),n$h._namemap=n$h._init(),n$h}(),n$W=function(){function n$f(){this._clipRect=new n$D}n$m(n$f,"laya.webgl.canvas.save.SaveClipRect");var n$a=n$f.prototype;return n$w.imps(n$a,{"laya.webgl.canvas.save.ISaveData":!0}),n$a.isSaveMark=function(){return!1},n$a.restore=function(n$a){n$a._clipRect=this._clipSaveRect,(n$f._cache[n$f._cache._length++]=this)._submitScissor.submitLength=n$a._submits._length-this._submitScissor.submitIndex,n$a._curSubmit=n$fa.RENDERBASE,n$a._renderKey=0},n$f.save=function(n$a,n$b){if(131072!=(131072&n$a._saveMark._saveuse)){n$a._saveMark._saveuse|=131072;var n$c=n$f._cache,n$d=0<n$c._length?n$c[--n$c._length]:new n$f;n$d._clipSaveRect=n$a._clipRect,n$a._clipRect=n$d._clipRect.copyFrom(n$a._clipRect),n$d._submitScissor=n$b;var n$e=n$a._save;n$e[n$e._length++]=n$d}},n$g(n$f,["_cache",function(){return this._cache=n$V._createArray()}]),n$f}(),n$X=function(){function n$n(){this._contextX=0,this._contextY=0,this._clipRect=new n$D,this._rect=new n$D,this._matrix=new n$z}n$m(n$n,"laya.webgl.canvas.save.SaveClipRectStencil");var n$a=n$n.prototype;return n$w.imps(n$a,{"laya.webgl.canvas.save.ISaveData":!0}),n$a.isSaveMark=function(){return!1},n$a.restore=function(n$a){n$ka.restore(n$a,this._rect,this._saveMatrix,this._contextX,this._contextY),n$a._clipRect=this._clipSaveRect,n$a._curMat=this._saveMatrix,n$a._x=this._contextX,n$a._y=this._contextY,n$n._cache[n$n._cache._length++]=this,n$a._curSubmit=n$fa.RENDERBASE},n$n.save=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){if(262144!=(262144&n$a._saveMark._saveuse)){n$a._saveMark._saveuse|=262144;var n$k=n$n._cache,n$l=0<n$k._length?n$k[--n$k._length]:new n$n;n$l._clipSaveRect=n$a._clipRect,n$l._clipRect.setTo(n$g,n$h,n$i,n$j),n$a._clipRect=n$l._clipRect,n$l._rect.x=n$c,n$l._rect.y=n$d,n$l._rect.width=n$e,n$l._rect.height=n$f,n$l._contextX=n$a._x,n$l._contextY=n$a._y,n$l._saveMatrix=n$a._curMat,n$a._curMat.copyTo(n$l._matrix),n$a._curMat=n$l._matrix,n$l._submitStencil=n$b;var n$m=n$a._save;n$m[n$m._length++]=n$l}},n$g(n$n,["_cache",function(){return this._cache=n$V._createArray()}]),n$n}(),n$Y=function(){function n$d(){this._saveuse=0}n$m(n$d,"laya.webgl.canvas.save.SaveMark");var n$a=n$d.prototype;return n$w.imps(n$a,{"laya.webgl.canvas.save.ISaveData":!0}),n$a.isSaveMark=function(){return!0},n$a.restore=function(n$a){n$a._saveMark=this._preSaveMark,n$d._no[n$d._no._length++]=this},n$d.Create=function(n$a){var n$b=n$d._no,n$c=0<n$b._length?n$b[--n$b._length]:new n$d;return n$c._saveuse=0,n$c._preSaveMark=n$a._saveMark,n$a._saveMark=n$c},n$g(n$d,["_no",function(){return this._no=n$V._createArray()}]),n$d}(),n$Z=function(){function n$f(){this._matrix=new n$z}n$m(n$f,"laya.webgl.canvas.save.SaveTransform");var n$a=n$f.prototype;return n$w.imps(n$a,{"laya.webgl.canvas.save.ISaveData":!0}),n$a.isSaveMark=function(){return!1},n$a.restore=function(n$a){n$a._curMat=this._savematrix,n$f._no[n$f._no._length++]=this},n$f.save=function(n$a){var n$b=n$a._saveMark;if(2048!=(2048&n$b._saveuse)){n$b._saveuse|=2048;var n$c=n$f._no,n$d=0<n$c._length?n$c[--n$c._length]:new n$f;n$d._savematrix=n$a._curMat,n$a._curMat=n$a._curMat.copyTo(n$d._matrix);var n$e=n$a._save;n$e[n$e._length++]=n$d}},n$g(n$f,["_no",function(){return this._no=n$V._createArray()}]),n$f}(),n$$=function(){function n$e(){}n$m(n$e,"laya.webgl.canvas.save.SaveTranslate");var n$a=n$e.prototype;return n$w.imps(n$a,{"laya.webgl.canvas.save.ISaveData":!0}),n$a.isSaveMark=function(){return!1},n$a.restore=function(n$a){n$a._curMat;n$a._x=this._x,n$a._y=this._y,n$e._no[n$e._no._length++]=this},n$e.save=function(n$a){var n$b=n$e._no,n$c=0<n$b._length?n$b[--n$b._length]:new n$e;n$c._x=n$a._x,n$c._y=n$a._y;var n$d=n$a._save;n$d[n$d._length++]=n$c},n$g(n$e,["_no",function(){return this._no=n$V._createArray()}]),n$e}(),n$_=function(){function n$a(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new n$D}n$m(n$a,"laya.webgl.resource.RenderTargetMAX");var n$b=n$a.prototype;return n$b.setSP=function(n$a){this._sp=n$a},n$b.size=function(n$a,n$b){var n$c=this;this._width!==n$a||this._height!==n$b?(this.repaint=!0,this._width=n$a,this._height=n$b,this.target?this.target.size(n$a,n$b):this.target=n$Ma.create(n$a,n$b),this.target.hasListener("recovered")||this.target.on("recovered",this,function(n$a){n$w.timer.callLater(n$c._sp,n$c._sp.repaint)})):this.target.size(n$a,n$b)},n$b._flushToTarget=function(n$a,n$b){if(!n$b._destroy){var n$c=n$sa.worldScissorTest,n$d=n$sa.worldClipRect;n$sa.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,n$sa.worldScissorTest=!1,n$ua.mainContext.disable(3089);var n$e=n$sa.worldAlpha,n$f=n$sa.worldMatrix4,n$g=n$sa.worldMatrix,n$h=n$sa.worldFilters,n$i=n$sa.worldShaderDefines;if(n$sa.worldMatrix=n$z.EMPTY,n$sa.restoreTempArray(),n$sa.worldMatrix4=n$sa.TEMPMAT4_ARRAY,n$sa.worldAlpha=1,n$sa.worldFilters=null,n$sa.worldShaderDefines=null,n$La.activeShader=null,n$b.start(),n$x.showCanvasMark?n$b.clear(0,1,0,.3):n$b.clear(0,0,0,0),n$a.flush(),n$b.end(),n$La.activeShader=null,n$sa.worldAlpha=n$e,n$sa.worldMatrix4=n$f,n$sa.worldMatrix=n$g,n$sa.worldFilters=n$h,n$sa.worldShaderDefines=n$i,n$sa.worldScissorTest=n$c){var n$j=n$sa.height-n$d.y-n$d.height;n$ua.mainContext.scissor(n$d.x,n$j,n$d.width,n$d.height),n$ua.mainContext.enable(3089)}n$sa.worldClipRect=n$d}},n$b.flush=function(n$a){this.repaint&&(this._flushToTarget(n$a,this.target),this.repaint=!1)},n$b.drawTo=function(n$a,n$b,n$c,n$d,n$e){n$a.drawTexture(this.target.getTexture(),n$b,n$c,n$d,n$e,0,0)},n$b.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},n$a}(),n$A=function(){function n$a(){this.ALPHA=1,this.shaderType=0,this.defines=new n$Ea}return n$m(n$a,"laya.webgl.shader.d2.Shader2D"),n$a.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},n$a.__init__=function(){var n$a,n$b;n$Ya.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),n$Ya.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),n$Ya.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),n$Ya.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),n$Ya.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),n$Ya.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),n$Ya.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),n$Ya.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),n$a="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",n$b='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',n$Ya.preCompile2D(0,1,n$a,n$b,null),n$a="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",n$b='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',n$Ya.preCompile2D(0,2,n$a,n$b,null),n$a="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",n$b="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",n$Ya.preCompile2D(0,4,n$a,n$b,null),n$a="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",n$b='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',n$Ya.preCompile2D(0,256,n$a,n$b,null),n$a="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",n$b="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",n$Ya.preCompile2D(0,512,n$a,n$b,null)},n$a}(),n$B=function(){function n$b(n$a,n$b,n$c){this._value=0,this._name2int=n$a,this._int2name=n$b,this._int2nameMap=n$c}n$m(n$b,"laya.webgl.shader.ShaderDefines");var n$a=n$b.prototype;return n$a.add=function(n$a){return"string"==typeof n$a&&(n$a=this._name2int[n$a]),this._value|=n$a,this._value},n$a.addInt=function(n$a){return this._value|=n$a,this._value},n$a.remove=function(n$a){return"string"==typeof n$a&&(n$a=this._name2int[n$a]),this._value&=~n$a,this._value},n$a.isDefine=function(n$a){return(this._value&n$a)===n$a},n$a.getValue=function(){return this._value},n$a.setValue=function(n$a){this._value=n$a},n$a.toNameDic=function(){var n$a=this._int2nameMap[this._value];return n$a||n$b._toText(this._value,this._int2name,this._int2nameMap)},n$b._reg=function(n$a,n$b,n$c,n$d){n$d[n$c[n$a]=n$b]=n$a},n$b._toText=function(n$a,n$b,n$c){var n$d=n$c[n$a];if(n$d)return n$d;for(var n$e={},n$f=1,n$g=0;n$g<32&&!(n$a<(n$f=1<<n$g));n$g++)if(n$a&n$f){var n$h=n$b[n$f];n$h&&(n$e[n$h]="")}return n$c[n$a]=n$e},n$b._toInt=function(n$a,n$b){for(var n$c=n$a.split("."),n$d=0,n$e=0,n$f=n$c.length;n$e<n$f;n$e++){var n$g=n$b[n$c[n$e]];if(!n$g)throw new Error("Defines to int err:"+n$a+"/"+n$c[n$e]);n$d|=n$g}return n$d},n$b}(),n$aa=function(){function n$g(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new n$z}n$m(n$g,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var n$a=n$g.prototype;return n$a.init=function(n$a,n$b,n$c){if(n$b)this._vs=n$b;else{this._vs=[];var n$d=n$a.width,n$e=n$a.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(n$d,0,1,0,1,1,1,1),this._vs.push(n$d,n$e,1,1,1,1,1,1),this._vs.push(0,n$e,0,1,1,1,1,1)}n$c?this._ps=n$c:(n$g._defaultPS||(n$g._defaultPS=[]).push(0,1,3,3,1,2),this._ps=n$g._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=n$a},n$a.init2=function(n$a,n$b,n$c,n$d,n$e){this.transform&&(this.transform=null),n$c?this._ps=n$c:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=n$d,this._uvs=n$e,this.mEleNum=this._ps.length,this.mTexture=n$a,(n$r.isConchNode||n$r.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},n$a._initMyData=function(){var n$a=0,n$b=0,n$c=4*this._verticles.length;this._vs=n$g._tempVS;var n$d=!1;if(n$r.isConchNode||n$r.isConchApp?(this._vs.length=n$c,n$d=!0):this._vs.length<n$c&&(this._vs.length=n$c,n$d=!0),n$g._tVSLen=n$c,n$d)for(;n$a<n$c;)this._vs[n$a]=this._verticles[n$b],this._vs[n$a+1]=this._verticles[n$b+1],this._vs[n$a+2]=this._uvs[n$b],this._vs[n$a+3]=this._uvs[n$b+1],this._vs[n$a+4]=1,this._vs[n$a+5]=1,this._vs[n$a+6]=1,this._vs[n$a+7]=1,n$a+=8,n$b+=2;else for(;n$a<n$c;)this._vs[n$a]=this._verticles[n$b],this._vs[n$a+1]=this._verticles[n$b+1],this._vs[n$a+2]=this._uvs[n$b],this._vs[n$a+3]=this._uvs[n$b+1],n$a+=8,n$b+=2},n$a.getData2=function(n$a,n$b,n$c){var n$d;this.mVBBuffer=n$a,this.mIBBuffer=n$b,this._initMyData(),n$a.appendEx2(this._vs,Float32Array,n$g._tVSLen,4),this._indexStart=n$b._byteLength,(n$d=n$g._tempIB).length<this._ps.length&&(n$d.length=this._ps.length);for(var n$e=0,n$f=this._ps.length;n$e<n$f;n$e++)n$d[n$e]=this._ps[n$e]+n$c;n$b.appendEx2(n$d,Uint16Array,this._ps.length,2)},n$a.getData=function(n$a,n$b,n$c){if(this.mVBBuffer=n$a,this.mIBBuffer=n$b,n$a.append(this.mVBData),this._indexStart=n$b._byteLength,this.mIBData.start!=n$c){for(var n$d=0,n$e=this._ps.length;n$d<n$e;n$d++)this.mIBData[n$d]=this._ps[n$d]+n$c;this.mIBData.start=n$c}n$b.append(this.mIBData)},n$a.render=function(n$a,n$b,n$c){if(n$r.isWebGL&&this.mTexture){n$a._renderKey=0,n$a._shader2D.glTexture=null,n$ba.getInstance().addSkinMesh(this);var n$d=n$fa.createShape(n$a,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,n$ya.create(512,0));this.transform||(this.transform=n$z.EMPTY),this.transform.translate(n$b,n$c),n$z.mul(this.transform,n$a._curMat,this._tempMatrix),this.transform.translate(-n$b,-n$c);var n$e=n$d.shaderValue,n$f=n$e.u_mmat2||n$sa.getMatrArray();n$sa.mat2MatArray(this._tempMatrix,n$f),n$e.textureHost=this.mTexture,n$e.offsetX=0,n$e.offsetY=0,n$e.u_mmat2=n$f,n$e.ALPHA=n$a._shader2D.ALPHA,n$a._submits[n$a._submits._length++]=n$d}else n$r.isConchApp&&this.mTexture&&(this.transform||(this.transform=n$z.EMPTY),n$a.setSkinMesh&&n$a.setSkinMesh(n$b,n$c,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},n$g._tempVS=[],n$g._tempIB=[],n$g._defaultPS=null,n$g._tVSLen=0,n$g}(),n$ba=function(){function n$a(){this.ib=null,this.vb=null;n$ua.mainContext;this.ib=n$Aa.create(35048),this.vb=n$Ba.create(8)}n$m(n$a,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var n$b=n$a.prototype;return n$b.addSkinMesh=function(n$a){n$a.getData2(this.vb,this.ib,this.vb._byteLength/32)},n$b.reset=function(){this.vb.clear(),this.ib.clear()},n$a.getInstance=function(){return n$a.instance=n$a.instance||new n$a},n$a.instance=null,n$a}(),n$ca=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===n$i&&(n$i=0),this.x=n$a,this.y=n$b,this.width=n$c,this.height=n$d,this.edges=n$e,this.color=n$f,this.borderWidth=n$g,this.borderColor=n$h}n$m(n$a,"laya.webgl.shapes.BasePoly");var n$b=n$a.prototype;return n$w.imps(n$b,{"laya.webgl.shapes.IShape":!0}),n$b.getData=function(n$a,n$b,n$c){},n$b.rebuild=function(n$a){},n$b.setMatrix=function(n$a){},n$b.needUpdate=function(n$a){return!0},n$b.sector=function(n$a,n$b,n$c){var n$d=this.x,n$e=this.y,n$f=this.edges,n$g=(this.r1-this.r0)/n$f,n$h=this.width,n$i=this.height,n$j=this.color,n$k=(n$j>>16&255)/255,n$l=(n$j>>8&255)/255,n$m=(255&n$j)/255;n$a.push(n$d,n$e,n$k,n$l,n$m);for(var n$n=0;n$n<n$f+1;n$n++)n$a.push(n$d+Math.sin(n$g*n$n+this.r0)*n$h,n$e+Math.cos(n$g*n$n+this.r0)*n$i),n$a.push(n$k,n$l,n$m);for(n$n=0;n$n<n$f;n$n++)n$b.push(n$c,n$c+n$n+1,n$c+n$n+2)},n$b.createLine2=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g,n$h,n$i,n$j,n$k,n$l,n$m,n$n,n$o,n$p,n$q,n$r,n$s,n$t,n$u,n$v,n$w,n$x,n$y,n$z,n$C=n$a.concat(),n$D=n$e,n$E=this.borderColor,n$F=(n$E>>16&255)/255,n$G=(n$E>>8&255)/255,n$H=(255&n$E)/255,n$I=n$C.length/2,n$J=n$d,n$K=n$c/2;n$i=n$C[0],n$j=n$C[1],n$p=n$i-(n$k=n$C[2]),n$o=(n$o=-(n$j-(n$l=n$C[3])))/(n$z=Math.sqrt(n$o*n$o+n$p*n$p))*n$K,n$p=n$p/n$z*n$K,n$D.push(n$i-n$o+this.x,n$j-n$p+this.y,n$F,n$G,n$H,n$i+n$o+this.x,n$j+n$p+this.y,n$F,n$G,n$H);for(var n$L=1;n$L<n$I-1;n$L++)n$i=n$C[2*(n$L-1)],n$j=n$C[2*(n$L-1)+1],n$k=n$C[2*n$L],n$l=n$C[2*n$L+1],n$m=n$C[2*(n$L+1)],n$n=n$C[2*(n$L+1)+1],n$p=n$i-n$k,n$r=n$k-n$m,n$u=(-(n$o=(n$o=-(n$j-n$l))/(n$z=Math.sqrt(n$o*n$o+n$p*n$p))*n$K)+n$i)*(-(n$p=n$p/n$z*n$K)+n$l)-(-n$o+n$k)*(-n$p+n$j),n$x=(-(n$q=(n$q=-(n$l-n$n))/(n$z=Math.sqrt(n$q*n$q+n$r*n$r))*n$K)+n$m)*(-(n$r=n$r/n$z*n$K)+n$l)-(-n$q+n$k)*(-n$r+n$n),n$y=(n$s=-n$p+n$j-(-n$p+n$l))*(n$w=-n$q+n$k-(-n$q+n$m))-(n$v=-n$r+n$n-(-n$r+n$l))*(n$t=-n$o+n$k-(-n$o+n$i)),Math.abs(n$y)<.1?(n$y+=10.1,n$D.push(n$k-n$o+this.x,n$l-n$p+this.y,n$F,n$G,n$H,n$k+n$o+this.x,n$l+n$p+this.y,n$F,n$G,n$H)):(((n$g=(n$t*n$x-n$w*n$u)/n$y)-n$k)*(n$g-n$k)+((n$h=(n$v*n$u-n$s*n$x)/n$y)-n$l)+(n$h-n$l),n$D.push(n$g+this.x,n$h+this.y,n$F,n$G,n$H,n$k-(n$g-n$k)+this.x,n$l-(n$h-n$l)+this.y,n$F,n$G,n$H));n$i=n$C[n$C.length-4],n$j=n$C[n$C.length-3],n$p=n$i-(n$k=n$C[n$C.length-2]),n$o=(n$o=-(n$j-(n$l=n$C[n$C.length-1])))/(n$z=Math.sqrt(n$o*n$o+n$p*n$p))*n$K,n$p=n$p/n$z*n$K,n$D.push(n$k-n$o+this.x,n$l-n$p+this.y,n$F,n$G,n$H,n$k+n$o+this.x,n$l+n$p+this.y,n$F,n$G,n$H);var n$M=n$f;for(n$L=1;n$L<n$M;n$L++)n$b.push(n$J+2*(n$L-1),n$J+2*(n$L-1)+1,n$J+2*n$L+1,n$J+2*n$L+1,n$J+2*n$L,n$J+2*(n$L-1));return n$D},n$b.createLine=function(n$a,n$b,n$c,n$d){var n$e=n$a.concat(),n$f=n$a,n$g=this.borderColor,n$h=(n$g>>16&255)/255,n$i=(n$g>>8&255)/255,n$j=(255&n$g)/255;n$e.splice(0,5);var n$k,n$l,n$m,n$n,n$o,n$p,n$q,n$r,n$s,n$t,n$u,n$v,n$w,n$x,n$y,n$z,n$C,n$D,n$E,n$F,n$G=n$e.length/5,n$H=n$d,n$I=n$c/2;n$m=n$e[0],n$n=n$e[1],n$t=n$m-(n$o=n$e[5]),n$s=(n$s=-(n$n-(n$p=n$e[6])))/(n$F=Math.sqrt(n$s*n$s+n$t*n$t))*n$I,n$t=n$t/n$F*n$I,n$f.push(n$m-n$s,n$n-n$t,n$h,n$i,n$j,n$m+n$s,n$n+n$t,n$h,n$i,n$j);for(var n$J=1;n$J<n$G-1;n$J++)n$m=n$e[5*(n$J-1)],n$n=n$e[5*(n$J-1)+1],n$o=n$e[5*n$J],n$p=n$e[5*n$J+1],n$q=n$e[5*(n$J+1)],n$r=n$e[5*(n$J+1)+1],n$t=n$m-n$o,n$v=n$o-n$q,n$y=(-(n$s=(n$s=-(n$n-n$p))/(n$F=Math.sqrt(n$s*n$s+n$t*n$t))*n$I)+n$m)*(-(n$t=n$t/n$F*n$I)+n$p)-(-n$s+n$o)*(-n$t+n$n),n$D=(-(n$u=(n$u=-(n$p-n$r))/(n$F=Math.sqrt(n$u*n$u+n$v*n$v))*n$I)+n$q)*(-(n$v=n$v/n$F*n$I)+n$p)-(-n$u+n$o)*(-n$v+n$r),n$E=(n$w=-n$t+n$n-(-n$t+n$p))*(n$C=-n$u+n$o-(-n$u+n$q))-(n$z=-n$v+n$r-(-n$v+n$p))*(n$x=-n$s+n$o-(-n$s+n$m)),Math.abs(n$E)<.1?(n$E+=10.1,n$f.push(n$o-n$s,n$p-n$t,n$h,n$i,n$j,n$o+n$s,n$p+n$t,n$h,n$i,n$j)):(((n$k=(n$x*n$D-n$C*n$y)/n$E)-n$o)*(n$k-n$o)+((n$l=(n$z*n$y-n$w*n$D)/n$E)-n$p)+(n$l-n$p),n$f.push(n$k,n$l,n$h,n$i,n$j,n$o-(n$k-n$o),n$p-(n$l-n$p),n$h,n$i,n$j));n$m=n$e[n$e.length-10],n$n=n$e[n$e.length-9],n$t=n$m-(n$o=n$e[n$e.length-5]),n$s=(n$s=-(n$n-(n$p=n$e[n$e.length-4])))/(n$F=Math.sqrt(n$s*n$s+n$t*n$t))*n$I,n$t=n$t/n$F*n$I,n$f.push(n$o-n$s,n$p-n$t,n$h,n$i,n$j,n$o+n$s,n$p+n$t,n$h,n$i,n$j);var n$K=this.edges+1;for(n$J=1;n$J<n$K;n$J++)n$b.push(n$H+2*(n$J-1),n$H+2*(n$J-1)+1,n$H+2*n$J+1,n$H+2*n$J+1,n$H+2*n$J,n$H+2*(n$J-1));return n$f},n$b.createLoopLine=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=n$a.concat(),n$h=n$e||n$a,n$i=this.borderColor,n$j=(n$i>>16&255)/255,n$k=(n$i>>8&255)/255,n$l=(255&n$i)/255;n$g.splice(0,5);var n$m=[n$g[0],n$g[1]],n$n=[n$g[n$g.length-5],n$g[n$g.length-4]],n$o=n$n[0]+.5*(n$m[0]-n$n[0]),n$p=n$n[1]+.5*(n$m[1]-n$n[1]);n$g.unshift(n$o,n$p,0,0,0),n$g.push(n$o,n$p,0,0,0);var n$q,n$r,n$s,n$t,n$u,n$v,n$w,n$x,n$y,n$z,n$C,n$D,n$E,n$F,n$G,n$H,n$I,n$J,n$K,n$L,n$M=n$g.length/5,n$N=n$d,n$O=n$c/2;n$s=n$g[0],n$t=n$g[1],n$z=n$s-(n$u=n$g[5]),n$y=(n$y=-(n$t-(n$v=n$g[6])))/(n$L=Math.sqrt(n$y*n$y+n$z*n$z))*n$O,n$z=n$z/n$L*n$O,n$h.push(n$s-n$y,n$t-n$z,n$j,n$k,n$l,n$s+n$y,n$t+n$z,n$j,n$k,n$l);for(var n$P=1;n$P<n$M-1;n$P++)n$s=n$g[5*(n$P-1)],n$t=n$g[5*(n$P-1)+1],n$u=n$g[5*n$P],n$v=n$g[5*n$P+1],n$w=n$g[5*(n$P+1)],n$x=n$g[5*(n$P+1)+1],n$z=n$s-n$u,n$D=n$u-n$w,n$G=(-(n$y=(n$y=-(n$t-n$v))/(n$L=Math.sqrt(n$y*n$y+n$z*n$z))*n$O)+n$s)*(-(n$z=n$z/n$L*n$O)+n$v)-(-n$y+n$u)*(-n$z+n$t),n$J=(-(n$C=(n$C=-(n$v-n$x))/(n$L=Math.sqrt(n$C*n$C+n$D*n$D))*n$O)+n$w)*(-(n$D=n$D/n$L*n$O)+n$v)-(-n$C+n$u)*(-n$D+n$x),n$K=(n$E=-n$z+n$t-(-n$z+n$v))*(n$I=-n$C+n$u-(-n$C+n$w))-(n$H=-n$D+n$x-(-n$D+n$v))*(n$F=-n$y+n$u-(-n$y+n$s)),Math.abs(n$K)<.1?(n$K+=10.1,n$h.push(n$u-n$y,n$v-n$z,n$j,n$k,n$l,n$u+n$y,n$v+n$z,n$j,n$k,n$l)):(((n$q=(n$F*n$J-n$I*n$G)/n$K)-n$u)*(n$q-n$u)+((n$r=(n$H*n$G-n$E*n$J)/n$K)-n$v)+(n$r-n$v),n$h.push(n$q,n$r,n$j,n$k,n$l,n$u-(n$q-n$u),n$v-(n$r-n$v),n$j,n$k,n$l));n$f&&(n$b=n$f);var n$Q=this.edges+1;for(n$P=1;n$P<n$Q;n$P++)n$b.push(n$N+2*(n$P-1),n$N+2*(n$P-1)+1,n$N+2*n$P+1,n$N+2*n$P+1,n$N+2*n$P,n$N+2*(n$P-1));return n$b.push(n$N+2*(n$P-1),n$N+2*(n$P-1)+1,n$N+1,n$N+1,n$N,n$N+2*(n$P-1)),n$h},n$a}(),n$da=function(){function n$p(){}return n$m(n$p,"laya.webgl.shapes.Earcut"),n$p.earcut=function(n$a,n$b,n$c){n$c=n$c||2;var n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k=n$b&&n$b.length,n$l=n$k?n$b[0]*n$c:n$a.length,n$m=n$p.linkedList(n$a,0,n$l,n$c,!0),n$n=[];if(!n$m)return n$n;if(n$k&&(n$m=n$p.eliminateHoles(n$a,n$b,n$m,n$c)),n$a.length>80*n$c){n$d=n$f=n$a[0],n$e=n$g=n$a[1];for(var n$o=n$c;n$o<n$l;n$o+=n$c)(n$h=n$a[n$o])<n$d&&(n$d=n$h),(n$i=n$a[n$o+1])<n$e&&(n$e=n$i),n$f<n$h&&(n$f=n$h),n$g<n$i&&(n$g=n$i);n$j=0!==(n$j=Math.max(n$f-n$d,n$g-n$e))?1/n$j:0}return n$p.earcutLinked(n$m,n$n,n$c,n$d,n$e,n$j),n$n},n$p.linkedList=function(n$a,n$b,n$c,n$d,n$e){var n$f,n$g;if(n$e===0<n$p.signedArea(n$a,n$b,n$c,n$d))for(n$f=n$b;n$f<n$c;n$f+=n$d)n$g=n$p.insertNode(n$f,n$a[n$f],n$a[n$f+1],n$g);else for(n$f=n$c-n$d;n$b<=n$f;n$f-=n$d)n$g=n$p.insertNode(n$f,n$a[n$f],n$a[n$f+1],n$g);return n$g&&n$p.equals(n$g,n$g.next)&&(n$p.removeNode(n$g),n$g=n$g.next),n$g},n$p.filterPoints=function(n$a,n$b){if(!n$a)return n$a;n$b||(n$b=n$a);var n$c,n$d=n$a;do{if(n$c=!1,n$d.steiner||!n$p.equals(n$d,n$d.next)&&0!==n$p.area(n$d.prev,n$d,n$d.next))n$d=n$d.next;else{if(n$p.removeNode(n$d),(n$d=n$b=n$d.prev)===n$d.next)break;n$c=!0}}while(n$c||n$d!==n$b);return n$b},n$p.earcutLinked=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){if(n$a){!n$g&&n$f&&n$p.indexCurve(n$a,n$d,n$e,n$f);for(var n$h,n$i,n$j=n$a;n$a.prev!==n$a.next;)if(n$h=n$a.prev,n$i=n$a.next,n$f?n$p.isEarHashed(n$a,n$d,n$e,n$f):n$p.isEar(n$a))n$b.push(n$h.i/n$c),n$b.push(n$a.i/n$c),n$b.push(n$i.i/n$c),n$p.removeNode(n$a),n$a=n$i.next,n$j=n$i.next;else if((n$a=n$i)===n$j){n$g?1===n$g?(n$a=n$p.cureLocalIntersections(n$a,n$b,n$c),n$p.earcutLinked(n$a,n$b,n$c,n$d,n$e,n$f,2)):2===n$g&&n$p.splitEarcut(n$a,n$b,n$c,n$d,n$e,n$f):n$p.earcutLinked(n$p.filterPoints(n$a,null),n$b,n$c,n$d,n$e,n$f,1);break}}},n$p.isEar=function(n$a){var n$b=n$a.prev,n$c=n$a,n$d=n$a.next;if(0<=n$p.area(n$b,n$c,n$d))return!1;for(var n$e=n$a.next.next;n$e!==n$a.prev;){if(n$p.pointInTriangle(n$b.x,n$b.y,n$c.x,n$c.y,n$d.x,n$d.y,n$e.x,n$e.y)&&0<=n$p.area(n$e.prev,n$e,n$e.next))return!1;n$e=n$e.next}return!0},n$p.isEarHashed=function(n$a,n$b,n$c,n$d){var n$e=n$a.prev,n$f=n$a,n$g=n$a.next;if(0<=n$p.area(n$e,n$f,n$g))return!1;for(var n$h=n$e.x<n$f.x?n$e.x<n$g.x?n$e.x:n$g.x:n$f.x<n$g.x?n$f.x:n$g.x,n$i=n$e.y<n$f.y?n$e.y<n$g.y?n$e.y:n$g.y:n$f.y<n$g.y?n$f.y:n$g.y,n$j=n$e.x>n$f.x?n$e.x>n$g.x?n$e.x:n$g.x:n$f.x>n$g.x?n$f.x:n$g.x,n$k=n$e.y>n$f.y?n$e.y>n$g.y?n$e.y:n$g.y:n$f.y>n$g.y?n$f.y:n$g.y,n$l=n$p.zOrder(n$h,n$i,n$b,n$c,n$d),n$m=n$p.zOrder(n$j,n$k,n$b,n$c,n$d),n$n=n$a.nextZ;n$n&&n$n.z<=n$m;){if(n$n!==n$a.prev&&n$n!==n$a.next&&n$p.pointInTriangle(n$e.x,n$e.y,n$f.x,n$f.y,n$g.x,n$g.y,n$n.x,n$n.y)&&0<=n$p.area(n$n.prev,n$n,n$n.next))return!1;n$n=n$n.nextZ}for(n$n=n$a.prevZ;n$n&&n$n.z>=n$l;){if(n$n!==n$a.prev&&n$n!==n$a.next&&n$p.pointInTriangle(n$e.x,n$e.y,n$f.x,n$f.y,n$g.x,n$g.y,n$n.x,n$n.y)&&0<=n$p.area(n$n.prev,n$n,n$n.next))return!1;n$n=n$n.prevZ}return!0},n$p.cureLocalIntersections=function(n$a,n$b,n$c){var n$d=n$a;do{var n$e=n$d.prev,n$f=n$d.next.next;!n$p.equals(n$e,n$f)&&n$p.intersects(n$e,n$d,n$d.next,n$f)&&n$p.locallyInside(n$e,n$f)&&n$p.locallyInside(n$f,n$e)&&(n$b.push(n$e.i/n$c),n$b.push(n$d.i/n$c),n$b.push(n$f.i/n$c),n$p.removeNode(n$d),n$p.removeNode(n$d.next),n$d=n$a=n$f),n$d=n$d.next}while(n$d!==n$a);return n$d},n$p.splitEarcut=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=n$a;do{for(var n$h=n$g.next.next;n$h!==n$g.prev;){if(n$g.i!==n$h.i&&n$p.isValidDiagonal(n$g,n$h)){var n$i=n$p.splitPolygon(n$g,n$h);return n$g=n$p.filterPoints(n$g,n$g.next),n$i=n$p.filterPoints(n$i,n$i.next),n$p.earcutLinked(n$g,n$b,n$c,n$d,n$e,n$f),void n$p.earcutLinked(n$i,n$b,n$c,n$d,n$e,n$f)}n$h=n$h.next}n$g=n$g.next}while(n$g!==n$a)},n$p.eliminateHoles=function(n$a,n$b,n$c,n$d){var n$e,n$f,n$g,n$h,n$i,n$j=[];for(n$e=0,n$f=n$b.length;n$e<n$f;n$e++)n$g=n$b[n$e]*n$d,n$h=n$e<n$f-1?n$b[n$e+1]*n$d:n$a.length,(n$i=n$p.linkedList(n$a,n$g,n$h,n$d,!1))===n$i.next&&(n$i.steiner=!0),n$j.push(n$p.getLeftmost(n$i));for(n$j.sort(n$p.compareX),n$e=0;n$e<n$j.length;n$e++)n$p.eliminateHole(n$j[n$e],n$c),n$c=n$p.filterPoints(n$c,n$c.next);return n$c},n$p.compareX=function(n$a,n$b){return n$a.x-n$b.x},n$p.eliminateHole=function(n$a,n$b){if(n$b=n$p.findHoleBridge(n$a,n$b)){var n$c=n$p.splitPolygon(n$b,n$a);n$p.filterPoints(n$c,n$c.next)}},n$p.findHoleBridge=function(n$a,n$b){var n$c,n$d=n$b,n$e=n$a.x,n$f=n$a.y,n$g=-1/0;do{if(n$f<=n$d.y&&n$f>=n$d.next.y&&n$d.next.y!==n$d.y){var n$h=n$d.x+(n$f-n$d.y)*(n$d.next.x-n$d.x)/(n$d.next.y-n$d.y);if(n$h<=n$e&&n$g<n$h){if((n$g=n$h)===n$e){if(n$f===n$d.y)return n$d;if(n$f===n$d.next.y)return n$d.next}n$c=n$d.x<n$d.next.x?n$d:n$d.next}}n$d=n$d.next}while(n$d!==n$b);if(!n$c)return null;if(n$e===n$g)return n$c.prev;var n$i,n$j=n$c,n$k=n$c.x,n$l=n$c.y,n$m=1/0;for(n$d=n$c.next;n$d!==n$j;)n$e>=n$d.x&&n$d.x>=n$k&&n$e!==n$d.x&&n$p.pointInTriangle(n$f<n$l?n$e:n$g,n$f,n$k,n$l,n$f<n$l?n$g:n$e,n$f,n$d.x,n$d.y)&&((n$i=Math.abs(n$f-n$d.y)/(n$e-n$d.x))<n$m||n$i===n$m&&n$d.x>n$c.x)&&n$p.locallyInside(n$d,n$a)&&(n$c=n$d,n$m=n$i),n$d=n$d.next;return n$c},n$p.indexCurve=function(n$a,n$b,n$c,n$d){for(var n$e=n$a;null===n$e.z&&(n$e.z=n$p.zOrder(n$e.x,n$e.y,n$b,n$c,n$d)),n$e.prevZ=n$e.prev,n$e.nextZ=n$e.next,(n$e=n$e.next)!==n$a;);n$e.prevZ.nextZ=null,n$e.prevZ=null,n$p.sortLinked(n$e)},n$p.sortLinked=function(n$a){var n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j=1;do{for(n$c=n$a,n$f=n$a=null,n$g=0;n$c;){for(n$g++,n$d=n$c,n$b=n$h=0;n$b<n$j&&(n$h++,n$d=n$d.nextZ);n$b++);for(n$i=n$j;0<n$h||0<n$i&&n$d;)0!==n$h&&(0===n$i||!n$d||n$c.z<=n$d.z)?(n$c=(n$e=n$c).nextZ,n$h--):(n$d=(n$e=n$d).nextZ,n$i--),n$f?n$f.nextZ=n$e:n$a=n$e,n$e.prevZ=n$f,n$f=n$e;n$c=n$d}n$f.nextZ=null,n$j*=2}while(1<n$g);return n$a},n$p.zOrder=function(n$a,n$b,n$c,n$d,n$e){return(n$a=1431655765&((n$a=858993459&((n$a=252645135&((n$a=16711935&((n$a=32767*(n$a-n$c)*n$e)|n$a<<8))|n$a<<4))|n$a<<2))|n$a<<1))|(n$b=1431655765&((n$b=858993459&((n$b=252645135&((n$b=16711935&((n$b=32767*(n$b-n$d)*n$e)|n$b<<8))|n$b<<4))|n$b<<2))|n$b<<1))<<1},n$p.getLeftmost=function(n$a){for(var n$b=n$a,n$c=n$a;n$b.x<n$c.x&&(n$c=n$b),(n$b=n$b.next)!==n$a;);return n$c},n$p.pointInTriangle=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){return 0<=(n$e-n$g)*(n$b-n$h)-(n$a-n$g)*(n$f-n$h)&&0<=(n$a-n$g)*(n$d-n$h)-(n$c-n$g)*(n$b-n$h)&&0<=(n$c-n$g)*(n$f-n$h)-(n$e-n$g)*(n$d-n$h)},n$p.isValidDiagonal=function(n$a,n$b){return n$a.next.i!==n$b.i&&n$a.prev.i!==n$b.i&&!n$p.intersectsPolygon(n$a,n$b)&&n$p.locallyInside(n$a,n$b)&&n$p.locallyInside(n$b,n$a)&&n$p.middleInside(n$a,n$b)},n$p.area=function(n$a,n$b,n$c){return(n$b.y-n$a.y)*(n$c.x-n$b.x)-(n$b.x-n$a.x)*(n$c.y-n$b.y)},n$p.equals=function(n$a,n$b){return n$a.x===n$b.x&&n$a.y===n$b.y},n$p.intersects=function(n$a,n$b,n$c,n$d){return!!(n$p.equals(n$a,n$b)&&n$p.equals(n$c,n$d)||n$p.equals(n$a,n$d)&&n$p.equals(n$c,n$b))||0<n$p.area(n$a,n$b,n$c)!=0<n$p.area(n$a,n$b,n$d)&&0<n$p.area(n$c,n$d,n$a)!=0<n$p.area(n$c,n$d,n$b)},n$p.intersectsPolygon=function(n$a,n$b){var n$c=n$a;do{if(n$c.i!==n$a.i&&n$c.next.i!==n$a.i&&n$c.i!==n$b.i&&n$c.next.i!==n$b.i&&n$p.intersects(n$c,n$c.next,n$a,n$b))return!0;n$c=n$c.next}while(n$c!==n$a);return!1},n$p.locallyInside=function(n$a,n$b){return n$p.area(n$a.prev,n$a,n$a.next)<0?0<=n$p.area(n$a,n$b,n$a.next)&&0<=n$p.area(n$a,n$a.prev,n$b):n$p.area(n$a,n$b,n$a.prev)<0||n$p.area(n$a,n$a.next,n$b)<0},n$p.middleInside=function(n$a,n$b){for(var n$c=n$a,n$d=!1,n$e=(n$a.x+n$b.x)/2,n$f=(n$a.y+n$b.y)/2;n$c.y>n$f!=n$c.next.y>n$f&&n$c.next.y!==n$c.y&&n$e<(n$c.next.x-n$c.x)*(n$f-n$c.y)/(n$c.next.y-n$c.y)+n$c.x&&(n$d=!n$d),(n$c=n$c.next)!==n$a;);return n$d},n$p.splitPolygon=function(n$a,n$b){var n$c=new n$ea(n$a.i,n$a.x,n$a.y),n$d=new n$ea(n$b.i,n$b.x,n$b.y),n$e=n$a.next,n$f=n$b.prev;return(n$a.next=n$b).prev=n$a,(n$c.next=n$e).prev=n$c,(n$d.next=n$c).prev=n$d,(n$f.next=n$d).prev=n$f,n$d},n$p.insertNode=function(n$a,n$b,n$c,n$d){var n$e=new n$ea(n$a,n$b,n$c);return n$d?(n$e.next=n$d.next,(n$e.prev=n$d).next.prev=n$e,n$d.next=n$e):(n$e.prev=n$e).next=n$e,n$e},n$p.removeNode=function(n$a){n$a.next.prev=n$a.prev,n$a.prev.next=n$a.next,n$a.prevZ&&(n$a.prevZ.nextZ=n$a.nextZ),n$a.nextZ&&(n$a.nextZ.prevZ=n$a.prevZ)},n$p.signedArea=function(n$a,n$b,n$c,n$d){for(var n$e=0,n$f=n$b,n$g=n$c-n$d;n$f<n$c;n$f+=n$d)n$e+=(n$a[n$g]-n$a[n$f])*(n$a[n$f+1]+n$a[n$g+1]),n$g=n$f;return n$e},n$p}(),n$ea=function(){function n$a(n$a,n$b,n$c){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=n$a,this.x=n$b,this.y=n$c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return n$m(n$a,"laya.webgl.shapes.EarcutNode"),n$a}(),n$fa=(function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this.lineWidth=n$a,this.lineColor=n$b,this.lineAlpha=n$c,this.fillColor=n$d,this.fillAlpha=n$e,this.shape=n$g,this.fill=n$f}n$m(n$a,"laya.webgl.shapes.GeometryData");var n$b=n$a.prototype;n$b.clone=function(){return new n$a(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},n$b.getIndexData=function(){return null},n$b.getVertexData=function(){return null},n$b.destroy=function(){this.shape=null}}(),function(){function n$a(n$a){if(n$a instanceof Float32Array)this.points=n$a;else if(n$a instanceof Array){n$a.length;this.points=new Float32Array(n$a)}}n$m(n$a,"laya.webgl.shapes.Vertex");var n$b=n$a.prototype;n$w.imps(n$b,{"laya.webgl.shapes.IShape":!0}),n$b.getData=function(n$a,n$b,n$c){},n$b.needUpdate=function(n$a){return!1},n$b.rebuild=function(n$a){},n$b.setMatrix=function(n$a){}}(),function(){function n$i(n$a){void 0===n$a&&(n$a=1e4),this._renderType=n$a}n$m(n$i,"laya.webgl.submit.Submit");var n$a=n$i.prototype;return n$w.imps(n$a,{"laya.webgl.submit.ISubmit":!0}),n$a.releaseRender=function(){var n$a=n$i._cache;(n$a[n$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},n$a.getRenderType=function(){return this._renderType},n$a.renderSubmit=function(){if(0===this._numEle)return 1;var n$a=this.shaderValue.textureHost;if(n$a){var n$b=n$a.source;if(!n$a.bitmap||!n$b)return 1;this.shaderValue.texture=n$b,n$a.alphaTexture&&n$a.alphaTexture.source&&(this.shaderValue.texture1=n$a.alphaTexture.source)}this._vb.bind_upload(this._ib);var n$c=n$ua.mainContext;return this.shaderValue.upload(),n$S.activeBlendFunction!==this._blendFn&&(n$c.enable(3042),this._blendFn(n$c),n$S.activeBlendFunction=this._blendFn),n$G.drawCall++,n$G.trianglesFaces+=this._numEle/3,n$c.drawElements(4,this._numEle,5123,this._startIdx),1},n$i.__init__=function(){var n$a=n$i.RENDERBASE=new n$i(-1);n$a.shaderValue=new n$ya(0,0),n$a.shaderValue.ALPHA=-1234},n$i.createSubmit=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$i._cache._length?n$i._cache[--n$i._cache._length]:new n$i;null==n$c&&((n$c=n$f._selfVb||(n$f._selfVb=n$Ba.create(-1))).clear(),n$d=0),n$f._ib=n$b,n$f._vb=n$c,n$f._startIdx=n$d*n$pa.BYTES_PIDX,n$f._numEle=0;var n$g=n$a._nBlendType;n$f._blendFn=n$a._targets?n$S.targetFns[n$g]:n$S.fns[n$g],n$f.shaderValue=n$e,n$f.shaderValue.setValue(n$a._shader2D);var n$h=n$a._shader2D.filters;return n$h&&n$f.shaderValue.setFilters(n$h),n$f},n$i.createShape=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=n$i._cache._length?n$i._cache[--n$i._cache._length]:new n$i;n$g._ib=n$b,n$g._vb=n$c,n$g._numEle=n$d,n$g._startIdx=n$e,n$g.shaderValue=n$f,n$g.shaderValue.setValue(n$a._shader2D);var n$h=n$a._nBlendType;return n$g._blendFn=n$a._targets?n$S.targetFns[n$h]:n$S.fns[n$h],n$g},n$i.TYPE_2D=1e4,n$i.TYPE_CANVAS=10003,n$i.TYPE_CMDSETRT=10004,n$i.TYPE_CUSTOM=10005,n$i.TYPE_BLURRT=10006,n$i.TYPE_CMDDESTORYPRERT=10007,n$i.TYPE_DISABLESTENCIL=10008,n$i.TYPE_OTHERIBVB=10009,n$i.TYPE_PRIMITIVE=10010,n$i.TYPE_RT=10011,n$i.TYPE_BLUR_RT=10012,n$i.TYPE_TARGET=10013,n$i.TYPE_CHANGE_VALUE=10014,n$i.TYPE_SHAPE=10015,n$i.TYPE_TEXTURE=10016,n$i.TYPE_FILLTEXTURE=10017,n$i.RENDERBASE=null,n$i._cache=((n$i._cache=[])._length=0,n$i._cache),n$i}()),n$ga=function(){function n$d(){this.fun=null,this.args=null}n$m(n$d,"laya.webgl.submit.SubmitCMD");var n$a=n$d.prototype;return n$w.imps(n$a,{"laya.webgl.submit.ISubmit":!0}),n$a.renderSubmit=function(){return this.fun.apply(null,this.args),1},n$a.getRenderType=function(){return 0},n$a.releaseRender=function(){var n$a=n$d._cache;n$a[n$a._length++]=this},n$d.create=function(n$a,n$b){var n$c=n$d._cache._length?n$d._cache[--n$d._cache._length]:new n$d;return n$c.fun=n$b,n$c.args=n$a,n$c},n$d._cache=((n$d._cache=[])._length=0,n$d._cache),n$d}(),n$ha=function(){function n$b(){this.variables={}}n$m(n$b,"laya.webgl.submit.SubmitCMDScope");var n$a=n$b.prototype;return n$a.getValue=function(n$a){return this.variables[n$a]},n$a.addValue=function(n$a,n$b){return this.variables[n$a]=n$b},n$a.setValue=function(n$a,n$b){return this.variables.hasOwnProperty(n$a)?this.variables[n$a]=n$b:null},n$a.clear=function(){for(var n$a in this.variables)delete this.variables[n$a]},n$a.recycle=function(){this.clear(),n$b.POOL.push(this)},n$b.create=function(){var n$a=n$b.POOL.pop();return n$a||(n$a=new n$b),n$a},n$b.POOL=[],n$b}(),n$ia=function(){function n$l(){this.offset=0,this.startIndex=0,this._mat=n$z.create()}n$m(n$l,"laya.webgl.submit.SubmitOtherIBVB");var n$a=n$l.prototype;return n$w.imps(n$a,{"laya.webgl.submit.ISubmit":!0}),n$a.releaseRender=function(){var n$a=n$l._cache;(n$a[n$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},n$a.getRenderType=function(){return 10009},n$a.renderSubmit=function(){var n$a=this._shaderValue.textureHost;if(n$a){var n$b=n$a.source;if(!n$a.bitmap||!n$b)return 1;this._shaderValue.texture=n$b}this._vb.bind_upload(this._ib);var n$c=n$sa.worldMatrix4,n$d=n$z.TEMP;n$z.mulPre(this._mat,n$c[0],n$c[1],n$c[4],n$c[5],n$c[12],n$c[13],n$d);var n$e=n$sa.worldMatrix4=n$l.tempMatrix4;n$e[0]=n$d.a,n$e[1]=n$d.b,n$e[4]=n$d.c,n$e[5]=n$d.d,n$e[12]=n$d.tx,n$e[13]=n$d.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var n$f=n$ua.mainContext;return n$S.activeBlendFunction!==this._blendFn&&(n$f.enable(3042),this._blendFn(n$f),n$S.activeBlendFunction=this._blendFn),n$G.drawCall++,n$G.trianglesFaces+=this._numEle/3,n$f.drawElements(4,this._numEle,5123,this.startIndex),n$sa.worldMatrix4=n$c,n$La.activeShader=null,1},n$l.create=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){void 0===n$i&&(n$i=0);var n$j=n$l._cache._length?n$l._cache[--n$l._cache._length]:new n$l;n$j._ib=n$c,n$j._vb=n$b,n$j._numEle=n$d,n$j._shader=n$e,n$j._shaderValue=n$f;var n$k=n$a._nBlendType;switch(n$j._blendFn=n$a._targets?n$S.targetFns[n$k]:n$S.fns[n$k],n$i){case 0:n$j.offset=0,n$j.startIndex=n$h/(n$pa.BYTES_PE*n$b.vertexStride)*1.5,n$j.startIndex*=n$pa.BYTES_PIDX;break;case 1:n$j.startIndex=n$g,n$j.offset=n$h}return n$j},n$l._cache=((n$l._cache=[])._length=0,n$l._cache),n$l.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n$l}(),n$ja=function(){function n$c(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new n$D,this.screenRect=new n$D}n$m(n$c,"laya.webgl.submit.SubmitScissor");var n$a=n$c.prototype;return n$w.imps(n$a,{"laya.webgl.submit.ISubmit":!0}),n$a._scissor=function(n$a,n$b,n$c,n$d){var n$e=n$sa.worldMatrix4,n$f=n$e[0],n$g=n$e[5],n$h=n$e[12],n$i=n$e[13];if(n$d*=n$g,(n$c*=n$f)<1||n$d<1)return!1;var n$j=(n$a=n$a*n$f+n$h)+n$c,n$k=(n$b=n$b*n$g+n$i)+n$d;n$a<0&&(n$c=n$j-(n$a=0)),n$b<0&&(n$d=n$k-(n$b=0));var n$l=n$sa.worldClipRect;if(n$a=Math.max(n$a,n$l.x),n$b=Math.max(n$b,n$l.y),n$c=Math.min(n$j,n$l.right)-n$a,n$d=Math.min(n$k,n$l.bottom)-n$b,n$c<1||n$d<1)return!1;var n$m=n$sa.worldScissorTest;return this.screenRect.copyFrom(n$l),n$l.x=n$a,n$l.y=n$b,n$l.width=n$c,n$l.height=n$d,n$sa.worldScissorTest=!0,n$b=n$sa.height-n$b-n$d,n$ua.mainContext.scissor(n$a,n$b,n$c,n$d),n$ua.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),n$m?(n$b=n$sa.height-this.screenRect.y-this.screenRect.height,n$ua.mainContext.scissor(this.screenRect.x,n$b,this.screenRect.width,this.screenRect.height),n$ua.mainContext.enable(3089)):(n$ua.mainContext.disable(3089),n$sa.worldScissorTest=!1),n$l.copyFrom(this.screenRect),!0},n$a._scissorWithTagart=function(n$a,n$b,n$c,n$d){if(n$c<1||n$d<1)return!1;var n$e=n$a+n$c,n$f=n$b+n$d;n$a<0&&(n$c=n$e-(n$a=0)),n$b<0&&(n$d=n$f-(n$b=0));var n$g=n$sa.worldClipRect;if(n$a=Math.max(n$a,n$g.x),n$b=Math.max(n$b,n$g.y),n$c=Math.min(n$e,n$g.right)-n$a,n$d=Math.min(n$f,n$g.bottom)-n$b,n$c<1||n$d<1)return!1;var n$h=n$sa.worldScissorTest;return this.screenRect.copyFrom(n$g),n$sa.worldScissorTest=!0,n$g.x=n$a,n$g.y=n$b,n$g.width=n$c,n$g.height=n$d,n$b=n$sa.height-n$b-n$d,n$ua.mainContext.scissor(n$a,n$b,n$c,n$d),n$ua.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),n$h?(n$b=n$sa.height-this.screenRect.y-this.screenRect.height,n$ua.mainContext.scissor(this.screenRect.x,n$b,this.screenRect.width,this.screenRect.height),n$ua.mainContext.enable(3089)):(n$ua.mainContext.disable(3089),n$sa.worldScissorTest=!1),n$g.copyFrom(this.screenRect),!0},n$a.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},n$a.getRenderType=function(){return 0},n$a.releaseRender=function(){var n$a=n$c._cache;(n$a[n$a._length++]=this).context=null},n$c.create=function(n$a){var n$b=n$c._cache._length?n$c._cache[--n$c._cache._length]:new n$c;return n$b.context=n$a,n$b},n$c._cache=((n$c._cache=[])._length=0,n$c._cache),n$c}(),n$ka=function(){function n$i(){this.step=0,this.blendMode=null,this.level=0}n$m(n$i,"laya.webgl.submit.SubmitStencil");var n$a=n$i.prototype;return n$w.imps(n$a,{"laya.webgl.submit.ISubmit":!0}),n$a.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},n$a.getRenderType=function(){return 0},n$a.releaseRender=function(){var n$a=n$i._cache;n$a[n$a._length++]=this},n$a.do1=function(){var n$a=n$ua.mainContext;n$a.enable(2960),n$a.clear(1024),n$a.colorMask(!1,!1,!1,!1),n$a.stencilFunc(514,this.level,255),n$a.stencilOp(7680,7680,7682)},n$a.do2=function(){var n$a=n$ua.mainContext;n$a.stencilFunc(514,this.level+1,255),n$a.colorMask(!0,!0,!0,!0),n$a.stencilOp(7680,7680,7680)},n$a.do3=function(){var n$a=n$ua.mainContext;n$a.colorMask(!0,!0,!0,!0),n$a.stencilOp(7680,7680,7680),n$a.clear(1024),n$a.disable(2960)},n$a.do4=function(){var n$a=n$ua.mainContext;0==this.level&&(n$a.enable(2960),n$a.clear(1024)),n$a.colorMask(!1,!1,!1,!1),n$a.stencilFunc(519,0,255),n$a.stencilOp(7680,7680,7682)},n$a.do5=function(){var n$a=n$ua.mainContext;n$a.stencilFunc(514,this.level,255),n$a.colorMask(!0,!0,!0,!0),n$a.stencilOp(7680,7680,7680)},n$a.do6=function(){var n$a=n$ua.mainContext;n$S.targetFns[n$S.TOINT[this.blendMode]](n$a)},n$a.do7=function(){var n$a=n$ua.mainContext;n$a.colorMask(!1,!1,!1,!1),n$a.stencilOp(7680,7680,7683)},n$a.do8=function(){var n$a=n$ua.mainContext;n$a.colorMask(!0,!0,!0,!0),n$a.stencilFunc(514,this.level,255),n$a.stencilOp(7680,7680,7680)},n$i.restore=function(n$a,n$b,n$c,n$d,n$e){var n$f;if((n$a._renderKey=0)<n$i._mask&&n$i._mask--,0==n$i._mask)n$f=laya.webgl.submit.SubmitStencil.create(3),n$a.addRenderObject(n$f),n$a._curSubmit=n$fa.RENDERBASE;else{n$f=laya.webgl.submit.SubmitStencil.create(7),n$a.addRenderObject(n$f);var n$g=n$a._vb;n$g._byteLength;if(n$qa.fillRectImgVb(n$g,null,n$b.x,n$b.y,n$b.width,n$b.height,n$K.DEF_UV,n$c,n$d,n$e,0,0)){n$a._shader2D.glTexture=null;var n$h=n$a._curSubmit=n$fa.createSubmit(n$a,n$a._ib,n$g,(n$g._byteLength-64)/32*3,n$ya.create(2,0));n$h.shaderValue.ALPHA=1,n$a._submits[n$a._submits._length++]=n$h,n$a._curSubmit._numEle+=6,n$a._curSubmit=n$fa.RENDERBASE}else alert("clipRect calc stencil rect error");n$f=laya.webgl.submit.SubmitStencil.create(8),n$a.addRenderObject(n$f)}},n$i.restore2=function(n$a,n$b){var n$c;(n$a._renderKey=0)<n$i._mask&&n$i._mask--,0==n$i._mask?(n$c=laya.webgl.submit.SubmitStencil.create(3),n$a.addRenderObject(n$c),n$a._curSubmit=n$fa.RENDERBASE):(n$c=laya.webgl.submit.SubmitStencil.create(7),n$a.addRenderObject(n$c),n$a._submits[n$a._submits._length++]=n$b,n$c=laya.webgl.submit.SubmitStencil.create(8),n$a.addRenderObject(n$c))},n$i.create=function(n$a){var n$b=n$i._cache._length?n$i._cache[--n$i._cache._length]:new n$i;return 5==(n$b.step=n$a)&&++n$i._mask,n$b.level=n$i._mask,n$b},n$i._cache=((n$i._cache=[])._length=0,n$i._cache),n$i._mask=0,n$i}(),n$la=function(){function n$h(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}n$m(n$h,"laya.webgl.submit.SubmitTarget");var n$a=n$h.prototype;return n$w.imps(n$a,{"laya.webgl.submit.ISubmit":!0}),n$a.renderSubmit=function(){this._vb.bind_upload(this._ib);var n$a=this.scope.getValue(this.proName);return n$a&&(this.shaderValue.texture=n$a.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[n$a.width,n$a.height]),this.shaderValue.upload(),this.blend(),n$G.drawCall++,n$G.trianglesFaces+=this._numEle/3,n$ua.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},n$a.blend=function(){if(n$S.activeBlendFunction!==n$S.fns[this.blendType]){var n$a=n$ua.mainContext;n$a.enable(3042),n$S.fns[this.blendType](n$a),n$S.activeBlendFunction=n$S.fns[this.blendType]}},n$a.getRenderType=function(){return 0},n$a.releaseRender=function(){var n$a=n$h._cache;(n$a[n$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},n$h.create=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=n$h._cache._length?n$h._cache[--n$h._cache._length]:new n$h;return n$g._ib=n$b,n$g._vb=n$c,n$g.proName=n$f,n$g._startIdx=n$d*n$pa.BYTES_PIDX,n$g._numEle=0,n$g.blendType=n$a._nBlendType,n$g.shaderValue=n$e,n$g.shaderValue.setValue(n$a._shader2D),n$g},n$h._cache=((n$h._cache=[])._length=0,n$h._cache),n$h}(),n$ma=function(){function n$a(){this._sourceStr=null}n$m(n$a,"laya.webgl.text.CharSegment");var n$b=n$a.prototype;return n$w.imps(n$b,{"laya.webgl.text.ICharSegment":!0}),n$b.textToSpit=function(n$a){this._sourceStr=n$a},n$b.getChar=function(n$a){return this._sourceStr.charAt(n$a)},n$b.getCharCode=function(n$a){return this._sourceStr.charCodeAt(n$a)},n$b.length=function(){return this._sourceStr.length},n$a}(),n$na=function(){var n$a;function n$G(){}return n$m(n$G,"laya.webgl.text.DrawText"),n$G.__init__=function(){n$G._charsTemp=new Array,n$G._drawValue=new n$a,n$G._charSeg=new n$ma},n$G.customCharSeg=function(n$a){n$G._charSeg=n$a},n$G.getChar=function(n$a,n$b,n$c){var n$d=n$Va.createOneChar(n$a,n$c);return-1!=n$b&&(n$G._charsCache[n$b]=n$d),n$d},n$G._drawSlow=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$l,n$m,n$n,n$o){var n$p,n$q,n$r=n$G._drawValue.value(n$f,n$h,n$i,n$j,n$m,n$n,n$o),n$s=0,n$t=0,n$u=n$G._charsTemp,n$v=0,n$w=NaN;if(n$d)for(n$u.length=n$d.length,n$s=0,n$t=n$d.length;n$s<n$t;n$s++)(n$q=n$d[n$s])&&(n$w=n$q.charNum+n$r.txtID,n$u[n$s]=n$p=n$G._charsCache[n$w]||n$G.getChar(n$q.char,n$w,n$r),n$p.active());else{var n$x=n$c instanceof laya.utils.WordText?n$c.toString():n$c;if(n$J.CharacterCache){n$G._charSeg.textToSpit(n$x);var n$y=n$G._charSeg.length();for(n$s=0,n$t=n$u.length=n$y;n$s<n$t;n$s++)n$w=n$G._charSeg.getCharCode(n$s)+n$r.txtID,n$u[n$s]=n$p=n$G._charsCache[n$w]||n$G.getChar(n$G._charSeg.getChar(n$s),n$w,n$r),n$p.active(),n$v+=n$p.cw}else n$u.length=0,(n$p=n$G.getChar(n$x,-1,n$r)).active(),n$v+=n$p.cw,n$u[0]=n$p}var n$z=0;null!==n$g&&"left"!==n$g&&(n$z=-("center"==n$g?n$v/2:n$v));var n$C,n$D,n$E=NaN,n$F=0;if(n$d)for(n$s=0,n$t=n$u.length;n$s<n$t;n$s++)n$p=n$u[n$s],n$q=n$d[n$s],n$p&&n$q&&!n$p.isSpace&&(n$E=n$p.borderSize,n$C=n$p.texture,n$b._drawText(n$C,n$k+n$z+n$q.x*n$m-n$E,n$l+n$q.y*n$n-n$E,n$C.width,n$C.height,n$e,0,0,0,0));else{for(n$s=0,n$t=n$u.length;n$s<n$t;n$s++)(n$p=n$u[n$s])&&!n$p.isSpace&&(n$E=n$p.borderSize,n$C=n$p.texture,n$b._drawText(n$C,n$k+n$z-n$E,n$l-n$E,n$C.width,n$C.height,n$e,0,0,0,0),n$a&&((n$D=n$a[n$F++])||(n$D=n$a[n$F-1]=[]),n$D[0]=n$C,n$D[1]=n$z-n$E,n$D[2]=-n$E)),n$z+=n$p.cw;n$a&&(n$a.length=n$F)}},n$G._drawFast=function(n$a,n$b,n$c,n$d,n$e){for(var n$f,n$g,n$h=0,n$i=n$a.length;n$h<n$i;n$h++)(n$f=(n$g=n$a[n$h])[0]).active(),n$b._drawText(n$f,n$d+n$g[1],n$e+n$g[2],n$f.width,n$f.height,n$c,0,0,0,0)},n$G.drawText=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$l){if(void 0===n$l&&(n$l=0),!(n$b&&0===n$b.length||n$c&&0===n$c.length)){var n$m=n$d.a,n$n=n$d.d;(0!==n$d.b||0!==n$d.c)&&(n$m=n$n=1);var n$o=1!==n$m||1!==n$n;if(n$o&&n$w.stage.transform){var n$p=n$w.stage.transform;n$o=n$p.a===n$m&&n$p.d===n$n}else n$o=!1;if(n$o){var n$q=(n$d=n$d.copyTo(n$xa._tmpMatrix)).tx,n$r=n$d.ty;n$d.scale(1/n$m,1/n$n),n$d._checkTransform(),n$j*=n$m,n$k*=n$n,n$j+=n$q-n$d.tx,n$k+=n$r-n$d.ty}else n$m=n$n=1;if(n$c)n$G._drawSlow(null,n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$m,n$n,n$l);else{if(null===n$b.toUpperCase){var n$s=n$m+1e5*n$n,n$t=n$b;return void(n$t.changed||n$t.id!==n$s?(n$t.id=n$s,n$t.changed=!1,n$G._drawSlow(n$t.save,n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$m,n$n,n$l)):n$G._drawFast(n$t.save,n$a,n$d,n$j,n$k))}var n$u=n$b+n$e.toString()+n$g+n$h+n$i+n$m+n$n+n$f,n$v=n$G._textsCache[n$u];n$J.CharacterCache?n$v?n$G._drawFast(n$v,n$a,n$d,n$j,n$k):(n$G._textsCache.__length||(n$G._textsCache.__length=0),n$G._textsCache.__length>n$x.WebGLTextCacheCount&&((n$G._textsCache={}).__length=0,n$G._curPoolIndex=0),n$G._textCachesPool[n$G._curPoolIndex]?(n$v=n$G._textsCache[n$u]=n$G._textCachesPool[n$G._curPoolIndex]).length=0:n$G._textCachesPool[n$G._curPoolIndex]=n$v=n$G._textsCache[n$u]=[],n$G._textsCache.__length++,n$G._curPoolIndex++,n$G._drawSlow(n$v,n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$m,n$n,n$l)):n$G._drawSlow(n$v,n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$m,n$n,n$l)}}},n$G._charsTemp=null,n$G._textCachesPool=[],n$G._curPoolIndex=0,n$G._charsCache={},n$G._textsCache={},n$G._drawValue=null,n$G.d=[],n$G._charSeg=null,n$G.__init$=function(){n$a=function(){function n$i(){}return n$m(n$i,""),n$i.prototype.value=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this.font=n$a,this.fillColor=n$b,this.borderColor=n$c,this.lineWidth=n$d,this.scaleX=n$e,this.scaleY=n$f,this.underLine=n$g;var n$h=n$a.toString()+n$e+n$f+n$d+(n$b?n$b.toLowerCase():" ")+(n$c?n$c.toLowerCase():" ")+n$g;return this.txtID=n$i._keymap[n$h],this.txtID||(this.txtID=1e-7*++n$i._keymapCount,n$i._keymap[n$h]=this.txtID),this},n$i.clear=function(){n$i._keymap={},n$i._keymapCount=1},n$i._keymap={},n$i._keymapCount=1,n$i}()},n$G}(),n$oa=function(){function n$e(n$a){this._index=0,this._size=14,this._italic=-2,n$e._cache2=n$e._cache2||[],this.setFont(n$a||"14px Arial")}n$m(n$e,"laya.webgl.text.FontInContext");var n$a=n$e.prototype;return n$a.setFont=function(n$a){var n$b=n$e._cache2[n$a];if(n$b)this._words=n$b[0],this._size=n$b[1];else{this._words=n$a.split(" ");for(var n$c=0,n$d=this._words.length;n$c<n$d;n$c++)if(0<this._words[n$c].indexOf("px")){this._index=n$c;break}this._size=parseInt(this._words[this._index]),n$e._cache2[n$a]=[this._words,this._size]}this._text=null,this._italic=-2},n$a.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},n$a.hasType=function(n$a){for(var n$b=0,n$c=this._words.length;n$b<n$c;n$b++)if(this._words[n$b]===n$a)return n$b;return-1},n$a.removeType=function(n$a){for(var n$b=0,n$c=this._words.length;n$b<n$c;n$b++)if(this._words[n$b]===n$a){this._words.splice(n$b,1),this._index>n$b&&this._index--;break}this._text=null,this._italic=-2},n$a.copyTo=function(n$a){return n$a._text=this._text,n$a._size=this._size,n$a._index=this._index,n$a._words=this._words.slice(),n$a._italic=-2,n$a},n$a.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},n$d(0,n$a,"size",function(){return this._size},function(n$a){this._size=n$a,this._words[this._index]=n$a+"px",this._text=null}),n$e.create=function(n$a){var n$b=n$e._cache[n$a];return n$b||(n$b=n$e._cache[n$a]=new n$e(n$a))},n$e.EMPTY=new n$e,n$e._cache={},n$e._cache2=null,n$e}(),n$pa=function(){function n$a(){}return n$m(n$a,"laya.webgl.utils.CONST3D2D"),n$a.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n$a.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],n$a.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],n$a._TMPARRAY=[],n$a._OFFSETX=0,n$a._OFFSETY=0,n$g(n$a,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),n$a}(),n$qa=function(){function n$o(){}return n$m(n$o,"laya.webgl.utils.GlUtils"),n$o.make2DProjection=function(n$a,n$b,n$c){return[2/n$a,0,0,0,0,-2/n$b,0,0,0,0,2/n$c,0,-1,1,0,1]},n$o.fillIBQuadrangle=function(n$a,n$b){if(65535/4<n$b)throw Error("IBQuadrangle count:"+n$b+" must<:"+Math.floor(65535/4));n$b=Math.floor(n$b),n$a._resizeBuffer(6*(n$b+1)*2,!1),n$a.byteLength=n$a.bufferLength;for(var n$c=n$a.getUint16Array(),n$d=0,n$e=0;n$e<n$b;n$e++)n$c[n$d++]=4*n$e,n$c[n$d++]=4*n$e+2,n$c[n$d++]=4*n$e+1,n$c[n$d++]=4*n$e,n$c[n$d++]=4*n$e+3,n$c[n$d++]=4*n$e+2;return n$a.setNeedUpload(),!0},n$o.expandIBQuadrangle=function(n$a,n$b){n$a.bufferLength>=6*n$b*2||n$o.fillIBQuadrangle(n$a,n$b)},n$o.mathCeilPowerOfTwo=function(n$a){return n$a--,n$a|=n$a>>1,n$a|=n$a>>2,n$a|=n$a>>4,n$a|=n$a>>8,n$a|=n$a>>16,++n$a},n$o.fillQuadrangleImgVb=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){var n$i=16+(n$a._byteLength>>2);n$a.byteLength=n$i<<2;var n$j=n$a.getFloat32Array();n$j[(n$i-=16)+2]=n$e[0],n$j[n$i+3]=n$e[1],n$j[n$i+6]=n$e[2],n$j[n$i+7]=n$e[3],n$j[n$i+10]=n$e[4],n$j[n$i+11]=n$e[5],n$j[n$i+14]=n$e[6],n$j[n$i+15]=n$e[7];var n$k=n$f.a,n$l=n$f.b,n$m=n$f.c,n$n=n$f.d;if(1!==n$k||0!==n$l||0!==n$m||1!==n$n){n$f.bTransform=!0;var n$o=n$f.tx+n$g,n$p=n$f.ty+n$h;n$j[n$i]=(n$d[0]+n$b)*n$k+(n$d[1]+n$c)*n$m+n$o,n$j[n$i+1]=(n$d[0]+n$b)*n$l+(n$d[1]+n$c)*n$n+n$p,n$j[n$i+4]=(n$d[2]+n$b)*n$k+(n$d[3]+n$c)*n$m+n$o,n$j[n$i+5]=(n$d[2]+n$b)*n$l+(n$d[3]+n$c)*n$n+n$p,n$j[n$i+8]=(n$d[4]+n$b)*n$k+(n$d[5]+n$c)*n$m+n$o,n$j[n$i+9]=(n$d[4]+n$b)*n$l+(n$d[5]+n$c)*n$n+n$p,n$j[n$i+12]=(n$d[6]+n$b)*n$k+(n$d[7]+n$c)*n$m+n$o,n$j[n$i+13]=(n$d[6]+n$b)*n$l+(n$d[7]+n$c)*n$n+n$p}else n$f.bTransform=!1,n$b+=n$f.tx+n$g,n$c+=n$f.ty+n$h,n$j[n$i]=n$b+n$d[0],n$j[n$i+1]=n$c+n$d[1],n$j[n$i+4]=n$b+n$d[2],n$j[n$i+5]=n$c+n$d[3],n$j[n$i+8]=n$b+n$d[4],n$j[n$i+9]=n$c+n$d[5],n$j[n$i+12]=n$b+n$d[6],n$j[n$i+13]=n$c+n$d[7];return n$a._upload=!0},n$o.fillTranglesVB=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){var n$h=(n$a._byteLength>>2)+n$d.length;n$a.byteLength=n$h<<2;var n$i=n$a.getFloat32Array();n$h-=n$d.length;for(var n$j=n$d.length,n$k=n$e.a,n$l=n$e.b,n$m=n$e.c,n$n=n$e.d,n$o=0;n$o<n$j;n$o+=4)if(n$i[n$h+n$o+2]=n$d[n$o+2],n$i[n$h+n$o+3]=n$d[n$o+3],1!==n$k||0!==n$l||0!==n$m||1!==n$n){n$e.bTransform=!0;var n$p=n$e.tx+n$f,n$q=n$e.ty+n$g;n$i[n$h+n$o]=(n$d[n$o]+n$b)*n$k+(n$d[n$o+1]+n$c)*n$m+n$p,n$i[n$h+n$o+1]=(n$d[n$o]+n$b)*n$l+(n$d[n$o+1]+n$c)*n$n+n$q}else n$e.bTransform=!1,n$b+=n$e.tx+n$f,n$c+=n$e.ty+n$g,n$i[n$h+n$o]=n$b+n$d[n$o],n$i[n$h+n$o+1]=n$c+n$d[n$o+1];return n$a._upload=!0},n$o.copyPreImgVb=function(n$a,n$b,n$c){var n$d=n$a._byteLength>>2;n$a.byteLength=n$d+16<<2;for(var n$e=n$a.getFloat32Array(),n$f=0,n$g=n$d-16;n$f<4;n$f++)n$e[n$d]=n$e[n$g]+n$b,++n$g,n$e[++n$d]=n$e[n$g]+n$c,++n$g,n$e[++n$d]=n$e[n$g],++n$g,n$e[++n$d]=n$e[n$g],++n$d,++n$g;n$a._upload=!0},n$o.fillRectImgVb=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$l,n$m){void 0===n$m&&(n$m=!1);var n$n,n$o,n$p,n$q,n$r,n$s,n$t,n$u,n$v,n$w,n$x,n$y,n$z,n$C,n$D,n$E,n$F=1,n$G=n$h.a,n$H=n$h.b,n$I=n$h.c,n$J=n$h.d,n$K=n$b&&n$b.width<99999999;if(1!==n$G||0!==n$H||0!==n$I||1!==n$J?(n$h.bTransform=!0,0===n$H&&0===n$I&&(n$F=23,n$v=n$e+n$c,n$w=n$f+n$d,n$n=n$G*n$c+(n$x=n$h.tx+n$i),n$p=n$G*n$v+n$x,n$o=n$J*n$d+(n$y=n$h.ty+n$j),n$q=n$J*n$w+n$y)):(n$F=23,n$h.bTransform=!1,n$p=(n$n=n$c+n$h.tx+n$i)+n$e,n$q=(n$o=n$d+n$h.ty+n$j)+n$f),n$K&&(n$r=n$b.x,n$s=n$b.y,n$t=n$b.width+n$r,n$u=n$b.height+n$s),1!==n$F){if(Math.min(n$n,n$p)>=n$t)return!1;if(Math.min(n$o,n$q)>=n$u)return!1;if(Math.max(n$p,n$n)<=n$r)return!1;if(Math.max(n$q,n$o)<=n$s)return!1}var n$L=n$a._byteLength>>2;n$a.byteLength=16+n$L<<2;var n$M=n$a.getFloat32Array();switch(n$M[2+n$L]=n$g[0],n$M[3+n$L]=n$g[1],n$M[6+n$L]=n$g[2],n$M[7+n$L]=n$g[3],n$M[10+n$L]=n$g[4],n$M[11+n$L]=n$g[5],n$M[14+n$L]=n$g[6],n$M[15+n$L]=n$g[7],n$F){case 1:n$x=n$h.tx+n$i,n$y=n$h.ty+n$j;var n$N=n$G*n$c,n$O=n$I*n$d,n$P=n$J*n$d,n$Q=n$H*n$c,n$R=n$G*(n$v=n$e+n$c),n$S=n$I*(n$w=n$f+n$d),n$T=n$J*n$w,n$U=n$H*n$v;n$m?(n$z=n$N+n$O+n$x,n$D=Math.round(n$z)-n$z,n$C=n$P+n$Q+n$y,n$E=Math.round(n$C)-n$C,n$M[n$L]=n$z+n$D,n$M[1+n$L]=n$C+n$E,n$M[4+n$L]=n$R+n$O+n$x+n$D,n$M[5+n$L]=n$P+n$U+n$y+n$E,n$M[8+n$L]=n$R+n$S+n$x+n$D,n$M[9+n$L]=n$T+n$U+n$y+n$E,n$M[12+n$L]=n$N+n$S+n$x+n$D,n$M[13+n$L]=n$T+n$Q+n$y+n$E):(n$M[n$L]=n$N+n$O+n$x,n$M[1+n$L]=n$P+n$Q+n$y,n$M[4+n$L]=n$R+n$O+n$x,n$M[5+n$L]=n$P+n$U+n$y,n$M[8+n$L]=n$R+n$S+n$x,n$M[9+n$L]=n$T+n$U+n$y,n$M[12+n$L]=n$N+n$S+n$x,n$M[13+n$L]=n$T+n$Q+n$y);break;case 23:n$m?(n$z=n$n+n$k,n$D=Math.round(n$z)-n$z,n$C=n$o,n$E=Math.round(n$C)-n$C,n$M[n$L]=n$z+n$D,n$M[1+n$L]=n$C+n$E,n$M[4+n$L]=n$p+n$k+n$D,n$M[5+n$L]=n$o+n$E,n$M[8+n$L]=n$p+n$D,n$M[9+n$L]=n$q+n$E,n$M[12+n$L]=n$n+n$D,n$M[13+n$L]=n$q+n$E):(n$M[n$L]=n$n+n$k,n$M[1+n$L]=n$o,n$M[4+n$L]=n$p+n$k,n$M[5+n$L]=n$o,n$M[8+n$L]=n$p,n$M[9+n$L]=n$q,n$M[12+n$L]=n$n,n$M[13+n$L]=n$q)}return n$a._upload=!0},n$o.fillLineVb=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){var n$i=.5*n$g,n$j=n$o._fillLineArray,n$k=-(n$d-n$f),n$l=n$c-n$e,n$m=Math.sqrt(n$k*n$k+n$l*n$l);n$k/=n$m,n$l/=n$m,n$k*=n$i,n$l*=n$i,n$j[0]=n$c-n$k,n$j[1]=n$d-n$l,n$j[4]=n$c+n$k,n$j[5]=n$d+n$l,n$j[8]=n$e+n$k,n$j[9]=n$f+n$l,n$j[12]=n$e-n$k,n$j[13]=n$f-n$l,n$h&&n$h.transformPointArray(n$j,n$j);var n$n=16+(n$a._byteLength>>2);return n$a.byteLength=n$n<<2,n$a.insertData(n$j,n$n-16),!0},n$o._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n$o}(),n$ra=(function(){function n$i(){}n$m(n$i,"laya.webgl.utils.MatirxArray"),n$i.ArrayMul=function(n$a,n$b,n$c){if(n$a)if(n$b)for(var n$d=NaN,n$e=NaN,n$f=NaN,n$g=NaN,n$h=0;n$h<4;n$h++)n$d=n$a[n$h],n$e=n$a[n$h+4],n$f=n$a[n$h+8],n$g=n$a[n$h+12],n$c[n$h]=n$d*n$b[0]+n$e*n$b[1]+n$f*n$b[2]+n$g*n$b[3],n$c[n$h+4]=n$d*n$b[4]+n$e*n$b[5]+n$f*n$b[6]+n$g*n$b[7],n$c[n$h+8]=n$d*n$b[8]+n$e*n$b[9]+n$f*n$b[10]+n$g*n$b[11],n$c[n$h+12]=n$d*n$b[12]+n$e*n$b[13]+n$f*n$b[14]+n$g*n$b[15];else n$i.copyArray(n$a,n$c);else n$i.copyArray(n$b,n$c)},n$i.copyArray=function(n$a,n$b){if(n$a&&n$b)for(var n$c=0;n$c<n$a.length;n$c++)n$b[n$c]=n$a[n$c]}}(),function(){function n$b(n$a,n$b,n$c){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=n$a,this._vb=new n$Ba(n$a,35048),n$b&&this._vb._resizeBuffer(n$b,!1),this._ib=new n$Aa,n$c&&this._ib._resizeBuffer(n$c,!1)}n$m(n$b,"laya.webgl.utils.Mesh2D");var n$a=n$b.prototype;return n$a.cloneWithNewVB=function(){var n$a=new n$b(this._stride,0,0);return n$a._ib=this._ib,n$a._quadNum=this._quadNum,n$a._attribInfo=this._attribInfo,n$a},n$a.cloneWithNewVBIB=function(){var n$a=new n$b(this._stride,0,0);return n$a._attribInfo=this._attribInfo,n$a},n$a.getVBW=function(){return this._vb.setNeedUpload(),this._vb},n$a.getVBR=function(){return this._vb},n$a.getIBR=function(){return this._ib},n$a.getIBW=function(){return this._ib.setNeedUpload(),this._ib},n$a.createQuadIB=function(n$a){this._quadNum=n$a,this._ib._resizeBuffer(6*n$a*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var n$b=this._ib.getUint16Array(),n$c=0,n$d=0,n$e=0;n$e<n$a;n$e++)n$b[n$c++]=n$d,n$b[n$c++]=n$d+2,n$b[n$c++]=n$d+1,n$b[n$c++]=n$d,n$b[n$c++]=n$d+3,n$b[n$c++]=n$d+2,n$d+=4;this._ib.setNeedUpload()},n$a.setAttributes=function(n$a){if(this._attribInfo=n$a,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},n$a.getEleNum=function(){return this._ib.getBuffer().byteLength/2},n$a.releaseMesh=function(){},n$a.destroy=function(){},n$a.clearVB=function(){this._vb.clear()},n$b._gvaoid=0,n$b}()),n$sa=function(){function n$e(){}return n$m(n$e,"laya.webgl.utils.RenderState2D"),n$e.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},n$e.mat2MatArray=function(n$a,n$b){var n$c=n$a,n$d=n$b;return n$d[0]=n$c.a,n$d[1]=n$c.b,n$d[2]=n$e.EMPTYMAT4_ARRAY[2],n$d[3]=n$e.EMPTYMAT4_ARRAY[3],n$d[4]=n$c.c,n$d[5]=n$c.d,n$d[6]=n$e.EMPTYMAT4_ARRAY[6],n$d[7]=n$e.EMPTYMAT4_ARRAY[7],n$d[8]=n$e.EMPTYMAT4_ARRAY[8],n$d[9]=n$e.EMPTYMAT4_ARRAY[9],n$d[10]=n$e.EMPTYMAT4_ARRAY[10],n$d[11]=n$e.EMPTYMAT4_ARRAY[11],n$d[12]=n$c.tx,n$d[13]=n$c.ty,n$d[14]=n$e.EMPTYMAT4_ARRAY[14],n$d[15]=n$e.EMPTYMAT4_ARRAY[15],n$b},n$e.restoreTempArray=function(){n$e.TEMPMAT4_ARRAY[0]=1,n$e.TEMPMAT4_ARRAY[1]=0,n$e.TEMPMAT4_ARRAY[4]=0,n$e.TEMPMAT4_ARRAY[5]=1,n$e.TEMPMAT4_ARRAY[12]=0,n$e.TEMPMAT4_ARRAY[13]=0},n$e.clear=function(){n$e.worldScissorTest=!1,n$e.worldShaderDefines=null,n$e.worldFilters=null,n$e.worldAlpha=1,n$e.worldClipRect.x=n$e.worldClipRect.y=0,n$e.worldClipRect.width=n$e.width,n$e.worldClipRect.height=n$e.height,n$e.curRenderTarget=null},n$e._MAXSIZE=99999999,n$e.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n$e.worldMatrix4=n$e.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n$e.worldAlpha=1,n$e.worldScissorTest=!1,n$e.worldFilters=null,n$e.worldShaderDefines=null,n$e.curRenderTarget=null,n$e.width=0,n$e.height=0,n$g(n$e,["worldMatrix",function(){return this.worldMatrix=new n$z},"worldClipRect",function(){return this.worldClipRect=new n$D(0,0,99999999,99999999)}]),n$e}(),n$ta=function(){var n$s,n$c;function n$t(n$a,n$b,n$c,n$d,n$e){var n$f=this;function n$g(n$a){var n$b=[],n$c=new n$s(n$b);return n$f._compileToTree(n$c,n$a.split("\n"),0,n$b,n$e),n$c}var n$h=n$n.now();this._VS=n$g(n$b),this._PS=n$g(n$c),this._nameMap=n$d,2<n$n.now()-n$h&&console.log("ShaderCompile use time:"+(n$n.now()-n$h)+"  size:"+n$b.length+"/"+n$c.length)}n$m(n$t,"laya.webgl.utils.ShaderCompile");var n$a=n$t.prototype;return n$a._compileToTree=function(n$a,n$b,n$c,n$d,n$e){var n$f,n$g,n$h,n$i,n$j,n$k,n$l,n$m=0,n$n=0,n$o=0,n$p=0;for(n$n=n$c;n$n<n$b.length;n$n++)if(!((n$h=n$b[n$n]).length<1)&&0!==(n$m=n$h.indexOf("//"))){if(0<=n$m&&(n$h=n$h.substr(0,n$m)),n$f=n$l||new n$s(n$d),n$l=null,n$f.text=n$h,n$f.noCompile=!0,0<=(n$m=n$h.indexOf("#"))){for(n$i="#",n$p=n$m+1,n$o=n$h.length;n$p<n$o;n$p++){var n$q=n$h.charAt(n$p);if(" "===n$q||"\t"===n$q||"\r"===n$q||"\n"===n$q||"?"===n$q)break;n$i+=n$q}switch(n$f.name=n$i){case"#ifdef":case"#ifndef":if(n$f.src=n$h,n$f.noCompile=null!=n$h.match(/[!&|()=<>]/),n$f.noCompile?console.log("function():Boolean{return "+n$h.substr(n$m+n$f.name.length)+"}"):(n$k=n$h.replace(/^\s*/,"").split(/\s+/),n$f.setCondition(n$k[1],"#ifdef"===n$i?1:2),n$f.text="//"+n$f.text),n$f.setParent(n$a),n$a=n$f,n$e)for(n$k=n$h.substr(n$p).split(n$t._splitToWordExps3),n$p=0;n$p<n$k.length;n$p++)(n$h=n$k[n$p]).length&&(n$e[n$h]=!0);continue;case"#if":if(n$f.src=n$h,n$f.noCompile=!0,n$f.setParent(n$a),n$a=n$f,n$e)for(n$k=n$h.substr(n$p).split(n$t._splitToWordExps3),n$p=0;n$p<n$k.length;n$p++)(n$h=n$k[n$p]).length&&"defined"!=n$h&&(n$e[n$h]=!0);continue;case"#else":n$f.src=n$h,n$g=(n$a=n$a.parent).childs[n$a.childs.length-1],n$f.noCompile=n$g.noCompile,n$f.noCompile||(n$f.condition=n$g.condition,n$f.conditionType=1==n$g.conditionType?2:1,n$f.text="//"+n$f.text+" "+n$g.text+" "+n$f.conditionType),n$f.setParent(n$a),n$a=n$f;continue;case"#endif":n$g=(n$a=n$a.parent).childs[n$a.childs.length-1],n$f.noCompile=n$g.noCompile,n$f.noCompile||(n$f.text="//"+n$f.text),n$f.setParent(n$a);continue;case"#include":n$k=n$t.splitToWords(n$h,null);var n$r=n$t.includes[n$k[1]];if(!n$r)throw"ShaderCompile error no this include file:"+n$k[1];if((n$m=n$k[0].indexOf("?"))<0){n$f.setParent(n$a),n$h=n$r.getWith("with"==n$k[2]?n$k[3]:null),this._compileToTree(n$f,n$h.split("\n"),0,n$d,n$e),n$f.text="";continue}n$f.setCondition(n$k[0].substr(n$m+1),1),n$f.text=n$r.getWith("with"==n$k[2]?n$k[3]:null);break;case"#import":n$j=(n$k=n$t.splitToWords(n$h,null))[1],n$d.push({node:n$f,file:n$t.includes[n$j],ofs:n$f.text.length});continue}}else{if((n$g=n$a.childs[n$a.childs.length-1])&&!n$g.name){0<n$d.length&&n$t.splitToWords(n$h,n$g),n$l=n$f,n$g.text+="\n"+n$h;continue}0<n$d.length&&n$t.splitToWords(n$h,n$f)}n$f.setParent(n$a)}},n$a.createShader=function(n$a,n$b,n$c){var n$d={},n$e="";if(n$a)for(var n$f in n$a)n$e+="#define "+n$f+"\n",n$d[n$f]=!0;var n$g=this._VS.toscript(n$d,[]),n$h=this._PS.toscript(n$d,[]);return(n$c||n$Ya.create)(n$e+n$g.join("\n"),n$e+n$h.join("\n"),n$b,this._nameMap)},n$t._parseOne=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g={type:n$t.shaderParamsMap[n$c[n$d+1]],name:n$c[n$d+2],size:isNaN(parseInt(n$c[n$d+3]))?1:parseInt(n$c[n$d+3])};return n$f&&("attribute"==n$e?n$a.push(n$g):n$b.push(n$g)),":"==n$c[n$d+3]&&(n$g.type=n$c[n$d+4],n$d+=2),n$d+=2},n$t.addInclude=function(n$a,n$b){if(!n$b||0===n$b.length)throw new Error("add shader include file err:"+n$a);if(n$t.includes[n$a])throw new Error("add shader include file err, has add:"+n$a);n$t.includes[n$a]=new n$c(n$b)},n$t.preGetParams=function(n$a,n$b){var n$c=[n$a,n$b],n$d={},n$e=[],n$f=[],n$g={},n$h=[];n$d.attributes=n$e,n$d.uniforms=n$f,n$d.defines=n$g;for(var n$i=0,n$j=0,n$k=0;n$k<2;n$k++){n$c[n$k]=n$c[n$k].replace(n$t._removeAnnotation,"");var n$l,n$m=n$c[n$k].match(n$t._reg);for(n$i=0,n$j=n$m.length;n$i<n$j;n$i++){var n$n=n$m[n$i];if("attribute"==n$n||"uniform"==n$n)n$i=n$t._parseOne(n$e,n$f,n$m,n$i,n$n,!0);else{if("#define"==n$n){n$h[n$n=n$m[++n$i]]=1;continue}if("#ifdef"==n$n){n$g[n$l=n$m[++n$i]]=n$g[n$l]||[];for(n$i++;n$i<n$j;n$i++)if("attribute"==(n$n=n$m[n$i])||"uniform"==n$n)n$i=n$t._parseOne(n$e,n$f,n$m,n$i,n$n,n$h[n$l]);else if("#else"==n$n)for(n$i++;n$i<n$j;n$i++)if("attribute"==(n$n=n$m[n$i])||"uniform"==n$n)n$i=n$t._parseOne(n$e,n$f,n$m,n$i,n$n,!n$h[n$l]);else if("#endif"==n$n)break}}}}return n$d},n$t.splitToWords=function(n$a,n$b){for(var n$c,n$d,n$e=[],n$f=-1,n$g=0,n$h=n$a.length;n$g<n$h;n$g++)if(n$c=n$a.charAt(n$g),0<=" \t=+-*/&%!<>()'\",;".indexOf(n$c)){if(0<=n$f&&1<n$g-n$f&&(n$d=n$a.substr(n$f,n$g-n$f),n$e.push(n$d)),'"'==n$c||"'"==n$c){var n$i=n$a.indexOf(n$c,n$g+1);if(n$i<0)throw"Sharder err:"+n$a;n$e.push(n$a.substr(n$g+1,n$i-n$g-1)),n$g=n$i,n$f=-1;continue}"("==n$c&&n$b&&0<n$e.length&&(n$d=n$e[n$e.length-1]+";","vec4;main;".indexOf(n$d)<0&&(n$b.useFuns+=n$d)),n$f=-1}else n$f<0&&(n$f=n$g);return n$f<n$h&&1<n$h-n$f&&(n$d=n$a.substr(n$f,n$h-n$f),n$e.push(n$d)),n$e},n$t.IFDEF_NO=0,n$t.IFDEF_YES=1,n$t.IFDEF_ELSE=2,n$t.IFDEF_PARENT=3,n$t._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),n$t._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),n$t._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),n$t.includes={},n$g(n$t,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),n$t.__init$=function(){n$s=function(){function n$c(n$a){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=n$a}n$m(n$c,"");var n$a=n$c.prototype;return n$a.setParent=function(n$a){n$a.childs.push(this),this.z=n$a.z+1,this.parent=n$a},n$a.setCondition=function(n$a,n$b){n$a&&(this.conditionType=n$b,n$a=n$a.replace(/(\s*$)/g,""),this.condition=function(){return this[n$a]},this.condition.__condition=n$a)},n$a.toscript=function(n$a,n$b){return this._toscript(n$a,n$b,++n$c.__id)},n$a._toscript=function(n$d,n$e,n$f){if(this.childs.length<1&&!this.text)return n$e;n$e.length;if(this.condition){var n$a=!!this.condition.call(n$d);if(2===this.conditionType&&(n$a=!n$a),!n$a)return n$e}if(this.text&&n$e.push(this.text),0<this.childs.length&&this.childs.forEach(function(n$a,n$b,n$c){n$a._toscript(n$d,n$e,n$f)}),0<this.includefiles.length&&0<this.useFuns.length)for(var n$b,n$c=0,n$g=this.includefiles.length;n$c<n$g;n$c++)this.includefiles[n$c].curUseID!=n$f&&0<(n$b=this.includefiles[n$c].file.getFunsScript(this.useFuns)).length&&(this.includefiles[n$c].curUseID=n$f,n$e[0]=n$b+n$e[0]);return n$e},n$c.__id=1,n$c}(),n$c=function(){function n$a(n$a){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=n$a;for(var n$b=0,n$c=0,n$d=0;!((n$b=n$a.indexOf("#begin",n$b))<0);){for(n$d=n$b+5;!((n$d=n$a.indexOf("#end",n$d))<0)&&"i"===n$a.charAt(n$d+4);)n$d+=5;if(n$d<0)throw"add include err,no #end:"+n$a;n$c=n$a.indexOf("\n",n$b);var n$e=n$t.splitToWords(n$a.substr(n$b,n$c-n$b),null);"code"==n$e[1]?this.codes[n$e[2]]=n$a.substr(n$c+1,n$d-n$c-1):"function"==n$e[1]&&(n$c=n$a.indexOf("function",n$b),n$c+="function".length,this.funs[n$e[3]]=n$a.substr(n$c+1,n$d-n$c-1),this.funnames+=n$e[3]+";"),n$b=n$d+1}}n$m(n$a,"");var n$b=n$a.prototype;return n$b.getWith=function(n$a){var n$b=n$a?this.codes[n$a]:this.script;if(!n$b)throw"get with error:"+n$a;return n$b},n$b.getFunsScript=function(n$a){var n$b="";for(var n$c in this.funs)0<=n$a.indexOf(n$c+";")&&(n$b+=this.funs[n$c]);return n$b},n$a}()},n$t}(),n$ua=function(){function n$g(){}return n$m(n$g,"laya.webgl.WebGL"),n$g._uint8ArraySlice=function(){for(var n$a=this.length,n$b=new Uint8Array(this.length),n$c=0;n$c<n$a;n$c++)n$b[n$c]=this[n$c];return n$b},n$g._float32ArraySlice=function(){for(var n$a=this.length,n$b=new Float32Array(this.length),n$c=0;n$c<n$a;n$c++)n$b[n$c]=this[n$c];return n$b},n$g._uint16ArraySlice=function(n$a){var n$b,n$c=arguments,n$d=0,n$e=0;if(0===n$c.length)for(n$d=this.length,n$b=new Uint16Array(n$d),n$e=0;n$e<n$d;n$e++)n$b[n$e]=this[n$e];else if(2===n$c.length){var n$f=n$c[0],n$g=n$c[1];if(n$f<n$g)for(n$d=n$g-n$f,n$b=new Uint16Array(n$d),n$e=n$f;n$e<n$g;n$e++)n$b[n$e-n$f]=this[n$e];else n$b=new Uint16Array(0)}return n$b},n$g.expandContext=function(){var n$a=n$e.prototype,n$b=CanvasRenderingContext2D.prototype;n$b.fillTrangles=n$a.fillTrangles,n$Za.__int__(null),n$b.setIBVB=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){void 0===n$i&&(n$i=0),void 0===n$j&&(n$j=0),null===n$c&&(this._ib=this._ib||n$Aa.QuadrangleIB,n$c=this._ib,n$qa.expandIBQuadrangle(n$c,n$d._byteLength/64+8)),this._setIBVB(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j)},n$b.fillTrangles=function(n$a,n$b,n$c,n$d,n$e){this._curMat=this._curMat||n$z.create(),this._vb=this._vb||n$Ba.create(),this._ib||(this._ib=n$Aa.create(),n$qa.fillIBQuadrangle(this._ib,n$g/4));var n$f=this._vb,n$g=n$d.length>>4;n$qa.fillTranglesVB(n$f,n$b,n$c,n$d,n$e||this._curMat,0,0),n$qa.expandIBQuadrangle(this._ib,n$f._byteLength/64+8);var n$h=new n$ya(1,0);n$h.textureHost=n$a;var n$i=new n$_a("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");n$f._vertType=3,this._setIBVB(n$b,n$c,this._ib,n$f,6*n$g,n$e,n$i,n$h,0,0)}},n$g.enable=function(){if(n$n.__init__(),n$r.isConchApp&&!n$r.isConchWebGL)return n$v.skinAniSprite=function(){return new n$aa},n$g.expandContext(),!1;if(n$v.getWebGLContext=function(n$a){for(var n$b,n$c=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n$d=0;n$d<n$c.length;n$d++){try{n$b=n$a.getContext(n$c[n$d],{stencil:n$x.isStencil,alpha:n$x.isAlpha,antialias:n$x.isAntialias,premultipliedAlpha:n$x.premultipliedAlpha,preserveDrawingBuffer:n$x.preserveDrawingBuffer})}catch(n$a){}if(n$b)return n$b}return null},null==(n$g.mainContext=n$v.getWebGLContext(n$r._mainCanvas)))return!1;if(n$r.isWebGL)return!0;n$p.create=function(n$a,n$b){return new n$ab(n$a,n$b)},n$q.create=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){return new n$Xa(n$a,n$b,n$c,n$d,n$e,n$f,n$g)},n$r.WebGL=n$g,n$r.isWebGL=!0,n$na.__init__(),n$v.createRenderSprite=function(n$a,n$b){return new n$za(n$a,n$b)},n$v.createWebGLContext2D=function(n$a){return new n$xa(n$a)},n$v.changeWebGLSize=function(n$a,n$b){laya.webgl.WebGL.onStageResize(n$a,n$b)},n$v.createGraphics=function(){return new n$wa};var n$a=n$v.createFilterAction;return n$v.createFilterAction=n$a||function(n$a){return new n$Ca},n$v.clear=function(n$a){n$sa.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var n$b=n$r.context.ctx,n$c=0==n$b._submits._length||n$x.preserveDrawingBuffer?n$o.create(n$a)._color:n$F._wgColor;n$c&&n$b.clearBG(n$c[0],n$c[1],n$c[2],n$c[3]),n$sa.clear()},n$v.addToAtlas=function(n$a,n$b){void 0===n$b&&(n$b=!1);var n$c=n$a.bitmap;n$r.optimizeTextureMemory(n$a.url,n$a)?n$w.__typeof(n$c,"laya.webgl.resource.IMergeAtlasBitmap")&&n$c.allowMerageInAtlas&&n$c.on("recovered",n$a,n$a.addTextureToAtlas):n$c.enableMerageInAtlas=!1},n$v.isAtlas=function(n$a){return n$a instanceof laya.webgl.atlas.AtlasWebGLCanvas},n$Q._enable(),n$v.beginFlush=function(){for(var n$a=n$Q.instance,n$b=n$a.getAtlaserCount(),n$c=0;n$c<n$b;n$c++){var n$d=n$a.getAtlaserByIndex(n$c).texture;n$d._flashCacheImageNeedFlush&&n$v.flashFlushImage(n$d)}},n$v.drawToCanvas=function(n$a,n$b,n$c,n$d,n$e,n$f){(n$c<=0||n$d<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),n$c|=0,n$d|=0,n$e|=0,n$f|=0;var n$g=n$Ma.create(n$c,n$d,6408,5121,0,!1);n$g.start(),n$g.clear(0,0,0,0),n$r.context.clear(),n$s.renders[n$b]._fun(n$a,n$r.context,n$e,n$sa.height-n$d+n$f),n$r.context.flush(),n$g.end();var n$h=n$g.getData(0,0,n$c,n$d);if(n$g.recycle(),n$h.byteLength==n$c*n$d*4){var n$i=new n$Ua;n$i._canvas=n$n.createElement("canvas"),n$i.size(n$c,n$d);var n$j=n$i._canvas.getContext("2d");n$n.canvas.size(n$c,n$d);var n$k=n$n.context,n$l=n$k.createImageData(n$c,n$d);return n$l.data.set(new Uint8ClampedArray(n$h.buffer)),n$i._imgData=n$l,n$k.putImageData(n$l,0,0),n$j.save(),n$j.translate(0,n$d),n$j.scale(1,-1),n$j.drawImage(n$n.canvas.source,0,0),n$j.restore(),n$i}console.log("drawToCanvas error: w:"+n$c+",h:"+n$d+",datalen:"+n$h.byteLength)},n$v.createFilterAction=function(n$a){var n$b;switch(n$a){case 32:n$b=new n$Ca}return n$b},n$v.addTextureToAtlas=function(n$a){n$a._uvID++,n$Q._atlasRestore++,n$a.bitmap.enableMerageInAtlas&&n$Q.instance.addToAtlas(n$a)},n$v.getTexturePixels=function(n$a,n$b,n$c,n$d,n$e){n$r.context.ctx.clear();var n$f=new n$E;n$f.graphics.drawTexture(n$a,-n$b,-n$c);var n$g=n$Ma.create(n$d,n$e);n$g.start(),n$g.clear(0,0,0,0),n$f.render(n$r.context,0,0),n$r.context.ctx.flush(),n$g.end();for(var n$h=n$g.getData(0,0,n$d,n$e),n$i=[],n$j=0,n$k=n$e-1;0<=n$k;n$k--)for(var n$l=0;n$l<n$d;n$l++)n$j=4*(n$k*n$d+n$l),n$i.push(n$h[n$j]),n$i.push(n$h[n$j+1]),n$i.push(n$h[n$j+2]),n$i.push(n$h[n$j+3]);return n$i},n$v.skinAniSprite=function(){return new n$aa},n$j.create=function(n$a,n$b){var n$c=new n$Ua;return n$c._imgData=n$b,n$c.flipY=!1,n$c},n$y._filterStart=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$a.getValue("bounds"),n$g=n$Ma.create(n$f.width,n$f.height);if(n$g.start(),n$g.clear(0,0,0,0),n$a.addValue("src",n$g),n$a.addValue("ScissorTest",n$sa.worldScissorTest),n$sa.worldScissorTest){var n$h=new n$D;n$h.copyFrom(n$c.ctx._clipRect),n$a.addValue("clipRect",n$h),n$sa.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},n$y._filterEnd=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$a.getValue("bounds");n$a.getValue("src").end();var n$g=n$Ma.create(n$f.width,n$f.height);n$g.start(),n$g.clear(0,0,0,0),n$a.addValue("out",n$g),n$b._set$P("_filterCache",n$g),n$b._set$P("_isHaveGlowFilter",n$a.getValue("_isHaveGlowFilter"))},n$y._EndTarget=function(n$a,n$b){if(n$a.getValue("src").recycle(),n$a.getValue("out").end(),n$a.getValue("ScissorTest")){n$sa.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),n$b.ctx.save();var n$c=n$a.getValue("clipRect");n$b.ctx.clipRect(n$c.x,n$c.y,n$c.width,n$c.height)}},n$y._useSrc=function(n$a){var n$b=n$a.getValue("out");n$b.end(),(n$b=n$a.getValue("src")).start(),n$b.clear(0,0,0,0)},n$y._endSrc=function(n$a){n$a.getValue("src").end()},n$y._useOut=function(n$a){var n$b=n$a.getValue("src");n$b.end(),(n$b=n$a.getValue("out")).start(),n$b.clear(0,0,0,0)},n$y._endOut=function(n$a){n$a.getValue("out").end()},n$y._recycleScope=function(n$a){n$a.recycle()},n$y._filter=function(n$a,n$b,n$c,n$d){var n$e=this._next;if(n$e){var n$f,n$g,n$h=n$a.filters,n$i=n$h.length;if(1==n$i&&32==n$h[0].type)return n$b.ctx.save(),n$b.ctx.setFilters([n$h[0]]),n$e._fun.call(n$e,n$a,n$b,n$c,n$d),void n$b.ctx.restore();var n$j=n$ha.create(),n$k=n$C.TEMP,n$l=n$b.ctx._getTransformMatrix(),n$m=n$z.create();n$l.copyTo(n$m);var n$n=0,n$o=0,n$p=!1,n$q=n$a._$P._filterCache?n$a._$P._filterCache:null;if(!n$q||n$a._repaint){n$p=n$a._isHaveGlowFilter(),n$j.addValue("_isHaveGlowFilter",n$p),n$p&&(n$n=50,n$o=25),(n$g=new n$D).copyFrom(n$a.getSelfBounds()),n$g.x+=n$a.x,n$g.y+=n$a.y,n$g.x-=n$a.pivotX+4,n$g.y-=n$a.pivotY+4;var n$r=n$g.x,n$s=n$g.y;if(n$g.width+=n$n+8,n$g.height+=n$n+8,n$k.x=n$g.x*n$m.a+n$g.y*n$m.c,n$k.y=n$g.y*n$m.d+n$g.x*n$m.b,n$g.x=n$k.x,n$g.y=n$k.y,n$k.x=n$g.width*n$m.a+n$g.height*n$m.c,n$k.y=n$g.height*n$m.d+n$g.width*n$m.b,n$g.width=n$k.x,n$g.height=n$k.y,n$g.width<=0||n$g.height<=0)return;n$q&&n$q.recycle(),n$j.addValue("bounds",n$g);var n$t=n$ga.create([n$j,n$a,n$b,0,0],n$y._filterStart);n$b.addRenderObject(n$t),n$b.ctx._renderKey=0,n$b.ctx._shader2D.glTexture=null;var n$u=n$a.x-n$r+n$o,n$v=n$a.y-n$s+n$o;n$e._fun.call(n$e,n$a,n$b,n$u,n$v),n$t=n$ga.create([n$j,n$a,n$b,0,0],n$y._filterEnd),n$b.addRenderObject(n$t);for(var n$w=0;n$w<n$i;n$w++){0!=n$w&&(n$t=n$ga.create([n$j],n$y._useSrc),n$b.addRenderObject(n$t),n$f=n$ya.create(1,0),n$z.TEMP.identity(),n$b.ctx.drawTarget(n$j,0,0,n$g.width,n$g.height,n$z.TEMP,"out",n$f,null,n$S.TOINT.overlay),n$t=n$ga.create([n$j],n$y._useOut),n$b.addRenderObject(n$t)),n$h[n$w].action.apply3d(n$j,n$a,n$b,0,0)}n$t=n$ga.create([n$j,n$b],n$y._EndTarget),n$b.addRenderObject(n$t)}else{if((n$p=!!n$a._$P._isHaveGlowFilter&&n$a._$P._isHaveGlowFilter)&&(n$n=50,n$o=25),(n$g=n$a.getBounds()).width<=0||n$g.height<=0)return;n$g.width+=n$n,n$g.height+=n$n,n$k.x=n$g.x*n$m.a+n$g.y*n$m.c,n$k.y=n$g.y*n$m.d+n$g.x*n$m.b,n$g.x=n$k.x,n$g.y=n$k.y,n$k.x=n$g.width*n$m.a+n$g.height*n$m.c,n$k.y=n$g.height*n$m.d+n$g.width*n$m.b,n$g.width=n$k.x,n$g.height=n$k.y,n$j.addValue("out",n$q)}n$c=n$c-n$o-n$a.x,n$d=n$d-n$o-n$a.y,n$k.setTo(n$c,n$d),n$m.transformPoint(n$k),n$c=n$k.x+n$g.x,n$d=n$k.y+n$g.y,n$f=n$ya.create(1,0),n$z.TEMP.identity(),n$b.ctx.drawTarget(n$j,n$c,n$d,n$g.width,n$g.height,n$z.TEMP,"out",n$f,null,n$S.TOINT.overlay),n$t=n$ga.create([n$j],n$y._recycleScope),n$b.addRenderObject(n$t),n$m.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=n$g._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=n$g._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=n$g._uint8ArraySlice),!0},n$g.onStageResize=function(n$a,n$b){null!=n$g.mainContext&&(n$g.mainContext.viewport(0,0,n$a,n$b),n$sa.width=n$a,n$sa.height=n$b)},n$g.onInvalidGLRes=function(){n$Q.instance.freeAll(),n$u.releaseContentManagers(!0),n$g.doNodeRepaint(n$w.stage),n$g.mainContext.viewport(0,0,n$sa.width,n$sa.height),n$w.stage.event("devicelost")},n$g.doNodeRepaint=function(n$a){0==n$a.numChildren&&n$a.repaint();for(var n$b=0;n$b<n$a.numChildren;n$b++)n$g.doNodeRepaint(n$a.getChildAt(n$b))},n$g.init=function(n$a,n$b,n$c){n$g.mainCanvas=n$a,n$j._createContext=function(n$a){return new n$xa(n$a)},n$Ua._createContext=function(n$a){return new n$xa(n$a)};var n$d=laya.webgl.WebGL.mainContext;if(null!=n$d.getShaderPrecisionFormat){var n$e=n$d.getShaderPrecisionFormat(35633,36338),n$f=n$d.getShaderPrecisionFormat(35632,36338);n$g.shaderHighPrecision=!(!n$e.precision||!n$f.precision)}else n$g.shaderHighPrecision=!1;if(n$d.deleteTexture1=n$d.deleteTexture,n$d.deleteTexture=function(n$a){n$a==n$va.curBindTexValue&&(n$va.curBindTexValue=null),n$d.deleteTexture1(n$a)},n$g.onStageResize(n$b,n$c),null==n$g.mainContext)throw new Error("webGL getContext err!");n$I.__init__(),n$Q.__init__(),n$Ea.__init__(),n$fa.__init__(),n$xa.__init__(),n$ya.__init__(),n$A.__init__(),n$Za.__int__(n$d),n$S._init_(n$d),n$r.isConchApp&&conch.setOnInvalidGLRes(n$g.onInvalidGLRes)},n$g.mainCanvas=null,n$g.mainContext=null,n$g.antialias=!0,n$g.shaderHighPrecision=!1,n$g._bg_null=[0,0,0,0],n$g}(),n$va=function(){function n$d(){}return n$m(n$d,"laya.webgl.WebGLContext"),n$d.UseProgram=function(n$a){return n$d._useProgram!==n$a&&(n$ua.mainContext.useProgram(n$a),n$d._useProgram=n$a,!0)},n$d.setDepthTest=function(n$a,n$b){n$b!==n$d._depthTest&&((n$d._depthTest=n$b)?n$a.enable(2929):n$a.disable(2929))},n$d.setDepthMask=function(n$a,n$b){n$b!==n$d._depthMask&&(n$d._depthMask=n$b,n$a.depthMask(n$b))},n$d.setDepthFunc=function(n$a,n$b){n$b!==n$d._depthFunc&&(n$d._depthFunc=n$b,n$a.depthFunc(n$b))},n$d.setBlend=function(n$a,n$b){n$b!==n$d._blend&&((n$d._blend=n$b)?n$a.enable(3042):n$a.disable(3042))},n$d.setBlendFunc=function(n$a,n$b,n$c){(n$b!==n$d._sFactor||n$c!==n$d._dFactor)&&(n$d._sFactor=n$b,n$d._dFactor=n$c,n$a.blendFunc(n$b,n$c))},n$d.setCullFace=function(n$a,n$b){n$b!==n$d._cullFace&&((n$d._cullFace=n$b)?n$a.enable(2884):n$a.disable(2884))},n$d.setFrontFace=function(n$a,n$b){n$b!==n$d._frontFace&&(n$d._frontFace=n$b,n$a.frontFace(n$b))},n$d.bindTexture=function(n$a,n$b,n$c){n$a.bindTexture(n$b,n$c),n$d.curBindTexTarget=n$b,n$d.curBindTexValue=n$c},n$d.DEPTH_BUFFER_BIT=256,n$d.STENCIL_BUFFER_BIT=1024,n$d.COLOR_BUFFER_BIT=16384,n$d.POINTS=0,n$d.LINES=1,n$d.LINE_LOOP=2,n$d.LINE_STRIP=3,n$d.TRIANGLES=4,n$d.TRIANGLE_STRIP=5,n$d.TRIANGLE_FAN=6,n$d.ZERO=0,n$d.ONE=1,n$d.SRC_COLOR=768,n$d.ONE_MINUS_SRC_COLOR=769,n$d.SRC_ALPHA=770,n$d.ONE_MINUS_SRC_ALPHA=771,n$d.DST_ALPHA=772,n$d.ONE_MINUS_DST_ALPHA=773,n$d.DST_COLOR=774,n$d.ONE_MINUS_DST_COLOR=775,n$d.SRC_ALPHA_SATURATE=776,n$d.FUNC_ADD=32774,n$d.BLEND_EQUATION=32777,n$d.BLEND_EQUATION_RGB=32777,n$d.BLEND_EQUATION_ALPHA=34877,n$d.FUNC_SUBTRACT=32778,n$d.FUNC_REVERSE_SUBTRACT=32779,n$d.BLEND_DST_RGB=32968,n$d.BLEND_SRC_RGB=32969,n$d.BLEND_DST_ALPHA=32970,n$d.BLEND_SRC_ALPHA=32971,n$d.CONSTANT_COLOR=32769,n$d.ONE_MINUS_CONSTANT_COLOR=32770,n$d.CONSTANT_ALPHA=32771,n$d.ONE_MINUS_CONSTANT_ALPHA=32772,n$d.BLEND_COLOR=32773,n$d.ARRAY_BUFFER=34962,n$d.ELEMENT_ARRAY_BUFFER=34963,n$d.ARRAY_BUFFER_BINDING=34964,n$d.ELEMENT_ARRAY_BUFFER_BINDING=34965,n$d.STREAM_DRAW=35040,n$d.STATIC_DRAW=35044,n$d.DYNAMIC_DRAW=35048,n$d.BUFFER_SIZE=34660,n$d.BUFFER_USAGE=34661,n$d.CURRENT_VERTEX_ATTRIB=34342,n$d.FRONT=1028,n$d.BACK=1029,n$d.CULL_FACE=2884,n$d.FRONT_AND_BACK=1032,n$d.BLEND=3042,n$d.DITHER=3024,n$d.STENCIL_TEST=2960,n$d.DEPTH_TEST=2929,n$d.SCISSOR_TEST=3089,n$d.POLYGON_OFFSET_FILL=32823,n$d.SAMPLE_ALPHA_TO_COVERAGE=32926,n$d.SAMPLE_COVERAGE=32928,n$d.NO_ERROR=0,n$d.INVALID_ENUM=1280,n$d.INVALID_VALUE=1281,n$d.INVALID_OPERATION=1282,n$d.OUT_OF_MEMORY=1285,n$d.CW=2304,n$d.CCW=2305,n$d.LINE_WIDTH=2849,n$d.ALIASED_POINT_SIZE_RANGE=33901,n$d.ALIASED_LINE_WIDTH_RANGE=33902,n$d.CULL_FACE_MODE=2885,n$d.FRONT_FACE=2886,n$d.DEPTH_RANGE=2928,n$d.DEPTH_WRITEMASK=2930,n$d.DEPTH_CLEAR_VALUE=2931,n$d.DEPTH_FUNC=2932,n$d.STENCIL_CLEAR_VALUE=2961,n$d.STENCIL_FUNC=2962,n$d.STENCIL_FAIL=2964,n$d.STENCIL_PASS_DEPTH_FAIL=2965,n$d.STENCIL_PASS_DEPTH_PASS=2966,n$d.STENCIL_REF=2967,n$d.STENCIL_VALUE_MASK=2963,n$d.STENCIL_WRITEMASK=2968,n$d.STENCIL_BACK_FUNC=34816,n$d.STENCIL_BACK_FAIL=34817,n$d.STENCIL_BACK_PASS_DEPTH_FAIL=34818,n$d.STENCIL_BACK_PASS_DEPTH_PASS=34819,n$d.STENCIL_BACK_REF=36003,n$d.STENCIL_BACK_VALUE_MASK=36004,n$d.STENCIL_BACK_WRITEMASK=36005,n$d.VIEWPORT=2978,n$d.SCISSOR_BOX=3088,n$d.COLOR_CLEAR_VALUE=3106,n$d.COLOR_WRITEMASK=3107,n$d.UNPACK_ALIGNMENT=3317,n$d.PACK_ALIGNMENT=3333,n$d.MAX_TEXTURE_SIZE=3379,n$d.MAX_VIEWPORT_DIMS=3386,n$d.SUBPIXEL_BITS=3408,n$d.RED_BITS=3410,n$d.GREEN_BITS=3411,n$d.BLUE_BITS=3412,n$d.ALPHA_BITS=3413,n$d.DEPTH_BITS=3414,n$d.STENCIL_BITS=3415,n$d.POLYGON_OFFSET_UNITS=10752,n$d.POLYGON_OFFSET_FACTOR=32824,n$d.TEXTURE_BINDING_2D=32873,n$d.SAMPLE_BUFFERS=32936,n$d.SAMPLES=32937,n$d.SAMPLE_COVERAGE_VALUE=32938,n$d.SAMPLE_COVERAGE_INVERT=32939,n$d.NUM_COMPRESSED_TEXTURE_FORMATS=34466,n$d.COMPRESSED_TEXTURE_FORMATS=34467,n$d.DONT_CARE=4352,n$d.FASTEST=4353,n$d.NICEST=4354,n$d.GENERATE_MIPMAP_HINT=33170,n$d.BYTE=5120,n$d.UNSIGNED_BYTE=5121,n$d.SHORT=5122,n$d.UNSIGNED_SHORT=5123,n$d.INT=5124,n$d.UNSIGNED_INT=5125,n$d.FLOAT=5126,n$d.DEPTH_COMPONENT=6402,n$d.ALPHA=6406,n$d.RGB=6407,n$d.RGBA=6408,n$d.LUMINANCE=6409,n$d.LUMINANCE_ALPHA=6410,n$d.UNSIGNED_SHORT_4_4_4_4=32819,n$d.UNSIGNED_SHORT_5_5_5_1=32820,n$d.UNSIGNED_SHORT_5_6_5=33635,n$d.FRAGMENT_SHADER=35632,n$d.VERTEX_SHADER=35633,n$d.MAX_VERTEX_ATTRIBS=34921,n$d.MAX_VERTEX_UNIFORM_VECTORS=36347,n$d.MAX_VARYING_VECTORS=36348,n$d.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,n$d.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,n$d.MAX_TEXTURE_IMAGE_UNITS=34930,n$d.MAX_FRAGMENT_UNIFORM_VECTORS=36349,n$d.SHADER_TYPE=35663,n$d.DELETE_STATUS=35712,n$d.LINK_STATUS=35714,n$d.VALIDATE_STATUS=35715,n$d.ATTACHED_SHADERS=35717,n$d.ACTIVE_UNIFORMS=35718,n$d.ACTIVE_ATTRIBUTES=35721,n$d.SHADING_LANGUAGE_VERSION=35724,n$d.CURRENT_PROGRAM=35725,n$d.NEVER=512,n$d.LESS=513,n$d.EQUAL=514,n$d.LEQUAL=515,n$d.GREATER=516,n$d.NOTEQUAL=517,n$d.GEQUAL=518,n$d.ALWAYS=519,n$d.KEEP=7680,n$d.REPLACE=7681,n$d.INCR=7682,n$d.DECR=7683,n$d.INVERT=5386,n$d.INCR_WRAP=34055,n$d.DECR_WRAP=34056,n$d.VENDOR=7936,n$d.RENDERER=7937,n$d.VERSION=7938,n$d.NEAREST=9728,n$d.LINEAR=9729,n$d.NEAREST_MIPMAP_NEAREST=9984,n$d.LINEAR_MIPMAP_NEAREST=9985,n$d.NEAREST_MIPMAP_LINEAR=9986,n$d.LINEAR_MIPMAP_LINEAR=9987,n$d.TEXTURE_MAG_FILTER=10240,n$d.TEXTURE_MIN_FILTER=10241,n$d.TEXTURE_WRAP_S=10242,n$d.TEXTURE_WRAP_T=10243,n$d.TEXTURE_2D=3553,n$d.TEXTURE=5890,n$d.TEXTURE_CUBE_MAP=34067,n$d.TEXTURE_BINDING_CUBE_MAP=34068,n$d.TEXTURE_CUBE_MAP_POSITIVE_X=34069,n$d.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,n$d.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,n$d.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,n$d.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,n$d.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,n$d.MAX_CUBE_MAP_TEXTURE_SIZE=34076,n$d.TEXTURE0=33984,n$d.TEXTURE1=33985,n$d.TEXTURE2=33986,n$d.TEXTURE3=33987,n$d.TEXTURE4=33988,n$d.TEXTURE5=33989,n$d.TEXTURE6=33990,n$d.TEXTURE7=33991,n$d.TEXTURE8=33992,n$d.TEXTURE9=33993,n$d.TEXTURE10=33994,n$d.TEXTURE11=33995,n$d.TEXTURE12=33996,n$d.TEXTURE13=33997,n$d.TEXTURE14=33998,n$d.TEXTURE15=33999,n$d.TEXTURE16=34e3,n$d.TEXTURE17=34001,n$d.TEXTURE18=34002,n$d.TEXTURE19=34003,n$d.TEXTURE20=34004,n$d.TEXTURE21=34005,n$d.TEXTURE22=34006,n$d.TEXTURE23=34007,n$d.TEXTURE24=34008,n$d.TEXTURE25=34009,n$d.TEXTURE26=34010,n$d.TEXTURE27=34011,n$d.TEXTURE28=34012,n$d.TEXTURE29=34013,n$d.TEXTURE30=34014,n$d.TEXTURE31=34015,n$d.ACTIVE_TEXTURE=34016,n$d.REPEAT=10497,n$d.CLAMP_TO_EDGE=33071,n$d.MIRRORED_REPEAT=33648,n$d.FLOAT_VEC2=35664,n$d.FLOAT_VEC3=35665,n$d.FLOAT_VEC4=35666,n$d.INT_VEC2=35667,n$d.INT_VEC3=35668,n$d.INT_VEC4=35669,n$d.BOOL=35670,n$d.BOOL_VEC2=35671,n$d.BOOL_VEC3=35672,n$d.BOOL_VEC4=35673,n$d.FLOAT_MAT2=35674,n$d.FLOAT_MAT3=35675,n$d.FLOAT_MAT4=35676,n$d.SAMPLER_2D=35678,n$d.SAMPLER_CUBE=35680,n$d.VERTEX_ATTRIB_ARRAY_ENABLED=34338,n$d.VERTEX_ATTRIB_ARRAY_SIZE=34339,n$d.VERTEX_ATTRIB_ARRAY_STRIDE=34340,n$d.VERTEX_ATTRIB_ARRAY_TYPE=34341,n$d.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,n$d.VERTEX_ATTRIB_ARRAY_POINTER=34373,n$d.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,n$d.COMPILE_STATUS=35713,n$d.LOW_FLOAT=36336,n$d.MEDIUM_FLOAT=36337,n$d.HIGH_FLOAT=36338,n$d.LOW_INT=36339,n$d.MEDIUM_INT=36340,n$d.HIGH_INT=36341,n$d.FRAMEBUFFER=36160,n$d.RENDERBUFFER=36161,n$d.RGBA4=32854,n$d.RGB5_A1=32855,n$d.RGB565=36194,n$d.DEPTH_COMPONENT16=33189,n$d.STENCIL_INDEX=6401,n$d.STENCIL_INDEX8=36168,n$d.DEPTH_STENCIL=34041,n$d.RENDERBUFFER_WIDTH=36162,n$d.RENDERBUFFER_HEIGHT=36163,n$d.RENDERBUFFER_INTERNAL_FORMAT=36164,n$d.RENDERBUFFER_RED_SIZE=36176,n$d.RENDERBUFFER_GREEN_SIZE=36177,n$d.RENDERBUFFER_BLUE_SIZE=36178,n$d.RENDERBUFFER_ALPHA_SIZE=36179,n$d.RENDERBUFFER_DEPTH_SIZE=36180,n$d.RENDERBUFFER_STENCIL_SIZE=36181,n$d.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,n$d.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,n$d.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,n$d.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,n$d.COLOR_ATTACHMENT0=36064,n$d.DEPTH_ATTACHMENT=36096,n$d.STENCIL_ATTACHMENT=36128,n$d.DEPTH_STENCIL_ATTACHMENT=33306,n$d.NONE=0,n$d.FRAMEBUFFER_COMPLETE=36053,n$d.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,n$d.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,n$d.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,n$d.FRAMEBUFFER_UNSUPPORTED=36061,n$d.FRAMEBUFFER_BINDING=36006,n$d.RENDERBUFFER_BINDING=36007,n$d.MAX_RENDERBUFFER_SIZE=34024,n$d.INVALID_FRAMEBUFFER_OPERATION=1286,n$d.UNPACK_FLIP_Y_WEBGL=37440,n$d.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,n$d.CONTEXT_LOST_WEBGL=37442,n$d.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,n$d.BROWSER_DEFAULT_WEBGL=37444,n$d._useProgram=null,n$d._depthTest=!0,n$d._depthMask=!0,n$d._blend=!1,n$d._cullFace=!1,n$d.curBindTexTarget=null,n$d.curBindTexValue=null,n$g(n$d,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),n$d}(),n$wa=function(n$a){function n$b(){n$b.__super.call(this)}n$m(n$b,"laya.webgl.display.GraphicsGL",n$h);var n$c=n$b.prototype;return n$c.setShader=function(n$a){this._saveToCmd(n$r.context._setShader,[n$a])},n$c.setIBVB=function(n$a,n$b,n$c,n$d,n$e,n$f){this._saveToCmd(n$r.context._setIBVB,[n$a,n$b,n$c,n$d,n$e,n$f])},n$c.drawParticle=function(n$a,n$b,n$c){var n$d=n$v.createParticleTemplate2D(n$c);n$d.x=n$a,n$d.y=n$b,this._saveToCmd(n$r.context._drawParticle,[n$d])},n$b}(),n$xa=function(n$a){var n$c;function n$P(n$a){this._x=0,this._y=0,this._id=++n$P._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,n$P.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=n$P.MAXCLIPRECT,this.mOutPoint,this._canvas=n$a,this._canvas._addReference(),n$P._contextcount++,n$r.isFlash?(this._ib=n$Aa.create(35044),n$qa.fillIBQuadrangle(this._ib,16)):this._ib=n$Aa.QuadrangleIB,this.clear()}n$m(n$P,"laya.webgl.canvas.WebGLContext2D",n$e);var n$b=n$P.prototype;return n$b.setIsMainContext=function(){this._isMain=!0},n$b.clearBG=function(n$a,n$b,n$c,n$d){var n$e=n$ua.mainContext;n$e.clearColor(n$a,n$b,n$c,n$d),n$e.clear(16384)},n$b._getSubmits=function(){return this._submits},n$b._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var n$a=0,n$b=this._submits._length;n$a<n$b;n$a++)this._submits[n$a].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},n$b.destroy=function(){--n$P._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=n$Aa.QuadrangleIB&&this._ib.releaseResource()},n$b.clear=function(){this._submits||(this._other=n$c.DEFAULT,this._curMat=n$z.create(),this._vb=n$Ba.create(-1),this._submits=[],this._save=[n$Y.Create(this)],this._save.length=10,this._shader2D=new n$A,this._triangleMesh=n$Ka.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=n$c.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=n$P.MAXCLIPRECT,this._curSubmit=n$fa.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=n$T.DEFAULT;for(var n$a=0,n$b=this._submits._length;n$a<n$b;n$a++)this._submits[n$a].releaseRender(),this._submits[n$a]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},n$b.size=function(n$a,n$b){if(this._width!=n$a||this._height!=n$b)if(0==n$a||0==n$b){0!=this._vb._byteLength&&(this._width=n$a,this._height=n$b,this._vb.clear(),this._vb.upload());for(var n$c=0,n$d=this._submits._length;n$c<n$d;n$c++)this._submits[n$c].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=n$a,this._height=n$b,this._targets&&this._targets.size(n$a,n$b),this._canvas.memorySize-=this._canvas.memorySize;0===n$a&&0===n$b&&this._releaseMem()},n$b._getTransformMatrix=function(){return this._curMat},n$b.translate=function(n$a,n$b){0===n$a&&0===n$b||(n$$.save(this),this._curMat.bTransform&&(n$Z.save(this),this._curMat.transformPointN(n$C.TEMP.setTo(n$a,n$b)),n$a=n$C.TEMP.x,n$b=n$C.TEMP.y),this._x+=n$a,this._y+=n$b)},n$b.save=function(){this._save[this._save._length++]=n$Y.Create(this)},n$b.restore=function(){var n$a=this._save._length;if(!(n$a<1))for(var n$b=n$a-1;0<=n$b;n$b--){var n$c=this._save[n$b];if(n$c.restore(this),n$c.isSaveMark())return void(this._save._length=n$b)}},n$b._fillText=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){void 0===n$j&&(n$j=0);var n$k=this._shader2D,n$l=this._curSubmit.shaderValue,n$m=n$e?n$oa.create(n$e):this._other.font;if(n$Q.enabled)n$k.ALPHA!==n$l.ALPHA&&(n$k.glTexture=null),n$na.drawText(this,n$a,n$b,this._curMat,n$m,n$i||this._other.textAlign,n$f,n$g,n$h,n$c,n$d,n$j);else{this._shader2D.defines.getValue();var n$n=n$f?n$o.create(n$f)._color:n$k.colorAdd;n$k.ALPHA===n$l.ALPHA&&n$n===n$k.colorAdd&&n$l.colorAdd===n$k.colorAdd||(n$k.glTexture=null,n$k.colorAdd=n$n),n$na.drawText(this,n$a,n$b,this._curMat,n$m,n$i||this._other.textAlign,n$f,n$g,n$h,n$c,n$d,n$j)}},n$b.fillWords=function(n$a,n$b,n$c,n$d,n$e,n$f){this._fillText(null,n$a,n$b,n$c,n$d,n$e,null,-1,null,n$f)},n$b.fillBorderWords=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this._fillBorderText(null,n$a,n$b,n$c,n$d,n$e,n$f,n$g,null)},n$b.fillText=function(n$a,n$b,n$c,n$d,n$e,n$f){this._fillText(n$a,null,n$b,n$c,n$d,n$e,null,-1,n$f)},n$b.strokeText=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this._fillText(n$a,null,n$b,n$c,n$d,null,n$e,n$f||1,n$g)},n$b.fillBorderText=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){this._fillBorderText(n$a,null,n$b,n$c,n$d,n$e,n$f,n$g,n$h)},n$b._fillBorderText=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){if(!n$Q.enabled)return this._fillText(n$a,n$b,n$c,n$d,n$e,null,n$g,n$h||1,n$i),void this._fillText(n$a,n$b,n$c,n$d,n$e,n$f,null,-1,n$i);var n$j=this._shader2D,n$k=this._curSubmit.shaderValue;n$j.ALPHA!==n$k.ALPHA&&(n$j.glTexture=null);var n$l=n$e?(n$P._fontTemp.setFont(n$e),n$P._fontTemp):this._other.font;n$na.drawText(this,n$a,n$b,this._curMat,n$l,n$i||this._other.textAlign,n$f,n$g,n$h||1,n$c,n$d,0)},n$b.fillRect=function(n$a,n$b,n$c,n$d,n$e){var n$f=this._vb;if(n$qa.fillRectImgVb(n$f,this._clipRect,n$a,n$b,n$c,n$d,n$K.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var n$g=this._shader2D.fillStyle;n$e&&(this._shader2D.fillStyle=n$T.create(n$e));var n$h=this._shader2D,n$i=this._curSubmit.shaderValue;if(n$h.fillStyle!==n$i.fillStyle||n$h.ALPHA!==n$i.ALPHA){n$h.glTexture=null;var n$j=this._curSubmit=n$fa.createSubmit(this,this._ib,n$f,(n$f._byteLength-64)/32*3,n$ya.create(2,0));n$j.shaderValue.color=n$h.fillStyle._color._color,n$j.shaderValue.ALPHA=n$h.ALPHA,this._submits[this._submits._length++]=n$j}this._curSubmit._numEle+=6,this._shader2D.fillStyle=n$g}},n$b.fillTexture=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){if(n$a.loaded&&n$a.bitmap&&n$a.source){var n$i=this._vb,n$j=n$a.bitmap.width,n$k=n$a.bitmap.height,n$l=n$a.uv,n$m=n$g.x%n$a.width,n$n=n$g.y%n$a.height;if(n$j!=n$h.w||n$k!=n$h.h){if(!n$h.w&&!n$h.h)switch(n$h.oy=n$h.ox=0,n$f){case"repeat":n$h.width=n$d,n$h.height=n$e;break;case"repeat-x":n$h.width=n$d,n$n<0?n$a.height+n$n>n$e?n$h.height=n$e:n$h.height=n$a.height+n$n:(n$h.oy=n$n,n$a.height+n$n>n$e?n$h.height=n$e-n$n:n$h.height=n$a.height);break;case"repeat-y":n$m<0?n$a.width+n$m>n$d?n$h.width=n$d:n$h.width=n$a.width+n$m:(n$h.ox=n$m,n$a.width+n$m>n$d?n$h.width=n$d-n$m:n$h.width=n$a.width),n$h.height=n$e;break;case"no-repeat":n$m<0?n$a.width+n$m>n$d?n$h.width=n$d:n$h.width=n$a.width+n$m:(n$h.ox=n$m,n$a.width+n$m>n$d?n$h.width=n$d-n$m:n$h.width=n$a.width),n$n<0?n$a.height+n$n>n$e?n$h.height=n$e:n$h.height=n$a.height+n$n:(n$h.oy=n$n,n$a.height+n$n>n$e?n$h.height=n$e-n$n:n$h.height=n$a.height);break;default:n$h.width=n$d,n$h.height=n$e}n$h.w=n$j,n$h.h=n$k,n$h.uv=[0,0,n$h.width/n$j,0,n$h.width/n$j,n$h.height/n$k,0,n$h.height/n$k]}if(n$b+=n$h.ox,n$c+=n$h.oy,n$m-=n$h.ox,n$n-=n$h.oy,n$qa.fillRectImgVb(n$i,this._clipRect,n$b,n$c,n$h.width,n$h.height,n$h.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var n$o=n$Ja.create(this,this._ib,n$i,(n$i._byteLength-64)/32*3,n$ya.create(256,0)),n$p=(this._submits[this._submits._length++]=n$o).shaderValue;n$p.textureHost=n$a;var n$q=n$l[0]*n$j,n$r=n$l[1]*n$k,n$s=(n$l[2]-n$l[0])*n$j,n$t=(n$l[5]-n$l[3])*n$k,n$u=-n$m/n$j,n$v=-n$n/n$k;n$p.u_TexRange[0]=n$q/n$j,n$p.u_TexRange[1]=n$s/n$j,n$p.u_TexRange[2]=n$r/n$k,n$p.u_TexRange[3]=n$t/n$k,n$p.u_offset[0]=n$u,n$p.u_offset[1]=n$v,n$Q.enabled&&!this._isMain&&n$o.addTexture(n$a,(n$i._byteLength>>2)-16),(this._curSubmit=n$o)._renderType=10017,n$o._numEle+=6}}else this.sprite&&n$w.timer.callLater(this,this._repaintSprite)},n$b.setShader=function(n$a){n$V.save(this,1048576,this._shader2D,!0),this._shader2D.shader=n$a},n$b.setFilters=function(n$a){n$V.save(this,2097152,this._shader2D,!0),this._shader2D.filters=n$a,this._curSubmit=n$fa.RENDERBASE,this._renderKey=0,this._drawCount++},n$b.drawTexture=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this._drawTextureM(n$a,n$b,n$c,n$d,n$e,n$f,n$g,null,1)},n$b.addTextureVb=function(n$a,n$b,n$c){var n$d=this._curSubmit._vb||this._vb,n$e=n$d._byteLength>>2;n$d.byteLength=n$e+16<<2;for(var n$f=n$d.getFloat32Array(),n$g=0;n$g<16;n$g+=4)n$f[n$e++]=n$a[n$g]+n$b,n$f[n$e++]=n$a[n$g+1]+n$c,n$f[n$e++]=n$a[n$g+2],n$f[n$e++]=n$a[n$g+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),n$d._upload=!0},n$b.willDrawTexture=function(n$a,n$b){if(!(n$a.loaded&&n$a.bitmap&&n$a.source))return this.sprite&&n$w.timer.callLater(this,this._repaintSprite),0;var n$c=n$a.bitmap,n$d=n$c.id+this._shader2D.ALPHA*n$b+10016;if(n$d==this._renderKey)return n$d;var n$e=this._shader2D,n$f=n$e.ALPHA,n$g=this._curSubmit.shaderValue;n$e.ALPHA*=n$b,this._renderKey=n$d,this._drawCount++,n$e.glTexture=n$c;var n$h=this._vb,n$i=null,n$j=n$h._byteLength/32*3,n$k=n$g.textureHost&&n$g.textureHost==n$a&&n$g.textureHost.alphaTexture==n$a.alphaTexture;return n$i=n$Ja.create(this,this._ib,n$h,n$j,n$ya.create(1,0)),(this._submits[this._submits._length++]=n$i).shaderValue.textureHost=n$a,n$i._renderType=10016,n$i._preIsSameTextureShader=10016===this._curSubmit._renderType&&n$e.ALPHA===n$g.ALPHA&&n$k,this._curSubmit=n$i,n$e.ALPHA=n$f,n$d},n$b.drawTextures=function(n$a,n$b,n$c,n$d){if(n$a.loaded&&n$a.bitmap&&n$a.source){var n$e=this._clipRect;if(this._clipRect=n$P.MAXCLIPRECT,this._drawTextureM(n$a,n$b[0],n$b[1],n$a.width,n$a.height,n$c,n$d,null,1)){if(this._clipRect=n$e,n$G.drawCall++,!(n$b.length<4)){for(var n$f=this._curSubmit._vb||this._vb,n$g=this._curMat.a,n$h=this._curMat.d,n$i=2,n$j=n$b.length;n$i<n$j;n$i+=2)n$qa.copyPreImgVb(n$f,(n$b[n$i]-n$b[n$i-2])*n$g,(n$b[n$i+1]-n$b[n$i-1])*n$h),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&n$w.timer.callLater(this,this._repaintSprite)},n$b._drawTextureM=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){if(!n$a.loaded||!n$a.source)return this.sprite&&n$w.timer.callLater(this,this._repaintSprite),!1;var n$j=this._curSubmit._vb||this._vb,n$k=n$a.bitmap;n$b+=n$f,n$c+=n$g,this._drawCount++;var n$l=n$k.id+this._shader2D.ALPHA*n$i+10016;if(n$l!=this._renderKey){this._renderKey=n$l;var n$m=this._curSubmit.shaderValue,n$n=this._shader2D,n$o=n$n.ALPHA;n$n.ALPHA*=n$i,n$n.glTexture=n$k;var n$p=this._vb,n$q=null,n$r=n$p._byteLength/32*3,n$s=n$m.textureHost&&n$m.textureHost==n$a&&n$m.textureHost.alphaTexture==n$a.alphaTexture;n$q=n$Ja.create(this,this._ib,n$p,n$r,n$ya.create(1,0)),(this._submits[this._submits._length++]=n$q).shaderValue.textureHost=n$a,n$q._renderType=10016,n$q._preIsSameTextureShader=10016===this._curSubmit._renderType&&n$n.ALPHA===n$m.ALPHA&&n$s,this._curSubmit=n$q,n$j=this._curSubmit._vb||this._vb,n$n.ALPHA=n$o}return!!n$qa.fillRectImgVb(n$j,this._clipRect,n$b,n$c,n$d||n$a.width,n$e||n$a.height,n$a.uv,n$h||this._curMat,this._x,this._y,0,0)&&(n$Q.enabled&&!this._isMain&&this._curSubmit.addTexture(n$a,(n$j._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},n$b._repaintSprite=function(){this.sprite&&this.sprite.repaint()},n$b._drawText=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){var n$k=n$a.bitmap;this._drawCount++;var n$l=n$k.id+this._shader2D.ALPHA+10016;if(n$l!=this._renderKey){this._renderKey=n$l;var n$m=this._curSubmit.shaderValue,n$n=this._shader2D;n$n.glTexture=n$k;var n$o=this._vb,n$p=null,n$q=n$o._byteLength/32*3,n$r=n$m.textureHost&&n$m.textureHost==n$a&&n$m.textureHost.alphaTexture==n$a.alphaTexture;(n$p=n$Q.enabled?n$Ja.create(this,this._ib,n$o,n$q,n$ya.create(1,0)):n$Ja.create(this,this._ib,n$o,n$q,n$$a.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&n$n.ALPHA===n$m.ALPHA&&n$r,(this._submits[this._submits._length++]=n$p).shaderValue.textureHost=n$a,n$p._renderType=10016,this._curSubmit=n$p}n$a.active();var n$s=this._curSubmit._vb||this._vb;n$qa.fillRectImgVb(n$s,this._clipRect,n$b+n$g,n$c+n$h,n$d||n$a.width,n$e||n$a.height,n$a.uv,n$f||this._curMat,this._x,this._y,n$i,n$j,!0)&&(n$Q.enabled&&!this._isMain&&this._curSubmit.addTexture(n$a,(n$s._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},n$b.drawTextureWithTransform=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){if(n$f){var n$j=this._curMat,n$k=this._x,n$l=this._y;(0!==n$g||0!==n$h)&&(this._x=n$g*n$j.a+n$h*n$j.c,this._y=n$h*n$j.d+n$g*n$j.b),n$f&&n$j.bTransform?(n$z.mul(n$f,n$j,n$P._tmpMatrix),(n$f=n$P._tmpMatrix)._checkTransform()):(this._x+=n$j.tx,this._y+=n$j.ty),this._drawTextureM(n$a,n$b,n$c,n$d,n$e,0,0,n$f,n$i),this._x=n$k,this._y=n$l}else this._drawTextureM(n$a,n$b,n$c,n$d,n$e,n$g,n$h,null,n$i)},n$b.fillQuadrangle=function(n$a,n$b,n$c,n$d,n$e){var n$f=this._curSubmit,n$g=this._vb,n$h=this._shader2D,n$i=n$f.shaderValue;if(this._renderKey=0,n$a.bitmap){var n$j=n$a.bitmap;n$h.glTexture==n$j&&n$h.ALPHA===n$i.ALPHA||(n$h.glTexture=n$j,(n$f=this._curSubmit=n$fa.createSubmit(this,this._ib,n$g,n$g._byteLength/32*3,n$ya.create(1,0))).shaderValue.glTexture=n$j,this._submits[this._submits._length++]=n$f),n$qa.fillQuadrangleImgVb(n$g,n$b,n$c,n$d,n$a.uv,n$e||this._curMat,this._x,this._y)}else n$f.shaderValue.fillStyle&&n$f.shaderValue.fillStyle.equal(n$a)&&n$h.ALPHA===n$i.ALPHA||(n$h.glTexture=null,(n$f=this._curSubmit=n$fa.createSubmit(this,this._ib,n$g,n$g._byteLength/32*3,n$ya.create(2,0))).shaderValue.defines.add(2),n$f.shaderValue.fillStyle=n$T.create(n$a),this._submits[this._submits._length++]=n$f),n$qa.fillQuadrangleImgVb(n$g,n$b,n$c,n$d,n$K.DEF_UV,n$e||this._curMat,this._x,this._y);n$f._numEle+=6},n$b.drawTexture2=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){if(0!=n$f){var n$i=this._curMat;if(this._x=n$a*n$i.a+n$b*n$i.c,this._y=n$b*n$i.d+n$a*n$i.b,n$e&&(n$e=n$i.bTransform||n$e.bTransform?(n$z.mul(n$e,n$i,n$P._tmpMatrix),n$P._tmpMatrix):(this._x+=n$e.tx+n$i.tx,this._y+=n$e.ty+n$i.ty,n$z.EMPTY)),1!==n$f||n$g){var n$j=this._shader2D.ALPHA,n$k=this._nBlendType;this._shader2D.ALPHA=n$f,n$g&&(this._nBlendType=n$S.TOINT(n$g)),this._drawTextureM(n$h[0],n$h[1]-n$c,n$h[2]-n$d,n$h[3],n$h[4],0,0,n$e,1),this._shader2D.ALPHA=n$j,this._nBlendType=n$k}else this._drawTextureM(n$h[0],n$h[1]-n$c,n$h[2]-n$d,n$h[3],n$h[4],0,0,n$e,1);this._x=this._y=0}},n$b.drawCanvas=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$a.context;if(this._renderKey=0,n$f._targets)this._submits[this._submits._length++]=n$Ia.create(n$f,0,null),this._curSubmit=n$fa.RENDERBASE,n$f._targets.drawTo(this,n$b,n$c,n$d,n$e);else{var n$g=this._submits[this._submits._length++]=n$Ia.create(n$f,this._shader2D.ALPHA,this._shader2D.filters),n$h=n$d/n$a.width,n$i=n$e/n$a.height,n$j=n$g._matrix;this._curMat.copyTo(n$j),1!=n$h&&1!=n$i&&n$j.scale(n$h,n$i);var n$k=n$j.tx,n$l=n$j.ty;n$j.tx=n$j.ty=0,n$j.transformPoint(n$C.TEMP.setTo(n$b,n$c)),n$j.translate(n$C.TEMP.x+n$k,n$C.TEMP.y+n$l),this._curSubmit=n$fa.RENDERBASE}n$x.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=n$f._targets?"yellow":"green",this.strokeRect(n$b-1,n$c-1,n$d+2,n$e+2,1),this.strokeRect(n$b,n$c,n$d,n$e,1),this.restore())},n$b.drawTarget=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){void 0===n$j&&(n$j=-1);var n$k=this._vb;if(n$qa.fillRectImgVb(n$k,this._clipRect,n$b,n$c,n$d,n$e,n$i||n$K.DEF_UV,n$f||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var n$l=this._curSubmit=n$la.create(this,this._ib,n$k,(n$k._byteLength-64)/32*3,n$h,n$g);n$l.blendType=-1==n$j?this._nBlendType:n$j,n$l.scope=n$a,this._submits[this._submits._length++]=n$l,this._curSubmit._numEle+=6}},n$b.mixRGBandAlpha=function(n$a){return this._mixRGBandAlpha(n$a,this._shader2D.ALPHA)},n$b._mixRGBandAlpha=function(n$a,n$b){var n$c=(4278190080&n$a)>>>24;return 0!=n$c?n$c*=n$b:n$c=255*n$b,16777215&n$a|n$c<<24},n$b.drawTriangles=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){if(!n$a.loaded||!n$a.source)return this.sprite&&n$w.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;n$a.bitmap;var n$k=this._mixRGBandAlpha(4294967295,n$h),n$l=(n$d.length,n$f.length);this._renderKey=-1;var n$m=this._curSubmit=n$Ja.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,n$ya.create(1,0));return n$m.shaderValue.textureHost=n$a,n$m._renderType=10016,this._submits[this._submits._length++]=n$m,n$g?(n$P._tmpMatrix.a=n$g.a,n$P._tmpMatrix.b=n$g.b,n$P._tmpMatrix.c=n$g.c,n$P._tmpMatrix.d=n$g.d,n$P._tmpMatrix.tx=n$g.tx+n$b,n$P._tmpMatrix.ty=n$g.ty+n$c,n$z.mul(n$P._tmpMatrix,this._curMat,n$P._tmpMatrix)):(n$P._tmpMatrix.a=this._curMat.a,n$P._tmpMatrix.b=this._curMat.b,n$P._tmpMatrix.c=this._curMat.c,n$P._tmpMatrix.d=this._curMat.d,n$P._tmpMatrix.tx=this._curMat.tx+n$b,n$P._tmpMatrix.ty=this._curMat.ty+n$c),this._triangleMesh.addData(n$d,n$e,n$f,n$P._tmpMatrix,n$k,this),this._curSubmit._numEle+=n$l,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},n$b.transform=function(n$a,n$b,n$c,n$d,n$e,n$f){n$Z.save(this),n$z.mul(n$z.TEMP.setTo(n$a,n$b,n$c,n$d,n$e,n$f),this._curMat,this._curMat),this._curMat._checkTransform()},n$b.setTransformByMatrix=function(n$a){n$a.copyTo(this._curMat)},n$b.transformByMatrix=function(n$a){n$Z.save(this),n$z.mul(n$a,this._curMat,this._curMat),this._curMat._checkTransform()},n$b.rotate=function(n$a){n$Z.save(this),this._curMat.rotateEx(n$a)},n$b.scale=function(n$a,n$b){n$Z.save(this),this._curMat.scaleEx(n$a,n$b)},n$b.clipRect=function(n$a,n$b,n$c,n$d){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var n$e=n$ka.create(4);this.addRenderObject(n$e);var n$f=this._vb,n$g=n$f._byteLength>>2;if(n$qa.fillRectImgVb(n$f,null,n$a,n$b,n$c,n$d,n$K.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var n$h=this._curSubmit=n$fa.createSubmit(this,this._ib,n$f,(n$f._byteLength-64)/32*3,n$ya.create(2,0));n$h.shaderValue.ALPHA=1,this._submits[this._submits._length++]=n$h,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var n$i=n$ka.create(5);this.addRenderObject(n$i);var n$j=n$f.getFloat32Array(),n$k=Math.min(Math.min(Math.min(n$j[0+n$g],n$j[4+n$g]),n$j[8+n$g]),n$j[12+n$g]),n$l=Math.max(Math.max(Math.max(n$j[0+n$g],n$j[4+n$g]),n$j[8+n$g]),n$j[12+n$g]),n$m=Math.min(Math.min(Math.min(n$j[1+n$g],n$j[5+n$g]),n$j[9+n$g]),n$j[13+n$g]),n$n=Math.max(Math.max(Math.max(n$j[1+n$g],n$j[5+n$g]),n$j[9+n$g]),n$j[13+n$g]);n$X.save(this,n$i,n$a,n$b,n$c,n$d,n$k,n$m,n$l-n$k,n$n-n$m),this._curSubmit=n$fa.RENDERBASE}else{n$c*=this._curMat.a,n$d*=this._curMat.d;var n$o=n$C.TEMP;this._curMat.transformPoint(n$o.setTo(n$a,n$b)),n$c<0&&(n$o.x=n$o.x+n$c,n$c=-n$c),n$d<0&&(n$o.y=n$o.y+n$d,n$d=-n$d),this._renderKey=0;var n$p=this._curSubmit=n$ja.create(this);(this._submits[this._submits._length++]=n$p).submitIndex=this._submits._length,n$p.submitLength=9999999,n$W.save(this,n$p);var n$q=this._clipRect,n$r=n$q.x,n$s=n$q.y,n$t=n$o.x+n$c,n$u=n$o.y+n$d;n$r<n$o.x&&(n$q.x=n$o.x),n$s<n$o.y&&(n$q.y=n$o.y),n$q.width=Math.min(n$t,n$r+n$q.width)-n$q.x,n$q.height=Math.min(n$u,n$s+n$q.height)-n$q.y,this._shader2D.glTexture=null,n$p.clipRect.copyFrom(n$q),this._curSubmit=n$fa.RENDERBASE}},n$b.setIBVB=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k){if(void 0===n$i&&(n$i=0),void 0===n$j&&(n$j=0),void 0===n$k&&(n$k=0),null===n$c){if(n$r.isFlash){var n$l=n$d;n$l._selfIB||(n$l._selfIB=n$Aa.create(35044)),n$l._selfIB.clear(),n$c=n$l._selfIB}else n$c=this._ib;n$qa.expandIBQuadrangle(n$c,n$d._byteLength/(4*n$d.vertexStride*4))}if(!n$h||!n$g)throw Error("setIBVB must input:shader shaderValues");var n$m=n$ia.create(this,n$d,n$c,n$e,n$g,n$h,n$i,n$j,n$k);n$f||(n$f=n$z.EMPTY),n$f.translate(n$a,n$b),n$z.mul(n$f,this._curMat,n$m._mat),n$f.translate(-n$a,-n$b),this._submits[this._submits._length++]=n$m,this._curSubmit=n$fa.RENDERBASE,this._renderKey=0},n$b.addRenderObject=function(n$a){this._submits[this._submits._length++]=n$a},n$b.fillTrangles=function(n$a,n$b,n$c,n$d,n$e){var n$f=this._curSubmit,n$g=this._vb,n$h=this._shader2D,n$i=n$f.shaderValue,n$j=n$d.length>>4,n$k=n$a.bitmap;this._renderKey=0,n$h.glTexture==n$k&&n$h.ALPHA===n$i.ALPHA||((n$f=this._curSubmit=n$fa.createSubmit(this,this._ib,n$g,n$g._byteLength/32*3,n$ya.create(1,0))).shaderValue.textureHost=n$a,this._submits[this._submits._length++]=n$f),n$qa.fillTranglesVB(n$g,n$b,n$c,n$d,n$e||this._curMat,this._x,this._y),n$f._numEle+=6*n$j},n$b.submitElement=function(n$a,n$b){var n$c=this._submits;for(n$b<0&&(n$b=n$c._length);n$a<n$b;)n$a+=n$c[n$a].renderSubmit()},n$b.finish=function(){n$ua.mainContext.finish()},n$b.flush=function(){var n$a=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(n$a>this._ib.bufferLength/12&&n$qa.expandIBQuadrangle(this._ib,n$a),!this._isMain&&n$Q.enabled&&n$Q._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=n$Q._atlasRestore;for(var n$b=this._submits,n$c=0,n$d=n$b._length;n$c<n$d;n$c++){var n$e=n$b[n$c];10016===n$e.getRenderType()&&n$e.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),n$ba.instance&&n$ba.getInstance().reset();var n$f;for(n$c=0,n$f=this.meshlist.length;n$c<n$f;n$c++){var n$g=this.meshlist[n$c];n$g.canReuse?n$g.releaseMesh():n$g.destroy()}return this.meshlist.length=0,this._curSubmit=n$fa.RENDERBASE,this._renderKey=0,this._triangleMesh=n$Ka.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},n$b.setPathId=function(n$a){if(this.mId=n$a,-1!=this.mId){this.mHaveKey=!1;var n$b=n$M.getInstance();n$b.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,n$b.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},n$b.movePath=function(n$a,n$b){var n$c=n$a,n$d=n$b;n$a=this._curMat.a*n$c+this._curMat.c*n$d+this._curMat.tx,n$b=this._curMat.b*n$c+this._curMat.d*n$d+this._curMat.ty,this.mX+=n$a,this.mY+=n$b},n$b.beginPath=function(){var n$a=this._getPath();n$a.tempArray.length=0,n$a.closePath=!1,this.mX=0,this.mY=0},n$b.closePath=function(){this._path.closePath=!0},n$b.fill=function(n$a){void 0===n$a&&(n$a=!1);var n$b=this._getPath();this.drawPoly(0,0,n$b.tempArray,this.fillStyle._color.numColor,0,0,n$a)},n$b.stroke=function(){var n$a=this._getPath();if(0<this.lineWidth){if(-1==this.mId)n$a.drawLine(0,0,n$a.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var n$b=n$M.getInstance().shapeLineDic[this.mId];n$b.rebuild(n$a.tempArray),n$a.setGeomtry(n$b)}else n$M.getInstance().addLine(this.mId,n$a.drawLine(0,0,n$a.tempArray,this.lineWidth,this.strokeStyle._color.numColor));n$a.update();var n$c=[this.mX,this.mY],n$d=n$fa.createShape(this,n$a.ib,n$a.vb,n$a.count,n$a.offset,n$ya.create(4,0));n$d.shaderValue.ALPHA=this._shader2D.ALPHA,n$d.shaderValue.u_pos=n$c,n$d.shaderValue.u_mmat2=n$sa.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=n$d,this._renderKey=-1}},n$b.line=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=this._curSubmit,n$h=this._vb;if(n$qa.fillLineVb(n$h,this._clipRect,n$a,n$b,n$c,n$d,n$e,n$f)){this._renderKey=0;var n$i=this._shader2D,n$j=n$g.shaderValue;n$i.strokeStyle===n$j.strokeStyle&&n$i.ALPHA===n$j.ALPHA||(n$i.glTexture=null,(n$g=this._curSubmit=n$fa.createSubmit(this,this._ib,n$h,(n$h._byteLength-64)/32*3,n$ya.create(2,0))).shaderValue.strokeStyle=n$i.strokeStyle,n$g.shaderValue.mainID=2,n$g.shaderValue.ALPHA=n$i.ALPHA,this._submits[this._submits._length++]=n$g),n$g._numEle+=6}},n$b.moveTo=function(n$a,n$b,n$c){void 0===n$c&&(n$c=!0);var n$d=this._getPath();if(n$c){var n$e=n$a,n$f=n$b;n$a=this._curMat.a*n$e+this._curMat.c*n$f,n$b=this._curMat.b*n$e+this._curMat.d*n$f}n$d.addPoint(n$a,n$b)},n$b.lineTo=function(n$a,n$b,n$c){void 0===n$c&&(n$c=!0);var n$d=this._getPath();if(n$c){var n$e=n$a,n$f=n$b;n$a=this._curMat.a*n$e+this._curMat.c*n$f,n$b=this._curMat.b*n$e+this._curMat.d*n$f}n$d.addPoint(n$a,n$b)},n$b.drawCurves=function(n$a,n$b,n$c){this.setPathId(-1),this.beginPath(),this.strokeStyle=n$c[3],this.lineWidth=n$c[4];var n$d=n$c[2];n$a+=n$c[0],n$b+=n$c[1],this.movePath(n$a,n$b),this.moveTo(n$d[0],n$d[1]);for(var n$e=2,n$f=n$d.length;n$e<n$f;)this.quadraticCurveTo(n$d[n$e++],n$d[n$e++],n$d[n$e++],n$d[n$e++]);this.stroke()},n$b.arcTo=function(n$a,n$b,n$c,n$d,n$e){if(-1==this.mId||!this.mHaveKey){var n$f=0,n$g=0,n$h=0,n$i=this._getPath();this._curMat.copyTo(n$P._tmpMatrix),n$P._tmpMatrix.tx=n$P._tmpMatrix.ty=0,n$P._tempPoint.setTo(n$i.getEndPointX(),n$i.getEndPointY()),n$P._tmpMatrix.invertTransformPoint(n$P._tempPoint);var n$j=n$P._tempPoint.x-n$a,n$k=n$P._tempPoint.y-n$b,n$l=Math.sqrt(n$j*n$j+n$k*n$k);if(!(n$l<=1e-6)){var n$m=n$j/n$l,n$n=n$k/n$l,n$o=n$c-n$a,n$p=n$d-n$b,n$q=n$o*n$o+n$p*n$p,n$r=Math.sqrt(n$q);if(!(n$r<=1e-6)){var n$s=n$o/n$r,n$t=n$p/n$r,n$u=n$m+n$s,n$v=n$n+n$t,n$w=Math.sqrt(n$u*n$u+n$v*n$v);if(!(n$w<=1e-6)){var n$x=n$u/n$w,n$y=n$v/n$w,n$z=Math.acos(n$x*n$m+n$y*n$n),n$C=Math.PI/2-n$z,n$D=(n$l=n$e/Math.tan(n$C))*n$m+n$a,n$E=n$l*n$n+n$b,n$F=Math.sqrt(n$l*n$l+n$e*n$e),n$G=n$a+n$x*n$F,n$H=n$b+n$y*n$F,n$I=0,n$J=0;if(0<=n$m*n$t-n$n*n$s){var n$K=2*n$C/n$P.SEGNUM;n$I=Math.sin(n$K),n$J=Math.cos(n$K)}else n$K=2*-n$C/n$P.SEGNUM,n$I=Math.sin(n$K),n$J=Math.cos(n$K);n$g=this._curMat.a*n$D+this._curMat.c*n$E,n$h=this._curMat.b*n$D+this._curMat.d*n$E,n$g==this._path.getEndPointX()&&n$h==this._path.getEndPointY()||n$i.addPoint(n$g,n$h);var n$L=n$D-n$G,n$M=n$E-n$H;for(n$f=0;n$f<n$P.SEGNUM;n$f++){var n$N=n$L*n$J+n$M*n$I,n$O=-n$L*n$I+n$M*n$J;n$g=n$N+n$G,n$h=n$O+n$H,n$a=this._curMat.a*n$g+this._curMat.c*n$h,n$h=n$b=this._curMat.b*n$g+this._curMat.d*n$h,(n$g=n$a)==this._path.getEndPointX()&&n$h==this._path.getEndPointY()||n$i.addPoint(n$g,n$h),n$L=n$N,n$M=n$O}}}}}},n$b.arc=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){if(void 0===n$f&&(n$f=!1),void 0===n$g&&(n$g=!0),-1!=this.mId){var n$h=n$M.getInstance().shapeDic[this.mId];if(n$h&&this.mHaveKey&&!n$h.needUpdate(this._curMat))return;n$b=n$a=0}var n$i,n$j=0,n$k=0,n$l=0,n$m=0,n$n=0,n$o=0,n$p=0;if(n$k=n$e-n$d,n$f)if(Math.abs(n$k)>=2*Math.PI)n$k=2*-Math.PI;else for(;0<n$k;)n$k-=2*Math.PI;else if(Math.abs(n$k)>=2*Math.PI)n$k=2*Math.PI;else for(;n$k<0;)n$k+=2*Math.PI;n$i=n$k/(n$p=n$c<101?Math.max(10,n$k*n$c/5):n$c<201?Math.max(10,n$k*n$c/20):Math.max(10,n$k*n$c/40))/2,n$l=Math.abs(4/3*(1-Math.cos(n$i))/Math.sin(n$i)),n$f&&(n$l=-n$l);var n$q=this._getPath(),n$r=NaN,n$s=NaN;for(n$o=0;n$o<=n$p;n$o++)n$j=n$d+n$k*(n$o/n$p),n$m=n$a+Math.cos(n$j)*n$c,n$n=n$b+Math.sin(n$j)*n$c,n$g&&(n$r=n$m,n$s=n$n,n$m=this._curMat.a*n$r+this._curMat.c*n$s,n$n=this._curMat.b*n$r+this._curMat.d*n$s),n$m==this._path.getEndPointX()&&n$n==this._path.getEndPointY()||n$q.addPoint(n$m,n$n);n$m=n$a+Math.cos(n$e)*n$c,n$n=n$b+Math.sin(n$e)*n$c,n$g&&(n$r=n$m,n$s=n$n,n$m=this._curMat.a*n$r+this._curMat.c*n$s,n$n=this._curMat.b*n$r+this._curMat.d*n$s),n$m==this._path.getEndPointX()&&n$n==this._path.getEndPointY()||n$q.addPoint(n$m,n$n)},n$b.quadraticCurveTo=function(n$a,n$b,n$c,n$d){var n$e=n$l.I,n$f=n$c,n$g=n$d;n$c=this._curMat.a*n$f+this._curMat.c*n$g,n$d=this._curMat.b*n$f+this._curMat.d*n$g,n$f=n$a,n$g=n$b,n$a=this._curMat.a*n$f+this._curMat.c*n$g,n$b=this._curMat.b*n$f+this._curMat.d*n$g;for(var n$h=n$e.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),n$a,n$b,n$c,n$d],30,2),n$i=0,n$j=n$h.length/2;n$i<n$j;n$i++)this.lineTo(n$h[2*n$i],n$h[2*n$i+1],!1);this.lineTo(n$c,n$d,!1)},n$b.rect=function(n$a,n$b,n$c,n$d){this._other=this._other.make(),this._other.path||(this._other.path=new n$U),this._other.path.rect(n$a,n$b,n$c,n$d)},n$b.strokeRect=function(n$a,n$b,n$c,n$d,n$e){var n$f=.5*n$e;this.line(n$a-n$f,n$b,n$a+n$c+n$f,n$b,n$e,this._curMat),this.line(n$a+n$c,n$b,n$a+n$c,n$b+n$d,n$e,this._curMat),this.line(n$a,n$b,n$a,n$b+n$d,n$e,this._curMat),this.line(n$a-n$f,n$b+n$d,n$a+n$c+n$f,n$b+n$d,n$e,this._curMat)},n$b.clip=function(){},n$b.drawPoly=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){void 0===n$g&&(n$g=!1),this._renderKey=0,this._shader2D.glTexture=null;var n$h=this._getPath();if(-1==this.mId)n$h.polygon(n$a,n$b,n$c,n$d,n$e||1,n$f);else if(this.mHaveKey){var n$i=n$M.getInstance().shapeDic[this.mId];n$i.setMatrix(this._curMat),n$i.rebuild(n$h.tempArray),n$h.setGeomtry(n$i)}else{var n$j=n$h.polygon(n$a,n$b,n$c,n$d,n$e||1,n$f);n$M.getInstance().addShape(this.mId,n$j),n$j.setMatrix(this._curMat)}n$h.update();var n$k,n$l=[this.mX,this.mY];if((n$k=n$fa.createShape(this,n$h.ib,n$h.vb,n$h.count,n$h.offset,n$ya.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,n$k.shaderValue.u_pos=n$l,n$k.shaderValue.u_mmat2=n$sa.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=n$k,0<n$e){if(this.mHaveLineKey){var n$m=n$M.getInstance().shapeLineDic[this.mId];n$m.rebuild(n$h.tempArray),n$h.setGeomtry(n$m)}else n$M.getInstance().addShape(this.mId,n$h.drawLine(n$a,n$b,n$c,n$e,n$f));n$h.update(),(n$k=n$fa.createShape(this,n$h.ib,n$h.vb,n$h.count,n$h.offset,n$ya.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,n$k.shaderValue.u_mmat2=n$sa.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=n$k}},n$b.drawParticle=function(n$a,n$b,n$c){n$c.x=n$a,n$c.y=n$b,this._submits[this._submits._length++]=n$c},n$b._getPath=function(){return this._path||(this._path=new n$U)},n$d(0,n$b,"globalCompositeOperation",function(){return n$S.NAMES[this._nBlendType]},function(n$a){var n$b=n$S.TOINT[n$a];null==n$b||this._nBlendType===n$b||(n$V.save(this,65536,this,!0),this._curSubmit=n$fa.RENDERBASE,this._renderKey=0,this._nBlendType=n$b)}),n$d(0,n$b,"strokeStyle",function(){return this._shader2D.strokeStyle},function(n$a){this._shader2D.strokeStyle.equal(n$a)||(n$V.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=n$T.create(n$a))}),n$d(0,n$b,"globalAlpha",function(){return this._shader2D.ALPHA},function(n$a){(n$a=Math.floor(1e3*n$a)/1e3)!=this._shader2D.ALPHA&&(n$V.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=n$a)}),n$d(0,n$b,"asBitmap",null,function(n$a){if(n$a){if(this._targets||(this._targets=new n$_),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),n$d(0,n$b,"fillStyle",function(){return this._shader2D.fillStyle},function(n$a){this._shader2D.fillStyle.equal(n$a)||(n$V.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=n$T.create(n$a))}),n$d(0,n$b,"textAlign",function(){return this._other.textAlign},function(n$a){this._other.textAlign===n$a||(this._other=this._other.make(),n$V.save(this,32768,this._other,!1),this._other.textAlign=n$a)}),n$d(0,n$b,"lineWidth",function(){return this._other.lineWidth},function(n$a){this._other.lineWidth===n$a||(this._other=this._other.make(),n$V.save(this,256,this._other,!1),this._other.lineWidth=n$a)}),n$d(0,n$b,"textBaseline",function(){return this._other.textBaseline},function(n$a){this._other.textBaseline===n$a||(this._other=this._other.make(),n$V.save(this,16384,this._other,!1),this._other.textBaseline=n$a)}),n$d(0,n$b,"font",null,function(n$a){n$a!=this._other.font.toString()&&(this._other=this._other.make(),n$V.save(this,8,this._other,!1),this._other.font===n$oa.EMPTY?this._other.font=new n$oa(n$a):this._other.font.setFont(n$a))}),n$P.__init__=function(){n$c.DEFAULT=new n$c},n$P._tempPoint=new n$C,n$P._SUBMITVBSIZE=32e3,n$P._MAXSIZE=99999999,n$P._RECTVBSIZE=16,n$P.MAXCLIPRECT=new n$D(0,0,99999999,99999999),n$P._COUNT=0,n$P._tmpMatrix=new n$z,n$P.SEGNUM=32,n$P._contextcount=0,n$g(n$P,["_fontTemp",function(){return this._fontTemp=new n$oa},"_drawStyleTemp",function(){return this._drawStyleTemp=new n$T(null)}]),n$P.__init$=function(){n$c=function(){function n$a(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=n$oa.EMPTY}n$m(n$a,"");var n$b=n$a.prototype;return n$b.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=n$oa.EMPTY},n$b.make=function(){return this===n$a.DEFAULT?new n$a:this},n$a.DEFAULT=null,n$a}()},n$P}(),n$ya=function(n$a){function n$d(n$a,n$b){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,n$d.__super.call(this),this.defines=new n$Ea,this.position=n$d._POSITION,this.mainID=n$a,this.subID=n$b,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=n$a|n$b,this._inClassCache=n$d._cache[this._cacheID],0<n$a&&!this._inClassCache&&(this._inClassCache=n$d._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}n$m(n$d,"laya.webgl.shader.d2.value.Value2D",n$O);var n$b=n$d.prototype;return n$b.setValue=function(n$a){},n$b.refresh=function(){var n$a=this.size;return n$a[0]=n$sa.width,n$a[1]=n$sa.height,this.alpha=this.ALPHA*n$sa.worldAlpha,this.mmat=n$sa.worldMatrix4,this},n$b._ShaderWithCompile=function(){return n$Ya.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,n$_a.create)},n$b._withWorldShaderDefines=function(){var n$a=n$sa.worldShaderDefines,n$b=n$Ya.sharders[this.mainID|this.defines._value|n$a.getValue()];if(!n$b){var n$c,n$d={};for(n$c in this.defines.toNameDic())n$d[n$c]="";for(n$c in n$a.toNameDic())n$d[n$c]="";n$b=n$Ya.withCompile2D(0,this.mainID,n$d,this.mainID|this.defines._value|n$a.getValue(),n$_a.create)}var n$e=n$sa.worldFilters;if(!n$e)return n$b;for(var n$f,n$g=n$e.length,n$h=0;n$h<n$g;n$h++)(n$f=n$e[n$h])&&n$f.action.setValue(this);return n$b},n$b.upload=function(){var n$a=n$sa;this.alpha=this.ALPHA*n$a.worldAlpha,n$sa.worldMatrix4!==n$sa.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),n$ua.shaderHighPrecision&&this.defines.add(1024);var n$b,n$c=n$a.worldShaderDefines?this._withWorldShaderDefines():n$Ya.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=n$a.width,this.size[1]=n$a.height,this.mmat=n$a.worldMatrix4,n$La.activeShader!==n$c?n$c._shaderValueWidth!==n$a.width||n$c._shaderValueHeight!==n$a.height?(n$c._shaderValueWidth=n$a.width,n$c._shaderValueHeight=n$a.height):n$b=n$c._params2dQuick2||n$c._make2dQuick2():n$c._shaderValueWidth!==n$a.width||n$c._shaderValueHeight!==n$a.height?(n$c._shaderValueWidth=n$a.width,n$c._shaderValueHeight=n$a.height):n$b=n$c._params2dQuick1||n$c._make2dQuick1(),n$c.upload(this,n$b)},n$b.setFilters=function(n$a){if(this.filters=n$a)for(var n$b,n$c=n$a.length,n$d=0;n$d<n$c;n$d++)(n$b=n$a[n$d])&&(this.defines.add(n$b.type),n$b.action.setValue(this))},n$b.clear=function(){this.defines.setValue(this.subID)},n$b.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},n$d._initone=function(n$a,n$b){n$d._typeClass[n$a]=n$b,n$d._cache[n$a]=[],n$d._cache[n$a]._length=0},n$d.__init__=function(){n$d._POSITION=[2,5126,!1,4*n$pa.BYTES_PE,0],n$d._TEXCOORD=[2,5126,!1,4*n$pa.BYTES_PE,2*n$pa.BYTES_PE],n$d._initone(2,n$Pa),n$d._initone(4,n$Sa),n$d._initone(256,n$Qa),n$d._initone(512,n$Oa),n$d._initone(1,n$Ra),n$d._initone(65,n$$a),n$d._initone(9,n$Ra)},n$d.create=function(n$a,n$b){var n$c=n$d._cache[n$a|n$b];return n$c._length?n$c[--n$c._length]:new n$d._typeClass[n$a|n$b](n$b)},n$d._POSITION=null,n$d._TEXCOORD=null,n$d._cache=[],n$d._typeClass=[],n$d.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n$d}(),n$za=function(n$a){function n$q(n$a,n$b){n$q.__super.call(this,n$a,n$b)}n$m(n$q,"laya.webgl.utils.RenderSprite3D",n$s);var n$b=n$q.prototype;return n$b.onCreate=function(n$a){switch(n$a){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},n$b._mask=function(n$a,n$b,n$c,n$d){var n$e,n$f,n$g=this._next,n$h=n$a.mask;if(n$h){n$b.ctx.save();var n$i=n$b.ctx.globalCompositeOperation,n$j=new n$D;if(n$j.copyFrom(n$h.getBounds()),n$j.width=Math.round(n$j.width),n$j.height=Math.round(n$j.height),n$j.x=Math.round(n$j.x),n$j.y=Math.round(n$j.y),0<n$j.width&&0<n$j.height){var n$k=n$a._style._tf,n$l=n$ha.create();n$l.addValue("bounds",n$j),n$e=n$ga.create([n$l,n$b],laya.webgl.utils.RenderSprite3D.tmpTarget),n$b.addRenderObject(n$e),n$h.render(n$b,-n$j.x,-n$j.y),n$e=n$ga.create([n$l],laya.webgl.utils.RenderSprite3D.endTmpTarget),n$b.addRenderObject(n$e),n$b.ctx.save(),n$b.clipRect(n$c-n$k.translateX+n$j.x,n$d-n$k.translateY+n$j.y,n$j.width,n$j.height),n$g._fun.call(n$g,n$a,n$b,n$c,n$d),n$b.ctx.restore(),n$f=n$ka.create(6),n$i=n$b.ctx.globalCompositeOperation,n$f.blendMode="mask",n$b.addRenderObject(n$f),n$z.TEMP.identity();var n$m=n$ya.create(1,0),n$n=n$K.INV_UV,n$o=n$j.width,n$p=n$j.height;(n$j.width<32||n$j.height<32)&&((n$n=n$q.tempUV)[0]=0,n$n[1]=0,n$n[2]=32<=n$j.width?1:n$j.width/32,n$n[3]=0,n$n[4]=32<=n$j.width?1:n$j.width/32,n$n[5]=32<=n$j.height?1:n$j.height/32,n$n[6]=0,n$n[7]=32<=n$j.height?1:n$j.height/32,n$j.width=32<=n$j.width?n$j.width:32,n$j.height=32<=n$j.height?n$j.height:32,n$n[1]*=-1,n$n[3]*=-1,n$n[5]*=-1,n$n[7]*=-1,n$n[1]+=1,n$n[3]+=1,n$n[5]+=1,n$n[7]+=1),n$b.ctx.drawTarget(n$l,n$c+n$j.x-n$k.translateX,n$d+n$j.y-n$k.translateY,n$o,n$p,n$z.TEMP,"tmpTarget",n$m,n$n,6),n$e=n$ga.create([n$l],laya.webgl.utils.RenderSprite3D.recycleTarget),n$b.addRenderObject(n$e),(n$f=n$ka.create(6)).blendMode=n$i,n$b.addRenderObject(n$f)}n$b.ctx.restore()}else n$g._fun.call(n$g,n$a,n$b,n$c,n$d)},n$b._blend=function(n$a,n$b,n$c,n$d){var n$e=n$a._style,n$f=this._next;n$e.blendMode?(n$b.ctx.save(),n$b.ctx.globalCompositeOperation=n$e.blendMode,n$f._fun.call(n$f,n$a,n$b,n$c,n$d),n$b.ctx.restore()):n$f._fun.call(n$f,n$a,n$b,n$c,n$d)},n$b._transform=function(n$a,n$b,n$c,n$d){var n$e=n$a.transform,n$f=this._next;if(n$e&&n$f!=n$s.NORENDER){var n$g=n$b.ctx;n$a._style;n$e.tx=n$c,n$e.ty=n$d;var n$h=n$g._getTransformMatrix(),n$i=n$h.clone();n$z.mul(n$e,n$h,n$h),n$h._checkTransform(),n$e.tx=n$e.ty=0,n$f._fun.call(n$f,n$a,n$b,0,0),n$i.copyTo(n$h),n$i.destroy()}else n$f._fun.call(n$f,n$a,n$b,n$c,n$d)},n$q.tmpTarget=function(n$a,n$b){var n$c=n$a.getValue("bounds"),n$d=n$Ma.create(n$c.width,n$c.height);n$d.start(),n$d.clear(0,0,0,0),n$a.addValue("tmpTarget",n$d)},n$q.endTmpTarget=function(n$a){n$a.getValue("tmpTarget").end()},n$q.recycleTarget=function(n$a){n$a.getValue("tmpTarget").recycle(),n$a.recycle()},n$g(n$q,["tempUV",function(){return this.tempUV=new Array(8)}]),n$q}(),n$Ca=function(n$a){function n$b(){this.data=null,n$b.__super.call(this)}n$m(n$b,"laya.filters.webgl.ColorFilterActionGL",n$N);var n$c=n$b.prototype;return n$w.imps(n$c,{"laya.filters.IFilterActionGL":!0}),n$c.setValue=function(n$a){n$a.colorMat=this.data._mat,n$a.colorAlpha=this.data._alpha},n$c.apply3d=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$a.getValue("bounds"),n$g=n$ya.create(1,0);n$g.setFilters([this.data]);var n$h=n$z.TEMP;n$h.identity(),n$c.ctx.drawTarget(n$a,0,0,n$f.width,n$f.height,n$h,"src",n$g)},n$b}(),n$Da=function(n$a){function n$f(n$a,n$b,n$c,n$d,n$e){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,n$f.__super.call(this,n$a,n$b,n$e),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new n$Ta,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=n$c,this._atlasCanvas.height=n$d,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}n$m(n$f,"laya.webgl.atlas.Atlaser",n$P);var n$b=n$f.prototype;return n$b.computeUVinAtlasTexture=function(n$a,n$b,n$c,n$d){var n$e=n$Q.atlasTextureWidth,n$f=n$Q.atlasTextureHeight,n$g=n$c/n$e,n$h=n$d/n$f,n$i=(n$c+n$a.bitmap.width)/n$e,n$j=(n$d+n$a.bitmap.height)/n$f,n$k=n$a.bitmap.width/n$e,n$l=n$a.bitmap.height/n$f;n$a.uv=[n$g+n$b[0]*n$k,n$h+n$b[1]*n$l,n$i-(1-n$b[2])*n$k,n$h+n$b[3]*n$l,n$i-(1-n$b[4])*n$k,n$j-(1-n$b[5])*n$l,n$g+n$b[6]*n$k,n$j-(1-n$b[7])*n$l]},n$b.findBitmapIsExist=function(n$a){if(n$a instanceof laya.webgl.resource.WebGLImage){var n$b=n$a,n$c=n$b.url,n$d=this._InAtlasWebGLImagesKey[n$c||n$b.id];if(n$d)return n$d.offsetInfoID}return-1},n$b.addToAtlasTexture=function(n$a,n$b,n$c){if(n$a instanceof laya.webgl.resource.WebGLImage){var n$d=n$a,n$e=n$d.url;this._InAtlasWebGLImagesKey[n$e||n$d.id]={bitmap:n$a,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([n$b,n$c])}this._atlasCanvas.texSubImage2D(n$b,n$c,n$a.atlasSource),n$a.clearAtlasSource()},n$b.addToAtlas=function(n$a,n$b,n$c){n$a._atlasID=this._inAtlasTextureKey.length;var n$d=n$a.uv.slice(),n$e=n$a.bitmap;this._inAtlasTextureKey.push(n$a),this._inAtlasTextureOriUVValue.push(n$d),this._inAtlasTextureBitmapValue.push(n$e),this.computeUVinAtlasTexture(n$a,n$d,n$b,n$c),n$a.bitmap=this._atlasCanvas},n$b.clear=function(){for(var n$a=0,n$b=this._inAtlasTextureKey.length;n$a<n$b;n$a++)this._inAtlasTextureKey[n$a].bitmap=this._inAtlasTextureBitmapValue[n$a],this._inAtlasTextureKey[n$a].uv=this._inAtlasTextureOriUVValue[n$a],this._inAtlasTextureKey[n$a]._atlasID=-1,this._inAtlasTextureKey[n$a].bitmap.lock=!1,this._inAtlasTextureKey[n$a].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},n$b.dispose=function(){this.clear(),this._atlasCanvas.destroy()},n$d(0,n$b,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),n$d(0,n$b,"texture",function(){return this._atlasCanvas}),n$d(0,n$b,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),n$f}(),n$Ea=function(n$a){function n$c(){n$c.__super.call(this,n$c.__name2int,n$c.__int2name,n$c.__int2nameMap)}return n$m(n$c,"laya.webgl.shader.d2.ShaderDefines2D",n$B),n$c.__init__=function(){n$c.reg("TEXTURE2D",1),n$c.reg("COLOR2D",2),n$c.reg("PRIMITIVE",4),n$c.reg("GLOW_FILTER",8),n$c.reg("BLUR_FILTER",16),n$c.reg("COLOR_FILTER",32),n$c.reg("COLOR_ADD",64),n$c.reg("WORLDMAT",128),n$c.reg("FILLTEXTURE",256),n$c.reg("FSHIGHPRECISION",1024),n$c.reg("TXTALPHA",2048),n$c.reg("TXTCOMPRESS",4096)},n$c.reg=function(n$a,n$b){n$B._reg(n$a,n$b,n$c.__name2int,n$c.__int2name)},n$c.toText=function(n$a,n$b,n$c){return n$B._toText(n$a,n$b,n$c)},n$c.toInt=function(n$a){return n$B._toInt(n$a,n$c.__name2int)},n$c.TEXTURE2D=1,n$c.COLOR2D=2,n$c.PRIMITIVE=4,n$c.FILTERGLOW=8,n$c.FILTERBLUR=16,n$c.FILTERCOLOR=32,n$c.COLORADD=64,n$c.WORLDMAT=128,n$c.FILLTEXTURE=256,n$c.SKINMESH=512,n$c.SHADERDEFINE_FSHIGHPRECISION=1024,n$c.TXTALPHA=2048,n$c.TXTCOMPRESS=4096,n$c.__name2int={},n$c.__int2name=[],n$c.__int2nameMap=[],n$c}(),n$Fa=(function(n$a){function n$h(n$a,n$b,n$c,n$d,n$e,n$f,n$g){n$h.__super.call(this,n$a,n$b,n$c,n$d,40,n$e,n$f,n$g)}n$m(n$h,"laya.webgl.shapes.Ellipse",n$ca)}(),function(n$a){function n$f(n$a,n$b,n$c,n$d,n$e){this._points=[],this.rebuild(n$c),n$f.__super.call(this,n$a,n$b,0,0,0,n$e,n$d,n$e,0)}n$m(n$f,"laya.webgl.shapes.Line",n$ca);var n$b=n$f.prototype;return n$b.rebuild=function(n$a){var n$b=n$a.length;n$b!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(n$b/2-1)),this.mFloat32Array=new Float32Array(5*n$b)),this._points.length=0;for(var n$c=NaN,n$d=NaN,n$e=-1,n$f=-1,n$g=n$a.length/2,n$h=0;n$h<n$g;n$h++)n$c=n$a[2*n$h],n$d=n$a[2*n$h+1],(.01<Math.abs(n$e-n$c)||.01<Math.abs(n$f-n$d))&&this._points.push(n$c,n$d),n$e=n$c,n$f=n$d},n$b.getData=function(n$a,n$b,n$c){var n$d=[],n$e=[];0<this.borderWidth&&this.createLine2(this._points,n$d,this.borderWidth,n$c,n$e,this._points.length/2),this.mUint16Array.set(n$d,0),this.mFloat32Array.set(n$e,0),n$a.append(this.mUint16Array),n$b.append(this.mFloat32Array)},n$f}()),n$Ga=function(n$a){function n$l(n$a,n$b,n$c,n$d,n$e){this._points=[];for(var n$f=NaN,n$g=NaN,n$h=-1,n$i=-1,n$j=n$c.length/2-1,n$k=0;n$k<n$j;n$k++)n$f=n$c[2*n$k],n$g=n$c[2*n$k+1],(.01<Math.abs(n$h-n$f)||.01<Math.abs(n$i-n$g))&&this._points.push(n$f,n$g),n$h=n$f,n$i=n$g;n$f=n$c[2*n$j],n$g=n$c[2*n$j+1],n$h=this._points[0],n$i=this._points[1],(.01<Math.abs(n$h-n$f)||.01<Math.abs(n$i-n$g))&&this._points.push(n$f,n$g),n$l.__super.call(this,n$a,n$b,0,0,this._points.length/2,0,n$d,n$e)}n$m(n$l,"laya.webgl.shapes.LoopLine",n$ca);var n$b=n$l.prototype;return n$b.getData=function(n$a,n$b,n$c){if(0<this.borderWidth){for(var n$d=this.color,n$e=(n$d>>16&255)/255,n$f=(n$d>>8&255)/255,n$g=(255&n$d)/255,n$h=[],n$i=0,n$j=0,n$k=[],n$l=Math.floor(this._points.length/2),n$m=0;n$m<n$l;n$m++)n$i=this._points[2*n$m],n$j=this._points[2*n$m+1],n$h.push(this.x+n$i,this.y+n$j,n$e,n$f,n$g);this.createLoopLine(n$h,n$k,this.borderWidth,n$c+n$h.length/5),n$a.append(new Uint16Array(n$k)),n$b.append(new Float32Array(n$h))}},n$b.createLoopLine=function(n$a,n$b,n$c,n$d,n$e,n$f){n$a.length;var n$g=n$a.concat(),n$h=n$e||n$a,n$i=this.borderColor,n$j=(n$i>>16&255)/255,n$k=(n$i>>8&255)/255,n$l=(255&n$i)/255,n$m=[n$g[0],n$g[1]],n$n=[n$g[n$g.length-5],n$g[n$g.length-4]],n$o=n$n[0]+.5*(n$m[0]-n$n[0]),n$p=n$n[1]+.5*(n$m[1]-n$n[1]);n$g.unshift(n$o,n$p,0,0,0),n$g.push(n$o,n$p,0,0,0);var n$q,n$r,n$s,n$t,n$u,n$v,n$w,n$x,n$y,n$z,n$C,n$D,n$E,n$F,n$G,n$H,n$I,n$J,n$K,n$L,n$M=n$g.length/5,n$N=n$d,n$O=n$c/2;n$s=n$g[0],n$t=n$g[1],n$z=n$s-(n$u=n$g[5]),n$y=(n$y=-(n$t-(n$v=n$g[6])))/(n$L=Math.sqrt(n$y*n$y+n$z*n$z))*n$O,n$z=n$z/n$L*n$O,n$h.push(n$s-n$y,n$t-n$z,n$j,n$k,n$l,n$s+n$y,n$t+n$z,n$j,n$k,n$l);for(var n$P=1;n$P<n$M-1;n$P++)n$s=n$g[5*(n$P-1)],n$t=n$g[5*(n$P-1)+1],n$u=n$g[5*n$P],n$v=n$g[5*n$P+1],n$w=n$g[5*(n$P+1)],n$x=n$g[5*(n$P+1)+1],n$z=n$s-n$u,n$D=n$u-n$w,n$G=(-(n$y=(n$y=-(n$t-n$v))/(n$L=Math.sqrt(n$y*n$y+n$z*n$z))*n$O)+n$s)*(-(n$z=n$z/n$L*n$O)+n$v)-(-n$y+n$u)*(-n$z+n$t),n$J=(-(n$C=(n$C=-(n$v-n$x))/(n$L=Math.sqrt(n$C*n$C+n$D*n$D))*n$O)+n$w)*(-(n$D=n$D/n$L*n$O)+n$v)-(-n$C+n$u)*(-n$D+n$x),n$K=(n$E=-n$z+n$t-(-n$z+n$v))*(n$I=-n$C+n$u-(-n$C+n$w))-(n$H=-n$D+n$x-(-n$D+n$v))*(n$F=-n$y+n$u-(-n$y+n$s)),Math.abs(n$K)<.1?(n$K+=10.1,n$h.push(n$u-n$y,n$v-n$z,n$j,n$k,n$l,n$u+n$y,n$v+n$z,n$j,n$k,n$l)):(((n$q=(n$F*n$J-n$I*n$G)/n$K)-n$u)*(n$q-n$u)+((n$r=(n$H*n$G-n$E*n$J)/n$K)-n$v)+(n$r-n$v),n$h.push(n$q,n$r,n$j,n$k,n$l,n$u-(n$q-n$u),n$v-(n$r-n$v),n$j,n$k,n$l));n$f&&(n$b=n$f);var n$Q=this.edges+1;for(n$P=1;n$P<n$Q;n$P++)n$b.push(n$N+2*(n$P-1),n$N+2*(n$P-1)+1,n$N+2*n$P+1,n$N+2*n$P+1,n$N+2*n$P,n$N+2*(n$P-1));return n$b.push(n$N+2*(n$P-1),n$N+2*(n$P-1)+1,n$N+1,n$N+1,n$N,n$N+2*(n$P-1)),n$h},n$l}(),n$Ha=function(n$a){function n$g(n$a,n$b,n$c,n$d,n$e,n$f){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=n$z.create(),this._points=n$c.slice(0,n$c.length),n$g.__super.call(this,n$a,n$b,0,0,this._points.length/2,n$d,n$e,n$f)}n$m(n$g,"laya.webgl.shapes.Polygon",n$ca);var n$b=n$g.prototype;return n$b.rebuild=function(n$a){this._repaint||(this._points.length=0,this._points=this._points.concat(n$a))},n$b.setMatrix=function(n$a){n$a.copyTo(this._mat)},n$b.needUpdate=function(n$a){return this._repaint=this._mat.a==n$a.a&&this._mat.b==n$a.b&&this._mat.c==n$a.c&&this._mat.d==n$a.d&&this._mat.tx==n$a.tx&&this._mat.ty==n$a.ty,!this._repaint},n$b.getData=function(n$a,n$b,n$c){var n$d,n$e=0,n$f=this._points,n$g=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=n$c){for(this._start=n$c,n$d=[],n$g=this.earcutTriangles.length,n$e=0;n$e<n$g;n$e++)n$d.push(this.earcutTriangles[n$e]+n$c);this.mUint16Array=new Uint16Array(n$d)}}else{this._start=n$c,n$d=[];var n$h=[],n$i=[],n$j=this.color,n$k=(n$j>>16&255)/255,n$l=(n$j>>8&255)/255,n$m=(255&n$j)/255;for(n$g=Math.floor(n$f.length/2),n$e=0;n$e<n$g;n$e++)n$h.push(this.x+n$f[2*n$e],this.y+n$f[2*n$e+1],n$k,n$l,n$m),n$i.push(this.x+n$f[2*n$e],this.y+n$f[2*n$e+1]);for(this.earcutTriangles=n$da.earcut(n$i,null,2),n$g=this.earcutTriangles.length,n$e=0;n$e<n$g;n$e++)n$d.push(this.earcutTriangles[n$e]+n$c);this.mUint16Array=new Uint16Array(n$d),this.mFloat32Array=new Float32Array(n$h)}n$a.append(this.mUint16Array),n$b.append(this.mFloat32Array)},n$g}(),n$Ia=function(n$a){function n$f(){this._matrix=new n$z,this._matrix4=n$pa.defaultMatrix4.concat(),n$f.__super.call(this,1e4),this.shaderValue=new n$ya(0,0)}n$m(n$f,"laya.webgl.submit.SubmitCanvas",n$fa);var n$b=n$f.prototype;return n$b.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var n$a=n$sa.worldAlpha,n$b=n$sa.worldMatrix4,n$c=n$sa.worldMatrix,n$d=n$sa.worldFilters,n$e=n$sa.worldShaderDefines,n$f=this.shaderValue,n$g=this._matrix,n$h=this._matrix4,n$i=n$z.TEMP;return n$z.mul(n$g,n$c,n$i),n$h[0]=n$i.a,n$h[1]=n$i.b,n$h[4]=n$i.c,n$h[5]=n$i.d,n$h[12]=n$i.tx,n$h[13]=n$i.ty,n$sa.worldMatrix=n$i.clone(),n$sa.worldMatrix4=n$h,n$sa.worldAlpha=n$sa.worldAlpha*n$f.alpha,n$f.filters&&n$f.filters.length&&(n$sa.worldFilters=n$f.filters,n$sa.worldShaderDefines=n$f.defines),this._ctx_src.flush(),n$sa.worldAlpha=n$a,n$sa.worldMatrix4=n$b,n$sa.worldMatrix.destroy(),n$sa.worldMatrix=n$c,n$sa.worldFilters=n$d,n$sa.worldShaderDefines=n$e,1},n$b.releaseRender=function(){var n$a=n$f._cache;this._ctx_src=null,n$a[n$a._length++]=this},n$b.getRenderType=function(){return 10003},n$f.create=function(n$a,n$b,n$c){var n$d=n$f._cache._length?n$f._cache[--n$f._cache._length]:new n$f;n$d._ctx_src=n$a;var n$e=n$d.shaderValue;return n$e.alpha=n$b,n$e.defines.setValue(0),n$c&&n$c.length&&n$e.setFilters(n$c),n$d},n$f._cache=((n$f._cache=[])._length=0,n$f._cache),n$f}(),n$Ja=function(n$a){function n$j(n$a){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===n$a&&(n$a=1e4),n$j.__super.call(this,n$a)}n$m(n$j,"laya.webgl.submit.SubmitTexture",n$fa);var n$b=n$j.prototype;return n$b.releaseRender=function(){var n$a=n$j._cache;(n$a[n$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},n$b.addTexture=function(n$a,n$b){this._texsID[this._texs.length]=n$a._uvID,this._texs.push(n$a),this._vbPos.push(n$b)},n$b.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var n$a=this.shaderValue.textureHost.bitmap;if(null!==n$a)for(var n$b=this._vb.getFloat32Array(),n$c=0,n$d=this._texs.length;n$c<n$d;n$c++){var n$e=this._texs[n$c];n$e.active();var n$f=n$e.uv;if(this._texsID[n$c]!==n$e._uvID){this._texsID[n$c]=n$e._uvID;var n$g=this._vbPos[n$c];n$b[n$g+2]=n$f[0],n$b[n$g+3]=n$f[1],n$b[n$g+6]=n$f[2],n$b[n$g+7]=n$f[3],n$b[n$g+10]=n$f[4],n$b[n$g+11]=n$f[5],n$b[n$g+14]=n$f[6],n$b[n$g+15]=n$f[7],this._vb.setNeedUpload()}n$e.bitmap!==n$a&&(this._isSameTexture=!1)}}},n$b.renderSubmit=function(){if(0===this._numEle)return n$j._shaderSet=!1,1;var n$a=this.shaderValue.textureHost;if(n$a){var n$b=n$a.source;if(!n$a.bitmap||!n$b)return n$j._shaderSet=!1,1;this.shaderValue.texture=n$b,n$a.alphaTexture&&n$a.alphaTexture.source&&(this.shaderValue.texture1=n$a.alphaTexture.source)}this._vb.bind_upload(this._ib);var n$c=n$ua.mainContext;if(n$S.activeBlendFunction!==this._blendFn&&(n$c.enable(3042),this._blendFn(n$c),n$S.activeBlendFunction=this._blendFn),n$G.drawCall++,n$G.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&n$La.activeShader&&n$j._shaderSet?(n$La.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&n$La.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),n$j._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var n$d=n$a.bitmap,n$e=0,n$f=n$La.activeShader,n$g=0,n$h=this._texs.length;n$g<n$h;n$g++){var n$i=this._texs[n$g];n$i.bitmap===n$d&&n$g+1!==n$h||(n$f.uploadTexture2D(n$i.source),n$c.drawElements(4,6*(n$g-n$e+1),5123,this._startIdx+6*n$e*n$pa.BYTES_PIDX),n$d=n$i.bitmap,n$e=n$g)}else n$c.drawElements(4,this._numEle,5123,this._startIdx);return 1},n$j.create=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$j._cache._length?n$j._cache[--n$j._cache._length]:new n$j;null==n$c&&((n$c=n$f._selfVb||(n$f._selfVb=n$Ba.create(-1))).clear(),n$d=0),n$f._ib=n$b,n$f._vb=n$c,n$f._startIdx=n$d*n$pa.BYTES_PIDX,n$f._numEle=0;var n$g=n$a._nBlendType;n$f._blendFn=n$a._targets?n$S.targetFns[n$g]:n$S.fns[n$g],n$f.shaderValue=n$e,n$f.shaderValue.setValue(n$a._shader2D);var n$h=n$a._shader2D.filters;return n$h&&n$f.shaderValue.setFilters(n$h),n$f},n$j._cache=((n$j._cache=[])._length=0,n$j._cache),n$j._shaderSet=!0,n$j}(),n$Ka=function(n$a){function n$r(){n$r.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}n$m(n$r,"laya.webgl.utils.MeshTexture",n$ra);var n$b=n$r.prototype;return n$b.addData=function(n$a,n$b,n$c,n$d,n$e,n$f){for(var n$g=n$a.length/2,n$h=this._vb.needSize(n$g*n$r.const_stride)>>2,n$i=this._vb.getFloat32Array(),n$j=0,n$k=0;n$k<n$g;n$k++){var n$l=n$a[n$j],n$m=n$a[n$j+1],n$n=n$l*n$d.a+n$m*n$d.c+n$d.tx,n$o=n$l*n$d.b+n$m*n$d.d+n$d.ty;n$i[n$h++]=n$n,n$i[n$h++]=n$o,n$i[n$h++]=n$b[n$j],n$i[n$h++]=n$b[n$j+1],n$j+=2}this._vb.setNeedUpload();var n$p=this.vertNum;if(0<n$p){(n$g=n$c.length)>n$r.tmpIdx.length&&(n$r.tmpIdx=new Uint16Array(n$g));for(var n$q=0;n$q<n$g;n$q++)n$r.tmpIdx[n$q]=n$c[n$q]+n$p;this._ib.appendU16Array(n$r.tmpIdx,n$c.length)}else this._ib.append(n$c);this._ib.setNeedUpload(),this.vertNum+=n$g,this.indexNum+=n$c.length},n$b.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},n$b.destroy=function(){this._ib.destroy(),this._vb.destroy()},n$r.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new n$r},n$r.const_stride=16,n$r._POOL=[],n$g(n$r,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),n$r}(),n$La=function(n$a){function n$b(){n$b.__super.call(this),this.lock=!0}return n$m(n$b,"laya.webgl.shader.BaseShader",n$t),n$b.activeShader=null,n$b.bindShader=null,n$b}(),n$Ma=function(n$b){function n$k(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===n$c&&(n$c=6408),void 0===n$d&&(n$d=5121),void 0===n$e&&(n$e=34041),void 0===n$f&&(n$f=!1),void 0===n$g&&(n$g=!1),void 0===n$h&&(n$h=-1),void 0===n$i&&(n$i=-1),this._type=1,this._w=n$a,this._h=n$b,this._surfaceFormat=n$c,this._surfaceType=n$d,this._depthStencilFormat=n$e,n$r.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=n$f,this._repeat=n$g,this._minFifter=n$h,this._magFifter=n$i,this._createWebGLRenderTarget(),this.bitmap.lock=!0,n$k.__super.call(this,this.bitmap,n$K.INV_UV)}n$m(n$k,"laya.webgl.resource.RenderTarget2D",n$b);var n$a=n$k.prototype;return n$w.imps(n$a,{"laya.resource.IDispose":!0}),n$a.getType=function(){return this._type},n$a.getTexture=function(){return this},n$a.size=function(n$a,n$b){this._w==n$a&&this._h==n$b||(this._w=n$a,this._h=n$b,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},n$a.release=function(){this.destroy()},n$a.recycle=function(){n$k.POOL.push(this)},n$a.start=function(){var n$a=n$ua.mainContext;return this._preRenderTarget=n$sa.curRenderTarget,n$sa.curRenderTarget=this,n$a.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(n$a.viewport(0,0,this._w,this._h),this._svWidth=n$sa.width,this._svHeight=n$sa.height,n$sa.width=this._w,n$sa.height=this._h,n$La.activeShader=null),this},n$a.clear=function(n$a,n$b,n$c,n$d){void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=1);var n$e=n$ua.mainContext;n$e.clearColor(n$a,n$b,n$c,n$d);var n$f=16384;switch(this._depthStencilFormat){case 33189:n$f|=256;break;case 36168:n$f|=1024;break;case 34041:n$f|=256,n$f|=1024}n$e.clear(n$f)},n$a.end=function(){var n$a=n$ua.mainContext;n$a.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,n$sa.curRenderTarget=this._preRenderTarget,1==this._type?(n$a.viewport(0,0,this._svWidth,this._svHeight),n$sa.width=this._svWidth,n$sa.height=this._svHeight,n$La.activeShader=null):n$a.viewport(0,0,n$w.stage.width,n$w.stage.height)},n$a.getData=function(n$a,n$b,n$c,n$d){var n$e=n$ua.mainContext;if(n$e.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===n$e.checkFramebufferStatus(36160)))return n$e.bindFramebuffer(36160,null),null;var n$f=new Uint8Array(this._w*this._h*4);return n$e.readPixels(n$a,n$b,n$c,n$d,this._surfaceFormat,this._surfaceType,n$f),n$e.bindFramebuffer(36160,null),n$f},n$a.destroy=function(n$a){void 0===n$a&&(n$a=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,n$b.prototype.destroy.call(this))},n$a.dispose=function(){},n$a._createWebGLRenderTarget=function(){this.bitmap=new n$Wa(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(n$a){this.event("recovered")})},n$d(0,n$a,"surfaceFormat",function(){return this._surfaceFormat}),n$d(0,n$a,"magFifter",function(){return this._magFifter}),n$d(0,n$a,"surfaceType",function(){return this._surfaceType}),n$d(0,n$a,"mipMap",function(){return this._mipMap}),n$d(0,n$a,"depthStencilFormat",function(){return this._depthStencilFormat}),n$d(0,n$a,"minFifter",function(){return this._minFifter}),n$d(0,n$a,"source",function(){return this._alreadyResolved?n$w.superGet(n$K,this,"source"):null}),n$k.create=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){void 0===n$c&&(n$c=6408),void 0===n$d&&(n$d=5121),void 0===n$e&&(n$e=34041),void 0===n$f&&(n$f=!1),void 0===n$g&&(n$g=!1),void 0===n$h&&(n$h=-1),void 0===n$i&&(n$i=-1);var n$j=n$k.POOL.pop();return n$j||(n$j=new n$k(n$a,n$b)),n$j.bitmap&&n$j._w==n$a&&n$j._h==n$b&&n$j._surfaceFormat==n$c&&n$j._surfaceType==n$d&&n$j._depthStencilFormat==n$e&&n$j._mipMap==n$f&&n$j._repeat==n$g&&n$j._minFifter==n$h&&n$j._magFifter==n$i||(n$j._w=n$a,n$j._h=n$b,n$j._surfaceFormat=n$c,n$j._surfaceType=n$d,n$j._depthStencilFormat=n$e,n$r.isConchWebGL&&34041===n$j._depthStencilFormat&&(n$j._depthStencilFormat=33189),n$j._mipMap=n$f,n$j._repeat=n$g,n$j._minFifter=n$h,n$j._magFifter=n$i,n$j.release(),n$j._createWebGLRenderTarget()),n$j},n$k.TYPE2D=1,n$k.TYPE3D=2,n$k.POOL=[],n$k}(n$K),n$Na=function(n$a){function n$b(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,n$b.__super.call(this),n$b._gl=n$ua.mainContext}n$m(n$b,"laya.webgl.utils.Buffer",n$t);var n$c=n$b.prototype;return n$c._bind=function(){this.activeResource(),n$b._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(n$b._bindVertexBuffer=this._glBuffer),n$b._gl.bindBuffer(this._bufferType,n$b._bindActive[this._bufferType]=this._glBuffer),n$La.activeShader=null)},n$c.recreateResource=function(){this._glBuffer||(this._glBuffer=n$b._gl.createBuffer()),this.completeCreate()},n$c.disposeResource=function(){this._glBuffer&&(n$ua.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},n$d(0,n$c,"bufferUsage",function(){return this._bufferUsage}),n$b._gl=null,n$b._bindActive={},n$b._bindVertexBuffer=null,n$b._enableAtributes=[],n$b}(),n$Oa=function(n$a){function n$c(n$a){this.texcoord=null,this.offsetX=300,this.offsetY=0,n$c.__super.call(this,512,0);var n$b=8*n$pa.BYTES_PE;this.position=[2,5126,!1,n$b,0],this.texcoord=[2,5126,!1,n$b,2*n$pa.BYTES_PE],this.color=[4,5126,!1,n$b,4*n$pa.BYTES_PE]}return n$m(n$c,"laya.webgl.shader.d2.skinAnishader.SkinSV",n$ya),n$c}(),n$Pa=function(n$a){function n$b(n$a){n$b.__super.call(this,2,0),this.color=[]}return n$m(n$b,"laya.webgl.shader.d2.value.Color2dSV",n$ya),n$b.prototype.setValue=function(n$a){n$a.fillStyle&&(this.color=n$a.fillStyle._color._color),n$a.strokeStyle&&(this.color=n$a.strokeStyle._color._color)},n$b}(),n$Qa=function(n$a){function n$b(n$a){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=n$ya._TEXCOORD,n$b.__super.call(this,256,0)}n$m(n$b,"laya.webgl.shader.d2.value.FillTextureSV",n$ya);var n$c=n$b.prototype;return n$c.setValue=function(n$a){this.ALPHA=n$a.ALPHA,n$a.filters&&this.setFilters(n$a.filters)},n$c.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},n$b}(),n$Ra=function(n$a){function n$b(n$a){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=n$ya._TEXCOORD,void 0===n$a&&(n$a=0),n$b.__super.call(this,1,n$a)}n$m(n$b,"laya.webgl.shader.d2.value.TextureSV",n$ya);var n$c=n$b.prototype;return n$c.setValue=function(n$a){this.ALPHA=n$a.ALPHA,n$a.filters&&this.setFilters(n$a.filters)},n$c.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},n$b}(),n$Sa=function(n$a){function n$b(n$a){this.a_color=null,this.u_pos=[0,0],n$b.__super.call(this,4,0),this.position=[2,5126,!1,5*n$pa.BYTES_PE,0],this.a_color=[3,5126,!1,5*n$pa.BYTES_PE,2*n$pa.BYTES_PE]}return n$m(n$b,"laya.webgl.shader.d2.value.PrimitiveSV",n$ya),n$b}(),n$Ta=function(n$a){function n$b(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,n$b.__super.call(this)}n$m(n$b,"laya.webgl.atlas.AtlasWebGLCanvas",n$a);var n$c=n$b.prototype;return n$c.recreateResource=function(){var n$a=n$ua.mainContext,n$b=this._source=n$a.createTexture(),n$c=n$va.curBindTexTarget,n$d=n$va.curBindTexValue;n$va.bindTexture(n$a,3553,n$b),n$a.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),n$a.texParameteri(3553,10241,9729),n$a.texParameteri(3553,10240,9729),n$a.texParameteri(3553,10242,33071),n$a.texParameteri(3553,10243,33071),n$c&&n$d&&n$va.bindTexture(n$a,n$c,n$d),this.memorySize=this._w*this._h*4,this.completeCreate()},n$c.disposeResource=function(){this._source&&(n$ua.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},n$c.texSubImage2D=function(n$a,n$b,n$c){if(n$r.isFlash){this._flashCacheImage||(this._flashCacheImage=n$p.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var n$d=n$c.bitmapdata;this._flashCacheImage._image.copyPixels(n$d,0,0,n$d.width,n$d.height,n$a,n$b),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var n$e=n$ua.mainContext,n$f=n$va.curBindTexTarget,n$g=n$va.curBindTexValue;n$va.bindTexture(n$e,3553,this._source),n$e.pixelStorei(37441,!0),0<=n$a-1&&n$e.texSubImage2D(3553,0,n$a-1,n$b,6408,5121,n$c),n$a+1<=this._w&&n$e.texSubImage2D(3553,0,n$a+1,n$b,6408,5121,n$c),0<=n$b-1&&n$e.texSubImage2D(3553,0,n$a,n$b-1,6408,5121,n$c),n$b+1<=this._h&&n$e.texSubImage2D(3553,0,n$a,n$b+1,6408,5121,n$c),n$e.texSubImage2D(3553,0,n$a,n$b,6408,5121,n$c),n$e.pixelStorei(37441,!1),n$f&&n$g&&n$va.bindTexture(n$e,n$f,n$g)}},n$c.texSubImage2DPixel=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$ua.mainContext,n$g=n$va.curBindTexTarget,n$h=n$va.curBindTexValue;n$va.bindTexture(n$f,3553,this._source);var n$i=new Uint8Array(n$e.data);n$f.pixelStorei(37441,!0),n$f.texSubImage2D(3553,0,n$a,n$b,n$c,n$d,6408,5121,n$i),n$f.pixelStorei(37441,!1),n$g&&n$h&&n$va.bindTexture(n$f,n$g,n$h)},n$d(0,n$c,"width",n$a.prototype._$get_width,function(n$a){this._w=n$a}),n$d(0,n$c,"height",n$a.prototype._$get_height,function(n$a){this._h=n$a}),n$b}(n$c),n$Ua=function(n$a){function n$e(){this.flipY=!0,this.alwaysChange=!1,n$e.__super.call(this)}n$m(n$e,"laya.webgl.resource.WebGLCanvas",n$c);var n$b=n$e.prototype;return n$b.getCanvas=function(){return this._canvas},n$b.clear=function(){this._ctx&&this._ctx.clear()},n$b.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},n$b._setContext=function(n$a){this._ctx=n$a},n$b.getContext=function(n$a,n$b){return this._ctx?this._ctx:this._ctx=n$e._createContext(this)},n$b.size=function(n$a,n$b){this._w==n$a&&this._h==n$b||(this._w=n$a,this._h=n$b,this._ctx&&this._ctx.size(n$a,n$b),this._canvas&&(this._canvas.height=n$b,this._canvas.width=n$a))},n$b.activeResource=function(n$a){void 0===n$a&&(n$a=!1),this._source||this.recreateResource()},n$b.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},n$b.disposeResource=function(){this._source&&!this.iscpuSource&&(n$ua.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},n$b.createWebGlTexture=function(){var n$a=n$ua.mainContext;this._canvas;var n$b=this._source=n$a.createTexture();this.iscpuSource=!1;var n$c=n$va.curBindTexTarget,n$d=n$va.curBindTexValue;n$va.bindTexture(n$a,3553,n$b),n$a.pixelStorei(37440,this.flipY?1:0),n$e.premulAlpha&&n$a.pixelStorei(37441,!0),n$a.texImage2D(3553,0,6408,6408,5121,this._imgData),n$e.premulAlpha&&n$a.pixelStorei(37441,!1),n$a.texParameteri(3553,10240,9729),n$a.texParameteri(3553,10241,9729),n$a.texParameteri(3553,10242,33071),n$a.texParameteri(3553,10243,33071),n$a.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,n$c&&n$d&&n$va.bindTexture(n$a,n$c,n$d)},n$b.reloadCanvasData=function(){var n$a=n$ua.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var n$b=n$va.curBindTexTarget,n$c=n$va.curBindTexValue;n$va.bindTexture(n$a,3553,this._source),n$e.premulAlpha&&n$a.pixelStorei(37441,!0),n$a.texImage2D(3553,0,6408,6408,5121,this._imgData),n$e.premulAlpha&&n$a.pixelStorei(37441,!1),n$a.pixelStorei(37440,0),n$b&&n$c&&n$va.bindTexture(n$a,n$b,n$c)},n$b.texSubImage2D=function(n$a,n$b,n$c){var n$d=n$ua.mainContext,n$e=n$va.curBindTexTarget,n$f=n$va.curBindTexValue;n$va.bindTexture(n$d,3553,this._source),n$d.pixelStorei(37441,!0),n$d.texSubImage2D(3553,0,n$b,n$c,6408,5121,n$a._source),n$d.pixelStorei(37441,!1),n$e&&n$f&&n$va.bindTexture(n$d,n$e,n$f)},n$b.toBase64=function(n$a,n$b,n$c){var n$d=null;this._canvas&&(n$d=this._canvas.toDataURL(n$a,n$b)),n$c.call(this,n$d)},n$d(0,n$b,"context",function(){return this._ctx}),n$d(0,n$b,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),n$d(0,n$b,"asBitmap",null,function(n$a){this._ctx&&(this._ctx.asBitmap=n$a)}),n$e._createContext=null,n$e.premulAlpha=!1,n$e}(),n$Va=function(n$a){function n$f(n$a,n$b){this.CborderSize=12,n$f.__super.call(this),this.char=n$a,this.isSpace=" "===n$a,this.xs=n$b.scaleX,this.ys=n$b.scaleY,this.font=n$b.font.toString(),this.fontSize=n$b.font.size,this.fillColor=n$b.fillColor,this.borderColor=n$b.borderColor,this.lineWidth=n$b.lineWidth,this.underLine=n$b.underLine;var n$c,n$d=n$r.isConchApp;n$d?((n$c=ConchTextCanvas)._source=ConchTextCanvas,n$c._source.canvas=ConchTextCanvas):n$c=n$n.canvas.source,this.canvas=n$c,this._enableMerageInAtlas=!0,this._ctx=n$d?n$c:this.canvas.getContext("2d",void 0);var n$e=n$L.measureText(this.char,this.font);this.cw=n$e.width*this.xs,this.ch=(n$e.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new n$K(this)}n$m(n$f,"laya.webgl.resource.WebGLCharImage",n$c);var n$b=n$f.prototype;return n$w.imps(n$b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),n$b.active=function(){this.texture.active()},n$b.recreateResource=function(){var n$a=n$r.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),n$a){var n$b=this.fontSize;1==this.xs&&1==this.ys||(n$b=parseInt(n$b*(this.xs>this.ys?this.xs:this.ys)+""));var n$c="normal 100 "+this.font;n$c=n$c.replace(n$f._fontSizeReg,n$b),this.borderColor&&(n$c+=" 1 "+this.borderColor),this._ctx.font=n$c,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,n$J.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var n$d=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(n$d,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},n$b.onresize=function(n$a,n$b){this._w=n$a,this._h=n$b,this._allowMerageInAtlas=!0},n$b.clearAtlasSource=function(){},n$d(0,n$b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),n$d(0,n$b,"atlasSource",function(){return this.canvas}),n$d(0,n$b,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(n$a){this._enableMerageInAtlas=n$a}),n$f.createOneChar=function(n$a,n$b){return new n$f(n$a,n$b)},n$f._fontSizeReg=new RegExp("\\d+(?=px)","g"),n$f}(),n$Wa=function(n$a){function n$j(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){void 0===n$c&&(n$c=6408),void 0===n$d&&(n$d=5121),void 0===n$e&&(n$e=34041),void 0===n$f&&(n$f=!1),void 0===n$g&&(n$g=!1),void 0===n$h&&(n$h=-1),void 0===n$i&&(n$i=1),n$j.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=n$a,this._h=n$b,this._surfaceFormat=n$c,this._surfaceType=n$d,this._depthStencilFormat=n$e,this._mipMap=n$f,this._repeat=n$g,this._minFifter=n$h,this._magFifter=n$i}n$m(n$j,"laya.webgl.resource.WebGLRenderTarget",n$c);var n$b=n$j.prototype;return n$b.recreateResource=function(){var n$a=n$ua.mainContext;this._frameBuffer||(this._frameBuffer=n$a.createFramebuffer()),this._source||(this._source=n$a.createTexture());var n$b=n$va.curBindTexTarget,n$c=n$va.curBindTexValue;n$va.bindTexture(n$a,3553,this._source),n$a.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var n$d=this._minFifter,n$e=this._magFifter,n$f=this._repeat?10497:33071,n$g=n$k.isPOT(this._w,this._h);if(n$g?(this._mipMap?-1!==n$d||(n$d=9987):-1!==n$d||(n$d=9729),-1!==n$e||(n$e=9729),n$a.texParameteri(3553,10241,n$d),n$a.texParameteri(3553,10240,n$e),n$a.texParameteri(3553,10242,n$f),n$a.texParameteri(3553,10243,n$f),this._mipMap&&n$a.generateMipmap(3553)):(-1!==n$d||(n$d=9729),-1!==n$e||(n$e=9729),n$a.texParameteri(3553,10241,n$d),n$a.texParameteri(3553,10240,n$e),n$a.texParameteri(3553,10242,33071),n$a.texParameteri(3553,10243,33071)),n$a.bindFramebuffer(36160,this._frameBuffer),n$a.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=n$a.createRenderbuffer()),n$a.bindRenderbuffer(36161,this._depthStencilBuffer),n$a.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:n$a.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:n$a.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:n$a.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}n$a.bindFramebuffer(36160,null),n$b&&n$c&&n$va.bindTexture(n$a,n$b,n$c),n$a.bindRenderbuffer(36161,null),n$g&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},n$b.disposeResource=function(){this._frameBuffer&&(n$ua.mainContext.deleteTexture(this._source),n$ua.mainContext.deleteFramebuffer(this._frameBuffer),n$ua.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},n$d(0,n$b,"depthStencilBuffer",function(){return this._depthStencilBuffer}),n$d(0,n$b,"frameBuffer",function(){return this._frameBuffer}),n$j}(),n$Xa=function(n$a){function n$h(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this.offsetX=0,this.offsetY=0,n$h.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=n$f,this.canvas=n$a,this._ctx=n$a.getContext("2d",void 0),this._w=n$d,this._h=n$e,this.offsetX=n$b,this.offsetY=n$c,this.src=n$g,this._enableMerageInAtlas=!0,n$Q.enabled&&this._w<n$Q.atlasLimitWidth&&this._h<n$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}n$m(n$h,"laya.webgl.resource.WebGLSubImage",n$c);var n$b=n$h.prototype;return n$w.imps(n$b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),n$b.size=function(n$a,n$b){this._w=n$a,this._h=n$b,this._ctx&&this._ctx.size(n$a,n$b),this.canvas&&(this.canvas.height=n$b,this.canvas.width=n$a)},n$b.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},n$b.createWebGlTexture=function(){var n$a=n$ua.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var n$b=this._source=n$a.createTexture(),n$c=n$va.curBindTexTarget,n$d=n$va.curBindTexValue;n$va.bindTexture(n$a,3553,n$b),n$a.pixelStorei(37441,!0),n$a.texImage2D(3553,0,6408,6408,5121,this.canvas),n$a.pixelStorei(37441,!1);var n$e=this.minFifter,n$f=this.magFifter,n$g=this.repeat?10497:33071,n$h=n$k.isPOT(this.width,this.height);n$h?(this.mipmap?-1!==n$e||(n$e=9987):-1!==n$e||(n$e=9729),-1!==n$f||(n$f=9729),n$a.texParameteri(3553,10240,n$f),n$a.texParameteri(3553,10241,n$e),n$a.texParameteri(3553,10242,n$g),n$a.texParameteri(3553,10243,n$g),this.mipmap&&n$a.generateMipmap(3553)):(-1!==n$e||(n$e=9729),-1!==n$f||(n$f=9729),n$a.texParameteri(3553,10241,n$e),n$a.texParameteri(3553,10240,n$f),n$a.texParameteri(3553,10242,33071),n$a.texParameteri(3553,10243,33071)),n$c&&n$d&&n$va.bindTexture(n$a,n$c,n$d),this.canvas=null,n$h&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},n$b.disposeResource=function(){n$Q.enabled&&this._allowMerageInAtlas||!this._source||(n$ua.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},n$b.clearAtlasSource=function(){},n$d(0,n$b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),n$d(0,n$b,"atlasSource",function(){return this.canvas}),n$d(0,n$b,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(n$a){this._allowMerageInAtlas=n$a}),n$h}(),n$Ya=function(n$a){function n$j(n$a,n$b,n$c,n$d){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,n$j.__super.call(this),!n$a||!n$b)throw"Shader Error";this._id=++n$j._count,this._vs=n$a,this._ps=n$b,this._nameMap=n$d||{},null!=n$c&&(n$j.sharders[n$c]=this)}n$m(n$j,"laya.webgl.shader.Shader",n$La);var n$b=n$j.prototype;return n$b.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},n$b.disposeResource=function(){n$ua.mainContext.deleteShader(this._vshader),n$ua.mainContext.deleteShader(this._pshader),n$ua.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},n$b._compile=function(){if(!n$ua.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var n$a=[this._vs,this._ps],n$b=n$ua.mainContext;if(this._program=n$b.createProgram(),this._vshader=n$j._createShader(n$b,n$a[0],35633),this._pshader=n$j._createShader(n$b,n$a[1],35632),n$b.attachShader(this._program,this._vshader),n$b.attachShader(this._program,this._pshader),n$b.linkProgram(this._program),!n$r.isConchApp&&!n$b.getProgramParameter(this._program,35714))throw n$b.getProgramInfoLog(this._program);var n$c,n$d,n$e=0,n$f=0;for(n$f=n$r.isConchApp?n$b.getProgramParameterEx(this._vs,this._ps,"",35721):n$b.getProgramParameter(this._program,35721),n$e=0;n$e<n$f;n$e++){var n$g=null;n$c={vartype:"attribute",glfun:null,ivartype:0,attrib:n$g=n$r.isConchApp?n$b.getActiveAttribEx(this._vs,this._ps,"",n$e):n$b.getActiveAttrib(this._program,n$e),location:n$b.getAttribLocation(this._program,n$g.name),name:n$g.name,type:n$g.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(n$c)}var n$h=0;for(n$h=n$r.isConchApp?n$b.getProgramParameterEx(this._vs,this._ps,"",35718):n$b.getProgramParameter(this._program,35718),n$e=0;n$e<n$h;n$e++){var n$i=null;n$i=n$r.isConchApp?n$b.getActiveUniformEx(this._vs,this._ps,"",n$e):n$b.getActiveUniform(this._program,n$e),0<(n$c={vartype:"uniform",glfun:null,ivartype:1,attrib:n$g,location:n$b.getUniformLocation(this._program,n$i.name),name:n$i.name,type:n$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(n$c.name=n$c.name.substr(0,n$c.name.length-3),n$c.isArray=!0,n$c.location=n$b.getUniformLocation(this._program,n$c.name)),this._params.push(n$c)}for(n$e=0,n$d=this._params.length;n$e<n$d;n$e++)if((n$c=this._params[n$e]).indexOfParams=n$e,n$c.index=1,n$c.value=[n$c.location,null],n$c.codename=n$c.name,n$c.name=this._nameMap[n$c.codename]?this._nameMap[n$c.codename]:n$c.codename,(this._paramsMap[n$c.name]=n$c)._this=this,n$c.uploadedValue=[],"attribute"!==n$c.vartype)switch(n$c.type){case 5124:n$c.fun=n$c.isArray?this._uniform1iv:this._uniform1i;break;case 5126:n$c.fun=n$c.isArray?this._uniform1fv:this._uniform1f;break;case 35664:n$c.fun=n$c.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:n$c.fun=n$c.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:n$c.fun=n$c.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:n$c.fun=this._uniform_sampler2D;break;case 35680:n$c.fun=this._uniform_samplerCube;break;case 35676:n$c.glfun=n$b.uniformMatrix4fv,n$c.fun=this._uniformMatrix4fv;break;case 35670:n$c.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else n$c.fun=this._attribute}},n$b.getUniform=function(n$a){return this._paramsMap[n$a]},n$b._attribute=function(n$a,n$b){var n$c=n$ua.mainContext,n$d=n$Na._enableAtributes,n$e=n$a.location;return n$d[n$e]||n$c.enableVertexAttribArray(n$e),n$c.vertexAttribPointer(n$e,n$b[0],n$b[1],n$b[2],n$b[3],n$b[4]+this._offset),n$d[n$e]=n$Na._bindVertexBuffer,1},n$b._uniform1f=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b?(n$ua.mainContext.uniform1f(n$a.location,n$c[0]=n$b),1):0},n$b._uniform1fv=function(n$a,n$b){if(n$b.length<4){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]||n$c[2]!==n$b[2]||n$c[3]!==n$b[3]?(n$ua.mainContext.uniform1fv(n$a.location,n$b),n$c[0]=n$b[0],n$c[1]=n$b[1],n$c[2]=n$b[2],n$c[3]=n$b[3],1):0}return n$ua.mainContext.uniform1fv(n$a.location,n$b),1},n$b._uniform_vec2=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]?(n$ua.mainContext.uniform2f(n$a.location,n$c[0]=n$b[0],n$c[1]=n$b[1]),1):0},n$b._uniform_vec2v=function(n$a,n$b){if(n$b.length<2){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]||n$c[2]!==n$b[2]||n$c[3]!==n$b[3]?(n$ua.mainContext.uniform2fv(n$a.location,n$b),n$c[0]=n$b[0],n$c[1]=n$b[1],n$c[2]=n$b[2],n$c[3]=n$b[3],1):0}return n$ua.mainContext.uniform2fv(n$a.location,n$b),1},n$b._uniform_vec3=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]||n$c[2]!==n$b[2]?(n$ua.mainContext.uniform3f(n$a.location,n$c[0]=n$b[0],n$c[1]=n$b[1],n$c[2]=n$b[2]),1):0},n$b._uniform_vec3v=function(n$a,n$b){return n$ua.mainContext.uniform3fv(n$a.location,n$b),1},n$b._uniform_vec4=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]||n$c[2]!==n$b[2]||n$c[3]!==n$b[3]?(n$ua.mainContext.uniform4f(n$a.location,n$c[0]=n$b[0],n$c[1]=n$b[1],n$c[2]=n$b[2],n$c[3]=n$b[3]),1):0},n$b._uniform_vec4v=function(n$a,n$b){return n$ua.mainContext.uniform4fv(n$a.location,n$b),1},n$b._uniformMatrix2fv=function(n$a,n$b){return n$ua.mainContext.uniformMatrix2fv(n$a.location,!1,n$b),1},n$b._uniformMatrix3fv=function(n$a,n$b){return n$ua.mainContext.uniformMatrix3fv(n$a.location,!1,n$b),1},n$b._uniformMatrix4fv=function(n$a,n$b){return n$ua.mainContext.uniformMatrix4fv(n$a.location,!1,n$b),1},n$b._uniform1i=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b?(n$ua.mainContext.uniform1i(n$a.location,n$c[0]=n$b),1):0},n$b._uniform1iv=function(n$a,n$b){return n$ua.mainContext.uniform1iv(n$a.location,n$b),1},n$b._uniform_ivec2=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]?(n$ua.mainContext.uniform2i(n$a.location,n$c[0]=n$b[0],n$c[1]=n$b[1]),1):0},n$b._uniform_ivec2v=function(n$a,n$b){return n$ua.mainContext.uniform2iv(n$a.location,n$b),1},n$b._uniform_vec3i=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]||n$c[2]!==n$b[2]?(n$ua.mainContext.uniform3i(n$a.location,n$c[0]=n$b[0],n$c[1]=n$b[1],n$c[2]=n$b[2]),1):0},n$b._uniform_vec3vi=function(n$a,n$b){return n$ua.mainContext.uniform3iv(n$a.location,n$b),1},n$b._uniform_vec4i=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]||n$c[2]!==n$b[2]||n$c[3]!==n$b[3]?(n$ua.mainContext.uniform4i(n$a.location,n$c[0]=n$b[0],n$c[1]=n$b[1],n$c[2]=n$b[2],n$c[3]=n$b[3]),1):0},n$b._uniform_vec4vi=function(n$a,n$b){return n$ua.mainContext.uniform4iv(n$a.location,n$b),1},n$b._uniform_sampler2D=function(n$a,n$b){var n$c=n$ua.mainContext,n$d=n$a.uploadedValue;return null==n$d[0]?(n$d[0]=this._curActTexIndex,n$c.uniform1i(n$a.location,this._curActTexIndex),n$c.activeTexture(n$j._TEXTURES[this._curActTexIndex]),n$va.bindTexture(n$c,3553,n$b),this._curActTexIndex++,1):(n$c.activeTexture(n$j._TEXTURES[n$d[0]]),n$va.bindTexture(n$c,3553,n$b),0)},n$b._uniform_samplerCube=function(n$a,n$b){var n$c=n$ua.mainContext,n$d=n$a.uploadedValue;return null==n$d[0]?(n$d[0]=this._curActTexIndex,n$c.uniform1i(n$a.location,this._curActTexIndex),n$c.activeTexture(n$j._TEXTURES[this._curActTexIndex]),n$va.bindTexture(n$c,34067,n$b),this._curActTexIndex++,1):(n$c.activeTexture(n$j._TEXTURES[n$d[0]]),n$va.bindTexture(n$c,34067,n$b),0)},n$b._noSetValue=function(n$a){console.log("no....:"+n$a.name)},n$b.uploadOne=function(n$a,n$b){this.activeResource(),n$va.UseProgram(this._program);var n$c=this._paramsMap[n$a];n$c.fun.call(this,n$c,n$b)},n$b.uploadTexture2D=function(n$a){n$G.shaderCall++;var n$b=n$ua.mainContext;n$b.activeTexture(33984),n$va.bindTexture(n$b,3553,n$a)},n$b.uploadTexture2D1=function(n$a){n$G.shaderCall++;var n$b=n$ua.mainContext;n$b.activeTexture(33985),n$va.bindTexture(n$b,3553,n$a)},n$b.upload=function(n$a,n$b){n$La.activeShader=n$La.bindShader=this,this._lastUseFrameCount===n$G.loopCount||this.activeResource(),n$va.UseProgram(this._program),this._reCompile?(n$b=this._params,this._reCompile=!1):n$b=n$b||this._params;n$ua.mainContext;for(var n$c,n$d,n$e=n$b.length,n$f=0,n$g=0;n$g<n$e;n$g++)null!==(n$d=n$a[(n$c=n$b[n$g]).name])&&(n$f+=n$c.fun.call(this,n$c,n$d));n$G.shaderCall+=n$f},n$b.uploadArray=function(n$a,n$b,n$c){n$La.activeShader=this,(n$La.bindShader=this).activeResource(),n$va.UseProgram(this._program);this._params;for(var n$d,n$e,n$f=0,n$g=n$b-2;0<=n$g;n$g-=2)(n$e=this._paramsMap[n$a[n$g]])&&null!=(n$d=n$a[n$g+1])&&(n$c&&n$c[n$e.name]&&n$c[n$e.name].bind(),n$f+=n$e.fun.call(this,n$e,n$d));n$G.shaderCall+=n$f},n$b.getParams=function(){return this._params},n$j.getShader=function(n$a){return n$j.sharders[n$a]},n$j.create=function(n$a,n$b,n$c,n$d){return new n$j(n$a,n$b,n$c,n$d)},n$j.withCompile=function(n$a,n$b,n$c,n$d){if(n$c&&n$j.sharders[n$c])return n$j.sharders[n$c];var n$e=n$j._preCompileShader[2e-4*n$a];if(!n$e)throw new Error("withCompile shader err!"+n$a);return n$e.createShader(n$b,n$c,n$d)},n$j.withCompile2D=function(n$a,n$b,n$c,n$d,n$e){if(n$d&&n$j.sharders[n$d])return n$j.sharders[n$d];var n$f=n$j._preCompileShader[2e-4*n$a+n$b];if(!n$f)throw new Error("withCompile shader err!"+n$a+" "+n$b);return n$f.createShader(n$c,n$d,n$e)},n$j.addInclude=function(n$a,n$b){n$ta.addInclude(n$a,n$b)},n$j.preCompile=function(n$a,n$b,n$c,n$d){var n$e=2e-4*n$a;n$j._preCompileShader[n$e]=new n$ta(n$e,n$b,n$c,n$d)},n$j.preCompile2D=function(n$a,n$b,n$c,n$d,n$e){var n$f=2e-4*n$a+n$b;n$j._preCompileShader[n$f]=new n$ta(n$f,n$c,n$d,n$e)},n$j._createShader=function(n$a,n$b,n$c){var n$d=n$a.createShader(n$c);return n$a.shaderSource(n$d,n$b),n$a.compileShader(n$d),n$d},n$j._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],n$j._count=0,n$j._preCompileShader={},n$j.SHADERNAME2ID=2e-4,n$j.sharders=((n$j.sharders=[]).length=32,n$j.sharders),n$g(n$j,["nameKey",function(){return this.nameKey=new n$H}]),n$j}(),n$Za=function(n$a){function n$b(){this._maxsize=0,this._upload=!0,this._uploadSize=0,n$b.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}n$m(n$b,"laya.webgl.utils.Buffer2D",n$a);var n$c=n$b.prototype;return n$c.needSize=function(n$a){var n$b=this._byteLength;if(n$a){var n$c=this._byteLength+n$a;n$c<=this._buffer.byteLength||this._resizeBuffer(n$c<<1,!0),this._byteLength=n$c}return n$b},n$c._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),n$G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,n$Na._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),n$Na._gl.bufferSubData(this._bufferType,0,this._buffer)},n$c._bufferSubData=function(n$a,n$b,n$c){if(void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),this._maxsize=Math.max(this._maxsize,this._byteLength),n$G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,n$Na._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),n$b||n$c){var n$d=this._buffer.slice(n$b,n$c);n$Na._gl.bufferSubData(this._bufferType,n$a,n$d)}else n$Na._gl.bufferSubData(this._bufferType,n$a,this._buffer)},n$c._checkArrayUse=function(){},n$c._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},n$c._bind_subUpload=function(n$a,n$b,n$c){return void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(n$a,n$b,n$c),!0)},n$c._resizeBuffer=function(n$a,n$b){if(n$a<this._buffer.byteLength)return this;if(this.memorySize=n$a,n$b&&this._buffer&&0<this._buffer.byteLength){var n$c=new ArrayBuffer(n$a);new Uint8Array(n$c).set(new Uint8Array(this._buffer),0),this._buffer=n$c}else this._buffer=new ArrayBuffer(n$a);return this._checkArrayUse(),this._upload=!0,this},n$c.append=function(n$a){this._upload=!0;var n$b,n$c;n$b=n$a.byteLength,n$a instanceof Uint8Array?(this._resizeBuffer(this._byteLength+n$b,!0),n$c=new Uint8Array(this._buffer,this._byteLength)):n$a instanceof Uint16Array?(this._resizeBuffer(this._byteLength+n$b,!0),n$c=new Uint16Array(this._buffer,this._byteLength)):n$a instanceof Float32Array&&(this._resizeBuffer(this._byteLength+n$b,!0),n$c=new Float32Array(this._buffer,this._byteLength)),n$c.set(n$a,0),this._byteLength+=n$b,this._checkArrayUse()},n$c.appendU16Array=function(n$a,n$b){this._resizeBuffer(this._byteLength+2*n$b,!0);for(var n$c=new Uint16Array(this._buffer,this._byteLength,n$b),n$d=0;n$d<n$b;n$d++)n$c[n$d]=n$a[n$d];this._byteLength+=2*n$b,this._checkArrayUse()},n$c.appendEx=function(n$a,n$b){this._upload=!0;var n$c;n$c=n$a.byteLength,this._resizeBuffer(this._byteLength+n$c,!0),new n$b(this._buffer,this._byteLength).set(n$a,0),this._byteLength+=n$c,this._checkArrayUse()},n$c.appendEx2=function(n$a,n$b,n$c,n$d){void 0===n$d&&(n$d=1),this._upload=!0;var n$e,n$f;n$e=n$c*n$d,this._resizeBuffer(this._byteLength+n$e,!0),n$f=new n$b(this._buffer,this._byteLength);var n$g=0;for(n$g=0;n$g<n$c;n$g++)n$f[n$g]=n$a[n$g];this._byteLength+=n$e,this._checkArrayUse()},n$c.getBuffer=function(){return this._buffer},n$c.setNeedUpload=function(){this._upload=!0},n$c.getNeedUpload=function(){return this._upload},n$c.upload=function(){var n$a=this._bind_upload();return n$Na._gl.bindBuffer(this._bufferType,null),n$Na._bindActive[this._bufferType]=null,n$La.activeShader=null,n$a},n$c.subUpload=function(n$a,n$b,n$c){void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0);var n$d=this._bind_subUpload();return n$Na._gl.bindBuffer(this._bufferType,null),n$Na._bindActive[this._bufferType]=null,n$La.activeShader=null,n$d},n$c.disposeResource=function(){n$a.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},n$c.clear=function(){this._byteLength=0,this._upload=!0},n$d(0,n$c,"bufferLength",function(){return this._buffer.byteLength}),n$d(0,n$c,"byteLength",null,function(n$a){this._byteLength!==n$a&&(n$a<=this._buffer.byteLength||this._resizeBuffer(2*n$a+256,!0),this._byteLength=n$a)}),n$b.__int__=function(n$a){n$Aa.QuadrangleIB=n$Aa.create(35044),n$qa.fillIBQuadrangle(n$Aa.QuadrangleIB,16)},n$b.FLOAT32=4,n$b.SHORT=2,n$b}(n$Na),n$$a=(function(n$b){function n$c(n$a){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,n$c.__super.call(this,9)}n$m(n$c,"laya.webgl.shader.d2.value.GlowSV",n$b);var n$a=n$c.prototype;n$a.setValue=function(n$a){n$b.prototype.setValue.call(this,n$a)},n$a.clear=function(){n$b.prototype.clear.call(this)}}(n$Ra),function(n$a){function n$b(n$a){n$b.__super.call(this,64),this.defines.add(64)}n$m(n$b,"laya.webgl.shader.d2.value.TextSV",n$a);var n$c=n$b.prototype;return n$c.release=function(){(n$b.pool[n$b._length++]=this).clear()},n$c.clear=function(){n$a.prototype.clear.call(this)},n$b.create=function(){return n$b._length?n$b.pool[--n$b._length]:new n$b(null)},n$b.pool=[],n$b._length=0,n$b}(n$Ra)),n$_a=function(n$a){function n$e(n$a,n$b,n$c,n$d){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,n$e.__super.call(this,n$a,n$b,n$c,n$d)}n$m(n$e,"laya.webgl.shader.d2.Shader2X",n$a);var n$b=n$e.prototype;return n$b.upload2dQuick1=function(n$a){this.upload(n$a,this._params2dQuick1||this._make2dQuick1())},n$b._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var n$a,n$b=this._params,n$c=0,n$d=n$b.length;n$c<n$d;n$c++)n$a=n$b[n$c],(n$r.isFlash||"size"!==n$a.name&&"position"!==n$a.name&&"texcoord"!==n$a.name)&&this._params2dQuick1.push(n$a)}return this._params2dQuick1},n$b.disposeResource=function(){n$a.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},n$b.upload2dQuick2=function(n$a){this.upload(n$a,this._params2dQuick2||this._make2dQuick2())},n$b._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var n$a,n$b=this._params,n$c=0,n$d=n$b.length;n$c<n$d;n$c++)n$a=n$b[n$c],(n$r.isFlash||"size"!==n$a.name)&&this._params2dQuick2.push(n$a)}return this._params2dQuick2},n$e.create=function(n$a,n$b,n$c,n$d){return new n$e(n$a,n$b,n$c,n$d)},n$e}(n$Ya),n$Aa=function(n$a){function n$b(n$a){this._uint8Array=null,this._uint16Array=null,void 0===n$a&&(n$a=35044),n$b.__super.call(this),this._bufferUsage=n$a,this._bufferType=34963,n$r.isFlash||(this._buffer=new ArrayBuffer(8))}n$m(n$b,"laya.webgl.utils.IndexBuffer2D",n$Za);var n$c=n$b.prototype;return n$c._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},n$c.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},n$c.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},n$c.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},n$b.QuadrangleIB=null,n$b.create=function(n$a){return void 0===n$a&&(n$a=35044),new n$b(n$a)},n$b}(),n$Ba=function(n$a){function n$c(n$a,n$b){this._floatArray32=null,this._vertexStride=0,n$c.__super.call(this),this._vertexStride=n$a,this._bufferUsage=n$b,this._bufferType=34962,n$r.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}n$m(n$c,"laya.webgl.utils.VertexBuffer2D",n$a);var n$b=n$c.prototype;return n$b.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},n$b.bind=function(n$a){n$a&&n$a._bind(),this._bind()},n$b.insertData=function(n$a,n$b){this.getFloat32Array().set(n$a,n$b),this._upload=!0},n$b.bind_upload=function(n$a){n$a._bind_upload()||n$a._bind(),this._bind_upload()||this._bind()},n$b._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},n$b.disposeResource=function(){n$a.prototype.disposeResource.call(this)},n$b.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},n$d(0,n$b,"vertexStride",function(){return this._vertexStride}),n$c.create=function(n$a,n$b){return void 0===n$b&&(n$b=35048),new n$c(n$a,n$b)},n$c}(n$Za),n$ab=function(n$a){function n$h(n$a,n$b,n$c,n$d,n$e,n$f){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===n$c&&(n$c=6408),void 0===n$d&&(n$d=!0),n$h.__super.call(this,n$a,n$b),n$a){if(this._format=n$c,this._mipmap=n$d,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof n$a)this._url=n$a,this._src=n$a,this._image=new n$n.window.Image,n$b&&(n$b.onload&&(this.onload=n$b.onload),n$b.onerror&&(this.onerror=n$b.onerror),n$b.onCreate&&n$b.onCreate(this)),this._image.crossOrigin=n$a&&0==n$a.indexOf("data:")?null:"",n$a&&(this._image.src=n$a);else if(n$a instanceof ArrayBuffer){this._src=n$b,this._url=this._src;var n$g=new n$i(n$a);n$g.readUTFBytes(4),n$g.readUTFBytes(2),n$g.getInt16();n$g.endian="bigEndian",this._w=n$g.getInt16(),this._h=n$g.getInt16();n$g.getInt16(),n$g.getInt16();this._image=new Uint8Array(n$a,n$g.pos),this._format=n$ua.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,n$Q.enabled&&this._w<n$Q.atlasLimitWidth&&this._h<n$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(n$a instanceof Uint8Array))return this._src=n$b,this._url=this._src,this._image=n$a.source||n$a,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=n$b,this._url=this._src,this._w=n$e,this._h=n$f,this._image=n$a,this._format=0===n$c?n$a.byteLength/(n$e*n$f)==4?6408:6407:n$c}this._$5__enableMerageInAtlas=!0}}n$m(n$h,"laya.webgl.resource.WebGLImage",n$p);var n$b=n$h.prototype;return n$w.imps(n$b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),n$b._init_=function(n$a,n$b){},n$b._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var n$a=n$ua.mainContext,n$b=this._source=n$a.createTexture(),n$c=n$va.curBindTexTarget,n$d=n$va.curBindTexValue;n$va.bindTexture(n$a,3553,n$b);var n$e=this.minFifter,n$f=this.magFifter,n$g=this.repeat?10497:33071,n$h=n$k.isPOT(this._w,this._h),n$i=!1;switch(n$h?(this.mipmap?-1!==n$e||(n$e=9987):-1!==n$e||(n$e=9729),-1!==n$f||(n$f=9729),n$a.texParameteri(3553,10241,n$e),n$a.texParameteri(3553,10240,n$f),n$a.texParameteri(3553,10242,n$g),n$a.texParameteri(3553,10243,n$g),this.mipmap&&n$a.generateMipmap(3553)):(-1!==n$e||(n$e=9729),-1!==n$f||(n$f=9729),n$a.texParameteri(3553,10241,n$e),n$a.texParameteri(3553,10240,n$f),n$a.texParameteri(3553,10242,33071),n$a.texParameteri(3553,10243,33071)),n$a.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&n$a.pixelStorei(n$a.UNPACK_ALIGNMENT,1),n$a.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&n$a.pixelStorei(n$a.UNPACK_ALIGNMENT,1),n$a.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:n$i=!0,n$a.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case n$ua.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:n$i=!0,n$a.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}n$a.pixelStorei(37441,!1),n$c&&n$d&&n$va.bindTexture(n$a,n$c,n$d),this.uri||(this.uri=this._url),n$i?this.memorySize=this._image.length:n$h&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},n$b.recreateResource=function(){var n$a=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var n$b=this;this._image=new n$n.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(n$b._needReleaseAgain)return n$b._needReleaseAgain=!1,n$b._image.onload=null,void(n$b._image=null);n$b._allowMerageInAtlas&&n$b._enableMerageInAtlas?(n$a.memorySize=0,n$a._recreateLock=!1):n$b._createWebGlTexture(),n$b.completeCreate()},this._image.src=this._src}},n$b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&n$ua.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},n$b.onresize=function(){this._w=this._image.width,this._h=this._image.height,n$Q.enabled&&this._w<n$Q.atlasLimitWidth&&this._h<n$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},n$b.clearAtlasSource=function(){this._image=null},n$d(0,n$b,"format",function(){return this._format}),n$d(0,n$b,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(n$a){this._$5__enableMerageInAtlas=n$a}),n$d(0,n$b,"mipmap",function(){return this._mipmap}),n$d(0,n$b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),n$d(0,n$b,"atlasSource",function(){return this._image}),n$d(0,n$b,"onload",null,function(n$a){var n$b=this;this._onload=n$a,this._image&&(this._image.onload=null!=this._onload?function(){n$b.onresize(),n$b._onload()}:null)}),n$d(0,n$b,"onerror",null,function(n$a){var n$b=this;this._onerror=n$a,this._image&&(this._image.onerror=null!=this._onerror?function(){n$b._onerror()}:null)}),n$h}();n$w.__init([n$na,n$P,n$xa,n$ta])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(n$a,n$b){"use strict";for(var n$c in Object.defineProperty(n$b,"__esModule",{value:!0}),Laya){var n$d=Laya[n$c];n$d&&n$d.__isclass&&(n$b[n$c]=n$d)}}),function(n$f,n$a,n$d){n$d.un,n$d.uns;var n$e=n$d.static,n$g=n$d.class,n$h=n$d.getset,n$i=(n$d.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),n$o=laya.utils.ClassUtils,n$l=(laya.events.Event,laya.utils.HTMLChar),n$j=laya.net.Loader,n$k=(laya.display.Node,laya.maths.Rectangle),n$m=laya.renders.Render,n$n=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),n$p=laya.utils.Stat,n$L=laya.display.Text,n$q=laya.resource.Texture,n$r=laya.net.URL,n$s=laya.utils.Utils,n$t=function(){function n$n(){}return n$g(n$n,"laya.html.utils.HTMLParse"),n$n.parse=function(n$a,n$b,n$c){n$b=(n$b="<root>"+(n$b=n$b.replace(/<br>/g,"<br/>"))+"</root>").replace(n$n.spacePattern,n$n.char255);var n$d=n$s.parseXMLFromString(n$b);n$n._parseXML(n$a,n$d.childNodes[0].childNodes,n$c)},n$n._parseXML=function(n$a,n$b,n$c,n$d){var n$e=0,n$f=0;if(n$b.join||n$b.item)for(n$e=0,n$f=n$b.length;n$e<n$f;++n$e)n$n._parseXML(n$a,n$b[n$e],n$c,n$d);else{var n$g,n$h,n$i;if(3==n$b.nodeType)return void(n$a instanceof laya.html.dom.HTMLDivElement?(null==n$b.nodeName&&(n$b.nodeName="#text"),n$h=n$b.nodeName.toLowerCase(),0<(n$i=n$b.textContent.replace(/^\s+|\s+$/g,"")).length&&(n$g=n$o.getInstance(n$h))&&(n$a.addChild(n$g),n$g.innerTEXT=n$i.replace(n$n.char255AndOneSpacePattern," "))):0<(n$i=n$b.textContent.replace(/^\s+|\s+$/g,"")).length&&(n$a.innerTEXT=n$i.replace(n$n.char255AndOneSpacePattern," ")));if("#comment"==(n$h=n$b.nodeName.toLowerCase()))return;if(n$g=n$o.getInstance(n$h)){(n$g=n$a.addChild(n$g)).URI=n$c,n$g.href=n$d;var n$j=n$b.attributes;if(n$j&&0<n$j.length)for(n$e=0,n$f=n$j.length;n$e<n$f;++n$e){var n$k=n$j[n$e],n$l=n$k.nodeName,n$m=n$k.value;n$g._setAttributes(n$l,n$m)}n$n._parseXML(n$g,n$b.childNodes,n$c,n$g.href)}else n$n._parseXML(n$a,n$b.childNodes,n$c,n$d)}},n$n.char255=String.fromCharCode(255),n$n.spacePattern=/&nbsp;|&#160;/g,n$n.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),n$n}(),n$u=function(){function n$K(){}return n$g(n$K,"laya.html.utils.Layout"),n$K.later=function(n$a){null==n$K._will&&(n$K._will=[],n$d.stage.frameLoop(1,null,function(){if(!(n$K._will.length<1)){for(var n$a=0;n$a<n$K._will.length;n$a++)laya.html.utils.Layout.layout(n$K._will[n$a]);n$K._will.length=0}})),n$K._will.push(n$a)},n$K.layout=function(n$a){if(!n$a||!n$a._style)return null;if(0==(512&n$a._style._type))return null;n$a.getStyle()._type&=-513;var n$b=n$K._multiLineLayout(n$a);return n$m.isConchApp&&n$a.layaoutCallNative&&n$a.layaoutCallNative(),n$b},n$K._multiLineLayout=function(n$a){if(n$L.RightToLeft)return n$K._multiLineLayout2(n$a);var n$b=new Array;n$a._addChildsToLayout(n$b);var n$c,n$d,n$e,n$f,n$g,n$h=0,n$i=n$b.length,n$j=n$a._getCSSStyle(),n$k=n$j.letterSpacing,n$l=n$j.leading,n$m=n$j.lineHeight,n$n=n$j._widthAuto()||!n$j.wordWrap,n$o=n$n?999999:n$a.width,n$p=(n$a.height,0),n$q=n$j.italic?n$j.fontSize/3:0,n$r=n$j._getAlign(),n$s=n$j._getValign(),n$t=0!==n$s||0!==n$r||0!=n$m,n$u=0,n$v=0,n$w=0,n$x=0,n$y=new Array,n$z=n$y[0]=new n$M,n$C=!1,n$D=!1;n$z.h=0,n$j.italic&&(n$o-=n$j.fontSize/3);var n$E=0,n$F=!0;function n$G(){n$z.y=n$v,n$v+=n$z.h+n$l,0==n$z.h&&(n$v+=n$m),n$z.mWidth=n$E,n$E=0,n$z=new n$M,n$y.push(n$z),n$z.h=0,n$C=!(n$F=!(n$u=0))}for(n$h=0;n$h<n$i;n$h++)if(null!=(n$c=n$b[n$h]))if(n$F=!1,n$c instanceof laya.html.dom.HTMLBrElement)n$G(),n$z.y=n$v;else{if(n$c._isChar()){if((n$f=n$c).isWord)n$C=n$D||"\n"===n$f.char,n$z.wordStartIndex=n$z.elements.length;else{if(n$w=n$f.width+n$f.style.letterSpacin,0<n$y.length&&n$o<n$u+n$w&&0<n$z.wordStartIndex){var n$H;n$H=n$z.elements.length-n$z.wordStartIndex+1,n$z.elements.length=n$z.wordStartIndex,n$h-=n$H,n$G();continue}n$C=!1,n$E+=n$f.width}n$w=n$f.width+n$k,n$x=n$f.height,n$D=!1,(n$C=n$C||n$o<n$u+n$w)&&n$G(),n$z.minTextHeight=Math.min(n$z.minTextHeight,n$c.height)}else n$d=n$c._getCSSStyle(),n$g=n$c,n$e=n$d.padding,0===n$d._getCssFloat()||(n$t=!0),n$C=n$D||n$d.lineElement,n$w=n$g.width*n$g._style._tf.scaleX+n$e[1]+n$e[3]+n$k,n$x=n$g.height*n$g._style._tf.scaleY+n$e[0]+n$e[2],n$D=n$d.lineElement,(n$C=n$C||n$o<n$u+n$w&&n$d.wordWrap)&&n$G();n$z.elements.push(n$c),n$z.h=Math.max(n$z.h,n$x),n$c.x=n$u,n$c.y=n$v,n$u+=n$w,n$z.w=n$u-n$k,n$z.y=n$v,n$p=Math.max(n$u+n$q,n$p)}else n$F||(n$u+=n$K.DIV_ELEMENT_PADDING),n$z.wordStartIndex=n$z.elements.length;if(n$v=n$z.y+n$z.h,n$t){var n$I=0,n$J=n$o;for(n$n&&0<n$a.width&&(n$J=n$a.width),n$h=0,n$i=n$y.length;n$h<n$i;n$h++)n$y[n$h].updatePos(0,n$J,n$h,n$I,n$r,n$s,n$m),n$I+=Math.max(n$m,n$y[n$h].h+n$l);n$v=n$I}return n$n&&(n$a.width=n$p),n$v>n$a.height&&(n$a.height=n$v),[n$p,n$v]},n$K._multiLineLayout2=function(n$a){var n$b=new Array;n$a._addChildsToLayout(n$b);var n$c,n$d,n$e,n$f,n$g,n$h=0,n$i=n$b.length,n$j=n$a._getCSSStyle(),n$k=n$j.letterSpacing,n$l=n$j.leading,n$m=n$j.lineHeight,n$n=n$j._widthAuto()||!n$j.wordWrap,n$o=n$n?999999:n$a.width,n$p=(n$a.height,0),n$q=n$j.italic?n$j.fontSize/3:0,n$r=2-n$j._getAlign(),n$s=n$j._getValign(),n$t=0!==n$s||0!=n$r||0!=n$m,n$u=0,n$v=0,n$w=0,n$x=0,n$y=new Array,n$z=n$y[0]=new n$M,n$C=!1,n$D=!1;n$z.h=0,n$j.italic&&(n$o-=n$j.fontSize/3);var n$E=0,n$F=!0;function n$G(){n$z.y=n$v,n$v+=n$z.h+n$l,0==n$z.h&&(n$v+=n$m),n$z.mWidth=n$E,n$E=0,n$z=new n$M,n$y.push(n$z),n$z.h=0,n$C=!(n$F=!(n$u=0))}for(n$h=0;n$h<n$i;n$h++)if(null!=(n$c=n$b[n$h]))if(n$F=!1,n$c instanceof laya.html.dom.HTMLBrElement)n$G(),n$z.y=n$v;else{if(n$c._isChar()){if((n$f=n$c).isWord)n$C=n$D||"\n"===n$f.char,n$z.wordStartIndex=n$z.elements.length;else{if(0<n$y.length&&n$o<n$u+n$w&&0<n$z.wordStartIndex){var n$H;n$H=n$z.elements.length-n$z.wordStartIndex+1,n$z.elements.length=n$z.wordStartIndex,n$h-=n$H,n$G();continue}n$C=!1,n$E+=n$f.width}n$w=n$f.width+n$k,n$x=n$f.height,n$D=!1,(n$C=n$C||n$o<n$u+n$w)&&n$G(),n$z.minTextHeight=Math.min(n$z.minTextHeight,n$c.height)}else n$d=n$c._getCSSStyle(),n$g=n$c,n$e=n$d.padding,0===n$d._getCssFloat()||(n$t=!0),n$C=n$D||n$d.lineElement,n$w=n$g.width*n$g._style._tf.scaleX+n$e[1]+n$e[3]+n$k,n$x=n$g.height*n$g._style._tf.scaleY+n$e[0]+n$e[2],n$D=n$d.lineElement,(n$C=n$C||n$o<n$u+n$w&&n$d.wordWrap)&&n$G();n$z.elements.push(n$c),n$z.h=Math.max(n$z.h,n$x),n$c.x=n$u,n$c.y=n$v,n$u+=n$w,n$z.w=n$u-n$k,n$z.y=n$v,n$p=Math.max(n$u+n$q,n$p)}else n$F||(n$u+=n$K.DIV_ELEMENT_PADDING),n$z.wordStartIndex=n$z.elements.length;if(n$v=n$z.y+n$z.h,n$t){var n$I=0,n$J=n$o;for(n$h=0,n$i=n$y.length;n$h<n$i;n$h++)n$y[n$h].updatePos(0,n$J,n$h,n$I,n$r,n$s,n$m),n$I+=Math.max(n$m,n$y[n$h].h+n$l);n$v=n$I}for(n$n&&(n$a.width=n$p),n$v>n$a.height&&(n$a.height=n$v),n$h=0,n$i=n$y.length;n$h<n$i;n$h++)n$y[n$h].revertOrder(n$o);return[n$p,n$v]},n$K._will=null,n$K.DIV_ELEMENT_PADDING=0,n$K}(),n$M=function(){function n$a(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}n$g(n$a,"laya.html.utils.LayoutLine");var n$b=n$a.prototype;return n$b.updatePos=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){var n$h,n$i=0;0<this.elements.length&&(n$i=(n$h=this.elements[this.elements.length-1]).x+n$h.width-this.elements[0].x);var n$j=0,n$k=NaN;1===n$e&&(n$j=(n$b-n$i)/2),2===n$e&&(n$j=n$b-n$i),0===n$g||0!=n$f||(n$f=1);for(var n$l=0,n$m=this.elements.length;n$l<n$m;n$l++){var n$n=(n$h=this.elements[n$l])._getCSSStyle();switch(0!==n$j&&(n$h.x+=n$j),n$n._getValign()){case 0:n$h.y=n$d;break;case 1:var n$o=0;99999!=this.minTextHeight&&(n$o=this.minTextHeight);var n$p=(n$o+n$g)/2;n$p=Math.max(n$p,this.h),n$k=(laya.html.dom.HTMLImageElement,n$d+n$p-n$h.height),n$h.y=n$k;break;case 2:n$h.y=n$d+(n$g-n$h.height)}}},n$b.revertOrder=function(n$a){var n$b;if(0<this.elements.length){var n$c,n$d=0;for(n$c=this.elements.length,n$d=0;n$d<n$c;n$d++)(n$b=this.elements[n$d]).x=n$a-n$b.x-n$b.width}},n$a}(),n$v=function(n$c){function n$b(){this.URI=null,this._href=null,n$b.__super.call(this),this._text=n$b._EMPTYTEXT,this.setStyle(new n$i(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}n$g(n$b,"laya.html.dom.HTMLElement",n$c);var n$a=n$b.prototype;return n$a.layaoutCallNative=function(){var n$a=0;if(this._childs&&0<(n$a=this._childs.length))for(var n$b=0;n$b<n$a;n$b++)this._childs[n$b].layaoutCallNative&&this._childs[n$b].layaoutCallNative();var n$c=this._getWords();n$c?laya.html.dom.HTMLElement.fillWords(this,n$c,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},n$a.appendChild=function(n$a){return this.addChild(n$a)},n$a._getWords2=function(){var n$a=this._text.text;if(!n$a||0===n$a.length)return null;var n$b,n$c,n$d=0,n$e=0;if(this._text.drawWords)n$c=this._text.drawWords;else{for(n$e=(n$b=n$a.split(" ")).length-1,n$c=[],n$d=0;n$d<n$e;n$d++)n$c.push(n$b[n$d]," ");0<=n$e&&n$c.push(n$b[n$e]),this._text.drawWords=n$c}var n$f,n$g=this._text.words;if(n$g&&n$g.length===n$c.length)return n$g;null===n$g&&(this._text.words=n$g=[]),n$g.length=n$c.length;var n$h=this.style,n$i=n$h.font;for(n$d=0,n$e=n$c.length;n$d<n$e;n$d++){n$f=n$s.measureText(n$c[n$d],n$i);var n$j=n$g[n$d]=new n$l(n$c[n$d],n$f.width,n$f.height||n$h.fontSize,n$h);if(1<n$j.char.length&&(n$j.charNum=n$j.char),this.href){var n$k=new n$n;this.addChild(n$k),n$j.setSprite(n$k)}}return n$g},n$a._getWords=function(){if(!n$L.CharacterCache)return this._getWords2();var n$a=this._text.text;if(!n$a||0===n$a.length)return null;var n$b,n$c=this._text.words;if(n$c&&n$c.length===n$a.length)return n$c;null===n$c&&(this._text.words=n$c=[]),n$c.length=n$a.length;for(var n$d=this.style,n$e=n$d.font,n$f=0,n$g=n$a.length;n$f<n$g;n$f++)if(n$b=n$s.measureText(n$a.charAt(n$f),n$e)){var n$h=n$c[n$f]=new n$l(n$a.charAt(n$f),n$b.width,n$b.height||n$d.fontSize,n$d);if(this.href){var n$i=new n$n;this.addChild(n$i),n$h.setSprite(n$i)}}else console.warn("_getWords size is null"+n$a.charAt(n$f),n$e);return n$c},n$a.showLinkSprite=function(){var n$a=this._text.words;if(n$a)for(var n$b,n$c,n$d=[],n$e=0;n$e<n$a.length;n$e++)n$c=n$a[n$e],(n$b=new n$n).graphics.drawRect(0,0,n$c.width,n$c.height,"#ff0000"),n$b.width=n$c.width,n$b.height=n$c.height,this.addChild(n$b),n$d.push(n$b)},n$a._layoutLater=function(){var n$a=this.style;512&n$a._type||(n$a.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&n$a.block?(n$u.later(this),n$a._type|=512):this.parent&&this.parent._layoutLater())},n$a._setAttributes=function(n$a,n$b){switch(n$a){case"style":return void this.style.cssText(n$b);case"class":return void(this.className=n$b)}n$c.prototype._setAttributes.call(this,n$a,n$b)},n$a.updateHref=function(){if(null!=this._href){var n$a=this._getWords();if(n$a)for(var n$b,n$c,n$d=0;n$d<n$a.length;n$d++)(n$c=(n$b=n$a[n$d]).getSprite())&&(n$c.size(n$b.width,n$b.height),n$c.on("click",this,this.onLinkHandler))}},n$a.onLinkHandler=function(n$a){switch(n$a.type){case"click":for(var n$b=this;n$b;)n$b.event("link",[this.href]),n$b=n$b.parent}},n$a.formatURL=function(n$a){return this.URI?n$r.formatURL(n$a,this.URI?this.URI.path:null):n$a},n$h(0,n$a,"href",function(){return this._href},function(n$a){null!=(this._href=n$a)&&(this._getCSSStyle().underLine=1,this.updateHref())}),n$h(0,n$a,"color",null,function(n$a){this.style.color=n$a}),n$h(0,n$a,"onClick",null,function(n$a){n$d._runScript("fn=function(event){"+n$a+";}"),this.on("click",this,void 0)}),n$h(0,n$a,"id",null,function(n$a){n$w.document.setElementById(n$a,this)}),n$h(0,n$a,"innerTEXT",function(){return this._text.text},function(n$a){this.text=n$a}),n$h(0,n$a,"style",function(){return this._style}),n$h(0,n$a,"text",function(){return this._text.text},function(n$a){this._text==n$b._EMPTYTEXT?this._text={text:n$a,words:null}:(this._text.text=n$a,this._text.words&&(this._text.words.length=0)),n$m.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),n$h(0,n$a,"parent",n$c.prototype._$get_parent,function(n$a){if(n$a instanceof laya.html.dom.HTMLElement){var n$b=n$a;this.URI||(this.URI=n$b.URI),this.style.inherit(n$b.style)}n$d.superSet(n$n,this,"parent",n$a)}),n$h(0,n$a,"className",null,function(n$a){this.style.attrs(n$w.document.styleSheets["."+n$a])}),n$b.fillWords=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){n$a.graphics.clear();for(var n$h=0,n$i=n$b.length;n$h<n$i;n$h++){var n$j=n$b[n$h];n$a.graphics.fillText(n$j.char,n$j.x+n$c,n$j.y+n$d,n$e,n$f,"left",n$g)}},n$b._EMPTYTEXT={text:null,words:null},n$b}(n$n),n$b=(function(n$a){function n$b(){n$b.__super.call(this),this.style.lineElement=!0,this.style.block=!0}n$g(n$b,"laya.html.dom.HTMLBrElement",n$v)}(),function(n$a){function n$b(){this.contextHeight=NaN,this.contextWidth=NaN,n$b.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}n$g(n$b,"laya.html.dom.HTMLDivElement",n$a);var n$c=n$b.prototype;return n$c.appendHTML=function(n$a){n$t.parse(this,n$a,this.URI),this.layout()},n$c._addChildsToLayout=function(n$b){var n$a=this._getWords();if(null==n$a&&0==this._childs.length)return!1;n$a&&n$a.forEach(function(n$a){n$b.push(n$a)});for(var n$c=!0,n$d=0,n$e=this._childs.length;n$d<n$e;n$d++){var n$f=this._childs[n$d];n$c?n$c=!1:n$b.push(null),n$f._addToLayout(n$b)}return!0},n$c._addToLayout=function(n$a){this.layout()},n$c.layout=function(){if(this.style){this.style._type|=512;var n$a=n$u.layout(this);if(n$a){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new n$k);var n$b=this._$P.mHtmlBounds;n$b.x=n$b.y=0,n$b.width=this.contextWidth=n$a[0],n$b.height=this.contextHeight=n$a[1],this.setBounds(n$b)}}},n$h(0,n$c,"height",function(){return this._height?this._height:this.contextHeight},n$a.prototype._$set_height),n$h(0,n$c,"innerHTML",null,function(n$a){this.destroyChildren(),this.appendHTML(n$a)}),n$h(0,n$c,"width",function(){return this._width?this._width:this.contextWidth},function(n$a){var n$b=!1;n$b=0===n$a?n$a!=this._width:n$a!=this.width,n$d.superSet(n$v,this,"width",n$a),n$b&&this.layout()}),n$b}(n$v)),n$w=function(n$a){function n$b(){this.all=new Array,this.styleSheets=n$i.styleSheets,n$b.__super.call(this)}n$g(n$b,"laya.html.dom.HTMLDocument",n$v);var n$c=n$b.prototype;return n$c.getElementById=function(n$a){return this.all[n$a]},n$c.setElementById=function(n$a,n$b){this.all[n$a]=n$b},n$e(n$b,["document",function(){return this.document=new n$b}]),n$b}();(function(n$a){function n$b(){this._tex=null,this._url=null,this._renderArgs=[],n$b.__super.call(this),this.style.block=!0}n$g(n$b,"laya.html.dom.HTMLImageElement",n$v);var n$c=n$b.prototype;n$c._addToLayout=function(n$a){!this._style.absolute&&n$a.push(this)},n$c.render=function(n$a,n$b,n$c){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(n$p.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,n$a.ctx.drawTexture2(n$b,n$c,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},n$c.layaoutCallNative=function(){var n$a=0;if(this._childs&&0<(n$a=this._childs.length))for(var n$b=0;n$b<n$a;n$b++)this._childs[n$b].layaoutCallNative&&this._childs[n$b].layaoutCallNative()},n$h(0,n$c,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(n$a){this._width!==n$a&&(this._width=n$a,this._style.width=n$a,this.repaint())}),n$h(0,n$c,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(n$a){this._height!==n$a&&(this._height=n$a,this._style.height=n$a,this.repaint())}),n$c.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),n$j.clearCache(this,this._url),this._tex=null),n$v.prototype.destroy.call(this)},n$c.onloaded=function(){var n$a=this._style;n$a&&!n$a.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),n$a&&!n$a.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),n$m.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},n$c._loadImageComplete=function(n$a,n$b,n$c){if(!this._destroyed)if(null!=n$c)if(n$c instanceof ArrayBuffer){var n$d=new DataView(n$c);new laya.webgl.resource.WebGLImage(new Uint8Array(n$c,8),n$a,0,!1,n$d.getUint32(0),n$d.getUint32(4));this.onloaded()}else if(n$c instanceof n$q)n$j.imgMgrSet[n$a]=n$b,n$f.imgMgrLock(n$a,n$j.imgMgrSet[n$a]),this._url=n$a,this._tex=n$c,n$j.keepCache(this,n$a),n$j.cacheRes(n$a,this._tex),this.onloaded();else{var n$e=-1!=n$a.indexOf(".png",n$a.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(n$c,n$a,n$e,!1,n$c.width,n$c.height);this.onloaded()}else this.event("error","Load image failed")},n$h(0,n$c,"src",null,function(n$a){(n$a=this.formatURL(n$a),this._url!=n$a)&&(null!=this._tex&&(n$j.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=n$a,(this._tex=n$j.getRes(n$a))?(n$j.keepCache(this,n$a),this.onloaded()):n$f.imgMgrLoad(n$a,this._loadImageComplete.bind(this),2,!1))})})(),function(n$a){function n$b(){this.type=null,n$b.__super.call(this),this.visible=!1}n$g(n$b,"laya.html.dom.HTMLLinkElement",n$a);var n$c=n$b.prototype;n$c._onload=function(n$a){switch(this.type){case"text/css":n$i.parseCSS(n$a,this.URI)}},n$h(0,n$c,"href",n$a.prototype._$get_href,function(n$a){var n$b=this;n$a=this.formatURL(n$a),this.URI=new n$r(n$a);var n$c=new n$j;n$c.once("complete",null,function(n$a){n$b._onload(n$a)}),n$c.load(n$a,"text")}),n$b._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(n$v),function(n$a){function n$b(){n$b.__super.call(this),this.visible=!1}n$g(n$b,"laya.html.dom.HTMLStyleElement",n$a),n$h(0,n$b.prototype,"text",n$a.prototype._$get_text,function(n$a){n$i.parseCSS(n$a,null)})}(n$v),function(n$a){function n$b(){n$b.__super.call(this),this._getCSSStyle().valign="middle"}n$g(n$b,"laya.html.dom.HTMLIframeElement",n$a),n$h(0,n$b.prototype,"href",n$a.prototype._$get_href,function(n$c){var n$d=this;n$c=this.formatURL(n$c);var n$a=new n$j;n$a.once("complete",null,function(n$a){var n$b=n$d.URI;n$d.URI=new n$r(n$c),n$d.innerHTML=n$a,!n$b||(n$d.URI=n$b)}),n$a.load(n$c,"text")})}(n$b)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(n$a,n$b){"use strict";for(var n$c in Object.defineProperty(n$b,"__esModule",{value:!0}),Laya){var n$d=Laya[n$c];n$d&&n$d.__isclass&&(n$b[n$c]=n$d)}}),function(n$a,n$b,n$p){n$p.un,n$p.uns;var n$d=n$p.static,n$f=n$p.class,n$e=n$p.getset,n$c=(n$p.__newvec,laya.display.Animation),n$q=(laya.utils.Browser,laya.utils.ClassUtils),n$g=laya.filters.ColorFilter,n$h=laya.utils.Ease,n$i=laya.events.Event,n$j=(laya.events.EventDispatcher,laya.display.css.Font),n$k=laya.display.FrameAnimation,n$l=laya.display.Graphics,n$m=laya.utils.Handler,n$n=laya.display.Input,n$s=laya.net.Loader,n$o=(laya.display.Node,laya.maths.Point),n$r=laya.maths.Rectangle,n$t=laya.renders.Render,n$u=laya.display.Sprite,n$v=laya.display.Text,n$w=laya.resource.Texture,n$x=laya.utils.Tween,n$y=laya.utils.Utils,n$z=laya.utils.WeakObject;n$p.interface("laya.ui.IItem"),n$p.interface("laya.ui.ISelect"),n$p.interface("laya.ui.IRender"),n$p.interface("laya.ui.IComponent"),n$p.interface("laya.ui.IBox","IComponent");var n$C=function(){function n$a(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return n$f(n$a,"laya.ui.LayoutStyle"),n$d(n$a,["EMPTY",function(){return this.EMPTY=new n$a}]),n$a}(),n$D=function(){function n$a(){}return n$f(n$a,"laya.ui.Styles"),n$a.labelColor="#000000",n$a.buttonStateNum=3,n$a.scrollBarMinNum=15,n$a.scrollBarDelayTime=500,n$d(n$a,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),n$a}(),n$E=function(){function n$e(){}return n$f(n$e,"laya.ui.UIUtils"),n$e.fillArray=function(n$a,n$b,n$c){var n$d=n$a.concat();if(n$b)for(var n$e=n$b.split(","),n$f=0,n$g=Math.min(n$d.length,n$e.length);n$f<n$g;n$f++){var n$h=n$e[n$f];n$d[n$f]="true"==n$h||"false"!=n$h&&n$h,null!=n$c&&(n$d[n$f]=n$c(n$h))}return n$d},n$e.toColor=function(n$a){return n$y.toHexColor(n$a)},n$e.gray=function(n$a,n$b){void 0===n$b&&(n$b=!0),n$b?n$e.addFilter(n$a,n$e.grayFilter):n$e.clearFilter(n$a,n$g)},n$e.addFilter=function(n$a,n$b){var n$c=n$a.filters||[];n$c.push(n$b),n$a.filters=n$c},n$e.clearFilter=function(n$a,n$b){var n$c=n$a.filters;if(null!=n$c&&0<n$c.length){for(var n$d=n$c.length-1;-1<n$d;n$d--){var n$e=n$c[n$d];n$p.__typeof(n$e,n$b)&&n$c.splice(n$d,1)}n$a.filters=n$c}},n$e._getReplaceStr=function(n$a){return n$e.escapeSequence[n$a]},n$e.adptString=function(n$a){return n$a.replace(/\\(\w)/g,n$e._getReplaceStr)},n$e.getBindFun=function(n$a){var n$b=n$e._funMap.get(n$a);if(null==n$b){var n$c='"'+n$a+'"',n$d="(function(data){if(data==null)return;with(data){try{\nreturn "+(n$c=n$c.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";n$b=n$p._runScript(n$d),n$e._funMap.set(n$a,n$b)}return n$b},n$d(n$e,["grayFilter",function(){return this.grayFilter=new n$g([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new n$z}]),n$e}(),n$F=function(){function n$a(){}return n$f(n$a,"UIConfig"),n$a.touchScrollEnable=!0,n$a.mouseWheelEnable=!0,n$a.showButtons=!0,n$a.popupBgColor="#000000",n$a.popupBgAlpha=.5,n$a.closeDialogOnSide=!0,n$a}(),n$G=function(n$c){function n$r(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,n$r.__super.call(this),this._weakKeys=[]}n$f(n$r,"laya.ui.AutoBitmap",n$c);var n$a=n$r.prototype;return n$a.destroy=function(){if(n$s.clearObject(this,this._weakKey),this._weakKeys){for(var n$a=0,n$b=this._weakKeys.length;n$a<n$b;++n$a)n$s.clearObject(this,this._weakKeys[n$a]);this._weakKeys=null}n$c.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},n$a._setChanged=function(){this._isChanged||(this._isChanged=!0,n$p.timer.callLater(this,this.changeSource))},n$a.changeSource=function(){this._isChanged=!1;var n$a=this._source;if(n$a&&n$a.bitmap){var n$b=this.width,n$c=this.height,n$d=this._sizeGrid,n$e=n$a.sourceWidth,n$f=n$a.sourceHeight;if(!n$d||n$e===n$b&&n$f===n$c)this.cleanByTexture(n$a,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,n$b,n$c);else{n$s.clearObject(this,this._weakKey),n$a.$_GID||(n$a.$_GID=n$y.getGID());var n$g=n$a.$_GID+"."+n$b+"."+n$c+"."+n$d.join("."),n$h=n$s.findObject(n$g);if(n$y.isOKCmdList(n$h))return this._weakKey=n$g,n$s.keepObject(this,this._weakKey),void(this.cmds=n$h);this.clear();var n$i,n$j,n$k=n$d[0],n$l=n$d[1],n$m=n$d[2],n$n=n$d[3],n$o=n$d[4],n$p=!1;if(n$b==n$e&&(n$n=n$l=0),n$c==n$f&&(n$k=n$m=0),n$b<n$n+n$l){var n$q=n$b;n$p=!0,n$b=n$n+n$l,this.save(),this.clipRect(0,0,n$q,n$c)}n$n&&n$k&&(n$i=n$r.getTexture(n$a,0,0,n$n,n$k),n$j=this._weakKeys[0],n$i?(n$j!=n$i.weakKey&&(n$s.clearObject(this,n$j),n$s.keepObject(this,n$i.weakKey),this._weakKeys[0]=n$i.weakKey),this.drawTexture(n$i,0,0,n$n,n$k)):(n$s.clearObject(this,n$j),this._weakKeys[0]="")),n$l&&n$k&&(n$i=n$r.getTexture(n$a,n$e-n$l,0,n$l,n$k),n$j=this._weakKeys[1],n$i?(n$j!=n$i.weakKey&&(n$s.clearObject(this,n$j),n$s.keepObject(this,n$i.weakKey),this._weakKeys[1]=n$i.weakKey),this.drawTexture(n$i,n$b-n$l,0,n$l,n$k)):(n$s.clearObject(this,n$j),this._weakKeys[1]="")),n$n&&n$m&&(n$i=n$r.getTexture(n$a,0,n$f-n$m,n$n,n$m),n$j=this._weakKeys[2],n$i?(n$j!=n$i.weakKey&&(n$s.clearObject(this,n$j),n$s.keepObject(this,n$i.weakKey),this._weakKeys[2]=n$i.weakKey),this.drawTexture(n$i,0,n$c-n$m,n$n,n$m)):(n$s.clearObject(this,n$j),this._weakKeys[2]="")),n$l&&n$m&&(n$i=n$r.getTexture(n$a,n$e-n$l,n$f-n$m,n$l,n$m),n$j=this._weakKeys[3],n$i?(n$j!=n$i.weakKey&&(n$s.clearObject(this,n$j),n$s.keepObject(this,n$i.weakKey),this._weakKeys[3]=n$i.weakKey),this.drawTexture(n$i,n$b-n$l,n$c-n$m,n$l,n$m)):(n$s.clearObject(this,n$j),this._weakKeys[3]="")),n$k&&(n$i=n$r.getTexture(n$a,n$n,0,n$e-n$n-n$l,n$k),n$j=this._weakKeys[4],n$i?(n$j!=n$i.weakKey&&(n$s.clearObject(this,n$j),n$s.keepObject(this,n$i.weakKey),this._weakKeys[4]=n$i.weakKey),this.drawBitmap(n$o,n$i,n$n,0,n$b-n$n-n$l,n$k)):(n$s.clearObject(this,n$j),this._weakKeys[4]="")),n$m&&(n$i=n$r.getTexture(n$a,n$n,n$f-n$m,n$e-n$n-n$l,n$m),n$j=this._weakKeys[5],n$i?(n$j!=n$i.weakKey&&(n$s.clearObject(this,n$j),n$s.keepObject(this,n$i.weakKey),this._weakKeys[5]=n$i.weakKey),this.drawBitmap(n$o,n$i,n$n,n$c-n$m,n$b-n$n-n$l,n$m)):(n$s.clearObject(this,n$j),this._weakKeys[5]="")),n$n&&(n$i=n$r.getTexture(n$a,0,n$k,n$n,n$f-n$k-n$m),n$j=this._weakKeys[6],n$i?(n$j!=n$i.weakKey&&(n$s.clearObject(this,n$j),n$s.keepObject(this,n$i.weakKey),this._weakKeys[6]=n$i.weakKey),this.drawBitmap(n$o,n$i,0,n$k,n$n,n$c-n$k-n$m)):(n$s.clearObject(this,n$j),this._weakKeys[6]="")),n$l&&(n$i=n$r.getTexture(n$a,n$e-n$l,n$k,n$l,n$f-n$k-n$m),n$j=this._weakKeys[7],n$i?(n$j!=n$i.weakKey&&(n$s.clearObject(this,n$j),n$s.keepObject(this,n$i.weakKey),this._weakKeys[7]=n$i.weakKey),this.drawBitmap(n$o,n$i,n$b-n$l,n$k,n$l,n$c-n$k-n$m)):(n$s.clearObject(this,n$j),this._weakKeys[7]="")),n$i=n$r.getTexture(n$a,n$n,n$k,n$e-n$n-n$l,n$f-n$k-n$m),n$j=this._weakKeys[8],n$i?(n$j!=n$i.weakKey&&(n$s.clearObject(this,n$j),n$s.keepObject(this,n$i.weakKey),this._weakKeys[8]=n$i.weakKey),this.drawBitmap(n$o,n$i,n$n,n$k,n$b-n$n-n$l,n$c-n$k-n$m)):(n$s.clearObject(this,n$j),this._weakKeys[8]=""),n$p&&this.restore(),this.autoCacheCmd&&!n$t.isConchApp&&(n$s.saveObject(n$g,this.cmds,null),this._weakKey=n$g,n$s.keepObject(this,this._weakKey))}this._repaint()}},n$a.drawBitmap=function(n$a,n$b,n$c,n$d,n$e,n$f){void 0===n$e&&(n$e=0),void 0===n$f&&(n$f=0),n$e<.1||n$f<.1||(!n$a||n$b.width==n$e&&n$b.height==n$f?this.drawTexture(n$b,n$c,n$d,n$e,n$f):this.fillTexture(n$b,n$c,n$d,n$e,n$f))},n$a.clear=function(n$a){void 0===n$a&&(n$a=!0),n$c.prototype.clear.call(this,!1)},n$e(0,n$a,"sizeGrid",function(){return this._sizeGrid},function(n$a){this._sizeGrid=n$a,this._setChanged()}),n$e(0,n$a,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(n$a){this._width!=n$a&&(this._width=n$a,this._setChanged())}),n$e(0,n$a,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(n$a){this._height!=n$a&&(this._height=n$a,this._setChanged())}),n$e(0,n$a,"source",function(){return this._source},function(n$a){n$a?(this._source=n$a,this._setChanged()):(this._source=null,this.clear())}),n$r.getTexture=function(n$a,n$b,n$c,n$d,n$e){n$d<=0&&(n$d=1),n$e<=0&&(n$e=1),n$a.$_GID||(n$a.$_GID=n$y.getGID());var n$f=n$a.$_GID+"."+n$b+"."+n$c+"."+n$d+"."+n$e,n$g=n$s.findObject(n$f);if((!n$g||!n$g.source)&&(n$g=n$w.createFromTexture(n$a,n$b,n$c,n$d,n$e))){if(n$a.alphaTexture){var n$h=n$a.width/n$a.alphaTexture.width;n$g.alphaTexture=n$w.createFromTexture(n$a.alphaTexture,n$b/n$h,n$c/n$h,n$d/n$h,n$e/n$h)}n$s.saveObject(n$f,n$g),n$g.weakKey=n$f}return n$g},n$r}(n$l),n$H=(function(n$a){function n$b(){n$b.__super.call(this)}n$f(n$b,"laya.ui.UIEvent",n$i),n$b.SHOW_TIP="showtip",n$b.HIDE_TIP="hidetip"}(),function(n$b){function n$a(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,n$a.__super.call(this),this._layout=n$C.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}n$f(n$a,"laya.ui.Component",n$b);var n$c=n$a.prototype;return n$p.imps(n$c,{"laya.ui.IComponent":!0}),n$c.destroy=function(n$a){void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,n$a),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},n$c.preinitialize=function(){},n$c.createChildren=function(){},n$c.initialize=function(){},n$c.callLater=function(n$a,n$b){n$p.timer.callLater(this,n$a,n$b)},n$c.runCallLater=function(n$a){n$p.timer.runCallLater(this,n$a)},n$c.commitMeasure=function(){},n$c.changeSize=function(){this.event("resize")},n$c.getLayout=function(){return this._layout===n$C.EMPTY&&(this._layout=new n$C),this._layout},n$c._setLayoutEnabled=function(n$a){this._layout&&this._layout.enable!=n$a&&(this._layout.enable=n$a,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},n$c.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},n$c.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},n$c.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},n$c.resetLayoutX=function(){var n$a=this._layout;if(isNaN(n$a.anchorX)||(this.pivotX=n$a.anchorX*this.width),this.layoutEnabled){var n$b=this.parent;n$b&&(isNaN(n$a.centerX)?isNaN(n$a.left)?isNaN(n$a.right)||(this.x=Math.round(n$b.width-this.displayWidth-n$a.right+this.pivotX*this.scaleX)):(this.x=Math.round(n$a.left+this.pivotX*this.scaleX),isNaN(n$a.right)||(this.width=(n$b._width-n$a.left-n$a.right)/(this.scaleX||.01))):this.x=Math.round(.5*(n$b.width-this.displayWidth)+n$a.centerX+this.pivotX*this.scaleX))}},n$c.resetLayoutY=function(){var n$a=this._layout;if(isNaN(n$a.anchorY)||(this.pivotY=n$a.anchorY*this.height),this.layoutEnabled){var n$b=this.parent;n$b&&(isNaN(n$a.centerY)?isNaN(n$a.top)?isNaN(n$a.bottom)||(this.y=Math.round(n$b.height-this.displayHeight-n$a.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(n$a.top+this.pivotY*this.scaleY),isNaN(n$a.bottom)||(this.height=(n$b._height-n$a.top-n$a.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(n$b.height-this.displayHeight)+n$a.centerY+this.pivotY*this.scaleY))}},n$c.onMouseOver=function(n$a){n$p.stage.event("showtip",this._toolTip)},n$c.onMouseOut=function(n$a){n$p.stage.event("hidetip",this._toolTip)},n$e(0,n$c,"displayWidth",function(){return this.width*this.scaleX}),n$e(0,n$c,"width",function(){return this._width?this._width:this.measureWidth},function(n$a){this._width!=n$a&&(this._width=n$a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),n$e(0,n$c,"measureWidth",function(){var n$a=0;this.commitMeasure();for(var n$b=this.numChildren-1;-1<n$b;n$b--){var n$c=this.getChildAt(n$b);n$c.visible&&(n$a=Math.max(n$c.x+n$c.width*n$c.scaleX,n$a))}return n$a}),n$e(0,n$c,"displayHeight",function(){return this.height*this.scaleY}),n$e(0,n$c,"height",function(){return this._height?this._height:this.measureHeight},function(n$a){this._height!=n$a&&(this._height=n$a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),n$e(0,n$c,"dataSource",function(){return this._dataSource},function(n$a){for(var n$b in this._dataSource=n$a,this._dataSource)this.hasOwnProperty(n$b)&&"function"!=typeof this[n$b]&&(this[n$b]=this._dataSource[n$b])}),n$e(0,n$c,"scaleY",n$b.prototype._$get_scaleY,function(n$a){n$p.superGet(n$u,this,"scaleY")!=n$a&&(n$p.superSet(n$u,this,"scaleY",n$a),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),n$e(0,n$c,"measureHeight",function(){var n$a=0;this.commitMeasure();for(var n$b=this.numChildren-1;-1<n$b;n$b--){var n$c=this.getChildAt(n$b);n$c.visible&&(n$a=Math.max(n$c.y+n$c.height*n$c.scaleY,n$a))}return n$a}),n$e(0,n$c,"scaleX",n$b.prototype._$get_scaleX,function(n$a){n$p.superGet(n$u,this,"scaleX")!=n$a&&(n$p.superSet(n$u,this,"scaleX",n$a),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),n$e(0,n$c,"top",function(){return this._layout.top},function(n$a){n$a!=this._layout.top&&(this.getLayout().top=n$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),n$e(0,n$c,"bottom",function(){return this._layout.bottom},function(n$a){n$a!=this._layout.bottom&&(this.getLayout().bottom=n$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),n$e(0,n$c,"left",function(){return this._layout.left},function(n$a){n$a!=this._layout.left&&(this.getLayout().left=n$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),n$e(0,n$c,"right",function(){return this._layout.right},function(n$a){n$a!=this._layout.right&&(this.getLayout().right=n$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),n$e(0,n$c,"centerX",function(){return this._layout.centerX},function(n$a){n$a!=this._layout.centerX&&(this.getLayout().centerX=n$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),n$e(0,n$c,"centerY",function(){return this._layout.centerY},function(n$a){n$a!=this._layout.centerY&&(this.getLayout().centerY=n$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),n$e(0,n$c,"anchorX",function(){return this._layout.anchorX},function(n$a){n$a!=this._layout.anchorX&&(this.getLayout().anchorX=n$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),n$e(0,n$c,"anchorY",function(){return this._layout.anchorY},function(n$a){n$a!=this._layout.anchorY&&(this.getLayout().anchorY=n$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),n$e(0,n$c,"tag",function(){return this._tag},function(n$a){this._tag=n$a}),n$e(0,n$c,"toolTip",function(){return this._toolTip},function(n$a){this._toolTip!=n$a&&(null!=(this._toolTip=n$a)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),n$e(0,n$c,"comXml",function(){return this._comXml},function(n$a){this._comXml=n$a}),n$e(0,n$c,"gray",function(){return this._gray},function(n$a){n$a!==this._gray&&(this._gray=n$a,n$E.gray(this,n$a))}),n$e(0,n$c,"disabled",function(){return this._disabled},function(n$a){n$a!==this._disabled&&(this.gray=this._disabled=n$a,this.mouseEnabled=!n$a)}),n$a}(n$u)),n$I=function(n$a){function n$b(){this.lockLayer=null,this.popupEffect=function(n$a){n$a.scale(1,1),n$x.from(n$a,{x:n$p.stage.width/2,y:n$p.stage.height/2,scaleX:0,scaleY:0},300,n$h.backOut,n$m.create(this,this.doOpen,[n$a]))},this.closeEffect=function(n$a,n$b){n$x.to(n$a,{x:n$p.stage.width/2,y:n$p.stage.height/2,scaleX:0,scaleY:0},300,n$h.strongOut,n$m.create(this,this.doClose,[n$a,n$b]))},n$b.__super.call(this),this.maskLayer=new n$u,this.popupEffectHandler=n$m.create(this,this.popupEffect,null,!1),this.closeEffectHandler=n$m.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,n$p.stage.addChild(this),n$p.stage.on("resize",this,this._onResize),n$F.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}n$f(n$b,"laya.ui.DialogManager",n$u);var n$c=n$b.prototype;return n$c._closeOnSide=function(){var n$a=this.getChildAt(this.numChildren-1);n$a instanceof laya.ui.Dialog&&n$a.close("side")},n$c.setLockView=function(n$a){this.lockLayer||(this.lockLayer=new n$J,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(n$p.stage.width,n$p.stage.height)),this.lockLayer.removeChildren(),n$a&&(n$a.centerX=n$a.centerY=0,this.lockLayer.addChild(n$a))},n$c._onResize=function(n$a){var n$b=this.maskLayer.width=n$p.stage.width,n$c=this.maskLayer.height=n$p.stage.height;this.lockLayer&&this.lockLayer.size(n$b,n$c),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,n$b,n$c,n$F.popupBgColor),this.maskLayer.alpha=n$F.popupBgAlpha;for(var n$d=this.numChildren-1;-1<n$d;n$d--){var n$e=this.getChildAt(n$d);n$e.popupCenter&&this._centerDialog(n$e)}},n$c._centerDialog=function(n$a){n$a.x=Math.round((n$p.stage.width-n$a.width>>1)+n$a.pivotX),n$a.y=Math.round((n$p.stage.height-n$a.height>>1)+n$a.pivotY)},n$c.open=function(n$a,n$b,n$c){void 0===n$b&&(n$b=!1),void 0===n$c&&(n$c=!1),n$b&&this._closeAll(),n$a.popupCenter&&this._centerDialog(n$a),this.addChild(n$a),(n$a.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),n$c&&null!=n$a.popupEffect?n$a.popupEffect.runWith(n$a):this.doOpen(n$a),this.event("open")},n$c.doOpen=function(n$a){n$a.onOpened()},n$c.lock=function(n$a){this.lockLayer&&(n$a?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},n$c.close=function(n$a,n$b,n$c){void 0===n$c&&(n$c=!1),n$c&&null!=n$a.closeEffect?n$a.closeEffect.runWith([n$a,n$b]):this.doClose(n$a,n$b),this.event("close")},n$c.doClose=function(n$a,n$b){n$a.removeSelf(),n$a.isModal&&this._checkMask(),n$a.closeHandler&&n$a.closeHandler.runWith(n$b),n$a.onClosed(n$b)},n$c.closeAll=function(){this._closeAll(),this.event("close")},n$c._closeAll=function(){for(var n$a=this.numChildren-1;-1<n$a;n$a--){var n$b=this.getChildAt(n$a);n$b&&null!=n$b.close&&this.doClose(n$b)}},n$c.getDialogsByGroup=function(n$a){for(var n$b=[],n$c=this.numChildren-1;-1<n$c;n$c--){var n$d=this.getChildAt(n$c);n$d&&n$d.group===n$a&&n$b.push(n$d)}return n$b},n$c.closeByGroup=function(n$a){for(var n$b=[],n$c=this.numChildren-1;-1<n$c;n$c--){var n$d=this.getChildAt(n$c);n$d&&n$d.group===n$a&&(n$d.close(),n$b.push(n$d))}return n$b},n$c._checkMask=function(){this.maskLayer.removeSelf();for(var n$a=this.numChildren-1;-1<n$a;n$a--){var n$b=this.getChildAt(n$a);if(n$b&&n$b.isModal)return void this.addChildAt(this.maskLayer,n$a)}},n$b}(),n$J=function(n$a){function n$b(){n$b.__super.call(this)}n$f(n$b,"laya.ui.Box",n$a);var n$c=n$b.prototype;return n$p.imps(n$c,{"laya.ui.IBox":!0}),n$e(0,n$c,"dataSource",n$a.prototype._$get_dataSource,function(n$a){for(var n$b in this._dataSource=n$a){var n$c=this.getChildByName(n$b);n$c?n$c.dataSource=n$a[n$b]:this.hasOwnProperty(n$b)&&"function"!=typeof this[n$b]&&(this[n$b]=n$a[n$b])}}),n$b}(n$H),n$K=function(n$b){function n$c(n$a,n$b){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,n$c.__super.call(this),this._labelColors=n$D.buttonLabelColors,this._stateNum=n$D.buttonStateNum,void 0===n$b&&(n$b=""),this.skin=n$a,this.label=n$b}n$f(n$c,"laya.ui.Button",n$b);var n$a=n$c.prototype;return n$p.imps(n$a,{"laya.ui.ISelect":!0}),n$a.destroy=function(n$a){n$s.clearCache(this,this._skin),n$s.clearObject(this,this._weakKey),void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,n$a),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(n$a),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},n$a.createChildren=function(){this.graphics=this._bitmap=new n$G},n$a.createText=function(){this._text||(this._text=new n$v,this._text.overflow=n$v.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},n$a.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},n$a.onMouse=function(n$a){if(!1!==this.toggle||!this._selected)return"click"===n$a.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=n$c.stateMap[n$a.type]))},n$a.changeClips=function(){var n$a=n$s.getRes(this._skin);if(n$a&&this._skin&&""!=this._skin){n$s.clearObject(this,this._weakKey);var n$b=n$a.sourceWidth,n$c=n$a.sourceHeight/this._stateNum;n$a.$_GID||(n$a.$_GID=n$y.getGID());var n$d=n$a.$_GID+"-"+this._stateNum,n$e=n$s.findObject(n$d);if(n$y.isOkTextureList(n$e)||(n$e=null),n$e)this._weakKey=n$d,n$s.keepObject(this,this._weakKey),this._sources=n$e;else{if(this._sources=[],1===this._stateNum)this._sources.push(n$a);else for(var n$f=0;n$f<this._stateNum;n$f++){var n$g=n$w.createFromTexture(n$a,0,n$c*n$f,n$b,n$c);if(n$a.alphaTexture){var n$h=n$a.width/n$a.alphaTexture.width;n$g.alphaTexture=n$w.createFromTexture(n$a.alphaTexture,0/n$h,n$c*n$f/n$h,n$b/n$h,n$c/n$h)}this._sources.push(n$g)}n$s.saveObject(n$d,this._sources),this._weakKey=n$d,n$s.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||n$b,this._bitmap.height=this._height||n$c,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=n$b)}else console.warn("lose skin ",this._skin,this.name,this.__className)},n$a.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var n$a=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[n$a]),this.label&&(this._text.color=this._labelColors[n$a],this._strokeColors&&(this._text.strokeColor=this._strokeColors[n$a]))},n$a._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},n$e(0,n$a,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(n$a){this.createText(),this._text.strokeColor=n$a}),n$e(0,n$a,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),n$e(0,n$a,"skin",function(){return this._skin},function(n$a){this._skin!=n$a&&(n$s.clearCache(this,this._skin),this._skin=n$a,n$s.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),n$e(0,n$a,"state",function(){return this._state},function(n$a){this._state!=n$a&&(this._state=n$a,this._setStateChanged())}),n$e(0,n$a,"text",function(){return this.createText(),this._text}),n$e(0,n$a,"stateNum",function(){return this._stateNum},function(n$a){"string"==typeof n$a&&(n$a=parseInt(n$a)),this._stateNum!=n$a&&(this._stateNum=n$a<1?1:3<n$a?3:n$a,this.callLater(this.changeClips))}),n$e(0,n$a,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(n$a){this._strokeColors=n$E.fillArray(n$D.buttonLabelColors,n$a,String),this._setStateChanged()}),n$e(0,n$a,"labelColors",function(){return this._labelColors.join(",")},function(n$a){this._labelColors=n$E.fillArray(n$D.buttonLabelColors,n$a,String),this._setStateChanged()}),n$e(0,n$a,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),n$e(0,n$a,"label",function(){return this._text?this._text.text:null},function(n$a){(this._text||n$a)&&(this.createText(),this._text.text!=n$a&&(n$a&&!this._text.parent&&this.addChild(this._text),this._text.text=(n$a+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),n$e(0,n$a,"selected",function(){return this._selected},function(n$a){this._selected!=n$a&&(this._selected=n$a,this.state=this._selected?2:0,this.event("change"))}),n$e(0,n$a,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(n$a){this.createText(),this._text.padding=n$E.fillArray(n$D.labelPadding,n$a,Number)}),n$e(0,n$a,"labelSize",function(){return this.createText(),this._text.fontSize},function(n$a){this.createText(),this._text.fontSize=n$a}),n$e(0,n$a,"labelStroke",function(){return this.createText(),this._text.stroke},function(n$a){this.createText(),this._text.stroke=n$a}),n$e(0,n$a,"labelBold",function(){return this.createText(),this._text.bold},function(n$a){this.createText(),this._text.bold=n$a}),n$e(0,n$a,"labelFont",function(){return this.createText(),this._text.font},function(n$a){this.createText(),this._text.font=n$a}),n$e(0,n$a,"labelAlign",function(){return this.createText(),this._text.align},function(n$a){this.createText(),this._text.align=n$a}),n$e(0,n$a,"clickHandler",function(){return this._clickHandler},function(n$a){this._clickHandler=n$a}),n$e(0,n$a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(n$a){this._bitmap.sizeGrid=n$E.fillArray(n$D.defaultSizeGrid,n$a,Number)}),n$e(0,n$a,"width",n$b.prototype._$get_width,function(n$a){n$p.superSet(n$H,this,"width",n$a),this._autoSize&&(this._bitmap.width=n$a,this._text&&(this._text.width=n$a))}),n$e(0,n$a,"height",n$b.prototype._$get_height,function(n$a){n$p.superSet(n$H,this,"height",n$a),this._autoSize&&(this._bitmap.height=n$a,this._text&&(this._text.height=n$a))}),n$e(0,n$a,"dataSource",n$b.prototype._$get_dataSource,function(n$a){"number"==typeof(this._dataSource=n$a)||"string"==typeof n$a?this.label=n$a+"":n$p.superSet(n$H,this,"dataSource",n$a)}),n$e(0,n$a,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(n$a){this._bitmap._offset=n$a?n$E.fillArray([1,1],n$a,Number):[]}),n$d(n$c,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),n$c}(n$H),n$L=function(n$b){function n$d(n$a,n$b,n$c){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,n$d.__super.call(this),void 0===n$b&&(n$b=1),void 0===n$c&&(n$c=1),this._clipX=n$b,this._clipY=n$c,this.skin=n$a}n$f(n$d,"laya.ui.Clip",n$b);var n$a=n$d.prototype;return n$a.destroy=function(n$a){n$s.clearCache(this,this._skin),n$s.clearObject(this,this._weakKey),void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},n$a.dispose=function(){this.destroy(!0),n$p.loader.clearRes(this._skin)},n$a.createChildren=function(){this.graphics=this._bitmap=new n$G},n$a._onDisplay=function(n$a){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},n$a.changeClip=function(){if(this._clipChanged=!1,this._skin){var n$a=n$s.getRes(this._skin);n$a?this.loadComplete(this._skin,n$a):n$p.loader.load(this._skin,n$m.create(this,this.loadComplete,[this._skin]))}},n$a.loadComplete=function(n$a,n$b){if(n$a===this._skin&&n$b){n$s.clearObject(this,this._weakKey);var n$c=this._clipWidth||Math.ceil(n$b.sourceWidth/this._clipX),n$d=this._clipHeight||Math.ceil(n$b.sourceHeight/this._clipY),n$e=this._skin+n$c+n$d,n$f=n$s.findObject(n$e);if(n$y.isOkTextureList(n$f)||(n$f=null),n$f)this._weakKey=n$e,n$s.keepObject(this,this._weakKey),this._sources=n$f;else{this._sources=[];for(var n$g=0;n$g<this._clipY;n$g++)for(var n$h=0;n$h<this._clipX;n$h++){var n$i=n$w.createFromTexture(n$b,n$c*n$h,n$d*n$g,n$c,n$d);if(n$b.alphaTexture){var n$j=n$b.width/n$b.alphaTexture.width;n$i.alphaTexture=n$w.createFromTexture(n$b.alphaTexture,n$c*n$h/n$j,n$d*n$g/n$j,n$c/n$j,n$d/n$j)}this._sources.push(n$i)}n$s.saveObject(n$e,this._sources),this._weakKey=n$e,n$s.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},n$a.play=function(n$a,n$b){void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=-1),this._isPlaying=!0,this.index=n$a,this._toIndex=n$b,this._index++,n$p.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},n$a._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},n$a.stop=function(){this._isPlaying=!1,n$p.timer.clear(this,this._loop),this.event("complete")},n$a._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},n$e(0,n$a,"interval",function(){return this._interval},function(n$a){this._interval!=n$a&&(this._interval=n$a,this._isPlaying&&this.play())}),n$e(0,n$a,"skin",function(){return this._skin},function(n$a){this._skin!=n$a&&(n$s.clearCache(this,this._skin),(this._skin=n$a)?(n$s.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),n$e(0,n$a,"sources",function(){return this._sources},function(n$a){this._sources=n$a,this.index=this._index,this.event("loaded")}),n$e(0,n$a,"clipX",function(){return this._clipX},function(n$a){this._clipX=n$a||1,this._setClipChanged()}),n$e(0,n$a,"clipY",function(){return this._clipY},function(n$a){this._clipY=n$a||1,this._setClipChanged()}),n$e(0,n$a,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),n$e(0,n$a,"clipWidth",function(){return this._clipWidth},function(n$a){this._clipWidth=n$a,this._setClipChanged()}),n$e(0,n$a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(n$a){this._bitmap.sizeGrid=n$E.fillArray(n$D.defaultSizeGrid,n$a,Number)}),n$e(0,n$a,"group",function(){return this._group},function(n$a){n$a&&this._skin&&n$s.setGroup(this._skin,n$a),this._group=n$a}),n$e(0,n$a,"clipHeight",function(){return this._clipHeight},function(n$a){this._clipHeight=n$a,this._setClipChanged()}),n$e(0,n$a,"width",n$b.prototype._$get_width,function(n$a){n$p.superSet(n$H,this,"width",n$a),this._bitmap.width=n$a}),n$e(0,n$a,"height",n$b.prototype._$get_height,function(n$a){n$p.superSet(n$H,this,"height",n$a),this._bitmap.height=n$a}),n$e(0,n$a,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),n$e(0,n$a,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),n$e(0,n$a,"index",function(){return this._index},function(n$a){this._index=n$a,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[n$a]),this.event("change")}),n$e(0,n$a,"autoPlay",function(){return this._autoPlay},function(n$a){this._autoPlay!=n$a&&((this._autoPlay=n$a)?this.play():this.stop())}),n$e(0,n$a,"isPlaying",function(){return this._isPlaying},function(n$a){this._isPlaying=n$a}),n$e(0,n$a,"dataSource",n$b.prototype._$get_dataSource,function(n$a){"number"==typeof(this._dataSource=n$a)&&Math.floor(n$a)==n$a||"string"==typeof n$a?this.index=parseInt(n$a):n$p.superSet(n$H,this,"dataSource",n$a)}),n$e(0,n$a,"bitmap",function(){return this._bitmap}),n$d}(n$H),n$M=function(n$b){function n$a(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,n$a.__super.call(this)}n$f(n$a,"laya.ui.ColorPicker",n$b);var n$c=n$a.prototype;return n$c.destroy=function(n$a){void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,n$a),this._colorPanel&&this._colorPanel.destroy(n$a),this._colorButton&&this._colorButton.destroy(n$a),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},n$c.createChildren=function(){this.addChild(this._colorButton=new n$K),this._colorPanel=new n$J,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new n$u),this._colorPanel.addChild(this._colorBlock=new n$u),this._colorPanel.addChild(this._colorInput=new n$n)},n$c.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},n$c.onPanelMouseDown=function(n$a){n$a.stopPropagation()},n$c.changePanel=function(){this._panelChanged=!1;var n$a=this._colorPanel.graphics;n$a.clear(),n$a.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(n$a=this._colorTiles.graphics).clear();for(var n$b=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],n$c=0;n$c<12;n$c++)for(var n$d=0;n$d<20;n$d++){var n$e=0;n$e=0===n$d?n$b[n$c]:1===n$d?0:51*(((3*n$c+n$d/6)%3<<0)+3*(n$c/6<<0))<<16|n$d%6*51<<8|(n$c<<0)%6*51;var n$f=n$E.toColor(n$e);this._colors.push(n$f);var n$g=n$d*this._gridSize,n$h=n$c*this._gridSize;n$a.drawRect(n$g,n$h,this._gridSize,this._gridSize,n$f,"#000000")}},n$c.onColorButtonClick=function(n$a){this._colorPanel.parent?this.close():this.open()},n$c.open=function(){var n$a=this.localToGlobal(new n$o),n$b=n$a.x+this._colorPanel.width<=n$p.stage.width?n$a.x:n$p.stage.width-this._colorPanel.width,n$c=n$a.y+this._colorButton.height;n$c=n$c+this._colorPanel.height<=n$p.stage.height?n$c:n$a.y-this._colorPanel.height,this._colorPanel.pos(n$b,n$c),this._colorPanel.zOrder=1001,n$p._currentStage.addChild(this._colorPanel),n$p.stage.on("mousedown",this,this.removeColorBox)},n$c.close=function(){n$p.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},n$c.removeColorBox=function(n$a){this.close()},n$c.onColorFieldKeyDown=function(n$a){13==n$a.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),n$a.stopPropagation())},n$c.onColorInputChange=function(n$a){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},n$c.onColorTilesClick=function(n$a){this.selectedColor=this.getColorByMouse(),this.close()},n$c.onColorTilesMouseMove=function(n$a){this._colorInput.focus=!1;var n$b=this.getColorByMouse();this._colorInput.text=n$b,this.drawBlock(n$b)},n$c.getColorByMouse=function(){var n$a=this._colorTiles.getMousePoint(),n$b=Math.floor(n$a.x/this._gridSize),n$c=Math.floor(n$a.y/this._gridSize);return this._colors[20*n$c+n$b]},n$c.drawBlock=function(n$a){var n$b=this._colorBlock.graphics;n$b.clear();var n$c=n$a||"#ffffff";n$b.drawRect(0,0,50,20,n$c,this._borderColor),n$a||n$b.drawLine(0,0,50,20,"#ff0000")},n$c.changeColor=function(){var n$a=this.graphics;n$a.clear();var n$b=this._selectedColor||"#000000";n$a.drawRect(0,0,this._colorButton.width,this._colorButton.height,n$b)},n$c._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},n$e(0,n$c,"inputBgColor",function(){return this._inputBgColor},function(n$a){this._inputBgColor=n$a,this._setPanelChanged()}),n$e(0,n$c,"selectedColor",function(){return this._selectedColor},function(n$a){this._selectedColor!=n$a&&(this._selectedColor=this._colorInput.text=n$a,this.drawBlock(n$a),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",n$i.EMPTY.setTo("change",this,this)))}),n$e(0,n$c,"skin",function(){return this._colorButton.skin},function(n$a){this._colorButton.skin=n$a,this.changeColor()}),n$e(0,n$c,"bgColor",function(){return this._bgColor},function(n$a){this._bgColor=n$a,this._setPanelChanged()}),n$e(0,n$c,"borderColor",function(){return this._borderColor},function(n$a){this._borderColor=n$a,this._setPanelChanged()}),n$e(0,n$c,"inputColor",function(){return this._inputColor},function(n$a){this._inputColor=n$a,this._setPanelChanged()}),n$a}(n$H),n$N=function(n$b){function n$c(n$a,n$b){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,n$c.__super.call(this),this._itemColors=n$D.comboBoxItemColors,this.skin=n$a,this.labels=n$b}n$f(n$c,"laya.ui.ComboBox",n$b);var n$a=n$c.prototype;return n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,n$a),this._button&&this._button.destroy(n$a),this._list&&this._list.destroy(n$a),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},n$a.createChildren=function(){this.addChild(this._button=new n$K),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},n$a._createList=function(){this._list=new n$X,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},n$a._setListEvent=function(n$a){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=n$m.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},n$a.onListDown=function(n$a){n$a.stopPropagation()},n$a.onScrollBarDown=function(n$a){n$a.stopPropagation()},n$a.onButtonMouseDown=function(n$a){this.callLater(this.switchTo,[!this._isOpen])},n$a.changeList=function(){this._listChanged=!1;var n$a=this.width-2,n$b=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:n$a,height:this._itemHeight,fontSize:this._itemSize,color:n$b}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},n$a.onlistItemMouse=function(n$a,n$b){var n$c=n$a.type;if("mouseover"===n$c||"mouseout"===n$c){if(this._isCustomList)return;var n$d=this._list.getCell(n$b);if(!n$d)return;var n$e=n$d.getChildByName("label");n$e&&("mouseover"===n$c?(n$e.bgColor=this._itemColors[0],n$e.color=this._itemColors[1]):(n$e.bgColor=null,n$e.color=this._itemColors[2]))}else"click"===n$c&&(this.selectedIndex=n$b,this.isOpen=!1)},n$a.switchTo=function(n$a){this.isOpen=n$a},n$a.changeOpen=function(){this.isOpen=!this._isOpen},n$a.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var n$a=this._list.graphics;n$a.clear(),n$a.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var n$b=this._list.array||[],n$c=n$b.length=0,n$d=this._labels.length;n$c<n$d;n$c++)n$b.push({label:this._labels[n$c]});this._list.height=this._listHeight,this._list.array=n$b},n$a.changeSelected=function(){this._button.label=this.selectedLabel},n$a._onStageMouseWheel=function(n$a){this._list&&!this._list.contains(n$a.target)&&this.removeList(null)},n$a.removeList=function(n$a){n$p.stage.off("mousedown",this,this.removeList),n$p.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},n$e(0,n$a,"selectedIndex",function(){return this._selectedIndex},function(n$a){this._selectedIndex!=n$a&&(this._selectedIndex=n$a,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[n$i.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),n$e(0,n$a,"measureHeight",function(){return this._button.height}),n$e(0,n$a,"skin",function(){return this._button.skin},function(n$a){this._button.skin!=n$a&&(this._button.skin=n$a,this._listChanged=!0)}),n$e(0,n$a,"measureWidth",function(){return this._button.width}),n$e(0,n$a,"width",n$b.prototype._$get_width,function(n$a){n$p.superSet(n$H,this,"width",n$a),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),n$e(0,n$a,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(n$a){this.selectedIndex=this._labels.indexOf(n$a)}),n$e(0,n$a,"labels",function(){return this._labels.join(",")},function(n$a){0<this._labels.length&&(this.selectedIndex=-1),n$a?this._labels=n$a.split(","):this._labels.length=0,this._itemChanged=!0}),n$e(0,n$a,"height",n$b.prototype._$get_height,function(n$a){n$p.superSet(n$H,this,"height",n$a),this._button.height=this._height}),n$e(0,n$a,"selectHandler",function(){return this._selectHandler},function(n$a){this._selectHandler=n$a}),n$e(0,n$a,"visibleNum",function(){return this._visibleNum},function(n$a){this._visibleNum=n$a,this._listChanged=!0}),n$e(0,n$a,"labelBold",function(){return this._button.text.bold},function(n$a){this._button.text.bold=n$a}),n$e(0,n$a,"itemColors",function(){return String(this._itemColors)},function(n$a){this._itemColors=n$E.fillArray(this._itemColors,n$a,String),this._listChanged=!0}),n$e(0,n$a,"itemSize",function(){return this._itemSize},function(n$a){this._itemSize=n$a,this._listChanged=!0}),n$e(0,n$a,"scrollBar",function(){return this.list.scrollBar}),n$e(0,n$a,"isOpen",function(){return this._isOpen},function(n$a){if(this._isOpen!=n$a)if(this._isOpen=n$a,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var n$b=this.localToGlobal(n$o.TEMP.setTo(0,0)),n$c=n$b.y+this._button.height;n$c=n$c+this._listHeight<=n$p.stage.height?n$c:n$b.y-this._listHeight,this._list.pos(n$b.x,n$c),this._list.zOrder=1001,n$p._currentStage.addChild(this._list),n$p.stage.once("mousedown",this,this.removeList),n$p.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),n$e(0,n$a,"scrollBarSkin",function(){return this._scrollBarSkin},function(n$a){this._scrollBarSkin=n$a}),n$e(0,n$a,"sizeGrid",function(){return this._button.sizeGrid},function(n$a){this._button.sizeGrid=n$a}),n$e(0,n$a,"button",function(){return this._button}),n$e(0,n$a,"list",function(){return this._list||this._createList(),this._list},function(n$a){n$a&&(n$a.removeSelf(),this._isCustomList=!0,this._list=n$a,this._setListEvent(n$a),this._itemHeight=n$a.getCell(0).height+n$a.spaceY)}),n$e(0,n$a,"dataSource",n$b.prototype._$get_dataSource,function(n$a){"number"==typeof(this._dataSource=n$a)&&Math.floor(n$a)==n$a||"string"==typeof n$a?this.selectedIndex=parseInt(n$a):n$a instanceof Array?this.labels=n$a.join(","):n$p.superSet(n$H,this,"dataSource",n$a)}),n$e(0,n$a,"labelColors",function(){return this._button.labelColors},function(n$a){this._button.labelColors!=n$a&&(this._button.labelColors=n$a)}),n$e(0,n$a,"labelPadding",function(){return this._button.text.padding.join(",")},function(n$a){this._button.text.padding=n$E.fillArray(n$D.labelPadding,n$a,Number)}),n$e(0,n$a,"labelSize",function(){return this._button.text.fontSize},function(n$a){this._button.text.fontSize=n$a}),n$e(0,n$a,"labelFont",function(){return this._button.text.font},function(n$a){this._button.text.font=n$a}),n$e(0,n$a,"stateNum",function(){return this._button.stateNum},function(n$a){this._button.stateNum=n$a}),n$c}(n$H),n$O=function(n$b){function n$c(n$a){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,n$c.__super.call(this),this._showButtons=n$F.showButtons,this._touchScrollEnable=n$F.touchScrollEnable,this._mouseWheelEnable=n$F.mouseWheelEnable,this.skin=n$a,this.max=1}n$f(n$c,"laya.ui.ScrollBar",n$b);var n$a=n$c.prototype;return n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),this.stopScroll(),this.target=null,n$b.prototype.destroy.call(this,n$a),this.upButton&&this.upButton.destroy(n$a),this.downButton&&this.downButton.destroy(n$a),this.slider&&this.slider.destroy(n$a),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},n$a.createChildren=function(){this.addChild(this.slider=new n$P),this.addChild(this.upButton=new n$K),this.addChild(this.downButton=new n$K)},n$a.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},n$a.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},n$a.onButtonMouseDown=function(n$a){var n$b=n$a.currentTarget===this.upButton;this.slide(n$b),n$p.timer.once(n$D.scrollBarDelayTime,this,this.startLoop,[n$b]),n$p.stage.once("mouseup",this,this.onStageMouseUp)},n$a.startLoop=function(n$a){n$p.timer.frameLoop(1,this,this.slide,[n$a])},n$a.slide=function(n$a){n$a?this.value-=this._scrollSize:this.value+=this._scrollSize},n$a.onStageMouseUp=function(n$a){n$p.timer.clear(this,this.startLoop),n$p.timer.clear(this,this.slide)},n$a.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},n$a.changeSize=function(){n$b.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},n$a.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},n$a.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},n$a.setScroll=function(n$a,n$b,n$c){this.runCallLater(this.changeSize),this.slider.setSlider(n$a,n$b,n$c),this.slider.bar.visible=0<n$b,!this._hide&&this.autoHide&&(this.visible=!1)},n$a.onTargetMouseWheel=function(n$a){this.value-=n$a.delta*this._scrollSize,this.target=this._target},n$a.onTargetMouseDown=function(n$a){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new n$o),this._lastPoint.setTo(n$p.stage.mouseX,n$p.stage.mouseY),n$p.timer.clear(this,this.tweenMove),n$x.clearTween(this),n$p.stage.once("mouseup",this,this.onStageMouseUp2),n$p.stage.once("mouseout",this,this.onStageMouseUp2),n$p.timer.frameLoop(1,this,this.loop)},n$a.loop=function(){var n$a=n$p.stage.mouseY,n$b=n$p.stage.mouseX;if(this._lastOffset=this.isVertical?n$a-this._lastPoint.y:n$b-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?n$p.stage._canvasTransform.getScaleY():n$p.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=n$b,this._lastPoint.y=n$a,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},n$a.onStageMouseUp2=function(n$a){if(n$p.stage.off("mouseup",this,this.onStageMouseUp2),n$p.stage.off("mouseout",this,this.onStageMouseUp2),n$p.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?n$x.to(this,{value:this.min},this.elasticBackTime,n$h.sineOut,n$m.create(this,this.elasticOver)):this._value>this.max&&n$x.to(this,{value:this.max},this.elasticBackTime,n$h.sineOut,n$m.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?n$p.stage.mouseY-this._lastPoint.y:n$p.stage.mouseX-this._lastPoint.x);for(var n$b=0,n$c=Math.min(this._offsets.length,3),n$d=0;n$d<n$c;n$d++)n$b+=this._offsets[this._offsets.length-1-n$d];if(this._lastOffset=n$b/n$c,(n$b=Math.abs(this._lastOffset))<2)return void this.event("end");60<n$b&&(this._lastOffset=0<this._lastOffset?60:-60);var n$e=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));n$p.timer.frameLoop(1,this,this.tweenMove,[n$e])}},n$a.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&n$x.to(this,{alpha:0},500),this.event("end")},n$a.tweenMove=function(n$a){this._lastOffset*=this.rollRatio;var n$b=NaN;if(0<n$a&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,n$b=.5*-(this.min-n$a-this.value),this._lastOffset>n$b&&(this._lastOffset=n$b)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,n$b=.5*-(this.max+n$a-this.value),this._lastOffset<n$b&&(this._lastOffset=n$b))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(n$p.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?n$x.to(this,{value:this.min},this.elasticBackTime,n$h.sineOut,n$m.create(this,this.elasticOver)):this._value>this.max?n$x.to(this,{value:this.max},this.elasticBackTime,n$h.sineOut,n$m.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&n$x.to(this,{alpha:0},500)}},n$a.stopScroll=function(){this.onStageMouseUp2(null),n$p.timer.clear(this,this.tweenMove),n$x.clearTween(this)},n$e(0,n$a,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),n$e(0,n$a,"skin",function(){return this._skin},function(n$a){this._skin!=n$a&&(this._skin=n$a,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),n$e(0,n$a,"max",function(){return this.slider.max},function(n$a){this.slider.max=n$a}),n$e(0,n$a,"showButtons",function(){return this._showButtons},function(n$a){this._showButtons=n$a,this.callLater(this.changeScrollBar)}),n$e(0,n$a,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),n$e(0,n$a,"min",function(){return this.slider.min},function(n$a){this.slider.min=n$a}),n$e(0,n$a,"value",function(){return this._value},function(n$a){n$a!==this._value&&(this._value=n$a,this._isElastic||(this.slider._value!=n$a&&(this.slider._value=n$a,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),n$e(0,n$a,"isVertical",function(){return this.slider.isVertical},function(n$a){this.slider.isVertical=n$a}),n$e(0,n$a,"sizeGrid",function(){return this.slider.sizeGrid},function(n$a){this.slider.sizeGrid=n$a}),n$e(0,n$a,"scrollSize",function(){return this._scrollSize},function(n$a){this._scrollSize=n$a}),n$e(0,n$a,"dataSource",n$b.prototype._$get_dataSource,function(n$a){"number"==typeof(this._dataSource=n$a)||"string"==typeof n$a?this.value=Number(n$a):n$p.superSet(n$H,this,"dataSource",n$a)}),n$e(0,n$a,"thumbPercent",function(){return this._thumbPercent},function(n$a){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),n$a=1<=n$a?.99:n$a,this._thumbPercent=n$a,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*n$a,n$D.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*n$a,n$D.scrollBarMinNum))}),n$e(0,n$a,"target",function(){return this._target},function(n$a){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=n$a)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),n$e(0,n$a,"hide",function(){return this._hide},function(n$a){this._hide=n$a,this.visible=!n$a}),n$e(0,n$a,"touchScrollEnable",function(){return this._touchScrollEnable},function(n$a){this._touchScrollEnable=n$a,this.target=this._target}),n$e(0,n$a,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(n$a){this._mouseWheelEnable=n$a,this.target=this._target}),n$e(0,n$a,"tick",function(){return this.slider.tick},function(n$a){this.slider.tick=n$a}),n$c}(n$H),n$P=function(n$b){function n$c(n$a){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,n$c.__super.call(this),this.skin=n$a}n$f(n$c,"laya.ui.Slider",n$b);var n$a=n$c.prototype;return n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,n$a),this._bg&&this._bg.destroy(n$a),this._bar&&this._bar.destroy(n$a),this._progress&&this._progress.destroy(n$a),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},n$a.createChildren=function(){this.addChild(this._bg=new n$Q),this.addChild(this._bar=new n$K)},n$a.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},n$a.onBarMouseDown=function(n$a){this._globalSacle||(this._globalSacle=new n$o),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=n$p.stage.mouseX,this._ty=n$p.stage.mouseY,n$p.stage.on("mousemove",this,this.mouseMove),n$p.stage.once("mouseup",this,this.mouseUp),n$p.stage.once("mouseout",this,this.mouseUp),this.showValueText()},n$a.showValueText=function(){if(this.showLabel){var n$a=laya.ui.Slider.label;this.addChild(n$a),n$a.textField.changeText(this._value+""),this.isVertical?(n$a.x=this._bar.x+20,n$a.y=.5*(this._bar.height-n$a.height)+this._bar.y):(n$a.y=this._bar.y-20,n$a.x=.5*(this._bar.width-n$a.width)+this._bar.x)}},n$a.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},n$a.mouseUp=function(n$a){n$p.stage.off("mousemove",this,this.mouseMove),n$p.stage.off("mouseup",this,this.mouseUp),n$p.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},n$a.mouseMove=function(n$a){var n$b=this._value;this.isVertical?(this._bar.y+=(n$p.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(n$p.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=n$p.stage.mouseX,this._ty=n$p.stage.mouseY;var n$c=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*n$c)/n$c,this._value!=n$b&&this.sendChangeEvent(),this.showValueText()},n$a.sendChangeEvent=function(n$a){void 0===n$a&&(n$a="change"),this.event(n$a),this.changeHandler&&this.changeHandler.runWith(this._value)},n$a.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},n$a.changeSize=function(){n$b.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},n$a.setSlider=function(n$a,n$b,n$c){this._value=-1,this._min=n$a,this._max=n$a<n$b?n$b:n$a,this.value=n$c<n$a?n$a:n$b<n$c?n$b:n$c},n$a.changeValue=function(){var n$a=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*n$a)/n$a,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var n$b=this._max-this._min;0===n$b&&(n$b=1),this.isVertical?(this._bar.y=(this._value-this._min)/n$b*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/n$b*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},n$a.onBgMouseDown=function(n$a){var n$b=this._bg.getMousePoint();this.isVertical?this.value=n$b.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=n$b.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},n$e(0,n$a,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),n$e(0,n$a,"skin",function(){return this._skin},function(n$a){if(this._skin!=n$a){this._skin=n$a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var n$b=this._skin.replace(".png","$progress.png");n$s.getRes(n$b)&&(this._progress||(this.addChild(this._progress=new n$Q),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=n$b),this.setBarPoint(),this.callLater(this.changeValue)}}),n$e(0,n$a,"allowClickBack",function(){return this._allowClickBack},function(n$a){this._allowClickBack!=n$a&&((this._allowClickBack=n$a)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),n$e(0,n$a,"max",function(){return this._max},function(n$a){this._max!=n$a&&(this._max=n$a,this.callLater(this.changeValue))}),n$e(0,n$a,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),n$e(0,n$a,"tick",function(){return this._tick},function(n$a){this._tick!=n$a&&(this._tick=n$a,this.callLater(this.changeValue))}),n$e(0,n$a,"sizeGrid",function(){return this._bg.sizeGrid},function(n$a){this._bg.sizeGrid=n$a,this._bar.sizeGrid=n$a,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),n$e(0,n$a,"min",function(){return this._min},function(n$a){this._min!=n$a&&(this._min=n$a,this.callLater(this.changeValue))}),n$e(0,n$a,"value",function(){return this._value},function(n$a){if(this._value!=n$a){var n$b=this._value;this._value=n$a,this.changeValue(),this._value!=n$b&&this.sendChangeEvent()}}),n$e(0,n$a,"dataSource",n$b.prototype._$get_dataSource,function(n$a){"number"==typeof(this._dataSource=n$a)||"string"==typeof n$a?this.value=Number(n$a):n$p.superSet(n$H,this,"dataSource",n$a)}),n$e(0,n$a,"bar",function(){return this._bar}),n$d(n$c,["label",function(){return this.label=new n$R}]),n$c}(n$H),n$Q=function(n$b){function n$c(n$a){this._bitmap=null,this._skin=null,this._group=null,n$c.__super.call(this),this.skin=n$a}n$f(n$c,"laya.ui.Image",n$b);var n$a=n$c.prototype;return n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,n$s.clearCache(this,this._skin)},n$a.dispose=function(){this.destroy(!0),n$s.clearCache(this,this._skin)},n$a.createChildren=function(){this.graphics=this._bitmap=new n$G},n$a.setSource=function(n$a,n$b){n$a===this._skin&&n$b&&(this.source=n$b,this.onCompResize())},n$e(0,n$a,"source",function(){return this._bitmap.source},function(n$a){this._bitmap&&(this._bitmap.source=n$a,this.event("loaded"),this.repaint())}),n$e(0,n$a,"dataSource",n$b.prototype._$get_dataSource,function(n$a){"string"==typeof(this._dataSource=n$a)?this.skin=n$a:n$p.superSet(n$H,this,"dataSource",n$a)}),n$e(0,n$a,"measureHeight",function(){return this._bitmap.height}),n$e(0,n$a,"skin",function(){return this._skin},function(n$a){if(this._skin!=n$a)if(n$s.clearCache(this,this._skin),this._skin=n$a){n$s.keepCache(this,this._skin);var n$b=n$s.getRes(n$a);n$b?(this.source=n$b,this.onCompResize()):n$p.loader.load(this._skin,n$m.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),n$e(0,n$a,"group",function(){return this._group},function(n$a){n$a&&this._skin&&n$s.setGroup(this._skin,n$a),this._group=n$a}),n$e(0,n$a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(n$a){this._bitmap.sizeGrid=n$E.fillArray(n$D.defaultSizeGrid,n$a,Number)}),n$e(0,n$a,"measureWidth",function(){return this._bitmap.width}),n$e(0,n$a,"width",n$b.prototype._$get_width,function(n$a){n$p.superSet(n$H,this,"width",n$a),this._bitmap.width=0==n$a?1e-7:n$a}),n$e(0,n$a,"height",n$b.prototype._$get_height,function(n$a){n$p.superSet(n$H,this,"height",n$a),this._bitmap.height=0==n$a?1e-7:n$a}),n$c}(n$H),n$R=function(n$b){function n$c(n$a){this._tf=null,n$c.__super.call(this),void 0===n$a&&(n$a=""),n$j.defaultColor=n$D.labelColor,this.text=n$a}n$f(n$c,"laya.ui.Label",n$b);var n$a=n$c.prototype;return n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,n$a),this._tf=null},n$a.createChildren=function(){this.addChild(this._tf=new n$v)},n$a.changeText=function(n$a){this._tf.changeText(n$a)},n$e(0,n$a,"padding",function(){return this._tf.padding.join(",")},function(n$a){this._tf.padding=n$E.fillArray(n$D.labelPadding,n$a,Number)}),n$e(0,n$a,"bold",function(){return this._tf.bold},function(n$a){this._tf.bold=n$a}),n$e(0,n$a,"align",function(){return this._tf.align},function(n$a){this._tf.align=n$a}),n$e(0,n$a,"text",function(){return this._tf.text},function(n$a){this._tf.text!=n$a&&(n$a&&(n$a=n$E.adptString(n$a+"")),this._tf.text=n$a,this.event("change"),this._width&&this._height||this.onCompResize())}),n$e(0,n$a,"italic",function(){return this._tf.italic},function(n$a){this._tf.italic=n$a}),n$e(0,n$a,"wordWrap",function(){return this._tf.wordWrap},function(n$a){this._tf.wordWrap=n$a}),n$e(0,n$a,"font",function(){return this._tf.font},function(n$a){this._tf.font=n$a}),n$e(0,n$a,"dataSource",n$b.prototype._$get_dataSource,function(n$a){"number"==typeof(this._dataSource=n$a)||"string"==typeof n$a?this.text=n$a+"":n$p.superSet(n$H,this,"dataSource",n$a)}),n$e(0,n$a,"color",function(){return this._tf.color},function(n$a){this._tf.color=n$a}),n$e(0,n$a,"valign",function(){return this._tf.valign},function(n$a){this._tf.valign=n$a}),n$e(0,n$a,"leading",function(){return this._tf.leading},function(n$a){this._tf.leading=n$a}),n$e(0,n$a,"fontSize",function(){return this._tf.fontSize},function(n$a){this._tf.fontSize=n$a}),n$e(0,n$a,"bgColor",function(){return this._tf.bgColor},function(n$a){this._tf.bgColor=n$a}),n$e(0,n$a,"borderColor",function(){return this._tf.borderColor},function(n$a){this._tf.borderColor=n$a}),n$e(0,n$a,"stroke",function(){return this._tf.stroke},function(n$a){this._tf.stroke=n$a}),n$e(0,n$a,"strokeColor",function(){return this._tf.strokeColor},function(n$a){this._tf.strokeColor=n$a}),n$e(0,n$a,"textField",function(){return this._tf}),n$e(0,n$a,"measureWidth",function(){return this._tf.width}),n$e(0,n$a,"measureHeight",function(){return this._tf.height}),n$e(0,n$a,"width",function(){return this._width||this._tf.text?n$p.superGet(n$H,this,"width"):0},function(n$a){n$p.superSet(n$H,this,"width",n$a),this._tf.width=n$a}),n$e(0,n$a,"height",function(){return this._height||this._tf.text?n$p.superGet(n$H,this,"height"):0},function(n$a){n$p.superSet(n$H,this,"height",n$a),this._tf.height=n$a}),n$e(0,n$a,"overflow",function(){return this._tf.overflow},function(n$a){this._tf.overflow=n$a}),n$e(0,n$a,"underline",function(){return this._tf.underline},function(n$a){this._tf.underline=n$a}),n$e(0,n$a,"underlineColor",function(){return this._tf.underlineColor},function(n$a){this._tf.underlineColor=n$a}),n$c}(n$H),n$S=function(n$b){function n$c(n$a){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,n$c.__super.call(this),this.skin=n$a}n$f(n$c,"laya.ui.ProgressBar",n$b);var n$a=n$c.prototype;return n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,n$a),this._bg&&this._bg.destroy(n$a),this._bar&&this._bar.destroy(n$a),this._bg=this._bar=null,this.changeHandler=null},n$a.createChildren=function(){this.addChild(this._bg=new n$Q),this.addChild(this._bar=new n$Q)},n$a.changeValue=function(){if(this.sizeGrid){var n$a=this.sizeGrid.split(","),n$b=Number(n$a[3]),n$c=Number(n$a[1]),n$d=(this.width-n$b-n$c)*this._value;this._bar.width=n$b+n$c+n$d,this._bar.visible=this._bar.width>n$b+n$c}else this._bar.width=this.width*this._value},n$e(0,n$a,"measureHeight",function(){return this._bg.height}),n$e(0,n$a,"skin",function(){return this._skin},function(n$a){this._skin!=n$a&&(this._skin=n$a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),n$e(0,n$a,"measureWidth",function(){return this._bg.width}),n$e(0,n$a,"height",n$b.prototype._$get_height,function(n$a){n$p.superSet(n$H,this,"height",n$a),this._bg.height=this._height,this._bar.height=this._height}),n$e(0,n$a,"bar",function(){return this._bar}),n$e(0,n$a,"value",function(){return this._value},function(n$a){this._value!=n$a&&(n$a=1<n$a?1:n$a<0?0:n$a,this._value=n$a,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(n$a))}),n$e(0,n$a,"bg",function(){return this._bg}),n$e(0,n$a,"sizeGrid",function(){return this._bg.sizeGrid},function(n$a){this._bg.sizeGrid=this._bar.sizeGrid=n$a}),n$e(0,n$a,"width",n$b.prototype._$get_width,function(n$a){n$p.superSet(n$H,this,"width",n$a),this._bg.width=this._width,this.callLater(this.changeValue)}),n$e(0,n$a,"dataSource",n$b.prototype._$get_dataSource,function(n$a){"number"==typeof(this._dataSource=n$a)||"string"==typeof n$a?this.value=Number(n$a):n$p.superSet(n$H,this,"dataSource",n$a)}),n$c}(n$H),n$T=(function(n$a){function n$c(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,n$c.__super.call(this),this._tipBox=new n$H,this._tipBox.addChild(this._tipText=new n$v),this._tipText.x=this._tipText.y=5,this._tipText.color=n$c.tipTextColor,this._defaultTipHandler=this._showDefaultTip,n$p.stage.on("showtip",this,this._onStageShowTip),n$p.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}n$f(n$c,"laya.ui.TipManager",n$H);var n$b=n$c.prototype;n$b._onStageHideTip=function(n$a){n$p.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},n$b._onStageShowTip=function(n$a){n$p.timer.once(n$c.tipDelay,this,this._showTip,[n$a],!0)},n$b._showTip=function(n$a){if("string"==typeof n$a){var n$b=String(n$a);Boolean(n$b)&&this._defaultTipHandler(n$b)}else n$a instanceof laya.utils.Handler?n$a.run():"function"==typeof n$a&&n$a.apply();n$p.stage.on("mousemove",this,this._onStageMouseMove),n$p.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},n$b._onStageMouseDown=function(n$a){this.closeAll()},n$b._onStageMouseMove=function(n$a){this._showToStage(this,n$c.offsetX,n$c.offsetY)},n$b._showToStage=function(n$a,n$b,n$c){void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0);var n$d=n$a.getBounds();n$a.x=n$p.stage.mouseX+n$b,n$a.y=n$p.stage.mouseY+n$c,n$a.x+n$d.width>n$p.stage.width&&(n$a.x-=n$d.width+n$b),n$a.y+n$d.height>n$p.stage.height&&(n$a.y-=n$d.height+n$c)},n$b.closeAll=function(){n$p.timer.clear(this,this._showTip),n$p.stage.off("mousemove",this,this._onStageMouseMove),n$p.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},n$b.showDislayTip=function(n$a){this.addChild(n$a),this._showToStage(this),n$p._currentStage.addChild(this)},n$b._showDefaultTip=function(n$a){this._tipText.text=n$a;var n$b=this._tipBox.graphics;n$b.clear(),n$b.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,n$c.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),n$p._currentStage.addChild(this)},n$e(0,n$b,"defaultTipHandler",function(){return this._defaultTipHandler},function(n$a){this._defaultTipHandler=n$a}),n$c.offsetX=10,n$c.offsetY=15,n$c.tipTextColor="#ffffff",n$c.tipBackColor="#111111",n$c.tipDelay=200}(),function(n$a){var n$n;function n$o(){this._idMap=null,this._aniList=null,this._watchMap={},n$o.__super.call(this)}n$f(n$o,"laya.ui.View",n$J);var n$b=n$o.prototype;return n$b.createView=function(n$a){if(n$a.animations&&!this._idMap&&(this._idMap={}),n$o.createComp(n$a,this,this),n$a.animations){var n$b,n$c,n$d=[],n$e=n$a.animations,n$f=0,n$g=n$e.length;for(n$f=0;n$f<n$g;n$f++){switch(n$b=new n$k,n$c=n$e[n$f],n$b._setUp(this._idMap,n$c),(this[n$c.name]=n$b)._setControlNode(this),n$c.action){case 1:n$b.play(0,!1);break;case 2:n$b.play(0,!0)}n$d.push(n$b)}this._aniList=n$d}0<this._width&&null==n$a.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},n$b.onEvent=function(n$a,n$b){},n$b.loadUI=function(n$a){var n$b=n$o.uiMap[n$a];n$b&&this.createView(n$b)},n$b.destroy=function(n$a){void 0===n$a&&(n$a=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,n$a)},n$b.changeData=function(n$a){var n$b=this._watchMap[n$a];if(n$b){console.log("change",n$a);for(var n$c=0,n$d=n$b.length;n$c<n$d;n$c++){n$b[n$c].exe(this)}}},n$o._regs=function(){for(var n$a in n$o.uiClassMap)n$q.regClass(n$a,n$o.uiClassMap[n$a])},n$o.createComp=function(n$a,n$b,n$c,n$d){if(!(n$b=n$b||n$o.getCompInstance(n$a)))return console.warn("can not create:"+n$a.type),null;var n$e=n$a.child;if(n$e)for(var n$f=n$b instanceof laya.ui.List,n$g=0,n$h=n$e.length;n$g<n$h;n$g++){var n$i=n$e[n$g];if(!n$b.hasOwnProperty("itemRender")||"render"!=n$i.props.name&&"render"!==n$i.props.renderType)if("Graphic"==n$i.type)n$q.addGraphicsToSprite(n$i,n$b);else if(n$q.isDrawType(n$i.type))n$q.addGraphicToSprite(n$i,n$b,!0);else{if(n$f){var n$j=[],n$k=n$o.createComp(n$i,null,n$c,n$j);n$j.length&&(n$k._$bindData=n$j)}else n$k=n$o.createComp(n$i,null,n$c,n$d);"Script"==n$i.type?"owner"in n$k?n$k.owner=n$b:"target"in n$k&&(n$k.target=n$b):"mask"==n$i.props.renderType||"mask"==n$i.props.name?n$b.mask=n$k:n$k instanceof laya.display.Sprite&&n$b.addChild(n$k)}else n$b.itemRender=n$i}var n$l=n$a.props;for(var n$m in n$l){var n$n=n$l[n$m];n$o.eventDic[n$m]?n$n&&n$c&&n$b.on(n$m,n$c,n$c.onEvent,[n$n]):n$o.setCompValue(n$b,n$m,n$n,n$c,n$d)}return n$p.__typeof(n$b,"laya.ui.IItem")&&n$b.initItems(),n$a.compId&&n$c&&n$c._idMap&&(n$c._idMap[n$a.compId]=n$b),n$b},n$o.setCompValue=function(n$a,n$b,n$c,n$d,n$e){if("string"==typeof n$c&&-1<n$c.indexOf("${")){if(n$o._sheet||(n$o._sheet=n$q.getClass("laya.data.Table")),!n$o._sheet)return void console.warn("Can not find class Sheet");if(n$e)n$e.push(n$a,n$b,n$c);else if(n$d){-1==n$c.indexOf("].")&&(n$c=n$c.replace(".","[0]."));var n$f,n$g,n$h=new n$n(n$a,n$b,n$c);n$h.exe(n$d);for(var n$i=n$c.replace(/\[.*?\]\./g,".");null!=(n$f=n$o._parseWatchData.exec(n$i));){for(var n$j=n$f[1];null!=(n$g=n$o._parseKeyWord.exec(n$j));){var n$k=n$g[0],n$l=n$d._watchMap[n$k]||(n$d._watchMap[n$k]=[]);n$l.push(n$h),n$o._sheet.I.notifer.on(n$k,n$d,n$d.changeData,[n$k])}(n$l=n$d._watchMap[n$j]||(n$d._watchMap[n$j]=[])).push(n$h),n$o._sheet.I.notifer.on(n$j,n$d,n$d.changeData,[n$j])}}}else if("var"===n$b&&n$d)n$d[n$c]=n$a;else if("onClick"==n$b){var n$m=n$p._runScript("(function(){"+n$c+"})");n$a.on("click",n$d,n$m)}else n$a[n$b]="true"===n$c||"false"!==n$c&&n$c},n$o.getCompInstance=function(n$a){var n$b,n$c=n$a.props?n$a.props.runtime:null;return n$b=n$c?n$o.viewClassMap[n$c]||n$o.uiClassMap[n$c]||n$p.__classmap[n$c]:n$o.uiClassMap[n$a.type],n$a.props&&n$a.props.hasOwnProperty("renderType")&&"instance"==n$a.props.renderType?n$b.instance:n$b?new n$b:null},n$o.regComponent=function(n$a,n$b){n$o.uiClassMap[n$a]=n$b,n$q.regClass(n$a,n$b)},n$o.regViewRuntime=function(n$a,n$b){n$o.viewClassMap[n$a]=n$b},n$o.uiMap={},n$o.viewClassMap={},n$o._sheet=null,n$d(n$o,["uiClassMap",function(){return this.uiClassMap={ViewStack:n$aa,LinkButton:n$K,TextArea:n$ja,ColorPicker:n$M,Box:n$J,Button:n$K,CheckBox:n$U,Clip:n$L,ComboBox:n$N,Component:n$H,HScrollBar:n$Y,HSlider:n$$,Image:n$Q,Label:n$R,List:n$X,Panel:n$Z,ProgressBar:n$S,Radio:n$A,RadioGroup:n$ha,ScrollBar:n$O,Slider:n$P,Tab:n$ia,TextInput:n$ca,View:n$o,VScrollBar:n$ba,VSlider:n$da,Tree:n$B,HBox:n$fa,VBox:n$ga,Sprite:n$u,Animation:n$c,Text:n$v,FontClip:n$W}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),n$o.__init$=function(){n$o._regs(),n$n=function(){function n$a(n$a,n$b,n$c){this.comp=null,this.prop=null,this.value=null,this.comp=n$a,this.prop=n$b,this.value=n$c}return n$f(n$a,""),n$a.prototype.exe=function(n$a){var n$b=n$E.getBindFun(this.value);this.comp[this.prop]=n$b.call(this,n$a)},n$a}()},n$o}()),n$U=function(n$a){function n$c(n$a,n$b){void 0===n$b&&(n$b=""),n$c.__super.call(this,n$a,n$b)}n$f(n$c,"laya.ui.CheckBox",n$a);var n$b=n$c.prototype;return n$b.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},n$b.initialize=function(){n$a.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},n$e(0,n$b,"dataSource",n$a.prototype._$get_dataSource,function(n$a){"boolean"==typeof(this._dataSource=n$a)?this.selected=n$a:"string"==typeof n$a?this.selected="true"===n$a:n$p.superSet(n$K,this,"dataSource",n$a)}),n$c}(n$K),n$V=function(n$a){function n$b(){this._space=0,this._align="none",this._itemChanged=!1,n$b.__super.call(this)}n$f(n$b,"laya.ui.LayoutBox",n$J);var n$c=n$b.prototype;return n$c.addChild=function(n$a){return n$a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,n$a)},n$c.onResize=function(n$a){this._setItemChanged()},n$c.addChildAt=function(n$a,n$b){return n$a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,n$a,n$b)},n$c.removeChild=function(n$a){return n$a.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,n$a)},n$c.removeChildAt=function(n$a){return this.getChildAt(n$a).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,n$a)},n$c.refresh=function(){this._setItemChanged()},n$c.changeItems=function(){this._itemChanged=!1},n$c.sortItem=function(n$a){n$a&&n$a.sort(function(n$a,n$b){return n$a.y-n$b.y})},n$c._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},n$e(0,n$c,"space",function(){return this._space},function(n$a){this._space=n$a,this._setItemChanged()}),n$e(0,n$c,"align",function(){return this._align},function(n$a){this._align=n$a,this._setItemChanged()}),n$b}(),n$W=function(n$b){function n$c(n$a,n$b){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,n$c.__super.call(this),n$a&&(this.skin=n$a),n$b&&(this.sheet=n$b)}n$f(n$c,"laya.ui.FontClip",n$b);var n$a=n$c.prototype;return n$a.createChildren=function(){this._bitmap=new n$G,this.on("loaded",this,this._onClipLoaded)},n$a._onClipLoaded=function(){this.callLater(this.changeValue)},n$a.changeValue=function(){var n$a;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),n$a=this._sources[0]))){var n$b="horizontal"===this._direction;n$b?(this._wordsW=this._valueArr.length*(n$a.sourceWidth+this.spaceX),this._wordsH=n$a.sourceHeight):(this._wordsW=n$a.sourceWidth,this._wordsH=(n$a.sourceHeight+this.spaceY)*this._valueArr.length);var n$c=0;if(this._width)switch(this._align){case"center":n$c=.5*(this._width-this._wordsW);break;case"right":n$c=this._width-this._wordsW;break;default:n$c=0}for(var n$d=0,n$e=this._valueArr.length;n$d<n$e;n$d++){var n$f=this._indexMap[this._valueArr.charAt(n$d)];this.sources[n$f]&&(n$a=this.sources[n$f],n$b?this.graphics.drawTexture(n$a,n$c+n$d*(n$a.sourceWidth+this.spaceX),0,n$a.sourceWidth,n$a.sourceHeight):this.graphics.drawTexture(n$a,0+n$c,n$d*(n$a.sourceHeight+this.spaceY),n$a.sourceWidth,n$a.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),n$b.prototype.destroy.call(this,n$a)},n$e(0,n$a,"sheet",function(){return this._sheet},function(n$a){n$a+="";var n$b=(this._sheet=n$a).split(" ");this._clipX=String(n$b[0]).length,this.clipY=n$b.length,this._indexMap={};for(var n$c=0;n$c<this._clipY;n$c++)for(var n$d=n$b[n$c].split(""),n$e=0,n$f=n$d.length;n$e<n$f;n$e++)this._indexMap[n$d[n$e]]=n$c*this._clipX+n$e}),n$e(0,n$a,"height",n$b.prototype._$get_height,function(n$a){n$p.superSet(n$L,this,"height",n$a),this.callLater(this.changeValue)}),n$e(0,n$a,"direction",function(){return this._direction},function(n$a){this._direction=n$a,this.callLater(this.changeValue)}),n$e(0,n$a,"value",function(){return this._valueArr?this._valueArr:""},function(n$a){n$a+="",this._valueArr=n$a,this.callLater(this.changeValue)}),n$e(0,n$a,"width",n$b.prototype._$get_width,function(n$a){n$p.superSet(n$L,this,"width",n$a),this.callLater(this.changeValue)}),n$e(0,n$a,"spaceX",function(){return this._spaceX},function(n$a){this._spaceX=n$a,"horizontal"===this._direction&&this.callLater(this.changeValue)}),n$e(0,n$a,"spaceY",function(){return this._spaceY},function(n$a){this._spaceY=n$a,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),n$e(0,n$a,"align",function(){return this._align},function(n$a){this._align=n$a,this.callLater(this.changeValue)}),n$e(0,n$a,"measureWidth",function(){return this._wordsW}),n$e(0,n$a,"measureHeight",function(){return this._wordsH}),n$c}(n$L),n$X=function(n$a){function n$b(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new n$o,n$b.__super.call(this)}n$f(n$b,"laya.ui.List",n$a);var n$c=n$b.prototype;return n$p.imps(n$c,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),n$c.destroy=function(n$a){void 0===n$a&&(n$a=!0),this._content&&this._content.destroy(n$a),this._scrollBar&&this._scrollBar.destroy(n$a),laya.ui.Component.prototype.destroy.call(this,n$a),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},n$c.createChildren=function(){this.addChild(this._content=new n$J)},n$c.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=n$p.superGet(n$J,this,"cacheAs")),n$p.superSet(n$J,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},n$c.onScrollEnd=function(){n$p.superSet(n$J,this,"cacheAs",this._$P.cacheAs)},n$c._removePreScrollBar=function(){var n$a=this.removeChildByName("scrollBar");n$a&&n$a.destroy(!0)},n$c.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var n$a=this._getOneCell(),n$b=n$a.width+this._spaceX||1,n$c=n$a.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/n$b):Math.ceil(this._width/n$b)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/n$c):Math.round(this._height/n$c));var n$d=this._width?this._width:n$b*this.repeatX-this._spaceX,n$e=this._height?this._height:n$c*this.repeatY-this._spaceY;this._cellSize=this._isVertical?n$c:n$b,this._cellOffset=this._isVertical?n$c*Math.max(this._repeatY2,this._repeatY)-n$e-this._spaceY:n$b*Math.max(this._repeatX2,this._repeatX)-n$d-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=n$e:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=n$d),this.setContentSize(n$d,n$e);var n$f=this._isVertical?this.repeatX:this.repeatY,n$g=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,n$f,n$g),this._createdLine=n$g,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},n$c._getOneCell=function(){if(0===this._cells.length){var n$a=this.createItem();if(this._offset.setTo(n$a.x,n$a.y),this.cacheContent)return n$a;this._cells.push(n$a)}return this._cells[0]},n$c._createItems=function(n$a,n$b,n$c){var n$d=this._content,n$e=this._getOneCell(),n$f=n$e.width+this._spaceX,n$g=n$e.height+this._spaceY;if(this.cacheContent){var n$h=new n$J;n$h.cacheAsBitmap=!0,n$h.pos((this._isVertical?0:n$a)*n$f,(this._isVertical?n$a:0)*n$g),this._content.addChild(n$h),this._content.optimizeScrollRect=!0,n$d=n$h}else{for(var n$i=[],n$j=this._cells.length-1;-1<n$j;n$j--){var n$k=this._cells[n$j];n$k.removeSelf(),n$i.push(n$k)}this._cells.length=0}for(var n$l=n$a;n$l<n$c;n$l++)for(var n$m=0;n$m<n$b;n$m++)(n$e=n$i&&n$i.length?n$i.pop():this.createItem()).x=(this._isVertical?n$m:n$l)*n$f-n$d.x,n$e.y=(this._isVertical?n$l:n$m)*n$g-n$d.y,n$e.name="item"+(n$l*n$b+n$m),n$d.addChild(n$e),this.addCell(n$e)},n$c.createItem=function(){var n$a=[];if("function"==typeof this._itemRender)var n$b=new this._itemRender;else n$b=n$T.createComp(this._itemRender,null,null,n$a);if(0==n$a.length&&n$b._watchMap){var n$c=n$b._watchMap;for(var n$d in n$c)for(var n$e=n$c[n$d],n$f=0;n$f<n$e.length;n$f++){var n$g=n$e[n$f];n$a.push(n$g.comp,n$g.prop,n$g.value)}}return n$a.length&&(n$b._$bindData=n$a),n$b},n$c.addCell=function(n$a){n$a.on("click",this,this.onCellMouse),n$a.on("rightclick",this,this.onCellMouse),n$a.on("mouseover",this,this.onCellMouse),n$a.on("mouseout",this,this.onCellMouse),n$a.on("mousedown",this,this.onCellMouse),n$a.on("mouseup",this,this.onCellMouse),this._cells.push(n$a)},n$c.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var n$a=0,n$b=n$a=0;n$b<1e4;n$b++){var n$c=this.getChildByName("item"+n$b);if(!n$c)break;this.addCell(n$c),n$a++}this.repeatY=n$a}},n$c.setContentSize=function(n$a,n$b){this._content.width=n$a,this._content.height=n$b,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new n$r),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,n$a,n$b),this._content.scrollRect=this._content.scrollRect),this.event("resize")},n$c.onCellMouse=function(n$a){"mousedown"===n$a.type&&(this._isMoved=!1);var n$b=n$a.currentTarget,n$c=this._startIndex+this._cells.indexOf(n$b);n$c<0||("click"===n$a.type||"rightclick"===n$a.type?this.selectEnable&&!this._isMoved?this.selectedIndex=n$c:this.changeCellState(n$b,!0,0):"mouseover"!==n$a.type&&"mouseout"!==n$a.type||this._selectedIndex===n$c||this.changeCellState(n$b,"mouseover"===n$a.type,0),this.mouseHandler&&this.mouseHandler.runWith([n$a,n$c]))},n$c.changeCellState=function(n$a,n$b,n$c){var n$d=n$a.getChildByName("selectBox");n$d&&(this.selectEnable=!0,n$d.visible=n$b,n$d.index=n$c)},n$c.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},n$c.onScrollBarChange=function(n$a){this.runCallLater(this.changeCells);var n$b=this._scrollBar.value,n$c=this._isVertical?this.repeatX:this.repeatY,n$d=this._isVertical?this.repeatY:this.repeatX,n$e=Math.floor(n$b/this._cellSize);if(this.cacheContent)n$g=n$d+1,this._createdLine-n$e<n$g&&(this._createItems(this._createdLine,n$c,this._createdLine+n$g),this.renderItems(this._createdLine*n$c,0),this._createdLine+=n$g);else{var n$f=n$e*n$c,n$g=0;if(n$f>this._startIndex){n$g=n$f-this._startIndex;var n$h=!0,n$i=this._startIndex+n$c*(n$d+1);this._isMoved=!0}else n$f<this._startIndex&&(n$g=this._startIndex-n$f,n$h=!1,n$i=this._startIndex-1,this._isMoved=!0);for(var n$j=0;n$j<n$g;n$j++){if(n$h){var n$k=this._cells.shift();this._cells[this._cells.length]=n$k;var n$l=n$i+n$j}else n$k=this._cells.pop(),this._cells.unshift(n$k),n$l=n$i-n$j;var n$m=Math.floor(n$l/n$c)*this._cellSize;this._isVertical?n$k.y=n$m:n$k.x=n$m,this.renderItem(n$k,n$l)}this._startIndex=n$f,this.changeSelectStatus()}var n$n=this._content.scrollRect;this._isVertical?(n$n.y=n$b-this._offset.y,n$n.x=-this._offset.x):(n$n.y=-this._offset.y,n$n.x=n$b-this._offset.x),this._content.scrollRect=n$n},n$c.posCell=function(n$a,n$b){if(this._scrollBar){var n$c=this._isVertical?this.repeatX:this.repeatY,n$d=(this._isVertical?this.repeatY:this.repeatX,Math.floor(n$b/n$c)*this._cellSize);this._isVertical?n$a.y=n$d:n$a.x=n$d}},n$c.changeSelectStatus=function(){for(var n$a=0,n$b=this._cells.length;n$a<n$b;n$a++)this.changeCellState(this._cells[n$a],this._selectedIndex===this._startIndex+n$a,1)},n$c.renderItems=function(n$a,n$b){void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0);for(var n$c=n$a,n$d=n$b||this._cells.length;n$c<n$d;n$c++)this.renderItem(this._cells[n$c],this._startIndex+n$c);this.changeSelectStatus()},n$c.renderItem=function(n$a,n$b){this._array&&0<=n$b&&n$b<this._array.length?(n$a.visible=!0,n$a._$bindData?(n$a._dataSource=this._array[n$b],this._bindData(n$a,this._array[n$b])):n$a.dataSource=this._array[n$b],this.cacheContent||this.posCell(n$a,n$b),this.hasListener("render")&&this.event("render",[n$a,n$b]),this.renderHandler&&this.renderHandler.runWith([n$a,n$b])):(n$a.visible=!1,n$a.dataSource=null)},n$c._bindData=function(n$a,n$b){for(var n$c=n$a._$bindData,n$d=0,n$e=n$c.length;n$d<n$e;n$d++){var n$f=n$c[n$d++],n$g=n$c[n$d++],n$h=n$c[n$d],n$i=n$E.getBindFun(n$h);n$f[n$g]=n$i.call(this,n$b)}},n$c.refresh=function(){this.array=this._array},n$c.getItem=function(n$a){return-1<n$a&&n$a<this._array.length?this._array[n$a]:null},n$c.changeItem=function(n$a,n$b){-1<n$a&&n$a<this._array.length&&(this._array[n$a]=n$b,n$a>=this._startIndex&&n$a<this._startIndex+this._cells.length&&this.renderItem(this.getCell(n$a),n$a))},n$c.setItem=function(n$a,n$b){this.changeItem(n$a,n$b)},n$c.addItem=function(n$a){this._array.push(n$a),this.array=this._array},n$c.addItemAt=function(n$a,n$b){this._array.splice(n$b,0,n$a),this.array=this._array},n$c.deleteItem=function(n$a){this._array.splice(n$a,1),this.array=this._array},n$c.getCell=function(n$a){return this.runCallLater(this.changeCells),-1<n$a&&this._cells?this._cells[(n$a-this._startIndex)%this._cells.length]:null},n$c.scrollTo=function(n$a){if(this._scrollBar){var n$b=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(n$a/n$b)*this._cellSize}else this.startIndex=n$a},n$c.tweenTo=function(n$a,n$b,n$c){if(void 0===n$b&&(n$b=200),this._scrollBar){var n$d=this._isVertical?this.repeatX:this.repeatY;n$x.to(this._scrollBar,{value:Math.floor(n$a/n$d)*this._cellSize},n$b,null,n$c,0,!0)}else this.startIndex=n$a,n$c&&n$c.run()},n$c._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},n$c.commitMeasure=function(){this.runCallLater(this.changeCells)},n$e(0,n$c,"cacheAs",n$a.prototype._$get_cacheAs,function(n$a){n$p.superSet(n$J,this,"cacheAs",n$a),this._scrollBar&&(this._$P.cacheAs=null,"none"!==n$a?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),n$e(0,n$c,"content",function(){return this._content}),n$e(0,n$c,"height",n$a.prototype._$get_height,function(n$a){n$a!=this._height&&(n$p.superSet(n$J,this,"height",n$a),this._setCellChanged())}),n$e(0,n$c,"itemRender",function(){return this._itemRender},function(n$a){if(this._itemRender!=n$a){this._itemRender=n$a;for(var n$b=this._cells.length-1;-1<n$b;n$b--)this._cells[n$b].destroy();this._cells.length=0,this._setCellChanged()}}),n$e(0,n$c,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(n$a){this._removePreScrollBar();var n$b=new n$ba;n$b.name="scrollBar",n$b.right=0,n$a&&" "!=n$a&&(n$b.skin=n$a),this.scrollBar=n$b,this.addChild(n$b),this._setCellChanged()}),n$e(0,n$c,"page",function(){return this._page},function(n$a){this._page=n$a,this._array&&(this._page=0<n$a?n$a:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),n$e(0,n$c,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(n$a){this._removePreScrollBar();var n$b=new n$Y;n$b.name="scrollBar",n$b.bottom=0,n$a&&" "!=n$a&&(n$b.skin=n$a),this.scrollBar=n$b,this.addChild(n$b),this._setCellChanged()}),n$e(0,n$c,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(n$a){this._repeatX=n$a,this._setCellChanged()}),n$e(0,n$c,"scrollBar",function(){return this._scrollBar},function(n$a){this._scrollBar!=n$a&&(this._scrollBar=n$a)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),n$e(0,n$c,"width",n$a.prototype._$get_width,function(n$a){n$a!=this._width&&(n$p.superSet(n$J,this,"width",n$a),this._setCellChanged())}),n$e(0,n$c,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(n$a){this._repeatY=n$a,this._setCellChanged()}),n$e(0,n$c,"spaceX",function(){return this._spaceX},function(n$a){this._spaceX=n$a,this._setCellChanged()}),n$e(0,n$c,"spaceY",function(){return this._spaceY},function(n$a){this._spaceY=n$a,this._setCellChanged()}),n$e(0,n$c,"selectedIndex",function(){return this._selectedIndex},function(n$a){this._selectedIndex!=n$a&&(this._selectedIndex=n$a,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(n$a),this.startIndex=this._startIndex)}),n$e(0,n$c,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(n$a){this.selectedIndex=this._array.indexOf(n$a)}),n$e(0,n$c,"length",function(){return this._array?this._array.length:0}),n$e(0,n$c,"selection",function(){return this.getCell(this._selectedIndex)},function(n$a){this.selectedIndex=this._startIndex+this._cells.indexOf(n$a)}),n$e(0,n$c,"startIndex",function(){return this._startIndex},function(n$a){this._startIndex=0<n$a?n$a:0,this.callLater(this.renderItems)}),n$e(0,n$c,"array",function(){return this._array},function(n$a){this.runCallLater(this.changeCells),this._array=n$a||[];var n$b=this._array.length;if(this.totalPage=Math.ceil(n$b/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<n$b?this._selectedIndex:n$b-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var n$c=this._isVertical?this.repeatX:this.repeatY,n$d=this._isVertical?this.repeatY:this.repeatX,n$e=Math.ceil(n$b/n$c);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=n$d/n$e,this._scrollBar.setScroll(0,(n$e-n$d)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),n$e(0,n$c,"dataSource",n$a.prototype._$get_dataSource,function(n$a){"number"==typeof(this._dataSource=n$a)&&Math.floor(n$a)==n$a||"string"==typeof n$a?this.selectedIndex=parseInt(n$a):n$a instanceof Array?this.array=n$a:n$p.superSet(n$J,this,"dataSource",n$a)}),n$e(0,n$c,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),n$b}(n$J),n$Y=function(n$a){function n$b(){n$b.__super.call(this)}return n$f(n$b,"laya.ui.HScrollBar",n$a),n$b.prototype.initialize=function(){n$a.prototype.initialize.call(this),this.slider.isVertical=!1},n$b}(n$O),n$Z=function(n$a){function n$b(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,n$b.__super.call(this),this.width=this.height=100}n$f(n$b,"laya.ui.Panel",n$a);var n$c=n$b.prototype;return n$c.destroy=function(n$a){void 0===n$a&&(n$a=!0),laya.ui.Component.prototype.destroy.call(this,n$a),this._content&&this._content.destroy(n$a),this._vScrollBar&&this._vScrollBar.destroy(n$a),this._hScrollBar&&this._hScrollBar.destroy(n$a),this._vScrollBar=null,this._hScrollBar=null,this._content=null},n$c.destroyChildren=function(){this._content.destroyChildren()},n$c.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new n$J)},n$c.addChild=function(n$a){return n$a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(n$a)},n$c.onResize=function(){this._setScrollChanged()},n$c.addChildAt=function(n$a,n$b){return n$a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(n$a,n$b)},n$c.removeChild=function(n$a){return n$a.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(n$a)},n$c.removeChildAt=function(n$a){return this.getChildAt(n$a).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(n$a)},n$c.removeChildren=function(n$a,n$b){return void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=2147483647),this._content.removeChildren(n$a,n$b),this._setScrollChanged(),this},n$c.getChildAt=function(n$a){return this._content.getChildAt(n$a)},n$c.getChildByName=function(n$a){return this._content.getChildByName(n$a)},n$c.getChildIndex=function(n$a){return this._content.getChildIndex(n$a)},n$c.changeScroll=function(){this._scrollChanged=!1;var n$a=this.contentWidth||1,n$b=this.contentHeight||1,n$c=this._vScrollBar,n$d=this._hScrollBar,n$e=n$c&&n$b>this._height,n$f=n$d&&n$a>this._width,n$g=n$e?this._width-n$c.width:this._width,n$h=n$f?this._height-n$d.height:this._height;n$c&&(n$c.x=this._width-n$c.width,n$c.y=0,n$c.height=this._height-(n$f?n$d.height:0),n$c.scrollSize=Math.max(.033*this._height,1),n$c.thumbPercent=n$h/n$b,n$c.setScroll(0,n$b-n$h,n$c.value)),n$d&&(n$d.x=0,n$d.y=this._height-n$d.height,n$d.width=this._width-(n$e?n$c.width:0),n$d.scrollSize=Math.max(.033*this._width,1),n$d.thumbPercent=n$g/n$a,n$d.setScroll(0,n$a-n$g,n$d.value))},n$c.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},n$c.setContentSize=function(n$a,n$b){var n$c=this._content;n$c.width=n$a,n$c.height=n$b,n$c.scrollRect||(n$c.scrollRect=new n$r),n$c.scrollRect.setTo(0,0,n$a,n$b),n$c.scrollRect=n$c.scrollRect},n$c.onScrollBarChange=function(n$a){var n$b=this._content.scrollRect;if(n$b){var n$c=Math.round(n$a.value);n$a.isVertical?n$b.y=n$c:n$b.x=n$c,this._content.scrollRect=n$b}},n$c.scrollTo=function(n$a,n$b){void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),this.vScrollBar&&(this.vScrollBar.value=n$b),this.hScrollBar&&(this.hScrollBar.value=n$a)},n$c.refresh=function(){this.changeScroll()},n$c.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=n$p.superGet(n$J,this,"cacheAs")),n$p.superSet(n$J,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},n$c.onScrollEnd=function(){n$p.superSet(n$J,this,"cacheAs",this._$P.cacheAs)},n$c._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},n$e(0,n$c,"numChildren",function(){return this._content.numChildren}),n$e(0,n$c,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(n$a){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new n$Y),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=n$a}),n$e(0,n$c,"contentWidth",function(){for(var n$a=0,n$b=this._content.numChildren-1;-1<n$b;n$b--){var n$c=this._content.getChildAt(n$b);n$a=Math.max(n$c.x+n$c.width*n$c.scaleX,n$a)}return n$a}),n$e(0,n$c,"contentHeight",function(){for(var n$a=0,n$b=this._content.numChildren-1;-1<n$b;n$b--){var n$c=this._content.getChildAt(n$b);n$a=Math.max(n$c.y+n$c.height*n$c.scaleY,n$a)}return n$a}),n$e(0,n$c,"width",n$a.prototype._$get_width,function(n$a){n$p.superSet(n$J,this,"width",n$a),this._setScrollChanged()}),n$e(0,n$c,"hScrollBar",function(){return this._hScrollBar}),n$e(0,n$c,"content",function(){return this._content}),n$e(0,n$c,"height",n$a.prototype._$get_height,function(n$a){n$p.superSet(n$J,this,"height",n$a),this._setScrollChanged()}),n$e(0,n$c,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(n$a){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new n$ba),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=n$a}),n$e(0,n$c,"vScrollBar",function(){return this._vScrollBar}),n$e(0,n$c,"cacheAs",n$a.prototype._$get_cacheAs,function(n$a){n$p.superSet(n$J,this,"cacheAs",n$a),this._$P.cacheAs=null,"none"!==n$a?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),n$b}(n$J),n$$=function(n$a){function n$b(n$a){n$b.__super.call(this,n$a),this.isVertical=!1}return n$f(n$b,"laya.ui.HSlider",n$P),n$b}(),n$_=function(n$a){function n$c(n$a,n$b){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,n$c.__super.call(this),this.skin=n$b,this.labels=n$a}n$f(n$c,"laya.ui.UIGroup",n$a);var n$b=n$c.prototype;return n$p.imps(n$b,{"laya.ui.IItem":!0}),n$b.preinitialize=function(){this.mouseEnabled=!0},n$b.destroy=function(n$a){void 0===n$a&&(n$a=!0),laya.ui.Component.prototype.destroy.call(this,n$a),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},n$b.addItem=function(n$a,n$b){void 0===n$b&&(n$b=!0);var n$c=n$a,n$d=this._items.length;if(n$c.name="item"+n$d,this.addChild(n$c),this.initItems(),n$b&&0<n$d){var n$e=this._items[n$d-1];"horizontal"==this._direction?n$c.x=n$e.x+n$e.width+this._space:n$c.y=n$e.y+n$e.height+this._space}else n$b&&(n$c.x=0,n$c.y=0);return n$d},n$b.delItem=function(n$a,n$b){void 0===n$b&&(n$b=!0);var n$c=this._items.indexOf(n$a);if(-1!=n$c){var n$d=n$a;this.removeChild(n$d);for(var n$e=n$c+1,n$f=this._items.length;n$e<n$f;n$e++){var n$g=this._items[n$e];n$g.name="item"+(n$e-1),n$b&&("horizontal"==this._direction?n$g.x-=n$d.width+this._space:n$g.y-=n$d.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var n$h;n$h=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=n$h}}},n$b.initItems=function(){this._items||(this._items=[]);for(var n$a=this._items.length=0;n$a<1e4;n$a++){var n$b=this.getChildByName("item"+n$a);if(null==n$b)break;this._items.push(n$b),n$b.selected=n$a===this._selectedIndex,n$b.clickHandler=n$m.create(this,this.itemClick,[n$a],!1)}},n$b.itemClick=function(n$a){this.selectedIndex=n$a},n$b.setSelect=function(n$a,n$b){this._items&&-1<n$a&&n$a<this._items.length&&(this._items[n$a].selected=n$b)},n$b.createItem=function(n$a,n$b){return null},n$b.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var n$a=0,n$b=0,n$c=this._items.length;n$b<n$c;n$b++){var n$d=this._items[n$b];this._skin&&(n$d.skin=this._skin),this._labelColors&&(n$d.labelColors=this._labelColors),this._labelSize&&(n$d.labelSize=this._labelSize),this._labelStroke&&(n$d.labelStroke=this._labelStroke),this._labelStrokeColor&&(n$d.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(n$d.strokeColors=this._strokeColors),this._labelBold&&(n$d.labelBold=this._labelBold),this._labelPadding&&(n$d.labelPadding=this._labelPadding),this._labelAlign&&(n$d.labelAlign=this._labelAlign),this._stateNum&&(n$d.stateNum=this._stateNum),this._labelFont&&(n$d.labelFont=this._labelFont),"horizontal"===this._direction?(n$d.y=0,n$d.x=n$a,n$a+=n$d.width+this._space):(n$d.x=0,n$d.y=n$a,n$a+=n$d.height+this._space)}this.changeSize()},n$b.commitMeasure=function(){this.runCallLater(this.changeLabels)},n$b._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},n$e(0,n$b,"labelStrokeColor",function(){return this._labelStrokeColor},function(n$a){this._labelStrokeColor!=n$a&&(this._labelStrokeColor=n$a,this._setLabelChanged())}),n$e(0,n$b,"skin",function(){return this._skin},function(n$a){this._skin!=n$a&&(this._skin=n$a,this._setLabelChanged())}),n$e(0,n$b,"selectedIndex",function(){return this._selectedIndex},function(n$a){this._selectedIndex!=n$a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=n$a,this.setSelect(n$a,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),n$e(0,n$b,"labels",function(){return this._labels},function(n$a){if(this._labels!=n$a){if(this._labels=n$a,this.removeChildren(),this._setLabelChanged(),this._labels)for(var n$b=this._labels.split(","),n$c=0,n$d=n$b.length;n$c<n$d;n$c++){var n$e=this.createItem(this._skin,n$b[n$c]);n$e.name="item"+n$c,this.addChild(n$e)}this.initItems()}}),n$e(0,n$b,"strokeColors",function(){return this._strokeColors},function(n$a){this._strokeColors!=n$a&&(this._strokeColors=n$a,this._setLabelChanged())}),n$e(0,n$b,"labelColors",function(){return this._labelColors},function(n$a){this._labelColors!=n$a&&(this._labelColors=n$a,this._setLabelChanged())}),n$e(0,n$b,"labelStroke",function(){return this._labelStroke},function(n$a){this._labelStroke!=n$a&&(this._labelStroke=n$a,this._setLabelChanged())}),n$e(0,n$b,"labelSize",function(){return this._labelSize},function(n$a){this._labelSize!=n$a&&(this._labelSize=n$a,this._setLabelChanged())}),n$e(0,n$b,"stateNum",function(){return this._stateNum},function(n$a){this._stateNum!=n$a&&(this._stateNum=n$a,this._setLabelChanged())}),n$e(0,n$b,"labelBold",function(){return this._labelBold},function(n$a){this._labelBold!=n$a&&(this._labelBold=n$a,this._setLabelChanged())}),n$e(0,n$b,"labelFont",function(){return this._labelFont},function(n$a){this._labelFont!=n$a&&(this._labelFont=n$a,this._setLabelChanged())}),n$e(0,n$b,"labelPadding",function(){return this._labelPadding},function(n$a){this._labelPadding!=n$a&&(this._labelPadding=n$a,this._setLabelChanged())}),n$e(0,n$b,"direction",function(){return this._direction},function(n$a){this._direction=n$a,this._setLabelChanged()}),n$e(0,n$b,"space",function(){return this._space},function(n$a){this._space=n$a,this._setLabelChanged()}),n$e(0,n$b,"items",function(){return this._items}),n$e(0,n$b,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(n$a){this.selectedIndex=this._items.indexOf(n$a)}),n$e(0,n$b,"dataSource",n$a.prototype._$get_dataSource,function(n$a){"number"==typeof(this._dataSource=n$a)&&Math.floor(n$a)==n$a||"string"==typeof n$a?this.selectedIndex=parseInt(n$a):n$a instanceof Array?this.labels=n$a.join(","):n$p.superSet(n$J,this,"dataSource",n$a)}),n$c}(n$J),n$A=function(n$b){function n$c(n$a,n$b){this._value=null,void 0===n$b&&(n$b=""),n$c.__super.call(this,n$a,n$b)}n$f(n$c,"laya.ui.Radio",n$b);var n$a=n$c.prototype;return n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,n$a),this._value=null},n$a.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},n$a.initialize=function(){n$b.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},n$a.onClick=function(n$a){this.selected=!0},n$e(0,n$a,"value",function(){return null!=this._value?this._value:this.label},function(n$a){this._value=n$a}),n$c}(n$K),n$B=function(n$a){function n$b(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,n$b.__super.call(this),this.width=this.height=200}n$f(n$b,"laya.ui.Tree",n$a);var n$c=n$b.prototype;return n$p.imps(n$c,{"laya.ui.IRender":!0}),n$c.destroy=function(n$a){void 0===n$a&&(n$a=!0),laya.ui.Component.prototype.destroy.call(this,n$a),this._list&&this._list.destroy(n$a),this._list=null,this._source=null,this._renderHandler=null},n$c.createChildren=function(){this.addChild(this._list=new n$X),this._list.renderHandler=n$m.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},n$c.onListChange=function(n$a){this.event("change")},n$c.getArray=function(){var n$a,n$b=[];for(var n$c in this._source)n$a=this._source[n$c],this.getParentOpenStatus(n$a)&&(n$a.x=this._spaceLeft*this.getDepth(n$a),n$b.push(n$a));return n$b},n$c.getDepth=function(n$a,n$b){return void 0===n$b&&(n$b=0),null==n$a.nodeParent?n$b:this.getDepth(n$a.nodeParent,n$b+1)},n$c.getParentOpenStatus=function(n$a){var n$b=n$a.nodeParent;return null==n$b||!!n$b.isOpen&&(null==n$b.nodeParent||this.getParentOpenStatus(n$b))},n$c.renderItem=function(n$a,n$b){var n$c=n$a.dataSource;if(n$c){n$a.left=n$c.x;var n$d=n$a.getChildByName("arrow");n$d&&(n$c.hasChild?(n$d.visible=!0,n$d.index=n$c.isOpen?1:0,n$d.tag=n$b,n$d.off("click",this,this.onArrowClick),n$d.on("click",this,this.onArrowClick)):n$d.visible=!1);var n$e=n$a.getChildByName("folder");n$e&&(2==n$e.clipY?n$e.index=n$c.isDirectory?0:1:n$e.index=n$c.isDirectory?n$c.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([n$a,n$b])}},n$c.onArrowClick=function(n$a){var n$b=n$a.currentTarget.tag;this._list.array[n$b].isOpen=!this._list.array[n$b].isOpen,this.event("open"),this._list.array=this.getArray()},n$c.setItemState=function(n$a,n$b){this._list.array[n$a]&&(this._list.array[n$a].isOpen=n$b,this._list.array=this.getArray())},n$c.fresh=function(){this._list.array=this.getArray(),this.repaint()},n$c.parseXml=function(n$a,n$b,n$c,n$d){var n$e,n$f=n$a.childNodes,n$g=n$f.length;if(!n$d){n$e={};var n$h,n$i=n$a.attributes;for(var n$j in n$i){var n$k=(n$h=n$i[n$j]).nodeName,n$l=n$h.nodeValue;n$e[n$k]="true"==n$l||"false"!=n$l&&n$l}n$e.nodeParent=n$c,0<n$g&&(n$e.isDirectory=!0),n$e.hasChild=0<n$g,n$b.push(n$e)}for(var n$m=0;n$m<n$g;n$m++){var n$n=n$f[n$m];this.parseXml(n$n,n$b,n$e,!1)}},n$c.parseOpenStatus=function(n$a,n$b){for(var n$c=0,n$d=n$b.length;n$c<n$d;n$c++){var n$e=n$b[n$c];if(n$e.isDirectory)for(var n$f=0,n$g=n$a.length;n$f<n$g;n$f++){var n$h=n$a[n$f];if(n$h.isDirectory&&this.isSameParent(n$h,n$e)&&n$e.label==n$h.label){n$e.isOpen=n$h.isOpen;break}}}},n$c.isSameParent=function(n$a,n$b){return null==n$a.nodeParent&&null==n$b.nodeParent||null!=n$a.nodeParent&&null!=n$b.nodeParent&&(n$a.nodeParent.label==n$b.nodeParent.label&&this.isSameParent(n$a.nodeParent,n$b.nodeParent))},n$c.filter=function(n$a){if(Boolean(n$a)){var n$b=[];this.getFilterSource(this._source,n$b,n$a),this._list.array=n$b}else this._list.array=this.getArray()},n$c.getFilterSource=function(n$a,n$b,n$c){var n$d;for(var n$e in n$c=n$c.toLocaleLowerCase(),n$a)!(n$d=n$a[n$e]).isDirectory&&-1<String(n$d.label).toLowerCase().indexOf(n$c)&&(n$d.x=0,n$b.push(n$d)),n$d.child&&0<n$d.child.length&&this.getFilterSource(n$d.child,n$b,n$c)},n$e(0,n$c,"spaceBottom",function(){return this._list.spaceY},function(n$a){this._list.spaceY=n$a}),n$e(0,n$c,"keepStatus",function(){return this._keepStatus},function(n$a){this._keepStatus=n$a}),n$e(0,n$c,"itemRender",function(){return this._list.itemRender},function(n$a){this._list.itemRender=n$a}),n$e(0,n$c,"array",function(){return this._list.array},function(n$a){this._keepStatus&&this._list.array&&n$a&&this.parseOpenStatus(this._list.array,n$a),this._source=n$a,this._list.array=this.getArray()}),n$e(0,n$c,"mouseHandler",function(){return this._list.mouseHandler},function(n$a){this._list.mouseHandler=n$a}),n$e(0,n$c,"dataSource",n$a.prototype._$get_dataSource,function(n$a){this._dataSource=n$a,n$p.superSet(n$J,this,"dataSource",n$a)}),n$e(0,n$c,"source",function(){return this._source}),n$e(0,n$c,"scrollBar",function(){return this._list.scrollBar}),n$e(0,n$c,"list",function(){return this._list}),n$e(0,n$c,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(n$a){this._list.vScrollBarSkin=n$a}),n$e(0,n$c,"renderHandler",function(){return this._renderHandler},function(n$a){this._renderHandler=n$a}),n$e(0,n$c,"selectedIndex",function(){return this._list.selectedIndex},function(n$a){this._list.selectedIndex=n$a}),n$e(0,n$c,"spaceLeft",function(){return this._spaceLeft},function(n$a){this._spaceLeft=n$a}),n$e(0,n$c,"selectedItem",function(){return this._list.selectedItem},function(n$a){this._list.selectedItem=n$a}),n$e(0,n$c,"width",n$a.prototype._$get_width,function(n$a){n$p.superSet(n$J,this,"width",n$a),this._list.width=n$a}),n$e(0,n$c,"height",n$a.prototype._$get_height,function(n$a){n$p.superSet(n$J,this,"height",n$a),this._list.height=n$a}),n$e(0,n$c,"xml",null,function(n$a){var n$b=[];this.parseXml(n$a.childNodes[0],n$b,null,!0),this.array=n$b}),n$e(0,n$c,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),n$b}(n$J),n$aa=function(n$a){function n$b(){this._items=null,this._selectedIndex=0,n$b.__super.call(this),this._setIndexHandler=n$m.create(this,this.setIndex,null,!1)}n$f(n$b,"laya.ui.ViewStack",n$a);var n$c=n$b.prototype;return n$p.imps(n$c,{"laya.ui.IItem":!0}),n$c.setItems=function(n$a){this.removeChildren();for(var n$b=0,n$c=0,n$d=n$a.length;n$c<n$d;n$c++){var n$e=n$a[n$c];n$e&&(n$e.name="item"+n$b,this.addChild(n$e),n$b++)}this.initItems()},n$c.addItem=function(n$a){n$a.name="item"+this._items.length,this.addChild(n$a),this.initItems()},n$c.initItems=function(){this._items=[];for(var n$a=0;n$a<1e4;n$a++){var n$b=this.getChildByName("item"+n$a);if(null==n$b)break;this._items.push(n$b),n$b.visible=n$a==this._selectedIndex}},n$c.setSelect=function(n$a,n$b){this._items&&-1<n$a&&n$a<this._items.length&&(this._items[n$a].visible=n$b)},n$c.setIndex=function(n$a){this.selectedIndex=n$a},n$e(0,n$c,"dataSource",n$a.prototype._$get_dataSource,function(n$a){if("number"==typeof(this._dataSource=n$a)&&Math.floor(n$a)==n$a||"string"==typeof n$a)this.selectedIndex=parseInt(n$a);else for(var n$b in this._dataSource)this.hasOwnProperty(n$b)&&(this[n$b]=this._dataSource[n$b])}),n$e(0,n$c,"selectedIndex",function(){return this._selectedIndex},function(n$a){this._selectedIndex!=n$a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=n$a,this.setSelect(this._selectedIndex,!0))}),n$e(0,n$c,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(n$a){this.selectedIndex=this._items.indexOf(n$a)}),n$e(0,n$c,"items",function(){return this._items}),n$e(0,n$c,"setIndexHandler",function(){return this._setIndexHandler},function(n$a){this._setIndexHandler=n$a}),n$b}(n$J),n$ba=function(n$a){function n$b(){n$b.__super.call(this)}return n$f(n$b,"laya.ui.VScrollBar",n$O),n$b}(),n$ca=function(n$b){function n$c(n$a){this._bg=null,this._skin=null,n$c.__super.call(this),void 0===n$a&&(n$a=""),this.text=n$a,this.skin=this.skin}n$f(n$c,"laya.ui.TextInput",n$b);var n$a=n$c.prototype;return n$a.preinitialize=function(){this.mouseEnabled=!0},n$a.destroy=function(n$a){n$s.clearCache(this,this._skin),void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,n$a),this._bg&&this._bg.destroy(),this._bg=null},n$a.createChildren=function(){this.addChild(this._tf=new n$n),this._tf.padding=n$D.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},n$a._onFocus=function(){this.event("focus",this)},n$a._onBlur=function(){this.event("blur",this)},n$a._onInput=function(){this.event("input",this)},n$a._onEnter=function(){this.event("enter",this)},n$a.initialize=function(){this.width=128,this.height=22},n$a.select=function(){this._tf.select()},n$a.setSelection=function(n$a,n$b){this._tf.setSelection(n$a,n$b)},n$e(0,n$a,"text",n$b.prototype._$get_text,function(n$a){this._tf.text!=n$a&&(n$a+="",this._tf.text=n$a,this.event("change"))}),n$e(0,n$a,"bg",function(){return this._bg},function(n$a){this.graphics=this._bg=n$a}),n$e(0,n$a,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(n$a){this._tf.inputElementYAdjuster=n$a}),n$e(0,n$a,"multiline",function(){return this._tf.multiline},function(n$a){this._tf.multiline=n$a}),n$e(0,n$a,"skin",function(){return this._skin},function(n$a){this._skin!=n$a&&(n$s.clearCache(this,this._skin),this._skin=n$a,this._bg||(this.graphics=this._bg=new n$G),n$s.keepCache(this,this._skin),this._bg.source=n$s.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),n$e(0,n$a,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(n$a){this._bg||(this.graphics=this._bg=new n$G),this._bg.sizeGrid=n$E.fillArray(n$D.defaultSizeGrid,n$a,Number)}),n$e(0,n$a,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(n$a){this._tf.inputElementXAdjuster=n$a}),n$e(0,n$a,"width",n$b.prototype._$get_width,function(n$a){n$p.superSet(n$R,this,"width",n$a),this._bg&&(this._bg.width=n$a)}),n$e(0,n$a,"height",n$b.prototype._$get_height,function(n$a){n$p.superSet(n$R,this,"height",n$a),this._bg&&(this._bg.height=n$a)}),n$e(0,n$a,"editable",function(){return this._tf.editable},function(n$a){this._tf.editable=n$a}),n$e(0,n$a,"restrict",function(){return this._tf.restrict},function(n$a){this._tf.restrict=n$a}),n$e(0,n$a,"prompt",function(){return this._tf.prompt},function(n$a){this._tf.prompt=n$a}),n$e(0,n$a,"promptColor",function(){return this._tf.promptColor},function(n$a){this._tf.promptColor=n$a}),n$e(0,n$a,"maxChars",function(){return this._tf.maxChars},function(n$a){this._tf.maxChars=n$a}),n$e(0,n$a,"focus",function(){return this._tf.focus},function(n$a){this._tf.focus=n$a}),n$e(0,n$a,"type",function(){return this._tf.type},function(n$a){this._tf.type=n$a}),n$e(0,n$a,"asPassword",function(){return this._tf.asPassword},function(n$a){this._tf.asPassword=n$a}),n$c}(n$R),n$da=function(n$a){function n$b(){n$b.__super.call(this)}return n$f(n$b,"laya.ui.VSlider",n$P),n$b}(),n$ea=function(n$a){function n$d(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,n$d.__super.call(this)}n$f(n$d,"laya.ui.Dialog",n$a);var n$b=n$d.prototype;return n$b.initialize=function(){this.popupEffect=n$d.manager.popupEffectHandler,this.closeEffect=n$d.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},n$b._dealDragArea=function(){var n$a=this.getChildByName("drag");n$a&&(this.dragArea=n$a.x+","+n$a.y+","+n$a.width+","+n$a.height,n$a.removeSelf())},n$b._onClick=function(n$a){var n$b=n$a.target;if(n$b)switch(n$b.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(n$b.name)}},n$b.show=function(n$a,n$b){void 0===n$a&&(n$a=!1),void 0===n$b&&(n$b=!0),this._open(!1,n$a,n$b)},n$b.popup=function(n$a,n$b){void 0===n$a&&(n$a=!1),void 0===n$b&&(n$b=!0),this._open(!0,n$a,n$b)},n$b._open=function(n$a,n$b,n$c){n$d.manager.lock(!1),this.isModal=n$a,n$d.manager.open(this,n$b,n$c)},n$b.onOpened=function(){},n$b.close=function(n$a,n$b){void 0===n$b&&(n$b=!0),n$d.manager.close(this,n$a,n$b)},n$b.onClosed=function(n$a){},n$b._onMouseDown=function(n$a){var n$b=this.getMousePoint();this._dragArea.contains(n$b.x,n$b.y)?this.startDrag():this.stopDrag()},n$e(0,n$b,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(n$a){if(n$a){var n$b=n$E.fillArray([0,0,0,0],n$a,Number);this._dragArea=new n$r(n$b[0],n$b[1],n$b[2],n$b[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),n$e(0,n$b,"isPopup",function(){return null!=this.parent}),n$e(0,n$b,"zOrder",n$a.prototype._$get_zOrder,function(n$a){n$p.superSet(n$T,this,"zOrder",n$a),n$d.manager._checkMask()}),n$e(1,n$d,"manager",function(){return n$d._manager=n$d._manager||new n$I},function(n$a){n$d._manager=n$a}),n$d.setLockView=function(n$a){n$d.manager.setLockView(n$a)},n$d.lock=function(n$a){n$d.manager.lock(n$a)},n$d.closeAll=function(){n$d.manager.closeAll()},n$d.getDialogsByGroup=function(n$a){return n$d.manager.getDialogsByGroup(n$a)},n$d.closeByGroup=function(n$a){return n$d.manager.closeByGroup(n$a)},n$d.CLOSE="close",n$d.CANCEL="cancel",n$d.SURE="sure",n$d.NO="no",n$d.OK="ok",n$d.YES="yes",n$d._manager=null,n$d}(n$T),n$fa=function(n$a){function n$b(){n$b.__super.call(this)}n$f(n$b,"laya.ui.HBox",n$a);var n$c=n$b.prototype;return n$c.sortItem=function(n$a){n$a&&n$a.sort(function(n$a,n$b){return n$a.x-n$b.x})},n$c.changeItems=function(){this._itemChanged=!1;for(var n$a=[],n$b=0,n$c=0,n$d=this.numChildren;n$c<n$d;n$c++){var n$e=this.getChildAt(n$c);n$e&&n$e.layoutEnabled&&(n$a.push(n$e),n$b=this._height?this._height:Math.max(n$b,n$e.height*n$e.scaleY))}this.sortItem(n$a);var n$f=0;for(n$c=0,n$d=n$a.length;n$c<n$d;n$c++)(n$e=n$a[n$c]).x=n$f,n$f+=n$e.width*n$e.scaleX+this._space,"top"==this._align?n$e.y=0:"middle"==this._align?n$e.y=.5*(n$b-n$e.height*n$e.scaleY):"bottom"==this._align&&(n$e.y=n$b-n$e.height*n$e.scaleY);this.changeSize()},n$e(0,n$c,"height",n$a.prototype._$get_height,function(n$a){this._height!=n$a&&(n$p.superSet(n$V,this,"height",n$a),this.callLater(this.changeItems))}),n$b.NONE="none",n$b.TOP="top",n$b.MIDDLE="middle",n$b.BOTTOM="bottom",n$b}(n$V),n$ga=function(n$a){function n$b(){n$b.__super.call(this)}n$f(n$b,"laya.ui.VBox",n$a);var n$c=n$b.prototype;return n$c.changeItems=function(){this._itemChanged=!1;for(var n$a=[],n$b=0,n$c=0,n$d=this.numChildren;n$c<n$d;n$c++){var n$e=this.getChildAt(n$c);n$e&&n$e.layoutEnabled&&(n$a.push(n$e),n$b=this._width?this._width:Math.max(n$b,n$e.width*n$e.scaleX))}this.sortItem(n$a);var n$f=0;for(n$c=0,n$d=n$a.length;n$c<n$d;n$c++)(n$e=n$a[n$c]).y=n$f,n$f+=n$e.height*n$e.scaleY+this._space,"left"==this._align?n$e.x=0:"center"==this._align?n$e.x=.5*(n$b-n$e.width*n$e.scaleX):"right"==this._align&&(n$e.x=n$b-n$e.width*n$e.scaleX);this.changeSize()},n$e(0,n$c,"width",n$a.prototype._$get_width,function(n$a){this._width!=n$a&&(n$p.superSet(n$V,this,"width",n$a),this.callLater(this.changeItems))}),n$b.NONE="none",n$b.LEFT="left",n$b.CENTER="center",n$b.RIGHT="right",n$b}(n$V),n$ha=function(n$a){function n$b(){n$b.__super.call(this)}return n$f(n$b,"laya.ui.RadioGroup",n$_),n$b.prototype.createItem=function(n$a,n$b){return new n$A(n$a,n$b)},n$b}(),n$ia=function(n$a){function n$b(){n$b.__super.call(this)}return n$f(n$b,"laya.ui.Tab",n$_),n$b.prototype.createItem=function(n$a,n$b){return new n$K(n$a,n$b)},n$b}(),n$ja=function(n$b){function n$c(n$a){this._vScrollBar=null,this._hScrollBar=null,void 0===n$a&&(n$a=""),n$c.__super.call(this,n$a)}n$f(n$c,"laya.ui.TextArea",n$b);var n$a=n$c.prototype;return n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,n$a),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},n$a.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},n$a.onVBarChanged=function(n$a){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},n$a.onHBarChanged=function(n$a){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},n$a.changeScroll=function(){var n$a=this._vScrollBar&&0<this._tf.maxScrollY,n$b=this._hScrollBar&&0<this._tf.maxScrollX,n$c=n$a?this._width-this._vScrollBar.width:this._width,n$d=n$b?this._height-this._hScrollBar.height:this._height,n$e=this._tf.padding||n$D.labelPadding;this._tf.width=n$c,this._tf.height=n$d,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-n$e[2],this._vScrollBar.y=n$e[1],this._vScrollBar.height=this._height-(n$b?this._hScrollBar.height:0)-n$e[1]-n$e[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=n$d/Math.max(this._tf.textHeight,n$d),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=n$a),this._hScrollBar&&(this._hScrollBar.x=n$e[0],this._hScrollBar.y=this._height-this._hScrollBar.height-n$e[3],this._hScrollBar.width=this._width-(n$a?this._vScrollBar.width:0)-n$e[0]-n$e[2],this._hScrollBar.scrollSize=Math.max(.033*n$c,1),this._hScrollBar.thumbPercent=n$c/Math.max(this._tf.textWidth,n$c),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=n$b)},n$a.scrollTo=function(n$a){this.commitMeasure(),this._tf.scrollY=n$a},n$e(0,n$a,"scrollY",function(){return this._tf.scrollY}),n$e(0,n$a,"width",n$b.prototype._$get_width,function(n$a){n$p.superSet(n$ca,this,"width",n$a),this.callLater(this.changeScroll)}),n$e(0,n$a,"hScrollBar",function(){return this._hScrollBar}),n$e(0,n$a,"height",n$b.prototype._$get_height,function(n$a){n$p.superSet(n$ca,this,"height",n$a),this.callLater(this.changeScroll)}),n$e(0,n$a,"maxScrollX",function(){return this._tf.maxScrollX}),n$e(0,n$a,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(n$a){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new n$ba),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=n$a}),n$e(0,n$a,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(n$a){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new n$Y),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=n$a}),n$e(0,n$a,"vScrollBar",function(){return this._vScrollBar}),n$e(0,n$a,"maxScrollY",function(){return this._tf.maxScrollY}),n$e(0,n$a,"scrollX",function(){return this._tf.scrollX}),n$c}(n$ca);!function(n$a){function n$b(){this._uiView=null,this.isCloseOther=!1,n$b.__super.call(this)}n$f(n$b,"laya.ui.AsynDialog",n$ea);var n$c=n$b.prototype;n$c.createView=function(n$a){this._uiView=n$a},n$c._open=function(n$a,n$b,n$c){this.isModal=n$a,this.isCloseOther=n$b,n$ea.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},n$c.onCreated=function(){this.createUI(),this.onOpen()},n$c.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},n$c.onOpen=function(){n$ea.manager.open(this,this.isCloseOther),n$ea.manager.lock(!1)},n$c.close=function(n$a,n$b){void 0===n$b&&(n$b=!0),n$ea.manager.close(this),this.onClose()},n$c.onClose=function(){},n$c.destroy=function(n$a){void 0===n$a&&(n$a=!0),laya.ui.View.prototype.destroy.call(this,n$a),this._uiView=null,this.onDestroy()},n$c.onDestroy=function(){}}();n$p.__init([n$T])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(n$a,n$b){"use strict";for(var n$c in Object.defineProperty(n$b,"__esModule",{value:!0}),Laya){var n$d=Laya[n$c];n$d&&n$d.__isclass&&(n$b[n$c]=n$d)}}),function(n$m,n$a,n$v){n$v.un,n$v.uns;var n$l=n$v.static,n$n=n$v.class,n$o=n$v.getset,n$d=n$v.__newvec,n$u=laya.maths.Arith,n$g=laya.webgl.atlas.AtlasResourceManager,n$c=laya.webgl.shader.BaseShader,n$H=laya.utils.Browser,n$h=laya.webgl.utils.Buffer,n$w=laya.utils.Byte,n$e=laya.utils.ClassUtils,n$i=n$v.Config,n$f=(laya.events.Event,laya.events.EventDispatcher),n$D=laya.utils.Handler,n$r=laya.net.Loader,n$b=laya.net.LoaderManager,n$j=(laya.maths.MathUtil,laya.display.Node),n$p=laya.renders.Render,n$k=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),n$q=laya.resource.Resource,n$s=laya.utils.RunDriver,n$t=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),n$x=laya.display.Sprite,n$y=laya.utils.Stat,n$z=laya.utils.StringKey,n$E=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),n$C=laya.utils.Utils,n$F=laya.webgl.WebGL,n$G=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;n$v.interface("laya.d3.core.IClone"),n$v.interface("laya.d3.graphics.IVertex"),n$v.interface("laya.d3.core.render.IUpdate"),n$v.interface("laya.d3.core.scene.ITreeNode"),n$v.interface("laya.d3.core.render.IRenderable");(function(){function n$K(){}n$n(n$K,"laya.d3.animation.AnimationClipParser01"),n$K.READ_DATA=function(){n$K._DATA.offset=n$K._reader.getUint32(),n$K._DATA.size=n$K._reader.getUint32()},n$K.READ_BLOCK=function(){for(var n$a=n$K._BLOCK.count=n$K._reader.getUint16(),n$b=n$K._BLOCK.blockStarts=[],n$c=n$K._BLOCK.blockLengths=[],n$d=0;n$d<n$a;n$d++)n$b.push(n$K._reader.getUint32()),n$c.push(n$K._reader.getUint32())},n$K.READ_STRINGS=function(){var n$a=n$K._reader.getUint32(),n$b=n$K._reader.getUint16(),n$c=n$K._reader.pos;n$K._reader.pos=n$a+n$K._DATA.offset;for(var n$d=0;n$d<n$b;n$d++)n$K._strings[n$d]=n$K._reader.readUTFString();n$K._reader.pos=n$c},n$K.parse=function(n$a,n$b){n$K._animationClip=n$a;(n$K._reader=n$b).__getBuffer();n$K.READ_DATA(),n$K.READ_BLOCK(),n$K.READ_STRINGS();for(var n$c=0,n$d=n$K._BLOCK.count;n$c<n$d;n$c++){var n$e=n$b.getUint16(),n$f=n$K._strings[n$e],n$g=n$K["READ_"+n$f];if(null==n$g)throw new Error("model file err,no this function:"+n$e+" "+n$f);n$g.call()}},n$K.READ_ANIMATIONS=function(){var n$a,n$b=0,n$c=0,n$d=n$K._reader,n$e=n$d.__getBuffer(),n$f=[],n$g=n$d.getUint8();for(n$f.length=n$g,n$b=0;n$b<n$g;n$b++)n$f[n$b]=n$d.getUint16();var n$h=[],n$i=n$d.getUint16();for(n$h.length=n$i,n$b=0;n$b<n$i;n$b++)n$h[n$b]=n$d.getFloat32();var n$j=n$K._animationClip;n$j.name=n$K._strings[n$d.getUint16()];var n$k=n$j._duration=n$d.getFloat32();n$j.islooping=!!n$d.getByte(),n$j._frameRate=n$d.getInt16();var n$l=n$d.getInt16(),n$m=n$j._nodes=new Array;n$m.length=n$l,(n$j._publicClipDatas=[]).length=n$l;var n$n=n$j._nodesMap={},n$o=0,n$p=0;for(n$b=0;n$b<n$l;n$b++){n$a=n$m[n$b]=new n$S;var n$q=n$d.getUint16(),n$r=n$a.path=[];for(n$r.length=n$q,n$c=0;n$c<n$q;n$c++)n$r[n$c]=n$K._strings[n$d.getUint16()];var n$s=n$r.join("/"),n$t=n$n[n$s];n$t||(n$n[n$s]=n$t=[]),n$t.push(n$a);var n$u=n$d.getInt16();-1!==n$u&&(n$a.componentType=n$K._strings[n$u]);var n$v=n$Q._propertyIndexDic[n$K._strings[n$d.getUint16()]];if(null==n$v)throw new Error("AnimationClipParser01:unknown property name.");var n$w=n$v<4,n$x=!n$w||n$w&&""===n$r[0];(n$a._cacheProperty=n$x)?n$o++:n$p++,n$a.propertyNameID=n$v;var n$y=n$f[n$d.getUint8()];n$a.keyFrameWidth=n$y/4;var n$z=n$a.keyFrames=[],n$C=n$z.length=n$d.getUint16(),n$D=null,n$E=NaN;for(n$c=0;n$c<n$C;n$c++){var n$F=n$z[n$c]=new n$R;n$E=n$F.startTime=n$h[n$d.getUint16()];var n$G=n$d.pos;n$F.inTangent=new Float32Array(n$e.slice(n$G,n$G+n$y)),n$d.pos+=n$y,n$G=n$d.pos,n$F.outTangent=new Float32Array(n$e.slice(n$G,n$G+n$y)),n$d.pos+=n$y,n$G=n$d.pos,n$F.data=new Float32Array(n$e.slice(n$G,n$G+n$y)),n$d.pos+=n$y,n$D&&(n$D.next=n$F,n$D.duration=n$E-n$D.startTime),n$D=n$F}n$F.next=null,n$F.duration=n$k-n$E}var n$H=n$j._nodeToCachePropertyMap=new Int32Array(n$l),n$I=n$j._cachePropertyMap=new Int32Array(n$o),n$J=n$j._unCachePropertyMap=new Int32Array(n$p);for(n$o=n$p=0,n$b=0;n$b<n$l;n$b++)(n$a=n$m[n$b])._cacheProperty?(n$H[n$b]=n$o,n$I[n$o++]=n$b):n$J[n$p++]=n$b},n$K._animationClip=null,n$K._reader=null,n$K._strings=[],n$l(n$K,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function n$O(){}n$n(n$O,"laya.d3.animation.AnimationClipParser02"),n$O.READ_DATA=function(){n$O._DATA.offset=n$O._reader.getUint32(),n$O._DATA.size=n$O._reader.getUint32()},n$O.READ_BLOCK=function(){for(var n$a=n$O._BLOCK.count=n$O._reader.getUint16(),n$b=n$O._BLOCK.blockStarts=[],n$c=n$O._BLOCK.blockLengths=[],n$d=0;n$d<n$a;n$d++)n$b.push(n$O._reader.getUint32()),n$c.push(n$O._reader.getUint32())},n$O.READ_STRINGS=function(){var n$a=n$O._reader.getUint32(),n$b=n$O._reader.getUint16(),n$c=n$O._reader.pos;n$O._reader.pos=n$a+n$O._DATA.offset;for(var n$d=0;n$d<n$b;n$d++)n$O._strings[n$d]=n$O._reader.readUTFString();n$O._reader.pos=n$c},n$O.parse=function(n$a,n$b){n$O._animationClip=n$a;(n$O._reader=n$b).__getBuffer();n$O.READ_DATA(),n$O.READ_BLOCK(),n$O.READ_STRINGS();for(var n$c=0,n$d=n$O._BLOCK.count;n$c<n$d;n$c++){var n$e=n$b.getUint16(),n$f=n$O._strings[n$e],n$g=n$O["READ_"+n$f];if(null==n$g)throw new Error("model file err,no this function:"+n$e+" "+n$f);n$g.call()}},n$O.READ_ANIMATIONS=function(){var n$a,n$b=0,n$c=0,n$d=n$O._reader,n$e=n$d.__getBuffer(),n$f=[],n$g=n$d.getUint8();for(n$f.length=n$g,n$b=0;n$b<n$g;n$b++)n$f[n$b]=n$d.getUint16();var n$h=[],n$i=n$d.getUint16();for(n$h.length=n$i,n$b=0;n$b<n$i;n$b++)n$h[n$b]=n$d.getFloat32();var n$j=n$O._animationClip;n$j.name=n$O._strings[n$d.getUint16()];var n$k=n$j._duration=n$d.getFloat32();n$j.islooping=!!n$d.getByte(),n$j._frameRate=n$d.getInt16();var n$l=n$d.getInt16(),n$m=n$j._nodes=new Array;n$m.length=n$l,(n$j._publicClipDatas=[]).length=n$l;var n$n=n$j._nodesMap={},n$o=0,n$p=0;for(n$b=0;n$b<n$l;n$b++){n$a=n$m[n$b]=new n$S;var n$q=n$d.getUint16(),n$r=n$a.path=[];for(n$r.length=n$q,n$c=0;n$c<n$q;n$c++)n$r[n$c]=n$O._strings[n$d.getUint16()];var n$s=n$r.join("/"),n$t=n$n[n$s];n$t||(n$n[n$s]=n$t=[]),n$t.push(n$a);var n$u=n$d.getInt16();-1!==n$u&&(n$a.componentType=n$O._strings[n$u]);var n$v=n$Q._propertyIndexDic[n$O._strings[n$d.getUint16()]];if(null==n$v)throw new Error("AnimationClipParser02:unknown property name.");var n$w=n$v<4,n$x=!n$w||n$w&&""===n$r[0];(n$a._cacheProperty=n$x)?n$o++:n$p++,n$a.propertyNameID=n$v;var n$y=n$f[n$d.getUint8()];n$a.keyFrameWidth=n$y/4;var n$z=n$a.keyFrames=[],n$C=n$z.length=n$d.getUint16(),n$D=null,n$E=NaN;for(n$c=0;n$c<n$C;n$c++){var n$F=n$z[n$c]=new n$R;n$E=n$F.startTime=n$h[n$d.getUint16()];var n$G=n$d.pos;n$F.inTangent=new Float32Array(n$e.slice(n$G,n$G+n$y)),n$d.pos+=n$y,n$G=n$d.pos,n$F.outTangent=new Float32Array(n$e.slice(n$G,n$G+n$y)),n$d.pos+=n$y,n$G=n$d.pos,n$F.data=new Float32Array(n$e.slice(n$G,n$G+n$y)),n$d.pos+=n$y,n$D&&(n$D.next=n$F,n$D.duration=n$E-n$D.startTime),n$D=n$F}n$F.next=null,n$F.duration=n$k-n$E}var n$H=n$d.getUint16();for(n$b=0;n$b<n$H;n$b++){var n$I,n$J=new n$P;n$J.time=n$d.getFloat32(),n$J.eventName=n$O._strings[n$d.getUint16()];var n$K=n$d.getUint16();for(0<n$K&&(n$J.params=n$I=[]),n$c=0;n$c<n$K;n$c++){switch(n$d.getByte()){case 0:n$I.push(!!n$d.getByte());break;case 1:n$I.push(n$d.getInt32());break;case 2:n$I.push(n$d.getFloat32());break;case 3:n$I.push(n$O._strings[n$d.getUint16()]);break;default:throw new Error("unknown type.")}}n$j.addEvent(n$J)}var n$L=n$j._nodeToCachePropertyMap=new Int32Array(n$l),n$M=n$j._cachePropertyMap=new Int32Array(n$o),n$N=n$j._unCachePropertyMap=new Int32Array(n$p);for(n$o=n$p=0,n$b=0;n$b<n$l;n$b++)(n$a=n$m[n$b])._cacheProperty?(n$L[n$b]=n$o,n$M[n$o++]=n$b):n$N[n$p++]=n$b},n$O._animationClip=null,n$O._reader=null,n$O._strings=[],n$l(n$O,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var n$P=function(){function n$a(){this.time=NaN,this.eventName=null,this.params=null}return n$n(n$a,"laya.d3.animation.AnimationEvent"),n$a}(),n$Q=function(){function n$d(){this._childs=[],this.transform=new n$sb(this)}n$n(n$d,"laya.d3.animation.AnimationNode");var n$a=n$d.prototype;return n$v.imps(n$a,{"laya.d3.core.IClone":!0}),n$a.addChild=function(n$a){n$a._parent=this,n$a.transform.setParent(this.transform),this._childs.push(n$a)},n$a.removeChild=function(n$a){var n$b=this._childs.indexOf(n$a);-1!==n$b&&this._childs.splice(n$b,1)},n$a.getChildByName=function(n$a){for(var n$b=0,n$c=this._childs.length;n$b<n$c;n$b++){var n$d=this._childs[n$b];if(n$d.name===n$a)return n$d}return null},n$a.getChildByIndex=function(n$a){return this._childs[n$a]},n$a.getChildCount=function(){return this._childs.length},n$a.cloneTo=function(n$a){var n$b=n$a;n$b.name=this.name;for(var n$c=0,n$d=this._childs.length;n$c<n$d;n$c++){var n$e=this._childs[n$c],n$f=n$e.clone();n$b.addChild(n$f);var n$g=n$e.transform,n$h=n$f.transform;n$h.setLocalPosition(n$g.getLocalPosition()),n$h.setLocalRotation(n$g.getLocalRotation()),n$h.setLocalScale(n$g.getLocalScale()),n$h._localRotationEuler=n$g._localRotationEuler,n$h._setWorldMatrixIgnoreUpdate(n$g.getWorldMatrix())}},n$a.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$d.__init__=function(){n$d.registerAnimationNodeProperty("localPosition",n$d._getLocalPosition,n$d._setLocalPosition),n$d.registerAnimationNodeProperty("localRotation",n$d._getLocalRotation,n$d._setLocalRotation),n$d.registerAnimationNodeProperty("localScale",n$d._getLocalScale,n$d._setLocalScale),n$d.registerAnimationNodeProperty("localRotationEuler",n$d._getLocalRotationEuler,n$d._setLocalRotationEuler),n$d.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",n$d._getParticleRenderSharedMaterialTintColor,n$d._setParticleRenderSharedMaterialTintColor),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",n$d._getMeshRenderSharedMaterialTilingOffset,n$d._setMeshRenderSharedMaterialTilingOffset),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",n$d._getMeshRenderSharedMaterialAlbedo,n$d._setMeshRenderSharedMaterialAlbedo),n$d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",n$d._getSkinnedMeshRenderSharedMaterialTilingOffset,n$d._setSkinnedMeshRenderSharedMaterialTilingOffset),n$d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",n$d._getSkinnedMeshRenderSharedMaterialAlbedo,n$d._setSkinnedMeshRenderSharedMaterialAlbedo),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",n$d._getMeshRenderSharedMaterialAlbedo,n$d._setMeshRenderSharedMaterialAlbedo),n$d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",n$d._getSkinnedMeshRenderSharedMaterialAlbedo,n$d._setSkinnedMeshRenderSharedMaterialAlbedo),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",n$d._getMeshRenderSharedMaterialIntensity,n$d._setMeshRenderSharedMaterialIntensity),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",n$d._getMeshRenderSharedMaterialAlpha,n$d._setMeshRenderSharedMaterialAlpha),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",n$d._getMeshRenderSharedMaterialAlphaColor,n$d._setMeshRenderSharedMaterialAlphaColor),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",n$d._getMeshRenderSharedMaterialBaseColor,n$d._setMeshRenderSharedMaterialBaseColor),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",n$d._getMeshRenderSharedMaterialDissolve,n$d._setMeshRenderSharedMaterialDissolve),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",n$d._getMeshRenderSharedMaterialDissolveSpeed,n$d._setMeshRenderSharedMaterialDissolveSpeed),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",n$d._getMeshRenderSharedMaterialMMultiplier,n$d._setMeshRenderSharedMaterialMMultiplier),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",n$d._getMeshRenderSharedMaterialBaseScrollSpeedX,n$d._setMeshRenderSharedMaterialBaseScrollSpeedX),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",n$d._getMeshRenderSharedMaterialBaseScrollSpeedY,n$d._setMeshRenderSharedMaterialBaseScrollSpeedY),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",n$d._getMeshRenderSharedMaterialSecondScrollSpeedX,n$d._setMeshRenderSharedMaterialSecondScrollSpeedX),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",n$d._getMeshRenderSharedMaterialSecondScrollSpeedY,n$d._setMeshRenderSharedMaterialSecondScrollSpeedY),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",n$d._getMeshRenderSharedMaterialDetailTilingOffset,n$d._setMeshRenderSharedMaterialDetailTilingOffset),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",n$d._getMeshRenderSharedMaterialDissolveTilingOffset,n$d._setMeshRenderSharedMaterialDissolveTilingOffset),n$d.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",n$d._getMeshRenderSharedMaterialMaskTilingOffset,n$d._setMeshRenderSharedMaterialMaskTilingOffset)},n$d.registerAnimationNodeProperty=function(n$a,n$b,n$c){if(n$d._propertyIndexDic[n$a])throw new Error("AnimationNode: this propertyName has registered.");n$d._propertyIndexDic[n$a]=n$d._propertyIDCounter,n$d._propertyGetFuncs[n$d._propertyIDCounter]=n$b,n$d._propertySetFuncs[n$d._propertyIDCounter]=n$c,n$d._propertyIDCounter++},n$d._getLocalPosition=function(n$a,n$b){return n$a?n$a.transform.getLocalPosition():n$b._transform.localPosition.elements},n$d._setLocalPosition=function(n$a,n$b,n$c){if(n$a)n$a.transform.setLocalPosition(n$c);else{var n$d=n$b._transform,n$e=n$d.localPosition;n$e.elements=n$c,n$d.localPosition=n$e}},n$d._getLocalRotation=function(n$a,n$b){return n$a?n$a.transform.getLocalRotation():n$b._transform.localRotation.elements},n$d._setLocalRotation=function(n$a,n$b,n$c){if(n$a)n$a.transform.setLocalRotation(n$c);else{var n$d=n$b._transform,n$e=n$d.localRotation;n$e.elements=n$c,n$d.localRotation=n$e}},n$d._getLocalScale=function(n$a,n$b){return n$a?n$a.transform.getLocalScale():n$b._transform.localScale.elements},n$d._setLocalScale=function(n$a,n$b,n$c){if(n$a)n$a.transform.setLocalScale(n$c);else{var n$d=n$b._transform,n$e=n$d.localScale;n$e.elements=n$c,n$d.localScale=n$e}},n$d._getLocalRotationEuler=function(n$a,n$b){return n$a?n$a.transform.getLocalRotationEuler():n$b._transform.localRotationEuler.elements},n$d._setLocalRotationEuler=function(n$a,n$b,n$c){if(n$a)n$a.transform.setLocalRotationEuler(n$c);else{var n$d=n$b._transform,n$e=n$d.localRotationEuler;n$e.elements=n$c,n$d.localRotationEuler=n$e}},n$d._getMeshRenderSharedMaterialTilingOffset=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return n$b.meshRender.sharedMaterial.tilingOffset.elements},n$d._setMeshRenderSharedMaterialTilingOffset=function(n$a,n$b,n$c){var n$d,n$e;if(n$a){var n$f=n$a.transform._entity;n$f&&((n$e=(n$d=n$f.owner.meshRender.material).tilingOffset).elements=n$c,n$d.tilingOffset=n$e)}else(n$e=(n$d=n$b.meshRender.material).tilingOffset).elements=n$c,n$d.tilingOffset=n$e},n$d._getMeshRenderSharedMaterialAlbedo=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.albedoColor.elements:null}return n$b.meshRender.sharedMaterial.albedoColor.elements},n$d._setMeshRenderSharedMaterialAlbedo=function(n$a,n$b,n$c){var n$d,n$e;if(n$a){var n$f=n$a.transform._entity;n$f&&((n$e=(n$d=n$f.owner.meshRender.material).albedoColor).elements=n$c,n$d.albedoColor=n$e)}else(n$e=(n$d=n$b.meshRender.material).albedoColor).elements=n$c,n$d.albedoColor=n$e},n$d._getSkinnedMeshRenderSharedMaterialTilingOffset=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return n$b.skinnedMeshRender.sharedMaterial.tilingOffset.elements},n$d._setSkinnedMeshRenderSharedMaterialTilingOffset=function(n$a,n$b,n$c){var n$d,n$e;if(n$a){var n$f=n$a.transform._entity;n$f&&((n$e=(n$d=n$f.owner.skinnedMeshRender.material).tilingOffset).elements=n$c,n$d.tilingOffset=n$e)}else(n$e=(n$d=n$b.skinnedMeshRender.material).tilingOffset).elements=n$c,n$d.tilingOffset=n$e},n$d._getSkinnedMeshRenderSharedMaterialAlbedo=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return n$b.skinnedMeshRender.sharedMaterial.albedoColor.elements},n$d._setSkinnedMeshRenderSharedMaterialAlbedo=function(n$a,n$b,n$c){var n$d,n$e;if(n$a){var n$f=n$a.transform._entity;n$f&&((n$e=(n$d=n$f.owner.skinnedMeshRender.material).albedoColor).elements=n$c,n$d.albedoColor=n$e)}else(n$e=(n$d=n$b.skinnedMeshRender.material).albedoColor).elements=n$c,n$d.albedoColor=n$e},n$d._getParticleRenderSharedMaterialTintColor=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.particleRender.sharedMaterial.tintColor.elements:null}return n$b.particleRender.sharedMaterial.tintColor.elements},n$d._setParticleRenderSharedMaterialTintColor=function(n$a,n$b,n$c){var n$d,n$e;if(n$a){var n$f=n$a.transform._entity;n$f&&((n$e=(n$d=n$f.owner.particleRender.material).tintColor).elements=n$c,n$d.tintColor=n$e)}else(n$e=(n$d=n$b.particleRender.material).tintColor).elements=n$c,n$d.tintColor=n$e},n$d._getMeshRenderSharedMaterialAlphaColor=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.alphaColor.elements:null}return n$b.meshRender.sharedMaterial.alphaColor.elements},n$d._setMeshRenderSharedMaterialAlphaColor=function(n$a,n$b,n$c){var n$d,n$e;if(n$a){var n$f=n$a.transform._entity;n$f&&((n$e=(n$d=n$f.owner.meshRender.material).alphaColor).elements=n$c,n$d.alphaColor=n$e)}else(n$e=(n$d=n$b.meshRender.material).alphaColor).elements=n$c,n$d.alphaColor=n$e},n$d._getMeshRenderSharedMaterialBaseColor=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.baseColor.elements:null}return n$b.meshRender.sharedMaterial.baseColor.elements},n$d._setMeshRenderSharedMaterialBaseColor=function(n$a,n$b,n$c){var n$d,n$e;if(n$a){var n$f=n$a.transform._entity;n$f&&((n$e=(n$d=n$f.owner.meshRender.material).baseColor).elements=n$c,n$d.baseColor=n$e)}else(n$e=(n$d=n$b.meshRender.material).baseColor).elements=n$c,n$d.baseColor=n$e},n$d._getMeshRenderSharedMaterialDissolve=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.dissolve:0}return n$b.meshRender.sharedMaterial.dissolve},n$d._setMeshRenderSharedMaterialDissolve=function(n$a,n$b,n$c){if(n$a){var n$d=n$a.transform._entity;n$d&&(n$d.owner.meshRender.material.dissolve=n$c[0])}else n$b.meshRender.material.dissolve=n$c[0]},n$d._getMeshRenderSharedMaterialDissolveSpeed=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.dissolveSpeed:0}return n$b.meshRender.sharedMaterial.dissolveSpeed},n$d._setMeshRenderSharedMaterialDissolveSpeed=function(n$a,n$b,n$c){if(n$a){var n$d=n$a.transform._entity;n$d&&(n$d.owner.meshRender.material.dissolveSpeed=n$c[0])}else n$b.meshRender.material.dissolveSpeed=n$c[0]},n$d._getMeshRenderSharedMaterialMMultiplier=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.mMultiplier:0}return n$b.meshRender.sharedMaterial.mMultiplier},n$d._setMeshRenderSharedMaterialMMultiplier=function(n$a,n$b,n$c){if(n$a){var n$d=n$a.transform._entity;n$d&&(n$d.owner.meshRender.material.mMultiplier=n$c[0])}else n$b.meshRender.material.mMultiplier=n$c[0]},n$d._getMeshRenderSharedMaterialBaseScrollSpeedX=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return n$b.meshRender.sharedMaterial.baseScrollSpeedX},n$d._setMeshRenderSharedMaterialBaseScrollSpeedX=function(n$a,n$b,n$c){if(n$a){var n$d=n$a.transform._entity;n$d&&(n$d.owner.meshRender.material.baseScrollSpeedX=n$c[0])}else n$b.meshRender.material.baseScrollSpeedX=n$c[0]},n$d._getMeshRenderSharedMaterialBaseScrollSpeedY=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return n$b.meshRender.sharedMaterial.baseScrollSpeedY},n$d._setMeshRenderSharedMaterialBaseScrollSpeedY=function(n$a,n$b,n$c){if(n$a){var n$d=n$a.transform._entity;n$d&&(n$d.owner.meshRender.material.baseScrollSpeedY=n$c[0])}else n$b.meshRender.material.baseScrollSpeedY=n$c[0]},n$d._getMeshRenderSharedMaterialSecondScrollSpeedX=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return n$b.meshRender.sharedMaterial.secondScrollSpeedX},n$d._setMeshRenderSharedMaterialSecondScrollSpeedX=function(n$a,n$b,n$c){if(n$a){var n$d=n$a.transform._entity;n$d&&(n$d.owner.meshRender.material.secondScrollSpeedX=n$c[0])}else n$b.meshRender.material.secondScrollSpeedX=n$c[0]},n$d._getMeshRenderSharedMaterialSecondScrollSpeedY=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return n$b.meshRender.sharedMaterial.secondScrollSpeedY},n$d._setMeshRenderSharedMaterialSecondScrollSpeedY=function(n$a,n$b,n$c){if(n$a){var n$d=n$a.transform._entity;n$d&&(n$d.owner.meshRender.material.secondScrollSpeedY=n$c[0])}else n$b.meshRender.material.secondScrollSpeedY=n$c[0]},n$d._getMeshRenderSharedMaterialAlpha=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.alpha:0}return n$b.meshRender.sharedMaterial.alpha},n$d._setMeshRenderSharedMaterialAlpha=function(n$a,n$b,n$c){if(n$a){var n$d=n$a.transform._entity;n$d&&(n$d.owner.meshRender.material.alpha=n$c[0])}else n$b.meshRender.material.alpha=n$c[0]},n$d._getMeshRenderSharedMaterialIntensity=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.intensity:0}return n$b.meshRender.sharedMaterial.intensity},n$d._setMeshRenderSharedMaterialIntensity=function(n$a,n$b,n$c){if(n$a){var n$d=n$a.transform._entity;n$d&&(n$d.owner.meshRender.material.intensity=n$c[0])}else n$b.meshRender.material.intensity=n$c[0]},n$d._getMeshRenderSharedMaterialDetailTilingOffset=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return n$b.meshRender.sharedMaterial.detailTilingOffset.elements},n$d._setMeshRenderSharedMaterialDetailTilingOffset=function(n$a,n$b,n$c){var n$d,n$e;if(n$a){var n$f=n$a.transform._entity;n$f&&((n$e=(n$d=n$f.owner.meshRender.material).detailTilingOffset).elements=n$c,n$d.detailTilingOffset=n$e)}else(n$e=(n$d=n$b.meshRender.material).detailTilingOffset).elements=n$c,n$d.detailTilingOffset=n$e},n$d._getMeshRenderSharedMaterialDissolveTilingOffset=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return n$b.meshRender.sharedMaterial.dissolveTilingOffset.elements},n$d._setMeshRenderSharedMaterialDissolveTilingOffset=function(n$a,n$b,n$c){var n$d,n$e;if(n$a){var n$f=n$a.transform._entity;n$f&&((n$e=(n$d=n$f.owner.meshRender.material).dissolveTilingOffset).elements=n$c,n$d.dissolveTilingOffset=n$e)}else(n$e=(n$d=n$b.meshRender.material).dissolveTilingOffset).elements=n$c,n$d.dissolveTilingOffset=n$e},n$d._getMeshRenderSharedMaterialMaskTilingOffset=function(n$a,n$b){if(n$a){var n$c=n$a.transform._entity;return n$c?n$c.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return n$b.meshRender.sharedMaterial.maskTilingOffset.elements},n$d._setMeshRenderSharedMaterialMaskTilingOffset=function(n$a,n$b,n$c){var n$d,n$e;if(n$a){var n$f=n$a.transform._entity;n$f&&((n$e=(n$d=n$f.owner.meshRender.material).maskTilingOffset).elements=n$c,n$d.maskTilingOffset=n$e)}else(n$e=(n$d=n$b.meshRender.material).maskTilingOffset).elements=n$c,n$d.maskTilingOffset=n$e},n$d._propertyIDCounter=0,n$d._propertyIndexDic={},n$d._propertySetFuncs=[],n$d._propertyGetFuncs=[],n$d}(),n$R=function(){function n$a(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return n$n(n$a,"laya.d3.animation.Keyframe"),n$a}(),n$S=function(){function n$a(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return n$n(n$a,"laya.d3.animation.KeyframeNode"),n$a}(),n$I=(function(){function n$a(){this._tempVector30=new n$gb,this._tempVector31=new n$gb,this._tempVector32=new n$gb,this._a=new n$gb,this._b=new n$gb,this._c=new n$gb,this._d=new n$gb}n$n(n$a,"laya.d3.core.glitter.SplineCurvePositionVelocity");var n$b=n$a.prototype;n$b.Init=function(n$a,n$b,n$c,n$d){n$a.cloneTo(this._d),n$b.cloneTo(this._c),n$gb.scale(n$a,2,this._a),n$gb.scale(n$c,2,this._tempVector30),n$gb.subtract(this._a,this._tempVector30,this._a),n$gb.add(this._a,n$b,this._a),n$gb.add(this._a,n$d,this._a),n$gb.scale(n$c,3,this._b),n$gb.scale(n$a,3,this._tempVector30),n$gb.subtract(this._b,this._tempVector30,this._b),n$gb.subtract(this._b,n$d,this._b),n$gb.scale(n$b,2,this._tempVector30),n$gb.subtract(this._b,this._tempVector30,this._b)},n$b.Slerp=function(n$a,n$b){n$gb.scale(this._a,n$a*n$a*n$a,this._tempVector30),n$gb.scale(this._b,n$a*n$a,this._tempVector31),n$gb.scale(this._c,n$a,this._tempVector32),n$gb.add(this._tempVector30,this._tempVector31,n$b),n$gb.add(n$b,this._tempVector32,n$b),n$gb.add(n$b,this._d,n$b)}}(),function(){function n$M(n$a,n$b,n$c,n$d){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=n$a,this._h=n$b,this._minHeight=n$c,this._maxHeight=n$d}n$n(n$M,"laya.d3.core.HeightMap");var n$a=n$M.prototype;n$a._inBounds=function(n$a,n$b){return 0<=n$a&&n$a<this._h&&0<=n$b&&n$b<this._w},n$a.getHeight=function(n$a,n$b){return this._inBounds(n$a,n$b)?this._datas[n$a][n$b]:NaN},n$o(0,n$a,"width",function(){return this._w}),n$o(0,n$a,"height",function(){return this._h}),n$o(0,n$a,"maxHeight",function(){return this._maxHeight}),n$o(0,n$a,"minHeight",function(){return this._minHeight}),n$M.creatFromMesh=function(n$a,n$b,n$c,n$d){for(var n$e=[],n$f=[],n$g=n$a.getSubMeshCount(),n$h=0;n$h<n$g;n$h++){for(var n$i=n$a.getSubMesh(n$h),n$j=n$i._getVertexBuffer(),n$k=n$j.getData(),n$l=[],n$m=0;n$m<n$k.length;n$m+=n$j.vertexDeclaration.vertexStride/4){var n$n=new n$gb(n$k[n$m+0],n$k[n$m+1],n$k[n$m+2]);n$l.push(n$n)}n$e.push(n$l);var n$o=n$i._getIndexBuffer();n$f.push(n$o.getData())}var n$p=n$a.boundingBox,n$q=n$p.min.x,n$r=n$p.min.z,n$s=n$p.max.x,n$t=n$p.max.z,n$u=n$p.min.y,n$v=n$p.max.y,n$w=n$s-n$q,n$x=n$t-n$r,n$y=n$d.elements[0]=n$w/(n$b-1),n$z=n$d.elements[1]=n$x/(n$c-1),n$C=new n$M(n$b,n$c,n$u,n$v),n$D=n$M._tempRay,n$E=n$D.direction.elements;n$E[0]=0,n$E[1]=-1,n$E[2]=0;var n$F=n$v+.1;n$D.origin.elements[1]=n$F;for(var n$G=0;n$G<n$c;n$G++){var n$H=n$r+n$G*n$z;n$C._datas[n$G]=[];for(var n$I=0;n$I<n$b;n$I++){var n$J=n$q+n$I*n$y,n$K=n$D.origin.elements;n$K[0]=n$J,n$K[2]=n$H;var n$L=n$M._getPosition(n$D,n$e,n$f);n$C._datas[n$G][n$I]=n$L===Number.MAX_VALUE?NaN:n$F-n$L}}return n$C},n$M.createFromImage=function(n$a,n$b,n$c){for(var n$d=n$a.width,n$e=n$a.height,n$f=new n$M(n$d,n$e,n$b,n$c),n$g=(n$c-n$b)/254,n$h=n$a.getPixels(),n$i=0,n$j=0;n$j<n$e;n$j++)for(var n$k=n$f._datas[n$j]=[],n$l=0;n$l<n$d;n$l++){var n$m=n$h[n$i++],n$n=n$h[n$i++],n$o=n$h[n$i++],n$p=n$h[n$i++];n$k[n$l]=255==n$m&&255==n$n&&255==n$o&&255==n$p?NaN:(n$m+n$n+n$o)/3*n$g+n$b}return n$f},n$M._getPosition=function(n$a,n$b,n$c){for(var n$d=Number.MAX_VALUE,n$e=0;n$e<n$b.length;n$e++)for(var n$f=n$b[n$e],n$g=n$c[n$e],n$h=0;n$h<n$g.length;n$h+=3){var n$i=n$f[n$g[n$h+0]],n$j=n$f[n$g[n$h+1]],n$k=n$f[n$g[n$h+2]],n$l=n$ob.rayIntersectsTriangle(n$a,n$i,n$j,n$k);!isNaN(n$l)&&n$l<n$d&&(n$d=n$l)}return n$d},n$l(n$M,["_tempRay",function(){return this._tempRay=new n$eb(new n$gb,new n$gb)}])}(),function(){function n$e(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}n$n(n$e,"laya.d3.core.Layer");var n$a=n$e.prototype;return n$a._binarySearchIndex=function(){for(var n$a=0,n$b=n$e._collsionTestList.length-1,n$c=0;n$a<=n$b;){n$c=Math.floor((n$a+n$b)/2);var n$d=n$e._collsionTestList[n$c];if(n$d==this._number)return n$c;n$d>this._number?n$b=n$c-1:n$a=n$c+1}return n$a},n$a._addCollider=function(n$a){0===this._colliders.length&&n$e._collsionTestList.splice(this._binarySearchIndex(),0,this._number),n$a._isRigidbody?(this._colliders.unshift(n$a),this._nonRigidbodyOffset++):this._colliders.push(n$a)},n$a._removeCollider=function(n$a){var n$b=this._colliders.indexOf(n$a);n$b<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(n$b,1),0===this._colliders.length&&n$e._collsionTestList.splice(n$e._collsionTestList.indexOf(this._number),1)},n$o(0,n$a,"number",function(){return this._number}),n$o(0,n$a,"visible",function(){return this._visible},function(n$a){this._visible=n$a,n$e._visibleLayers=n$a?n$e._visibleLayers|this.mask:n$e._visibleLayers&~this.mask}),n$o(0,n$a,"mask",function(){return this._mask}),n$o(1,n$e,"visibleLayers",function(){return n$e._visibleLayers},function(n$a){n$e._visibleLayers=n$a;for(var n$b=0,n$c=n$e._layerList.length;n$b<n$c;n$b++){var n$d=n$e._layerList[n$b];n$d._visible=0!=(n$d._mask&n$e._visibleLayers)}}),n$e.__init__=function(){n$e._layerList.length=31;for(var n$a=0;n$a<31;n$a++){var n$b=new n$e;n$e._layerList[n$a]=n$b,0===n$a?(n$b.name="Default Layer",n$b.visible=!0):(n$b.name="Layer-"+n$a,n$b.visible=!1),n$b._number=n$a,n$b._mask=Math.pow(2,n$a)}n$e.currentCreationLayer=n$e._layerList[0]},n$e.getLayerByNumber=function(n$a){if(n$a<0||30<n$a)throw new Error("无法返回指定Layer，该number超出范围！");return n$e._layerList[n$a]},n$e.getLayerByName=function(n$a){for(var n$b=0;n$b<31;n$b++)if(n$e._layerList[n$b].name===n$a)return n$e._layerList[n$b];throw new Error("无法返回指定Layer,该name不存在")},n$e.isVisible=function(n$a){return 0!=(n$a&n$e._currentCameraCullingMask&n$e._visibleLayers)},n$e._layerList=[],n$e._visibleLayers=2147483647,n$e._collsionTestList=[],n$e._currentCameraCullingMask=2147483647,n$e.maxCount=31,n$e.currentCreationLayer=null,n$e}()),n$J=(function(){function n$a(n$a,n$b,n$c){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=n$a,this._minCount=n$b,this._maxCount=n$c}n$n(n$a,"laya.d3.core.particleShuriKen.module.Burst");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b.cloneTo=function(n$a){var n$b=n$a;n$b._time=this._time,n$b._minCount=this._minCount,n$b._maxCount=this._maxCount},n$b.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$b,"time",function(){return this._time}),n$o(0,n$b,"minCount",function(){return this._minCount}),n$o(0,n$b,"maxCount",function(){return this._maxCount})}(),function(){function n$a(n$a){this._color=null,this.enbale=!1,this._color=n$a}n$n(n$a,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var n$b=n$a.prototype;n$b.cloneTo=function(n$a){var n$b=n$a;this._color.cloneTo(n$b._color),n$b.enbale=this.enbale},n$b.clone=function(){var n$a;switch(this._color.type){case 0:n$a=n$L.createByConstant(this._color.constant.clone());break;case 1:n$a=n$L.createByGradient(this._color.gradient.clone());break;case 2:n$a=n$L.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:n$a=n$L.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var n$b=new this.constructor(n$a);return n$b.enbale=this.enbale,n$b},n$o(0,n$b,"color",function(){return this._color})}(),function(){function n$a(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}n$n(n$a,"laya.d3.core.particleShuriKen.module.Emission");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),n$b._destroy=function(){this._bursts=null,this._destroyed=!0},n$b.getBurstsCount=function(){return this._bursts.length},n$b.getBurstByIndex=function(n$a){return this._bursts[n$a]},n$b.addBurst=function(n$a){var n$b=this._bursts.length;if(0<n$b)for(var n$c=0;n$c<n$b;n$c++)this._bursts[n$c].time>n$a.time&&this._bursts.splice(n$c,0,n$a);this._bursts.push(n$a)},n$b.removeBurst=function(n$a){var n$b=this._bursts.indexOf(n$a);-1!==n$b&&this._bursts.splice(n$b,1)},n$b.removeBurstByIndex=function(n$a){this._bursts.splice(n$a,1)},n$b.clearBurst=function(){this._bursts.length=0},n$b.cloneTo=function(n$a){var n$b=n$a,n$c=n$b._bursts;n$c.length=this._bursts.length;for(var n$d=0,n$e=this._bursts.length;n$d<n$e;n$d++){var n$f=n$c[n$d];n$f?this._bursts[n$d].cloneTo(n$f):n$c[n$d]=this._bursts[n$d].clone()}n$b._emissionRate=this._emissionRate,n$b.enbale=this.enbale},n$b.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$b,"destroyed",function(){return this._destroyed}),n$o(0,n$b,"emissionRate",function(){return this._emissionRate},function(n$a){if(n$a<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=n$a})}(),function(){function n$d(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}n$n(n$d,"laya.d3.core.particleShuriKen.module.FrameOverTime");var n$a=n$d.prototype;return n$v.imps(n$a,{"laya.d3.core.IClone":!0}),n$a.cloneTo=function(n$a){var n$b=n$a;n$b._type=this._type,n$b._constant=this._constant,this._overTime.cloneTo(n$b._overTime),n$b._constantMin=this._constantMin,n$b._constantMax=this._constantMax,this._overTimeMin.cloneTo(n$b._overTimeMin),this._overTimeMax.cloneTo(n$b._overTimeMax)},n$a.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$a,"frameOverTimeData",function(){return this._overTime}),n$o(0,n$a,"constant",function(){return this._constant}),n$o(0,n$a,"type",function(){return this._type}),n$o(0,n$a,"frameOverTimeDataMin",function(){return this._overTimeMin}),n$o(0,n$a,"constantMin",function(){return this._constantMin}),n$o(0,n$a,"frameOverTimeDataMax",function(){return this._overTimeMax}),n$o(0,n$a,"constantMax",function(){return this._constantMax}),n$d.createByConstant=function(n$a){var n$b=new n$d;return n$b._type=0,n$b._constant=n$a,n$b},n$d.createByOverTime=function(n$a){var n$b=new n$d;return n$b._type=1,n$b._overTime=n$a,n$b},n$d.createByRandomTwoConstant=function(n$a,n$b){var n$c=new n$d;return n$c._type=2,n$c._constantMin=n$a,n$c._constantMax=n$b,n$c},n$d.createByRandomTwoOverTime=function(n$a,n$b){var n$c=new n$d;return n$c._type=3,n$c._overTimeMin=n$a,n$c._overTimeMax=n$b,n$c},n$d}()),n$K=function(){function n$j(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}n$n(n$j,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var n$a=n$j.prototype;return n$v.imps(n$a,{"laya.d3.core.IClone":!0}),n$a.cloneTo=function(n$a){var n$b=n$a;n$b._type=this._type,n$b._separateAxes=this._separateAxes,n$b._constant=this._constant,this._constantSeparate.cloneTo(n$b._constantSeparate),this._gradient.cloneTo(n$b._gradient),this._gradientX.cloneTo(n$b._gradientX),this._gradientY.cloneTo(n$b._gradientY),this._gradientZ.cloneTo(n$b._gradientZ),n$b._constantMin=this._constantMin,n$b._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(n$b._constantMinSeparate),this._constantMaxSeparate.cloneTo(n$b._constantMaxSeparate),this._gradientMin.cloneTo(n$b._gradientMin),this._gradientMax.cloneTo(n$b._gradientMax),this._gradientXMin.cloneTo(n$b._gradientXMin),this._gradientXMax.cloneTo(n$b._gradientXMax),this._gradientYMin.cloneTo(n$b._gradientYMin),this._gradientYMax.cloneTo(n$b._gradientYMax),this._gradientZMin.cloneTo(n$b._gradientZMin),this._gradientZMax.cloneTo(n$b._gradientZMax)},n$a.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$a,"gradientZ",function(){return this._gradientZ}),n$o(0,n$a,"constant",function(){return this._constant}),n$o(0,n$a,"gradient",function(){return this._gradient}),n$o(0,n$a,"separateAxes",function(){return this._separateAxes}),n$o(0,n$a,"type",function(){return this._type}),n$o(0,n$a,"constantSeparate",function(){return this._constantSeparate}),n$o(0,n$a,"gradientX",function(){return this._gradientX}),n$o(0,n$a,"gradientY",function(){return this._gradientY}),n$o(0,n$a,"gradientW",function(){return this._gradientW}),n$o(0,n$a,"gradientMin",function(){return this._gradientMin}),n$o(0,n$a,"constantMin",function(){return this._constantMin}),n$o(0,n$a,"gradientMax",function(){return this._gradientMax}),n$o(0,n$a,"constantMax",function(){return this._constantMax}),n$o(0,n$a,"gradientWMin",function(){return this._gradientWMin}),n$o(0,n$a,"constantMinSeparate",function(){return this._constantMinSeparate}),n$o(0,n$a,"constantMaxSeparate",function(){return this._constantMaxSeparate}),n$o(0,n$a,"gradientXMin",function(){return this._gradientXMin}),n$o(0,n$a,"gradientXMax",function(){return this._gradientXMax}),n$o(0,n$a,"gradientWMax",function(){return this._gradientWMax}),n$o(0,n$a,"gradientYMin",function(){return this._gradientYMin}),n$o(0,n$a,"gradientYMax",function(){return this._gradientYMax}),n$o(0,n$a,"gradientZMin",function(){return this._gradientZMin}),n$o(0,n$a,"gradientZMax",function(){return this._gradientZMax}),n$j.createByConstant=function(n$a){var n$b=new n$j;return n$b._type=0,n$b._separateAxes=!1,n$b._constant=n$a,n$b},n$j.createByConstantSeparate=function(n$a){var n$b=new n$j;return n$b._type=0,n$b._separateAxes=!0,n$b._constantSeparate=n$a,n$b},n$j.createByGradient=function(n$a){var n$b=new n$j;return n$b._type=1,n$b._separateAxes=!1,n$b._gradient=n$a,n$b},n$j.createByGradientSeparate=function(n$a,n$b,n$c,n$d){var n$e=new n$j;return n$e._type=1,n$e._separateAxes=!0,n$e._gradientX=n$a,n$e._gradientY=n$b,n$e._gradientZ=n$c,n$e._gradientW=n$d,n$e},n$j.createByRandomTwoConstant=function(n$a,n$b){var n$c=new n$j;return n$c._type=2,n$c._separateAxes=!1,n$c._constantMin=n$a,n$c._constantMax=n$b,n$c},n$j.createByRandomTwoConstantSeparate=function(n$a,n$b){var n$c=new n$j;return n$c._type=2,n$c._separateAxes=!0,n$c._constantMinSeparate=n$a,n$c._constantMaxSeparate=n$b,n$c},n$j.createByRandomTwoGradient=function(n$a,n$b){var n$c=new n$j;return n$c._type=3,n$c._separateAxes=!1,n$c._gradientMin=n$a,n$c._gradientMax=n$b,n$c},n$j.createByRandomTwoGradientSeparate=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){var n$i=new n$j;return n$i._type=3,n$i._separateAxes=!0,n$i._gradientXMin=n$a,n$i._gradientXMax=n$b,n$i._gradientYMin=n$c,n$i._gradientYMax=n$d,n$i._gradientZMin=n$e,n$i._gradientZMax=n$f,n$i._gradientWMin=n$g,n$i._gradientWMax=n$h,n$i},n$j}(),n$L=function(){function n$d(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}n$n(n$d,"laya.d3.core.particleShuriKen.module.GradientColor");var n$a=n$d.prototype;return n$v.imps(n$a,{"laya.d3.core.IClone":!0}),n$a.cloneTo=function(n$a){var n$b=n$a;n$b._type=this._type,this._constant.cloneTo(n$b._constant),this._constantMin.cloneTo(n$b._constantMin),this._constantMax.cloneTo(n$b._constantMax),this._gradient.cloneTo(n$b._gradient),this._gradientMin.cloneTo(n$b._gradientMin),this._gradientMax.cloneTo(n$b._gradientMax)},n$a.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$a,"gradient",function(){return this._gradient}),n$o(0,n$a,"constant",function(){return this._constant}),n$o(0,n$a,"type",function(){return this._type}),n$o(0,n$a,"gradientMin",function(){return this._gradientMin}),n$o(0,n$a,"constantMin",function(){return this._constantMin}),n$o(0,n$a,"gradientMax",function(){return this._gradientMax}),n$o(0,n$a,"constantMax",function(){return this._constantMax}),n$d.createByConstant=function(n$a){var n$b=new n$d;return n$b._type=0,n$b._constant=n$a,n$b},n$d.createByGradient=function(n$a){var n$b=new n$d;return n$b._type=1,n$b._gradient=n$a,n$b},n$d.createByRandomTwoConstant=function(n$a,n$b){var n$c=new n$d;return n$c._type=2,n$c._constantMin=n$a,n$c._constantMax=n$b,n$c},n$d.createByRandomTwoGradient=function(n$a,n$b){var n$c=new n$d;return n$c._type=3,n$c._gradientMin=n$a,n$c._gradientMax=n$b,n$c},n$d}(),n$M=(function(){function n$a(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}n$n(n$a,"laya.d3.core.particleShuriKen.module.GradientDataColor");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b.addAlpha=function(n$a,n$b){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==n$a&&(n$a=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=n$a,this._alphaElements[this._alphaCurrentLength++]=n$b):DEBUG},n$b.addRGB=function(n$a,n$b){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==n$a&&(n$a=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=n$a,this._rgbElements[this._rgbCurrentLength++]=n$b.x,this._rgbElements[this._rgbCurrentLength++]=n$b.y,this._rgbElements[this._rgbCurrentLength++]=n$b.z):DEBUG},n$b.cloneTo=function(n$a){var n$b=n$a,n$c=0,n$d=0;n$b._alphaCurrentLength=this._alphaCurrentLength;var n$e=n$b._alphaElements;for(n$e.length=this._alphaElements.length,n$c=0,n$d=this._alphaElements.length;n$c<n$d;n$c++)n$e[n$c]=this._alphaElements[n$c];n$b._rgbCurrentLength=this._rgbCurrentLength;var n$f=n$b._rgbElements;for(n$f.length=this._rgbElements.length,n$c=0,n$d=this._rgbElements.length;n$c<n$d;n$c++)n$f[n$c]=this._rgbElements[n$c]},n$b.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$b,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),n$o(0,n$b,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function n$a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}n$n(n$a,"laya.d3.core.particleShuriKen.module.GradientDataInt");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b.add=function(n$a,n$b){this._currentLength<8?(6===this._currentLength&&1!==n$a&&(n$a=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=n$a,this._elements[this._currentLength++]=n$b):console.log("Warning:data count must lessEqual than 4")},n$b.cloneTo=function(n$a){var n$b=n$a;n$b._currentLength=this._currentLength;var n$c=n$b._elements;n$c.length=this._elements.length;for(var n$d=0,n$e=this._elements.length;n$d<n$e;n$d++)n$c[n$d]=this._elements[n$d]},n$b.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$b,"gradientCount",function(){return this._currentLength/2})}(),function(){function n$a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}n$n(n$a,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b.add=function(n$a,n$b){this._currentLength<8?(6===this._currentLength&&1!==n$a&&(n$a=1,DEBUG),this._elements[this._currentLength++]=n$a,this._elements[this._currentLength++]=n$b):DEBUG},n$b.getKeyByIndex=function(n$a){return this._elements[2*n$a]},n$b.getValueByIndex=function(n$a){return this._elements[2*n$a+1]},n$b.getAverageValue=function(){for(var n$a=0,n$b=this._currentLength-2;n$a<n$b;n$a+=2){this._elements[n$a+1];this._elements[n$a+3],this._elements[n$a+2]-this._elements[n$a]}return 0},n$b.cloneTo=function(n$a){var n$b=n$a;n$b._currentLength=this._currentLength;var n$c=n$b._elements;n$c.length=this._elements.length;for(var n$d=0,n$e=this._elements.length;n$d<n$e;n$d++)n$c[n$d]=this._elements[n$d]},n$b.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$b,"gradientCount",function(){return this._currentLength/2})}(),function(){function n$a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}n$n(n$a,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b.add=function(n$a,n$b){this._currentLength<8?(6===this._currentLength&&1!==n$a&&(n$a=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=n$a,this._elements[this._currentLength++]=n$b.x,this._elements[this._currentLength++]=n$b.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},n$b.cloneTo=function(n$a){var n$b=n$a;n$b._currentLength=this._currentLength;var n$c=n$b._elements;n$c.length=this._elements.length;for(var n$d=0,n$e=this._elements.length;n$d<n$e;n$d++)n$c[n$d]=this._elements[n$d]},n$b.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$b,"gradientCount",function(){return this._currentLength/3})}(),function(){function n$h(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}n$n(n$h,"laya.d3.core.particleShuriKen.module.GradientSize");var n$a=n$h.prototype;return n$v.imps(n$a,{"laya.d3.core.IClone":!0}),n$a.getMaxSizeInGradient=function(){var n$a=0,n$b=0,n$c=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(n$a=0,n$b=this._gradientX.gradientCount;n$a<n$b;n$a++)n$c=Math.max(n$c,this._gradientX.getValueByIndex(n$a));for(n$a=0,n$b=this._gradientY.gradientCount;n$a<n$b;n$a++)n$c=Math.max(n$c,this._gradientY.getValueByIndex(n$a))}else for(n$a=0,n$b=this._gradient.gradientCount;n$a<n$b;n$a++)n$c=Math.max(n$c,this._gradient.getValueByIndex(n$a));break;case 1:n$c=this._separateAxes?(n$c=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),n$c=Math.max(n$c,this._constantMinSeparate.y),Math.max(n$c,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(n$a=0,n$b=this._gradientXMin.gradientCount;n$a<n$b;n$a++)n$c=Math.max(n$c,this._gradientXMin.getValueByIndex(n$a));for(n$a=0,n$b=this._gradientXMax.gradientCount;n$a<n$b;n$a++)n$c=Math.max(n$c,this._gradientXMax.getValueByIndex(n$a));for(n$a=0,n$b=this._gradientYMin.gradientCount;n$a<n$b;n$a++)n$c=Math.max(n$c,this._gradientYMin.getValueByIndex(n$a));for(n$a=0,n$b=this._gradientZMax.gradientCount;n$a<n$b;n$a++)n$c=Math.max(n$c,this._gradientZMax.getValueByIndex(n$a))}else{for(n$a=0,n$b=this._gradientMin.gradientCount;n$a<n$b;n$a++)n$c=Math.max(n$c,this._gradientMin.getValueByIndex(n$a));for(n$a=0,n$b=this._gradientMax.gradientCount;n$a<n$b;n$a++)n$c=Math.max(n$c,this._gradientMax.getValueByIndex(n$a))}}return n$c},n$a.cloneTo=function(n$a){var n$b=n$a;n$b._type=this._type,n$b._separateAxes=this._separateAxes,this._gradient.cloneTo(n$b._gradient),this._gradientX.cloneTo(n$b._gradientX),this._gradientY.cloneTo(n$b._gradientY),this._gradientZ.cloneTo(n$b._gradientZ),n$b._constantMin=this._constantMin,n$b._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(n$b._constantMinSeparate),this._constantMaxSeparate.cloneTo(n$b._constantMaxSeparate),this._gradientMin.cloneTo(n$b._gradientMin),this._gradientMax.cloneTo(n$b._gradientMax),this._gradientXMin.cloneTo(n$b._gradientXMin),this._gradientXMax.cloneTo(n$b._gradientXMax),this._gradientYMin.cloneTo(n$b._gradientYMin),this._gradientYMax.cloneTo(n$b._gradientYMax),this._gradientZMin.cloneTo(n$b._gradientZMin),this._gradientZMax.cloneTo(n$b._gradientZMax)},n$a.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$a,"gradientZ",function(){return this._gradientZ}),n$o(0,n$a,"gradient",function(){return this._gradient}),n$o(0,n$a,"separateAxes",function(){return this._separateAxes}),n$o(0,n$a,"type",function(){return this._type}),n$o(0,n$a,"gradientMin",function(){return this._gradientMin}),n$o(0,n$a,"constantMin",function(){return this._constantMin}),n$o(0,n$a,"gradientX",function(){return this._gradientX}),n$o(0,n$a,"gradientY",function(){return this._gradientY}),n$o(0,n$a,"gradientMax",function(){return this._gradientMax}),n$o(0,n$a,"constantMax",function(){return this._constantMax}),n$o(0,n$a,"constantMinSeparate",function(){return this._constantMinSeparate}),n$o(0,n$a,"constantMaxSeparate",function(){return this._constantMaxSeparate}),n$o(0,n$a,"gradientXMin",function(){return this._gradientXMin}),n$o(0,n$a,"gradientXMax",function(){return this._gradientXMax}),n$o(0,n$a,"gradientYMin",function(){return this._gradientYMin}),n$o(0,n$a,"gradientYMax",function(){return this._gradientYMax}),n$o(0,n$a,"gradientZMin",function(){return this._gradientZMin}),n$o(0,n$a,"gradientZMax",function(){return this._gradientZMax}),n$h.createByGradient=function(n$a){var n$b=new n$h;return n$b._type=0,n$b._separateAxes=!1,n$b._gradient=n$a,n$b},n$h.createByGradientSeparate=function(n$a,n$b,n$c){var n$d=new n$h;return n$d._type=0,n$d._separateAxes=!0,n$d._gradientX=n$a,n$d._gradientY=n$b,n$d._gradientZ=n$c,n$d},n$h.createByRandomTwoConstant=function(n$a,n$b){var n$c=new n$h;return n$c._type=1,n$c._separateAxes=!1,n$c._constantMin=n$a,n$c._constantMax=n$b,n$c},n$h.createByRandomTwoConstantSeparate=function(n$a,n$b){var n$c=new n$h;return n$c._type=1,n$c._separateAxes=!0,n$c._constantMinSeparate=n$a,n$c._constantMaxSeparate=n$b,n$c},n$h.createByRandomTwoGradient=function(n$a,n$b){var n$c=new n$h;return n$c._type=2,n$c._separateAxes=!1,n$c._gradientMin=n$a,n$c._gradientMax=n$b,n$c},n$h.createByRandomTwoGradientSeparate=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=new n$h;return n$g._type=2,n$g._separateAxes=!0,n$g._gradientXMin=n$a,n$g._gradientXMax=n$b,n$g._gradientYMin=n$c,n$g._gradientYMax=n$d,n$g._gradientZMin=n$e,n$g._gradientZMax=n$f,n$g},n$h}()),n$N=function(){function n$h(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}n$n(n$h,"laya.d3.core.particleShuriKen.module.GradientVelocity");var n$a=n$h.prototype;return n$v.imps(n$a,{"laya.d3.core.IClone":!0}),n$a.cloneTo=function(n$a){var n$b=n$a;n$b._type=this._type,this._constant.cloneTo(n$b._constant),this._gradientX.cloneTo(n$b._gradientX),this._gradientY.cloneTo(n$b._gradientY),this._gradientZ.cloneTo(n$b._gradientZ),this._constantMin.cloneTo(n$b._constantMin),this._constantMax.cloneTo(n$b._constantMax),this._gradientXMin.cloneTo(n$b._gradientXMin),this._gradientXMax.cloneTo(n$b._gradientXMax),this._gradientYMin.cloneTo(n$b._gradientYMin),this._gradientYMax.cloneTo(n$b._gradientYMax),this._gradientZMin.cloneTo(n$b._gradientZMin),this._gradientZMax.cloneTo(n$b._gradientZMax)},n$a.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$a,"gradientZ",function(){return this._gradientZ}),n$o(0,n$a,"constant",function(){return this._constant}),n$o(0,n$a,"type",function(){return this._type}),n$o(0,n$a,"gradientXMax",function(){return this._gradientXMax}),n$o(0,n$a,"constantMin",function(){return this._constantMin}),n$o(0,n$a,"gradientX",function(){return this._gradientX}),n$o(0,n$a,"gradientY",function(){return this._gradientY}),n$o(0,n$a,"gradientXMin",function(){return this._gradientXMin}),n$o(0,n$a,"constantMax",function(){return this._constantMax}),n$o(0,n$a,"gradientYMin",function(){return this._gradientYMin}),n$o(0,n$a,"gradientYMax",function(){return this._gradientYMax}),n$o(0,n$a,"gradientZMin",function(){return this._gradientZMin}),n$o(0,n$a,"gradientZMax",function(){return this._gradientZMax}),n$h.createByConstant=function(n$a){var n$b=new n$h;return n$b._type=0,n$b._constant=n$a,n$b},n$h.createByGradient=function(n$a,n$b,n$c){var n$d=new n$h;return n$d._type=1,n$d._gradientX=n$a,n$d._gradientY=n$b,n$d._gradientZ=n$c,n$d},n$h.createByRandomTwoConstant=function(n$a,n$b){var n$c=new n$h;return n$c._type=2,n$c._constantMin=n$a,n$c._constantMax=n$b,n$c},n$h.createByRandomTwoGradient=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=new n$h;return n$g._type=3,n$g._gradientXMin=n$a,n$g._gradientXMax=n$b,n$g._gradientYMin=n$c,n$g._gradientYMax=n$d,n$g._gradientZMin=n$e,n$g._gradientZMax=n$f,n$g},n$h}(),n$O=(function(){function n$a(n$a){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=n$a}n$n(n$a,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b.cloneTo=function(n$a){var n$b=n$a;this._angularVelocity.cloneTo(n$b._angularVelocity),n$b.enbale=this.enbale},n$b.clone=function(){var n$a;switch(this._angularVelocity.type){case 0:n$a=this._angularVelocity.separateAxes?n$K.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):n$K.createByConstant(this._angularVelocity.constant);break;case 1:n$a=this._angularVelocity.separateAxes?n$K.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):n$K.createByGradient(this._angularVelocity.gradient.clone());break;case 2:n$a=this._angularVelocity.separateAxes?n$K.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):n$K.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:n$a=this._angularVelocity.separateAxes?n$K.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):n$K.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var n$b=new this.constructor(n$a);return n$b.enbale=this.enbale,n$b},n$o(0,n$b,"angularVelocity",function(){return this._angularVelocity})}(),function(){function n$a(){this.enable=!1,this.randomDirection=!1}n$n(n$a,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b._getShapeBoundBox=function(n$a){throw new Error("BaseShape: must override it.")},n$b._getSpeedBoundBox=function(n$a){throw new Error("BaseShape: must override it.")},n$b.generatePositionAndDirection=function(n$a,n$b,n$c,n$d){throw new Error("BaseShape: must override it.")},n$b._calculateProceduralBounds=function(n$a,n$b,n$c){this._getShapeBoundBox(n$a);var n$d=n$a.min,n$e=n$a.max;n$gb.multiply(n$d,n$b,n$d),n$gb.multiply(n$e,n$b,n$e);var n$f=new n$Za(new n$gb,new n$gb);this.randomDirection?(n$f.min=new n$gb(-1,-1,-1),n$f.max=new n$gb(1,1,1)):this._getSpeedBoundBox(n$f);var n$g=new n$Za(new n$gb,new n$gb),n$h=n$g.min,n$i=n$g.max;n$gb.scale(n$f.min,n$c.y,n$h),n$gb.scale(n$f.max,n$c.y,n$i),n$gb.add(n$a.min,n$h,n$h),n$gb.add(n$a.max,n$i,n$i),n$gb.min(n$a.min,n$h,n$a.min),n$gb.max(n$a.max,n$h,n$a.max);var n$j=new n$Za(new n$gb,new n$gb),n$k=n$j.min,n$l=n$j.max;n$gb.scale(n$f.min,n$c.x,n$k),n$gb.scale(n$f.max,n$c.x,n$l),n$gb.min(n$j.min,n$l,n$h),n$gb.max(n$j.min,n$l,n$i),n$gb.min(n$a.min,n$h,n$a.min),n$gb.max(n$a.max,n$h,n$a.max)},n$b.cloneTo=function(n$a){n$a.enable=this.enable},n$b.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$a}()),n$T=function(){function n$f(){}return n$n(n$f,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),n$f._randomPointUnitArcCircle=function(n$a,n$b,n$c){var n$d=n$b.elements,n$e=NaN;n$e=n$c?n$c.getFloat()*n$a:Math.random()*n$a,n$d[0]=Math.cos(n$e),n$d[1]=Math.sin(n$e)},n$f._randomPointInsideUnitArcCircle=function(n$a,n$b,n$c){var n$d=n$b.elements;n$f._randomPointUnitArcCircle(n$a,n$b,n$c);var n$e=NaN;n$e=n$c?Math.pow(n$c.getFloat(),.5):Math.pow(Math.random(),.5),n$d[0]=n$d[0]*n$e,n$d[1]=n$d[1]*n$e},n$f._randomPointUnitCircle=function(n$a,n$b){var n$c=n$a.elements,n$d=NaN;n$d=n$b?n$b.getFloat()*Math.PI*2:Math.random()*Math.PI*2,n$c[0]=Math.cos(n$d),n$c[1]=Math.sin(n$d)},n$f._randomPointInsideUnitCircle=function(n$a,n$b){var n$c=n$a.elements;n$f._randomPointUnitCircle(n$a);var n$d=NaN;n$d=n$b?Math.pow(n$b.getFloat(),.5):Math.pow(Math.random(),.5),n$c[0]=n$c[0]*n$d,n$c[1]=n$c[1]*n$d},n$f._randomPointUnitSphere=function(n$a,n$b){var n$c=n$a.elements,n$d=NaN,n$e=NaN;n$e=n$b?(n$d=n$c[2]=2*n$b.getFloat()-1,n$b.getFloat()*Math.PI*2):(n$d=n$c[2]=2*Math.random()-1,Math.random()*Math.PI*2);var n$f=Math.sqrt(1-n$d*n$d);n$c[0]=n$f*Math.cos(n$e),n$c[1]=n$f*Math.sin(n$e)},n$f._randomPointInsideUnitSphere=function(n$a,n$b){var n$c=n$a.elements;n$f._randomPointUnitSphere(n$a);var n$d=NaN;n$d=n$b?Math.pow(n$b.getFloat(),1/3):Math.pow(Math.random(),1/3),n$c[0]=n$c[0]*n$d,n$c[1]=n$c[1]*n$d,n$c[2]=n$c[2]*n$d},n$f._randomPointInsideHalfUnitBox=function(n$a,n$b){var n$c=n$a.elements;n$b?(n$c[0]=n$b.getFloat()-.5,n$c[1]=n$b.getFloat()-.5,n$c[2]=n$b.getFloat()-.5):(n$c[0]=Math.random()-.5,n$c[1]=Math.random()-.5,n$c[2]=Math.random()-.5)},n$f}(),n$U=(function(){function n$a(n$a){this._size=null,this.enbale=!1,this._size=n$a}n$n(n$a,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b.cloneTo=function(n$a){var n$b=n$a;this._size.cloneTo(n$b._size),n$b.enbale=this.enbale},n$b.clone=function(){var n$a;switch(this._size.type){case 0:n$a=this._size.separateAxes?n$M.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):n$M.createByGradient(this._size.gradient.clone());break;case 1:n$a=this._size.separateAxes?n$M.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):n$M.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:n$a=this._size.separateAxes?n$M.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):n$M.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var n$b=new this.constructor(n$a);return n$b.enbale=this.enbale,n$b},n$o(0,n$b,"size",function(){return this._size})}(),function(){function n$d(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}n$n(n$d,"laya.d3.core.particleShuriKen.module.StartFrame");var n$a=n$d.prototype;return n$v.imps(n$a,{"laya.d3.core.IClone":!0}),n$a.cloneTo=function(n$a){var n$b=n$a;n$b._type=this._type,n$b._constant=this._constant,n$b._constantMin=this._constantMin,n$b._constantMax=this._constantMax},n$a.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$a,"constant",function(){return this._constant}),n$o(0,n$a,"type",function(){return this._type}),n$o(0,n$a,"constantMin",function(){return this._constantMin}),n$o(0,n$a,"constantMax",function(){return this._constantMax}),n$d.createByConstant=function(n$a){var n$b=new n$d;return n$b._type=0,n$b._constant=n$a,n$b},n$d.createByRandomTwoConstant=function(n$a,n$b){var n$c=new n$d;return n$c._type=1,n$c._constantMin=n$a,n$c._constantMax=n$b,n$c},n$d}()),n$V=(function(){function n$a(n$a,n$b){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new n$fb(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=n$a,this._startFrame=n$b}n$n(n$a,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b.cloneTo=function(n$a){var n$b=n$a;this.tiles.cloneTo(n$b.tiles),n$b.type=this.type,n$b.randomRow=this.randomRow,this._frame.cloneTo(n$b._frame),this._startFrame.cloneTo(n$b._startFrame),n$b.cycles=this.cycles,n$b.enableUVChannels=this.enableUVChannels,n$b.enable=this.enable},n$b.clone=function(){var n$a,n$b;switch(this._frame.type){case 0:n$a=n$J.createByConstant(this._frame.constant);break;case 1:n$a=n$J.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:n$a=n$J.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:n$a=n$J.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:n$b=n$U.createByConstant(this._startFrame.constant);break;case 1:n$b=n$U.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var n$c=new this.constructor(n$a,n$b);return this.tiles.cloneTo(n$c.tiles),n$c.type=this.type,n$c.randomRow=this.randomRow,n$c.cycles=this.cycles,n$c.enableUVChannels=this.enableUVChannels,n$c.enable=this.enable,n$c},n$o(0,n$b,"frame",function(){return this._frame}),n$o(0,n$b,"startFrame",function(){return this._startFrame})}(),function(){function n$a(n$a){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=n$a}n$n(n$a,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b.cloneTo=function(n$a){var n$b=n$a;this._velocity.cloneTo(n$b._velocity),n$b.enbale=this.enbale,n$b.space=this.space},n$b.clone=function(){var n$a;switch(this._velocity.type){case 0:n$a=n$N.createByConstant(this._velocity.constant.clone());break;case 1:n$a=n$N.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:n$a=n$N.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:n$a=n$N.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var n$b=new this.constructor(n$a);return n$b.enbale=this.enbale,n$b.space=this.space,n$b},n$o(0,n$b,"velocity",function(){return this._velocity})}(),function(){function n$a(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new n$mb,this._vb=n$Ob.create(n$a._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=n$Nb.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=n$Lb.nameKey.getID("LINE"),this._shaderCompile=n$yb._preCompileShader[this._sharderNameID]}n$n(n$a,"laya.d3.core.PhasorSpriter3D");var n$b=n$a.prototype;return n$b.line=function(n$a,n$b,n$c,n$d){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(n$a.x,n$a.y,n$a.z,n$b.x,n$b.y,n$b.z,n$b.w),this.addVertex(n$c.x,n$c.y,n$c.z,n$d.x,n$d.y,n$d.z,n$d.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},n$b.circle=function(n$a,n$b,n$c,n$d,n$e,n$f){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*n$b,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/n$b,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*n$a,Math.cos(this._tempNumver0)*n$a,0,n$c,n$d,n$e,n$f),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},n$b.plane=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=n$d/2,this._tempNumver1=n$e/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(n$a-this._tempNumver0,n$b+this._tempNumver1,n$c,n$f,n$g,n$h,n$i),this.addVertex(n$a+this._tempNumver0,n$b+this._tempNumver1,n$c,n$f,n$g,n$h,n$i),this.addVertex(n$a-this._tempNumver0,n$b-this._tempNumver1,n$c,n$f,n$g,n$h,n$i),this.addVertex(n$a+this._tempNumver0,n$b-this._tempNumver1,n$c,n$f,n$g,n$h,n$i),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},n$b.box=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=n$d/2,this._tempNumver1=n$e/2,this._tempNumver2=n$f/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(n$a-this._tempNumver0,n$b+this._tempNumver1,n$c+this._tempNumver2,n$g,n$h,n$i,n$j),this.addVertex(n$a+this._tempNumver0,n$b+this._tempNumver1,n$c+this._tempNumver2,n$g,n$h,n$i,n$j),this.addVertex(n$a-this._tempNumver0,n$b-this._tempNumver1,n$c+this._tempNumver2,n$g,n$h,n$i,n$j),this.addVertex(n$a+this._tempNumver0,n$b-this._tempNumver1,n$c+this._tempNumver2,n$g,n$h,n$i,n$j),this.addVertex(n$a+this._tempNumver0,n$b+this._tempNumver1,n$c-this._tempNumver2,n$g,n$h,n$i,n$j),this.addVertex(n$a-this._tempNumver0,n$b+this._tempNumver1,n$c-this._tempNumver2,n$g,n$h,n$i,n$j),this.addVertex(n$a+this._tempNumver0,n$b-this._tempNumver1,n$c-this._tempNumver2,n$g,n$h,n$i,n$j),this.addVertex(n$a-this._tempNumver0,n$b-this._tempNumver1,n$c-this._tempNumver2,n$g,n$h,n$i,n$j),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},n$b.cone=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*n$c+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*n$c>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/n$c,this.addVertexIndex(0,n$b,0,n$d,n$e,n$f,n$g,this._tempUint0),this.addVertexIndex(0,0,0,n$d,n$e,n$f,n$g,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<n$c;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(n$a*this._tempNumver2,0,n$a*this._tempNumver3,n$d,n$e,n$f,n$g,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==n$c-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(n$a*this._tempNumver2,0,n$a*this._tempNumver3,n$d,n$e,n$f,n$g,this._tempUint0+(this._tempInt0+n$c)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==n$c-1?this.addIndexes(this._tempUint1+n$c+2):this.addIndexes(this._tempUint1+this._tempInt0+n$c+1),this.addIndexes(this._tempUint1+this._tempInt0+n$c),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},n$b.boundingBoxLine=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(n$a,n$e,n$f,n$g,n$h,n$i,n$j),this.addVertex(n$d,n$e,n$f,n$g,n$h,n$i,n$j),this.addVertex(n$a,n$b,n$f,n$g,n$h,n$i,n$j),this.addVertex(n$d,n$b,n$f,n$g,n$h,n$i,n$j),this.addVertex(n$d,n$e,n$c,n$g,n$h,n$i,n$j),this.addVertex(n$a,n$e,n$c,n$g,n$h,n$i,n$j),this.addVertex(n$d,n$b,n$c,n$g,n$h,n$i,n$j),this.addVertex(n$a,n$b,n$c,n$g,n$h,n$i,n$j),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},n$b.addVertex=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=n$a,this._vbData[this._posInVBData+1]=n$b,this._vbData[this._posInVBData+2]=n$c,this._vbData[this._posInVBData+3]=n$d,this._vbData[this._posInVBData+4]=n$e,this._vbData[this._posInVBData+5]=n$f,this._vbData[this._posInVBData+6]=n$g,this._posInVBData+=this._floatSizePerVer,this},n$b.addVertexIndex=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){return this._hasBegun||this.addVertexIndexException(),this._vbData[n$h]=n$a,this._vbData[n$h+1]=n$b,this._vbData[n$h+2]=n$c,this._vbData[n$h+3]=n$d,this._vbData[n$h+4]=n$e,this._vbData[n$h+5]=n$f,this._vbData[n$h+6]=n$g,(n$h+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=n$h),this},n$b.addIndexes=function(n$a){var n$b=arguments;this._hasBegun||this.addVertexIndexException();for(var n$c=0;n$c<n$b.length;n$c++)this._ibData[this._posInIBData]=n$b[n$c],this._posInIBData++;return this},n$b.begin=function(n$a,n$b){return this._hasBegun&&this.beginException0(),1!==n$a&&4!==n$a&&this.beginException1(),this._primitiveType=n$a,this._camera=n$b,this._hasBegun=!0,this},n$b.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},n$b.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(n$a._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),n$y.drawCall++,n$F.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},n$b.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},n$b.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},n$b.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},n$b.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},n$b.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},n$b.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(28,[new n$ga(0,"vector3",0),new n$ga(12,"vector4",1)])}]),n$a}()),n$W=function(){function n$a(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++n$a._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new n$mb}n$n(n$a,"laya.d3.core.render.RenderElement");var n$b=n$a.prototype;return n$b.getDynamicBatchBakedVertexs=function(n$a){for(var n$b=this._renderObj._getVertexBuffer(n$a),n$c=n$b.getData().slice(),n$d=n$b.vertexDeclaration,n$e=n$d.getVertexElementByUsage(0).offset/4,n$f=n$d.getVertexElementByUsage(3).offset/4,n$g=this._sprite3D.transform,n$h=n$g.worldMatrix,n$i=n$g.rotation,n$j=n$d.vertexStride/4,n$k=0,n$l=n$c.length;n$k<n$l;n$k+=n$j){var n$m=n$k+n$e,n$n=n$k+n$f;n$qb.transformVector3ArrayToVector3ArrayCoordinate(n$c,n$m,n$h,n$c,n$m),n$qb.transformVector3ArrayByQuat(n$c,n$n,n$i,n$c,n$n)}return n$c},n$b.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},n$b._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},n$o(0,n$b,"id",function(){return this._id}),n$o(0,n$b,"renderObj",function(){return this._renderObj},function(n$a){this._renderObj!==n$a&&(this._renderObj=n$a)}),n$a._uniqueIDCounter=0,n$a}(),n$X=function(){function n$b(n$a){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++n$b._uniqueIDCounter,this._needSort=!1,this._scene=n$a,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}n$n(n$b,"laya.d3.core.render.RenderQueue");var n$a=n$b.prototype;return n$a._sortOpaqueFunc=function(n$a,n$b){if(n$a._render&&n$b._render){var n$c=n$a._material.renderQueue-n$b._material.renderQueue;return 0==n$c?n$a._render._distanceForSort-n$b._render._distanceForSort:n$c}return 0},n$a._sortAlphaFunc=function(n$a,n$b){if(n$a._render&&n$b._render){var n$c=n$a._material.renderQueue-n$b._material.renderQueue;return 0==n$c?n$b._render._distanceForSort-n$a._render._distanceForSort:n$c}return 0},n$a._begainRenderElement=function(n$a,n$b,n$c){return!!n$b._beforeRender(n$a)},n$a._sortAlpha=function(n$a){n$b._cameraPosition=n$a,this._finalElements.sort(this._sortAlphaFunc)},n$a._sortOpaque=function(n$a){n$b._cameraPosition=n$a,this._finalElements.sort(this._sortOpaqueFunc)},n$a._preRender=function(n$a){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},n$a._render=function(n$a,n$b){for(var n$c,n$d,n$e,n$f,n$g,n$h,n$i=n$y.loopCount,n$j=this._scene,n$k=n$a.camera,n$l=(n$k.id,!1),n$m=0,n$n=this._finalElements.length;n$m<n$n;n$m++){var n$o,n$p,n$q,n$r=this._finalElements[n$m];if(null!=n$r._onPreRenderFunction&&n$r._onPreRenderFunction.call(n$r._sprite3D,n$a),0===n$r._type){if(n$a.owner=n$q=n$r._sprite3D,n$a.renderElement=n$r,n$q._preRenderUpdateComponents(n$a),n$o=n$r.renderObj,n$p=n$r._material,this._begainRenderElement(n$a,n$o,n$p)){if(n$c=n$o._getVertexBuffers(),!(n$e=(n$d=n$o._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[n$d.id]){this._errorRecord[n$d.id]=1;var n$s="vertexBuffer:"+("("+n$d._destroyed+","+n$d._released+","+n$d._referenceCount+","+n$d._buffer+")")+", material:"+(n$p?n$p.__className+"("+n$p._destroyed+","+n$p._released+")":"null")+", owner:"+(n$q?n$q.__className+"("+n$q._destroyed+","+n$q._activeInHierarchy+","+n$q._displayedInStage+")":"null")+", renderObj:"+(n$o?n$o.__className+"("+n$o._destroyed+","+n$o._released+","+n$o._referenceCount+")":"")+", parent:, url:"+(n$q?n$q.url:"")+", disposeStack:"+n$d.disposeStack;n$v.recordError("报错：unknown vertexDeclaration  "+n$s)}continue}if(n$l=(n$f=n$a._shader=n$p._getShader(n$j._shaderDefineValue,n$e.shaderDefineValue,n$q._shaderDefineValue)).bind()||n$i!==n$f._uploadLoopCount,n$c){if(n$f._uploadVertexBuffer!==n$c||n$l){for(var n$t=0;n$t<n$c.length;n$t++){var n$u=n$c[n$t];n$f.uploadAttributesX(n$u.vertexDeclaration.shaderValues.data,n$u)}n$f._uploadVertexBuffer=n$c}}else(n$f._uploadVertexBuffer!==n$d||n$l)&&(n$f.uploadAttributes(n$e.shaderValues.data,null),n$f._uploadVertexBuffer=n$d);(n$f._uploadScene!==n$j||n$l)&&(n$f.uploadSceneUniforms(n$j._shaderValues.data),n$f._uploadScene=n$j),(n$k!==n$f._uploadCamera||n$f._uploadSprite3D!==n$q||n$l)&&(n$f.uploadSpriteUniforms(n$q._shaderValues.data),n$f._uploadSprite3D=n$q),(n$k!==n$f._uploadCamera||n$l)&&(n$f.uploadCameraUniforms(n$k._shaderValues.data),n$f._uploadCamera=n$k),(n$f._uploadMaterial!==n$p||n$l)&&(n$p._upload(),n$f._uploadMaterial=n$p),n$g!==n$p?(n$p._setRenderStateBlendDepth(),n$p._setRenderStateFrontFace(n$b,n$q.transform),n$g=n$p,n$h=n$q):n$h!==n$q&&(n$p._setRenderStateFrontFace(n$b,n$q.transform),n$h=n$q),n$o._render(n$a),n$f._uploadLoopCount=n$i}n$q._postRenderUpdateComponents(n$a)}else if(2===n$r._type){n$r.renderObj;n$a.owner=n$q=n$r._sprite3D,n$a.renderElement=n$r,n$a._batchIndexStart=n$r._tempBatchIndexStart,n$a._batchIndexEnd=n$r._tempBatchIndexEnd,n$o=n$r.renderObj,n$p=n$r._material,this._begainRenderElement(n$a,n$o,n$p)&&(n$e=(n$d=n$o._getVertexBuffer(0)).vertexDeclaration,n$l=(n$f=n$a._shader=n$p._getShader(n$j._shaderDefineValue,n$e.shaderDefineValue,n$q._shaderDefineValue)).bind()||n$i!==n$f._uploadLoopCount,(n$f._uploadVertexBuffer!==n$d||n$l)&&(n$f.uploadAttributes(n$e.shaderValues.data,null),n$f._uploadVertexBuffer=n$d),(n$f._uploadScene!==n$j||n$l)&&(n$f.uploadSceneUniforms(n$j._shaderValues.data),n$f._uploadScene=n$j),(n$k!==n$f._uploadCamera||n$f._uploadSprite3D!==n$q||n$l)&&(n$f.uploadSpriteUniforms(n$q._shaderValues.data),n$f._uploadSprite3D=n$q),(n$k!==n$f._uploadCamera||n$l)&&(n$f.uploadCameraUniforms(n$k._shaderValues.data),n$f._uploadCamera=n$k),(n$f._uploadMaterial!==n$p||n$l)&&(n$p._upload(),n$f._uploadMaterial=n$p),n$g!==n$p?(n$p._setRenderStateBlendDepth(),n$p._setRenderStateFrontFace(n$b,n$q.transform),n$g=n$p,n$h=n$q):n$h!==n$q&&(n$p._setRenderStateFrontFace(n$b,n$q.transform),n$h=n$q),n$o._render(n$a),n$f._uploadLoopCount=n$i)}}},n$a._renderShadow=function(n$a,n$b){for(var n$c,n$d,n$e,n$f,n$g,n$h=n$y.loopCount,n$i=this._scene,n$j=n$a.camera,n$k=!1,n$l=0,n$m=this._finalElements.length;n$l<n$m;n$l++){var n$n,n$o,n$p,n$q=this._finalElements[n$l];0===n$q._type&&(n$a.owner=n$p=n$q._sprite3D,n$b||n$p._projectionViewWorldUpdateCamera===n$j&&n$p._projectionViewWorldUpdateLoopCount===n$y.loopCount||(n$p._render._renderUpdate(n$a._projectionViewMatrix),n$p._projectionViewWorldUpdateLoopCount=n$y.loopCount,n$p._projectionViewWorldUpdateCamera=n$j),n$a.renderElement=n$q,n$p._preRenderUpdateComponents(n$a),n$n=n$q.renderObj,n$o=n$q._material,this._begainRenderElement(n$a,n$n,null)&&(n$d=(n$c=n$n._getVertexBuffer(0)).vertexDeclaration,n$k=(n$e=n$a._shader=n$o._getShader(n$i._shaderDefineValue,n$d.shaderDefineValue,n$p._shaderDefineValue)).bind()||n$h!==n$e._uploadLoopCount,(n$e._uploadVertexBuffer!==n$c||n$k)&&(n$e.uploadAttributes(n$d.shaderValues.data,null),n$e._uploadVertexBuffer=n$c),(n$j!==n$e._uploadCamera||n$e._uploadSprite3D!==n$p||n$k)&&(n$e.uploadSpriteUniforms(n$p._shaderValues.data),n$e._uploadSprite3D=n$p),(n$j!==n$e._uploadCamera||n$k)&&(n$e.uploadCameraUniforms(n$j._shaderValues.data),n$e._uploadCamera=n$j),(n$e._uploadMaterial!==n$o||n$k)&&(n$o._upload(),n$e._uploadMaterial=n$o),n$e._uploadRenderElement,n$f!==n$o?(n$o._setRenderStateFrontFace(!1,n$p.transform),n$f=n$o,n$g=n$p):n$g!==n$p&&(n$o._setRenderStateFrontFace(!1,n$p.transform),n$g=n$p),n$n._render(n$a),n$e._uploadLoopCount=n$h),n$p._postRenderUpdateComponents(n$a))}},n$a._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},n$a._addRenderElement=function(n$a){this._renderElements.push(n$a),this._needSort=!0},n$a._addDynamicBatchElement=function(n$a){this._dynamicBatchCombineRenderElements.push(n$a)},n$o(0,n$a,"id",function(){return this._id}),n$b._uniqueIDCounter=0,n$b._cameraPosition=null,n$b}(),n$Y=function(){function n$a(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return n$n(n$a,"laya.d3.core.render.RenderState"),n$a.clientWidth=0,n$a.clientHeight=0,n$a}(),n$Z=function(){function n$g(n$a,n$b){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new n$_a(new n$gb,0),this._corners=[new n$gb,new n$gb,new n$gb,new n$gb,new n$gb,new n$gb,new n$gb,new n$gb],this._boundingBoxCenter=new n$gb,this._children=n$d(8),this._objects=[],this._tempBoundBoxCorners=[new n$gb,new n$gb,new n$gb,new n$gb,new n$gb,new n$gb,new n$gb,new n$gb],this._scene=n$a,this._currentDepth=n$b}n$n(n$g,"laya.d3.core.scene.OctreeNode");var n$a=n$g.prototype;return n$v.imps(n$a,{"laya.d3.core.scene.ITreeNode":!0}),n$a.init=function(n$a,n$b){var n$c=new n$gb,n$d=new n$gb;n$gb.scale(n$b,-.5,n$c),n$gb.scale(n$b,.5,n$d),n$gb.add(n$c,n$a,n$c),n$gb.add(n$d,n$a,n$d),this.exactBox=new n$Za(n$c,n$d),this.relaxBox=new n$Za(n$c,n$d)},n$a.addTreeNode=function(n$a){1===Collision.boxContainsBox(this._relaxBox,n$a.boundingBox)?this.addNodeDown(n$a,0):this.addObject(n$a)},n$a.addChild=function(n$a){var n$b=this._children[n$a];if(null==n$b){n$b=new n$g(this._scene,this._currentDepth+1),(this._children[n$a]=n$b)._parent=this,n$gb.subtract(this._exactBox.max,this._exactBox.min,n$g.tempSize),n$gb.multiply(n$g.tempSize,n$g._octreeSplit[n$a],n$g.tempCenter),n$gb.add(this._exactBox.min,n$g.tempCenter,n$g.tempCenter),n$gb.scale(n$g.tempSize,.25,n$g.tempSize);var n$c=new n$gb,n$d=new n$gb;n$gb.subtract(n$g.tempCenter,n$g.tempSize,n$c),n$gb.add(n$g.tempCenter,n$g.tempSize,n$d),n$b.exactBox=new n$Za(n$c,n$d),n$gb.scale(n$g.tempSize,n$g.relax,n$g.tempSize);var n$e=new n$gb,n$f=new n$gb;n$gb.subtract(n$g.tempCenter,n$g.tempSize,n$e),n$gb.add(n$g.tempCenter,n$g.tempSize,n$f),n$b.relaxBox=new n$Za(n$e,n$f)}return n$b},n$a.addObject=function(n$a){(n$a._treeNode=this)._objects.push(n$a)},n$a.removeObject=function(n$a){if(n$a._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var n$b=this._objects.indexOf(n$a);return-1!==n$b&&(this._objects.splice(n$b,1),!0)},n$a.clearObject=function(){this._objects.length=0},n$a.addNodeUp=function(n$a,n$b){this._parent&&1!==Collision.boxContainsBox(this._exactBox,n$a.boundingBox)?this._parent.addNodeUp(n$a,n$b-1):this.addNodeDown(n$a,n$b)},n$a.addNodeDown=function(n$a,n$b){if(n$b<this._scene.treeLevel){var n$c=this.inChildIndex(n$a.boundingBoxCenter),n$d=this.addChild(n$c);1===Collision.boxContainsBox(n$d._relaxBox,n$a.boundingBox)?n$d.addNodeDown(n$a,++n$b):this.addObject(n$a)}else this.addObject(n$a)},n$a.inChildIndex=function(n$a){return 4*(n$a.z<this._boundingBoxCenter.z?0:1)+2*(n$a.y<this._boundingBoxCenter.y?0:1)+(n$a.x<this._boundingBoxCenter.x?0:1)},n$a.updateObject=function(n$a){1===Collision.boxContainsBox(this._relaxBox,n$a.boundingBox)?(this.removeObject(n$a),n$a._treeNode=null,this.addNodeDown(n$a,this._currentDepth)):this._parent&&(this.removeObject(n$a),n$a._treeNode=null,this._parent.addNodeUp(n$a,this._currentDepth-1))},n$a.cullingObjects=function(n$a,n$b,n$c,n$d,n$e){var n$f,n$g=0,n$h=0,n$i=0,n$j=this._scene._dynamicBatchManager;for(n$g=0,n$f=this._objects.length;n$g<n$f;n$g++){var n$k=this._objects[n$g];if(n$I.isVisible(n$k._owner.layer.mask)&&n$k.enable){if(n$b&&(n$y.treeSpriteCollision+=1,0===n$a.containsBoundSphere(n$k.boundingSphere)))continue;n$k._renderUpdate(n$e),n$k._distanceForSort=n$gb.distance(n$k.boundingSphere.center,n$d)+n$k.sortingFudge;var n$l=n$k._renderElements;for(n$h=0,n$i=n$l.length;n$h<n$i;n$h++){var n$m=n$l[n$h],n$n=n$m._staticBatch;if(n$n&&n$n._material===n$m._material)n$n._addBatchRenderElement(n$m);else{var n$o=n$m.renderObj;n$o.triangleCount<10&&1===n$o._vertexBufferCount&&n$o._getIndexBuffer()&&n$m._material.renderQueue<2&&n$m._canDynamicBatch&&!n$k._owner.isStatic?n$j._addPrepareRenderElement(n$m):this._scene.getRenderQueue(n$m._material.renderQueue)._addRenderElement(n$m)}}}}for(n$g=0;n$g<8;n$g++){var n$p=this._children[n$g];if(null!=n$p){var n$q=n$b;if(n$b){var n$r=n$a.containsBoundBox(n$p._relaxBox);if(n$y.treeNodeCollision+=1,0===n$r)continue;n$q=2===n$r}n$p.cullingObjects(n$a,n$q,n$c,n$d,n$e)}}},n$a.cullingShadowObjects=function(n$a,n$b,n$c,n$d,n$e){var n$f,n$g=0,n$h=0,n$i=0;this._scene._dynamicBatchManager;for(n$g=0,n$f=this._objects.length;n$g<n$f;n$g++){var n$j=this._objects[n$g];if(n$j.castShadow&&n$I.isVisible(n$j._owner.layer.mask)&&n$j.enable){if(n$c&&0===n$a[0].containsBoundSphere(n$j.boundingSphere))continue;for(var n$k=1,n$l=n$a.length;n$k<n$l;n$k++){var n$m=n$b[n$k-1];if(0!==n$a[n$k].containsBoundSphere(n$j.boundingSphere)){var n$n=n$j._renderElements;for(n$h=0,n$i=n$n.length;n$h<n$i;n$h++)n$m._addRenderElement(n$n[n$h])}}}}for(n$g=0;n$g<8;n$g++){var n$o=this._children[n$g];if(null!=n$o){var n$p=n$c;if(n$c){var n$q=n$a[0].containsBoundBox(n$o._relaxBox);if(0===n$q)continue;n$p=2===n$q}n$o.cullingShadowObjects(n$a,n$b,n$p,n$d,n$e)}}},n$a.cullingShadowObjectsOnePSSM=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g,n$h=n$b[0],n$i=0,n$j=0,n$k=0;for(n$i=0,n$g=this._objects.length;n$i<n$g;n$i++){var n$l=this._objects[n$i];if(n$l.castShadow&&n$I.isVisible(n$l._owner.layer.mask)&&n$l.enable){if(n$d&&0===n$a.containsBoundSphere(n$l.boundingSphere))continue;n$l._renderUpdate(n$c);var n$m=n$l._renderElements;for(n$j=0,n$k=n$m.length;n$j<n$k;n$j++)n$h._addRenderElement(n$m[n$j])}}for(n$i=0;n$i<8;n$i++){var n$n=this._children[n$i];if(null!=n$n){var n$o=n$d;if(n$d){var n$p=n$a.containsBoundBox(n$n._relaxBox);if(0===n$p)continue;n$o=2===n$p}n$n.cullingShadowObjectsOnePSSM(n$a,n$b,n$c,n$o,n$e,n$f)}}},n$a.renderBoudingBox=function(n$a){this._renderBoudingBox(n$a);for(var n$b=0;n$b<8;++n$b){var n$c=this._children[n$b];n$c&&n$c.renderBoudingBox(n$a)}},n$a.buildAllChild=function(n$a){if(n$a<this._scene.treeLevel)for(var n$b=0;n$b<8;n$b++){this.addChild(n$b).buildAllChild(n$a+1)}},n$a._renderBoudingBox=function(n$a){},n$o(0,n$a,"exactBox",function(){return this._exactBox},function(n$a){this._exactBox=n$a,n$gb.add(n$a.min,n$a.max,this._boundingBoxCenter),n$gb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),n$o(0,n$a,"relaxBox",function(){return this._relaxBox},function(n$a){(this._relaxBox=n$a).getCorners(this._corners),n$_a.createfromPoints(this._corners,this._boundingSphere)}),n$g.debugMode=!1,n$g.relax=1.15,n$g.CHILDNUM=8,n$l(n$g,["tempVector0",function(){return this.tempVector0=new n$gb},"tempSize",function(){return this.tempSize=new n$gb},"tempCenter",function(){return this.tempCenter=new n$gb},"_octreeSplit",function(){return this._octreeSplit=[new n$gb(.25,.25,.25),new n$gb(.75,.25,.25),new n$gb(.25,.75,.25),new n$gb(.75,.75,.25),new n$gb(.25,.25,.75),new n$gb(.75,.25,.75),new n$gb(.25,.75,.75),new n$gb(.75,.75,.75)]}]),n$g}(),n$$=(function(){function n$a(){}n$n(n$a,"laya.d3.core.scene.SceneManager")}(),function(){function n$a(n$a,n$b,n$c,n$d){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===n$a&&(n$a=1),void 0===n$b&&(n$b=1),void 0===n$c&&(n$c=1),void 0===n$d&&(n$d=1),this._r=n$a,this._g=n$b,this._b=n$c,this._a=n$d}return n$n(n$a,"laya.d3.core.trail.module.Color",null,"Color$1"),n$a.prototype.cloneTo=function(n$a){n$a._r=this._r,n$a._g=this._g,n$a._b=this._b,n$a._a=this._a},n$l(n$a,["RED",function(){return this.RED=new n$a(1,0,0,1)},"GREEN",function(){return this.GREEN=new n$a(0,1,0,1)},"BLUE",function(){return this.BLUE=new n$a(0,0,1,1)},"CYAN",function(){return this.CYAN=new n$a(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new n$a(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new n$a(1,0,1,1)},"GRAY",function(){return this.GRAY=new n$a(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new n$a(1,1,1,1)},"BLACK",function(){return this.BLACK=new n$a(0,0,0,1)}]),n$a}()),n$_=(function(){function n$a(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}n$n(n$a,"laya.d3.core.trail.module.Gradient");var n$b=n$a.prototype;n$b.setKeys=function(n$a,n$b){var n$c,n$d;this._colorKeys=n$a;for(var n$e=this.index=0;n$e<n$a.length;n$e++){var n$f=(n$c=n$a[n$e]).color;this._colorKeyData[this.index++]=n$f._r,this._colorKeyData[this.index++]=n$f._g,this._colorKeyData[this.index++]=n$f._b,this._colorKeyData[this.index++]=n$c.time}this._alphaKeys=n$b;for(var n$g=this.index=0;n$g<n$b.length;n$g++)n$d=n$b[n$g],this._alphaKeyData[this.index++]=n$d.alpha,this._alphaKeyData[this.index++]=n$d.time},n$b.cloneTo=function(n$a){var n$b=0,n$c=0,n$d=this.colorKeys,n$e=[];for(n$b=0,n$c=n$d.length;n$b<n$c;n$b++){var n$f=new n$A;n$d[n$b].cloneTo(n$f),n$e.push(n$f)}var n$g=this.alphaKeys,n$h=[];for(n$b=0,n$c=n$g.length;n$b<n$c;n$b++){var n$i=new n$_;n$g[n$b].cloneTo(n$i),n$h.push(n$i)}n$a.setKeys(n$e,n$h)},n$o(0,n$b,"mode",function(){return this._mode},function(n$a){this._mode=n$a}),n$o(0,n$b,"colorKeys",function(){return this._colorKeys},function(n$a){this._colorKeys=n$a;for(var n$b=this.index=0;n$b<n$a.length;n$b++){var n$c=n$a[n$b],n$d=n$c.color;this._colorKeyData[this.index++]=n$d._r,this._colorKeyData[this.index++]=n$d._g,this._colorKeyData[this.index++]=n$d._b,this._colorKeyData[this.index++]=n$c.time}}),n$o(0,n$b,"alphaKeys",function(){return this._alphaKeys},function(n$a){this._alphaKeys=n$a;for(var n$b=this.index=0;n$b<n$a.length;n$b++){var n$c=n$a[n$b];this._alphaKeyData[this.index++]=n$c.alpha,this._alphaKeyData[this.index++]=n$c.time}})}(),function(){function n$a(n$a,n$b){this._alpha=NaN,this._time=NaN,void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),this._alpha=n$a,this._time=n$b}n$n(n$a,"laya.d3.core.trail.module.GradientAlphaKey");var n$b=n$a.prototype;return n$b.cloneTo=function(n$a){n$a.alpha=this.alpha,n$a.time=this.time},n$o(0,n$b,"alpha",function(){return this._alpha},function(n$a){this._alpha=n$a}),n$o(0,n$b,"time",function(){return this._time},function(n$a){this._time=n$a}),n$a}()),n$A=function(){function n$a(n$a,n$b){this._color=null,this._time=NaN,void 0===n$b&&(n$b=0),this._color=n$a||new n$$,this._time=n$b}n$n(n$a,"laya.d3.core.trail.module.GradientColorKey");var n$b=n$a.prototype;return n$b.cloneTo=function(n$a){this.color.cloneTo(n$a.color),n$a.time=this.time},n$o(0,n$b,"color",function(){return this._color},function(n$a){this._color=n$a}),n$o(0,n$b,"time",function(){return this._time},function(n$a){this._time=n$a}),n$a}(),n$B=(function(){function n$a(){}n$n(n$a,"laya.d3.core.trail.module.GradientMode"),n$a.Blend=0,n$a.Fixed=1}(),function(){function n$a(){}n$n(n$a,"laya.d3.core.trail.module.TextureMode"),n$a.Stretch=0,n$a.Tile=1}(),function(){function n$a(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}n$n(n$a,"laya.d3.core.trail.module.TrailKeyFrame"),n$a.prototype.cloneTo=function(n$a){n$a.time=this.time,n$a.inTangent=this.inTangent,n$a.outTangent=this.outTangent,n$a.value=this.value}}(),function(){function n$b(n$a){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new n$gb,this._curPosition=new n$gb,this._delVector3=new n$gb,this._lastFixedVertexPosition=new n$gb,this._pointAtoBVector3=new n$gb,this._pointA=new n$gb,this._pointB=new n$gb,this._owner=n$a,this._id=n$b.renderElementCount++,0==this._id?n$a._owner.transform.position.cloneTo(this._lastPosition):n$a._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new n$Ob(n$B.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new n$Ob(n$B.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}n$n(n$b,"laya.d3.core.trail.TrailRenderElement");var n$a=n$b.prototype;n$v.imps(n$a,{"laya.d3.core.render.IRenderable":!0}),n$a._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},n$a._addTrailByFirstPosition=function(n$a,n$b){n$gb.subtract(n$b,n$a,this._delVector3),n$gb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),n$gb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),n$gb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(n$a),n$a.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},n$a._addTrailByNextPosition=function(n$a){n$gb.subtract(n$a,this._lastFixedVertexPosition,this._delVector3),n$gb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),n$gb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),n$gb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=n$gb.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=n$Aa.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(n$a),n$a.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(n$a),this._virtualVerticesCount=2)},n$a._updateVerticesByPosition=function(n$a){this._pointe=n$a.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},n$a._updateVertexBuffer2=function(){var n$a,n$b=0,n$c=0,n$d=0;for(n$d=0,n$a=(this._verticesCount+this._virtualVerticesCount)/2;n$d<n$a;n$d++)n$c=0==this._owner.textureMode?(this._VerticesToTailLength[n$d]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[n$d],this._vertices2[n$b++]=1-n$c,this._vertices2[n$b++]=1-n$c;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},n$a._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},n$a._updateDisappear=function(){var n$a,n$b=0;for(n$b=this._curDisappearIndex,n$a=(this._verticesCount+this._virtualVerticesCount)/2;n$b<n$a;n$b++)this._owner._curtime-this._everyGroupVertexBirthTime[n$b]>=this._owner.time+n$Aa.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},n$a._beforeRender=function(n$a){return this._camera=n$a.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),n$gb.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},n$a._render=function(n$a){this._isDead||(n$F.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),n$y.drawCall++,n$y.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},n$a._getVertexBuffer=function(n$a){return void 0===n$a&&(n$a=0),0===n$a?this._vertexBuffer1:1===n$a?this._vertexBuffer2:null},n$a._getVertexBuffers=function(){return this._vertexBuffers},n$a._getIndexBuffer=function(){return null},n$a.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},n$a._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},n$o(0,n$a,"_vertexBufferCount",function(){return this._vertexBuffers.length}),n$o(0,n$a,"triangleCount",function(){return 0}),n$b.renderElementCount=0}(),function(){function n$a(){}n$n(n$a,"laya.d3.core.trail.VertexTrail");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration1}),n$o(1,n$a,"vertexDeclaration1",function(){return n$a._vertexDeclaration1}),n$o(1,n$a,"vertexDeclaration2",function(){return n$a._vertexDeclaration2}),n$l(n$a,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new n$fa(32,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",41),new n$ga(24,"single",33),new n$ga(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new n$fa(4,[new n$ga(0,"single",38)])}]),n$a}()),n$aa=function(){function n$u(n$a){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=n$a}n$n(n$u,"laya.d3.graphics.DynamicBatch");var n$a=n$u.prototype;return n$v.imps(n$a,{"laya.d3.core.render.IRenderable":!0}),n$a._getVertexBuffer=function(n$a){return void 0===n$a&&(n$a=0),0===n$a?this._vertexBuffer:null},n$a._getIndexBuffer=function(){return this._indexBuffer},n$a._getCombineRenderElementFromPool=function(n$a,n$b,n$c){var n$d=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return n$d||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=n$d=new n$W,n$d._sprite3D=new n$Xb),n$d._sprite3D._render._renderUpdate(n$c),n$d},n$a._getRenderElement=function(n$a,n$b,n$c){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*n$u.maxVertexCount),this._indexDatas=new Uint16Array(n$u.maxIndexCount),this._vertexBuffer=n$Ob.create(this._vertexDeclaration,n$u.maxVertexCount,35048),this._indexBuffer=n$Nb.create("ushort",n$u.maxIndexCount,35048));for(var n$d=this._merageElements.length=0,n$e=0,n$f=0,n$g=this._combineRenderElements.length;n$f<n$g;n$f++){var n$h=this._combineRenderElements[n$f],n$i=n$h.getDynamicBatchBakedVertexs(0),n$j=n$h.getBakedIndices(),n$k=n$h._sprite3D.transform._isFrontFaceInvert,n$l=n$d/(this._vertexDeclaration.vertexStride/4),n$m=n$e,n$n=n$m+n$j.length;n$h._tempBatchIndexStart=n$m,n$h._tempBatchIndexEnd=n$n,this._indexDatas.set(n$j,n$e);var n$o=0;if(n$k)for(n$o=n$m;n$o<n$n;n$o+=3){this._indexDatas[n$o]=n$l+this._indexDatas[n$o];var n$p=this._indexDatas[n$o+1],n$q=this._indexDatas[n$o+2];this._indexDatas[n$o+1]=n$l+n$q,this._indexDatas[n$o+2]=n$l+n$p}else for(n$o=n$m;n$o<n$n;n$o+=3)this._indexDatas[n$o]=n$l+this._indexDatas[n$o],this._indexDatas[n$o+1]=n$l+this._indexDatas[n$o+1],this._indexDatas[n$o+2]=n$l+this._indexDatas[n$o+2];n$e+=n$j.length,this._vertexDatas.set(n$i,n$d),n$d+=n$i.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),n$f=this._combineRenderElementPoolIndex=0,n$g=this._materials.length;n$f<n$g;n$f++){var n$r=this._getCombineRenderElementFromPool(n$a,n$b,n$c);n$r._type=2,n$r._staticBatch=null;var n$s=(n$r.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[n$f]]._tempBatchIndexStart,n$t=n$f+1===this._materialToRenderElementsOffsets.length?n$e:this._combineRenderElements[this._materialToRenderElementsOffsets[n$f+1]]._tempBatchIndexStart;n$r._tempBatchIndexStart=n$s,n$r._tempBatchIndexEnd=n$t,n$r._material=this._materials[n$f],this._merageElements.push(n$r)}},n$a._addCombineRenderObjTest=function(n$a){var n$b=n$a.renderObj,n$c=this._currentCombineIndexCount+n$b._getIndexBuffer().indexCount,n$d=this._currentCombineVertexCount+n$b._getVertexBuffer().vertexCount;return!(n$u.maxVertexCount<n$d||n$u.maxIndexCount<n$c)},n$a._addCombineRenderObj=function(n$a){var n$b=n$a.renderObj;this._combineRenderElements.push(n$a),this._currentCombineIndexCount=this._currentCombineIndexCount+n$b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+n$b._getVertexBuffer().vertexCount},n$a._addCombineMaterial=function(n$a){this._materials.push(n$a)},n$a._addMaterialToRenderElementOffset=function(n$a){this._materialToRenderElementsOffsets.push(n$a)},n$a._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},n$a._addToRenderQueue=function(n$a,n$b,n$c,n$d){this._getRenderElement(n$b,n$c,n$d);for(var n$e=0,n$f=this._materials.length;n$e<n$f;n$e++)n$a.getRenderQueue(this._materials[n$e].renderQueue)._addDynamicBatchElement(this._merageElements[n$e])},n$a._beforeRender=function(n$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},n$a._render=function(n$a){var n$b=n$a._batchIndexEnd-n$a._batchIndexStart;n$F.mainContext.drawElements(4,n$b,5123,2*n$a._batchIndexStart),n$y.drawCall++,n$y.trianglesFaces+=n$b/3},n$a._getVertexBuffers=function(){return null},n$o(0,n$a,"_vertexBufferCount",function(){return 1}),n$o(0,n$a,"triangleCount",function(){return this._indexBuffer.indexCount/3}),n$o(0,n$a,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),n$u.maxVertexCount=2e4,n$u.maxIndexCount=4e4,n$u.maxCombineTriangleCount=10,n$u}(),n$ba=function(){function n$u(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}n$n(n$u,"laya.d3.graphics.DynamicBatchManager");var n$a=n$u.prototype;return n$a.getDynamicBatch=function(n$a,n$b){var n$c,n$d=n$a.id.toString()+n$b;return this._dynamicBatches[n$d]?n$c=this._dynamicBatches[n$d]:this._dynamicBatches[n$d]=n$c=new n$aa(n$a),n$c},n$a._garbageCollection=function(){for(var n$a in this._dynamicBatches)0===this._dynamicBatches[n$a].combineRenderElementsCount&&delete this._dynamicBatches[n$a]},n$a._addPrepareRenderElement=function(n$a){this._prepareDynamicBatchCombineElements.push(n$a)},n$a._finishCombineDynamicBatch=function(n$a){var n$b,n$c,n$d;this._prepareDynamicBatchCombineElements.sort(n$u._sortPrepareDynamicBatch);for(var n$e,n$f,n$g,n$h,n$i,n$j=-1,n$k=!0,n$l=0,n$m=-1,n$n=0,n$o=this._prepareDynamicBatchCombineElements.length;n$n<n$o;n$n++){var n$p=(n$f=this._prepareDynamicBatchCombineElements[n$n]).renderObj._getVertexBuffer(0).vertexDeclaration,n$q=n$c!==n$p;n$q&&(n$l=0,n$c=n$p);var n$r=n$l!==n$j;if(n$r&&(n$j=n$l),(n$q||n$r)&&(n$g=this.getDynamicBatch(n$p,n$l),n$b=null),n$k)if(n$g._addCombineRenderObjTest(n$f)){if(n$b!==(n$e=n$f._material))n$h&&(n$a.getRenderQueue(n$i._material.renderQueue)._addRenderElement(n$i),n$i=n$h=null,n$m=-1),n$h=n$e,n$m=n$g.combineRenderElementsCount,n$i=n$f,n$b=n$e;else if(n$h){var n$s=n$i.renderObj,n$t=n$f.renderObj;n$s._getVertexBuffer().vertexCount+n$t._getVertexBuffer().vertexCount>n$aa.maxVertexCount||n$s._getIndexBuffer().indexCount+n$t._getIndexBuffer().indexCount>n$aa.maxIndexCount?(n$a.getRenderQueue(n$i._material.renderQueue)._addRenderElement(n$i),n$h=n$e,n$m=n$g.combineRenderElementsCount,n$i=n$f):(n$g._addCombineMaterial(n$h),n$g._addMaterialToRenderElementOffset(n$m),n$g._addCombineRenderObj(n$i),n$i=n$h=null,n$m=-1,n$g._addCombineRenderObj(n$f))}else n$g._addCombineRenderObj(n$f);n$k=!0}else n$h&&(n$a.getRenderQueue(n$i._material.renderQueue)._addRenderElement(n$i),n$i=n$h=null,n$m=-1),n$l++,n$k=!1;else n$d=this._prepareDynamicBatchCombineElements[n$n-1],n$g._addMaterialToRenderElementOffset(n$g.combineRenderElementsCount),n$b=n$d._material,n$g._addCombineMaterial(n$b),n$g._addCombineRenderObj(n$d),n$k=!0,n$b!==(n$e=n$f._material)?(n$h=n$e,n$m=n$g.combineRenderElementsCount,n$i=n$f):n$g._addCombineRenderObj(n$f),n$b=n$e}n$h&&(n$a.getRenderQueue(n$i._material.renderQueue)._addRenderElement(n$i),n$i=n$h=null,n$m=-1),this._prepareDynamicBatchCombineElements.length=0},n$a._clearRenderElements=function(){for(var n$a in this._dynamicBatches)this._dynamicBatches[n$a]._clearRenderElements()},n$a._addToRenderQueue=function(n$a,n$b,n$c,n$d){for(var n$e in this._dynamicBatches){var n$f=this._dynamicBatches[n$e];0<n$f.combineRenderElementsCount&&n$f._addToRenderQueue(n$a,n$b,n$c,n$d)}},n$a.dispose=function(){this._dynamicBatches=null},n$u._sortPrepareDynamicBatch=function(n$a,n$b){return n$a._mainSortID-n$b._mainSortID},n$u}(),n$ca=function(){function n$a(){}return n$n(n$a,"laya.d3.graphics.FrustumCulling"),n$a.renderShadowObjectCulling=function(n$a,n$b,n$c,n$d,n$e){var n$f=0,n$g=0,n$h=0,n$i=0;for(n$f=0,n$h=n$c.length;n$f<n$h;n$f++){var n$j=n$c[n$f];n$j&&n$j._clearRenderElements()}var n$k,n$l,n$m,n$n=n$a._cullingRenders;if(1<n$e){for(n$f=0,n$h=n$a._cullingRendersLength;n$f<n$h;n$f++)if((n$k=n$n[n$f]).castShadow&&n$I.isVisible(n$k._owner.layer.mask)&&n$k.enable)for(var n$o=1,n$p=n$b.length;n$o<n$p;n$o++)if(n$l=n$c[n$o-1],0!==n$b[n$o].containsBoundSphere(n$k.boundingSphere))for(n$g=0,n$i=(n$m=n$k._renderElements).length;n$g<n$i;n$g++)n$l._addRenderElement(n$m[n$g])}else for(n$f=0,n$h=n$a._cullingRendersLength;n$f<n$h;n$f++)if((n$k=n$n[n$f]).castShadow&&n$I.isVisible(n$k._owner.layer.mask)&&n$k.enable&&0!==n$b[0].containsBoundSphere(n$k.boundingSphere))for(n$k._renderUpdate(n$d),n$l=n$c[0],n$g=0,n$i=(n$m=n$k._renderElements).length;n$g<n$i;n$g++)n$l._addRenderElement(n$m[n$g])},n$a.renderShadowObjectCullingOctree=function(n$a,n$b,n$c,n$d,n$e){for(var n$f=0,n$g=n$c.length;n$f<n$g;n$f++){var n$h=n$c[n$f];n$h&&n$h._clearRenderElements()}1<n$e?n$a.treeRoot.cullingShadowObjects(n$b,n$c,!0,0,n$a):n$a.treeRoot.cullingShadowObjectsOnePSSM(n$b[0],n$c,n$d,!0,0,n$a)},n$a.renderObjectCulling=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=0,n$h=0,n$i=0,n$j=0,n$k=n$b._quenes,n$l=n$b._dynamicBatchManager,n$m=n$b._cullingRenders;for(n$g=0,n$h=n$k.length;n$g<n$h;n$g++){var n$n=n$k[n$g];n$n&&n$n._clearRenderElements()}var n$o=n$da._staticBatchManagers;for(n$g=0,n$h=n$o.length;n$g<n$h;n$g++)n$o[n$g]._clearRenderElements();n$l._clearRenderElements();var n$p=n$c.transform.position;for(n$g=0,n$h=n$b._cullingRendersLength;n$g<n$h;n$g++){var n$q=n$m[n$g];if(n$I.isVisible(n$q._owner.layer.mask)&&n$q.enable&&0!==n$a.containsBoundSphere(n$q.boundingSphere)&&n$q._renderUpdate(n$f)){n$q._distanceForSort=n$gb.distance(n$q.boundingSphere.center,n$p)+n$q.sortingFudge;var n$r=n$q._renderElements;for(n$i=0,n$j=n$r.length;n$i<n$j;n$i++){var n$s=n$r[n$i],n$t=n$s._staticBatch;if(n$t&&n$t._material===n$s._material)n$t._addBatchRenderElement(n$s);else{var n$u=n$s.renderObj;n$u.triangleCount<10&&1===n$u._vertexBufferCount&&n$u._getIndexBuffer()&&n$s._material.renderQueue<2&&n$s._canDynamicBatch&&!n$q._owner.isStatic?n$l._addPrepareRenderElement(n$s):n$b.getRenderQueue(n$s._material.renderQueue)._addRenderElement(n$s)}}}}for(n$g=0,n$h=n$o.length;n$g<n$h;n$g++)n$o[n$g]._addToRenderQueue(n$b,n$d,n$e,n$f);n$l._finishCombineDynamicBatch(n$b),n$l._addToRenderQueue(n$b,n$d,n$e,n$f)},n$a.renderObjectCullingOctree=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=0,n$h=0,n$i=n$b._quenes,n$j=n$b._dynamicBatchManager;for(n$g=0,n$h=n$i.length;n$g<n$h;n$g++){var n$k=n$i[n$g];n$k&&n$k._clearRenderElements()}var n$l=n$da._staticBatchManagers;for(n$g=0,n$h=n$l.length;n$g<n$h;n$g++)n$l[n$g]._clearRenderElements();for(n$j._clearRenderElements(),n$b._cullingRenders.length=0,n$b.treeRoot.cullingObjects(n$a,!0,0,n$c.transform.position,n$f),n$g=0,n$h=n$l.length;n$g<n$h;n$g++)n$l[n$g]._addToRenderQueue(n$b,n$d,n$e,n$f);n$j._finishCombineDynamicBatch(n$b),n$j._addToRenderQueue(n$b,n$d,n$e,n$f)},n$a.renderObjectCullingNoBoundFrustum=function(n$a,n$b,n$c,n$d,n$e){var n$f=0,n$g=0,n$h=0,n$i=0,n$j=n$a._quenes,n$k=n$a._dynamicBatchManager,n$l=n$a._cullingRenders;for(n$f=0,n$g=n$j.length;n$f<n$g;n$f++){var n$m=n$j[n$f];n$m&&n$m._clearRenderElements()}var n$n=n$da._staticBatchManagers;for(n$f=0,n$g=n$n.length;n$f<n$g;n$f++)n$n[n$f]._clearRenderElements();n$k._clearRenderElements();var n$o=n$b.transform.position;for(n$f=0,n$g=n$a._cullingRendersLength;n$f<n$g;n$f++){var n$p=n$l[n$f];if(n$I.isVisible(n$p._owner.layer.mask)&&n$p.enable){n$p._renderUpdate(n$e),n$p._distanceForSort=n$gb.distance(n$p.boundingSphere.center,n$o)+n$p.sortingFudge;var n$q=n$p._renderElements;for(n$h=0,n$i=n$q.length;n$h<n$i;n$h++){var n$r=n$q[n$h],n$s=n$r._staticBatch;if(n$s&&n$s._material===n$r._material)n$s._addBatchRenderElement(n$r);else{var n$t=n$r.renderObj;n$t.triangleCount<10&&1===n$t._vertexBufferCount&&n$t._getIndexBuffer()&&n$r._material.renderQueue<2&&n$r._canDynamicBatch&&!n$p._owner.isStatic?n$k._addPrepareRenderElement(n$r):n$a.getRenderQueue(n$r._material.renderQueue)._addRenderElement(n$r)}}}}for(n$f=0,n$g=n$n.length;n$f<n$g;n$f++)n$n[n$f]._addToRenderQueue(n$a,n$c,n$d,n$e);n$k._finishCombineDynamicBatch(n$a),n$k._addToRenderQueue(n$a,n$c,n$d,n$e)},n$a}(),n$da=function(){function n$f(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}n$n(n$f,"laya.d3.graphics.StaticBatchManager");var n$a=n$f.prototype;return n$a._finishInit=function(){for(var n$a in this._staticBatches)this._staticBatches[n$a]._finishInit();this._initBatchRenderElements.length=0},n$a._initStaticBatchs=function(n$a){throw new Error("StaticBatchManager:must override this function.")},n$a._addInitBatchSprite=function(n$a){for(var n$b=n$a._render._renderElements,n$c=0,n$d=n$b.length;n$c<n$d;n$c++)this._initBatchRenderElements.push(n$b[n$c])},n$a._clearRenderElements=function(){for(var n$a in this._staticBatches)this._staticBatches[n$a]._clearRenderElements()},n$a._garbageCollection=function(n$a){var n$b=n$a._staticBatch,n$c=n$b._initBatchRenderElements,n$d=n$c.indexOf(n$a);n$c.splice(n$d,1),0===n$c.length&&(n$b.dispose(),delete this._staticBatches[n$b._key])},n$a._addToRenderQueue=function(n$a,n$b,n$c,n$d){for(var n$e in this._staticBatches){var n$f=this._staticBatches[n$e];0<n$f._batchRenderElements.length&&n$f._updateToRenderQueue(n$a,n$d)}},n$a.dispose=function(){this._staticBatches=null},n$f._addToStaticBatchQueue=function(n$a){n$a instanceof laya.d3.core.RenderableSprite3D&&n$a._addToInitStaticBatchManager();for(var n$b=0,n$c=n$a.numChildren;n$b<n$c;n$b++)n$f._addToStaticBatchQueue(n$a._childs[n$b])},n$f.combine=function(n$a,n$b){var n$c,n$d=0,n$e=0;if(n$b)for(n$d=0,n$e=n$b.length;n$d<n$e;n$d++){n$b[n$d]._addToInitStaticBatchManager()}else n$a&&n$f._addToStaticBatchQueue(n$a);for(n$d=0,n$e=n$f._staticBatchManagers.length;n$d<n$e;n$d++)(n$c=n$f._staticBatchManagers[n$d])._initStaticBatchs(n$a),n$c._finishInit()},n$f._staticBatchManagers=[],n$f}(),n$ea=function(){function n$a(n$a,n$b,n$c){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=n$a,this._manager=n$b,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=n$c}n$n(n$a,"laya.d3.graphics.StaticBatch");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),n$b._binarySearch=function(n$a){for(var n$b=0,n$c=this._batchRenderElements.length-1,n$d=0;n$b<=n$c;)n$d=Math.floor((n$b+n$c)/2),this._compareBatchRenderElement(this._batchRenderElements[n$d],n$a)?n$c=n$d-1:n$b=n$d+1;return n$b},n$b._compareBatchRenderElement=function(n$a,n$b){throw new Error("StaticBatch:must override this function.")},n$b._getVertexDecLightMap=function(n$a){return n$a===n$Na.vertexDeclaration?n$Ia.vertexDeclaration:n$a===n$Ma.vertexDeclaration?n$Ha.vertexDeclaration:n$a===n$za.vertexDeclaration?n$ua.vertexDeclaration:n$a===n$Ra.vertexDeclaration?null:n$a===n$pa.vertexDeclaration?n$qa.vertexDeclaration:n$a===n$Pa.vertexDeclaration?n$Ka.vertexDeclaration:n$a===n$Fa.vertexDeclaration?n$Ga.vertexDeclaration:n$a===n$Oa.vertexDeclaration?n$Ja.vertexDeclaration:n$a===n$Ma.vertexDeclaration?n$Ha.vertexDeclaration:n$a===n$Ca.vertexDeclaration?n$va.vertexDeclaration:n$a===n$Ra.vertexDeclaration?null:n$a===n$pa.vertexDeclaration?n$qa.vertexDeclaration:n$a===n$Qa.vertexDeclaration?n$La.vertexDeclaration:n$a===n$Fa.vertexDeclaration?n$Ga.vertexDeclaration:n$a},n$b._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},n$b._addBatchRenderElement=function(n$a){this._batchRenderElements.splice(this._binarySearch(n$a),0,n$a)},n$b._updateToRenderQueue=function(n$a,n$b){this._combineRenderElementPoolIndex=0,this._getRenderElement(n$a.getRenderQueue(this._material.renderQueue)._renderElements,n$a,n$b)},n$b._getRenderElement=function(n$a,n$b,n$c){throw new Error("StaticBatch:must override this function.")},n$b._finishInit=function(){throw new Error("StaticBatch:must override this function.")},n$b._clearRenderElements=function(){this._batchRenderElements.length=0},n$b.dispose=function(){},n$b._getVertexBuffer=function(n$a){return void 0===n$a&&(n$a=0),null},n$b._getIndexBuffer=function(){return null},n$b._beforeRender=function(n$a){return!0},n$b._render=function(n$a){},n$b._getVertexBuffers=function(){return null},n$o(0,n$b,"_vertexBufferCount",function(){return 1}),n$o(0,n$b,"triangleCount",function(){return 0}),n$a.combine=function(n$a){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),n$da.combine(n$a)},n$a.maxBatchVertexCount=65535,n$a}(),n$fa=function(){function n$g(n$a,n$b){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++n$g._uniqueIDCounter,this._id>n$g.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",n$g.maxVertexDeclaration);this._shaderValues=new n$mb,this._vertexElementsDic={},this._vertexStride=n$a,this._vertexElements=n$b;for(var n$c=0;n$c<n$b.length;n$c++){var n$d=n$b[n$c],n$e=n$d.elementUsage;this._vertexElementsDic[n$e]=n$d;var n$f=[n$g._getTypeSize(n$d.elementFormat)/4,5126,!1,this._vertexStride,n$d.offset];switch(this._shaderValues.setValue(n$e,n$f),n$e){case 1:this._addShaderDefine(n$yb.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(n$yb.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(n$yb.SHADERDEFINE_UV1)}}}n$n(n$g,"laya.d3.graphics.VertexDeclaration");var n$a=n$g.prototype;return n$a._addShaderDefine=function(n$a){this._shaderDefineValue|=n$a},n$a._removeShaderDefine=function(n$a){this._shaderDefineValue&=~n$a},n$a.getVertexElements=function(){return this._vertexElements.slice()},n$a.getVertexElementByUsage=function(n$a){return this._vertexElementsDic[n$a]},n$a.unBinding=function(){},n$o(0,n$a,"shaderDefineValue",function(){return this._shaderDefineValue}),n$o(0,n$a,"id",function(){return this._id}),n$o(0,n$a,"vertexStride",function(){return this._vertexStride}),n$o(0,n$a,"shaderValues",function(){return this._shaderValues}),n$g._getTypeSize=function(n$a){switch(n$a){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},n$g.getVertexStride=function(n$a){for(var n$b=0,n$c=0;n$c<n$a.Length;n$c++){var n$d=n$a[n$c],n$e=n$d.offset+n$g._getTypeSize(n$d.elementFormat);n$b<n$e&&(n$b=n$e)}return n$b},n$g._maxVertexDeclarationBit=1e3,n$g._uniqueIDCounter=1,n$l(n$g,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),n$g}(),n$ga=function(){function n$a(n$a,n$b,n$c){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=n$a,this.elementFormat=n$b,this.elementUsage=n$c}return n$n(n$a,"laya.d3.graphics.VertexElement"),n$a}(),n$ha=(function(){function n$a(){}n$n(n$a,"laya.d3.graphics.VertexElementFormat"),n$a.Single="single",n$a.Vector2="vector2",n$a.Vector3="vector3",n$a.Vector4="vector4",n$a.Color="color",n$a.Byte4="byte4",n$a.Short2="short2",n$a.Short4="short4",n$a.NormalizedShort2="normalizedshort2",n$a.NormalizedShort4="normalizedshort4",n$a.HalfVector2="halfvector2",n$a.HalfVector4="halfvector4"}(),function(){function n$a(){}n$n(n$a,"laya.d3.graphics.VertexElementUsage"),n$a.POSITION0=0,n$a.COLOR0=1,n$a.TEXTURECOORDINATE0=2,n$a.NORMAL0=3,n$a.BINORMAL0=4,n$a.TANGENT0=5,n$a.BLENDINDICES0=6,n$a.BLENDWEIGHT0=7,n$a.DEPTH0=8,n$a.FOG0=9,n$a.POINTSIZE0=10,n$a.SAMPLE0=11,n$a.TESSELLATEFACTOR0=12,n$a.COLOR1=13,n$a.NEXTTEXTURECOORDINATE0=14,n$a.TEXTURECOORDINATE1=15,n$a.NEXTTEXTURECOORDINATE1=16,n$a.CORNERTEXTURECOORDINATE0=17,n$a.VELOCITY0=18,n$a.STARTCOLOR0=19,n$a.STARTSIZE=20,n$a.AGEADDSCALE0=21,n$a.STARTROTATION=22,n$a.ENDCOLOR0=23,n$a.STARTLIFETIME=24,n$a.TIME0=33,n$a.SHAPEPOSITIONSTARTLIFETIME=30,n$a.DIRECTIONTIME=32,n$a.SIZEROTATION0=27,n$a.RADIUS0=28,n$a.RADIAN0=29,n$a.STARTSPEED=31,n$a.RANDOM0=34,n$a.RANDOM1=35,n$a.SIMULATIONWORLDPOSTION=36,n$a.SIMULATIONWORLDROTATION=37,n$a.TEXTURECOORDINATE0X=38,n$a.TEXTURECOORDINATE0X1=39,n$a.TEXTURECOORDINATE0Y=40,n$a.OFFSETVECTOR=41}(),function(){function n$a(n$a,n$b,n$c){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=n$a,this._textureCoordinate0=n$b,this._time=n$c}n$n(n$a,"laya.d3.graphics.VertexGlitter");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate0}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"time",function(){return this._time}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(24,[new n$ga(0,"vector3",0),new n$ga(12,"vector2",2),new n$ga(20,"single",33)])}])}(),function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=n$a,this._position=n$b,this._velocity=n$c,this._startColor=n$d,this._endColor=n$e,this._sizeRotation=n$f,this._radius=n$g,this._radian=n$h,this._ageAddScale=n$i,this._time=n$j}n$n(n$a,"laya.d3.graphics.VertexParticle");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"endColor",function(){return this._endColor}),n$o(0,n$b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),n$o(0,n$b,"sizeRotation",function(){return this._sizeRotation}),n$o(0,n$b,"velocity",function(){return this._velocity}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"startColor",function(){return this._startColor}),n$o(0,n$b,"radius",function(){return this._radius}),n$o(0,n$b,"radian",function(){return this._radian}),n$o(0,n$b,"ageAddScale",function(){return this._ageAddScale}),n$o(0,n$b,"time",function(){return this._time}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(116,[new n$ga(0,"vector4",17),new n$ga(16,"vector3",0),new n$ga(28,"vector3",18),new n$ga(40,"vector4",19),new n$ga(56,"vector4",23),new n$ga(72,"vector3",27),new n$ga(84,"vector2",28),new n$ga(92,"vector4",29),new n$ga(108,"single",24),new n$ga(112,"single",33)])}])}(),function(){function n$a(n$a){this._position=null,this._position=n$a}n$n(n$a,"laya.d3.graphics.VertexPosition");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(12,[new n$ga(0,"vector3",0)])}]),n$a}()),n$ia=function(){function n$a(n$a,n$b){this._position=null,this._normal=null,this._position=n$a,this._normal=n$b}n$n(n$a,"laya.d3.graphics.VertexPositionNormal");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(24,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3)])}]),n$a}(),n$ja=function(){function n$a(n$a,n$b,n$c){this._position=null,this._normal=null,this._color=null,this._position=n$a,this._normal=n$b,this._color=n$c}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColor");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(40,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1)])}]),n$a}(),n$ka=function(){function n$a(n$a,n$b,n$c,n$d,n$e){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._blendIndex=n$d,this._blendWeight=n$e}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorSkin");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(72,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector4",7),new n$ga(56,"vector4",6)])}]),n$a}(),n$la=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._tangent=n$d,this._blendIndex=n$e,this._blendWeight=n$f}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(88,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector4",7),new n$ga(56,"vector4",6),new n$ga(72,"vector4",5)])}]),n$a}(),n$ma=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._tangent=n$d,this._blendIndex=n$e,this._blendWeight=n$f}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(84,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector4",7),new n$ga(56,"vector4",6),new n$ga(72,"vector3",5)])}]),n$a}(),n$na=function(){function n$a(n$a,n$b,n$c,n$d){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._tangent=n$d}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorSTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(56,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector4",5)])}]),n$a}(),n$oa=function(){function n$a(n$a,n$b,n$c,n$d){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._tangent=n$d}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(52,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector3",5)])}]),n$a}(),n$pa=function(){function n$a(n$a,n$b,n$c,n$d){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._textureCoordinate=n$d}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTexture");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(48,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector2",2)])}]),n$a}(),n$qa=function(){function n$a(n$a,n$b,n$c,n$d,n$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._textureCoordinate0=n$d,this._textureCoordinate1=n$e}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(56,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector2",2),new n$ga(48,"vector2",15)])}]),n$a}(),n$ra=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._textureCoordinate0=n$d,this._textureCoordinate1=n$e,this._blendIndex=n$f,this._blendWeight=n$g}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(88,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector2",2),new n$ga(48,"vector2",15),new n$ga(56,"vector4",7),new n$ga(72,"vector4",6)])}]),n$a}(),n$sa=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._textureCoordinate0=n$d,this._textureCoordinate1=n$e,this._tangent=n$f,this._blendIndex=n$g,this._blendWeight=n$h}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(104,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector2",2),new n$ga(48,"vector2",15),new n$ga(56,"vector4",7),new n$ga(72,"vector4",6),new n$ga(88,"vector4",5)])}]),n$a}(),n$ta=function(){function n$a(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$b.VertexPositionNormalColorTexture0SkinTangent=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){this._position=n$a,this._normal=n$b,this._color=n$c,this._textureCoordinate0=n$d,this._textureCoordinate1=n$e,this._tangent=n$f,this._blendIndex=n$g,this._blendWeight=n$h},n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(100,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector2",2),new n$ga(48,"vector2",15),new n$ga(56,"vector4",7),new n$ga(72,"vector4",6),new n$ga(88,"vector3",5)])}]),n$a}(),n$ua=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._textureCoordinate0=n$d,this._textureCoordinate1=n$e,this._tangent=n$f}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(72,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector2",2),new n$ga(48,"vector2",15),new n$ga(56,"vector4",5)])}]),n$a}(),n$va=function(){function n$a(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$b.VertexPositionNormalColorTexture0Tangent=function(n$a,n$b,n$c,n$d,n$e,n$f){this._position=n$a,this._normal=n$b,this._color=n$c,this._textureCoordinate0=n$d,this._textureCoordinate1=n$e,this._tangent=n$f},n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(68,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector2",2),new n$ga(48,"vector2",15),new n$ga(56,"vector3",5)])}]),n$a}(),n$wa=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._textureCoordinate=n$d,this._blendIndex=n$e,this._blendWeight=n$f}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(80,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector2",2),new n$ga(48,"vector4",7),new n$ga(64,"vector4",6)])}]),n$a}(),n$xa=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._textureCoordinate=n$d,this._tangent=n$e,this._blendIndex=n$f,this._blendWeight=n$g}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(96,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector2",2),new n$ga(48,"vector4",7),new n$ga(64,"vector4",6),new n$ga(80,"vector4",5)])}]),n$a}(),n$ya=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._textureCoordinate=n$d,this._tangent=n$e,this._blendIndex=n$f,this._blendWeight=n$g}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(92,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector2",2),new n$ga(48,"vector4",7),new n$ga(64,"vector4",6),new n$ga(80,"vector3",5)])}]),n$a}(),n$za=function(){function n$a(n$a,n$b,n$c,n$d,n$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._textureCoordinate=n$d,this._tangent=n$e}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(64,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector2",2),new n$ga(48,"vector4",5)])}]),n$a}(),n$Ca=function(){function n$a(n$a,n$b,n$c,n$d,n$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._color=n$c,this._textureCoordinate=n$d,this._tangent=n$e}n$n(n$a,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"color",function(){return this._color}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(60,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",1),new n$ga(40,"vector2",2),new n$ga(48,"vector3",5)])}]),n$a}(),n$Da=function(){function n$a(n$a,n$b,n$c){this._position=null,this._normal=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._tangent=n$c}n$n(n$a,"laya.d3.graphics.VertexPositionNormalSTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(40,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector4",5)])}]),n$a}(),n$Ea=function(){function n$a(n$a,n$b,n$c){this._position=null,this._normal=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._tangent=n$c}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(36,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector3",5)])}]),n$a}(),n$Fa=function(){function n$a(n$a,n$b,n$c){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=n$a,this._normal=n$b,this._textureCoordinate=n$c}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTexture");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(32,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2)])}]),n$a}(),n$Ga=function(){function n$a(n$a,n$b,n$c,n$d){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=n$a,this._normal=n$b,this._textureCoordinate0=n$c,this._textureCoordinate1=n$d}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(40,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2),new n$ga(32,"vector2",15)])}]),n$a}(),n$Ha=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=n$a,this._normal=n$b,this._textureCoordinate0=n$c,this._textureCoordinate1=n$d,this._blendIndex=n$e,this._blendWeight=n$f}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(72,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2),new n$ga(32,"vector2",15),new n$ga(40,"vector4",7),new n$ga(56,"vector4",6)])}]),n$a}(),n$Ia=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._textureCoordinate0=n$c,this._textureCoordinate1=n$d,this._tangent=n$e,this._blendIndex=n$f,this._blendWeight=n$g}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(88,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2),new n$ga(32,"vector2",15),new n$ga(40,"vector4",7),new n$ga(56,"vector4",6),new n$ga(72,"vector4",5)])}]),n$a}(),n$Ja=function(){function n$a(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$b.VertexPositionNormalTexture0SkinTangent=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){this._position=n$a,this._normal=n$b,this._textureCoordinate0=n$c,this._textureCoordinate1=n$d,this._tangent=n$e,this._blendIndex=n$f,this._blendWeight=n$g},n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(84,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2),new n$ga(32,"vector2",15),new n$ga(40,"vector4",7),new n$ga(56,"vector4",6),new n$ga(72,"vector3",5)])}]),n$a}(),n$Ka=function(){function n$a(n$a,n$b,n$c,n$d,n$e){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._textureCoordinate0=n$c,this._textureCoordinate1=n$d,this._tangent=n$e}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(56,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2),new n$ga(32,"vector2",15),new n$ga(40,"vector4",5)])}]),n$a}(),n$La=function(){function n$a(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$b.VertexPositionNormalTexture0Tangent=function(n$a,n$b,n$c,n$d,n$e){this._position=n$a,this._normal=n$b,this._textureCoordinate0=n$c,this._textureCoordinate1=n$d,this._tangent=n$e},n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(52,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2),new n$ga(32,"vector2",15),new n$ga(40,"vector3",5)])}]),n$a}(),n$Ma=function(){function n$a(n$a,n$b,n$c,n$d,n$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=n$a,this._normal=n$b,this._textureCoordinate=n$c,this._blendIndex=n$d,this._blendWeight=n$e}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTextureSkin");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(64,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2),new n$ga(32,"vector4",7),new n$ga(48,"vector4",6)])}]),n$a}(),n$Na=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._textureCoordinate=n$c,this._tangent=n$d,this._blendIndex=n$e,this._blendWeight=n$f}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(80,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2),new n$ga(32,"vector4",7),new n$ga(48,"vector4",6),new n$ga(64,"vector4",5)])}]),n$a}(),n$Oa=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._textureCoordinate=n$c,this._tangent=n$d,this._blendIndex=n$e,this._blendWeight=n$f}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(76,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2),new n$ga(32,"vector4",7),new n$ga(48,"vector4",6),new n$ga(64,"vector3",5)])}]),n$a}(),n$Pa=function(){function n$a(n$a,n$b,n$c,n$d){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._textureCoordinate=n$c,this._tangent=n$d}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(48,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2),new n$ga(32,"vector4",5)])}]),n$a}(),n$Qa=function(){function n$a(n$a,n$b,n$c,n$d){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=n$a,this._normal=n$b,this._textureCoordinate=n$c,this._tangent=n$d}n$n(n$a,"laya.d3.graphics.VertexPositionNormalTextureTangent");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(44,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2),new n$ga(32,"vector3",5)])}]),n$a}(),n$Ra=function(){function n$a(n$a,n$b,n$c){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=n$a,this._normal=n$b,this._textureCoordinate=n$c}n$n(n$a,"laya.d3.graphics.VertexPositionNTBTexture");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(56,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector3",5),new n$ga(36,"vector3",4),new n$ga(48,"vector2",2)])}]),n$a}(),n$Sa=function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=n$a,this._normal=n$b,this._textureCoordinate0=n$d,this._textureCoordinate1=n$e,this._tangent=n$f,n$c=n$c,this._blendIndex=n$g,this._blendWeight=n$h}n$n(n$a,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"tangent",function(){return this._tangent}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(0,n$b,"textureCoordinate1",function(){return this._textureCoordinate1}),n$o(0,n$b,"blendIndex",function(){return this._blendIndex}),n$o(0,n$b,"blendWeight",function(){return this._blendWeight}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(96,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector3",5),new n$ga(36,"vector3",4),new n$ga(48,"vector2",2),new n$ga(56,"vector2",15),new n$ga(64,"vector4",7),new n$ga(80,"vector4",6)])}]),n$a}(),n$Ta=function(){function n$a(n$a,n$b,n$c){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=n$a,this._normal=n$b,this._textureCoordinate=n$c}n$n(n$a,"laya.d3.graphics.VertexPositionNTBTextureSkin");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"textureCoordinate",function(){return this._textureCoordinate}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(88,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector3",5),new n$ga(36,"vector3",4),new n$ga(48,"vector2",2),new n$ga(56,"vector4",7),new n$ga(72,"vector4",6)])}]),n$a}(),n$Ua=(function(){function n$a(n$a,n$b,n$c,n$d){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=n$a,this._normal=n$b,this._textureCoord0=n$c,this._textureCoord1=n$d}n$n(n$a,"laya.d3.graphics.VertexPositionTerrain");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"normal",function(){return this._normal}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"textureCoord0",function(){return this._textureCoord0}),n$o(0,n$b,"textureCoord1",function(){return this._textureCoord1}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(40,[new n$ga(0,"vector3",0),new n$ga(12,"vector3",3),new n$ga(24,"vector2",2),new n$ga(32,"vector2",15)])}])}(),function(){function n$a(n$a,n$b){this._position=null,this._textureCoordinate0=null,this._position=n$a,this._textureCoordinate0=n$b}n$n(n$a,"laya.d3.graphics.VertexPositionTexture0");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"position",function(){return this._position}),n$o(0,n$b,"textureCoordinate0",function(){return this._textureCoordinate0}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(20,[new n$ga(0,"vector3",0),new n$ga(12,"vector2",2)])}]),n$a}()),n$Va=(function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$l,n$m,n$n){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=n$a,this._positionStartLifeTime=n$b,this._velocity=n$c,this._startColor=n$d,this._startSize=n$e,this._startRotation0=n$f,this._startRotation1=n$g,this._startRotation2=n$h,this._startLifeTime=n$i,this._time=n$j,this._startSpeed=n$k,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=n$n}n$n(n$a,"laya.d3.graphics.VertexShurikenParticleBillboard");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),n$o(0,n$b,"random1",function(){return this._randoms1}),n$o(0,n$b,"startRotation2",function(){return this._startRotation2}),n$o(0,n$b,"positionStartLifeTime",function(){return this._positionStartLifeTime}),n$o(0,n$b,"velocity",function(){return this._velocity}),n$o(0,n$b,"random0",function(){return this._randoms0}),n$o(0,n$b,"startSize",function(){return this._startSize}),n$o(0,n$b,"startColor",function(){return this._startColor}),n$o(0,n$b,"startRotation0",function(){return this._startRotation0}),n$o(0,n$b,"startRotation1",function(){return this._startRotation1}),n$o(0,n$b,"startLifeTime",function(){return this._startLifeTime}),n$o(0,n$b,"time",function(){return this._time}),n$o(0,n$b,"startSpeed",function(){return this._startSpeed}),n$o(0,n$b,"simulationWorldPostion",function(){return this._simulationWorldPostion}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(152,[new n$ga(0,"vector4",17),new n$ga(16,"vector4",30),new n$ga(32,"vector4",32),new n$ga(48,"vector4",19),new n$ga(64,"vector3",20),new n$ga(76,"vector3",22),new n$ga(88,"single",31),new n$ga(92,"vector4",34),new n$ga(108,"vector4",35),new n$ga(124,"vector3",36),new n$ga(136,"vector4",37)])}])}(),function(){function n$a(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$l,n$m,n$n){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=n$a,this._positionStartLifeTime=n$b,this._velocity=n$c,this._startColor=n$d,this._startSize=n$e,this._startRotation0=n$f,this._startRotation1=n$g,this._startRotation2=n$h,this._startLifeTime=n$i,this._time=n$j,this._startSpeed=n$k,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=n$n}n$n(n$a,"laya.d3.graphics.VertexShurikenParticleMesh");var n$b=n$a.prototype;n$v.imps(n$b,{"laya.d3.graphics.IVertex":!0}),n$o(0,n$b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),n$o(0,n$b,"velocity",function(){return this._velocity}),n$o(0,n$b,"position",function(){return this._positionStartLifeTime}),n$o(0,n$b,"random0",function(){return this._randoms0}),n$o(0,n$b,"startSize",function(){return this._startSize}),n$o(0,n$b,"startColor",function(){return this._startColor}),n$o(0,n$b,"startRotation0",function(){return this._startRotation0}),n$o(0,n$b,"startRotation1",function(){return this._startRotation1}),n$o(0,n$b,"random1",function(){return this._randoms1}),n$o(0,n$b,"startRotation2",function(){return this._startRotation2}),n$o(0,n$b,"startLifeTime",function(){return this._startLifeTime}),n$o(0,n$b,"time",function(){return this._time}),n$o(0,n$b,"startSpeed",function(){return this._startSpeed}),n$o(0,n$b,"simulationWorldPostion",function(){return this._simulationWorldPostion}),n$o(0,n$b,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$o(1,n$a,"vertexDeclaration",function(){return n$a._vertexDeclaration}),n$l(n$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new n$fa(172,[new n$ga(0,"vector3",0),new n$ga(12,"vector4",1),new n$ga(28,"vector2",2),new n$ga(36,"vector4",30),new n$ga(52,"vector4",32),new n$ga(68,"vector4",19),new n$ga(84,"vector3",20),new n$ga(96,"vector3",22),new n$ga(108,"single",31),new n$ga(112,"vector4",34),new n$ga(128,"vector4",35),new n$ga(144,"vector3",36),new n$ga(156,"vector4",37)])}])}(),function(){function n$t(n$a,n$b,n$c,n$d,n$e,n$f){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=n$c,this._materials=n$d,this._subMeshes=n$e,this._materialMap=n$f,this._version=n$b,this._onLoaded(n$a)}n$n(n$t,"laya.d3.loaders.LoadModelV01");var n$a=n$t.prototype;return n$a._onLoaded=function(n$a){this._readData=n$a,this.READ_BLOCK();for(var n$b=0;n$b<this._BLOCK.count;n$b++){var n$c=this._readData.getUint16(),n$d=this._strings[n$c],n$e=this["READ_"+n$d];if(null==n$e)throw new Error("model file err,no this function:"+n$c+" "+n$d);if(!n$e.call(this))break}return this._mesh},n$a.onError=function(){},n$a._readString=function(){return this._strings[this._readData.getUint16()]},n$a.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},n$a.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},n$a.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var n$a=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var n$b=0;n$b<this._STRINGS.size;n$b++)this._strings[n$b]=this._readData.readUTFString();return this._readData.pos=n$a,!0},n$a.READ_MATERIAL=function(){var n$a=this._readData.getUint16(),n$b=(this._readString(),this._readString());return this._materials[n$a]="null"!==n$b?n$r.getRes(this._materialMap[n$b]):new n$Eb,!0},n$a.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var n$a,n$b=this._readData.__getBuffer(),n$c=0,n$d=this._readData.getUint32(),n$e=this._readData.getUint32(),n$f=(new Float32Array(n$b.slice(n$d+this._DATA.offset,n$d+this._DATA.offset+n$e)),this._readData.getUint32()),n$g=this._readData.getUint32(),n$h=new Float32Array(n$b.slice(n$f+this._DATA.offset,n$f+this._DATA.offset+n$g));for(this.mesh._inverseBindPoses=[],n$c=0,n$a=n$h.length;n$c<n$a;n$c+=16){var n$i=new n$ab(n$h[n$c+0],n$h[n$c+1],n$h[n$c+2],n$h[n$c+3],n$h[n$c+4],n$h[n$c+5],n$h[n$c+6],n$h[n$c+7],n$h[n$c+8],n$h[n$c+9],n$h[n$c+10],n$h[n$c+11],n$h[n$c+12],n$h[n$c+13],n$h[n$c+14],n$h[n$c+15]);this.mesh._inverseBindPoses.push(n$i)}break;default:throw new Error("LoadModel:unknown version.")}return!0},n$a.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var n$a=this._readString();this._shaderAttributes=n$a.match(n$t._attrReg);var n$b=this._readData.getUint32(),n$c=this._readData.getUint32(),n$d=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),n$e=this._readData.getUint32(),n$f=this._readData.getUint32(),n$g=this._readData.getUint32(),n$h=this._readData.__getBuffer(),n$i=new n$jb(this._mesh),n$j=this._getVertexDeclaration(),n$k=n$Ob.create(n$j,n$e/n$j.vertexStride,35044,!0),n$l=n$d+this._DATA.offset,n$m=n$h.slice(n$l,n$l+n$e);n$k.setData(new Float32Array(n$m));for(var n$n=(n$i._vertexBuffer=n$k).vertexDeclaration.getVertexElements(),n$o=0;n$o<n$n.length;n$o++)n$i._bufferUsage[n$n[n$o].elementUsage]=n$k;var n$p=n$Nb.create("ushort",n$c/2,35044,!0),n$q=n$b+this._DATA.offset,n$r=n$h.slice(n$q,n$q+n$c);n$p.setData(new Uint16Array(n$r)),n$i._indexBuffer=n$p;var n$s=n$h.slice(n$f+this._DATA.offset,n$f+this._DATA.offset+n$g);return n$i._boneIndicesList[0]=new Uint8Array(n$s),this._subMeshes.push(n$i),!0},n$a.READ_DATAAREA=function(){return!1},n$a._getVertexDeclaration=function(){for(var n$a,n$b=!1,n$c=!1,n$d=!1,n$e=!1,n$f=!1,n$g=!1,n$h=!1,n$i=!1,n$j=!1,n$k=0;n$k<this._shaderAttributes.length;n$k+=8)switch(this._shaderAttributes[n$k]){case"POSITION":n$b=!0;break;case"NORMAL":n$c=!0;break;case"COLOR":n$d=!0;break;case"UV":n$e=!0;break;case"UV1":n$f=!0;break;case"BLENDWEIGHT":n$h=!0;break;case"BLENDINDICES":n$i=!0;break;case"TANGENT":n$g=!0;break;case"BINORMAL":n$j=!0}return n$b&&n$c&&n$d&&n$e&&n$f&&n$h&&n$i&&n$g?n$a=n$ta.vertexDeclaration:n$b&&n$c&&n$d&&n$e&&n$f&&n$h&&n$i?n$a=n$ra.vertexDeclaration:n$b&&n$c&&n$e&&n$f&&n$h&&n$i&&n$g?n$a=n$Ja.vertexDeclaration:n$b&&n$c&&n$e&&n$f&&n$h&&n$i?n$a=n$Ha.vertexDeclaration:n$b&&n$c&&n$d&&n$e&&n$h&&n$i&&n$g?n$a=n$ya.vertexDeclaration:n$b&&n$c&&n$d&&n$e&&n$h&&n$i?n$a=n$wa.vertexDeclaration:n$b&&n$c&&n$g&&n$j&&n$e&&n$h&&n$i?n$a=n$Ta.vertexDeclaration:n$b&&n$c&&n$e&&n$h&&n$i&&n$g?n$a=n$Oa.vertexDeclaration:n$b&&n$c&&n$e&&n$h&&n$i?n$a=n$Ma.vertexDeclaration:n$b&&n$c&&n$d&&n$h&&n$i&&n$g?n$a=n$ma.vertexDeclaration:n$b&&n$c&&n$d&&n$h&&n$i?n$a=n$ka.vertexDeclaration:n$b&&n$c&&n$d&&n$e&&n$f&&n$g?n$a=n$va.vertexDeclaration:n$b&&n$c&&n$d&&n$e&&n$f?n$a=n$qa.vertexDeclaration:n$b&&n$c&&n$e&&n$f&&n$g?n$a=n$La.vertexDeclaration:n$b&&n$c&&n$e&&n$f?n$a=n$Ga.vertexDeclaration:n$b&&n$c&&n$d&&n$e&&n$g?n$a=n$Ca.vertexDeclaration:n$b&&n$c&&n$e&&n$g&&n$j?n$a=n$Ra.vertexDeclaration:n$b&&n$c&&n$d&&n$e?n$a=n$pa.vertexDeclaration:n$b&&n$c&&n$e&&n$g?n$a=n$Qa.vertexDeclaration:n$b&&n$c&&n$e?n$a=n$Fa.vertexDeclaration:n$b&&n$c&&n$d&&n$g?n$a=n$oa.vertexDeclaration:n$b&&n$c&&n$d&&(n$a=n$ja.vertexDeclaration),n$a},n$o(0,n$a,"mesh",function(){return this._mesh}),n$t._attrReg=new RegExp("(\\w+)|([:,;])","g"),n$t}()),n$Wa=function(){function n$x(){}return n$n(n$x,"laya.d3.loaders.LoadModelV02"),n$x.parse=function(n$a,n$b,n$c,n$d,n$e,n$f){n$x._mesh=n$c,n$x._materials=n$d,n$x._subMeshes=n$e,n$x._materialMap=n$f,n$x._version=n$b,n$x._readData=n$a,n$x.READ_DATA(),n$x.READ_BLOCK(),n$x.READ_STRINGS();for(var n$g=0,n$h=n$x._BLOCK.count;n$g<n$h;n$g++){n$x._readData.pos=n$x._BLOCK.blockStarts[n$g];var n$i=n$x._readData.getUint16(),n$j=n$x._strings[n$i],n$k=n$x["READ_"+n$j];if(null==n$k)throw new Error("model file err,no this function:"+n$i+" "+n$j);n$k.call()}n$x._strings.length=0,n$x._readData=null,n$x._version=null,n$x._mesh=null,n$x._materials=null,n$x._subMeshes=null,n$x._materialMap=null},n$x._readString=function(){return n$x._strings[n$x._readData.getUint16()]},n$x.READ_DATA=function(){n$x._DATA.offset=n$x._readData.getUint32(),n$x._DATA.size=n$x._readData.getUint32()},n$x.READ_BLOCK=function(){for(var n$a=n$x._BLOCK.count=n$x._readData.getUint16(),n$b=n$x._BLOCK.blockStarts=[],n$c=n$x._BLOCK.blockLengths=[],n$d=0;n$d<n$a;n$d++)n$b.push(n$x._readData.getUint32()),n$c.push(n$x._readData.getUint32())},n$x.READ_STRINGS=function(){var n$a=n$x._readData.getUint32(),n$b=n$x._readData.getUint16(),n$c=n$x._readData.pos;n$x._readData.pos=n$a+n$x._DATA.offset;for(var n$d=0;n$d<n$b;n$d++)n$x._strings[n$d]=n$x._readData.readUTFString();n$x._readData.pos=n$c},n$x.READ_MATERIAL=function(){n$x._readString(),n$x._readString();var n$a=n$x._readString();return""!==n$a&&n$x._materials.push(n$r.getRes(n$x._materialMap[n$a])),!0},n$x.READ_MESH=function(){n$x._readString();var n$a,n$b=n$x._readData.__getBuffer(),n$c=0,n$d=n$x._readData.getInt16(),n$e=n$x._DATA.offset;for(n$c=0;n$c<n$d;n$c++){var n$f=n$e+n$x._readData.getUint32(),n$g=n$x._readData.getUint32(),n$h=new Float32Array(n$b.slice(n$f,n$f+n$g)),n$i=n$x._readString().match(n$x._attrReg),n$j=n$x._getVertexDeclaration(n$i),n$k=n$Ob.create(n$j,4*n$h.length/n$j.vertexStride,35044,!0);n$k.setData(n$h),n$x._mesh._vertexBuffers.push(n$k)}var n$l=n$e+n$x._readData.getUint32(),n$m=n$x._readData.getUint32(),n$n=new Uint16Array(n$b.slice(n$l,n$l+n$m)),n$o=n$Nb.create("ushort",n$m/2,35044,!0);n$o.setData(n$n),n$x._mesh._indexBuffer=n$o;var n$p=n$x._mesh._boneNames=[],n$q=n$x._readData.getUint16();for(n$p.length=n$q,n$c=0;n$c<n$q;n$c++)n$p[n$c]=n$x._strings[n$x._readData.getUint16()];var n$r=n$x._readData.getUint32(),n$s=n$x._readData.getUint32(),n$t=(new Float32Array(n$b.slice(n$e+n$r,n$e+n$r+n$s)),n$x._readData.getUint32()),n$u=n$x._readData.getUint32(),n$v=new Float32Array(n$b.slice(n$e+n$t,n$e+n$t+n$u));for(n$x._mesh._inverseBindPoses=[],n$c=0,n$a=n$v.length;n$c<n$a;n$c+=16){var n$w=new n$ab(n$v[n$c+0],n$v[n$c+1],n$v[n$c+2],n$v[n$c+3],n$v[n$c+4],n$v[n$c+5],n$v[n$c+6],n$v[n$c+7],n$v[n$c+8],n$v[n$c+9],n$v[n$c+10],n$v[n$c+11],n$v[n$c+12],n$v[n$c+13],n$v[n$c+14],n$v[n$c+15]);n$x._mesh._inverseBindPoses.push(n$w)}return n$x._mesh._skinnedDatas=new Float32Array(16*n$v.length),!0},n$x.READ_SUBMESH=function(){var n$a=n$x._readData.__getBuffer(),n$b=new n$jb(n$x._mesh),n$c=n$x._readData.getInt16(),n$d=n$x._readData.getUint32(),n$e=n$x._readData.getUint32();n$b._vertexBuffer=n$x._mesh._vertexBuffers[n$c],n$b._vertexStart=n$d,n$b._vertexCount=n$e;var n$f=n$x._readData.getUint32(),n$g=n$x._readData.getUint32(),n$h=n$x._mesh._indexBuffer;n$b._indexBuffer=n$h,n$b._indexStart=n$f,n$b._indexCount=n$g,n$b._indices=new Uint16Array(n$h.getData().buffer,2*n$f,n$g);var n$i=n$x._DATA.offset,n$j=n$b._subIndexBufferStart,n$k=n$b._subIndexBufferCount,n$l=n$b._boneIndicesList,n$m=n$x._readData.getUint16();n$j.length=n$m,n$k.length=n$m,n$l.length=n$m;for(var n$n=0;n$n<n$m;n$n++){n$j[n$n]=n$x._readData.getUint32(),n$k[n$n]=n$x._readData.getUint32();var n$o=n$x._readData.getUint32(),n$p=n$x._readData.getUint32();n$b._boneIndicesList[n$n]=new Uint8Array(n$a.slice(n$i+n$o,n$i+n$o+n$p))}return n$x._subMeshes.push(n$b),!0},n$x._getVertexDeclaration=function(n$a){for(var n$b,n$c=!1,n$d=!1,n$e=!1,n$f=!1,n$g=!1,n$h=!1,n$i=!1,n$j=!1,n$k=!1,n$l=0;n$l<n$a.length;n$l++)switch(n$a[n$l]){case"POSITION":n$c=!0;break;case"NORMAL":n$d=!0;break;case"COLOR":n$e=!0;break;case"UV":n$f=!0;break;case"UV1":n$g=!0;break;case"BLENDWEIGHT":n$i=!0;break;case"BLENDINDICES":n$j=!0;break;case"TANGENT":n$h=!0;break;case"BINORMAL":n$k=!0}return n$c&&n$d&&n$e&&n$f&&n$g&&n$i&&n$j&&n$h?n$b=n$ta.vertexDeclaration:n$c&&n$d&&n$e&&n$f&&n$g&&n$i&&n$j?n$b=n$ra.vertexDeclaration:n$c&&n$d&&n$f&&n$g&&n$i&&n$j&&n$h?n$b=n$Ja.vertexDeclaration:n$c&&n$d&&n$f&&n$g&&n$i&&n$j?n$b=n$Ha.vertexDeclaration:n$c&&n$d&&n$e&&n$f&&n$i&&n$j&&n$h?n$b=n$ya.vertexDeclaration:n$c&&n$d&&n$e&&n$f&&n$i&&n$j?n$b=n$wa.vertexDeclaration:n$c&&n$d&&n$f&&n$i&&n$j&&n$h?n$b=n$Oa.vertexDeclaration:n$c&&n$d&&n$f&&n$i&&n$j?n$b=n$Ma.vertexDeclaration:n$c&&n$d&&n$e&&n$i&&n$j&&n$h?n$b=n$ma.vertexDeclaration:n$c&&n$d&&n$e&&n$i&&n$j?n$b=n$ka.vertexDeclaration:n$c&&n$d&&n$e&&n$f&&n$g&&n$h?n$b=n$va.vertexDeclaration:n$c&&n$d&&n$e&&n$f&&n$g?n$b=n$qa.vertexDeclaration:n$c&&n$d&&n$f&&n$g&&n$h?n$b=n$La.vertexDeclaration:n$c&&n$d&&n$f&&n$g?n$b=n$Ga.vertexDeclaration:n$c&&n$d&&n$e&&n$f&&n$h?n$b=n$Ca.vertexDeclaration:n$c&&n$d&&n$f&&n$h&&n$k?n$b=n$Ra.vertexDeclaration:n$c&&n$d&&n$e&&n$f?n$b=n$pa.vertexDeclaration:n$c&&n$d&&n$f&&n$h?n$b=n$Qa.vertexDeclaration:n$c&&n$d&&n$f?n$b=n$Fa.vertexDeclaration:n$c&&n$d&&n$e&&n$h?n$b=n$oa.vertexDeclaration:n$c&&n$d&&n$e&&(n$b=n$ja.vertexDeclaration),n$b},n$x._attrReg=new RegExp("(\\w+)|([:,;])","g"),n$x._strings=[],n$x._readData=null,n$x._version=null,n$x._mesh=null,n$x._materials=null,n$x._subMeshes=null,n$x._materialMap=null,n$l(n$x,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),n$x}(),n$Xa=function(){function n$w(){}return n$n(n$w,"laya.d3.loaders.LoadModelV03"),n$w.parse=function(n$a,n$b,n$c,n$d,n$e){n$w._mesh=n$c,n$w._subMeshes=n$d,n$w._materialMap=n$e,n$w._version=n$b,n$w._readData=n$a,n$w.READ_DATA(),n$w.READ_BLOCK(),n$w.READ_STRINGS();for(var n$f=0,n$g=n$w._BLOCK.count;n$f<n$g;n$f++){n$w._readData.pos=n$w._BLOCK.blockStarts[n$f];var n$h=n$w._readData.getUint16(),n$i=n$w._strings[n$h],n$j=n$w["READ_"+n$i];if(null==n$j)throw new Error("model file err,no this function:"+n$h+" "+n$i);n$j.call()}n$w._strings.length=0,n$w._readData=null,n$w._version=null,n$w._mesh=null,n$w._subMeshes=null,n$w._materialMap=null},n$w._readString=function(){return n$w._strings[n$w._readData.getUint16()]},n$w.READ_DATA=function(){n$w._DATA.offset=n$w._readData.getUint32(),n$w._DATA.size=n$w._readData.getUint32()},n$w.READ_BLOCK=function(){for(var n$a=n$w._BLOCK.count=n$w._readData.getUint16(),n$b=n$w._BLOCK.blockStarts=[],n$c=n$w._BLOCK.blockLengths=[],n$d=0;n$d<n$a;n$d++)n$b.push(n$w._readData.getUint32()),n$c.push(n$w._readData.getUint32())},n$w.READ_STRINGS=function(){var n$a=n$w._readData.getUint32(),n$b=n$w._readData.getUint16(),n$c=n$w._readData.pos;n$w._readData.pos=n$a+n$w._DATA.offset;for(var n$d=0;n$d<n$b;n$d++)n$w._strings[n$d]=n$w._readData.readUTFString();n$w._readData.pos=n$c},n$w.READ_MESH=function(){var n$a,n$b=n$w._readString(),n$c=n$w._readData.__getBuffer(),n$d=0,n$e=n$w._readData.getInt16(),n$f=n$w._DATA.offset;for(n$d=0;n$d<n$e;n$d++){var n$g,n$h=n$f+n$w._readData.getUint32(),n$i=n$w._readData.getUint32(),n$j=new Float32Array(n$c.slice(n$h,n$h+n$i)),n$k=n$w._readString();switch(n$w._version){case"LAYAMODEL:03":n$g=n$w._vertexDeclarationMap_Discard[n$k];break;case"LAYAMODEL:0301":n$g=n$w._vertexDeclarationMap[n$k];break;default:throw new Error("LoadModelV03: unknown version.")}if(!n$g)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+n$w._version+"  bufferAttribute="+n$k+"  name="+n$b+"  url="+(n$w._mesh?n$w._mesh.url:"null"));var n$l=n$Ob.create(n$g,4*n$j.length/n$g.vertexStride,35044,!0,n$w._mesh._url+"_"+n$d);n$l.setData(n$j),n$w._mesh._vertexBuffers.push(n$l)}var n$m=n$f+n$w._readData.getUint32(),n$n=n$w._readData.getUint32(),n$o=new Uint16Array(n$c.slice(n$m,n$m+n$n)),n$p=n$Nb.create("ushort",n$n/2,35044,!0,n$w._mesh._url);n$p.setData(n$o),n$w._mesh._indexBuffer=n$p;var n$q=n$w._mesh._boneNames=[],n$r=n$w._readData.getUint16();for(n$q.length=n$r,n$d=0;n$d<n$r;n$d++)n$q[n$d]=n$w._strings[n$w._readData.getUint16()];n$w._readData.pos+=8;var n$s=n$w._readData.getUint32(),n$t=n$w._readData.getUint32(),n$u=new Float32Array(n$c.slice(n$f+n$s,n$f+n$s+n$t));for(n$w._mesh._inverseBindPoses=[],n$d=0,n$a=n$u.length;n$d<n$a;n$d+=16){var n$v=new n$ab(n$u[n$d+0],n$u[n$d+1],n$u[n$d+2],n$u[n$d+3],n$u[n$d+4],n$u[n$d+5],n$u[n$d+6],n$u[n$d+7],n$u[n$d+8],n$u[n$d+9],n$u[n$d+10],n$u[n$d+11],n$u[n$d+12],n$u[n$d+13],n$u[n$d+14],n$u[n$d+15]);n$w._mesh._inverseBindPoses.push(n$v)}return n$w._mesh._skinnedDatas=new Float32Array(16*n$u.length),!0},n$w.READ_SUBMESH=function(){var n$a=n$w._readData.__getBuffer(),n$b=new n$jb(n$w._mesh),n$c=n$w._readData.getInt16(),n$d=n$w._readData.getUint32(),n$e=n$w._readData.getUint32();n$b._vertexBuffer=n$w._mesh._vertexBuffers[n$c],n$b._vertexStart=n$d,n$b._vertexCount=n$e;var n$f=n$w._readData.getUint32(),n$g=n$w._readData.getUint32(),n$h=n$w._mesh._indexBuffer;n$b._indexBuffer=n$h,n$b._indexStart=n$f,n$b._indexCount=n$g,n$b._indices=new Uint16Array(n$h.getData().buffer,2*n$f,n$g);var n$i=n$w._DATA.offset,n$j=n$b._subIndexBufferStart,n$k=n$b._subIndexBufferCount,n$l=n$b._boneIndicesList,n$m=n$w._readData.getUint16();n$j.length=n$m,n$k.length=n$m,n$l.length=n$m;for(var n$n=0;n$n<n$m;n$n++){n$j[n$n]=n$w._readData.getUint32(),n$k[n$n]=n$w._readData.getUint32();var n$o=n$w._readData.getUint32(),n$p=n$w._readData.getUint32();n$l[n$n]=new Uint8Array(n$a.slice(n$i+n$o,n$i+n$o+n$p))}return n$w._subMeshes.push(n$b),!0},n$w._strings=[],n$w._readData=null,n$w._version=null,n$w._mesh=null,n$w._subMeshes=null,n$w._materialMap=null,n$l(n$w,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":n$ta.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":n$ra.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":n$Sa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":n$Ja.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":n$Ha.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":n$ya.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":n$wa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":n$Oa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":n$Ma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":n$ma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":n$ka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":n$va.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":n$qa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":n$La.vertexDeclaration,"POSITION,NORMAL,UV,UV1":n$Ga.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":n$Ca.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":n$Ra.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":n$pa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":n$Qa.vertexDeclaration,"POSITION,NORMAL,UV":n$Fa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":n$oa.vertexDeclaration,"POSITION,NORMAL,COLOR":n$ja.vertexDeclaration,"POSITION,NORMAL,TANGENT":n$Ea.vertexDeclaration,"POSITION,NORMAL":n$ia.vertexDeclaration,"POSITION,UV":n$Ua.vertexDeclaration,POSITION:n$ha.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":n$sa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":n$ra.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":n$Sa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":n$Ia.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":n$Ha.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":n$xa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":n$wa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":n$Na.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":n$Ma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":n$la.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":n$ka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":n$ua.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":n$qa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":n$Ka.vertexDeclaration,"POSITION,NORMAL,UV,UV1":n$Ga.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":n$za.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":n$Ra.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":n$pa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":n$Pa.vertexDeclaration,"POSITION,NORMAL,UV":n$Fa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":n$na.vertexDeclaration,"POSITION,NORMAL,COLOR":n$ja.vertexDeclaration,"POSITION,NORMAL,TANGENT":n$Da.vertexDeclaration,"POSITION,NORMAL":n$ia.vertexDeclaration,"POSITION,UV":n$Ua.vertexDeclaration,POSITION:n$ha.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),n$w}(),n$Ya=function(){function n$h(){}return n$n(n$h,"laya.d3.loaders.MeshReader"),n$h.read=function(n$a,n$b,n$c,n$d,n$e){var n$f=new n$w(n$a);n$f.pos=0;var n$g=n$f.readUTFString();switch(n$g){case"LAYAMODEL:01":case"LAYASKINANI:01":n$h._readVersion01(n$f,n$g,n$b,n$c,n$d,n$e);break;case"LAYAMODEL:02":n$Wa.parse(n$f,n$g,n$b,n$c,n$d,n$e);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":n$Xa.parse(n$f,n$g,n$b,n$d,n$e);break;default:throw new Error("MeshReader: unknown mesh version.")}n$b._setSubMeshes(n$d)},n$h._readVersion01=function(n$a,n$b,n$c,n$d,n$e,n$f){new n$Va(n$a,n$b,n$c,n$d,n$e,n$f)},n$h}(),n$Za=function(){function n$a(n$a,n$b){this.min=null,this.max=null,this.min=n$a,this.max=n$b}n$n(n$a,"laya.d3.math.BoundBox");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b.getCorners=function(n$a){n$a.length=8;var n$b=this.min.elements,n$c=this.max.elements,n$d=n$b[0],n$e=n$b[1],n$f=n$b[2],n$g=n$c[0],n$h=n$c[1],n$i=n$c[2];n$a[0]=new n$gb(n$d,n$h,n$i),n$a[1]=new n$gb(n$g,n$h,n$i),n$a[2]=new n$gb(n$g,n$e,n$i),n$a[3]=new n$gb(n$d,n$e,n$i),n$a[4]=new n$gb(n$d,n$h,n$f),n$a[5]=new n$gb(n$g,n$h,n$f),n$a[6]=new n$gb(n$g,n$e,n$f),n$a[7]=new n$gb(n$d,n$e,n$f)},n$b.toDefault=function(){this.min.toDefault(),this.max.toDefault()},n$b.cloneTo=function(n$a){var n$b=n$a;this.min.cloneTo(n$b.min),this.max.cloneTo(n$b.max)},n$b.clone=function(){var n$a=new this.constructor(new n$gb,new n$gb);return this.cloneTo(n$a),n$a},n$a.createfromPoints=function(n$a,n$b){if(null==n$a)throw new Error("points");var n$c=n$b.min,n$d=n$b.max,n$e=n$c.elements;n$e[0]=Number.MAX_VALUE,n$e[1]=Number.MAX_VALUE,n$e[2]=Number.MAX_VALUE;var n$f=n$d.elements;n$f[0]=-Number.MAX_VALUE,n$f[1]=-Number.MAX_VALUE,n$f[2]=-Number.MAX_VALUE;for(var n$g=0,n$h=n$a.length;n$g<n$h;++n$g)n$gb.min(n$c,n$a[n$g],n$c),n$gb.max(n$d,n$a[n$g],n$d)},n$a.merge=function(n$a,n$b,n$c){n$gb.min(n$a.min,n$b.min,n$c.min),n$gb.max(n$a.max,n$b.max,n$c.max)},n$a}(),n$$a=function(){function n$j(n$a){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=n$a,this._near=new n$bb(new n$gb),this._far=new n$bb(new n$gb),this._left=new n$bb(new n$gb),this._right=new n$bb(new n$gb),this._top=new n$bb(new n$gb),this._bottom=new n$bb(new n$gb),n$j._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}n$n(n$j,"laya.d3.math.BoundFrustum");var n$a=n$j.prototype;return n$a.equalsBoundFrustum=function(n$a){return this._matrix.equalsOtherMatrix(n$a.matrix)},n$a.equalsObj=function(n$a){if(n$a instanceof laya.d3.math.BoundFrustum){var n$b=n$a;return this.equalsBoundFrustum(n$b)}return!1},n$a.getPlane=function(n$a){switch(n$a){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},n$a.getCorners=function(n$a){n$j._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(n$a[0]),n$j._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(n$a[1]),n$j._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(n$a[2]),n$j._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(n$a[3]),n$j._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(n$a[4]),n$j._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(n$a[5]),n$j._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(n$a[6]),n$j._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(n$a[7])},n$a.containsPoint=function(n$a){for(var n$b=n$bb.PlaneIntersectionType_Front,n$c=n$bb.PlaneIntersectionType_Front,n$d=0;n$d<6;n$d++){switch(n$d){case 0:n$c=Collision.intersectsPlaneAndPoint(this._near,n$a);break;case 1:n$c=Collision.intersectsPlaneAndPoint(this._far,n$a);break;case 2:n$c=Collision.intersectsPlaneAndPoint(this._left,n$a);break;case 3:n$c=Collision.intersectsPlaneAndPoint(this._right,n$a);break;case 4:n$c=Collision.intersectsPlaneAndPoint(this._top,n$a);break;case 5:n$c=Collision.intersectsPlaneAndPoint(this._bottom,n$a)}switch(n$c){case n$bb.PlaneIntersectionType_Back:return 0;case n$bb.PlaneIntersectionType_Intersecting:n$b=n$bb.PlaneIntersectionType_Intersecting}}switch(n$b){case n$bb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},n$a.containsBoundBox=function(n$a){for(var n$b,n$c=n$j._tempV30,n$d=n$j._tempV31,n$e=1,n$f=0;n$f<6;n$f++){if(n$b=this.getPlane(n$f),this._getBoxToPlanePVertexNVertex(n$a,n$b.normal,n$c,n$d),Collision.intersectsPlaneAndPoint(n$b,n$c)===n$bb.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(n$b,n$d)===n$bb.PlaneIntersectionType_Back&&(n$e=2)}return n$e},n$a.containsBoundSphere=function(n$a){for(var n$b=n$bb.PlaneIntersectionType_Front,n$c=n$bb.PlaneIntersectionType_Front,n$d=0;n$d<6;n$d++){switch(n$d){case 0:n$c=Collision.intersectsPlaneAndSphere(this._near,n$a);break;case 1:n$c=Collision.intersectsPlaneAndSphere(this._far,n$a);break;case 2:n$c=Collision.intersectsPlaneAndSphere(this._left,n$a);break;case 3:n$c=Collision.intersectsPlaneAndSphere(this._right,n$a);break;case 4:n$c=Collision.intersectsPlaneAndSphere(this._top,n$a);break;case 5:n$c=Collision.intersectsPlaneAndSphere(this._bottom,n$a)}switch(n$c){case n$bb.PlaneIntersectionType_Back:return 0;case n$bb.PlaneIntersectionType_Intersecting:n$b=n$bb.PlaneIntersectionType_Intersecting}}switch(n$b){case n$bb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},n$a._getBoxToPlanePVertexNVertex=function(n$a,n$b,n$c,n$d){var n$e=n$a.min,n$f=n$e.elements,n$g=n$a.max,n$h=n$g.elements,n$i=n$b.elements,n$j=n$i[0],n$k=n$i[1],n$l=n$i[2];n$e.cloneTo(n$c);var n$m=n$c.elements;0<=n$j&&(n$m[0]=n$h[0]),0<=n$k&&(n$m[1]=n$h[1]),0<=n$l&&(n$m[2]=n$h[2]),n$g.cloneTo(n$d);var n$n=n$d.elements;0<=n$j&&(n$n[0]=n$f[0]),0<=n$k&&(n$n[1]=n$f[1]),0<=n$l&&(n$n[2]=n$f[2])},n$o(0,n$a,"top",function(){return this._top}),n$o(0,n$a,"matrix",function(){return this._matrix},function(n$a){this._matrix=n$a,n$j._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),n$o(0,n$a,"near",function(){return this._near}),n$o(0,n$a,"far",function(){return this._far}),n$o(0,n$a,"left",function(){return this._left}),n$o(0,n$a,"right",function(){return this._right}),n$o(0,n$a,"bottom",function(){return this._bottom}),n$j._getPlanesFromMatrix=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){var n$h=n$a.elements,n$i=n$h[0],n$j=n$h[1],n$k=n$h[2],n$l=n$h[3],n$m=n$h[4],n$n=n$h[5],n$o=n$h[6],n$p=n$h[7],n$q=n$h[8],n$r=n$h[9],n$s=n$h[10],n$t=n$h[11],n$u=n$h[12],n$v=n$h[13],n$w=n$h[14],n$x=n$h[15],n$y=n$b.normal.elements;n$y[0]=n$l+n$k,n$y[1]=n$p+n$o,n$y[2]=n$t+n$s,n$b.distance=n$x+n$w,n$b.normalize();var n$z=n$c.normal.elements;n$z[0]=n$l-n$k,n$z[1]=n$p-n$o,n$z[2]=n$t-n$s,n$c.distance=n$x-n$w,n$c.normalize();var n$C=n$d.normal.elements;n$C[0]=n$l+n$i,n$C[1]=n$p+n$m,n$C[2]=n$t+n$q,n$d.distance=n$x+n$u,n$d.normalize();var n$D=n$e.normal.elements;n$D[0]=n$l-n$i,n$D[1]=n$p-n$m,n$D[2]=n$t-n$q,n$e.distance=n$x-n$u,n$e.normalize();var n$E=n$f.normal.elements;n$E[0]=n$l-n$j,n$E[1]=n$p-n$n,n$E[2]=n$t-n$r,n$f.distance=n$x-n$v,n$f.normalize();var n$F=n$g.normal.elements;n$F[0]=n$l+n$j,n$F[1]=n$p+n$n,n$F[2]=n$t+n$r,n$g.distance=n$x+n$v,n$g.normalize()},n$j._get3PlaneInterPoint=function(n$a,n$b,n$c){var n$d=n$a.normal,n$e=n$b.normal,n$f=n$c.normal;n$gb.cross(n$e,n$f,n$j._tempV30),n$gb.cross(n$f,n$d,n$j._tempV31),n$gb.cross(n$d,n$e,n$j._tempV32);var n$g=n$gb.dot(n$d,n$j._tempV30),n$h=n$gb.dot(n$e,n$j._tempV31),n$i=n$gb.dot(n$f,n$j._tempV32);return n$gb.scale(n$j._tempV30,-n$a.distance/n$g,n$j._tempV33),n$gb.scale(n$j._tempV31,-n$b.distance/n$h,n$j._tempV34),n$gb.scale(n$j._tempV32,-n$c.distance/n$i,n$j._tempV35),n$gb.add(n$j._tempV33,n$j._tempV34,n$j._tempV36),n$gb.add(n$j._tempV35,n$j._tempV36,n$j._tempV37),n$j._tempV37},n$l(n$j,["_tempV30",function(){return this._tempV30=new n$gb},"_tempV31",function(){return this._tempV31=new n$gb},"_tempV32",function(){return this._tempV32=new n$gb},"_tempV33",function(){return this._tempV33=new n$gb},"_tempV34",function(){return this._tempV34=new n$gb},"_tempV35",function(){return this._tempV35=new n$gb},"_tempV36",function(){return this._tempV36=new n$gb},"_tempV37",function(){return this._tempV37=new n$gb}]),n$j}(),n$_a=function(){function n$k(n$a,n$b){this.center=null,this.radius=NaN,this.center=n$a,this.radius=n$b}n$n(n$k,"laya.d3.math.BoundSphere");var n$a=n$k.prototype;return n$v.imps(n$a,{"laya.d3.core.IClone":!0}),n$a.toDefault=function(){this.center.toDefault(),this.radius=0},n$a.intersectsRayDistance=function(n$a){return Collision.intersectsRayAndSphereRD(n$a,this)},n$a.intersectsRayPoint=function(n$a,n$b){return Collision.intersectsRayAndSphereRP(n$a,this,n$b)},n$a.cloneTo=function(n$a){var n$b=n$a;this.center.cloneTo(n$b.center),n$b.radius=this.radius},n$a.clone=function(){var n$a=new this.constructor(new n$gb,new n$gb);return this.cloneTo(n$a),n$a},n$k.createFromSubPoints=function(n$a,n$b,n$c,n$d){if(null==n$a)throw new Error("points");if(n$b<0||n$b>=n$a.length)throw new Error("start"+n$b+"Must be in the range [0, "+(n$a.length-1)+"]");if(n$c<0||n$b+n$c>n$a.length)throw new Error("count"+n$c+"Must be in the range <= "+n$a.length+"}");var n$e=n$b+n$c,n$f=n$k._tempVector3;n$f.elements[0]=0,n$f.elements[1]=0,n$f.elements[2]=0;for(var n$g=n$b;n$g<n$e;++n$g)n$gb.add(n$a[n$g],n$f,n$f);var n$h=n$d.center;n$gb.scale(n$f,1/n$c,n$h);var n$i=0;for(n$g=n$b;n$g<n$e;++n$g){var n$j=n$gb.distanceSquared(n$h,n$a[n$g]);n$i<n$j&&(n$i=n$j)}n$d.radius=Math.sqrt(n$i)},n$k.createfromPoints=function(n$a,n$b){if(null==n$a)throw new Error("points");n$k.createFromSubPoints(n$a,0,n$a.length,n$b)},n$l(n$k,["_tempVector3",function(){return this._tempVector3=new n$gb}]),n$k}(),n$Aa=(function(){function n$a(){}n$n(n$a,"laya.d3.math.ContainmentType"),n$a.Disjoint=0,n$a.Contains=1,n$a.Intersects=2}(),function(){function n$c(){}return n$n(n$c,"laya.d3.math.MathUtils3D"),n$c.isZero=function(n$a){return Math.abs(n$a)<n$c.zeroTolerance},n$c.nearEqual=function(n$a,n$b){return!!n$c.isZero(n$a-n$b)},n$c.fastInvSqrt=function(n$a){return n$c.isZero(n$a)?n$a:1/Math.sqrt(n$a)},n$l(n$c,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),n$c}()),n$Ba=function(){function n$i(){var n$a=this.elements=new Float32Array(9);n$a[0]=1,n$a[1]=0,n$a[2]=0,n$a[3]=0,n$a[4]=1,n$a[5]=0,n$a[6]=0,n$a[7]=0,n$a[8]=1}n$n(n$i,"laya.d3.math.Matrix3x3");var n$a=n$i.prototype;return n$v.imps(n$a,{"laya.d3.core.IClone":!0}),n$a.determinant=function(){var n$a=this.elements,n$b=n$a[0],n$c=n$a[1],n$d=n$a[2],n$e=n$a[3],n$f=n$a[4],n$g=n$a[5],n$h=n$a[6],n$i=n$a[7],n$j=n$a[8];return n$b*(n$j*n$f-n$g*n$i)+n$c*(-n$j*n$e+n$g*n$h)+n$d*(n$i*n$e-n$f*n$h)},n$a.translate=function(n$a,n$b){var n$c=n$b.elements,n$d=this.elements,n$e=n$a.elements,n$f=n$d[0],n$g=n$d[1],n$h=n$d[2],n$i=n$d[3],n$j=n$d[4],n$k=n$d[5],n$l=n$d[6],n$m=n$d[7],n$n=n$d[8],n$o=n$e[0],n$p=n$e[1];n$c[0]=n$f,n$c[1]=n$g,n$c[2]=n$h,n$c[3]=n$i,n$c[4]=n$j,n$c[5]=n$k,n$c[6]=n$o*n$f+n$p*n$i+n$l,n$c[7]=n$o*n$g+n$p*n$j+n$m,n$c[8]=n$o*n$h+n$p*n$k+n$n},n$a.rotate=function(n$a,n$b){var n$c=n$b.elements,n$d=this.elements,n$e=n$d[0],n$f=n$d[1],n$g=n$d[2],n$h=n$d[3],n$i=n$d[4],n$j=n$d[5],n$k=n$d[6],n$l=n$d[7],n$m=n$d[8],n$n=Math.sin(n$a),n$o=Math.cos(n$a);n$c[0]=n$o*n$e+n$n*n$h,n$c[1]=n$o*n$f+n$n*n$i,n$c[2]=n$o*n$g+n$n*n$j,n$c[3]=n$o*n$h-n$n*n$e,n$c[4]=n$o*n$i-n$n*n$f,n$c[5]=n$o*n$j-n$n*n$g,n$c[6]=n$k,n$c[7]=n$l,n$c[8]=n$m},n$a.scale=function(n$a,n$b){var n$c=n$b.elements,n$d=this.elements,n$e=n$a.elements,n$f=n$e[0],n$g=n$e[1];n$c[0]=n$f*n$d[0],n$c[1]=n$f*n$d[1],n$c[2]=n$f*n$d[2],n$c[3]=n$g*n$d[3],n$c[4]=n$g*n$d[4],n$c[5]=n$g*n$d[5],n$c[6]=n$d[6],n$c[7]=n$d[7],n$c[8]=n$d[8]},n$a.invert=function(n$a){var n$b=n$a.elements,n$c=this.elements,n$d=n$c[0],n$e=n$c[1],n$f=n$c[2],n$g=n$c[3],n$h=n$c[4],n$i=n$c[5],n$j=n$c[6],n$k=n$c[7],n$l=n$c[8],n$m=n$l*n$h-n$i*n$k,n$n=-n$l*n$g+n$i*n$j,n$o=n$k*n$g-n$h*n$j,n$p=n$d*n$m+n$e*n$n+n$f*n$o;n$p||(n$a=null),n$p=1/n$p,n$b[0]=n$m*n$p,n$b[1]=(-n$l*n$e+n$f*n$k)*n$p,n$b[2]=(n$i*n$e-n$f*n$h)*n$p,n$b[3]=n$n*n$p,n$b[4]=(n$l*n$d-n$f*n$j)*n$p,n$b[5]=(-n$i*n$d+n$f*n$g)*n$p,n$b[6]=n$o*n$p,n$b[7]=(-n$k*n$d+n$e*n$j)*n$p,n$b[8]=(n$h*n$d-n$e*n$g)*n$p},n$a.transpose=function(n$a){var n$b=n$a.elements,n$c=this.elements;if(n$a===this){var n$d=n$c[1],n$e=n$c[2],n$f=n$c[5];n$b[1]=n$c[3],n$b[2]=n$c[6],n$b[3]=n$d,n$b[5]=n$c[7],n$b[6]=n$e,n$b[7]=n$f}else n$b[0]=n$c[0],n$b[1]=n$c[3],n$b[2]=n$c[6],n$b[3]=n$c[1],n$b[4]=n$c[4],n$b[5]=n$c[7],n$b[6]=n$c[2],n$b[7]=n$c[5],n$b[8]=n$c[8]},n$a.identity=function(){var n$a=this.elements;n$a[0]=1,n$a[1]=0,n$a[2]=0,n$a[3]=0,n$a[4]=1,n$a[5]=0,n$a[6]=0,n$a[7]=0,n$a[8]=1},n$a.cloneTo=function(n$a){var n$b,n$c,n$d;if((n$c=this.elements)!==(n$d=n$a.elements))for(n$b=0;n$b<9;++n$b)n$d[n$b]=n$c[n$b]},n$a.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$i.createFromTranslation=function(n$a,n$b){n$b.elements;var n$c=n$a.elements;n$b[0]=1,n$b[1]=0,n$b[2]=0,n$b[3]=0,n$b[4]=1,n$b[5]=0,n$b[6]=n$c[0],n$b[7]=n$c[1],n$b[8]=1},n$i.createFromRotation=function(n$a,n$b){var n$c=n$b.elements,n$d=Math.sin(n$a),n$e=Math.cos(n$a);n$c[0]=n$e,n$c[1]=n$d,n$c[2]=0,n$c[3]=-n$d,n$c[4]=n$e,n$c[5]=0,n$c[6]=0,n$c[7]=0,n$c[8]=1},n$i.createFromScaling=function(n$a,n$b){var n$c=n$b.elements,n$d=n$a.elements;n$c[0]=n$d[0],n$c[1]=0,n$c[2]=0,n$c[3]=0,n$c[4]=n$d[1],n$c[5]=0,n$c[6]=0,n$c[7]=0,n$c[8]=1},n$i.createFromMatrix4x4=function(n$a,n$b){n$b[0]=n$a[0],n$b[1]=n$a[1],n$b[2]=n$a[2],n$b[3]=n$a[4],n$b[4]=n$a[5],n$b[5]=n$a[6],n$b[6]=n$a[8],n$b[7]=n$a[9],n$b[8]=n$a[10]},n$i.multiply=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements,n$g=n$e[0],n$h=n$e[1],n$i=n$e[2],n$j=n$e[3],n$k=n$e[4],n$l=n$e[5],n$m=n$e[6],n$n=n$e[7],n$o=n$e[8],n$p=n$f[0],n$q=n$f[1],n$r=n$f[2],n$s=n$f[3],n$t=n$f[4],n$u=n$f[5],n$v=n$f[6],n$w=n$f[7],n$x=n$f[8];n$d[0]=n$p*n$g+n$q*n$j+n$r*n$m,n$d[1]=n$p*n$h+n$q*n$k+n$r*n$n,n$d[2]=n$p*n$i+n$q*n$l+n$r*n$o,n$d[3]=n$s*n$g+n$t*n$j+n$u*n$m,n$d[4]=n$s*n$h+n$t*n$k+n$u*n$n,n$d[5]=n$s*n$i+n$t*n$l+n$u*n$o,n$d[6]=n$v*n$g+n$w*n$j+n$x*n$m,n$d[7]=n$v*n$h+n$w*n$k+n$x*n$n,n$d[8]=n$v*n$i+n$w*n$l+n$x*n$o},n$i.lookAt=function(n$a,n$b,n$c,n$d){n$gb.subtract(n$a,n$b,n$i._tempV30),n$gb.normalize(n$i._tempV30,n$i._tempV30),n$gb.cross(n$c,n$i._tempV30,n$i._tempV31),n$gb.normalize(n$i._tempV31,n$i._tempV31),n$gb.cross(n$i._tempV30,n$i._tempV31,n$i._tempV32);var n$e=n$i._tempV30.elements,n$f=n$i._tempV31.elements,n$g=n$i._tempV32.elements,n$h=n$d.elements;n$h[0]=n$f[0],n$h[3]=n$f[1],n$h[6]=n$f[2],n$h[1]=n$g[0],n$h[4]=n$g[1],n$h[7]=n$g[2],n$h[2]=n$e[0],n$h[5]=n$e[1],n$h[8]=n$e[2]},n$i.DEFAULT=new n$i,n$l(n$i,["_tempV30",function(){return this._tempV30=new n$gb},"_tempV31",function(){return this._tempV31=new n$gb},"_tempV32",function(){return this._tempV32=new n$gb}]),n$i}(),n$ab=function(){function n$z(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$l,n$m,n$n,n$o,n$p){void 0===n$a&&(n$a=1),void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=0),void 0===n$e&&(n$e=0),void 0===n$f&&(n$f=1),void 0===n$g&&(n$g=0),void 0===n$h&&(n$h=0),void 0===n$i&&(n$i=0),void 0===n$j&&(n$j=0),void 0===n$k&&(n$k=1),void 0===n$l&&(n$l=0),void 0===n$m&&(n$m=0),void 0===n$n&&(n$n=0),void 0===n$o&&(n$o=0),void 0===n$p&&(n$p=1);var n$q=this.elements=new Float32Array(16);n$q[0]=n$a,n$q[1]=n$b,n$q[2]=n$c,n$q[3]=n$d,n$q[4]=n$e,n$q[5]=n$f,n$q[6]=n$g,n$q[7]=n$h,n$q[8]=n$i,n$q[9]=n$j,n$q[10]=n$k,n$q[11]=n$l,n$q[12]=n$m,n$q[13]=n$n,n$q[14]=n$o,n$q[15]=n$p}n$n(n$z,"laya.d3.math.Matrix4x4");var n$a=n$z.prototype;return n$v.imps(n$a,{"laya.d3.core.IClone":!0}),n$a.getElementByRowColumn=function(n$a,n$b){if(n$a<0||3<n$a)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(n$b<0||3<n$b)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*n$a+n$b]},n$a.setElementByRowColumn=function(n$a,n$b,n$c){if(n$a<0||3<n$a)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(n$b<0||3<n$b)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*n$a+n$b]=n$c},n$a.equalsOtherMatrix=function(n$a){var n$b=this.elements,n$c=n$a.elements;return n$Aa.nearEqual(n$b[0],n$c[0])&&n$Aa.nearEqual(n$b[1],n$c[1])&&n$Aa.nearEqual(n$b[2],n$c[2])&&n$Aa.nearEqual(n$b[3],n$c[3])&&n$Aa.nearEqual(n$b[4],n$c[4])&&n$Aa.nearEqual(n$b[5],n$c[5])&&n$Aa.nearEqual(n$b[6],n$c[6])&&n$Aa.nearEqual(n$b[7],n$c[7])&&n$Aa.nearEqual(n$b[8],n$c[8])&&n$Aa.nearEqual(n$b[9],n$c[9])&&n$Aa.nearEqual(n$b[10],n$c[10])&&n$Aa.nearEqual(n$b[11],n$c[11])&&n$Aa.nearEqual(n$b[12],n$c[12])&&n$Aa.nearEqual(n$b[13],n$c[13])&&n$Aa.nearEqual(n$b[14],n$c[14])&&n$Aa.nearEqual(n$b[15],n$c[15])},n$a.decomposeTransRotScale=function(n$a,n$b,n$c){var n$d=n$z._tempMatrix4x4;return this.decomposeTransRotMatScale(n$a,n$d,n$c)?(n$cb.createFromMatrix4x4(n$d,n$b),!0):(n$b.identity(),!1)},n$a.decomposeTransRotMatScale=function(n$a,n$b,n$c){var n$d=this.elements,n$e=n$a.elements,n$f=n$b.elements,n$g=n$c.elements;n$e[0]=n$d[12],n$e[1]=n$d[13],n$e[2]=n$d[14];var n$h=n$d[0],n$i=n$d[1],n$j=n$d[2],n$k=n$d[4],n$l=n$d[5],n$m=n$d[6],n$n=n$d[8],n$o=n$d[9],n$p=n$d[10],n$q=n$g[0]=Math.sqrt(n$h*n$h+n$i*n$i+n$j*n$j),n$r=n$g[1]=Math.sqrt(n$k*n$k+n$l*n$l+n$m*n$m),n$s=n$g[2]=Math.sqrt(n$n*n$n+n$o*n$o+n$p*n$p);if(n$Aa.isZero(n$q)||n$Aa.isZero(n$r)||n$Aa.isZero(n$s))return n$f[1]=n$f[2]=n$f[3]=n$f[4]=n$f[6]=n$f[7]=n$f[8]=n$f[9]=n$f[11]=n$f[12]=n$f[13]=n$f[14]=0,n$f[0]=n$f[5]=n$f[10]=n$f[15]=1,!1;var n$t=n$z._tempVector0,n$u=n$t.elements;n$u[0]=n$n/n$s,n$u[1]=n$o/n$s,n$u[2]=n$p/n$s;var n$v=n$z._tempVector1,n$w=n$v.elements;n$w[0]=n$h/n$q,n$w[1]=n$i/n$q,n$w[2]=n$j/n$q;var n$x=n$z._tempVector2;n$gb.cross(n$t,n$v,n$x);var n$y=n$z._tempVector1;return n$gb.cross(n$x,n$t,n$y),n$f[3]=n$f[7]=n$f[11]=n$f[12]=n$f[13]=n$f[14]=0,n$f[15]=1,n$f[0]=n$y.x,n$f[1]=n$y.y,n$f[2]=n$y.z,n$f[4]=n$x.x,n$f[5]=n$x.y,n$f[6]=n$x.z,n$f[8]=n$t.x,n$f[9]=n$t.y,n$f[10]=n$t.z,n$f[0]*n$h+n$f[1]*n$i+n$f[2]*n$j<0&&(n$g[0]=-n$q),n$f[4]*n$k+n$f[5]*n$l+n$f[6]*n$m<0&&(n$g[1]=-n$r),n$f[8]*n$n+n$f[9]*n$o+n$f[10]*n$p<0&&(n$g[2]=-n$s),!0},n$a.decomposeYawPitchRoll=function(n$a){var n$b=n$a.elements,n$c=Math.asin(-this.elements[9]);n$b[1]=n$c,Math.cos(n$c)>n$Aa.zeroTolerance?(n$b[2]=Math.atan2(this.elements[1],this.elements[5]),n$b[0]=Math.atan2(this.elements[8],this.elements[10])):(n$b[2]=Math.atan2(-this.elements[4],this.elements[0]),n$b[0]=0)},n$a.normalize=function(){var n$a=this.elements,n$b=n$a[0],n$c=n$a[1],n$d=n$a[2],n$e=Math.sqrt(n$b*n$b+n$c*n$c+n$d*n$d);if(!n$e)return n$a[0]=0,n$a[1]=0,void(n$a[2]=0);1!=n$e&&(n$e=1/n$e,n$a[0]=n$b*n$e,n$a[1]=n$c*n$e,n$a[2]=n$d*n$e)},n$a.transpose=function(){var n$a,n$b;return n$b=(n$a=this.elements)[1],n$a[1]=n$a[4],n$a[4]=n$b,n$b=n$a[2],n$a[2]=n$a[8],n$a[8]=n$b,n$b=n$a[3],n$a[3]=n$a[12],n$a[12]=n$b,n$b=n$a[6],n$a[6]=n$a[9],n$a[9]=n$b,n$b=n$a[7],n$a[7]=n$a[13],n$a[13]=n$b,n$b=n$a[11],n$a[11]=n$a[14],n$a[14]=n$b,this},n$a.invert=function(n$a){var n$b=this.elements,n$c=n$a.elements,n$d=n$b[0],n$e=n$b[1],n$f=n$b[2],n$g=n$b[3],n$h=n$b[4],n$i=n$b[5],n$j=n$b[6],n$k=n$b[7],n$l=n$b[8],n$m=n$b[9],n$n=n$b[10],n$o=n$b[11],n$p=n$b[12],n$q=n$b[13],n$r=n$b[14],n$s=n$b[15],n$t=n$d*n$i-n$e*n$h,n$u=n$d*n$j-n$f*n$h,n$v=n$d*n$k-n$g*n$h,n$w=n$e*n$j-n$f*n$i,n$x=n$e*n$k-n$g*n$i,n$y=n$f*n$k-n$g*n$j,n$z=n$l*n$q-n$m*n$p,n$C=n$l*n$r-n$n*n$p,n$D=n$l*n$s-n$o*n$p,n$E=n$m*n$r-n$n*n$q,n$F=n$m*n$s-n$o*n$q,n$G=n$n*n$s-n$o*n$r,n$H=n$t*n$G-n$u*n$F+n$v*n$E+n$w*n$D-n$x*n$C+n$y*n$z;0!==Math.abs(n$H)&&(n$H=1/n$H,n$c[0]=(n$i*n$G-n$j*n$F+n$k*n$E)*n$H,n$c[1]=(n$f*n$F-n$e*n$G-n$g*n$E)*n$H,n$c[2]=(n$q*n$y-n$r*n$x+n$s*n$w)*n$H,n$c[3]=(n$n*n$x-n$m*n$y-n$o*n$w)*n$H,n$c[4]=(n$j*n$D-n$h*n$G-n$k*n$C)*n$H,n$c[5]=(n$d*n$G-n$f*n$D+n$g*n$C)*n$H,n$c[6]=(n$r*n$v-n$p*n$y-n$s*n$u)*n$H,n$c[7]=(n$l*n$y-n$n*n$v+n$o*n$u)*n$H,n$c[8]=(n$h*n$F-n$i*n$D+n$k*n$z)*n$H,n$c[9]=(n$e*n$D-n$d*n$F-n$g*n$z)*n$H,n$c[10]=(n$p*n$x-n$q*n$v+n$s*n$t)*n$H,n$c[11]=(n$m*n$v-n$l*n$x-n$o*n$t)*n$H,n$c[12]=(n$i*n$C-n$h*n$E-n$j*n$z)*n$H,n$c[13]=(n$d*n$E-n$e*n$C+n$f*n$z)*n$H,n$c[14]=(n$q*n$u-n$p*n$w-n$r*n$t)*n$H,n$c[15]=(n$l*n$w-n$m*n$u+n$n*n$t)*n$H)},n$a.identity=function(){var n$a=this.elements;n$a[1]=n$a[2]=n$a[3]=n$a[4]=n$a[6]=n$a[7]=n$a[8]=n$a[9]=n$a[11]=n$a[12]=n$a[13]=n$a[14]=0,n$a[0]=n$a[5]=n$a[10]=n$a[15]=1},n$a.cloneTo=function(n$a){var n$b,n$c,n$d;if((n$c=this.elements)!==(n$d=n$a.elements))for(n$b=0;n$b<16;++n$b)n$d[n$b]=n$c[n$b]},n$a.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$a.getTranslationVector=function(n$a){var n$b=this.elements,n$c=n$a.elements;n$c[0]=n$b[12],n$c[1]=n$b[13],n$c[2]=n$b[14]},n$a.setTranslationVector=function(n$a){var n$b=this.elements,n$c=n$a.elements;n$b[12]=n$c[0],n$b[13]=n$c[1],n$b[14]=n$c[2]},n$a.getForward=function(n$a){var n$b=this.elements,n$c=n$a.elements;n$c[0]=-n$b[8],n$c[1]=-n$b[9],n$c[2]=-n$b[10]},n$a.setForward=function(n$a){var n$b=this.elements,n$c=n$a.elements;n$b[8]=-n$c[0],n$b[9]=-n$c[1],n$b[10]=-n$c[2]},n$z.createRotationX=function(n$a,n$b){var n$c=n$b.elements,n$d=Math.sin(n$a),n$e=Math.cos(n$a);n$c[1]=n$c[2]=n$c[3]=n$c[4]=n$c[7]=n$c[8]=n$c[11]=n$c[12]=n$c[13]=n$c[14]=0,n$c[0]=n$c[15]=1,n$c[5]=n$c[10]=n$e,n$c[6]=n$d,n$c[9]=-n$d},n$z.createRotationY=function(n$a,n$b){var n$c=n$b.elements,n$d=Math.sin(n$a),n$e=Math.cos(n$a);n$c[1]=n$c[3]=n$c[4]=n$c[6]=n$c[7]=n$c[9]=n$c[11]=n$c[12]=n$c[13]=n$c[14]=0,n$c[5]=n$c[15]=1,n$c[0]=n$c[10]=n$e,n$c[2]=-n$d,n$c[8]=n$d},n$z.createRotationZ=function(n$a,n$b){var n$c=n$b.elements,n$d=Math.sin(n$a),n$e=Math.cos(n$a);n$c[2]=n$c[3]=n$c[6]=n$c[7]=n$c[8]=n$c[9]=n$c[11]=n$c[12]=n$c[13]=n$c[14]=0,n$c[10]=n$c[15]=1,n$c[0]=n$c[5]=n$e,n$c[1]=n$d,n$c[4]=-n$d},n$z.createRotationYawPitchRoll=function(n$a,n$b,n$c,n$d){n$cb.createFromYawPitchRoll(n$a,n$b,n$c,n$z._tempQuaternion),n$z.createRotationQuaternion(n$z._tempQuaternion,n$d)},n$z.createRotationAxis=function(n$a,n$b,n$c){var n$d=n$a.elements,n$e=n$d[0],n$f=n$d[1],n$g=n$d[2],n$h=Math.cos(n$b),n$i=Math.sin(n$b),n$j=n$e*n$e,n$k=n$f*n$f,n$l=n$g*n$g,n$m=n$e*n$f,n$n=n$e*n$g,n$o=n$f*n$g,n$p=n$c.elements;n$p[3]=n$p[7]=n$p[11]=n$p[12]=n$p[13]=n$p[14]=0,n$p[15]=1,n$p[0]=n$j+n$h*(1-n$j),n$p[1]=n$m-n$h*n$m+n$i*n$g,n$p[2]=n$n-n$h*n$n-n$i*n$f,n$p[4]=n$m-n$h*n$m-n$i*n$g,n$p[5]=n$k+n$h*(1-n$k),n$p[6]=n$o-n$h*n$o+n$i*n$e,n$p[8]=n$n-n$h*n$n+n$i*n$f,n$p[9]=n$o-n$h*n$o-n$i*n$e,n$p[10]=n$l+n$h*(1-n$l)},n$z.createRotationQuaternion=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements,n$e=n$c[0],n$f=n$c[1],n$g=n$c[2],n$h=n$c[3],n$i=n$e*n$e,n$j=n$f*n$f,n$k=n$g*n$g,n$l=n$e*n$f,n$m=n$g*n$h,n$n=n$g*n$e,n$o=n$f*n$h,n$p=n$f*n$g,n$q=n$e*n$h;n$d[3]=n$d[7]=n$d[11]=n$d[12]=n$d[13]=n$d[14]=0,n$d[15]=1,n$d[0]=1-2*(n$j+n$k),n$d[1]=2*(n$l+n$m),n$d[2]=2*(n$n-n$o),n$d[4]=2*(n$l-n$m),n$d[5]=1-2*(n$k+n$i),n$d[6]=2*(n$p+n$q),n$d[8]=2*(n$n+n$o),n$d[9]=2*(n$p-n$q),n$d[10]=1-2*(n$j+n$i)},n$z.createTranslate=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements;n$d[4]=n$d[8]=n$d[1]=n$d[9]=n$d[2]=n$d[6]=n$d[3]=n$d[7]=n$d[11]=0,n$d[0]=n$d[5]=n$d[10]=n$d[15]=1,n$d[12]=n$c[0],n$d[13]=n$c[1],n$d[14]=n$c[2]},n$z.createScaling=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements;n$d[0]=n$c[0],n$d[5]=n$c[1],n$d[10]=n$c[2],n$d[1]=n$d[4]=n$d[8]=n$d[12]=n$d[9]=n$d[13]=n$d[2]=n$d[6]=n$d[14]=n$d[3]=n$d[7]=n$d[11]=0,n$d[15]=1},n$z.multiply=function(n$a,n$b,n$c){var n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k;for(n$e=n$c.elements,n$f=n$a.elements,n$e===(n$g=n$b.elements)&&(n$g=n$g.slice()),n$d=0;n$d<4;n$d++)n$h=n$f[n$d],n$i=n$f[n$d+4],n$j=n$f[n$d+8],n$k=n$f[n$d+12],n$e[n$d]=n$h*n$g[0]+n$i*n$g[1]+n$j*n$g[2]+n$k*n$g[3],n$e[n$d+4]=n$h*n$g[4]+n$i*n$g[5]+n$j*n$g[6]+n$k*n$g[7],n$e[n$d+8]=n$h*n$g[8]+n$i*n$g[9]+n$j*n$g[10]+n$k*n$g[11],n$e[n$d+12]=n$h*n$g[12]+n$i*n$g[13]+n$j*n$g[14]+n$k*n$g[15]},n$z.createFromQuaternion=function(n$a,n$b){var n$c=n$b.elements,n$d=n$a.elements,n$e=n$d[0],n$f=n$d[1],n$g=n$d[2],n$h=n$d[3],n$i=n$e+n$e,n$j=n$f+n$f,n$k=n$g+n$g,n$l=n$e*n$i,n$m=n$f*n$i,n$n=n$f*n$j,n$o=n$g*n$i,n$p=n$g*n$j,n$q=n$g*n$k,n$r=n$h*n$i,n$s=n$h*n$j,n$t=n$h*n$k;n$c[0]=1-n$n-n$q,n$c[1]=n$m+n$t,n$c[2]=n$o-n$s,n$c[3]=0,n$c[4]=n$m-n$t,n$c[5]=1-n$l-n$q,n$c[6]=n$p+n$r,n$c[7]=0,n$c[8]=n$o+n$s,n$c[9]=n$p-n$r,n$c[10]=1-n$l-n$n,n$c[11]=0,n$c[12]=0,n$c[13]=0,n$c[14]=0,n$c[15]=1},n$z.createAffineTransformation=function(n$a,n$b,n$c,n$d){var n$e=n$a.elements,n$f=n$b.elements,n$g=n$c.elements,n$h=n$d.elements,n$i=n$f[0],n$j=n$f[1],n$k=n$f[2],n$l=n$f[3],n$m=n$i+n$i,n$n=n$j+n$j,n$o=n$k+n$k,n$p=n$i*n$m,n$q=n$i*n$n,n$r=n$i*n$o,n$s=n$j*n$n,n$t=n$j*n$o,n$u=n$k*n$o,n$v=n$l*n$m,n$w=n$l*n$n,n$x=n$l*n$o,n$y=n$g[0],n$z=n$g[1],n$C=n$g[2];n$h[0]=(1-(n$s+n$u))*n$y,n$h[1]=(n$q+n$x)*n$y,n$h[2]=(n$r-n$w)*n$y,n$h[3]=0,n$h[4]=(n$q-n$x)*n$z,n$h[5]=(1-(n$p+n$u))*n$z,n$h[6]=(n$t+n$v)*n$z,n$h[7]=0,n$h[8]=(n$r+n$w)*n$C,n$h[9]=(n$t-n$v)*n$C,n$h[10]=(1-(n$p+n$s))*n$C,n$h[11]=0,n$h[12]=n$e[0],n$h[13]=n$e[1],n$h[14]=n$e[2],n$h[15]=1},n$z.createLookAt=function(n$a,n$b,n$c,n$d){var n$e=n$d.elements,n$f=n$z._tempVector0,n$g=n$z._tempVector1,n$h=n$z._tempVector2;n$gb.subtract(n$a,n$b,n$h),n$gb.normalize(n$h,n$h),n$gb.cross(n$c,n$h,n$f),n$gb.normalize(n$f,n$f),n$gb.cross(n$h,n$f,n$g),n$d.identity(),n$e[0]=n$f.x,n$e[4]=n$f.y,n$e[8]=n$f.z,n$e[1]=n$g.x,n$e[5]=n$g.y,n$e[9]=n$g.z,n$e[2]=n$h.x,n$e[6]=n$h.y,n$e[10]=n$h.z,n$e[12]=-n$gb.dot(n$f,n$a),n$e[13]=-n$gb.dot(n$g,n$a),n$e[14]=-n$gb.dot(n$h,n$a)},n$z.createPerspective=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$e.elements,n$g=1/Math.tan(n$a/2),n$h=1/(n$c-n$d);n$f[0]=n$g/n$b,n$f[5]=n$g,n$f[10]=(n$d+n$c)*n$h,n$f[11]=-1,n$f[14]=2*n$d*n$c*n$h,n$f[1]=n$f[2]=n$f[3]=n$f[4]=n$f[6]=n$f[7]=n$f[8]=n$f[9]=n$f[12]=n$f[13]=n$f[15]=0},n$z.createOrthoOffCenterRH=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){var n$h=n$g.elements,n$i=1/(n$a-n$b),n$j=1/(n$c-n$d),n$k=1/(n$e-n$f);n$h[1]=n$h[2]=n$h[3]=n$h[4]=n$h[6]=n$h[7]=n$h[8]=n$h[9]=n$h[11]=0,n$h[15]=1,n$h[0]=-2*n$i,n$h[5]=-2*n$j,n$h[10]=2*n$k,n$h[12]=(n$a+n$b)*n$i,n$h[13]=(n$d+n$c)*n$j,n$h[14]=(n$f+n$e)*n$k},n$z.translation=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements;n$d[0]=n$d[5]=n$d[10]=n$d[15]=1,n$d[12]=n$c[0],n$d[13]=n$c[1],n$d[14]=n$c[2]},n$l(n$z,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new n$z},"_tempVector0",function(){return this._tempVector0=new n$gb},"_tempVector1",function(){return this._tempVector1=new n$gb},"_tempVector2",function(){return this._tempVector2=new n$gb},"_tempQuaternion",function(){return this._tempQuaternion=new n$cb},"DEFAULT",function(){return this.DEFAULT=new n$z},"ZERO",function(){return this.ZERO=new n$z(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),n$z}(),n$bb=(function(){function n$t(n$a,n$b){this.extents=null,this.transformation=null,this.extents=n$a,this.transformation=n$b}n$n(n$t,"laya.d3.math.OrientedBoundBox");var n$a=n$t.prototype;n$a.getCorners=function(n$a){var n$b=n$t._tempV30.elements,n$c=n$t._tempV31.elements,n$d=n$t._tempV32.elements,n$e=this.extents.elements;n$b[0]=n$e[0],n$b[1]=n$b[2]=0,n$c[1]=n$e[1],n$c[0]=n$c[2]=0,n$d[2]=n$e[2],n$d[0]=n$d[1]=0,n$gb.TransformNormal(n$t._tempV30,this.transformation,n$t._tempV30),n$gb.TransformNormal(n$t._tempV31,this.transformation,n$t._tempV31),n$gb.TransformNormal(n$t._tempV32,this.transformation,n$t._tempV32);var n$f=n$t._tempV33;this.transformation.getTranslationVector(n$f),n$a.length=8,n$gb.add(n$f,n$t._tempV30,n$t._tempV34),n$gb.add(n$t._tempV34,n$t._tempV31,n$t._tempV34),n$gb.add(n$t._tempV34,n$t._tempV32,n$a[0]),n$gb.add(n$f,n$t._tempV30,n$t._tempV34),n$gb.add(n$t._tempV34,n$t._tempV31,n$t._tempV34),n$gb.subtract(n$t._tempV34,n$t._tempV32,n$a[1]),n$gb.subtract(n$f,n$t._tempV30,n$t._tempV34),n$gb.add(n$t._tempV34,n$t._tempV31,n$t._tempV34),n$gb.subtract(n$t._tempV34,n$t._tempV32,n$a[2]),n$gb.subtract(n$f,n$t._tempV30,n$t._tempV34),n$gb.add(n$t._tempV34,n$t._tempV31,n$t._tempV34),n$gb.add(n$t._tempV34,n$t._tempV32,n$a[3]),n$gb.add(n$f,n$t._tempV30,n$t._tempV34),n$gb.subtract(n$t._tempV34,n$t._tempV31,n$t._tempV34),n$gb.add(n$t._tempV34,n$t._tempV32,n$a[4]),n$gb.add(n$f,n$t._tempV30,n$t._tempV34),n$gb.subtract(n$t._tempV34,n$t._tempV31,n$t._tempV34),n$gb.subtract(n$t._tempV34,n$t._tempV32,n$a[5]),n$gb.subtract(n$f,n$t._tempV30,n$t._tempV34),n$gb.subtract(n$t._tempV34,n$t._tempV31,n$t._tempV34),n$gb.subtract(n$t._tempV34,n$t._tempV32,n$a[6]),n$gb.subtract(n$f,n$t._tempV30,n$t._tempV34),n$gb.subtract(n$t._tempV34,n$t._tempV31,n$t._tempV34),n$gb.add(n$t._tempV34,n$t._tempV32,n$a[7])},n$a.transform=function(n$a){n$ab.multiply(this.transformation,n$a,this.transformation)},n$a.scale=function(n$a){n$gb.multiply(this.extents,n$a,this.extents)},n$a.translate=function(n$a){this.transformation.getTranslationVector(n$t._tempV30),n$gb.add(n$t._tempV30,n$a,n$t._tempV31),this.transformation.setTranslationVector(n$t._tempV31)},n$a.Size=function(n$a){n$gb.scale(this.extents,2,n$a)},n$a.getSize=function(n$a){var n$b=this.extents.elements;n$t._tempV30.x=n$b[0],n$t._tempV31.y=n$b[1],n$t._tempV32.z=n$b[2],n$gb.TransformNormal(n$t._tempV30,this.transformation,n$t._tempV30),n$gb.TransformNormal(n$t._tempV31,this.transformation,n$t._tempV31),n$gb.TransformNormal(n$t._tempV31,this.transformation,n$t._tempV32);var n$c=n$a.elements;n$c[0]=n$gb.scalarLength(n$t._tempV30),n$c[1]=n$gb.scalarLength(n$t._tempV31),n$c[2]=n$gb.scalarLength(n$t._tempV32)},n$a.getSizeSquared=function(n$a){var n$b=this.extents.elements;n$t._tempV30.x=n$b[0],n$t._tempV31.y=n$b[1],n$t._tempV32.z=n$b[2],n$gb.TransformNormal(n$t._tempV30,this.transformation,n$t._tempV30),n$gb.TransformNormal(n$t._tempV31,this.transformation,n$t._tempV31),n$gb.TransformNormal(n$t._tempV31,this.transformation,n$t._tempV32);var n$c=n$a.elements;n$c[0]=n$gb.scalarLengthSquared(n$t._tempV30),n$c[1]=n$gb.scalarLengthSquared(n$t._tempV31),n$c[2]=n$gb.scalarLengthSquared(n$t._tempV32)},n$a.getCenter=function(n$a){this.transformation.getTranslationVector(n$a)},n$a.containsPoint=function(n$a){var n$b=this.extents.elements,n$c=n$b[0],n$d=n$b[1],n$e=n$b[2];this.transformation.invert(n$t._tempM0),n$gb.transformCoordinate(n$a,n$t._tempM0,n$t._tempV30);var n$f=n$t._tempV30.elements,n$g=Math.abs(n$f[0]),n$h=Math.abs(n$f[1]),n$i=Math.abs(n$f[2]);return n$Aa.nearEqual(n$g,n$c)&&n$Aa.nearEqual(n$h,n$d)&&n$Aa.nearEqual(n$i,n$e)?2:n$g<n$c&&n$h<n$d&&n$i<n$e?1:0},n$a.containsPoints=function(n$a){var n$b=this.extents.elements,n$c=n$b[0],n$d=n$b[1],n$e=n$b[2];this.transformation.invert(n$t._tempM0);for(var n$f=!0,n$g=!1,n$h=0;n$h<n$a.length;n$h++){n$gb.transformCoordinate(n$a[n$h],n$t._tempM0,n$t._tempV30);var n$i=n$t._tempV30.elements,n$j=Math.abs(n$i[0]),n$k=Math.abs(n$i[1]),n$l=Math.abs(n$i[2]);n$Aa.nearEqual(n$j,n$c)&&n$Aa.nearEqual(n$k,n$d)&&n$Aa.nearEqual(n$l,n$e)&&(n$g=!0),n$j<n$c&&n$k<n$d&&n$l<n$e?n$g=!0:n$f=!1}return n$f?1:n$g?2:0},n$a.containsSphere=function(n$a,n$b){void 0===n$b&&(n$b=!1);var n$c=this.extents.elements,n$d=n$c[0],n$e=n$c[1],n$f=n$c[2],n$g=n$a.radius;this.transformation.invert(n$t._tempM0),n$gb.transformCoordinate(n$a.center,n$t._tempM0,n$t._tempV30);var n$h=NaN;if(n$h=n$b?n$g:(n$gb.scale(n$gb.UnitX,n$g,n$t._tempV31),n$gb.TransformNormal(n$t._tempV31,n$t._tempM0,n$t._tempV31),n$gb.scalarLength(n$t._tempV31)),n$gb.scale(this.extents,-1,n$t._tempV32),n$gb.Clamp(n$t._tempV30,n$t._tempV32,this.extents,n$t._tempV33),n$h*n$h<n$gb.distanceSquared(n$t._tempV30,n$t._tempV33))return 0;var n$i=n$t._tempV30.elements,n$j=n$i[0],n$k=n$i[1],n$l=n$i[2],n$m=n$t._tempV32.elements,n$n=n$m[0],n$o=n$m[1],n$p=n$m[2];return n$n+n$h<=n$j&&n$j<=n$d-n$h&&n$h<n$d-n$n&&n$o+n$h<=n$k&&n$k<=n$e-n$h&&n$h<n$e-n$o&&n$p+n$h<=n$l&&n$l<=n$f-n$h&&n$h<n$f-n$p?1:2},n$a.containsOrientedBoundBox=function(n$a){var n$b=0,n$c=0;n$a.getCorners(n$t._corners);var n$d=this.containsPoints(n$t._corners);if(0!=n$d)return n$d;var n$e=this.extents.elements;n$a.extents.cloneTo(n$t._tempV35);var n$f=n$t._tempV35.elements;n$t._getRows(this.transformation,n$t._rows1),n$t._getRows(n$a.transformation,n$t._rows2);var n$g=NaN;for(n$b=0;n$b<4;n$b++)for(n$c=0;n$c<4;n$c++)3==n$b||3==n$c?(n$t._tempM0.setElementByRowColumn(n$b,n$c,0),n$t._tempM1.setElementByRowColumn(n$b,n$c,0)):(n$g=n$gb.dot(n$t._rows1[n$b],n$t._rows2[n$c]),n$t._tempM0.setElementByRowColumn(n$b,n$c,n$g),n$t._tempM1.setElementByRowColumn(n$b,n$c,Math.abs(n$g)));n$a.getCenter(n$t._tempV34),this.getCenter(n$t._tempV36),n$gb.subtract(n$t._tempV34,n$t._tempV36,n$t._tempV30);var n$h=n$t._tempV31.elements;n$h[0]=n$gb.dot(n$t._tempV30,n$t._rows1[0]),n$h[1]=n$gb.dot(n$t._tempV30,n$t._rows1[1]),n$h[2]=n$gb.dot(n$t._tempV30,n$t._rows1[2]);var n$i=n$t._tempV32.elements,n$j=n$t._tempV33.elements;for(n$b=0;n$b<3;n$b++)if(n$i[0]=n$t._tempM1.getElementByRowColumn(n$b,0),n$i[1]=n$t._tempM1.getElementByRowColumn(n$b,1),n$i[2]=n$t._tempM1.getElementByRowColumn(n$b,2),n$e[n$b]+n$gb.dot(n$t._tempV35,n$t._tempV32)<Math.abs(n$h[n$b]))return 0;for(n$c=0;n$c<3;n$c++)if(n$i[0]=n$t._tempM1.getElementByRowColumn(0,n$c),n$i[1]=n$t._tempM1.getElementByRowColumn(1,n$c),n$i[2]=n$t._tempM1.getElementByRowColumn(2,n$c),n$j[0]=n$t._tempM0.getElementByRowColumn(0,n$c),n$j[1]=n$t._tempM0.getElementByRowColumn(1,n$c),n$j[2]=n$t._tempM0.getElementByRowColumn(2,n$c),n$gb.dot(this.extents,n$t._tempV32)+n$f[n$c]<Math.abs(n$gb.dot(n$t._tempV31,n$t._tempV33)))return 0;for(n$b=0;n$b<3;n$b++)for(n$c=0;n$c<3;n$c++){var n$k=(n$b+1)%3,n$l=(n$b+2)%3,n$m=(n$c+1)%3,n$n=(n$c+2)%3;if(n$e[n$k]*n$t._tempM1.getElementByRowColumn(n$l,n$c)+n$e[n$l]*n$t._tempM1.getElementByRowColumn(n$k,n$c)+(n$f[n$m]*n$t._tempM1.getElementByRowColumn(n$b,n$n)+n$f[n$n]*n$t._tempM1.getElementByRowColumn(n$b,n$m))<Math.abs(n$h[n$l]*n$t._tempM0.getElementByRowColumn(n$k,n$c)-n$h[n$k]*n$t._tempM0.getElementByRowColumn(n$l,n$c)))return 0}return 2},n$a.containsLine=function(n$a,n$b){n$t._corners[0]=n$a,n$t._corners[1]=n$b;var n$c=this.containsPoints(n$t._corners);if(0!=n$c)return n$c;var n$d=this.extents.elements,n$e=n$d[0],n$f=n$d[1],n$g=n$d[2];this.transformation.invert(n$t._tempM0),n$gb.transformCoordinate(n$a,n$t._tempM0,n$t._tempV30),n$gb.transformCoordinate(n$b,n$t._tempM0,n$t._tempV31),n$gb.add(n$t._tempV30,n$t._tempV31,n$t._tempV32),n$gb.scale(n$t._tempV32,.5,n$t._tempV32),n$gb.subtract(n$t._tempV30,n$t._tempV32,n$t._tempV33);var n$h=n$t._tempV33.elements,n$i=n$h[0],n$j=n$h[1],n$k=n$h[2],n$l=n$t._tempV34.elements,n$m=n$l[0]=Math.abs(n$h[0]),n$n=n$l[1]=Math.abs(n$h[1]),n$o=n$l[2]=Math.abs(n$h[2]),n$p=n$t._tempV32.elements,n$q=n$p[0],n$r=n$p[1],n$s=n$p[2];return Math.abs(n$q)>n$e+n$m?0:Math.abs(n$r)>n$f+n$n?0:Math.abs(n$s)>n$g+n$o?0:Math.abs(n$r*n$k-n$s*n$j)>n$f*n$o+n$g*n$n?0:Math.abs(n$q*n$k-n$s*n$i)>n$e*n$o+n$g*n$m?0:Math.abs(n$q*n$j-n$r*n$i)>n$e*n$n+n$f*n$m?0:2},n$a.containsBoundBox=function(n$a){var n$b=0,n$c=0,n$d=n$a.min,n$e=n$a.max;n$a.getCorners(n$t._corners);var n$f=this.containsPoints(n$t._corners);if(0!=n$f)return n$f;n$gb.subtract(n$e,n$d,n$t._tempV30),n$gb.scale(n$t._tempV30,.5,n$t._tempV30),n$gb.add(n$d,n$t._tempV30,n$t._tempV30),n$gb.subtract(n$e,n$t._tempV30,n$t._tempV31);var n$g=this.extents.elements,n$h=n$t._tempV31.elements;n$t._getRows(this.transformation,n$t._rows1),this.transformation.invert(n$t._tempM0);for(n$b=0;n$b<3;n$b++)for(n$c=0;n$c<3;n$c++)n$t._tempM1.setElementByRowColumn(n$b,n$c,Math.abs(n$t._tempM0.getElementByRowColumn(n$b,n$c)));this.getCenter(n$t._tempV35),n$gb.subtract(n$t._tempV30,n$t._tempV35,n$t._tempV32);var n$i=n$t._tempV31.elements;n$i[0]=n$gb.dot(n$t._tempV32,n$t._rows1[0]),n$i[1]=n$gb.dot(n$t._tempV32,n$t._rows1[1]),n$i[2]=n$gb.dot(n$t._tempV32,n$t._rows1[2]);var n$j=n$t._tempV33.elements,n$k=n$t._tempV34.elements;for(n$b=0;n$b<3;n$b++)if(n$j[0]=n$t._tempM1.getElementByRowColumn(n$b,0),n$j[1]=n$t._tempM1.getElementByRowColumn(n$b,1),n$j[2]=n$t._tempM1.getElementByRowColumn(n$b,2),n$g[n$b]+n$gb.dot(n$t._tempV31,n$t._tempV33)<Math.abs(n$i[n$b]))return 0;for(n$c=0;n$c<3;n$c++)if(n$j[0]=n$t._tempM1.getElementByRowColumn(0,n$c),n$j[1]=n$t._tempM1.getElementByRowColumn(1,n$c),n$j[2]=n$t._tempM1.getElementByRowColumn(2,n$c),n$k[0]=n$t._tempM0.getElementByRowColumn(0,n$c),n$k[1]=n$t._tempM0.getElementByRowColumn(1,n$c),n$k[2]=n$t._tempM0.getElementByRowColumn(2,n$c),n$gb.dot(this.extents,n$t._tempV33)+n$h[n$c]<Math.abs(n$gb.dot(n$t._tempV31,n$t._tempV34)))return 0;for(n$b=0;n$b<3;n$b++)for(n$c=0;n$c<3;n$c++){var n$l=(n$b+1)%3,n$m=(n$b+2)%3,n$n=(n$c+1)%3,n$o=(n$c+2)%3;if(n$g[n$l]*n$t._tempM1.getElementByRowColumn(n$m,n$c)+n$g[n$m]*n$t._tempM1.getElementByRowColumn(n$l,n$c)+(n$h[n$n]*n$t._tempM1.getElementByRowColumn(n$b,n$o)+n$h[n$o]*n$t._tempM1.getElementByRowColumn(n$b,n$n))<Math.abs(n$i[n$m]*n$t._tempM0.getElementByRowColumn(n$l,n$c)-n$i[n$l]*n$t._tempM0.getElementByRowColumn(n$m,n$c)))return 0}return 2},n$a.intersectsRay=function(n$a,n$b){n$gb.scale(this.extents,-1,n$t._tempV30),this.transformation.invert(n$t._tempM0),n$gb.TransformNormal(n$a.direction,n$t._tempM0,n$t._ray.direction),n$gb.transformCoordinate(n$a.origin,n$t._tempM0,n$t._ray.origin),n$t._boxBound1.min=n$t._tempV30,n$t._boxBound1.max=this.extents;var n$c=Collision.intersectsRayAndBoxRP(n$t._ray,n$t._boxBound1,n$b);return-1!==n$c&&n$gb.transformCoordinate(n$b,this.transformation,n$b),n$c},n$a._getLocalCorners=function(n$a){n$a.length=8;var n$b=this.extents.elements;n$t._tempV30.x=n$b[0],n$t._tempV31.y=n$b[1],n$t._tempV32.z=n$b[2],n$gb.add(n$t._tempV30,n$t._tempV31,n$t._tempV33),n$gb.add(n$t._tempV33,n$t._tempV32,n$a[0]),n$gb.add(n$t._tempV30,n$t._tempV31,n$t._tempV33),n$gb.subtract(n$t._tempV33,n$t._tempV32,n$a[1]),n$gb.subtract(n$t._tempV31,n$t._tempV30,n$t._tempV33),n$gb.subtract(n$t._tempV33,n$t._tempV30,n$a[2]),n$gb.subtract(n$t._tempV31,n$t._tempV30,n$t._tempV33),n$gb.add(n$t._tempV33,n$t._tempV32,n$a[3]),n$gb.subtract(n$t._tempV30,n$t._tempV31,n$t._tempV33),n$gb.add(n$t._tempV33,n$t._tempV32,n$a[4]),n$gb.subtract(n$t._tempV30,n$t._tempV31,n$t._tempV33),n$gb.subtract(n$t._tempV33,n$t._tempV32,n$a[5]),n$gb.scale(n$a[0],-1,n$a[6]),n$gb.subtract(n$t._tempV32,n$t._tempV30,n$t._tempV33),n$gb.subtract(n$t._tempV33,n$t._tempV31,n$a[7])},n$a.equals=function(n$a){return this.extents==n$a.extents&&this.transformation==n$a.transformation},n$a.cloneTo=function(n$a){var n$b=n$a;this.extents.cloneTo(n$b.extents),this.transformation.cloneTo(n$b.transformation)},n$t.createByBoundBox=function(n$a,n$b){var n$c=n$a.min,n$d=n$a.max;n$gb.subtract(n$d,n$c,n$t._tempV30),n$gb.scale(n$t._tempV30,.5,n$t._tempV30),n$gb.add(n$c,n$t._tempV30,n$t._tempV31),n$gb.subtract(n$d,n$t._tempV31,n$t._tempV32),n$ab.translation(n$t._tempV31,n$t._tempM0);var n$e=n$t._tempV32.clone(),n$f=n$t._tempM0.clone();n$b.extents=n$e,n$b.transformation=n$f},n$t.createByMinAndMaxVertex=function(n$a,n$b){return n$gb.subtract(n$b,n$a,n$t._tempV30),n$gb.scale(n$t._tempV30,.5,n$t._tempV30),n$gb.add(n$a,n$t._tempV30,n$t._tempV31),n$gb.subtract(n$b,n$t._tempV31,n$t._tempV32),n$ab.translation(n$t._tempV31,n$t._tempM0),new n$t(n$t._tempV32,n$t._tempM0)},n$t._getRows=function(n$a,n$b){n$b.length=3;var n$c=n$a.elements,n$d=n$b[0].elements;n$d[0]=n$c[0],n$d[1]=n$c[1],n$d[2]=n$c[2];var n$e=n$b[1].elements;n$e[0]=n$c[4],n$e[1]=n$c[5],n$e[2]=n$c[6];var n$f=n$b[2].elements;n$f[0]=n$c[8],n$f[1]=n$c[9],n$f[2]=n$c[10]},n$t.getObbtoObbMatrix4x4=function(n$a,n$b,n$c,n$d){var n$e=n$a.transformation,n$f=n$b.transformation;if(n$c){n$t._getRows(n$e,n$t._rows1),n$t._getRows(n$f,n$t._rows2);for(var n$g=0;n$g<3;n$g++)for(var n$h=0;n$h<3;n$h++)n$d.setElementByRowColumn(n$g,n$h,n$gb.dot(n$t._rows2[n$g],n$t._rows1[n$h]));n$b.getCenter(n$t._tempV30),n$a.getCenter(n$t._tempV31),n$gb.subtract(n$t._tempV30,n$t._tempV31,n$t._tempV32);var n$i=n$d.elements;n$i[12]=n$gb.dot(n$t._tempV32,n$t._rows1[0]),n$i[13]=n$gb.dot(n$t._tempV32,n$t._rows1[1]),n$i[14]=n$gb.dot(n$t._tempV32,n$t._rows1[2]),n$i[15]=1}else n$e.invert(n$t._tempM0),n$ab.multiply(n$f,n$t._tempM0,n$d)},n$t.merge=function(n$a,n$b,n$c){var n$d=n$a.extents,n$e=n$a.transformation;n$t.getObbtoObbMatrix4x4(n$a,n$b,n$c,n$t._tempM0),n$b._getLocalCorners(n$t._corners),n$gb.transformCoordinate(n$t._corners[0],n$t._tempM0,n$t._corners[0]),n$gb.transformCoordinate(n$t._corners[1],n$t._tempM0,n$t._corners[1]),n$gb.transformCoordinate(n$t._corners[2],n$t._tempM0,n$t._corners[2]),n$gb.transformCoordinate(n$t._corners[3],n$t._tempM0,n$t._corners[3]),n$gb.transformCoordinate(n$t._corners[4],n$t._tempM0,n$t._corners[4]),n$gb.transformCoordinate(n$t._corners[5],n$t._tempM0,n$t._corners[5]),n$gb.transformCoordinate(n$t._corners[6],n$t._tempM0,n$t._corners[6]),n$gb.transformCoordinate(n$t._corners[7],n$t._tempM0,n$t._corners[7]),n$gb.scale(n$d,-1,n$t._boxBound1.min),n$d.cloneTo(n$t._boxBound1.max),n$Za.createfromPoints(n$t._corners,n$t._boxBound2),n$Za.merge(n$t._boxBound2,n$t._boxBound1,n$t._boxBound3);var n$f=n$t._boxBound3.min,n$g=n$t._boxBound3.max;n$gb.subtract(n$g,n$f,n$t._tempV30),n$gb.scale(n$t._tempV30,.5,n$t._tempV30),n$gb.add(n$f,n$t._tempV30,n$t._tempV32),n$gb.subtract(n$g,n$t._tempV32,n$d),n$gb.transformCoordinate(n$t._tempV32,n$e,n$t._tempV33)},n$l(n$t,["_tempV30",function(){return this._tempV30=new n$gb},"_tempV31",function(){return this._tempV31=new n$gb},"_tempV32",function(){return this._tempV32=new n$gb},"_tempV33",function(){return this._tempV33=new n$gb},"_tempV34",function(){return this._tempV34=new n$gb},"_tempV35",function(){return this._tempV35=new n$gb},"_tempV36",function(){return this._tempV36=new n$gb},"_tempM0",function(){return this._tempM0=new n$ab},"_tempM1",function(){return this._tempM1=new n$ab},"_corners",function(){return this._corners=[new n$gb,new n$gb,new n$gb,new n$gb,new n$gb,new n$gb,new n$gb,new n$gb]},"_rows1",function(){return this._rows1=[new n$gb,new n$gb,new n$gb]},"_rows2",function(){return this._rows2=[new n$gb,new n$gb,new n$gb]},"_ray",function(){return this._ray=new n$eb(new n$gb,new n$gb)},"_boxBound1",function(){return this._boxBound1=new n$Za(new n$gb,new n$gb)},"_boxBound2",function(){return this._boxBound2=new n$Za(new n$gb,new n$gb)},"_boxBound3",function(){return this._boxBound3=new n$Za(new n$gb,new n$gb)}])}(),function(){function n$v(n$a,n$b){this.normal=null,this.distance=NaN,void 0===n$b&&(n$b=0),this.normal=n$a,this.distance=n$b}return n$n(n$v,"laya.d3.math.Plane"),n$v.prototype.normalize=function(){var n$a=this.normal.elements,n$b=n$a[0],n$c=n$a[1],n$d=n$a[2],n$e=1/Math.sqrt(n$b*n$b+n$c*n$c+n$d*n$d);n$a[0]=n$b*n$e,n$a[1]=n$c*n$e,n$a[2]=n$d*n$e,this.distance*=n$e},n$v.createPlaneBy3P=function(n$a,n$b,n$c){var n$d=n$a.elements,n$e=n$b.elements,n$f=n$c.elements,n$g=n$e[0]-n$d[0],n$h=n$e[1]-n$d[1],n$i=n$e[2]-n$d[2],n$j=n$f[0]-n$d[0],n$k=n$f[1]-n$d[1],n$l=n$f[2]-n$d[2],n$m=n$h*n$l-n$i*n$k,n$n=n$i*n$j-n$g*n$l,n$o=n$g*n$k-n$h*n$j,n$p=1/Math.sqrt(n$m*n$m+n$n*n$n+n$o*n$o),n$q=n$m*n$p,n$r=n$n*n$p,n$s=n$o*n$p,n$t=n$v._TEMPVec3.elements;n$t[0]=n$q,n$t[1]=n$r,n$t[2]=n$s;var n$u=-(n$q*n$d[0]+n$r*n$d[1]+n$s*n$d[2]);return new n$v(n$v._TEMPVec3,n$u)},n$v.PlaneIntersectionType_Back=0,n$v.PlaneIntersectionType_Front=1,n$v.PlaneIntersectionType_Intersecting=2,n$l(n$v,["_TEMPVec3",function(){return this._TEMPVec3=new n$gb}]),n$v}()),n$cb=function(){function n$e(n$a,n$b,n$c,n$d){this.elements=new Float32Array(4),void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=1),this.elements[0]=n$a,this.elements[1]=n$b,this.elements[2]=n$c,this.elements[3]=n$d}n$n(n$e,"laya.d3.math.Quaternion");var n$a=n$e.prototype;return n$v.imps(n$a,{"laya.d3.core.IClone":!0}),n$a.scaling=function(n$a,n$b){var n$c=n$b.elements,n$d=this.elements;n$c[0]=n$d[0]*n$a,n$c[1]=n$d[1]*n$a,n$c[2]=n$d[2]*n$a,n$c[3]=n$d[3]*n$a},n$a.normalize=function(n$a){var n$b=n$a.elements,n$c=this.elements,n$d=n$c[0],n$e=n$c[1],n$f=n$c[2],n$g=n$c[3],n$h=n$d*n$d+n$e*n$e+n$f*n$f+n$g*n$g;0<n$h&&(n$h=1/Math.sqrt(n$h),n$b[0]=n$d*n$h,n$b[1]=n$e*n$h,n$b[2]=n$f*n$h,n$b[3]=n$g*n$h)},n$a.length=function(){var n$a=this.elements,n$b=n$a[0],n$c=n$a[1],n$d=n$a[2],n$e=n$a[3];return Math.sqrt(n$b*n$b+n$c*n$c+n$d*n$d+n$e*n$e)},n$a.rotateX=function(n$a,n$b){var n$c=n$b.elements,n$d=this.elements;n$a*=.5;var n$e=n$d[0],n$f=n$d[1],n$g=n$d[2],n$h=n$d[3],n$i=Math.sin(n$a),n$j=Math.cos(n$a);n$c[0]=n$e*n$j+n$h*n$i,n$c[1]=n$f*n$j+n$g*n$i,n$c[2]=n$g*n$j-n$f*n$i,n$c[3]=n$h*n$j-n$e*n$i},n$a.rotateY=function(n$a,n$b){var n$c=n$b.elements,n$d=this.elements;n$a*=.5;var n$e=n$d[0],n$f=n$d[1],n$g=n$d[2],n$h=n$d[3],n$i=Math.sin(n$a),n$j=Math.cos(n$a);n$c[0]=n$e*n$j-n$g*n$i,n$c[1]=n$f*n$j+n$h*n$i,n$c[2]=n$g*n$j+n$e*n$i,n$c[3]=n$h*n$j-n$f*n$i},n$a.rotateZ=function(n$a,n$b){var n$c=n$b.elements,n$d=this.elements;n$a*=.5;var n$e=n$d[0],n$f=n$d[1],n$g=n$d[2],n$h=n$d[3],n$i=Math.sin(n$a),n$j=Math.cos(n$a);n$c[0]=n$e*n$j+n$f*n$i,n$c[1]=n$f*n$j-n$e*n$i,n$c[2]=n$g*n$j+n$h*n$i,n$c[3]=n$h*n$j-n$g*n$i},n$a.getYawPitchRoll=function(n$a){n$gb.transformQuat(n$gb.ForwardRH,this,n$e.TEMPVector31),n$gb.transformQuat(n$gb.Up,this,n$e.TEMPVector32);var n$b=n$e.TEMPVector32.elements;n$e.angleTo(n$gb.ZERO,n$e.TEMPVector31,n$e.TEMPVector33);var n$c=n$e.TEMPVector33.elements;n$c[0]==Math.PI/2?(n$c[1]=n$e.arcTanAngle(n$b[2],n$b[0]),n$c[2]=0):n$c[0]==-Math.PI/2?(n$c[1]=n$e.arcTanAngle(-n$b[2],-n$b[0]),n$c[2]=0):(n$ab.createRotationY(-n$c[1],n$e.TEMPMatrix0),n$ab.createRotationX(-n$c[0],n$e.TEMPMatrix1),n$gb.transformCoordinate(n$e.TEMPVector32,n$e.TEMPMatrix0,n$e.TEMPVector32),n$gb.transformCoordinate(n$e.TEMPVector32,n$e.TEMPMatrix1,n$e.TEMPVector32),n$c[2]=n$e.arcTanAngle(n$b[1],-n$b[0])),n$c[1]<=-Math.PI&&(n$c[1]=Math.PI),n$c[2]<=-Math.PI&&(n$c[2]=Math.PI),n$c[1]>=Math.PI&&n$c[2]>=Math.PI&&(n$c[1]=0,n$c[2]=0,n$c[0]=Math.PI-n$c[0]);var n$d=n$a.elements;n$d[0]=n$c[1],n$d[1]=n$c[0],n$d[2]=n$c[2]},n$a.invert=function(n$a){var n$b=n$a.elements,n$c=this.elements,n$d=n$c[0],n$e=n$c[1],n$f=n$c[2],n$g=n$c[3],n$h=n$d*n$d+n$e*n$e+n$f*n$f+n$g*n$g,n$i=n$h?1/n$h:0;n$b[0]=-n$d*n$i,n$b[1]=-n$e*n$i,n$b[2]=-n$f*n$i,n$b[3]=n$g*n$i},n$a.identity=function(){var n$a=this.elements;n$a[0]=0,n$a[1]=0,n$a[2]=0,n$a[3]=1},n$a.fromArray=function(n$a,n$b){void 0===n$b&&(n$b=0),this.elements[0]=n$a[n$b+0],this.elements[1]=n$a[n$b+1],this.elements[2]=n$a[n$b+2],this.elements[3]=n$a[n$b+3]},n$a.cloneTo=function(n$a){var n$b,n$c,n$d;if((n$c=this.elements)!==(n$d=n$a.elements))for(n$b=0;n$b<4;++n$b)n$d[n$b]=n$c[n$b]},n$a.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$a.equals=function(n$a){var n$b=this.elements,n$c=n$a.elements;return n$Aa.nearEqual(n$b[0],n$c[0])&&n$Aa.nearEqual(n$b[1],n$c[1])&&n$Aa.nearEqual(n$b[2],n$c[2])&&n$Aa.nearEqual(n$b[3],n$c[3])},n$a.lengthSquared=function(){var n$a=this.elements[0],n$b=this.elements[1],n$c=this.elements[2],n$d=this.elements[3];return n$a*n$a+n$b*n$b+n$c*n$c+n$d*n$d},n$o(0,n$a,"x",function(){return this.elements[0]}),n$o(0,n$a,"y",function(){return this.elements[1]}),n$o(0,n$a,"z",function(){return this.elements[2]}),n$o(0,n$a,"w",function(){return this.elements[3]}),n$e.createFromYawPitchRoll=function(n$a,n$b,n$c,n$d){var n$e=.5*n$c,n$f=.5*n$b,n$g=.5*n$a,n$h=Math.sin(n$e),n$i=Math.cos(n$e),n$j=Math.sin(n$f),n$k=Math.cos(n$f),n$l=Math.sin(n$g),n$m=Math.cos(n$g),n$n=n$d.elements;n$n[0]=n$m*n$j*n$i+n$l*n$k*n$h,n$n[1]=n$l*n$k*n$i-n$m*n$j*n$h,n$n[2]=n$m*n$k*n$h-n$l*n$j*n$i,n$n[3]=n$m*n$k*n$i+n$l*n$j*n$h},n$e.multiply=function(n$a,n$b,n$c){var n$d=n$a.elements,n$e=n$b.elements,n$f=n$c.elements,n$g=n$d[0],n$h=n$d[1],n$i=n$d[2],n$j=n$d[3],n$k=n$e[0],n$l=n$e[1],n$m=n$e[2],n$n=n$e[3],n$o=n$h*n$m-n$i*n$l,n$p=n$i*n$k-n$g*n$m,n$q=n$g*n$l-n$h*n$k,n$r=n$g*n$k+n$h*n$l+n$i*n$m;n$f[0]=n$g*n$n+n$k*n$j+n$o,n$f[1]=n$h*n$n+n$l*n$j+n$p,n$f[2]=n$i*n$n+n$m*n$j+n$q,n$f[3]=n$j*n$n-n$r},n$e.arcTanAngle=function(n$a,n$b){return 0==n$a?1==n$b?Math.PI/2:-Math.PI/2:0<n$a?Math.atan(n$b/n$a):n$a<0?0<n$b?Math.atan(n$b/n$a)+Math.PI:Math.atan(n$b/n$a)-Math.PI:0},n$e.angleTo=function(n$a,n$b,n$c){n$gb.subtract(n$b,n$a,n$e.TEMPVector30),n$gb.normalize(n$e.TEMPVector30,n$e.TEMPVector30),n$c.elements[0]=Math.asin(n$e.TEMPVector30.y),n$c.elements[1]=n$e.arcTanAngle(-n$e.TEMPVector30.z,-n$e.TEMPVector30.x)},n$e.createFromAxisAngle=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements;n$b*=.5;var n$f=Math.sin(n$b);n$d[0]=n$f*n$e[0],n$d[1]=n$f*n$e[1],n$d[2]=n$f*n$e[2],n$d[3]=Math.cos(n$b)},n$e.createFromMatrix3x3=function(n$a,n$b){var n$c,n$d=n$b.elements,n$e=n$a.elements,n$f=n$e[0]+n$e[4]+n$e[8];if(0<n$f)n$c=Math.sqrt(n$f+1),n$d[3]=.5*n$c,n$c=.5/n$c,n$d[0]=(n$e[5]-n$e[7])*n$c,n$d[1]=(n$e[6]-n$e[2])*n$c,n$d[2]=(n$e[1]-n$e[3])*n$c;else{var n$g=0;n$e[4]>n$e[0]&&(n$g=1),n$e[8]>n$e[3*n$g+n$g]&&(n$g=2);var n$h=(n$g+1)%3,n$i=(n$g+2)%3;n$c=Math.sqrt(n$e[3*n$g+n$g]-n$e[3*n$h+n$h]-n$e[3*n$i+n$i]+1),n$d[n$g]=.5*n$c,n$c=.5/n$c,n$d[3]=(n$e[3*n$h+n$i]-n$e[3*n$i+n$h])*n$c,n$d[n$h]=(n$e[3*n$h+n$g]+n$e[3*n$g+n$h])*n$c,n$d[n$i]=(n$e[3*n$i+n$g]+n$e[3*n$g+n$i])*n$c}},n$e.createFromMatrix4x4=function(n$a,n$b){var n$c,n$d,n$e=n$a.elements,n$f=n$b.elements,n$g=n$e[0]+n$e[5]+n$e[10];0<n$g?(n$c=Math.sqrt(n$g+1),n$f[3]=.5*n$c,n$c=.5/n$c,n$f[0]=(n$e[6]-n$e[9])*n$c,n$f[1]=(n$e[8]-n$e[2])*n$c,n$f[2]=(n$e[1]-n$e[4])*n$c):n$e[0]>=n$e[5]&&n$e[0]>=n$e[10]?(n$d=.5/(n$c=Math.sqrt(1+n$e[0]-n$e[5]-n$e[10])),n$f[0]=.5*n$c,n$f[1]=(n$e[1]+n$e[4])*n$d,n$f[2]=(n$e[2]+n$e[8])*n$d,n$f[3]=(n$e[6]-n$e[9])*n$d):n$e[5]>n$e[10]?(n$d=.5/(n$c=Math.sqrt(1+n$e[5]-n$e[0]-n$e[10])),n$f[0]=(n$e[4]+n$e[1])*n$d,n$f[1]=.5*n$c,n$f[2]=(n$e[9]+n$e[6])*n$d,n$f[3]=(n$e[8]-n$e[2])*n$d):(n$d=.5/(n$c=Math.sqrt(1+n$e[10]-n$e[0]-n$e[5])),n$f[0]=(n$e[8]+n$e[2])*n$d,n$f[1]=(n$e[9]+n$e[6])*n$d,n$f[2]=.5*n$c,n$f[3]=(n$e[1]-n$e[4])*n$d)},n$e.slerp=function(n$a,n$b,n$c,n$d){var n$e,n$f,n$g,n$h,n$i,n$j=n$a.elements,n$k=n$b.elements,n$l=n$d.elements,n$m=n$j[0],n$n=n$j[1],n$o=n$j[2],n$p=n$j[3],n$q=n$k[0],n$r=n$k[1],n$s=n$k[2],n$t=n$k[3];return(n$f=n$m*n$q+n$n*n$r+n$o*n$s+n$p*n$t)<0&&(n$f=-n$f,n$q=-n$q,n$r=-n$r,n$s=-n$s,n$t=-n$t),n$i=1e-6<1-n$f?(n$e=Math.acos(n$f),n$g=Math.sin(n$e),n$h=Math.sin((1-n$c)*n$e)/n$g,Math.sin(n$c*n$e)/n$g):(n$h=1-n$c,n$c),n$l[0]=n$h*n$m+n$i*n$q,n$l[1]=n$h*n$n+n$i*n$r,n$l[2]=n$h*n$o+n$i*n$s,n$l[3]=n$h*n$p+n$i*n$t,n$l},n$e.lerp=function(n$a,n$b,n$c,n$d){var n$e=n$d.elements,n$f=n$a.elements,n$g=n$b.elements,n$h=n$f[0],n$i=n$f[1],n$j=n$f[2],n$k=n$f[3];n$e[0]=n$h+n$c*(n$g[0]-n$h),n$e[1]=n$i+n$c*(n$g[1]-n$i),n$e[2]=n$j+n$c*(n$g[2]-n$j),n$e[3]=n$k+n$c*(n$g[3]-n$k)},n$e.add=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements;n$d[0]=n$e[0]+n$f[0],n$d[1]=n$e[1]+n$f[1],n$d[2]=n$e[2]+n$f[2],n$d[3]=n$e[3]+n$f[3]},n$e.dot=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements;return n$c[0]*n$d[0]+n$c[1]*n$d[1]+n$c[2]*n$d[2]+n$c[3]*n$d[3]},n$e.rotationLookAt=function(n$a,n$b,n$c){n$e.lookAt(n$gb.ZERO,n$a,n$b,n$c)},n$e.lookAt=function(n$a,n$b,n$c,n$d){n$Ba.lookAt(n$a,n$b,n$c,n$e._tempMatrix3x3),n$e.rotationMatrix(n$e._tempMatrix3x3,n$d)},n$e.invert=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements,n$e=n$a.lengthSquared();n$Aa.isZero(n$e)||(n$e=1/n$e,n$d[0]=-n$c[0]*n$e,n$d[1]=-n$c[1]*n$e,n$d[2]=-n$c[2]*n$e,n$d[3]=n$c[3]*n$e)},n$e.rotationMatrix=function(n$a,n$b){var n$c=n$a.elements,n$d=n$c[0],n$e=n$c[1],n$f=n$c[2],n$g=n$c[3],n$h=n$c[4],n$i=n$c[5],n$j=n$c[6],n$k=n$c[7],n$l=n$c[8],n$m=n$b.elements,n$n=NaN,n$o=NaN,n$p=n$d+n$h+n$l;0<n$p?(n$n=Math.sqrt(n$p+1),n$m[3]=.5*n$n,n$n=.5/n$n,n$m[0]=(n$i-n$k)*n$n,n$m[1]=(n$j-n$f)*n$n,n$m[2]=(n$e-n$g)*n$n):n$h<=n$d&&n$l<=n$d?(n$o=.5/(n$n=Math.sqrt(1+n$d-n$h-n$l)),n$m[0]=.5*n$n,n$m[1]=(n$e+n$g)*n$o,n$m[2]=(n$f+n$j)*n$o,n$m[3]=(n$i-n$k)*n$o):n$l<n$h?(n$o=.5/(n$n=Math.sqrt(1+n$h-n$d-n$l)),n$m[0]=(n$g+n$e)*n$o,n$m[1]=.5*n$n,n$m[2]=(n$k+n$i)*n$o,n$m[3]=(n$j-n$f)*n$o):(n$o=.5/(n$n=Math.sqrt(1+n$l-n$d-n$h)),n$m[0]=(n$j+n$f)*n$o,n$m[1]=(n$k+n$i)*n$o,n$m[2]=.5*n$n,n$m[3]=(n$e-n$g)*n$o)},n$e.DEFAULT=new n$e,n$l(n$e,["TEMPVector30",function(){return this.TEMPVector30=new n$gb},"TEMPVector31",function(){return this.TEMPVector31=new n$gb},"TEMPVector32",function(){return this.TEMPVector32=new n$gb},"TEMPVector33",function(){return this.TEMPVector33=new n$gb},"TEMPMatrix0",function(){return this.TEMPMatrix0=new n$ab},"TEMPMatrix1",function(){return this.TEMPMatrix1=new n$ab},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new n$Ba},"NAN",function(){return this.NAN=new n$e(NaN,NaN,NaN,NaN)}]),n$e}(),n$db=function(){function n$a(n$a){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=n$a,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}n$n(n$a,"laya.d3.math.Rand");var n$b=n$a.prototype;return n$b.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},n$b.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},n$b.getSignedFloat=function(){return 2*this.getFloat()-1},n$o(0,n$b,"seed",function(){return this.seeds[0]},function(n$a){this.seeds[0]=n$a,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),n$a.getFloatFromInt=function(n$a){return 1/8388607*(8388607&n$a)},n$a.getByteFromInt=function(n$a){return(8388607&n$a)>>>15},n$a}(),n$eb=(function(){function n$e(n$a){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(n$a instanceof Array)||4!==n$a.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|n$a[0],this._state0L=0|n$a[1],this._state1U=0|n$a[2],this._state1L=0|n$a[3]}n$n(n$e,"laya.d3.math.RandX");var n$a=n$e.prototype;n$a.randomint=function(){var n$a=this._state0U,n$b=this._state0L,n$c=this._state1U,n$d=this._state1L,n$e=(n$d>>>0)+(n$b>>>0),n$f=n$c+n$a+(n$e/2>>>31)>>>0,n$g=n$e>>>0,n$h=0,n$i=0;n$h=(n$a^=n$h=n$a<<23|(-512&n$b)>>>9)^(this._state0U=n$c),n$i=(n$b^=n$i=n$b<<23)^(this._state0L=n$d);n$h^=n$a>>>18,n$i^=n$b>>>18|(262143&n$a)<<14;return n$h^=n$c>>>5,n$i^=n$d>>>5|(31&n$c)<<27,this._state1U=n$h,this._state1L=n$i,[n$f,n$g]},n$a.random=function(){var n$a=this.randomint(),n$b=n$a[0],n$c=1023<<20|n$b>>>12,n$d=0|(n$a[1]>>>12|(4095&n$b)<<20);return n$e._CONVERTION_BUFFER.setUint32(0,n$c,!1),n$e._CONVERTION_BUFFER.setUint32(4,n$d,!1),n$db._CONVERTION_BUFFER.getFloat64(0,!1)-1},n$l(n$e,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new n$db([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function n$a(n$a,n$b){this.origin=null,this.direction=null,this.origin=n$a,this.direction=n$b}return n$n(n$a,"laya.d3.math.Ray"),n$a}()),n$fb=function(){function n$a(n$a,n$b){this.elements=new Float32Array(2),void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0);var n$c=this.elements;n$c[0]=n$a,n$c[1]=n$b}n$n(n$a,"laya.d3.math.Vector2");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b.fromArray=function(n$a,n$b){void 0===n$b&&(n$b=0),this.elements[0]=n$a[n$b+0],this.elements[1]=n$a[n$b+1]},n$b.cloneTo=function(n$a){var n$b=n$a.elements,n$c=this.elements;n$b[0]=n$c[0],n$b[1]=n$c[1]},n$b.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$b,"x",function(){return this.elements[0]},function(n$a){this.elements[0]=n$a}),n$o(0,n$b,"y",function(){return this.elements[1]},function(n$a){this.elements[1]=n$a}),n$a.scale=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements;n$d[0]=n$e[0]*n$b,n$d[1]=n$e[1]*n$b},n$l(n$a,["ZERO",function(){return this.ZERO=new n$a(0,0)},"ONE",function(){return this.ONE=new n$a(1,1)}]),n$a}(),n$gb=function(){function n$k(n$a,n$b,n$c){this.elements=new Float32Array(3),void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0);var n$d=this.elements;n$d[0]=n$a,n$d[1]=n$b,n$d[2]=n$c}n$n(n$k,"laya.d3.math.Vector3");var n$a=n$k.prototype;return n$v.imps(n$a,{"laya.d3.core.IClone":!0}),n$a.fromArray=function(n$a,n$b){void 0===n$b&&(n$b=0),this.elements[0]=n$a[n$b+0],this.elements[1]=n$a[n$b+1],this.elements[2]=n$a[n$b+2]},n$a.cloneTo=function(n$a){var n$b=n$a.elements,n$c=this.elements;n$b[0]=n$c[0],n$b[1]=n$c[1],n$b[2]=n$c[2]},n$a.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$a.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},n$a.reset=function(n$a,n$b,n$c){this.elements[0]=n$a,this.elements[1]=n$b,this.elements[2]=n$c},n$o(0,n$a,"x",function(){return this.elements[0]},function(n$a){this.elements[0]=n$a}),n$o(0,n$a,"y",function(){return this.elements[1]},function(n$a){this.elements[1]=n$a}),n$o(0,n$a,"z",function(){return this.elements[2]},function(n$a){this.elements[2]=n$a}),n$k.distanceSquared=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements,n$e=n$c[0]-n$d[0],n$f=n$c[1]-n$d[1],n$g=n$c[2]-n$d[2];return n$e*n$e+n$f*n$f+n$g*n$g},n$k.distance=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements,n$e=n$c[0]-n$d[0],n$f=n$c[1]-n$d[1],n$g=n$c[2]-n$d[2];return Math.sqrt(n$e*n$e+n$f*n$f+n$g*n$g)},n$k.min=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements;n$d[0]=Math.min(n$e[0],n$f[0]),n$d[1]=Math.min(n$e[1],n$f[1]),n$d[2]=Math.min(n$e[2],n$f[2])},n$k.max=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements;n$d[0]=Math.max(n$e[0],n$f[0]),n$d[1]=Math.max(n$e[1],n$f[1]),n$d[2]=Math.max(n$e[2],n$f[2])},n$k.transformQuat=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements,n$g=n$e[0],n$h=n$e[1],n$i=n$e[2],n$j=n$f[0],n$k=n$f[1],n$l=n$f[2],n$m=n$f[3],n$n=n$m*n$g+n$k*n$i-n$l*n$h,n$o=n$m*n$h+n$l*n$g-n$j*n$i,n$p=n$m*n$i+n$j*n$h-n$k*n$g,n$q=-n$j*n$g-n$k*n$h-n$l*n$i;n$d[0]=n$n*n$m+n$q*-n$j+n$o*-n$l-n$p*-n$k,n$d[1]=n$o*n$m+n$q*-n$k+n$p*-n$j-n$n*-n$l,n$d[2]=n$p*n$m+n$q*-n$l+n$n*-n$k-n$o*-n$j},n$k.scalarLength=function(n$a){var n$b=n$a.elements,n$c=n$b[0],n$d=n$b[1],n$e=n$b[2];return Math.sqrt(n$c*n$c+n$d*n$d+n$e*n$e)},n$k.scalarLengthSquared=function(n$a){var n$b=n$a.elements,n$c=n$b[0],n$d=n$b[1],n$e=n$b[2];return n$c*n$c+n$d*n$d+n$e*n$e},n$k.normalize=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements,n$e=n$c[0],n$f=n$c[1],n$g=n$c[2],n$h=n$e*n$e+n$f*n$f+n$g*n$g;0<n$h&&(n$h=1/Math.sqrt(n$h),n$d[0]=n$c[0]*n$h,n$d[1]=n$c[1]*n$h,n$d[2]=n$c[2]*n$h)},n$k.multiply=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements;n$d[0]=n$e[0]*n$f[0],n$d[1]=n$e[1]*n$f[1],n$d[2]=n$e[2]*n$f[2]},n$k.scale=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements;n$d[0]=n$e[0]*n$b,n$d[1]=n$e[1]*n$b,n$d[2]=n$e[2]*n$b},n$k.lerp=function(n$a,n$b,n$c,n$d){var n$e=n$d.elements,n$f=n$a.elements,n$g=n$b.elements,n$h=n$f[0],n$i=n$f[1],n$j=n$f[2];n$e[0]=n$h+n$c*(n$g[0]-n$h),n$e[1]=n$i+n$c*(n$g[1]-n$i),n$e[2]=n$j+n$c*(n$g[2]-n$j)},n$k.transformV3ToV3=function(n$a,n$b,n$c){var n$d=n$k._tempVector4;n$k.transformV3ToV4(n$a,n$b,n$d);var n$e=n$d.elements,n$f=n$c.elements;n$f[0]=n$e[0],n$f[1]=n$e[1],n$f[2]=n$e[2]},n$k.transformV3ToV4=function(n$a,n$b,n$c){var n$d=n$a.elements,n$e=n$d[0],n$f=n$d[1],n$g=n$d[2],n$h=n$b.elements,n$i=n$c.elements;n$i[0]=n$e*n$h[0]+n$f*n$h[4]+n$g*n$h[8]+n$h[12],n$i[1]=n$e*n$h[1]+n$f*n$h[5]+n$g*n$h[9]+n$h[13],n$i[2]=n$e*n$h[2]+n$f*n$h[6]+n$g*n$h[10]+n$h[14],n$i[3]=n$e*n$h[3]+n$f*n$h[7]+n$g*n$h[11]+n$h[15]},n$k.TransformNormal=function(n$a,n$b,n$c){var n$d=n$a.elements,n$e=n$d[0],n$f=n$d[1],n$g=n$d[2],n$h=n$b.elements,n$i=n$c.elements;n$i[0]=n$e*n$h[0]+n$f*n$h[4]+n$g*n$h[8],n$i[1]=n$e*n$h[1]+n$f*n$h[5]+n$g*n$h[9],n$i[2]=n$e*n$h[2]+n$f*n$h[6]+n$g*n$h[10]},n$k.transformCoordinate=function(n$a,n$b,n$c){var n$d=n$k._tempVector4.elements,n$e=n$a.elements,n$f=n$e[0],n$g=n$e[1],n$h=n$e[2],n$i=n$b.elements;n$d[0]=n$f*n$i[0]+n$g*n$i[4]+n$h*n$i[8]+n$i[12],n$d[1]=n$f*n$i[1]+n$g*n$i[5]+n$h*n$i[9]+n$i[13],n$d[2]=n$f*n$i[2]+n$g*n$i[6]+n$h*n$i[10]+n$i[14],n$d[3]=1/(n$f*n$i[3]+n$g*n$i[7]+n$h*n$i[11]+n$i[15]);var n$j=n$c.elements;n$j[0]=n$d[0]*n$d[3],n$j[1]=n$d[1]*n$d[3],n$j[2]=n$d[2]*n$d[3]},n$k.Clamp=function(n$a,n$b,n$c,n$d){var n$e=n$a.elements,n$f=n$e[0],n$g=n$e[1],n$h=n$e[2],n$i=n$b.elements,n$j=n$i[0],n$k=n$i[1],n$l=n$i[2],n$m=n$c.elements,n$n=n$m[0],n$o=n$m[1],n$p=n$m[2],n$q=n$d.elements;n$f=(n$f=n$n<n$f?n$n:n$f)<n$j?n$j:n$f,n$g=(n$g=n$o<n$g?n$o:n$g)<n$k?n$k:n$g,n$h=(n$h=n$p<n$h?n$p:n$h)<n$l?n$l:n$h,n$q[0]=n$f,n$q[1]=n$g,n$q[2]=n$h},n$k.add=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements;n$d[0]=n$e[0]+n$f[0],n$d[1]=n$e[1]+n$f[1],n$d[2]=n$e[2]+n$f[2]},n$k.subtract=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements;n$d[0]=n$e[0]-n$f[0],n$d[1]=n$e[1]-n$f[1],n$d[2]=n$e[2]-n$f[2]},n$k.cross=function(n$a,n$b,n$c){var n$d=n$a.elements,n$e=n$b.elements,n$f=n$c.elements,n$g=n$d[0],n$h=n$d[1],n$i=n$d[2],n$j=n$e[0],n$k=n$e[1],n$l=n$e[2];n$f[0]=n$h*n$l-n$i*n$k,n$f[1]=n$i*n$j-n$g*n$l,n$f[2]=n$g*n$k-n$h*n$j},n$k.dot=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements;return n$c[0]*n$d[0]+n$c[1]*n$d[1]+n$c[2]*n$d[2]},n$k.equals=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements;return n$Aa.nearEqual(Math.abs(n$c[0]),Math.abs(n$d[0]))&&n$Aa.nearEqual(Math.abs(n$c[1]),Math.abs(n$d[1]))&&n$Aa.nearEqual(Math.abs(n$c[2]),Math.abs(n$d[2]))},n$k.ZERO=new n$k(0,0,0),n$k.ONE=new n$k(1,1,1),n$k.NegativeUnitX=new n$k(-1,0,0),n$k.UnitX=new n$k(1,0,0),n$k.UnitY=new n$k(0,1,0),n$k.UnitZ=new n$k(0,0,1),n$k.ForwardRH=new n$k(0,0,-1),n$k.ForwardLH=new n$k(0,0,1),n$k.Up=new n$k(0,1,0),n$k.NAN=new n$k(NaN,NaN,NaN),n$l(n$k,["_tempVector4",function(){return this._tempVector4=new n$hb}]),n$k}(),n$hb=function(){function n$a(n$a,n$b,n$c,n$d){this.elements=new Float32Array(4),void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=0);var n$e=this.elements;n$e[0]=n$a,n$e[1]=n$b,n$e[2]=n$c,n$e[3]=n$d}n$n(n$a,"laya.d3.math.Vector4");var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b.fromArray=function(n$a,n$b){void 0===n$b&&(n$b=0),this.elements[0]=n$a[n$b+0],this.elements[1]=n$a[n$b+1],this.elements[2]=n$a[n$b+2],this.elements[3]=n$a[n$b+3]},n$b.cloneTo=function(n$a){var n$b=n$a.elements,n$c=this.elements;n$b[0]=n$c[0],n$b[1]=n$c[1],n$b[2]=n$c[2],n$b[3]=n$c[3]},n$b.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$b.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},n$b.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},n$o(0,n$b,"x",function(){return this.elements[0]},function(n$a){this.elements[0]=n$a}),n$o(0,n$b,"y",function(){return this.elements[1]},function(n$a){this.elements[1]=n$a}),n$o(0,n$b,"z",function(){return this.elements[2]},function(n$a){this.elements[2]=n$a}),n$o(0,n$b,"w",function(){return this.elements[3]},function(n$a){this.elements[3]=n$a}),n$a.lerp=function(n$a,n$b,n$c,n$d){var n$e=n$d.elements,n$f=n$a.elements,n$g=n$b.elements,n$h=n$f[0],n$i=n$f[1],n$j=n$f[2],n$k=n$f[3];n$e[0]=n$h+n$c*(n$g[0]-n$h),n$e[1]=n$i+n$c*(n$g[1]-n$i),n$e[2]=n$j+n$c*(n$g[2]-n$j),n$e[3]=n$k+n$c*(n$g[3]-n$k)},n$a.transformByM4x4=function(n$a,n$b,n$c){var n$d=n$a.elements,n$e=n$d[0],n$f=n$d[1],n$g=n$d[2],n$h=n$d[3],n$i=n$b.elements,n$j=n$c.elements;n$j[0]=n$e*n$i[0]+n$f*n$i[4]+n$g*n$i[8]+n$h*n$i[12],n$j[1]=n$e*n$i[1]+n$f*n$i[5]+n$g*n$i[9]+n$h*n$i[13],n$j[2]=n$e*n$i[2]+n$f*n$i[6]+n$g*n$i[10]+n$h*n$i[14],n$j[3]=n$e*n$i[3]+n$f*n$i[7]+n$g*n$i[11]+n$h*n$i[15]},n$a.equals=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements;return n$Aa.nearEqual(Math.abs(n$c[0]),Math.abs(n$d[0]))&&n$Aa.nearEqual(Math.abs(n$c[1]),Math.abs(n$d[1]))&&n$Aa.nearEqual(Math.abs(n$c[2]),Math.abs(n$d[2]))&&n$Aa.nearEqual(Math.abs(n$c[3]),Math.abs(n$d[3]))},n$a.normalize=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements,n$e=n$a.length();0<n$e&&(n$d[0]=n$c[0]*n$e,n$d[1]=n$c[1]*n$e,n$d[2]=n$c[2]*n$e,n$d[3]=n$c[3]*n$e)},n$a.add=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements;n$d[0]=n$e[0]+n$f[0],n$d[1]=n$e[1]+n$f[1],n$d[2]=n$e[2]+n$f[2],n$d[3]=n$e[3]+n$f[3]},n$a.subtract=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements;n$d[0]=n$e[0]-n$f[0],n$d[1]=n$e[1]-n$f[1],n$d[2]=n$e[2]-n$f[2],n$d[3]=n$e[3]-n$f[3]},n$a.multiply=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements;n$d[0]=n$e[0]*n$f[0],n$d[1]=n$e[1]*n$f[1],n$d[2]=n$e[2]*n$f[2],n$d[3]=n$e[3]*n$f[3]},n$a.scale=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements;n$d[0]=n$e[0]*n$b,n$d[1]=n$e[1]*n$b,n$d[2]=n$e[2]*n$b,n$d[3]=n$e[3]*n$b},n$a.Clamp=function(n$a,n$b,n$c,n$d){var n$e=n$a.elements,n$f=n$e[0],n$g=n$e[1],n$h=n$e[2],n$i=n$e[3],n$j=n$b.elements,n$k=n$j[0],n$l=n$j[1],n$m=n$j[2],n$n=n$j[3],n$o=n$c.elements,n$p=n$o[0],n$q=n$o[1],n$r=n$o[2],n$s=n$o[3],n$t=n$d.elements;n$f=(n$f=n$p<n$f?n$p:n$f)<n$k?n$k:n$f,n$g=(n$g=n$q<n$g?n$q:n$g)<n$l?n$l:n$g,n$h=(n$h=n$r<n$h?n$r:n$h)<n$m?n$m:n$h,n$i=(n$i=n$s<n$i?n$s:n$i)<n$n?n$n:n$i,n$t[0]=n$f,n$t[1]=n$g,n$t[2]=n$h,n$t[3]=n$i},n$a.distanceSquared=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements,n$e=n$c[0]-n$d[0],n$f=n$c[1]-n$d[1],n$g=n$c[2]-n$d[2],n$h=n$c[3]-n$d[3];return n$e*n$e+n$f*n$f+n$g*n$g+n$h*n$h},n$a.distance=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements,n$e=n$c[0]-n$d[0],n$f=n$c[1]-n$d[1],n$g=n$c[2]-n$d[2],n$h=n$c[3]-n$d[3];return Math.sqrt(n$e*n$e+n$f*n$f+n$g*n$g+n$h*n$h)},n$a.dot=function(n$a,n$b){var n$c=n$a.elements,n$d=n$b.elements;return n$c[0]*n$d[0]+n$c[1]*n$d[1]+n$c[2]*n$d[2]+n$c[3]*n$d[3]},n$a.min=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements;n$d[0]=Math.min(n$e[0],n$f[0]),n$d[1]=Math.min(n$e[1],n$f[1]),n$d[2]=Math.min(n$e[2],n$f[2]),n$d[3]=Math.min(n$e[3],n$f[3])},n$a.max=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b.elements;n$d[0]=Math.max(n$e[0],n$f[0]),n$d[1]=Math.max(n$e[1],n$f[1]),n$d[2]=Math.max(n$e[2],n$f[2]),n$d[3]=Math.max(n$e[3],n$f[3])},n$l(n$a,["ZERO",function(){return this.ZERO=new n$a},"ONE",function(){return this.ONE=new n$a(1,1,1,1)},"UnitX",function(){return this.UnitX=new n$a(1,0,0,0)},"UnitY",function(){return this.UnitY=new n$a(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new n$a(0,0,1,0)},"UnitW",function(){return this.UnitW=new n$a(0,0,0,1)}]),n$a}(),n$ib=function(){function n$f(n$a,n$b,n$c,n$d){this.minDepth=0,this.maxDepth=1,this.x=n$a,this.y=n$b,this.width=n$c,this.height=n$d}n$n(n$f,"laya.d3.math.Viewport");var n$a=n$f.prototype;return n$a.project=function(n$a,n$b,n$c){n$gb.transformV3ToV3(n$a,n$b,n$c);var n$d=n$a.elements,n$e=n$b.elements,n$f=n$c.elements,n$g=n$d[0]*n$e[3]+n$d[1]*n$e[7]+n$d[2]*n$e[11]+n$e[15];1!==n$g&&(n$f[0]=n$f[0]/n$g,n$f[1]=n$f[1]/n$g,n$f[2]=n$f[2]/n$g),n$f[0]=.5*(n$f[0]+1)*this.width+this.x,n$f[1]=.5*(1-n$f[1])*this.height+this.y,n$f[2]=n$f[2]*(this.maxDepth-this.minDepth)+this.minDepth},n$a.unprojectFromMat=function(n$a,n$b,n$c){var n$d=n$a.elements,n$e=n$b.elements,n$f=n$c.elements;n$f[0]=(n$d[0]-this.x)/this.width*2-1,n$f[1]=-((n$d[1]-this.y)/this.height*2-1);var n$g=(this.maxDepth-this.minDepth)/2;n$f[2]=(n$d[2]-this.minDepth-n$g)/n$g;var n$h=n$f[0]*n$e[3]+n$f[1]*n$e[7]+n$f[2]*n$e[11]+n$e[15];n$gb.transformV3ToV3(n$c,n$b,n$c),1!==n$h&&(n$f[0]=n$f[0]/n$h,n$f[1]=n$f[1]/n$h,n$f[2]=n$f[2]/n$h)},n$a.unprojectFromWVP=function(n$a,n$b,n$c,n$d,n$e){n$ab.multiply(n$b,n$c,n$f._tempMatrix4x4),n$d&&n$ab.multiply(n$f._tempMatrix4x4,n$d,n$f._tempMatrix4x4),n$f._tempMatrix4x4.invert(n$f._tempMatrix4x4),this.unprojectFromMat(n$a,n$f._tempMatrix4x4,n$e)},n$l(n$f,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new n$ab}]),n$f}(),n$jb=function(){function n$E(n$a){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=n$a,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}n$n(n$E,"laya.d3.resource.models.SubMesh");var n$a=n$E.prototype;return n$v.imps(n$a,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),n$a._getVertexBuffer=function(n$a){return void 0===n$a&&(n$a=0),0===n$a?this._vertexBuffer:null},n$a._getIndexBuffer=function(){return this._indexBuffer},n$a._getStaticBatchBakedVertexs=function(n$a,n$b){var n$c,n$d,n$e=this._vertexBuffer,n$f=n$e.vertexDeclaration,n$g=n$f.getVertexElementByUsage(0).offset/4,n$h=n$f.getVertexElementByUsage(3).offset/4,n$i=n$b.meshRender.lightmapScaleOffset,n$j=0,n$k=0,n$l=0,n$m=0,n$n=0,n$o=0;if(n$i)if(n$d=n$f.getVertexElementByUsage(15))n$l=n$f.vertexStride/4,n$c=0<this._vertexCount?n$e.getData().slice(this._vertexStart*n$l,(this._vertexStart+this._vertexCount)*n$l):n$e.getData().slice(),n$m=n$d.offset/4;else{n$l=(n$o=n$f.vertexStride/4)+2,n$c=this._vertexCount?new Float32Array(this._vertexCount*(n$e.vertexDeclaration.vertexStride/4+2)):new Float32Array(n$e.vertexCount*(n$e.vertexDeclaration.vertexStride/4+2)),n$m=(n$n=n$f.getVertexElementByUsage(2).offset/4)+2;var n$p=n$e.getData();for(n$j=0,n$k=n$p.length/n$o;n$j<n$k;n$j++){var n$q=0;n$q=0<this._vertexCount?(this._vertexStart+n$j)*n$o:n$j*n$o;var n$r=n$j*n$l,n$s=0;for(n$s=0;n$s<n$m;n$s++)n$c[n$r+n$s]=n$p[n$q+n$s];for(n$s=n$m;n$s<n$o;n$s++)n$c[n$r+n$s+2]=n$p[n$q+n$s]}}else n$l=n$f.vertexStride/4,n$c=this._vertexCount?n$e.getData().slice(this._vertexStart*n$l,(this._vertexStart+this._vertexCount)*n$l):n$e.getData().slice();if(n$a){var n$t=n$a.worldMatrix,n$u=n$E._tempMatrix4x40;n$t.invert(n$u);var n$v=n$E._tempMatrix4x41,n$w=n$b.transform.worldMatrix;n$ab.multiply(n$u,n$w,n$v)}else n$v=n$b.transform.worldMatrix;var n$x=n$E._tempQuaternion0;for(n$v.decomposeTransRotScale(n$E._tempVector30,n$x,n$E._tempVector31),n$j=0,n$k=n$c.length/n$l;n$j<n$k;n$j++){var n$y=n$j*n$l+n$g,n$z=n$j*n$l+n$h;if(n$qb.transformVector3ArrayToVector3ArrayCoordinate(n$c,n$y,n$v,n$c,n$y),n$qb.transformVector3ArrayByQuat(n$c,n$z,n$x,n$c,n$z),n$i){var n$C=n$j*n$l+n$m;if(n$d)n$qb.transformLightingMapTexcoordByUV1Array(n$c,n$C,n$i,n$c,n$C);else{var n$D=n$j*n$o+n$n;n$qb.transformLightingMapTexcoordByUV0Array(n$p,n$D,n$i,n$c,n$C)}}}return n$c},n$a._getVertexBuffers=function(){return null},n$a._beforeRender=function(n$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},n$a._render=function(n$a){var n$b,n$c=0,n$d=n$a.renderElement;if(1<this._indexCount){var n$e=this._boneIndicesList.length;if(1<n$e){for(var n$f=0;n$f<n$e;n$f++)(n$b=n$d._skinAnimationDatas||this._skinAnimationDatas)&&(n$d._shaderValue.setValue(0,n$b[n$f]),n$a._shader.uploadRenderElementUniforms(n$d._shaderValue.data)),n$F.mainContext.drawElements(4,this._subIndexBufferCount[n$f],5123,2*this._subIndexBufferStart[n$f]);n$y.drawCall+=n$e}else(n$b=n$d._skinAnimationDatas||this._skinAnimationDatas)&&(n$d._shaderValue.setValue(0,n$b[0]),n$a._shader.uploadRenderElementUniforms(n$d._shaderValue.data)),n$F.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),n$y.drawCall++;n$c=this._indexCount}else n$c=this._indexBuffer.indexCount,(n$b=n$d._skinAnimationDatas||this._skinAnimationDatas)&&(n$d._shaderValue.setValue(0,n$b[0]),n$a._shader.uploadRenderElementUniforms(n$d._shaderValue.data)),n$F.mainContext.drawElements(4,n$c,5123,0),n$y.drawCall++;n$y.trianglesFaces+=n$c/3},n$a.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},n$a.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},n$o(0,n$a,"_vertexBufferCount",function(){return 1}),n$o(0,n$a,"triangleCount",function(){return this._indexBuffer.indexCount/3}),n$l(n$E,["_tempVector30",function(){return this._tempVector30=new n$gb},"_tempVector31",function(){return this._tempVector31=new n$gb},"_tempQuaternion0",function(){return this._tempQuaternion0=new n$cb},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new n$ab},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new n$ab}]),n$E}(),n$kb=function(){function n$a(n$a){this.defineCounter=0,this.defines=null,n$a?(this.defineCounter=n$a.defineCounter,this.defines=n$a.defines.slice()):(this.defineCounter=0,this.defines=[])}return n$n(n$a,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),n$a.prototype.registerDefine=function(n$a){var n$b=Math.pow(2,this.defineCounter++);return this.defines[n$b]=n$a,n$b},n$a}(),n$lb=function(){function n$a(){}return n$n(n$a,"laya.d3.shader.ShaderInit3D"),n$a.__init__=function(){var n$a,n$b;n$yb._globalRegDefine("HIGHPRECISION",n$yb.SHADERDEFINE_HIGHPRECISION),n$yb._globalRegDefine("FOG",n$yb.SHADERDEFINE_FOG),n$yb._globalRegDefine("DIRECTIONLIGHT",n$yb.SHADERDEFINE_DIRECTIONLIGHT),n$yb._globalRegDefine("POINTLIGHT",n$yb.SHADERDEFINE_POINTLIGHT),n$yb._globalRegDefine("SPOTLIGHT",n$yb.SHADERDEFINE_SPOTLIGHT),n$yb._globalRegDefine("UV",n$yb.SHADERDEFINE_UV0),n$yb._globalRegDefine("COLOR",n$yb.SHADERDEFINE_COLOR),n$yb._globalRegDefine("UV1",n$yb.SHADERDEFINE_UV1),n$yb._globalRegDefine("CASTSHADOW",n$nb.SHADERDEFINE_CAST_SHADOW),n$yb._globalRegDefine("SHADOWMAP_PSSM1",n$nb.SHADERDEFINE_SHADOW_PSSM1),n$yb._globalRegDefine("SHADOWMAP_PSSM2",n$nb.SHADERDEFINE_SHADOW_PSSM2),n$yb._globalRegDefine("SHADOWMAP_PSSM3",n$nb.SHADERDEFINE_SHADOW_PSSM3),n$yb._globalRegDefine("SHADOWMAP_PCF_NO",n$nb.SHADERDEFINE_SHADOW_PCF_NO),n$yb._globalRegDefine("SHADOWMAP_PCF1",n$nb.SHADERDEFINE_SHADOW_PCF1),n$yb._globalRegDefine("SHADOWMAP_PCF2",n$nb.SHADERDEFINE_SHADOW_PCF2),n$yb._globalRegDefine("SHADOWMAP_PCF3",n$nb.SHADERDEFINE_SHADOW_PCF3),n$yb._globalRegDefine("DEPTHFOG",n$yb.SAHDERDEFINE_DEPTHFOG),n$Lb.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),n$Lb.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),n$a={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},n$b={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var n$c=n$Lb.nameKey.add("SIMPLE");shaderCompile=n$yb.add(n$c,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',n$a,n$b),n$Mb.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),n$Mb.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),n$Mb.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),n$Mb.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),n$Mb.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),n$Mb.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),n$Mb.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),n$Mb.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),n$Mb.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},n$a}(),n$mb=function(){function n$a(){this._data=null,this._data=[]}n$n(n$a,"laya.d3.shader.ValusArray");var n$b=n$a.prototype;return n$b.setValue=function(n$a,n$b){this._data[n$a]=n$b},n$o(0,n$b,"data",function(){return this._data}),n$a}(),n$nb=function(){function n$a(){}return n$a.SHADERDEFINE_RECEIVE_SHADOW=1,n$a.SHADERDEFINE_CAST_SHADOW=512,n$a.SHADERDEFINE_SHADOW_PSSM1=1024,n$a.SHADERDEFINE_SHADOW_PSSM2=2048,n$a.SHADERDEFINE_SHADOW_PSSM3=4096,n$a.SHADERDEFINE_SHADOW_PCF_NO=8192,n$a.SHADERDEFINE_SHADOW_PCF1=16384,n$a.SHADERDEFINE_SHADOW_PCF2=32768,n$a.SHADERDEFINE_SHADOW_PCF3=65536,n$a.MAX_PSSM_COUNT=3,n$a}(),n$ob=function(){function n$X(){}return n$n(n$X,"laya.d3.utils.Picker"),n$X.calculateCursorRay=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=n$a.elements[0],n$h=n$a.elements[1],n$i=n$X._tempVector30,n$j=n$i.elements;n$j[0]=n$g,n$j[1]=n$h,n$j[2]=n$b.minDepth;var n$k=n$X._tempVector31,n$l=n$k.elements;n$l[0]=n$g,n$l[1]=n$h,n$l[2]=n$b.maxDepth;var n$m=n$f.origin,n$n=n$X._tempVector32;n$b.unprojectFromWVP(n$i,n$c,n$d,n$e,n$m),n$b.unprojectFromWVP(n$k,n$c,n$d,n$e,n$n);var n$o=n$f.direction.elements;n$o[0]=n$n.x-n$m.x,n$o[1]=n$n.y-n$m.y,n$o[2]=n$n.z-n$m.z,n$gb.normalize(n$f.direction,n$f.direction)},n$X.rayIntersectsPositionsAndIndices=function(n$a,n$b,n$c,n$d,n$e){for(var n$f=n$c.vertexStride/4,n$g=n$c.getVertexElementByUsage(0).offset/4,n$h=Number.MAX_VALUE,n$i=-1,n$j=-1,n$k=-1,n$l=0;n$l<n$d.length;n$l+=3){var n$m=n$X._tempVector35,n$n=n$m.elements,n$o=n$d[n$l]*n$f,n$p=n$o+n$g;n$n[0]=n$b[n$p],n$n[1]=n$b[1+n$p],n$n[2]=n$b[2+n$p];var n$q=n$X._tempVector36,n$r=n$q.elements,n$s=n$d[n$l+1]*n$f,n$t=n$s+n$g;n$r[0]=n$b[n$t],n$r[1]=n$b[1+n$t],n$r[2]=n$b[2+n$t];var n$u=n$X._tempVector37,n$v=n$u.elements,n$w=n$d[n$l+2]*n$f,n$x=n$w+n$g;n$v[0]=n$b[n$x],n$v[1]=n$b[1+n$x],n$v[2]=n$b[2+n$x];var n$y=laya.d3.utils.Picker.rayIntersectsTriangle(n$a,n$m,n$q,n$u);!isNaN(n$y)&&n$y<n$h&&(n$h=n$y,n$i=n$o,n$j=n$s,n$k=n$w)}if(n$h===Number.MAX_VALUE)return n$e.position.toDefault(),n$e.distance=Number.MAX_VALUE,n$e.trianglePositions[0].toDefault(),n$e.trianglePositions[1].toDefault(),n$e.trianglePositions[2].toDefault(),n$e.triangleNormals[0].toDefault(),n$e.triangleNormals[1].toDefault(),n$e.triangleNormals[2].toDefault(),!1;n$e.distance=n$h,n$gb.scale(n$a.direction,n$h,n$e.position),n$gb.add(n$a.origin,n$e.position,n$e.position);var n$z=n$e.trianglePositions,n$C=n$z[0],n$D=n$z[1],n$E=n$z[2],n$F=n$C.elements,n$G=n$D.elements,n$H=n$E.elements,n$I=n$i+n$g;n$F[0]=n$b[n$I],n$F[1]=n$b[n$I+1],n$F[2]=n$b[n$I+2];var n$J=n$j+n$g;n$G[0]=n$b[n$J],n$G[1]=n$b[n$J+1],n$G[2]=n$b[n$J+2];var n$K=n$k+n$g;n$H[0]=n$b[n$K],n$H[1]=n$b[n$K+1],n$H[2]=n$b[n$K+2];var n$L=n$c.getVertexElementByUsage(3);if(n$L){var n$M=n$L.offset/4,n$N=n$e.triangleNormals,n$O=n$N[0],n$P=n$N[1],n$Q=n$N[2],n$R=n$O.elements,n$S=n$P.elements,n$T=n$Q.elements,n$U=n$i+n$M;n$R[0]=n$b[n$U],n$R[1]=n$b[n$U+1],n$R[2]=n$b[n$U+2];var n$V=n$j+n$M;n$S[0]=n$b[n$V],n$S[1]=n$b[n$V+1],n$S[2]=n$b[n$V+2];var n$W=n$k+n$M;n$T[0]=n$b[n$W],n$T[1]=n$b[n$W+1],n$T[2]=n$b[n$W+2]}return!0},n$X.rayIntersectsTriangle=function(n$a,n$b,n$c,n$d){var n$e=n$X._tempVector30,n$f=n$X._tempVector31;n$gb.subtract(n$c,n$b,n$e),n$gb.subtract(n$d,n$b,n$f);var n$g,n$h=n$X._tempVector32;if(n$gb.cross(n$a.direction,n$f,n$h),(n$g=n$gb.dot(n$e,n$h))>-Number.MIN_VALUE&&n$g<Number.MIN_VALUE)return Number.NaN;var n$i,n$j=1/n$g,n$k=n$X._tempVector33;if(n$gb.subtract(n$a.origin,n$b,n$k),n$i=n$gb.dot(n$k,n$h),(n$i*=n$j)<0||1<n$i)return Number.NaN;var n$l,n$m,n$n=n$X._tempVector34;return n$gb.cross(n$k,n$e,n$n),n$l=n$gb.dot(n$a.direction,n$n),(n$l*=n$j)<0||1<n$i+n$l?Number.NaN:(n$m=n$gb.dot(n$f,n$n),(n$m*=n$j)<0?Number.NaN:n$m)},n$l(n$X,["_tempVector30",function(){return this._tempVector30=new n$gb},"_tempVector31",function(){return this._tempVector31=new n$gb},"_tempVector32",function(){return this._tempVector32=new n$gb},"_tempVector33",function(){return this._tempVector33=new n$gb},"_tempVector34",function(){return this._tempVector34=new n$gb},"_tempVector35",function(){return this._tempVector35=new n$gb},"_tempVector36",function(){return this._tempVector36=new n$gb},"_tempVector37",function(){return this._tempVector37=new n$gb}]),n$X}(),n$pb=(function(){function n$a(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new n$gb,new n$gb,new n$gb],this.trianglePositions.length=3,this.triangleNormals=[new n$gb,new n$gb,new n$gb],this.triangleNormals.length=3,this.position=new n$gb}n$n(n$a,"laya.d3.utils.RaycastHit"),n$a.prototype.cloneTo=function(n$a){n$a.distance=this.distance,this.trianglePositions[0].cloneTo(n$a.trianglePositions[0]),this.trianglePositions[1].cloneTo(n$a.trianglePositions[1]),this.trianglePositions[2].cloneTo(n$a.trianglePositions[2]),this.triangleNormals[0].cloneTo(n$a.triangleNormals[0]),this.triangleNormals[1].cloneTo(n$a.triangleNormals[1]),this.triangleNormals[2].cloneTo(n$a.triangleNormals[2]),this.position.cloneTo(n$a.position),n$a.sprite3D=this.sprite3D}}(),function(){function n$a(n$a,n$b){this._width=0,this._height=0,this._width=n$a,this._height=n$b}n$n(n$a,"laya.d3.utils.Size");var n$b=n$a.prototype;return n$o(0,n$b,"width",function(){return-1===this._width?n$Y.clientWidth:this._width}),n$o(0,n$b,"height",function(){return-1===this._height?n$Y.clientHeight:this._height}),n$o(1,n$a,"fullScreen",function(){return new n$a(-1,-1)}),n$a}()),n$qb=function(){function n$I(){}return n$n(n$I,"laya.d3.utils.Utils3D"),n$I._rotationTransformScaleSkinAnimation=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$l){var n$m,n$n,n$o,n$p,n$q,n$r=n$I._tempArray16_0,n$s=n$I._tempArray16_1,n$t=n$I._tempArray16_2,n$u=n$d+n$d,n$v=n$e+n$e,n$w=n$f+n$f,n$x=n$d*n$u,n$y=n$e*n$u,n$z=n$e*n$v,n$C=n$f*n$u,n$D=n$f*n$v,n$E=n$f*n$w,n$F=n$g*n$u,n$G=n$g*n$v,n$H=n$g*n$w;for(n$r[15]=1,n$r[0]=1-n$z-n$E,n$r[1]=n$y+n$H,n$r[2]=n$C-n$G,n$r[4]=n$y-n$H,n$r[5]=1-n$x-n$E,n$r[6]=n$D+n$F,n$r[8]=n$C+n$G,n$r[9]=n$D-n$F,n$r[10]=1-n$x-n$z,n$s[15]=1,n$s[0]=n$h,n$s[5]=n$i,n$s[10]=n$j,n$m=0;n$m<4;n$m++)n$n=n$r[n$m],n$o=n$r[n$m+4],n$p=n$r[n$m+8],n$q=n$r[n$m+12],n$t[n$m]=n$n,n$t[n$m+4]=n$o,n$t[n$m+8]=n$p,n$t[n$m+12]=n$n*n$a+n$o*n$b+n$p*n$c+n$q;for(n$m=0;n$m<4;n$m++)n$n=n$t[n$m],n$o=n$t[n$m+4],n$p=n$t[n$m+8],n$q=n$t[n$m+12],n$k[n$m+n$l]=n$n*n$s[0]+n$o*n$s[1]+n$p*n$s[2]+n$q*n$s[3],n$k[n$m+n$l+4]=n$n*n$s[4]+n$o*n$s[5]+n$p*n$s[6]+n$q*n$s[7],n$k[n$m+n$l+8]=n$n*n$s[8]+n$o*n$s[9]+n$p*n$s[10]+n$q*n$s[11],n$k[n$m+n$l+12]=n$n*n$s[12]+n$o*n$s[13]+n$p*n$s[14]+n$q*n$s[15]},n$I._createNodeByJson=function(n$a,n$b,n$c,n$d){if(!n$c)switch(n$b.type){case"Sprite3D":n$c=new n$Kb;break;case"MeshSprite3D":n$c=new n$Xb;break;case"SkinnedMeshSprite3D":n$c=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":n$c=new ShuriKenParticle3D;break;case"TrailSprite3D":n$c=new TrailSprite3D;break;case"Terrain":n$c=new Terrain;break;case"Camera":n$c=new n$Wb;break;case"DirectionLight":n$c=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var n$e=n$b.props;if(n$e)for(var n$f in n$e)n$c[n$f]=n$e[n$f];var n$g=n$b.customProps;n$g&&(n$c instanceof laya.d3.core.Sprite3D?(n$c._parseBaseCustomProps(n$g),n$c._parseCustomProps(n$a,n$d,n$g,n$b),n$c._parseCustomComponent(n$a,n$d,n$b.components)):n$c._parseCustomProps(n$a,n$d,n$g,n$b));var n$h=n$b.child;if(n$h)for(var n$i=0,n$j=n$h.length;n$i<n$j;n$i++){var n$k=n$I._createNodeByJson(n$a,n$h[n$i],null,n$d);n$c.addChild(n$k)}return n$c},n$I._computeBoneAndAnimationDatasByBindPoseMatrxix=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g,n$h,n$i=0,n$j=0,n$k=n$a.length;for(n$g=0;n$g<n$k;n$i+=n$a[n$g].keyframeWidth,n$j+=16,n$g++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(n$b[n$i+0],n$b[n$i+1],n$b[n$i+2],n$b[n$i+3],n$b[n$i+4],n$b[n$i+5],n$b[n$i+6],n$b[n$i+7],n$b[n$i+8],n$b[n$i+9],n$d,n$j),0!=n$g&&(n$h=16*n$a[n$g].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(n$d,n$h,n$d,n$j,n$d,n$j));var n$l=n$c.length;for(n$g=0;n$g<n$l;n$g++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(n$d,16*n$f[n$g],n$c[n$g],n$e,16*n$g)},n$I._computeAnimationDatasByArrayAndMatrixFast=function(n$a,n$b,n$c,n$d){for(var n$e=0,n$f=n$a.length;n$e<n$f;n$e++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(n$b,16*n$d[n$e],n$a[n$e],n$c,16*n$e)},n$I._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(n$a,n$b,n$c,n$d,n$e){var n$f,n$g,n$h=0,n$i=0,n$j=n$a.length;for(n$f=0;n$f<n$j;n$h+=n$a[n$f].keyframeWidth,n$i+=16,n$f++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(n$b[n$h+7],n$b[n$h+8],n$b[n$h+9],n$b[n$h+3],n$b[n$h+4],n$b[n$h+5],n$b[n$h+6],n$b[n$h+0],n$b[n$h+1],n$b[n$h+2],n$d,n$i),0!=n$f&&(n$g=16*n$a[n$f].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(n$d,n$g,n$d,n$i,n$d,n$i));var n$k=n$c.length;for(n$f=0;n$f<n$k;n$f++){var n$l=16*n$f;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(n$d,n$l,n$c[n$f],n$e,n$l)}},n$I._computeAnimationDatasByArrayAndMatrixFastOld=function(n$a,n$b,n$c){for(var n$d=n$a.length,n$e=0;n$e<n$d;n$e++){var n$f=16*n$e;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(n$b,n$f,n$a[n$e],n$c,n$f)}},n$I._computeRootAnimationData=function(n$a,n$b,n$c){for(var n$d=0,n$e=0,n$f=0,n$g=n$a.length;n$d<n$g;n$e+=n$a[n$d].keyframeWidth,n$f+=16,n$d++)laya.d3.utils.Utils3D.createAffineTransformationArray(n$b[n$e+0],n$b[n$e+1],n$b[n$e+2],n$b[n$e+3],n$b[n$e+4],n$b[n$e+5],n$b[n$e+6],n$b[n$e+7],n$b[n$e+8],n$b[n$e+9],n$c,n$f)},n$I.transformVector3ArrayByQuat=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$c.elements,n$g=n$a[n$b],n$h=n$a[n$b+1],n$i=n$a[n$b+2],n$j=n$f[0],n$k=n$f[1],n$l=n$f[2],n$m=n$f[3],n$n=n$m*n$g+n$k*n$i-n$l*n$h,n$o=n$m*n$h+n$l*n$g-n$j*n$i,n$p=n$m*n$i+n$j*n$h-n$k*n$g,n$q=-n$j*n$g-n$k*n$h-n$l*n$i;n$d[n$e]=n$n*n$m+n$q*-n$j+n$o*-n$l-n$p*-n$k,n$d[n$e+1]=n$o*n$m+n$q*-n$k+n$p*-n$j-n$n*-n$l,n$d[n$e+2]=n$p*n$m+n$q*-n$l+n$n*-n$k-n$o*-n$j},n$I.mulMatrixByArray=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g,n$h,n$i,n$j,n$k;if(n$e===n$c){for(n$c=n$I._tempArray16_3,n$g=0;n$g<16;++n$g)n$c[n$g]=n$e[n$f+n$g];n$d=0}for(n$g=0;n$g<4;n$g++)n$h=n$a[n$b+n$g],n$i=n$a[n$b+n$g+4],n$j=n$a[n$b+n$g+8],n$k=n$a[n$b+n$g+12],n$e[n$f+n$g]=n$h*n$c[n$d+0]+n$i*n$c[n$d+1]+n$j*n$c[n$d+2]+n$k*n$c[n$d+3],n$e[n$f+n$g+4]=n$h*n$c[n$d+4]+n$i*n$c[n$d+5]+n$j*n$c[n$d+6]+n$k*n$c[n$d+7],n$e[n$f+n$g+8]=n$h*n$c[n$d+8]+n$i*n$c[n$d+9]+n$j*n$c[n$d+10]+n$k*n$c[n$d+11],n$e[n$f+n$g+12]=n$h*n$c[n$d+12]+n$i*n$c[n$d+13]+n$j*n$c[n$d+14]+n$k*n$c[n$d+15]},n$I.mulMatrixByArrayFast=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g,n$h,n$i,n$j,n$k;for(n$g=0;n$g<4;n$g++)n$h=n$a[n$b+n$g],n$i=n$a[n$b+n$g+4],n$j=n$a[n$b+n$g+8],n$k=n$a[n$b+n$g+12],n$e[n$f+n$g]=n$h*n$c[n$d+0]+n$i*n$c[n$d+1]+n$j*n$c[n$d+2]+n$k*n$c[n$d+3],n$e[n$f+n$g+4]=n$h*n$c[n$d+4]+n$i*n$c[n$d+5]+n$j*n$c[n$d+6]+n$k*n$c[n$d+7],n$e[n$f+n$g+8]=n$h*n$c[n$d+8]+n$i*n$c[n$d+9]+n$j*n$c[n$d+10]+n$k*n$c[n$d+11],n$e[n$f+n$g+12]=n$h*n$c[n$d+12]+n$i*n$c[n$d+13]+n$j*n$c[n$d+14]+n$k*n$c[n$d+15]},n$I.mulMatrixByArrayAndMatrixFast=function(n$a,n$b,n$c,n$d,n$e){var n$f,n$g,n$h,n$i,n$j,n$k=n$c.elements,n$l=n$k[0],n$m=n$k[1],n$n=n$k[2],n$o=n$k[3],n$p=n$k[4],n$q=n$k[5],n$r=n$k[6],n$s=n$k[7],n$t=n$k[8],n$u=n$k[9],n$v=n$k[10],n$w=n$k[11],n$x=n$k[12],n$y=n$k[13],n$z=n$k[14],n$C=n$k[15],n$D=n$b,n$E=n$b+4,n$F=n$b+8,n$G=n$b+12,n$H=n$e,n$I=n$e+4,n$J=n$e+8,n$K=n$e+12;for(n$f=0;n$f<4;n$f++)n$g=n$a[n$D+n$f],n$h=n$a[n$E+n$f],n$i=n$a[n$F+n$f],n$j=n$a[n$G+n$f],n$d[n$H+n$f]=n$g*n$l+n$h*n$m+n$i*n$n+n$j*n$o,n$d[n$I+n$f]=n$g*n$p+n$h*n$q+n$i*n$r+n$j*n$s,n$d[n$J+n$f]=n$g*n$t+n$h*n$u+n$i*n$v+n$j*n$w,n$d[n$K+n$f]=n$g*n$x+n$h*n$y+n$i*n$z+n$j*n$C},n$I.createAffineTransformationArray=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$l){var n$m=n$d+n$d,n$n=n$e+n$e,n$o=n$f+n$f,n$p=n$d*n$m,n$q=n$d*n$n,n$r=n$d*n$o,n$s=n$e*n$n,n$t=n$e*n$o,n$u=n$f*n$o,n$v=n$g*n$m,n$w=n$g*n$n,n$x=n$g*n$o;n$k[n$l+0]=(1-(n$s+n$u))*n$h,n$k[n$l+1]=(n$q+n$x)*n$h,n$k[n$l+2]=(n$r-n$w)*n$h,n$k[n$l+3]=0,n$k[n$l+4]=(n$q-n$x)*n$i,n$k[n$l+5]=(1-(n$p+n$u))*n$i,n$k[n$l+6]=(n$t+n$v)*n$i,n$k[n$l+7]=0,n$k[n$l+8]=(n$r+n$w)*n$j,n$k[n$l+9]=(n$t-n$v)*n$j,n$k[n$l+10]=(1-(n$p+n$s))*n$j,n$k[n$l+11]=0,n$k[n$l+12]=n$a,n$k[n$l+13]=n$b,n$k[n$l+14]=n$c,n$k[n$l+15]=1},n$I.transformVector3ArrayToVector3ArrayCoordinate=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$I._tempArray4_0,n$g=n$a[n$b+0],n$h=n$a[n$b+1],n$i=n$a[n$b+2],n$j=n$c.elements;n$f[0]=n$g*n$j[0]+n$h*n$j[4]+n$i*n$j[8]+n$j[12],n$f[1]=n$g*n$j[1]+n$h*n$j[5]+n$i*n$j[9]+n$j[13],n$f[2]=n$g*n$j[2]+n$h*n$j[6]+n$i*n$j[10]+n$j[14],n$f[3]=1/(n$g*n$j[3]+n$h*n$j[7]+n$i*n$j[11]+n$j[15]),n$d[n$e+0]=n$f[0]*n$f[3],n$d[n$e+1]=n$f[1]*n$f[3],n$d[n$e+2]=n$f[2]*n$f[3]},n$I.transformLightingMapTexcoordByUV0Array=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$c.elements;n$d[n$e+0]=n$a[n$b+0]*n$f[0]+n$f[2],n$d[n$e+1]=(n$a[n$b+1]-1)*n$f[1]+n$f[3]},n$I.transformLightingMapTexcoordByUV1Array=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$c.elements;n$d[n$e+0]=n$a[n$b+0]*n$f[0]+n$f[2],n$d[n$e+1]=1+n$a[n$b+1]*n$f[1]+n$f[3]},n$I.getURLVerion=function(n$a){var n$b=n$a.indexOf("?");return 0<=n$b?n$a.substr(n$b):null},n$I._quaternionCreateFromYawPitchRollArray=function(n$a,n$b,n$c,n$d){var n$e=.5*n$c,n$f=.5*n$b,n$g=.5*n$a,n$h=Math.sin(n$e),n$i=Math.cos(n$e),n$j=Math.sin(n$f),n$k=Math.cos(n$f),n$l=Math.sin(n$g),n$m=Math.cos(n$g);n$d[0]=n$m*n$j*n$i+n$l*n$k*n$h,n$d[1]=n$l*n$k*n$i-n$m*n$j*n$h,n$d[2]=n$m*n$k*n$h-n$l*n$j*n$i,n$d[3]=n$m*n$k*n$i+n$l*n$j*n$h},n$I._createAffineTransformationArray=function(n$a,n$b,n$c,n$d){var n$e=n$b[0],n$f=n$b[1],n$g=n$b[2],n$h=n$b[3],n$i=n$e+n$e,n$j=n$f+n$f,n$k=n$g+n$g,n$l=n$e*n$i,n$m=n$e*n$j,n$n=n$e*n$k,n$o=n$f*n$j,n$p=n$f*n$k,n$q=n$g*n$k,n$r=n$h*n$i,n$s=n$h*n$j,n$t=n$h*n$k,n$u=n$c[0],n$v=n$c[1],n$w=n$c[2];n$d[0]=(1-(n$o+n$q))*n$u,n$d[1]=(n$m+n$t)*n$u,n$d[2]=(n$n-n$s)*n$u,n$d[3]=0,n$d[4]=(n$m-n$t)*n$v,n$d[5]=(1-(n$l+n$q))*n$v,n$d[6]=(n$p+n$r)*n$v,n$d[7]=0,n$d[8]=(n$n+n$s)*n$w,n$d[9]=(n$p-n$r)*n$w,n$d[10]=(1-(n$l+n$o))*n$w,n$d[11]=0,n$d[12]=n$a[0],n$d[13]=n$a[1],n$d[14]=n$a[2],n$d[15]=1},n$I._mulMatrixArray=function(n$a,n$b,n$c,n$d){var n$e,n$f,n$g,n$h,n$i,n$j=n$b.elements,n$k=n$j[0],n$l=n$j[1],n$m=n$j[2],n$n=n$j[3],n$o=n$j[4],n$p=n$j[5],n$q=n$j[6],n$r=n$j[7],n$s=n$j[8],n$t=n$j[9],n$u=n$j[10],n$v=n$j[11],n$w=n$j[12],n$x=n$j[13],n$y=n$j[14],n$z=n$j[15],n$C=n$d,n$D=n$d+4,n$E=n$d+8,n$F=n$d+12;for(n$e=0;n$e<4;n$e++)n$f=n$a[n$e],n$g=n$a[n$e+4],n$h=n$a[n$e+8],n$i=n$a[n$e+12],n$c[n$C+n$e]=n$f*n$k+n$g*n$l+n$h*n$m+n$i*n$n,n$c[n$D+n$e]=n$f*n$o+n$g*n$p+n$h*n$q+n$i*n$r,n$c[n$E+n$e]=n$f*n$s+n$g*n$t+n$h*n$u+n$i*n$v,n$c[n$F+n$e]=n$f*n$w+n$g*n$x+n$h*n$y+n$i*n$z},n$I.getYawPitchRoll=function(n$a,n$b){n$I.transformQuat(n$gb.ForwardRH,n$a,n$cb.TEMPVector31),n$I.transformQuat(n$gb.Up,n$a,n$cb.TEMPVector32);var n$c=n$cb.TEMPVector32.elements;n$I.angleTo(n$gb.ZERO,n$cb.TEMPVector31,n$cb.TEMPVector33);var n$d=n$cb.TEMPVector33.elements;n$d[0]==Math.PI/2?(n$d[1]=n$I.arcTanAngle(n$c[2],n$c[0]),n$d[2]=0):n$d[0]==-Math.PI/2?(n$d[1]=n$I.arcTanAngle(-n$c[2],-n$c[0]),n$d[2]=0):(n$ab.createRotationY(-n$d[1],n$cb.TEMPMatrix0),n$ab.createRotationX(-n$d[0],n$cb.TEMPMatrix1),n$gb.transformCoordinate(n$cb.TEMPVector32,n$cb.TEMPMatrix0,n$cb.TEMPVector32),n$gb.transformCoordinate(n$cb.TEMPVector32,n$cb.TEMPMatrix1,n$cb.TEMPVector32),n$d[2]=n$I.arcTanAngle(n$c[1],-n$c[0])),n$d[1]<=-Math.PI&&(n$d[1]=Math.PI),n$d[2]<=-Math.PI&&(n$d[2]=Math.PI),n$d[1]>=Math.PI&&n$d[2]>=Math.PI&&(n$d[1]=0,n$d[2]=0,n$d[0]=Math.PI-n$d[0]),n$b[0]=n$d[1],n$b[1]=n$d[0],n$b[2]=n$d[2]},n$I.arcTanAngle=function(n$a,n$b){return 0==n$a?1==n$b?Math.PI/2:-Math.PI/2:0<n$a?Math.atan(n$b/n$a):n$a<0?0<n$b?Math.atan(n$b/n$a)+Math.PI:Math.atan(n$b/n$a)-Math.PI:0},n$I.angleTo=function(n$a,n$b,n$c){n$gb.subtract(n$b,n$a,n$cb.TEMPVector30),n$gb.normalize(n$cb.TEMPVector30,n$cb.TEMPVector30),n$c.elements[0]=Math.asin(n$cb.TEMPVector30.y),n$c.elements[1]=n$I.arcTanAngle(-n$cb.TEMPVector30.z,-n$cb.TEMPVector30.x)},n$I.transformQuat=function(n$a,n$b,n$c){var n$d=n$c.elements,n$e=n$a.elements,n$f=n$b,n$g=n$e[0],n$h=n$e[1],n$i=n$e[2],n$j=n$f[0],n$k=n$f[1],n$l=n$f[2],n$m=n$f[3],n$n=n$m*n$g+n$k*n$i-n$l*n$h,n$o=n$m*n$h+n$l*n$g-n$j*n$i,n$p=n$m*n$i+n$j*n$h-n$k*n$g,n$q=-n$j*n$g-n$k*n$h-n$l*n$i;n$d[0]=n$n*n$m+n$q*-n$j+n$o*-n$l-n$p*-n$k,n$d[1]=n$o*n$m+n$q*-n$k+n$p*-n$j-n$n*-n$l,n$d[2]=n$p*n$m+n$q*-n$l+n$n*-n$k-n$o*-n$j},n$I.quaterionNormalize=function(n$a,n$b){var n$c=n$a[0],n$d=n$a[1],n$e=n$a[2],n$f=n$a[3],n$g=n$c*n$c+n$d*n$d+n$e*n$e+n$f*n$f;0<n$g&&(n$g=1/Math.sqrt(n$g),n$b[0]=n$c*n$g,n$b[1]=n$d*n$g,n$b[2]=n$e*n$g,n$b[3]=n$f*n$g)},n$I.matrix4x4MultiplyFFF=function(n$a,n$b,n$c){var n$d,n$e,n$f,n$g,n$h;if(n$c===n$b)for(n$b=new Float32Array(16),n$d=0;n$d<16;++n$d)n$b[n$d]=n$c[n$d];for(n$d=0;n$d<4;n$d++)n$e=n$a[n$d],n$f=n$a[n$d+4],n$g=n$a[n$d+8],n$h=n$a[n$d+12],n$c[n$d]=n$e*n$b[0]+n$f*n$b[1]+n$g*n$b[2]+n$h*n$b[3],n$c[n$d+4]=n$e*n$b[4]+n$f*n$b[5]+n$g*n$b[6]+n$h*n$b[7],n$c[n$d+8]=n$e*n$b[8]+n$f*n$b[9]+n$g*n$b[10]+n$h*n$b[11],n$c[n$d+12]=n$e*n$b[12]+n$f*n$b[13]+n$g*n$b[14]+n$h*n$b[15]},n$I.matrix4x4MultiplyMFM=function(n$a,n$b,n$c){n$I.matrix4x4MultiplyFFF(n$a.elements,n$b,n$c.elements)},n$l(n$I,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new n$gb},"_tempVector3_1",function(){return this._tempVector3_1=new n$gb},"_tempVector3_2",function(){return this._tempVector3_2=new n$gb},"_tempVector3_3",function(){return this._tempVector3_3=new n$gb},"_tempVector3_4",function(){return this._tempVector3_4=new n$gb},"_tempVector3_5",function(){return this._tempVector3_5=new n$gb},"_tempVector3_6",function(){return this._tempVector3_6=new n$gb},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),n$I}(),n$rb=function(){function n$G(){}return n$n(n$G,"Laya3D"),n$G._cancelLoadByUrl=function(n$a){n$v.loader.cancelLoadByUrl(n$a),n$G._innerFirstLevelLoaderManager.cancelLoadByUrl(n$a),n$G._innerSecondLevelLoaderManager.cancelLoadByUrl(n$a),n$G._innerThirdLevelLoaderManager.cancelLoadByUrl(n$a),n$G._innerFourthLevelLoaderManager.cancelLoadByUrl(n$a)},n$G._changeWebGLSize=function(n$a,n$b){n$F.onStageResize(n$a,n$b),n$Y.clientWidth=n$a,n$Y.clientHeight=n$b},n$G.__init__=function(){var n$a=n$b.createMap;n$a.lh=[n$Kb,"SPRITE3DHIERARCHY"],n$a.ls=[n$Jb,"SPRITE3DHIERARCHY"],n$a.lm=[n$Rb,"MESH"],n$a.lmat=[n$Mb,"MATERIAL"],n$a.jpg=[n$Tb,"nativeimage"],n$a.jpeg=[n$Tb,"nativeimage"],n$a.png=[n$Tb,"nativeimage"],n$a.pkm=[n$Tb,"arraybuffer"],n$a.raw=[n$Pb,"arraybuffer"],n$a.mipmaps=[n$Pb,"arraybuffer"],n$r.parserMap.SPRITE3DHIERARCHY=n$G._loadHierarchy,n$r.parserMap.MESH=n$G._loadMesh,n$r.parserMap.MATERIAL=n$G._loadMaterial,n$r.parserMap.TEXTURECUBE=n$G._loadTextureCube,n$r.parserMap.TERRAIN=n$G._loadTerrain,n$G._innerFirstLevelLoaderManager.on("error",null,n$G._eventLoadManagerError),n$G._innerSecondLevelLoaderManager.on("error",null,n$G._eventLoadManagerError),n$G._innerThirdLevelLoaderManager.on("error",null,n$G._eventLoadManagerError),n$G._innerFourthLevelLoaderManager.on("error",null,n$G._eventLoadManagerError)},n$G.READ_BLOCK=function(){return n$G._readData.pos+=4,!0},n$G.READ_DATA=function(){return n$G._DATA.offset=n$G._readData.getUint32(),n$G._DATA.size=n$G._readData.getUint32(),!0},n$G.READ_STRINGS=function(){var n$a=[],n$b={offset:0,size:0};n$b.offset=n$G._readData.getUint16(),n$b.size=n$G._readData.getUint16();n$G._readData.pos;n$G._readData.pos=n$b.offset+n$G._DATA.offset;for(var n$c=0;n$c<n$b.size;n$c++){var n$d=n$G._readData.readUTFString();-1===n$d.lastIndexOf(".lmat")&&-1===n$d.lastIndexOf(".lpbr")||n$a.push(n$d)}return n$a},n$G.formatRelativePath=function(n$a,n$b){var n$c;if("."===n$b.charAt(0)){for(var n$d=(n$a+n$b).split("/"),n$e=0,n$f=n$d.length;n$e<n$f;n$e++)if(".."==n$d[n$e]){var n$g=n$e-1;0<n$g&&".."!==n$d[n$g]&&(n$d.splice(n$g,2),n$e-=2)}n$c=n$d.join("/")}else n$c=n$a+n$b;return null!=n$E.customFormat&&(n$c=n$E.customFormat(n$c,null)),n$c},n$G._eventLoadManagerError=function(n$a){n$v.loader.event("error",n$a)},n$G._addHierarchyInnerUrls=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g=n$G.formatRelativePath(n$d,n$e);n$c&&(n$g+=n$c),n$a.push({url:n$g,clas:n$f}),n$b[n$e]=n$g},n$G._getSprite3DHierarchyInnerUrls=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){var n$h,n$i=0,n$j=0;switch(n$a.type){case"Scene":var n$k=n$a.customProps.lightmaps;for(n$i=0,n$j=n$k.length;n$i<n$j;n$i++){var n$l=n$k[n$i].replace(".exr",".png");n$G._addHierarchyInnerUrls(n$d,n$e,n$f,n$g,n$l,n$Tb)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var n$m;if(n$a.instanceParams)(n$m=n$a.instanceParams.loadPath)&&n$G._addHierarchyInnerUrls(n$b,n$e,n$f,n$g,n$m,n$Rb);else{(n$m=(n$h=n$a.customProps).meshPath)&&n$G._addHierarchyInnerUrls(n$b,n$e,n$f,n$g,n$m,n$Rb);var n$n=n$h.materials;if(n$n)for(n$i=0,n$j=n$n.length;n$i<n$j;n$i++){for(var n$o=n$n[n$i],n$p=n$o.type.split("."),n$q=n$H.window,n$r=0,n$s=n$p.length;n$r<n$s;++n$r){n$q=n$q[this.clasPaths[n$r]]}if("function"!=typeof n$q)throw"_getSprite3DHierarchyInnerUrls 错误: "+n$o.type+" 不是类";n$G._addHierarchyInnerUrls(n$c,n$e,n$f,n$g,n$o.path,n$q)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var n$t=(n$h=n$a.customProps).meshPath;n$t&&n$G._addHierarchyInnerUrls(n$b,n$e,n$f,n$g,n$t,n$Rb);var n$u=n$h.material;if(n$u){n$p=n$u.type.split("."),n$q=n$H.window;for(n$r=0,n$s=n$p.length;n$r<n$s;++n$r){n$q=n$q[this.clasPaths[n$r]]}n$G._addHierarchyInnerUrls(n$c,n$e,n$f,n$g,n$u.path,n$q)}else{var n$v=n$h.materialPath;if(n$v)n$G._addHierarchyInnerUrls(n$c,n$e,n$f,n$g,n$v,ShurikenParticleMaterial);else{var n$w=n$h.texturePath;n$w&&n$G._addHierarchyInnerUrls(n$d,n$e,n$f,n$g,n$w,n$Tb)}}break;case"Terrain":n$G._addHierarchyInnerUrls(n$d,n$e,n$f,n$g,n$a.customProps.dataPath,TerrainRes)}var n$x=n$a.components;for(var n$y in n$x){var n$z=n$x[n$y];switch(n$y){case"Animator":var n$C=n$z.avatarPath;if(n$C)n$G._addHierarchyInnerUrls(n$d,n$e,n$f,n$g,n$C,Avatar);else{var n$D=n$z.avatar;n$D&&n$G._addHierarchyInnerUrls(n$d,n$e,n$f,n$g,n$D.path,Avatar)}var n$E=n$z.clipPaths;for(n$i=0,n$j=n$E.length;n$i<n$j;n$i++)n$G._addHierarchyInnerUrls(n$d,n$e,n$f,n$g,n$E[n$i],AnimationClip)}}var n$F=n$a.child;for(n$i=0,n$j=n$F.length;n$i<n$j;n$i++)n$G._getSprite3DHierarchyInnerUrls(n$F[n$i],n$b,n$c,n$d,n$e,n$f,n$g)},n$G._loadHierarchy=function(n$a){n$a.on("loaded",null,n$G._onHierarchylhLoaded,[n$a,n$a._class._getGroup()]),n$a.load(n$a.url,"json",!1,null,!0)},n$G._onHierarchylhLoaded=function(n$a,n$b,n$c){if(n$a._class.destroyed)n$a.endLoad();else{var n$d=n$a.url,n$e=n$qb.getURLVerion(n$d),n$f=n$E.getPath(n$d),n$g=[],n$h=[],n$i=[],n$j={};n$G._getSprite3DHierarchyInnerUrls(n$c,n$g,n$h,n$i,n$j,n$e,n$f);var n$k=n$g.length+n$h.length+n$i.length,n$l=n$k+1,n$m=1/n$l;if(n$G._onProcessChange(n$a,0,n$m,1),0<n$i.length){var n$n=n$k/n$l,n$o=n$D.create(null,n$G._onProcessChange,[n$a,n$m,n$n],!1);n$G._innerFourthLevelLoaderManager.create(n$i,n$D.create(null,n$G._onHierarchyInnerForthLevResouLoaded,[n$a,n$b,n$o,n$c,n$j,n$g,n$h,n$m+n$n*n$i.length,n$n]),n$o,null,null,1,!0,n$b)}else n$G._onHierarchyInnerForthLevResouLoaded(n$a,n$b,null,n$c,n$j,n$g,n$h,n$m,n$n)}},n$G._onHierarchyInnerForthLevResouLoaded=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){if(n$a._class.destroyed)n$a.endLoad();else if(n$c&&n$c.recover(),0<n$g.length){var n$j=n$D.create(null,n$G._onProcessChange,[n$a,n$h,n$i],!1);n$G._innerSecondLevelLoaderManager.create(n$g,n$D.create(null,n$G._onHierarchyInnerSecondLevResouLoaded,[n$a,n$b,n$j,n$d,n$e,n$f,n$h+n$i*n$g.length,n$i]),n$c,null,null,1,!0,n$b)}else n$G._onHierarchyInnerSecondLevResouLoaded(n$a,n$b,null,n$d,n$e,n$f,n$h,n$i)},n$G._onHierarchyInnerSecondLevResouLoaded=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h){if(n$a._class.destroyed)n$a.endLoad();else if(n$c&&n$c.recover(),0<n$f.length){var n$i=n$D.create(null,n$G._onProcessChange,[n$a,n$g,n$h],!1);n$G._innerFirstLevelLoaderManager.create(n$f,n$D.create(null,n$G._onHierarchyInnerFirstLevResouLoaded,[n$a,n$i,n$d,n$e]),n$c,null,null,1,!0,n$b)}else n$G._onHierarchyInnerFirstLevResouLoaded(n$a,null,n$d,n$e)},n$G._onHierarchyInnerFirstLevResouLoaded=function(n$a,n$b,n$c,n$d){n$b&&n$b.recover(),n$a.endLoad([n$c,n$d])},n$G._loadTerrain=function(n$a){n$a.on("loaded",null,n$G._onTerrainLtLoaded,[n$a,n$a._class._getGroup()]),n$a.load(n$a.url,"json",!1,null,!0)},n$G._onTerrainLtLoaded=function(n$a,n$b,n$c){if(n$a._class.destroyed)n$a.endLoad();else{var n$d,n$e,n$f=n$a.url,n$g=n$qb.getURLVerion(n$f),n$h=n$E.getPath(n$f),n$i=[],n$j={},n$k=0,n$l=0,n$m=n$c.heightData;n$d=n$m.url,n$e=n$G.formatRelativePath(n$h,n$d),n$g&&(n$e+=n$g),n$d=n$j[n$d]=n$e;var n$n=n$c.detailTexture;for(n$k=0,n$l=n$n.length;n$k<n$l;n$k++)n$i.push({url:n$n[n$k].diffuse});var n$o=n$c.normalMap;for(n$k=0,n$l=n$o.length;n$k<n$l;n$k++)n$i.push({url:n$o[n$k]});var n$p=n$c.alphaMap;for(n$k=0,n$l=n$p.length;n$k<n$l;n$k++)n$i.push({url:n$p[n$k],params:[!1,!1,6408,!0]});for(n$k=0,n$l=n$i.length;n$k<n$l;n$k++){var n$q=n$i[n$k].url;n$e=n$G.formatRelativePath(n$h,n$q),n$g&&(n$e+=n$g),n$i[n$k].url=n$e,n$j[n$q]=n$e}var n$r=n$i.length,n$s=n$r+2,n$t=1/n$s;n$G._onProcessChange(n$a,0,n$t,1);var n$u={heightMapLoaded:!1,texturesLoaded:!1},n$v=n$D.create(null,n$G._onProcessChange,[n$a,n$t,n$t],!1);n$G._innerFourthLevelLoaderManager.create(n$d,n$D.create(null,n$G._onTerrainHeightMapLoaded,[n$a,n$v,n$c,n$j,n$u]),n$v,null,[n$m.numX,n$m.numZ,n$m.bitType,n$m.value],1,!0,n$b);var n$w=n$D.create(null,n$G._onProcessChange,[n$a,2*n$t,n$r/n$s],!1);n$G._innerFourthLevelLoaderManager.create(n$i,n$D.create(null,n$G._onTerrainTexturesLoaded,[n$a,n$w,n$c,n$j,n$u]),n$w,null,null,1,!0,n$b)}},n$G._onTerrainHeightMapLoaded=function(n$a,n$b,n$c,n$d,n$e){n$e.heightMapLoaded=!0,n$e.texturesLoaded&&(n$a.endLoad([n$c,n$d]),n$b.recover())},n$G._onTerrainTexturesLoaded=function(n$a,n$b,n$c,n$d,n$e){n$e.texturesLoaded=!0,n$e.heightMapLoaded&&(n$a.endLoad([n$c,n$d]),n$b.recover())},n$G._loadMesh=function(n$a){n$a.on("loaded",null,n$G._onMeshLmLoaded,[n$a,n$a._class._getGroup()]),n$a.load(n$a.url,"arraybuffer",!1,null,!0)},n$G._onMeshLmLoaded=function(n$a,n$b,n$c){if(n$a._class.destroyed)n$a.endLoad();else{var n$d,n$e,n$f,n$g=n$a.url,n$h=n$qb.getURLVerion(n$g),n$i=n$E.getPath(n$g),n$j={},n$k=0,n$l=0;switch((n$G._readData=new n$w(n$c)).pos=0,n$G._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var n$m=n$G._readData.getUint32();n$G._readData.pos=n$G._readData.pos+4,n$l=n$G._readData.getUint16(),n$G._readData.pos=n$G._readData.pos+8*n$l;var n$n=n$G._readData.getUint32();for(n$l=n$G._readData.getUint16(),n$G._readData.pos=n$m+n$n,n$d=[],n$k=0;n$k<n$l;n$k++){var n$o=n$G._readData.readUTFString();-1!==n$o.lastIndexOf(".lmat")&&n$d.push(n$o)}break;default:for(n$G.READ_BLOCK(),n$k=0;n$k<2;n$k++){var n$p=n$G._readData.getUint16(),n$q=n$G._strings[n$p],n$r=n$G["READ_"+n$q];if(null==n$r)throw new Error("model file err,no this function:"+n$p+" "+n$q);1===n$k?n$d=n$r.call():n$r.call()}}for(n$k=0,n$f=n$d.length;n$k<n$f;n$k++){var n$s=n$d[n$k];n$e=n$G.formatRelativePath(n$i,n$s),n$h&&(n$e+=n$h),n$d[n$k]=n$e,n$j[n$s]=n$e}if(0<n$d.length){n$G._onProcessChange(n$a,0,.5,1);var n$t=n$D.create(null,n$G._onProcessChange,[n$a,.5,.5],!1);n$G._innerSecondLevelLoaderManager.create(n$d,n$D.create(null,n$G._onMeshMateialLoaded,[n$a,n$t,n$c,n$j]),n$t,null,null,1,!0,n$b)}else n$a.endLoad([n$c,n$j])}},n$G._onMeshMateialLoaded=function(n$a,n$b,n$c,n$d){n$a.endLoad([n$c,n$d]),n$b.recover()},n$G._getMaterialTexturePath=function(n$a,n$b,n$c){var n$d=n$a.length-4;return n$a.indexOf(".dds")!=n$d&&n$a.indexOf(".tga")!=n$d&&n$a.indexOf(".exr")!=n$d&&n$a.indexOf(".DDS")!=n$d&&n$a.indexOf(".TGA")!=n$d&&n$a.indexOf(".EXR")!=n$d||(n$a=n$a.substr(0,n$d)+".png"),n$a=n$G.formatRelativePath(n$c,n$a),n$b&&(n$a+=n$b),n$a},n$G._loadMaterial=function(n$a){n$a.on("loaded",null,n$G._onMaterilLmatLoaded,[n$a,n$a._class._getGroup()]),n$a.load(n$a.url,"json",!1,null,!0)},n$G._onMaterilLmatLoaded=function(n$a,n$b,n$c){if(n$a._class.destroyed)n$a.endLoad();else{var n$d,n$e=n$a.url,n$f=n$qb.getURLVerion(n$e),n$g=n$E.getPath(n$e),n$h=[],n$i={},n$j=n$c.customProps,n$k=n$c.version;if(n$k)switch(n$k){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var n$l=n$c.props.textures,n$m=0,n$n=n$l.length;n$m<n$n;n$m++){var n$o=n$l[n$m],n$p=n$o.path;if(n$p){var n$q=n$p.length-4;n$p.indexOf(".exr")!=n$q&&n$p.indexOf(".EXR")!=n$q||(n$p=n$p.substr(0,n$q)+".png"),n$d=n$G.formatRelativePath(n$g,n$p),n$f&&(n$d+=n$f),n$h.push({url:n$d,params:n$o.params}),n$i[n$p]=n$d}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var n$r=n$j.diffuseTexture.texture2D;if(n$r&&(n$d=n$G._getMaterialTexturePath(n$r,n$f,n$g),n$h.push(n$d),n$i[n$r]=n$d),n$j.normalTexture){var n$s=n$j.normalTexture.texture2D;n$s&&(n$d=n$G._getMaterialTexturePath(n$s,n$f,n$g),n$h.push(n$d),n$i[n$s]=n$d)}if(n$j.specularTexture){var n$t=n$j.specularTexture.texture2D;n$t&&(n$d=n$G._getMaterialTexturePath(n$t,n$f,n$g),n$h.push(n$d),n$i[n$t]=n$d)}if(n$j.emissiveTexture){var n$u=n$j.emissiveTexture.texture2D;n$u&&(n$d=n$G._getMaterialTexturePath(n$u,n$f,n$g),n$h.push(n$d),n$i[n$u]=n$d)}if(n$j.ambientTexture){var n$v=n$j.ambientTexture.texture2D;n$v&&(n$d=n$G._getMaterialTexturePath(n$v,n$f,n$g),n$h.push(n$d),n$i[n$v]=n$d)}if(n$j.reflectTexture){var n$w=n$j.reflectTexture.texture2D;n$w&&(n$d=n$G._getMaterialTexturePath(n$w,n$f,n$g),n$h.push(n$d),n$i[n$w]=n$d)}}var n$x=n$h.length,n$y=n$x+1,n$z=1/n$y;if(n$G._onProcessChange(n$a,0,n$z,1),0<n$x){var n$C=n$D.create(null,n$G._onProcessChange,[n$a,n$z,n$x/n$y],!1);n$G._innerFourthLevelLoaderManager.create(n$h,n$D.create(null,n$G._onMateialTexturesLoaded,[n$a,n$C,n$c,n$i]),n$C,n$Tb,null,1,!0,n$b)}else n$G._onMateialTexturesLoaded(n$a,null,n$c,null)}},n$G._onMateialTexturesLoaded=function(n$a,n$b,n$c,n$d){n$a.endLoad([n$c,n$d]),n$b&&n$b.recover()},n$G._loadTextureCube=function(n$a){n$a.on("loaded",null,n$G._onTextureCubeLtcLoaded,[n$a]),n$a.load(n$a.url,"json",!1,null,!0)},n$G._onTextureCubeLtcLoaded=function(n$a,n$b){if(n$a._class.destroyed)n$a.endLoad();else{var n$c=n$E.getPath(n$a.url),n$d=[n$G.formatRelativePath(n$c,n$b.px),n$G.formatRelativePath(n$c,n$b.nx),n$G.formatRelativePath(n$c,n$b.py),n$G.formatRelativePath(n$c,n$b.ny),n$G.formatRelativePath(n$c,n$b.pz),n$G.formatRelativePath(n$c,n$b.nz)];n$G._onProcessChange(n$a,0,1/7,1);var n$e=n$D.create(null,n$G._onProcessChange,[n$a,1/7,6/7],!1);n$G._innerFourthLevelLoaderManager.load(n$d,n$D.create(null,n$G._onTextureCubeImagesLoaded,[n$a,n$d,n$e]),n$e,"nativeimage")}},n$G._onTextureCubeImagesLoaded=function(n$a,n$b,n$c){var n$d=[];n$d.length=6;for(var n$e=0;n$e<6;n$e++){var n$f=n$b[n$e];n$d[n$e]=n$r.getRes(n$f),n$r.clearRes(n$f)}n$a.endLoad(n$d),n$c.recover()},n$G._onProcessChange=function(n$a,n$b,n$c,n$d){(n$d=n$b+n$d*n$c)<1&&n$a.event("progress",n$d)},n$G.init=function(n$a,n$b,n$c,n$d,n$e,n$f){if(void 0===n$c&&(n$c=!1),void 0===n$d&&(n$d=!1),void 0===n$e&&(n$e=!0),void 0===n$f&&(n$f=!0),n$s.update3DLoop=function(){},n$s.cancelLoadByUrl=function(n$a){n$G._cancelLoadByUrl(n$a)},n$i.isAntialias=n$c,n$i.isAlpha=n$d,n$i.premultipliedAlpha=n$e,n$i.isStencil=n$f,!n$F.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");n$s.changeWebGLSize=n$G._changeWebGLSize,n$p.is3DMode=!0,n$v.init(n$a,n$b),n$I.__init__(),n$lb.__init__(),n$Xb.__init__(),n$Q.__init__(),n$G.__init__(),n$g.maxTextureCount=2,(n$G.debugMode||n$Z.debugMode)&&(n$G._debugPhasorSprite=new n$V)},n$G.HIERARCHY="SPRITE3DHIERARCHY",n$G.MESH="MESH",n$G.MATERIAL="MATERIAL",n$G.PBRMATERIAL="PBRMTL",n$G.TEXTURECUBE="TEXTURECUBE",n$G.TERRAIN="TERRAIN",n$G._readData=null,n$G._debugPhasorSprite=null,n$G.debugMode=!1,n$l(n$G,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new n$b},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new n$b},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new n$b},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new n$b}]),n$G}(),n$sb=function(n$a){function n$e(n$a){n$e.__super.call(this),this._owner=n$a,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}n$n(n$e,"laya.d3.animation.AnimationTransform3D",n$f);var n$b=n$e.prototype;return n$b._getlocalMatrix=function(){return this._localUpdate&&(n$qb._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},n$b._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var n$a=0,n$b=this._childs.length;n$a<n$b;n$a++)this._childs[n$a]._onWorldTransform()}},n$b._setWorldMatrixAndUpdate=function(n$a){if(this._worldMatrix=n$a,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var n$b=this._getlocalMatrix(),n$c=0;n$c<16;++n$c)this._worldMatrix[n$c]=n$b[n$c];else n$qb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},n$b._setWorldMatrixNoUpdate=function(n$a){this._worldMatrix=n$a},n$b._setWorldMatrixIgnoreUpdate=function(n$a){this._worldMatrix=n$a,this._worldUpdate=!1},n$b.getLocalPosition=function(){return this._localPosition},n$b.setLocalPosition=function(n$a){if(this._parent)this._localPosition=n$a,this._localUpdate=!0,this._onWorldTransform();else{var n$b=this._entity.owner._transform,n$c=this._entity.localPosition,n$d=n$c.elements;n$d[0]=n$a[0],n$d[1]=n$a[1],n$d[2]=n$a[2],n$b.localPosition=n$c}},n$b.getLocalRotation=function(){if(this._localQuaternionUpdate){var n$a=this._localRotationEuler;n$qb._quaternionCreateFromYawPitchRollArray(n$a[1]/n$e._angleToRandin,n$a[0]/n$e._angleToRandin,n$a[2]/n$e._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},n$b.setLocalRotation=function(n$a){if(this._parent)this._localRotation=n$a,n$qb.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var n$b=this._entity.owner._transform,n$c=this._entity.localRotation,n$d=n$c.elements;n$d[0]=n$a[0],n$d[1]=n$a[1],n$d[2]=n$a[2],n$d[3]=n$a[3],n$b.localRotation=n$c}},n$b.getLocalScale=function(){return this._localScale},n$b.setLocalScale=function(n$a){if(this._parent)this._localScale=n$a,this._localUpdate=!0,this._onWorldTransform();else{var n$b=this._entity.owner._transform,n$c=this._entity.localScale,n$d=n$c.elements;n$d[0]=n$a[0],n$d[1]=n$a[1],n$d[2]=n$a[2],n$b.localScale=n$c}},n$b.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){n$qb.getYawPitchRoll(this._localRotation,n$e._tempVector3);var n$a=n$e._tempVector3,n$b=this._localRotationEuler;n$b[0]=n$a[1]*n$e._angleToRandin,n$b[1]=n$a[0]*n$e._angleToRandin,n$b[2]=n$a[2]*n$e._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},n$b.setLocalRotationEuler=function(n$a){if(this._parent)n$qb._quaternionCreateFromYawPitchRollArray(n$a[1]/n$e._angleToRandin,n$a[0]/n$e._angleToRandin,n$a[2]/n$e._angleToRandin,this._localRotation),this._localRotationEuler=n$a,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var n$b=this._entity.owner._transform,n$c=this._entity.localRotationEuler,n$d=n$c.elements;n$d[0]=n$a[0],n$d[1]=n$a[1],n$d[2]=n$a[2],n$b.localRotationEuler=n$c}},n$b.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)n$qb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var n$a=this._getlocalMatrix(),n$b=0;n$b<16;++n$b)this._worldMatrix[n$b]=n$a[n$b];this._worldUpdate=!1}return this._worldMatrix},n$b.setParent=function(n$a){if(this._parent!==n$a){if(this._parent){var n$b=this._parent._childs,n$c=n$b.indexOf(this);n$b.splice(n$c,1)}n$a&&(n$a._childs.push(this),n$a&&this._onWorldTransform()),this._parent=n$a}},n$l(n$e,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),n$e}(),n$tb=function(n$a){function n$b(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,n$b.__super.call(this),this._destroyed=!1,this._id=n$b._uniqueIDCounter,n$b._uniqueIDCounter++}n$n(n$b,"laya.d3.component.Component3D",n$f);var n$c=n$b.prototype;return n$v.imps(n$c,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),n$c._initialize=function(n$a){this._owner=n$a,this._enable=!0,this.started=!1,this._load(n$a)},n$c._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},n$c._load=function(n$a){},n$c._start=function(n$a){},n$c._update=function(n$a){},n$c._lateUpdate=function(n$a){},n$c._preRenderUpdate=function(n$a){},n$c._postRenderUpdate=function(n$a){},n$c._unload=function(n$a){this.offAll()},n$c._cloneTo=function(n$a){},n$o(0,n$c,"id",function(){return this._id}),n$o(0,n$c,"destroyed",function(){return this._destroyed}),n$o(0,n$c,"owner",function(){return this._owner}),n$o(0,n$c,"enable",function(){return this._enable},function(n$a){this._enable!==n$a&&(this._enable=n$a,this.event("enablechanged",this._enable))}),n$o(0,n$c,"isSingleton",function(){return n$b._isSingleton}),n$b._isSingleton=!0,n$b._uniqueIDCounter=1,n$b}(),n$ub=function(n$a){function n$b(){this._destroyed=!1,n$b.__super.call(this),this._destroyed=!1}n$n(n$b,"laya.d3.core.GeometryFilter",n$f);var n$c=n$b.prototype;return n$v.imps(n$c,{"laya.resource.IDestroy":!0}),n$c._destroy=function(){this.offAll(),this._destroyed=!0},n$o(0,n$c,"_isAsyncLoaded",function(){return!0}),n$o(0,n$c,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),n$o(0,n$c,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),n$o(0,n$c,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),n$o(0,n$c,"destroyed",function(){return this._destroyed}),n$b}(),n$vb=function(n$a){function n$d(n$a){n$d.__super.call(this),this._id=++n$d._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new n$Za(new n$gb,new n$gb),this._boundingBoxCenter=new n$gb,this._boundingSphere=new n$_a(new n$gb,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=n$a,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}n$n(n$d,"laya.d3.core.render.BaseRender",n$f);var n$b=n$d.prototype;return n$v.imps(n$b,{"laya.resource.IDestroy":!0}),n$b._changeMaterialReference=function(n$a,n$b){n$a&&n$a._removeReference(),n$b._addReference()},n$b._getInstanceMaterial=function(n$a,n$b){var n$c=new n$a.constructor;return n$a.cloneTo(n$c),n$c.name=n$c.name+"(Instance)",this._materialsInstance[n$b]=!0,this._changeMaterialReference(this._materials[n$b],n$c),this._materials[n$b]=n$c},n$b._setShaderValuelightMap=function(n$a){this._setShaderValueTexture(3,n$a)},n$b._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},n$b._renderRenderableBoundBox=function(){var n$a=n$rb._debugPhasorSprite,n$b=this.boundingBox,n$c=n$d._tempBoundBoxCorners;n$b.getCorners(n$c),n$a.line(n$c[0],n$d._greenColor,n$c[1],n$d._greenColor),n$a.line(n$c[2],n$d._greenColor,n$c[3],n$d._greenColor),n$a.line(n$c[4],n$d._greenColor,n$c[5],n$d._greenColor),n$a.line(n$c[6],n$d._greenColor,n$c[7],n$d._greenColor),n$a.line(n$c[0],n$d._greenColor,n$c[3],n$d._greenColor),n$a.line(n$c[1],n$d._greenColor,n$c[2],n$d._greenColor),n$a.line(n$c[2],n$d._greenColor,n$c[6],n$d._greenColor),n$a.line(n$c[3],n$d._greenColor,n$c[7],n$d._greenColor),n$a.line(n$c[0],n$d._greenColor,n$c[4],n$d._greenColor),n$a.line(n$c[1],n$d._greenColor,n$c[5],n$d._greenColor),n$a.line(n$c[4],n$d._greenColor,n$c[7],n$d._greenColor),n$a.line(n$c[5],n$d._greenColor,n$c[6],n$d._greenColor)},n$b._calculateBoundingSphere=function(){throw"BaseRender: must override it."},n$b._calculateBoundingBox=function(){throw"BaseRender: must override it."},n$b._setShaderValueTexture=function(n$a,n$b){this._owner._shaderValues.setValue(n$a,n$b)},n$b._setShaderValueMatrix4x4=function(n$a,n$b){this._owner._shaderValues.setValue(n$a,n$b?n$b.elements:null)},n$b._setShaderValueColor=function(n$a,n$b){this._owner._shaderValues.setValue(n$a,n$b?n$b.elements:null)},n$b._setShaderValueBuffer=function(n$a,n$b){this._owner._shaderValues.setValue(n$a,n$b)},n$b._setShaderValueInt=function(n$a,n$b){this._owner._shaderValues.setValue(n$a,n$b)},n$b._setShaderValueBool=function(n$a,n$b){this._owner._shaderValues.setValue(n$a,n$b)},n$b._setShaderValueNumber=function(n$a,n$b){this._owner._shaderValues.setValue(n$a,n$b)},n$b._setShaderValueVector2=function(n$a,n$b){this._owner._shaderValues.setValue(n$a,n$b?n$b.elements:null)},n$b._addShaderDefine=function(n$a){this._owner._shaderDefineValue|=n$a},n$b._removeShaderDefine=function(n$a){this._owner._shaderDefineValue&=~n$a},n$b._renderUpdate=function(n$a){return!0},n$b._applyLightMapParams=function(){if(0<=this._lightmapIndex){var n$a=this._owner.scene;if(n$a){var n$b=n$a.getlightmaps()[this._lightmapIndex];n$b?(this._addShaderDefine(n$Vb.SAHDERDEFINE_LIGHTMAP),n$b.loaded?this._setShaderValuelightMap(n$b):n$b.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(n$Vb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(n$Vb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(n$Vb.SAHDERDEFINE_LIGHTMAP)},n$b._updateOctreeNode=function(){var n$a=this._treeNode;n$a&&this._octreeNodeNeedChange&&(n$a.updateObject(this),this._octreeNodeNeedChange=!1)},n$b._destroy=function(){this.offAll();var n$a=0,n$b=0;for(n$a=0,n$b=this._renderElements.length;n$a<n$b;n$a++)this._renderElements[n$a]._destroy();for(n$a=0,n$b=this._materials.length;n$a<n$b;n$a++)this._materials[n$a]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},n$o(0,n$b,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),n$o(0,n$b,"id",function(){return this._id}),n$o(0,n$b,"material",function(){var n$a=this._materials[0];if(n$a&&!this._materialsInstance[0]){var n$b=this._getInstanceMaterial(n$a,0);this.event("materialchanged",[this,0,n$b])}return this._materials[0]},function(n$a){this.sharedMaterial=n$a}),n$o(0,n$b,"sharedMaterial",function(){return this._materials[0]},function(n$a){var n$b=this._materials[0];n$b!==n$a&&(this._materials[0]=n$a,this._materialsInstance[0]=!1,this._changeMaterialReference(n$b,n$a),this.event("materialchanged",[this,0,n$a]))}),n$o(0,n$b,"lightmapIndex",function(){return this._lightmapIndex},function(n$a){this._lightmapIndex=n$a,this._applyLightMapParams()}),n$o(0,n$b,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(n$a){this._lightmapScaleOffset=n$a,this._setShaderValueColor(2,n$a),this._addShaderDefine(n$Vb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),n$o(0,n$b,"enable",function(){return this._enable},function(n$a){this._enable=n$a,this.event("enablechanged",[this,n$a])}),n$o(0,n$b,"materials",function(){for(var n$a=0,n$b=this._materials.length;n$a<n$b;n$a++)if(!this._materialsInstance[n$a]){var n$c=this._getInstanceMaterial(this._materials[n$a],n$a);this.event("materialchanged",[this,n$a,n$c])}return this._materials.slice()},function(n$a){this.sharedMaterials=n$a}),n$o(0,n$b,"sharedMaterials",function(){return this._materials.slice()},function(n$a){if(!n$a)throw new Error("MeshRender: shadredMaterials value can't be null.");var n$b=n$a.length;this._materialsInstance.length=n$b;for(var n$c=0;n$c<n$b;n$c++){var n$d=this._materials[n$c];n$d!==n$a[n$c]&&(this._materialsInstance[n$c]=!1,this._changeMaterialReference(n$d,n$a[n$c]),this.event("materialchanged",[this,n$c,n$a[n$c]]))}this._materials=n$a}),n$o(0,n$b,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),n$o(0,n$b,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var n$a=this.boundingBox;n$gb.add(n$a.min,n$a.max,this._boundingBoxCenter),n$gb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),n$o(0,n$b,"receiveShadow",function(){return this._receiveShadow},function(n$a){this._receiveShadow!==n$a&&((this._receiveShadow=n$a)?this._addShaderDefine(n$nb.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(n$nb.SHADERDEFINE_RECEIVE_SHADOW))}),n$o(0,n$b,"destroyed",function(){return this._destroyed}),n$d._uniqueIDCounter=0,n$l(n$d,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new n$gb,new n$gb,new n$gb,new n$gb,new n$gb,new n$gb,new n$gb,new n$gb]},"_greenColor",function(){return this._greenColor=new n$hb(0,1,0,1)}]),n$d}(),n$wb=function(n$a){function n$h(n$a){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,n$h.__super.call(this),this._localPosition=new n$gb,this._localRotation=new n$cb(0,0,0,1),this._localScale=new n$gb(1,1,1),this._localRotationEuler=new n$gb,this._localMatrix=new n$ab,this._position=new n$gb,this._rotation=new n$cb(0,0,0,1),this._scale=new n$gb(1,1,1),this._worldMatrix=new n$ab,this._forward=new n$gb,this._up=new n$gb,this._right=new n$gb,this._owner=n$a,this._childs=[]}n$n(n$h,"laya.d3.core.Transform3D",n$f);var n$b=n$h.prototype;return n$b._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)n$ab.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var n$a=n$h._tempVector30;n$gb.multiply(this.pivot,this._localScale,n$a);var n$b=n$h._tempVector31;n$gb.subtract(n$a,this.pivot,n$b);var n$c=n$h._tempVector32,n$d=this.localRotation;n$gb.transformQuat(n$a,n$d,n$c),n$gb.subtract(n$c,n$a,n$c);var n$e=n$h._tempVector33;n$gb.subtract(this._localPosition,n$b,n$e),n$gb.subtract(n$e,n$c,n$e),n$ab.createAffineTransformation(n$e,n$d,this._localScale,this._localMatrix)}},n$b._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var n$a=0,n$b=this._childs.length;n$a<n$b;n$a++)this._childs[n$a]._onWorldPositionRotationTransform()}},n$b._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var n$a=0,n$b=this._childs.length;n$a<n$b;n$a++)this._childs[n$a]._onWorldPositionScaleTransform()}},n$b._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var n$a=0,n$b=this._childs.length;n$a<n$b;n$a++)this._childs[n$a]._onWorldPositionTransform()}},n$b._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var n$a=0,n$b=this._childs.length;n$a<n$b;n$a++)this._childs[n$a]._onWorldPositionRotationTransform()}},n$b._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var n$a=0,n$b=this._childs.length;n$a<n$b;n$a++)this._childs[n$a]._onWorldPositionScaleTransform()}},n$b._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var n$a=0,n$b=this._childs.length;n$a<n$b;n$a++)this._childs[n$a]._onWorldTransform()}},n$b.translate=function(n$a,n$b){void 0===n$b&&(n$b=!0),n$b?(n$ab.createFromQuaternion(this.localRotation,n$h._tempMatrix0),n$gb.transformCoordinate(n$a,n$h._tempMatrix0,n$h._tempVector30),n$gb.add(this.localPosition,n$h._tempVector30,this._localPosition),this.localPosition=this._localPosition):(n$gb.add(this.position,n$a,this._position),this.position=this._position)},n$b.rotate=function(n$a,n$b,n$c){var n$d;void 0===n$b&&(n$b=!0),void 0===n$c&&(n$c=!0),n$d=n$c?n$a:(n$gb.scale(n$a,Math.PI/180,n$h._tempVector30),n$h._tempVector30),n$cb.createFromYawPitchRoll(n$d.y,n$d.x,n$d.z,n$h._tempQuaternion0),n$b?(n$cb.multiply(this._localRotation,n$h._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(n$cb.multiply(n$h._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},n$b.lookAt=function(n$a,n$b,n$c){void 0===n$c&&(n$c=!1);var n$d,n$e=n$a.elements;if(n$c){if(n$d=this._localPosition.elements,Math.abs(n$d[0]-n$e[0])<n$Aa.zeroTolerance&&Math.abs(n$d[1]-n$e[1])<n$Aa.zeroTolerance&&Math.abs(n$d[2]-n$e[2])<n$Aa.zeroTolerance)return;n$cb.lookAt(this._localPosition,n$a,n$b,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var n$f=this.position;if(n$d=n$f.elements,Math.abs(n$d[0]-n$e[0])<n$Aa.zeroTolerance&&Math.abs(n$d[1]-n$e[1])<n$Aa.zeroTolerance&&Math.abs(n$d[2]-n$e[2])<n$Aa.zeroTolerance)return;n$cb.lookAt(n$f,n$a,n$b,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},n$o(0,n$b,"_isFrontFaceInvert",function(){var n$a=this.scale,n$b=n$a.x<0;return n$a.y<0&&(n$b=!n$b),n$a.z<0&&(n$b=!n$b),n$b}),n$o(0,n$b,"owner",function(){return this._owner}),n$o(0,n$b,"localRotation",function(){if(this._localQuaternionUpdate){var n$a=this._localRotationEuler.elements;n$cb.createFromYawPitchRoll(n$a[1]/n$h._angleToRandin,n$a[0]/n$h._angleToRandin,n$a[2]/n$h._angleToRandin,this._localRotation)}return this._localRotation},function(n$a){this._localRotation=n$a,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),n$o(0,n$b,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?n$ab.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(n$a){null===this._parent?n$a.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),n$ab.multiply(this._localMatrix,n$a,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=n$a,this._worldUpdate=!1}),n$o(0,n$b,"worldNeedUpdate",function(){return this._worldUpdate}),n$o(0,n$b,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(n$a){this._localMatrix=n$a,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),n$o(0,n$b,"dummy",function(){return this._dummy},function(n$a){this._dummy!==n$a&&(this._dummy&&(this._dummy._entity=null),n$a&&(n$a._entity=this),this._dummy=n$a)}),n$o(0,n$b,"localPosition",function(){return this._localPosition},function(n$a){this._localPosition=n$a,this._localUpdate=!0,this._onWorldPositionTransform()}),n$o(0,n$b,"position",function(){if(this._positionUpdate){if(null!=this._parent){var n$a=this._parent.position;n$gb.multiply(this._localPosition,this._parent.scale,n$h._tempVector30),n$gb.transformQuat(n$h._tempVector30,this._parent.rotation,n$h._tempVector30),n$gb.add(n$a,n$h._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(n$a){if(null!=this._parent){n$gb.subtract(n$a,this._parent.position,this._localPosition);var n$b=this._parent.scale.elements,n$c=n$b[0],n$d=n$b[1],n$e=n$b[2];if(1!==n$c||1!==n$d||1!==n$e){var n$f=n$h._tempVector30,n$g=n$f.elements;n$g[0]=1/n$c,n$g[1]=1/n$d,n$g[2]=1/n$e,n$gb.multiply(this._localPosition,n$f,this._localPosition)}this._parent.rotation.invert(n$h._tempQuaternion0),n$gb.transformQuat(this._localPosition,n$h._tempQuaternion0,this._localPosition)}else n$a.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=n$a,this._positionUpdate=!1}),n$o(0,n$b,"localScale",function(){return this._localScale},function(n$a){this._localScale=n$a,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),n$o(0,n$b,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(n$h._tempVector30);var n$a=n$h._tempVector30.elements,n$b=this._localRotationEuler.elements;n$b[0]=n$a[1]*n$h._angleToRandin,n$b[1]=n$a[0]*n$h._angleToRandin,n$b[2]=n$a[2]*n$h._angleToRandin}return this._localRotationEuler},function(n$a){this._localRotationEuler=n$a,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),n$o(0,n$b,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?n$cb.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(n$a){null!=this._parent?(this._parent.rotation.invert(n$h._tempQuaternion0),n$cb.multiply(n$a,n$h._tempQuaternion0,this._localRotation)):n$a.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=n$a,this._rotationUpdate=!1}),n$o(0,n$b,"scale",function(){return this._scaleUpdate&&(null!==this._parent?n$gb.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(n$a){if(null!==this._parent){var n$b=this._parent.scale.elements,n$c=n$h._tempVector30.elements;n$c[0]=1/n$b[0],n$c[1]=1/n$b[1],n$c[2]=1/n$b[2],n$gb.multiply(n$a,n$h._tempVector30,this._localScale)}else n$a.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=n$a,this._scaleUpdate=!1}),n$o(0,n$b,"rotationEuler",null,function(n$a){n$cb.createFromYawPitchRoll(n$a.y,n$a.x,n$a.z,this._rotation),this.rotation=this._rotation}),n$o(0,n$b,"forward",function(){var n$a=this.worldMatrix.elements;return this._forward.elements[0]=-n$a[8],this._forward.elements[1]=-n$a[9],this._forward.elements[2]=-n$a[10],this._forward}),n$o(0,n$b,"up",function(){var n$a=this.worldMatrix.elements;return this._up.elements[0]=n$a[4],this._up.elements[1]=n$a[5],this._up.elements[2]=n$a[6],this._up}),n$o(0,n$b,"right",function(){var n$a=this.worldMatrix.elements;return this._right.elements[0]=n$a[0],this._right.elements[1]=n$a[1],this._right.elements[2]=n$a[2],this._right}),n$o(0,n$b,"parent",function(){return this._parent},function(n$a){if(this._parent!==n$a){if(this._parent){var n$b=this._parent._childs,n$c=n$b.indexOf(this);n$b.splice(n$c,1)}n$a&&(n$a._childs.push(this),n$a&&this._onWorldTransform()),this._parent=n$a}}),n$l(n$h,["_tempVector30",function(){return this._tempVector30=new n$gb},"_tempVector31",function(){return this._tempVector31=new n$gb},"_tempVector32",function(){return this._tempVector32=new n$gb},"_tempVector33",function(){return this._tempVector33=new n$gb},"_tempQuaternion0",function(){return this._tempQuaternion0=new n$cb},"_tempMatrix0",function(){return this._tempMatrix0=new n$ab},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),n$h}(),n$xb=(function(n$a){function n$b(){this._rotation=0,this._matNeedUpdte=!1,n$b.__super.call(this),this._matrix=new n$ab,this._offset=new n$fb,this._tiling=new n$fb(1,1)}n$n(n$b,"laya.d3.core.TransformUV",n$f);var n$c=n$b.prototype;n$v.imps(n$c,{"laya.d3.core.IClone":!0}),n$c._updateMatrix=function(){n$b._tempOffsetV3.elements[0]=this._offset.x,n$b._tempOffsetV3.elements[1]=this._offset.y,n$cb.createFromYawPitchRoll(0,0,this._rotation,n$b._tempRotationQua),n$b._tempTitlingV3.elements[0]=this._tiling.x,n$b._tempTitlingV3.elements[1]=this._tiling.y,n$ab.createAffineTransformation(n$b._tempOffsetV3,n$b._tempRotationQua,n$b._tempTitlingV3,this._matrix)},n$c.cloneTo=function(n$a){n$a._matrix=this._matrix.clone(),n$a._offset=this._offset.clone(),n$a._rotation=this._rotation,n$a._tiling=this._tiling.clone()},n$c.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$c,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),n$o(0,n$c,"tiling",function(){return this._tiling},function(n$a){this._tiling=n$a,this._matNeedUpdte=!0}),n$o(0,n$c,"offset",function(){return this._offset},function(n$a){this._offset=n$a,this._matNeedUpdte=!0}),n$o(0,n$c,"rotation",function(){return this._rotation},function(n$a){this._rotation=n$a,this._matNeedUpdte=!0}),n$l(n$b,["_tempOffsetV3",function(){return this._tempOffsetV3=new n$gb(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new n$cb},"_tempTitlingV3",function(){return this._tempTitlingV3=new n$gb(1,1,1)}])}(),function(n$c){function n$a(){this.x=NaN,this.y=NaN,this.z=NaN,n$a.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}n$n(n$a,"laya.d3.core.particleShuriKen.module.shape.BoxShape",n$c);var n$b=n$a.prototype;n$b._getShapeBoundBox=function(n$a){var n$b=n$a.min.elements;n$b[0]=.5*-this.x,n$b[1]=.5*-this.y,n$b[2]=.5*-this.z;var n$c=n$a.max.elements;n$c[0]=.5*this.x,n$c[1]=.5*this.y,n$c[2]=.5*this.z},n$b._getSpeedBoundBox=function(n$a){var n$b=n$a.min.elements;n$b[0]=0,n$b[1]=0,n$b[2]=0;var n$c=n$a.max.elements;n$c[0]=0,n$c[1]=1,n$c[2]=0},n$b.generatePositionAndDirection=function(n$a,n$b,n$c,n$d){var n$e=n$a.elements,n$f=n$b.elements;n$c?(n$c.seed=n$d[16],n$T._randomPointInsideHalfUnitBox(n$a,n$c),n$d[16]=n$c.seed):n$T._randomPointInsideHalfUnitBox(n$a),n$e[0]=this.x*n$e[0],n$e[1]=this.y*n$e[1],n$e[2]=this.z*n$e[2],this.randomDirection?n$c?(n$c.seed=n$d[17],n$T._randomPointUnitSphere(n$b,n$c),n$d[17]=n$c.seed):n$T._randomPointUnitSphere(n$b):(n$f[0]=0,n$f[1]=0,n$f[2]=1)},n$b.cloneTo=function(n$a){n$c.prototype.cloneTo.call(this,n$a);var n$b=n$a;n$b.x=this.x,n$b.y=this.y,n$b.z=this.z,n$b.randomDirection=this.randomDirection}}(n$O),function(n$c){function n$g(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,n$g.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}n$n(n$g,"laya.d3.core.particleShuriKen.module.shape.CircleShape",n$c);var n$a=n$g.prototype;n$a._getShapeBoundBox=function(n$a){var n$b=n$a.min.elements;n$b[0]=n$b[2]=-this.radius,n$b[1]=0;var n$c=n$a.max.elements;n$c[0]=n$c[2]=this.radius,n$c[1]=0},n$a._getSpeedBoundBox=function(n$a){var n$b=n$a.min.elements;n$b[0]=n$b[1]=-1,n$b[2]=0;var n$c=n$a.max.elements;n$c[0]=n$c[1]=1,n$c[2]=0},n$a.generatePositionAndDirection=function(n$a,n$b,n$c,n$d){var n$e=n$a.elements,n$f=n$g._tempPositionPoint.elements;n$c?(n$c.seed=n$d[16],this.emitFromEdge?n$T._randomPointUnitArcCircle(this.arc,n$g._tempPositionPoint,n$c):n$T._randomPointInsideUnitArcCircle(this.arc,n$g._tempPositionPoint,n$c),n$d[16]=n$c.seed):this.emitFromEdge?n$T._randomPointUnitArcCircle(this.arc,n$g._tempPositionPoint):n$T._randomPointInsideUnitArcCircle(this.arc,n$g._tempPositionPoint),n$e[0]=-n$f[0],n$e[1]=n$f[1],n$e[2]=0,n$gb.scale(n$a,this.radius,n$a),this.randomDirection?n$c?(n$c.seed=n$d[17],n$T._randomPointUnitSphere(n$b,n$c),n$d[17]=n$c.seed):n$T._randomPointUnitSphere(n$b):n$a.cloneTo(n$b)},n$a.cloneTo=function(n$a){n$c.prototype.cloneTo.call(this,n$a);var n$b=n$a;n$b.radius=this.radius,n$b.arc=this.arc,n$b.emitFromEdge=this.emitFromEdge,n$b.randomDirection=this.randomDirection},n$l(n$g,["_tempPositionPoint",function(){return this._tempPositionPoint=new n$fb}])}(n$O),function(n$c){function n$m(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,n$m.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}n$n(n$m,"laya.d3.core.particleShuriKen.module.shape.ConeShape",n$c);var n$a=n$m.prototype;n$a._getShapeBoundBox=function(n$a){var n$b=this.radius+this.length*Math.sin(this.angle),n$c=this.length*Math.cos(this.angle),n$d=n$a.min.elements;n$d[0]=n$d[1]=-n$b,n$d[2]=0;var n$e=n$a.max.elements;n$e[0]=n$e[1]=n$b,n$e[2]=n$c},n$a._getSpeedBoundBox=function(n$a){var n$b=Math.sin(this.angle),n$c=n$a.min.elements;n$c[0]=n$c[1]=-n$b,n$c[2]=0;var n$d=n$a.max.elements;n$d[0]=n$c[1]=n$b,n$d[2]=1},n$a.generatePositionAndDirection=function(n$a,n$b,n$c,n$d){var n$e,n$f=n$a.elements,n$g=n$b.elements,n$h=n$m._tempPositionPoint.elements,n$i=NaN,n$j=NaN,n$k=Math.cos(this.angle),n$l=Math.sin(this.angle);switch(this.emitType){case 0:n$c?(n$c.seed=n$d[16],n$T._randomPointInsideUnitCircle(n$m._tempPositionPoint,n$c),n$d[16]=n$c.seed):n$T._randomPointInsideUnitCircle(n$m._tempPositionPoint),n$i=n$h[0],n$j=n$h[1],n$f[0]=n$i*this.radius,n$f[1]=n$j*this.radius,n$f[2]=0,this.randomDirection?(n$c?(n$c.seed=n$d[17],n$T._randomPointInsideUnitCircle(n$m._tempDirectionPoint,n$c),n$d[17]=n$c.seed):n$T._randomPointInsideUnitCircle(n$m._tempDirectionPoint),n$e=n$m._tempDirectionPoint.elements,n$g[0]=n$e[0]*n$l,n$g[1]=n$e[1]*n$l):(n$g[0]=n$i*n$l,n$g[1]=n$j*n$l),n$g[2]=n$k;break;case 1:n$c?(n$c.seed=n$d[16],n$T._randomPointUnitCircle(n$m._tempPositionPoint,n$c),n$d[16]=n$c.seed):n$T._randomPointUnitCircle(n$m._tempPositionPoint),n$i=n$h[0],n$j=n$h[1],n$f[0]=n$i*this.radius,n$f[1]=n$j*this.radius,n$f[2]=0,this.randomDirection?(n$c?(n$c.seed=n$d[17],n$T._randomPointInsideUnitCircle(n$m._tempDirectionPoint,n$c),n$d[17]=n$c.seed):n$T._randomPointInsideUnitCircle(n$m._tempDirectionPoint),n$e=n$m._tempDirectionPoint.elements,n$g[0]=n$e[0]*n$l,n$g[1]=n$e[1]*n$l):(n$g[0]=n$i*n$l,n$g[1]=n$j*n$l),n$g[2]=n$k;break;case 2:n$c?(n$c.seed=n$d[16],n$T._randomPointInsideUnitCircle(n$m._tempPositionPoint,n$c)):n$T._randomPointInsideUnitCircle(n$m._tempPositionPoint),n$i=n$h[0],n$j=n$h[1],n$f[0]=n$i*this.radius,n$f[1]=n$j*this.radius,n$g[n$f[2]=0]=n$i*n$l,n$g[1]=n$j*n$l,n$g[2]=n$k,n$gb.normalize(n$b,n$b),n$c?(n$gb.scale(n$b,this.length*n$c.getFloat(),n$b),n$d[16]=n$c.seed):n$gb.scale(n$b,this.length*Math.random(),n$b),n$gb.add(n$a,n$b,n$a),this.randomDirection&&(n$c?(n$c.seed=n$d[17],n$T._randomPointUnitSphere(n$b,n$c),n$d[17]=n$c.seed):n$T._randomPointUnitSphere(n$b));break;case 3:n$c?(n$c.seed=n$d[16],n$T._randomPointUnitCircle(n$m._tempPositionPoint,n$c)):n$T._randomPointUnitCircle(n$m._tempPositionPoint),n$i=n$h[0],n$j=n$h[1],n$f[0]=n$i*this.radius,n$f[1]=n$j*this.radius,n$g[n$f[2]=0]=n$i*n$l,n$g[1]=n$j*n$l,n$g[2]=n$k,n$gb.normalize(n$b,n$b),n$c?(n$gb.scale(n$b,this.length*n$c.getFloat(),n$b),n$d[16]=n$c.seed):n$gb.scale(n$b,this.length*Math.random(),n$b),n$gb.add(n$a,n$b,n$a),this.randomDirection&&(n$c?(n$c.seed=n$d[17],n$T._randomPointUnitSphere(n$b,n$c),n$d[17]=n$c.seed):n$T._randomPointUnitSphere(n$b));break;default:throw new Error("ConeShape:emitType is invalid.")}},n$a.cloneTo=function(n$a){n$c.prototype.cloneTo.call(this,n$a);var n$b=n$a;n$b.angle=this.angle,n$b.radius=this.radius,n$b.length=this.length,n$b.emitType=this.emitType,n$b.randomDirection=this.randomDirection},n$l(n$m,["_tempPositionPoint",function(){return this._tempPositionPoint=new n$fb},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new n$fb}])}(n$O),function(n$c){function n$a(){this.radius=NaN,this.emitFromShell=!1,n$a.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}n$n(n$a,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",n$c);var n$b=n$a.prototype;n$b._getShapeBoundBox=function(n$a){var n$b=n$a.min.elements;n$b[0]=n$b[1]=n$b[2]=-this.radius;var n$c=n$a.max.elements;n$c[0]=n$c[1]=this.radius,n$c[2]=0},n$b._getSpeedBoundBox=function(n$a){var n$b=n$a.min.elements;n$b[0]=n$b[1]=-1,n$b[2]=0;var n$c=n$a.max.elements;n$c[0]=n$c[1]=n$c[2]=1},n$b.generatePositionAndDirection=function(n$a,n$b,n$c,n$d){var n$e=n$a.elements;n$c?(n$c.seed=n$d[16],this.emitFromShell?n$T._randomPointUnitSphere(n$a,n$c):n$T._randomPointInsideUnitSphere(n$a,n$c),n$d[16]=n$c.seed):this.emitFromShell?n$T._randomPointUnitSphere(n$a):n$T._randomPointInsideUnitSphere(n$a),n$gb.scale(n$a,this.radius,n$a);var n$f=n$e[2];n$f<0&&(n$e[2]=-1*n$f),this.randomDirection?n$c?(n$c.seed=n$d[17],n$T._randomPointUnitSphere(n$b,n$c),n$d[17]=n$c.seed):n$T._randomPointUnitSphere(n$b):n$a.cloneTo(n$b)},n$b.cloneTo=function(n$a){n$c.prototype.cloneTo.call(this,n$a);var n$b=n$a;n$b.radius=this.radius,n$b.emitFromShell=this.emitFromShell,n$b.randomDirection=this.randomDirection}}(n$O),function(n$c){function n$a(){this.radius=NaN,this.emitFromShell=!1,n$a.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}n$n(n$a,"laya.d3.core.particleShuriKen.module.shape.SphereShape",n$c);var n$b=n$a.prototype;n$b._getShapeBoundBox=function(n$a){var n$b=n$a.min.elements;n$b[0]=n$b[1]=n$b[2]=-this.radius;var n$c=n$a.max.elements;n$c[0]=n$c[1]=n$c[2]=this.radius},n$b._getSpeedBoundBox=function(n$a){var n$b=n$a.min.elements;n$b[0]=n$b[1]=n$b[2]=-1;var n$c=n$a.max.elements;n$c[0]=n$c[1]=n$c[2]=1},n$b.generatePositionAndDirection=function(n$a,n$b,n$c,n$d){n$c?(n$c.seed=n$d[16],this.emitFromShell?n$T._randomPointUnitSphere(n$a,n$c):n$T._randomPointInsideUnitSphere(n$a,n$c),n$d[16]=n$c.seed):this.emitFromShell?n$T._randomPointUnitSphere(n$a):n$T._randomPointInsideUnitSphere(n$a),n$gb.scale(n$a,this.radius,n$a),this.randomDirection?n$c?(n$c.seed=n$d[17],n$T._randomPointUnitSphere(n$b,n$c),n$d[17]=n$c.seed):n$T._randomPointUnitSphere(n$b):n$a.cloneTo(n$b)},n$b.cloneTo=function(n$a){n$c.prototype.cloneTo.call(this,n$a);var n$b=n$a;n$b.radius=this.radius,n$b.emitFromShell=this.emitFromShell,n$b.randomDirection=this.randomDirection}}(n$O),function(n$a){function n$b(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,n$b.__super.call(this)}return n$n(n$b,"laya.d3.core.render.SubMeshRenderElement",n$W),n$b}()),n$yb=function(n$a){function n$q(n$a,n$b,n$c,n$d,n$e,n$f){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=n$a,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[n$nb.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[n$Vb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[n$Vb.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[n$Eb.SHADERDEFINE_ALPHATEST]="ALPHATEST";n$q.__super.call(this,n$a,n$b,n$c,null,{}),this._attributeMap=n$d;var n$g;for(n$g in n$e){var n$h=n$e[n$g];switch(n$h[1]){case 0:this._renderElementUniformMap[n$g]=n$h[0];break;case 1:this._materialUniformMap[n$g]=n$h[0];break;case 2:this._spriteUniformMap[n$g]=n$h[0];break;case 3:this._cameraUniformMap[n$g]=n$h[0];break;case 4:this._sceneUniformMap[n$g]=n$h[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}n$n(n$q,"laya.d3.shader.ShaderCompile3D",n$t);var n$b=n$q.prototype;return n$b._definesToNameDic=function(n$a,n$b){for(var n$c={},n$d=1,n$e=0;n$e<32&&!(n$a<(n$d=1<<n$e));n$e++)if(n$a&n$d){var n$f=n$b[n$d];n$f&&(n$c[n$f]="")}return n$c},n$b.withCompile=function(n$a,n$b,n$c,n$d){var n$e,n$f,n$g;if(n$f=this.sharders[n$a])if(n$g=n$f[n$b]){if(n$e=n$g[n$c])return n$e}else n$g=n$f[n$b]=[];else n$g=(n$f=this.sharders[n$a]=[])[n$b]=[];var n$h,n$i=this._definesToNameDic(n$a,n$q._globalInt2name),n$j=this._definesToNameDic(n$b,this._spriteInt2name),n$k=this._definesToNameDic(n$c,this._materialInt2name),n$l={},n$m="";if(n$i)for(n$h in n$i)n$m+="#define "+n$h+"\n",n$l[n$h]=!0;if(n$j)for(n$h in n$j)n$m+="#define "+n$h+"\n",n$l[n$h]=!0;if(n$k)for(n$h in n$k)n$m+="#define "+n$h+"\n",n$l[n$h]=!0;var n$n=n$Lb.nameKey.getName(this._name)+" compile ("+n$a+","+n$b+","+n$c+")",n$o=this._VS.toscript(n$l,[]),n$p=this._PS.toscript(n$l,[]);n$H.now();if(n$e=n$Lb.create(n$m+n$o.join("\n"),n$m+n$p.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,n$d,n$n),n$g[n$c]=n$e,laya.d3.shader.ShaderCompile3D.debugMode)n$H.now();return n$e},n$b.precompileShaderWithShaderDefine=function(n$a,n$b,n$c){this.withCompile(n$a,n$b,n$c,!0)},n$b.addMaterialDefines=function(n$a){var n$b=n$a.defines;for(var n$c in n$b){var n$d=n$b[n$c],n$e=parseInt(n$c);this._materialInt2name[n$e]=n$d,this._materialName2Int[n$d]=n$e}},n$b.addSpriteDefines=function(n$a){var n$b=n$a.defines;for(var n$c in n$b){var n$d=n$b[n$c],n$e=parseInt(n$c);this._spriteInt2name[n$e]=n$d,this._spriteName2Int[n$d]=n$e}},n$b.getMaterialDefineByName=function(n$a){return this._materialName2Int[n$a]},n$b.registerMaterialDefine=function(n$a){var n$b=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[n$b]=n$a,this._materialName2Int[n$a]=n$b},n$b.registerSpriteDefine=function(n$a){var n$b=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[n$b]=n$a,this._spriteName2Int[n$a]=n$b},n$q._globalRegDefine=function(n$a,n$b){n$q._globalInt2name[n$b]=n$a},n$q.add=function(n$a,n$b,n$c,n$d,n$e){return laya.d3.shader.ShaderCompile3D._preCompileShader[n$a]=new n$q(n$a,n$b,n$c,n$d,n$e,n$t.includes)},n$q.get=function(n$a){return laya.d3.shader.ShaderCompile3D._preCompileShader[n$Lb.nameKey.getID(n$a)]},n$q._preCompileShader={},n$q._globalInt2name=[],n$q.debugMode=!1,n$q.SHADERDEFINE_HIGHPRECISION=1,n$q.SHADERDEFINE_FOG=4,n$q.SHADERDEFINE_DIRECTIONLIGHT=8,n$q.SHADERDEFINE_POINTLIGHT=16,n$q.SHADERDEFINE_SPOTLIGHT=32,n$q.SHADERDEFINE_UV0=64,n$q.SHADERDEFINE_COLOR=128,n$q.SHADERDEFINE_UV1=256,n$q.SAHDERDEFINE_DEPTHFOG=131072,n$q}(),n$zb=function(n$a){function n$o(){n$o.__super.call(this)}n$n(n$o,"laya.d3.graphics.MeshSprite3DStaticBatchManager",n$da);var n$b=n$o.prototype;return n$b._getStaticBatch=function(n$a,n$b,n$c,n$d){var n$e,n$f;return n$f=n$a?n$a.id.toString()+n$c.id.toString()+n$b.id.toString()+n$d.toString():n$c.id.toString()+n$b.id.toString()+n$d.toString(),this._staticBatches[n$f]?n$e=this._staticBatches[n$f]:this._staticBatches[n$f]=n$e=new n$Cb(n$f,this,n$a,n$b,n$c),n$e},n$b._initStaticBatchs=function(n$a){var n$b,n$c;this._initBatchRenderElements.sort(n$o._sortPrepareStaticBatch);for(var n$d,n$e=!1,n$f=0,n$g=0,n$h=this._initBatchRenderElements.length;n$g<n$h;n$g++){var n$i,n$j=this._initBatchRenderElements[n$g],n$k=n$j.renderObj._getVertexBuffer(0);n$j._sprite3D;if(n$c===n$k.vertexDeclaration&&n$b===n$j._material)if(n$e)n$d._addCombineBatchRenderObjTest(n$j)?(n$i=n$j._staticBatch)!==n$d&&(n$i&&n$i._deleteCombineBatchRenderObj(n$j),n$d._addCombineBatchRenderObj(n$j)):(n$e=!1,n$f++);else{var n$l=this._initBatchRenderElements[n$g-1],n$m=n$l.renderObj,n$n=n$j.renderObj;n$e=!(65535<n$m._getVertexBuffer().vertexCount+n$n._getVertexBuffer().vertexCount)&&(n$d=this._getStaticBatch(n$a,n$c,n$b,n$f),(n$i=n$l._staticBatch)!==n$d&&(n$i&&n$i._deleteCombineBatchRenderObj(n$l),n$d._addCombineBatchRenderObj(n$l)),(n$i=n$j._staticBatch)!==n$d&&(n$i&&n$i._deleteCombineBatchRenderObj(n$j),n$d._addCombineBatchRenderObj(n$j)),!0)}else n$e=!1,n$f=0;n$b=n$j._material,n$c=n$k.vertexDeclaration}},n$o._sortPrepareStaticBatch=function(n$a,n$b){var n$c=n$a._render,n$d=n$b._render,n$e=n$c.lightmapIndex-n$d.lightmapIndex;if(0!=n$e)return n$e;var n$f=n$c.receiveShadow-n$d.receiveShadow;if(0!=n$f)return n$f;var n$g=n$a._mainSortID-n$b._mainSortID;return 0==n$g?n$a.renderObj.triangleCount-n$b.renderObj.triangleCount:n$g},n$o}(),n$Cb=function(n$a){function n$f(n$a,n$b,n$c,n$d,n$e){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,n$f.__super.call(this,n$a,n$b,n$c),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=n$d,this._material=n$e}n$n(n$f,"laya.d3.graphics.SubMeshStaticBatch",n$ea);var n$b=n$f.prototype;return n$b._compareBatchRenderElement=function(n$a,n$b){return n$a._batchIndexStart>n$b._batchIndexStart},n$b._addCombineBatchRenderObjTest=function(n$a){var n$b=n$a.renderObj._vertexCount;return!(65535<(0<n$b?this._currentCombineVertexCount+n$b:this._currentCombineVertexCount+n$a.renderObj._getVertexBuffer().vertexCount))},n$b._addCombineBatchRenderObj=function(n$a){var n$b=n$a.renderObj,n$c=n$b._vertexCount;this._initBatchRenderElements.push(n$a),n$a._staticBatch=this,0<n$c?(this._currentCombineIndexCount+=n$b._indexCount,this._currentCombineVertexCount+=n$c):(this._currentCombineIndexCount=this._currentCombineIndexCount+n$b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+n$b._getVertexBuffer().vertexCount),this._needFinishCombine=!0},n$b._deleteCombineBatchRenderObj=function(n$a){var n$b=n$a.renderObj,n$c=this._initBatchRenderElements.indexOf(n$a);if(-1!==n$c){this._initBatchRenderElements.splice(n$c,1),n$a._staticBatch=null;var n$d=n$b._vertexCount;0<n$d?(this._currentCombineIndexCount=this._currentCombineIndexCount-n$b._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-n$d):(this._currentCombineIndexCount=this._currentCombineIndexCount-n$b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-n$b._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},n$b._finishInit=function(){if(this._needFinishCombine){var n$a=0,n$b=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var n$c=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),n$d=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=n$Ob.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=n$Nb.create("ushort",this._currentCombineIndexCount,35044);for(var n$e=0,n$f=this._initBatchRenderElements.length;n$e<n$f;n$e++){var n$g=this._initBatchRenderElements[n$e],n$h=n$g.renderObj,n$i=n$h._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,n$g._sprite3D),n$j=n$h.getIndices(),n$k=n$g._sprite3D.transform._isFrontFaceInvert,n$l=n$a/(this._vertexDeclaration.vertexStride/4)-n$h._vertexStart,n$m=n$b,n$n=n$m+n$j.length;n$g._batchIndexStart=n$m,n$g._batchIndexEnd=n$n,n$d.set(n$j,n$b);var n$o=0;if(n$k)for(n$o=n$m;n$o<n$n;n$o+=3){n$d[n$o]=n$l+n$d[n$o];var n$p=n$d[n$o+1],n$q=n$d[n$o+2];n$d[n$o+1]=n$l+n$q,n$d[n$o+2]=n$l+n$p}else for(n$o=n$m;n$o<n$n;n$o+=3)n$d[n$o]=n$l+n$d[n$o],n$d[n$o+1]=n$l+n$d[n$o+1],n$d[n$o+2]=n$l+n$d[n$o+2];n$b+=n$j.length,n$c.set(n$i,n$a),n$a+=n$i.length}this._vertexBuffer.setData(n$c),this._indexBuffer.setData(n$d),this._needFinishCombine=!1}},n$b._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new n$xb)},n$b._getRenderElement=function(n$a,n$b,n$c){for(var n$d,n$e,n$f=this._batchRenderElements.length,n$g=!0,n$h=0;n$h<n$f;n$h++){var n$i,n$j,n$k=(n$e=this._batchRenderElements[n$h])._sprite3D._render;if(0!==n$h&&(n$g=(n$i=(n$d=this._batchRenderElements[n$h-1])._sprite3D._render).lightmapIndex!==n$k.lightmapIndex||n$i.receiveShadow!==n$k.receiveShadow||n$d._batchIndexEnd!==n$e._batchIndexStart),n$g){(n$j=this._getCombineRenderElementFromPool()).renderObj=this,n$j._material=this._material,n$j._batchIndexStart=n$e._batchIndexStart,n$j._batchIndexEnd=n$e._batchIndexEnd;var n$l=n$k.lightmapIndex,n$m=n$l+1,n$n=this._batchOwnerIndices[n$m];n$n||(n$n=this._batchOwnerIndices[n$m]=[]);var n$o,n$p=n$n[n$e._render.receiveShadow?1:0];void 0===n$p?(n$n[n$k.receiveShadow?1:0]=this._batchOwners.length,(n$o=new n$Xb(null,"StaticBatchMeshSprite3D"))._scene=n$b,n$o._transform=this._rootOwner?this._rootOwner._transform:null,n$o._render.lightmapIndex=n$l,n$o._render.receiveShadow=n$e._render.receiveShadow,this._batchOwners.push(n$o)):n$o=this._batchOwners[n$p],n$o._render._renderUpdate(n$c),n$j._sprite3D=n$o,n$a.push(n$j)}else n$j._batchIndexEnd=n$e._batchIndexEnd}},n$b._beforeRender=function(n$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},n$b._render=function(n$a){var n$b=n$a.renderElement,n$c=n$b._batchIndexStart,n$d=n$b._batchIndexEnd-n$c;n$F.mainContext.drawElements(4,n$d,5123,2*n$c),n$y.drawCall++,n$y.trianglesFaces+=n$d/3},n$b.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},n$b._getVertexBuffer=function(n$a){return void 0===n$a&&(n$a=0),this._vertexBuffer},n$f}(),n$Db=function(n$a){function n$b(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,n$b.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}n$n(n$b,"laya.d3.core.ComponentNode",n$j);var n$c=n$b.prototype;return n$c.addComponent=function(n$a){var n$b,n$c=this._componentsMap.indexOf(n$a);if(-1===n$c)n$b=[],this._componentsMap.push(n$a),this._typeComponentsIndices.push(n$b);else if(n$b=this._typeComponentsIndices[n$c],this._components[n$b[0]].isSingleton)throw new Error("无法单实例创建"+n$a+"组件，"+n$a+"组件已存在！");var n$d=n$e.getInstance(n$a);return n$b.push(this._components.length),this._components.push(n$d),n$d instanceof laya.d3.component.Script&&this._scripts.push(n$d),n$d._initialize(this),n$d},n$c._removeComponent=function(n$a,n$b){var n$c=this._typeComponentsIndices[n$a],n$d=n$c[n$b],n$e=this._components[n$d];this._components.splice(n$d,1),n$e instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(n$e),1),n$c.splice(n$b,1),0===n$c.length&&(this._typeComponentsIndices.splice(n$a,1),this._componentsMap.splice(n$a,1));for(var n$f=0,n$g=this._componentsMap.length;n$f<n$g;n$f++)for(var n$h=(n$c=this._typeComponentsIndices[n$f]).length-1;0<=n$h;n$h--){var n$i=n$c[n$h];if(!(n$d<n$i))break;n$c[n$h]=--n$i}n$e._destroy()},n$c.getComponentByType=function(n$a,n$b){void 0===n$b&&(n$b=0);var n$c=this._componentsMap.indexOf(n$a);return-1===n$c?null:this._components[this._typeComponentsIndices[n$c][n$b]]},n$c.getComponentsByType=function(n$a,n$b){var n$c=this._componentsMap.indexOf(n$a);if(-1!==n$c){var n$d=this._typeComponentsIndices[n$c],n$e=n$d.length;n$b.length=n$e;for(var n$f=0;n$f<n$e;n$f++)n$b[n$f]=this._components[n$d[n$f]]}else n$b.length=0},n$c.getComponentByIndex=function(n$a){return this._components[n$a]},n$c.removeComponentByType=function(n$a,n$b){void 0===n$b&&(n$b=0);var n$c=this._componentsMap.indexOf(n$a);-1!==n$c&&this._removeComponent(n$c,n$b)},n$c.removeComponentsByType=function(n$a){var n$b=this._componentsMap.indexOf(n$a);if(-1!==n$b)for(var n$c=this._typeComponentsIndices[n$b],n$d=0,n$e=n$c.length;n$d<n$e;n$c.length<n$e?n$e--:n$d++)this._removeComponent(n$b,n$d)},n$c.removeAllComponent=function(){for(var n$a=0,n$b=this._componentsMap.length;n$a<n$b;this._componentsMap.length<n$b?n$b--:n$a++)this.removeComponentsByType(this._componentsMap[n$a])},n$c._updateComponents=function(n$a){for(var n$b=0,n$c=this._components.length;n$b<n$c;n$b++){var n$d=this._components[n$b];!n$d.started&&(n$d._start(n$a),n$d.started=!0),n$d.enable&&n$d._update(n$a)}},n$c._lateUpdateComponents=function(n$a){for(var n$b=0;n$b<this._components.length;n$b++){var n$c=this._components[n$b];!n$c.started&&(n$c._start(n$a),n$c.started=!0),n$c.enable&&n$c._lateUpdate(n$a)}},n$c._preRenderUpdateComponents=function(n$a){for(var n$b=0;n$b<this._components.length;n$b++){var n$c=this._components[n$b];!n$c.started&&(n$c._start(n$a),n$c.started=!0),n$c.enable&&n$c._preRenderUpdate(n$a)}},n$c._postRenderUpdateComponents=function(n$a){for(var n$b=0;n$b<this._components.length;n$b++){var n$c=this._components[n$b];!n$c.started&&(n$c._start(n$a),n$c.started=!0),n$c.enable&&n$c._postRenderUpdate(n$a)}},n$b}(),n$Eb=function(n$d){function n$a(){n$a.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new n$mb,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new n$hb(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}n$n(n$a,"laya.d3.core.material.BaseMaterial",n$d);var n$b=n$a.prototype;return n$v.imps(n$b,{"laya.d3.core.IClone":!0}),n$b._addShaderDefine=function(n$a){this._shaderDefineValue|=n$a},n$b._removeShaderDefine=function(n$a){this._shaderDefineValue&=~n$a},n$b._addDisablePublicShaderDefine=function(n$a){this._disablePublicShaderDefine|=n$a},n$b._removeDisablePublicShaderDefine=function(n$a){this._disablePublicShaderDefine&=~n$a},n$b._setBuffer=function(n$a,n$b){this._shaderValues.setValue(n$a,n$b),this._values[n$a]=n$b},n$b._getBuffer=function(n$a){return this._values[n$a]},n$b._setMatrix4x4=function(n$a,n$b){this._shaderValues.setValue(n$a,n$b?n$b.elements:null),this._values[n$a]=n$b},n$b._getMatrix4x4=function(n$a){return this._values[n$a]},n$b._setInt=function(n$a,n$b){this._shaderValues.setValue(n$a,n$b),this._values[n$a]=n$b},n$b._getInt=function(n$a){return this._values[n$a]},n$b._setNumber=function(n$a,n$b){this._shaderValues.setValue(n$a,n$b),this._values[n$a]=n$b},n$b._getNumber=function(n$a){return this._values[n$a]},n$b._setBool=function(n$a,n$b){this._shaderValues.setValue(n$a,n$b),this._values[n$a]=n$b},n$b._getBool=function(n$a){return this._values[n$a]},n$b._setVector2=function(n$a,n$b){this._shaderValues.setValue(n$a,n$b?n$b.elements:null),this._values[n$a]=n$b},n$b._getVector2=function(n$a){return this._values[n$a]},n$b._setColor=function(n$a,n$b){this._shaderValues.setValue(n$a,n$b?n$b.elements:null),this._values[n$a]=n$b},n$b._getColor=function(n$a){return this._values[n$a]},n$b._setTexture=function(n$a,n$b){var n$c=this._values[n$a];this._values[n$a]=n$b,this._shaderValues.setValue(n$a,n$b),0<this.referenceCount&&(n$c&&n$c._removeReference(),n$b&&n$b._addReference())},n$b._getTexture=function(n$a){return this._values[n$a]},n$b._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},n$b._getShader=function(n$a,n$b,n$c){var n$d=(n$a|n$b)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(n$d,n$c,this._shaderDefineValue),this._shader},n$b._setRenderStateBlendDepth=function(){var n$a=n$F.mainContext;switch(n$G.setDepthMask(n$a,this.depthWrite),0===this.depthTest?n$G.setDepthTest(n$a,!1):(n$G.setDepthTest(n$a,!0),n$G.setDepthFunc(n$a,this.depthTest)),this.blend){case 0:n$G.setBlend(n$a,!1);break;case 1:n$G.setBlend(n$a,!0),n$G.setBlendFunc(n$a,this.srcBlend,this.dstBlend);break;case 2:n$G.setBlend(n$a,!0)}},n$b._setRenderStateFrontFace=function(n$a,n$b){var n$c=n$F.mainContext,n$d=0;switch(this.cull){case 0:n$G.setCullFace(n$c,!1);break;case 1:n$G.setCullFace(n$c,!0),n$d=n$a?n$b&&n$b._isFrontFaceInvert?2305:2304:n$b&&n$b._isFrontFaceInvert?2304:2305,n$G.setFrontFace(n$c,n$d);break;case 2:n$G.setCullFace(n$c,!0),n$d=n$a?n$b&&n$b._isFrontFaceInvert?2304:2305:n$b&&n$b._isFrontFaceInvert?2305:2304,n$G.setFrontFace(n$c,n$d)}},n$b.onAsynLoaded=function(n$a,n$b,n$c){var n$d=n$b[0],n$e=n$b[1];switch(n$d.version){case"LAYAMATERIAL:01":var n$f=0,n$g=0,n$h=n$d.props;for(var n$i in n$h)switch(n$i){case"vectors":var n$j=n$h[n$i];for(n$f=0,n$g=n$j.length;n$f<n$g;n$f++){var n$k=n$j[n$f],n$l=n$k.value;switch(n$l.length){case 2:this[n$k.name]=new n$fb(n$l[0],n$l[1]);break;case 3:this[n$k.name]=new n$gb(n$l[0],n$l[1],n$l[2]);break;case 4:this[n$k.name]=new n$hb(n$l[0],n$l[1],n$l[2],n$l[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var n$m=n$h[n$i];for(n$f=0,n$g=n$m.length;n$f<n$g;n$f++){var n$n=n$m[n$f],n$o=n$n.path;n$o&&(this[n$n.name]=n$r.getRes(n$e[n$o]))}break;case"defines":var n$p=n$h[n$i];for(n$f=0,n$g=n$p.length;n$f<n$g;n$f++){var n$q=this._shaderCompile.getMaterialDefineByName(n$p[n$f]);this._addShaderDefine(n$q)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[n$i]=n$h[n$i];break;case"renderQueue":switch(n$h[n$i]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[n$i]=n$h[n$i]}break;case"LAYAMATERIAL:02":for(n$i in n$h=n$d.props)switch(n$i){case"vectors":for(n$f=0,n$g=(n$j=n$h[n$i]).length;n$f<n$g;n$f++)switch((n$l=(n$k=n$j[n$f]).value).length){case 2:this[n$k.name]=new n$fb(n$l[0],n$l[1]);break;case 3:this[n$k.name]=new n$gb(n$l[0],n$l[1],n$l[2]);break;case 4:this[n$k.name]=new n$hb(n$l[0],n$l[1],n$l[2],n$l[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(n$f=0,n$g=(n$m=n$h[n$i]).length;n$f<n$g;n$f++)(n$o=(n$n=n$m[n$f]).path)&&(this[n$n.name]=n$r.getRes(n$e[n$o]));break;case"defines":for(n$f=0,n$g=(n$p=n$h[n$i]).length;n$f<n$g;n$f++)n$q=this._shaderCompile.getMaterialDefineByName(n$p[n$f]),this._addShaderDefine(n$q);break;default:this[n$i]=n$h[n$i]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},n$b._addReference=function(){n$d.prototype._addReference.call(this);for(var n$a=0,n$b=this._values.length;n$a<n$b;n$a++){var n$c=this._values[n$a];n$c&&n$c instanceof laya.d3.resource.BaseTexture&&n$c._addReference()}},n$b._removeReference=function(){n$d.prototype._removeReference.call(this);for(var n$a=0,n$b=this._values.length;n$a<n$b;n$a++){var n$c=this._values[n$a];n$c&&n$c instanceof laya.d3.resource.BaseTexture&&n$c._removeReference()}},n$b.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},n$b.setShaderName=function(n$a){var n$b=n$Lb.nameKey.getID(n$a);if(-1===n$b)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=n$yb._preCompileShader[n$b]},n$b.cloneTo=function(n$a){var n$b=n$a;n$b.name=this.name,n$b.cull=this.cull,n$b.blend=this.blend,n$b.srcBlend=this.srcBlend,n$b.dstBlend=this.dstBlend,n$b.srcBlendRGB=this.srcBlendRGB,n$b.dstBlendRGB=this.dstBlendRGB,n$b.srcBlendAlpha=this.srcBlendAlpha,n$b.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(n$b.blendConstColor),n$b.blendEquation=this.blendEquation,n$b.blendEquationRGB=this.blendEquationRGB,n$b.blendEquationAlpha=this.blendEquationAlpha,n$b.depthTest=this.depthTest,n$b.depthWrite=this.depthWrite,n$b.renderQueue=this.renderQueue,n$b._shader=this._shader,n$b._disablePublicShaderDefine=this._disablePublicShaderDefine,n$b._shaderDefineValue=this._shaderDefineValue;var n$c,n$d=0,n$e=n$b._shaderValues;n$b._shaderValues.data.length=this._shaderValues.data.length;var n$f=this._values.length,n$g=n$b._values;for(n$d=0,n$c=n$g.length=n$f;n$d<n$c;n$d++){var n$h=this._values[n$d];if(n$h)if("number"==typeof n$h)n$g[n$d]=n$h,n$e.data[n$d]=n$h;else if("number"==typeof n$h&&Math.floor(n$h)==n$h)n$g[n$d]=n$h,n$e.data[n$d]=n$h;else if("boolean"==typeof n$h)n$g[n$d]=n$h,n$e.data[n$d]=n$h;else if(n$h instanceof laya.d3.math.Vector2){var n$i=n$g[n$d]||(n$g[n$d]=new n$fb);n$h.cloneTo(n$i),n$e.data[n$d]=n$i.elements}else if(n$h instanceof laya.d3.math.Vector3){var n$j=n$g[n$d]||(n$g[n$d]=new n$gb);n$h.cloneTo(n$j),n$e.data[n$d]=n$j.elements}else if(n$h instanceof laya.d3.math.Vector4){var n$k=n$g[n$d]||(n$g[n$d]=new n$hb);n$h.cloneTo(n$k),n$e.data[n$d]=n$k.elements}else if(n$h instanceof laya.d3.math.Matrix4x4){var n$l=n$g[n$d]||(n$g[n$d]=new n$ab);n$h.cloneTo(n$l),n$e.data[n$d]=n$l.elements}else n$h instanceof laya.d3.resource.BaseTexture&&(n$g[n$d]=n$h,n$e.data[n$d]=n$h)}},n$b.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$o(0,n$b,"alphaTestValue",function(){return this._getNumber(0)},function(n$a){this._setNumber(0,n$a)}),n$o(0,n$b,"alphaTest",function(){return this._alphaTest},function(n$a){(this._alphaTest=n$a)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),n$a.__init__=function(){n$a.SHADERDEFINE_ALPHATEST=n$a.shaderDefines.registerDefine("ALPHATEST")},n$a.RENDERQUEUE_OPAQUE=2e3,n$a.RENDERQUEUE_ALPHATEST=2450,n$a.RENDERQUEUE_TRANSPARENT=3e3,n$a.CULL_NONE=0,n$a.CULL_FRONT=1,n$a.CULL_BACK=2,n$a.BLEND_DISABLE=0,n$a.BLEND_ENABLE_ALL=1,n$a.BLEND_ENABLE_SEPERATE=2,n$a.BLENDPARAM_ZERO=0,n$a.BLENDPARAM_ONE=1,n$a.BLENDPARAM_SRC_COLOR=768,n$a.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,n$a.BLENDPARAM_DST_COLOR=774,n$a.BLENDPARAM_ONE_MINUS_DST_COLOR=775,n$a.BLENDPARAM_SRC_ALPHA=770,n$a.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,n$a.BLENDPARAM_DST_ALPHA=772,n$a.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,n$a.BLENDPARAM_SRC_ALPHA_SATURATE=776,n$a.BLENDEQUATION_ADD=0,n$a.BLENDEQUATION_SUBTRACT=1,n$a.BLENDEQUATION_REVERSE_SUBTRACT=2,n$a.DEPTHTEST_OFF=0,n$a.DEPTHTEST_NEVER=512,n$a.DEPTHTEST_LESS=513,n$a.DEPTHTEST_EQUAL=514,n$a.DEPTHTEST_LEQUAL=515,n$a.DEPTHTEST_GREATER=516,n$a.DEPTHTEST_NOTEQUAL=517,n$a.DEPTHTEST_GEQUAL=518,n$a.DEPTHTEST_ALWAYS=519,n$a.SHADERDEFINE_ALPHATEST=1,n$a.ALPHATESTVALUE=0,n$l(n$a,["shaderDefines",function(){return this.shaderDefines=new n$kb}]),n$a}(n$q),n$Fb=function(n$a){function n$b(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,n$b.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}n$n(n$b,"laya.d3.resource.BaseTexture",n$q);var n$c=n$b.prototype;return n$o(0,n$c,"width",function(){return this._width}),n$o(0,n$c,"repeat",function(){return this._repeat},function(n$a){if(this._repeat!==n$a&&(this._repeat=n$a,this._source)){var n$b=n$F.mainContext;n$G.bindTexture(n$b,this._type,this._source),n$u.isPOT(this._width,this._height)&&this._repeat?(n$b.texParameteri(this._type,10242,10497),n$b.texParameteri(this._type,10243,10497)):(n$b.texParameteri(this._type,10242,33071),n$b.texParameteri(this._type,10243,33071))}}),n$o(0,n$c,"height",function(){return this._height}),n$o(0,n$c,"magFifter",function(){return this._magFifter},function(n$a){(this._magFifter=n$a)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(n$a)}),n$o(0,n$c,"wrapModeV",function(){return this._wrapModeV}),n$o(0,n$c,"size",function(){return this._size}),n$o(0,n$c,"wrapModeU",function(){return this._wrapModeU}),n$o(0,n$c,"mipmap",function(){return this._mipmap},function(n$a){this._mipmap=n$a,this._mipmap!=n$a&&this._conchTexture&&this._conchTexture.setMipMap(n$a)}),n$o(0,n$c,"minFifter",function(){return this._minFifter},function(n$a){this._minFifter=n$a,this._minFifter!=n$a&&this._conchTexture&&this._conchTexture.setMinFifter(n$a)}),n$o(0,n$c,"format",function(){return this._format}),n$o(0,n$c,"source",function(){return this.activeResource(),this._source}),n$o(0,n$c,"defaulteTexture",function(){return n$Sb.grayTexture}),n$b.WARPMODE_REPEAT=0,n$b.WARPMODE_CLAMP=1,n$b}(),n$Gb=function(n$a){function n$b(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,n$b.__super.call(this),this._boundingBoxCorners=n$d(8,null)}n$n(n$b,"laya.d3.resource.models.BaseMesh",n$q);var n$c=n$b.prototype;return n$c._getPositions=function(){throw new Error("未Override,请重载该属性！")},n$c._generateBoundingObject=function(){this._boundingSphere=new n$_a(new n$gb,0),n$_a.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new n$Za(new n$gb,new n$gb),n$Za.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},n$c.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},n$c.getRenderElement=function(n$a){throw new Error("未Override,请重载该属性！")},n$o(0,n$c,"subMeshCount",function(){return this._subMeshCount}),n$o(0,n$c,"boundingBox",function(){return this._boundingBox}),n$o(0,n$c,"boundingBoxCorners",function(){return this._boundingBoxCorners}),n$o(0,n$c,"boundingSphere",function(){return this._boundingSphere}),n$b}(),n$Hb=(function(n$a){function n$b(){n$b.__super.call(this)}n$n(n$b,"laya.d3.component.Script",n$tb);var n$c=n$b.prototype;n$c.onTriggerEnter=function(n$a){},n$c.onTriggerExit=function(n$a){},n$c.onTriggerStay=function(n$a){},n$o(0,n$c,"isSingleton",function(){return n$b._isSingleton}),n$b._isSingleton=!1}(),function(n$a){function n$b(n$a){this._owner=null,this._sharedMesh=null,n$b.__super.call(this),this._owner=n$a}n$n(n$b,"laya.d3.core.MeshFilter",n$a);var n$c=n$b.prototype;return n$c._sharedMeshLoaded=function(){this.event("loaded")},n$c._destroy=function(){n$a.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},n$o(0,n$c,"sharedMesh",function(){return this._sharedMesh},function(n$a){var n$b=this._sharedMesh;n$b&&n$b._removeReference(),(this._sharedMesh=n$a)._addReference(),this.event("meshchanged",[this,n$b,n$a]),n$a.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),n$o(0,n$c,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),n$o(0,n$c,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),n$o(0,n$c,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),n$o(0,n$c,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),n$b}(n$ub)),n$Ib=function(n$a){function n$b(n$a){n$b.__super.call(this,n$a),n$a.meshFilter.on("meshchanged",this,this._onMeshChanged)}n$n(n$b,"laya.d3.core.MeshRender",n$vb);var n$c=n$b.prototype;return n$c._onMeshChanged=function(n$a,n$b,n$c){n$c.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:n$c.once("loaded",this,this._onMeshLoaed)},n$c._onMeshLoaed=function(n$a,n$b){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},n$c._calculateBoundingSphereByInitSphere=function(n$a){var n$b=NaN,n$c=this._owner.transform,n$d=n$c.scale.elements,n$e=Math.abs(n$d[0]),n$f=Math.abs(n$d[1]),n$g=Math.abs(n$d[2]);n$b=n$f<=n$e&&n$g<=n$e?n$e:n$g<=n$f?n$f:n$g,n$gb.transformCoordinate(n$a.center,n$c.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=n$a.radius*n$b},n$c._calculateBoundBoxByInitCorners=function(n$a){for(var n$b=this._owner.transform.worldMatrix,n$c=0;n$c<8;n$c++)n$gb.transformCoordinate(n$a[n$c],n$b,n$vb._tempBoundBoxCorners[n$c]);n$Za.createfromPoints(n$vb._tempBoundBoxCorners,this._boundingBox)},n$c._calculateBoundingSphere=function(){var n$a=this._owner.meshFilter.sharedMesh;null==n$a||null==n$a.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(n$a.boundingSphere)},n$c._calculateBoundingBox=function(){var n$a=this._owner.meshFilter.sharedMesh;null==n$a||null==n$a.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(n$a.boundingBoxCorners)},n$c._renderUpdate=function(n$a){var n$b=this._owner.transform;if(n$b){this._setShaderValueMatrix4x4(0,n$b.worldMatrix);var n$c=this._owner.getProjectionViewWorldMatrix(n$a);this._setShaderValueMatrix4x4(1,n$c)}else this._setShaderValueMatrix4x4(0,n$ab.DEFAULT),this._setShaderValueMatrix4x4(1,n$a);return n$rb.debugMode&&this._renderRenderableBoundBox(),!0},n$b}(),n$Jb=function(n$b){function n$d(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,n$d.__super.call(this),this._renderState=new n$Y,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new n$mb,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new n$ba,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new n$gb(.7,.7,.7),this.ambientColor=new n$gb(.212,.227,.259),n$F.shaderHighPrecision&&this.addShaderDefine(n$yb.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}n$n(n$d,"laya.d3.core.scene.Scene",n$b);var n$a=n$d.prototype;return n$v.imps(n$a,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),n$a._setUrl=function(n$a){this._url=n$a},n$a._getGroup=function(){return this._group},n$a._setGroup=function(n$a){this._group=n$a},n$a._display=function(){n$v.stage._scenes.push(this),n$v.stage._scenes.sort(n$d._sortScenes);for(var n$a=0,n$b=this._childs.length;n$a<n$b;n$a++){var n$c=this._childs[n$a];n$c.active&&n$c._activeHierarchy()}},n$a._unDisplay=function(){var n$a=n$v.stage._scenes;n$a.splice(n$a.indexOf(this),1);for(var n$b=0,n$c=this._childs.length;n$b<n$c;n$b++){var n$d=this._childs[n$b];n$d.active&&n$d._inActiveHierarchy()}},n$a._addChild3D=function(n$a){n$a.transform._onWorldTransform(),n$a._setBelongScene(this),this.displayedInStage&&n$a.active&&n$a._activeHierarchy()},n$a._removeChild3D=function(n$a){n$a.transform.parent=null,this.displayedInStage&&n$a.active&&n$a._inActiveHierarchy(),n$a._setUnBelongScene()},n$a.initOctree=function(n$a,n$b,n$c,n$d,n$e){void 0===n$e&&(n$e=6),this.treeSize=new n$gb(n$a,n$b,n$c),this.treeLevel=n$e,this.treeRoot=new n$Z(this,0),this.treeRoot.init(n$d,this.treeSize)},n$a._prepareUpdateToRenderState=function(n$a,n$b){n$b.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,n$b.scene=this},n$a._prepareSceneToRender=function(n$a){var n$b=this._lights.length;if(0<n$b)for(var n$c=0,n$d=0;n$d<n$b&&!(this._lights[n$d]._prepareToScene(n$a)&&++n$c>=this._enableLightCount);n$d++);},n$a._updateChilds=function(n$a){for(var n$b=0,n$c=this._childs.length;n$b<n$c;++n$b)this._childs[n$b]._update(n$a)},n$a._preRenderScene=function(n$a,n$b,n$c){var n$d,n$e=n$b._viewMatrix,n$f=n$b._projectionMatrix,n$g=n$b._projectionViewMatrix,n$h=0,n$i=n$b.camera;for(n$i.useOcclusionCulling?this.treeRoot?n$ca.renderObjectCullingOctree(n$c,this,n$i,n$e,n$f,n$g):n$ca.renderObjectCulling(n$c,this,n$i,n$e,n$f,n$g):n$ca.renderObjectCullingNoBoundFrustum(this,n$i,n$e,n$f,n$g),n$h=0,n$d=this._quenes.length;n$h<n$d;n$h++)this._quenes[n$h]&&this._quenes[n$h]._preRender(n$b)},n$a._clear=function(n$a,n$b){var n$c=n$b._viewport,n$d=n$b.camera,n$e=n$c.x,n$f=n$d.renderTargetSize.height-n$c.y-n$c.height,n$g=n$c.width,n$h=n$c.height;n$a.viewport(n$e,n$f,n$g,n$h);var n$i=256,n$j=n$d.renderTarget;switch(n$d.clearFlag){case 0:var n$k=n$d.clearColor;if(n$k){n$a.enable(3089),n$a.scissor(n$e,n$f,n$g,n$h);var n$l=n$k.elements;n$a.clearColor(n$l[0],n$l[1],n$l[2],n$l[3]),n$i|=16384}if(n$j)switch(n$k||(n$i=16384),n$j.depthStencilFormat){case 33189:n$i|=256;break;case 36168:n$i|=1024;break;case 34041:n$i|=256,n$i|=1024}n$a.clear(n$i),n$k&&n$a.disable(3089);break;case 1:case 2:if(n$j)switch(n$i=16384,n$j.depthStencilFormat){case 33189:n$i|=256;break;case 36168:n$i|=1024;break;case 34041:n$i|=256,n$i|=1024}n$a.clear(n$i);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},n$a._renderScene=function(n$a,n$b){var n$c,n$d,n$e=n$b.camera,n$f=0;for(n$f=0;n$f<2;n$f++)(n$d=this._quenes[n$f])&&(n$e.renderTarget?n$d._render(n$b,!0):n$d._render(n$b,!1));if(1===n$e.clearFlag){var n$g=n$e.sky;n$g&&(n$G.setCullFace(n$a,!1),n$G.setDepthFunc(n$a,515),n$G.setDepthMask(n$a,!1),n$g._render(n$b),n$G.setDepthFunc(n$a,513),n$G.setDepthMask(n$a,!0))}for(n$f=2,n$c=this._quenes.length;n$f<n$c;n$f++)(n$d=this._quenes[n$f])&&(n$d._sortAlpha(n$b.camera.transform.position),n$e.renderTarget?n$d._render(n$b,!0):n$d._render(n$b,!1))},n$a._set3DRenderConfig=function(n$a){n$a.disable(3042),n$G._blend=!1,n$a.blendFunc(770,771),n$G._sFactor=770,n$G._dFactor=771,n$a.disable(2929),n$G._depthTest=!1,n$a.enable(2884),n$G._cullFace=!0,n$a.depthMask(1),n$G._depthMask=!0,n$a.frontFace(2304),n$G._frontFace=2304},n$a._set2DRenderConfig=function(n$a){n$G.setBlend(n$a,!0),n$G.setBlendFunc(n$a,1,771),n$G.setDepthTest(n$a,!1),n$G.setCullFace(n$a,!1),n$G.setDepthMask(n$a,!0),n$G.setFrontFace(n$a,2305),n$a.viewport(0,0,n$k.width,n$k.height)},n$a._parseCustomProps=function(n$a,n$b,n$c,n$d){var n$e=n$d.customProps.lightmaps,n$f=n$e.length,n$g=this._lightmaps;n$g.length=n$f;for(var n$h=0;n$h<n$f;n$h++)n$g[n$h]=n$r.getRes(n$b[n$e[n$h].replace(".exr",".png")]);this.setlightmaps(n$g);var n$i=n$d.customProps.ambientColor;n$i&&(this.ambientColor=new n$gb(n$i[0],n$i[1],n$i[2]));var n$j=n$d.customProps.fogColor;n$j&&(this.fogColor=new n$gb(n$j[0],n$j[1],n$j[2]))},n$a._addLight=function(n$a){this._lights.indexOf(n$a)<0&&this._lights.push(n$a)},n$a._removeLight=function(n$a){var n$b=this._lights.indexOf(n$a);0<=n$b&&this._lights.splice(n$b,1)},n$a._updateScene=function(){var n$a=this._renderState;this._prepareUpdateToRenderState(n$F.mainContext,n$a),this._updateComponents(n$a),this._updateChilds(n$a),this._lateUpdateComponents(n$a),this._time+=n$a.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},n$a._updateSceneConch=function(){var n$a=this._renderState;this._prepareUpdateToRenderState(n$F.mainContext,n$a),this._updateComponents(n$a),this._lateUpdateComponents(n$a),this._prepareSceneToRender(n$a);for(var n$b=0,n$c=this._cameraPool.length;n$b<n$c;n$b++){var n$d=this._cameraPool[n$b];(n$a.camera=n$d)._prepareCameraToRender()}},n$a._preRenderShadow=function(n$a,n$b,n$c,n$d,n$e){this.treeRoot?n$ca.renderShadowObjectCullingOctree(this,n$b,n$c,n$d,n$e):n$ca.renderShadowObjectCulling(this,n$b,n$c,n$d,n$e);for(var n$f=0,n$g=n$c.length;n$f<n$g;n$f++)n$c[n$f]&&n$c[n$f]._preRender(n$a)},n$a._renderShadowMap=function(n$a,n$b,n$c){var n$d=this.parallelSplitShadowMaps[0];n$d._calcAllLightCameraInfo(n$c);var n$e,n$f,n$g,n$h=n$d.PSSMNum;if(this._preRenderShadow(n$b,n$d._lightCulling,n$d._shadowQuenes,n$d._lightVPMatrix[0],n$h),this.addShaderDefine(n$nb.SHADERDEFINE_CAST_SHADOW),1<n$h)for(var n$i=0;n$i<n$h;n$i++)n$e=n$d.getRenderTarget(n$i+1),n$d.beginRenderTarget(n$i+1),n$a.clearColor(1,1,1,1),n$a.clear(16640),n$a.viewport(0,0,n$e.width,n$e.height),n$b.camera=n$g=n$d.getLightCamera(n$i),n$g._prepareCameraToRender(),n$g._prepareCameraViewProject(n$g.viewMatrix,n$g.projectionMatrix),n$b._projectionViewMatrix=n$d._lightVPMatrix[n$i+1],(n$f=n$d._shadowQuenes[n$i])._preRender(n$b),n$f._renderShadow(n$b,!1),n$d.endRenderTarget(n$i+1);else n$e=n$d.getRenderTarget(1),n$d.beginRenderTarget(1),n$a.clearColor(1,1,1,1),n$a.clear(16640),n$a.viewport(0,0,n$e.width,n$e.height),n$b.camera=n$g=n$d.getLightCamera(0),n$g._prepareCameraToRender(),n$g._prepareCameraViewProject(n$g.viewMatrix,n$g.projectionMatrix),n$b._projectionViewMatrix=n$d._lightVPMatrix[0],(n$f=n$d._shadowQuenes[0])._preRender(n$b),n$f._renderShadow(n$b,!0),n$d.endRenderTarget(1);this.removeShaderDefine(n$nb.SHADERDEFINE_CAST_SHADOW)},n$a.addTreeNode=function(n$a){this.treeRoot.addTreeNode(n$a)},n$a.removeTreeNode=function(n$a){this.treeSize&&n$a._treeNode&&n$a._treeNode.removeObject(n$a)},n$a.setlightmaps=function(n$a){this._lightmaps=n$a;for(var n$b=0,n$c=this._renderableSprite3Ds.length;n$b<n$c;n$b++)this._renderableSprite3Ds[n$b]._render._applyLightMapParams()},n$a.getlightmaps=function(){return this._lightmaps},n$a.addChildAt=function(n$a,n$b){if(!(n$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(n$a&&n$a.__className));if(!n$a||this.destroyed||n$a===this)return n$a;if(n$a.zOrder&&this._set$P("hasZorder",!0),0<=n$b&&n$b<=this._childs.length){if(n$a._parent===this){var n$c=this.getChildIndex(n$a);this._childs.splice(n$c,1),this._childs.splice(n$b,0,n$a),this.conchModel&&(this.conchModel.removeChild(n$a.conchModel),this.conchModel.addChildAt(n$a.conchModel,n$b)),this._childChanged()}else n$a.parent&&n$a.parent.removeChild(n$a),this._childs===n$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(n$b,0,n$a),this.conchModel&&this.conchModel.addChildAt(n$a.conchModel,n$b),(n$a.parent=this)._addChild3D(n$a);return n$a}throw new Error("appendChildAt:The index is out of bounds")},n$a.addChild=function(n$a){if(!(n$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!n$a||this.destroyed||n$a===this)return n$a;if(n$a.zOrder&&this._set$P("hasZorder",!0),n$a._parent===this){var n$b=this.getChildIndex(n$a);n$b!==this._childs.length-1&&(this._childs.splice(n$b,1),this._childs.push(n$a),this.conchModel&&(this.conchModel.removeChild(n$a.conchModel),this.conchModel.addChildAt(n$a.conchModel,this._childs.length-1)),this._childChanged())}else n$a.parent&&n$a.parent.removeChild(n$a),this._childs===n$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(n$a),this.conchModel&&this.conchModel.addChildAt(n$a.conchModel,this._childs.length-1),(n$a.parent=this)._childChanged(),this._addChild3D(n$a);return n$a},n$a.removeChildAt=function(n$a){var n$b=this.getChildAt(n$a);return n$b&&(this._removeChild3D(n$b),this._childs.splice(n$a,1),this.conchModel&&this.conchModel.removeChild(n$b.conchModel),n$b.parent=null),n$b},n$a.removeChildren=function(n$a,n$b){if(void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=2147483647),this._childs&&0<this._childs.length){var n$c=this._childs;if(0===n$a&&n$f<=n$b){var n$d=n$c;this._childs=n$j.ARRAY_EMPTY}else n$d=n$c.splice(n$a,n$b-n$a);for(var n$e=0,n$f=n$d.length;n$e<n$f;n$e++)this._removeChild3D(n$d[n$e]),n$d[n$e].parent=null,this.conchModel&&this.conchModel.removeChild(n$d[n$e].conchModel)}return this},n$a.addFrustumCullingObject=function(n$a){this.treeRoot?this.addTreeNode(n$a):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(n$a):this._cullingRenders[this._cullingRendersLength]=n$a,n$a._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},n$a.removeFrustumCullingObject=function(n$a){if(this.treeRoot)this.removeTreeNode(n$a);else{this._cullingRendersLength--;var n$b=n$a._indexInSceneFrustumCullingObjects;if(n$b!==this._cullingRendersLength){var n$c=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[n$b]=n$c)._indexInSceneFrustumCullingObjects=n$b,n$a._indexInSceneFrustumCullingObjects=-1}}},n$a.getRenderQueue=function(n$a){return n$a<3e3?this._quenes[1]||(this._quenes[1]=new n$X(this)):this._quenes[2]||(this._quenes[2]=new n$X(this))},n$a.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new n$X(this)},n$a.addShaderDefine=function(n$a){this._shaderDefineValue|=n$a},n$a.removeShaderDefine=function(n$a){this._shaderDefineValue&=~n$a},n$a.addScript=function(n$a){return this._addComponent(n$a)},n$a.getScriptByType=function(n$a,n$b){return void 0===n$b&&(n$b=0),this._getComponentByType(n$a,n$b)},n$a.getScriptsByType=function(n$a,n$b){this._getComponentsByType(n$a,n$b)},n$a.getScriptByIndex=function(n$a){return this._getComponentByIndex(n$a)},n$a.removeScriptByType=function(n$a,n$b){void 0===n$b&&(n$b=0),this._removeComponentByType(n$a,n$b)},n$a.removeScriptsByType=function(n$a){this._removeComponentByType(n$a)},n$a.removeAllScript=function(){this._removeAllComponent()},n$a.render=function(n$a,n$b,n$c){(n$p._context.ctx._renderKey=0)<this._childs.length&&n$a.addRenderObject(this)},n$a.renderSubmit=function(){var n$a=n$F.mainContext,n$b=this._renderState;this._set3DRenderConfig(n$a),this._prepareSceneToRender(this._renderState);var n$c,n$d=0,n$e=0;if(n$rb.debugMode||n$Z.debugMode)for(n$d=0,n$e=this._cameraPool.length;n$d<n$e;n$d++)n$c=this._cameraPool[n$d],n$rb._debugPhasorSprite.begin(1,n$c),n$c.activeInHierarchy&&n$c._renderCamera(n$a,n$b,this),n$rb._debugPhasorSprite.end();else for(n$d=0,n$e=this._cameraPool.length;n$d<n$e;n$d++)(n$c=this._cameraPool[n$d]).activeInHierarchy&&n$c._renderCamera(n$a,n$b,this);return this._set2DRenderConfig(n$a),1},n$a.onAsynLoaded=function(n$a,n$b,n$c){var n$d=n$b[0];if("Scene"!==n$d.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var n$e=n$b[1];n$qb._createNodeByJson(this,n$d,this,n$e),this.event("hierarchyloaded",[this]),this.__loaded=!0},n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),this.destroyed||(n$b.prototype.destroy.call(this,n$a),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,n$r.clearRes(this.url),this.loaded||n$rb._cancelLoadByUrl(this.url))},n$a.getRenderType=function(){return 0},n$a.releaseRender=function(){},n$a._addComponent=function(n$a){var n$b,n$c=this._componentsMap.indexOf(n$a);if(-1===n$c)n$b=[],this._componentsMap.push(n$a),this._typeComponentsIndices.push(n$b);else if(n$b=this._typeComponentsIndices[n$c],this._components[n$b[0]].isSingleton)throw new Error("无法单实例创建"+n$a+"组件，"+n$a+"组件已存在！");var n$d=n$e.getInstance(n$a);n$b.push(this._components.length),this._components.push(n$d);return n$d._initialize(this),n$d},n$a._removeComponent=function(n$a,n$b){var n$c=this._typeComponentsIndices[n$a],n$d=n$c[n$b],n$e=this._components[n$d];this._components.splice(n$d,1),n$c.splice(n$b,1),0===n$c.length&&(this._typeComponentsIndices.splice(n$a,1),this._componentsMap.splice(n$a,1));for(var n$f=0,n$g=this._componentsMap.length;n$f<n$g;n$f++)for(var n$h=(n$c=this._typeComponentsIndices[n$f]).length-1;0<=n$h;n$h--){var n$i=n$c[n$h];if(!(n$d<n$i))break;n$c[n$h]=--n$i}n$e._destroy()},n$a._getComponentByType=function(n$a,n$b){void 0===n$b&&(n$b=0);var n$c=this._componentsMap.indexOf(n$a);return-1===n$c?null:this._components[this._typeComponentsIndices[n$c][n$b]]},n$a._getComponentsByType=function(n$a,n$b){var n$c=this._componentsMap.indexOf(n$a);if(-1!==n$c){var n$d=this._typeComponentsIndices[n$c],n$e=n$d.length;n$b.length=n$e;for(var n$f=0;n$f<n$e;n$f++)n$b[n$f]=this._components[n$d[n$f]]}else n$b.length=0},n$a._getComponentByIndex=function(n$a){return this._components[n$a]},n$a._removeComponentByType=function(n$a,n$b){void 0===n$b&&(n$b=0);var n$c=this._componentsMap.indexOf(n$a);-1!==n$c&&this._removeComponent(n$c,n$b)},n$a._removeComponentsByType=function(n$a){var n$b=this._componentsMap.indexOf(n$a);if(-1!==n$b)for(var n$c=this._typeComponentsIndices[n$b],n$d=0,n$e=n$c.length;n$d<n$e;n$c.length<n$e?n$e--:n$d++)this._removeComponent(n$b,n$d)},n$a._removeAllComponent=function(){for(var n$a=0,n$b=this._componentsMap.length;n$a<n$b;this._componentsMap.length<n$b?n$b--:n$a++)this._removeComponentsByType(this._componentsMap[n$a])},n$a._updateComponents=function(n$a){for(var n$b=0,n$c=this._components.length;n$b<n$c;n$b++){var n$d=this._components[n$b];!n$d.started&&(n$d._start(n$a),n$d.started=!0),n$d.enable&&n$d._update(n$a)}},n$a._lateUpdateComponents=function(n$a){for(var n$b=0;n$b<this._components.length;n$b++){var n$c=this._components[n$b];!n$c.started&&(n$c._start(n$a),n$c.started=!0),n$c.enable&&n$c._lateUpdate(n$a)}},n$a._preRenderUpdateComponents=function(n$a){for(var n$b=0;n$b<this._components.length;n$b++){var n$c=this._components[n$b];!n$c.started&&(n$c._start(n$a),n$c.started=!0),n$c.enable&&n$c._preRenderUpdate(n$a)}},n$a._postRenderUpdateComponents=function(n$a){for(var n$b=0;n$b<this._components.length;n$b++){var n$c=this._components[n$b];!n$c.started&&(n$c._start(n$a),n$c.started=!0),n$c.enable&&n$c._postRenderUpdate(n$a)}},n$o(0,n$a,"_loaded",null,function(n$a){this.__loaded=n$a}),n$o(0,n$a,"fogColor",function(){return this._fogColor},function(n$a){this._fogColor=n$a,this._shaderValues.setValue(0,n$a.elements)}),n$o(0,n$a,"enableFog",function(){return this._enableFog},function(n$a){this._enableFog!==n$a&&((this._enableFog=n$a)?(this.addShaderDefine(n$yb.SHADERDEFINE_FOG),this.removeShaderDefine(n$yb.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(n$yb.SHADERDEFINE_FOG))}),n$o(0,n$a,"url",function(){return this._url}),n$o(0,n$a,"loaded",function(){return this.__loaded}),n$o(0,n$a,"enableDepthFog",function(){return this._enableDepthFog},function(n$a){this._enableDepthFog!=n$a&&((this._enableDepthFog=n$a)?(this.addShaderDefine(n$yb.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(n$yb.SHADERDEFINE_FOG)):this.removeShaderDefine(n$yb.SAHDERDEFINE_DEPTHFOG))}),n$o(0,n$a,"fogStart",function(){return this._fogStart},function(n$a){this._fogStart=n$a,this._shaderValues.setValue(1,n$a)}),n$o(0,n$a,"fogRange",function(){return this._fogRange},function(n$a){this._fogRange=n$a,this._shaderValues.setValue(2,n$a)}),n$o(0,n$a,"ambientColor",function(){return this._ambientColor},function(n$a){this._ambientColor=n$a,this._shaderValues.setValue(21,n$a.elements)}),n$o(0,n$a,"scene",function(){return this}),n$o(0,n$a,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),n$d._sortScenes=function(n$a,n$b){if(n$a.parent!==n$v.stage||n$b.parent!==n$v.stage)return n$a.parent!==n$v.stage&&n$b.parent!==n$v.stage?n$d._sortScenes(n$a.parent,n$b.parent):n$a.parent===n$v.stage?-1:1;var n$c=n$v.stage._childs;return n$c.indexOf(n$a)-n$c.indexOf(n$b)},n$d.load=function(n$a){return n$v.loader.create(n$a,null,null,n$d)},n$d.FOGCOLOR=0,n$d.FOGSTART=1,n$d.FOGRANGE=2,n$d.LIGHTDIRECTION=3,n$d.LIGHTDIRCOLOR=4,n$d.POINTLIGHTPOS=5,n$d.POINTLIGHTRANGE=6,n$d.POINTLIGHTATTENUATION=7,n$d.POINTLIGHTCOLOR=8,n$d.SPOTLIGHTPOS=9,n$d.SPOTLIGHTDIRECTION=10,n$d.SPOTLIGHTSPOT=11,n$d.SPOTLIGHTRANGE=12,n$d.SPOTLIGHTATTENUATION=13,n$d.SPOTLIGHTCOLOR=14,n$d.SHADOWDISTANCE=15,n$d.SHADOWLIGHTVIEWPROJECT=16,n$d.SHADOWMAPPCFOFFSET=17,n$d.SHADOWMAPTEXTURE1=18,n$d.SHADOWMAPTEXTURE2=19,n$d.SHADOWMAPTEXTURE3=20,n$d.AMBIENTCOLOR=21,n$d.TIME=22,n$d}(n$x),n$Kb=function(n$a){function n$b(n$a){n$b.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new n$ab,this._shaderValues=new n$mb,this._colliders=[],this._id=++n$b._uniqueIDCounter,this._transform=new n$wb(this),this.name=n$a||"Sprite3D-"+n$b._nameNumberCounter++,this.layer=n$I.currentCreationLayer,this.active=!0}n$n(n$b,"laya.d3.core.Sprite3D",n$Db);var n$c=n$b.prototype;return n$v.imps(n$c,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),n$c._setUrl=function(n$a){this._url=n$a},n$c._getGroup=function(){return this._group},n$c._setGroup=function(n$a){this._group=n$a},n$c._addChild3D=function(n$a){n$a.transform.parent=this.transform,this._hierarchyAnimator&&(!n$a._hierarchyAnimator&&n$a._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(n$a,!0,[n$a.name])),this._scene&&(n$a._setBelongScene(this._scene),this._activeInHierarchy&&n$a._active&&n$a._activeHierarchy())},n$c._removeChild3D=function(n$a){n$a.transform.parent=null,this._scene&&(this._activeInHierarchy&&n$a._active&&n$a._inActiveHierarchy(),n$a._setUnBelongScene()),this._hierarchyAnimator&&(n$a._hierarchyAnimator==this._hierarchyAnimator&&n$a._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(n$a,!1,[n$a.name]))},n$c._parseBaseCustomProps=function(n$a){var n$b=this.transform.localPosition;n$a.translate?(n$b.fromArray(n$a.translate),n$b.x*=100,n$b.y*=100,n$b.z*=100):n$b.elements.fill(0),this.transform.localPosition=n$b;var n$c=this.transform.localRotation;n$a.rotation?n$c.fromArray(n$a.rotation):n$c.fromArray([0,0,0,-1]),this.transform.localRotation=n$c;var n$d=this.transform.localScale;n$a.scale?n$d.fromArray(n$a.scale):n$d.elements.fill(1),this.transform.localScale=n$d;var n$e=n$a.layer;null!=n$e&&(this.layer=n$I.getLayerByNumber(n$e))},n$c._parseCustomComponent=function(n$a,n$b,n$c){for(var n$d in n$c){var n$e=n$c[n$d];switch(n$d){case"Animator":var n$f=this.addComponent(Animator);if(n$e.avatarPath)n$f.avatar=n$r.getRes(n$b[n$e.avatarPath]);else{var n$g=n$e.avatar;if(n$g){n$f.avatar=n$r.getRes(n$b[n$g.path]);var n$h=n$g.linkSprites;n$h&&n$a.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[n$f,n$h])}}for(var n$i=n$e.clipPaths,n$j=n$i.length,n$k=0;n$k<n$j;n$k++)n$f.addClip(n$r.getRes(n$b[n$i[n$k]]));n$f.clip=n$r.getRes(n$b[n$i[0]]);var n$l=n$e.playOnWake;void 0!==n$l&&(n$f.playOnWake=n$l);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var n$m=this.addComponent(SphereCollider);n$m.isTrigger=n$e.isTrigger;var n$n=n$m.center;n$n.fromArray(n$e.center),n$m.center=n$n,n$m.radius=n$e.radius;break;case"BoxCollider":var n$o=this.addComponent(BoxCollider);n$o.isTrigger=n$e.isTrigger,n$o.center.fromArray(n$e.center);var n$p=n$o.size;n$p.fromArray(n$e.size),n$o.size=n$p;break;case"MeshCollider":this.addComponent(MeshCollider)}}},n$c._onRootNodeHierarchyLoaded=function(n$a,n$b){for(var n$c in n$b){for(var n$d=this,n$e=n$b[n$c],n$f=0,n$g=n$e.length;n$f<n$g;n$f++){var n$h=n$e[n$f];if(""===n$h)break;if(!(n$d=n$d.getChildByName(n$h)))break}n$d&&n$a.linkSprite3DToAvatarNode(n$c,n$d)}},n$c._setHierarchyAnimator=function(n$a,n$b){this._changeHierarchyAnimator(n$a);for(var n$c=0,n$d=this._childs.length;n$c<n$d;n$c++){var n$e=this._childs[n$c];n$e._hierarchyAnimator==n$b&&n$e._setHierarchyAnimator(n$a,n$b)}},n$c._clearHierarchyAnimator=function(n$a,n$b){this._changeHierarchyAnimator(n$b);for(var n$c=0,n$d=this._childs.length;n$c<n$d;n$c++){var n$e=this._childs[n$c];n$e._hierarchyAnimator==n$a&&n$e._clearHierarchyAnimator(n$a,n$b)}},n$c._getAnimatorToLinkSprite3D=function(n$a,n$b,n$c){var n$d=this.getComponentByType(Animator);if(n$d&&(n$d.avatar?n$d.avatar._version||n$a._setAnimatorToLinkAvatar(n$d,n$b):n$a._setAnimatorToLinkSprite3DNoAvatar(n$d,n$b,n$c)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){n$c.unshift(this._parent.name);var n$e=this._parent;n$e._hierarchyAnimator&&n$e._getAnimatorToLinkSprite3D(n$a,n$b,n$c)}},n$c._setAnimatorToLinkSprite3DNoAvatar=function(n$a,n$b,n$c){var n$d=0,n$e=0;for(n$d=0,n$e=n$a.getClipCount();n$d<n$e;n$d++)n$a._handleSpriteOwnersBySprite(n$d,n$b,n$c,this);for(n$d=0,n$e=this._childs.length;n$d<n$e;n$d++){var n$f=this._childs[n$d],n$g=n$c.length;n$c.push(n$f.name),n$f._setAnimatorToLinkSprite3DNoAvatar(n$a,n$b,n$c),n$c.splice(n$g,1)}},n$c._changeHierarchyAnimator=function(n$a){this._hierarchyAnimator=n$a},n$c._isLinkSpriteToAnimationNode=function(n$a,n$b,n$c){var n$d=n$a._avatarNodes.indexOf(n$b),n$e=n$a._cacheSpriteToNodesMap;if(n$c)this._transform.dummy=n$b.transform,n$a._cacheNodesToSpriteMap[n$d]=n$e.length,n$e.push(n$d);else{this._transform.dummy=null;var n$f=n$a._cacheNodesToSpriteMap[n$d];n$a._cacheNodesToSpriteMap[n$d]=null,n$e.splice(n$f,1)}},n$c._setBelongScene=function(n$a){this._scene=n$a;for(var n$b=0,n$c=this._childs.length;n$b<n$c;n$b++)this._childs[n$b]._setBelongScene(n$a)},n$c._setUnBelongScene=function(){this._scene=null;for(var n$a=0,n$b=this._childs.length;n$a<n$b;n$a++)this._childs[n$a]._setUnBelongScene()},n$c._activeHierarchy=function(){var n$a=0,n$b=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),n$a=0,n$b=this._colliders.length;n$a<n$b;n$a++)this._layer._addCollider(this._colliders[n$a]);for(this.event("activeinhierarchychanged",!0),n$a=0,n$b=this._childs.length;n$a<n$b;n$a++){var n$c=this._childs[n$a];n$c._active&&n$c._activeHierarchy()}},n$c._inActiveHierarchy=function(){var n$a=0,n$b=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),n$a=0,n$b=this._colliders.length;n$a<n$b;n$a++){var n$c=this._colliders[n$a];n$c._clearCollsionMap(),this._layer._removeCollider(n$c)}for(this.event("activeinhierarchychanged",!1),n$a=0,n$b=this._childs.length;n$a<n$b;n$a++){var n$d=this._childs[n$a];n$d._active&&n$d._inActiveHierarchy()}},n$c.addComponent=function(n$a){var n$b,n$c=this._componentsMap.indexOf(n$a);if(-1===n$c)n$b=[],this._componentsMap.push(n$a),this._typeComponentsIndices.push(n$b);else if(n$b=this._typeComponentsIndices[n$c],this._components[n$b[0]].isSingleton)throw new Error("无法单实例创建"+n$a+"组件，"+n$a+"组件已存在！");var n$d=n$e.getInstance(n$a);return n$b.push(this._components.length),this._components.push(n$d),n$d instanceof laya.d3.component.Script&&this._scripts.push(n$d),n$d._initialize(this),n$d},n$c._removeComponent=function(n$a,n$b){var n$c,n$d=0,n$e=this._typeComponentsIndices[n$a],n$f=n$e[n$b],n$g=this._components[n$f];for(n$g instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(n$g),1),n$e.splice(n$b,1),0===n$e.length&&(this._typeComponentsIndices.splice(n$a,1),this._componentsMap.splice(n$a,1)),n$d=0,n$c=this._componentsMap.length;n$d<n$c;n$d++)for(var n$h=(n$e=this._typeComponentsIndices[n$d]).length-1;0<=n$h;n$h--){var n$i=n$e[n$h];if(!(n$f<n$i))break;n$e[n$h]=--n$i}n$g._destroy()},n$c._clearSelfRenderObjects=function(){},n$c._addSelfRenderObjects=function(){},n$c._parseCustomProps=function(n$a,n$b,n$c,n$d){},n$c._updateChilds=function(n$a){var n$b=this._childs.length;if(0!==n$b)for(var n$c=0;n$c<n$b;++n$c)this._childs[n$c]._update(n$a)},n$c._getSortID=function(n$a,n$b){return 1e3*n$b.id+n$a._getVertexBuffer().vertexDeclaration.id},n$c._update=function(n$a){(n$a.owner=this)._activeInHierarchy&&(this._updateComponents(n$a),this._lateUpdateComponents(n$a),n$y.spriteCount++,this._childs.length&&this._updateChilds(n$a))},n$c.getProjectionViewWorldMatrix=function(n$a){return n$ab.multiply(n$a,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},n$c.loadHierarchy=function(n$a){this.addChild(laya.d3.core.Sprite3D.load(n$a))},n$c.addChildAt=function(n$a,n$b){if(!(n$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!n$a||this.destroyed||n$a===this)return n$a;if(n$a.zOrder&&this._set$P("hasZorder",!0),0<=n$b&&n$b<=this._childs.length){if(n$a._parent===this){var n$c=this.getChildIndex(n$a);this._childs.splice(n$c,1),this._childs.splice(n$b,0,n$a),this.conchModel&&(this.conchModel.removeChild(n$a.conchModel),this.conchModel.addChildAt(n$a.conchModel,n$b)),this._childChanged()}else n$a.parent&&n$a.parent.removeChild(n$a),this._childs===n$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(n$b,0,n$a),this.conchModel&&this.conchModel.addChildAt(n$a.conchModel,n$b),(n$a.parent=this)._addChild3D(n$a);return n$a}throw new Error("appendChildAt:The index is out of bounds")},n$c.addChild=function(n$a){if(!(n$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!n$a||this.destroyed||n$a===this)return n$a;if(n$a.zOrder&&this._set$P("hasZorder",!0),n$a._parent===this){var n$b=this.getChildIndex(n$a);n$b!==this._childs.length-1&&(this._childs.splice(n$b,1),this._childs.push(n$a),this.conchModel&&(this.conchModel.removeChild(n$a.conchModel),this.conchModel.addChildAt(n$a.conchModel,this._childs.length-1)),this._childChanged())}else n$a.parent&&n$a.parent.removeChild(n$a),this._childs===n$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(n$a),this.conchModel&&this.conchModel.addChildAt(n$a.conchModel,this._childs.length-1),(n$a.parent=this)._childChanged(),this._addChild3D(n$a);return n$a},n$c.removeChildAt=function(n$a){var n$b=this.getChildAt(n$a);return n$b&&(this._removeChild3D(n$b),this._childs.splice(n$a,1),this.conchModel&&this.conchModel.removeChild(n$b.conchModel),n$b.parent=null),n$b},n$c.removeChildren=function(n$a,n$b){if(void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=2147483647),this._childs&&0<this._childs.length){var n$c=this._childs;if(0===n$a&&n$f<=n$b){var n$d=n$c;this._childs=n$j.ARRAY_EMPTY}else n$d=n$c.splice(n$a,n$b-n$a);for(var n$e=0,n$f=n$d.length;n$e<n$f;n$e++)this._removeChild3D(n$d[n$e]),n$d[n$e].parent=null,this.conchModel&&this.conchModel.removeChild(n$d[n$e].conchModel)}return this},n$c.onAsynLoaded=function(n$a,n$b,n$c){var n$d=n$b[0];if("Sprite3D"!==n$d.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var n$e=n$b[1];n$qb._createNodeByJson(this,n$d,this,n$e),this.event("hierarchyloaded",[this]),this.__loaded=!0},n$c.cloneTo=function(n$a){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var n$b=n$a;n$b.name=this.name,n$b._destroyed=this._destroyed,n$b.timer=this.timer,n$b._$P=this._$P,n$b.active=this._active;var n$c=n$b.transform.localPosition;this.transform.localPosition.cloneTo(n$c),n$b.transform.localPosition=n$c;var n$d=n$b.transform.localRotation;this.transform.localRotation.cloneTo(n$d),n$b.transform.localRotation=n$d;var n$e=n$b.transform.localScale;this.transform.localScale.cloneTo(n$e),n$b.transform.localScale=n$e,n$b.isStatic=this.isStatic;var n$f=0,n$g=0;for(n$f=0,n$g=this._componentsMap.length;n$f<n$g;n$f++){var n$h=n$b.addComponent(this._componentsMap[n$f]);this._components[n$f]._cloneTo(n$h)}for(n$f=0,n$g=this._childs.length;n$f<n$g;n$f++)n$b.addChild(this._childs[n$f].clone());var n$i=n$b.getComponentByType(Animator);if(n$i){var n$j=n$i._linkSpritesData;if(n$j)for(var n$k in n$j){for(var n$l=n$j[n$k],n$m=n$b,n$n=0,n$o=n$l.length;n$n<n$o&&(n$m=n$m.getChildByName(n$l[n$n]));n$n++);if(n$m){var n$p=n$i._avatarNodeMap[n$k];n$m._isLinkSpriteToAnimationNode(n$i,n$p,!0)}}}},n$c.clone=function(){var n$a=new this.constructor;return this.cloneTo(n$a),n$a},n$c.destroy=function(n$a){if(void 0===n$a&&(n$a=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,n$a);var n$b,n$c=0;for(n$c=0,n$b=this._components.length;n$c<n$b;n$c++)this._components[n$c]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,n$r.clearRes(this.url),this.loaded||n$rb._cancelLoadByUrl(this.url)}},n$c._handleSpriteToAvatar=function(n$a,n$b){n$a._avatarNodes;var n$c=n$a._avatarNodeMap[this.name];n$c&&n$c.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(n$a,n$c,n$b)},n$c._setAnimatorToLinkAvatar=function(n$a,n$b){this._handleSpriteToAvatar(n$a,n$b);for(var n$c=0,n$d=this._childs.length;n$c<n$d;n$c++){this._childs[n$c]._setAnimatorToLinkAvatar(n$a,n$b)}},n$o(0,n$c,"activeInHierarchy",function(){return this._activeInHierarchy}),n$o(0,n$c,"_loaded",null,function(n$a){this.__loaded=n$a}),n$o(0,n$c,"active",function(){return this._active},function(n$a){this._active!==n$a&&(this._active=n$a,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(n$a?this._activeHierarchy():this._inActiveHierarchy()))}),n$o(0,n$c,"componentsCount",function(){return this._components.length}),n$o(0,n$c,"loaded",function(){return this.__loaded}),n$o(0,n$c,"id",function(){return this._id}),n$o(0,n$c,"url",function(){return this._url}),n$o(0,n$c,"layer",function(){return this._layer},function(n$a){if(this._layer!==n$a){if(!n$a)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var n$b=0,n$c=this._colliders.length;if(this._layer)for(n$b=0;n$b<n$c;n$b++)this._layer._removeCollider(this._colliders[n$b]);for(n$b=0;n$b<n$c;n$b++)n$a._addCollider(this._colliders[n$b])}this._layer=n$a,this.event("layerchanged",n$a)}}),n$o(0,n$c,"scene",function(){return this._scene}),n$o(0,n$c,"transform",function(){return this._transform}),n$b.instantiate=function(n$a,n$b,n$c,n$d,n$e){void 0===n$c&&(n$c=!0);var n$f=n$a.clone();n$b&&n$b.addChild(n$f);var n$g=n$f.transform;if(n$c){var n$h=n$g.worldMatrix;n$a.transform.worldMatrix.cloneTo(n$h),n$g.worldMatrix=n$h}else n$d&&(n$g.position=n$d),n$e&&(n$g.rotation=n$e);return n$f},n$b.load=function(n$a){return n$v.loader.create(n$a,null,null,n$b)},n$b.WORLDMATRIX=0,n$b.MVPMATRIX=1,n$b._uniqueIDCounter=0,n$b._nameNumberCounter=0,n$b}(),n$Lb=function(n$a){function n$k(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],n$k.__super.call(this),!n$a||!n$b)throw"Shader Error";this._id=++n$k._count,this._vs=n$a,this._ps=n$b,this._attributeMap=n$c,this._sceneUniformMap=n$d,this._cameraUniformMap=n$e,this._spriteUniformMap=n$f,this._materialUniformMap=n$g,this._renderElementUniformMap=n$h,this._precompile=n$i,this._define=n$j,this._precompile&&n$k.extCompileObj&&n$k.extCompileFunc?n$k.extCompileFunc.call(n$k.extCompileObj,n$a,n$b,n$j):this.recreateResource()}n$n(n$k,"laya.d3.shader.Shader3D",n$c);var n$b=n$k.prototype;return n$b.recreateResource=function(){n$H.now();this._compile(),this.completeCreate(),this.memorySize=0},n$b.disposeResource=function(){n$F.mainContext.deleteShader(this._vshader),n$F.mainContext.deleteShader(this._pshader),n$F.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},n$b._compile=function(){if(!n$F.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var n$a=[this._vs,this._ps],n$b=n$F.mainContext;if(this._program=n$b.createProgram(),this._vshader=n$k._createShader(n$b,n$a[0],35633),this._pshader=n$k._createShader(n$b,n$a[1],35632),n$b.attachShader(this._program,this._vshader),n$b.attachShader(this._program,this._pshader),n$b.linkProgram(this._program),!n$p.isConchApp&&n$yb.debugMode&&!n$b.getProgramParameter(this._program,35714))throw n$b.getProgramInfoLog(this._program);var n$c,n$d=0,n$e=0,n$f=0;for(n$f=n$p.isConchApp?n$b.getProgramParameterEx(this._vs,this._ps,"",35721):n$b.getProgramParameter(this._program,35721),n$d=0;n$d<n$f;n$d++){var n$g=null;n$c={vartype:"attribute",ivartype:0,attrib:n$g=n$p.isConchApp?n$b.getActiveAttribEx(this._vs,this._ps,"",n$d):n$b.getActiveAttrib(this._program,n$d),location:n$b.getAttribLocation(this._program,n$g.name),name:n$g.name,type:n$g.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(n$c)}var n$h=0;for(n$h=n$p.isConchApp?n$b.getProgramParameterEx(this._vs,this._ps,"",35718):n$b.getProgramParameter(this._program,35718),n$d=0;n$d<n$h;n$d++){var n$i=null;n$i=n$p.isConchApp?n$b.getActiveUniformEx(this._vs,this._ps,"",n$d):n$b.getActiveUniform(this._program,n$d),0<(n$c={vartype:"uniform",ivartype:1,attrib:n$g,location:n$b.getUniformLocation(this._program,n$i.name),name:n$i.name,type:n$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(n$c.name=n$c.name.substr(0,n$c.name.length-3),n$c.isArray=!0,n$c.location=n$b.getUniformLocation(this._program,n$c.name)),this._uniformParams.push(n$c)}for(n$d=0,n$e=this._attributeParams.length;n$d<n$e;n$d++)(n$c=this._attributeParams[n$d]).indexOfParams=n$d,n$c.index=1,n$c.value=[n$c.location,null],n$c.codename=n$c.name,n$c.name=null!=this._attributeMap[n$c.codename]?this._attributeMap[n$c.codename]:n$c.codename,this._attributeParamsMap.push(n$c.name),this._attributeParamsMap.push(n$c),n$c._this=this,n$c.uploadedValue=[],n$c.fun=this._attribute;for(n$d=0,n$e=this._uniformParams.length;n$d<n$e;n$d++)switch((n$c=this._uniformParams[n$d]).indexOfParams=n$d,n$c.index=1,n$c.value=[n$c.location,null],n$c.codename=n$c.name,null!=this._sceneUniformMap[n$c.codename]?(n$c.name=this._sceneUniformMap[n$c.codename],this._sceneUniformParamsMap.push(n$c.name),this._sceneUniformParamsMap.push(n$c)):null!=this._cameraUniformMap[n$c.codename]?(n$c.name=this._cameraUniformMap[n$c.codename],this._cameraUniformParamsMap.push(n$c.name),this._cameraUniformParamsMap.push(n$c)):null!=this._spriteUniformMap[n$c.codename]?(n$c.name=this._spriteUniformMap[n$c.codename],this._spriteUniformParamsMap.push(n$c.name),this._spriteUniformParamsMap.push(n$c)):null!=this._materialUniformMap[n$c.codename]?(n$c.name=this._materialUniformMap[n$c.codename],this._materialUniformParamsMap.push(n$c.name),this._materialUniformParamsMap.push(n$c)):null!=this._renderElementUniformMap[n$c.codename]?(n$c.name=this._renderElementUniformMap[n$c.codename],this._renderElementUniformParamsMap.push(n$c.name),this._renderElementUniformParamsMap.push(n$c)):console.log("Shader:can't find uinform name:"+n$c.codename+" in shader file."),n$c._this=this,n$c.uploadedValue=[],n$c.type){case 5124:n$c.fun=n$c.isArray?this._uniform1iv:this._uniform1i;break;case 5126:n$c.fun=n$c.isArray?this._uniform1fv:this._uniform1f;break;case 35664:n$c.fun=n$c.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:n$c.fun=n$c.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:n$c.fun=n$c.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:n$c.fun=this._uniform_sampler2D;break;case 35680:n$c.fun=this._uniform_samplerCube;break;case 35676:n$c.fun=this._uniformMatrix4fv;break;case 35670:n$c.fun=this._uniform1i;break;case 35674:n$c.fun=this._uinformMatrix2fv;break;case 35675:n$c.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},n$b._attribute=function(n$a,n$b){var n$c=n$F.mainContext,n$d=n$h._enableAtributes,n$e=n$a.location;return n$d[n$e]||n$c.enableVertexAttribArray(n$e),n$c.vertexAttribPointer(n$e,n$b[0],n$b[1],n$b[2],n$b[3],n$b[4]),n$d[n$e]=n$h._bindVertexBuffer,1},n$b._uniform1f=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b?(n$F.mainContext.uniform1f(n$a.location,n$c[0]=n$b),1):0},n$b._uniform1fv=function(n$a,n$b){if(n$b.length<4){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]||n$c[2]!==n$b[2]||n$c[3]!==n$b[3]?(n$F.mainContext.uniform1fv(n$a.location,n$b),n$c[0]=n$b[0],n$c[1]=n$b[1],n$c[2]=n$b[2],n$c[3]=n$b[3],1):0}return n$F.mainContext.uniform1fv(n$a.location,n$b),1},n$b._uniform_vec2=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]?(n$F.mainContext.uniform2f(n$a.location,n$c[0]=n$b[0],n$c[1]=n$b[1]),1):0},n$b._uniform_vec2v=function(n$a,n$b){if(n$b.length<2){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]||n$c[2]!==n$b[2]||n$c[3]!==n$b[3]?(n$F.mainContext.uniform2fv(n$a.location,n$b),n$c[0]=n$b[0],n$c[1]=n$b[1],n$c[2]=n$b[2],n$c[3]=n$b[3],1):0}return n$F.mainContext.uniform2fv(n$a.location,n$b),1},n$b._uniform_vec3=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]||n$c[2]!==n$b[2]?(n$F.mainContext.uniform3f(n$a.location,n$c[0]=n$b[0],n$c[1]=n$b[1],n$c[2]=n$b[2]),1):0},n$b._uniform_vec3v=function(n$a,n$b){return n$F.mainContext.uniform3fv(n$a.location,n$b),1},n$b._uniform_vec4=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]||n$c[2]!==n$b[2]||n$c[3]!==n$b[3]?(n$F.mainContext.uniform4f(n$a.location,n$c[0]=n$b[0],n$c[1]=n$b[1],n$c[2]=n$b[2],n$c[3]=n$b[3]),1):0},n$b._uniform_vec4v=function(n$a,n$b){return n$F.mainContext.uniform4fv(n$a.location,n$b),1},n$b._uniformMatrix2fv=function(n$a,n$b){return n$F.mainContext.uniformMatrix2fv(n$a.location,!1,n$b),1},n$b._uniformMatrix3fv=function(n$a,n$b){return n$F.mainContext.uniformMatrix3fv(n$a.location,!1,n$b),1},n$b._uniformMatrix4fv=function(n$a,n$b){return n$F.mainContext.uniformMatrix4fv(n$a.location,!1,n$b),1},n$b._uinformMatrix2fv=function(n$a,n$b){return n$F.mainContext.uniformMatrix2fv(n$a.location,!1,n$b),1},n$b._uinformMatrix3fv=function(n$a,n$b){return n$F.mainContext.uniformMatrix3fv(n$a.location,!1,n$b),1},n$b._uniform1i=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b?(n$F.mainContext.uniform1i(n$a.location,n$c[0]=n$b),1):0},n$b._uniform1iv=function(n$a,n$b){return n$F.mainContext.uniform1iv(n$a.location,n$b),1},n$b._uniform_ivec2=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]?(n$F.mainContext.uniform2i(n$a.location,n$c[0]=n$b[0],n$c[1]=n$b[1]),1):0},n$b._uniform_ivec2v=function(n$a,n$b){return n$F.mainContext.uniform2iv(n$a.location,n$b),1},n$b._uniform_vec3i=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]||n$c[2]!==n$b[2]?(n$F.mainContext.uniform3i(n$a.location,n$c[0]=n$b[0],n$c[1]=n$b[1],n$c[2]=n$b[2]),1):0},n$b._uniform_vec3vi=function(n$a,n$b){return n$F.mainContext.uniform3iv(n$a.location,n$b),1},n$b._uniform_vec4i=function(n$a,n$b){var n$c=n$a.uploadedValue;return n$c[0]!==n$b[0]||n$c[1]!==n$b[1]||n$c[2]!==n$b[2]||n$c[3]!==n$b[3]?(n$F.mainContext.uniform4i(n$a.location,n$c[0]=n$b[0],n$c[1]=n$b[1],n$c[2]=n$b[2],n$c[3]=n$b[3]),1):0},n$b._uniform_vec4vi=function(n$a,n$b){return n$F.mainContext.uniform4iv(n$a.location,n$b),1},n$b._uniform_sampler2D=function(n$a,n$b){var n$c=n$b.source||n$b.defaulteTexture.source,n$d=n$F.mainContext,n$e=n$a.uploadedValue;if(null!=n$e[0])return n$d.activeTexture(n$k._TEXTURES[n$e[0]]),n$c&&n$G.bindTexture(n$d,3553,n$c),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return n$e[0]=this._curActTexIndex,n$d.uniform1i(n$a.location,this._curActTexIndex),n$d.activeTexture(n$k._TEXTURES[this._curActTexIndex]),n$c&&n$G.bindTexture(n$d,3553,n$c),this._curActTexIndex++,1},n$b._uniform_samplerCube=function(n$a,n$b){var n$c=n$b.source||n$b.defaulteTexture.source,n$d=n$F.mainContext,n$e=n$a.uploadedValue;if(null!=n$e[0])return n$d.activeTexture(n$k._TEXTURES[n$e[0]]),n$c?n$G.bindTexture(n$d,34067,n$c):n$G.bindTexture(n$d,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return n$e[0]=this._curActTexIndex,n$d.uniform1i(n$a.location,this._curActTexIndex),n$d.activeTexture(n$k._TEXTURES[this._curActTexIndex]),n$c?n$G.bindTexture(n$d,34067,n$c):n$G.bindTexture(n$d,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},n$b._noSetValue=function(n$a){console.log("no....:"+n$a.name)},n$b.bind=function(){return n$c.activeShader=this,(n$c.bindShader=this).activeResource(),n$G.UseProgram(this._program)},n$b.uploadAttributes=function(n$a,n$b){for(var n$c,n$d,n$e=0,n$f=0,n$g=this._attributeParamsMap.length;n$f<n$g;n$f+=2)n$d=this._attributeParamsMap[n$f+1],null!=(n$c=n$a[this._attributeParamsMap[n$f]])&&(n$b&&n$b[n$d.name]&&n$b[n$d.name].bind(),n$e+=n$d.fun.call(this,n$d,n$c));n$y.shaderCall+=n$e},n$b.uploadAttributesX=function(n$a,n$b){for(var n$c,n$d,n$e=0,n$f=0,n$g=this._attributeParamsMap.length;n$f<n$g;n$f+=2)n$d=this._attributeParamsMap[n$f+1],null!=(n$c=n$a[this._attributeParamsMap[n$f]])&&(n$b._bind(),n$e+=n$d.fun.call(this,n$d,n$c));n$y.shaderCall+=n$e},n$b.uploadSceneUniforms=function(n$a){for(var n$b,n$c,n$d=0,n$e=0,n$f=this._sceneUniformParamsMap.length;n$e<n$f;n$e+=2)n$c=this._sceneUniformParamsMap[n$e+1],null!=(n$b=n$a[this._sceneUniformParamsMap[n$e]])&&(n$d+=n$c.fun.call(this,n$c,n$b));n$y.shaderCall+=n$d},n$b.uploadCameraUniforms=function(n$a){for(var n$b,n$c,n$d=0,n$e=0,n$f=this._cameraUniformParamsMap.length;n$e<n$f;n$e+=2)n$c=this._cameraUniformParamsMap[n$e+1],null!=(n$b=n$a[this._cameraUniformParamsMap[n$e]])&&(n$d+=n$c.fun.call(this,n$c,n$b));n$y.shaderCall+=n$d},n$b.uploadSpriteUniforms=function(n$a){for(var n$b,n$c,n$d=0,n$e=0,n$f=this._spriteUniformParamsMap.length;n$e<n$f;n$e+=2)n$c=this._spriteUniformParamsMap[n$e+1],null!=(n$b=n$a[this._spriteUniformParamsMap[n$e]])&&(n$d+=n$c.fun.call(this,n$c,n$b));n$y.shaderCall+=n$d},n$b.uploadMaterialUniforms=function(n$a){for(var n$b,n$c,n$d=0,n$e=0,n$f=this._materialUniformParamsMap.length;n$e<n$f;n$e+=2)n$c=this._materialUniformParamsMap[n$e+1],null!=(n$b=n$a[this._materialUniformParamsMap[n$e]])&&(n$d+=n$c.fun.call(this,n$c,n$b));n$y.shaderCall+=n$d},n$b.uploadRenderElementUniforms=function(n$a){for(var n$b,n$c,n$d=0,n$e=0,n$f=this._renderElementUniformParamsMap.length;n$e<n$f;n$e+=2)n$c=this._renderElementUniformParamsMap[n$e+1],null!=(n$b=n$a[this._renderElementUniformParamsMap[n$e]])&&(n$d+=n$c.fun.call(this,n$c,n$b));n$y.shaderCall+=n$d},n$k.create=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){return new n$k(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j)},n$k.addInclude=function(n$a,n$b){n$t.addInclude(n$a,n$b)},n$k._createShader=function(n$a,n$b,n$c){var n$d=n$a.createShader(n$c);if(n$a.shaderSource(n$d,n$b),n$a.compileShader(n$d),n$yb.debugMode&&!n$a.getShaderParameter(n$d,35713))throw n$a.getShaderInfoLog(n$d);return n$d},n$k.PERIOD_RENDERELEMENT=0,n$k.PERIOD_MATERIAL=1,n$k.PERIOD_SPRITE=2,n$k.PERIOD_CAMERA=3,n$k.PERIOD_SCENE=4,n$k._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],n$k._count=0,n$k._preCompile=!1,n$k.extCompileFunc=null,n$k.extCompileObj=null,n$l(n$k,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new n$z}]),n$k}(),n$Mb=function(n$h){function n$i(){this._transformUV=null,n$i.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new n$gb(.6,.6,.6)),this._setColor(10,new n$gb(1,1,1)),this._setColor(11,new n$hb(1,1,1,8)),this._setColor(12,new n$gb(1,1,1)),this._setColor(7,new n$hb(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new n$hb(1,1,0,0)),this.renderMode=1}n$n(n$i,"laya.d3.core.material.StandardMaterial",n$h);var n$a=n$i.prototype;return n$a.disableLight=function(){this._addDisablePublicShaderDefine(n$yb.SHADERDEFINE_POINTLIGHT|n$yb.SHADERDEFINE_SPOTLIGHT|n$yb.SHADERDEFINE_DIRECTIONLIGHT)},n$a.disableFog=function(){this._addDisablePublicShaderDefine(n$yb.SHADERDEFINE_FOG)},n$a.onAsynLoaded=function(n$a,n$b,n$c){var n$d=n$b[0];if(n$d.version)n$h.prototype.onAsynLoaded.call(this,n$a,n$b,n$c);else{var n$e=n$b[1],n$f=n$d.props;for(var n$g in n$f)this[n$g]=n$f[n$g];n$i._parseStandardMaterial(n$e,this,n$d),this._endLoaded()}},n$a.cloneTo=function(n$a){n$h.prototype.cloneTo.call(this,n$a);var n$b=n$a;this._transformUV&&(n$b._transformUV=this._transformUV.clone())},n$o(0,n$a,"ambientColor",function(){return this._getColor(9)},function(n$a){this._setColor(9,n$a)}),n$o(0,n$a,"ambientTexture",function(){return this._getTexture(5)},function(n$a){n$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,n$a)}),n$o(0,n$a,"renderMode",null,function(n$a){switch(n$a){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(n$i.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(n$a)}),n$o(0,n$a,"reflectColor",function(){return this._getColor(12)},function(n$a){this._setColor(12,n$a)}),n$o(0,n$a,"tilingOffset",function(){return this._getColor(15)},function(n$a){if(n$a){var n$b=n$a.elements;1!=n$b[0]||1!=n$b[1]||0!=n$b[2]||0!=n$b[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,n$a)}),n$o(0,n$a,"albedo",function(){return this._getColor(7)},function(n$a){this._setColor(7,n$a)}),n$o(0,n$a,"diffuseColor",function(){return this._getColor(10)},function(n$a){this._setColor(10,n$a)}),n$o(0,n$a,"albedoColor",function(){return this._getColor(7)},function(n$a){this._setColor(7,n$a)}),n$o(0,n$a,"specularColor",function(){return this._getColor(11)},function(n$a){this._setColor(11,n$a)}),n$o(0,n$a,"diffuseTexture",function(){return this._getTexture(1)},function(n$a){n$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,n$a)}),n$o(0,n$a,"normalTexture",function(){return this._getTexture(2)},function(n$a){n$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,n$a)}),n$o(0,n$a,"specularTexture",function(){return this._getTexture(3)},function(n$a){n$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,n$a)}),n$o(0,n$a,"emissiveTexture",function(){return this._getTexture(4)},function(n$a){n$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,n$a)}),n$o(0,n$a,"reflectTexture",function(){return this._getTexture(6)},function(n$a){n$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,n$a)}),n$o(0,n$a,"transformUV",function(){return this._transformUV},function(n$a){this._transformUV=n$a,this._setMatrix4x4(13,n$a.matrix),n$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,n$a.matrix.elements,0)}),n$i.__init__=function(){n$i.SHADERDEFINE_DIFFUSEMAP=n$i.shaderDefines.registerDefine("DIFFUSEMAP"),n$i.SHADERDEFINE_NORMALMAP=n$i.shaderDefines.registerDefine("NORMALMAP"),n$i.SHADERDEFINE_SPECULARMAP=n$i.shaderDefines.registerDefine("SPECULARMAP"),n$i.SHADERDEFINE_EMISSIVEMAP=n$i.shaderDefines.registerDefine("EMISSIVEMAP"),n$i.SHADERDEFINE_AMBIENTMAP=n$i.shaderDefines.registerDefine("AMBIENTMAP"),n$i.SHADERDEFINE_REFLECTMAP=n$i.shaderDefines.registerDefine("REFLECTMAP"),n$i.SHADERDEFINE_UVTRANSFORM=n$i.shaderDefines.registerDefine("UVTRANSFORM"),n$i.SHADERDEFINE_TILINGOFFSET=n$i.shaderDefines.registerDefine("TILINGOFFSET"),n$i.SHADERDEFINE_ADDTIVEFOG=n$i.shaderDefines.registerDefine("ADDTIVEFOG")},n$i.load=function(n$a){return n$v.loader.create(n$a,null,null,n$i)},n$i._parseStandardMaterial=function(n$a,n$b,n$c){var n$d=n$c.customProps,n$e=n$d.ambientColor;n$b.ambientColor=new n$gb(n$e[0],n$e[1],n$e[2]);var n$f=n$d.diffuseColor;n$b.diffuseColor=new n$gb(n$f[0],n$f[1],n$f[2]);var n$g=n$d.specularColor;n$b.specularColor=new n$hb(n$g[0],n$g[1],n$g[2],n$g[3]);var n$h=n$d.reflectColor;n$b.reflectColor=new n$gb(n$h[0],n$h[1],n$h[2]);var n$i=n$d.albedoColor;n$i&&(n$b.albedo=new n$hb(n$i[0],n$i[1],n$i[2],n$i[3]));var n$j=n$d.diffuseTexture.texture2D;n$j&&(n$b.diffuseTexture=n$r.getRes(n$a[n$j]));var n$k=n$d.normalTexture.texture2D;n$k&&(n$b.normalTexture=n$r.getRes(n$a[n$k]));var n$l=n$d.specularTexture.texture2D;n$l&&(n$b.specularTexture=n$r.getRes(n$a[n$l]));var n$m=n$d.emissiveTexture.texture2D;n$m&&(n$b.emissiveTexture=n$r.getRes(n$a[n$m]));var n$n=n$d.ambientTexture.texture2D;n$n&&(n$b.ambientTexture=n$r.getRes(n$a[n$n]));var n$o=n$d.reflectTexture.texture2D;n$o&&(n$b.reflectTexture=n$r.getRes(n$a[n$o]))},n$i.RENDERMODE_OPAQUE=1,n$i.RENDERMODE_OPAQUEDOUBLEFACE=2,n$i.RENDERMODE_CUTOUT=3,n$i.RENDERMODE_CUTOUTDOUBLEFACE=4,n$i.RENDERMODE_TRANSPARENT=13,n$i.RENDERMODE_TRANSPARENTDOUBLEFACE=14,n$i.RENDERMODE_ADDTIVE=15,n$i.RENDERMODE_ADDTIVEDOUBLEFACE=16,n$i.RENDERMODE_DEPTHREAD_TRANSPARENT=5,n$i.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,n$i.RENDERMODE_DEPTHREAD_ADDTIVE=7,n$i.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,n$i.RENDERMODE_NONDEPTH_TRANSPARENT=9,n$i.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,n$i.RENDERMODE_NONDEPTH_ADDTIVE=11,n$i.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,n$i.SHADERDEFINE_DIFFUSEMAP=0,n$i.SHADERDEFINE_NORMALMAP=0,n$i.SHADERDEFINE_SPECULARMAP=0,n$i.SHADERDEFINE_EMISSIVEMAP=0,n$i.SHADERDEFINE_AMBIENTMAP=0,n$i.SHADERDEFINE_REFLECTMAP=0,n$i.SHADERDEFINE_UVTRANSFORM=0,n$i.SHADERDEFINE_TILINGOFFSET=0,n$i.SHADERDEFINE_ADDTIVEFOG=0,n$i.DIFFUSETEXTURE=1,n$i.NORMALTEXTURE=2,n$i.SPECULARTEXTURE=3,n$i.EMISSIVETEXTURE=4,n$i.AMBIENTTEXTURE=5,n$i.REFLECTTEXTURE=6,n$i.ALBEDO=7,n$i.UVANIAGE=8,n$i.MATERIALAMBIENT=9,n$i.MATERIALDIFFUSE=10,n$i.MATERIALSPECULAR=11,n$i.MATERIALREFLECT=12,n$i.UVMATRIX=13,n$i.UVAGE=14,n$i.TILINGOFFSET=15,n$l(n$i,["defaultMaterial",function(){var n$a=new n$i;return n$a.lock=!0,this.defaultMaterial=n$a},"shaderDefines",function(){return this.shaderDefines=new n$kb(n$Eb.shaderDefines)}]),n$i}(n$Eb),n$Nb=function(n$a){function n$g(n$a,n$b,n$c,n$d,n$e){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===n$c&&(n$c=35044),void 0===n$d&&(n$d=!1),n$g.__super.call(this),this._indexType=n$a,this._indexCount=n$b,this._bufferUsage=n$c,this._bufferType=34963,this._canRead=n$d;var n$f;if("ushort"==n$a)this._indexTypeByteCount=2;else{if("ubyte"!=n$a)throw new Error("unidentification index type.");this._indexTypeByteCount=1}n$f=this._indexTypeByteCount*n$b,this._byteLength=n$f,this._bind(),n$h._gl.bufferData(this._bufferType,n$f,this._bufferUsage),this.uri=n$e,n$d?("ushort"==n$a?this._buffer=new Uint16Array(n$b):"ubyte"==n$a&&(this._buffer=new Uint8Array(n$b)),this.memorySize=2*n$f):this.memorySize=n$f}n$n(n$g,"laya.d3.graphics.IndexBuffer3D",n$a);var n$b=n$g.prototype;return n$b.setData=function(n$a,n$b,n$c,n$d){void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=4294967295);var n$e=0;if("ushort"==this._indexType?(n$e=2,0===n$c&&4294967295===n$d||(n$a=new Uint16Array(n$a.buffer,n$c*n$e,n$d))):"ubyte"==this._indexType&&(n$e=1,0===n$c&&4294967295===n$d||(n$a=new Uint8Array(n$a.buffer,n$c*n$e,n$d))),this._bind(),n$h._gl.bufferSubData(this._bufferType,n$b*n$e,n$a),this._canRead)if(0!==n$b||0!==n$c||4294967295!==n$d){var n$f=this._buffer.length-n$b;n$f<n$d&&(n$d=n$f);for(var n$g=0;n$g<n$d;n$g++)this._buffer[n$b+n$g]=n$a[n$g]}else this._buffer=n$a},n$b.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},n$b.disposeResource=function(){n$a.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},n$o(0,n$b,"indexType",function(){return this._indexType}),n$o(0,n$b,"indexTypeByteCount",function(){return this._indexTypeByteCount}),n$o(0,n$b,"indexCount",function(){return this._indexCount}),n$o(0,n$b,"canRead",function(){return this._canRead}),n$g.INDEXTYPE_UBYTE="ubyte",n$g.INDEXTYPE_USHORT="ushort",n$g.create=function(n$a,n$b,n$c,n$d,n$e){return void 0===n$c&&(n$c=35044),void 0===n$d&&(n$d=!1),new n$g(n$a,n$b,n$c,n$d,n$e)},n$g}(n$h),n$Ob=function(n$f){function n$g(n$a,n$b,n$c,n$d,n$e){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===n$d&&(n$d=!1),n$g.__super.call(this),this._vertexDeclaration=n$a,this._vertexCount=n$b,this._bufferUsage=n$c,this._bufferType=34962,this._canRead=n$d,this.uri=n$e,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*n$b,this._bind(),n$h._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),n$d&&(this._buffer=new Float32Array(this._byteLength/4))}n$n(n$g,"laya.d3.graphics.VertexBuffer3D",n$f);var n$a=n$g.prototype;return n$a.bindWithIndexBuffer=function(n$a){n$a&&n$a._bind(),this._bind()},n$a.setData=function(n$a,n$b,n$c,n$d){if(void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=4294967295),0===n$c&&4294967295===n$d||(n$a=new Float32Array(n$a.buffer,4*n$c,n$d)),this._bind(),n$h._gl.bufferSubData(this._bufferType,4*n$b,n$a),this._canRead)if(0!==n$b||0!==n$c||4294967295!==n$d){var n$e=this._buffer.length-n$b;n$e<n$d&&(n$d=n$e);for(var n$f=0;n$f<n$d;n$f++)this._buffer[n$b+n$f]=n$a[n$f]}else this._buffer=n$a},n$a.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},n$a.disposeResource=function(){for(var n$a=n$F.mainContext,n$b=this._vertexDeclaration.getVertexElements(),n$c=n$h._enableAtributes,n$d=0,n$e=n$b.length;n$d<n$e;n$d++)n$c[n$d]===this._glBuffer&&(n$a.disableVertexAttribArray(n$d),n$c[n$d]=null);n$f.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},n$o(0,n$a,"vertexDeclaration",function(){return this._vertexDeclaration}),n$o(0,n$a,"vertexCount",function(){return this._vertexCount}),n$o(0,n$a,"canRead",function(){return this._canRead}),n$g.create=function(n$a,n$b,n$c,n$d,n$e){return void 0===n$c&&(n$c=35044),void 0===n$d&&(n$d=!1),new n$g(n$a,n$b,n$c,n$d,n$e)},n$g}(n$h),n$Pb=function(n$a){function n$t(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,n$t.__super.call(this),this._type=3553}n$n(n$t,"laya.d3.resource.DataTexture2D",n$Fb);var n$b=n$t.prototype;return n$b.genDebugMipmaps=function(){var n$a=[];return n$a.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),n$a.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),n$a.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),n$a.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),n$a.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),n$a.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),n$a.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),n$a.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),n$a.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),n$a.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),n$a},n$b._onTextureLoaded=function(n$a){},n$b._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var n$a=n$F.mainContext,n$b=this._source=n$a.createTexture(),n$c=this._width,n$d=this._height,n$e=n$G.curBindTexTarget,n$f=n$G.curBindTexValue,n$g=!1;if(n$G.bindTexture(n$a,this._type,n$b),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var n$h=0;n$a.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var n$i=0;n$i<this._mipmaps.length;n$i++){if(this._mipmaps[n$i].byteLength!=n$j*n$k*4)throw"mipmap size error  level:"+n$i;n$a.texSubImage2D(this._type,0,n$t.simLodRect[n$h++],n$t.simLodRect[n$h++],n$t.simLodRect[n$h++],n$t.simLodRect[n$h++],6408,5121,new Uint8Array(this._mipmaps[n$i]))}this.minFifter=9729,this.magFifter=9729}else{var n$j=this._width,n$k=this._height;for(n$h=0,n$a.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),n$i=0;n$i<this._mipmaps.length;n$i++){if(this._mipmaps[n$i].byteLength!=n$j*n$k*4)throw"mipmap size error  level:"+n$i;n$a.texImage2D(this._type,n$i,6408,n$j,n$k,0,6408,5121,new Uint8Array(this._mipmaps[n$i])),(n$j/=2)<1&&(n$j=1),(n$k/=2)<1&&(n$k=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&n$a.pixelStorei(n$a.UNPACK_ALIGNMENT,1),n$a.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var n$l=0,n$m=!1,n$n=!1;this._buffer.byteLength==4*n$c*n$d?(n$l=6408,n$m=!0):this._buffer.byteLength==3*n$c*n$d?(n$l=6407,n$n=!0):n$l=this._format,n$m||n$n?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),n$n&&n$a.pixelStorei(n$a.UNPACK_ALIGNMENT,1),n$a.texImage2D(this._type,0,n$l,n$c,n$d,0,n$l,5121,this._buffer)):n$a&&n$l==n$a.ALPHA?(n$a.texImage2D(3553,0,n$l,n$c,n$d,0,n$l,n$a.UNSIGNED_BYTE,this._buffer),n$g=!0):0!=n$l&&(n$a.compressedTexImage2D(3553,0,n$l,n$c,n$d,0,this._buffer),n$g=!0)}var n$o=this._minFifter,n$p=this._magFifter,n$q=0==this._wrapModeU?10497:33071,n$r=0==this._wrapModeV?10497:33071,n$s=n$u.isPOT(n$c,n$d);n$s?(this._mipmap||this._mipmaps?-1!==n$o||(n$o=9987):-1!==n$o||(n$o=9729),-1!==n$p||(n$p=9729),n$a.texParameteri(this._type,10241,n$o),n$a.texParameteri(this._type,10240,n$p),n$a.texParameteri(this._type,10242,n$q),n$a.texParameteri(this._type,10243,n$r),this._mipmap&&n$a.generateMipmap(this._type)):(-1!==n$o||(n$o=9729),-1!==n$p||(n$p=9729),n$a.texParameteri(this._type,10241,n$o),n$a.texParameteri(this._type,10240,n$p),n$a.texParameteri(this._type,10242,33071),n$a.texParameteri(this._type,10243,33071)),n$e&&n$f&&n$G.bindTexture(n$a,n$e,n$f),this.memorySize=n$g?this._buffer.length:n$s?n$c*n$d*4*(1+1/3):n$c*n$d*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},n$b.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},n$b.onAsynLoaded=function(n$a,n$b,n$c){var n$d;n$c&&(n$d=n$c[0].call(this,n$b)),n$d&&(this._width=n$d.width,this._height=n$d.height,this._buffer=n$d.data),this._src=n$a,this._size=new n$pb(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},n$b.getPixels=function(){return new Uint8Array(this._buffer)},n$b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(n$F.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},n$o(0,n$b,"src",function(){return this._src}),n$t.create=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){if(void 0===n$d&&(n$d=9729),void 0===n$e&&(n$e=9729),void 0===n$f&&(n$f=!0),!n$a||n$a.byteLength<n$b*n$c*4)throw"DataTexture2D create error";var n$h=new n$t;return n$h.uri=n$g,n$h._buffer=n$a,n$h._width=n$b,n$h._height=n$c,n$h._mipmap=n$f,n$h._magFifter=n$d,n$h._minFifter=n$e,n$h._size=new n$pb(n$h._width,n$h._height),n$h._conchTexture?alert("怎么给runtime传递datatexture数据"):n$h.activeResource(),n$h},n$t.load=function(n$a,n$b,n$c,n$d,n$e){if(void 0===n$b&&(n$b=0),void 0===n$c&&(n$c=0),void 0===n$d&&(n$d=9729),void 0===n$e&&(n$e=9729),"mipmaps"===n$C.getFileExtension(n$a)){var n$f=n$v.loader.create(n$a,null,null,n$t,[function(n$a){this._mipmaps=[];var n$b=new Uint32Array(n$a);this._width=n$b[0];var n$c=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,n$c=1024),this._width!=n$c)throw"现在只支持512x256的环境贴图。当前的是"+n$b[0];this._height=n$b[1];for(var n$d=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,n$e=this._height,n$f=8;;){var n$g=n$d*n$e*4;if(n$f+n$g>n$a.byteLength)throw"load mipmaps data size error ";var n$h=new Uint8Array(n$a,n$f,n$g);if(this._mipmaps.push(n$h),n$f+=n$g,1==n$d&&1==n$e)break;(n$d/=2)<1&&(n$d=1),(n$e/=2)<1&&(n$e=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){n$f.simLodInfo=new Float32Array(40);for(var n$g=0;n$g<n$f.simLodInfo.length;)n$f.simLodInfo[n$g]=(n$t.simLodRect[n$g]+.5)/1024,n$g++,n$f.simLodInfo[n$g]=(n$t.simLodRect[n$g]+.5)/256,n$g++,n$f.simLodInfo[n$g]=Math.max(n$t.simLodRect[n$g]-1,.1)/1024,n$g++,n$f.simLodInfo[n$g]=Math.max(n$t.simLodRect[n$g]-1.5,.1)/256,n$g++}return n$f}if("number"==typeof n$b)return n$v.loader.create(n$a,null,null,n$t,[function(n$a){return this._width=n$b,this._height=n$c,this._buffer=n$a,null}]);if("function"==typeof n$b)return n$v.loader.create(n$a,null,null,n$t,[n$b]);throw new Error("unknown params.")},n$t.lodasatlas=!1,n$l(n$t,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),n$t}(),n$Qb=function(n$a){function n$b(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,n$b.__super.call(this)}n$n(n$b,"laya.d3.resource.models.PrimitiveMesh",n$Gb);var n$c=n$b.prototype;return n$v.imps(n$c,{"laya.d3.core.render.IRenderable":!0}),n$c._getVertexBuffer=function(n$a){return void 0===n$a&&(n$a=0),0===n$a?this._vertexBuffer:null},n$c._getVertexBuffers=function(){return null},n$c._getIndexBuffer=function(){return this._indexBuffer},n$c._getPositions=function(){var n$a,n$b=[],n$c=this._vertexBuffer.vertexDeclaration.getVertexElements(),n$d=0;for(n$d=0;n$d<n$c.length;n$d++){var n$e=n$c[n$d];if("vector3"===n$e.elementFormat&&0===n$e.elementUsage){n$a=n$e;break}}var n$f=this._vertexBuffer.getData();for(n$d=0;n$d<n$f.length;n$d+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var n$g=n$d+n$a.offset/4,n$h=new n$gb(n$f[n$g+0],n$f[n$g+1],n$f[n$g+2]);n$b.push(n$h)}return n$b},n$c.getRenderElement=function(n$a){return this},n$c.getRenderElementsCount=function(){return 1},n$c.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},n$c._beforeRender=function(n$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},n$c._render=function(n$a){n$F.mainContext.drawElements(4,this._numberIndices,5123,0),n$y.drawCall++,n$y.trianglesFaces+=this._numberIndices/3},n$o(0,n$c,"_vertexBufferCount",function(){return 1}),n$o(0,n$c,"triangleCount",function(){return this._indexBuffer.indexCount/3}),n$b}(),n$Rb=function(n$a){function n$b(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,n$b.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}n$n(n$b,"laya.d3.resource.models.Mesh",n$Gb);var n$c=n$b.prototype;return n$c._getPositions=function(){var n$a,n$b,n$c,n$d,n$e,n$f=[],n$g=0,n$h=0,n$i=0;if(0!==this._vertexBuffers.length){var n$j=this._vertexBuffers.length;for(n$g=0;n$g<n$j;n$g++){for(n$c=(n$a=this._vertexBuffers[n$g]).vertexDeclaration.getVertexElements(),n$h=0;n$h<n$c.length;n$h++)if("vector3"===(n$d=n$c[n$h]).elementFormat&&0===n$d.elementUsage){n$b=n$d;break}for(n$e=n$a.getData(),n$h=0;n$h<n$e.length;n$h+=n$a.vertexDeclaration.vertexStride/4)n$i=n$h+n$b.offset/4,n$f.push(new n$gb(n$e[n$i+0],n$e[n$i+1],n$e[n$i+2]))}}else{var n$k=this._subMeshes.length;for(n$g=0;n$g<n$k;n$g++){for(n$c=(n$a=this._subMeshes[n$g]._getVertexBuffer()).vertexDeclaration.getVertexElements(),n$h=0;n$h<n$c.length;n$h++)if("vector3"===(n$d=n$c[n$h]).elementFormat&&0===n$d.elementUsage){n$b=n$d;break}for(n$e=n$a.getData(),n$h=0;n$h<n$e.length;n$h+=n$a.vertexDeclaration.vertexStride/4)n$i=n$h+n$b.offset/4,n$f.push(new n$gb(n$e[n$i+0],n$e[n$i+1],n$e[n$i+2]))}}return n$f},n$c._setSubMeshes=function(n$a){this._subMeshes=n$a,this._subMeshCount=n$a.length;for(var n$b=0;n$b<this._subMeshCount;n$b++)n$a[n$b]._indexInMesh=n$b;this._positions=this._getPositions(),this._generateBoundingObject()},n$c.onAsynLoaded=function(n$a,n$b,n$c){var n$d=n$b[0],n$e=n$b[1];n$Ya.read(n$d,this,this._materials,this._subMeshes,n$e),this.completeCreate(),this._endLoaded()},n$c.getSubMesh=function(n$a){return this._subMeshes[n$a]},n$c.getSubMeshCount=function(){return this._subMeshes.length},n$c.getRenderElementsCount=function(){return this._subMeshes.length},n$c.getRenderElement=function(n$a){return this._subMeshes[n$a]},n$c.disposeResource=function(){for(var n$a=0;n$a<this._subMeshes.length;n$a++)this._subMeshes[n$a].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},n$o(0,n$c,"materials",function(){return this._materials.slice()}),n$o(0,n$c,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),n$b.load=function(n$a){return n$v.loader.create(n$a,null,null,n$b)},n$b}(),n$Sb=(function(n$a){function n$j(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===n$c&&(n$c=6408),void 0===n$d&&(n$d=5121),void 0===n$e&&(n$e=33189),void 0===n$f&&(n$f=!1),void 0===n$g&&(n$g=!1),void 0===n$h&&(n$h=-1),void 0===n$i&&(n$i=-1),n$j.__super.call(this),this._type=3553,this._width=n$a,this._height=n$b,this._size=new n$pb(n$a,n$b),this._surfaceFormat=n$c,this._surfaceType=n$d,this._depthStencilFormat=n$e,n$p.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=n$f,this._repeat=n$g,this._minFifter=n$h,this._magFifter=n$i,this.activeResource(),this._alreadyResolved=!0}n$n(n$j,"laya.d3.resource.RenderTexture",n$Fb);var n$b=n$j.prototype;n$b.recreateResource=function(){var n$a=n$F.mainContext;this._frameBuffer=n$a.createFramebuffer(),this._source=n$a.createTexture();var n$b=n$G.curBindTexTarget,n$c=n$G.curBindTexValue;n$G.bindTexture(n$a,this._type,this._source),n$a.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var n$d=this._minFifter,n$e=this._magFifter,n$f=this._repeat?10497:33071;if(n$u.isPOT(this._width,this._height)?(this._mipmap?-1!==n$d||(n$d=9987):-1!==n$d||(n$d=9729),-1!==n$e||(n$e=9729),n$a.texParameteri(this._type,10241,n$d),n$a.texParameteri(this._type,10240,n$e),n$a.texParameteri(this._type,10242,n$f),n$a.texParameteri(this._type,10243,n$f),this._mipmap&&n$a.generateMipmap(this._type)):(-1!==n$d||(n$d=9729),-1!==n$e||(n$e=9729),n$a.texParameteri(this._type,10241,n$d),n$a.texParameteri(this._type,10240,n$e),n$a.texParameteri(this._type,10242,33071),n$a.texParameteri(this._type,10243,33071)),n$b&&n$c&&n$G.bindTexture(n$a,n$b,n$c),n$a.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=n$a.createRenderbuffer(),n$a.bindRenderbuffer(36161,this._depthStencilBuffer),n$a.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),n$a.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:n$a.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:n$a.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:n$a.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}n$a.framebufferTexture2D(36160,36064,3553,this._source,0),n$a.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},n$b.start=function(){n$F.mainContext.bindFramebuffer(36160,this.frameBuffer),(n$j._currentRenderTarget=this)._alreadyResolved=!1},n$b.end=function(){n$F.mainContext.bindFramebuffer(36160,null),n$j._currentRenderTarget=null,this._alreadyResolved=!0},n$b.getData=function(n$a,n$b,n$c,n$d){var n$e=n$F.mainContext;if(n$e.bindFramebuffer(36160,this._frameBuffer),!(36053===n$e.checkFramebufferStatus(36160)))return n$e.bindFramebuffer(36160,null),null;var n$f=new Uint8Array(this._width*this._height*4);return n$e.readPixels(n$a,n$b,n$c,n$d,this._surfaceFormat,this._surfaceType,n$f),n$e.bindFramebuffer(36160,null),n$f},n$b.disposeResource=function(){if(this._frameBuffer){var n$a=n$F.mainContext;n$a.deleteTexture(this._source),n$a.deleteFramebuffer(this._frameBuffer),n$a.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},n$o(0,n$b,"surfaceFormat",function(){return this._surfaceFormat}),n$o(0,n$b,"surfaceType",function(){return this._surfaceType}),n$o(0,n$b,"depthStencilFormat",function(){return this._depthStencilFormat}),n$o(0,n$b,"source",function(){return this._alreadyResolved?n$v.superGet(n$Fb,this,"source"):null}),n$o(0,n$b,"depthStencilBuffer",function(){return this._depthStencilBuffer}),n$o(0,n$b,"frameBuffer",function(){return this._frameBuffer}),n$j._currentRenderTarget=null}(),function(n$a){function n$b(n$a){this._color=null,this._pixels=null,n$b.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new n$pb(this.width,this.height),this._color=n$a,this._pixels=new Uint8Array([255*n$a.x,255*n$a.y,255*n$a.z,255*n$a.w]),this.uri="SolidColorTexture2D_"+this.id}n$n(n$b,"laya.d3.resource.SolidColorTexture2D",n$Fb);var n$c=n$b.prototype;return n$c._createWebGlTexture=function(){var n$a=n$F.mainContext,n$b=this._source=n$a.createTexture(),n$c=this._width,n$d=this._height,n$e=n$G.curBindTexTarget,n$f=n$G.curBindTexValue;n$G.bindTexture(n$a,this._type,n$b),n$a.texImage2D(this._type,0,6408,n$c,n$d,0,6408,5121,this._pixels);var n$g=this._minFifter,n$h=this._magFifter,n$i=this._repeat?10497:33071,n$j=n$u.isPOT(n$c,n$d);n$j?(this._mipmap?-1!==n$g||(n$g=9987):-1!==n$g||(n$g=9729),-1!==n$h||(n$h=9729),n$a.texParameteri(this._type,10241,n$g),n$a.texParameteri(this._type,10240,n$h),n$a.texParameteri(this._type,10242,n$i),n$a.texParameteri(this._type,10243,n$i),this._mipmap&&n$a.generateMipmap(this._type)):(-1!==n$g||(n$g=9729),-1!==n$h||(n$h=9729),n$a.texParameteri(this._type,10241,n$g),n$a.texParameteri(this._type,10240,n$h),n$a.texParameteri(this._type,10242,33071),n$a.texParameteri(this._type,10243,33071)),n$e&&n$f&&n$G.bindTexture(n$a,n$e,n$f),this.memorySize=n$j?n$c*n$d*4*(1+1/3):n$c*n$d*4},n$c.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},n$c.disposeResource=function(){this._source&&(n$F.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},n$l(n$b,["magentaTexture",function(){var n$a=new n$b(new n$hb(1,0,1,1));return n$a.lock=!0,this.magentaTexture=n$a},"grayTexture",function(){var n$a=new n$b(new n$hb(.5,.5,.5,1));return n$a.lock=!0,this.grayTexture=n$a}]),n$b}()),n$Tb=function(n$a){function n$e(n$a,n$b,n$c,n$d){this._canRead=!1,this._image=null,this._pixels=null,void 0===n$a&&(n$a=!1),void 0===n$b&&(n$b=!0),void 0===n$c&&(n$c=6408),void 0===n$d&&(n$d=!0),n$e.__super.call(this),this._type=3553,this._repeat=n$b,this._canRead=n$a,this._format=n$c,this._mipmap=n$d}n$n(n$e,"laya.d3.resource.Texture2D",n$Fb);var n$b=n$e.prototype;return n$b._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var n$a=n$F.mainContext,n$b=this._source=n$a.createTexture(),n$c=this._width,n$d=this._height,n$e=n$G.curBindTexTarget,n$f=n$G.curBindTexValue;switch(n$G.bindTexture(n$a,this._type,n$b),this._format){case 6407:case 6408:this._canRead?n$a.texImage2D(this._type,0,this._format,n$c,n$d,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?n$a.texImage2D(this._type,0,this._image._format,n$c,n$d,0,this._image._format,5121,this._image.atlasSource):n$a.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case n$F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:n$a.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var n$g=this._minFifter,n$h=this._magFifter,n$i=this._repeat?10497:33071,n$j=0==this._wrapModeU?10497:33071,n$k=0==this._wrapModeV?10497:33071,n$l=n$u.isPOT(n$c,n$d);n$l?(this._mipmap?-1!==n$g||(n$g=9987):-1!==n$g||(n$g=9729),-1!==n$h||(n$h=9729),n$a.texParameteri(this._type,10241,n$g),n$a.texParameteri(this._type,10240,n$h),n$a.texParameteri(this._type,10242,n$i),n$a.texParameteri(this._type,10243,n$i),n$a.texParameteri(this._type,10242,n$j),n$a.texParameteri(this._type,10243,n$k),this._mipmap&&n$a.generateMipmap(this._type)):(-1!==n$g||(n$g=9729),-1!==n$h||(n$h=9729),n$a.texParameteri(this._type,10241,n$g),n$a.texParameteri(this._type,10240,n$h),n$a.texParameteri(this._type,10242,33071),n$a.texParameteri(this._type,10243,33071)),n$e&&n$f&&n$G.bindTexture(n$a,n$e,n$f),this._image.onload=null,this._image=null,this.memorySize=n$l?n$c*n$d*4*(1+1/3):n$c*n$d*4},n$b.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},n$b.onAsynLoaded=function(n$a,n$b,n$c){if(n$c){var n$d=n$c[0];void 0!==n$d&&(this._canRead=n$d);var n$e=n$c[1];void 0!==n$e&&(this._repeat=n$e);var n$f=n$c[2];void 0!==n$f&&(this._format=n$f);var n$g=n$c[3];void 0!==n$g&&(this._mipmap=n$g);var n$h=n$c.wrapModeU;void 0!==n$h&&(this._wrapModeU=n$h);var n$i=n$c.wrapModeV;void 0!==n$i&&(this._wrapModeV=n$i)}switch(this._format){case 6407:case 6408:var n$j=(this._image=n$b).width,n$k=n$b.height;this._width=n$j,this._height=n$k,this._size=new n$pb(n$j,n$k),this._canRead&&(n$p.isConchApp?n$b instanceof n$m.HTMLElement&&(this._pixels=new Uint8Array(n$b.getImageData(0,0,n$j,n$k))):(n$H.canvas.size(n$j,n$k),n$H.canvas.clear(),n$H.context.drawImage(n$b,0,0,n$j,n$k),this._pixels=new Uint8Array(n$H.context.getImageData(0,0,n$j,n$k).data.buffer)));break;case n$F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var n$l=new n$w(n$b);n$l.readUTFBytes(4),n$l.readUTFBytes(2),n$l.getInt16();n$l.endian="bigEndian",this._width=n$l.getInt16(),this._height=n$l.getInt16(),this._size=new n$pb(this._width,this._height);n$l.getInt16(),n$l.getInt16();this._image=new Uint8Array(n$b,n$l.pos)}this.recreateResource(),this._endLoaded()},n$b.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},n$b.disposeResource=function(){this._source&&(n$F.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},n$o(0,n$b,"_src",function(){return this.url}),n$o(0,n$b,"src",function(){return this.url}),n$e.load=function(n$a){return n$v.loader.create(n$a,null,null,n$e)},n$e}(),n$Ub=function(n$b){function n$c(n$a,n$b){n$c.__super.call(this),void 0===n$a&&(n$a=.3),void 0===n$b&&(n$b=1e3),this._tempVector3=new n$gb,this._position=new n$gb,this._up=new n$gb,this._forward=new n$gb,this._right=new n$gb,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=n$pb.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=n$a,this._farPlane=n$b,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),n$v.stage.on("resize",this,this._onScreenSizeChanged)}n$n(n$c,"laya.d3.core.BaseCamera",n$b);var n$a=n$c.prototype;return n$a._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var n$a=this.scene._cameraPool,n$b=n$a.length-1,n$c=0;n$c<n$b;n$c++)if(n$a[n$c].renderingOrder>n$a[n$b].renderingOrder){var n$d=n$a[n$c];n$a[n$c]=n$a[n$b],n$a[n$b]=n$d}},n$a._calculateProjectionMatrix=function(){},n$a._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},n$a._prepareCameraToRender=function(){n$I._currentCameraCullingMask=this.cullingMask;var n$a=this._shaderValues;n$a.setValue(0,this.transform.position.elements),n$a.setValue(5,this.forward.elements),n$a.setValue(6,this.up.elements)},n$a._prepareCameraViewProject=function(n$a,n$b){var n$c=this._shaderValues;n$c.setValue(1,n$a.elements),n$c.setValue(2,n$b.elements)},n$a._renderCamera=function(n$a,n$b,n$c){},n$a.addLayer=function(n$a){29!==n$a.number&&30!=n$a.number&&(this.cullingMask=this.cullingMask|n$a.mask)},n$a.removeLayer=function(n$a){29!==n$a.number&&30!=n$a.number&&(this.cullingMask=this.cullingMask&~n$a.mask)},n$a.addAllLayers=function(){this.cullingMask=2147483647},n$a.removeAllLayers=function(){this.cullingMask=0|n$I.getLayerByNumber(29).mask|n$I.getLayerByNumber(30).mask},n$a.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},n$a.moveForward=function(n$a){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=n$a,this.transform.translate(this._tempVector3)},n$a.moveRight=function(n$a){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=n$a,this.transform.translate(this._tempVector3)},n$a.moveVertical=function(n$a){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=n$a,this.transform.translate(this._tempVector3,!1)},n$a._addSelfRenderObjects=function(){var n$a=this.scene._cameraPool,n$b=n$a.length;if(0<n$b){for(var n$c=n$b-1;0<=n$c;n$c--)if(this.renderingOrder<=n$a[n$c].renderingOrder){n$a.splice(n$c+1,0,this);break}}else n$a.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},n$a._clearSelfRenderObjects=function(){var n$a=this.scene._cameraPool;n$a.splice(n$a.indexOf(this),1)},n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,n$v.stage.off("resize",this,this._onScreenSizeChanged),n$b.prototype.destroy.call(this,n$a)},n$o(0,n$a,"sky",function(){return this._sky},function(n$a){(this._sky=n$a)._ownerCamera=this}),n$o(0,n$a,"forward",function(){var n$a=this.transform.worldMatrix.elements,n$b=this._forward.elements;return n$b[0]=-n$a[8],n$b[1]=-n$a[9],n$b[2]=-n$a[10],this._forward}),n$o(0,n$a,"position",function(){var n$a=this.transform.worldMatrix.elements,n$b=this._position.elements;return n$b[0]=n$a[12],n$b[1]=n$a[13],n$b[2]=n$a[14],this._position}),n$o(0,n$a,"renderTarget",function(){return this._renderTarget},function(n$a){null!=(this._renderTarget=n$a)&&(this._renderTargetSize=n$a.size)}),n$o(0,n$a,"up",function(){var n$a=this.transform.worldMatrix.elements,n$b=this._up.elements;return n$b[0]=n$a[4],n$b[1]=n$a[5],n$b[2]=n$a[6],this._up}),n$o(0,n$a,"right",function(){var n$a=this.transform.worldMatrix.elements,n$b=this._right.elements;return n$b[0]=n$a[0],n$b[1]=n$a[1],n$b[2]=n$a[2],this._right}),n$o(0,n$a,"renderTargetSize",function(){return this._renderTargetSize},function(n$a){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=n$a,this._calculateProjectionMatrix()}),n$o(0,n$a,"fieldOfView",function(){return this._fieldOfView},function(n$a){this._fieldOfView=n$a,this._calculateProjectionMatrix()}),n$o(0,n$a,"nearPlane",function(){return this._nearPlane},function(n$a){this._nearPlane=n$a,this._calculateProjectionMatrix()}),n$o(0,n$a,"farPlane",function(){return this._farPlane},function(n$a){this._farPlane=n$a,this._calculateProjectionMatrix()}),n$o(0,n$a,"orthographic",function(){return this._orthographic},function(n$a){this._orthographic=n$a,this._calculateProjectionMatrix()}),n$o(0,n$a,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(n$a){this._orthographicVerticalSize=n$a,this._calculateProjectionMatrix()}),n$o(0,n$a,"renderingOrder",function(){return this._renderingOrder},function(n$a){this._renderingOrder=n$a,this._sortCamerasByRenderingOrder()}),n$c.CAMERAPOS=0,n$c.VIEWMATRIX=1,n$c.PROJECTMATRIX=2,n$c.VPMATRIX=3,n$c.VPMATRIX_NO_TRANSLATE=4,n$c.CAMERADIRECTION=5,n$c.CAMERAUP=6,n$c.ENVIRONMENTDIFFUSE=7,n$c.ENVIRONMENTSPECULAR=8,n$c.SIMLODINFO=9,n$c.DIFFUSEIRRADMATR=10,n$c.DIFFUSEIRRADMATG=11,n$c.DIFFUSEIRRADMATB=12,n$c.HDREXPOSURE=13,n$c.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",n$c.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",n$c.CLEARFLAG_SOLIDCOLOR=0,n$c.CLEARFLAG_SKY=1,n$c.CLEARFLAG_DEPTHONLY=2,n$c.CLEARFLAG_NONE=3,n$l(n$c,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new n$ab(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new n$ab},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new n$ab}]),n$c}(n$Kb),n$Vb=function(n$c){function n$b(n$a){this._render=null,this._geometryFilter=null,n$b.__super.call(this,n$a)}n$n(n$b,"laya.d3.core.RenderableSprite3D",n$c);var n$a=n$b.prototype;return n$a._addToInitStaticBatchManager=function(){},n$a._setBelongScene=function(n$a){n$c.prototype._setBelongScene.call(this,n$a),n$a._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},n$a._setUnBelongScene=function(){var n$a=this._scene._renderableSprite3Ds,n$b=n$a.indexOf(this);n$a.splice(n$b,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),n$c.prototype._setUnBelongScene.call(this)},n$a._update=function(n$a){(n$a.owner=this)._activeInHierarchy&&(this._updateComponents(n$a),this._render._updateOctreeNode(),this._lateUpdateComponents(n$a),n$y.spriteCount++,this._childs.length&&this._updateChilds(n$a))},n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),n$c.prototype.destroy.call(this,n$a),this._render._destroy(),this._render=null},n$b.__init__=function(){n$b.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=n$b.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),n$b.SAHDERDEFINE_LIGHTMAP=n$b.shaderDefines.registerDefine("LIGHTMAP")},n$b.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,n$b.SAHDERDEFINE_LIGHTMAP=4,n$b.LIGHTMAPSCALEOFFSET=2,n$b.LIGHTMAP=3,n$l(n$b,["shaderDefines",function(){return this.shaderDefines=new n$kb}]),n$b}(n$Kb),n$Wb=(function(n$a){function n$d(n$a,n$b,n$c){this._long=NaN,this._width=NaN,this._height=NaN,void 0===n$a&&(n$a=1),void 0===n$b&&(n$b=1),void 0===n$c&&(n$c=1),n$d.__super.call(this),this._long=n$a,this._width=n$b,this._height=n$c,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}n$n(n$d,"laya.d3.resource.models.BoxMesh",n$Qb);var n$b=n$d.prototype;n$b.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var n$a=n$Fa.vertexDeclaration,n$b=(n$a.vertexStride,this._long/2),n$c=this._height/2,n$d=this._width/2,n$e=new Float32Array([-n$b,n$c,-n$d,0,1,0,0,0,n$b,n$c,-n$d,0,1,0,1,0,n$b,n$c,n$d,0,1,0,1,1,-n$b,n$c,n$d,0,1,0,0,1,-n$b,-n$c,-n$d,0,-1,0,0,1,n$b,-n$c,-n$d,0,-1,0,1,1,n$b,-n$c,n$d,0,-1,0,1,0,-n$b,-n$c,n$d,0,-1,0,0,0,-n$b,n$c,-n$d,-1,0,0,0,0,-n$b,n$c,n$d,-1,0,0,1,0,-n$b,-n$c,n$d,-1,0,0,1,1,-n$b,-n$c,-n$d,-1,0,0,0,1,n$b,n$c,-n$d,1,0,0,1,0,n$b,n$c,n$d,1,0,0,0,0,n$b,-n$c,n$d,1,0,0,0,1,n$b,-n$c,-n$d,1,0,0,1,1,-n$b,n$c,n$d,0,0,1,0,0,n$b,n$c,n$d,0,0,1,1,0,n$b,-n$c,n$d,0,0,1,1,1,-n$b,-n$c,n$d,0,0,1,0,1,-n$b,n$c,-n$d,0,0,-1,1,0,n$b,n$c,-n$d,0,0,-1,0,0,n$b,-n$c,-n$d,0,0,-1,0,1,-n$b,-n$c,-n$d,0,0,-1,1,1]),n$f=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new n$Ob(n$a,this._numberVertices,35044,!0),this._indexBuffer=new n$Nb("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(n$e),this._indexBuffer.setData(n$f),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},n$o(0,n$b,"long",function(){return this._long},function(n$a){this._long!==n$a&&(this._long=n$a,this.releaseResource(),this.activeResource())}),n$o(0,n$b,"width",function(){return this._width},function(n$a){this._width!==n$a&&(this._width=n$a,this.releaseResource(),this.activeResource())}),n$o(0,n$b,"height",function(){return this._height},function(n$a){this._height!==n$a&&(this._height=n$a,this.releaseResource(),this.activeResource())})}(),function(n$a){function n$g(n$a,n$b,n$c){void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=.3),void 0===n$c&&(n$c=1e3),this._viewMatrix=new n$ab,this._projectionMatrix=new n$ab,this._projectionViewMatrix=new n$ab,this._viewport=new n$ib(0,0,0,0),this._normalizedViewport=new n$ib(0,0,1,1),this._aspectRatio=n$a,this._boundFrustumUpdate=!0,this._boundFrustum=new n$$a(n$ab.DEFAULT),n$g.__super.call(this,n$b,n$c),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}n$n(n$g,"laya.d3.core.Camera",n$Ub);var n$b=n$g.prototype;return n$b._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},n$b._parseCustomProps=function(n$a,n$b,n$c,n$d){var n$e=n$c.clearColor;this.clearColor=new n$hb(n$e[0],n$e[1],n$e[2],n$e[3]);var n$f=n$c.viewport;this.normalizedViewport=new n$ib(n$f[0],n$f[1],n$f[2],n$f[3])},n$b._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var n$a=this.orthographicVerticalSize*this.aspectRatio*.5,n$b=.5*this.orthographicVerticalSize;n$ab.createOrthoOffCenterRH(-n$a,n$a,-n$b,n$b,this.nearPlane,this.farPlane,this._projectionMatrix)}else n$ab.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},n$b._update=function(n$a){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,n$a)},n$b._renderCamera=function(n$a,n$b,n$c){var n$d,n$e;n$c.parallelSplitShadowMaps[0]&&n$c._renderShadowMap(n$a,n$b,this),(n$b.camera=this)._prepareCameraToRender(),n$c._preRenderUpdateComponents(n$b),n$d=n$b._viewMatrix=this.viewMatrix;var n$f=this._renderTarget;n$f?(n$f.start(),n$ab.multiply(n$Ub._invertYScaleMatrix,this._projectionMatrix,n$Ub._invertYProjectionMatrix),n$ab.multiply(n$Ub._invertYScaleMatrix,this.projectionViewMatrix,n$Ub._invertYProjectionViewMatrix),n$e=n$b._projectionMatrix=n$Ub._invertYProjectionMatrix,n$b._projectionViewMatrix=n$Ub._invertYProjectionViewMatrix):(n$e=n$b._projectionMatrix=this._projectionMatrix,n$b._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(n$d,n$e),n$b._viewport=this.viewport,n$c._preRenderScene(n$a,n$b,this.boundFrustum),n$c._clear(n$a,n$b),n$c._renderScene(n$a,n$b),n$c._postRenderUpdateComponents(n$b),n$f&&n$f.end()},n$b.viewportPointToRay=function(n$a,n$b){n$ob.calculateCursorRay(n$a,this.viewport,this._projectionMatrix,this.viewMatrix,null,n$b)},n$b.normalizedViewportPointToRay=function(n$a,n$b){var n$c=n$g._tempVector20,n$d=this.viewport,n$e=n$a.elements,n$f=n$c.elements;n$f[0]=n$e[0]*n$d.width,n$f[1]=n$e[1]*n$d.height,n$ob.calculateCursorRay(n$c,this.viewport,this._projectionMatrix,this.viewMatrix,null,n$b)},n$b.worldToViewportPoint=function(n$a,n$b){n$ab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(n$a,this._projectionViewMatrix,n$b);var n$c=n$b.elements;n$c[0]=n$c[0]/n$v.stage.clientScaleX,n$c[1]=n$c[1]/n$v.stage.clientScaleY},n$b.worldToNormalizedViewportPoint=function(n$a,n$b){n$ab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(n$a,this._projectionViewMatrix,n$b);var n$c=n$b.elements;n$c[0]=n$c[0]/n$v.stage.clientScaleX,n$c[1]=n$c[1]/n$v.stage.clientScaleY},n$b.convertScreenCoordToOrthographicCoord=function(n$a,n$b){if(this._orthographic){var n$c=n$Y.clientWidth,n$d=n$Y.clientHeight,n$e=this.orthographicVerticalSize*this.aspectRatio/n$c,n$f=this.orthographicVerticalSize/n$d,n$g=n$a.elements,n$h=n$b.elements;return n$h[0]=(-n$c/2+n$g[0])*n$e,n$h[1]=(n$d/2-n$g[1])*n$f,n$h[2]=(this.nearPlane-this.farPlane)*(n$g[2]+1)/2-this.nearPlane,n$gb.transformCoordinate(n$b,this.transform.worldMatrix,n$b),!0}return!1},n$o(0,n$b,"projectionViewMatrix",function(){return n$ab.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),n$o(0,n$b,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var n$a=this.viewport;return n$a.width/n$a.height},function(n$a){if(n$a<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=n$a,this._calculateProjectionMatrix()}),n$o(0,n$b,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),n$o(0,n$b,"needViewport",function(){var n$a=this.normalizedViewport;return 0===n$a.x&&0===n$a.y&&1===n$a.width&&1===n$a.height}),n$o(0,n$b,"viewport",function(){if(this._viewportExpressedInClipSpace){var n$a=this._normalizedViewport,n$b=this.renderTargetSize,n$c=n$b.width,n$d=n$b.height;this._viewport.x=n$a.x*n$c,this._viewport.y=n$a.y*n$d,this._viewport.width=n$a.width*n$c,this._viewport.height=n$a.height*n$d}return this._viewport},function(n$a){if(null!=this.renderTarget&&(n$a.x<0||n$a.y<0||0==n$a.width||0==n$a.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=n$a,this._calculateProjectionMatrix()}),n$o(0,n$b,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var n$a=this._viewport,n$b=this.renderTargetSize,n$c=n$b.width,n$d=n$b.height;this._normalizedViewport.x=n$a.x/n$c,this._normalizedViewport.y=n$a.y/n$d,this._normalizedViewport.width=n$a.width/n$c,this._normalizedViewport.height=n$a.height/n$d}return this._normalizedViewport},function(n$a){n$a.x<0&&(n$a.x=0,console.warn("Camera: viewport.x must large than 0.0.")),n$a.y<0&&(n$a.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<n$a.x+n$a.width&&(n$a.width=1-n$a.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<n$a.y+n$a.height&&(n$a.height=1-n$a.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=n$a,this._calculateProjectionMatrix()}),n$o(0,n$b,"projectionMatrix",function(){return this._projectionMatrix},function(n$a){this._projectionMatrix=n$a,this._useUserProjectionMatrix=!0}),n$o(0,n$b,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),n$l(n$g,["_tempVector20",function(){return this._tempVector20=new n$fb}]),n$g}()),n$Xb=function(n$c){function n$d(n$a,n$b){n$d.__super.call(this,n$b),this._geometryFilter=new n$Hb(this),this._render=new n$Ib(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),n$a&&(this._geometryFilter.sharedMesh=n$a)instanceof laya.d3.resource.models.Mesh&&(n$a.loaded?this._render.sharedMaterials=n$a.materials:n$a.once("loaded",this,this._applyMeshMaterials))}n$n(n$d,"laya.d3.core.MeshSprite3D",n$c);var n$a=n$d.prototype;return n$a._changeRenderObjectByMesh=function(n$a){var n$b=this._render._renderElements,n$c=n$b[n$a];n$c||(n$c=n$b[n$a]=new n$xb),n$c._render=this._render;var n$d=this._render.sharedMaterials[n$a];n$d||(n$d=n$Mb.defaultMaterial);var n$e=this._geometryFilter.sharedMesh.getRenderElement(n$a);return n$c._mainSortID=this._getSortID(n$e,n$d),n$c._sprite3D=this,n$c.renderObj=n$e,n$c._material=n$d,n$c},n$a._changeRenderObjectByMaterial=function(n$a,n$b){var n$c=this._render._renderElements[n$a];n$b||(n$b=n$Mb.defaultMaterial);var n$d=this._geometryFilter.sharedMesh.getRenderElement(n$a);return n$c._mainSortID=this._getSortID(n$d,n$b),n$c._sprite3D=this,n$c.renderObj=n$d,n$c._material=n$b,n$c},n$a._changeRenderObjectsByMesh=function(){var n$a=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=n$a;for(var n$b=0;n$b<n$a;n$b++)this._changeRenderObjectByMesh(n$b)},n$a._onMeshChanged=function(n$a){var n$b=n$a.sharedMesh;n$b.loaded?this._changeRenderObjectsByMesh():n$b.once("loaded",this,this._onMeshLoaded)},n$a._onMeshLoaded=function(n$a){n$a===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},n$a._onMaterialChanged=function(n$a,n$b,n$c){n$b<this._render._renderElements.length&&this._changeRenderObjectByMaterial(n$b,n$c)},n$a._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},n$a._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},n$a._parseCustomProps=function(n$a,n$b,n$c,n$d){var n$e=this.meshRender,n$f=n$c.lightmapIndex;null!=n$f&&(n$e.lightmapIndex=n$f);var n$g,n$h,n$i=n$c.lightmapScaleOffset;if(n$i&&(n$e.lightmapScaleOffset=new n$hb(n$i[0],n$i[1],n$i[2],n$i[3])),n$d.instanceParams)(n$g=n$d.instanceParams.loadPath)&&(n$h=n$r.getRes(n$b[n$g]),(this.meshFilter.sharedMesh=n$h).loaded?n$e.sharedMaterials=n$h.materials:n$h.once("loaded",this,this._applyMeshMaterials));else{(n$g=n$c.meshPath)&&(n$h=n$r.getRes(n$b[n$g]),this.meshFilter.sharedMesh=n$h);var n$j=n$c.materials;if(n$j){var n$k=n$e.sharedMaterials,n$l=n$j.length;n$k.length=n$l;for(var n$m=0;n$m<n$l;n$m++)n$k[n$m]=n$r.getRes(n$b[n$j[n$m].path]);n$e.sharedMaterials=n$k}}},n$a._applyMeshMaterials=function(n$a){for(var n$b=this._render.sharedMaterials,n$c=n$a.materials,n$d=0,n$e=n$c.length;n$d<n$e;n$d++)n$b[n$d]||(n$b[n$d]=n$c[n$d]);this._render.sharedMaterials=n$b},n$a._addToInitStaticBatchManager=function(){n$d._staticBatchManager._addInitBatchSprite(this)},n$a.cloneTo=function(n$a){var n$b=n$a;n$b._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var n$c=this._render,n$d=n$b._render;n$d.enable=n$c.enable,n$d.sharedMaterials=n$c.sharedMaterials,n$d.castShadow=n$c.castShadow;var n$e=n$c.lightmapScaleOffset;n$e&&(n$d.lightmapScaleOffset=n$e.clone()),n$d.lightmapIndex=n$c.lightmapIndex,n$d.receiveShadow=n$c.receiveShadow,n$d.sortingFudge=n$c.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,n$a)},n$a.destroy=function(n$a){if(void 0===n$a&&(n$a=!0),!this.destroyed){var n$b=this.meshFilter.sharedMesh;null!=n$b&&(n$b.loaded||n$b.off("loaded",this,this._applyMeshMaterials)),n$c.prototype.destroy.call(this,n$a),this._geometryFilter._destroy()}},n$o(0,n$a,"meshFilter",function(){return this._geometryFilter}),n$o(0,n$a,"meshRender",function(){return this._render}),n$d.__init__=function(){n$da._staticBatchManagers.push(n$d._staticBatchManager)},n$d.load=function(n$a){return n$v.loader.create(n$a,null,null,n$d)},n$l(n$d,["_staticBatchManager",function(){return this._staticBatchManager=new n$zb}]),n$d}(n$Vb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(n$a,n$b){"use strict";for(var n$c in Object.defineProperty(n$b,"__esModule",{value:!0}),Laya){var n$d=Laya[n$c];n$d&&n$d.__isclass&&(n$b[n$c]=n$d)}}),function(n$a,n$b,n$ea){n$ea.un,n$ea.uns;var n$c=n$ea.static,n$d=n$ea.class,n$f=n$ea.getset,n$p=n$ea.__newvec,n$h=laya.maths.Bezier,n$l=laya.utils.Browser,n$Fa=laya.utils.Byte,n$e=(laya.events.Event,laya.events.EventDispatcher),n$g=laya.display.Graphics,n$i=(laya.resource.HTMLCanvas,laya.utils.Handler),n$j=laya.net.Loader,n$m=laya.maths.MathUtil,n$Ga=laya.maths.Matrix,n$q=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),n$k=(laya.renders.RenderContext,laya.resource.Resource),n$n=laya.utils.RunDriver,n$fa=laya.display.Sprite,n$o=laya.utils.Stat,n$Ha=laya.resource.Texture,n$r=(laya.net.URL,laya.utils.Utils),n$G=function(){function n$a(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return n$d(n$a,"laya.ani.AnimationContent"),n$a}(),n$H=function(){function n$a(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return n$d(n$a,"laya.ani.AnimationNodeContent"),n$a}(),n$t=function(){function n$a(){}return n$d(n$a,"laya.ani.AnimationParser01"),n$a.parse=function(n$a,n$b){var n$c=n$b.__getBuffer(),n$d=0,n$e=0,n$f=0,n$g=0,n$h=0,n$i=0,n$j=0,n$k=n$b.readUTFString();n$a._aniClassName=n$k;var n$l,n$m=n$b.readUTFString().split("\n"),n$n=n$b.getUint8(),n$o=n$b.getUint32(),n$p=n$b.getUint32();0<n$o&&(n$l=n$c.slice(n$o,n$p));var n$q=new n$Fa(n$l);for(0<n$p&&(n$a._publicExtData=n$c.slice(n$p,n$c.byteLength)),n$a._useParent=!!n$b.getUint8(),n$a._anis.length=n$n,n$d=0;n$d<n$n;n$d++){var n$r=n$a._anis[n$d]=new n$G;n$r.nodes=new Array;var n$s=n$r.name=n$m[n$b.getUint16()];n$a._aniMap[n$s]=n$d,n$r.bone3DMap={},n$r.playTime=n$b.getFloat32(),n$r.playTime<=0&&console.error("播放时间不能为0  url="+n$a.url+" name="+n$r.name);var n$t=n$r.nodes.length=n$b.getUint8();for(n$e=n$r.totalKeyframeDatasLength=0;n$e<n$t;n$e++){var n$u=n$r.nodes[n$e]=new n$H;n$u.childs=[];var n$v=n$b.getInt16();0<=n$v&&(n$u.name=n$m[n$v],n$r.bone3DMap[n$u.name]=n$e),n$u.keyFrame=new Array,n$u.parentIndex=n$b.getInt16(),-1==n$u.parentIndex?n$u.parent=null:n$u.parent=n$r.nodes[n$u.parentIndex],n$u.lerpType=n$b.getUint8();var n$w=n$b.getUint32();n$q.pos=n$w;var n$x=n$u.keyframeWidth=n$q.getUint16();if(n$r.totalKeyframeDatasLength+=n$x,0===n$u.lerpType||1===n$u.lerpType)for(n$u.interpolationMethod=[],n$u.interpolationMethod.length=n$x,n$f=0;n$f<n$x;n$f++)n$u.interpolationMethod[n$f]=n$K.interpolation[n$q.getUint8()];null!=n$u.parent&&n$u.parent.childs.push(n$u);var n$y=n$b.getUint16();0<n$y&&(n$u.extenData=n$c.slice(n$b.pos,n$b.pos+n$y),n$b.pos+=n$y);var n$z,n$C=n$b.getUint16(),n$D=0;for(n$f=0,n$g=n$u.keyFrame.length=n$C;n$f<n$g;n$f++){if((n$z=n$u.keyFrame[n$f]=new n$I).duration=n$b.getFloat32(),n$z.startTime=n$D,2===n$u.lerpType){n$z.interpolationData=[];var n$E,n$F=n$b.getUint8();switch(n$E=n$b.getFloat32()){case 254:for(n$z.interpolationData.length=n$x,n$j=0;n$j<n$x;n$j++)n$z.interpolationData[n$j]=0;break;case 255:for(n$z.interpolationData.length=n$x,n$j=0;n$j<n$x;n$j++)n$z.interpolationData[n$j]=5;break;default:for(n$z.interpolationData.push(n$E),n$i=1;n$i<n$F;n$i++)n$z.interpolationData.push(n$b.getFloat32())}}for(n$z.data=new Float32Array(n$x),n$h=0;n$h<n$x;n$h++)n$z.data[n$h]=n$b.getFloat32(),-1e-8<n$z.data[n$h]&&n$z.data[n$h]<1e-8&&(n$z.data[n$h]=0);n$D+=n$z.duration}n$z.startTime=n$r.playTime,n$u.playTime=n$r.playTime,n$a._calculateKeyFrame(n$u,n$C,n$x)}}},n$a}(),n$u=function(){function n$v(){}return n$d(n$v,"laya.ani.AnimationParser02"),n$v.READ_DATA=function(){n$v._DATA.offset=n$v._reader.getUint32(),n$v._DATA.size=n$v._reader.getUint32()},n$v.READ_BLOCK=function(){for(var n$a=n$v._BLOCK.count=n$v._reader.getUint16(),n$b=n$v._BLOCK.blockStarts=[],n$c=n$v._BLOCK.blockLengths=[],n$d=0;n$d<n$a;n$d++)n$b.push(n$v._reader.getUint32()),n$c.push(n$v._reader.getUint32())},n$v.READ_STRINGS=function(){var n$a=n$v._reader.getUint32(),n$b=n$v._reader.getUint16(),n$c=n$v._reader.pos;n$v._reader.pos=n$a+n$v._DATA.offset;for(var n$d=0;n$d<n$b;n$d++)n$v._strings[n$d]=n$v._reader.readUTFString();n$v._reader.pos=n$c},n$v.parse=function(n$a,n$b){n$v._templet=n$a;(n$v._reader=n$b).__getBuffer();n$v.READ_DATA(),n$v.READ_BLOCK(),n$v.READ_STRINGS();for(var n$c=0,n$d=n$v._BLOCK.count;n$c<n$d;n$c++){var n$e=n$b.getUint16(),n$f=n$v._strings[n$e],n$g=n$v["READ_"+n$f];if(null==n$g)throw new Error("model file err,no this function:"+n$e+" "+n$f);n$g.call()}},n$v.READ_ANIMATIONS=function(){var n$a=n$v._reader,n$b=n$a.__getBuffer(),n$c=0,n$d=0,n$e=0,n$f=0,n$g=n$a.getUint16(),n$h=[];for(n$h.length=n$g,n$c=0;n$c<n$g;n$c++)n$h[n$c]=n$K.interpolation[n$a.getByte()];var n$i=n$a.getUint8();for(n$v._templet._anis.length=n$i,n$c=0;n$c<n$i;n$c++){var n$j=n$v._templet._anis[n$c]={};n$j.nodes=new Array;var n$k=n$j.name=n$v._strings[n$a.getUint16()];n$v._templet._aniMap[n$k]=n$c,n$j.bone3DMap={},n$j.playTime=n$a.getFloat32();var n$l=n$j.nodes.length=n$a.getInt16();for(n$d=n$j.totalKeyframeDatasLength=0;n$d<n$l;n$d++){var n$m=n$j.nodes[n$d]={};n$m.keyframeWidth=n$g,n$m.childs=[];var n$n=n$a.getUint16();0<=n$n&&(n$m.name=n$v._strings[n$n],n$j.bone3DMap[n$m.name]=n$d),n$m.keyFrame=new Array,n$m.parentIndex=n$a.getInt16(),-1==n$m.parentIndex?n$m.parent=null:n$m.parent=n$j.nodes[n$m.parentIndex],n$j.totalKeyframeDatasLength+=n$g,n$m.interpolationMethod=n$h,null!=n$m.parent&&n$m.parent.childs.push(n$m);var n$o=n$a.getUint16(),n$p=null,n$q=null;for(n$e=0,n$f=n$m.keyFrame.length=n$o;n$e<n$f;n$e++){(n$p=n$m.keyFrame[n$e]={}).startTime=n$a.getFloat32(),n$q&&(n$q.duration=n$p.startTime-n$q.startTime);var n$r=n$v._DATA.offset,n$s=n$a.getUint32(),n$t=4*n$g,n$u=n$b.slice(n$r+n$s,n$r+n$s+n$t);n$p.data=new Float32Array(n$u),n$q=n$p}n$p.duration=0,n$m.playTime=n$j.playTime,n$v._templet._calculateKeyFrame(n$m,n$o,n$g)}}},n$v._templet=null,n$v._reader=null,n$v._strings=[],n$c(n$v,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),n$v}(),n$Ia=(function(){function n$a(){}n$d(n$a,"laya.ani.AnimationState"),n$a.stopped=0,n$a.paused=1,n$a.playing=2}(),function(){function n$e(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new n$Va,this.resultMatrix=new n$Ga,this._children=[]}n$d(n$e,"laya.ani.bone.Bone");var n$a=n$e.prototype;return n$a.setTempMatrix=function(n$a){this._tempMatrix=n$a;var n$b,n$c=0;for(n$c=0,n$b=this._children.length;n$c<n$b;n$c++)this._children[n$c].setTempMatrix(this._tempMatrix)},n$a.update=function(n$a){var n$b;if(this.rotation=this.transform.skX,n$a)n$b=this.resultTransform.getMatrix(),n$Ga.mul(n$b,n$a,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)n$b=this.resultTransform.getMatrix(),n$Ga.mul(n$b,this.parentBone.resultMatrix,this.resultMatrix);else{var n$c=this.parentBone,n$d=NaN,n$e=NaN,n$f=NaN,n$g=this.parentBone.resultMatrix;n$b=this.resultTransform.getMatrix();var n$h=n$g.a*n$b.tx+n$g.c*n$b.ty+n$g.tx,n$i=n$g.b*n$b.tx+n$g.d*n$b.ty+n$g.ty,n$j=new n$Ga;this.inheritRotation?(n$d=Math.atan2(n$c.resultMatrix.b,n$c.resultMatrix.a),n$e=Math.cos(n$d),n$f=Math.sin(n$d),n$j.setTo(n$e,n$f,-n$f,n$e,0,0),n$Ga.mul(this._tempMatrix,n$j,n$Ga.TEMP),n$Ga.TEMP.copyTo(n$j),n$b=this.resultTransform.getMatrix(),n$Ga.mul(n$b,n$j,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,n$b=this.resultTransform.getMatrix(),n$Ga.TEMP.identity(),n$Ga.TEMP.d=this.d,n$Ga.mul(n$b,n$Ga.TEMP,this.resultMatrix)),this.resultMatrix.tx=n$h,this.resultMatrix.ty=n$i}else(n$b=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var n$k,n$l=0;for(n$l=0,n$k=this._children.length;n$l<n$k;n$l++)this._children[n$l].update()},n$a.updateChild=function(){var n$a,n$b=0;for(n$b=0,n$a=this._children.length;n$b<n$a;n$b++)this._children[n$b].update()},n$a.setRotation=function(n$a){this._sprite&&(this._sprite.rotation=180*n$a/Math.PI)},n$a.updateDraw=function(n$a,n$b){n$e.ShowBones&&!n$e.ShowBones[this.name]||(this._sprite||(this._sprite=new n$fa,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),n$ea.stage.addChild(this._sprite)),this._sprite.x=n$a+this.resultMatrix.tx,this._sprite.y=n$b+this.resultMatrix.ty);var n$c,n$d=0;for(n$d=0,n$c=this._children.length;n$d<n$c;n$d++)this._children[n$d].updateDraw(n$a,n$b)},n$a.addChild=function(n$a){this._children.push(n$a),n$a.parentBone=this},n$a.findBone=function(n$a){if(this.name==n$a)return this;var n$b,n$c,n$d=0;for(n$d=0,n$b=this._children.length;n$d<n$b;n$d++)if(n$c=this._children[n$d].findBone(n$a))return n$c;return null},n$a.localToWorld=function(n$a){var n$b=n$a[0],n$c=n$a[1];n$a[0]=n$b*this.resultMatrix.a+n$c*this.resultMatrix.c+this.resultMatrix.tx,n$a[1]=n$b*this.resultMatrix.b+n$c*this.resultMatrix.d+this.resultMatrix.ty},n$e.ShowBones={},n$e}()),n$Ja=function(){function n$p(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}n$d(n$p,"laya.ani.bone.BoneSlot");var n$a=n$p.prototype;return n$a.showSlotData=function(n$a,n$b){void 0===n$b&&(n$b=!0),this.currSlotData=n$a,n$b&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},n$a.showDisplayByName=function(n$a){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(n$a))},n$a.replaceDisplayByName=function(n$a,n$b){if(this.currSlotData){var n$c;n$c=this.currSlotData.getDisplayByName(n$a);var n$d;n$d=this.currSlotData.getDisplayByName(n$b),this.replaceDisplayByIndex(n$c,n$d)}},n$a.replaceDisplayByIndex=function(n$a,n$b){this.currSlotData&&(this._replaceDic[n$a]=n$b,this.displayIndex==n$a&&this.showDisplayByIndex(n$a))},n$a.showDisplayByIndex=function(n$a){if(null!=this._replaceDic[n$a]&&(n$a=this._replaceDic[n$a]),this.currSlotData&&-1<n$a&&n$a<this.currSlotData.displayArr.length){if(this.displayIndex=n$a,this.currDisplayData=this.currSlotData.displayArr[n$a],this.currDisplayData){var n$b=this.currDisplayData.name;this.currTexture=this.templet.getTexture(n$b),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!n$q.isConchApp||n$q.isConchApp&&"0.9.15"<n$fa.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},n$a.replaceSkin=function(n$a){this._diyTexture=n$a,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},n$a.setParentMatrix=function(n$a){this._parentMatrix=n$a},n$a.draw=function(n$a,n$b,n$c,n$d){if(void 0===n$c&&(n$c=!1),void 0===n$d&&(n$d=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var n$e,n$f=this.currTexture;switch(this._diyTexture&&(n$f=this._diyTexture),this.currDisplayData.type){case 0:if(n$a){var n$g=this.getDisplayMatrix();if(this._parentMatrix){var n$h=!1;if(n$g){var n$i;if(n$Ga.mul(n$g,this._parentMatrix,n$Ga.TEMP),n$i=n$c?(null==this._resultMatrix&&(this._resultMatrix=new n$Ga),this._resultMatrix):new n$Ga,!n$q.isWebGL&&this.currDisplayData.uvs||n$q.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var n$j=n$p._tempMatrix;n$j.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(n$j.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(n$h=!0,n$j.rotate(-Math.PI/2)),n$Ga.mul(n$j,n$Ga.TEMP,n$i)}else n$Ga.TEMP.copyTo(n$i);n$h?n$a.drawTexture(n$f,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,n$i):n$a.drawTexture(n$f,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,n$i)}}}break;case 1:if(null==(n$e=n$c?(null==this._skinSprite&&(this._skinSprite=n$p.createSkinMesh()),this._skinSprite):n$p.createSkinMesh()))return;var n$k;if(null==this.currDisplayData.bones){var n$l,n$m=this.currDisplayData.weights;this.deformData&&(n$m=this.deformData),n$l=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=n$x.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=n$x.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=n$m;this.currDisplayData.triangles.length;n$k=this.currDisplayData.triangles,n$e.init2(n$f,null,n$k,this._mVerticleArr,n$l);var n$n,n$o=this.getDisplayMatrix();if(this._parentMatrix)if(n$o)n$Ga.mul(n$o,this._parentMatrix,n$Ga.TEMP),n$n=n$c?(null==this._resultMatrix&&(this._resultMatrix=new n$Ga),this._resultMatrix):new n$Ga,n$Ga.TEMP.copyTo(n$n),n$e.transform=n$n}else this.skinMesh(n$b,n$e,n$d);n$a.drawSkin(n$e);break;case 2:if(null==(n$e=n$c?(null==this._skinSprite&&(this._skinSprite=n$p.createSkinMesh()),this._skinSprite):n$p.createSkinMesh()))return;this.skinMesh(n$b,n$e,n$d),n$a.drawSkin(n$e)}}},n$a.skinMesh=function(n$a,n$b,n$c){var n$d,n$e=this.currTexture,n$f=this.currDisplayData.bones;n$d=this._diyTexture?(n$e=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=n$x.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=n$x.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var n$g,n$h,n$i=this.currDisplayData.weights,n$j=this.currDisplayData.triangles,n$k=0,n$l=0,n$m=0,n$n=NaN,n$o=NaN,n$p=0,n$q=0,n$r=[],n$s=0,n$t=0;if(this.deformData&&0<this.deformData.length){var n$u=0;for(n$s=0,n$t=n$f.length;n$s<n$t;){for(n$m=n$f[n$s++]+n$s,n$l=n$k=0;n$s<n$m;n$s++)n$h=n$a[n$f[n$s]],n$n=n$i[n$p]+this.deformData[n$u++],n$o=n$i[n$p+1]+this.deformData[n$u++],n$q=n$i[n$p+2],n$k+=(n$n*n$h.a+n$o*n$h.c+n$h.tx)*n$q,n$l+=(n$n*n$h.b+n$o*n$h.d+n$h.ty)*n$q,n$p+=3;n$r.push(n$k,n$l)}}else for(n$s=0,n$t=n$f.length;n$s<n$t;){for(n$m=n$f[n$s++]+n$s,n$l=n$k=0;n$s<n$m;n$s++)n$h=n$a[n$f[n$s]],n$n=n$i[n$p],n$o=n$i[n$p+1],n$q=n$i[n$p+2],n$k+=(n$n*n$h.a+n$o*n$h.c+n$h.tx)*n$q,n$l+=(n$n*n$h.b+n$o*n$h.d+n$h.ty)*n$q,n$p+=3;n$r.push(n$k,n$l)}this._mVerticleArr=n$r,n$g=n$j,n$b.init2(n$e,null,n$g,this._mVerticleArr,n$d)},n$a.drawBonePoint=function(n$a){n$a&&this._parentMatrix&&n$a.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},n$a.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},n$a.getMatrix=function(){return this._resultMatrix},n$a.copy=function(){var n$a=new n$p;return n$a.type="copy",n$a.name=this.name,n$a.attachmentName=this.attachmentName,n$a.srcDisplayIndex=this.srcDisplayIndex,n$a.parent=this.parent,n$a.displayIndex=this.displayIndex,n$a.templet=this.templet,n$a.currSlotData=this.currSlotData,n$a.currTexture=this.currTexture,n$a.currDisplayData=this.currDisplayData,n$a},n$p.createSkinMesh=function(){return n$q.isWebGL||n$q.isConchApp?n$n.skinAniSprite():(n$q.isWebGL,null)},n$c(n$p,["_tempMatrix",function(){return this._tempMatrix=new n$Ga}]),n$p}(),n$Ka=function(){function n$a(){this.skinName=null,this.deformSlotDataList=[]}return n$d(n$a,"laya.ani.bone.DeformAniData"),n$a}(),n$La=function(){function n$a(){this.deformSlotDisplayList=[]}return n$d(n$a,"laya.ani.bone.DeformSlotData"),n$a}(),n$Ma=function(){function n$a(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}n$d(n$a,"laya.ani.bone.DeformSlotDisplayData");var n$b=n$a.prototype;return n$b.binarySearch1=function(n$a,n$b){var n$c=0,n$d=n$a.length-2;if(0==n$d)return 1;for(var n$e=n$d>>>1;;){if(n$a[Math.floor(n$e+1)]<=n$b?n$c=n$e+1:n$d=n$e,n$c==n$d)return n$c+1;n$e=n$c+n$d>>>1}return 0},n$b.apply=function(n$a,n$b,n$c){if(void 0===n$c&&(n$c=1),n$a+=.05,!(this.timeList.length<=0)){var n$d=0;if(!(n$a<this.timeList[0])){var n$e=this.vectices[0].length,n$f=[],n$g=this.binarySearch1(this.timeList,n$a);if(this.frameIndex=n$g,n$a>=this.timeList[this.timeList.length-1]){var n$h=this.vectices[this.vectices.length-1];if(n$c<1)for(n$d=0;n$d<n$e;n$d++)n$f[n$d]+=(n$h[n$d]-n$f[n$d])*n$c;else for(n$d=0;n$d<n$e;n$d++)n$f[n$d]=n$h[n$d];this.deformData=n$f}else{this.tweenKeyList[this.frameIndex];var n$i=this.vectices[this.frameIndex-1],n$j=this.vectices[this.frameIndex],n$k=this.timeList[this.frameIndex-1],n$l=this.timeList[this.frameIndex];n$c=this.tweenKeyList[n$g-1]?(n$a-n$k)/(n$l-n$k):0;var n$m=NaN;for(n$d=0;n$d<n$e;n$d++)n$m=n$i[n$d],n$f[n$d]=n$m+(n$j[n$d]-n$m)*n$c;this.deformData=n$f}}}},n$a}(),n$Na=function(){function n$a(){this.time=NaN,this.drawOrder=[]}return n$d(n$a,"laya.ani.bone.DrawOrderData"),n$a}(),n$Oa=function(){function n$a(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return n$d(n$a,"laya.ani.bone.EventData"),n$a}(),n$s=function(){function n$da(n$a,n$b){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=n$a,this._targetBone=n$b[n$a.targetBoneIndex],this.isSpine=n$a.isSpine,null==this._bones&&(this._bones=[]);for(var n$c=this._bones.length=0,n$d=n$a.boneIndexs.length;n$c<n$d;n$c++)this._bones.push(n$b[n$a.boneIndexs[n$c]]);this.name=n$a.name,this.mix=n$a.mix,this.bendDirection=n$a.bendDirection}n$d(n$da,"laya.ani.bone.IkConstraint");var n$a=n$da.prototype;return n$a.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},n$a._applyIk1=function(n$a,n$b,n$c,n$d){var n$e=n$a.parentBone,n$f=1/(n$e.resultMatrix.a*n$e.resultMatrix.d-n$e.resultMatrix.b*n$e.resultMatrix.c),n$g=n$b-n$e.resultMatrix.tx,n$h=n$c-n$e.resultMatrix.ty,n$i=(n$g*n$e.resultMatrix.d-n$h*n$e.resultMatrix.c)*n$f-n$a.transform.x,n$j=(n$h*n$e.resultMatrix.a-n$g*n$e.resultMatrix.b)*n$f-n$a.transform.y,n$k=Math.atan2(n$j,n$i)*n$da.radDeg-0-n$a.transform.skX;n$a.transform.scX<0&&(n$k+=180),180<n$k?n$k-=360:n$k<-180&&(n$k+=360),n$a.transform.skX=n$a.transform.skY=n$a.transform.skX+n$k*n$d,n$a.update()},n$a.updatePos=function(n$a,n$b){this._sp&&this._sp.pos(n$a,n$b)},n$a._applyIk2=function(n$a,n$b,n$c,n$d,n$e,n$f){if(0!=n$f){var n$g=n$a.resultTransform.x,n$h=n$a.resultTransform.y,n$i=n$a.transform.scX,n$j=n$a.transform.scY,n$k=n$b.transform.scX,n$l=0,n$m=0,n$n=0;n$n=n$i<0?(n$i=-n$i,n$l=180,-1):(n$l=0,1),n$j<0&&(n$j=-n$j,n$n=-n$n),n$m=n$k<0?(n$k=-n$k,180):0;var n$o=n$b.resultTransform.x,n$p=NaN,n$q=NaN,n$r=NaN,n$s=n$a.resultMatrix.a,n$t=n$a.resultMatrix.c,n$u=n$a.resultMatrix.b,n$v=n$a.resultMatrix.d,n$w=Math.abs(n$i-n$j)<=1e-4;n$r=n$w?(n$q=n$s*n$o+n$t*(n$p=n$b.resultTransform.y)+n$a.resultMatrix.tx,n$u*n$o+n$v*n$p+n$a.resultMatrix.ty):(n$p=0,n$q=n$s*n$o+n$a.resultMatrix.tx,n$u*n$o+n$a.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new n$fa,n$ea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(n$c,n$d,15,"#ffff00"),this._sp.graphics.drawCircle(n$q,n$r,15,"#ff00ff")),n$a.setRotation(Math.atan2(n$r-n$a.resultMatrix.ty,n$q-n$a.resultMatrix.tx));var n$x=n$a.parentBone;n$s=n$x.resultMatrix.a,n$t=n$x.resultMatrix.c,n$u=n$x.resultMatrix.b;var n$y=1/(n$s*(n$v=n$x.resultMatrix.d)-n$t*n$u),n$z=n$c-n$x.resultMatrix.tx,n$C=n$d-n$x.resultMatrix.ty,n$D=(n$z*n$v-n$C*n$t)*n$y-n$g,n$E=(n$C*n$s-n$z*n$u)*n$y-n$h,n$F=((n$z=n$q-n$x.resultMatrix.tx)*n$v-(n$C=n$r-n$x.resultMatrix.ty)*n$t)*n$y-n$g,n$G=(n$C*n$s-n$z*n$u)*n$y-n$h,n$H=Math.sqrt(n$F*n$F+n$G*n$G),n$I=n$b.length*n$k,n$J=NaN,n$K=NaN;if(n$w){var n$L=(n$D*n$D+n$E*n$E-n$H*n$H-(n$I*=n$i)*n$I)/(2*n$H*n$I);n$L<-1?n$L=-1:1<n$L&&(n$L=1),n$K=Math.acos(n$L)*n$e,n$s=n$H+n$I*n$L,n$t=n$I*Math.sin(n$K),n$J=Math.atan2(n$E*n$s-n$D*n$t,n$D*n$s+n$E*n$t)}else{var n$M=(n$s=n$i*n$I)*n$s,n$N=(n$t=n$j*n$I)*n$t,n$O=n$D*n$D+n$E*n$E,n$P=Math.atan2(n$E,n$D),n$Q=-2*n$N*n$H,n$R=n$N-n$M;if(0<(n$v=n$Q*n$Q-4*n$R*(n$u=n$N*n$H*n$H+n$M*n$O-n$M*n$N))){var n$S=Math.sqrt(n$v);n$Q<0&&(n$S=-n$S);var n$T=(n$S=-(n$Q+n$S)/2)/n$R,n$U=n$u/n$S,n$V=Math.abs(n$T)<Math.abs(n$U)?n$T:n$U;n$V*n$V<=n$O&&(n$C=Math.sqrt(n$O-n$V*n$V)*n$e,n$J=n$P-Math.atan2(n$C,n$V),n$K=Math.atan2(n$C/n$j,(n$V-n$H)/n$i))}var n$W=0,n$X=Number.MAX_VALUE,n$Y=0,n$Z=0,n$$=0,n$_=0,n$A=0,n$B=0;n$_<(n$v=(n$z=n$H+n$s)*n$z)&&(n$$=0,n$_=n$v,n$A=n$z),(n$v=(n$z=n$H-n$s)*n$z)<n$X&&(n$W=Math.PI,n$X=n$v,n$Y=n$z);var n$aa=Math.acos(-n$s*n$H/(n$M-n$N));(n$v=(n$z=n$s*Math.cos(n$aa)+n$H)*n$z+(n$C=n$t*Math.sin(n$aa))*n$C)<n$X&&(n$W=n$aa,n$X=n$v,n$Y=n$z,n$Z=n$C),n$_<n$v&&(n$$=n$aa,n$_=n$v,n$A=n$z,n$B=n$C),n$K=n$O<=(n$X+n$_)/2?(n$J=n$P-Math.atan2(n$Z*n$e,n$Y),n$W*n$e):(n$J=n$P-Math.atan2(n$B*n$e,n$A),n$$*n$e)}var n$ba=Math.atan2(n$p,n$o)*n$n,n$ca=n$a.resultTransform.skX;180<(n$J=(n$J-n$ba)*n$da.radDeg+n$l-n$ca)?n$J-=360:n$J<-180&&(n$J+=360),n$a.resultTransform.x=n$g,n$a.resultTransform.y=n$h,n$a.resultTransform.skX=n$a.resultTransform.skY=n$ca+n$J*n$f,n$ca=n$b.resultTransform.skX,180<(n$K=((n$K+n$ba)*n$da.radDeg-0)*n$n+n$m-(n$ca%=360))?n$K-=360:n$K<-180&&(n$K+=360),n$b.resultTransform.x=n$o,n$b.resultTransform.y=n$p,n$b.resultTransform.skX=n$b.resultTransform.skY=n$b.resultTransform.skY+n$K*n$f,n$a.update()}},n$a._applyIk3=function(n$a,n$b,n$c,n$d,n$e,n$f){if(0!=n$f){var n$g,n$h,n$i=n$b.resultMatrix.a*n$b.length,n$j=n$b.resultMatrix.b*n$b.length,n$k=n$i*n$i+n$j*n$j,n$l=Math.sqrt(n$k),n$m=n$a.resultMatrix.tx,n$n=n$a.resultMatrix.ty,n$o=n$b.resultMatrix.tx,n$p=n$b.resultMatrix.ty,n$q=n$o-n$m,n$r=n$p-n$n,n$s=n$q*n$q+n$r*n$r,n$t=Math.sqrt(n$s),n$u=(n$q=n$c-n$a.resultMatrix.tx)*n$q+(n$r=n$d-n$a.resultMatrix.ty)*n$r,n$v=Math.sqrt(n$u);if(n$l+n$t<=n$v||n$v+n$l<=n$t||n$v+n$t<=n$l){var n$w=NaN;n$o=n$m+(n$w=n$l+n$t<=n$v?1:-1)*(n$c-n$m)*n$t/n$v,n$p=n$n+n$w*(n$d-n$n)*n$t/n$v}else{var n$x=(n$s-n$k+n$u)/(2*n$u),n$y=Math.sqrt(n$s-n$x*n$x*n$u)/n$v,n$z=n$m+n$q*n$x,n$C=n$n+n$r*n$x,n$D=-n$r*n$y,n$E=n$q*n$y;n$p=0<n$e?(n$o=n$z-n$D,n$C-n$E):(n$o=n$z+n$D,n$C+n$E)}n$g=n$o,n$h=n$p,this.isDebug&&(this._sp||(this._sp=new n$fa,n$ea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(n$m,n$n,15,"#ff00ff"),this._sp.graphics.drawCircle(n$c,n$d,15,"#ffff00"),this._sp.graphics.drawCircle(n$g,n$h,15,"#ff00ff"));var n$F,n$G;n$F=Math.atan2(n$h-n$a.resultMatrix.ty,n$g-n$a.resultMatrix.tx),n$a.setRotation(n$F),(n$G=n$da._tempMatrix).identity(),n$G.rotate(n$F),n$G.scale(n$a.resultMatrix.getScaleX(),n$a.resultMatrix.getScaleY()),n$G.translate(n$a.resultMatrix.tx,n$a.resultMatrix.ty),n$G.copyTo(n$a.resultMatrix),n$a.updateChild();var n$H,n$I;n$H=Math.atan2(n$d-n$h,n$c-n$g),n$b.setRotation(n$H),(n$I=n$da._tempMatrix).identity(),n$I.rotate(n$H),n$I.scale(n$b.resultMatrix.getScaleX(),n$b.resultMatrix.getScaleY()),n$I.translate(n$g,n$h),n$G.copyTo(n$b.resultMatrix),n$b.updateChild()}},n$c(n$da,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new n$Ga}]),n$da}(),n$Pa=function(){function n$a(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return n$d(n$a,"laya.ani.bone.IkConstraintData"),n$a}(),n$v=function(){function n$I(n$a,n$b){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=n$a,this.position=n$a.position,this.spacing=n$a.spacing,this.rotateMix=n$a.rotateMix,this.translateMix=n$a.translateMix,this.bones=[];for(var n$c=this.data.bones,n$d=0,n$e=n$c.length;n$d<n$e;n$d++)this.bones.push(n$b[n$c[n$d]])}n$d(n$I,"laya.ani.bone.PathConstraint");var n$a=n$I.prototype;return n$a.apply=function(n$a,n$b){if(this.target){var n$c=this.translateMix,n$d=this.translateMix,n$e=0<n$d,n$f=this.data.spacingMode,n$g="length"==n$f,n$h=this.data.rotateMode,n$i="tangent"==n$h,n$j="chainScale"==n$h,n$k=[],n$l=this.bones.length,n$m=n$i?n$l:n$l+1,n$n=[];(this._spaces=n$n)[0]=this.position;var n$o=this.spacing;if(n$j||n$g)for(var n$p=0,n$q=n$m-1;n$p<n$q;){var n$r=this.bones[n$p],n$s=n$r.length,n$t=n$s*n$r.resultMatrix.a,n$u=n$s*n$r.resultMatrix.b;n$s=Math.sqrt(n$t*n$t+n$u*n$u),n$j&&(n$k[n$p]=n$s),n$n[++n$p]=n$g?Math.max(0,n$s+n$o):n$o}else for(n$p=1;n$p<n$m;n$p++)n$n[n$p]=n$o;var n$v=this.computeWorldPositions(this.target,n$a,n$b,n$m,n$i,"percent"==this.data.positionMode,"percent"==n$f);if(this._debugKey){for(n$p=0;n$p<n$v.length;n$p++)n$b.drawCircle(n$v[n$p++],n$v[n$p++],5,"#00ff00");var n$w=[];for(n$p=0;n$p<n$v.length;n$p++)n$w.push(n$v[n$p++],n$v[n$p++]);n$b.drawLines(0,0,n$w,"#ff0000")}var n$x=n$v[0],n$y=n$v[1],n$z=this.data.offsetRotation,n$C="chain"==n$h&&0==n$z,n$D=NaN;for(n$p=0,n$D=3;n$p<n$l;n$p++,n$D+=3){(n$r=this.bones[n$p]).resultMatrix.tx+=(n$x-n$r.resultMatrix.tx)*n$c,n$r.resultMatrix.ty+=(n$y-n$r.resultMatrix.ty)*n$c;var n$E=(n$t=n$v[n$D])-n$x,n$F=(n$u=n$v[n$D+1])-n$y;if(n$j&&0!=(n$s=n$k[n$p])){var n$G=(Math.sqrt(n$E*n$E+n$F*n$F)/n$s-1)*n$d+1;n$r.resultMatrix.a*=n$G,n$r.resultMatrix.c*=n$G}if(n$x=n$t,n$y=n$u,n$e){var n$H=n$r.resultMatrix.a,n$I=n$r.resultMatrix.c,n$J=n$r.resultMatrix.b,n$K=n$r.resultMatrix.d,n$L=NaN,n$M=NaN,n$N=NaN;n$L=n$i?n$v[n$D-1]:0==n$n[n$p+1]?n$v[n$D+2]:Math.atan2(n$F,n$E),n$L-=Math.atan2(n$J,n$H)-n$z/180*Math.PI,n$C&&(n$M=Math.cos(n$L),n$N=Math.sin(n$L),n$x+=((n$s=n$r.length)*(n$M*n$H-n$N*n$J)-n$E)*n$d,n$y+=(n$s*(n$N*n$H+n$M*n$J)-n$F)*n$d),n$L>Math.PI?n$L-=2*Math.PI:n$L<-Math.PI&&(n$L+=2*Math.PI),n$L*=n$d,n$M=Math.cos(n$L),n$N=Math.sin(n$L),n$r.resultMatrix.a=n$M*n$H-n$N*n$J,n$r.resultMatrix.c=n$M*n$I-n$N*n$K,n$r.resultMatrix.b=n$N*n$H+n$M*n$J,n$r.resultMatrix.d=n$N*n$I+n$M*n$K}}}},n$a.computeWorldVertices2=function(n$a,n$b,n$c,n$d,n$e,n$f){var n$g,n$h,n$i=n$a.currDisplayData.bones,n$j=n$a.currDisplayData.weights,n$k=n$a.currDisplayData.triangles,n$l=0,n$m=0,n$n=0,n$o=0,n$p=0,n$q=0,n$r=0,n$s=0,n$t=0,n$u=0,n$v=0;if(null!=n$i){for(n$l=0;n$l<n$c;n$l+=2)n$m+=(n$o=n$i[n$m])+1,n$n+=n$o;var n$w=n$b;for(n$p=n$f,n$q=3*n$n;n$p<n$d;n$p+=2){for(n$s=n$r=0,n$o=n$i[n$m++],n$o+=n$m;n$m<n$o;n$m++,n$q+=3){n$g=n$w[n$i[n$m]].resultMatrix,n$t=n$j[n$q],n$u=n$j[n$q+1];var n$x=n$j[n$q+2];n$r+=(n$t*n$g.a+n$u*n$g.c+n$g.tx)*n$x,n$s+=(n$t*n$g.b+n$u*n$g.d+n$g.ty)*n$x}n$e[n$p]=n$r,n$e[n$p+1]=n$s}}else{var n$y,n$z;if(n$k||(n$k=n$j),n$a.deformData&&(n$k=n$a.deformData),n$y=n$a.parent,n$b)for(n$v=n$b.length,n$l=0;n$l<n$v;n$l++)if(n$b[n$l].name==n$y){n$h=n$b[n$l];break}n$h&&(n$z=n$h.resultMatrix),n$z||(n$z=n$I._tempMt);var n$C=n$z.tx,n$D=n$z.ty,n$E=n$z.a,n$F=n$z.b,n$G=n$z.c,n$H=n$z.d;for(n$h&&(n$H*=n$h.d),n$m=n$c,n$p=n$f;n$p<n$d;n$m+=2,n$p+=2)n$t=n$k[n$m],n$u=n$k[n$m+1],n$e[n$p]=n$t*n$E+n$u*n$F+n$C,n$e[n$p+1]=-(n$t*n$G+n$u*n$H+n$D)}},n$a.computeWorldPositions=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g){n$a.currDisplayData.bones,n$a.currDisplayData.weights,n$a.currDisplayData.triangles;var n$h=[],n$i=0,n$j=n$a.currDisplayData.verLen,n$k=this.position,n$l=this._spaces,n$m=[],n$n=[],n$o=n$j/6,n$p=-1,n$q=NaN,n$r=0,n$s=0,n$t=NaN,n$u=NaN,n$v=NaN,n$w=NaN;if(n$o--,n$j-=4,this.computeWorldVertices2(n$a,n$b,2,n$j,n$h,0),this._debugKey)for(n$i=0;n$i<n$h.length;)n$c.drawCircle(n$h[n$i++],n$h[n$i++],10,"#ff0000");n$m=n$h,this._curves.length=n$o;var n$x=this._curves,n$y=n$m[n$q=0],n$z=n$m[1],n$C=0,n$D=0,n$E=0,n$F=0,n$G=0,n$H=0,n$I=NaN,n$J=NaN,n$K=NaN,n$L=NaN,n$M=NaN,n$N=NaN,n$O=NaN,n$P=NaN,n$Q=0;for(n$i=0,n$Q=2;n$i<n$o;n$i++,n$Q+=6)n$C=n$m[n$Q],n$D=n$m[n$Q+1],n$E=n$m[n$Q+2],n$F=n$m[n$Q+3],n$M=2*(n$I=.1875*(n$y-2*n$C+n$E))+(n$K=.09375*(3*(n$C-n$E)-n$y+(n$G=n$m[n$Q+4]))),n$N=2*(n$J=.1875*(n$z-2*n$D+n$F))+(n$L=.09375*(3*(n$D-n$F)-n$z+(n$H=n$m[n$Q+5]))),n$O=.75*(n$C-n$y)+n$I+.16666667*n$K,n$P=.75*(n$D-n$z)+n$J+.16666667*n$L,n$q+=Math.sqrt(n$O*n$O+n$P*n$P),n$O+=n$M,n$P+=n$N,n$M+=n$K,n$N+=n$L,n$q+=Math.sqrt(n$O*n$O+n$P*n$P),n$O+=n$M,n$P+=n$N,n$q+=Math.sqrt(n$O*n$O+n$P*n$P),n$O+=n$M+n$K,n$P+=n$N+n$L,n$q+=Math.sqrt(n$O*n$O+n$P*n$P),n$x[n$i]=n$q,n$y=n$G,n$z=n$H;if(n$f&&(n$k*=n$q),n$g)for(n$i=0;n$i<n$d;n$i++)n$l[n$i]*=n$q;var n$R=this._segments,n$S=0,n$T=0;for(n$T=n$s=n$r=n$i=0;n$i<n$d;n$i++,n$r+=3)if((n$t=n$k+=n$u=n$l[n$i])<0)this.addBeforePosition(n$t,n$m,0,n$n,n$r);else if(n$q<n$t)this.addAfterPosition(n$t-n$q,n$m,n$j-4,n$n,n$r);else{for(;;n$s++)if(!((n$w=n$x[n$s])<n$t)){0==n$s?n$t/=n$w:n$t=(n$t-(n$v=n$x[n$s-1]))/(n$w-n$v);break}if(n$s!=n$p){var n$U=6*(n$p=n$s);for(n$y=n$m[n$U],n$z=n$m[n$U+1],n$C=n$m[n$U+2],n$D=n$m[n$U+3],n$E=n$m[n$U+4],n$F=n$m[n$U+5],n$M=2*(n$I=.03*(n$y-2*n$C+n$E))+(n$K=.006*(3*(n$C-n$E)-n$y+(n$G=n$m[n$U+6]))),n$N=2*(n$J=.03*(n$z-2*n$D+n$F))+(n$L=.006*(3*(n$D-n$F)-n$z+(n$H=n$m[n$U+7]))),n$O=.3*(n$C-n$y)+n$I+.16666667*n$K,n$P=.3*(n$D-n$z)+n$J+.16666667*n$L,n$S=Math.sqrt(n$O*n$O+n$P*n$P),n$R[0]=n$S,n$U=1;n$U<8;n$U++)n$O+=n$M,n$P+=n$N,n$M+=n$K,n$N+=n$L,n$S+=Math.sqrt(n$O*n$O+n$P*n$P),n$R[n$U]=n$S;n$O+=n$M,n$P+=n$N,n$S+=Math.sqrt(n$O*n$O+n$P*n$P),n$R[8]=n$S,n$O+=n$M+n$K,n$P+=n$N+n$L,n$S+=Math.sqrt(n$O*n$O+n$P*n$P),n$R[9]=n$S,n$T=0}for(n$t*=n$S;;n$T++)if(!((n$w=n$R[n$T])<n$t)){0==n$T?n$t/=n$w:n$t=n$T+(n$t-(n$v=n$R[n$T-1]))/(n$w-n$v);break}this.addCurvePosition(.1*n$t,n$y,n$z,n$C,n$D,n$E,n$F,n$G,n$H,n$n,n$r,n$e||0<n$i&&0==n$u)}return n$n},n$a.addBeforePosition=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$b[n$c],n$g=n$b[n$c+1],n$h=n$b[n$c+2]-n$f,n$i=n$b[n$c+3]-n$g,n$j=Math.atan2(n$i,n$h);n$d[n$e]=n$f+n$a*Math.cos(n$j),n$d[n$e+1]=n$g+n$a*Math.sin(n$j),n$d[n$e+2]=n$j},n$a.addAfterPosition=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$b[n$c+2],n$g=n$b[n$c+3],n$h=n$f-n$b[n$c],n$i=n$g-n$b[n$c+1],n$j=Math.atan2(n$i,n$h);n$d[n$e]=n$f+n$a*Math.cos(n$j),n$d[n$e+1]=n$g+n$a*Math.sin(n$j),n$d[n$e+2]=n$j},n$a.addCurvePosition=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k,n$l){0==n$a&&(n$a=1e-4);var n$m=n$a*n$a,n$n=n$m*n$a,n$o=1-n$a,n$p=n$o*n$o,n$q=n$p*n$o,n$r=n$o*n$a,n$s=3*n$r,n$t=n$o*n$s,n$u=n$s*n$a,n$v=n$b*n$q+n$d*n$t+n$f*n$u+n$h*n$n,n$w=n$c*n$q+n$e*n$t+n$g*n$u+n$i*n$n;n$j[n$k]=n$v,n$j[n$k+1]=n$w,n$j[n$k+2]=n$l?Math.atan2(n$w-(n$c*n$p+n$e*n$r*2+n$g*n$m),n$v-(n$b*n$p+n$d*n$r*2+n$f*n$m)):0},n$I.NONE=-1,n$I.BEFORE=-2,n$I.AFTER=-3,n$c(n$I,["_tempMt",function(){return this._tempMt=new n$Ga}]),n$I}(),n$Qa=function(){function n$a(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return n$d(n$a,"laya.ani.bone.PathConstraintData"),n$a}(),n$Ra=function(){function n$a(){this.name=null,this.slotArr=[]}return n$d(n$a,"laya.ani.bone.SkinData"),n$a}(),n$Sa=function(){function n$a(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}n$d(n$a,"laya.ani.bone.SkinSlotDisplayData");var n$b=n$a.prototype;return n$b.createTexture=function(n$a){return this.texture||(this.texture=new n$Ha(n$a.bitmap,this.uvs),n$a.bitmap.alphaTexture&&(this.texture.alphaTexture=new n$Ha(n$a.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=n$a.height,this.texture.height=n$a.width,this.texture.offsetX=-n$a.offsetX,this.texture.offsetY=-n$a.offsetY,this.texture.sourceWidth=n$a.sourceHeight,this.texture.sourceHeight=n$a.sourceWidth):(this.texture.width=n$a.width,this.texture.height=n$a.height,this.texture.offsetX=-n$a.offsetX,this.texture.offsetY=-n$a.offsetY,this.texture.sourceWidth=n$a.sourceWidth,this.texture.sourceHeight=n$a.sourceHeight),n$q.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},n$b.destory=function(){this.texture&&this.texture.destroy()},n$a}(),n$Ta=function(){function n$a(){this.name=null,this.displayArr=[]}return n$d(n$a,"laya.ani.bone.SlotData"),n$a.prototype.getDisplayByName=function(n$a){for(var n$b=0,n$c=this.displayArr.length;n$b<n$c;n$b++)if(this.displayArr[n$b].attachmentName==n$a)return n$b;return-1},n$a}(),n$w=function(){function n$a(n$a,n$b){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=n$p(2,0),this._data=n$a,null==this._bones&&(this._bones=[]),this.target=n$b[n$a.targetIndex];var n$c,n$d=0;for(n$d=0,n$c=n$a.boneIndexs.length;n$d<n$c;n$d++)this._bones.push(n$b[n$a.boneIndexs[n$d]]);this.rotateMix=n$a.rotateMix,this.translateMix=n$a.translateMix,this.scaleMix=n$a.scaleMix,this.shearMix=n$a.shearMix}return n$d(n$a,"laya.ani.bone.TfConstraint"),n$a.prototype.apply=function(){for(var n$a,n$b=this.target.resultMatrix.a,n$c=this.target.resultMatrix.b,n$d=this.target.resultMatrix.c,n$e=this.target.resultMatrix.d,n$f=0,n$g=this._bones.length;n$f<n$g;n$f++){if(n$a=this._bones[n$f],0<this.rotateMix){var n$h=n$a.resultMatrix.a,n$i=n$a.resultMatrix.b,n$j=n$a.resultMatrix.c,n$k=n$a.resultMatrix.d,n$l=Math.atan2(n$d,n$b)-Math.atan2(n$j,n$h)+this._data.offsetRotation*Math.PI/180;n$l>Math.PI?n$l-=2*Math.PI:n$l<-Math.PI&&(n$l+=2*Math.PI),n$l*=this.rotateMix;var n$m=Math.cos(n$l),n$n=Math.sin(n$l);n$a.resultMatrix.a=n$m*n$h-n$n*n$j,n$a.resultMatrix.b=n$m*n$i-n$n*n$k,n$a.resultMatrix.c=n$n*n$h+n$m*n$j,n$a.resultMatrix.d=n$n*n$i+n$m*n$k}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),n$a.resultMatrix.tx+=(this._temp[0]-n$a.resultMatrix.tx)*this.translateMix,n$a.resultMatrix.ty+=(this._temp[1]-n$a.resultMatrix.ty)*this.translateMix,n$a.updateChild()),0<this.scaleMix){var n$o=Math.sqrt(n$a.resultMatrix.a*n$a.resultMatrix.a+n$a.resultMatrix.c*n$a.resultMatrix.c),n$p=Math.sqrt(n$b*n$b+n$d*n$d),n$q=1e-5<n$o?(n$o+(n$p-n$o+this._data.offsetScaleX)*this.scaleMix)/n$o:0;n$a.resultMatrix.a*=n$q,n$a.resultMatrix.c*=n$q,n$o=Math.sqrt(n$a.resultMatrix.b*n$a.resultMatrix.b+n$a.resultMatrix.d*n$a.resultMatrix.d),n$p=Math.sqrt(n$c*n$c+n$e*n$e),n$q=1e-5<n$o?(n$o+(n$p-n$o+this._data.offsetScaleY)*this.scaleMix)/n$o:0,n$a.resultMatrix.b*=n$q,n$a.resultMatrix.d*=n$q}if(0<this.shearMix){n$i=n$a.resultMatrix.b,n$k=n$a.resultMatrix.d;var n$r=Math.atan2(n$k,n$i);(n$l=Math.atan2(n$e,n$c)-Math.atan2(n$d,n$b)-(n$r-Math.atan2(n$a.resultMatrix.c,n$a.resultMatrix.a)))>Math.PI?n$l-=2*Math.PI:n$l<-Math.PI&&(n$l+=2*Math.PI),n$l=n$r+(n$l+this._data.offsetShearY*Math.PI/180)*this.shearMix,n$q=Math.sqrt(n$i*n$i+n$k*n$k),n$a.resultMatrix.b=Math.cos(n$l)*n$q,n$a.resultMatrix.d=Math.sin(n$l)*n$q}}},n$a}(),n$Ua=function(){function n$a(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return n$d(n$a,"laya.ani.bone.TfConstraintData"),n$a}(),n$Va=function(){function n$a(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}n$d(n$a,"laya.ani.bone.Transform");var n$b=n$a.prototype;return n$b.initData=function(n$a){null!=n$a.x&&(this.x=n$a.x),null!=n$a.y&&(this.y=n$a.y),null!=n$a.skX&&(this.skX=n$a.skX),null!=n$a.skY&&(this.skY=n$a.skY),null!=n$a.scX&&(this.scX=n$a.scX),null!=n$a.scY&&(this.scY=n$a.scY)},n$b.getMatrix=function(){var n$a;return(n$a=this.mMatrix?this.mMatrix:this.mMatrix=new n$Ga).identity(),n$a.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(n$a,this.skewX*Math.PI/180,this.skewY*Math.PI/180),n$a.rotate(this.skX*Math.PI/180),n$a.translate(this.x,this.y),n$a},n$b.skew=function(n$a,n$b,n$c){var n$d=Math.sin(n$c),n$e=Math.cos(n$c),n$f=Math.sin(n$b),n$g=Math.cos(n$b);return n$a.setTo(n$a.a*n$g-n$a.b*n$d,n$a.a*n$f+n$a.b*n$e,n$a.c*n$g-n$a.d*n$d,n$a.c*n$f+n$a.d*n$e,n$a.tx*n$g-n$a.ty*n$d,n$a.tx*n$f+n$a.ty*n$e),n$a},n$a}(),n$x=function(){function n$a(){}return n$d(n$a,"laya.ani.bone.UVTools"),n$a.getRelativeUV=function(n$a,n$b,n$c){var n$d=n$a[0],n$e=n$a[2]-n$a[0],n$f=n$a[1],n$g=n$a[5]-n$a[1];n$c||(n$c=[]),n$c.length=n$b.length;var n$h,n$i=0;n$h=n$c.length;var n$j=1/n$e,n$k=1/n$g;for(n$i=0;n$i<n$h;n$i+=2)n$c[n$i]=(n$b[n$i]-n$d)*n$j,n$c[n$i+1]=(n$b[n$i+1]-n$f)*n$k;return n$c},n$a.getAbsoluteUV=function(n$a,n$b,n$c){if(0==n$a[0]&&0==n$a[1]&&1==n$a[4]&&1==n$a[5])return n$c?(n$r.copyArray(n$c,n$b),n$c):n$b;var n$d=n$a[0],n$e=n$a[2]-n$a[0],n$f=n$a[1],n$g=n$a[5]-n$a[1];n$c||(n$c=[]),n$c.length=n$b.length;var n$h,n$i=0;for(n$h=n$c.length,n$i=0;n$i<n$h;n$i+=2)n$c[n$i]=n$b[n$i]*n$e+n$d,n$c[n$i+1]=n$b[n$i+1]*n$g+n$f;return n$c},n$a}(),n$I=function(){function n$a(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return n$d(n$a,"laya.ani.KeyFramesContent"),n$a}(),n$y=function(){function n$k(){}return n$d(n$k,"laya.ani.math.BezierLerp"),n$k.getBezierRate=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$k._getBezierParamKey(n$b,n$c,n$d,n$e),n$g=100*n$f+n$a;if(n$k._bezierResultCache[n$g])return n$k._bezierResultCache[n$g];var n$h,n$i=n$k._getBezierPoints(n$b,n$c,n$d,n$e,n$f),n$j=0;for(n$h=n$i.length,n$j=0;n$j<n$h;n$j+=2)if(n$a<=n$i[n$j])return n$k._bezierResultCache[n$g]=n$i[n$j+1],n$i[n$j+1];return n$k._bezierResultCache[n$g]=1},n$k._getBezierParamKey=function(n$a,n$b,n$c,n$d){return 100*(100*(100*(100*n$a+n$b)+n$c)+n$d)},n$k._getBezierPoints=function(n$a,n$b,n$c,n$d,n$e){return n$k._bezierPointsCache[n$e]?n$k._bezierPointsCache[n$e]:(n$f=[0,0,n$a,n$b,n$c,n$d,1,1],n$g=(new n$h).getBezierPoints(n$f,100,3),n$k._bezierPointsCache[n$e]=n$g);var n$f,n$g},n$k._bezierResultCache={},n$k._bezierPointsCache={},n$k}(),n$z=function(n$a){function n$b(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,n$b.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}n$d(n$b,"laya.ani.AnimationPlayer",n$e);var n$c=n$b.prototype;return n$ea.imps(n$c,{"laya.resource.IDestroy":!0}),n$c._onTempletLoadedComputeFullKeyframeIndices=function(n$a,n$b,n$c){this._templet===n$c&&this._cachePlayRate===n$a&&this._cacheFrameRate===n$b&&this._computeFullKeyframeIndices()},n$c._computeFullKeyframeIndices=function(){for(var n$a=this._fullFrames=[],n$b=this._templet,n$c=this._cacheFrameRateInterval*this._cachePlayRate,n$d=0,n$e=n$b.getAnimationCount();n$d<n$e;n$d++){for(var n$f=[],n$g=0,n$h=n$b.getAnimation(n$d).nodes.length;n$g<n$h;n$g++){for(var n$i=n$b.getAnimation(n$d).nodes[n$g],n$j=Math.floor(n$i.playTime/n$c+.01),n$k=new Uint16Array(n$j+1),n$l=-1,n$m=0,n$n=n$i.keyFrame.length;n$m<n$n;n$m++){var n$o=n$i.keyFrame[n$m],n$p=n$o.startTime,n$q=n$p+n$o.duration+n$c;do{for(var n$r=Math.floor(n$p/n$c+.5),n$s=n$l+1;n$s<n$r;n$s++)n$k[n$s]=n$m;n$k[n$l=n$r]=n$m,n$p+=n$c}while(n$p<=n$q)}n$f.push(n$k)}n$a.push(n$f)}},n$c._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},n$c._calculatePlayDuration=function(){if(0!==this.state){var n$a=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=n$a),this._playEnd>n$a&&(this._playEnd=n$a),this._playDuration=this._playEnd-this._playStart}},n$c._setPlayParams=function(n$a,n$b){this._currentTime=n$a,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/n$b+.01),0),this._currentFrameTime=this._currentKeyframeIndex*n$b},n$c._setPlayParamsWhenStop=function(n$a,n$b){this._currentTime=n$a,this._currentKeyframeIndex=Math.max(Math.floor(n$a/n$b+.01),0),this._currentFrameTime=this._currentKeyframeIndex*n$b,this._currentAnimationClipIndex=-1},n$c._update=function(n$a){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var n$b=this._cacheFrameRateInterval*this._cachePlayRate,n$c=0;this._startUpdateLoopCount!==n$o.loopCount&&(n$c=n$a*this.playbackRate,this._elapsedPlaybackTime+=n$c);var n$d=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=n$d)return this._setPlayParamsWhenStop(n$d,n$b),void this.event("stopped");if(n$c+=this._currentTime,0<n$d)if(n$d<=n$c)do{if(n$c-=n$d,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(n$d,n$b),this._stopWhenCircleFinish=!1,void this.event("stopped");n$c<n$d&&(this._setPlayParams(n$c,n$b),this.event("complete"))}while(n$d<=n$c);else this._setPlayParams(n$c,n$b);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(n$d,n$b),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},n$c._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},n$c.play=function(n$a,n$b,n$c,n$d,n$e){if(void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=1),void 0===n$c&&(n$c=2147483647),void 0===n$d&&(n$d=0),void 0===n$e&&(n$e=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(n$c<0||n$d<0||n$e<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==n$e&&n$e<n$d)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=n$b,this._overallDuration=n$c,this._playStart=n$d,this._playEnd=n$e,this._paused=!1,this._currentAnimationClipIndex=n$a,this._currentKeyframeIndex=0,this._startUpdateLoopCount=n$o.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},n$c.playByFrame=function(n$a,n$b,n$c,n$d,n$e,n$f){void 0===n$a&&(n$a=0),void 0===n$b&&(n$b=1),void 0===n$c&&(n$c=2147483647),void 0===n$d&&(n$d=0),void 0===n$e&&(n$e=0),void 0===n$f&&(n$f=30);var n$g=1e3/n$f;this.play(n$a,n$b,n$c,n$d*n$g,n$e*n$g)},n$c.stop=function(n$a){void 0===n$a&&(n$a=!0),n$a?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},n$f(0,n$c,"playEnd",function(){return this._playEnd}),n$f(0,n$c,"templet",function(){return this._templet},function(n$a){0===!this.state&&this.stop(!0),this._templet!==n$a&&((this._templet=n$a).loaded?this._computeFullKeyframeIndices():n$a.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),n$f(0,n$c,"playStart",function(){return this._playStart}),n$f(0,n$c,"playDuration",function(){return this._playDuration}),n$f(0,n$c,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),n$f(0,n$c,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),n$f(0,n$c,"overallDuration",function(){return this._overallDuration}),n$f(0,n$c,"currentFrameTime",function(){return this._currentFrameTime}),n$f(0,n$c,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),n$f(0,n$c,"currentPlayTime",function(){return this._currentTime+this._playStart}),n$f(0,n$c,"cachePlayRate",function(){return this._cachePlayRate},function(n$a){this._cachePlayRate!==n$a&&(this._cachePlayRate=n$a,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[n$a,this._cacheFrameRate])))}),n$f(0,n$c,"cacheFrameRate",function(){return this._cacheFrameRate},function(n$a){this._cacheFrameRate!==n$a&&(this._cacheFrameRate=n$a,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,n$a])))}),n$f(0,n$c,"currentTime",null,function(n$a){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(n$a<this._playStart||n$a>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=n$o.loopCount;var n$b=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=n$a,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/n$b),0),this._currentFrameTime=this._currentKeyframeIndex*n$b}}),n$f(0,n$c,"paused",function(){return this._paused},function(n$a){(this._paused=n$a)&&this.event("paused")}),n$f(0,n$c,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),n$f(0,n$c,"destroyed",function(){return this._destroyed}),n$b}(),n$J=function(n$a){function n$b(){n$b.__super.call(this),n$q.isConchNode&&(this.drawSkin=function(n$a){n$a.transform||(n$a.transform=n$Ga.EMPTY),this._addCmd([n$a]),this.setSkinMesh&&this.setSkinMesh(n$a._ps,n$a.mVBData,n$a.mEleNum,0,n$a.mTexture,n$a.transform)})}return n$d(n$b,"laya.ani.GraphicsAni",n$g),n$b.prototype.drawSkin=function(n$a){var n$b=[n$a];this._saveToCmd(n$q._context._drawSkin,n$b)},n$b.create=function(){return n$b._caches.pop()||new n$b},n$b.recycle=function(n$a){n$a.clear(),n$b._caches.push(n$a)},n$b._caches=[],n$b}(),n$K=function(n$a){function n$s(){this._aniMap={},this.unfixedLastAniIndex=-1,n$s.__super.call(this),this._anis=new Array}n$d(n$s,"laya.ani.AnimationTemplet",n$k);var n$b=n$s.prototype;return n$b.parse=function(n$a){var n$b=new n$Fa(n$a);this._aniVersion=n$b.readUTFString(),n$t.parse(this,n$b)},n$b._calculateKeyFrame=function(n$a,n$b,n$c){var n$d=n$a.keyFrame;n$d[n$b]=n$d[0];for(var n$e=0;n$e<n$b;n$e++){var n$f=n$d[n$e];n$f.nextData=0===n$f.duration?n$f.data:n$d[n$e+1].data}n$d.length--},n$b.onAsynLoaded=function(n$a,n$b,n$c){var n$d=new n$Fa(n$b);switch(this._aniVersion=n$d.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":n$u.parse(this,n$d);break;default:n$t.parse(this,n$d)}this._endLoaded()},n$b.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},n$b.getAnimationCount=function(){return this._anis.length},n$b.getAnimation=function(n$a){return this._anis[n$a]},n$b.getAniDuration=function(n$a){return this._anis[n$a].playTime},n$b.getNodes=function(n$a){return this._anis[n$a].nodes},n$b.getNodeIndexWithName=function(n$a,n$b){return this._anis[n$a].bone3DMap[n$b]},n$b.getNodeCount=function(n$a){return this._anis[n$a].nodes.length},n$b.getTotalkeyframesLength=function(n$a){return this._anis[n$a].totalKeyframeDatasLength},n$b.getPublicExtData=function(){return this._publicExtData},n$b.getAnimationDataWithCache=function(n$a,n$b,n$c,n$d){var n$e=n$b[n$c];if(n$e){var n$f=n$e[n$a];return n$f?n$f[n$d]:null}return null},n$b.setAnimationDataWithCache=function(n$a,n$b,n$c,n$d,n$e){var n$f=n$b[n$c]||(n$b[n$c]={});(n$f[n$a]||(n$f[n$a]=[]))[n$d]=n$e},n$b.getOriginalData=function(n$a,n$b,n$c,n$d,n$e){for(var n$f=this._anis[n$a].nodes,n$g=0,n$h=0,n$i=n$f.length,n$j=0;n$h<n$i;n$h++){var n$k,n$l=n$f[n$h];n$k=n$l.keyFrame[n$c[n$h][n$d]],n$l.dataOffset=n$j;var n$m=n$e-n$k.startTime,n$n=n$l.lerpType;if(n$n)switch(n$n){case 0:case 1:for(n$g=0;n$g<n$l.keyframeWidth;)n$g+=n$l.interpolationMethod[n$g](n$l,n$g,n$b,n$j+n$g,n$k.data,n$m,null,n$k.duration,n$k.nextData);break;case 2:var n$o=n$k.interpolationData,n$p=n$o.length,n$q=0;for(n$g=0;n$g<n$p;){var n$r=n$o[n$g];switch(n$r){case 6:case 7:n$g+=n$s.interpolation[n$r](n$l,n$q,n$b,n$j+n$q,n$k.data,n$m,null,n$k.duration,n$k.nextData,n$o,n$g+1);break;default:n$g+=n$s.interpolation[n$r](n$l,n$q,n$b,n$j+n$q,n$k.data,n$m,null,n$k.duration,n$k.nextData)}n$q++}}else for(n$g=0;n$g<n$l.keyframeWidth;)n$g+=n$l.interpolationMethod[n$g](n$l,n$g,n$b,n$j+n$g,n$k.data,n$m,null,n$k.duration,n$k.nextData);n$j+=n$l.keyframeWidth}},n$b.getNodesCurrentFrameIndex=function(n$a,n$b){var n$c=this._anis[n$a].nodes;n$a!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(n$c.length),this.unfixedCurrentTimes=new Float32Array(n$c.length),this.unfixedLastAniIndex=n$a);for(var n$d=0,n$e=n$c.length;n$d<n$e;n$d++){var n$f=n$c[n$d];for(n$b<this.unfixedCurrentTimes[n$d]&&(this.unfixedCurrentFrameIndexes[n$d]=0),this.unfixedCurrentTimes[n$d]=n$b;this.unfixedCurrentFrameIndexes[n$d]<n$f.keyFrame.length&&!(n$f.keyFrame[this.unfixedCurrentFrameIndexes[n$d]].startTime>this.unfixedCurrentTimes[n$d]);)this.unfixedCurrentFrameIndexes[n$d]++;this.unfixedCurrentFrameIndexes[n$d]--}return this.unfixedCurrentFrameIndexes},n$b.getOriginalDataUnfixedRate=function(n$a,n$b,n$c){var n$d=this._anis[n$a].nodes;n$a!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(n$d.length),this.unfixedCurrentTimes=new Float32Array(n$d.length),this.unfixedKeyframes=n$p(n$d.length),this.unfixedLastAniIndex=n$a);for(var n$e=0,n$f=0,n$g=n$d.length,n$h=0;n$f<n$g;n$f++){var n$i=n$d[n$f];for(n$c<this.unfixedCurrentTimes[n$f]&&(this.unfixedCurrentFrameIndexes[n$f]=0),this.unfixedCurrentTimes[n$f]=n$c;this.unfixedCurrentFrameIndexes[n$f]<n$i.keyFrame.length&&!(n$i.keyFrame[this.unfixedCurrentFrameIndexes[n$f]].startTime>this.unfixedCurrentTimes[n$f]);)this.unfixedKeyframes[n$f]=n$i.keyFrame[this.unfixedCurrentFrameIndexes[n$f]],this.unfixedCurrentFrameIndexes[n$f]++;var n$j=this.unfixedKeyframes[n$f];n$i.dataOffset=n$h;var n$k=n$c-n$j.startTime;if(n$i.lerpType)switch(n$i.lerpType){case 0:case 1:for(n$e=0;n$e<n$i.keyframeWidth;)n$e+=n$i.interpolationMethod[n$e](n$i,n$e,n$b,n$h+n$e,n$j.data,n$k,null,n$j.duration,n$j.nextData);break;case 2:var n$l=n$j.interpolationData,n$m=n$l.length,n$n=0;for(n$e=0;n$e<n$m;){var n$o=n$l[n$e];switch(n$o){case 6:case 7:n$e+=n$s.interpolation[n$o](n$i,n$n,n$b,n$h+n$n,n$j.data,n$k,null,n$j.duration,n$j.nextData,n$l,n$e+1);break;default:n$e+=n$s.interpolation[n$o](n$i,n$n,n$b,n$h+n$n,n$j.data,n$k,null,n$j.duration,n$j.nextData)}n$n++}}else for(n$e=0;n$e<n$i.keyframeWidth;)n$e+=n$i.interpolationMethod[n$e](n$i,n$e,n$b,n$h+n$e,n$j.data,n$k,null,n$j.duration,n$j.nextData);n$h+=n$i.keyframeWidth}},n$s._LinearInterpolation_0=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){var n$k=0===n$h?0:n$f/n$h;return n$c[n$d]=(1-n$k)*n$e[n$b]+n$k*n$i[n$b],1},n$s._QuaternionInterpolation_1=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){var n$k=0===n$h?0:n$f/n$h;return n$m.slerpQuaternionArray(n$e,n$b,n$i,n$b,n$k,n$c,n$d),4},n$s._AngleInterpolation_2=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){return 0},n$s._RadiansInterpolation_3=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){return 0},n$s._Matrix4x4Interpolation_4=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){for(var n$k=0;n$k<16;n$k++,n$b++)n$c[n$d+n$k]=n$e[n$b]+n$f*n$g[n$b];return 16},n$s._NoInterpolation_5=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j){return n$c[n$d]=n$e[n$b],1},n$s._BezierInterpolation_6=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k){return void 0===n$k&&(n$k=0),n$c[n$d]=n$e[n$b]+(n$i[n$b]-n$e[n$b])*n$y.getBezierRate(n$f/n$h,n$j[n$k],n$j[n$k+1],n$j[n$k+2],n$j[n$k+3]),5},n$s._BezierInterpolation_7=function(n$a,n$b,n$c,n$d,n$e,n$f,n$g,n$h,n$i,n$j,n$k){return void 0===n$k&&(n$k=0),n$c[n$d]=n$j[n$k+4]+n$j[n$k+5]*n$y.getBezierRate((.001*n$f+n$j[n$k+6])/n$j[n$k+7],n$j[n$k],n$j[n$k+1],n$j[n$k+2],n$j[n$k+3]),9},n$s.load=function(n$a){return n$ea.loader.create(n$a,null,null,n$s)},n$s.interpolation=[n$s._LinearInterpolation_0,n$s._QuaternionInterpolation_1,n$s._AngleInterpolation_2,n$s._RadiansInterpolation_3,n$s._Matrix4x4Interpolation_4,n$s._NoInterpolation_5,n$s._BezierInterpolation_6,n$s._BezierInterpolation_7],n$s}(),n$C=function(n$b){function n$c(n$a,n$b){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,n$c.__super.call(this),void 0===n$b&&(n$b=0),n$a&&this.init(n$a,n$b)}n$d(n$c,"laya.ani.bone.Skeleton",n$b);var n$a=n$c.prototype;return n$a.init=function(n$a,n$b){void 0===n$b&&(n$b=0);var n$c,n$d,n$e,n$f=0,n$g=0;if(1==n$b)for(this._graphicsCache=[],n$f=0,n$g=n$a.getAnimationCount();n$f<n$g;n$f++)this._graphicsCache.push([]);if(this._yReverseMatrix=n$a.yReverseMatrix,this._aniMode=n$b,this._templet=n$a,this._player=new n$z,this._player.cacheFrameRate=n$a.rate,this._player.templet=n$a,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=n$a.mBoneArr,this._rootBone=n$a.mRootBone,this._aniSectionDic=n$a.aniSectionDic,0<n$a.ikArr.length)for(this._ikArr=[],n$f=0,n$g=n$a.ikArr.length;n$f<n$g;n$f++)this._ikArr.push(new n$s(n$a.ikArr[n$f],this._boneList));if(0<n$a.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),n$f=0,n$g=n$a.pathArr.length;n$f<n$g;n$f++)n$c=n$a.pathArr[n$f],n$d=new n$v(n$c,this._boneList),(n$e=this._boneSlotDic[n$c.name])&&((n$d=new n$v(n$c,this._boneList)).target=n$e),this._pathDic[n$c.name]=n$d;if(0<n$a.tfArr.length)for(this._tfArr=[],n$f=0,n$g=n$a.tfArr.length;n$f<n$g;n$f++)this._tfArr.push(new n$w(n$a.tfArr[n$f],this._boneList));if(0<n$a.skinDataArray.length){var n$h=this._templet.skinDataArray[this._skinIndex];this._skinName=n$h.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},n$a.load=function(n$a,n$b,n$c){},n$a._onLoaded=function(){},n$a._parseComplete=function(){var n$a=n$D.TEMPLET_DICTIONARY[this._aniPath];n$a&&(this.init(n$a,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},n$a._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},n$a._onPlay=function(){this.event("played")},n$a._onStop=function(){var n$a,n$b=this._templet.eventAniArr[this._aniClipIndex];if(n$b&&this._eventIndex<n$b.length)for(;this._eventIndex<n$b.length;this._eventIndex++)(n$a=n$b[this._eventIndex]).time>=this._player.playStart&&n$a.time<=this._player.playEnd&&this.event("label",n$a);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},n$a._onPause=function(){this.event("paused")},n$a._parseSrcBoneMatrix=function(){var n$a=0,n$b=0;for(n$b=this._templet.srcBoneMatrixArr.length,n$a=0;n$a<n$b;n$a++)this._boneMatrixArray.push(new n$Ga);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var n$c,n$d,n$e=this._templet.boneSlotArray;for(n$a=0,n$b=n$e.length;n$a<n$b;n$a++)n$c=n$e[n$a],null==(n$d=this._bindBoneBoneSlotDic[n$c.parent])&&(this._bindBoneBoneSlotDic[n$c.parent]=n$d=[]),this._boneSlotDic[n$c.name]=n$c=n$c.copy(),n$d.push(n$c),this._boneSlotArray.push(n$c)}},n$a._emitMissedEvents=function(n$a,n$b,n$c){void 0===n$c&&(n$c=0);var n$d=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(n$d){var n$e,n$f,n$g=0;for(n$e=n$d.length,n$g=n$c;n$g<n$e;n$g++)(n$f=n$d[n$g]).time>=this._player.playStart&&n$f.time<=this._player.playEnd&&this.event("label",n$f)}},n$a._update=function(n$a){if(void 0===n$a&&(n$a=!0),!(this._pause||n$a&&this._indexControl)){var n$b=this.timer.currTimer,n$c=this._player.currentKeyframeIndex,n$d=n$b-this._lastTime;if(n$a?this._player._update(n$d):n$c=-1,this._lastTime=n$b,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<n$d&&this._clipIndex==n$c&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var n$e;this._lastUpdateAniClipIndex=this._aniClipIndex,n$c>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var n$f,n$g=this._templet.eventAniArr[this._aniClipIndex];if(n$g&&this._eventIndex<n$g.length&&((n$e=n$g[this._eventIndex]).time>=this._player.playStart&&n$e.time<=this._player.playEnd?this._player.currentPlayTime>=n$e.time&&(this.event("label",n$e),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(n$f=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=n$f&&(this.graphics=n$f));var n$h=0,n$i=0;for(n$i=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,n$i-1)&&0<n$i;)n$i--;if(n$i<this._clipIndex)for(n$h=n$i;n$h<this._clipIndex;n$h++)this._createGraphics(n$h)}else if(1==this._aniMode){if(n$f=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=n$f&&(this.graphics=n$f));for(n$i=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,n$i-1)&&0<n$i;)n$i--;if(n$i<this._clipIndex)for(n$h=n$i;n$h<this._clipIndex;n$h++)this._createGraphics(n$h)}this._createGraphics()}}},n$a._createGraphics=function(n$a){void 0===n$a&&(n$a=-1),-1==n$a&&(n$a=this._clipIndex);var n$b,n$c,n$d=n$a*this._player.cacheFrameRateInterval,n$e=this._templet.drawOrderAniArr[this._aniClipIndex];if(n$e&&0<n$e.length)for(this._drawOrderIndex=0,n$b=n$e[this._drawOrderIndex];n$d>=n$b.time&&(this._drawOrder=n$b.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=n$e.length));)n$b=n$e[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=n$J.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=n$J.create(),n$c=this.graphics;var n$f=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],n$a,n$d);var n$g,n$h,n$i,n$j,n$k=this._aniSectionDic[this._aniClipIndex],n$l=0,n$m=0,n$n=0,n$o=0,n$p=0,n$q=this._templet.srcBoneMatrixArr.length;for(n$p=n$k[n$m=0];n$m<n$q;n$m++)n$j=this._boneList[n$m],n$i=this._templet.srcBoneMatrixArr[n$m],n$j.resultTransform.scX=n$i.scX*this._curOriginalData[n$l++],n$j.resultTransform.skX=n$i.skX+this._curOriginalData[n$l++],n$j.resultTransform.skY=n$i.skY+this._curOriginalData[n$l++],n$j.resultTransform.scY=n$i.scY*this._curOriginalData[n$l++],n$j.resultTransform.x=n$i.x+this._curOriginalData[n$l++],n$j.resultTransform.y=n$i.y+this._curOriginalData[n$l++],8===this._templet.tMatrixDataLen&&(n$j.resultTransform.skewX=n$i.skewX+this._curOriginalData[n$l++],n$j.resultTransform.skewY=n$i.skewY+this._curOriginalData[n$l++]);var n$r,n$s={},n$t={};for(n$p+=n$k[1];n$m<n$p;n$m++)n$s[(n$r=n$f[n$m]).name]=this._curOriginalData[n$l++],n$t[n$r.name]=this._curOriginalData[n$l++],this._curOriginalData[n$l++],this._curOriginalData[n$l++],this._curOriginalData[n$l++],this._curOriginalData[n$l++];var n$u,n$v,n$w={},n$x={};for(n$p+=n$k[2];n$m<n$p;n$m++)n$w[(n$r=n$f[n$m]).name]=this._curOriginalData[n$l++],n$x[n$r.name]=this._curOriginalData[n$l++],this._curOriginalData[n$l++],this._curOriginalData[n$l++],this._curOriginalData[n$l++],this._curOriginalData[n$l++];if(this._pathDic)for(n$p+=n$k[3];n$m<n$p;n$m++){if(n$r=n$f[n$m],n$u=this._pathDic[n$r.name])switch(new n$Fa(n$r.extenData).getByte()){case 1:n$u.position=this._curOriginalData[n$l++];break;case 2:n$u.spacing=this._curOriginalData[n$l++];break;case 3:n$u.rotateMix=this._curOriginalData[n$l++],n$u.translateMix=this._curOriginalData[n$l++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(n$Ga.TEMP.identity()),this._ikArr)for(n$m=0,n$p=this._ikArr.length;n$m<n$p;n$m++)n$v=this._ikArr[n$m],n$w.hasOwnProperty(n$v.name)&&(n$v.bendDirection=n$w[n$v.name]),n$x.hasOwnProperty(n$v.name)&&(n$v.mix=n$x[n$v.name]),n$v.apply();if(this._pathDic)for(var n$y in this._pathDic)(n$u=this._pathDic[n$y]).apply(this._boneList,n$c);if(this._tfArr)for(n$m=0,n$o=this._tfArr.length;n$m<n$o;n$m++)this._tfArr[n$m].apply();for(n$m=0,n$o=this._boneList.length;n$m<n$o;n$m++)if(n$j=this._boneList[n$m],n$h=this._bindBoneBoneSlotDic[n$j.name],n$j.resultMatrix.copyTo(this._boneMatrixArray[n$m]),n$h)for(n$n=0,n$p=n$h.length;n$n<n$p;n$n++)(n$g=n$h[n$n])&&n$g.setParentMatrix(n$j.resultMatrix);var n$z,n$C,n$D,n$E,n$F={},n$G=this._templet.deformAniArr;if(n$G&&0<n$G.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,n$m=0,n$p=this._boneSlotArray.length;n$m<n$p;n$m++)(n$g=this._boneSlotArray[n$m]).deformData=null;var n$H,n$I=n$G[this._aniClipIndex];for(n$H in n$z=n$I.default,this._setDeform(n$z,n$F,this._boneSlotArray,n$d),n$I)"default"!=n$H&&n$H!=this._skinName&&(n$z=n$I[n$H],this._setDeform(n$z,n$F,this._boneSlotArray,n$d));n$z=n$I[this._skinName],this._setDeform(n$z,n$F,this._boneSlotArray,n$d)}if(this._drawOrder)for(n$m=0,n$p=this._drawOrder.length;n$m<n$p;n$m++)n$C=n$s[(n$g=this._boneSlotArray[this._drawOrder[n$m]]).name],n$D=n$t[n$g.name],isNaN(n$D)||(n$c.save(),n$c.alpha(n$D)),isNaN(n$C)||-2==n$C||(this._templet.attachmentNames?n$g.showDisplayByName(this._templet.attachmentNames[n$C]):n$g.showDisplayByIndex(n$C)),n$F[this._drawOrder[n$m]]?(n$E=n$F[this._drawOrder[n$m]],n$g.currDisplayData&&n$E[n$g.currDisplayData.attachmentName]?n$g.deformData=n$E[n$g.currDisplayData.attachmentName]:n$g.deformData=null):n$g.deformData=null,isNaN(n$D)?n$g.draw(n$c,this._boneMatrixArray,2==this._aniMode):n$g.draw(n$c,this._boneMatrixArray,2==this._aniMode,n$D),isNaN(n$D)||n$c.restore();else for(n$m=0,n$p=this._boneSlotArray.length;n$m<n$p;n$m++)n$C=n$s[(n$g=this._boneSlotArray[n$m]).name],n$D=n$t[n$g.name],isNaN(n$D)||(n$c.save(),n$c.alpha(n$D)),isNaN(n$C)||-2==n$C||(this._templet.attachmentNames?n$g.showDisplayByName(this._templet.attachmentNames[n$C]):n$g.showDisplayByIndex(n$C)),n$F[n$m]?(n$E=n$F[n$m],n$g.currDisplayData&&n$E[n$g.currDisplayData.attachmentName]?n$g.deformData=n$E[n$g.currDisplayData.attachmentName]:n$g.deformData=null):n$g.deformData=null,isNaN(n$D)?n$g.draw(n$c,this._boneMatrixArray,2==this._aniMode):n$g.draw(n$c,this._boneMatrixArray,2==this._aniMode,n$D),isNaN(n$D)||n$c.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,n$a,n$c):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,n$a,n$c)},n$a._setDeform=function(n$a,n$b,n$c,n$d){if(n$a){var n$e,n$f,n$g,n$h=0,n$i=0,n$j=0;if(n$a)for(n$h=0,n$i=n$a.deformSlotDataList.length;n$h<n$i;n$h++)for(n$e=n$a.deformSlotDataList[n$h],n$j=0;n$j<n$e.deformSlotDisplayList.length;n$j++)n$g=n$c[(n$f=n$e.deformSlotDisplayList[n$j]).slotIndex],n$f.apply(n$d,n$g),n$b[n$f.slotIndex]||(n$b[n$f.slotIndex]={}),n$b[n$f.slotIndex][n$f.attachment]=n$f.deformData}},n$a.getAnimNum=function(){return this._templet.getAnimationCount()},n$a.getAniNameByIndex=function(n$a){return this._templet.getAniNameByIndex(n$a)},n$a.getSlotByName=function(n$a){return this._boneSlotDic[n$a]},n$a.showSkinByName=function(n$a,n$b){void 0===n$b&&(n$b=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(n$a),n$b)},n$a.showSkinByIndex=function(n$a,n$b){void 0===n$b&&(n$b=!0);for(var n$c=0;n$c<this._boneSlotArray.length;n$c++)this._boneSlotArray[n$c].showSlotData(null,n$b);if(this._templet.showSkinByIndex(this._boneSlotDic,n$a,n$b)){var n$d=this._templet.skinDataArray[n$a];this._skinIndex=n$a,this._skinName=n$d.name}this._clearCache()},n$a.showSlotSkinByIndex=function(n$a,n$b){if(0!=this._aniMode){var n$c=this.getSlotByName(n$a);n$c&&n$c.showDisplayByIndex(n$b),this._clearCache()}},n$a.showSlotSkinByName=function(n$a,n$b){if(0!=this._aniMode){var n$c=this.getSlotByName(n$a);n$c&&n$c.showDisplayByName(n$b),this._clearCache()}},n$a.replaceSlotSkinName=function(n$a,n$b,n$c){if(0!=this._aniMode){var n$d=this.getSlotByName(n$a);n$d&&n$d.replaceDisplayByName(n$b,n$c),this._clearCache()}},n$a.replaceSlotSkinByIndex=function(n$a,n$b,n$c){if(0!=this._aniMode){var n$d=this.getSlotByName(n$a);n$d&&n$d.replaceDisplayByIndex(n$b,n$c),this._clearCache()}},n$a.setSlotSkin=function(n$a,n$b){if(0!=this._aniMode){var n$c=this.getSlotByName(n$a);n$c&&n$c.replaceSkin(n$b),this._clearCache()}},n$a._clearCache=function(){if(1==this._aniMode)for(var n$a=0,n$b=this._graphicsCache.length;n$a<n$b;n$a++){for(var n$c=0,n$d=this._graphicsCache[n$a].length;n$c<n$d;n$c++){var n$e=this._graphicsCache[n$a][n$c];n$e!=this.graphics&&n$J.recycle(n$e)}this._graphicsCache[n$a].length=0}},n$a.play=function(n$a,n$b,n$c,n$d,n$e,n$f){void 0===n$c&&(n$c=!0),void 0===n$d&&(n$d=0),void 0===n$e&&(n$e=0),void 0===n$f&&(n$f=!0),this._indexControl=!1;var n$g=-1,n$h=NaN;if(n$h=n$b?2147483647:0,"string"==typeof n$a)for(var n$i=0,n$j=this._templet.getAnimationCount();n$i<n$j;n$i++){var n$k=this._templet.getAnimation(n$i);if(n$k&&n$a==n$k.name){n$g=n$i;break}}else n$g=n$a;-1<n$g&&n$g<this.getAnimNum()&&(this._aniClipIndex=n$g,(n$c||this._pause||this._currAniIndex!=n$g)&&(this._currAniIndex=n$g,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(n$g)),this._drawOrder=null,this._eventIndex=0,this._player.play(n$g,this._player.playbackRate,n$h,n$d,n$e),n$f&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=n$l.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},n$a.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},n$a.playbackRate=function(n$a){this._player&&(this._player.playbackRate=n$a)},n$a.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},n$a.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=n$l.now(),this.timer.frameLoop(1,this,this._update,null,!0))},n$a._getGrahicsDataWithCache=function(n$a,n$b){return this._graphicsCache[n$a][n$b]},n$a._setGrahicsDataWithCache=function(n$a,n$b,n$c){this._graphicsCache[n$a][n$b]=n$c},n$a.destroy=function(n$a){void 0===n$a&&(n$a=!0),n$b.prototype.destroy.call(this,n$a),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},n$f(0,n$a,"url",function(){return this._aniPath},function(n$a){this.load(n$a)}),n$f(0,n$a,"index",function(){return this._index},function(n$a){this.player&&(this._index=n$a,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),n$f(0,n$a,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),n$f(0,n$a,"templet",function(){return this._templet}),n$f(0,n$a,"player",function(){return this._player}),n$c.useSimpleMeshInCanvas=!1,n$c}(n$fa),n$D=function(n$b){function n$e(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,n$e.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}n$d(n$e,"laya.ani.bone.Templet",n$b);var n$a=n$e.prototype;return n$a.getLoadList=function(){return this._loadList},n$a.loadAni=function(n$a){this._skBufferUrl=n$a,n$ea.loader.load(n$a,n$i.create(this,this.onComplete),null,"arraybuffer")},n$a.onComplete=function(n$a){if(this._isDestroyed)this.destroy();else{var n$b=n$j.getRes(this._skBufferUrl);n$b?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,n$b)):this.event("error","load failed:"+this._skBufferUrl)}},n$a.parseData=function(n$a,n$b,n$c){void 0===n$c&&(n$c=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=n$a,this._mainTexture&&n$q.isWebGL&&n$a.bitmap&&(n$a.bitmap.enableMerageInAtlas=!1),this._rate=n$c,this.parse(n$b)},n$a.buildArmature=function(n$a){return void 0===n$a&&(n$a=0),new n$C(this,n$a)},n$a.parse=function(n$a){n$b.prototype.parse.call(this,n$a),this._endLoaded(),this._aniVersion!=n$e.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+n$e.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},n$a._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var n$a=0;this._loadList=[];var n$b,n$c=new n$Fa(this.getPublicExtData()),n$d=0,n$e=0,n$f=0,n$g=n$c.getInt32(),n$h=n$c.readUTFString(),n$i=n$h.split("\n");for(n$a=0;n$a<n$g;n$a++)n$b=this._path+n$i[2*n$a],n$h=n$i[2*n$a+1],n$c.getFloat32(),n$c.getFloat32(),n$d=n$c.getFloat32(),n$e=n$c.getFloat32(),n$f=n$c.getFloat32(),isNaN(n$f)?0:n$f,n$f=n$c.getFloat32(),isNaN(n$f)?0:n$f,n$f=n$c.getFloat32(),isNaN(n$f)?n$d:n$f,n$f=n$c.getFloat32(),isNaN(n$f)?n$e:n$f,-1==this._loadList.indexOf(n$b)&&this._loadList.push(n$b);this.event("inited",this)}},n$a._textureComplete=function(){for(var n$a,n$b,n$c=0,n$d=this._loadList.length;n$c<n$d;n$c++)n$b=this._loadList[n$c],n$a=this._textureDic[n$b]=n$j.getRes(n$b),n$q.isWebGL&&n$a&&n$a.bitmap&&(n$a.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},n$a._parsePublicExtData=function(){var n$a=0,n$b=0,n$c=0,n$d=0,n$e=0;for(n$a=0,n$e=this.getAnimationCount();n$a<n$e;n$a++)this._graphicsCache.push([]);var n$f;n$f="Dragon"!=this._aniClassName;var n$g,n$h,n$i=new n$Fa(this.getPublicExtData()),n$j=0,n$k=0,n$l=0,n$m=0,n$n=0,n$o=0,n$p=0,n$q=0,n$r=0,n$s=n$i.getInt32(),n$t=n$i.readUTFString(),n$u=n$t.split("\n");for(n$a=0;n$a<n$s;n$a++){if(n$g=this._mainTexture,n$h=this._path+n$u[2*n$a],n$t=n$u[2*n$a+1],null==this._mainTexture&&(n$g=this._textureDic[n$h]),!n$g)return this.event("error",this),void(this.isParseFail=!0);n$j=n$i.getFloat32(),n$k=n$i.getFloat32(),n$l=n$i.getFloat32(),n$m=n$i.getFloat32(),n$r=n$i.getFloat32(),n$n=isNaN(n$r)?0:n$r,n$r=n$i.getFloat32(),n$o=isNaN(n$r)?0:n$r,n$r=n$i.getFloat32(),n$p=isNaN(n$r)?n$l:n$r,n$r=n$i.getFloat32(),n$q=isNaN(n$r)?n$m:n$r,this.subTextureDic[n$t]=n$Ha.create(n$g,n$j,n$k,n$l,n$m,-n$n,-n$o,n$p,n$q),n$g.alphaTexture&&(this.subTextureDic[n$t].alphaTexture=n$Ha.create(n$g.alphaTexture,n$j,n$k,n$l,n$m,-n$n,-n$o,n$p,n$q))}this._mainTexture=n$g;var n$v,n$w,n$x,n$y,n$z,n$C=n$i.getUint16();for(n$a=0;n$a<n$C;n$a++)(n$v=[]).push(n$i.getUint16()),n$v.push(n$i.getUint16()),n$v.push(n$i.getUint16()),n$v.push(n$i.getUint16()),this.aniSectionDic[n$a]=n$v;var n$D,n$E=n$i.getInt16(),n$F={};for(n$a=0;n$a<n$E;n$a++)n$w=new n$Ia,0==n$a?n$D=n$w:n$w.root=n$D,n$w.d=n$f?-1:1,n$y=n$i.readUTFString(),n$z=n$i.readUTFString(),n$w.length=n$i.getFloat32(),1==n$i.getByte()&&(n$w.inheritRotation=!1),1==n$i.getByte()&&(n$w.inheritScale=!1),n$w.name=n$y,n$z&&((n$x=n$F[n$z])?n$x.addChild(n$w):this.mRootBone=n$w),n$F[n$y]=n$w,this.mBoneArr.push(n$w);this.tMatrixDataLen=n$i.getUint16();var n$G,n$H,n$I=n$i.getUint16(),n$J=Math.floor(n$I/this.tMatrixDataLen),n$K=this.srcBoneMatrixArr;for(n$a=0;n$a<n$J;n$a++)(n$G=new n$Va).scX=n$i.getFloat32(),n$G.skX=n$i.getFloat32(),n$G.skY=n$i.getFloat32(),n$G.scY=n$i.getFloat32(),n$G.x=n$i.getFloat32(),n$G.y=n$i.getFloat32(),8===this.tMatrixDataLen&&(n$G.skewX=n$i.getFloat32(),n$G.skewY=n$i.getFloat32()),n$K.push(n$G),(n$w=this.mBoneArr[n$a]).transform=n$G;var n$L,n$M=n$i.getUint16(),n$N=0;for(n$a=0;n$a<n$M;n$a++){for(n$H=new n$Pa,n$N=n$i.getUint16(),n$b=0;n$b<n$N;n$b++)n$H.boneNames.push(n$i.readUTFString()),n$H.boneIndexs.push(n$i.getInt16());n$H.name=n$i.readUTFString(),n$H.targetBoneName=n$i.readUTFString(),n$H.targetBoneIndex=n$i.getInt16(),n$H.bendDirection=n$i.getFloat32(),n$H.mix=n$i.getFloat32(),n$H.isSpine=n$f,this.ikArr.push(n$H)}var n$O,n$P=n$i.getUint16(),n$Q=0;for(n$a=0;n$a<n$P;n$a++){for(n$L=new n$Ua,n$Q=n$i.getUint16(),n$b=0;n$b<n$Q;n$b++)n$L.boneIndexs.push(n$i.getInt16());n$L.name=n$i.getUTFString(),n$L.targetIndex=n$i.getInt16(),n$L.rotateMix=n$i.getFloat32(),n$L.translateMix=n$i.getFloat32(),n$L.scaleMix=n$i.getFloat32(),n$L.shearMix=n$i.getFloat32(),n$L.offsetRotation=n$i.getFloat32(),n$L.offsetX=n$i.getFloat32(),n$L.offsetY=n$i.getFloat32(),n$L.offsetScaleX=n$i.getFloat32(),n$L.offsetScaleY=n$i.getFloat32(),n$L.offsetShearY=n$i.getFloat32(),this.tfArr.push(n$L)}var n$R=n$i.getUint16(),n$S=0;for(n$a=0;n$a<n$R;n$a++){for((n$O=new n$Qa).name=n$i.readUTFString(),n$S=n$i.getUint16(),n$b=0;n$b<n$S;n$b++)n$O.bones.push(n$i.getInt16());n$O.target=n$i.readUTFString(),n$O.positionMode=n$i.readUTFString(),n$O.spacingMode=n$i.readUTFString(),n$O.rotateMode=n$i.readUTFString(),n$O.offsetRotation=n$i.getFloat32(),n$O.position=n$i.getFloat32(),n$O.spacing=n$i.getFloat32(),n$O.rotateMix=n$i.getFloat32(),n$O.translateMix=n$i.getFloat32(),this.pathArr.push(n$O)}var n$T,n$U,n$V,n$W,n$X,n$Y=0,n$Z=0,n$$=0,n$_=NaN,n$A=0,n$B=n$i.getInt16();for(n$a=0;n$a<n$B;n$a++){var n$aa=n$i.getUint8(),n$ba={};this.deformAniArr.push(n$ba);for(var n$ca=0;n$ca<n$aa;n$ca++)for((n$T=new n$Ka).skinName=n$i.getUTFString(),n$ba[n$T.skinName]=n$T,n$Y=n$i.getInt16(),n$b=0;n$b<n$Y;n$b++)for(n$U=new n$La,n$T.deformSlotDataList.push(n$U),n$Z=n$i.getInt16(),n$c=0;n$c<n$Z;n$c++)for(n$V=new n$Ma,n$U.deformSlotDisplayList.push(n$V),n$V.slotIndex=n$i.getInt16(),n$V.attachment=n$i.getUTFString(),n$$=n$i.getInt16(),n$d=0;n$d<n$$;n$d++)for(1==n$i.getByte()?n$V.tweenKeyList.push(!0):n$V.tweenKeyList.push(!1),n$_=n$i.getFloat32(),n$V.timeList.push(n$_),n$W=[],n$V.vectices.push(n$W),n$A=n$i.getInt16(),n$e=0;n$e<n$A;n$e++)n$W.push(n$i.getFloat32())}var n$da,n$ea,n$fa=n$i.getInt16(),n$ga=0,n$ha=0;for(n$a=0;n$a<n$fa;n$a++){for(n$ga=n$i.getInt16(),n$X=[],n$b=0;n$b<n$ga;n$b++){for((n$da=new n$Na).time=n$i.getFloat32(),n$ha=n$i.getInt16(),n$c=0;n$c<n$ha;n$c++)n$da.drawOrder.push(n$i.getInt16());n$X.push(n$da)}this.drawOrderAniArr.push(n$X)}var n$ia,n$ja=n$i.getInt16(),n$ka=0;for(n$a=0;n$a<n$ja;n$a++){for(n$ka=n$i.getInt16(),n$ea=[],n$b=0;n$b<n$ka;n$b++)(n$ia=new n$Oa).name=n$i.getUTFString(),n$ia.intValue=n$i.getInt32(),n$ia.floatValue=n$i.getFloat32(),n$ia.stringValue=n$i.getUTFString(),n$ia.time=n$i.getFloat32(),n$ea.push(n$ia);this.eventAniArr.push(n$ea)}var n$la=n$i.getInt16();if(0<n$la)for(this.attachmentNames=[],n$a=0;n$a<n$la;n$a++)this.attachmentNames.push(n$i.getUTFString());var n$ma,n$na,n$oa=n$i.getInt16();for(n$a=0;n$a<n$oa;n$a++)(n$ma=new n$Ja).name=n$i.readUTFString(),n$ma.parent=n$i.readUTFString(),n$ma.attachmentName=n$i.readUTFString(),n$ma.srcDisplayIndex=n$ma.displayIndex=n$i.getInt16(),(n$ma.templet=this).boneSlotDic[n$ma.name]=n$ma,null==(n$na=this.bindBoneBoneSlotDic[n$ma.parent])&&(this.bindBoneBoneSlotDic[n$ma.parent]=n$na=[]),n$na.push(n$ma),this.boneSlotArray.push(n$ma);var n$pa,n$qa,n$ra,n$sa=n$i.readUTFString().split("\n"),n$ta=0,n$ua=n$i.getUint8(),n$va=0,n$wa=0,n$xa=0,n$ya=0,n$za=0,n$Ca=0,n$Da=0;for(n$a=0;n$a<n$ua;n$a++){for((n$pa=new n$Ra).name=n$sa[n$ta++],n$va=n$i.getUint8(),n$b=0;n$b<n$va;n$b++){for((n$qa=new n$Ta).name=n$sa[n$ta++],n$ma=this.boneSlotDic[n$qa.name],n$wa=n$i.getUint8(),n$c=0;n$c<n$wa;n$c++){if(n$ra=new n$Sa,this.skinSlotDisplayDataArr.push(n$ra),n$ra.name=n$sa[n$ta++],n$ra.attachmentName=n$sa[n$ta++],n$ra.transform=new n$Va,n$ra.transform.scX=n$i.getFloat32(),n$ra.transform.skX=n$i.getFloat32(),n$ra.transform.skY=n$i.getFloat32(),n$ra.transform.scY=n$i.getFloat32(),n$ra.transform.x=n$i.getFloat32(),n$ra.transform.y=n$i.getFloat32(),n$qa.displayArr.push(n$ra),n$ra.width=n$i.getFloat32(),n$ra.height=n$i.getFloat32(),n$ra.type=n$i.getUint8(),n$ra.verLen=n$i.getUint16(),0<(n$E=n$i.getUint16()))for(n$ra.bones=[],n$d=0;n$d<n$E;n$d++){var n$Ea=n$i.getUint16();n$ra.bones.push(n$Ea)}if(0<(n$xa=n$i.getUint16()))for(n$ra.uvs=[],n$d=0;n$d<n$xa;n$d++)n$ra.uvs.push(n$i.getFloat32());if(0<(n$ya=n$i.getUint16()))for(n$ra.weights=[],n$d=0;n$d<n$ya;n$d++)n$ra.weights.push(n$i.getFloat32());if(0<(n$za=n$i.getUint16()))for(n$ra.triangles=[],n$d=0;n$d<n$za;n$d++)n$ra.triangles.push(n$i.getUint16());if(0<(n$Ca=n$i.getUint16()))for(n$ra.vertices=[],n$d=0;n$d<n$Ca;n$d++)n$ra.vertices.push(n$i.getFloat32());if(0<(n$Da=n$i.getUint16()))for(n$ra.lengths=[],n$d=0;n$d<n$Da;n$d++)n$ra.lengths.push(n$i.getFloat32())}n$pa.slotArr.push(n$qa)}this.skinDic[n$pa.name]=n$pa,this.skinDataArray.push(n$pa)}1==n$i.getUint8()?(this.yReverseMatrix=new n$Ga(1,0,0,-1,0,0),n$D&&n$D.setTempMatrix(this.yReverseMatrix)):n$D&&n$D.setTempMatrix(new n$Ga),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},n$a.getTexture=function(n$a){var n$b=this.subTextureDic[n$a];return n$b||(n$b=this.subTextureDic[n$a.substr(0,n$a.length-1)]),null==n$b?this._mainTexture:n$b},n$a.showSkinByIndex=function(n$a,n$b,n$c){if(void 0===n$c&&(n$c=!0),n$b<0&&n$b>=this.skinDataArray.length)return!1;var n$d,n$e,n$f=0,n$g=0,n$h=this.skinDataArray[n$b];if(n$h){for(n$f=0,n$g=n$h.slotArr.length;n$f<n$g;n$f++)(n$e=n$h.slotArr[n$f])&&(n$d=n$a[n$e.name])&&(n$d.showSlotData(n$e,n$c),n$c&&"undefined"!=n$d.attachmentName&&"null"!=n$d.attachmentName?n$d.showDisplayByName(n$d.attachmentName):n$d.showDisplayByIndex(n$d.displayIndex));return!0}return!1},n$a.getSkinIndexByName=function(n$a){for(var n$b=0,n$c=this.skinDataArray.length;n$b<n$c;n$b++)if(this.skinDataArray[n$b].name==n$a)return n$b;return-1},n$a.getGrahicsDataWithCache=function(n$a,n$b){return this._graphicsCache[n$a][n$b]},n$a.setGrahicsDataWithCache=function(n$a,n$b,n$c){this._graphicsCache[n$a][n$b]=n$c},n$a.destroy=function(){var n$a;for(var n$b in this._isDestroyed=!0,this.subTextureDic)(n$a=this.subTextureDic[n$b])&&n$a.destroy();for(n$b in this._textureDic)(n$a=this._textureDic[n$b])&&n$a.destroy();for(var n$c=0,n$d=this.skinSlotDisplayDataArr.length;n$c<n$d;n$c++)this.skinSlotDisplayDataArr[n$c].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete n$e.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},n$a.getAniNameByIndex=function(n$a){var n$b=this.getAnimation(n$a);return n$b?n$b.name:null},n$f(0,n$a,"rate",function(){return this._rate},function(n$a){this._rate=n$a}),n$e.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",n$e.TEMPLET_DICTIONARY=null,n$e}(n$K)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(n$a,n$b){"use strict";for(var n$c in Object.defineProperty(n$b,"__esModule",{value:!0}),Laya){var n$d=Laya[n$c];n$d&&n$d.__isclass&&(n$b[n$c]=n$d)}});