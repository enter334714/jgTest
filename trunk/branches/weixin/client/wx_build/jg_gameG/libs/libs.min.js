var Laya=window.Laya=function($l,$c){var $m={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function($c,$d){return 1==arguments.length?$m.__presubstr.call(this,$c):$m.__presubstr.call(this,$c,0<$d?$d:this.length+$d)},__init:function($c){$c.forEach(function($c){$c.__init$&&$c.__init$()})},__isClass:function($c){return $c&&($c.__isclass||$c==Object||$c==String||$c==Array)},__newvec:function($c,$d){var $e=[];$e.length=$c;for(var $f=0;$f<$c;$f++)$e[$f]=$d;return $e},__extend:function($c,$d){for(var $e in $d)if($d.hasOwnProperty($e)){var $f=Object.getOwnPropertyDescriptor($d,$e),$g=$f.get,$h=$f.set;$g||$h?$g&&$h?Object.defineProperty($c,$e,$f):($g&&Object.defineProperty($c,$e,$g),$h&&Object.defineProperty($c,$e,$h)):$c[$e]=$d[$e]}function $i(){$m.un(this,"constructor",$c)}$i.prototype=$d.prototype,$c.prototype=new $i,$m.un($c.prototype,"__imps",$m.__copy({},$d.prototype.__imps))},__copy:function($c,$d){if(!$d)return null;for(var $e in $c=$c||{},$d)$c[$e]=$d[$e];return $c},__package:function($c,$d){if(!$m.__packages[$c]){$m.__packages[$c]=!0;var $e=$l,$f=$c.split(".");if(1<$f.length)for(var $g=0,$h=$f.length-1;$g<$h;$g++){var $i=$e[$f[$g]];$e=$i||($e[$f[$g]]={})}$e[$f[$f.length-1]]||($e[$f[$f.length-1]]=$d||{})}},__hasOwnProperty:function($c,$d){return $d=$d||this,Object.hasOwnProperty.call($d,$c)||function $c($d,$e){if(Object.hasOwnProperty.call($e.prototype,$d))return!0;var $f=$e.prototype.__super;return null==$f?null:$c($d,$f)}($c,$d.__class)},__typeof:function($c,$d){if(!$c||!$d)return!1;if($d===String)return"string"==typeof $c;if($d===Number)return"number"==typeof $c;if($d.__interface__)$d=$d.__interface__;else if("string"!=typeof $d)return $c instanceof $d;return $c.__imps&&$c.__imps[$d]||$c.__class==$d},__as:function($c,$d){return this.__typeof($c,$d)?$c:null},__int:function($c){return $c?parseInt($c):0},interface:function($c,$d){$m.__package($c,{});var $e=$m.__internals,$f=$e[$c]=$e[$c]||{self:$c};if($d){var $g=$d.split(",");$f.extend=[];for(var $h=0;$h<$g.length;$h++){var $i=$g[$h];$e[$i]=$e[$i]||{self:$i},$f.extend.push($e[$i])}}var $j=$l,$k=$c.split(".");for($h=0;$h<$k.length-1;$h++)$j=$j[$k[$h]];$j[$k[$k.length-1]]={__interface__:$c}},class:function($c,$d,$e,$f){if($e&&$m.__extend($c,$e),$d)if($m.__package($d,$c),$m.__classmap[$d]=$c,0<$d.indexOf(".")){if(0==$d.indexOf("laya.")){var $g=$d.split(".");$f=$f||$g[$g.length-1],$m[$f]&&console.log("Warning!,this class["+$f+"] already exist:",$m[$f]),$m[$f]=$c}}else"Main"==$d?$l.Main=$c:"MainWX"==$d?$l.MainWX=$c:($m[$d]&&console.log("Error!,this class["+$d+"] already exist:",$m[$d]),$m[$d]=$c);var $h=$m.un,$i=$c.prototype;$h($i,"hasOwnProperty",$m.__hasOwnProperty),$h($i,"__class",$c),$h($i,"__super",$e),$h($i,"__className",$d),$h($c,"__super",$e),$h($c,"__className",$d),$h($c,"__isclass",!0),$h($c,"super",function($c){this.__super.call($c)})},imps:function($c,$d){if(!$d)return null;var $g=$c.__imps||$m.un($c,"__imps",{});function $h($c){var $d,$e;if(($d=$m.__internals[$c])&&($g[$c]=!0,$e=$d.extend))for(var $f=0;$f<$e.length;$f++)$h($e[$f].self)}for(var $e in $d)$h($e)},superSet:function($c,$d,$e,$f){var $g=$c.prototype["_$set_"+$e];$g&&$g.call($d,$f)},superGet:function($c,$d,$e){var $f=$c.prototype["_$get_"+$e];return $f?$f.call($d):null},getset:function($c,$d,$e,$f,$g){$c?($f&&($d["_$GET_"+$e]=$f),$g&&($d["_$SET_"+$e]=$g)):($f&&$m.un($d,"_$get_"+$e,$f),$g&&$m.un($d,"_$set_"+$e,$g)),$f&&$g?Object.defineProperty($d,$e,{get:$f,set:$g,enumerable:!1,configurable:!0}):($f&&Object.defineProperty($d,$e,{get:$f,enumerable:!1,configurable:!0}),$g&&Object.defineProperty($d,$e,{set:$g,enumerable:!1,configurable:!0}))},static:function($e,$f){for(var $g=0,$c=$f.length;$g<$c;$g+=2)if("length"==$f[$g])$e.length=$f[$g+1].call($e);else{function $d(){var $d=$f[$g],$c=$f[$g+1];Object.defineProperty($e,$d,{get:function(){return delete this[$d],this[$d]=$c.call(this)},set:function($c){delete this[$d],this[$d]=$c},enumerable:!0,configurable:!0})}$d()}},un:function($c,$d,$e){return $e||($e=$c[$d]),$m.__propun.value=$e,Object.defineProperty($c,$d,$m.__propun),$e},uns:function($d,$c){$c.forEach(function($c){$m.un($d,$c)})}};return $l.console=$l.console||{log:function(){}},$l.trace=$l.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),$m}(window,document);!function($c,$d,$e){$e.un,$e.uns,$e.static,$e.class,$e.getset,$e.__newvec}(window,document,Laya),function($i,$d,$z){$z.un,$z.uns;var $k=$z.static,$r=$z.class,$m=$z.getset;$z.__newvec;$z.interface("laya.runtime.IMarket"),$z.interface("laya.filters.IFilter"),$z.interface("laya.display.ILayout"),$z.interface("laya.resource.IDispose"),$z.interface("laya.runtime.IPlatform"),$z.interface("laya.resource.IDestroy"),$z.interface("laya.runtime.IConchNode"),$z.interface("laya.filters.IFilterAction"),$z.interface("laya.runtime.ICPlatformClass"),$z.interface("laya.resource.ICreateResource"),$z.interface("laya.runtime.IConchRenderObject"),$z.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var $F=function(){function $h(){}return $r($h,"laya.utils.RunDriver"),$h.FILTER_ACTIONS=[],$h.pixelRatio=-1,$h._charSizeTestDiv=null,$h.now=function(){return Date.now()},$h.getWindow=function(){return $i},$h.getPixelRatio=function(){if($h.pixelRatio<0){var $c=$O.context,$d=$c.backingStorePixelRatio||$c.webkitBackingStorePixelRatio||$c.mozBackingStorePixelRatio||$c.msBackingStorePixelRatio||$c.oBackingStorePixelRatio||$c.backingStorePixelRatio||1;($h.pixelRatio=($O.window.devicePixelRatio||1)/$d)<1&&($h.pixelRatio=1)}return $h.pixelRatio},$h.getIncludeStr=function($c){return null},$h.createShaderCondition=function($c){var $d="(function() {return "+$c+";})";return $z._runScript($d)},$h.fontMap=[],$h.measureText=function($c,$d){var $e=$h.hanzi.test($c);if($e&&$h.fontMap[$d])return $h.fontMap[$d];var $f=$O.context;$f.font=$d;var $g=$f.measureText($c);return $e&&($h.fontMap[$d]=$g),$g},$h.getWebGLContext=function($c){},$h.beginFlush=function(){},$h.endFinish=function(){},$h.addToAtlas=null,$h.flashFlushImage=function($c){},$h.drawToCanvas=function($c,$d,$e,$f,$g,$h){var $i=$vc.create("2D"),$j=new $K($e,$f,$i);return $L.renders[$d]._fun($c,$j,$g,$h),$i},$h.createParticleTemplate2D=null,$h.createGLTextur=null,$h.createWebGLContext2D=null,$h.changeWebGLSize=function($c,$d){},$h.createRenderSprite=function($c,$d){return new $L($c,$d)},$h.createFilterAction=function($c){return new $v},$h.createGraphics=function(){return new $o},$h.clear=function($c){$J._context.ctx.clear()},$h.cancelLoadByUrl=function($c){},$h.clearAtlas=function($c){},$h.isAtlas=function($c){return!1},$h.addTextureToAtlas=function($c){},$h.getTexturePixels=function($c,$d,$e,$f,$g){return null},$h.skinAniSprite=function(){return null},$h.update3DLoop=function(){},$k($h,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),$h}(),$f=($m(1,$z,"alertGlobalError",null,function($c){var $h=0;$O.window.onerror=$c?function($c,$d,$e,$f,$g){$h++<5&&$g&&alert($g.stack||$g)}:null}),$z.init=function($c,$d,$e){for(var $f=[],$g=2,$h=arguments.length;$g<$h;$g++)$f.push(arguments[$g]);if(!$z._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=$z._arrayBufferSlice),$z._isinit=!0,$O.__init__(),$M.__init__(),$o.__init__(),$z.timer=new $Y,$z.scaleTimer=new $Y,$z.loader=new $kc,$a.__init__(),$g=0;for(var $i=$f.length;$g<$i;$g++)$f[$g].enable&&$f[$g].enable();return $p.__init__(),$j.__init__(),$N.__init__(),$Q.beginCheck(),$z._currentStage=$z.stage=new $tc,$z.stage.conchModel&&$z.stage.conchModel.setRootNode(),$z._getUrlPath(),$z.render=new $J(0,0),$z.stage.size($c,$d),$L.__init__(),$n.__init__(),$q.instance.__init__($z.stage,$J.canvas),$xc.__init__(),$E.autoStopMusic=!0,$C.__init__(),$J.canvas}},$z._getUrlPath=function(){var $c=$O.window.location,$d=$c.pathname;$d=$d&&":"==$d.charAt(2)?$d.substring(1):$d,$I.rootPath=$I.basePath=$I.getPath("file:"==$c.protocol?$d:$c.protocol+"//"+$c.host+$c.pathname)},$z._arrayBufferSlice=function($c,$d){var $e=new Uint8Array(this,$c,$d-$c),$f=new Uint8Array($e.length);return $f.set($e),$f.buffer},$z._runScript=function($c){return $O.window[$z._evcode]($c)},$z.stage=null,$z.timer=null,$z.scaleTimer=null,$z.loader=null,$z.version="1.8.6",$z.render=null,$z._currentStage=null,$z._isinit=!1,$z.isDebug=!1,$z.MiniAdpter={init:function(){$i.navigator&&$i.navigator.userAgent&&-1<$i.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},$k($z,["conchMarket",function(){return this.conchMarket=$i.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=$i.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function $c(){}return $r($c,"Config"),$c.WebGLTextCacheCount=500,$c.atlasEnable=!1,$c.showCanvasMark=!1,$c.animationInterval=50,$c.isAntialias=!1,$c.isAlpha=!1,$c.premultipliedAlpha=!0,$c.isStencil=!0,$c.preserveDrawingBuffer=!1,$c}()),$l=function(){function $l(){this._events=null}$r($l,"laya.events.EventDispatcher");var $c=$l.prototype;return $c.hasListener=function($c){return!!(this._events&&this._events[$c])},$c.event=function($c,$d){if(!this._events||!this._events[$c])return!1;var $e=this._events[$c];if($e.lock)$e.queue||($e.queue=[]),$e.queue.push($d);else{var $f;for($e.lock=!0,$e.cursor=$e.head;$e.cursor;)$f=$e.cursor,$e.cursor=$f.next,$f.once&&$l.delNode($e,$f),null!=$d?$f.args?$f.method.apply($f.caller,$f.args.concat($d)):$d instanceof Array?$f.method.apply($f.caller,$d):$f.method.call($f.caller,$d):$f.method.apply($f.caller,$f.args),$f.once&&$l.recoverHandler($f);$e.lock=!1,!$e.head&&this._events&&this._events[$c]==$e&&delete this._events[$c],$e.queue&&$e.queue.length&&this.event($c,$e.queue.shift())}return!0},$c.on=function($c,$d,$e,$f){return this._createListener($c,$d,$e,$f,!1)},$c.once=function($c,$d,$e,$f){return this._createListener($c,$d,$e,$f,!0)},$c._createListener=function($c,$d,$e,$f,$g,$h){void 0===$h&&($h=!0),$h&&this.off($c,$d,$e,$g);var $i=$l.createHandler($d||this,$e,$f,$g);this._events||(this._events={});var $j=this._events,$k=$j[$c];return $k?$k.tail?($i.prev=$k.tail,$k.tail.next=$i,$k.tail=$i):$k.head=$k.tail=$i:$j[$c]={head:$i,tail:$i,cursor:null,lock:!1},this},$c.off=function($c,$d,$e,$f){if(void 0===$f&&($f=!1),!this._events||!this._events[$c])return this;for(var $g=this._events[$c],$h=$g.head;$h;){if((!$d||$h.caller===$d)&&$h.method===$e&&(!$f||$h.once)){$l.delNode($g,$h),$g.cursor==$h&&($g.cursor=$h.next),$l.recoverHandler($h);break}$h=$h.next}return this},$c.offAll=function($c){var $d=this._events;if(!$d)return this;if($c)this._recoverHandlers($d[$c]),delete $d[$c];else{for(var $e in $d)this._recoverHandlers($d[$e]);this._events=null}return this},$c._recoverHandlers=function($c){if($c){for(var $d=$c.head;$d;){$l.delNode($c,$d);var $e=$d.next;$l.recoverHandler($d),$d=$e}$c.cursor=null}},$c.isMouseEvent=function($c){return $l.MOUSE_EVENTS[$c]},$l.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},$l.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},$l.delNode=function($c,$d){$d.prev?$d.prev.next=$d.next:$c.head=$d.next,$d.next?$d.next.prev=$d.prev:$c.tail=$d.prev},$l.createHandler=function($c,$d,$e,$f){var $g=$l._freeHandler;return $g?($l._freeCount--,$l._freeHandler=$g.next,$g.caller=$c,$g.method=$d,$g.args=$e,$g.once=$f):$g={caller:$c,method:$d,args:$e,once:$f},$g.prev=$g.next=null,$g},$l.recoverHandler=function($c){$c.caller=$c.method=$c.args=$c.prev=null,$c.next=$l._freeHandler,$l._freeHandler=$c,$l._freeCount++},$l._freeHandler=null,$l._freeCount=0,$l}(),$u=function(){function $g($c,$d,$e,$f){this.once=!1,void(this._id=0)===$f&&($f=!1),this.setTo($c,$d,$e,$f)}$r($g,"laya.utils.Handler");var $c=$g.prototype;return $c.setTo=function($c,$d,$e,$f){return this._id=$g._gid++,this.caller=$c,this.method=$d,this.args=$e,this.once=$f,this},$c.run=function(){if(null==this.method)return null;var $c=this._id,$d=this.method.apply(this.caller,this.args);return this._id===$c&&this.once&&this.recover(),$d},$c.runWith=function($c){if(null==this.method)return null;var $d=this._id;if(null==$c)var $e=this.method.apply(this.caller,this.args);else $e=this.args||$c.unshift?this.args?this.method.apply(this.caller,this.args.concat($c)):this.method.apply(this.caller,$c):this.method.call(this.caller,$c);return this._id===$d&&this.once&&this.recover(),$e},$c.clear=function(){return this.caller=null,this.method=null,this.args=null,this},$c.recover=function(){0<this._id&&(this._id=0,this.clear())},$g.create=function($c,$d,$e,$f){return void 0===$f&&($f=!0),new $g($c,$d,$e,$f)},$g._gid=1,$g}(),$D=function(){function $c(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}$r($c,"laya.display.BitmapFont");var $d=$c.prototype;return $d.loadFont=function($c,$d){this._path=$c,this._complete=$d,$z.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],$u.create(this,this.onLoaded))},$d.onLoaded=function(){this.parseFont($jc.getRes(this._path),$jc.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},$d.parseFont=function($c,$d){if(null!=$c&&null!=$d){this._texture=$d;var $e=$c.getElementsByTagName("info");if(!$e[0].getAttributeNode)return this.parseFont2($c,$d);this.fontSize=parseInt($e[0].getAttributeNode("size").nodeValue);var $f,$g=$e[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt($g[0]),parseInt($g[1]),parseInt($g[2]),parseInt($g[3])],$f=$c.getElementsByTagName("char");var $h=0;for($h=0;$h<$f.length;$h++){var $i=$f[$h],$j=parseInt($i.getAttributeNode("id").nodeValue),$k=parseInt($i.getAttributeNode("xoffset").nodeValue)/1,$l=parseInt($i.getAttributeNode("yoffset").nodeValue)/1,$m=parseInt($i.getAttributeNode("xadvance").nodeValue)/1,$n=new $B;$n.x=parseInt($i.getAttributeNode("x").nodeValue),$n.y=parseInt($i.getAttributeNode("y").nodeValue),$n.width=parseInt($i.getAttributeNode("width").nodeValue),$n.height=parseInt($i.getAttributeNode("height").nodeValue);var $o=$mc.create($d,$n.x,$n.y,$n.width,$n.height,$k,$l);this._maxWidth=Math.max(this._maxWidth,$m+this.letterSpacing),this._fontCharDic[$j]=$o,this._fontWidthMap[$j]=$m}}},$d.parseFont2=function($c,$d){if(null!=$c&&null!=$d){this._texture=$d;var $e=$c.getElementsByTagName("info");this.fontSize=parseInt($e[0].attributes.size.nodeValue);var $f=$e[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt($f[0]),parseInt($f[1]),parseInt($f[2]),parseInt($f[3])];var $g=$c.getElementsByTagName("char"),$h=0;for($h=0;$h<$g.length;$h++){var $i=$g[$h].attributes,$j=parseInt($i.id.nodeValue),$k=parseInt($i.xoffset.nodeValue)/1,$l=parseInt($i.yoffset.nodeValue)/1,$m=parseInt($i.xadvance.nodeValue)/1,$n=new $B;$n.x=parseInt($i.x.nodeValue),$n.y=parseInt($i.y.nodeValue),$n.width=parseInt($i.width.nodeValue),$n.height=parseInt($i.height.nodeValue);var $o=$mc.create($d,$n.x,$n.y,$n.width,$n.height,$k,$l);this._maxWidth=Math.max(this._maxWidth,$m+this.letterSpacing),this._fontCharDic[$j]=$o,this._fontWidthMap[$j]=$m}}},$d.getCharTexture=function($c){return this._fontCharDic[$c.charCodeAt(0)]},$d.destroy=function(){if(this._texture){for(var $c in this._fontCharDic){var $d=this._fontCharDic[$c];$d&&$d.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},$d.setSpaceWidth=function($c){this._spaceWidth=$c},$d.getCharWidth=function($c){var $d=$c.charCodeAt(0);return this._fontWidthMap[$d]?this._fontWidthMap[$d]+this.letterSpacing:" "==$c?this._spaceWidth+this.letterSpacing:0},$d.getTextWidth=function($c){for(var $d=0,$e=0,$f=$c.length;$e<$f;$e++)$d+=this.getCharWidth($c.charAt($e));return $d},$d.getMaxWidth=function(){return this._maxWidth},$d.getMaxHeight=function(){return this.fontSize},$d.drawText=function($c,$d,$e,$f,$g,$h){var $i,$j=this.getTextWidth($c),$k=0;"center"===$g&&($k=($h-$j)/2),"right"===$g&&($k=$h-$j);for(var $l=0,$m=0,$n=$c.length;$m<$n;$m++)($i=this.getCharTexture($c.charAt($m)))&&($d.graphics.drawTexture($i,$e+$l+$k,$f),$l+=this.getCharWidth($c.charAt($m)))},$c}(),$j=function(){function $e(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=$e._TF_EMPTY}$r($e,"laya.display.css.Style");var $c=$e.prototype;return $c.getTransform=function(){return this._tf},$c.setTransform=function($c){this._tf="none"!==$c&&$c?$c:$e._TF_EMPTY},$c.setTranslateX=function($c){this._tf===$e._TF_EMPTY&&(this._tf=new $g),this._tf.translateX=$c},$c.setTranslateY=function($c){this._tf===$e._TF_EMPTY&&(this._tf=new $g),this._tf.translateY=$c},$c.setScaleX=function($c){this._tf===$e._TF_EMPTY&&(this._tf=new $g),this._tf.scaleX=$c},$c.setScale=function($c,$d){this._tf===$e._TF_EMPTY&&(this._tf=new $g),this._tf.scaleX=$c,this._tf.scaleY=$d},$c.setScaleY=function($c){this._tf===$e._TF_EMPTY&&(this._tf=new $g),this._tf.scaleY=$c},$c.setRotate=function($c){this._tf===$e._TF_EMPTY&&(this._tf=new $g),this._tf.rotate=$c},$c.setSkewX=function($c){this._tf===$e._TF_EMPTY&&(this._tf=new $g),this._tf.skewX=$c},$c.setSkewY=function($c){this._tf===$e._TF_EMPTY&&(this._tf=new $g),this._tf.skewY=$c},$c.destroy=function(){this.scrollRect=null},$c.render=function($c,$d,$e,$f){},$c.getCSSStyle=function(){return $dc.EMPTY},$c._enableLayout=function(){return!1},$m(0,$c,"scaleX",function(){return this._tf.scaleX},function($c){this.setScaleX($c)}),$m(0,$c,"transform",function(){return this.getTransform()},function($c){this.setTransform($c)}),$m(0,$c,"translateX",function(){return this._tf.translateX},function($c){this.setTranslateX($c)}),$m(0,$c,"translateY",function(){return this._tf.translateY},function($c){this.setTranslateY($c)}),$m(0,$c,"scaleY",function(){return this._tf.scaleY},function($c){this.setScaleY($c)}),$m(0,$c,"block",function(){return 0!=(1&this._type)}),$m(0,$c,"skewY",function(){return this._tf.skewY},function($c){this.setSkewY($c)}),$m(0,$c,"rotate",function(){return this._tf.rotate},function($c){this.setRotate($c)}),$m(0,$c,"skewX",function(){return this._tf.skewX},function($c){this.setSkewX($c)}),$m(0,$c,"paddingLeft",function(){return 0}),$m(0,$c,"paddingTop",function(){return 0}),$m(0,$c,"absolute",function(){return!0}),$e.__init__=function(){$e._TF_EMPTY=new $g,$e.EMPTY=new $e},$e.EMPTY=null,$e._TF_EMPTY=null,$e}(),$p=function(){function $d($c){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=$S.create($d.defaultColor),this.family=$d.defaultFamily,this.stroke=$d._STROKE,this.size=$d.defaultSize,$c&&$c!==$d.EMPTY&&$c.copyTo(this)}$r($d,"laya.display.css.Font");var $c=$d.prototype;return $c.set=function($c){this._text=null;for(var $d=$c.split(" "),$e=0,$f=$d.length;$e<$f;$e++){var $g=$d[$e];switch($g){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<$g.indexOf("px")&&(this.size=parseInt($g),this.family=$d[$e+1],$e++)}},$c.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},$c.copyTo=function($c){$c._type=this._type,$c._text=this._text,$c._weight=this._weight,$c._color=this._color,$c.family=this.family,$c.stroke=this.stroke!=$d._STROKE?this.stroke.slice():$d._STROKE,$c.indent=this.indent,$c.size=this.size},$m(0,$c,"password",function(){return 0!=(1024&this._type)},function($c){$c?this._type|=1024:this._type&=-1025}),$m(0,$c,"color",function(){return this._color.strColor},function($c){this._color=$S.create($c)}),$m(0,$c,"italic",function(){return 0!=(512&this._type)},function($c){$c?this._type|=512:this._type&=-513}),$m(0,$c,"bold",function(){return 0!=(2048&this._type)},function($c){$c?this._type|=2048:this._type&=-2049}),$m(0,$c,"weight",function(){return""+this._weight},function($c){var $d=0;switch($c){case"normal":break;case"bold":this.bold=!0,$d=700;break;case"bolder":$d=800;break;case"lighter":$d=100;break;default:$d=parseInt($c)}this._weight=$d,this._text=null}),$m(0,$c,"decoration",function(){return this._decoration?this._decoration.value:null},function($c){var $d=$c.split(" ");switch(this._decoration||(this._decoration={}),$d[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=$d[0]}$d[1]&&(this._decoration.color=$S.create($d)),this._decoration.value=$c}),$d.__init__=function(){$d.EMPTY=new $d(null)},$d.EMPTY=null,$d.defaultColor="#000000",$d.defaultSize=12,$d.defaultFamily="Arial",$d.defaultFont="12px Arial",$d._STROKE=[0,"#000000"],$d._ITALIC=512,$d._PASSWORD=1024,$d._BOLD=2048,$d}(),$g=function(){function $c(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return $r($c,"laya.display.css.TransformInfo"),$c}(),$o=function(){function $n(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,$J.isConchNode){this._nativeObj=new $i._conchGraphics,this.id=this._nativeObj.conchID}}$r($n,"laya.display.Graphics");var $c=$n.prototype;return $c.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},$c.clear=function($c){void 0===$c&&($c=!1);var $d=0,$e=0;if($c){var $f=this._one;if(this._cmds){for($e=this._cmds.length,$d=0;$d<$e;$d++)!($f=this._cmds[$d])||$f.callee!==$J._context._drawTexture&&$f.callee!==$J._context._drawTextureWithTransform||($f[0]=null,$n._cache.push($f));this._cmds.length=0}else $f&&(!$f||$f.callee!==$J._context._drawTexture&&$f.callee!==$J._context._drawTextureWithTransform||($f[0]=null,$n._cache.push($f)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for($d=0,$e=this._vectorgraphArray.length;$d<$e;$d++)$_.getInstance().deleteShape(this._vectorgraphArray[$d]);this._vectorgraphArray.length=0}},$c._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},$c._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new $e,this._graphicBounds._graphics=this)},$c._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},$c._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},$c.getBounds=function($c){return void 0===$c&&($c=!1),this._initGraphicBounds(),this._graphicBounds.getBounds($c)},$c.getBoundPoints=function($c){return void 0===$c&&($c=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints($c)},$c._addCmd=function($c){this._cmds=this._cmds||[],$c.callee=$c.shift(),this._cmds.push($c)},$c.setFilters=function($c){this._saveToCmd($J._context._setFilters,$c)},$c.drawTexture=function($c,$d,$e,$f,$g,$h,$i){if(void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=0),void 0===$g&&($g=0),void 0===$i&&($i=1),!$c||$i<.01)return null;$f||($f=$c.sourceWidth),$g||($g=$c.sourceHeight),$i=$i<0?0:1<$i?1:$i;var $j,$k=!$J.isWebGL&&($O.onFirefox||$O.onEdge||$O.onIE||$O.onSafari)?.5:0,$l=$f/$c.sourceWidth,$m=$g/$c.sourceHeight;return $f=$c.width*$l,$g=$c.height*$m,$c.loaded&&($f<=0||$g<=0)?null:($d+=$c.offsetX*$l,$e+=$c.offsetY*$m,this._sp&&(this._sp._renderType|=512),$d-=$k,$e-=$k,$f+=2*$k,$g+=2*$k,$n._cache.length?(($j=$n._cache.pop())[0]=$c,$j[1]=$d,$j[2]=$e,$j[3]=$f,$j[4]=$g,$j[5]=$h,$j[6]=$i):$j=[$c,$d,$e,$f,$g,$h,$i],$j.callee=$h||1!=$i?$J._context._drawTextureWithTransform:$J._context._drawTexture,null!=this._one||$h||1!=$i?this._saveToCmd($j.callee,$j):(this._one=$j,this._render=this._renderOneImg),$c.loaded||$c.once("loaded",this,this._textureLoaded,[$c,$j]),this._repaint(),$j)},$c.cleanByTexture=function($c,$d,$e,$f,$g){if(void 0===$f&&($f=0),void 0===$g&&($g=0),!$c)return this.clear();if(this._one&&this._render===this._renderOneImg){$f||($f=$c.sourceWidth),$g||($g=$c.sourceHeight);var $h=$f/$c.sourceWidth,$i=$g/$c.sourceHeight;$f=$c.width*$h,$g=$c.height*$i,$d+=$c.offsetX*$h,$e+=$c.offsetY*$i,this._one[0]=$c,this._one[1]=$d,this._one[2]=$e,this._one[3]=$f,this._one[4]=$g,this._repaint()}else this.clear(),$c&&this.drawTexture($c,$d,$e,$f,$g)},$c.drawTextures=function($c,$d){$c&&this._saveToCmd($J._context._drawTextures,[$c,$d])},$c.fillTexture=function($c,$d,$e,$f,$g,$h,$i){if(void 0===$f&&($f=0),void 0===$g&&($g=0),void 0===$h&&($h="repeat"),$c){var $j=[$c,$d,$e,$f,$g,$h,$i||$A.EMPTY,{}];$c.loaded||$c.once("loaded",this,this._textureLoaded,[$c,$j]),this._saveToCmd($J._context._fillTexture,$j)}},$c._textureLoaded=function($c,$d){$d[3]=$d[3]||$c.width,$d[4]=$d[4]||$c.height,this._repaint()},$c.fillCircle=function($c,$d,$e,$f,$g,$h,$i){$e.bitmap.enableMerageInAtlas=!1;var $j=new Float32Array(2*($i+1)),$k=new Float32Array(2*($i+1)),$l=new Uint16Array(3*$i),$m=2*Math.PI/$i,$n=0;$j[0]=$f,$j[1]=$g,$k[0]=$f/$e.width,$k[1]=$g/$e.height;for(var $o=2,$p=0;$p<$i;$p++){var $q=$h*Math.cos($n)+$f,$r=$h*Math.sin($n)+$g;$j[$o]=$q,$j[$o+1]=$r,$k[$o]=$q/$e.width,$k[$o+1]=$r/$e.height,$n+=$m,$o+=2}for($p=$o=0;$p<$i;$p++)$l[$o++]=0,$l[$o++]=$p+1,$l[$o++]=$i+1<=$p+2?1:$p+2;this.drawTriangles($e,$c,$d,$j,$k,$l)},$c.drawTriangles=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){void 0===$j&&($j=1),this._saveToCmd($J._context.drawTriangles,[$c,$d,$e,$f,$g,$h,$i,$j,$k,$l])},$c._saveToCmd=function($c,$d){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=$d,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push($d)),$d.callee=$c,this._repaint(),$d},$c.clipRect=function($c,$d,$e,$f){this._saveToCmd($J._context._clipRect,[$c,$d,$e,$f])},$c.fillText=function($c,$d,$e,$f,$g,$h,$i){void 0===$i&&($i=0),this._saveToCmd($J._context._fillText,[$c,$d,$e,$f||$p.defaultFont,$g,$h])},$c.fillBorderText=function($c,$d,$e,$f,$g,$h,$i,$j){this._saveToCmd($J._context._fillBorderText,[$c,$d,$e,$f||$p.defaultFont,$g,$h,$i,$j])},$c.strokeText=function($c,$d,$e,$f,$g,$h,$i){this._saveToCmd($J._context._strokeText,[$c,$d,$e,$f||$p.defaultFont,$g,$h,$i])},$c.alpha=function($c){$c=$c<0?0:1<$c?1:$c,this._saveToCmd($J._context._alpha,[$c])},$c.setAlpha=function($c){$c=$c<0?0:1<$c?1:$c,this._saveToCmd($J._context._setAlpha,[$c])},$c.transform=function($c,$d,$e){void 0===$d&&($d=0),void 0===$e&&($e=0),this._saveToCmd($J._context._transform,[$c,$d,$e])},$c.rotate=function($c,$d,$e){void 0===$d&&($d=0),void 0===$e&&($e=0),this._saveToCmd($J._context._rotate,[$c,$d,$e])},$c.scale=function($c,$d,$e,$f){void 0===$e&&($e=0),void 0===$f&&($f=0),this._saveToCmd($J._context._scale,[$c,$d,$e,$f])},$c.translate=function($c,$d){this._saveToCmd($J._context._translate,[$c,$d])},$c.save=function(){this._saveToCmd($J._context._save,[])},$c.restore=function(){this._saveToCmd($J._context._restore,[])},$c.replaceText=function($c){this._repaint();var $d=this._cmds;if($d){for(var $e=$d.length-1;-1<$e;$e--)if(this._isTextCmd($d[$e].callee))return $d[$e][0].toUpperCase?$d[$e][0]=$c:$d[$e][0].setText($c),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=$c:this._one[0].setText($c),!0;return!1},$c._isTextCmd=function($c){return $c===$J._context._fillText||$c===$J._context._fillBorderText||$c===$J._context._strokeText},$c.replaceTextColor=function($c){this._repaint();var $d=this._cmds;if($d)for(var $e=$d.length-1;-1<$e;$e--)this._isTextCmd($d[$e].callee)&&($d[$e][4]=$c,$d[$e][0].toUpperCase||($d[$e][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=$c,this._one[0].toUpperCase||(this._one[0].changed=!0))},$c.loadImage=function($c,$d,$e,$f,$g,$h){var $i=this;void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=0),void 0===$g&&($g=0);var $j=$jc.getRes($c);function $k($c){$c&&($i.drawTexture($c,$d,$e,$f,$g),null!=$h&&$h.call($i._sp,$c))}$j?$k($j):$z.loader.load($c,$u.create(null,$k),null,"image")},$c._renderEmpty=function($c,$d,$e,$f){},$c._renderAll=function($c,$d,$e,$f){for(var $g,$h=this._cmds,$i=0,$j=$h.length;$i<$j;$i++)($g=$h[$i]).callee.call($d,$e,$f,$g)},$c._renderOne=function($c,$d,$e,$f){this._one.callee.call($d,$e,$f,this._one)},$c._renderOneImg=function($c,$d,$e,$f){this._one.callee.call($d,$e,$f,this._one),2305!==$c._renderType&&($c._renderType|=1)},$c.drawLine=function($c,$d,$e,$f,$g,$h){void 0===$h&&($h=1);var $i=0;$J.isWebGL&&($i=$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($i));var $j=$h%2==0?0:.5,$k=[$c+$j,$d+$j,$e+$j,$f+$j,$g,$h,$i];this._saveToCmd($J._context._drawLine,$k)},$c.drawLines=function($c,$d,$e,$f,$g){void 0===$g&&($g=1);var $h=0;if($e&&!($e.length<4)){$J.isWebGL&&($h=$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($h));var $i=$g%2==0?0:.5,$j=[$c+$i,$d+$i,$e,$f,$g,$h];this._saveToCmd($J._context._drawLines,$j)}},$c.drawCurves=function($c,$d,$e,$f,$g){void 0===$g&&($g=1);var $h=[$c,$d,$e,$f,$g];this._saveToCmd($J._context._drawCurves,$h)},$c.drawRect=function($c,$d,$e,$f,$g,$h,$i){void 0===$i&&($i=1);var $j=$h?$i/2:0,$k=$h?$i:0,$l=[$c+$j,$d+$j,$e-$k,$f-$k,$g,$h,$i];this._saveToCmd($J._context._drawRect,$l)},$c.drawCircle=function($c,$d,$e,$f,$g,$h){void 0===$h&&($h=1);var $i=$g?$h/2:0,$j=0;$J.isWebGL&&($j=$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($j));var $k=[$c,$d,$e-$i,$f,$g,$h,$j];this._saveToCmd($J._context._drawCircle,$k)},$c.drawPie=function($c,$d,$e,$f,$g,$h,$i,$j){void 0===$j&&($j=1);var $k=$i?$j/2:0,$l=$i?$j:0,$m=0;$J.isWebGL&&($m=$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($m));var $n=[$c+$k,$d+$k,$e-$l,$f,$g,$h,$i,$j,$m];$n[3]=$$.toRadian($f),$n[4]=$$.toRadian($g),this._saveToCmd($J._context._drawPie,$n)},$c.drawPoly=function($c,$d,$e,$f,$g,$h){void 0===$h&&($h=1);var $i=0,$j=!1;$J.isWebGL&&($i=$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($i),$j=!(6<$e.length));var $k=$g?$h%2==0?0:.5:0,$l=[$c+$k,$d+$k,$e,$f,$g,$h,$i,$j];this._saveToCmd($J._context._drawPoly,$l)},$c.drawPath=function($c,$d,$e,$f,$g){var $h=[$c,$d,$e,$f,$g];this._saveToCmd($J._context._drawPath,$h)},$m(0,$c,"cmds",function(){return this._cmds},function($c){this._sp&&(this._sp._renderType|=512),this._cmds=$c,this._render=this._renderAll,this._repaint()}),$n.__init__=function(){if($J.isConchNode){for(var $c=laya.display.Graphics.prototype,$d=$O.window.ConchGraphics.prototype,$e=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],$f=0,$g=$e.length;$f<=$g;$f++){var $h=$e[$f];$c[$h]=$d[$h]}$c._saveToCmd=null,$d.drawImageS&&($c.drawTextures=function($c,$d){if($c&&$c.loaded&&$c.bitmap&&$c.source){var $e=$c.uv,$f=$c.bitmap.width,$g=$c.bitmap.height;this.drawImageS($c.bitmap.source,$e[0]*$f,$e[1]*$g,($e[2]-$e[0])*$f,($e[5]-$e[3])*$g,$c.offsetX,$c.offsetY,$c.width,$c.height,$d)}}),$c.drawTexture=function($c,$d,$e,$f,$g,$h,$i){if(void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=0),void 0===$g&&($g=0),void 0===$i&&($i=1),$c)if($c.loaded){if($c.loaded&&$c.bitmap&&$c.source&&($f||($f=$c.sourceWidth),$g||($g=$c.sourceHeight),$i=$i<0?0:1<$i?1:$i,$f=$f-$c.sourceWidth+$c.width,$g=$g-$c.sourceHeight+$c.height,!($f<=0||$g<=0))){$d+=$c.offsetX,$e+=$c.offsetY;var $j=$c.uv,$k=$c.bitmap.width,$l=$c.bitmap.height;$j[4]<$j[0]&&$j[5]<$j[1]?this.drawImageM($c.bitmap.source,$j[4]*$k,$j[5]*$l,($j[0]-$j[4])*$k,($j[1]-$j[5])*$l,$d,$e,$f,$g,$h,$i):this.drawImageM($c.bitmap.source,$j[0]*$k,$j[1]*$l,($j[2]-$j[0])*$k,($j[5]-$j[3])*$l,$d,$e,$f,$g,$h,$i),this._repaint()}}else $c.once("loaded",this,function(){this.drawTexture($c,$d,$e,$f,$g,$h)})},$c.fillTexture=function($c,$d,$e,$f,$g,$h,$i){if(void 0===$f&&($f=0),void 0===$g&&($g=0),void 0===$h&&($h="repeat"),$c&&$c.loaded){var $j,$k=$J._context.ctx,$l=$c.bitmap.width,$m=$c.bitmap.height,$n=$c.uv;$j=$c.uv!=$mc.DEF_UV?$k.createPattern($c.bitmap.source,$h,$n[0]*$l,$n[1]*$m,($n[2]-$n[0])*$l,($n[5]-$n[3])*$m):$k.createPattern($c.bitmap.source,$h);var $o=0,$p=0;$i&&($d+=$i.x%$c.width,$e+=$i.y%$c.height,$o-=$i.x%$c.width,$p-=$i.y%$c.height),this._fillImage($j,$d,$e,$o,$p,$f,$g)}}}},$n._cache=[],$n}(),$e=function(){function $v(){this._cacheBoundsType=!1}$r($v,"laya.display.GraphicsBounds");var $c=$v.prototype;return $c.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},$c.reset=function(){this._temp&&(this._temp.length=0)},$c.getBounds=function($c){return void 0===$c&&($c=!1),(!this._bounds||!this._temp||this._temp.length<1||$c!=this._cacheBoundsType)&&(this._bounds=$B._getWrapRec(this.getBoundPoints($c),this._bounds)),this._cacheBoundsType=$c,this._bounds},$c.getBoundPoints=function($c){return void 0===$c&&($c=!1),(!this._temp||this._temp.length<1||$c!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints($c)),this._cacheBoundsType=$c,this._rstBoundPoints=$$.copyArray(this._rstBoundPoints,this._temp)},$c._getCmdPoints=function($c){void 0===$c&&($c=!1);var $d,$e,$f=$J._context,$g=this._graphics.cmds;if(($d=this._temp||(this._temp=[])).length=0,$g||null==this._graphics._one||($v._tempCmds.length=0,$v._tempCmds.push(this._graphics._one),$g=$v._tempCmds),!$g)return $d;($e=$v._tempMatrixArrays).length=0;var $h=$v._initMatrix;$h.identity();for(var $i,$j,$k=$v._tempMatrix,$l=NaN,$m=NaN,$n=NaN,$o=NaN,$p=NaN,$q=NaN,$r=0,$s=$g.length;$r<$s;$r++)if(($i=$g[$r]).callee)switch($i.callee){case $f._save:case 7:$e.push($h),$h=$h.clone();break;case $f._restore:case 8:$h=$e.pop();break;case $f._scale:case 5:$k.identity(),$k.translate(-$i[2],-$i[3]),$k.scale($i[0],$i[1]),$k.translate($i[2],$i[3]),this._switchMatrix($h,$k);break;case $f._rotate:case 3:$k.identity(),$k.translate(-$i[1],-$i[2]),$k.rotate($i[0]),$k.translate($i[1],$i[2]),this._switchMatrix($h,$k);break;case $f._translate:case 6:$k.identity(),$k.translate($i[0],$i[1]),this._switchMatrix($h,$k);break;case $f._transform:case 4:$k.identity(),$k.translate(-$i[1],-$i[2]),$k.concat($i[0]),$k.translate($i[1],$i[2]),this._switchMatrix($h,$k);break;case 16:case 24:$v._addPointArrToRst($d,$B._getBoundPointS($i[0],$i[1],$i[2],$i[3]),$h);break;case 17:$h.copyTo($k),$k.concat($i[4]),$v._addPointArrToRst($d,$B._getBoundPointS($i[0],$i[1],$i[2],$i[3]),$k);break;case $f._drawTexture:$j=$i[0],$c?$i[3]&&$i[4]?$v._addPointArrToRst($d,$B._getBoundPointS($i[1],$i[2],$i[3],$i[4]),$h):($j=$i[0],$v._addPointArrToRst($d,$B._getBoundPointS($i[1],$i[2],$j.width,$j.height),$h)):($l=($i[3]||$j.sourceWidth)/$j.width,$m=($i[4]||$j.sourceHeight)/$j.height,$n=$l*$j.sourceWidth,$o=$m*$j.sourceHeight,$p=0<$j.offsetX?$j.offsetX:0,$q=0<$j.offsetY?$j.offsetY:0,$p*=$l,$q*=$m,$v._addPointArrToRst($d,$B._getBoundPointS($i[1]-$p,$i[2]-$q,$n,$o),$h));break;case $f._fillTexture:$i[3]&&$i[4]?$v._addPointArrToRst($d,$B._getBoundPointS($i[1],$i[2],$i[3],$i[4]),$h):($j=$i[0],$v._addPointArrToRst($d,$B._getBoundPointS($i[1],$i[2],$j.width,$j.height),$h));break;case $f._drawTextureWithTransform:var $t;$t=$i[5]?($h.copyTo($k),$k.concat($i[5]),$k):$h,$c?$i[3]&&$i[4]?$v._addPointArrToRst($d,$B._getBoundPointS($i[1],$i[2],$i[3],$i[4]),$t):($j=$i[0],$v._addPointArrToRst($d,$B._getBoundPointS($i[1],$i[2],$j.width,$j.height),$t)):($j=$i[0],$l=($i[3]||$j.sourceWidth)/$j.width,$m=($i[4]||$j.sourceHeight)/$j.height,$n=$l*$j.sourceWidth,$o=$m*$j.sourceHeight,$p=0<$j.offsetX?$j.offsetX:0,$q=0<$j.offsetY?$j.offsetY:0,$p*=$l,$q*=$m,$v._addPointArrToRst($d,$B._getBoundPointS($i[1]-$p,$i[2]-$q,$n,$o),$t));break;case $f._drawRect:case 13:$v._addPointArrToRst($d,$B._getBoundPointS($i[0],$i[1],$i[2],$i[3]),$h);break;case $f._drawCircle:case $f._fillCircle:case 14:$v._addPointArrToRst($d,$B._getBoundPointS($i[0]-$i[2],$i[1]-$i[2],$i[2]+$i[2],$i[2]+$i[2]),$h);break;case $f._drawLine:case 20:$v._tempPoints.length=0;var $u;$u=.5*$i[5],$i[0]==$i[2]?$v._tempPoints.push($i[0]+$u,$i[1],$i[2]+$u,$i[3],$i[0]-$u,$i[1],$i[2]-$u,$i[3]):$i[1]==$i[3]?$v._tempPoints.push($i[0],$i[1]+$u,$i[2],$i[3]+$u,$i[0],$i[1]-$u,$i[2],$i[3]-$u):$v._tempPoints.push($i[0],$i[1],$i[2],$i[3]),$v._addPointArrToRst($d,$v._tempPoints,$h);break;case $f._drawCurves:case 22:$v._addPointArrToRst($d,$w.I.getBezierPoints($i[2]),$h,$i[0],$i[1]);break;case $f._drawPoly:case $f._drawLines:case 18:$v._addPointArrToRst($d,$i[2],$h,$i[0],$i[1]);break;case $f._drawPath:case 19:$v._addPointArrToRst($d,this._getPathPoints($i[2]),$h,$i[0],$i[1]);break;case $f._drawPie:case 15:$v._addPointArrToRst($d,this._getPiePoints($i[0],$i[1],$i[2],$i[3],$i[4]),$h)}return 200<$d.length?$d=$$.copyArray($d,$B._getWrapRec($d)._getBoundPoints()):8<$d.length&&($d=$x.scanPList($d)),$d},$c._switchMatrix=function($c,$d){$d.concat($c),$d.copyTo($c)},$c._getPiePoints=function($c,$d,$e,$f,$g){var $h=$v._tempPoints;$v._tempPoints.length=0,$h.push($c,$d);var $i=($g-$f)%(2*Math.PI)/10,$j=NaN,$k=$f;for($j=0;$j<=10;$j++)$h.push($c+$e*Math.cos($k),$d+$e*Math.sin($k)),$k+=$i;return $h},$c._getPathPoints=function($c){var $d,$e,$f=0,$g=$v._tempPoints;for($g.length=0,$d=$c.length,$f=0;$f<$d;$f++)1<($e=$c[$f]).length&&($g.push($e[1],$e[2]),3<$e.length&&$g.push($e[3],$e[4]));return $g},$v._addPointArrToRst=function($c,$d,$e,$f,$g){void 0===$f&&($f=0),void 0===$g&&($g=0);var $h,$i=0;for($h=$d.length,$i=0;$i<$h;$i+=2)$v._addPointToRst($c,$d[$i]+$f,$d[$i+1]+$g,$e)},$v._addPointToRst=function($c,$d,$e,$f){var $g=$A.TEMP;$g.setTo($d||0,$e||0),$f.transformPoint($g),$c.push($g.x,$g.y)},$v._tempPoints=[],$v._tempMatrixArrays=[],$v._tempCmds=[],$k($v,["_tempMatrix",function(){return this._tempMatrix=new $G},"_initMatrix",function(){return this._initMatrix=new $G}]),$v}(),$h=function(){function $c(){}$r($c,"laya.events.Event");var $d=$c.prototype;return $d.setTo=function($c,$d,$e){return this.type=$c,this.currentTarget=$d,this.target=$e,this},$d.stopPropagation=function(){this._stoped=!0},$m(0,$d,"stageY",function(){return $z.stage.mouseY}),$m(0,$d,"charCode",function(){return this.nativeEvent.charCode}),$m(0,$d,"touches",function(){var $c=this.nativeEvent.touches;if($c)for(var $d=$z.stage,$e=0,$f=$c.length;$e<$f;$e++){var $g=$c[$e],$h=$A.TEMP;$h.setTo($g.clientX,$g.clientY),$d._canvasTransform.invertTransformPoint($h),$d.transform.invertTransformPoint($h),$g.stageX=$h.x,$g.stageY=$h.y}return $c}),$m(0,$d,"keyLocation",function(){return this.nativeEvent.keyLocation}),$m(0,$d,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),$m(0,$d,"altKey",function(){return this.nativeEvent.altKey}),$m(0,$d,"shiftKey",function(){return this.nativeEvent.shiftKey}),$m(0,$d,"stageX",function(){return $z.stage.mouseX}),$c.EMPTY=new $c,$c.MOUSE_DOWN="mousedown",$c.MOUSE_UP="mouseup",$c.CLICK="click",$c.RIGHT_MOUSE_DOWN="rightmousedown",$c.RIGHT_MOUSE_UP="rightmouseup",$c.RIGHT_CLICK="rightclick",$c.MOUSE_MOVE="mousemove",$c.MOUSE_OVER="mouseover",$c.MOUSE_OUT="mouseout",$c.MOUSE_WHEEL="mousewheel",$c.ROLL_OVER="mouseover",$c.ROLL_OUT="mouseout",$c.DOUBLE_CLICK="doubleclick",$c.CHANGE="change",$c.CHANGED="changed",$c.RESIZE="resize",$c.ADDED="added",$c.REMOVED="removed",$c.DISPLAY="display",$c.UNDISPLAY="undisplay",$c.ERROR="error",$c.COMPLETE="complete",$c.LOADED="loaded",$c.INITED="inited",$c.PROGRESS="progress",$c.INPUT="input",$c.RENDER="render",$c.OPEN="open",$c.MESSAGE="message",$c.CLOSE="close",$c.KEY_DOWN="keydown",$c.KEY_PRESS="keypress",$c.KEY_UP="keyup",$c.FRAME="enterframe",$c.DRAG_START="dragstart",$c.DRAG_MOVE="dragmove",$c.DRAG_END="dragend",$c.ENTER="enter",$c.SELECT="select",$c.BLUR="blur",$c.FOCUS="focus",$c.VISIBILITY_CHANGE="visibilitychange",$c.FOCUS_CHANGE="focuschange",$c.PLAYED="played",$c.PAUSED="paused",$c.STOPPED="stopped",$c.START="start",$c.END="end",$c.ENABLE_CHANGED="enablechanged",$c.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",$c.COMPONENT_ADDED="componentadded",$c.COMPONENT_REMOVED="componentremoved",$c.LAYER_CHANGED="layerchanged",$c.HIERARCHY_LOADED="hierarchyloaded",$c.RECOVERED="recovered",$c.RELEASED="released",$c.LINK="link",$c.LABEL="label",$c.FULL_SCREEN_CHANGE="fullscreenchange",$c.DEVICE_LOST="devicelost",$c.MESH_CHANGED="meshchanged",$c.MATERIAL_CHANGED="materialchanged",$c.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",$c.ANIMATION_CHANGED="animationchanged",$c.TRIGGER_ENTER="triggerenter",$c.TRIGGER_STAY="triggerstay",$c.TRIGGER_EXIT="triggerexit",$c.TRAIL_FILTER_CHANGE="trailfilterchange",$c.DOMINO_FILTER_CHANGE="dominofilterchange",$c}(),$n=(function(){function $c(){}$r($c,"laya.events.Keyboard"),$c.NUMBER_0=48,$c.NUMBER_1=49,$c.NUMBER_2=50,$c.NUMBER_3=51,$c.NUMBER_4=52,$c.NUMBER_5=53,$c.NUMBER_6=54,$c.NUMBER_7=55,$c.NUMBER_8=56,$c.NUMBER_9=57,$c.A=65,$c.B=66,$c.C=67,$c.D=68,$c.E=69,$c.F=70,$c.G=71,$c.H=72,$c.I=73,$c.J=74,$c.K=75,$c.L=76,$c.M=77,$c.N=78,$c.O=79,$c.P=80,$c.Q=81,$c.R=82,$c.S=83,$c.T=84,$c.U=85,$c.V=86,$c.W=87,$c.X=88,$c.Y=89,$c.Z=90,$c.F1=112,$c.F2=113,$c.F3=114,$c.F4=115,$c.F5=116,$c.F6=117,$c.F7=118,$c.F8=119,$c.F9=120,$c.F10=121,$c.F11=122,$c.F12=123,$c.F13=124,$c.F14=125,$c.F15=126,$c.NUMPAD=21,$c.NUMPAD_0=96,$c.NUMPAD_1=97,$c.NUMPAD_2=98,$c.NUMPAD_3=99,$c.NUMPAD_4=100,$c.NUMPAD_5=101,$c.NUMPAD_6=102,$c.NUMPAD_7=103,$c.NUMPAD_8=104,$c.NUMPAD_9=105,$c.NUMPAD_ADD=107,$c.NUMPAD_DECIMAL=110,$c.NUMPAD_DIVIDE=111,$c.NUMPAD_ENTER=108,$c.NUMPAD_MULTIPLY=106,$c.NUMPAD_SUBTRACT=109,$c.SEMICOLON=186,$c.EQUAL=187,$c.COMMA=188,$c.MINUS=189,$c.PERIOD=190,$c.SLASH=191,$c.BACKQUOTE=192,$c.LEFTBRACKET=219,$c.BACKSLASH=220,$c.RIGHTBRACKET=221,$c.QUOTE=222,$c.ALTERNATE=18,$c.BACKSPACE=8,$c.CAPS_LOCK=20,$c.COMMAND=15,$c.CONTROL=17,$c.DELETE=46,$c.ENTER=13,$c.ESCAPE=27,$c.PAGE_UP=33,$c.PAGE_DOWN=34,$c.END=35,$c.HOME=36,$c.LEFT=37,$c.UP=38,$c.RIGHT=39,$c.DOWN=40,$c.SHIFT=16,$c.SPACE=32,$c.TAB=9,$c.INSERT=45}(),function(){function $g(){}return $r($g,"laya.events.KeyBoardManager"),$g.__init__=function(){$g._addEvent("keydown"),$g._addEvent("keypress"),$g._addEvent("keyup")},$g._addEvent=function($d){$O.document.addEventListener($d,function($c){laya.events.KeyBoardManager._dispatch($c,$d)},!0)},$g._dispatch=function($c,$d){if($g.enabled){$g._event._stoped=!1,$g._event.nativeEvent=$c,$g._event.keyCode=$c.keyCode||$c.which||$c.charCode,"keydown"===$d?$g._pressKeys[$g._event.keyCode]=!0:"keyup"===$d&&($g._pressKeys[$g._event.keyCode]=null);for(var $e=$z.stage.focus&&null!=$z.stage.focus.event&&$z.stage.focus.displayedInStage?$z.stage.focus:$z.stage,$f=$e;$f;)$f.event($d,$g._event.setTo($d,$f,$e)),$f=$f.parent}},$g.hasKeyDown=function($c){return $g._pressKeys[$c]},$g._pressKeys={},$g.enabled=!0,$k($g,["_event",function(){return this._event=new $h}]),$g}()),$q=(function(){function $c(){}$r($c,"laya.events.KeyLocation"),$c.STANDARD=0,$c.LEFT=1,$c.RIGHT=2,$c.NUM_PAD=3}(),function(){function $m(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=$O.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new $h,this._matrix=new $G,this._point=new $A,this._rect=new $B,this._prePoint=new $A,this._curTouchID=NaN}$r($m,"laya.events.MouseManager");var $c=$m.prototype;return $c.__init__=function($c,$d){var $e=this;this._stage=$c;var $f=this,$g=this._eventList;$d.oncontextmenu=function($c){if($m.enabled)return!1},$d.addEventListener("mousedown",function($c){$m.enabled&&($O.onIE||$c.preventDefault(),$g.push($c),$f.mouseDownTime=$O.now())}),$d.addEventListener("mouseup",function($c){$m.enabled&&($c.preventDefault(),$g.push($c),$f.mouseDownTime=-$O.now())},!0),$d.addEventListener("mousemove",function($c){if($m.enabled){$c.preventDefault();var $d=$O.now();if($d-$f._lastMoveTimer<10)return;$f._lastMoveTimer=$d,$g.push($c)}},!0),$d.addEventListener("mouseout",function($c){$m.enabled&&$g.push($c)}),$d.addEventListener("mouseover",function($c){$m.enabled&&$g.push($c)}),$d.addEventListener("touchstart",function($c){$m.enabled&&($g.push($c),$m._isFirstTouch||$xc.isInputting||$c.preventDefault(),$f.mouseDownTime=$O.now())}),$d.addEventListener("touchend",function($c){$m.enabled?($m._isFirstTouch||$xc.isInputting||$c.preventDefault(),$m._isFirstTouch=!1,$g.push($c),$f.mouseDownTime=-$O.now()):$e._curTouchID=NaN},!0),$d.addEventListener("touchmove",function($c){$m.enabled&&($c.preventDefault(),$g.push($c))},!0),$d.addEventListener("touchcancel",function($c){$m.enabled?($c.preventDefault(),$g.push($c)):$e._curTouchID=NaN},!0),$d.addEventListener("mousewheel",function($c){$m.enabled&&$g.push($c)}),$d.addEventListener("DOMMouseScroll",function($c){$m.enabled&&$g.push($c)})},$c.initEvent=function($c,$d){var $e;this._event._stoped=!1,this._event.nativeEvent=$d||$c,this._target=null,this._point.setTo($c.pageX||$c.clientX,$c.pageY||$c.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=$c.identifier||0,this._tTouchID=this._event.touchId,($e=$s.I._event)._stoped=!1,$e.nativeEvent=this._event.nativeEvent,$e.touchId=this._event.touchId},$c.checkMouseWheel=function($c){this._event.delta=$c.wheelDelta?.025*$c.wheelDelta:-$c.detail;for(var $d=$s.I.getLastOvers(),$e=0,$f=$d.length;$e<$f;$e++){var $g=$d[$e];$g.event("mousewheel",this._event.setTo("mousewheel",$g,this._target))}},$c.onMouseMove=function($c){$s.I.onMouseMove($c,this._tTouchID)},$c.onMouseDown=function($c){if($xc.isInputting&&$z.stage.focus&&$z.stage.focus.focus&&!$z.stage.focus.contains(this._target)){var $d=$z.stage.focus._tf||$z.stage.focus,$e=$c._tf||$c;$e instanceof laya.display.Input&&$e.multiline==$d.multiline?$d._focusOut():$d.focus=!1}$s.I.onMouseDown($c,this._tTouchID,this._isLeftMouse)},$c.onMouseUp=function($c){$s.I.onMouseUp($c,this._tTouchID,this._isLeftMouse)},$c.check=function($c,$d,$e,$f){this._point.setTo($d,$e),$c.fromParentPoint(this._point),$d=this._point.x,$e=this._point.y;var $g=$c.scrollRect;if($g&&(this._rect.setTo($g.x,$g.y,$g.width,$g.height),!this._rect.contains($d,$e)))return!1;if(!this.disableMouseEvent){if($c.hitTestPrior&&!$c.mouseThrough&&!this.hitTest($c,$d,$e))return!1;for(var $h=$c._childs.length-1;-1<$h;$h--){var $i=$c._childs[$h];if(!$i.destroyed&&$i.mouseEnabled&&$i.visible&&this.check($i,$d,$e,$f))return!0}}var $j=!(!$c.hitTestPrior||$c.mouseThrough||this.disableMouseEvent)||this.hitTest($c,$d,$e);return $j?(this._target=$c,$f.call(this,$c)):$f===this.onMouseUp&&$c===this._stage&&(this._target=this._stage,$f.call(this,this._target)),$j},$c.hitTest=function($c,$d,$e){var $f=!1;if($c.scrollRect&&($d-=$c.scrollRect.x,$e-=$c.scrollRect.y),$c.hitArea instanceof laya.utils.HitArea)return $c.hitArea.isHit($d,$e);if(0<$c.width&&0<$c.height||$c.mouseThrough||$c.hitArea)if($c.mouseThrough)$f=$c.getGraphicBounds().contains($d,$e);else{var $g=this._rect;$c.hitArea?$g=$c.hitArea:$g.setTo(0,0,$c.width,$c.height),$f=$g.contains($d,$e)}return $f},$c.runEvent=function(){var $c=this._eventList.length;if($c){var $d=this;$d.mouseEventTime=$O.now();var $e,$f=0,$g=0,$h=0;try{for(;$f<$c;){var $i=this._eventList[$f];switch("mousemove"!==$i.type&&(this._prePoint.x=this._prePoint.y=-1e6),$i.type){case"mousedown":this._touchIDs[0]=this._id++,$m._isTouchRespond?$m._isTouchRespond=!1:($d._isLeftMouse=0===$i.button,$d.initEvent($i),$d.check($d._stage,$d.mouseX,$d.mouseY,$d.onMouseDown));break;case"mouseup":$d._isLeftMouse=0===$i.button,$d.initEvent($i),$d.check($d._stage,$d.mouseX,$d.mouseY,$d.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-$i.clientX)+Math.abs(this._prePoint.y-$i.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=$i.clientX,this._prePoint.y=$i.clientY,$d.initEvent($i),$d.check($d._stage,$d.mouseX,$d.mouseY,$d.onMouseMove));break;case"touchstart":$m._isTouchRespond=!0,$d._isLeftMouse=!0;var $j=$i.changedTouches;for($g=0,$h=$j.length;$g<$h;$g++)$e=$j[$g],($m.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=$e.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[$e.identifier]=this._id++,$d.initEvent($e,$i),$d.check($d._stage,$d.mouseX,$d.mouseY,$d.onMouseDown));break;case"touchend":case"touchcancel":$m._isTouchRespond=!0,$d._isLeftMouse=!0;var $k=$i.changedTouches;for($g=0,$h=$k.length;$g<$h;$g++)if($e=$k[$g],$m.multiTouchEnabled||$e.identifier==this._curTouchID){this._curTouchID=NaN,$d.initEvent($e,$i);$d.check($d._stage,$d.mouseX,$d.mouseY,$d.onMouseUp)||$d.onMouseUp(null)}break;case"touchmove":var $l=$i.changedTouches;for($g=0,$h=$l.length;$g<$h;$g++)$e=$l[$g],($m.multiTouchEnabled||$e.identifier==this._curTouchID)&&($d.initEvent($e,$i),$d.check($d._stage,$d.mouseX,$d.mouseY,$d.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":$d.checkMouseWheel($i);break;case"mouseout":$s.I.stageMouseOut();break;case"mouseover":$d._stage.event("mouseover",$d._event.setTo("mouseover",$d._stage,$d._stage))}$f++}}catch($c){throw this._eventList.length=0,$c}this._eventList.length=0}},$m.enabled=!0,$m.multiTouchEnabled=!0,$m._isTouchRespond=!1,$m._isFirstTouch=!0,$k($m,["instance",function(){return this.instance=new $m}]),$m}()),$s=function(){function $q(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new $h}$r($q,"laya.events.TouchManager");var $c=$q.prototype;return $c._clearTempArrs=function(){$q._oldArr.length=0,$q._newArr.length=0,$q._tEleArr.length=0},$c.getTouchFromArr=function($c,$d){var $e,$f,$g=0;for($e=$d.length,$g=0;$g<$e;$g++)if(($f=$d[$g]).id==$c)return $f;return null},$c.removeTouchFromArr=function($c,$d){var $e=0;for($e=$d.length-1;0<=$e;$e--)$d[$e].id==$c&&$d.splice($e,1)},$c.createTouchO=function($c,$d){var $e;return($e=$W.getItem("TouchData")||{}).id=$d,$e.tar=$c,$e},$c.onMouseDown=function($c,$d,$e){var $f,$g,$h,$i;(void 0===$e&&($e=!1),this.enable)&&($f=this.getTouchFromArr($d,this.preOvers),$h=this.getEles($c,null,$q._tEleArr),$f?$f.tar=$c:($g=this.createTouchO($c,$d),this.preOvers.push($g)),$O.onMobile&&this.sendEvents($h,"mouseover",$d),$i=$e?this.preDowns:this.preRightDowns,($f=this.getTouchFromArr($d,$i))?$f.tar=$c:($g=this.createTouchO($c,$d),$i.push($g)),this.sendEvents($h,$e?"mousedown":"rightmousedown",$d),this._clearTempArrs())},$c.sendEvents=function($c,$d,$e){void 0===$e&&($e=0);var $f,$g,$h,$i=0;for($f=$c.length,this._event._stoped=!1,$g=$c[0],$i=0;$i<$f;$i++){if(($h=$c[$i]).destroyed)return;if($h.event($d,this._event.setTo($d,$h,$g)),this._event._stoped)break}},$c.getEles=function($c,$d,$e){for($e?$e.length=0:$e=[];$c&&$c!=$d;)$e.push($c),$c=$c.parent;return $e},$c.checkMouseOutAndOverOfMove=function($c,$d,$e){if(void 0===$e&&($e=0),$d!=$c){var $f,$g,$h=0,$i=0;if($d.contains($c))$g=this.getEles($c,$d,$q._tEleArr),this.sendEvents($g,"mouseover",$e);else if($c.contains($d))$g=this.getEles($d,$c,$q._tEleArr),this.sendEvents($g,"mouseout",$e);else{var $j,$k;($g=$q._tEleArr).length=0,$j=this.getEles($d,null,$q._oldArr),$k=this.getEles($c,null,$q._newArr),$i=$j.length;var $l=0;for($h=0;$h<$i;$h++){if($f=$j[$h],0<=($l=$k.indexOf($f))){$k.splice($l,$k.length-$l);break}$g.push($f)}0<$g.length&&this.sendEvents($g,"mouseout",$e),0<$k.length&&this.sendEvents($k,"mouseover",$e)}}},$c.onMouseMove=function($c,$d){var $e,$f;this.enable&&(($e=this.getTouchFromArr($d,this.preOvers))?(this.checkMouseOutAndOverOfMove($c,$e.tar),$e.tar=$c,$f=this.getEles($c,null,$q._tEleArr)):($f=this.getEles($c,null,$q._tEleArr),this.sendEvents($f,"mouseover",$d),this.preOvers.push(this.createTouchO($c,$d))),this.sendEvents($f,"mousemove",$d),this._clearTempArrs())},$c.getLastOvers=function(){return($q._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,$q._tEleArr):($q._tEleArr.push($z.stage),$q._tEleArr)},$c.stageMouseOut=function(){var $c;$c=this.getLastOvers(),this.preOvers.length=0,this.sendEvents($c,"mouseout",0)},$c.onMouseUp=function($c,$d,$e){if(void 0===$e&&($e=!1),this.enable){var $f,$g,$h,$i,$j,$k,$l=0,$m=0,$n=$O.onMobile;if($g=this.getEles($c,null,$q._tEleArr),this.sendEvents($g,$e?"mouseup":"rightmouseup",$d),$k=$e?this.preDowns:this.preRightDowns,$f=this.getTouchFromArr($d,$k)){var $o,$p=$O.now();if($o=$p-this._lastClickTime<300,this._lastClickTime=$p,$c==$f.tar)$j=$g;else for($h=this.getEles($f.tar,null,$q._oldArr),($j=$q._newArr).length=0,$m=$h.length,$l=0;$l<$m;$l++)$i=$h[$l],0<=$g.indexOf($i)&&$j.push($i);0<$j.length&&this.sendEvents($j,$e?"click":"rightclick",$d),$e&&$o&&this.sendEvents($j,"doubleclick",$d),this.removeTouchFromArr($d,$k),$f.tar=null,$W.recover("TouchData",$f)}else;($f=this.getTouchFromArr($d,this.preOvers))&&$n&&(($j=this.getEles($f.tar,null,$j))&&0<$j.length&&this.sendEvents($j,"mouseout",$d),this.removeTouchFromArr($d,this.preOvers),$f.tar=null,$W.recover("TouchData",$f)),this._clearTempArrs()}},$q._oldArr=[],$q._newArr=[],$q._tEleArr=[],$k($q,["I",function(){return this.I=new $q}]),$q}(),$t=function(){function $c(){this._action=null}$r($c,"laya.filters.Filter");var $d=$c.prototype;return $z.imps($d,{"laya.filters.IFilter":!0}),$d.callNative=function($c){},$m(0,$d,"type",function(){return-1}),$m(0,$d,"action",function(){return this._action}),$c.BLUR=16,$c.COLOR=32,$c.GLOW=8,$c._filterStart=null,$c._filterEnd=null,$c._EndTarget=null,$c._recycleScope=null,$c._filter=null,$c._useSrc=null,$c._endSrc=null,$c._useOut=null,$c._endOut=null,$c}(),$v=function(){function $c(){this.data=null}$r($c,"laya.filters.ColorFilterAction");var $d=$c.prototype;return $z.imps($d,{"laya.filters.IFilterAction":!0}),$d.apply=function($c){var $d=$c.ctx.ctx,$e=$c.ctx.ctx.canvas;if(0==$e.width||0==$e.height)return $e;for(var $f,$g=$d.getImageData(0,0,$e.width,$e.height),$h=$g.data,$i=0,$j=$h.length;$i<$j;$i+=4)$f=this.getColor($h[$i],$h[$i+1],$h[$i+2],$h[$i+3]),0!=$h[$i+3]&&($h[$i]=$f[0],$h[$i+1]=$f[1],$h[$i+2]=$f[2],$h[$i+3]=$f[3]);return $d.putImageData($g,0,0),$c},$d.getColor=function($c,$d,$e,$f){var $g=[];if(this.data._mat&&this.data._alpha){var $h=this.data._mat,$i=this.data._alpha;$g[0]=$h[0]*$c+$h[1]*$d+$h[2]*$e+$h[3]*$f+$i[0],$g[1]=$h[4]*$c+$h[5]*$d+$h[6]*$e+$h[7]*$f+$i[1],$g[2]=$h[8]*$c+$h[9]*$d+$h[10]*$e+$h[11]*$f+$i[2],$g[3]=$h[12]*$c+$h[13]*$d+$h[14]*$e+$h[15]*$f+$i[3]}return $g},$c}(),$w=(function(){function $c(){}$r($c,"laya.maths.Arith"),$c.formatR=function($c){return $c>Math.PI&&($c-=2*Math.PI),$c<-Math.PI&&($c+=2*Math.PI),$c},$c.isPOT=function($c,$d){return 0<$c&&0==($c&$c-1)&&0<$d&&0==($d&$d-1)},$c.setMatToArray=function($c,$d){$c.a,$c.b,$c.c,$c.d,$c.tx,$c.ty,$d[0]=$c.a,$d[1]=$c.b,$d[4]=$c.c,$d[5]=$c.d,$d[12]=$c.tx,$d[13]=$c.ty}}(),function(){function $c(){this._controlPoints=[new $A,new $A,new $A],this._calFun=this.getPoint2}$r($c,"laya.maths.Bezier");var $d=$c.prototype;return $d._switchPoint=function($c,$d){var $e=this._controlPoints.shift();$e.setTo($c,$d),this._controlPoints.push($e)},$d.getPoint2=function($c,$d){var $e=this._controlPoints[0],$f=this._controlPoints[1],$g=this._controlPoints[2],$h=Math.pow(1-$c,2)*$e.x+2*$c*(1-$c)*$f.x+Math.pow($c,2)*$g.x,$i=Math.pow(1-$c,2)*$e.y+2*$c*(1-$c)*$f.y+Math.pow($c,2)*$g.y;$d.push($h,$i)},$d.getPoint3=function($c,$d){var $e=this._controlPoints[0],$f=this._controlPoints[1],$g=this._controlPoints[2],$h=this._controlPoints[3],$i=Math.pow(1-$c,3)*$e.x+3*$f.x*$c*(1-$c)*(1-$c)+3*$g.x*$c*$c*(1-$c)+$h.x*Math.pow($c,3),$j=Math.pow(1-$c,3)*$e.y+3*$f.y*$c*(1-$c)*(1-$c)+3*$g.y*$c*$c*(1-$c)+$h.y*Math.pow($c,3);$d.push($i,$j)},$d.insertPoints=function($c,$d){var $e,$f=NaN;for($e=1/($c=0<$c?$c:5),$f=0;$f<=1;$f+=$e)this._calFun($f,$d)},$d.getBezierPoints=function($c,$d,$e){void 0===$d&&($d=5),void 0===$e&&($e=2);var $f,$g,$h=0;if(($f=$c.length)<2*($e+1))return[];switch($g=[],$e){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=$e;)this._controlPoints.push(new $A);for($h=0;$h<2*$e;$h+=2)this._switchPoint($c[$h],$c[$h+1]);for($h=2*$e;$h<$f;$h+=2)this._switchPoint($c[$h],$c[$h+1]),$h/2%$e==0&&this.insertPoints($d,$g);return $g},$k($c,["I",function(){return this.I=new $c}]),$c}()),$x=function(){function $l(){}return $r($l,"laya.maths.GrahamScan"),$l.multiply=function($c,$d,$e){return($c.x-$e.x)*($d.y-$e.y)-($d.x-$e.x)*($c.y-$e.y)},$l.dis=function($c,$d){return($c.x-$d.x)*($c.x-$d.x)+($c.y-$d.y)*($c.y-$d.y)},$l._getPoints=function($c,$d,$e){for(void 0===$d&&($d=!1),$l._mPointList||($l._mPointList=[]);$l._mPointList.length<$c;)$l._mPointList.push(new $A);return $e||($e=[]),$e.length=0,$d?$l.getFrom($e,$l._mPointList,$c):$l.getFromR($e,$l._mPointList,$c),$e},$l.getFrom=function($c,$d,$e){var $f=0;for($f=0;$f<$e;$f++)$c.push($d[$f]);return $c},$l.getFromR=function($c,$d,$e){var $f=0;for($f=0;$f<$e;$f++)$c.push($d.pop());return $c},$l.pListToPointList=function($c,$d){void 0===$d&&($d=!1);var $e=0,$f=$c.length/2,$g=$l._getPoints($f,$d,$l._tempPointList);for($e=0;$e<$f;$e++)$g[$e].setTo($c[$e+$e],$c[$e+$e+1]);return $g},$l.pointListToPlist=function($c){var $d,$e=0,$f=$c.length,$g=$l._temPList;for($e=$g.length=0;$e<$f;$e++)$d=$c[$e],$g.push($d.x,$d.y);return $g},$l.scanPList=function($c){return $$.copyArray($c,$l.pointListToPlist($l.scan($l.pListToPointList($c,!0))))},$l.scan=function($c){var $d,$e,$f,$g=0,$h=0,$i=0,$j=$c.length,$k={};for(($e=$l._temArr).length=0,$g=($j=$c.length)-1;0<=$g;$g--)$f=($d=$c[$g]).x+"_"+$d.y,$k.hasOwnProperty($f)||($k[$f]=!0,$e.push($d));for($j=$e.length,$$.copyArray($c,$e),$g=1;$g<$j;$g++)($c[$g].y<$c[$i].y||$c[$g].y==$c[$i].y&&$c[$g].x<$c[$i].x)&&($i=$g);for($d=$c[0],$c[0]=$c[$i],$c[$i]=$d,$g=1;$g<$j-1;$g++){for($h=($i=$g)+1;$h<$j;$h++)(0<$l.multiply($c[$h],$c[$i],$c[0])||0==$l.multiply($c[$h],$c[$i],$c[0])&&$l.dis($c[0],$c[$h])<$l.dis($c[0],$c[$i]))&&($i=$h);$d=$c[$g],$c[$g]=$c[$i],$c[$i]=$d}if(($e=$l._temArr).length=0,$c.length<3)return $$.copyArray($e,$c);for($e.push($c[0],$c[1],$c[2]),$g=3;$g<$j;$g++){for(;2<=$e.length&&0<=$l.multiply($c[$g],$e[$e.length-1],$e[$e.length-2]);)$e.pop();$c[$g]&&$e.push($c[$g])}return $e},$l._mPointList=null,$l._tempPointList=[],$l._temPList=[],$l._temArr=[],$l}(),$y=function(){function $g(){}return $r($g,"laya.maths.MathUtil"),$g.subtractVector3=function($c,$d,$e){$e[0]=$c[0]-$d[0],$e[1]=$c[1]-$d[1],$e[2]=$c[2]-$d[2]},$g.lerp=function($c,$d,$e){return $c*(1-$e)+$d*$e},$g.scaleVector3=function($c,$d,$e){$e[0]=$c[0]*$d,$e[1]=$c[1]*$d,$e[2]=$c[2]*$d},$g.lerpVector3=function($c,$d,$e,$f){var $g=$c[0],$h=$c[1],$i=$c[2];$f[0]=$g+$e*($d[0]-$g),$f[1]=$h+$e*($d[1]-$h),$f[2]=$i+$e*($d[2]-$i)},$g.lerpVector4=function($c,$d,$e,$f){var $g=$c[0],$h=$c[1],$i=$c[2],$j=$c[3];$f[0]=$g+$e*($d[0]-$g),$f[1]=$h+$e*($d[1]-$h),$f[2]=$i+$e*($d[2]-$i),$f[3]=$j+$e*($d[3]-$j)},$g.slerpQuaternionArray=function($c,$d,$e,$f,$g,$h,$i){var $j,$k,$l,$m,$n,$o=$c[$d+0],$p=$c[$d+1],$q=$c[$d+2],$r=$c[$d+3],$s=$e[$f+0],$t=$e[$f+1],$u=$e[$f+2],$v=$e[$f+3];return($k=$o*$s+$p*$t+$q*$u+$r*$v)<0&&($k=-$k,$s=-$s,$t=-$t,$u=-$u,$v=-$v),$n=1e-6<1-$k?($j=Math.acos($k),$l=Math.sin($j),$m=Math.sin((1-$g)*$j)/$l,Math.sin($g*$j)/$l):($m=1-$g,$g),$h[$i+0]=$m*$o+$n*$s,$h[$i+1]=$m*$p+$n*$t,$h[$i+2]=$m*$q+$n*$u,$h[$i+3]=$m*$r+$n*$v,$h},$g.getRotation=function($c,$d,$e,$f){return Math.atan2($f-$d,$e-$c)/Math.PI*180},$g.sortBigFirst=function($c,$d){return $c==$d?0:$c<$d?1:-1},$g.sortSmallFirst=function($c,$d){return $c==$d?0:$c<$d?-1:1},$g.sortNumBigFirst=function($c,$d){return parseFloat($d)-parseFloat($c)},$g.sortNumSmallFirst=function($c,$d){return parseFloat($c)-parseFloat($d)},$g.sortByKey=function($e,$c,$d){var $f;return void 0===$c&&($c=!1),void 0===$d&&($d=!0),$f=$c?$d?$g.sortNumBigFirst:$g.sortBigFirst:$d?$g.sortNumSmallFirst:$g.sortSmallFirst,function($c,$d){return $f($c[$e],$d[$e])}},$g}(),$G=function(){function $e($c,$d,$e,$f,$g,$h){this.inPool=!1,this.bTransform=!1,void 0===$c&&($c=1),void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=1),void 0===$g&&($g=0),void 0===$h&&($h=0),this.a=$c,this.b=$d,this.c=$e,this.d=$f,this.tx=$g,this.ty=$h,this._checkTransform()}$r($e,"laya.maths.Matrix");var $c=$e.prototype;return $c.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},$c._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},$c.setTranslate=function($c,$d){return this.tx=$c,this.ty=$d,this},$c.translate=function($c,$d){return this.tx+=$c,this.ty+=$d,this},$c.scale=function($c,$d){this.a*=$c,this.d*=$d,this.c*=$c,this.b*=$d,this.tx*=$c,this.ty*=$d,this.bTransform=!0},$c.rotate=function($c){var $d=Math.cos($c),$e=Math.sin($c),$f=this.a,$g=this.c,$h=this.tx;this.a=$f*$d-this.b*$e,this.b=$f*$e+this.b*$d,this.c=$g*$d-this.d*$e,this.d=$g*$e+this.d*$d,this.tx=$h*$d-this.ty*$e,this.ty=$h*$e+this.ty*$d,this.bTransform=!0},$c.skew=function($c,$d){var $e=Math.tan($c),$f=Math.tan($d),$g=this.a,$h=this.b;return this.a+=$f*this.c,this.b+=$f*this.d,this.c+=$e*$g,this.d+=$e*$h,this},$c.invertTransformPoint=function($c){var $d=this.a,$e=this.b,$f=this.c,$g=this.d,$h=this.tx,$i=$d*$g-$e*$f,$j=$g/$i,$k=-$e/$i,$l=-$f/$i,$m=$d/$i,$n=($f*this.ty-$g*$h)/$i,$o=-($d*this.ty-$e*$h)/$i;return $c.setTo($j*$c.x+$l*$c.y+$n,$k*$c.x+$m*$c.y+$o)},$c.transformPoint=function($c){return $c.setTo(this.a*$c.x+this.c*$c.y+this.tx,this.b*$c.x+this.d*$c.y+this.ty)},$c.transformPointN=function($c){return $c.setTo(this.a*$c.x+this.c*$c.y,this.b*$c.x+this.d*$c.y)},$c.transformPointArray=function($c,$d){for(var $e=$c.length,$f=0;$f<$e;$f+=2){var $g=$c[$f],$h=$c[$f+1];$d[$f]=this.a*$g+this.c*$h+this.tx,$d[$f+1]=this.b*$g+this.d*$h+this.ty}return $d},$c.transformPointArrayScale=function($c,$d){for(var $e=$c.length,$f=0;$f<$e;$f+=2){var $g=$c[$f],$h=$c[$f+1];$d[$f]=this.a*$g+this.c*$h,$d[$f+1]=this.b*$g+this.d*$h}return $d},$c.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},$c.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},$c.invert=function(){var $c=this.a,$d=this.b,$e=this.c,$f=this.d,$g=this.tx,$h=$c*$f-$d*$e;return this.a=$f/$h,this.b=-$d/$h,this.c=-$e/$h,this.d=$c/$h,this.tx=($e*this.ty-$f*$g)/$h,this.ty=-($c*this.ty-$d*$g)/$h,this},$c.setTo=function($c,$d,$e,$f,$g,$h){return this.a=$c,this.b=$d,this.c=$e,this.d=$f,this.tx=$g,this.ty=$h,this},$c.concat=function($c){var $d=this.a,$e=this.c,$f=this.tx;return this.a=$d*$c.a+this.b*$c.c,this.b=$d*$c.b+this.b*$c.d,this.c=$e*$c.a+this.d*$c.c,this.d=$e*$c.b+this.d*$c.d,this.tx=$f*$c.a+this.ty*$c.c+$c.tx,this.ty=$f*$c.b+this.ty*$c.d+$c.ty,this},$c.scaleEx=function($c,$d){var $e=this.a,$f=this.b,$g=this.c,$h=this.d;0!==$f||0!==$g?(this.a=$c*$e,this.b=$c*$f,this.c=$d*$g):(this.a=$c*$e,this.b=0*$h,this.c=0*$e),this.d=$d*$h,this.bTransform=!0},$c.rotateEx=function($c){var $d=Math.cos($c),$e=Math.sin($c),$f=this.a,$g=this.b,$h=this.c,$i=this.d;0!==$g||0!==$h?(this.a=$d*$f+$e*$h,this.b=$d*$g+$e*$i,this.c=-$e*$f+$d*$h,this.d=-$e*$g+$d*$i):(this.a=$d*$f,this.b=$e*$i,this.c=-$e*$f,this.d=$d*$i),this.bTransform=!0},$c.clone=function(){var $c=$e.create();return $c.a=this.a,$c.b=this.b,$c.c=this.c,$c.d=this.d,$c.tx=this.tx,$c.ty=this.ty,$c.bTransform=this.bTransform,$c},$c.copyTo=function($c){return $c.a=this.a,$c.b=this.b,$c.c=this.c,$c.d=this.d,$c.tx=this.tx,$c.ty=this.ty,$c.bTransform=this.bTransform,$c},$c.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},$c.destroy=function(){if(!this.inPool){var $c=$e._cache;this.inPool=!0,$c._length||($c._length=0),($c[$c._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},$e.mul=function($c,$d,$e){var $f=$c.a,$g=$c.b,$h=$c.c,$i=$c.d,$j=$c.tx,$k=$c.ty,$l=$d.a,$m=$d.b,$n=$d.c,$o=$d.d,$p=$d.tx,$q=$d.ty;return 0!==$m||0!==$n?($e.a=$f*$l+$g*$n,$e.b=$f*$m+$g*$o,$e.c=$h*$l+$i*$n,$e.d=$h*$m+$i*$o,$e.tx=$l*$j+$n*$k+$p,$e.ty=$m*$j+$o*$k+$q):($e.a=$f*$l,$e.b=$g*$o,$e.c=$h*$l,$e.d=$i*$o,$e.tx=$l*$j+$p,$e.ty=$o*$k+$q),$e},$e.mul16=function($c,$d,$e){var $f=$c.a,$g=$c.b,$h=$c.c,$i=$c.d,$j=$c.tx,$k=$c.ty,$l=$d.a,$m=$d.b,$n=$d.c,$o=$d.d,$p=$d.tx,$q=$d.ty;return 0!==$m||0!==$n?($e[0]=$f*$l+$g*$n,$e[1]=$f*$m+$g*$o,$e[4]=$h*$l+$i*$n,$e[5]=$h*$m+$i*$o,$e[12]=$l*$j+$n*$k+$p,$e[13]=$m*$j+$o*$k+$q):($e[0]=$f*$l,$e[1]=$g*$o,$e[4]=$h*$l,$e[5]=$i*$o,$e[12]=$l*$j+$p,$e[13]=$o*$k+$q),$e},$e.mulPre=function($c,$d,$e,$f,$g,$h,$i,$j){var $k=$c.a,$l=$c.b,$m=$c.c,$n=$c.d,$o=$c.tx,$p=$c.ty;return 0!==$e||0!==$f?($j.a=$k*$d+$l*$f,$j.b=$k*$e+$l*$g,$j.c=$m*$d+$n*$f,$j.d=$m*$e+$n*$g,$j.tx=$d*$o+$f*$p+$h,$j.ty=$e*$o+$g*$p+$i):($j.a=$k*$d,$j.b=$l*$g,$j.c=$m*$d,$j.d=$n*$g,$j.tx=$d*$o+$h,$j.ty=$g*$p+$i),$j},$e.mulPos=function($c,$d,$e,$f,$g,$h,$i,$j){var $k=$c.a,$l=$c.b,$m=$c.c,$n=$c.d,$o=$c.tx,$p=$c.ty;return 0!==$l||0!==$m?($j.a=$d*$k+$e*$m,$j.b=$d*$l+$e*$n,$j.c=$f*$k+$g*$m,$j.d=$f*$l+$g*$n,$j.tx=$k*$h+$m*$i+$o,$j.ty=$l*$h+$n*$i+$p):($j.a=$d*$k,$j.b=$e*$n,$j.c=$f*$k,$j.d=$g*$n,$j.tx=$k*$h+$o,$j.ty=$n*$i+$p),$j},$e.preMul=function($c,$d,$e){var $f=$c.a,$g=$c.b,$h=$c.c,$i=$c.d,$j=$d.a,$k=$d.b,$l=$d.c,$m=$d.d,$n=$d.tx,$o=$d.ty;return $e.a=$j*$f,$e.b=$e.c=0,$e.d=$m*$i,$e.tx=$n*$f+$c.tx,$e.ty=$o*$i+$c.ty,0===$k&&0===$l&&0===$g&&0===$h||($e.a+=$k*$h,$e.d+=$l*$g,$e.b+=$j*$g+$k*$i,$e.c+=$l*$f+$m*$h,$e.tx+=$o*$h,$e.ty+=$n*$g),$e},$e.preMulXY=function($c,$d,$e,$f){var $g=$c.a,$h=$c.b,$i=$c.c,$j=$c.d;return $f.a=$g,$f.b=$h,$f.c=$i,$f.d=$j,$f.tx=$d*$g+$c.tx+$e*$i,$f.ty=$e*$j+$c.ty+$d*$h,$f},$e.create=function(){var $c=$e._cache,$d=$c._length?$c[--$c._length]:new $e;return $d.inPool=!1,$d},$e.EMPTY=new $e,$e.TEMP=new $e,$e._cache=[],$e}(),$A=function(){function $c($c,$d){void 0===$c&&($c=0),void 0===$d&&($d=0),this.x=$c,this.y=$d}$r($c,"laya.maths.Point");var $d=$c.prototype;return $d.setTo=function($c,$d){return this.x=$c,this.y=$d,this},$d.distance=function($c,$d){return Math.sqrt((this.x-$c)*(this.x-$c)+(this.y-$d)*(this.y-$d))},$d.toString=function(){return this.x+","+this.y},$d.normalize=function(){var $c=Math.sqrt(this.x*this.x+this.y*this.y);if(0<$c){var $d=1/$c;this.x*=$d,this.y*=$d}},$c.TEMP=new $c,$c.EMPTY=new $c,$c}(),$B=function(){function $l($c,$d,$e,$f){void 0===$c&&($c=0),void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=0),this.x=$c,this.y=$d,this.width=$e,this.height=$f}$r($l,"laya.maths.Rectangle");var $c=$l.prototype;return $c.setTo=function($c,$d,$e,$f){return this.x=$c,this.y=$d,this.width=$e,this.height=$f,this},$c.copyFrom=function($c){return this.x=$c.x,this.y=$c.y,this.width=$c.width,this.height=$c.height,this},$c.contains=function($c,$d){return!(this.width<=0||this.height<=0)&&($c>=this.x&&$c<this.right&&$d>=this.y&&$d<this.bottom)},$c.intersects=function($c){return!($c.x>this.x+this.width||$c.x+$c.width<this.x||$c.y>this.y+this.height||$c.y+$c.height<this.y)},$c.intersection=function($c,$d){return this.intersects($c)?($d||($d=new $l),$d.x=Math.max(this.x,$c.x),$d.y=Math.max(this.y,$c.y),$d.width=Math.min(this.right,$c.right)-$d.x,$d.height=Math.min(this.bottom,$c.bottom)-$d.y,$d):null},$c.union=function($c,$d){return $d||($d=new $l),this.clone($d),$c.width<=0||$c.height<=0?$d:($d.addPoint($c.x,$c.y),$d.addPoint($c.right,$c.bottom),this)},$c.clone=function($c){return $c||($c=new $l),$c.x=this.x,$c.y=this.y,$c.width=this.width,$c.height=this.height,$c},$c.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},$c.equals=function($c){return!(!$c||$c.x!==this.x||$c.y!==this.y||$c.width!==this.width||$c.height!==this.height)},$c.addPoint=function($c,$d){return this.x>$c&&(this.width+=this.x-$c,this.x=$c),this.y>$d&&(this.height+=this.y-$d,this.y=$d),this.width<$c-this.x&&(this.width=$c-this.x),this.height<$d-this.y&&(this.height=$d-this.y),this},$c._getBoundPoints=function(){var $c=$l._temB;return($c.length=0)==this.width||0==this.height||$c.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),$c},$c.isEmpty=function(){return this.width<=0||this.height<=0},$m(0,$c,"right",function(){return this.x+this.width}),$m(0,$c,"bottom",function(){return this.y+this.height}),$l._getBoundPointS=function($c,$d,$e,$f){var $g=$l._temA;return($g.length=0)==$e||0==$f||$g.push($c,$d,$c+$e,$d,$c,$d+$f,$c+$e,$d+$f),$g},$l._getWrapRec=function($c,$d){if(!$c||$c.length<1)return $d?$d.setTo(0,0,0,0):$l.TEMP.setTo(0,0,0,0);$d=$d||new $l;var $e,$f,$g,$h,$i,$j=$c.length,$k=$A.TEMP;for($g=$i=-($f=$h=99999),$e=0;$e<$j;$e+=2)$k.x=$c[$e],$k.y=$c[$e+1],$f=$f<$k.x?$f:$k.x,$h=$h<$k.y?$h:$k.y,$g=$g>$k.x?$g:$k.x,$i=$i>$k.y?$i:$k.y;return $d.setTo($f,$h,$g-$f,$i-$h)},$l.EMPTY=new $l,$l.TEMP=new $l,$l._temB=[],$l._temA=[],$l}(),$E=function(){function $k(){}return $r($k,"laya.media.SoundManager"),$m(1,$k,"useAudioMusic",function(){return $k._useAudioMusic},function($c){$k._useAudioMusic=$c,$k._musicClass=$c?$ec:null}),$m(1,$k,"autoStopMusic",function(){return $k._autoStopMusic},function($c){$z.stage.off("blur",null,$k._stageOnBlur),$z.stage.off("focus",null,$k._stageOnFocus),$z.stage.off("visibilitychange",null,$k._visibilityChange),($k._autoStopMusic=$c)&&($z.stage.on("blur",null,$k._stageOnBlur),$z.stage.on("focus",null,$k._stageOnFocus),$z.stage.on("visibilitychange",null,$k._visibilityChange))}),$m(1,$k,"muted",function(){return $k._muted},function($c){$c!=$k._muted&&($c&&$k.stopAllSound(),$k.musicMuted=$c,$k._muted=$c)}),$m(1,$k,"musicMuted",function(){return $k._musicMuted},function($c){$c!=$k._musicMuted&&($c?($k._tMusic&&$k._musicChannel&&!$k._musicChannel.isStopped?$k._musicChannel.pause():$k._musicChannel=null,$k._musicMuted=$c):($k._musicMuted=$c,$k._tMusic&&$k._musicChannel&&$k._musicChannel.resume()))}),$m(1,$k,"soundMuted",function(){return $k._soundMuted},function($c){$k._soundMuted=$c}),$k.addChannel=function($c){0<=$k._channels.indexOf($c)||($k._channels.push($c),$k.autoReleaseSound&&0!=$k._notUsedCount&&$k._notUsedUrls[$c.url]&&(delete $k._notUsedUrls[$c.url],0==--$k._notUsedCount&&$z.timer.clear($k,$k.disposeSoundIfNotUsed)))},$k.removeChannel=function($c){var $d=$k._channels,$e=$d.indexOf($c);if(-1!=$e&&($d.splice($e,1),$k.autoReleaseSound)){var $f=$c.url,$g=$k.defaultIntervals[$f]||2e4;if(0<$g){var $h=!0;for($e=$d.length-1;0<=$e;$e--)if($d[$e].url==$f){$h=!1;break}$h&&($k._notUsedUrls[$f]=Date.now()+$g,0==$k._notUsedCount++&&$z.timer.loop(1e4,$k,$k.disposeSoundIfNotUsed))}}},$k.disposeSoundIfNotUsed=function(){var $c=$k._notUsedUrls;if(0!=$k._notUsedCount){var $d=Date.now();for(var $e in $c)$d>=$c[$e]&&(delete $c[$e],--$k._notUsedCount,$k.destroySound($e));if(0!=$k._notUsedCount)return}$z.timer.clear($k,$k.disposeSoundIfNotUsed)},$k._visibilityChange=function(){$z.stage.isVisibility?$k._stageOnFocus():$k._stageOnBlur()},$k._stageOnBlur=function(){$k._isActive=!1,$k._musicChannel&&($k._musicChannel.isStopped||($k._blurPaused=!0,$k._musicChannel.pause())),$k.stopAllSound(),$z.stage.once("mousedown",null,$k._stageOnFocus)},$k._recoverWebAudio=function(){$hc.ctx&&"running"!=$hc.ctx.state&&$hc.ctx.resume&&$hc.ctx.resume()},$k._stageOnFocus=function(){if($k._isActive=!0,$k._recoverWebAudio(),$z.stage.off("mousedown",null,$k._stageOnFocus),$k._blurPaused){var $c=$k._musicChannel;$c&&$k._music&&$c.isStopped&&($k._blurPaused=!1,$k._music._disposed?$k.playMusic($c.url,$c.loops,$c.startHandler,$c.completeHandler,$c.startTime):$c.audioBuffer?$c.resume():$k._music.play($c.startTime,$c.loops,$c.startHandler,$c))}},$k.playSound=function($c,$d,$e,$f,$g,$h){if(void 0===$d&&($d=1),void 0===$h&&($h=0),!$c)return null;if($k._muted)return null;if($k._recoverWebAudio(),$c==$k._tMusic){if($k._musicMuted)return null}else{if(!$k._isActive)return null;if($k._soundMuted)return null}var $i,$j=$k._pool[$c];return $g||($g=$k._soundClass),$j||(($j=new $g).load($c),$k._pool[$c]=$j),($i=$j.play($h,$d,$e))?($c==$k._tMusic&&($k._music=$j,$k._isActive||($k._blurPaused=!0,$i.pause())),$i.url=$c,$i.volume=$c==$k._tMusic?$k.musicVolume:$k.soundVolume,$i.completeHandler=$f,$i):null},$k.destroySound=function($c){var $d=$k._pool[$c];$d&&(delete $k._pool[$c],$d.dispose())},$k.playMusic=function($c,$d,$e,$f,$g){return void 0===$d&&($d=0),void 0===$g&&($g=0),$k._tMusic=$c,$k._musicChannel&&$k._musicChannel.stop(),$k._musicChannel=$k.playSound($c,$d,$e,$f,null,$g)},$k.stopSound=function($c){for(var $d,$e=$k._channels.length-1;0<=$e;$e--)($d=$k._channels[$e]).url==$c&&$d.stop()},$k.stopAll=function(){$k._tMusic=null;var $c=0;for($c=$k._channels.length-1;0<=$c;$c--)$k._channels[$c].stop()},$k.stopAllSound=function(){var $c,$d=0;for($d=$k._channels.length-1;0<=$d;$d--)($c=$k._channels[$d]).url!=$k._tMusic&&$c.stop()},$k.stopMusic=function(){$k._musicChannel&&$k._musicChannel.stop(),$k._tMusic=null},$k.setSoundVolume=function($c,$d){if($d)$k._setVolume($d,$c);else{$k.soundVolume=$c;var $e,$f=0;for($f=$k._channels.length-1;0<=$f;$f--)($e=$k._channels[$f]).url!=$k._tMusic&&($e.volume=$c)}},$k.setMusicVolume=function($c){$k.musicVolume=$c,$k._setVolume($k._tMusic,$c)},$k._setVolume=function($c,$d){for(var $e,$f=$k._channels.length-1;0<=$f;$f--)($e=$k._channels[$f]).url==$c&&($e.volume=$d)},$k.musicVolume=1,$k.soundVolume=1,$k.playbackRate=1,$k._useAudioMusic=!0,$k._muted=!1,$k._soundMuted=!1,$k._musicMuted=!1,$k._tMusic=null,$k._musicChannel=null,$k._music=null,$k._channels=[],$k._autoStopMusic=!1,$k._blurPaused=!1,$k._isActive=!0,$k._soundClass=null,$k._musicClass=null,$k.autoReleaseSound=!0,$k._pool={},$k.defaultIntervals={},$k._notUsedUrls={},$k._notUsedCount=0,$k}(),$C=function(){var $c;function $e(){}return $r($e,"laya.net.LocalStorage"),$e.__init__=function(){$e._baseClass||($e._baseClass=$c).init(),$e.items=$e._baseClass.items,$e.support=$e._baseClass.support},$e.setItem=function($c,$d){$e._baseClass.setItem($c,$d)},$e.getItem=function($c){return $e._baseClass.getItem($c)},$e.setJSON=function($c,$d){$e._baseClass.setJSON($c,$d)},$e.getJSON=function($c){return $e._baseClass.getJSON($c)},$e.removeItem=function($c){$e._baseClass.removeItem($c)},$e.clear=function(){$e._baseClass.clear()},$e._baseClass=null,$e.items=null,$e.support=!1,$e.__init$=function(){$c=function(){function $e(){}return $r($e,""),$e.init=function(){try{$e.support=!0,$e.items=$i.localStorage,$e.setItem("laya","1"),$e.removeItem("laya")}catch($c){$e.support=!1}$e.support||console.log("LocalStorage is not supprot or browser is private mode.")},$e.setItem=function($c,$d){try{$e.support&&$e.items.setItem($c,$d)}catch($c){console.warn("set localStorage failed",$c)}},$e.getItem=function($c){return $e.support?$e.items.getItem($c):null},$e.setJSON=function($c,$d){try{$e.support&&$e.items.setItem($c,JSON.stringify($d))}catch($c){console.warn("set localStorage failed",$c)}},$e.getJSON=function($c){return JSON.parse($e.support?$e.items.getItem($c):null)},$e.removeItem=function($c){$e.support&&$e.items.removeItem($c)},$e.clear=function(){$e.support&&$e.items.clear()},$e.items=null,$e.support=!1,$e}()},$e}(),$H=(function(){function $f(){}$r($f,"laya.net.ResourceVersion"),$f.enable=function($c,$d,$e){void 0===$e&&($e=2),laya.net.ResourceVersion.type=$e,$z.loader.load($c,$u.create(null,$f.onManifestLoaded,[$d]),null,"json"),$I.customFormat=$f.addVersionPrefix},$f.onManifestLoaded=function($c,$d){$f.manifest=$d,$c.run(),$d||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},$f.addVersionPrefix=function($c){return $f.manifest&&$f.manifest[$c]?2==$f.type?$f.manifest[$c]:$f.manifest[$c]+"/"+$c:$c},$f.FOLDER_VERSION=1,$f.FILENAME_VERSION=2,$f.manifest=null,$f.type=1}(),function(){function $c(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}$r($c,"laya.net.TTFLoader");var $d=$c.prototype;return $d.load=function($c){var $d=(this._url=$c).split(".ttf")[0].split("/");this.fontName=$d[$d.length-1],$O.window.conch?this._loadConch():$O.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},$d._loadConch=function(){this._http=new $ic,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},$d._onHttpLoaded=function($c){$O.window.conch.setFontFaceFromBuffer(this.fontName,$c),this._clearHttp(),this._complete()},$d._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},$d._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},$d._complete=function(){$z.timer.clear(this,this._complete),$z.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},$d._checkComplete=function(){$F.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},$d._loadWithFontFace=function(){var $c=new $O.window.FontFace(this.fontName,"url('"+this._url+"')");$O.window.document.fonts.add($c);var $d=this;$c.loaded.then(function(){$d._complete()}),$c.load()},$d._createDiv=function(){this._div=$O.createElement("div"),this._div.innerHTML="laya";var $c=this._div.style;$c.fontFamily=this.fontName,$c.position="absolute",$c.left="-100px",$c.top="-100px",$O.document.body.appendChild(this._div)},$d._loadWithCSS=function(){var $c=this,$d=$O.createElement("style");$d.type="text/css",$O.document.body.appendChild($d),$d.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=$F.measureText("LayaTTFFont",this._fontTxt).width;var $e=this;$d.onload=function(){$z.timer.once(1e4,$e,$c._complete)},$z.timer.loop(20,this,this._checkComplete),this._createDiv()},$c._testString="LayaTTFFont",$c}()),$I=function(){function $f($c){this._url=null,this._path=null,this._url=$f.formatURL($c),this._path=$f.getPath($c)}$r($f,"laya.net.URL");var $c=$f.prototype;return $m(0,$c,"path",function(){return this._path}),$m(0,$c,"url",function(){return this._url}),$f.formatURL=function($c,$d){if(!$c)return"null path";if(0<$c.indexOf(":"))return $c;null!=$f.customFormat&&($c=$f.customFormat($c,$d));var $e=$c.charAt(0);if("."===$e)return $f.formatRelativePath(($d||$f.basePath)+$c);if("~"===$e)return $f.rootPath+$c.substring(1);if("d"===$e){if(0===$c.indexOf("data:image"))return $c}else if("/"===$e)return $c;return($d||$f.basePath)+$c},$f.formatRelativePath=function($c){for(var $d=$c.split("/"),$e=0,$f=$d.length;$e<$f;$e++)".."==$d[$e]&&($d.splice($e-1,2),$e-=2);return $d.join("/")},$f.isAbsolute=function($c){return 0<$c.indexOf(":")||"/"==$c.charAt(0)},$f.getPath=function($c){var $d=$c.lastIndexOf("/");return 0<$d?$c.substr(0,$d+1):""},$f.getFileName=function($c){var $d=$c.lastIndexOf("/");return 0<$d?$c.substr($d+1):$c},$f.version={},$f.basePath="",$f.rootPath="",$f.customFormat=function($c){var $d=$f.version[$c];return!$J.isConchApp&&$d&&($c+="?v="+$d),$c},$f}(),$J=function(){function $g($c,$d){this._timeId=0;var $e=$g._mainCanvas.source.style;$e.position="absolute",$e.top=$e.left="0px",$e.background="#000000",$g._mainCanvas.source.id="layaCanvas";var $f=laya.renders.Render.isWebGL;$g._mainCanvas.source.width=$c,$g._mainCanvas.source.height=$d,$f&&$g.WebGL.init($g._mainCanvas,$c,$d),$O.container.appendChild($g._mainCanvas.source),($g._context=new $K($c,$d,$f?null:$g._mainCanvas)).ctx.setIsMainContext(),$O.window.requestAnimationFrame(function $c($d){$O.window.requestAnimationFrame($c);$z.stage._loop()}),$z.stage.on("visibilitychange",this,this._onVisibilitychange)}$r($g,"laya.renders.Render");var $c=$g.prototype;return $c._onVisibilitychange=function(){$z.stage.isVisibility?0!=this._timeId&&$O.window.clearInterval(this._timeId):this._timeId=$O.window.setInterval(this._enterFrame,1e3)},$c._enterFrame=function($c){$z.stage._loop()},$m(1,$g,"context",function(){return $g._context}),$m(1,$g,"canvas",function(){return $g._mainCanvas.source}),$g._context=null,$g._mainCanvas=null,$g.WebGL=null,$g.isConchNode=!1,$g.isConchApp=!1,$g.isConchWebGL=!1,$g.isWebGL=!1,$g.is3DMode=!1,$g.optimizeTextureMemory=function($c,$d){return!0},$g.__init$=function(){$i.ConchRenderType=$i.ConchRenderType||1,$i.ConchRenderType|=$i.conch?4:0,$g.isConchNode=5==(5&$i.ConchRenderType),$g.isConchApp=4==(4&$i.ConchRenderType),$g.isConchWebGL=6==$i.ConchRenderType},$g}(),$K=function(){function $i($c,$d,$e){this.x=0,this.y=0,this._drawTexture=function($c,$d,$e){$e[0].loaded&&this.ctx.drawTexture($e[0],$e[1],$e[2],$e[3],$e[4],$c,$d)},this._fillTexture=function($c,$d,$e){$e[0].loaded&&this.ctx.fillTexture($e[0],$e[1]+$c,$e[2]+$d,$e[3],$e[4],$e[5],$e[6],$e[7])},this._drawTextureWithTransform=function($c,$d,$e){$e[0].loaded&&this.ctx.drawTextureWithTransform($e[0],$e[1],$e[2],$e[3],$e[4],$e[5],$c,$d,$e[6])},this._fillQuadrangle=function($c,$d,$e){this.ctx.fillQuadrangle($e[0],$e[1],$e[2],$e[3],$e[4])},this._drawRect=function($c,$d,$e){var $f=this.ctx;null!=$e[4]&&($f.fillStyle=$e[4],$f.fillRect($c+$e[0],$d+$e[1],$e[2],$e[3],null)),null!=$e[5]&&($f.strokeStyle=$e[5],$f.lineWidth=$e[6],$f.strokeRect($c+$e[0],$d+$e[1],$e[2],$e[3],$e[6]))},this._drawPie=function($c,$d,$e){var $f=this.ctx;$J.isWebGL&&$f.setPathId($e[8]),$f.beginPath(),$J.isWebGL?($f.movePath($e[0]+$c,$e[1]+$d),$f.moveTo(0,0)):$f.moveTo($c+$e[0],$d+$e[1]),$f.arc($c+$e[0],$d+$e[1],$e[2],$e[3],$e[4]),$f.closePath(),this._fillAndStroke($e[5],$e[6],$e[7],!0)},this._clipRect=function($c,$d,$e){this.ctx.clipRect($c+$e[0],$d+$e[1],$e[2],$e[3])},this._fillRect=function($c,$d,$e){this.ctx.fillRect($c+$e[0],$d+$e[1],$e[2],$e[3],$e[4])},this._drawCircle=function($c,$d,$e){var $f=this.ctx;$J.isWebGL&&$f.setPathId($e[6]),$X.drawCall++,$f.beginPath(),$J.isWebGL&&$f.movePath($e[0]+$c,$e[1]+$d),$f.arc($e[0]+$c,$e[1]+$d,$e[2],0,$i.PI2),$f.closePath(),this._fillAndStroke($e[3],$e[4],$e[5],!0)},this._fillCircle=function($c,$d,$e){$X.drawCall++;var $f=this.ctx;$f.beginPath(),$f.fillStyle=$e[3],$f.arc($e[0]+$c,$e[1]+$d,$e[2],0,$i.PI2),$f.fill()},this._setShader=function($c,$d,$e){this.ctx.setShader($e[0])},this._drawLine=function($c,$d,$e){var $f=this.ctx;$J.isWebGL&&$f.setPathId($e[6]),$f.beginPath(),$f.strokeStyle=$e[4],$f.lineWidth=$e[5],$J.isWebGL?($f.movePath($c,$d),$f.moveTo($e[0],$e[1]),$f.lineTo($e[2],$e[3])):($f.moveTo($c+$e[0],$d+$e[1]),$f.lineTo($c+$e[2],$d+$e[3])),$f.stroke()},this._drawLines=function($c,$d,$e){var $f=this.ctx;$J.isWebGL&&$f.setPathId($e[5]),$f.beginPath(),$c+=$e[0],$d+=$e[1],$J.isWebGL&&$f.movePath($c,$d),$f.strokeStyle=$e[3],$f.lineWidth=$e[4];var $g=$e[2],$h=2,$i=$g.length;if($J.isWebGL)for($f.moveTo($g[0],$g[1]);$h<$i;)$f.lineTo($g[$h++],$g[$h++]);else for($f.moveTo($c+$g[0],$d+$g[1]);$h<$i;)$f.lineTo($c+$g[$h++],$d+$g[$h++]);$f.stroke()},this._drawLinesWebGL=function($c,$d,$e){this.ctx.drawLines($c+this.x+$e[0],$d+this.y+$e[1],$e[2],$e[3],$e[4])},this._drawCurves=function($c,$d,$e){this.ctx.drawCurves($c,$d,$e)},this._draw=function($c,$d,$e){$e[0].call(null,this,$c,$d)},this._transformByMatrix=function($c,$d,$e){this.ctx.transformByMatrix($e[0])},this._setTransform=function($c,$d,$e){this.ctx.setTransform($e[0],$e[1],$e[2],$e[3],$e[4],$e[5])},this._setTransformByMatrix=function($c,$d,$e){this.ctx.setTransformByMatrix($e[0])},this._save=function($c,$d,$e){this.ctx.save()},this._restore=function($c,$d,$e){this.ctx.restore()},this._translate=function($c,$d,$e){this.ctx.translate($e[0],$e[1])},this._transform=function($c,$d,$e){this.ctx.translate($e[1]+$c,$e[2]+$d);var $f=$e[0];this.ctx.transform($f.a,$f.b,$f.c,$f.d,$f.tx,$f.ty),this.ctx.translate(-$c-$e[1],-$d-$e[2])},this._rotate=function($c,$d,$e){this.ctx.translate($e[1]+$c,$e[2]+$d),this.ctx.rotate($e[0]),this.ctx.translate(-$c-$e[1],-$d-$e[2])},this._scale=function($c,$d,$e){this.ctx.translate($e[2]+$c,$e[3]+$d),this.ctx.scale($e[0],$e[1]),this.ctx.translate(-$c-$e[2],-$d-$e[3])},this._alpha=function($c,$d,$e){this.ctx.globalAlpha*=$e[0]},this._setAlpha=function($c,$d,$e){this.ctx.globalAlpha=$e[0]},this._fillText=function($c,$d,$e){this.ctx.fillText($e[0],$e[1]+$c,$e[2]+$d,$e[3],$e[4],$e[5])},this._strokeText=function($c,$d,$e){this.ctx.strokeText($e[0],$e[1]+$c,$e[2]+$d,$e[3],$e[4],$e[5],$e[6])},this._fillBorderText=function($c,$d,$e){this.ctx.fillBorderText($e[0],$e[1]+$c,$e[2]+$d,$e[3],$e[4],$e[5],$e[6],$e[7])},this._blendMode=function($c,$d,$e){this.ctx.globalCompositeOperation=$e[0]},this._beginClip=function($c,$d,$e){this.ctx.beginClip&&this.ctx.beginClip($c+$e[0],$d+$e[1],$e[2],$e[3])},this._setIBVB=function($c,$d,$e){this.ctx.setIBVB($e[0]+$c,$e[1]+$d,$e[2],$e[3],$e[4],$e[5],$e[6],$e[7])},this._fillTrangles=function($c,$d,$e){this.ctx.fillTrangles($e[0],$e[1]+$c,$e[2]+$d,$e[3],$e[4])},this._drawPath=function($c,$d,$e){var $f=this.ctx;$J.isWebGL&&$f.setPathId(-1),$f.beginPath(),$c+=$e[0],$d+=$e[1],$J.isWebGL&&$f.movePath($c,$d);for(var $g=$e[2],$h=0,$i=$g.length;$h<$i;$h++){var $j=$g[$h];switch($j[0]){case"moveTo":$J.isWebGL?$f.moveTo($j[1],$j[2]):$f.moveTo($c+$j[1],$d+$j[2]);break;case"lineTo":$J.isWebGL?$f.lineTo($j[1],$j[2]):$f.lineTo($c+$j[1],$d+$j[2]);break;case"arcTo":$J.isWebGL?$f.arcTo($j[1],$j[2],$j[3],$j[4],$j[5]):$f.arcTo($c+$j[1],$d+$j[2],$c+$j[3],$d+$j[4],$j[5]);break;case"closePath":$f.closePath()}}var $k=$e[3];null!=$k&&($f.fillStyle=$k.fillStyle,$f.fill());var $l=$e[4];null!=$l&&($f.strokeStyle=$l.strokeStyle,$f.lineWidth=$l.lineWidth||1,$f.lineJoin=$l.lineJoin,$f.lineCap=$l.lineCap,$f.miterLimit=$l.miterLimit,$f.stroke())},this.drawPoly=function($c,$d,$e){this.ctx.drawPoly($c+this.x+$e[0],$d+this.y+$e[1],$e[2],$e[3],$e[4],$e[5],$e[6])},this._drawPoly=function($c,$d,$e){var $f=this.ctx,$g=$e[2],$h=2,$i=$g.length;if($J.isWebGL)for($f.setPathId($e[6]),$f.beginPath(),$c+=$e[0],$d+=$e[1],$f.movePath($c,$d),$f.moveTo($g[0],$g[1]);$h<$i;)$f.lineTo($g[$h++],$g[$h++]);else for($f.beginPath(),$c+=$e[0],$d+=$e[1],$f.moveTo($c+$g[0],$d+$g[1]);$h<$i;)$f.lineTo($c+$g[$h++],$d+$g[$h++]);$f.closePath(),this._fillAndStroke($e[3],$e[4],$e[5],$e[7])},this._drawSkin=function($c,$d,$e){var $f=$e[0];if($f){var $g=this.ctx;$f.render($g,$c,$d)}},this._drawParticle=function($c,$d,$e){this.ctx.drawParticle($c+this.x,$d+this.y,$e[0])},this._setFilters=function($c,$d,$e){this.ctx.setFilters($e)},$e?this.ctx=$e.getContext("2d"):($e=$vc.create("3D"),this.ctx=$F.createWebGLContext2D($e),$e._setContext(this.ctx)),$e.size($c,$d),this.canvas=$e}$r($i,"laya.renders.RenderContext");var $c=$i.prototype;return $c.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},$c.drawTexture=function($c,$d,$e,$f,$g){$c.loaded&&this.ctx.drawTexture($c,$d,$e,$f,$g,this.x,this.y)},$c._drawTextures=function($c,$d,$e){$e[0].loaded&&this.ctx.drawTextures($e[0],$e[1],$c+this.x,$d+this.y)},$c.drawTextureWithTransform=function($c,$d,$e,$f,$g,$h,$i){$c.loaded&&this.ctx.drawTextureWithTransform($c,$d,$e,$f,$g,$h,this.x,this.y,$i)},$c.fillQuadrangle=function($c,$d,$e,$f,$g){this.ctx.fillQuadrangle($c,$d,$e,$f,$g)},$c.drawCanvas=function($c,$d,$e,$f,$g){this.ctx.drawCanvas($c,$d+this.x,$e+this.y,$f,$g)},$c.drawRect=function($c,$d,$e,$f,$g,$h){void 0===$h&&($h=1);var $i=this.ctx;$i.strokeStyle=$g,$i.lineWidth=$h,$i.strokeRect($c+this.x,$d+this.y,$e,$f,$h)},$c._fillAndStroke=function($c,$d,$e,$f){void 0===$f&&($f=!1);var $g=this.ctx;null!=$c&&($g.fillStyle=$c,$J.isWebGL?$g.fill($f):$g.fill()),null!=$d&&0<$e&&($g.strokeStyle=$d,$g.lineWidth=$e,$g.stroke())},$c.clipRect=function($c,$d,$e,$f){this.ctx.clipRect($c+this.x,$d+this.y,$e,$f)},$c.fillRect=function($c,$d,$e,$f,$g){this.ctx.fillRect($c+this.x,$d+this.y,$e,$f,$g)},$c.drawCircle=function($c,$d,$e,$f,$g){void 0===$g&&($g=1),$X.drawCall++;var $h=this.ctx;$h.beginPath(),$h.strokeStyle=$f,$h.lineWidth=$g,$h.arc($c+this.x,$d+this.y,$e,0,$i.PI2),$h.stroke()},$c.drawTriangles=function($c,$d,$e){if($J.isWebGL)this.ctx.drawTriangles($e[0],$c+$e[1],$d+$e[2],$e[3],$e[4],$e[5],$e[6],$e[7],$e[8],$e[9]);else{var $f=$e[5],$g=0,$h=$f.length,$i=this.ctx;for($g=0;$g<$h;$g+=3){var $j=2*$f[$g],$k=2*$f[$g+1],$l=2*$f[$g+2];$i.drawTriangle($e[0],$e[3],$e[4],$j,$k,$l,$e[6],!0)}}},$c.fillCircle=function($c,$d,$e,$f){$X.drawCall++;var $g=this.ctx;$g.beginPath(),$g.fillStyle=$f,$g.arc($c+this.x,$d+this.y,$e,0,$i.PI2),$g.fill()},$c.setShader=function($c){this.ctx.setShader($c)},$c.drawLine=function($c,$d,$e,$f,$g,$h){void 0===$h&&($h=1);var $i=this.ctx;$i.beginPath(),$i.strokeStyle=$g,$i.lineWidth=$h,$i.moveTo(this.x+$c,this.y+$d),$i.lineTo(this.x+$e,this.y+$f),$i.stroke()},$c.clear=function(){this.ctx.clear()},$c.transformByMatrix=function($c){this.ctx.transformByMatrix($c)},$c.setTransform=function($c,$d,$e,$f,$g,$h){this.ctx.setTransform($c,$d,$e,$f,$g,$h)},$c.setTransformByMatrix=function($c){this.ctx.setTransformByMatrix($c)},$c.save=function(){this.ctx.save()},$c.restore=function(){this.ctx.restore()},$c.translate=function($c,$d){this.ctx.translate($c,$d)},$c.transform=function($c,$d,$e,$f,$g,$h){this.ctx.transform($c,$d,$e,$f,$g,$h)},$c.rotate=function($c){this.ctx.rotate($c)},$c.scale=function($c,$d){this.ctx.scale($c,$d)},$c.alpha=function($c){this.ctx.globalAlpha*=$c},$c.setAlpha=function($c){this.ctx.globalAlpha=$c},$c.fillWords=function($c,$d,$e,$f,$g,$h){void 0===$h&&($h=0),this.ctx.fillWords($c,$d,$e,$f,$g,$h)},$c.fillBorderWords=function($c,$d,$e,$f,$g,$h,$i){this.ctx.fillBorderWords($c,$d,$e,$f,$g,$h,$i)},$c.fillText=function($c,$d,$e,$f,$g,$h){this.ctx.fillText($c,$d+this.x,$e+this.y,$f,$g,$h)},$c.strokeText=function($c,$d,$e,$f,$g,$h,$i){this.ctx.strokeText($c,$d+this.x,$e+this.y,$f,$g,$h,$i)},$c.blendMode=function($c){this.ctx.globalCompositeOperation=$c},$c.flush=function(){this.ctx.flush&&this.ctx.flush()},$c.addRenderObject=function($c){this.ctx.addRenderObject($c)},$c.beginClip=function($c,$d,$e,$f){this.ctx.beginClip&&this.ctx.beginClip($c,$d,$e,$f)},$c.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},$c.fillTrangles=function($c,$d,$e){this.ctx.fillTrangles($e[0],$e[1],$e[2],$e[3],4<$e.length?$e[4]:null)},$i.PI2=2*Math.PI,$i}(),$L=function(){function $i($c,$d){switch(this._next=$d||$i.NORENDER,$c){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=$t._filter);case 69905:return void(this._fun=$i._initRenderFun)}this.onCreate($c)}$r($i,"laya.renders.RenderSprite");var $c=$i.prototype;return $c.onCreate=function($c){},$c._style=function($c,$d,$e,$f){$c._style.render($c,$d,$e,$f);var $g=this._next;$g._fun.call($g,$c,$d,$e,$f)},$c._no=function($c,$d,$e,$f){},$c._custom=function($c,$d,$e,$f){$c.customRender($d,$e,$f);var $g=$c._style._tf;this._next._fun.call(this._next,$c,$d,$e-$g.translateX,$f-$g.translateY)},$c._clip=function($c,$d,$e,$f){var $g=this._next;if($g!=$i.NORENDER){var $h=$c._style.scrollRect;$d.ctx.save(),$d.ctx.clipRect($e,$f,$h.width,$h.height),$g._fun.call($g,$c,$d,$e-$h.x,$f-$h.y),$d.ctx.restore()}},$c._blend=function($c,$d,$e,$f){var $g=$c._style;$g.blendMode&&($d.ctx.globalCompositeOperation=$g.blendMode);var $h=this._next;$h._fun.call($h,$c,$d,$e,$f),$d.ctx.globalCompositeOperation="source-over"},$c._mask=function($c,$d,$e,$f){var $g=this._next;$g._fun.call($g,$c,$d,$e,$f);var $h=$c.mask;$h&&($d.ctx.globalCompositeOperation="destination-in",(0<$h.numChildren||!$h.graphics._isOnlyOne())&&($h.cacheAsBitmap=!0),$h.render($d,$e-$c.pivotX,$f-$c.pivotY)),$d.ctx.globalCompositeOperation="source-over"},$c._graphics=function($c,$d,$e,$f){var $g=$c._style._tf;$c._graphics&&$c._graphics._render($c,$d,$e-$g.translateX,$f-$g.translateY);var $h=this._next;$h._fun.call($h,$c,$d,$e,$f)},$c._image=function($c,$d,$e,$f){var $g=$c._style;$d.ctx.drawTexture2($e,$f,$g._tf.translateX,$g._tf.translateY,$c.transform,$g.alpha,$g.blendMode,$c._graphics._one)},$c._image2=function($c,$d,$e,$f){var $g=$c._style._tf;$d.ctx.drawTexture2($e,$f,$g.translateX,$g.translateY,$c.transform,1,null,$c._graphics._one)},$c._alpha=function($c,$d,$e,$f){var $g;if(.01<($g=$c._style.alpha)||$c._needRepaint()){var $h=$d.ctx.globalAlpha;$d.ctx.globalAlpha*=$g;var $i=this._next;$i._fun.call($i,$c,$d,$e,$f),$d.ctx.globalAlpha=$h}},$c._transform=function($c,$d,$e,$f){var $g=$c.transform,$h=this._next;$g&&$h!=$i.NORENDER?($d.save(),$d.transform($g.a,$g.b,$g.c,$g.d,$g.tx+$e,$g.ty+$f),$h._fun.call($h,$c,$d,0,0),$d.restore()):$h._fun.call($h,$c,$d,$e,$f)},$c._childs=function($c,$d,$e,$f){var $g=$c._style,$h=$g._tf;if($e=$e-$h.translateX+$g.paddingLeft,$f=$f-$h.translateY+$g.paddingTop,$g._calculation){var $i=$c._getWords();if($i){var $j=$g;$j&&($j.stroke?$d.fillBorderWords($i,$e,$f,$j.font,$j.color,$j.strokeColor,$j.stroke):$d.fillWords($i,$e,$f,$j.font,$j.color,"none"!=$j.textDecoration&&$j.underLine?1:0))}}var $k,$l=$c._childs,$m=$l.length;if($c.viewport||$c.optimizeScrollRect&&$c._style.scrollRect){var $n=$c.viewport||$c._style.scrollRect,$o=$n.x,$p=$n.y,$q=$n.right,$r=$n.bottom,$s=NaN,$t=NaN;for($u=0;$u<$m;++$u)($k=$l[$u]).visible&&($s=$k._x)<$q&&$s+$k.width>$o&&($t=$k._y)<$r&&$t+$k.height>$p&&$k.render($d,$e,$f)}else for(var $u=0;$u<$m;++$u)($k=$l[$u])._style.visible&&$k.render($d,$e,$f)},$c._canvas=function($c,$d,$e,$f){var $g=$c._$P.cacheCanvas;if($g){"bitmap"===$g.type?$X.canvasBitmap++:$X.canvasNormal++;var $h=$g.ctx;if($c._needRepaint()||!$h)this._canvas_repaint($c,$d,$e,$f);else{var $i=$g._cacheRec;$d.drawCanvas($h.canvas,$e+$i.x,$f+$i.y,$i.width,$i.height)}}else this._next._fun.call(this._next,$c,$d,$e,$f)},$c._canvas_repaint=function($c,$d,$e,$f){var $g=$c._$P.cacheCanvas,$h=this._next;if($g){var $i,$j,$k,$l,$m=$g.ctx,$n=$c._needRepaint()||!$m,$o=$g.type;if("bitmap"===$o?$X.canvasBitmap++:$X.canvasNormal++,$n){var $p,$q;$g._cacheRec||($g._cacheRec=new $B),$J.isWebGL&&"bitmap"!==$o?$g._cacheRec.setTo(-$c.pivotX,-$c.pivotY,1,1):(($l=$c.getSelfBounds()).x=$l.x-$c.pivotX,$l.y=$l.y-$c.pivotY,$l.x=$l.x-16,$l.y=$l.y-16,$l.width=$l.width+32,$l.height=$l.height+32,$l.x=Math.floor($l.x+$e)-$e,$l.y=Math.floor($l.y+$f)-$f,$l.width=Math.floor($l.width),$l.height=Math.floor($l.height),$g._cacheRec.copyFrom($l)),$l=$g._cacheRec;var $r,$s=$J.isWebGL?1:$O.pixelRatio*$z.stage.clientScaleX,$t=$J.isWebGL?1:$O.pixelRatio*$z.stage.clientScaleY;if(!$J.isWebGL){var $u,$v=1,$w=1;for($u=$c;$u&&$u!=$z.stage;)$v*=$u.scaleX,$w*=$u.scaleY,$u=$u.parent;$J.isWebGL?($v<1&&($s*=$v),$w<1&&($t*=$w)):(1<$v&&($s*=$v),1<$w&&($t*=$w))}if($c.scrollRect){var $x=$c.scrollRect;$l.x-=$x.x,$l.y-=$x.y}if($p=$l.width*$s,$q=$l.height*$t,$j=$l.x,$k=$l.y,$J.isWebGL&&"bitmap"===$o&&(2048<$p||2048<$q))return console.warn("cache bitmap size larger than 2048,cache ignored"),$g.ctx&&($W.recover("RenderContext",$g.ctx),$g.ctx.canvas.size(0,0),$g.ctx=null),void $h._fun.call($h,$c,$d,$e,$f);if($m||($m=$g.ctx=$W.getItem("RenderContext")||new $K($p,$q,$vc.create("AUTO"))),$m.ctx.sprite=$c,($i=$m.canvas).clear(),($i.width!=$p||$i.height!=$q)&&$i.size($p,$q),"bitmap"===$o?$i.context.asBitmap=!0:"normal"===$o&&($i.context.asBitmap=!1),1!=$s||1!=$t){var $y=$m.ctx;$y.save(),$y.scale($s,$t),!$J.isConchWebGL&&$J.isConchApp&&($r=$c._$P.cf)&&$y.setFilterMatrix&&$y.setFilterMatrix($r._mat,$r._alpha),$h._fun.call($h,$c,$m,-$j,-$k),$y.restore(),$J.isConchApp&&!$J.isConchWebGL||$c._applyFilters()}else $y=$m.ctx,!$J.isConchWebGL&&$J.isConchApp&&($r=$c._$P.cf)&&$y.setFilterMatrix&&$y.setFilterMatrix($r._mat,$r._alpha),$h._fun.call($h,$c,$m,-$j,-$k),$J.isConchApp&&!$J.isConchWebGL||$c._applyFilters();$c._$P.staticCache&&($g.reCache=!1),$X.canvasReCache++}else $j=($l=$g._cacheRec).x,$k=$l.y,$i=$m.canvas;$d.drawCanvas($i,$e+$j,$f+$k,$l.width,$l.height)}else $h._fun.call($h,$c,$m,$e,$f)},$i.__init__=function(){var $c,$d,$e=0;for($d=$F.createRenderSprite(69905,null),$c=$i.renders.length=4096,$e=0;$e<$c;$e++)$i.renders[$e]=$d;$i.renders[0]=$F.createRenderSprite(0,null),function($c,$d){for(var $e=0,$f=0;$f<$c.length;$f++)$e|=$c[$f],$i.renders[$e]=$d}([1,512,4,2],new $i(1,null)),$i.renders[513]=$F.createRenderSprite(513,null),$i.renders[517]=new $i(517,null)},$i._initRenderFun=function($c,$d,$e,$f){var $g=$c._renderType;($i.renders[$g]=$i._getTypeRender($g))._fun($c,$d,$e,$f)},$i._getTypeRender=function($c){for(var $d=null,$e=2048;1<$e;)$e&$c&&($d=$F.createRenderSprite($e,$d)),$e>>=1;return $d},$i.IMAGE=1,$i.ALPHA=2,$i.TRANSFORM=4,$i.BLEND=8,$i.CANVAS=16,$i.FILTERS=32,$i.MASK=64,$i.CLIP=128,$i.STYLE=256,$i.GRAPHICS=512,$i.CUSTOM=1024,$i.CHILDS=2048,$i.INIT=69905,$i.renders=[],$i.NORENDER=new $i(0,null),$i}(),$M=function(){function $j(){this._repaint=!1}$r($j,"laya.resource.Context");var $c=$j.prototype;return $c.replaceReset=function(){var $c,$d,$e=0;for($c=$j.replaceKeys.length,$e=0;$e<$c;$e++)$d=$j.replaceKeys[$e],this[$j.newKeys[$e]]=this[$d]},$c.replaceResotre=function(){this.__restore(),this.__reset()},$c.setIsMainContext=function(){},$c.drawTextures=function($c,$d,$e,$f){$X.drawCall+=$d.length/2;for(var $g=$c.width,$h=$c.height,$i=0,$j=$d.length;$i<$j;$i+=2)this.drawTexture($c,$d[$i],$d[$i+1],$g,$h,$e,$f)},$c.drawCanvas=function($c,$d,$e,$f,$g){$X.drawCall++,this.drawImage($c.source,$d,$e,$f,$g)},$c.fillRect=function($c,$d,$e,$f,$g){$X.drawCall++,$g&&(this.fillStyle=$g),this.__fillRect($c,$d,$e,$f)},$c.fillText=function($c,$d,$e,$f,$g,$h){$X.drawCall++,3<arguments.length&&null!=$f&&(this.font=$f,this.fillStyle=$g,this.textAlign=$h,this.textBaseline="top"),this.__fillText($c,$d,$e)},$c.fillBorderText=function($c,$d,$e,$f,$g,$h,$i,$j){$X.drawCall++,this.font=$f,this.fillStyle=$g,this.textBaseline="top",this.strokeStyle=$h,this.lineWidth=$i,this.textAlign=$j,this.__strokeText($c,$d,$e),this.__fillText($c,$d,$e)},$c.strokeText=function($c,$d,$e,$f,$g,$h,$i){$X.drawCall++,3<arguments.length&&null!=$f&&(this.font=$f,this.strokeStyle=$g,this.lineWidth=$h,this.textAlign=$i,this.textBaseline="top"),this.__strokeText($c,$d,$e)},$c.transformByMatrix=function($c){this.transform($c.a,$c.b,$c.c,$c.d,$c.tx,$c.ty)},$c.setTransformByMatrix=function($c){this.setTransform($c.a,$c.b,$c.c,$c.d,$c.tx,$c.ty)},$c.clipRect=function($c,$d,$e,$f){$X.drawCall++,this.beginPath(),this.rect($c,$d,$e,$f),this.clip()},$c.drawTexture=function($c,$d,$e,$f,$g,$h,$i){$X.drawCall++;var $j=$c.uv,$k=$c.bitmap.width,$l=$c.bitmap.height;this.drawImage($c.source,$j[0]*$k,$j[1]*$l,($j[2]-$j[0])*$k,($j[5]-$j[3])*$l,$d+$h,$e+$i,$f,$g)},$c.drawTextureWithTransform=function($c,$d,$e,$f,$g,$h,$i,$j,$k){$X.drawCall++;var $l=$c.uv,$m=$c.bitmap.width,$n=$c.bitmap.height;this.save(),1!=$k&&(this.globalAlpha*=$k),$h?(this.transform($h.a,$h.b,$h.c,$h.d,$h.tx+$i,$h.ty+$j),this.drawImage($c.source,$l[0]*$m,$l[1]*$n,($l[2]-$l[0])*$m,($l[5]-$l[3])*$n,$d,$e,$f,$g)):this.drawImage($c.source,$l[0]*$m,$l[1]*$n,($l[2]-$l[0])*$m,($l[5]-$l[3])*$n,$d+$i,$e+$j,$f,$g),this.restore()},$c.drawTexture2=function($c,$d,$e,$f,$g,$h,$i,$j){var $k=$j[0];if($k.loaded&&$k.bitmap&&$k.source){$X.drawCall++;var $l=1!==$h;if($l){var $m=this.globalAlpha;this.globalAlpha*=$h}var $n=$k.uv,$o=$k.bitmap.width,$p=$k.bitmap.height;$g?(this.save(),this.transform($g.a,$g.b,$g.c,$g.d,$g.tx+$c,$g.ty+$d),this.drawImage($k.source,$n[0]*$o,$n[1]*$p,($n[2]-$n[0])*$o,($n[5]-$n[3])*$p,$j[1]-$e,$j[2]-$f,$j[3],$j[4]),this.restore()):this.drawImage($k.source,$n[0]*$o,$n[1]*$p,($n[2]-$n[0])*$o,($n[5]-$n[3])*$p,$j[1]-$e+$c,$j[2]-$f+$d,$j[3],$j[4]),$l&&(this.globalAlpha=$m)}},$c.fillTexture=function($c,$d,$e,$f,$g,$h,$i,$j){if(!$j.pat){if($c.uv!=$mc.DEF_UV){var $k=new $vc("2D");$k.getContext("2d"),$k.size($c.width,$c.height),$k.context.drawTexture($c,0,0,$c.width,$c.height,0,0),$c=new $mc($k)}$j.pat=this.createPattern($c.bitmap.source,$h)}var $l=$d,$m=$e,$n=0,$o=0;$i&&($l+=$i.x%$c.width,$m+=$i.y%$c.height,$n-=$i.x%$c.width,$o-=$i.y%$c.height),this.translate($l,$m),this.fillRect($n,$o,$f,$g,$j.pat),this.translate(-$l,-$m)},$c.drawTriangle=function($c,$d,$e,$f,$g,$h,$i,$j){var $k=$c.bitmap,$l=$k.source,$m=$c.width,$n=$c.height,$o=$k.width,$p=$k.height,$q=$e[$f]*$o,$r=$e[$g]*$o,$s=$e[$h]*$o,$t=$e[$f+1]*$p,$u=$e[$g+1]*$p,$v=$e[$h+1]*$p,$w=$d[$f],$x=$d[$g],$y=$d[$h],$z=$d[$f+1],$A=$d[$g+1],$B=$d[$h+1];if($j){var $C=($w+$x+$y)/3,$D=($z+$A+$B)/3,$E=$w-$C,$F=$z-$D,$G=Math.sqrt($E*$E+$F*$F);$w=$C+$E/$G*($G+1),$z=$D+$F/$G*($G+1),$F=$A-$D,$x=$C+($E=$x-$C)/($G=Math.sqrt($E*$E+$F*$F))*($G+1),$A=$D+$F/$G*($G+1),$F=$B-$D,$y=$C+($E=$y-$C)/($G=Math.sqrt($E*$E+$F*$F))*($G+1),$B=$D+$F/$G*($G+1)}this.save(),$i&&this.transform($i.a,$i.b,$i.c,$i.d,$i.tx,$i.ty),this.beginPath(),this.moveTo($w,$z),this.lineTo($x,$A),this.lineTo($y,$B),this.closePath(),this.clip();var $H=1/($q*$u+$t*$s+$r*$v-$u*$s-$t*$r-$q*$v),$I=$w*$u+$t*$y+$x*$v-$u*$y-$t*$x-$w*$v,$J=$q*$x+$w*$s+$r*$y-$x*$s-$w*$r-$q*$y,$K=$q*$u*$y+$t*$x*$s+$w*$r*$v-$w*$u*$s-$t*$r*$y-$q*$x*$v,$L=$z*$u+$t*$B+$A*$v-$u*$B-$t*$A-$z*$v,$M=$q*$A+$z*$s+$r*$B-$A*$s-$z*$r-$q*$B,$N=$q*$u*$B+$t*$A*$s+$z*$r*$v-$z*$u*$s-$t*$r*$B-$q*$A*$v;this.transform($I*$H,$L*$H,$J*$H,$M*$H,$K*$H,$N*$H),this.drawImage($l,$c.uv[0]*$o,$c.uv[1]*$p,$m,$n,$c.uv[0]*$o,$c.uv[1]*$p,$m,$n),this.restore()},$c.flush=function(){return 0},$c.fillWords=function($c,$d,$e,$f,$g,$h){$f&&(this.font=$f),$g&&(this.fillStyle=$g);this.textBaseline="top",this.textAlign="left";for(var $i=0,$j=$c.length;$i<$j;$i++){var $k=$c[$i];if(this.__fillText($k.char,$k.x+$d,$k.y+$e),1===$h){var $l=$k.height,$m=.5*$k.style.letterSpacing;$m||($m=0),this.beginPath(),this.strokeStyle=$g,this.lineWidth=1,this.moveTo($d+$k.x-$m+.5,$e+$k.y+$l+.5),this.lineTo($d+$k.x+$k.width+$m+.5,$e+$k.y+$l+.5),this.stroke()}}},$c.fillBorderWords=function($c,$d,$e,$f,$g,$h,$i){$f&&(this.font=$f),$g&&(this.fillStyle=$g),this.textBaseline="top",this.lineWidth=$i,this.textAlign="left",this.strokeStyle=$h;for(var $j=0,$k=$c.length;$j<$k;$j++){var $l=$c[$j];this.__strokeText($l.char,$l.x+$d,$l.y+$e),this.__fillText($l.char,$l.x+$d,$l.y+$e)}},$c.destroy=function(){this.canvas.width=this.canvas.height=0},$c.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},$c.drawCurves=function($c,$d,$e){this.beginPath(),this.strokeStyle=$e[3],this.lineWidth=$e[4];var $f=$e[2];$c+=$e[0],$d+=$e[1],this.moveTo($c+$f[0],$d+$f[1]);for(var $g=2,$h=$f.length;$g<$h;)this.quadraticCurveTo($c+$f[$g++],$d+$f[$g++],$c+$f[$g++],$d+$f[$g++]);this.stroke()},$j.__init__=function($d){var $e=laya.resource.Context.prototype;if(!($d=$d||CanvasRenderingContext2D.prototype).inited){$d.inited=!0,$d.__fillText=$d.fillText,$d.__fillRect=$d.fillRect,$d.__strokeText=$d.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function($c){$d[$c]=$e[$c]})}},$j.replaceCanvasGetSet=function($c,$d){var $e=Object.getOwnPropertyDescriptor($c,$d);if(!$e||!$e.configurable)return!1;var $f,$g={};for($f in $e)"set"!=$f&&($g[$f]=$e[$f]);var $h=$e.set;return $g.set=function($c){$h.call(this,$c);var $d=this.getContext("2d");$d&&"__reset"in $d&&$d.__reset()},Object.defineProperty($c,$d,$g),!0},$j.replaceGetSet=function($c,$d){var $e=Object.getOwnPropertyDescriptor($c,$d);if(!$e||!$e.configurable)return!1;var $f,$g={};for($f in $e)"set"!=$f&&($g[$f]=$e[$f]);var $h=$e.set,$i="___"+$d+"__";return $j.newKeys.push($i),$g.set=function($c){$c!=this[$i]&&(this[$i]=$c,$h.call(this,$c))},Object.defineProperty($c,$d,$g),!0},$j._default=new $j,$j.newKeys=[],$k($j,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),$j}(),$N=function(){function $h($c){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++$h._uniqueIDCounter,this._name=$c||"Content Manager",$h._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,$h._resourceManagers.push(this),this._resources=[],this._records={}}$r($h,"laya.resource.ResourceManager");var $c=$h.prototype;return $z.imps($c,{"laya.resource.IDispose":!0}),$c.getResourceByIndex=function($c){return this._resources[$c]},$c.getResourcesLength=function(){return this._resources.length},$c.addResource=function($c){return $c.resourceManager&&$c.resourceManager.removeResource($c),-1===this._resources.indexOf($c)&&(($c._resourceManager=this)._resources.push($c),this.addRecord($c.uri,$c.__className,$c.memorySize),this.addSize($c.memorySize),!0)},$c.removeResource=function($c){var $d=this._resources.indexOf($c);return-1!==$d&&(this._resources.splice($d,1),$c._resourceManager=null,this._memorySize-=$c.memorySize,this.addRecord($c.uri,$c.__className,-$c.memorySize),!0)},$c.unload=function(){for(var $c=this._resources.slice(0,this._resources.length),$d=0;$d<$c.length;$d++){$c[$d].destroy()}$c.length=0},$c.dispose=function(){if(this===$h._systemResourceManager)throw new Error("systemResourceManager不能被释放！");$h._resourceManagers.splice($h._resourceManagers.indexOf(this),1),$h._isResourceManagersSorted=!1;for(var $c=this._resources.slice(0,this._resources.length),$d=0;$d<$c.length;$d++){var $e=$c[$d];$e.resourceManager.removeResource($e),$e.destroy()}$c.length=0},$c.addSize=function($c){$c&&(this.autoRelease&&0<$c&&this._memorySize+$c>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=$c)},$c.addRecord=function($c,$d,$e){DEBUG&&$e&&!$c&&console.error($c,$d,$e),$c&&(this._records.hasOwnProperty($d+"|"+$c)||(this._records[$d+"|"+$c]=0),this._records[$d+"|"+$c]+=$e,DEBUG&&this._records[$d+"|"+$c]<0&&console.error($c,$d,this._records[$d+"|"+$c]))},$c.garbageCollection=function($c){var $d=this._resources;($d=$d.slice()).sort(function($c,$d){if(!$c||!$d)throw new Error("a或b不能为空！");return $c.released&&$d.released?0:$c.released?1:$d.released?-1:$c._lastUseFrameCount-$d._lastUseFrameCount});for(var $e=$X.loopCount,$f=0,$g=$d.length;$f<$g;$f++){var $h=$d[$f];if(!(1<$e-$h._lastUseFrameCount))return void(this._memorySize>=$c&&(this._isOverflow=!0));if($h.releaseResource(),this._memorySize<$c)return void(this._isOverflow=!1)}},$m(0,$c,"id",function(){return this._id}),$m(0,$c,"name",function(){return this._name},function($c){!$c&&""===$c||this._name===$c||(this._name=$c,$h._isResourceManagersSorted=!1)}),$m(0,$c,"memorySize",function(){return this._memorySize}),$m(0,$c,"records",function(){return this._records}),$m(1,$h,"systemResourceManager",function(){return $h._systemResourceManager}),$h.__init__=function(){$h.currentResourceManager=$h.systemResourceManager},$h.getLoadedResourceManagerByIndex=function($c){return $h._resourceManagers[$c]},$h.getLoadedResourceManagersCount=function(){return $h._resourceManagers.length},$h.recreateContentManagers=function($c){void 0===$c&&($c=!1);for(var $d=$h.currentResourceManager,$e=0;$e<$h._resourceManagers.length;$e++){$h.currentResourceManager=$h._resourceManagers[$e];for(var $f=0;$f<$h.currentResourceManager._resources.length;$f++)$h.currentResourceManager._resources[$f].releaseResource($c),$h.currentResourceManager._resources[$f].activeResource($c)}$h.currentResourceManager=$d},$h.releaseContentManagers=function($c){void 0===$c&&($c=!1);for(var $d=$h.currentResourceManager,$e=0;$e<$h._resourceManagers.length;$e++){$h.currentResourceManager=$h._resourceManagers[$e];for(var $f=0;$f<$h.currentResourceManager._resources.length;$f++){var $g=$h.currentResourceManager._resources[$f];!$g.released&&$g.releaseResource($c)}}$h.currentResourceManager=$d},$h._uniqueIDCounter=0,$h._isResourceManagersSorted=!1,$h._resourceManagers=[],$k($h,["_systemResourceManager",function(){return this._systemResourceManager=new $h("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=$h._systemResourceManager}]),$h}(),$O=(function(){function $c(){}$r($c,"laya.system.System"),$c.changeDefinition=function($c,$d){$z[$c]=$d;var $e=$c+"=classObj";$z._runScript($e)},$c.__init__=function(){$J.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function $e(){}return $r($e,"laya.utils.Browser"),$m(1,$e,"pixelRatio",function(){return $e.__init__(),-1<$e.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:$F.getPixelRatio()}),$m(1,$e,"height",function(){return $e.__init__(),($z.stage&&$z.stage.canvasRotation?$e.clientWidth:$e.clientHeight)*$e.pixelRatio}),$m(1,$e,"clientWidth",function(){return $e.__init__(),$e.window.innerWidth||$e.document.body.clientWidth}),$m(1,$e,"window",function(){return $e.__init__(),$e._window}),$m(1,$e,"clientHeight",function(){return $e.__init__(),$e.window.innerHeight||$e.document.body.clientHeight||$e.document.documentElement.clientHeight}),$m(1,$e,"width",function(){return $e.__init__(),($z.stage&&$z.stage.canvasRotation?$e.clientHeight:$e.clientWidth)*$e.pixelRatio}),$m(1,$e,"container",function(){return $e.__init__(),$e._container||(($e._container=$e.createElement("div")).id="layaContainer",$e.document.body.appendChild($e._container)),$e._container},function($c){$e._container=$c}),$m(1,$e,"document",function(){return $e.__init__(),$e._document}),$e.__init__=function(){if(!$e._window){$e._window=$F.getWindow(),$e._document=$e.window.document,$e._window.addEventListener("message",function($c){laya.utils.Browser._onMessage($c)},!1),$e.document.__createElement=$e.document.createElement,$i.requestAnimationFrame=$i.requestAnimationFrame||$i.webkitRequestAnimationFrame||$i.mozRequestAnimationFrame||$i.oRequestAnimationFrame||$i.msRequestAnimationFrame||function($c){return $i.setTimeout($c,1e3/60)};var $c=$i.document.body.style;$c["-webkit-user-select"]="none",$c["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",$e.userAgent=$e.window.navigator.userAgent,$e.onIOS=!!($e.u=$e.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),$e.onMobile=-1<$e.u.indexOf("Mobile"),$e.onIPhone=-1<$e.u.indexOf("iPhone"),$e.onMac=-1<$e.u.indexOf("Mac OS X"),$e.onIPad=-1<$e.u.indexOf("iPad"),$e.onAndroid=-1<$e.u.indexOf("Android")||-1<$e.u.indexOf("Adr"),$e.onWP=-1<$e.u.indexOf("Windows Phone"),$e.onQQBrowser=-1<$e.u.indexOf("QQBrowser"),$e.onMQQBrowser=-1<$e.u.indexOf("MQQBrowser")||-1<$e.u.indexOf("Mobile")&&-1<$e.u.indexOf("QQ"),$e.onIE=!!$e.window.ActiveXObject||"ActiveXObject"in $e.window,$e.onWeiXin=-1<$e.u.indexOf("MicroMessenger"),$e.onPC=!$e.onMobile,$e.onSafari=-1<$e.u.indexOf("Safari"),$e.onFirefox=-1<$e.u.indexOf("Firefox"),$e.onEdge=-1<$e.u.indexOf("Edge"),$e.onMiniGame=-1<$e.u.indexOf("MiniGame"),$e.onLimixiu=-1<$e.u.indexOf("limixiu"),$e.httpProtocol="http:"==$e.window.location.protocol,$e.onMiniGame&&null==$e.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),$e.webAudioEnabled=!!($e.window.AudioContext||$e.window.webkitAudioContext||$e.window.mozAudioContext),$e.soundType=$e.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",$gc=$e.webAudioEnabled?$hc:$ec,$e.webAudioEnabled&&$hc.initWebAudio(),$ec._initMusicAudio(),$e.enableTouch="ontouchstart"in $i||$i.DocumentTouch&&$d instanceof DocumentTouch,$i.focus(),$E._soundClass=$gc,$E._musicClass=$ec,$J._mainCanvas=$J._mainCanvas||$vc.create("2D"),$e.canvas||($e.canvas=$vc.create("2D"),$e.context=$e.canvas.getContext("2d"))}},$e._onMessage=function($c){if($c.data&&"size"==$c.data.name){if($e.window.innerWidth=$c.data.width,$e.window.innerHeight=$c.data.height,$e.window.__innerHeight=$c.data.clientHeight,!$e.document.createEvent)return void console.warn("no document.createEvent");var $d=$e.document.createEvent("HTMLEvents");return $d.initEvent("resize",!1,!1),void $e.window.dispatchEvent($d)}},$e.createElement=function($c){return $e.__init__(),$e.document.__createElement($c)},$e.getElementById=function($c){return $e.__init__(),$e.document.getElementById($c)},$e.removeElement=function($c){$c&&$c.parentNode&&$c.parentNode.removeChild($c)},$e.now=function(){return $F.now()},$e._window=null,$e._document=null,$e._container=null,$e.userAgent=null,$e.u=null,$e.onIOS=!1,$e.onMac=!1,$e.onMobile=!1,$e.onIPhone=!1,$e.onIPad=!1,$e.onAndroid=!1,$e.onWP=!1,$e.onQQBrowser=!1,$e.onMQQBrowser=!1,$e.onSafari=!1,$e.onFirefox=!1,$e.onEdge=!1,$e.onIE=!1,$e.onWeiXin=!1,$e.onMiniGame=!1,$e.onLimixiu=!1,$e.onPC=!1,$e.httpProtocol=!1,$e.webAudioEnabled=!1,$e.soundType=null,$e.enableTouch=!1,$e.canvas=null,$e.context=null,$e.__init$=function(){},$e}()),$P=function(){function $d($c){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,$c?(this._u8d_=new Uint8Array($c),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}$r($d,"laya.utils.Byte");var $c=$d.prototype;return $c.___resizeBuffer=function($d){try{var $c=new Uint8Array($d);null!=this._u8d_&&(this._u8d_.length<=$d?$c.set(this._u8d_):$c.set(this._u8d_.subarray(0,$d))),this._u8d_=$c,this._d_=new DataView($c.buffer)}catch($c){throw"___resizeBuffer err:"+$d}},$c.getString=function(){return this.rUTF(this.getUint16())},$c.getFloat32Array=function($c,$d){var $e=$c+$d;$e=$e>this._length?this._length:$e;var $f=new Float32Array(this._d_.buffer.slice($c,$e));return this._pos_=$e,$f},$c.getUint8Array=function($c,$d){var $e=$c+$d;$e=$e>this._length?this._length:$e;var $f=new Uint8Array(this._d_.buffer.slice($c,$e));return this._pos_=$e,$f},$c.getInt16Array=function($c,$d){var $e=$c+$d;$e=$e>this._length?this._length:$e;var $f=new Int16Array(this._d_.buffer.slice($c,$e));return this._pos_=$e,$f},$c.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var $c=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,$c},$c.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var $c=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,$c},$c.writeFloat32=function($c){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,$c,this._xd_),this._pos_+=4},$c.writeFloat64=function($c){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,$c,this._xd_),this._pos_+=8},$c.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var $c=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,$c},$c.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var $c=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,$c},$c.writeInt32=function($c){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,$c,this._xd_),this._pos_+=4},$c.writeUint32=function($c){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,$c,this._xd_),this._pos_+=4},$c.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var $c=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,$c},$c.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var $c=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,$c},$c.writeUint16=function($c){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,$c,this._xd_),this._pos_+=2},$c.writeInt16=function($c){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,$c,this._xd_),this._pos_+=2},$c.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},$c.writeUint8=function($c){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,$c),this._pos_++},$c._getUInt8=function($c){return this._d_.getUint8($c)},$c._getUint16=function($c){return this._d_.getUint16($c,this._xd_)},$c._getMatrix=function(){return new $G(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},$c.rUTF=function($c){for(var $d=[],$e=this._pos_+$c,$f=0,$g=0,$h=0,$i=String.fromCharCode,$j=this._u8d_;this._pos_<$e;)($f=$j[this._pos_++])<128?0!=$f&&$d.push($i($f)):$f<224?$d.push($i((63&$f)<<6|127&$j[this._pos_++])):$f<240?($g=$j[this._pos_++],$d.push($i((31&$f)<<12|(127&$g)<<6|127&$j[this._pos_++]))):($g=$j[this._pos_++],$h=$j[this._pos_++],$d.push($i((15&$f)<<18|(127&$g)<<12|$h<<6&127|127&$j[this._pos_++]))),0;return $d.join("")},$c.getCustomString=function($c){for(var $d=[],$e=0,$f=0,$g=0,$h=String.fromCharCode,$i=this._u8d_;0<$c;)if(($f=$i[this._pos_])<128)$d.push($h($f)),this._pos_++,$c--;else for($e=$f-128,this._pos_++,$c-=$e;0<$e;)$f=$i[this._pos_++],$g=$i[this._pos_++],$d.push($h($g<<8|$f)),$e--;return $d.join("")},$c.clear=function(){this._pos_=0,this.length=0},$c.__getBuffer=function(){return this._d_.buffer},$c.writeUTFBytes=function($c){for(var $d=0,$e=($c+="").length;$d<$e;$d++){var $f=$c.charCodeAt($d);$f<=127?this.writeByte($f):$f<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|$f>>6,128|63&$f],this._pos_),this._pos_+=2):$f<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|$f>>12,128|$f>>6&63,128|63&$f],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|$f>>18,128|$f>>12&63,128|$f>>6&63,128|63&$f],this._pos_),this._pos_+=4)}},$c.writeUTFString=function($c){var $d=this.pos;this.writeUint16(1),this.writeUTFBytes($c);var $e=this.pos-$d-2;if(65536<=$e)throw"writeUTFString byte len more than 65536";this._d_.setUint16($d,$e,this._xd_)},$c.readUTFString=function(){return this.readUTFBytes(this.getUint16())},$c.getUTFString=function(){return this.readUTFString()},$c.readUTFBytes=function($c){if(void 0===$c&&($c=-1),0==$c)return"";var $d=this.bytesAvailable;if($d<$c)throw"readUTFBytes error - Out of bounds";return $c=0<$c?$c:$d,this.rUTF($c)},$c.getUTFBytes=function($c){return void 0===$c&&($c=-1),this.readUTFBytes($c)},$c.writeByte=function($c){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,$c),this._pos_+=1},$c.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},$c.getByte=function(){return this.readByte()},$c.ensureWrite=function($c){this._length<$c&&(this._length=$c),this._allocated_<$c&&(this.length=$c)},$c.writeArrayBuffer=function($c,$d,$e){if(void 0===$d&&($d=0),void 0===$e&&($e=0),$d<0||$e<0)throw"writeArrayBuffer error - Out of bounds";0==$e&&($e=$c.byteLength-$d),this.ensureWrite(this._pos_+$e);var $f=new Uint8Array($c);this._u8d_.set($f.subarray($d,$d+$e),this._pos_),this._pos_+=$e},$m(0,$c,"buffer",function(){var $c=this._d_.buffer;return $c.byteLength==this.length?$c:$c.slice(0,this.length)}),$m(0,$c,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function($c){this._xd_="littleEndian"==$c}),$m(0,$c,"length",function(){return this._length},function($c){this._allocated_<$c?this.___resizeBuffer(this._allocated_=Math.floor(Math.max($c,2*this._allocated_))):this._allocated_>$c&&this.___resizeBuffer(this._allocated_=$c),this._length=$c}),$m(0,$c,"pos",function(){return this._pos_},function($c){this._pos_=$c}),$m(0,$c,"bytesAvailable",function(){return this._length-this._pos_}),$d.getSystemEndian=function(){if(!$d._sysEndian){var $c=new ArrayBuffer(2);new DataView($c).setInt16(0,256,!0),$d._sysEndian=256===new Int16Array($c)[0]?"littleEndian":"bigEndian"}return $d._sysEndian},$d.BIG_ENDIAN="bigEndian",$d.LITTLE_ENDIAN="littleEndian",$d._sysEndian=null,$d}(),$Q=function(){function $g(){}return $r($g,"laya.utils.CacheManager"),$g.regCacheByFunction=function($c,$d){var $e;$g.unRegCacheByFunction($c,$d),$e={tryDispose:$c,getCacheList:$d},$g._cacheList.push($e)},$g.unRegCacheByFunction=function($c,$d){var $e,$f=0;for($e=$g._cacheList.length,$f=0;$f<$e;$f++)if($g._cacheList[$f].tryDispose==$c&&$g._cacheList[$f].getCacheList==$d)return void $g._cacheList.splice($f,1)},$g.forceDispose=function(){var $c=0,$d=$g._cacheList.length;for($c=0;$c<$d;$c++)$g._cacheList[$c].tryDispose(!0)},$g.beginCheck=function($c){void 0===$c&&($c=15e3),$z.timer.loop($c,null,$g._checkLoop)},$g.stopCheck=function(){$z.timer.clear(null,$g._checkLoop)},$g._checkLoop=function(){var $c=$g._cacheList;if(!($c.length<1)){var $d,$e=$O.now(),$f=0;for($d=$f=$c.length;0<$f&&($c[$g._index=++$g._index%$d].tryDispose(!1),!($O.now()-$e>$g.loopTimeLimit));)$f--}},$g.loopTimeLimit=2,$g._cacheList=[],$g._index=0,$g}(),$R=function(){function $p(){}return $r($p,"laya.utils.ClassUtils"),$p.regClass=function($c,$d){$p._classMap[$c]=$d},$p.getRegClass=function($c){return $p._classMap[$c]},$p.getInstance=function($c){var $d=$p.getClass($c);return $d?new $d:(console.warn("[error] Undefined class:",$c),null)},$p.createByJson=function($c,$d,$e,$f,$g){"string"==typeof $c&&($c=JSON.parse($c));var $h=$c.props;if(!$d&&!($d=$g?$g.runWith($c):$p.getInstance($h.runtime||$c.type)))return null;var $i=$c.child;if($i)for(var $j=0,$k=$i.length;$j<$k;$j++){var $l=$i[$j];if("render"!==$l.props.name&&"render"!==$l.props.renderType||!$d._$set_itemRender)if("Graphic"==$l.type)$p.addGraphicsToSprite($l,$d);else if($p.isDrawType($l.type))$p.addGraphicToSprite($l,$d,!0);else{var $m=$p.createByJson($l,null,$e,$f,$g);"Script"==$l.type?$m.hasOwnProperty("owner")?$m.owner=$d:$m.hasOwnProperty("target")&&($m.target=$d):"mask"==$l.props.renderType?$d.mask=$m:$d.addChild($m)}else $d.itemRender=$l}if($h)for(var $n in $h){var $o=$h[$n];"var"===$n&&$e?$e[$o]=$d:$o instanceof Array&&"function"==typeof $d[$n]?$d[$n].apply($d,$o):$d[$n]=$o}return $f&&$c.customProps&&$f.runWith([$d,$c]),$d.created&&$d.created(),$d},$p.addGraphicsToSprite=function($c,$d){var $e;if(($e=$c.child)&&!($e.length<1)){var $f;$f=$p._getGraphicsFromSprite($c,$d);var $g=0,$h=0;$c.props&&($g=$p._getObjVar($c.props,"x",0),$h=$p._getObjVar($c.props,"y",0)),0!=$g&&0!=$h&&$f.translate($g,$h);var $i,$j=0;for($i=$e.length,$j=0;$j<$i;$j++)$p._addGraphicToGraphics($e[$j],$f);0!=$g&&0!=$h&&$f.translate(-$g,-$h)}},$p.addGraphicToSprite=function($c,$d,$e){var $f;void 0===$e&&($e=!1),$f=$e?$p._getGraphicsFromSprite($c,$d):$d.graphics,$p._addGraphicToGraphics($c,$f)},$p._getGraphicsFromSprite=function($c,$d){var $e,$f;if(!$c||!$c.props)return $d.graphics;switch($f=$c.props.renderType){case"hit":case"unHit":var $g;$d.hitArea||($d.hitArea=new $V),($g=$d.hitArea)[$f]||($g[$f]=new $o),$e=$g[$f]}return $e||($e=$d.graphics),$e},$p._getTransformData=function($c){var $d;($c.hasOwnProperty("pivotX")||$c.hasOwnProperty("pivotY"))&&($d=$d||new $G).translate(-$p._getObjVar($c,"pivotX",0),-$p._getObjVar($c,"pivotY",0));var $e=$p._getObjVar($c,"scaleX",1),$f=$p._getObjVar($c,"scaleY",1),$g=$p._getObjVar($c,"rotation",0);$p._getObjVar($c,"skewX",0),$p._getObjVar($c,"skewY",0);return 1==$e&&1==$f&&0==$g||(($d=$d||new $G).scale($e,$f),$d.rotate(.0174532922222222*$g)),$d},$p._addGraphicToGraphics=function($c,$d){var $e,$f;if(($e=$c.props)&&($f=$p.DrawTypeDic[$c.type])){var $g,$h;$g=$d;var $i=$p._getParams($e,$f[1],$f[2],$f[3]);(($h=$p._tM)||1!=$p._alpha)&&($g.save(),$h&&$g.transform($h),1!=$p._alpha&&$g.alpha($p._alpha)),$g[$f[0]].apply($g,$i),($h||1!=$p._alpha)&&$g.restore()}},$p._adptLineData=function($c){return $c[2]=parseFloat($c[0])+parseFloat($c[2]),$c[3]=parseFloat($c[1])+parseFloat($c[3]),$c},$p._adptTextureData=function($c){return $c[0]=$jc.getRes($c[0]),$c},$p._adptLinesData=function($c){return $c[2]=$p._getPointListByStr($c[2]),$c},$p.isDrawType=function($c){return"Image"!=$c&&$p.DrawTypeDic.hasOwnProperty($c)},$p._getParams=function($c,$d,$e,$f){var $g;void 0===$e&&($e=0),($g=$p._temParam).length=$d.length;var $h,$i,$j=0;for($h=$d.length,$j=0;$j<$h;$j++)$g[$j]=$p._getObjVar($c,$d[$j][0],$d[$j][1]);return $p._alpha=$p._getObjVar($c,"alpha",1),$i=$p._getTransformData($c),$p._tM=$i?($e||($e=0),$i.translate($g[$e],$g[$e+1]),$g[$e]=$g[$e+1]=0,$i):null,$f&&$p[$f]&&($g=$p[$f]($g)),$g},$p._getPointListByStr=function($c){var $d,$e,$f=0;for($e=($d=$c.split(",")).length,$f=0;$f<$e;$f++)$d[$f]=parseFloat($d[$f]);return $d},$p._getObjVar=function($c,$d,$e){return $c.hasOwnProperty($d)?$c[$d]:$e},$p._temParam=[],$p._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},$p.getClass=function($c){var $d=$p._classMap[$c]||$c;return"string"==typeof $d?$z.__classmap[$d]:$d},$p._tM=null,$p._alpha=NaN,$k($p,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),$p}(),$S=function(){function $h($c){if(this._color=[],"string"==typeof $c){null===(this.strColor=$c)&&($c="#000000"),"#"==$c.charAt(0)&&($c=$c.substr(1));var $d=$c.length;if(3==$d||4==$d){for(var $e="",$f=0;$f<$d;$f++)$e+=$c[$f]+$c[$f];$c=$e}var $g=this.numColor=parseInt($c,16);if(8==$c.length)return void(this._color=[parseInt($c.substr(0,2),16)/255,((16711680&$g)>>16)/255,((65280&$g)>>8)/255,(255&$g)/255])}else $g=this.numColor=$c,this.strColor=$$.toHexColor($g);this._color=[((16711680&$g)>>16)/255,((65280&$g)>>8)/255,(255&$g)/255,1],this._color.__id=++$h._COLODID}return $r($h,"laya.utils.Color"),$h._initDefault=function(){for(var $c in $h._DEFAULT={},$h._COLOR_MAP)$h._SAVE[$c]=$h._DEFAULT[$c]=new $h($h._COLOR_MAP[$c]);return $h._DEFAULT},$h._initSaveMap=function(){for(var $c in $h._SAVE_SIZE=0,$h._SAVE={},$h._DEFAULT)$h._SAVE[$c]=$h._DEFAULT[$c]},$h.create=function($c){var $d=$h._SAVE[$c+""];return null!=$d?$d:($h._SAVE_SIZE<1e3||$h._initSaveMap(),$h._SAVE[$c+""]=new $h($c))},$h._SAVE={},$h._SAVE_SIZE=0,$h._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},$h._DEFAULT=$h._initDefault(),$h._COLODID=1,$h}(),$T=(function(){function $c(){this._values=[],this._keys=[]}$r($c,"laya.utils.Dictionary");var $d=$c.prototype;$d.set=function($c,$d){var $e=this.indexOf($c);0<=$e?this._values[$e]=$d:(this._keys.push($c),this._values.push($d))},$d.indexOf=function($c){var $d=this._keys.indexOf($c);return 0<=$d?$d:($c="string"==typeof $c?Number($c):"number"==typeof $c?$c.toString():$c,this._keys.indexOf($c))},$d.get=function($c){var $d=this.indexOf($c);return $d<0?null:this._values[$d]},$d.remove=function($c){var $d=this.indexOf($c);return 0<=$d&&(this._keys.splice($d,1),this._values.splice($d,1),!0)},$d.clear=function(){this._values.length=0,this._keys.length=0},$m(0,$d,"values",function(){return this._values}),$m(0,$d,"keys",function(){return this._keys})}(),function(){function $c(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}$r($c,"laya.utils.Dragging");var $d=$c.prototype;return $d.start=function($c,$d,$e,$f,$g,$h,$i,$j){void 0===$j&&($j=.92),this.clearTimer(),this.target=$c,this.area=$d,this.hasInertia=$e,this.elasticDistance=$d?$f:0,this.elasticBackTime=$g,this.data=$h,this._disableMouseEvent=$i,this.ratio=$j,1!=$c.globalScaleX||1!=$c.globalScaleY?this._parent=$c.parent:this._parent=$z.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,$z.stage.on("mouseup",this,this.onStageMouseUp),$z.stage.on("mouseout",this,this.onStageMouseUp),$z.timer.frameLoop(1,this,this.loop)},$d.clearTimer=function(){$z.timer.clear(this,this.loop),$z.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},$d.stop=function(){this._dragging&&($q.instance.disableMouseEvent=!1,$z.stage.off("mouseup",this,this.onStageMouseUp),$z.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},$d.loop=function(){var $c=this._parent.getMousePoint(),$d=$c.x,$e=$c.y,$f=$d-this._lastX,$g=$e-this._lastY;if(this._clickOnly){if(!(1<Math.abs($f*$z.stage._canvasTransform.getScaleX())||1<Math.abs($g*$z.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),$q.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push($f,$g);0==$f&&0==$g||(this._lastX=$d,this._lastY=$e,this.target.x+=$f*this._elasticRateX,this.target.y+=$g*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},$d.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var $c=this.area.x-this.target.x;else $c=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-$c/this.elasticDistance),this.target.y<this.area.y)var $d=this.area.y-this.target.y;else $d=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-$d/this.elasticDistance)}},$d.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},$d.onStageMouseUp=function($c){if($q.instance.disableMouseEvent=!1,$z.stage.off("mouseup",this,this.onStageMouseUp),$z.stage.off("mouseout",this,this.onStageMouseUp),$z.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var $d=this._offsets.length,$e=Math.min($d,6),$f=this._offsets.length-$e,$g=$d-1;$f<$g;$g--)this._offsetY+=this._offsets[$g--],this._offsetX+=this._offsets[$g];this._offsetX=this._offsetX/$e*2,this._offsetY=this._offsetY/$e*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),$z.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},$d.checkElastic=function(){var $c=NaN,$d=NaN;if(this.target.x<this.area.x?$c=this.area.x:this.target.x>this.area.x+this.area.width&&($c=this.area.x+this.area.width),this.target.y<this.area.y?$d=this.area.y:this.target.y>this.area.y+this.area.height&&($d=this.area.y+this.area.height),isNaN($c)&&isNaN($d))this.clear();else{var $e={};isNaN($c)||($e.x=$c),isNaN($d)||($e.y=$d),this._tween=$Z.to(this.target,$e,this.elasticBackTime,$U.sineOut,$u.create(this,this.clear),0,!1,!1)}},$d.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&($z.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},$d.clear=function(){if(this.target){this.clearTimer();var $c=this.target;this.target=null,this._parent=null,$c.event("dragend",this.data)}},$c}()),$U=function(){function $j(){}return $r($j,"laya.utils.Ease"),$j.linearNone=function($c,$d,$e,$f){return $e*$c/$f+$d},$j.linearIn=function($c,$d,$e,$f){return $e*$c/$f+$d},$j.linearInOut=function($c,$d,$e,$f){return $e*$c/$f+$d},$j.linearOut=function($c,$d,$e,$f){return $e*$c/$f+$d},$j.bounceIn=function($c,$d,$e,$f){return $e-$j.bounceOut($f-$c,0,$e,$f)+$d},$j.bounceInOut=function($c,$d,$e,$f){return $c<.5*$f?.5*$j.bounceIn(2*$c,0,$e,$f)+$d:.5*$j.bounceOut(2*$c-$f,0,$e,$f)+.5*$e+$d},$j.bounceOut=function($c,$d,$e,$f){return($c/=$f)<1/2.75?$e*(7.5625*$c*$c)+$d:$c<2/2.75?$e*(7.5625*($c-=1.5/2.75)*$c+.75)+$d:$c<2.5/2.75?$e*(7.5625*($c-=2.25/2.75)*$c+.9375)+$d:$e*(7.5625*($c-=2.625/2.75)*$c+.984375)+$d},$j.backIn=function($c,$d,$e,$f,$g){return void 0===$g&&($g=1.70158),$e*($c/=$f)*$c*(($g+1)*$c-$g)+$d},$j.backInOut=function($c,$d,$e,$f,$g){return void 0===$g&&($g=1.70158),($c/=.5*$f)<1?.5*$e*($c*$c*((1+($g*=1.525))*$c-$g))+$d:$e/2*(($c-=2)*$c*((1+($g*=1.525))*$c+$g)+2)+$d},$j.backOut=function($c,$d,$e,$f,$g){return void 0===$g&&($g=1.70158),$e*(($c=$c/$f-1)*$c*(($g+1)*$c+$g)+1)+$d},$j.elasticIn=function($c,$d,$e,$f,$g,$h){var $i;return void 0===$g&&($g=0),void 0===$h&&($h=0),0==$c?$d:1==($c/=$f)?$d+$e:($h||($h=.3*$f),$i=!$g||0<$e&&$g<$e||$e<0&&$g<-$e?($g=$e,$h/4):$h/$j.PI2*Math.asin($e/$g),-$g*Math.pow(2,10*($c-=1))*Math.sin(($c*$f-$i)*$j.PI2/$h)+$d)},$j.elasticInOut=function($c,$d,$e,$f,$g,$h){var $i;return void 0===$g&&($g=0),void 0===$h&&($h=0),0==$c?$d:2==($c/=.5*$f)?$d+$e:($h||($h=$f*(.3*1.5)),$i=!$g||0<$e&&$g<$e||$e<0&&$g<-$e?($g=$e,$h/4):$h/$j.PI2*Math.asin($e/$g),$c<1?$g*Math.pow(2,10*($c-=1))*Math.sin(($c*$f-$i)*$j.PI2/$h)*-.5+$d:$g*Math.pow(2,-10*($c-=1))*Math.sin(($c*$f-$i)*$j.PI2/$h)*.5+$e+$d)},$j.elasticOut=function($c,$d,$e,$f,$g,$h){var $i;return void 0===$g&&($g=0),void 0===$h&&($h=0),0==$c?$d:1==($c/=$f)?$d+$e:($h||($h=.3*$f),$i=!$g||0<$e&&$g<$e||$e<0&&$g<-$e?($g=$e,$h/4):$h/$j.PI2*Math.asin($e/$g),$g*Math.pow(2,-10*$c)*Math.sin(($c*$f-$i)*$j.PI2/$h)+$e+$d)},$j.strongIn=function($c,$d,$e,$f){return $e*($c/=$f)*$c*$c*$c*$c+$d},$j.strongInOut=function($c,$d,$e,$f){return($c/=.5*$f)<1?.5*$e*$c*$c*$c*$c*$c+$d:.5*$e*(($c-=2)*$c*$c*$c*$c+2)+$d},$j.strongOut=function($c,$d,$e,$f){return $e*(($c=$c/$f-1)*$c*$c*$c*$c+1)+$d},$j.sineInOut=function($c,$d,$e,$f){return.5*-$e*(Math.cos(Math.PI*$c/$f)-1)+$d},$j.sineIn=function($c,$d,$e,$f){return-$e*Math.cos($c/$f*$j.HALF_PI)+$e+$d},$j.sineOut=function($c,$d,$e,$f){return $e*Math.sin($c/$f*$j.HALF_PI)+$d},$j.quintIn=function($c,$d,$e,$f){return $e*($c/=$f)*$c*$c*$c*$c+$d},$j.quintInOut=function($c,$d,$e,$f){return($c/=.5*$f)<1?.5*$e*$c*$c*$c*$c*$c+$d:.5*$e*(($c-=2)*$c*$c*$c*$c+2)+$d},$j.quintOut=function($c,$d,$e,$f){return $e*(($c=$c/$f-1)*$c*$c*$c*$c+1)+$d},$j.quartIn=function($c,$d,$e,$f){return $e*($c/=$f)*$c*$c*$c+$d},$j.quartInOut=function($c,$d,$e,$f){return($c/=.5*$f)<1?.5*$e*$c*$c*$c*$c+$d:.5*-$e*(($c-=2)*$c*$c*$c-2)+$d},$j.quartOut=function($c,$d,$e,$f){return-$e*(($c=$c/$f-1)*$c*$c*$c-1)+$d},$j.cubicIn=function($c,$d,$e,$f){return $e*($c/=$f)*$c*$c+$d},$j.cubicInOut=function($c,$d,$e,$f){return($c/=.5*$f)<1?.5*$e*$c*$c*$c+$d:.5*$e*(($c-=2)*$c*$c+2)+$d},$j.cubicOut=function($c,$d,$e,$f){return $e*(($c=$c/$f-1)*$c*$c+1)+$d},$j.quadIn=function($c,$d,$e,$f){return $e*($c/=$f)*$c+$d},$j.quadInOut=function($c,$d,$e,$f){return($c/=.5*$f)<1?.5*$e*$c*$c+$d:.5*-$e*(--$c*($c-2)-1)+$d},$j.quadOut=function($c,$d,$e,$f){return-$e*($c/=$f)*($c-2)+$d},$j.expoIn=function($c,$d,$e,$f){return 0==$c?$d:$e*Math.pow(2,10*($c/$f-1))+$d-.001*$e},$j.expoInOut=function($c,$d,$e,$f){return 0==$c?$d:$c==$f?$d+$e:($c/=.5*$f)<1?.5*$e*Math.pow(2,10*($c-1))+$d:.5*$e*(2-Math.pow(2,-10*--$c))+$d},$j.expoOut=function($c,$d,$e,$f){return $c==$f?$d+$e:$e*(1-Math.pow(2,-10*$c/$f))+$d},$j.circIn=function($c,$d,$e,$f){return-$e*(Math.sqrt(1-($c/=$f)*$c)-1)+$d},$j.circInOut=function($c,$d,$e,$f){return($c/=.5*$f)<1?.5*-$e*(Math.sqrt(1-$c*$c)-1)+$d:.5*$e*(Math.sqrt(1-($c-=2)*$c)+1)+$d},$j.circOut=function($c,$d,$e,$f){return $e*Math.sqrt(1-($c=$c/$f-1)*$c)+$d},$j.HALF_PI=.5*Math.PI,$j.PI2=2*Math.PI,$j}(),$V=function(){function $n(){this._hit=null,this._unHit=null}$r($n,"laya.utils.HitArea");var $c=$n.prototype;return $c.isHit=function($c,$d){return!!$n.isHitGraphic($c,$d,this.hit)&&!$n.isHitGraphic($c,$d,this.unHit)},$c.contains=function($c,$d){return this.isHit($c,$d)},$m(0,$c,"hit",function(){return this._hit||(this._hit=new $o),this._hit},function($c){this._hit=$c}),$m(0,$c,"unHit",function(){return this._unHit||(this._unHit=new $o),this._unHit},function($c){this._unHit=$c}),$n.isHitGraphic=function($c,$d,$e){if(!$e)return!1;var $f;if(!($f=$e.cmds)&&$e._one&&(($f=$n._cmds).length=1,$f[0]=$e._one),!$f)return!1;var $g,$h,$i=0;for($g=$f.length,$i=0;$i<$g;$i++)if($h=$f[$i]){var $j=$J._context;switch($h.callee){case $j._translate:case 6:$c-=$h[0],$d-=$h[1]}if($n.isHitCmd($c,$d,$h))return!0}return!1},$n.isHitCmd=function($c,$d,$e){if(!$e)return!1;var $f=$J._context,$g=!1;switch($e.callee){case $f._drawRect:case 13:$n._rec.setTo($e[0],$e[1],$e[2],$e[3]),$g=$n._rec.contains($c,$d);break;case $f._drawCircle:case $f._fillCircle:case 14:$g=($c-=$e[0])*$c+($d-=$e[1])*$d<$e[2]*$e[2];break;case $f._drawPoly:case 18:$c-=$e[0],$d-=$e[1],$g=$n.ptInPolygon($c,$d,$e[2])}return $g},$n.ptInPolygon=function($c,$d,$e){var $f;($f=$n._ptPoint).setTo($c,$d);var $g,$h=0,$i=NaN,$j=NaN,$k=NaN,$l=NaN;$g=$e.length;for(var $m=0;$m<$g;$m+=2){if($i=$e[$m],$j=$e[$m+1],$k=$e[($m+2)%$g],$j!=($l=$e[($m+3)%$g]))if(!($f.y<Math.min($j,$l)))if(!($f.y>=Math.max($j,$l)))($f.y-$j)*($k-$i)/($l-$j)+$i>$f.x&&$h++}return $h%2==1},$n._cmds=[],$k($n,["_rec",function(){return this._rec=new $B},"_ptPoint",function(){return this._ptPoint=new $A}]),$n}(),$W=(function(){function $g($c,$d,$e,$f){this.char=$c,this.charNum=$c.charCodeAt(0),this._x=this._y=0,this.width=$d,this.height=$e,this.style=$f,this.isWord=!$g._isWordRegExp.test($c)}$r($g,"laya.utils.HTMLChar");var $c=$g.prototype;$z.imps($c,{"laya.display.ILayout":!0}),$c.setSprite=function($c){this._sprite=$c},$c.getSprite=function(){return this._sprite},$c._isChar=function(){return!0},$c._getCSSStyle=function(){return this.style},$m(0,$c,"width",function(){return this._w},function($c){this._w=$c}),$m(0,$c,"x",function(){return this._x},function($c){this._sprite&&(this._sprite.x=$c),this._x=$c}),$m(0,$c,"y",function(){return this._y},function($c){this._sprite&&(this._sprite.y=$c),this._y=$c}),$m(0,$c,"height",function(){return this._h},function($c){this._h=$c}),$g._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function $d(){}$r($d,"laya.utils.Log"),$d.enable=function(){$d._logdiv||($d._logdiv=$O.window.document.createElement("div"),$O.window.document.body.appendChild($d._logdiv),$d._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},$d.toggle=function(){var $c=$d._logdiv.style;"1px"==$c.width?$c.width=$c.height="50%":$c.width=$c.height="1px"},$d.print=function($c){$d._logdiv&&($d.maxCount<=$d._count&&$d.clear(),$d._count++,$d._logdiv.innerText+=$c+"\n",$d._logdiv.scrollTop=$d._logdiv.scrollHeight)},$d.clear=function(){$d._logdiv.innerText="",$d._count=0},$d._logdiv=null,$d._count=0,$d.maxCount=20}(),function(){function $d(){}$r($d,"laya.utils.Mouse"),$m(1,$d,"cursor",function(){return $d._style.cursor},function($c){$d._style.cursor=$c}),$d.hide=function(){"none"!=$d.cursor&&($d._preCursor=$d.cursor,$d.cursor="none")},$d.show=function(){"none"==$d.cursor&&($d.cursor=$d._preCursor?$d._preCursor:"auto")},$d._preCursor=null,$k($d,["_style",function(){return this._style=$O.document.body.style}])}(),function(){function $h(){}return $r($h,"laya.utils.Pool"),$h.getPoolBySign=function($c){return $h._poolDic[$c]||($h._poolDic[$c]=[])},$h.clearBySign=function($c){$h._poolDic[$c]&&($h._poolDic[$c].length=0)},$h.recover=function($c,$d){$d.__InPool||($d.__InPool=!0,$h.getPoolBySign($c).push($d))},$h.getItemByClass=function($c,$d){var $e=$h.getPoolBySign($c),$f=$e.length?$e.pop():new $d;return $f.__InPool=!1,$f},$h.getItemByCreateFun=function($c,$d,$e){var $f=$h.getPoolBySign($c),$g=$f.length?$f.pop():$d.call($e);return $g.__InPool=!1,$g},$h.getItem=function($c){var $d=$h.getPoolBySign($c),$e=$d.length?$d.pop():null;return $e&&($e.__InPool=!1),$e},$h._poolDic={},$h.InPoolSign="__InPool",$h}()),$X=function(){function $k(){}return $r($k,"laya.utils.Stat"),$m(1,$k,"onclick",null,function($c){$k._sp&&$k._sp.on("click",$k._sp,$c),$k._canvas&&($k._canvas.source.onclick=$c,$k._canvas.source.style.pointerEvents="")}),$k.show=function($c,$d,$e){if(void 0===$c&&($c=0),void 0===$d&&($d=0),void 0===$e&&($e=0),!$J.isConchApp||$J.isConchWebGL){if($J.isConchWebGL||$O.onMiniGame||$O.onLimixiu||($k._useCanvas=!0),$k._show=!0,$k._fpsData.length=60,$k._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},$k._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},$k._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},$k._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},$J.isWebGL)if($k._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},$J.is3DMode){if($k._view[0].title="FPS(3D)",$k._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},$k._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},$k._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==$e){var $f=8;$k._view[$f++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},$k._view[$f++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$k._view[$f++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},$k._view[$f++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$k._view[$f++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$k._view[$f++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$k._view[$f++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$k._view[$f++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},$k._view[$f++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==$e){$f=8;$k._view[$f++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},$k._view[$f++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},$k._view[$f++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},$k._view[$f++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},$k._view[$f++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},$k._view[$f++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},$k._view[$f++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else $k._view[0].title="FPS(WebGL)",$k._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else $k._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};$k._useCanvas?$k.createUIPre($c,$d):$k.createUI($c,$d),$k.enable()}else $O.window.conch.showFPS&&$O.window.conch.showFPS($c,$d)},$k.createUIPre=function($c,$d){var $e=$O.pixelRatio;$k._width=170*$e,$k._vx=75*$e,$k._height=$e*(12*$k._view.length+3*$e)+4,$k._fontSize=12*$e;for(var $f=0;$f<$k._view.length;$f++)$k._view[$f].x=4,$k._view[$f].y=$f*$k._fontSize+2*$e;$k._canvas||(($k._canvas=new $vc("2D")).size($k._width,$k._height),($k._ctx=$k._canvas.getContext("2d")).textBaseline="top",$k._ctx.font=$k._fontSize+"px Sans-serif",$k._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+$c+"px;top:"+$d+"px;width:"+$k._width/$e+"px;height:"+$k._height/$e+"px;"),$k._first=!0,$k.loop(),$k._first=!1,$O.container.appendChild($k._canvas.source)},$k.createUI=function($c,$d){var $e=$k._sp,$f=$O.pixelRatio;$e||($e=new $nc,($k._leftText=new $sc).pos(5,5),$k._leftText.color="#ffffff",$e.addChild($k._leftText),($k._txt=new $sc).pos(80*$f,5),$k._txt.color="#ffffff",$e.addChild($k._txt),$k._sp=$e),$e.pos($c,$d);for(var $g="",$h=0;$h<$k._view.length;$h++){$g+=$k._view[$h].title+"\n"}$k._leftText.text=$g;var $i=170*$f,$j=$f*(12*$k._view.length+3*$f)+4;$k._txt.fontSize=$k._fontSize*$f,$k._leftText.fontSize=$k._fontSize*$f,$e.size($i,$j),$e.graphics.clear(),$e.graphics.setAlpha(.5),$e.graphics.drawRect(0,0,$i,$j,"#999999"),$e.graphics.setAlpha(1),$k.loop()},$k.enable=function(){$z.timer.frameLoop(1,$k,$k.loop)},$k.hide=function(){$k._show=!1,$z.timer.clear($k,$k.loop),$k._canvas&&$O.removeElement($k._canvas.source)},$k.clear=function(){$k.trianglesFaces=$k.drawCall=$k.shaderCall=$k.spriteCount=$k.spriteRenderUseCacheCount=$k.treeNodeCollision=$k.treeSpriteCollision=$k.canvasNormal=$k.canvasBitmap=$k.canvasReCache=0},$k.loop=function(){$k._count++;var $c=$O.now();if(!($c-$k._timer<1e3)){var $d=$k._count;if($k.FPS=Math.round(1e3*$d/($c-$k._timer)),$k._show){$k.trianglesFaces=Math.round($k.trianglesFaces/$d),$k.spriteCount=$k._useCanvas?($k.drawCall=Math.round($k.drawCall/$d)-2,$k.shaderCall=Math.round($k.shaderCall/$d),Math.round($k.spriteCount/$d)-1):($k.drawCall=Math.round($k.drawCall/$d)-2,$k.shaderCall=Math.round($k.shaderCall/$d)-4,Math.round($k.spriteCount/$d)-4),$k.spriteRenderUseCacheCount=Math.round($k.spriteRenderUseCacheCount/$d),$k.canvasNormal=Math.round($k.canvasNormal/$d),$k.canvasBitmap=Math.round($k.canvasBitmap/$d),$k.canvasReCache=Math.ceil($k.canvasReCache/$d),$k.treeNodeCollision=Math.round($k.treeNodeCollision/$d),$k.treeSpriteCollision=Math.round($k.treeSpriteCollision/$d);var $e=0<$k.FPS?Math.floor(1e3/$k.FPS).toString():" ";$k._fpsStr=$k.FPS+($k.renderSlow?" slow":"")+" "+$e,$k._spriteStr=$k.spriteCount+($k.spriteRenderUseCacheCount?"/"+$k.spriteRenderUseCacheCount:""),$k._canvasStr=$k.canvasReCache+"/"+$k.canvasNormal+"/"+$k.canvasBitmap,$k.currentMemorySize=$N.systemResourceManager.memorySize,$k._useCanvas?$k.renderInfoPre():$k.renderInfo(),$k.clear()}$k._count=0,$k._timer=$c}},$k.renderInfoPre=function(){if($k._canvas){var $c=$k._ctx;$c.clearRect($k._first?0:$k._vx,0,$k._width,$k._height);for(var $d=$J.WebGL.mainContext,$e=0;$e<$k._view.length;$e++){var $f=$k._view[$e];$k._first&&($c.fillStyle="white",$c.fillText($f.title,$f.x,$f.y,null,null,null)),$c.fillStyle=$f.color;var $g=-1;if(($f=$k._view[$e]).varying){if($d)switch($f.varying){case 1:$g=$d.getParameter($d[$f.value]);break;case 2:$g=$d.getExtension($f.value)}}else $g=$k[$f.value];"M"==$f.units&&($g=Math.floor($g/1048576*100)/100+" M"),"K"==$f.units&&($g=Math.floor($g/1024*100)/100+" K"),"string"==$f.units&&($g=$g.match(/\d+\.?\d/i)),$c.fillText($g+"",$f.x+$k._vx,$f.y,null,null,null)}}},$k.renderInfo=function(){for(var $c="",$d=$J.WebGL.mainContext,$e=0;$e<$k._view.length;$e++){var $f=$k._view[$e],$g=-1;if($f.varying){if($d)switch($f.varying){case 1:$g=$d.getParameter($d[$f.value]);break;case 2:$g=$d.getExtension($f.value)}}else $g=$k[$f.value];"M"==$f.units&&($g=Math.floor($g/1048576*100)/100+" M"),"K"==$f.units&&($g=Math.floor($g/1024*100)/100+" K"),"string"==$f.units&&($g=$g.match(/\d+\.?\d/i)),$c+=$g+"\n"}$k._txt.text=$c},$k.FPS=0,$k.loopCount=0,$k.shaderCall=0,$k.drawCall=0,$k.trianglesFaces=0,$k.spriteCount=0,$k.spriteRenderUseCacheCount=0,$k.treeNodeCollision=0,$k.treeSpriteCollision=0,$k.canvasNormal=0,$k.canvasBitmap=0,$k.canvasReCache=0,$k.renderSlow=!1,$k.currentMemorySize=0,$k._fpsStr=null,$k._canvasStr=null,$k._spriteStr=null,$k._fpsData=[],$k._timer=0,$k._count=0,$k._view=[],$k._fontSize=12,$k._txt=null,$k._leftText=null,$k._sp=null,$k._show=!1,$k._useCanvas=!1,$k._canvas=null,$k._ctx=null,$k._first=!1,$k._vx=NaN,$k._width=0,$k._height=100,$k}(),$Y=(function(){function $c(){this._strsToID={},this._idToStrs=[],this._length=0}$r($c,"laya.utils.StringKey");var $d=$c.prototype;$d.add=function($c){var $d=this._strsToID[$c];return null!=$d?$d:(this._idToStrs[this._length]=$c,this._strsToID[$c]=this._length++)},$d.getID=function($c){var $d=this._strsToID[$c];return null==$d?-1:$d},$d.getName=function($c){var $d=this._idToStrs[$c];return null==$d?void 0:$d}}(),function(){var $l;function $c(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}$r($c,"laya.utils.Timer");var $d=$c.prototype;return $d._init=function(){$z.timer&&$z.timer.frameLoop(1,this,this._update)},$d._now=function(){return Date.now()},$d._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var $c=this.currFrame=this.currFrame+this.scale,$d=this._now();this._delta=($d-this._lastTimer)*this.scale;var $e=this.currTimer=this.currTimer+this._delta;$z.isDebug&&6e4<Math.abs($d-this._lastTimer)&&console.error("系统时间错误！"+($d-this._lastTimer)),this._lastTimer=$d;var $f=this._handlers;for($i=this._count=0,$j=$f.length;$i<$j;$i++)if(null!==($k=$f[$i]).method){var $g=$k.userFrame?$c:$e;if($g>=$k.exeTime)if($k.repeat)if($k.jumpFrame)for(;$g>=$k.exeTime;)$k.exeTime+=$k.delay,$k.run(!1);else $k.exeTime+=$k.delay,$k.run(!1),$g>$k.exeTime&&($k.exeTime+=Math.ceil(($g-$k.exeTime)/$k.delay)*$k.delay);else $k.run(!0)}else this._count++;(30<this._count||$c%200==0)&&this._clearHandlers();for(var $h=this._laters,$i=0,$j=$h.length-1;$i<=$j;$i++){var $k=$h[$i];this._isIgnoreRecover($k)||(null!==$k.method&&(delete this._map[$k.key],$k.run(!1)),this._recoverHandler($k)),$i===$j&&($j=$h.length-1)}$h.length=0}},$d._clearHandlers=function(){for(var $c=this._handlers,$d=0,$e=$c.length;$d<$e;$d++){var $f=$c[$d];null!==$f.method?this._temp.push($f):this._isIgnoreRecover($f)?this._temp.push($f):this._recoverHandler($f)}this._handlers=this._temp,this._temp=$c,this._temp.length=0},$d._recoverHandler=function($c){this._map[$c.key]==$c&&delete this._map[$c.key],$c.recover()},$d._create=function($c,$d,$e,$f,$g,$h,$i,$j){if(!$e)return $g.apply($f,$h),null;if($i){var $k=this._getHandler($f,$g);if($k)return $k.repeat=$d,$k.userFrame=$c,$k.delay=$e,$k.ignoreRecover=$j,$k.caller=$f,$k.method=$g,$k.args=$h,$k.exeTime=$e+($c?this.currFrame:this.currTimer+this._now()-this._lastTimer),$k}return($k=$l.create()).repeat=$d,$k.userFrame=$c,$k.delay=$e,$k.ignoreRecover=$j,$k.caller=$f,$k.method=$g,$k.args=$h,$k.exeTime=$e+($c?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler($k),this._handlers.push($k),$k},$d._indexHandler=function($c){var $d=$c.caller,$e=$c.method,$f=$d?$d.$_GID||($d.$_GID=$$.getGID()):0,$g=$e.$_TID||($e.$_TID=this._mid++);$c.key=$f+"_"+$g,this._map[$c.key]=$c},$d.once=function($c,$d,$e,$f,$g){void 0===$g&&($g=!0),this._create(!1,!1,$c,$d,$e,$f,$g,!1)},$d.loop=function($c,$d,$e,$f,$g,$h,$i){void 0===$g&&($g=!0),void 0===$h&&($h=!1),void 0===$i&&($i=!1);var $j=this._create(!1,!0,$c,$d,$e,$f,$g,$i);$j&&($j.jumpFrame=$h)},$d.frameOnce=function($c,$d,$e,$f,$g){void 0===$g&&($g=!0),this._create(!0,!1,$c,$d,$e,$f,$g,!1)},$d.frameLoop=function($c,$d,$e,$f,$g,$h){void 0===$g&&($g=!0),void 0===$h&&($h=!1),this._create(!0,!0,$c,$d,$e,$f,$g,$h)},$d.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+$l._freeCount},$d.clear=function($c,$d){var $e=this._getHandler($c,$d);return!(!$e||this._isIgnoreRecover($e))&&(delete this._map[$e.key],$e.key=null,$e.clear(),!0)},$d.clearAll=function($c){if($c)for(var $d=0,$e=this._handlers.length;$d<$e;$d++){var $f=this._handlers[$d];$f.caller===$c&&(this._isIgnoreRecover($f)||(delete this._map[$f.key],$f.key=null,$f.clear()))}},$d._getHandler=function($c,$d){var $e=$c?$c.$_GID||($c.$_GID=$$.getGID()):0,$f=$d.$_TID||($d.$_TID=this._mid++);return this._map[$e+"_"+$f]},$d._isIgnoreRecover=function($c){if($c.ignoreRecover||$c.caller&&"IgnoreRecover"==$c.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var $d="";try{arguments.propertyIsEnumerable.caller}catch($c){$d=$c.stack}$z.recordError("报错：核心定时器销毁忽略  "+$d)}return!0}return!1},$d.hasHandler=function($c,$d){return this._map[$c.$_GID+"_"+$d.$_TID]},$d.callLater=function($c,$d,$e){if(null==this._getHandler($c,$d)){var $f=$l.create();$f.caller=$c,$f.method=$d,$f.args=$e,this._indexHandler($f),this._laters.push($f)}},$d.runCallLater=function($c,$d){var $e=this._getHandler($c,$d);$e&&null!=$e.method&&(this._isIgnoreRecover($e)||(delete this._map[$e.key],$e.run(!0)))},$d.runTimer=function($c,$d){this.runCallLater($c,$d)},$m(0,$d,"delta",function(){return this._delta}),$c.__init$=function(){$l=function(){function $d(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}$r($d,"");var $c=$d.prototype;return $c.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},$c.recover=function(){this.clear(),this.args=$d._freeHandler,$d._freeHandler=this,$d._freeCount++},$c.run=function($c){var $d=this.caller;if($d&&$d.destroyed)return this.clear();var $e=this.method,$f=this.args;$c&&this.clear(),null!=$e&&($f?$e.apply($d,$f):$e.call($d))},$d._freeHandler=null,$d._freeCount=0,$d.create=function(){var $c=$d._freeHandler;return $c?($d._freeHandler=$c.args,--$d._freeCount,$c.args=null,$c):new $d},$d}()},$c}()),$Z=function(){function $n(){this.gid=0}$r($n,"laya.utils.Tween");var $c=$n.prototype;return $c.to=function($c,$d,$e,$f,$g,$h,$i){return void 0===$h&&($h=0),void 0===$i&&($i=!1),this._create($c,$d,$e,$f,$g,$h,$i,!0,!1,!0)},$c.from=function($c,$d,$e,$f,$g,$h,$i){return void 0===$h&&($h=0),void 0===$i&&($i=!1),this._create($c,$d,$e,$f,$g,$h,$i,!1,!1,!0)},$c._create=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){if(!$c)throw new Error("Tween:target is null");this._target=$c,this._duration=$e,this._ease=$f||$d.ease||$n.easeNone,this._complete=$g||$d.complete,this._delay=$h,this._props=[],this._usedTimer=0,this._startTimer=$O.now(),this._usedPool=$k,this._delayParam=null,this.update=$d.update;var $m=$c.$_GID||($c.$_GID=$$.getGID());return $n.tweenMap[$m]?($i&&$n.clearTween($c),$n.tweenMap[$m].push(this)):$n.tweenMap[$m]=[this],$l?$h<=0?this.firstStart($c,$d,$j):(this._delayParam=[$c,$d,$j],$z.scaleTimer.once($h,this,this.firstStart,this._delayParam)):this._initProps($c,$d,$j),this},$c.firstStart=function($c,$d,$e){this._delayParam=null,$c.destroyed?this.clear():(this._initProps($c,$d,$e),this._beginLoop())},$c._initProps=function($c,$d,$e){for(var $f in $d)if("number"==typeof $c[$f]){var $g=$e?$c[$f]:$d[$f],$h=$e?$d[$f]:$c[$f];this._props.push([$f,$g,$h-$g]),$e||($c[$f]=$g)}},$c._beginLoop=function(){$z.scaleTimer.frameLoop(1,this,this._doEase)},$c._doEase=function(){this._updateEase($O.now())},$c._updateEase=function($c){var $d=this._target;if($d){if($d.destroyed)return $n.clearTween($d);var $e=this._usedTimer=$c-this._startTimer-this._delay;if(!($e<0)){if($e>=this._duration)return this.complete();for(var $f=0<$e?this._ease($e,0,1,this._duration):0,$g=this._props,$h=0,$i=$g.length;$h<$i;$h++){var $j=$g[$h];$d[$j[0]]=$j[1]+$f*$j[2]}this.update&&this.update.run()}}},$c.complete=function(){if(this._target){$z.scaleTimer.runTimer(this,this.firstStart);for(var $c=this._target,$d=this._props,$e=this._complete,$f=0,$g=$d.length;$f<$g;$f++){var $h=$d[$f];$c[$h[0]]=$h[1]+$h[2]}this.update&&this.update.run(),this.clear(),$e&&$e.run()}},$c.pause=function(){$z.scaleTimer.clear(this,this._beginLoop),$z.scaleTimer.clear(this,this._doEase),$z.scaleTimer.clear(this,this.firstStart);var $c;($c=$O.now()-this._startTimer-this._delay)<0&&(this._usedTimer=$c)},$c.setStartTime=function($c){this._startTimer=$c},$c.clear=function(){this._target&&(this._remove(),this._clear())},$c._clear=function(){this.pause(),$z.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,$W.recover("tween",this))},$c.recover=function(){this._usedPool=!0,this._clear()},$c._remove=function(){var $c=$n.tweenMap[this._target.$_GID];if($c)for(var $d=0,$e=$c.length;$d<$e;$d++)if($c[$d]===this){$c.splice($d,1);break}},$c.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=$O.now(),this._delayParam)$z.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var $c=this._props,$d=0,$e=$c.length;$d<$e;$d++){var $f=$c[$d];this._target[$f[0]]=$f[1]}$z.scaleTimer.once(this._delay,this,this._beginLoop)}},$c.resume=function(){this._usedTimer>=this._duration||(this._startTimer=$O.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?$z.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},$m(0,$c,"progress",null,function($c){var $d=$c*this._duration;this._startTimer=$O.now()-this._delay-$d}),$n.to=function($c,$d,$e,$f,$g,$h,$i,$j){return void 0===$h&&($h=0),void 0===$i&&($i=!1),void 0===$j&&($j=!0),$W.getItemByClass("tween",$n)._create($c,$d,$e,$f,$g,$h,$i,!0,$j,!0)},$n.from=function($c,$d,$e,$f,$g,$h,$i,$j){return void 0===$h&&($h=0),void 0===$i&&($i=!1),void 0===$j&&($j=!0),$W.getItemByClass("tween",$n)._create($c,$d,$e,$f,$g,$h,$i,!1,$j,!0)},$n.clearAll=function($c){if($c&&$c.$_GID){var $d=$n.tweenMap[$c.$_GID];if($d){for(var $e=0,$f=$d.length;$e<$f;$e++)$d[$e]._clear();$d.length=0}}},$n.clear=function($c){$c.clear()},$n.clearTween=function($c){$n.clearAll($c)},$n.easeNone=function($c,$d,$e,$f){return $e*$c/$f+$d},$n.tweenMap={},$n}(),$$=function(){function $j(){}return $r($j,"laya.utils.Utils"),$j.toRadian=function($c){return $c*$j._pi2},$j.toAngle=function($c){return $c*$j._pi},$j.toHexColor=function($c){if($c<0||isNaN($c))return null;for(var $d=$c.toString(16);$d.length<6;)$d="0"+$d;return"#"+$d},$j.getGID=function(){return $j._gid++},$j.concatArray=function($c,$d){if(!$d)return $c;if(!$c)return $d;var $e=0,$f=$d.length;for($e=0;$e<$f;$e++)$c.push($d[$e]);return $c},$j.clearArray=function($c){return $c&&($c.length=0),$c},$j.copyArray=function($c,$d){if($c||($c=[]),!$d)return $c;$c.length=$d.length;var $e=0,$f=$d.length;for($e=0;$e<$f;$e++)$c[$e]=$d[$e];return $c},$j.getGlobalRecByPoints=function($c,$d,$e,$f,$g){var $h,$i;return $h=new $A($d,$e),$h=$c.localToGlobal($h),$i=new $A($f,$g),$i=$c.localToGlobal($i),$B._getWrapRec([$h.x,$h.y,$i.x,$i.y])},$j.getGlobalPosAndScale=function($c){return $j.getGlobalRecByPoints($c,0,0,1,1)},$j.bind=function($c,$d){return $c.bind($d)},$j.measureText=function($c,$d){return $F.measureText($c,$d)},$j.updateOrder=function($c){if(!$c||$c.length<2)return!1;for(var $d,$e=1,$f=0,$g=$c.length,$h=NaN;$e<$g;){for($d=$c[$f=$e],$h=$c[$f]._zOrder;-1<--$f&&$c[$f]._zOrder>$h;)$c[$f+1]=$c[$f];$c[$f+1]=$d,$e++}var $i=$d.parent.conchModel;if($i)if(null!=$i.updateZOrder)$i.updateZOrder();else{for($e=0;$e<$g;$e++)$i.removeChild($c[$e].conchModel);for($e=0;$e<$g;$e++)$i.addChildAt($c[$e].conchModel,$e)}return!0},$j.transPointList=function($c,$d,$e){var $f=0,$g=$c.length;for($f=0;$f<$g;$f+=2)$c[$f]+=$d,$c[$f+1]+=$e},$j.parseInt=function($c,$d){void 0===$d&&($d=0);var $e=$O.window.parseInt($c,$d);return isNaN($e)?0:$e},$j.getFileExtension=function($c){$j._extReg.lastIndex=$c.lastIndexOf(".");var $d=$j._extReg.exec($c);return $d&&1<$d.length?$d[1].toLowerCase():null},$j.getTransformRelativeToWindow=function($c,$d,$e){var $f=$z.stage,$g=laya.utils.Utils.getGlobalPosAndScale($c),$h=$f._canvasTransform.clone(),$i=$h.tx,$j=$h.ty;$h.rotate(-Math.PI/180*$z.stage.canvasDegree),$h.scale($z.stage.clientScaleX,$z.stage.clientScaleY);var $k=$z.stage.canvasDegree%180!=0,$l=NaN,$m=NaN;$k?($l=$e+$g.y,$m=$d+$g.x,$l*=$h.d,$m*=$h.a,90==$z.stage.canvasDegree?($l=$i-$l,$m+=$j):($l+=$i,$m=$j-$m)):($l=$d+$g.x,$m=$e+$g.y,$l*=$h.a,$m*=$h.d,$l+=$i,$m+=$j);var $n=NaN,$o=NaN;return $o=$k?($n=$h.d*$g.height,$h.a*$g.width):($n=$h.a*$g.width,$h.d*$g.height),{x:$l,y:$m,scaleX:$n,scaleY:$o}},$j.fitDOMElementInArea=function($c,$d,$e,$f,$g,$h){$c._fitLayaAirInitialized||($c._fitLayaAirInitialized=!0,$c.style.transformOrigin=$c.style.webKittransformOrigin="left top",$c.style.position="absolute");var $i=$j.getTransformRelativeToWindow($d,$e,$f);$c.style.transform=$c.style.webkitTransform="scale("+$i.scaleX+","+$i.scaleY+") rotate("+$z.stage.canvasDegree+"deg)",$c.style.width=$g+"px",$c.style.height=$h+"px",$c.style.left=$i.x+"px",$c.style.top=$i.y+"px"},$j.isOkTextureList=function($c){if(!$c)return!1;var $d,$e=0,$f=$c.length;for($e=0;$e<$f;$e++)if(!($d=$c[$e])||!$d.source)return!1;return!0},$j.isOKCmdList=function($c){if(!$c)return!1;var $d,$e,$f=0,$g=$c.length,$h=$J._context;for($f=0;$f<$g;$f++)switch(($d=$c[$f]).callee){case $h._drawTexture:case $h._fillTexture:case $h._drawTextureWithTransform:if(!($e=$d[0])||!$e.source)return!1}return!0},$j._gid=1,$j._pi=180/Math.PI,$j._pi2=Math.PI/180,$j._extReg=/\.(\w+)\??/g,$j.parseXMLFromString=function($c){var $d;if($c=$c.replace(/>\s+</g,"><"),-1<($d=(new DOMParser).parseFromString($c,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error($d.firstChild.firstChild.textContent);return $d},$j}(),$_=function(){function $c(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],$J.isWebGL&&$Q.regCacheByFunction($$.bind(this.startDispose,this),$$.bind(this.getCacheList,this))}$r($c,"laya.utils.VectorGraphManager");var $d=$c.prototype;return $d.getId=function(){return this._id++},$d.addShape=function($c,$d){this.shapeDic[$c]=$d,this.useDic[$c]||(this.useDic[$c]=!0)},$d.addLine=function($c,$d){this.shapeLineDic[$c]=$d,this.shapeLineDic[$c]||(this.shapeLineDic[$c]=!0)},$d.getShape=function($c){this._checkKey&&null!=this.useDic[$c]&&(this.useDic[$c]=!0)},$d.deleteShape=function($c){this.shapeDic[$c]&&(this.shapeDic[$c]=null,delete this.shapeDic[$c]),this.shapeLineDic[$c]&&(this.shapeLineDic[$c]=null,delete this.shapeLineDic[$c]),null!=this.useDic[$c]&&delete this.useDic[$c]},$d.getCacheList=function(){var $c,$d=[];for($c in this.shapeDic)$d.push(this.shapeDic[$c]);for($c in this.shapeLineDic)$d.push(this.shapeLineDic[$c]);return $d},$d.startDispose=function($c){var $d;for($d in this.useDic)this.useDic[$d]=!1;this._checkKey=!0},$d.endDispose=function(){if(this._checkKey){var $c;for($c in this.useDic)this.useDic[$c]||this.deleteShape($c);this._checkKey=!1}},$c.getInstance=function(){return $c.instance=$c.instance||new $c},$c.instance=null,$c}(),$a=function(){function $f(){this._obj=null,this._obj=$f.supportWeakMap?new $O.window.WeakMap:{},$f.supportWeakMap||$f._maps.push(this)}$r($f,"laya.utils.WeakObject");var $c=$f.prototype;return $c.set=function($c,$d){if(null!=$c)if($f.supportWeakMap){var $e=$c;"string"!=typeof $c&&"number"!=typeof $c||($e=$f._keys[$c])||($e=$f._keys[$c]={k:$c}),this._obj.set($e,$d)}else"string"==typeof $c||"number"==typeof $c?this._obj[$c]=$d:($c.$_GID||($c.$_GID=$$.getGID()),this._obj[$c.$_GID]=$d)},$c.get=function($c){if(null==$c)return null;if($f.supportWeakMap){var $d="string"==typeof $c||"number"==typeof $c?$f._keys[$c]:$c;return $d?this._obj.get($d):null}return"string"==typeof $c||"number"==typeof $c?this._obj[$c]:this._obj[$c.$_GID]},$c.del=function($c){if(null!=$c)if($f.supportWeakMap){var $d="string"==typeof $c||"number"==typeof $c?$f._keys[$c]:$c;if(!$d)return;this._obj.delete($d)}else"string"==typeof $c||"number"==typeof $c?delete this._obj[$c]:delete this._obj[this._obj.$_GID]},$c.has=function($c){if(null==$c)return!1;if($f.supportWeakMap){var $d="string"==typeof $c||"number"==typeof $c?$f._keys[$c]:$c;return this._obj.has($d)}return"string"==typeof $c||"number"==typeof $c?null!=this._obj[$c]:null!=this._obj[this._obj.$_GID]},$f.__init__=function(){($f.supportWeakMap=null!=$O.window.WeakMap)||$z.timer.loop($f.delInterval,null,$f.clearCache)},$f.clearCache=function(){for(var $c=0,$d=$f._maps.length;$c<$d;$c++){$f._maps[$c]._obj={}}},$f.supportWeakMap=!1,$f.delInterval=3e5,$f._keys={},$f._maps=[],$k($f,["I",function(){return this.I=new $f}]),$f}(),$b=function(){function $c(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}$r($c,"laya.utils.WordText");var $d=$c.prototype;return $d.setText=function($c){this.changed=!0,this._text=$c},$d.toString=function(){return this._text},$d.charCodeAt=function($c){return this._text?this._text.charCodeAt($c):NaN},$d.charAt=function($c){return this._text?this._text.charAt($c):null},$m(0,$d,"length",function(){return this._text?this._text.length:0}),$c}(),$cc=function($c){function $i(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,$i.__super.call(this),this._childs=$i.ARRAY_EMPTY,this._$P=$i.PROP_EMPTY,this.timer=$z.scaleTimer,this.conchModel=$J.isConchNode?this.createConchModel():null}$r($i,"laya.display.Node",$l);var $d=$i.prototype;return $d._setBit=function($c,$d){1==$c&&(this._getBit($c)!=$d&&this._updateDisplayedInstage());$d?this._bits|=$c:this._bits&=~$c},$d._getBit=function($c){return 0!=(this._bits&$c)},$d._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},$d._setUpNoticeType=function($c){var $d=this;for($d._setBit($c,!0),$d=$d.parent;$d;){if($d._getBit($c))return;$d._setBit($c,!0),$d=$d.parent}},$d.on=function($c,$d,$e,$f){return"display"!==$c&&"undisplay"!==$c||this._getBit(1)||this._setUpNoticeType(1),this._createListener($c,$d,$e,$f,!1)},$d.once=function($c,$d,$e,$f){return"display"!==$c&&"undisplay"!==$c||this._getBit(1)||this._setUpNoticeType(1),this._createListener($c,$d,$e,$f,!0)},$d.createConchModel=function(){return null},$d.destroy=function($c){void 0===$c&&($c=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&($c?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},$d.destroyChildren=function(){if(this._childs)for(var $c=this._childs.length-1;-1<$c;$c--)this._childs[$c].destroy(!0)},$d.addChild=function($c){if(!$c||this.destroyed||$c===this)return $c;if($c.zOrder&&this._set$P("hasZorder",!0),$c._parent===this){var $d=this.getChildIndex($c);$d!==this._childs.length-1&&(this._childs.splice($d,1),this._childs.push($c),this.conchModel&&(this.conchModel.removeChild($c.conchModel),this.conchModel.addChildAt($c.conchModel,this._childs.length-1)),this._childChanged())}else $c.parent&&$c.parent.removeChild($c),this._childs===$i.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($c),this.conchModel&&this.conchModel.addChildAt($c.conchModel,this._childs.length-1),($c.parent=this)._childChanged();return $c},$d.addChildren=function($c){for(var $d=arguments,$e=0,$f=$d.length;$e<$f;)this.addChild($d[$e++])},$d.addChildAt=function($c,$d){if(!$c||this.destroyed||$c===this)return $c;if($c.zOrder&&this._set$P("hasZorder",!0),0<=$d&&$d<=this._childs.length){if($c._parent===this){var $e=this.getChildIndex($c);this._childs.splice($e,1),this._childs.splice($d,0,$c),this.conchModel&&(this.conchModel.removeChild($c.conchModel),this.conchModel.addChildAt($c.conchModel,$d)),this._childChanged()}else $c.parent&&$c.parent.removeChild($c),this._childs===$i.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($d,0,$c),this.conchModel&&this.conchModel.addChildAt($c.conchModel,$d),$c.parent=this;return $c}throw new Error("appendChildAt:The index is out of bounds")},$d.getChildIndex=function($c){return this._childs.indexOf($c)},$d.getChildByName=function($c){var $d=this._childs;if($d)for(var $e=0,$f=$d.length;$e<$f;$e++){var $g=$d[$e];if($g.name===$c)return $g}return null},$d._get$P=function($c){return this._$P[$c]},$d._set$P=function($c,$d){return this.destroyed||(this._$P===$i.PROP_EMPTY&&(this._$P={}),this._$P[$c]=$d),$d},$d.getChildAt=function($c){return this._childs[$c]},$d.setChildIndex=function($c,$d){var $e=this._childs;if($d<0||$d>=$e.length)throw new Error("setChildIndex:The index is out of bounds.");var $f=this.getChildIndex($c);if($f<0)throw new Error("setChildIndex:node is must child of this object.");return $e.splice($f,1),$e.splice($d,0,$c),this.conchModel&&(this.conchModel.removeChild($c.conchModel),this.conchModel.addChildAt($c.conchModel,$d)),this._childChanged(),$c},$d._childChanged=function($c){},$d.removeChild=function($c){if(!this._childs)return $c;var $d=this._childs.indexOf($c);return this.removeChildAt($d)},$d.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},$d.removeChildByName=function($c){var $d=this.getChildByName($c);return $d&&this.removeChild($d),$d},$d.removeChildAt=function($c){var $d=this.getChildAt($c);if($d){for(var $e=this._childs.length-1,$f=$c;$f<$e;++$f)this._childs[$f]=this._childs[$f+1];this._childs.length=$e,this.conchModel&&this.conchModel.removeChild($d.conchModel),$d.parent=null}return $d},$d.removeChildren=function($c,$d){if(void 0===$c&&($c=0),void 0===$d&&($d=2147483647),this._childs&&0<this._childs.length){var $e=this._childs;if(0===$c&&$h<=$d){var $f=$e;this._childs=$i.ARRAY_EMPTY}else $f=$e.splice($c,$d-$c);for(var $g=0,$h=$f.length;$g<$h;$g++)$f[$g].parent=null,this.conchModel&&this.conchModel.removeChild($f[$g].conchModel)}return this},$d.replaceChild=function($c,$d){var $e=this._childs.indexOf($d);return-1<$e?(this._childs.splice($e,1,$c),this.conchModel&&(this.conchModel.removeChild($d.conchModel),this.conchModel.addChildAt($c.conchModel,$e)),$d.parent=null,$c.parent=this,$c):null},$d._updateDisplayedInstage=function(){var $c;$c=this;var $d=$z.stage;for(this._displayedInStage=!1;$c;){if($c._getBit(1)){this._displayedInStage=$c._displayedInStage;break}if($c==$d||$c._displayedInStage){this._displayedInStage=!0;break}$c=$c.parent}},$d._setDisplay=function($c){this._displayedInStage!==$c&&((this._displayedInStage=$c)?this.event("display"):this.event("undisplay"))},$d._displayChild=function($c,$d){var $e=$c._childs;if($e)for(var $f=0;$f<$e.length;$f++){var $g=$e[$f];$g&&$g._getBit(1)&&(0<$g._childs.length?this._displayChild($g,$d):$g._setDisplay($d))}$c._setDisplay($d)},$d.contains=function($c){if($c===this)return!0;for(;$c;){if($c.parent===this)return!0;$c=$c.parent}return!1},$d.timerLoop=function($c,$d,$e,$f,$g,$h){void 0===$g&&($g=!0),void 0===$h&&($h=!1),this.timer.loop($c,$d,$e,$f,$g,$h)},$d.timerOnce=function($c,$d,$e,$f,$g){void 0===$g&&($g=!0),this.timer._create(!1,!1,$c,$d,$e,$f,$g)},$d.frameLoop=function($c,$d,$e,$f,$g){void 0===$g&&($g=!0),this.timer._create(!0,!0,$c,$d,$e,$f,$g)},$d.frameOnce=function($c,$d,$e,$f,$g){void 0===$g&&($g=!0),this.timer._create(!0,!1,$c,$d,$e,$f,$g)},$d.clearTimer=function($c,$d){this.timer.clear($c,$d)},$m(0,$d,"numChildren",function(){return this._childs.length}),$m(0,$d,"destroyed",function(){return this._destroyed}),$m(0,$d,"parent",function(){return this._parent},function($c){this._parent!==$c&&($c?(this._parent=$c,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),$c.displayedInStage&&this._displayChild(this,!0)),$c._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=$c))}),$m(0,$d,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),$i.ARRAY_EMPTY=[],$i.PROP_EMPTY={},$i.NOTICE_DISPLAY=1,$i.MOUSEENABLE=2,$i}(),$dc=function($c){function $o($c){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,$o.__super.call(this),this._padding=$o._PADDING,this._spacing=$o._SPACING,this._aligns=$o._ALIGNS,this._font=$p.EMPTY,this._ower=$c}$r($o,"laya.display.css.CSSStyle",$c);var $d=$o.prototype;return $d.destroy=function(){this._ower=null,this._font=null,this._rect=null},$d.inherit=function($c){this._font=$c._font,this._spacing=$c._spacing===$o._SPACING?$o._SPACING:$c._spacing.slice(),this.lineHeight=$c.lineHeight},$d._widthAuto=function(){return 0!=(262144&this._type)},$d.widthed=function($c){return 0!=(8&this._type)},$d._calculation=function($c,$d){if($d.indexOf("%")<0)return!1;var $f=this._ower,$g=$f.parent,$h=this._rect;function $i($c,$d,$e){return $c*$e[0]+$d*$e[1]+$e[2]}function $e($c){var $d=$g.width,$e=$f.width;$h.width&&($f.width=$i($d,$e,$h.width)),$h.height&&($f.height=$i($d,$e,$h.height)),$h.left&&($f.x=$i($d,$e,$h.left)),$h.top&&($f.y=$i($d,$e,$h.top))}null===$h&&($g._getCSSStyle()._type|=524288,$g.on("resize",this,$e),this._rect=$h={input:{}});var $j=$d.split(" ");return $j[0]=parseFloat($j[0])/100,1==$j.length?$j[1]=$j[2]=0:($j[1]=parseFloat($j[1])/100,$j[2]=parseFloat($j[2])),$h[$c]=$j,$h.input[$c]=$d,$e(),!0},$d.heighted=function($c){return 0!=(8192&this._type)},$d.size=function($c,$d){var $e=this._ower,$f=!1;-1!==$c&&$c!=this._ower.width&&(this._type|=8,this._ower.width=$c,$f=!0),-1!==$d&&$d!=this._ower.height&&(this._type|=8192,this._ower.height=$d,$f=!0),$f&&($e._layoutLater(),524288&this._type&&$e.event("resize",this))},$d._getAlign=function(){return this._aligns[0]},$d._getValign=function(){return this._aligns[1]},$d._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},$d._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new $p(this._font))},$d.render=function($c,$d,$e,$f){var $g=$c.width,$h=$c.height;$e-=$c.pivotX,$f-=$c.pivotY,this._bgground&&null!=this._bgground.color&&$d.ctx.fillRect($e,$f,$g,$h,this._bgground.color),this._border&&this._border.color&&$d.drawRect($e,$f,$g,$h,this._border.color.strColor,this._border.size)},$d.getCSSStyle=function(){return this},$d.cssText=function($c){this.attrs($o.parseOneCSS($c,";"))},$d.attrs=function($c){if($c)for(var $d=0,$e=$c.length;$d<$e;$d++){var $f=$c[$d];this[$f[0]]=$f[1]}},$d.setTransform=function($c){"none"===$c?this._tf=$j._TF_EMPTY:this.attrs($o.parseOneCSS($c,","))},$d.translate=function($c,$d){this._tf===$j._TF_EMPTY&&(this._tf=new $g),this._tf.translateX=$c,this._tf.translateY=$d},$d.scale=function($c,$d){this._tf===$j._TF_EMPTY&&(this._tf=new $g),this._tf.scaleX=$c,this._tf.scaleY=$d},$d._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},$m(0,$d,"block",$c.prototype._$get_block,function($c){$c?this._type|=1:this._type&=-2}),$m(0,$d,"valign",function(){return $o._valigndef[this._aligns[1]]},function($c){this._aligns===$o._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=$o._valigndef[$c]}),$m(0,$d,"height",null,function($c){if(this._type|=8192,"string"==typeof $c){if(this._calculation("height",$c))return;$c=parseInt($c)}this.size(-1,$c)}),$m(0,$d,"width",null,function($c){if(this._type|=8,"string"==typeof $c){var $d=$c.indexOf("auto");if(0<=$d&&(this._type|=262144,$c=$c.substr(0,$d)),this._calculation("width",$c))return;$c=parseInt($c)}this.size($c,-1)}),$m(0,$d,"fontWeight",function(){return this._font.weight},function($c){this._createFont().weight=$c}),$m(0,$d,"left",null,function($c){var $d=this._ower;if("string"==typeof $c){if("center"===$c?$c="50% -50% 0":"right"===$c&&($c="100% -100% 0"),this._calculation("left",$c))return;$c=parseInt($c)}$d.x=$c}),$m(0,$d,"_translate",null,function($c){this.translate($c[0],$c[1])}),$m(0,$d,"absolute",function(){return 0!=(4&this._type)}),$m(0,$d,"top",null,function($c){var $d=this._ower;if("string"==typeof $c){if("middle"===$c?$c="50% -50% 0":"bottom"===$c&&($c="100% -100% 0"),this._calculation("top",$c))return;$c=parseInt($c)}$d.y=$c}),$m(0,$d,"align",function(){return $o._aligndef[this._aligns[0]]},function($c){this._aligns===$o._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=$o._aligndef[$c]}),$m(0,$d,"bold",function(){return this._font.bold},function($c){this._createFont().bold=$c}),$m(0,$d,"padding",function(){return this._padding},function($c){this._padding=$c}),$m(0,$d,"leading",function(){return this._spacing[1]},function($c){"string"==typeof $c&&($c=parseInt($c+"")),this._spacing===$o._SPACING&&(this._spacing=[0,0]),this._spacing[1]=$c}),$m(0,$d,"lineElement",function(){return 0!=(65536&this._type)},function($c){$c?this._type|=65536:this._type&=-65537}),$m(0,$d,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function($c){this.lineElement=!1,"right"===$c?this._type|=32768:this._type&=-32769}),$m(0,$d,"textDecoration",function(){return this._font.decoration},function($c){this._createFont().decoration=$c}),$m(0,$d,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function($c){"nowrap"===$c&&(this._type|=131072),"none"===$c&&(this._type&=-131073)}),$m(0,$d,"background",null,function($c){$c?(this._bgground||(this._bgground={}),this._bgground.color=$c,this._ower.conchModel&&this._ower.conchModel.bgColor($c),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),$m(0,$d,"wordWrap",function(){return 0==(131072&this._type)},function($c){$c?this._type&=-131073:this._type|=131072}),$m(0,$d,"color",function(){return this._font.color},function($c){this._createFont().color=$c}),$m(0,$d,"password",function(){return this._font.password},function($c){this._createFont().password=$c}),$m(0,$d,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function($c){"none"===$c?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=$c),this._ower.conchModel&&this._ower.conchModel.bgColor($c),this._ower._renderType|=256}),$m(0,$d,"font",function(){return this._font.toString()},function($c){this._createFont().set($c)}),$m(0,$d,"weight",null,function($c){this._createFont().weight=$c}),$m(0,$d,"letterSpacing",function(){return this._spacing[0]},function($c){"string"==typeof $c&&($c=parseInt($c+"")),this._spacing===$o._SPACING&&(this._spacing=[0,0]),this._spacing[0]=$c}),$m(0,$d,"fontSize",function(){return this._font.size},function($c){this._createFont().size=$c}),$m(0,$d,"italic",function(){return this._font.italic},function($c){this._createFont().italic=$c}),$m(0,$d,"fontFamily",function(){return this._font.family},function($c){this._createFont().family=$c}),$m(0,$d,"stroke",function(){return this._font.stroke[0]},function($c){this._createFont().stroke===$p._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=$c}),$m(0,$d,"strokeColor",function(){return this._font.stroke[1]},function($c){this._createFont().stroke===$p._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=$c}),$m(0,$d,"border",function(){return this._border?this._border.value:""},function($c){if("none"!=$c){this._border||(this._border={});var $d=(this._border.value=$c).split(" ");if(this._border.color=$S.create($d[$d.length-1]),1==$d.length)return this._border.size=1,void(this._border.type="solid");var $e=0;0<$d[0].indexOf("px")?(this._border.size=parseInt($d[0]),$e++):this._border.size=1,this._border.type=$d[$e],this._ower._renderType|=256}else this._border=null}),$m(0,$d,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function($c){$c?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==$c?null:$S.create($c),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),$m(0,$d,"position",function(){return 4&this._type?"absolute":""},function($c){"absolute"==$c?this._type|=4:this._type&=-5}),$m(0,$d,"display",null,function($c){switch($c){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),$m(0,$d,"paddingLeft",function(){return this.padding[3]}),$m(0,$d,"paddingTop",function(){return this.padding[0]}),$m(0,$d,"_scale",null,function($c){this._ower.scale($c[0],$c[1])}),$m(0,$d,"_rotate",null,function($c){this._ower.rotation=$c}),$o.parseOneCSS=function($c,$d){for(var $e,$f=[],$g=$c.split($d),$h=0,$i=$g.length;$h<$i;$h++){var $j=$g[$h],$k=$j.indexOf(":"),$l=$j.substr(0,$k).replace(/^\s+|\s+$/g,"");if(0!=$l.length){var $m=$j.substr($k+1).replace(/^\s+|\s+$/g,""),$n=[$l,$m];switch($l){case"italic":case"bold":$n[1]="true"==$m;break;case"line-height":$n[0]="lineHeight",$n[1]=parseInt($m);break;case"font-size":$n[0]="fontSize",$n[1]=parseInt($m);break;case"padding":1<($e=$m.split(" ")).length||($e[1]=$e[2]=$e[3]=$e[0]),$n[1]=[parseInt($e[0]),parseInt($e[1]),parseInt($e[2]),parseInt($e[3])];break;case"rotate":$n[0]="_rotate",$n[1]=parseFloat($m);break;case"scale":$e=$m.split(" "),$n[0]="_scale",$n[1]=[parseFloat($e[0]),parseFloat($e[1])];break;case"translate":$e=$m.split(" "),$n[0]="_translate",$n[1]=[parseInt($e[0]),parseInt($e[1])];break;default:($n[0]=$o._CSSTOVALUE[$l])||($n[0]=$l)}$f.push($n)}}return $f},$o.parseCSS=function($c,$d){for(var $e;null!=($e=$o._parseCSSRegExp.exec($c));)$o.styleSheets[$e[1]]=$o.parseOneCSS($e[2],";")},$o.EMPTY=new $o(null),$o._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},$o._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),$o._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},$o._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},$o.styleSheets={},$o.ALIGN_CENTER=1,$o.ALIGN_RIGHT=2,$o.VALIGN_MIDDLE=1,$o.VALIGN_BOTTOM=2,$o._CSS_BLOCK=1,$o._DISPLAY_NONE=2,$o._ABSOLUTE=4,$o._WIDTH_SET=8,$o._PADDING=[0,0,0,0],$o._RECT=[-1,-1,-1,-1],$o._SPACING=[0,0],$o._ALIGNS=[0,0,0],$o.ADDLAYOUTED=512,$o._NEWFONT=4096,$o._HEIGHT_SET=8192,$o._BACKGROUND_SET=16384,$o._FLOAT_RIGHT=32768,$o._LINE_ELEMENT=65536,$o._NOWARP=131072,$o._WIDTHAUTO=262144,$o._LISTERRESZIE=524288,$o}($j),$ec=function($c){function $i(){this.url=null,this.audio=null,this.loaded=!1,$i.__super.call(this)}$r($i,"laya.media.h5audio.AudioSound",$l);var $d=$i.prototype;return $d.dispose=function(){var $c=$i._audioCache[this.url];$c&&($c.src="",delete $i._audioCache[this.url])},$d.load=function($c){var $d;if($c=$I.formatURL($c),(this.url=$c)==$E._tMusic?($i._initMusicAudio(),($d=$i._musicAudio).src!=$c&&($i._audioCache[$d.src]=null,$d=null)):$d=$i._audioCache[$c],$d&&2<=$d.readyState)this.event("complete");else{$d||($d=$c==$E._tMusic?($i._initMusicAudio(),$i._musicAudio):$O.createElement("audio"),($i._audioCache[$c]=$d).src=$c),$d.addEventListener("canplaythrough",$f),$d.addEventListener("error",$g);var $e=this;(this.audio=$d).load?$d.load():$g()}function $f(){$h(),$e.loaded=!0,$e.event("complete")}function $g(){$d.load=null,$h(),$e.event("error")}function $h(){$d.removeEventListener("canplaythrough",$f),$d.removeEventListener("error",$g)}},$d.play=function($c,$d,$e){if(void 0===$c&&($c=0),void 0===$d&&($d=0),!this.url)return null;var $f,$g;if(!($f=this.url==$E._tMusic?$i._musicAudio:$i._audioCache[this.url]))return null;$g=$W.getItem("audio:"+this.url),$J.isConchApp?$g||(($g=$O.createElement("audio")).src=this.url):this.url==$E._tMusic?($i._initMusicAudio(),($g=$i._musicAudio).src=this.url):$g=$g||$f.cloneNode(!0);var $h=new $oc($g);return $h.url=this.url,$h.loops=$d,$h.startTime=$c,$h.startHandler=$e,$h.play(!1),$E.addChannel($h),$h},$m(0,$d,"duration",function(){var $c;return($c=$i._audioCache[this.url])?$c.duration:0}),$i._initMusicAudio=function(){$i._musicAudio||($i._musicAudio||($i._musicAudio=$O.createElement("audio")),$J.isConchApp||$O.document.addEventListener("mousedown",$i._makeMusicOK))},$i._makeMusicOK=function(){$O.document.removeEventListener("mousedown",$i._makeMusicOK),$i._musicAudio.src?$i._musicAudio.play():($i._musicAudio.src="",$i._musicAudio.load())},$i._audioCache={},$i._musicAudio=null,$i}(),$fc=function($c){function $d(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,$d.__super.call(this)}$r($d,"laya.media.SoundChannel",$l);var $e=$d.prototype;return $e.play=function(){},$e.stop=function(){},$e.pause=function(){},$e.resume=function(){},$e.__runComplete=function($c){$c&&$c.run()},$m(0,$e,"volume",function(){return 1},function($c){}),$m(0,$e,"position",function(){return 0}),$m(0,$e,"duration",function(){return 0}),$d}(),$gc=function($c){function $d(){$d.__super.call(this)}$r($d,"laya.media.Sound",$l);var $e=$d.prototype;return $e.load=function($c){},$e.play=function($c,$d,$e){return void 0===$c&&($c=0),void 0===$d&&($d=0),null},$e.dispose=function(){},$m(0,$e,"duration",function(){return 0}),$d}(),$hc=function($c){function $g(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,$g.__super.call(this)}$r($g,"laya.media.webaudio.WebAudioSound",$l);var $d=$g.prototype;return $d.load=function($c){this.url=$c,this.audioBuffer=$g._dataCache[$c],this.audioBuffer?this._loaded(this.audioBuffer):($g.e.on("loaded:"+$c,this,this._loaded),$g.e.on("err:"+$c,this,this._err),$g.__loadingSound[$c]||($g.__loadingSound[$c]=!0,$z.loader.load($c,$u.create(this,this.onloaded),null,$jc.BUFFER,4,!1,null,!0)))},$d.onloaded=function($c){$c||this._err(),this._disposed?this._removeLoadEvents():(this.data=$c,$g.buffs.push({buffer:this.data,url:this.url}),$g.decode())},$d._err=function(){if(this._removeLoadEvents(),$g.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var $c,$d,$e,$f=0;for($c=($d=this.__toPlays).length,$f=0;$f<$c;$f++)($e=$d[$f])[3]&&!$e[3].isStopped&&$e[3].event("error");this.__toPlays.length=0}},$d._loaded=function($c){this._removeLoadEvents(),this._disposed||(this.audioBuffer=$c,this.loaded=!0,this.event("complete"))},$d._removeLoadEvents=function(){$g.e.off("loaded:"+this.url,this,this._loaded),$g.e.off("err:"+this.url,this,this._err)},$d.__playAfterLoaded=function(){if(this.__toPlays){var $c,$d,$e,$f=0;for($c=($d=this.__toPlays).length,$f=0;$f<$c;$f++)($e=$d[$f])[3]&&!$e[3].isStopped&&this.play($e[0],$e[1],$e[2],$e[3]);this.__toPlays.length=0}},$d.play=function($c,$d,$e,$f){return void 0===$c&&($c=0),void 0===$d&&($d=0),$f=$f||new $pc,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([$c,$d,$e,$f]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),$f.url=this.url,$f.loops=$d,$f.audioBuffer=this.audioBuffer,$f.startTime=$c,$f.startHandler=$e,$f.play(!1),$E.addChannel($f),$f},$d.dispose=function(){this._disposed=!0,delete $g._dataCache[this.url],delete $g.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},$m(0,$d,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$g.decode=function(){if(!($g.buffs.length<=0||$g.isDecoding))if($g.isDecoding=!0,($g.tInfo=$g.buffs.shift())&&$g.tInfo.buffer&&$g.tInfo.buffer.byteLength)try{$g.ctx.decodeAudioData($g.tInfo.buffer,$g._done,$g._fail)}catch($c){console.error("decodeAudioData error  byteLength:"+$g.tInfo.buffer.byteLength+"  url:"+$g.tInfo.url)}else $g._fail()},$g._done=function($c){$g.e.event("loaded:"+$g.tInfo.url,$c),$g._dataCache[$g.tInfo.url]=$c,$g.isDecoding=!1,$g.decode()},$g._fail=function(){$g.e.event("err:"+$g.tInfo.url,null),$g.isDecoding=!1,$g.decode()},$g._playEmptySound=function(){if(null!=$g.ctx){if($g._emptySource&&($g._emptySource.stop(),$g._emptySource.disconnect(0),!$pc._tryCleanFailed))try{$g._emptySource.buffer=null}catch($c){$pc._tryCleanFailed=!0}var $c=$g.ctx.createBufferSource();$c.buffer=$g._miniBuffer,$c.connect($g.ctx.destination),$c.start(0,0,0),$g._emptySource=$c}},$g._unlock=function(){$g._unlocked||($g._playEmptySound(),"running"==$g.ctx.state?($O.document.removeEventListener("mousedown",$g._unlock,!0),$O.document.removeEventListener("touchend",$g._unlock,!0),$O.document.removeEventListener("touchstart",$g._unlock,!0),$g._unlocked=!0):"suspended"==$g.ctx.state&&$E._recoverWebAudio())},$g.initWebAudio=function(){"running"!=$g.ctx.state&&($g._unlock(),$O.document.addEventListener("mousedown",$g._unlock,!0),$O.document.addEventListener("touchend",$g._unlock,!0),$O.document.addEventListener("touchstart",$g._unlock,!0))},$g._emptySource=null,$g._dataCache={},$g.buffs=[],$g.isDecoding=!1,$g._unlocked=!1,$g.tInfo=null,$g.__loadingSound={},$k($g,["window",function(){return this.window=$O.window},"webAudioEnabled",function(){return this.webAudioEnabled=$g.window.AudioContext||$g.window.webkitAudioContext||$g.window.mozAudioContext},"ctx",function(){return this.ctx=$g.webAudioEnabled?new($g.window.AudioContext||$g.window.webkitAudioContext||$g.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=$g.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new $l}]),$g}(),$ic=function($c){function $d(){this._responseType=null,this._data=null,$d.__super.call(this),this._http=new $O.window.XMLHttpRequest}$r($d,"laya.net.HttpRequest",$l);var $e=$d.prototype;return $e.send=function($c,$d,$e,$f,$g){void 0===$e&&($e="get"),void 0===$f&&($f="text"),this._responseType=$f,this._data=null;var $h=this,$i=this._http;if($i.open($e,$c,!0),$g)for(var $j=0;$j<$g.length;$j++)$i.setRequestHeader($g[$j++],$g[$j]);else $J.isConchApp||($d&&"string"!=typeof $d?$i.setRequestHeader("Content-Type","application/json"):$i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));$i.responseType="arraybuffer"!==$f?"text":"arraybuffer",$i.onerror=function($c){$h._onError($c)},$i.onabort=function($c){$h._onAbort($c)},$i.onprogress=function($c){$h._onProgress($c)},$i.onload=function($c){$h._onLoad($c)},$i.send($d)},$e._onProgress=function($c){$c&&$c.lengthComputable&&this.event("progress",$c.loaded/$c.total)},$e._onAbort=function($c){this.error("Request was aborted by user")},$e._onError=function($c){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},$e._onLoad=function($c){var $d=this._http,$e=void 0!==$d.status?$d.status:200;200===$e||204===$e||0===$e?this.complete():this.error("["+$d.status+"]"+$d.statusText+":"+$d.responseURL)},$e.error=function($c){this.clear(),this.event("error",$c)},$e.complete=function(){this.clear();var $d=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=$$.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch($c){$d=!1,this.error($c.message)}$d&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},$e.clear=function(){var $c=this._http;$c.onerror=$c.onabort=$c.onprogress=$c.onload=null},$m(0,$e,"url",function(){return this._http.responseURL}),$m(0,$e,"http",function(){return this._http}),$m(0,$e,"data",function(){return this._data}),$d}(),$jc=function($c){function $C(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,$C.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}$r($C,"laya.net.Loader",$l);var $d=$C.prototype;return $d.load=function($c,$d,$e,$f,$g){if($c&&""!=$c||console.error("Loader 加载的url不合法 "+$c),void 0===$e&&($e=!0),void 0===$g&&($g=!1),0===(this._url=$c).indexOf("data:image")?this._type=$d="image":this._type=$d||($d=this.getTypeFromUrl($c)),this._cache=$e,this._data=null,!$g&&$C.loadedMap[$c])return this._data=$C.loadedMap[$c],this.event("progress",1),void this.event("complete",this._data);if($f&&$C.setGroup($c,$f),null!=$C.parserMap[$d])return this._customParse=!0,void($C.parserMap[$d]instanceof laya.utils.Handler?$C.parserMap[$d].runWith(this):$C.parserMap[$d].call(null,this));if("image"===$d||"htmlimage"===$d||"nativeimage"===$d)return this._loadImage($c);if("ttf"===$d)return this._loadTTF($c);switch($d){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:$d}$C.preLoadedMap[$c]?this.onLoaded($C.preLoadedMap[$c]):$i.resMgrLoad($c,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},$d.getTypeFromUrl=function($c){var $d=$$.getFileExtension($c);return $d?$C.typeMap[$d]:(console.warn("Not recognize the resources suffix",$c),"text")},$d._loadTTF=function($c){$c=$I.formatURL($c);var $d=new $H;$d.complete=$u.create(this,this.onLoaded),$d.load($c)},$d._loadImage=function($c){$i.imgMgrLoad($c,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},$d._loadImageComplete=function($c,$d,$e){if(null!=$e)if($e instanceof ArrayBuffer){var $f=new DataView($e),$g=new laya.webgl.resource.WebGLImage(new Uint8Array($e,8),$c,0,!1,$f.getUint32(0),$f.getUint32(4));this.onLoaded($g)}else if($e instanceof $mc)$C.imgMgrSet[$c]=$d,$i.imgMgrLock($c,$C.imgMgrSet[$c]),this._url=$c,this.complete($e);else{var $h=-1!=$c.indexOf(".png",$c.length-4)?6408:6407;$g=new laya.webgl.resource.WebGLImage($e,$c,$h,!1,$e.width,$e.height);this.onLoaded($g)}else this.event("error","Load image failed")},$d._loadSound=function($c){var $d=new $E._soundClass,$e=this;function $f(){$d.offAll()}$d.on("complete",this,function(){$f(),$e.onLoaded($d)}),$d.on("error",this,function(){$f(),$d.dispose(),$e.event("error","Load sound failed")}),$d.load($c)},$d.onProgress=function($c){"atlas"===this._type?this.event("progress",.3*$c):this.event("progress",$c)},$d.onError=function($c){this.event("error",$c)},$d._loadedComplete=function($c,$d,$e){if(null!=$e)switch(this._type){case"atlas":case"plf":case"json":var $f=new $P($e);this.onLoaded(JSON.parse($f.readUTFBytes()));break;case"font":$f=new $P($e);this.onLoaded($$.parseXMLFromString($f.readUTFBytes()));break;default:this.onLoaded($e)}else this.event("error",$c)},$d.onLoaded=function($c){var $d=this._type;if("plf"==$d)this.parsePLFData($c),this.complete($c);else if("image"===$d){var $e=new $mc($c);$e.url=this._url,this.complete($e)}else if("sound"===$d||"htmlimage"===$d||"nativeimage"===$d)this.complete($c);else if("atlas"===$d){if(!$c.src&&!$c._setContext){if(!this._data){if((this._data=$c).meta&&$c.meta.image)for(var $f=$c.meta.image.split(","),$g=0<=this._url.indexOf("/")?"/":"\\",$h=this._url.lastIndexOf($g),$i=0<=$h?this._url.substr(0,$h+1):"",$j=0,$k=$f.length;$j<$k;$j++)$f[$j]=$i+$f[$j];else $f=[this._url.replace(".json",".png")];$f.reverse(),$c.toLoads=$f,$c.pics=[]}return this.event("progress",.3+1/$f.length*.6),this._loadImage($f.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push($c),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var $l=this._data.frames,$m=this._url.split("?")[0],$n=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:$m.substring(0,$m.lastIndexOf("."))+"/",$o=this._data.pics,$p=$I.formatURL(this._url),$q=$C.atlasMap[$p]||($C.atlasMap[$p]=[]);$q.dir=$n;var $r=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var $s in $r=parseFloat(this._data.meta.scale),$l){var $t,$u=$l[$s],$v=$o[$u.frame.idx?$u.frame.idx:0],$w=$I.formatURL($n+$s);$v.scaleRate=$r,$t=$mc.create($v,$u.frame.x,$u.frame.y,$u.frame.w,$u.frame.h,$u.spriteSourceSize.x,$u.spriteSourceSize.y,$u.sourceSize.w,$u.sourceSize.h),$C.cacheRes($w,$t),$C.keepCache(this._url,$n+$s),$t.url=$w,$q.push($w)}else for($s in $l)$v=$o[($u=$l[$s]).frame.idx?$u.frame.idx:0],$w=$I.formatURL($n+$s),$C.cacheRes($w,$mc.create($v,$u.frame.x,$u.frame.y,$u.frame.w,$u.frame.h,$u.spriteSourceSize.x,$u.spriteSourceSize.y,$u.sourceSize.w,$u.sourceSize.h)),$C.loadedMap[$w].url=$w,$C.keepCache(this._url,$n+$s),$q.push($w);delete this._data.pics,this.complete(this._data)}else if("font"==$d){if(!$c.src)return this._data=$c,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var $x=new $D;$x.parseFont(this._data,$c);var $y=this._url.split(".fnt")[0].split("/"),$z=$y[$y.length-1];$sc.registerBitmapFont($z,$x),this._data=$x,this.complete(this._data)}else if("pkm"==$d){var $A=$yc.create($c,this._url),$B=new $mc($A);$B.url=this._url,this.complete($B)}else this.complete($c)},$d.parsePLFData=function($c){var $d,$e,$f;for($d in $c)switch($f=$c[$d],$d){case"json":case"text":for($e in $f)$C.preLoadedMap[$I.formatURL($e)]=$f[$e];break;default:for($e in $f)$C.preLoadedMap[$I.formatURL($e)]=$f[$e]}},$d.complete=function($c){this._data=$c,this._customParse?this.event("loaded",$c instanceof Array?[$c]:$c):($C._loaders.push(this),$C._isWorking||$C.checkNext())},$d.endLoad=function($c){$c&&(this._data=$c),this._cache&&$C.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},$m(0,$d,"url",function(){return this._url}),$m(0,$d,"data",function(){return this._data}),$m(0,$d,"cache",function(){return this._cache}),$m(0,$d,"type",function(){return this._type}),$C.checkNext=function(){$C._isWorking=!0;for(var $c=$O.now();$C._startIndex<$C._loaders.length;)if($O.now(),$C._loaders[$C._startIndex].endLoad(),$C._startIndex++,$O.now()-$c>$C.maxTimeOut)return console.warn("loader callback cost a long time:"+($O.now()-$c)+" url="+$C._loaders[$C._startIndex-1].url),void $z.timer.frameOnce(1,null,$C.checkNext);$C._loaders.length=0,$C._startIndex=0,$C._isWorking=!1},$C.clearRes=function($c,$d){if(null!=$c){void 0===$d&&($d=!1),$c=$I.formatURL($c);var $e=$C.getAtlas($c);if($e){for(var $f=0,$g=$e.length;$f<$g;$f++){var $h=$e[$f],$i=$C.getRes($h);delete $C.loadedMap[$h],$C.clearCache($c.substring($I.basePath.length),$h.substring($I.basePath.length)),$i&&$i.destroy($d)}$e.length=0,delete $C.atlasMap[$c],delete $C.loadedMap[$c]}else{var $j=$C.loadedMap[$c];$j&&(delete $C.loadedMap[$c],$j instanceof laya.resource.Texture&&$j.bitmap&&$j.destroy($d))}}},$C.clearTextureRes=function($c){$c=$I.formatURL($c);var $d=laya.net.Loader.getAtlas($c),$e=$d&&0<$d.length?laya.net.Loader.getRes($d[0]):laya.net.Loader.getRes($c);$e&&$e.bitmap&&($J.isConchApp&&!$J.isConchWebGL?$e.bitmap.source.releaseTexture&&$e.bitmap.source.releaseTexture():null==$e.bitmap._atlaser&&$e.bitmap.releaseResource(!0))},$C.getRes=function($c){return $C.loadedMap[$I.formatURL($c)]},$C.getAtlas=function($c){return $C.atlasMap[$I.formatURL($c)]},$C.cacheRes=function($c,$d){$c=$I.formatURL($c),null!=$C.loadedMap[$c]?console.warn("Resources already exist,is repeated loading:",$c):$C.loadedMap[$c]=$d},$C.setGroup=function($c,$d){$C.groupMap[$d]||($C.groupMap[$d]=[]),$C.groupMap[$d].push($c)},$C.clearResByGroup=function($c){if($C.groupMap[$c]){var $d=$C.groupMap[$c],$e=0,$f=$d.length;for($e=0;$e<$f;$e++)$C.clearRes($d[$e]);$d.length=0}},$C.keepCache=function($c,$d){if($c&&$d){var $e=$C.cacheSet[$d];$e?-1==$e.indexOf($c)&&$e.push($c):$C.cacheSet[$d]=[$c]}},$C.clearCache=function($c,$d){if($c&&$d){var $e=$C.cacheSet[$d];if($e){var $f=$e.indexOf($c);if(-1!==$f){var $g=$e.length-1;0==$g?(delete $C.cacheSet[$d],0<$C.imgMgrSet[$d]?$i.imgMgrFree($d,$C.imgMgrSet[$d]):$C.clearRes($d,!0)):($e[$f]=$e[$g],$e.length=$g)}}}},$C.saveObject=function($c,$d,$e){if($d&&$c){var $f=$C.objectSet[$c];$f?(console.warn("Loader.saveObject: "+$c),$f[0]=$d,$f[1]=$e):$C.objectSet[$c]=[$d,$e,[]]}},$C.findObject=function($c){if($c){var $d=$C.objectSet[$c];if($d)return $d[0]}return null},$C.keepObject=function($c,$d){if($c&&$d){var $e=$C.objectSet[$d];$e&&-1===$e[2].indexOf($c)&&$e[2].push($c)}},$C.clearObject=function($c,$d){if($c&&$d){var $e=$C.objectSet[$d];if($e){var $f=$e[2],$g=$f.indexOf($c);if(-1!==$g){var $h=$f.length-1;0==$h?(delete $C.objectSet[$d],$e[1]&&$e[1].call(null,$e[0])):($f[$g]=$f[$h],$f.length=$h)}}}},$C.TEXT="text",$C.JSON="json",$C.XML="xml",$C.BUFFER="arraybuffer",$C.IMAGE="image",$C.SOUND="sound",$C.ATLAS="atlas",$C.FONT="font",$C.TTF="ttf",$C.PLF="plf",$C.PKM="pkm",$C.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},$C.parserMap={},$C.groupMap={},$C.maxTimeOut=100,$C.loadedMap={},$C.preLoadedMap={},$C.atlasMap={},$C._loaders=[],$C._isWorking=!1,$C._startIndex=0,$C.imgCache={},$C.cacheSet={},$C.objectSet={},$C.imgMgrSet={},$C}(),$kc=function($c){var $o;function $p(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},$p.__super.call(this);for(var $c=0;$c<this._maxPriority;$c++)this._resInfos[$c]=[]}$r($p,"laya.net.LoaderManager",$l);var $d=$p.prototype;return $d.create=function($c,$e,$d,$f,$g,$h,$i,$j){if(null==$h&&($h=2),null==$i&&($i=!0),$c instanceof Array){var $k=$c,$l=$k.length,$m=0;if($d)var $n=$u.create($d.caller,$d.method,$d.args,!1);for(var $o=0;$o<$l;$o++){var $p=$k[$o];"string"==typeof $p&&($p=$k[$o]={url:$p}),$p.progress=0}for($o=0;$o<$l;$o++){$p=$k[$o];var $q=$d?$u.create(null,$t,[$p],!1):null,$r=$d||$e?$u.create(null,$s,[$p]):null;this._create($p.url,$r,$q,$p.clas||$f,$p.params||$g,null!=$p.priority&&0<=$p.priority?$p.priority:$h,$i,$p.group||$j)}function $s($c,$d){$m++,$c.progress=1,$m===$l&&$e&&$e.run()}function $t($c,$d){$c.progress=$d;for(var $e=0,$f=0;$f<$l;$f++){$e+=$k[$f].progress}var $g=$e/$l;$n.runWith($g)}return!0}return this._create($c,$e,$d,$f,$g,$h,$i,$j)},$d._create=function($d,$e,$c,$f,$g,$h,$i,$j){$d&&""!=$d||console.error("加载的url不合法 "+$d),null==$h&&($h=2),null==$i&&($i=!0);var $k=$I.formatURL($d),$l=this.getRes($k);if($l)!$l.hasOwnProperty("loaded")||$l.loaded?($c&&$c.runWith(1),$e&&$e.run()):$e&&$z.loader._createListener($d,$e.caller,$e.method,$e.args,!0,!1);else{var $m=$$.getFileExtension($d),$n=$p.createMap[$m];if(!$n)throw new Error("LoaderManager:unknown file("+$d+") extension with: "+$m+".");$f||($f=$n[0]);var $o=$n[1];if("atlas"==$m)this.load($d,$e,$c,$o,$h,$i);else{$f===$mc&&($o="htmlimage"),($l=$f?new $f:null).hasOwnProperty("_loaded")&&($l._loaded=!1),$l._setUrl($d),$j&&$l._setGroup($j),this._createLoad($l,$d,$u.create(null,function($c){$l&&!$l.destroyed&&$c&&$l.onAsynLoaded.call($l,$d,$c,$g),$e&&$e.run();$z.loader.event($d)}),$c,$o,$h,!1,$j,!0),$i&&this.cacheRes($k,$l)}}return $l},$d.load=function($c,$d,$e,$f,$g,$h,$i,$j){$c&&""!=$c||console.error("加载的url不合法 "+$c);var $k=this;if(null==$g&&($g=2),null==$h&&($h=!0),void 0===$j&&($j=!1),$c instanceof Array)return this._loadAssets($c,$d,$e,$f,$g,$h,$i);var $l=$jc.getRes($c);if(null!=$l)$z.timer.frameOnce(1,null,function(){$e&&$e.runWith(1),$d&&$d.runWith($l),$k._loaderCount||$k.event("complete")});else{var $m=$p._resMap[$c];$m?($d&&$m._createListener("complete",$d.caller,$d.method,$d.args,!1,!1),$e&&$m._createListener("progress",$e.caller,$e.method,$e.args,!1,!1)):(($m=this._infoPool.length?this._infoPool.pop():new $o).url=$c,$m.type=$f,$m.cache=$h,$m.group=$i,$m.ignoreCache=$j,$m.priority=$g,$d&&$m.on("complete",$d.caller,$d.method,$d.args),$e&&$m.on("progress",$e.caller,$e.method,$e.args),$p._resMap[$c]=$m,$g=$g<this._maxPriority?0<=$g?$g:0:this._maxPriority-1,this._resInfos[$g].push($m),this._next())}return this},$d._createLoad=function($c,$d,$e,$f,$g,$h,$i,$j,$k){var $l=this;if(null==$h&&($h=2),null==$i&&($i=!0),void 0===$k&&($k=!1),$d instanceof Array)return this._loadAssets($d,$e,$f,$g,$h,$i,$j);var $m=$jc.getRes($d);if(null!=$m)$z.timer.frameOnce(1,null,function(){$f&&$f.runWith(1),$e&&$e.runWith($m),$l._loaderCount||$l.event("complete")});else{var $n=$p._resMap[$d];$n?($e&&$n._createListener("complete",$e.caller,$e.method,$e.args,!1,!1),$f&&$n._createListener("progress",$f.caller,$f.method,$f.args,!1,!1)):(($n=this._infoPool.length?this._infoPool.pop():new $o).url=$d,$n.clas=$c,$n.type=$g,$n.cache=$i,$n.group=$j,$n.ignoreCache=$k,$n.priority=$h,$e&&$n.on("complete",$e.caller,$e.method,$e.args),$f&&$n.on("progress",$f.caller,$f.method,$f.args),$p._resMap[$d]=$n,$h=$h<this._maxPriority?0<=$h?$h:0:this._maxPriority-1,this._resInfos[$h].push($n),this._next())}return this},$d._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var $c=0;$c<this._maxPriority;$c++)for(var $d=this._resInfos[$c];0<$d.length;){var $e=$d.shift();if($e)return this._doLoad($e)}this._loaderCount||this.event("complete")}},$d._doLoad=function($d){this._loaderCount++;var $e=this._loaders.length?this._loaders.pop():new $jc;$e.on("complete",null,$g),$e.on("progress",null,function($c){$d.event("progress",$c)}),$e.on("error",null,function($c){$g(null)});var $f=this;function $g($c){$e.offAll(),$e._data=null,$e._customParse=!1,$f._loaders.push($e),$f._endLoad($d,$c instanceof Array?[$c]:$c),$f._loaderCount--,$f._next()}$e._class=$d.clas,1<=$d.priority?($e.priority=$d.priority,$e.realTime=!1):($e.priority=0,$e.realTime=!0),$e.load($d.url,$d.type,$d.cache,$d.group,$d.ignoreCache)},$d._endLoad=function($c,$d){var $e=$c.url;if(null==$d){var $f=this._failRes[$e]||0;if($f<this.retryNum)return console.warn("[warn]Retry to load:",$e),this._failRes[$e]=$f+1,void $z.timer.once(this.retryDelay,this,this._addReTry,[$c],!1);console.warn("[error]Failed to load:",$e),this.event("error",$e)}this._failRes[$e]&&(this._failRes[$e]=0),delete $p._resMap[$e],$c.event("complete",$d),$c.offAll(),this._infoPool.push($c)},$d._addReTry=function($c){this._resInfos[this._maxPriority-1].push($c),this._next()},$d.clearRes=function($c,$d){void 0===$d&&($d=!1),$jc.clearRes($c,$d)},$d.getRes=function($c){return $jc.getRes($c)},$d.cacheRes=function($c,$d){$jc.cacheRes($c,$d)},$d.clearTextureRes=function($c){$jc.clearTextureRes($c)},$d.setGroup=function($c,$d){$jc.setGroup($c,$d)},$d.clearResByGroup=function($c){$jc.clearResByGroup($c)},$d.clearUnLoaded=function(){for(var $c=0;$c<this._maxPriority;$c++){for(var $d=this._resInfos[$c],$e=$d.length-1;-1<$e;$e--){var $f=$d[$e];$f&&($f.offAll(),this._infoPool.push($f))}$d.length=0}this._loaderCount=0,$p._resMap={}},$d.cancelLoadByUrls=function($c){if($c)for(var $d=0,$e=$c.length;$d<$e;$d++)this.cancelLoadByUrl($c[$d])},$d.cancelLoadByUrl=function($c){for(var $d=0;$d<this._maxPriority;$d++)for(var $e=this._resInfos[$d],$f=$e.length-1;-1<$f;$f--){var $g=$e[$f];$g&&$g.url===$c&&($e[$f]=null,$g.offAll(),this._infoPool.push($g))}$p._resMap[$c]&&delete $p._resMap[$c]},$d._loadAssets=function($c,$e,$i,$d,$f,$g,$h){null==$f&&($f=2),null==$g&&($g=!0);for(var $j=$c.length,$k=0,$l=0,$m=[],$n=!0,$o=0;$o<$j;$o++){var $p=$c[$o];if(!$p)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+$c);"string"==typeof $p&&($p={url:$p,type:$d,size:1,priority:$f}),$p.size||($p.size=1),$p.progress=0,$l+=$p.size,$m.push($p);var $q=$i?$u.create(null,$t,[$p],!1):null,$r=$e||$i?$u.create(null,$s,[$p]):null;this.load($p.url,$r,$q,$p.type,null!=$p.priority&&0<=$p.priority?$p.priority:2,$g,$p.group||$h)}function $s($c,$d){$k++,$c.progress=1,$d||($n=!1),$k===$j&&$e&&$e.runWith($n)}function $t($c,$d){if(null!=$i){$c.progress=$d;for(var $e=0,$f=0;$f<$m.length;$f++){var $g=$m[$f];$e+=$g.size*$g.progress}var $h=$e/$l;$i.runWith($h)}}return this},$p.cacheRes=function($c,$d){$jc.cacheRes($c,$d)},$p._resMap={},$k($p,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),$p.__init$=function(){$o=function($c){function $d(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,$d.__super.call(this)}return $r($d,"",$l),$d}()},$p}(),$lc=(function($c){function $g($c){$g.__super.call(this),$c||($c=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var $d=0,$e=0,$f=0;$f<20;$f++)$f%5!=4?this._mat[$d++]=$c[$f]:this._alpha[$e++]=$c[$f];this._action=$F.createFilterAction(32),this._action.data=this}$r($g,"laya.filters.ColorFilter",$t);var $d=$g.prototype;$z.imps($d,{"laya.filters.IFilter":!0}),$d.callNative=function($c){$c._$P.cf=this;$c.conchModel&&$c.conchModel.setFilterMatrix&&$c.conchModel.setFilterMatrix(this._mat,this._alpha)},$m(0,$d,"type",function(){return 32}),$m(0,$d,"action",function(){return this._action})}(),function($c){function $f($c,$d,$e){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===$d&&($d=0),$f.__super.call(this),this._byteClass=$e||$P,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,$c&&0<$d&&$d<65535&&this.connect($c,$d)}$r($f,"laya.net.Socket",$l);var $d=$f.prototype;$d.connect=function($c,$d){var $e="ws://"+$c+":"+$d;$e="https:"==$O.window.location.protocol?"wss://"+$c+":"+$d:"ws://"+$c+":"+$d,this.connectByUrl($e)},$d.connectByUrl=function($c){var $d=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new $O.window.WebSocket($c,this.protocols):this._socket=new $O.window.WebSocket($c),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function($c){$d._onOpen($c)},this._socket.onmessage=function($c){$d._onMessage($c)},this._socket.onclose=function($c){$d._onClose($c)},this._socket.onerror=function($c){$d._onError($c)}},$d.cleanSocket=function(){try{this._socket.close()}catch($c){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},$d.close=function(){if(null!=this._socket)try{this._socket.close()}catch($c){}},$d._onOpen=function($c){this._connected=!0,this.event("open",$c)},$d._onMessage=function($c){if($c&&$c.data){var $d=$c.data;if(this.disableInput&&$d)this.event("message",$d);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var $e=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,$d&&("string"==typeof $d?this._input.writeUTFBytes($d):this._input.writeArrayBuffer($d),this._addInputPosition=this._input.pos,this._input.pos=$e),this.event("message",$d)}}},$d._onClose=function($c){this._connected=!1,this.event("close",$c)},$d._onError=function($c){this.event("error",$c)},$d.send=function($c){this._socket.send($c)},$d.flush=function(){if(this._output&&0<this._output.length){var $d;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch($c){$d=$c}this._output.endian=this.endian,this._output.clear(),$d&&this.event("error",$d)}},$m(0,$d,"input",function(){return this._input}),$m(0,$d,"output",function(){return this._output}),$m(0,$d,"connected",function(){return this._connected}),$m(0,$d,"endian",function(){return this._endian},function($c){this._endian=$c,null!=this._input&&(this._input.endian=$c),null!=this._output&&(this._output.endian=$c)}),$f.LITTLE_ENDIAN="littleEndian",$f.BIG_ENDIAN="bigEndian"}(),function($c){function $j(){$j.__super.call(this),this._$1__id=++$j._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,($j._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,$N.currentResourceManager&&$N.currentResourceManager.addResource(this)}$r($j,"laya.resource.Resource",$l);var $d=$j.prototype;return $z.imps($d,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),$d._setUrl=function($c){var $d;this._url!==$c&&(this._url&&(($d=$j._urlResourcesMap[this._url]).splice($d.indexOf(this),1),0===$d.length&&delete $j._urlResourcesMap[this._url]),$c&&(($d=$j._urlResourcesMap[$c])||($j._urlResourcesMap[$c]=$d=[]),$d.push(this)),this._url=$c)},$d._getGroup=function(){return this._group},$d._setGroup=function($c){var $d;this._group!==$c&&(this._group&&(($d=$j._groupResourcesMap[this._group]).splice($d.indexOf(this),1),0===$d.length&&delete $j._groupResourcesMap[this._group]),$c&&(($d=$j._groupResourcesMap[$c])||($j._groupResourcesMap[$c]=$d=[]),$d.push(this)),this._group=$c)},$d._addReference=function(){this._referenceCount++},$d._removeReference=function(){this._referenceCount--},$d._clearReference=function(){this._referenceCount=0},$d._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},$d.recreateResource=function(){this.completeCreate()},$d.disposeResource=function(){},$d.activeResource=function($c){void 0===$c&&($c=!1),this._lastUseFrameCount=$X.loopCount,!this._destroyed&&this.__loaded&&(this._released||$c)&&this.recreateResource()},$d.releaseResource=function($c){return void 0===$c&&($c=!0),!(!$c&&this.lock)&&(!(this._released&&!$c)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},$d.onAsynLoaded=function($c,$d,$e){throw new Error("Resource: must override this function!")},$d.destroy=function(){var $c;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete $j._idResourcesMap[this.id],this._url&&(($c=$j._urlResourcesMap[this._url])&&($c.splice($c.indexOf(this),1),0===$c.length&&delete $j._urlResourcesMap[this.url]),$jc.clearRes(this._url),this.__loaded||$F.cancelLoadByUrl(this._url)),this._group&&(($c=$j._groupResourcesMap[this._group]).splice($c.indexOf(this),1),0===$c.length&&delete $j._groupResourcesMap[this.url]))},$d.completeCreate=function(){this._released=!1,this.event("recovered",this)},$d.dispose=function(){this.destroy()},$m(0,$d,"memorySize",function(){return this._memorySize},function($c){var $d=$c-this._memorySize;this._memorySize=$c,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,$d),this.resourceManager&&this.resourceManager.addSize($d)}),$m(0,$d,"_loaded",null,function($c){this.__loaded=$c}),$m(0,$d,"loaded",function(){return this.__loaded}),$m(0,$d,"id",function(){return this._$1__id}),$m(0,$d,"destroyed",function(){return this._destroyed}),$m(0,$d,"group",function(){return this._getGroup()},function($c){this._setGroup($c)}),$m(0,$d,"resourceManager",function(){return this._resourceManager}),$m(0,$d,"url",function(){return this._url}),$m(0,$d,"released",function(){return this._released}),$m(0,$d,"referenceCount",function(){return this._referenceCount}),$j.getResourceByID=function($c){return $j._idResourcesMap[$c]},$j.getResourceByURL=function($c,$d){return void 0===$d&&($d=0),null==$j._urlResourcesMap[$c]?null:$j._urlResourcesMap[$c][$d]},$j.getResourceCountByURL=function($c){return $j._urlResourcesMap[$c].length},$j.destroyUnusedResources=function($c){var $d;if($c){var $e=$j._groupResourcesMap[$c];if($e)for(var $f=$e.slice(),$g=0,$h=$f.length;$g<$h;$g++)($d=$f[$g]).lock||0!==$d._referenceCount||$d.destroy()}else for(var $i in $j._idResourcesMap)($d=$j._idResourcesMap[$i]).lock||0!==$d._referenceCount||$d.destroy()},$j._uniqueIDCounter=0,$j._idResourcesMap={},$j._urlResourcesMap={},$j._groupResourcesMap={},$j}()),$mc=function($c){function $C($c,$d){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,$C.__super.call(this),$c&&null!=$c._addReference&&$c._addReference(),this.setTo($c,$d)}$r($C,"laya.resource.Texture",$l);var $d=$C.prototype;return $d._setUrl=function($c){this.url=$c},$d.setTo=function($c,$d){if($c instanceof $i.HTMLElement){var $e=$vc.create("2D",$c);this.bitmap=$e}else this.bitmap=$c;if(this.uv=$d||$C.DEF_UV,$c){this._w=$c.width,this._h=$c.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var $f=this;if(this._loaded)$F.addToAtlas&&$F.addToAtlas($f);else{var $g=$c;$g instanceof laya.resource.HTMLImage&&$g.image&&$g.image.addEventListener("load",function($c){$F.addToAtlas&&$F.addToAtlas($f)},!1)}}},$d.active=function(){this.bitmap&&this.bitmap.activeResource()},$d.destroy=function($c){if(void 0===$c&&($c=!1),this.alphaTexture&&(this.alphaTexture.destroy($c),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var $d=this.bitmap;$c?($J.isConchApp&&$d.source&&$d.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$d.dispose(),$d._clearReference()):($d._removeReference(),0==$d.referenceCount&&($J.isConchApp&&$d.source&&$d.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$d.dispose())),this.url&&this===$z.loader.getRes(this.url)&&$z.loader.clearRes(this.url,$c),this._loaded=!1}},$d.load=function($c){var $d=this;this._loaded=!1,$c=$I.customFormat($c);var $e=this.bitmap||(this.bitmap=$yc.create($c));$e.uri=$c,$e&&$e._addReference();var $f=this;$e.onload=function(){$e.onload=null,$f._loaded=!0,$d.sourceWidth=$d._w=$e.width,$d.sourceHeight=$d._h=$e.height,$f.event("loaded",this),$F.addToAtlas&&$F.addToAtlas($f)}},$d.addTextureToAtlas=function($c){$F.addTextureToAtlas(this)},$d.getPixels=function($c,$d,$e,$f){if($J.isConchApp){var $g=this.bitmap;if($g.source&&$g.source.getImageData){var $h=$g.source.getImageData($c,$d,$e,$f),$i=new Uint8Array($h);return Array.from($i)}return null}return $J.isWebGL?$F.getTexturePixels(this,$c,$d,$e,$f):($O.canvas.size($e,$f),$O.canvas.clear(),$O.context.drawTexture(this,-$c,-$d,this.width,this.height,0,0),$O.context.getImageData(0,0,$e,$f).data)},$d.onAsynLoaded=function($c,$d){if($d){if("function"!=typeof $d._addReference)throw new Error("bitmap._addReference is not a function. "+$d.className+" "+typeof $d._addReference+" "+$d.constructor);$d._addReference()}this.setTo($d,this.uv),this._loaded&&this.event("loaded",this)},$m(0,$d,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),$m(0,$d,"loaded",function(){return this._loaded}),$m(0,$d,"released",function(){return!this.bitmap||this.bitmap.released}),$m(0,$d,"width",function(){return this._w?this._w:this.uv&&this.uv!==$C.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function($c){this._w=$c,this.sourceWidth||(this.sourceWidth=$c)}),$m(0,$d,"repeat",function(){return!$J.isWebGL||!this.bitmap||this.bitmap.repeat},function($c){$c&&$J.isWebGL&&this.bitmap&&(this.bitmap.repeat=$c)&&(this.bitmap.enableMerageInAtlas=!1)}),$m(0,$d,"height",function(){return this._h?this._h:this.uv&&this.uv!==$C.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function($c){this._h=$c,this.sourceHeight||(this.sourceHeight=$c)}),$m(0,$d,"isLinearSampling",function(){return!$J.isWebGL||9728!=this.bitmap.minFifter},function($c){!$c&&$J.isWebGL&&($c||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),$C.moveUV=function($c,$d,$e){for(var $f=0;$f<8;$f+=2)$e[$f]+=$c,$e[$f+1]+=$d;return $e},$C.create=function($c,$d,$e,$f,$g,$h,$i,$j,$k){void 0===$h&&($h=0),void 0===$i&&($i=0),void 0===$j&&($j=0),void 0===$k&&($k=0);var $l=$c instanceof laya.resource.Texture,$m=$l?$c.uv:$C.DEF_UV,$n=$l?$c.bitmap:$c,$o=$F.isAtlas($n);if($o){var $p=$n._atlaser,$q=$c._atlasID;if(-1==$q)throw new Error("create texture error");$n=$p._inAtlasTextureBitmapValue[$q],$m=$p._inAtlasTextureOriUVValue[$q]}var $r=new $C($n,null);$n.width&&$d+$f>$n.width&&($f=$n.width-$d),$n.height&&$e+$g>$n.height&&($g=$n.height-$e),$r.width=$f,$r.height=$g,$r.offsetX=$h,$r.offsetY=$i,$r.sourceWidth=$j||$f,$r.sourceHeight=$k||$g;var $s=1/$n.width,$t=1/$n.height;$d*=$s,$e*=$t,$f*=$s,$g*=$t;var $u=$r.uv[0],$v=$r.uv[1],$w=$r.uv[4],$x=$r.uv[5],$y=$w-$u,$z=$x-$v,$A=$C.moveUV($m[0],$m[1],[$d,$e,$d+$f,$e,$d+$f,$e+$g,$d,$e+$g]);$r.uv=[$u+$A[0]*$y,$v+$A[1]*$z,$w-(1-$A[2])*$y,$v+$A[3]*$z,$w-(1-$A[4])*$y,$x-(1-$A[5])*$z,$u+$A[6]*$y,$x-(1-$A[7])*$z],$o&&$r.addTextureToAtlas();var $B=$n.scaleRate;return $B&&1!=$B?($r.sourceWidth/=$B,$r.sourceHeight/=$B,$r.width/=$B,$r.height/=$B,$r.scaleRate=$B,$r.offsetX/=$B,$r.offsetY/=$B):$r.scaleRate=1,$r},$C.createFromTexture=function($c,$d,$e,$f,$g){var $h=$c.scaleRate;1!=$h&&($d*=$h,$e*=$h,$f*=$h,$g*=$h);var $i=$B.TEMP.setTo($d-$c.offsetX,$e-$c.offsetY,$f,$g),$j=$i.intersection($C._rect1.setTo(0,0,$c.width,$c.height),$C._rect2);if(!$j)return null;var $k=$C.create($c,$j.x,$j.y,$j.width,$j.height,$j.x-$i.x,$j.y-$i.y,$f,$g);if($k.bitmap&&$k.bitmap._removeReference)return $k.bitmap._removeReference(),$k;var $l="bitmap:"+($k.bitmap?$k.bitmap.constructor?$k.bitmap.constructor.name:$k.bitmap.__className:"")+", url:"+($c.url+" | "+($k.bitmap?$k.bitmap.url:$c.url))+", x="+$d+",y="+$e+",width="+$f+",height="+$g+", result="+($j?$j.x+","+$j.y+","+$j.width+","+$j.height:"null")+", rect="+$i.x+","+$i.y+","+$i.width+","+$i.height;throw new Error("报错：bitmap._removeReference is not a function  "+$l)},$C.DEF_UV=[0,0,1,0,1,1,0,1],$C.INV_UV=[0,1,1,1,1,0,0,0],$C._rect1=new $B,$C._rect2=new $B,$C}(),$c=function($c){var $j;function $h(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,$h.__super.call(this)}$r($h,"laya.utils.TimeLine",$l);var $d=$h.prototype;return $d.to=function($c,$d,$e,$f,$g){return void 0===$g&&($g=0),this._create($c,$d,$e,$f,$g,!0)},$d.from=function($c,$d,$e,$f,$g){return void 0===$g&&($g=0),this._create($c,$d,$e,$f,$g,!1)},$d._create=function($c,$d,$e,$f,$g,$h){var $i=$W.getItemByClass("tweenData",$j);return $i.isTo=$h,$i.type=0,$i.target=$c,$i.duration=$e,$i.data=$d,$i.startTime=this._startTime+$g,$i.endTime=$i.startTime+$i.duration,$i.ease=$f,this._startTime=Math.max($i.endTime,this._startTime),this._tweenDataList.push($i),this._startTimeSort=!0,this._endTimeSort=!0,this},$d.addLabel=function($c,$d){var $e=$W.getItemByClass("tweenData",$j);return $e.type=1,$e.data=$c,$e.endTime=$e.startTime=this._startTime+$d,this._labelDic||(this._labelDic={}),this._labelDic[$c]=$e,this._tweenDataList.push($e),this},$d.removeLabel=function($c){if(this._labelDic&&this._labelDic[$c]){var $d=this._labelDic[$c];if($d){var $e=this._tweenDataList.indexOf($d);-1<$e&&this._tweenDataList.splice($e,1)}delete this._labelDic[$c]}},$d.gotoTime=function($c){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var $d,$e,$f,$g;for(var $h in this._firstTweenDic)if($e=this._firstTweenDic[$h])for(var $i in $e)$e.diyTarget.hasOwnProperty($i)&&($e.diyTarget[$i]=$e[$i]);for($h in this._tweenDic)($d=this._tweenDic[$h]).clear(),delete this._tweenDic[$h];if(this._index=0,this._gidIndex=0,this._currTime=$c,this._lastTime=$O.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=$f=this._tweenDataList.concat(),$f.sort(function($c,$d){return $c.endTime>$d.endTime?1:$c.endTime<$d.endTime?-1:0})}else $f=this._endTweenDataList;for(var $j=0,$k=$f.length;$j<$k;$j++)if(0==($g=$f[$j]).type){if(!($c>=$g.endTime))break;this._index=Math.max(this._index,$j+1);var $l=$g.data;if($g.isTo)for(var $m in $l)$g.target[$m]=$l[$m]}for($j=0,$k=this._tweenDataList.length;$j<$k;$j++)0==($g=this._tweenDataList[$j]).type&&$c>=$g.startTime&&$c<$g.endTime&&(this._index=Math.max(this._index,$j+1),this._gidIndex++,($d=$W.getItemByClass("tween",$Z))._create($g.target,$g.data,$g.duration,$g.ease,$u.create(this,this._animComplete,[this._gidIndex]),0,!1,$g.isTo,!0,!1),$d.setStartTime(this._currTime-($c-$g.startTime)),$d._updateEase(this._currTime),$d.gid=this._gidIndex,this._tweenDic[this._gidIndex]=$d)}},$d.gotoLabel=function($c){if(null!=this._labelDic){var $d=this._labelDic[$c];$d&&this.gotoTime($d.startTime)}},$d.pause=function(){$z.timer.clear(this,this._update)},$d.resume=function(){this.play(this._currTime,this._loopKey)},$d.play=function($c,$d){if(void 0===$c&&($c=0),void 0===$d&&($d=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function($c,$d){return $c.startTime>$d.startTime?1:$c.startTime<$d.startTime?-1:0});for(var $e=0,$f=this._tweenDataList.length;$e<$f;$e++){var $g=this._tweenDataList[$e];if(null!=$g&&0==$g.type){var $h=$g.target,$i=$h.$_GID||($h.$_GID=$$.getGID()),$j=null;for(var $k in null==this._firstTweenDic[$i]?(($j={}).diyTarget=$h,this._firstTweenDic[$i]=$j):$j=this._firstTweenDic[$i],$g.data)null==$j[$k]&&($j[$k]=$h[$k])}}}"string"==typeof $c?this.gotoLabel($c):this.gotoTime($c),this._loopKey=$d,this._lastTime=$O.now(),$z.timer.frameLoop(1,this,this._update)}},$d._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var $c in this._tweenDic)($d=this._tweenDic[$c]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var $d,$e=$O.now(),$f=$e-this._lastTime,$g=this._currTime+=$f*this.scale;for($c in this._lastTime=$e,this._tweenDic)($d=this._tweenDic[$c])._updateEase($g);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var $h=this._tweenDataList[this._index];$g>=$h.startTime&&(this._index++,0==$h.type?(this._gidIndex++,($d=$W.getItemByClass("tween",$Z))._create($h.target,$h.data,$h.duration,$h.ease,$u.create(this,this._animComplete,[this._gidIndex]),0,!1,$h.isTo,!0,!1),$d.setStartTime($g),$d.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=$d)._updateEase($g)):this.event("label",$h.data))}},$d._animComplete=function($c){this._tweenDic[$c]&&delete this._tweenDic[$c]},$d._complete=function(){this.event("complete")},$d.reset=function(){var $c;if(this._labelDic)for($c in this._labelDic)delete this._labelDic[$c];for($c in this._tweenDic)this._tweenDic[$c].clear(),delete this._tweenDic[$c];for($c in this._firstTweenDic)delete this._firstTweenDic[$c];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var $d,$e=0;for($d=this._tweenDataList.length,$e=0;$e<$d;$e++)this._tweenDataList[$e]&&this._tweenDataList[$e].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,$z.timer.clear(this,this._update)},$d.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},$m(0,$d,"index",function(){return this._frameIndex},function($c){this._frameIndex=$c,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),$m(0,$d,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),$h.to=function($c,$d,$e,$f,$g){return void 0===$g&&($g=0),(new $h).to($c,$d,$e,$f,$g)},$h.from=function($c,$d,$e,$f,$g){return void 0===$g&&($g=0),(new $h).from($c,$d,$e,$f,$g)},$h.__init$=function(){$j=function(){function $c(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return $r($c,""),$c.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,$W.recover("tweenData",this)},$c}()},$h}(),$nc=function($g){function $e(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,$e.__super.call(this),this._style=$j.EMPTY}$r($e,"laya.display.Sprite",$g);var $c=$e.prototype;return $z.imps($c,{"laya.display.ILayout":!0}),$c.createConchModel=function(){return new ConchNode},$c.destroy=function($c){if(void 0===$c&&($c=!0),this._releaseMem(),!this._destroyed){this.filters=null;var $d=this.mask;$d&&(this.mask=null,$d.destroy($c))}$g.prototype.destroy.call(this,$c),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},$c.updateZOrder=function(){$$.updateOrder(this._childs)&&this.repaint()},$c.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},$c.setBounds=function($c){this._set$P("uBounds",$c)},$c.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new $B),$B._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},$c.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new $B),$B._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},$c._boundPointsToParent=function($c){void 0===$c&&($c=!1);var $d=0,$e=0;this._style&&($d=this._style._tf.translateX,$e=this._style._tf.translateY,$c=$c||0!==this._style._tf.rotate,this._style.scrollRect&&($d+=this._style.scrollRect.x,$e+=this._style.scrollRect.y));var $f=this._getBoundPointsM($c);if(!$f||$f.length<1)return $f;if(8!=$f.length&&($f=$c?$x.scanPList($f):$B._getWrapRec($f,$B.TEMP)._getBoundPoints()),!this.transform)return $$.transPointList($f,this._x-$d,this._y-$e),$f;var $g=$A.TEMP,$h=0,$i=$f.length;for($h=0;$h<$i;$h+=2)$g.x=$f[$h],$g.y=$f[$h+1],this.toParentPoint($g),$f[$h]=$g.x,$f[$h+1]=$g.y;return $f},$c.getGraphicBounds=function($c){return void 0===$c&&($c=!1),this._graphics?this._graphics.getBounds($c):$B.TEMP.setTo(0,0,0,0)},$c._getBoundPointsM=function($c){if(void 0===$c&&($c=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var $d=$$.clearArray(this._$P.temBM),$e=$B.TEMP;return $e.copyFrom(this.scrollRect),$$.concatArray($d,$e._getBoundPoints()),$d}for(var $f,$g,$h,$i=this._graphics?this._graphics.getBoundPoints():$$.clearArray(this._$P.temBM),$j=0,$k=($h=this._childs).length;$j<$k;$j++)($f=$h[$j])instanceof laya.display.Sprite&&1==$f.visible&&($g=$f._boundPointsToParent($c))&&($i=$i?$$.concatArray($i,$g):$g);return $i},$c.getStyle=function(){return this._style===$j.EMPTY&&(this._style=new $j),this._style},$c.setStyle=function($c){this._style=$c},$c._adjustTransform=function(){this._tfChanged=!1;var $c,$d=this._style._tf,$e=$d.scaleX,$f=$d.scaleY;if($d.rotate||1!==$e||1!==$f||$d.skewX||$d.skewY){($c=this._transform||(this._transform=$G.create())).bTransform=!0;var $g=.0174532922222222*($d.rotate-$d.skewX),$h=.0174532922222222*($d.rotate+$d.skewY),$i=Math.cos($h),$j=Math.sin($h),$k=Math.sin($g),$l=Math.cos($g);return $c.a=$e*$i,$c.b=$e*$j,$c.c=-$f*$k,$c.d=$f*$l,$c.tx=$c.ty=0,$c}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,$c},$c.pos=function($c,$d,$e){if(void 0===$e&&($e=!1),this._x!==$c||this._y!==$d){if(this.destroyed)return this;if($e){this._x=$c,this._y=$d,this.conchModel&&this.conchModel.pos(this._x,this._y);var $f=this._parent;$f&&0===$f._repaint&&($f._repaint=1,$f.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=$c,this.y=$d}return this},$c.pivot=function($c,$d){return this.pivotX=$c,this.pivotY=$d,this},$c.size=function($c,$d){return this.width=$c,this.height=$d,this},$c.scale=function($c,$d,$e){void 0===$e&&($e=!1);var $f=this.getStyle(),$g=$f._tf;if($g.scaleX!=$c||$g.scaleY!=$d){if(this.destroyed)return this;if($e){$f.setScale($c,$d),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($c,$d),this._renderType|=4;var $h=this._parent;$h&&0===$h._repaint&&($h._repaint=1,$h.parentRepaint())}else this.scaleX=$c,this.scaleY=$d}return this},$c.skew=function($c,$d){return this.skewX=$c,this.skewY=$d,this},$c.render=function($c,$d,$e){$X.spriteCount++,$L.renders[this._renderType]._fun(this,$c,$d+this._x,$e+this._y),this._repaint=0},$c.drawToCanvas=function($c,$d,$e,$f){if($J.isConchNode){var $g=$vc.create("2D");return new $K($c,$d,$g).ctx.setCanvasType(1),this.conchModel.drawToCanvas($g.source,$e,$f),$g}return $F.drawToCanvas(this,this._renderType,$c,$d,$e,$f)},$c.customRender=function($c,$d,$e){this._renderType|=1024},$c._applyFilters=function(){var $c;if(!$J.isWebGL&&(($c=this._$P.filters)&&!($c.length<1)))for(var $d=0,$e=$c.length;$d<$e;$d++)$c[$d].action.apply(this._$P.cacheCanvas)},$c._isHaveGlowFilter=function(){var $c,$d=0;if(this.filters)for($d=0;$d<this.filters.length;$d++)if(8==this.filters[$d].type)return!0;for($d=0,$c=this._childs.length;$d<$c;$d++)if(this._childs[$d]._isHaveGlowFilter())return!0;return!1},$c.localToGlobal=function($c,$d){void 0===$d&&($d=!1),!0===$d&&($c=new $A($c.x,$c.y));for(var $e=this;$e&&$e!=$z.stage;)$c=$e.toParentPoint($c),$e=$e.parent;return $c},$c.globalToLocal=function($c,$d){void 0===$d&&($d=!1),$d&&($c=new $A($c.x,$c.y));for(var $e=this,$f=[];$e&&$e!=$z.stage;)$f.push($e),$e=$e.parent;for(var $g=$f.length-1;0<=$g;)$c=($e=$f[$g]).fromParentPoint($c),$g--;return $c},$c.toParentPoint=function($c){if(!$c)return $c;$c.x-=this.pivotX,$c.y-=this.pivotY,this.transform&&this._transform.transformPoint($c),$c.x+=this._x,$c.y+=this._y;var $d=this._style.scrollRect;return $d&&($c.x-=$d.x,$c.y-=$d.y),$c},$c.fromParentPoint=function($c){if(!$c)return $c;$c.x-=this._x,$c.y-=this._y;var $d=this._style.scrollRect;return $d&&($c.x+=$d.x,$c.y+=$d.y),this.transform&&this._transform.invertTransformPoint($c),$c.x+=this.pivotX,$c.y+=this.pivotY,$c},$c.on=function($c,$d,$e,$f){return 1!==this._mouseEnableState&&this.isMouseEvent($c)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($c,$d,$e,$f,!1)):$g.prototype.on.call(this,$c,$d,$e,$f)},$c.once=function($c,$d,$e,$f){return 1!==this._mouseEnableState&&this.isMouseEvent($c)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($c,$d,$e,$f,!0)):$g.prototype.once.call(this,$c,$d,$e,$f)},$c._$2__onDisplay=function(){if(1!==this._mouseEnableState){var $c=this;for($c=$c.parent;$c&&1!==$c._mouseEnableState&&!$c._getBit(2);)$c.mouseEnabled=!0,$c._setBit(2,!0),$c=$c.parent}},$c.loadImage=function($c,$d,$e,$f,$g,$h){var $i=this;return void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=0),void 0===$g&&($g=0),this.graphics.loadImage($c,$d,$e,$f,$g,function($c){$i.destroyed||($i.size($d+($f||$c.width),$e+($g||$c.height)),$i.repaint(),$h&&$h.runWith($c))}),this},$c.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},$c._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},$c._childChanged=function($c){this._childs.length?this._renderType|=2048:this._renderType&=-2049,$c&&this._get$P("hasZorder")&&$z.timer.callLater(this,this.updateZOrder),this.repaint()},$c.parentRepaint=function(){var $c=this._parent;$c&&0===$c._repaint&&($c._repaint=1,$c.parentRepaint())},$c.startDrag=function($c,$d,$e,$f,$g,$h,$i){void 0===$d&&($d=!1),void 0===$e&&($e=0),void 0===$f&&($f=300),void 0===$h&&($h=!1),void 0===$i&&($i=.92),this._$P.dragging||this._set$P("dragging",new $T),this._$P.dragging.start(this,$c,$d,$e,$f,$g,$h,$i)},$c.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},$c._releaseMem=function(){if(this._$P){var $c=this._$P.cacheCanvas;$c&&$c.ctx&&($W.recover("RenderContext",$c.ctx),$c.ctx.canvas.size(0,0),$c.ctx=null);var $d=this._$P._filterCache;$d&&($d.destroy(),$d.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},$c._setDisplay=function($c){$c||this._releaseMem(),$g.prototype._setDisplay.call(this,$c)},$c.hitTestPoint=function($c,$d){var $e=this.globalToLocal($A.TEMP.setTo($c,$d));return $c=$e.x,$d=$e.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?$B.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains($c,$d)},$c.getMousePoint=function(){return this.globalToLocal($A.TEMP.setTo($z.stage.mouseX,$z.stage.mouseY))},$c._getWords=function(){return null},$c._addChildsToLayout=function($c){var $d=this._getWords();if(null==$d&&0==this._childs.length)return!1;if($d)for(var $e=0,$f=$d.length;$e<$f;$e++)$c.push($d[$e]);$e=0;for(var $g=this._childs.length;$e<$g;++$e){var $h=this._childs[$e];$h._style._enableLayout()&&$h._addToLayout($c)}return!0},$c._addToLayout=function($c){this._style.absolute||(this._style.block?$c.push(this):this._addChildsToLayout($c)&&(this.x=this.y=0))},$c._isChar=function(){return!1},$c._getCSSStyle=function(){return this._style.getCSSStyle()},$c._setAttributes=function($c,$d){switch($c){case"x":this.x=parseFloat($d);break;case"y":this.y=parseFloat($d);break;case"width":this.width=parseFloat($d);break;case"height":this.height=parseFloat($d);break;default:this[$c]=$d}},$c._layoutLater=function(){this.parent&&this.parent._layoutLater()},$m(0,$c,"optimizeScrollRect",function(){return this._optimizeScrollRect},function($c){this._optimizeScrollRect!=$c&&(this._optimizeScrollRect=$c,this.conchModel&&this.conchModel.optimizeScrollRect($c))}),$m(0,$c,"customRenderEnable",null,function($c){if($c&&(this._renderType|=1024,$J.isConchNode)){$e.CustomList.push(this);var $d=new $vc("2d");$d._setContext(new CanvasRenderingContext2D),this.customContext=new $K(0,0,$d),$d.context.setCanvasType&&$d.context.setCanvasType(2),this.conchModel.custom($d.context)}}),$m(0,$c,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function($c){this.cacheAs=$c?this._$P.hasFilter?"none":"normal":"none"}),$m(0,$c,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function($c){var $d=this._$P.cacheCanvas;if($c!==($d?$d.type:"none")){if("none"!==$c)this._getBit(1)||this._setUpNoticeType(1),$d||($d=this._set$P("cacheCanvas",$W.getItemByClass("cacheCanvas",Object))),$d.type=$c,$d.reCache=!0,this._renderType|=16,"bitmap"==$c&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if($d){var $e=$d;$e&&$e.ctx&&($W.recover("RenderContext",$e.ctx),$e.ctx.canvas.size(0,0),$e.ctx=null),$W.recover("cacheCanvas",$d)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),$m(0,$c,"zOrder",function(){return this._zOrder},function($c){this._zOrder!=$c&&(this._zOrder=$c,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder($c),this._parent&&($c&&this._parent._set$P("hasZorder",!0),$z.timer.callLater(this._parent,this.updateZOrder)))}),$m(0,$c,"rotation",function(){return this._style._tf.rotate},function($c){var $d=this.getStyle();if($d._tf.rotate!==$c){$d.setRotate($c),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate($c),this._renderType|=4;var $e=this._parent;$e&&0===$e._repaint&&($e._repaint=1,$e.parentRepaint())}}),$m(0,$c,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($c){this._width!==$c&&(this._width=$c,this.conchModel&&this.conchModel.size($c,this._height),this.repaint())}),$m(0,$c,"x",function(){return this._x},function($c){if(this._x!==$c){if(this.destroyed)return;this._x=$c,this.conchModel&&this.conchModel.pos($c,this._y);var $d=this._parent;$d&&0===$d._repaint&&($d._repaint=1,$d.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$m(0,$c,"globalScaleY",function(){for(var $c=1,$d=this;$d&&$d!==$z.stage;)$c*=$d.scaleY,$d=$d.parent;return $c}),$m(0,$c,"hitArea",function(){return this._$P.hitArea},function($c){this._set$P("hitArea",$c)}),$m(0,$c,"staticCache",function(){return this._$P.staticCache},function($c){this._set$P("staticCache",$c),$c||this.reCache()}),$m(0,$c,"texture",function(){return this._texture},function($c){this._texture!=$c&&(this._texture=$c,this.graphics.cleanByTexture($c,0,0))}),$m(0,$c,"y",function(){return this._y},function($c){if(this._y!==$c){if(this.destroyed)return;this._y=$c,this.conchModel&&this.conchModel.pos(this._x,$c);var $d=this._parent;$d&&0===$d._repaint&&($d._repaint=1,$d.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$m(0,$c,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($c){this._height!==$c&&(this._height=$c,this.conchModel&&this.conchModel.size(this._width,$c),this.repaint())}),$m(0,$c,"blendMode",function(){return this._style.blendMode},function($c){this.getStyle().blendMode=$c,this.conchModel&&this.conchModel.blendMode($c),$c&&"source-over"!=$c?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),$m(0,$c,"scaleX",function(){return this._style._tf.scaleX},function($c){var $d=this.getStyle();if($d._tf.scaleX!==$c){$d.setScaleX($c),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($c,$d._tf.scaleY),this._renderType|=4;var $e=this._parent;$e&&0===$e._repaint&&($e._repaint=1,$e.parentRepaint())}}),$m(0,$c,"scaleY",function(){return this._style._tf.scaleY},function($c){var $d=this.getStyle();if($d._tf.scaleY!==$c){$d.setScaleY($c),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($d._tf.scaleX,$c),this._renderType|=4;var $e=this._parent;$e&&0===$e._repaint&&($e._repaint=1,$e.parentRepaint())}}),$m(0,$c,"stage",function(){return $z.stage}),$m(0,$c,"skewX",function(){return this._style._tf.skewX},function($c){var $d=this.getStyle();if($d._tf.skewX!==$c){$d.setSkewX($c),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($c,$d._tf.skewY),this._renderType|=4;var $e=this._parent;$e&&0===$e._repaint&&($e._repaint=1,$e.parentRepaint())}}),$m(0,$c,"scrollRect",function(){return this._style.scrollRect},function($c){this.getStyle().scrollRect=$c,this.repaint(),$c?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect($c.x,$c.y,$c.width,$c.height)):(this._renderType&=-129,this.conchModel&&($e.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),$m(0,$c,"skewY",function(){return this._style._tf.skewY},function($c){var $d=this.getStyle();if($d._tf.skewY!==$c){$d.setSkewY($c),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($d._tf.skewX,$c),this._renderType|=4;var $e=this._parent;$e&&0===$e._repaint&&($e._repaint=1,$e.parentRepaint())}}),$m(0,$c,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function($c){this._tfChanged=!1,(this._transform=$c)&&(this._x=$c.tx,this._y=$c.ty,$c.tx=$c.ty=0,this.conchModel&&this.conchModel.transform($c.a,$c.b,$c.c,$c.d,this._x,this._y)),$c?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),$m(0,$c,"pivotX",function(){return this._style._tf.translateX},function($c){this.getStyle().setTranslateX($c),this.conchModel&&this.conchModel.pivot($c,this._style._tf.translateY),this.repaint()}),$m(0,$c,"pivotY",function(){return this._style._tf.translateY},function($c){this.getStyle().setTranslateY($c),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,$c),this.repaint()}),$m(0,$c,"alpha",function(){return this._style.alpha},function($c){this._style&&this._style.alpha!==$c&&($c=$c<0?0:1<$c?1:$c,this.getStyle().alpha=$c,this.conchModel&&this.conchModel.alpha($c),1!==$c?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),$m(0,$c,"visible",function(){return this._style.visible},function($c){this._style&&this._style.visible!==$c&&(this.getStyle().visible=$c,this.conchModel&&this.conchModel.visible($c),this.parentRepaint())}),$m(0,$c,"graphics",function(){return this._graphics||(this.graphics=$F.createGraphics())},function($c){this._graphics&&(this._graphics._sp=null),(this._graphics=$c)?(this._renderType&=-2,this._renderType|=512,($c._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&($e.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),$m(0,$c,"filters",function(){return this._$P.filters},function($c){$c&&0===$c.length&&($c=null),this._$P.filters!=$c&&(this._set$P("filters",$c?$c.slice():null),$J.isConchApp&&(this.conchModel&&($e.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),$J.isWebGL&&($c&&$c.length?this._renderType|=32:this._renderType&=-33),$c&&0<$c.length?(this._getBit(1)||this._setUpNoticeType(1),$J.isWebGL&&1==$c.length&&$c[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&($J.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),$m(0,$c,"parent",$g.prototype._$get_parent,function($c){$z.superSet($cc,this,"parent",$c),$c&&this._getBit(2)&&this._$2__onDisplay()}),$m(0,$c,"mask",function(){return this._$P._mask},function($c){$c&&this.mask&&this.mask._$P.maskParent||($c?(this.cacheAs="bitmap",this._set$P("_mask",$c),$c._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",$c),this.cacheAs="none"),this.conchModel&&this.conchModel.mask($c?$c.conchModel:null),this._renderType|=64,this.parentRepaint())}),$m(0,$c,"mouseEnabled",function(){return 1<this._mouseEnableState},function($c){this._mouseEnableState=$c?2:1}),$m(0,$c,"globalScaleX",function(){for(var $c=1,$d=this;$d&&$d!==$z.stage;)$c*=$d.scaleX,$d=$d.parent;return $c}),$m(0,$c,"mouseX",function(){return this.getMousePoint().x}),$m(0,$c,"mouseY",function(){return this.getMousePoint().y}),$e.fromImage=function($c){return(new $e).loadImage($c)},$e._cachePool=[],$e.CustomList=[],$k($e,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=$i.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),$e}($cc),$oc=function($c){function $d($c){this._audio=null,this._onEnd=null,this._resumePlay=null,$d.__super.call(this),this._onEnd=$$.bind(this.__onEnd,this),this._resumePlay=$$.bind(this.__resumePlay,this),$c.addEventListener("ended",this._onEnd),this._audio=$c}$r($d,"laya.media.h5audio.AudioSoundChannel",$fc);var $e=$d.prototype;return $e.__onEnd=function(){if(1==this.loops)return this.completeHandler&&($z.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$e.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,$O.container.appendChild(this._audio),this._audio.play()}catch($c){this.event("error")}},$e.play=function($c){this.isStopped=!1;try{this._audio.playbackRate=$E.playbackRate,this._audio.currentTime=this.startTime}catch($c){return void this._audio.addEventListener("canplay",this._resumePlay)}$E.addChannel(this),$O.container.appendChild(this._audio),!$c&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},$e.stop=function(){this.isStopped=!0,$E.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&$J.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),$O.onIE||this._audio!=$ec._musicAudio&&$W.recover("audio:"+this.url,this._audio),$O.removeElement(this._audio),this._audio=null)},$e.pause=function(){this.isStopped=!0,$E.removeChannel(this),"pause"in this._audio&&this._audio.pause()},$e.resume=function(){this._audio&&(this.isStopped=!1,$E.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},$m(0,$e,"position",function(){return this._audio?this._audio.currentTime:0}),$m(0,$e,"duration",function(){return this._audio?this._audio.duration:0}),$m(0,$e,"volume",function(){return this._audio?this._audio.volume:1},function($c){this._audio&&(this._audio.volume=$c)}),$d}(),$pc=function($c){function $d(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=$hc.ctx,$d.__super.call(this),this._onPlayEnd=$$.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}$r($d,"laya.media.webaudio.WebAudioSoundChannel",$fc);var $e=$d.prototype;return $e.play=function($c){if($E.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var $d=this.context,$e=this.gain,$f=$d.createBufferSource();(this.bufferSource=$f).buffer=this.audioBuffer,$f.connect($e),$e&&$e.disconnect(),$e.connect($d.destination),$f.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=$O.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&($f.loop=!0),$f.playbackRate.setTargetAtTime?$f.playbackRate.setTargetAtTime($E.playbackRate,this.context.currentTime,.1):$f.playbackRate.value=$E.playbackRate,$f.start(0,this.startTime),!$c&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},$e.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&($z.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$e._clearBufferSource=function(){if(this.bufferSource){var $c=this.bufferSource;$c.stop?$c.stop(0):$c.noteOff(0),$c.disconnect(0),$c.onended=null,$d._tryCleanFailed||this._tryClearBuffer($c),this.bufferSource=null}},$e._tryClearBuffer=function($c){try{$c.buffer=null}catch($c){$d._tryCleanFailed=!0}},$e.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,$E.removeChannel(this),this.startHandler=null,this.completeHandler=null},$e.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,$E.removeChannel(this)},$e.resume=function(){this.startTime=this._pauseTime,this.play(!1)},$m(0,$e,"position",function(){return this.bufferSource?($O.now()-this._startTime)/1e3+this.startTime:0}),$m(0,$e,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$m(0,$e,"volume",function(){return this._volume},function($c){this.isStopped||(this._volume=$c,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime($c,this.context.currentTime,.1):this.gain.gain.value=$c)}),$d._tryCleanFailed=!1,$d}(),$qc=function($c){function $d(){$d.__super.call(this),this._w=0,this._h=0}$r($d,"laya.resource.Bitmap",$lc);var $e=$d.prototype;return $m(0,$e,"width",function(){return this._w}),$m(0,$e,"height",function(){return this._h}),$m(0,$e,"source",function(){return this._source}),$d}(),$rc=function($d){function $c(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,$c.__super.call(this),this._interval=$f.animationInterval,this._setUpNoticeType(1)}$r($c,"laya.display.AnimationPlayerBase",$d);var $e=$c.prototype;return $e.play=function($c,$d,$e,$f){void 0===$c&&($c=0),void 0===$d&&($d=!0),void 0===$e&&($e=""),void 0===$f&&($f=!0),this._isPlaying=!0,this.index="string"==typeof $c?this._getFrameByLabel($c):$c,this.loop=$d,this._actionName=$e,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$e._getFrameByLabel=function($c){var $d=0;for($d=0;$d<this._count;$d++)if(this._labels[$d]&&0<=this._labels[$d].indexOf($c))return $d;return 0},$e._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},$e._setControlNode=function($c){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=$c)&&$c!=this&&($c.on("display",this,this._checkResumePlaying),$c.on("undisplay",this,this._checkResumePlaying))},$e._setDisplay=function($c){$d.prototype._setDisplay.call(this,$c),this._checkResumePlaying()},$e._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},$e.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},$e.addLabel=function($c,$d){this._labels||(this._labels={}),this._labels[$d]||(this._labels[$d]=[]),this._labels[$d].push($c)},$e.removeLabel=function($c){if($c){if(this._labels)for(var $d in this._labels)this._removeLabelFromLabelList(this._labels[$d],$c)}else this._labels=null},$e._removeLabelFromLabelList=function($c,$d){if($c)for(var $e=$c.length-1;0<=$e;$e--)$c[$e]==$d&&$c.splice($e,1)},$e.gotoAndStop=function($c){this.index="string"==typeof $c?this._getFrameByLabel($c):$c,this.stop()},$e._displayToIndex=function($c){},$e.clear=function(){this.stop(),this._labels=null},$m(0,$e,"interval",function(){return this._interval},function($c){this._interval!=$c&&(this._frameRateChanged=!0,this._interval=$c,this._isPlaying&&0<$c&&this.timerLoop($c,this,this._frameLoop,null,!0,!0))}),$m(0,$e,"isPlaying",function(){return this._isPlaying}),$m(0,$e,"index",function(){return this._index},function($c){if(this._index=$c,this._displayToIndex($c),this._labels&&this._labels[$c])for(var $d=this._labels[$c],$e=0,$f=$d.length;$e<$f;$e++)this.event("label",$d[$e])}),$m(0,$e,"count",function(){return this._count}),$c.WRAP_POSITIVE=0,$c.WRAP_REVERSE=1,$c.WRAP_PINGPONG=2,$c}($nc),$sc=function($d){function $p(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,$p.__super.call(this),this.overflow=$p.VISIBLE,this._style=new $dc(this),this._style.wordWrap=!1}$r($p,"laya.display.Text",$d);var $c=$p.prototype;return $c.destroy=function($c){void 0===$c&&($c=!0),$d.prototype.destroy.call(this,$c),this._lines=null,this._words&&(this._words.length=0,this._words=null)},$c._getBoundPointsM=function($c){void 0===$c&&($c=!1);var $d=$B.TEMP;return $d.setTo(0,0,this.width,this.height),$d._getBoundPoints()},$c.getGraphicBounds=function($c){void 0===$c&&($c=!1);var $d=$B.TEMP;return $d.setTo(0,0,this.width,this.height),$d},$c._getCSSStyle=function(){return this._style},$c.lang=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m){if($c=$p.langPacks&&$p.langPacks[$c]?$p.langPacks[$c]:$c,arguments.length<2)this._text=$c;else{for(var $n=0,$o=arguments.length;$n<$o;$n++)$c=$c.replace("{"+$n+"}",arguments[$n+1]);this._text=$c}},$c._isPassWordMode=function(){var $c=this._style.password;return"prompt"in this&&this.prompt==this._text&&($c=!1),$c},$c._getPassWordTxt=function($c){var $d;$d="";for(var $e=$c.length;0<$e;$e--)$d+="●";return $d},$c.renderText=function($c,$d){var $e=this.graphics;$e.clear(!0);var $f=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+($O.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);$O.context.font=$f;var $g=this.padding,$h=$g[3],$i="left",$j=this._lines,$k=this.leading+this._charSize.height,$l=this._currBitmapFont;$l&&($k=this.leading+$l.getMaxHeight());var $m=$g[0];if(!$l&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?($i="right",$h=this._width-$g[1]):"center"==this.align&&($i="center",$h=.5*this._width+$g[3]-$g[1])),0<this._height){var $n=this._textHeight>this._height?"top":this.valign;"middle"===$n?$m=.5*(this._height-$d*$k)+$g[0]-$g[2]:"bottom"===$n&&($m=this._height-$d*$k-$g[2])}var $o=this._style;if($l&&$l.autoScaleSize)var $p=$l.fontSize/this.fontSize;if(this._clipPoint)if($e.save(),$l&&$l.autoScaleSize){var $q=0,$r=0;$q=this._width?this._width-$g[3]-$g[1]:this._textWidth,$r=this._height?this._height-$g[0]-$g[2]:this._textHeight,$q*=$p,$r*=$p,$e.clipRect($g[3],$g[0],$q,$r)}else $e.clipRect($g[3],$g[0],this._width?this._width-$g[3]-$g[1]:this._textWidth,this._height?this._height-$g[0]-$g[2]:this._textHeight);var $s=$o.password;"prompt"in this&&this.prompt==this._text&&($s=!1);for(var $t=0,$u=0,$v=Math.min(this._lines.length,$d+$c)||1,$w=$c;$w<$v;$w++){var $x,$y=$j[$w];if($s){var $z=$y.length;$y="";for(var $A=$z;0<$A;$A--)$y+="●"}if($t=$h-(this._clipPoint?this._clipPoint.x:0),$u=$m+$k*$w-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline($i,$t,$u,$w),$l){var $B=this.width;$l.autoScaleSize&&($B=this.width*$p),$l.drawText($y,this,$t,$u,this.align,$B)}else $J.isWebGL?(this._words||(this._words=[]),($x=this._words.length>$w-$c?this._words[$w-$c]:new $b).setText($y)):$x=$y,$o.stroke?$e.fillBorderText($x,$t,$u,$f,this.color,$o.strokeColor,$o.stroke,$i):$e.fillText($x,$t,$u,$f,this.color,$i)}if($l&&$l.autoScaleSize){var $C=1/$p;this.scale($C,$C)}this._clipPoint&&$e.restore(),this._startX=$h,this._startY=$m},$c.drawUnderline=function($c,$d,$e,$f){var $g=this._lineWidths[$f];switch($c){case"center":$d-=$g/2;break;case"right":$d-=$g}$e+=this._charSize.height,this._graphics.drawLine($d,$e,$d+$g,$e,this.underlineColor||this.color,1)},$c.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);$O.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new $A(0,0)):this._clipPoint=null;var $c=this._lines.length;if(this.overflow!=$p.VISIBLE){var $d=this.overflow==$p.HIDDEN?Math.floor:Math.ceil;$c=Math.min($c,$d((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var $e=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText($e,$c),this.repaint()},$c.evalTextSize=function(){var $c,$d=NaN;$c=Math.max.apply(this,this._lineWidths),$d=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],$c==this._textWidth&&$d==this._textHeight||(this._textWidth=$c,this._textHeight=$d,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},$c.checkEnabledViewportOrNot=function(){return this.overflow==$p.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},$c.changeText=function($c){this._text!==$c&&(this.lang($c+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},$c.parseLines=function($c){var $d=this.wordWrap||this.overflow==$p.HIDDEN;if($d)var $e=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var $f=$O.context.measureText($p._testWord);$J.isConchApp&&0===$f.width&&0===$f.height&&($f=$O.context.measureText("W")),this._charSize.width=$f.width,this._charSize.height=$f.height||this.fontSize}for(var $g=$c.replace(/\r\n/g,"\n").split("\n"),$h=0,$i=$g.length;$h<$i;$h++){var $j=$g[$h];$d?this.parseLine($j,$e):(this._lineWidths.push(this.getTextWidth($j)),this._lines.push($j))}},$c.parseLine=function($c,$d){$O.context;var $e,$f=this._lines,$g=0,$h=NaN,$i=NaN,$j=0;if(($h=this.getTextWidth($c))<=$d)return $f.push($c),void this._lineWidths.push($h);$h=this._charSize.width,0==($g=Math.floor($d/$h))&&($g=1),$i=$h=this.getTextWidth($c.substring(0,$g));for(var $k=$g,$l=$c.length;$k<$l;$k++)if($d<($i+=$h=this.getTextWidth($c.charAt($k))))if(this.wordWrap){var $m=$c.substring($j,$k);if($m.charCodeAt($m.length-1)<255?($e=/(?:\w|-)+$/.exec($m))&&($k=$e.index+$j,0==$e.index?$k+=$m.length:$m=$c.substring($j,$k)):$p.RightToLeft&&($e=/([\u0600-\u06FF])+$/.exec($m))&&($k=$e.index+$j,0==$e.index?$k+=$m.length:$m=$c.substring($j,$k)),$f.push($m),this._lineWidths.push($i-$h),!(($j=$k)+$g<$l)){$f.push($c.substring($j,$l)),this._lineWidths.push(this.getTextWidth($f[$f.length-1])),$j=-1;break}$k+=$g,$i=$h=this.getTextWidth($c.substring($j,$k)),$k--}else if(this.overflow==$p.HIDDEN)return $f.push($c.substring(0,$k)),void this._lineWidths.push(this.getTextWidth($f[$f.length-1]));this.wordWrap&&-1!=$j&&($f.push($c.substring($j,$l)),this._lineWidths.push(this.getTextWidth($f[$f.length-1])))},$c.getTextWidth=function($c){return this._currBitmapFont?this._currBitmapFont.getTextWidth($c):$O.context.measureText($c).width},$c.getWordWrapWidth=function(){var $c=this.padding,$d=NaN;return($d=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&($d=this.wordWrap?100:$O.width),$d<=0&&($d=100),$d-$c[3]-$c[1]},$c.getCharPoint=function($c,$d){this._isChanged&&$z.timer.runCallLater(this,this.typeset);for(var $e=0,$f=this._lines,$g=0,$h=0,$i=$f.length;$h<$i;$h++){if($c<($e+=$f[$h].length)){var $j=$h;break}$g=$e}var $k=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;$O.context.font=$k;var $l=this.getTextWidth(this._text.substring($g,$c));return($d||new $A).setTo(this._startX+$l-(this._clipPoint?this._clipPoint.x:0),this._startY+$j*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},$m(0,$c,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function($c){$c!=this._width&&($z.superSet($nc,this,"width",$c),this.isChanged=!0)}),$m(0,$c,"textWidth",function(){return this._isChanged&&$z.timer.runCallLater(this,this.typeset),this._textWidth}),$m(0,$c,"height",function(){return this._height?this._height:this.textHeight},function($c){$c!=this._height&&($z.superSet($nc,this,"height",$c),this.isChanged=!0)}),$m(0,$c,"textHeight",function(){return this._isChanged&&$z.timer.runCallLater(this,this.typeset),this._textHeight}),$m(0,$c,"padding",function(){return this._getCSSStyle().padding},function($c){this._getCSSStyle().padding=$c,this.isChanged=!0}),$m(0,$c,"bold",function(){return this._getCSSStyle().bold},function($c){this._getCSSStyle().bold=$c,this.isChanged=!0}),$m(0,$c,"text",function(){return this._text||""},function($c){this._text!==$c&&(this.lang($c+""),this.isChanged=!0,this.event("change"))}),$m(0,$c,"color",function(){return this._getCSSStyle().color},function($c){this._getCSSStyle().color!=$c&&(this._getCSSStyle().color=$c,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),$m(0,$c,"font",function(){return this._getCSSStyle().fontFamily},function($c){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),$p._bitmapFonts&&$p._bitmapFonts[$c]&&(this._currBitmapFont=$p._bitmapFonts[$c]),this._getCSSStyle().fontFamily=$c,this.isChanged=!0}),$m(0,$c,"fontSize",function(){return this._getCSSStyle().fontSize},function($c){this._getCSSStyle().fontSize=$c,this.isChanged=!0}),$m(0,$c,"italic",function(){return this._getCSSStyle().italic},function($c){this._getCSSStyle().italic=$c,this.isChanged=!0}),$m(0,$c,"align",function(){return this._getCSSStyle().align},function($c){this._getCSSStyle().align=$c,this.isChanged=!0}),$m(0,$c,"valign",function(){return this._getCSSStyle().valign},function($c){this._getCSSStyle().valign=$c,this.isChanged=!0}),$m(0,$c,"wordWrap",function(){return this._getCSSStyle().wordWrap},function($c){this._getCSSStyle().wordWrap=$c,this.isChanged=!0}),$m(0,$c,"leading",function(){return this._getCSSStyle().leading},function($c){this._getCSSStyle().leading=$c,this.isChanged=!0}),$m(0,$c,"bgColor",function(){return this._getCSSStyle().backgroundColor},function($c){this._getCSSStyle().backgroundColor=$c,this.isChanged=!0}),$m(0,$c,"borderColor",function(){return this._getCSSStyle().borderColor},function($c){this._getCSSStyle().borderColor=$c,this.isChanged=!0}),$m(0,$c,"stroke",function(){return this._getCSSStyle().stroke},function($c){this._getCSSStyle().stroke=$c,this.isChanged=!0}),$m(0,$c,"strokeColor",function(){return this._getCSSStyle().strokeColor},function($c){this._getCSSStyle().strokeColor=$c,this.isChanged=!0}),$m(0,$c,"isChanged",null,function($c){this._isChanged!==$c&&(this._isChanged=$c)&&$z.timer.callLater(this,this.typeset)}),$m(0,$c,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function($c){if(!(this.overflow!=$p.SCROLL||this.textWidth<this._width)&&this._clipPoint){$c=$c<this.padding[3]?this.padding[3]:$c;var $d=this._textWidth-this._width;$c=$d<$c?$d:$c;var $e=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=$c,this.renderText(this._lastVisibleLineIndex,$e)}}),$m(0,$c,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function($c){if(!(this.overflow!=$p.SCROLL||this.textHeight<this._height)&&this._clipPoint){$c=$c<this.padding[0]?this.padding[0]:$c;var $d=this._textHeight-this._height,$e=($c=$d<$c?$d:$c)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=$e;var $f=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=$c,this.renderText($e,$f)}}),$m(0,$c,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),$m(0,$c,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),$m(0,$c,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),$m(0,$c,"underlineColor",function(){return this._underlineColor},function($c){this._underlineColor=$c,this._isChanged=!0,this.typeset()}),$p.registerBitmapFont=function($c,$d){$p._bitmapFonts||($p._bitmapFonts={}),$p._bitmapFonts[$c]=$d},$p.unregisterBitmapFont=function($c,$d){if(void 0===$d&&($d=!0),$p._bitmapFonts&&$p._bitmapFonts[$c]){var $e=$p._bitmapFonts[$c];$d&&$e.destroy(),delete $p._bitmapFonts[$c]}},$p.setTextRightToLeft=function(){var $c;($c=$O.canvas.source.style).display="none",$c.position="absolute",$c.direction="rtl",$J._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,$O.document.body.appendChild($O.canvas.source)},$p.supportFont=function($c){$O.context.font="10px sans-serif";var $d=$O.context.measureText("abcji").width;$O.context.font="10px "+$c;var $e=$O.context.measureText("abcji").width;return console.log($d,$e),$d!==$e},$p._testWord="游",$p.langPacks=null,$p.VISIBLE="visible",$p.SCROLL="scroll",$p.HIDDEN="hidden",$p.CharacterCache=!0,$p.RightToLeft=!1,$p._bitmapFonts=null,$k($p,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),$p}($nc),$tc=function($n){function $i(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",$i.__super.call(this),this.offset=new $A,this._canvasTransform=new $G,this._previousOrientation=$O.window.orientation;var $d=this;this.transform=$G.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var $c=$O.window,$e=this;$c.addEventListener("focus",function(){$d._isFocused=!0,$e.event("focus"),$e.event("focuschange")}),$c.addEventListener("blur",function(){$d._isFocused=!1,$e.event("blur"),$e.event("focuschange"),$e._isInputting()&&($xc.inputElement.target.focus=!1)});var $f="visibilityState",$g="visibilitychange",$h=$c.document;void 0!==$h.hidden?($g="visibilitychange",$f="visibilityState"):void 0!==$h.mozHidden?($g="mozvisibilitychange",$f="mozVisibilityState"):void 0!==$h.msHidden?($g="msvisibilitychange",$f="msVisibilityState"):void 0!==$h.webkitHidden&&($g="webkitvisibilitychange",$f="webkitVisibilityState"),$c.document.addEventListener($g,function(){"hidden"==$O.document[$f]?$e._setStageVisible(!1):$e._setStageVisible(!0)}),$c.document.addEventListener("qbrowserVisibilityChange",function($c){$e._setStageVisible(!$c.hidden)}),$c.addEventListener("resize",function(){var $c=$O.window.orientation;null!=$c&&$c!=$d._previousOrientation&&$e._isInputting()&&($xc.inputElement.target.focus=!1),$d._previousOrientation=$c,$e._isInputting()||$e._resetCanvas()}),$c.addEventListener("orientationchange",function($c){$e._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),$O.onMobile&&this.on("mousedown",this,this._onmouseMove)}$r($i,"laya.display.Stage",$n);var $c=$i.prototype;return $c._setStageVisible=function($c){this._isVisibility!=$c&&(this._isVisibility=$c,this._isVisibility||this._isInputting()&&($xc.inputElement.target.focus=!1),this.event("visibilitychange"))},$c._isInputting=function(){return $O.onMobile&&$xc.isInputting},$c._changeCanvasSize=function(){this.setScreenSize($O.clientWidth*$O.pixelRatio,$O.clientHeight*$O.pixelRatio)},$c._resetCanvas=function(){if(this.screenAdaptationEnabled){var $c=$J._mainCanvas;$c.source.style;$c.size(1,1),$z.timer.once(100,this,this._changeCanvasSize)}},$c.setScreenSize=function($c,$d){var $e=!1;if("none"!==this._screenMode&&($e=($c/$d<1?"vertical":"horizontal")!==this._screenMode)){var $f=$d;$d=$c,$c=$f}this.canvasRotation=$e;var $g=$J._mainCanvas,$h=$g.source.style,$i=this._canvasTransform.identity(),$j=this._scaleMode,$k=$c/this.designWidth,$l=$d/this.designHeight,$m=this.designWidth,$n=this.designHeight,$o=$c,$p=$d,$q=$O.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,$j){case"noscale":$k=$l=1,$o=this.designWidth,$p=this.designHeight;break;case"showall":$k=$l=Math.min($k,$l),$m=$o=Math.round(this.designWidth*$k),$n=$p=Math.round(this.designHeight*$l);break;case"noborder":$k=$l=Math.max($k,$l),$o=Math.round(this.designWidth*$k),$p=Math.round(this.designHeight*$l);break;case"full":$k=$l=1,this._width=$m=$c,this._height=$n=$d;break;case"fixedwidth":$l=$k,this._height=$n=Math.round($d/$k);break;case"fixedheight":$k=$l,this._width=$m=Math.round($c/$l);break;case"fixedauto":$c/$d<this.designWidth/this.designHeight?($l=$k,this._height=$n=Math.round($d/$k)):($k=$l,this._width=$m=Math.round($c/$l))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,$m=$m+1&2147483646,$n=$n+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),$k*=this.scaleX,$l*=this.scaleY,1===$k&&1===$l?this.transform.identity():(this.transform.a=this._formatData($k/($o/$m)),this.transform.d=this._formatData($l/($p/$n)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),$g.size($m,$n),$F.changeWebGLSize($m,$n),$i.scale($o/$m/$q,$p/$n/$q),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=($c-$o)/$q:this.offset.x=.5*($c-$o)/$q,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=($d-$p)/$q:this.offset.y=.5*($d-$p)/$q,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),$i.translate(this.offset.x,this.offset.y),this.canvasDegree=0,$e&&("horizontal"===this._screenMode?($i.rotate(Math.PI/2),$i.translate($d/$q,0),this.canvasDegree=90):($i.rotate(-Math.PI/2),$i.translate(0,$c/$q),this.canvasDegree=-90)),$i.a=this._formatData($i.a),$i.d=this._formatData($i.d),$i.tx=this._formatData($i.tx),$i.ty=this._formatData($i.ty),$h.transformOrigin=$h.webkitTransformOrigin=$h.msTransformOrigin=$h.mozTransformOrigin=$h.oTransformOrigin="0px 0px 0px",$h.transform=$h.webkitTransform=$h.msTransform=$h.mozTransform=$h.oTransform="matrix("+$i.toString()+")",$i.translate(parseInt($h.left)||0,parseInt($h.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},$c._formatData=function($c){return Math.abs($c)<1e-6?0:Math.abs(1-$c)<.001?0<$c?1:-1:$c},$c.getMousePoint=function(){return $A.TEMP.setTo(this.mouseX,this.mouseY)},$c.repaint=function(){this._repaint=1},$c.parentRepaint=function(){},$c._loop=function(){return this.render($J.context,0,0),!0},$c._onmouseMove=function($c){this._mouseMoveTime=$O.now()},$c.getTimeFromFrameStart=function(){return $O.now()-this._frameStartTime},$c.render=function($c,$d,$e){if("sleep"===this._frameRate&&!$J.isConchApp){var $f=$O.now();if(!(1e3<=$f-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&($X.loopCount++,$q.instance.runEvent(),$z.timer._update()));this._frameStartTime=$f}if(this._renderCount++,$J.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=$O.now();var $g="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),$h=this._renderCount%2==0;if($X.renderSlow=!$g,$g||$h||$J.isConchApp){var $i;$X.loopCount++,$q.instance.runEvent(),$z.timer._update(),$F.update3DLoop();var $j=0,$k=0;if($J.isConchNode)for($j=0,$k=this._scenes.length;$j<$k;$j++)($i=this._scenes[$j])&&$i._updateSceneConch();else for($j=0,$k=this._scenes.length;$j<$k;$j++)($i=this._scenes[$j])&&$i._updateScene();if($J.isConchNode){var $l=$nc.CustomList;for($j=0,$k=$l.length;$j<$k;$j++){var $m=$l[$j];$m.customRender($m.customContext,0,0)}return}}$J.isConchNode||this.renderingEnabled&&($g||!$h||$J.isConchWebGL)&&($J.isWebGL?$J.WebGL.mainContext&&!$J.WebGL.mainContext.isContextLost()&&($c.clear(),$n.prototype.render.call(this,$c,$d,$e),$X._show&&$X._sp&&$X._sp.render($c,$d,$e),$F.clear(this._bgColor),$F.beginFlush(),$c.flush(),$F.endFinish(),$_.instance&&$_.getInstance().endDispose()):($F.clear(this._bgColor),$n.prototype.render.call(this,$c,$d,$e),$X._show&&$X._sp&&$X._sp.render($c,$d,$e)))}else this._renderCount%5==0&&($X.loopCount++,$q.instance.runEvent(),$z.timer._update())},$c._requestFullscreen=function(){var $c=$O.document.documentElement;$c.requestFullscreen?$c.requestFullscreen():$c.mozRequestFullScreen?$c.mozRequestFullScreen():$c.webkitRequestFullscreen?$c.webkitRequestFullscreen():$c.msRequestFullscreen&&$c.msRequestFullscreen()},$c._fullScreenChanged=function(){$z.stage.event("fullscreenchange")},$c.exitFullscreen=function(){var $c=$O.document;$c.exitFullscreen?$c.exitFullscreen():$c.mozCancelFullScreen?$c.mozCancelFullScreen():$c.webkitExitFullscreen&&$c.webkitExitFullscreen()},$m(0,$c,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),$m(0,$c,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),$m(0,$c,"frameRate",function(){return this._frameRate},function($c){if(this._frameRate=$c,$J.isConchApp)switch(this._frameRate){case"slow":$O.window.conch&&$O.window.conchConfig.setSlowFrame&&$O.window.conchConfig.setSlowFrame(!0);break;case"fast":$O.window.conch&&$O.window.conchConfig.setSlowFrame&&$O.window.conchConfig.setSlowFrame(!1);break;case"mouse":$O.window.conch&&$O.window.conchConfig.setMouseFrame&&$O.window.conchConfig.setMouseFrame(2e3);break;case"sleep":$O.window.conch&&$O.window.conchConfig.setLimitFPS&&$O.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),$m(0,$c,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),$m(0,$c,"width",$n.prototype._$get_width,function($c){this.designWidth=$c,$z.superSet($nc,this,"width",$c),$z.timer.callLater(this,this._changeCanvasSize)}),$m(0,$c,"alignH",function(){return this._alignH},function($c){this._alignH=$c,$z.timer.callLater(this,this._changeCanvasSize)}),$m(0,$c,"isFocused",function(){return this._isFocused}),$m(0,$c,"height",$n.prototype._$get_height,function($c){this.designHeight=$c,$z.superSet($nc,this,"height",$c),$z.timer.callLater(this,this._changeCanvasSize)}),$m(0,$c,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||$G.create()},$n.prototype._$set_transform),$m(0,$c,"isVisibility",function(){return this._isVisibility}),$m(0,$c,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),$m(0,$c,"scaleMode",function(){return this._scaleMode},function($c){this._scaleMode=$c,$z.timer.callLater(this,this._changeCanvasSize)}),$m(0,$c,"alignV",function(){return this._alignV},function($c){this._alignV=$c,$z.timer.callLater(this,this._changeCanvasSize)}),$m(0,$c,"bgColor",function(){return this._bgColor},function($c){this._bgColor=$c,this.conchModel&&this.conchModel.bgColor($c),$J.isWebGL&&($c?$i._wgColor=$S.create($c)._color:$O.onMiniGame||($i._wgColor=null)),$O.onLimixiu?$i._wgColor=$S.create($c)._color:$J.canvas.style.background=$c||"none"}),$m(0,$c,"mouseX",function(){return Math.round($q.instance.mouseX/this.clientScaleX)}),$m(0,$c,"mouseY",function(){return Math.round($q.instance.mouseY/this.clientScaleY)}),$m(0,$c,"screenMode",function(){return this._screenMode},function($c){this._screenMode=$c}),$m(0,$c,"visible",$n.prototype._$get_visible,function($c){this.visible!==$c&&($z.superSet($nc,this,"visible",$c),$J._mainCanvas.source.style.visibility=$c?"visible":"hidden")}),$m(0,$c,"fullScreenEnabled",null,function($c){var $d=$O.document,$e=$J.canvas;$c?($e.addEventListener("mousedown",this._requestFullscreen),$e.addEventListener("touchstart",this._requestFullscreen),$d.addEventListener("fullscreenchange",this._fullScreenChanged),$d.addEventListener("mozfullscreenchange",this._fullScreenChanged),$d.addEventListener("webkitfullscreenchange",this._fullScreenChanged),$d.addEventListener("msfullscreenchange",this._fullScreenChanged)):($e.removeEventListener("mousedown",this._requestFullscreen),$e.removeEventListener("touchstart",this._requestFullscreen),$d.removeEventListener("fullscreenchange",this._fullScreenChanged),$d.removeEventListener("mozfullscreenchange",this._fullScreenChanged),$d.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),$d.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),$i.SCALE_NOSCALE="noscale",$i.SCALE_EXACTFIT="exactfit",$i.SCALE_SHOWALL="showall",$i.SCALE_NOBORDER="noborder",$i.SCALE_FULL="full",$i.SCALE_FIXED_WIDTH="fixedwidth",$i.SCALE_FIXED_HEIGHT="fixedheight",$i.SCALE_FIXED_AUTO="fixedauto",$i.ALIGN_LEFT="left",$i.ALIGN_RIGHT="right",$i.ALIGN_CENTER="center",$i.ALIGN_TOP="top",$i.ALIGN_MIDDLE="middle",$i.ALIGN_BOTTOM="bottom",$i.SCREEN_NONE="none",$i.SCREEN_HORIZONTAL="horizontal",$i.SCREEN_VERTICAL="vertical",$i.FRAME_FAST="fast",$i.FRAME_SLOW="slow",$i.FRAME_MOUSE="mouse",$i.FRAME_SLEEP="sleep",$i.FRAME_MOUSE_THREDHOLD=2e3,$k($i,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),$i}($nc),$uc=(function($c){function $d(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,$d.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}$r($d,"laya.media.SoundNode",$nc);var $e=$d.prototype;$e._onParentChange=function(){this.target=this.parent},$e.play=function($c,$d){void 0===$c&&($c=1),isNaN($c)&&($c=1),this.url&&(this.stop(),this._channel=$E.playSound(this.url,$c,null,$d))},$e.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},$e._setPlayAction=function($c,$d,$e,$f){void 0===$f&&($f=!0),this[$e]&&$c&&($f?$c.on($d,this,this[$e]):$c.off($d,this,this[$e]))},$e._setPlayActions=function($c,$d,$e,$f){if(void 0===$f&&($f=!0),$c&&$d){var $g,$h=$d.split(","),$i=0;for($g=$h.length,$i=0;$i<$g;$i++)this._setPlayAction($c,$h[$i],$e,$f)}},$m(0,$e,"playEvent",null,function($c){(this._playEvents=$c)&&this._tar&&this._setPlayActions(this._tar,$c,"play")}),$m(0,$e,"target",null,function($c){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=$c,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),$m(0,$e,"stopEvent",null,function($c){(this._stopEvents=$c)&&this._tar&&this._setPlayActions(this._tar,$c,"stop")})}(),function($c){function $d(){this._src=null,this._onload=null,this._onerror=null,$d.__super.call(this)}$r($d,"laya.resource.FileBitmap",$qc);var $e=$d.prototype;return $m(0,$e,"src",function(){return this._src},function($c){this._src=$c}),$m(0,$e,"onload",null,function($c){}),$m(0,$e,"onerror",null,function($c){}),$d}()),$vc=function($c){function $e($c,$d){this._is2D=!1,$e.__super.call(this);var $f=this;if(this._source=this,"2D"===$c||"AUTO"===$c&&!$J.isWebGL){this._is2D=!0,this._source=$d||$O.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var $g=this;$g.getContext=function($c,$d){if($f._ctx)return $f._ctx;var $e=$f._ctx=$f._source.getContext($c,$d);return $e&&($e._canvas=$g,$J.isFlash||$O.onLimixiu||($e.size=function($c,$d){})),$e}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}$r($e,"laya.resource.HTMLCanvas",$qc);var $d=$e.prototype;return $d.clear=function(){this._ctx&&this._ctx.clear()},$d.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$d.release=function(){},$d._setContext=function($c){this._ctx=$c},$d.getContext=function($c,$d){return this._ctx?this._ctx:this._ctx=$e._createContext(this)},$d.getMemSize=function(){return 0},$d.size=function($c,$d){(this._w!=$c||this._h!=$d||this._source&&(this._source.width!=$c||this._source.height!=$d))&&(this._w=$c,this._h=$d,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size($c,$d),this._source&&(this._source.height=$d,this._source.width=$c))},$d.getCanvas=function(){return this._source},$d.toBase64=function($c,$d,$e){if(this._source)if($J.isConchApp&&this._source.toBase64)this._source.toBase64($c,$d,$e);else{var $f=this._source.toDataURL($c,$d);$e.call(this,$f)}},$m(0,$d,"context",function(){return this._ctx}),$m(0,$d,"asBitmap",null,function($c){}),$e.create=function($c,$d){return new $e($c,$d)},$e.TYPE2D="2D",$e.TYPE3D="3D",$e.TYPEAUTO="AUTO",$e._createContext=null,$e}(),$wc=(function($c){function $k($c,$d,$e,$f,$g,$h,$i,$j){throw $k.__super.call(this),new Error("不允许new！")}$r($k,"laya.resource.HTMLSubImage",$qc),$k.create=function($c,$d,$e,$f,$g,$h,$i,$j){return void 0===$j&&($j=!1),new $k($c,$d,$e,$f,$g,$h,$i,$j)}}(),function($c){function $n(){this._frames=null,this._url=null,$n.__super.call(this),this._setControlNode(this)}$r($n,"laya.display.Animation",$c);var $d=$n.prototype;$d.destroy=function($c){void 0===$c&&($c=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,$c),this._frames=null,this._labels=null},$d.play=function($c,$d,$e,$f){void 0===$c&&($c=0),void 0===$d&&($d=!0),void 0===$e&&($e=""),void 0===$f&&($f=!0),$e&&this._setFramesFromCache($e,$f),this._isPlaying=!0,this.index="string"==typeof $c?this._getFrameByLabel($c):$c,this.loop=$d,this._actionName=$e,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$d._setFramesFromCache=function($c,$d){var $e;return void 0===$d&&($d=!1),this._url&&($c=this._url+"#"+$c),$c&&$n.framesMap[$c]?(($e=$n.framesMap[$c])instanceof Array?(this._frames=$n.framesMap[$c],this._count=this._frames.length):($e.nodeRoot&&($n.framesMap[$c]=this._parseGraphicAnimationByData($e),$e=$n.framesMap[$c]),this._frames=$e.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=$e.interval),this._labels=this._copyLabels($e.labels)),!0):($d&&console.log("ani not found:",$c),!1)},$d._copyLabels=function($c){if(!$c)return null;var $d,$e;for($e in $d={},$c)$d[$e]=$$.copyArray([],$c[$e]);return $d},$d._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&$c.prototype._frameLoop.call(this)},$d._displayToIndex=function($c){this._frames&&(this.graphics=this._frames[$c])},$d.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},$d.loadImages=function($c,$d){return void 0===$d&&($d=""),this._url="",this._setFramesFromCache($d)||(this.frames=$n.framesMap[$d]?$n.framesMap[$d]:$n.createFrames($c,$d)),this},$d.loadAtlas=function($d,$e,$f){void 0===$f&&($f=""),this._url="";var $g=this;function $c($c){$d===$c&&($g.frames=$n.framesMap[$f]?$n.framesMap[$f]:$n.createFrames($d,$f),$e&&$e.run())}return $g._setFramesFromCache($f)||($jc.getAtlas($d)?$c($d):$z.loader.load($d,$u.create(null,$c,[$d]),null,"atlas")),this},$d.loadAnimation=function($c,$d,$e){this._url=$c;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,$d&&$d.run()):!$e||$jc.getAtlas($e)?this._loadAnimationData($c,$d,$e):$z.loader.load($e,$u.create(this,this._loadAnimationData,[$c,$d,$e]),null,"atlas"),this},$d._loadAnimationData=function($j,$k,$c){var $l=this;if(!$c||$jc.getAtlas($c)){var $m=this;$jc.getRes($j)?$d($j):$z.loader.load($j,$u.create(null,$d,[$j]),null,"json"),$jc.clearRes($j)}else console.warn("atlas load fail:"+$c);function $d($c){if($jc.getRes($c)&&$j===$c){var $d;if($n.framesMap[$j+"#"])$m._setFramesFromCache($l._actionName,!0),$l.index=0,$l._checkResumePlaying();else{var $e=$m._parseGraphicAnimation($jc.getRes($j));if(!$e)return;var $f,$g=$e.animationList,$h=0,$i=$g.length;for($h=0;$h<$i;$h++)$d=$g[$h],$n.framesMap[$j+"#"+$d.name]=$d,$f||($f=$d);$f&&($n.framesMap[$j+"#"]=$f,$m._setFramesFromCache($l._actionName,!0),$l.index=0),$l._checkResumePlaying()}$k&&$k.run()}}},$d._parseGraphicAnimation=function($c){return $zc.parseAnimationData($c)},$d._parseGraphicAnimationByData=function($c){return $zc.parseAnimationByData($c)},$m(0,$d,"frames",function(){return this._frames},function($c){(this._frames=$c)&&(this._count=$c.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),$m(0,$d,"autoPlay",null,function($c){$c?this.play():this.stop()}),$m(0,$d,"source",null,function($c){-1<$c.indexOf(".ani")?this.loadAnimation($c):-1<$c.indexOf(".json")||-1<$c.indexOf("als")||-1<$c.indexOf("atlas")?this.loadAtlas($c):this.loadImages($c.split(","))}),$m(0,$d,"autoAnimation",null,function($c){this.play(0,!0,$c,!1)}),$n.createFrames=function($c,$d){var $e,$f,$g=0,$h=0;if("string"==typeof $c){var $i=$jc.getAtlas($c);if($i&&$i.length)for($e=[],$g=0,$h=$i.length;$g<$h;$g++)($f=new $F.createGraphics).drawTexture($jc.getRes($i[$g]),0,0),$e.push($f)}else if($c instanceof Array)for($e=[],$g=0,$h=$c.length;$g<$h;$g++)($f=new $F.createGraphics).loadImage($c[$g],0,0),$e.push($f);return $d&&($n.framesMap[$d]=$e),$e},$n.clearCache=function($c){var $d,$e=$n.framesMap,$f=$c+"#";for($d in $e)$d!==$c&&0!=$d.indexOf($f)||delete $n.framesMap[$d]},$n.framesMap={}}($rc),function($c){function $h(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,$h.__super.call(this),null==$h._sortIndexFun&&($h._sortIndexFun=$y.sortByKey("index",!1,!0))}$r($h,"laya.display.FrameAnimation",$c);var $d=$h.prototype;return $d._setUp=function($c,$d){this._labels=null,this._animationNewFrames=null,this._targetDic=$c,this._animationData=$d,this.interval=1e3/$d.frameRate,$d.parsed?(this._count=$d.count,this._labels=$d.labels,this._animationNewFrames=$d.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),$d.parsed=!0,$d.labels=this._labels,$d.count=this._count,$d.animationNewFrames=this._animationNewFrames},$d.clear=function(){$c.prototype.clear.call(this),this._targetDic=null,this._animationData=null},$d._displayToIndex=function($c){if(this._animationData){$c<0&&($c=0),$c>this._count&&($c=this._count);var $d=this._animationData.nodes,$e=0,$f=$d.length;for($e=0;$e<$f;$e++)this._displayNodeToFrame($d[$e],$c)}},$d._displayNodeToFrame=function($c,$d,$e){$e||($e=this._targetDic);var $f=$e[$c.target];if($f){var $g,$h,$i,$j=$c.frames,$k=$c.keys,$l=0,$m=$k.length;for($l=0;$l<$m;$l++)$i=($h=$j[$g=$k[$l]]).length>$d?$h[$d]:$h[$h.length-1],$f[$g]=$i}},$d._calculateDatas=function(){if(this._animationData){var $c,$d=this._animationData.nodes,$e=0,$f=$d.length;for($e=this._count=0;$e<$f;$e++)$c=$d[$e],this._calculateNodeKeyFrames($c);this._count+=1}},$d._calculateNodeKeyFrames=function($c){var $d,$e,$f=$c.keyframes,$g=$c.target;for($d in $c.frames||($c.frames={}),$c.keys?$c.keys.length=0:$c.keys=[],$c.initValues||($c.initValues={}),$f)$e=$f[$d],$c.frames[$d]||($c.frames[$d]=[]),this._targetDic&&this._targetDic[$g]&&($c.initValues[$d]=this._targetDic[$g][$d]),$e.sort($h._sortIndexFun),$c.keys.push($d),this._calculateNodePropFrames($e,$c.frames[$d],$d,$g)},$d.resetToInitState=function(){if(this._targetDic&&this._animationData){var $c,$d,$e=this._animationData.nodes,$f=0,$g=$e.length;for($f=0;$f<$g;$f++)if($d=($c=$e[$f]).initValues){var $h,$i=this._targetDic[$c.target];if($i)for($h in $d)$i[$h]=$d[$h]}}},$d._calculateNodePropFrames=function($c,$d,$e,$f){var $g=0,$h=$c.length-1;if(0<$h){for($d.length=$c[$h].index+1,$g=0;$g<$h;$g++)this._dealKeyFrame($c[$g]),this._calculateFrameValues($c[$g],$c[$g+1],$d);this._dealKeyFrame($c[$g])}0==$h&&($d[$c[0].index]=$c[0].value,this._animationNewFrames&&(this._animationNewFrames[$c[0].index]=!0))},$d._dealKeyFrame=function($c){$c.label&&""!=$c.label&&this.addLabel($c.label,$c.index)},$d._calculateFrameValues=function($c,$d,$e){var $f,$g=0,$h=$c.index,$i=$d.index,$j=$c.value,$k=$d.value-$c.value,$l=$i-$h;if($i>this._count&&(this._count=$i),$c.tween)for(null==($f=$U[$c.tweenMethod])&&($f=$U.linearNone),$g=$h;$g<$i;$g++)$e[$g]=$f($g-$h,$j,$k,$l),this._animationNewFrames&&(this._animationNewFrames[$g]=!0);else for($g=$h;$g<$i;$g++)$e[$g]=$j;this._animationNewFrames&&(this._animationNewFrames[$c.index]=!0,this._animationNewFrames[$d.index]=!0),$e[$d.index]=$d.value},$h._sortIndexFun=null,$h}($rc)),$xc=function($d){function $g(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",$g.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=$sc.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}$r($g,"laya.display.Input",$d);var $c=$g.prototype;return $c.setSelection=function($c,$d){this.focus=!0,laya.display.Input.inputElement.selectionStart=$c,laya.display.Input.inputElement.selectionEnd=$d},$c._onUnDisplay=function($c){this.focus=!1},$c._onMouseDown=function($c){this.focus=!0},$c._syncInputTransform=function(){var $c=this.nativeInput,$d=$$.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),$e=this._width-this.padding[1]-this.padding[3],$f=this._height-this.padding[0]-this.padding[2];$J.isConchApp?($c.setScale($d.scaleX,$d.scaleY),$c.setSize($e,$f),$c.setPos($d.x,$d.y)):($g.inputContainer.style.transform=$g.inputContainer.style.webkitTransform="scale("+$d.scaleX+","+$d.scaleY+") rotate("+$z.stage.canvasDegree+"deg)",$c.style.width=$e+"px",$c.style.height=$f+"px",$g.inputContainer.style.left=$d.x+"px",$g.inputContainer.style.top=$d.y+"px")},$c.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},$c._setInputMethod=function(){$g.input.parentElement&&$g.inputContainer.removeChild($g.input),$g.area.parentElement&&$g.inputContainer.removeChild($g.area),$g.inputElement=this._multiline?$g.area:$g.input,$g.inputContainer.appendChild($g.inputElement),$sc.RightToLeft&&($g.inputElement.style.direction="rtl")},$c._focusIn=function(){laya.display.Input.isInputting=!0;var $c=this.nativeInput;this._focus=!0;var $d=$c.style;$d.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),$c.readOnly=!this._editable,$J.isConchApp&&($c.setType(this._type),$c.setForbidEdit(!this._editable)),$c.maxLength=this._maxChars;this.padding;if($c.type=this._type,$c.value=this._content,$c.placeholder=this._prompt,$z.stage.off("keydown",this,this._onKeyDown),$z.stage.on("keydown",this,this._onKeyDown),($z.stage.focus=this).event("focus"),$O.onPC&&$c.focus(),!$O.onMiniGame){this._text;this._text=null}this.typeset(),$c.setColor(this._originColor),$c.setFontSize(this.fontSize),$c.setFontFace($O.onIPhone&&$sc._fontFamilyMap[this.font]||this.font),$J.isConchApp&&$c.setMultiAble&&$c.setMultiAble(this._multiline),$d.lineHeight=this.leading+this.fontSize+"px",$d.fontStyle=this.italic?"italic":"normal",$d.fontWeight=this.bold?"bold":"normal",$d.textAlign=this.align,$d.padding="0 0",this._syncInputTransform(),!$J.isConchApp&&$O.onPC&&$z.timer.frameLoop(1,this,this._syncInputTransform)},$c._setPromptColor=function(){($g.promptStyleDOM=$O.getElementById("promptStyle"))||(($g.promptStyleDOM=$O.createElement("style")).setAttribute("id","promptStyle"),$O.document.head.appendChild($g.promptStyleDOM)),$g.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},$c._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?($z.superSet($sc,this,"text",this._content),$z.superSet($sc,this,"color",this._originColor)):($z.superSet($sc,this,"text",this._prompt),$z.superSet($sc,this,"color",this._promptColor)),$z.stage.off("keydown",this,this._onKeyDown),$z.stage.focus=null,this.event("blur"),$J.isConchApp&&this.nativeInput.blur(),$O.onPC&&$z.timer.clear(this,this._syncInputTransform)},$c._onKeyDown=function($c){13===$c.keyCode&&($O.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},$c.changeText=function($c){this._content=$c,this._focus?(this.nativeInput.value=$c||"",this.event("change")):$d.prototype.changeText.call(this,$c)},$m(0,$c,"color",$d.prototype._$get_color,function($c){this._focus&&this.nativeInput.setColor($c),$z.superSet($sc,this,"color",this._content?$c:this._promptColor),this._originColor=$c}),$m(0,$c,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function($c){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),$m(0,$c,"multiline",function(){return this._multiline},function($c){this._multiline=$c,this.valign=$c?"top":"middle"}),$m(0,$c,"maxChars",function(){return this._maxChars},function($c){$c<=0&&($c=1e5),this._maxChars=$c}),$m(0,$c,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function($c){$z.superSet($sc,this,"color",this._originColor),$c+="",this._focus?(this.nativeInput.value=$c||"",this.event("change")):(this._multiline||($c=$c.replace(/\r?\n/g,"")),(this._content=$c)?$z.superSet($sc,this,"text",$c):($z.superSet($sc,this,"text",this._prompt),$z.superSet($sc,this,"color",this.promptColor)))}),$m(0,$c,"nativeInput",function(){return this._multiline?$g.area:$g.input}),$m(0,$c,"prompt",function(){return this._prompt},function($c){!this._text&&$c&&$z.superSet($sc,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?$z.superSet($sc,this,"text",this._text==this._prompt?$c:this._text):$z.superSet($sc,this,"text",$c),this._prompt=$sc.langPacks&&$sc.langPacks[$c]?$sc.langPacks[$c]:$c}),$m(0,$c,"focus",function(){return this._focus},function($c){var $d=this.nativeInput;this._focus!==$c&&($c?($d.target?$d.target._focusOut():this._setInputMethod(),($d.target=this)._focusIn()):($d.target=null,this._focusOut(),$O.document.body.scrollTop=0,$d.blur(),$J.isConchApp?$d.setPos(-1e4,-1e4):$g.inputContainer.contains($d)&&$g.inputContainer.removeChild($d)))}),$m(0,$c,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function($c){$c?(-1<($c="[^"+$c+"]").indexOf("^^")&&($c=$c.replace("^^","")),this._restrictPattern=new RegExp($c,"g")):this._restrictPattern=null}),$m(0,$c,"editable",function(){return this._editable},function($c){this._editable=$c,$J.isConchApp&&$g.input.setForbidEdit(!$c)}),$m(0,$c,"promptColor",function(){return this._promptColor},function($c){this._promptColor=$c,this._content||$z.superSet($sc,this,"color",$c)}),$m(0,$c,"type",function(){return this._type},function($c){this._getCSSStyle().password="password"==$c,this._type=$c,$J.isConchApp&&this.nativeInput.setType($c)}),$m(0,$c,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function($c){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),$m(0,$c,"asPassword",function(){return this._getCSSStyle().password},function($c){this._getCSSStyle().password=$c,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),$g.__init__=function(){$g._createInputElement(),$O.onMobile&&$J.canvas.addEventListener($g.IOS_IFRAME?$O.onMiniGame?"touchend":"click":"touchend",$g._popupInputMethod)},$g._popupInputMethod=function($c){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},$g._createInputElement=function(){$g._initInput($g.area=$O.createElement("textarea")),$g._initInput($g.input=$O.createElement("input")),($g.inputContainer=$O.createElement("div")).style.position="absolute",$g.inputContainer.style.zIndex=1e5,$O.container.appendChild($g.inputContainer),$g.inputContainer.setPos=function($c,$d){$g.inputContainer.style.left=$c+"px",$g.inputContainer.style.top=$d+"px"}},$g._initInput=function($d){var $c=$d.style;$c.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",$c.resize="none",$c.backgroundColor="transparent",$c.border="none",$c.outline="none",$c.zIndex=1,$d.addEventListener("input",$g._processInputting),$d.addEventListener("mousemove",$g._stopEvent),$d.addEventListener("mousedown",$g._stopEvent),$d.addEventListener("touchmove",$g._stopEvent),$d.setFontFace=function($c){$d.style.fontFamily=$c},$J.isConchApp||($d.setColor=function($c){$d.style.color=$c},$d.setFontSize=function($c){$d.style.fontSize=$c+"px"})},$g._processInputting=function($c){var $d=laya.display.Input.inputElement.target;if($d){var $e=laya.display.Input.inputElement.value;$d._restrictPattern&&($e=$e.replace(/\u2006|\x27/g,""),$d._restrictPattern.test($e)&&($e=$e.replace($d._restrictPattern,""),laya.display.Input.inputElement.value=$e)),$d._text=$e,$d.event("input")}},$g._stopEvent=function($c){"touchmove"==$c.type&&$c.preventDefault(),$c.stopPropagation&&$c.stopPropagation()},$g.TYPE_TEXT="text",$g.TYPE_PASSWORD="password",$g.TYPE_EMAIL="email",$g.TYPE_URL="url",$g.TYPE_NUMBER="number",$g.TYPE_RANGE="range",$g.TYPE_DATE="date",$g.TYPE_MONTH="month",$g.TYPE_WEEK="week",$g.TYPE_TIME="time",$g.TYPE_DATE_TIME="datetime",$g.TYPE_DATE_TIME_LOCAL="datetime-local",$g.TYPE_SEARCH="search",$g.input=null,$g.area=null,$g.inputElement=null,$g.inputContainer=null,$g.confirmButton=null,$g.promptStyleDOM=null,$g.inputHeight=45,$g.isInputting=!1,$g.stageMatrix=null,$k($g,["IOS_IFRAME",function(){return this.IOS_IFRAME=$O.onIOS&&$O.window.top!=$O.window.self}]),$g}($sc),$yc=function($c){function $e($c,$d){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,$e.__super.call(this),$c&&this._init_($c,$d)}$r($e,"laya.resource.HTMLImage",$uc);var $d=$e.prototype;return $d._init_=function($c,$d){this._src=$c,this._source=new $O.window.Image,$d&&($d.onload&&(this.onload=$d.onload),$d.onerror&&(this.onerror=$d.onerror),$d.onCreate&&$d.onCreate(this)),0!=$c.indexOf("data:image")&&(this._source.crossOrigin=""),$c&&(this._source.src=$c)},$d.recreateResource=function(){var $c=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var $d=this;this._source=new $O.window.Image,this._source.crossOrigin="",this._source.onload=function(){if($d._needReleaseAgain)return $d._needReleaseAgain=!1,$d._source.onload=null,void($d._source=null);$d._source.onload=null,$d.memorySize=$c._w*$c._h*4,$d._recreateLock=!1,$d.completeCreate()},this._source.src=this._src}},$d.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},$d.onresize=function(){this._w=this._source.width,this._h=this._source.height},$m(0,$d,"onload",null,function($c){var $d=this;this._onload=$c,this._source&&(this._source.onload=null!=this._onload?function(){$d.onresize(),$d._onload()}:null)}),$m(0,$d,"onerror",null,function($c){var $d=this;this._onerror=$c,this._source&&(this._source.onerror=null!=this._onerror?function(){$d._onerror()}:null)}),$m(0,$d,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($c){this._enableMerageInAtlas=$c,$J.isConchApp&&this._source&&(this._source.enableMerageInAtlas=$c)}),$e.create=function($c,$d){return new $e($c,$d)},$e}(),$zc=(function($h){function $c(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,$c.__super.call(this)}$r($c,"laya.display.EffectAnimation",$h);var $d=$c.prototype;$d._onOtherBegin=function($c){$c!=this&&this.stop()},$d.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},$d._onPlayAction=function(){this.play(0,!1)},$d.play=function($c,$d,$e,$f){void 0===$c&&($c=0),void 0===$d&&($d=!0),void 0===$e&&($e=""),void 0===$f&&($f=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,$c,$d,$e,$f))},$d._recordInitData=function(){if(this._aniKeys){var $c,$d,$e=0;for($c=this._aniKeys.length,$e=0;$e<$c;$e++)$d=this._aniKeys[$e],this._initData[$d]=this._target[$d]}},$d._displayToIndex=function($c){if(this._animationData){$c<0&&($c=0),$c>this._count&&($c=this._count);var $d=this._animationData.nodes,$e=0,$f=$d.length;for($f=1<$f?1:$f,$e=0;$e<$f;$e++)this._displayNodeToFrame($d[$e],$c)}},$d._displayNodeToFrame=function($c,$d,$e){if(this._target){var $f;$f=this._target;var $g,$h,$i,$j,$k=$c.frames,$l=$c.keys,$m=0,$n=$l.length;$j=$c.secondFrames;var $o,$p,$q,$r,$s=0;for($m=0;$m<$n;$m++)$h=$k[$g=$l[$m]],$i=-1==($s=$j[$g])?this._initData[$g]:$d<$s?($q=($p=$c.keyframes[$g])[0]).tween?(null==($o=$U[$q.tweenMethod])&&($o=$U.linearNone),$r=$p[1],$o($d,this._initData[$g],$r.value-this._initData[$g],$r.index)):this._initData[$g]:$h.length>$d?$h[$d]:$h[$h.length-1],$f[$g]=$i}},$d._calculateNodeKeyFrames=function($c){$h.prototype._calculateNodeKeyFrames.call(this,$c);var $d,$e,$f,$g=$c.keyframes;$c.target;for($d in $f={},$c.secondFrames=$f,$g)($e=$g[$d]).length<=1?$f[$d]=-1:$f[$d]=$e[1].index},$m(0,$d,"target",function(){return this._target},function($c){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=$c,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),$m(0,$d,"playEvent",null,function($c){(this._playEvents=$c)&&this.addEvent()}),$m(0,$d,"effectData",null,function($c){var $d;$c&&(($d=$c.animations)&&$d[0]&&(this._setUp({},$d[0]),$d[0].nodes&&$d[0].nodes[0]&&(this._aniKeys=$d[0].nodes[0].keys)))}),$m(0,$d,"effectClass",null,function($c){var $d,$e;(this._effectClass=$R.getClass($c),this._effectClass)&&(($d=this._effectClass.uiView)&&($e=$d.animations)&&$e[0]&&(this._setUp({},$e[0]),$e[0].nodes&&$e[0].nodes[0]&&(this._aniKeys=$e[0].nodes[0].keys)))}),$c.EffectAnimationBegin="effectanimationbegin"}($wc),function($d){var $D;function $E(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,$E.__super.call(this)}$r($E,"laya.utils.GraphicAnimation",$d);var $c=$E.prototype;return $c._parseNodeList=function($c){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[$c.compId]=$c.props,$c.compId&&this._nodeList.push($c.compId);var $d=$c.child;if($d){var $e=0,$f=$d.length;for($e=0;$e<$f;$e++)this._parseNodeList($d[$e])}},$c._calGraphicData=function($c){var $d;if(this._setUp(null,$c),this._createGraphicData(),this._nodeIDAniDic)for($d in this._nodeIDAniDic)this._nodeIDAniDic[$d]=null},$c._createGraphicData=function(){var $c,$d=[],$e=0,$f=this.count,$g=this._animationNewFrames;for($g||($g=[]),$e=0;$e<$f;$e++)!$g[$e]&&$c||($c=this._createFrameGraphic($e)),$d.push($c);this._gList=$d},$c._createFrameGraphic=function($c){var $d=$F.createGraphics();return $E._rootMatrix||($E._rootMatrix=new $G),this._updateNodeGraphic(this._rootNode,$c,$E._rootMatrix,$d),$d},$c._updateNodeGraphic=function($c,$d,$e,$f,$g){var $h;void 0===$g&&($g=1);var $i,$j,$k,$l=($h=this._nodeGDic[$c.compId]=this._getNodeGraphicData($c.compId,$d,this._nodeGDic[$c.compId])).alpha*$g;if(!($l<.01)&&($h.resultTransform||($h.resultTransform=$G.create()),$i=$h.resultTransform,$G.mul($h.transform,$e,$i),$h.skin&&($j=this._getTextureByUrl($h.skin))&&($i._checkTransform()?($f.drawTexture($j,0,0,$h.width,$h.height,$i,$l),$h.resultTransform=null):$f.drawTexture($j,$i.tx,$i.ty,$h.width,$h.height,null,$l)),$k=$c.child)){var $m,$n=0;for($m=$k.length,$n=0;$n<$m;$n++)this._updateNodeGraphic($k[$n],$d,$i,$f,$l)}},$c._updateNoChilds=function($c,$d){if($c.skin){var $e=this._getTextureByUrl($c.skin);if($e){var $f=$c.transform;$f._checkTransform();!$f.bTransform?$d.drawTexture($e,$f.tx,$f.ty,$c.width,$c.height,null,$c.alpha):$d.drawTexture($e,0,0,$c.width,$c.height,$f.clone(),$c.alpha)}}},$c._updateNodeGraphic2=function($c,$d,$e){var $f;if($f=this._nodeGDic[$c.compId]=this._getNodeGraphicData($c.compId,$d,this._nodeGDic[$c.compId]),$c.child){var $g=$f.transform;$g._checkTransform();var $h,$i;$i=($h=!$g.bTransform)&&(0!=$g.tx||0!=$g.ty);var $j,$k,$l;if(($j=$g.bTransform||1!=$f.alpha)&&$e.save(),1!=$f.alpha&&$e.alpha($f.alpha),$h?$i&&$e.translate($g.tx,$g.ty):$e.transform($g.clone()),$k=$c.child,$f.skin&&($l=this._getTextureByUrl($f.skin))&&$e.drawTexture($l,0,0,$f.width,$f.height),$k){var $m,$n=0;for($m=$k.length,$n=0;$n<$m;$n++)this._updateNodeGraphic2($k[$n],$d,$e)}$j?$e.restore():$h?$i&&$e.translate(-$g.tx,-$g.ty):$e.transform($g.clone().invert())}else this._updateNoChilds($f,$e)},$c._calculateNodeKeyFrames=function($c){$d.prototype._calculateNodeKeyFrames.call(this,$c),this._nodeIDAniDic[$c.target]=$c},$c.getNodeDataByID=function($c){return this._nodeIDAniDic[$c]},$c._getParams=function($c,$d,$e,$f){var $g=$E._temParam;$g.length=$d.length;var $h=0,$i=$d.length;for($h=0;$h<$i;$h++)$g[$h]=this._getObjVar($c,$d[$h][0],$e,$d[$h][1],$f);return $g},$c._getObjVar=function($c,$d,$e,$f,$g){if($c.hasOwnProperty($d)){var $h=$c[$d];if($e>=$h.length&&($e=$h.length-1),null!=$c[$d][$e])return $c[$d][$e]}return $g.hasOwnProperty($d)?$g[$d]:$f},$c._getNodeGraphicData=function($c,$d,$e){$e||($e=$D.create()),$e.transform?$e.transform.identity():$e.transform=$G.create();var $f=this.getNodeDataByID($c);if(!$f)return $e;var $g,$h,$i=$f.frames,$j=this._getParams($i,$E._drawTextureCmd,$d,this._nodeDefaultProps[$c]),$k=$j[0],$l=NaN,$m=NaN,$n=$j[5],$o=$j[6],$p=$j[13],$q=$j[14],$r=$j[7],$s=$j[8],$t=$j[9],$u=$j[11],$v=$j[12];$l=$j[3],$m=$j[4],0!=$l&&0!=$m||($k=null),-1==$l&&($l=0),-1==$m&&($m=0),$e.skin=$k,$e.width=$l,$e.height=$m,$k&&(($g=this._getTextureByUrl($k))?($l||($l=$g.sourceWidth),$m||($m=$g.sourceHeight)):console.warn("lost skin:",$k,",you may load pics first")),$e.alpha=$j[10],$h=$e.transform,0!=$p&&($n=$p*$l),0!=$q&&($o=$q*$m),0==$n&&0==$o||$h.translate(-$n,-$o);var $w=null;if($t||1!==$r||1!==$s||$u||$v){($w=$E._tempMt).identity(),$w.bTransform=!0;var $x=.0174532922222222*($t-$u),$y=.0174532922222222*($t+$v),$z=Math.cos($y),$A=Math.sin($y),$B=Math.sin($x),$C=Math.cos($x);$w.a=$r*$z,$w.b=$r*$A,$w.c=-$s*$B,$w.d=$s*$C,$w.tx=$w.ty=0}return $w&&($h=$G.mul($h,$w,$h)),$h.translate($j[1],$j[2]),$e},$c._getTextureByUrl=function($c){return $jc.getRes($c)},$c.setAniData=function($c,$d){if($c.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$c,this._parseNodeList($c);var $e,$f={},$g=[],$h=$c.animations,$i=0,$j=$h.length;for($i=0;$i<$j;$i++)if($e=$h[$i],this._labels=null,(!$d||$d==$e.name)&&$e){try{this._calGraphicData($e)}catch($c){console.warn("parse animation fail:"+$e.name+",empty animation created"),this._gList=[]}var $k={};$k.interval=1e3/$e.frameRate,$k.frames=this._gList,$k.labels=this._labels,$k.name=$e.name,$g.push($k),$f[$e.name]=$k}this.animationList=$g,this.animationDic=$f}$E._temParam.length=0},$c.parseByData=function($c){var $d,$e;$d=$c.nodeRoot,$e=$c.aniO,delete $c.nodeRoot,delete $c.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$d,this._parseNodeList($d),this._labels=null;try{this._calGraphicData($e)}catch($c){console.warn("parse animation fail:"+$e.name+",empty animation created"),this._gList=[]}var $f=$c;return $f.interval=1e3/$e.frameRate,$f.frames=this._gList,$f.labels=this._labels,$f.name=$e.name,$f},$c.setUpAniData=function($c){if($c.animations){var $d,$e={},$f=[],$g=$c.animations,$h=0,$i=$g.length;for($h=0;$h<$i;$h++)if($d=$g[$h]){var $j={};$j.name=$d.name,$j.aniO=$d,$j.nodeRoot=$c,$f.push($j),$e[$d.name]=$j}this.animationList=$f,this.animationDic=$e}},$c._clear=function(){var $c,$d;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for($c in this._nodeGDic)($d=this._nodeGDic[$c])&&$d.recover();this._nodeGDic=null},$E.parseAnimationByData=function($c){var $d;return $E._I||($E._I=new $E),$d=$E._I.parseByData($c),$E._I._clear(),$d},$E.parseAnimationData=function($c){var $d;return $E._I||($E._I=new $E),$E._I.setUpAniData($c),($d={}).animationList=$E._I.animationList,$d.animationDic=$E._I.animationDic,$E._I._clear(),$d},$E._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],$E._temParam=[],$E._I=null,$E._rootMatrix=null,$k($E,["_tempMt",function(){return this._tempMt=new $G}]),$E.__init$=function(){$D=function(){function $c(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return $r($c,""),$c.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),$W.recover("GraphicNode",this)},$c.create=function(){return $W.getItemByClass("GraphicNode",$c)},$c}()},$E}($wc));$z.__init([$l,$kc,$J,$O,$Y,$C,$c,$zc])}(window,document,Laya),function($c,$d,$e){$e.un,$e.uns,$e.static;var $f=$e.class;$e.getset,$e.__newvec;new(function(){function $c(){}return $f($c,"LayaMain"),$c}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($c,$d){"use strict";for(var $e in Object.defineProperty($d,"__esModule",{value:!0}),Laya){var $f=Laya[$e];$f&&$f.__isclass&&($d[$e]=$f)}}),function($c,$d,$y){$y.un,$y.uns;var $i=$y.static,$o=$y.class,$f=$y.getset,$h=$y.__newvec,$m=laya.maths.Arith,$n=laya.maths.Bezier,$e=laya.resource.Bitmap,$p=laya.utils.Browser,$k=laya.utils.Byte,$q=laya.utils.Color,$z=(laya.filters.ColorFilter,$y.Config),$g=laya.resource.Context,$A=(laya.events.Event,laya.filters.Filter),$j=laya.display.Graphics,$l=laya.resource.HTMLCanvas,$r=(laya.utils.HTMLChar,laya.resource.HTMLImage),$s=laya.resource.HTMLSubImage,$B=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),$C=laya.maths.Point,$D=laya.maths.Rectangle,$t=laya.renders.Render,$u=(laya.renders.RenderContext,laya.renders.RenderSprite),$v=laya.resource.Resource,$w=laya.resource.ResourceManager,$x=laya.utils.RunDriver,$E=laya.display.Sprite,$F=laya.display.Stage,$G=laya.utils.Stat,$H=laya.utils.StringKey,$I=(laya.display.css.Style,laya.system.System),$J=laya.display.Text,$K=laya.resource.Texture,$L=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),$M=laya.utils.VectorGraphManager;laya.utils.WordText;$y.interface("laya.webgl.shapes.IShape"),$y.interface("laya.webgl.submit.ISubmit"),$y.interface("laya.webgl.text.ICharSegment"),$y.interface("laya.webgl.canvas.save.ISaveData"),$y.interface("laya.webgl.resource.IMergeAtlasBitmap"),$y.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var $N=function(){function $c(){}$o($c,"laya.filters.webgl.FilterActionGL");var $d=$c.prototype;return $y.imps($d,{"laya.filters.IFilterActionGL":!0}),$d.setValue=function($c){},$d.setValueMix=function($c){},$d.apply3d=function($c,$d,$e,$f,$g){return null},$d.apply=function($c){return null},$f(0,$d,"typeMix",function(){return 0}),$c}(),$O=function(){function $c(){}return $o($c,"laya.webgl.shader.ShaderValue"),$c}(),$P=function(){var $f,$g;function $c($c,$d,$e){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new $g,void 0===$c&&($c=0),void 0===$d&&($d=0),void 0===$e&&($e=0),this._cells=null,this._rowInfo=null,this._init($c,$d),this._atlasID=$e}$o($c,"laya.webgl.atlas.AtlasGrid");var $d=$c.prototype;return $d.getAltasID=function(){return this._atlasID},$d.setAltasID=function($c){0<=$c&&(this._atlasID=$c)},$d.addTex=function($c,$d,$e){var $f=this._get($d,$e);return 0==$f.ret||(this._fill($f.x,$f.y,$d,$e,$c),this._texCount++),$f},$d._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},$d._init=function($c,$d){if(this._width=$c,this._height=$d,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=$h(this._height);for(var $e=0;$e<this._height;$e++)this._rowInfo[$e]=new $f;return this._clear(),!0},$d._get=function($c,$d){var $e=new $R;if($c>=this._failSize.width&&$d>=this._failSize.height)return $e;for(var $f=-1,$g=-1,$h=this._width,$i=this._height,$j=this._cells,$k=0;$k<$i;$k++)if(!(this._rowInfo[$k].spaceCount<$c))for(var $l=0;$l<$h;){var $m=3*($k*$h+$l);if(0!=$j[$m]||$j[1+$m]<$c||$j[2+$m]<$d)$l+=$j[1+$m];else{$f=$l,$g=$k;for(var $n=0;$n<$c;$n++)if($j[3*$n+$m+2]<$d){$f=-1;break}if(!($f<0))return $e.ret=!0,$e.x=$f,$e.y=$g,$e;$l+=$j[1+$m]}}return $e},$d._fill=function($c,$d,$e,$f,$g){var $h=this._width,$i=this._height;this._check($c+$e<=$h&&$d+$f<=$i);for(var $j=$d;$j<$f+$d;++$j){this._check(this._rowInfo[$j].spaceCount>=$e),this._rowInfo[$j].spaceCount-=$e;for(var $k=0;$k<$e;$k++){var $l=3*($c+$j*$h+$k);this._check(0==this._cells[$l]),this._cells[$l]=$g,this._cells[1+$l]=$e,this._cells[2+$l]=$f}}if(0<$c)for($j=0;$j<$f;++$j){var $m=0;for($k=$c-1;0<=$k&&0==this._cells[3*(($d+$j)*$h+$k)];--$k,++$m);for($k=$m;0<$k;--$k)this._cells[3*(($d+$j)*$h+$c-$k)+1]=$k,this._check(0<$k)}if(0<$d)for($k=$c;$k<$c+$e;++$k){for($m=0,$j=$d-1;0<=$j&&0==this._cells[3*($k+$j*$h)];--$j,$m++);for($j=$m;0<$j;--$j)this._cells[3*($k+($d-$j)*$h)+2]=$j,this._check(0<$j)}},$d._check=function($c){0==$c&&console.log("xtexMerger 错误啦")},$d._clear=function(){for(var $c=this._texCount=0;$c<this._height;$c++)this._rowInfo[$c].spaceCount=this._width;for(var $d=0;$d<this._height;$d++)for(var $e=0;$e<this._width;$e++){var $f=3*($d*this._width+$e);this._cells[$f]=0,this._cells[1+$f]=this._width-$e,this._cells[2+$f]=this._width-$d}this._failSize.width=this._width+1,this._failSize.height=this._height+1},$c.__init$=function(){$f=function(){function $c(){this.spaceCount=0}return $o($c,""),$c}(),$g=function(){function $c(){this.width=0,this.height=0}return $o($c,""),$c}()},$c}(),$Q=function(){function $t($c,$d,$e,$f){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=$c,this._height=$d,this._gridSize=$e,this._maxAtlaserCount=$f,this._gridNumX=$c/$e,this._gridNumY=$d/$e,this._curAtlasIndex=0,this._atlaserArray=[]}$o($t,"laya.webgl.atlas.AtlasResourceManager");var $c=$t.prototype;return $c.setAtlasParam=function($c,$d,$e,$f){if(1==this._setAtlasParam)return $t._sid_=0,this._width=$c,this._height=$d,this._gridSize=$e,this._maxAtlaserCount=$f,this._gridNumX=$c/$e,this._gridNumY=$d/$e,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},$c.pushData=function($c){var $d,$e=$c.bitmap,$f=-1,$g=null,$h=0,$i=0;for($h=0,$d=this._atlaserArray.length;$h<$d&&($i=(this._curAtlasIndex+$h)%$d,-1==($f=($g=this._atlaserArray[$i]).findBitmapIsExist($e)));$h++);if(-1!=$f){var $j=$g.InAtlasWebGLImagesOffsetValue[$f];return $q=$j[0],$r=$j[1],$g.addToAtlas($c,$q,$r),!0}this._setAtlasParam=!1;for(var $k=Math.ceil(($c.bitmap.width+2)/this._gridSize),$l=Math.ceil(($c.bitmap.height+2)/this._gridSize),$m=!1,$n=0;$n<2;$n++){var $o=this._maxAtlaserCount;for($h=0;$h<$o;$h++){$i=(this._curAtlasIndex+$h)%$o,this._atlaserArray.length-1>=$i||this._atlaserArray.push(new $Dc(this._gridNumX,this._gridNumY,this._width,this._height,$t._sid_++));var $p=this._atlaserArray[$i],$q=0,$r=0,$s=$p.addTex(1,$k,$l);if($s.ret){$q=$s.x*this._gridSize+1,$r=$s.y*this._gridSize+1,$e.lock=!0,$p.addToAtlasTexture($e,$q,$r),$p.addToAtlas($c,$q,$r),$m=!0,this._curAtlasIndex=$i;break}}if($m)break;this._atlaserArray.push(new $Dc(this._gridNumX,this._gridNumY,this._width,this._height,$t._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return $m||console.log(">>>AtlasManager pushData error"),$m},$c.addToAtlas=function($c){laya.webgl.atlas.AtlasResourceManager.instance.pushData($c)},$c.garbageCollection=function(){if(!0===this._needGC){for(var $c=this._atlaserArray.length-this._maxAtlaserCount,$d=0;$d<$c;$d++)this._atlaserArray[$d].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+$c),this._atlaserArray.splice(0,$c),this._needGC=!1}return!0},$c.freeAll=function(){for(var $c=0,$d=this._atlaserArray.length;$c<$d;$c++)this._atlaserArray[$c].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},$c.getAtlaserCount=function(){return this._atlaserArray.length},$c.getAtlaserByIndex=function($c){return this._atlaserArray[$c]},$f(1,$t,"instance",function(){return $t._Instance||($t._Instance=new $t(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),$t._Instance}),$f(1,$t,"enabled",function(){return $z.atlasEnable}),$f(1,$t,"atlasLimitWidth",function(){return $t._atlasLimitWidth},function($c){$t._atlasLimitWidth=$c}),$f(1,$t,"atlasLimitHeight",function(){return $t._atlasLimitHeight},function($c){$t._atlasLimitHeight=$c}),$t._enable=function(){$z.atlasEnable=!0},$t._disable=function(){$z.atlasEnable=!1},$t.__init__=function(){$t.atlasTextureWidth=2048,$t.atlasTextureHeight=2048,$t.maxTextureCount=6,$t.atlasLimitWidth=512,$t.atlasLimitHeight=512},$t._atlasLimitWidth=0,$t._atlasLimitHeight=0,$t.gridSize=16,$t.atlasTextureWidth=0,$t.atlasTextureHeight=0,$t.maxTextureCount=0,$t._atlasRestore=0,$t.BOARDER_TYPE_NO=0,$t.BOARDER_TYPE_RIGHT=1,$t.BOARDER_TYPE_LEFT=2,$t.BOARDER_TYPE_BOTTOM=4,$t.BOARDER_TYPE_TOP=8,$t.BOARDER_TYPE_ALL=15,$t._sid_=0,$t._Instance=null,$t}(),$R=function(){function $c(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return $o($c,"laya.webgl.atlas.MergeFillInfo"),$c}(),$S=function(){function $d(){}return $o($d,"laya.webgl.canvas.BlendMode"),$d._init_=function($c){$d.fns=[$d.BlendNormal,$d.BlendAdd,$d.BlendMultiply,$d.BlendScreen,$d.BlendOverlay,$d.BlendLight,$d.BlendMask,$d.BlendDestinationOut],$d.targetFns=[$d.BlendNormalTarget,$d.BlendAddTarget,$d.BlendMultiplyTarget,$d.BlendScreenTarget,$d.BlendOverlayTarget,$d.BlendLightTarget,$d.BlendMask,$d.BlendDestinationOut]},$d.BlendNormal=function($c){$c.blendFunc(1,771)},$d.BlendAdd=function($c){$c.blendFunc(1,772)},$d.BlendMultiply=function($c){$c.blendFunc(774,771)},$d.BlendScreen=function($c){$c.blendFunc(1,1)},$d.BlendOverlay=function($c){$c.blendFunc(1,769)},$d.BlendLight=function($c){$c.blendFunc(1,1)},$d.BlendNormalTarget=function($c){$c.blendFunc(1,771)},$d.BlendAddTarget=function($c){$c.blendFunc(1,772)},$d.BlendMultiplyTarget=function($c){$c.blendFunc(774,771)},$d.BlendScreenTarget=function($c){$c.blendFunc(1,1)},$d.BlendOverlayTarget=function($c){$c.blendFunc(1,769)},$d.BlendLightTarget=function($c){$c.blendFunc(1,1)},$d.BlendMask=function($c){$c.blendFunc(0,770)},$d.BlendDestinationOut=function($c){$c.blendFunc(0,0)},$d.activeBlendFunction=null,$d.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],$d.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},$d.NORMAL="normal",$d.ADD="add",$d.MULTIPLY="multiply",$d.SCREEN="screen",$d.LIGHT="light",$d.OVERLAY="overlay",$d.DESTINATIONOUT="destination-out",$d.fns=[],$d.targetFns=[],$d}(),$T=function(){function $e($c){this._color=$q.create("black"),this.setValue($c)}$o($e,"laya.webgl.canvas.DrawStyle");var $c=$e.prototype;return $c.setValue=function($c){if($c){if("string"==typeof $c)return void(this._color=$q.create($c));if($c instanceof laya.utils.Color)return void(this._color=$c)}},$c.reset=function(){this._color=$q.create("black")},$c.equal=function($c){return"string"==typeof $c?this._color.strColor===$c:$c instanceof laya.utils.Color&&this._color.numColor===$c.numColor},$c.toColorStr=function(){return this._color.strColor},$e.create=function($c){var $d;if($c&&("string"==typeof $c?$d=$q.create($c):$c instanceof laya.utils.Color&&($d=$c),$d))return $d._drawStyle||($d._drawStyle=new $e($c));return laya.webgl.canvas.DrawStyle.DEFAULT},$i($e,["DEFAULT",function(){return this.DEFAULT=new $e("#000000")}]),$e}(),$U=function(){function $c(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];$wc.mainContext;this.ib=$ac.create(35048),this.vb=$bc.create(5)}$o($c,"laya.webgl.canvas.Path");var $d=$c.prototype;return $d.addPoint=function($c,$d){this.tempArray.push($c,$d)},$d.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},$d.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},$d.polygon=function($c,$d,$e,$f,$g,$h){var $i;return this.geomatrys.push(this._curGeomatry=$i=new $Hc($c,$d,$e,$f,$g,$h)),$f||($i.fill=!1),null==$h&&($i.borderWidth=0),$i},$d.setGeomtry=function($c){this.geomatrys.push(this._curGeomatry=$c)},$d.drawLine=function($c,$d,$e,$f,$g){var $h;return this.closePath?this.geomatrys.push(this._curGeomatry=$h=new $Gc($c,$d,$e,$f,$g)):this.geomatrys.push(this._curGeomatry=$h=new $Fc($c,$d,$e,$f,$g)),$h.fill=!1,$h},$d.update=function(){var $c=this.ib._byteLength,$d=this.geomatrys.length;this.offset=$c;for(var $e=this.geoStart;$e<$d;$e++)this.geomatrys[$e].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=$d,this.count=(this.ib._byteLength-$c)/$rc.BYTES_PIDX},$d.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},$d.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},$c}(),$V=function(){function $j(){}$o($j,"laya.webgl.canvas.save.SaveBase");var $c=$j.prototype;return $y.imps($c,{"laya.webgl.canvas.save.ISaveData":!0}),$c.isSaveMark=function(){return!1},$c.restore=function($c){this._dataObj[this._valueName]=this._value,($j._cache[$j._cache._length++]=this)._newSubmit&&($c._curSubmit=$hc.RENDERBASE,$c._renderKey=0)},$j._createArray=function(){var $c=[];return $c._length=0,$c},$j._init=function(){var $c=$j._namemap={};return $c[1]="ALPHA",$c[2]="fillStyle",$c[8]="font",$c[256]="lineWidth",$c[512]="strokeStyle",$c[8192]="_mergeID",$c[1024]=$c[2048]=$c[4096]=[],$c[16384]="textBaseline",$c[32768]="textAlign",$c[65536]="_nBlendType",$c[1048576]="shader",$c[2097152]="filters",$c},$j.save=function($c,$d,$e,$f){if(($c._saveMark._saveuse&$d)!==$d){$c._saveMark._saveuse|=$d;var $g=$j._cache,$h=0<$g._length?$g[--$g._length]:new $j;$h._value=$e[$h._valueName=$j._namemap[$d]],$h._dataObj=$e,$h._newSubmit=$f;var $i=$c._save;$i[$i._length++]=$h}},$j._cache=laya.webgl.canvas.save.SaveBase._createArray(),$j._namemap=$j._init(),$j}(),$W=function(){function $h(){this._clipRect=new $D}$o($h,"laya.webgl.canvas.save.SaveClipRect");var $c=$h.prototype;return $y.imps($c,{"laya.webgl.canvas.save.ISaveData":!0}),$c.isSaveMark=function(){return!1},$c.restore=function($c){$c._clipRect=this._clipSaveRect,($h._cache[$h._cache._length++]=this)._submitScissor.submitLength=$c._submits._length-this._submitScissor.submitIndex,$c._curSubmit=$hc.RENDERBASE,$c._renderKey=0},$h.save=function($c,$d){if(131072!=(131072&$c._saveMark._saveuse)){$c._saveMark._saveuse|=131072;var $e=$h._cache,$f=0<$e._length?$e[--$e._length]:new $h;$f._clipSaveRect=$c._clipRect,$c._clipRect=$f._clipRect.copyFrom($c._clipRect),$f._submitScissor=$d;var $g=$c._save;$g[$g._length++]=$f}},$i($h,["_cache",function(){return this._cache=$V._createArray()}]),$h}(),$X=function(){function $p(){this._contextX=0,this._contextY=0,this._clipRect=new $D,this._rect=new $D,this._matrix=new $B}$o($p,"laya.webgl.canvas.save.SaveClipRectStencil");var $c=$p.prototype;return $y.imps($c,{"laya.webgl.canvas.save.ISaveData":!0}),$c.isSaveMark=function(){return!1},$c.restore=function($c){$mc.restore($c,this._rect,this._saveMatrix,this._contextX,this._contextY),$c._clipRect=this._clipSaveRect,$c._curMat=this._saveMatrix,$c._x=this._contextX,$c._y=this._contextY,$p._cache[$p._cache._length++]=this,$c._curSubmit=$hc.RENDERBASE},$p.save=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){if(262144!=(262144&$c._saveMark._saveuse)){$c._saveMark._saveuse|=262144;var $m=$p._cache,$n=0<$m._length?$m[--$m._length]:new $p;$n._clipSaveRect=$c._clipRect,$n._clipRect.setTo($i,$j,$k,$l),$c._clipRect=$n._clipRect,$n._rect.x=$e,$n._rect.y=$f,$n._rect.width=$g,$n._rect.height=$h,$n._contextX=$c._x,$n._contextY=$c._y,$n._saveMatrix=$c._curMat,$c._curMat.copyTo($n._matrix),$c._curMat=$n._matrix,$n._submitStencil=$d;var $o=$c._save;$o[$o._length++]=$n}},$i($p,["_cache",function(){return this._cache=$V._createArray()}]),$p}(),$Y=function(){function $f(){this._saveuse=0}$o($f,"laya.webgl.canvas.save.SaveMark");var $c=$f.prototype;return $y.imps($c,{"laya.webgl.canvas.save.ISaveData":!0}),$c.isSaveMark=function(){return!0},$c.restore=function($c){$c._saveMark=this._preSaveMark,$f._no[$f._no._length++]=this},$f.Create=function($c){var $d=$f._no,$e=0<$d._length?$d[--$d._length]:new $f;return $e._saveuse=0,$e._preSaveMark=$c._saveMark,$c._saveMark=$e},$i($f,["_no",function(){return this._no=$V._createArray()}]),$f}(),$Z=function(){function $h(){this._matrix=new $B}$o($h,"laya.webgl.canvas.save.SaveTransform");var $c=$h.prototype;return $y.imps($c,{"laya.webgl.canvas.save.ISaveData":!0}),$c.isSaveMark=function(){return!1},$c.restore=function($c){$c._curMat=this._savematrix,$h._no[$h._no._length++]=this},$h.save=function($c){var $d=$c._saveMark;if(2048!=(2048&$d._saveuse)){$d._saveuse|=2048;var $e=$h._no,$f=0<$e._length?$e[--$e._length]:new $h;$f._savematrix=$c._curMat,$c._curMat=$c._curMat.copyTo($f._matrix);var $g=$c._save;$g[$g._length++]=$f}},$i($h,["_no",function(){return this._no=$V._createArray()}]),$h}(),$$=function(){function $g(){}$o($g,"laya.webgl.canvas.save.SaveTranslate");var $c=$g.prototype;return $y.imps($c,{"laya.webgl.canvas.save.ISaveData":!0}),$c.isSaveMark=function(){return!1},$c.restore=function($c){$c._curMat;$c._x=this._x,$c._y=this._y,$g._no[$g._no._length++]=this},$g.save=function($c){var $d=$g._no,$e=0<$d._length?$d[--$d._length]:new $g;$e._x=$c._x,$e._y=$c._y;var $f=$c._save;$f[$f._length++]=$e},$i($g,["_no",function(){return this._no=$V._createArray()}]),$g}(),$_=function(){function $c(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new $D}$o($c,"laya.webgl.resource.RenderTargetMAX");var $d=$c.prototype;return $d.setSP=function($c){this._sp=$c},$d.size=function($c,$d){var $e=this;this._width!==$c||this._height!==$d?(this.repaint=!0,this._width=$c,this._height=$d,this.target?this.target.size($c,$d):this.target=$Mc.create($c,$d),this.target.hasListener("recovered")||this.target.on("recovered",this,function($c){$y.timer.callLater($e._sp,$e._sp.repaint)})):this.target.size($c,$d)},$d._flushToTarget=function($c,$d){if(!$d._destroy){var $e=$uc.worldScissorTest,$f=$uc.worldClipRect;$uc.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,$uc.worldScissorTest=!1,$wc.mainContext.disable(3089);var $g=$uc.worldAlpha,$h=$uc.worldMatrix4,$i=$uc.worldMatrix,$j=$uc.worldFilters,$k=$uc.worldShaderDefines;if($uc.worldMatrix=$B.EMPTY,$uc.restoreTempArray(),$uc.worldMatrix4=$uc.TEMPMAT4_ARRAY,$uc.worldAlpha=1,$uc.worldFilters=null,$uc.worldShaderDefines=null,$Lc.activeShader=null,$d.start(),$z.showCanvasMark?$d.clear(0,1,0,.3):$d.clear(0,0,0,0),$c.flush(),$d.end(),$Lc.activeShader=null,$uc.worldAlpha=$g,$uc.worldMatrix4=$h,$uc.worldMatrix=$i,$uc.worldFilters=$j,$uc.worldShaderDefines=$k,$uc.worldScissorTest=$e){var $l=$uc.height-$f.y-$f.height;$wc.mainContext.scissor($f.x,$l,$f.width,$f.height),$wc.mainContext.enable(3089)}$uc.worldClipRect=$f}},$d.flush=function($c){this.repaint&&(this._flushToTarget($c,this.target),this.repaint=!1)},$d.drawTo=function($c,$d,$e,$f,$g){$c.drawTexture(this.target.getTexture(),$d,$e,$f,$g,0,0)},$d.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},$c}(),$a=function(){function $c(){this.ALPHA=1,this.shaderType=0,this.defines=new $Ec}return $o($c,"laya.webgl.shader.d2.Shader2D"),$c.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},$c.__init__=function(){var $c,$d;$Yc.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),$Yc.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),$Yc.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),$Yc.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),$Yc.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),$Yc.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),$Yc.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),$Yc.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),$c="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$d='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$Yc.preCompile2D(0,1,$c,$d,null),$c="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",$d='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',$Yc.preCompile2D(0,2,$c,$d,null),$c="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",$d="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",$Yc.preCompile2D(0,4,$c,$d,null),$c="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$d='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$Yc.preCompile2D(0,256,$c,$d,null),$c="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",$d="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",$Yc.preCompile2D(0,512,$c,$d,null)},$c}(),$b=function(){function $d($c,$d,$e){this._value=0,this._name2int=$c,this._int2name=$d,this._int2nameMap=$e}$o($d,"laya.webgl.shader.ShaderDefines");var $c=$d.prototype;return $c.add=function($c){return"string"==typeof $c&&($c=this._name2int[$c]),this._value|=$c,this._value},$c.addInt=function($c){return this._value|=$c,this._value},$c.remove=function($c){return"string"==typeof $c&&($c=this._name2int[$c]),this._value&=~$c,this._value},$c.isDefine=function($c){return(this._value&$c)===$c},$c.getValue=function(){return this._value},$c.setValue=function($c){this._value=$c},$c.toNameDic=function(){var $c=this._int2nameMap[this._value];return $c||$d._toText(this._value,this._int2name,this._int2nameMap)},$d._reg=function($c,$d,$e,$f){$f[$e[$c]=$d]=$c},$d._toText=function($c,$d,$e){var $f=$e[$c];if($f)return $f;for(var $g={},$h=1,$i=0;$i<32&&!($c<($h=1<<$i));$i++)if($c&$h){var $j=$d[$h];$j&&($g[$j]="")}return $e[$c]=$g},$d._toInt=function($c,$d){for(var $e=$c.split("."),$f=0,$g=0,$h=$e.length;$g<$h;$g++){var $i=$d[$e[$g]];if(!$i)throw new Error("Defines to int err:"+$c+"/"+$e[$g]);$f|=$i}return $f},$d}(),$cc=function(){function $i(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new $B}$o($i,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var $c=$i.prototype;return $c.init=function($c,$d,$e){if($d)this._vs=$d;else{this._vs=[];var $f=$c.width,$g=$c.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push($f,0,1,0,1,1,1,1),this._vs.push($f,$g,1,1,1,1,1,1),this._vs.push(0,$g,0,1,1,1,1,1)}$e?this._ps=$e:($i._defaultPS||($i._defaultPS=[]).push(0,1,3,3,1,2),this._ps=$i._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=$c},$c.init2=function($c,$d,$e,$f,$g){this.transform&&(this.transform=null),$e?this._ps=$e:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=$f,this._uvs=$g,this.mEleNum=this._ps.length,this.mTexture=$c,($t.isConchNode||$t.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},$c._initMyData=function(){var $c=0,$d=0,$e=4*this._verticles.length;this._vs=$i._tempVS;var $f=!1;if($t.isConchNode||$t.isConchApp?(this._vs.length=$e,$f=!0):this._vs.length<$e&&(this._vs.length=$e,$f=!0),$i._tVSLen=$e,$f)for(;$c<$e;)this._vs[$c]=this._verticles[$d],this._vs[$c+1]=this._verticles[$d+1],this._vs[$c+2]=this._uvs[$d],this._vs[$c+3]=this._uvs[$d+1],this._vs[$c+4]=1,this._vs[$c+5]=1,this._vs[$c+6]=1,this._vs[$c+7]=1,$c+=8,$d+=2;else for(;$c<$e;)this._vs[$c]=this._verticles[$d],this._vs[$c+1]=this._verticles[$d+1],this._vs[$c+2]=this._uvs[$d],this._vs[$c+3]=this._uvs[$d+1],$c+=8,$d+=2},$c.getData2=function($c,$d,$e){var $f;this.mVBBuffer=$c,this.mIBBuffer=$d,this._initMyData(),$c.appendEx2(this._vs,Float32Array,$i._tVSLen,4),this._indexStart=$d._byteLength,($f=$i._tempIB).length<this._ps.length&&($f.length=this._ps.length);for(var $g=0,$h=this._ps.length;$g<$h;$g++)$f[$g]=this._ps[$g]+$e;$d.appendEx2($f,Uint16Array,this._ps.length,2)},$c.getData=function($c,$d,$e){if(this.mVBBuffer=$c,this.mIBBuffer=$d,$c.append(this.mVBData),this._indexStart=$d._byteLength,this.mIBData.start!=$e){for(var $f=0,$g=this._ps.length;$f<$g;$f++)this.mIBData[$f]=this._ps[$f]+$e;this.mIBData.start=$e}$d.append(this.mIBData)},$c.render=function($c,$d,$e){if($t.isWebGL&&this.mTexture){$c._renderKey=0,$c._shader2D.glTexture=null,$dc.getInstance().addSkinMesh(this);var $f=$hc.createShape($c,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,$Ac.create(512,0));this.transform||(this.transform=$B.EMPTY),this.transform.translate($d,$e),$B.mul(this.transform,$c._curMat,this._tempMatrix),this.transform.translate(-$d,-$e);var $g=$f.shaderValue,$h=$g.u_mmat2||$uc.getMatrArray();$uc.mat2MatArray(this._tempMatrix,$h),$g.textureHost=this.mTexture,$g.offsetX=0,$g.offsetY=0,$g.u_mmat2=$h,$g.ALPHA=$c._shader2D.ALPHA,$c._submits[$c._submits._length++]=$f}else $t.isConchApp&&this.mTexture&&(this.transform||(this.transform=$B.EMPTY),$c.setSkinMesh&&$c.setSkinMesh($d,$e,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},$i._tempVS=[],$i._tempIB=[],$i._defaultPS=null,$i._tVSLen=0,$i}(),$dc=function(){function $c(){this.ib=null,this.vb=null;$wc.mainContext;this.ib=$ac.create(35048),this.vb=$bc.create(8)}$o($c,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var $d=$c.prototype;return $d.addSkinMesh=function($c){$c.getData2(this.vb,this.ib,this.vb._byteLength/32)},$d.reset=function(){this.vb.clear(),this.ib.clear()},$c.getInstance=function(){return $c.instance=$c.instance||new $c},$c.instance=null,$c}(),$ec=function(){function $c($c,$d,$e,$f,$g,$h,$i,$j,$k){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===$k&&($k=0),this.x=$c,this.y=$d,this.width=$e,this.height=$f,this.edges=$g,this.color=$h,this.borderWidth=$i,this.borderColor=$j}$o($c,"laya.webgl.shapes.BasePoly");var $d=$c.prototype;return $y.imps($d,{"laya.webgl.shapes.IShape":!0}),$d.getData=function($c,$d,$e){},$d.rebuild=function($c){},$d.setMatrix=function($c){},$d.needUpdate=function($c){return!0},$d.sector=function($c,$d,$e){var $f=this.x,$g=this.y,$h=this.edges,$i=(this.r1-this.r0)/$h,$j=this.width,$k=this.height,$l=this.color,$m=($l>>16&255)/255,$n=($l>>8&255)/255,$o=(255&$l)/255;$c.push($f,$g,$m,$n,$o);for(var $p=0;$p<$h+1;$p++)$c.push($f+Math.sin($i*$p+this.r0)*$j,$g+Math.cos($i*$p+this.r0)*$k),$c.push($m,$n,$o);for($p=0;$p<$h;$p++)$d.push($e,$e+$p+1,$e+$p+2)},$d.createLine2=function($c,$d,$e,$f,$g,$h){var $i,$j,$k,$l,$m,$n,$o,$p,$q,$r,$s,$t,$u,$v,$w,$x,$y,$z,$A,$B,$C=$c.concat(),$D=$g,$E=this.borderColor,$F=($E>>16&255)/255,$G=($E>>8&255)/255,$H=(255&$E)/255,$I=$C.length/2,$J=$f,$K=$e/2;$k=$C[0],$l=$C[1],$r=$k-($m=$C[2]),$q=($q=-($l-($n=$C[3])))/($B=Math.sqrt($q*$q+$r*$r))*$K,$r=$r/$B*$K,$D.push($k-$q+this.x,$l-$r+this.y,$F,$G,$H,$k+$q+this.x,$l+$r+this.y,$F,$G,$H);for(var $L=1;$L<$I-1;$L++)$k=$C[2*($L-1)],$l=$C[2*($L-1)+1],$m=$C[2*$L],$n=$C[2*$L+1],$o=$C[2*($L+1)],$p=$C[2*($L+1)+1],$r=$k-$m,$t=$m-$o,$w=(-($q=($q=-($l-$n))/($B=Math.sqrt($q*$q+$r*$r))*$K)+$k)*(-($r=$r/$B*$K)+$n)-(-$q+$m)*(-$r+$l),$z=(-($s=($s=-($n-$p))/($B=Math.sqrt($s*$s+$t*$t))*$K)+$o)*(-($t=$t/$B*$K)+$n)-(-$s+$m)*(-$t+$p),$A=($u=-$r+$l-(-$r+$n))*($y=-$s+$m-(-$s+$o))-($x=-$t+$p-(-$t+$n))*($v=-$q+$m-(-$q+$k)),Math.abs($A)<.1?($A+=10.1,$D.push($m-$q+this.x,$n-$r+this.y,$F,$G,$H,$m+$q+this.x,$n+$r+this.y,$F,$G,$H)):((($i=($v*$z-$y*$w)/$A)-$m)*($i-$m)+(($j=($x*$w-$u*$z)/$A)-$n)+($j-$n),$D.push($i+this.x,$j+this.y,$F,$G,$H,$m-($i-$m)+this.x,$n-($j-$n)+this.y,$F,$G,$H));$k=$C[$C.length-4],$l=$C[$C.length-3],$r=$k-($m=$C[$C.length-2]),$q=($q=-($l-($n=$C[$C.length-1])))/($B=Math.sqrt($q*$q+$r*$r))*$K,$r=$r/$B*$K,$D.push($m-$q+this.x,$n-$r+this.y,$F,$G,$H,$m+$q+this.x,$n+$r+this.y,$F,$G,$H);var $M=$h;for($L=1;$L<$M;$L++)$d.push($J+2*($L-1),$J+2*($L-1)+1,$J+2*$L+1,$J+2*$L+1,$J+2*$L,$J+2*($L-1));return $D},$d.createLine=function($c,$d,$e,$f){var $g=$c.concat(),$h=$c,$i=this.borderColor,$j=($i>>16&255)/255,$k=($i>>8&255)/255,$l=(255&$i)/255;$g.splice(0,5);var $m,$n,$o,$p,$q,$r,$s,$t,$u,$v,$w,$x,$y,$z,$A,$B,$C,$D,$E,$F,$G=$g.length/5,$H=$f,$I=$e/2;$o=$g[0],$p=$g[1],$v=$o-($q=$g[5]),$u=($u=-($p-($r=$g[6])))/($F=Math.sqrt($u*$u+$v*$v))*$I,$v=$v/$F*$I,$h.push($o-$u,$p-$v,$j,$k,$l,$o+$u,$p+$v,$j,$k,$l);for(var $J=1;$J<$G-1;$J++)$o=$g[5*($J-1)],$p=$g[5*($J-1)+1],$q=$g[5*$J],$r=$g[5*$J+1],$s=$g[5*($J+1)],$t=$g[5*($J+1)+1],$v=$o-$q,$x=$q-$s,$A=(-($u=($u=-($p-$r))/($F=Math.sqrt($u*$u+$v*$v))*$I)+$o)*(-($v=$v/$F*$I)+$r)-(-$u+$q)*(-$v+$p),$D=(-($w=($w=-($r-$t))/($F=Math.sqrt($w*$w+$x*$x))*$I)+$s)*(-($x=$x/$F*$I)+$r)-(-$w+$q)*(-$x+$t),$E=($y=-$v+$p-(-$v+$r))*($C=-$w+$q-(-$w+$s))-($B=-$x+$t-(-$x+$r))*($z=-$u+$q-(-$u+$o)),Math.abs($E)<.1?($E+=10.1,$h.push($q-$u,$r-$v,$j,$k,$l,$q+$u,$r+$v,$j,$k,$l)):((($m=($z*$D-$C*$A)/$E)-$q)*($m-$q)+(($n=($B*$A-$y*$D)/$E)-$r)+($n-$r),$h.push($m,$n,$j,$k,$l,$q-($m-$q),$r-($n-$r),$j,$k,$l));$o=$g[$g.length-10],$p=$g[$g.length-9],$v=$o-($q=$g[$g.length-5]),$u=($u=-($p-($r=$g[$g.length-4])))/($F=Math.sqrt($u*$u+$v*$v))*$I,$v=$v/$F*$I,$h.push($q-$u,$r-$v,$j,$k,$l,$q+$u,$r+$v,$j,$k,$l);var $K=this.edges+1;for($J=1;$J<$K;$J++)$d.push($H+2*($J-1),$H+2*($J-1)+1,$H+2*$J+1,$H+2*$J+1,$H+2*$J,$H+2*($J-1));return $h},$d.createLoopLine=function($c,$d,$e,$f,$g,$h){var $i=$c.concat(),$j=$g||$c,$k=this.borderColor,$l=($k>>16&255)/255,$m=($k>>8&255)/255,$n=(255&$k)/255;$i.splice(0,5);var $o=[$i[0],$i[1]],$p=[$i[$i.length-5],$i[$i.length-4]],$q=$p[0]+.5*($o[0]-$p[0]),$r=$p[1]+.5*($o[1]-$p[1]);$i.unshift($q,$r,0,0,0),$i.push($q,$r,0,0,0);var $s,$t,$u,$v,$w,$x,$y,$z,$A,$B,$C,$D,$E,$F,$G,$H,$I,$J,$K,$L,$M=$i.length/5,$N=$f,$O=$e/2;$u=$i[0],$v=$i[1],$B=$u-($w=$i[5]),$A=($A=-($v-($x=$i[6])))/($L=Math.sqrt($A*$A+$B*$B))*$O,$B=$B/$L*$O,$j.push($u-$A,$v-$B,$l,$m,$n,$u+$A,$v+$B,$l,$m,$n);for(var $P=1;$P<$M-1;$P++)$u=$i[5*($P-1)],$v=$i[5*($P-1)+1],$w=$i[5*$P],$x=$i[5*$P+1],$y=$i[5*($P+1)],$z=$i[5*($P+1)+1],$B=$u-$w,$D=$w-$y,$G=(-($A=($A=-($v-$x))/($L=Math.sqrt($A*$A+$B*$B))*$O)+$u)*(-($B=$B/$L*$O)+$x)-(-$A+$w)*(-$B+$v),$J=(-($C=($C=-($x-$z))/($L=Math.sqrt($C*$C+$D*$D))*$O)+$y)*(-($D=$D/$L*$O)+$x)-(-$C+$w)*(-$D+$z),$K=($E=-$B+$v-(-$B+$x))*($I=-$C+$w-(-$C+$y))-($H=-$D+$z-(-$D+$x))*($F=-$A+$w-(-$A+$u)),Math.abs($K)<.1?($K+=10.1,$j.push($w-$A,$x-$B,$l,$m,$n,$w+$A,$x+$B,$l,$m,$n)):((($s=($F*$J-$I*$G)/$K)-$w)*($s-$w)+(($t=($H*$G-$E*$J)/$K)-$x)+($t-$x),$j.push($s,$t,$l,$m,$n,$w-($s-$w),$x-($t-$x),$l,$m,$n));$h&&($d=$h);var $Q=this.edges+1;for($P=1;$P<$Q;$P++)$d.push($N+2*($P-1),$N+2*($P-1)+1,$N+2*$P+1,$N+2*$P+1,$N+2*$P,$N+2*($P-1));return $d.push($N+2*($P-1),$N+2*($P-1)+1,$N+1,$N+1,$N,$N+2*($P-1)),$j},$c}(),$fc=function(){function $r(){}return $o($r,"laya.webgl.shapes.Earcut"),$r.earcut=function($c,$d,$e){$e=$e||2;var $f,$g,$h,$i,$j,$k,$l,$m=$d&&$d.length,$n=$m?$d[0]*$e:$c.length,$o=$r.linkedList($c,0,$n,$e,!0),$p=[];if(!$o)return $p;if($m&&($o=$r.eliminateHoles($c,$d,$o,$e)),$c.length>80*$e){$f=$h=$c[0],$g=$i=$c[1];for(var $q=$e;$q<$n;$q+=$e)($j=$c[$q])<$f&&($f=$j),($k=$c[$q+1])<$g&&($g=$k),$h<$j&&($h=$j),$i<$k&&($i=$k);$l=0!==($l=Math.max($h-$f,$i-$g))?1/$l:0}return $r.earcutLinked($o,$p,$e,$f,$g,$l),$p},$r.linkedList=function($c,$d,$e,$f,$g){var $h,$i;if($g===0<$r.signedArea($c,$d,$e,$f))for($h=$d;$h<$e;$h+=$f)$i=$r.insertNode($h,$c[$h],$c[$h+1],$i);else for($h=$e-$f;$d<=$h;$h-=$f)$i=$r.insertNode($h,$c[$h],$c[$h+1],$i);return $i&&$r.equals($i,$i.next)&&($r.removeNode($i),$i=$i.next),$i},$r.filterPoints=function($c,$d){if(!$c)return $c;$d||($d=$c);var $e,$f=$c;do{if($e=!1,$f.steiner||!$r.equals($f,$f.next)&&0!==$r.area($f.prev,$f,$f.next))$f=$f.next;else{if($r.removeNode($f),($f=$d=$f.prev)===$f.next)break;$e=!0}}while($e||$f!==$d);return $d},$r.earcutLinked=function($c,$d,$e,$f,$g,$h,$i){if($c){!$i&&$h&&$r.indexCurve($c,$f,$g,$h);for(var $j,$k,$l=$c;$c.prev!==$c.next;)if($j=$c.prev,$k=$c.next,$h?$r.isEarHashed($c,$f,$g,$h):$r.isEar($c))$d.push($j.i/$e),$d.push($c.i/$e),$d.push($k.i/$e),$r.removeNode($c),$c=$k.next,$l=$k.next;else if(($c=$k)===$l){$i?1===$i?($c=$r.cureLocalIntersections($c,$d,$e),$r.earcutLinked($c,$d,$e,$f,$g,$h,2)):2===$i&&$r.splitEarcut($c,$d,$e,$f,$g,$h):$r.earcutLinked($r.filterPoints($c,null),$d,$e,$f,$g,$h,1);break}}},$r.isEar=function($c){var $d=$c.prev,$e=$c,$f=$c.next;if(0<=$r.area($d,$e,$f))return!1;for(var $g=$c.next.next;$g!==$c.prev;){if($r.pointInTriangle($d.x,$d.y,$e.x,$e.y,$f.x,$f.y,$g.x,$g.y)&&0<=$r.area($g.prev,$g,$g.next))return!1;$g=$g.next}return!0},$r.isEarHashed=function($c,$d,$e,$f){var $g=$c.prev,$h=$c,$i=$c.next;if(0<=$r.area($g,$h,$i))return!1;for(var $j=$g.x<$h.x?$g.x<$i.x?$g.x:$i.x:$h.x<$i.x?$h.x:$i.x,$k=$g.y<$h.y?$g.y<$i.y?$g.y:$i.y:$h.y<$i.y?$h.y:$i.y,$l=$g.x>$h.x?$g.x>$i.x?$g.x:$i.x:$h.x>$i.x?$h.x:$i.x,$m=$g.y>$h.y?$g.y>$i.y?$g.y:$i.y:$h.y>$i.y?$h.y:$i.y,$n=$r.zOrder($j,$k,$d,$e,$f),$o=$r.zOrder($l,$m,$d,$e,$f),$p=$c.nextZ;$p&&$p.z<=$o;){if($p!==$c.prev&&$p!==$c.next&&$r.pointInTriangle($g.x,$g.y,$h.x,$h.y,$i.x,$i.y,$p.x,$p.y)&&0<=$r.area($p.prev,$p,$p.next))return!1;$p=$p.nextZ}for($p=$c.prevZ;$p&&$p.z>=$n;){if($p!==$c.prev&&$p!==$c.next&&$r.pointInTriangle($g.x,$g.y,$h.x,$h.y,$i.x,$i.y,$p.x,$p.y)&&0<=$r.area($p.prev,$p,$p.next))return!1;$p=$p.prevZ}return!0},$r.cureLocalIntersections=function($c,$d,$e){var $f=$c;do{var $g=$f.prev,$h=$f.next.next;!$r.equals($g,$h)&&$r.intersects($g,$f,$f.next,$h)&&$r.locallyInside($g,$h)&&$r.locallyInside($h,$g)&&($d.push($g.i/$e),$d.push($f.i/$e),$d.push($h.i/$e),$r.removeNode($f),$r.removeNode($f.next),$f=$c=$h),$f=$f.next}while($f!==$c);return $f},$r.splitEarcut=function($c,$d,$e,$f,$g,$h){var $i=$c;do{for(var $j=$i.next.next;$j!==$i.prev;){if($i.i!==$j.i&&$r.isValidDiagonal($i,$j)){var $k=$r.splitPolygon($i,$j);return $i=$r.filterPoints($i,$i.next),$k=$r.filterPoints($k,$k.next),$r.earcutLinked($i,$d,$e,$f,$g,$h),void $r.earcutLinked($k,$d,$e,$f,$g,$h)}$j=$j.next}$i=$i.next}while($i!==$c)},$r.eliminateHoles=function($c,$d,$e,$f){var $g,$h,$i,$j,$k,$l=[];for($g=0,$h=$d.length;$g<$h;$g++)$i=$d[$g]*$f,$j=$g<$h-1?$d[$g+1]*$f:$c.length,($k=$r.linkedList($c,$i,$j,$f,!1))===$k.next&&($k.steiner=!0),$l.push($r.getLeftmost($k));for($l.sort($r.compareX),$g=0;$g<$l.length;$g++)$r.eliminateHole($l[$g],$e),$e=$r.filterPoints($e,$e.next);return $e},$r.compareX=function($c,$d){return $c.x-$d.x},$r.eliminateHole=function($c,$d){if($d=$r.findHoleBridge($c,$d)){var $e=$r.splitPolygon($d,$c);$r.filterPoints($e,$e.next)}},$r.findHoleBridge=function($c,$d){var $e,$f=$d,$g=$c.x,$h=$c.y,$i=-1/0;do{if($h<=$f.y&&$h>=$f.next.y&&$f.next.y!==$f.y){var $j=$f.x+($h-$f.y)*($f.next.x-$f.x)/($f.next.y-$f.y);if($j<=$g&&$i<$j){if(($i=$j)===$g){if($h===$f.y)return $f;if($h===$f.next.y)return $f.next}$e=$f.x<$f.next.x?$f:$f.next}}$f=$f.next}while($f!==$d);if(!$e)return null;if($g===$i)return $e.prev;var $k,$l=$e,$m=$e.x,$n=$e.y,$o=1/0;for($f=$e.next;$f!==$l;)$g>=$f.x&&$f.x>=$m&&$g!==$f.x&&$r.pointInTriangle($h<$n?$g:$i,$h,$m,$n,$h<$n?$i:$g,$h,$f.x,$f.y)&&(($k=Math.abs($h-$f.y)/($g-$f.x))<$o||$k===$o&&$f.x>$e.x)&&$r.locallyInside($f,$c)&&($e=$f,$o=$k),$f=$f.next;return $e},$r.indexCurve=function($c,$d,$e,$f){for(var $g=$c;null===$g.z&&($g.z=$r.zOrder($g.x,$g.y,$d,$e,$f)),$g.prevZ=$g.prev,$g.nextZ=$g.next,($g=$g.next)!==$c;);$g.prevZ.nextZ=null,$g.prevZ=null,$r.sortLinked($g)},$r.sortLinked=function($c){var $d,$e,$f,$g,$h,$i,$j,$k,$l=1;do{for($e=$c,$h=$c=null,$i=0;$e;){for($i++,$f=$e,$d=$j=0;$d<$l&&($j++,$f=$f.nextZ);$d++);for($k=$l;0<$j||0<$k&&$f;)0!==$j&&(0===$k||!$f||$e.z<=$f.z)?($e=($g=$e).nextZ,$j--):($f=($g=$f).nextZ,$k--),$h?$h.nextZ=$g:$c=$g,$g.prevZ=$h,$h=$g;$e=$f}$h.nextZ=null,$l*=2}while(1<$i);return $c},$r.zOrder=function($c,$d,$e,$f,$g){return($c=1431655765&(($c=858993459&(($c=252645135&(($c=16711935&(($c=32767*($c-$e)*$g)|$c<<8))|$c<<4))|$c<<2))|$c<<1))|($d=1431655765&(($d=858993459&(($d=252645135&(($d=16711935&(($d=32767*($d-$f)*$g)|$d<<8))|$d<<4))|$d<<2))|$d<<1))<<1},$r.getLeftmost=function($c){for(var $d=$c,$e=$c;$d.x<$e.x&&($e=$d),($d=$d.next)!==$c;);return $e},$r.pointInTriangle=function($c,$d,$e,$f,$g,$h,$i,$j){return 0<=($g-$i)*($d-$j)-($c-$i)*($h-$j)&&0<=($c-$i)*($f-$j)-($e-$i)*($d-$j)&&0<=($e-$i)*($h-$j)-($g-$i)*($f-$j)},$r.isValidDiagonal=function($c,$d){return $c.next.i!==$d.i&&$c.prev.i!==$d.i&&!$r.intersectsPolygon($c,$d)&&$r.locallyInside($c,$d)&&$r.locallyInside($d,$c)&&$r.middleInside($c,$d)},$r.area=function($c,$d,$e){return($d.y-$c.y)*($e.x-$d.x)-($d.x-$c.x)*($e.y-$d.y)},$r.equals=function($c,$d){return $c.x===$d.x&&$c.y===$d.y},$r.intersects=function($c,$d,$e,$f){return!!($r.equals($c,$d)&&$r.equals($e,$f)||$r.equals($c,$f)&&$r.equals($e,$d))||0<$r.area($c,$d,$e)!=0<$r.area($c,$d,$f)&&0<$r.area($e,$f,$c)!=0<$r.area($e,$f,$d)},$r.intersectsPolygon=function($c,$d){var $e=$c;do{if($e.i!==$c.i&&$e.next.i!==$c.i&&$e.i!==$d.i&&$e.next.i!==$d.i&&$r.intersects($e,$e.next,$c,$d))return!0;$e=$e.next}while($e!==$c);return!1},$r.locallyInside=function($c,$d){return $r.area($c.prev,$c,$c.next)<0?0<=$r.area($c,$d,$c.next)&&0<=$r.area($c,$c.prev,$d):$r.area($c,$d,$c.prev)<0||$r.area($c,$c.next,$d)<0},$r.middleInside=function($c,$d){for(var $e=$c,$f=!1,$g=($c.x+$d.x)/2,$h=($c.y+$d.y)/2;$e.y>$h!=$e.next.y>$h&&$e.next.y!==$e.y&&$g<($e.next.x-$e.x)*($h-$e.y)/($e.next.y-$e.y)+$e.x&&($f=!$f),($e=$e.next)!==$c;);return $f},$r.splitPolygon=function($c,$d){var $e=new $gc($c.i,$c.x,$c.y),$f=new $gc($d.i,$d.x,$d.y),$g=$c.next,$h=$d.prev;return($c.next=$d).prev=$c,($e.next=$g).prev=$e,($f.next=$e).prev=$f,($h.next=$f).prev=$h,$f},$r.insertNode=function($c,$d,$e,$f){var $g=new $gc($c,$d,$e);return $f?($g.next=$f.next,($g.prev=$f).next.prev=$g,$f.next=$g):($g.prev=$g).next=$g,$g},$r.removeNode=function($c){$c.next.prev=$c.prev,$c.prev.next=$c.next,$c.prevZ&&($c.prevZ.nextZ=$c.nextZ),$c.nextZ&&($c.nextZ.prevZ=$c.prevZ)},$r.signedArea=function($c,$d,$e,$f){for(var $g=0,$h=$d,$i=$e-$f;$h<$e;$h+=$f)$g+=($c[$i]-$c[$h])*($c[$h+1]+$c[$i+1]),$i=$h;return $g},$r}(),$gc=function(){function $c($c,$d,$e){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=$c,this.x=$d,this.y=$e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return $o($c,"laya.webgl.shapes.EarcutNode"),$c}(),$hc=(function(){function $c($c,$d,$e,$f,$g,$h,$i){this.lineWidth=$c,this.lineColor=$d,this.lineAlpha=$e,this.fillColor=$f,this.fillAlpha=$g,this.shape=$i,this.fill=$h}$o($c,"laya.webgl.shapes.GeometryData");var $d=$c.prototype;$d.clone=function(){return new $c(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},$d.getIndexData=function(){return null},$d.getVertexData=function(){return null},$d.destroy=function(){this.shape=null}}(),function(){function $c($c){if($c instanceof Float32Array)this.points=$c;else if($c instanceof Array){$c.length;this.points=new Float32Array($c)}}$o($c,"laya.webgl.shapes.Vertex");var $d=$c.prototype;$y.imps($d,{"laya.webgl.shapes.IShape":!0}),$d.getData=function($c,$d,$e){},$d.needUpdate=function($c){return!1},$d.rebuild=function($c){},$d.setMatrix=function($c){}}(),function(){function $k($c){void 0===$c&&($c=1e4),this._renderType=$c}$o($k,"laya.webgl.submit.Submit");var $c=$k.prototype;return $y.imps($c,{"laya.webgl.submit.ISubmit":!0}),$c.releaseRender=function(){var $c=$k._cache;($c[$c._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$c.getRenderType=function(){return this._renderType},$c.renderSubmit=function(){if(0===this._numEle)return 1;var $c=this.shaderValue.textureHost;if($c){var $d=$c.source;if(!$c.bitmap||!$d)return 1;this.shaderValue.texture=$d,$c.alphaTexture&&$c.alphaTexture.source&&(this.shaderValue.texture1=$c.alphaTexture.source)}this._vb.bind_upload(this._ib);var $e=$wc.mainContext;return this.shaderValue.upload(),$S.activeBlendFunction!==this._blendFn&&($e.enable(3042),this._blendFn($e),$S.activeBlendFunction=this._blendFn),$G.drawCall++,$G.trianglesFaces+=this._numEle/3,$e.drawElements(4,this._numEle,5123,this._startIdx),1},$k.__init__=function(){var $c=$k.RENDERBASE=new $k(-1);$c.shaderValue=new $Ac(0,0),$c.shaderValue.ALPHA=-1234},$k.createSubmit=function($c,$d,$e,$f,$g){var $h=$k._cache._length?$k._cache[--$k._cache._length]:new $k;null==$e&&(($e=$h._selfVb||($h._selfVb=$bc.create(-1))).clear(),$f=0),$h._ib=$d,$h._vb=$e,$h._startIdx=$f*$rc.BYTES_PIDX,$h._numEle=0;var $i=$c._nBlendType;$h._blendFn=$c._targets?$S.targetFns[$i]:$S.fns[$i],$h.shaderValue=$g,$h.shaderValue.setValue($c._shader2D);var $j=$c._shader2D.filters;return $j&&$h.shaderValue.setFilters($j),$h},$k.createShape=function($c,$d,$e,$f,$g,$h){var $i=$k._cache._length?$k._cache[--$k._cache._length]:new $k;$i._ib=$d,$i._vb=$e,$i._numEle=$f,$i._startIdx=$g,$i.shaderValue=$h,$i.shaderValue.setValue($c._shader2D);var $j=$c._nBlendType;return $i._blendFn=$c._targets?$S.targetFns[$j]:$S.fns[$j],$i},$k.TYPE_2D=1e4,$k.TYPE_CANVAS=10003,$k.TYPE_CMDSETRT=10004,$k.TYPE_CUSTOM=10005,$k.TYPE_BLURRT=10006,$k.TYPE_CMDDESTORYPRERT=10007,$k.TYPE_DISABLESTENCIL=10008,$k.TYPE_OTHERIBVB=10009,$k.TYPE_PRIMITIVE=10010,$k.TYPE_RT=10011,$k.TYPE_BLUR_RT=10012,$k.TYPE_TARGET=10013,$k.TYPE_CHANGE_VALUE=10014,$k.TYPE_SHAPE=10015,$k.TYPE_TEXTURE=10016,$k.TYPE_FILLTEXTURE=10017,$k.RENDERBASE=null,$k._cache=(($k._cache=[])._length=0,$k._cache),$k}()),$ic=function(){function $f(){this.fun=null,this.args=null}$o($f,"laya.webgl.submit.SubmitCMD");var $c=$f.prototype;return $y.imps($c,{"laya.webgl.submit.ISubmit":!0}),$c.renderSubmit=function(){return this.fun.apply(null,this.args),1},$c.getRenderType=function(){return 0},$c.releaseRender=function(){var $c=$f._cache;$c[$c._length++]=this},$f.create=function($c,$d){var $e=$f._cache._length?$f._cache[--$f._cache._length]:new $f;return $e.fun=$d,$e.args=$c,$e},$f._cache=(($f._cache=[])._length=0,$f._cache),$f}(),$jc=function(){function $d(){this.variables={}}$o($d,"laya.webgl.submit.SubmitCMDScope");var $c=$d.prototype;return $c.getValue=function($c){return this.variables[$c]},$c.addValue=function($c,$d){return this.variables[$c]=$d},$c.setValue=function($c,$d){return this.variables.hasOwnProperty($c)?this.variables[$c]=$d:null},$c.clear=function(){for(var $c in this.variables)delete this.variables[$c]},$c.recycle=function(){this.clear(),$d.POOL.push(this)},$d.create=function(){var $c=$d.POOL.pop();return $c||($c=new $d),$c},$d.POOL=[],$d}(),$kc=function(){function $n(){this.offset=0,this.startIndex=0,this._mat=$B.create()}$o($n,"laya.webgl.submit.SubmitOtherIBVB");var $c=$n.prototype;return $y.imps($c,{"laya.webgl.submit.ISubmit":!0}),$c.releaseRender=function(){var $c=$n._cache;($c[$c._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$c.getRenderType=function(){return 10009},$c.renderSubmit=function(){var $c=this._shaderValue.textureHost;if($c){var $d=$c.source;if(!$c.bitmap||!$d)return 1;this._shaderValue.texture=$d}this._vb.bind_upload(this._ib);var $e=$uc.worldMatrix4,$f=$B.TEMP;$B.mulPre(this._mat,$e[0],$e[1],$e[4],$e[5],$e[12],$e[13],$f);var $g=$uc.worldMatrix4=$n.tempMatrix4;$g[0]=$f.a,$g[1]=$f.b,$g[4]=$f.c,$g[5]=$f.d,$g[12]=$f.tx,$g[13]=$f.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var $h=$wc.mainContext;return $S.activeBlendFunction!==this._blendFn&&($h.enable(3042),this._blendFn($h),$S.activeBlendFunction=this._blendFn),$G.drawCall++,$G.trianglesFaces+=this._numEle/3,$h.drawElements(4,this._numEle,5123,this.startIndex),$uc.worldMatrix4=$e,$Lc.activeShader=null,1},$n.create=function($c,$d,$e,$f,$g,$h,$i,$j,$k){void 0===$k&&($k=0);var $l=$n._cache._length?$n._cache[--$n._cache._length]:new $n;$l._ib=$e,$l._vb=$d,$l._numEle=$f,$l._shader=$g,$l._shaderValue=$h;var $m=$c._nBlendType;switch($l._blendFn=$c._targets?$S.targetFns[$m]:$S.fns[$m],$k){case 0:$l.offset=0,$l.startIndex=$j/($rc.BYTES_PE*$d.vertexStride)*1.5,$l.startIndex*=$rc.BYTES_PIDX;break;case 1:$l.startIndex=$i,$l.offset=$j}return $l},$n._cache=(($n._cache=[])._length=0,$n._cache),$n.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$n}(),$lc=function(){function $e(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new $D,this.screenRect=new $D}$o($e,"laya.webgl.submit.SubmitScissor");var $c=$e.prototype;return $y.imps($c,{"laya.webgl.submit.ISubmit":!0}),$c._scissor=function($c,$d,$e,$f){var $g=$uc.worldMatrix4,$h=$g[0],$i=$g[5],$j=$g[12],$k=$g[13];if($f*=$i,($e*=$h)<1||$f<1)return!1;var $l=($c=$c*$h+$j)+$e,$m=($d=$d*$i+$k)+$f;$c<0&&($e=$l-($c=0)),$d<0&&($f=$m-($d=0));var $n=$uc.worldClipRect;if($c=Math.max($c,$n.x),$d=Math.max($d,$n.y),$e=Math.min($l,$n.right)-$c,$f=Math.min($m,$n.bottom)-$d,$e<1||$f<1)return!1;var $o=$uc.worldScissorTest;return this.screenRect.copyFrom($n),$n.x=$c,$n.y=$d,$n.width=$e,$n.height=$f,$uc.worldScissorTest=!0,$d=$uc.height-$d-$f,$wc.mainContext.scissor($c,$d,$e,$f),$wc.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$o?($d=$uc.height-this.screenRect.y-this.screenRect.height,$wc.mainContext.scissor(this.screenRect.x,$d,this.screenRect.width,this.screenRect.height),$wc.mainContext.enable(3089)):($wc.mainContext.disable(3089),$uc.worldScissorTest=!1),$n.copyFrom(this.screenRect),!0},$c._scissorWithTagart=function($c,$d,$e,$f){if($e<1||$f<1)return!1;var $g=$c+$e,$h=$d+$f;$c<0&&($e=$g-($c=0)),$d<0&&($f=$h-($d=0));var $i=$uc.worldClipRect;if($c=Math.max($c,$i.x),$d=Math.max($d,$i.y),$e=Math.min($g,$i.right)-$c,$f=Math.min($h,$i.bottom)-$d,$e<1||$f<1)return!1;var $j=$uc.worldScissorTest;return this.screenRect.copyFrom($i),$uc.worldScissorTest=!0,$i.x=$c,$i.y=$d,$i.width=$e,$i.height=$f,$d=$uc.height-$d-$f,$wc.mainContext.scissor($c,$d,$e,$f),$wc.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$j?($d=$uc.height-this.screenRect.y-this.screenRect.height,$wc.mainContext.scissor(this.screenRect.x,$d,this.screenRect.width,this.screenRect.height),$wc.mainContext.enable(3089)):($wc.mainContext.disable(3089),$uc.worldScissorTest=!1),$i.copyFrom(this.screenRect),!0},$c.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},$c.getRenderType=function(){return 0},$c.releaseRender=function(){var $c=$e._cache;($c[$c._length++]=this).context=null},$e.create=function($c){var $d=$e._cache._length?$e._cache[--$e._cache._length]:new $e;return $d.context=$c,$d},$e._cache=(($e._cache=[])._length=0,$e._cache),$e}(),$mc=function(){function $k(){this.step=0,this.blendMode=null,this.level=0}$o($k,"laya.webgl.submit.SubmitStencil");var $c=$k.prototype;return $y.imps($c,{"laya.webgl.submit.ISubmit":!0}),$c.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},$c.getRenderType=function(){return 0},$c.releaseRender=function(){var $c=$k._cache;$c[$c._length++]=this},$c.do1=function(){var $c=$wc.mainContext;$c.enable(2960),$c.clear(1024),$c.colorMask(!1,!1,!1,!1),$c.stencilFunc(514,this.level,255),$c.stencilOp(7680,7680,7682)},$c.do2=function(){var $c=$wc.mainContext;$c.stencilFunc(514,this.level+1,255),$c.colorMask(!0,!0,!0,!0),$c.stencilOp(7680,7680,7680)},$c.do3=function(){var $c=$wc.mainContext;$c.colorMask(!0,!0,!0,!0),$c.stencilOp(7680,7680,7680),$c.clear(1024),$c.disable(2960)},$c.do4=function(){var $c=$wc.mainContext;0==this.level&&($c.enable(2960),$c.clear(1024)),$c.colorMask(!1,!1,!1,!1),$c.stencilFunc(519,0,255),$c.stencilOp(7680,7680,7682)},$c.do5=function(){var $c=$wc.mainContext;$c.stencilFunc(514,this.level,255),$c.colorMask(!0,!0,!0,!0),$c.stencilOp(7680,7680,7680)},$c.do6=function(){var $c=$wc.mainContext;$S.targetFns[$S.TOINT[this.blendMode]]($c)},$c.do7=function(){var $c=$wc.mainContext;$c.colorMask(!1,!1,!1,!1),$c.stencilOp(7680,7680,7683)},$c.do8=function(){var $c=$wc.mainContext;$c.colorMask(!0,!0,!0,!0),$c.stencilFunc(514,this.level,255),$c.stencilOp(7680,7680,7680)},$k.restore=function($c,$d,$e,$f,$g){var $h;if(($c._renderKey=0)<$k._mask&&$k._mask--,0==$k._mask)$h=laya.webgl.submit.SubmitStencil.create(3),$c.addRenderObject($h),$c._curSubmit=$hc.RENDERBASE;else{$h=laya.webgl.submit.SubmitStencil.create(7),$c.addRenderObject($h);var $i=$c._vb;$i._byteLength;if($sc.fillRectImgVb($i,null,$d.x,$d.y,$d.width,$d.height,$K.DEF_UV,$e,$f,$g,0,0)){$c._shader2D.glTexture=null;var $j=$c._curSubmit=$hc.createSubmit($c,$c._ib,$i,($i._byteLength-64)/32*3,$Ac.create(2,0));$j.shaderValue.ALPHA=1,$c._submits[$c._submits._length++]=$j,$c._curSubmit._numEle+=6,$c._curSubmit=$hc.RENDERBASE}else alert("clipRect calc stencil rect error");$h=laya.webgl.submit.SubmitStencil.create(8),$c.addRenderObject($h)}},$k.restore2=function($c,$d){var $e;($c._renderKey=0)<$k._mask&&$k._mask--,0==$k._mask?($e=laya.webgl.submit.SubmitStencil.create(3),$c.addRenderObject($e),$c._curSubmit=$hc.RENDERBASE):($e=laya.webgl.submit.SubmitStencil.create(7),$c.addRenderObject($e),$c._submits[$c._submits._length++]=$d,$e=laya.webgl.submit.SubmitStencil.create(8),$c.addRenderObject($e))},$k.create=function($c){var $d=$k._cache._length?$k._cache[--$k._cache._length]:new $k;return 5==($d.step=$c)&&++$k._mask,$d.level=$k._mask,$d},$k._cache=(($k._cache=[])._length=0,$k._cache),$k._mask=0,$k}(),$nc=function(){function $j(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}$o($j,"laya.webgl.submit.SubmitTarget");var $c=$j.prototype;return $y.imps($c,{"laya.webgl.submit.ISubmit":!0}),$c.renderSubmit=function(){this._vb.bind_upload(this._ib);var $c=this.scope.getValue(this.proName);return $c&&(this.shaderValue.texture=$c.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[$c.width,$c.height]),this.shaderValue.upload(),this.blend(),$G.drawCall++,$G.trianglesFaces+=this._numEle/3,$wc.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},$c.blend=function(){if($S.activeBlendFunction!==$S.fns[this.blendType]){var $c=$wc.mainContext;$c.enable(3042),$S.fns[this.blendType]($c),$S.activeBlendFunction=$S.fns[this.blendType]}},$c.getRenderType=function(){return 0},$c.releaseRender=function(){var $c=$j._cache;($c[$c._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$j.create=function($c,$d,$e,$f,$g,$h){var $i=$j._cache._length?$j._cache[--$j._cache._length]:new $j;return $i._ib=$d,$i._vb=$e,$i.proName=$h,$i._startIdx=$f*$rc.BYTES_PIDX,$i._numEle=0,$i.blendType=$c._nBlendType,$i.shaderValue=$g,$i.shaderValue.setValue($c._shader2D),$i},$j._cache=(($j._cache=[])._length=0,$j._cache),$j}(),$oc=function(){function $c(){this._sourceStr=null}$o($c,"laya.webgl.text.CharSegment");var $d=$c.prototype;return $y.imps($d,{"laya.webgl.text.ICharSegment":!0}),$d.textToSpit=function($c){this._sourceStr=$c},$d.getChar=function($c){return this._sourceStr.charAt($c)},$d.getCharCode=function($c){return this._sourceStr.charCodeAt($c)},$d.length=function(){return this._sourceStr.length},$c}(),$pc=function(){var $c;function $G(){}return $o($G,"laya.webgl.text.DrawText"),$G.__init__=function(){$G._charsTemp=new Array,$G._drawValue=new $c,$G._charSeg=new $oc},$G.customCharSeg=function($c){$G._charSeg=$c},$G.getChar=function($c,$d,$e){var $f=$Vc.createOneChar($c,$e);return-1!=$d&&($G._charsCache[$d]=$f),$f},$G._drawSlow=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$n,$o,$p,$q){var $r,$s,$t=$G._drawValue.value($h,$j,$k,$l,$o,$p,$q),$u=0,$v=0,$w=$G._charsTemp,$x=0,$y=NaN;if($f)for($w.length=$f.length,$u=0,$v=$f.length;$u<$v;$u++)($s=$f[$u])&&($y=$s.charNum+$t.txtID,$w[$u]=$r=$G._charsCache[$y]||$G.getChar($s.char,$y,$t),$r.active());else{var $z=$e instanceof laya.utils.WordText?$e.toString():$e;if($J.CharacterCache){$G._charSeg.textToSpit($z);var $A=$G._charSeg.length();for($u=0,$v=$w.length=$A;$u<$v;$u++)$y=$G._charSeg.getCharCode($u)+$t.txtID,$w[$u]=$r=$G._charsCache[$y]||$G.getChar($G._charSeg.getChar($u),$y,$t),$r.active(),$x+=$r.cw}else $w.length=0,($r=$G.getChar($z,-1,$t)).active(),$x+=$r.cw,$w[0]=$r}var $B=0;null!==$i&&"left"!==$i&&($B=-("center"==$i?$x/2:$x));var $C,$D,$E=NaN,$F=0;if($f)for($u=0,$v=$w.length;$u<$v;$u++)$r=$w[$u],$s=$f[$u],$r&&$s&&!$r.isSpace&&($E=$r.borderSize,$C=$r.texture,$d._drawText($C,$m+$B+$s.x*$o-$E,$n+$s.y*$p-$E,$C.width,$C.height,$g,0,0,0,0));else{for($u=0,$v=$w.length;$u<$v;$u++)($r=$w[$u])&&!$r.isSpace&&($E=$r.borderSize,$C=$r.texture,$d._drawText($C,$m+$B-$E,$n-$E,$C.width,$C.height,$g,0,0,0,0),$c&&(($D=$c[$F++])||($D=$c[$F-1]=[]),$D[0]=$C,$D[1]=$B-$E,$D[2]=-$E)),$B+=$r.cw;$c&&($c.length=$F)}},$G._drawFast=function($c,$d,$e,$f,$g){for(var $h,$i,$j=0,$k=$c.length;$j<$k;$j++)($h=($i=$c[$j])[0]).active(),$d._drawText($h,$f+$i[1],$g+$i[2],$h.width,$h.height,$e,0,0,0,0)},$G.drawText=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$n){if(void 0===$n&&($n=0),!($d&&0===$d.length||$e&&0===$e.length)){var $o=$f.a,$p=$f.d;(0!==$f.b||0!==$f.c)&&($o=$p=1);var $q=1!==$o||1!==$p;if($q&&$y.stage.transform){var $r=$y.stage.transform;$q=$r.a===$o&&$r.d===$p}else $q=!1;if($q){var $s=($f=$f.copyTo($zc._tmpMatrix)).tx,$t=$f.ty;$f.scale(1/$o,1/$p),$f._checkTransform(),$l*=$o,$m*=$p,$l+=$s-$f.tx,$m+=$t-$f.ty}else $o=$p=1;if($e)$G._drawSlow(null,$c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$o,$p,$n);else{if(null===$d.toUpperCase){var $u=$o+1e5*$p,$v=$d;return void($v.changed||$v.id!==$u?($v.id=$u,$v.changed=!1,$G._drawSlow($v.save,$c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$o,$p,$n)):$G._drawFast($v.save,$c,$f,$l,$m))}var $w=$d+$g.toString()+$i+$j+$k+$o+$p+$h,$x=$G._textsCache[$w];$J.CharacterCache?$x?$G._drawFast($x,$c,$f,$l,$m):($G._textsCache.__length||($G._textsCache.__length=0),$G._textsCache.__length>$z.WebGLTextCacheCount&&(($G._textsCache={}).__length=0,$G._curPoolIndex=0),$G._textCachesPool[$G._curPoolIndex]?($x=$G._textsCache[$w]=$G._textCachesPool[$G._curPoolIndex]).length=0:$G._textCachesPool[$G._curPoolIndex]=$x=$G._textsCache[$w]=[],$G._textsCache.__length++,$G._curPoolIndex++,$G._drawSlow($x,$c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$o,$p,$n)):$G._drawSlow($x,$c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$o,$p,$n)}}},$G._charsTemp=null,$G._textCachesPool=[],$G._curPoolIndex=0,$G._charsCache={},$G._textsCache={},$G._drawValue=null,$G.d=[],$G._charSeg=null,$G.__init$=function(){$c=function(){function $k(){}return $o($k,""),$k.prototype.value=function($c,$d,$e,$f,$g,$h,$i){this.font=$c,this.fillColor=$d,this.borderColor=$e,this.lineWidth=$f,this.scaleX=$g,this.scaleY=$h,this.underLine=$i;var $j=$c.toString()+$g+$h+$f+($d?$d.toLowerCase():" ")+($e?$e.toLowerCase():" ")+$i;return this.txtID=$k._keymap[$j],this.txtID||(this.txtID=1e-7*++$k._keymapCount,$k._keymap[$j]=this.txtID),this},$k.clear=function(){$k._keymap={},$k._keymapCount=1},$k._keymap={},$k._keymapCount=1,$k}()},$G}(),$qc=function(){function $g($c){this._index=0,this._size=14,this._italic=-2,$g._cache2=$g._cache2||[],this.setFont($c||"14px Arial")}$o($g,"laya.webgl.text.FontInContext");var $c=$g.prototype;return $c.setFont=function($c){var $d=$g._cache2[$c];if($d)this._words=$d[0],this._size=$d[1];else{this._words=$c.split(" ");for(var $e=0,$f=this._words.length;$e<$f;$e++)if(0<this._words[$e].indexOf("px")){this._index=$e;break}this._size=parseInt(this._words[this._index]),$g._cache2[$c]=[this._words,this._size]}this._text=null,this._italic=-2},$c.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},$c.hasType=function($c){for(var $d=0,$e=this._words.length;$d<$e;$d++)if(this._words[$d]===$c)return $d;return-1},$c.removeType=function($c){for(var $d=0,$e=this._words.length;$d<$e;$d++)if(this._words[$d]===$c){this._words.splice($d,1),this._index>$d&&this._index--;break}this._text=null,this._italic=-2},$c.copyTo=function($c){return $c._text=this._text,$c._size=this._size,$c._index=this._index,$c._words=this._words.slice(),$c._italic=-2,$c},$c.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},$f(0,$c,"size",function(){return this._size},function($c){this._size=$c,this._words[this._index]=$c+"px",this._text=null}),$g.create=function($c){var $d=$g._cache[$c];return $d||($d=$g._cache[$c]=new $g($c))},$g.EMPTY=new $g,$g._cache={},$g._cache2=null,$g}(),$rc=function(){function $c(){}return $o($c,"laya.webgl.utils.CONST3D2D"),$c.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$c.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],$c.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],$c._TMPARRAY=[],$c._OFFSETX=0,$c._OFFSETY=0,$i($c,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),$c}(),$sc=function(){function $q(){}return $o($q,"laya.webgl.utils.GlUtils"),$q.make2DProjection=function($c,$d,$e){return[2/$c,0,0,0,0,-2/$d,0,0,0,0,2/$e,0,-1,1,0,1]},$q.fillIBQuadrangle=function($c,$d){if(65535/4<$d)throw Error("IBQuadrangle count:"+$d+" must<:"+Math.floor(65535/4));$d=Math.floor($d),$c._resizeBuffer(6*($d+1)*2,!1),$c.byteLength=$c.bufferLength;for(var $e=$c.getUint16Array(),$f=0,$g=0;$g<$d;$g++)$e[$f++]=4*$g,$e[$f++]=4*$g+2,$e[$f++]=4*$g+1,$e[$f++]=4*$g,$e[$f++]=4*$g+3,$e[$f++]=4*$g+2;return $c.setNeedUpload(),!0},$q.expandIBQuadrangle=function($c,$d){$c.bufferLength>=6*$d*2||$q.fillIBQuadrangle($c,$d)},$q.mathCeilPowerOfTwo=function($c){return $c--,$c|=$c>>1,$c|=$c>>2,$c|=$c>>4,$c|=$c>>8,$c|=$c>>16,++$c},$q.fillQuadrangleImgVb=function($c,$d,$e,$f,$g,$h,$i,$j){var $k=16+($c._byteLength>>2);$c.byteLength=$k<<2;var $l=$c.getFloat32Array();$l[($k-=16)+2]=$g[0],$l[$k+3]=$g[1],$l[$k+6]=$g[2],$l[$k+7]=$g[3],$l[$k+10]=$g[4],$l[$k+11]=$g[5],$l[$k+14]=$g[6],$l[$k+15]=$g[7];var $m=$h.a,$n=$h.b,$o=$h.c,$p=$h.d;if(1!==$m||0!==$n||0!==$o||1!==$p){$h.bTransform=!0;var $q=$h.tx+$i,$r=$h.ty+$j;$l[$k]=($f[0]+$d)*$m+($f[1]+$e)*$o+$q,$l[$k+1]=($f[0]+$d)*$n+($f[1]+$e)*$p+$r,$l[$k+4]=($f[2]+$d)*$m+($f[3]+$e)*$o+$q,$l[$k+5]=($f[2]+$d)*$n+($f[3]+$e)*$p+$r,$l[$k+8]=($f[4]+$d)*$m+($f[5]+$e)*$o+$q,$l[$k+9]=($f[4]+$d)*$n+($f[5]+$e)*$p+$r,$l[$k+12]=($f[6]+$d)*$m+($f[7]+$e)*$o+$q,$l[$k+13]=($f[6]+$d)*$n+($f[7]+$e)*$p+$r}else $h.bTransform=!1,$d+=$h.tx+$i,$e+=$h.ty+$j,$l[$k]=$d+$f[0],$l[$k+1]=$e+$f[1],$l[$k+4]=$d+$f[2],$l[$k+5]=$e+$f[3],$l[$k+8]=$d+$f[4],$l[$k+9]=$e+$f[5],$l[$k+12]=$d+$f[6],$l[$k+13]=$e+$f[7];return $c._upload=!0},$q.fillTranglesVB=function($c,$d,$e,$f,$g,$h,$i){var $j=($c._byteLength>>2)+$f.length;$c.byteLength=$j<<2;var $k=$c.getFloat32Array();$j-=$f.length;for(var $l=$f.length,$m=$g.a,$n=$g.b,$o=$g.c,$p=$g.d,$q=0;$q<$l;$q+=4)if($k[$j+$q+2]=$f[$q+2],$k[$j+$q+3]=$f[$q+3],1!==$m||0!==$n||0!==$o||1!==$p){$g.bTransform=!0;var $r=$g.tx+$h,$s=$g.ty+$i;$k[$j+$q]=($f[$q]+$d)*$m+($f[$q+1]+$e)*$o+$r,$k[$j+$q+1]=($f[$q]+$d)*$n+($f[$q+1]+$e)*$p+$s}else $g.bTransform=!1,$d+=$g.tx+$h,$e+=$g.ty+$i,$k[$j+$q]=$d+$f[$q],$k[$j+$q+1]=$e+$f[$q+1];return $c._upload=!0},$q.copyPreImgVb=function($c,$d,$e){var $f=$c._byteLength>>2;$c.byteLength=$f+16<<2;for(var $g=$c.getFloat32Array(),$h=0,$i=$f-16;$h<4;$h++)$g[$f]=$g[$i]+$d,++$i,$g[++$f]=$g[$i]+$e,++$i,$g[++$f]=$g[$i],++$i,$g[++$f]=$g[$i],++$f,++$i;$c._upload=!0},$q.fillRectImgVb=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$n,$o){void 0===$o&&($o=!1);var $p,$q,$r,$s,$t,$u,$v,$w,$x,$y,$z,$A,$B,$C,$D,$E,$F=1,$G=$j.a,$H=$j.b,$I=$j.c,$J=$j.d,$K=$d&&$d.width<99999999;if(1!==$G||0!==$H||0!==$I||1!==$J?($j.bTransform=!0,0===$H&&0===$I&&($F=23,$x=$g+$e,$y=$h+$f,$p=$G*$e+($z=$j.tx+$k),$r=$G*$x+$z,$q=$J*$f+($A=$j.ty+$l),$s=$J*$y+$A)):($F=23,$j.bTransform=!1,$r=($p=$e+$j.tx+$k)+$g,$s=($q=$f+$j.ty+$l)+$h),$K&&($t=$d.x,$u=$d.y,$v=$d.width+$t,$w=$d.height+$u),1!==$F){if(Math.min($p,$r)>=$v)return!1;if(Math.min($q,$s)>=$w)return!1;if(Math.max($r,$p)<=$t)return!1;if(Math.max($s,$q)<=$u)return!1}var $L=$c._byteLength>>2;$c.byteLength=16+$L<<2;var $M=$c.getFloat32Array();switch($M[2+$L]=$i[0],$M[3+$L]=$i[1],$M[6+$L]=$i[2],$M[7+$L]=$i[3],$M[10+$L]=$i[4],$M[11+$L]=$i[5],$M[14+$L]=$i[6],$M[15+$L]=$i[7],$F){case 1:$z=$j.tx+$k,$A=$j.ty+$l;var $N=$G*$e,$O=$I*$f,$P=$J*$f,$Q=$H*$e,$R=$G*($x=$g+$e),$S=$I*($y=$h+$f),$T=$J*$y,$U=$H*$x;$o?($B=$N+$O+$z,$D=Math.round($B)-$B,$C=$P+$Q+$A,$E=Math.round($C)-$C,$M[$L]=$B+$D,$M[1+$L]=$C+$E,$M[4+$L]=$R+$O+$z+$D,$M[5+$L]=$P+$U+$A+$E,$M[8+$L]=$R+$S+$z+$D,$M[9+$L]=$T+$U+$A+$E,$M[12+$L]=$N+$S+$z+$D,$M[13+$L]=$T+$Q+$A+$E):($M[$L]=$N+$O+$z,$M[1+$L]=$P+$Q+$A,$M[4+$L]=$R+$O+$z,$M[5+$L]=$P+$U+$A,$M[8+$L]=$R+$S+$z,$M[9+$L]=$T+$U+$A,$M[12+$L]=$N+$S+$z,$M[13+$L]=$T+$Q+$A);break;case 23:$o?($B=$p+$m,$D=Math.round($B)-$B,$C=$q,$E=Math.round($C)-$C,$M[$L]=$B+$D,$M[1+$L]=$C+$E,$M[4+$L]=$r+$m+$D,$M[5+$L]=$q+$E,$M[8+$L]=$r+$D,$M[9+$L]=$s+$E,$M[12+$L]=$p+$D,$M[13+$L]=$s+$E):($M[$L]=$p+$m,$M[1+$L]=$q,$M[4+$L]=$r+$m,$M[5+$L]=$q,$M[8+$L]=$r,$M[9+$L]=$s,$M[12+$L]=$p,$M[13+$L]=$s)}return $c._upload=!0},$q.fillLineVb=function($c,$d,$e,$f,$g,$h,$i,$j){var $k=.5*$i,$l=$q._fillLineArray,$m=-($f-$h),$n=$e-$g,$o=Math.sqrt($m*$m+$n*$n);$m/=$o,$n/=$o,$m*=$k,$n*=$k,$l[0]=$e-$m,$l[1]=$f-$n,$l[4]=$e+$m,$l[5]=$f+$n,$l[8]=$g+$m,$l[9]=$h+$n,$l[12]=$g-$m,$l[13]=$h-$n,$j&&$j.transformPointArray($l,$l);var $p=16+($c._byteLength>>2);return $c.byteLength=$p<<2,$c.insertData($l,$p-16),!0},$q._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$q}(),$tc=(function(){function $k(){}$o($k,"laya.webgl.utils.MatirxArray"),$k.ArrayMul=function($c,$d,$e){if($c)if($d)for(var $f=NaN,$g=NaN,$h=NaN,$i=NaN,$j=0;$j<4;$j++)$f=$c[$j],$g=$c[$j+4],$h=$c[$j+8],$i=$c[$j+12],$e[$j]=$f*$d[0]+$g*$d[1]+$h*$d[2]+$i*$d[3],$e[$j+4]=$f*$d[4]+$g*$d[5]+$h*$d[6]+$i*$d[7],$e[$j+8]=$f*$d[8]+$g*$d[9]+$h*$d[10]+$i*$d[11],$e[$j+12]=$f*$d[12]+$g*$d[13]+$h*$d[14]+$i*$d[15];else $k.copyArray($c,$e);else $k.copyArray($d,$e)},$k.copyArray=function($c,$d){if($c&&$d)for(var $e=0;$e<$c.length;$e++)$d[$e]=$c[$e]}}(),function(){function $d($c,$d,$e){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=$c,this._vb=new $bc($c,35048),$d&&this._vb._resizeBuffer($d,!1),this._ib=new $ac,$e&&this._ib._resizeBuffer($e,!1)}$o($d,"laya.webgl.utils.Mesh2D");var $c=$d.prototype;return $c.cloneWithNewVB=function(){var $c=new $d(this._stride,0,0);return $c._ib=this._ib,$c._quadNum=this._quadNum,$c._attribInfo=this._attribInfo,$c},$c.cloneWithNewVBIB=function(){var $c=new $d(this._stride,0,0);return $c._attribInfo=this._attribInfo,$c},$c.getVBW=function(){return this._vb.setNeedUpload(),this._vb},$c.getVBR=function(){return this._vb},$c.getIBR=function(){return this._ib},$c.getIBW=function(){return this._ib.setNeedUpload(),this._ib},$c.createQuadIB=function($c){this._quadNum=$c,this._ib._resizeBuffer(6*$c*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var $d=this._ib.getUint16Array(),$e=0,$f=0,$g=0;$g<$c;$g++)$d[$e++]=$f,$d[$e++]=$f+2,$d[$e++]=$f+1,$d[$e++]=$f,$d[$e++]=$f+3,$d[$e++]=$f+2,$f+=4;this._ib.setNeedUpload()},$c.setAttributes=function($c){if(this._attribInfo=$c,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},$c.getEleNum=function(){return this._ib.getBuffer().byteLength/2},$c.releaseMesh=function(){},$c.destroy=function(){},$c.clearVB=function(){this._vb.clear()},$d._gvaoid=0,$d}()),$uc=function(){function $g(){}return $o($g,"laya.webgl.utils.RenderState2D"),$g.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},$g.mat2MatArray=function($c,$d){var $e=$c,$f=$d;return $f[0]=$e.a,$f[1]=$e.b,$f[2]=$g.EMPTYMAT4_ARRAY[2],$f[3]=$g.EMPTYMAT4_ARRAY[3],$f[4]=$e.c,$f[5]=$e.d,$f[6]=$g.EMPTYMAT4_ARRAY[6],$f[7]=$g.EMPTYMAT4_ARRAY[7],$f[8]=$g.EMPTYMAT4_ARRAY[8],$f[9]=$g.EMPTYMAT4_ARRAY[9],$f[10]=$g.EMPTYMAT4_ARRAY[10],$f[11]=$g.EMPTYMAT4_ARRAY[11],$f[12]=$e.tx,$f[13]=$e.ty,$f[14]=$g.EMPTYMAT4_ARRAY[14],$f[15]=$g.EMPTYMAT4_ARRAY[15],$d},$g.restoreTempArray=function(){$g.TEMPMAT4_ARRAY[0]=1,$g.TEMPMAT4_ARRAY[1]=0,$g.TEMPMAT4_ARRAY[4]=0,$g.TEMPMAT4_ARRAY[5]=1,$g.TEMPMAT4_ARRAY[12]=0,$g.TEMPMAT4_ARRAY[13]=0},$g.clear=function(){$g.worldScissorTest=!1,$g.worldShaderDefines=null,$g.worldFilters=null,$g.worldAlpha=1,$g.worldClipRect.x=$g.worldClipRect.y=0,$g.worldClipRect.width=$g.width,$g.worldClipRect.height=$g.height,$g.curRenderTarget=null},$g._MAXSIZE=99999999,$g.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$g.worldMatrix4=$g.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$g.worldAlpha=1,$g.worldScissorTest=!1,$g.worldFilters=null,$g.worldShaderDefines=null,$g.curRenderTarget=null,$g.width=0,$g.height=0,$i($g,["worldMatrix",function(){return this.worldMatrix=new $B},"worldClipRect",function(){return this.worldClipRect=new $D(0,0,99999999,99999999)}]),$g}(),$vc=function(){var $u,$e;function $v($c,$d,$e,$f,$g){var $h=this;function $i($c){var $d=[],$e=new $u($d);return $h._compileToTree($e,$c.split("\n"),0,$d,$g),$e}var $j=$p.now();this._VS=$i($d),this._PS=$i($e),this._nameMap=$f,2<$p.now()-$j&&console.log("ShaderCompile use time:"+($p.now()-$j)+"  size:"+$d.length+"/"+$e.length)}$o($v,"laya.webgl.utils.ShaderCompile");var $c=$v.prototype;return $c._compileToTree=function($c,$d,$e,$f,$g){var $h,$i,$j,$k,$l,$m,$n,$o=0,$p=0,$q=0,$r=0;for($p=$e;$p<$d.length;$p++)if(!(($j=$d[$p]).length<1)&&0!==($o=$j.indexOf("//"))){if(0<=$o&&($j=$j.substr(0,$o)),$h=$n||new $u($f),$n=null,$h.text=$j,$h.noCompile=!0,0<=($o=$j.indexOf("#"))){for($k="#",$r=$o+1,$q=$j.length;$r<$q;$r++){var $s=$j.charAt($r);if(" "===$s||"\t"===$s||"\r"===$s||"\n"===$s||"?"===$s)break;$k+=$s}switch($h.name=$k){case"#ifdef":case"#ifndef":if($h.src=$j,$h.noCompile=null!=$j.match(/[!&|()=<>]/),$h.noCompile?console.log("function():Boolean{return "+$j.substr($o+$h.name.length)+"}"):($m=$j.replace(/^\s*/,"").split(/\s+/),$h.setCondition($m[1],"#ifdef"===$k?1:2),$h.text="//"+$h.text),$h.setParent($c),$c=$h,$g)for($m=$j.substr($r).split($v._splitToWordExps3),$r=0;$r<$m.length;$r++)($j=$m[$r]).length&&($g[$j]=!0);continue;case"#if":if($h.src=$j,$h.noCompile=!0,$h.setParent($c),$c=$h,$g)for($m=$j.substr($r).split($v._splitToWordExps3),$r=0;$r<$m.length;$r++)($j=$m[$r]).length&&"defined"!=$j&&($g[$j]=!0);continue;case"#else":$h.src=$j,$i=($c=$c.parent).childs[$c.childs.length-1],$h.noCompile=$i.noCompile,$h.noCompile||($h.condition=$i.condition,$h.conditionType=1==$i.conditionType?2:1,$h.text="//"+$h.text+" "+$i.text+" "+$h.conditionType),$h.setParent($c),$c=$h;continue;case"#endif":$i=($c=$c.parent).childs[$c.childs.length-1],$h.noCompile=$i.noCompile,$h.noCompile||($h.text="//"+$h.text),$h.setParent($c);continue;case"#include":$m=$v.splitToWords($j,null);var $t=$v.includes[$m[1]];if(!$t)throw"ShaderCompile error no this include file:"+$m[1];if(($o=$m[0].indexOf("?"))<0){$h.setParent($c),$j=$t.getWith("with"==$m[2]?$m[3]:null),this._compileToTree($h,$j.split("\n"),0,$f,$g),$h.text="";continue}$h.setCondition($m[0].substr($o+1),1),$h.text=$t.getWith("with"==$m[2]?$m[3]:null);break;case"#import":$l=($m=$v.splitToWords($j,null))[1],$f.push({node:$h,file:$v.includes[$l],ofs:$h.text.length});continue}}else{if(($i=$c.childs[$c.childs.length-1])&&!$i.name){0<$f.length&&$v.splitToWords($j,$i),$n=$h,$i.text+="\n"+$j;continue}0<$f.length&&$v.splitToWords($j,$h)}$h.setParent($c)}},$c.createShader=function($c,$d,$e){var $f={},$g="";if($c)for(var $h in $c)$g+="#define "+$h+"\n",$f[$h]=!0;var $i=this._VS.toscript($f,[]),$j=this._PS.toscript($f,[]);return($e||$Yc.create)($g+$i.join("\n"),$g+$j.join("\n"),$d,this._nameMap)},$v._parseOne=function($c,$d,$e,$f,$g,$h){var $i={type:$v.shaderParamsMap[$e[$f+1]],name:$e[$f+2],size:isNaN(parseInt($e[$f+3]))?1:parseInt($e[$f+3])};return $h&&("attribute"==$g?$c.push($i):$d.push($i)),":"==$e[$f+3]&&($i.type=$e[$f+4],$f+=2),$f+=2},$v.addInclude=function($c,$d){if(!$d||0===$d.length)throw new Error("add shader include file err:"+$c);if($v.includes[$c])throw new Error("add shader include file err, has add:"+$c);$v.includes[$c]=new $e($d)},$v.preGetParams=function($c,$d){var $e=[$c,$d],$f={},$g=[],$h=[],$i={},$j=[];$f.attributes=$g,$f.uniforms=$h,$f.defines=$i;for(var $k=0,$l=0,$m=0;$m<2;$m++){$e[$m]=$e[$m].replace($v._removeAnnotation,"");var $n,$o=$e[$m].match($v._reg);for($k=0,$l=$o.length;$k<$l;$k++){var $p=$o[$k];if("attribute"==$p||"uniform"==$p)$k=$v._parseOne($g,$h,$o,$k,$p,!0);else{if("#define"==$p){$j[$p=$o[++$k]]=1;continue}if("#ifdef"==$p){$i[$n=$o[++$k]]=$i[$n]||[];for($k++;$k<$l;$k++)if("attribute"==($p=$o[$k])||"uniform"==$p)$k=$v._parseOne($g,$h,$o,$k,$p,$j[$n]);else if("#else"==$p)for($k++;$k<$l;$k++)if("attribute"==($p=$o[$k])||"uniform"==$p)$k=$v._parseOne($g,$h,$o,$k,$p,!$j[$n]);else if("#endif"==$p)break}}}}return $f},$v.splitToWords=function($c,$d){for(var $e,$f,$g=[],$h=-1,$i=0,$j=$c.length;$i<$j;$i++)if($e=$c.charAt($i),0<=" \t=+-*/&%!<>()'\",;".indexOf($e)){if(0<=$h&&1<$i-$h&&($f=$c.substr($h,$i-$h),$g.push($f)),'"'==$e||"'"==$e){var $k=$c.indexOf($e,$i+1);if($k<0)throw"Sharder err:"+$c;$g.push($c.substr($i+1,$k-$i-1)),$i=$k,$h=-1;continue}"("==$e&&$d&&0<$g.length&&($f=$g[$g.length-1]+";","vec4;main;".indexOf($f)<0&&($d.useFuns+=$f)),$h=-1}else $h<0&&($h=$i);return $h<$j&&1<$j-$h&&($f=$c.substr($h,$j-$h),$g.push($f)),$g},$v.IFDEF_NO=0,$v.IFDEF_YES=1,$v.IFDEF_ELSE=2,$v.IFDEF_PARENT=3,$v._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),$v._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),$v._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),$v.includes={},$i($v,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),$v.__init$=function(){$u=function(){function $e($c){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=$c}$o($e,"");var $c=$e.prototype;return $c.setParent=function($c){$c.childs.push(this),this.z=$c.z+1,this.parent=$c},$c.setCondition=function($c,$d){$c&&(this.conditionType=$d,$c=$c.replace(/(\s*$)/g,""),this.condition=function(){return this[$c]},this.condition.__condition=$c)},$c.toscript=function($c,$d){return this._toscript($c,$d,++$e.__id)},$c._toscript=function($f,$g,$h){if(this.childs.length<1&&!this.text)return $g;$g.length;if(this.condition){var $c=!!this.condition.call($f);if(2===this.conditionType&&($c=!$c),!$c)return $g}if(this.text&&$g.push(this.text),0<this.childs.length&&this.childs.forEach(function($c,$d,$e){$c._toscript($f,$g,$h)}),0<this.includefiles.length&&0<this.useFuns.length)for(var $d,$e=0,$i=this.includefiles.length;$e<$i;$e++)this.includefiles[$e].curUseID!=$h&&0<($d=this.includefiles[$e].file.getFunsScript(this.useFuns)).length&&(this.includefiles[$e].curUseID=$h,$g[0]=$d+$g[0]);return $g},$e.__id=1,$e}(),$e=function(){function $c($c){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=$c;for(var $d=0,$e=0,$f=0;!(($d=$c.indexOf("#begin",$d))<0);){for($f=$d+5;!(($f=$c.indexOf("#end",$f))<0)&&"i"===$c.charAt($f+4);)$f+=5;if($f<0)throw"add include err,no #end:"+$c;$e=$c.indexOf("\n",$d);var $g=$v.splitToWords($c.substr($d,$e-$d),null);"code"==$g[1]?this.codes[$g[2]]=$c.substr($e+1,$f-$e-1):"function"==$g[1]&&($e=$c.indexOf("function",$d),$e+="function".length,this.funs[$g[3]]=$c.substr($e+1,$f-$e-1),this.funnames+=$g[3]+";"),$d=$f+1}}$o($c,"");var $d=$c.prototype;return $d.getWith=function($c){var $d=$c?this.codes[$c]:this.script;if(!$d)throw"get with error:"+$c;return $d},$d.getFunsScript=function($c){var $d="";for(var $e in this.funs)0<=$c.indexOf($e+";")&&($d+=this.funs[$e]);return $d},$c}()},$v}(),$wc=function(){function $i(){}return $o($i,"laya.webgl.WebGL"),$i._uint8ArraySlice=function(){for(var $c=this.length,$d=new Uint8Array(this.length),$e=0;$e<$c;$e++)$d[$e]=this[$e];return $d},$i._float32ArraySlice=function(){for(var $c=this.length,$d=new Float32Array(this.length),$e=0;$e<$c;$e++)$d[$e]=this[$e];return $d},$i._uint16ArraySlice=function($c){var $d,$e=arguments,$f=0,$g=0;if(0===$e.length)for($f=this.length,$d=new Uint16Array($f),$g=0;$g<$f;$g++)$d[$g]=this[$g];else if(2===$e.length){var $h=$e[0],$i=$e[1];if($h<$i)for($f=$i-$h,$d=new Uint16Array($f),$g=$h;$g<$i;$g++)$d[$g-$h]=this[$g];else $d=new Uint16Array(0)}return $d},$i.expandContext=function(){var $c=$g.prototype,$d=CanvasRenderingContext2D.prototype;$d.fillTrangles=$c.fillTrangles,$Zc.__int__(null),$d.setIBVB=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){void 0===$k&&($k=0),void 0===$l&&($l=0),null===$e&&(this._ib=this._ib||$ac.QuadrangleIB,$e=this._ib,$sc.expandIBQuadrangle($e,$f._byteLength/64+8)),this._setIBVB($c,$d,$e,$f,$g,$h,$i,$j,$k,$l)},$d.fillTrangles=function($c,$d,$e,$f,$g){this._curMat=this._curMat||$B.create(),this._vb=this._vb||$bc.create(),this._ib||(this._ib=$ac.create(),$sc.fillIBQuadrangle(this._ib,$i/4));var $h=this._vb,$i=$f.length>>4;$sc.fillTranglesVB($h,$d,$e,$f,$g||this._curMat,0,0),$sc.expandIBQuadrangle(this._ib,$h._byteLength/64+8);var $j=new $Ac(1,0);$j.textureHost=$c;var $k=new $_c("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");$h._vertType=3,this._setIBVB($d,$e,this._ib,$h,6*$i,$g,$k,$j,0,0)}},$i.enable=function(){if($p.__init__(),$t.isConchApp&&!$t.isConchWebGL)return $x.skinAniSprite=function(){return new $cc},$i.expandContext(),!1;if($x.getWebGLContext=function($c){for(var $d,$e=["webgl","experimental-webgl","webkit-3d","moz-webgl"],$f=0;$f<$e.length;$f++){try{$d=$c.getContext($e[$f],{stencil:$z.isStencil,alpha:$z.isAlpha,antialias:$z.isAntialias,premultipliedAlpha:$z.premultipliedAlpha,preserveDrawingBuffer:$z.preserveDrawingBuffer})}catch($c){}if($d)return $d}return null},null==($i.mainContext=$x.getWebGLContext($t._mainCanvas)))return!1;if($t.isWebGL)return!0;$r.create=function($c,$d){return new $cd($c,$d)},$s.create=function($c,$d,$e,$f,$g,$h,$i){return new $Xc($c,$d,$e,$f,$g,$h,$i)},$t.WebGL=$i,$t.isWebGL=!0,$pc.__init__(),$x.createRenderSprite=function($c,$d){return new $Bc($c,$d)},$x.createWebGLContext2D=function($c){return new $zc($c)},$x.changeWebGLSize=function($c,$d){laya.webgl.WebGL.onStageResize($c,$d)},$x.createGraphics=function(){return new $yc};var $c=$x.createFilterAction;return $x.createFilterAction=$c||function($c){return new $Cc},$x.clear=function($c){$uc.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var $d=$t.context.ctx,$e=0==$d._submits._length||$z.preserveDrawingBuffer?$q.create($c)._color:$F._wgColor;$e&&$d.clearBG($e[0],$e[1],$e[2],$e[3]),$uc.clear()},$x.addToAtlas=function($c,$d){void 0===$d&&($d=!1);var $e=$c.bitmap;$t.optimizeTextureMemory($c.url,$c)?$y.__typeof($e,"laya.webgl.resource.IMergeAtlasBitmap")&&$e.allowMerageInAtlas&&$e.on("recovered",$c,$c.addTextureToAtlas):$e.enableMerageInAtlas=!1},$x.isAtlas=function($c){return $c instanceof laya.webgl.atlas.AtlasWebGLCanvas},$Q._enable(),$x.beginFlush=function(){for(var $c=$Q.instance,$d=$c.getAtlaserCount(),$e=0;$e<$d;$e++){var $f=$c.getAtlaserByIndex($e).texture;$f._flashCacheImageNeedFlush&&$x.flashFlushImage($f)}},$x.drawToCanvas=function($c,$d,$e,$f,$g,$h){($e<=0||$f<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),$e|=0,$f|=0,$g|=0,$h|=0;var $i=$Mc.create($e,$f,6408,5121,0,!1);$i.start(),$i.clear(0,0,0,0),$t.context.clear(),$u.renders[$d]._fun($c,$t.context,$g,$uc.height-$f+$h),$t.context.flush(),$i.end();var $j=$i.getData(0,0,$e,$f);if($i.recycle(),$j.byteLength==$e*$f*4){var $k=new $Uc;$k._canvas=$p.createElement("canvas"),$k.size($e,$f);var $l=$k._canvas.getContext("2d");$p.canvas.size($e,$f);var $m=$p.context,$n=$m.createImageData($e,$f);return $n.data.set(new Uint8ClampedArray($j.buffer)),$k._imgData=$n,$m.putImageData($n,0,0),$l.save(),$l.translate(0,$f),$l.scale(1,-1),$l.drawImage($p.canvas.source,0,0),$l.restore(),$k}console.log("drawToCanvas error: w:"+$e+",h:"+$f+",datalen:"+$j.byteLength)},$x.createFilterAction=function($c){var $d;switch($c){case 32:$d=new $Cc}return $d},$x.addTextureToAtlas=function($c){$c._uvID++,$Q._atlasRestore++,$c.bitmap.enableMerageInAtlas&&$Q.instance.addToAtlas($c)},$x.getTexturePixels=function($c,$d,$e,$f,$g){$t.context.ctx.clear();var $h=new $E;$h.graphics.drawTexture($c,-$d,-$e);var $i=$Mc.create($f,$g);$i.start(),$i.clear(0,0,0,0),$h.render($t.context,0,0),$t.context.ctx.flush(),$i.end();for(var $j=$i.getData(0,0,$f,$g),$k=[],$l=0,$m=$g-1;0<=$m;$m--)for(var $n=0;$n<$f;$n++)$l=4*($m*$f+$n),$k.push($j[$l]),$k.push($j[$l+1]),$k.push($j[$l+2]),$k.push($j[$l+3]);return $k},$x.skinAniSprite=function(){return new $cc},$l.create=function($c,$d){var $e=new $Uc;return $e._imgData=$d,$e.flipY=!1,$e},$A._filterStart=function($c,$d,$e,$f,$g){var $h=$c.getValue("bounds"),$i=$Mc.create($h.width,$h.height);if($i.start(),$i.clear(0,0,0,0),$c.addValue("src",$i),$c.addValue("ScissorTest",$uc.worldScissorTest),$uc.worldScissorTest){var $j=new $D;$j.copyFrom($e.ctx._clipRect),$c.addValue("clipRect",$j),$uc.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},$A._filterEnd=function($c,$d,$e,$f,$g){var $h=$c.getValue("bounds");$c.getValue("src").end();var $i=$Mc.create($h.width,$h.height);$i.start(),$i.clear(0,0,0,0),$c.addValue("out",$i),$d._set$P("_filterCache",$i),$d._set$P("_isHaveGlowFilter",$c.getValue("_isHaveGlowFilter"))},$A._EndTarget=function($c,$d){if($c.getValue("src").recycle(),$c.getValue("out").end(),$c.getValue("ScissorTest")){$uc.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),$d.ctx.save();var $e=$c.getValue("clipRect");$d.ctx.clipRect($e.x,$e.y,$e.width,$e.height)}},$A._useSrc=function($c){var $d=$c.getValue("out");$d.end(),($d=$c.getValue("src")).start(),$d.clear(0,0,0,0)},$A._endSrc=function($c){$c.getValue("src").end()},$A._useOut=function($c){var $d=$c.getValue("src");$d.end(),($d=$c.getValue("out")).start(),$d.clear(0,0,0,0)},$A._endOut=function($c){$c.getValue("out").end()},$A._recycleScope=function($c){$c.recycle()},$A._filter=function($c,$d,$e,$f){var $g=this._next;if($g){var $h,$i,$j=$c.filters,$k=$j.length;if(1==$k&&32==$j[0].type)return $d.ctx.save(),$d.ctx.setFilters([$j[0]]),$g._fun.call($g,$c,$d,$e,$f),void $d.ctx.restore();var $l=$jc.create(),$m=$C.TEMP,$n=$d.ctx._getTransformMatrix(),$o=$B.create();$n.copyTo($o);var $p=0,$q=0,$r=!1,$s=$c._$P._filterCache?$c._$P._filterCache:null;if(!$s||$c._repaint){$r=$c._isHaveGlowFilter(),$l.addValue("_isHaveGlowFilter",$r),$r&&($p=50,$q=25),($i=new $D).copyFrom($c.getSelfBounds()),$i.x+=$c.x,$i.y+=$c.y,$i.x-=$c.pivotX+4,$i.y-=$c.pivotY+4;var $t=$i.x,$u=$i.y;if($i.width+=$p+8,$i.height+=$p+8,$m.x=$i.x*$o.a+$i.y*$o.c,$m.y=$i.y*$o.d+$i.x*$o.b,$i.x=$m.x,$i.y=$m.y,$m.x=$i.width*$o.a+$i.height*$o.c,$m.y=$i.height*$o.d+$i.width*$o.b,$i.width=$m.x,$i.height=$m.y,$i.width<=0||$i.height<=0)return;$s&&$s.recycle(),$l.addValue("bounds",$i);var $v=$ic.create([$l,$c,$d,0,0],$A._filterStart);$d.addRenderObject($v),$d.ctx._renderKey=0,$d.ctx._shader2D.glTexture=null;var $w=$c.x-$t+$q,$x=$c.y-$u+$q;$g._fun.call($g,$c,$d,$w,$x),$v=$ic.create([$l,$c,$d,0,0],$A._filterEnd),$d.addRenderObject($v);for(var $y=0;$y<$k;$y++){0!=$y&&($v=$ic.create([$l],$A._useSrc),$d.addRenderObject($v),$h=$Ac.create(1,0),$B.TEMP.identity(),$d.ctx.drawTarget($l,0,0,$i.width,$i.height,$B.TEMP,"out",$h,null,$S.TOINT.overlay),$v=$ic.create([$l],$A._useOut),$d.addRenderObject($v)),$j[$y].action.apply3d($l,$c,$d,0,0)}$v=$ic.create([$l,$d],$A._EndTarget),$d.addRenderObject($v)}else{if(($r=!!$c._$P._isHaveGlowFilter&&$c._$P._isHaveGlowFilter)&&($p=50,$q=25),($i=$c.getBounds()).width<=0||$i.height<=0)return;$i.width+=$p,$i.height+=$p,$m.x=$i.x*$o.a+$i.y*$o.c,$m.y=$i.y*$o.d+$i.x*$o.b,$i.x=$m.x,$i.y=$m.y,$m.x=$i.width*$o.a+$i.height*$o.c,$m.y=$i.height*$o.d+$i.width*$o.b,$i.width=$m.x,$i.height=$m.y,$l.addValue("out",$s)}$e=$e-$q-$c.x,$f=$f-$q-$c.y,$m.setTo($e,$f),$o.transformPoint($m),$e=$m.x+$i.x,$f=$m.y+$i.y,$h=$Ac.create(1,0),$B.TEMP.identity(),$d.ctx.drawTarget($l,$e,$f,$i.width,$i.height,$B.TEMP,"out",$h,null,$S.TOINT.overlay),$v=$ic.create([$l],$A._recycleScope),$d.addRenderObject($v),$o.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=$i._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=$i._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=$i._uint8ArraySlice),!0},$i.onStageResize=function($c,$d){null!=$i.mainContext&&($i.mainContext.viewport(0,0,$c,$d),$uc.width=$c,$uc.height=$d)},$i.onInvalidGLRes=function(){$Q.instance.freeAll(),$w.releaseContentManagers(!0),$i.doNodeRepaint($y.stage),$i.mainContext.viewport(0,0,$uc.width,$uc.height),$y.stage.event("devicelost")},$i.doNodeRepaint=function($c){0==$c.numChildren&&$c.repaint();for(var $d=0;$d<$c.numChildren;$d++)$i.doNodeRepaint($c.getChildAt($d))},$i.init=function($c,$d,$e){$i.mainCanvas=$c,$l._createContext=function($c){return new $zc($c)},$Uc._createContext=function($c){return new $zc($c)};var $f=laya.webgl.WebGL.mainContext;if(null!=$f.getShaderPrecisionFormat){var $g=$f.getShaderPrecisionFormat(35633,36338),$h=$f.getShaderPrecisionFormat(35632,36338);$i.shaderHighPrecision=!(!$g.precision||!$h.precision)}else $i.shaderHighPrecision=!1;if($f.deleteTexture1=$f.deleteTexture,$f.deleteTexture=function($c){$c==$xc.curBindTexValue&&($xc.curBindTexValue=null),$f.deleteTexture1($c)},$i.onStageResize($d,$e),null==$i.mainContext)throw new Error("webGL getContext err!");$I.__init__(),$Q.__init__(),$Ec.__init__(),$hc.__init__(),$zc.__init__(),$Ac.__init__(),$a.__init__(),$Zc.__int__($f),$S._init_($f),$t.isConchApp&&conch.setOnInvalidGLRes($i.onInvalidGLRes)},$i.mainCanvas=null,$i.mainContext=null,$i.antialias=!0,$i.shaderHighPrecision=!1,$i._bg_null=[0,0,0,0],$i}(),$xc=function(){function $f(){}return $o($f,"laya.webgl.WebGLContext"),$f.UseProgram=function($c){return $f._useProgram!==$c&&($wc.mainContext.useProgram($c),$f._useProgram=$c,!0)},$f.setDepthTest=function($c,$d){$d!==$f._depthTest&&(($f._depthTest=$d)?$c.enable(2929):$c.disable(2929))},$f.setDepthMask=function($c,$d){$d!==$f._depthMask&&($f._depthMask=$d,$c.depthMask($d))},$f.setDepthFunc=function($c,$d){$d!==$f._depthFunc&&($f._depthFunc=$d,$c.depthFunc($d))},$f.setBlend=function($c,$d){$d!==$f._blend&&(($f._blend=$d)?$c.enable(3042):$c.disable(3042))},$f.setBlendFunc=function($c,$d,$e){($d!==$f._sFactor||$e!==$f._dFactor)&&($f._sFactor=$d,$f._dFactor=$e,$c.blendFunc($d,$e))},$f.setCullFace=function($c,$d){$d!==$f._cullFace&&(($f._cullFace=$d)?$c.enable(2884):$c.disable(2884))},$f.setFrontFace=function($c,$d){$d!==$f._frontFace&&($f._frontFace=$d,$c.frontFace($d))},$f.bindTexture=function($c,$d,$e){$c.bindTexture($d,$e),$f.curBindTexTarget=$d,$f.curBindTexValue=$e},$f.DEPTH_BUFFER_BIT=256,$f.STENCIL_BUFFER_BIT=1024,$f.COLOR_BUFFER_BIT=16384,$f.POINTS=0,$f.LINES=1,$f.LINE_LOOP=2,$f.LINE_STRIP=3,$f.TRIANGLES=4,$f.TRIANGLE_STRIP=5,$f.TRIANGLE_FAN=6,$f.ZERO=0,$f.ONE=1,$f.SRC_COLOR=768,$f.ONE_MINUS_SRC_COLOR=769,$f.SRC_ALPHA=770,$f.ONE_MINUS_SRC_ALPHA=771,$f.DST_ALPHA=772,$f.ONE_MINUS_DST_ALPHA=773,$f.DST_COLOR=774,$f.ONE_MINUS_DST_COLOR=775,$f.SRC_ALPHA_SATURATE=776,$f.FUNC_ADD=32774,$f.BLEND_EQUATION=32777,$f.BLEND_EQUATION_RGB=32777,$f.BLEND_EQUATION_ALPHA=34877,$f.FUNC_SUBTRACT=32778,$f.FUNC_REVERSE_SUBTRACT=32779,$f.BLEND_DST_RGB=32968,$f.BLEND_SRC_RGB=32969,$f.BLEND_DST_ALPHA=32970,$f.BLEND_SRC_ALPHA=32971,$f.CONSTANT_COLOR=32769,$f.ONE_MINUS_CONSTANT_COLOR=32770,$f.CONSTANT_ALPHA=32771,$f.ONE_MINUS_CONSTANT_ALPHA=32772,$f.BLEND_COLOR=32773,$f.ARRAY_BUFFER=34962,$f.ELEMENT_ARRAY_BUFFER=34963,$f.ARRAY_BUFFER_BINDING=34964,$f.ELEMENT_ARRAY_BUFFER_BINDING=34965,$f.STREAM_DRAW=35040,$f.STATIC_DRAW=35044,$f.DYNAMIC_DRAW=35048,$f.BUFFER_SIZE=34660,$f.BUFFER_USAGE=34661,$f.CURRENT_VERTEX_ATTRIB=34342,$f.FRONT=1028,$f.BACK=1029,$f.CULL_FACE=2884,$f.FRONT_AND_BACK=1032,$f.BLEND=3042,$f.DITHER=3024,$f.STENCIL_TEST=2960,$f.DEPTH_TEST=2929,$f.SCISSOR_TEST=3089,$f.POLYGON_OFFSET_FILL=32823,$f.SAMPLE_ALPHA_TO_COVERAGE=32926,$f.SAMPLE_COVERAGE=32928,$f.NO_ERROR=0,$f.INVALID_ENUM=1280,$f.INVALID_VALUE=1281,$f.INVALID_OPERATION=1282,$f.OUT_OF_MEMORY=1285,$f.CW=2304,$f.CCW=2305,$f.LINE_WIDTH=2849,$f.ALIASED_POINT_SIZE_RANGE=33901,$f.ALIASED_LINE_WIDTH_RANGE=33902,$f.CULL_FACE_MODE=2885,$f.FRONT_FACE=2886,$f.DEPTH_RANGE=2928,$f.DEPTH_WRITEMASK=2930,$f.DEPTH_CLEAR_VALUE=2931,$f.DEPTH_FUNC=2932,$f.STENCIL_CLEAR_VALUE=2961,$f.STENCIL_FUNC=2962,$f.STENCIL_FAIL=2964,$f.STENCIL_PASS_DEPTH_FAIL=2965,$f.STENCIL_PASS_DEPTH_PASS=2966,$f.STENCIL_REF=2967,$f.STENCIL_VALUE_MASK=2963,$f.STENCIL_WRITEMASK=2968,$f.STENCIL_BACK_FUNC=34816,$f.STENCIL_BACK_FAIL=34817,$f.STENCIL_BACK_PASS_DEPTH_FAIL=34818,$f.STENCIL_BACK_PASS_DEPTH_PASS=34819,$f.STENCIL_BACK_REF=36003,$f.STENCIL_BACK_VALUE_MASK=36004,$f.STENCIL_BACK_WRITEMASK=36005,$f.VIEWPORT=2978,$f.SCISSOR_BOX=3088,$f.COLOR_CLEAR_VALUE=3106,$f.COLOR_WRITEMASK=3107,$f.UNPACK_ALIGNMENT=3317,$f.PACK_ALIGNMENT=3333,$f.MAX_TEXTURE_SIZE=3379,$f.MAX_VIEWPORT_DIMS=3386,$f.SUBPIXEL_BITS=3408,$f.RED_BITS=3410,$f.GREEN_BITS=3411,$f.BLUE_BITS=3412,$f.ALPHA_BITS=3413,$f.DEPTH_BITS=3414,$f.STENCIL_BITS=3415,$f.POLYGON_OFFSET_UNITS=10752,$f.POLYGON_OFFSET_FACTOR=32824,$f.TEXTURE_BINDING_2D=32873,$f.SAMPLE_BUFFERS=32936,$f.SAMPLES=32937,$f.SAMPLE_COVERAGE_VALUE=32938,$f.SAMPLE_COVERAGE_INVERT=32939,$f.NUM_COMPRESSED_TEXTURE_FORMATS=34466,$f.COMPRESSED_TEXTURE_FORMATS=34467,$f.DONT_CARE=4352,$f.FASTEST=4353,$f.NICEST=4354,$f.GENERATE_MIPMAP_HINT=33170,$f.BYTE=5120,$f.UNSIGNED_BYTE=5121,$f.SHORT=5122,$f.UNSIGNED_SHORT=5123,$f.INT=5124,$f.UNSIGNED_INT=5125,$f.FLOAT=5126,$f.DEPTH_COMPONENT=6402,$f.ALPHA=6406,$f.RGB=6407,$f.RGBA=6408,$f.LUMINANCE=6409,$f.LUMINANCE_ALPHA=6410,$f.UNSIGNED_SHORT_4_4_4_4=32819,$f.UNSIGNED_SHORT_5_5_5_1=32820,$f.UNSIGNED_SHORT_5_6_5=33635,$f.FRAGMENT_SHADER=35632,$f.VERTEX_SHADER=35633,$f.MAX_VERTEX_ATTRIBS=34921,$f.MAX_VERTEX_UNIFORM_VECTORS=36347,$f.MAX_VARYING_VECTORS=36348,$f.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,$f.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,$f.MAX_TEXTURE_IMAGE_UNITS=34930,$f.MAX_FRAGMENT_UNIFORM_VECTORS=36349,$f.SHADER_TYPE=35663,$f.DELETE_STATUS=35712,$f.LINK_STATUS=35714,$f.VALIDATE_STATUS=35715,$f.ATTACHED_SHADERS=35717,$f.ACTIVE_UNIFORMS=35718,$f.ACTIVE_ATTRIBUTES=35721,$f.SHADING_LANGUAGE_VERSION=35724,$f.CURRENT_PROGRAM=35725,$f.NEVER=512,$f.LESS=513,$f.EQUAL=514,$f.LEQUAL=515,$f.GREATER=516,$f.NOTEQUAL=517,$f.GEQUAL=518,$f.ALWAYS=519,$f.KEEP=7680,$f.REPLACE=7681,$f.INCR=7682,$f.DECR=7683,$f.INVERT=5386,$f.INCR_WRAP=34055,$f.DECR_WRAP=34056,$f.VENDOR=7936,$f.RENDERER=7937,$f.VERSION=7938,$f.NEAREST=9728,$f.LINEAR=9729,$f.NEAREST_MIPMAP_NEAREST=9984,$f.LINEAR_MIPMAP_NEAREST=9985,$f.NEAREST_MIPMAP_LINEAR=9986,$f.LINEAR_MIPMAP_LINEAR=9987,$f.TEXTURE_MAG_FILTER=10240,$f.TEXTURE_MIN_FILTER=10241,$f.TEXTURE_WRAP_S=10242,$f.TEXTURE_WRAP_T=10243,$f.TEXTURE_2D=3553,$f.TEXTURE=5890,$f.TEXTURE_CUBE_MAP=34067,$f.TEXTURE_BINDING_CUBE_MAP=34068,$f.TEXTURE_CUBE_MAP_POSITIVE_X=34069,$f.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,$f.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,$f.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,$f.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,$f.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,$f.MAX_CUBE_MAP_TEXTURE_SIZE=34076,$f.TEXTURE0=33984,$f.TEXTURE1=33985,$f.TEXTURE2=33986,$f.TEXTURE3=33987,$f.TEXTURE4=33988,$f.TEXTURE5=33989,$f.TEXTURE6=33990,$f.TEXTURE7=33991,$f.TEXTURE8=33992,$f.TEXTURE9=33993,$f.TEXTURE10=33994,$f.TEXTURE11=33995,$f.TEXTURE12=33996,$f.TEXTURE13=33997,$f.TEXTURE14=33998,$f.TEXTURE15=33999,$f.TEXTURE16=34e3,$f.TEXTURE17=34001,$f.TEXTURE18=34002,$f.TEXTURE19=34003,$f.TEXTURE20=34004,$f.TEXTURE21=34005,$f.TEXTURE22=34006,$f.TEXTURE23=34007,$f.TEXTURE24=34008,$f.TEXTURE25=34009,$f.TEXTURE26=34010,$f.TEXTURE27=34011,$f.TEXTURE28=34012,$f.TEXTURE29=34013,$f.TEXTURE30=34014,$f.TEXTURE31=34015,$f.ACTIVE_TEXTURE=34016,$f.REPEAT=10497,$f.CLAMP_TO_EDGE=33071,$f.MIRRORED_REPEAT=33648,$f.FLOAT_VEC2=35664,$f.FLOAT_VEC3=35665,$f.FLOAT_VEC4=35666,$f.INT_VEC2=35667,$f.INT_VEC3=35668,$f.INT_VEC4=35669,$f.BOOL=35670,$f.BOOL_VEC2=35671,$f.BOOL_VEC3=35672,$f.BOOL_VEC4=35673,$f.FLOAT_MAT2=35674,$f.FLOAT_MAT3=35675,$f.FLOAT_MAT4=35676,$f.SAMPLER_2D=35678,$f.SAMPLER_CUBE=35680,$f.VERTEX_ATTRIB_ARRAY_ENABLED=34338,$f.VERTEX_ATTRIB_ARRAY_SIZE=34339,$f.VERTEX_ATTRIB_ARRAY_STRIDE=34340,$f.VERTEX_ATTRIB_ARRAY_TYPE=34341,$f.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,$f.VERTEX_ATTRIB_ARRAY_POINTER=34373,$f.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,$f.COMPILE_STATUS=35713,$f.LOW_FLOAT=36336,$f.MEDIUM_FLOAT=36337,$f.HIGH_FLOAT=36338,$f.LOW_INT=36339,$f.MEDIUM_INT=36340,$f.HIGH_INT=36341,$f.FRAMEBUFFER=36160,$f.RENDERBUFFER=36161,$f.RGBA4=32854,$f.RGB5_A1=32855,$f.RGB565=36194,$f.DEPTH_COMPONENT16=33189,$f.STENCIL_INDEX=6401,$f.STENCIL_INDEX8=36168,$f.DEPTH_STENCIL=34041,$f.RENDERBUFFER_WIDTH=36162,$f.RENDERBUFFER_HEIGHT=36163,$f.RENDERBUFFER_INTERNAL_FORMAT=36164,$f.RENDERBUFFER_RED_SIZE=36176,$f.RENDERBUFFER_GREEN_SIZE=36177,$f.RENDERBUFFER_BLUE_SIZE=36178,$f.RENDERBUFFER_ALPHA_SIZE=36179,$f.RENDERBUFFER_DEPTH_SIZE=36180,$f.RENDERBUFFER_STENCIL_SIZE=36181,$f.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,$f.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,$f.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,$f.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,$f.COLOR_ATTACHMENT0=36064,$f.DEPTH_ATTACHMENT=36096,$f.STENCIL_ATTACHMENT=36128,$f.DEPTH_STENCIL_ATTACHMENT=33306,$f.NONE=0,$f.FRAMEBUFFER_COMPLETE=36053,$f.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,$f.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,$f.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,$f.FRAMEBUFFER_UNSUPPORTED=36061,$f.FRAMEBUFFER_BINDING=36006,$f.RENDERBUFFER_BINDING=36007,$f.MAX_RENDERBUFFER_SIZE=34024,$f.INVALID_FRAMEBUFFER_OPERATION=1286,$f.UNPACK_FLIP_Y_WEBGL=37440,$f.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,$f.CONTEXT_LOST_WEBGL=37442,$f.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,$f.BROWSER_DEFAULT_WEBGL=37444,$f._useProgram=null,$f._depthTest=!0,$f._depthMask=!0,$f._blend=!1,$f._cullFace=!1,$f.curBindTexTarget=null,$f.curBindTexValue=null,$i($f,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),$f}(),$yc=function($c){function $d(){$d.__super.call(this)}$o($d,"laya.webgl.display.GraphicsGL",$j);var $e=$d.prototype;return $e.setShader=function($c){this._saveToCmd($t.context._setShader,[$c])},$e.setIBVB=function($c,$d,$e,$f,$g,$h){this._saveToCmd($t.context._setIBVB,[$c,$d,$e,$f,$g,$h])},$e.drawParticle=function($c,$d,$e){var $f=$x.createParticleTemplate2D($e);$f.x=$c,$f.y=$d,this._saveToCmd($t.context._drawParticle,[$f])},$d}(),$zc=function($c){var $e;function $P($c){this._x=0,this._y=0,this._id=++$P._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,$P.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=$P.MAXCLIPRECT,this.mOutPoint,this._canvas=$c,this._canvas._addReference(),$P._contextcount++,$t.isFlash?(this._ib=$ac.create(35044),$sc.fillIBQuadrangle(this._ib,16)):this._ib=$ac.QuadrangleIB,this.clear()}$o($P,"laya.webgl.canvas.WebGLContext2D",$g);var $d=$P.prototype;return $d.setIsMainContext=function(){this._isMain=!0},$d.clearBG=function($c,$d,$e,$f){var $g=$wc.mainContext;$g.clearColor($c,$d,$e,$f),$g.clear(16384)},$d._getSubmits=function(){return this._submits},$d._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var $c=0,$d=this._submits._length;$c<$d;$c++)this._submits[$c].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},$d.destroy=function(){--$P._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=$ac.QuadrangleIB&&this._ib.releaseResource()},$d.clear=function(){this._submits||(this._other=$e.DEFAULT,this._curMat=$B.create(),this._vb=$bc.create(-1),this._submits=[],this._save=[$Y.Create(this)],this._save.length=10,this._shader2D=new $a,this._triangleMesh=$Kc.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=$e.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=$P.MAXCLIPRECT,this._curSubmit=$hc.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=$T.DEFAULT;for(var $c=0,$d=this._submits._length;$c<$d;$c++)this._submits[$c].releaseRender(),this._submits[$c]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},$d.size=function($c,$d){if(this._width!=$c||this._height!=$d)if(0==$c||0==$d){0!=this._vb._byteLength&&(this._width=$c,this._height=$d,this._vb.clear(),this._vb.upload());for(var $e=0,$f=this._submits._length;$e<$f;$e++)this._submits[$e].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=$c,this._height=$d,this._targets&&this._targets.size($c,$d),this._canvas.memorySize-=this._canvas.memorySize;0===$c&&0===$d&&this._releaseMem()},$d._getTransformMatrix=function(){return this._curMat},$d.translate=function($c,$d){0===$c&&0===$d||($$.save(this),this._curMat.bTransform&&($Z.save(this),this._curMat.transformPointN($C.TEMP.setTo($c,$d)),$c=$C.TEMP.x,$d=$C.TEMP.y),this._x+=$c,this._y+=$d)},$d.save=function(){this._save[this._save._length++]=$Y.Create(this)},$d.restore=function(){var $c=this._save._length;if(!($c<1))for(var $d=$c-1;0<=$d;$d--){var $e=this._save[$d];if($e.restore(this),$e.isSaveMark())return void(this._save._length=$d)}},$d._fillText=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){void 0===$l&&($l=0);var $m=this._shader2D,$n=this._curSubmit.shaderValue,$o=$g?$qc.create($g):this._other.font;if($Q.enabled)$m.ALPHA!==$n.ALPHA&&($m.glTexture=null),$pc.drawText(this,$c,$d,this._curMat,$o,$k||this._other.textAlign,$h,$i,$j,$e,$f,$l);else{this._shader2D.defines.getValue();var $p=$h?$q.create($h)._color:$m.colorAdd;$m.ALPHA===$n.ALPHA&&$p===$m.colorAdd&&$n.colorAdd===$m.colorAdd||($m.glTexture=null,$m.colorAdd=$p),$pc.drawText(this,$c,$d,this._curMat,$o,$k||this._other.textAlign,$h,$i,$j,$e,$f,$l)}},$d.fillWords=function($c,$d,$e,$f,$g,$h){this._fillText(null,$c,$d,$e,$f,$g,null,-1,null,$h)},$d.fillBorderWords=function($c,$d,$e,$f,$g,$h,$i){this._fillBorderText(null,$c,$d,$e,$f,$g,$h,$i,null)},$d.fillText=function($c,$d,$e,$f,$g,$h){this._fillText($c,null,$d,$e,$f,$g,null,-1,$h)},$d.strokeText=function($c,$d,$e,$f,$g,$h,$i){this._fillText($c,null,$d,$e,$f,null,$g,$h||1,$i)},$d.fillBorderText=function($c,$d,$e,$f,$g,$h,$i,$j){this._fillBorderText($c,null,$d,$e,$f,$g,$h,$i,$j)},$d._fillBorderText=function($c,$d,$e,$f,$g,$h,$i,$j,$k){if(!$Q.enabled)return this._fillText($c,$d,$e,$f,$g,null,$i,$j||1,$k),void this._fillText($c,$d,$e,$f,$g,$h,null,-1,$k);var $l=this._shader2D,$m=this._curSubmit.shaderValue;$l.ALPHA!==$m.ALPHA&&($l.glTexture=null);var $n=$g?($P._fontTemp.setFont($g),$P._fontTemp):this._other.font;$pc.drawText(this,$c,$d,this._curMat,$n,$k||this._other.textAlign,$h,$i,$j||1,$e,$f,0)},$d.fillRect=function($c,$d,$e,$f,$g){var $h=this._vb;if($sc.fillRectImgVb($h,this._clipRect,$c,$d,$e,$f,$K.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $i=this._shader2D.fillStyle;$g&&(this._shader2D.fillStyle=$T.create($g));var $j=this._shader2D,$k=this._curSubmit.shaderValue;if($j.fillStyle!==$k.fillStyle||$j.ALPHA!==$k.ALPHA){$j.glTexture=null;var $l=this._curSubmit=$hc.createSubmit(this,this._ib,$h,($h._byteLength-64)/32*3,$Ac.create(2,0));$l.shaderValue.color=$j.fillStyle._color._color,$l.shaderValue.ALPHA=$j.ALPHA,this._submits[this._submits._length++]=$l}this._curSubmit._numEle+=6,this._shader2D.fillStyle=$i}},$d.fillTexture=function($c,$d,$e,$f,$g,$h,$i,$j){if($c.loaded&&$c.bitmap&&$c.source){var $k=this._vb,$l=$c.bitmap.width,$m=$c.bitmap.height,$n=$c.uv,$o=$i.x%$c.width,$p=$i.y%$c.height;if($l!=$j.w||$m!=$j.h){if(!$j.w&&!$j.h)switch($j.oy=$j.ox=0,$h){case"repeat":$j.width=$f,$j.height=$g;break;case"repeat-x":$j.width=$f,$p<0?$c.height+$p>$g?$j.height=$g:$j.height=$c.height+$p:($j.oy=$p,$c.height+$p>$g?$j.height=$g-$p:$j.height=$c.height);break;case"repeat-y":$o<0?$c.width+$o>$f?$j.width=$f:$j.width=$c.width+$o:($j.ox=$o,$c.width+$o>$f?$j.width=$f-$o:$j.width=$c.width),$j.height=$g;break;case"no-repeat":$o<0?$c.width+$o>$f?$j.width=$f:$j.width=$c.width+$o:($j.ox=$o,$c.width+$o>$f?$j.width=$f-$o:$j.width=$c.width),$p<0?$c.height+$p>$g?$j.height=$g:$j.height=$c.height+$p:($j.oy=$p,$c.height+$p>$g?$j.height=$g-$p:$j.height=$c.height);break;default:$j.width=$f,$j.height=$g}$j.w=$l,$j.h=$m,$j.uv=[0,0,$j.width/$l,0,$j.width/$l,$j.height/$m,0,$j.height/$m]}if($d+=$j.ox,$e+=$j.oy,$o-=$j.ox,$p-=$j.oy,$sc.fillRectImgVb($k,this._clipRect,$d,$e,$j.width,$j.height,$j.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $q=$Jc.create(this,this._ib,$k,($k._byteLength-64)/32*3,$Ac.create(256,0)),$r=(this._submits[this._submits._length++]=$q).shaderValue;$r.textureHost=$c;var $s=$n[0]*$l,$t=$n[1]*$m,$u=($n[2]-$n[0])*$l,$v=($n[5]-$n[3])*$m,$w=-$o/$l,$x=-$p/$m;$r.u_TexRange[0]=$s/$l,$r.u_TexRange[1]=$u/$l,$r.u_TexRange[2]=$t/$m,$r.u_TexRange[3]=$v/$m,$r.u_offset[0]=$w,$r.u_offset[1]=$x,$Q.enabled&&!this._isMain&&$q.addTexture($c,($k._byteLength>>2)-16),(this._curSubmit=$q)._renderType=10017,$q._numEle+=6}}else this.sprite&&$y.timer.callLater(this,this._repaintSprite)},$d.setShader=function($c){$V.save(this,1048576,this._shader2D,!0),this._shader2D.shader=$c},$d.setFilters=function($c){$V.save(this,2097152,this._shader2D,!0),this._shader2D.filters=$c,this._curSubmit=$hc.RENDERBASE,this._renderKey=0,this._drawCount++},$d.drawTexture=function($c,$d,$e,$f,$g,$h,$i){this._drawTextureM($c,$d,$e,$f,$g,$h,$i,null,1)},$d.addTextureVb=function($c,$d,$e){var $f=this._curSubmit._vb||this._vb,$g=$f._byteLength>>2;$f.byteLength=$g+16<<2;for(var $h=$f.getFloat32Array(),$i=0;$i<16;$i+=4)$h[$g++]=$c[$i]+$d,$h[$g++]=$c[$i+1]+$e,$h[$g++]=$c[$i+2],$h[$g++]=$c[$i+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),$f._upload=!0},$d.willDrawTexture=function($c,$d){if(!($c.loaded&&$c.bitmap&&$c.source))return this.sprite&&$y.timer.callLater(this,this._repaintSprite),0;var $e=$c.bitmap,$f=$e.id+this._shader2D.ALPHA*$d+10016;if($f==this._renderKey)return $f;var $g=this._shader2D,$h=$g.ALPHA,$i=this._curSubmit.shaderValue;$g.ALPHA*=$d,this._renderKey=$f,this._drawCount++,$g.glTexture=$e;var $j=this._vb,$k=null,$l=$j._byteLength/32*3,$m=$i.textureHost&&$i.textureHost==$c&&$i.textureHost.alphaTexture==$c.alphaTexture;return $k=$Jc.create(this,this._ib,$j,$l,$Ac.create(1,0)),(this._submits[this._submits._length++]=$k).shaderValue.textureHost=$c,$k._renderType=10016,$k._preIsSameTextureShader=10016===this._curSubmit._renderType&&$g.ALPHA===$i.ALPHA&&$m,this._curSubmit=$k,$g.ALPHA=$h,$f},$d.drawTextures=function($c,$d,$e,$f){if($c.loaded&&$c.bitmap&&$c.source){var $g=this._clipRect;if(this._clipRect=$P.MAXCLIPRECT,this._drawTextureM($c,$d[0],$d[1],$c.width,$c.height,$e,$f,null,1)){if(this._clipRect=$g,$G.drawCall++,!($d.length<4)){for(var $h=this._curSubmit._vb||this._vb,$i=this._curMat.a,$j=this._curMat.d,$k=2,$l=$d.length;$k<$l;$k+=2)$sc.copyPreImgVb($h,($d[$k]-$d[$k-2])*$i,($d[$k+1]-$d[$k-1])*$j),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&$y.timer.callLater(this,this._repaintSprite)},$d._drawTextureM=function($c,$d,$e,$f,$g,$h,$i,$j,$k){if(!$c.loaded||!$c.source)return this.sprite&&$y.timer.callLater(this,this._repaintSprite),!1;var $l=this._curSubmit._vb||this._vb,$m=$c.bitmap;$d+=$h,$e+=$i,this._drawCount++;var $n=$m.id+this._shader2D.ALPHA*$k+10016;if($n!=this._renderKey){this._renderKey=$n;var $o=this._curSubmit.shaderValue,$p=this._shader2D,$q=$p.ALPHA;$p.ALPHA*=$k,$p.glTexture=$m;var $r=this._vb,$s=null,$t=$r._byteLength/32*3,$u=$o.textureHost&&$o.textureHost==$c&&$o.textureHost.alphaTexture==$c.alphaTexture;$s=$Jc.create(this,this._ib,$r,$t,$Ac.create(1,0)),(this._submits[this._submits._length++]=$s).shaderValue.textureHost=$c,$s._renderType=10016,$s._preIsSameTextureShader=10016===this._curSubmit._renderType&&$p.ALPHA===$o.ALPHA&&$u,this._curSubmit=$s,$l=this._curSubmit._vb||this._vb,$p.ALPHA=$q}return!!$sc.fillRectImgVb($l,this._clipRect,$d,$e,$f||$c.width,$g||$c.height,$c.uv,$j||this._curMat,this._x,this._y,0,0)&&($Q.enabled&&!this._isMain&&this._curSubmit.addTexture($c,($l._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},$d._repaintSprite=function(){this.sprite&&this.sprite.repaint()},$d._drawText=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){var $m=$c.bitmap;this._drawCount++;var $n=$m.id+this._shader2D.ALPHA+10016;if($n!=this._renderKey){this._renderKey=$n;var $o=this._curSubmit.shaderValue,$p=this._shader2D;$p.glTexture=$m;var $q=this._vb,$r=null,$s=$q._byteLength/32*3,$t=$o.textureHost&&$o.textureHost==$c&&$o.textureHost.alphaTexture==$c.alphaTexture;($r=$Q.enabled?$Jc.create(this,this._ib,$q,$s,$Ac.create(1,0)):$Jc.create(this,this._ib,$q,$s,$$c.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&$p.ALPHA===$o.ALPHA&&$t,(this._submits[this._submits._length++]=$r).shaderValue.textureHost=$c,$r._renderType=10016,this._curSubmit=$r}$c.active();var $u=this._curSubmit._vb||this._vb;$sc.fillRectImgVb($u,this._clipRect,$d+$i,$e+$j,$f||$c.width,$g||$c.height,$c.uv,$h||this._curMat,this._x,this._y,$k,$l,!0)&&($Q.enabled&&!this._isMain&&this._curSubmit.addTexture($c,($u._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},$d.drawTextureWithTransform=function($c,$d,$e,$f,$g,$h,$i,$j,$k){if($h){var $l=this._curMat,$m=this._x,$n=this._y;(0!==$i||0!==$j)&&(this._x=$i*$l.a+$j*$l.c,this._y=$j*$l.d+$i*$l.b),$h&&$l.bTransform?($B.mul($h,$l,$P._tmpMatrix),($h=$P._tmpMatrix)._checkTransform()):(this._x+=$l.tx,this._y+=$l.ty),this._drawTextureM($c,$d,$e,$f,$g,0,0,$h,$k),this._x=$m,this._y=$n}else this._drawTextureM($c,$d,$e,$f,$g,$i,$j,null,$k)},$d.fillQuadrangle=function($c,$d,$e,$f,$g){var $h=this._curSubmit,$i=this._vb,$j=this._shader2D,$k=$h.shaderValue;if(this._renderKey=0,$c.bitmap){var $l=$c.bitmap;$j.glTexture==$l&&$j.ALPHA===$k.ALPHA||($j.glTexture=$l,($h=this._curSubmit=$hc.createSubmit(this,this._ib,$i,$i._byteLength/32*3,$Ac.create(1,0))).shaderValue.glTexture=$l,this._submits[this._submits._length++]=$h),$sc.fillQuadrangleImgVb($i,$d,$e,$f,$c.uv,$g||this._curMat,this._x,this._y)}else $h.shaderValue.fillStyle&&$h.shaderValue.fillStyle.equal($c)&&$j.ALPHA===$k.ALPHA||($j.glTexture=null,($h=this._curSubmit=$hc.createSubmit(this,this._ib,$i,$i._byteLength/32*3,$Ac.create(2,0))).shaderValue.defines.add(2),$h.shaderValue.fillStyle=$T.create($c),this._submits[this._submits._length++]=$h),$sc.fillQuadrangleImgVb($i,$d,$e,$f,$K.DEF_UV,$g||this._curMat,this._x,this._y);$h._numEle+=6},$d.drawTexture2=function($c,$d,$e,$f,$g,$h,$i,$j){if(0!=$h){var $k=this._curMat;if(this._x=$c*$k.a+$d*$k.c,this._y=$d*$k.d+$c*$k.b,$g&&($g=$k.bTransform||$g.bTransform?($B.mul($g,$k,$P._tmpMatrix),$P._tmpMatrix):(this._x+=$g.tx+$k.tx,this._y+=$g.ty+$k.ty,$B.EMPTY)),1!==$h||$i){var $l=this._shader2D.ALPHA,$m=this._nBlendType;this._shader2D.ALPHA=$h,$i&&(this._nBlendType=$S.TOINT($i)),this._drawTextureM($j[0],$j[1]-$e,$j[2]-$f,$j[3],$j[4],0,0,$g,1),this._shader2D.ALPHA=$l,this._nBlendType=$m}else this._drawTextureM($j[0],$j[1]-$e,$j[2]-$f,$j[3],$j[4],0,0,$g,1);this._x=this._y=0}},$d.drawCanvas=function($c,$d,$e,$f,$g){var $h=$c.context;if(this._renderKey=0,$h._targets)this._submits[this._submits._length++]=$Ic.create($h,0,null),this._curSubmit=$hc.RENDERBASE,$h._targets.drawTo(this,$d,$e,$f,$g);else{var $i=this._submits[this._submits._length++]=$Ic.create($h,this._shader2D.ALPHA,this._shader2D.filters),$j=$f/$c.width,$k=$g/$c.height,$l=$i._matrix;this._curMat.copyTo($l),1!=$j&&1!=$k&&$l.scale($j,$k);var $m=$l.tx,$n=$l.ty;$l.tx=$l.ty=0,$l.transformPoint($C.TEMP.setTo($d,$e)),$l.translate($C.TEMP.x+$m,$C.TEMP.y+$n),this._curSubmit=$hc.RENDERBASE}$z.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=$h._targets?"yellow":"green",this.strokeRect($d-1,$e-1,$f+2,$g+2,1),this.strokeRect($d,$e,$f,$g,1),this.restore())},$d.drawTarget=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){void 0===$l&&($l=-1);var $m=this._vb;if($sc.fillRectImgVb($m,this._clipRect,$d,$e,$f,$g,$k||$K.DEF_UV,$h||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var $n=this._curSubmit=$nc.create(this,this._ib,$m,($m._byteLength-64)/32*3,$j,$i);$n.blendType=-1==$l?this._nBlendType:$l,$n.scope=$c,this._submits[this._submits._length++]=$n,this._curSubmit._numEle+=6}},$d.mixRGBandAlpha=function($c){return this._mixRGBandAlpha($c,this._shader2D.ALPHA)},$d._mixRGBandAlpha=function($c,$d){var $e=(4278190080&$c)>>>24;return 0!=$e?$e*=$d:$e=255*$d,16777215&$c|$e<<24},$d.drawTriangles=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){if(!$c.loaded||!$c.source)return this.sprite&&$y.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;$c.bitmap;var $m=this._mixRGBandAlpha(4294967295,$j),$n=($f.length,$h.length);this._renderKey=-1;var $o=this._curSubmit=$Jc.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,$Ac.create(1,0));return $o.shaderValue.textureHost=$c,$o._renderType=10016,this._submits[this._submits._length++]=$o,$i?($P._tmpMatrix.a=$i.a,$P._tmpMatrix.b=$i.b,$P._tmpMatrix.c=$i.c,$P._tmpMatrix.d=$i.d,$P._tmpMatrix.tx=$i.tx+$d,$P._tmpMatrix.ty=$i.ty+$e,$B.mul($P._tmpMatrix,this._curMat,$P._tmpMatrix)):($P._tmpMatrix.a=this._curMat.a,$P._tmpMatrix.b=this._curMat.b,$P._tmpMatrix.c=this._curMat.c,$P._tmpMatrix.d=this._curMat.d,$P._tmpMatrix.tx=this._curMat.tx+$d,$P._tmpMatrix.ty=this._curMat.ty+$e),this._triangleMesh.addData($f,$g,$h,$P._tmpMatrix,$m,this),this._curSubmit._numEle+=$n,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},$d.transform=function($c,$d,$e,$f,$g,$h){$Z.save(this),$B.mul($B.TEMP.setTo($c,$d,$e,$f,$g,$h),this._curMat,this._curMat),this._curMat._checkTransform()},$d.setTransformByMatrix=function($c){$c.copyTo(this._curMat)},$d.transformByMatrix=function($c){$Z.save(this),$B.mul($c,this._curMat,this._curMat),this._curMat._checkTransform()},$d.rotate=function($c){$Z.save(this),this._curMat.rotateEx($c)},$d.scale=function($c,$d){$Z.save(this),this._curMat.scaleEx($c,$d)},$d.clipRect=function($c,$d,$e,$f){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var $g=$mc.create(4);this.addRenderObject($g);var $h=this._vb,$i=$h._byteLength>>2;if($sc.fillRectImgVb($h,null,$c,$d,$e,$f,$K.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var $j=this._curSubmit=$hc.createSubmit(this,this._ib,$h,($h._byteLength-64)/32*3,$Ac.create(2,0));$j.shaderValue.ALPHA=1,this._submits[this._submits._length++]=$j,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var $k=$mc.create(5);this.addRenderObject($k);var $l=$h.getFloat32Array(),$m=Math.min(Math.min(Math.min($l[0+$i],$l[4+$i]),$l[8+$i]),$l[12+$i]),$n=Math.max(Math.max(Math.max($l[0+$i],$l[4+$i]),$l[8+$i]),$l[12+$i]),$o=Math.min(Math.min(Math.min($l[1+$i],$l[5+$i]),$l[9+$i]),$l[13+$i]),$p=Math.max(Math.max(Math.max($l[1+$i],$l[5+$i]),$l[9+$i]),$l[13+$i]);$X.save(this,$k,$c,$d,$e,$f,$m,$o,$n-$m,$p-$o),this._curSubmit=$hc.RENDERBASE}else{$e*=this._curMat.a,$f*=this._curMat.d;var $q=$C.TEMP;this._curMat.transformPoint($q.setTo($c,$d)),$e<0&&($q.x=$q.x+$e,$e=-$e),$f<0&&($q.y=$q.y+$f,$f=-$f),this._renderKey=0;var $r=this._curSubmit=$lc.create(this);(this._submits[this._submits._length++]=$r).submitIndex=this._submits._length,$r.submitLength=9999999,$W.save(this,$r);var $s=this._clipRect,$t=$s.x,$u=$s.y,$v=$q.x+$e,$w=$q.y+$f;$t<$q.x&&($s.x=$q.x),$u<$q.y&&($s.y=$q.y),$s.width=Math.min($v,$t+$s.width)-$s.x,$s.height=Math.min($w,$u+$s.height)-$s.y,this._shader2D.glTexture=null,$r.clipRect.copyFrom($s),this._curSubmit=$hc.RENDERBASE}},$d.setIBVB=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m){if(void 0===$k&&($k=0),void 0===$l&&($l=0),void 0===$m&&($m=0),null===$e){if($t.isFlash){var $n=$f;$n._selfIB||($n._selfIB=$ac.create(35044)),$n._selfIB.clear(),$e=$n._selfIB}else $e=this._ib;$sc.expandIBQuadrangle($e,$f._byteLength/(4*$f.vertexStride*4))}if(!$j||!$i)throw Error("setIBVB must input:shader shaderValues");var $o=$kc.create(this,$f,$e,$g,$i,$j,$k,$l,$m);$h||($h=$B.EMPTY),$h.translate($c,$d),$B.mul($h,this._curMat,$o._mat),$h.translate(-$c,-$d),this._submits[this._submits._length++]=$o,this._curSubmit=$hc.RENDERBASE,this._renderKey=0},$d.addRenderObject=function($c){this._submits[this._submits._length++]=$c},$d.fillTrangles=function($c,$d,$e,$f,$g){var $h=this._curSubmit,$i=this._vb,$j=this._shader2D,$k=$h.shaderValue,$l=$f.length>>4,$m=$c.bitmap;this._renderKey=0,$j.glTexture==$m&&$j.ALPHA===$k.ALPHA||(($h=this._curSubmit=$hc.createSubmit(this,this._ib,$i,$i._byteLength/32*3,$Ac.create(1,0))).shaderValue.textureHost=$c,this._submits[this._submits._length++]=$h),$sc.fillTranglesVB($i,$d,$e,$f,$g||this._curMat,this._x,this._y),$h._numEle+=6*$l},$d.submitElement=function($c,$d){var $e=this._submits;for($d<0&&($d=$e._length);$c<$d;)$c+=$e[$c].renderSubmit()},$d.finish=function(){$wc.mainContext.finish()},$d.flush=function(){var $c=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if($c>this._ib.bufferLength/12&&$sc.expandIBQuadrangle(this._ib,$c),!this._isMain&&$Q.enabled&&$Q._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=$Q._atlasRestore;for(var $d=this._submits,$e=0,$f=$d._length;$e<$f;$e++){var $g=$d[$e];10016===$g.getRenderType()&&$g.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),$dc.instance&&$dc.getInstance().reset();var $h;for($e=0,$h=this.meshlist.length;$e<$h;$e++){var $i=this.meshlist[$e];$i.canReuse?$i.releaseMesh():$i.destroy()}return this.meshlist.length=0,this._curSubmit=$hc.RENDERBASE,this._renderKey=0,this._triangleMesh=$Kc.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},$d.setPathId=function($c){if(this.mId=$c,-1!=this.mId){this.mHaveKey=!1;var $d=$M.getInstance();$d.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,$d.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},$d.movePath=function($c,$d){var $e=$c,$f=$d;$c=this._curMat.a*$e+this._curMat.c*$f+this._curMat.tx,$d=this._curMat.b*$e+this._curMat.d*$f+this._curMat.ty,this.mX+=$c,this.mY+=$d},$d.beginPath=function(){var $c=this._getPath();$c.tempArray.length=0,$c.closePath=!1,this.mX=0,this.mY=0},$d.closePath=function(){this._path.closePath=!0},$d.fill=function($c){void 0===$c&&($c=!1);var $d=this._getPath();this.drawPoly(0,0,$d.tempArray,this.fillStyle._color.numColor,0,0,$c)},$d.stroke=function(){var $c=this._getPath();if(0<this.lineWidth){if(-1==this.mId)$c.drawLine(0,0,$c.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var $d=$M.getInstance().shapeLineDic[this.mId];$d.rebuild($c.tempArray),$c.setGeomtry($d)}else $M.getInstance().addLine(this.mId,$c.drawLine(0,0,$c.tempArray,this.lineWidth,this.strokeStyle._color.numColor));$c.update();var $e=[this.mX,this.mY],$f=$hc.createShape(this,$c.ib,$c.vb,$c.count,$c.offset,$Ac.create(4,0));$f.shaderValue.ALPHA=this._shader2D.ALPHA,$f.shaderValue.u_pos=$e,$f.shaderValue.u_mmat2=$uc.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=$f,this._renderKey=-1}},$d.line=function($c,$d,$e,$f,$g,$h){var $i=this._curSubmit,$j=this._vb;if($sc.fillLineVb($j,this._clipRect,$c,$d,$e,$f,$g,$h)){this._renderKey=0;var $k=this._shader2D,$l=$i.shaderValue;$k.strokeStyle===$l.strokeStyle&&$k.ALPHA===$l.ALPHA||($k.glTexture=null,($i=this._curSubmit=$hc.createSubmit(this,this._ib,$j,($j._byteLength-64)/32*3,$Ac.create(2,0))).shaderValue.strokeStyle=$k.strokeStyle,$i.shaderValue.mainID=2,$i.shaderValue.ALPHA=$k.ALPHA,this._submits[this._submits._length++]=$i),$i._numEle+=6}},$d.moveTo=function($c,$d,$e){void 0===$e&&($e=!0);var $f=this._getPath();if($e){var $g=$c,$h=$d;$c=this._curMat.a*$g+this._curMat.c*$h,$d=this._curMat.b*$g+this._curMat.d*$h}$f.addPoint($c,$d)},$d.lineTo=function($c,$d,$e){void 0===$e&&($e=!0);var $f=this._getPath();if($e){var $g=$c,$h=$d;$c=this._curMat.a*$g+this._curMat.c*$h,$d=this._curMat.b*$g+this._curMat.d*$h}$f.addPoint($c,$d)},$d.drawCurves=function($c,$d,$e){this.setPathId(-1),this.beginPath(),this.strokeStyle=$e[3],this.lineWidth=$e[4];var $f=$e[2];$c+=$e[0],$d+=$e[1],this.movePath($c,$d),this.moveTo($f[0],$f[1]);for(var $g=2,$h=$f.length;$g<$h;)this.quadraticCurveTo($f[$g++],$f[$g++],$f[$g++],$f[$g++]);this.stroke()},$d.arcTo=function($c,$d,$e,$f,$g){if(-1==this.mId||!this.mHaveKey){var $h=0,$i=0,$j=0,$k=this._getPath();this._curMat.copyTo($P._tmpMatrix),$P._tmpMatrix.tx=$P._tmpMatrix.ty=0,$P._tempPoint.setTo($k.getEndPointX(),$k.getEndPointY()),$P._tmpMatrix.invertTransformPoint($P._tempPoint);var $l=$P._tempPoint.x-$c,$m=$P._tempPoint.y-$d,$n=Math.sqrt($l*$l+$m*$m);if(!($n<=1e-6)){var $o=$l/$n,$p=$m/$n,$q=$e-$c,$r=$f-$d,$s=$q*$q+$r*$r,$t=Math.sqrt($s);if(!($t<=1e-6)){var $u=$q/$t,$v=$r/$t,$w=$o+$u,$x=$p+$v,$y=Math.sqrt($w*$w+$x*$x);if(!($y<=1e-6)){var $z=$w/$y,$A=$x/$y,$B=Math.acos($z*$o+$A*$p),$C=Math.PI/2-$B,$D=($n=$g/Math.tan($C))*$o+$c,$E=$n*$p+$d,$F=Math.sqrt($n*$n+$g*$g),$G=$c+$z*$F,$H=$d+$A*$F,$I=0,$J=0;if(0<=$o*$v-$p*$u){var $K=2*$C/$P.SEGNUM;$I=Math.sin($K),$J=Math.cos($K)}else $K=2*-$C/$P.SEGNUM,$I=Math.sin($K),$J=Math.cos($K);$i=this._curMat.a*$D+this._curMat.c*$E,$j=this._curMat.b*$D+this._curMat.d*$E,$i==this._path.getEndPointX()&&$j==this._path.getEndPointY()||$k.addPoint($i,$j);var $L=$D-$G,$M=$E-$H;for($h=0;$h<$P.SEGNUM;$h++){var $N=$L*$J+$M*$I,$O=-$L*$I+$M*$J;$i=$N+$G,$j=$O+$H,$c=this._curMat.a*$i+this._curMat.c*$j,$j=$d=this._curMat.b*$i+this._curMat.d*$j,($i=$c)==this._path.getEndPointX()&&$j==this._path.getEndPointY()||$k.addPoint($i,$j),$L=$N,$M=$O}}}}}},$d.arc=function($c,$d,$e,$f,$g,$h,$i){if(void 0===$h&&($h=!1),void 0===$i&&($i=!0),-1!=this.mId){var $j=$M.getInstance().shapeDic[this.mId];if($j&&this.mHaveKey&&!$j.needUpdate(this._curMat))return;$d=$c=0}var $k,$l=0,$m=0,$n=0,$o=0,$p=0,$q=0,$r=0;if($m=$g-$f,$h)if(Math.abs($m)>=2*Math.PI)$m=2*-Math.PI;else for(;0<$m;)$m-=2*Math.PI;else if(Math.abs($m)>=2*Math.PI)$m=2*Math.PI;else for(;$m<0;)$m+=2*Math.PI;$k=$m/($r=$e<101?Math.max(10,$m*$e/5):$e<201?Math.max(10,$m*$e/20):Math.max(10,$m*$e/40))/2,$n=Math.abs(4/3*(1-Math.cos($k))/Math.sin($k)),$h&&($n=-$n);var $s=this._getPath(),$t=NaN,$u=NaN;for($q=0;$q<=$r;$q++)$l=$f+$m*($q/$r),$o=$c+Math.cos($l)*$e,$p=$d+Math.sin($l)*$e,$i&&($t=$o,$u=$p,$o=this._curMat.a*$t+this._curMat.c*$u,$p=this._curMat.b*$t+this._curMat.d*$u),$o==this._path.getEndPointX()&&$p==this._path.getEndPointY()||$s.addPoint($o,$p);$o=$c+Math.cos($g)*$e,$p=$d+Math.sin($g)*$e,$i&&($t=$o,$u=$p,$o=this._curMat.a*$t+this._curMat.c*$u,$p=this._curMat.b*$t+this._curMat.d*$u),$o==this._path.getEndPointX()&&$p==this._path.getEndPointY()||$s.addPoint($o,$p)},$d.quadraticCurveTo=function($c,$d,$e,$f){var $g=$n.I,$h=$e,$i=$f;$e=this._curMat.a*$h+this._curMat.c*$i,$f=this._curMat.b*$h+this._curMat.d*$i,$h=$c,$i=$d,$c=this._curMat.a*$h+this._curMat.c*$i,$d=this._curMat.b*$h+this._curMat.d*$i;for(var $j=$g.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),$c,$d,$e,$f],30,2),$k=0,$l=$j.length/2;$k<$l;$k++)this.lineTo($j[2*$k],$j[2*$k+1],!1);this.lineTo($e,$f,!1)},$d.rect=function($c,$d,$e,$f){this._other=this._other.make(),this._other.path||(this._other.path=new $U),this._other.path.rect($c,$d,$e,$f)},$d.strokeRect=function($c,$d,$e,$f,$g){var $h=.5*$g;this.line($c-$h,$d,$c+$e+$h,$d,$g,this._curMat),this.line($c+$e,$d,$c+$e,$d+$f,$g,this._curMat),this.line($c,$d,$c,$d+$f,$g,this._curMat),this.line($c-$h,$d+$f,$c+$e+$h,$d+$f,$g,this._curMat)},$d.clip=function(){},$d.drawPoly=function($c,$d,$e,$f,$g,$h,$i){void 0===$i&&($i=!1),this._renderKey=0,this._shader2D.glTexture=null;var $j=this._getPath();if(-1==this.mId)$j.polygon($c,$d,$e,$f,$g||1,$h);else if(this.mHaveKey){var $k=$M.getInstance().shapeDic[this.mId];$k.setMatrix(this._curMat),$k.rebuild($j.tempArray),$j.setGeomtry($k)}else{var $l=$j.polygon($c,$d,$e,$f,$g||1,$h);$M.getInstance().addShape(this.mId,$l),$l.setMatrix(this._curMat)}$j.update();var $m,$n=[this.mX,this.mY];if(($m=$hc.createShape(this,$j.ib,$j.vb,$j.count,$j.offset,$Ac.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$m.shaderValue.u_pos=$n,$m.shaderValue.u_mmat2=$uc.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$m,0<$g){if(this.mHaveLineKey){var $o=$M.getInstance().shapeLineDic[this.mId];$o.rebuild($j.tempArray),$j.setGeomtry($o)}else $M.getInstance().addShape(this.mId,$j.drawLine($c,$d,$e,$g,$h));$j.update(),($m=$hc.createShape(this,$j.ib,$j.vb,$j.count,$j.offset,$Ac.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$m.shaderValue.u_mmat2=$uc.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$m}},$d.drawParticle=function($c,$d,$e){$e.x=$c,$e.y=$d,this._submits[this._submits._length++]=$e},$d._getPath=function(){return this._path||(this._path=new $U)},$f(0,$d,"globalCompositeOperation",function(){return $S.NAMES[this._nBlendType]},function($c){var $d=$S.TOINT[$c];null==$d||this._nBlendType===$d||($V.save(this,65536,this,!0),this._curSubmit=$hc.RENDERBASE,this._renderKey=0,this._nBlendType=$d)}),$f(0,$d,"strokeStyle",function(){return this._shader2D.strokeStyle},function($c){this._shader2D.strokeStyle.equal($c)||($V.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=$T.create($c))}),$f(0,$d,"globalAlpha",function(){return this._shader2D.ALPHA},function($c){($c=Math.floor(1e3*$c)/1e3)!=this._shader2D.ALPHA&&($V.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=$c)}),$f(0,$d,"asBitmap",null,function($c){if($c){if(this._targets||(this._targets=new $_),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),$f(0,$d,"fillStyle",function(){return this._shader2D.fillStyle},function($c){this._shader2D.fillStyle.equal($c)||($V.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=$T.create($c))}),$f(0,$d,"textAlign",function(){return this._other.textAlign},function($c){this._other.textAlign===$c||(this._other=this._other.make(),$V.save(this,32768,this._other,!1),this._other.textAlign=$c)}),$f(0,$d,"lineWidth",function(){return this._other.lineWidth},function($c){this._other.lineWidth===$c||(this._other=this._other.make(),$V.save(this,256,this._other,!1),this._other.lineWidth=$c)}),$f(0,$d,"textBaseline",function(){return this._other.textBaseline},function($c){this._other.textBaseline===$c||(this._other=this._other.make(),$V.save(this,16384,this._other,!1),this._other.textBaseline=$c)}),$f(0,$d,"font",null,function($c){$c!=this._other.font.toString()&&(this._other=this._other.make(),$V.save(this,8,this._other,!1),this._other.font===$qc.EMPTY?this._other.font=new $qc($c):this._other.font.setFont($c))}),$P.__init__=function(){$e.DEFAULT=new $e},$P._tempPoint=new $C,$P._SUBMITVBSIZE=32e3,$P._MAXSIZE=99999999,$P._RECTVBSIZE=16,$P.MAXCLIPRECT=new $D(0,0,99999999,99999999),$P._COUNT=0,$P._tmpMatrix=new $B,$P.SEGNUM=32,$P._contextcount=0,$i($P,["_fontTemp",function(){return this._fontTemp=new $qc},"_drawStyleTemp",function(){return this._drawStyleTemp=new $T(null)}]),$P.__init$=function(){$e=function(){function $c(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=$qc.EMPTY}$o($c,"");var $d=$c.prototype;return $d.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=$qc.EMPTY},$d.make=function(){return this===$c.DEFAULT?new $c:this},$c.DEFAULT=null,$c}()},$P}(),$Ac=function($c){function $f($c,$d){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,$f.__super.call(this),this.defines=new $Ec,this.position=$f._POSITION,this.mainID=$c,this.subID=$d,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=$c|$d,this._inClassCache=$f._cache[this._cacheID],0<$c&&!this._inClassCache&&(this._inClassCache=$f._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}$o($f,"laya.webgl.shader.d2.value.Value2D",$O);var $d=$f.prototype;return $d.setValue=function($c){},$d.refresh=function(){var $c=this.size;return $c[0]=$uc.width,$c[1]=$uc.height,this.alpha=this.ALPHA*$uc.worldAlpha,this.mmat=$uc.worldMatrix4,this},$d._ShaderWithCompile=function(){return $Yc.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,$_c.create)},$d._withWorldShaderDefines=function(){var $c=$uc.worldShaderDefines,$d=$Yc.sharders[this.mainID|this.defines._value|$c.getValue()];if(!$d){var $e,$f={};for($e in this.defines.toNameDic())$f[$e]="";for($e in $c.toNameDic())$f[$e]="";$d=$Yc.withCompile2D(0,this.mainID,$f,this.mainID|this.defines._value|$c.getValue(),$_c.create)}var $g=$uc.worldFilters;if(!$g)return $d;for(var $h,$i=$g.length,$j=0;$j<$i;$j++)($h=$g[$j])&&$h.action.setValue(this);return $d},$d.upload=function(){var $c=$uc;this.alpha=this.ALPHA*$c.worldAlpha,$uc.worldMatrix4!==$uc.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),$wc.shaderHighPrecision&&this.defines.add(1024);var $d,$e=$c.worldShaderDefines?this._withWorldShaderDefines():$Yc.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=$c.width,this.size[1]=$c.height,this.mmat=$c.worldMatrix4,$Lc.activeShader!==$e?$e._shaderValueWidth!==$c.width||$e._shaderValueHeight!==$c.height?($e._shaderValueWidth=$c.width,$e._shaderValueHeight=$c.height):$d=$e._params2dQuick2||$e._make2dQuick2():$e._shaderValueWidth!==$c.width||$e._shaderValueHeight!==$c.height?($e._shaderValueWidth=$c.width,$e._shaderValueHeight=$c.height):$d=$e._params2dQuick1||$e._make2dQuick1(),$e.upload(this,$d)},$d.setFilters=function($c){if(this.filters=$c)for(var $d,$e=$c.length,$f=0;$f<$e;$f++)($d=$c[$f])&&(this.defines.add($d.type),$d.action.setValue(this))},$d.clear=function(){this.defines.setValue(this.subID)},$d.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},$f._initone=function($c,$d){$f._typeClass[$c]=$d,$f._cache[$c]=[],$f._cache[$c]._length=0},$f.__init__=function(){$f._POSITION=[2,5126,!1,4*$rc.BYTES_PE,0],$f._TEXCOORD=[2,5126,!1,4*$rc.BYTES_PE,2*$rc.BYTES_PE],$f._initone(2,$Pc),$f._initone(4,$Sc),$f._initone(256,$Qc),$f._initone(512,$Oc),$f._initone(1,$Rc),$f._initone(65,$$c),$f._initone(9,$Rc)},$f.create=function($c,$d){var $e=$f._cache[$c|$d];return $e._length?$e[--$e._length]:new $f._typeClass[$c|$d]($d)},$f._POSITION=null,$f._TEXCOORD=null,$f._cache=[],$f._typeClass=[],$f.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$f}(),$Bc=function($c){function $s($c,$d){$s.__super.call(this,$c,$d)}$o($s,"laya.webgl.utils.RenderSprite3D",$u);var $d=$s.prototype;return $d.onCreate=function($c){switch($c){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},$d._mask=function($c,$d,$e,$f){var $g,$h,$i=this._next,$j=$c.mask;if($j){$d.ctx.save();var $k=$d.ctx.globalCompositeOperation,$l=new $D;if($l.copyFrom($j.getBounds()),$l.width=Math.round($l.width),$l.height=Math.round($l.height),$l.x=Math.round($l.x),$l.y=Math.round($l.y),0<$l.width&&0<$l.height){var $m=$c._style._tf,$n=$jc.create();$n.addValue("bounds",$l),$g=$ic.create([$n,$d],laya.webgl.utils.RenderSprite3D.tmpTarget),$d.addRenderObject($g),$j.render($d,-$l.x,-$l.y),$g=$ic.create([$n],laya.webgl.utils.RenderSprite3D.endTmpTarget),$d.addRenderObject($g),$d.ctx.save(),$d.clipRect($e-$m.translateX+$l.x,$f-$m.translateY+$l.y,$l.width,$l.height),$i._fun.call($i,$c,$d,$e,$f),$d.ctx.restore(),$h=$mc.create(6),$k=$d.ctx.globalCompositeOperation,$h.blendMode="mask",$d.addRenderObject($h),$B.TEMP.identity();var $o=$Ac.create(1,0),$p=$K.INV_UV,$q=$l.width,$r=$l.height;($l.width<32||$l.height<32)&&(($p=$s.tempUV)[0]=0,$p[1]=0,$p[2]=32<=$l.width?1:$l.width/32,$p[3]=0,$p[4]=32<=$l.width?1:$l.width/32,$p[5]=32<=$l.height?1:$l.height/32,$p[6]=0,$p[7]=32<=$l.height?1:$l.height/32,$l.width=32<=$l.width?$l.width:32,$l.height=32<=$l.height?$l.height:32,$p[1]*=-1,$p[3]*=-1,$p[5]*=-1,$p[7]*=-1,$p[1]+=1,$p[3]+=1,$p[5]+=1,$p[7]+=1),$d.ctx.drawTarget($n,$e+$l.x-$m.translateX,$f+$l.y-$m.translateY,$q,$r,$B.TEMP,"tmpTarget",$o,$p,6),$g=$ic.create([$n],laya.webgl.utils.RenderSprite3D.recycleTarget),$d.addRenderObject($g),($h=$mc.create(6)).blendMode=$k,$d.addRenderObject($h)}$d.ctx.restore()}else $i._fun.call($i,$c,$d,$e,$f)},$d._blend=function($c,$d,$e,$f){var $g=$c._style,$h=this._next;$g.blendMode?($d.ctx.save(),$d.ctx.globalCompositeOperation=$g.blendMode,$h._fun.call($h,$c,$d,$e,$f),$d.ctx.restore()):$h._fun.call($h,$c,$d,$e,$f)},$d._transform=function($c,$d,$e,$f){var $g=$c.transform,$h=this._next;if($g&&$h!=$u.NORENDER){var $i=$d.ctx;$c._style;$g.tx=$e,$g.ty=$f;var $j=$i._getTransformMatrix(),$k=$j.clone();$B.mul($g,$j,$j),$j._checkTransform(),$g.tx=$g.ty=0,$h._fun.call($h,$c,$d,0,0),$k.copyTo($j),$k.destroy()}else $h._fun.call($h,$c,$d,$e,$f)},$s.tmpTarget=function($c,$d){var $e=$c.getValue("bounds"),$f=$Mc.create($e.width,$e.height);$f.start(),$f.clear(0,0,0,0),$c.addValue("tmpTarget",$f)},$s.endTmpTarget=function($c){$c.getValue("tmpTarget").end()},$s.recycleTarget=function($c){$c.getValue("tmpTarget").recycle(),$c.recycle()},$i($s,["tempUV",function(){return this.tempUV=new Array(8)}]),$s}(),$Cc=function($c){function $d(){this.data=null,$d.__super.call(this)}$o($d,"laya.filters.webgl.ColorFilterActionGL",$N);var $e=$d.prototype;return $y.imps($e,{"laya.filters.IFilterActionGL":!0}),$e.setValue=function($c){$c.colorMat=this.data._mat,$c.colorAlpha=this.data._alpha},$e.apply3d=function($c,$d,$e,$f,$g){var $h=$c.getValue("bounds"),$i=$Ac.create(1,0);$i.setFilters([this.data]);var $j=$B.TEMP;$j.identity(),$e.ctx.drawTarget($c,0,0,$h.width,$h.height,$j,"src",$i)},$d}(),$Dc=function($c){function $h($c,$d,$e,$f,$g){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,$h.__super.call(this,$c,$d,$g),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new $Tc,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=$e,this._atlasCanvas.height=$f,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}$o($h,"laya.webgl.atlas.Atlaser",$P);var $d=$h.prototype;return $d.computeUVinAtlasTexture=function($c,$d,$e,$f){var $g=$Q.atlasTextureWidth,$h=$Q.atlasTextureHeight,$i=$e/$g,$j=$f/$h,$k=($e+$c.bitmap.width)/$g,$l=($f+$c.bitmap.height)/$h,$m=$c.bitmap.width/$g,$n=$c.bitmap.height/$h;$c.uv=[$i+$d[0]*$m,$j+$d[1]*$n,$k-(1-$d[2])*$m,$j+$d[3]*$n,$k-(1-$d[4])*$m,$l-(1-$d[5])*$n,$i+$d[6]*$m,$l-(1-$d[7])*$n]},$d.findBitmapIsExist=function($c){if($c instanceof laya.webgl.resource.WebGLImage){var $d=$c,$e=$d.url,$f=this._InAtlasWebGLImagesKey[$e||$d.id];if($f)return $f.offsetInfoID}return-1},$d.addToAtlasTexture=function($c,$d,$e){if($c instanceof laya.webgl.resource.WebGLImage){var $f=$c,$g=$f.url;this._InAtlasWebGLImagesKey[$g||$f.id]={bitmap:$c,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([$d,$e])}this._atlasCanvas.texSubImage2D($d,$e,$c.atlasSource),$c.clearAtlasSource()},$d.addToAtlas=function($c,$d,$e){$c._atlasID=this._inAtlasTextureKey.length;var $f=$c.uv.slice(),$g=$c.bitmap;this._inAtlasTextureKey.push($c),this._inAtlasTextureOriUVValue.push($f),this._inAtlasTextureBitmapValue.push($g),this.computeUVinAtlasTexture($c,$f,$d,$e),$c.bitmap=this._atlasCanvas},$d.clear=function(){for(var $c=0,$d=this._inAtlasTextureKey.length;$c<$d;$c++)this._inAtlasTextureKey[$c].bitmap=this._inAtlasTextureBitmapValue[$c],this._inAtlasTextureKey[$c].uv=this._inAtlasTextureOriUVValue[$c],this._inAtlasTextureKey[$c]._atlasID=-1,this._inAtlasTextureKey[$c].bitmap.lock=!1,this._inAtlasTextureKey[$c].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},$d.dispose=function(){this.clear(),this._atlasCanvas.destroy()},$f(0,$d,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),$f(0,$d,"texture",function(){return this._atlasCanvas}),$f(0,$d,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),$h}(),$Ec=function($c){function $e(){$e.__super.call(this,$e.__name2int,$e.__int2name,$e.__int2nameMap)}return $o($e,"laya.webgl.shader.d2.ShaderDefines2D",$b),$e.__init__=function(){$e.reg("TEXTURE2D",1),$e.reg("COLOR2D",2),$e.reg("PRIMITIVE",4),$e.reg("GLOW_FILTER",8),$e.reg("BLUR_FILTER",16),$e.reg("COLOR_FILTER",32),$e.reg("COLOR_ADD",64),$e.reg("WORLDMAT",128),$e.reg("FILLTEXTURE",256),$e.reg("FSHIGHPRECISION",1024),$e.reg("TXTALPHA",2048),$e.reg("TXTCOMPRESS",4096)},$e.reg=function($c,$d){$b._reg($c,$d,$e.__name2int,$e.__int2name)},$e.toText=function($c,$d,$e){return $b._toText($c,$d,$e)},$e.toInt=function($c){return $b._toInt($c,$e.__name2int)},$e.TEXTURE2D=1,$e.COLOR2D=2,$e.PRIMITIVE=4,$e.FILTERGLOW=8,$e.FILTERBLUR=16,$e.FILTERCOLOR=32,$e.COLORADD=64,$e.WORLDMAT=128,$e.FILLTEXTURE=256,$e.SKINMESH=512,$e.SHADERDEFINE_FSHIGHPRECISION=1024,$e.TXTALPHA=2048,$e.TXTCOMPRESS=4096,$e.__name2int={},$e.__int2name=[],$e.__int2nameMap=[],$e}(),$Fc=(function($c){function $j($c,$d,$e,$f,$g,$h,$i){$j.__super.call(this,$c,$d,$e,$f,40,$g,$h,$i)}$o($j,"laya.webgl.shapes.Ellipse",$ec)}(),function($c){function $h($c,$d,$e,$f,$g){this._points=[],this.rebuild($e),$h.__super.call(this,$c,$d,0,0,0,$g,$f,$g,0)}$o($h,"laya.webgl.shapes.Line",$ec);var $d=$h.prototype;return $d.rebuild=function($c){var $d=$c.length;$d!=this._points.length&&(this.mUint16Array=new Uint16Array(6*($d/2-1)),this.mFloat32Array=new Float32Array(5*$d)),this._points.length=0;for(var $e=NaN,$f=NaN,$g=-1,$h=-1,$i=$c.length/2,$j=0;$j<$i;$j++)$e=$c[2*$j],$f=$c[2*$j+1],(.01<Math.abs($g-$e)||.01<Math.abs($h-$f))&&this._points.push($e,$f),$g=$e,$h=$f},$d.getData=function($c,$d,$e){var $f=[],$g=[];0<this.borderWidth&&this.createLine2(this._points,$f,this.borderWidth,$e,$g,this._points.length/2),this.mUint16Array.set($f,0),this.mFloat32Array.set($g,0),$c.append(this.mUint16Array),$d.append(this.mFloat32Array)},$h}()),$Gc=function($c){function $n($c,$d,$e,$f,$g){this._points=[];for(var $h=NaN,$i=NaN,$j=-1,$k=-1,$l=$e.length/2-1,$m=0;$m<$l;$m++)$h=$e[2*$m],$i=$e[2*$m+1],(.01<Math.abs($j-$h)||.01<Math.abs($k-$i))&&this._points.push($h,$i),$j=$h,$k=$i;$h=$e[2*$l],$i=$e[2*$l+1],$j=this._points[0],$k=this._points[1],(.01<Math.abs($j-$h)||.01<Math.abs($k-$i))&&this._points.push($h,$i),$n.__super.call(this,$c,$d,0,0,this._points.length/2,0,$f,$g)}$o($n,"laya.webgl.shapes.LoopLine",$ec);var $d=$n.prototype;return $d.getData=function($c,$d,$e){if(0<this.borderWidth){for(var $f=this.color,$g=($f>>16&255)/255,$h=($f>>8&255)/255,$i=(255&$f)/255,$j=[],$k=0,$l=0,$m=[],$n=Math.floor(this._points.length/2),$o=0;$o<$n;$o++)$k=this._points[2*$o],$l=this._points[2*$o+1],$j.push(this.x+$k,this.y+$l,$g,$h,$i);this.createLoopLine($j,$m,this.borderWidth,$e+$j.length/5),$c.append(new Uint16Array($m)),$d.append(new Float32Array($j))}},$d.createLoopLine=function($c,$d,$e,$f,$g,$h){$c.length;var $i=$c.concat(),$j=$g||$c,$k=this.borderColor,$l=($k>>16&255)/255,$m=($k>>8&255)/255,$n=(255&$k)/255,$o=[$i[0],$i[1]],$p=[$i[$i.length-5],$i[$i.length-4]],$q=$p[0]+.5*($o[0]-$p[0]),$r=$p[1]+.5*($o[1]-$p[1]);$i.unshift($q,$r,0,0,0),$i.push($q,$r,0,0,0);var $s,$t,$u,$v,$w,$x,$y,$z,$A,$B,$C,$D,$E,$F,$G,$H,$I,$J,$K,$L,$M=$i.length/5,$N=$f,$O=$e/2;$u=$i[0],$v=$i[1],$B=$u-($w=$i[5]),$A=($A=-($v-($x=$i[6])))/($L=Math.sqrt($A*$A+$B*$B))*$O,$B=$B/$L*$O,$j.push($u-$A,$v-$B,$l,$m,$n,$u+$A,$v+$B,$l,$m,$n);for(var $P=1;$P<$M-1;$P++)$u=$i[5*($P-1)],$v=$i[5*($P-1)+1],$w=$i[5*$P],$x=$i[5*$P+1],$y=$i[5*($P+1)],$z=$i[5*($P+1)+1],$B=$u-$w,$D=$w-$y,$G=(-($A=($A=-($v-$x))/($L=Math.sqrt($A*$A+$B*$B))*$O)+$u)*(-($B=$B/$L*$O)+$x)-(-$A+$w)*(-$B+$v),$J=(-($C=($C=-($x-$z))/($L=Math.sqrt($C*$C+$D*$D))*$O)+$y)*(-($D=$D/$L*$O)+$x)-(-$C+$w)*(-$D+$z),$K=($E=-$B+$v-(-$B+$x))*($I=-$C+$w-(-$C+$y))-($H=-$D+$z-(-$D+$x))*($F=-$A+$w-(-$A+$u)),Math.abs($K)<.1?($K+=10.1,$j.push($w-$A,$x-$B,$l,$m,$n,$w+$A,$x+$B,$l,$m,$n)):((($s=($F*$J-$I*$G)/$K)-$w)*($s-$w)+(($t=($H*$G-$E*$J)/$K)-$x)+($t-$x),$j.push($s,$t,$l,$m,$n,$w-($s-$w),$x-($t-$x),$l,$m,$n));$h&&($d=$h);var $Q=this.edges+1;for($P=1;$P<$Q;$P++)$d.push($N+2*($P-1),$N+2*($P-1)+1,$N+2*$P+1,$N+2*$P+1,$N+2*$P,$N+2*($P-1));return $d.push($N+2*($P-1),$N+2*($P-1)+1,$N+1,$N+1,$N,$N+2*($P-1)),$j},$n}(),$Hc=function($c){function $i($c,$d,$e,$f,$g,$h){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=$B.create(),this._points=$e.slice(0,$e.length),$i.__super.call(this,$c,$d,0,0,this._points.length/2,$f,$g,$h)}$o($i,"laya.webgl.shapes.Polygon",$ec);var $d=$i.prototype;return $d.rebuild=function($c){this._repaint||(this._points.length=0,this._points=this._points.concat($c))},$d.setMatrix=function($c){$c.copyTo(this._mat)},$d.needUpdate=function($c){return this._repaint=this._mat.a==$c.a&&this._mat.b==$c.b&&this._mat.c==$c.c&&this._mat.d==$c.d&&this._mat.tx==$c.tx&&this._mat.ty==$c.ty,!this._repaint},$d.getData=function($c,$d,$e){var $f,$g=0,$h=this._points,$i=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=$e){for(this._start=$e,$f=[],$i=this.earcutTriangles.length,$g=0;$g<$i;$g++)$f.push(this.earcutTriangles[$g]+$e);this.mUint16Array=new Uint16Array($f)}}else{this._start=$e,$f=[];var $j=[],$k=[],$l=this.color,$m=($l>>16&255)/255,$n=($l>>8&255)/255,$o=(255&$l)/255;for($i=Math.floor($h.length/2),$g=0;$g<$i;$g++)$j.push(this.x+$h[2*$g],this.y+$h[2*$g+1],$m,$n,$o),$k.push(this.x+$h[2*$g],this.y+$h[2*$g+1]);for(this.earcutTriangles=$fc.earcut($k,null,2),$i=this.earcutTriangles.length,$g=0;$g<$i;$g++)$f.push(this.earcutTriangles[$g]+$e);this.mUint16Array=new Uint16Array($f),this.mFloat32Array=new Float32Array($j)}$c.append(this.mUint16Array),$d.append(this.mFloat32Array)},$i}(),$Ic=function($c){function $h(){this._matrix=new $B,this._matrix4=$rc.defaultMatrix4.concat(),$h.__super.call(this,1e4),this.shaderValue=new $Ac(0,0)}$o($h,"laya.webgl.submit.SubmitCanvas",$hc);var $d=$h.prototype;return $d.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var $c=$uc.worldAlpha,$d=$uc.worldMatrix4,$e=$uc.worldMatrix,$f=$uc.worldFilters,$g=$uc.worldShaderDefines,$h=this.shaderValue,$i=this._matrix,$j=this._matrix4,$k=$B.TEMP;return $B.mul($i,$e,$k),$j[0]=$k.a,$j[1]=$k.b,$j[4]=$k.c,$j[5]=$k.d,$j[12]=$k.tx,$j[13]=$k.ty,$uc.worldMatrix=$k.clone(),$uc.worldMatrix4=$j,$uc.worldAlpha=$uc.worldAlpha*$h.alpha,$h.filters&&$h.filters.length&&($uc.worldFilters=$h.filters,$uc.worldShaderDefines=$h.defines),this._ctx_src.flush(),$uc.worldAlpha=$c,$uc.worldMatrix4=$d,$uc.worldMatrix.destroy(),$uc.worldMatrix=$e,$uc.worldFilters=$f,$uc.worldShaderDefines=$g,1},$d.releaseRender=function(){var $c=$h._cache;this._ctx_src=null,$c[$c._length++]=this},$d.getRenderType=function(){return 10003},$h.create=function($c,$d,$e){var $f=$h._cache._length?$h._cache[--$h._cache._length]:new $h;$f._ctx_src=$c;var $g=$f.shaderValue;return $g.alpha=$d,$g.defines.setValue(0),$e&&$e.length&&$g.setFilters($e),$f},$h._cache=(($h._cache=[])._length=0,$h._cache),$h}(),$Jc=function($c){function $l($c){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===$c&&($c=1e4),$l.__super.call(this,$c)}$o($l,"laya.webgl.submit.SubmitTexture",$hc);var $d=$l.prototype;return $d.releaseRender=function(){var $c=$l._cache;($c[$c._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},$d.addTexture=function($c,$d){this._texsID[this._texs.length]=$c._uvID,this._texs.push($c),this._vbPos.push($d)},$d.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var $c=this.shaderValue.textureHost.bitmap;if(null!==$c)for(var $d=this._vb.getFloat32Array(),$e=0,$f=this._texs.length;$e<$f;$e++){var $g=this._texs[$e];$g.active();var $h=$g.uv;if(this._texsID[$e]!==$g._uvID){this._texsID[$e]=$g._uvID;var $i=this._vbPos[$e];$d[$i+2]=$h[0],$d[$i+3]=$h[1],$d[$i+6]=$h[2],$d[$i+7]=$h[3],$d[$i+10]=$h[4],$d[$i+11]=$h[5],$d[$i+14]=$h[6],$d[$i+15]=$h[7],this._vb.setNeedUpload()}$g.bitmap!==$c&&(this._isSameTexture=!1)}}},$d.renderSubmit=function(){if(0===this._numEle)return $l._shaderSet=!1,1;var $c=this.shaderValue.textureHost;if($c){var $d=$c.source;if(!$c.bitmap||!$d)return $l._shaderSet=!1,1;this.shaderValue.texture=$d,$c.alphaTexture&&$c.alphaTexture.source&&(this.shaderValue.texture1=$c.alphaTexture.source)}this._vb.bind_upload(this._ib);var $e=$wc.mainContext;if($S.activeBlendFunction!==this._blendFn&&($e.enable(3042),this._blendFn($e),$S.activeBlendFunction=this._blendFn),$G.drawCall++,$G.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&$Lc.activeShader&&$l._shaderSet?($Lc.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&$Lc.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),$l._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var $f=$c.bitmap,$g=0,$h=$Lc.activeShader,$i=0,$j=this._texs.length;$i<$j;$i++){var $k=this._texs[$i];$k.bitmap===$f&&$i+1!==$j||($h.uploadTexture2D($k.source),$e.drawElements(4,6*($i-$g+1),5123,this._startIdx+6*$g*$rc.BYTES_PIDX),$f=$k.bitmap,$g=$i)}else $e.drawElements(4,this._numEle,5123,this._startIdx);return 1},$l.create=function($c,$d,$e,$f,$g){var $h=$l._cache._length?$l._cache[--$l._cache._length]:new $l;null==$e&&(($e=$h._selfVb||($h._selfVb=$bc.create(-1))).clear(),$f=0),$h._ib=$d,$h._vb=$e,$h._startIdx=$f*$rc.BYTES_PIDX,$h._numEle=0;var $i=$c._nBlendType;$h._blendFn=$c._targets?$S.targetFns[$i]:$S.fns[$i],$h.shaderValue=$g,$h.shaderValue.setValue($c._shader2D);var $j=$c._shader2D.filters;return $j&&$h.shaderValue.setFilters($j),$h},$l._cache=(($l._cache=[])._length=0,$l._cache),$l._shaderSet=!0,$l}(),$Kc=function($c){function $t(){$t.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}$o($t,"laya.webgl.utils.MeshTexture",$tc);var $d=$t.prototype;return $d.addData=function($c,$d,$e,$f,$g,$h){for(var $i=$c.length/2,$j=this._vb.needSize($i*$t.const_stride)>>2,$k=this._vb.getFloat32Array(),$l=0,$m=0;$m<$i;$m++){var $n=$c[$l],$o=$c[$l+1],$p=$n*$f.a+$o*$f.c+$f.tx,$q=$n*$f.b+$o*$f.d+$f.ty;$k[$j++]=$p,$k[$j++]=$q,$k[$j++]=$d[$l],$k[$j++]=$d[$l+1],$l+=2}this._vb.setNeedUpload();var $r=this.vertNum;if(0<$r){($i=$e.length)>$t.tmpIdx.length&&($t.tmpIdx=new Uint16Array($i));for(var $s=0;$s<$i;$s++)$t.tmpIdx[$s]=$e[$s]+$r;this._ib.appendU16Array($t.tmpIdx,$e.length)}else this._ib.append($e);this._ib.setNeedUpload(),this.vertNum+=$i,this.indexNum+=$e.length},$d.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},$d.destroy=function(){this._ib.destroy(),this._vb.destroy()},$t.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new $t},$t.const_stride=16,$t._POOL=[],$i($t,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),$t}(),$Lc=function($c){function $d(){$d.__super.call(this),this.lock=!0}return $o($d,"laya.webgl.shader.BaseShader",$v),$d.activeShader=null,$d.bindShader=null,$d}(),$Mc=function($d){function $m($c,$d,$e,$f,$g,$h,$i,$j,$k){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===$e&&($e=6408),void 0===$f&&($f=5121),void 0===$g&&($g=34041),void 0===$h&&($h=!1),void 0===$i&&($i=!1),void 0===$j&&($j=-1),void 0===$k&&($k=-1),this._type=1,this._w=$c,this._h=$d,this._surfaceFormat=$e,this._surfaceType=$f,this._depthStencilFormat=$g,$t.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=$h,this._repeat=$i,this._minFifter=$j,this._magFifter=$k,this._createWebGLRenderTarget(),this.bitmap.lock=!0,$m.__super.call(this,this.bitmap,$K.INV_UV)}$o($m,"laya.webgl.resource.RenderTarget2D",$d);var $c=$m.prototype;return $y.imps($c,{"laya.resource.IDispose":!0}),$c.getType=function(){return this._type},$c.getTexture=function(){return this},$c.size=function($c,$d){this._w==$c&&this._h==$d||(this._w=$c,this._h=$d,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},$c.release=function(){this.destroy()},$c.recycle=function(){$m.POOL.push(this)},$c.start=function(){var $c=$wc.mainContext;return this._preRenderTarget=$uc.curRenderTarget,$uc.curRenderTarget=this,$c.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&($c.viewport(0,0,this._w,this._h),this._svWidth=$uc.width,this._svHeight=$uc.height,$uc.width=this._w,$uc.height=this._h,$Lc.activeShader=null),this},$c.clear=function($c,$d,$e,$f){void 0===$c&&($c=0),void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=1);var $g=$wc.mainContext;$g.clearColor($c,$d,$e,$f);var $h=16384;switch(this._depthStencilFormat){case 33189:$h|=256;break;case 36168:$h|=1024;break;case 34041:$h|=256,$h|=1024}$g.clear($h)},$c.end=function(){var $c=$wc.mainContext;$c.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,$uc.curRenderTarget=this._preRenderTarget,1==this._type?($c.viewport(0,0,this._svWidth,this._svHeight),$uc.width=this._svWidth,$uc.height=this._svHeight,$Lc.activeShader=null):$c.viewport(0,0,$y.stage.width,$y.stage.height)},$c.getData=function($c,$d,$e,$f){var $g=$wc.mainContext;if($g.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===$g.checkFramebufferStatus(36160)))return $g.bindFramebuffer(36160,null),null;var $h=new Uint8Array(this._w*this._h*4);return $g.readPixels($c,$d,$e,$f,this._surfaceFormat,this._surfaceType,$h),$g.bindFramebuffer(36160,null),$h},$c.destroy=function($c){void 0===$c&&($c=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,$d.prototype.destroy.call(this))},$c.dispose=function(){},$c._createWebGLRenderTarget=function(){this.bitmap=new $Wc(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function($c){this.event("recovered")})},$f(0,$c,"surfaceFormat",function(){return this._surfaceFormat}),$f(0,$c,"magFifter",function(){return this._magFifter}),$f(0,$c,"surfaceType",function(){return this._surfaceType}),$f(0,$c,"mipMap",function(){return this._mipMap}),$f(0,$c,"depthStencilFormat",function(){return this._depthStencilFormat}),$f(0,$c,"minFifter",function(){return this._minFifter}),$f(0,$c,"source",function(){return this._alreadyResolved?$y.superGet($K,this,"source"):null}),$m.create=function($c,$d,$e,$f,$g,$h,$i,$j,$k){void 0===$e&&($e=6408),void 0===$f&&($f=5121),void 0===$g&&($g=34041),void 0===$h&&($h=!1),void 0===$i&&($i=!1),void 0===$j&&($j=-1),void 0===$k&&($k=-1);var $l=$m.POOL.pop();return $l||($l=new $m($c,$d)),$l.bitmap&&$l._w==$c&&$l._h==$d&&$l._surfaceFormat==$e&&$l._surfaceType==$f&&$l._depthStencilFormat==$g&&$l._mipMap==$h&&$l._repeat==$i&&$l._minFifter==$j&&$l._magFifter==$k||($l._w=$c,$l._h=$d,$l._surfaceFormat=$e,$l._surfaceType=$f,$l._depthStencilFormat=$g,$t.isConchWebGL&&34041===$l._depthStencilFormat&&($l._depthStencilFormat=33189),$l._mipMap=$h,$l._repeat=$i,$l._minFifter=$j,$l._magFifter=$k,$l.release(),$l._createWebGLRenderTarget()),$l},$m.TYPE2D=1,$m.TYPE3D=2,$m.POOL=[],$m}($K),$Nc=function($c){function $d(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,$d.__super.call(this),$d._gl=$wc.mainContext}$o($d,"laya.webgl.utils.Buffer",$v);var $e=$d.prototype;return $e._bind=function(){this.activeResource(),$d._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&($d._bindVertexBuffer=this._glBuffer),$d._gl.bindBuffer(this._bufferType,$d._bindActive[this._bufferType]=this._glBuffer),$Lc.activeShader=null)},$e.recreateResource=function(){this._glBuffer||(this._glBuffer=$d._gl.createBuffer()),this.completeCreate()},$e.disposeResource=function(){this._glBuffer&&($wc.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},$f(0,$e,"bufferUsage",function(){return this._bufferUsage}),$d._gl=null,$d._bindActive={},$d._bindVertexBuffer=null,$d._enableAtributes=[],$d}(),$Oc=function($c){function $e($c){this.texcoord=null,this.offsetX=300,this.offsetY=0,$e.__super.call(this,512,0);var $d=8*$rc.BYTES_PE;this.position=[2,5126,!1,$d,0],this.texcoord=[2,5126,!1,$d,2*$rc.BYTES_PE],this.color=[4,5126,!1,$d,4*$rc.BYTES_PE]}return $o($e,"laya.webgl.shader.d2.skinAnishader.SkinSV",$Ac),$e}(),$Pc=function($c){function $d($c){$d.__super.call(this,2,0),this.color=[]}return $o($d,"laya.webgl.shader.d2.value.Color2dSV",$Ac),$d.prototype.setValue=function($c){$c.fillStyle&&(this.color=$c.fillStyle._color._color),$c.strokeStyle&&(this.color=$c.strokeStyle._color._color)},$d}(),$Qc=function($c){function $d($c){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=$Ac._TEXCOORD,$d.__super.call(this,256,0)}$o($d,"laya.webgl.shader.d2.value.FillTextureSV",$Ac);var $e=$d.prototype;return $e.setValue=function($c){this.ALPHA=$c.ALPHA,$c.filters&&this.setFilters($c.filters)},$e.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$d}(),$Rc=function($c){function $d($c){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=$Ac._TEXCOORD,void 0===$c&&($c=0),$d.__super.call(this,1,$c)}$o($d,"laya.webgl.shader.d2.value.TextureSV",$Ac);var $e=$d.prototype;return $e.setValue=function($c){this.ALPHA=$c.ALPHA,$c.filters&&this.setFilters($c.filters)},$e.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$d}(),$Sc=function($c){function $d($c){this.a_color=null,this.u_pos=[0,0],$d.__super.call(this,4,0),this.position=[2,5126,!1,5*$rc.BYTES_PE,0],this.a_color=[3,5126,!1,5*$rc.BYTES_PE,2*$rc.BYTES_PE]}return $o($d,"laya.webgl.shader.d2.value.PrimitiveSV",$Ac),$d}(),$Tc=function($c){function $d(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,$d.__super.call(this)}$o($d,"laya.webgl.atlas.AtlasWebGLCanvas",$c);var $e=$d.prototype;return $e.recreateResource=function(){var $c=$wc.mainContext,$d=this._source=$c.createTexture(),$e=$xc.curBindTexTarget,$f=$xc.curBindTexValue;$xc.bindTexture($c,3553,$d),$c.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),$c.texParameteri(3553,10241,9729),$c.texParameteri(3553,10240,9729),$c.texParameteri(3553,10242,33071),$c.texParameteri(3553,10243,33071),$e&&$f&&$xc.bindTexture($c,$e,$f),this.memorySize=this._w*this._h*4,this.completeCreate()},$e.disposeResource=function(){this._source&&($wc.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$e.texSubImage2D=function($c,$d,$e){if($t.isFlash){this._flashCacheImage||(this._flashCacheImage=$r.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var $f=$e.bitmapdata;this._flashCacheImage._image.copyPixels($f,0,0,$f.width,$f.height,$c,$d),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var $g=$wc.mainContext,$h=$xc.curBindTexTarget,$i=$xc.curBindTexValue;$xc.bindTexture($g,3553,this._source),$g.pixelStorei(37441,!0),0<=$c-1&&$g.texSubImage2D(3553,0,$c-1,$d,6408,5121,$e),$c+1<=this._w&&$g.texSubImage2D(3553,0,$c+1,$d,6408,5121,$e),0<=$d-1&&$g.texSubImage2D(3553,0,$c,$d-1,6408,5121,$e),$d+1<=this._h&&$g.texSubImage2D(3553,0,$c,$d+1,6408,5121,$e),$g.texSubImage2D(3553,0,$c,$d,6408,5121,$e),$g.pixelStorei(37441,!1),$h&&$i&&$xc.bindTexture($g,$h,$i)}},$e.texSubImage2DPixel=function($c,$d,$e,$f,$g){var $h=$wc.mainContext,$i=$xc.curBindTexTarget,$j=$xc.curBindTexValue;$xc.bindTexture($h,3553,this._source);var $k=new Uint8Array($g.data);$h.pixelStorei(37441,!0),$h.texSubImage2D(3553,0,$c,$d,$e,$f,6408,5121,$k),$h.pixelStorei(37441,!1),$i&&$j&&$xc.bindTexture($h,$i,$j)},$f(0,$e,"width",$c.prototype._$get_width,function($c){this._w=$c}),$f(0,$e,"height",$c.prototype._$get_height,function($c){this._h=$c}),$d}($e),$Uc=function($c){function $g(){this.flipY=!0,this.alwaysChange=!1,$g.__super.call(this)}$o($g,"laya.webgl.resource.WebGLCanvas",$e);var $d=$g.prototype;return $d.getCanvas=function(){return this._canvas},$d.clear=function(){this._ctx&&this._ctx.clear()},$d.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$d._setContext=function($c){this._ctx=$c},$d.getContext=function($c,$d){return this._ctx?this._ctx:this._ctx=$g._createContext(this)},$d.size=function($c,$d){this._w==$c&&this._h==$d||(this._w=$c,this._h=$d,this._ctx&&this._ctx.size($c,$d),this._canvas&&(this._canvas.height=$d,this._canvas.width=$c))},$d.activeResource=function($c){void 0===$c&&($c=!1),this._source||this.recreateResource()},$d.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},$d.disposeResource=function(){this._source&&!this.iscpuSource&&($wc.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$d.createWebGlTexture=function(){var $c=$wc.mainContext;this._canvas;var $d=this._source=$c.createTexture();this.iscpuSource=!1;var $e=$xc.curBindTexTarget,$f=$xc.curBindTexValue;$xc.bindTexture($c,3553,$d),$c.pixelStorei(37440,this.flipY?1:0),$g.premulAlpha&&$c.pixelStorei(37441,!0),$c.texImage2D(3553,0,6408,6408,5121,this._imgData),$g.premulAlpha&&$c.pixelStorei(37441,!1),$c.texParameteri(3553,10240,9729),$c.texParameteri(3553,10241,9729),$c.texParameteri(3553,10242,33071),$c.texParameteri(3553,10243,33071),$c.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,$e&&$f&&$xc.bindTexture($c,$e,$f)},$d.reloadCanvasData=function(){var $c=$wc.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var $d=$xc.curBindTexTarget,$e=$xc.curBindTexValue;$xc.bindTexture($c,3553,this._source),$g.premulAlpha&&$c.pixelStorei(37441,!0),$c.texImage2D(3553,0,6408,6408,5121,this._imgData),$g.premulAlpha&&$c.pixelStorei(37441,!1),$c.pixelStorei(37440,0),$d&&$e&&$xc.bindTexture($c,$d,$e)},$d.texSubImage2D=function($c,$d,$e){var $f=$wc.mainContext,$g=$xc.curBindTexTarget,$h=$xc.curBindTexValue;$xc.bindTexture($f,3553,this._source),$f.pixelStorei(37441,!0),$f.texSubImage2D(3553,0,$d,$e,6408,5121,$c._source),$f.pixelStorei(37441,!1),$g&&$h&&$xc.bindTexture($f,$g,$h)},$d.toBase64=function($c,$d,$e){var $f=null;this._canvas&&($f=this._canvas.toDataURL($c,$d)),$e.call(this,$f)},$f(0,$d,"context",function(){return this._ctx}),$f(0,$d,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),$f(0,$d,"asBitmap",null,function($c){this._ctx&&(this._ctx.asBitmap=$c)}),$g._createContext=null,$g.premulAlpha=!1,$g}(),$Vc=function($c){function $h($c,$d){this.CborderSize=12,$h.__super.call(this),this.char=$c,this.isSpace=" "===$c,this.xs=$d.scaleX,this.ys=$d.scaleY,this.font=$d.font.toString(),this.fontSize=$d.font.size,this.fillColor=$d.fillColor,this.borderColor=$d.borderColor,this.lineWidth=$d.lineWidth,this.underLine=$d.underLine;var $e,$f=$t.isConchApp;$f?(($e=ConchTextCanvas)._source=ConchTextCanvas,$e._source.canvas=ConchTextCanvas):$e=$p.canvas.source,this.canvas=$e,this._enableMerageInAtlas=!0,this._ctx=$f?$e:this.canvas.getContext("2d",void 0);var $g=$L.measureText(this.char,this.font);this.cw=$g.width*this.xs,this.ch=($g.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new $K(this)}$o($h,"laya.webgl.resource.WebGLCharImage",$e);var $d=$h.prototype;return $y.imps($d,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$d.active=function(){this.texture.active()},$d.recreateResource=function(){var $c=$t.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),$c){var $d=this.fontSize;1==this.xs&&1==this.ys||($d=parseInt($d*(this.xs>this.ys?this.xs:this.ys)+""));var $e="normal 100 "+this.font;$e=$e.replace($h._fontSizeReg,$d),this.borderColor&&($e+=" 1 "+this.borderColor),this._ctx.font=$e,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,$J.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var $f=this._ctx.measureText(this.char).width+1;this._ctx.lineTo($f,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},$d.onresize=function($c,$d){this._w=$c,this._h=$d,this._allowMerageInAtlas=!0},$d.clearAtlasSource=function(){},$f(0,$d,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$f(0,$d,"atlasSource",function(){return this.canvas}),$f(0,$d,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($c){this._enableMerageInAtlas=$c}),$h.createOneChar=function($c,$d){return new $h($c,$d)},$h._fontSizeReg=new RegExp("\\d+(?=px)","g"),$h}(),$Wc=function($c){function $l($c,$d,$e,$f,$g,$h,$i,$j,$k){void 0===$e&&($e=6408),void 0===$f&&($f=5121),void 0===$g&&($g=34041),void 0===$h&&($h=!1),void 0===$i&&($i=!1),void 0===$j&&($j=-1),void 0===$k&&($k=1),$l.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=$c,this._h=$d,this._surfaceFormat=$e,this._surfaceType=$f,this._depthStencilFormat=$g,this._mipMap=$h,this._repeat=$i,this._minFifter=$j,this._magFifter=$k}$o($l,"laya.webgl.resource.WebGLRenderTarget",$e);var $d=$l.prototype;return $d.recreateResource=function(){var $c=$wc.mainContext;this._frameBuffer||(this._frameBuffer=$c.createFramebuffer()),this._source||(this._source=$c.createTexture());var $d=$xc.curBindTexTarget,$e=$xc.curBindTexValue;$xc.bindTexture($c,3553,this._source),$c.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var $f=this._minFifter,$g=this._magFifter,$h=this._repeat?10497:33071,$i=$m.isPOT(this._w,this._h);if($i?(this._mipMap?-1!==$f||($f=9987):-1!==$f||($f=9729),-1!==$g||($g=9729),$c.texParameteri(3553,10241,$f),$c.texParameteri(3553,10240,$g),$c.texParameteri(3553,10242,$h),$c.texParameteri(3553,10243,$h),this._mipMap&&$c.generateMipmap(3553)):(-1!==$f||($f=9729),-1!==$g||($g=9729),$c.texParameteri(3553,10241,$f),$c.texParameteri(3553,10240,$g),$c.texParameteri(3553,10242,33071),$c.texParameteri(3553,10243,33071)),$c.bindFramebuffer(36160,this._frameBuffer),$c.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=$c.createRenderbuffer()),$c.bindRenderbuffer(36161,this._depthStencilBuffer),$c.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:$c.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$c.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$c.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$c.bindFramebuffer(36160,null),$d&&$e&&$xc.bindTexture($c,$d,$e),$c.bindRenderbuffer(36161,null),$i&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},$d.disposeResource=function(){this._frameBuffer&&($wc.mainContext.deleteTexture(this._source),$wc.mainContext.deleteFramebuffer(this._frameBuffer),$wc.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},$f(0,$d,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$f(0,$d,"frameBuffer",function(){return this._frameBuffer}),$l}(),$Xc=function($c){function $j($c,$d,$e,$f,$g,$h,$i){this.offsetX=0,this.offsetY=0,$j.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=$h,this.canvas=$c,this._ctx=$c.getContext("2d",void 0),this._w=$f,this._h=$g,this.offsetX=$d,this.offsetY=$e,this.src=$i,this._enableMerageInAtlas=!0,$Q.enabled&&this._w<$Q.atlasLimitWidth&&this._h<$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}$o($j,"laya.webgl.resource.WebGLSubImage",$e);var $d=$j.prototype;return $y.imps($d,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$d.size=function($c,$d){this._w=$c,this._h=$d,this._ctx&&this._ctx.size($c,$d),this.canvas&&(this.canvas.height=$d,this.canvas.width=$c)},$d.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},$d.createWebGlTexture=function(){var $c=$wc.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var $d=this._source=$c.createTexture(),$e=$xc.curBindTexTarget,$f=$xc.curBindTexValue;$xc.bindTexture($c,3553,$d),$c.pixelStorei(37441,!0),$c.texImage2D(3553,0,6408,6408,5121,this.canvas),$c.pixelStorei(37441,!1);var $g=this.minFifter,$h=this.magFifter,$i=this.repeat?10497:33071,$j=$m.isPOT(this.width,this.height);$j?(this.mipmap?-1!==$g||($g=9987):-1!==$g||($g=9729),-1!==$h||($h=9729),$c.texParameteri(3553,10240,$h),$c.texParameteri(3553,10241,$g),$c.texParameteri(3553,10242,$i),$c.texParameteri(3553,10243,$i),this.mipmap&&$c.generateMipmap(3553)):(-1!==$g||($g=9729),-1!==$h||($h=9729),$c.texParameteri(3553,10241,$g),$c.texParameteri(3553,10240,$h),$c.texParameteri(3553,10242,33071),$c.texParameteri(3553,10243,33071)),$e&&$f&&$xc.bindTexture($c,$e,$f),this.canvas=null,$j&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},$d.disposeResource=function(){$Q.enabled&&this._allowMerageInAtlas||!this._source||($wc.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$d.clearAtlasSource=function(){},$f(0,$d,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$f(0,$d,"atlasSource",function(){return this.canvas}),$f(0,$d,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function($c){this._allowMerageInAtlas=$c}),$j}(),$Yc=function($c){function $l($c,$d,$e,$f){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,$l.__super.call(this),!$c||!$d)throw"Shader Error";this._id=++$l._count,this._vs=$c,this._ps=$d,this._nameMap=$f||{},null!=$e&&($l.sharders[$e]=this)}$o($l,"laya.webgl.shader.Shader",$Lc);var $d=$l.prototype;return $d.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},$d.disposeResource=function(){$wc.mainContext.deleteShader(this._vshader),$wc.mainContext.deleteShader(this._pshader),$wc.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},$d._compile=function(){if(!$wc.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var $c=[this._vs,this._ps],$d=$wc.mainContext;if(this._program=$d.createProgram(),this._vshader=$l._createShader($d,$c[0],35633),this._pshader=$l._createShader($d,$c[1],35632),$d.attachShader(this._program,this._vshader),$d.attachShader(this._program,this._pshader),$d.linkProgram(this._program),!$t.isConchApp&&!$d.getProgramParameter(this._program,35714))throw $d.getProgramInfoLog(this._program);var $e,$f,$g=0,$h=0;for($h=$t.isConchApp?$d.getProgramParameterEx(this._vs,this._ps,"",35721):$d.getProgramParameter(this._program,35721),$g=0;$g<$h;$g++){var $i=null;$e={vartype:"attribute",glfun:null,ivartype:0,attrib:$i=$t.isConchApp?$d.getActiveAttribEx(this._vs,this._ps,"",$g):$d.getActiveAttrib(this._program,$g),location:$d.getAttribLocation(this._program,$i.name),name:$i.name,type:$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push($e)}var $j=0;for($j=$t.isConchApp?$d.getProgramParameterEx(this._vs,this._ps,"",35718):$d.getProgramParameter(this._program,35718),$g=0;$g<$j;$g++){var $k=null;$k=$t.isConchApp?$d.getActiveUniformEx(this._vs,this._ps,"",$g):$d.getActiveUniform(this._program,$g),0<($e={vartype:"uniform",glfun:null,ivartype:1,attrib:$i,location:$d.getUniformLocation(this._program,$k.name),name:$k.name,type:$k.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($e.name=$e.name.substr(0,$e.name.length-3),$e.isArray=!0,$e.location=$d.getUniformLocation(this._program,$e.name)),this._params.push($e)}for($g=0,$f=this._params.length;$g<$f;$g++)if(($e=this._params[$g]).indexOfParams=$g,$e.index=1,$e.value=[$e.location,null],$e.codename=$e.name,$e.name=this._nameMap[$e.codename]?this._nameMap[$e.codename]:$e.codename,(this._paramsMap[$e.name]=$e)._this=this,$e.uploadedValue=[],"attribute"!==$e.vartype)switch($e.type){case 5124:$e.fun=$e.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$e.fun=$e.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$e.fun=$e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$e.fun=$e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$e.fun=$e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$e.fun=this._uniform_sampler2D;break;case 35680:$e.fun=this._uniform_samplerCube;break;case 35676:$e.glfun=$d.uniformMatrix4fv,$e.fun=this._uniformMatrix4fv;break;case 35670:$e.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else $e.fun=this._attribute}},$d.getUniform=function($c){return this._paramsMap[$c]},$d._attribute=function($c,$d){var $e=$wc.mainContext,$f=$Nc._enableAtributes,$g=$c.location;return $f[$g]||$e.enableVertexAttribArray($g),$e.vertexAttribPointer($g,$d[0],$d[1],$d[2],$d[3],$d[4]+this._offset),$f[$g]=$Nc._bindVertexBuffer,1},$d._uniform1f=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d?($wc.mainContext.uniform1f($c.location,$e[0]=$d),1):0},$d._uniform1fv=function($c,$d){if($d.length<4){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]||$e[2]!==$d[2]||$e[3]!==$d[3]?($wc.mainContext.uniform1fv($c.location,$d),$e[0]=$d[0],$e[1]=$d[1],$e[2]=$d[2],$e[3]=$d[3],1):0}return $wc.mainContext.uniform1fv($c.location,$d),1},$d._uniform_vec2=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]?($wc.mainContext.uniform2f($c.location,$e[0]=$d[0],$e[1]=$d[1]),1):0},$d._uniform_vec2v=function($c,$d){if($d.length<2){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]||$e[2]!==$d[2]||$e[3]!==$d[3]?($wc.mainContext.uniform2fv($c.location,$d),$e[0]=$d[0],$e[1]=$d[1],$e[2]=$d[2],$e[3]=$d[3],1):0}return $wc.mainContext.uniform2fv($c.location,$d),1},$d._uniform_vec3=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]||$e[2]!==$d[2]?($wc.mainContext.uniform3f($c.location,$e[0]=$d[0],$e[1]=$d[1],$e[2]=$d[2]),1):0},$d._uniform_vec3v=function($c,$d){return $wc.mainContext.uniform3fv($c.location,$d),1},$d._uniform_vec4=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]||$e[2]!==$d[2]||$e[3]!==$d[3]?($wc.mainContext.uniform4f($c.location,$e[0]=$d[0],$e[1]=$d[1],$e[2]=$d[2],$e[3]=$d[3]),1):0},$d._uniform_vec4v=function($c,$d){return $wc.mainContext.uniform4fv($c.location,$d),1},$d._uniformMatrix2fv=function($c,$d){return $wc.mainContext.uniformMatrix2fv($c.location,!1,$d),1},$d._uniformMatrix3fv=function($c,$d){return $wc.mainContext.uniformMatrix3fv($c.location,!1,$d),1},$d._uniformMatrix4fv=function($c,$d){return $wc.mainContext.uniformMatrix4fv($c.location,!1,$d),1},$d._uniform1i=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d?($wc.mainContext.uniform1i($c.location,$e[0]=$d),1):0},$d._uniform1iv=function($c,$d){return $wc.mainContext.uniform1iv($c.location,$d),1},$d._uniform_ivec2=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]?($wc.mainContext.uniform2i($c.location,$e[0]=$d[0],$e[1]=$d[1]),1):0},$d._uniform_ivec2v=function($c,$d){return $wc.mainContext.uniform2iv($c.location,$d),1},$d._uniform_vec3i=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]||$e[2]!==$d[2]?($wc.mainContext.uniform3i($c.location,$e[0]=$d[0],$e[1]=$d[1],$e[2]=$d[2]),1):0},$d._uniform_vec3vi=function($c,$d){return $wc.mainContext.uniform3iv($c.location,$d),1},$d._uniform_vec4i=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]||$e[2]!==$d[2]||$e[3]!==$d[3]?($wc.mainContext.uniform4i($c.location,$e[0]=$d[0],$e[1]=$d[1],$e[2]=$d[2],$e[3]=$d[3]),1):0},$d._uniform_vec4vi=function($c,$d){return $wc.mainContext.uniform4iv($c.location,$d),1},$d._uniform_sampler2D=function($c,$d){var $e=$wc.mainContext,$f=$c.uploadedValue;return null==$f[0]?($f[0]=this._curActTexIndex,$e.uniform1i($c.location,this._curActTexIndex),$e.activeTexture($l._TEXTURES[this._curActTexIndex]),$xc.bindTexture($e,3553,$d),this._curActTexIndex++,1):($e.activeTexture($l._TEXTURES[$f[0]]),$xc.bindTexture($e,3553,$d),0)},$d._uniform_samplerCube=function($c,$d){var $e=$wc.mainContext,$f=$c.uploadedValue;return null==$f[0]?($f[0]=this._curActTexIndex,$e.uniform1i($c.location,this._curActTexIndex),$e.activeTexture($l._TEXTURES[this._curActTexIndex]),$xc.bindTexture($e,34067,$d),this._curActTexIndex++,1):($e.activeTexture($l._TEXTURES[$f[0]]),$xc.bindTexture($e,34067,$d),0)},$d._noSetValue=function($c){console.log("no....:"+$c.name)},$d.uploadOne=function($c,$d){this.activeResource(),$xc.UseProgram(this._program);var $e=this._paramsMap[$c];$e.fun.call(this,$e,$d)},$d.uploadTexture2D=function($c){$G.shaderCall++;var $d=$wc.mainContext;$d.activeTexture(33984),$xc.bindTexture($d,3553,$c)},$d.uploadTexture2D1=function($c){$G.shaderCall++;var $d=$wc.mainContext;$d.activeTexture(33985),$xc.bindTexture($d,3553,$c)},$d.upload=function($c,$d){$Lc.activeShader=$Lc.bindShader=this,this._lastUseFrameCount===$G.loopCount||this.activeResource(),$xc.UseProgram(this._program),this._reCompile?($d=this._params,this._reCompile=!1):$d=$d||this._params;$wc.mainContext;for(var $e,$f,$g=$d.length,$h=0,$i=0;$i<$g;$i++)null!==($f=$c[($e=$d[$i]).name])&&($h+=$e.fun.call(this,$e,$f));$G.shaderCall+=$h},$d.uploadArray=function($c,$d,$e){$Lc.activeShader=this,($Lc.bindShader=this).activeResource(),$xc.UseProgram(this._program);this._params;for(var $f,$g,$h=0,$i=$d-2;0<=$i;$i-=2)($g=this._paramsMap[$c[$i]])&&null!=($f=$c[$i+1])&&($e&&$e[$g.name]&&$e[$g.name].bind(),$h+=$g.fun.call(this,$g,$f));$G.shaderCall+=$h},$d.getParams=function(){return this._params},$l.getShader=function($c){return $l.sharders[$c]},$l.create=function($c,$d,$e,$f){return new $l($c,$d,$e,$f)},$l.withCompile=function($c,$d,$e,$f){if($e&&$l.sharders[$e])return $l.sharders[$e];var $g=$l._preCompileShader[2e-4*$c];if(!$g)throw new Error("withCompile shader err!"+$c);return $g.createShader($d,$e,$f)},$l.withCompile2D=function($c,$d,$e,$f,$g){if($f&&$l.sharders[$f])return $l.sharders[$f];var $h=$l._preCompileShader[2e-4*$c+$d];if(!$h)throw new Error("withCompile shader err!"+$c+" "+$d);return $h.createShader($e,$f,$g)},$l.addInclude=function($c,$d){$vc.addInclude($c,$d)},$l.preCompile=function($c,$d,$e,$f){var $g=2e-4*$c;$l._preCompileShader[$g]=new $vc($g,$d,$e,$f)},$l.preCompile2D=function($c,$d,$e,$f,$g){var $h=2e-4*$c+$d;$l._preCompileShader[$h]=new $vc($h,$e,$f,$g)},$l._createShader=function($c,$d,$e){var $f=$c.createShader($e);return $c.shaderSource($f,$d),$c.compileShader($f),$f},$l._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],$l._count=0,$l._preCompileShader={},$l.SHADERNAME2ID=2e-4,$l.sharders=(($l.sharders=[]).length=32,$l.sharders),$i($l,["nameKey",function(){return this.nameKey=new $H}]),$l}(),$Zc=function($c){function $d(){this._maxsize=0,this._upload=!0,this._uploadSize=0,$d.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}$o($d,"laya.webgl.utils.Buffer2D",$c);var $e=$d.prototype;return $e.needSize=function($c){var $d=this._byteLength;if($c){var $e=this._byteLength+$c;$e<=this._buffer.byteLength||this._resizeBuffer($e<<1,!0),this._byteLength=$e}return $d},$e._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),$G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$Nc._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$Nc._gl.bufferSubData(this._bufferType,0,this._buffer)},$e._bufferSubData=function($c,$d,$e){if(void 0===$c&&($c=0),void 0===$d&&($d=0),void 0===$e&&($e=0),this._maxsize=Math.max(this._maxsize,this._byteLength),$G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$Nc._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$d||$e){var $f=this._buffer.slice($d,$e);$Nc._gl.bufferSubData(this._bufferType,$c,$f)}else $Nc._gl.bufferSubData(this._bufferType,$c,this._buffer)},$e._checkArrayUse=function(){},$e._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},$e._bind_subUpload=function($c,$d,$e){return void 0===$c&&($c=0),void 0===$d&&($d=0),void 0===$e&&($e=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData($c,$d,$e),!0)},$e._resizeBuffer=function($c,$d){if($c<this._buffer.byteLength)return this;if(this.memorySize=$c,$d&&this._buffer&&0<this._buffer.byteLength){var $e=new ArrayBuffer($c);new Uint8Array($e).set(new Uint8Array(this._buffer),0),this._buffer=$e}else this._buffer=new ArrayBuffer($c);return this._checkArrayUse(),this._upload=!0,this},$e.append=function($c){this._upload=!0;var $d,$e;$d=$c.byteLength,$c instanceof Uint8Array?(this._resizeBuffer(this._byteLength+$d,!0),$e=new Uint8Array(this._buffer,this._byteLength)):$c instanceof Uint16Array?(this._resizeBuffer(this._byteLength+$d,!0),$e=new Uint16Array(this._buffer,this._byteLength)):$c instanceof Float32Array&&(this._resizeBuffer(this._byteLength+$d,!0),$e=new Float32Array(this._buffer,this._byteLength)),$e.set($c,0),this._byteLength+=$d,this._checkArrayUse()},$e.appendU16Array=function($c,$d){this._resizeBuffer(this._byteLength+2*$d,!0);for(var $e=new Uint16Array(this._buffer,this._byteLength,$d),$f=0;$f<$d;$f++)$e[$f]=$c[$f];this._byteLength+=2*$d,this._checkArrayUse()},$e.appendEx=function($c,$d){this._upload=!0;var $e;$e=$c.byteLength,this._resizeBuffer(this._byteLength+$e,!0),new $d(this._buffer,this._byteLength).set($c,0),this._byteLength+=$e,this._checkArrayUse()},$e.appendEx2=function($c,$d,$e,$f){void 0===$f&&($f=1),this._upload=!0;var $g,$h;$g=$e*$f,this._resizeBuffer(this._byteLength+$g,!0),$h=new $d(this._buffer,this._byteLength);var $i=0;for($i=0;$i<$e;$i++)$h[$i]=$c[$i];this._byteLength+=$g,this._checkArrayUse()},$e.getBuffer=function(){return this._buffer},$e.setNeedUpload=function(){this._upload=!0},$e.getNeedUpload=function(){return this._upload},$e.upload=function(){var $c=this._bind_upload();return $Nc._gl.bindBuffer(this._bufferType,null),$Nc._bindActive[this._bufferType]=null,$Lc.activeShader=null,$c},$e.subUpload=function($c,$d,$e){void 0===$c&&($c=0),void 0===$d&&($d=0),void 0===$e&&($e=0);var $f=this._bind_subUpload();return $Nc._gl.bindBuffer(this._bufferType,null),$Nc._bindActive[this._bufferType]=null,$Lc.activeShader=null,$f},$e.disposeResource=function(){$c.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},$e.clear=function(){this._byteLength=0,this._upload=!0},$f(0,$e,"bufferLength",function(){return this._buffer.byteLength}),$f(0,$e,"byteLength",null,function($c){this._byteLength!==$c&&($c<=this._buffer.byteLength||this._resizeBuffer(2*$c+256,!0),this._byteLength=$c)}),$d.__int__=function($c){$ac.QuadrangleIB=$ac.create(35044),$sc.fillIBQuadrangle($ac.QuadrangleIB,16)},$d.FLOAT32=4,$d.SHORT=2,$d}($Nc),$$c=(function($d){function $e($c){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,$e.__super.call(this,9)}$o($e,"laya.webgl.shader.d2.value.GlowSV",$d);var $c=$e.prototype;$c.setValue=function($c){$d.prototype.setValue.call(this,$c)},$c.clear=function(){$d.prototype.clear.call(this)}}($Rc),function($c){function $d($c){$d.__super.call(this,64),this.defines.add(64)}$o($d,"laya.webgl.shader.d2.value.TextSV",$c);var $e=$d.prototype;return $e.release=function(){($d.pool[$d._length++]=this).clear()},$e.clear=function(){$c.prototype.clear.call(this)},$d.create=function(){return $d._length?$d.pool[--$d._length]:new $d(null)},$d.pool=[],$d._length=0,$d}($Rc)),$_c=function($c){function $g($c,$d,$e,$f){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,$g.__super.call(this,$c,$d,$e,$f)}$o($g,"laya.webgl.shader.d2.Shader2X",$c);var $d=$g.prototype;return $d.upload2dQuick1=function($c){this.upload($c,this._params2dQuick1||this._make2dQuick1())},$d._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var $c,$d=this._params,$e=0,$f=$d.length;$e<$f;$e++)$c=$d[$e],($t.isFlash||"size"!==$c.name&&"position"!==$c.name&&"texcoord"!==$c.name)&&this._params2dQuick1.push($c)}return this._params2dQuick1},$d.disposeResource=function(){$c.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},$d.upload2dQuick2=function($c){this.upload($c,this._params2dQuick2||this._make2dQuick2())},$d._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var $c,$d=this._params,$e=0,$f=$d.length;$e<$f;$e++)$c=$d[$e],($t.isFlash||"size"!==$c.name)&&this._params2dQuick2.push($c)}return this._params2dQuick2},$g.create=function($c,$d,$e,$f){return new $g($c,$d,$e,$f)},$g}($Yc),$ac=function($c){function $d($c){this._uint8Array=null,this._uint16Array=null,void 0===$c&&($c=35044),$d.__super.call(this),this._bufferUsage=$c,this._bufferType=34963,$t.isFlash||(this._buffer=new ArrayBuffer(8))}$o($d,"laya.webgl.utils.IndexBuffer2D",$Zc);var $e=$d.prototype;return $e._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},$e.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},$e.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},$e.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},$d.QuadrangleIB=null,$d.create=function($c){return void 0===$c&&($c=35044),new $d($c)},$d}(),$bc=function($c){function $e($c,$d){this._floatArray32=null,this._vertexStride=0,$e.__super.call(this),this._vertexStride=$c,this._bufferUsage=$d,this._bufferType=34962,$t.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}$o($e,"laya.webgl.utils.VertexBuffer2D",$c);var $d=$e.prototype;return $d.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},$d.bind=function($c){$c&&$c._bind(),this._bind()},$d.insertData=function($c,$d){this.getFloat32Array().set($c,$d),this._upload=!0},$d.bind_upload=function($c){$c._bind_upload()||$c._bind(),this._bind_upload()||this._bind()},$d._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},$d.disposeResource=function(){$c.prototype.disposeResource.call(this)},$d.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},$f(0,$d,"vertexStride",function(){return this._vertexStride}),$e.create=function($c,$d){return void 0===$d&&($d=35048),new $e($c,$d)},$e}($Zc),$cd=function($c){function $j($c,$d,$e,$f,$g,$h){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===$e&&($e=6408),void 0===$f&&($f=!0),$j.__super.call(this,$c,$d),$c){if(this._format=$e,this._mipmap=$f,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof $c)this._url=$c,this._src=$c,this._image=new $p.window.Image,$d&&($d.onload&&(this.onload=$d.onload),$d.onerror&&(this.onerror=$d.onerror),$d.onCreate&&$d.onCreate(this)),this._image.crossOrigin=$c&&0==$c.indexOf("data:")?null:"",$c&&(this._image.src=$c);else if($c instanceof ArrayBuffer){this._src=$d,this._url=this._src;var $i=new $k($c);$i.readUTFBytes(4),$i.readUTFBytes(2),$i.getInt16();$i.endian="bigEndian",this._w=$i.getInt16(),this._h=$i.getInt16();$i.getInt16(),$i.getInt16();this._image=new Uint8Array($c,$i.pos),this._format=$wc.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,$Q.enabled&&this._w<$Q.atlasLimitWidth&&this._h<$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!($c instanceof Uint8Array))return this._src=$d,this._url=this._src,this._image=$c.source||$c,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=$d,this._url=this._src,this._w=$g,this._h=$h,this._image=$c,this._format=0===$e?$c.byteLength/($g*$h)==4?6408:6407:$e}this._$5__enableMerageInAtlas=!0}}$o($j,"laya.webgl.resource.WebGLImage",$r);var $d=$j.prototype;return $y.imps($d,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$d._init_=function($c,$d){},$d._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $c=$wc.mainContext,$d=this._source=$c.createTexture(),$e=$xc.curBindTexTarget,$f=$xc.curBindTexValue;$xc.bindTexture($c,3553,$d);var $g=this.minFifter,$h=this.magFifter,$i=this.repeat?10497:33071,$j=$m.isPOT(this._w,this._h),$k=!1;switch($j?(this.mipmap?-1!==$g||($g=9987):-1!==$g||($g=9729),-1!==$h||($h=9729),$c.texParameteri(3553,10241,$g),$c.texParameteri(3553,10240,$h),$c.texParameteri(3553,10242,$i),$c.texParameteri(3553,10243,$i),this.mipmap&&$c.generateMipmap(3553)):(-1!==$g||($g=9729),-1!==$h||($h=9729),$c.texParameteri(3553,10241,$g),$c.texParameteri(3553,10240,$h),$c.texParameteri(3553,10242,33071),$c.texParameteri(3553,10243,33071)),$c.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&$c.pixelStorei($c.UNPACK_ALIGNMENT,1),$c.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&$c.pixelStorei($c.UNPACK_ALIGNMENT,1),$c.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:$k=!0,$c.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case $wc.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$k=!0,$c.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}$c.pixelStorei(37441,!1),$e&&$f&&$xc.bindTexture($c,$e,$f),this.uri||(this.uri=this._url),$k?this.memorySize=this._image.length:$j&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},$d.recreateResource=function(){var $c=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var $d=this;this._image=new $p.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if($d._needReleaseAgain)return $d._needReleaseAgain=!1,$d._image.onload=null,void($d._image=null);$d._allowMerageInAtlas&&$d._enableMerageInAtlas?($c.memorySize=0,$c._recreateLock=!1):$d._createWebGlTexture(),$d.completeCreate()},this._image.src=this._src}},$d.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&$wc.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},$d.onresize=function(){this._w=this._image.width,this._h=this._image.height,$Q.enabled&&this._w<$Q.atlasLimitWidth&&this._h<$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},$d.clearAtlasSource=function(){this._image=null},$f(0,$d,"format",function(){return this._format}),$f(0,$d,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function($c){this._$5__enableMerageInAtlas=$c}),$f(0,$d,"mipmap",function(){return this._mipmap}),$f(0,$d,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$f(0,$d,"atlasSource",function(){return this._image}),$f(0,$d,"onload",null,function($c){var $d=this;this._onload=$c,this._image&&(this._image.onload=null!=this._onload?function(){$d.onresize(),$d._onload()}:null)}),$f(0,$d,"onerror",null,function($c){var $d=this;this._onerror=$c,this._image&&(this._image.onerror=null!=this._onerror?function(){$d._onerror()}:null)}),$j}();$y.__init([$pc,$P,$zc,$vc])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($c,$d){"use strict";for(var $e in Object.defineProperty($d,"__esModule",{value:!0}),Laya){var $f=Laya[$e];$f&&$f.__isclass&&($d[$e]=$f)}}),function($h,$c,$f){$f.un,$f.uns;var $g=$f.static,$i=$f.class,$j=$f.getset,$k=($f.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),$q=laya.utils.ClassUtils,$n=(laya.events.Event,laya.utils.HTMLChar),$l=laya.net.Loader,$m=(laya.display.Node,laya.maths.Rectangle),$o=laya.renders.Render,$p=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),$r=laya.utils.Stat,$L=laya.display.Text,$s=laya.resource.Texture,$t=laya.net.URL,$u=laya.utils.Utils,$v=function(){function $p(){}return $i($p,"laya.html.utils.HTMLParse"),$p.parse=function($c,$d,$e){$d=($d="<root>"+($d=$d.replace(/<br>/g,"<br/>"))+"</root>").replace($p.spacePattern,$p.char255);var $f=$u.parseXMLFromString($d);$p._parseXML($c,$f.childNodes[0].childNodes,$e)},$p._parseXML=function($c,$d,$e,$f){var $g=0,$h=0;if($d.join||$d.item)for($g=0,$h=$d.length;$g<$h;++$g)$p._parseXML($c,$d[$g],$e,$f);else{var $i,$j,$k;if(3==$d.nodeType)return void($c instanceof laya.html.dom.HTMLDivElement?(null==$d.nodeName&&($d.nodeName="#text"),$j=$d.nodeName.toLowerCase(),0<($k=$d.textContent.replace(/^\s+|\s+$/g,"")).length&&($i=$q.getInstance($j))&&($c.addChild($i),$i.innerTEXT=$k.replace($p.char255AndOneSpacePattern," "))):0<($k=$d.textContent.replace(/^\s+|\s+$/g,"")).length&&($c.innerTEXT=$k.replace($p.char255AndOneSpacePattern," ")));if("#comment"==($j=$d.nodeName.toLowerCase()))return;if($i=$q.getInstance($j)){($i=$c.addChild($i)).URI=$e,$i.href=$f;var $l=$d.attributes;if($l&&0<$l.length)for($g=0,$h=$l.length;$g<$h;++$g){var $m=$l[$g],$n=$m.nodeName,$o=$m.value;$i._setAttributes($n,$o)}$p._parseXML($i,$d.childNodes,$e,$i.href)}else $p._parseXML($c,$d.childNodes,$e,$f)}},$p.char255=String.fromCharCode(255),$p.spacePattern=/&nbsp;|&#160;/g,$p.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),$p}(),$w=function(){function $K(){}return $i($K,"laya.html.utils.Layout"),$K.later=function($c){null==$K._will&&($K._will=[],$f.stage.frameLoop(1,null,function(){if(!($K._will.length<1)){for(var $c=0;$c<$K._will.length;$c++)laya.html.utils.Layout.layout($K._will[$c]);$K._will.length=0}})),$K._will.push($c)},$K.layout=function($c){if(!$c||!$c._style)return null;if(0==(512&$c._style._type))return null;$c.getStyle()._type&=-513;var $d=$K._multiLineLayout($c);return $o.isConchApp&&$c.layaoutCallNative&&$c.layaoutCallNative(),$d},$K._multiLineLayout=function($c){if($L.RightToLeft)return $K._multiLineLayout2($c);var $d=new Array;$c._addChildsToLayout($d);var $e,$f,$g,$h,$i,$j=0,$k=$d.length,$l=$c._getCSSStyle(),$m=$l.letterSpacing,$n=$l.leading,$o=$l.lineHeight,$p=$l._widthAuto()||!$l.wordWrap,$q=$p?999999:$c.width,$r=($c.height,0),$s=$l.italic?$l.fontSize/3:0,$t=$l._getAlign(),$u=$l._getValign(),$v=0!==$u||0!==$t||0!=$o,$w=0,$x=0,$y=0,$z=0,$A=new Array,$B=$A[0]=new $M,$C=!1,$D=!1;$B.h=0,$l.italic&&($q-=$l.fontSize/3);var $E=0,$F=!0;function $G(){$B.y=$x,$x+=$B.h+$n,0==$B.h&&($x+=$o),$B.mWidth=$E,$E=0,$B=new $M,$A.push($B),$B.h=0,$C=!($F=!($w=0))}for($j=0;$j<$k;$j++)if(null!=($e=$d[$j]))if($F=!1,$e instanceof laya.html.dom.HTMLBrElement)$G(),$B.y=$x;else{if($e._isChar()){if(($h=$e).isWord)$C=$D||"\n"===$h.char,$B.wordStartIndex=$B.elements.length;else{if($y=$h.width+$h.style.letterSpacin,0<$A.length&&$q<$w+$y&&0<$B.wordStartIndex){var $H;$H=$B.elements.length-$B.wordStartIndex+1,$B.elements.length=$B.wordStartIndex,$j-=$H,$G();continue}$C=!1,$E+=$h.width}$y=$h.width+$m,$z=$h.height,$D=!1,($C=$C||$q<$w+$y)&&$G(),$B.minTextHeight=Math.min($B.minTextHeight,$e.height)}else $f=$e._getCSSStyle(),$i=$e,$g=$f.padding,0===$f._getCssFloat()||($v=!0),$C=$D||$f.lineElement,$y=$i.width*$i._style._tf.scaleX+$g[1]+$g[3]+$m,$z=$i.height*$i._style._tf.scaleY+$g[0]+$g[2],$D=$f.lineElement,($C=$C||$q<$w+$y&&$f.wordWrap)&&$G();$B.elements.push($e),$B.h=Math.max($B.h,$z),$e.x=$w,$e.y=$x,$w+=$y,$B.w=$w-$m,$B.y=$x,$r=Math.max($w+$s,$r)}else $F||($w+=$K.DIV_ELEMENT_PADDING),$B.wordStartIndex=$B.elements.length;if($x=$B.y+$B.h,$v){var $I=0,$J=$q;for($p&&0<$c.width&&($J=$c.width),$j=0,$k=$A.length;$j<$k;$j++)$A[$j].updatePos(0,$J,$j,$I,$t,$u,$o),$I+=Math.max($o,$A[$j].h+$n);$x=$I}return $p&&($c.width=$r),$x>$c.height&&($c.height=$x),[$r,$x]},$K._multiLineLayout2=function($c){var $d=new Array;$c._addChildsToLayout($d);var $e,$f,$g,$h,$i,$j=0,$k=$d.length,$l=$c._getCSSStyle(),$m=$l.letterSpacing,$n=$l.leading,$o=$l.lineHeight,$p=$l._widthAuto()||!$l.wordWrap,$q=$p?999999:$c.width,$r=($c.height,0),$s=$l.italic?$l.fontSize/3:0,$t=2-$l._getAlign(),$u=$l._getValign(),$v=0!==$u||0!=$t||0!=$o,$w=0,$x=0,$y=0,$z=0,$A=new Array,$B=$A[0]=new $M,$C=!1,$D=!1;$B.h=0,$l.italic&&($q-=$l.fontSize/3);var $E=0,$F=!0;function $G(){$B.y=$x,$x+=$B.h+$n,0==$B.h&&($x+=$o),$B.mWidth=$E,$E=0,$B=new $M,$A.push($B),$B.h=0,$C=!($F=!($w=0))}for($j=0;$j<$k;$j++)if(null!=($e=$d[$j]))if($F=!1,$e instanceof laya.html.dom.HTMLBrElement)$G(),$B.y=$x;else{if($e._isChar()){if(($h=$e).isWord)$C=$D||"\n"===$h.char,$B.wordStartIndex=$B.elements.length;else{if(0<$A.length&&$q<$w+$y&&0<$B.wordStartIndex){var $H;$H=$B.elements.length-$B.wordStartIndex+1,$B.elements.length=$B.wordStartIndex,$j-=$H,$G();continue}$C=!1,$E+=$h.width}$y=$h.width+$m,$z=$h.height,$D=!1,($C=$C||$q<$w+$y)&&$G(),$B.minTextHeight=Math.min($B.minTextHeight,$e.height)}else $f=$e._getCSSStyle(),$i=$e,$g=$f.padding,0===$f._getCssFloat()||($v=!0),$C=$D||$f.lineElement,$y=$i.width*$i._style._tf.scaleX+$g[1]+$g[3]+$m,$z=$i.height*$i._style._tf.scaleY+$g[0]+$g[2],$D=$f.lineElement,($C=$C||$q<$w+$y&&$f.wordWrap)&&$G();$B.elements.push($e),$B.h=Math.max($B.h,$z),$e.x=$w,$e.y=$x,$w+=$y,$B.w=$w-$m,$B.y=$x,$r=Math.max($w+$s,$r)}else $F||($w+=$K.DIV_ELEMENT_PADDING),$B.wordStartIndex=$B.elements.length;if($x=$B.y+$B.h,$v){var $I=0,$J=$q;for($j=0,$k=$A.length;$j<$k;$j++)$A[$j].updatePos(0,$J,$j,$I,$t,$u,$o),$I+=Math.max($o,$A[$j].h+$n);$x=$I}for($p&&($c.width=$r),$x>$c.height&&($c.height=$x),$j=0,$k=$A.length;$j<$k;$j++)$A[$j].revertOrder($q);return[$r,$x]},$K._will=null,$K.DIV_ELEMENT_PADDING=0,$K}(),$M=function(){function $c(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}$i($c,"laya.html.utils.LayoutLine");var $d=$c.prototype;return $d.updatePos=function($c,$d,$e,$f,$g,$h,$i){var $j,$k=0;0<this.elements.length&&($k=($j=this.elements[this.elements.length-1]).x+$j.width-this.elements[0].x);var $l=0,$m=NaN;1===$g&&($l=($d-$k)/2),2===$g&&($l=$d-$k),0===$i||0!=$h||($h=1);for(var $n=0,$o=this.elements.length;$n<$o;$n++){var $p=($j=this.elements[$n])._getCSSStyle();switch(0!==$l&&($j.x+=$l),$p._getValign()){case 0:$j.y=$f;break;case 1:var $q=0;99999!=this.minTextHeight&&($q=this.minTextHeight);var $r=($q+$i)/2;$r=Math.max($r,this.h),$m=(laya.html.dom.HTMLImageElement,$f+$r-$j.height),$j.y=$m;break;case 2:$j.y=$f+($i-$j.height)}}},$d.revertOrder=function($c){var $d;if(0<this.elements.length){var $e,$f=0;for($e=this.elements.length,$f=0;$f<$e;$f++)($d=this.elements[$f]).x=$c-$d.x-$d.width}},$c}(),$x=function($e){function $d(){this.URI=null,this._href=null,$d.__super.call(this),this._text=$d._EMPTYTEXT,this.setStyle(new $k(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}$i($d,"laya.html.dom.HTMLElement",$e);var $c=$d.prototype;return $c.layaoutCallNative=function(){var $c=0;if(this._childs&&0<($c=this._childs.length))for(var $d=0;$d<$c;$d++)this._childs[$d].layaoutCallNative&&this._childs[$d].layaoutCallNative();var $e=this._getWords();$e?laya.html.dom.HTMLElement.fillWords(this,$e,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},$c.appendChild=function($c){return this.addChild($c)},$c._getWords2=function(){var $c=this._text.text;if(!$c||0===$c.length)return null;var $d,$e,$f=0,$g=0;if(this._text.drawWords)$e=this._text.drawWords;else{for($g=($d=$c.split(" ")).length-1,$e=[],$f=0;$f<$g;$f++)$e.push($d[$f]," ");0<=$g&&$e.push($d[$g]),this._text.drawWords=$e}var $h,$i=this._text.words;if($i&&$i.length===$e.length)return $i;null===$i&&(this._text.words=$i=[]),$i.length=$e.length;var $j=this.style,$k=$j.font;for($f=0,$g=$e.length;$f<$g;$f++){$h=$u.measureText($e[$f],$k);var $l=$i[$f]=new $n($e[$f],$h.width,$h.height||$j.fontSize,$j);if(1<$l.char.length&&($l.charNum=$l.char),this.href){var $m=new $p;this.addChild($m),$l.setSprite($m)}}return $i},$c._getWords=function(){if(!$L.CharacterCache)return this._getWords2();var $c=this._text.text;if(!$c||0===$c.length)return null;var $d,$e=this._text.words;if($e&&$e.length===$c.length)return $e;null===$e&&(this._text.words=$e=[]),$e.length=$c.length;for(var $f=this.style,$g=$f.font,$h=0,$i=$c.length;$h<$i;$h++)if($d=$u.measureText($c.charAt($h),$g)){var $j=$e[$h]=new $n($c.charAt($h),$d.width,$d.height||$f.fontSize,$f);if(this.href){var $k=new $p;this.addChild($k),$j.setSprite($k)}}else console.warn("_getWords size is null"+$c.charAt($h),$g);return $e},$c.showLinkSprite=function(){var $c=this._text.words;if($c)for(var $d,$e,$f=[],$g=0;$g<$c.length;$g++)$e=$c[$g],($d=new $p).graphics.drawRect(0,0,$e.width,$e.height,"#ff0000"),$d.width=$e.width,$d.height=$e.height,this.addChild($d),$f.push($d)},$c._layoutLater=function(){var $c=this.style;512&$c._type||($c.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&$c.block?($w.later(this),$c._type|=512):this.parent&&this.parent._layoutLater())},$c._setAttributes=function($c,$d){switch($c){case"style":return void this.style.cssText($d);case"class":return void(this.className=$d)}$e.prototype._setAttributes.call(this,$c,$d)},$c.updateHref=function(){if(null!=this._href){var $c=this._getWords();if($c)for(var $d,$e,$f=0;$f<$c.length;$f++)($e=($d=$c[$f]).getSprite())&&($e.size($d.width,$d.height),$e.on("click",this,this.onLinkHandler))}},$c.onLinkHandler=function($c){switch($c.type){case"click":for(var $d=this;$d;)$d.event("link",[this.href]),$d=$d.parent}},$c.formatURL=function($c){return this.URI?$t.formatURL($c,this.URI?this.URI.path:null):$c},$j(0,$c,"href",function(){return this._href},function($c){null!=(this._href=$c)&&(this._getCSSStyle().underLine=1,this.updateHref())}),$j(0,$c,"color",null,function($c){this.style.color=$c}),$j(0,$c,"onClick",null,function($c){$f._runScript("fn=function(event){"+$c+";}"),this.on("click",this,void 0)}),$j(0,$c,"id",null,function($c){$y.document.setElementById($c,this)}),$j(0,$c,"innerTEXT",function(){return this._text.text},function($c){this.text=$c}),$j(0,$c,"style",function(){return this._style}),$j(0,$c,"text",function(){return this._text.text},function($c){this._text==$d._EMPTYTEXT?this._text={text:$c,words:null}:(this._text.text=$c,this._text.words&&(this._text.words.length=0)),$o.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),$j(0,$c,"parent",$e.prototype._$get_parent,function($c){if($c instanceof laya.html.dom.HTMLElement){var $d=$c;this.URI||(this.URI=$d.URI),this.style.inherit($d.style)}$f.superSet($p,this,"parent",$c)}),$j(0,$c,"className",null,function($c){this.style.attrs($y.document.styleSheets["."+$c])}),$d.fillWords=function($c,$d,$e,$f,$g,$h,$i){$c.graphics.clear();for(var $j=0,$k=$d.length;$j<$k;$j++){var $l=$d[$j];$c.graphics.fillText($l.char,$l.x+$e,$l.y+$f,$g,$h,"left",$i)}},$d._EMPTYTEXT={text:null,words:null},$d}($p),$d=(function($c){function $d(){$d.__super.call(this),this.style.lineElement=!0,this.style.block=!0}$i($d,"laya.html.dom.HTMLBrElement",$x)}(),function($c){function $d(){this.contextHeight=NaN,this.contextWidth=NaN,$d.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}$i($d,"laya.html.dom.HTMLDivElement",$c);var $e=$d.prototype;return $e.appendHTML=function($c){$v.parse(this,$c,this.URI),this.layout()},$e._addChildsToLayout=function($d){var $c=this._getWords();if(null==$c&&0==this._childs.length)return!1;$c&&$c.forEach(function($c){$d.push($c)});for(var $e=!0,$f=0,$g=this._childs.length;$f<$g;$f++){var $h=this._childs[$f];$e?$e=!1:$d.push(null),$h._addToLayout($d)}return!0},$e._addToLayout=function($c){this.layout()},$e.layout=function(){if(this.style){this.style._type|=512;var $c=$w.layout(this);if($c){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new $m);var $d=this._$P.mHtmlBounds;$d.x=$d.y=0,$d.width=this.contextWidth=$c[0],$d.height=this.contextHeight=$c[1],this.setBounds($d)}}},$j(0,$e,"height",function(){return this._height?this._height:this.contextHeight},$c.prototype._$set_height),$j(0,$e,"innerHTML",null,function($c){this.destroyChildren(),this.appendHTML($c)}),$j(0,$e,"width",function(){return this._width?this._width:this.contextWidth},function($c){var $d=!1;$d=0===$c?$c!=this._width:$c!=this.width,$f.superSet($x,this,"width",$c),$d&&this.layout()}),$d}($x)),$y=function($c){function $d(){this.all=new Array,this.styleSheets=$k.styleSheets,$d.__super.call(this)}$i($d,"laya.html.dom.HTMLDocument",$x);var $e=$d.prototype;return $e.getElementById=function($c){return this.all[$c]},$e.setElementById=function($c,$d){this.all[$c]=$d},$g($d,["document",function(){return this.document=new $d}]),$d}();(function($c){function $d(){this._tex=null,this._url=null,this._renderArgs=[],$d.__super.call(this),this.style.block=!0}$i($d,"laya.html.dom.HTMLImageElement",$x);var $e=$d.prototype;$e._addToLayout=function($c){!this._style.absolute&&$c.push(this)},$e.render=function($c,$d,$e){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||($r.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,$c.ctx.drawTexture2($d,$e,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},$e.layaoutCallNative=function(){var $c=0;if(this._childs&&0<($c=this._childs.length))for(var $d=0;$d<$c;$d++)this._childs[$d].layaoutCallNative&&this._childs[$d].layaoutCallNative()},$j(0,$e,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($c){this._width!==$c&&(this._width=$c,this._style.width=$c,this.repaint())}),$j(0,$e,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($c){this._height!==$c&&(this._height=$c,this._style.height=$c,this.repaint())}),$e.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),$l.clearCache(this,this._url),this._tex=null),$x.prototype.destroy.call(this)},$e.onloaded=function(){var $c=this._style;$c&&!$c.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),$c&&!$c.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),$o.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},$e._loadImageComplete=function($c,$d,$e){if(!this._destroyed)if(null!=$e)if($e instanceof ArrayBuffer){var $f=new DataView($e);new laya.webgl.resource.WebGLImage(new Uint8Array($e,8),$c,0,!1,$f.getUint32(0),$f.getUint32(4));this.onloaded()}else if($e instanceof $s)$l.imgMgrSet[$c]=$d,$h.imgMgrLock($c,$l.imgMgrSet[$c]),this._url=$c,this._tex=$e,$l.keepCache(this,$c),$l.cacheRes($c,this._tex),this.onloaded();else{var $g=-1!=$c.indexOf(".png",$c.length-4)?6408:6407;new laya.webgl.resource.WebGLImage($e,$c,$g,!1,$e.width,$e.height);this.onloaded()}else this.event("error","Load image failed")},$j(0,$e,"src",null,function($c){($c=this.formatURL($c),this._url!=$c)&&(null!=this._tex&&($l.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=$c,(this._tex=$l.getRes($c))?($l.keepCache(this,$c),this.onloaded()):$h.imgMgrLoad($c,this._loadImageComplete.bind(this),2,!1))})})(),function($c){function $d(){this.type=null,$d.__super.call(this),this.visible=!1}$i($d,"laya.html.dom.HTMLLinkElement",$c);var $e=$d.prototype;$e._onload=function($c){switch(this.type){case"text/css":$k.parseCSS($c,this.URI)}},$j(0,$e,"href",$c.prototype._$get_href,function($c){var $d=this;$c=this.formatURL($c),this.URI=new $t($c);var $e=new $l;$e.once("complete",null,function($c){$d._onload($c)}),$e.load($c,"text")}),$d._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}($x),function($c){function $d(){$d.__super.call(this),this.visible=!1}$i($d,"laya.html.dom.HTMLStyleElement",$c),$j(0,$d.prototype,"text",$c.prototype._$get_text,function($c){$k.parseCSS($c,null)})}($x),function($c){function $d(){$d.__super.call(this),this._getCSSStyle().valign="middle"}$i($d,"laya.html.dom.HTMLIframeElement",$c),$j(0,$d.prototype,"href",$c.prototype._$get_href,function($e){var $f=this;$e=this.formatURL($e);var $c=new $l;$c.once("complete",null,function($c){var $d=$f.URI;$f.URI=new $t($e),$f.innerHTML=$c,!$d||($f.URI=$d)}),$c.load($e,"text")})}($d)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($c,$d){"use strict";for(var $e in Object.defineProperty($d,"__esModule",{value:!0}),Laya){var $f=Laya[$e];$f&&$f.__isclass&&($d[$e]=$f)}}),function($c,$d,$r){$r.un,$r.uns;var $f=$r.static,$h=$r.class,$g=$r.getset,$e=($r.__newvec,laya.display.Animation),$s=(laya.utils.Browser,laya.utils.ClassUtils),$i=laya.filters.ColorFilter,$j=laya.utils.Ease,$k=laya.events.Event,$l=(laya.events.EventDispatcher,laya.display.css.Font),$m=laya.display.FrameAnimation,$n=laya.display.Graphics,$o=laya.utils.Handler,$p=laya.display.Input,$u=laya.net.Loader,$q=(laya.display.Node,laya.maths.Point),$t=laya.maths.Rectangle,$v=laya.renders.Render,$w=laya.display.Sprite,$x=laya.display.Text,$y=laya.resource.Texture,$z=laya.utils.Tween,$A=laya.utils.Utils,$B=laya.utils.WeakObject;$r.interface("laya.ui.IItem"),$r.interface("laya.ui.ISelect"),$r.interface("laya.ui.IRender"),$r.interface("laya.ui.IComponent"),$r.interface("laya.ui.IBox","IComponent");var $C=function(){function $c(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return $h($c,"laya.ui.LayoutStyle"),$f($c,["EMPTY",function(){return this.EMPTY=new $c}]),$c}(),$D=function(){function $c(){}return $h($c,"laya.ui.Styles"),$c.labelColor="#000000",$c.buttonStateNum=3,$c.scrollBarMinNum=15,$c.scrollBarDelayTime=500,$f($c,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),$c}(),$E=function(){function $g(){}return $h($g,"laya.ui.UIUtils"),$g.fillArray=function($c,$d,$e){var $f=$c.concat();if($d)for(var $g=$d.split(","),$h=0,$i=Math.min($f.length,$g.length);$h<$i;$h++){var $j=$g[$h];$f[$h]="true"==$j||"false"!=$j&&$j,null!=$e&&($f[$h]=$e($j))}return $f},$g.toColor=function($c){return $A.toHexColor($c)},$g.gray=function($c,$d){void 0===$d&&($d=!0),$d?$g.addFilter($c,$g.grayFilter):$g.clearFilter($c,$i)},$g.addFilter=function($c,$d){var $e=$c.filters||[];$e.push($d),$c.filters=$e},$g.clearFilter=function($c,$d){var $e=$c.filters;if(null!=$e&&0<$e.length){for(var $f=$e.length-1;-1<$f;$f--){var $g=$e[$f];$r.__typeof($g,$d)&&$e.splice($f,1)}$c.filters=$e}},$g._getReplaceStr=function($c){return $g.escapeSequence[$c]},$g.adptString=function($c){return $c.replace(/\\(\w)/g,$g._getReplaceStr)},$g.getBindFun=function($c){var $d=$g._funMap.get($c);if(null==$d){var $e='"'+$c+'"',$f="(function(data){if(data==null)return;with(data){try{\nreturn "+($e=$e.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";$d=$r._runScript($f),$g._funMap.set($c,$d)}return $d},$f($g,["grayFilter",function(){return this.grayFilter=new $i([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new $B}]),$g}(),$F=function(){function $c(){}return $h($c,"UIConfig"),$c.touchScrollEnable=!0,$c.mouseWheelEnable=!0,$c.showButtons=!0,$c.popupBgColor="#000000",$c.popupBgAlpha=.5,$c.closeDialogOnSide=!0,$c}(),$G=function($e){function $t(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,$t.__super.call(this),this._weakKeys=[]}$h($t,"laya.ui.AutoBitmap",$e);var $c=$t.prototype;return $c.destroy=function(){if($u.clearObject(this,this._weakKey),this._weakKeys){for(var $c=0,$d=this._weakKeys.length;$c<$d;++$c)$u.clearObject(this,this._weakKeys[$c]);this._weakKeys=null}$e.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},$c._setChanged=function(){this._isChanged||(this._isChanged=!0,$r.timer.callLater(this,this.changeSource))},$c.changeSource=function(){this._isChanged=!1;var $c=this._source;if($c&&$c.bitmap){var $d=this.width,$e=this.height,$f=this._sizeGrid,$g=$c.sourceWidth,$h=$c.sourceHeight;if(!$f||$g===$d&&$h===$e)this.cleanByTexture($c,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,$d,$e);else{$u.clearObject(this,this._weakKey),$c.$_GID||($c.$_GID=$A.getGID());var $i=$c.$_GID+"."+$d+"."+$e+"."+$f.join("."),$j=$u.findObject($i);if($A.isOKCmdList($j))return this._weakKey=$i,$u.keepObject(this,this._weakKey),void(this.cmds=$j);this.clear();var $k,$l,$m=$f[0],$n=$f[1],$o=$f[2],$p=$f[3],$q=$f[4],$r=!1;if($d==$g&&($p=$n=0),$e==$h&&($m=$o=0),$d<$p+$n){var $s=$d;$r=!0,$d=$p+$n,this.save(),this.clipRect(0,0,$s,$e)}$p&&$m&&($k=$t.getTexture($c,0,0,$p,$m),$l=this._weakKeys[0],$k?($l!=$k.weakKey&&($u.clearObject(this,$l),$u.keepObject(this,$k.weakKey),this._weakKeys[0]=$k.weakKey),this.drawTexture($k,0,0,$p,$m)):($u.clearObject(this,$l),this._weakKeys[0]="")),$n&&$m&&($k=$t.getTexture($c,$g-$n,0,$n,$m),$l=this._weakKeys[1],$k?($l!=$k.weakKey&&($u.clearObject(this,$l),$u.keepObject(this,$k.weakKey),this._weakKeys[1]=$k.weakKey),this.drawTexture($k,$d-$n,0,$n,$m)):($u.clearObject(this,$l),this._weakKeys[1]="")),$p&&$o&&($k=$t.getTexture($c,0,$h-$o,$p,$o),$l=this._weakKeys[2],$k?($l!=$k.weakKey&&($u.clearObject(this,$l),$u.keepObject(this,$k.weakKey),this._weakKeys[2]=$k.weakKey),this.drawTexture($k,0,$e-$o,$p,$o)):($u.clearObject(this,$l),this._weakKeys[2]="")),$n&&$o&&($k=$t.getTexture($c,$g-$n,$h-$o,$n,$o),$l=this._weakKeys[3],$k?($l!=$k.weakKey&&($u.clearObject(this,$l),$u.keepObject(this,$k.weakKey),this._weakKeys[3]=$k.weakKey),this.drawTexture($k,$d-$n,$e-$o,$n,$o)):($u.clearObject(this,$l),this._weakKeys[3]="")),$m&&($k=$t.getTexture($c,$p,0,$g-$p-$n,$m),$l=this._weakKeys[4],$k?($l!=$k.weakKey&&($u.clearObject(this,$l),$u.keepObject(this,$k.weakKey),this._weakKeys[4]=$k.weakKey),this.drawBitmap($q,$k,$p,0,$d-$p-$n,$m)):($u.clearObject(this,$l),this._weakKeys[4]="")),$o&&($k=$t.getTexture($c,$p,$h-$o,$g-$p-$n,$o),$l=this._weakKeys[5],$k?($l!=$k.weakKey&&($u.clearObject(this,$l),$u.keepObject(this,$k.weakKey),this._weakKeys[5]=$k.weakKey),this.drawBitmap($q,$k,$p,$e-$o,$d-$p-$n,$o)):($u.clearObject(this,$l),this._weakKeys[5]="")),$p&&($k=$t.getTexture($c,0,$m,$p,$h-$m-$o),$l=this._weakKeys[6],$k?($l!=$k.weakKey&&($u.clearObject(this,$l),$u.keepObject(this,$k.weakKey),this._weakKeys[6]=$k.weakKey),this.drawBitmap($q,$k,0,$m,$p,$e-$m-$o)):($u.clearObject(this,$l),this._weakKeys[6]="")),$n&&($k=$t.getTexture($c,$g-$n,$m,$n,$h-$m-$o),$l=this._weakKeys[7],$k?($l!=$k.weakKey&&($u.clearObject(this,$l),$u.keepObject(this,$k.weakKey),this._weakKeys[7]=$k.weakKey),this.drawBitmap($q,$k,$d-$n,$m,$n,$e-$m-$o)):($u.clearObject(this,$l),this._weakKeys[7]="")),$k=$t.getTexture($c,$p,$m,$g-$p-$n,$h-$m-$o),$l=this._weakKeys[8],$k?($l!=$k.weakKey&&($u.clearObject(this,$l),$u.keepObject(this,$k.weakKey),this._weakKeys[8]=$k.weakKey),this.drawBitmap($q,$k,$p,$m,$d-$p-$n,$e-$m-$o)):($u.clearObject(this,$l),this._weakKeys[8]=""),$r&&this.restore(),this.autoCacheCmd&&!$v.isConchApp&&($u.saveObject($i,this.cmds,null),this._weakKey=$i,$u.keepObject(this,this._weakKey))}this._repaint()}},$c.drawBitmap=function($c,$d,$e,$f,$g,$h){void 0===$g&&($g=0),void 0===$h&&($h=0),$g<.1||$h<.1||(!$c||$d.width==$g&&$d.height==$h?this.drawTexture($d,$e,$f,$g,$h):this.fillTexture($d,$e,$f,$g,$h))},$c.clear=function($c){void 0===$c&&($c=!0),$e.prototype.clear.call(this,!1)},$g(0,$c,"sizeGrid",function(){return this._sizeGrid},function($c){this._sizeGrid=$c,this._setChanged()}),$g(0,$c,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function($c){this._width!=$c&&(this._width=$c,this._setChanged())}),$g(0,$c,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function($c){this._height!=$c&&(this._height=$c,this._setChanged())}),$g(0,$c,"source",function(){return this._source},function($c){$c?(this._source=$c,this._setChanged()):(this._source=null,this.clear())}),$t.getTexture=function($c,$d,$e,$f,$g){$f<=0&&($f=1),$g<=0&&($g=1),$c.$_GID||($c.$_GID=$A.getGID());var $h=$c.$_GID+"."+$d+"."+$e+"."+$f+"."+$g,$i=$u.findObject($h);if((!$i||!$i.source)&&($i=$y.createFromTexture($c,$d,$e,$f,$g))){if($c.alphaTexture){var $j=$c.width/$c.alphaTexture.width;$i.alphaTexture=$y.createFromTexture($c.alphaTexture,$d/$j,$e/$j,$f/$j,$g/$j)}$u.saveObject($h,$i),$i.weakKey=$h}return $i},$t}($n),$H=(function($c){function $d(){$d.__super.call(this)}$h($d,"laya.ui.UIEvent",$k),$d.SHOW_TIP="showtip",$d.HIDE_TIP="hidetip"}(),function($d){function $c(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,$c.__super.call(this),this._layout=$C.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}$h($c,"laya.ui.Component",$d);var $e=$c.prototype;return $r.imps($e,{"laya.ui.IComponent":!0}),$e.destroy=function($c){void 0===$c&&($c=!0),$d.prototype.destroy.call(this,$c),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},$e.preinitialize=function(){},$e.createChildren=function(){},$e.initialize=function(){},$e.callLater=function($c,$d){$r.timer.callLater(this,$c,$d)},$e.runCallLater=function($c){$r.timer.runCallLater(this,$c)},$e.commitMeasure=function(){},$e.changeSize=function(){this.event("resize")},$e.getLayout=function(){return this._layout===$C.EMPTY&&(this._layout=new $C),this._layout},$e._setLayoutEnabled=function($c){this._layout&&this._layout.enable!=$c&&(this._layout.enable=$c,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},$e.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},$e.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},$e.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},$e.resetLayoutX=function(){var $c=this._layout;if(isNaN($c.anchorX)||(this.pivotX=$c.anchorX*this.width),this.layoutEnabled){var $d=this.parent;$d&&(isNaN($c.centerX)?isNaN($c.left)?isNaN($c.right)||(this.x=Math.round($d.width-this.displayWidth-$c.right+this.pivotX*this.scaleX)):(this.x=Math.round($c.left+this.pivotX*this.scaleX),isNaN($c.right)||(this.width=($d._width-$c.left-$c.right)/(this.scaleX||.01))):this.x=Math.round(.5*($d.width-this.displayWidth)+$c.centerX+this.pivotX*this.scaleX))}},$e.resetLayoutY=function(){var $c=this._layout;if(isNaN($c.anchorY)||(this.pivotY=$c.anchorY*this.height),this.layoutEnabled){var $d=this.parent;$d&&(isNaN($c.centerY)?isNaN($c.top)?isNaN($c.bottom)||(this.y=Math.round($d.height-this.displayHeight-$c.bottom+this.pivotY*this.scaleY)):(this.y=Math.round($c.top+this.pivotY*this.scaleY),isNaN($c.bottom)||(this.height=($d._height-$c.top-$c.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*($d.height-this.displayHeight)+$c.centerY+this.pivotY*this.scaleY))}},$e.onMouseOver=function($c){$r.stage.event("showtip",this._toolTip)},$e.onMouseOut=function($c){$r.stage.event("hidetip",this._toolTip)},$g(0,$e,"displayWidth",function(){return this.width*this.scaleX}),$g(0,$e,"width",function(){return this._width?this._width:this.measureWidth},function($c){this._width!=$c&&(this._width=$c,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),$g(0,$e,"measureWidth",function(){var $c=0;this.commitMeasure();for(var $d=this.numChildren-1;-1<$d;$d--){var $e=this.getChildAt($d);$e.visible&&($c=Math.max($e.x+$e.width*$e.scaleX,$c))}return $c}),$g(0,$e,"displayHeight",function(){return this.height*this.scaleY}),$g(0,$e,"height",function(){return this._height?this._height:this.measureHeight},function($c){this._height!=$c&&(this._height=$c,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),$g(0,$e,"dataSource",function(){return this._dataSource},function($c){for(var $d in this._dataSource=$c,this._dataSource)this.hasOwnProperty($d)&&"function"!=typeof this[$d]&&(this[$d]=this._dataSource[$d])}),$g(0,$e,"scaleY",$d.prototype._$get_scaleY,function($c){$r.superGet($w,this,"scaleY")!=$c&&($r.superSet($w,this,"scaleY",$c),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),$g(0,$e,"measureHeight",function(){var $c=0;this.commitMeasure();for(var $d=this.numChildren-1;-1<$d;$d--){var $e=this.getChildAt($d);$e.visible&&($c=Math.max($e.y+$e.height*$e.scaleY,$c))}return $c}),$g(0,$e,"scaleX",$d.prototype._$get_scaleX,function($c){$r.superGet($w,this,"scaleX")!=$c&&($r.superSet($w,this,"scaleX",$c),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),$g(0,$e,"top",function(){return this._layout.top},function($c){$c!=this._layout.top&&(this.getLayout().top=$c,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$g(0,$e,"bottom",function(){return this._layout.bottom},function($c){$c!=this._layout.bottom&&(this.getLayout().bottom=$c,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$g(0,$e,"left",function(){return this._layout.left},function($c){$c!=this._layout.left&&(this.getLayout().left=$c,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$g(0,$e,"right",function(){return this._layout.right},function($c){$c!=this._layout.right&&(this.getLayout().right=$c,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$g(0,$e,"centerX",function(){return this._layout.centerX},function($c){$c!=this._layout.centerX&&(this.getLayout().centerX=$c,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$g(0,$e,"centerY",function(){return this._layout.centerY},function($c){$c!=this._layout.centerY&&(this.getLayout().centerY=$c,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$g(0,$e,"anchorX",function(){return this._layout.anchorX},function($c){$c!=this._layout.anchorX&&(this.getLayout().anchorX=$c,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$g(0,$e,"anchorY",function(){return this._layout.anchorY},function($c){$c!=this._layout.anchorY&&(this.getLayout().anchorY=$c,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$g(0,$e,"tag",function(){return this._tag},function($c){this._tag=$c}),$g(0,$e,"toolTip",function(){return this._toolTip},function($c){this._toolTip!=$c&&(null!=(this._toolTip=$c)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),$g(0,$e,"comXml",function(){return this._comXml},function($c){this._comXml=$c}),$g(0,$e,"gray",function(){return this._gray},function($c){$c!==this._gray&&(this._gray=$c,$E.gray(this,$c))}),$g(0,$e,"disabled",function(){return this._disabled},function($c){$c!==this._disabled&&(this.gray=this._disabled=$c,this.mouseEnabled=!$c)}),$c}($w)),$I=function($c){function $d(){this.lockLayer=null,this.popupEffect=function($c){$c.scale(1,1),$z.from($c,{x:$r.stage.width/2,y:$r.stage.height/2,scaleX:0,scaleY:0},300,$j.backOut,$o.create(this,this.doOpen,[$c]))},this.closeEffect=function($c,$d){$z.to($c,{x:$r.stage.width/2,y:$r.stage.height/2,scaleX:0,scaleY:0},300,$j.strongOut,$o.create(this,this.doClose,[$c,$d]))},$d.__super.call(this),this.maskLayer=new $w,this.popupEffectHandler=$o.create(this,this.popupEffect,null,!1),this.closeEffectHandler=$o.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,$r.stage.addChild(this),$r.stage.on("resize",this,this._onResize),$F.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}$h($d,"laya.ui.DialogManager",$w);var $e=$d.prototype;return $e._closeOnSide=function(){var $c=this.getChildAt(this.numChildren-1);$c instanceof laya.ui.Dialog&&$c.close("side")},$e.setLockView=function($c){this.lockLayer||(this.lockLayer=new $J,this.lockLayer.mouseEnabled=!0,this.lockLayer.size($r.stage.width,$r.stage.height)),this.lockLayer.removeChildren(),$c&&($c.centerX=$c.centerY=0,this.lockLayer.addChild($c))},$e._onResize=function($c){var $d=this.maskLayer.width=$r.stage.width,$e=this.maskLayer.height=$r.stage.height;this.lockLayer&&this.lockLayer.size($d,$e),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,$d,$e,$F.popupBgColor),this.maskLayer.alpha=$F.popupBgAlpha;for(var $f=this.numChildren-1;-1<$f;$f--){var $g=this.getChildAt($f);$g.popupCenter&&this._centerDialog($g)}},$e._centerDialog=function($c){$c.x=Math.round(($r.stage.width-$c.width>>1)+$c.pivotX),$c.y=Math.round(($r.stage.height-$c.height>>1)+$c.pivotY)},$e.open=function($c,$d,$e){void 0===$d&&($d=!1),void 0===$e&&($e=!1),$d&&this._closeAll(),$c.popupCenter&&this._centerDialog($c),this.addChild($c),($c.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),$e&&null!=$c.popupEffect?$c.popupEffect.runWith($c):this.doOpen($c),this.event("open")},$e.doOpen=function($c){$c.onOpened()},$e.lock=function($c){this.lockLayer&&($c?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},$e.close=function($c,$d,$e){void 0===$e&&($e=!1),$e&&null!=$c.closeEffect?$c.closeEffect.runWith([$c,$d]):this.doClose($c,$d),this.event("close")},$e.doClose=function($c,$d){$c.removeSelf(),$c.isModal&&this._checkMask(),$c.closeHandler&&$c.closeHandler.runWith($d),$c.onClosed($d)},$e.closeAll=function(){this._closeAll(),this.event("close")},$e._closeAll=function(){for(var $c=this.numChildren-1;-1<$c;$c--){var $d=this.getChildAt($c);$d&&null!=$d.close&&this.doClose($d)}},$e.getDialogsByGroup=function($c){for(var $d=[],$e=this.numChildren-1;-1<$e;$e--){var $f=this.getChildAt($e);$f&&$f.group===$c&&$d.push($f)}return $d},$e.closeByGroup=function($c){for(var $d=[],$e=this.numChildren-1;-1<$e;$e--){var $f=this.getChildAt($e);$f&&$f.group===$c&&($f.close(),$d.push($f))}return $d},$e._checkMask=function(){this.maskLayer.removeSelf();for(var $c=this.numChildren-1;-1<$c;$c--){var $d=this.getChildAt($c);if($d&&$d.isModal)return void this.addChildAt(this.maskLayer,$c)}},$d}(),$J=function($c){function $d(){$d.__super.call(this)}$h($d,"laya.ui.Box",$c);var $e=$d.prototype;return $r.imps($e,{"laya.ui.IBox":!0}),$g(0,$e,"dataSource",$c.prototype._$get_dataSource,function($c){for(var $d in this._dataSource=$c){var $e=this.getChildByName($d);$e?$e.dataSource=$c[$d]:this.hasOwnProperty($d)&&"function"!=typeof this[$d]&&(this[$d]=$c[$d])}}),$d}($H),$K=function($d){function $e($c,$d){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,$e.__super.call(this),this._labelColors=$D.buttonLabelColors,this._stateNum=$D.buttonStateNum,void 0===$d&&($d=""),this.skin=$c,this.label=$d}$h($e,"laya.ui.Button",$d);var $c=$e.prototype;return $r.imps($c,{"laya.ui.ISelect":!0}),$c.destroy=function($c){$u.clearCache(this,this._skin),$u.clearObject(this,this._weakKey),void 0===$c&&($c=!0),$d.prototype.destroy.call(this,$c),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy($c),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},$c.createChildren=function(){this.graphics=this._bitmap=new $G},$c.createText=function(){this._text||(this._text=new $x,this._text.overflow=$x.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},$c.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},$c.onMouse=function($c){if(!1!==this.toggle||!this._selected)return"click"===$c.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=$e.stateMap[$c.type]))},$c.changeClips=function(){var $c=$u.getRes(this._skin);if($c&&this._skin&&""!=this._skin){$u.clearObject(this,this._weakKey);var $d=$c.sourceWidth,$e=$c.sourceHeight/this._stateNum;$c.$_GID||($c.$_GID=$A.getGID());var $f=$c.$_GID+"-"+this._stateNum,$g=$u.findObject($f);if($A.isOkTextureList($g)||($g=null),$g)this._weakKey=$f,$u.keepObject(this,this._weakKey),this._sources=$g;else{if(this._sources=[],1===this._stateNum)this._sources.push($c);else for(var $h=0;$h<this._stateNum;$h++){var $i=$y.createFromTexture($c,0,$e*$h,$d,$e);if($c.alphaTexture){var $j=$c.width/$c.alphaTexture.width;$i.alphaTexture=$y.createFromTexture($c.alphaTexture,0/$j,$e*$h/$j,$d/$j,$e/$j)}this._sources.push($i)}$u.saveObject($f,this._sources),this._weakKey=$f,$u.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||$d,this._bitmap.height=this._height||$e,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=$d)}else console.warn("lose skin ",this._skin,this.name,this.__className)},$c.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var $c=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[$c]),this.label&&(this._text.color=this._labelColors[$c],this._strokeColors&&(this._text.strokeColor=this._strokeColors[$c]))},$c._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},$g(0,$c,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function($c){this.createText(),this._text.strokeColor=$c}),$g(0,$c,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),$g(0,$c,"skin",function(){return this._skin},function($c){this._skin!=$c&&($u.clearCache(this,this._skin),this._skin=$c,$u.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),$g(0,$c,"state",function(){return this._state},function($c){this._state!=$c&&(this._state=$c,this._setStateChanged())}),$g(0,$c,"text",function(){return this.createText(),this._text}),$g(0,$c,"stateNum",function(){return this._stateNum},function($c){"string"==typeof $c&&($c=parseInt($c)),this._stateNum!=$c&&(this._stateNum=$c<1?1:3<$c?3:$c,this.callLater(this.changeClips))}),$g(0,$c,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function($c){this._strokeColors=$E.fillArray($D.buttonLabelColors,$c,String),this._setStateChanged()}),$g(0,$c,"labelColors",function(){return this._labelColors.join(",")},function($c){this._labelColors=$E.fillArray($D.buttonLabelColors,$c,String),this._setStateChanged()}),$g(0,$c,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),$g(0,$c,"label",function(){return this._text?this._text.text:null},function($c){(this._text||$c)&&(this.createText(),this._text.text!=$c&&($c&&!this._text.parent&&this.addChild(this._text),this._text.text=($c+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),$g(0,$c,"selected",function(){return this._selected},function($c){this._selected!=$c&&(this._selected=$c,this.state=this._selected?2:0,this.event("change"))}),$g(0,$c,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function($c){this.createText(),this._text.padding=$E.fillArray($D.labelPadding,$c,Number)}),$g(0,$c,"labelSize",function(){return this.createText(),this._text.fontSize},function($c){this.createText(),this._text.fontSize=$c}),$g(0,$c,"labelStroke",function(){return this.createText(),this._text.stroke},function($c){this.createText(),this._text.stroke=$c}),$g(0,$c,"labelBold",function(){return this.createText(),this._text.bold},function($c){this.createText(),this._text.bold=$c}),$g(0,$c,"labelFont",function(){return this.createText(),this._text.font},function($c){this.createText(),this._text.font=$c}),$g(0,$c,"labelAlign",function(){return this.createText(),this._text.align},function($c){this.createText(),this._text.align=$c}),$g(0,$c,"clickHandler",function(){return this._clickHandler},function($c){this._clickHandler=$c}),$g(0,$c,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($c){this._bitmap.sizeGrid=$E.fillArray($D.defaultSizeGrid,$c,Number)}),$g(0,$c,"width",$d.prototype._$get_width,function($c){$r.superSet($H,this,"width",$c),this._autoSize&&(this._bitmap.width=$c,this._text&&(this._text.width=$c))}),$g(0,$c,"height",$d.prototype._$get_height,function($c){$r.superSet($H,this,"height",$c),this._autoSize&&(this._bitmap.height=$c,this._text&&(this._text.height=$c))}),$g(0,$c,"dataSource",$d.prototype._$get_dataSource,function($c){"number"==typeof(this._dataSource=$c)||"string"==typeof $c?this.label=$c+"":$r.superSet($H,this,"dataSource",$c)}),$g(0,$c,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function($c){this._bitmap._offset=$c?$E.fillArray([1,1],$c,Number):[]}),$f($e,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),$e}($H),$L=function($d){function $f($c,$d,$e){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,$f.__super.call(this),void 0===$d&&($d=1),void 0===$e&&($e=1),this._clipX=$d,this._clipY=$e,this.skin=$c}$h($f,"laya.ui.Clip",$d);var $c=$f.prototype;return $c.destroy=function($c){$u.clearCache(this,this._skin),$u.clearObject(this,this._weakKey),void 0===$c&&($c=!0),$d.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},$c.dispose=function(){this.destroy(!0),$r.loader.clearRes(this._skin)},$c.createChildren=function(){this.graphics=this._bitmap=new $G},$c._onDisplay=function($c){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},$c.changeClip=function(){if(this._clipChanged=!1,this._skin){var $c=$u.getRes(this._skin);$c?this.loadComplete(this._skin,$c):$r.loader.load(this._skin,$o.create(this,this.loadComplete,[this._skin]))}},$c.loadComplete=function($c,$d){if($c===this._skin&&$d){$u.clearObject(this,this._weakKey);var $e=this._clipWidth||Math.ceil($d.sourceWidth/this._clipX),$f=this._clipHeight||Math.ceil($d.sourceHeight/this._clipY),$g=this._skin+$e+$f,$h=$u.findObject($g);if($A.isOkTextureList($h)||($h=null),$h)this._weakKey=$g,$u.keepObject(this,this._weakKey),this._sources=$h;else{this._sources=[];for(var $i=0;$i<this._clipY;$i++)for(var $j=0;$j<this._clipX;$j++){var $k=$y.createFromTexture($d,$e*$j,$f*$i,$e,$f);if($d.alphaTexture){var $l=$d.width/$d.alphaTexture.width;$k.alphaTexture=$y.createFromTexture($d.alphaTexture,$e*$j/$l,$f*$i/$l,$e/$l,$f/$l)}this._sources.push($k)}$u.saveObject($g,this._sources),this._weakKey=$g,$u.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},$c.play=function($c,$d){void 0===$c&&($c=0),void 0===$d&&($d=-1),this._isPlaying=!0,this.index=$c,this._toIndex=$d,this._index++,$r.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},$c._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},$c.stop=function(){this._isPlaying=!1,$r.timer.clear(this,this._loop),this.event("complete")},$c._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},$g(0,$c,"interval",function(){return this._interval},function($c){this._interval!=$c&&(this._interval=$c,this._isPlaying&&this.play())}),$g(0,$c,"skin",function(){return this._skin},function($c){this._skin!=$c&&($u.clearCache(this,this._skin),(this._skin=$c)?($u.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),$g(0,$c,"sources",function(){return this._sources},function($c){this._sources=$c,this.index=this._index,this.event("loaded")}),$g(0,$c,"clipX",function(){return this._clipX},function($c){this._clipX=$c||1,this._setClipChanged()}),$g(0,$c,"clipY",function(){return this._clipY},function($c){this._clipY=$c||1,this._setClipChanged()}),$g(0,$c,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),$g(0,$c,"clipWidth",function(){return this._clipWidth},function($c){this._clipWidth=$c,this._setClipChanged()}),$g(0,$c,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($c){this._bitmap.sizeGrid=$E.fillArray($D.defaultSizeGrid,$c,Number)}),$g(0,$c,"group",function(){return this._group},function($c){$c&&this._skin&&$u.setGroup(this._skin,$c),this._group=$c}),$g(0,$c,"clipHeight",function(){return this._clipHeight},function($c){this._clipHeight=$c,this._setClipChanged()}),$g(0,$c,"width",$d.prototype._$get_width,function($c){$r.superSet($H,this,"width",$c),this._bitmap.width=$c}),$g(0,$c,"height",$d.prototype._$get_height,function($c){$r.superSet($H,this,"height",$c),this._bitmap.height=$c}),$g(0,$c,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),$g(0,$c,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),$g(0,$c,"index",function(){return this._index},function($c){this._index=$c,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[$c]),this.event("change")}),$g(0,$c,"autoPlay",function(){return this._autoPlay},function($c){this._autoPlay!=$c&&((this._autoPlay=$c)?this.play():this.stop())}),$g(0,$c,"isPlaying",function(){return this._isPlaying},function($c){this._isPlaying=$c}),$g(0,$c,"dataSource",$d.prototype._$get_dataSource,function($c){"number"==typeof(this._dataSource=$c)&&Math.floor($c)==$c||"string"==typeof $c?this.index=parseInt($c):$r.superSet($H,this,"dataSource",$c)}),$g(0,$c,"bitmap",function(){return this._bitmap}),$f}($H),$M=function($d){function $c(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,$c.__super.call(this)}$h($c,"laya.ui.ColorPicker",$d);var $e=$c.prototype;return $e.destroy=function($c){void 0===$c&&($c=!0),$d.prototype.destroy.call(this,$c),this._colorPanel&&this._colorPanel.destroy($c),this._colorButton&&this._colorButton.destroy($c),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},$e.createChildren=function(){this.addChild(this._colorButton=new $K),this._colorPanel=new $J,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new $w),this._colorPanel.addChild(this._colorBlock=new $w),this._colorPanel.addChild(this._colorInput=new $p)},$e.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},$e.onPanelMouseDown=function($c){$c.stopPropagation()},$e.changePanel=function(){this._panelChanged=!1;var $c=this._colorPanel.graphics;$c.clear(),$c.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,($c=this._colorTiles.graphics).clear();for(var $d=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],$e=0;$e<12;$e++)for(var $f=0;$f<20;$f++){var $g=0;$g=0===$f?$d[$e]:1===$f?0:51*(((3*$e+$f/6)%3<<0)+3*($e/6<<0))<<16|$f%6*51<<8|($e<<0)%6*51;var $h=$E.toColor($g);this._colors.push($h);var $i=$f*this._gridSize,$j=$e*this._gridSize;$c.drawRect($i,$j,this._gridSize,this._gridSize,$h,"#000000")}},$e.onColorButtonClick=function($c){this._colorPanel.parent?this.close():this.open()},$e.open=function(){var $c=this.localToGlobal(new $q),$d=$c.x+this._colorPanel.width<=$r.stage.width?$c.x:$r.stage.width-this._colorPanel.width,$e=$c.y+this._colorButton.height;$e=$e+this._colorPanel.height<=$r.stage.height?$e:$c.y-this._colorPanel.height,this._colorPanel.pos($d,$e),this._colorPanel.zOrder=1001,$r._currentStage.addChild(this._colorPanel),$r.stage.on("mousedown",this,this.removeColorBox)},$e.close=function(){$r.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},$e.removeColorBox=function($c){this.close()},$e.onColorFieldKeyDown=function($c){13==$c.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),$c.stopPropagation())},$e.onColorInputChange=function($c){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},$e.onColorTilesClick=function($c){this.selectedColor=this.getColorByMouse(),this.close()},$e.onColorTilesMouseMove=function($c){this._colorInput.focus=!1;var $d=this.getColorByMouse();this._colorInput.text=$d,this.drawBlock($d)},$e.getColorByMouse=function(){var $c=this._colorTiles.getMousePoint(),$d=Math.floor($c.x/this._gridSize),$e=Math.floor($c.y/this._gridSize);return this._colors[20*$e+$d]},$e.drawBlock=function($c){var $d=this._colorBlock.graphics;$d.clear();var $e=$c||"#ffffff";$d.drawRect(0,0,50,20,$e,this._borderColor),$c||$d.drawLine(0,0,50,20,"#ff0000")},$e.changeColor=function(){var $c=this.graphics;$c.clear();var $d=this._selectedColor||"#000000";$c.drawRect(0,0,this._colorButton.width,this._colorButton.height,$d)},$e._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},$g(0,$e,"inputBgColor",function(){return this._inputBgColor},function($c){this._inputBgColor=$c,this._setPanelChanged()}),$g(0,$e,"selectedColor",function(){return this._selectedColor},function($c){this._selectedColor!=$c&&(this._selectedColor=this._colorInput.text=$c,this.drawBlock($c),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",$k.EMPTY.setTo("change",this,this)))}),$g(0,$e,"skin",function(){return this._colorButton.skin},function($c){this._colorButton.skin=$c,this.changeColor()}),$g(0,$e,"bgColor",function(){return this._bgColor},function($c){this._bgColor=$c,this._setPanelChanged()}),$g(0,$e,"borderColor",function(){return this._borderColor},function($c){this._borderColor=$c,this._setPanelChanged()}),$g(0,$e,"inputColor",function(){return this._inputColor},function($c){this._inputColor=$c,this._setPanelChanged()}),$c}($H),$N=function($d){function $e($c,$d){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,$e.__super.call(this),this._itemColors=$D.comboBoxItemColors,this.skin=$c,this.labels=$d}$h($e,"laya.ui.ComboBox",$d);var $c=$e.prototype;return $c.destroy=function($c){void 0===$c&&($c=!0),$d.prototype.destroy.call(this,$c),this._button&&this._button.destroy($c),this._list&&this._list.destroy($c),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},$c.createChildren=function(){this.addChild(this._button=new $K),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},$c._createList=function(){this._list=new $X,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},$c._setListEvent=function($c){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=$o.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},$c.onListDown=function($c){$c.stopPropagation()},$c.onScrollBarDown=function($c){$c.stopPropagation()},$c.onButtonMouseDown=function($c){this.callLater(this.switchTo,[!this._isOpen])},$c.changeList=function(){this._listChanged=!1;var $c=this.width-2,$d=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:$c,height:this._itemHeight,fontSize:this._itemSize,color:$d}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},$c.onlistItemMouse=function($c,$d){var $e=$c.type;if("mouseover"===$e||"mouseout"===$e){if(this._isCustomList)return;var $f=this._list.getCell($d);if(!$f)return;var $g=$f.getChildByName("label");$g&&("mouseover"===$e?($g.bgColor=this._itemColors[0],$g.color=this._itemColors[1]):($g.bgColor=null,$g.color=this._itemColors[2]))}else"click"===$e&&(this.selectedIndex=$d,this.isOpen=!1)},$c.switchTo=function($c){this.isOpen=$c},$c.changeOpen=function(){this.isOpen=!this._isOpen},$c.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var $c=this._list.graphics;$c.clear(),$c.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var $d=this._list.array||[],$e=$d.length=0,$f=this._labels.length;$e<$f;$e++)$d.push({label:this._labels[$e]});this._list.height=this._listHeight,this._list.array=$d},$c.changeSelected=function(){this._button.label=this.selectedLabel},$c._onStageMouseWheel=function($c){this._list&&!this._list.contains($c.target)&&this.removeList(null)},$c.removeList=function($c){$r.stage.off("mousedown",this,this.removeList),$r.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},$g(0,$c,"selectedIndex",function(){return this._selectedIndex},function($c){this._selectedIndex!=$c&&(this._selectedIndex=$c,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[$k.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),$g(0,$c,"measureHeight",function(){return this._button.height}),$g(0,$c,"skin",function(){return this._button.skin},function($c){this._button.skin!=$c&&(this._button.skin=$c,this._listChanged=!0)}),$g(0,$c,"measureWidth",function(){return this._button.width}),$g(0,$c,"width",$d.prototype._$get_width,function($c){$r.superSet($H,this,"width",$c),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),$g(0,$c,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function($c){this.selectedIndex=this._labels.indexOf($c)}),$g(0,$c,"labels",function(){return this._labels.join(",")},function($c){0<this._labels.length&&(this.selectedIndex=-1),$c?this._labels=$c.split(","):this._labels.length=0,this._itemChanged=!0}),$g(0,$c,"height",$d.prototype._$get_height,function($c){$r.superSet($H,this,"height",$c),this._button.height=this._height}),$g(0,$c,"selectHandler",function(){return this._selectHandler},function($c){this._selectHandler=$c}),$g(0,$c,"visibleNum",function(){return this._visibleNum},function($c){this._visibleNum=$c,this._listChanged=!0}),$g(0,$c,"labelBold",function(){return this._button.text.bold},function($c){this._button.text.bold=$c}),$g(0,$c,"itemColors",function(){return String(this._itemColors)},function($c){this._itemColors=$E.fillArray(this._itemColors,$c,String),this._listChanged=!0}),$g(0,$c,"itemSize",function(){return this._itemSize},function($c){this._itemSize=$c,this._listChanged=!0}),$g(0,$c,"scrollBar",function(){return this.list.scrollBar}),$g(0,$c,"isOpen",function(){return this._isOpen},function($c){if(this._isOpen!=$c)if(this._isOpen=$c,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var $d=this.localToGlobal($q.TEMP.setTo(0,0)),$e=$d.y+this._button.height;$e=$e+this._listHeight<=$r.stage.height?$e:$d.y-this._listHeight,this._list.pos($d.x,$e),this._list.zOrder=1001,$r._currentStage.addChild(this._list),$r.stage.once("mousedown",this,this.removeList),$r.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),$g(0,$c,"scrollBarSkin",function(){return this._scrollBarSkin},function($c){this._scrollBarSkin=$c}),$g(0,$c,"sizeGrid",function(){return this._button.sizeGrid},function($c){this._button.sizeGrid=$c}),$g(0,$c,"button",function(){return this._button}),$g(0,$c,"list",function(){return this._list||this._createList(),this._list},function($c){$c&&($c.removeSelf(),this._isCustomList=!0,this._list=$c,this._setListEvent($c),this._itemHeight=$c.getCell(0).height+$c.spaceY)}),$g(0,$c,"dataSource",$d.prototype._$get_dataSource,function($c){"number"==typeof(this._dataSource=$c)&&Math.floor($c)==$c||"string"==typeof $c?this.selectedIndex=parseInt($c):$c instanceof Array?this.labels=$c.join(","):$r.superSet($H,this,"dataSource",$c)}),$g(0,$c,"labelColors",function(){return this._button.labelColors},function($c){this._button.labelColors!=$c&&(this._button.labelColors=$c)}),$g(0,$c,"labelPadding",function(){return this._button.text.padding.join(",")},function($c){this._button.text.padding=$E.fillArray($D.labelPadding,$c,Number)}),$g(0,$c,"labelSize",function(){return this._button.text.fontSize},function($c){this._button.text.fontSize=$c}),$g(0,$c,"labelFont",function(){return this._button.text.font},function($c){this._button.text.font=$c}),$g(0,$c,"stateNum",function(){return this._button.stateNum},function($c){this._button.stateNum=$c}),$e}($H),$O=function($d){function $e($c){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,$e.__super.call(this),this._showButtons=$F.showButtons,this._touchScrollEnable=$F.touchScrollEnable,this._mouseWheelEnable=$F.mouseWheelEnable,this.skin=$c,this.max=1}$h($e,"laya.ui.ScrollBar",$d);var $c=$e.prototype;return $c.destroy=function($c){void 0===$c&&($c=!0),this.stopScroll(),this.target=null,$d.prototype.destroy.call(this,$c),this.upButton&&this.upButton.destroy($c),this.downButton&&this.downButton.destroy($c),this.slider&&this.slider.destroy($c),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},$c.createChildren=function(){this.addChild(this.slider=new $P),this.addChild(this.upButton=new $K),this.addChild(this.downButton=new $K)},$c.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},$c.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},$c.onButtonMouseDown=function($c){var $d=$c.currentTarget===this.upButton;this.slide($d),$r.timer.once($D.scrollBarDelayTime,this,this.startLoop,[$d]),$r.stage.once("mouseup",this,this.onStageMouseUp)},$c.startLoop=function($c){$r.timer.frameLoop(1,this,this.slide,[$c])},$c.slide=function($c){$c?this.value-=this._scrollSize:this.value+=this._scrollSize},$c.onStageMouseUp=function($c){$r.timer.clear(this,this.startLoop),$r.timer.clear(this,this.slide)},$c.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},$c.changeSize=function(){$d.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},$c.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},$c.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},$c.setScroll=function($c,$d,$e){this.runCallLater(this.changeSize),this.slider.setSlider($c,$d,$e),this.slider.bar.visible=0<$d,!this._hide&&this.autoHide&&(this.visible=!1)},$c.onTargetMouseWheel=function($c){this.value-=$c.delta*this._scrollSize,this.target=this._target},$c.onTargetMouseDown=function($c){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $q),this._lastPoint.setTo($r.stage.mouseX,$r.stage.mouseY),$r.timer.clear(this,this.tweenMove),$z.clearTween(this),$r.stage.once("mouseup",this,this.onStageMouseUp2),$r.stage.once("mouseout",this,this.onStageMouseUp2),$r.timer.frameLoop(1,this,this.loop)},$c.loop=function(){var $c=$r.stage.mouseY,$d=$r.stage.mouseX;if(this._lastOffset=this.isVertical?$c-this._lastPoint.y:$d-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?$r.stage._canvasTransform.getScaleY():$r.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=$d,this._lastPoint.y=$c,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},$c.onStageMouseUp2=function($c){if($r.stage.off("mouseup",this,this.onStageMouseUp2),$r.stage.off("mouseout",this,this.onStageMouseUp2),$r.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?$z.to(this,{value:this.min},this.elasticBackTime,$j.sineOut,$o.create(this,this.elasticOver)):this._value>this.max&&$z.to(this,{value:this.max},this.elasticBackTime,$j.sineOut,$o.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?$r.stage.mouseY-this._lastPoint.y:$r.stage.mouseX-this._lastPoint.x);for(var $d=0,$e=Math.min(this._offsets.length,3),$f=0;$f<$e;$f++)$d+=this._offsets[this._offsets.length-1-$f];if(this._lastOffset=$d/$e,($d=Math.abs(this._lastOffset))<2)return void this.event("end");60<$d&&(this._lastOffset=0<this._lastOffset?60:-60);var $g=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));$r.timer.frameLoop(1,this,this.tweenMove,[$g])}},$c.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&$z.to(this,{alpha:0},500),this.event("end")},$c.tweenMove=function($c){this._lastOffset*=this.rollRatio;var $d=NaN;if(0<$c&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,$d=.5*-(this.min-$c-this.value),this._lastOffset>$d&&(this._lastOffset=$d)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,$d=.5*-(this.max+$c-this.value),this._lastOffset<$d&&(this._lastOffset=$d))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if($r.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?$z.to(this,{value:this.min},this.elasticBackTime,$j.sineOut,$o.create(this,this.elasticOver)):this._value>this.max?$z.to(this,{value:this.max},this.elasticBackTime,$j.sineOut,$o.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&$z.to(this,{alpha:0},500)}},$c.stopScroll=function(){this.onStageMouseUp2(null),$r.timer.clear(this,this.tweenMove),$z.clearTween(this)},$g(0,$c,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),$g(0,$c,"skin",function(){return this._skin},function($c){this._skin!=$c&&(this._skin=$c,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),$g(0,$c,"max",function(){return this.slider.max},function($c){this.slider.max=$c}),$g(0,$c,"showButtons",function(){return this._showButtons},function($c){this._showButtons=$c,this.callLater(this.changeScrollBar)}),$g(0,$c,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),$g(0,$c,"min",function(){return this.slider.min},function($c){this.slider.min=$c}),$g(0,$c,"value",function(){return this._value},function($c){$c!==this._value&&(this._value=$c,this._isElastic||(this.slider._value!=$c&&(this.slider._value=$c,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),$g(0,$c,"isVertical",function(){return this.slider.isVertical},function($c){this.slider.isVertical=$c}),$g(0,$c,"sizeGrid",function(){return this.slider.sizeGrid},function($c){this.slider.sizeGrid=$c}),$g(0,$c,"scrollSize",function(){return this._scrollSize},function($c){this._scrollSize=$c}),$g(0,$c,"dataSource",$d.prototype._$get_dataSource,function($c){"number"==typeof(this._dataSource=$c)||"string"==typeof $c?this.value=Number($c):$r.superSet($H,this,"dataSource",$c)}),$g(0,$c,"thumbPercent",function(){return this._thumbPercent},function($c){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),$c=1<=$c?.99:$c,this._thumbPercent=$c,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*$c,$D.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*$c,$D.scrollBarMinNum))}),$g(0,$c,"target",function(){return this._target},function($c){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=$c)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),$g(0,$c,"hide",function(){return this._hide},function($c){this._hide=$c,this.visible=!$c}),$g(0,$c,"touchScrollEnable",function(){return this._touchScrollEnable},function($c){this._touchScrollEnable=$c,this.target=this._target}),$g(0,$c,"mouseWheelEnable",function(){return this._mouseWheelEnable},function($c){this._mouseWheelEnable=$c,this.target=this._target}),$g(0,$c,"tick",function(){return this.slider.tick},function($c){this.slider.tick=$c}),$e}($H),$P=function($d){function $e($c){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,$e.__super.call(this),this.skin=$c}$h($e,"laya.ui.Slider",$d);var $c=$e.prototype;return $c.destroy=function($c){void 0===$c&&($c=!0),$d.prototype.destroy.call(this,$c),this._bg&&this._bg.destroy($c),this._bar&&this._bar.destroy($c),this._progress&&this._progress.destroy($c),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},$c.createChildren=function(){this.addChild(this._bg=new $Q),this.addChild(this._bar=new $K)},$c.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},$c.onBarMouseDown=function($c){this._globalSacle||(this._globalSacle=new $q),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=$r.stage.mouseX,this._ty=$r.stage.mouseY,$r.stage.on("mousemove",this,this.mouseMove),$r.stage.once("mouseup",this,this.mouseUp),$r.stage.once("mouseout",this,this.mouseUp),this.showValueText()},$c.showValueText=function(){if(this.showLabel){var $c=laya.ui.Slider.label;this.addChild($c),$c.textField.changeText(this._value+""),this.isVertical?($c.x=this._bar.x+20,$c.y=.5*(this._bar.height-$c.height)+this._bar.y):($c.y=this._bar.y-20,$c.x=.5*(this._bar.width-$c.width)+this._bar.x)}},$c.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},$c.mouseUp=function($c){$r.stage.off("mousemove",this,this.mouseMove),$r.stage.off("mouseup",this,this.mouseUp),$r.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},$c.mouseMove=function($c){var $d=this._value;this.isVertical?(this._bar.y+=($r.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=($r.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=$r.stage.mouseX,this._ty=$r.stage.mouseY;var $e=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$e)/$e,this._value!=$d&&this.sendChangeEvent(),this.showValueText()},$c.sendChangeEvent=function($c){void 0===$c&&($c="change"),this.event($c),this.changeHandler&&this.changeHandler.runWith(this._value)},$c.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},$c.changeSize=function(){$d.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},$c.setSlider=function($c,$d,$e){this._value=-1,this._min=$c,this._max=$c<$d?$d:$c,this.value=$e<$c?$c:$d<$e?$d:$e},$c.changeValue=function(){var $c=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$c)/$c,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var $d=this._max-this._min;0===$d&&($d=1),this.isVertical?(this._bar.y=(this._value-this._min)/$d*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/$d*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},$c.onBgMouseDown=function($c){var $d=this._bg.getMousePoint();this.isVertical?this.value=$d.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=$d.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},$g(0,$c,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),$g(0,$c,"skin",function(){return this._skin},function($c){if(this._skin!=$c){this._skin=$c,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var $d=this._skin.replace(".png","$progress.png");$u.getRes($d)&&(this._progress||(this.addChild(this._progress=new $Q),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=$d),this.setBarPoint(),this.callLater(this.changeValue)}}),$g(0,$c,"allowClickBack",function(){return this._allowClickBack},function($c){this._allowClickBack!=$c&&((this._allowClickBack=$c)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),$g(0,$c,"max",function(){return this._max},function($c){this._max!=$c&&(this._max=$c,this.callLater(this.changeValue))}),$g(0,$c,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),$g(0,$c,"tick",function(){return this._tick},function($c){this._tick!=$c&&(this._tick=$c,this.callLater(this.changeValue))}),$g(0,$c,"sizeGrid",function(){return this._bg.sizeGrid},function($c){this._bg.sizeGrid=$c,this._bar.sizeGrid=$c,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),$g(0,$c,"min",function(){return this._min},function($c){this._min!=$c&&(this._min=$c,this.callLater(this.changeValue))}),$g(0,$c,"value",function(){return this._value},function($c){if(this._value!=$c){var $d=this._value;this._value=$c,this.changeValue(),this._value!=$d&&this.sendChangeEvent()}}),$g(0,$c,"dataSource",$d.prototype._$get_dataSource,function($c){"number"==typeof(this._dataSource=$c)||"string"==typeof $c?this.value=Number($c):$r.superSet($H,this,"dataSource",$c)}),$g(0,$c,"bar",function(){return this._bar}),$f($e,["label",function(){return this.label=new $R}]),$e}($H),$Q=function($d){function $e($c){this._bitmap=null,this._skin=null,this._group=null,$e.__super.call(this),this.skin=$c}$h($e,"laya.ui.Image",$d);var $c=$e.prototype;return $c.destroy=function($c){void 0===$c&&($c=!0),$d.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,$u.clearCache(this,this._skin)},$c.dispose=function(){this.destroy(!0),$u.clearCache(this,this._skin)},$c.createChildren=function(){this.graphics=this._bitmap=new $G},$c.setSource=function($c,$d){$c===this._skin&&$d&&(this.source=$d,this.onCompResize())},$g(0,$c,"source",function(){return this._bitmap.source},function($c){this._bitmap&&(this._bitmap.source=$c,this.event("loaded"),this.repaint())}),$g(0,$c,"dataSource",$d.prototype._$get_dataSource,function($c){"string"==typeof(this._dataSource=$c)?this.skin=$c:$r.superSet($H,this,"dataSource",$c)}),$g(0,$c,"measureHeight",function(){return this._bitmap.height}),$g(0,$c,"skin",function(){return this._skin},function($c){if(this._skin!=$c)if($u.clearCache(this,this._skin),this._skin=$c){$u.keepCache(this,this._skin);var $d=$u.getRes($c);$d?(this.source=$d,this.onCompResize()):$r.loader.load(this._skin,$o.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),$g(0,$c,"group",function(){return this._group},function($c){$c&&this._skin&&$u.setGroup(this._skin,$c),this._group=$c}),$g(0,$c,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($c){this._bitmap.sizeGrid=$E.fillArray($D.defaultSizeGrid,$c,Number)}),$g(0,$c,"measureWidth",function(){return this._bitmap.width}),$g(0,$c,"width",$d.prototype._$get_width,function($c){$r.superSet($H,this,"width",$c),this._bitmap.width=0==$c?1e-7:$c}),$g(0,$c,"height",$d.prototype._$get_height,function($c){$r.superSet($H,this,"height",$c),this._bitmap.height=0==$c?1e-7:$c}),$e}($H),$R=function($d){function $e($c){this._tf=null,$e.__super.call(this),void 0===$c&&($c=""),$l.defaultColor=$D.labelColor,this.text=$c}$h($e,"laya.ui.Label",$d);var $c=$e.prototype;return $c.destroy=function($c){void 0===$c&&($c=!0),$d.prototype.destroy.call(this,$c),this._tf=null},$c.createChildren=function(){this.addChild(this._tf=new $x)},$c.changeText=function($c){this._tf.changeText($c)},$g(0,$c,"padding",function(){return this._tf.padding.join(",")},function($c){this._tf.padding=$E.fillArray($D.labelPadding,$c,Number)}),$g(0,$c,"bold",function(){return this._tf.bold},function($c){this._tf.bold=$c}),$g(0,$c,"align",function(){return this._tf.align},function($c){this._tf.align=$c}),$g(0,$c,"text",function(){return this._tf.text},function($c){this._tf.text!=$c&&($c&&($c=$E.adptString($c+"")),this._tf.text=$c,this.event("change"),this._width&&this._height||this.onCompResize())}),$g(0,$c,"italic",function(){return this._tf.italic},function($c){this._tf.italic=$c}),$g(0,$c,"wordWrap",function(){return this._tf.wordWrap},function($c){this._tf.wordWrap=$c}),$g(0,$c,"font",function(){return this._tf.font},function($c){this._tf.font=$c}),$g(0,$c,"dataSource",$d.prototype._$get_dataSource,function($c){"number"==typeof(this._dataSource=$c)||"string"==typeof $c?this.text=$c+"":$r.superSet($H,this,"dataSource",$c)}),$g(0,$c,"color",function(){return this._tf.color},function($c){this._tf.color=$c}),$g(0,$c,"valign",function(){return this._tf.valign},function($c){this._tf.valign=$c}),$g(0,$c,"leading",function(){return this._tf.leading},function($c){this._tf.leading=$c}),$g(0,$c,"fontSize",function(){return this._tf.fontSize},function($c){this._tf.fontSize=$c}),$g(0,$c,"bgColor",function(){return this._tf.bgColor},function($c){this._tf.bgColor=$c}),$g(0,$c,"borderColor",function(){return this._tf.borderColor},function($c){this._tf.borderColor=$c}),$g(0,$c,"stroke",function(){return this._tf.stroke},function($c){this._tf.stroke=$c}),$g(0,$c,"strokeColor",function(){return this._tf.strokeColor},function($c){this._tf.strokeColor=$c}),$g(0,$c,"textField",function(){return this._tf}),$g(0,$c,"measureWidth",function(){return this._tf.width}),$g(0,$c,"measureHeight",function(){return this._tf.height}),$g(0,$c,"width",function(){return this._width||this._tf.text?$r.superGet($H,this,"width"):0},function($c){$r.superSet($H,this,"width",$c),this._tf.width=$c}),$g(0,$c,"height",function(){return this._height||this._tf.text?$r.superGet($H,this,"height"):0},function($c){$r.superSet($H,this,"height",$c),this._tf.height=$c}),$g(0,$c,"overflow",function(){return this._tf.overflow},function($c){this._tf.overflow=$c}),$g(0,$c,"underline",function(){return this._tf.underline},function($c){this._tf.underline=$c}),$g(0,$c,"underlineColor",function(){return this._tf.underlineColor},function($c){this._tf.underlineColor=$c}),$e}($H),$S=function($d){function $e($c){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,$e.__super.call(this),this.skin=$c}$h($e,"laya.ui.ProgressBar",$d);var $c=$e.prototype;return $c.destroy=function($c){void 0===$c&&($c=!0),$d.prototype.destroy.call(this,$c),this._bg&&this._bg.destroy($c),this._bar&&this._bar.destroy($c),this._bg=this._bar=null,this.changeHandler=null},$c.createChildren=function(){this.addChild(this._bg=new $Q),this.addChild(this._bar=new $Q)},$c.changeValue=function(){if(this.sizeGrid){var $c=this.sizeGrid.split(","),$d=Number($c[3]),$e=Number($c[1]),$f=(this.width-$d-$e)*this._value;this._bar.width=$d+$e+$f,this._bar.visible=this._bar.width>$d+$e}else this._bar.width=this.width*this._value},$g(0,$c,"measureHeight",function(){return this._bg.height}),$g(0,$c,"skin",function(){return this._skin},function($c){this._skin!=$c&&(this._skin=$c,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),$g(0,$c,"measureWidth",function(){return this._bg.width}),$g(0,$c,"height",$d.prototype._$get_height,function($c){$r.superSet($H,this,"height",$c),this._bg.height=this._height,this._bar.height=this._height}),$g(0,$c,"bar",function(){return this._bar}),$g(0,$c,"value",function(){return this._value},function($c){this._value!=$c&&($c=1<$c?1:$c<0?0:$c,this._value=$c,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith($c))}),$g(0,$c,"bg",function(){return this._bg}),$g(0,$c,"sizeGrid",function(){return this._bg.sizeGrid},function($c){this._bg.sizeGrid=this._bar.sizeGrid=$c}),$g(0,$c,"width",$d.prototype._$get_width,function($c){$r.superSet($H,this,"width",$c),this._bg.width=this._width,this.callLater(this.changeValue)}),$g(0,$c,"dataSource",$d.prototype._$get_dataSource,function($c){"number"==typeof(this._dataSource=$c)||"string"==typeof $c?this.value=Number($c):$r.superSet($H,this,"dataSource",$c)}),$e}($H),$T=(function($c){function $e(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,$e.__super.call(this),this._tipBox=new $H,this._tipBox.addChild(this._tipText=new $x),this._tipText.x=this._tipText.y=5,this._tipText.color=$e.tipTextColor,this._defaultTipHandler=this._showDefaultTip,$r.stage.on("showtip",this,this._onStageShowTip),$r.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}$h($e,"laya.ui.TipManager",$H);var $d=$e.prototype;$d._onStageHideTip=function($c){$r.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},$d._onStageShowTip=function($c){$r.timer.once($e.tipDelay,this,this._showTip,[$c],!0)},$d._showTip=function($c){if("string"==typeof $c){var $d=String($c);Boolean($d)&&this._defaultTipHandler($d)}else $c instanceof laya.utils.Handler?$c.run():"function"==typeof $c&&$c.apply();$r.stage.on("mousemove",this,this._onStageMouseMove),$r.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},$d._onStageMouseDown=function($c){this.closeAll()},$d._onStageMouseMove=function($c){this._showToStage(this,$e.offsetX,$e.offsetY)},$d._showToStage=function($c,$d,$e){void 0===$d&&($d=0),void 0===$e&&($e=0);var $f=$c.getBounds();$c.x=$r.stage.mouseX+$d,$c.y=$r.stage.mouseY+$e,$c.x+$f.width>$r.stage.width&&($c.x-=$f.width+$d),$c.y+$f.height>$r.stage.height&&($c.y-=$f.height+$e)},$d.closeAll=function(){$r.timer.clear(this,this._showTip),$r.stage.off("mousemove",this,this._onStageMouseMove),$r.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},$d.showDislayTip=function($c){this.addChild($c),this._showToStage(this),$r._currentStage.addChild(this)},$d._showDefaultTip=function($c){this._tipText.text=$c;var $d=this._tipBox.graphics;$d.clear(),$d.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,$e.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),$r._currentStage.addChild(this)},$g(0,$d,"defaultTipHandler",function(){return this._defaultTipHandler},function($c){this._defaultTipHandler=$c}),$e.offsetX=10,$e.offsetY=15,$e.tipTextColor="#ffffff",$e.tipBackColor="#111111",$e.tipDelay=200}(),function($c){var $p;function $q(){this._idMap=null,this._aniList=null,this._watchMap={},$q.__super.call(this)}$h($q,"laya.ui.View",$J);var $d=$q.prototype;return $d.createView=function($c){if($c.animations&&!this._idMap&&(this._idMap={}),$q.createComp($c,this,this),$c.animations){var $d,$e,$f=[],$g=$c.animations,$h=0,$i=$g.length;for($h=0;$h<$i;$h++){switch($d=new $m,$e=$g[$h],$d._setUp(this._idMap,$e),(this[$e.name]=$d)._setControlNode(this),$e.action){case 1:$d.play(0,!1);break;case 2:$d.play(0,!0)}$f.push($d)}this._aniList=$f}0<this._width&&null==$c.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},$d.onEvent=function($c,$d){},$d.loadUI=function($c){var $d=$q.uiMap[$c];$d&&this.createView($d)},$d.destroy=function($c){void 0===$c&&($c=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,$c)},$d.changeData=function($c){var $d=this._watchMap[$c];if($d){console.log("change",$c);for(var $e=0,$f=$d.length;$e<$f;$e++){$d[$e].exe(this)}}},$q._regs=function(){for(var $c in $q.uiClassMap)$s.regClass($c,$q.uiClassMap[$c])},$q.createComp=function($c,$d,$e,$f){if(!($d=$d||$q.getCompInstance($c)))return console.warn("can not create:"+$c.type),null;var $g=$c.child;if($g)for(var $h=$d instanceof laya.ui.List,$i=0,$j=$g.length;$i<$j;$i++){var $k=$g[$i];if(!$d.hasOwnProperty("itemRender")||"render"!=$k.props.name&&"render"!==$k.props.renderType)if("Graphic"==$k.type)$s.addGraphicsToSprite($k,$d);else if($s.isDrawType($k.type))$s.addGraphicToSprite($k,$d,!0);else{if($h){var $l=[],$m=$q.createComp($k,null,$e,$l);$l.length&&($m._$bindData=$l)}else $m=$q.createComp($k,null,$e,$f);"Script"==$k.type?"owner"in $m?$m.owner=$d:"target"in $m&&($m.target=$d):"mask"==$k.props.renderType||"mask"==$k.props.name?$d.mask=$m:$m instanceof laya.display.Sprite&&$d.addChild($m)}else $d.itemRender=$k}var $n=$c.props;for(var $o in $n){var $p=$n[$o];$q.eventDic[$o]?$p&&$e&&$d.on($o,$e,$e.onEvent,[$p]):$q.setCompValue($d,$o,$p,$e,$f)}return $r.__typeof($d,"laya.ui.IItem")&&$d.initItems(),$c.compId&&$e&&$e._idMap&&($e._idMap[$c.compId]=$d),$d},$q.setCompValue=function($c,$d,$e,$f,$g){if("string"==typeof $e&&-1<$e.indexOf("${")){if($q._sheet||($q._sheet=$s.getClass("laya.data.Table")),!$q._sheet)return void console.warn("Can not find class Sheet");if($g)$g.push($c,$d,$e);else if($f){-1==$e.indexOf("].")&&($e=$e.replace(".","[0]."));var $h,$i,$j=new $p($c,$d,$e);$j.exe($f);for(var $k=$e.replace(/\[.*?\]\./g,".");null!=($h=$q._parseWatchData.exec($k));){for(var $l=$h[1];null!=($i=$q._parseKeyWord.exec($l));){var $m=$i[0],$n=$f._watchMap[$m]||($f._watchMap[$m]=[]);$n.push($j),$q._sheet.I.notifer.on($m,$f,$f.changeData,[$m])}($n=$f._watchMap[$l]||($f._watchMap[$l]=[])).push($j),$q._sheet.I.notifer.on($l,$f,$f.changeData,[$l])}}}else if("var"===$d&&$f)$f[$e]=$c;else if("onClick"==$d){var $o=$r._runScript("(function(){"+$e+"})");$c.on("click",$f,$o)}else $c[$d]="true"===$e||"false"!==$e&&$e},$q.getCompInstance=function($c){var $d,$e=$c.props?$c.props.runtime:null;return $d=$e?$q.viewClassMap[$e]||$q.uiClassMap[$e]||$r.__classmap[$e]:$q.uiClassMap[$c.type],$c.props&&$c.props.hasOwnProperty("renderType")&&"instance"==$c.props.renderType?$d.instance:$d?new $d:null},$q.regComponent=function($c,$d){$q.uiClassMap[$c]=$d,$s.regClass($c,$d)},$q.regViewRuntime=function($c,$d){$q.viewClassMap[$c]=$d},$q.uiMap={},$q.viewClassMap={},$q._sheet=null,$f($q,["uiClassMap",function(){return this.uiClassMap={ViewStack:$cc,LinkButton:$K,TextArea:$lc,ColorPicker:$M,Box:$J,Button:$K,CheckBox:$U,Clip:$L,ComboBox:$N,Component:$H,HScrollBar:$Y,HSlider:$$,Image:$Q,Label:$R,List:$X,Panel:$Z,ProgressBar:$S,Radio:$a,RadioGroup:$jc,ScrollBar:$O,Slider:$P,Tab:$kc,TextInput:$ec,View:$q,VScrollBar:$dc,VSlider:$fc,Tree:$b,HBox:$hc,VBox:$ic,Sprite:$w,Animation:$e,Text:$x,FontClip:$W}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),$q.__init$=function(){$q._regs(),$p=function(){function $c($c,$d,$e){this.comp=null,this.prop=null,this.value=null,this.comp=$c,this.prop=$d,this.value=$e}return $h($c,""),$c.prototype.exe=function($c){var $d=$E.getBindFun(this.value);this.comp[this.prop]=$d.call(this,$c)},$c}()},$q}()),$U=function($c){function $e($c,$d){void 0===$d&&($d=""),$e.__super.call(this,$c,$d)}$h($e,"laya.ui.CheckBox",$c);var $d=$e.prototype;return $d.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},$d.initialize=function(){$c.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},$g(0,$d,"dataSource",$c.prototype._$get_dataSource,function($c){"boolean"==typeof(this._dataSource=$c)?this.selected=$c:"string"==typeof $c?this.selected="true"===$c:$r.superSet($K,this,"dataSource",$c)}),$e}($K),$V=function($c){function $d(){this._space=0,this._align="none",this._itemChanged=!1,$d.__super.call(this)}$h($d,"laya.ui.LayoutBox",$J);var $e=$d.prototype;return $e.addChild=function($c){return $c.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,$c)},$e.onResize=function($c){this._setItemChanged()},$e.addChildAt=function($c,$d){return $c.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,$c,$d)},$e.removeChild=function($c){return $c.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,$c)},$e.removeChildAt=function($c){return this.getChildAt($c).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,$c)},$e.refresh=function(){this._setItemChanged()},$e.changeItems=function(){this._itemChanged=!1},$e.sortItem=function($c){$c&&$c.sort(function($c,$d){return $c.y-$d.y})},$e._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},$g(0,$e,"space",function(){return this._space},function($c){this._space=$c,this._setItemChanged()}),$g(0,$e,"align",function(){return this._align},function($c){this._align=$c,this._setItemChanged()}),$d}(),$W=function($d){function $e($c,$d){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,$e.__super.call(this),$c&&(this.skin=$c),$d&&(this.sheet=$d)}$h($e,"laya.ui.FontClip",$d);var $c=$e.prototype;return $c.createChildren=function(){this._bitmap=new $G,this.on("loaded",this,this._onClipLoaded)},$c._onClipLoaded=function(){this.callLater(this.changeValue)},$c.changeValue=function(){var $c;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),$c=this._sources[0]))){var $d="horizontal"===this._direction;$d?(this._wordsW=this._valueArr.length*($c.sourceWidth+this.spaceX),this._wordsH=$c.sourceHeight):(this._wordsW=$c.sourceWidth,this._wordsH=($c.sourceHeight+this.spaceY)*this._valueArr.length);var $e=0;if(this._width)switch(this._align){case"center":$e=.5*(this._width-this._wordsW);break;case"right":$e=this._width-this._wordsW;break;default:$e=0}for(var $f=0,$g=this._valueArr.length;$f<$g;$f++){var $h=this._indexMap[this._valueArr.charAt($f)];this.sources[$h]&&($c=this.sources[$h],$d?this.graphics.drawTexture($c,$e+$f*($c.sourceWidth+this.spaceX),0,$c.sourceWidth,$c.sourceHeight):this.graphics.drawTexture($c,0+$e,$f*($c.sourceHeight+this.spaceY),$c.sourceWidth,$c.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},$c.destroy=function($c){void 0===$c&&($c=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),$d.prototype.destroy.call(this,$c)},$g(0,$c,"sheet",function(){return this._sheet},function($c){$c+="";var $d=(this._sheet=$c).split(" ");this._clipX=String($d[0]).length,this.clipY=$d.length,this._indexMap={};for(var $e=0;$e<this._clipY;$e++)for(var $f=$d[$e].split(""),$g=0,$h=$f.length;$g<$h;$g++)this._indexMap[$f[$g]]=$e*this._clipX+$g}),$g(0,$c,"height",$d.prototype._$get_height,function($c){$r.superSet($L,this,"height",$c),this.callLater(this.changeValue)}),$g(0,$c,"direction",function(){return this._direction},function($c){this._direction=$c,this.callLater(this.changeValue)}),$g(0,$c,"value",function(){return this._valueArr?this._valueArr:""},function($c){$c+="",this._valueArr=$c,this.callLater(this.changeValue)}),$g(0,$c,"width",$d.prototype._$get_width,function($c){$r.superSet($L,this,"width",$c),this.callLater(this.changeValue)}),$g(0,$c,"spaceX",function(){return this._spaceX},function($c){this._spaceX=$c,"horizontal"===this._direction&&this.callLater(this.changeValue)}),$g(0,$c,"spaceY",function(){return this._spaceY},function($c){this._spaceY=$c,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),$g(0,$c,"align",function(){return this._align},function($c){this._align=$c,this.callLater(this.changeValue)}),$g(0,$c,"measureWidth",function(){return this._wordsW}),$g(0,$c,"measureHeight",function(){return this._wordsH}),$e}($L),$X=function($c){function $d(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new $q,$d.__super.call(this)}$h($d,"laya.ui.List",$c);var $e=$d.prototype;return $r.imps($e,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),$e.destroy=function($c){void 0===$c&&($c=!0),this._content&&this._content.destroy($c),this._scrollBar&&this._scrollBar.destroy($c),laya.ui.Component.prototype.destroy.call(this,$c),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},$e.createChildren=function(){this.addChild(this._content=new $J)},$e.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$r.superGet($J,this,"cacheAs")),$r.superSet($J,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},$e.onScrollEnd=function(){$r.superSet($J,this,"cacheAs",this._$P.cacheAs)},$e._removePreScrollBar=function(){var $c=this.removeChildByName("scrollBar");$c&&$c.destroy(!0)},$e.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var $c=this._getOneCell(),$d=$c.width+this._spaceX||1,$e=$c.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/$d):Math.ceil(this._width/$d)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/$e):Math.round(this._height/$e));var $f=this._width?this._width:$d*this.repeatX-this._spaceX,$g=this._height?this._height:$e*this.repeatY-this._spaceY;this._cellSize=this._isVertical?$e:$d,this._cellOffset=this._isVertical?$e*Math.max(this._repeatY2,this._repeatY)-$g-this._spaceY:$d*Math.max(this._repeatX2,this._repeatX)-$f-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=$g:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=$f),this.setContentSize($f,$g);var $h=this._isVertical?this.repeatX:this.repeatY,$i=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,$h,$i),this._createdLine=$i,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},$e._getOneCell=function(){if(0===this._cells.length){var $c=this.createItem();if(this._offset.setTo($c.x,$c.y),this.cacheContent)return $c;this._cells.push($c)}return this._cells[0]},$e._createItems=function($c,$d,$e){var $f=this._content,$g=this._getOneCell(),$h=$g.width+this._spaceX,$i=$g.height+this._spaceY;if(this.cacheContent){var $j=new $J;$j.cacheAsBitmap=!0,$j.pos((this._isVertical?0:$c)*$h,(this._isVertical?$c:0)*$i),this._content.addChild($j),this._content.optimizeScrollRect=!0,$f=$j}else{for(var $k=[],$l=this._cells.length-1;-1<$l;$l--){var $m=this._cells[$l];$m.removeSelf(),$k.push($m)}this._cells.length=0}for(var $n=$c;$n<$e;$n++)for(var $o=0;$o<$d;$o++)($g=$k&&$k.length?$k.pop():this.createItem()).x=(this._isVertical?$o:$n)*$h-$f.x,$g.y=(this._isVertical?$n:$o)*$i-$f.y,$g.name="item"+($n*$d+$o),$f.addChild($g),this.addCell($g)},$e.createItem=function(){var $c=[];if("function"==typeof this._itemRender)var $d=new this._itemRender;else $d=$T.createComp(this._itemRender,null,null,$c);if(0==$c.length&&$d._watchMap){var $e=$d._watchMap;for(var $f in $e)for(var $g=$e[$f],$h=0;$h<$g.length;$h++){var $i=$g[$h];$c.push($i.comp,$i.prop,$i.value)}}return $c.length&&($d._$bindData=$c),$d},$e.addCell=function($c){$c.on("click",this,this.onCellMouse),$c.on("rightclick",this,this.onCellMouse),$c.on("mouseover",this,this.onCellMouse),$c.on("mouseout",this,this.onCellMouse),$c.on("mousedown",this,this.onCellMouse),$c.on("mouseup",this,this.onCellMouse),this._cells.push($c)},$e.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var $c=0,$d=$c=0;$d<1e4;$d++){var $e=this.getChildByName("item"+$d);if(!$e)break;this.addCell($e),$c++}this.repeatY=$c}},$e.setContentSize=function($c,$d){this._content.width=$c,this._content.height=$d,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new $t),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,$c,$d),this._content.scrollRect=this._content.scrollRect),this.event("resize")},$e.onCellMouse=function($c){"mousedown"===$c.type&&(this._isMoved=!1);var $d=$c.currentTarget,$e=this._startIndex+this._cells.indexOf($d);$e<0||("click"===$c.type||"rightclick"===$c.type?this.selectEnable&&!this._isMoved?this.selectedIndex=$e:this.changeCellState($d,!0,0):"mouseover"!==$c.type&&"mouseout"!==$c.type||this._selectedIndex===$e||this.changeCellState($d,"mouseover"===$c.type,0),this.mouseHandler&&this.mouseHandler.runWith([$c,$e]))},$e.changeCellState=function($c,$d,$e){var $f=$c.getChildByName("selectBox");$f&&(this.selectEnable=!0,$f.visible=$d,$f.index=$e)},$e.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},$e.onScrollBarChange=function($c){this.runCallLater(this.changeCells);var $d=this._scrollBar.value,$e=this._isVertical?this.repeatX:this.repeatY,$f=this._isVertical?this.repeatY:this.repeatX,$g=Math.floor($d/this._cellSize);if(this.cacheContent)$i=$f+1,this._createdLine-$g<$i&&(this._createItems(this._createdLine,$e,this._createdLine+$i),this.renderItems(this._createdLine*$e,0),this._createdLine+=$i);else{var $h=$g*$e,$i=0;if($h>this._startIndex){$i=$h-this._startIndex;var $j=!0,$k=this._startIndex+$e*($f+1);this._isMoved=!0}else $h<this._startIndex&&($i=this._startIndex-$h,$j=!1,$k=this._startIndex-1,this._isMoved=!0);for(var $l=0;$l<$i;$l++){if($j){var $m=this._cells.shift();this._cells[this._cells.length]=$m;var $n=$k+$l}else $m=this._cells.pop(),this._cells.unshift($m),$n=$k-$l;var $o=Math.floor($n/$e)*this._cellSize;this._isVertical?$m.y=$o:$m.x=$o,this.renderItem($m,$n)}this._startIndex=$h,this.changeSelectStatus()}var $p=this._content.scrollRect;this._isVertical?($p.y=$d-this._offset.y,$p.x=-this._offset.x):($p.y=-this._offset.y,$p.x=$d-this._offset.x),this._content.scrollRect=$p},$e.posCell=function($c,$d){if(this._scrollBar){var $e=this._isVertical?this.repeatX:this.repeatY,$f=(this._isVertical?this.repeatY:this.repeatX,Math.floor($d/$e)*this._cellSize);this._isVertical?$c.y=$f:$c.x=$f}},$e.changeSelectStatus=function(){for(var $c=0,$d=this._cells.length;$c<$d;$c++)this.changeCellState(this._cells[$c],this._selectedIndex===this._startIndex+$c,1)},$e.renderItems=function($c,$d){void 0===$c&&($c=0),void 0===$d&&($d=0);for(var $e=$c,$f=$d||this._cells.length;$e<$f;$e++)this.renderItem(this._cells[$e],this._startIndex+$e);this.changeSelectStatus()},$e.renderItem=function($c,$d){this._array&&0<=$d&&$d<this._array.length?($c.visible=!0,$c._$bindData?($c._dataSource=this._array[$d],this._bindData($c,this._array[$d])):$c.dataSource=this._array[$d],this.cacheContent||this.posCell($c,$d),this.hasListener("render")&&this.event("render",[$c,$d]),this.renderHandler&&this.renderHandler.runWith([$c,$d])):($c.visible=!1,$c.dataSource=null)},$e._bindData=function($c,$d){for(var $e=$c._$bindData,$f=0,$g=$e.length;$f<$g;$f++){var $h=$e[$f++],$i=$e[$f++],$j=$e[$f],$k=$E.getBindFun($j);$h[$i]=$k.call(this,$d)}},$e.refresh=function(){this.array=this._array},$e.getItem=function($c){return-1<$c&&$c<this._array.length?this._array[$c]:null},$e.changeItem=function($c,$d){-1<$c&&$c<this._array.length&&(this._array[$c]=$d,$c>=this._startIndex&&$c<this._startIndex+this._cells.length&&this.renderItem(this.getCell($c),$c))},$e.setItem=function($c,$d){this.changeItem($c,$d)},$e.addItem=function($c){this._array.push($c),this.array=this._array},$e.addItemAt=function($c,$d){this._array.splice($d,0,$c),this.array=this._array},$e.deleteItem=function($c){this._array.splice($c,1),this.array=this._array},$e.getCell=function($c){return this.runCallLater(this.changeCells),-1<$c&&this._cells?this._cells[($c-this._startIndex)%this._cells.length]:null},$e.scrollTo=function($c){if(this._scrollBar){var $d=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor($c/$d)*this._cellSize}else this.startIndex=$c},$e.tweenTo=function($c,$d,$e){if(void 0===$d&&($d=200),this._scrollBar){var $f=this._isVertical?this.repeatX:this.repeatY;$z.to(this._scrollBar,{value:Math.floor($c/$f)*this._cellSize},$d,null,$e,0,!0)}else this.startIndex=$c,$e&&$e.run()},$e._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},$e.commitMeasure=function(){this.runCallLater(this.changeCells)},$g(0,$e,"cacheAs",$c.prototype._$get_cacheAs,function($c){$r.superSet($J,this,"cacheAs",$c),this._scrollBar&&(this._$P.cacheAs=null,"none"!==$c?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),$g(0,$e,"content",function(){return this._content}),$g(0,$e,"height",$c.prototype._$get_height,function($c){$c!=this._height&&($r.superSet($J,this,"height",$c),this._setCellChanged())}),$g(0,$e,"itemRender",function(){return this._itemRender},function($c){if(this._itemRender!=$c){this._itemRender=$c;for(var $d=this._cells.length-1;-1<$d;$d--)this._cells[$d].destroy();this._cells.length=0,this._setCellChanged()}}),$g(0,$e,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($c){this._removePreScrollBar();var $d=new $dc;$d.name="scrollBar",$d.right=0,$c&&" "!=$c&&($d.skin=$c),this.scrollBar=$d,this.addChild($d),this._setCellChanged()}),$g(0,$e,"page",function(){return this._page},function($c){this._page=$c,this._array&&(this._page=0<$c?$c:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),$g(0,$e,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($c){this._removePreScrollBar();var $d=new $Y;$d.name="scrollBar",$d.bottom=0,$c&&" "!=$c&&($d.skin=$c),this.scrollBar=$d,this.addChild($d),this._setCellChanged()}),$g(0,$e,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function($c){this._repeatX=$c,this._setCellChanged()}),$g(0,$e,"scrollBar",function(){return this._scrollBar},function($c){this._scrollBar!=$c&&(this._scrollBar=$c)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),$g(0,$e,"width",$c.prototype._$get_width,function($c){$c!=this._width&&($r.superSet($J,this,"width",$c),this._setCellChanged())}),$g(0,$e,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function($c){this._repeatY=$c,this._setCellChanged()}),$g(0,$e,"spaceX",function(){return this._spaceX},function($c){this._spaceX=$c,this._setCellChanged()}),$g(0,$e,"spaceY",function(){return this._spaceY},function($c){this._spaceY=$c,this._setCellChanged()}),$g(0,$e,"selectedIndex",function(){return this._selectedIndex},function($c){this._selectedIndex!=$c&&(this._selectedIndex=$c,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith($c),this.startIndex=this._startIndex)}),$g(0,$e,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function($c){this.selectedIndex=this._array.indexOf($c)}),$g(0,$e,"length",function(){return this._array?this._array.length:0}),$g(0,$e,"selection",function(){return this.getCell(this._selectedIndex)},function($c){this.selectedIndex=this._startIndex+this._cells.indexOf($c)}),$g(0,$e,"startIndex",function(){return this._startIndex},function($c){this._startIndex=0<$c?$c:0,this.callLater(this.renderItems)}),$g(0,$e,"array",function(){return this._array},function($c){this.runCallLater(this.changeCells),this._array=$c||[];var $d=this._array.length;if(this.totalPage=Math.ceil($d/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<$d?this._selectedIndex:$d-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var $e=this._isVertical?this.repeatX:this.repeatY,$f=this._isVertical?this.repeatY:this.repeatX,$g=Math.ceil($d/$e);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=$f/$g,this._scrollBar.setScroll(0,($g-$f)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),$g(0,$e,"dataSource",$c.prototype._$get_dataSource,function($c){"number"==typeof(this._dataSource=$c)&&Math.floor($c)==$c||"string"==typeof $c?this.selectedIndex=parseInt($c):$c instanceof Array?this.array=$c:$r.superSet($J,this,"dataSource",$c)}),$g(0,$e,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),$d}($J),$Y=function($c){function $d(){$d.__super.call(this)}return $h($d,"laya.ui.HScrollBar",$c),$d.prototype.initialize=function(){$c.prototype.initialize.call(this),this.slider.isVertical=!1},$d}($O),$Z=function($c){function $d(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,$d.__super.call(this),this.width=this.height=100}$h($d,"laya.ui.Panel",$c);var $e=$d.prototype;return $e.destroy=function($c){void 0===$c&&($c=!0),laya.ui.Component.prototype.destroy.call(this,$c),this._content&&this._content.destroy($c),this._vScrollBar&&this._vScrollBar.destroy($c),this._hScrollBar&&this._hScrollBar.destroy($c),this._vScrollBar=null,this._hScrollBar=null,this._content=null},$e.destroyChildren=function(){this._content.destroyChildren()},$e.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new $J)},$e.addChild=function($c){return $c.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild($c)},$e.onResize=function(){this._setScrollChanged()},$e.addChildAt=function($c,$d){return $c.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt($c,$d)},$e.removeChild=function($c){return $c.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild($c)},$e.removeChildAt=function($c){return this.getChildAt($c).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt($c)},$e.removeChildren=function($c,$d){return void 0===$c&&($c=0),void 0===$d&&($d=2147483647),this._content.removeChildren($c,$d),this._setScrollChanged(),this},$e.getChildAt=function($c){return this._content.getChildAt($c)},$e.getChildByName=function($c){return this._content.getChildByName($c)},$e.getChildIndex=function($c){return this._content.getChildIndex($c)},$e.changeScroll=function(){this._scrollChanged=!1;var $c=this.contentWidth||1,$d=this.contentHeight||1,$e=this._vScrollBar,$f=this._hScrollBar,$g=$e&&$d>this._height,$h=$f&&$c>this._width,$i=$g?this._width-$e.width:this._width,$j=$h?this._height-$f.height:this._height;$e&&($e.x=this._width-$e.width,$e.y=0,$e.height=this._height-($h?$f.height:0),$e.scrollSize=Math.max(.033*this._height,1),$e.thumbPercent=$j/$d,$e.setScroll(0,$d-$j,$e.value)),$f&&($f.x=0,$f.y=this._height-$f.height,$f.width=this._width-($g?$e.width:0),$f.scrollSize=Math.max(.033*this._width,1),$f.thumbPercent=$i/$c,$f.setScroll(0,$c-$i,$f.value))},$e.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},$e.setContentSize=function($c,$d){var $e=this._content;$e.width=$c,$e.height=$d,$e.scrollRect||($e.scrollRect=new $t),$e.scrollRect.setTo(0,0,$c,$d),$e.scrollRect=$e.scrollRect},$e.onScrollBarChange=function($c){var $d=this._content.scrollRect;if($d){var $e=Math.round($c.value);$c.isVertical?$d.y=$e:$d.x=$e,this._content.scrollRect=$d}},$e.scrollTo=function($c,$d){void 0===$c&&($c=0),void 0===$d&&($d=0),this.vScrollBar&&(this.vScrollBar.value=$d),this.hScrollBar&&(this.hScrollBar.value=$c)},$e.refresh=function(){this.changeScroll()},$e.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$r.superGet($J,this,"cacheAs")),$r.superSet($J,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},$e.onScrollEnd=function(){$r.superSet($J,this,"cacheAs",this._$P.cacheAs)},$e._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},$g(0,$e,"numChildren",function(){return this._content.numChildren}),$g(0,$e,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($c){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new $Y),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=$c}),$g(0,$e,"contentWidth",function(){for(var $c=0,$d=this._content.numChildren-1;-1<$d;$d--){var $e=this._content.getChildAt($d);$c=Math.max($e.x+$e.width*$e.scaleX,$c)}return $c}),$g(0,$e,"contentHeight",function(){for(var $c=0,$d=this._content.numChildren-1;-1<$d;$d--){var $e=this._content.getChildAt($d);$c=Math.max($e.y+$e.height*$e.scaleY,$c)}return $c}),$g(0,$e,"width",$c.prototype._$get_width,function($c){$r.superSet($J,this,"width",$c),this._setScrollChanged()}),$g(0,$e,"hScrollBar",function(){return this._hScrollBar}),$g(0,$e,"content",function(){return this._content}),$g(0,$e,"height",$c.prototype._$get_height,function($c){$r.superSet($J,this,"height",$c),this._setScrollChanged()}),$g(0,$e,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($c){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new $dc),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=$c}),$g(0,$e,"vScrollBar",function(){return this._vScrollBar}),$g(0,$e,"cacheAs",$c.prototype._$get_cacheAs,function($c){$r.superSet($J,this,"cacheAs",$c),this._$P.cacheAs=null,"none"!==$c?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),$d}($J),$$=function($c){function $d($c){$d.__super.call(this,$c),this.isVertical=!1}return $h($d,"laya.ui.HSlider",$P),$d}(),$_=function($c){function $e($c,$d){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,$e.__super.call(this),this.skin=$d,this.labels=$c}$h($e,"laya.ui.UIGroup",$c);var $d=$e.prototype;return $r.imps($d,{"laya.ui.IItem":!0}),$d.preinitialize=function(){this.mouseEnabled=!0},$d.destroy=function($c){void 0===$c&&($c=!0),laya.ui.Component.prototype.destroy.call(this,$c),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},$d.addItem=function($c,$d){void 0===$d&&($d=!0);var $e=$c,$f=this._items.length;if($e.name="item"+$f,this.addChild($e),this.initItems(),$d&&0<$f){var $g=this._items[$f-1];"horizontal"==this._direction?$e.x=$g.x+$g.width+this._space:$e.y=$g.y+$g.height+this._space}else $d&&($e.x=0,$e.y=0);return $f},$d.delItem=function($c,$d){void 0===$d&&($d=!0);var $e=this._items.indexOf($c);if(-1!=$e){var $f=$c;this.removeChild($f);for(var $g=$e+1,$h=this._items.length;$g<$h;$g++){var $i=this._items[$g];$i.name="item"+($g-1),$d&&("horizontal"==this._direction?$i.x-=$f.width+this._space:$i.y-=$f.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var $j;$j=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=$j}}},$d.initItems=function(){this._items||(this._items=[]);for(var $c=this._items.length=0;$c<1e4;$c++){var $d=this.getChildByName("item"+$c);if(null==$d)break;this._items.push($d),$d.selected=$c===this._selectedIndex,$d.clickHandler=$o.create(this,this.itemClick,[$c],!1)}},$d.itemClick=function($c){this.selectedIndex=$c},$d.setSelect=function($c,$d){this._items&&-1<$c&&$c<this._items.length&&(this._items[$c].selected=$d)},$d.createItem=function($c,$d){return null},$d.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var $c=0,$d=0,$e=this._items.length;$d<$e;$d++){var $f=this._items[$d];this._skin&&($f.skin=this._skin),this._labelColors&&($f.labelColors=this._labelColors),this._labelSize&&($f.labelSize=this._labelSize),this._labelStroke&&($f.labelStroke=this._labelStroke),this._labelStrokeColor&&($f.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&($f.strokeColors=this._strokeColors),this._labelBold&&($f.labelBold=this._labelBold),this._labelPadding&&($f.labelPadding=this._labelPadding),this._labelAlign&&($f.labelAlign=this._labelAlign),this._stateNum&&($f.stateNum=this._stateNum),this._labelFont&&($f.labelFont=this._labelFont),"horizontal"===this._direction?($f.y=0,$f.x=$c,$c+=$f.width+this._space):($f.x=0,$f.y=$c,$c+=$f.height+this._space)}this.changeSize()},$d.commitMeasure=function(){this.runCallLater(this.changeLabels)},$d._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},$g(0,$d,"labelStrokeColor",function(){return this._labelStrokeColor},function($c){this._labelStrokeColor!=$c&&(this._labelStrokeColor=$c,this._setLabelChanged())}),$g(0,$d,"skin",function(){return this._skin},function($c){this._skin!=$c&&(this._skin=$c,this._setLabelChanged())}),$g(0,$d,"selectedIndex",function(){return this._selectedIndex},function($c){this._selectedIndex!=$c&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$c,this.setSelect($c,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),$g(0,$d,"labels",function(){return this._labels},function($c){if(this._labels!=$c){if(this._labels=$c,this.removeChildren(),this._setLabelChanged(),this._labels)for(var $d=this._labels.split(","),$e=0,$f=$d.length;$e<$f;$e++){var $g=this.createItem(this._skin,$d[$e]);$g.name="item"+$e,this.addChild($g)}this.initItems()}}),$g(0,$d,"strokeColors",function(){return this._strokeColors},function($c){this._strokeColors!=$c&&(this._strokeColors=$c,this._setLabelChanged())}),$g(0,$d,"labelColors",function(){return this._labelColors},function($c){this._labelColors!=$c&&(this._labelColors=$c,this._setLabelChanged())}),$g(0,$d,"labelStroke",function(){return this._labelStroke},function($c){this._labelStroke!=$c&&(this._labelStroke=$c,this._setLabelChanged())}),$g(0,$d,"labelSize",function(){return this._labelSize},function($c){this._labelSize!=$c&&(this._labelSize=$c,this._setLabelChanged())}),$g(0,$d,"stateNum",function(){return this._stateNum},function($c){this._stateNum!=$c&&(this._stateNum=$c,this._setLabelChanged())}),$g(0,$d,"labelBold",function(){return this._labelBold},function($c){this._labelBold!=$c&&(this._labelBold=$c,this._setLabelChanged())}),$g(0,$d,"labelFont",function(){return this._labelFont},function($c){this._labelFont!=$c&&(this._labelFont=$c,this._setLabelChanged())}),$g(0,$d,"labelPadding",function(){return this._labelPadding},function($c){this._labelPadding!=$c&&(this._labelPadding=$c,this._setLabelChanged())}),$g(0,$d,"direction",function(){return this._direction},function($c){this._direction=$c,this._setLabelChanged()}),$g(0,$d,"space",function(){return this._space},function($c){this._space=$c,this._setLabelChanged()}),$g(0,$d,"items",function(){return this._items}),$g(0,$d,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($c){this.selectedIndex=this._items.indexOf($c)}),$g(0,$d,"dataSource",$c.prototype._$get_dataSource,function($c){"number"==typeof(this._dataSource=$c)&&Math.floor($c)==$c||"string"==typeof $c?this.selectedIndex=parseInt($c):$c instanceof Array?this.labels=$c.join(","):$r.superSet($J,this,"dataSource",$c)}),$e}($J),$a=function($d){function $e($c,$d){this._value=null,void 0===$d&&($d=""),$e.__super.call(this,$c,$d)}$h($e,"laya.ui.Radio",$d);var $c=$e.prototype;return $c.destroy=function($c){void 0===$c&&($c=!0),$d.prototype.destroy.call(this,$c),this._value=null},$c.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},$c.initialize=function(){$d.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},$c.onClick=function($c){this.selected=!0},$g(0,$c,"value",function(){return null!=this._value?this._value:this.label},function($c){this._value=$c}),$e}($K),$b=function($c){function $d(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,$d.__super.call(this),this.width=this.height=200}$h($d,"laya.ui.Tree",$c);var $e=$d.prototype;return $r.imps($e,{"laya.ui.IRender":!0}),$e.destroy=function($c){void 0===$c&&($c=!0),laya.ui.Component.prototype.destroy.call(this,$c),this._list&&this._list.destroy($c),this._list=null,this._source=null,this._renderHandler=null},$e.createChildren=function(){this.addChild(this._list=new $X),this._list.renderHandler=$o.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},$e.onListChange=function($c){this.event("change")},$e.getArray=function(){var $c,$d=[];for(var $e in this._source)$c=this._source[$e],this.getParentOpenStatus($c)&&($c.x=this._spaceLeft*this.getDepth($c),$d.push($c));return $d},$e.getDepth=function($c,$d){return void 0===$d&&($d=0),null==$c.nodeParent?$d:this.getDepth($c.nodeParent,$d+1)},$e.getParentOpenStatus=function($c){var $d=$c.nodeParent;return null==$d||!!$d.isOpen&&(null==$d.nodeParent||this.getParentOpenStatus($d))},$e.renderItem=function($c,$d){var $e=$c.dataSource;if($e){$c.left=$e.x;var $f=$c.getChildByName("arrow");$f&&($e.hasChild?($f.visible=!0,$f.index=$e.isOpen?1:0,$f.tag=$d,$f.off("click",this,this.onArrowClick),$f.on("click",this,this.onArrowClick)):$f.visible=!1);var $g=$c.getChildByName("folder");$g&&(2==$g.clipY?$g.index=$e.isDirectory?0:1:$g.index=$e.isDirectory?$e.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([$c,$d])}},$e.onArrowClick=function($c){var $d=$c.currentTarget.tag;this._list.array[$d].isOpen=!this._list.array[$d].isOpen,this.event("open"),this._list.array=this.getArray()},$e.setItemState=function($c,$d){this._list.array[$c]&&(this._list.array[$c].isOpen=$d,this._list.array=this.getArray())},$e.fresh=function(){this._list.array=this.getArray(),this.repaint()},$e.parseXml=function($c,$d,$e,$f){var $g,$h=$c.childNodes,$i=$h.length;if(!$f){$g={};var $j,$k=$c.attributes;for(var $l in $k){var $m=($j=$k[$l]).nodeName,$n=$j.nodeValue;$g[$m]="true"==$n||"false"!=$n&&$n}$g.nodeParent=$e,0<$i&&($g.isDirectory=!0),$g.hasChild=0<$i,$d.push($g)}for(var $o=0;$o<$i;$o++){var $p=$h[$o];this.parseXml($p,$d,$g,!1)}},$e.parseOpenStatus=function($c,$d){for(var $e=0,$f=$d.length;$e<$f;$e++){var $g=$d[$e];if($g.isDirectory)for(var $h=0,$i=$c.length;$h<$i;$h++){var $j=$c[$h];if($j.isDirectory&&this.isSameParent($j,$g)&&$g.label==$j.label){$g.isOpen=$j.isOpen;break}}}},$e.isSameParent=function($c,$d){return null==$c.nodeParent&&null==$d.nodeParent||null!=$c.nodeParent&&null!=$d.nodeParent&&($c.nodeParent.label==$d.nodeParent.label&&this.isSameParent($c.nodeParent,$d.nodeParent))},$e.filter=function($c){if(Boolean($c)){var $d=[];this.getFilterSource(this._source,$d,$c),this._list.array=$d}else this._list.array=this.getArray()},$e.getFilterSource=function($c,$d,$e){var $f;for(var $g in $e=$e.toLocaleLowerCase(),$c)!($f=$c[$g]).isDirectory&&-1<String($f.label).toLowerCase().indexOf($e)&&($f.x=0,$d.push($f)),$f.child&&0<$f.child.length&&this.getFilterSource($f.child,$d,$e)},$g(0,$e,"spaceBottom",function(){return this._list.spaceY},function($c){this._list.spaceY=$c}),$g(0,$e,"keepStatus",function(){return this._keepStatus},function($c){this._keepStatus=$c}),$g(0,$e,"itemRender",function(){return this._list.itemRender},function($c){this._list.itemRender=$c}),$g(0,$e,"array",function(){return this._list.array},function($c){this._keepStatus&&this._list.array&&$c&&this.parseOpenStatus(this._list.array,$c),this._source=$c,this._list.array=this.getArray()}),$g(0,$e,"mouseHandler",function(){return this._list.mouseHandler},function($c){this._list.mouseHandler=$c}),$g(0,$e,"dataSource",$c.prototype._$get_dataSource,function($c){this._dataSource=$c,$r.superSet($J,this,"dataSource",$c)}),$g(0,$e,"source",function(){return this._source}),$g(0,$e,"scrollBar",function(){return this._list.scrollBar}),$g(0,$e,"list",function(){return this._list}),$g(0,$e,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function($c){this._list.vScrollBarSkin=$c}),$g(0,$e,"renderHandler",function(){return this._renderHandler},function($c){this._renderHandler=$c}),$g(0,$e,"selectedIndex",function(){return this._list.selectedIndex},function($c){this._list.selectedIndex=$c}),$g(0,$e,"spaceLeft",function(){return this._spaceLeft},function($c){this._spaceLeft=$c}),$g(0,$e,"selectedItem",function(){return this._list.selectedItem},function($c){this._list.selectedItem=$c}),$g(0,$e,"width",$c.prototype._$get_width,function($c){$r.superSet($J,this,"width",$c),this._list.width=$c}),$g(0,$e,"height",$c.prototype._$get_height,function($c){$r.superSet($J,this,"height",$c),this._list.height=$c}),$g(0,$e,"xml",null,function($c){var $d=[];this.parseXml($c.childNodes[0],$d,null,!0),this.array=$d}),$g(0,$e,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),$d}($J),$cc=function($c){function $d(){this._items=null,this._selectedIndex=0,$d.__super.call(this),this._setIndexHandler=$o.create(this,this.setIndex,null,!1)}$h($d,"laya.ui.ViewStack",$c);var $e=$d.prototype;return $r.imps($e,{"laya.ui.IItem":!0}),$e.setItems=function($c){this.removeChildren();for(var $d=0,$e=0,$f=$c.length;$e<$f;$e++){var $g=$c[$e];$g&&($g.name="item"+$d,this.addChild($g),$d++)}this.initItems()},$e.addItem=function($c){$c.name="item"+this._items.length,this.addChild($c),this.initItems()},$e.initItems=function(){this._items=[];for(var $c=0;$c<1e4;$c++){var $d=this.getChildByName("item"+$c);if(null==$d)break;this._items.push($d),$d.visible=$c==this._selectedIndex}},$e.setSelect=function($c,$d){this._items&&-1<$c&&$c<this._items.length&&(this._items[$c].visible=$d)},$e.setIndex=function($c){this.selectedIndex=$c},$g(0,$e,"dataSource",$c.prototype._$get_dataSource,function($c){if("number"==typeof(this._dataSource=$c)&&Math.floor($c)==$c||"string"==typeof $c)this.selectedIndex=parseInt($c);else for(var $d in this._dataSource)this.hasOwnProperty($d)&&(this[$d]=this._dataSource[$d])}),$g(0,$e,"selectedIndex",function(){return this._selectedIndex},function($c){this._selectedIndex!=$c&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$c,this.setSelect(this._selectedIndex,!0))}),$g(0,$e,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($c){this.selectedIndex=this._items.indexOf($c)}),$g(0,$e,"items",function(){return this._items}),$g(0,$e,"setIndexHandler",function(){return this._setIndexHandler},function($c){this._setIndexHandler=$c}),$d}($J),$dc=function($c){function $d(){$d.__super.call(this)}return $h($d,"laya.ui.VScrollBar",$O),$d}(),$ec=function($d){function $e($c){this._bg=null,this._skin=null,$e.__super.call(this),void 0===$c&&($c=""),this.text=$c,this.skin=this.skin}$h($e,"laya.ui.TextInput",$d);var $c=$e.prototype;return $c.preinitialize=function(){this.mouseEnabled=!0},$c.destroy=function($c){$u.clearCache(this,this._skin),void 0===$c&&($c=!0),$d.prototype.destroy.call(this,$c),this._bg&&this._bg.destroy(),this._bg=null},$c.createChildren=function(){this.addChild(this._tf=new $p),this._tf.padding=$D.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},$c._onFocus=function(){this.event("focus",this)},$c._onBlur=function(){this.event("blur",this)},$c._onInput=function(){this.event("input",this)},$c._onEnter=function(){this.event("enter",this)},$c.initialize=function(){this.width=128,this.height=22},$c.select=function(){this._tf.select()},$c.setSelection=function($c,$d){this._tf.setSelection($c,$d)},$g(0,$c,"text",$d.prototype._$get_text,function($c){this._tf.text!=$c&&($c+="",this._tf.text=$c,this.event("change"))}),$g(0,$c,"bg",function(){return this._bg},function($c){this.graphics=this._bg=$c}),$g(0,$c,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function($c){this._tf.inputElementYAdjuster=$c}),$g(0,$c,"multiline",function(){return this._tf.multiline},function($c){this._tf.multiline=$c}),$g(0,$c,"skin",function(){return this._skin},function($c){this._skin!=$c&&($u.clearCache(this,this._skin),this._skin=$c,this._bg||(this.graphics=this._bg=new $G),$u.keepCache(this,this._skin),this._bg.source=$u.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),$g(0,$c,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function($c){this._bg||(this.graphics=this._bg=new $G),this._bg.sizeGrid=$E.fillArray($D.defaultSizeGrid,$c,Number)}),$g(0,$c,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function($c){this._tf.inputElementXAdjuster=$c}),$g(0,$c,"width",$d.prototype._$get_width,function($c){$r.superSet($R,this,"width",$c),this._bg&&(this._bg.width=$c)}),$g(0,$c,"height",$d.prototype._$get_height,function($c){$r.superSet($R,this,"height",$c),this._bg&&(this._bg.height=$c)}),$g(0,$c,"editable",function(){return this._tf.editable},function($c){this._tf.editable=$c}),$g(0,$c,"restrict",function(){return this._tf.restrict},function($c){this._tf.restrict=$c}),$g(0,$c,"prompt",function(){return this._tf.prompt},function($c){this._tf.prompt=$c}),$g(0,$c,"promptColor",function(){return this._tf.promptColor},function($c){this._tf.promptColor=$c}),$g(0,$c,"maxChars",function(){return this._tf.maxChars},function($c){this._tf.maxChars=$c}),$g(0,$c,"focus",function(){return this._tf.focus},function($c){this._tf.focus=$c}),$g(0,$c,"type",function(){return this._tf.type},function($c){this._tf.type=$c}),$g(0,$c,"asPassword",function(){return this._tf.asPassword},function($c){this._tf.asPassword=$c}),$e}($R),$fc=function($c){function $d(){$d.__super.call(this)}return $h($d,"laya.ui.VSlider",$P),$d}(),$gc=function($c){function $f(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,$f.__super.call(this)}$h($f,"laya.ui.Dialog",$c);var $d=$f.prototype;return $d.initialize=function(){this.popupEffect=$f.manager.popupEffectHandler,this.closeEffect=$f.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},$d._dealDragArea=function(){var $c=this.getChildByName("drag");$c&&(this.dragArea=$c.x+","+$c.y+","+$c.width+","+$c.height,$c.removeSelf())},$d._onClick=function($c){var $d=$c.target;if($d)switch($d.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close($d.name)}},$d.show=function($c,$d){void 0===$c&&($c=!1),void 0===$d&&($d=!0),this._open(!1,$c,$d)},$d.popup=function($c,$d){void 0===$c&&($c=!1),void 0===$d&&($d=!0),this._open(!0,$c,$d)},$d._open=function($c,$d,$e){$f.manager.lock(!1),this.isModal=$c,$f.manager.open(this,$d,$e)},$d.onOpened=function(){},$d.close=function($c,$d){void 0===$d&&($d=!0),$f.manager.close(this,$c,$d)},$d.onClosed=function($c){},$d._onMouseDown=function($c){var $d=this.getMousePoint();this._dragArea.contains($d.x,$d.y)?this.startDrag():this.stopDrag()},$g(0,$d,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function($c){if($c){var $d=$E.fillArray([0,0,0,0],$c,Number);this._dragArea=new $t($d[0],$d[1],$d[2],$d[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),$g(0,$d,"isPopup",function(){return null!=this.parent}),$g(0,$d,"zOrder",$c.prototype._$get_zOrder,function($c){$r.superSet($T,this,"zOrder",$c),$f.manager._checkMask()}),$g(1,$f,"manager",function(){return $f._manager=$f._manager||new $I},function($c){$f._manager=$c}),$f.setLockView=function($c){$f.manager.setLockView($c)},$f.lock=function($c){$f.manager.lock($c)},$f.closeAll=function(){$f.manager.closeAll()},$f.getDialogsByGroup=function($c){return $f.manager.getDialogsByGroup($c)},$f.closeByGroup=function($c){return $f.manager.closeByGroup($c)},$f.CLOSE="close",$f.CANCEL="cancel",$f.SURE="sure",$f.NO="no",$f.OK="ok",$f.YES="yes",$f._manager=null,$f}($T),$hc=function($c){function $d(){$d.__super.call(this)}$h($d,"laya.ui.HBox",$c);var $e=$d.prototype;return $e.sortItem=function($c){$c&&$c.sort(function($c,$d){return $c.x-$d.x})},$e.changeItems=function(){this._itemChanged=!1;for(var $c=[],$d=0,$e=0,$f=this.numChildren;$e<$f;$e++){var $g=this.getChildAt($e);$g&&$g.layoutEnabled&&($c.push($g),$d=this._height?this._height:Math.max($d,$g.height*$g.scaleY))}this.sortItem($c);var $h=0;for($e=0,$f=$c.length;$e<$f;$e++)($g=$c[$e]).x=$h,$h+=$g.width*$g.scaleX+this._space,"top"==this._align?$g.y=0:"middle"==this._align?$g.y=.5*($d-$g.height*$g.scaleY):"bottom"==this._align&&($g.y=$d-$g.height*$g.scaleY);this.changeSize()},$g(0,$e,"height",$c.prototype._$get_height,function($c){this._height!=$c&&($r.superSet($V,this,"height",$c),this.callLater(this.changeItems))}),$d.NONE="none",$d.TOP="top",$d.MIDDLE="middle",$d.BOTTOM="bottom",$d}($V),$ic=function($c){function $d(){$d.__super.call(this)}$h($d,"laya.ui.VBox",$c);var $e=$d.prototype;return $e.changeItems=function(){this._itemChanged=!1;for(var $c=[],$d=0,$e=0,$f=this.numChildren;$e<$f;$e++){var $g=this.getChildAt($e);$g&&$g.layoutEnabled&&($c.push($g),$d=this._width?this._width:Math.max($d,$g.width*$g.scaleX))}this.sortItem($c);var $h=0;for($e=0,$f=$c.length;$e<$f;$e++)($g=$c[$e]).y=$h,$h+=$g.height*$g.scaleY+this._space,"left"==this._align?$g.x=0:"center"==this._align?$g.x=.5*($d-$g.width*$g.scaleX):"right"==this._align&&($g.x=$d-$g.width*$g.scaleX);this.changeSize()},$g(0,$e,"width",$c.prototype._$get_width,function($c){this._width!=$c&&($r.superSet($V,this,"width",$c),this.callLater(this.changeItems))}),$d.NONE="none",$d.LEFT="left",$d.CENTER="center",$d.RIGHT="right",$d}($V),$jc=function($c){function $d(){$d.__super.call(this)}return $h($d,"laya.ui.RadioGroup",$_),$d.prototype.createItem=function($c,$d){return new $a($c,$d)},$d}(),$kc=function($c){function $d(){$d.__super.call(this)}return $h($d,"laya.ui.Tab",$_),$d.prototype.createItem=function($c,$d){return new $K($c,$d)},$d}(),$lc=function($d){function $e($c){this._vScrollBar=null,this._hScrollBar=null,void 0===$c&&($c=""),$e.__super.call(this,$c)}$h($e,"laya.ui.TextArea",$d);var $c=$e.prototype;return $c.destroy=function($c){void 0===$c&&($c=!0),$d.prototype.destroy.call(this,$c),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},$c.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},$c.onVBarChanged=function($c){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},$c.onHBarChanged=function($c){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},$c.changeScroll=function(){var $c=this._vScrollBar&&0<this._tf.maxScrollY,$d=this._hScrollBar&&0<this._tf.maxScrollX,$e=$c?this._width-this._vScrollBar.width:this._width,$f=$d?this._height-this._hScrollBar.height:this._height,$g=this._tf.padding||$D.labelPadding;this._tf.width=$e,this._tf.height=$f,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-$g[2],this._vScrollBar.y=$g[1],this._vScrollBar.height=this._height-($d?this._hScrollBar.height:0)-$g[1]-$g[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=$f/Math.max(this._tf.textHeight,$f),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=$c),this._hScrollBar&&(this._hScrollBar.x=$g[0],this._hScrollBar.y=this._height-this._hScrollBar.height-$g[3],this._hScrollBar.width=this._width-($c?this._vScrollBar.width:0)-$g[0]-$g[2],this._hScrollBar.scrollSize=Math.max(.033*$e,1),this._hScrollBar.thumbPercent=$e/Math.max(this._tf.textWidth,$e),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=$d)},$c.scrollTo=function($c){this.commitMeasure(),this._tf.scrollY=$c},$g(0,$c,"scrollY",function(){return this._tf.scrollY}),$g(0,$c,"width",$d.prototype._$get_width,function($c){$r.superSet($ec,this,"width",$c),this.callLater(this.changeScroll)}),$g(0,$c,"hScrollBar",function(){return this._hScrollBar}),$g(0,$c,"height",$d.prototype._$get_height,function($c){$r.superSet($ec,this,"height",$c),this.callLater(this.changeScroll)}),$g(0,$c,"maxScrollX",function(){return this._tf.maxScrollX}),$g(0,$c,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($c){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new $dc),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=$c}),$g(0,$c,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($c){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new $Y),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=$c}),$g(0,$c,"vScrollBar",function(){return this._vScrollBar}),$g(0,$c,"maxScrollY",function(){return this._tf.maxScrollY}),$g(0,$c,"scrollX",function(){return this._tf.scrollX}),$e}($ec);!function($c){function $d(){this._uiView=null,this.isCloseOther=!1,$d.__super.call(this)}$h($d,"laya.ui.AsynDialog",$gc);var $e=$d.prototype;$e.createView=function($c){this._uiView=$c},$e._open=function($c,$d,$e){this.isModal=$c,this.isCloseOther=$d,$gc.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},$e.onCreated=function(){this.createUI(),this.onOpen()},$e.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},$e.onOpen=function(){$gc.manager.open(this,this.isCloseOther),$gc.manager.lock(!1)},$e.close=function($c,$d){void 0===$d&&($d=!0),$gc.manager.close(this),this.onClose()},$e.onClose=function(){},$e.destroy=function($c){void 0===$c&&($c=!0),laya.ui.View.prototype.destroy.call(this,$c),this._uiView=null,this.onDestroy()},$e.onDestroy=function(){}}();$r.__init([$T])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($c,$d){"use strict";for(var $e in Object.defineProperty($d,"__esModule",{value:!0}),Laya){var $f=Laya[$e];$f&&$f.__isclass&&($d[$e]=$f)}}),function($o,$c,$x){$x.un,$x.uns;var $n=$x.static,$p=$x.class,$q=$x.getset,$f=$x.__newvec,$w=laya.maths.Arith,$i=laya.webgl.atlas.AtlasResourceManager,$e=laya.webgl.shader.BaseShader,$H=laya.utils.Browser,$j=laya.webgl.utils.Buffer,$y=laya.utils.Byte,$g=laya.utils.ClassUtils,$k=$x.Config,$h=(laya.events.Event,laya.events.EventDispatcher),$D=laya.utils.Handler,$t=laya.net.Loader,$d=laya.net.LoaderManager,$l=(laya.maths.MathUtil,laya.display.Node),$r=laya.renders.Render,$m=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),$s=laya.resource.Resource,$u=laya.utils.RunDriver,$v=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),$z=laya.display.Sprite,$A=laya.utils.Stat,$B=laya.utils.StringKey,$E=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),$C=laya.utils.Utils,$F=laya.webgl.WebGL,$G=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;$x.interface("laya.d3.core.IClone"),$x.interface("laya.d3.graphics.IVertex"),$x.interface("laya.d3.core.render.IUpdate"),$x.interface("laya.d3.core.scene.ITreeNode"),$x.interface("laya.d3.core.render.IRenderable");(function(){function $K(){}$p($K,"laya.d3.animation.AnimationClipParser01"),$K.READ_DATA=function(){$K._DATA.offset=$K._reader.getUint32(),$K._DATA.size=$K._reader.getUint32()},$K.READ_BLOCK=function(){for(var $c=$K._BLOCK.count=$K._reader.getUint16(),$d=$K._BLOCK.blockStarts=[],$e=$K._BLOCK.blockLengths=[],$f=0;$f<$c;$f++)$d.push($K._reader.getUint32()),$e.push($K._reader.getUint32())},$K.READ_STRINGS=function(){var $c=$K._reader.getUint32(),$d=$K._reader.getUint16(),$e=$K._reader.pos;$K._reader.pos=$c+$K._DATA.offset;for(var $f=0;$f<$d;$f++)$K._strings[$f]=$K._reader.readUTFString();$K._reader.pos=$e},$K.parse=function($c,$d){$K._animationClip=$c;($K._reader=$d).__getBuffer();$K.READ_DATA(),$K.READ_BLOCK(),$K.READ_STRINGS();for(var $e=0,$f=$K._BLOCK.count;$e<$f;$e++){var $g=$d.getUint16(),$h=$K._strings[$g],$i=$K["READ_"+$h];if(null==$i)throw new Error("model file err,no this function:"+$g+" "+$h);$i.call()}},$K.READ_ANIMATIONS=function(){var $c,$d=0,$e=0,$f=$K._reader,$g=$f.__getBuffer(),$h=[],$i=$f.getUint8();for($h.length=$i,$d=0;$d<$i;$d++)$h[$d]=$f.getUint16();var $j=[],$k=$f.getUint16();for($j.length=$k,$d=0;$d<$k;$d++)$j[$d]=$f.getFloat32();var $l=$K._animationClip;$l.name=$K._strings[$f.getUint16()];var $m=$l._duration=$f.getFloat32();$l.islooping=!!$f.getByte(),$l._frameRate=$f.getInt16();var $n=$f.getInt16(),$o=$l._nodes=new Array;$o.length=$n,($l._publicClipDatas=[]).length=$n;var $p=$l._nodesMap={},$q=0,$r=0;for($d=0;$d<$n;$d++){$c=$o[$d]=new $S;var $s=$f.getUint16(),$t=$c.path=[];for($t.length=$s,$e=0;$e<$s;$e++)$t[$e]=$K._strings[$f.getUint16()];var $u=$t.join("/"),$v=$p[$u];$v||($p[$u]=$v=[]),$v.push($c);var $w=$f.getInt16();-1!==$w&&($c.componentType=$K._strings[$w]);var $x=$Q._propertyIndexDic[$K._strings[$f.getUint16()]];if(null==$x)throw new Error("AnimationClipParser01:unknown property name.");var $y=$x<4,$z=!$y||$y&&""===$t[0];($c._cacheProperty=$z)?$q++:$r++,$c.propertyNameID=$x;var $A=$h[$f.getUint8()];$c.keyFrameWidth=$A/4;var $B=$c.keyFrames=[],$C=$B.length=$f.getUint16(),$D=null,$E=NaN;for($e=0;$e<$C;$e++){var $F=$B[$e]=new $R;$E=$F.startTime=$j[$f.getUint16()];var $G=$f.pos;$F.inTangent=new Float32Array($g.slice($G,$G+$A)),$f.pos+=$A,$G=$f.pos,$F.outTangent=new Float32Array($g.slice($G,$G+$A)),$f.pos+=$A,$G=$f.pos,$F.data=new Float32Array($g.slice($G,$G+$A)),$f.pos+=$A,$D&&($D.next=$F,$D.duration=$E-$D.startTime),$D=$F}$F.next=null,$F.duration=$m-$E}var $H=$l._nodeToCachePropertyMap=new Int32Array($n),$I=$l._cachePropertyMap=new Int32Array($q),$J=$l._unCachePropertyMap=new Int32Array($r);for($q=$r=0,$d=0;$d<$n;$d++)($c=$o[$d])._cacheProperty?($H[$d]=$q,$I[$q++]=$d):$J[$r++]=$d},$K._animationClip=null,$K._reader=null,$K._strings=[],$n($K,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function $O(){}$p($O,"laya.d3.animation.AnimationClipParser02"),$O.READ_DATA=function(){$O._DATA.offset=$O._reader.getUint32(),$O._DATA.size=$O._reader.getUint32()},$O.READ_BLOCK=function(){for(var $c=$O._BLOCK.count=$O._reader.getUint16(),$d=$O._BLOCK.blockStarts=[],$e=$O._BLOCK.blockLengths=[],$f=0;$f<$c;$f++)$d.push($O._reader.getUint32()),$e.push($O._reader.getUint32())},$O.READ_STRINGS=function(){var $c=$O._reader.getUint32(),$d=$O._reader.getUint16(),$e=$O._reader.pos;$O._reader.pos=$c+$O._DATA.offset;for(var $f=0;$f<$d;$f++)$O._strings[$f]=$O._reader.readUTFString();$O._reader.pos=$e},$O.parse=function($c,$d){$O._animationClip=$c;($O._reader=$d).__getBuffer();$O.READ_DATA(),$O.READ_BLOCK(),$O.READ_STRINGS();for(var $e=0,$f=$O._BLOCK.count;$e<$f;$e++){var $g=$d.getUint16(),$h=$O._strings[$g],$i=$O["READ_"+$h];if(null==$i)throw new Error("model file err,no this function:"+$g+" "+$h);$i.call()}},$O.READ_ANIMATIONS=function(){var $c,$d=0,$e=0,$f=$O._reader,$g=$f.__getBuffer(),$h=[],$i=$f.getUint8();for($h.length=$i,$d=0;$d<$i;$d++)$h[$d]=$f.getUint16();var $j=[],$k=$f.getUint16();for($j.length=$k,$d=0;$d<$k;$d++)$j[$d]=$f.getFloat32();var $l=$O._animationClip;$l.name=$O._strings[$f.getUint16()];var $m=$l._duration=$f.getFloat32();$l.islooping=!!$f.getByte(),$l._frameRate=$f.getInt16();var $n=$f.getInt16(),$o=$l._nodes=new Array;$o.length=$n,($l._publicClipDatas=[]).length=$n;var $p=$l._nodesMap={},$q=0,$r=0;for($d=0;$d<$n;$d++){$c=$o[$d]=new $S;var $s=$f.getUint16(),$t=$c.path=[];for($t.length=$s,$e=0;$e<$s;$e++)$t[$e]=$O._strings[$f.getUint16()];var $u=$t.join("/"),$v=$p[$u];$v||($p[$u]=$v=[]),$v.push($c);var $w=$f.getInt16();-1!==$w&&($c.componentType=$O._strings[$w]);var $x=$Q._propertyIndexDic[$O._strings[$f.getUint16()]];if(null==$x)throw new Error("AnimationClipParser02:unknown property name.");var $y=$x<4,$z=!$y||$y&&""===$t[0];($c._cacheProperty=$z)?$q++:$r++,$c.propertyNameID=$x;var $A=$h[$f.getUint8()];$c.keyFrameWidth=$A/4;var $B=$c.keyFrames=[],$C=$B.length=$f.getUint16(),$D=null,$E=NaN;for($e=0;$e<$C;$e++){var $F=$B[$e]=new $R;$E=$F.startTime=$j[$f.getUint16()];var $G=$f.pos;$F.inTangent=new Float32Array($g.slice($G,$G+$A)),$f.pos+=$A,$G=$f.pos,$F.outTangent=new Float32Array($g.slice($G,$G+$A)),$f.pos+=$A,$G=$f.pos,$F.data=new Float32Array($g.slice($G,$G+$A)),$f.pos+=$A,$D&&($D.next=$F,$D.duration=$E-$D.startTime),$D=$F}$F.next=null,$F.duration=$m-$E}var $H=$f.getUint16();for($d=0;$d<$H;$d++){var $I,$J=new $P;$J.time=$f.getFloat32(),$J.eventName=$O._strings[$f.getUint16()];var $K=$f.getUint16();for(0<$K&&($J.params=$I=[]),$e=0;$e<$K;$e++){switch($f.getByte()){case 0:$I.push(!!$f.getByte());break;case 1:$I.push($f.getInt32());break;case 2:$I.push($f.getFloat32());break;case 3:$I.push($O._strings[$f.getUint16()]);break;default:throw new Error("unknown type.")}}$l.addEvent($J)}var $L=$l._nodeToCachePropertyMap=new Int32Array($n),$M=$l._cachePropertyMap=new Int32Array($q),$N=$l._unCachePropertyMap=new Int32Array($r);for($q=$r=0,$d=0;$d<$n;$d++)($c=$o[$d])._cacheProperty?($L[$d]=$q,$M[$q++]=$d):$N[$r++]=$d},$O._animationClip=null,$O._reader=null,$O._strings=[],$n($O,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var $P=function(){function $c(){this.time=NaN,this.eventName=null,this.params=null}return $p($c,"laya.d3.animation.AnimationEvent"),$c}(),$Q=function(){function $f(){this._childs=[],this.transform=new $ud(this)}$p($f,"laya.d3.animation.AnimationNode");var $c=$f.prototype;return $x.imps($c,{"laya.d3.core.IClone":!0}),$c.addChild=function($c){$c._parent=this,$c.transform.setParent(this.transform),this._childs.push($c)},$c.removeChild=function($c){var $d=this._childs.indexOf($c);-1!==$d&&this._childs.splice($d,1)},$c.getChildByName=function($c){for(var $d=0,$e=this._childs.length;$d<$e;$d++){var $f=this._childs[$d];if($f.name===$c)return $f}return null},$c.getChildByIndex=function($c){return this._childs[$c]},$c.getChildCount=function(){return this._childs.length},$c.cloneTo=function($c){var $d=$c;$d.name=this.name;for(var $e=0,$f=this._childs.length;$e<$f;$e++){var $g=this._childs[$e],$h=$g.clone();$d.addChild($h);var $i=$g.transform,$j=$h.transform;$j.setLocalPosition($i.getLocalPosition()),$j.setLocalRotation($i.getLocalRotation()),$j.setLocalScale($i.getLocalScale()),$j._localRotationEuler=$i._localRotationEuler,$j._setWorldMatrixIgnoreUpdate($i.getWorldMatrix())}},$c.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$f.__init__=function(){$f.registerAnimationNodeProperty("localPosition",$f._getLocalPosition,$f._setLocalPosition),$f.registerAnimationNodeProperty("localRotation",$f._getLocalRotation,$f._setLocalRotation),$f.registerAnimationNodeProperty("localScale",$f._getLocalScale,$f._setLocalScale),$f.registerAnimationNodeProperty("localRotationEuler",$f._getLocalRotationEuler,$f._setLocalRotationEuler),$f.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",$f._getParticleRenderSharedMaterialTintColor,$f._setParticleRenderSharedMaterialTintColor),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",$f._getMeshRenderSharedMaterialTilingOffset,$f._setMeshRenderSharedMaterialTilingOffset),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",$f._getMeshRenderSharedMaterialAlbedo,$f._setMeshRenderSharedMaterialAlbedo),$f.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",$f._getSkinnedMeshRenderSharedMaterialTilingOffset,$f._setSkinnedMeshRenderSharedMaterialTilingOffset),$f.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",$f._getSkinnedMeshRenderSharedMaterialAlbedo,$f._setSkinnedMeshRenderSharedMaterialAlbedo),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",$f._getMeshRenderSharedMaterialAlbedo,$f._setMeshRenderSharedMaterialAlbedo),$f.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",$f._getSkinnedMeshRenderSharedMaterialAlbedo,$f._setSkinnedMeshRenderSharedMaterialAlbedo),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",$f._getMeshRenderSharedMaterialIntensity,$f._setMeshRenderSharedMaterialIntensity),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",$f._getMeshRenderSharedMaterialAlpha,$f._setMeshRenderSharedMaterialAlpha),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",$f._getMeshRenderSharedMaterialAlphaColor,$f._setMeshRenderSharedMaterialAlphaColor),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",$f._getMeshRenderSharedMaterialBaseColor,$f._setMeshRenderSharedMaterialBaseColor),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",$f._getMeshRenderSharedMaterialDissolve,$f._setMeshRenderSharedMaterialDissolve),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",$f._getMeshRenderSharedMaterialDissolveSpeed,$f._setMeshRenderSharedMaterialDissolveSpeed),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",$f._getMeshRenderSharedMaterialMMultiplier,$f._setMeshRenderSharedMaterialMMultiplier),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",$f._getMeshRenderSharedMaterialBaseScrollSpeedX,$f._setMeshRenderSharedMaterialBaseScrollSpeedX),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",$f._getMeshRenderSharedMaterialBaseScrollSpeedY,$f._setMeshRenderSharedMaterialBaseScrollSpeedY),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",$f._getMeshRenderSharedMaterialSecondScrollSpeedX,$f._setMeshRenderSharedMaterialSecondScrollSpeedX),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",$f._getMeshRenderSharedMaterialSecondScrollSpeedY,$f._setMeshRenderSharedMaterialSecondScrollSpeedY),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",$f._getMeshRenderSharedMaterialDetailTilingOffset,$f._setMeshRenderSharedMaterialDetailTilingOffset),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",$f._getMeshRenderSharedMaterialDissolveTilingOffset,$f._setMeshRenderSharedMaterialDissolveTilingOffset),$f.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",$f._getMeshRenderSharedMaterialMaskTilingOffset,$f._setMeshRenderSharedMaterialMaskTilingOffset)},$f.registerAnimationNodeProperty=function($c,$d,$e){if($f._propertyIndexDic[$c])throw new Error("AnimationNode: this propertyName has registered.");$f._propertyIndexDic[$c]=$f._propertyIDCounter,$f._propertyGetFuncs[$f._propertyIDCounter]=$d,$f._propertySetFuncs[$f._propertyIDCounter]=$e,$f._propertyIDCounter++},$f._getLocalPosition=function($c,$d){return $c?$c.transform.getLocalPosition():$d._transform.localPosition.elements},$f._setLocalPosition=function($c,$d,$e){if($c)$c.transform.setLocalPosition($e);else{var $f=$d._transform,$g=$f.localPosition;$g.elements=$e,$f.localPosition=$g}},$f._getLocalRotation=function($c,$d){return $c?$c.transform.getLocalRotation():$d._transform.localRotation.elements},$f._setLocalRotation=function($c,$d,$e){if($c)$c.transform.setLocalRotation($e);else{var $f=$d._transform,$g=$f.localRotation;$g.elements=$e,$f.localRotation=$g}},$f._getLocalScale=function($c,$d){return $c?$c.transform.getLocalScale():$d._transform.localScale.elements},$f._setLocalScale=function($c,$d,$e){if($c)$c.transform.setLocalScale($e);else{var $f=$d._transform,$g=$f.localScale;$g.elements=$e,$f.localScale=$g}},$f._getLocalRotationEuler=function($c,$d){return $c?$c.transform.getLocalRotationEuler():$d._transform.localRotationEuler.elements},$f._setLocalRotationEuler=function($c,$d,$e){if($c)$c.transform.setLocalRotationEuler($e);else{var $f=$d._transform,$g=$f.localRotationEuler;$g.elements=$e,$f.localRotationEuler=$g}},$f._getMeshRenderSharedMaterialTilingOffset=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return $d.meshRender.sharedMaterial.tilingOffset.elements},$f._setMeshRenderSharedMaterialTilingOffset=function($c,$d,$e){var $f,$g;if($c){var $h=$c.transform._entity;$h&&(($g=($f=$h.owner.meshRender.material).tilingOffset).elements=$e,$f.tilingOffset=$g)}else($g=($f=$d.meshRender.material).tilingOffset).elements=$e,$f.tilingOffset=$g},$f._getMeshRenderSharedMaterialAlbedo=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.albedoColor.elements:null}return $d.meshRender.sharedMaterial.albedoColor.elements},$f._setMeshRenderSharedMaterialAlbedo=function($c,$d,$e){var $f,$g;if($c){var $h=$c.transform._entity;$h&&(($g=($f=$h.owner.meshRender.material).albedoColor).elements=$e,$f.albedoColor=$g)}else($g=($f=$d.meshRender.material).albedoColor).elements=$e,$f.albedoColor=$g},$f._getSkinnedMeshRenderSharedMaterialTilingOffset=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return $d.skinnedMeshRender.sharedMaterial.tilingOffset.elements},$f._setSkinnedMeshRenderSharedMaterialTilingOffset=function($c,$d,$e){var $f,$g;if($c){var $h=$c.transform._entity;$h&&(($g=($f=$h.owner.skinnedMeshRender.material).tilingOffset).elements=$e,$f.tilingOffset=$g)}else($g=($f=$d.skinnedMeshRender.material).tilingOffset).elements=$e,$f.tilingOffset=$g},$f._getSkinnedMeshRenderSharedMaterialAlbedo=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return $d.skinnedMeshRender.sharedMaterial.albedoColor.elements},$f._setSkinnedMeshRenderSharedMaterialAlbedo=function($c,$d,$e){var $f,$g;if($c){var $h=$c.transform._entity;$h&&(($g=($f=$h.owner.skinnedMeshRender.material).albedoColor).elements=$e,$f.albedoColor=$g)}else($g=($f=$d.skinnedMeshRender.material).albedoColor).elements=$e,$f.albedoColor=$g},$f._getParticleRenderSharedMaterialTintColor=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.particleRender.sharedMaterial.tintColor.elements:null}return $d.particleRender.sharedMaterial.tintColor.elements},$f._setParticleRenderSharedMaterialTintColor=function($c,$d,$e){var $f,$g;if($c){var $h=$c.transform._entity;$h&&(($g=($f=$h.owner.particleRender.material).tintColor).elements=$e,$f.tintColor=$g)}else($g=($f=$d.particleRender.material).tintColor).elements=$e,$f.tintColor=$g},$f._getMeshRenderSharedMaterialAlphaColor=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.alphaColor.elements:null}return $d.meshRender.sharedMaterial.alphaColor.elements},$f._setMeshRenderSharedMaterialAlphaColor=function($c,$d,$e){var $f,$g;if($c){var $h=$c.transform._entity;$h&&(($g=($f=$h.owner.meshRender.material).alphaColor).elements=$e,$f.alphaColor=$g)}else($g=($f=$d.meshRender.material).alphaColor).elements=$e,$f.alphaColor=$g},$f._getMeshRenderSharedMaterialBaseColor=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.baseColor.elements:null}return $d.meshRender.sharedMaterial.baseColor.elements},$f._setMeshRenderSharedMaterialBaseColor=function($c,$d,$e){var $f,$g;if($c){var $h=$c.transform._entity;$h&&(($g=($f=$h.owner.meshRender.material).baseColor).elements=$e,$f.baseColor=$g)}else($g=($f=$d.meshRender.material).baseColor).elements=$e,$f.baseColor=$g},$f._getMeshRenderSharedMaterialDissolve=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.dissolve:0}return $d.meshRender.sharedMaterial.dissolve},$f._setMeshRenderSharedMaterialDissolve=function($c,$d,$e){if($c){var $f=$c.transform._entity;$f&&($f.owner.meshRender.material.dissolve=$e[0])}else $d.meshRender.material.dissolve=$e[0]},$f._getMeshRenderSharedMaterialDissolveSpeed=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.dissolveSpeed:0}return $d.meshRender.sharedMaterial.dissolveSpeed},$f._setMeshRenderSharedMaterialDissolveSpeed=function($c,$d,$e){if($c){var $f=$c.transform._entity;$f&&($f.owner.meshRender.material.dissolveSpeed=$e[0])}else $d.meshRender.material.dissolveSpeed=$e[0]},$f._getMeshRenderSharedMaterialMMultiplier=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.mMultiplier:0}return $d.meshRender.sharedMaterial.mMultiplier},$f._setMeshRenderSharedMaterialMMultiplier=function($c,$d,$e){if($c){var $f=$c.transform._entity;$f&&($f.owner.meshRender.material.mMultiplier=$e[0])}else $d.meshRender.material.mMultiplier=$e[0]},$f._getMeshRenderSharedMaterialBaseScrollSpeedX=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return $d.meshRender.sharedMaterial.baseScrollSpeedX},$f._setMeshRenderSharedMaterialBaseScrollSpeedX=function($c,$d,$e){if($c){var $f=$c.transform._entity;$f&&($f.owner.meshRender.material.baseScrollSpeedX=$e[0])}else $d.meshRender.material.baseScrollSpeedX=$e[0]},$f._getMeshRenderSharedMaterialBaseScrollSpeedY=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return $d.meshRender.sharedMaterial.baseScrollSpeedY},$f._setMeshRenderSharedMaterialBaseScrollSpeedY=function($c,$d,$e){if($c){var $f=$c.transform._entity;$f&&($f.owner.meshRender.material.baseScrollSpeedY=$e[0])}else $d.meshRender.material.baseScrollSpeedY=$e[0]},$f._getMeshRenderSharedMaterialSecondScrollSpeedX=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return $d.meshRender.sharedMaterial.secondScrollSpeedX},$f._setMeshRenderSharedMaterialSecondScrollSpeedX=function($c,$d,$e){if($c){var $f=$c.transform._entity;$f&&($f.owner.meshRender.material.secondScrollSpeedX=$e[0])}else $d.meshRender.material.secondScrollSpeedX=$e[0]},$f._getMeshRenderSharedMaterialSecondScrollSpeedY=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return $d.meshRender.sharedMaterial.secondScrollSpeedY},$f._setMeshRenderSharedMaterialSecondScrollSpeedY=function($c,$d,$e){if($c){var $f=$c.transform._entity;$f&&($f.owner.meshRender.material.secondScrollSpeedY=$e[0])}else $d.meshRender.material.secondScrollSpeedY=$e[0]},$f._getMeshRenderSharedMaterialAlpha=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.alpha:0}return $d.meshRender.sharedMaterial.alpha},$f._setMeshRenderSharedMaterialAlpha=function($c,$d,$e){if($c){var $f=$c.transform._entity;$f&&($f.owner.meshRender.material.alpha=$e[0])}else $d.meshRender.material.alpha=$e[0]},$f._getMeshRenderSharedMaterialIntensity=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.intensity:0}return $d.meshRender.sharedMaterial.intensity},$f._setMeshRenderSharedMaterialIntensity=function($c,$d,$e){if($c){var $f=$c.transform._entity;$f&&($f.owner.meshRender.material.intensity=$e[0])}else $d.meshRender.material.intensity=$e[0]},$f._getMeshRenderSharedMaterialDetailTilingOffset=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return $d.meshRender.sharedMaterial.detailTilingOffset.elements},$f._setMeshRenderSharedMaterialDetailTilingOffset=function($c,$d,$e){var $f,$g;if($c){var $h=$c.transform._entity;$h&&(($g=($f=$h.owner.meshRender.material).detailTilingOffset).elements=$e,$f.detailTilingOffset=$g)}else($g=($f=$d.meshRender.material).detailTilingOffset).elements=$e,$f.detailTilingOffset=$g},$f._getMeshRenderSharedMaterialDissolveTilingOffset=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return $d.meshRender.sharedMaterial.dissolveTilingOffset.elements},$f._setMeshRenderSharedMaterialDissolveTilingOffset=function($c,$d,$e){var $f,$g;if($c){var $h=$c.transform._entity;$h&&(($g=($f=$h.owner.meshRender.material).dissolveTilingOffset).elements=$e,$f.dissolveTilingOffset=$g)}else($g=($f=$d.meshRender.material).dissolveTilingOffset).elements=$e,$f.dissolveTilingOffset=$g},$f._getMeshRenderSharedMaterialMaskTilingOffset=function($c,$d){if($c){var $e=$c.transform._entity;return $e?$e.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return $d.meshRender.sharedMaterial.maskTilingOffset.elements},$f._setMeshRenderSharedMaterialMaskTilingOffset=function($c,$d,$e){var $f,$g;if($c){var $h=$c.transform._entity;$h&&(($g=($f=$h.owner.meshRender.material).maskTilingOffset).elements=$e,$f.maskTilingOffset=$g)}else($g=($f=$d.meshRender.material).maskTilingOffset).elements=$e,$f.maskTilingOffset=$g},$f._propertyIDCounter=0,$f._propertyIndexDic={},$f._propertySetFuncs=[],$f._propertyGetFuncs=[],$f}(),$R=function(){function $c(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return $p($c,"laya.d3.animation.Keyframe"),$c}(),$S=function(){function $c(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return $p($c,"laya.d3.animation.KeyframeNode"),$c}(),$I=(function(){function $c(){this._tempVector30=new $id,this._tempVector31=new $id,this._tempVector32=new $id,this._a=new $id,this._b=new $id,this._c=new $id,this._d=new $id}$p($c,"laya.d3.core.glitter.SplineCurvePositionVelocity");var $d=$c.prototype;$d.Init=function($c,$d,$e,$f){$c.cloneTo(this._d),$d.cloneTo(this._c),$id.scale($c,2,this._a),$id.scale($e,2,this._tempVector30),$id.subtract(this._a,this._tempVector30,this._a),$id.add(this._a,$d,this._a),$id.add(this._a,$f,this._a),$id.scale($e,3,this._b),$id.scale($c,3,this._tempVector30),$id.subtract(this._b,this._tempVector30,this._b),$id.subtract(this._b,$f,this._b),$id.scale($d,2,this._tempVector30),$id.subtract(this._b,this._tempVector30,this._b)},$d.Slerp=function($c,$d){$id.scale(this._a,$c*$c*$c,this._tempVector30),$id.scale(this._b,$c*$c,this._tempVector31),$id.scale(this._c,$c,this._tempVector32),$id.add(this._tempVector30,this._tempVector31,$d),$id.add($d,this._tempVector32,$d),$id.add($d,this._d,$d)}}(),function(){function $M($c,$d,$e,$f){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=$c,this._h=$d,this._minHeight=$e,this._maxHeight=$f}$p($M,"laya.d3.core.HeightMap");var $c=$M.prototype;$c._inBounds=function($c,$d){return 0<=$c&&$c<this._h&&0<=$d&&$d<this._w},$c.getHeight=function($c,$d){return this._inBounds($c,$d)?this._datas[$c][$d]:NaN},$q(0,$c,"width",function(){return this._w}),$q(0,$c,"height",function(){return this._h}),$q(0,$c,"maxHeight",function(){return this._maxHeight}),$q(0,$c,"minHeight",function(){return this._minHeight}),$M.creatFromMesh=function($c,$d,$e,$f){for(var $g=[],$h=[],$i=$c.getSubMeshCount(),$j=0;$j<$i;$j++){for(var $k=$c.getSubMesh($j),$l=$k._getVertexBuffer(),$m=$l.getData(),$n=[],$o=0;$o<$m.length;$o+=$l.vertexDeclaration.vertexStride/4){var $p=new $id($m[$o+0],$m[$o+1],$m[$o+2]);$n.push($p)}$g.push($n);var $q=$k._getIndexBuffer();$h.push($q.getData())}var $r=$c.boundingBox,$s=$r.min.x,$t=$r.min.z,$u=$r.max.x,$v=$r.max.z,$w=$r.min.y,$x=$r.max.y,$y=$u-$s,$z=$v-$t,$A=$f.elements[0]=$y/($d-1),$B=$f.elements[1]=$z/($e-1),$C=new $M($d,$e,$w,$x),$D=$M._tempRay,$E=$D.direction.elements;$E[0]=0,$E[1]=-1,$E[2]=0;var $F=$x+.1;$D.origin.elements[1]=$F;for(var $G=0;$G<$e;$G++){var $H=$t+$G*$B;$C._datas[$G]=[];for(var $I=0;$I<$d;$I++){var $J=$s+$I*$A,$K=$D.origin.elements;$K[0]=$J,$K[2]=$H;var $L=$M._getPosition($D,$g,$h);$C._datas[$G][$I]=$L===Number.MAX_VALUE?NaN:$F-$L}}return $C},$M.createFromImage=function($c,$d,$e){for(var $f=$c.width,$g=$c.height,$h=new $M($f,$g,$d,$e),$i=($e-$d)/254,$j=$c.getPixels(),$k=0,$l=0;$l<$g;$l++)for(var $m=$h._datas[$l]=[],$n=0;$n<$f;$n++){var $o=$j[$k++],$p=$j[$k++],$q=$j[$k++],$r=$j[$k++];$m[$n]=255==$o&&255==$p&&255==$q&&255==$r?NaN:($o+$p+$q)/3*$i+$d}return $h},$M._getPosition=function($c,$d,$e){for(var $f=Number.MAX_VALUE,$g=0;$g<$d.length;$g++)for(var $h=$d[$g],$i=$e[$g],$j=0;$j<$i.length;$j+=3){var $k=$h[$i[$j+0]],$l=$h[$i[$j+1]],$m=$h[$i[$j+2]],$n=$qd.rayIntersectsTriangle($c,$k,$l,$m);!isNaN($n)&&$n<$f&&($f=$n)}return $f},$n($M,["_tempRay",function(){return this._tempRay=new $gd(new $id,new $id)}])}(),function(){function $g(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}$p($g,"laya.d3.core.Layer");var $c=$g.prototype;return $c._binarySearchIndex=function(){for(var $c=0,$d=$g._collsionTestList.length-1,$e=0;$c<=$d;){$e=Math.floor(($c+$d)/2);var $f=$g._collsionTestList[$e];if($f==this._number)return $e;$f>this._number?$d=$e-1:$c=$e+1}return $c},$c._addCollider=function($c){0===this._colliders.length&&$g._collsionTestList.splice(this._binarySearchIndex(),0,this._number),$c._isRigidbody?(this._colliders.unshift($c),this._nonRigidbodyOffset++):this._colliders.push($c)},$c._removeCollider=function($c){var $d=this._colliders.indexOf($c);$d<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice($d,1),0===this._colliders.length&&$g._collsionTestList.splice($g._collsionTestList.indexOf(this._number),1)},$q(0,$c,"number",function(){return this._number}),$q(0,$c,"visible",function(){return this._visible},function($c){this._visible=$c,$g._visibleLayers=$c?$g._visibleLayers|this.mask:$g._visibleLayers&~this.mask}),$q(0,$c,"mask",function(){return this._mask}),$q(1,$g,"visibleLayers",function(){return $g._visibleLayers},function($c){$g._visibleLayers=$c;for(var $d=0,$e=$g._layerList.length;$d<$e;$d++){var $f=$g._layerList[$d];$f._visible=0!=($f._mask&$g._visibleLayers)}}),$g.__init__=function(){$g._layerList.length=31;for(var $c=0;$c<31;$c++){var $d=new $g;$g._layerList[$c]=$d,0===$c?($d.name="Default Layer",$d.visible=!0):($d.name="Layer-"+$c,$d.visible=!1),$d._number=$c,$d._mask=Math.pow(2,$c)}$g.currentCreationLayer=$g._layerList[0]},$g.getLayerByNumber=function($c){if($c<0||30<$c)throw new Error("无法返回指定Layer，该number超出范围！");return $g._layerList[$c]},$g.getLayerByName=function($c){for(var $d=0;$d<31;$d++)if($g._layerList[$d].name===$c)return $g._layerList[$d];throw new Error("无法返回指定Layer,该name不存在")},$g.isVisible=function($c){return 0!=($c&$g._currentCameraCullingMask&$g._visibleLayers)},$g._layerList=[],$g._visibleLayers=2147483647,$g._collsionTestList=[],$g._currentCameraCullingMask=2147483647,$g.maxCount=31,$g.currentCreationLayer=null,$g}()),$J=(function(){function $c($c,$d,$e){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=$c,this._minCount=$d,this._maxCount=$e}$p($c,"laya.d3.core.particleShuriKen.module.Burst");var $d=$c.prototype;$x.imps($d,{"laya.d3.core.IClone":!0}),$d.cloneTo=function($c){var $d=$c;$d._time=this._time,$d._minCount=this._minCount,$d._maxCount=this._maxCount},$d.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$d,"time",function(){return this._time}),$q(0,$d,"minCount",function(){return this._minCount}),$q(0,$d,"maxCount",function(){return this._maxCount})}(),function(){function $c($c){this._color=null,this.enbale=!1,this._color=$c}$p($c,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var $d=$c.prototype;$d.cloneTo=function($c){var $d=$c;this._color.cloneTo($d._color),$d.enbale=this.enbale},$d.clone=function(){var $c;switch(this._color.type){case 0:$c=$L.createByConstant(this._color.constant.clone());break;case 1:$c=$L.createByGradient(this._color.gradient.clone());break;case 2:$c=$L.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:$c=$L.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var $d=new this.constructor($c);return $d.enbale=this.enbale,$d},$q(0,$d,"color",function(){return this._color})}(),function(){function $c(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}$p($c,"laya.d3.core.particleShuriKen.module.Emission");var $d=$c.prototype;$x.imps($d,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),$d._destroy=function(){this._bursts=null,this._destroyed=!0},$d.getBurstsCount=function(){return this._bursts.length},$d.getBurstByIndex=function($c){return this._bursts[$c]},$d.addBurst=function($c){var $d=this._bursts.length;if(0<$d)for(var $e=0;$e<$d;$e++)this._bursts[$e].time>$c.time&&this._bursts.splice($e,0,$c);this._bursts.push($c)},$d.removeBurst=function($c){var $d=this._bursts.indexOf($c);-1!==$d&&this._bursts.splice($d,1)},$d.removeBurstByIndex=function($c){this._bursts.splice($c,1)},$d.clearBurst=function(){this._bursts.length=0},$d.cloneTo=function($c){var $d=$c,$e=$d._bursts;$e.length=this._bursts.length;for(var $f=0,$g=this._bursts.length;$f<$g;$f++){var $h=$e[$f];$h?this._bursts[$f].cloneTo($h):$e[$f]=this._bursts[$f].clone()}$d._emissionRate=this._emissionRate,$d.enbale=this.enbale},$d.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$d,"destroyed",function(){return this._destroyed}),$q(0,$d,"emissionRate",function(){return this._emissionRate},function($c){if($c<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=$c})}(),function(){function $f(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}$p($f,"laya.d3.core.particleShuriKen.module.FrameOverTime");var $c=$f.prototype;return $x.imps($c,{"laya.d3.core.IClone":!0}),$c.cloneTo=function($c){var $d=$c;$d._type=this._type,$d._constant=this._constant,this._overTime.cloneTo($d._overTime),$d._constantMin=this._constantMin,$d._constantMax=this._constantMax,this._overTimeMin.cloneTo($d._overTimeMin),this._overTimeMax.cloneTo($d._overTimeMax)},$c.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$c,"frameOverTimeData",function(){return this._overTime}),$q(0,$c,"constant",function(){return this._constant}),$q(0,$c,"type",function(){return this._type}),$q(0,$c,"frameOverTimeDataMin",function(){return this._overTimeMin}),$q(0,$c,"constantMin",function(){return this._constantMin}),$q(0,$c,"frameOverTimeDataMax",function(){return this._overTimeMax}),$q(0,$c,"constantMax",function(){return this._constantMax}),$f.createByConstant=function($c){var $d=new $f;return $d._type=0,$d._constant=$c,$d},$f.createByOverTime=function($c){var $d=new $f;return $d._type=1,$d._overTime=$c,$d},$f.createByRandomTwoConstant=function($c,$d){var $e=new $f;return $e._type=2,$e._constantMin=$c,$e._constantMax=$d,$e},$f.createByRandomTwoOverTime=function($c,$d){var $e=new $f;return $e._type=3,$e._overTimeMin=$c,$e._overTimeMax=$d,$e},$f}()),$K=function(){function $l(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}$p($l,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var $c=$l.prototype;return $x.imps($c,{"laya.d3.core.IClone":!0}),$c.cloneTo=function($c){var $d=$c;$d._type=this._type,$d._separateAxes=this._separateAxes,$d._constant=this._constant,this._constantSeparate.cloneTo($d._constantSeparate),this._gradient.cloneTo($d._gradient),this._gradientX.cloneTo($d._gradientX),this._gradientY.cloneTo($d._gradientY),this._gradientZ.cloneTo($d._gradientZ),$d._constantMin=this._constantMin,$d._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($d._constantMinSeparate),this._constantMaxSeparate.cloneTo($d._constantMaxSeparate),this._gradientMin.cloneTo($d._gradientMin),this._gradientMax.cloneTo($d._gradientMax),this._gradientXMin.cloneTo($d._gradientXMin),this._gradientXMax.cloneTo($d._gradientXMax),this._gradientYMin.cloneTo($d._gradientYMin),this._gradientYMax.cloneTo($d._gradientYMax),this._gradientZMin.cloneTo($d._gradientZMin),this._gradientZMax.cloneTo($d._gradientZMax)},$c.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$c,"gradientZ",function(){return this._gradientZ}),$q(0,$c,"constant",function(){return this._constant}),$q(0,$c,"gradient",function(){return this._gradient}),$q(0,$c,"separateAxes",function(){return this._separateAxes}),$q(0,$c,"type",function(){return this._type}),$q(0,$c,"constantSeparate",function(){return this._constantSeparate}),$q(0,$c,"gradientX",function(){return this._gradientX}),$q(0,$c,"gradientY",function(){return this._gradientY}),$q(0,$c,"gradientW",function(){return this._gradientW}),$q(0,$c,"gradientMin",function(){return this._gradientMin}),$q(0,$c,"constantMin",function(){return this._constantMin}),$q(0,$c,"gradientMax",function(){return this._gradientMax}),$q(0,$c,"constantMax",function(){return this._constantMax}),$q(0,$c,"gradientWMin",function(){return this._gradientWMin}),$q(0,$c,"constantMinSeparate",function(){return this._constantMinSeparate}),$q(0,$c,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$q(0,$c,"gradientXMin",function(){return this._gradientXMin}),$q(0,$c,"gradientXMax",function(){return this._gradientXMax}),$q(0,$c,"gradientWMax",function(){return this._gradientWMax}),$q(0,$c,"gradientYMin",function(){return this._gradientYMin}),$q(0,$c,"gradientYMax",function(){return this._gradientYMax}),$q(0,$c,"gradientZMin",function(){return this._gradientZMin}),$q(0,$c,"gradientZMax",function(){return this._gradientZMax}),$l.createByConstant=function($c){var $d=new $l;return $d._type=0,$d._separateAxes=!1,$d._constant=$c,$d},$l.createByConstantSeparate=function($c){var $d=new $l;return $d._type=0,$d._separateAxes=!0,$d._constantSeparate=$c,$d},$l.createByGradient=function($c){var $d=new $l;return $d._type=1,$d._separateAxes=!1,$d._gradient=$c,$d},$l.createByGradientSeparate=function($c,$d,$e,$f){var $g=new $l;return $g._type=1,$g._separateAxes=!0,$g._gradientX=$c,$g._gradientY=$d,$g._gradientZ=$e,$g._gradientW=$f,$g},$l.createByRandomTwoConstant=function($c,$d){var $e=new $l;return $e._type=2,$e._separateAxes=!1,$e._constantMin=$c,$e._constantMax=$d,$e},$l.createByRandomTwoConstantSeparate=function($c,$d){var $e=new $l;return $e._type=2,$e._separateAxes=!0,$e._constantMinSeparate=$c,$e._constantMaxSeparate=$d,$e},$l.createByRandomTwoGradient=function($c,$d){var $e=new $l;return $e._type=3,$e._separateAxes=!1,$e._gradientMin=$c,$e._gradientMax=$d,$e},$l.createByRandomTwoGradientSeparate=function($c,$d,$e,$f,$g,$h,$i,$j){var $k=new $l;return $k._type=3,$k._separateAxes=!0,$k._gradientXMin=$c,$k._gradientXMax=$d,$k._gradientYMin=$e,$k._gradientYMax=$f,$k._gradientZMin=$g,$k._gradientZMax=$h,$k._gradientWMin=$i,$k._gradientWMax=$j,$k},$l}(),$L=function(){function $f(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}$p($f,"laya.d3.core.particleShuriKen.module.GradientColor");var $c=$f.prototype;return $x.imps($c,{"laya.d3.core.IClone":!0}),$c.cloneTo=function($c){var $d=$c;$d._type=this._type,this._constant.cloneTo($d._constant),this._constantMin.cloneTo($d._constantMin),this._constantMax.cloneTo($d._constantMax),this._gradient.cloneTo($d._gradient),this._gradientMin.cloneTo($d._gradientMin),this._gradientMax.cloneTo($d._gradientMax)},$c.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$c,"gradient",function(){return this._gradient}),$q(0,$c,"constant",function(){return this._constant}),$q(0,$c,"type",function(){return this._type}),$q(0,$c,"gradientMin",function(){return this._gradientMin}),$q(0,$c,"constantMin",function(){return this._constantMin}),$q(0,$c,"gradientMax",function(){return this._gradientMax}),$q(0,$c,"constantMax",function(){return this._constantMax}),$f.createByConstant=function($c){var $d=new $f;return $d._type=0,$d._constant=$c,$d},$f.createByGradient=function($c){var $d=new $f;return $d._type=1,$d._gradient=$c,$d},$f.createByRandomTwoConstant=function($c,$d){var $e=new $f;return $e._type=2,$e._constantMin=$c,$e._constantMax=$d,$e},$f.createByRandomTwoGradient=function($c,$d){var $e=new $f;return $e._type=3,$e._gradientMin=$c,$e._gradientMax=$d,$e},$f}(),$M=(function(){function $c(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}$p($c,"laya.d3.core.particleShuriKen.module.GradientDataColor");var $d=$c.prototype;$x.imps($d,{"laya.d3.core.IClone":!0}),$d.addAlpha=function($c,$d){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==$c&&($c=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=$c,this._alphaElements[this._alphaCurrentLength++]=$d):DEBUG},$d.addRGB=function($c,$d){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==$c&&($c=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=$c,this._rgbElements[this._rgbCurrentLength++]=$d.x,this._rgbElements[this._rgbCurrentLength++]=$d.y,this._rgbElements[this._rgbCurrentLength++]=$d.z):DEBUG},$d.cloneTo=function($c){var $d=$c,$e=0,$f=0;$d._alphaCurrentLength=this._alphaCurrentLength;var $g=$d._alphaElements;for($g.length=this._alphaElements.length,$e=0,$f=this._alphaElements.length;$e<$f;$e++)$g[$e]=this._alphaElements[$e];$d._rgbCurrentLength=this._rgbCurrentLength;var $h=$d._rgbElements;for($h.length=this._rgbElements.length,$e=0,$f=this._rgbElements.length;$e<$f;$e++)$h[$e]=this._rgbElements[$e]},$d.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$d,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),$q(0,$d,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function $c(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$p($c,"laya.d3.core.particleShuriKen.module.GradientDataInt");var $d=$c.prototype;$x.imps($d,{"laya.d3.core.IClone":!0}),$d.add=function($c,$d){this._currentLength<8?(6===this._currentLength&&1!==$c&&($c=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$c,this._elements[this._currentLength++]=$d):console.log("Warning:data count must lessEqual than 4")},$d.cloneTo=function($c){var $d=$c;$d._currentLength=this._currentLength;var $e=$d._elements;$e.length=this._elements.length;for(var $f=0,$g=this._elements.length;$f<$g;$f++)$e[$f]=this._elements[$f]},$d.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$d,"gradientCount",function(){return this._currentLength/2})}(),function(){function $c(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$p($c,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var $d=$c.prototype;$x.imps($d,{"laya.d3.core.IClone":!0}),$d.add=function($c,$d){this._currentLength<8?(6===this._currentLength&&1!==$c&&($c=1,DEBUG),this._elements[this._currentLength++]=$c,this._elements[this._currentLength++]=$d):DEBUG},$d.getKeyByIndex=function($c){return this._elements[2*$c]},$d.getValueByIndex=function($c){return this._elements[2*$c+1]},$d.getAverageValue=function(){for(var $c=0,$d=this._currentLength-2;$c<$d;$c+=2){this._elements[$c+1];this._elements[$c+3],this._elements[$c+2]-this._elements[$c]}return 0},$d.cloneTo=function($c){var $d=$c;$d._currentLength=this._currentLength;var $e=$d._elements;$e.length=this._elements.length;for(var $f=0,$g=this._elements.length;$f<$g;$f++)$e[$f]=this._elements[$f]},$d.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$d,"gradientCount",function(){return this._currentLength/2})}(),function(){function $c(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}$p($c,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var $d=$c.prototype;$x.imps($d,{"laya.d3.core.IClone":!0}),$d.add=function($c,$d){this._currentLength<8?(6===this._currentLength&&1!==$c&&($c=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$c,this._elements[this._currentLength++]=$d.x,this._elements[this._currentLength++]=$d.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},$d.cloneTo=function($c){var $d=$c;$d._currentLength=this._currentLength;var $e=$d._elements;$e.length=this._elements.length;for(var $f=0,$g=this._elements.length;$f<$g;$f++)$e[$f]=this._elements[$f]},$d.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$d,"gradientCount",function(){return this._currentLength/3})}(),function(){function $j(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$p($j,"laya.d3.core.particleShuriKen.module.GradientSize");var $c=$j.prototype;return $x.imps($c,{"laya.d3.core.IClone":!0}),$c.getMaxSizeInGradient=function(){var $c=0,$d=0,$e=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for($c=0,$d=this._gradientX.gradientCount;$c<$d;$c++)$e=Math.max($e,this._gradientX.getValueByIndex($c));for($c=0,$d=this._gradientY.gradientCount;$c<$d;$c++)$e=Math.max($e,this._gradientY.getValueByIndex($c))}else for($c=0,$d=this._gradient.gradientCount;$c<$d;$c++)$e=Math.max($e,this._gradient.getValueByIndex($c));break;case 1:$e=this._separateAxes?($e=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),$e=Math.max($e,this._constantMinSeparate.y),Math.max($e,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for($c=0,$d=this._gradientXMin.gradientCount;$c<$d;$c++)$e=Math.max($e,this._gradientXMin.getValueByIndex($c));for($c=0,$d=this._gradientXMax.gradientCount;$c<$d;$c++)$e=Math.max($e,this._gradientXMax.getValueByIndex($c));for($c=0,$d=this._gradientYMin.gradientCount;$c<$d;$c++)$e=Math.max($e,this._gradientYMin.getValueByIndex($c));for($c=0,$d=this._gradientZMax.gradientCount;$c<$d;$c++)$e=Math.max($e,this._gradientZMax.getValueByIndex($c))}else{for($c=0,$d=this._gradientMin.gradientCount;$c<$d;$c++)$e=Math.max($e,this._gradientMin.getValueByIndex($c));for($c=0,$d=this._gradientMax.gradientCount;$c<$d;$c++)$e=Math.max($e,this._gradientMax.getValueByIndex($c))}}return $e},$c.cloneTo=function($c){var $d=$c;$d._type=this._type,$d._separateAxes=this._separateAxes,this._gradient.cloneTo($d._gradient),this._gradientX.cloneTo($d._gradientX),this._gradientY.cloneTo($d._gradientY),this._gradientZ.cloneTo($d._gradientZ),$d._constantMin=this._constantMin,$d._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($d._constantMinSeparate),this._constantMaxSeparate.cloneTo($d._constantMaxSeparate),this._gradientMin.cloneTo($d._gradientMin),this._gradientMax.cloneTo($d._gradientMax),this._gradientXMin.cloneTo($d._gradientXMin),this._gradientXMax.cloneTo($d._gradientXMax),this._gradientYMin.cloneTo($d._gradientYMin),this._gradientYMax.cloneTo($d._gradientYMax),this._gradientZMin.cloneTo($d._gradientZMin),this._gradientZMax.cloneTo($d._gradientZMax)},$c.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$c,"gradientZ",function(){return this._gradientZ}),$q(0,$c,"gradient",function(){return this._gradient}),$q(0,$c,"separateAxes",function(){return this._separateAxes}),$q(0,$c,"type",function(){return this._type}),$q(0,$c,"gradientMin",function(){return this._gradientMin}),$q(0,$c,"constantMin",function(){return this._constantMin}),$q(0,$c,"gradientX",function(){return this._gradientX}),$q(0,$c,"gradientY",function(){return this._gradientY}),$q(0,$c,"gradientMax",function(){return this._gradientMax}),$q(0,$c,"constantMax",function(){return this._constantMax}),$q(0,$c,"constantMinSeparate",function(){return this._constantMinSeparate}),$q(0,$c,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$q(0,$c,"gradientXMin",function(){return this._gradientXMin}),$q(0,$c,"gradientXMax",function(){return this._gradientXMax}),$q(0,$c,"gradientYMin",function(){return this._gradientYMin}),$q(0,$c,"gradientYMax",function(){return this._gradientYMax}),$q(0,$c,"gradientZMin",function(){return this._gradientZMin}),$q(0,$c,"gradientZMax",function(){return this._gradientZMax}),$j.createByGradient=function($c){var $d=new $j;return $d._type=0,$d._separateAxes=!1,$d._gradient=$c,$d},$j.createByGradientSeparate=function($c,$d,$e){var $f=new $j;return $f._type=0,$f._separateAxes=!0,$f._gradientX=$c,$f._gradientY=$d,$f._gradientZ=$e,$f},$j.createByRandomTwoConstant=function($c,$d){var $e=new $j;return $e._type=1,$e._separateAxes=!1,$e._constantMin=$c,$e._constantMax=$d,$e},$j.createByRandomTwoConstantSeparate=function($c,$d){var $e=new $j;return $e._type=1,$e._separateAxes=!0,$e._constantMinSeparate=$c,$e._constantMaxSeparate=$d,$e},$j.createByRandomTwoGradient=function($c,$d){var $e=new $j;return $e._type=2,$e._separateAxes=!1,$e._gradientMin=$c,$e._gradientMax=$d,$e},$j.createByRandomTwoGradientSeparate=function($c,$d,$e,$f,$g,$h){var $i=new $j;return $i._type=2,$i._separateAxes=!0,$i._gradientXMin=$c,$i._gradientXMax=$d,$i._gradientYMin=$e,$i._gradientYMax=$f,$i._gradientZMin=$g,$i._gradientZMax=$h,$i},$j}()),$N=function(){function $j(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$p($j,"laya.d3.core.particleShuriKen.module.GradientVelocity");var $c=$j.prototype;return $x.imps($c,{"laya.d3.core.IClone":!0}),$c.cloneTo=function($c){var $d=$c;$d._type=this._type,this._constant.cloneTo($d._constant),this._gradientX.cloneTo($d._gradientX),this._gradientY.cloneTo($d._gradientY),this._gradientZ.cloneTo($d._gradientZ),this._constantMin.cloneTo($d._constantMin),this._constantMax.cloneTo($d._constantMax),this._gradientXMin.cloneTo($d._gradientXMin),this._gradientXMax.cloneTo($d._gradientXMax),this._gradientYMin.cloneTo($d._gradientYMin),this._gradientYMax.cloneTo($d._gradientYMax),this._gradientZMin.cloneTo($d._gradientZMin),this._gradientZMax.cloneTo($d._gradientZMax)},$c.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$c,"gradientZ",function(){return this._gradientZ}),$q(0,$c,"constant",function(){return this._constant}),$q(0,$c,"type",function(){return this._type}),$q(0,$c,"gradientXMax",function(){return this._gradientXMax}),$q(0,$c,"constantMin",function(){return this._constantMin}),$q(0,$c,"gradientX",function(){return this._gradientX}),$q(0,$c,"gradientY",function(){return this._gradientY}),$q(0,$c,"gradientXMin",function(){return this._gradientXMin}),$q(0,$c,"constantMax",function(){return this._constantMax}),$q(0,$c,"gradientYMin",function(){return this._gradientYMin}),$q(0,$c,"gradientYMax",function(){return this._gradientYMax}),$q(0,$c,"gradientZMin",function(){return this._gradientZMin}),$q(0,$c,"gradientZMax",function(){return this._gradientZMax}),$j.createByConstant=function($c){var $d=new $j;return $d._type=0,$d._constant=$c,$d},$j.createByGradient=function($c,$d,$e){var $f=new $j;return $f._type=1,$f._gradientX=$c,$f._gradientY=$d,$f._gradientZ=$e,$f},$j.createByRandomTwoConstant=function($c,$d){var $e=new $j;return $e._type=2,$e._constantMin=$c,$e._constantMax=$d,$e},$j.createByRandomTwoGradient=function($c,$d,$e,$f,$g,$h){var $i=new $j;return $i._type=3,$i._gradientXMin=$c,$i._gradientXMax=$d,$i._gradientYMin=$e,$i._gradientYMax=$f,$i._gradientZMin=$g,$i._gradientZMax=$h,$i},$j}(),$O=(function(){function $c($c){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=$c}$p($c,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var $d=$c.prototype;$x.imps($d,{"laya.d3.core.IClone":!0}),$d.cloneTo=function($c){var $d=$c;this._angularVelocity.cloneTo($d._angularVelocity),$d.enbale=this.enbale},$d.clone=function(){var $c;switch(this._angularVelocity.type){case 0:$c=this._angularVelocity.separateAxes?$K.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):$K.createByConstant(this._angularVelocity.constant);break;case 1:$c=this._angularVelocity.separateAxes?$K.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):$K.createByGradient(this._angularVelocity.gradient.clone());break;case 2:$c=this._angularVelocity.separateAxes?$K.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):$K.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:$c=this._angularVelocity.separateAxes?$K.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):$K.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var $d=new this.constructor($c);return $d.enbale=this.enbale,$d},$q(0,$d,"angularVelocity",function(){return this._angularVelocity})}(),function(){function $c(){this.enable=!1,this.randomDirection=!1}$p($c,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var $d=$c.prototype;return $x.imps($d,{"laya.d3.core.IClone":!0}),$d._getShapeBoundBox=function($c){throw new Error("BaseShape: must override it.")},$d._getSpeedBoundBox=function($c){throw new Error("BaseShape: must override it.")},$d.generatePositionAndDirection=function($c,$d,$e,$f){throw new Error("BaseShape: must override it.")},$d._calculateProceduralBounds=function($c,$d,$e){this._getShapeBoundBox($c);var $f=$c.min,$g=$c.max;$id.multiply($f,$d,$f),$id.multiply($g,$d,$g);var $h=new $Zc(new $id,new $id);this.randomDirection?($h.min=new $id(-1,-1,-1),$h.max=new $id(1,1,1)):this._getSpeedBoundBox($h);var $i=new $Zc(new $id,new $id),$j=$i.min,$k=$i.max;$id.scale($h.min,$e.y,$j),$id.scale($h.max,$e.y,$k),$id.add($c.min,$j,$j),$id.add($c.max,$k,$k),$id.min($c.min,$j,$c.min),$id.max($c.max,$j,$c.max);var $l=new $Zc(new $id,new $id),$m=$l.min,$n=$l.max;$id.scale($h.min,$e.x,$m),$id.scale($h.max,$e.x,$n),$id.min($l.min,$n,$j),$id.max($l.min,$n,$k),$id.min($c.min,$j,$c.min),$id.max($c.max,$j,$c.max)},$d.cloneTo=function($c){$c.enable=this.enable},$d.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$c}()),$T=function(){function $h(){}return $p($h,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),$h._randomPointUnitArcCircle=function($c,$d,$e){var $f=$d.elements,$g=NaN;$g=$e?$e.getFloat()*$c:Math.random()*$c,$f[0]=Math.cos($g),$f[1]=Math.sin($g)},$h._randomPointInsideUnitArcCircle=function($c,$d,$e){var $f=$d.elements;$h._randomPointUnitArcCircle($c,$d,$e);var $g=NaN;$g=$e?Math.pow($e.getFloat(),.5):Math.pow(Math.random(),.5),$f[0]=$f[0]*$g,$f[1]=$f[1]*$g},$h._randomPointUnitCircle=function($c,$d){var $e=$c.elements,$f=NaN;$f=$d?$d.getFloat()*Math.PI*2:Math.random()*Math.PI*2,$e[0]=Math.cos($f),$e[1]=Math.sin($f)},$h._randomPointInsideUnitCircle=function($c,$d){var $e=$c.elements;$h._randomPointUnitCircle($c);var $f=NaN;$f=$d?Math.pow($d.getFloat(),.5):Math.pow(Math.random(),.5),$e[0]=$e[0]*$f,$e[1]=$e[1]*$f},$h._randomPointUnitSphere=function($c,$d){var $e=$c.elements,$f=NaN,$g=NaN;$g=$d?($f=$e[2]=2*$d.getFloat()-1,$d.getFloat()*Math.PI*2):($f=$e[2]=2*Math.random()-1,Math.random()*Math.PI*2);var $h=Math.sqrt(1-$f*$f);$e[0]=$h*Math.cos($g),$e[1]=$h*Math.sin($g)},$h._randomPointInsideUnitSphere=function($c,$d){var $e=$c.elements;$h._randomPointUnitSphere($c);var $f=NaN;$f=$d?Math.pow($d.getFloat(),1/3):Math.pow(Math.random(),1/3),$e[0]=$e[0]*$f,$e[1]=$e[1]*$f,$e[2]=$e[2]*$f},$h._randomPointInsideHalfUnitBox=function($c,$d){var $e=$c.elements;$d?($e[0]=$d.getFloat()-.5,$e[1]=$d.getFloat()-.5,$e[2]=$d.getFloat()-.5):($e[0]=Math.random()-.5,$e[1]=Math.random()-.5,$e[2]=Math.random()-.5)},$h}(),$U=(function(){function $c($c){this._size=null,this.enbale=!1,this._size=$c}$p($c,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var $d=$c.prototype;$x.imps($d,{"laya.d3.core.IClone":!0}),$d.cloneTo=function($c){var $d=$c;this._size.cloneTo($d._size),$d.enbale=this.enbale},$d.clone=function(){var $c;switch(this._size.type){case 0:$c=this._size.separateAxes?$M.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):$M.createByGradient(this._size.gradient.clone());break;case 1:$c=this._size.separateAxes?$M.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):$M.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:$c=this._size.separateAxes?$M.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):$M.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var $d=new this.constructor($c);return $d.enbale=this.enbale,$d},$q(0,$d,"size",function(){return this._size})}(),function(){function $f(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}$p($f,"laya.d3.core.particleShuriKen.module.StartFrame");var $c=$f.prototype;return $x.imps($c,{"laya.d3.core.IClone":!0}),$c.cloneTo=function($c){var $d=$c;$d._type=this._type,$d._constant=this._constant,$d._constantMin=this._constantMin,$d._constantMax=this._constantMax},$c.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$c,"constant",function(){return this._constant}),$q(0,$c,"type",function(){return this._type}),$q(0,$c,"constantMin",function(){return this._constantMin}),$q(0,$c,"constantMax",function(){return this._constantMax}),$f.createByConstant=function($c){var $d=new $f;return $d._type=0,$d._constant=$c,$d},$f.createByRandomTwoConstant=function($c,$d){var $e=new $f;return $e._type=1,$e._constantMin=$c,$e._constantMax=$d,$e},$f}()),$V=(function(){function $c($c,$d){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new $hd(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=$c,this._startFrame=$d}$p($c,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var $d=$c.prototype;$x.imps($d,{"laya.d3.core.IClone":!0}),$d.cloneTo=function($c){var $d=$c;this.tiles.cloneTo($d.tiles),$d.type=this.type,$d.randomRow=this.randomRow,this._frame.cloneTo($d._frame),this._startFrame.cloneTo($d._startFrame),$d.cycles=this.cycles,$d.enableUVChannels=this.enableUVChannels,$d.enable=this.enable},$d.clone=function(){var $c,$d;switch(this._frame.type){case 0:$c=$J.createByConstant(this._frame.constant);break;case 1:$c=$J.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:$c=$J.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:$c=$J.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:$d=$U.createByConstant(this._startFrame.constant);break;case 1:$d=$U.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var $e=new this.constructor($c,$d);return this.tiles.cloneTo($e.tiles),$e.type=this.type,$e.randomRow=this.randomRow,$e.cycles=this.cycles,$e.enableUVChannels=this.enableUVChannels,$e.enable=this.enable,$e},$q(0,$d,"frame",function(){return this._frame}),$q(0,$d,"startFrame",function(){return this._startFrame})}(),function(){function $c($c){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=$c}$p($c,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var $d=$c.prototype;$x.imps($d,{"laya.d3.core.IClone":!0}),$d.cloneTo=function($c){var $d=$c;this._velocity.cloneTo($d._velocity),$d.enbale=this.enbale,$d.space=this.space},$d.clone=function(){var $c;switch(this._velocity.type){case 0:$c=$N.createByConstant(this._velocity.constant.clone());break;case 1:$c=$N.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:$c=$N.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:$c=$N.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var $d=new this.constructor($c);return $d.enbale=this.enbale,$d.space=this.space,$d},$q(0,$d,"velocity",function(){return this._velocity})}(),function(){function $c(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new $od,this._vb=$Od.create($c._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=$Nd.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=$Ld.nameKey.getID("LINE"),this._shaderCompile=$Ad._preCompileShader[this._sharderNameID]}$p($c,"laya.d3.core.PhasorSpriter3D");var $d=$c.prototype;return $d.line=function($c,$d,$e,$f){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($c.x,$c.y,$c.z,$d.x,$d.y,$d.z,$d.w),this.addVertex($e.x,$e.y,$e.z,$f.x,$f.y,$f.z,$f.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},$d.circle=function($c,$d,$e,$f,$g,$h){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*$d,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/$d,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*$c,Math.cos(this._tempNumver0)*$c,0,$e,$f,$g,$h),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},$d.plane=function($c,$d,$e,$f,$g,$h,$i,$j,$k){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=$f/2,this._tempNumver1=$g/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($c-this._tempNumver0,$d+this._tempNumver1,$e,$h,$i,$j,$k),this.addVertex($c+this._tempNumver0,$d+this._tempNumver1,$e,$h,$i,$j,$k),this.addVertex($c-this._tempNumver0,$d-this._tempNumver1,$e,$h,$i,$j,$k),this.addVertex($c+this._tempNumver0,$d-this._tempNumver1,$e,$h,$i,$j,$k),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},$d.box=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=$f/2,this._tempNumver1=$g/2,this._tempNumver2=$h/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($c-this._tempNumver0,$d+this._tempNumver1,$e+this._tempNumver2,$i,$j,$k,$l),this.addVertex($c+this._tempNumver0,$d+this._tempNumver1,$e+this._tempNumver2,$i,$j,$k,$l),this.addVertex($c-this._tempNumver0,$d-this._tempNumver1,$e+this._tempNumver2,$i,$j,$k,$l),this.addVertex($c+this._tempNumver0,$d-this._tempNumver1,$e+this._tempNumver2,$i,$j,$k,$l),this.addVertex($c+this._tempNumver0,$d+this._tempNumver1,$e-this._tempNumver2,$i,$j,$k,$l),this.addVertex($c-this._tempNumver0,$d+this._tempNumver1,$e-this._tempNumver2,$i,$j,$k,$l),this.addVertex($c+this._tempNumver0,$d-this._tempNumver1,$e-this._tempNumver2,$i,$j,$k,$l),this.addVertex($c-this._tempNumver0,$d-this._tempNumver1,$e-this._tempNumver2,$i,$j,$k,$l),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},$d.cone=function($c,$d,$e,$f,$g,$h,$i){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*$e+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*$e>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/$e,this.addVertexIndex(0,$d,0,$f,$g,$h,$i,this._tempUint0),this.addVertexIndex(0,0,0,$f,$g,$h,$i,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<$e;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex($c*this._tempNumver2,0,$c*this._tempNumver3,$f,$g,$h,$i,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==$e-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex($c*this._tempNumver2,0,$c*this._tempNumver3,$f,$g,$h,$i,this._tempUint0+(this._tempInt0+$e)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==$e-1?this.addIndexes(this._tempUint1+$e+2):this.addIndexes(this._tempUint1+this._tempInt0+$e+1),this.addIndexes(this._tempUint1+this._tempInt0+$e),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},$d.boundingBoxLine=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($c,$g,$h,$i,$j,$k,$l),this.addVertex($f,$g,$h,$i,$j,$k,$l),this.addVertex($c,$d,$h,$i,$j,$k,$l),this.addVertex($f,$d,$h,$i,$j,$k,$l),this.addVertex($f,$g,$e,$i,$j,$k,$l),this.addVertex($c,$g,$e,$i,$j,$k,$l),this.addVertex($f,$d,$e,$i,$j,$k,$l),this.addVertex($c,$d,$e,$i,$j,$k,$l),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},$d.addVertex=function($c,$d,$e,$f,$g,$h,$i){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=$c,this._vbData[this._posInVBData+1]=$d,this._vbData[this._posInVBData+2]=$e,this._vbData[this._posInVBData+3]=$f,this._vbData[this._posInVBData+4]=$g,this._vbData[this._posInVBData+5]=$h,this._vbData[this._posInVBData+6]=$i,this._posInVBData+=this._floatSizePerVer,this},$d.addVertexIndex=function($c,$d,$e,$f,$g,$h,$i,$j){return this._hasBegun||this.addVertexIndexException(),this._vbData[$j]=$c,this._vbData[$j+1]=$d,this._vbData[$j+2]=$e,this._vbData[$j+3]=$f,this._vbData[$j+4]=$g,this._vbData[$j+5]=$h,this._vbData[$j+6]=$i,($j+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=$j),this},$d.addIndexes=function($c){var $d=arguments;this._hasBegun||this.addVertexIndexException();for(var $e=0;$e<$d.length;$e++)this._ibData[this._posInIBData]=$d[$e],this._posInIBData++;return this},$d.begin=function($c,$d){return this._hasBegun&&this.beginException0(),1!==$c&&4!==$c&&this.beginException1(),this._primitiveType=$c,this._camera=$d,this._hasBegun=!0,this},$d.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},$d.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes($c._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),$A.drawCall++,$F.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},$d.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},$d.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},$d.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},$d.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},$d.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},$d.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(28,[new $ic(0,"vector3",0),new $ic(12,"vector4",1)])}]),$c}()),$W=function(){function $c(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++$c._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new $od}$p($c,"laya.d3.core.render.RenderElement");var $d=$c.prototype;return $d.getDynamicBatchBakedVertexs=function($c){for(var $d=this._renderObj._getVertexBuffer($c),$e=$d.getData().slice(),$f=$d.vertexDeclaration,$g=$f.getVertexElementByUsage(0).offset/4,$h=$f.getVertexElementByUsage(3).offset/4,$i=this._sprite3D.transform,$j=$i.worldMatrix,$k=$i.rotation,$l=$f.vertexStride/4,$m=0,$n=$e.length;$m<$n;$m+=$l){var $o=$m+$g,$p=$m+$h;$sd.transformVector3ArrayToVector3ArrayCoordinate($e,$o,$j,$e,$o),$sd.transformVector3ArrayByQuat($e,$p,$k,$e,$p)}return $e},$d.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},$d._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},$q(0,$d,"id",function(){return this._id}),$q(0,$d,"renderObj",function(){return this._renderObj},function($c){this._renderObj!==$c&&(this._renderObj=$c)}),$c._uniqueIDCounter=0,$c}(),$X=function(){function $d($c){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++$d._uniqueIDCounter,this._needSort=!1,this._scene=$c,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}$p($d,"laya.d3.core.render.RenderQueue");var $c=$d.prototype;return $c._sortOpaqueFunc=function($c,$d){if($c._render&&$d._render){var $e=$c._material.renderQueue-$d._material.renderQueue;return 0==$e?$c._render._distanceForSort-$d._render._distanceForSort:$e}return 0},$c._sortAlphaFunc=function($c,$d){if($c._render&&$d._render){var $e=$c._material.renderQueue-$d._material.renderQueue;return 0==$e?$d._render._distanceForSort-$c._render._distanceForSort:$e}return 0},$c._begainRenderElement=function($c,$d,$e){return!!$d._beforeRender($c)},$c._sortAlpha=function($c){$d._cameraPosition=$c,this._finalElements.sort(this._sortAlphaFunc)},$c._sortOpaque=function($c){$d._cameraPosition=$c,this._finalElements.sort(this._sortOpaqueFunc)},$c._preRender=function($c){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},$c._render=function($c,$d){for(var $e,$f,$g,$h,$i,$j,$k=$A.loopCount,$l=this._scene,$m=$c.camera,$n=($m.id,!1),$o=0,$p=this._finalElements.length;$o<$p;$o++){var $q,$r,$s,$t=this._finalElements[$o];if(null!=$t._onPreRenderFunction&&$t._onPreRenderFunction.call($t._sprite3D,$c),0===$t._type){if($c.owner=$s=$t._sprite3D,$c.renderElement=$t,$s._preRenderUpdateComponents($c),$q=$t.renderObj,$r=$t._material,this._begainRenderElement($c,$q,$r)){if($e=$q._getVertexBuffers(),!($g=($f=$q._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[$f.id]){this._errorRecord[$f.id]=1;var $u="vertexBuffer:"+("("+$f._destroyed+","+$f._released+","+$f._referenceCount+","+$f._buffer+")")+", material:"+($r?$r.__className+"("+$r._destroyed+","+$r._released+")":"null")+", owner:"+($s?$s.__className+"("+$s._destroyed+","+$s._activeInHierarchy+","+$s._displayedInStage+")":"null")+", renderObj:"+($q?$q.__className+"("+$q._destroyed+","+$q._released+","+$q._referenceCount+")":"")+", parent:, url:"+($s?$s.url:"")+", disposeStack:"+$f.disposeStack;$x.recordError("报错：unknown vertexDeclaration  "+$u)}continue}if($n=($h=$c._shader=$r._getShader($l._shaderDefineValue,$g.shaderDefineValue,$s._shaderDefineValue)).bind()||$k!==$h._uploadLoopCount,$e){if($h._uploadVertexBuffer!==$e||$n){for(var $v=0;$v<$e.length;$v++){var $w=$e[$v];$h.uploadAttributesX($w.vertexDeclaration.shaderValues.data,$w)}$h._uploadVertexBuffer=$e}}else($h._uploadVertexBuffer!==$f||$n)&&($h.uploadAttributes($g.shaderValues.data,null),$h._uploadVertexBuffer=$f);($h._uploadScene!==$l||$n)&&($h.uploadSceneUniforms($l._shaderValues.data),$h._uploadScene=$l),($m!==$h._uploadCamera||$h._uploadSprite3D!==$s||$n)&&($h.uploadSpriteUniforms($s._shaderValues.data),$h._uploadSprite3D=$s),($m!==$h._uploadCamera||$n)&&($h.uploadCameraUniforms($m._shaderValues.data),$h._uploadCamera=$m),($h._uploadMaterial!==$r||$n)&&($r._upload(),$h._uploadMaterial=$r),$i!==$r?($r._setRenderStateBlendDepth(),$r._setRenderStateFrontFace($d,$s.transform),$i=$r,$j=$s):$j!==$s&&($r._setRenderStateFrontFace($d,$s.transform),$j=$s),$q._render($c),$h._uploadLoopCount=$k}$s._postRenderUpdateComponents($c)}else if(2===$t._type){$t.renderObj;$c.owner=$s=$t._sprite3D,$c.renderElement=$t,$c._batchIndexStart=$t._tempBatchIndexStart,$c._batchIndexEnd=$t._tempBatchIndexEnd,$q=$t.renderObj,$r=$t._material,this._begainRenderElement($c,$q,$r)&&($g=($f=$q._getVertexBuffer(0)).vertexDeclaration,$n=($h=$c._shader=$r._getShader($l._shaderDefineValue,$g.shaderDefineValue,$s._shaderDefineValue)).bind()||$k!==$h._uploadLoopCount,($h._uploadVertexBuffer!==$f||$n)&&($h.uploadAttributes($g.shaderValues.data,null),$h._uploadVertexBuffer=$f),($h._uploadScene!==$l||$n)&&($h.uploadSceneUniforms($l._shaderValues.data),$h._uploadScene=$l),($m!==$h._uploadCamera||$h._uploadSprite3D!==$s||$n)&&($h.uploadSpriteUniforms($s._shaderValues.data),$h._uploadSprite3D=$s),($m!==$h._uploadCamera||$n)&&($h.uploadCameraUniforms($m._shaderValues.data),$h._uploadCamera=$m),($h._uploadMaterial!==$r||$n)&&($r._upload(),$h._uploadMaterial=$r),$i!==$r?($r._setRenderStateBlendDepth(),$r._setRenderStateFrontFace($d,$s.transform),$i=$r,$j=$s):$j!==$s&&($r._setRenderStateFrontFace($d,$s.transform),$j=$s),$q._render($c),$h._uploadLoopCount=$k)}}},$c._renderShadow=function($c,$d){for(var $e,$f,$g,$h,$i,$j=$A.loopCount,$k=this._scene,$l=$c.camera,$m=!1,$n=0,$o=this._finalElements.length;$n<$o;$n++){var $p,$q,$r,$s=this._finalElements[$n];0===$s._type&&($c.owner=$r=$s._sprite3D,$d||$r._projectionViewWorldUpdateCamera===$l&&$r._projectionViewWorldUpdateLoopCount===$A.loopCount||($r._render._renderUpdate($c._projectionViewMatrix),$r._projectionViewWorldUpdateLoopCount=$A.loopCount,$r._projectionViewWorldUpdateCamera=$l),$c.renderElement=$s,$r._preRenderUpdateComponents($c),$p=$s.renderObj,$q=$s._material,this._begainRenderElement($c,$p,null)&&($f=($e=$p._getVertexBuffer(0)).vertexDeclaration,$m=($g=$c._shader=$q._getShader($k._shaderDefineValue,$f.shaderDefineValue,$r._shaderDefineValue)).bind()||$j!==$g._uploadLoopCount,($g._uploadVertexBuffer!==$e||$m)&&($g.uploadAttributes($f.shaderValues.data,null),$g._uploadVertexBuffer=$e),($l!==$g._uploadCamera||$g._uploadSprite3D!==$r||$m)&&($g.uploadSpriteUniforms($r._shaderValues.data),$g._uploadSprite3D=$r),($l!==$g._uploadCamera||$m)&&($g.uploadCameraUniforms($l._shaderValues.data),$g._uploadCamera=$l),($g._uploadMaterial!==$q||$m)&&($q._upload(),$g._uploadMaterial=$q),$g._uploadRenderElement,$h!==$q?($q._setRenderStateFrontFace(!1,$r.transform),$h=$q,$i=$r):$i!==$r&&($q._setRenderStateFrontFace(!1,$r.transform),$i=$r),$p._render($c),$g._uploadLoopCount=$j),$r._postRenderUpdateComponents($c))}},$c._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},$c._addRenderElement=function($c){this._renderElements.push($c),this._needSort=!0},$c._addDynamicBatchElement=function($c){this._dynamicBatchCombineRenderElements.push($c)},$q(0,$c,"id",function(){return this._id}),$d._uniqueIDCounter=0,$d._cameraPosition=null,$d}(),$Y=function(){function $c(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return $p($c,"laya.d3.core.render.RenderState"),$c.clientWidth=0,$c.clientHeight=0,$c}(),$Z=function(){function $i($c,$d){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new $_c(new $id,0),this._corners=[new $id,new $id,new $id,new $id,new $id,new $id,new $id,new $id],this._boundingBoxCenter=new $id,this._children=$f(8),this._objects=[],this._tempBoundBoxCorners=[new $id,new $id,new $id,new $id,new $id,new $id,new $id,new $id],this._scene=$c,this._currentDepth=$d}$p($i,"laya.d3.core.scene.OctreeNode");var $c=$i.prototype;return $x.imps($c,{"laya.d3.core.scene.ITreeNode":!0}),$c.init=function($c,$d){var $e=new $id,$f=new $id;$id.scale($d,-.5,$e),$id.scale($d,.5,$f),$id.add($e,$c,$e),$id.add($f,$c,$f),this.exactBox=new $Zc($e,$f),this.relaxBox=new $Zc($e,$f)},$c.addTreeNode=function($c){1===Collision.boxContainsBox(this._relaxBox,$c.boundingBox)?this.addNodeDown($c,0):this.addObject($c)},$c.addChild=function($c){var $d=this._children[$c];if(null==$d){$d=new $i(this._scene,this._currentDepth+1),(this._children[$c]=$d)._parent=this,$id.subtract(this._exactBox.max,this._exactBox.min,$i.tempSize),$id.multiply($i.tempSize,$i._octreeSplit[$c],$i.tempCenter),$id.add(this._exactBox.min,$i.tempCenter,$i.tempCenter),$id.scale($i.tempSize,.25,$i.tempSize);var $e=new $id,$f=new $id;$id.subtract($i.tempCenter,$i.tempSize,$e),$id.add($i.tempCenter,$i.tempSize,$f),$d.exactBox=new $Zc($e,$f),$id.scale($i.tempSize,$i.relax,$i.tempSize);var $g=new $id,$h=new $id;$id.subtract($i.tempCenter,$i.tempSize,$g),$id.add($i.tempCenter,$i.tempSize,$h),$d.relaxBox=new $Zc($g,$h)}return $d},$c.addObject=function($c){($c._treeNode=this)._objects.push($c)},$c.removeObject=function($c){if($c._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var $d=this._objects.indexOf($c);return-1!==$d&&(this._objects.splice($d,1),!0)},$c.clearObject=function(){this._objects.length=0},$c.addNodeUp=function($c,$d){this._parent&&1!==Collision.boxContainsBox(this._exactBox,$c.boundingBox)?this._parent.addNodeUp($c,$d-1):this.addNodeDown($c,$d)},$c.addNodeDown=function($c,$d){if($d<this._scene.treeLevel){var $e=this.inChildIndex($c.boundingBoxCenter),$f=this.addChild($e);1===Collision.boxContainsBox($f._relaxBox,$c.boundingBox)?$f.addNodeDown($c,++$d):this.addObject($c)}else this.addObject($c)},$c.inChildIndex=function($c){return 4*($c.z<this._boundingBoxCenter.z?0:1)+2*($c.y<this._boundingBoxCenter.y?0:1)+($c.x<this._boundingBoxCenter.x?0:1)},$c.updateObject=function($c){1===Collision.boxContainsBox(this._relaxBox,$c.boundingBox)?(this.removeObject($c),$c._treeNode=null,this.addNodeDown($c,this._currentDepth)):this._parent&&(this.removeObject($c),$c._treeNode=null,this._parent.addNodeUp($c,this._currentDepth-1))},$c.cullingObjects=function($c,$d,$e,$f,$g){var $h,$i=0,$j=0,$k=0,$l=this._scene._dynamicBatchManager;for($i=0,$h=this._objects.length;$i<$h;$i++){var $m=this._objects[$i];if($I.isVisible($m._owner.layer.mask)&&$m.enable){if($d&&($A.treeSpriteCollision+=1,0===$c.containsBoundSphere($m.boundingSphere)))continue;$m._renderUpdate($g),$m._distanceForSort=$id.distance($m.boundingSphere.center,$f)+$m.sortingFudge;var $n=$m._renderElements;for($j=0,$k=$n.length;$j<$k;$j++){var $o=$n[$j],$p=$o._staticBatch;if($p&&$p._material===$o._material)$p._addBatchRenderElement($o);else{var $q=$o.renderObj;$q.triangleCount<10&&1===$q._vertexBufferCount&&$q._getIndexBuffer()&&$o._material.renderQueue<2&&$o._canDynamicBatch&&!$m._owner.isStatic?$l._addPrepareRenderElement($o):this._scene.getRenderQueue($o._material.renderQueue)._addRenderElement($o)}}}}for($i=0;$i<8;$i++){var $r=this._children[$i];if(null!=$r){var $s=$d;if($d){var $t=$c.containsBoundBox($r._relaxBox);if($A.treeNodeCollision+=1,0===$t)continue;$s=2===$t}$r.cullingObjects($c,$s,$e,$f,$g)}}},$c.cullingShadowObjects=function($c,$d,$e,$f,$g){var $h,$i=0,$j=0,$k=0;this._scene._dynamicBatchManager;for($i=0,$h=this._objects.length;$i<$h;$i++){var $l=this._objects[$i];if($l.castShadow&&$I.isVisible($l._owner.layer.mask)&&$l.enable){if($e&&0===$c[0].containsBoundSphere($l.boundingSphere))continue;for(var $m=1,$n=$c.length;$m<$n;$m++){var $o=$d[$m-1];if(0!==$c[$m].containsBoundSphere($l.boundingSphere)){var $p=$l._renderElements;for($j=0,$k=$p.length;$j<$k;$j++)$o._addRenderElement($p[$j])}}}}for($i=0;$i<8;$i++){var $q=this._children[$i];if(null!=$q){var $r=$e;if($e){var $s=$c[0].containsBoundBox($q._relaxBox);if(0===$s)continue;$r=2===$s}$q.cullingShadowObjects($c,$d,$r,$f,$g)}}},$c.cullingShadowObjectsOnePSSM=function($c,$d,$e,$f,$g,$h){var $i,$j=$d[0],$k=0,$l=0,$m=0;for($k=0,$i=this._objects.length;$k<$i;$k++){var $n=this._objects[$k];if($n.castShadow&&$I.isVisible($n._owner.layer.mask)&&$n.enable){if($f&&0===$c.containsBoundSphere($n.boundingSphere))continue;$n._renderUpdate($e);var $o=$n._renderElements;for($l=0,$m=$o.length;$l<$m;$l++)$j._addRenderElement($o[$l])}}for($k=0;$k<8;$k++){var $p=this._children[$k];if(null!=$p){var $q=$f;if($f){var $r=$c.containsBoundBox($p._relaxBox);if(0===$r)continue;$q=2===$r}$p.cullingShadowObjectsOnePSSM($c,$d,$e,$q,$g,$h)}}},$c.renderBoudingBox=function($c){this._renderBoudingBox($c);for(var $d=0;$d<8;++$d){var $e=this._children[$d];$e&&$e.renderBoudingBox($c)}},$c.buildAllChild=function($c){if($c<this._scene.treeLevel)for(var $d=0;$d<8;$d++){this.addChild($d).buildAllChild($c+1)}},$c._renderBoudingBox=function($c){},$q(0,$c,"exactBox",function(){return this._exactBox},function($c){this._exactBox=$c,$id.add($c.min,$c.max,this._boundingBoxCenter),$id.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),$q(0,$c,"relaxBox",function(){return this._relaxBox},function($c){(this._relaxBox=$c).getCorners(this._corners),$_c.createfromPoints(this._corners,this._boundingSphere)}),$i.debugMode=!1,$i.relax=1.15,$i.CHILDNUM=8,$n($i,["tempVector0",function(){return this.tempVector0=new $id},"tempSize",function(){return this.tempSize=new $id},"tempCenter",function(){return this.tempCenter=new $id},"_octreeSplit",function(){return this._octreeSplit=[new $id(.25,.25,.25),new $id(.75,.25,.25),new $id(.25,.75,.25),new $id(.75,.75,.25),new $id(.25,.25,.75),new $id(.75,.25,.75),new $id(.25,.75,.75),new $id(.75,.75,.75)]}]),$i}(),$$=(function(){function $c(){}$p($c,"laya.d3.core.scene.SceneManager")}(),function(){function $c($c,$d,$e,$f){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===$c&&($c=1),void 0===$d&&($d=1),void 0===$e&&($e=1),void 0===$f&&($f=1),this._r=$c,this._g=$d,this._b=$e,this._a=$f}return $p($c,"laya.d3.core.trail.module.Color",null,"Color$1"),$c.prototype.cloneTo=function($c){$c._r=this._r,$c._g=this._g,$c._b=this._b,$c._a=this._a},$n($c,["RED",function(){return this.RED=new $c(1,0,0,1)},"GREEN",function(){return this.GREEN=new $c(0,1,0,1)},"BLUE",function(){return this.BLUE=new $c(0,0,1,1)},"CYAN",function(){return this.CYAN=new $c(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new $c(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new $c(1,0,1,1)},"GRAY",function(){return this.GRAY=new $c(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new $c(1,1,1,1)},"BLACK",function(){return this.BLACK=new $c(0,0,0,1)}]),$c}()),$_=(function(){function $c(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}$p($c,"laya.d3.core.trail.module.Gradient");var $d=$c.prototype;$d.setKeys=function($c,$d){var $e,$f;this._colorKeys=$c;for(var $g=this.index=0;$g<$c.length;$g++){var $h=($e=$c[$g]).color;this._colorKeyData[this.index++]=$h._r,this._colorKeyData[this.index++]=$h._g,this._colorKeyData[this.index++]=$h._b,this._colorKeyData[this.index++]=$e.time}this._alphaKeys=$d;for(var $i=this.index=0;$i<$d.length;$i++)$f=$d[$i],this._alphaKeyData[this.index++]=$f.alpha,this._alphaKeyData[this.index++]=$f.time},$d.cloneTo=function($c){var $d=0,$e=0,$f=this.colorKeys,$g=[];for($d=0,$e=$f.length;$d<$e;$d++){var $h=new $a;$f[$d].cloneTo($h),$g.push($h)}var $i=this.alphaKeys,$j=[];for($d=0,$e=$i.length;$d<$e;$d++){var $k=new $_;$i[$d].cloneTo($k),$j.push($k)}$c.setKeys($g,$j)},$q(0,$d,"mode",function(){return this._mode},function($c){this._mode=$c}),$q(0,$d,"colorKeys",function(){return this._colorKeys},function($c){this._colorKeys=$c;for(var $d=this.index=0;$d<$c.length;$d++){var $e=$c[$d],$f=$e.color;this._colorKeyData[this.index++]=$f._r,this._colorKeyData[this.index++]=$f._g,this._colorKeyData[this.index++]=$f._b,this._colorKeyData[this.index++]=$e.time}}),$q(0,$d,"alphaKeys",function(){return this._alphaKeys},function($c){this._alphaKeys=$c;for(var $d=this.index=0;$d<$c.length;$d++){var $e=$c[$d];this._alphaKeyData[this.index++]=$e.alpha,this._alphaKeyData[this.index++]=$e.time}})}(),function(){function $c($c,$d){this._alpha=NaN,this._time=NaN,void 0===$c&&($c=0),void 0===$d&&($d=0),this._alpha=$c,this._time=$d}$p($c,"laya.d3.core.trail.module.GradientAlphaKey");var $d=$c.prototype;return $d.cloneTo=function($c){$c.alpha=this.alpha,$c.time=this.time},$q(0,$d,"alpha",function(){return this._alpha},function($c){this._alpha=$c}),$q(0,$d,"time",function(){return this._time},function($c){this._time=$c}),$c}()),$a=function(){function $c($c,$d){this._color=null,this._time=NaN,void 0===$d&&($d=0),this._color=$c||new $$,this._time=$d}$p($c,"laya.d3.core.trail.module.GradientColorKey");var $d=$c.prototype;return $d.cloneTo=function($c){this.color.cloneTo($c.color),$c.time=this.time},$q(0,$d,"color",function(){return this._color},function($c){this._color=$c}),$q(0,$d,"time",function(){return this._time},function($c){this._time=$c}),$c}(),$b=(function(){function $c(){}$p($c,"laya.d3.core.trail.module.GradientMode"),$c.Blend=0,$c.Fixed=1}(),function(){function $c(){}$p($c,"laya.d3.core.trail.module.TextureMode"),$c.Stretch=0,$c.Tile=1}(),function(){function $c(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}$p($c,"laya.d3.core.trail.module.TrailKeyFrame"),$c.prototype.cloneTo=function($c){$c.time=this.time,$c.inTangent=this.inTangent,$c.outTangent=this.outTangent,$c.value=this.value}}(),function(){function $d($c){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new $id,this._curPosition=new $id,this._delVector3=new $id,this._lastFixedVertexPosition=new $id,this._pointAtoBVector3=new $id,this._pointA=new $id,this._pointB=new $id,this._owner=$c,this._id=$d.renderElementCount++,0==this._id?$c._owner.transform.position.cloneTo(this._lastPosition):$c._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new $Od($b.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new $Od($b.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}$p($d,"laya.d3.core.trail.TrailRenderElement");var $c=$d.prototype;$x.imps($c,{"laya.d3.core.render.IRenderable":!0}),$c._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},$c._addTrailByFirstPosition=function($c,$d){$id.subtract($d,$c,this._delVector3),$id.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$id.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$id.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition($c),$c.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},$c._addTrailByNextPosition=function($c){$id.subtract($c,this._lastFixedVertexPosition,this._delVector3),$id.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$id.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$id.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=$id.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=$ac.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition($c),$c.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition($c),this._virtualVerticesCount=2)},$c._updateVerticesByPosition=function($c){this._pointe=$c.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},$c._updateVertexBuffer2=function(){var $c,$d=0,$e=0,$f=0;for($f=0,$c=(this._verticesCount+this._virtualVerticesCount)/2;$f<$c;$f++)$e=0==this._owner.textureMode?(this._VerticesToTailLength[$f]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[$f],this._vertices2[$d++]=1-$e,this._vertices2[$d++]=1-$e;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},$c._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},$c._updateDisappear=function(){var $c,$d=0;for($d=this._curDisappearIndex,$c=(this._verticesCount+this._virtualVerticesCount)/2;$d<$c;$d++)this._owner._curtime-this._everyGroupVertexBirthTime[$d]>=this._owner.time+$ac.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},$c._beforeRender=function($c){return this._camera=$c.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),$id.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},$c._render=function($c){this._isDead||($F.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),$A.drawCall++,$A.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},$c._getVertexBuffer=function($c){return void 0===$c&&($c=0),0===$c?this._vertexBuffer1:1===$c?this._vertexBuffer2:null},$c._getVertexBuffers=function(){return this._vertexBuffers},$c._getIndexBuffer=function(){return null},$c.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},$c._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},$q(0,$c,"_vertexBufferCount",function(){return this._vertexBuffers.length}),$q(0,$c,"triangleCount",function(){return 0}),$d.renderElementCount=0}(),function(){function $c(){}$p($c,"laya.d3.core.trail.VertexTrail");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration1}),$q(1,$c,"vertexDeclaration1",function(){return $c._vertexDeclaration1}),$q(1,$c,"vertexDeclaration2",function(){return $c._vertexDeclaration2}),$n($c,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new $hc(32,[new $ic(0,"vector3",0),new $ic(12,"vector3",41),new $ic(24,"single",33),new $ic(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new $hc(4,[new $ic(0,"single",38)])}]),$c}()),$cc=function(){function $w($c){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=$c}$p($w,"laya.d3.graphics.DynamicBatch");var $c=$w.prototype;return $x.imps($c,{"laya.d3.core.render.IRenderable":!0}),$c._getVertexBuffer=function($c){return void 0===$c&&($c=0),0===$c?this._vertexBuffer:null},$c._getIndexBuffer=function(){return this._indexBuffer},$c._getCombineRenderElementFromPool=function($c,$d,$e){var $f=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return $f||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=$f=new $W,$f._sprite3D=new $Xd),$f._sprite3D._render._renderUpdate($e),$f},$c._getRenderElement=function($c,$d,$e){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*$w.maxVertexCount),this._indexDatas=new Uint16Array($w.maxIndexCount),this._vertexBuffer=$Od.create(this._vertexDeclaration,$w.maxVertexCount,35048),this._indexBuffer=$Nd.create("ushort",$w.maxIndexCount,35048));for(var $f=this._merageElements.length=0,$g=0,$h=0,$i=this._combineRenderElements.length;$h<$i;$h++){var $j=this._combineRenderElements[$h],$k=$j.getDynamicBatchBakedVertexs(0),$l=$j.getBakedIndices(),$m=$j._sprite3D.transform._isFrontFaceInvert,$n=$f/(this._vertexDeclaration.vertexStride/4),$o=$g,$p=$o+$l.length;$j._tempBatchIndexStart=$o,$j._tempBatchIndexEnd=$p,this._indexDatas.set($l,$g);var $q=0;if($m)for($q=$o;$q<$p;$q+=3){this._indexDatas[$q]=$n+this._indexDatas[$q];var $r=this._indexDatas[$q+1],$s=this._indexDatas[$q+2];this._indexDatas[$q+1]=$n+$s,this._indexDatas[$q+2]=$n+$r}else for($q=$o;$q<$p;$q+=3)this._indexDatas[$q]=$n+this._indexDatas[$q],this._indexDatas[$q+1]=$n+this._indexDatas[$q+1],this._indexDatas[$q+2]=$n+this._indexDatas[$q+2];$g+=$l.length,this._vertexDatas.set($k,$f),$f+=$k.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),$h=this._combineRenderElementPoolIndex=0,$i=this._materials.length;$h<$i;$h++){var $t=this._getCombineRenderElementFromPool($c,$d,$e);$t._type=2,$t._staticBatch=null;var $u=($t.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[$h]]._tempBatchIndexStart,$v=$h+1===this._materialToRenderElementsOffsets.length?$g:this._combineRenderElements[this._materialToRenderElementsOffsets[$h+1]]._tempBatchIndexStart;$t._tempBatchIndexStart=$u,$t._tempBatchIndexEnd=$v,$t._material=this._materials[$h],this._merageElements.push($t)}},$c._addCombineRenderObjTest=function($c){var $d=$c.renderObj,$e=this._currentCombineIndexCount+$d._getIndexBuffer().indexCount,$f=this._currentCombineVertexCount+$d._getVertexBuffer().vertexCount;return!($w.maxVertexCount<$f||$w.maxIndexCount<$e)},$c._addCombineRenderObj=function($c){var $d=$c.renderObj;this._combineRenderElements.push($c),this._currentCombineIndexCount=this._currentCombineIndexCount+$d._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$d._getVertexBuffer().vertexCount},$c._addCombineMaterial=function($c){this._materials.push($c)},$c._addMaterialToRenderElementOffset=function($c){this._materialToRenderElementsOffsets.push($c)},$c._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},$c._addToRenderQueue=function($c,$d,$e,$f){this._getRenderElement($d,$e,$f);for(var $g=0,$h=this._materials.length;$g<$h;$g++)$c.getRenderQueue(this._materials[$g].renderQueue)._addDynamicBatchElement(this._merageElements[$g])},$c._beforeRender=function($c){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$c._render=function($c){var $d=$c._batchIndexEnd-$c._batchIndexStart;$F.mainContext.drawElements(4,$d,5123,2*$c._batchIndexStart),$A.drawCall++,$A.trianglesFaces+=$d/3},$c._getVertexBuffers=function(){return null},$q(0,$c,"_vertexBufferCount",function(){return 1}),$q(0,$c,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$q(0,$c,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),$w.maxVertexCount=2e4,$w.maxIndexCount=4e4,$w.maxCombineTriangleCount=10,$w}(),$dc=function(){function $w(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}$p($w,"laya.d3.graphics.DynamicBatchManager");var $c=$w.prototype;return $c.getDynamicBatch=function($c,$d){var $e,$f=$c.id.toString()+$d;return this._dynamicBatches[$f]?$e=this._dynamicBatches[$f]:this._dynamicBatches[$f]=$e=new $cc($c),$e},$c._garbageCollection=function(){for(var $c in this._dynamicBatches)0===this._dynamicBatches[$c].combineRenderElementsCount&&delete this._dynamicBatches[$c]},$c._addPrepareRenderElement=function($c){this._prepareDynamicBatchCombineElements.push($c)},$c._finishCombineDynamicBatch=function($c){var $d,$e,$f;this._prepareDynamicBatchCombineElements.sort($w._sortPrepareDynamicBatch);for(var $g,$h,$i,$j,$k,$l=-1,$m=!0,$n=0,$o=-1,$p=0,$q=this._prepareDynamicBatchCombineElements.length;$p<$q;$p++){var $r=($h=this._prepareDynamicBatchCombineElements[$p]).renderObj._getVertexBuffer(0).vertexDeclaration,$s=$e!==$r;$s&&($n=0,$e=$r);var $t=$n!==$l;if($t&&($l=$n),($s||$t)&&($i=this.getDynamicBatch($r,$n),$d=null),$m)if($i._addCombineRenderObjTest($h)){if($d!==($g=$h._material))$j&&($c.getRenderQueue($k._material.renderQueue)._addRenderElement($k),$k=$j=null,$o=-1),$j=$g,$o=$i.combineRenderElementsCount,$k=$h,$d=$g;else if($j){var $u=$k.renderObj,$v=$h.renderObj;$u._getVertexBuffer().vertexCount+$v._getVertexBuffer().vertexCount>$cc.maxVertexCount||$u._getIndexBuffer().indexCount+$v._getIndexBuffer().indexCount>$cc.maxIndexCount?($c.getRenderQueue($k._material.renderQueue)._addRenderElement($k),$j=$g,$o=$i.combineRenderElementsCount,$k=$h):($i._addCombineMaterial($j),$i._addMaterialToRenderElementOffset($o),$i._addCombineRenderObj($k),$k=$j=null,$o=-1,$i._addCombineRenderObj($h))}else $i._addCombineRenderObj($h);$m=!0}else $j&&($c.getRenderQueue($k._material.renderQueue)._addRenderElement($k),$k=$j=null,$o=-1),$n++,$m=!1;else $f=this._prepareDynamicBatchCombineElements[$p-1],$i._addMaterialToRenderElementOffset($i.combineRenderElementsCount),$d=$f._material,$i._addCombineMaterial($d),$i._addCombineRenderObj($f),$m=!0,$d!==($g=$h._material)?($j=$g,$o=$i.combineRenderElementsCount,$k=$h):$i._addCombineRenderObj($h),$d=$g}$j&&($c.getRenderQueue($k._material.renderQueue)._addRenderElement($k),$k=$j=null,$o=-1),this._prepareDynamicBatchCombineElements.length=0},$c._clearRenderElements=function(){for(var $c in this._dynamicBatches)this._dynamicBatches[$c]._clearRenderElements()},$c._addToRenderQueue=function($c,$d,$e,$f){for(var $g in this._dynamicBatches){var $h=this._dynamicBatches[$g];0<$h.combineRenderElementsCount&&$h._addToRenderQueue($c,$d,$e,$f)}},$c.dispose=function(){this._dynamicBatches=null},$w._sortPrepareDynamicBatch=function($c,$d){return $c._mainSortID-$d._mainSortID},$w}(),$ec=function(){function $c(){}return $p($c,"laya.d3.graphics.FrustumCulling"),$c.renderShadowObjectCulling=function($c,$d,$e,$f,$g){var $h=0,$i=0,$j=0,$k=0;for($h=0,$j=$e.length;$h<$j;$h++){var $l=$e[$h];$l&&$l._clearRenderElements()}var $m,$n,$o,$p=$c._cullingRenders;if(1<$g){for($h=0,$j=$c._cullingRendersLength;$h<$j;$h++)if(($m=$p[$h]).castShadow&&$I.isVisible($m._owner.layer.mask)&&$m.enable)for(var $q=1,$r=$d.length;$q<$r;$q++)if($n=$e[$q-1],0!==$d[$q].containsBoundSphere($m.boundingSphere))for($i=0,$k=($o=$m._renderElements).length;$i<$k;$i++)$n._addRenderElement($o[$i])}else for($h=0,$j=$c._cullingRendersLength;$h<$j;$h++)if(($m=$p[$h]).castShadow&&$I.isVisible($m._owner.layer.mask)&&$m.enable&&0!==$d[0].containsBoundSphere($m.boundingSphere))for($m._renderUpdate($f),$n=$e[0],$i=0,$k=($o=$m._renderElements).length;$i<$k;$i++)$n._addRenderElement($o[$i])},$c.renderShadowObjectCullingOctree=function($c,$d,$e,$f,$g){for(var $h=0,$i=$e.length;$h<$i;$h++){var $j=$e[$h];$j&&$j._clearRenderElements()}1<$g?$c.treeRoot.cullingShadowObjects($d,$e,!0,0,$c):$c.treeRoot.cullingShadowObjectsOnePSSM($d[0],$e,$f,!0,0,$c)},$c.renderObjectCulling=function($c,$d,$e,$f,$g,$h){var $i=0,$j=0,$k=0,$l=0,$m=$d._quenes,$n=$d._dynamicBatchManager,$o=$d._cullingRenders;for($i=0,$j=$m.length;$i<$j;$i++){var $p=$m[$i];$p&&$p._clearRenderElements()}var $q=$fc._staticBatchManagers;for($i=0,$j=$q.length;$i<$j;$i++)$q[$i]._clearRenderElements();$n._clearRenderElements();var $r=$e.transform.position;for($i=0,$j=$d._cullingRendersLength;$i<$j;$i++){var $s=$o[$i];if($I.isVisible($s._owner.layer.mask)&&$s.enable&&0!==$c.containsBoundSphere($s.boundingSphere)&&$s._renderUpdate($h)){$s._distanceForSort=$id.distance($s.boundingSphere.center,$r)+$s.sortingFudge;var $t=$s._renderElements;for($k=0,$l=$t.length;$k<$l;$k++){var $u=$t[$k],$v=$u._staticBatch;if($v&&$v._material===$u._material)$v._addBatchRenderElement($u);else{var $w=$u.renderObj;$w.triangleCount<10&&1===$w._vertexBufferCount&&$w._getIndexBuffer()&&$u._material.renderQueue<2&&$u._canDynamicBatch&&!$s._owner.isStatic?$n._addPrepareRenderElement($u):$d.getRenderQueue($u._material.renderQueue)._addRenderElement($u)}}}}for($i=0,$j=$q.length;$i<$j;$i++)$q[$i]._addToRenderQueue($d,$f,$g,$h);$n._finishCombineDynamicBatch($d),$n._addToRenderQueue($d,$f,$g,$h)},$c.renderObjectCullingOctree=function($c,$d,$e,$f,$g,$h){var $i=0,$j=0,$k=$d._quenes,$l=$d._dynamicBatchManager;for($i=0,$j=$k.length;$i<$j;$i++){var $m=$k[$i];$m&&$m._clearRenderElements()}var $n=$fc._staticBatchManagers;for($i=0,$j=$n.length;$i<$j;$i++)$n[$i]._clearRenderElements();for($l._clearRenderElements(),$d._cullingRenders.length=0,$d.treeRoot.cullingObjects($c,!0,0,$e.transform.position,$h),$i=0,$j=$n.length;$i<$j;$i++)$n[$i]._addToRenderQueue($d,$f,$g,$h);$l._finishCombineDynamicBatch($d),$l._addToRenderQueue($d,$f,$g,$h)},$c.renderObjectCullingNoBoundFrustum=function($c,$d,$e,$f,$g){var $h=0,$i=0,$j=0,$k=0,$l=$c._quenes,$m=$c._dynamicBatchManager,$n=$c._cullingRenders;for($h=0,$i=$l.length;$h<$i;$h++){var $o=$l[$h];$o&&$o._clearRenderElements()}var $p=$fc._staticBatchManagers;for($h=0,$i=$p.length;$h<$i;$h++)$p[$h]._clearRenderElements();$m._clearRenderElements();var $q=$d.transform.position;for($h=0,$i=$c._cullingRendersLength;$h<$i;$h++){var $r=$n[$h];if($I.isVisible($r._owner.layer.mask)&&$r.enable){$r._renderUpdate($g),$r._distanceForSort=$id.distance($r.boundingSphere.center,$q)+$r.sortingFudge;var $s=$r._renderElements;for($j=0,$k=$s.length;$j<$k;$j++){var $t=$s[$j],$u=$t._staticBatch;if($u&&$u._material===$t._material)$u._addBatchRenderElement($t);else{var $v=$t.renderObj;$v.triangleCount<10&&1===$v._vertexBufferCount&&$v._getIndexBuffer()&&$t._material.renderQueue<2&&$t._canDynamicBatch&&!$r._owner.isStatic?$m._addPrepareRenderElement($t):$c.getRenderQueue($t._material.renderQueue)._addRenderElement($t)}}}}for($h=0,$i=$p.length;$h<$i;$h++)$p[$h]._addToRenderQueue($c,$e,$f,$g);$m._finishCombineDynamicBatch($c),$m._addToRenderQueue($c,$e,$f,$g)},$c}(),$fc=function(){function $h(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}$p($h,"laya.d3.graphics.StaticBatchManager");var $c=$h.prototype;return $c._finishInit=function(){for(var $c in this._staticBatches)this._staticBatches[$c]._finishInit();this._initBatchRenderElements.length=0},$c._initStaticBatchs=function($c){throw new Error("StaticBatchManager:must override this function.")},$c._addInitBatchSprite=function($c){for(var $d=$c._render._renderElements,$e=0,$f=$d.length;$e<$f;$e++)this._initBatchRenderElements.push($d[$e])},$c._clearRenderElements=function(){for(var $c in this._staticBatches)this._staticBatches[$c]._clearRenderElements()},$c._garbageCollection=function($c){var $d=$c._staticBatch,$e=$d._initBatchRenderElements,$f=$e.indexOf($c);$e.splice($f,1),0===$e.length&&($d.dispose(),delete this._staticBatches[$d._key])},$c._addToRenderQueue=function($c,$d,$e,$f){for(var $g in this._staticBatches){var $h=this._staticBatches[$g];0<$h._batchRenderElements.length&&$h._updateToRenderQueue($c,$f)}},$c.dispose=function(){this._staticBatches=null},$h._addToStaticBatchQueue=function($c){$c instanceof laya.d3.core.RenderableSprite3D&&$c._addToInitStaticBatchManager();for(var $d=0,$e=$c.numChildren;$d<$e;$d++)$h._addToStaticBatchQueue($c._childs[$d])},$h.combine=function($c,$d){var $e,$f=0,$g=0;if($d)for($f=0,$g=$d.length;$f<$g;$f++){$d[$f]._addToInitStaticBatchManager()}else $c&&$h._addToStaticBatchQueue($c);for($f=0,$g=$h._staticBatchManagers.length;$f<$g;$f++)($e=$h._staticBatchManagers[$f])._initStaticBatchs($c),$e._finishInit()},$h._staticBatchManagers=[],$h}(),$gc=function(){function $c($c,$d,$e){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=$c,this._manager=$d,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=$e}$p($c,"laya.d3.graphics.StaticBatch");var $d=$c.prototype;return $x.imps($d,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$d._binarySearch=function($c){for(var $d=0,$e=this._batchRenderElements.length-1,$f=0;$d<=$e;)$f=Math.floor(($d+$e)/2),this._compareBatchRenderElement(this._batchRenderElements[$f],$c)?$e=$f-1:$d=$f+1;return $d},$d._compareBatchRenderElement=function($c,$d){throw new Error("StaticBatch:must override this function.")},$d._getVertexDecLightMap=function($c){return $c===$Nc.vertexDeclaration?$Ic.vertexDeclaration:$c===$Mc.vertexDeclaration?$Hc.vertexDeclaration:$c===$Bc.vertexDeclaration?$wc.vertexDeclaration:$c===$Rc.vertexDeclaration?null:$c===$rc.vertexDeclaration?$sc.vertexDeclaration:$c===$Pc.vertexDeclaration?$Kc.vertexDeclaration:$c===$Fc.vertexDeclaration?$Gc.vertexDeclaration:$c===$Oc.vertexDeclaration?$Jc.vertexDeclaration:$c===$Mc.vertexDeclaration?$Hc.vertexDeclaration:$c===$Cc.vertexDeclaration?$xc.vertexDeclaration:$c===$Rc.vertexDeclaration?null:$c===$rc.vertexDeclaration?$sc.vertexDeclaration:$c===$Qc.vertexDeclaration?$Lc.vertexDeclaration:$c===$Fc.vertexDeclaration?$Gc.vertexDeclaration:$c},$d._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},$d._addBatchRenderElement=function($c){this._batchRenderElements.splice(this._binarySearch($c),0,$c)},$d._updateToRenderQueue=function($c,$d){this._combineRenderElementPoolIndex=0,this._getRenderElement($c.getRenderQueue(this._material.renderQueue)._renderElements,$c,$d)},$d._getRenderElement=function($c,$d,$e){throw new Error("StaticBatch:must override this function.")},$d._finishInit=function(){throw new Error("StaticBatch:must override this function.")},$d._clearRenderElements=function(){this._batchRenderElements.length=0},$d.dispose=function(){},$d._getVertexBuffer=function($c){return void 0===$c&&($c=0),null},$d._getIndexBuffer=function(){return null},$d._beforeRender=function($c){return!0},$d._render=function($c){},$d._getVertexBuffers=function(){return null},$q(0,$d,"_vertexBufferCount",function(){return 1}),$q(0,$d,"triangleCount",function(){return 0}),$c.combine=function($c){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),$fc.combine($c)},$c.maxBatchVertexCount=65535,$c}(),$hc=function(){function $i($c,$d){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++$i._uniqueIDCounter,this._id>$i.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",$i.maxVertexDeclaration);this._shaderValues=new $od,this._vertexElementsDic={},this._vertexStride=$c,this._vertexElements=$d;for(var $e=0;$e<$d.length;$e++){var $f=$d[$e],$g=$f.elementUsage;this._vertexElementsDic[$g]=$f;var $h=[$i._getTypeSize($f.elementFormat)/4,5126,!1,this._vertexStride,$f.offset];switch(this._shaderValues.setValue($g,$h),$g){case 1:this._addShaderDefine($Ad.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine($Ad.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine($Ad.SHADERDEFINE_UV1)}}}$p($i,"laya.d3.graphics.VertexDeclaration");var $c=$i.prototype;return $c._addShaderDefine=function($c){this._shaderDefineValue|=$c},$c._removeShaderDefine=function($c){this._shaderDefineValue&=~$c},$c.getVertexElements=function(){return this._vertexElements.slice()},$c.getVertexElementByUsage=function($c){return this._vertexElementsDic[$c]},$c.unBinding=function(){},$q(0,$c,"shaderDefineValue",function(){return this._shaderDefineValue}),$q(0,$c,"id",function(){return this._id}),$q(0,$c,"vertexStride",function(){return this._vertexStride}),$q(0,$c,"shaderValues",function(){return this._shaderValues}),$i._getTypeSize=function($c){switch($c){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},$i.getVertexStride=function($c){for(var $d=0,$e=0;$e<$c.Length;$e++){var $f=$c[$e],$g=$f.offset+$i._getTypeSize($f.elementFormat);$d<$g&&($d=$g)}return $d},$i._maxVertexDeclarationBit=1e3,$i._uniqueIDCounter=1,$n($i,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),$i}(),$ic=function(){function $c($c,$d,$e){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=$c,this.elementFormat=$d,this.elementUsage=$e}return $p($c,"laya.d3.graphics.VertexElement"),$c}(),$jc=(function(){function $c(){}$p($c,"laya.d3.graphics.VertexElementFormat"),$c.Single="single",$c.Vector2="vector2",$c.Vector3="vector3",$c.Vector4="vector4",$c.Color="color",$c.Byte4="byte4",$c.Short2="short2",$c.Short4="short4",$c.NormalizedShort2="normalizedshort2",$c.NormalizedShort4="normalizedshort4",$c.HalfVector2="halfvector2",$c.HalfVector4="halfvector4"}(),function(){function $c(){}$p($c,"laya.d3.graphics.VertexElementUsage"),$c.POSITION0=0,$c.COLOR0=1,$c.TEXTURECOORDINATE0=2,$c.NORMAL0=3,$c.BINORMAL0=4,$c.TANGENT0=5,$c.BLENDINDICES0=6,$c.BLENDWEIGHT0=7,$c.DEPTH0=8,$c.FOG0=9,$c.POINTSIZE0=10,$c.SAMPLE0=11,$c.TESSELLATEFACTOR0=12,$c.COLOR1=13,$c.NEXTTEXTURECOORDINATE0=14,$c.TEXTURECOORDINATE1=15,$c.NEXTTEXTURECOORDINATE1=16,$c.CORNERTEXTURECOORDINATE0=17,$c.VELOCITY0=18,$c.STARTCOLOR0=19,$c.STARTSIZE=20,$c.AGEADDSCALE0=21,$c.STARTROTATION=22,$c.ENDCOLOR0=23,$c.STARTLIFETIME=24,$c.TIME0=33,$c.SHAPEPOSITIONSTARTLIFETIME=30,$c.DIRECTIONTIME=32,$c.SIZEROTATION0=27,$c.RADIUS0=28,$c.RADIAN0=29,$c.STARTSPEED=31,$c.RANDOM0=34,$c.RANDOM1=35,$c.SIMULATIONWORLDPOSTION=36,$c.SIMULATIONWORLDROTATION=37,$c.TEXTURECOORDINATE0X=38,$c.TEXTURECOORDINATE0X1=39,$c.TEXTURECOORDINATE0Y=40,$c.OFFSETVECTOR=41}(),function(){function $c($c,$d,$e){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=$c,this._textureCoordinate0=$d,this._time=$e}$p($c,"laya.d3.graphics.VertexGlitter");var $d=$c.prototype;$x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate0}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"time",function(){return this._time}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(24,[new $ic(0,"vector3",0),new $ic(12,"vector2",2),new $ic(20,"single",33)])}])}(),function(){function $c($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=$c,this._position=$d,this._velocity=$e,this._startColor=$f,this._endColor=$g,this._sizeRotation=$h,this._radius=$i,this._radian=$j,this._ageAddScale=$k,this._time=$l}$p($c,"laya.d3.graphics.VertexParticle");var $d=$c.prototype;$x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"endColor",function(){return this._endColor}),$q(0,$d,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$q(0,$d,"sizeRotation",function(){return this._sizeRotation}),$q(0,$d,"velocity",function(){return this._velocity}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"startColor",function(){return this._startColor}),$q(0,$d,"radius",function(){return this._radius}),$q(0,$d,"radian",function(){return this._radian}),$q(0,$d,"ageAddScale",function(){return this._ageAddScale}),$q(0,$d,"time",function(){return this._time}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(116,[new $ic(0,"vector4",17),new $ic(16,"vector3",0),new $ic(28,"vector3",18),new $ic(40,"vector4",19),new $ic(56,"vector4",23),new $ic(72,"vector3",27),new $ic(84,"vector2",28),new $ic(92,"vector4",29),new $ic(108,"single",24),new $ic(112,"single",33)])}])}(),function(){function $c($c){this._position=null,this._position=$c}$p($c,"laya.d3.graphics.VertexPosition");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(12,[new $ic(0,"vector3",0)])}]),$c}()),$kc=function(){function $c($c,$d){this._position=null,this._normal=null,this._position=$c,this._normal=$d}$p($c,"laya.d3.graphics.VertexPositionNormal");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(24,[new $ic(0,"vector3",0),new $ic(12,"vector3",3)])}]),$c}(),$lc=function(){function $c($c,$d,$e){this._position=null,this._normal=null,this._color=null,this._position=$c,this._normal=$d,this._color=$e}$p($c,"laya.d3.graphics.VertexPositionNormalColor");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(40,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1)])}]),$c}(),$mc=function(){function $c($c,$d,$e,$f,$g){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=$c,this._normal=$d,this._color=$e,this._blendIndex=$f,this._blendWeight=$g}$p($c,"laya.d3.graphics.VertexPositionNormalColorSkin");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(72,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector4",7),new $ic(56,"vector4",6)])}]),$c}(),$nc=function(){function $c($c,$d,$e,$f,$g,$h){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$c,this._normal=$d,this._color=$e,this._tangent=$f,this._blendIndex=$g,this._blendWeight=$h}$p($c,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(88,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector4",7),new $ic(56,"vector4",6),new $ic(72,"vector4",5)])}]),$c}(),$oc=function(){function $c($c,$d,$e,$f,$g,$h){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$c,this._normal=$d,this._color=$e,this._tangent=$f,this._blendIndex=$g,this._blendWeight=$h}$p($c,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(84,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector4",7),new $ic(56,"vector4",6),new $ic(72,"vector3",5)])}]),$c}(),$pc=function(){function $c($c,$d,$e,$f){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$c,this._normal=$d,this._color=$e,this._tangent=$f}$p($c,"laya.d3.graphics.VertexPositionNormalColorSTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(56,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector4",5)])}]),$c}(),$qc=function(){function $c($c,$d,$e,$f){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$c,this._normal=$d,this._color=$e,this._tangent=$f}$p($c,"laya.d3.graphics.VertexPositionNormalColorTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(52,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector3",5)])}]),$c}(),$rc=function(){function $c($c,$d,$e,$f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=$c,this._normal=$d,this._color=$e,this._textureCoordinate=$f}$p($c,"laya.d3.graphics.VertexPositionNormalColorTexture");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(48,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector2",2)])}]),$c}(),$sc=function(){function $c($c,$d,$e,$f,$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$c,this._normal=$d,this._color=$e,this._textureCoordinate0=$f,this._textureCoordinate1=$g}$p($c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(56,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector2",2),new $ic(48,"vector2",15)])}]),$c}(),$tc=function(){function $c($c,$d,$e,$f,$g,$h,$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$c,this._normal=$d,this._color=$e,this._textureCoordinate0=$f,this._textureCoordinate1=$g,this._blendIndex=$h,this._blendWeight=$i}$p($c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(88,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector2",2),new $ic(48,"vector2",15),new $ic(56,"vector4",7),new $ic(72,"vector4",6)])}]),$c}(),$uc=function(){function $c($c,$d,$e,$f,$g,$h,$i,$j){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$c,this._normal=$d,this._color=$e,this._textureCoordinate0=$f,this._textureCoordinate1=$g,this._tangent=$h,this._blendIndex=$i,this._blendWeight=$j}$p($c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(104,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector2",2),new $ic(48,"vector2",15),new $ic(56,"vector4",7),new $ic(72,"vector4",6),new $ic(88,"vector4",5)])}]),$c}(),$vc=function(){function $c(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$p($c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$d.VertexPositionNormalColorTexture0SkinTangent=function($c,$d,$e,$f,$g,$h,$i,$j){this._position=$c,this._normal=$d,this._color=$e,this._textureCoordinate0=$f,this._textureCoordinate1=$g,this._tangent=$h,this._blendIndex=$i,this._blendWeight=$j},$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(100,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector2",2),new $ic(48,"vector2",15),new $ic(56,"vector4",7),new $ic(72,"vector4",6),new $ic(88,"vector3",5)])}]),$c}(),$wc=function(){function $c($c,$d,$e,$f,$g,$h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$c,this._normal=$d,this._color=$e,this._textureCoordinate0=$f,this._textureCoordinate1=$g,this._tangent=$h}$p($c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(72,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector2",2),new $ic(48,"vector2",15),new $ic(56,"vector4",5)])}]),$c}(),$xc=function(){function $c(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$p($c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$d.VertexPositionNormalColorTexture0Tangent=function($c,$d,$e,$f,$g,$h){this._position=$c,this._normal=$d,this._color=$e,this._textureCoordinate0=$f,this._textureCoordinate1=$g,this._tangent=$h},$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(68,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector2",2),new $ic(48,"vector2",15),new $ic(56,"vector3",5)])}]),$c}(),$yc=function(){function $c($c,$d,$e,$f,$g,$h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$c,this._normal=$d,this._color=$e,this._textureCoordinate=$f,this._blendIndex=$g,this._blendWeight=$h}$p($c,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(80,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector2",2),new $ic(48,"vector4",7),new $ic(64,"vector4",6)])}]),$c}(),$zc=function(){function $c($c,$d,$e,$f,$g,$h,$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$c,this._normal=$d,this._color=$e,this._textureCoordinate=$f,this._tangent=$g,this._blendIndex=$h,this._blendWeight=$i}$p($c,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(96,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector2",2),new $ic(48,"vector4",7),new $ic(64,"vector4",6),new $ic(80,"vector4",5)])}]),$c}(),$Ac=function(){function $c($c,$d,$e,$f,$g,$h,$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$c,this._normal=$d,this._color=$e,this._textureCoordinate=$f,this._tangent=$g,this._blendIndex=$h,this._blendWeight=$i}$p($c,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(92,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector2",2),new $ic(48,"vector4",7),new $ic(64,"vector4",6),new $ic(80,"vector3",5)])}]),$c}(),$Bc=function(){function $c($c,$d,$e,$f,$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$c,this._normal=$d,this._color=$e,this._textureCoordinate=$f,this._tangent=$g}$p($c,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(64,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector2",2),new $ic(48,"vector4",5)])}]),$c}(),$Cc=function(){function $c($c,$d,$e,$f,$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$c,this._normal=$d,this._color=$e,this._textureCoordinate=$f,this._tangent=$g}$p($c,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"color",function(){return this._color}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(60,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",1),new $ic(40,"vector2",2),new $ic(48,"vector3",5)])}]),$c}(),$Dc=function(){function $c($c,$d,$e){this._position=null,this._normal=null,this._tangent=null,this._position=$c,this._normal=$d,this._tangent=$e}$p($c,"laya.d3.graphics.VertexPositionNormalSTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(40,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector4",5)])}]),$c}(),$Ec=function(){function $c($c,$d,$e){this._position=null,this._normal=null,this._tangent=null,this._position=$c,this._normal=$d,this._tangent=$e}$p($c,"laya.d3.graphics.VertexPositionNormalTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(36,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector3",5)])}]),$c}(),$Fc=function(){function $c($c,$d,$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$c,this._normal=$d,this._textureCoordinate=$e}$p($c,"laya.d3.graphics.VertexPositionNormalTexture");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(32,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2)])}]),$c}(),$Gc=function(){function $c($c,$d,$e,$f){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$c,this._normal=$d,this._textureCoordinate0=$e,this._textureCoordinate1=$f}$p($c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(40,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2),new $ic(32,"vector2",15)])}]),$c}(),$Hc=function(){function $c($c,$d,$e,$f,$g,$h){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$c,this._normal=$d,this._textureCoordinate0=$e,this._textureCoordinate1=$f,this._blendIndex=$g,this._blendWeight=$h}$p($c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(72,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2),new $ic(32,"vector2",15),new $ic(40,"vector4",7),new $ic(56,"vector4",6)])}]),$c}(),$Ic=function(){function $c($c,$d,$e,$f,$g,$h,$i){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$c,this._normal=$d,this._textureCoordinate0=$e,this._textureCoordinate1=$f,this._tangent=$g,this._blendIndex=$h,this._blendWeight=$i}$p($c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(88,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2),new $ic(32,"vector2",15),new $ic(40,"vector4",7),new $ic(56,"vector4",6),new $ic(72,"vector4",5)])}]),$c}(),$Jc=function(){function $c(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$p($c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$d.VertexPositionNormalTexture0SkinTangent=function($c,$d,$e,$f,$g,$h,$i){this._position=$c,this._normal=$d,this._textureCoordinate0=$e,this._textureCoordinate1=$f,this._tangent=$g,this._blendIndex=$h,this._blendWeight=$i},$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(84,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2),new $ic(32,"vector2",15),new $ic(40,"vector4",7),new $ic(56,"vector4",6),new $ic(72,"vector3",5)])}]),$c}(),$Kc=function(){function $c($c,$d,$e,$f,$g){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$c,this._normal=$d,this._textureCoordinate0=$e,this._textureCoordinate1=$f,this._tangent=$g}$p($c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(56,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2),new $ic(32,"vector2",15),new $ic(40,"vector4",5)])}]),$c}(),$Lc=function(){function $c(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$p($c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$d.VertexPositionNormalTexture0Tangent=function($c,$d,$e,$f,$g){this._position=$c,this._normal=$d,this._textureCoordinate0=$e,this._textureCoordinate1=$f,this._tangent=$g},$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(52,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2),new $ic(32,"vector2",15),new $ic(40,"vector3",5)])}]),$c}(),$Mc=function(){function $c($c,$d,$e,$f,$g){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$c,this._normal=$d,this._textureCoordinate=$e,this._blendIndex=$f,this._blendWeight=$g}$p($c,"laya.d3.graphics.VertexPositionNormalTextureSkin");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(64,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2),new $ic(32,"vector4",7),new $ic(48,"vector4",6)])}]),$c}(),$Nc=function(){function $c($c,$d,$e,$f,$g,$h){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$c,this._normal=$d,this._textureCoordinate=$e,this._tangent=$f,this._blendIndex=$g,this._blendWeight=$h}$p($c,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(80,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2),new $ic(32,"vector4",7),new $ic(48,"vector4",6),new $ic(64,"vector4",5)])}]),$c}(),$Oc=function(){function $c($c,$d,$e,$f,$g,$h){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$c,this._normal=$d,this._textureCoordinate=$e,this._tangent=$f,this._blendIndex=$g,this._blendWeight=$h}$p($c,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(76,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2),new $ic(32,"vector4",7),new $ic(48,"vector4",6),new $ic(64,"vector3",5)])}]),$c}(),$Pc=function(){function $c($c,$d,$e,$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$c,this._normal=$d,this._textureCoordinate=$e,this._tangent=$f}$p($c,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(48,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2),new $ic(32,"vector4",5)])}]),$c}(),$Qc=function(){function $c($c,$d,$e,$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$c,this._normal=$d,this._textureCoordinate=$e,this._tangent=$f}$p($c,"laya.d3.graphics.VertexPositionNormalTextureTangent");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(44,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2),new $ic(32,"vector3",5)])}]),$c}(),$Rc=function(){function $c($c,$d,$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$c,this._normal=$d,this._textureCoordinate=$e}$p($c,"laya.d3.graphics.VertexPositionNTBTexture");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(56,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector3",5),new $ic(36,"vector3",4),new $ic(48,"vector2",2)])}]),$c}(),$Sc=function(){function $c($c,$d,$e,$f,$g,$h,$i,$j){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=$c,this._normal=$d,this._textureCoordinate0=$f,this._textureCoordinate1=$g,this._tangent=$h,$e=$e,this._blendIndex=$i,this._blendWeight=$j}$p($c,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"tangent",function(){return this._tangent}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(0,$d,"textureCoordinate1",function(){return this._textureCoordinate1}),$q(0,$d,"blendIndex",function(){return this._blendIndex}),$q(0,$d,"blendWeight",function(){return this._blendWeight}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(96,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector3",5),new $ic(36,"vector3",4),new $ic(48,"vector2",2),new $ic(56,"vector2",15),new $ic(64,"vector4",7),new $ic(80,"vector4",6)])}]),$c}(),$Tc=function(){function $c($c,$d,$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$c,this._normal=$d,this._textureCoordinate=$e}$p($c,"laya.d3.graphics.VertexPositionNTBTextureSkin");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"textureCoordinate",function(){return this._textureCoordinate}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(88,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector3",5),new $ic(36,"vector3",4),new $ic(48,"vector2",2),new $ic(56,"vector4",7),new $ic(72,"vector4",6)])}]),$c}(),$Uc=(function(){function $c($c,$d,$e,$f){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=$c,this._normal=$d,this._textureCoord0=$e,this._textureCoord1=$f}$p($c,"laya.d3.graphics.VertexPositionTerrain");var $d=$c.prototype;$x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"normal",function(){return this._normal}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"textureCoord0",function(){return this._textureCoord0}),$q(0,$d,"textureCoord1",function(){return this._textureCoord1}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(40,[new $ic(0,"vector3",0),new $ic(12,"vector3",3),new $ic(24,"vector2",2),new $ic(32,"vector2",15)])}])}(),function(){function $c($c,$d){this._position=null,this._textureCoordinate0=null,this._position=$c,this._textureCoordinate0=$d}$p($c,"laya.d3.graphics.VertexPositionTexture0");var $d=$c.prototype;return $x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"position",function(){return this._position}),$q(0,$d,"textureCoordinate0",function(){return this._textureCoordinate0}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(20,[new $ic(0,"vector3",0),new $ic(12,"vector2",2)])}]),$c}()),$Vc=(function(){function $c($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$n,$o,$p){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$c,this._positionStartLifeTime=$d,this._velocity=$e,this._startColor=$f,this._startSize=$g,this._startRotation0=$h,this._startRotation1=$i,this._startRotation2=$j,this._startLifeTime=$k,this._time=$l,this._startSpeed=$m,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$p}$p($c,"laya.d3.graphics.VertexShurikenParticleBillboard");var $d=$c.prototype;$x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$q(0,$d,"random1",function(){return this._randoms1}),$q(0,$d,"startRotation2",function(){return this._startRotation2}),$q(0,$d,"positionStartLifeTime",function(){return this._positionStartLifeTime}),$q(0,$d,"velocity",function(){return this._velocity}),$q(0,$d,"random0",function(){return this._randoms0}),$q(0,$d,"startSize",function(){return this._startSize}),$q(0,$d,"startColor",function(){return this._startColor}),$q(0,$d,"startRotation0",function(){return this._startRotation0}),$q(0,$d,"startRotation1",function(){return this._startRotation1}),$q(0,$d,"startLifeTime",function(){return this._startLifeTime}),$q(0,$d,"time",function(){return this._time}),$q(0,$d,"startSpeed",function(){return this._startSpeed}),$q(0,$d,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(152,[new $ic(0,"vector4",17),new $ic(16,"vector4",30),new $ic(32,"vector4",32),new $ic(48,"vector4",19),new $ic(64,"vector3",20),new $ic(76,"vector3",22),new $ic(88,"single",31),new $ic(92,"vector4",34),new $ic(108,"vector4",35),new $ic(124,"vector3",36),new $ic(136,"vector4",37)])}])}(),function(){function $c($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$n,$o,$p){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$c,this._positionStartLifeTime=$d,this._velocity=$e,this._startColor=$f,this._startSize=$g,this._startRotation0=$h,this._startRotation1=$i,this._startRotation2=$j,this._startLifeTime=$k,this._time=$l,this._startSpeed=$m,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$p}$p($c,"laya.d3.graphics.VertexShurikenParticleMesh");var $d=$c.prototype;$x.imps($d,{"laya.d3.graphics.IVertex":!0}),$q(0,$d,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$q(0,$d,"velocity",function(){return this._velocity}),$q(0,$d,"position",function(){return this._positionStartLifeTime}),$q(0,$d,"random0",function(){return this._randoms0}),$q(0,$d,"startSize",function(){return this._startSize}),$q(0,$d,"startColor",function(){return this._startColor}),$q(0,$d,"startRotation0",function(){return this._startRotation0}),$q(0,$d,"startRotation1",function(){return this._startRotation1}),$q(0,$d,"random1",function(){return this._randoms1}),$q(0,$d,"startRotation2",function(){return this._startRotation2}),$q(0,$d,"startLifeTime",function(){return this._startLifeTime}),$q(0,$d,"time",function(){return this._time}),$q(0,$d,"startSpeed",function(){return this._startSpeed}),$q(0,$d,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$q(0,$d,"vertexDeclaration",function(){return $c._vertexDeclaration}),$q(1,$c,"vertexDeclaration",function(){return $c._vertexDeclaration}),$n($c,["_vertexDeclaration",function(){return this._vertexDeclaration=new $hc(172,[new $ic(0,"vector3",0),new $ic(12,"vector4",1),new $ic(28,"vector2",2),new $ic(36,"vector4",30),new $ic(52,"vector4",32),new $ic(68,"vector4",19),new $ic(84,"vector3",20),new $ic(96,"vector3",22),new $ic(108,"single",31),new $ic(112,"vector4",34),new $ic(128,"vector4",35),new $ic(144,"vector3",36),new $ic(156,"vector4",37)])}])}(),function(){function $v($c,$d,$e,$f,$g,$h){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=$e,this._materials=$f,this._subMeshes=$g,this._materialMap=$h,this._version=$d,this._onLoaded($c)}$p($v,"laya.d3.loaders.LoadModelV01");var $c=$v.prototype;return $c._onLoaded=function($c){this._readData=$c,this.READ_BLOCK();for(var $d=0;$d<this._BLOCK.count;$d++){var $e=this._readData.getUint16(),$f=this._strings[$e],$g=this["READ_"+$f];if(null==$g)throw new Error("model file err,no this function:"+$e+" "+$f);if(!$g.call(this))break}return this._mesh},$c.onError=function(){},$c._readString=function(){return this._strings[this._readData.getUint16()]},$c.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},$c.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},$c.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var $c=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var $d=0;$d<this._STRINGS.size;$d++)this._strings[$d]=this._readData.readUTFString();return this._readData.pos=$c,!0},$c.READ_MATERIAL=function(){var $c=this._readData.getUint16(),$d=(this._readString(),this._readString());return this._materials[$c]="null"!==$d?$t.getRes(this._materialMap[$d]):new $Ed,!0},$c.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var $c,$d=this._readData.__getBuffer(),$e=0,$f=this._readData.getUint32(),$g=this._readData.getUint32(),$h=(new Float32Array($d.slice($f+this._DATA.offset,$f+this._DATA.offset+$g)),this._readData.getUint32()),$i=this._readData.getUint32(),$j=new Float32Array($d.slice($h+this._DATA.offset,$h+this._DATA.offset+$i));for(this.mesh._inverseBindPoses=[],$e=0,$c=$j.length;$e<$c;$e+=16){var $k=new $cd($j[$e+0],$j[$e+1],$j[$e+2],$j[$e+3],$j[$e+4],$j[$e+5],$j[$e+6],$j[$e+7],$j[$e+8],$j[$e+9],$j[$e+10],$j[$e+11],$j[$e+12],$j[$e+13],$j[$e+14],$j[$e+15]);this.mesh._inverseBindPoses.push($k)}break;default:throw new Error("LoadModel:unknown version.")}return!0},$c.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var $c=this._readString();this._shaderAttributes=$c.match($v._attrReg);var $d=this._readData.getUint32(),$e=this._readData.getUint32(),$f=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),$g=this._readData.getUint32(),$h=this._readData.getUint32(),$i=this._readData.getUint32(),$j=this._readData.__getBuffer(),$k=new $ld(this._mesh),$l=this._getVertexDeclaration(),$m=$Od.create($l,$g/$l.vertexStride,35044,!0),$n=$f+this._DATA.offset,$o=$j.slice($n,$n+$g);$m.setData(new Float32Array($o));for(var $p=($k._vertexBuffer=$m).vertexDeclaration.getVertexElements(),$q=0;$q<$p.length;$q++)$k._bufferUsage[$p[$q].elementUsage]=$m;var $r=$Nd.create("ushort",$e/2,35044,!0),$s=$d+this._DATA.offset,$t=$j.slice($s,$s+$e);$r.setData(new Uint16Array($t)),$k._indexBuffer=$r;var $u=$j.slice($h+this._DATA.offset,$h+this._DATA.offset+$i);return $k._boneIndicesList[0]=new Uint8Array($u),this._subMeshes.push($k),!0},$c.READ_DATAAREA=function(){return!1},$c._getVertexDeclaration=function(){for(var $c,$d=!1,$e=!1,$f=!1,$g=!1,$h=!1,$i=!1,$j=!1,$k=!1,$l=!1,$m=0;$m<this._shaderAttributes.length;$m+=8)switch(this._shaderAttributes[$m]){case"POSITION":$d=!0;break;case"NORMAL":$e=!0;break;case"COLOR":$f=!0;break;case"UV":$g=!0;break;case"UV1":$h=!0;break;case"BLENDWEIGHT":$j=!0;break;case"BLENDINDICES":$k=!0;break;case"TANGENT":$i=!0;break;case"BINORMAL":$l=!0}return $d&&$e&&$f&&$g&&$h&&$j&&$k&&$i?$c=$vc.vertexDeclaration:$d&&$e&&$f&&$g&&$h&&$j&&$k?$c=$tc.vertexDeclaration:$d&&$e&&$g&&$h&&$j&&$k&&$i?$c=$Jc.vertexDeclaration:$d&&$e&&$g&&$h&&$j&&$k?$c=$Hc.vertexDeclaration:$d&&$e&&$f&&$g&&$j&&$k&&$i?$c=$Ac.vertexDeclaration:$d&&$e&&$f&&$g&&$j&&$k?$c=$yc.vertexDeclaration:$d&&$e&&$i&&$l&&$g&&$j&&$k?$c=$Tc.vertexDeclaration:$d&&$e&&$g&&$j&&$k&&$i?$c=$Oc.vertexDeclaration:$d&&$e&&$g&&$j&&$k?$c=$Mc.vertexDeclaration:$d&&$e&&$f&&$j&&$k&&$i?$c=$oc.vertexDeclaration:$d&&$e&&$f&&$j&&$k?$c=$mc.vertexDeclaration:$d&&$e&&$f&&$g&&$h&&$i?$c=$xc.vertexDeclaration:$d&&$e&&$f&&$g&&$h?$c=$sc.vertexDeclaration:$d&&$e&&$g&&$h&&$i?$c=$Lc.vertexDeclaration:$d&&$e&&$g&&$h?$c=$Gc.vertexDeclaration:$d&&$e&&$f&&$g&&$i?$c=$Cc.vertexDeclaration:$d&&$e&&$g&&$i&&$l?$c=$Rc.vertexDeclaration:$d&&$e&&$f&&$g?$c=$rc.vertexDeclaration:$d&&$e&&$g&&$i?$c=$Qc.vertexDeclaration:$d&&$e&&$g?$c=$Fc.vertexDeclaration:$d&&$e&&$f&&$i?$c=$qc.vertexDeclaration:$d&&$e&&$f&&($c=$lc.vertexDeclaration),$c},$q(0,$c,"mesh",function(){return this._mesh}),$v._attrReg=new RegExp("(\\w+)|([:,;])","g"),$v}()),$Wc=function(){function $z(){}return $p($z,"laya.d3.loaders.LoadModelV02"),$z.parse=function($c,$d,$e,$f,$g,$h){$z._mesh=$e,$z._materials=$f,$z._subMeshes=$g,$z._materialMap=$h,$z._version=$d,$z._readData=$c,$z.READ_DATA(),$z.READ_BLOCK(),$z.READ_STRINGS();for(var $i=0,$j=$z._BLOCK.count;$i<$j;$i++){$z._readData.pos=$z._BLOCK.blockStarts[$i];var $k=$z._readData.getUint16(),$l=$z._strings[$k],$m=$z["READ_"+$l];if(null==$m)throw new Error("model file err,no this function:"+$k+" "+$l);$m.call()}$z._strings.length=0,$z._readData=null,$z._version=null,$z._mesh=null,$z._materials=null,$z._subMeshes=null,$z._materialMap=null},$z._readString=function(){return $z._strings[$z._readData.getUint16()]},$z.READ_DATA=function(){$z._DATA.offset=$z._readData.getUint32(),$z._DATA.size=$z._readData.getUint32()},$z.READ_BLOCK=function(){for(var $c=$z._BLOCK.count=$z._readData.getUint16(),$d=$z._BLOCK.blockStarts=[],$e=$z._BLOCK.blockLengths=[],$f=0;$f<$c;$f++)$d.push($z._readData.getUint32()),$e.push($z._readData.getUint32())},$z.READ_STRINGS=function(){var $c=$z._readData.getUint32(),$d=$z._readData.getUint16(),$e=$z._readData.pos;$z._readData.pos=$c+$z._DATA.offset;for(var $f=0;$f<$d;$f++)$z._strings[$f]=$z._readData.readUTFString();$z._readData.pos=$e},$z.READ_MATERIAL=function(){$z._readString(),$z._readString();var $c=$z._readString();return""!==$c&&$z._materials.push($t.getRes($z._materialMap[$c])),!0},$z.READ_MESH=function(){$z._readString();var $c,$d=$z._readData.__getBuffer(),$e=0,$f=$z._readData.getInt16(),$g=$z._DATA.offset;for($e=0;$e<$f;$e++){var $h=$g+$z._readData.getUint32(),$i=$z._readData.getUint32(),$j=new Float32Array($d.slice($h,$h+$i)),$k=$z._readString().match($z._attrReg),$l=$z._getVertexDeclaration($k),$m=$Od.create($l,4*$j.length/$l.vertexStride,35044,!0);$m.setData($j),$z._mesh._vertexBuffers.push($m)}var $n=$g+$z._readData.getUint32(),$o=$z._readData.getUint32(),$p=new Uint16Array($d.slice($n,$n+$o)),$q=$Nd.create("ushort",$o/2,35044,!0);$q.setData($p),$z._mesh._indexBuffer=$q;var $r=$z._mesh._boneNames=[],$s=$z._readData.getUint16();for($r.length=$s,$e=0;$e<$s;$e++)$r[$e]=$z._strings[$z._readData.getUint16()];var $t=$z._readData.getUint32(),$u=$z._readData.getUint32(),$v=(new Float32Array($d.slice($g+$t,$g+$t+$u)),$z._readData.getUint32()),$w=$z._readData.getUint32(),$x=new Float32Array($d.slice($g+$v,$g+$v+$w));for($z._mesh._inverseBindPoses=[],$e=0,$c=$x.length;$e<$c;$e+=16){var $y=new $cd($x[$e+0],$x[$e+1],$x[$e+2],$x[$e+3],$x[$e+4],$x[$e+5],$x[$e+6],$x[$e+7],$x[$e+8],$x[$e+9],$x[$e+10],$x[$e+11],$x[$e+12],$x[$e+13],$x[$e+14],$x[$e+15]);$z._mesh._inverseBindPoses.push($y)}return $z._mesh._skinnedDatas=new Float32Array(16*$x.length),!0},$z.READ_SUBMESH=function(){var $c=$z._readData.__getBuffer(),$d=new $ld($z._mesh),$e=$z._readData.getInt16(),$f=$z._readData.getUint32(),$g=$z._readData.getUint32();$d._vertexBuffer=$z._mesh._vertexBuffers[$e],$d._vertexStart=$f,$d._vertexCount=$g;var $h=$z._readData.getUint32(),$i=$z._readData.getUint32(),$j=$z._mesh._indexBuffer;$d._indexBuffer=$j,$d._indexStart=$h,$d._indexCount=$i,$d._indices=new Uint16Array($j.getData().buffer,2*$h,$i);var $k=$z._DATA.offset,$l=$d._subIndexBufferStart,$m=$d._subIndexBufferCount,$n=$d._boneIndicesList,$o=$z._readData.getUint16();$l.length=$o,$m.length=$o,$n.length=$o;for(var $p=0;$p<$o;$p++){$l[$p]=$z._readData.getUint32(),$m[$p]=$z._readData.getUint32();var $q=$z._readData.getUint32(),$r=$z._readData.getUint32();$d._boneIndicesList[$p]=new Uint8Array($c.slice($k+$q,$k+$q+$r))}return $z._subMeshes.push($d),!0},$z._getVertexDeclaration=function($c){for(var $d,$e=!1,$f=!1,$g=!1,$h=!1,$i=!1,$j=!1,$k=!1,$l=!1,$m=!1,$n=0;$n<$c.length;$n++)switch($c[$n]){case"POSITION":$e=!0;break;case"NORMAL":$f=!0;break;case"COLOR":$g=!0;break;case"UV":$h=!0;break;case"UV1":$i=!0;break;case"BLENDWEIGHT":$k=!0;break;case"BLENDINDICES":$l=!0;break;case"TANGENT":$j=!0;break;case"BINORMAL":$m=!0}return $e&&$f&&$g&&$h&&$i&&$k&&$l&&$j?$d=$vc.vertexDeclaration:$e&&$f&&$g&&$h&&$i&&$k&&$l?$d=$tc.vertexDeclaration:$e&&$f&&$h&&$i&&$k&&$l&&$j?$d=$Jc.vertexDeclaration:$e&&$f&&$h&&$i&&$k&&$l?$d=$Hc.vertexDeclaration:$e&&$f&&$g&&$h&&$k&&$l&&$j?$d=$Ac.vertexDeclaration:$e&&$f&&$g&&$h&&$k&&$l?$d=$yc.vertexDeclaration:$e&&$f&&$h&&$k&&$l&&$j?$d=$Oc.vertexDeclaration:$e&&$f&&$h&&$k&&$l?$d=$Mc.vertexDeclaration:$e&&$f&&$g&&$k&&$l&&$j?$d=$oc.vertexDeclaration:$e&&$f&&$g&&$k&&$l?$d=$mc.vertexDeclaration:$e&&$f&&$g&&$h&&$i&&$j?$d=$xc.vertexDeclaration:$e&&$f&&$g&&$h&&$i?$d=$sc.vertexDeclaration:$e&&$f&&$h&&$i&&$j?$d=$Lc.vertexDeclaration:$e&&$f&&$h&&$i?$d=$Gc.vertexDeclaration:$e&&$f&&$g&&$h&&$j?$d=$Cc.vertexDeclaration:$e&&$f&&$h&&$j&&$m?$d=$Rc.vertexDeclaration:$e&&$f&&$g&&$h?$d=$rc.vertexDeclaration:$e&&$f&&$h&&$j?$d=$Qc.vertexDeclaration:$e&&$f&&$h?$d=$Fc.vertexDeclaration:$e&&$f&&$g&&$j?$d=$qc.vertexDeclaration:$e&&$f&&$g&&($d=$lc.vertexDeclaration),$d},$z._attrReg=new RegExp("(\\w+)|([:,;])","g"),$z._strings=[],$z._readData=null,$z._version=null,$z._mesh=null,$z._materials=null,$z._subMeshes=null,$z._materialMap=null,$n($z,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$z}(),$Xc=function(){function $y(){}return $p($y,"laya.d3.loaders.LoadModelV03"),$y.parse=function($c,$d,$e,$f,$g){$y._mesh=$e,$y._subMeshes=$f,$y._materialMap=$g,$y._version=$d,$y._readData=$c,$y.READ_DATA(),$y.READ_BLOCK(),$y.READ_STRINGS();for(var $h=0,$i=$y._BLOCK.count;$h<$i;$h++){$y._readData.pos=$y._BLOCK.blockStarts[$h];var $j=$y._readData.getUint16(),$k=$y._strings[$j],$l=$y["READ_"+$k];if(null==$l)throw new Error("model file err,no this function:"+$j+" "+$k);$l.call()}$y._strings.length=0,$y._readData=null,$y._version=null,$y._mesh=null,$y._subMeshes=null,$y._materialMap=null},$y._readString=function(){return $y._strings[$y._readData.getUint16()]},$y.READ_DATA=function(){$y._DATA.offset=$y._readData.getUint32(),$y._DATA.size=$y._readData.getUint32()},$y.READ_BLOCK=function(){for(var $c=$y._BLOCK.count=$y._readData.getUint16(),$d=$y._BLOCK.blockStarts=[],$e=$y._BLOCK.blockLengths=[],$f=0;$f<$c;$f++)$d.push($y._readData.getUint32()),$e.push($y._readData.getUint32())},$y.READ_STRINGS=function(){var $c=$y._readData.getUint32(),$d=$y._readData.getUint16(),$e=$y._readData.pos;$y._readData.pos=$c+$y._DATA.offset;for(var $f=0;$f<$d;$f++)$y._strings[$f]=$y._readData.readUTFString();$y._readData.pos=$e},$y.READ_MESH=function(){var $c,$d=$y._readString(),$e=$y._readData.__getBuffer(),$f=0,$g=$y._readData.getInt16(),$h=$y._DATA.offset;for($f=0;$f<$g;$f++){var $i,$j=$h+$y._readData.getUint32(),$k=$y._readData.getUint32(),$l=new Float32Array($e.slice($j,$j+$k)),$m=$y._readString();switch($y._version){case"LAYAMODEL:03":$i=$y._vertexDeclarationMap_Discard[$m];break;case"LAYAMODEL:0301":$i=$y._vertexDeclarationMap[$m];break;default:throw new Error("LoadModelV03: unknown version.")}if(!$i)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+$y._version+"  bufferAttribute="+$m+"  name="+$d+"  url="+($y._mesh?$y._mesh.url:"null"));var $n=$Od.create($i,4*$l.length/$i.vertexStride,35044,!0,$y._mesh._url+"_"+$f);$n.setData($l),$y._mesh._vertexBuffers.push($n)}var $o=$h+$y._readData.getUint32(),$p=$y._readData.getUint32(),$q=new Uint16Array($e.slice($o,$o+$p)),$r=$Nd.create("ushort",$p/2,35044,!0,$y._mesh._url);$r.setData($q),$y._mesh._indexBuffer=$r;var $s=$y._mesh._boneNames=[],$t=$y._readData.getUint16();for($s.length=$t,$f=0;$f<$t;$f++)$s[$f]=$y._strings[$y._readData.getUint16()];$y._readData.pos+=8;var $u=$y._readData.getUint32(),$v=$y._readData.getUint32(),$w=new Float32Array($e.slice($h+$u,$h+$u+$v));for($y._mesh._inverseBindPoses=[],$f=0,$c=$w.length;$f<$c;$f+=16){var $x=new $cd($w[$f+0],$w[$f+1],$w[$f+2],$w[$f+3],$w[$f+4],$w[$f+5],$w[$f+6],$w[$f+7],$w[$f+8],$w[$f+9],$w[$f+10],$w[$f+11],$w[$f+12],$w[$f+13],$w[$f+14],$w[$f+15]);$y._mesh._inverseBindPoses.push($x)}return $y._mesh._skinnedDatas=new Float32Array(16*$w.length),!0},$y.READ_SUBMESH=function(){var $c=$y._readData.__getBuffer(),$d=new $ld($y._mesh),$e=$y._readData.getInt16(),$f=$y._readData.getUint32(),$g=$y._readData.getUint32();$d._vertexBuffer=$y._mesh._vertexBuffers[$e],$d._vertexStart=$f,$d._vertexCount=$g;var $h=$y._readData.getUint32(),$i=$y._readData.getUint32(),$j=$y._mesh._indexBuffer;$d._indexBuffer=$j,$d._indexStart=$h,$d._indexCount=$i,$d._indices=new Uint16Array($j.getData().buffer,2*$h,$i);var $k=$y._DATA.offset,$l=$d._subIndexBufferStart,$m=$d._subIndexBufferCount,$n=$d._boneIndicesList,$o=$y._readData.getUint16();$l.length=$o,$m.length=$o,$n.length=$o;for(var $p=0;$p<$o;$p++){$l[$p]=$y._readData.getUint32(),$m[$p]=$y._readData.getUint32();var $q=$y._readData.getUint32(),$r=$y._readData.getUint32();$n[$p]=new Uint8Array($c.slice($k+$q,$k+$q+$r))}return $y._subMeshes.push($d),!0},$y._strings=[],$y._readData=null,$y._version=null,$y._mesh=null,$y._subMeshes=null,$y._materialMap=null,$n($y,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$vc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$tc.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$Sc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$Jc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$Hc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$Ac.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$yc.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$Oc.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$Mc.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$oc.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$mc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$xc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$sc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$Lc.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$Gc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$Cc.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$Rc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$rc.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$Qc.vertexDeclaration,"POSITION,NORMAL,UV":$Fc.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$qc.vertexDeclaration,"POSITION,NORMAL,COLOR":$lc.vertexDeclaration,"POSITION,NORMAL,TANGENT":$Ec.vertexDeclaration,"POSITION,NORMAL":$kc.vertexDeclaration,"POSITION,UV":$Uc.vertexDeclaration,POSITION:$jc.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$uc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$tc.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$Sc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$Ic.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$Hc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$zc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$yc.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$Nc.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$Mc.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$nc.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$mc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$wc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$sc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$Kc.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$Gc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$Bc.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$Rc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$rc.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$Pc.vertexDeclaration,"POSITION,NORMAL,UV":$Fc.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$pc.vertexDeclaration,"POSITION,NORMAL,COLOR":$lc.vertexDeclaration,"POSITION,NORMAL,TANGENT":$Dc.vertexDeclaration,"POSITION,NORMAL":$kc.vertexDeclaration,"POSITION,UV":$Uc.vertexDeclaration,POSITION:$jc.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$y}(),$Yc=function(){function $j(){}return $p($j,"laya.d3.loaders.MeshReader"),$j.read=function($c,$d,$e,$f,$g){var $h=new $y($c);$h.pos=0;var $i=$h.readUTFString();switch($i){case"LAYAMODEL:01":case"LAYASKINANI:01":$j._readVersion01($h,$i,$d,$e,$f,$g);break;case"LAYAMODEL:02":$Wc.parse($h,$i,$d,$e,$f,$g);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":$Xc.parse($h,$i,$d,$f,$g);break;default:throw new Error("MeshReader: unknown mesh version.")}$d._setSubMeshes($f)},$j._readVersion01=function($c,$d,$e,$f,$g,$h){new $Vc($c,$d,$e,$f,$g,$h)},$j}(),$Zc=function(){function $c($c,$d){this.min=null,this.max=null,this.min=$c,this.max=$d}$p($c,"laya.d3.math.BoundBox");var $d=$c.prototype;return $x.imps($d,{"laya.d3.core.IClone":!0}),$d.getCorners=function($c){$c.length=8;var $d=this.min.elements,$e=this.max.elements,$f=$d[0],$g=$d[1],$h=$d[2],$i=$e[0],$j=$e[1],$k=$e[2];$c[0]=new $id($f,$j,$k),$c[1]=new $id($i,$j,$k),$c[2]=new $id($i,$g,$k),$c[3]=new $id($f,$g,$k),$c[4]=new $id($f,$j,$h),$c[5]=new $id($i,$j,$h),$c[6]=new $id($i,$g,$h),$c[7]=new $id($f,$g,$h)},$d.toDefault=function(){this.min.toDefault(),this.max.toDefault()},$d.cloneTo=function($c){var $d=$c;this.min.cloneTo($d.min),this.max.cloneTo($d.max)},$d.clone=function(){var $c=new this.constructor(new $id,new $id);return this.cloneTo($c),$c},$c.createfromPoints=function($c,$d){if(null==$c)throw new Error("points");var $e=$d.min,$f=$d.max,$g=$e.elements;$g[0]=Number.MAX_VALUE,$g[1]=Number.MAX_VALUE,$g[2]=Number.MAX_VALUE;var $h=$f.elements;$h[0]=-Number.MAX_VALUE,$h[1]=-Number.MAX_VALUE,$h[2]=-Number.MAX_VALUE;for(var $i=0,$j=$c.length;$i<$j;++$i)$id.min($e,$c[$i],$e),$id.max($f,$c[$i],$f)},$c.merge=function($c,$d,$e){$id.min($c.min,$d.min,$e.min),$id.max($c.max,$d.max,$e.max)},$c}(),$$c=function(){function $l($c){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=$c,this._near=new $dd(new $id),this._far=new $dd(new $id),this._left=new $dd(new $id),this._right=new $dd(new $id),this._top=new $dd(new $id),this._bottom=new $dd(new $id),$l._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}$p($l,"laya.d3.math.BoundFrustum");var $c=$l.prototype;return $c.equalsBoundFrustum=function($c){return this._matrix.equalsOtherMatrix($c.matrix)},$c.equalsObj=function($c){if($c instanceof laya.d3.math.BoundFrustum){var $d=$c;return this.equalsBoundFrustum($d)}return!1},$c.getPlane=function($c){switch($c){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},$c.getCorners=function($c){$l._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo($c[0]),$l._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo($c[1]),$l._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo($c[2]),$l._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo($c[3]),$l._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo($c[4]),$l._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo($c[5]),$l._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo($c[6]),$l._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo($c[7])},$c.containsPoint=function($c){for(var $d=$dd.PlaneIntersectionType_Front,$e=$dd.PlaneIntersectionType_Front,$f=0;$f<6;$f++){switch($f){case 0:$e=Collision.intersectsPlaneAndPoint(this._near,$c);break;case 1:$e=Collision.intersectsPlaneAndPoint(this._far,$c);break;case 2:$e=Collision.intersectsPlaneAndPoint(this._left,$c);break;case 3:$e=Collision.intersectsPlaneAndPoint(this._right,$c);break;case 4:$e=Collision.intersectsPlaneAndPoint(this._top,$c);break;case 5:$e=Collision.intersectsPlaneAndPoint(this._bottom,$c)}switch($e){case $dd.PlaneIntersectionType_Back:return 0;case $dd.PlaneIntersectionType_Intersecting:$d=$dd.PlaneIntersectionType_Intersecting}}switch($d){case $dd.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$c.containsBoundBox=function($c){for(var $d,$e=$l._tempV30,$f=$l._tempV31,$g=1,$h=0;$h<6;$h++){if($d=this.getPlane($h),this._getBoxToPlanePVertexNVertex($c,$d.normal,$e,$f),Collision.intersectsPlaneAndPoint($d,$e)===$dd.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint($d,$f)===$dd.PlaneIntersectionType_Back&&($g=2)}return $g},$c.containsBoundSphere=function($c){for(var $d=$dd.PlaneIntersectionType_Front,$e=$dd.PlaneIntersectionType_Front,$f=0;$f<6;$f++){switch($f){case 0:$e=Collision.intersectsPlaneAndSphere(this._near,$c);break;case 1:$e=Collision.intersectsPlaneAndSphere(this._far,$c);break;case 2:$e=Collision.intersectsPlaneAndSphere(this._left,$c);break;case 3:$e=Collision.intersectsPlaneAndSphere(this._right,$c);break;case 4:$e=Collision.intersectsPlaneAndSphere(this._top,$c);break;case 5:$e=Collision.intersectsPlaneAndSphere(this._bottom,$c)}switch($e){case $dd.PlaneIntersectionType_Back:return 0;case $dd.PlaneIntersectionType_Intersecting:$d=$dd.PlaneIntersectionType_Intersecting}}switch($d){case $dd.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$c._getBoxToPlanePVertexNVertex=function($c,$d,$e,$f){var $g=$c.min,$h=$g.elements,$i=$c.max,$j=$i.elements,$k=$d.elements,$l=$k[0],$m=$k[1],$n=$k[2];$g.cloneTo($e);var $o=$e.elements;0<=$l&&($o[0]=$j[0]),0<=$m&&($o[1]=$j[1]),0<=$n&&($o[2]=$j[2]),$i.cloneTo($f);var $p=$f.elements;0<=$l&&($p[0]=$h[0]),0<=$m&&($p[1]=$h[1]),0<=$n&&($p[2]=$h[2])},$q(0,$c,"top",function(){return this._top}),$q(0,$c,"matrix",function(){return this._matrix},function($c){this._matrix=$c,$l._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),$q(0,$c,"near",function(){return this._near}),$q(0,$c,"far",function(){return this._far}),$q(0,$c,"left",function(){return this._left}),$q(0,$c,"right",function(){return this._right}),$q(0,$c,"bottom",function(){return this._bottom}),$l._getPlanesFromMatrix=function($c,$d,$e,$f,$g,$h,$i){var $j=$c.elements,$k=$j[0],$l=$j[1],$m=$j[2],$n=$j[3],$o=$j[4],$p=$j[5],$q=$j[6],$r=$j[7],$s=$j[8],$t=$j[9],$u=$j[10],$v=$j[11],$w=$j[12],$x=$j[13],$y=$j[14],$z=$j[15],$A=$d.normal.elements;$A[0]=$n+$m,$A[1]=$r+$q,$A[2]=$v+$u,$d.distance=$z+$y,$d.normalize();var $B=$e.normal.elements;$B[0]=$n-$m,$B[1]=$r-$q,$B[2]=$v-$u,$e.distance=$z-$y,$e.normalize();var $C=$f.normal.elements;$C[0]=$n+$k,$C[1]=$r+$o,$C[2]=$v+$s,$f.distance=$z+$w,$f.normalize();var $D=$g.normal.elements;$D[0]=$n-$k,$D[1]=$r-$o,$D[2]=$v-$s,$g.distance=$z-$w,$g.normalize();var $E=$h.normal.elements;$E[0]=$n-$l,$E[1]=$r-$p,$E[2]=$v-$t,$h.distance=$z-$x,$h.normalize();var $F=$i.normal.elements;$F[0]=$n+$l,$F[1]=$r+$p,$F[2]=$v+$t,$i.distance=$z+$x,$i.normalize()},$l._get3PlaneInterPoint=function($c,$d,$e){var $f=$c.normal,$g=$d.normal,$h=$e.normal;$id.cross($g,$h,$l._tempV30),$id.cross($h,$f,$l._tempV31),$id.cross($f,$g,$l._tempV32);var $i=$id.dot($f,$l._tempV30),$j=$id.dot($g,$l._tempV31),$k=$id.dot($h,$l._tempV32);return $id.scale($l._tempV30,-$c.distance/$i,$l._tempV33),$id.scale($l._tempV31,-$d.distance/$j,$l._tempV34),$id.scale($l._tempV32,-$e.distance/$k,$l._tempV35),$id.add($l._tempV33,$l._tempV34,$l._tempV36),$id.add($l._tempV35,$l._tempV36,$l._tempV37),$l._tempV37},$n($l,["_tempV30",function(){return this._tempV30=new $id},"_tempV31",function(){return this._tempV31=new $id},"_tempV32",function(){return this._tempV32=new $id},"_tempV33",function(){return this._tempV33=new $id},"_tempV34",function(){return this._tempV34=new $id},"_tempV35",function(){return this._tempV35=new $id},"_tempV36",function(){return this._tempV36=new $id},"_tempV37",function(){return this._tempV37=new $id}]),$l}(),$_c=function(){function $m($c,$d){this.center=null,this.radius=NaN,this.center=$c,this.radius=$d}$p($m,"laya.d3.math.BoundSphere");var $c=$m.prototype;return $x.imps($c,{"laya.d3.core.IClone":!0}),$c.toDefault=function(){this.center.toDefault(),this.radius=0},$c.intersectsRayDistance=function($c){return Collision.intersectsRayAndSphereRD($c,this)},$c.intersectsRayPoint=function($c,$d){return Collision.intersectsRayAndSphereRP($c,this,$d)},$c.cloneTo=function($c){var $d=$c;this.center.cloneTo($d.center),$d.radius=this.radius},$c.clone=function(){var $c=new this.constructor(new $id,new $id);return this.cloneTo($c),$c},$m.createFromSubPoints=function($c,$d,$e,$f){if(null==$c)throw new Error("points");if($d<0||$d>=$c.length)throw new Error("start"+$d+"Must be in the range [0, "+($c.length-1)+"]");if($e<0||$d+$e>$c.length)throw new Error("count"+$e+"Must be in the range <= "+$c.length+"}");var $g=$d+$e,$h=$m._tempVector3;$h.elements[0]=0,$h.elements[1]=0,$h.elements[2]=0;for(var $i=$d;$i<$g;++$i)$id.add($c[$i],$h,$h);var $j=$f.center;$id.scale($h,1/$e,$j);var $k=0;for($i=$d;$i<$g;++$i){var $l=$id.distanceSquared($j,$c[$i]);$k<$l&&($k=$l)}$f.radius=Math.sqrt($k)},$m.createfromPoints=function($c,$d){if(null==$c)throw new Error("points");$m.createFromSubPoints($c,0,$c.length,$d)},$n($m,["_tempVector3",function(){return this._tempVector3=new $id}]),$m}(),$ac=(function(){function $c(){}$p($c,"laya.d3.math.ContainmentType"),$c.Disjoint=0,$c.Contains=1,$c.Intersects=2}(),function(){function $e(){}return $p($e,"laya.d3.math.MathUtils3D"),$e.isZero=function($c){return Math.abs($c)<$e.zeroTolerance},$e.nearEqual=function($c,$d){return!!$e.isZero($c-$d)},$e.fastInvSqrt=function($c){return $e.isZero($c)?$c:1/Math.sqrt($c)},$n($e,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),$e}()),$bc=function(){function $k(){var $c=this.elements=new Float32Array(9);$c[0]=1,$c[1]=0,$c[2]=0,$c[3]=0,$c[4]=1,$c[5]=0,$c[6]=0,$c[7]=0,$c[8]=1}$p($k,"laya.d3.math.Matrix3x3");var $c=$k.prototype;return $x.imps($c,{"laya.d3.core.IClone":!0}),$c.determinant=function(){var $c=this.elements,$d=$c[0],$e=$c[1],$f=$c[2],$g=$c[3],$h=$c[4],$i=$c[5],$j=$c[6],$k=$c[7],$l=$c[8];return $d*($l*$h-$i*$k)+$e*(-$l*$g+$i*$j)+$f*($k*$g-$h*$j)},$c.translate=function($c,$d){var $e=$d.elements,$f=this.elements,$g=$c.elements,$h=$f[0],$i=$f[1],$j=$f[2],$k=$f[3],$l=$f[4],$m=$f[5],$n=$f[6],$o=$f[7],$p=$f[8],$q=$g[0],$r=$g[1];$e[0]=$h,$e[1]=$i,$e[2]=$j,$e[3]=$k,$e[4]=$l,$e[5]=$m,$e[6]=$q*$h+$r*$k+$n,$e[7]=$q*$i+$r*$l+$o,$e[8]=$q*$j+$r*$m+$p},$c.rotate=function($c,$d){var $e=$d.elements,$f=this.elements,$g=$f[0],$h=$f[1],$i=$f[2],$j=$f[3],$k=$f[4],$l=$f[5],$m=$f[6],$n=$f[7],$o=$f[8],$p=Math.sin($c),$q=Math.cos($c);$e[0]=$q*$g+$p*$j,$e[1]=$q*$h+$p*$k,$e[2]=$q*$i+$p*$l,$e[3]=$q*$j-$p*$g,$e[4]=$q*$k-$p*$h,$e[5]=$q*$l-$p*$i,$e[6]=$m,$e[7]=$n,$e[8]=$o},$c.scale=function($c,$d){var $e=$d.elements,$f=this.elements,$g=$c.elements,$h=$g[0],$i=$g[1];$e[0]=$h*$f[0],$e[1]=$h*$f[1],$e[2]=$h*$f[2],$e[3]=$i*$f[3],$e[4]=$i*$f[4],$e[5]=$i*$f[5],$e[6]=$f[6],$e[7]=$f[7],$e[8]=$f[8]},$c.invert=function($c){var $d=$c.elements,$e=this.elements,$f=$e[0],$g=$e[1],$h=$e[2],$i=$e[3],$j=$e[4],$k=$e[5],$l=$e[6],$m=$e[7],$n=$e[8],$o=$n*$j-$k*$m,$p=-$n*$i+$k*$l,$q=$m*$i-$j*$l,$r=$f*$o+$g*$p+$h*$q;$r||($c=null),$r=1/$r,$d[0]=$o*$r,$d[1]=(-$n*$g+$h*$m)*$r,$d[2]=($k*$g-$h*$j)*$r,$d[3]=$p*$r,$d[4]=($n*$f-$h*$l)*$r,$d[5]=(-$k*$f+$h*$i)*$r,$d[6]=$q*$r,$d[7]=(-$m*$f+$g*$l)*$r,$d[8]=($j*$f-$g*$i)*$r},$c.transpose=function($c){var $d=$c.elements,$e=this.elements;if($c===this){var $f=$e[1],$g=$e[2],$h=$e[5];$d[1]=$e[3],$d[2]=$e[6],$d[3]=$f,$d[5]=$e[7],$d[6]=$g,$d[7]=$h}else $d[0]=$e[0],$d[1]=$e[3],$d[2]=$e[6],$d[3]=$e[1],$d[4]=$e[4],$d[5]=$e[7],$d[6]=$e[2],$d[7]=$e[5],$d[8]=$e[8]},$c.identity=function(){var $c=this.elements;$c[0]=1,$c[1]=0,$c[2]=0,$c[3]=0,$c[4]=1,$c[5]=0,$c[6]=0,$c[7]=0,$c[8]=1},$c.cloneTo=function($c){var $d,$e,$f;if(($e=this.elements)!==($f=$c.elements))for($d=0;$d<9;++$d)$f[$d]=$e[$d]},$c.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$k.createFromTranslation=function($c,$d){$d.elements;var $e=$c.elements;$d[0]=1,$d[1]=0,$d[2]=0,$d[3]=0,$d[4]=1,$d[5]=0,$d[6]=$e[0],$d[7]=$e[1],$d[8]=1},$k.createFromRotation=function($c,$d){var $e=$d.elements,$f=Math.sin($c),$g=Math.cos($c);$e[0]=$g,$e[1]=$f,$e[2]=0,$e[3]=-$f,$e[4]=$g,$e[5]=0,$e[6]=0,$e[7]=0,$e[8]=1},$k.createFromScaling=function($c,$d){var $e=$d.elements,$f=$c.elements;$e[0]=$f[0],$e[1]=0,$e[2]=0,$e[3]=0,$e[4]=$f[1],$e[5]=0,$e[6]=0,$e[7]=0,$e[8]=1},$k.createFromMatrix4x4=function($c,$d){$d[0]=$c[0],$d[1]=$c[1],$d[2]=$c[2],$d[3]=$c[4],$d[4]=$c[5],$d[5]=$c[6],$d[6]=$c[8],$d[7]=$c[9],$d[8]=$c[10]},$k.multiply=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements,$i=$g[0],$j=$g[1],$k=$g[2],$l=$g[3],$m=$g[4],$n=$g[5],$o=$g[6],$p=$g[7],$q=$g[8],$r=$h[0],$s=$h[1],$t=$h[2],$u=$h[3],$v=$h[4],$w=$h[5],$x=$h[6],$y=$h[7],$z=$h[8];$f[0]=$r*$i+$s*$l+$t*$o,$f[1]=$r*$j+$s*$m+$t*$p,$f[2]=$r*$k+$s*$n+$t*$q,$f[3]=$u*$i+$v*$l+$w*$o,$f[4]=$u*$j+$v*$m+$w*$p,$f[5]=$u*$k+$v*$n+$w*$q,$f[6]=$x*$i+$y*$l+$z*$o,$f[7]=$x*$j+$y*$m+$z*$p,$f[8]=$x*$k+$y*$n+$z*$q},$k.lookAt=function($c,$d,$e,$f){$id.subtract($c,$d,$k._tempV30),$id.normalize($k._tempV30,$k._tempV30),$id.cross($e,$k._tempV30,$k._tempV31),$id.normalize($k._tempV31,$k._tempV31),$id.cross($k._tempV30,$k._tempV31,$k._tempV32);var $g=$k._tempV30.elements,$h=$k._tempV31.elements,$i=$k._tempV32.elements,$j=$f.elements;$j[0]=$h[0],$j[3]=$h[1],$j[6]=$h[2],$j[1]=$i[0],$j[4]=$i[1],$j[7]=$i[2],$j[2]=$g[0],$j[5]=$g[1],$j[8]=$g[2]},$k.DEFAULT=new $k,$n($k,["_tempV30",function(){return this._tempV30=new $id},"_tempV31",function(){return this._tempV31=new $id},"_tempV32",function(){return this._tempV32=new $id}]),$k}(),$cd=function(){function $B($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$n,$o,$p,$q,$r){void 0===$c&&($c=1),void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=0),void 0===$g&&($g=0),void 0===$h&&($h=1),void 0===$i&&($i=0),void 0===$j&&($j=0),void 0===$k&&($k=0),void 0===$l&&($l=0),void 0===$m&&($m=1),void 0===$n&&($n=0),void 0===$o&&($o=0),void 0===$p&&($p=0),void 0===$q&&($q=0),void 0===$r&&($r=1);var $s=this.elements=new Float32Array(16);$s[0]=$c,$s[1]=$d,$s[2]=$e,$s[3]=$f,$s[4]=$g,$s[5]=$h,$s[6]=$i,$s[7]=$j,$s[8]=$k,$s[9]=$l,$s[10]=$m,$s[11]=$n,$s[12]=$o,$s[13]=$p,$s[14]=$q,$s[15]=$r}$p($B,"laya.d3.math.Matrix4x4");var $c=$B.prototype;return $x.imps($c,{"laya.d3.core.IClone":!0}),$c.getElementByRowColumn=function($c,$d){if($c<0||3<$c)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($d<0||3<$d)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*$c+$d]},$c.setElementByRowColumn=function($c,$d,$e){if($c<0||3<$c)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($d<0||3<$d)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*$c+$d]=$e},$c.equalsOtherMatrix=function($c){var $d=this.elements,$e=$c.elements;return $ac.nearEqual($d[0],$e[0])&&$ac.nearEqual($d[1],$e[1])&&$ac.nearEqual($d[2],$e[2])&&$ac.nearEqual($d[3],$e[3])&&$ac.nearEqual($d[4],$e[4])&&$ac.nearEqual($d[5],$e[5])&&$ac.nearEqual($d[6],$e[6])&&$ac.nearEqual($d[7],$e[7])&&$ac.nearEqual($d[8],$e[8])&&$ac.nearEqual($d[9],$e[9])&&$ac.nearEqual($d[10],$e[10])&&$ac.nearEqual($d[11],$e[11])&&$ac.nearEqual($d[12],$e[12])&&$ac.nearEqual($d[13],$e[13])&&$ac.nearEqual($d[14],$e[14])&&$ac.nearEqual($d[15],$e[15])},$c.decomposeTransRotScale=function($c,$d,$e){var $f=$B._tempMatrix4x4;return this.decomposeTransRotMatScale($c,$f,$e)?($ed.createFromMatrix4x4($f,$d),!0):($d.identity(),!1)},$c.decomposeTransRotMatScale=function($c,$d,$e){var $f=this.elements,$g=$c.elements,$h=$d.elements,$i=$e.elements;$g[0]=$f[12],$g[1]=$f[13],$g[2]=$f[14];var $j=$f[0],$k=$f[1],$l=$f[2],$m=$f[4],$n=$f[5],$o=$f[6],$p=$f[8],$q=$f[9],$r=$f[10],$s=$i[0]=Math.sqrt($j*$j+$k*$k+$l*$l),$t=$i[1]=Math.sqrt($m*$m+$n*$n+$o*$o),$u=$i[2]=Math.sqrt($p*$p+$q*$q+$r*$r);if($ac.isZero($s)||$ac.isZero($t)||$ac.isZero($u))return $h[1]=$h[2]=$h[3]=$h[4]=$h[6]=$h[7]=$h[8]=$h[9]=$h[11]=$h[12]=$h[13]=$h[14]=0,$h[0]=$h[5]=$h[10]=$h[15]=1,!1;var $v=$B._tempVector0,$w=$v.elements;$w[0]=$p/$u,$w[1]=$q/$u,$w[2]=$r/$u;var $x=$B._tempVector1,$y=$x.elements;$y[0]=$j/$s,$y[1]=$k/$s,$y[2]=$l/$s;var $z=$B._tempVector2;$id.cross($v,$x,$z);var $A=$B._tempVector1;return $id.cross($z,$v,$A),$h[3]=$h[7]=$h[11]=$h[12]=$h[13]=$h[14]=0,$h[15]=1,$h[0]=$A.x,$h[1]=$A.y,$h[2]=$A.z,$h[4]=$z.x,$h[5]=$z.y,$h[6]=$z.z,$h[8]=$v.x,$h[9]=$v.y,$h[10]=$v.z,$h[0]*$j+$h[1]*$k+$h[2]*$l<0&&($i[0]=-$s),$h[4]*$m+$h[5]*$n+$h[6]*$o<0&&($i[1]=-$t),$h[8]*$p+$h[9]*$q+$h[10]*$r<0&&($i[2]=-$u),!0},$c.decomposeYawPitchRoll=function($c){var $d=$c.elements,$e=Math.asin(-this.elements[9]);$d[1]=$e,Math.cos($e)>$ac.zeroTolerance?($d[2]=Math.atan2(this.elements[1],this.elements[5]),$d[0]=Math.atan2(this.elements[8],this.elements[10])):($d[2]=Math.atan2(-this.elements[4],this.elements[0]),$d[0]=0)},$c.normalize=function(){var $c=this.elements,$d=$c[0],$e=$c[1],$f=$c[2],$g=Math.sqrt($d*$d+$e*$e+$f*$f);if(!$g)return $c[0]=0,$c[1]=0,void($c[2]=0);1!=$g&&($g=1/$g,$c[0]=$d*$g,$c[1]=$e*$g,$c[2]=$f*$g)},$c.transpose=function(){var $c,$d;return $d=($c=this.elements)[1],$c[1]=$c[4],$c[4]=$d,$d=$c[2],$c[2]=$c[8],$c[8]=$d,$d=$c[3],$c[3]=$c[12],$c[12]=$d,$d=$c[6],$c[6]=$c[9],$c[9]=$d,$d=$c[7],$c[7]=$c[13],$c[13]=$d,$d=$c[11],$c[11]=$c[14],$c[14]=$d,this},$c.invert=function($c){var $d=this.elements,$e=$c.elements,$f=$d[0],$g=$d[1],$h=$d[2],$i=$d[3],$j=$d[4],$k=$d[5],$l=$d[6],$m=$d[7],$n=$d[8],$o=$d[9],$p=$d[10],$q=$d[11],$r=$d[12],$s=$d[13],$t=$d[14],$u=$d[15],$v=$f*$k-$g*$j,$w=$f*$l-$h*$j,$x=$f*$m-$i*$j,$y=$g*$l-$h*$k,$z=$g*$m-$i*$k,$A=$h*$m-$i*$l,$B=$n*$s-$o*$r,$C=$n*$t-$p*$r,$D=$n*$u-$q*$r,$E=$o*$t-$p*$s,$F=$o*$u-$q*$s,$G=$p*$u-$q*$t,$H=$v*$G-$w*$F+$x*$E+$y*$D-$z*$C+$A*$B;0!==Math.abs($H)&&($H=1/$H,$e[0]=($k*$G-$l*$F+$m*$E)*$H,$e[1]=($h*$F-$g*$G-$i*$E)*$H,$e[2]=($s*$A-$t*$z+$u*$y)*$H,$e[3]=($p*$z-$o*$A-$q*$y)*$H,$e[4]=($l*$D-$j*$G-$m*$C)*$H,$e[5]=($f*$G-$h*$D+$i*$C)*$H,$e[6]=($t*$x-$r*$A-$u*$w)*$H,$e[7]=($n*$A-$p*$x+$q*$w)*$H,$e[8]=($j*$F-$k*$D+$m*$B)*$H,$e[9]=($g*$D-$f*$F-$i*$B)*$H,$e[10]=($r*$z-$s*$x+$u*$v)*$H,$e[11]=($o*$x-$n*$z-$q*$v)*$H,$e[12]=($k*$C-$j*$E-$l*$B)*$H,$e[13]=($f*$E-$g*$C+$h*$B)*$H,$e[14]=($s*$w-$r*$y-$t*$v)*$H,$e[15]=($n*$y-$o*$w+$p*$v)*$H)},$c.identity=function(){var $c=this.elements;$c[1]=$c[2]=$c[3]=$c[4]=$c[6]=$c[7]=$c[8]=$c[9]=$c[11]=$c[12]=$c[13]=$c[14]=0,$c[0]=$c[5]=$c[10]=$c[15]=1},$c.cloneTo=function($c){var $d,$e,$f;if(($e=this.elements)!==($f=$c.elements))for($d=0;$d<16;++$d)$f[$d]=$e[$d]},$c.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$c.getTranslationVector=function($c){var $d=this.elements,$e=$c.elements;$e[0]=$d[12],$e[1]=$d[13],$e[2]=$d[14]},$c.setTranslationVector=function($c){var $d=this.elements,$e=$c.elements;$d[12]=$e[0],$d[13]=$e[1],$d[14]=$e[2]},$c.getForward=function($c){var $d=this.elements,$e=$c.elements;$e[0]=-$d[8],$e[1]=-$d[9],$e[2]=-$d[10]},$c.setForward=function($c){var $d=this.elements,$e=$c.elements;$d[8]=-$e[0],$d[9]=-$e[1],$d[10]=-$e[2]},$B.createRotationX=function($c,$d){var $e=$d.elements,$f=Math.sin($c),$g=Math.cos($c);$e[1]=$e[2]=$e[3]=$e[4]=$e[7]=$e[8]=$e[11]=$e[12]=$e[13]=$e[14]=0,$e[0]=$e[15]=1,$e[5]=$e[10]=$g,$e[6]=$f,$e[9]=-$f},$B.createRotationY=function($c,$d){var $e=$d.elements,$f=Math.sin($c),$g=Math.cos($c);$e[1]=$e[3]=$e[4]=$e[6]=$e[7]=$e[9]=$e[11]=$e[12]=$e[13]=$e[14]=0,$e[5]=$e[15]=1,$e[0]=$e[10]=$g,$e[2]=-$f,$e[8]=$f},$B.createRotationZ=function($c,$d){var $e=$d.elements,$f=Math.sin($c),$g=Math.cos($c);$e[2]=$e[3]=$e[6]=$e[7]=$e[8]=$e[9]=$e[11]=$e[12]=$e[13]=$e[14]=0,$e[10]=$e[15]=1,$e[0]=$e[5]=$g,$e[1]=$f,$e[4]=-$f},$B.createRotationYawPitchRoll=function($c,$d,$e,$f){$ed.createFromYawPitchRoll($c,$d,$e,$B._tempQuaternion),$B.createRotationQuaternion($B._tempQuaternion,$f)},$B.createRotationAxis=function($c,$d,$e){var $f=$c.elements,$g=$f[0],$h=$f[1],$i=$f[2],$j=Math.cos($d),$k=Math.sin($d),$l=$g*$g,$m=$h*$h,$n=$i*$i,$o=$g*$h,$p=$g*$i,$q=$h*$i,$r=$e.elements;$r[3]=$r[7]=$r[11]=$r[12]=$r[13]=$r[14]=0,$r[15]=1,$r[0]=$l+$j*(1-$l),$r[1]=$o-$j*$o+$k*$i,$r[2]=$p-$j*$p-$k*$h,$r[4]=$o-$j*$o-$k*$i,$r[5]=$m+$j*(1-$m),$r[6]=$q-$j*$q+$k*$g,$r[8]=$p-$j*$p+$k*$h,$r[9]=$q-$j*$q-$k*$g,$r[10]=$n+$j*(1-$n)},$B.createRotationQuaternion=function($c,$d){var $e=$c.elements,$f=$d.elements,$g=$e[0],$h=$e[1],$i=$e[2],$j=$e[3],$k=$g*$g,$l=$h*$h,$m=$i*$i,$n=$g*$h,$o=$i*$j,$p=$i*$g,$q=$h*$j,$r=$h*$i,$s=$g*$j;$f[3]=$f[7]=$f[11]=$f[12]=$f[13]=$f[14]=0,$f[15]=1,$f[0]=1-2*($l+$m),$f[1]=2*($n+$o),$f[2]=2*($p-$q),$f[4]=2*($n-$o),$f[5]=1-2*($m+$k),$f[6]=2*($r+$s),$f[8]=2*($p+$q),$f[9]=2*($r-$s),$f[10]=1-2*($l+$k)},$B.createTranslate=function($c,$d){var $e=$c.elements,$f=$d.elements;$f[4]=$f[8]=$f[1]=$f[9]=$f[2]=$f[6]=$f[3]=$f[7]=$f[11]=0,$f[0]=$f[5]=$f[10]=$f[15]=1,$f[12]=$e[0],$f[13]=$e[1],$f[14]=$e[2]},$B.createScaling=function($c,$d){var $e=$c.elements,$f=$d.elements;$f[0]=$e[0],$f[5]=$e[1],$f[10]=$e[2],$f[1]=$f[4]=$f[8]=$f[12]=$f[9]=$f[13]=$f[2]=$f[6]=$f[14]=$f[3]=$f[7]=$f[11]=0,$f[15]=1},$B.multiply=function($c,$d,$e){var $f,$g,$h,$i,$j,$k,$l,$m;for($g=$e.elements,$h=$c.elements,$g===($i=$d.elements)&&($i=$i.slice()),$f=0;$f<4;$f++)$j=$h[$f],$k=$h[$f+4],$l=$h[$f+8],$m=$h[$f+12],$g[$f]=$j*$i[0]+$k*$i[1]+$l*$i[2]+$m*$i[3],$g[$f+4]=$j*$i[4]+$k*$i[5]+$l*$i[6]+$m*$i[7],$g[$f+8]=$j*$i[8]+$k*$i[9]+$l*$i[10]+$m*$i[11],$g[$f+12]=$j*$i[12]+$k*$i[13]+$l*$i[14]+$m*$i[15]},$B.createFromQuaternion=function($c,$d){var $e=$d.elements,$f=$c.elements,$g=$f[0],$h=$f[1],$i=$f[2],$j=$f[3],$k=$g+$g,$l=$h+$h,$m=$i+$i,$n=$g*$k,$o=$h*$k,$p=$h*$l,$q=$i*$k,$r=$i*$l,$s=$i*$m,$t=$j*$k,$u=$j*$l,$v=$j*$m;$e[0]=1-$p-$s,$e[1]=$o+$v,$e[2]=$q-$u,$e[3]=0,$e[4]=$o-$v,$e[5]=1-$n-$s,$e[6]=$r+$t,$e[7]=0,$e[8]=$q+$u,$e[9]=$r-$t,$e[10]=1-$n-$p,$e[11]=0,$e[12]=0,$e[13]=0,$e[14]=0,$e[15]=1},$B.createAffineTransformation=function($c,$d,$e,$f){var $g=$c.elements,$h=$d.elements,$i=$e.elements,$j=$f.elements,$k=$h[0],$l=$h[1],$m=$h[2],$n=$h[3],$o=$k+$k,$p=$l+$l,$q=$m+$m,$r=$k*$o,$s=$k*$p,$t=$k*$q,$u=$l*$p,$v=$l*$q,$w=$m*$q,$x=$n*$o,$y=$n*$p,$z=$n*$q,$A=$i[0],$B=$i[1],$C=$i[2];$j[0]=(1-($u+$w))*$A,$j[1]=($s+$z)*$A,$j[2]=($t-$y)*$A,$j[3]=0,$j[4]=($s-$z)*$B,$j[5]=(1-($r+$w))*$B,$j[6]=($v+$x)*$B,$j[7]=0,$j[8]=($t+$y)*$C,$j[9]=($v-$x)*$C,$j[10]=(1-($r+$u))*$C,$j[11]=0,$j[12]=$g[0],$j[13]=$g[1],$j[14]=$g[2],$j[15]=1},$B.createLookAt=function($c,$d,$e,$f){var $g=$f.elements,$h=$B._tempVector0,$i=$B._tempVector1,$j=$B._tempVector2;$id.subtract($c,$d,$j),$id.normalize($j,$j),$id.cross($e,$j,$h),$id.normalize($h,$h),$id.cross($j,$h,$i),$f.identity(),$g[0]=$h.x,$g[4]=$h.y,$g[8]=$h.z,$g[1]=$i.x,$g[5]=$i.y,$g[9]=$i.z,$g[2]=$j.x,$g[6]=$j.y,$g[10]=$j.z,$g[12]=-$id.dot($h,$c),$g[13]=-$id.dot($i,$c),$g[14]=-$id.dot($j,$c)},$B.createPerspective=function($c,$d,$e,$f,$g){var $h=$g.elements,$i=1/Math.tan($c/2),$j=1/($e-$f);$h[0]=$i/$d,$h[5]=$i,$h[10]=($f+$e)*$j,$h[11]=-1,$h[14]=2*$f*$e*$j,$h[1]=$h[2]=$h[3]=$h[4]=$h[6]=$h[7]=$h[8]=$h[9]=$h[12]=$h[13]=$h[15]=0},$B.createOrthoOffCenterRH=function($c,$d,$e,$f,$g,$h,$i){var $j=$i.elements,$k=1/($c-$d),$l=1/($e-$f),$m=1/($g-$h);$j[1]=$j[2]=$j[3]=$j[4]=$j[6]=$j[7]=$j[8]=$j[9]=$j[11]=0,$j[15]=1,$j[0]=-2*$k,$j[5]=-2*$l,$j[10]=2*$m,$j[12]=($c+$d)*$k,$j[13]=($f+$e)*$l,$j[14]=($h+$g)*$m},$B.translation=function($c,$d){var $e=$c.elements,$f=$d.elements;$f[0]=$f[5]=$f[10]=$f[15]=1,$f[12]=$e[0],$f[13]=$e[1],$f[14]=$e[2]},$n($B,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $B},"_tempVector0",function(){return this._tempVector0=new $id},"_tempVector1",function(){return this._tempVector1=new $id},"_tempVector2",function(){return this._tempVector2=new $id},"_tempQuaternion",function(){return this._tempQuaternion=new $ed},"DEFAULT",function(){return this.DEFAULT=new $B},"ZERO",function(){return this.ZERO=new $B(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),$B}(),$dd=(function(){function $v($c,$d){this.extents=null,this.transformation=null,this.extents=$c,this.transformation=$d}$p($v,"laya.d3.math.OrientedBoundBox");var $c=$v.prototype;$c.getCorners=function($c){var $d=$v._tempV30.elements,$e=$v._tempV31.elements,$f=$v._tempV32.elements,$g=this.extents.elements;$d[0]=$g[0],$d[1]=$d[2]=0,$e[1]=$g[1],$e[0]=$e[2]=0,$f[2]=$g[2],$f[0]=$f[1]=0,$id.TransformNormal($v._tempV30,this.transformation,$v._tempV30),$id.TransformNormal($v._tempV31,this.transformation,$v._tempV31),$id.TransformNormal($v._tempV32,this.transformation,$v._tempV32);var $h=$v._tempV33;this.transformation.getTranslationVector($h),$c.length=8,$id.add($h,$v._tempV30,$v._tempV34),$id.add($v._tempV34,$v._tempV31,$v._tempV34),$id.add($v._tempV34,$v._tempV32,$c[0]),$id.add($h,$v._tempV30,$v._tempV34),$id.add($v._tempV34,$v._tempV31,$v._tempV34),$id.subtract($v._tempV34,$v._tempV32,$c[1]),$id.subtract($h,$v._tempV30,$v._tempV34),$id.add($v._tempV34,$v._tempV31,$v._tempV34),$id.subtract($v._tempV34,$v._tempV32,$c[2]),$id.subtract($h,$v._tempV30,$v._tempV34),$id.add($v._tempV34,$v._tempV31,$v._tempV34),$id.add($v._tempV34,$v._tempV32,$c[3]),$id.add($h,$v._tempV30,$v._tempV34),$id.subtract($v._tempV34,$v._tempV31,$v._tempV34),$id.add($v._tempV34,$v._tempV32,$c[4]),$id.add($h,$v._tempV30,$v._tempV34),$id.subtract($v._tempV34,$v._tempV31,$v._tempV34),$id.subtract($v._tempV34,$v._tempV32,$c[5]),$id.subtract($h,$v._tempV30,$v._tempV34),$id.subtract($v._tempV34,$v._tempV31,$v._tempV34),$id.subtract($v._tempV34,$v._tempV32,$c[6]),$id.subtract($h,$v._tempV30,$v._tempV34),$id.subtract($v._tempV34,$v._tempV31,$v._tempV34),$id.add($v._tempV34,$v._tempV32,$c[7])},$c.transform=function($c){$cd.multiply(this.transformation,$c,this.transformation)},$c.scale=function($c){$id.multiply(this.extents,$c,this.extents)},$c.translate=function($c){this.transformation.getTranslationVector($v._tempV30),$id.add($v._tempV30,$c,$v._tempV31),this.transformation.setTranslationVector($v._tempV31)},$c.Size=function($c){$id.scale(this.extents,2,$c)},$c.getSize=function($c){var $d=this.extents.elements;$v._tempV30.x=$d[0],$v._tempV31.y=$d[1],$v._tempV32.z=$d[2],$id.TransformNormal($v._tempV30,this.transformation,$v._tempV30),$id.TransformNormal($v._tempV31,this.transformation,$v._tempV31),$id.TransformNormal($v._tempV31,this.transformation,$v._tempV32);var $e=$c.elements;$e[0]=$id.scalarLength($v._tempV30),$e[1]=$id.scalarLength($v._tempV31),$e[2]=$id.scalarLength($v._tempV32)},$c.getSizeSquared=function($c){var $d=this.extents.elements;$v._tempV30.x=$d[0],$v._tempV31.y=$d[1],$v._tempV32.z=$d[2],$id.TransformNormal($v._tempV30,this.transformation,$v._tempV30),$id.TransformNormal($v._tempV31,this.transformation,$v._tempV31),$id.TransformNormal($v._tempV31,this.transformation,$v._tempV32);var $e=$c.elements;$e[0]=$id.scalarLengthSquared($v._tempV30),$e[1]=$id.scalarLengthSquared($v._tempV31),$e[2]=$id.scalarLengthSquared($v._tempV32)},$c.getCenter=function($c){this.transformation.getTranslationVector($c)},$c.containsPoint=function($c){var $d=this.extents.elements,$e=$d[0],$f=$d[1],$g=$d[2];this.transformation.invert($v._tempM0),$id.transformCoordinate($c,$v._tempM0,$v._tempV30);var $h=$v._tempV30.elements,$i=Math.abs($h[0]),$j=Math.abs($h[1]),$k=Math.abs($h[2]);return $ac.nearEqual($i,$e)&&$ac.nearEqual($j,$f)&&$ac.nearEqual($k,$g)?2:$i<$e&&$j<$f&&$k<$g?1:0},$c.containsPoints=function($c){var $d=this.extents.elements,$e=$d[0],$f=$d[1],$g=$d[2];this.transformation.invert($v._tempM0);for(var $h=!0,$i=!1,$j=0;$j<$c.length;$j++){$id.transformCoordinate($c[$j],$v._tempM0,$v._tempV30);var $k=$v._tempV30.elements,$l=Math.abs($k[0]),$m=Math.abs($k[1]),$n=Math.abs($k[2]);$ac.nearEqual($l,$e)&&$ac.nearEqual($m,$f)&&$ac.nearEqual($n,$g)&&($i=!0),$l<$e&&$m<$f&&$n<$g?$i=!0:$h=!1}return $h?1:$i?2:0},$c.containsSphere=function($c,$d){void 0===$d&&($d=!1);var $e=this.extents.elements,$f=$e[0],$g=$e[1],$h=$e[2],$i=$c.radius;this.transformation.invert($v._tempM0),$id.transformCoordinate($c.center,$v._tempM0,$v._tempV30);var $j=NaN;if($j=$d?$i:($id.scale($id.UnitX,$i,$v._tempV31),$id.TransformNormal($v._tempV31,$v._tempM0,$v._tempV31),$id.scalarLength($v._tempV31)),$id.scale(this.extents,-1,$v._tempV32),$id.Clamp($v._tempV30,$v._tempV32,this.extents,$v._tempV33),$j*$j<$id.distanceSquared($v._tempV30,$v._tempV33))return 0;var $k=$v._tempV30.elements,$l=$k[0],$m=$k[1],$n=$k[2],$o=$v._tempV32.elements,$p=$o[0],$q=$o[1],$r=$o[2];return $p+$j<=$l&&$l<=$f-$j&&$j<$f-$p&&$q+$j<=$m&&$m<=$g-$j&&$j<$g-$q&&$r+$j<=$n&&$n<=$h-$j&&$j<$h-$r?1:2},$c.containsOrientedBoundBox=function($c){var $d=0,$e=0;$c.getCorners($v._corners);var $f=this.containsPoints($v._corners);if(0!=$f)return $f;var $g=this.extents.elements;$c.extents.cloneTo($v._tempV35);var $h=$v._tempV35.elements;$v._getRows(this.transformation,$v._rows1),$v._getRows($c.transformation,$v._rows2);var $i=NaN;for($d=0;$d<4;$d++)for($e=0;$e<4;$e++)3==$d||3==$e?($v._tempM0.setElementByRowColumn($d,$e,0),$v._tempM1.setElementByRowColumn($d,$e,0)):($i=$id.dot($v._rows1[$d],$v._rows2[$e]),$v._tempM0.setElementByRowColumn($d,$e,$i),$v._tempM1.setElementByRowColumn($d,$e,Math.abs($i)));$c.getCenter($v._tempV34),this.getCenter($v._tempV36),$id.subtract($v._tempV34,$v._tempV36,$v._tempV30);var $j=$v._tempV31.elements;$j[0]=$id.dot($v._tempV30,$v._rows1[0]),$j[1]=$id.dot($v._tempV30,$v._rows1[1]),$j[2]=$id.dot($v._tempV30,$v._rows1[2]);var $k=$v._tempV32.elements,$l=$v._tempV33.elements;for($d=0;$d<3;$d++)if($k[0]=$v._tempM1.getElementByRowColumn($d,0),$k[1]=$v._tempM1.getElementByRowColumn($d,1),$k[2]=$v._tempM1.getElementByRowColumn($d,2),$g[$d]+$id.dot($v._tempV35,$v._tempV32)<Math.abs($j[$d]))return 0;for($e=0;$e<3;$e++)if($k[0]=$v._tempM1.getElementByRowColumn(0,$e),$k[1]=$v._tempM1.getElementByRowColumn(1,$e),$k[2]=$v._tempM1.getElementByRowColumn(2,$e),$l[0]=$v._tempM0.getElementByRowColumn(0,$e),$l[1]=$v._tempM0.getElementByRowColumn(1,$e),$l[2]=$v._tempM0.getElementByRowColumn(2,$e),$id.dot(this.extents,$v._tempV32)+$h[$e]<Math.abs($id.dot($v._tempV31,$v._tempV33)))return 0;for($d=0;$d<3;$d++)for($e=0;$e<3;$e++){var $m=($d+1)%3,$n=($d+2)%3,$o=($e+1)%3,$p=($e+2)%3;if($g[$m]*$v._tempM1.getElementByRowColumn($n,$e)+$g[$n]*$v._tempM1.getElementByRowColumn($m,$e)+($h[$o]*$v._tempM1.getElementByRowColumn($d,$p)+$h[$p]*$v._tempM1.getElementByRowColumn($d,$o))<Math.abs($j[$n]*$v._tempM0.getElementByRowColumn($m,$e)-$j[$m]*$v._tempM0.getElementByRowColumn($n,$e)))return 0}return 2},$c.containsLine=function($c,$d){$v._corners[0]=$c,$v._corners[1]=$d;var $e=this.containsPoints($v._corners);if(0!=$e)return $e;var $f=this.extents.elements,$g=$f[0],$h=$f[1],$i=$f[2];this.transformation.invert($v._tempM0),$id.transformCoordinate($c,$v._tempM0,$v._tempV30),$id.transformCoordinate($d,$v._tempM0,$v._tempV31),$id.add($v._tempV30,$v._tempV31,$v._tempV32),$id.scale($v._tempV32,.5,$v._tempV32),$id.subtract($v._tempV30,$v._tempV32,$v._tempV33);var $j=$v._tempV33.elements,$k=$j[0],$l=$j[1],$m=$j[2],$n=$v._tempV34.elements,$o=$n[0]=Math.abs($j[0]),$p=$n[1]=Math.abs($j[1]),$q=$n[2]=Math.abs($j[2]),$r=$v._tempV32.elements,$s=$r[0],$t=$r[1],$u=$r[2];return Math.abs($s)>$g+$o?0:Math.abs($t)>$h+$p?0:Math.abs($u)>$i+$q?0:Math.abs($t*$m-$u*$l)>$h*$q+$i*$p?0:Math.abs($s*$m-$u*$k)>$g*$q+$i*$o?0:Math.abs($s*$l-$t*$k)>$g*$p+$h*$o?0:2},$c.containsBoundBox=function($c){var $d=0,$e=0,$f=$c.min,$g=$c.max;$c.getCorners($v._corners);var $h=this.containsPoints($v._corners);if(0!=$h)return $h;$id.subtract($g,$f,$v._tempV30),$id.scale($v._tempV30,.5,$v._tempV30),$id.add($f,$v._tempV30,$v._tempV30),$id.subtract($g,$v._tempV30,$v._tempV31);var $i=this.extents.elements,$j=$v._tempV31.elements;$v._getRows(this.transformation,$v._rows1),this.transformation.invert($v._tempM0);for($d=0;$d<3;$d++)for($e=0;$e<3;$e++)$v._tempM1.setElementByRowColumn($d,$e,Math.abs($v._tempM0.getElementByRowColumn($d,$e)));this.getCenter($v._tempV35),$id.subtract($v._tempV30,$v._tempV35,$v._tempV32);var $k=$v._tempV31.elements;$k[0]=$id.dot($v._tempV32,$v._rows1[0]),$k[1]=$id.dot($v._tempV32,$v._rows1[1]),$k[2]=$id.dot($v._tempV32,$v._rows1[2]);var $l=$v._tempV33.elements,$m=$v._tempV34.elements;for($d=0;$d<3;$d++)if($l[0]=$v._tempM1.getElementByRowColumn($d,0),$l[1]=$v._tempM1.getElementByRowColumn($d,1),$l[2]=$v._tempM1.getElementByRowColumn($d,2),$i[$d]+$id.dot($v._tempV31,$v._tempV33)<Math.abs($k[$d]))return 0;for($e=0;$e<3;$e++)if($l[0]=$v._tempM1.getElementByRowColumn(0,$e),$l[1]=$v._tempM1.getElementByRowColumn(1,$e),$l[2]=$v._tempM1.getElementByRowColumn(2,$e),$m[0]=$v._tempM0.getElementByRowColumn(0,$e),$m[1]=$v._tempM0.getElementByRowColumn(1,$e),$m[2]=$v._tempM0.getElementByRowColumn(2,$e),$id.dot(this.extents,$v._tempV33)+$j[$e]<Math.abs($id.dot($v._tempV31,$v._tempV34)))return 0;for($d=0;$d<3;$d++)for($e=0;$e<3;$e++){var $n=($d+1)%3,$o=($d+2)%3,$p=($e+1)%3,$q=($e+2)%3;if($i[$n]*$v._tempM1.getElementByRowColumn($o,$e)+$i[$o]*$v._tempM1.getElementByRowColumn($n,$e)+($j[$p]*$v._tempM1.getElementByRowColumn($d,$q)+$j[$q]*$v._tempM1.getElementByRowColumn($d,$p))<Math.abs($k[$o]*$v._tempM0.getElementByRowColumn($n,$e)-$k[$n]*$v._tempM0.getElementByRowColumn($o,$e)))return 0}return 2},$c.intersectsRay=function($c,$d){$id.scale(this.extents,-1,$v._tempV30),this.transformation.invert($v._tempM0),$id.TransformNormal($c.direction,$v._tempM0,$v._ray.direction),$id.transformCoordinate($c.origin,$v._tempM0,$v._ray.origin),$v._boxBound1.min=$v._tempV30,$v._boxBound1.max=this.extents;var $e=Collision.intersectsRayAndBoxRP($v._ray,$v._boxBound1,$d);return-1!==$e&&$id.transformCoordinate($d,this.transformation,$d),$e},$c._getLocalCorners=function($c){$c.length=8;var $d=this.extents.elements;$v._tempV30.x=$d[0],$v._tempV31.y=$d[1],$v._tempV32.z=$d[2],$id.add($v._tempV30,$v._tempV31,$v._tempV33),$id.add($v._tempV33,$v._tempV32,$c[0]),$id.add($v._tempV30,$v._tempV31,$v._tempV33),$id.subtract($v._tempV33,$v._tempV32,$c[1]),$id.subtract($v._tempV31,$v._tempV30,$v._tempV33),$id.subtract($v._tempV33,$v._tempV30,$c[2]),$id.subtract($v._tempV31,$v._tempV30,$v._tempV33),$id.add($v._tempV33,$v._tempV32,$c[3]),$id.subtract($v._tempV30,$v._tempV31,$v._tempV33),$id.add($v._tempV33,$v._tempV32,$c[4]),$id.subtract($v._tempV30,$v._tempV31,$v._tempV33),$id.subtract($v._tempV33,$v._tempV32,$c[5]),$id.scale($c[0],-1,$c[6]),$id.subtract($v._tempV32,$v._tempV30,$v._tempV33),$id.subtract($v._tempV33,$v._tempV31,$c[7])},$c.equals=function($c){return this.extents==$c.extents&&this.transformation==$c.transformation},$c.cloneTo=function($c){var $d=$c;this.extents.cloneTo($d.extents),this.transformation.cloneTo($d.transformation)},$v.createByBoundBox=function($c,$d){var $e=$c.min,$f=$c.max;$id.subtract($f,$e,$v._tempV30),$id.scale($v._tempV30,.5,$v._tempV30),$id.add($e,$v._tempV30,$v._tempV31),$id.subtract($f,$v._tempV31,$v._tempV32),$cd.translation($v._tempV31,$v._tempM0);var $g=$v._tempV32.clone(),$h=$v._tempM0.clone();$d.extents=$g,$d.transformation=$h},$v.createByMinAndMaxVertex=function($c,$d){return $id.subtract($d,$c,$v._tempV30),$id.scale($v._tempV30,.5,$v._tempV30),$id.add($c,$v._tempV30,$v._tempV31),$id.subtract($d,$v._tempV31,$v._tempV32),$cd.translation($v._tempV31,$v._tempM0),new $v($v._tempV32,$v._tempM0)},$v._getRows=function($c,$d){$d.length=3;var $e=$c.elements,$f=$d[0].elements;$f[0]=$e[0],$f[1]=$e[1],$f[2]=$e[2];var $g=$d[1].elements;$g[0]=$e[4],$g[1]=$e[5],$g[2]=$e[6];var $h=$d[2].elements;$h[0]=$e[8],$h[1]=$e[9],$h[2]=$e[10]},$v.getObbtoObbMatrix4x4=function($c,$d,$e,$f){var $g=$c.transformation,$h=$d.transformation;if($e){$v._getRows($g,$v._rows1),$v._getRows($h,$v._rows2);for(var $i=0;$i<3;$i++)for(var $j=0;$j<3;$j++)$f.setElementByRowColumn($i,$j,$id.dot($v._rows2[$i],$v._rows1[$j]));$d.getCenter($v._tempV30),$c.getCenter($v._tempV31),$id.subtract($v._tempV30,$v._tempV31,$v._tempV32);var $k=$f.elements;$k[12]=$id.dot($v._tempV32,$v._rows1[0]),$k[13]=$id.dot($v._tempV32,$v._rows1[1]),$k[14]=$id.dot($v._tempV32,$v._rows1[2]),$k[15]=1}else $g.invert($v._tempM0),$cd.multiply($h,$v._tempM0,$f)},$v.merge=function($c,$d,$e){var $f=$c.extents,$g=$c.transformation;$v.getObbtoObbMatrix4x4($c,$d,$e,$v._tempM0),$d._getLocalCorners($v._corners),$id.transformCoordinate($v._corners[0],$v._tempM0,$v._corners[0]),$id.transformCoordinate($v._corners[1],$v._tempM0,$v._corners[1]),$id.transformCoordinate($v._corners[2],$v._tempM0,$v._corners[2]),$id.transformCoordinate($v._corners[3],$v._tempM0,$v._corners[3]),$id.transformCoordinate($v._corners[4],$v._tempM0,$v._corners[4]),$id.transformCoordinate($v._corners[5],$v._tempM0,$v._corners[5]),$id.transformCoordinate($v._corners[6],$v._tempM0,$v._corners[6]),$id.transformCoordinate($v._corners[7],$v._tempM0,$v._corners[7]),$id.scale($f,-1,$v._boxBound1.min),$f.cloneTo($v._boxBound1.max),$Zc.createfromPoints($v._corners,$v._boxBound2),$Zc.merge($v._boxBound2,$v._boxBound1,$v._boxBound3);var $h=$v._boxBound3.min,$i=$v._boxBound3.max;$id.subtract($i,$h,$v._tempV30),$id.scale($v._tempV30,.5,$v._tempV30),$id.add($h,$v._tempV30,$v._tempV32),$id.subtract($i,$v._tempV32,$f),$id.transformCoordinate($v._tempV32,$g,$v._tempV33)},$n($v,["_tempV30",function(){return this._tempV30=new $id},"_tempV31",function(){return this._tempV31=new $id},"_tempV32",function(){return this._tempV32=new $id},"_tempV33",function(){return this._tempV33=new $id},"_tempV34",function(){return this._tempV34=new $id},"_tempV35",function(){return this._tempV35=new $id},"_tempV36",function(){return this._tempV36=new $id},"_tempM0",function(){return this._tempM0=new $cd},"_tempM1",function(){return this._tempM1=new $cd},"_corners",function(){return this._corners=[new $id,new $id,new $id,new $id,new $id,new $id,new $id,new $id]},"_rows1",function(){return this._rows1=[new $id,new $id,new $id]},"_rows2",function(){return this._rows2=[new $id,new $id,new $id]},"_ray",function(){return this._ray=new $gd(new $id,new $id)},"_boxBound1",function(){return this._boxBound1=new $Zc(new $id,new $id)},"_boxBound2",function(){return this._boxBound2=new $Zc(new $id,new $id)},"_boxBound3",function(){return this._boxBound3=new $Zc(new $id,new $id)}])}(),function(){function $x($c,$d){this.normal=null,this.distance=NaN,void 0===$d&&($d=0),this.normal=$c,this.distance=$d}return $p($x,"laya.d3.math.Plane"),$x.prototype.normalize=function(){var $c=this.normal.elements,$d=$c[0],$e=$c[1],$f=$c[2],$g=1/Math.sqrt($d*$d+$e*$e+$f*$f);$c[0]=$d*$g,$c[1]=$e*$g,$c[2]=$f*$g,this.distance*=$g},$x.createPlaneBy3P=function($c,$d,$e){var $f=$c.elements,$g=$d.elements,$h=$e.elements,$i=$g[0]-$f[0],$j=$g[1]-$f[1],$k=$g[2]-$f[2],$l=$h[0]-$f[0],$m=$h[1]-$f[1],$n=$h[2]-$f[2],$o=$j*$n-$k*$m,$p=$k*$l-$i*$n,$q=$i*$m-$j*$l,$r=1/Math.sqrt($o*$o+$p*$p+$q*$q),$s=$o*$r,$t=$p*$r,$u=$q*$r,$v=$x._TEMPVec3.elements;$v[0]=$s,$v[1]=$t,$v[2]=$u;var $w=-($s*$f[0]+$t*$f[1]+$u*$f[2]);return new $x($x._TEMPVec3,$w)},$x.PlaneIntersectionType_Back=0,$x.PlaneIntersectionType_Front=1,$x.PlaneIntersectionType_Intersecting=2,$n($x,["_TEMPVec3",function(){return this._TEMPVec3=new $id}]),$x}()),$ed=function(){function $g($c,$d,$e,$f){this.elements=new Float32Array(4),void 0===$c&&($c=0),void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=1),this.elements[0]=$c,this.elements[1]=$d,this.elements[2]=$e,this.elements[3]=$f}$p($g,"laya.d3.math.Quaternion");var $c=$g.prototype;return $x.imps($c,{"laya.d3.core.IClone":!0}),$c.scaling=function($c,$d){var $e=$d.elements,$f=this.elements;$e[0]=$f[0]*$c,$e[1]=$f[1]*$c,$e[2]=$f[2]*$c,$e[3]=$f[3]*$c},$c.normalize=function($c){var $d=$c.elements,$e=this.elements,$f=$e[0],$g=$e[1],$h=$e[2],$i=$e[3],$j=$f*$f+$g*$g+$h*$h+$i*$i;0<$j&&($j=1/Math.sqrt($j),$d[0]=$f*$j,$d[1]=$g*$j,$d[2]=$h*$j,$d[3]=$i*$j)},$c.length=function(){var $c=this.elements,$d=$c[0],$e=$c[1],$f=$c[2],$g=$c[3];return Math.sqrt($d*$d+$e*$e+$f*$f+$g*$g)},$c.rotateX=function($c,$d){var $e=$d.elements,$f=this.elements;$c*=.5;var $g=$f[0],$h=$f[1],$i=$f[2],$j=$f[3],$k=Math.sin($c),$l=Math.cos($c);$e[0]=$g*$l+$j*$k,$e[1]=$h*$l+$i*$k,$e[2]=$i*$l-$h*$k,$e[3]=$j*$l-$g*$k},$c.rotateY=function($c,$d){var $e=$d.elements,$f=this.elements;$c*=.5;var $g=$f[0],$h=$f[1],$i=$f[2],$j=$f[3],$k=Math.sin($c),$l=Math.cos($c);$e[0]=$g*$l-$i*$k,$e[1]=$h*$l+$j*$k,$e[2]=$i*$l+$g*$k,$e[3]=$j*$l-$h*$k},$c.rotateZ=function($c,$d){var $e=$d.elements,$f=this.elements;$c*=.5;var $g=$f[0],$h=$f[1],$i=$f[2],$j=$f[3],$k=Math.sin($c),$l=Math.cos($c);$e[0]=$g*$l+$h*$k,$e[1]=$h*$l-$g*$k,$e[2]=$i*$l+$j*$k,$e[3]=$j*$l-$i*$k},$c.getYawPitchRoll=function($c){$id.transformQuat($id.ForwardRH,this,$g.TEMPVector31),$id.transformQuat($id.Up,this,$g.TEMPVector32);var $d=$g.TEMPVector32.elements;$g.angleTo($id.ZERO,$g.TEMPVector31,$g.TEMPVector33);var $e=$g.TEMPVector33.elements;$e[0]==Math.PI/2?($e[1]=$g.arcTanAngle($d[2],$d[0]),$e[2]=0):$e[0]==-Math.PI/2?($e[1]=$g.arcTanAngle(-$d[2],-$d[0]),$e[2]=0):($cd.createRotationY(-$e[1],$g.TEMPMatrix0),$cd.createRotationX(-$e[0],$g.TEMPMatrix1),$id.transformCoordinate($g.TEMPVector32,$g.TEMPMatrix0,$g.TEMPVector32),$id.transformCoordinate($g.TEMPVector32,$g.TEMPMatrix1,$g.TEMPVector32),$e[2]=$g.arcTanAngle($d[1],-$d[0])),$e[1]<=-Math.PI&&($e[1]=Math.PI),$e[2]<=-Math.PI&&($e[2]=Math.PI),$e[1]>=Math.PI&&$e[2]>=Math.PI&&($e[1]=0,$e[2]=0,$e[0]=Math.PI-$e[0]);var $f=$c.elements;$f[0]=$e[1],$f[1]=$e[0],$f[2]=$e[2]},$c.invert=function($c){var $d=$c.elements,$e=this.elements,$f=$e[0],$g=$e[1],$h=$e[2],$i=$e[3],$j=$f*$f+$g*$g+$h*$h+$i*$i,$k=$j?1/$j:0;$d[0]=-$f*$k,$d[1]=-$g*$k,$d[2]=-$h*$k,$d[3]=$i*$k},$c.identity=function(){var $c=this.elements;$c[0]=0,$c[1]=0,$c[2]=0,$c[3]=1},$c.fromArray=function($c,$d){void 0===$d&&($d=0),this.elements[0]=$c[$d+0],this.elements[1]=$c[$d+1],this.elements[2]=$c[$d+2],this.elements[3]=$c[$d+3]},$c.cloneTo=function($c){var $d,$e,$f;if(($e=this.elements)!==($f=$c.elements))for($d=0;$d<4;++$d)$f[$d]=$e[$d]},$c.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$c.equals=function($c){var $d=this.elements,$e=$c.elements;return $ac.nearEqual($d[0],$e[0])&&$ac.nearEqual($d[1],$e[1])&&$ac.nearEqual($d[2],$e[2])&&$ac.nearEqual($d[3],$e[3])},$c.lengthSquared=function(){var $c=this.elements[0],$d=this.elements[1],$e=this.elements[2],$f=this.elements[3];return $c*$c+$d*$d+$e*$e+$f*$f},$q(0,$c,"x",function(){return this.elements[0]}),$q(0,$c,"y",function(){return this.elements[1]}),$q(0,$c,"z",function(){return this.elements[2]}),$q(0,$c,"w",function(){return this.elements[3]}),$g.createFromYawPitchRoll=function($c,$d,$e,$f){var $g=.5*$e,$h=.5*$d,$i=.5*$c,$j=Math.sin($g),$k=Math.cos($g),$l=Math.sin($h),$m=Math.cos($h),$n=Math.sin($i),$o=Math.cos($i),$p=$f.elements;$p[0]=$o*$l*$k+$n*$m*$j,$p[1]=$n*$m*$k-$o*$l*$j,$p[2]=$o*$m*$j-$n*$l*$k,$p[3]=$o*$m*$k+$n*$l*$j},$g.multiply=function($c,$d,$e){var $f=$c.elements,$g=$d.elements,$h=$e.elements,$i=$f[0],$j=$f[1],$k=$f[2],$l=$f[3],$m=$g[0],$n=$g[1],$o=$g[2],$p=$g[3],$q=$j*$o-$k*$n,$r=$k*$m-$i*$o,$s=$i*$n-$j*$m,$t=$i*$m+$j*$n+$k*$o;$h[0]=$i*$p+$m*$l+$q,$h[1]=$j*$p+$n*$l+$r,$h[2]=$k*$p+$o*$l+$s,$h[3]=$l*$p-$t},$g.arcTanAngle=function($c,$d){return 0==$c?1==$d?Math.PI/2:-Math.PI/2:0<$c?Math.atan($d/$c):$c<0?0<$d?Math.atan($d/$c)+Math.PI:Math.atan($d/$c)-Math.PI:0},$g.angleTo=function($c,$d,$e){$id.subtract($d,$c,$g.TEMPVector30),$id.normalize($g.TEMPVector30,$g.TEMPVector30),$e.elements[0]=Math.asin($g.TEMPVector30.y),$e.elements[1]=$g.arcTanAngle(-$g.TEMPVector30.z,-$g.TEMPVector30.x)},$g.createFromAxisAngle=function($c,$d,$e){var $f=$e.elements,$g=$c.elements;$d*=.5;var $h=Math.sin($d);$f[0]=$h*$g[0],$f[1]=$h*$g[1],$f[2]=$h*$g[2],$f[3]=Math.cos($d)},$g.createFromMatrix3x3=function($c,$d){var $e,$f=$d.elements,$g=$c.elements,$h=$g[0]+$g[4]+$g[8];if(0<$h)$e=Math.sqrt($h+1),$f[3]=.5*$e,$e=.5/$e,$f[0]=($g[5]-$g[7])*$e,$f[1]=($g[6]-$g[2])*$e,$f[2]=($g[1]-$g[3])*$e;else{var $i=0;$g[4]>$g[0]&&($i=1),$g[8]>$g[3*$i+$i]&&($i=2);var $j=($i+1)%3,$k=($i+2)%3;$e=Math.sqrt($g[3*$i+$i]-$g[3*$j+$j]-$g[3*$k+$k]+1),$f[$i]=.5*$e,$e=.5/$e,$f[3]=($g[3*$j+$k]-$g[3*$k+$j])*$e,$f[$j]=($g[3*$j+$i]+$g[3*$i+$j])*$e,$f[$k]=($g[3*$k+$i]+$g[3*$i+$k])*$e}},$g.createFromMatrix4x4=function($c,$d){var $e,$f,$g=$c.elements,$h=$d.elements,$i=$g[0]+$g[5]+$g[10];0<$i?($e=Math.sqrt($i+1),$h[3]=.5*$e,$e=.5/$e,$h[0]=($g[6]-$g[9])*$e,$h[1]=($g[8]-$g[2])*$e,$h[2]=($g[1]-$g[4])*$e):$g[0]>=$g[5]&&$g[0]>=$g[10]?($f=.5/($e=Math.sqrt(1+$g[0]-$g[5]-$g[10])),$h[0]=.5*$e,$h[1]=($g[1]+$g[4])*$f,$h[2]=($g[2]+$g[8])*$f,$h[3]=($g[6]-$g[9])*$f):$g[5]>$g[10]?($f=.5/($e=Math.sqrt(1+$g[5]-$g[0]-$g[10])),$h[0]=($g[4]+$g[1])*$f,$h[1]=.5*$e,$h[2]=($g[9]+$g[6])*$f,$h[3]=($g[8]-$g[2])*$f):($f=.5/($e=Math.sqrt(1+$g[10]-$g[0]-$g[5])),$h[0]=($g[8]+$g[2])*$f,$h[1]=($g[9]+$g[6])*$f,$h[2]=.5*$e,$h[3]=($g[1]-$g[4])*$f)},$g.slerp=function($c,$d,$e,$f){var $g,$h,$i,$j,$k,$l=$c.elements,$m=$d.elements,$n=$f.elements,$o=$l[0],$p=$l[1],$q=$l[2],$r=$l[3],$s=$m[0],$t=$m[1],$u=$m[2],$v=$m[3];return($h=$o*$s+$p*$t+$q*$u+$r*$v)<0&&($h=-$h,$s=-$s,$t=-$t,$u=-$u,$v=-$v),$k=1e-6<1-$h?($g=Math.acos($h),$i=Math.sin($g),$j=Math.sin((1-$e)*$g)/$i,Math.sin($e*$g)/$i):($j=1-$e,$e),$n[0]=$j*$o+$k*$s,$n[1]=$j*$p+$k*$t,$n[2]=$j*$q+$k*$u,$n[3]=$j*$r+$k*$v,$n},$g.lerp=function($c,$d,$e,$f){var $g=$f.elements,$h=$c.elements,$i=$d.elements,$j=$h[0],$k=$h[1],$l=$h[2],$m=$h[3];$g[0]=$j+$e*($i[0]-$j),$g[1]=$k+$e*($i[1]-$k),$g[2]=$l+$e*($i[2]-$l),$g[3]=$m+$e*($i[3]-$m)},$g.add=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements;$f[0]=$g[0]+$h[0],$f[1]=$g[1]+$h[1],$f[2]=$g[2]+$h[2],$f[3]=$g[3]+$h[3]},$g.dot=function($c,$d){var $e=$c.elements,$f=$d.elements;return $e[0]*$f[0]+$e[1]*$f[1]+$e[2]*$f[2]+$e[3]*$f[3]},$g.rotationLookAt=function($c,$d,$e){$g.lookAt($id.ZERO,$c,$d,$e)},$g.lookAt=function($c,$d,$e,$f){$bc.lookAt($c,$d,$e,$g._tempMatrix3x3),$g.rotationMatrix($g._tempMatrix3x3,$f)},$g.invert=function($c,$d){var $e=$c.elements,$f=$d.elements,$g=$c.lengthSquared();$ac.isZero($g)||($g=1/$g,$f[0]=-$e[0]*$g,$f[1]=-$e[1]*$g,$f[2]=-$e[2]*$g,$f[3]=$e[3]*$g)},$g.rotationMatrix=function($c,$d){var $e=$c.elements,$f=$e[0],$g=$e[1],$h=$e[2],$i=$e[3],$j=$e[4],$k=$e[5],$l=$e[6],$m=$e[7],$n=$e[8],$o=$d.elements,$p=NaN,$q=NaN,$r=$f+$j+$n;0<$r?($p=Math.sqrt($r+1),$o[3]=.5*$p,$p=.5/$p,$o[0]=($k-$m)*$p,$o[1]=($l-$h)*$p,$o[2]=($g-$i)*$p):$j<=$f&&$n<=$f?($q=.5/($p=Math.sqrt(1+$f-$j-$n)),$o[0]=.5*$p,$o[1]=($g+$i)*$q,$o[2]=($h+$l)*$q,$o[3]=($k-$m)*$q):$n<$j?($q=.5/($p=Math.sqrt(1+$j-$f-$n)),$o[0]=($i+$g)*$q,$o[1]=.5*$p,$o[2]=($m+$k)*$q,$o[3]=($l-$h)*$q):($q=.5/($p=Math.sqrt(1+$n-$f-$j)),$o[0]=($l+$h)*$q,$o[1]=($m+$k)*$q,$o[2]=.5*$p,$o[3]=($g-$i)*$q)},$g.DEFAULT=new $g,$n($g,["TEMPVector30",function(){return this.TEMPVector30=new $id},"TEMPVector31",function(){return this.TEMPVector31=new $id},"TEMPVector32",function(){return this.TEMPVector32=new $id},"TEMPVector33",function(){return this.TEMPVector33=new $id},"TEMPMatrix0",function(){return this.TEMPMatrix0=new $cd},"TEMPMatrix1",function(){return this.TEMPMatrix1=new $cd},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new $bc},"NAN",function(){return this.NAN=new $g(NaN,NaN,NaN,NaN)}]),$g}(),$fd=function(){function $c($c){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=$c,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}$p($c,"laya.d3.math.Rand");var $d=$c.prototype;return $d.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},$d.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},$d.getSignedFloat=function(){return 2*this.getFloat()-1},$q(0,$d,"seed",function(){return this.seeds[0]},function($c){this.seeds[0]=$c,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),$c.getFloatFromInt=function($c){return 1/8388607*(8388607&$c)},$c.getByteFromInt=function($c){return(8388607&$c)>>>15},$c}(),$gd=(function(){function $g($c){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!($c instanceof Array)||4!==$c.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|$c[0],this._state0L=0|$c[1],this._state1U=0|$c[2],this._state1L=0|$c[3]}$p($g,"laya.d3.math.RandX");var $c=$g.prototype;$c.randomint=function(){var $c=this._state0U,$d=this._state0L,$e=this._state1U,$f=this._state1L,$g=($f>>>0)+($d>>>0),$h=$e+$c+($g/2>>>31)>>>0,$i=$g>>>0,$j=0,$k=0;$j=($c^=$j=$c<<23|(-512&$d)>>>9)^(this._state0U=$e),$k=($d^=$k=$d<<23)^(this._state0L=$f);$j^=$c>>>18,$k^=$d>>>18|(262143&$c)<<14;return $j^=$e>>>5,$k^=$f>>>5|(31&$e)<<27,this._state1U=$j,this._state1L=$k,[$h,$i]},$c.random=function(){var $c=this.randomint(),$d=$c[0],$e=1023<<20|$d>>>12,$f=0|($c[1]>>>12|(4095&$d)<<20);return $g._CONVERTION_BUFFER.setUint32(0,$e,!1),$g._CONVERTION_BUFFER.setUint32(4,$f,!1),$fd._CONVERTION_BUFFER.getFloat64(0,!1)-1},$n($g,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new $fd([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function $c($c,$d){this.origin=null,this.direction=null,this.origin=$c,this.direction=$d}return $p($c,"laya.d3.math.Ray"),$c}()),$hd=function(){function $c($c,$d){this.elements=new Float32Array(2),void 0===$c&&($c=0),void 0===$d&&($d=0);var $e=this.elements;$e[0]=$c,$e[1]=$d}$p($c,"laya.d3.math.Vector2");var $d=$c.prototype;return $x.imps($d,{"laya.d3.core.IClone":!0}),$d.fromArray=function($c,$d){void 0===$d&&($d=0),this.elements[0]=$c[$d+0],this.elements[1]=$c[$d+1]},$d.cloneTo=function($c){var $d=$c.elements,$e=this.elements;$d[0]=$e[0],$d[1]=$e[1]},$d.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$d,"x",function(){return this.elements[0]},function($c){this.elements[0]=$c}),$q(0,$d,"y",function(){return this.elements[1]},function($c){this.elements[1]=$c}),$c.scale=function($c,$d,$e){var $f=$e.elements,$g=$c.elements;$f[0]=$g[0]*$d,$f[1]=$g[1]*$d},$n($c,["ZERO",function(){return this.ZERO=new $c(0,0)},"ONE",function(){return this.ONE=new $c(1,1)}]),$c}(),$id=function(){function $m($c,$d,$e){this.elements=new Float32Array(3),void 0===$c&&($c=0),void 0===$d&&($d=0),void 0===$e&&($e=0);var $f=this.elements;$f[0]=$c,$f[1]=$d,$f[2]=$e}$p($m,"laya.d3.math.Vector3");var $c=$m.prototype;return $x.imps($c,{"laya.d3.core.IClone":!0}),$c.fromArray=function($c,$d){void 0===$d&&($d=0),this.elements[0]=$c[$d+0],this.elements[1]=$c[$d+1],this.elements[2]=$c[$d+2]},$c.cloneTo=function($c){var $d=$c.elements,$e=this.elements;$d[0]=$e[0],$d[1]=$e[1],$d[2]=$e[2]},$c.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$c.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},$c.reset=function($c,$d,$e){this.elements[0]=$c,this.elements[1]=$d,this.elements[2]=$e},$q(0,$c,"x",function(){return this.elements[0]},function($c){this.elements[0]=$c}),$q(0,$c,"y",function(){return this.elements[1]},function($c){this.elements[1]=$c}),$q(0,$c,"z",function(){return this.elements[2]},function($c){this.elements[2]=$c}),$m.distanceSquared=function($c,$d){var $e=$c.elements,$f=$d.elements,$g=$e[0]-$f[0],$h=$e[1]-$f[1],$i=$e[2]-$f[2];return $g*$g+$h*$h+$i*$i},$m.distance=function($c,$d){var $e=$c.elements,$f=$d.elements,$g=$e[0]-$f[0],$h=$e[1]-$f[1],$i=$e[2]-$f[2];return Math.sqrt($g*$g+$h*$h+$i*$i)},$m.min=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements;$f[0]=Math.min($g[0],$h[0]),$f[1]=Math.min($g[1],$h[1]),$f[2]=Math.min($g[2],$h[2])},$m.max=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements;$f[0]=Math.max($g[0],$h[0]),$f[1]=Math.max($g[1],$h[1]),$f[2]=Math.max($g[2],$h[2])},$m.transformQuat=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements,$i=$g[0],$j=$g[1],$k=$g[2],$l=$h[0],$m=$h[1],$n=$h[2],$o=$h[3],$p=$o*$i+$m*$k-$n*$j,$q=$o*$j+$n*$i-$l*$k,$r=$o*$k+$l*$j-$m*$i,$s=-$l*$i-$m*$j-$n*$k;$f[0]=$p*$o+$s*-$l+$q*-$n-$r*-$m,$f[1]=$q*$o+$s*-$m+$r*-$l-$p*-$n,$f[2]=$r*$o+$s*-$n+$p*-$m-$q*-$l},$m.scalarLength=function($c){var $d=$c.elements,$e=$d[0],$f=$d[1],$g=$d[2];return Math.sqrt($e*$e+$f*$f+$g*$g)},$m.scalarLengthSquared=function($c){var $d=$c.elements,$e=$d[0],$f=$d[1],$g=$d[2];return $e*$e+$f*$f+$g*$g},$m.normalize=function($c,$d){var $e=$c.elements,$f=$d.elements,$g=$e[0],$h=$e[1],$i=$e[2],$j=$g*$g+$h*$h+$i*$i;0<$j&&($j=1/Math.sqrt($j),$f[0]=$e[0]*$j,$f[1]=$e[1]*$j,$f[2]=$e[2]*$j)},$m.multiply=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements;$f[0]=$g[0]*$h[0],$f[1]=$g[1]*$h[1],$f[2]=$g[2]*$h[2]},$m.scale=function($c,$d,$e){var $f=$e.elements,$g=$c.elements;$f[0]=$g[0]*$d,$f[1]=$g[1]*$d,$f[2]=$g[2]*$d},$m.lerp=function($c,$d,$e,$f){var $g=$f.elements,$h=$c.elements,$i=$d.elements,$j=$h[0],$k=$h[1],$l=$h[2];$g[0]=$j+$e*($i[0]-$j),$g[1]=$k+$e*($i[1]-$k),$g[2]=$l+$e*($i[2]-$l)},$m.transformV3ToV3=function($c,$d,$e){var $f=$m._tempVector4;$m.transformV3ToV4($c,$d,$f);var $g=$f.elements,$h=$e.elements;$h[0]=$g[0],$h[1]=$g[1],$h[2]=$g[2]},$m.transformV3ToV4=function($c,$d,$e){var $f=$c.elements,$g=$f[0],$h=$f[1],$i=$f[2],$j=$d.elements,$k=$e.elements;$k[0]=$g*$j[0]+$h*$j[4]+$i*$j[8]+$j[12],$k[1]=$g*$j[1]+$h*$j[5]+$i*$j[9]+$j[13],$k[2]=$g*$j[2]+$h*$j[6]+$i*$j[10]+$j[14],$k[3]=$g*$j[3]+$h*$j[7]+$i*$j[11]+$j[15]},$m.TransformNormal=function($c,$d,$e){var $f=$c.elements,$g=$f[0],$h=$f[1],$i=$f[2],$j=$d.elements,$k=$e.elements;$k[0]=$g*$j[0]+$h*$j[4]+$i*$j[8],$k[1]=$g*$j[1]+$h*$j[5]+$i*$j[9],$k[2]=$g*$j[2]+$h*$j[6]+$i*$j[10]},$m.transformCoordinate=function($c,$d,$e){var $f=$m._tempVector4.elements,$g=$c.elements,$h=$g[0],$i=$g[1],$j=$g[2],$k=$d.elements;$f[0]=$h*$k[0]+$i*$k[4]+$j*$k[8]+$k[12],$f[1]=$h*$k[1]+$i*$k[5]+$j*$k[9]+$k[13],$f[2]=$h*$k[2]+$i*$k[6]+$j*$k[10]+$k[14],$f[3]=1/($h*$k[3]+$i*$k[7]+$j*$k[11]+$k[15]);var $l=$e.elements;$l[0]=$f[0]*$f[3],$l[1]=$f[1]*$f[3],$l[2]=$f[2]*$f[3]},$m.Clamp=function($c,$d,$e,$f){var $g=$c.elements,$h=$g[0],$i=$g[1],$j=$g[2],$k=$d.elements,$l=$k[0],$m=$k[1],$n=$k[2],$o=$e.elements,$p=$o[0],$q=$o[1],$r=$o[2],$s=$f.elements;$h=($h=$p<$h?$p:$h)<$l?$l:$h,$i=($i=$q<$i?$q:$i)<$m?$m:$i,$j=($j=$r<$j?$r:$j)<$n?$n:$j,$s[0]=$h,$s[1]=$i,$s[2]=$j},$m.add=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements;$f[0]=$g[0]+$h[0],$f[1]=$g[1]+$h[1],$f[2]=$g[2]+$h[2]},$m.subtract=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements;$f[0]=$g[0]-$h[0],$f[1]=$g[1]-$h[1],$f[2]=$g[2]-$h[2]},$m.cross=function($c,$d,$e){var $f=$c.elements,$g=$d.elements,$h=$e.elements,$i=$f[0],$j=$f[1],$k=$f[2],$l=$g[0],$m=$g[1],$n=$g[2];$h[0]=$j*$n-$k*$m,$h[1]=$k*$l-$i*$n,$h[2]=$i*$m-$j*$l},$m.dot=function($c,$d){var $e=$c.elements,$f=$d.elements;return $e[0]*$f[0]+$e[1]*$f[1]+$e[2]*$f[2]},$m.equals=function($c,$d){var $e=$c.elements,$f=$d.elements;return $ac.nearEqual(Math.abs($e[0]),Math.abs($f[0]))&&$ac.nearEqual(Math.abs($e[1]),Math.abs($f[1]))&&$ac.nearEqual(Math.abs($e[2]),Math.abs($f[2]))},$m.ZERO=new $m(0,0,0),$m.ONE=new $m(1,1,1),$m.NegativeUnitX=new $m(-1,0,0),$m.UnitX=new $m(1,0,0),$m.UnitY=new $m(0,1,0),$m.UnitZ=new $m(0,0,1),$m.ForwardRH=new $m(0,0,-1),$m.ForwardLH=new $m(0,0,1),$m.Up=new $m(0,1,0),$m.NAN=new $m(NaN,NaN,NaN),$n($m,["_tempVector4",function(){return this._tempVector4=new $jd}]),$m}(),$jd=function(){function $c($c,$d,$e,$f){this.elements=new Float32Array(4),void 0===$c&&($c=0),void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=0);var $g=this.elements;$g[0]=$c,$g[1]=$d,$g[2]=$e,$g[3]=$f}$p($c,"laya.d3.math.Vector4");var $d=$c.prototype;return $x.imps($d,{"laya.d3.core.IClone":!0}),$d.fromArray=function($c,$d){void 0===$d&&($d=0),this.elements[0]=$c[$d+0],this.elements[1]=$c[$d+1],this.elements[2]=$c[$d+2],this.elements[3]=$c[$d+3]},$d.cloneTo=function($c){var $d=$c.elements,$e=this.elements;$d[0]=$e[0],$d[1]=$e[1],$d[2]=$e[2],$d[3]=$e[3]},$d.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$d.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},$d.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},$q(0,$d,"x",function(){return this.elements[0]},function($c){this.elements[0]=$c}),$q(0,$d,"y",function(){return this.elements[1]},function($c){this.elements[1]=$c}),$q(0,$d,"z",function(){return this.elements[2]},function($c){this.elements[2]=$c}),$q(0,$d,"w",function(){return this.elements[3]},function($c){this.elements[3]=$c}),$c.lerp=function($c,$d,$e,$f){var $g=$f.elements,$h=$c.elements,$i=$d.elements,$j=$h[0],$k=$h[1],$l=$h[2],$m=$h[3];$g[0]=$j+$e*($i[0]-$j),$g[1]=$k+$e*($i[1]-$k),$g[2]=$l+$e*($i[2]-$l),$g[3]=$m+$e*($i[3]-$m)},$c.transformByM4x4=function($c,$d,$e){var $f=$c.elements,$g=$f[0],$h=$f[1],$i=$f[2],$j=$f[3],$k=$d.elements,$l=$e.elements;$l[0]=$g*$k[0]+$h*$k[4]+$i*$k[8]+$j*$k[12],$l[1]=$g*$k[1]+$h*$k[5]+$i*$k[9]+$j*$k[13],$l[2]=$g*$k[2]+$h*$k[6]+$i*$k[10]+$j*$k[14],$l[3]=$g*$k[3]+$h*$k[7]+$i*$k[11]+$j*$k[15]},$c.equals=function($c,$d){var $e=$c.elements,$f=$d.elements;return $ac.nearEqual(Math.abs($e[0]),Math.abs($f[0]))&&$ac.nearEqual(Math.abs($e[1]),Math.abs($f[1]))&&$ac.nearEqual(Math.abs($e[2]),Math.abs($f[2]))&&$ac.nearEqual(Math.abs($e[3]),Math.abs($f[3]))},$c.normalize=function($c,$d){var $e=$c.elements,$f=$d.elements,$g=$c.length();0<$g&&($f[0]=$e[0]*$g,$f[1]=$e[1]*$g,$f[2]=$e[2]*$g,$f[3]=$e[3]*$g)},$c.add=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements;$f[0]=$g[0]+$h[0],$f[1]=$g[1]+$h[1],$f[2]=$g[2]+$h[2],$f[3]=$g[3]+$h[3]},$c.subtract=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements;$f[0]=$g[0]-$h[0],$f[1]=$g[1]-$h[1],$f[2]=$g[2]-$h[2],$f[3]=$g[3]-$h[3]},$c.multiply=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements;$f[0]=$g[0]*$h[0],$f[1]=$g[1]*$h[1],$f[2]=$g[2]*$h[2],$f[3]=$g[3]*$h[3]},$c.scale=function($c,$d,$e){var $f=$e.elements,$g=$c.elements;$f[0]=$g[0]*$d,$f[1]=$g[1]*$d,$f[2]=$g[2]*$d,$f[3]=$g[3]*$d},$c.Clamp=function($c,$d,$e,$f){var $g=$c.elements,$h=$g[0],$i=$g[1],$j=$g[2],$k=$g[3],$l=$d.elements,$m=$l[0],$n=$l[1],$o=$l[2],$p=$l[3],$q=$e.elements,$r=$q[0],$s=$q[1],$t=$q[2],$u=$q[3],$v=$f.elements;$h=($h=$r<$h?$r:$h)<$m?$m:$h,$i=($i=$s<$i?$s:$i)<$n?$n:$i,$j=($j=$t<$j?$t:$j)<$o?$o:$j,$k=($k=$u<$k?$u:$k)<$p?$p:$k,$v[0]=$h,$v[1]=$i,$v[2]=$j,$v[3]=$k},$c.distanceSquared=function($c,$d){var $e=$c.elements,$f=$d.elements,$g=$e[0]-$f[0],$h=$e[1]-$f[1],$i=$e[2]-$f[2],$j=$e[3]-$f[3];return $g*$g+$h*$h+$i*$i+$j*$j},$c.distance=function($c,$d){var $e=$c.elements,$f=$d.elements,$g=$e[0]-$f[0],$h=$e[1]-$f[1],$i=$e[2]-$f[2],$j=$e[3]-$f[3];return Math.sqrt($g*$g+$h*$h+$i*$i+$j*$j)},$c.dot=function($c,$d){var $e=$c.elements,$f=$d.elements;return $e[0]*$f[0]+$e[1]*$f[1]+$e[2]*$f[2]+$e[3]*$f[3]},$c.min=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements;$f[0]=Math.min($g[0],$h[0]),$f[1]=Math.min($g[1],$h[1]),$f[2]=Math.min($g[2],$h[2]),$f[3]=Math.min($g[3],$h[3])},$c.max=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d.elements;$f[0]=Math.max($g[0],$h[0]),$f[1]=Math.max($g[1],$h[1]),$f[2]=Math.max($g[2],$h[2]),$f[3]=Math.max($g[3],$h[3])},$n($c,["ZERO",function(){return this.ZERO=new $c},"ONE",function(){return this.ONE=new $c(1,1,1,1)},"UnitX",function(){return this.UnitX=new $c(1,0,0,0)},"UnitY",function(){return this.UnitY=new $c(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new $c(0,0,1,0)},"UnitW",function(){return this.UnitW=new $c(0,0,0,1)}]),$c}(),$kd=function(){function $h($c,$d,$e,$f){this.minDepth=0,this.maxDepth=1,this.x=$c,this.y=$d,this.width=$e,this.height=$f}$p($h,"laya.d3.math.Viewport");var $c=$h.prototype;return $c.project=function($c,$d,$e){$id.transformV3ToV3($c,$d,$e);var $f=$c.elements,$g=$d.elements,$h=$e.elements,$i=$f[0]*$g[3]+$f[1]*$g[7]+$f[2]*$g[11]+$g[15];1!==$i&&($h[0]=$h[0]/$i,$h[1]=$h[1]/$i,$h[2]=$h[2]/$i),$h[0]=.5*($h[0]+1)*this.width+this.x,$h[1]=.5*(1-$h[1])*this.height+this.y,$h[2]=$h[2]*(this.maxDepth-this.minDepth)+this.minDepth},$c.unprojectFromMat=function($c,$d,$e){var $f=$c.elements,$g=$d.elements,$h=$e.elements;$h[0]=($f[0]-this.x)/this.width*2-1,$h[1]=-(($f[1]-this.y)/this.height*2-1);var $i=(this.maxDepth-this.minDepth)/2;$h[2]=($f[2]-this.minDepth-$i)/$i;var $j=$h[0]*$g[3]+$h[1]*$g[7]+$h[2]*$g[11]+$g[15];$id.transformV3ToV3($e,$d,$e),1!==$j&&($h[0]=$h[0]/$j,$h[1]=$h[1]/$j,$h[2]=$h[2]/$j)},$c.unprojectFromWVP=function($c,$d,$e,$f,$g){$cd.multiply($d,$e,$h._tempMatrix4x4),$f&&$cd.multiply($h._tempMatrix4x4,$f,$h._tempMatrix4x4),$h._tempMatrix4x4.invert($h._tempMatrix4x4),this.unprojectFromMat($c,$h._tempMatrix4x4,$g)},$n($h,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $cd}]),$h}(),$ld=function(){function $E($c){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=$c,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}$p($E,"laya.d3.resource.models.SubMesh");var $c=$E.prototype;return $x.imps($c,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$c._getVertexBuffer=function($c){return void 0===$c&&($c=0),0===$c?this._vertexBuffer:null},$c._getIndexBuffer=function(){return this._indexBuffer},$c._getStaticBatchBakedVertexs=function($c,$d){var $e,$f,$g=this._vertexBuffer,$h=$g.vertexDeclaration,$i=$h.getVertexElementByUsage(0).offset/4,$j=$h.getVertexElementByUsage(3).offset/4,$k=$d.meshRender.lightmapScaleOffset,$l=0,$m=0,$n=0,$o=0,$p=0,$q=0;if($k)if($f=$h.getVertexElementByUsage(15))$n=$h.vertexStride/4,$e=0<this._vertexCount?$g.getData().slice(this._vertexStart*$n,(this._vertexStart+this._vertexCount)*$n):$g.getData().slice(),$o=$f.offset/4;else{$n=($q=$h.vertexStride/4)+2,$e=this._vertexCount?new Float32Array(this._vertexCount*($g.vertexDeclaration.vertexStride/4+2)):new Float32Array($g.vertexCount*($g.vertexDeclaration.vertexStride/4+2)),$o=($p=$h.getVertexElementByUsage(2).offset/4)+2;var $r=$g.getData();for($l=0,$m=$r.length/$q;$l<$m;$l++){var $s=0;$s=0<this._vertexCount?(this._vertexStart+$l)*$q:$l*$q;var $t=$l*$n,$u=0;for($u=0;$u<$o;$u++)$e[$t+$u]=$r[$s+$u];for($u=$o;$u<$q;$u++)$e[$t+$u+2]=$r[$s+$u]}}else $n=$h.vertexStride/4,$e=this._vertexCount?$g.getData().slice(this._vertexStart*$n,(this._vertexStart+this._vertexCount)*$n):$g.getData().slice();if($c){var $v=$c.worldMatrix,$w=$E._tempMatrix4x40;$v.invert($w);var $x=$E._tempMatrix4x41,$y=$d.transform.worldMatrix;$cd.multiply($w,$y,$x)}else $x=$d.transform.worldMatrix;var $z=$E._tempQuaternion0;for($x.decomposeTransRotScale($E._tempVector30,$z,$E._tempVector31),$l=0,$m=$e.length/$n;$l<$m;$l++){var $A=$l*$n+$i,$B=$l*$n+$j;if($sd.transformVector3ArrayToVector3ArrayCoordinate($e,$A,$x,$e,$A),$sd.transformVector3ArrayByQuat($e,$B,$z,$e,$B),$k){var $C=$l*$n+$o;if($f)$sd.transformLightingMapTexcoordByUV1Array($e,$C,$k,$e,$C);else{var $D=$l*$q+$p;$sd.transformLightingMapTexcoordByUV0Array($r,$D,$k,$e,$C)}}}return $e},$c._getVertexBuffers=function(){return null},$c._beforeRender=function($c){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$c._render=function($c){var $d,$e=0,$f=$c.renderElement;if(1<this._indexCount){var $g=this._boneIndicesList.length;if(1<$g){for(var $h=0;$h<$g;$h++)($d=$f._skinAnimationDatas||this._skinAnimationDatas)&&($f._shaderValue.setValue(0,$d[$h]),$c._shader.uploadRenderElementUniforms($f._shaderValue.data)),$F.mainContext.drawElements(4,this._subIndexBufferCount[$h],5123,2*this._subIndexBufferStart[$h]);$A.drawCall+=$g}else($d=$f._skinAnimationDatas||this._skinAnimationDatas)&&($f._shaderValue.setValue(0,$d[0]),$c._shader.uploadRenderElementUniforms($f._shaderValue.data)),$F.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),$A.drawCall++;$e=this._indexCount}else $e=this._indexBuffer.indexCount,($d=$f._skinAnimationDatas||this._skinAnimationDatas)&&($f._shaderValue.setValue(0,$d[0]),$c._shader.uploadRenderElementUniforms($f._shaderValue.data)),$F.mainContext.drawElements(4,$e,5123,0),$A.drawCall++;$A.trianglesFaces+=$e/3},$c.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},$c.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},$q(0,$c,"_vertexBufferCount",function(){return 1}),$q(0,$c,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$n($E,["_tempVector30",function(){return this._tempVector30=new $id},"_tempVector31",function(){return this._tempVector31=new $id},"_tempQuaternion0",function(){return this._tempQuaternion0=new $ed},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new $cd},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new $cd}]),$E}(),$md=function(){function $c($c){this.defineCounter=0,this.defines=null,$c?(this.defineCounter=$c.defineCounter,this.defines=$c.defines.slice()):(this.defineCounter=0,this.defines=[])}return $p($c,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),$c.prototype.registerDefine=function($c){var $d=Math.pow(2,this.defineCounter++);return this.defines[$d]=$c,$d},$c}(),$nd=function(){function $c(){}return $p($c,"laya.d3.shader.ShaderInit3D"),$c.__init__=function(){var $c,$d;$Ad._globalRegDefine("HIGHPRECISION",$Ad.SHADERDEFINE_HIGHPRECISION),$Ad._globalRegDefine("FOG",$Ad.SHADERDEFINE_FOG),$Ad._globalRegDefine("DIRECTIONLIGHT",$Ad.SHADERDEFINE_DIRECTIONLIGHT),$Ad._globalRegDefine("POINTLIGHT",$Ad.SHADERDEFINE_POINTLIGHT),$Ad._globalRegDefine("SPOTLIGHT",$Ad.SHADERDEFINE_SPOTLIGHT),$Ad._globalRegDefine("UV",$Ad.SHADERDEFINE_UV0),$Ad._globalRegDefine("COLOR",$Ad.SHADERDEFINE_COLOR),$Ad._globalRegDefine("UV1",$Ad.SHADERDEFINE_UV1),$Ad._globalRegDefine("CASTSHADOW",$pd.SHADERDEFINE_CAST_SHADOW),$Ad._globalRegDefine("SHADOWMAP_PSSM1",$pd.SHADERDEFINE_SHADOW_PSSM1),$Ad._globalRegDefine("SHADOWMAP_PSSM2",$pd.SHADERDEFINE_SHADOW_PSSM2),$Ad._globalRegDefine("SHADOWMAP_PSSM3",$pd.SHADERDEFINE_SHADOW_PSSM3),$Ad._globalRegDefine("SHADOWMAP_PCF_NO",$pd.SHADERDEFINE_SHADOW_PCF_NO),$Ad._globalRegDefine("SHADOWMAP_PCF1",$pd.SHADERDEFINE_SHADOW_PCF1),$Ad._globalRegDefine("SHADOWMAP_PCF2",$pd.SHADERDEFINE_SHADOW_PCF2),$Ad._globalRegDefine("SHADOWMAP_PCF3",$pd.SHADERDEFINE_SHADOW_PCF3),$Ad._globalRegDefine("DEPTHFOG",$Ad.SAHDERDEFINE_DEPTHFOG),$Ld.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),$Ld.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),$c={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},$d={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var $e=$Ld.nameKey.add("SIMPLE");shaderCompile=$Ad.add($e,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',$c,$d),$Md.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),$Md.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),$Md.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),$Md.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),$Md.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),$Md.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),$Md.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),$Md.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),$Md.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},$c}(),$od=function(){function $c(){this._data=null,this._data=[]}$p($c,"laya.d3.shader.ValusArray");var $d=$c.prototype;return $d.setValue=function($c,$d){this._data[$c]=$d},$q(0,$d,"data",function(){return this._data}),$c}(),$pd=function(){function $c(){}return $c.SHADERDEFINE_RECEIVE_SHADOW=1,$c.SHADERDEFINE_CAST_SHADOW=512,$c.SHADERDEFINE_SHADOW_PSSM1=1024,$c.SHADERDEFINE_SHADOW_PSSM2=2048,$c.SHADERDEFINE_SHADOW_PSSM3=4096,$c.SHADERDEFINE_SHADOW_PCF_NO=8192,$c.SHADERDEFINE_SHADOW_PCF1=16384,$c.SHADERDEFINE_SHADOW_PCF2=32768,$c.SHADERDEFINE_SHADOW_PCF3=65536,$c.MAX_PSSM_COUNT=3,$c}(),$qd=function(){function $X(){}return $p($X,"laya.d3.utils.Picker"),$X.calculateCursorRay=function($c,$d,$e,$f,$g,$h){var $i=$c.elements[0],$j=$c.elements[1],$k=$X._tempVector30,$l=$k.elements;$l[0]=$i,$l[1]=$j,$l[2]=$d.minDepth;var $m=$X._tempVector31,$n=$m.elements;$n[0]=$i,$n[1]=$j,$n[2]=$d.maxDepth;var $o=$h.origin,$p=$X._tempVector32;$d.unprojectFromWVP($k,$e,$f,$g,$o),$d.unprojectFromWVP($m,$e,$f,$g,$p);var $q=$h.direction.elements;$q[0]=$p.x-$o.x,$q[1]=$p.y-$o.y,$q[2]=$p.z-$o.z,$id.normalize($h.direction,$h.direction)},$X.rayIntersectsPositionsAndIndices=function($c,$d,$e,$f,$g){for(var $h=$e.vertexStride/4,$i=$e.getVertexElementByUsage(0).offset/4,$j=Number.MAX_VALUE,$k=-1,$l=-1,$m=-1,$n=0;$n<$f.length;$n+=3){var $o=$X._tempVector35,$p=$o.elements,$q=$f[$n]*$h,$r=$q+$i;$p[0]=$d[$r],$p[1]=$d[1+$r],$p[2]=$d[2+$r];var $s=$X._tempVector36,$t=$s.elements,$u=$f[$n+1]*$h,$v=$u+$i;$t[0]=$d[$v],$t[1]=$d[1+$v],$t[2]=$d[2+$v];var $w=$X._tempVector37,$x=$w.elements,$y=$f[$n+2]*$h,$z=$y+$i;$x[0]=$d[$z],$x[1]=$d[1+$z],$x[2]=$d[2+$z];var $A=laya.d3.utils.Picker.rayIntersectsTriangle($c,$o,$s,$w);!isNaN($A)&&$A<$j&&($j=$A,$k=$q,$l=$u,$m=$y)}if($j===Number.MAX_VALUE)return $g.position.toDefault(),$g.distance=Number.MAX_VALUE,$g.trianglePositions[0].toDefault(),$g.trianglePositions[1].toDefault(),$g.trianglePositions[2].toDefault(),$g.triangleNormals[0].toDefault(),$g.triangleNormals[1].toDefault(),$g.triangleNormals[2].toDefault(),!1;$g.distance=$j,$id.scale($c.direction,$j,$g.position),$id.add($c.origin,$g.position,$g.position);var $B=$g.trianglePositions,$C=$B[0],$D=$B[1],$E=$B[2],$F=$C.elements,$G=$D.elements,$H=$E.elements,$I=$k+$i;$F[0]=$d[$I],$F[1]=$d[$I+1],$F[2]=$d[$I+2];var $J=$l+$i;$G[0]=$d[$J],$G[1]=$d[$J+1],$G[2]=$d[$J+2];var $K=$m+$i;$H[0]=$d[$K],$H[1]=$d[$K+1],$H[2]=$d[$K+2];var $L=$e.getVertexElementByUsage(3);if($L){var $M=$L.offset/4,$N=$g.triangleNormals,$O=$N[0],$P=$N[1],$Q=$N[2],$R=$O.elements,$S=$P.elements,$T=$Q.elements,$U=$k+$M;$R[0]=$d[$U],$R[1]=$d[$U+1],$R[2]=$d[$U+2];var $V=$l+$M;$S[0]=$d[$V],$S[1]=$d[$V+1],$S[2]=$d[$V+2];var $W=$m+$M;$T[0]=$d[$W],$T[1]=$d[$W+1],$T[2]=$d[$W+2]}return!0},$X.rayIntersectsTriangle=function($c,$d,$e,$f){var $g=$X._tempVector30,$h=$X._tempVector31;$id.subtract($e,$d,$g),$id.subtract($f,$d,$h);var $i,$j=$X._tempVector32;if($id.cross($c.direction,$h,$j),($i=$id.dot($g,$j))>-Number.MIN_VALUE&&$i<Number.MIN_VALUE)return Number.NaN;var $k,$l=1/$i,$m=$X._tempVector33;if($id.subtract($c.origin,$d,$m),$k=$id.dot($m,$j),($k*=$l)<0||1<$k)return Number.NaN;var $n,$o,$p=$X._tempVector34;return $id.cross($m,$g,$p),$n=$id.dot($c.direction,$p),($n*=$l)<0||1<$k+$n?Number.NaN:($o=$id.dot($h,$p),($o*=$l)<0?Number.NaN:$o)},$n($X,["_tempVector30",function(){return this._tempVector30=new $id},"_tempVector31",function(){return this._tempVector31=new $id},"_tempVector32",function(){return this._tempVector32=new $id},"_tempVector33",function(){return this._tempVector33=new $id},"_tempVector34",function(){return this._tempVector34=new $id},"_tempVector35",function(){return this._tempVector35=new $id},"_tempVector36",function(){return this._tempVector36=new $id},"_tempVector37",function(){return this._tempVector37=new $id}]),$X}(),$rd=(function(){function $c(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new $id,new $id,new $id],this.trianglePositions.length=3,this.triangleNormals=[new $id,new $id,new $id],this.triangleNormals.length=3,this.position=new $id}$p($c,"laya.d3.utils.RaycastHit"),$c.prototype.cloneTo=function($c){$c.distance=this.distance,this.trianglePositions[0].cloneTo($c.trianglePositions[0]),this.trianglePositions[1].cloneTo($c.trianglePositions[1]),this.trianglePositions[2].cloneTo($c.trianglePositions[2]),this.triangleNormals[0].cloneTo($c.triangleNormals[0]),this.triangleNormals[1].cloneTo($c.triangleNormals[1]),this.triangleNormals[2].cloneTo($c.triangleNormals[2]),this.position.cloneTo($c.position),$c.sprite3D=this.sprite3D}}(),function(){function $c($c,$d){this._width=0,this._height=0,this._width=$c,this._height=$d}$p($c,"laya.d3.utils.Size");var $d=$c.prototype;return $q(0,$d,"width",function(){return-1===this._width?$Y.clientWidth:this._width}),$q(0,$d,"height",function(){return-1===this._height?$Y.clientHeight:this._height}),$q(1,$c,"fullScreen",function(){return new $c(-1,-1)}),$c}()),$sd=function(){function $I(){}return $p($I,"laya.d3.utils.Utils3D"),$I._rotationTransformScaleSkinAnimation=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$n){var $o,$p,$q,$r,$s,$t=$I._tempArray16_0,$u=$I._tempArray16_1,$v=$I._tempArray16_2,$w=$f+$f,$x=$g+$g,$y=$h+$h,$z=$f*$w,$A=$g*$w,$B=$g*$x,$C=$h*$w,$D=$h*$x,$E=$h*$y,$F=$i*$w,$G=$i*$x,$H=$i*$y;for($t[15]=1,$t[0]=1-$B-$E,$t[1]=$A+$H,$t[2]=$C-$G,$t[4]=$A-$H,$t[5]=1-$z-$E,$t[6]=$D+$F,$t[8]=$C+$G,$t[9]=$D-$F,$t[10]=1-$z-$B,$u[15]=1,$u[0]=$j,$u[5]=$k,$u[10]=$l,$o=0;$o<4;$o++)$p=$t[$o],$q=$t[$o+4],$r=$t[$o+8],$s=$t[$o+12],$v[$o]=$p,$v[$o+4]=$q,$v[$o+8]=$r,$v[$o+12]=$p*$c+$q*$d+$r*$e+$s;for($o=0;$o<4;$o++)$p=$v[$o],$q=$v[$o+4],$r=$v[$o+8],$s=$v[$o+12],$m[$o+$n]=$p*$u[0]+$q*$u[1]+$r*$u[2]+$s*$u[3],$m[$o+$n+4]=$p*$u[4]+$q*$u[5]+$r*$u[6]+$s*$u[7],$m[$o+$n+8]=$p*$u[8]+$q*$u[9]+$r*$u[10]+$s*$u[11],$m[$o+$n+12]=$p*$u[12]+$q*$u[13]+$r*$u[14]+$s*$u[15]},$I._createNodeByJson=function($c,$d,$e,$f){if(!$e)switch($d.type){case"Sprite3D":$e=new $Kd;break;case"MeshSprite3D":$e=new $Xd;break;case"SkinnedMeshSprite3D":$e=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":$e=new ShuriKenParticle3D;break;case"TrailSprite3D":$e=new TrailSprite3D;break;case"Terrain":$e=new Terrain;break;case"Camera":$e=new $Wd;break;case"DirectionLight":$e=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var $g=$d.props;if($g)for(var $h in $g)$e[$h]=$g[$h];var $i=$d.customProps;$i&&($e instanceof laya.d3.core.Sprite3D?($e._parseBaseCustomProps($i),$e._parseCustomProps($c,$f,$i,$d),$e._parseCustomComponent($c,$f,$d.components)):$e._parseCustomProps($c,$f,$i,$d));var $j=$d.child;if($j)for(var $k=0,$l=$j.length;$k<$l;$k++){var $m=$I._createNodeByJson($c,$j[$k],null,$f);$e.addChild($m)}return $e},$I._computeBoneAndAnimationDatasByBindPoseMatrxix=function($c,$d,$e,$f,$g,$h){var $i,$j,$k=0,$l=0,$m=$c.length;for($i=0;$i<$m;$k+=$c[$i].keyframeWidth,$l+=16,$i++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($d[$k+0],$d[$k+1],$d[$k+2],$d[$k+3],$d[$k+4],$d[$k+5],$d[$k+6],$d[$k+7],$d[$k+8],$d[$k+9],$f,$l),0!=$i&&($j=16*$c[$i].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($f,$j,$f,$l,$f,$l));var $n=$e.length;for($i=0;$i<$n;$i++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($f,16*$h[$i],$e[$i],$g,16*$i)},$I._computeAnimationDatasByArrayAndMatrixFast=function($c,$d,$e,$f){for(var $g=0,$h=$c.length;$g<$h;$g++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($d,16*$f[$g],$c[$g],$e,16*$g)},$I._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function($c,$d,$e,$f,$g){var $h,$i,$j=0,$k=0,$l=$c.length;for($h=0;$h<$l;$j+=$c[$h].keyframeWidth,$k+=16,$h++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($d[$j+7],$d[$j+8],$d[$j+9],$d[$j+3],$d[$j+4],$d[$j+5],$d[$j+6],$d[$j+0],$d[$j+1],$d[$j+2],$f,$k),0!=$h&&($i=16*$c[$h].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($f,$i,$f,$k,$f,$k));var $m=$e.length;for($h=0;$h<$m;$h++){var $n=16*$h;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($f,$n,$e[$h],$g,$n)}},$I._computeAnimationDatasByArrayAndMatrixFastOld=function($c,$d,$e){for(var $f=$c.length,$g=0;$g<$f;$g++){var $h=16*$g;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($d,$h,$c[$g],$e,$h)}},$I._computeRootAnimationData=function($c,$d,$e){for(var $f=0,$g=0,$h=0,$i=$c.length;$f<$i;$g+=$c[$f].keyframeWidth,$h+=16,$f++)laya.d3.utils.Utils3D.createAffineTransformationArray($d[$g+0],$d[$g+1],$d[$g+2],$d[$g+3],$d[$g+4],$d[$g+5],$d[$g+6],$d[$g+7],$d[$g+8],$d[$g+9],$e,$h)},$I.transformVector3ArrayByQuat=function($c,$d,$e,$f,$g){var $h=$e.elements,$i=$c[$d],$j=$c[$d+1],$k=$c[$d+2],$l=$h[0],$m=$h[1],$n=$h[2],$o=$h[3],$p=$o*$i+$m*$k-$n*$j,$q=$o*$j+$n*$i-$l*$k,$r=$o*$k+$l*$j-$m*$i,$s=-$l*$i-$m*$j-$n*$k;$f[$g]=$p*$o+$s*-$l+$q*-$n-$r*-$m,$f[$g+1]=$q*$o+$s*-$m+$r*-$l-$p*-$n,$f[$g+2]=$r*$o+$s*-$n+$p*-$m-$q*-$l},$I.mulMatrixByArray=function($c,$d,$e,$f,$g,$h){var $i,$j,$k,$l,$m;if($g===$e){for($e=$I._tempArray16_3,$i=0;$i<16;++$i)$e[$i]=$g[$h+$i];$f=0}for($i=0;$i<4;$i++)$j=$c[$d+$i],$k=$c[$d+$i+4],$l=$c[$d+$i+8],$m=$c[$d+$i+12],$g[$h+$i]=$j*$e[$f+0]+$k*$e[$f+1]+$l*$e[$f+2]+$m*$e[$f+3],$g[$h+$i+4]=$j*$e[$f+4]+$k*$e[$f+5]+$l*$e[$f+6]+$m*$e[$f+7],$g[$h+$i+8]=$j*$e[$f+8]+$k*$e[$f+9]+$l*$e[$f+10]+$m*$e[$f+11],$g[$h+$i+12]=$j*$e[$f+12]+$k*$e[$f+13]+$l*$e[$f+14]+$m*$e[$f+15]},$I.mulMatrixByArrayFast=function($c,$d,$e,$f,$g,$h){var $i,$j,$k,$l,$m;for($i=0;$i<4;$i++)$j=$c[$d+$i],$k=$c[$d+$i+4],$l=$c[$d+$i+8],$m=$c[$d+$i+12],$g[$h+$i]=$j*$e[$f+0]+$k*$e[$f+1]+$l*$e[$f+2]+$m*$e[$f+3],$g[$h+$i+4]=$j*$e[$f+4]+$k*$e[$f+5]+$l*$e[$f+6]+$m*$e[$f+7],$g[$h+$i+8]=$j*$e[$f+8]+$k*$e[$f+9]+$l*$e[$f+10]+$m*$e[$f+11],$g[$h+$i+12]=$j*$e[$f+12]+$k*$e[$f+13]+$l*$e[$f+14]+$m*$e[$f+15]},$I.mulMatrixByArrayAndMatrixFast=function($c,$d,$e,$f,$g){var $h,$i,$j,$k,$l,$m=$e.elements,$n=$m[0],$o=$m[1],$p=$m[2],$q=$m[3],$r=$m[4],$s=$m[5],$t=$m[6],$u=$m[7],$v=$m[8],$w=$m[9],$x=$m[10],$y=$m[11],$z=$m[12],$A=$m[13],$B=$m[14],$C=$m[15],$D=$d,$E=$d+4,$F=$d+8,$G=$d+12,$H=$g,$I=$g+4,$J=$g+8,$K=$g+12;for($h=0;$h<4;$h++)$i=$c[$D+$h],$j=$c[$E+$h],$k=$c[$F+$h],$l=$c[$G+$h],$f[$H+$h]=$i*$n+$j*$o+$k*$p+$l*$q,$f[$I+$h]=$i*$r+$j*$s+$k*$t+$l*$u,$f[$J+$h]=$i*$v+$j*$w+$k*$x+$l*$y,$f[$K+$h]=$i*$z+$j*$A+$k*$B+$l*$C},$I.createAffineTransformationArray=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$n){var $o=$f+$f,$p=$g+$g,$q=$h+$h,$r=$f*$o,$s=$f*$p,$t=$f*$q,$u=$g*$p,$v=$g*$q,$w=$h*$q,$x=$i*$o,$y=$i*$p,$z=$i*$q;$m[$n+0]=(1-($u+$w))*$j,$m[$n+1]=($s+$z)*$j,$m[$n+2]=($t-$y)*$j,$m[$n+3]=0,$m[$n+4]=($s-$z)*$k,$m[$n+5]=(1-($r+$w))*$k,$m[$n+6]=($v+$x)*$k,$m[$n+7]=0,$m[$n+8]=($t+$y)*$l,$m[$n+9]=($v-$x)*$l,$m[$n+10]=(1-($r+$u))*$l,$m[$n+11]=0,$m[$n+12]=$c,$m[$n+13]=$d,$m[$n+14]=$e,$m[$n+15]=1},$I.transformVector3ArrayToVector3ArrayCoordinate=function($c,$d,$e,$f,$g){var $h=$I._tempArray4_0,$i=$c[$d+0],$j=$c[$d+1],$k=$c[$d+2],$l=$e.elements;$h[0]=$i*$l[0]+$j*$l[4]+$k*$l[8]+$l[12],$h[1]=$i*$l[1]+$j*$l[5]+$k*$l[9]+$l[13],$h[2]=$i*$l[2]+$j*$l[6]+$k*$l[10]+$l[14],$h[3]=1/($i*$l[3]+$j*$l[7]+$k*$l[11]+$l[15]),$f[$g+0]=$h[0]*$h[3],$f[$g+1]=$h[1]*$h[3],$f[$g+2]=$h[2]*$h[3]},$I.transformLightingMapTexcoordByUV0Array=function($c,$d,$e,$f,$g){var $h=$e.elements;$f[$g+0]=$c[$d+0]*$h[0]+$h[2],$f[$g+1]=($c[$d+1]-1)*$h[1]+$h[3]},$I.transformLightingMapTexcoordByUV1Array=function($c,$d,$e,$f,$g){var $h=$e.elements;$f[$g+0]=$c[$d+0]*$h[0]+$h[2],$f[$g+1]=1+$c[$d+1]*$h[1]+$h[3]},$I.getURLVerion=function($c){var $d=$c.indexOf("?");return 0<=$d?$c.substr($d):null},$I._quaternionCreateFromYawPitchRollArray=function($c,$d,$e,$f){var $g=.5*$e,$h=.5*$d,$i=.5*$c,$j=Math.sin($g),$k=Math.cos($g),$l=Math.sin($h),$m=Math.cos($h),$n=Math.sin($i),$o=Math.cos($i);$f[0]=$o*$l*$k+$n*$m*$j,$f[1]=$n*$m*$k-$o*$l*$j,$f[2]=$o*$m*$j-$n*$l*$k,$f[3]=$o*$m*$k+$n*$l*$j},$I._createAffineTransformationArray=function($c,$d,$e,$f){var $g=$d[0],$h=$d[1],$i=$d[2],$j=$d[3],$k=$g+$g,$l=$h+$h,$m=$i+$i,$n=$g*$k,$o=$g*$l,$p=$g*$m,$q=$h*$l,$r=$h*$m,$s=$i*$m,$t=$j*$k,$u=$j*$l,$v=$j*$m,$w=$e[0],$x=$e[1],$y=$e[2];$f[0]=(1-($q+$s))*$w,$f[1]=($o+$v)*$w,$f[2]=($p-$u)*$w,$f[3]=0,$f[4]=($o-$v)*$x,$f[5]=(1-($n+$s))*$x,$f[6]=($r+$t)*$x,$f[7]=0,$f[8]=($p+$u)*$y,$f[9]=($r-$t)*$y,$f[10]=(1-($n+$q))*$y,$f[11]=0,$f[12]=$c[0],$f[13]=$c[1],$f[14]=$c[2],$f[15]=1},$I._mulMatrixArray=function($c,$d,$e,$f){var $g,$h,$i,$j,$k,$l=$d.elements,$m=$l[0],$n=$l[1],$o=$l[2],$p=$l[3],$q=$l[4],$r=$l[5],$s=$l[6],$t=$l[7],$u=$l[8],$v=$l[9],$w=$l[10],$x=$l[11],$y=$l[12],$z=$l[13],$A=$l[14],$B=$l[15],$C=$f,$D=$f+4,$E=$f+8,$F=$f+12;for($g=0;$g<4;$g++)$h=$c[$g],$i=$c[$g+4],$j=$c[$g+8],$k=$c[$g+12],$e[$C+$g]=$h*$m+$i*$n+$j*$o+$k*$p,$e[$D+$g]=$h*$q+$i*$r+$j*$s+$k*$t,$e[$E+$g]=$h*$u+$i*$v+$j*$w+$k*$x,$e[$F+$g]=$h*$y+$i*$z+$j*$A+$k*$B},$I.getYawPitchRoll=function($c,$d){$I.transformQuat($id.ForwardRH,$c,$ed.TEMPVector31),$I.transformQuat($id.Up,$c,$ed.TEMPVector32);var $e=$ed.TEMPVector32.elements;$I.angleTo($id.ZERO,$ed.TEMPVector31,$ed.TEMPVector33);var $f=$ed.TEMPVector33.elements;$f[0]==Math.PI/2?($f[1]=$I.arcTanAngle($e[2],$e[0]),$f[2]=0):$f[0]==-Math.PI/2?($f[1]=$I.arcTanAngle(-$e[2],-$e[0]),$f[2]=0):($cd.createRotationY(-$f[1],$ed.TEMPMatrix0),$cd.createRotationX(-$f[0],$ed.TEMPMatrix1),$id.transformCoordinate($ed.TEMPVector32,$ed.TEMPMatrix0,$ed.TEMPVector32),$id.transformCoordinate($ed.TEMPVector32,$ed.TEMPMatrix1,$ed.TEMPVector32),$f[2]=$I.arcTanAngle($e[1],-$e[0])),$f[1]<=-Math.PI&&($f[1]=Math.PI),$f[2]<=-Math.PI&&($f[2]=Math.PI),$f[1]>=Math.PI&&$f[2]>=Math.PI&&($f[1]=0,$f[2]=0,$f[0]=Math.PI-$f[0]),$d[0]=$f[1],$d[1]=$f[0],$d[2]=$f[2]},$I.arcTanAngle=function($c,$d){return 0==$c?1==$d?Math.PI/2:-Math.PI/2:0<$c?Math.atan($d/$c):$c<0?0<$d?Math.atan($d/$c)+Math.PI:Math.atan($d/$c)-Math.PI:0},$I.angleTo=function($c,$d,$e){$id.subtract($d,$c,$ed.TEMPVector30),$id.normalize($ed.TEMPVector30,$ed.TEMPVector30),$e.elements[0]=Math.asin($ed.TEMPVector30.y),$e.elements[1]=$I.arcTanAngle(-$ed.TEMPVector30.z,-$ed.TEMPVector30.x)},$I.transformQuat=function($c,$d,$e){var $f=$e.elements,$g=$c.elements,$h=$d,$i=$g[0],$j=$g[1],$k=$g[2],$l=$h[0],$m=$h[1],$n=$h[2],$o=$h[3],$p=$o*$i+$m*$k-$n*$j,$q=$o*$j+$n*$i-$l*$k,$r=$o*$k+$l*$j-$m*$i,$s=-$l*$i-$m*$j-$n*$k;$f[0]=$p*$o+$s*-$l+$q*-$n-$r*-$m,$f[1]=$q*$o+$s*-$m+$r*-$l-$p*-$n,$f[2]=$r*$o+$s*-$n+$p*-$m-$q*-$l},$I.quaterionNormalize=function($c,$d){var $e=$c[0],$f=$c[1],$g=$c[2],$h=$c[3],$i=$e*$e+$f*$f+$g*$g+$h*$h;0<$i&&($i=1/Math.sqrt($i),$d[0]=$e*$i,$d[1]=$f*$i,$d[2]=$g*$i,$d[3]=$h*$i)},$I.matrix4x4MultiplyFFF=function($c,$d,$e){var $f,$g,$h,$i,$j;if($e===$d)for($d=new Float32Array(16),$f=0;$f<16;++$f)$d[$f]=$e[$f];for($f=0;$f<4;$f++)$g=$c[$f],$h=$c[$f+4],$i=$c[$f+8],$j=$c[$f+12],$e[$f]=$g*$d[0]+$h*$d[1]+$i*$d[2]+$j*$d[3],$e[$f+4]=$g*$d[4]+$h*$d[5]+$i*$d[6]+$j*$d[7],$e[$f+8]=$g*$d[8]+$h*$d[9]+$i*$d[10]+$j*$d[11],$e[$f+12]=$g*$d[12]+$h*$d[13]+$i*$d[14]+$j*$d[15]},$I.matrix4x4MultiplyMFM=function($c,$d,$e){$I.matrix4x4MultiplyFFF($c.elements,$d,$e.elements)},$n($I,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new $id},"_tempVector3_1",function(){return this._tempVector3_1=new $id},"_tempVector3_2",function(){return this._tempVector3_2=new $id},"_tempVector3_3",function(){return this._tempVector3_3=new $id},"_tempVector3_4",function(){return this._tempVector3_4=new $id},"_tempVector3_5",function(){return this._tempVector3_5=new $id},"_tempVector3_6",function(){return this._tempVector3_6=new $id},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),$I}(),$td=function(){function $G(){}return $p($G,"Laya3D"),$G._cancelLoadByUrl=function($c){$x.loader.cancelLoadByUrl($c),$G._innerFirstLevelLoaderManager.cancelLoadByUrl($c),$G._innerSecondLevelLoaderManager.cancelLoadByUrl($c),$G._innerThirdLevelLoaderManager.cancelLoadByUrl($c),$G._innerFourthLevelLoaderManager.cancelLoadByUrl($c)},$G._changeWebGLSize=function($c,$d){$F.onStageResize($c,$d),$Y.clientWidth=$c,$Y.clientHeight=$d},$G.__init__=function(){var $c=$d.createMap;$c.lh=[$Kd,"SPRITE3DHIERARCHY"],$c.ls=[$Jd,"SPRITE3DHIERARCHY"],$c.lm=[$Rd,"MESH"],$c.lmat=[$Md,"MATERIAL"],$c.jpg=[$Td,"nativeimage"],$c.jpeg=[$Td,"nativeimage"],$c.png=[$Td,"nativeimage"],$c.pkm=[$Td,"arraybuffer"],$c.raw=[$Pd,"arraybuffer"],$c.mipmaps=[$Pd,"arraybuffer"],$t.parserMap.SPRITE3DHIERARCHY=$G._loadHierarchy,$t.parserMap.MESH=$G._loadMesh,$t.parserMap.MATERIAL=$G._loadMaterial,$t.parserMap.TEXTURECUBE=$G._loadTextureCube,$t.parserMap.TERRAIN=$G._loadTerrain,$G._innerFirstLevelLoaderManager.on("error",null,$G._eventLoadManagerError),$G._innerSecondLevelLoaderManager.on("error",null,$G._eventLoadManagerError),$G._innerThirdLevelLoaderManager.on("error",null,$G._eventLoadManagerError),$G._innerFourthLevelLoaderManager.on("error",null,$G._eventLoadManagerError)},$G.READ_BLOCK=function(){return $G._readData.pos+=4,!0},$G.READ_DATA=function(){return $G._DATA.offset=$G._readData.getUint32(),$G._DATA.size=$G._readData.getUint32(),!0},$G.READ_STRINGS=function(){var $c=[],$d={offset:0,size:0};$d.offset=$G._readData.getUint16(),$d.size=$G._readData.getUint16();$G._readData.pos;$G._readData.pos=$d.offset+$G._DATA.offset;for(var $e=0;$e<$d.size;$e++){var $f=$G._readData.readUTFString();-1===$f.lastIndexOf(".lmat")&&-1===$f.lastIndexOf(".lpbr")||$c.push($f)}return $c},$G.formatRelativePath=function($c,$d){var $e;if("."===$d.charAt(0)){for(var $f=($c+$d).split("/"),$g=0,$h=$f.length;$g<$h;$g++)if(".."==$f[$g]){var $i=$g-1;0<$i&&".."!==$f[$i]&&($f.splice($i,2),$g-=2)}$e=$f.join("/")}else $e=$c+$d;return null!=$E.customFormat&&($e=$E.customFormat($e,null)),$e},$G._eventLoadManagerError=function($c){$x.loader.event("error",$c)},$G._addHierarchyInnerUrls=function($c,$d,$e,$f,$g,$h){var $i=$G.formatRelativePath($f,$g);$e&&($i+=$e),$c.push({url:$i,clas:$h}),$d[$g]=$i},$G._getSprite3DHierarchyInnerUrls=function($c,$d,$e,$f,$g,$h,$i){var $j,$k=0,$l=0;switch($c.type){case"Scene":var $m=$c.customProps.lightmaps;for($k=0,$l=$m.length;$k<$l;$k++){var $n=$m[$k].replace(".exr",".png");$G._addHierarchyInnerUrls($f,$g,$h,$i,$n,$Td)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var $o;if($c.instanceParams)($o=$c.instanceParams.loadPath)&&$G._addHierarchyInnerUrls($d,$g,$h,$i,$o,$Rd);else{($o=($j=$c.customProps).meshPath)&&$G._addHierarchyInnerUrls($d,$g,$h,$i,$o,$Rd);var $p=$j.materials;if($p)for($k=0,$l=$p.length;$k<$l;$k++){for(var $q=$p[$k],$r=$q.type.split("."),$s=$H.window,$t=0,$u=$r.length;$t<$u;++$t){$s=$s[this.clasPaths[$t]]}if("function"!=typeof $s)throw"_getSprite3DHierarchyInnerUrls 错误: "+$q.type+" 不是类";$G._addHierarchyInnerUrls($e,$g,$h,$i,$q.path,$s)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var $v=($j=$c.customProps).meshPath;$v&&$G._addHierarchyInnerUrls($d,$g,$h,$i,$v,$Rd);var $w=$j.material;if($w){$r=$w.type.split("."),$s=$H.window;for($t=0,$u=$r.length;$t<$u;++$t){$s=$s[this.clasPaths[$t]]}$G._addHierarchyInnerUrls($e,$g,$h,$i,$w.path,$s)}else{var $x=$j.materialPath;if($x)$G._addHierarchyInnerUrls($e,$g,$h,$i,$x,ShurikenParticleMaterial);else{var $y=$j.texturePath;$y&&$G._addHierarchyInnerUrls($f,$g,$h,$i,$y,$Td)}}break;case"Terrain":$G._addHierarchyInnerUrls($f,$g,$h,$i,$c.customProps.dataPath,TerrainRes)}var $z=$c.components;for(var $A in $z){var $B=$z[$A];switch($A){case"Animator":var $C=$B.avatarPath;if($C)$G._addHierarchyInnerUrls($f,$g,$h,$i,$C,Avatar);else{var $D=$B.avatar;$D&&$G._addHierarchyInnerUrls($f,$g,$h,$i,$D.path,Avatar)}var $E=$B.clipPaths;for($k=0,$l=$E.length;$k<$l;$k++)$G._addHierarchyInnerUrls($f,$g,$h,$i,$E[$k],AnimationClip)}}var $F=$c.child;for($k=0,$l=$F.length;$k<$l;$k++)$G._getSprite3DHierarchyInnerUrls($F[$k],$d,$e,$f,$g,$h,$i)},$G._loadHierarchy=function($c){$c.on("loaded",null,$G._onHierarchylhLoaded,[$c,$c._class._getGroup()]),$c.load($c.url,"json",!1,null,!0)},$G._onHierarchylhLoaded=function($c,$d,$e){if($c._class.destroyed)$c.endLoad();else{var $f=$c.url,$g=$sd.getURLVerion($f),$h=$E.getPath($f),$i=[],$j=[],$k=[],$l={};$G._getSprite3DHierarchyInnerUrls($e,$i,$j,$k,$l,$g,$h);var $m=$i.length+$j.length+$k.length,$n=$m+1,$o=1/$n;if($G._onProcessChange($c,0,$o,1),0<$k.length){var $p=$m/$n,$q=$D.create(null,$G._onProcessChange,[$c,$o,$p],!1);$G._innerFourthLevelLoaderManager.create($k,$D.create(null,$G._onHierarchyInnerForthLevResouLoaded,[$c,$d,$q,$e,$l,$i,$j,$o+$p*$k.length,$p]),$q,null,null,1,!0,$d)}else $G._onHierarchyInnerForthLevResouLoaded($c,$d,null,$e,$l,$i,$j,$o,$p)}},$G._onHierarchyInnerForthLevResouLoaded=function($c,$d,$e,$f,$g,$h,$i,$j,$k){if($c._class.destroyed)$c.endLoad();else if($e&&$e.recover(),0<$i.length){var $l=$D.create(null,$G._onProcessChange,[$c,$j,$k],!1);$G._innerSecondLevelLoaderManager.create($i,$D.create(null,$G._onHierarchyInnerSecondLevResouLoaded,[$c,$d,$l,$f,$g,$h,$j+$k*$i.length,$k]),$e,null,null,1,!0,$d)}else $G._onHierarchyInnerSecondLevResouLoaded($c,$d,null,$f,$g,$h,$j,$k)},$G._onHierarchyInnerSecondLevResouLoaded=function($c,$d,$e,$f,$g,$h,$i,$j){if($c._class.destroyed)$c.endLoad();else if($e&&$e.recover(),0<$h.length){var $k=$D.create(null,$G._onProcessChange,[$c,$i,$j],!1);$G._innerFirstLevelLoaderManager.create($h,$D.create(null,$G._onHierarchyInnerFirstLevResouLoaded,[$c,$k,$f,$g]),$e,null,null,1,!0,$d)}else $G._onHierarchyInnerFirstLevResouLoaded($c,null,$f,$g)},$G._onHierarchyInnerFirstLevResouLoaded=function($c,$d,$e,$f){$d&&$d.recover(),$c.endLoad([$e,$f])},$G._loadTerrain=function($c){$c.on("loaded",null,$G._onTerrainLtLoaded,[$c,$c._class._getGroup()]),$c.load($c.url,"json",!1,null,!0)},$G._onTerrainLtLoaded=function($c,$d,$e){if($c._class.destroyed)$c.endLoad();else{var $f,$g,$h=$c.url,$i=$sd.getURLVerion($h),$j=$E.getPath($h),$k=[],$l={},$m=0,$n=0,$o=$e.heightData;$f=$o.url,$g=$G.formatRelativePath($j,$f),$i&&($g+=$i),$f=$l[$f]=$g;var $p=$e.detailTexture;for($m=0,$n=$p.length;$m<$n;$m++)$k.push({url:$p[$m].diffuse});var $q=$e.normalMap;for($m=0,$n=$q.length;$m<$n;$m++)$k.push({url:$q[$m]});var $r=$e.alphaMap;for($m=0,$n=$r.length;$m<$n;$m++)$k.push({url:$r[$m],params:[!1,!1,6408,!0]});for($m=0,$n=$k.length;$m<$n;$m++){var $s=$k[$m].url;$g=$G.formatRelativePath($j,$s),$i&&($g+=$i),$k[$m].url=$g,$l[$s]=$g}var $t=$k.length,$u=$t+2,$v=1/$u;$G._onProcessChange($c,0,$v,1);var $w={heightMapLoaded:!1,texturesLoaded:!1},$x=$D.create(null,$G._onProcessChange,[$c,$v,$v],!1);$G._innerFourthLevelLoaderManager.create($f,$D.create(null,$G._onTerrainHeightMapLoaded,[$c,$x,$e,$l,$w]),$x,null,[$o.numX,$o.numZ,$o.bitType,$o.value],1,!0,$d);var $y=$D.create(null,$G._onProcessChange,[$c,2*$v,$t/$u],!1);$G._innerFourthLevelLoaderManager.create($k,$D.create(null,$G._onTerrainTexturesLoaded,[$c,$y,$e,$l,$w]),$y,null,null,1,!0,$d)}},$G._onTerrainHeightMapLoaded=function($c,$d,$e,$f,$g){$g.heightMapLoaded=!0,$g.texturesLoaded&&($c.endLoad([$e,$f]),$d.recover())},$G._onTerrainTexturesLoaded=function($c,$d,$e,$f,$g){$g.texturesLoaded=!0,$g.heightMapLoaded&&($c.endLoad([$e,$f]),$d.recover())},$G._loadMesh=function($c){$c.on("loaded",null,$G._onMeshLmLoaded,[$c,$c._class._getGroup()]),$c.load($c.url,"arraybuffer",!1,null,!0)},$G._onMeshLmLoaded=function($c,$d,$e){if($c._class.destroyed)$c.endLoad();else{var $f,$g,$h,$i=$c.url,$j=$sd.getURLVerion($i),$k=$E.getPath($i),$l={},$m=0,$n=0;switch(($G._readData=new $y($e)).pos=0,$G._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var $o=$G._readData.getUint32();$G._readData.pos=$G._readData.pos+4,$n=$G._readData.getUint16(),$G._readData.pos=$G._readData.pos+8*$n;var $p=$G._readData.getUint32();for($n=$G._readData.getUint16(),$G._readData.pos=$o+$p,$f=[],$m=0;$m<$n;$m++){var $q=$G._readData.readUTFString();-1!==$q.lastIndexOf(".lmat")&&$f.push($q)}break;default:for($G.READ_BLOCK(),$m=0;$m<2;$m++){var $r=$G._readData.getUint16(),$s=$G._strings[$r],$t=$G["READ_"+$s];if(null==$t)throw new Error("model file err,no this function:"+$r+" "+$s);1===$m?$f=$t.call():$t.call()}}for($m=0,$h=$f.length;$m<$h;$m++){var $u=$f[$m];$g=$G.formatRelativePath($k,$u),$j&&($g+=$j),$f[$m]=$g,$l[$u]=$g}if(0<$f.length){$G._onProcessChange($c,0,.5,1);var $v=$D.create(null,$G._onProcessChange,[$c,.5,.5],!1);$G._innerSecondLevelLoaderManager.create($f,$D.create(null,$G._onMeshMateialLoaded,[$c,$v,$e,$l]),$v,null,null,1,!0,$d)}else $c.endLoad([$e,$l])}},$G._onMeshMateialLoaded=function($c,$d,$e,$f){$c.endLoad([$e,$f]),$d.recover()},$G._getMaterialTexturePath=function($c,$d,$e){var $f=$c.length-4;return $c.indexOf(".dds")!=$f&&$c.indexOf(".tga")!=$f&&$c.indexOf(".exr")!=$f&&$c.indexOf(".DDS")!=$f&&$c.indexOf(".TGA")!=$f&&$c.indexOf(".EXR")!=$f||($c=$c.substr(0,$f)+".png"),$c=$G.formatRelativePath($e,$c),$d&&($c+=$d),$c},$G._loadMaterial=function($c){$c.on("loaded",null,$G._onMaterilLmatLoaded,[$c,$c._class._getGroup()]),$c.load($c.url,"json",!1,null,!0)},$G._onMaterilLmatLoaded=function($c,$d,$e){if($c._class.destroyed)$c.endLoad();else{var $f,$g=$c.url,$h=$sd.getURLVerion($g),$i=$E.getPath($g),$j=[],$k={},$l=$e.customProps,$m=$e.version;if($m)switch($m){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var $n=$e.props.textures,$o=0,$p=$n.length;$o<$p;$o++){var $q=$n[$o],$r=$q.path;if($r){var $s=$r.length-4;$r.indexOf(".exr")!=$s&&$r.indexOf(".EXR")!=$s||($r=$r.substr(0,$s)+".png"),$f=$G.formatRelativePath($i,$r),$h&&($f+=$h),$j.push({url:$f,params:$q.params}),$k[$r]=$f}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var $t=$l.diffuseTexture.texture2D;if($t&&($f=$G._getMaterialTexturePath($t,$h,$i),$j.push($f),$k[$t]=$f),$l.normalTexture){var $u=$l.normalTexture.texture2D;$u&&($f=$G._getMaterialTexturePath($u,$h,$i),$j.push($f),$k[$u]=$f)}if($l.specularTexture){var $v=$l.specularTexture.texture2D;$v&&($f=$G._getMaterialTexturePath($v,$h,$i),$j.push($f),$k[$v]=$f)}if($l.emissiveTexture){var $w=$l.emissiveTexture.texture2D;$w&&($f=$G._getMaterialTexturePath($w,$h,$i),$j.push($f),$k[$w]=$f)}if($l.ambientTexture){var $x=$l.ambientTexture.texture2D;$x&&($f=$G._getMaterialTexturePath($x,$h,$i),$j.push($f),$k[$x]=$f)}if($l.reflectTexture){var $y=$l.reflectTexture.texture2D;$y&&($f=$G._getMaterialTexturePath($y,$h,$i),$j.push($f),$k[$y]=$f)}}var $z=$j.length,$A=$z+1,$B=1/$A;if($G._onProcessChange($c,0,$B,1),0<$z){var $C=$D.create(null,$G._onProcessChange,[$c,$B,$z/$A],!1);$G._innerFourthLevelLoaderManager.create($j,$D.create(null,$G._onMateialTexturesLoaded,[$c,$C,$e,$k]),$C,$Td,null,1,!0,$d)}else $G._onMateialTexturesLoaded($c,null,$e,null)}},$G._onMateialTexturesLoaded=function($c,$d,$e,$f){$c.endLoad([$e,$f]),$d&&$d.recover()},$G._loadTextureCube=function($c){$c.on("loaded",null,$G._onTextureCubeLtcLoaded,[$c]),$c.load($c.url,"json",!1,null,!0)},$G._onTextureCubeLtcLoaded=function($c,$d){if($c._class.destroyed)$c.endLoad();else{var $e=$E.getPath($c.url),$f=[$G.formatRelativePath($e,$d.px),$G.formatRelativePath($e,$d.nx),$G.formatRelativePath($e,$d.py),$G.formatRelativePath($e,$d.ny),$G.formatRelativePath($e,$d.pz),$G.formatRelativePath($e,$d.nz)];$G._onProcessChange($c,0,1/7,1);var $g=$D.create(null,$G._onProcessChange,[$c,1/7,6/7],!1);$G._innerFourthLevelLoaderManager.load($f,$D.create(null,$G._onTextureCubeImagesLoaded,[$c,$f,$g]),$g,"nativeimage")}},$G._onTextureCubeImagesLoaded=function($c,$d,$e){var $f=[];$f.length=6;for(var $g=0;$g<6;$g++){var $h=$d[$g];$f[$g]=$t.getRes($h),$t.clearRes($h)}$c.endLoad($f),$e.recover()},$G._onProcessChange=function($c,$d,$e,$f){($f=$d+$f*$e)<1&&$c.event("progress",$f)},$G.init=function($c,$d,$e,$f,$g,$h){if(void 0===$e&&($e=!1),void 0===$f&&($f=!1),void 0===$g&&($g=!0),void 0===$h&&($h=!0),$u.update3DLoop=function(){},$u.cancelLoadByUrl=function($c){$G._cancelLoadByUrl($c)},$k.isAntialias=$e,$k.isAlpha=$f,$k.premultipliedAlpha=$g,$k.isStencil=$h,!$F.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");$u.changeWebGLSize=$G._changeWebGLSize,$r.is3DMode=!0,$x.init($c,$d),$I.__init__(),$nd.__init__(),$Xd.__init__(),$Q.__init__(),$G.__init__(),$i.maxTextureCount=2,($G.debugMode||$Z.debugMode)&&($G._debugPhasorSprite=new $V)},$G.HIERARCHY="SPRITE3DHIERARCHY",$G.MESH="MESH",$G.MATERIAL="MATERIAL",$G.PBRMATERIAL="PBRMTL",$G.TEXTURECUBE="TEXTURECUBE",$G.TERRAIN="TERRAIN",$G._readData=null,$G._debugPhasorSprite=null,$G.debugMode=!1,$n($G,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new $d},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new $d},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new $d},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new $d}]),$G}(),$ud=function($c){function $g($c){$g.__super.call(this),this._owner=$c,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}$p($g,"laya.d3.animation.AnimationTransform3D",$h);var $d=$g.prototype;return $d._getlocalMatrix=function(){return this._localUpdate&&($sd._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},$d._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var $c=0,$d=this._childs.length;$c<$d;$c++)this._childs[$c]._onWorldTransform()}},$d._setWorldMatrixAndUpdate=function($c){if(this._worldMatrix=$c,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var $d=this._getlocalMatrix(),$e=0;$e<16;++$e)this._worldMatrix[$e]=$d[$e];else $sd.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},$d._setWorldMatrixNoUpdate=function($c){this._worldMatrix=$c},$d._setWorldMatrixIgnoreUpdate=function($c){this._worldMatrix=$c,this._worldUpdate=!1},$d.getLocalPosition=function(){return this._localPosition},$d.setLocalPosition=function($c){if(this._parent)this._localPosition=$c,this._localUpdate=!0,this._onWorldTransform();else{var $d=this._entity.owner._transform,$e=this._entity.localPosition,$f=$e.elements;$f[0]=$c[0],$f[1]=$c[1],$f[2]=$c[2],$d.localPosition=$e}},$d.getLocalRotation=function(){if(this._localQuaternionUpdate){var $c=this._localRotationEuler;$sd._quaternionCreateFromYawPitchRollArray($c[1]/$g._angleToRandin,$c[0]/$g._angleToRandin,$c[2]/$g._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},$d.setLocalRotation=function($c){if(this._parent)this._localRotation=$c,$sd.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $d=this._entity.owner._transform,$e=this._entity.localRotation,$f=$e.elements;$f[0]=$c[0],$f[1]=$c[1],$f[2]=$c[2],$f[3]=$c[3],$d.localRotation=$e}},$d.getLocalScale=function(){return this._localScale},$d.setLocalScale=function($c){if(this._parent)this._localScale=$c,this._localUpdate=!0,this._onWorldTransform();else{var $d=this._entity.owner._transform,$e=this._entity.localScale,$f=$e.elements;$f[0]=$c[0],$f[1]=$c[1],$f[2]=$c[2],$d.localScale=$e}},$d.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){$sd.getYawPitchRoll(this._localRotation,$g._tempVector3);var $c=$g._tempVector3,$d=this._localRotationEuler;$d[0]=$c[1]*$g._angleToRandin,$d[1]=$c[0]*$g._angleToRandin,$d[2]=$c[2]*$g._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},$d.setLocalRotationEuler=function($c){if(this._parent)$sd._quaternionCreateFromYawPitchRollArray($c[1]/$g._angleToRandin,$c[0]/$g._angleToRandin,$c[2]/$g._angleToRandin,this._localRotation),this._localRotationEuler=$c,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $d=this._entity.owner._transform,$e=this._entity.localRotationEuler,$f=$e.elements;$f[0]=$c[0],$f[1]=$c[1],$f[2]=$c[2],$d.localRotationEuler=$e}},$d.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)$sd.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var $c=this._getlocalMatrix(),$d=0;$d<16;++$d)this._worldMatrix[$d]=$c[$d];this._worldUpdate=!1}return this._worldMatrix},$d.setParent=function($c){if(this._parent!==$c){if(this._parent){var $d=this._parent._childs,$e=$d.indexOf(this);$d.splice($e,1)}$c&&($c._childs.push(this),$c&&this._onWorldTransform()),this._parent=$c}},$n($g,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$g}(),$vd=function($c){function $d(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,$d.__super.call(this),this._destroyed=!1,this._id=$d._uniqueIDCounter,$d._uniqueIDCounter++}$p($d,"laya.d3.component.Component3D",$h);var $e=$d.prototype;return $x.imps($e,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),$e._initialize=function($c){this._owner=$c,this._enable=!0,this.started=!1,this._load($c)},$e._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},$e._load=function($c){},$e._start=function($c){},$e._update=function($c){},$e._lateUpdate=function($c){},$e._preRenderUpdate=function($c){},$e._postRenderUpdate=function($c){},$e._unload=function($c){this.offAll()},$e._cloneTo=function($c){},$q(0,$e,"id",function(){return this._id}),$q(0,$e,"destroyed",function(){return this._destroyed}),$q(0,$e,"owner",function(){return this._owner}),$q(0,$e,"enable",function(){return this._enable},function($c){this._enable!==$c&&(this._enable=$c,this.event("enablechanged",this._enable))}),$q(0,$e,"isSingleton",function(){return $d._isSingleton}),$d._isSingleton=!0,$d._uniqueIDCounter=1,$d}(),$wd=function($c){function $d(){this._destroyed=!1,$d.__super.call(this),this._destroyed=!1}$p($d,"laya.d3.core.GeometryFilter",$h);var $e=$d.prototype;return $x.imps($e,{"laya.resource.IDestroy":!0}),$e._destroy=function(){this.offAll(),this._destroyed=!0},$q(0,$e,"_isAsyncLoaded",function(){return!0}),$q(0,$e,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),$q(0,$e,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),$q(0,$e,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),$q(0,$e,"destroyed",function(){return this._destroyed}),$d}(),$xd=function($c){function $f($c){$f.__super.call(this),this._id=++$f._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new $Zc(new $id,new $id),this._boundingBoxCenter=new $id,this._boundingSphere=new $_c(new $id,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=$c,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}$p($f,"laya.d3.core.render.BaseRender",$h);var $d=$f.prototype;return $x.imps($d,{"laya.resource.IDestroy":!0}),$d._changeMaterialReference=function($c,$d){$c&&$c._removeReference(),$d._addReference()},$d._getInstanceMaterial=function($c,$d){var $e=new $c.constructor;return $c.cloneTo($e),$e.name=$e.name+"(Instance)",this._materialsInstance[$d]=!0,this._changeMaterialReference(this._materials[$d],$e),this._materials[$d]=$e},$d._setShaderValuelightMap=function($c){this._setShaderValueTexture(3,$c)},$d._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},$d._renderRenderableBoundBox=function(){var $c=$td._debugPhasorSprite,$d=this.boundingBox,$e=$f._tempBoundBoxCorners;$d.getCorners($e),$c.line($e[0],$f._greenColor,$e[1],$f._greenColor),$c.line($e[2],$f._greenColor,$e[3],$f._greenColor),$c.line($e[4],$f._greenColor,$e[5],$f._greenColor),$c.line($e[6],$f._greenColor,$e[7],$f._greenColor),$c.line($e[0],$f._greenColor,$e[3],$f._greenColor),$c.line($e[1],$f._greenColor,$e[2],$f._greenColor),$c.line($e[2],$f._greenColor,$e[6],$f._greenColor),$c.line($e[3],$f._greenColor,$e[7],$f._greenColor),$c.line($e[0],$f._greenColor,$e[4],$f._greenColor),$c.line($e[1],$f._greenColor,$e[5],$f._greenColor),$c.line($e[4],$f._greenColor,$e[7],$f._greenColor),$c.line($e[5],$f._greenColor,$e[6],$f._greenColor)},$d._calculateBoundingSphere=function(){throw"BaseRender: must override it."},$d._calculateBoundingBox=function(){throw"BaseRender: must override it."},$d._setShaderValueTexture=function($c,$d){this._owner._shaderValues.setValue($c,$d)},$d._setShaderValueMatrix4x4=function($c,$d){this._owner._shaderValues.setValue($c,$d?$d.elements:null)},$d._setShaderValueColor=function($c,$d){this._owner._shaderValues.setValue($c,$d?$d.elements:null)},$d._setShaderValueBuffer=function($c,$d){this._owner._shaderValues.setValue($c,$d)},$d._setShaderValueInt=function($c,$d){this._owner._shaderValues.setValue($c,$d)},$d._setShaderValueBool=function($c,$d){this._owner._shaderValues.setValue($c,$d)},$d._setShaderValueNumber=function($c,$d){this._owner._shaderValues.setValue($c,$d)},$d._setShaderValueVector2=function($c,$d){this._owner._shaderValues.setValue($c,$d?$d.elements:null)},$d._addShaderDefine=function($c){this._owner._shaderDefineValue|=$c},$d._removeShaderDefine=function($c){this._owner._shaderDefineValue&=~$c},$d._renderUpdate=function($c){return!0},$d._applyLightMapParams=function(){if(0<=this._lightmapIndex){var $c=this._owner.scene;if($c){var $d=$c.getlightmaps()[this._lightmapIndex];$d?(this._addShaderDefine($Vd.SAHDERDEFINE_LIGHTMAP),$d.loaded?this._setShaderValuelightMap($d):$d.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine($Vd.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($Vd.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($Vd.SAHDERDEFINE_LIGHTMAP)},$d._updateOctreeNode=function(){var $c=this._treeNode;$c&&this._octreeNodeNeedChange&&($c.updateObject(this),this._octreeNodeNeedChange=!1)},$d._destroy=function(){this.offAll();var $c=0,$d=0;for($c=0,$d=this._renderElements.length;$c<$d;$c++)this._renderElements[$c]._destroy();for($c=0,$d=this._materials.length;$c<$d;$c++)this._materials[$c]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},$q(0,$d,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),$q(0,$d,"id",function(){return this._id}),$q(0,$d,"material",function(){var $c=this._materials[0];if($c&&!this._materialsInstance[0]){var $d=this._getInstanceMaterial($c,0);this.event("materialchanged",[this,0,$d])}return this._materials[0]},function($c){this.sharedMaterial=$c}),$q(0,$d,"sharedMaterial",function(){return this._materials[0]},function($c){var $d=this._materials[0];$d!==$c&&(this._materials[0]=$c,this._materialsInstance[0]=!1,this._changeMaterialReference($d,$c),this.event("materialchanged",[this,0,$c]))}),$q(0,$d,"lightmapIndex",function(){return this._lightmapIndex},function($c){this._lightmapIndex=$c,this._applyLightMapParams()}),$q(0,$d,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function($c){this._lightmapScaleOffset=$c,this._setShaderValueColor(2,$c),this._addShaderDefine($Vd.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),$q(0,$d,"enable",function(){return this._enable},function($c){this._enable=$c,this.event("enablechanged",[this,$c])}),$q(0,$d,"materials",function(){for(var $c=0,$d=this._materials.length;$c<$d;$c++)if(!this._materialsInstance[$c]){var $e=this._getInstanceMaterial(this._materials[$c],$c);this.event("materialchanged",[this,$c,$e])}return this._materials.slice()},function($c){this.sharedMaterials=$c}),$q(0,$d,"sharedMaterials",function(){return this._materials.slice()},function($c){if(!$c)throw new Error("MeshRender: shadredMaterials value can't be null.");var $d=$c.length;this._materialsInstance.length=$d;for(var $e=0;$e<$d;$e++){var $f=this._materials[$e];$f!==$c[$e]&&(this._materialsInstance[$e]=!1,this._changeMaterialReference($f,$c[$e]),this.event("materialchanged",[this,$e,$c[$e]]))}this._materials=$c}),$q(0,$d,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),$q(0,$d,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var $c=this.boundingBox;$id.add($c.min,$c.max,this._boundingBoxCenter),$id.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),$q(0,$d,"receiveShadow",function(){return this._receiveShadow},function($c){this._receiveShadow!==$c&&((this._receiveShadow=$c)?this._addShaderDefine($pd.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine($pd.SHADERDEFINE_RECEIVE_SHADOW))}),$q(0,$d,"destroyed",function(){return this._destroyed}),$f._uniqueIDCounter=0,$n($f,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new $id,new $id,new $id,new $id,new $id,new $id,new $id,new $id]},"_greenColor",function(){return this._greenColor=new $jd(0,1,0,1)}]),$f}(),$yd=function($c){function $j($c){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,$j.__super.call(this),this._localPosition=new $id,this._localRotation=new $ed(0,0,0,1),this._localScale=new $id(1,1,1),this._localRotationEuler=new $id,this._localMatrix=new $cd,this._position=new $id,this._rotation=new $ed(0,0,0,1),this._scale=new $id(1,1,1),this._worldMatrix=new $cd,this._forward=new $id,this._up=new $id,this._right=new $id,this._owner=$c,this._childs=[]}$p($j,"laya.d3.core.Transform3D",$h);var $d=$j.prototype;return $d._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)$cd.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var $c=$j._tempVector30;$id.multiply(this.pivot,this._localScale,$c);var $d=$j._tempVector31;$id.subtract($c,this.pivot,$d);var $e=$j._tempVector32,$f=this.localRotation;$id.transformQuat($c,$f,$e),$id.subtract($e,$c,$e);var $g=$j._tempVector33;$id.subtract(this._localPosition,$d,$g),$id.subtract($g,$e,$g),$cd.createAffineTransformation($g,$f,this._localScale,this._localMatrix)}},$d._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $c=0,$d=this._childs.length;$c<$d;$c++)this._childs[$c]._onWorldPositionRotationTransform()}},$d._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $c=0,$d=this._childs.length;$c<$d;$c++)this._childs[$c]._onWorldPositionScaleTransform()}},$d._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var $c=0,$d=this._childs.length;$c<$d;$c++)this._childs[$c]._onWorldPositionTransform()}},$d._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $c=0,$d=this._childs.length;$c<$d;$c++)this._childs[$c]._onWorldPositionRotationTransform()}},$d._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $c=0,$d=this._childs.length;$c<$d;$c++)this._childs[$c]._onWorldPositionScaleTransform()}},$d._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $c=0,$d=this._childs.length;$c<$d;$c++)this._childs[$c]._onWorldTransform()}},$d.translate=function($c,$d){void 0===$d&&($d=!0),$d?($cd.createFromQuaternion(this.localRotation,$j._tempMatrix0),$id.transformCoordinate($c,$j._tempMatrix0,$j._tempVector30),$id.add(this.localPosition,$j._tempVector30,this._localPosition),this.localPosition=this._localPosition):($id.add(this.position,$c,this._position),this.position=this._position)},$d.rotate=function($c,$d,$e){var $f;void 0===$d&&($d=!0),void 0===$e&&($e=!0),$f=$e?$c:($id.scale($c,Math.PI/180,$j._tempVector30),$j._tempVector30),$ed.createFromYawPitchRoll($f.y,$f.x,$f.z,$j._tempQuaternion0),$d?($ed.multiply(this._localRotation,$j._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):($ed.multiply($j._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},$d.lookAt=function($c,$d,$e){void 0===$e&&($e=!1);var $f,$g=$c.elements;if($e){if($f=this._localPosition.elements,Math.abs($f[0]-$g[0])<$ac.zeroTolerance&&Math.abs($f[1]-$g[1])<$ac.zeroTolerance&&Math.abs($f[2]-$g[2])<$ac.zeroTolerance)return;$ed.lookAt(this._localPosition,$c,$d,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var $h=this.position;if($f=$h.elements,Math.abs($f[0]-$g[0])<$ac.zeroTolerance&&Math.abs($f[1]-$g[1])<$ac.zeroTolerance&&Math.abs($f[2]-$g[2])<$ac.zeroTolerance)return;$ed.lookAt($h,$c,$d,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},$q(0,$d,"_isFrontFaceInvert",function(){var $c=this.scale,$d=$c.x<0;return $c.y<0&&($d=!$d),$c.z<0&&($d=!$d),$d}),$q(0,$d,"owner",function(){return this._owner}),$q(0,$d,"localRotation",function(){if(this._localQuaternionUpdate){var $c=this._localRotationEuler.elements;$ed.createFromYawPitchRoll($c[1]/$j._angleToRandin,$c[0]/$j._angleToRandin,$c[2]/$j._angleToRandin,this._localRotation)}return this._localRotation},function($c){this._localRotation=$c,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$q(0,$d,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?$cd.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function($c){null===this._parent?$c.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),$cd.multiply(this._localMatrix,$c,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=$c,this._worldUpdate=!1}),$q(0,$d,"worldNeedUpdate",function(){return this._worldUpdate}),$q(0,$d,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function($c){this._localMatrix=$c,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),$q(0,$d,"dummy",function(){return this._dummy},function($c){this._dummy!==$c&&(this._dummy&&(this._dummy._entity=null),$c&&($c._entity=this),this._dummy=$c)}),$q(0,$d,"localPosition",function(){return this._localPosition},function($c){this._localPosition=$c,this._localUpdate=!0,this._onWorldPositionTransform()}),$q(0,$d,"position",function(){if(this._positionUpdate){if(null!=this._parent){var $c=this._parent.position;$id.multiply(this._localPosition,this._parent.scale,$j._tempVector30),$id.transformQuat($j._tempVector30,this._parent.rotation,$j._tempVector30),$id.add($c,$j._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function($c){if(null!=this._parent){$id.subtract($c,this._parent.position,this._localPosition);var $d=this._parent.scale.elements,$e=$d[0],$f=$d[1],$g=$d[2];if(1!==$e||1!==$f||1!==$g){var $h=$j._tempVector30,$i=$h.elements;$i[0]=1/$e,$i[1]=1/$f,$i[2]=1/$g,$id.multiply(this._localPosition,$h,this._localPosition)}this._parent.rotation.invert($j._tempQuaternion0),$id.transformQuat(this._localPosition,$j._tempQuaternion0,this._localPosition)}else $c.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=$c,this._positionUpdate=!1}),$q(0,$d,"localScale",function(){return this._localScale},function($c){this._localScale=$c,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),$q(0,$d,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll($j._tempVector30);var $c=$j._tempVector30.elements,$d=this._localRotationEuler.elements;$d[0]=$c[1]*$j._angleToRandin,$d[1]=$c[0]*$j._angleToRandin,$d[2]=$c[2]*$j._angleToRandin}return this._localRotationEuler},function($c){this._localRotationEuler=$c,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$q(0,$d,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?$ed.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function($c){null!=this._parent?(this._parent.rotation.invert($j._tempQuaternion0),$ed.multiply($c,$j._tempQuaternion0,this._localRotation)):$c.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=$c,this._rotationUpdate=!1}),$q(0,$d,"scale",function(){return this._scaleUpdate&&(null!==this._parent?$id.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function($c){if(null!==this._parent){var $d=this._parent.scale.elements,$e=$j._tempVector30.elements;$e[0]=1/$d[0],$e[1]=1/$d[1],$e[2]=1/$d[2],$id.multiply($c,$j._tempVector30,this._localScale)}else $c.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=$c,this._scaleUpdate=!1}),$q(0,$d,"rotationEuler",null,function($c){$ed.createFromYawPitchRoll($c.y,$c.x,$c.z,this._rotation),this.rotation=this._rotation}),$q(0,$d,"forward",function(){var $c=this.worldMatrix.elements;return this._forward.elements[0]=-$c[8],this._forward.elements[1]=-$c[9],this._forward.elements[2]=-$c[10],this._forward}),$q(0,$d,"up",function(){var $c=this.worldMatrix.elements;return this._up.elements[0]=$c[4],this._up.elements[1]=$c[5],this._up.elements[2]=$c[6],this._up}),$q(0,$d,"right",function(){var $c=this.worldMatrix.elements;return this._right.elements[0]=$c[0],this._right.elements[1]=$c[1],this._right.elements[2]=$c[2],this._right}),$q(0,$d,"parent",function(){return this._parent},function($c){if(this._parent!==$c){if(this._parent){var $d=this._parent._childs,$e=$d.indexOf(this);$d.splice($e,1)}$c&&($c._childs.push(this),$c&&this._onWorldTransform()),this._parent=$c}}),$n($j,["_tempVector30",function(){return this._tempVector30=new $id},"_tempVector31",function(){return this._tempVector31=new $id},"_tempVector32",function(){return this._tempVector32=new $id},"_tempVector33",function(){return this._tempVector33=new $id},"_tempQuaternion0",function(){return this._tempQuaternion0=new $ed},"_tempMatrix0",function(){return this._tempMatrix0=new $cd},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$j}(),$zd=(function($c){function $d(){this._rotation=0,this._matNeedUpdte=!1,$d.__super.call(this),this._matrix=new $cd,this._offset=new $hd,this._tiling=new $hd(1,1)}$p($d,"laya.d3.core.TransformUV",$h);var $e=$d.prototype;$x.imps($e,{"laya.d3.core.IClone":!0}),$e._updateMatrix=function(){$d._tempOffsetV3.elements[0]=this._offset.x,$d._tempOffsetV3.elements[1]=this._offset.y,$ed.createFromYawPitchRoll(0,0,this._rotation,$d._tempRotationQua),$d._tempTitlingV3.elements[0]=this._tiling.x,$d._tempTitlingV3.elements[1]=this._tiling.y,$cd.createAffineTransformation($d._tempOffsetV3,$d._tempRotationQua,$d._tempTitlingV3,this._matrix)},$e.cloneTo=function($c){$c._matrix=this._matrix.clone(),$c._offset=this._offset.clone(),$c._rotation=this._rotation,$c._tiling=this._tiling.clone()},$e.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$e,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),$q(0,$e,"tiling",function(){return this._tiling},function($c){this._tiling=$c,this._matNeedUpdte=!0}),$q(0,$e,"offset",function(){return this._offset},function($c){this._offset=$c,this._matNeedUpdte=!0}),$q(0,$e,"rotation",function(){return this._rotation},function($c){this._rotation=$c,this._matNeedUpdte=!0}),$n($d,["_tempOffsetV3",function(){return this._tempOffsetV3=new $id(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new $ed},"_tempTitlingV3",function(){return this._tempTitlingV3=new $id(1,1,1)}])}(),function($e){function $c(){this.x=NaN,this.y=NaN,this.z=NaN,$c.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}$p($c,"laya.d3.core.particleShuriKen.module.shape.BoxShape",$e);var $d=$c.prototype;$d._getShapeBoundBox=function($c){var $d=$c.min.elements;$d[0]=.5*-this.x,$d[1]=.5*-this.y,$d[2]=.5*-this.z;var $e=$c.max.elements;$e[0]=.5*this.x,$e[1]=.5*this.y,$e[2]=.5*this.z},$d._getSpeedBoundBox=function($c){var $d=$c.min.elements;$d[0]=0,$d[1]=0,$d[2]=0;var $e=$c.max.elements;$e[0]=0,$e[1]=1,$e[2]=0},$d.generatePositionAndDirection=function($c,$d,$e,$f){var $g=$c.elements,$h=$d.elements;$e?($e.seed=$f[16],$T._randomPointInsideHalfUnitBox($c,$e),$f[16]=$e.seed):$T._randomPointInsideHalfUnitBox($c),$g[0]=this.x*$g[0],$g[1]=this.y*$g[1],$g[2]=this.z*$g[2],this.randomDirection?$e?($e.seed=$f[17],$T._randomPointUnitSphere($d,$e),$f[17]=$e.seed):$T._randomPointUnitSphere($d):($h[0]=0,$h[1]=0,$h[2]=1)},$d.cloneTo=function($c){$e.prototype.cloneTo.call(this,$c);var $d=$c;$d.x=this.x,$d.y=this.y,$d.z=this.z,$d.randomDirection=this.randomDirection}}($O),function($e){function $i(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,$i.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}$p($i,"laya.d3.core.particleShuriKen.module.shape.CircleShape",$e);var $c=$i.prototype;$c._getShapeBoundBox=function($c){var $d=$c.min.elements;$d[0]=$d[2]=-this.radius,$d[1]=0;var $e=$c.max.elements;$e[0]=$e[2]=this.radius,$e[1]=0},$c._getSpeedBoundBox=function($c){var $d=$c.min.elements;$d[0]=$d[1]=-1,$d[2]=0;var $e=$c.max.elements;$e[0]=$e[1]=1,$e[2]=0},$c.generatePositionAndDirection=function($c,$d,$e,$f){var $g=$c.elements,$h=$i._tempPositionPoint.elements;$e?($e.seed=$f[16],this.emitFromEdge?$T._randomPointUnitArcCircle(this.arc,$i._tempPositionPoint,$e):$T._randomPointInsideUnitArcCircle(this.arc,$i._tempPositionPoint,$e),$f[16]=$e.seed):this.emitFromEdge?$T._randomPointUnitArcCircle(this.arc,$i._tempPositionPoint):$T._randomPointInsideUnitArcCircle(this.arc,$i._tempPositionPoint),$g[0]=-$h[0],$g[1]=$h[1],$g[2]=0,$id.scale($c,this.radius,$c),this.randomDirection?$e?($e.seed=$f[17],$T._randomPointUnitSphere($d,$e),$f[17]=$e.seed):$T._randomPointUnitSphere($d):$c.cloneTo($d)},$c.cloneTo=function($c){$e.prototype.cloneTo.call(this,$c);var $d=$c;$d.radius=this.radius,$d.arc=this.arc,$d.emitFromEdge=this.emitFromEdge,$d.randomDirection=this.randomDirection},$n($i,["_tempPositionPoint",function(){return this._tempPositionPoint=new $hd}])}($O),function($e){function $o(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,$o.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}$p($o,"laya.d3.core.particleShuriKen.module.shape.ConeShape",$e);var $c=$o.prototype;$c._getShapeBoundBox=function($c){var $d=this.radius+this.length*Math.sin(this.angle),$e=this.length*Math.cos(this.angle),$f=$c.min.elements;$f[0]=$f[1]=-$d,$f[2]=0;var $g=$c.max.elements;$g[0]=$g[1]=$d,$g[2]=$e},$c._getSpeedBoundBox=function($c){var $d=Math.sin(this.angle),$e=$c.min.elements;$e[0]=$e[1]=-$d,$e[2]=0;var $f=$c.max.elements;$f[0]=$e[1]=$d,$f[2]=1},$c.generatePositionAndDirection=function($c,$d,$e,$f){var $g,$h=$c.elements,$i=$d.elements,$j=$o._tempPositionPoint.elements,$k=NaN,$l=NaN,$m=Math.cos(this.angle),$n=Math.sin(this.angle);switch(this.emitType){case 0:$e?($e.seed=$f[16],$T._randomPointInsideUnitCircle($o._tempPositionPoint,$e),$f[16]=$e.seed):$T._randomPointInsideUnitCircle($o._tempPositionPoint),$k=$j[0],$l=$j[1],$h[0]=$k*this.radius,$h[1]=$l*this.radius,$h[2]=0,this.randomDirection?($e?($e.seed=$f[17],$T._randomPointInsideUnitCircle($o._tempDirectionPoint,$e),$f[17]=$e.seed):$T._randomPointInsideUnitCircle($o._tempDirectionPoint),$g=$o._tempDirectionPoint.elements,$i[0]=$g[0]*$n,$i[1]=$g[1]*$n):($i[0]=$k*$n,$i[1]=$l*$n),$i[2]=$m;break;case 1:$e?($e.seed=$f[16],$T._randomPointUnitCircle($o._tempPositionPoint,$e),$f[16]=$e.seed):$T._randomPointUnitCircle($o._tempPositionPoint),$k=$j[0],$l=$j[1],$h[0]=$k*this.radius,$h[1]=$l*this.radius,$h[2]=0,this.randomDirection?($e?($e.seed=$f[17],$T._randomPointInsideUnitCircle($o._tempDirectionPoint,$e),$f[17]=$e.seed):$T._randomPointInsideUnitCircle($o._tempDirectionPoint),$g=$o._tempDirectionPoint.elements,$i[0]=$g[0]*$n,$i[1]=$g[1]*$n):($i[0]=$k*$n,$i[1]=$l*$n),$i[2]=$m;break;case 2:$e?($e.seed=$f[16],$T._randomPointInsideUnitCircle($o._tempPositionPoint,$e)):$T._randomPointInsideUnitCircle($o._tempPositionPoint),$k=$j[0],$l=$j[1],$h[0]=$k*this.radius,$h[1]=$l*this.radius,$i[$h[2]=0]=$k*$n,$i[1]=$l*$n,$i[2]=$m,$id.normalize($d,$d),$e?($id.scale($d,this.length*$e.getFloat(),$d),$f[16]=$e.seed):$id.scale($d,this.length*Math.random(),$d),$id.add($c,$d,$c),this.randomDirection&&($e?($e.seed=$f[17],$T._randomPointUnitSphere($d,$e),$f[17]=$e.seed):$T._randomPointUnitSphere($d));break;case 3:$e?($e.seed=$f[16],$T._randomPointUnitCircle($o._tempPositionPoint,$e)):$T._randomPointUnitCircle($o._tempPositionPoint),$k=$j[0],$l=$j[1],$h[0]=$k*this.radius,$h[1]=$l*this.radius,$i[$h[2]=0]=$k*$n,$i[1]=$l*$n,$i[2]=$m,$id.normalize($d,$d),$e?($id.scale($d,this.length*$e.getFloat(),$d),$f[16]=$e.seed):$id.scale($d,this.length*Math.random(),$d),$id.add($c,$d,$c),this.randomDirection&&($e?($e.seed=$f[17],$T._randomPointUnitSphere($d,$e),$f[17]=$e.seed):$T._randomPointUnitSphere($d));break;default:throw new Error("ConeShape:emitType is invalid.")}},$c.cloneTo=function($c){$e.prototype.cloneTo.call(this,$c);var $d=$c;$d.angle=this.angle,$d.radius=this.radius,$d.length=this.length,$d.emitType=this.emitType,$d.randomDirection=this.randomDirection},$n($o,["_tempPositionPoint",function(){return this._tempPositionPoint=new $hd},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new $hd}])}($O),function($e){function $c(){this.radius=NaN,this.emitFromShell=!1,$c.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$p($c,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",$e);var $d=$c.prototype;$d._getShapeBoundBox=function($c){var $d=$c.min.elements;$d[0]=$d[1]=$d[2]=-this.radius;var $e=$c.max.elements;$e[0]=$e[1]=this.radius,$e[2]=0},$d._getSpeedBoundBox=function($c){var $d=$c.min.elements;$d[0]=$d[1]=-1,$d[2]=0;var $e=$c.max.elements;$e[0]=$e[1]=$e[2]=1},$d.generatePositionAndDirection=function($c,$d,$e,$f){var $g=$c.elements;$e?($e.seed=$f[16],this.emitFromShell?$T._randomPointUnitSphere($c,$e):$T._randomPointInsideUnitSphere($c,$e),$f[16]=$e.seed):this.emitFromShell?$T._randomPointUnitSphere($c):$T._randomPointInsideUnitSphere($c),$id.scale($c,this.radius,$c);var $h=$g[2];$h<0&&($g[2]=-1*$h),this.randomDirection?$e?($e.seed=$f[17],$T._randomPointUnitSphere($d,$e),$f[17]=$e.seed):$T._randomPointUnitSphere($d):$c.cloneTo($d)},$d.cloneTo=function($c){$e.prototype.cloneTo.call(this,$c);var $d=$c;$d.radius=this.radius,$d.emitFromShell=this.emitFromShell,$d.randomDirection=this.randomDirection}}($O),function($e){function $c(){this.radius=NaN,this.emitFromShell=!1,$c.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$p($c,"laya.d3.core.particleShuriKen.module.shape.SphereShape",$e);var $d=$c.prototype;$d._getShapeBoundBox=function($c){var $d=$c.min.elements;$d[0]=$d[1]=$d[2]=-this.radius;var $e=$c.max.elements;$e[0]=$e[1]=$e[2]=this.radius},$d._getSpeedBoundBox=function($c){var $d=$c.min.elements;$d[0]=$d[1]=$d[2]=-1;var $e=$c.max.elements;$e[0]=$e[1]=$e[2]=1},$d.generatePositionAndDirection=function($c,$d,$e,$f){$e?($e.seed=$f[16],this.emitFromShell?$T._randomPointUnitSphere($c,$e):$T._randomPointInsideUnitSphere($c,$e),$f[16]=$e.seed):this.emitFromShell?$T._randomPointUnitSphere($c):$T._randomPointInsideUnitSphere($c),$id.scale($c,this.radius,$c),this.randomDirection?$e?($e.seed=$f[17],$T._randomPointUnitSphere($d,$e),$f[17]=$e.seed):$T._randomPointUnitSphere($d):$c.cloneTo($d)},$d.cloneTo=function($c){$e.prototype.cloneTo.call(this,$c);var $d=$c;$d.radius=this.radius,$d.emitFromShell=this.emitFromShell,$d.randomDirection=this.randomDirection}}($O),function($c){function $d(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,$d.__super.call(this)}return $p($d,"laya.d3.core.render.SubMeshRenderElement",$W),$d}()),$Ad=function($c){function $s($c,$d,$e,$f,$g,$h){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=$c,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[$pd.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[$Vd.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[$Vd.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[$Ed.SHADERDEFINE_ALPHATEST]="ALPHATEST";$s.__super.call(this,$c,$d,$e,null,{}),this._attributeMap=$f;var $i;for($i in $g){var $j=$g[$i];switch($j[1]){case 0:this._renderElementUniformMap[$i]=$j[0];break;case 1:this._materialUniformMap[$i]=$j[0];break;case 2:this._spriteUniformMap[$i]=$j[0];break;case 3:this._cameraUniformMap[$i]=$j[0];break;case 4:this._sceneUniformMap[$i]=$j[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}$p($s,"laya.d3.shader.ShaderCompile3D",$v);var $d=$s.prototype;return $d._definesToNameDic=function($c,$d){for(var $e={},$f=1,$g=0;$g<32&&!($c<($f=1<<$g));$g++)if($c&$f){var $h=$d[$f];$h&&($e[$h]="")}return $e},$d.withCompile=function($c,$d,$e,$f){var $g,$h,$i;if($h=this.sharders[$c])if($i=$h[$d]){if($g=$i[$e])return $g}else $i=$h[$d]=[];else $i=($h=this.sharders[$c]=[])[$d]=[];var $j,$k=this._definesToNameDic($c,$s._globalInt2name),$l=this._definesToNameDic($d,this._spriteInt2name),$m=this._definesToNameDic($e,this._materialInt2name),$n={},$o="";if($k)for($j in $k)$o+="#define "+$j+"\n",$n[$j]=!0;if($l)for($j in $l)$o+="#define "+$j+"\n",$n[$j]=!0;if($m)for($j in $m)$o+="#define "+$j+"\n",$n[$j]=!0;var $p=$Ld.nameKey.getName(this._name)+" compile ("+$c+","+$d+","+$e+")",$q=this._VS.toscript($n,[]),$r=this._PS.toscript($n,[]);$H.now();if($g=$Ld.create($o+$q.join("\n"),$o+$r.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,$f,$p),$i[$e]=$g,laya.d3.shader.ShaderCompile3D.debugMode)$H.now();return $g},$d.precompileShaderWithShaderDefine=function($c,$d,$e){this.withCompile($c,$d,$e,!0)},$d.addMaterialDefines=function($c){var $d=$c.defines;for(var $e in $d){var $f=$d[$e],$g=parseInt($e);this._materialInt2name[$g]=$f,this._materialName2Int[$f]=$g}},$d.addSpriteDefines=function($c){var $d=$c.defines;for(var $e in $d){var $f=$d[$e],$g=parseInt($e);this._spriteInt2name[$g]=$f,this._spriteName2Int[$f]=$g}},$d.getMaterialDefineByName=function($c){return this._materialName2Int[$c]},$d.registerMaterialDefine=function($c){var $d=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[$d]=$c,this._materialName2Int[$c]=$d},$d.registerSpriteDefine=function($c){var $d=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[$d]=$c,this._spriteName2Int[$c]=$d},$s._globalRegDefine=function($c,$d){$s._globalInt2name[$d]=$c},$s.add=function($c,$d,$e,$f,$g){return laya.d3.shader.ShaderCompile3D._preCompileShader[$c]=new $s($c,$d,$e,$f,$g,$v.includes)},$s.get=function($c){return laya.d3.shader.ShaderCompile3D._preCompileShader[$Ld.nameKey.getID($c)]},$s._preCompileShader={},$s._globalInt2name=[],$s.debugMode=!1,$s.SHADERDEFINE_HIGHPRECISION=1,$s.SHADERDEFINE_FOG=4,$s.SHADERDEFINE_DIRECTIONLIGHT=8,$s.SHADERDEFINE_POINTLIGHT=16,$s.SHADERDEFINE_SPOTLIGHT=32,$s.SHADERDEFINE_UV0=64,$s.SHADERDEFINE_COLOR=128,$s.SHADERDEFINE_UV1=256,$s.SAHDERDEFINE_DEPTHFOG=131072,$s}(),$Bd=function($c){function $q(){$q.__super.call(this)}$p($q,"laya.d3.graphics.MeshSprite3DStaticBatchManager",$fc);var $d=$q.prototype;return $d._getStaticBatch=function($c,$d,$e,$f){var $g,$h;return $h=$c?$c.id.toString()+$e.id.toString()+$d.id.toString()+$f.toString():$e.id.toString()+$d.id.toString()+$f.toString(),this._staticBatches[$h]?$g=this._staticBatches[$h]:this._staticBatches[$h]=$g=new $Cd($h,this,$c,$d,$e),$g},$d._initStaticBatchs=function($c){var $d,$e;this._initBatchRenderElements.sort($q._sortPrepareStaticBatch);for(var $f,$g=!1,$h=0,$i=0,$j=this._initBatchRenderElements.length;$i<$j;$i++){var $k,$l=this._initBatchRenderElements[$i],$m=$l.renderObj._getVertexBuffer(0);$l._sprite3D;if($e===$m.vertexDeclaration&&$d===$l._material)if($g)$f._addCombineBatchRenderObjTest($l)?($k=$l._staticBatch)!==$f&&($k&&$k._deleteCombineBatchRenderObj($l),$f._addCombineBatchRenderObj($l)):($g=!1,$h++);else{var $n=this._initBatchRenderElements[$i-1],$o=$n.renderObj,$p=$l.renderObj;$g=!(65535<$o._getVertexBuffer().vertexCount+$p._getVertexBuffer().vertexCount)&&($f=this._getStaticBatch($c,$e,$d,$h),($k=$n._staticBatch)!==$f&&($k&&$k._deleteCombineBatchRenderObj($n),$f._addCombineBatchRenderObj($n)),($k=$l._staticBatch)!==$f&&($k&&$k._deleteCombineBatchRenderObj($l),$f._addCombineBatchRenderObj($l)),!0)}else $g=!1,$h=0;$d=$l._material,$e=$m.vertexDeclaration}},$q._sortPrepareStaticBatch=function($c,$d){var $e=$c._render,$f=$d._render,$g=$e.lightmapIndex-$f.lightmapIndex;if(0!=$g)return $g;var $h=$e.receiveShadow-$f.receiveShadow;if(0!=$h)return $h;var $i=$c._mainSortID-$d._mainSortID;return 0==$i?$c.renderObj.triangleCount-$d.renderObj.triangleCount:$i},$q}(),$Cd=function($c){function $h($c,$d,$e,$f,$g){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,$h.__super.call(this,$c,$d,$e),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=$f,this._material=$g}$p($h,"laya.d3.graphics.SubMeshStaticBatch",$gc);var $d=$h.prototype;return $d._compareBatchRenderElement=function($c,$d){return $c._batchIndexStart>$d._batchIndexStart},$d._addCombineBatchRenderObjTest=function($c){var $d=$c.renderObj._vertexCount;return!(65535<(0<$d?this._currentCombineVertexCount+$d:this._currentCombineVertexCount+$c.renderObj._getVertexBuffer().vertexCount))},$d._addCombineBatchRenderObj=function($c){var $d=$c.renderObj,$e=$d._vertexCount;this._initBatchRenderElements.push($c),$c._staticBatch=this,0<$e?(this._currentCombineIndexCount+=$d._indexCount,this._currentCombineVertexCount+=$e):(this._currentCombineIndexCount=this._currentCombineIndexCount+$d._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$d._getVertexBuffer().vertexCount),this._needFinishCombine=!0},$d._deleteCombineBatchRenderObj=function($c){var $d=$c.renderObj,$e=this._initBatchRenderElements.indexOf($c);if(-1!==$e){this._initBatchRenderElements.splice($e,1),$c._staticBatch=null;var $f=$d._vertexCount;0<$f?(this._currentCombineIndexCount=this._currentCombineIndexCount-$d._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$f):(this._currentCombineIndexCount=this._currentCombineIndexCount-$d._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$d._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},$d._finishInit=function(){if(this._needFinishCombine){var $c=0,$d=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var $e=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),$f=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=$Od.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=$Nd.create("ushort",this._currentCombineIndexCount,35044);for(var $g=0,$h=this._initBatchRenderElements.length;$g<$h;$g++){var $i=this._initBatchRenderElements[$g],$j=$i.renderObj,$k=$j._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,$i._sprite3D),$l=$j.getIndices(),$m=$i._sprite3D.transform._isFrontFaceInvert,$n=$c/(this._vertexDeclaration.vertexStride/4)-$j._vertexStart,$o=$d,$p=$o+$l.length;$i._batchIndexStart=$o,$i._batchIndexEnd=$p,$f.set($l,$d);var $q=0;if($m)for($q=$o;$q<$p;$q+=3){$f[$q]=$n+$f[$q];var $r=$f[$q+1],$s=$f[$q+2];$f[$q+1]=$n+$s,$f[$q+2]=$n+$r}else for($q=$o;$q<$p;$q+=3)$f[$q]=$n+$f[$q],$f[$q+1]=$n+$f[$q+1],$f[$q+2]=$n+$f[$q+2];$d+=$l.length,$e.set($k,$c),$c+=$k.length}this._vertexBuffer.setData($e),this._indexBuffer.setData($f),this._needFinishCombine=!1}},$d._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new $zd)},$d._getRenderElement=function($c,$d,$e){for(var $f,$g,$h=this._batchRenderElements.length,$i=!0,$j=0;$j<$h;$j++){var $k,$l,$m=($g=this._batchRenderElements[$j])._sprite3D._render;if(0!==$j&&($i=($k=($f=this._batchRenderElements[$j-1])._sprite3D._render).lightmapIndex!==$m.lightmapIndex||$k.receiveShadow!==$m.receiveShadow||$f._batchIndexEnd!==$g._batchIndexStart),$i){($l=this._getCombineRenderElementFromPool()).renderObj=this,$l._material=this._material,$l._batchIndexStart=$g._batchIndexStart,$l._batchIndexEnd=$g._batchIndexEnd;var $n=$m.lightmapIndex,$o=$n+1,$p=this._batchOwnerIndices[$o];$p||($p=this._batchOwnerIndices[$o]=[]);var $q,$r=$p[$g._render.receiveShadow?1:0];void 0===$r?($p[$m.receiveShadow?1:0]=this._batchOwners.length,($q=new $Xd(null,"StaticBatchMeshSprite3D"))._scene=$d,$q._transform=this._rootOwner?this._rootOwner._transform:null,$q._render.lightmapIndex=$n,$q._render.receiveShadow=$g._render.receiveShadow,this._batchOwners.push($q)):$q=this._batchOwners[$r],$q._render._renderUpdate($e),$l._sprite3D=$q,$c.push($l)}else $l._batchIndexEnd=$g._batchIndexEnd}},$d._beforeRender=function($c){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$d._render=function($c){var $d=$c.renderElement,$e=$d._batchIndexStart,$f=$d._batchIndexEnd-$e;$F.mainContext.drawElements(4,$f,5123,2*$e),$A.drawCall++,$A.trianglesFaces+=$f/3},$d.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},$d._getVertexBuffer=function($c){return void 0===$c&&($c=0),this._vertexBuffer},$h}(),$Dd=function($c){function $d(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,$d.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}$p($d,"laya.d3.core.ComponentNode",$l);var $e=$d.prototype;return $e.addComponent=function($c){var $d,$e=this._componentsMap.indexOf($c);if(-1===$e)$d=[],this._componentsMap.push($c),this._typeComponentsIndices.push($d);else if($d=this._typeComponentsIndices[$e],this._components[$d[0]].isSingleton)throw new Error("无法单实例创建"+$c+"组件，"+$c+"组件已存在！");var $f=$g.getInstance($c);return $d.push(this._components.length),this._components.push($f),$f instanceof laya.d3.component.Script&&this._scripts.push($f),$f._initialize(this),$f},$e._removeComponent=function($c,$d){var $e=this._typeComponentsIndices[$c],$f=$e[$d],$g=this._components[$f];this._components.splice($f,1),$g instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($g),1),$e.splice($d,1),0===$e.length&&(this._typeComponentsIndices.splice($c,1),this._componentsMap.splice($c,1));for(var $h=0,$i=this._componentsMap.length;$h<$i;$h++)for(var $j=($e=this._typeComponentsIndices[$h]).length-1;0<=$j;$j--){var $k=$e[$j];if(!($f<$k))break;$e[$j]=--$k}$g._destroy()},$e.getComponentByType=function($c,$d){void 0===$d&&($d=0);var $e=this._componentsMap.indexOf($c);return-1===$e?null:this._components[this._typeComponentsIndices[$e][$d]]},$e.getComponentsByType=function($c,$d){var $e=this._componentsMap.indexOf($c);if(-1!==$e){var $f=this._typeComponentsIndices[$e],$g=$f.length;$d.length=$g;for(var $h=0;$h<$g;$h++)$d[$h]=this._components[$f[$h]]}else $d.length=0},$e.getComponentByIndex=function($c){return this._components[$c]},$e.removeComponentByType=function($c,$d){void 0===$d&&($d=0);var $e=this._componentsMap.indexOf($c);-1!==$e&&this._removeComponent($e,$d)},$e.removeComponentsByType=function($c){var $d=this._componentsMap.indexOf($c);if(-1!==$d)for(var $e=this._typeComponentsIndices[$d],$f=0,$g=$e.length;$f<$g;$e.length<$g?$g--:$f++)this._removeComponent($d,$f)},$e.removeAllComponent=function(){for(var $c=0,$d=this._componentsMap.length;$c<$d;this._componentsMap.length<$d?$d--:$c++)this.removeComponentsByType(this._componentsMap[$c])},$e._updateComponents=function($c){for(var $d=0,$e=this._components.length;$d<$e;$d++){var $f=this._components[$d];!$f.started&&($f._start($c),$f.started=!0),$f.enable&&$f._update($c)}},$e._lateUpdateComponents=function($c){for(var $d=0;$d<this._components.length;$d++){var $e=this._components[$d];!$e.started&&($e._start($c),$e.started=!0),$e.enable&&$e._lateUpdate($c)}},$e._preRenderUpdateComponents=function($c){for(var $d=0;$d<this._components.length;$d++){var $e=this._components[$d];!$e.started&&($e._start($c),$e.started=!0),$e.enable&&$e._preRenderUpdate($c)}},$e._postRenderUpdateComponents=function($c){for(var $d=0;$d<this._components.length;$d++){var $e=this._components[$d];!$e.started&&($e._start($c),$e.started=!0),$e.enable&&$e._postRenderUpdate($c)}},$d}(),$Ed=function($f){function $c(){$c.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new $od,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new $jd(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}$p($c,"laya.d3.core.material.BaseMaterial",$f);var $d=$c.prototype;return $x.imps($d,{"laya.d3.core.IClone":!0}),$d._addShaderDefine=function($c){this._shaderDefineValue|=$c},$d._removeShaderDefine=function($c){this._shaderDefineValue&=~$c},$d._addDisablePublicShaderDefine=function($c){this._disablePublicShaderDefine|=$c},$d._removeDisablePublicShaderDefine=function($c){this._disablePublicShaderDefine&=~$c},$d._setBuffer=function($c,$d){this._shaderValues.setValue($c,$d),this._values[$c]=$d},$d._getBuffer=function($c){return this._values[$c]},$d._setMatrix4x4=function($c,$d){this._shaderValues.setValue($c,$d?$d.elements:null),this._values[$c]=$d},$d._getMatrix4x4=function($c){return this._values[$c]},$d._setInt=function($c,$d){this._shaderValues.setValue($c,$d),this._values[$c]=$d},$d._getInt=function($c){return this._values[$c]},$d._setNumber=function($c,$d){this._shaderValues.setValue($c,$d),this._values[$c]=$d},$d._getNumber=function($c){return this._values[$c]},$d._setBool=function($c,$d){this._shaderValues.setValue($c,$d),this._values[$c]=$d},$d._getBool=function($c){return this._values[$c]},$d._setVector2=function($c,$d){this._shaderValues.setValue($c,$d?$d.elements:null),this._values[$c]=$d},$d._getVector2=function($c){return this._values[$c]},$d._setColor=function($c,$d){this._shaderValues.setValue($c,$d?$d.elements:null),this._values[$c]=$d},$d._getColor=function($c){return this._values[$c]},$d._setTexture=function($c,$d){var $e=this._values[$c];this._values[$c]=$d,this._shaderValues.setValue($c,$d),0<this.referenceCount&&($e&&$e._removeReference(),$d&&$d._addReference())},$d._getTexture=function($c){return this._values[$c]},$d._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},$d._getShader=function($c,$d,$e){var $f=($c|$d)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile($f,$e,this._shaderDefineValue),this._shader},$d._setRenderStateBlendDepth=function(){var $c=$F.mainContext;switch($G.setDepthMask($c,this.depthWrite),0===this.depthTest?$G.setDepthTest($c,!1):($G.setDepthTest($c,!0),$G.setDepthFunc($c,this.depthTest)),this.blend){case 0:$G.setBlend($c,!1);break;case 1:$G.setBlend($c,!0),$G.setBlendFunc($c,this.srcBlend,this.dstBlend);break;case 2:$G.setBlend($c,!0)}},$d._setRenderStateFrontFace=function($c,$d){var $e=$F.mainContext,$f=0;switch(this.cull){case 0:$G.setCullFace($e,!1);break;case 1:$G.setCullFace($e,!0),$f=$c?$d&&$d._isFrontFaceInvert?2305:2304:$d&&$d._isFrontFaceInvert?2304:2305,$G.setFrontFace($e,$f);break;case 2:$G.setCullFace($e,!0),$f=$c?$d&&$d._isFrontFaceInvert?2304:2305:$d&&$d._isFrontFaceInvert?2305:2304,$G.setFrontFace($e,$f)}},$d.onAsynLoaded=function($c,$d,$e){var $f=$d[0],$g=$d[1];switch($f.version){case"LAYAMATERIAL:01":var $h=0,$i=0,$j=$f.props;for(var $k in $j)switch($k){case"vectors":var $l=$j[$k];for($h=0,$i=$l.length;$h<$i;$h++){var $m=$l[$h],$n=$m.value;switch($n.length){case 2:this[$m.name]=new $hd($n[0],$n[1]);break;case 3:this[$m.name]=new $id($n[0],$n[1],$n[2]);break;case 4:this[$m.name]=new $jd($n[0],$n[1],$n[2],$n[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var $o=$j[$k];for($h=0,$i=$o.length;$h<$i;$h++){var $p=$o[$h],$q=$p.path;$q&&(this[$p.name]=$t.getRes($g[$q]))}break;case"defines":var $r=$j[$k];for($h=0,$i=$r.length;$h<$i;$h++){var $s=this._shaderCompile.getMaterialDefineByName($r[$h]);this._addShaderDefine($s)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[$k]=$j[$k];break;case"renderQueue":switch($j[$k]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[$k]=$j[$k]}break;case"LAYAMATERIAL:02":for($k in $j=$f.props)switch($k){case"vectors":for($h=0,$i=($l=$j[$k]).length;$h<$i;$h++)switch(($n=($m=$l[$h]).value).length){case 2:this[$m.name]=new $hd($n[0],$n[1]);break;case 3:this[$m.name]=new $id($n[0],$n[1],$n[2]);break;case 4:this[$m.name]=new $jd($n[0],$n[1],$n[2],$n[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for($h=0,$i=($o=$j[$k]).length;$h<$i;$h++)($q=($p=$o[$h]).path)&&(this[$p.name]=$t.getRes($g[$q]));break;case"defines":for($h=0,$i=($r=$j[$k]).length;$h<$i;$h++)$s=this._shaderCompile.getMaterialDefineByName($r[$h]),this._addShaderDefine($s);break;default:this[$k]=$j[$k]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},$d._addReference=function(){$f.prototype._addReference.call(this);for(var $c=0,$d=this._values.length;$c<$d;$c++){var $e=this._values[$c];$e&&$e instanceof laya.d3.resource.BaseTexture&&$e._addReference()}},$d._removeReference=function(){$f.prototype._removeReference.call(this);for(var $c=0,$d=this._values.length;$c<$d;$c++){var $e=this._values[$c];$e&&$e instanceof laya.d3.resource.BaseTexture&&$e._removeReference()}},$d.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},$d.setShaderName=function($c){var $d=$Ld.nameKey.getID($c);if(-1===$d)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=$Ad._preCompileShader[$d]},$d.cloneTo=function($c){var $d=$c;$d.name=this.name,$d.cull=this.cull,$d.blend=this.blend,$d.srcBlend=this.srcBlend,$d.dstBlend=this.dstBlend,$d.srcBlendRGB=this.srcBlendRGB,$d.dstBlendRGB=this.dstBlendRGB,$d.srcBlendAlpha=this.srcBlendAlpha,$d.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo($d.blendConstColor),$d.blendEquation=this.blendEquation,$d.blendEquationRGB=this.blendEquationRGB,$d.blendEquationAlpha=this.blendEquationAlpha,$d.depthTest=this.depthTest,$d.depthWrite=this.depthWrite,$d.renderQueue=this.renderQueue,$d._shader=this._shader,$d._disablePublicShaderDefine=this._disablePublicShaderDefine,$d._shaderDefineValue=this._shaderDefineValue;var $e,$f=0,$g=$d._shaderValues;$d._shaderValues.data.length=this._shaderValues.data.length;var $h=this._values.length,$i=$d._values;for($f=0,$e=$i.length=$h;$f<$e;$f++){var $j=this._values[$f];if($j)if("number"==typeof $j)$i[$f]=$j,$g.data[$f]=$j;else if("number"==typeof $j&&Math.floor($j)==$j)$i[$f]=$j,$g.data[$f]=$j;else if("boolean"==typeof $j)$i[$f]=$j,$g.data[$f]=$j;else if($j instanceof laya.d3.math.Vector2){var $k=$i[$f]||($i[$f]=new $hd);$j.cloneTo($k),$g.data[$f]=$k.elements}else if($j instanceof laya.d3.math.Vector3){var $l=$i[$f]||($i[$f]=new $id);$j.cloneTo($l),$g.data[$f]=$l.elements}else if($j instanceof laya.d3.math.Vector4){var $m=$i[$f]||($i[$f]=new $jd);$j.cloneTo($m),$g.data[$f]=$m.elements}else if($j instanceof laya.d3.math.Matrix4x4){var $n=$i[$f]||($i[$f]=new $cd);$j.cloneTo($n),$g.data[$f]=$n.elements}else $j instanceof laya.d3.resource.BaseTexture&&($i[$f]=$j,$g.data[$f]=$j)}},$d.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$q(0,$d,"alphaTestValue",function(){return this._getNumber(0)},function($c){this._setNumber(0,$c)}),$q(0,$d,"alphaTest",function(){return this._alphaTest},function($c){(this._alphaTest=$c)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),$c.__init__=function(){$c.SHADERDEFINE_ALPHATEST=$c.shaderDefines.registerDefine("ALPHATEST")},$c.RENDERQUEUE_OPAQUE=2e3,$c.RENDERQUEUE_ALPHATEST=2450,$c.RENDERQUEUE_TRANSPARENT=3e3,$c.CULL_NONE=0,$c.CULL_FRONT=1,$c.CULL_BACK=2,$c.BLEND_DISABLE=0,$c.BLEND_ENABLE_ALL=1,$c.BLEND_ENABLE_SEPERATE=2,$c.BLENDPARAM_ZERO=0,$c.BLENDPARAM_ONE=1,$c.BLENDPARAM_SRC_COLOR=768,$c.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,$c.BLENDPARAM_DST_COLOR=774,$c.BLENDPARAM_ONE_MINUS_DST_COLOR=775,$c.BLENDPARAM_SRC_ALPHA=770,$c.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,$c.BLENDPARAM_DST_ALPHA=772,$c.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,$c.BLENDPARAM_SRC_ALPHA_SATURATE=776,$c.BLENDEQUATION_ADD=0,$c.BLENDEQUATION_SUBTRACT=1,$c.BLENDEQUATION_REVERSE_SUBTRACT=2,$c.DEPTHTEST_OFF=0,$c.DEPTHTEST_NEVER=512,$c.DEPTHTEST_LESS=513,$c.DEPTHTEST_EQUAL=514,$c.DEPTHTEST_LEQUAL=515,$c.DEPTHTEST_GREATER=516,$c.DEPTHTEST_NOTEQUAL=517,$c.DEPTHTEST_GEQUAL=518,$c.DEPTHTEST_ALWAYS=519,$c.SHADERDEFINE_ALPHATEST=1,$c.ALPHATESTVALUE=0,$n($c,["shaderDefines",function(){return this.shaderDefines=new $md}]),$c}($s),$Fd=function($c){function $d(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,$d.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}$p($d,"laya.d3.resource.BaseTexture",$s);var $e=$d.prototype;return $q(0,$e,"width",function(){return this._width}),$q(0,$e,"repeat",function(){return this._repeat},function($c){if(this._repeat!==$c&&(this._repeat=$c,this._source)){var $d=$F.mainContext;$G.bindTexture($d,this._type,this._source),$w.isPOT(this._width,this._height)&&this._repeat?($d.texParameteri(this._type,10242,10497),$d.texParameteri(this._type,10243,10497)):($d.texParameteri(this._type,10242,33071),$d.texParameteri(this._type,10243,33071))}}),$q(0,$e,"height",function(){return this._height}),$q(0,$e,"magFifter",function(){return this._magFifter},function($c){(this._magFifter=$c)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter($c)}),$q(0,$e,"wrapModeV",function(){return this._wrapModeV}),$q(0,$e,"size",function(){return this._size}),$q(0,$e,"wrapModeU",function(){return this._wrapModeU}),$q(0,$e,"mipmap",function(){return this._mipmap},function($c){this._mipmap=$c,this._mipmap!=$c&&this._conchTexture&&this._conchTexture.setMipMap($c)}),$q(0,$e,"minFifter",function(){return this._minFifter},function($c){this._minFifter=$c,this._minFifter!=$c&&this._conchTexture&&this._conchTexture.setMinFifter($c)}),$q(0,$e,"format",function(){return this._format}),$q(0,$e,"source",function(){return this.activeResource(),this._source}),$q(0,$e,"defaulteTexture",function(){return $Sd.grayTexture}),$d.WARPMODE_REPEAT=0,$d.WARPMODE_CLAMP=1,$d}(),$Gd=function($c){function $d(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,$d.__super.call(this),this._boundingBoxCorners=$f(8,null)}$p($d,"laya.d3.resource.models.BaseMesh",$s);var $e=$d.prototype;return $e._getPositions=function(){throw new Error("未Override,请重载该属性！")},$e._generateBoundingObject=function(){this._boundingSphere=new $_c(new $id,0),$_c.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new $Zc(new $id,new $id),$Zc.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},$e.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},$e.getRenderElement=function($c){throw new Error("未Override,请重载该属性！")},$q(0,$e,"subMeshCount",function(){return this._subMeshCount}),$q(0,$e,"boundingBox",function(){return this._boundingBox}),$q(0,$e,"boundingBoxCorners",function(){return this._boundingBoxCorners}),$q(0,$e,"boundingSphere",function(){return this._boundingSphere}),$d}(),$Hd=(function($c){function $d(){$d.__super.call(this)}$p($d,"laya.d3.component.Script",$vd);var $e=$d.prototype;$e.onTriggerEnter=function($c){},$e.onTriggerExit=function($c){},$e.onTriggerStay=function($c){},$q(0,$e,"isSingleton",function(){return $d._isSingleton}),$d._isSingleton=!1}(),function($c){function $d($c){this._owner=null,this._sharedMesh=null,$d.__super.call(this),this._owner=$c}$p($d,"laya.d3.core.MeshFilter",$c);var $e=$d.prototype;return $e._sharedMeshLoaded=function(){this.event("loaded")},$e._destroy=function(){$c.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},$q(0,$e,"sharedMesh",function(){return this._sharedMesh},function($c){var $d=this._sharedMesh;$d&&$d._removeReference(),(this._sharedMesh=$c)._addReference(),this.event("meshchanged",[this,$d,$c]),$c.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),$q(0,$e,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),$q(0,$e,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),$q(0,$e,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),$q(0,$e,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),$d}($wd)),$Id=function($c){function $d($c){$d.__super.call(this,$c),$c.meshFilter.on("meshchanged",this,this._onMeshChanged)}$p($d,"laya.d3.core.MeshRender",$xd);var $e=$d.prototype;return $e._onMeshChanged=function($c,$d,$e){$e.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:$e.once("loaded",this,this._onMeshLoaed)},$e._onMeshLoaed=function($c,$d){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},$e._calculateBoundingSphereByInitSphere=function($c){var $d=NaN,$e=this._owner.transform,$f=$e.scale.elements,$g=Math.abs($f[0]),$h=Math.abs($f[1]),$i=Math.abs($f[2]);$d=$h<=$g&&$i<=$g?$g:$i<=$h?$h:$i,$id.transformCoordinate($c.center,$e.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=$c.radius*$d},$e._calculateBoundBoxByInitCorners=function($c){for(var $d=this._owner.transform.worldMatrix,$e=0;$e<8;$e++)$id.transformCoordinate($c[$e],$d,$xd._tempBoundBoxCorners[$e]);$Zc.createfromPoints($xd._tempBoundBoxCorners,this._boundingBox)},$e._calculateBoundingSphere=function(){var $c=this._owner.meshFilter.sharedMesh;null==$c||null==$c.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere($c.boundingSphere)},$e._calculateBoundingBox=function(){var $c=this._owner.meshFilter.sharedMesh;null==$c||null==$c.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners($c.boundingBoxCorners)},$e._renderUpdate=function($c){var $d=this._owner.transform;if($d){this._setShaderValueMatrix4x4(0,$d.worldMatrix);var $e=this._owner.getProjectionViewWorldMatrix($c);this._setShaderValueMatrix4x4(1,$e)}else this._setShaderValueMatrix4x4(0,$cd.DEFAULT),this._setShaderValueMatrix4x4(1,$c);return $td.debugMode&&this._renderRenderableBoundBox(),!0},$d}(),$Jd=function($d){function $f(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,$f.__super.call(this),this._renderState=new $Y,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new $od,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new $dc,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new $id(.7,.7,.7),this.ambientColor=new $id(.212,.227,.259),$F.shaderHighPrecision&&this.addShaderDefine($Ad.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}$p($f,"laya.d3.core.scene.Scene",$d);var $c=$f.prototype;return $x.imps($c,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),$c._setUrl=function($c){this._url=$c},$c._getGroup=function(){return this._group},$c._setGroup=function($c){this._group=$c},$c._display=function(){$x.stage._scenes.push(this),$x.stage._scenes.sort($f._sortScenes);for(var $c=0,$d=this._childs.length;$c<$d;$c++){var $e=this._childs[$c];$e.active&&$e._activeHierarchy()}},$c._unDisplay=function(){var $c=$x.stage._scenes;$c.splice($c.indexOf(this),1);for(var $d=0,$e=this._childs.length;$d<$e;$d++){var $f=this._childs[$d];$f.active&&$f._inActiveHierarchy()}},$c._addChild3D=function($c){$c.transform._onWorldTransform(),$c._setBelongScene(this),this.displayedInStage&&$c.active&&$c._activeHierarchy()},$c._removeChild3D=function($c){$c.transform.parent=null,this.displayedInStage&&$c.active&&$c._inActiveHierarchy(),$c._setUnBelongScene()},$c.initOctree=function($c,$d,$e,$f,$g){void 0===$g&&($g=6),this.treeSize=new $id($c,$d,$e),this.treeLevel=$g,this.treeRoot=new $Z(this,0),this.treeRoot.init($f,this.treeSize)},$c._prepareUpdateToRenderState=function($c,$d){$d.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,$d.scene=this},$c._prepareSceneToRender=function($c){var $d=this._lights.length;if(0<$d)for(var $e=0,$f=0;$f<$d&&!(this._lights[$f]._prepareToScene($c)&&++$e>=this._enableLightCount);$f++);},$c._updateChilds=function($c){for(var $d=0,$e=this._childs.length;$d<$e;++$d)this._childs[$d]._update($c)},$c._preRenderScene=function($c,$d,$e){var $f,$g=$d._viewMatrix,$h=$d._projectionMatrix,$i=$d._projectionViewMatrix,$j=0,$k=$d.camera;for($k.useOcclusionCulling?this.treeRoot?$ec.renderObjectCullingOctree($e,this,$k,$g,$h,$i):$ec.renderObjectCulling($e,this,$k,$g,$h,$i):$ec.renderObjectCullingNoBoundFrustum(this,$k,$g,$h,$i),$j=0,$f=this._quenes.length;$j<$f;$j++)this._quenes[$j]&&this._quenes[$j]._preRender($d)},$c._clear=function($c,$d){var $e=$d._viewport,$f=$d.camera,$g=$e.x,$h=$f.renderTargetSize.height-$e.y-$e.height,$i=$e.width,$j=$e.height;$c.viewport($g,$h,$i,$j);var $k=256,$l=$f.renderTarget;switch($f.clearFlag){case 0:var $m=$f.clearColor;if($m){$c.enable(3089),$c.scissor($g,$h,$i,$j);var $n=$m.elements;$c.clearColor($n[0],$n[1],$n[2],$n[3]),$k|=16384}if($l)switch($m||($k=16384),$l.depthStencilFormat){case 33189:$k|=256;break;case 36168:$k|=1024;break;case 34041:$k|=256,$k|=1024}$c.clear($k),$m&&$c.disable(3089);break;case 1:case 2:if($l)switch($k=16384,$l.depthStencilFormat){case 33189:$k|=256;break;case 36168:$k|=1024;break;case 34041:$k|=256,$k|=1024}$c.clear($k);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},$c._renderScene=function($c,$d){var $e,$f,$g=$d.camera,$h=0;for($h=0;$h<2;$h++)($f=this._quenes[$h])&&($g.renderTarget?$f._render($d,!0):$f._render($d,!1));if(1===$g.clearFlag){var $i=$g.sky;$i&&($G.setCullFace($c,!1),$G.setDepthFunc($c,515),$G.setDepthMask($c,!1),$i._render($d),$G.setDepthFunc($c,513),$G.setDepthMask($c,!0))}for($h=2,$e=this._quenes.length;$h<$e;$h++)($f=this._quenes[$h])&&($f._sortAlpha($d.camera.transform.position),$g.renderTarget?$f._render($d,!0):$f._render($d,!1))},$c._set3DRenderConfig=function($c){$c.disable(3042),$G._blend=!1,$c.blendFunc(770,771),$G._sFactor=770,$G._dFactor=771,$c.disable(2929),$G._depthTest=!1,$c.enable(2884),$G._cullFace=!0,$c.depthMask(1),$G._depthMask=!0,$c.frontFace(2304),$G._frontFace=2304},$c._set2DRenderConfig=function($c){$G.setBlend($c,!0),$G.setBlendFunc($c,1,771),$G.setDepthTest($c,!1),$G.setCullFace($c,!1),$G.setDepthMask($c,!0),$G.setFrontFace($c,2305),$c.viewport(0,0,$m.width,$m.height)},$c._parseCustomProps=function($c,$d,$e,$f){var $g=$f.customProps.lightmaps,$h=$g.length,$i=this._lightmaps;$i.length=$h;for(var $j=0;$j<$h;$j++)$i[$j]=$t.getRes($d[$g[$j].replace(".exr",".png")]);this.setlightmaps($i);var $k=$f.customProps.ambientColor;$k&&(this.ambientColor=new $id($k[0],$k[1],$k[2]));var $l=$f.customProps.fogColor;$l&&(this.fogColor=new $id($l[0],$l[1],$l[2]))},$c._addLight=function($c){this._lights.indexOf($c)<0&&this._lights.push($c)},$c._removeLight=function($c){var $d=this._lights.indexOf($c);0<=$d&&this._lights.splice($d,1)},$c._updateScene=function(){var $c=this._renderState;this._prepareUpdateToRenderState($F.mainContext,$c),this._updateComponents($c),this._updateChilds($c),this._lateUpdateComponents($c),this._time+=$c.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},$c._updateSceneConch=function(){var $c=this._renderState;this._prepareUpdateToRenderState($F.mainContext,$c),this._updateComponents($c),this._lateUpdateComponents($c),this._prepareSceneToRender($c);for(var $d=0,$e=this._cameraPool.length;$d<$e;$d++){var $f=this._cameraPool[$d];($c.camera=$f)._prepareCameraToRender()}},$c._preRenderShadow=function($c,$d,$e,$f,$g){this.treeRoot?$ec.renderShadowObjectCullingOctree(this,$d,$e,$f,$g):$ec.renderShadowObjectCulling(this,$d,$e,$f,$g);for(var $h=0,$i=$e.length;$h<$i;$h++)$e[$h]&&$e[$h]._preRender($c)},$c._renderShadowMap=function($c,$d,$e){var $f=this.parallelSplitShadowMaps[0];$f._calcAllLightCameraInfo($e);var $g,$h,$i,$j=$f.PSSMNum;if(this._preRenderShadow($d,$f._lightCulling,$f._shadowQuenes,$f._lightVPMatrix[0],$j),this.addShaderDefine($pd.SHADERDEFINE_CAST_SHADOW),1<$j)for(var $k=0;$k<$j;$k++)$g=$f.getRenderTarget($k+1),$f.beginRenderTarget($k+1),$c.clearColor(1,1,1,1),$c.clear(16640),$c.viewport(0,0,$g.width,$g.height),$d.camera=$i=$f.getLightCamera($k),$i._prepareCameraToRender(),$i._prepareCameraViewProject($i.viewMatrix,$i.projectionMatrix),$d._projectionViewMatrix=$f._lightVPMatrix[$k+1],($h=$f._shadowQuenes[$k])._preRender($d),$h._renderShadow($d,!1),$f.endRenderTarget($k+1);else $g=$f.getRenderTarget(1),$f.beginRenderTarget(1),$c.clearColor(1,1,1,1),$c.clear(16640),$c.viewport(0,0,$g.width,$g.height),$d.camera=$i=$f.getLightCamera(0),$i._prepareCameraToRender(),$i._prepareCameraViewProject($i.viewMatrix,$i.projectionMatrix),$d._projectionViewMatrix=$f._lightVPMatrix[0],($h=$f._shadowQuenes[0])._preRender($d),$h._renderShadow($d,!0),$f.endRenderTarget(1);this.removeShaderDefine($pd.SHADERDEFINE_CAST_SHADOW)},$c.addTreeNode=function($c){this.treeRoot.addTreeNode($c)},$c.removeTreeNode=function($c){this.treeSize&&$c._treeNode&&$c._treeNode.removeObject($c)},$c.setlightmaps=function($c){this._lightmaps=$c;for(var $d=0,$e=this._renderableSprite3Ds.length;$d<$e;$d++)this._renderableSprite3Ds[$d]._render._applyLightMapParams()},$c.getlightmaps=function(){return this._lightmaps},$c.addChildAt=function($c,$d){if(!($c instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+($c&&$c.__className));if(!$c||this.destroyed||$c===this)return $c;if($c.zOrder&&this._set$P("hasZorder",!0),0<=$d&&$d<=this._childs.length){if($c._parent===this){var $e=this.getChildIndex($c);this._childs.splice($e,1),this._childs.splice($d,0,$c),this.conchModel&&(this.conchModel.removeChild($c.conchModel),this.conchModel.addChildAt($c.conchModel,$d)),this._childChanged()}else $c.parent&&$c.parent.removeChild($c),this._childs===$l.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($d,0,$c),this.conchModel&&this.conchModel.addChildAt($c.conchModel,$d),($c.parent=this)._addChild3D($c);return $c}throw new Error("appendChildAt:The index is out of bounds")},$c.addChild=function($c){if(!($c instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$c||this.destroyed||$c===this)return $c;if($c.zOrder&&this._set$P("hasZorder",!0),$c._parent===this){var $d=this.getChildIndex($c);$d!==this._childs.length-1&&(this._childs.splice($d,1),this._childs.push($c),this.conchModel&&(this.conchModel.removeChild($c.conchModel),this.conchModel.addChildAt($c.conchModel,this._childs.length-1)),this._childChanged())}else $c.parent&&$c.parent.removeChild($c),this._childs===$l.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($c),this.conchModel&&this.conchModel.addChildAt($c.conchModel,this._childs.length-1),($c.parent=this)._childChanged(),this._addChild3D($c);return $c},$c.removeChildAt=function($c){var $d=this.getChildAt($c);return $d&&(this._removeChild3D($d),this._childs.splice($c,1),this.conchModel&&this.conchModel.removeChild($d.conchModel),$d.parent=null),$d},$c.removeChildren=function($c,$d){if(void 0===$c&&($c=0),void 0===$d&&($d=2147483647),this._childs&&0<this._childs.length){var $e=this._childs;if(0===$c&&$h<=$d){var $f=$e;this._childs=$l.ARRAY_EMPTY}else $f=$e.splice($c,$d-$c);for(var $g=0,$h=$f.length;$g<$h;$g++)this._removeChild3D($f[$g]),$f[$g].parent=null,this.conchModel&&this.conchModel.removeChild($f[$g].conchModel)}return this},$c.addFrustumCullingObject=function($c){this.treeRoot?this.addTreeNode($c):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push($c):this._cullingRenders[this._cullingRendersLength]=$c,$c._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},$c.removeFrustumCullingObject=function($c){if(this.treeRoot)this.removeTreeNode($c);else{this._cullingRendersLength--;var $d=$c._indexInSceneFrustumCullingObjects;if($d!==this._cullingRendersLength){var $e=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[$d]=$e)._indexInSceneFrustumCullingObjects=$d,$c._indexInSceneFrustumCullingObjects=-1}}},$c.getRenderQueue=function($c){return $c<3e3?this._quenes[1]||(this._quenes[1]=new $X(this)):this._quenes[2]||(this._quenes[2]=new $X(this))},$c.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new $X(this)},$c.addShaderDefine=function($c){this._shaderDefineValue|=$c},$c.removeShaderDefine=function($c){this._shaderDefineValue&=~$c},$c.addScript=function($c){return this._addComponent($c)},$c.getScriptByType=function($c,$d){return void 0===$d&&($d=0),this._getComponentByType($c,$d)},$c.getScriptsByType=function($c,$d){this._getComponentsByType($c,$d)},$c.getScriptByIndex=function($c){return this._getComponentByIndex($c)},$c.removeScriptByType=function($c,$d){void 0===$d&&($d=0),this._removeComponentByType($c,$d)},$c.removeScriptsByType=function($c){this._removeComponentByType($c)},$c.removeAllScript=function(){this._removeAllComponent()},$c.render=function($c,$d,$e){($r._context.ctx._renderKey=0)<this._childs.length&&$c.addRenderObject(this)},$c.renderSubmit=function(){var $c=$F.mainContext,$d=this._renderState;this._set3DRenderConfig($c),this._prepareSceneToRender(this._renderState);var $e,$f=0,$g=0;if($td.debugMode||$Z.debugMode)for($f=0,$g=this._cameraPool.length;$f<$g;$f++)$e=this._cameraPool[$f],$td._debugPhasorSprite.begin(1,$e),$e.activeInHierarchy&&$e._renderCamera($c,$d,this),$td._debugPhasorSprite.end();else for($f=0,$g=this._cameraPool.length;$f<$g;$f++)($e=this._cameraPool[$f]).activeInHierarchy&&$e._renderCamera($c,$d,this);return this._set2DRenderConfig($c),1},$c.onAsynLoaded=function($c,$d,$e){var $f=$d[0];if("Scene"!==$f.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var $g=$d[1];$sd._createNodeByJson(this,$f,this,$g),this.event("hierarchyloaded",[this]),this.__loaded=!0},$c.destroy=function($c){void 0===$c&&($c=!0),this.destroyed||($d.prototype.destroy.call(this,$c),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,$t.clearRes(this.url),this.loaded||$td._cancelLoadByUrl(this.url))},$c.getRenderType=function(){return 0},$c.releaseRender=function(){},$c._addComponent=function($c){var $d,$e=this._componentsMap.indexOf($c);if(-1===$e)$d=[],this._componentsMap.push($c),this._typeComponentsIndices.push($d);else if($d=this._typeComponentsIndices[$e],this._components[$d[0]].isSingleton)throw new Error("无法单实例创建"+$c+"组件，"+$c+"组件已存在！");var $f=$g.getInstance($c);$d.push(this._components.length),this._components.push($f);return $f._initialize(this),$f},$c._removeComponent=function($c,$d){var $e=this._typeComponentsIndices[$c],$f=$e[$d],$g=this._components[$f];this._components.splice($f,1),$e.splice($d,1),0===$e.length&&(this._typeComponentsIndices.splice($c,1),this._componentsMap.splice($c,1));for(var $h=0,$i=this._componentsMap.length;$h<$i;$h++)for(var $j=($e=this._typeComponentsIndices[$h]).length-1;0<=$j;$j--){var $k=$e[$j];if(!($f<$k))break;$e[$j]=--$k}$g._destroy()},$c._getComponentByType=function($c,$d){void 0===$d&&($d=0);var $e=this._componentsMap.indexOf($c);return-1===$e?null:this._components[this._typeComponentsIndices[$e][$d]]},$c._getComponentsByType=function($c,$d){var $e=this._componentsMap.indexOf($c);if(-1!==$e){var $f=this._typeComponentsIndices[$e],$g=$f.length;$d.length=$g;for(var $h=0;$h<$g;$h++)$d[$h]=this._components[$f[$h]]}else $d.length=0},$c._getComponentByIndex=function($c){return this._components[$c]},$c._removeComponentByType=function($c,$d){void 0===$d&&($d=0);var $e=this._componentsMap.indexOf($c);-1!==$e&&this._removeComponent($e,$d)},$c._removeComponentsByType=function($c){var $d=this._componentsMap.indexOf($c);if(-1!==$d)for(var $e=this._typeComponentsIndices[$d],$f=0,$g=$e.length;$f<$g;$e.length<$g?$g--:$f++)this._removeComponent($d,$f)},$c._removeAllComponent=function(){for(var $c=0,$d=this._componentsMap.length;$c<$d;this._componentsMap.length<$d?$d--:$c++)this._removeComponentsByType(this._componentsMap[$c])},$c._updateComponents=function($c){for(var $d=0,$e=this._components.length;$d<$e;$d++){var $f=this._components[$d];!$f.started&&($f._start($c),$f.started=!0),$f.enable&&$f._update($c)}},$c._lateUpdateComponents=function($c){for(var $d=0;$d<this._components.length;$d++){var $e=this._components[$d];!$e.started&&($e._start($c),$e.started=!0),$e.enable&&$e._lateUpdate($c)}},$c._preRenderUpdateComponents=function($c){for(var $d=0;$d<this._components.length;$d++){var $e=this._components[$d];!$e.started&&($e._start($c),$e.started=!0),$e.enable&&$e._preRenderUpdate($c)}},$c._postRenderUpdateComponents=function($c){for(var $d=0;$d<this._components.length;$d++){var $e=this._components[$d];!$e.started&&($e._start($c),$e.started=!0),$e.enable&&$e._postRenderUpdate($c)}},$q(0,$c,"_loaded",null,function($c){this.__loaded=$c}),$q(0,$c,"fogColor",function(){return this._fogColor},function($c){this._fogColor=$c,this._shaderValues.setValue(0,$c.elements)}),$q(0,$c,"enableFog",function(){return this._enableFog},function($c){this._enableFog!==$c&&((this._enableFog=$c)?(this.addShaderDefine($Ad.SHADERDEFINE_FOG),this.removeShaderDefine($Ad.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine($Ad.SHADERDEFINE_FOG))}),$q(0,$c,"url",function(){return this._url}),$q(0,$c,"loaded",function(){return this.__loaded}),$q(0,$c,"enableDepthFog",function(){return this._enableDepthFog},function($c){this._enableDepthFog!=$c&&((this._enableDepthFog=$c)?(this.addShaderDefine($Ad.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine($Ad.SHADERDEFINE_FOG)):this.removeShaderDefine($Ad.SAHDERDEFINE_DEPTHFOG))}),$q(0,$c,"fogStart",function(){return this._fogStart},function($c){this._fogStart=$c,this._shaderValues.setValue(1,$c)}),$q(0,$c,"fogRange",function(){return this._fogRange},function($c){this._fogRange=$c,this._shaderValues.setValue(2,$c)}),$q(0,$c,"ambientColor",function(){return this._ambientColor},function($c){this._ambientColor=$c,this._shaderValues.setValue(21,$c.elements)}),$q(0,$c,"scene",function(){return this}),$q(0,$c,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),$f._sortScenes=function($c,$d){if($c.parent!==$x.stage||$d.parent!==$x.stage)return $c.parent!==$x.stage&&$d.parent!==$x.stage?$f._sortScenes($c.parent,$d.parent):$c.parent===$x.stage?-1:1;var $e=$x.stage._childs;return $e.indexOf($c)-$e.indexOf($d)},$f.load=function($c){return $x.loader.create($c,null,null,$f)},$f.FOGCOLOR=0,$f.FOGSTART=1,$f.FOGRANGE=2,$f.LIGHTDIRECTION=3,$f.LIGHTDIRCOLOR=4,$f.POINTLIGHTPOS=5,$f.POINTLIGHTRANGE=6,$f.POINTLIGHTATTENUATION=7,$f.POINTLIGHTCOLOR=8,$f.SPOTLIGHTPOS=9,$f.SPOTLIGHTDIRECTION=10,$f.SPOTLIGHTSPOT=11,$f.SPOTLIGHTRANGE=12,$f.SPOTLIGHTATTENUATION=13,$f.SPOTLIGHTCOLOR=14,$f.SHADOWDISTANCE=15,$f.SHADOWLIGHTVIEWPROJECT=16,$f.SHADOWMAPPCFOFFSET=17,$f.SHADOWMAPTEXTURE1=18,$f.SHADOWMAPTEXTURE2=19,$f.SHADOWMAPTEXTURE3=20,$f.AMBIENTCOLOR=21,$f.TIME=22,$f}($z),$Kd=function($c){function $d($c){$d.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new $cd,this._shaderValues=new $od,this._colliders=[],this._id=++$d._uniqueIDCounter,this._transform=new $yd(this),this.name=$c||"Sprite3D-"+$d._nameNumberCounter++,this.layer=$I.currentCreationLayer,this.active=!0}$p($d,"laya.d3.core.Sprite3D",$Dd);var $e=$d.prototype;return $x.imps($e,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),$e._setUrl=function($c){this._url=$c},$e._getGroup=function(){return this._group},$e._setGroup=function($c){this._group=$c},$e._addChild3D=function($c){$c.transform.parent=this.transform,this._hierarchyAnimator&&(!$c._hierarchyAnimator&&$c._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($c,!0,[$c.name])),this._scene&&($c._setBelongScene(this._scene),this._activeInHierarchy&&$c._active&&$c._activeHierarchy())},$e._removeChild3D=function($c){$c.transform.parent=null,this._scene&&(this._activeInHierarchy&&$c._active&&$c._inActiveHierarchy(),$c._setUnBelongScene()),this._hierarchyAnimator&&($c._hierarchyAnimator==this._hierarchyAnimator&&$c._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($c,!1,[$c.name]))},$e._parseBaseCustomProps=function($c){var $d=this.transform.localPosition;$c.translate?($d.fromArray($c.translate),$d.x*=100,$d.y*=100,$d.z*=100):$d.elements.fill(0),this.transform.localPosition=$d;var $e=this.transform.localRotation;$c.rotation?$e.fromArray($c.rotation):$e.fromArray([0,0,0,-1]),this.transform.localRotation=$e;var $f=this.transform.localScale;$c.scale?$f.fromArray($c.scale):$f.elements.fill(1),this.transform.localScale=$f;var $g=$c.layer;null!=$g&&(this.layer=$I.getLayerByNumber($g))},$e._parseCustomComponent=function($c,$d,$e){for(var $f in $e){var $g=$e[$f];switch($f){case"Animator":var $h=this.addComponent(Animator);if($g.avatarPath)$h.avatar=$t.getRes($d[$g.avatarPath]);else{var $i=$g.avatar;if($i){$h.avatar=$t.getRes($d[$i.path]);var $j=$i.linkSprites;$j&&$c.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[$h,$j])}}for(var $k=$g.clipPaths,$l=$k.length,$m=0;$m<$l;$m++)$h.addClip($t.getRes($d[$k[$m]]));$h.clip=$t.getRes($d[$k[0]]);var $n=$g.playOnWake;void 0!==$n&&($h.playOnWake=$n);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var $o=this.addComponent(SphereCollider);$o.isTrigger=$g.isTrigger;var $p=$o.center;$p.fromArray($g.center),$o.center=$p,$o.radius=$g.radius;break;case"BoxCollider":var $q=this.addComponent(BoxCollider);$q.isTrigger=$g.isTrigger,$q.center.fromArray($g.center);var $r=$q.size;$r.fromArray($g.size),$q.size=$r;break;case"MeshCollider":this.addComponent(MeshCollider)}}},$e._onRootNodeHierarchyLoaded=function($c,$d){for(var $e in $d){for(var $f=this,$g=$d[$e],$h=0,$i=$g.length;$h<$i;$h++){var $j=$g[$h];if(""===$j)break;if(!($f=$f.getChildByName($j)))break}$f&&$c.linkSprite3DToAvatarNode($e,$f)}},$e._setHierarchyAnimator=function($c,$d){this._changeHierarchyAnimator($c);for(var $e=0,$f=this._childs.length;$e<$f;$e++){var $g=this._childs[$e];$g._hierarchyAnimator==$d&&$g._setHierarchyAnimator($c,$d)}},$e._clearHierarchyAnimator=function($c,$d){this._changeHierarchyAnimator($d);for(var $e=0,$f=this._childs.length;$e<$f;$e++){var $g=this._childs[$e];$g._hierarchyAnimator==$c&&$g._clearHierarchyAnimator($c,$d)}},$e._getAnimatorToLinkSprite3D=function($c,$d,$e){var $f=this.getComponentByType(Animator);if($f&&($f.avatar?$f.avatar._version||$c._setAnimatorToLinkAvatar($f,$d):$c._setAnimatorToLinkSprite3DNoAvatar($f,$d,$e)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){$e.unshift(this._parent.name);var $g=this._parent;$g._hierarchyAnimator&&$g._getAnimatorToLinkSprite3D($c,$d,$e)}},$e._setAnimatorToLinkSprite3DNoAvatar=function($c,$d,$e){var $f=0,$g=0;for($f=0,$g=$c.getClipCount();$f<$g;$f++)$c._handleSpriteOwnersBySprite($f,$d,$e,this);for($f=0,$g=this._childs.length;$f<$g;$f++){var $h=this._childs[$f],$i=$e.length;$e.push($h.name),$h._setAnimatorToLinkSprite3DNoAvatar($c,$d,$e),$e.splice($i,1)}},$e._changeHierarchyAnimator=function($c){this._hierarchyAnimator=$c},$e._isLinkSpriteToAnimationNode=function($c,$d,$e){var $f=$c._avatarNodes.indexOf($d),$g=$c._cacheSpriteToNodesMap;if($e)this._transform.dummy=$d.transform,$c._cacheNodesToSpriteMap[$f]=$g.length,$g.push($f);else{this._transform.dummy=null;var $h=$c._cacheNodesToSpriteMap[$f];$c._cacheNodesToSpriteMap[$f]=null,$g.splice($h,1)}},$e._setBelongScene=function($c){this._scene=$c;for(var $d=0,$e=this._childs.length;$d<$e;$d++)this._childs[$d]._setBelongScene($c)},$e._setUnBelongScene=function(){this._scene=null;for(var $c=0,$d=this._childs.length;$c<$d;$c++)this._childs[$c]._setUnBelongScene()},$e._activeHierarchy=function(){var $c=0,$d=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),$c=0,$d=this._colliders.length;$c<$d;$c++)this._layer._addCollider(this._colliders[$c]);for(this.event("activeinhierarchychanged",!0),$c=0,$d=this._childs.length;$c<$d;$c++){var $e=this._childs[$c];$e._active&&$e._activeHierarchy()}},$e._inActiveHierarchy=function(){var $c=0,$d=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),$c=0,$d=this._colliders.length;$c<$d;$c++){var $e=this._colliders[$c];$e._clearCollsionMap(),this._layer._removeCollider($e)}for(this.event("activeinhierarchychanged",!1),$c=0,$d=this._childs.length;$c<$d;$c++){var $f=this._childs[$c];$f._active&&$f._inActiveHierarchy()}},$e.addComponent=function($c){var $d,$e=this._componentsMap.indexOf($c);if(-1===$e)$d=[],this._componentsMap.push($c),this._typeComponentsIndices.push($d);else if($d=this._typeComponentsIndices[$e],this._components[$d[0]].isSingleton)throw new Error("无法单实例创建"+$c+"组件，"+$c+"组件已存在！");var $f=$g.getInstance($c);return $d.push(this._components.length),this._components.push($f),$f instanceof laya.d3.component.Script&&this._scripts.push($f),$f._initialize(this),$f},$e._removeComponent=function($c,$d){var $e,$f=0,$g=this._typeComponentsIndices[$c],$h=$g[$d],$i=this._components[$h];for($i instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($i),1),$g.splice($d,1),0===$g.length&&(this._typeComponentsIndices.splice($c,1),this._componentsMap.splice($c,1)),$f=0,$e=this._componentsMap.length;$f<$e;$f++)for(var $j=($g=this._typeComponentsIndices[$f]).length-1;0<=$j;$j--){var $k=$g[$j];if(!($h<$k))break;$g[$j]=--$k}$i._destroy()},$e._clearSelfRenderObjects=function(){},$e._addSelfRenderObjects=function(){},$e._parseCustomProps=function($c,$d,$e,$f){},$e._updateChilds=function($c){var $d=this._childs.length;if(0!==$d)for(var $e=0;$e<$d;++$e)this._childs[$e]._update($c)},$e._getSortID=function($c,$d){return 1e3*$d.id+$c._getVertexBuffer().vertexDeclaration.id},$e._update=function($c){($c.owner=this)._activeInHierarchy&&(this._updateComponents($c),this._lateUpdateComponents($c),$A.spriteCount++,this._childs.length&&this._updateChilds($c))},$e.getProjectionViewWorldMatrix=function($c){return $cd.multiply($c,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},$e.loadHierarchy=function($c){this.addChild(laya.d3.core.Sprite3D.load($c))},$e.addChildAt=function($c,$d){if(!($c instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$c||this.destroyed||$c===this)return $c;if($c.zOrder&&this._set$P("hasZorder",!0),0<=$d&&$d<=this._childs.length){if($c._parent===this){var $e=this.getChildIndex($c);this._childs.splice($e,1),this._childs.splice($d,0,$c),this.conchModel&&(this.conchModel.removeChild($c.conchModel),this.conchModel.addChildAt($c.conchModel,$d)),this._childChanged()}else $c.parent&&$c.parent.removeChild($c),this._childs===$l.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($d,0,$c),this.conchModel&&this.conchModel.addChildAt($c.conchModel,$d),($c.parent=this)._addChild3D($c);return $c}throw new Error("appendChildAt:The index is out of bounds")},$e.addChild=function($c){if(!($c instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$c||this.destroyed||$c===this)return $c;if($c.zOrder&&this._set$P("hasZorder",!0),$c._parent===this){var $d=this.getChildIndex($c);$d!==this._childs.length-1&&(this._childs.splice($d,1),this._childs.push($c),this.conchModel&&(this.conchModel.removeChild($c.conchModel),this.conchModel.addChildAt($c.conchModel,this._childs.length-1)),this._childChanged())}else $c.parent&&$c.parent.removeChild($c),this._childs===$l.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($c),this.conchModel&&this.conchModel.addChildAt($c.conchModel,this._childs.length-1),($c.parent=this)._childChanged(),this._addChild3D($c);return $c},$e.removeChildAt=function($c){var $d=this.getChildAt($c);return $d&&(this._removeChild3D($d),this._childs.splice($c,1),this.conchModel&&this.conchModel.removeChild($d.conchModel),$d.parent=null),$d},$e.removeChildren=function($c,$d){if(void 0===$c&&($c=0),void 0===$d&&($d=2147483647),this._childs&&0<this._childs.length){var $e=this._childs;if(0===$c&&$h<=$d){var $f=$e;this._childs=$l.ARRAY_EMPTY}else $f=$e.splice($c,$d-$c);for(var $g=0,$h=$f.length;$g<$h;$g++)this._removeChild3D($f[$g]),$f[$g].parent=null,this.conchModel&&this.conchModel.removeChild($f[$g].conchModel)}return this},$e.onAsynLoaded=function($c,$d,$e){var $f=$d[0];if("Sprite3D"!==$f.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var $g=$d[1];$sd._createNodeByJson(this,$f,this,$g),this.event("hierarchyloaded",[this]),this.__loaded=!0},$e.cloneTo=function($c){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var $d=$c;$d.name=this.name,$d._destroyed=this._destroyed,$d.timer=this.timer,$d._$P=this._$P,$d.active=this._active;var $e=$d.transform.localPosition;this.transform.localPosition.cloneTo($e),$d.transform.localPosition=$e;var $f=$d.transform.localRotation;this.transform.localRotation.cloneTo($f),$d.transform.localRotation=$f;var $g=$d.transform.localScale;this.transform.localScale.cloneTo($g),$d.transform.localScale=$g,$d.isStatic=this.isStatic;var $h=0,$i=0;for($h=0,$i=this._componentsMap.length;$h<$i;$h++){var $j=$d.addComponent(this._componentsMap[$h]);this._components[$h]._cloneTo($j)}for($h=0,$i=this._childs.length;$h<$i;$h++)$d.addChild(this._childs[$h].clone());var $k=$d.getComponentByType(Animator);if($k){var $l=$k._linkSpritesData;if($l)for(var $m in $l){for(var $n=$l[$m],$o=$d,$p=0,$q=$n.length;$p<$q&&($o=$o.getChildByName($n[$p]));$p++);if($o){var $r=$k._avatarNodeMap[$m];$o._isLinkSpriteToAnimationNode($k,$r,!0)}}}},$e.clone=function(){var $c=new this.constructor;return this.cloneTo($c),$c},$e.destroy=function($c){if(void 0===$c&&($c=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,$c);var $d,$e=0;for($e=0,$d=this._components.length;$e<$d;$e++)this._components[$e]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,$t.clearRes(this.url),this.loaded||$td._cancelLoadByUrl(this.url)}},$e._handleSpriteToAvatar=function($c,$d){$c._avatarNodes;var $e=$c._avatarNodeMap[this.name];$e&&$e.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode($c,$e,$d)},$e._setAnimatorToLinkAvatar=function($c,$d){this._handleSpriteToAvatar($c,$d);for(var $e=0,$f=this._childs.length;$e<$f;$e++){this._childs[$e]._setAnimatorToLinkAvatar($c,$d)}},$q(0,$e,"activeInHierarchy",function(){return this._activeInHierarchy}),$q(0,$e,"_loaded",null,function($c){this.__loaded=$c}),$q(0,$e,"active",function(){return this._active},function($c){this._active!==$c&&(this._active=$c,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&($c?this._activeHierarchy():this._inActiveHierarchy()))}),$q(0,$e,"componentsCount",function(){return this._components.length}),$q(0,$e,"loaded",function(){return this.__loaded}),$q(0,$e,"id",function(){return this._id}),$q(0,$e,"url",function(){return this._url}),$q(0,$e,"layer",function(){return this._layer},function($c){if(this._layer!==$c){if(!$c)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var $d=0,$e=this._colliders.length;if(this._layer)for($d=0;$d<$e;$d++)this._layer._removeCollider(this._colliders[$d]);for($d=0;$d<$e;$d++)$c._addCollider(this._colliders[$d])}this._layer=$c,this.event("layerchanged",$c)}}),$q(0,$e,"scene",function(){return this._scene}),$q(0,$e,"transform",function(){return this._transform}),$d.instantiate=function($c,$d,$e,$f,$g){void 0===$e&&($e=!0);var $h=$c.clone();$d&&$d.addChild($h);var $i=$h.transform;if($e){var $j=$i.worldMatrix;$c.transform.worldMatrix.cloneTo($j),$i.worldMatrix=$j}else $f&&($i.position=$f),$g&&($i.rotation=$g);return $h},$d.load=function($c){return $x.loader.create($c,null,null,$d)},$d.WORLDMATRIX=0,$d.MVPMATRIX=1,$d._uniqueIDCounter=0,$d._nameNumberCounter=0,$d}(),$Ld=function($c){function $m($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],$m.__super.call(this),!$c||!$d)throw"Shader Error";this._id=++$m._count,this._vs=$c,this._ps=$d,this._attributeMap=$e,this._sceneUniformMap=$f,this._cameraUniformMap=$g,this._spriteUniformMap=$h,this._materialUniformMap=$i,this._renderElementUniformMap=$j,this._precompile=$k,this._define=$l,this._precompile&&$m.extCompileObj&&$m.extCompileFunc?$m.extCompileFunc.call($m.extCompileObj,$c,$d,$l):this.recreateResource()}$p($m,"laya.d3.shader.Shader3D",$e);var $d=$m.prototype;return $d.recreateResource=function(){$H.now();this._compile(),this.completeCreate(),this.memorySize=0},$d.disposeResource=function(){$F.mainContext.deleteShader(this._vshader),$F.mainContext.deleteShader(this._pshader),$F.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},$d._compile=function(){if(!$F.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var $c=[this._vs,this._ps],$d=$F.mainContext;if(this._program=$d.createProgram(),this._vshader=$m._createShader($d,$c[0],35633),this._pshader=$m._createShader($d,$c[1],35632),$d.attachShader(this._program,this._vshader),$d.attachShader(this._program,this._pshader),$d.linkProgram(this._program),!$r.isConchApp&&$Ad.debugMode&&!$d.getProgramParameter(this._program,35714))throw $d.getProgramInfoLog(this._program);var $e,$f=0,$g=0,$h=0;for($h=$r.isConchApp?$d.getProgramParameterEx(this._vs,this._ps,"",35721):$d.getProgramParameter(this._program,35721),$f=0;$f<$h;$f++){var $i=null;$e={vartype:"attribute",ivartype:0,attrib:$i=$r.isConchApp?$d.getActiveAttribEx(this._vs,this._ps,"",$f):$d.getActiveAttrib(this._program,$f),location:$d.getAttribLocation(this._program,$i.name),name:$i.name,type:$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push($e)}var $j=0;for($j=$r.isConchApp?$d.getProgramParameterEx(this._vs,this._ps,"",35718):$d.getProgramParameter(this._program,35718),$f=0;$f<$j;$f++){var $k=null;$k=$r.isConchApp?$d.getActiveUniformEx(this._vs,this._ps,"",$f):$d.getActiveUniform(this._program,$f),0<($e={vartype:"uniform",ivartype:1,attrib:$i,location:$d.getUniformLocation(this._program,$k.name),name:$k.name,type:$k.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($e.name=$e.name.substr(0,$e.name.length-3),$e.isArray=!0,$e.location=$d.getUniformLocation(this._program,$e.name)),this._uniformParams.push($e)}for($f=0,$g=this._attributeParams.length;$f<$g;$f++)($e=this._attributeParams[$f]).indexOfParams=$f,$e.index=1,$e.value=[$e.location,null],$e.codename=$e.name,$e.name=null!=this._attributeMap[$e.codename]?this._attributeMap[$e.codename]:$e.codename,this._attributeParamsMap.push($e.name),this._attributeParamsMap.push($e),$e._this=this,$e.uploadedValue=[],$e.fun=this._attribute;for($f=0,$g=this._uniformParams.length;$f<$g;$f++)switch(($e=this._uniformParams[$f]).indexOfParams=$f,$e.index=1,$e.value=[$e.location,null],$e.codename=$e.name,null!=this._sceneUniformMap[$e.codename]?($e.name=this._sceneUniformMap[$e.codename],this._sceneUniformParamsMap.push($e.name),this._sceneUniformParamsMap.push($e)):null!=this._cameraUniformMap[$e.codename]?($e.name=this._cameraUniformMap[$e.codename],this._cameraUniformParamsMap.push($e.name),this._cameraUniformParamsMap.push($e)):null!=this._spriteUniformMap[$e.codename]?($e.name=this._spriteUniformMap[$e.codename],this._spriteUniformParamsMap.push($e.name),this._spriteUniformParamsMap.push($e)):null!=this._materialUniformMap[$e.codename]?($e.name=this._materialUniformMap[$e.codename],this._materialUniformParamsMap.push($e.name),this._materialUniformParamsMap.push($e)):null!=this._renderElementUniformMap[$e.codename]?($e.name=this._renderElementUniformMap[$e.codename],this._renderElementUniformParamsMap.push($e.name),this._renderElementUniformParamsMap.push($e)):console.log("Shader:can't find uinform name:"+$e.codename+" in shader file."),$e._this=this,$e.uploadedValue=[],$e.type){case 5124:$e.fun=$e.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$e.fun=$e.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$e.fun=$e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$e.fun=$e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$e.fun=$e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$e.fun=this._uniform_sampler2D;break;case 35680:$e.fun=this._uniform_samplerCube;break;case 35676:$e.fun=this._uniformMatrix4fv;break;case 35670:$e.fun=this._uniform1i;break;case 35674:$e.fun=this._uinformMatrix2fv;break;case 35675:$e.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},$d._attribute=function($c,$d){var $e=$F.mainContext,$f=$j._enableAtributes,$g=$c.location;return $f[$g]||$e.enableVertexAttribArray($g),$e.vertexAttribPointer($g,$d[0],$d[1],$d[2],$d[3],$d[4]),$f[$g]=$j._bindVertexBuffer,1},$d._uniform1f=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d?($F.mainContext.uniform1f($c.location,$e[0]=$d),1):0},$d._uniform1fv=function($c,$d){if($d.length<4){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]||$e[2]!==$d[2]||$e[3]!==$d[3]?($F.mainContext.uniform1fv($c.location,$d),$e[0]=$d[0],$e[1]=$d[1],$e[2]=$d[2],$e[3]=$d[3],1):0}return $F.mainContext.uniform1fv($c.location,$d),1},$d._uniform_vec2=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]?($F.mainContext.uniform2f($c.location,$e[0]=$d[0],$e[1]=$d[1]),1):0},$d._uniform_vec2v=function($c,$d){if($d.length<2){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]||$e[2]!==$d[2]||$e[3]!==$d[3]?($F.mainContext.uniform2fv($c.location,$d),$e[0]=$d[0],$e[1]=$d[1],$e[2]=$d[2],$e[3]=$d[3],1):0}return $F.mainContext.uniform2fv($c.location,$d),1},$d._uniform_vec3=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]||$e[2]!==$d[2]?($F.mainContext.uniform3f($c.location,$e[0]=$d[0],$e[1]=$d[1],$e[2]=$d[2]),1):0},$d._uniform_vec3v=function($c,$d){return $F.mainContext.uniform3fv($c.location,$d),1},$d._uniform_vec4=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]||$e[2]!==$d[2]||$e[3]!==$d[3]?($F.mainContext.uniform4f($c.location,$e[0]=$d[0],$e[1]=$d[1],$e[2]=$d[2],$e[3]=$d[3]),1):0},$d._uniform_vec4v=function($c,$d){return $F.mainContext.uniform4fv($c.location,$d),1},$d._uniformMatrix2fv=function($c,$d){return $F.mainContext.uniformMatrix2fv($c.location,!1,$d),1},$d._uniformMatrix3fv=function($c,$d){return $F.mainContext.uniformMatrix3fv($c.location,!1,$d),1},$d._uniformMatrix4fv=function($c,$d){return $F.mainContext.uniformMatrix4fv($c.location,!1,$d),1},$d._uinformMatrix2fv=function($c,$d){return $F.mainContext.uniformMatrix2fv($c.location,!1,$d),1},$d._uinformMatrix3fv=function($c,$d){return $F.mainContext.uniformMatrix3fv($c.location,!1,$d),1},$d._uniform1i=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d?($F.mainContext.uniform1i($c.location,$e[0]=$d),1):0},$d._uniform1iv=function($c,$d){return $F.mainContext.uniform1iv($c.location,$d),1},$d._uniform_ivec2=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]?($F.mainContext.uniform2i($c.location,$e[0]=$d[0],$e[1]=$d[1]),1):0},$d._uniform_ivec2v=function($c,$d){return $F.mainContext.uniform2iv($c.location,$d),1},$d._uniform_vec3i=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]||$e[2]!==$d[2]?($F.mainContext.uniform3i($c.location,$e[0]=$d[0],$e[1]=$d[1],$e[2]=$d[2]),1):0},$d._uniform_vec3vi=function($c,$d){return $F.mainContext.uniform3iv($c.location,$d),1},$d._uniform_vec4i=function($c,$d){var $e=$c.uploadedValue;return $e[0]!==$d[0]||$e[1]!==$d[1]||$e[2]!==$d[2]||$e[3]!==$d[3]?($F.mainContext.uniform4i($c.location,$e[0]=$d[0],$e[1]=$d[1],$e[2]=$d[2],$e[3]=$d[3]),1):0},$d._uniform_vec4vi=function($c,$d){return $F.mainContext.uniform4iv($c.location,$d),1},$d._uniform_sampler2D=function($c,$d){var $e=$d.source||$d.defaulteTexture.source,$f=$F.mainContext,$g=$c.uploadedValue;if(null!=$g[0])return $f.activeTexture($m._TEXTURES[$g[0]]),$e&&$G.bindTexture($f,3553,$e),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $g[0]=this._curActTexIndex,$f.uniform1i($c.location,this._curActTexIndex),$f.activeTexture($m._TEXTURES[this._curActTexIndex]),$e&&$G.bindTexture($f,3553,$e),this._curActTexIndex++,1},$d._uniform_samplerCube=function($c,$d){var $e=$d.source||$d.defaulteTexture.source,$f=$F.mainContext,$g=$c.uploadedValue;if(null!=$g[0])return $f.activeTexture($m._TEXTURES[$g[0]]),$e?$G.bindTexture($f,34067,$e):$G.bindTexture($f,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $g[0]=this._curActTexIndex,$f.uniform1i($c.location,this._curActTexIndex),$f.activeTexture($m._TEXTURES[this._curActTexIndex]),$e?$G.bindTexture($f,34067,$e):$G.bindTexture($f,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},$d._noSetValue=function($c){console.log("no....:"+$c.name)},$d.bind=function(){return $e.activeShader=this,($e.bindShader=this).activeResource(),$G.UseProgram(this._program)},$d.uploadAttributes=function($c,$d){for(var $e,$f,$g=0,$h=0,$i=this._attributeParamsMap.length;$h<$i;$h+=2)$f=this._attributeParamsMap[$h+1],null!=($e=$c[this._attributeParamsMap[$h]])&&($d&&$d[$f.name]&&$d[$f.name].bind(),$g+=$f.fun.call(this,$f,$e));$A.shaderCall+=$g},$d.uploadAttributesX=function($c,$d){for(var $e,$f,$g=0,$h=0,$i=this._attributeParamsMap.length;$h<$i;$h+=2)$f=this._attributeParamsMap[$h+1],null!=($e=$c[this._attributeParamsMap[$h]])&&($d._bind(),$g+=$f.fun.call(this,$f,$e));$A.shaderCall+=$g},$d.uploadSceneUniforms=function($c){for(var $d,$e,$f=0,$g=0,$h=this._sceneUniformParamsMap.length;$g<$h;$g+=2)$e=this._sceneUniformParamsMap[$g+1],null!=($d=$c[this._sceneUniformParamsMap[$g]])&&($f+=$e.fun.call(this,$e,$d));$A.shaderCall+=$f},$d.uploadCameraUniforms=function($c){for(var $d,$e,$f=0,$g=0,$h=this._cameraUniformParamsMap.length;$g<$h;$g+=2)$e=this._cameraUniformParamsMap[$g+1],null!=($d=$c[this._cameraUniformParamsMap[$g]])&&($f+=$e.fun.call(this,$e,$d));$A.shaderCall+=$f},$d.uploadSpriteUniforms=function($c){for(var $d,$e,$f=0,$g=0,$h=this._spriteUniformParamsMap.length;$g<$h;$g+=2)$e=this._spriteUniformParamsMap[$g+1],null!=($d=$c[this._spriteUniformParamsMap[$g]])&&($f+=$e.fun.call(this,$e,$d));$A.shaderCall+=$f},$d.uploadMaterialUniforms=function($c){for(var $d,$e,$f=0,$g=0,$h=this._materialUniformParamsMap.length;$g<$h;$g+=2)$e=this._materialUniformParamsMap[$g+1],null!=($d=$c[this._materialUniformParamsMap[$g]])&&($f+=$e.fun.call(this,$e,$d));$A.shaderCall+=$f},$d.uploadRenderElementUniforms=function($c){for(var $d,$e,$f=0,$g=0,$h=this._renderElementUniformParamsMap.length;$g<$h;$g+=2)$e=this._renderElementUniformParamsMap[$g+1],null!=($d=$c[this._renderElementUniformParamsMap[$g]])&&($f+=$e.fun.call(this,$e,$d));$A.shaderCall+=$f},$m.create=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){return new $m($c,$d,$e,$f,$g,$h,$i,$j,$k,$l)},$m.addInclude=function($c,$d){$v.addInclude($c,$d)},$m._createShader=function($c,$d,$e){var $f=$c.createShader($e);if($c.shaderSource($f,$d),$c.compileShader($f),$Ad.debugMode&&!$c.getShaderParameter($f,35713))throw $c.getShaderInfoLog($f);return $f},$m.PERIOD_RENDERELEMENT=0,$m.PERIOD_MATERIAL=1,$m.PERIOD_SPRITE=2,$m.PERIOD_CAMERA=3,$m.PERIOD_SCENE=4,$m._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],$m._count=0,$m._preCompile=!1,$m.extCompileFunc=null,$m.extCompileObj=null,$n($m,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new $B}]),$m}(),$Md=function($j){function $k(){this._transformUV=null,$k.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new $id(.6,.6,.6)),this._setColor(10,new $id(1,1,1)),this._setColor(11,new $jd(1,1,1,8)),this._setColor(12,new $id(1,1,1)),this._setColor(7,new $jd(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new $jd(1,1,0,0)),this.renderMode=1}$p($k,"laya.d3.core.material.StandardMaterial",$j);var $c=$k.prototype;return $c.disableLight=function(){this._addDisablePublicShaderDefine($Ad.SHADERDEFINE_POINTLIGHT|$Ad.SHADERDEFINE_SPOTLIGHT|$Ad.SHADERDEFINE_DIRECTIONLIGHT)},$c.disableFog=function(){this._addDisablePublicShaderDefine($Ad.SHADERDEFINE_FOG)},$c.onAsynLoaded=function($c,$d,$e){var $f=$d[0];if($f.version)$j.prototype.onAsynLoaded.call(this,$c,$d,$e);else{var $g=$d[1],$h=$f.props;for(var $i in $h)this[$i]=$h[$i];$k._parseStandardMaterial($g,this,$f),this._endLoaded()}},$c.cloneTo=function($c){$j.prototype.cloneTo.call(this,$c);var $d=$c;this._transformUV&&($d._transformUV=this._transformUV.clone())},$q(0,$c,"ambientColor",function(){return this._getColor(9)},function($c){this._setColor(9,$c)}),$q(0,$c,"ambientTexture",function(){return this._getTexture(5)},function($c){$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,$c)}),$q(0,$c,"renderMode",null,function($c){switch($c){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($k.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode($c)}),$q(0,$c,"reflectColor",function(){return this._getColor(12)},function($c){this._setColor(12,$c)}),$q(0,$c,"tilingOffset",function(){return this._getColor(15)},function($c){if($c){var $d=$c.elements;1!=$d[0]||1!=$d[1]||0!=$d[2]||0!=$d[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,$c)}),$q(0,$c,"albedo",function(){return this._getColor(7)},function($c){this._setColor(7,$c)}),$q(0,$c,"diffuseColor",function(){return this._getColor(10)},function($c){this._setColor(10,$c)}),$q(0,$c,"albedoColor",function(){return this._getColor(7)},function($c){this._setColor(7,$c)}),$q(0,$c,"specularColor",function(){return this._getColor(11)},function($c){this._setColor(11,$c)}),$q(0,$c,"diffuseTexture",function(){return this._getTexture(1)},function($c){$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,$c)}),$q(0,$c,"normalTexture",function(){return this._getTexture(2)},function($c){$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,$c)}),$q(0,$c,"specularTexture",function(){return this._getTexture(3)},function($c){$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,$c)}),$q(0,$c,"emissiveTexture",function(){return this._getTexture(4)},function($c){$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,$c)}),$q(0,$c,"reflectTexture",function(){return this._getTexture(6)},function($c){$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,$c)}),$q(0,$c,"transformUV",function(){return this._transformUV},function($c){this._transformUV=$c,this._setMatrix4x4(13,$c.matrix),$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,$c.matrix.elements,0)}),$k.__init__=function(){$k.SHADERDEFINE_DIFFUSEMAP=$k.shaderDefines.registerDefine("DIFFUSEMAP"),$k.SHADERDEFINE_NORMALMAP=$k.shaderDefines.registerDefine("NORMALMAP"),$k.SHADERDEFINE_SPECULARMAP=$k.shaderDefines.registerDefine("SPECULARMAP"),$k.SHADERDEFINE_EMISSIVEMAP=$k.shaderDefines.registerDefine("EMISSIVEMAP"),$k.SHADERDEFINE_AMBIENTMAP=$k.shaderDefines.registerDefine("AMBIENTMAP"),$k.SHADERDEFINE_REFLECTMAP=$k.shaderDefines.registerDefine("REFLECTMAP"),$k.SHADERDEFINE_UVTRANSFORM=$k.shaderDefines.registerDefine("UVTRANSFORM"),$k.SHADERDEFINE_TILINGOFFSET=$k.shaderDefines.registerDefine("TILINGOFFSET"),$k.SHADERDEFINE_ADDTIVEFOG=$k.shaderDefines.registerDefine("ADDTIVEFOG")},$k.load=function($c){return $x.loader.create($c,null,null,$k)},$k._parseStandardMaterial=function($c,$d,$e){var $f=$e.customProps,$g=$f.ambientColor;$d.ambientColor=new $id($g[0],$g[1],$g[2]);var $h=$f.diffuseColor;$d.diffuseColor=new $id($h[0],$h[1],$h[2]);var $i=$f.specularColor;$d.specularColor=new $jd($i[0],$i[1],$i[2],$i[3]);var $j=$f.reflectColor;$d.reflectColor=new $id($j[0],$j[1],$j[2]);var $k=$f.albedoColor;$k&&($d.albedo=new $jd($k[0],$k[1],$k[2],$k[3]));var $l=$f.diffuseTexture.texture2D;$l&&($d.diffuseTexture=$t.getRes($c[$l]));var $m=$f.normalTexture.texture2D;$m&&($d.normalTexture=$t.getRes($c[$m]));var $n=$f.specularTexture.texture2D;$n&&($d.specularTexture=$t.getRes($c[$n]));var $o=$f.emissiveTexture.texture2D;$o&&($d.emissiveTexture=$t.getRes($c[$o]));var $p=$f.ambientTexture.texture2D;$p&&($d.ambientTexture=$t.getRes($c[$p]));var $q=$f.reflectTexture.texture2D;$q&&($d.reflectTexture=$t.getRes($c[$q]))},$k.RENDERMODE_OPAQUE=1,$k.RENDERMODE_OPAQUEDOUBLEFACE=2,$k.RENDERMODE_CUTOUT=3,$k.RENDERMODE_CUTOUTDOUBLEFACE=4,$k.RENDERMODE_TRANSPARENT=13,$k.RENDERMODE_TRANSPARENTDOUBLEFACE=14,$k.RENDERMODE_ADDTIVE=15,$k.RENDERMODE_ADDTIVEDOUBLEFACE=16,$k.RENDERMODE_DEPTHREAD_TRANSPARENT=5,$k.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,$k.RENDERMODE_DEPTHREAD_ADDTIVE=7,$k.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,$k.RENDERMODE_NONDEPTH_TRANSPARENT=9,$k.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,$k.RENDERMODE_NONDEPTH_ADDTIVE=11,$k.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,$k.SHADERDEFINE_DIFFUSEMAP=0,$k.SHADERDEFINE_NORMALMAP=0,$k.SHADERDEFINE_SPECULARMAP=0,$k.SHADERDEFINE_EMISSIVEMAP=0,$k.SHADERDEFINE_AMBIENTMAP=0,$k.SHADERDEFINE_REFLECTMAP=0,$k.SHADERDEFINE_UVTRANSFORM=0,$k.SHADERDEFINE_TILINGOFFSET=0,$k.SHADERDEFINE_ADDTIVEFOG=0,$k.DIFFUSETEXTURE=1,$k.NORMALTEXTURE=2,$k.SPECULARTEXTURE=3,$k.EMISSIVETEXTURE=4,$k.AMBIENTTEXTURE=5,$k.REFLECTTEXTURE=6,$k.ALBEDO=7,$k.UVANIAGE=8,$k.MATERIALAMBIENT=9,$k.MATERIALDIFFUSE=10,$k.MATERIALSPECULAR=11,$k.MATERIALREFLECT=12,$k.UVMATRIX=13,$k.UVAGE=14,$k.TILINGOFFSET=15,$n($k,["defaultMaterial",function(){var $c=new $k;return $c.lock=!0,this.defaultMaterial=$c},"shaderDefines",function(){return this.shaderDefines=new $md($Ed.shaderDefines)}]),$k}($Ed),$Nd=function($c){function $i($c,$d,$e,$f,$g){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===$e&&($e=35044),void 0===$f&&($f=!1),$i.__super.call(this),this._indexType=$c,this._indexCount=$d,this._bufferUsage=$e,this._bufferType=34963,this._canRead=$f;var $h;if("ushort"==$c)this._indexTypeByteCount=2;else{if("ubyte"!=$c)throw new Error("unidentification index type.");this._indexTypeByteCount=1}$h=this._indexTypeByteCount*$d,this._byteLength=$h,this._bind(),$j._gl.bufferData(this._bufferType,$h,this._bufferUsage),this.uri=$g,$f?("ushort"==$c?this._buffer=new Uint16Array($d):"ubyte"==$c&&(this._buffer=new Uint8Array($d)),this.memorySize=2*$h):this.memorySize=$h}$p($i,"laya.d3.graphics.IndexBuffer3D",$c);var $d=$i.prototype;return $d.setData=function($c,$d,$e,$f){void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=4294967295);var $g=0;if("ushort"==this._indexType?($g=2,0===$e&&4294967295===$f||($c=new Uint16Array($c.buffer,$e*$g,$f))):"ubyte"==this._indexType&&($g=1,0===$e&&4294967295===$f||($c=new Uint8Array($c.buffer,$e*$g,$f))),this._bind(),$j._gl.bufferSubData(this._bufferType,$d*$g,$c),this._canRead)if(0!==$d||0!==$e||4294967295!==$f){var $h=this._buffer.length-$d;$h<$f&&($f=$h);for(var $i=0;$i<$f;$i++)this._buffer[$d+$i]=$c[$i]}else this._buffer=$c},$d.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$d.disposeResource=function(){$c.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},$q(0,$d,"indexType",function(){return this._indexType}),$q(0,$d,"indexTypeByteCount",function(){return this._indexTypeByteCount}),$q(0,$d,"indexCount",function(){return this._indexCount}),$q(0,$d,"canRead",function(){return this._canRead}),$i.INDEXTYPE_UBYTE="ubyte",$i.INDEXTYPE_USHORT="ushort",$i.create=function($c,$d,$e,$f,$g){return void 0===$e&&($e=35044),void 0===$f&&($f=!1),new $i($c,$d,$e,$f,$g)},$i}($j),$Od=function($h){function $i($c,$d,$e,$f,$g){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===$f&&($f=!1),$i.__super.call(this),this._vertexDeclaration=$c,this._vertexCount=$d,this._bufferUsage=$e,this._bufferType=34962,this._canRead=$f,this.uri=$g,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*$d,this._bind(),$j._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),$f&&(this._buffer=new Float32Array(this._byteLength/4))}$p($i,"laya.d3.graphics.VertexBuffer3D",$h);var $c=$i.prototype;return $c.bindWithIndexBuffer=function($c){$c&&$c._bind(),this._bind()},$c.setData=function($c,$d,$e,$f){if(void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=4294967295),0===$e&&4294967295===$f||($c=new Float32Array($c.buffer,4*$e,$f)),this._bind(),$j._gl.bufferSubData(this._bufferType,4*$d,$c),this._canRead)if(0!==$d||0!==$e||4294967295!==$f){var $g=this._buffer.length-$d;$g<$f&&($f=$g);for(var $h=0;$h<$f;$h++)this._buffer[$d+$h]=$c[$h]}else this._buffer=$c},$c.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$c.disposeResource=function(){for(var $c=$F.mainContext,$d=this._vertexDeclaration.getVertexElements(),$e=$j._enableAtributes,$f=0,$g=$d.length;$f<$g;$f++)$e[$f]===this._glBuffer&&($c.disableVertexAttribArray($f),$e[$f]=null);$h.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},$q(0,$c,"vertexDeclaration",function(){return this._vertexDeclaration}),$q(0,$c,"vertexCount",function(){return this._vertexCount}),$q(0,$c,"canRead",function(){return this._canRead}),$i.create=function($c,$d,$e,$f,$g){return void 0===$e&&($e=35044),void 0===$f&&($f=!1),new $i($c,$d,$e,$f,$g)},$i}($j),$Pd=function($c){function $v(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,$v.__super.call(this),this._type=3553}$p($v,"laya.d3.resource.DataTexture2D",$Fd);var $d=$v.prototype;return $d.genDebugMipmaps=function(){var $c=[];return $c.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),$c.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),$c.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),$c.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),$c.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),$c.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),$c.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),$c.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),$c.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),$c.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),$c},$d._onTextureLoaded=function($c){},$d._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var $c=$F.mainContext,$d=this._source=$c.createTexture(),$e=this._width,$f=this._height,$g=$G.curBindTexTarget,$h=$G.curBindTexValue,$i=!1;if($G.bindTexture($c,this._type,$d),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var $j=0;$c.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var $k=0;$k<this._mipmaps.length;$k++){if(this._mipmaps[$k].byteLength!=$l*$m*4)throw"mipmap size error  level:"+$k;$c.texSubImage2D(this._type,0,$v.simLodRect[$j++],$v.simLodRect[$j++],$v.simLodRect[$j++],$v.simLodRect[$j++],6408,5121,new Uint8Array(this._mipmaps[$k]))}this.minFifter=9729,this.magFifter=9729}else{var $l=this._width,$m=this._height;for($j=0,$c.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),$k=0;$k<this._mipmaps.length;$k++){if(this._mipmaps[$k].byteLength!=$l*$m*4)throw"mipmap size error  level:"+$k;$c.texImage2D(this._type,$k,6408,$l,$m,0,6408,5121,new Uint8Array(this._mipmaps[$k])),($l/=2)<1&&($l=1),($m/=2)<1&&($m=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&$c.pixelStorei($c.UNPACK_ALIGNMENT,1),$c.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var $n=0,$o=!1,$p=!1;this._buffer.byteLength==4*$e*$f?($n=6408,$o=!0):this._buffer.byteLength==3*$e*$f?($n=6407,$p=!0):$n=this._format,$o||$p?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),$p&&$c.pixelStorei($c.UNPACK_ALIGNMENT,1),$c.texImage2D(this._type,0,$n,$e,$f,0,$n,5121,this._buffer)):$c&&$n==$c.ALPHA?($c.texImage2D(3553,0,$n,$e,$f,0,$n,$c.UNSIGNED_BYTE,this._buffer),$i=!0):0!=$n&&($c.compressedTexImage2D(3553,0,$n,$e,$f,0,this._buffer),$i=!0)}var $q=this._minFifter,$r=this._magFifter,$s=0==this._wrapModeU?10497:33071,$t=0==this._wrapModeV?10497:33071,$u=$w.isPOT($e,$f);$u?(this._mipmap||this._mipmaps?-1!==$q||($q=9987):-1!==$q||($q=9729),-1!==$r||($r=9729),$c.texParameteri(this._type,10241,$q),$c.texParameteri(this._type,10240,$r),$c.texParameteri(this._type,10242,$s),$c.texParameteri(this._type,10243,$t),this._mipmap&&$c.generateMipmap(this._type)):(-1!==$q||($q=9729),-1!==$r||($r=9729),$c.texParameteri(this._type,10241,$q),$c.texParameteri(this._type,10240,$r),$c.texParameteri(this._type,10242,33071),$c.texParameteri(this._type,10243,33071)),$g&&$h&&$G.bindTexture($c,$g,$h),this.memorySize=$i?this._buffer.length:$u?$e*$f*4*(1+1/3):$e*$f*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},$d.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},$d.onAsynLoaded=function($c,$d,$e){var $f;$e&&($f=$e[0].call(this,$d)),$f&&(this._width=$f.width,this._height=$f.height,this._buffer=$f.data),this._src=$c,this._size=new $rd(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},$d.getPixels=function(){return new Uint8Array(this._buffer)},$d.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&($F.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},$q(0,$d,"src",function(){return this._src}),$v.create=function($c,$d,$e,$f,$g,$h,$i){if(void 0===$f&&($f=9729),void 0===$g&&($g=9729),void 0===$h&&($h=!0),!$c||$c.byteLength<$d*$e*4)throw"DataTexture2D create error";var $j=new $v;return $j.uri=$i,$j._buffer=$c,$j._width=$d,$j._height=$e,$j._mipmap=$h,$j._magFifter=$f,$j._minFifter=$g,$j._size=new $rd($j._width,$j._height),$j._conchTexture?alert("怎么给runtime传递datatexture数据"):$j.activeResource(),$j},$v.load=function($c,$d,$e,$f,$g){if(void 0===$d&&($d=0),void 0===$e&&($e=0),void 0===$f&&($f=9729),void 0===$g&&($g=9729),"mipmaps"===$C.getFileExtension($c)){var $h=$x.loader.create($c,null,null,$v,[function($c){this._mipmaps=[];var $d=new Uint32Array($c);this._width=$d[0];var $e=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,$e=1024),this._width!=$e)throw"现在只支持512x256的环境贴图。当前的是"+$d[0];this._height=$d[1];for(var $f=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,$g=this._height,$h=8;;){var $i=$f*$g*4;if($h+$i>$c.byteLength)throw"load mipmaps data size error ";var $j=new Uint8Array($c,$h,$i);if(this._mipmaps.push($j),$h+=$i,1==$f&&1==$g)break;($f/=2)<1&&($f=1),($g/=2)<1&&($g=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){$h.simLodInfo=new Float32Array(40);for(var $i=0;$i<$h.simLodInfo.length;)$h.simLodInfo[$i]=($v.simLodRect[$i]+.5)/1024,$i++,$h.simLodInfo[$i]=($v.simLodRect[$i]+.5)/256,$i++,$h.simLodInfo[$i]=Math.max($v.simLodRect[$i]-1,.1)/1024,$i++,$h.simLodInfo[$i]=Math.max($v.simLodRect[$i]-1.5,.1)/256,$i++}return $h}if("number"==typeof $d)return $x.loader.create($c,null,null,$v,[function($c){return this._width=$d,this._height=$e,this._buffer=$c,null}]);if("function"==typeof $d)return $x.loader.create($c,null,null,$v,[$d]);throw new Error("unknown params.")},$v.lodasatlas=!1,$n($v,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),$v}(),$Qd=function($c){function $d(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,$d.__super.call(this)}$p($d,"laya.d3.resource.models.PrimitiveMesh",$Gd);var $e=$d.prototype;return $x.imps($e,{"laya.d3.core.render.IRenderable":!0}),$e._getVertexBuffer=function($c){return void 0===$c&&($c=0),0===$c?this._vertexBuffer:null},$e._getVertexBuffers=function(){return null},$e._getIndexBuffer=function(){return this._indexBuffer},$e._getPositions=function(){var $c,$d=[],$e=this._vertexBuffer.vertexDeclaration.getVertexElements(),$f=0;for($f=0;$f<$e.length;$f++){var $g=$e[$f];if("vector3"===$g.elementFormat&&0===$g.elementUsage){$c=$g;break}}var $h=this._vertexBuffer.getData();for($f=0;$f<$h.length;$f+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var $i=$f+$c.offset/4,$j=new $id($h[$i+0],$h[$i+1],$h[$i+2]);$d.push($j)}return $d},$e.getRenderElement=function($c){return this},$e.getRenderElementsCount=function(){return 1},$e.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},$e._beforeRender=function($c){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$e._render=function($c){$F.mainContext.drawElements(4,this._numberIndices,5123,0),$A.drawCall++,$A.trianglesFaces+=this._numberIndices/3},$q(0,$e,"_vertexBufferCount",function(){return 1}),$q(0,$e,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$d}(),$Rd=function($c){function $d(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,$d.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}$p($d,"laya.d3.resource.models.Mesh",$Gd);var $e=$d.prototype;return $e._getPositions=function(){var $c,$d,$e,$f,$g,$h=[],$i=0,$j=0,$k=0;if(0!==this._vertexBuffers.length){var $l=this._vertexBuffers.length;for($i=0;$i<$l;$i++){for($e=($c=this._vertexBuffers[$i]).vertexDeclaration.getVertexElements(),$j=0;$j<$e.length;$j++)if("vector3"===($f=$e[$j]).elementFormat&&0===$f.elementUsage){$d=$f;break}for($g=$c.getData(),$j=0;$j<$g.length;$j+=$c.vertexDeclaration.vertexStride/4)$k=$j+$d.offset/4,$h.push(new $id($g[$k+0],$g[$k+1],$g[$k+2]))}}else{var $m=this._subMeshes.length;for($i=0;$i<$m;$i++){for($e=($c=this._subMeshes[$i]._getVertexBuffer()).vertexDeclaration.getVertexElements(),$j=0;$j<$e.length;$j++)if("vector3"===($f=$e[$j]).elementFormat&&0===$f.elementUsage){$d=$f;break}for($g=$c.getData(),$j=0;$j<$g.length;$j+=$c.vertexDeclaration.vertexStride/4)$k=$j+$d.offset/4,$h.push(new $id($g[$k+0],$g[$k+1],$g[$k+2]))}}return $h},$e._setSubMeshes=function($c){this._subMeshes=$c,this._subMeshCount=$c.length;for(var $d=0;$d<this._subMeshCount;$d++)$c[$d]._indexInMesh=$d;this._positions=this._getPositions(),this._generateBoundingObject()},$e.onAsynLoaded=function($c,$d,$e){var $f=$d[0],$g=$d[1];$Yc.read($f,this,this._materials,this._subMeshes,$g),this.completeCreate(),this._endLoaded()},$e.getSubMesh=function($c){return this._subMeshes[$c]},$e.getSubMeshCount=function(){return this._subMeshes.length},$e.getRenderElementsCount=function(){return this._subMeshes.length},$e.getRenderElement=function($c){return this._subMeshes[$c]},$e.disposeResource=function(){for(var $c=0;$c<this._subMeshes.length;$c++)this._subMeshes[$c].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},$q(0,$e,"materials",function(){return this._materials.slice()}),$q(0,$e,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),$d.load=function($c){return $x.loader.create($c,null,null,$d)},$d}(),$Sd=(function($c){function $l($c,$d,$e,$f,$g,$h,$i,$j,$k){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===$e&&($e=6408),void 0===$f&&($f=5121),void 0===$g&&($g=33189),void 0===$h&&($h=!1),void 0===$i&&($i=!1),void 0===$j&&($j=-1),void 0===$k&&($k=-1),$l.__super.call(this),this._type=3553,this._width=$c,this._height=$d,this._size=new $rd($c,$d),this._surfaceFormat=$e,this._surfaceType=$f,this._depthStencilFormat=$g,$r.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=$h,this._repeat=$i,this._minFifter=$j,this._magFifter=$k,this.activeResource(),this._alreadyResolved=!0}$p($l,"laya.d3.resource.RenderTexture",$Fd);var $d=$l.prototype;$d.recreateResource=function(){var $c=$F.mainContext;this._frameBuffer=$c.createFramebuffer(),this._source=$c.createTexture();var $d=$G.curBindTexTarget,$e=$G.curBindTexValue;$G.bindTexture($c,this._type,this._source),$c.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var $f=this._minFifter,$g=this._magFifter,$h=this._repeat?10497:33071;if($w.isPOT(this._width,this._height)?(this._mipmap?-1!==$f||($f=9987):-1!==$f||($f=9729),-1!==$g||($g=9729),$c.texParameteri(this._type,10241,$f),$c.texParameteri(this._type,10240,$g),$c.texParameteri(this._type,10242,$h),$c.texParameteri(this._type,10243,$h),this._mipmap&&$c.generateMipmap(this._type)):(-1!==$f||($f=9729),-1!==$g||($g=9729),$c.texParameteri(this._type,10241,$f),$c.texParameteri(this._type,10240,$g),$c.texParameteri(this._type,10242,33071),$c.texParameteri(this._type,10243,33071)),$d&&$e&&$G.bindTexture($c,$d,$e),$c.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=$c.createRenderbuffer(),$c.bindRenderbuffer(36161,this._depthStencilBuffer),$c.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),$c.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:$c.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$c.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$c.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$c.framebufferTexture2D(36160,36064,3553,this._source,0),$c.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},$d.start=function(){$F.mainContext.bindFramebuffer(36160,this.frameBuffer),($l._currentRenderTarget=this)._alreadyResolved=!1},$d.end=function(){$F.mainContext.bindFramebuffer(36160,null),$l._currentRenderTarget=null,this._alreadyResolved=!0},$d.getData=function($c,$d,$e,$f){var $g=$F.mainContext;if($g.bindFramebuffer(36160,this._frameBuffer),!(36053===$g.checkFramebufferStatus(36160)))return $g.bindFramebuffer(36160,null),null;var $h=new Uint8Array(this._width*this._height*4);return $g.readPixels($c,$d,$e,$f,this._surfaceFormat,this._surfaceType,$h),$g.bindFramebuffer(36160,null),$h},$d.disposeResource=function(){if(this._frameBuffer){var $c=$F.mainContext;$c.deleteTexture(this._source),$c.deleteFramebuffer(this._frameBuffer),$c.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},$q(0,$d,"surfaceFormat",function(){return this._surfaceFormat}),$q(0,$d,"surfaceType",function(){return this._surfaceType}),$q(0,$d,"depthStencilFormat",function(){return this._depthStencilFormat}),$q(0,$d,"source",function(){return this._alreadyResolved?$x.superGet($Fd,this,"source"):null}),$q(0,$d,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$q(0,$d,"frameBuffer",function(){return this._frameBuffer}),$l._currentRenderTarget=null}(),function($c){function $d($c){this._color=null,this._pixels=null,$d.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new $rd(this.width,this.height),this._color=$c,this._pixels=new Uint8Array([255*$c.x,255*$c.y,255*$c.z,255*$c.w]),this.uri="SolidColorTexture2D_"+this.id}$p($d,"laya.d3.resource.SolidColorTexture2D",$Fd);var $e=$d.prototype;return $e._createWebGlTexture=function(){var $c=$F.mainContext,$d=this._source=$c.createTexture(),$e=this._width,$f=this._height,$g=$G.curBindTexTarget,$h=$G.curBindTexValue;$G.bindTexture($c,this._type,$d),$c.texImage2D(this._type,0,6408,$e,$f,0,6408,5121,this._pixels);var $i=this._minFifter,$j=this._magFifter,$k=this._repeat?10497:33071,$l=$w.isPOT($e,$f);$l?(this._mipmap?-1!==$i||($i=9987):-1!==$i||($i=9729),-1!==$j||($j=9729),$c.texParameteri(this._type,10241,$i),$c.texParameteri(this._type,10240,$j),$c.texParameteri(this._type,10242,$k),$c.texParameteri(this._type,10243,$k),this._mipmap&&$c.generateMipmap(this._type)):(-1!==$i||($i=9729),-1!==$j||($j=9729),$c.texParameteri(this._type,10241,$i),$c.texParameteri(this._type,10240,$j),$c.texParameteri(this._type,10242,33071),$c.texParameteri(this._type,10243,33071)),$g&&$h&&$G.bindTexture($c,$g,$h),this.memorySize=$l?$e*$f*4*(1+1/3):$e*$f*4},$e.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$e.disposeResource=function(){this._source&&($F.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$n($d,["magentaTexture",function(){var $c=new $d(new $jd(1,0,1,1));return $c.lock=!0,this.magentaTexture=$c},"grayTexture",function(){var $c=new $d(new $jd(.5,.5,.5,1));return $c.lock=!0,this.grayTexture=$c}]),$d}()),$Td=function($c){function $g($c,$d,$e,$f){this._canRead=!1,this._image=null,this._pixels=null,void 0===$c&&($c=!1),void 0===$d&&($d=!0),void 0===$e&&($e=6408),void 0===$f&&($f=!0),$g.__super.call(this),this._type=3553,this._repeat=$d,this._canRead=$c,this._format=$e,this._mipmap=$f}$p($g,"laya.d3.resource.Texture2D",$Fd);var $d=$g.prototype;return $d._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $c=$F.mainContext,$d=this._source=$c.createTexture(),$e=this._width,$f=this._height,$g=$G.curBindTexTarget,$h=$G.curBindTexValue;switch($G.bindTexture($c,this._type,$d),this._format){case 6407:case 6408:this._canRead?$c.texImage2D(this._type,0,this._format,$e,$f,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?$c.texImage2D(this._type,0,this._image._format,$e,$f,0,this._image._format,5121,this._image.atlasSource):$c.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case $F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$c.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var $i=this._minFifter,$j=this._magFifter,$k=this._repeat?10497:33071,$l=0==this._wrapModeU?10497:33071,$m=0==this._wrapModeV?10497:33071,$n=$w.isPOT($e,$f);$n?(this._mipmap?-1!==$i||($i=9987):-1!==$i||($i=9729),-1!==$j||($j=9729),$c.texParameteri(this._type,10241,$i),$c.texParameteri(this._type,10240,$j),$c.texParameteri(this._type,10242,$k),$c.texParameteri(this._type,10243,$k),$c.texParameteri(this._type,10242,$l),$c.texParameteri(this._type,10243,$m),this._mipmap&&$c.generateMipmap(this._type)):(-1!==$i||($i=9729),-1!==$j||($j=9729),$c.texParameteri(this._type,10241,$i),$c.texParameteri(this._type,10240,$j),$c.texParameteri(this._type,10242,33071),$c.texParameteri(this._type,10243,33071)),$g&&$h&&$G.bindTexture($c,$g,$h),this._image.onload=null,this._image=null,this.memorySize=$n?$e*$f*4*(1+1/3):$e*$f*4},$d.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$d.onAsynLoaded=function($c,$d,$e){if($e){var $f=$e[0];void 0!==$f&&(this._canRead=$f);var $g=$e[1];void 0!==$g&&(this._repeat=$g);var $h=$e[2];void 0!==$h&&(this._format=$h);var $i=$e[3];void 0!==$i&&(this._mipmap=$i);var $j=$e.wrapModeU;void 0!==$j&&(this._wrapModeU=$j);var $k=$e.wrapModeV;void 0!==$k&&(this._wrapModeV=$k)}switch(this._format){case 6407:case 6408:var $l=(this._image=$d).width,$m=$d.height;this._width=$l,this._height=$m,this._size=new $rd($l,$m),this._canRead&&($r.isConchApp?$d instanceof $o.HTMLElement&&(this._pixels=new Uint8Array($d.getImageData(0,0,$l,$m))):($H.canvas.size($l,$m),$H.canvas.clear(),$H.context.drawImage($d,0,0,$l,$m),this._pixels=new Uint8Array($H.context.getImageData(0,0,$l,$m).data.buffer)));break;case $F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var $n=new $y($d);$n.readUTFBytes(4),$n.readUTFBytes(2),$n.getInt16();$n.endian="bigEndian",this._width=$n.getInt16(),this._height=$n.getInt16(),this._size=new $rd(this._width,this._height);$n.getInt16(),$n.getInt16();this._image=new Uint8Array($d,$n.pos)}this.recreateResource(),this._endLoaded()},$d.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},$d.disposeResource=function(){this._source&&($F.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},$q(0,$d,"_src",function(){return this.url}),$q(0,$d,"src",function(){return this.url}),$g.load=function($c){return $x.loader.create($c,null,null,$g)},$g}(),$Ud=function($d){function $e($c,$d){$e.__super.call(this),void 0===$c&&($c=.3),void 0===$d&&($d=1e3),this._tempVector3=new $id,this._position=new $id,this._up=new $id,this._forward=new $id,this._right=new $id,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=$rd.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=$c,this._farPlane=$d,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),$x.stage.on("resize",this,this._onScreenSizeChanged)}$p($e,"laya.d3.core.BaseCamera",$d);var $c=$e.prototype;return $c._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var $c=this.scene._cameraPool,$d=$c.length-1,$e=0;$e<$d;$e++)if($c[$e].renderingOrder>$c[$d].renderingOrder){var $f=$c[$e];$c[$e]=$c[$d],$c[$d]=$f}},$c._calculateProjectionMatrix=function(){},$c._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},$c._prepareCameraToRender=function(){$I._currentCameraCullingMask=this.cullingMask;var $c=this._shaderValues;$c.setValue(0,this.transform.position.elements),$c.setValue(5,this.forward.elements),$c.setValue(6,this.up.elements)},$c._prepareCameraViewProject=function($c,$d){var $e=this._shaderValues;$e.setValue(1,$c.elements),$e.setValue(2,$d.elements)},$c._renderCamera=function($c,$d,$e){},$c.addLayer=function($c){29!==$c.number&&30!=$c.number&&(this.cullingMask=this.cullingMask|$c.mask)},$c.removeLayer=function($c){29!==$c.number&&30!=$c.number&&(this.cullingMask=this.cullingMask&~$c.mask)},$c.addAllLayers=function(){this.cullingMask=2147483647},$c.removeAllLayers=function(){this.cullingMask=0|$I.getLayerByNumber(29).mask|$I.getLayerByNumber(30).mask},$c.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},$c.moveForward=function($c){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=$c,this.transform.translate(this._tempVector3)},$c.moveRight=function($c){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=$c,this.transform.translate(this._tempVector3)},$c.moveVertical=function($c){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=$c,this.transform.translate(this._tempVector3,!1)},$c._addSelfRenderObjects=function(){var $c=this.scene._cameraPool,$d=$c.length;if(0<$d){for(var $e=$d-1;0<=$e;$e--)if(this.renderingOrder<=$c[$e].renderingOrder){$c.splice($e+1,0,this);break}}else $c.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},$c._clearSelfRenderObjects=function(){var $c=this.scene._cameraPool;$c.splice($c.indexOf(this),1)},$c.destroy=function($c){void 0===$c&&($c=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,$x.stage.off("resize",this,this._onScreenSizeChanged),$d.prototype.destroy.call(this,$c)},$q(0,$c,"sky",function(){return this._sky},function($c){(this._sky=$c)._ownerCamera=this}),$q(0,$c,"forward",function(){var $c=this.transform.worldMatrix.elements,$d=this._forward.elements;return $d[0]=-$c[8],$d[1]=-$c[9],$d[2]=-$c[10],this._forward}),$q(0,$c,"position",function(){var $c=this.transform.worldMatrix.elements,$d=this._position.elements;return $d[0]=$c[12],$d[1]=$c[13],$d[2]=$c[14],this._position}),$q(0,$c,"renderTarget",function(){return this._renderTarget},function($c){null!=(this._renderTarget=$c)&&(this._renderTargetSize=$c.size)}),$q(0,$c,"up",function(){var $c=this.transform.worldMatrix.elements,$d=this._up.elements;return $d[0]=$c[4],$d[1]=$c[5],$d[2]=$c[6],this._up}),$q(0,$c,"right",function(){var $c=this.transform.worldMatrix.elements,$d=this._right.elements;return $d[0]=$c[0],$d[1]=$c[1],$d[2]=$c[2],this._right}),$q(0,$c,"renderTargetSize",function(){return this._renderTargetSize},function($c){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=$c,this._calculateProjectionMatrix()}),$q(0,$c,"fieldOfView",function(){return this._fieldOfView},function($c){this._fieldOfView=$c,this._calculateProjectionMatrix()}),$q(0,$c,"nearPlane",function(){return this._nearPlane},function($c){this._nearPlane=$c,this._calculateProjectionMatrix()}),$q(0,$c,"farPlane",function(){return this._farPlane},function($c){this._farPlane=$c,this._calculateProjectionMatrix()}),$q(0,$c,"orthographic",function(){return this._orthographic},function($c){this._orthographic=$c,this._calculateProjectionMatrix()}),$q(0,$c,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function($c){this._orthographicVerticalSize=$c,this._calculateProjectionMatrix()}),$q(0,$c,"renderingOrder",function(){return this._renderingOrder},function($c){this._renderingOrder=$c,this._sortCamerasByRenderingOrder()}),$e.CAMERAPOS=0,$e.VIEWMATRIX=1,$e.PROJECTMATRIX=2,$e.VPMATRIX=3,$e.VPMATRIX_NO_TRANSLATE=4,$e.CAMERADIRECTION=5,$e.CAMERAUP=6,$e.ENVIRONMENTDIFFUSE=7,$e.ENVIRONMENTSPECULAR=8,$e.SIMLODINFO=9,$e.DIFFUSEIRRADMATR=10,$e.DIFFUSEIRRADMATG=11,$e.DIFFUSEIRRADMATB=12,$e.HDREXPOSURE=13,$e.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",$e.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",$e.CLEARFLAG_SOLIDCOLOR=0,$e.CLEARFLAG_SKY=1,$e.CLEARFLAG_DEPTHONLY=2,$e.CLEARFLAG_NONE=3,$n($e,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new $cd(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new $cd},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new $cd}]),$e}($Kd),$Vd=function($e){function $d($c){this._render=null,this._geometryFilter=null,$d.__super.call(this,$c)}$p($d,"laya.d3.core.RenderableSprite3D",$e);var $c=$d.prototype;return $c._addToInitStaticBatchManager=function(){},$c._setBelongScene=function($c){$e.prototype._setBelongScene.call(this,$c),$c._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},$c._setUnBelongScene=function(){var $c=this._scene._renderableSprite3Ds,$d=$c.indexOf(this);$c.splice($d,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),$e.prototype._setUnBelongScene.call(this)},$c._update=function($c){($c.owner=this)._activeInHierarchy&&(this._updateComponents($c),this._render._updateOctreeNode(),this._lateUpdateComponents($c),$A.spriteCount++,this._childs.length&&this._updateChilds($c))},$c.destroy=function($c){void 0===$c&&($c=!0),$e.prototype.destroy.call(this,$c),this._render._destroy(),this._render=null},$d.__init__=function(){$d.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=$d.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),$d.SAHDERDEFINE_LIGHTMAP=$d.shaderDefines.registerDefine("LIGHTMAP")},$d.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,$d.SAHDERDEFINE_LIGHTMAP=4,$d.LIGHTMAPSCALEOFFSET=2,$d.LIGHTMAP=3,$n($d,["shaderDefines",function(){return this.shaderDefines=new $md}]),$d}($Kd),$Wd=(function($c){function $f($c,$d,$e){this._long=NaN,this._width=NaN,this._height=NaN,void 0===$c&&($c=1),void 0===$d&&($d=1),void 0===$e&&($e=1),$f.__super.call(this),this._long=$c,this._width=$d,this._height=$e,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$p($f,"laya.d3.resource.models.BoxMesh",$Qd);var $d=$f.prototype;$d.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var $c=$Fc.vertexDeclaration,$d=($c.vertexStride,this._long/2),$e=this._height/2,$f=this._width/2,$g=new Float32Array([-$d,$e,-$f,0,1,0,0,0,$d,$e,-$f,0,1,0,1,0,$d,$e,$f,0,1,0,1,1,-$d,$e,$f,0,1,0,0,1,-$d,-$e,-$f,0,-1,0,0,1,$d,-$e,-$f,0,-1,0,1,1,$d,-$e,$f,0,-1,0,1,0,-$d,-$e,$f,0,-1,0,0,0,-$d,$e,-$f,-1,0,0,0,0,-$d,$e,$f,-1,0,0,1,0,-$d,-$e,$f,-1,0,0,1,1,-$d,-$e,-$f,-1,0,0,0,1,$d,$e,-$f,1,0,0,1,0,$d,$e,$f,1,0,0,0,0,$d,-$e,$f,1,0,0,0,1,$d,-$e,-$f,1,0,0,1,1,-$d,$e,$f,0,0,1,0,0,$d,$e,$f,0,0,1,1,0,$d,-$e,$f,0,0,1,1,1,-$d,-$e,$f,0,0,1,0,1,-$d,$e,-$f,0,0,-1,1,0,$d,$e,-$f,0,0,-1,0,0,$d,-$e,-$f,0,0,-1,0,1,-$d,-$e,-$f,0,0,-1,1,1]),$h=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new $Od($c,this._numberVertices,35044,!0),this._indexBuffer=new $Nd("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData($g),this._indexBuffer.setData($h),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$q(0,$d,"long",function(){return this._long},function($c){this._long!==$c&&(this._long=$c,this.releaseResource(),this.activeResource())}),$q(0,$d,"width",function(){return this._width},function($c){this._width!==$c&&(this._width=$c,this.releaseResource(),this.activeResource())}),$q(0,$d,"height",function(){return this._height},function($c){this._height!==$c&&(this._height=$c,this.releaseResource(),this.activeResource())})}(),function($c){function $i($c,$d,$e){void 0===$c&&($c=0),void 0===$d&&($d=.3),void 0===$e&&($e=1e3),this._viewMatrix=new $cd,this._projectionMatrix=new $cd,this._projectionViewMatrix=new $cd,this._viewport=new $kd(0,0,0,0),this._normalizedViewport=new $kd(0,0,1,1),this._aspectRatio=$c,this._boundFrustumUpdate=!0,this._boundFrustum=new $$c($cd.DEFAULT),$i.__super.call(this,$d,$e),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}$p($i,"laya.d3.core.Camera",$Ud);var $d=$i.prototype;return $d._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},$d._parseCustomProps=function($c,$d,$e,$f){var $g=$e.clearColor;this.clearColor=new $jd($g[0],$g[1],$g[2],$g[3]);var $h=$e.viewport;this.normalizedViewport=new $kd($h[0],$h[1],$h[2],$h[3])},$d._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var $c=this.orthographicVerticalSize*this.aspectRatio*.5,$d=.5*this.orthographicVerticalSize;$cd.createOrthoOffCenterRH(-$c,$c,-$d,$d,this.nearPlane,this.farPlane,this._projectionMatrix)}else $cd.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},$d._update=function($c){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,$c)},$d._renderCamera=function($c,$d,$e){var $f,$g;$e.parallelSplitShadowMaps[0]&&$e._renderShadowMap($c,$d,this),($d.camera=this)._prepareCameraToRender(),$e._preRenderUpdateComponents($d),$f=$d._viewMatrix=this.viewMatrix;var $h=this._renderTarget;$h?($h.start(),$cd.multiply($Ud._invertYScaleMatrix,this._projectionMatrix,$Ud._invertYProjectionMatrix),$cd.multiply($Ud._invertYScaleMatrix,this.projectionViewMatrix,$Ud._invertYProjectionViewMatrix),$g=$d._projectionMatrix=$Ud._invertYProjectionMatrix,$d._projectionViewMatrix=$Ud._invertYProjectionViewMatrix):($g=$d._projectionMatrix=this._projectionMatrix,$d._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject($f,$g),$d._viewport=this.viewport,$e._preRenderScene($c,$d,this.boundFrustum),$e._clear($c,$d),$e._renderScene($c,$d),$e._postRenderUpdateComponents($d),$h&&$h.end()},$d.viewportPointToRay=function($c,$d){$qd.calculateCursorRay($c,this.viewport,this._projectionMatrix,this.viewMatrix,null,$d)},$d.normalizedViewportPointToRay=function($c,$d){var $e=$i._tempVector20,$f=this.viewport,$g=$c.elements,$h=$e.elements;$h[0]=$g[0]*$f.width,$h[1]=$g[1]*$f.height,$qd.calculateCursorRay($e,this.viewport,this._projectionMatrix,this.viewMatrix,null,$d)},$d.worldToViewportPoint=function($c,$d){$cd.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project($c,this._projectionViewMatrix,$d);var $e=$d.elements;$e[0]=$e[0]/$x.stage.clientScaleX,$e[1]=$e[1]/$x.stage.clientScaleY},$d.worldToNormalizedViewportPoint=function($c,$d){$cd.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project($c,this._projectionViewMatrix,$d);var $e=$d.elements;$e[0]=$e[0]/$x.stage.clientScaleX,$e[1]=$e[1]/$x.stage.clientScaleY},$d.convertScreenCoordToOrthographicCoord=function($c,$d){if(this._orthographic){var $e=$Y.clientWidth,$f=$Y.clientHeight,$g=this.orthographicVerticalSize*this.aspectRatio/$e,$h=this.orthographicVerticalSize/$f,$i=$c.elements,$j=$d.elements;return $j[0]=(-$e/2+$i[0])*$g,$j[1]=($f/2-$i[1])*$h,$j[2]=(this.nearPlane-this.farPlane)*($i[2]+1)/2-this.nearPlane,$id.transformCoordinate($d,this.transform.worldMatrix,$d),!0}return!1},$q(0,$d,"projectionViewMatrix",function(){return $cd.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),$q(0,$d,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var $c=this.viewport;return $c.width/$c.height},function($c){if($c<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=$c,this._calculateProjectionMatrix()}),$q(0,$d,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),$q(0,$d,"needViewport",function(){var $c=this.normalizedViewport;return 0===$c.x&&0===$c.y&&1===$c.width&&1===$c.height}),$q(0,$d,"viewport",function(){if(this._viewportExpressedInClipSpace){var $c=this._normalizedViewport,$d=this.renderTargetSize,$e=$d.width,$f=$d.height;this._viewport.x=$c.x*$e,this._viewport.y=$c.y*$f,this._viewport.width=$c.width*$e,this._viewport.height=$c.height*$f}return this._viewport},function($c){if(null!=this.renderTarget&&($c.x<0||$c.y<0||0==$c.width||0==$c.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=$c,this._calculateProjectionMatrix()}),$q(0,$d,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var $c=this._viewport,$d=this.renderTargetSize,$e=$d.width,$f=$d.height;this._normalizedViewport.x=$c.x/$e,this._normalizedViewport.y=$c.y/$f,this._normalizedViewport.width=$c.width/$e,this._normalizedViewport.height=$c.height/$f}return this._normalizedViewport},function($c){$c.x<0&&($c.x=0,console.warn("Camera: viewport.x must large than 0.0.")),$c.y<0&&($c.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<$c.x+$c.width&&($c.width=1-$c.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<$c.y+$c.height&&($c.height=1-$c.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=$c,this._calculateProjectionMatrix()}),$q(0,$d,"projectionMatrix",function(){return this._projectionMatrix},function($c){this._projectionMatrix=$c,this._useUserProjectionMatrix=!0}),$q(0,$d,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),$n($i,["_tempVector20",function(){return this._tempVector20=new $hd}]),$i}()),$Xd=function($e){function $f($c,$d){$f.__super.call(this,$d),this._geometryFilter=new $Hd(this),this._render=new $Id(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),$c&&(this._geometryFilter.sharedMesh=$c)instanceof laya.d3.resource.models.Mesh&&($c.loaded?this._render.sharedMaterials=$c.materials:$c.once("loaded",this,this._applyMeshMaterials))}$p($f,"laya.d3.core.MeshSprite3D",$e);var $c=$f.prototype;return $c._changeRenderObjectByMesh=function($c){var $d=this._render._renderElements,$e=$d[$c];$e||($e=$d[$c]=new $zd),$e._render=this._render;var $f=this._render.sharedMaterials[$c];$f||($f=$Md.defaultMaterial);var $g=this._geometryFilter.sharedMesh.getRenderElement($c);return $e._mainSortID=this._getSortID($g,$f),$e._sprite3D=this,$e.renderObj=$g,$e._material=$f,$e},$c._changeRenderObjectByMaterial=function($c,$d){var $e=this._render._renderElements[$c];$d||($d=$Md.defaultMaterial);var $f=this._geometryFilter.sharedMesh.getRenderElement($c);return $e._mainSortID=this._getSortID($f,$d),$e._sprite3D=this,$e.renderObj=$f,$e._material=$d,$e},$c._changeRenderObjectsByMesh=function(){var $c=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=$c;for(var $d=0;$d<$c;$d++)this._changeRenderObjectByMesh($d)},$c._onMeshChanged=function($c){var $d=$c.sharedMesh;$d.loaded?this._changeRenderObjectsByMesh():$d.once("loaded",this,this._onMeshLoaded)},$c._onMeshLoaded=function($c){$c===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},$c._onMaterialChanged=function($c,$d,$e){$d<this._render._renderElements.length&&this._changeRenderObjectByMaterial($d,$e)},$c._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},$c._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},$c._parseCustomProps=function($c,$d,$e,$f){var $g=this.meshRender,$h=$e.lightmapIndex;null!=$h&&($g.lightmapIndex=$h);var $i,$j,$k=$e.lightmapScaleOffset;if($k&&($g.lightmapScaleOffset=new $jd($k[0],$k[1],$k[2],$k[3])),$f.instanceParams)($i=$f.instanceParams.loadPath)&&($j=$t.getRes($d[$i]),(this.meshFilter.sharedMesh=$j).loaded?$g.sharedMaterials=$j.materials:$j.once("loaded",this,this._applyMeshMaterials));else{($i=$e.meshPath)&&($j=$t.getRes($d[$i]),this.meshFilter.sharedMesh=$j);var $l=$e.materials;if($l){var $m=$g.sharedMaterials,$n=$l.length;$m.length=$n;for(var $o=0;$o<$n;$o++)$m[$o]=$t.getRes($d[$l[$o].path]);$g.sharedMaterials=$m}}},$c._applyMeshMaterials=function($c){for(var $d=this._render.sharedMaterials,$e=$c.materials,$f=0,$g=$e.length;$f<$g;$f++)$d[$f]||($d[$f]=$e[$f]);this._render.sharedMaterials=$d},$c._addToInitStaticBatchManager=function(){$f._staticBatchManager._addInitBatchSprite(this)},$c.cloneTo=function($c){var $d=$c;$d._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var $e=this._render,$f=$d._render;$f.enable=$e.enable,$f.sharedMaterials=$e.sharedMaterials,$f.castShadow=$e.castShadow;var $g=$e.lightmapScaleOffset;$g&&($f.lightmapScaleOffset=$g.clone()),$f.lightmapIndex=$e.lightmapIndex,$f.receiveShadow=$e.receiveShadow,$f.sortingFudge=$e.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,$c)},$c.destroy=function($c){if(void 0===$c&&($c=!0),!this.destroyed){var $d=this.meshFilter.sharedMesh;null!=$d&&($d.loaded||$d.off("loaded",this,this._applyMeshMaterials)),$e.prototype.destroy.call(this,$c),this._geometryFilter._destroy()}},$q(0,$c,"meshFilter",function(){return this._geometryFilter}),$q(0,$c,"meshRender",function(){return this._render}),$f.__init__=function(){$fc._staticBatchManagers.push($f._staticBatchManager)},$f.load=function($c){return $x.loader.create($c,null,null,$f)},$n($f,["_staticBatchManager",function(){return this._staticBatchManager=new $Bd}]),$f}($Vd)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($c,$d){"use strict";for(var $e in Object.defineProperty($d,"__esModule",{value:!0}),Laya){var $f=Laya[$e];$f&&$f.__isclass&&($d[$e]=$f)}}),function($c,$d,$gc){$gc.un,$gc.uns;var $e=$gc.static,$f=$gc.class,$h=$gc.getset,$r=$gc.__newvec,$j=laya.maths.Bezier,$n=laya.utils.Browser,$Fc=laya.utils.Byte,$g=(laya.events.Event,laya.events.EventDispatcher),$i=laya.display.Graphics,$k=(laya.resource.HTMLCanvas,laya.utils.Handler),$l=laya.net.Loader,$o=laya.maths.MathUtil,$Gc=laya.maths.Matrix,$s=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),$m=(laya.renders.RenderContext,laya.resource.Resource),$p=laya.utils.RunDriver,$hc=laya.display.Sprite,$q=laya.utils.Stat,$Hc=laya.resource.Texture,$t=(laya.net.URL,laya.utils.Utils),$G=function(){function $c(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return $f($c,"laya.ani.AnimationContent"),$c}(),$H=function(){function $c(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return $f($c,"laya.ani.AnimationNodeContent"),$c}(),$v=function(){function $c(){}return $f($c,"laya.ani.AnimationParser01"),$c.parse=function($c,$d){var $e=$d.__getBuffer(),$f=0,$g=0,$h=0,$i=0,$j=0,$k=0,$l=0,$m=$d.readUTFString();$c._aniClassName=$m;var $n,$o=$d.readUTFString().split("\n"),$p=$d.getUint8(),$q=$d.getUint32(),$r=$d.getUint32();0<$q&&($n=$e.slice($q,$r));var $s=new $Fc($n);for(0<$r&&($c._publicExtData=$e.slice($r,$e.byteLength)),$c._useParent=!!$d.getUint8(),$c._anis.length=$p,$f=0;$f<$p;$f++){var $t=$c._anis[$f]=new $G;$t.nodes=new Array;var $u=$t.name=$o[$d.getUint16()];$c._aniMap[$u]=$f,$t.bone3DMap={},$t.playTime=$d.getFloat32(),$t.playTime<=0&&console.error("播放时间不能为0  url="+$c.url+" name="+$t.name);var $v=$t.nodes.length=$d.getUint8();for($g=$t.totalKeyframeDatasLength=0;$g<$v;$g++){var $w=$t.nodes[$g]=new $H;$w.childs=[];var $x=$d.getInt16();0<=$x&&($w.name=$o[$x],$t.bone3DMap[$w.name]=$g),$w.keyFrame=new Array,$w.parentIndex=$d.getInt16(),-1==$w.parentIndex?$w.parent=null:$w.parent=$t.nodes[$w.parentIndex],$w.lerpType=$d.getUint8();var $y=$d.getUint32();$s.pos=$y;var $z=$w.keyframeWidth=$s.getUint16();if($t.totalKeyframeDatasLength+=$z,0===$w.lerpType||1===$w.lerpType)for($w.interpolationMethod=[],$w.interpolationMethod.length=$z,$h=0;$h<$z;$h++)$w.interpolationMethod[$h]=$K.interpolation[$s.getUint8()];null!=$w.parent&&$w.parent.childs.push($w);var $A=$d.getUint16();0<$A&&($w.extenData=$e.slice($d.pos,$d.pos+$A),$d.pos+=$A);var $B,$C=$d.getUint16(),$D=0;for($h=0,$i=$w.keyFrame.length=$C;$h<$i;$h++){if(($B=$w.keyFrame[$h]=new $I).duration=$d.getFloat32(),$B.startTime=$D,2===$w.lerpType){$B.interpolationData=[];var $E,$F=$d.getUint8();switch($E=$d.getFloat32()){case 254:for($B.interpolationData.length=$z,$l=0;$l<$z;$l++)$B.interpolationData[$l]=0;break;case 255:for($B.interpolationData.length=$z,$l=0;$l<$z;$l++)$B.interpolationData[$l]=5;break;default:for($B.interpolationData.push($E),$k=1;$k<$F;$k++)$B.interpolationData.push($d.getFloat32())}}for($B.data=new Float32Array($z),$j=0;$j<$z;$j++)$B.data[$j]=$d.getFloat32(),-1e-8<$B.data[$j]&&$B.data[$j]<1e-8&&($B.data[$j]=0);$D+=$B.duration}$B.startTime=$t.playTime,$w.playTime=$t.playTime,$c._calculateKeyFrame($w,$C,$z)}}},$c}(),$w=function(){function $x(){}return $f($x,"laya.ani.AnimationParser02"),$x.READ_DATA=function(){$x._DATA.offset=$x._reader.getUint32(),$x._DATA.size=$x._reader.getUint32()},$x.READ_BLOCK=function(){for(var $c=$x._BLOCK.count=$x._reader.getUint16(),$d=$x._BLOCK.blockStarts=[],$e=$x._BLOCK.blockLengths=[],$f=0;$f<$c;$f++)$d.push($x._reader.getUint32()),$e.push($x._reader.getUint32())},$x.READ_STRINGS=function(){var $c=$x._reader.getUint32(),$d=$x._reader.getUint16(),$e=$x._reader.pos;$x._reader.pos=$c+$x._DATA.offset;for(var $f=0;$f<$d;$f++)$x._strings[$f]=$x._reader.readUTFString();$x._reader.pos=$e},$x.parse=function($c,$d){$x._templet=$c;($x._reader=$d).__getBuffer();$x.READ_DATA(),$x.READ_BLOCK(),$x.READ_STRINGS();for(var $e=0,$f=$x._BLOCK.count;$e<$f;$e++){var $g=$d.getUint16(),$h=$x._strings[$g],$i=$x["READ_"+$h];if(null==$i)throw new Error("model file err,no this function:"+$g+" "+$h);$i.call()}},$x.READ_ANIMATIONS=function(){var $c=$x._reader,$d=$c.__getBuffer(),$e=0,$f=0,$g=0,$h=0,$i=$c.getUint16(),$j=[];for($j.length=$i,$e=0;$e<$i;$e++)$j[$e]=$K.interpolation[$c.getByte()];var $k=$c.getUint8();for($x._templet._anis.length=$k,$e=0;$e<$k;$e++){var $l=$x._templet._anis[$e]={};$l.nodes=new Array;var $m=$l.name=$x._strings[$c.getUint16()];$x._templet._aniMap[$m]=$e,$l.bone3DMap={},$l.playTime=$c.getFloat32();var $n=$l.nodes.length=$c.getInt16();for($f=$l.totalKeyframeDatasLength=0;$f<$n;$f++){var $o=$l.nodes[$f]={};$o.keyframeWidth=$i,$o.childs=[];var $p=$c.getUint16();0<=$p&&($o.name=$x._strings[$p],$l.bone3DMap[$o.name]=$f),$o.keyFrame=new Array,$o.parentIndex=$c.getInt16(),-1==$o.parentIndex?$o.parent=null:$o.parent=$l.nodes[$o.parentIndex],$l.totalKeyframeDatasLength+=$i,$o.interpolationMethod=$j,null!=$o.parent&&$o.parent.childs.push($o);var $q=$c.getUint16(),$r=null,$s=null;for($g=0,$h=$o.keyFrame.length=$q;$g<$h;$g++){($r=$o.keyFrame[$g]={}).startTime=$c.getFloat32(),$s&&($s.duration=$r.startTime-$s.startTime);var $t=$x._DATA.offset,$u=$c.getUint32(),$v=4*$i,$w=$d.slice($t+$u,$t+$u+$v);$r.data=new Float32Array($w),$s=$r}$r.duration=0,$o.playTime=$l.playTime,$x._templet._calculateKeyFrame($o,$q,$i)}}},$x._templet=null,$x._reader=null,$x._strings=[],$e($x,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$x}(),$Ic=(function(){function $c(){}$f($c,"laya.ani.AnimationState"),$c.stopped=0,$c.paused=1,$c.playing=2}(),function(){function $g(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new $Vc,this.resultMatrix=new $Gc,this._children=[]}$f($g,"laya.ani.bone.Bone");var $c=$g.prototype;return $c.setTempMatrix=function($c){this._tempMatrix=$c;var $d,$e=0;for($e=0,$d=this._children.length;$e<$d;$e++)this._children[$e].setTempMatrix(this._tempMatrix)},$c.update=function($c){var $d;if(this.rotation=this.transform.skX,$c)$d=this.resultTransform.getMatrix(),$Gc.mul($d,$c,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)$d=this.resultTransform.getMatrix(),$Gc.mul($d,this.parentBone.resultMatrix,this.resultMatrix);else{var $e=this.parentBone,$f=NaN,$g=NaN,$h=NaN,$i=this.parentBone.resultMatrix;$d=this.resultTransform.getMatrix();var $j=$i.a*$d.tx+$i.c*$d.ty+$i.tx,$k=$i.b*$d.tx+$i.d*$d.ty+$i.ty,$l=new $Gc;this.inheritRotation?($f=Math.atan2($e.resultMatrix.b,$e.resultMatrix.a),$g=Math.cos($f),$h=Math.sin($f),$l.setTo($g,$h,-$h,$g,0,0),$Gc.mul(this._tempMatrix,$l,$Gc.TEMP),$Gc.TEMP.copyTo($l),$d=this.resultTransform.getMatrix(),$Gc.mul($d,$l,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,$d=this.resultTransform.getMatrix(),$Gc.TEMP.identity(),$Gc.TEMP.d=this.d,$Gc.mul($d,$Gc.TEMP,this.resultMatrix)),this.resultMatrix.tx=$j,this.resultMatrix.ty=$k}else($d=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var $m,$n=0;for($n=0,$m=this._children.length;$n<$m;$n++)this._children[$n].update()},$c.updateChild=function(){var $c,$d=0;for($d=0,$c=this._children.length;$d<$c;$d++)this._children[$d].update()},$c.setRotation=function($c){this._sprite&&(this._sprite.rotation=180*$c/Math.PI)},$c.updateDraw=function($c,$d){$g.ShowBones&&!$g.ShowBones[this.name]||(this._sprite||(this._sprite=new $hc,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),$gc.stage.addChild(this._sprite)),this._sprite.x=$c+this.resultMatrix.tx,this._sprite.y=$d+this.resultMatrix.ty);var $e,$f=0;for($f=0,$e=this._children.length;$f<$e;$f++)this._children[$f].updateDraw($c,$d)},$c.addChild=function($c){this._children.push($c),$c.parentBone=this},$c.findBone=function($c){if(this.name==$c)return this;var $d,$e,$f=0;for($f=0,$d=this._children.length;$f<$d;$f++)if($e=this._children[$f].findBone($c))return $e;return null},$c.localToWorld=function($c){var $d=$c[0],$e=$c[1];$c[0]=$d*this.resultMatrix.a+$e*this.resultMatrix.c+this.resultMatrix.tx,$c[1]=$d*this.resultMatrix.b+$e*this.resultMatrix.d+this.resultMatrix.ty},$g.ShowBones={},$g}()),$Jc=function(){function $r(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}$f($r,"laya.ani.bone.BoneSlot");var $c=$r.prototype;return $c.showSlotData=function($c,$d){void 0===$d&&($d=!0),this.currSlotData=$c,$d&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},$c.showDisplayByName=function($c){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName($c))},$c.replaceDisplayByName=function($c,$d){if(this.currSlotData){var $e;$e=this.currSlotData.getDisplayByName($c);var $f;$f=this.currSlotData.getDisplayByName($d),this.replaceDisplayByIndex($e,$f)}},$c.replaceDisplayByIndex=function($c,$d){this.currSlotData&&(this._replaceDic[$c]=$d,this.displayIndex==$c&&this.showDisplayByIndex($c))},$c.showDisplayByIndex=function($c){if(null!=this._replaceDic[$c]&&($c=this._replaceDic[$c]),this.currSlotData&&-1<$c&&$c<this.currSlotData.displayArr.length){if(this.displayIndex=$c,this.currDisplayData=this.currSlotData.displayArr[$c],this.currDisplayData){var $d=this.currDisplayData.name;this.currTexture=this.templet.getTexture($d),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!$s.isConchApp||$s.isConchApp&&"0.9.15"<$hc.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},$c.replaceSkin=function($c){this._diyTexture=$c,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},$c.setParentMatrix=function($c){this._parentMatrix=$c},$c.draw=function($c,$d,$e,$f){if(void 0===$e&&($e=!1),void 0===$f&&($f=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var $g,$h=this.currTexture;switch(this._diyTexture&&($h=this._diyTexture),this.currDisplayData.type){case 0:if($c){var $i=this.getDisplayMatrix();if(this._parentMatrix){var $j=!1;if($i){var $k;if($Gc.mul($i,this._parentMatrix,$Gc.TEMP),$k=$e?(null==this._resultMatrix&&(this._resultMatrix=new $Gc),this._resultMatrix):new $Gc,!$s.isWebGL&&this.currDisplayData.uvs||$s.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var $l=$r._tempMatrix;$l.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($l.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($j=!0,$l.rotate(-Math.PI/2)),$Gc.mul($l,$Gc.TEMP,$k)}else $Gc.TEMP.copyTo($k);$j?$c.drawTexture($h,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,$k):$c.drawTexture($h,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,$k)}}}break;case 1:if(null==($g=$e?(null==this._skinSprite&&(this._skinSprite=$r.createSkinMesh()),this._skinSprite):$r.createSkinMesh()))return;var $m;if(null==this.currDisplayData.bones){var $n,$o=this.currDisplayData.weights;this.deformData&&($o=this.deformData),$n=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$z.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$z.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=$o;this.currDisplayData.triangles.length;$m=this.currDisplayData.triangles,$g.init2($h,null,$m,this._mVerticleArr,$n);var $p,$q=this.getDisplayMatrix();if(this._parentMatrix)if($q)$Gc.mul($q,this._parentMatrix,$Gc.TEMP),$p=$e?(null==this._resultMatrix&&(this._resultMatrix=new $Gc),this._resultMatrix):new $Gc,$Gc.TEMP.copyTo($p),$g.transform=$p}else this.skinMesh($d,$g,$f);$c.drawSkin($g);break;case 2:if(null==($g=$e?(null==this._skinSprite&&(this._skinSprite=$r.createSkinMesh()),this._skinSprite):$r.createSkinMesh()))return;this.skinMesh($d,$g,$f),$c.drawSkin($g)}}},$c.skinMesh=function($c,$d,$e){var $f,$g=this.currTexture,$h=this.currDisplayData.bones;$f=this._diyTexture?($g=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$z.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$z.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var $i,$j,$k=this.currDisplayData.weights,$l=this.currDisplayData.triangles,$m=0,$n=0,$o=0,$p=NaN,$q=NaN,$r=0,$s=0,$t=[],$u=0,$v=0;if(this.deformData&&0<this.deformData.length){var $w=0;for($u=0,$v=$h.length;$u<$v;){for($o=$h[$u++]+$u,$n=$m=0;$u<$o;$u++)$j=$c[$h[$u]],$p=$k[$r]+this.deformData[$w++],$q=$k[$r+1]+this.deformData[$w++],$s=$k[$r+2],$m+=($p*$j.a+$q*$j.c+$j.tx)*$s,$n+=($p*$j.b+$q*$j.d+$j.ty)*$s,$r+=3;$t.push($m,$n)}}else for($u=0,$v=$h.length;$u<$v;){for($o=$h[$u++]+$u,$n=$m=0;$u<$o;$u++)$j=$c[$h[$u]],$p=$k[$r],$q=$k[$r+1],$s=$k[$r+2],$m+=($p*$j.a+$q*$j.c+$j.tx)*$s,$n+=($p*$j.b+$q*$j.d+$j.ty)*$s,$r+=3;$t.push($m,$n)}this._mVerticleArr=$t,$i=$l,$d.init2($g,null,$i,this._mVerticleArr,$f)},$c.drawBonePoint=function($c){$c&&this._parentMatrix&&$c.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},$c.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},$c.getMatrix=function(){return this._resultMatrix},$c.copy=function(){var $c=new $r;return $c.type="copy",$c.name=this.name,$c.attachmentName=this.attachmentName,$c.srcDisplayIndex=this.srcDisplayIndex,$c.parent=this.parent,$c.displayIndex=this.displayIndex,$c.templet=this.templet,$c.currSlotData=this.currSlotData,$c.currTexture=this.currTexture,$c.currDisplayData=this.currDisplayData,$c},$r.createSkinMesh=function(){return $s.isWebGL||$s.isConchApp?$p.skinAniSprite():($s.isWebGL,null)},$e($r,["_tempMatrix",function(){return this._tempMatrix=new $Gc}]),$r}(),$Kc=function(){function $c(){this.skinName=null,this.deformSlotDataList=[]}return $f($c,"laya.ani.bone.DeformAniData"),$c}(),$Lc=function(){function $c(){this.deformSlotDisplayList=[]}return $f($c,"laya.ani.bone.DeformSlotData"),$c}(),$Mc=function(){function $c(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}$f($c,"laya.ani.bone.DeformSlotDisplayData");var $d=$c.prototype;return $d.binarySearch1=function($c,$d){var $e=0,$f=$c.length-2;if(0==$f)return 1;for(var $g=$f>>>1;;){if($c[Math.floor($g+1)]<=$d?$e=$g+1:$f=$g,$e==$f)return $e+1;$g=$e+$f>>>1}return 0},$d.apply=function($c,$d,$e){if(void 0===$e&&($e=1),$c+=.05,!(this.timeList.length<=0)){var $f=0;if(!($c<this.timeList[0])){var $g=this.vectices[0].length,$h=[],$i=this.binarySearch1(this.timeList,$c);if(this.frameIndex=$i,$c>=this.timeList[this.timeList.length-1]){var $j=this.vectices[this.vectices.length-1];if($e<1)for($f=0;$f<$g;$f++)$h[$f]+=($j[$f]-$h[$f])*$e;else for($f=0;$f<$g;$f++)$h[$f]=$j[$f];this.deformData=$h}else{this.tweenKeyList[this.frameIndex];var $k=this.vectices[this.frameIndex-1],$l=this.vectices[this.frameIndex],$m=this.timeList[this.frameIndex-1],$n=this.timeList[this.frameIndex];$e=this.tweenKeyList[$i-1]?($c-$m)/($n-$m):0;var $o=NaN;for($f=0;$f<$g;$f++)$o=$k[$f],$h[$f]=$o+($l[$f]-$o)*$e;this.deformData=$h}}}},$c}(),$Nc=function(){function $c(){this.time=NaN,this.drawOrder=[]}return $f($c,"laya.ani.bone.DrawOrderData"),$c}(),$Oc=function(){function $c(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return $f($c,"laya.ani.bone.EventData"),$c}(),$u=function(){function $fc($c,$d){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=$c,this._targetBone=$d[$c.targetBoneIndex],this.isSpine=$c.isSpine,null==this._bones&&(this._bones=[]);for(var $e=this._bones.length=0,$f=$c.boneIndexs.length;$e<$f;$e++)this._bones.push($d[$c.boneIndexs[$e]]);this.name=$c.name,this.mix=$c.mix,this.bendDirection=$c.bendDirection}$f($fc,"laya.ani.bone.IkConstraint");var $c=$fc.prototype;return $c.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},$c._applyIk1=function($c,$d,$e,$f){var $g=$c.parentBone,$h=1/($g.resultMatrix.a*$g.resultMatrix.d-$g.resultMatrix.b*$g.resultMatrix.c),$i=$d-$g.resultMatrix.tx,$j=$e-$g.resultMatrix.ty,$k=($i*$g.resultMatrix.d-$j*$g.resultMatrix.c)*$h-$c.transform.x,$l=($j*$g.resultMatrix.a-$i*$g.resultMatrix.b)*$h-$c.transform.y,$m=Math.atan2($l,$k)*$fc.radDeg-0-$c.transform.skX;$c.transform.scX<0&&($m+=180),180<$m?$m-=360:$m<-180&&($m+=360),$c.transform.skX=$c.transform.skY=$c.transform.skX+$m*$f,$c.update()},$c.updatePos=function($c,$d){this._sp&&this._sp.pos($c,$d)},$c._applyIk2=function($c,$d,$e,$f,$g,$h){if(0!=$h){var $i=$c.resultTransform.x,$j=$c.resultTransform.y,$k=$c.transform.scX,$l=$c.transform.scY,$m=$d.transform.scX,$n=0,$o=0,$p=0;$p=$k<0?($k=-$k,$n=180,-1):($n=0,1),$l<0&&($l=-$l,$p=-$p),$o=$m<0?($m=-$m,180):0;var $q=$d.resultTransform.x,$r=NaN,$s=NaN,$t=NaN,$u=$c.resultMatrix.a,$v=$c.resultMatrix.c,$w=$c.resultMatrix.b,$x=$c.resultMatrix.d,$y=Math.abs($k-$l)<=1e-4;$t=$y?($s=$u*$q+$v*($r=$d.resultTransform.y)+$c.resultMatrix.tx,$w*$q+$x*$r+$c.resultMatrix.ty):($r=0,$s=$u*$q+$c.resultMatrix.tx,$w*$q+$c.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new $hc,$gc.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($e,$f,15,"#ffff00"),this._sp.graphics.drawCircle($s,$t,15,"#ff00ff")),$c.setRotation(Math.atan2($t-$c.resultMatrix.ty,$s-$c.resultMatrix.tx));var $z=$c.parentBone;$u=$z.resultMatrix.a,$v=$z.resultMatrix.c,$w=$z.resultMatrix.b;var $A=1/($u*($x=$z.resultMatrix.d)-$v*$w),$B=$e-$z.resultMatrix.tx,$C=$f-$z.resultMatrix.ty,$D=($B*$x-$C*$v)*$A-$i,$E=($C*$u-$B*$w)*$A-$j,$F=(($B=$s-$z.resultMatrix.tx)*$x-($C=$t-$z.resultMatrix.ty)*$v)*$A-$i,$G=($C*$u-$B*$w)*$A-$j,$H=Math.sqrt($F*$F+$G*$G),$I=$d.length*$m,$J=NaN,$K=NaN;if($y){var $L=($D*$D+$E*$E-$H*$H-($I*=$k)*$I)/(2*$H*$I);$L<-1?$L=-1:1<$L&&($L=1),$K=Math.acos($L)*$g,$u=$H+$I*$L,$v=$I*Math.sin($K),$J=Math.atan2($E*$u-$D*$v,$D*$u+$E*$v)}else{var $M=($u=$k*$I)*$u,$N=($v=$l*$I)*$v,$O=$D*$D+$E*$E,$P=Math.atan2($E,$D),$Q=-2*$N*$H,$R=$N-$M;if(0<($x=$Q*$Q-4*$R*($w=$N*$H*$H+$M*$O-$M*$N))){var $S=Math.sqrt($x);$Q<0&&($S=-$S);var $T=($S=-($Q+$S)/2)/$R,$U=$w/$S,$V=Math.abs($T)<Math.abs($U)?$T:$U;$V*$V<=$O&&($C=Math.sqrt($O-$V*$V)*$g,$J=$P-Math.atan2($C,$V),$K=Math.atan2($C/$l,($V-$H)/$k))}var $W=0,$X=Number.MAX_VALUE,$Y=0,$Z=0,$$=0,$_=0,$a=0,$b=0;$_<($x=($B=$H+$u)*$B)&&($$=0,$_=$x,$a=$B),($x=($B=$H-$u)*$B)<$X&&($W=Math.PI,$X=$x,$Y=$B);var $cc=Math.acos(-$u*$H/($M-$N));($x=($B=$u*Math.cos($cc)+$H)*$B+($C=$v*Math.sin($cc))*$C)<$X&&($W=$cc,$X=$x,$Y=$B,$Z=$C),$_<$x&&($$=$cc,$_=$x,$a=$B,$b=$C),$K=$O<=($X+$_)/2?($J=$P-Math.atan2($Z*$g,$Y),$W*$g):($J=$P-Math.atan2($b*$g,$a),$$*$g)}var $dc=Math.atan2($r,$q)*$p,$ec=$c.resultTransform.skX;180<($J=($J-$dc)*$fc.radDeg+$n-$ec)?$J-=360:$J<-180&&($J+=360),$c.resultTransform.x=$i,$c.resultTransform.y=$j,$c.resultTransform.skX=$c.resultTransform.skY=$ec+$J*$h,$ec=$d.resultTransform.skX,180<($K=(($K+$dc)*$fc.radDeg-0)*$p+$o-($ec%=360))?$K-=360:$K<-180&&($K+=360),$d.resultTransform.x=$q,$d.resultTransform.y=$r,$d.resultTransform.skX=$d.resultTransform.skY=$d.resultTransform.skY+$K*$h,$c.update()}},$c._applyIk3=function($c,$d,$e,$f,$g,$h){if(0!=$h){var $i,$j,$k=$d.resultMatrix.a*$d.length,$l=$d.resultMatrix.b*$d.length,$m=$k*$k+$l*$l,$n=Math.sqrt($m),$o=$c.resultMatrix.tx,$p=$c.resultMatrix.ty,$q=$d.resultMatrix.tx,$r=$d.resultMatrix.ty,$s=$q-$o,$t=$r-$p,$u=$s*$s+$t*$t,$v=Math.sqrt($u),$w=($s=$e-$c.resultMatrix.tx)*$s+($t=$f-$c.resultMatrix.ty)*$t,$x=Math.sqrt($w);if($n+$v<=$x||$x+$n<=$v||$x+$v<=$n){var $y=NaN;$q=$o+($y=$n+$v<=$x?1:-1)*($e-$o)*$v/$x,$r=$p+$y*($f-$p)*$v/$x}else{var $z=($u-$m+$w)/(2*$w),$A=Math.sqrt($u-$z*$z*$w)/$x,$B=$o+$s*$z,$C=$p+$t*$z,$D=-$t*$A,$E=$s*$A;$r=0<$g?($q=$B-$D,$C-$E):($q=$B+$D,$C+$E)}$i=$q,$j=$r,this.isDebug&&(this._sp||(this._sp=new $hc,$gc.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($o,$p,15,"#ff00ff"),this._sp.graphics.drawCircle($e,$f,15,"#ffff00"),this._sp.graphics.drawCircle($i,$j,15,"#ff00ff"));var $F,$G;$F=Math.atan2($j-$c.resultMatrix.ty,$i-$c.resultMatrix.tx),$c.setRotation($F),($G=$fc._tempMatrix).identity(),$G.rotate($F),$G.scale($c.resultMatrix.getScaleX(),$c.resultMatrix.getScaleY()),$G.translate($c.resultMatrix.tx,$c.resultMatrix.ty),$G.copyTo($c.resultMatrix),$c.updateChild();var $H,$I;$H=Math.atan2($f-$j,$e-$i),$d.setRotation($H),($I=$fc._tempMatrix).identity(),$I.rotate($H),$I.scale($d.resultMatrix.getScaleX(),$d.resultMatrix.getScaleY()),$I.translate($i,$j),$G.copyTo($d.resultMatrix),$d.updateChild()}},$e($fc,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new $Gc}]),$fc}(),$Pc=function(){function $c(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return $f($c,"laya.ani.bone.IkConstraintData"),$c}(),$x=function(){function $I($c,$d){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=$c,this.position=$c.position,this.spacing=$c.spacing,this.rotateMix=$c.rotateMix,this.translateMix=$c.translateMix,this.bones=[];for(var $e=this.data.bones,$f=0,$g=$e.length;$f<$g;$f++)this.bones.push($d[$e[$f]])}$f($I,"laya.ani.bone.PathConstraint");var $c=$I.prototype;return $c.apply=function($c,$d){if(this.target){var $e=this.translateMix,$f=this.translateMix,$g=0<$f,$h=this.data.spacingMode,$i="length"==$h,$j=this.data.rotateMode,$k="tangent"==$j,$l="chainScale"==$j,$m=[],$n=this.bones.length,$o=$k?$n:$n+1,$p=[];(this._spaces=$p)[0]=this.position;var $q=this.spacing;if($l||$i)for(var $r=0,$s=$o-1;$r<$s;){var $t=this.bones[$r],$u=$t.length,$v=$u*$t.resultMatrix.a,$w=$u*$t.resultMatrix.b;$u=Math.sqrt($v*$v+$w*$w),$l&&($m[$r]=$u),$p[++$r]=$i?Math.max(0,$u+$q):$q}else for($r=1;$r<$o;$r++)$p[$r]=$q;var $x=this.computeWorldPositions(this.target,$c,$d,$o,$k,"percent"==this.data.positionMode,"percent"==$h);if(this._debugKey){for($r=0;$r<$x.length;$r++)$d.drawCircle($x[$r++],$x[$r++],5,"#00ff00");var $y=[];for($r=0;$r<$x.length;$r++)$y.push($x[$r++],$x[$r++]);$d.drawLines(0,0,$y,"#ff0000")}var $z=$x[0],$A=$x[1],$B=this.data.offsetRotation,$C="chain"==$j&&0==$B,$D=NaN;for($r=0,$D=3;$r<$n;$r++,$D+=3){($t=this.bones[$r]).resultMatrix.tx+=($z-$t.resultMatrix.tx)*$e,$t.resultMatrix.ty+=($A-$t.resultMatrix.ty)*$e;var $E=($v=$x[$D])-$z,$F=($w=$x[$D+1])-$A;if($l&&0!=($u=$m[$r])){var $G=(Math.sqrt($E*$E+$F*$F)/$u-1)*$f+1;$t.resultMatrix.a*=$G,$t.resultMatrix.c*=$G}if($z=$v,$A=$w,$g){var $H=$t.resultMatrix.a,$I=$t.resultMatrix.c,$J=$t.resultMatrix.b,$K=$t.resultMatrix.d,$L=NaN,$M=NaN,$N=NaN;$L=$k?$x[$D-1]:0==$p[$r+1]?$x[$D+2]:Math.atan2($F,$E),$L-=Math.atan2($J,$H)-$B/180*Math.PI,$C&&($M=Math.cos($L),$N=Math.sin($L),$z+=(($u=$t.length)*($M*$H-$N*$J)-$E)*$f,$A+=($u*($N*$H+$M*$J)-$F)*$f),$L>Math.PI?$L-=2*Math.PI:$L<-Math.PI&&($L+=2*Math.PI),$L*=$f,$M=Math.cos($L),$N=Math.sin($L),$t.resultMatrix.a=$M*$H-$N*$J,$t.resultMatrix.c=$M*$I-$N*$K,$t.resultMatrix.b=$N*$H+$M*$J,$t.resultMatrix.d=$N*$I+$M*$K}}}},$c.computeWorldVertices2=function($c,$d,$e,$f,$g,$h){var $i,$j,$k=$c.currDisplayData.bones,$l=$c.currDisplayData.weights,$m=$c.currDisplayData.triangles,$n=0,$o=0,$p=0,$q=0,$r=0,$s=0,$t=0,$u=0,$v=0,$w=0,$x=0;if(null!=$k){for($n=0;$n<$e;$n+=2)$o+=($q=$k[$o])+1,$p+=$q;var $y=$d;for($r=$h,$s=3*$p;$r<$f;$r+=2){for($u=$t=0,$q=$k[$o++],$q+=$o;$o<$q;$o++,$s+=3){$i=$y[$k[$o]].resultMatrix,$v=$l[$s],$w=$l[$s+1];var $z=$l[$s+2];$t+=($v*$i.a+$w*$i.c+$i.tx)*$z,$u+=($v*$i.b+$w*$i.d+$i.ty)*$z}$g[$r]=$t,$g[$r+1]=$u}}else{var $A,$B;if($m||($m=$l),$c.deformData&&($m=$c.deformData),$A=$c.parent,$d)for($x=$d.length,$n=0;$n<$x;$n++)if($d[$n].name==$A){$j=$d[$n];break}$j&&($B=$j.resultMatrix),$B||($B=$I._tempMt);var $C=$B.tx,$D=$B.ty,$E=$B.a,$F=$B.b,$G=$B.c,$H=$B.d;for($j&&($H*=$j.d),$o=$e,$r=$h;$r<$f;$o+=2,$r+=2)$v=$m[$o],$w=$m[$o+1],$g[$r]=$v*$E+$w*$F+$C,$g[$r+1]=-($v*$G+$w*$H+$D)}},$c.computeWorldPositions=function($c,$d,$e,$f,$g,$h,$i){$c.currDisplayData.bones,$c.currDisplayData.weights,$c.currDisplayData.triangles;var $j=[],$k=0,$l=$c.currDisplayData.verLen,$m=this.position,$n=this._spaces,$o=[],$p=[],$q=$l/6,$r=-1,$s=NaN,$t=0,$u=0,$v=NaN,$w=NaN,$x=NaN,$y=NaN;if($q--,$l-=4,this.computeWorldVertices2($c,$d,2,$l,$j,0),this._debugKey)for($k=0;$k<$j.length;)$e.drawCircle($j[$k++],$j[$k++],10,"#ff0000");$o=$j,this._curves.length=$q;var $z=this._curves,$A=$o[$s=0],$B=$o[1],$C=0,$D=0,$E=0,$F=0,$G=0,$H=0,$I=NaN,$J=NaN,$K=NaN,$L=NaN,$M=NaN,$N=NaN,$O=NaN,$P=NaN,$Q=0;for($k=0,$Q=2;$k<$q;$k++,$Q+=6)$C=$o[$Q],$D=$o[$Q+1],$E=$o[$Q+2],$F=$o[$Q+3],$M=2*($I=.1875*($A-2*$C+$E))+($K=.09375*(3*($C-$E)-$A+($G=$o[$Q+4]))),$N=2*($J=.1875*($B-2*$D+$F))+($L=.09375*(3*($D-$F)-$B+($H=$o[$Q+5]))),$O=.75*($C-$A)+$I+.16666667*$K,$P=.75*($D-$B)+$J+.16666667*$L,$s+=Math.sqrt($O*$O+$P*$P),$O+=$M,$P+=$N,$M+=$K,$N+=$L,$s+=Math.sqrt($O*$O+$P*$P),$O+=$M,$P+=$N,$s+=Math.sqrt($O*$O+$P*$P),$O+=$M+$K,$P+=$N+$L,$s+=Math.sqrt($O*$O+$P*$P),$z[$k]=$s,$A=$G,$B=$H;if($h&&($m*=$s),$i)for($k=0;$k<$f;$k++)$n[$k]*=$s;var $R=this._segments,$S=0,$T=0;for($T=$u=$t=$k=0;$k<$f;$k++,$t+=3)if(($v=$m+=$w=$n[$k])<0)this.addBeforePosition($v,$o,0,$p,$t);else if($s<$v)this.addAfterPosition($v-$s,$o,$l-4,$p,$t);else{for(;;$u++)if(!(($y=$z[$u])<$v)){0==$u?$v/=$y:$v=($v-($x=$z[$u-1]))/($y-$x);break}if($u!=$r){var $U=6*($r=$u);for($A=$o[$U],$B=$o[$U+1],$C=$o[$U+2],$D=$o[$U+3],$E=$o[$U+4],$F=$o[$U+5],$M=2*($I=.03*($A-2*$C+$E))+($K=.006*(3*($C-$E)-$A+($G=$o[$U+6]))),$N=2*($J=.03*($B-2*$D+$F))+($L=.006*(3*($D-$F)-$B+($H=$o[$U+7]))),$O=.3*($C-$A)+$I+.16666667*$K,$P=.3*($D-$B)+$J+.16666667*$L,$S=Math.sqrt($O*$O+$P*$P),$R[0]=$S,$U=1;$U<8;$U++)$O+=$M,$P+=$N,$M+=$K,$N+=$L,$S+=Math.sqrt($O*$O+$P*$P),$R[$U]=$S;$O+=$M,$P+=$N,$S+=Math.sqrt($O*$O+$P*$P),$R[8]=$S,$O+=$M+$K,$P+=$N+$L,$S+=Math.sqrt($O*$O+$P*$P),$R[9]=$S,$T=0}for($v*=$S;;$T++)if(!(($y=$R[$T])<$v)){0==$T?$v/=$y:$v=$T+($v-($x=$R[$T-1]))/($y-$x);break}this.addCurvePosition(.1*$v,$A,$B,$C,$D,$E,$F,$G,$H,$p,$t,$g||0<$k&&0==$w)}return $p},$c.addBeforePosition=function($c,$d,$e,$f,$g){var $h=$d[$e],$i=$d[$e+1],$j=$d[$e+2]-$h,$k=$d[$e+3]-$i,$l=Math.atan2($k,$j);$f[$g]=$h+$c*Math.cos($l),$f[$g+1]=$i+$c*Math.sin($l),$f[$g+2]=$l},$c.addAfterPosition=function($c,$d,$e,$f,$g){var $h=$d[$e+2],$i=$d[$e+3],$j=$h-$d[$e],$k=$i-$d[$e+1],$l=Math.atan2($k,$j);$f[$g]=$h+$c*Math.cos($l),$f[$g+1]=$i+$c*Math.sin($l),$f[$g+2]=$l},$c.addCurvePosition=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m,$n){0==$c&&($c=1e-4);var $o=$c*$c,$p=$o*$c,$q=1-$c,$r=$q*$q,$s=$r*$q,$t=$q*$c,$u=3*$t,$v=$q*$u,$w=$u*$c,$x=$d*$s+$f*$v+$h*$w+$j*$p,$y=$e*$s+$g*$v+$i*$w+$k*$p;$l[$m]=$x,$l[$m+1]=$y,$l[$m+2]=$n?Math.atan2($y-($e*$r+$g*$t*2+$i*$o),$x-($d*$r+$f*$t*2+$h*$o)):0},$I.NONE=-1,$I.BEFORE=-2,$I.AFTER=-3,$e($I,["_tempMt",function(){return this._tempMt=new $Gc}]),$I}(),$Qc=function(){function $c(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return $f($c,"laya.ani.bone.PathConstraintData"),$c}(),$Rc=function(){function $c(){this.name=null,this.slotArr=[]}return $f($c,"laya.ani.bone.SkinData"),$c}(),$Sc=function(){function $c(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}$f($c,"laya.ani.bone.SkinSlotDisplayData");var $d=$c.prototype;return $d.createTexture=function($c){return this.texture||(this.texture=new $Hc($c.bitmap,this.uvs),$c.bitmap.alphaTexture&&(this.texture.alphaTexture=new $Hc($c.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=$c.height,this.texture.height=$c.width,this.texture.offsetX=-$c.offsetX,this.texture.offsetY=-$c.offsetY,this.texture.sourceWidth=$c.sourceHeight,this.texture.sourceHeight=$c.sourceWidth):(this.texture.width=$c.width,this.texture.height=$c.height,this.texture.offsetX=-$c.offsetX,this.texture.offsetY=-$c.offsetY,this.texture.sourceWidth=$c.sourceWidth,this.texture.sourceHeight=$c.sourceHeight),$s.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},$d.destory=function(){this.texture&&this.texture.destroy()},$c}(),$Tc=function(){function $c(){this.name=null,this.displayArr=[]}return $f($c,"laya.ani.bone.SlotData"),$c.prototype.getDisplayByName=function($c){for(var $d=0,$e=this.displayArr.length;$d<$e;$d++)if(this.displayArr[$d].attachmentName==$c)return $d;return-1},$c}(),$y=function(){function $c($c,$d){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=$r(2,0),this._data=$c,null==this._bones&&(this._bones=[]),this.target=$d[$c.targetIndex];var $e,$f=0;for($f=0,$e=$c.boneIndexs.length;$f<$e;$f++)this._bones.push($d[$c.boneIndexs[$f]]);this.rotateMix=$c.rotateMix,this.translateMix=$c.translateMix,this.scaleMix=$c.scaleMix,this.shearMix=$c.shearMix}return $f($c,"laya.ani.bone.TfConstraint"),$c.prototype.apply=function(){for(var $c,$d=this.target.resultMatrix.a,$e=this.target.resultMatrix.b,$f=this.target.resultMatrix.c,$g=this.target.resultMatrix.d,$h=0,$i=this._bones.length;$h<$i;$h++){if($c=this._bones[$h],0<this.rotateMix){var $j=$c.resultMatrix.a,$k=$c.resultMatrix.b,$l=$c.resultMatrix.c,$m=$c.resultMatrix.d,$n=Math.atan2($f,$d)-Math.atan2($l,$j)+this._data.offsetRotation*Math.PI/180;$n>Math.PI?$n-=2*Math.PI:$n<-Math.PI&&($n+=2*Math.PI),$n*=this.rotateMix;var $o=Math.cos($n),$p=Math.sin($n);$c.resultMatrix.a=$o*$j-$p*$l,$c.resultMatrix.b=$o*$k-$p*$m,$c.resultMatrix.c=$p*$j+$o*$l,$c.resultMatrix.d=$p*$k+$o*$m}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),$c.resultMatrix.tx+=(this._temp[0]-$c.resultMatrix.tx)*this.translateMix,$c.resultMatrix.ty+=(this._temp[1]-$c.resultMatrix.ty)*this.translateMix,$c.updateChild()),0<this.scaleMix){var $q=Math.sqrt($c.resultMatrix.a*$c.resultMatrix.a+$c.resultMatrix.c*$c.resultMatrix.c),$r=Math.sqrt($d*$d+$f*$f),$s=1e-5<$q?($q+($r-$q+this._data.offsetScaleX)*this.scaleMix)/$q:0;$c.resultMatrix.a*=$s,$c.resultMatrix.c*=$s,$q=Math.sqrt($c.resultMatrix.b*$c.resultMatrix.b+$c.resultMatrix.d*$c.resultMatrix.d),$r=Math.sqrt($e*$e+$g*$g),$s=1e-5<$q?($q+($r-$q+this._data.offsetScaleY)*this.scaleMix)/$q:0,$c.resultMatrix.b*=$s,$c.resultMatrix.d*=$s}if(0<this.shearMix){$k=$c.resultMatrix.b,$m=$c.resultMatrix.d;var $t=Math.atan2($m,$k);($n=Math.atan2($g,$e)-Math.atan2($f,$d)-($t-Math.atan2($c.resultMatrix.c,$c.resultMatrix.a)))>Math.PI?$n-=2*Math.PI:$n<-Math.PI&&($n+=2*Math.PI),$n=$t+($n+this._data.offsetShearY*Math.PI/180)*this.shearMix,$s=Math.sqrt($k*$k+$m*$m),$c.resultMatrix.b=Math.cos($n)*$s,$c.resultMatrix.d=Math.sin($n)*$s}}},$c}(),$Uc=function(){function $c(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return $f($c,"laya.ani.bone.TfConstraintData"),$c}(),$Vc=function(){function $c(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}$f($c,"laya.ani.bone.Transform");var $d=$c.prototype;return $d.initData=function($c){null!=$c.x&&(this.x=$c.x),null!=$c.y&&(this.y=$c.y),null!=$c.skX&&(this.skX=$c.skX),null!=$c.skY&&(this.skY=$c.skY),null!=$c.scX&&(this.scX=$c.scX),null!=$c.scY&&(this.scY=$c.scY)},$d.getMatrix=function(){var $c;return($c=this.mMatrix?this.mMatrix:this.mMatrix=new $Gc).identity(),$c.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew($c,this.skewX*Math.PI/180,this.skewY*Math.PI/180),$c.rotate(this.skX*Math.PI/180),$c.translate(this.x,this.y),$c},$d.skew=function($c,$d,$e){var $f=Math.sin($e),$g=Math.cos($e),$h=Math.sin($d),$i=Math.cos($d);return $c.setTo($c.a*$i-$c.b*$f,$c.a*$h+$c.b*$g,$c.c*$i-$c.d*$f,$c.c*$h+$c.d*$g,$c.tx*$i-$c.ty*$f,$c.tx*$h+$c.ty*$g),$c},$c}(),$z=function(){function $c(){}return $f($c,"laya.ani.bone.UVTools"),$c.getRelativeUV=function($c,$d,$e){var $f=$c[0],$g=$c[2]-$c[0],$h=$c[1],$i=$c[5]-$c[1];$e||($e=[]),$e.length=$d.length;var $j,$k=0;$j=$e.length;var $l=1/$g,$m=1/$i;for($k=0;$k<$j;$k+=2)$e[$k]=($d[$k]-$f)*$l,$e[$k+1]=($d[$k+1]-$h)*$m;return $e},$c.getAbsoluteUV=function($c,$d,$e){if(0==$c[0]&&0==$c[1]&&1==$c[4]&&1==$c[5])return $e?($t.copyArray($e,$d),$e):$d;var $f=$c[0],$g=$c[2]-$c[0],$h=$c[1],$i=$c[5]-$c[1];$e||($e=[]),$e.length=$d.length;var $j,$k=0;for($j=$e.length,$k=0;$k<$j;$k+=2)$e[$k]=$d[$k]*$g+$f,$e[$k+1]=$d[$k+1]*$i+$h;return $e},$c}(),$I=function(){function $c(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return $f($c,"laya.ani.KeyFramesContent"),$c}(),$A=function(){function $m(){}return $f($m,"laya.ani.math.BezierLerp"),$m.getBezierRate=function($c,$d,$e,$f,$g){var $h=$m._getBezierParamKey($d,$e,$f,$g),$i=100*$h+$c;if($m._bezierResultCache[$i])return $m._bezierResultCache[$i];var $j,$k=$m._getBezierPoints($d,$e,$f,$g,$h),$l=0;for($j=$k.length,$l=0;$l<$j;$l+=2)if($c<=$k[$l])return $m._bezierResultCache[$i]=$k[$l+1],$k[$l+1];return $m._bezierResultCache[$i]=1},$m._getBezierParamKey=function($c,$d,$e,$f){return 100*(100*(100*(100*$c+$d)+$e)+$f)},$m._getBezierPoints=function($c,$d,$e,$f,$g){return $m._bezierPointsCache[$g]?$m._bezierPointsCache[$g]:($h=[0,0,$c,$d,$e,$f,1,1],$i=(new $j).getBezierPoints($h,100,3),$m._bezierPointsCache[$g]=$i);var $h,$i},$m._bezierResultCache={},$m._bezierPointsCache={},$m}(),$B=function($c){function $d(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,$d.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}$f($d,"laya.ani.AnimationPlayer",$g);var $e=$d.prototype;return $gc.imps($e,{"laya.resource.IDestroy":!0}),$e._onTempletLoadedComputeFullKeyframeIndices=function($c,$d,$e){this._templet===$e&&this._cachePlayRate===$c&&this._cacheFrameRate===$d&&this._computeFullKeyframeIndices()},$e._computeFullKeyframeIndices=function(){for(var $c=this._fullFrames=[],$d=this._templet,$e=this._cacheFrameRateInterval*this._cachePlayRate,$f=0,$g=$d.getAnimationCount();$f<$g;$f++){for(var $h=[],$i=0,$j=$d.getAnimation($f).nodes.length;$i<$j;$i++){for(var $k=$d.getAnimation($f).nodes[$i],$l=Math.floor($k.playTime/$e+.01),$m=new Uint16Array($l+1),$n=-1,$o=0,$p=$k.keyFrame.length;$o<$p;$o++){var $q=$k.keyFrame[$o],$r=$q.startTime,$s=$r+$q.duration+$e;do{for(var $t=Math.floor($r/$e+.5),$u=$n+1;$u<$t;$u++)$m[$u]=$o;$m[$n=$t]=$o,$r+=$e}while($r<=$s)}$h.push($m)}$c.push($h)}},$e._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},$e._calculatePlayDuration=function(){if(0!==this.state){var $c=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=$c),this._playEnd>$c&&(this._playEnd=$c),this._playDuration=this._playEnd-this._playStart}},$e._setPlayParams=function($c,$d){this._currentTime=$c,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$d+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$d},$e._setPlayParamsWhenStop=function($c,$d){this._currentTime=$c,this._currentKeyframeIndex=Math.max(Math.floor($c/$d+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$d,this._currentAnimationClipIndex=-1},$e._update=function($c){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var $d=this._cacheFrameRateInterval*this._cachePlayRate,$e=0;this._startUpdateLoopCount!==$q.loopCount&&($e=$c*this.playbackRate,this._elapsedPlaybackTime+=$e);var $f=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=$f)return this._setPlayParamsWhenStop($f,$d),void this.event("stopped");if($e+=this._currentTime,0<$f)if($f<=$e)do{if($e-=$f,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($f,$d),this._stopWhenCircleFinish=!1,void this.event("stopped");$e<$f&&(this._setPlayParams($e,$d),this.event("complete"))}while($f<=$e);else this._setPlayParams($e,$d);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($f,$d),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},$e._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},$e.play=function($c,$d,$e,$f,$g){if(void 0===$c&&($c=0),void 0===$d&&($d=1),void 0===$e&&($e=2147483647),void 0===$f&&($f=0),void 0===$g&&($g=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if($e<0||$f<0||$g<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==$g&&$g<$f)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=$d,this._overallDuration=$e,this._playStart=$f,this._playEnd=$g,this._paused=!1,this._currentAnimationClipIndex=$c,this._currentKeyframeIndex=0,this._startUpdateLoopCount=$q.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},$e.playByFrame=function($c,$d,$e,$f,$g,$h){void 0===$c&&($c=0),void 0===$d&&($d=1),void 0===$e&&($e=2147483647),void 0===$f&&($f=0),void 0===$g&&($g=0),void 0===$h&&($h=30);var $i=1e3/$h;this.play($c,$d,$e,$f*$i,$g*$i)},$e.stop=function($c){void 0===$c&&($c=!0),$c?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},$h(0,$e,"playEnd",function(){return this._playEnd}),$h(0,$e,"templet",function(){return this._templet},function($c){0===!this.state&&this.stop(!0),this._templet!==$c&&((this._templet=$c).loaded?this._computeFullKeyframeIndices():$c.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),$h(0,$e,"playStart",function(){return this._playStart}),$h(0,$e,"playDuration",function(){return this._playDuration}),$h(0,$e,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),$h(0,$e,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),$h(0,$e,"overallDuration",function(){return this._overallDuration}),$h(0,$e,"currentFrameTime",function(){return this._currentFrameTime}),$h(0,$e,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),$h(0,$e,"currentPlayTime",function(){return this._currentTime+this._playStart}),$h(0,$e,"cachePlayRate",function(){return this._cachePlayRate},function($c){this._cachePlayRate!==$c&&(this._cachePlayRate=$c,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[$c,this._cacheFrameRate])))}),$h(0,$e,"cacheFrameRate",function(){return this._cacheFrameRate},function($c){this._cacheFrameRate!==$c&&(this._cacheFrameRate=$c,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,$c])))}),$h(0,$e,"currentTime",null,function($c){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if($c<this._playStart||$c>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=$q.loopCount;var $d=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=$c,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$d),0),this._currentFrameTime=this._currentKeyframeIndex*$d}}),$h(0,$e,"paused",function(){return this._paused},function($c){(this._paused=$c)&&this.event("paused")}),$h(0,$e,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),$h(0,$e,"destroyed",function(){return this._destroyed}),$d}(),$J=function($c){function $d(){$d.__super.call(this),$s.isConchNode&&(this.drawSkin=function($c){$c.transform||($c.transform=$Gc.EMPTY),this._addCmd([$c]),this.setSkinMesh&&this.setSkinMesh($c._ps,$c.mVBData,$c.mEleNum,0,$c.mTexture,$c.transform)})}return $f($d,"laya.ani.GraphicsAni",$i),$d.prototype.drawSkin=function($c){var $d=[$c];this._saveToCmd($s._context._drawSkin,$d)},$d.create=function(){return $d._caches.pop()||new $d},$d.recycle=function($c){$c.clear(),$d._caches.push($c)},$d._caches=[],$d}(),$K=function($c){function $u(){this._aniMap={},this.unfixedLastAniIndex=-1,$u.__super.call(this),this._anis=new Array}$f($u,"laya.ani.AnimationTemplet",$m);var $d=$u.prototype;return $d.parse=function($c){var $d=new $Fc($c);this._aniVersion=$d.readUTFString(),$v.parse(this,$d)},$d._calculateKeyFrame=function($c,$d,$e){var $f=$c.keyFrame;$f[$d]=$f[0];for(var $g=0;$g<$d;$g++){var $h=$f[$g];$h.nextData=0===$h.duration?$h.data:$f[$g+1].data}$f.length--},$d.onAsynLoaded=function($c,$d,$e){var $f=new $Fc($d);switch(this._aniVersion=$f.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":$w.parse(this,$f);break;default:$v.parse(this,$f)}this._endLoaded()},$d.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},$d.getAnimationCount=function(){return this._anis.length},$d.getAnimation=function($c){return this._anis[$c]},$d.getAniDuration=function($c){return this._anis[$c].playTime},$d.getNodes=function($c){return this._anis[$c].nodes},$d.getNodeIndexWithName=function($c,$d){return this._anis[$c].bone3DMap[$d]},$d.getNodeCount=function($c){return this._anis[$c].nodes.length},$d.getTotalkeyframesLength=function($c){return this._anis[$c].totalKeyframeDatasLength},$d.getPublicExtData=function(){return this._publicExtData},$d.getAnimationDataWithCache=function($c,$d,$e,$f){var $g=$d[$e];if($g){var $h=$g[$c];return $h?$h[$f]:null}return null},$d.setAnimationDataWithCache=function($c,$d,$e,$f,$g){var $h=$d[$e]||($d[$e]={});($h[$c]||($h[$c]=[]))[$f]=$g},$d.getOriginalData=function($c,$d,$e,$f,$g){for(var $h=this._anis[$c].nodes,$i=0,$j=0,$k=$h.length,$l=0;$j<$k;$j++){var $m,$n=$h[$j];$m=$n.keyFrame[$e[$j][$f]],$n.dataOffset=$l;var $o=$g-$m.startTime,$p=$n.lerpType;if($p)switch($p){case 0:case 1:for($i=0;$i<$n.keyframeWidth;)$i+=$n.interpolationMethod[$i]($n,$i,$d,$l+$i,$m.data,$o,null,$m.duration,$m.nextData);break;case 2:var $q=$m.interpolationData,$r=$q.length,$s=0;for($i=0;$i<$r;){var $t=$q[$i];switch($t){case 6:case 7:$i+=$u.interpolation[$t]($n,$s,$d,$l+$s,$m.data,$o,null,$m.duration,$m.nextData,$q,$i+1);break;default:$i+=$u.interpolation[$t]($n,$s,$d,$l+$s,$m.data,$o,null,$m.duration,$m.nextData)}$s++}}else for($i=0;$i<$n.keyframeWidth;)$i+=$n.interpolationMethod[$i]($n,$i,$d,$l+$i,$m.data,$o,null,$m.duration,$m.nextData);$l+=$n.keyframeWidth}},$d.getNodesCurrentFrameIndex=function($c,$d){var $e=this._anis[$c].nodes;$c!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($e.length),this.unfixedCurrentTimes=new Float32Array($e.length),this.unfixedLastAniIndex=$c);for(var $f=0,$g=$e.length;$f<$g;$f++){var $h=$e[$f];for($d<this.unfixedCurrentTimes[$f]&&(this.unfixedCurrentFrameIndexes[$f]=0),this.unfixedCurrentTimes[$f]=$d;this.unfixedCurrentFrameIndexes[$f]<$h.keyFrame.length&&!($h.keyFrame[this.unfixedCurrentFrameIndexes[$f]].startTime>this.unfixedCurrentTimes[$f]);)this.unfixedCurrentFrameIndexes[$f]++;this.unfixedCurrentFrameIndexes[$f]--}return this.unfixedCurrentFrameIndexes},$d.getOriginalDataUnfixedRate=function($c,$d,$e){var $f=this._anis[$c].nodes;$c!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($f.length),this.unfixedCurrentTimes=new Float32Array($f.length),this.unfixedKeyframes=$r($f.length),this.unfixedLastAniIndex=$c);for(var $g=0,$h=0,$i=$f.length,$j=0;$h<$i;$h++){var $k=$f[$h];for($e<this.unfixedCurrentTimes[$h]&&(this.unfixedCurrentFrameIndexes[$h]=0),this.unfixedCurrentTimes[$h]=$e;this.unfixedCurrentFrameIndexes[$h]<$k.keyFrame.length&&!($k.keyFrame[this.unfixedCurrentFrameIndexes[$h]].startTime>this.unfixedCurrentTimes[$h]);)this.unfixedKeyframes[$h]=$k.keyFrame[this.unfixedCurrentFrameIndexes[$h]],this.unfixedCurrentFrameIndexes[$h]++;var $l=this.unfixedKeyframes[$h];$k.dataOffset=$j;var $m=$e-$l.startTime;if($k.lerpType)switch($k.lerpType){case 0:case 1:for($g=0;$g<$k.keyframeWidth;)$g+=$k.interpolationMethod[$g]($k,$g,$d,$j+$g,$l.data,$m,null,$l.duration,$l.nextData);break;case 2:var $n=$l.interpolationData,$o=$n.length,$p=0;for($g=0;$g<$o;){var $q=$n[$g];switch($q){case 6:case 7:$g+=$u.interpolation[$q]($k,$p,$d,$j+$p,$l.data,$m,null,$l.duration,$l.nextData,$n,$g+1);break;default:$g+=$u.interpolation[$q]($k,$p,$d,$j+$p,$l.data,$m,null,$l.duration,$l.nextData)}$p++}}else for($g=0;$g<$k.keyframeWidth;)$g+=$k.interpolationMethod[$g]($k,$g,$d,$j+$g,$l.data,$m,null,$l.duration,$l.nextData);$j+=$k.keyframeWidth}},$u._LinearInterpolation_0=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){var $m=0===$j?0:$h/$j;return $e[$f]=(1-$m)*$g[$d]+$m*$k[$d],1},$u._QuaternionInterpolation_1=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){var $m=0===$j?0:$h/$j;return $o.slerpQuaternionArray($g,$d,$k,$d,$m,$e,$f),4},$u._AngleInterpolation_2=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){return 0},$u._RadiansInterpolation_3=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){return 0},$u._Matrix4x4Interpolation_4=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){for(var $m=0;$m<16;$m++,$d++)$e[$f+$m]=$g[$d]+$h*$i[$d];return 16},$u._NoInterpolation_5=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l){return $e[$f]=$g[$d],1},$u._BezierInterpolation_6=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m){return void 0===$m&&($m=0),$e[$f]=$g[$d]+($k[$d]-$g[$d])*$A.getBezierRate($h/$j,$l[$m],$l[$m+1],$l[$m+2],$l[$m+3]),5},$u._BezierInterpolation_7=function($c,$d,$e,$f,$g,$h,$i,$j,$k,$l,$m){return void 0===$m&&($m=0),$e[$f]=$l[$m+4]+$l[$m+5]*$A.getBezierRate((.001*$h+$l[$m+6])/$l[$m+7],$l[$m],$l[$m+1],$l[$m+2],$l[$m+3]),9},$u.load=function($c){return $gc.loader.create($c,null,null,$u)},$u.interpolation=[$u._LinearInterpolation_0,$u._QuaternionInterpolation_1,$u._AngleInterpolation_2,$u._RadiansInterpolation_3,$u._Matrix4x4Interpolation_4,$u._NoInterpolation_5,$u._BezierInterpolation_6,$u._BezierInterpolation_7],$u}(),$C=function($d){function $e($c,$d){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,$e.__super.call(this),void 0===$d&&($d=0),$c&&this.init($c,$d)}$f($e,"laya.ani.bone.Skeleton",$d);var $c=$e.prototype;return $c.init=function($c,$d){void 0===$d&&($d=0);var $e,$f,$g,$h=0,$i=0;if(1==$d)for(this._graphicsCache=[],$h=0,$i=$c.getAnimationCount();$h<$i;$h++)this._graphicsCache.push([]);if(this._yReverseMatrix=$c.yReverseMatrix,this._aniMode=$d,this._templet=$c,this._player=new $B,this._player.cacheFrameRate=$c.rate,this._player.templet=$c,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=$c.mBoneArr,this._rootBone=$c.mRootBone,this._aniSectionDic=$c.aniSectionDic,0<$c.ikArr.length)for(this._ikArr=[],$h=0,$i=$c.ikArr.length;$h<$i;$h++)this._ikArr.push(new $u($c.ikArr[$h],this._boneList));if(0<$c.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),$h=0,$i=$c.pathArr.length;$h<$i;$h++)$e=$c.pathArr[$h],$f=new $x($e,this._boneList),($g=this._boneSlotDic[$e.name])&&(($f=new $x($e,this._boneList)).target=$g),this._pathDic[$e.name]=$f;if(0<$c.tfArr.length)for(this._tfArr=[],$h=0,$i=$c.tfArr.length;$h<$i;$h++)this._tfArr.push(new $y($c.tfArr[$h],this._boneList));if(0<$c.skinDataArray.length){var $j=this._templet.skinDataArray[this._skinIndex];this._skinName=$j.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},$c.load=function($c,$d,$e){},$c._onLoaded=function(){},$c._parseComplete=function(){var $c=$D.TEMPLET_DICTIONARY[this._aniPath];$c&&(this.init($c,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},$c._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},$c._onPlay=function(){this.event("played")},$c._onStop=function(){var $c,$d=this._templet.eventAniArr[this._aniClipIndex];if($d&&this._eventIndex<$d.length)for(;this._eventIndex<$d.length;this._eventIndex++)($c=$d[this._eventIndex]).time>=this._player.playStart&&$c.time<=this._player.playEnd&&this.event("label",$c);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},$c._onPause=function(){this.event("paused")},$c._parseSrcBoneMatrix=function(){var $c=0,$d=0;for($d=this._templet.srcBoneMatrixArr.length,$c=0;$c<$d;$c++)this._boneMatrixArray.push(new $Gc);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var $e,$f,$g=this._templet.boneSlotArray;for($c=0,$d=$g.length;$c<$d;$c++)$e=$g[$c],null==($f=this._bindBoneBoneSlotDic[$e.parent])&&(this._bindBoneBoneSlotDic[$e.parent]=$f=[]),this._boneSlotDic[$e.name]=$e=$e.copy(),$f.push($e),this._boneSlotArray.push($e)}},$c._emitMissedEvents=function($c,$d,$e){void 0===$e&&($e=0);var $f=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if($f){var $g,$h,$i=0;for($g=$f.length,$i=$e;$i<$g;$i++)($h=$f[$i]).time>=this._player.playStart&&$h.time<=this._player.playEnd&&this.event("label",$h)}},$c._update=function($c){if(void 0===$c&&($c=!0),!(this._pause||$c&&this._indexControl)){var $d=this.timer.currTimer,$e=this._player.currentKeyframeIndex,$f=$d-this._lastTime;if($c?this._player._update($f):$e=-1,this._lastTime=$d,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<$f&&this._clipIndex==$e&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var $g;this._lastUpdateAniClipIndex=this._aniClipIndex,$e>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var $h,$i=this._templet.eventAniArr[this._aniClipIndex];if($i&&this._eventIndex<$i.length&&(($g=$i[this._eventIndex]).time>=this._player.playStart&&$g.time<=this._player.playEnd?this._player.currentPlayTime>=$g.time&&(this.event("label",$g),this._eventIndex++):this._eventIndex++),0==this._aniMode){if($h=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$h&&(this.graphics=$h));var $j=0,$k=0;for($k=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,$k-1)&&0<$k;)$k--;if($k<this._clipIndex)for($j=$k;$j<this._clipIndex;$j++)this._createGraphics($j)}else if(1==this._aniMode){if($h=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$h&&(this.graphics=$h));for($k=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,$k-1)&&0<$k;)$k--;if($k<this._clipIndex)for($j=$k;$j<this._clipIndex;$j++)this._createGraphics($j)}this._createGraphics()}}},$c._createGraphics=function($c){void 0===$c&&($c=-1),-1==$c&&($c=this._clipIndex);var $d,$e,$f=$c*this._player.cacheFrameRateInterval,$g=this._templet.drawOrderAniArr[this._aniClipIndex];if($g&&0<$g.length)for(this._drawOrderIndex=0,$d=$g[this._drawOrderIndex];$f>=$d.time&&(this._drawOrder=$d.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=$g.length));)$d=$g[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=$J.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=$J.create(),$e=this.graphics;var $h=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],$c,$f);var $i,$j,$k,$l,$m=this._aniSectionDic[this._aniClipIndex],$n=0,$o=0,$p=0,$q=0,$r=0,$s=this._templet.srcBoneMatrixArr.length;for($r=$m[$o=0];$o<$s;$o++)$l=this._boneList[$o],$k=this._templet.srcBoneMatrixArr[$o],$l.resultTransform.scX=$k.scX*this._curOriginalData[$n++],$l.resultTransform.skX=$k.skX+this._curOriginalData[$n++],$l.resultTransform.skY=$k.skY+this._curOriginalData[$n++],$l.resultTransform.scY=$k.scY*this._curOriginalData[$n++],$l.resultTransform.x=$k.x+this._curOriginalData[$n++],$l.resultTransform.y=$k.y+this._curOriginalData[$n++],8===this._templet.tMatrixDataLen&&($l.resultTransform.skewX=$k.skewX+this._curOriginalData[$n++],$l.resultTransform.skewY=$k.skewY+this._curOriginalData[$n++]);var $t,$u={},$v={};for($r+=$m[1];$o<$r;$o++)$u[($t=$h[$o]).name]=this._curOriginalData[$n++],$v[$t.name]=this._curOriginalData[$n++],this._curOriginalData[$n++],this._curOriginalData[$n++],this._curOriginalData[$n++],this._curOriginalData[$n++];var $w,$x,$y={},$z={};for($r+=$m[2];$o<$r;$o++)$y[($t=$h[$o]).name]=this._curOriginalData[$n++],$z[$t.name]=this._curOriginalData[$n++],this._curOriginalData[$n++],this._curOriginalData[$n++],this._curOriginalData[$n++],this._curOriginalData[$n++];if(this._pathDic)for($r+=$m[3];$o<$r;$o++){if($t=$h[$o],$w=this._pathDic[$t.name])switch(new $Fc($t.extenData).getByte()){case 1:$w.position=this._curOriginalData[$n++];break;case 2:$w.spacing=this._curOriginalData[$n++];break;case 3:$w.rotateMix=this._curOriginalData[$n++],$w.translateMix=this._curOriginalData[$n++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update($Gc.TEMP.identity()),this._ikArr)for($o=0,$r=this._ikArr.length;$o<$r;$o++)$x=this._ikArr[$o],$y.hasOwnProperty($x.name)&&($x.bendDirection=$y[$x.name]),$z.hasOwnProperty($x.name)&&($x.mix=$z[$x.name]),$x.apply();if(this._pathDic)for(var $A in this._pathDic)($w=this._pathDic[$A]).apply(this._boneList,$e);if(this._tfArr)for($o=0,$q=this._tfArr.length;$o<$q;$o++)this._tfArr[$o].apply();for($o=0,$q=this._boneList.length;$o<$q;$o++)if($l=this._boneList[$o],$j=this._bindBoneBoneSlotDic[$l.name],$l.resultMatrix.copyTo(this._boneMatrixArray[$o]),$j)for($p=0,$r=$j.length;$p<$r;$p++)($i=$j[$p])&&$i.setParentMatrix($l.resultMatrix);var $B,$C,$D,$E,$F={},$G=this._templet.deformAniArr;if($G&&0<$G.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,$o=0,$r=this._boneSlotArray.length;$o<$r;$o++)($i=this._boneSlotArray[$o]).deformData=null;var $H,$I=$G[this._aniClipIndex];for($H in $B=$I.default,this._setDeform($B,$F,this._boneSlotArray,$f),$I)"default"!=$H&&$H!=this._skinName&&($B=$I[$H],this._setDeform($B,$F,this._boneSlotArray,$f));$B=$I[this._skinName],this._setDeform($B,$F,this._boneSlotArray,$f)}if(this._drawOrder)for($o=0,$r=this._drawOrder.length;$o<$r;$o++)$C=$u[($i=this._boneSlotArray[this._drawOrder[$o]]).name],$D=$v[$i.name],isNaN($D)||($e.save(),$e.alpha($D)),isNaN($C)||-2==$C||(this._templet.attachmentNames?$i.showDisplayByName(this._templet.attachmentNames[$C]):$i.showDisplayByIndex($C)),$F[this._drawOrder[$o]]?($E=$F[this._drawOrder[$o]],$i.currDisplayData&&$E[$i.currDisplayData.attachmentName]?$i.deformData=$E[$i.currDisplayData.attachmentName]:$i.deformData=null):$i.deformData=null,isNaN($D)?$i.draw($e,this._boneMatrixArray,2==this._aniMode):$i.draw($e,this._boneMatrixArray,2==this._aniMode,$D),isNaN($D)||$e.restore();else for($o=0,$r=this._boneSlotArray.length;$o<$r;$o++)$C=$u[($i=this._boneSlotArray[$o]).name],$D=$v[$i.name],isNaN($D)||($e.save(),$e.alpha($D)),isNaN($C)||-2==$C||(this._templet.attachmentNames?$i.showDisplayByName(this._templet.attachmentNames[$C]):$i.showDisplayByIndex($C)),$F[$o]?($E=$F[$o],$i.currDisplayData&&$E[$i.currDisplayData.attachmentName]?$i.deformData=$E[$i.currDisplayData.attachmentName]:$i.deformData=null):$i.deformData=null,isNaN($D)?$i.draw($e,this._boneMatrixArray,2==this._aniMode):$i.draw($e,this._boneMatrixArray,2==this._aniMode,$D),isNaN($D)||$e.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,$c,$e):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,$c,$e)},$c._setDeform=function($c,$d,$e,$f){if($c){var $g,$h,$i,$j=0,$k=0,$l=0;if($c)for($j=0,$k=$c.deformSlotDataList.length;$j<$k;$j++)for($g=$c.deformSlotDataList[$j],$l=0;$l<$g.deformSlotDisplayList.length;$l++)$i=$e[($h=$g.deformSlotDisplayList[$l]).slotIndex],$h.apply($f,$i),$d[$h.slotIndex]||($d[$h.slotIndex]={}),$d[$h.slotIndex][$h.attachment]=$h.deformData}},$c.getAnimNum=function(){return this._templet.getAnimationCount()},$c.getAniNameByIndex=function($c){return this._templet.getAniNameByIndex($c)},$c.getSlotByName=function($c){return this._boneSlotDic[$c]},$c.showSkinByName=function($c,$d){void 0===$d&&($d=!0),this.showSkinByIndex(this._templet.getSkinIndexByName($c),$d)},$c.showSkinByIndex=function($c,$d){void 0===$d&&($d=!0);for(var $e=0;$e<this._boneSlotArray.length;$e++)this._boneSlotArray[$e].showSlotData(null,$d);if(this._templet.showSkinByIndex(this._boneSlotDic,$c,$d)){var $f=this._templet.skinDataArray[$c];this._skinIndex=$c,this._skinName=$f.name}this._clearCache()},$c.showSlotSkinByIndex=function($c,$d){if(0!=this._aniMode){var $e=this.getSlotByName($c);$e&&$e.showDisplayByIndex($d),this._clearCache()}},$c.showSlotSkinByName=function($c,$d){if(0!=this._aniMode){var $e=this.getSlotByName($c);$e&&$e.showDisplayByName($d),this._clearCache()}},$c.replaceSlotSkinName=function($c,$d,$e){if(0!=this._aniMode){var $f=this.getSlotByName($c);$f&&$f.replaceDisplayByName($d,$e),this._clearCache()}},$c.replaceSlotSkinByIndex=function($c,$d,$e){if(0!=this._aniMode){var $f=this.getSlotByName($c);$f&&$f.replaceDisplayByIndex($d,$e),this._clearCache()}},$c.setSlotSkin=function($c,$d){if(0!=this._aniMode){var $e=this.getSlotByName($c);$e&&$e.replaceSkin($d),this._clearCache()}},$c._clearCache=function(){if(1==this._aniMode)for(var $c=0,$d=this._graphicsCache.length;$c<$d;$c++){for(var $e=0,$f=this._graphicsCache[$c].length;$e<$f;$e++){var $g=this._graphicsCache[$c][$e];$g!=this.graphics&&$J.recycle($g)}this._graphicsCache[$c].length=0}},$c.play=function($c,$d,$e,$f,$g,$h){void 0===$e&&($e=!0),void 0===$f&&($f=0),void 0===$g&&($g=0),void 0===$h&&($h=!0),this._indexControl=!1;var $i=-1,$j=NaN;if($j=$d?2147483647:0,"string"==typeof $c)for(var $k=0,$l=this._templet.getAnimationCount();$k<$l;$k++){var $m=this._templet.getAnimation($k);if($m&&$c==$m.name){$i=$k;break}}else $i=$c;-1<$i&&$i<this.getAnimNum()&&(this._aniClipIndex=$i,($e||this._pause||this._currAniIndex!=$i)&&(this._currAniIndex=$i,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength($i)),this._drawOrder=null,this._eventIndex=0,this._player.play($i,this._player.playbackRate,$j,$f,$g),$h&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=$n.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},$c.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},$c.playbackRate=function($c){this._player&&(this._player.playbackRate=$c)},$c.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},$c.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=$n.now(),this.timer.frameLoop(1,this,this._update,null,!0))},$c._getGrahicsDataWithCache=function($c,$d){return this._graphicsCache[$c][$d]},$c._setGrahicsDataWithCache=function($c,$d,$e){this._graphicsCache[$c][$d]=$e},$c.destroy=function($c){void 0===$c&&($c=!0),$d.prototype.destroy.call(this,$c),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},$h(0,$c,"url",function(){return this._aniPath},function($c){this.load($c)}),$h(0,$c,"index",function(){return this._index},function($c){this.player&&(this._index=$c,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),$h(0,$c,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),$h(0,$c,"templet",function(){return this._templet}),$h(0,$c,"player",function(){return this._player}),$e.useSimpleMeshInCanvas=!1,$e}($hc),$D=function($d){function $g(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,$g.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}$f($g,"laya.ani.bone.Templet",$d);var $c=$g.prototype;return $c.getLoadList=function(){return this._loadList},$c.loadAni=function($c){this._skBufferUrl=$c,$gc.loader.load($c,$k.create(this,this.onComplete),null,"arraybuffer")},$c.onComplete=function($c){if(this._isDestroyed)this.destroy();else{var $d=$l.getRes(this._skBufferUrl);$d?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,$d)):this.event("error","load failed:"+this._skBufferUrl)}},$c.parseData=function($c,$d,$e){void 0===$e&&($e=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=$c,this._mainTexture&&$s.isWebGL&&$c.bitmap&&($c.bitmap.enableMerageInAtlas=!1),this._rate=$e,this.parse($d)},$c.buildArmature=function($c){return void 0===$c&&($c=0),new $C(this,$c)},$c.parse=function($c){$d.prototype.parse.call(this,$c),this._endLoaded(),this._aniVersion!=$g.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+$g.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},$c._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var $c=0;this._loadList=[];var $d,$e=new $Fc(this.getPublicExtData()),$f=0,$g=0,$h=0,$i=$e.getInt32(),$j=$e.readUTFString(),$k=$j.split("\n");for($c=0;$c<$i;$c++)$d=this._path+$k[2*$c],$j=$k[2*$c+1],$e.getFloat32(),$e.getFloat32(),$f=$e.getFloat32(),$g=$e.getFloat32(),$h=$e.getFloat32(),isNaN($h)?0:$h,$h=$e.getFloat32(),isNaN($h)?0:$h,$h=$e.getFloat32(),isNaN($h)?$f:$h,$h=$e.getFloat32(),isNaN($h)?$g:$h,-1==this._loadList.indexOf($d)&&this._loadList.push($d);this.event("inited",this)}},$c._textureComplete=function(){for(var $c,$d,$e=0,$f=this._loadList.length;$e<$f;$e++)$d=this._loadList[$e],$c=this._textureDic[$d]=$l.getRes($d),$s.isWebGL&&$c&&$c.bitmap&&($c.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},$c._parsePublicExtData=function(){var $c=0,$d=0,$e=0,$f=0,$g=0;for($c=0,$g=this.getAnimationCount();$c<$g;$c++)this._graphicsCache.push([]);var $h;$h="Dragon"!=this._aniClassName;var $i,$j,$k=new $Fc(this.getPublicExtData()),$l=0,$m=0,$n=0,$o=0,$p=0,$q=0,$r=0,$s=0,$t=0,$u=$k.getInt32(),$v=$k.readUTFString(),$w=$v.split("\n");for($c=0;$c<$u;$c++){if($i=this._mainTexture,$j=this._path+$w[2*$c],$v=$w[2*$c+1],null==this._mainTexture&&($i=this._textureDic[$j]),!$i)return this.event("error",this),void(this.isParseFail=!0);$l=$k.getFloat32(),$m=$k.getFloat32(),$n=$k.getFloat32(),$o=$k.getFloat32(),$t=$k.getFloat32(),$p=isNaN($t)?0:$t,$t=$k.getFloat32(),$q=isNaN($t)?0:$t,$t=$k.getFloat32(),$r=isNaN($t)?$n:$t,$t=$k.getFloat32(),$s=isNaN($t)?$o:$t,this.subTextureDic[$v]=$Hc.create($i,$l,$m,$n,$o,-$p,-$q,$r,$s),$i.alphaTexture&&(this.subTextureDic[$v].alphaTexture=$Hc.create($i.alphaTexture,$l,$m,$n,$o,-$p,-$q,$r,$s))}this._mainTexture=$i;var $x,$y,$z,$A,$B,$C=$k.getUint16();for($c=0;$c<$C;$c++)($x=[]).push($k.getUint16()),$x.push($k.getUint16()),$x.push($k.getUint16()),$x.push($k.getUint16()),this.aniSectionDic[$c]=$x;var $D,$E=$k.getInt16(),$F={};for($c=0;$c<$E;$c++)$y=new $Ic,0==$c?$D=$y:$y.root=$D,$y.d=$h?-1:1,$A=$k.readUTFString(),$B=$k.readUTFString(),$y.length=$k.getFloat32(),1==$k.getByte()&&($y.inheritRotation=!1),1==$k.getByte()&&($y.inheritScale=!1),$y.name=$A,$B&&(($z=$F[$B])?$z.addChild($y):this.mRootBone=$y),$F[$A]=$y,this.mBoneArr.push($y);this.tMatrixDataLen=$k.getUint16();var $G,$H,$I=$k.getUint16(),$J=Math.floor($I/this.tMatrixDataLen),$K=this.srcBoneMatrixArr;for($c=0;$c<$J;$c++)($G=new $Vc).scX=$k.getFloat32(),$G.skX=$k.getFloat32(),$G.skY=$k.getFloat32(),$G.scY=$k.getFloat32(),$G.x=$k.getFloat32(),$G.y=$k.getFloat32(),8===this.tMatrixDataLen&&($G.skewX=$k.getFloat32(),$G.skewY=$k.getFloat32()),$K.push($G),($y=this.mBoneArr[$c]).transform=$G;var $L,$M=$k.getUint16(),$N=0;for($c=0;$c<$M;$c++){for($H=new $Pc,$N=$k.getUint16(),$d=0;$d<$N;$d++)$H.boneNames.push($k.readUTFString()),$H.boneIndexs.push($k.getInt16());$H.name=$k.readUTFString(),$H.targetBoneName=$k.readUTFString(),$H.targetBoneIndex=$k.getInt16(),$H.bendDirection=$k.getFloat32(),$H.mix=$k.getFloat32(),$H.isSpine=$h,this.ikArr.push($H)}var $O,$P=$k.getUint16(),$Q=0;for($c=0;$c<$P;$c++){for($L=new $Uc,$Q=$k.getUint16(),$d=0;$d<$Q;$d++)$L.boneIndexs.push($k.getInt16());$L.name=$k.getUTFString(),$L.targetIndex=$k.getInt16(),$L.rotateMix=$k.getFloat32(),$L.translateMix=$k.getFloat32(),$L.scaleMix=$k.getFloat32(),$L.shearMix=$k.getFloat32(),$L.offsetRotation=$k.getFloat32(),$L.offsetX=$k.getFloat32(),$L.offsetY=$k.getFloat32(),$L.offsetScaleX=$k.getFloat32(),$L.offsetScaleY=$k.getFloat32(),$L.offsetShearY=$k.getFloat32(),this.tfArr.push($L)}var $R=$k.getUint16(),$S=0;for($c=0;$c<$R;$c++){for(($O=new $Qc).name=$k.readUTFString(),$S=$k.getUint16(),$d=0;$d<$S;$d++)$O.bones.push($k.getInt16());$O.target=$k.readUTFString(),$O.positionMode=$k.readUTFString(),$O.spacingMode=$k.readUTFString(),$O.rotateMode=$k.readUTFString(),$O.offsetRotation=$k.getFloat32(),$O.position=$k.getFloat32(),$O.spacing=$k.getFloat32(),$O.rotateMix=$k.getFloat32(),$O.translateMix=$k.getFloat32(),this.pathArr.push($O)}var $T,$U,$V,$W,$X,$Y=0,$Z=0,$$=0,$_=NaN,$a=0,$b=$k.getInt16();for($c=0;$c<$b;$c++){var $cc=$k.getUint8(),$dc={};this.deformAniArr.push($dc);for(var $ec=0;$ec<$cc;$ec++)for(($T=new $Kc).skinName=$k.getUTFString(),$dc[$T.skinName]=$T,$Y=$k.getInt16(),$d=0;$d<$Y;$d++)for($U=new $Lc,$T.deformSlotDataList.push($U),$Z=$k.getInt16(),$e=0;$e<$Z;$e++)for($V=new $Mc,$U.deformSlotDisplayList.push($V),$V.slotIndex=$k.getInt16(),$V.attachment=$k.getUTFString(),$$=$k.getInt16(),$f=0;$f<$$;$f++)for(1==$k.getByte()?$V.tweenKeyList.push(!0):$V.tweenKeyList.push(!1),$_=$k.getFloat32(),$V.timeList.push($_),$W=[],$V.vectices.push($W),$a=$k.getInt16(),$g=0;$g<$a;$g++)$W.push($k.getFloat32())}var $fc,$gc,$hc=$k.getInt16(),$ic=0,$jc=0;for($c=0;$c<$hc;$c++){for($ic=$k.getInt16(),$X=[],$d=0;$d<$ic;$d++){for(($fc=new $Nc).time=$k.getFloat32(),$jc=$k.getInt16(),$e=0;$e<$jc;$e++)$fc.drawOrder.push($k.getInt16());$X.push($fc)}this.drawOrderAniArr.push($X)}var $kc,$lc=$k.getInt16(),$mc=0;for($c=0;$c<$lc;$c++){for($mc=$k.getInt16(),$gc=[],$d=0;$d<$mc;$d++)($kc=new $Oc).name=$k.getUTFString(),$kc.intValue=$k.getInt32(),$kc.floatValue=$k.getFloat32(),$kc.stringValue=$k.getUTFString(),$kc.time=$k.getFloat32(),$gc.push($kc);this.eventAniArr.push($gc)}var $nc=$k.getInt16();if(0<$nc)for(this.attachmentNames=[],$c=0;$c<$nc;$c++)this.attachmentNames.push($k.getUTFString());var $oc,$pc,$qc=$k.getInt16();for($c=0;$c<$qc;$c++)($oc=new $Jc).name=$k.readUTFString(),$oc.parent=$k.readUTFString(),$oc.attachmentName=$k.readUTFString(),$oc.srcDisplayIndex=$oc.displayIndex=$k.getInt16(),($oc.templet=this).boneSlotDic[$oc.name]=$oc,null==($pc=this.bindBoneBoneSlotDic[$oc.parent])&&(this.bindBoneBoneSlotDic[$oc.parent]=$pc=[]),$pc.push($oc),this.boneSlotArray.push($oc);var $rc,$sc,$tc,$uc=$k.readUTFString().split("\n"),$vc=0,$wc=$k.getUint8(),$xc=0,$yc=0,$zc=0,$Ac=0,$Bc=0,$Cc=0,$Dc=0;for($c=0;$c<$wc;$c++){for(($rc=new $Rc).name=$uc[$vc++],$xc=$k.getUint8(),$d=0;$d<$xc;$d++){for(($sc=new $Tc).name=$uc[$vc++],$oc=this.boneSlotDic[$sc.name],$yc=$k.getUint8(),$e=0;$e<$yc;$e++){if($tc=new $Sc,this.skinSlotDisplayDataArr.push($tc),$tc.name=$uc[$vc++],$tc.attachmentName=$uc[$vc++],$tc.transform=new $Vc,$tc.transform.scX=$k.getFloat32(),$tc.transform.skX=$k.getFloat32(),$tc.transform.skY=$k.getFloat32(),$tc.transform.scY=$k.getFloat32(),$tc.transform.x=$k.getFloat32(),$tc.transform.y=$k.getFloat32(),$sc.displayArr.push($tc),$tc.width=$k.getFloat32(),$tc.height=$k.getFloat32(),$tc.type=$k.getUint8(),$tc.verLen=$k.getUint16(),0<($E=$k.getUint16()))for($tc.bones=[],$f=0;$f<$E;$f++){var $Ec=$k.getUint16();$tc.bones.push($Ec)}if(0<($zc=$k.getUint16()))for($tc.uvs=[],$f=0;$f<$zc;$f++)$tc.uvs.push($k.getFloat32());if(0<($Ac=$k.getUint16()))for($tc.weights=[],$f=0;$f<$Ac;$f++)$tc.weights.push($k.getFloat32());if(0<($Bc=$k.getUint16()))for($tc.triangles=[],$f=0;$f<$Bc;$f++)$tc.triangles.push($k.getUint16());if(0<($Cc=$k.getUint16()))for($tc.vertices=[],$f=0;$f<$Cc;$f++)$tc.vertices.push($k.getFloat32());if(0<($Dc=$k.getUint16()))for($tc.lengths=[],$f=0;$f<$Dc;$f++)$tc.lengths.push($k.getFloat32())}$rc.slotArr.push($sc)}this.skinDic[$rc.name]=$rc,this.skinDataArray.push($rc)}1==$k.getUint8()?(this.yReverseMatrix=new $Gc(1,0,0,-1,0,0),$D&&$D.setTempMatrix(this.yReverseMatrix)):$D&&$D.setTempMatrix(new $Gc),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},$c.getTexture=function($c){var $d=this.subTextureDic[$c];return $d||($d=this.subTextureDic[$c.substr(0,$c.length-1)]),null==$d?this._mainTexture:$d},$c.showSkinByIndex=function($c,$d,$e){if(void 0===$e&&($e=!0),$d<0&&$d>=this.skinDataArray.length)return!1;var $f,$g,$h=0,$i=0,$j=this.skinDataArray[$d];if($j){for($h=0,$i=$j.slotArr.length;$h<$i;$h++)($g=$j.slotArr[$h])&&($f=$c[$g.name])&&($f.showSlotData($g,$e),$e&&"undefined"!=$f.attachmentName&&"null"!=$f.attachmentName?$f.showDisplayByName($f.attachmentName):$f.showDisplayByIndex($f.displayIndex));return!0}return!1},$c.getSkinIndexByName=function($c){for(var $d=0,$e=this.skinDataArray.length;$d<$e;$d++)if(this.skinDataArray[$d].name==$c)return $d;return-1},$c.getGrahicsDataWithCache=function($c,$d){return this._graphicsCache[$c][$d]},$c.setGrahicsDataWithCache=function($c,$d,$e){this._graphicsCache[$c][$d]=$e},$c.destroy=function(){var $c;for(var $d in this._isDestroyed=!0,this.subTextureDic)($c=this.subTextureDic[$d])&&$c.destroy();for($d in this._textureDic)($c=this._textureDic[$d])&&$c.destroy();for(var $e=0,$f=this.skinSlotDisplayDataArr.length;$e<$f;$e++)this.skinSlotDisplayDataArr[$e].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete $g.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},$c.getAniNameByIndex=function($c){var $d=this.getAnimation($c);return $d?$d.name:null},$h(0,$c,"rate",function(){return this._rate},function($c){this._rate=$c}),$g.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",$g.TEMPLET_DICTIONARY=null,$g}($K)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($c,$d){"use strict";for(var $e in Object.defineProperty($d,"__esModule",{value:!0}),Laya){var $f=Laya[$e];$f&&$f.__isclass&&($d[$e]=$f)}});