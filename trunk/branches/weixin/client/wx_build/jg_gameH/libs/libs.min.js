var Laya=window.Laya=function(Hj,Ha){var Hk={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(Ha,Hb){return 1==arguments.length?Hk.__presubstr.call(this,Ha):Hk.__presubstr.call(this,Ha,0<Hb?Hb:this.length+Hb)},__init:function(Ha){Ha.forEach(function(Ha){Ha.__init$&&Ha.__init$()})},__isClass:function(Ha){return Ha&&(Ha.__isclass||Ha==Object||Ha==String||Ha==Array)},__newvec:function(Ha,Hb){var Hc=[];Hc.length=Ha;for(var Hd=0;Hd<Ha;Hd++)Hc[Hd]=Hb;return Hc},__extend:function(Ha,Hb){for(var Hc in Hb)if(Hb.hasOwnProperty(Hc)){var Hd=Object.getOwnPropertyDescriptor(Hb,Hc),He=Hd.get,Hf=Hd.set;He||Hf?He&&Hf?Object.defineProperty(Ha,Hc,Hd):(He&&Object.defineProperty(Ha,Hc,He),Hf&&Object.defineProperty(Ha,Hc,Hf)):Ha[Hc]=Hb[Hc]}function Hg(){Hk.un(this,"constructor",Ha)}Hg.prototype=Hb.prototype,Ha.prototype=new Hg,Hk.un(Ha.prototype,"__imps",Hk.__copy({},Hb.prototype.__imps))},__copy:function(Ha,Hb){if(!Hb)return null;for(var Hc in Ha=Ha||{},Hb)Ha[Hc]=Hb[Hc];return Ha},__package:function(Ha,Hb){if(!Hk.__packages[Ha]){Hk.__packages[Ha]=!0;var Hc=Hj,Hd=Ha.split(".");if(1<Hd.length)for(var He=0,Hf=Hd.length-1;He<Hf;He++){var Hg=Hc[Hd[He]];Hc=Hg||(Hc[Hd[He]]={})}Hc[Hd[Hd.length-1]]||(Hc[Hd[Hd.length-1]]=Hb||{})}},__hasOwnProperty:function(Ha,Hb){return Hb=Hb||this,Object.hasOwnProperty.call(Hb,Ha)||function Ha(Hb,Hc){if(Object.hasOwnProperty.call(Hc.prototype,Hb))return!0;var Hd=Hc.prototype.__super;return null==Hd?null:Ha(Hb,Hd)}(Ha,Hb.__class)},__typeof:function(Ha,Hb){if(!Ha||!Hb)return!1;if(Hb===String)return"string"==typeof Ha;if(Hb===Number)return"number"==typeof Ha;if(Hb.__interface__)Hb=Hb.__interface__;else if("string"!=typeof Hb)return Ha instanceof Hb;return Ha.__imps&&Ha.__imps[Hb]||Ha.__class==Hb},__as:function(Ha,Hb){return this.__typeof(Ha,Hb)?Ha:null},__int:function(Ha){return Ha?parseInt(Ha):0},interface:function(Ha,Hb){Hk.__package(Ha,{});var Hc=Hk.__internals,Hd=Hc[Ha]=Hc[Ha]||{self:Ha};if(Hb){var He=Hb.split(",");Hd.extend=[];for(var Hf=0;Hf<He.length;Hf++){var Hg=He[Hf];Hc[Hg]=Hc[Hg]||{self:Hg},Hd.extend.push(Hc[Hg])}}var Hh=Hj,Hi=Ha.split(".");for(Hf=0;Hf<Hi.length-1;Hf++)Hh=Hh[Hi[Hf]];Hh[Hi[Hi.length-1]]={__interface__:Ha}},class:function(Ha,Hb,Hc,Hd){if(Hc&&Hk.__extend(Ha,Hc),Hb)if(Hk.__package(Hb,Ha),Hk.__classmap[Hb]=Ha,0<Hb.indexOf(".")){if(0==Hb.indexOf("laya.")){var He=Hb.split(".");Hd=Hd||He[He.length-1],Hk[Hd]&&console.log("Warning!,this class["+Hd+"] already exist:",Hk[Hd]),Hk[Hd]=Ha}}else"Main"==Hb?Hj.Main=Ha:"MainWX"==Hb?Hj.MainWX=Ha:(Hk[Hb]&&console.log("Error!,this class["+Hb+"] already exist:",Hk[Hb]),Hk[Hb]=Ha);var Hf=Hk.un,Hg=Ha.prototype;Hf(Hg,"hasOwnProperty",Hk.__hasOwnProperty),Hf(Hg,"__class",Ha),Hf(Hg,"__super",Hc),Hf(Hg,"__className",Hb),Hf(Ha,"__super",Hc),Hf(Ha,"__className",Hb),Hf(Ha,"__isclass",!0),Hf(Ha,"super",function(Ha){this.__super.call(Ha)})},imps:function(Ha,Hb){if(!Hb)return null;var He=Ha.__imps||Hk.un(Ha,"__imps",{});function Hf(Ha){var Hb,Hc;if((Hb=Hk.__internals[Ha])&&(He[Ha]=!0,Hc=Hb.extend))for(var Hd=0;Hd<Hc.length;Hd++)Hf(Hc[Hd].self)}for(var Hc in Hb)Hf(Hc)},superSet:function(Ha,Hb,Hc,Hd){var He=Ha.prototype["_$set_"+Hc];He&&He.call(Hb,Hd)},superGet:function(Ha,Hb,Hc){var Hd=Ha.prototype["_$get_"+Hc];return Hd?Hd.call(Hb):null},getset:function(Ha,Hb,Hc,Hd,He){Ha?(Hd&&(Hb["_$GET_"+Hc]=Hd),He&&(Hb["_$SET_"+Hc]=He)):(Hd&&Hk.un(Hb,"_$get_"+Hc,Hd),He&&Hk.un(Hb,"_$set_"+Hc,He)),Hd&&He?Object.defineProperty(Hb,Hc,{get:Hd,set:He,enumerable:!1,configurable:!0}):(Hd&&Object.defineProperty(Hb,Hc,{get:Hd,enumerable:!1,configurable:!0}),He&&Object.defineProperty(Hb,Hc,{set:He,enumerable:!1,configurable:!0}))},static:function(Hc,Hd){for(var He=0,Ha=Hd.length;He<Ha;He+=2)if("length"==Hd[He])Hc.length=Hd[He+1].call(Hc);else{function Hb(){var Hb=Hd[He],Ha=Hd[He+1];Object.defineProperty(Hc,Hb,{get:function(){return delete this[Hb],this[Hb]=Ha.call(this)},set:function(Ha){delete this[Hb],this[Hb]=Ha},enumerable:!0,configurable:!0})}Hb()}},un:function(Ha,Hb,Hc){return Hc||(Hc=Ha[Hb]),Hk.__propun.value=Hc,Object.defineProperty(Ha,Hb,Hk.__propun),Hc},uns:function(Hb,Ha){Ha.forEach(function(Ha){Hk.un(Hb,Ha)})}};return Hj.console=Hj.console||{log:function(){}},Hj.trace=Hj.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),Hk}(window,document);!function(Ha,Hb,Hc){Hc.un,Hc.uns,Hc.static,Hc.class,Hc.getset,Hc.__newvec}(window,document,Laya),function(Hg,Hb,Hx){Hx.un,Hx.uns;var Hi=Hx.static,Hp=Hx.class,Hk=Hx.getset;Hx.__newvec;Hx.interface("laya.runtime.IMarket"),Hx.interface("laya.filters.IFilter"),Hx.interface("laya.display.ILayout"),Hx.interface("laya.resource.IDispose"),Hx.interface("laya.runtime.IPlatform"),Hx.interface("laya.resource.IDestroy"),Hx.interface("laya.runtime.IConchNode"),Hx.interface("laya.filters.IFilterAction"),Hx.interface("laya.runtime.ICPlatformClass"),Hx.interface("laya.resource.ICreateResource"),Hx.interface("laya.runtime.IConchRenderObject"),Hx.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var HD=function(){function Hf(){}return Hp(Hf,"laya.utils.RunDriver"),Hf.FILTER_ACTIONS=[],Hf.pixelRatio=-1,Hf._charSizeTestDiv=null,Hf.now=function(){return Date.now()},Hf.getWindow=function(){return Hg},Hf.getPixelRatio=function(){if(Hf.pixelRatio<0){var Ha=HM.context,Hb=Ha.backingStorePixelRatio||Ha.webkitBackingStorePixelRatio||Ha.mozBackingStorePixelRatio||Ha.msBackingStorePixelRatio||Ha.oBackingStorePixelRatio||Ha.backingStorePixelRatio||1;(Hf.pixelRatio=(HM.window.devicePixelRatio||1)/Hb)<1&&(Hf.pixelRatio=1)}return Hf.pixelRatio},Hf.getIncludeStr=function(Ha){return null},Hf.createShaderCondition=function(Ha){var Hb="(function() {return "+Ha+";})";return Hx._runScript(Hb)},Hf.fontMap=[],Hf.measureText=function(Ha,Hb){var Hc=Hf.hanzi.test(Ha);if(Hc&&Hf.fontMap[Hb])return Hf.fontMap[Hb];var Hd=HM.context;Hd.font=Hb;var He=Hd.measureText(Ha);return Hc&&(Hf.fontMap[Hb]=He),He},Hf.getWebGLContext=function(Ha){},Hf.beginFlush=function(){},Hf.endFinish=function(){},Hf.addToAtlas=null,Hf.flashFlushImage=function(Ha){},Hf.drawToCanvas=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=Hta.create("2D"),Hh=new HI(Hc,Hd,Hg);return HJ.renders[Hb]._fun(Ha,Hh,He,Hf),Hg},Hf.createParticleTemplate2D=null,Hf.createGLTextur=null,Hf.createWebGLContext2D=null,Hf.changeWebGLSize=function(Ha,Hb){},Hf.createRenderSprite=function(Ha,Hb){return new HJ(Ha,Hb)},Hf.createFilterAction=function(Ha){return new Ht},Hf.createGraphics=function(){return new Hm},Hf.clear=function(Ha){HH._context.ctx.clear()},Hf.cancelLoadByUrl=function(Ha){},Hf.clearAtlas=function(Ha){},Hf.isAtlas=function(Ha){return!1},Hf.addTextureToAtlas=function(Ha){},Hf.getTexturePixels=function(Ha,Hb,Hc,Hd,He){return null},Hf.skinAniSprite=function(){return null},Hf.update3DLoop=function(){},Hi(Hf,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),Hf}(),Hd=(Hk(1,Hx,"alertGlobalError",null,function(Ha){var Hf=0;HM.window.onerror=Ha?function(Ha,Hb,Hc,Hd,He){Hf++<5&&He&&alert(He.stack||He)}:null}),Hx.init=function(Ha,Hb,Hc){for(var Hd=[],He=2,Hf=arguments.length;He<Hf;He++)Hd.push(arguments[He]);if(!Hx._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=Hx._arrayBufferSlice),Hx._isinit=!0,HM.__init__(),HK.__init__(),Hm.__init__(),Hx.timer=new HW,Hx.scaleTimer=new HW,Hx.loader=new Hia,H$.__init__(),He=0;for(var Hg=Hd.length;He<Hg;He++)Hd[He].enable&&Hd[He].enable();return Hn.__init__(),Hh.__init__(),HL.__init__(),HO.beginCheck(),Hx._currentStage=Hx.stage=new Hra,Hx.stage.conchModel&&Hx.stage.conchModel.setRootNode(),Hx._getUrlPath(),Hx.render=new HH(0,0),Hx.stage.size(Ha,Hb),HJ.__init__(),Hl.__init__(),Ho.instance.__init__(Hx.stage,HH.canvas),Hva.__init__(),HC.autoStopMusic=!0,HA.__init__(),HH.canvas}},Hx._getUrlPath=function(){var Ha=HM.window.location,Hb=Ha.pathname;Hb=Hb&&":"==Hb.charAt(2)?Hb.substring(1):Hb,HG.rootPath=HG.basePath=HG.getPath("file:"==Ha.protocol?Hb:Ha.protocol+"//"+Ha.host+Ha.pathname)},Hx._arrayBufferSlice=function(Ha,Hb){var Hc=new Uint8Array(this,Ha,Hb-Ha),Hd=new Uint8Array(Hc.length);return Hd.set(Hc),Hd.buffer},Hx._runScript=function(Ha){return HM.window[Hx._evcode](Ha)},Hx.stage=null,Hx.timer=null,Hx.scaleTimer=null,Hx.loader=null,Hx.version="1.8.6",Hx.render=null,Hx._currentStage=null,Hx._isinit=!1,Hx.isDebug=!1,Hx.MiniAdpter={init:function(){Hg.navigator&&Hg.navigator.userAgent&&-1<Hg.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},Hi(Hx,["conchMarket",function(){return this.conchMarket=Hg.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=Hg.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function Ha(){}return Hp(Ha,"Config"),Ha.WebGLTextCacheCount=500,Ha.atlasEnable=!1,Ha.showCanvasMark=!1,Ha.animationInterval=50,Ha.isAntialias=!1,Ha.isAlpha=!1,Ha.premultipliedAlpha=!0,Ha.isStencil=!0,Ha.preserveDrawingBuffer=!1,Ha}()),Hj=function(){function Hj(){this._events=null}Hp(Hj,"laya.events.EventDispatcher");var Ha=Hj.prototype;return Ha.hasListener=function(Ha){return!!(this._events&&this._events[Ha])},Ha.event=function(Ha,Hb){if(!this._events||!this._events[Ha])return!1;var Hc=this._events[Ha];if(Hc.lock)Hc.queue||(Hc.queue=[]),Hc.queue.push(Hb);else{var Hd;for(Hc.lock=!0,Hc.cursor=Hc.head;Hc.cursor;)Hd=Hc.cursor,Hc.cursor=Hd.next,Hd.once&&Hj.delNode(Hc,Hd),null!=Hb?Hd.args?Hd.method.apply(Hd.caller,Hd.args.concat(Hb)):Hb instanceof Array?Hd.method.apply(Hd.caller,Hb):Hd.method.call(Hd.caller,Hb):Hd.method.apply(Hd.caller,Hd.args),Hd.once&&Hj.recoverHandler(Hd);Hc.lock=!1,!Hc.head&&this._events&&this._events[Ha]==Hc&&delete this._events[Ha],Hc.queue&&Hc.queue.length&&this.event(Ha,Hc.queue.shift())}return!0},Ha.on=function(Ha,Hb,Hc,Hd){return this._createListener(Ha,Hb,Hc,Hd,!1)},Ha.once=function(Ha,Hb,Hc,Hd){return this._createListener(Ha,Hb,Hc,Hd,!0)},Ha._createListener=function(Ha,Hb,Hc,Hd,He,Hf){void 0===Hf&&(Hf=!0),Hf&&this.off(Ha,Hb,Hc,He);var Hg=Hj.createHandler(Hb||this,Hc,Hd,He);this._events||(this._events={});var Hh=this._events,Hi=Hh[Ha];return Hi?Hi.tail?(Hg.prev=Hi.tail,Hi.tail.next=Hg,Hi.tail=Hg):Hi.head=Hi.tail=Hg:Hh[Ha]={head:Hg,tail:Hg,cursor:null,lock:!1},this},Ha.off=function(Ha,Hb,Hc,Hd){if(void 0===Hd&&(Hd=!1),!this._events||!this._events[Ha])return this;for(var He=this._events[Ha],Hf=He.head;Hf;){if((!Hb||Hf.caller===Hb)&&Hf.method===Hc&&(!Hd||Hf.once)){Hj.delNode(He,Hf),He.cursor==Hf&&(He.cursor=Hf.next),Hj.recoverHandler(Hf);break}Hf=Hf.next}return this},Ha.offAll=function(Ha){var Hb=this._events;if(!Hb)return this;if(Ha)this._recoverHandlers(Hb[Ha]),delete Hb[Ha];else{for(var Hc in Hb)this._recoverHandlers(Hb[Hc]);this._events=null}return this},Ha._recoverHandlers=function(Ha){if(Ha){for(var Hb=Ha.head;Hb;){Hj.delNode(Ha,Hb);var Hc=Hb.next;Hj.recoverHandler(Hb),Hb=Hc}Ha.cursor=null}},Ha.isMouseEvent=function(Ha){return Hj.MOUSE_EVENTS[Ha]},Hj.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},Hj.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},Hj.delNode=function(Ha,Hb){Hb.prev?Hb.prev.next=Hb.next:Ha.head=Hb.next,Hb.next?Hb.next.prev=Hb.prev:Ha.tail=Hb.prev},Hj.createHandler=function(Ha,Hb,Hc,Hd){var He=Hj._freeHandler;return He?(Hj._freeCount--,Hj._freeHandler=He.next,He.caller=Ha,He.method=Hb,He.args=Hc,He.once=Hd):He={caller:Ha,method:Hb,args:Hc,once:Hd},He.prev=He.next=null,He},Hj.recoverHandler=function(Ha){Ha.caller=Ha.method=Ha.args=Ha.prev=null,Ha.next=Hj._freeHandler,Hj._freeHandler=Ha,Hj._freeCount++},Hj._freeHandler=null,Hj._freeCount=0,Hj}(),Hs=function(){function He(Ha,Hb,Hc,Hd){this.once=!1,void(this._id=0)===Hd&&(Hd=!1),this.setTo(Ha,Hb,Hc,Hd)}Hp(He,"laya.utils.Handler");var Ha=He.prototype;return Ha.setTo=function(Ha,Hb,Hc,Hd){return this._id=He._gid++,this.caller=Ha,this.method=Hb,this.args=Hc,this.once=Hd,this},Ha.run=function(){if(null==this.method)return null;var Ha=this._id,Hb=this.method.apply(this.caller,this.args);return this._id===Ha&&this.once&&this.recover(),Hb},Ha.runWith=function(Ha){if(null==this.method)return null;var Hb=this._id;if(null==Ha)var Hc=this.method.apply(this.caller,this.args);else Hc=this.args||Ha.unshift?this.args?this.method.apply(this.caller,this.args.concat(Ha)):this.method.apply(this.caller,Ha):this.method.call(this.caller,Ha);return this._id===Hb&&this.once&&this.recover(),Hc},Ha.clear=function(){return this.caller=null,this.method=null,this.args=null,this},Ha.recover=function(){0<this._id&&(this._id=0,this.clear())},He.create=function(Ha,Hb,Hc,Hd){return void 0===Hd&&(Hd=!0),new He(Ha,Hb,Hc,Hd)},He._gid=1,He}(),HB=function(){function Ha(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}Hp(Ha,"laya.display.BitmapFont");var Hb=Ha.prototype;return Hb.loadFont=function(Ha,Hb){this._path=Ha,this._complete=Hb,Hx.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],Hs.create(this,this.onLoaded))},Hb.onLoaded=function(){this.parseFont(Hha.getRes(this._path),Hha.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},Hb.parseFont=function(Ha,Hb){if(null!=Ha&&null!=Hb){this._texture=Hb;var Hc=Ha.getElementsByTagName("info");if(!Hc[0].getAttributeNode)return this.parseFont2(Ha,Hb);this.fontSize=parseInt(Hc[0].getAttributeNode("size").nodeValue);var Hd,He=Hc[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(He[0]),parseInt(He[1]),parseInt(He[2]),parseInt(He[3])],Hd=Ha.getElementsByTagName("char");var Hf=0;for(Hf=0;Hf<Hd.length;Hf++){var Hg=Hd[Hf],Hh=parseInt(Hg.getAttributeNode("id").nodeValue),Hi=parseInt(Hg.getAttributeNode("xoffset").nodeValue)/1,Hj=parseInt(Hg.getAttributeNode("yoffset").nodeValue)/1,Hk=parseInt(Hg.getAttributeNode("xadvance").nodeValue)/1,Hl=new Hz;Hl.x=parseInt(Hg.getAttributeNode("x").nodeValue),Hl.y=parseInt(Hg.getAttributeNode("y").nodeValue),Hl.width=parseInt(Hg.getAttributeNode("width").nodeValue),Hl.height=parseInt(Hg.getAttributeNode("height").nodeValue);var Hm=Hka.create(Hb,Hl.x,Hl.y,Hl.width,Hl.height,Hi,Hj);this._maxWidth=Math.max(this._maxWidth,Hk+this.letterSpacing),this._fontCharDic[Hh]=Hm,this._fontWidthMap[Hh]=Hk}}},Hb.parseFont2=function(Ha,Hb){if(null!=Ha&&null!=Hb){this._texture=Hb;var Hc=Ha.getElementsByTagName("info");this.fontSize=parseInt(Hc[0].attributes.size.nodeValue);var Hd=Hc[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(Hd[0]),parseInt(Hd[1]),parseInt(Hd[2]),parseInt(Hd[3])];var He=Ha.getElementsByTagName("char"),Hf=0;for(Hf=0;Hf<He.length;Hf++){var Hg=He[Hf].attributes,Hh=parseInt(Hg.id.nodeValue),Hi=parseInt(Hg.xoffset.nodeValue)/1,Hj=parseInt(Hg.yoffset.nodeValue)/1,Hk=parseInt(Hg.xadvance.nodeValue)/1,Hl=new Hz;Hl.x=parseInt(Hg.x.nodeValue),Hl.y=parseInt(Hg.y.nodeValue),Hl.width=parseInt(Hg.width.nodeValue),Hl.height=parseInt(Hg.height.nodeValue);var Hm=Hka.create(Hb,Hl.x,Hl.y,Hl.width,Hl.height,Hi,Hj);this._maxWidth=Math.max(this._maxWidth,Hk+this.letterSpacing),this._fontCharDic[Hh]=Hm,this._fontWidthMap[Hh]=Hk}}},Hb.getCharTexture=function(Ha){return this._fontCharDic[Ha.charCodeAt(0)]},Hb.destroy=function(){if(this._texture){for(var Ha in this._fontCharDic){var Hb=this._fontCharDic[Ha];Hb&&Hb.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},Hb.setSpaceWidth=function(Ha){this._spaceWidth=Ha},Hb.getCharWidth=function(Ha){var Hb=Ha.charCodeAt(0);return this._fontWidthMap[Hb]?this._fontWidthMap[Hb]+this.letterSpacing:" "==Ha?this._spaceWidth+this.letterSpacing:0},Hb.getTextWidth=function(Ha){for(var Hb=0,Hc=0,Hd=Ha.length;Hc<Hd;Hc++)Hb+=this.getCharWidth(Ha.charAt(Hc));return Hb},Hb.getMaxWidth=function(){return this._maxWidth},Hb.getMaxHeight=function(){return this.fontSize},Hb.drawText=function(Ha,Hb,Hc,Hd,He,Hf){var Hg,Hh=this.getTextWidth(Ha),Hi=0;"center"===He&&(Hi=(Hf-Hh)/2),"right"===He&&(Hi=Hf-Hh);for(var Hj=0,Hk=0,Hl=Ha.length;Hk<Hl;Hk++)(Hg=this.getCharTexture(Ha.charAt(Hk)))&&(Hb.graphics.drawTexture(Hg,Hc+Hj+Hi,Hd),Hj+=this.getCharWidth(Ha.charAt(Hk)))},Ha}(),Hh=function(){function Hc(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=Hc._TF_EMPTY}Hp(Hc,"laya.display.css.Style");var Ha=Hc.prototype;return Ha.getTransform=function(){return this._tf},Ha.setTransform=function(Ha){this._tf="none"!==Ha&&Ha?Ha:Hc._TF_EMPTY},Ha.setTranslateX=function(Ha){this._tf===Hc._TF_EMPTY&&(this._tf=new He),this._tf.translateX=Ha},Ha.setTranslateY=function(Ha){this._tf===Hc._TF_EMPTY&&(this._tf=new He),this._tf.translateY=Ha},Ha.setScaleX=function(Ha){this._tf===Hc._TF_EMPTY&&(this._tf=new He),this._tf.scaleX=Ha},Ha.setScale=function(Ha,Hb){this._tf===Hc._TF_EMPTY&&(this._tf=new He),this._tf.scaleX=Ha,this._tf.scaleY=Hb},Ha.setScaleY=function(Ha){this._tf===Hc._TF_EMPTY&&(this._tf=new He),this._tf.scaleY=Ha},Ha.setRotate=function(Ha){this._tf===Hc._TF_EMPTY&&(this._tf=new He),this._tf.rotate=Ha},Ha.setSkewX=function(Ha){this._tf===Hc._TF_EMPTY&&(this._tf=new He),this._tf.skewX=Ha},Ha.setSkewY=function(Ha){this._tf===Hc._TF_EMPTY&&(this._tf=new He),this._tf.skewY=Ha},Ha.destroy=function(){this.scrollRect=null},Ha.render=function(Ha,Hb,Hc,Hd){},Ha.getCSSStyle=function(){return Hba.EMPTY},Ha._enableLayout=function(){return!1},Hk(0,Ha,"scaleX",function(){return this._tf.scaleX},function(Ha){this.setScaleX(Ha)}),Hk(0,Ha,"transform",function(){return this.getTransform()},function(Ha){this.setTransform(Ha)}),Hk(0,Ha,"translateX",function(){return this._tf.translateX},function(Ha){this.setTranslateX(Ha)}),Hk(0,Ha,"translateY",function(){return this._tf.translateY},function(Ha){this.setTranslateY(Ha)}),Hk(0,Ha,"scaleY",function(){return this._tf.scaleY},function(Ha){this.setScaleY(Ha)}),Hk(0,Ha,"block",function(){return 0!=(1&this._type)}),Hk(0,Ha,"skewY",function(){return this._tf.skewY},function(Ha){this.setSkewY(Ha)}),Hk(0,Ha,"rotate",function(){return this._tf.rotate},function(Ha){this.setRotate(Ha)}),Hk(0,Ha,"skewX",function(){return this._tf.skewX},function(Ha){this.setSkewX(Ha)}),Hk(0,Ha,"paddingLeft",function(){return 0}),Hk(0,Ha,"paddingTop",function(){return 0}),Hk(0,Ha,"absolute",function(){return!0}),Hc.__init__=function(){Hc._TF_EMPTY=new He,Hc.EMPTY=new Hc},Hc.EMPTY=null,Hc._TF_EMPTY=null,Hc}(),Hn=function(){function Hb(Ha){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=HQ.create(Hb.defaultColor),this.family=Hb.defaultFamily,this.stroke=Hb._STROKE,this.size=Hb.defaultSize,Ha&&Ha!==Hb.EMPTY&&Ha.copyTo(this)}Hp(Hb,"laya.display.css.Font");var Ha=Hb.prototype;return Ha.set=function(Ha){this._text=null;for(var Hb=Ha.split(" "),Hc=0,Hd=Hb.length;Hc<Hd;Hc++){var He=Hb[Hc];switch(He){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<He.indexOf("px")&&(this.size=parseInt(He),this.family=Hb[Hc+1],Hc++)}},Ha.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},Ha.copyTo=function(Ha){Ha._type=this._type,Ha._text=this._text,Ha._weight=this._weight,Ha._color=this._color,Ha.family=this.family,Ha.stroke=this.stroke!=Hb._STROKE?this.stroke.slice():Hb._STROKE,Ha.indent=this.indent,Ha.size=this.size},Hk(0,Ha,"password",function(){return 0!=(1024&this._type)},function(Ha){Ha?this._type|=1024:this._type&=-1025}),Hk(0,Ha,"color",function(){return this._color.strColor},function(Ha){this._color=HQ.create(Ha)}),Hk(0,Ha,"italic",function(){return 0!=(512&this._type)},function(Ha){Ha?this._type|=512:this._type&=-513}),Hk(0,Ha,"bold",function(){return 0!=(2048&this._type)},function(Ha){Ha?this._type|=2048:this._type&=-2049}),Hk(0,Ha,"weight",function(){return""+this._weight},function(Ha){var Hb=0;switch(Ha){case"normal":break;case"bold":this.bold=!0,Hb=700;break;case"bolder":Hb=800;break;case"lighter":Hb=100;break;default:Hb=parseInt(Ha)}this._weight=Hb,this._text=null}),Hk(0,Ha,"decoration",function(){return this._decoration?this._decoration.value:null},function(Ha){var Hb=Ha.split(" ");switch(this._decoration||(this._decoration={}),Hb[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=Hb[0]}Hb[1]&&(this._decoration.color=HQ.create(Hb)),this._decoration.value=Ha}),Hb.__init__=function(){Hb.EMPTY=new Hb(null)},Hb.EMPTY=null,Hb.defaultColor="#000000",Hb.defaultSize=12,Hb.defaultFamily="Arial",Hb.defaultFont="12px Arial",Hb._STROKE=[0,"#000000"],Hb._ITALIC=512,Hb._PASSWORD=1024,Hb._BOLD=2048,Hb}(),He=function(){function Ha(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return Hp(Ha,"laya.display.css.TransformInfo"),Ha}(),Hm=function(){function Hl(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,HH.isConchNode){this._nativeObj=new Hg._conchGraphics,this.id=this._nativeObj.conchID}}Hp(Hl,"laya.display.Graphics");var Ha=Hl.prototype;return Ha.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},Ha.clear=function(Ha){void 0===Ha&&(Ha=!1);var Hb=0,Hc=0;if(Ha){var Hd=this._one;if(this._cmds){for(Hc=this._cmds.length,Hb=0;Hb<Hc;Hb++)!(Hd=this._cmds[Hb])||Hd.callee!==HH._context._drawTexture&&Hd.callee!==HH._context._drawTextureWithTransform||(Hd[0]=null,Hl._cache.push(Hd));this._cmds.length=0}else Hd&&(!Hd||Hd.callee!==HH._context._drawTexture&&Hd.callee!==HH._context._drawTextureWithTransform||(Hd[0]=null,Hl._cache.push(Hd)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(Hb=0,Hc=this._vectorgraphArray.length;Hb<Hc;Hb++)HZ.getInstance().deleteShape(this._vectorgraphArray[Hb]);this._vectorgraphArray.length=0}},Ha._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},Ha._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new Hc,this._graphicBounds._graphics=this)},Ha._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},Ha._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},Ha.getBounds=function(Ha){return void 0===Ha&&(Ha=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(Ha)},Ha.getBoundPoints=function(Ha){return void 0===Ha&&(Ha=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(Ha)},Ha._addCmd=function(Ha){this._cmds=this._cmds||[],Ha.callee=Ha.shift(),this._cmds.push(Ha)},Ha.setFilters=function(Ha){this._saveToCmd(HH._context._setFilters,Ha)},Ha.drawTexture=function(Ha,Hb,Hc,Hd,He,Hf,Hg){if(void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=0),void 0===He&&(He=0),void 0===Hg&&(Hg=1),!Ha||Hg<.01)return null;Hd||(Hd=Ha.sourceWidth),He||(He=Ha.sourceHeight),Hg=Hg<0?0:1<Hg?1:Hg;var Hh,Hi=!HH.isWebGL&&(HM.onFirefox||HM.onEdge||HM.onIE||HM.onSafari)?.5:0,Hj=Hd/Ha.sourceWidth,Hk=He/Ha.sourceHeight;return Hd=Ha.width*Hj,He=Ha.height*Hk,Ha.loaded&&(Hd<=0||He<=0)?null:(Hb+=Ha.offsetX*Hj,Hc+=Ha.offsetY*Hk,this._sp&&(this._sp._renderType|=512),Hb-=Hi,Hc-=Hi,Hd+=2*Hi,He+=2*Hi,Hl._cache.length?((Hh=Hl._cache.pop())[0]=Ha,Hh[1]=Hb,Hh[2]=Hc,Hh[3]=Hd,Hh[4]=He,Hh[5]=Hf,Hh[6]=Hg):Hh=[Ha,Hb,Hc,Hd,He,Hf,Hg],Hh.callee=Hf||1!=Hg?HH._context._drawTextureWithTransform:HH._context._drawTexture,null!=this._one||Hf||1!=Hg?this._saveToCmd(Hh.callee,Hh):(this._one=Hh,this._render=this._renderOneImg),Ha.loaded||Ha.once("loaded",this,this._textureLoaded,[Ha,Hh]),this._repaint(),Hh)},Ha.cleanByTexture=function(Ha,Hb,Hc,Hd,He){if(void 0===Hd&&(Hd=0),void 0===He&&(He=0),!Ha)return this.clear();if(this._one&&this._render===this._renderOneImg){Hd||(Hd=Ha.sourceWidth),He||(He=Ha.sourceHeight);var Hf=Hd/Ha.sourceWidth,Hg=He/Ha.sourceHeight;Hd=Ha.width*Hf,He=Ha.height*Hg,Hb+=Ha.offsetX*Hf,Hc+=Ha.offsetY*Hg,this._one[0]=Ha,this._one[1]=Hb,this._one[2]=Hc,this._one[3]=Hd,this._one[4]=He,this._repaint()}else this.clear(),Ha&&this.drawTexture(Ha,Hb,Hc,Hd,He)},Ha.drawTextures=function(Ha,Hb){Ha&&this._saveToCmd(HH._context._drawTextures,[Ha,Hb])},Ha.fillTexture=function(Ha,Hb,Hc,Hd,He,Hf,Hg){if(void 0===Hd&&(Hd=0),void 0===He&&(He=0),void 0===Hf&&(Hf="repeat"),Ha){var Hh=[Ha,Hb,Hc,Hd,He,Hf,Hg||Hy.EMPTY,{}];Ha.loaded||Ha.once("loaded",this,this._textureLoaded,[Ha,Hh]),this._saveToCmd(HH._context._fillTexture,Hh)}},Ha._textureLoaded=function(Ha,Hb){Hb[3]=Hb[3]||Ha.width,Hb[4]=Hb[4]||Ha.height,this._repaint()},Ha.fillCircle=function(Ha,Hb,Hc,Hd,He,Hf,Hg){Hc.bitmap.enableMerageInAtlas=!1;var Hh=new Float32Array(2*(Hg+1)),Hi=new Float32Array(2*(Hg+1)),Hj=new Uint16Array(3*Hg),Hk=2*Math.PI/Hg,Hl=0;Hh[0]=Hd,Hh[1]=He,Hi[0]=Hd/Hc.width,Hi[1]=He/Hc.height;for(var Hm=2,Hn=0;Hn<Hg;Hn++){var Ho=Hf*Math.cos(Hl)+Hd,Hp=Hf*Math.sin(Hl)+He;Hh[Hm]=Ho,Hh[Hm+1]=Hp,Hi[Hm]=Ho/Hc.width,Hi[Hm+1]=Hp/Hc.height,Hl+=Hk,Hm+=2}for(Hn=Hm=0;Hn<Hg;Hn++)Hj[Hm++]=0,Hj[Hm++]=Hn+1,Hj[Hm++]=Hg+1<=Hn+2?1:Hn+2;this.drawTriangles(Hc,Ha,Hb,Hh,Hi,Hj)},Ha.drawTriangles=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){void 0===Hh&&(Hh=1),this._saveToCmd(HH._context.drawTriangles,[Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj])},Ha._saveToCmd=function(Ha,Hb){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=Hb,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(Hb)),Hb.callee=Ha,this._repaint(),Hb},Ha.clipRect=function(Ha,Hb,Hc,Hd){this._saveToCmd(HH._context._clipRect,[Ha,Hb,Hc,Hd])},Ha.fillText=function(Ha,Hb,Hc,Hd,He,Hf,Hg){void 0===Hg&&(Hg=0),this._saveToCmd(HH._context._fillText,[Ha,Hb,Hc,Hd||Hn.defaultFont,He,Hf])},Ha.fillBorderText=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){this._saveToCmd(HH._context._fillBorderText,[Ha,Hb,Hc,Hd||Hn.defaultFont,He,Hf,Hg,Hh])},Ha.strokeText=function(Ha,Hb,Hc,Hd,He,Hf,Hg){this._saveToCmd(HH._context._strokeText,[Ha,Hb,Hc,Hd||Hn.defaultFont,He,Hf,Hg])},Ha.alpha=function(Ha){Ha=Ha<0?0:1<Ha?1:Ha,this._saveToCmd(HH._context._alpha,[Ha])},Ha.setAlpha=function(Ha){Ha=Ha<0?0:1<Ha?1:Ha,this._saveToCmd(HH._context._setAlpha,[Ha])},Ha.transform=function(Ha,Hb,Hc){void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),this._saveToCmd(HH._context._transform,[Ha,Hb,Hc])},Ha.rotate=function(Ha,Hb,Hc){void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),this._saveToCmd(HH._context._rotate,[Ha,Hb,Hc])},Ha.scale=function(Ha,Hb,Hc,Hd){void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=0),this._saveToCmd(HH._context._scale,[Ha,Hb,Hc,Hd])},Ha.translate=function(Ha,Hb){this._saveToCmd(HH._context._translate,[Ha,Hb])},Ha.save=function(){this._saveToCmd(HH._context._save,[])},Ha.restore=function(){this._saveToCmd(HH._context._restore,[])},Ha.replaceText=function(Ha){this._repaint();var Hb=this._cmds;if(Hb){for(var Hc=Hb.length-1;-1<Hc;Hc--)if(this._isTextCmd(Hb[Hc].callee))return Hb[Hc][0].toUpperCase?Hb[Hc][0]=Ha:Hb[Hc][0].setText(Ha),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=Ha:this._one[0].setText(Ha),!0;return!1},Ha._isTextCmd=function(Ha){return Ha===HH._context._fillText||Ha===HH._context._fillBorderText||Ha===HH._context._strokeText},Ha.replaceTextColor=function(Ha){this._repaint();var Hb=this._cmds;if(Hb)for(var Hc=Hb.length-1;-1<Hc;Hc--)this._isTextCmd(Hb[Hc].callee)&&(Hb[Hc][4]=Ha,Hb[Hc][0].toUpperCase||(Hb[Hc][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=Ha,this._one[0].toUpperCase||(this._one[0].changed=!0))},Ha.loadImage=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=this;void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=0),void 0===He&&(He=0);var Hh=Hha.getRes(Ha);function Hi(Ha){Ha&&(Hg.drawTexture(Ha,Hb,Hc,Hd,He),null!=Hf&&Hf.call(Hg._sp,Ha))}Hh?Hi(Hh):Hx.loader.load(Ha,Hs.create(null,Hi),null,"image")},Ha._renderEmpty=function(Ha,Hb,Hc,Hd){},Ha._renderAll=function(Ha,Hb,Hc,Hd){for(var He,Hf=this._cmds,Hg=0,Hh=Hf.length;Hg<Hh;Hg++)(He=Hf[Hg]).callee.call(Hb,Hc,Hd,He)},Ha._renderOne=function(Ha,Hb,Hc,Hd){this._one.callee.call(Hb,Hc,Hd,this._one)},Ha._renderOneImg=function(Ha,Hb,Hc,Hd){this._one.callee.call(Hb,Hc,Hd,this._one),2305!==Ha._renderType&&(Ha._renderType|=1)},Ha.drawLine=function(Ha,Hb,Hc,Hd,He,Hf){void 0===Hf&&(Hf=1);var Hg=0;HH.isWebGL&&(Hg=HZ.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Hg));var Hh=Hf%2==0?0:.5,Hi=[Ha+Hh,Hb+Hh,Hc+Hh,Hd+Hh,He,Hf,Hg];this._saveToCmd(HH._context._drawLine,Hi)},Ha.drawLines=function(Ha,Hb,Hc,Hd,He){void 0===He&&(He=1);var Hf=0;if(Hc&&!(Hc.length<4)){HH.isWebGL&&(Hf=HZ.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Hf));var Hg=He%2==0?0:.5,Hh=[Ha+Hg,Hb+Hg,Hc,Hd,He,Hf];this._saveToCmd(HH._context._drawLines,Hh)}},Ha.drawCurves=function(Ha,Hb,Hc,Hd,He){void 0===He&&(He=1);var Hf=[Ha,Hb,Hc,Hd,He];this._saveToCmd(HH._context._drawCurves,Hf)},Ha.drawRect=function(Ha,Hb,Hc,Hd,He,Hf,Hg){void 0===Hg&&(Hg=1);var Hh=Hf?Hg/2:0,Hi=Hf?Hg:0,Hj=[Ha+Hh,Hb+Hh,Hc-Hi,Hd-Hi,He,Hf,Hg];this._saveToCmd(HH._context._drawRect,Hj)},Ha.drawCircle=function(Ha,Hb,Hc,Hd,He,Hf){void 0===Hf&&(Hf=1);var Hg=He?Hf/2:0,Hh=0;HH.isWebGL&&(Hh=HZ.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Hh));var Hi=[Ha,Hb,Hc-Hg,Hd,He,Hf,Hh];this._saveToCmd(HH._context._drawCircle,Hi)},Ha.drawPie=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){void 0===Hh&&(Hh=1);var Hi=Hg?Hh/2:0,Hj=Hg?Hh:0,Hk=0;HH.isWebGL&&(Hk=HZ.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Hk));var Hl=[Ha+Hi,Hb+Hi,Hc-Hj,Hd,He,Hf,Hg,Hh,Hk];Hl[3]=HY.toRadian(Hd),Hl[4]=HY.toRadian(He),this._saveToCmd(HH._context._drawPie,Hl)},Ha.drawPoly=function(Ha,Hb,Hc,Hd,He,Hf){void 0===Hf&&(Hf=1);var Hg=0,Hh=!1;HH.isWebGL&&(Hg=HZ.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Hg),Hh=!(6<Hc.length));var Hi=He?Hf%2==0?0:.5:0,Hj=[Ha+Hi,Hb+Hi,Hc,Hd,He,Hf,Hg,Hh];this._saveToCmd(HH._context._drawPoly,Hj)},Ha.drawPath=function(Ha,Hb,Hc,Hd,He){var Hf=[Ha,Hb,Hc,Hd,He];this._saveToCmd(HH._context._drawPath,Hf)},Hk(0,Ha,"cmds",function(){return this._cmds},function(Ha){this._sp&&(this._sp._renderType|=512),this._cmds=Ha,this._render=this._renderAll,this._repaint()}),Hl.__init__=function(){if(HH.isConchNode){for(var Ha=laya.display.Graphics.prototype,Hb=HM.window.ConchGraphics.prototype,Hc=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],Hd=0,He=Hc.length;Hd<=He;Hd++){var Hf=Hc[Hd];Ha[Hf]=Hb[Hf]}Ha._saveToCmd=null,Hb.drawImageS&&(Ha.drawTextures=function(Ha,Hb){if(Ha&&Ha.loaded&&Ha.bitmap&&Ha.source){var Hc=Ha.uv,Hd=Ha.bitmap.width,He=Ha.bitmap.height;this.drawImageS(Ha.bitmap.source,Hc[0]*Hd,Hc[1]*He,(Hc[2]-Hc[0])*Hd,(Hc[5]-Hc[3])*He,Ha.offsetX,Ha.offsetY,Ha.width,Ha.height,Hb)}}),Ha.drawTexture=function(Ha,Hb,Hc,Hd,He,Hf,Hg){if(void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=0),void 0===He&&(He=0),void 0===Hg&&(Hg=1),Ha)if(Ha.loaded){if(Ha.loaded&&Ha.bitmap&&Ha.source&&(Hd||(Hd=Ha.sourceWidth),He||(He=Ha.sourceHeight),Hg=Hg<0?0:1<Hg?1:Hg,Hd=Hd-Ha.sourceWidth+Ha.width,He=He-Ha.sourceHeight+Ha.height,!(Hd<=0||He<=0))){Hb+=Ha.offsetX,Hc+=Ha.offsetY;var Hh=Ha.uv,Hi=Ha.bitmap.width,Hj=Ha.bitmap.height;Hh[4]<Hh[0]&&Hh[5]<Hh[1]?this.drawImageM(Ha.bitmap.source,Hh[4]*Hi,Hh[5]*Hj,(Hh[0]-Hh[4])*Hi,(Hh[1]-Hh[5])*Hj,Hb,Hc,Hd,He,Hf,Hg):this.drawImageM(Ha.bitmap.source,Hh[0]*Hi,Hh[1]*Hj,(Hh[2]-Hh[0])*Hi,(Hh[5]-Hh[3])*Hj,Hb,Hc,Hd,He,Hf,Hg),this._repaint()}}else Ha.once("loaded",this,function(){this.drawTexture(Ha,Hb,Hc,Hd,He,Hf)})},Ha.fillTexture=function(Ha,Hb,Hc,Hd,He,Hf,Hg){if(void 0===Hd&&(Hd=0),void 0===He&&(He=0),void 0===Hf&&(Hf="repeat"),Ha&&Ha.loaded){var Hh,Hi=HH._context.ctx,Hj=Ha.bitmap.width,Hk=Ha.bitmap.height,Hl=Ha.uv;Hh=Ha.uv!=Hka.DEF_UV?Hi.createPattern(Ha.bitmap.source,Hf,Hl[0]*Hj,Hl[1]*Hk,(Hl[2]-Hl[0])*Hj,(Hl[5]-Hl[3])*Hk):Hi.createPattern(Ha.bitmap.source,Hf);var Hm=0,Hn=0;Hg&&(Hb+=Hg.x%Ha.width,Hc+=Hg.y%Ha.height,Hm-=Hg.x%Ha.width,Hn-=Hg.y%Ha.height),this._fillImage(Hh,Hb,Hc,Hm,Hn,Hd,He)}}}},Hl._cache=[],Hl}(),Hc=function(){function Ht(){this._cacheBoundsType=!1}Hp(Ht,"laya.display.GraphicsBounds");var Ha=Ht.prototype;return Ha.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},Ha.reset=function(){this._temp&&(this._temp.length=0)},Ha.getBounds=function(Ha){return void 0===Ha&&(Ha=!1),(!this._bounds||!this._temp||this._temp.length<1||Ha!=this._cacheBoundsType)&&(this._bounds=Hz._getWrapRec(this.getBoundPoints(Ha),this._bounds)),this._cacheBoundsType=Ha,this._bounds},Ha.getBoundPoints=function(Ha){return void 0===Ha&&(Ha=!1),(!this._temp||this._temp.length<1||Ha!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(Ha)),this._cacheBoundsType=Ha,this._rstBoundPoints=HY.copyArray(this._rstBoundPoints,this._temp)},Ha._getCmdPoints=function(Ha){void 0===Ha&&(Ha=!1);var Hb,Hc,Hd=HH._context,He=this._graphics.cmds;if((Hb=this._temp||(this._temp=[])).length=0,He||null==this._graphics._one||(Ht._tempCmds.length=0,Ht._tempCmds.push(this._graphics._one),He=Ht._tempCmds),!He)return Hb;(Hc=Ht._tempMatrixArrays).length=0;var Hf=Ht._initMatrix;Hf.identity();for(var Hg,Hh,Hi=Ht._tempMatrix,Hj=NaN,Hk=NaN,Hl=NaN,Hm=NaN,Hn=NaN,Ho=NaN,Hp=0,Hq=He.length;Hp<Hq;Hp++)if((Hg=He[Hp]).callee)switch(Hg.callee){case Hd._save:case 7:Hc.push(Hf),Hf=Hf.clone();break;case Hd._restore:case 8:Hf=Hc.pop();break;case Hd._scale:case 5:Hi.identity(),Hi.translate(-Hg[2],-Hg[3]),Hi.scale(Hg[0],Hg[1]),Hi.translate(Hg[2],Hg[3]),this._switchMatrix(Hf,Hi);break;case Hd._rotate:case 3:Hi.identity(),Hi.translate(-Hg[1],-Hg[2]),Hi.rotate(Hg[0]),Hi.translate(Hg[1],Hg[2]),this._switchMatrix(Hf,Hi);break;case Hd._translate:case 6:Hi.identity(),Hi.translate(Hg[0],Hg[1]),this._switchMatrix(Hf,Hi);break;case Hd._transform:case 4:Hi.identity(),Hi.translate(-Hg[1],-Hg[2]),Hi.concat(Hg[0]),Hi.translate(Hg[1],Hg[2]),this._switchMatrix(Hf,Hi);break;case 16:case 24:Ht._addPointArrToRst(Hb,Hz._getBoundPointS(Hg[0],Hg[1],Hg[2],Hg[3]),Hf);break;case 17:Hf.copyTo(Hi),Hi.concat(Hg[4]),Ht._addPointArrToRst(Hb,Hz._getBoundPointS(Hg[0],Hg[1],Hg[2],Hg[3]),Hi);break;case Hd._drawTexture:Hh=Hg[0],Ha?Hg[3]&&Hg[4]?Ht._addPointArrToRst(Hb,Hz._getBoundPointS(Hg[1],Hg[2],Hg[3],Hg[4]),Hf):(Hh=Hg[0],Ht._addPointArrToRst(Hb,Hz._getBoundPointS(Hg[1],Hg[2],Hh.width,Hh.height),Hf)):(Hj=(Hg[3]||Hh.sourceWidth)/Hh.width,Hk=(Hg[4]||Hh.sourceHeight)/Hh.height,Hl=Hj*Hh.sourceWidth,Hm=Hk*Hh.sourceHeight,Hn=0<Hh.offsetX?Hh.offsetX:0,Ho=0<Hh.offsetY?Hh.offsetY:0,Hn*=Hj,Ho*=Hk,Ht._addPointArrToRst(Hb,Hz._getBoundPointS(Hg[1]-Hn,Hg[2]-Ho,Hl,Hm),Hf));break;case Hd._fillTexture:Hg[3]&&Hg[4]?Ht._addPointArrToRst(Hb,Hz._getBoundPointS(Hg[1],Hg[2],Hg[3],Hg[4]),Hf):(Hh=Hg[0],Ht._addPointArrToRst(Hb,Hz._getBoundPointS(Hg[1],Hg[2],Hh.width,Hh.height),Hf));break;case Hd._drawTextureWithTransform:var Hr;Hr=Hg[5]?(Hf.copyTo(Hi),Hi.concat(Hg[5]),Hi):Hf,Ha?Hg[3]&&Hg[4]?Ht._addPointArrToRst(Hb,Hz._getBoundPointS(Hg[1],Hg[2],Hg[3],Hg[4]),Hr):(Hh=Hg[0],Ht._addPointArrToRst(Hb,Hz._getBoundPointS(Hg[1],Hg[2],Hh.width,Hh.height),Hr)):(Hh=Hg[0],Hj=(Hg[3]||Hh.sourceWidth)/Hh.width,Hk=(Hg[4]||Hh.sourceHeight)/Hh.height,Hl=Hj*Hh.sourceWidth,Hm=Hk*Hh.sourceHeight,Hn=0<Hh.offsetX?Hh.offsetX:0,Ho=0<Hh.offsetY?Hh.offsetY:0,Hn*=Hj,Ho*=Hk,Ht._addPointArrToRst(Hb,Hz._getBoundPointS(Hg[1]-Hn,Hg[2]-Ho,Hl,Hm),Hr));break;case Hd._drawRect:case 13:Ht._addPointArrToRst(Hb,Hz._getBoundPointS(Hg[0],Hg[1],Hg[2],Hg[3]),Hf);break;case Hd._drawCircle:case Hd._fillCircle:case 14:Ht._addPointArrToRst(Hb,Hz._getBoundPointS(Hg[0]-Hg[2],Hg[1]-Hg[2],Hg[2]+Hg[2],Hg[2]+Hg[2]),Hf);break;case Hd._drawLine:case 20:Ht._tempPoints.length=0;var Hs;Hs=.5*Hg[5],Hg[0]==Hg[2]?Ht._tempPoints.push(Hg[0]+Hs,Hg[1],Hg[2]+Hs,Hg[3],Hg[0]-Hs,Hg[1],Hg[2]-Hs,Hg[3]):Hg[1]==Hg[3]?Ht._tempPoints.push(Hg[0],Hg[1]+Hs,Hg[2],Hg[3]+Hs,Hg[0],Hg[1]-Hs,Hg[2],Hg[3]-Hs):Ht._tempPoints.push(Hg[0],Hg[1],Hg[2],Hg[3]),Ht._addPointArrToRst(Hb,Ht._tempPoints,Hf);break;case Hd._drawCurves:case 22:Ht._addPointArrToRst(Hb,Hu.I.getBezierPoints(Hg[2]),Hf,Hg[0],Hg[1]);break;case Hd._drawPoly:case Hd._drawLines:case 18:Ht._addPointArrToRst(Hb,Hg[2],Hf,Hg[0],Hg[1]);break;case Hd._drawPath:case 19:Ht._addPointArrToRst(Hb,this._getPathPoints(Hg[2]),Hf,Hg[0],Hg[1]);break;case Hd._drawPie:case 15:Ht._addPointArrToRst(Hb,this._getPiePoints(Hg[0],Hg[1],Hg[2],Hg[3],Hg[4]),Hf)}return 200<Hb.length?Hb=HY.copyArray(Hb,Hz._getWrapRec(Hb)._getBoundPoints()):8<Hb.length&&(Hb=Hv.scanPList(Hb)),Hb},Ha._switchMatrix=function(Ha,Hb){Hb.concat(Ha),Hb.copyTo(Ha)},Ha._getPiePoints=function(Ha,Hb,Hc,Hd,He){var Hf=Ht._tempPoints;Ht._tempPoints.length=0,Hf.push(Ha,Hb);var Hg=(He-Hd)%(2*Math.PI)/10,Hh=NaN,Hi=Hd;for(Hh=0;Hh<=10;Hh++)Hf.push(Ha+Hc*Math.cos(Hi),Hb+Hc*Math.sin(Hi)),Hi+=Hg;return Hf},Ha._getPathPoints=function(Ha){var Hb,Hc,Hd=0,He=Ht._tempPoints;for(He.length=0,Hb=Ha.length,Hd=0;Hd<Hb;Hd++)1<(Hc=Ha[Hd]).length&&(He.push(Hc[1],Hc[2]),3<Hc.length&&He.push(Hc[3],Hc[4]));return He},Ht._addPointArrToRst=function(Ha,Hb,Hc,Hd,He){void 0===Hd&&(Hd=0),void 0===He&&(He=0);var Hf,Hg=0;for(Hf=Hb.length,Hg=0;Hg<Hf;Hg+=2)Ht._addPointToRst(Ha,Hb[Hg]+Hd,Hb[Hg+1]+He,Hc)},Ht._addPointToRst=function(Ha,Hb,Hc,Hd){var He=Hy.TEMP;He.setTo(Hb||0,Hc||0),Hd.transformPoint(He),Ha.push(He.x,He.y)},Ht._tempPoints=[],Ht._tempMatrixArrays=[],Ht._tempCmds=[],Hi(Ht,["_tempMatrix",function(){return this._tempMatrix=new HE},"_initMatrix",function(){return this._initMatrix=new HE}]),Ht}(),Hf=function(){function Ha(){}Hp(Ha,"laya.events.Event");var Hb=Ha.prototype;return Hb.setTo=function(Ha,Hb,Hc){return this.type=Ha,this.currentTarget=Hb,this.target=Hc,this},Hb.stopPropagation=function(){this._stoped=!0},Hk(0,Hb,"stageY",function(){return Hx.stage.mouseY}),Hk(0,Hb,"charCode",function(){return this.nativeEvent.charCode}),Hk(0,Hb,"touches",function(){var Ha=this.nativeEvent.touches;if(Ha)for(var Hb=Hx.stage,Hc=0,Hd=Ha.length;Hc<Hd;Hc++){var He=Ha[Hc],Hf=Hy.TEMP;Hf.setTo(He.clientX,He.clientY),Hb._canvasTransform.invertTransformPoint(Hf),Hb.transform.invertTransformPoint(Hf),He.stageX=Hf.x,He.stageY=Hf.y}return Ha}),Hk(0,Hb,"keyLocation",function(){return this.nativeEvent.keyLocation}),Hk(0,Hb,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),Hk(0,Hb,"altKey",function(){return this.nativeEvent.altKey}),Hk(0,Hb,"shiftKey",function(){return this.nativeEvent.shiftKey}),Hk(0,Hb,"stageX",function(){return Hx.stage.mouseX}),Ha.EMPTY=new Ha,Ha.MOUSE_DOWN="mousedown",Ha.MOUSE_UP="mouseup",Ha.CLICK="click",Ha.RIGHT_MOUSE_DOWN="rightmousedown",Ha.RIGHT_MOUSE_UP="rightmouseup",Ha.RIGHT_CLICK="rightclick",Ha.MOUSE_MOVE="mousemove",Ha.MOUSE_OVER="mouseover",Ha.MOUSE_OUT="mouseout",Ha.MOUSE_WHEEL="mousewheel",Ha.ROLL_OVER="mouseover",Ha.ROLL_OUT="mouseout",Ha.DOUBLE_CLICK="doubleclick",Ha.CHANGE="change",Ha.CHANGED="changed",Ha.RESIZE="resize",Ha.ADDED="added",Ha.REMOVED="removed",Ha.DISPLAY="display",Ha.UNDISPLAY="undisplay",Ha.ERROR="error",Ha.COMPLETE="complete",Ha.LOADED="loaded",Ha.INITED="inited",Ha.PROGRESS="progress",Ha.INPUT="input",Ha.RENDER="render",Ha.OPEN="open",Ha.MESSAGE="message",Ha.CLOSE="close",Ha.KEY_DOWN="keydown",Ha.KEY_PRESS="keypress",Ha.KEY_UP="keyup",Ha.FRAME="enterframe",Ha.DRAG_START="dragstart",Ha.DRAG_MOVE="dragmove",Ha.DRAG_END="dragend",Ha.ENTER="enter",Ha.SELECT="select",Ha.BLUR="blur",Ha.FOCUS="focus",Ha.VISIBILITY_CHANGE="visibilitychange",Ha.FOCUS_CHANGE="focuschange",Ha.PLAYED="played",Ha.PAUSED="paused",Ha.STOPPED="stopped",Ha.START="start",Ha.END="end",Ha.ENABLE_CHANGED="enablechanged",Ha.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",Ha.COMPONENT_ADDED="componentadded",Ha.COMPONENT_REMOVED="componentremoved",Ha.LAYER_CHANGED="layerchanged",Ha.HIERARCHY_LOADED="hierarchyloaded",Ha.RECOVERED="recovered",Ha.RELEASED="released",Ha.LINK="link",Ha.LABEL="label",Ha.FULL_SCREEN_CHANGE="fullscreenchange",Ha.DEVICE_LOST="devicelost",Ha.MESH_CHANGED="meshchanged",Ha.MATERIAL_CHANGED="materialchanged",Ha.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",Ha.ANIMATION_CHANGED="animationchanged",Ha.TRIGGER_ENTER="triggerenter",Ha.TRIGGER_STAY="triggerstay",Ha.TRIGGER_EXIT="triggerexit",Ha.TRAIL_FILTER_CHANGE="trailfilterchange",Ha.DOMINO_FILTER_CHANGE="dominofilterchange",Ha}(),Hl=(function(){function Ha(){}Hp(Ha,"laya.events.Keyboard"),Ha.NUMBER_0=48,Ha.NUMBER_1=49,Ha.NUMBER_2=50,Ha.NUMBER_3=51,Ha.NUMBER_4=52,Ha.NUMBER_5=53,Ha.NUMBER_6=54,Ha.NUMBER_7=55,Ha.NUMBER_8=56,Ha.NUMBER_9=57,Ha.A=65,Ha.B=66,Ha.C=67,Ha.D=68,Ha.E=69,Ha.F=70,Ha.G=71,Ha.H=72,Ha.I=73,Ha.J=74,Ha.K=75,Ha.L=76,Ha.M=77,Ha.N=78,Ha.O=79,Ha.P=80,Ha.Q=81,Ha.R=82,Ha.S=83,Ha.T=84,Ha.U=85,Ha.V=86,Ha.W=87,Ha.X=88,Ha.Y=89,Ha.Z=90,Ha.F1=112,Ha.F2=113,Ha.F3=114,Ha.F4=115,Ha.F5=116,Ha.F6=117,Ha.F7=118,Ha.F8=119,Ha.F9=120,Ha.F10=121,Ha.F11=122,Ha.F12=123,Ha.F13=124,Ha.F14=125,Ha.F15=126,Ha.NUMPAD=21,Ha.NUMPAD_0=96,Ha.NUMPAD_1=97,Ha.NUMPAD_2=98,Ha.NUMPAD_3=99,Ha.NUMPAD_4=100,Ha.NUMPAD_5=101,Ha.NUMPAD_6=102,Ha.NUMPAD_7=103,Ha.NUMPAD_8=104,Ha.NUMPAD_9=105,Ha.NUMPAD_ADD=107,Ha.NUMPAD_DECIMAL=110,Ha.NUMPAD_DIVIDE=111,Ha.NUMPAD_ENTER=108,Ha.NUMPAD_MULTIPLY=106,Ha.NUMPAD_SUBTRACT=109,Ha.SEMICOLON=186,Ha.EQUAL=187,Ha.COMMA=188,Ha.MINUS=189,Ha.PERIOD=190,Ha.SLASH=191,Ha.BACKQUOTE=192,Ha.LEFTBRACKET=219,Ha.BACKSLASH=220,Ha.RIGHTBRACKET=221,Ha.QUOTE=222,Ha.ALTERNATE=18,Ha.BACKSPACE=8,Ha.CAPS_LOCK=20,Ha.COMMAND=15,Ha.CONTROL=17,Ha.DELETE=46,Ha.ENTER=13,Ha.ESCAPE=27,Ha.PAGE_UP=33,Ha.PAGE_DOWN=34,Ha.END=35,Ha.HOME=36,Ha.LEFT=37,Ha.UP=38,Ha.RIGHT=39,Ha.DOWN=40,Ha.SHIFT=16,Ha.SPACE=32,Ha.TAB=9,Ha.INSERT=45}(),function(){function He(){}return Hp(He,"laya.events.KeyBoardManager"),He.__init__=function(){He._addEvent("keydown"),He._addEvent("keypress"),He._addEvent("keyup")},He._addEvent=function(Hb){HM.document.addEventListener(Hb,function(Ha){laya.events.KeyBoardManager._dispatch(Ha,Hb)},!0)},He._dispatch=function(Ha,Hb){if(He.enabled){He._event._stoped=!1,He._event.nativeEvent=Ha,He._event.keyCode=Ha.keyCode||Ha.which||Ha.charCode,"keydown"===Hb?He._pressKeys[He._event.keyCode]=!0:"keyup"===Hb&&(He._pressKeys[He._event.keyCode]=null);for(var Hc=Hx.stage.focus&&null!=Hx.stage.focus.event&&Hx.stage.focus.displayedInStage?Hx.stage.focus:Hx.stage,Hd=Hc;Hd;)Hd.event(Hb,He._event.setTo(Hb,Hd,Hc)),Hd=Hd.parent}},He.hasKeyDown=function(Ha){return He._pressKeys[Ha]},He._pressKeys={},He.enabled=!0,Hi(He,["_event",function(){return this._event=new Hf}]),He}()),Ho=(function(){function Ha(){}Hp(Ha,"laya.events.KeyLocation"),Ha.STANDARD=0,Ha.LEFT=1,Ha.RIGHT=2,Ha.NUM_PAD=3}(),function(){function Hk(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=HM.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new Hf,this._matrix=new HE,this._point=new Hy,this._rect=new Hz,this._prePoint=new Hy,this._curTouchID=NaN}Hp(Hk,"laya.events.MouseManager");var Ha=Hk.prototype;return Ha.__init__=function(Ha,Hb){var Hc=this;this._stage=Ha;var Hd=this,He=this._eventList;Hb.oncontextmenu=function(Ha){if(Hk.enabled)return!1},Hb.addEventListener("mousedown",function(Ha){Hk.enabled&&(HM.onIE||Ha.preventDefault(),He.push(Ha),Hd.mouseDownTime=HM.now())}),Hb.addEventListener("mouseup",function(Ha){Hk.enabled&&(Ha.preventDefault(),He.push(Ha),Hd.mouseDownTime=-HM.now())},!0),Hb.addEventListener("mousemove",function(Ha){if(Hk.enabled){Ha.preventDefault();var Hb=HM.now();if(Hb-Hd._lastMoveTimer<10)return;Hd._lastMoveTimer=Hb,He.push(Ha)}},!0),Hb.addEventListener("mouseout",function(Ha){Hk.enabled&&He.push(Ha)}),Hb.addEventListener("mouseover",function(Ha){Hk.enabled&&He.push(Ha)}),Hb.addEventListener("touchstart",function(Ha){Hk.enabled&&(He.push(Ha),Hk._isFirstTouch||Hva.isInputting||Ha.preventDefault(),Hd.mouseDownTime=HM.now())}),Hb.addEventListener("touchend",function(Ha){Hk.enabled?(Hk._isFirstTouch||Hva.isInputting||Ha.preventDefault(),Hk._isFirstTouch=!1,He.push(Ha),Hd.mouseDownTime=-HM.now()):Hc._curTouchID=NaN},!0),Hb.addEventListener("touchmove",function(Ha){Hk.enabled&&(Ha.preventDefault(),He.push(Ha))},!0),Hb.addEventListener("touchcancel",function(Ha){Hk.enabled?(Ha.preventDefault(),He.push(Ha)):Hc._curTouchID=NaN},!0),Hb.addEventListener("mousewheel",function(Ha){Hk.enabled&&He.push(Ha)}),Hb.addEventListener("DOMMouseScroll",function(Ha){Hk.enabled&&He.push(Ha)})},Ha.initEvent=function(Ha,Hb){var Hc;this._event._stoped=!1,this._event.nativeEvent=Hb||Ha,this._target=null,this._point.setTo(Ha.pageX||Ha.clientX,Ha.pageY||Ha.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=Ha.identifier||0,this._tTouchID=this._event.touchId,(Hc=Hq.I._event)._stoped=!1,Hc.nativeEvent=this._event.nativeEvent,Hc.touchId=this._event.touchId},Ha.checkMouseWheel=function(Ha){this._event.delta=Ha.wheelDelta?.025*Ha.wheelDelta:-Ha.detail;for(var Hb=Hq.I.getLastOvers(),Hc=0,Hd=Hb.length;Hc<Hd;Hc++){var He=Hb[Hc];He.event("mousewheel",this._event.setTo("mousewheel",He,this._target))}},Ha.onMouseMove=function(Ha){Hq.I.onMouseMove(Ha,this._tTouchID)},Ha.onMouseDown=function(Ha){if(Hva.isInputting&&Hx.stage.focus&&Hx.stage.focus.focus&&!Hx.stage.focus.contains(this._target)){var Hb=Hx.stage.focus._tf||Hx.stage.focus,Hc=Ha._tf||Ha;Hc instanceof laya.display.Input&&Hc.multiline==Hb.multiline?Hb._focusOut():Hb.focus=!1}Hq.I.onMouseDown(Ha,this._tTouchID,this._isLeftMouse)},Ha.onMouseUp=function(Ha){Hq.I.onMouseUp(Ha,this._tTouchID,this._isLeftMouse)},Ha.check=function(Ha,Hb,Hc,Hd){this._point.setTo(Hb,Hc),Ha.fromParentPoint(this._point),Hb=this._point.x,Hc=this._point.y;var He=Ha.scrollRect;if(He&&(this._rect.setTo(He.x,He.y,He.width,He.height),!this._rect.contains(Hb,Hc)))return!1;if(!this.disableMouseEvent){if(Ha.hitTestPrior&&!Ha.mouseThrough&&!this.hitTest(Ha,Hb,Hc))return!1;for(var Hf=Ha._childs.length-1;-1<Hf;Hf--){var Hg=Ha._childs[Hf];if(!Hg.destroyed&&Hg.mouseEnabled&&Hg.visible&&this.check(Hg,Hb,Hc,Hd))return!0}}var Hh=!(!Ha.hitTestPrior||Ha.mouseThrough||this.disableMouseEvent)||this.hitTest(Ha,Hb,Hc);return Hh?(this._target=Ha,Hd.call(this,Ha)):Hd===this.onMouseUp&&Ha===this._stage&&(this._target=this._stage,Hd.call(this,this._target)),Hh},Ha.hitTest=function(Ha,Hb,Hc){var Hd=!1;if(Ha.scrollRect&&(Hb-=Ha.scrollRect.x,Hc-=Ha.scrollRect.y),Ha.hitArea instanceof laya.utils.HitArea)return Ha.hitArea.isHit(Hb,Hc);if(0<Ha.width&&0<Ha.height||Ha.mouseThrough||Ha.hitArea)if(Ha.mouseThrough)Hd=Ha.getGraphicBounds().contains(Hb,Hc);else{var He=this._rect;Ha.hitArea?He=Ha.hitArea:He.setTo(0,0,Ha.width,Ha.height),Hd=He.contains(Hb,Hc)}return Hd},Ha.runEvent=function(){var Ha=this._eventList.length;if(Ha){var Hb=this;Hb.mouseEventTime=HM.now();var Hc,Hd=0,He=0,Hf=0;try{for(;Hd<Ha;){var Hg=this._eventList[Hd];switch("mousemove"!==Hg.type&&(this._prePoint.x=this._prePoint.y=-1e6),Hg.type){case"mousedown":this._touchIDs[0]=this._id++,Hk._isTouchRespond?Hk._isTouchRespond=!1:(Hb._isLeftMouse=0===Hg.button,Hb.initEvent(Hg),Hb.check(Hb._stage,Hb.mouseX,Hb.mouseY,Hb.onMouseDown));break;case"mouseup":Hb._isLeftMouse=0===Hg.button,Hb.initEvent(Hg),Hb.check(Hb._stage,Hb.mouseX,Hb.mouseY,Hb.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-Hg.clientX)+Math.abs(this._prePoint.y-Hg.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=Hg.clientX,this._prePoint.y=Hg.clientY,Hb.initEvent(Hg),Hb.check(Hb._stage,Hb.mouseX,Hb.mouseY,Hb.onMouseMove));break;case"touchstart":Hk._isTouchRespond=!0,Hb._isLeftMouse=!0;var Hh=Hg.changedTouches;for(He=0,Hf=Hh.length;He<Hf;He++)Hc=Hh[He],(Hk.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=Hc.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[Hc.identifier]=this._id++,Hb.initEvent(Hc,Hg),Hb.check(Hb._stage,Hb.mouseX,Hb.mouseY,Hb.onMouseDown));break;case"touchend":case"touchcancel":Hk._isTouchRespond=!0,Hb._isLeftMouse=!0;var Hi=Hg.changedTouches;for(He=0,Hf=Hi.length;He<Hf;He++)if(Hc=Hi[He],Hk.multiTouchEnabled||Hc.identifier==this._curTouchID){this._curTouchID=NaN,Hb.initEvent(Hc,Hg);Hb.check(Hb._stage,Hb.mouseX,Hb.mouseY,Hb.onMouseUp)||Hb.onMouseUp(null)}break;case"touchmove":var Hj=Hg.changedTouches;for(He=0,Hf=Hj.length;He<Hf;He++)Hc=Hj[He],(Hk.multiTouchEnabled||Hc.identifier==this._curTouchID)&&(Hb.initEvent(Hc,Hg),Hb.check(Hb._stage,Hb.mouseX,Hb.mouseY,Hb.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":Hb.checkMouseWheel(Hg);break;case"mouseout":Hq.I.stageMouseOut();break;case"mouseover":Hb._stage.event("mouseover",Hb._event.setTo("mouseover",Hb._stage,Hb._stage))}Hd++}}catch(Ha){throw this._eventList.length=0,Ha}this._eventList.length=0}},Hk.enabled=!0,Hk.multiTouchEnabled=!0,Hk._isTouchRespond=!1,Hk._isFirstTouch=!0,Hi(Hk,["instance",function(){return this.instance=new Hk}]),Hk}()),Hq=function(){function Ho(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new Hf}Hp(Ho,"laya.events.TouchManager");var Ha=Ho.prototype;return Ha._clearTempArrs=function(){Ho._oldArr.length=0,Ho._newArr.length=0,Ho._tEleArr.length=0},Ha.getTouchFromArr=function(Ha,Hb){var Hc,Hd,He=0;for(Hc=Hb.length,He=0;He<Hc;He++)if((Hd=Hb[He]).id==Ha)return Hd;return null},Ha.removeTouchFromArr=function(Ha,Hb){var Hc=0;for(Hc=Hb.length-1;0<=Hc;Hc--)Hb[Hc].id==Ha&&Hb.splice(Hc,1)},Ha.createTouchO=function(Ha,Hb){var Hc;return(Hc=HU.getItem("TouchData")||{}).id=Hb,Hc.tar=Ha,Hc},Ha.onMouseDown=function(Ha,Hb,Hc){var Hd,He,Hf,Hg;(void 0===Hc&&(Hc=!1),this.enable)&&(Hd=this.getTouchFromArr(Hb,this.preOvers),Hf=this.getEles(Ha,null,Ho._tEleArr),Hd?Hd.tar=Ha:(He=this.createTouchO(Ha,Hb),this.preOvers.push(He)),HM.onMobile&&this.sendEvents(Hf,"mouseover",Hb),Hg=Hc?this.preDowns:this.preRightDowns,(Hd=this.getTouchFromArr(Hb,Hg))?Hd.tar=Ha:(He=this.createTouchO(Ha,Hb),Hg.push(He)),this.sendEvents(Hf,Hc?"mousedown":"rightmousedown",Hb),this._clearTempArrs())},Ha.sendEvents=function(Ha,Hb,Hc){void 0===Hc&&(Hc=0);var Hd,He,Hf,Hg=0;for(Hd=Ha.length,this._event._stoped=!1,He=Ha[0],Hg=0;Hg<Hd;Hg++){if((Hf=Ha[Hg]).destroyed)return;if(Hf.event(Hb,this._event.setTo(Hb,Hf,He)),this._event._stoped)break}},Ha.getEles=function(Ha,Hb,Hc){for(Hc?Hc.length=0:Hc=[];Ha&&Ha!=Hb;)Hc.push(Ha),Ha=Ha.parent;return Hc},Ha.checkMouseOutAndOverOfMove=function(Ha,Hb,Hc){if(void 0===Hc&&(Hc=0),Hb!=Ha){var Hd,He,Hf=0,Hg=0;if(Hb.contains(Ha))He=this.getEles(Ha,Hb,Ho._tEleArr),this.sendEvents(He,"mouseover",Hc);else if(Ha.contains(Hb))He=this.getEles(Hb,Ha,Ho._tEleArr),this.sendEvents(He,"mouseout",Hc);else{var Hh,Hi;(He=Ho._tEleArr).length=0,Hh=this.getEles(Hb,null,Ho._oldArr),Hi=this.getEles(Ha,null,Ho._newArr),Hg=Hh.length;var Hj=0;for(Hf=0;Hf<Hg;Hf++){if(Hd=Hh[Hf],0<=(Hj=Hi.indexOf(Hd))){Hi.splice(Hj,Hi.length-Hj);break}He.push(Hd)}0<He.length&&this.sendEvents(He,"mouseout",Hc),0<Hi.length&&this.sendEvents(Hi,"mouseover",Hc)}}},Ha.onMouseMove=function(Ha,Hb){var Hc,Hd;this.enable&&((Hc=this.getTouchFromArr(Hb,this.preOvers))?(this.checkMouseOutAndOverOfMove(Ha,Hc.tar),Hc.tar=Ha,Hd=this.getEles(Ha,null,Ho._tEleArr)):(Hd=this.getEles(Ha,null,Ho._tEleArr),this.sendEvents(Hd,"mouseover",Hb),this.preOvers.push(this.createTouchO(Ha,Hb))),this.sendEvents(Hd,"mousemove",Hb),this._clearTempArrs())},Ha.getLastOvers=function(){return(Ho._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,Ho._tEleArr):(Ho._tEleArr.push(Hx.stage),Ho._tEleArr)},Ha.stageMouseOut=function(){var Ha;Ha=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(Ha,"mouseout",0)},Ha.onMouseUp=function(Ha,Hb,Hc){if(void 0===Hc&&(Hc=!1),this.enable){var Hd,He,Hf,Hg,Hh,Hi,Hj=0,Hk=0,Hl=HM.onMobile;if(He=this.getEles(Ha,null,Ho._tEleArr),this.sendEvents(He,Hc?"mouseup":"rightmouseup",Hb),Hi=Hc?this.preDowns:this.preRightDowns,Hd=this.getTouchFromArr(Hb,Hi)){var Hm,Hn=HM.now();if(Hm=Hn-this._lastClickTime<300,this._lastClickTime=Hn,Ha==Hd.tar)Hh=He;else for(Hf=this.getEles(Hd.tar,null,Ho._oldArr),(Hh=Ho._newArr).length=0,Hk=Hf.length,Hj=0;Hj<Hk;Hj++)Hg=Hf[Hj],0<=He.indexOf(Hg)&&Hh.push(Hg);0<Hh.length&&this.sendEvents(Hh,Hc?"click":"rightclick",Hb),Hc&&Hm&&this.sendEvents(Hh,"doubleclick",Hb),this.removeTouchFromArr(Hb,Hi),Hd.tar=null,HU.recover("TouchData",Hd)}else;(Hd=this.getTouchFromArr(Hb,this.preOvers))&&Hl&&((Hh=this.getEles(Hd.tar,null,Hh))&&0<Hh.length&&this.sendEvents(Hh,"mouseout",Hb),this.removeTouchFromArr(Hb,this.preOvers),Hd.tar=null,HU.recover("TouchData",Hd)),this._clearTempArrs()}},Ho._oldArr=[],Ho._newArr=[],Ho._tEleArr=[],Hi(Ho,["I",function(){return this.I=new Ho}]),Ho}(),Hr=function(){function Ha(){this._action=null}Hp(Ha,"laya.filters.Filter");var Hb=Ha.prototype;return Hx.imps(Hb,{"laya.filters.IFilter":!0}),Hb.callNative=function(Ha){},Hk(0,Hb,"type",function(){return-1}),Hk(0,Hb,"action",function(){return this._action}),Ha.BLUR=16,Ha.COLOR=32,Ha.GLOW=8,Ha._filterStart=null,Ha._filterEnd=null,Ha._EndTarget=null,Ha._recycleScope=null,Ha._filter=null,Ha._useSrc=null,Ha._endSrc=null,Ha._useOut=null,Ha._endOut=null,Ha}(),Ht=function(){function Ha(){this.data=null}Hp(Ha,"laya.filters.ColorFilterAction");var Hb=Ha.prototype;return Hx.imps(Hb,{"laya.filters.IFilterAction":!0}),Hb.apply=function(Ha){var Hb=Ha.ctx.ctx,Hc=Ha.ctx.ctx.canvas;if(0==Hc.width||0==Hc.height)return Hc;for(var Hd,He=Hb.getImageData(0,0,Hc.width,Hc.height),Hf=He.data,Hg=0,Hh=Hf.length;Hg<Hh;Hg+=4)Hd=this.getColor(Hf[Hg],Hf[Hg+1],Hf[Hg+2],Hf[Hg+3]),0!=Hf[Hg+3]&&(Hf[Hg]=Hd[0],Hf[Hg+1]=Hd[1],Hf[Hg+2]=Hd[2],Hf[Hg+3]=Hd[3]);return Hb.putImageData(He,0,0),Ha},Hb.getColor=function(Ha,Hb,Hc,Hd){var He=[];if(this.data._mat&&this.data._alpha){var Hf=this.data._mat,Hg=this.data._alpha;He[0]=Hf[0]*Ha+Hf[1]*Hb+Hf[2]*Hc+Hf[3]*Hd+Hg[0],He[1]=Hf[4]*Ha+Hf[5]*Hb+Hf[6]*Hc+Hf[7]*Hd+Hg[1],He[2]=Hf[8]*Ha+Hf[9]*Hb+Hf[10]*Hc+Hf[11]*Hd+Hg[2],He[3]=Hf[12]*Ha+Hf[13]*Hb+Hf[14]*Hc+Hf[15]*Hd+Hg[3]}return He},Ha}(),Hu=(function(){function Ha(){}Hp(Ha,"laya.maths.Arith"),Ha.formatR=function(Ha){return Ha>Math.PI&&(Ha-=2*Math.PI),Ha<-Math.PI&&(Ha+=2*Math.PI),Ha},Ha.isPOT=function(Ha,Hb){return 0<Ha&&0==(Ha&Ha-1)&&0<Hb&&0==(Hb&Hb-1)},Ha.setMatToArray=function(Ha,Hb){Ha.a,Ha.b,Ha.c,Ha.d,Ha.tx,Ha.ty,Hb[0]=Ha.a,Hb[1]=Ha.b,Hb[4]=Ha.c,Hb[5]=Ha.d,Hb[12]=Ha.tx,Hb[13]=Ha.ty}}(),function(){function Ha(){this._controlPoints=[new Hy,new Hy,new Hy],this._calFun=this.getPoint2}Hp(Ha,"laya.maths.Bezier");var Hb=Ha.prototype;return Hb._switchPoint=function(Ha,Hb){var Hc=this._controlPoints.shift();Hc.setTo(Ha,Hb),this._controlPoints.push(Hc)},Hb.getPoint2=function(Ha,Hb){var Hc=this._controlPoints[0],Hd=this._controlPoints[1],He=this._controlPoints[2],Hf=Math.pow(1-Ha,2)*Hc.x+2*Ha*(1-Ha)*Hd.x+Math.pow(Ha,2)*He.x,Hg=Math.pow(1-Ha,2)*Hc.y+2*Ha*(1-Ha)*Hd.y+Math.pow(Ha,2)*He.y;Hb.push(Hf,Hg)},Hb.getPoint3=function(Ha,Hb){var Hc=this._controlPoints[0],Hd=this._controlPoints[1],He=this._controlPoints[2],Hf=this._controlPoints[3],Hg=Math.pow(1-Ha,3)*Hc.x+3*Hd.x*Ha*(1-Ha)*(1-Ha)+3*He.x*Ha*Ha*(1-Ha)+Hf.x*Math.pow(Ha,3),Hh=Math.pow(1-Ha,3)*Hc.y+3*Hd.y*Ha*(1-Ha)*(1-Ha)+3*He.y*Ha*Ha*(1-Ha)+Hf.y*Math.pow(Ha,3);Hb.push(Hg,Hh)},Hb.insertPoints=function(Ha,Hb){var Hc,Hd=NaN;for(Hc=1/(Ha=0<Ha?Ha:5),Hd=0;Hd<=1;Hd+=Hc)this._calFun(Hd,Hb)},Hb.getBezierPoints=function(Ha,Hb,Hc){void 0===Hb&&(Hb=5),void 0===Hc&&(Hc=2);var Hd,He,Hf=0;if((Hd=Ha.length)<2*(Hc+1))return[];switch(He=[],Hc){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=Hc;)this._controlPoints.push(new Hy);for(Hf=0;Hf<2*Hc;Hf+=2)this._switchPoint(Ha[Hf],Ha[Hf+1]);for(Hf=2*Hc;Hf<Hd;Hf+=2)this._switchPoint(Ha[Hf],Ha[Hf+1]),Hf/2%Hc==0&&this.insertPoints(Hb,He);return He},Hi(Ha,["I",function(){return this.I=new Ha}]),Ha}()),Hv=function(){function Hj(){}return Hp(Hj,"laya.maths.GrahamScan"),Hj.multiply=function(Ha,Hb,Hc){return(Ha.x-Hc.x)*(Hb.y-Hc.y)-(Hb.x-Hc.x)*(Ha.y-Hc.y)},Hj.dis=function(Ha,Hb){return(Ha.x-Hb.x)*(Ha.x-Hb.x)+(Ha.y-Hb.y)*(Ha.y-Hb.y)},Hj._getPoints=function(Ha,Hb,Hc){for(void 0===Hb&&(Hb=!1),Hj._mPointList||(Hj._mPointList=[]);Hj._mPointList.length<Ha;)Hj._mPointList.push(new Hy);return Hc||(Hc=[]),Hc.length=0,Hb?Hj.getFrom(Hc,Hj._mPointList,Ha):Hj.getFromR(Hc,Hj._mPointList,Ha),Hc},Hj.getFrom=function(Ha,Hb,Hc){var Hd=0;for(Hd=0;Hd<Hc;Hd++)Ha.push(Hb[Hd]);return Ha},Hj.getFromR=function(Ha,Hb,Hc){var Hd=0;for(Hd=0;Hd<Hc;Hd++)Ha.push(Hb.pop());return Ha},Hj.pListToPointList=function(Ha,Hb){void 0===Hb&&(Hb=!1);var Hc=0,Hd=Ha.length/2,He=Hj._getPoints(Hd,Hb,Hj._tempPointList);for(Hc=0;Hc<Hd;Hc++)He[Hc].setTo(Ha[Hc+Hc],Ha[Hc+Hc+1]);return He},Hj.pointListToPlist=function(Ha){var Hb,Hc=0,Hd=Ha.length,He=Hj._temPList;for(Hc=He.length=0;Hc<Hd;Hc++)Hb=Ha[Hc],He.push(Hb.x,Hb.y);return He},Hj.scanPList=function(Ha){return HY.copyArray(Ha,Hj.pointListToPlist(Hj.scan(Hj.pListToPointList(Ha,!0))))},Hj.scan=function(Ha){var Hb,Hc,Hd,He=0,Hf=0,Hg=0,Hh=Ha.length,Hi={};for((Hc=Hj._temArr).length=0,He=(Hh=Ha.length)-1;0<=He;He--)Hd=(Hb=Ha[He]).x+"_"+Hb.y,Hi.hasOwnProperty(Hd)||(Hi[Hd]=!0,Hc.push(Hb));for(Hh=Hc.length,HY.copyArray(Ha,Hc),He=1;He<Hh;He++)(Ha[He].y<Ha[Hg].y||Ha[He].y==Ha[Hg].y&&Ha[He].x<Ha[Hg].x)&&(Hg=He);for(Hb=Ha[0],Ha[0]=Ha[Hg],Ha[Hg]=Hb,He=1;He<Hh-1;He++){for(Hf=(Hg=He)+1;Hf<Hh;Hf++)(0<Hj.multiply(Ha[Hf],Ha[Hg],Ha[0])||0==Hj.multiply(Ha[Hf],Ha[Hg],Ha[0])&&Hj.dis(Ha[0],Ha[Hf])<Hj.dis(Ha[0],Ha[Hg]))&&(Hg=Hf);Hb=Ha[He],Ha[He]=Ha[Hg],Ha[Hg]=Hb}if((Hc=Hj._temArr).length=0,Ha.length<3)return HY.copyArray(Hc,Ha);for(Hc.push(Ha[0],Ha[1],Ha[2]),He=3;He<Hh;He++){for(;2<=Hc.length&&0<=Hj.multiply(Ha[He],Hc[Hc.length-1],Hc[Hc.length-2]);)Hc.pop();Ha[He]&&Hc.push(Ha[He])}return Hc},Hj._mPointList=null,Hj._tempPointList=[],Hj._temPList=[],Hj._temArr=[],Hj}(),Hw=function(){function He(){}return Hp(He,"laya.maths.MathUtil"),He.subtractVector3=function(Ha,Hb,Hc){Hc[0]=Ha[0]-Hb[0],Hc[1]=Ha[1]-Hb[1],Hc[2]=Ha[2]-Hb[2]},He.lerp=function(Ha,Hb,Hc){return Ha*(1-Hc)+Hb*Hc},He.scaleVector3=function(Ha,Hb,Hc){Hc[0]=Ha[0]*Hb,Hc[1]=Ha[1]*Hb,Hc[2]=Ha[2]*Hb},He.lerpVector3=function(Ha,Hb,Hc,Hd){var He=Ha[0],Hf=Ha[1],Hg=Ha[2];Hd[0]=He+Hc*(Hb[0]-He),Hd[1]=Hf+Hc*(Hb[1]-Hf),Hd[2]=Hg+Hc*(Hb[2]-Hg)},He.lerpVector4=function(Ha,Hb,Hc,Hd){var He=Ha[0],Hf=Ha[1],Hg=Ha[2],Hh=Ha[3];Hd[0]=He+Hc*(Hb[0]-He),Hd[1]=Hf+Hc*(Hb[1]-Hf),Hd[2]=Hg+Hc*(Hb[2]-Hg),Hd[3]=Hh+Hc*(Hb[3]-Hh)},He.slerpQuaternionArray=function(Ha,Hb,Hc,Hd,He,Hf,Hg){var Hh,Hi,Hj,Hk,Hl,Hm=Ha[Hb+0],Hn=Ha[Hb+1],Ho=Ha[Hb+2],Hp=Ha[Hb+3],Hq=Hc[Hd+0],Hr=Hc[Hd+1],Hs=Hc[Hd+2],Ht=Hc[Hd+3];return(Hi=Hm*Hq+Hn*Hr+Ho*Hs+Hp*Ht)<0&&(Hi=-Hi,Hq=-Hq,Hr=-Hr,Hs=-Hs,Ht=-Ht),Hl=1e-6<1-Hi?(Hh=Math.acos(Hi),Hj=Math.sin(Hh),Hk=Math.sin((1-He)*Hh)/Hj,Math.sin(He*Hh)/Hj):(Hk=1-He,He),Hf[Hg+0]=Hk*Hm+Hl*Hq,Hf[Hg+1]=Hk*Hn+Hl*Hr,Hf[Hg+2]=Hk*Ho+Hl*Hs,Hf[Hg+3]=Hk*Hp+Hl*Ht,Hf},He.getRotation=function(Ha,Hb,Hc,Hd){return Math.atan2(Hd-Hb,Hc-Ha)/Math.PI*180},He.sortBigFirst=function(Ha,Hb){return Ha==Hb?0:Ha<Hb?1:-1},He.sortSmallFirst=function(Ha,Hb){return Ha==Hb?0:Ha<Hb?-1:1},He.sortNumBigFirst=function(Ha,Hb){return parseFloat(Hb)-parseFloat(Ha)},He.sortNumSmallFirst=function(Ha,Hb){return parseFloat(Ha)-parseFloat(Hb)},He.sortByKey=function(Hc,Ha,Hb){var Hd;return void 0===Ha&&(Ha=!1),void 0===Hb&&(Hb=!0),Hd=Ha?Hb?He.sortNumBigFirst:He.sortBigFirst:Hb?He.sortNumSmallFirst:He.sortSmallFirst,function(Ha,Hb){return Hd(Ha[Hc],Hb[Hc])}},He}(),HE=function(){function Hc(Ha,Hb,Hc,Hd,He,Hf){this.inPool=!1,this.bTransform=!1,void 0===Ha&&(Ha=1),void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=1),void 0===He&&(He=0),void 0===Hf&&(Hf=0),this.a=Ha,this.b=Hb,this.c=Hc,this.d=Hd,this.tx=He,this.ty=Hf,this._checkTransform()}Hp(Hc,"laya.maths.Matrix");var Ha=Hc.prototype;return Ha.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},Ha._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},Ha.setTranslate=function(Ha,Hb){return this.tx=Ha,this.ty=Hb,this},Ha.translate=function(Ha,Hb){return this.tx+=Ha,this.ty+=Hb,this},Ha.scale=function(Ha,Hb){this.a*=Ha,this.d*=Hb,this.c*=Ha,this.b*=Hb,this.tx*=Ha,this.ty*=Hb,this.bTransform=!0},Ha.rotate=function(Ha){var Hb=Math.cos(Ha),Hc=Math.sin(Ha),Hd=this.a,He=this.c,Hf=this.tx;this.a=Hd*Hb-this.b*Hc,this.b=Hd*Hc+this.b*Hb,this.c=He*Hb-this.d*Hc,this.d=He*Hc+this.d*Hb,this.tx=Hf*Hb-this.ty*Hc,this.ty=Hf*Hc+this.ty*Hb,this.bTransform=!0},Ha.skew=function(Ha,Hb){var Hc=Math.tan(Ha),Hd=Math.tan(Hb),He=this.a,Hf=this.b;return this.a+=Hd*this.c,this.b+=Hd*this.d,this.c+=Hc*He,this.d+=Hc*Hf,this},Ha.invertTransformPoint=function(Ha){var Hb=this.a,Hc=this.b,Hd=this.c,He=this.d,Hf=this.tx,Hg=Hb*He-Hc*Hd,Hh=He/Hg,Hi=-Hc/Hg,Hj=-Hd/Hg,Hk=Hb/Hg,Hl=(Hd*this.ty-He*Hf)/Hg,Hm=-(Hb*this.ty-Hc*Hf)/Hg;return Ha.setTo(Hh*Ha.x+Hj*Ha.y+Hl,Hi*Ha.x+Hk*Ha.y+Hm)},Ha.transformPoint=function(Ha){return Ha.setTo(this.a*Ha.x+this.c*Ha.y+this.tx,this.b*Ha.x+this.d*Ha.y+this.ty)},Ha.transformPointN=function(Ha){return Ha.setTo(this.a*Ha.x+this.c*Ha.y,this.b*Ha.x+this.d*Ha.y)},Ha.transformPointArray=function(Ha,Hb){for(var Hc=Ha.length,Hd=0;Hd<Hc;Hd+=2){var He=Ha[Hd],Hf=Ha[Hd+1];Hb[Hd]=this.a*He+this.c*Hf+this.tx,Hb[Hd+1]=this.b*He+this.d*Hf+this.ty}return Hb},Ha.transformPointArrayScale=function(Ha,Hb){for(var Hc=Ha.length,Hd=0;Hd<Hc;Hd+=2){var He=Ha[Hd],Hf=Ha[Hd+1];Hb[Hd]=this.a*He+this.c*Hf,Hb[Hd+1]=this.b*He+this.d*Hf}return Hb},Ha.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},Ha.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},Ha.invert=function(){var Ha=this.a,Hb=this.b,Hc=this.c,Hd=this.d,He=this.tx,Hf=Ha*Hd-Hb*Hc;return this.a=Hd/Hf,this.b=-Hb/Hf,this.c=-Hc/Hf,this.d=Ha/Hf,this.tx=(Hc*this.ty-Hd*He)/Hf,this.ty=-(Ha*this.ty-Hb*He)/Hf,this},Ha.setTo=function(Ha,Hb,Hc,Hd,He,Hf){return this.a=Ha,this.b=Hb,this.c=Hc,this.d=Hd,this.tx=He,this.ty=Hf,this},Ha.concat=function(Ha){var Hb=this.a,Hc=this.c,Hd=this.tx;return this.a=Hb*Ha.a+this.b*Ha.c,this.b=Hb*Ha.b+this.b*Ha.d,this.c=Hc*Ha.a+this.d*Ha.c,this.d=Hc*Ha.b+this.d*Ha.d,this.tx=Hd*Ha.a+this.ty*Ha.c+Ha.tx,this.ty=Hd*Ha.b+this.ty*Ha.d+Ha.ty,this},Ha.scaleEx=function(Ha,Hb){var Hc=this.a,Hd=this.b,He=this.c,Hf=this.d;0!==Hd||0!==He?(this.a=Ha*Hc,this.b=Ha*Hd,this.c=Hb*He):(this.a=Ha*Hc,this.b=0*Hf,this.c=0*Hc),this.d=Hb*Hf,this.bTransform=!0},Ha.rotateEx=function(Ha){var Hb=Math.cos(Ha),Hc=Math.sin(Ha),Hd=this.a,He=this.b,Hf=this.c,Hg=this.d;0!==He||0!==Hf?(this.a=Hb*Hd+Hc*Hf,this.b=Hb*He+Hc*Hg,this.c=-Hc*Hd+Hb*Hf,this.d=-Hc*He+Hb*Hg):(this.a=Hb*Hd,this.b=Hc*Hg,this.c=-Hc*Hd,this.d=Hb*Hg),this.bTransform=!0},Ha.clone=function(){var Ha=Hc.create();return Ha.a=this.a,Ha.b=this.b,Ha.c=this.c,Ha.d=this.d,Ha.tx=this.tx,Ha.ty=this.ty,Ha.bTransform=this.bTransform,Ha},Ha.copyTo=function(Ha){return Ha.a=this.a,Ha.b=this.b,Ha.c=this.c,Ha.d=this.d,Ha.tx=this.tx,Ha.ty=this.ty,Ha.bTransform=this.bTransform,Ha},Ha.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},Ha.destroy=function(){if(!this.inPool){var Ha=Hc._cache;this.inPool=!0,Ha._length||(Ha._length=0),(Ha[Ha._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},Hc.mul=function(Ha,Hb,Hc){var Hd=Ha.a,He=Ha.b,Hf=Ha.c,Hg=Ha.d,Hh=Ha.tx,Hi=Ha.ty,Hj=Hb.a,Hk=Hb.b,Hl=Hb.c,Hm=Hb.d,Hn=Hb.tx,Ho=Hb.ty;return 0!==Hk||0!==Hl?(Hc.a=Hd*Hj+He*Hl,Hc.b=Hd*Hk+He*Hm,Hc.c=Hf*Hj+Hg*Hl,Hc.d=Hf*Hk+Hg*Hm,Hc.tx=Hj*Hh+Hl*Hi+Hn,Hc.ty=Hk*Hh+Hm*Hi+Ho):(Hc.a=Hd*Hj,Hc.b=He*Hm,Hc.c=Hf*Hj,Hc.d=Hg*Hm,Hc.tx=Hj*Hh+Hn,Hc.ty=Hm*Hi+Ho),Hc},Hc.mul16=function(Ha,Hb,Hc){var Hd=Ha.a,He=Ha.b,Hf=Ha.c,Hg=Ha.d,Hh=Ha.tx,Hi=Ha.ty,Hj=Hb.a,Hk=Hb.b,Hl=Hb.c,Hm=Hb.d,Hn=Hb.tx,Ho=Hb.ty;return 0!==Hk||0!==Hl?(Hc[0]=Hd*Hj+He*Hl,Hc[1]=Hd*Hk+He*Hm,Hc[4]=Hf*Hj+Hg*Hl,Hc[5]=Hf*Hk+Hg*Hm,Hc[12]=Hj*Hh+Hl*Hi+Hn,Hc[13]=Hk*Hh+Hm*Hi+Ho):(Hc[0]=Hd*Hj,Hc[1]=He*Hm,Hc[4]=Hf*Hj,Hc[5]=Hg*Hm,Hc[12]=Hj*Hh+Hn,Hc[13]=Hm*Hi+Ho),Hc},Hc.mulPre=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){var Hi=Ha.a,Hj=Ha.b,Hk=Ha.c,Hl=Ha.d,Hm=Ha.tx,Hn=Ha.ty;return 0!==Hc||0!==Hd?(Hh.a=Hi*Hb+Hj*Hd,Hh.b=Hi*Hc+Hj*He,Hh.c=Hk*Hb+Hl*Hd,Hh.d=Hk*Hc+Hl*He,Hh.tx=Hb*Hm+Hd*Hn+Hf,Hh.ty=Hc*Hm+He*Hn+Hg):(Hh.a=Hi*Hb,Hh.b=Hj*He,Hh.c=Hk*Hb,Hh.d=Hl*He,Hh.tx=Hb*Hm+Hf,Hh.ty=He*Hn+Hg),Hh},Hc.mulPos=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){var Hi=Ha.a,Hj=Ha.b,Hk=Ha.c,Hl=Ha.d,Hm=Ha.tx,Hn=Ha.ty;return 0!==Hj||0!==Hk?(Hh.a=Hb*Hi+Hc*Hk,Hh.b=Hb*Hj+Hc*Hl,Hh.c=Hd*Hi+He*Hk,Hh.d=Hd*Hj+He*Hl,Hh.tx=Hi*Hf+Hk*Hg+Hm,Hh.ty=Hj*Hf+Hl*Hg+Hn):(Hh.a=Hb*Hi,Hh.b=Hc*Hl,Hh.c=Hd*Hi,Hh.d=He*Hl,Hh.tx=Hi*Hf+Hm,Hh.ty=Hl*Hg+Hn),Hh},Hc.preMul=function(Ha,Hb,Hc){var Hd=Ha.a,He=Ha.b,Hf=Ha.c,Hg=Ha.d,Hh=Hb.a,Hi=Hb.b,Hj=Hb.c,Hk=Hb.d,Hl=Hb.tx,Hm=Hb.ty;return Hc.a=Hh*Hd,Hc.b=Hc.c=0,Hc.d=Hk*Hg,Hc.tx=Hl*Hd+Ha.tx,Hc.ty=Hm*Hg+Ha.ty,0===Hi&&0===Hj&&0===He&&0===Hf||(Hc.a+=Hi*Hf,Hc.d+=Hj*He,Hc.b+=Hh*He+Hi*Hg,Hc.c+=Hj*Hd+Hk*Hf,Hc.tx+=Hm*Hf,Hc.ty+=Hl*He),Hc},Hc.preMulXY=function(Ha,Hb,Hc,Hd){var He=Ha.a,Hf=Ha.b,Hg=Ha.c,Hh=Ha.d;return Hd.a=He,Hd.b=Hf,Hd.c=Hg,Hd.d=Hh,Hd.tx=Hb*He+Ha.tx+Hc*Hg,Hd.ty=Hc*Hh+Ha.ty+Hb*Hf,Hd},Hc.create=function(){var Ha=Hc._cache,Hb=Ha._length?Ha[--Ha._length]:new Hc;return Hb.inPool=!1,Hb},Hc.EMPTY=new Hc,Hc.TEMP=new Hc,Hc._cache=[],Hc}(),Hy=function(){function Ha(Ha,Hb){void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),this.x=Ha,this.y=Hb}Hp(Ha,"laya.maths.Point");var Hb=Ha.prototype;return Hb.setTo=function(Ha,Hb){return this.x=Ha,this.y=Hb,this},Hb.distance=function(Ha,Hb){return Math.sqrt((this.x-Ha)*(this.x-Ha)+(this.y-Hb)*(this.y-Hb))},Hb.toString=function(){return this.x+","+this.y},Hb.normalize=function(){var Ha=Math.sqrt(this.x*this.x+this.y*this.y);if(0<Ha){var Hb=1/Ha;this.x*=Hb,this.y*=Hb}},Ha.TEMP=new Ha,Ha.EMPTY=new Ha,Ha}(),Hz=function(){function Hj(Ha,Hb,Hc,Hd){void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=0),this.x=Ha,this.y=Hb,this.width=Hc,this.height=Hd}Hp(Hj,"laya.maths.Rectangle");var Ha=Hj.prototype;return Ha.setTo=function(Ha,Hb,Hc,Hd){return this.x=Ha,this.y=Hb,this.width=Hc,this.height=Hd,this},Ha.copyFrom=function(Ha){return this.x=Ha.x,this.y=Ha.y,this.width=Ha.width,this.height=Ha.height,this},Ha.contains=function(Ha,Hb){return!(this.width<=0||this.height<=0)&&(Ha>=this.x&&Ha<this.right&&Hb>=this.y&&Hb<this.bottom)},Ha.intersects=function(Ha){return!(Ha.x>this.x+this.width||Ha.x+Ha.width<this.x||Ha.y>this.y+this.height||Ha.y+Ha.height<this.y)},Ha.intersection=function(Ha,Hb){return this.intersects(Ha)?(Hb||(Hb=new Hj),Hb.x=Math.max(this.x,Ha.x),Hb.y=Math.max(this.y,Ha.y),Hb.width=Math.min(this.right,Ha.right)-Hb.x,Hb.height=Math.min(this.bottom,Ha.bottom)-Hb.y,Hb):null},Ha.union=function(Ha,Hb){return Hb||(Hb=new Hj),this.clone(Hb),Ha.width<=0||Ha.height<=0?Hb:(Hb.addPoint(Ha.x,Ha.y),Hb.addPoint(Ha.right,Ha.bottom),this)},Ha.clone=function(Ha){return Ha||(Ha=new Hj),Ha.x=this.x,Ha.y=this.y,Ha.width=this.width,Ha.height=this.height,Ha},Ha.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},Ha.equals=function(Ha){return!(!Ha||Ha.x!==this.x||Ha.y!==this.y||Ha.width!==this.width||Ha.height!==this.height)},Ha.addPoint=function(Ha,Hb){return this.x>Ha&&(this.width+=this.x-Ha,this.x=Ha),this.y>Hb&&(this.height+=this.y-Hb,this.y=Hb),this.width<Ha-this.x&&(this.width=Ha-this.x),this.height<Hb-this.y&&(this.height=Hb-this.y),this},Ha._getBoundPoints=function(){var Ha=Hj._temB;return(Ha.length=0)==this.width||0==this.height||Ha.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),Ha},Ha.isEmpty=function(){return this.width<=0||this.height<=0},Hk(0,Ha,"right",function(){return this.x+this.width}),Hk(0,Ha,"bottom",function(){return this.y+this.height}),Hj._getBoundPointS=function(Ha,Hb,Hc,Hd){var He=Hj._temA;return(He.length=0)==Hc||0==Hd||He.push(Ha,Hb,Ha+Hc,Hb,Ha,Hb+Hd,Ha+Hc,Hb+Hd),He},Hj._getWrapRec=function(Ha,Hb){if(!Ha||Ha.length<1)return Hb?Hb.setTo(0,0,0,0):Hj.TEMP.setTo(0,0,0,0);Hb=Hb||new Hj;var Hc,Hd,He,Hf,Hg,Hh=Ha.length,Hi=Hy.TEMP;for(He=Hg=-(Hd=Hf=99999),Hc=0;Hc<Hh;Hc+=2)Hi.x=Ha[Hc],Hi.y=Ha[Hc+1],Hd=Hd<Hi.x?Hd:Hi.x,Hf=Hf<Hi.y?Hf:Hi.y,He=He>Hi.x?He:Hi.x,Hg=Hg>Hi.y?Hg:Hi.y;return Hb.setTo(Hd,Hf,He-Hd,Hg-Hf)},Hj.EMPTY=new Hj,Hj.TEMP=new Hj,Hj._temB=[],Hj._temA=[],Hj}(),HC=function(){function Hi(){}return Hp(Hi,"laya.media.SoundManager"),Hk(1,Hi,"useAudioMusic",function(){return Hi._useAudioMusic},function(Ha){Hi._useAudioMusic=Ha,Hi._musicClass=Ha?Hca:null}),Hk(1,Hi,"autoStopMusic",function(){return Hi._autoStopMusic},function(Ha){Hx.stage.off("blur",null,Hi._stageOnBlur),Hx.stage.off("focus",null,Hi._stageOnFocus),Hx.stage.off("visibilitychange",null,Hi._visibilityChange),(Hi._autoStopMusic=Ha)&&(Hx.stage.on("blur",null,Hi._stageOnBlur),Hx.stage.on("focus",null,Hi._stageOnFocus),Hx.stage.on("visibilitychange",null,Hi._visibilityChange))}),Hk(1,Hi,"muted",function(){return Hi._muted},function(Ha){Ha!=Hi._muted&&(Ha&&Hi.stopAllSound(),Hi.musicMuted=Ha,Hi._muted=Ha)}),Hk(1,Hi,"musicMuted",function(){return Hi._musicMuted},function(Ha){Ha!=Hi._musicMuted&&(Ha?(Hi._tMusic&&Hi._musicChannel&&!Hi._musicChannel.isStopped?Hi._musicChannel.pause():Hi._musicChannel=null,Hi._musicMuted=Ha):(Hi._musicMuted=Ha,Hi._tMusic&&Hi._musicChannel&&Hi._musicChannel.resume()))}),Hk(1,Hi,"soundMuted",function(){return Hi._soundMuted},function(Ha){Hi._soundMuted=Ha}),Hi.addChannel=function(Ha){0<=Hi._channels.indexOf(Ha)||(Hi._channels.push(Ha),Hi.autoReleaseSound&&0!=Hi._notUsedCount&&Hi._notUsedUrls[Ha.url]&&(delete Hi._notUsedUrls[Ha.url],0==--Hi._notUsedCount&&Hx.timer.clear(Hi,Hi.disposeSoundIfNotUsed)))},Hi.removeChannel=function(Ha){var Hb=Hi._channels,Hc=Hb.indexOf(Ha);if(-1!=Hc&&(Hb.splice(Hc,1),Hi.autoReleaseSound)){var Hd=Ha.url,He=Hi.defaultIntervals[Hd]||2e4;if(0<He){var Hf=!0;for(Hc=Hb.length-1;0<=Hc;Hc--)if(Hb[Hc].url==Hd){Hf=!1;break}Hf&&(Hi._notUsedUrls[Hd]=Date.now()+He,0==Hi._notUsedCount++&&Hx.timer.loop(1e4,Hi,Hi.disposeSoundIfNotUsed))}}},Hi.disposeSoundIfNotUsed=function(){var Ha=Hi._notUsedUrls;if(0!=Hi._notUsedCount){var Hb=Date.now();for(var Hc in Ha)Hb>=Ha[Hc]&&(delete Ha[Hc],--Hi._notUsedCount,Hi.destroySound(Hc));if(0!=Hi._notUsedCount)return}Hx.timer.clear(Hi,Hi.disposeSoundIfNotUsed)},Hi._visibilityChange=function(){Hx.stage.isVisibility?Hi._stageOnFocus():Hi._stageOnBlur()},Hi._stageOnBlur=function(){Hi._isActive=!1,Hi._musicChannel&&(Hi._musicChannel.isStopped||(Hi._blurPaused=!0,Hi._musicChannel.pause())),Hi.stopAllSound(),Hx.stage.once("mousedown",null,Hi._stageOnFocus)},Hi._recoverWebAudio=function(){Hfa.ctx&&"running"!=Hfa.ctx.state&&Hfa.ctx.resume&&Hfa.ctx.resume()},Hi._stageOnFocus=function(){if(Hi._isActive=!0,Hi._recoverWebAudio(),Hx.stage.off("mousedown",null,Hi._stageOnFocus),Hi._blurPaused){var Ha=Hi._musicChannel;Ha&&Hi._music&&Ha.isStopped&&(Hi._blurPaused=!1,Hi._music._disposed?Hi.playMusic(Ha.url,Ha.loops,Ha.startHandler,Ha.completeHandler,Ha.startTime):Ha.audioBuffer?Ha.resume():Hi._music.play(Ha.startTime,Ha.loops,Ha.startHandler,Ha))}},Hi.playSound=function(Ha,Hb,Hc,Hd,He,Hf){if(void 0===Hb&&(Hb=1),void 0===Hf&&(Hf=0),!Ha)return null;if(Hi._muted)return null;if(Hi._recoverWebAudio(),Ha==Hi._tMusic){if(Hi._musicMuted)return null}else{if(!Hi._isActive)return null;if(Hi._soundMuted)return null}var Hg,Hh=Hi._pool[Ha];return He||(He=Hi._soundClass),Hh||((Hh=new He).load(Ha),Hi._pool[Ha]=Hh),(Hg=Hh.play(Hf,Hb,Hc))?(Ha==Hi._tMusic&&(Hi._music=Hh,Hi._isActive||(Hi._blurPaused=!0,Hg.pause())),Hg.url=Ha,Hg.volume=Ha==Hi._tMusic?Hi.musicVolume:Hi.soundVolume,Hg.completeHandler=Hd,Hg):null},Hi.destroySound=function(Ha){var Hb=Hi._pool[Ha];Hb&&(delete Hi._pool[Ha],Hb.dispose())},Hi.playMusic=function(Ha,Hb,Hc,Hd,He){return void 0===Hb&&(Hb=0),void 0===He&&(He=0),Hi._tMusic=Ha,Hi._musicChannel&&Hi._musicChannel.stop(),Hi._musicChannel=Hi.playSound(Ha,Hb,Hc,Hd,null,He)},Hi.stopSound=function(Ha){for(var Hb,Hc=Hi._channels.length-1;0<=Hc;Hc--)(Hb=Hi._channels[Hc]).url==Ha&&Hb.stop()},Hi.stopAll=function(){Hi._tMusic=null;var Ha=0;for(Ha=Hi._channels.length-1;0<=Ha;Ha--)Hi._channels[Ha].stop()},Hi.stopAllSound=function(){var Ha,Hb=0;for(Hb=Hi._channels.length-1;0<=Hb;Hb--)(Ha=Hi._channels[Hb]).url!=Hi._tMusic&&Ha.stop()},Hi.stopMusic=function(){Hi._musicChannel&&Hi._musicChannel.stop(),Hi._tMusic=null},Hi.setSoundVolume=function(Ha,Hb){if(Hb)Hi._setVolume(Hb,Ha);else{Hi.soundVolume=Ha;var Hc,Hd=0;for(Hd=Hi._channels.length-1;0<=Hd;Hd--)(Hc=Hi._channels[Hd]).url!=Hi._tMusic&&(Hc.volume=Ha)}},Hi.setMusicVolume=function(Ha){Hi.musicVolume=Ha,Hi._setVolume(Hi._tMusic,Ha)},Hi._setVolume=function(Ha,Hb){for(var Hc,Hd=Hi._channels.length-1;0<=Hd;Hd--)(Hc=Hi._channels[Hd]).url==Ha&&(Hc.volume=Hb)},Hi.musicVolume=1,Hi.soundVolume=1,Hi.playbackRate=1,Hi._useAudioMusic=!0,Hi._muted=!1,Hi._soundMuted=!1,Hi._musicMuted=!1,Hi._tMusic=null,Hi._musicChannel=null,Hi._music=null,Hi._channels=[],Hi._autoStopMusic=!1,Hi._blurPaused=!1,Hi._isActive=!0,Hi._soundClass=null,Hi._musicClass=null,Hi.autoReleaseSound=!0,Hi._pool={},Hi.defaultIntervals={},Hi._notUsedUrls={},Hi._notUsedCount=0,Hi}(),HA=function(){var Ha;function Hc(){}return Hp(Hc,"laya.net.LocalStorage"),Hc.__init__=function(){Hc._baseClass||(Hc._baseClass=Ha).init(),Hc.items=Hc._baseClass.items,Hc.support=Hc._baseClass.support},Hc.setItem=function(Ha,Hb){Hc._baseClass.setItem(Ha,Hb)},Hc.getItem=function(Ha){return Hc._baseClass.getItem(Ha)},Hc.setJSON=function(Ha,Hb){Hc._baseClass.setJSON(Ha,Hb)},Hc.getJSON=function(Ha){return Hc._baseClass.getJSON(Ha)},Hc.removeItem=function(Ha){Hc._baseClass.removeItem(Ha)},Hc.clear=function(){Hc._baseClass.clear()},Hc._baseClass=null,Hc.items=null,Hc.support=!1,Hc.__init$=function(){Ha=function(){function Hc(){}return Hp(Hc,""),Hc.init=function(){try{Hc.support=!0,Hc.items=Hg.localStorage,Hc.setItem("laya","1"),Hc.removeItem("laya")}catch(Ha){Hc.support=!1}Hc.support||console.log("LocalStorage is not supprot or browser is private mode.")},Hc.setItem=function(Ha,Hb){try{Hc.support&&Hc.items.setItem(Ha,Hb)}catch(Ha){console.warn("set localStorage failed",Ha)}},Hc.getItem=function(Ha){return Hc.support?Hc.items.getItem(Ha):null},Hc.setJSON=function(Ha,Hb){try{Hc.support&&Hc.items.setItem(Ha,JSON.stringify(Hb))}catch(Ha){console.warn("set localStorage failed",Ha)}},Hc.getJSON=function(Ha){return JSON.parse(Hc.support?Hc.items.getItem(Ha):null)},Hc.removeItem=function(Ha){Hc.support&&Hc.items.removeItem(Ha)},Hc.clear=function(){Hc.support&&Hc.items.clear()},Hc.items=null,Hc.support=!1,Hc}()},Hc}(),HF=(function(){function Hd(){}Hp(Hd,"laya.net.ResourceVersion"),Hd.enable=function(Ha,Hb,Hc){void 0===Hc&&(Hc=2),laya.net.ResourceVersion.type=Hc,Hx.loader.load(Ha,Hs.create(null,Hd.onManifestLoaded,[Hb]),null,"json"),HG.customFormat=Hd.addVersionPrefix},Hd.onManifestLoaded=function(Ha,Hb){Hd.manifest=Hb,Ha.run(),Hb||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},Hd.addVersionPrefix=function(Ha){return Hd.manifest&&Hd.manifest[Ha]?2==Hd.type?Hd.manifest[Ha]:Hd.manifest[Ha]+"/"+Ha:Ha},Hd.FOLDER_VERSION=1,Hd.FILENAME_VERSION=2,Hd.manifest=null,Hd.type=1}(),function(){function Ha(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}Hp(Ha,"laya.net.TTFLoader");var Hb=Ha.prototype;return Hb.load=function(Ha){var Hb=(this._url=Ha).split(".ttf")[0].split("/");this.fontName=Hb[Hb.length-1],HM.window.conch?this._loadConch():HM.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},Hb._loadConch=function(){this._http=new Hga,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},Hb._onHttpLoaded=function(Ha){HM.window.conch.setFontFaceFromBuffer(this.fontName,Ha),this._clearHttp(),this._complete()},Hb._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},Hb._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},Hb._complete=function(){Hx.timer.clear(this,this._complete),Hx.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},Hb._checkComplete=function(){HD.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},Hb._loadWithFontFace=function(){var Ha=new HM.window.FontFace(this.fontName,"url('"+this._url+"')");HM.window.document.fonts.add(Ha);var Hb=this;Ha.loaded.then(function(){Hb._complete()}),Ha.load()},Hb._createDiv=function(){this._div=HM.createElement("div"),this._div.innerHTML="laya";var Ha=this._div.style;Ha.fontFamily=this.fontName,Ha.position="absolute",Ha.left="-100px",Ha.top="-100px",HM.document.body.appendChild(this._div)},Hb._loadWithCSS=function(){var Ha=this,Hb=HM.createElement("style");Hb.type="text/css",HM.document.body.appendChild(Hb),Hb.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=HD.measureText("LayaTTFFont",this._fontTxt).width;var Hc=this;Hb.onload=function(){Hx.timer.once(1e4,Hc,Ha._complete)},Hx.timer.loop(20,this,this._checkComplete),this._createDiv()},Ha._testString="LayaTTFFont",Ha}()),HG=function(){function Hd(Ha){this._url=null,this._path=null,this._url=Hd.formatURL(Ha),this._path=Hd.getPath(Ha)}Hp(Hd,"laya.net.URL");var Ha=Hd.prototype;return Hk(0,Ha,"path",function(){return this._path}),Hk(0,Ha,"url",function(){return this._url}),Hd.formatURL=function(Ha,Hb){if(!Ha)return"null path";if(0<Ha.indexOf(":"))return Ha;null!=Hd.customFormat&&(Ha=Hd.customFormat(Ha,Hb));var Hc=Ha.charAt(0);if("."===Hc)return Hd.formatRelativePath((Hb||Hd.basePath)+Ha);if("~"===Hc)return Hd.rootPath+Ha.substring(1);if("d"===Hc){if(0===Ha.indexOf("data:image"))return Ha}else if("/"===Hc)return Ha;return(Hb||Hd.basePath)+Ha},Hd.formatRelativePath=function(Ha){for(var Hb=Ha.split("/"),Hc=0,Hd=Hb.length;Hc<Hd;Hc++)".."==Hb[Hc]&&(Hb.splice(Hc-1,2),Hc-=2);return Hb.join("/")},Hd.isAbsolute=function(Ha){return 0<Ha.indexOf(":")||"/"==Ha.charAt(0)},Hd.getPath=function(Ha){var Hb=Ha.lastIndexOf("/");return 0<Hb?Ha.substr(0,Hb+1):""},Hd.getFileName=function(Ha){var Hb=Ha.lastIndexOf("/");return 0<Hb?Ha.substr(Hb+1):Ha},Hd.version={},Hd.basePath="",Hd.rootPath="",Hd.customFormat=function(Ha){var Hb=Hd.version[Ha];return!HH.isConchApp&&Hb&&(Ha+="?v="+Hb),Ha},Hd}(),HH=function(){function He(Ha,Hb){this._timeId=0;var Hc=He._mainCanvas.source.style;Hc.position="absolute",Hc.top=Hc.left="0px",Hc.background="#000000",He._mainCanvas.source.id="layaCanvas";var Hd=laya.renders.Render.isWebGL;He._mainCanvas.source.width=Ha,He._mainCanvas.source.height=Hb,Hd&&He.WebGL.init(He._mainCanvas,Ha,Hb),HM.container.appendChild(He._mainCanvas.source),(He._context=new HI(Ha,Hb,Hd?null:He._mainCanvas)).ctx.setIsMainContext(),HM.window.requestAnimationFrame(function Ha(Hb){HM.window.requestAnimationFrame(Ha);Hx.stage._loop()}),Hx.stage.on("visibilitychange",this,this._onVisibilitychange)}Hp(He,"laya.renders.Render");var Ha=He.prototype;return Ha._onVisibilitychange=function(){Hx.stage.isVisibility?0!=this._timeId&&HM.window.clearInterval(this._timeId):this._timeId=HM.window.setInterval(this._enterFrame,1e3)},Ha._enterFrame=function(Ha){Hx.stage._loop()},Hk(1,He,"context",function(){return He._context}),Hk(1,He,"canvas",function(){return He._mainCanvas.source}),He._context=null,He._mainCanvas=null,He.WebGL=null,He.isConchNode=!1,He.isConchApp=!1,He.isConchWebGL=!1,He.isWebGL=!1,He.is3DMode=!1,He.optimizeTextureMemory=function(Ha,Hb){return!0},He.__init$=function(){Hg.ConchRenderType=Hg.ConchRenderType||1,Hg.ConchRenderType|=Hg.conch?4:0,He.isConchNode=5==(5&Hg.ConchRenderType),He.isConchApp=4==(4&Hg.ConchRenderType),He.isConchWebGL=6==Hg.ConchRenderType},He}(),HI=function(){function Hg(Ha,Hb,Hc){this.x=0,this.y=0,this._drawTexture=function(Ha,Hb,Hc){Hc[0].loaded&&this.ctx.drawTexture(Hc[0],Hc[1],Hc[2],Hc[3],Hc[4],Ha,Hb)},this._fillTexture=function(Ha,Hb,Hc){Hc[0].loaded&&this.ctx.fillTexture(Hc[0],Hc[1]+Ha,Hc[2]+Hb,Hc[3],Hc[4],Hc[5],Hc[6],Hc[7])},this._drawTextureWithTransform=function(Ha,Hb,Hc){Hc[0].loaded&&this.ctx.drawTextureWithTransform(Hc[0],Hc[1],Hc[2],Hc[3],Hc[4],Hc[5],Ha,Hb,Hc[6])},this._fillQuadrangle=function(Ha,Hb,Hc){this.ctx.fillQuadrangle(Hc[0],Hc[1],Hc[2],Hc[3],Hc[4])},this._drawRect=function(Ha,Hb,Hc){var Hd=this.ctx;null!=Hc[4]&&(Hd.fillStyle=Hc[4],Hd.fillRect(Ha+Hc[0],Hb+Hc[1],Hc[2],Hc[3],null)),null!=Hc[5]&&(Hd.strokeStyle=Hc[5],Hd.lineWidth=Hc[6],Hd.strokeRect(Ha+Hc[0],Hb+Hc[1],Hc[2],Hc[3],Hc[6]))},this._drawPie=function(Ha,Hb,Hc){var Hd=this.ctx;HH.isWebGL&&Hd.setPathId(Hc[8]),Hd.beginPath(),HH.isWebGL?(Hd.movePath(Hc[0]+Ha,Hc[1]+Hb),Hd.moveTo(0,0)):Hd.moveTo(Ha+Hc[0],Hb+Hc[1]),Hd.arc(Ha+Hc[0],Hb+Hc[1],Hc[2],Hc[3],Hc[4]),Hd.closePath(),this._fillAndStroke(Hc[5],Hc[6],Hc[7],!0)},this._clipRect=function(Ha,Hb,Hc){this.ctx.clipRect(Ha+Hc[0],Hb+Hc[1],Hc[2],Hc[3])},this._fillRect=function(Ha,Hb,Hc){this.ctx.fillRect(Ha+Hc[0],Hb+Hc[1],Hc[2],Hc[3],Hc[4])},this._drawCircle=function(Ha,Hb,Hc){var Hd=this.ctx;HH.isWebGL&&Hd.setPathId(Hc[6]),HV.drawCall++,Hd.beginPath(),HH.isWebGL&&Hd.movePath(Hc[0]+Ha,Hc[1]+Hb),Hd.arc(Hc[0]+Ha,Hc[1]+Hb,Hc[2],0,Hg.PI2),Hd.closePath(),this._fillAndStroke(Hc[3],Hc[4],Hc[5],!0)},this._fillCircle=function(Ha,Hb,Hc){HV.drawCall++;var Hd=this.ctx;Hd.beginPath(),Hd.fillStyle=Hc[3],Hd.arc(Hc[0]+Ha,Hc[1]+Hb,Hc[2],0,Hg.PI2),Hd.fill()},this._setShader=function(Ha,Hb,Hc){this.ctx.setShader(Hc[0])},this._drawLine=function(Ha,Hb,Hc){var Hd=this.ctx;HH.isWebGL&&Hd.setPathId(Hc[6]),Hd.beginPath(),Hd.strokeStyle=Hc[4],Hd.lineWidth=Hc[5],HH.isWebGL?(Hd.movePath(Ha,Hb),Hd.moveTo(Hc[0],Hc[1]),Hd.lineTo(Hc[2],Hc[3])):(Hd.moveTo(Ha+Hc[0],Hb+Hc[1]),Hd.lineTo(Ha+Hc[2],Hb+Hc[3])),Hd.stroke()},this._drawLines=function(Ha,Hb,Hc){var Hd=this.ctx;HH.isWebGL&&Hd.setPathId(Hc[5]),Hd.beginPath(),Ha+=Hc[0],Hb+=Hc[1],HH.isWebGL&&Hd.movePath(Ha,Hb),Hd.strokeStyle=Hc[3],Hd.lineWidth=Hc[4];var He=Hc[2],Hf=2,Hg=He.length;if(HH.isWebGL)for(Hd.moveTo(He[0],He[1]);Hf<Hg;)Hd.lineTo(He[Hf++],He[Hf++]);else for(Hd.moveTo(Ha+He[0],Hb+He[1]);Hf<Hg;)Hd.lineTo(Ha+He[Hf++],Hb+He[Hf++]);Hd.stroke()},this._drawLinesWebGL=function(Ha,Hb,Hc){this.ctx.drawLines(Ha+this.x+Hc[0],Hb+this.y+Hc[1],Hc[2],Hc[3],Hc[4])},this._drawCurves=function(Ha,Hb,Hc){this.ctx.drawCurves(Ha,Hb,Hc)},this._draw=function(Ha,Hb,Hc){Hc[0].call(null,this,Ha,Hb)},this._transformByMatrix=function(Ha,Hb,Hc){this.ctx.transformByMatrix(Hc[0])},this._setTransform=function(Ha,Hb,Hc){this.ctx.setTransform(Hc[0],Hc[1],Hc[2],Hc[3],Hc[4],Hc[5])},this._setTransformByMatrix=function(Ha,Hb,Hc){this.ctx.setTransformByMatrix(Hc[0])},this._save=function(Ha,Hb,Hc){this.ctx.save()},this._restore=function(Ha,Hb,Hc){this.ctx.restore()},this._translate=function(Ha,Hb,Hc){this.ctx.translate(Hc[0],Hc[1])},this._transform=function(Ha,Hb,Hc){this.ctx.translate(Hc[1]+Ha,Hc[2]+Hb);var Hd=Hc[0];this.ctx.transform(Hd.a,Hd.b,Hd.c,Hd.d,Hd.tx,Hd.ty),this.ctx.translate(-Ha-Hc[1],-Hb-Hc[2])},this._rotate=function(Ha,Hb,Hc){this.ctx.translate(Hc[1]+Ha,Hc[2]+Hb),this.ctx.rotate(Hc[0]),this.ctx.translate(-Ha-Hc[1],-Hb-Hc[2])},this._scale=function(Ha,Hb,Hc){this.ctx.translate(Hc[2]+Ha,Hc[3]+Hb),this.ctx.scale(Hc[0],Hc[1]),this.ctx.translate(-Ha-Hc[2],-Hb-Hc[3])},this._alpha=function(Ha,Hb,Hc){this.ctx.globalAlpha*=Hc[0]},this._setAlpha=function(Ha,Hb,Hc){this.ctx.globalAlpha=Hc[0]},this._fillText=function(Ha,Hb,Hc){this.ctx.fillText(Hc[0],Hc[1]+Ha,Hc[2]+Hb,Hc[3],Hc[4],Hc[5])},this._strokeText=function(Ha,Hb,Hc){this.ctx.strokeText(Hc[0],Hc[1]+Ha,Hc[2]+Hb,Hc[3],Hc[4],Hc[5],Hc[6])},this._fillBorderText=function(Ha,Hb,Hc){this.ctx.fillBorderText(Hc[0],Hc[1]+Ha,Hc[2]+Hb,Hc[3],Hc[4],Hc[5],Hc[6],Hc[7])},this._blendMode=function(Ha,Hb,Hc){this.ctx.globalCompositeOperation=Hc[0]},this._beginClip=function(Ha,Hb,Hc){this.ctx.beginClip&&this.ctx.beginClip(Ha+Hc[0],Hb+Hc[1],Hc[2],Hc[3])},this._setIBVB=function(Ha,Hb,Hc){this.ctx.setIBVB(Hc[0]+Ha,Hc[1]+Hb,Hc[2],Hc[3],Hc[4],Hc[5],Hc[6],Hc[7])},this._fillTrangles=function(Ha,Hb,Hc){this.ctx.fillTrangles(Hc[0],Hc[1]+Ha,Hc[2]+Hb,Hc[3],Hc[4])},this._drawPath=function(Ha,Hb,Hc){var Hd=this.ctx;HH.isWebGL&&Hd.setPathId(-1),Hd.beginPath(),Ha+=Hc[0],Hb+=Hc[1],HH.isWebGL&&Hd.movePath(Ha,Hb);for(var He=Hc[2],Hf=0,Hg=He.length;Hf<Hg;Hf++){var Hh=He[Hf];switch(Hh[0]){case"moveTo":HH.isWebGL?Hd.moveTo(Hh[1],Hh[2]):Hd.moveTo(Ha+Hh[1],Hb+Hh[2]);break;case"lineTo":HH.isWebGL?Hd.lineTo(Hh[1],Hh[2]):Hd.lineTo(Ha+Hh[1],Hb+Hh[2]);break;case"arcTo":HH.isWebGL?Hd.arcTo(Hh[1],Hh[2],Hh[3],Hh[4],Hh[5]):Hd.arcTo(Ha+Hh[1],Hb+Hh[2],Ha+Hh[3],Hb+Hh[4],Hh[5]);break;case"closePath":Hd.closePath()}}var Hi=Hc[3];null!=Hi&&(Hd.fillStyle=Hi.fillStyle,Hd.fill());var Hj=Hc[4];null!=Hj&&(Hd.strokeStyle=Hj.strokeStyle,Hd.lineWidth=Hj.lineWidth||1,Hd.lineJoin=Hj.lineJoin,Hd.lineCap=Hj.lineCap,Hd.miterLimit=Hj.miterLimit,Hd.stroke())},this.drawPoly=function(Ha,Hb,Hc){this.ctx.drawPoly(Ha+this.x+Hc[0],Hb+this.y+Hc[1],Hc[2],Hc[3],Hc[4],Hc[5],Hc[6])},this._drawPoly=function(Ha,Hb,Hc){var Hd=this.ctx,He=Hc[2],Hf=2,Hg=He.length;if(HH.isWebGL)for(Hd.setPathId(Hc[6]),Hd.beginPath(),Ha+=Hc[0],Hb+=Hc[1],Hd.movePath(Ha,Hb),Hd.moveTo(He[0],He[1]);Hf<Hg;)Hd.lineTo(He[Hf++],He[Hf++]);else for(Hd.beginPath(),Ha+=Hc[0],Hb+=Hc[1],Hd.moveTo(Ha+He[0],Hb+He[1]);Hf<Hg;)Hd.lineTo(Ha+He[Hf++],Hb+He[Hf++]);Hd.closePath(),this._fillAndStroke(Hc[3],Hc[4],Hc[5],Hc[7])},this._drawSkin=function(Ha,Hb,Hc){var Hd=Hc[0];if(Hd){var He=this.ctx;Hd.render(He,Ha,Hb)}},this._drawParticle=function(Ha,Hb,Hc){this.ctx.drawParticle(Ha+this.x,Hb+this.y,Hc[0])},this._setFilters=function(Ha,Hb,Hc){this.ctx.setFilters(Hc)},Hc?this.ctx=Hc.getContext("2d"):(Hc=Hta.create("3D"),this.ctx=HD.createWebGLContext2D(Hc),Hc._setContext(this.ctx)),Hc.size(Ha,Hb),this.canvas=Hc}Hp(Hg,"laya.renders.RenderContext");var Ha=Hg.prototype;return Ha.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},Ha.drawTexture=function(Ha,Hb,Hc,Hd,He){Ha.loaded&&this.ctx.drawTexture(Ha,Hb,Hc,Hd,He,this.x,this.y)},Ha._drawTextures=function(Ha,Hb,Hc){Hc[0].loaded&&this.ctx.drawTextures(Hc[0],Hc[1],Ha+this.x,Hb+this.y)},Ha.drawTextureWithTransform=function(Ha,Hb,Hc,Hd,He,Hf,Hg){Ha.loaded&&this.ctx.drawTextureWithTransform(Ha,Hb,Hc,Hd,He,Hf,this.x,this.y,Hg)},Ha.fillQuadrangle=function(Ha,Hb,Hc,Hd,He){this.ctx.fillQuadrangle(Ha,Hb,Hc,Hd,He)},Ha.drawCanvas=function(Ha,Hb,Hc,Hd,He){this.ctx.drawCanvas(Ha,Hb+this.x,Hc+this.y,Hd,He)},Ha.drawRect=function(Ha,Hb,Hc,Hd,He,Hf){void 0===Hf&&(Hf=1);var Hg=this.ctx;Hg.strokeStyle=He,Hg.lineWidth=Hf,Hg.strokeRect(Ha+this.x,Hb+this.y,Hc,Hd,Hf)},Ha._fillAndStroke=function(Ha,Hb,Hc,Hd){void 0===Hd&&(Hd=!1);var He=this.ctx;null!=Ha&&(He.fillStyle=Ha,HH.isWebGL?He.fill(Hd):He.fill()),null!=Hb&&0<Hc&&(He.strokeStyle=Hb,He.lineWidth=Hc,He.stroke())},Ha.clipRect=function(Ha,Hb,Hc,Hd){this.ctx.clipRect(Ha+this.x,Hb+this.y,Hc,Hd)},Ha.fillRect=function(Ha,Hb,Hc,Hd,He){this.ctx.fillRect(Ha+this.x,Hb+this.y,Hc,Hd,He)},Ha.drawCircle=function(Ha,Hb,Hc,Hd,He){void 0===He&&(He=1),HV.drawCall++;var Hf=this.ctx;Hf.beginPath(),Hf.strokeStyle=Hd,Hf.lineWidth=He,Hf.arc(Ha+this.x,Hb+this.y,Hc,0,Hg.PI2),Hf.stroke()},Ha.drawTriangles=function(Ha,Hb,Hc){if(HH.isWebGL)this.ctx.drawTriangles(Hc[0],Ha+Hc[1],Hb+Hc[2],Hc[3],Hc[4],Hc[5],Hc[6],Hc[7],Hc[8],Hc[9]);else{var Hd=Hc[5],He=0,Hf=Hd.length,Hg=this.ctx;for(He=0;He<Hf;He+=3){var Hh=2*Hd[He],Hi=2*Hd[He+1],Hj=2*Hd[He+2];Hg.drawTriangle(Hc[0],Hc[3],Hc[4],Hh,Hi,Hj,Hc[6],!0)}}},Ha.fillCircle=function(Ha,Hb,Hc,Hd){HV.drawCall++;var He=this.ctx;He.beginPath(),He.fillStyle=Hd,He.arc(Ha+this.x,Hb+this.y,Hc,0,Hg.PI2),He.fill()},Ha.setShader=function(Ha){this.ctx.setShader(Ha)},Ha.drawLine=function(Ha,Hb,Hc,Hd,He,Hf){void 0===Hf&&(Hf=1);var Hg=this.ctx;Hg.beginPath(),Hg.strokeStyle=He,Hg.lineWidth=Hf,Hg.moveTo(this.x+Ha,this.y+Hb),Hg.lineTo(this.x+Hc,this.y+Hd),Hg.stroke()},Ha.clear=function(){this.ctx.clear()},Ha.transformByMatrix=function(Ha){this.ctx.transformByMatrix(Ha)},Ha.setTransform=function(Ha,Hb,Hc,Hd,He,Hf){this.ctx.setTransform(Ha,Hb,Hc,Hd,He,Hf)},Ha.setTransformByMatrix=function(Ha){this.ctx.setTransformByMatrix(Ha)},Ha.save=function(){this.ctx.save()},Ha.restore=function(){this.ctx.restore()},Ha.translate=function(Ha,Hb){this.ctx.translate(Ha,Hb)},Ha.transform=function(Ha,Hb,Hc,Hd,He,Hf){this.ctx.transform(Ha,Hb,Hc,Hd,He,Hf)},Ha.rotate=function(Ha){this.ctx.rotate(Ha)},Ha.scale=function(Ha,Hb){this.ctx.scale(Ha,Hb)},Ha.alpha=function(Ha){this.ctx.globalAlpha*=Ha},Ha.setAlpha=function(Ha){this.ctx.globalAlpha=Ha},Ha.fillWords=function(Ha,Hb,Hc,Hd,He,Hf){void 0===Hf&&(Hf=0),this.ctx.fillWords(Ha,Hb,Hc,Hd,He,Hf)},Ha.fillBorderWords=function(Ha,Hb,Hc,Hd,He,Hf,Hg){this.ctx.fillBorderWords(Ha,Hb,Hc,Hd,He,Hf,Hg)},Ha.fillText=function(Ha,Hb,Hc,Hd,He,Hf){this.ctx.fillText(Ha,Hb+this.x,Hc+this.y,Hd,He,Hf)},Ha.strokeText=function(Ha,Hb,Hc,Hd,He,Hf,Hg){this.ctx.strokeText(Ha,Hb+this.x,Hc+this.y,Hd,He,Hf,Hg)},Ha.blendMode=function(Ha){this.ctx.globalCompositeOperation=Ha},Ha.flush=function(){this.ctx.flush&&this.ctx.flush()},Ha.addRenderObject=function(Ha){this.ctx.addRenderObject(Ha)},Ha.beginClip=function(Ha,Hb,Hc,Hd){this.ctx.beginClip&&this.ctx.beginClip(Ha,Hb,Hc,Hd)},Ha.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},Ha.fillTrangles=function(Ha,Hb,Hc){this.ctx.fillTrangles(Hc[0],Hc[1],Hc[2],Hc[3],4<Hc.length?Hc[4]:null)},Hg.PI2=2*Math.PI,Hg}(),HJ=function(){function Hg(Ha,Hb){switch(this._next=Hb||Hg.NORENDER,Ha){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=Hr._filter);case 69905:return void(this._fun=Hg._initRenderFun)}this.onCreate(Ha)}Hp(Hg,"laya.renders.RenderSprite");var Ha=Hg.prototype;return Ha.onCreate=function(Ha){},Ha._style=function(Ha,Hb,Hc,Hd){Ha._style.render(Ha,Hb,Hc,Hd);var He=this._next;He._fun.call(He,Ha,Hb,Hc,Hd)},Ha._no=function(Ha,Hb,Hc,Hd){},Ha._custom=function(Ha,Hb,Hc,Hd){Ha.customRender(Hb,Hc,Hd);var He=Ha._style._tf;this._next._fun.call(this._next,Ha,Hb,Hc-He.translateX,Hd-He.translateY)},Ha._clip=function(Ha,Hb,Hc,Hd){var He=this._next;if(He!=Hg.NORENDER){var Hf=Ha._style.scrollRect;Hb.ctx.save(),Hb.ctx.clipRect(Hc,Hd,Hf.width,Hf.height),He._fun.call(He,Ha,Hb,Hc-Hf.x,Hd-Hf.y),Hb.ctx.restore()}},Ha._blend=function(Ha,Hb,Hc,Hd){var He=Ha._style;He.blendMode&&(Hb.ctx.globalCompositeOperation=He.blendMode);var Hf=this._next;Hf._fun.call(Hf,Ha,Hb,Hc,Hd),Hb.ctx.globalCompositeOperation="source-over"},Ha._mask=function(Ha,Hb,Hc,Hd){var He=this._next;He._fun.call(He,Ha,Hb,Hc,Hd);var Hf=Ha.mask;Hf&&(Hb.ctx.globalCompositeOperation="destination-in",(0<Hf.numChildren||!Hf.graphics._isOnlyOne())&&(Hf.cacheAsBitmap=!0),Hf.render(Hb,Hc-Ha.pivotX,Hd-Ha.pivotY)),Hb.ctx.globalCompositeOperation="source-over"},Ha._graphics=function(Ha,Hb,Hc,Hd){var He=Ha._style._tf;Ha._graphics&&Ha._graphics._render(Ha,Hb,Hc-He.translateX,Hd-He.translateY);var Hf=this._next;Hf._fun.call(Hf,Ha,Hb,Hc,Hd)},Ha._image=function(Ha,Hb,Hc,Hd){var He=Ha._style;Hb.ctx.drawTexture2(Hc,Hd,He._tf.translateX,He._tf.translateY,Ha.transform,He.alpha,He.blendMode,Ha._graphics._one)},Ha._image2=function(Ha,Hb,Hc,Hd){var He=Ha._style._tf;Hb.ctx.drawTexture2(Hc,Hd,He.translateX,He.translateY,Ha.transform,1,null,Ha._graphics._one)},Ha._alpha=function(Ha,Hb,Hc,Hd){var He;if(.01<(He=Ha._style.alpha)||Ha._needRepaint()){var Hf=Hb.ctx.globalAlpha;Hb.ctx.globalAlpha*=He;var Hg=this._next;Hg._fun.call(Hg,Ha,Hb,Hc,Hd),Hb.ctx.globalAlpha=Hf}},Ha._transform=function(Ha,Hb,Hc,Hd){var He=Ha.transform,Hf=this._next;He&&Hf!=Hg.NORENDER?(Hb.save(),Hb.transform(He.a,He.b,He.c,He.d,He.tx+Hc,He.ty+Hd),Hf._fun.call(Hf,Ha,Hb,0,0),Hb.restore()):Hf._fun.call(Hf,Ha,Hb,Hc,Hd)},Ha._childs=function(Ha,Hb,Hc,Hd){var He=Ha._style,Hf=He._tf;if(Hc=Hc-Hf.translateX+He.paddingLeft,Hd=Hd-Hf.translateY+He.paddingTop,He._calculation){var Hg=Ha._getWords();if(Hg){var Hh=He;Hh&&(Hh.stroke?Hb.fillBorderWords(Hg,Hc,Hd,Hh.font,Hh.color,Hh.strokeColor,Hh.stroke):Hb.fillWords(Hg,Hc,Hd,Hh.font,Hh.color,"none"!=Hh.textDecoration&&Hh.underLine?1:0))}}var Hi,Hj=Ha._childs,Hk=Hj.length;if(Ha.viewport||Ha.optimizeScrollRect&&Ha._style.scrollRect){var Hl=Ha.viewport||Ha._style.scrollRect,Hm=Hl.x,Hn=Hl.y,Ho=Hl.right,Hp=Hl.bottom,Hq=NaN,Hr=NaN;for(Hs=0;Hs<Hk;++Hs)(Hi=Hj[Hs]).visible&&(Hq=Hi._x)<Ho&&Hq+Hi.width>Hm&&(Hr=Hi._y)<Hp&&Hr+Hi.height>Hn&&Hi.render(Hb,Hc,Hd)}else for(var Hs=0;Hs<Hk;++Hs)(Hi=Hj[Hs])._style.visible&&Hi.render(Hb,Hc,Hd)},Ha._canvas=function(Ha,Hb,Hc,Hd){var He=Ha._$P.cacheCanvas;if(He){"bitmap"===He.type?HV.canvasBitmap++:HV.canvasNormal++;var Hf=He.ctx;if(Ha._needRepaint()||!Hf)this._canvas_repaint(Ha,Hb,Hc,Hd);else{var Hg=He._cacheRec;Hb.drawCanvas(Hf.canvas,Hc+Hg.x,Hd+Hg.y,Hg.width,Hg.height)}}else this._next._fun.call(this._next,Ha,Hb,Hc,Hd)},Ha._canvas_repaint=function(Ha,Hb,Hc,Hd){var He=Ha._$P.cacheCanvas,Hf=this._next;if(He){var Hg,Hh,Hi,Hj,Hk=He.ctx,Hl=Ha._needRepaint()||!Hk,Hm=He.type;if("bitmap"===Hm?HV.canvasBitmap++:HV.canvasNormal++,Hl){var Hn,Ho;He._cacheRec||(He._cacheRec=new Hz),HH.isWebGL&&"bitmap"!==Hm?He._cacheRec.setTo(-Ha.pivotX,-Ha.pivotY,1,1):((Hj=Ha.getSelfBounds()).x=Hj.x-Ha.pivotX,Hj.y=Hj.y-Ha.pivotY,Hj.x=Hj.x-16,Hj.y=Hj.y-16,Hj.width=Hj.width+32,Hj.height=Hj.height+32,Hj.x=Math.floor(Hj.x+Hc)-Hc,Hj.y=Math.floor(Hj.y+Hd)-Hd,Hj.width=Math.floor(Hj.width),Hj.height=Math.floor(Hj.height),He._cacheRec.copyFrom(Hj)),Hj=He._cacheRec;var Hp,Hq=HH.isWebGL?1:HM.pixelRatio*Hx.stage.clientScaleX,Hr=HH.isWebGL?1:HM.pixelRatio*Hx.stage.clientScaleY;if(!HH.isWebGL){var Hs,Ht=1,Hu=1;for(Hs=Ha;Hs&&Hs!=Hx.stage;)Ht*=Hs.scaleX,Hu*=Hs.scaleY,Hs=Hs.parent;HH.isWebGL?(Ht<1&&(Hq*=Ht),Hu<1&&(Hr*=Hu)):(1<Ht&&(Hq*=Ht),1<Hu&&(Hr*=Hu))}if(Ha.scrollRect){var Hv=Ha.scrollRect;Hj.x-=Hv.x,Hj.y-=Hv.y}if(Hn=Hj.width*Hq,Ho=Hj.height*Hr,Hh=Hj.x,Hi=Hj.y,HH.isWebGL&&"bitmap"===Hm&&(2048<Hn||2048<Ho))return console.warn("cache bitmap size larger than 2048,cache ignored"),He.ctx&&(HU.recover("RenderContext",He.ctx),He.ctx.canvas.size(0,0),He.ctx=null),void Hf._fun.call(Hf,Ha,Hb,Hc,Hd);if(Hk||(Hk=He.ctx=HU.getItem("RenderContext")||new HI(Hn,Ho,Hta.create("AUTO"))),Hk.ctx.sprite=Ha,(Hg=Hk.canvas).clear(),(Hg.width!=Hn||Hg.height!=Ho)&&Hg.size(Hn,Ho),"bitmap"===Hm?Hg.context.asBitmap=!0:"normal"===Hm&&(Hg.context.asBitmap=!1),1!=Hq||1!=Hr){var Hw=Hk.ctx;Hw.save(),Hw.scale(Hq,Hr),!HH.isConchWebGL&&HH.isConchApp&&(Hp=Ha._$P.cf)&&Hw.setFilterMatrix&&Hw.setFilterMatrix(Hp._mat,Hp._alpha),Hf._fun.call(Hf,Ha,Hk,-Hh,-Hi),Hw.restore(),HH.isConchApp&&!HH.isConchWebGL||Ha._applyFilters()}else Hw=Hk.ctx,!HH.isConchWebGL&&HH.isConchApp&&(Hp=Ha._$P.cf)&&Hw.setFilterMatrix&&Hw.setFilterMatrix(Hp._mat,Hp._alpha),Hf._fun.call(Hf,Ha,Hk,-Hh,-Hi),HH.isConchApp&&!HH.isConchWebGL||Ha._applyFilters();Ha._$P.staticCache&&(He.reCache=!1),HV.canvasReCache++}else Hh=(Hj=He._cacheRec).x,Hi=Hj.y,Hg=Hk.canvas;Hb.drawCanvas(Hg,Hc+Hh,Hd+Hi,Hj.width,Hj.height)}else Hf._fun.call(Hf,Ha,Hk,Hc,Hd)},Hg.__init__=function(){var Ha,Hb,Hc=0;for(Hb=HD.createRenderSprite(69905,null),Ha=Hg.renders.length=4096,Hc=0;Hc<Ha;Hc++)Hg.renders[Hc]=Hb;Hg.renders[0]=HD.createRenderSprite(0,null),function(Ha,Hb){for(var Hc=0,Hd=0;Hd<Ha.length;Hd++)Hc|=Ha[Hd],Hg.renders[Hc]=Hb}([1,512,4,2],new Hg(1,null)),Hg.renders[513]=HD.createRenderSprite(513,null),Hg.renders[517]=new Hg(517,null)},Hg._initRenderFun=function(Ha,Hb,Hc,Hd){var He=Ha._renderType;(Hg.renders[He]=Hg._getTypeRender(He))._fun(Ha,Hb,Hc,Hd)},Hg._getTypeRender=function(Ha){for(var Hb=null,Hc=2048;1<Hc;)Hc&Ha&&(Hb=HD.createRenderSprite(Hc,Hb)),Hc>>=1;return Hb},Hg.IMAGE=1,Hg.ALPHA=2,Hg.TRANSFORM=4,Hg.BLEND=8,Hg.CANVAS=16,Hg.FILTERS=32,Hg.MASK=64,Hg.CLIP=128,Hg.STYLE=256,Hg.GRAPHICS=512,Hg.CUSTOM=1024,Hg.CHILDS=2048,Hg.INIT=69905,Hg.renders=[],Hg.NORENDER=new Hg(0,null),Hg}(),HK=function(){function Hh(){this._repaint=!1}Hp(Hh,"laya.resource.Context");var Ha=Hh.prototype;return Ha.replaceReset=function(){var Ha,Hb,Hc=0;for(Ha=Hh.replaceKeys.length,Hc=0;Hc<Ha;Hc++)Hb=Hh.replaceKeys[Hc],this[Hh.newKeys[Hc]]=this[Hb]},Ha.replaceResotre=function(){this.__restore(),this.__reset()},Ha.setIsMainContext=function(){},Ha.drawTextures=function(Ha,Hb,Hc,Hd){HV.drawCall+=Hb.length/2;for(var He=Ha.width,Hf=Ha.height,Hg=0,Hh=Hb.length;Hg<Hh;Hg+=2)this.drawTexture(Ha,Hb[Hg],Hb[Hg+1],He,Hf,Hc,Hd)},Ha.drawCanvas=function(Ha,Hb,Hc,Hd,He){HV.drawCall++,this.drawImage(Ha.source,Hb,Hc,Hd,He)},Ha.fillRect=function(Ha,Hb,Hc,Hd,He){HV.drawCall++,He&&(this.fillStyle=He),this.__fillRect(Ha,Hb,Hc,Hd)},Ha.fillText=function(Ha,Hb,Hc,Hd,He,Hf){HV.drawCall++,3<arguments.length&&null!=Hd&&(this.font=Hd,this.fillStyle=He,this.textAlign=Hf,this.textBaseline="top"),this.__fillText(Ha,Hb,Hc)},Ha.fillBorderText=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){HV.drawCall++,this.font=Hd,this.fillStyle=He,this.textBaseline="top",this.strokeStyle=Hf,this.lineWidth=Hg,this.textAlign=Hh,this.__strokeText(Ha,Hb,Hc),this.__fillText(Ha,Hb,Hc)},Ha.strokeText=function(Ha,Hb,Hc,Hd,He,Hf,Hg){HV.drawCall++,3<arguments.length&&null!=Hd&&(this.font=Hd,this.strokeStyle=He,this.lineWidth=Hf,this.textAlign=Hg,this.textBaseline="top"),this.__strokeText(Ha,Hb,Hc)},Ha.transformByMatrix=function(Ha){this.transform(Ha.a,Ha.b,Ha.c,Ha.d,Ha.tx,Ha.ty)},Ha.setTransformByMatrix=function(Ha){this.setTransform(Ha.a,Ha.b,Ha.c,Ha.d,Ha.tx,Ha.ty)},Ha.clipRect=function(Ha,Hb,Hc,Hd){HV.drawCall++,this.beginPath(),this.rect(Ha,Hb,Hc,Hd),this.clip()},Ha.drawTexture=function(Ha,Hb,Hc,Hd,He,Hf,Hg){HV.drawCall++;var Hh=Ha.uv,Hi=Ha.bitmap.width,Hj=Ha.bitmap.height;this.drawImage(Ha.source,Hh[0]*Hi,Hh[1]*Hj,(Hh[2]-Hh[0])*Hi,(Hh[5]-Hh[3])*Hj,Hb+Hf,Hc+Hg,Hd,He)},Ha.drawTextureWithTransform=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){HV.drawCall++;var Hj=Ha.uv,Hk=Ha.bitmap.width,Hl=Ha.bitmap.height;this.save(),1!=Hi&&(this.globalAlpha*=Hi),Hf?(this.transform(Hf.a,Hf.b,Hf.c,Hf.d,Hf.tx+Hg,Hf.ty+Hh),this.drawImage(Ha.source,Hj[0]*Hk,Hj[1]*Hl,(Hj[2]-Hj[0])*Hk,(Hj[5]-Hj[3])*Hl,Hb,Hc,Hd,He)):this.drawImage(Ha.source,Hj[0]*Hk,Hj[1]*Hl,(Hj[2]-Hj[0])*Hk,(Hj[5]-Hj[3])*Hl,Hb+Hg,Hc+Hh,Hd,He),this.restore()},Ha.drawTexture2=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){var Hi=Hh[0];if(Hi.loaded&&Hi.bitmap&&Hi.source){HV.drawCall++;var Hj=1!==Hf;if(Hj){var Hk=this.globalAlpha;this.globalAlpha*=Hf}var Hl=Hi.uv,Hm=Hi.bitmap.width,Hn=Hi.bitmap.height;He?(this.save(),this.transform(He.a,He.b,He.c,He.d,He.tx+Ha,He.ty+Hb),this.drawImage(Hi.source,Hl[0]*Hm,Hl[1]*Hn,(Hl[2]-Hl[0])*Hm,(Hl[5]-Hl[3])*Hn,Hh[1]-Hc,Hh[2]-Hd,Hh[3],Hh[4]),this.restore()):this.drawImage(Hi.source,Hl[0]*Hm,Hl[1]*Hn,(Hl[2]-Hl[0])*Hm,(Hl[5]-Hl[3])*Hn,Hh[1]-Hc+Ha,Hh[2]-Hd+Hb,Hh[3],Hh[4]),Hj&&(this.globalAlpha=Hk)}},Ha.fillTexture=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){if(!Hh.pat){if(Ha.uv!=Hka.DEF_UV){var Hi=new Hta("2D");Hi.getContext("2d"),Hi.size(Ha.width,Ha.height),Hi.context.drawTexture(Ha,0,0,Ha.width,Ha.height,0,0),Ha=new Hka(Hi)}Hh.pat=this.createPattern(Ha.bitmap.source,Hf)}var Hj=Hb,Hk=Hc,Hl=0,Hm=0;Hg&&(Hj+=Hg.x%Ha.width,Hk+=Hg.y%Ha.height,Hl-=Hg.x%Ha.width,Hm-=Hg.y%Ha.height),this.translate(Hj,Hk),this.fillRect(Hl,Hm,Hd,He,Hh.pat),this.translate(-Hj,-Hk)},Ha.drawTriangle=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){var Hi=Ha.bitmap,Hj=Hi.source,Hk=Ha.width,Hl=Ha.height,Hm=Hi.width,Hn=Hi.height,Ho=Hc[Hd]*Hm,Hp=Hc[He]*Hm,Hq=Hc[Hf]*Hm,Hr=Hc[Hd+1]*Hn,Hs=Hc[He+1]*Hn,Ht=Hc[Hf+1]*Hn,Hu=Hb[Hd],Hv=Hb[He],Hw=Hb[Hf],Hx=Hb[Hd+1],Hy=Hb[He+1],Hz=Hb[Hf+1];if(Hh){var HA=(Hu+Hv+Hw)/3,HB=(Hx+Hy+Hz)/3,HC=Hu-HA,HD=Hx-HB,HE=Math.sqrt(HC*HC+HD*HD);Hu=HA+HC/HE*(HE+1),Hx=HB+HD/HE*(HE+1),HD=Hy-HB,Hv=HA+(HC=Hv-HA)/(HE=Math.sqrt(HC*HC+HD*HD))*(HE+1),Hy=HB+HD/HE*(HE+1),HD=Hz-HB,Hw=HA+(HC=Hw-HA)/(HE=Math.sqrt(HC*HC+HD*HD))*(HE+1),Hz=HB+HD/HE*(HE+1)}this.save(),Hg&&this.transform(Hg.a,Hg.b,Hg.c,Hg.d,Hg.tx,Hg.ty),this.beginPath(),this.moveTo(Hu,Hx),this.lineTo(Hv,Hy),this.lineTo(Hw,Hz),this.closePath(),this.clip();var HF=1/(Ho*Hs+Hr*Hq+Hp*Ht-Hs*Hq-Hr*Hp-Ho*Ht),HG=Hu*Hs+Hr*Hw+Hv*Ht-Hs*Hw-Hr*Hv-Hu*Ht,HH=Ho*Hv+Hu*Hq+Hp*Hw-Hv*Hq-Hu*Hp-Ho*Hw,HI=Ho*Hs*Hw+Hr*Hv*Hq+Hu*Hp*Ht-Hu*Hs*Hq-Hr*Hp*Hw-Ho*Hv*Ht,HJ=Hx*Hs+Hr*Hz+Hy*Ht-Hs*Hz-Hr*Hy-Hx*Ht,HK=Ho*Hy+Hx*Hq+Hp*Hz-Hy*Hq-Hx*Hp-Ho*Hz,HL=Ho*Hs*Hz+Hr*Hy*Hq+Hx*Hp*Ht-Hx*Hs*Hq-Hr*Hp*Hz-Ho*Hy*Ht;this.transform(HG*HF,HJ*HF,HH*HF,HK*HF,HI*HF,HL*HF),this.drawImage(Hj,Ha.uv[0]*Hm,Ha.uv[1]*Hn,Hk,Hl,Ha.uv[0]*Hm,Ha.uv[1]*Hn,Hk,Hl),this.restore()},Ha.flush=function(){return 0},Ha.fillWords=function(Ha,Hb,Hc,Hd,He,Hf){Hd&&(this.font=Hd),He&&(this.fillStyle=He);this.textBaseline="top",this.textAlign="left";for(var Hg=0,Hh=Ha.length;Hg<Hh;Hg++){var Hi=Ha[Hg];if(this.__fillText(Hi.char,Hi.x+Hb,Hi.y+Hc),1===Hf){var Hj=Hi.height,Hk=.5*Hi.style.letterSpacing;Hk||(Hk=0),this.beginPath(),this.strokeStyle=He,this.lineWidth=1,this.moveTo(Hb+Hi.x-Hk+.5,Hc+Hi.y+Hj+.5),this.lineTo(Hb+Hi.x+Hi.width+Hk+.5,Hc+Hi.y+Hj+.5),this.stroke()}}},Ha.fillBorderWords=function(Ha,Hb,Hc,Hd,He,Hf,Hg){Hd&&(this.font=Hd),He&&(this.fillStyle=He),this.textBaseline="top",this.lineWidth=Hg,this.textAlign="left",this.strokeStyle=Hf;for(var Hh=0,Hi=Ha.length;Hh<Hi;Hh++){var Hj=Ha[Hh];this.__strokeText(Hj.char,Hj.x+Hb,Hj.y+Hc),this.__fillText(Hj.char,Hj.x+Hb,Hj.y+Hc)}},Ha.destroy=function(){this.canvas.width=this.canvas.height=0},Ha.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},Ha.drawCurves=function(Ha,Hb,Hc){this.beginPath(),this.strokeStyle=Hc[3],this.lineWidth=Hc[4];var Hd=Hc[2];Ha+=Hc[0],Hb+=Hc[1],this.moveTo(Ha+Hd[0],Hb+Hd[1]);for(var He=2,Hf=Hd.length;He<Hf;)this.quadraticCurveTo(Ha+Hd[He++],Hb+Hd[He++],Ha+Hd[He++],Hb+Hd[He++]);this.stroke()},Hh.__init__=function(Hb){var Hc=laya.resource.Context.prototype;if(!(Hb=Hb||CanvasRenderingContext2D.prototype).inited){Hb.inited=!0,Hb.__fillText=Hb.fillText,Hb.__fillRect=Hb.fillRect,Hb.__strokeText=Hb.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(Ha){Hb[Ha]=Hc[Ha]})}},Hh.replaceCanvasGetSet=function(Ha,Hb){var Hc=Object.getOwnPropertyDescriptor(Ha,Hb);if(!Hc||!Hc.configurable)return!1;var Hd,He={};for(Hd in Hc)"set"!=Hd&&(He[Hd]=Hc[Hd]);var Hf=Hc.set;return He.set=function(Ha){Hf.call(this,Ha);var Hb=this.getContext("2d");Hb&&"__reset"in Hb&&Hb.__reset()},Object.defineProperty(Ha,Hb,He),!0},Hh.replaceGetSet=function(Ha,Hb){var Hc=Object.getOwnPropertyDescriptor(Ha,Hb);if(!Hc||!Hc.configurable)return!1;var Hd,He={};for(Hd in Hc)"set"!=Hd&&(He[Hd]=Hc[Hd]);var Hf=Hc.set,Hg="___"+Hb+"__";return Hh.newKeys.push(Hg),He.set=function(Ha){Ha!=this[Hg]&&(this[Hg]=Ha,Hf.call(this,Ha))},Object.defineProperty(Ha,Hb,He),!0},Hh._default=new Hh,Hh.newKeys=[],Hi(Hh,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),Hh}(),HL=function(){function Hf(Ha){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++Hf._uniqueIDCounter,this._name=Ha||"Content Manager",Hf._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,Hf._resourceManagers.push(this),this._resources=[],this._records={}}Hp(Hf,"laya.resource.ResourceManager");var Ha=Hf.prototype;return Hx.imps(Ha,{"laya.resource.IDispose":!0}),Ha.getResourceByIndex=function(Ha){return this._resources[Ha]},Ha.getResourcesLength=function(){return this._resources.length},Ha.addResource=function(Ha){return Ha.resourceManager&&Ha.resourceManager.removeResource(Ha),-1===this._resources.indexOf(Ha)&&((Ha._resourceManager=this)._resources.push(Ha),this.addRecord(Ha.uri,Ha.__className,Ha.memorySize),this.addSize(Ha.memorySize),!0)},Ha.removeResource=function(Ha){var Hb=this._resources.indexOf(Ha);return-1!==Hb&&(this._resources.splice(Hb,1),Ha._resourceManager=null,this._memorySize-=Ha.memorySize,this.addRecord(Ha.uri,Ha.__className,-Ha.memorySize),!0)},Ha.unload=function(){for(var Ha=this._resources.slice(0,this._resources.length),Hb=0;Hb<Ha.length;Hb++){Ha[Hb].destroy()}Ha.length=0},Ha.dispose=function(){if(this===Hf._systemResourceManager)throw new Error("systemResourceManager不能被释放！");Hf._resourceManagers.splice(Hf._resourceManagers.indexOf(this),1),Hf._isResourceManagersSorted=!1;for(var Ha=this._resources.slice(0,this._resources.length),Hb=0;Hb<Ha.length;Hb++){var Hc=Ha[Hb];Hc.resourceManager.removeResource(Hc),Hc.destroy()}Ha.length=0},Ha.addSize=function(Ha){Ha&&(this.autoRelease&&0<Ha&&this._memorySize+Ha>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=Ha)},Ha.addRecord=function(Ha,Hb,Hc){DEBUG&&Hc&&!Ha&&console.error(Ha,Hb,Hc),Ha&&(this._records.hasOwnProperty(Hb+"|"+Ha)||(this._records[Hb+"|"+Ha]=0),this._records[Hb+"|"+Ha]+=Hc,DEBUG&&this._records[Hb+"|"+Ha]<0&&console.error(Ha,Hb,this._records[Hb+"|"+Ha]))},Ha.garbageCollection=function(Ha){var Hb=this._resources;(Hb=Hb.slice()).sort(function(Ha,Hb){if(!Ha||!Hb)throw new Error("a或b不能为空！");return Ha.released&&Hb.released?0:Ha.released?1:Hb.released?-1:Ha._lastUseFrameCount-Hb._lastUseFrameCount});for(var Hc=HV.loopCount,Hd=0,He=Hb.length;Hd<He;Hd++){var Hf=Hb[Hd];if(!(1<Hc-Hf._lastUseFrameCount))return void(this._memorySize>=Ha&&(this._isOverflow=!0));if(Hf.releaseResource(),this._memorySize<Ha)return void(this._isOverflow=!1)}},Hk(0,Ha,"id",function(){return this._id}),Hk(0,Ha,"name",function(){return this._name},function(Ha){!Ha&&""===Ha||this._name===Ha||(this._name=Ha,Hf._isResourceManagersSorted=!1)}),Hk(0,Ha,"memorySize",function(){return this._memorySize}),Hk(0,Ha,"records",function(){return this._records}),Hk(1,Hf,"systemResourceManager",function(){return Hf._systemResourceManager}),Hf.__init__=function(){Hf.currentResourceManager=Hf.systemResourceManager},Hf.getLoadedResourceManagerByIndex=function(Ha){return Hf._resourceManagers[Ha]},Hf.getLoadedResourceManagersCount=function(){return Hf._resourceManagers.length},Hf.recreateContentManagers=function(Ha){void 0===Ha&&(Ha=!1);for(var Hb=Hf.currentResourceManager,Hc=0;Hc<Hf._resourceManagers.length;Hc++){Hf.currentResourceManager=Hf._resourceManagers[Hc];for(var Hd=0;Hd<Hf.currentResourceManager._resources.length;Hd++)Hf.currentResourceManager._resources[Hd].releaseResource(Ha),Hf.currentResourceManager._resources[Hd].activeResource(Ha)}Hf.currentResourceManager=Hb},Hf.releaseContentManagers=function(Ha){void 0===Ha&&(Ha=!1);for(var Hb=Hf.currentResourceManager,Hc=0;Hc<Hf._resourceManagers.length;Hc++){Hf.currentResourceManager=Hf._resourceManagers[Hc];for(var Hd=0;Hd<Hf.currentResourceManager._resources.length;Hd++){var He=Hf.currentResourceManager._resources[Hd];!He.released&&He.releaseResource(Ha)}}Hf.currentResourceManager=Hb},Hf._uniqueIDCounter=0,Hf._isResourceManagersSorted=!1,Hf._resourceManagers=[],Hi(Hf,["_systemResourceManager",function(){return this._systemResourceManager=new Hf("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=Hf._systemResourceManager}]),Hf}(),HM=(function(){function Ha(){}Hp(Ha,"laya.system.System"),Ha.changeDefinition=function(Ha,Hb){Hx[Ha]=Hb;var Hc=Ha+"=classObj";Hx._runScript(Hc)},Ha.__init__=function(){HH.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function Hc(){}return Hp(Hc,"laya.utils.Browser"),Hk(1,Hc,"pixelRatio",function(){return Hc.__init__(),-1<Hc.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:HD.getPixelRatio()}),Hk(1,Hc,"height",function(){return Hc.__init__(),(Hx.stage&&Hx.stage.canvasRotation?Hc.clientWidth:Hc.clientHeight)*Hc.pixelRatio}),Hk(1,Hc,"clientWidth",function(){return Hc.__init__(),Hc.window.innerWidth||Hc.document.body.clientWidth}),Hk(1,Hc,"window",function(){return Hc.__init__(),Hc._window}),Hk(1,Hc,"clientHeight",function(){return Hc.__init__(),Hc.window.innerHeight||Hc.document.body.clientHeight||Hc.document.documentElement.clientHeight}),Hk(1,Hc,"width",function(){return Hc.__init__(),(Hx.stage&&Hx.stage.canvasRotation?Hc.clientHeight:Hc.clientWidth)*Hc.pixelRatio}),Hk(1,Hc,"container",function(){return Hc.__init__(),Hc._container||((Hc._container=Hc.createElement("div")).id="layaContainer",Hc.document.body.appendChild(Hc._container)),Hc._container},function(Ha){Hc._container=Ha}),Hk(1,Hc,"document",function(){return Hc.__init__(),Hc._document}),Hc.__init__=function(){if(!Hc._window){Hc._window=HD.getWindow(),Hc._document=Hc.window.document,Hc._window.addEventListener("message",function(Ha){laya.utils.Browser._onMessage(Ha)},!1),Hc.document.__createElement=Hc.document.createElement,Hg.requestAnimationFrame=Hg.requestAnimationFrame||Hg.webkitRequestAnimationFrame||Hg.mozRequestAnimationFrame||Hg.oRequestAnimationFrame||Hg.msRequestAnimationFrame||function(Ha){return Hg.setTimeout(Ha,1e3/60)};var Ha=Hg.document.body.style;Ha["-webkit-user-select"]="none",Ha["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",Hc.userAgent=Hc.window.navigator.userAgent,Hc.onIOS=!!(Hc.u=Hc.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),Hc.onMobile=-1<Hc.u.indexOf("Mobile"),Hc.onIPhone=-1<Hc.u.indexOf("iPhone"),Hc.onMac=-1<Hc.u.indexOf("Mac OS X"),Hc.onIPad=-1<Hc.u.indexOf("iPad"),Hc.onAndroid=-1<Hc.u.indexOf("Android")||-1<Hc.u.indexOf("Adr"),Hc.onWP=-1<Hc.u.indexOf("Windows Phone"),Hc.onQQBrowser=-1<Hc.u.indexOf("QQBrowser"),Hc.onMQQBrowser=-1<Hc.u.indexOf("MQQBrowser")||-1<Hc.u.indexOf("Mobile")&&-1<Hc.u.indexOf("QQ"),Hc.onIE=!!Hc.window.ActiveXObject||"ActiveXObject"in Hc.window,Hc.onWeiXin=-1<Hc.u.indexOf("MicroMessenger"),Hc.onPC=!Hc.onMobile,Hc.onSafari=-1<Hc.u.indexOf("Safari"),Hc.onFirefox=-1<Hc.u.indexOf("Firefox"),Hc.onEdge=-1<Hc.u.indexOf("Edge"),Hc.onMiniGame=-1<Hc.u.indexOf("MiniGame"),Hc.onLimixiu=-1<Hc.u.indexOf("limixiu"),Hc.httpProtocol="http:"==Hc.window.location.protocol,Hc.onMiniGame&&null==Hc.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),Hc.webAudioEnabled=!!(Hc.window.AudioContext||Hc.window.webkitAudioContext||Hc.window.mozAudioContext),Hc.soundType=Hc.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",Hea=Hc.webAudioEnabled?Hfa:Hca,Hc.webAudioEnabled&&Hfa.initWebAudio(),Hca._initMusicAudio(),Hc.enableTouch="ontouchstart"in Hg||Hg.DocumentTouch&&Hb instanceof DocumentTouch,Hg.focus(),HC._soundClass=Hea,HC._musicClass=Hca,HH._mainCanvas=HH._mainCanvas||Hta.create("2D"),Hc.canvas||(Hc.canvas=Hta.create("2D"),Hc.context=Hc.canvas.getContext("2d"))}},Hc._onMessage=function(Ha){if(Ha.data&&"size"==Ha.data.name){if(Hc.window.innerWidth=Ha.data.width,Hc.window.innerHeight=Ha.data.height,Hc.window.__innerHeight=Ha.data.clientHeight,!Hc.document.createEvent)return void console.warn("no document.createEvent");var Hb=Hc.document.createEvent("HTMLEvents");return Hb.initEvent("resize",!1,!1),void Hc.window.dispatchEvent(Hb)}},Hc.createElement=function(Ha){return Hc.__init__(),Hc.document.__createElement(Ha)},Hc.getElementById=function(Ha){return Hc.__init__(),Hc.document.getElementById(Ha)},Hc.removeElement=function(Ha){Ha&&Ha.parentNode&&Ha.parentNode.removeChild(Ha)},Hc.now=function(){return HD.now()},Hc._window=null,Hc._document=null,Hc._container=null,Hc.userAgent=null,Hc.u=null,Hc.onIOS=!1,Hc.onMac=!1,Hc.onMobile=!1,Hc.onIPhone=!1,Hc.onIPad=!1,Hc.onAndroid=!1,Hc.onWP=!1,Hc.onQQBrowser=!1,Hc.onMQQBrowser=!1,Hc.onSafari=!1,Hc.onFirefox=!1,Hc.onEdge=!1,Hc.onIE=!1,Hc.onWeiXin=!1,Hc.onMiniGame=!1,Hc.onLimixiu=!1,Hc.onPC=!1,Hc.httpProtocol=!1,Hc.webAudioEnabled=!1,Hc.soundType=null,Hc.enableTouch=!1,Hc.canvas=null,Hc.context=null,Hc.__init$=function(){},Hc}()),HN=function(){function Hb(Ha){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,Ha?(this._u8d_=new Uint8Array(Ha),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}Hp(Hb,"laya.utils.Byte");var Ha=Hb.prototype;return Ha.___resizeBuffer=function(Hb){try{var Ha=new Uint8Array(Hb);null!=this._u8d_&&(this._u8d_.length<=Hb?Ha.set(this._u8d_):Ha.set(this._u8d_.subarray(0,Hb))),this._u8d_=Ha,this._d_=new DataView(Ha.buffer)}catch(Ha){throw"___resizeBuffer err:"+Hb}},Ha.getString=function(){return this.rUTF(this.getUint16())},Ha.getFloat32Array=function(Ha,Hb){var Hc=Ha+Hb;Hc=Hc>this._length?this._length:Hc;var Hd=new Float32Array(this._d_.buffer.slice(Ha,Hc));return this._pos_=Hc,Hd},Ha.getUint8Array=function(Ha,Hb){var Hc=Ha+Hb;Hc=Hc>this._length?this._length:Hc;var Hd=new Uint8Array(this._d_.buffer.slice(Ha,Hc));return this._pos_=Hc,Hd},Ha.getInt16Array=function(Ha,Hb){var Hc=Ha+Hb;Hc=Hc>this._length?this._length:Hc;var Hd=new Int16Array(this._d_.buffer.slice(Ha,Hc));return this._pos_=Hc,Hd},Ha.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var Ha=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,Ha},Ha.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var Ha=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,Ha},Ha.writeFloat32=function(Ha){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,Ha,this._xd_),this._pos_+=4},Ha.writeFloat64=function(Ha){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,Ha,this._xd_),this._pos_+=8},Ha.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var Ha=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,Ha},Ha.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var Ha=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,Ha},Ha.writeInt32=function(Ha){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,Ha,this._xd_),this._pos_+=4},Ha.writeUint32=function(Ha){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,Ha,this._xd_),this._pos_+=4},Ha.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var Ha=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,Ha},Ha.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var Ha=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,Ha},Ha.writeUint16=function(Ha){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,Ha,this._xd_),this._pos_+=2},Ha.writeInt16=function(Ha){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,Ha,this._xd_),this._pos_+=2},Ha.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},Ha.writeUint8=function(Ha){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,Ha),this._pos_++},Ha._getUInt8=function(Ha){return this._d_.getUint8(Ha)},Ha._getUint16=function(Ha){return this._d_.getUint16(Ha,this._xd_)},Ha._getMatrix=function(){return new HE(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},Ha.rUTF=function(Ha){for(var Hb=[],Hc=this._pos_+Ha,Hd=0,He=0,Hf=0,Hg=String.fromCharCode,Hh=this._u8d_;this._pos_<Hc;)(Hd=Hh[this._pos_++])<128?0!=Hd&&Hb.push(Hg(Hd)):Hd<224?Hb.push(Hg((63&Hd)<<6|127&Hh[this._pos_++])):Hd<240?(He=Hh[this._pos_++],Hb.push(Hg((31&Hd)<<12|(127&He)<<6|127&Hh[this._pos_++]))):(He=Hh[this._pos_++],Hf=Hh[this._pos_++],Hb.push(Hg((15&Hd)<<18|(127&He)<<12|Hf<<6&127|127&Hh[this._pos_++]))),0;return Hb.join("")},Ha.getCustomString=function(Ha){for(var Hb=[],Hc=0,Hd=0,He=0,Hf=String.fromCharCode,Hg=this._u8d_;0<Ha;)if((Hd=Hg[this._pos_])<128)Hb.push(Hf(Hd)),this._pos_++,Ha--;else for(Hc=Hd-128,this._pos_++,Ha-=Hc;0<Hc;)Hd=Hg[this._pos_++],He=Hg[this._pos_++],Hb.push(Hf(He<<8|Hd)),Hc--;return Hb.join("")},Ha.clear=function(){this._pos_=0,this.length=0},Ha.__getBuffer=function(){return this._d_.buffer},Ha.writeUTFBytes=function(Ha){for(var Hb=0,Hc=(Ha+="").length;Hb<Hc;Hb++){var Hd=Ha.charCodeAt(Hb);Hd<=127?this.writeByte(Hd):Hd<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|Hd>>6,128|63&Hd],this._pos_),this._pos_+=2):Hd<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|Hd>>12,128|Hd>>6&63,128|63&Hd],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|Hd>>18,128|Hd>>12&63,128|Hd>>6&63,128|63&Hd],this._pos_),this._pos_+=4)}},Ha.writeUTFString=function(Ha){var Hb=this.pos;this.writeUint16(1),this.writeUTFBytes(Ha);var Hc=this.pos-Hb-2;if(65536<=Hc)throw"writeUTFString byte len more than 65536";this._d_.setUint16(Hb,Hc,this._xd_)},Ha.readUTFString=function(){return this.readUTFBytes(this.getUint16())},Ha.getUTFString=function(){return this.readUTFString()},Ha.readUTFBytes=function(Ha){if(void 0===Ha&&(Ha=-1),0==Ha)return"";var Hb=this.bytesAvailable;if(Hb<Ha)throw"readUTFBytes error - Out of bounds";return Ha=0<Ha?Ha:Hb,this.rUTF(Ha)},Ha.getUTFBytes=function(Ha){return void 0===Ha&&(Ha=-1),this.readUTFBytes(Ha)},Ha.writeByte=function(Ha){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,Ha),this._pos_+=1},Ha.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},Ha.getByte=function(){return this.readByte()},Ha.ensureWrite=function(Ha){this._length<Ha&&(this._length=Ha),this._allocated_<Ha&&(this.length=Ha)},Ha.writeArrayBuffer=function(Ha,Hb,Hc){if(void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),Hb<0||Hc<0)throw"writeArrayBuffer error - Out of bounds";0==Hc&&(Hc=Ha.byteLength-Hb),this.ensureWrite(this._pos_+Hc);var Hd=new Uint8Array(Ha);this._u8d_.set(Hd.subarray(Hb,Hb+Hc),this._pos_),this._pos_+=Hc},Hk(0,Ha,"buffer",function(){var Ha=this._d_.buffer;return Ha.byteLength==this.length?Ha:Ha.slice(0,this.length)}),Hk(0,Ha,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(Ha){this._xd_="littleEndian"==Ha}),Hk(0,Ha,"length",function(){return this._length},function(Ha){this._allocated_<Ha?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(Ha,2*this._allocated_))):this._allocated_>Ha&&this.___resizeBuffer(this._allocated_=Ha),this._length=Ha}),Hk(0,Ha,"pos",function(){return this._pos_},function(Ha){this._pos_=Ha}),Hk(0,Ha,"bytesAvailable",function(){return this._length-this._pos_}),Hb.getSystemEndian=function(){if(!Hb._sysEndian){var Ha=new ArrayBuffer(2);new DataView(Ha).setInt16(0,256,!0),Hb._sysEndian=256===new Int16Array(Ha)[0]?"littleEndian":"bigEndian"}return Hb._sysEndian},Hb.BIG_ENDIAN="bigEndian",Hb.LITTLE_ENDIAN="littleEndian",Hb._sysEndian=null,Hb}(),HO=function(){function He(){}return Hp(He,"laya.utils.CacheManager"),He.regCacheByFunction=function(Ha,Hb){var Hc;He.unRegCacheByFunction(Ha,Hb),Hc={tryDispose:Ha,getCacheList:Hb},He._cacheList.push(Hc)},He.unRegCacheByFunction=function(Ha,Hb){var Hc,Hd=0;for(Hc=He._cacheList.length,Hd=0;Hd<Hc;Hd++)if(He._cacheList[Hd].tryDispose==Ha&&He._cacheList[Hd].getCacheList==Hb)return void He._cacheList.splice(Hd,1)},He.forceDispose=function(){var Ha=0,Hb=He._cacheList.length;for(Ha=0;Ha<Hb;Ha++)He._cacheList[Ha].tryDispose(!0)},He.beginCheck=function(Ha){void 0===Ha&&(Ha=15e3),Hx.timer.loop(Ha,null,He._checkLoop)},He.stopCheck=function(){Hx.timer.clear(null,He._checkLoop)},He._checkLoop=function(){var Ha=He._cacheList;if(!(Ha.length<1)){var Hb,Hc=HM.now(),Hd=0;for(Hb=Hd=Ha.length;0<Hd&&(Ha[He._index=++He._index%Hb].tryDispose(!1),!(HM.now()-Hc>He.loopTimeLimit));)Hd--}},He.loopTimeLimit=2,He._cacheList=[],He._index=0,He}(),HP=function(){function Hn(){}return Hp(Hn,"laya.utils.ClassUtils"),Hn.regClass=function(Ha,Hb){Hn._classMap[Ha]=Hb},Hn.getRegClass=function(Ha){return Hn._classMap[Ha]},Hn.getInstance=function(Ha){var Hb=Hn.getClass(Ha);return Hb?new Hb:(console.warn("[error] Undefined class:",Ha),null)},Hn.createByJson=function(Ha,Hb,Hc,Hd,He){"string"==typeof Ha&&(Ha=JSON.parse(Ha));var Hf=Ha.props;if(!Hb&&!(Hb=He?He.runWith(Ha):Hn.getInstance(Hf.runtime||Ha.type)))return null;var Hg=Ha.child;if(Hg)for(var Hh=0,Hi=Hg.length;Hh<Hi;Hh++){var Hj=Hg[Hh];if("render"!==Hj.props.name&&"render"!==Hj.props.renderType||!Hb._$set_itemRender)if("Graphic"==Hj.type)Hn.addGraphicsToSprite(Hj,Hb);else if(Hn.isDrawType(Hj.type))Hn.addGraphicToSprite(Hj,Hb,!0);else{var Hk=Hn.createByJson(Hj,null,Hc,Hd,He);"Script"==Hj.type?Hk.hasOwnProperty("owner")?Hk.owner=Hb:Hk.hasOwnProperty("target")&&(Hk.target=Hb):"mask"==Hj.props.renderType?Hb.mask=Hk:Hb.addChild(Hk)}else Hb.itemRender=Hj}if(Hf)for(var Hl in Hf){var Hm=Hf[Hl];"var"===Hl&&Hc?Hc[Hm]=Hb:Hm instanceof Array&&"function"==typeof Hb[Hl]?Hb[Hl].apply(Hb,Hm):Hb[Hl]=Hm}return Hd&&Ha.customProps&&Hd.runWith([Hb,Ha]),Hb.created&&Hb.created(),Hb},Hn.addGraphicsToSprite=function(Ha,Hb){var Hc;if((Hc=Ha.child)&&!(Hc.length<1)){var Hd;Hd=Hn._getGraphicsFromSprite(Ha,Hb);var He=0,Hf=0;Ha.props&&(He=Hn._getObjVar(Ha.props,"x",0),Hf=Hn._getObjVar(Ha.props,"y",0)),0!=He&&0!=Hf&&Hd.translate(He,Hf);var Hg,Hh=0;for(Hg=Hc.length,Hh=0;Hh<Hg;Hh++)Hn._addGraphicToGraphics(Hc[Hh],Hd);0!=He&&0!=Hf&&Hd.translate(-He,-Hf)}},Hn.addGraphicToSprite=function(Ha,Hb,Hc){var Hd;void 0===Hc&&(Hc=!1),Hd=Hc?Hn._getGraphicsFromSprite(Ha,Hb):Hb.graphics,Hn._addGraphicToGraphics(Ha,Hd)},Hn._getGraphicsFromSprite=function(Ha,Hb){var Hc,Hd;if(!Ha||!Ha.props)return Hb.graphics;switch(Hd=Ha.props.renderType){case"hit":case"unHit":var He;Hb.hitArea||(Hb.hitArea=new HT),(He=Hb.hitArea)[Hd]||(He[Hd]=new Hm),Hc=He[Hd]}return Hc||(Hc=Hb.graphics),Hc},Hn._getTransformData=function(Ha){var Hb;(Ha.hasOwnProperty("pivotX")||Ha.hasOwnProperty("pivotY"))&&(Hb=Hb||new HE).translate(-Hn._getObjVar(Ha,"pivotX",0),-Hn._getObjVar(Ha,"pivotY",0));var Hc=Hn._getObjVar(Ha,"scaleX",1),Hd=Hn._getObjVar(Ha,"scaleY",1),He=Hn._getObjVar(Ha,"rotation",0);Hn._getObjVar(Ha,"skewX",0),Hn._getObjVar(Ha,"skewY",0);return 1==Hc&&1==Hd&&0==He||((Hb=Hb||new HE).scale(Hc,Hd),Hb.rotate(.0174532922222222*He)),Hb},Hn._addGraphicToGraphics=function(Ha,Hb){var Hc,Hd;if((Hc=Ha.props)&&(Hd=Hn.DrawTypeDic[Ha.type])){var He,Hf;He=Hb;var Hg=Hn._getParams(Hc,Hd[1],Hd[2],Hd[3]);((Hf=Hn._tM)||1!=Hn._alpha)&&(He.save(),Hf&&He.transform(Hf),1!=Hn._alpha&&He.alpha(Hn._alpha)),He[Hd[0]].apply(He,Hg),(Hf||1!=Hn._alpha)&&He.restore()}},Hn._adptLineData=function(Ha){return Ha[2]=parseFloat(Ha[0])+parseFloat(Ha[2]),Ha[3]=parseFloat(Ha[1])+parseFloat(Ha[3]),Ha},Hn._adptTextureData=function(Ha){return Ha[0]=Hha.getRes(Ha[0]),Ha},Hn._adptLinesData=function(Ha){return Ha[2]=Hn._getPointListByStr(Ha[2]),Ha},Hn.isDrawType=function(Ha){return"Image"!=Ha&&Hn.DrawTypeDic.hasOwnProperty(Ha)},Hn._getParams=function(Ha,Hb,Hc,Hd){var He;void 0===Hc&&(Hc=0),(He=Hn._temParam).length=Hb.length;var Hf,Hg,Hh=0;for(Hf=Hb.length,Hh=0;Hh<Hf;Hh++)He[Hh]=Hn._getObjVar(Ha,Hb[Hh][0],Hb[Hh][1]);return Hn._alpha=Hn._getObjVar(Ha,"alpha",1),Hg=Hn._getTransformData(Ha),Hn._tM=Hg?(Hc||(Hc=0),Hg.translate(He[Hc],He[Hc+1]),He[Hc]=He[Hc+1]=0,Hg):null,Hd&&Hn[Hd]&&(He=Hn[Hd](He)),He},Hn._getPointListByStr=function(Ha){var Hb,Hc,Hd=0;for(Hc=(Hb=Ha.split(",")).length,Hd=0;Hd<Hc;Hd++)Hb[Hd]=parseFloat(Hb[Hd]);return Hb},Hn._getObjVar=function(Ha,Hb,Hc){return Ha.hasOwnProperty(Hb)?Ha[Hb]:Hc},Hn._temParam=[],Hn._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},Hn.getClass=function(Ha){var Hb=Hn._classMap[Ha]||Ha;return"string"==typeof Hb?Hx.__classmap[Hb]:Hb},Hn._tM=null,Hn._alpha=NaN,Hi(Hn,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),Hn}(),HQ=function(){function Hf(Ha){if(this._color=[],"string"==typeof Ha){null===(this.strColor=Ha)&&(Ha="#000000"),"#"==Ha.charAt(0)&&(Ha=Ha.substr(1));var Hb=Ha.length;if(3==Hb||4==Hb){for(var Hc="",Hd=0;Hd<Hb;Hd++)Hc+=Ha[Hd]+Ha[Hd];Ha=Hc}var He=this.numColor=parseInt(Ha,16);if(8==Ha.length)return void(this._color=[parseInt(Ha.substr(0,2),16)/255,((16711680&He)>>16)/255,((65280&He)>>8)/255,(255&He)/255])}else He=this.numColor=Ha,this.strColor=HY.toHexColor(He);this._color=[((16711680&He)>>16)/255,((65280&He)>>8)/255,(255&He)/255,1],this._color.__id=++Hf._COLODID}return Hp(Hf,"laya.utils.Color"),Hf._initDefault=function(){for(var Ha in Hf._DEFAULT={},Hf._COLOR_MAP)Hf._SAVE[Ha]=Hf._DEFAULT[Ha]=new Hf(Hf._COLOR_MAP[Ha]);return Hf._DEFAULT},Hf._initSaveMap=function(){for(var Ha in Hf._SAVE_SIZE=0,Hf._SAVE={},Hf._DEFAULT)Hf._SAVE[Ha]=Hf._DEFAULT[Ha]},Hf.create=function(Ha){var Hb=Hf._SAVE[Ha+""];return null!=Hb?Hb:(Hf._SAVE_SIZE<1e3||Hf._initSaveMap(),Hf._SAVE[Ha+""]=new Hf(Ha))},Hf._SAVE={},Hf._SAVE_SIZE=0,Hf._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},Hf._DEFAULT=Hf._initDefault(),Hf._COLODID=1,Hf}(),HR=(function(){function Ha(){this._values=[],this._keys=[]}Hp(Ha,"laya.utils.Dictionary");var Hb=Ha.prototype;Hb.set=function(Ha,Hb){var Hc=this.indexOf(Ha);0<=Hc?this._values[Hc]=Hb:(this._keys.push(Ha),this._values.push(Hb))},Hb.indexOf=function(Ha){var Hb=this._keys.indexOf(Ha);return 0<=Hb?Hb:(Ha="string"==typeof Ha?Number(Ha):"number"==typeof Ha?Ha.toString():Ha,this._keys.indexOf(Ha))},Hb.get=function(Ha){var Hb=this.indexOf(Ha);return Hb<0?null:this._values[Hb]},Hb.remove=function(Ha){var Hb=this.indexOf(Ha);return 0<=Hb&&(this._keys.splice(Hb,1),this._values.splice(Hb,1),!0)},Hb.clear=function(){this._values.length=0,this._keys.length=0},Hk(0,Hb,"values",function(){return this._values}),Hk(0,Hb,"keys",function(){return this._keys})}(),function(){function Ha(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}Hp(Ha,"laya.utils.Dragging");var Hb=Ha.prototype;return Hb.start=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){void 0===Hh&&(Hh=.92),this.clearTimer(),this.target=Ha,this.area=Hb,this.hasInertia=Hc,this.elasticDistance=Hb?Hd:0,this.elasticBackTime=He,this.data=Hf,this._disableMouseEvent=Hg,this.ratio=Hh,1!=Ha.globalScaleX||1!=Ha.globalScaleY?this._parent=Ha.parent:this._parent=Hx.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,Hx.stage.on("mouseup",this,this.onStageMouseUp),Hx.stage.on("mouseout",this,this.onStageMouseUp),Hx.timer.frameLoop(1,this,this.loop)},Hb.clearTimer=function(){Hx.timer.clear(this,this.loop),Hx.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},Hb.stop=function(){this._dragging&&(Ho.instance.disableMouseEvent=!1,Hx.stage.off("mouseup",this,this.onStageMouseUp),Hx.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},Hb.loop=function(){var Ha=this._parent.getMousePoint(),Hb=Ha.x,Hc=Ha.y,Hd=Hb-this._lastX,He=Hc-this._lastY;if(this._clickOnly){if(!(1<Math.abs(Hd*Hx.stage._canvasTransform.getScaleX())||1<Math.abs(He*Hx.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),Ho.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(Hd,He);0==Hd&&0==He||(this._lastX=Hb,this._lastY=Hc,this.target.x+=Hd*this._elasticRateX,this.target.y+=He*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},Hb.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var Ha=this.area.x-this.target.x;else Ha=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-Ha/this.elasticDistance),this.target.y<this.area.y)var Hb=this.area.y-this.target.y;else Hb=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-Hb/this.elasticDistance)}},Hb.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},Hb.onStageMouseUp=function(Ha){if(Ho.instance.disableMouseEvent=!1,Hx.stage.off("mouseup",this,this.onStageMouseUp),Hx.stage.off("mouseout",this,this.onStageMouseUp),Hx.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var Hb=this._offsets.length,Hc=Math.min(Hb,6),Hd=this._offsets.length-Hc,He=Hb-1;Hd<He;He--)this._offsetY+=this._offsets[He--],this._offsetX+=this._offsets[He];this._offsetX=this._offsetX/Hc*2,this._offsetY=this._offsetY/Hc*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),Hx.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},Hb.checkElastic=function(){var Ha=NaN,Hb=NaN;if(this.target.x<this.area.x?Ha=this.area.x:this.target.x>this.area.x+this.area.width&&(Ha=this.area.x+this.area.width),this.target.y<this.area.y?Hb=this.area.y:this.target.y>this.area.y+this.area.height&&(Hb=this.area.y+this.area.height),isNaN(Ha)&&isNaN(Hb))this.clear();else{var Hc={};isNaN(Ha)||(Hc.x=Ha),isNaN(Hb)||(Hc.y=Hb),this._tween=HX.to(this.target,Hc,this.elasticBackTime,HS.sineOut,Hs.create(this,this.clear),0,!1,!1)}},Hb.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(Hx.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},Hb.clear=function(){if(this.target){this.clearTimer();var Ha=this.target;this.target=null,this._parent=null,Ha.event("dragend",this.data)}},Ha}()),HS=function(){function Hh(){}return Hp(Hh,"laya.utils.Ease"),Hh.linearNone=function(Ha,Hb,Hc,Hd){return Hc*Ha/Hd+Hb},Hh.linearIn=function(Ha,Hb,Hc,Hd){return Hc*Ha/Hd+Hb},Hh.linearInOut=function(Ha,Hb,Hc,Hd){return Hc*Ha/Hd+Hb},Hh.linearOut=function(Ha,Hb,Hc,Hd){return Hc*Ha/Hd+Hb},Hh.bounceIn=function(Ha,Hb,Hc,Hd){return Hc-Hh.bounceOut(Hd-Ha,0,Hc,Hd)+Hb},Hh.bounceInOut=function(Ha,Hb,Hc,Hd){return Ha<.5*Hd?.5*Hh.bounceIn(2*Ha,0,Hc,Hd)+Hb:.5*Hh.bounceOut(2*Ha-Hd,0,Hc,Hd)+.5*Hc+Hb},Hh.bounceOut=function(Ha,Hb,Hc,Hd){return(Ha/=Hd)<1/2.75?Hc*(7.5625*Ha*Ha)+Hb:Ha<2/2.75?Hc*(7.5625*(Ha-=1.5/2.75)*Ha+.75)+Hb:Ha<2.5/2.75?Hc*(7.5625*(Ha-=2.25/2.75)*Ha+.9375)+Hb:Hc*(7.5625*(Ha-=2.625/2.75)*Ha+.984375)+Hb},Hh.backIn=function(Ha,Hb,Hc,Hd,He){return void 0===He&&(He=1.70158),Hc*(Ha/=Hd)*Ha*((He+1)*Ha-He)+Hb},Hh.backInOut=function(Ha,Hb,Hc,Hd,He){return void 0===He&&(He=1.70158),(Ha/=.5*Hd)<1?.5*Hc*(Ha*Ha*((1+(He*=1.525))*Ha-He))+Hb:Hc/2*((Ha-=2)*Ha*((1+(He*=1.525))*Ha+He)+2)+Hb},Hh.backOut=function(Ha,Hb,Hc,Hd,He){return void 0===He&&(He=1.70158),Hc*((Ha=Ha/Hd-1)*Ha*((He+1)*Ha+He)+1)+Hb},Hh.elasticIn=function(Ha,Hb,Hc,Hd,He,Hf){var Hg;return void 0===He&&(He=0),void 0===Hf&&(Hf=0),0==Ha?Hb:1==(Ha/=Hd)?Hb+Hc:(Hf||(Hf=.3*Hd),Hg=!He||0<Hc&&He<Hc||Hc<0&&He<-Hc?(He=Hc,Hf/4):Hf/Hh.PI2*Math.asin(Hc/He),-He*Math.pow(2,10*(Ha-=1))*Math.sin((Ha*Hd-Hg)*Hh.PI2/Hf)+Hb)},Hh.elasticInOut=function(Ha,Hb,Hc,Hd,He,Hf){var Hg;return void 0===He&&(He=0),void 0===Hf&&(Hf=0),0==Ha?Hb:2==(Ha/=.5*Hd)?Hb+Hc:(Hf||(Hf=Hd*(.3*1.5)),Hg=!He||0<Hc&&He<Hc||Hc<0&&He<-Hc?(He=Hc,Hf/4):Hf/Hh.PI2*Math.asin(Hc/He),Ha<1?He*Math.pow(2,10*(Ha-=1))*Math.sin((Ha*Hd-Hg)*Hh.PI2/Hf)*-.5+Hb:He*Math.pow(2,-10*(Ha-=1))*Math.sin((Ha*Hd-Hg)*Hh.PI2/Hf)*.5+Hc+Hb)},Hh.elasticOut=function(Ha,Hb,Hc,Hd,He,Hf){var Hg;return void 0===He&&(He=0),void 0===Hf&&(Hf=0),0==Ha?Hb:1==(Ha/=Hd)?Hb+Hc:(Hf||(Hf=.3*Hd),Hg=!He||0<Hc&&He<Hc||Hc<0&&He<-Hc?(He=Hc,Hf/4):Hf/Hh.PI2*Math.asin(Hc/He),He*Math.pow(2,-10*Ha)*Math.sin((Ha*Hd-Hg)*Hh.PI2/Hf)+Hc+Hb)},Hh.strongIn=function(Ha,Hb,Hc,Hd){return Hc*(Ha/=Hd)*Ha*Ha*Ha*Ha+Hb},Hh.strongInOut=function(Ha,Hb,Hc,Hd){return(Ha/=.5*Hd)<1?.5*Hc*Ha*Ha*Ha*Ha*Ha+Hb:.5*Hc*((Ha-=2)*Ha*Ha*Ha*Ha+2)+Hb},Hh.strongOut=function(Ha,Hb,Hc,Hd){return Hc*((Ha=Ha/Hd-1)*Ha*Ha*Ha*Ha+1)+Hb},Hh.sineInOut=function(Ha,Hb,Hc,Hd){return.5*-Hc*(Math.cos(Math.PI*Ha/Hd)-1)+Hb},Hh.sineIn=function(Ha,Hb,Hc,Hd){return-Hc*Math.cos(Ha/Hd*Hh.HALF_PI)+Hc+Hb},Hh.sineOut=function(Ha,Hb,Hc,Hd){return Hc*Math.sin(Ha/Hd*Hh.HALF_PI)+Hb},Hh.quintIn=function(Ha,Hb,Hc,Hd){return Hc*(Ha/=Hd)*Ha*Ha*Ha*Ha+Hb},Hh.quintInOut=function(Ha,Hb,Hc,Hd){return(Ha/=.5*Hd)<1?.5*Hc*Ha*Ha*Ha*Ha*Ha+Hb:.5*Hc*((Ha-=2)*Ha*Ha*Ha*Ha+2)+Hb},Hh.quintOut=function(Ha,Hb,Hc,Hd){return Hc*((Ha=Ha/Hd-1)*Ha*Ha*Ha*Ha+1)+Hb},Hh.quartIn=function(Ha,Hb,Hc,Hd){return Hc*(Ha/=Hd)*Ha*Ha*Ha+Hb},Hh.quartInOut=function(Ha,Hb,Hc,Hd){return(Ha/=.5*Hd)<1?.5*Hc*Ha*Ha*Ha*Ha+Hb:.5*-Hc*((Ha-=2)*Ha*Ha*Ha-2)+Hb},Hh.quartOut=function(Ha,Hb,Hc,Hd){return-Hc*((Ha=Ha/Hd-1)*Ha*Ha*Ha-1)+Hb},Hh.cubicIn=function(Ha,Hb,Hc,Hd){return Hc*(Ha/=Hd)*Ha*Ha+Hb},Hh.cubicInOut=function(Ha,Hb,Hc,Hd){return(Ha/=.5*Hd)<1?.5*Hc*Ha*Ha*Ha+Hb:.5*Hc*((Ha-=2)*Ha*Ha+2)+Hb},Hh.cubicOut=function(Ha,Hb,Hc,Hd){return Hc*((Ha=Ha/Hd-1)*Ha*Ha+1)+Hb},Hh.quadIn=function(Ha,Hb,Hc,Hd){return Hc*(Ha/=Hd)*Ha+Hb},Hh.quadInOut=function(Ha,Hb,Hc,Hd){return(Ha/=.5*Hd)<1?.5*Hc*Ha*Ha+Hb:.5*-Hc*(--Ha*(Ha-2)-1)+Hb},Hh.quadOut=function(Ha,Hb,Hc,Hd){return-Hc*(Ha/=Hd)*(Ha-2)+Hb},Hh.expoIn=function(Ha,Hb,Hc,Hd){return 0==Ha?Hb:Hc*Math.pow(2,10*(Ha/Hd-1))+Hb-.001*Hc},Hh.expoInOut=function(Ha,Hb,Hc,Hd){return 0==Ha?Hb:Ha==Hd?Hb+Hc:(Ha/=.5*Hd)<1?.5*Hc*Math.pow(2,10*(Ha-1))+Hb:.5*Hc*(2-Math.pow(2,-10*--Ha))+Hb},Hh.expoOut=function(Ha,Hb,Hc,Hd){return Ha==Hd?Hb+Hc:Hc*(1-Math.pow(2,-10*Ha/Hd))+Hb},Hh.circIn=function(Ha,Hb,Hc,Hd){return-Hc*(Math.sqrt(1-(Ha/=Hd)*Ha)-1)+Hb},Hh.circInOut=function(Ha,Hb,Hc,Hd){return(Ha/=.5*Hd)<1?.5*-Hc*(Math.sqrt(1-Ha*Ha)-1)+Hb:.5*Hc*(Math.sqrt(1-(Ha-=2)*Ha)+1)+Hb},Hh.circOut=function(Ha,Hb,Hc,Hd){return Hc*Math.sqrt(1-(Ha=Ha/Hd-1)*Ha)+Hb},Hh.HALF_PI=.5*Math.PI,Hh.PI2=2*Math.PI,Hh}(),HT=function(){function Hl(){this._hit=null,this._unHit=null}Hp(Hl,"laya.utils.HitArea");var Ha=Hl.prototype;return Ha.isHit=function(Ha,Hb){return!!Hl.isHitGraphic(Ha,Hb,this.hit)&&!Hl.isHitGraphic(Ha,Hb,this.unHit)},Ha.contains=function(Ha,Hb){return this.isHit(Ha,Hb)},Hk(0,Ha,"hit",function(){return this._hit||(this._hit=new Hm),this._hit},function(Ha){this._hit=Ha}),Hk(0,Ha,"unHit",function(){return this._unHit||(this._unHit=new Hm),this._unHit},function(Ha){this._unHit=Ha}),Hl.isHitGraphic=function(Ha,Hb,Hc){if(!Hc)return!1;var Hd;if(!(Hd=Hc.cmds)&&Hc._one&&((Hd=Hl._cmds).length=1,Hd[0]=Hc._one),!Hd)return!1;var He,Hf,Hg=0;for(He=Hd.length,Hg=0;Hg<He;Hg++)if(Hf=Hd[Hg]){var Hh=HH._context;switch(Hf.callee){case Hh._translate:case 6:Ha-=Hf[0],Hb-=Hf[1]}if(Hl.isHitCmd(Ha,Hb,Hf))return!0}return!1},Hl.isHitCmd=function(Ha,Hb,Hc){if(!Hc)return!1;var Hd=HH._context,He=!1;switch(Hc.callee){case Hd._drawRect:case 13:Hl._rec.setTo(Hc[0],Hc[1],Hc[2],Hc[3]),He=Hl._rec.contains(Ha,Hb);break;case Hd._drawCircle:case Hd._fillCircle:case 14:He=(Ha-=Hc[0])*Ha+(Hb-=Hc[1])*Hb<Hc[2]*Hc[2];break;case Hd._drawPoly:case 18:Ha-=Hc[0],Hb-=Hc[1],He=Hl.ptInPolygon(Ha,Hb,Hc[2])}return He},Hl.ptInPolygon=function(Ha,Hb,Hc){var Hd;(Hd=Hl._ptPoint).setTo(Ha,Hb);var He,Hf=0,Hg=NaN,Hh=NaN,Hi=NaN,Hj=NaN;He=Hc.length;for(var Hk=0;Hk<He;Hk+=2){if(Hg=Hc[Hk],Hh=Hc[Hk+1],Hi=Hc[(Hk+2)%He],Hh!=(Hj=Hc[(Hk+3)%He]))if(!(Hd.y<Math.min(Hh,Hj)))if(!(Hd.y>=Math.max(Hh,Hj)))(Hd.y-Hh)*(Hi-Hg)/(Hj-Hh)+Hg>Hd.x&&Hf++}return Hf%2==1},Hl._cmds=[],Hi(Hl,["_rec",function(){return this._rec=new Hz},"_ptPoint",function(){return this._ptPoint=new Hy}]),Hl}(),HU=(function(){function He(Ha,Hb,Hc,Hd){this.char=Ha,this.charNum=Ha.charCodeAt(0),this._x=this._y=0,this.width=Hb,this.height=Hc,this.style=Hd,this.isWord=!He._isWordRegExp.test(Ha)}Hp(He,"laya.utils.HTMLChar");var Ha=He.prototype;Hx.imps(Ha,{"laya.display.ILayout":!0}),Ha.setSprite=function(Ha){this._sprite=Ha},Ha.getSprite=function(){return this._sprite},Ha._isChar=function(){return!0},Ha._getCSSStyle=function(){return this.style},Hk(0,Ha,"width",function(){return this._w},function(Ha){this._w=Ha}),Hk(0,Ha,"x",function(){return this._x},function(Ha){this._sprite&&(this._sprite.x=Ha),this._x=Ha}),Hk(0,Ha,"y",function(){return this._y},function(Ha){this._sprite&&(this._sprite.y=Ha),this._y=Ha}),Hk(0,Ha,"height",function(){return this._h},function(Ha){this._h=Ha}),He._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function Hb(){}Hp(Hb,"laya.utils.Log"),Hb.enable=function(){Hb._logdiv||(Hb._logdiv=HM.window.document.createElement("div"),HM.window.document.body.appendChild(Hb._logdiv),Hb._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},Hb.toggle=function(){var Ha=Hb._logdiv.style;"1px"==Ha.width?Ha.width=Ha.height="50%":Ha.width=Ha.height="1px"},Hb.print=function(Ha){Hb._logdiv&&(Hb.maxCount<=Hb._count&&Hb.clear(),Hb._count++,Hb._logdiv.innerText+=Ha+"\n",Hb._logdiv.scrollTop=Hb._logdiv.scrollHeight)},Hb.clear=function(){Hb._logdiv.innerText="",Hb._count=0},Hb._logdiv=null,Hb._count=0,Hb.maxCount=20}(),function(){function Hb(){}Hp(Hb,"laya.utils.Mouse"),Hk(1,Hb,"cursor",function(){return Hb._style.cursor},function(Ha){Hb._style.cursor=Ha}),Hb.hide=function(){"none"!=Hb.cursor&&(Hb._preCursor=Hb.cursor,Hb.cursor="none")},Hb.show=function(){"none"==Hb.cursor&&(Hb.cursor=Hb._preCursor?Hb._preCursor:"auto")},Hb._preCursor=null,Hi(Hb,["_style",function(){return this._style=HM.document.body.style}])}(),function(){function Hf(){}return Hp(Hf,"laya.utils.Pool"),Hf.getPoolBySign=function(Ha){return Hf._poolDic[Ha]||(Hf._poolDic[Ha]=[])},Hf.clearBySign=function(Ha){Hf._poolDic[Ha]&&(Hf._poolDic[Ha].length=0)},Hf.recover=function(Ha,Hb){Hb.__InPool||(Hb.__InPool=!0,Hf.getPoolBySign(Ha).push(Hb))},Hf.getItemByClass=function(Ha,Hb){var Hc=Hf.getPoolBySign(Ha),Hd=Hc.length?Hc.pop():new Hb;return Hd.__InPool=!1,Hd},Hf.getItemByCreateFun=function(Ha,Hb,Hc){var Hd=Hf.getPoolBySign(Ha),He=Hd.length?Hd.pop():Hb.call(Hc);return He.__InPool=!1,He},Hf.getItem=function(Ha){var Hb=Hf.getPoolBySign(Ha),Hc=Hb.length?Hb.pop():null;return Hc&&(Hc.__InPool=!1),Hc},Hf._poolDic={},Hf.InPoolSign="__InPool",Hf}()),HV=function(){function Hi(){}return Hp(Hi,"laya.utils.Stat"),Hk(1,Hi,"onclick",null,function(Ha){Hi._sp&&Hi._sp.on("click",Hi._sp,Ha),Hi._canvas&&(Hi._canvas.source.onclick=Ha,Hi._canvas.source.style.pointerEvents="")}),Hi.show=function(Ha,Hb,Hc){if(void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),!HH.isConchApp||HH.isConchWebGL){if(HH.isConchWebGL||HM.onMiniGame||HM.onLimixiu||(Hi._useCanvas=!0),Hi._show=!0,Hi._fpsData.length=60,Hi._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},Hi._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},Hi._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},Hi._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},HH.isWebGL)if(Hi._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},HH.is3DMode){if(Hi._view[0].title="FPS(3D)",Hi._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},Hi._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},Hi._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==Hc){var Hd=8;Hi._view[Hd++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},Hi._view[Hd++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},Hi._view[Hd++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},Hi._view[Hd++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Hi._view[Hd++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Hi._view[Hd++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Hi._view[Hd++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},Hi._view[Hd++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},Hi._view[Hd++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==Hc){Hd=8;Hi._view[Hd++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},Hi._view[Hd++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},Hi._view[Hd++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},Hi._view[Hd++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},Hi._view[Hd++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},Hi._view[Hd++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},Hi._view[Hd++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else Hi._view[0].title="FPS(WebGL)",Hi._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else Hi._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};Hi._useCanvas?Hi.createUIPre(Ha,Hb):Hi.createUI(Ha,Hb),Hi.enable()}else HM.window.conch.showFPS&&HM.window.conch.showFPS(Ha,Hb)},Hi.createUIPre=function(Ha,Hb){var Hc=HM.pixelRatio;Hi._width=170*Hc,Hi._vx=75*Hc,Hi._height=Hc*(12*Hi._view.length+3*Hc)+4,Hi._fontSize=12*Hc;for(var Hd=0;Hd<Hi._view.length;Hd++)Hi._view[Hd].x=4,Hi._view[Hd].y=Hd*Hi._fontSize+2*Hc;Hi._canvas||((Hi._canvas=new Hta("2D")).size(Hi._width,Hi._height),(Hi._ctx=Hi._canvas.getContext("2d")).textBaseline="top",Hi._ctx.font=Hi._fontSize+"px Sans-serif",Hi._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+Ha+"px;top:"+Hb+"px;width:"+Hi._width/Hc+"px;height:"+Hi._height/Hc+"px;"),Hi._first=!0,Hi.loop(),Hi._first=!1,HM.container.appendChild(Hi._canvas.source)},Hi.createUI=function(Ha,Hb){var Hc=Hi._sp,Hd=HM.pixelRatio;Hc||(Hc=new Hla,(Hi._leftText=new Hqa).pos(5,5),Hi._leftText.color="#ffffff",Hc.addChild(Hi._leftText),(Hi._txt=new Hqa).pos(80*Hd,5),Hi._txt.color="#ffffff",Hc.addChild(Hi._txt),Hi._sp=Hc),Hc.pos(Ha,Hb);for(var He="",Hf=0;Hf<Hi._view.length;Hf++){He+=Hi._view[Hf].title+"\n"}Hi._leftText.text=He;var Hg=170*Hd,Hh=Hd*(12*Hi._view.length+3*Hd)+4;Hi._txt.fontSize=Hi._fontSize*Hd,Hi._leftText.fontSize=Hi._fontSize*Hd,Hc.size(Hg,Hh),Hc.graphics.clear(),Hc.graphics.setAlpha(.5),Hc.graphics.drawRect(0,0,Hg,Hh,"#999999"),Hc.graphics.setAlpha(1),Hi.loop()},Hi.enable=function(){Hx.timer.frameLoop(1,Hi,Hi.loop)},Hi.hide=function(){Hi._show=!1,Hx.timer.clear(Hi,Hi.loop),Hi._canvas&&HM.removeElement(Hi._canvas.source)},Hi.clear=function(){Hi.trianglesFaces=Hi.drawCall=Hi.shaderCall=Hi.spriteCount=Hi.spriteRenderUseCacheCount=Hi.treeNodeCollision=Hi.treeSpriteCollision=Hi.canvasNormal=Hi.canvasBitmap=Hi.canvasReCache=0},Hi.loop=function(){Hi._count++;var Ha=HM.now();if(!(Ha-Hi._timer<1e3)){var Hb=Hi._count;if(Hi.FPS=Math.round(1e3*Hb/(Ha-Hi._timer)),Hi._show){Hi.trianglesFaces=Math.round(Hi.trianglesFaces/Hb),Hi.spriteCount=Hi._useCanvas?(Hi.drawCall=Math.round(Hi.drawCall/Hb)-2,Hi.shaderCall=Math.round(Hi.shaderCall/Hb),Math.round(Hi.spriteCount/Hb)-1):(Hi.drawCall=Math.round(Hi.drawCall/Hb)-2,Hi.shaderCall=Math.round(Hi.shaderCall/Hb)-4,Math.round(Hi.spriteCount/Hb)-4),Hi.spriteRenderUseCacheCount=Math.round(Hi.spriteRenderUseCacheCount/Hb),Hi.canvasNormal=Math.round(Hi.canvasNormal/Hb),Hi.canvasBitmap=Math.round(Hi.canvasBitmap/Hb),Hi.canvasReCache=Math.ceil(Hi.canvasReCache/Hb),Hi.treeNodeCollision=Math.round(Hi.treeNodeCollision/Hb),Hi.treeSpriteCollision=Math.round(Hi.treeSpriteCollision/Hb);var Hc=0<Hi.FPS?Math.floor(1e3/Hi.FPS).toString():" ";Hi._fpsStr=Hi.FPS+(Hi.renderSlow?" slow":"")+" "+Hc,Hi._spriteStr=Hi.spriteCount+(Hi.spriteRenderUseCacheCount?"/"+Hi.spriteRenderUseCacheCount:""),Hi._canvasStr=Hi.canvasReCache+"/"+Hi.canvasNormal+"/"+Hi.canvasBitmap,Hi.currentMemorySize=HL.systemResourceManager.memorySize,Hi._useCanvas?Hi.renderInfoPre():Hi.renderInfo(),Hi.clear()}Hi._count=0,Hi._timer=Ha}},Hi.renderInfoPre=function(){if(Hi._canvas){var Ha=Hi._ctx;Ha.clearRect(Hi._first?0:Hi._vx,0,Hi._width,Hi._height);for(var Hb=HH.WebGL.mainContext,Hc=0;Hc<Hi._view.length;Hc++){var Hd=Hi._view[Hc];Hi._first&&(Ha.fillStyle="white",Ha.fillText(Hd.title,Hd.x,Hd.y,null,null,null)),Ha.fillStyle=Hd.color;var He=-1;if((Hd=Hi._view[Hc]).varying){if(Hb)switch(Hd.varying){case 1:He=Hb.getParameter(Hb[Hd.value]);break;case 2:He=Hb.getExtension(Hd.value)}}else He=Hi[Hd.value];"M"==Hd.units&&(He=Math.floor(He/1048576*100)/100+" M"),"K"==Hd.units&&(He=Math.floor(He/1024*100)/100+" K"),"string"==Hd.units&&(He=He.match(/\d+\.?\d/i)),Ha.fillText(He+"",Hd.x+Hi._vx,Hd.y,null,null,null)}}},Hi.renderInfo=function(){for(var Ha="",Hb=HH.WebGL.mainContext,Hc=0;Hc<Hi._view.length;Hc++){var Hd=Hi._view[Hc],He=-1;if(Hd.varying){if(Hb)switch(Hd.varying){case 1:He=Hb.getParameter(Hb[Hd.value]);break;case 2:He=Hb.getExtension(Hd.value)}}else He=Hi[Hd.value];"M"==Hd.units&&(He=Math.floor(He/1048576*100)/100+" M"),"K"==Hd.units&&(He=Math.floor(He/1024*100)/100+" K"),"string"==Hd.units&&(He=He.match(/\d+\.?\d/i)),Ha+=He+"\n"}Hi._txt.text=Ha},Hi.FPS=0,Hi.loopCount=0,Hi.shaderCall=0,Hi.drawCall=0,Hi.trianglesFaces=0,Hi.spriteCount=0,Hi.spriteRenderUseCacheCount=0,Hi.treeNodeCollision=0,Hi.treeSpriteCollision=0,Hi.canvasNormal=0,Hi.canvasBitmap=0,Hi.canvasReCache=0,Hi.renderSlow=!1,Hi.currentMemorySize=0,Hi._fpsStr=null,Hi._canvasStr=null,Hi._spriteStr=null,Hi._fpsData=[],Hi._timer=0,Hi._count=0,Hi._view=[],Hi._fontSize=12,Hi._txt=null,Hi._leftText=null,Hi._sp=null,Hi._show=!1,Hi._useCanvas=!1,Hi._canvas=null,Hi._ctx=null,Hi._first=!1,Hi._vx=NaN,Hi._width=0,Hi._height=100,Hi}(),HW=(function(){function Ha(){this._strsToID={},this._idToStrs=[],this._length=0}Hp(Ha,"laya.utils.StringKey");var Hb=Ha.prototype;Hb.add=function(Ha){var Hb=this._strsToID[Ha];return null!=Hb?Hb:(this._idToStrs[this._length]=Ha,this._strsToID[Ha]=this._length++)},Hb.getID=function(Ha){var Hb=this._strsToID[Ha];return null==Hb?-1:Hb},Hb.getName=function(Ha){var Hb=this._idToStrs[Ha];return null==Hb?void 0:Hb}}(),function(){var Hj;function Ha(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}Hp(Ha,"laya.utils.Timer");var Hb=Ha.prototype;return Hb._init=function(){Hx.timer&&Hx.timer.frameLoop(1,this,this._update)},Hb._now=function(){return Date.now()},Hb._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var Ha=this.currFrame=this.currFrame+this.scale,Hb=this._now();this._delta=(Hb-this._lastTimer)*this.scale;var Hc=this.currTimer=this.currTimer+this._delta;Hx.isDebug&&6e4<Math.abs(Hb-this._lastTimer)&&console.error("系统时间错误！"+(Hb-this._lastTimer)),this._lastTimer=Hb;var Hd=this._handlers;for(Hg=this._count=0,Hh=Hd.length;Hg<Hh;Hg++)if(null!==(Hi=Hd[Hg]).method){var He=Hi.userFrame?Ha:Hc;if(He>=Hi.exeTime)if(Hi.repeat)if(Hi.jumpFrame)for(;He>=Hi.exeTime;)Hi.exeTime+=Hi.delay,Hi.run(!1);else Hi.exeTime+=Hi.delay,Hi.run(!1),He>Hi.exeTime&&(Hi.exeTime+=Math.ceil((He-Hi.exeTime)/Hi.delay)*Hi.delay);else Hi.run(!0)}else this._count++;(30<this._count||Ha%200==0)&&this._clearHandlers();for(var Hf=this._laters,Hg=0,Hh=Hf.length-1;Hg<=Hh;Hg++){var Hi=Hf[Hg];this._isIgnoreRecover(Hi)||(null!==Hi.method&&(delete this._map[Hi.key],Hi.run(!1)),this._recoverHandler(Hi)),Hg===Hh&&(Hh=Hf.length-1)}Hf.length=0}},Hb._clearHandlers=function(){for(var Ha=this._handlers,Hb=0,Hc=Ha.length;Hb<Hc;Hb++){var Hd=Ha[Hb];null!==Hd.method?this._temp.push(Hd):this._isIgnoreRecover(Hd)?this._temp.push(Hd):this._recoverHandler(Hd)}this._handlers=this._temp,this._temp=Ha,this._temp.length=0},Hb._recoverHandler=function(Ha){this._map[Ha.key]==Ha&&delete this._map[Ha.key],Ha.recover()},Hb._create=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){if(!Hc)return He.apply(Hd,Hf),null;if(Hg){var Hi=this._getHandler(Hd,He);if(Hi)return Hi.repeat=Hb,Hi.userFrame=Ha,Hi.delay=Hc,Hi.ignoreRecover=Hh,Hi.caller=Hd,Hi.method=He,Hi.args=Hf,Hi.exeTime=Hc+(Ha?this.currFrame:this.currTimer+this._now()-this._lastTimer),Hi}return(Hi=Hj.create()).repeat=Hb,Hi.userFrame=Ha,Hi.delay=Hc,Hi.ignoreRecover=Hh,Hi.caller=Hd,Hi.method=He,Hi.args=Hf,Hi.exeTime=Hc+(Ha?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(Hi),this._handlers.push(Hi),Hi},Hb._indexHandler=function(Ha){var Hb=Ha.caller,Hc=Ha.method,Hd=Hb?Hb.$_GID||(Hb.$_GID=HY.getGID()):0,He=Hc.$_TID||(Hc.$_TID=this._mid++);Ha.key=Hd+"_"+He,this._map[Ha.key]=Ha},Hb.once=function(Ha,Hb,Hc,Hd,He){void 0===He&&(He=!0),this._create(!1,!1,Ha,Hb,Hc,Hd,He,!1)},Hb.loop=function(Ha,Hb,Hc,Hd,He,Hf,Hg){void 0===He&&(He=!0),void 0===Hf&&(Hf=!1),void 0===Hg&&(Hg=!1);var Hh=this._create(!1,!0,Ha,Hb,Hc,Hd,He,Hg);Hh&&(Hh.jumpFrame=Hf)},Hb.frameOnce=function(Ha,Hb,Hc,Hd,He){void 0===He&&(He=!0),this._create(!0,!1,Ha,Hb,Hc,Hd,He,!1)},Hb.frameLoop=function(Ha,Hb,Hc,Hd,He,Hf){void 0===He&&(He=!0),void 0===Hf&&(Hf=!1),this._create(!0,!0,Ha,Hb,Hc,Hd,He,Hf)},Hb.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+Hj._freeCount},Hb.clear=function(Ha,Hb){var Hc=this._getHandler(Ha,Hb);return!(!Hc||this._isIgnoreRecover(Hc))&&(delete this._map[Hc.key],Hc.key=null,Hc.clear(),!0)},Hb.clearAll=function(Ha){if(Ha)for(var Hb=0,Hc=this._handlers.length;Hb<Hc;Hb++){var Hd=this._handlers[Hb];Hd.caller===Ha&&(this._isIgnoreRecover(Hd)||(delete this._map[Hd.key],Hd.key=null,Hd.clear()))}},Hb._getHandler=function(Ha,Hb){var Hc=Ha?Ha.$_GID||(Ha.$_GID=HY.getGID()):0,Hd=Hb.$_TID||(Hb.$_TID=this._mid++);return this._map[Hc+"_"+Hd]},Hb._isIgnoreRecover=function(Ha){if(Ha.ignoreRecover||Ha.caller&&"IgnoreRecover"==Ha.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var Hb="";try{arguments.propertyIsEnumerable.caller}catch(Ha){Hb=Ha.stack}Hx.recordError("报错：核心定时器销毁忽略  "+Hb)}return!0}return!1},Hb.hasHandler=function(Ha,Hb){return this._map[Ha.$_GID+"_"+Hb.$_TID]},Hb.callLater=function(Ha,Hb,Hc){if(null==this._getHandler(Ha,Hb)){var Hd=Hj.create();Hd.caller=Ha,Hd.method=Hb,Hd.args=Hc,this._indexHandler(Hd),this._laters.push(Hd)}},Hb.runCallLater=function(Ha,Hb){var Hc=this._getHandler(Ha,Hb);Hc&&null!=Hc.method&&(this._isIgnoreRecover(Hc)||(delete this._map[Hc.key],Hc.run(!0)))},Hb.runTimer=function(Ha,Hb){this.runCallLater(Ha,Hb)},Hk(0,Hb,"delta",function(){return this._delta}),Ha.__init$=function(){Hj=function(){function Hb(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}Hp(Hb,"");var Ha=Hb.prototype;return Ha.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},Ha.recover=function(){this.clear(),this.args=Hb._freeHandler,Hb._freeHandler=this,Hb._freeCount++},Ha.run=function(Ha){var Hb=this.caller;if(Hb&&Hb.destroyed)return this.clear();var Hc=this.method,Hd=this.args;Ha&&this.clear(),null!=Hc&&(Hd?Hc.apply(Hb,Hd):Hc.call(Hb))},Hb._freeHandler=null,Hb._freeCount=0,Hb.create=function(){var Ha=Hb._freeHandler;return Ha?(Hb._freeHandler=Ha.args,--Hb._freeCount,Ha.args=null,Ha):new Hb},Hb}()},Ha}()),HX=function(){function Hl(){this.gid=0}Hp(Hl,"laya.utils.Tween");var Ha=Hl.prototype;return Ha.to=function(Ha,Hb,Hc,Hd,He,Hf,Hg){return void 0===Hf&&(Hf=0),void 0===Hg&&(Hg=!1),this._create(Ha,Hb,Hc,Hd,He,Hf,Hg,!0,!1,!0)},Ha.from=function(Ha,Hb,Hc,Hd,He,Hf,Hg){return void 0===Hf&&(Hf=0),void 0===Hg&&(Hg=!1),this._create(Ha,Hb,Hc,Hd,He,Hf,Hg,!1,!1,!0)},Ha._create=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){if(!Ha)throw new Error("Tween:target is null");this._target=Ha,this._duration=Hc,this._ease=Hd||Hb.ease||Hl.easeNone,this._complete=He||Hb.complete,this._delay=Hf,this._props=[],this._usedTimer=0,this._startTimer=HM.now(),this._usedPool=Hi,this._delayParam=null,this.update=Hb.update;var Hk=Ha.$_GID||(Ha.$_GID=HY.getGID());return Hl.tweenMap[Hk]?(Hg&&Hl.clearTween(Ha),Hl.tweenMap[Hk].push(this)):Hl.tweenMap[Hk]=[this],Hj?Hf<=0?this.firstStart(Ha,Hb,Hh):(this._delayParam=[Ha,Hb,Hh],Hx.scaleTimer.once(Hf,this,this.firstStart,this._delayParam)):this._initProps(Ha,Hb,Hh),this},Ha.firstStart=function(Ha,Hb,Hc){this._delayParam=null,Ha.destroyed?this.clear():(this._initProps(Ha,Hb,Hc),this._beginLoop())},Ha._initProps=function(Ha,Hb,Hc){for(var Hd in Hb)if("number"==typeof Ha[Hd]){var He=Hc?Ha[Hd]:Hb[Hd],Hf=Hc?Hb[Hd]:Ha[Hd];this._props.push([Hd,He,Hf-He]),Hc||(Ha[Hd]=He)}},Ha._beginLoop=function(){Hx.scaleTimer.frameLoop(1,this,this._doEase)},Ha._doEase=function(){this._updateEase(HM.now())},Ha._updateEase=function(Ha){var Hb=this._target;if(Hb){if(Hb.destroyed)return Hl.clearTween(Hb);var Hc=this._usedTimer=Ha-this._startTimer-this._delay;if(!(Hc<0)){if(Hc>=this._duration)return this.complete();for(var Hd=0<Hc?this._ease(Hc,0,1,this._duration):0,He=this._props,Hf=0,Hg=He.length;Hf<Hg;Hf++){var Hh=He[Hf];Hb[Hh[0]]=Hh[1]+Hd*Hh[2]}this.update&&this.update.run()}}},Ha.complete=function(){if(this._target){Hx.scaleTimer.runTimer(this,this.firstStart);for(var Ha=this._target,Hb=this._props,Hc=this._complete,Hd=0,He=Hb.length;Hd<He;Hd++){var Hf=Hb[Hd];Ha[Hf[0]]=Hf[1]+Hf[2]}this.update&&this.update.run(),this.clear(),Hc&&Hc.run()}},Ha.pause=function(){Hx.scaleTimer.clear(this,this._beginLoop),Hx.scaleTimer.clear(this,this._doEase),Hx.scaleTimer.clear(this,this.firstStart);var Ha;(Ha=HM.now()-this._startTimer-this._delay)<0&&(this._usedTimer=Ha)},Ha.setStartTime=function(Ha){this._startTimer=Ha},Ha.clear=function(){this._target&&(this._remove(),this._clear())},Ha._clear=function(){this.pause(),Hx.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,HU.recover("tween",this))},Ha.recover=function(){this._usedPool=!0,this._clear()},Ha._remove=function(){var Ha=Hl.tweenMap[this._target.$_GID];if(Ha)for(var Hb=0,Hc=Ha.length;Hb<Hc;Hb++)if(Ha[Hb]===this){Ha.splice(Hb,1);break}},Ha.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=HM.now(),this._delayParam)Hx.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var Ha=this._props,Hb=0,Hc=Ha.length;Hb<Hc;Hb++){var Hd=Ha[Hb];this._target[Hd[0]]=Hd[1]}Hx.scaleTimer.once(this._delay,this,this._beginLoop)}},Ha.resume=function(){this._usedTimer>=this._duration||(this._startTimer=HM.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?Hx.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},Hk(0,Ha,"progress",null,function(Ha){var Hb=Ha*this._duration;this._startTimer=HM.now()-this._delay-Hb}),Hl.to=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){return void 0===Hf&&(Hf=0),void 0===Hg&&(Hg=!1),void 0===Hh&&(Hh=!0),HU.getItemByClass("tween",Hl)._create(Ha,Hb,Hc,Hd,He,Hf,Hg,!0,Hh,!0)},Hl.from=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){return void 0===Hf&&(Hf=0),void 0===Hg&&(Hg=!1),void 0===Hh&&(Hh=!0),HU.getItemByClass("tween",Hl)._create(Ha,Hb,Hc,Hd,He,Hf,Hg,!1,Hh,!0)},Hl.clearAll=function(Ha){if(Ha&&Ha.$_GID){var Hb=Hl.tweenMap[Ha.$_GID];if(Hb){for(var Hc=0,Hd=Hb.length;Hc<Hd;Hc++)Hb[Hc]._clear();Hb.length=0}}},Hl.clear=function(Ha){Ha.clear()},Hl.clearTween=function(Ha){Hl.clearAll(Ha)},Hl.easeNone=function(Ha,Hb,Hc,Hd){return Hc*Ha/Hd+Hb},Hl.tweenMap={},Hl}(),HY=function(){function Hh(){}return Hp(Hh,"laya.utils.Utils"),Hh.toRadian=function(Ha){return Ha*Hh._pi2},Hh.toAngle=function(Ha){return Ha*Hh._pi},Hh.toHexColor=function(Ha){if(Ha<0||isNaN(Ha))return null;for(var Hb=Ha.toString(16);Hb.length<6;)Hb="0"+Hb;return"#"+Hb},Hh.getGID=function(){return Hh._gid++},Hh.concatArray=function(Ha,Hb){if(!Hb)return Ha;if(!Ha)return Hb;var Hc=0,Hd=Hb.length;for(Hc=0;Hc<Hd;Hc++)Ha.push(Hb[Hc]);return Ha},Hh.clearArray=function(Ha){return Ha&&(Ha.length=0),Ha},Hh.copyArray=function(Ha,Hb){if(Ha||(Ha=[]),!Hb)return Ha;Ha.length=Hb.length;var Hc=0,Hd=Hb.length;for(Hc=0;Hc<Hd;Hc++)Ha[Hc]=Hb[Hc];return Ha},Hh.getGlobalRecByPoints=function(Ha,Hb,Hc,Hd,He){var Hf,Hg;return Hf=new Hy(Hb,Hc),Hf=Ha.localToGlobal(Hf),Hg=new Hy(Hd,He),Hg=Ha.localToGlobal(Hg),Hz._getWrapRec([Hf.x,Hf.y,Hg.x,Hg.y])},Hh.getGlobalPosAndScale=function(Ha){return Hh.getGlobalRecByPoints(Ha,0,0,1,1)},Hh.bind=function(Ha,Hb){return Ha.bind(Hb)},Hh.measureText=function(Ha,Hb){return HD.measureText(Ha,Hb)},Hh.updateOrder=function(Ha){if(!Ha||Ha.length<2)return!1;for(var Hb,Hc=1,Hd=0,He=Ha.length,Hf=NaN;Hc<He;){for(Hb=Ha[Hd=Hc],Hf=Ha[Hd]._zOrder;-1<--Hd&&Ha[Hd]._zOrder>Hf;)Ha[Hd+1]=Ha[Hd];Ha[Hd+1]=Hb,Hc++}var Hg=Hb.parent.conchModel;if(Hg)if(null!=Hg.updateZOrder)Hg.updateZOrder();else{for(Hc=0;Hc<He;Hc++)Hg.removeChild(Ha[Hc].conchModel);for(Hc=0;Hc<He;Hc++)Hg.addChildAt(Ha[Hc].conchModel,Hc)}return!0},Hh.transPointList=function(Ha,Hb,Hc){var Hd=0,He=Ha.length;for(Hd=0;Hd<He;Hd+=2)Ha[Hd]+=Hb,Ha[Hd+1]+=Hc},Hh.parseInt=function(Ha,Hb){void 0===Hb&&(Hb=0);var Hc=HM.window.parseInt(Ha,Hb);return isNaN(Hc)?0:Hc},Hh.getFileExtension=function(Ha){Hh._extReg.lastIndex=Ha.lastIndexOf(".");var Hb=Hh._extReg.exec(Ha);return Hb&&1<Hb.length?Hb[1].toLowerCase():null},Hh.getTransformRelativeToWindow=function(Ha,Hb,Hc){var Hd=Hx.stage,He=laya.utils.Utils.getGlobalPosAndScale(Ha),Hf=Hd._canvasTransform.clone(),Hg=Hf.tx,Hh=Hf.ty;Hf.rotate(-Math.PI/180*Hx.stage.canvasDegree),Hf.scale(Hx.stage.clientScaleX,Hx.stage.clientScaleY);var Hi=Hx.stage.canvasDegree%180!=0,Hj=NaN,Hk=NaN;Hi?(Hj=Hc+He.y,Hk=Hb+He.x,Hj*=Hf.d,Hk*=Hf.a,90==Hx.stage.canvasDegree?(Hj=Hg-Hj,Hk+=Hh):(Hj+=Hg,Hk=Hh-Hk)):(Hj=Hb+He.x,Hk=Hc+He.y,Hj*=Hf.a,Hk*=Hf.d,Hj+=Hg,Hk+=Hh);var Hl=NaN,Hm=NaN;return Hm=Hi?(Hl=Hf.d*He.height,Hf.a*He.width):(Hl=Hf.a*He.width,Hf.d*He.height),{x:Hj,y:Hk,scaleX:Hl,scaleY:Hm}},Hh.fitDOMElementInArea=function(Ha,Hb,Hc,Hd,He,Hf){Ha._fitLayaAirInitialized||(Ha._fitLayaAirInitialized=!0,Ha.style.transformOrigin=Ha.style.webKittransformOrigin="left top",Ha.style.position="absolute");var Hg=Hh.getTransformRelativeToWindow(Hb,Hc,Hd);Ha.style.transform=Ha.style.webkitTransform="scale("+Hg.scaleX+","+Hg.scaleY+") rotate("+Hx.stage.canvasDegree+"deg)",Ha.style.width=He+"px",Ha.style.height=Hf+"px",Ha.style.left=Hg.x+"px",Ha.style.top=Hg.y+"px"},Hh.isOkTextureList=function(Ha){if(!Ha)return!1;var Hb,Hc=0,Hd=Ha.length;for(Hc=0;Hc<Hd;Hc++)if(!(Hb=Ha[Hc])||!Hb.source)return!1;return!0},Hh.isOKCmdList=function(Ha){if(!Ha)return!1;var Hb,Hc,Hd=0,He=Ha.length,Hf=HH._context;for(Hd=0;Hd<He;Hd++)switch((Hb=Ha[Hd]).callee){case Hf._drawTexture:case Hf._fillTexture:case Hf._drawTextureWithTransform:if(!(Hc=Hb[0])||!Hc.source)return!1}return!0},Hh._gid=1,Hh._pi=180/Math.PI,Hh._pi2=Math.PI/180,Hh._extReg=/\.(\w+)\??/g,Hh.parseXMLFromString=function(Ha){var Hb;if(Ha=Ha.replace(/>\s+</g,"><"),-1<(Hb=(new DOMParser).parseFromString(Ha,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(Hb.firstChild.firstChild.textContent);return Hb},Hh}(),HZ=function(){function Ha(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],HH.isWebGL&&HO.regCacheByFunction(HY.bind(this.startDispose,this),HY.bind(this.getCacheList,this))}Hp(Ha,"laya.utils.VectorGraphManager");var Hb=Ha.prototype;return Hb.getId=function(){return this._id++},Hb.addShape=function(Ha,Hb){this.shapeDic[Ha]=Hb,this.useDic[Ha]||(this.useDic[Ha]=!0)},Hb.addLine=function(Ha,Hb){this.shapeLineDic[Ha]=Hb,this.shapeLineDic[Ha]||(this.shapeLineDic[Ha]=!0)},Hb.getShape=function(Ha){this._checkKey&&null!=this.useDic[Ha]&&(this.useDic[Ha]=!0)},Hb.deleteShape=function(Ha){this.shapeDic[Ha]&&(this.shapeDic[Ha]=null,delete this.shapeDic[Ha]),this.shapeLineDic[Ha]&&(this.shapeLineDic[Ha]=null,delete this.shapeLineDic[Ha]),null!=this.useDic[Ha]&&delete this.useDic[Ha]},Hb.getCacheList=function(){var Ha,Hb=[];for(Ha in this.shapeDic)Hb.push(this.shapeDic[Ha]);for(Ha in this.shapeLineDic)Hb.push(this.shapeLineDic[Ha]);return Hb},Hb.startDispose=function(Ha){var Hb;for(Hb in this.useDic)this.useDic[Hb]=!1;this._checkKey=!0},Hb.endDispose=function(){if(this._checkKey){var Ha;for(Ha in this.useDic)this.useDic[Ha]||this.deleteShape(Ha);this._checkKey=!1}},Ha.getInstance=function(){return Ha.instance=Ha.instance||new Ha},Ha.instance=null,Ha}(),H$=function(){function Hd(){this._obj=null,this._obj=Hd.supportWeakMap?new HM.window.WeakMap:{},Hd.supportWeakMap||Hd._maps.push(this)}Hp(Hd,"laya.utils.WeakObject");var Ha=Hd.prototype;return Ha.set=function(Ha,Hb){if(null!=Ha)if(Hd.supportWeakMap){var Hc=Ha;"string"!=typeof Ha&&"number"!=typeof Ha||(Hc=Hd._keys[Ha])||(Hc=Hd._keys[Ha]={k:Ha}),this._obj.set(Hc,Hb)}else"string"==typeof Ha||"number"==typeof Ha?this._obj[Ha]=Hb:(Ha.$_GID||(Ha.$_GID=HY.getGID()),this._obj[Ha.$_GID]=Hb)},Ha.get=function(Ha){if(null==Ha)return null;if(Hd.supportWeakMap){var Hb="string"==typeof Ha||"number"==typeof Ha?Hd._keys[Ha]:Ha;return Hb?this._obj.get(Hb):null}return"string"==typeof Ha||"number"==typeof Ha?this._obj[Ha]:this._obj[Ha.$_GID]},Ha.del=function(Ha){if(null!=Ha)if(Hd.supportWeakMap){var Hb="string"==typeof Ha||"number"==typeof Ha?Hd._keys[Ha]:Ha;if(!Hb)return;this._obj.delete(Hb)}else"string"==typeof Ha||"number"==typeof Ha?delete this._obj[Ha]:delete this._obj[this._obj.$_GID]},Ha.has=function(Ha){if(null==Ha)return!1;if(Hd.supportWeakMap){var Hb="string"==typeof Ha||"number"==typeof Ha?Hd._keys[Ha]:Ha;return this._obj.has(Hb)}return"string"==typeof Ha||"number"==typeof Ha?null!=this._obj[Ha]:null!=this._obj[this._obj.$_GID]},Hd.__init__=function(){(Hd.supportWeakMap=null!=HM.window.WeakMap)||Hx.timer.loop(Hd.delInterval,null,Hd.clearCache)},Hd.clearCache=function(){for(var Ha=0,Hb=Hd._maps.length;Ha<Hb;Ha++){Hd._maps[Ha]._obj={}}},Hd.supportWeakMap=!1,Hd.delInterval=3e5,Hd._keys={},Hd._maps=[],Hi(Hd,["I",function(){return this.I=new Hd}]),Hd}(),H_=function(){function Ha(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}Hp(Ha,"laya.utils.WordText");var Hb=Ha.prototype;return Hb.setText=function(Ha){this.changed=!0,this._text=Ha},Hb.toString=function(){return this._text},Hb.charCodeAt=function(Ha){return this._text?this._text.charCodeAt(Ha):NaN},Hb.charAt=function(Ha){return this._text?this._text.charAt(Ha):null},Hk(0,Hb,"length",function(){return this._text?this._text.length:0}),Ha}(),Haa=function(Ha){function Hg(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,Hg.__super.call(this),this._childs=Hg.ARRAY_EMPTY,this._$P=Hg.PROP_EMPTY,this.timer=Hx.scaleTimer,this.conchModel=HH.isConchNode?this.createConchModel():null}Hp(Hg,"laya.display.Node",Hj);var Hb=Hg.prototype;return Hb._setBit=function(Ha,Hb){1==Ha&&(this._getBit(Ha)!=Hb&&this._updateDisplayedInstage());Hb?this._bits|=Ha:this._bits&=~Ha},Hb._getBit=function(Ha){return 0!=(this._bits&Ha)},Hb._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},Hb._setUpNoticeType=function(Ha){var Hb=this;for(Hb._setBit(Ha,!0),Hb=Hb.parent;Hb;){if(Hb._getBit(Ha))return;Hb._setBit(Ha,!0),Hb=Hb.parent}},Hb.on=function(Ha,Hb,Hc,Hd){return"display"!==Ha&&"undisplay"!==Ha||this._getBit(1)||this._setUpNoticeType(1),this._createListener(Ha,Hb,Hc,Hd,!1)},Hb.once=function(Ha,Hb,Hc,Hd){return"display"!==Ha&&"undisplay"!==Ha||this._getBit(1)||this._setUpNoticeType(1),this._createListener(Ha,Hb,Hc,Hd,!0)},Hb.createConchModel=function(){return null},Hb.destroy=function(Ha){void 0===Ha&&(Ha=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(Ha?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},Hb.destroyChildren=function(){if(this._childs)for(var Ha=this._childs.length-1;-1<Ha;Ha--)this._childs[Ha].destroy(!0)},Hb.addChild=function(Ha){if(!Ha||this.destroyed||Ha===this)return Ha;if(Ha.zOrder&&this._set$P("hasZorder",!0),Ha._parent===this){var Hb=this.getChildIndex(Ha);Hb!==this._childs.length-1&&(this._childs.splice(Hb,1),this._childs.push(Ha),this.conchModel&&(this.conchModel.removeChild(Ha.conchModel),this.conchModel.addChildAt(Ha.conchModel,this._childs.length-1)),this._childChanged())}else Ha.parent&&Ha.parent.removeChild(Ha),this._childs===Hg.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Ha),this.conchModel&&this.conchModel.addChildAt(Ha.conchModel,this._childs.length-1),(Ha.parent=this)._childChanged();return Ha},Hb.addChildren=function(Ha){for(var Hb=arguments,Hc=0,Hd=Hb.length;Hc<Hd;)this.addChild(Hb[Hc++])},Hb.addChildAt=function(Ha,Hb){if(!Ha||this.destroyed||Ha===this)return Ha;if(Ha.zOrder&&this._set$P("hasZorder",!0),0<=Hb&&Hb<=this._childs.length){if(Ha._parent===this){var Hc=this.getChildIndex(Ha);this._childs.splice(Hc,1),this._childs.splice(Hb,0,Ha),this.conchModel&&(this.conchModel.removeChild(Ha.conchModel),this.conchModel.addChildAt(Ha.conchModel,Hb)),this._childChanged()}else Ha.parent&&Ha.parent.removeChild(Ha),this._childs===Hg.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Hb,0,Ha),this.conchModel&&this.conchModel.addChildAt(Ha.conchModel,Hb),Ha.parent=this;return Ha}throw new Error("appendChildAt:The index is out of bounds")},Hb.getChildIndex=function(Ha){return this._childs.indexOf(Ha)},Hb.getChildByName=function(Ha){var Hb=this._childs;if(Hb)for(var Hc=0,Hd=Hb.length;Hc<Hd;Hc++){var He=Hb[Hc];if(He.name===Ha)return He}return null},Hb._get$P=function(Ha){return this._$P[Ha]},Hb._set$P=function(Ha,Hb){return this.destroyed||(this._$P===Hg.PROP_EMPTY&&(this._$P={}),this._$P[Ha]=Hb),Hb},Hb.getChildAt=function(Ha){return this._childs[Ha]},Hb.setChildIndex=function(Ha,Hb){var Hc=this._childs;if(Hb<0||Hb>=Hc.length)throw new Error("setChildIndex:The index is out of bounds.");var Hd=this.getChildIndex(Ha);if(Hd<0)throw new Error("setChildIndex:node is must child of this object.");return Hc.splice(Hd,1),Hc.splice(Hb,0,Ha),this.conchModel&&(this.conchModel.removeChild(Ha.conchModel),this.conchModel.addChildAt(Ha.conchModel,Hb)),this._childChanged(),Ha},Hb._childChanged=function(Ha){},Hb.removeChild=function(Ha){if(!this._childs)return Ha;var Hb=this._childs.indexOf(Ha);return this.removeChildAt(Hb)},Hb.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},Hb.removeChildByName=function(Ha){var Hb=this.getChildByName(Ha);return Hb&&this.removeChild(Hb),Hb},Hb.removeChildAt=function(Ha){var Hb=this.getChildAt(Ha);if(Hb){for(var Hc=this._childs.length-1,Hd=Ha;Hd<Hc;++Hd)this._childs[Hd]=this._childs[Hd+1];this._childs.length=Hc,this.conchModel&&this.conchModel.removeChild(Hb.conchModel),Hb.parent=null}return Hb},Hb.removeChildren=function(Ha,Hb){if(void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=2147483647),this._childs&&0<this._childs.length){var Hc=this._childs;if(0===Ha&&Hf<=Hb){var Hd=Hc;this._childs=Hg.ARRAY_EMPTY}else Hd=Hc.splice(Ha,Hb-Ha);for(var He=0,Hf=Hd.length;He<Hf;He++)Hd[He].parent=null,this.conchModel&&this.conchModel.removeChild(Hd[He].conchModel)}return this},Hb.replaceChild=function(Ha,Hb){var Hc=this._childs.indexOf(Hb);return-1<Hc?(this._childs.splice(Hc,1,Ha),this.conchModel&&(this.conchModel.removeChild(Hb.conchModel),this.conchModel.addChildAt(Ha.conchModel,Hc)),Hb.parent=null,Ha.parent=this,Ha):null},Hb._updateDisplayedInstage=function(){var Ha;Ha=this;var Hb=Hx.stage;for(this._displayedInStage=!1;Ha;){if(Ha._getBit(1)){this._displayedInStage=Ha._displayedInStage;break}if(Ha==Hb||Ha._displayedInStage){this._displayedInStage=!0;break}Ha=Ha.parent}},Hb._setDisplay=function(Ha){this._displayedInStage!==Ha&&((this._displayedInStage=Ha)?this.event("display"):this.event("undisplay"))},Hb._displayChild=function(Ha,Hb){var Hc=Ha._childs;if(Hc)for(var Hd=0;Hd<Hc.length;Hd++){var He=Hc[Hd];He&&He._getBit(1)&&(0<He._childs.length?this._displayChild(He,Hb):He._setDisplay(Hb))}Ha._setDisplay(Hb)},Hb.contains=function(Ha){if(Ha===this)return!0;for(;Ha;){if(Ha.parent===this)return!0;Ha=Ha.parent}return!1},Hb.timerLoop=function(Ha,Hb,Hc,Hd,He,Hf){void 0===He&&(He=!0),void 0===Hf&&(Hf=!1),this.timer.loop(Ha,Hb,Hc,Hd,He,Hf)},Hb.timerOnce=function(Ha,Hb,Hc,Hd,He){void 0===He&&(He=!0),this.timer._create(!1,!1,Ha,Hb,Hc,Hd,He)},Hb.frameLoop=function(Ha,Hb,Hc,Hd,He){void 0===He&&(He=!0),this.timer._create(!0,!0,Ha,Hb,Hc,Hd,He)},Hb.frameOnce=function(Ha,Hb,Hc,Hd,He){void 0===He&&(He=!0),this.timer._create(!0,!1,Ha,Hb,Hc,Hd,He)},Hb.clearTimer=function(Ha,Hb){this.timer.clear(Ha,Hb)},Hk(0,Hb,"numChildren",function(){return this._childs.length}),Hk(0,Hb,"destroyed",function(){return this._destroyed}),Hk(0,Hb,"parent",function(){return this._parent},function(Ha){this._parent!==Ha&&(Ha?(this._parent=Ha,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),Ha.displayedInStage&&this._displayChild(this,!0)),Ha._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=Ha))}),Hk(0,Hb,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),Hg.ARRAY_EMPTY=[],Hg.PROP_EMPTY={},Hg.NOTICE_DISPLAY=1,Hg.MOUSEENABLE=2,Hg}(),Hba=function(Ha){function Hm(Ha){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,Hm.__super.call(this),this._padding=Hm._PADDING,this._spacing=Hm._SPACING,this._aligns=Hm._ALIGNS,this._font=Hn.EMPTY,this._ower=Ha}Hp(Hm,"laya.display.css.CSSStyle",Ha);var Hb=Hm.prototype;return Hb.destroy=function(){this._ower=null,this._font=null,this._rect=null},Hb.inherit=function(Ha){this._font=Ha._font,this._spacing=Ha._spacing===Hm._SPACING?Hm._SPACING:Ha._spacing.slice(),this.lineHeight=Ha.lineHeight},Hb._widthAuto=function(){return 0!=(262144&this._type)},Hb.widthed=function(Ha){return 0!=(8&this._type)},Hb._calculation=function(Ha,Hb){if(Hb.indexOf("%")<0)return!1;var Hd=this._ower,He=Hd.parent,Hf=this._rect;function Hg(Ha,Hb,Hc){return Ha*Hc[0]+Hb*Hc[1]+Hc[2]}function Hc(Ha){var Hb=He.width,Hc=Hd.width;Hf.width&&(Hd.width=Hg(Hb,Hc,Hf.width)),Hf.height&&(Hd.height=Hg(Hb,Hc,Hf.height)),Hf.left&&(Hd.x=Hg(Hb,Hc,Hf.left)),Hf.top&&(Hd.y=Hg(Hb,Hc,Hf.top))}null===Hf&&(He._getCSSStyle()._type|=524288,He.on("resize",this,Hc),this._rect=Hf={input:{}});var Hh=Hb.split(" ");return Hh[0]=parseFloat(Hh[0])/100,1==Hh.length?Hh[1]=Hh[2]=0:(Hh[1]=parseFloat(Hh[1])/100,Hh[2]=parseFloat(Hh[2])),Hf[Ha]=Hh,Hf.input[Ha]=Hb,Hc(),!0},Hb.heighted=function(Ha){return 0!=(8192&this._type)},Hb.size=function(Ha,Hb){var Hc=this._ower,Hd=!1;-1!==Ha&&Ha!=this._ower.width&&(this._type|=8,this._ower.width=Ha,Hd=!0),-1!==Hb&&Hb!=this._ower.height&&(this._type|=8192,this._ower.height=Hb,Hd=!0),Hd&&(Hc._layoutLater(),524288&this._type&&Hc.event("resize",this))},Hb._getAlign=function(){return this._aligns[0]},Hb._getValign=function(){return this._aligns[1]},Hb._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},Hb._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new Hn(this._font))},Hb.render=function(Ha,Hb,Hc,Hd){var He=Ha.width,Hf=Ha.height;Hc-=Ha.pivotX,Hd-=Ha.pivotY,this._bgground&&null!=this._bgground.color&&Hb.ctx.fillRect(Hc,Hd,He,Hf,this._bgground.color),this._border&&this._border.color&&Hb.drawRect(Hc,Hd,He,Hf,this._border.color.strColor,this._border.size)},Hb.getCSSStyle=function(){return this},Hb.cssText=function(Ha){this.attrs(Hm.parseOneCSS(Ha,";"))},Hb.attrs=function(Ha){if(Ha)for(var Hb=0,Hc=Ha.length;Hb<Hc;Hb++){var Hd=Ha[Hb];this[Hd[0]]=Hd[1]}},Hb.setTransform=function(Ha){"none"===Ha?this._tf=Hh._TF_EMPTY:this.attrs(Hm.parseOneCSS(Ha,","))},Hb.translate=function(Ha,Hb){this._tf===Hh._TF_EMPTY&&(this._tf=new He),this._tf.translateX=Ha,this._tf.translateY=Hb},Hb.scale=function(Ha,Hb){this._tf===Hh._TF_EMPTY&&(this._tf=new He),this._tf.scaleX=Ha,this._tf.scaleY=Hb},Hb._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},Hk(0,Hb,"block",Ha.prototype._$get_block,function(Ha){Ha?this._type|=1:this._type&=-2}),Hk(0,Hb,"valign",function(){return Hm._valigndef[this._aligns[1]]},function(Ha){this._aligns===Hm._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=Hm._valigndef[Ha]}),Hk(0,Hb,"height",null,function(Ha){if(this._type|=8192,"string"==typeof Ha){if(this._calculation("height",Ha))return;Ha=parseInt(Ha)}this.size(-1,Ha)}),Hk(0,Hb,"width",null,function(Ha){if(this._type|=8,"string"==typeof Ha){var Hb=Ha.indexOf("auto");if(0<=Hb&&(this._type|=262144,Ha=Ha.substr(0,Hb)),this._calculation("width",Ha))return;Ha=parseInt(Ha)}this.size(Ha,-1)}),Hk(0,Hb,"fontWeight",function(){return this._font.weight},function(Ha){this._createFont().weight=Ha}),Hk(0,Hb,"left",null,function(Ha){var Hb=this._ower;if("string"==typeof Ha){if("center"===Ha?Ha="50% -50% 0":"right"===Ha&&(Ha="100% -100% 0"),this._calculation("left",Ha))return;Ha=parseInt(Ha)}Hb.x=Ha}),Hk(0,Hb,"_translate",null,function(Ha){this.translate(Ha[0],Ha[1])}),Hk(0,Hb,"absolute",function(){return 0!=(4&this._type)}),Hk(0,Hb,"top",null,function(Ha){var Hb=this._ower;if("string"==typeof Ha){if("middle"===Ha?Ha="50% -50% 0":"bottom"===Ha&&(Ha="100% -100% 0"),this._calculation("top",Ha))return;Ha=parseInt(Ha)}Hb.y=Ha}),Hk(0,Hb,"align",function(){return Hm._aligndef[this._aligns[0]]},function(Ha){this._aligns===Hm._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=Hm._aligndef[Ha]}),Hk(0,Hb,"bold",function(){return this._font.bold},function(Ha){this._createFont().bold=Ha}),Hk(0,Hb,"padding",function(){return this._padding},function(Ha){this._padding=Ha}),Hk(0,Hb,"leading",function(){return this._spacing[1]},function(Ha){"string"==typeof Ha&&(Ha=parseInt(Ha+"")),this._spacing===Hm._SPACING&&(this._spacing=[0,0]),this._spacing[1]=Ha}),Hk(0,Hb,"lineElement",function(){return 0!=(65536&this._type)},function(Ha){Ha?this._type|=65536:this._type&=-65537}),Hk(0,Hb,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(Ha){this.lineElement=!1,"right"===Ha?this._type|=32768:this._type&=-32769}),Hk(0,Hb,"textDecoration",function(){return this._font.decoration},function(Ha){this._createFont().decoration=Ha}),Hk(0,Hb,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(Ha){"nowrap"===Ha&&(this._type|=131072),"none"===Ha&&(this._type&=-131073)}),Hk(0,Hb,"background",null,function(Ha){Ha?(this._bgground||(this._bgground={}),this._bgground.color=Ha,this._ower.conchModel&&this._ower.conchModel.bgColor(Ha),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),Hk(0,Hb,"wordWrap",function(){return 0==(131072&this._type)},function(Ha){Ha?this._type&=-131073:this._type|=131072}),Hk(0,Hb,"color",function(){return this._font.color},function(Ha){this._createFont().color=Ha}),Hk(0,Hb,"password",function(){return this._font.password},function(Ha){this._createFont().password=Ha}),Hk(0,Hb,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(Ha){"none"===Ha?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=Ha),this._ower.conchModel&&this._ower.conchModel.bgColor(Ha),this._ower._renderType|=256}),Hk(0,Hb,"font",function(){return this._font.toString()},function(Ha){this._createFont().set(Ha)}),Hk(0,Hb,"weight",null,function(Ha){this._createFont().weight=Ha}),Hk(0,Hb,"letterSpacing",function(){return this._spacing[0]},function(Ha){"string"==typeof Ha&&(Ha=parseInt(Ha+"")),this._spacing===Hm._SPACING&&(this._spacing=[0,0]),this._spacing[0]=Ha}),Hk(0,Hb,"fontSize",function(){return this._font.size},function(Ha){this._createFont().size=Ha}),Hk(0,Hb,"italic",function(){return this._font.italic},function(Ha){this._createFont().italic=Ha}),Hk(0,Hb,"fontFamily",function(){return this._font.family},function(Ha){this._createFont().family=Ha}),Hk(0,Hb,"stroke",function(){return this._font.stroke[0]},function(Ha){this._createFont().stroke===Hn._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=Ha}),Hk(0,Hb,"strokeColor",function(){return this._font.stroke[1]},function(Ha){this._createFont().stroke===Hn._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=Ha}),Hk(0,Hb,"border",function(){return this._border?this._border.value:""},function(Ha){if("none"!=Ha){this._border||(this._border={});var Hb=(this._border.value=Ha).split(" ");if(this._border.color=HQ.create(Hb[Hb.length-1]),1==Hb.length)return this._border.size=1,void(this._border.type="solid");var Hc=0;0<Hb[0].indexOf("px")?(this._border.size=parseInt(Hb[0]),Hc++):this._border.size=1,this._border.type=Hb[Hc],this._ower._renderType|=256}else this._border=null}),Hk(0,Hb,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(Ha){Ha?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==Ha?null:HQ.create(Ha),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),Hk(0,Hb,"position",function(){return 4&this._type?"absolute":""},function(Ha){"absolute"==Ha?this._type|=4:this._type&=-5}),Hk(0,Hb,"display",null,function(Ha){switch(Ha){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),Hk(0,Hb,"paddingLeft",function(){return this.padding[3]}),Hk(0,Hb,"paddingTop",function(){return this.padding[0]}),Hk(0,Hb,"_scale",null,function(Ha){this._ower.scale(Ha[0],Ha[1])}),Hk(0,Hb,"_rotate",null,function(Ha){this._ower.rotation=Ha}),Hm.parseOneCSS=function(Ha,Hb){for(var Hc,Hd=[],He=Ha.split(Hb),Hf=0,Hg=He.length;Hf<Hg;Hf++){var Hh=He[Hf],Hi=Hh.indexOf(":"),Hj=Hh.substr(0,Hi).replace(/^\s+|\s+$/g,"");if(0!=Hj.length){var Hk=Hh.substr(Hi+1).replace(/^\s+|\s+$/g,""),Hl=[Hj,Hk];switch(Hj){case"italic":case"bold":Hl[1]="true"==Hk;break;case"line-height":Hl[0]="lineHeight",Hl[1]=parseInt(Hk);break;case"font-size":Hl[0]="fontSize",Hl[1]=parseInt(Hk);break;case"padding":1<(Hc=Hk.split(" ")).length||(Hc[1]=Hc[2]=Hc[3]=Hc[0]),Hl[1]=[parseInt(Hc[0]),parseInt(Hc[1]),parseInt(Hc[2]),parseInt(Hc[3])];break;case"rotate":Hl[0]="_rotate",Hl[1]=parseFloat(Hk);break;case"scale":Hc=Hk.split(" "),Hl[0]="_scale",Hl[1]=[parseFloat(Hc[0]),parseFloat(Hc[1])];break;case"translate":Hc=Hk.split(" "),Hl[0]="_translate",Hl[1]=[parseInt(Hc[0]),parseInt(Hc[1])];break;default:(Hl[0]=Hm._CSSTOVALUE[Hj])||(Hl[0]=Hj)}Hd.push(Hl)}}return Hd},Hm.parseCSS=function(Ha,Hb){for(var Hc;null!=(Hc=Hm._parseCSSRegExp.exec(Ha));)Hm.styleSheets[Hc[1]]=Hm.parseOneCSS(Hc[2],";")},Hm.EMPTY=new Hm(null),Hm._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},Hm._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),Hm._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},Hm._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},Hm.styleSheets={},Hm.ALIGN_CENTER=1,Hm.ALIGN_RIGHT=2,Hm.VALIGN_MIDDLE=1,Hm.VALIGN_BOTTOM=2,Hm._CSS_BLOCK=1,Hm._DISPLAY_NONE=2,Hm._ABSOLUTE=4,Hm._WIDTH_SET=8,Hm._PADDING=[0,0,0,0],Hm._RECT=[-1,-1,-1,-1],Hm._SPACING=[0,0],Hm._ALIGNS=[0,0,0],Hm.ADDLAYOUTED=512,Hm._NEWFONT=4096,Hm._HEIGHT_SET=8192,Hm._BACKGROUND_SET=16384,Hm._FLOAT_RIGHT=32768,Hm._LINE_ELEMENT=65536,Hm._NOWARP=131072,Hm._WIDTHAUTO=262144,Hm._LISTERRESZIE=524288,Hm}(Hh),Hca=function(Ha){function Hg(){this.url=null,this.audio=null,this.loaded=!1,Hg.__super.call(this)}Hp(Hg,"laya.media.h5audio.AudioSound",Hj);var Hb=Hg.prototype;return Hb.dispose=function(){var Ha=Hg._audioCache[this.url];Ha&&(Ha.src="",delete Hg._audioCache[this.url])},Hb.load=function(Ha){var Hb;if(Ha=HG.formatURL(Ha),(this.url=Ha)==HC._tMusic?(Hg._initMusicAudio(),(Hb=Hg._musicAudio).src!=Ha&&(Hg._audioCache[Hb.src]=null,Hb=null)):Hb=Hg._audioCache[Ha],Hb&&2<=Hb.readyState)this.event("complete");else{Hb||(Hb=Ha==HC._tMusic?(Hg._initMusicAudio(),Hg._musicAudio):HM.createElement("audio"),(Hg._audioCache[Ha]=Hb).src=Ha),Hb.addEventListener("canplaythrough",Hd),Hb.addEventListener("error",He);var Hc=this;(this.audio=Hb).load?Hb.load():He()}function Hd(){Hf(),Hc.loaded=!0,Hc.event("complete")}function He(){Hb.load=null,Hf(),Hc.event("error")}function Hf(){Hb.removeEventListener("canplaythrough",Hd),Hb.removeEventListener("error",He)}},Hb.play=function(Ha,Hb,Hc){if(void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),!this.url)return null;var Hd,He;if(!(Hd=this.url==HC._tMusic?Hg._musicAudio:Hg._audioCache[this.url]))return null;He=HU.getItem("audio:"+this.url),HH.isConchApp?He||((He=HM.createElement("audio")).src=this.url):this.url==HC._tMusic?(Hg._initMusicAudio(),(He=Hg._musicAudio).src=this.url):He=He||Hd.cloneNode(!0);var Hf=new Hma(He);return Hf.url=this.url,Hf.loops=Hb,Hf.startTime=Ha,Hf.startHandler=Hc,Hf.play(!1),HC.addChannel(Hf),Hf},Hk(0,Hb,"duration",function(){var Ha;return(Ha=Hg._audioCache[this.url])?Ha.duration:0}),Hg._initMusicAudio=function(){Hg._musicAudio||(Hg._musicAudio||(Hg._musicAudio=HM.createElement("audio")),HH.isConchApp||HM.document.addEventListener("mousedown",Hg._makeMusicOK))},Hg._makeMusicOK=function(){HM.document.removeEventListener("mousedown",Hg._makeMusicOK),Hg._musicAudio.src?Hg._musicAudio.play():(Hg._musicAudio.src="",Hg._musicAudio.load())},Hg._audioCache={},Hg._musicAudio=null,Hg}(),Hda=function(Ha){function Hb(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,Hb.__super.call(this)}Hp(Hb,"laya.media.SoundChannel",Hj);var Hc=Hb.prototype;return Hc.play=function(){},Hc.stop=function(){},Hc.pause=function(){},Hc.resume=function(){},Hc.__runComplete=function(Ha){Ha&&Ha.run()},Hk(0,Hc,"volume",function(){return 1},function(Ha){}),Hk(0,Hc,"position",function(){return 0}),Hk(0,Hc,"duration",function(){return 0}),Hb}(),Hea=function(Ha){function Hb(){Hb.__super.call(this)}Hp(Hb,"laya.media.Sound",Hj);var Hc=Hb.prototype;return Hc.load=function(Ha){},Hc.play=function(Ha,Hb,Hc){return void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),null},Hc.dispose=function(){},Hk(0,Hc,"duration",function(){return 0}),Hb}(),Hfa=function(Ha){function He(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,He.__super.call(this)}Hp(He,"laya.media.webaudio.WebAudioSound",Hj);var Hb=He.prototype;return Hb.load=function(Ha){this.url=Ha,this.audioBuffer=He._dataCache[Ha],this.audioBuffer?this._loaded(this.audioBuffer):(He.e.on("loaded:"+Ha,this,this._loaded),He.e.on("err:"+Ha,this,this._err),He.__loadingSound[Ha]||(He.__loadingSound[Ha]=!0,Hx.loader.load(Ha,Hs.create(this,this.onloaded),null,Hha.BUFFER,4,!1,null,!0)))},Hb.onloaded=function(Ha){Ha||this._err(),this._disposed?this._removeLoadEvents():(this.data=Ha,He.buffs.push({buffer:this.data,url:this.url}),He.decode())},Hb._err=function(){if(this._removeLoadEvents(),He.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var Ha,Hb,Hc,Hd=0;for(Ha=(Hb=this.__toPlays).length,Hd=0;Hd<Ha;Hd++)(Hc=Hb[Hd])[3]&&!Hc[3].isStopped&&Hc[3].event("error");this.__toPlays.length=0}},Hb._loaded=function(Ha){this._removeLoadEvents(),this._disposed||(this.audioBuffer=Ha,this.loaded=!0,this.event("complete"))},Hb._removeLoadEvents=function(){He.e.off("loaded:"+this.url,this,this._loaded),He.e.off("err:"+this.url,this,this._err)},Hb.__playAfterLoaded=function(){if(this.__toPlays){var Ha,Hb,Hc,Hd=0;for(Ha=(Hb=this.__toPlays).length,Hd=0;Hd<Ha;Hd++)(Hc=Hb[Hd])[3]&&!Hc[3].isStopped&&this.play(Hc[0],Hc[1],Hc[2],Hc[3]);this.__toPlays.length=0}},Hb.play=function(Ha,Hb,Hc,Hd){return void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),Hd=Hd||new Hna,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([Ha,Hb,Hc,Hd]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),Hd.url=this.url,Hd.loops=Hb,Hd.audioBuffer=this.audioBuffer,Hd.startTime=Ha,Hd.startHandler=Hc,Hd.play(!1),HC.addChannel(Hd),Hd},Hb.dispose=function(){this._disposed=!0,delete He._dataCache[this.url],delete He.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},Hk(0,Hb,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),He.decode=function(){if(!(He.buffs.length<=0||He.isDecoding))if(He.isDecoding=!0,(He.tInfo=He.buffs.shift())&&He.tInfo.buffer&&He.tInfo.buffer.byteLength)try{He.ctx.decodeAudioData(He.tInfo.buffer,He._done,He._fail)}catch(Ha){console.error("decodeAudioData error  byteLength:"+He.tInfo.buffer.byteLength+"  url:"+He.tInfo.url)}else He._fail()},He._done=function(Ha){He.e.event("loaded:"+He.tInfo.url,Ha),He._dataCache[He.tInfo.url]=Ha,He.isDecoding=!1,He.decode()},He._fail=function(){He.e.event("err:"+He.tInfo.url,null),He.isDecoding=!1,He.decode()},He._playEmptySound=function(){if(null!=He.ctx){if(He._emptySource&&(He._emptySource.stop(),He._emptySource.disconnect(0),!Hna._tryCleanFailed))try{He._emptySource.buffer=null}catch(Ha){Hna._tryCleanFailed=!0}var Ha=He.ctx.createBufferSource();Ha.buffer=He._miniBuffer,Ha.connect(He.ctx.destination),Ha.start(0,0,0),He._emptySource=Ha}},He._unlock=function(){He._unlocked||(He._playEmptySound(),"running"==He.ctx.state?(HM.document.removeEventListener("mousedown",He._unlock,!0),HM.document.removeEventListener("touchend",He._unlock,!0),HM.document.removeEventListener("touchstart",He._unlock,!0),He._unlocked=!0):"suspended"==He.ctx.state&&HC._recoverWebAudio())},He.initWebAudio=function(){"running"!=He.ctx.state&&(He._unlock(),HM.document.addEventListener("mousedown",He._unlock,!0),HM.document.addEventListener("touchend",He._unlock,!0),HM.document.addEventListener("touchstart",He._unlock,!0))},He._emptySource=null,He._dataCache={},He.buffs=[],He.isDecoding=!1,He._unlocked=!1,He.tInfo=null,He.__loadingSound={},Hi(He,["window",function(){return this.window=HM.window},"webAudioEnabled",function(){return this.webAudioEnabled=He.window.AudioContext||He.window.webkitAudioContext||He.window.mozAudioContext},"ctx",function(){return this.ctx=He.webAudioEnabled?new(He.window.AudioContext||He.window.webkitAudioContext||He.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=He.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new Hj}]),He}(),Hga=function(Ha){function Hb(){this._responseType=null,this._data=null,Hb.__super.call(this),this._http=new HM.window.XMLHttpRequest}Hp(Hb,"laya.net.HttpRequest",Hj);var Hc=Hb.prototype;return Hc.send=function(Ha,Hb,Hc,Hd,He){void 0===Hc&&(Hc="get"),void 0===Hd&&(Hd="text"),this._responseType=Hd,this._data=null;var Hf=this,Hg=this._http;if(Hg.open(Hc,Ha,!0),He)for(var Hh=0;Hh<He.length;Hh++)Hg.setRequestHeader(He[Hh++],He[Hh]);else HH.isConchApp||(Hb&&"string"!=typeof Hb?Hg.setRequestHeader("Content-Type","application/json"):Hg.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));Hg.responseType="arraybuffer"!==Hd?"text":"arraybuffer",Hg.onerror=function(Ha){Hf._onError(Ha)},Hg.onabort=function(Ha){Hf._onAbort(Ha)},Hg.onprogress=function(Ha){Hf._onProgress(Ha)},Hg.onload=function(Ha){Hf._onLoad(Ha)},Hg.send(Hb)},Hc._onProgress=function(Ha){Ha&&Ha.lengthComputable&&this.event("progress",Ha.loaded/Ha.total)},Hc._onAbort=function(Ha){this.error("Request was aborted by user")},Hc._onError=function(Ha){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},Hc._onLoad=function(Ha){var Hb=this._http,Hc=void 0!==Hb.status?Hb.status:200;200===Hc||204===Hc||0===Hc?this.complete():this.error("["+Hb.status+"]"+Hb.statusText+":"+Hb.responseURL)},Hc.error=function(Ha){this.clear(),this.event("error",Ha)},Hc.complete=function(){this.clear();var Hb=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=HY.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(Ha){Hb=!1,this.error(Ha.message)}Hb&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},Hc.clear=function(){var Ha=this._http;Ha.onerror=Ha.onabort=Ha.onprogress=Ha.onload=null},Hk(0,Hc,"url",function(){return this._http.responseURL}),Hk(0,Hc,"http",function(){return this._http}),Hk(0,Hc,"data",function(){return this._data}),Hb}(),Hha=function(Ha){function HA(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,HA.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}Hp(HA,"laya.net.Loader",Hj);var Hb=HA.prototype;return Hb.load=function(Ha,Hb,Hc,Hd,He){if(Ha&&""!=Ha||console.error("Loader 加载的url不合法 "+Ha),void 0===Hc&&(Hc=!0),void 0===He&&(He=!1),0===(this._url=Ha).indexOf("data:image")?this._type=Hb="image":this._type=Hb||(Hb=this.getTypeFromUrl(Ha)),this._cache=Hc,this._data=null,!He&&HA.loadedMap[Ha])return this._data=HA.loadedMap[Ha],this.event("progress",1),void this.event("complete",this._data);if(Hd&&HA.setGroup(Ha,Hd),null!=HA.parserMap[Hb])return this._customParse=!0,void(HA.parserMap[Hb]instanceof laya.utils.Handler?HA.parserMap[Hb].runWith(this):HA.parserMap[Hb].call(null,this));if("image"===Hb||"htmlimage"===Hb||"nativeimage"===Hb)return this._loadImage(Ha);if("ttf"===Hb)return this._loadTTF(Ha);switch(Hb){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:Hb}HA.preLoadedMap[Ha]?this.onLoaded(HA.preLoadedMap[Ha]):Hg.resMgrLoad(Ha,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},Hb.getTypeFromUrl=function(Ha){var Hb=HY.getFileExtension(Ha);return Hb?HA.typeMap[Hb]:(console.warn("Not recognize the resources suffix",Ha),"text")},Hb._loadTTF=function(Ha){Ha=HG.formatURL(Ha);var Hb=new HF;Hb.complete=Hs.create(this,this.onLoaded),Hb.load(Ha)},Hb._loadImage=function(Ha){Hg.imgMgrLoad(Ha,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},Hb._loadImageComplete=function(Ha,Hb,Hc){if(null!=Hc)if(Hc instanceof ArrayBuffer){var Hd=new DataView(Hc),He=new laya.webgl.resource.WebGLImage(new Uint8Array(Hc,8),Ha,0,!1,Hd.getUint32(0),Hd.getUint32(4));this.onLoaded(He)}else if(Hc instanceof Hka)HA.imgMgrSet[Ha]=Hb,Hg.imgMgrLock(Ha,HA.imgMgrSet[Ha]),this._url=Ha,this.complete(Hc);else{var Hf=-1!=Ha.indexOf(".png",Ha.length-4)?6408:6407;He=new laya.webgl.resource.WebGLImage(Hc,Ha,Hf,!1,Hc.width,Hc.height);this.onLoaded(He)}else this.event("error","Load image failed")},Hb._loadSound=function(Ha){var Hb=new HC._soundClass,Hc=this;function Hd(){Hb.offAll()}Hb.on("complete",this,function(){Hd(),Hc.onLoaded(Hb)}),Hb.on("error",this,function(){Hd(),Hb.dispose(),Hc.event("error","Load sound failed")}),Hb.load(Ha)},Hb.onProgress=function(Ha){"atlas"===this._type?this.event("progress",.3*Ha):this.event("progress",Ha)},Hb.onError=function(Ha){this.event("error",Ha)},Hb._loadedComplete=function(Ha,Hb,Hc){if(null!=Hc)switch(this._type){case"atlas":case"plf":case"json":var Hd=new HN(Hc);this.onLoaded(JSON.parse(Hd.readUTFBytes()));break;case"font":Hd=new HN(Hc);this.onLoaded(HY.parseXMLFromString(Hd.readUTFBytes()));break;default:this.onLoaded(Hc)}else this.event("error",Ha)},Hb.onLoaded=function(Ha){var Hb=this._type;if("plf"==Hb)this.parsePLFData(Ha),this.complete(Ha);else if("image"===Hb){var Hc=new Hka(Ha);Hc.url=this._url,this.complete(Hc)}else if("sound"===Hb||"htmlimage"===Hb||"nativeimage"===Hb)this.complete(Ha);else if("atlas"===Hb){if(!Ha.src&&!Ha._setContext){if(!this._data){if((this._data=Ha).meta&&Ha.meta.image)for(var Hd=Ha.meta.image.split(","),He=0<=this._url.indexOf("/")?"/":"\\",Hf=this._url.lastIndexOf(He),Hg=0<=Hf?this._url.substr(0,Hf+1):"",Hh=0,Hi=Hd.length;Hh<Hi;Hh++)Hd[Hh]=Hg+Hd[Hh];else Hd=[this._url.replace(".json",".png")];Hd.reverse(),Ha.toLoads=Hd,Ha.pics=[]}return this.event("progress",.3+1/Hd.length*.6),this._loadImage(Hd.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(Ha),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var Hj=this._data.frames,Hk=this._url.split("?")[0],Hl=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:Hk.substring(0,Hk.lastIndexOf("."))+"/",Hm=this._data.pics,Hn=HG.formatURL(this._url),Ho=HA.atlasMap[Hn]||(HA.atlasMap[Hn]=[]);Ho.dir=Hl;var Hp=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var Hq in Hp=parseFloat(this._data.meta.scale),Hj){var Hr,Hs=Hj[Hq],Ht=Hm[Hs.frame.idx?Hs.frame.idx:0],Hu=HG.formatURL(Hl+Hq);Ht.scaleRate=Hp,Hr=Hka.create(Ht,Hs.frame.x,Hs.frame.y,Hs.frame.w,Hs.frame.h,Hs.spriteSourceSize.x,Hs.spriteSourceSize.y,Hs.sourceSize.w,Hs.sourceSize.h),HA.cacheRes(Hu,Hr),HA.keepCache(this._url,Hl+Hq),Hr.url=Hu,Ho.push(Hu)}else for(Hq in Hj)Ht=Hm[(Hs=Hj[Hq]).frame.idx?Hs.frame.idx:0],Hu=HG.formatURL(Hl+Hq),HA.cacheRes(Hu,Hka.create(Ht,Hs.frame.x,Hs.frame.y,Hs.frame.w,Hs.frame.h,Hs.spriteSourceSize.x,Hs.spriteSourceSize.y,Hs.sourceSize.w,Hs.sourceSize.h)),HA.loadedMap[Hu].url=Hu,HA.keepCache(this._url,Hl+Hq),Ho.push(Hu);delete this._data.pics,this.complete(this._data)}else if("font"==Hb){if(!Ha.src)return this._data=Ha,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var Hv=new HB;Hv.parseFont(this._data,Ha);var Hw=this._url.split(".fnt")[0].split("/"),Hx=Hw[Hw.length-1];Hqa.registerBitmapFont(Hx,Hv),this._data=Hv,this.complete(this._data)}else if("pkm"==Hb){var Hy=Hwa.create(Ha,this._url),Hz=new Hka(Hy);Hz.url=this._url,this.complete(Hz)}else this.complete(Ha)},Hb.parsePLFData=function(Ha){var Hb,Hc,Hd;for(Hb in Ha)switch(Hd=Ha[Hb],Hb){case"json":case"text":for(Hc in Hd)HA.preLoadedMap[HG.formatURL(Hc)]=Hd[Hc];break;default:for(Hc in Hd)HA.preLoadedMap[HG.formatURL(Hc)]=Hd[Hc]}},Hb.complete=function(Ha){this._data=Ha,this._customParse?this.event("loaded",Ha instanceof Array?[Ha]:Ha):(HA._loaders.push(this),HA._isWorking||HA.checkNext())},Hb.endLoad=function(Ha){Ha&&(this._data=Ha),this._cache&&HA.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},Hk(0,Hb,"url",function(){return this._url}),Hk(0,Hb,"data",function(){return this._data}),Hk(0,Hb,"cache",function(){return this._cache}),Hk(0,Hb,"type",function(){return this._type}),HA.checkNext=function(){HA._isWorking=!0;for(var Ha=HM.now();HA._startIndex<HA._loaders.length;)if(HM.now(),HA._loaders[HA._startIndex].endLoad(),HA._startIndex++,HM.now()-Ha>HA.maxTimeOut)return console.warn("loader callback cost a long time:"+(HM.now()-Ha)+" url="+HA._loaders[HA._startIndex-1].url),void Hx.timer.frameOnce(1,null,HA.checkNext);HA._loaders.length=0,HA._startIndex=0,HA._isWorking=!1},HA.clearRes=function(Ha,Hb){if(null!=Ha){void 0===Hb&&(Hb=!1),Ha=HG.formatURL(Ha);var Hc=HA.getAtlas(Ha);if(Hc){for(var Hd=0,He=Hc.length;Hd<He;Hd++){var Hf=Hc[Hd],Hg=HA.getRes(Hf);delete HA.loadedMap[Hf],HA.clearCache(Ha.substring(HG.basePath.length),Hf.substring(HG.basePath.length)),Hg&&Hg.destroy(Hb)}Hc.length=0,delete HA.atlasMap[Ha],delete HA.loadedMap[Ha]}else{var Hh=HA.loadedMap[Ha];Hh&&(delete HA.loadedMap[Ha],Hh instanceof laya.resource.Texture&&Hh.bitmap&&Hh.destroy(Hb))}}},HA.clearTextureRes=function(Ha){Ha=HG.formatURL(Ha);var Hb=laya.net.Loader.getAtlas(Ha),Hc=Hb&&0<Hb.length?laya.net.Loader.getRes(Hb[0]):laya.net.Loader.getRes(Ha);Hc&&Hc.bitmap&&(HH.isConchApp&&!HH.isConchWebGL?Hc.bitmap.source.releaseTexture&&Hc.bitmap.source.releaseTexture():null==Hc.bitmap._atlaser&&Hc.bitmap.releaseResource(!0))},HA.getRes=function(Ha){return HA.loadedMap[HG.formatURL(Ha)]},HA.getAtlas=function(Ha){return HA.atlasMap[HG.formatURL(Ha)]},HA.cacheRes=function(Ha,Hb){Ha=HG.formatURL(Ha),null!=HA.loadedMap[Ha]?console.warn("Resources already exist,is repeated loading:",Ha):HA.loadedMap[Ha]=Hb},HA.setGroup=function(Ha,Hb){HA.groupMap[Hb]||(HA.groupMap[Hb]=[]),HA.groupMap[Hb].push(Ha)},HA.clearResByGroup=function(Ha){if(HA.groupMap[Ha]){var Hb=HA.groupMap[Ha],Hc=0,Hd=Hb.length;for(Hc=0;Hc<Hd;Hc++)HA.clearRes(Hb[Hc]);Hb.length=0}},HA.keepCache=function(Ha,Hb){if(Ha&&Hb){var Hc=HA.cacheSet[Hb];Hc?-1==Hc.indexOf(Ha)&&Hc.push(Ha):HA.cacheSet[Hb]=[Ha]}},HA.clearCache=function(Ha,Hb){if(Ha&&Hb){var Hc=HA.cacheSet[Hb];if(Hc){var Hd=Hc.indexOf(Ha);if(-1!==Hd){var He=Hc.length-1;0==He?(delete HA.cacheSet[Hb],0<HA.imgMgrSet[Hb]?Hg.imgMgrFree(Hb,HA.imgMgrSet[Hb]):HA.clearRes(Hb,!0)):(Hc[Hd]=Hc[He],Hc.length=He)}}}},HA.saveObject=function(Ha,Hb,Hc){if(Hb&&Ha){var Hd=HA.objectSet[Ha];Hd?(console.warn("Loader.saveObject: "+Ha),Hd[0]=Hb,Hd[1]=Hc):HA.objectSet[Ha]=[Hb,Hc,[]]}},HA.findObject=function(Ha){if(Ha){var Hb=HA.objectSet[Ha];if(Hb)return Hb[0]}return null},HA.keepObject=function(Ha,Hb){if(Ha&&Hb){var Hc=HA.objectSet[Hb];Hc&&-1===Hc[2].indexOf(Ha)&&Hc[2].push(Ha)}},HA.clearObject=function(Ha,Hb){if(Ha&&Hb){var Hc=HA.objectSet[Hb];if(Hc){var Hd=Hc[2],He=Hd.indexOf(Ha);if(-1!==He){var Hf=Hd.length-1;0==Hf?(delete HA.objectSet[Hb],Hc[1]&&Hc[1].call(null,Hc[0])):(Hd[He]=Hd[Hf],Hd.length=Hf)}}}},HA.TEXT="text",HA.JSON="json",HA.XML="xml",HA.BUFFER="arraybuffer",HA.IMAGE="image",HA.SOUND="sound",HA.ATLAS="atlas",HA.FONT="font",HA.TTF="ttf",HA.PLF="plf",HA.PKM="pkm",HA.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},HA.parserMap={},HA.groupMap={},HA.maxTimeOut=100,HA.loadedMap={},HA.preLoadedMap={},HA.atlasMap={},HA._loaders=[],HA._isWorking=!1,HA._startIndex=0,HA.imgCache={},HA.cacheSet={},HA.objectSet={},HA.imgMgrSet={},HA}(),Hia=function(Ha){var Hm;function Hn(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},Hn.__super.call(this);for(var Ha=0;Ha<this._maxPriority;Ha++)this._resInfos[Ha]=[]}Hp(Hn,"laya.net.LoaderManager",Hj);var Hb=Hn.prototype;return Hb.create=function(Ha,Hc,Hb,Hd,He,Hf,Hg,Hh){if(null==Hf&&(Hf=2),null==Hg&&(Hg=!0),Ha instanceof Array){var Hi=Ha,Hj=Hi.length,Hk=0;if(Hb)var Hl=Hs.create(Hb.caller,Hb.method,Hb.args,!1);for(var Hm=0;Hm<Hj;Hm++){var Hn=Hi[Hm];"string"==typeof Hn&&(Hn=Hi[Hm]={url:Hn}),Hn.progress=0}for(Hm=0;Hm<Hj;Hm++){Hn=Hi[Hm];var Ho=Hb?Hs.create(null,Hr,[Hn],!1):null,Hp=Hb||Hc?Hs.create(null,Hq,[Hn]):null;this._create(Hn.url,Hp,Ho,Hn.clas||Hd,Hn.params||He,null!=Hn.priority&&0<=Hn.priority?Hn.priority:Hf,Hg,Hn.group||Hh)}function Hq(Ha,Hb){Hk++,Ha.progress=1,Hk===Hj&&Hc&&Hc.run()}function Hr(Ha,Hb){Ha.progress=Hb;for(var Hc=0,Hd=0;Hd<Hj;Hd++){Hc+=Hi[Hd].progress}var He=Hc/Hj;Hl.runWith(He)}return!0}return this._create(Ha,Hc,Hb,Hd,He,Hf,Hg,Hh)},Hb._create=function(Hb,Hc,Ha,Hd,He,Hf,Hg,Hh){Hb&&""!=Hb||console.error("加载的url不合法 "+Hb),null==Hf&&(Hf=2),null==Hg&&(Hg=!0);var Hi=HG.formatURL(Hb),Hj=this.getRes(Hi);if(Hj)!Hj.hasOwnProperty("loaded")||Hj.loaded?(Ha&&Ha.runWith(1),Hc&&Hc.run()):Hc&&Hx.loader._createListener(Hb,Hc.caller,Hc.method,Hc.args,!0,!1);else{var Hk=HY.getFileExtension(Hb),Hl=Hn.createMap[Hk];if(!Hl)throw new Error("LoaderManager:unknown file("+Hb+") extension with: "+Hk+".");Hd||(Hd=Hl[0]);var Hm=Hl[1];if("atlas"==Hk)this.load(Hb,Hc,Ha,Hm,Hf,Hg);else{Hd===Hka&&(Hm="htmlimage"),(Hj=Hd?new Hd:null).hasOwnProperty("_loaded")&&(Hj._loaded=!1),Hj._setUrl(Hb),Hh&&Hj._setGroup(Hh),this._createLoad(Hj,Hb,Hs.create(null,function(Ha){Hj&&!Hj.destroyed&&Ha&&Hj.onAsynLoaded.call(Hj,Hb,Ha,He),Hc&&Hc.run();Hx.loader.event(Hb)}),Ha,Hm,Hf,!1,Hh,!0),Hg&&this.cacheRes(Hi,Hj)}}return Hj},Hb.load=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){Ha&&""!=Ha||console.error("加载的url不合法 "+Ha);var Hi=this;if(null==He&&(He=2),null==Hf&&(Hf=!0),void 0===Hh&&(Hh=!1),Ha instanceof Array)return this._loadAssets(Ha,Hb,Hc,Hd,He,Hf,Hg);var Hj=Hha.getRes(Ha);if(null!=Hj)Hx.timer.frameOnce(1,null,function(){Hc&&Hc.runWith(1),Hb&&Hb.runWith(Hj),Hi._loaderCount||Hi.event("complete")});else{var Hk=Hn._resMap[Ha];Hk?(Hb&&Hk._createListener("complete",Hb.caller,Hb.method,Hb.args,!1,!1),Hc&&Hk._createListener("progress",Hc.caller,Hc.method,Hc.args,!1,!1)):((Hk=this._infoPool.length?this._infoPool.pop():new Hm).url=Ha,Hk.type=Hd,Hk.cache=Hf,Hk.group=Hg,Hk.ignoreCache=Hh,Hk.priority=He,Hb&&Hk.on("complete",Hb.caller,Hb.method,Hb.args),Hc&&Hk.on("progress",Hc.caller,Hc.method,Hc.args),Hn._resMap[Ha]=Hk,He=He<this._maxPriority?0<=He?He:0:this._maxPriority-1,this._resInfos[He].push(Hk),this._next())}return this},Hb._createLoad=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){var Hj=this;if(null==Hf&&(Hf=2),null==Hg&&(Hg=!0),void 0===Hi&&(Hi=!1),Hb instanceof Array)return this._loadAssets(Hb,Hc,Hd,He,Hf,Hg,Hh);var Hk=Hha.getRes(Hb);if(null!=Hk)Hx.timer.frameOnce(1,null,function(){Hd&&Hd.runWith(1),Hc&&Hc.runWith(Hk),Hj._loaderCount||Hj.event("complete")});else{var Hl=Hn._resMap[Hb];Hl?(Hc&&Hl._createListener("complete",Hc.caller,Hc.method,Hc.args,!1,!1),Hd&&Hl._createListener("progress",Hd.caller,Hd.method,Hd.args,!1,!1)):((Hl=this._infoPool.length?this._infoPool.pop():new Hm).url=Hb,Hl.clas=Ha,Hl.type=He,Hl.cache=Hg,Hl.group=Hh,Hl.ignoreCache=Hi,Hl.priority=Hf,Hc&&Hl.on("complete",Hc.caller,Hc.method,Hc.args),Hd&&Hl.on("progress",Hd.caller,Hd.method,Hd.args),Hn._resMap[Hb]=Hl,Hf=Hf<this._maxPriority?0<=Hf?Hf:0:this._maxPriority-1,this._resInfos[Hf].push(Hl),this._next())}return this},Hb._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var Ha=0;Ha<this._maxPriority;Ha++)for(var Hb=this._resInfos[Ha];0<Hb.length;){var Hc=Hb.shift();if(Hc)return this._doLoad(Hc)}this._loaderCount||this.event("complete")}},Hb._doLoad=function(Hb){this._loaderCount++;var Hc=this._loaders.length?this._loaders.pop():new Hha;Hc.on("complete",null,He),Hc.on("progress",null,function(Ha){Hb.event("progress",Ha)}),Hc.on("error",null,function(Ha){He(null)});var Hd=this;function He(Ha){Hc.offAll(),Hc._data=null,Hc._customParse=!1,Hd._loaders.push(Hc),Hd._endLoad(Hb,Ha instanceof Array?[Ha]:Ha),Hd._loaderCount--,Hd._next()}Hc._class=Hb.clas,1<=Hb.priority?(Hc.priority=Hb.priority,Hc.realTime=!1):(Hc.priority=0,Hc.realTime=!0),Hc.load(Hb.url,Hb.type,Hb.cache,Hb.group,Hb.ignoreCache)},Hb._endLoad=function(Ha,Hb){var Hc=Ha.url;if(null==Hb){var Hd=this._failRes[Hc]||0;if(Hd<this.retryNum)return console.warn("[warn]Retry to load:",Hc),this._failRes[Hc]=Hd+1,void Hx.timer.once(this.retryDelay,this,this._addReTry,[Ha],!1);console.warn("[error]Failed to load:",Hc),this.event("error",Hc)}this._failRes[Hc]&&(this._failRes[Hc]=0),delete Hn._resMap[Hc],Ha.event("complete",Hb),Ha.offAll(),this._infoPool.push(Ha)},Hb._addReTry=function(Ha){this._resInfos[this._maxPriority-1].push(Ha),this._next()},Hb.clearRes=function(Ha,Hb){void 0===Hb&&(Hb=!1),Hha.clearRes(Ha,Hb)},Hb.getRes=function(Ha){return Hha.getRes(Ha)},Hb.cacheRes=function(Ha,Hb){Hha.cacheRes(Ha,Hb)},Hb.clearTextureRes=function(Ha){Hha.clearTextureRes(Ha)},Hb.setGroup=function(Ha,Hb){Hha.setGroup(Ha,Hb)},Hb.clearResByGroup=function(Ha){Hha.clearResByGroup(Ha)},Hb.clearUnLoaded=function(){for(var Ha=0;Ha<this._maxPriority;Ha++){for(var Hb=this._resInfos[Ha],Hc=Hb.length-1;-1<Hc;Hc--){var Hd=Hb[Hc];Hd&&(Hd.offAll(),this._infoPool.push(Hd))}Hb.length=0}this._loaderCount=0,Hn._resMap={}},Hb.cancelLoadByUrls=function(Ha){if(Ha)for(var Hb=0,Hc=Ha.length;Hb<Hc;Hb++)this.cancelLoadByUrl(Ha[Hb])},Hb.cancelLoadByUrl=function(Ha){for(var Hb=0;Hb<this._maxPriority;Hb++)for(var Hc=this._resInfos[Hb],Hd=Hc.length-1;-1<Hd;Hd--){var He=Hc[Hd];He&&He.url===Ha&&(Hc[Hd]=null,He.offAll(),this._infoPool.push(He))}Hn._resMap[Ha]&&delete Hn._resMap[Ha]},Hb._loadAssets=function(Ha,Hc,Hg,Hb,Hd,He,Hf){null==Hd&&(Hd=2),null==He&&(He=!0);for(var Hh=Ha.length,Hi=0,Hj=0,Hk=[],Hl=!0,Hm=0;Hm<Hh;Hm++){var Hn=Ha[Hm];if(!Hn)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+Ha);"string"==typeof Hn&&(Hn={url:Hn,type:Hb,size:1,priority:Hd}),Hn.size||(Hn.size=1),Hn.progress=0,Hj+=Hn.size,Hk.push(Hn);var Ho=Hg?Hs.create(null,Hr,[Hn],!1):null,Hp=Hc||Hg?Hs.create(null,Hq,[Hn]):null;this.load(Hn.url,Hp,Ho,Hn.type,null!=Hn.priority&&0<=Hn.priority?Hn.priority:2,He,Hn.group||Hf)}function Hq(Ha,Hb){Hi++,Ha.progress=1,Hb||(Hl=!1),Hi===Hh&&Hc&&Hc.runWith(Hl)}function Hr(Ha,Hb){if(null!=Hg){Ha.progress=Hb;for(var Hc=0,Hd=0;Hd<Hk.length;Hd++){var He=Hk[Hd];Hc+=He.size*He.progress}var Hf=Hc/Hj;Hg.runWith(Hf)}}return this},Hn.cacheRes=function(Ha,Hb){Hha.cacheRes(Ha,Hb)},Hn._resMap={},Hi(Hn,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),Hn.__init$=function(){Hm=function(Ha){function Hb(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,Hb.__super.call(this)}return Hp(Hb,"",Hj),Hb}()},Hn}(),Hja=(function(Ha){function He(Ha){He.__super.call(this),Ha||(Ha=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var Hb=0,Hc=0,Hd=0;Hd<20;Hd++)Hd%5!=4?this._mat[Hb++]=Ha[Hd]:this._alpha[Hc++]=Ha[Hd];this._action=HD.createFilterAction(32),this._action.data=this}Hp(He,"laya.filters.ColorFilter",Hr);var Hb=He.prototype;Hx.imps(Hb,{"laya.filters.IFilter":!0}),Hb.callNative=function(Ha){Ha._$P.cf=this;Ha.conchModel&&Ha.conchModel.setFilterMatrix&&Ha.conchModel.setFilterMatrix(this._mat,this._alpha)},Hk(0,Hb,"type",function(){return 32}),Hk(0,Hb,"action",function(){return this._action})}(),function(Ha){function Hd(Ha,Hb,Hc){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===Hb&&(Hb=0),Hd.__super.call(this),this._byteClass=Hc||HN,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,Ha&&0<Hb&&Hb<65535&&this.connect(Ha,Hb)}Hp(Hd,"laya.net.Socket",Hj);var Hb=Hd.prototype;Hb.connect=function(Ha,Hb){var Hc="ws://"+Ha+":"+Hb;Hc="https:"==HM.window.location.protocol?"wss://"+Ha+":"+Hb:"ws://"+Ha+":"+Hb,this.connectByUrl(Hc)},Hb.connectByUrl=function(Ha){var Hb=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new HM.window.WebSocket(Ha,this.protocols):this._socket=new HM.window.WebSocket(Ha),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(Ha){Hb._onOpen(Ha)},this._socket.onmessage=function(Ha){Hb._onMessage(Ha)},this._socket.onclose=function(Ha){Hb._onClose(Ha)},this._socket.onerror=function(Ha){Hb._onError(Ha)}},Hb.cleanSocket=function(){try{this._socket.close()}catch(Ha){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},Hb.close=function(){if(null!=this._socket)try{this._socket.close()}catch(Ha){}},Hb._onOpen=function(Ha){this._connected=!0,this.event("open",Ha)},Hb._onMessage=function(Ha){if(Ha&&Ha.data){var Hb=Ha.data;if(this.disableInput&&Hb)this.event("message",Hb);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var Hc=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,Hb&&("string"==typeof Hb?this._input.writeUTFBytes(Hb):this._input.writeArrayBuffer(Hb),this._addInputPosition=this._input.pos,this._input.pos=Hc),this.event("message",Hb)}}},Hb._onClose=function(Ha){this._connected=!1,this.event("close",Ha)},Hb._onError=function(Ha){this.event("error",Ha)},Hb.send=function(Ha){this._socket.send(Ha)},Hb.flush=function(){if(this._output&&0<this._output.length){var Hb;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(Ha){Hb=Ha}this._output.endian=this.endian,this._output.clear(),Hb&&this.event("error",Hb)}},Hk(0,Hb,"input",function(){return this._input}),Hk(0,Hb,"output",function(){return this._output}),Hk(0,Hb,"connected",function(){return this._connected}),Hk(0,Hb,"endian",function(){return this._endian},function(Ha){this._endian=Ha,null!=this._input&&(this._input.endian=Ha),null!=this._output&&(this._output.endian=Ha)}),Hd.LITTLE_ENDIAN="littleEndian",Hd.BIG_ENDIAN="bigEndian"}(),function(Ha){function Hh(){Hh.__super.call(this),this._$1__id=++Hh._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(Hh._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,HL.currentResourceManager&&HL.currentResourceManager.addResource(this)}Hp(Hh,"laya.resource.Resource",Hj);var Hb=Hh.prototype;return Hx.imps(Hb,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),Hb._setUrl=function(Ha){var Hb;this._url!==Ha&&(this._url&&((Hb=Hh._urlResourcesMap[this._url]).splice(Hb.indexOf(this),1),0===Hb.length&&delete Hh._urlResourcesMap[this._url]),Ha&&((Hb=Hh._urlResourcesMap[Ha])||(Hh._urlResourcesMap[Ha]=Hb=[]),Hb.push(this)),this._url=Ha)},Hb._getGroup=function(){return this._group},Hb._setGroup=function(Ha){var Hb;this._group!==Ha&&(this._group&&((Hb=Hh._groupResourcesMap[this._group]).splice(Hb.indexOf(this),1),0===Hb.length&&delete Hh._groupResourcesMap[this._group]),Ha&&((Hb=Hh._groupResourcesMap[Ha])||(Hh._groupResourcesMap[Ha]=Hb=[]),Hb.push(this)),this._group=Ha)},Hb._addReference=function(){this._referenceCount++},Hb._removeReference=function(){this._referenceCount--},Hb._clearReference=function(){this._referenceCount=0},Hb._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},Hb.recreateResource=function(){this.completeCreate()},Hb.disposeResource=function(){},Hb.activeResource=function(Ha){void 0===Ha&&(Ha=!1),this._lastUseFrameCount=HV.loopCount,!this._destroyed&&this.__loaded&&(this._released||Ha)&&this.recreateResource()},Hb.releaseResource=function(Ha){return void 0===Ha&&(Ha=!0),!(!Ha&&this.lock)&&(!(this._released&&!Ha)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},Hb.onAsynLoaded=function(Ha,Hb,Hc){throw new Error("Resource: must override this function!")},Hb.destroy=function(){var Ha;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete Hh._idResourcesMap[this.id],this._url&&((Ha=Hh._urlResourcesMap[this._url])&&(Ha.splice(Ha.indexOf(this),1),0===Ha.length&&delete Hh._urlResourcesMap[this.url]),Hha.clearRes(this._url),this.__loaded||HD.cancelLoadByUrl(this._url)),this._group&&((Ha=Hh._groupResourcesMap[this._group]).splice(Ha.indexOf(this),1),0===Ha.length&&delete Hh._groupResourcesMap[this.url]))},Hb.completeCreate=function(){this._released=!1,this.event("recovered",this)},Hb.dispose=function(){this.destroy()},Hk(0,Hb,"memorySize",function(){return this._memorySize},function(Ha){var Hb=Ha-this._memorySize;this._memorySize=Ha,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,Hb),this.resourceManager&&this.resourceManager.addSize(Hb)}),Hk(0,Hb,"_loaded",null,function(Ha){this.__loaded=Ha}),Hk(0,Hb,"loaded",function(){return this.__loaded}),Hk(0,Hb,"id",function(){return this._$1__id}),Hk(0,Hb,"destroyed",function(){return this._destroyed}),Hk(0,Hb,"group",function(){return this._getGroup()},function(Ha){this._setGroup(Ha)}),Hk(0,Hb,"resourceManager",function(){return this._resourceManager}),Hk(0,Hb,"url",function(){return this._url}),Hk(0,Hb,"released",function(){return this._released}),Hk(0,Hb,"referenceCount",function(){return this._referenceCount}),Hh.getResourceByID=function(Ha){return Hh._idResourcesMap[Ha]},Hh.getResourceByURL=function(Ha,Hb){return void 0===Hb&&(Hb=0),null==Hh._urlResourcesMap[Ha]?null:Hh._urlResourcesMap[Ha][Hb]},Hh.getResourceCountByURL=function(Ha){return Hh._urlResourcesMap[Ha].length},Hh.destroyUnusedResources=function(Ha){var Hb;if(Ha){var Hc=Hh._groupResourcesMap[Ha];if(Hc)for(var Hd=Hc.slice(),He=0,Hf=Hd.length;He<Hf;He++)(Hb=Hd[He]).lock||0!==Hb._referenceCount||Hb.destroy()}else for(var Hg in Hh._idResourcesMap)(Hb=Hh._idResourcesMap[Hg]).lock||0!==Hb._referenceCount||Hb.destroy()},Hh._uniqueIDCounter=0,Hh._idResourcesMap={},Hh._urlResourcesMap={},Hh._groupResourcesMap={},Hh}()),Hka=function(Ha){function HA(Ha,Hb){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,HA.__super.call(this),Ha&&null!=Ha._addReference&&Ha._addReference(),this.setTo(Ha,Hb)}Hp(HA,"laya.resource.Texture",Hj);var Hb=HA.prototype;return Hb._setUrl=function(Ha){this.url=Ha},Hb.setTo=function(Ha,Hb){if(Ha instanceof Hg.HTMLElement){var Hc=Hta.create("2D",Ha);this.bitmap=Hc}else this.bitmap=Ha;if(this.uv=Hb||HA.DEF_UV,Ha){this._w=Ha.width,this._h=Ha.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var Hd=this;if(this._loaded)HD.addToAtlas&&HD.addToAtlas(Hd);else{var He=Ha;He instanceof laya.resource.HTMLImage&&He.image&&He.image.addEventListener("load",function(Ha){HD.addToAtlas&&HD.addToAtlas(Hd)},!1)}}},Hb.active=function(){this.bitmap&&this.bitmap.activeResource()},Hb.destroy=function(Ha){if(void 0===Ha&&(Ha=!1),this.alphaTexture&&(this.alphaTexture.destroy(Ha),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var Hb=this.bitmap;Ha?(HH.isConchApp&&Hb.source&&Hb.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,Hb.dispose(),Hb._clearReference()):(Hb._removeReference(),0==Hb.referenceCount&&(HH.isConchApp&&Hb.source&&Hb.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,Hb.dispose())),this.url&&this===Hx.loader.getRes(this.url)&&Hx.loader.clearRes(this.url,Ha),this._loaded=!1}},Hb.load=function(Ha){var Hb=this;this._loaded=!1,Ha=HG.customFormat(Ha);var Hc=this.bitmap||(this.bitmap=Hwa.create(Ha));Hc.uri=Ha,Hc&&Hc._addReference();var Hd=this;Hc.onload=function(){Hc.onload=null,Hd._loaded=!0,Hb.sourceWidth=Hb._w=Hc.width,Hb.sourceHeight=Hb._h=Hc.height,Hd.event("loaded",this),HD.addToAtlas&&HD.addToAtlas(Hd)}},Hb.addTextureToAtlas=function(Ha){HD.addTextureToAtlas(this)},Hb.getPixels=function(Ha,Hb,Hc,Hd){if(HH.isConchApp){var He=this.bitmap;if(He.source&&He.source.getImageData){var Hf=He.source.getImageData(Ha,Hb,Hc,Hd),Hg=new Uint8Array(Hf);return Array.from(Hg)}return null}return HH.isWebGL?HD.getTexturePixels(this,Ha,Hb,Hc,Hd):(HM.canvas.size(Hc,Hd),HM.canvas.clear(),HM.context.drawTexture(this,-Ha,-Hb,this.width,this.height,0,0),HM.context.getImageData(0,0,Hc,Hd).data)},Hb.onAsynLoaded=function(Ha,Hb){if(Hb){if("function"!=typeof Hb._addReference)throw new Error("bitmap._addReference is not a function. "+Hb.className+" "+typeof Hb._addReference+" "+Hb.constructor);Hb._addReference()}this.setTo(Hb,this.uv),this._loaded&&this.event("loaded",this)},Hk(0,Hb,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),Hk(0,Hb,"loaded",function(){return this._loaded}),Hk(0,Hb,"released",function(){return!this.bitmap||this.bitmap.released}),Hk(0,Hb,"width",function(){return this._w?this._w:this.uv&&this.uv!==HA.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(Ha){this._w=Ha,this.sourceWidth||(this.sourceWidth=Ha)}),Hk(0,Hb,"repeat",function(){return!HH.isWebGL||!this.bitmap||this.bitmap.repeat},function(Ha){Ha&&HH.isWebGL&&this.bitmap&&(this.bitmap.repeat=Ha)&&(this.bitmap.enableMerageInAtlas=!1)}),Hk(0,Hb,"height",function(){return this._h?this._h:this.uv&&this.uv!==HA.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(Ha){this._h=Ha,this.sourceHeight||(this.sourceHeight=Ha)}),Hk(0,Hb,"isLinearSampling",function(){return!HH.isWebGL||9728!=this.bitmap.minFifter},function(Ha){!Ha&&HH.isWebGL&&(Ha||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),HA.moveUV=function(Ha,Hb,Hc){for(var Hd=0;Hd<8;Hd+=2)Hc[Hd]+=Ha,Hc[Hd+1]+=Hb;return Hc},HA.create=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){void 0===Hf&&(Hf=0),void 0===Hg&&(Hg=0),void 0===Hh&&(Hh=0),void 0===Hi&&(Hi=0);var Hj=Ha instanceof laya.resource.Texture,Hk=Hj?Ha.uv:HA.DEF_UV,Hl=Hj?Ha.bitmap:Ha,Hm=HD.isAtlas(Hl);if(Hm){var Hn=Hl._atlaser,Ho=Ha._atlasID;if(-1==Ho)throw new Error("create texture error");Hl=Hn._inAtlasTextureBitmapValue[Ho],Hk=Hn._inAtlasTextureOriUVValue[Ho]}var Hp=new HA(Hl,null);Hl.width&&Hb+Hd>Hl.width&&(Hd=Hl.width-Hb),Hl.height&&Hc+He>Hl.height&&(He=Hl.height-Hc),Hp.width=Hd,Hp.height=He,Hp.offsetX=Hf,Hp.offsetY=Hg,Hp.sourceWidth=Hh||Hd,Hp.sourceHeight=Hi||He;var Hq=1/Hl.width,Hr=1/Hl.height;Hb*=Hq,Hc*=Hr,Hd*=Hq,He*=Hr;var Hs=Hp.uv[0],Ht=Hp.uv[1],Hu=Hp.uv[4],Hv=Hp.uv[5],Hw=Hu-Hs,Hx=Hv-Ht,Hy=HA.moveUV(Hk[0],Hk[1],[Hb,Hc,Hb+Hd,Hc,Hb+Hd,Hc+He,Hb,Hc+He]);Hp.uv=[Hs+Hy[0]*Hw,Ht+Hy[1]*Hx,Hu-(1-Hy[2])*Hw,Ht+Hy[3]*Hx,Hu-(1-Hy[4])*Hw,Hv-(1-Hy[5])*Hx,Hs+Hy[6]*Hw,Hv-(1-Hy[7])*Hx],Hm&&Hp.addTextureToAtlas();var Hz=Hl.scaleRate;return Hz&&1!=Hz?(Hp.sourceWidth/=Hz,Hp.sourceHeight/=Hz,Hp.width/=Hz,Hp.height/=Hz,Hp.scaleRate=Hz,Hp.offsetX/=Hz,Hp.offsetY/=Hz):Hp.scaleRate=1,Hp},HA.createFromTexture=function(Ha,Hb,Hc,Hd,He){var Hf=Ha.scaleRate;1!=Hf&&(Hb*=Hf,Hc*=Hf,Hd*=Hf,He*=Hf);var Hg=Hz.TEMP.setTo(Hb-Ha.offsetX,Hc-Ha.offsetY,Hd,He),Hh=Hg.intersection(HA._rect1.setTo(0,0,Ha.width,Ha.height),HA._rect2);if(!Hh)return null;var Hi=HA.create(Ha,Hh.x,Hh.y,Hh.width,Hh.height,Hh.x-Hg.x,Hh.y-Hg.y,Hd,He);if(Hi.bitmap&&Hi.bitmap._removeReference)return Hi.bitmap._removeReference(),Hi;var Hj="bitmap:"+(Hi.bitmap?Hi.bitmap.constructor?Hi.bitmap.constructor.name:Hi.bitmap.__className:"")+", url:"+(Ha.url+" | "+(Hi.bitmap?Hi.bitmap.url:Ha.url))+", x="+Hb+",y="+Hc+",width="+Hd+",height="+He+", result="+(Hh?Hh.x+","+Hh.y+","+Hh.width+","+Hh.height:"null")+", rect="+Hg.x+","+Hg.y+","+Hg.width+","+Hg.height;throw new Error("报错：bitmap._removeReference is not a function  "+Hj)},HA.DEF_UV=[0,0,1,0,1,1,0,1],HA.INV_UV=[0,1,1,1,1,0,0,0],HA._rect1=new Hz,HA._rect2=new Hz,HA}(),Ha=function(Ha){var Hh;function Hf(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,Hf.__super.call(this)}Hp(Hf,"laya.utils.TimeLine",Hj);var Hb=Hf.prototype;return Hb.to=function(Ha,Hb,Hc,Hd,He){return void 0===He&&(He=0),this._create(Ha,Hb,Hc,Hd,He,!0)},Hb.from=function(Ha,Hb,Hc,Hd,He){return void 0===He&&(He=0),this._create(Ha,Hb,Hc,Hd,He,!1)},Hb._create=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=HU.getItemByClass("tweenData",Hh);return Hg.isTo=Hf,Hg.type=0,Hg.target=Ha,Hg.duration=Hc,Hg.data=Hb,Hg.startTime=this._startTime+He,Hg.endTime=Hg.startTime+Hg.duration,Hg.ease=Hd,this._startTime=Math.max(Hg.endTime,this._startTime),this._tweenDataList.push(Hg),this._startTimeSort=!0,this._endTimeSort=!0,this},Hb.addLabel=function(Ha,Hb){var Hc=HU.getItemByClass("tweenData",Hh);return Hc.type=1,Hc.data=Ha,Hc.endTime=Hc.startTime=this._startTime+Hb,this._labelDic||(this._labelDic={}),this._labelDic[Ha]=Hc,this._tweenDataList.push(Hc),this},Hb.removeLabel=function(Ha){if(this._labelDic&&this._labelDic[Ha]){var Hb=this._labelDic[Ha];if(Hb){var Hc=this._tweenDataList.indexOf(Hb);-1<Hc&&this._tweenDataList.splice(Hc,1)}delete this._labelDic[Ha]}},Hb.gotoTime=function(Ha){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var Hb,Hc,Hd,He;for(var Hf in this._firstTweenDic)if(Hc=this._firstTweenDic[Hf])for(var Hg in Hc)Hc.diyTarget.hasOwnProperty(Hg)&&(Hc.diyTarget[Hg]=Hc[Hg]);for(Hf in this._tweenDic)(Hb=this._tweenDic[Hf]).clear(),delete this._tweenDic[Hf];if(this._index=0,this._gidIndex=0,this._currTime=Ha,this._lastTime=HM.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=Hd=this._tweenDataList.concat(),Hd.sort(function(Ha,Hb){return Ha.endTime>Hb.endTime?1:Ha.endTime<Hb.endTime?-1:0})}else Hd=this._endTweenDataList;for(var Hh=0,Hi=Hd.length;Hh<Hi;Hh++)if(0==(He=Hd[Hh]).type){if(!(Ha>=He.endTime))break;this._index=Math.max(this._index,Hh+1);var Hj=He.data;if(He.isTo)for(var Hk in Hj)He.target[Hk]=Hj[Hk]}for(Hh=0,Hi=this._tweenDataList.length;Hh<Hi;Hh++)0==(He=this._tweenDataList[Hh]).type&&Ha>=He.startTime&&Ha<He.endTime&&(this._index=Math.max(this._index,Hh+1),this._gidIndex++,(Hb=HU.getItemByClass("tween",HX))._create(He.target,He.data,He.duration,He.ease,Hs.create(this,this._animComplete,[this._gidIndex]),0,!1,He.isTo,!0,!1),Hb.setStartTime(this._currTime-(Ha-He.startTime)),Hb._updateEase(this._currTime),Hb.gid=this._gidIndex,this._tweenDic[this._gidIndex]=Hb)}},Hb.gotoLabel=function(Ha){if(null!=this._labelDic){var Hb=this._labelDic[Ha];Hb&&this.gotoTime(Hb.startTime)}},Hb.pause=function(){Hx.timer.clear(this,this._update)},Hb.resume=function(){this.play(this._currTime,this._loopKey)},Hb.play=function(Ha,Hb){if(void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(Ha,Hb){return Ha.startTime>Hb.startTime?1:Ha.startTime<Hb.startTime?-1:0});for(var Hc=0,Hd=this._tweenDataList.length;Hc<Hd;Hc++){var He=this._tweenDataList[Hc];if(null!=He&&0==He.type){var Hf=He.target,Hg=Hf.$_GID||(Hf.$_GID=HY.getGID()),Hh=null;for(var Hi in null==this._firstTweenDic[Hg]?((Hh={}).diyTarget=Hf,this._firstTweenDic[Hg]=Hh):Hh=this._firstTweenDic[Hg],He.data)null==Hh[Hi]&&(Hh[Hi]=Hf[Hi])}}}"string"==typeof Ha?this.gotoLabel(Ha):this.gotoTime(Ha),this._loopKey=Hb,this._lastTime=HM.now(),Hx.timer.frameLoop(1,this,this._update)}},Hb._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var Ha in this._tweenDic)(Hb=this._tweenDic[Ha]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var Hb,Hc=HM.now(),Hd=Hc-this._lastTime,He=this._currTime+=Hd*this.scale;for(Ha in this._lastTime=Hc,this._tweenDic)(Hb=this._tweenDic[Ha])._updateEase(He);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var Hf=this._tweenDataList[this._index];He>=Hf.startTime&&(this._index++,0==Hf.type?(this._gidIndex++,(Hb=HU.getItemByClass("tween",HX))._create(Hf.target,Hf.data,Hf.duration,Hf.ease,Hs.create(this,this._animComplete,[this._gidIndex]),0,!1,Hf.isTo,!0,!1),Hb.setStartTime(He),Hb.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=Hb)._updateEase(He)):this.event("label",Hf.data))}},Hb._animComplete=function(Ha){this._tweenDic[Ha]&&delete this._tweenDic[Ha]},Hb._complete=function(){this.event("complete")},Hb.reset=function(){var Ha;if(this._labelDic)for(Ha in this._labelDic)delete this._labelDic[Ha];for(Ha in this._tweenDic)this._tweenDic[Ha].clear(),delete this._tweenDic[Ha];for(Ha in this._firstTweenDic)delete this._firstTweenDic[Ha];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var Hb,Hc=0;for(Hb=this._tweenDataList.length,Hc=0;Hc<Hb;Hc++)this._tweenDataList[Hc]&&this._tweenDataList[Hc].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,Hx.timer.clear(this,this._update)},Hb.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},Hk(0,Hb,"index",function(){return this._frameIndex},function(Ha){this._frameIndex=Ha,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),Hk(0,Hb,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),Hf.to=function(Ha,Hb,Hc,Hd,He){return void 0===He&&(He=0),(new Hf).to(Ha,Hb,Hc,Hd,He)},Hf.from=function(Ha,Hb,Hc,Hd,He){return void 0===He&&(He=0),(new Hf).from(Ha,Hb,Hc,Hd,He)},Hf.__init$=function(){Hh=function(){function Ha(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return Hp(Ha,""),Ha.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,HU.recover("tweenData",this)},Ha}()},Hf}(),Hla=function(He){function Hc(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,Hc.__super.call(this),this._style=Hh.EMPTY}Hp(Hc,"laya.display.Sprite",He);var Ha=Hc.prototype;return Hx.imps(Ha,{"laya.display.ILayout":!0}),Ha.createConchModel=function(){return new ConchNode},Ha.destroy=function(Ha){if(void 0===Ha&&(Ha=!0),this._releaseMem(),!this._destroyed){this.filters=null;var Hb=this.mask;Hb&&(this.mask=null,Hb.destroy(Ha))}He.prototype.destroy.call(this,Ha),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},Ha.updateZOrder=function(){HY.updateOrder(this._childs)&&this.repaint()},Ha.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},Ha.setBounds=function(Ha){this._set$P("uBounds",Ha)},Ha.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new Hz),Hz._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},Ha.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new Hz),Hz._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},Ha._boundPointsToParent=function(Ha){void 0===Ha&&(Ha=!1);var Hb=0,Hc=0;this._style&&(Hb=this._style._tf.translateX,Hc=this._style._tf.translateY,Ha=Ha||0!==this._style._tf.rotate,this._style.scrollRect&&(Hb+=this._style.scrollRect.x,Hc+=this._style.scrollRect.y));var Hd=this._getBoundPointsM(Ha);if(!Hd||Hd.length<1)return Hd;if(8!=Hd.length&&(Hd=Ha?Hv.scanPList(Hd):Hz._getWrapRec(Hd,Hz.TEMP)._getBoundPoints()),!this.transform)return HY.transPointList(Hd,this._x-Hb,this._y-Hc),Hd;var He=Hy.TEMP,Hf=0,Hg=Hd.length;for(Hf=0;Hf<Hg;Hf+=2)He.x=Hd[Hf],He.y=Hd[Hf+1],this.toParentPoint(He),Hd[Hf]=He.x,Hd[Hf+1]=He.y;return Hd},Ha.getGraphicBounds=function(Ha){return void 0===Ha&&(Ha=!1),this._graphics?this._graphics.getBounds(Ha):Hz.TEMP.setTo(0,0,0,0)},Ha._getBoundPointsM=function(Ha){if(void 0===Ha&&(Ha=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var Hb=HY.clearArray(this._$P.temBM),Hc=Hz.TEMP;return Hc.copyFrom(this.scrollRect),HY.concatArray(Hb,Hc._getBoundPoints()),Hb}for(var Hd,He,Hf,Hg=this._graphics?this._graphics.getBoundPoints():HY.clearArray(this._$P.temBM),Hh=0,Hi=(Hf=this._childs).length;Hh<Hi;Hh++)(Hd=Hf[Hh])instanceof laya.display.Sprite&&1==Hd.visible&&(He=Hd._boundPointsToParent(Ha))&&(Hg=Hg?HY.concatArray(Hg,He):He);return Hg},Ha.getStyle=function(){return this._style===Hh.EMPTY&&(this._style=new Hh),this._style},Ha.setStyle=function(Ha){this._style=Ha},Ha._adjustTransform=function(){this._tfChanged=!1;var Ha,Hb=this._style._tf,Hc=Hb.scaleX,Hd=Hb.scaleY;if(Hb.rotate||1!==Hc||1!==Hd||Hb.skewX||Hb.skewY){(Ha=this._transform||(this._transform=HE.create())).bTransform=!0;var He=.0174532922222222*(Hb.rotate-Hb.skewX),Hf=.0174532922222222*(Hb.rotate+Hb.skewY),Hg=Math.cos(Hf),Hh=Math.sin(Hf),Hi=Math.sin(He),Hj=Math.cos(He);return Ha.a=Hc*Hg,Ha.b=Hc*Hh,Ha.c=-Hd*Hi,Ha.d=Hd*Hj,Ha.tx=Ha.ty=0,Ha}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,Ha},Ha.pos=function(Ha,Hb,Hc){if(void 0===Hc&&(Hc=!1),this._x!==Ha||this._y!==Hb){if(this.destroyed)return this;if(Hc){this._x=Ha,this._y=Hb,this.conchModel&&this.conchModel.pos(this._x,this._y);var Hd=this._parent;Hd&&0===Hd._repaint&&(Hd._repaint=1,Hd.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=Ha,this.y=Hb}return this},Ha.pivot=function(Ha,Hb){return this.pivotX=Ha,this.pivotY=Hb,this},Ha.size=function(Ha,Hb){return this.width=Ha,this.height=Hb,this},Ha.scale=function(Ha,Hb,Hc){void 0===Hc&&(Hc=!1);var Hd=this.getStyle(),He=Hd._tf;if(He.scaleX!=Ha||He.scaleY!=Hb){if(this.destroyed)return this;if(Hc){Hd.setScale(Ha,Hb),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Ha,Hb),this._renderType|=4;var Hf=this._parent;Hf&&0===Hf._repaint&&(Hf._repaint=1,Hf.parentRepaint())}else this.scaleX=Ha,this.scaleY=Hb}return this},Ha.skew=function(Ha,Hb){return this.skewX=Ha,this.skewY=Hb,this},Ha.render=function(Ha,Hb,Hc){HV.spriteCount++,HJ.renders[this._renderType]._fun(this,Ha,Hb+this._x,Hc+this._y),this._repaint=0},Ha.drawToCanvas=function(Ha,Hb,Hc,Hd){if(HH.isConchNode){var He=Hta.create("2D");return new HI(Ha,Hb,He).ctx.setCanvasType(1),this.conchModel.drawToCanvas(He.source,Hc,Hd),He}return HD.drawToCanvas(this,this._renderType,Ha,Hb,Hc,Hd)},Ha.customRender=function(Ha,Hb,Hc){this._renderType|=1024},Ha._applyFilters=function(){var Ha;if(!HH.isWebGL&&((Ha=this._$P.filters)&&!(Ha.length<1)))for(var Hb=0,Hc=Ha.length;Hb<Hc;Hb++)Ha[Hb].action.apply(this._$P.cacheCanvas)},Ha._isHaveGlowFilter=function(){var Ha,Hb=0;if(this.filters)for(Hb=0;Hb<this.filters.length;Hb++)if(8==this.filters[Hb].type)return!0;for(Hb=0,Ha=this._childs.length;Hb<Ha;Hb++)if(this._childs[Hb]._isHaveGlowFilter())return!0;return!1},Ha.localToGlobal=function(Ha,Hb){void 0===Hb&&(Hb=!1),!0===Hb&&(Ha=new Hy(Ha.x,Ha.y));for(var Hc=this;Hc&&Hc!=Hx.stage;)Ha=Hc.toParentPoint(Ha),Hc=Hc.parent;return Ha},Ha.globalToLocal=function(Ha,Hb){void 0===Hb&&(Hb=!1),Hb&&(Ha=new Hy(Ha.x,Ha.y));for(var Hc=this,Hd=[];Hc&&Hc!=Hx.stage;)Hd.push(Hc),Hc=Hc.parent;for(var He=Hd.length-1;0<=He;)Ha=(Hc=Hd[He]).fromParentPoint(Ha),He--;return Ha},Ha.toParentPoint=function(Ha){if(!Ha)return Ha;Ha.x-=this.pivotX,Ha.y-=this.pivotY,this.transform&&this._transform.transformPoint(Ha),Ha.x+=this._x,Ha.y+=this._y;var Hb=this._style.scrollRect;return Hb&&(Ha.x-=Hb.x,Ha.y-=Hb.y),Ha},Ha.fromParentPoint=function(Ha){if(!Ha)return Ha;Ha.x-=this._x,Ha.y-=this._y;var Hb=this._style.scrollRect;return Hb&&(Ha.x+=Hb.x,Ha.y+=Hb.y),this.transform&&this._transform.invertTransformPoint(Ha),Ha.x+=this.pivotX,Ha.y+=this.pivotY,Ha},Ha.on=function(Ha,Hb,Hc,Hd){return 1!==this._mouseEnableState&&this.isMouseEvent(Ha)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(Ha,Hb,Hc,Hd,!1)):He.prototype.on.call(this,Ha,Hb,Hc,Hd)},Ha.once=function(Ha,Hb,Hc,Hd){return 1!==this._mouseEnableState&&this.isMouseEvent(Ha)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(Ha,Hb,Hc,Hd,!0)):He.prototype.once.call(this,Ha,Hb,Hc,Hd)},Ha._$2__onDisplay=function(){if(1!==this._mouseEnableState){var Ha=this;for(Ha=Ha.parent;Ha&&1!==Ha._mouseEnableState&&!Ha._getBit(2);)Ha.mouseEnabled=!0,Ha._setBit(2,!0),Ha=Ha.parent}},Ha.loadImage=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=this;return void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=0),void 0===He&&(He=0),this.graphics.loadImage(Ha,Hb,Hc,Hd,He,function(Ha){Hg.destroyed||(Hg.size(Hb+(Hd||Ha.width),Hc+(He||Ha.height)),Hg.repaint(),Hf&&Hf.runWith(Ha))}),this},Ha.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},Ha._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},Ha._childChanged=function(Ha){this._childs.length?this._renderType|=2048:this._renderType&=-2049,Ha&&this._get$P("hasZorder")&&Hx.timer.callLater(this,this.updateZOrder),this.repaint()},Ha.parentRepaint=function(){var Ha=this._parent;Ha&&0===Ha._repaint&&(Ha._repaint=1,Ha.parentRepaint())},Ha.startDrag=function(Ha,Hb,Hc,Hd,He,Hf,Hg){void 0===Hb&&(Hb=!1),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=300),void 0===Hf&&(Hf=!1),void 0===Hg&&(Hg=.92),this._$P.dragging||this._set$P("dragging",new HR),this._$P.dragging.start(this,Ha,Hb,Hc,Hd,He,Hf,Hg)},Ha.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},Ha._releaseMem=function(){if(this._$P){var Ha=this._$P.cacheCanvas;Ha&&Ha.ctx&&(HU.recover("RenderContext",Ha.ctx),Ha.ctx.canvas.size(0,0),Ha.ctx=null);var Hb=this._$P._filterCache;Hb&&(Hb.destroy(),Hb.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},Ha._setDisplay=function(Ha){Ha||this._releaseMem(),He.prototype._setDisplay.call(this,Ha)},Ha.hitTestPoint=function(Ha,Hb){var Hc=this.globalToLocal(Hy.TEMP.setTo(Ha,Hb));return Ha=Hc.x,Hb=Hc.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?Hz.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(Ha,Hb)},Ha.getMousePoint=function(){return this.globalToLocal(Hy.TEMP.setTo(Hx.stage.mouseX,Hx.stage.mouseY))},Ha._getWords=function(){return null},Ha._addChildsToLayout=function(Ha){var Hb=this._getWords();if(null==Hb&&0==this._childs.length)return!1;if(Hb)for(var Hc=0,Hd=Hb.length;Hc<Hd;Hc++)Ha.push(Hb[Hc]);Hc=0;for(var He=this._childs.length;Hc<He;++Hc){var Hf=this._childs[Hc];Hf._style._enableLayout()&&Hf._addToLayout(Ha)}return!0},Ha._addToLayout=function(Ha){this._style.absolute||(this._style.block?Ha.push(this):this._addChildsToLayout(Ha)&&(this.x=this.y=0))},Ha._isChar=function(){return!1},Ha._getCSSStyle=function(){return this._style.getCSSStyle()},Ha._setAttributes=function(Ha,Hb){switch(Ha){case"x":this.x=parseFloat(Hb);break;case"y":this.y=parseFloat(Hb);break;case"width":this.width=parseFloat(Hb);break;case"height":this.height=parseFloat(Hb);break;default:this[Ha]=Hb}},Ha._layoutLater=function(){this.parent&&this.parent._layoutLater()},Hk(0,Ha,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(Ha){this._optimizeScrollRect!=Ha&&(this._optimizeScrollRect=Ha,this.conchModel&&this.conchModel.optimizeScrollRect(Ha))}),Hk(0,Ha,"customRenderEnable",null,function(Ha){if(Ha&&(this._renderType|=1024,HH.isConchNode)){Hc.CustomList.push(this);var Hb=new Hta("2d");Hb._setContext(new CanvasRenderingContext2D),this.customContext=new HI(0,0,Hb),Hb.context.setCanvasType&&Hb.context.setCanvasType(2),this.conchModel.custom(Hb.context)}}),Hk(0,Ha,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(Ha){this.cacheAs=Ha?this._$P.hasFilter?"none":"normal":"none"}),Hk(0,Ha,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(Ha){var Hb=this._$P.cacheCanvas;if(Ha!==(Hb?Hb.type:"none")){if("none"!==Ha)this._getBit(1)||this._setUpNoticeType(1),Hb||(Hb=this._set$P("cacheCanvas",HU.getItemByClass("cacheCanvas",Object))),Hb.type=Ha,Hb.reCache=!0,this._renderType|=16,"bitmap"==Ha&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(Hb){var Hc=Hb;Hc&&Hc.ctx&&(HU.recover("RenderContext",Hc.ctx),Hc.ctx.canvas.size(0,0),Hc.ctx=null),HU.recover("cacheCanvas",Hb)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),Hk(0,Ha,"zOrder",function(){return this._zOrder},function(Ha){this._zOrder!=Ha&&(this._zOrder=Ha,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(Ha),this._parent&&(Ha&&this._parent._set$P("hasZorder",!0),Hx.timer.callLater(this._parent,this.updateZOrder)))}),Hk(0,Ha,"rotation",function(){return this._style._tf.rotate},function(Ha){var Hb=this.getStyle();if(Hb._tf.rotate!==Ha){Hb.setRotate(Ha),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(Ha),this._renderType|=4;var Hc=this._parent;Hc&&0===Hc._repaint&&(Hc._repaint=1,Hc.parentRepaint())}}),Hk(0,Ha,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(Ha){this._width!==Ha&&(this._width=Ha,this.conchModel&&this.conchModel.size(Ha,this._height),this.repaint())}),Hk(0,Ha,"x",function(){return this._x},function(Ha){if(this._x!==Ha){if(this.destroyed)return;this._x=Ha,this.conchModel&&this.conchModel.pos(Ha,this._y);var Hb=this._parent;Hb&&0===Hb._repaint&&(Hb._repaint=1,Hb.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),Hk(0,Ha,"globalScaleY",function(){for(var Ha=1,Hb=this;Hb&&Hb!==Hx.stage;)Ha*=Hb.scaleY,Hb=Hb.parent;return Ha}),Hk(0,Ha,"hitArea",function(){return this._$P.hitArea},function(Ha){this._set$P("hitArea",Ha)}),Hk(0,Ha,"staticCache",function(){return this._$P.staticCache},function(Ha){this._set$P("staticCache",Ha),Ha||this.reCache()}),Hk(0,Ha,"texture",function(){return this._texture},function(Ha){this._texture!=Ha&&(this._texture=Ha,this.graphics.cleanByTexture(Ha,0,0))}),Hk(0,Ha,"y",function(){return this._y},function(Ha){if(this._y!==Ha){if(this.destroyed)return;this._y=Ha,this.conchModel&&this.conchModel.pos(this._x,Ha);var Hb=this._parent;Hb&&0===Hb._repaint&&(Hb._repaint=1,Hb.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),Hk(0,Ha,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(Ha){this._height!==Ha&&(this._height=Ha,this.conchModel&&this.conchModel.size(this._width,Ha),this.repaint())}),Hk(0,Ha,"blendMode",function(){return this._style.blendMode},function(Ha){this.getStyle().blendMode=Ha,this.conchModel&&this.conchModel.blendMode(Ha),Ha&&"source-over"!=Ha?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),Hk(0,Ha,"scaleX",function(){return this._style._tf.scaleX},function(Ha){var Hb=this.getStyle();if(Hb._tf.scaleX!==Ha){Hb.setScaleX(Ha),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Ha,Hb._tf.scaleY),this._renderType|=4;var Hc=this._parent;Hc&&0===Hc._repaint&&(Hc._repaint=1,Hc.parentRepaint())}}),Hk(0,Ha,"scaleY",function(){return this._style._tf.scaleY},function(Ha){var Hb=this.getStyle();if(Hb._tf.scaleY!==Ha){Hb.setScaleY(Ha),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Hb._tf.scaleX,Ha),this._renderType|=4;var Hc=this._parent;Hc&&0===Hc._repaint&&(Hc._repaint=1,Hc.parentRepaint())}}),Hk(0,Ha,"stage",function(){return Hx.stage}),Hk(0,Ha,"skewX",function(){return this._style._tf.skewX},function(Ha){var Hb=this.getStyle();if(Hb._tf.skewX!==Ha){Hb.setSkewX(Ha),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(Ha,Hb._tf.skewY),this._renderType|=4;var Hc=this._parent;Hc&&0===Hc._repaint&&(Hc._repaint=1,Hc.parentRepaint())}}),Hk(0,Ha,"scrollRect",function(){return this._style.scrollRect},function(Ha){this.getStyle().scrollRect=Ha,this.repaint(),Ha?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(Ha.x,Ha.y,Ha.width,Ha.height)):(this._renderType&=-129,this.conchModel&&(Hc.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),Hk(0,Ha,"skewY",function(){return this._style._tf.skewY},function(Ha){var Hb=this.getStyle();if(Hb._tf.skewY!==Ha){Hb.setSkewY(Ha),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(Hb._tf.skewX,Ha),this._renderType|=4;var Hc=this._parent;Hc&&0===Hc._repaint&&(Hc._repaint=1,Hc.parentRepaint())}}),Hk(0,Ha,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(Ha){this._tfChanged=!1,(this._transform=Ha)&&(this._x=Ha.tx,this._y=Ha.ty,Ha.tx=Ha.ty=0,this.conchModel&&this.conchModel.transform(Ha.a,Ha.b,Ha.c,Ha.d,this._x,this._y)),Ha?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),Hk(0,Ha,"pivotX",function(){return this._style._tf.translateX},function(Ha){this.getStyle().setTranslateX(Ha),this.conchModel&&this.conchModel.pivot(Ha,this._style._tf.translateY),this.repaint()}),Hk(0,Ha,"pivotY",function(){return this._style._tf.translateY},function(Ha){this.getStyle().setTranslateY(Ha),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,Ha),this.repaint()}),Hk(0,Ha,"alpha",function(){return this._style.alpha},function(Ha){this._style&&this._style.alpha!==Ha&&(Ha=Ha<0?0:1<Ha?1:Ha,this.getStyle().alpha=Ha,this.conchModel&&this.conchModel.alpha(Ha),1!==Ha?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),Hk(0,Ha,"visible",function(){return this._style.visible},function(Ha){this._style&&this._style.visible!==Ha&&(this.getStyle().visible=Ha,this.conchModel&&this.conchModel.visible(Ha),this.parentRepaint())}),Hk(0,Ha,"graphics",function(){return this._graphics||(this.graphics=HD.createGraphics())},function(Ha){this._graphics&&(this._graphics._sp=null),(this._graphics=Ha)?(this._renderType&=-2,this._renderType|=512,(Ha._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(Hc.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),Hk(0,Ha,"filters",function(){return this._$P.filters},function(Ha){Ha&&0===Ha.length&&(Ha=null),this._$P.filters!=Ha&&(this._set$P("filters",Ha?Ha.slice():null),HH.isConchApp&&(this.conchModel&&(Hc.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),HH.isWebGL&&(Ha&&Ha.length?this._renderType|=32:this._renderType&=-33),Ha&&0<Ha.length?(this._getBit(1)||this._setUpNoticeType(1),HH.isWebGL&&1==Ha.length&&Ha[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(HH.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),Hk(0,Ha,"parent",He.prototype._$get_parent,function(Ha){Hx.superSet(Haa,this,"parent",Ha),Ha&&this._getBit(2)&&this._$2__onDisplay()}),Hk(0,Ha,"mask",function(){return this._$P._mask},function(Ha){Ha&&this.mask&&this.mask._$P.maskParent||(Ha?(this.cacheAs="bitmap",this._set$P("_mask",Ha),Ha._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",Ha),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(Ha?Ha.conchModel:null),this._renderType|=64,this.parentRepaint())}),Hk(0,Ha,"mouseEnabled",function(){return 1<this._mouseEnableState},function(Ha){this._mouseEnableState=Ha?2:1}),Hk(0,Ha,"globalScaleX",function(){for(var Ha=1,Hb=this;Hb&&Hb!==Hx.stage;)Ha*=Hb.scaleX,Hb=Hb.parent;return Ha}),Hk(0,Ha,"mouseX",function(){return this.getMousePoint().x}),Hk(0,Ha,"mouseY",function(){return this.getMousePoint().y}),Hc.fromImage=function(Ha){return(new Hc).loadImage(Ha)},Hc._cachePool=[],Hc.CustomList=[],Hi(Hc,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=Hg.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),Hc}(Haa),Hma=function(Ha){function Hb(Ha){this._audio=null,this._onEnd=null,this._resumePlay=null,Hb.__super.call(this),this._onEnd=HY.bind(this.__onEnd,this),this._resumePlay=HY.bind(this.__resumePlay,this),Ha.addEventListener("ended",this._onEnd),this._audio=Ha}Hp(Hb,"laya.media.h5audio.AudioSoundChannel",Hda);var Hc=Hb.prototype;return Hc.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(Hx.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},Hc.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,HM.container.appendChild(this._audio),this._audio.play()}catch(Ha){this.event("error")}},Hc.play=function(Ha){this.isStopped=!1;try{this._audio.playbackRate=HC.playbackRate,this._audio.currentTime=this.startTime}catch(Ha){return void this._audio.addEventListener("canplay",this._resumePlay)}HC.addChannel(this),HM.container.appendChild(this._audio),!Ha&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},Hc.stop=function(){this.isStopped=!0,HC.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&HH.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),HM.onIE||this._audio!=Hca._musicAudio&&HU.recover("audio:"+this.url,this._audio),HM.removeElement(this._audio),this._audio=null)},Hc.pause=function(){this.isStopped=!0,HC.removeChannel(this),"pause"in this._audio&&this._audio.pause()},Hc.resume=function(){this._audio&&(this.isStopped=!1,HC.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},Hk(0,Hc,"position",function(){return this._audio?this._audio.currentTime:0}),Hk(0,Hc,"duration",function(){return this._audio?this._audio.duration:0}),Hk(0,Hc,"volume",function(){return this._audio?this._audio.volume:1},function(Ha){this._audio&&(this._audio.volume=Ha)}),Hb}(),Hna=function(Ha){function Hb(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=Hfa.ctx,Hb.__super.call(this),this._onPlayEnd=HY.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}Hp(Hb,"laya.media.webaudio.WebAudioSoundChannel",Hda);var Hc=Hb.prototype;return Hc.play=function(Ha){if(HC.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var Hb=this.context,Hc=this.gain,Hd=Hb.createBufferSource();(this.bufferSource=Hd).buffer=this.audioBuffer,Hd.connect(Hc),Hc&&Hc.disconnect(),Hc.connect(Hb.destination),Hd.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=HM.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(Hd.loop=!0),Hd.playbackRate.setTargetAtTime?Hd.playbackRate.setTargetAtTime(HC.playbackRate,this.context.currentTime,.1):Hd.playbackRate.value=HC.playbackRate,Hd.start(0,this.startTime),!Ha&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},Hc.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(Hx.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},Hc._clearBufferSource=function(){if(this.bufferSource){var Ha=this.bufferSource;Ha.stop?Ha.stop(0):Ha.noteOff(0),Ha.disconnect(0),Ha.onended=null,Hb._tryCleanFailed||this._tryClearBuffer(Ha),this.bufferSource=null}},Hc._tryClearBuffer=function(Ha){try{Ha.buffer=null}catch(Ha){Hb._tryCleanFailed=!0}},Hc.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,HC.removeChannel(this),this.startHandler=null,this.completeHandler=null},Hc.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,HC.removeChannel(this)},Hc.resume=function(){this.startTime=this._pauseTime,this.play(!1)},Hk(0,Hc,"position",function(){return this.bufferSource?(HM.now()-this._startTime)/1e3+this.startTime:0}),Hk(0,Hc,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),Hk(0,Hc,"volume",function(){return this._volume},function(Ha){this.isStopped||(this._volume=Ha,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(Ha,this.context.currentTime,.1):this.gain.gain.value=Ha)}),Hb._tryCleanFailed=!1,Hb}(),Hoa=function(Ha){function Hb(){Hb.__super.call(this),this._w=0,this._h=0}Hp(Hb,"laya.resource.Bitmap",Hja);var Hc=Hb.prototype;return Hk(0,Hc,"width",function(){return this._w}),Hk(0,Hc,"height",function(){return this._h}),Hk(0,Hc,"source",function(){return this._source}),Hb}(),Hpa=function(Hb){function Ha(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,Ha.__super.call(this),this._interval=Hd.animationInterval,this._setUpNoticeType(1)}Hp(Ha,"laya.display.AnimationPlayerBase",Hb);var Hc=Ha.prototype;return Hc.play=function(Ha,Hb,Hc,Hd){void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=!0),void 0===Hc&&(Hc=""),void 0===Hd&&(Hd=!0),this._isPlaying=!0,this.index="string"==typeof Ha?this._getFrameByLabel(Ha):Ha,this.loop=Hb,this._actionName=Hc,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},Hc._getFrameByLabel=function(Ha){var Hb=0;for(Hb=0;Hb<this._count;Hb++)if(this._labels[Hb]&&0<=this._labels[Hb].indexOf(Ha))return Hb;return 0},Hc._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},Hc._setControlNode=function(Ha){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=Ha)&&Ha!=this&&(Ha.on("display",this,this._checkResumePlaying),Ha.on("undisplay",this,this._checkResumePlaying))},Hc._setDisplay=function(Ha){Hb.prototype._setDisplay.call(this,Ha),this._checkResumePlaying()},Hc._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},Hc.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},Hc.addLabel=function(Ha,Hb){this._labels||(this._labels={}),this._labels[Hb]||(this._labels[Hb]=[]),this._labels[Hb].push(Ha)},Hc.removeLabel=function(Ha){if(Ha){if(this._labels)for(var Hb in this._labels)this._removeLabelFromLabelList(this._labels[Hb],Ha)}else this._labels=null},Hc._removeLabelFromLabelList=function(Ha,Hb){if(Ha)for(var Hc=Ha.length-1;0<=Hc;Hc--)Ha[Hc]==Hb&&Ha.splice(Hc,1)},Hc.gotoAndStop=function(Ha){this.index="string"==typeof Ha?this._getFrameByLabel(Ha):Ha,this.stop()},Hc._displayToIndex=function(Ha){},Hc.clear=function(){this.stop(),this._labels=null},Hk(0,Hc,"interval",function(){return this._interval},function(Ha){this._interval!=Ha&&(this._frameRateChanged=!0,this._interval=Ha,this._isPlaying&&0<Ha&&this.timerLoop(Ha,this,this._frameLoop,null,!0,!0))}),Hk(0,Hc,"isPlaying",function(){return this._isPlaying}),Hk(0,Hc,"index",function(){return this._index},function(Ha){if(this._index=Ha,this._displayToIndex(Ha),this._labels&&this._labels[Ha])for(var Hb=this._labels[Ha],Hc=0,Hd=Hb.length;Hc<Hd;Hc++)this.event("label",Hb[Hc])}),Hk(0,Hc,"count",function(){return this._count}),Ha.WRAP_POSITIVE=0,Ha.WRAP_REVERSE=1,Ha.WRAP_PINGPONG=2,Ha}(Hla),Hqa=function(Hb){function Hn(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,Hn.__super.call(this),this.overflow=Hn.VISIBLE,this._style=new Hba(this),this._style.wordWrap=!1}Hp(Hn,"laya.display.Text",Hb);var Ha=Hn.prototype;return Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,Ha),this._lines=null,this._words&&(this._words.length=0,this._words=null)},Ha._getBoundPointsM=function(Ha){void 0===Ha&&(Ha=!1);var Hb=Hz.TEMP;return Hb.setTo(0,0,this.width,this.height),Hb._getBoundPoints()},Ha.getGraphicBounds=function(Ha){void 0===Ha&&(Ha=!1);var Hb=Hz.TEMP;return Hb.setTo(0,0,this.width,this.height),Hb},Ha._getCSSStyle=function(){return this._style},Ha.lang=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk){if(Ha=Hn.langPacks&&Hn.langPacks[Ha]?Hn.langPacks[Ha]:Ha,arguments.length<2)this._text=Ha;else{for(var Hl=0,Hm=arguments.length;Hl<Hm;Hl++)Ha=Ha.replace("{"+Hl+"}",arguments[Hl+1]);this._text=Ha}},Ha._isPassWordMode=function(){var Ha=this._style.password;return"prompt"in this&&this.prompt==this._text&&(Ha=!1),Ha},Ha._getPassWordTxt=function(Ha){var Hb;Hb="";for(var Hc=Ha.length;0<Hc;Hc--)Hb+="●";return Hb},Ha.renderText=function(Ha,Hb){var Hc=this.graphics;Hc.clear(!0);var Hd=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(HM.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);HM.context.font=Hd;var He=this.padding,Hf=He[3],Hg="left",Hh=this._lines,Hi=this.leading+this._charSize.height,Hj=this._currBitmapFont;Hj&&(Hi=this.leading+Hj.getMaxHeight());var Hk=He[0];if(!Hj&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(Hg="right",Hf=this._width-He[1]):"center"==this.align&&(Hg="center",Hf=.5*this._width+He[3]-He[1])),0<this._height){var Hl=this._textHeight>this._height?"top":this.valign;"middle"===Hl?Hk=.5*(this._height-Hb*Hi)+He[0]-He[2]:"bottom"===Hl&&(Hk=this._height-Hb*Hi-He[2])}var Hm=this._style;if(Hj&&Hj.autoScaleSize)var Hn=Hj.fontSize/this.fontSize;if(this._clipPoint)if(Hc.save(),Hj&&Hj.autoScaleSize){var Ho=0,Hp=0;Ho=this._width?this._width-He[3]-He[1]:this._textWidth,Hp=this._height?this._height-He[0]-He[2]:this._textHeight,Ho*=Hn,Hp*=Hn,Hc.clipRect(He[3],He[0],Ho,Hp)}else Hc.clipRect(He[3],He[0],this._width?this._width-He[3]-He[1]:this._textWidth,this._height?this._height-He[0]-He[2]:this._textHeight);var Hq=Hm.password;"prompt"in this&&this.prompt==this._text&&(Hq=!1);for(var Hr=0,Hs=0,Ht=Math.min(this._lines.length,Hb+Ha)||1,Hu=Ha;Hu<Ht;Hu++){var Hv,Hw=Hh[Hu];if(Hq){var Hx=Hw.length;Hw="";for(var Hy=Hx;0<Hy;Hy--)Hw+="●"}if(Hr=Hf-(this._clipPoint?this._clipPoint.x:0),Hs=Hk+Hi*Hu-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(Hg,Hr,Hs,Hu),Hj){var Hz=this.width;Hj.autoScaleSize&&(Hz=this.width*Hn),Hj.drawText(Hw,this,Hr,Hs,this.align,Hz)}else HH.isWebGL?(this._words||(this._words=[]),(Hv=this._words.length>Hu-Ha?this._words[Hu-Ha]:new H_).setText(Hw)):Hv=Hw,Hm.stroke?Hc.fillBorderText(Hv,Hr,Hs,Hd,this.color,Hm.strokeColor,Hm.stroke,Hg):Hc.fillText(Hv,Hr,Hs,Hd,this.color,Hg)}if(Hj&&Hj.autoScaleSize){var HA=1/Hn;this.scale(HA,HA)}this._clipPoint&&Hc.restore(),this._startX=Hf,this._startY=Hk},Ha.drawUnderline=function(Ha,Hb,Hc,Hd){var He=this._lineWidths[Hd];switch(Ha){case"center":Hb-=He/2;break;case"right":Hb-=He}Hc+=this._charSize.height,this._graphics.drawLine(Hb,Hc,Hb+He,Hc,this.underlineColor||this.color,1)},Ha.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);HM.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new Hy(0,0)):this._clipPoint=null;var Ha=this._lines.length;if(this.overflow!=Hn.VISIBLE){var Hb=this.overflow==Hn.HIDDEN?Math.floor:Math.ceil;Ha=Math.min(Ha,Hb((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var Hc=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(Hc,Ha),this.repaint()},Ha.evalTextSize=function(){var Ha,Hb=NaN;Ha=Math.max.apply(this,this._lineWidths),Hb=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],Ha==this._textWidth&&Hb==this._textHeight||(this._textWidth=Ha,this._textHeight=Hb,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},Ha.checkEnabledViewportOrNot=function(){return this.overflow==Hn.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},Ha.changeText=function(Ha){this._text!==Ha&&(this.lang(Ha+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},Ha.parseLines=function(Ha){var Hb=this.wordWrap||this.overflow==Hn.HIDDEN;if(Hb)var Hc=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var Hd=HM.context.measureText(Hn._testWord);HH.isConchApp&&0===Hd.width&&0===Hd.height&&(Hd=HM.context.measureText("W")),this._charSize.width=Hd.width,this._charSize.height=Hd.height||this.fontSize}for(var He=Ha.replace(/\r\n/g,"\n").split("\n"),Hf=0,Hg=He.length;Hf<Hg;Hf++){var Hh=He[Hf];Hb?this.parseLine(Hh,Hc):(this._lineWidths.push(this.getTextWidth(Hh)),this._lines.push(Hh))}},Ha.parseLine=function(Ha,Hb){HM.context;var Hc,Hd=this._lines,He=0,Hf=NaN,Hg=NaN,Hh=0;if((Hf=this.getTextWidth(Ha))<=Hb)return Hd.push(Ha),void this._lineWidths.push(Hf);Hf=this._charSize.width,0==(He=Math.floor(Hb/Hf))&&(He=1),Hg=Hf=this.getTextWidth(Ha.substring(0,He));for(var Hi=He,Hj=Ha.length;Hi<Hj;Hi++)if(Hb<(Hg+=Hf=this.getTextWidth(Ha.charAt(Hi))))if(this.wordWrap){var Hk=Ha.substring(Hh,Hi);if(Hk.charCodeAt(Hk.length-1)<255?(Hc=/(?:\w|-)+$/.exec(Hk))&&(Hi=Hc.index+Hh,0==Hc.index?Hi+=Hk.length:Hk=Ha.substring(Hh,Hi)):Hn.RightToLeft&&(Hc=/([\u0600-\u06FF])+$/.exec(Hk))&&(Hi=Hc.index+Hh,0==Hc.index?Hi+=Hk.length:Hk=Ha.substring(Hh,Hi)),Hd.push(Hk),this._lineWidths.push(Hg-Hf),!((Hh=Hi)+He<Hj)){Hd.push(Ha.substring(Hh,Hj)),this._lineWidths.push(this.getTextWidth(Hd[Hd.length-1])),Hh=-1;break}Hi+=He,Hg=Hf=this.getTextWidth(Ha.substring(Hh,Hi)),Hi--}else if(this.overflow==Hn.HIDDEN)return Hd.push(Ha.substring(0,Hi)),void this._lineWidths.push(this.getTextWidth(Hd[Hd.length-1]));this.wordWrap&&-1!=Hh&&(Hd.push(Ha.substring(Hh,Hj)),this._lineWidths.push(this.getTextWidth(Hd[Hd.length-1])))},Ha.getTextWidth=function(Ha){return this._currBitmapFont?this._currBitmapFont.getTextWidth(Ha):HM.context.measureText(Ha).width},Ha.getWordWrapWidth=function(){var Ha=this.padding,Hb=NaN;return(Hb=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(Hb=this.wordWrap?100:HM.width),Hb<=0&&(Hb=100),Hb-Ha[3]-Ha[1]},Ha.getCharPoint=function(Ha,Hb){this._isChanged&&Hx.timer.runCallLater(this,this.typeset);for(var Hc=0,Hd=this._lines,He=0,Hf=0,Hg=Hd.length;Hf<Hg;Hf++){if(Ha<(Hc+=Hd[Hf].length)){var Hh=Hf;break}He=Hc}var Hi=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;HM.context.font=Hi;var Hj=this.getTextWidth(this._text.substring(He,Ha));return(Hb||new Hy).setTo(this._startX+Hj-(this._clipPoint?this._clipPoint.x:0),this._startY+Hh*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},Hk(0,Ha,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(Ha){Ha!=this._width&&(Hx.superSet(Hla,this,"width",Ha),this.isChanged=!0)}),Hk(0,Ha,"textWidth",function(){return this._isChanged&&Hx.timer.runCallLater(this,this.typeset),this._textWidth}),Hk(0,Ha,"height",function(){return this._height?this._height:this.textHeight},function(Ha){Ha!=this._height&&(Hx.superSet(Hla,this,"height",Ha),this.isChanged=!0)}),Hk(0,Ha,"textHeight",function(){return this._isChanged&&Hx.timer.runCallLater(this,this.typeset),this._textHeight}),Hk(0,Ha,"padding",function(){return this._getCSSStyle().padding},function(Ha){this._getCSSStyle().padding=Ha,this.isChanged=!0}),Hk(0,Ha,"bold",function(){return this._getCSSStyle().bold},function(Ha){this._getCSSStyle().bold=Ha,this.isChanged=!0}),Hk(0,Ha,"text",function(){return this._text||""},function(Ha){this._text!==Ha&&(this.lang(Ha+""),this.isChanged=!0,this.event("change"))}),Hk(0,Ha,"color",function(){return this._getCSSStyle().color},function(Ha){this._getCSSStyle().color!=Ha&&(this._getCSSStyle().color=Ha,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),Hk(0,Ha,"font",function(){return this._getCSSStyle().fontFamily},function(Ha){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),Hn._bitmapFonts&&Hn._bitmapFonts[Ha]&&(this._currBitmapFont=Hn._bitmapFonts[Ha]),this._getCSSStyle().fontFamily=Ha,this.isChanged=!0}),Hk(0,Ha,"fontSize",function(){return this._getCSSStyle().fontSize},function(Ha){this._getCSSStyle().fontSize=Ha,this.isChanged=!0}),Hk(0,Ha,"italic",function(){return this._getCSSStyle().italic},function(Ha){this._getCSSStyle().italic=Ha,this.isChanged=!0}),Hk(0,Ha,"align",function(){return this._getCSSStyle().align},function(Ha){this._getCSSStyle().align=Ha,this.isChanged=!0}),Hk(0,Ha,"valign",function(){return this._getCSSStyle().valign},function(Ha){this._getCSSStyle().valign=Ha,this.isChanged=!0}),Hk(0,Ha,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(Ha){this._getCSSStyle().wordWrap=Ha,this.isChanged=!0}),Hk(0,Ha,"leading",function(){return this._getCSSStyle().leading},function(Ha){this._getCSSStyle().leading=Ha,this.isChanged=!0}),Hk(0,Ha,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(Ha){this._getCSSStyle().backgroundColor=Ha,this.isChanged=!0}),Hk(0,Ha,"borderColor",function(){return this._getCSSStyle().borderColor},function(Ha){this._getCSSStyle().borderColor=Ha,this.isChanged=!0}),Hk(0,Ha,"stroke",function(){return this._getCSSStyle().stroke},function(Ha){this._getCSSStyle().stroke=Ha,this.isChanged=!0}),Hk(0,Ha,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(Ha){this._getCSSStyle().strokeColor=Ha,this.isChanged=!0}),Hk(0,Ha,"isChanged",null,function(Ha){this._isChanged!==Ha&&(this._isChanged=Ha)&&Hx.timer.callLater(this,this.typeset)}),Hk(0,Ha,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(Ha){if(!(this.overflow!=Hn.SCROLL||this.textWidth<this._width)&&this._clipPoint){Ha=Ha<this.padding[3]?this.padding[3]:Ha;var Hb=this._textWidth-this._width;Ha=Hb<Ha?Hb:Ha;var Hc=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=Ha,this.renderText(this._lastVisibleLineIndex,Hc)}}),Hk(0,Ha,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(Ha){if(!(this.overflow!=Hn.SCROLL||this.textHeight<this._height)&&this._clipPoint){Ha=Ha<this.padding[0]?this.padding[0]:Ha;var Hb=this._textHeight-this._height,Hc=(Ha=Hb<Ha?Hb:Ha)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=Hc;var Hd=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=Ha,this.renderText(Hc,Hd)}}),Hk(0,Ha,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),Hk(0,Ha,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),Hk(0,Ha,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),Hk(0,Ha,"underlineColor",function(){return this._underlineColor},function(Ha){this._underlineColor=Ha,this._isChanged=!0,this.typeset()}),Hn.registerBitmapFont=function(Ha,Hb){Hn._bitmapFonts||(Hn._bitmapFonts={}),Hn._bitmapFonts[Ha]=Hb},Hn.unregisterBitmapFont=function(Ha,Hb){if(void 0===Hb&&(Hb=!0),Hn._bitmapFonts&&Hn._bitmapFonts[Ha]){var Hc=Hn._bitmapFonts[Ha];Hb&&Hc.destroy(),delete Hn._bitmapFonts[Ha]}},Hn.setTextRightToLeft=function(){var Ha;(Ha=HM.canvas.source.style).display="none",Ha.position="absolute",Ha.direction="rtl",HH._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,HM.document.body.appendChild(HM.canvas.source)},Hn.supportFont=function(Ha){HM.context.font="10px sans-serif";var Hb=HM.context.measureText("abcji").width;HM.context.font="10px "+Ha;var Hc=HM.context.measureText("abcji").width;return console.log(Hb,Hc),Hb!==Hc},Hn._testWord="游",Hn.langPacks=null,Hn.VISIBLE="visible",Hn.SCROLL="scroll",Hn.HIDDEN="hidden",Hn.CharacterCache=!0,Hn.RightToLeft=!1,Hn._bitmapFonts=null,Hi(Hn,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),Hn}(Hla),Hra=function(Hl){function Hg(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",Hg.__super.call(this),this.offset=new Hy,this._canvasTransform=new HE,this._previousOrientation=HM.window.orientation;var Hb=this;this.transform=HE.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var Ha=HM.window,Hc=this;Ha.addEventListener("focus",function(){Hb._isFocused=!0,Hc.event("focus"),Hc.event("focuschange")}),Ha.addEventListener("blur",function(){Hb._isFocused=!1,Hc.event("blur"),Hc.event("focuschange"),Hc._isInputting()&&(Hva.inputElement.target.focus=!1)});var Hd="visibilityState",He="visibilitychange",Hf=Ha.document;void 0!==Hf.hidden?(He="visibilitychange",Hd="visibilityState"):void 0!==Hf.mozHidden?(He="mozvisibilitychange",Hd="mozVisibilityState"):void 0!==Hf.msHidden?(He="msvisibilitychange",Hd="msVisibilityState"):void 0!==Hf.webkitHidden&&(He="webkitvisibilitychange",Hd="webkitVisibilityState"),Ha.document.addEventListener(He,function(){"hidden"==HM.document[Hd]?Hc._setStageVisible(!1):Hc._setStageVisible(!0)}),Ha.document.addEventListener("qbrowserVisibilityChange",function(Ha){Hc._setStageVisible(!Ha.hidden)}),Ha.addEventListener("resize",function(){var Ha=HM.window.orientation;null!=Ha&&Ha!=Hb._previousOrientation&&Hc._isInputting()&&(Hva.inputElement.target.focus=!1),Hb._previousOrientation=Ha,Hc._isInputting()||Hc._resetCanvas()}),Ha.addEventListener("orientationchange",function(Ha){Hc._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),HM.onMobile&&this.on("mousedown",this,this._onmouseMove)}Hp(Hg,"laya.display.Stage",Hl);var Ha=Hg.prototype;return Ha._setStageVisible=function(Ha){this._isVisibility!=Ha&&(this._isVisibility=Ha,this._isVisibility||this._isInputting()&&(Hva.inputElement.target.focus=!1),this.event("visibilitychange"))},Ha._isInputting=function(){return HM.onMobile&&Hva.isInputting},Ha._changeCanvasSize=function(){this.setScreenSize(HM.clientWidth*HM.pixelRatio,HM.clientHeight*HM.pixelRatio)},Ha._resetCanvas=function(){if(this.screenAdaptationEnabled){var Ha=HH._mainCanvas;Ha.source.style;Ha.size(1,1),Hx.timer.once(100,this,this._changeCanvasSize)}},Ha.setScreenSize=function(Ha,Hb){var Hc=!1;if("none"!==this._screenMode&&(Hc=(Ha/Hb<1?"vertical":"horizontal")!==this._screenMode)){var Hd=Hb;Hb=Ha,Ha=Hd}this.canvasRotation=Hc;var He=HH._mainCanvas,Hf=He.source.style,Hg=this._canvasTransform.identity(),Hh=this._scaleMode,Hi=Ha/this.designWidth,Hj=Hb/this.designHeight,Hk=this.designWidth,Hl=this.designHeight,Hm=Ha,Hn=Hb,Ho=HM.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,Hh){case"noscale":Hi=Hj=1,Hm=this.designWidth,Hn=this.designHeight;break;case"showall":Hi=Hj=Math.min(Hi,Hj),Hk=Hm=Math.round(this.designWidth*Hi),Hl=Hn=Math.round(this.designHeight*Hj);break;case"noborder":Hi=Hj=Math.max(Hi,Hj),Hm=Math.round(this.designWidth*Hi),Hn=Math.round(this.designHeight*Hj);break;case"full":Hi=Hj=1,this._width=Hk=Ha,this._height=Hl=Hb;break;case"fixedwidth":Hj=Hi,this._height=Hl=Math.round(Hb/Hi);break;case"fixedheight":Hi=Hj,this._width=Hk=Math.round(Ha/Hj);break;case"fixedauto":Ha/Hb<this.designWidth/this.designHeight?(Hj=Hi,this._height=Hl=Math.round(Hb/Hi)):(Hi=Hj,this._width=Hk=Math.round(Ha/Hj))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,Hk=Hk+1&2147483646,Hl=Hl+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),Hi*=this.scaleX,Hj*=this.scaleY,1===Hi&&1===Hj?this.transform.identity():(this.transform.a=this._formatData(Hi/(Hm/Hk)),this.transform.d=this._formatData(Hj/(Hn/Hl)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),He.size(Hk,Hl),HD.changeWebGLSize(Hk,Hl),Hg.scale(Hm/Hk/Ho,Hn/Hl/Ho),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(Ha-Hm)/Ho:this.offset.x=.5*(Ha-Hm)/Ho,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(Hb-Hn)/Ho:this.offset.y=.5*(Hb-Hn)/Ho,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),Hg.translate(this.offset.x,this.offset.y),this.canvasDegree=0,Hc&&("horizontal"===this._screenMode?(Hg.rotate(Math.PI/2),Hg.translate(Hb/Ho,0),this.canvasDegree=90):(Hg.rotate(-Math.PI/2),Hg.translate(0,Ha/Ho),this.canvasDegree=-90)),Hg.a=this._formatData(Hg.a),Hg.d=this._formatData(Hg.d),Hg.tx=this._formatData(Hg.tx),Hg.ty=this._formatData(Hg.ty),Hf.transformOrigin=Hf.webkitTransformOrigin=Hf.msTransformOrigin=Hf.mozTransformOrigin=Hf.oTransformOrigin="0px 0px 0px",Hf.transform=Hf.webkitTransform=Hf.msTransform=Hf.mozTransform=Hf.oTransform="matrix("+Hg.toString()+")",Hg.translate(parseInt(Hf.left)||0,parseInt(Hf.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},Ha._formatData=function(Ha){return Math.abs(Ha)<1e-6?0:Math.abs(1-Ha)<.001?0<Ha?1:-1:Ha},Ha.getMousePoint=function(){return Hy.TEMP.setTo(this.mouseX,this.mouseY)},Ha.repaint=function(){this._repaint=1},Ha.parentRepaint=function(){},Ha._loop=function(){return this.render(HH.context,0,0),!0},Ha._onmouseMove=function(Ha){this._mouseMoveTime=HM.now()},Ha.getTimeFromFrameStart=function(){return HM.now()-this._frameStartTime},Ha.render=function(Ha,Hb,Hc){if("sleep"===this._frameRate&&!HH.isConchApp){var Hd=HM.now();if(!(1e3<=Hd-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(HV.loopCount++,Ho.instance.runEvent(),Hx.timer._update()));this._frameStartTime=Hd}if(this._renderCount++,HH.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=HM.now();var He="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),Hf=this._renderCount%2==0;if(HV.renderSlow=!He,He||Hf||HH.isConchApp){var Hg;HV.loopCount++,Ho.instance.runEvent(),Hx.timer._update(),HD.update3DLoop();var Hh=0,Hi=0;if(HH.isConchNode)for(Hh=0,Hi=this._scenes.length;Hh<Hi;Hh++)(Hg=this._scenes[Hh])&&Hg._updateSceneConch();else for(Hh=0,Hi=this._scenes.length;Hh<Hi;Hh++)(Hg=this._scenes[Hh])&&Hg._updateScene();if(HH.isConchNode){var Hj=Hla.CustomList;for(Hh=0,Hi=Hj.length;Hh<Hi;Hh++){var Hk=Hj[Hh];Hk.customRender(Hk.customContext,0,0)}return}}HH.isConchNode||this.renderingEnabled&&(He||!Hf||HH.isConchWebGL)&&(HH.isWebGL?HH.WebGL.mainContext&&!HH.WebGL.mainContext.isContextLost()&&(Ha.clear(),Hl.prototype.render.call(this,Ha,Hb,Hc),HV._show&&HV._sp&&HV._sp.render(Ha,Hb,Hc),HD.clear(this._bgColor),HD.beginFlush(),Ha.flush(),HD.endFinish(),HZ.instance&&HZ.getInstance().endDispose()):(HD.clear(this._bgColor),Hl.prototype.render.call(this,Ha,Hb,Hc),HV._show&&HV._sp&&HV._sp.render(Ha,Hb,Hc)))}else this._renderCount%5==0&&(HV.loopCount++,Ho.instance.runEvent(),Hx.timer._update())},Ha._requestFullscreen=function(){var Ha=HM.document.documentElement;Ha.requestFullscreen?Ha.requestFullscreen():Ha.mozRequestFullScreen?Ha.mozRequestFullScreen():Ha.webkitRequestFullscreen?Ha.webkitRequestFullscreen():Ha.msRequestFullscreen&&Ha.msRequestFullscreen()},Ha._fullScreenChanged=function(){Hx.stage.event("fullscreenchange")},Ha.exitFullscreen=function(){var Ha=HM.document;Ha.exitFullscreen?Ha.exitFullscreen():Ha.mozCancelFullScreen?Ha.mozCancelFullScreen():Ha.webkitExitFullscreen&&Ha.webkitExitFullscreen()},Hk(0,Ha,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),Hk(0,Ha,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),Hk(0,Ha,"frameRate",function(){return this._frameRate},function(Ha){if(this._frameRate=Ha,HH.isConchApp)switch(this._frameRate){case"slow":HM.window.conch&&HM.window.conchConfig.setSlowFrame&&HM.window.conchConfig.setSlowFrame(!0);break;case"fast":HM.window.conch&&HM.window.conchConfig.setSlowFrame&&HM.window.conchConfig.setSlowFrame(!1);break;case"mouse":HM.window.conch&&HM.window.conchConfig.setMouseFrame&&HM.window.conchConfig.setMouseFrame(2e3);break;case"sleep":HM.window.conch&&HM.window.conchConfig.setLimitFPS&&HM.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),Hk(0,Ha,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),Hk(0,Ha,"width",Hl.prototype._$get_width,function(Ha){this.designWidth=Ha,Hx.superSet(Hla,this,"width",Ha),Hx.timer.callLater(this,this._changeCanvasSize)}),Hk(0,Ha,"alignH",function(){return this._alignH},function(Ha){this._alignH=Ha,Hx.timer.callLater(this,this._changeCanvasSize)}),Hk(0,Ha,"isFocused",function(){return this._isFocused}),Hk(0,Ha,"height",Hl.prototype._$get_height,function(Ha){this.designHeight=Ha,Hx.superSet(Hla,this,"height",Ha),Hx.timer.callLater(this,this._changeCanvasSize)}),Hk(0,Ha,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||HE.create()},Hl.prototype._$set_transform),Hk(0,Ha,"isVisibility",function(){return this._isVisibility}),Hk(0,Ha,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),Hk(0,Ha,"scaleMode",function(){return this._scaleMode},function(Ha){this._scaleMode=Ha,Hx.timer.callLater(this,this._changeCanvasSize)}),Hk(0,Ha,"alignV",function(){return this._alignV},function(Ha){this._alignV=Ha,Hx.timer.callLater(this,this._changeCanvasSize)}),Hk(0,Ha,"bgColor",function(){return this._bgColor},function(Ha){this._bgColor=Ha,this.conchModel&&this.conchModel.bgColor(Ha),HH.isWebGL&&(Ha?Hg._wgColor=HQ.create(Ha)._color:HM.onMiniGame||(Hg._wgColor=null)),HM.onLimixiu?Hg._wgColor=HQ.create(Ha)._color:HH.canvas.style.background=Ha||"none"}),Hk(0,Ha,"mouseX",function(){return Math.round(Ho.instance.mouseX/this.clientScaleX)}),Hk(0,Ha,"mouseY",function(){return Math.round(Ho.instance.mouseY/this.clientScaleY)}),Hk(0,Ha,"screenMode",function(){return this._screenMode},function(Ha){this._screenMode=Ha}),Hk(0,Ha,"visible",Hl.prototype._$get_visible,function(Ha){this.visible!==Ha&&(Hx.superSet(Hla,this,"visible",Ha),HH._mainCanvas.source.style.visibility=Ha?"visible":"hidden")}),Hk(0,Ha,"fullScreenEnabled",null,function(Ha){var Hb=HM.document,Hc=HH.canvas;Ha?(Hc.addEventListener("mousedown",this._requestFullscreen),Hc.addEventListener("touchstart",this._requestFullscreen),Hb.addEventListener("fullscreenchange",this._fullScreenChanged),Hb.addEventListener("mozfullscreenchange",this._fullScreenChanged),Hb.addEventListener("webkitfullscreenchange",this._fullScreenChanged),Hb.addEventListener("msfullscreenchange",this._fullScreenChanged)):(Hc.removeEventListener("mousedown",this._requestFullscreen),Hc.removeEventListener("touchstart",this._requestFullscreen),Hb.removeEventListener("fullscreenchange",this._fullScreenChanged),Hb.removeEventListener("mozfullscreenchange",this._fullScreenChanged),Hb.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),Hb.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),Hg.SCALE_NOSCALE="noscale",Hg.SCALE_EXACTFIT="exactfit",Hg.SCALE_SHOWALL="showall",Hg.SCALE_NOBORDER="noborder",Hg.SCALE_FULL="full",Hg.SCALE_FIXED_WIDTH="fixedwidth",Hg.SCALE_FIXED_HEIGHT="fixedheight",Hg.SCALE_FIXED_AUTO="fixedauto",Hg.ALIGN_LEFT="left",Hg.ALIGN_RIGHT="right",Hg.ALIGN_CENTER="center",Hg.ALIGN_TOP="top",Hg.ALIGN_MIDDLE="middle",Hg.ALIGN_BOTTOM="bottom",Hg.SCREEN_NONE="none",Hg.SCREEN_HORIZONTAL="horizontal",Hg.SCREEN_VERTICAL="vertical",Hg.FRAME_FAST="fast",Hg.FRAME_SLOW="slow",Hg.FRAME_MOUSE="mouse",Hg.FRAME_SLEEP="sleep",Hg.FRAME_MOUSE_THREDHOLD=2e3,Hi(Hg,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),Hg}(Hla),Hsa=(function(Ha){function Hb(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,Hb.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}Hp(Hb,"laya.media.SoundNode",Hla);var Hc=Hb.prototype;Hc._onParentChange=function(){this.target=this.parent},Hc.play=function(Ha,Hb){void 0===Ha&&(Ha=1),isNaN(Ha)&&(Ha=1),this.url&&(this.stop(),this._channel=HC.playSound(this.url,Ha,null,Hb))},Hc.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},Hc._setPlayAction=function(Ha,Hb,Hc,Hd){void 0===Hd&&(Hd=!0),this[Hc]&&Ha&&(Hd?Ha.on(Hb,this,this[Hc]):Ha.off(Hb,this,this[Hc]))},Hc._setPlayActions=function(Ha,Hb,Hc,Hd){if(void 0===Hd&&(Hd=!0),Ha&&Hb){var He,Hf=Hb.split(","),Hg=0;for(He=Hf.length,Hg=0;Hg<He;Hg++)this._setPlayAction(Ha,Hf[Hg],Hc,Hd)}},Hk(0,Hc,"playEvent",null,function(Ha){(this._playEvents=Ha)&&this._tar&&this._setPlayActions(this._tar,Ha,"play")}),Hk(0,Hc,"target",null,function(Ha){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=Ha,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),Hk(0,Hc,"stopEvent",null,function(Ha){(this._stopEvents=Ha)&&this._tar&&this._setPlayActions(this._tar,Ha,"stop")})}(),function(Ha){function Hb(){this._src=null,this._onload=null,this._onerror=null,Hb.__super.call(this)}Hp(Hb,"laya.resource.FileBitmap",Hoa);var Hc=Hb.prototype;return Hk(0,Hc,"src",function(){return this._src},function(Ha){this._src=Ha}),Hk(0,Hc,"onload",null,function(Ha){}),Hk(0,Hc,"onerror",null,function(Ha){}),Hb}()),Hta=function(Ha){function Hc(Ha,Hb){this._is2D=!1,Hc.__super.call(this);var Hd=this;if(this._source=this,"2D"===Ha||"AUTO"===Ha&&!HH.isWebGL){this._is2D=!0,this._source=Hb||HM.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var He=this;He.getContext=function(Ha,Hb){if(Hd._ctx)return Hd._ctx;var Hc=Hd._ctx=Hd._source.getContext(Ha,Hb);return Hc&&(Hc._canvas=He,HH.isFlash||HM.onLimixiu||(Hc.size=function(Ha,Hb){})),Hc}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}Hp(Hc,"laya.resource.HTMLCanvas",Hoa);var Hb=Hc.prototype;return Hb.clear=function(){this._ctx&&this._ctx.clear()},Hb.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},Hb.release=function(){},Hb._setContext=function(Ha){this._ctx=Ha},Hb.getContext=function(Ha,Hb){return this._ctx?this._ctx:this._ctx=Hc._createContext(this)},Hb.getMemSize=function(){return 0},Hb.size=function(Ha,Hb){(this._w!=Ha||this._h!=Hb||this._source&&(this._source.width!=Ha||this._source.height!=Hb))&&(this._w=Ha,this._h=Hb,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(Ha,Hb),this._source&&(this._source.height=Hb,this._source.width=Ha))},Hb.getCanvas=function(){return this._source},Hb.toBase64=function(Ha,Hb,Hc){if(this._source)if(HH.isConchApp&&this._source.toBase64)this._source.toBase64(Ha,Hb,Hc);else{var Hd=this._source.toDataURL(Ha,Hb);Hc.call(this,Hd)}},Hk(0,Hb,"context",function(){return this._ctx}),Hk(0,Hb,"asBitmap",null,function(Ha){}),Hc.create=function(Ha,Hb){return new Hc(Ha,Hb)},Hc.TYPE2D="2D",Hc.TYPE3D="3D",Hc.TYPEAUTO="AUTO",Hc._createContext=null,Hc}(),Hua=(function(Ha){function Hi(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){throw Hi.__super.call(this),new Error("不允许new！")}Hp(Hi,"laya.resource.HTMLSubImage",Hoa),Hi.create=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){return void 0===Hh&&(Hh=!1),new Hi(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh)}}(),function(Ha){function Hl(){this._frames=null,this._url=null,Hl.__super.call(this),this._setControlNode(this)}Hp(Hl,"laya.display.Animation",Ha);var Hb=Hl.prototype;Hb.destroy=function(Ha){void 0===Ha&&(Ha=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,Ha),this._frames=null,this._labels=null},Hb.play=function(Ha,Hb,Hc,Hd){void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=!0),void 0===Hc&&(Hc=""),void 0===Hd&&(Hd=!0),Hc&&this._setFramesFromCache(Hc,Hd),this._isPlaying=!0,this.index="string"==typeof Ha?this._getFrameByLabel(Ha):Ha,this.loop=Hb,this._actionName=Hc,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},Hb._setFramesFromCache=function(Ha,Hb){var Hc;return void 0===Hb&&(Hb=!1),this._url&&(Ha=this._url+"#"+Ha),Ha&&Hl.framesMap[Ha]?((Hc=Hl.framesMap[Ha])instanceof Array?(this._frames=Hl.framesMap[Ha],this._count=this._frames.length):(Hc.nodeRoot&&(Hl.framesMap[Ha]=this._parseGraphicAnimationByData(Hc),Hc=Hl.framesMap[Ha]),this._frames=Hc.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=Hc.interval),this._labels=this._copyLabels(Hc.labels)),!0):(Hb&&console.log("ani not found:",Ha),!1)},Hb._copyLabels=function(Ha){if(!Ha)return null;var Hb,Hc;for(Hc in Hb={},Ha)Hb[Hc]=HY.copyArray([],Ha[Hc]);return Hb},Hb._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&Ha.prototype._frameLoop.call(this)},Hb._displayToIndex=function(Ha){this._frames&&(this.graphics=this._frames[Ha])},Hb.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},Hb.loadImages=function(Ha,Hb){return void 0===Hb&&(Hb=""),this._url="",this._setFramesFromCache(Hb)||(this.frames=Hl.framesMap[Hb]?Hl.framesMap[Hb]:Hl.createFrames(Ha,Hb)),this},Hb.loadAtlas=function(Hb,Hc,Hd){void 0===Hd&&(Hd=""),this._url="";var He=this;function Ha(Ha){Hb===Ha&&(He.frames=Hl.framesMap[Hd]?Hl.framesMap[Hd]:Hl.createFrames(Hb,Hd),Hc&&Hc.run())}return He._setFramesFromCache(Hd)||(Hha.getAtlas(Hb)?Ha(Hb):Hx.loader.load(Hb,Hs.create(null,Ha,[Hb]),null,"atlas")),this},Hb.loadAnimation=function(Ha,Hb,Hc){this._url=Ha;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,Hb&&Hb.run()):!Hc||Hha.getAtlas(Hc)?this._loadAnimationData(Ha,Hb,Hc):Hx.loader.load(Hc,Hs.create(this,this._loadAnimationData,[Ha,Hb,Hc]),null,"atlas"),this},Hb._loadAnimationData=function(Hh,Hi,Ha){var Hj=this;if(!Ha||Hha.getAtlas(Ha)){var Hk=this;Hha.getRes(Hh)?Hb(Hh):Hx.loader.load(Hh,Hs.create(null,Hb,[Hh]),null,"json"),Hha.clearRes(Hh)}else console.warn("atlas load fail:"+Ha);function Hb(Ha){if(Hha.getRes(Ha)&&Hh===Ha){var Hb;if(Hl.framesMap[Hh+"#"])Hk._setFramesFromCache(Hj._actionName,!0),Hj.index=0,Hj._checkResumePlaying();else{var Hc=Hk._parseGraphicAnimation(Hha.getRes(Hh));if(!Hc)return;var Hd,He=Hc.animationList,Hf=0,Hg=He.length;for(Hf=0;Hf<Hg;Hf++)Hb=He[Hf],Hl.framesMap[Hh+"#"+Hb.name]=Hb,Hd||(Hd=Hb);Hd&&(Hl.framesMap[Hh+"#"]=Hd,Hk._setFramesFromCache(Hj._actionName,!0),Hj.index=0),Hj._checkResumePlaying()}Hi&&Hi.run()}}},Hb._parseGraphicAnimation=function(Ha){return Hxa.parseAnimationData(Ha)},Hb._parseGraphicAnimationByData=function(Ha){return Hxa.parseAnimationByData(Ha)},Hk(0,Hb,"frames",function(){return this._frames},function(Ha){(this._frames=Ha)&&(this._count=Ha.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),Hk(0,Hb,"autoPlay",null,function(Ha){Ha?this.play():this.stop()}),Hk(0,Hb,"source",null,function(Ha){-1<Ha.indexOf(".ani")?this.loadAnimation(Ha):-1<Ha.indexOf(".json")||-1<Ha.indexOf("als")||-1<Ha.indexOf("atlas")?this.loadAtlas(Ha):this.loadImages(Ha.split(","))}),Hk(0,Hb,"autoAnimation",null,function(Ha){this.play(0,!0,Ha,!1)}),Hl.createFrames=function(Ha,Hb){var Hc,Hd,He=0,Hf=0;if("string"==typeof Ha){var Hg=Hha.getAtlas(Ha);if(Hg&&Hg.length)for(Hc=[],He=0,Hf=Hg.length;He<Hf;He++)(Hd=new HD.createGraphics).drawTexture(Hha.getRes(Hg[He]),0,0),Hc.push(Hd)}else if(Ha instanceof Array)for(Hc=[],He=0,Hf=Ha.length;He<Hf;He++)(Hd=new HD.createGraphics).loadImage(Ha[He],0,0),Hc.push(Hd);return Hb&&(Hl.framesMap[Hb]=Hc),Hc},Hl.clearCache=function(Ha){var Hb,Hc=Hl.framesMap,Hd=Ha+"#";for(Hb in Hc)Hb!==Ha&&0!=Hb.indexOf(Hd)||delete Hl.framesMap[Hb]},Hl.framesMap={}}(Hpa),function(Ha){function Hf(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,Hf.__super.call(this),null==Hf._sortIndexFun&&(Hf._sortIndexFun=Hw.sortByKey("index",!1,!0))}Hp(Hf,"laya.display.FrameAnimation",Ha);var Hb=Hf.prototype;return Hb._setUp=function(Ha,Hb){this._labels=null,this._animationNewFrames=null,this._targetDic=Ha,this._animationData=Hb,this.interval=1e3/Hb.frameRate,Hb.parsed?(this._count=Hb.count,this._labels=Hb.labels,this._animationNewFrames=Hb.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),Hb.parsed=!0,Hb.labels=this._labels,Hb.count=this._count,Hb.animationNewFrames=this._animationNewFrames},Hb.clear=function(){Ha.prototype.clear.call(this),this._targetDic=null,this._animationData=null},Hb._displayToIndex=function(Ha){if(this._animationData){Ha<0&&(Ha=0),Ha>this._count&&(Ha=this._count);var Hb=this._animationData.nodes,Hc=0,Hd=Hb.length;for(Hc=0;Hc<Hd;Hc++)this._displayNodeToFrame(Hb[Hc],Ha)}},Hb._displayNodeToFrame=function(Ha,Hb,Hc){Hc||(Hc=this._targetDic);var Hd=Hc[Ha.target];if(Hd){var He,Hf,Hg,Hh=Ha.frames,Hi=Ha.keys,Hj=0,Hk=Hi.length;for(Hj=0;Hj<Hk;Hj++)Hg=(Hf=Hh[He=Hi[Hj]]).length>Hb?Hf[Hb]:Hf[Hf.length-1],Hd[He]=Hg}},Hb._calculateDatas=function(){if(this._animationData){var Ha,Hb=this._animationData.nodes,Hc=0,Hd=Hb.length;for(Hc=this._count=0;Hc<Hd;Hc++)Ha=Hb[Hc],this._calculateNodeKeyFrames(Ha);this._count+=1}},Hb._calculateNodeKeyFrames=function(Ha){var Hb,Hc,Hd=Ha.keyframes,He=Ha.target;for(Hb in Ha.frames||(Ha.frames={}),Ha.keys?Ha.keys.length=0:Ha.keys=[],Ha.initValues||(Ha.initValues={}),Hd)Hc=Hd[Hb],Ha.frames[Hb]||(Ha.frames[Hb]=[]),this._targetDic&&this._targetDic[He]&&(Ha.initValues[Hb]=this._targetDic[He][Hb]),Hc.sort(Hf._sortIndexFun),Ha.keys.push(Hb),this._calculateNodePropFrames(Hc,Ha.frames[Hb],Hb,He)},Hb.resetToInitState=function(){if(this._targetDic&&this._animationData){var Ha,Hb,Hc=this._animationData.nodes,Hd=0,He=Hc.length;for(Hd=0;Hd<He;Hd++)if(Hb=(Ha=Hc[Hd]).initValues){var Hf,Hg=this._targetDic[Ha.target];if(Hg)for(Hf in Hb)Hg[Hf]=Hb[Hf]}}},Hb._calculateNodePropFrames=function(Ha,Hb,Hc,Hd){var He=0,Hf=Ha.length-1;if(0<Hf){for(Hb.length=Ha[Hf].index+1,He=0;He<Hf;He++)this._dealKeyFrame(Ha[He]),this._calculateFrameValues(Ha[He],Ha[He+1],Hb);this._dealKeyFrame(Ha[He])}0==Hf&&(Hb[Ha[0].index]=Ha[0].value,this._animationNewFrames&&(this._animationNewFrames[Ha[0].index]=!0))},Hb._dealKeyFrame=function(Ha){Ha.label&&""!=Ha.label&&this.addLabel(Ha.label,Ha.index)},Hb._calculateFrameValues=function(Ha,Hb,Hc){var Hd,He=0,Hf=Ha.index,Hg=Hb.index,Hh=Ha.value,Hi=Hb.value-Ha.value,Hj=Hg-Hf;if(Hg>this._count&&(this._count=Hg),Ha.tween)for(null==(Hd=HS[Ha.tweenMethod])&&(Hd=HS.linearNone),He=Hf;He<Hg;He++)Hc[He]=Hd(He-Hf,Hh,Hi,Hj),this._animationNewFrames&&(this._animationNewFrames[He]=!0);else for(He=Hf;He<Hg;He++)Hc[He]=Hh;this._animationNewFrames&&(this._animationNewFrames[Ha.index]=!0,this._animationNewFrames[Hb.index]=!0),Hc[Hb.index]=Hb.value},Hf._sortIndexFun=null,Hf}(Hpa)),Hva=function(Hb){function He(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",He.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=Hqa.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}Hp(He,"laya.display.Input",Hb);var Ha=He.prototype;return Ha.setSelection=function(Ha,Hb){this.focus=!0,laya.display.Input.inputElement.selectionStart=Ha,laya.display.Input.inputElement.selectionEnd=Hb},Ha._onUnDisplay=function(Ha){this.focus=!1},Ha._onMouseDown=function(Ha){this.focus=!0},Ha._syncInputTransform=function(){var Ha=this.nativeInput,Hb=HY.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),Hc=this._width-this.padding[1]-this.padding[3],Hd=this._height-this.padding[0]-this.padding[2];HH.isConchApp?(Ha.setScale(Hb.scaleX,Hb.scaleY),Ha.setSize(Hc,Hd),Ha.setPos(Hb.x,Hb.y)):(He.inputContainer.style.transform=He.inputContainer.style.webkitTransform="scale("+Hb.scaleX+","+Hb.scaleY+") rotate("+Hx.stage.canvasDegree+"deg)",Ha.style.width=Hc+"px",Ha.style.height=Hd+"px",He.inputContainer.style.left=Hb.x+"px",He.inputContainer.style.top=Hb.y+"px")},Ha.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},Ha._setInputMethod=function(){He.input.parentElement&&He.inputContainer.removeChild(He.input),He.area.parentElement&&He.inputContainer.removeChild(He.area),He.inputElement=this._multiline?He.area:He.input,He.inputContainer.appendChild(He.inputElement),Hqa.RightToLeft&&(He.inputElement.style.direction="rtl")},Ha._focusIn=function(){laya.display.Input.isInputting=!0;var Ha=this.nativeInput;this._focus=!0;var Hb=Ha.style;Hb.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),Ha.readOnly=!this._editable,HH.isConchApp&&(Ha.setType(this._type),Ha.setForbidEdit(!this._editable)),Ha.maxLength=this._maxChars;this.padding;if(Ha.type=this._type,Ha.value=this._content,Ha.placeholder=this._prompt,Hx.stage.off("keydown",this,this._onKeyDown),Hx.stage.on("keydown",this,this._onKeyDown),(Hx.stage.focus=this).event("focus"),HM.onPC&&Ha.focus(),!HM.onMiniGame){this._text;this._text=null}this.typeset(),Ha.setColor(this._originColor),Ha.setFontSize(this.fontSize),Ha.setFontFace(HM.onIPhone&&Hqa._fontFamilyMap[this.font]||this.font),HH.isConchApp&&Ha.setMultiAble&&Ha.setMultiAble(this._multiline),Hb.lineHeight=this.leading+this.fontSize+"px",Hb.fontStyle=this.italic?"italic":"normal",Hb.fontWeight=this.bold?"bold":"normal",Hb.textAlign=this.align,Hb.padding="0 0",this._syncInputTransform(),!HH.isConchApp&&HM.onPC&&Hx.timer.frameLoop(1,this,this._syncInputTransform)},Ha._setPromptColor=function(){(He.promptStyleDOM=HM.getElementById("promptStyle"))||((He.promptStyleDOM=HM.createElement("style")).setAttribute("id","promptStyle"),HM.document.head.appendChild(He.promptStyleDOM)),He.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},Ha._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(Hx.superSet(Hqa,this,"text",this._content),Hx.superSet(Hqa,this,"color",this._originColor)):(Hx.superSet(Hqa,this,"text",this._prompt),Hx.superSet(Hqa,this,"color",this._promptColor)),Hx.stage.off("keydown",this,this._onKeyDown),Hx.stage.focus=null,this.event("blur"),HH.isConchApp&&this.nativeInput.blur(),HM.onPC&&Hx.timer.clear(this,this._syncInputTransform)},Ha._onKeyDown=function(Ha){13===Ha.keyCode&&(HM.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},Ha.changeText=function(Ha){this._content=Ha,this._focus?(this.nativeInput.value=Ha||"",this.event("change")):Hb.prototype.changeText.call(this,Ha)},Hk(0,Ha,"color",Hb.prototype._$get_color,function(Ha){this._focus&&this.nativeInput.setColor(Ha),Hx.superSet(Hqa,this,"color",this._content?Ha:this._promptColor),this._originColor=Ha}),Hk(0,Ha,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(Ha){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),Hk(0,Ha,"multiline",function(){return this._multiline},function(Ha){this._multiline=Ha,this.valign=Ha?"top":"middle"}),Hk(0,Ha,"maxChars",function(){return this._maxChars},function(Ha){Ha<=0&&(Ha=1e5),this._maxChars=Ha}),Hk(0,Ha,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(Ha){Hx.superSet(Hqa,this,"color",this._originColor),Ha+="",this._focus?(this.nativeInput.value=Ha||"",this.event("change")):(this._multiline||(Ha=Ha.replace(/\r?\n/g,"")),(this._content=Ha)?Hx.superSet(Hqa,this,"text",Ha):(Hx.superSet(Hqa,this,"text",this._prompt),Hx.superSet(Hqa,this,"color",this.promptColor)))}),Hk(0,Ha,"nativeInput",function(){return this._multiline?He.area:He.input}),Hk(0,Ha,"prompt",function(){return this._prompt},function(Ha){!this._text&&Ha&&Hx.superSet(Hqa,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?Hx.superSet(Hqa,this,"text",this._text==this._prompt?Ha:this._text):Hx.superSet(Hqa,this,"text",Ha),this._prompt=Hqa.langPacks&&Hqa.langPacks[Ha]?Hqa.langPacks[Ha]:Ha}),Hk(0,Ha,"focus",function(){return this._focus},function(Ha){var Hb=this.nativeInput;this._focus!==Ha&&(Ha?(Hb.target?Hb.target._focusOut():this._setInputMethod(),(Hb.target=this)._focusIn()):(Hb.target=null,this._focusOut(),HM.document.body.scrollTop=0,Hb.blur(),HH.isConchApp?Hb.setPos(-1e4,-1e4):He.inputContainer.contains(Hb)&&He.inputContainer.removeChild(Hb)))}),Hk(0,Ha,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(Ha){Ha?(-1<(Ha="[^"+Ha+"]").indexOf("^^")&&(Ha=Ha.replace("^^","")),this._restrictPattern=new RegExp(Ha,"g")):this._restrictPattern=null}),Hk(0,Ha,"editable",function(){return this._editable},function(Ha){this._editable=Ha,HH.isConchApp&&He.input.setForbidEdit(!Ha)}),Hk(0,Ha,"promptColor",function(){return this._promptColor},function(Ha){this._promptColor=Ha,this._content||Hx.superSet(Hqa,this,"color",Ha)}),Hk(0,Ha,"type",function(){return this._type},function(Ha){this._getCSSStyle().password="password"==Ha,this._type=Ha,HH.isConchApp&&this.nativeInput.setType(Ha)}),Hk(0,Ha,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(Ha){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),Hk(0,Ha,"asPassword",function(){return this._getCSSStyle().password},function(Ha){this._getCSSStyle().password=Ha,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),He.__init__=function(){He._createInputElement(),HM.onMobile&&HH.canvas.addEventListener(He.IOS_IFRAME?HM.onMiniGame?"touchend":"click":"touchend",He._popupInputMethod)},He._popupInputMethod=function(Ha){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},He._createInputElement=function(){He._initInput(He.area=HM.createElement("textarea")),He._initInput(He.input=HM.createElement("input")),(He.inputContainer=HM.createElement("div")).style.position="absolute",He.inputContainer.style.zIndex=1e5,HM.container.appendChild(He.inputContainer),He.inputContainer.setPos=function(Ha,Hb){He.inputContainer.style.left=Ha+"px",He.inputContainer.style.top=Hb+"px"}},He._initInput=function(Hb){var Ha=Hb.style;Ha.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",Ha.resize="none",Ha.backgroundColor="transparent",Ha.border="none",Ha.outline="none",Ha.zIndex=1,Hb.addEventListener("input",He._processInputting),Hb.addEventListener("mousemove",He._stopEvent),Hb.addEventListener("mousedown",He._stopEvent),Hb.addEventListener("touchmove",He._stopEvent),Hb.setFontFace=function(Ha){Hb.style.fontFamily=Ha},HH.isConchApp||(Hb.setColor=function(Ha){Hb.style.color=Ha},Hb.setFontSize=function(Ha){Hb.style.fontSize=Ha+"px"})},He._processInputting=function(Ha){var Hb=laya.display.Input.inputElement.target;if(Hb){var Hc=laya.display.Input.inputElement.value;Hb._restrictPattern&&(Hc=Hc.replace(/\u2006|\x27/g,""),Hb._restrictPattern.test(Hc)&&(Hc=Hc.replace(Hb._restrictPattern,""),laya.display.Input.inputElement.value=Hc)),Hb._text=Hc,Hb.event("input")}},He._stopEvent=function(Ha){"touchmove"==Ha.type&&Ha.preventDefault(),Ha.stopPropagation&&Ha.stopPropagation()},He.TYPE_TEXT="text",He.TYPE_PASSWORD="password",He.TYPE_EMAIL="email",He.TYPE_URL="url",He.TYPE_NUMBER="number",He.TYPE_RANGE="range",He.TYPE_DATE="date",He.TYPE_MONTH="month",He.TYPE_WEEK="week",He.TYPE_TIME="time",He.TYPE_DATE_TIME="datetime",He.TYPE_DATE_TIME_LOCAL="datetime-local",He.TYPE_SEARCH="search",He.input=null,He.area=null,He.inputElement=null,He.inputContainer=null,He.confirmButton=null,He.promptStyleDOM=null,He.inputHeight=45,He.isInputting=!1,He.stageMatrix=null,Hi(He,["IOS_IFRAME",function(){return this.IOS_IFRAME=HM.onIOS&&HM.window.top!=HM.window.self}]),He}(Hqa),Hwa=function(Ha){function Hc(Ha,Hb){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,Hc.__super.call(this),Ha&&this._init_(Ha,Hb)}Hp(Hc,"laya.resource.HTMLImage",Hsa);var Hb=Hc.prototype;return Hb._init_=function(Ha,Hb){this._src=Ha,this._source=new HM.window.Image,Hb&&(Hb.onload&&(this.onload=Hb.onload),Hb.onerror&&(this.onerror=Hb.onerror),Hb.onCreate&&Hb.onCreate(this)),0!=Ha.indexOf("data:image")&&(this._source.crossOrigin=""),Ha&&(this._source.src=Ha)},Hb.recreateResource=function(){var Ha=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var Hb=this;this._source=new HM.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(Hb._needReleaseAgain)return Hb._needReleaseAgain=!1,Hb._source.onload=null,void(Hb._source=null);Hb._source.onload=null,Hb.memorySize=Ha._w*Ha._h*4,Hb._recreateLock=!1,Hb.completeCreate()},this._source.src=this._src}},Hb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},Hb.onresize=function(){this._w=this._source.width,this._h=this._source.height},Hk(0,Hb,"onload",null,function(Ha){var Hb=this;this._onload=Ha,this._source&&(this._source.onload=null!=this._onload?function(){Hb.onresize(),Hb._onload()}:null)}),Hk(0,Hb,"onerror",null,function(Ha){var Hb=this;this._onerror=Ha,this._source&&(this._source.onerror=null!=this._onerror?function(){Hb._onerror()}:null)}),Hk(0,Hb,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(Ha){this._enableMerageInAtlas=Ha,HH.isConchApp&&this._source&&(this._source.enableMerageInAtlas=Ha)}),Hc.create=function(Ha,Hb){return new Hc(Ha,Hb)},Hc}(),Hxa=(function(Hf){function Ha(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,Ha.__super.call(this)}Hp(Ha,"laya.display.EffectAnimation",Hf);var Hb=Ha.prototype;Hb._onOtherBegin=function(Ha){Ha!=this&&this.stop()},Hb.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},Hb._onPlayAction=function(){this.play(0,!1)},Hb.play=function(Ha,Hb,Hc,Hd){void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=!0),void 0===Hc&&(Hc=""),void 0===Hd&&(Hd=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,Ha,Hb,Hc,Hd))},Hb._recordInitData=function(){if(this._aniKeys){var Ha,Hb,Hc=0;for(Ha=this._aniKeys.length,Hc=0;Hc<Ha;Hc++)Hb=this._aniKeys[Hc],this._initData[Hb]=this._target[Hb]}},Hb._displayToIndex=function(Ha){if(this._animationData){Ha<0&&(Ha=0),Ha>this._count&&(Ha=this._count);var Hb=this._animationData.nodes,Hc=0,Hd=Hb.length;for(Hd=1<Hd?1:Hd,Hc=0;Hc<Hd;Hc++)this._displayNodeToFrame(Hb[Hc],Ha)}},Hb._displayNodeToFrame=function(Ha,Hb,Hc){if(this._target){var Hd;Hd=this._target;var He,Hf,Hg,Hh,Hi=Ha.frames,Hj=Ha.keys,Hk=0,Hl=Hj.length;Hh=Ha.secondFrames;var Hm,Hn,Ho,Hp,Hq=0;for(Hk=0;Hk<Hl;Hk++)Hf=Hi[He=Hj[Hk]],Hg=-1==(Hq=Hh[He])?this._initData[He]:Hb<Hq?(Ho=(Hn=Ha.keyframes[He])[0]).tween?(null==(Hm=HS[Ho.tweenMethod])&&(Hm=HS.linearNone),Hp=Hn[1],Hm(Hb,this._initData[He],Hp.value-this._initData[He],Hp.index)):this._initData[He]:Hf.length>Hb?Hf[Hb]:Hf[Hf.length-1],Hd[He]=Hg}},Hb._calculateNodeKeyFrames=function(Ha){Hf.prototype._calculateNodeKeyFrames.call(this,Ha);var Hb,Hc,Hd,He=Ha.keyframes;Ha.target;for(Hb in Hd={},Ha.secondFrames=Hd,He)(Hc=He[Hb]).length<=1?Hd[Hb]=-1:Hd[Hb]=Hc[1].index},Hk(0,Hb,"target",function(){return this._target},function(Ha){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=Ha,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),Hk(0,Hb,"playEvent",null,function(Ha){(this._playEvents=Ha)&&this.addEvent()}),Hk(0,Hb,"effectData",null,function(Ha){var Hb;Ha&&((Hb=Ha.animations)&&Hb[0]&&(this._setUp({},Hb[0]),Hb[0].nodes&&Hb[0].nodes[0]&&(this._aniKeys=Hb[0].nodes[0].keys)))}),Hk(0,Hb,"effectClass",null,function(Ha){var Hb,Hc;(this._effectClass=HP.getClass(Ha),this._effectClass)&&((Hb=this._effectClass.uiView)&&(Hc=Hb.animations)&&Hc[0]&&(this._setUp({},Hc[0]),Hc[0].nodes&&Hc[0].nodes[0]&&(this._aniKeys=Hc[0].nodes[0].keys)))}),Ha.EffectAnimationBegin="effectanimationbegin"}(Hua),function(Hb){var HB;function HC(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,HC.__super.call(this)}Hp(HC,"laya.utils.GraphicAnimation",Hb);var Ha=HC.prototype;return Ha._parseNodeList=function(Ha){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[Ha.compId]=Ha.props,Ha.compId&&this._nodeList.push(Ha.compId);var Hb=Ha.child;if(Hb){var Hc=0,Hd=Hb.length;for(Hc=0;Hc<Hd;Hc++)this._parseNodeList(Hb[Hc])}},Ha._calGraphicData=function(Ha){var Hb;if(this._setUp(null,Ha),this._createGraphicData(),this._nodeIDAniDic)for(Hb in this._nodeIDAniDic)this._nodeIDAniDic[Hb]=null},Ha._createGraphicData=function(){var Ha,Hb=[],Hc=0,Hd=this.count,He=this._animationNewFrames;for(He||(He=[]),Hc=0;Hc<Hd;Hc++)!He[Hc]&&Ha||(Ha=this._createFrameGraphic(Hc)),Hb.push(Ha);this._gList=Hb},Ha._createFrameGraphic=function(Ha){var Hb=HD.createGraphics();return HC._rootMatrix||(HC._rootMatrix=new HE),this._updateNodeGraphic(this._rootNode,Ha,HC._rootMatrix,Hb),Hb},Ha._updateNodeGraphic=function(Ha,Hb,Hc,Hd,He){var Hf;void 0===He&&(He=1);var Hg,Hh,Hi,Hj=(Hf=this._nodeGDic[Ha.compId]=this._getNodeGraphicData(Ha.compId,Hb,this._nodeGDic[Ha.compId])).alpha*He;if(!(Hj<.01)&&(Hf.resultTransform||(Hf.resultTransform=HE.create()),Hg=Hf.resultTransform,HE.mul(Hf.transform,Hc,Hg),Hf.skin&&(Hh=this._getTextureByUrl(Hf.skin))&&(Hg._checkTransform()?(Hd.drawTexture(Hh,0,0,Hf.width,Hf.height,Hg,Hj),Hf.resultTransform=null):Hd.drawTexture(Hh,Hg.tx,Hg.ty,Hf.width,Hf.height,null,Hj)),Hi=Ha.child)){var Hk,Hl=0;for(Hk=Hi.length,Hl=0;Hl<Hk;Hl++)this._updateNodeGraphic(Hi[Hl],Hb,Hg,Hd,Hj)}},Ha._updateNoChilds=function(Ha,Hb){if(Ha.skin){var Hc=this._getTextureByUrl(Ha.skin);if(Hc){var Hd=Ha.transform;Hd._checkTransform();!Hd.bTransform?Hb.drawTexture(Hc,Hd.tx,Hd.ty,Ha.width,Ha.height,null,Ha.alpha):Hb.drawTexture(Hc,0,0,Ha.width,Ha.height,Hd.clone(),Ha.alpha)}}},Ha._updateNodeGraphic2=function(Ha,Hb,Hc){var Hd;if(Hd=this._nodeGDic[Ha.compId]=this._getNodeGraphicData(Ha.compId,Hb,this._nodeGDic[Ha.compId]),Ha.child){var He=Hd.transform;He._checkTransform();var Hf,Hg;Hg=(Hf=!He.bTransform)&&(0!=He.tx||0!=He.ty);var Hh,Hi,Hj;if((Hh=He.bTransform||1!=Hd.alpha)&&Hc.save(),1!=Hd.alpha&&Hc.alpha(Hd.alpha),Hf?Hg&&Hc.translate(He.tx,He.ty):Hc.transform(He.clone()),Hi=Ha.child,Hd.skin&&(Hj=this._getTextureByUrl(Hd.skin))&&Hc.drawTexture(Hj,0,0,Hd.width,Hd.height),Hi){var Hk,Hl=0;for(Hk=Hi.length,Hl=0;Hl<Hk;Hl++)this._updateNodeGraphic2(Hi[Hl],Hb,Hc)}Hh?Hc.restore():Hf?Hg&&Hc.translate(-He.tx,-He.ty):Hc.transform(He.clone().invert())}else this._updateNoChilds(Hd,Hc)},Ha._calculateNodeKeyFrames=function(Ha){Hb.prototype._calculateNodeKeyFrames.call(this,Ha),this._nodeIDAniDic[Ha.target]=Ha},Ha.getNodeDataByID=function(Ha){return this._nodeIDAniDic[Ha]},Ha._getParams=function(Ha,Hb,Hc,Hd){var He=HC._temParam;He.length=Hb.length;var Hf=0,Hg=Hb.length;for(Hf=0;Hf<Hg;Hf++)He[Hf]=this._getObjVar(Ha,Hb[Hf][0],Hc,Hb[Hf][1],Hd);return He},Ha._getObjVar=function(Ha,Hb,Hc,Hd,He){if(Ha.hasOwnProperty(Hb)){var Hf=Ha[Hb];if(Hc>=Hf.length&&(Hc=Hf.length-1),null!=Ha[Hb][Hc])return Ha[Hb][Hc]}return He.hasOwnProperty(Hb)?He[Hb]:Hd},Ha._getNodeGraphicData=function(Ha,Hb,Hc){Hc||(Hc=HB.create()),Hc.transform?Hc.transform.identity():Hc.transform=HE.create();var Hd=this.getNodeDataByID(Ha);if(!Hd)return Hc;var He,Hf,Hg=Hd.frames,Hh=this._getParams(Hg,HC._drawTextureCmd,Hb,this._nodeDefaultProps[Ha]),Hi=Hh[0],Hj=NaN,Hk=NaN,Hl=Hh[5],Hm=Hh[6],Hn=Hh[13],Ho=Hh[14],Hp=Hh[7],Hq=Hh[8],Hr=Hh[9],Hs=Hh[11],Ht=Hh[12];Hj=Hh[3],Hk=Hh[4],0!=Hj&&0!=Hk||(Hi=null),-1==Hj&&(Hj=0),-1==Hk&&(Hk=0),Hc.skin=Hi,Hc.width=Hj,Hc.height=Hk,Hi&&((He=this._getTextureByUrl(Hi))?(Hj||(Hj=He.sourceWidth),Hk||(Hk=He.sourceHeight)):console.warn("lost skin:",Hi,",you may load pics first")),Hc.alpha=Hh[10],Hf=Hc.transform,0!=Hn&&(Hl=Hn*Hj),0!=Ho&&(Hm=Ho*Hk),0==Hl&&0==Hm||Hf.translate(-Hl,-Hm);var Hu=null;if(Hr||1!==Hp||1!==Hq||Hs||Ht){(Hu=HC._tempMt).identity(),Hu.bTransform=!0;var Hv=.0174532922222222*(Hr-Hs),Hw=.0174532922222222*(Hr+Ht),Hx=Math.cos(Hw),Hy=Math.sin(Hw),Hz=Math.sin(Hv),HA=Math.cos(Hv);Hu.a=Hp*Hx,Hu.b=Hp*Hy,Hu.c=-Hq*Hz,Hu.d=Hq*HA,Hu.tx=Hu.ty=0}return Hu&&(Hf=HE.mul(Hf,Hu,Hf)),Hf.translate(Hh[1],Hh[2]),Hc},Ha._getTextureByUrl=function(Ha){return Hha.getRes(Ha)},Ha.setAniData=function(Ha,Hb){if(Ha.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=Ha,this._parseNodeList(Ha);var Hc,Hd={},He=[],Hf=Ha.animations,Hg=0,Hh=Hf.length;for(Hg=0;Hg<Hh;Hg++)if(Hc=Hf[Hg],this._labels=null,(!Hb||Hb==Hc.name)&&Hc){try{this._calGraphicData(Hc)}catch(Ha){console.warn("parse animation fail:"+Hc.name+",empty animation created"),this._gList=[]}var Hi={};Hi.interval=1e3/Hc.frameRate,Hi.frames=this._gList,Hi.labels=this._labels,Hi.name=Hc.name,He.push(Hi),Hd[Hc.name]=Hi}this.animationList=He,this.animationDic=Hd}HC._temParam.length=0},Ha.parseByData=function(Ha){var Hb,Hc;Hb=Ha.nodeRoot,Hc=Ha.aniO,delete Ha.nodeRoot,delete Ha.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=Hb,this._parseNodeList(Hb),this._labels=null;try{this._calGraphicData(Hc)}catch(Ha){console.warn("parse animation fail:"+Hc.name+",empty animation created"),this._gList=[]}var Hd=Ha;return Hd.interval=1e3/Hc.frameRate,Hd.frames=this._gList,Hd.labels=this._labels,Hd.name=Hc.name,Hd},Ha.setUpAniData=function(Ha){if(Ha.animations){var Hb,Hc={},Hd=[],He=Ha.animations,Hf=0,Hg=He.length;for(Hf=0;Hf<Hg;Hf++)if(Hb=He[Hf]){var Hh={};Hh.name=Hb.name,Hh.aniO=Hb,Hh.nodeRoot=Ha,Hd.push(Hh),Hc[Hb.name]=Hh}this.animationList=Hd,this.animationDic=Hc}},Ha._clear=function(){var Ha,Hb;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(Ha in this._nodeGDic)(Hb=this._nodeGDic[Ha])&&Hb.recover();this._nodeGDic=null},HC.parseAnimationByData=function(Ha){var Hb;return HC._I||(HC._I=new HC),Hb=HC._I.parseByData(Ha),HC._I._clear(),Hb},HC.parseAnimationData=function(Ha){var Hb;return HC._I||(HC._I=new HC),HC._I.setUpAniData(Ha),(Hb={}).animationList=HC._I.animationList,Hb.animationDic=HC._I.animationDic,HC._I._clear(),Hb},HC._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],HC._temParam=[],HC._I=null,HC._rootMatrix=null,Hi(HC,["_tempMt",function(){return this._tempMt=new HE}]),HC.__init$=function(){HB=function(){function Ha(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return Hp(Ha,""),Ha.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),HU.recover("GraphicNode",this)},Ha.create=function(){return HU.getItemByClass("GraphicNode",Ha)},Ha}()},HC}(Hua));Hx.__init([Hj,Hia,HH,HM,HW,HA,Ha,Hxa])}(window,document,Laya),function(Ha,Hb,Hc){Hc.un,Hc.uns,Hc.static;var Hd=Hc.class;Hc.getset,Hc.__newvec;new(function(){function Ha(){}return Hd(Ha,"LayaMain"),Ha}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ha,Hb){"use strict";for(var Hc in Object.defineProperty(Hb,"__esModule",{value:!0}),Laya){var Hd=Laya[Hc];Hd&&Hd.__isclass&&(Hb[Hc]=Hd)}}),function(Ha,Hb,Hw){Hw.un,Hw.uns;var Hg=Hw.static,Hm=Hw.class,Hd=Hw.getset,Hf=Hw.__newvec,Hk=laya.maths.Arith,Hl=laya.maths.Bezier,Hc=laya.resource.Bitmap,Hn=laya.utils.Browser,Hi=laya.utils.Byte,Ho=laya.utils.Color,Hx=(laya.filters.ColorFilter,Hw.Config),He=laya.resource.Context,Hy=(laya.events.Event,laya.filters.Filter),Hh=laya.display.Graphics,Hj=laya.resource.HTMLCanvas,Hp=(laya.utils.HTMLChar,laya.resource.HTMLImage),Hq=laya.resource.HTMLSubImage,Hz=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),HA=laya.maths.Point,HB=laya.maths.Rectangle,Hr=laya.renders.Render,Hs=(laya.renders.RenderContext,laya.renders.RenderSprite),Ht=laya.resource.Resource,Hu=laya.resource.ResourceManager,Hv=laya.utils.RunDriver,HC=laya.display.Sprite,HD=laya.display.Stage,HE=laya.utils.Stat,HF=laya.utils.StringKey,HG=(laya.display.css.Style,laya.system.System),HH=laya.display.Text,HI=laya.resource.Texture,HJ=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),HK=laya.utils.VectorGraphManager;laya.utils.WordText;Hw.interface("laya.webgl.shapes.IShape"),Hw.interface("laya.webgl.submit.ISubmit"),Hw.interface("laya.webgl.text.ICharSegment"),Hw.interface("laya.webgl.canvas.save.ISaveData"),Hw.interface("laya.webgl.resource.IMergeAtlasBitmap"),Hw.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var HL=function(){function Ha(){}Hm(Ha,"laya.filters.webgl.FilterActionGL");var Hb=Ha.prototype;return Hw.imps(Hb,{"laya.filters.IFilterActionGL":!0}),Hb.setValue=function(Ha){},Hb.setValueMix=function(Ha){},Hb.apply3d=function(Ha,Hb,Hc,Hd,He){return null},Hb.apply=function(Ha){return null},Hd(0,Hb,"typeMix",function(){return 0}),Ha}(),HM=function(){function Ha(){}return Hm(Ha,"laya.webgl.shader.ShaderValue"),Ha}(),HN=function(){var Hd,He;function Ha(Ha,Hb,Hc){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new He,void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),this._cells=null,this._rowInfo=null,this._init(Ha,Hb),this._atlasID=Hc}Hm(Ha,"laya.webgl.atlas.AtlasGrid");var Hb=Ha.prototype;return Hb.getAltasID=function(){return this._atlasID},Hb.setAltasID=function(Ha){0<=Ha&&(this._atlasID=Ha)},Hb.addTex=function(Ha,Hb,Hc){var Hd=this._get(Hb,Hc);return 0==Hd.ret||(this._fill(Hd.x,Hd.y,Hb,Hc,Ha),this._texCount++),Hd},Hb._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},Hb._init=function(Ha,Hb){if(this._width=Ha,this._height=Hb,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=Hf(this._height);for(var Hc=0;Hc<this._height;Hc++)this._rowInfo[Hc]=new Hd;return this._clear(),!0},Hb._get=function(Ha,Hb){var Hc=new HP;if(Ha>=this._failSize.width&&Hb>=this._failSize.height)return Hc;for(var Hd=-1,He=-1,Hf=this._width,Hg=this._height,Hh=this._cells,Hi=0;Hi<Hg;Hi++)if(!(this._rowInfo[Hi].spaceCount<Ha))for(var Hj=0;Hj<Hf;){var Hk=3*(Hi*Hf+Hj);if(0!=Hh[Hk]||Hh[1+Hk]<Ha||Hh[2+Hk]<Hb)Hj+=Hh[1+Hk];else{Hd=Hj,He=Hi;for(var Hl=0;Hl<Ha;Hl++)if(Hh[3*Hl+Hk+2]<Hb){Hd=-1;break}if(!(Hd<0))return Hc.ret=!0,Hc.x=Hd,Hc.y=He,Hc;Hj+=Hh[1+Hk]}}return Hc},Hb._fill=function(Ha,Hb,Hc,Hd,He){var Hf=this._width,Hg=this._height;this._check(Ha+Hc<=Hf&&Hb+Hd<=Hg);for(var Hh=Hb;Hh<Hd+Hb;++Hh){this._check(this._rowInfo[Hh].spaceCount>=Hc),this._rowInfo[Hh].spaceCount-=Hc;for(var Hi=0;Hi<Hc;Hi++){var Hj=3*(Ha+Hh*Hf+Hi);this._check(0==this._cells[Hj]),this._cells[Hj]=He,this._cells[1+Hj]=Hc,this._cells[2+Hj]=Hd}}if(0<Ha)for(Hh=0;Hh<Hd;++Hh){var Hk=0;for(Hi=Ha-1;0<=Hi&&0==this._cells[3*((Hb+Hh)*Hf+Hi)];--Hi,++Hk);for(Hi=Hk;0<Hi;--Hi)this._cells[3*((Hb+Hh)*Hf+Ha-Hi)+1]=Hi,this._check(0<Hi)}if(0<Hb)for(Hi=Ha;Hi<Ha+Hc;++Hi){for(Hk=0,Hh=Hb-1;0<=Hh&&0==this._cells[3*(Hi+Hh*Hf)];--Hh,Hk++);for(Hh=Hk;0<Hh;--Hh)this._cells[3*(Hi+(Hb-Hh)*Hf)+2]=Hh,this._check(0<Hh)}},Hb._check=function(Ha){0==Ha&&console.log("xtexMerger 错误啦")},Hb._clear=function(){for(var Ha=this._texCount=0;Ha<this._height;Ha++)this._rowInfo[Ha].spaceCount=this._width;for(var Hb=0;Hb<this._height;Hb++)for(var Hc=0;Hc<this._width;Hc++){var Hd=3*(Hb*this._width+Hc);this._cells[Hd]=0,this._cells[1+Hd]=this._width-Hc,this._cells[2+Hd]=this._width-Hb}this._failSize.width=this._width+1,this._failSize.height=this._height+1},Ha.__init$=function(){Hd=function(){function Ha(){this.spaceCount=0}return Hm(Ha,""),Ha}(),He=function(){function Ha(){this.width=0,this.height=0}return Hm(Ha,""),Ha}()},Ha}(),HO=function(){function Hr(Ha,Hb,Hc,Hd){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=Ha,this._height=Hb,this._gridSize=Hc,this._maxAtlaserCount=Hd,this._gridNumX=Ha/Hc,this._gridNumY=Hb/Hc,this._curAtlasIndex=0,this._atlaserArray=[]}Hm(Hr,"laya.webgl.atlas.AtlasResourceManager");var Ha=Hr.prototype;return Ha.setAtlasParam=function(Ha,Hb,Hc,Hd){if(1==this._setAtlasParam)return Hr._sid_=0,this._width=Ha,this._height=Hb,this._gridSize=Hc,this._maxAtlaserCount=Hd,this._gridNumX=Ha/Hc,this._gridNumY=Hb/Hc,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},Ha.pushData=function(Ha){var Hb,Hc=Ha.bitmap,Hd=-1,He=null,Hf=0,Hg=0;for(Hf=0,Hb=this._atlaserArray.length;Hf<Hb&&(Hg=(this._curAtlasIndex+Hf)%Hb,-1==(Hd=(He=this._atlaserArray[Hg]).findBitmapIsExist(Hc)));Hf++);if(-1!=Hd){var Hh=He.InAtlasWebGLImagesOffsetValue[Hd];return Ho=Hh[0],Hp=Hh[1],He.addToAtlas(Ha,Ho,Hp),!0}this._setAtlasParam=!1;for(var Hi=Math.ceil((Ha.bitmap.width+2)/this._gridSize),Hj=Math.ceil((Ha.bitmap.height+2)/this._gridSize),Hk=!1,Hl=0;Hl<2;Hl++){var Hm=this._maxAtlaserCount;for(Hf=0;Hf<Hm;Hf++){Hg=(this._curAtlasIndex+Hf)%Hm,this._atlaserArray.length-1>=Hg||this._atlaserArray.push(new HBa(this._gridNumX,this._gridNumY,this._width,this._height,Hr._sid_++));var Hn=this._atlaserArray[Hg],Ho=0,Hp=0,Hq=Hn.addTex(1,Hi,Hj);if(Hq.ret){Ho=Hq.x*this._gridSize+1,Hp=Hq.y*this._gridSize+1,Hc.lock=!0,Hn.addToAtlasTexture(Hc,Ho,Hp),Hn.addToAtlas(Ha,Ho,Hp),Hk=!0,this._curAtlasIndex=Hg;break}}if(Hk)break;this._atlaserArray.push(new HBa(this._gridNumX,this._gridNumY,this._width,this._height,Hr._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return Hk||console.log(">>>AtlasManager pushData error"),Hk},Ha.addToAtlas=function(Ha){laya.webgl.atlas.AtlasResourceManager.instance.pushData(Ha)},Ha.garbageCollection=function(){if(!0===this._needGC){for(var Ha=this._atlaserArray.length-this._maxAtlaserCount,Hb=0;Hb<Ha;Hb++)this._atlaserArray[Hb].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+Ha),this._atlaserArray.splice(0,Ha),this._needGC=!1}return!0},Ha.freeAll=function(){for(var Ha=0,Hb=this._atlaserArray.length;Ha<Hb;Ha++)this._atlaserArray[Ha].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},Ha.getAtlaserCount=function(){return this._atlaserArray.length},Ha.getAtlaserByIndex=function(Ha){return this._atlaserArray[Ha]},Hd(1,Hr,"instance",function(){return Hr._Instance||(Hr._Instance=new Hr(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),Hr._Instance}),Hd(1,Hr,"enabled",function(){return Hx.atlasEnable}),Hd(1,Hr,"atlasLimitWidth",function(){return Hr._atlasLimitWidth},function(Ha){Hr._atlasLimitWidth=Ha}),Hd(1,Hr,"atlasLimitHeight",function(){return Hr._atlasLimitHeight},function(Ha){Hr._atlasLimitHeight=Ha}),Hr._enable=function(){Hx.atlasEnable=!0},Hr._disable=function(){Hx.atlasEnable=!1},Hr.__init__=function(){Hr.atlasTextureWidth=2048,Hr.atlasTextureHeight=2048,Hr.maxTextureCount=6,Hr.atlasLimitWidth=512,Hr.atlasLimitHeight=512},Hr._atlasLimitWidth=0,Hr._atlasLimitHeight=0,Hr.gridSize=16,Hr.atlasTextureWidth=0,Hr.atlasTextureHeight=0,Hr.maxTextureCount=0,Hr._atlasRestore=0,Hr.BOARDER_TYPE_NO=0,Hr.BOARDER_TYPE_RIGHT=1,Hr.BOARDER_TYPE_LEFT=2,Hr.BOARDER_TYPE_BOTTOM=4,Hr.BOARDER_TYPE_TOP=8,Hr.BOARDER_TYPE_ALL=15,Hr._sid_=0,Hr._Instance=null,Hr}(),HP=function(){function Ha(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return Hm(Ha,"laya.webgl.atlas.MergeFillInfo"),Ha}(),HQ=function(){function Hb(){}return Hm(Hb,"laya.webgl.canvas.BlendMode"),Hb._init_=function(Ha){Hb.fns=[Hb.BlendNormal,Hb.BlendAdd,Hb.BlendMultiply,Hb.BlendScreen,Hb.BlendOverlay,Hb.BlendLight,Hb.BlendMask,Hb.BlendDestinationOut],Hb.targetFns=[Hb.BlendNormalTarget,Hb.BlendAddTarget,Hb.BlendMultiplyTarget,Hb.BlendScreenTarget,Hb.BlendOverlayTarget,Hb.BlendLightTarget,Hb.BlendMask,Hb.BlendDestinationOut]},Hb.BlendNormal=function(Ha){Ha.blendFunc(1,771)},Hb.BlendAdd=function(Ha){Ha.blendFunc(1,772)},Hb.BlendMultiply=function(Ha){Ha.blendFunc(774,771)},Hb.BlendScreen=function(Ha){Ha.blendFunc(1,1)},Hb.BlendOverlay=function(Ha){Ha.blendFunc(1,769)},Hb.BlendLight=function(Ha){Ha.blendFunc(1,1)},Hb.BlendNormalTarget=function(Ha){Ha.blendFunc(1,771)},Hb.BlendAddTarget=function(Ha){Ha.blendFunc(1,772)},Hb.BlendMultiplyTarget=function(Ha){Ha.blendFunc(774,771)},Hb.BlendScreenTarget=function(Ha){Ha.blendFunc(1,1)},Hb.BlendOverlayTarget=function(Ha){Ha.blendFunc(1,769)},Hb.BlendLightTarget=function(Ha){Ha.blendFunc(1,1)},Hb.BlendMask=function(Ha){Ha.blendFunc(0,770)},Hb.BlendDestinationOut=function(Ha){Ha.blendFunc(0,0)},Hb.activeBlendFunction=null,Hb.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],Hb.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},Hb.NORMAL="normal",Hb.ADD="add",Hb.MULTIPLY="multiply",Hb.SCREEN="screen",Hb.LIGHT="light",Hb.OVERLAY="overlay",Hb.DESTINATIONOUT="destination-out",Hb.fns=[],Hb.targetFns=[],Hb}(),HR=function(){function Hc(Ha){this._color=Ho.create("black"),this.setValue(Ha)}Hm(Hc,"laya.webgl.canvas.DrawStyle");var Ha=Hc.prototype;return Ha.setValue=function(Ha){if(Ha){if("string"==typeof Ha)return void(this._color=Ho.create(Ha));if(Ha instanceof laya.utils.Color)return void(this._color=Ha)}},Ha.reset=function(){this._color=Ho.create("black")},Ha.equal=function(Ha){return"string"==typeof Ha?this._color.strColor===Ha:Ha instanceof laya.utils.Color&&this._color.numColor===Ha.numColor},Ha.toColorStr=function(){return this._color.strColor},Hc.create=function(Ha){var Hb;if(Ha&&("string"==typeof Ha?Hb=Ho.create(Ha):Ha instanceof laya.utils.Color&&(Hb=Ha),Hb))return Hb._drawStyle||(Hb._drawStyle=new Hc(Ha));return laya.webgl.canvas.DrawStyle.DEFAULT},Hg(Hc,["DEFAULT",function(){return this.DEFAULT=new Hc("#000000")}]),Hc}(),HS=function(){function Ha(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];Hua.mainContext;this.ib=H$a.create(35048),this.vb=H_a.create(5)}Hm(Ha,"laya.webgl.canvas.Path");var Hb=Ha.prototype;return Hb.addPoint=function(Ha,Hb){this.tempArray.push(Ha,Hb)},Hb.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},Hb.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},Hb.polygon=function(Ha,Hb,Hc,Hd,He,Hf){var Hg;return this.geomatrys.push(this._curGeomatry=Hg=new HFa(Ha,Hb,Hc,Hd,He,Hf)),Hd||(Hg.fill=!1),null==Hf&&(Hg.borderWidth=0),Hg},Hb.setGeomtry=function(Ha){this.geomatrys.push(this._curGeomatry=Ha)},Hb.drawLine=function(Ha,Hb,Hc,Hd,He){var Hf;return this.closePath?this.geomatrys.push(this._curGeomatry=Hf=new HEa(Ha,Hb,Hc,Hd,He)):this.geomatrys.push(this._curGeomatry=Hf=new HDa(Ha,Hb,Hc,Hd,He)),Hf.fill=!1,Hf},Hb.update=function(){var Ha=this.ib._byteLength,Hb=this.geomatrys.length;this.offset=Ha;for(var Hc=this.geoStart;Hc<Hb;Hc++)this.geomatrys[Hc].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=Hb,this.count=(this.ib._byteLength-Ha)/Hpa.BYTES_PIDX},Hb.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},Hb.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},Ha}(),HT=function(){function Hh(){}Hm(Hh,"laya.webgl.canvas.save.SaveBase");var Ha=Hh.prototype;return Hw.imps(Ha,{"laya.webgl.canvas.save.ISaveData":!0}),Ha.isSaveMark=function(){return!1},Ha.restore=function(Ha){this._dataObj[this._valueName]=this._value,(Hh._cache[Hh._cache._length++]=this)._newSubmit&&(Ha._curSubmit=Hfa.RENDERBASE,Ha._renderKey=0)},Hh._createArray=function(){var Ha=[];return Ha._length=0,Ha},Hh._init=function(){var Ha=Hh._namemap={};return Ha[1]="ALPHA",Ha[2]="fillStyle",Ha[8]="font",Ha[256]="lineWidth",Ha[512]="strokeStyle",Ha[8192]="_mergeID",Ha[1024]=Ha[2048]=Ha[4096]=[],Ha[16384]="textBaseline",Ha[32768]="textAlign",Ha[65536]="_nBlendType",Ha[1048576]="shader",Ha[2097152]="filters",Ha},Hh.save=function(Ha,Hb,Hc,Hd){if((Ha._saveMark._saveuse&Hb)!==Hb){Ha._saveMark._saveuse|=Hb;var He=Hh._cache,Hf=0<He._length?He[--He._length]:new Hh;Hf._value=Hc[Hf._valueName=Hh._namemap[Hb]],Hf._dataObj=Hc,Hf._newSubmit=Hd;var Hg=Ha._save;Hg[Hg._length++]=Hf}},Hh._cache=laya.webgl.canvas.save.SaveBase._createArray(),Hh._namemap=Hh._init(),Hh}(),HU=function(){function Hf(){this._clipRect=new HB}Hm(Hf,"laya.webgl.canvas.save.SaveClipRect");var Ha=Hf.prototype;return Hw.imps(Ha,{"laya.webgl.canvas.save.ISaveData":!0}),Ha.isSaveMark=function(){return!1},Ha.restore=function(Ha){Ha._clipRect=this._clipSaveRect,(Hf._cache[Hf._cache._length++]=this)._submitScissor.submitLength=Ha._submits._length-this._submitScissor.submitIndex,Ha._curSubmit=Hfa.RENDERBASE,Ha._renderKey=0},Hf.save=function(Ha,Hb){if(131072!=(131072&Ha._saveMark._saveuse)){Ha._saveMark._saveuse|=131072;var Hc=Hf._cache,Hd=0<Hc._length?Hc[--Hc._length]:new Hf;Hd._clipSaveRect=Ha._clipRect,Ha._clipRect=Hd._clipRect.copyFrom(Ha._clipRect),Hd._submitScissor=Hb;var He=Ha._save;He[He._length++]=Hd}},Hg(Hf,["_cache",function(){return this._cache=HT._createArray()}]),Hf}(),HV=function(){function Hn(){this._contextX=0,this._contextY=0,this._clipRect=new HB,this._rect=new HB,this._matrix=new Hz}Hm(Hn,"laya.webgl.canvas.save.SaveClipRectStencil");var Ha=Hn.prototype;return Hw.imps(Ha,{"laya.webgl.canvas.save.ISaveData":!0}),Ha.isSaveMark=function(){return!1},Ha.restore=function(Ha){Hka.restore(Ha,this._rect,this._saveMatrix,this._contextX,this._contextY),Ha._clipRect=this._clipSaveRect,Ha._curMat=this._saveMatrix,Ha._x=this._contextX,Ha._y=this._contextY,Hn._cache[Hn._cache._length++]=this,Ha._curSubmit=Hfa.RENDERBASE},Hn.save=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){if(262144!=(262144&Ha._saveMark._saveuse)){Ha._saveMark._saveuse|=262144;var Hk=Hn._cache,Hl=0<Hk._length?Hk[--Hk._length]:new Hn;Hl._clipSaveRect=Ha._clipRect,Hl._clipRect.setTo(Hg,Hh,Hi,Hj),Ha._clipRect=Hl._clipRect,Hl._rect.x=Hc,Hl._rect.y=Hd,Hl._rect.width=He,Hl._rect.height=Hf,Hl._contextX=Ha._x,Hl._contextY=Ha._y,Hl._saveMatrix=Ha._curMat,Ha._curMat.copyTo(Hl._matrix),Ha._curMat=Hl._matrix,Hl._submitStencil=Hb;var Hm=Ha._save;Hm[Hm._length++]=Hl}},Hg(Hn,["_cache",function(){return this._cache=HT._createArray()}]),Hn}(),HW=function(){function Hd(){this._saveuse=0}Hm(Hd,"laya.webgl.canvas.save.SaveMark");var Ha=Hd.prototype;return Hw.imps(Ha,{"laya.webgl.canvas.save.ISaveData":!0}),Ha.isSaveMark=function(){return!0},Ha.restore=function(Ha){Ha._saveMark=this._preSaveMark,Hd._no[Hd._no._length++]=this},Hd.Create=function(Ha){var Hb=Hd._no,Hc=0<Hb._length?Hb[--Hb._length]:new Hd;return Hc._saveuse=0,Hc._preSaveMark=Ha._saveMark,Ha._saveMark=Hc},Hg(Hd,["_no",function(){return this._no=HT._createArray()}]),Hd}(),HX=function(){function Hf(){this._matrix=new Hz}Hm(Hf,"laya.webgl.canvas.save.SaveTransform");var Ha=Hf.prototype;return Hw.imps(Ha,{"laya.webgl.canvas.save.ISaveData":!0}),Ha.isSaveMark=function(){return!1},Ha.restore=function(Ha){Ha._curMat=this._savematrix,Hf._no[Hf._no._length++]=this},Hf.save=function(Ha){var Hb=Ha._saveMark;if(2048!=(2048&Hb._saveuse)){Hb._saveuse|=2048;var Hc=Hf._no,Hd=0<Hc._length?Hc[--Hc._length]:new Hf;Hd._savematrix=Ha._curMat,Ha._curMat=Ha._curMat.copyTo(Hd._matrix);var He=Ha._save;He[He._length++]=Hd}},Hg(Hf,["_no",function(){return this._no=HT._createArray()}]),Hf}(),HY=function(){function He(){}Hm(He,"laya.webgl.canvas.save.SaveTranslate");var Ha=He.prototype;return Hw.imps(Ha,{"laya.webgl.canvas.save.ISaveData":!0}),Ha.isSaveMark=function(){return!1},Ha.restore=function(Ha){Ha._curMat;Ha._x=this._x,Ha._y=this._y,He._no[He._no._length++]=this},He.save=function(Ha){var Hb=He._no,Hc=0<Hb._length?Hb[--Hb._length]:new He;Hc._x=Ha._x,Hc._y=Ha._y;var Hd=Ha._save;Hd[Hd._length++]=Hc},Hg(He,["_no",function(){return this._no=HT._createArray()}]),He}(),HZ=function(){function Ha(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new HB}Hm(Ha,"laya.webgl.resource.RenderTargetMAX");var Hb=Ha.prototype;return Hb.setSP=function(Ha){this._sp=Ha},Hb.size=function(Ha,Hb){var Hc=this;this._width!==Ha||this._height!==Hb?(this.repaint=!0,this._width=Ha,this._height=Hb,this.target?this.target.size(Ha,Hb):this.target=HKa.create(Ha,Hb),this.target.hasListener("recovered")||this.target.on("recovered",this,function(Ha){Hw.timer.callLater(Hc._sp,Hc._sp.repaint)})):this.target.size(Ha,Hb)},Hb._flushToTarget=function(Ha,Hb){if(!Hb._destroy){var Hc=Hsa.worldScissorTest,Hd=Hsa.worldClipRect;Hsa.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,Hsa.worldScissorTest=!1,Hua.mainContext.disable(3089);var He=Hsa.worldAlpha,Hf=Hsa.worldMatrix4,Hg=Hsa.worldMatrix,Hh=Hsa.worldFilters,Hi=Hsa.worldShaderDefines;if(Hsa.worldMatrix=Hz.EMPTY,Hsa.restoreTempArray(),Hsa.worldMatrix4=Hsa.TEMPMAT4_ARRAY,Hsa.worldAlpha=1,Hsa.worldFilters=null,Hsa.worldShaderDefines=null,HJa.activeShader=null,Hb.start(),Hx.showCanvasMark?Hb.clear(0,1,0,.3):Hb.clear(0,0,0,0),Ha.flush(),Hb.end(),HJa.activeShader=null,Hsa.worldAlpha=He,Hsa.worldMatrix4=Hf,Hsa.worldMatrix=Hg,Hsa.worldFilters=Hh,Hsa.worldShaderDefines=Hi,Hsa.worldScissorTest=Hc){var Hj=Hsa.height-Hd.y-Hd.height;Hua.mainContext.scissor(Hd.x,Hj,Hd.width,Hd.height),Hua.mainContext.enable(3089)}Hsa.worldClipRect=Hd}},Hb.flush=function(Ha){this.repaint&&(this._flushToTarget(Ha,this.target),this.repaint=!1)},Hb.drawTo=function(Ha,Hb,Hc,Hd,He){Ha.drawTexture(this.target.getTexture(),Hb,Hc,Hd,He,0,0)},Hb.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},Ha}(),H$=function(){function Ha(){this.ALPHA=1,this.shaderType=0,this.defines=new HCa}return Hm(Ha,"laya.webgl.shader.d2.Shader2D"),Ha.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},Ha.__init__=function(){var Ha,Hb;HWa.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),HWa.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),HWa.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),HWa.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),HWa.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),HWa.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),HWa.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),HWa.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),Ha="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",Hb='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',HWa.preCompile2D(0,1,Ha,Hb,null),Ha="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",Hb='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',HWa.preCompile2D(0,2,Ha,Hb,null),Ha="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",Hb="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",HWa.preCompile2D(0,4,Ha,Hb,null),Ha="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",Hb='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',HWa.preCompile2D(0,256,Ha,Hb,null),Ha="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",Hb="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",HWa.preCompile2D(0,512,Ha,Hb,null)},Ha}(),H_=function(){function Hb(Ha,Hb,Hc){this._value=0,this._name2int=Ha,this._int2name=Hb,this._int2nameMap=Hc}Hm(Hb,"laya.webgl.shader.ShaderDefines");var Ha=Hb.prototype;return Ha.add=function(Ha){return"string"==typeof Ha&&(Ha=this._name2int[Ha]),this._value|=Ha,this._value},Ha.addInt=function(Ha){return this._value|=Ha,this._value},Ha.remove=function(Ha){return"string"==typeof Ha&&(Ha=this._name2int[Ha]),this._value&=~Ha,this._value},Ha.isDefine=function(Ha){return(this._value&Ha)===Ha},Ha.getValue=function(){return this._value},Ha.setValue=function(Ha){this._value=Ha},Ha.toNameDic=function(){var Ha=this._int2nameMap[this._value];return Ha||Hb._toText(this._value,this._int2name,this._int2nameMap)},Hb._reg=function(Ha,Hb,Hc,Hd){Hd[Hc[Ha]=Hb]=Ha},Hb._toText=function(Ha,Hb,Hc){var Hd=Hc[Ha];if(Hd)return Hd;for(var He={},Hf=1,Hg=0;Hg<32&&!(Ha<(Hf=1<<Hg));Hg++)if(Ha&Hf){var Hh=Hb[Hf];Hh&&(He[Hh]="")}return Hc[Ha]=He},Hb._toInt=function(Ha,Hb){for(var Hc=Ha.split("."),Hd=0,He=0,Hf=Hc.length;He<Hf;He++){var Hg=Hb[Hc[He]];if(!Hg)throw new Error("Defines to int err:"+Ha+"/"+Hc[He]);Hd|=Hg}return Hd},Hb}(),Haa=function(){function Hg(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new Hz}Hm(Hg,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var Ha=Hg.prototype;return Ha.init=function(Ha,Hb,Hc){if(Hb)this._vs=Hb;else{this._vs=[];var Hd=Ha.width,He=Ha.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(Hd,0,1,0,1,1,1,1),this._vs.push(Hd,He,1,1,1,1,1,1),this._vs.push(0,He,0,1,1,1,1,1)}Hc?this._ps=Hc:(Hg._defaultPS||(Hg._defaultPS=[]).push(0,1,3,3,1,2),this._ps=Hg._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=Ha},Ha.init2=function(Ha,Hb,Hc,Hd,He){this.transform&&(this.transform=null),Hc?this._ps=Hc:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=Hd,this._uvs=He,this.mEleNum=this._ps.length,this.mTexture=Ha,(Hr.isConchNode||Hr.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},Ha._initMyData=function(){var Ha=0,Hb=0,Hc=4*this._verticles.length;this._vs=Hg._tempVS;var Hd=!1;if(Hr.isConchNode||Hr.isConchApp?(this._vs.length=Hc,Hd=!0):this._vs.length<Hc&&(this._vs.length=Hc,Hd=!0),Hg._tVSLen=Hc,Hd)for(;Ha<Hc;)this._vs[Ha]=this._verticles[Hb],this._vs[Ha+1]=this._verticles[Hb+1],this._vs[Ha+2]=this._uvs[Hb],this._vs[Ha+3]=this._uvs[Hb+1],this._vs[Ha+4]=1,this._vs[Ha+5]=1,this._vs[Ha+6]=1,this._vs[Ha+7]=1,Ha+=8,Hb+=2;else for(;Ha<Hc;)this._vs[Ha]=this._verticles[Hb],this._vs[Ha+1]=this._verticles[Hb+1],this._vs[Ha+2]=this._uvs[Hb],this._vs[Ha+3]=this._uvs[Hb+1],Ha+=8,Hb+=2},Ha.getData2=function(Ha,Hb,Hc){var Hd;this.mVBBuffer=Ha,this.mIBBuffer=Hb,this._initMyData(),Ha.appendEx2(this._vs,Float32Array,Hg._tVSLen,4),this._indexStart=Hb._byteLength,(Hd=Hg._tempIB).length<this._ps.length&&(Hd.length=this._ps.length);for(var He=0,Hf=this._ps.length;He<Hf;He++)Hd[He]=this._ps[He]+Hc;Hb.appendEx2(Hd,Uint16Array,this._ps.length,2)},Ha.getData=function(Ha,Hb,Hc){if(this.mVBBuffer=Ha,this.mIBBuffer=Hb,Ha.append(this.mVBData),this._indexStart=Hb._byteLength,this.mIBData.start!=Hc){for(var Hd=0,He=this._ps.length;Hd<He;Hd++)this.mIBData[Hd]=this._ps[Hd]+Hc;this.mIBData.start=Hc}Hb.append(this.mIBData)},Ha.render=function(Ha,Hb,Hc){if(Hr.isWebGL&&this.mTexture){Ha._renderKey=0,Ha._shader2D.glTexture=null,Hba.getInstance().addSkinMesh(this);var Hd=Hfa.createShape(Ha,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,Hya.create(512,0));this.transform||(this.transform=Hz.EMPTY),this.transform.translate(Hb,Hc),Hz.mul(this.transform,Ha._curMat,this._tempMatrix),this.transform.translate(-Hb,-Hc);var He=Hd.shaderValue,Hf=He.u_mmat2||Hsa.getMatrArray();Hsa.mat2MatArray(this._tempMatrix,Hf),He.textureHost=this.mTexture,He.offsetX=0,He.offsetY=0,He.u_mmat2=Hf,He.ALPHA=Ha._shader2D.ALPHA,Ha._submits[Ha._submits._length++]=Hd}else Hr.isConchApp&&this.mTexture&&(this.transform||(this.transform=Hz.EMPTY),Ha.setSkinMesh&&Ha.setSkinMesh(Hb,Hc,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},Hg._tempVS=[],Hg._tempIB=[],Hg._defaultPS=null,Hg._tVSLen=0,Hg}(),Hba=function(){function Ha(){this.ib=null,this.vb=null;Hua.mainContext;this.ib=H$a.create(35048),this.vb=H_a.create(8)}Hm(Ha,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var Hb=Ha.prototype;return Hb.addSkinMesh=function(Ha){Ha.getData2(this.vb,this.ib,this.vb._byteLength/32)},Hb.reset=function(){this.vb.clear(),this.ib.clear()},Ha.getInstance=function(){return Ha.instance=Ha.instance||new Ha},Ha.instance=null,Ha}(),Hca=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===Hi&&(Hi=0),this.x=Ha,this.y=Hb,this.width=Hc,this.height=Hd,this.edges=He,this.color=Hf,this.borderWidth=Hg,this.borderColor=Hh}Hm(Ha,"laya.webgl.shapes.BasePoly");var Hb=Ha.prototype;return Hw.imps(Hb,{"laya.webgl.shapes.IShape":!0}),Hb.getData=function(Ha,Hb,Hc){},Hb.rebuild=function(Ha){},Hb.setMatrix=function(Ha){},Hb.needUpdate=function(Ha){return!0},Hb.sector=function(Ha,Hb,Hc){var Hd=this.x,He=this.y,Hf=this.edges,Hg=(this.r1-this.r0)/Hf,Hh=this.width,Hi=this.height,Hj=this.color,Hk=(Hj>>16&255)/255,Hl=(Hj>>8&255)/255,Hm=(255&Hj)/255;Ha.push(Hd,He,Hk,Hl,Hm);for(var Hn=0;Hn<Hf+1;Hn++)Ha.push(Hd+Math.sin(Hg*Hn+this.r0)*Hh,He+Math.cos(Hg*Hn+this.r0)*Hi),Ha.push(Hk,Hl,Hm);for(Hn=0;Hn<Hf;Hn++)Hb.push(Hc,Hc+Hn+1,Hc+Hn+2)},Hb.createLine2=function(Ha,Hb,Hc,Hd,He,Hf){var Hg,Hh,Hi,Hj,Hk,Hl,Hm,Hn,Ho,Hp,Hq,Hr,Hs,Ht,Hu,Hv,Hw,Hx,Hy,Hz,HA=Ha.concat(),HB=He,HC=this.borderColor,HD=(HC>>16&255)/255,HE=(HC>>8&255)/255,HF=(255&HC)/255,HG=HA.length/2,HH=Hd,HI=Hc/2;Hi=HA[0],Hj=HA[1],Hp=Hi-(Hk=HA[2]),Ho=(Ho=-(Hj-(Hl=HA[3])))/(Hz=Math.sqrt(Ho*Ho+Hp*Hp))*HI,Hp=Hp/Hz*HI,HB.push(Hi-Ho+this.x,Hj-Hp+this.y,HD,HE,HF,Hi+Ho+this.x,Hj+Hp+this.y,HD,HE,HF);for(var HJ=1;HJ<HG-1;HJ++)Hi=HA[2*(HJ-1)],Hj=HA[2*(HJ-1)+1],Hk=HA[2*HJ],Hl=HA[2*HJ+1],Hm=HA[2*(HJ+1)],Hn=HA[2*(HJ+1)+1],Hp=Hi-Hk,Hr=Hk-Hm,Hu=(-(Ho=(Ho=-(Hj-Hl))/(Hz=Math.sqrt(Ho*Ho+Hp*Hp))*HI)+Hi)*(-(Hp=Hp/Hz*HI)+Hl)-(-Ho+Hk)*(-Hp+Hj),Hx=(-(Hq=(Hq=-(Hl-Hn))/(Hz=Math.sqrt(Hq*Hq+Hr*Hr))*HI)+Hm)*(-(Hr=Hr/Hz*HI)+Hl)-(-Hq+Hk)*(-Hr+Hn),Hy=(Hs=-Hp+Hj-(-Hp+Hl))*(Hw=-Hq+Hk-(-Hq+Hm))-(Hv=-Hr+Hn-(-Hr+Hl))*(Ht=-Ho+Hk-(-Ho+Hi)),Math.abs(Hy)<.1?(Hy+=10.1,HB.push(Hk-Ho+this.x,Hl-Hp+this.y,HD,HE,HF,Hk+Ho+this.x,Hl+Hp+this.y,HD,HE,HF)):(((Hg=(Ht*Hx-Hw*Hu)/Hy)-Hk)*(Hg-Hk)+((Hh=(Hv*Hu-Hs*Hx)/Hy)-Hl)+(Hh-Hl),HB.push(Hg+this.x,Hh+this.y,HD,HE,HF,Hk-(Hg-Hk)+this.x,Hl-(Hh-Hl)+this.y,HD,HE,HF));Hi=HA[HA.length-4],Hj=HA[HA.length-3],Hp=Hi-(Hk=HA[HA.length-2]),Ho=(Ho=-(Hj-(Hl=HA[HA.length-1])))/(Hz=Math.sqrt(Ho*Ho+Hp*Hp))*HI,Hp=Hp/Hz*HI,HB.push(Hk-Ho+this.x,Hl-Hp+this.y,HD,HE,HF,Hk+Ho+this.x,Hl+Hp+this.y,HD,HE,HF);var HK=Hf;for(HJ=1;HJ<HK;HJ++)Hb.push(HH+2*(HJ-1),HH+2*(HJ-1)+1,HH+2*HJ+1,HH+2*HJ+1,HH+2*HJ,HH+2*(HJ-1));return HB},Hb.createLine=function(Ha,Hb,Hc,Hd){var He=Ha.concat(),Hf=Ha,Hg=this.borderColor,Hh=(Hg>>16&255)/255,Hi=(Hg>>8&255)/255,Hj=(255&Hg)/255;He.splice(0,5);var Hk,Hl,Hm,Hn,Ho,Hp,Hq,Hr,Hs,Ht,Hu,Hv,Hw,Hx,Hy,Hz,HA,HB,HC,HD,HE=He.length/5,HF=Hd,HG=Hc/2;Hm=He[0],Hn=He[1],Ht=Hm-(Ho=He[5]),Hs=(Hs=-(Hn-(Hp=He[6])))/(HD=Math.sqrt(Hs*Hs+Ht*Ht))*HG,Ht=Ht/HD*HG,Hf.push(Hm-Hs,Hn-Ht,Hh,Hi,Hj,Hm+Hs,Hn+Ht,Hh,Hi,Hj);for(var HH=1;HH<HE-1;HH++)Hm=He[5*(HH-1)],Hn=He[5*(HH-1)+1],Ho=He[5*HH],Hp=He[5*HH+1],Hq=He[5*(HH+1)],Hr=He[5*(HH+1)+1],Ht=Hm-Ho,Hv=Ho-Hq,Hy=(-(Hs=(Hs=-(Hn-Hp))/(HD=Math.sqrt(Hs*Hs+Ht*Ht))*HG)+Hm)*(-(Ht=Ht/HD*HG)+Hp)-(-Hs+Ho)*(-Ht+Hn),HB=(-(Hu=(Hu=-(Hp-Hr))/(HD=Math.sqrt(Hu*Hu+Hv*Hv))*HG)+Hq)*(-(Hv=Hv/HD*HG)+Hp)-(-Hu+Ho)*(-Hv+Hr),HC=(Hw=-Ht+Hn-(-Ht+Hp))*(HA=-Hu+Ho-(-Hu+Hq))-(Hz=-Hv+Hr-(-Hv+Hp))*(Hx=-Hs+Ho-(-Hs+Hm)),Math.abs(HC)<.1?(HC+=10.1,Hf.push(Ho-Hs,Hp-Ht,Hh,Hi,Hj,Ho+Hs,Hp+Ht,Hh,Hi,Hj)):(((Hk=(Hx*HB-HA*Hy)/HC)-Ho)*(Hk-Ho)+((Hl=(Hz*Hy-Hw*HB)/HC)-Hp)+(Hl-Hp),Hf.push(Hk,Hl,Hh,Hi,Hj,Ho-(Hk-Ho),Hp-(Hl-Hp),Hh,Hi,Hj));Hm=He[He.length-10],Hn=He[He.length-9],Ht=Hm-(Ho=He[He.length-5]),Hs=(Hs=-(Hn-(Hp=He[He.length-4])))/(HD=Math.sqrt(Hs*Hs+Ht*Ht))*HG,Ht=Ht/HD*HG,Hf.push(Ho-Hs,Hp-Ht,Hh,Hi,Hj,Ho+Hs,Hp+Ht,Hh,Hi,Hj);var HI=this.edges+1;for(HH=1;HH<HI;HH++)Hb.push(HF+2*(HH-1),HF+2*(HH-1)+1,HF+2*HH+1,HF+2*HH+1,HF+2*HH,HF+2*(HH-1));return Hf},Hb.createLoopLine=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=Ha.concat(),Hh=He||Ha,Hi=this.borderColor,Hj=(Hi>>16&255)/255,Hk=(Hi>>8&255)/255,Hl=(255&Hi)/255;Hg.splice(0,5);var Hm=[Hg[0],Hg[1]],Hn=[Hg[Hg.length-5],Hg[Hg.length-4]],Ho=Hn[0]+.5*(Hm[0]-Hn[0]),Hp=Hn[1]+.5*(Hm[1]-Hn[1]);Hg.unshift(Ho,Hp,0,0,0),Hg.push(Ho,Hp,0,0,0);var Hq,Hr,Hs,Ht,Hu,Hv,Hw,Hx,Hy,Hz,HA,HB,HC,HD,HE,HF,HG,HH,HI,HJ,HK=Hg.length/5,HL=Hd,HM=Hc/2;Hs=Hg[0],Ht=Hg[1],Hz=Hs-(Hu=Hg[5]),Hy=(Hy=-(Ht-(Hv=Hg[6])))/(HJ=Math.sqrt(Hy*Hy+Hz*Hz))*HM,Hz=Hz/HJ*HM,Hh.push(Hs-Hy,Ht-Hz,Hj,Hk,Hl,Hs+Hy,Ht+Hz,Hj,Hk,Hl);for(var HN=1;HN<HK-1;HN++)Hs=Hg[5*(HN-1)],Ht=Hg[5*(HN-1)+1],Hu=Hg[5*HN],Hv=Hg[5*HN+1],Hw=Hg[5*(HN+1)],Hx=Hg[5*(HN+1)+1],Hz=Hs-Hu,HB=Hu-Hw,HE=(-(Hy=(Hy=-(Ht-Hv))/(HJ=Math.sqrt(Hy*Hy+Hz*Hz))*HM)+Hs)*(-(Hz=Hz/HJ*HM)+Hv)-(-Hy+Hu)*(-Hz+Ht),HH=(-(HA=(HA=-(Hv-Hx))/(HJ=Math.sqrt(HA*HA+HB*HB))*HM)+Hw)*(-(HB=HB/HJ*HM)+Hv)-(-HA+Hu)*(-HB+Hx),HI=(HC=-Hz+Ht-(-Hz+Hv))*(HG=-HA+Hu-(-HA+Hw))-(HF=-HB+Hx-(-HB+Hv))*(HD=-Hy+Hu-(-Hy+Hs)),Math.abs(HI)<.1?(HI+=10.1,Hh.push(Hu-Hy,Hv-Hz,Hj,Hk,Hl,Hu+Hy,Hv+Hz,Hj,Hk,Hl)):(((Hq=(HD*HH-HG*HE)/HI)-Hu)*(Hq-Hu)+((Hr=(HF*HE-HC*HH)/HI)-Hv)+(Hr-Hv),Hh.push(Hq,Hr,Hj,Hk,Hl,Hu-(Hq-Hu),Hv-(Hr-Hv),Hj,Hk,Hl));Hf&&(Hb=Hf);var HO=this.edges+1;for(HN=1;HN<HO;HN++)Hb.push(HL+2*(HN-1),HL+2*(HN-1)+1,HL+2*HN+1,HL+2*HN+1,HL+2*HN,HL+2*(HN-1));return Hb.push(HL+2*(HN-1),HL+2*(HN-1)+1,HL+1,HL+1,HL,HL+2*(HN-1)),Hh},Ha}(),Hda=function(){function Hp(){}return Hm(Hp,"laya.webgl.shapes.Earcut"),Hp.earcut=function(Ha,Hb,Hc){Hc=Hc||2;var Hd,He,Hf,Hg,Hh,Hi,Hj,Hk=Hb&&Hb.length,Hl=Hk?Hb[0]*Hc:Ha.length,Hm=Hp.linkedList(Ha,0,Hl,Hc,!0),Hn=[];if(!Hm)return Hn;if(Hk&&(Hm=Hp.eliminateHoles(Ha,Hb,Hm,Hc)),Ha.length>80*Hc){Hd=Hf=Ha[0],He=Hg=Ha[1];for(var Ho=Hc;Ho<Hl;Ho+=Hc)(Hh=Ha[Ho])<Hd&&(Hd=Hh),(Hi=Ha[Ho+1])<He&&(He=Hi),Hf<Hh&&(Hf=Hh),Hg<Hi&&(Hg=Hi);Hj=0!==(Hj=Math.max(Hf-Hd,Hg-He))?1/Hj:0}return Hp.earcutLinked(Hm,Hn,Hc,Hd,He,Hj),Hn},Hp.linkedList=function(Ha,Hb,Hc,Hd,He){var Hf,Hg;if(He===0<Hp.signedArea(Ha,Hb,Hc,Hd))for(Hf=Hb;Hf<Hc;Hf+=Hd)Hg=Hp.insertNode(Hf,Ha[Hf],Ha[Hf+1],Hg);else for(Hf=Hc-Hd;Hb<=Hf;Hf-=Hd)Hg=Hp.insertNode(Hf,Ha[Hf],Ha[Hf+1],Hg);return Hg&&Hp.equals(Hg,Hg.next)&&(Hp.removeNode(Hg),Hg=Hg.next),Hg},Hp.filterPoints=function(Ha,Hb){if(!Ha)return Ha;Hb||(Hb=Ha);var Hc,Hd=Ha;do{if(Hc=!1,Hd.steiner||!Hp.equals(Hd,Hd.next)&&0!==Hp.area(Hd.prev,Hd,Hd.next))Hd=Hd.next;else{if(Hp.removeNode(Hd),(Hd=Hb=Hd.prev)===Hd.next)break;Hc=!0}}while(Hc||Hd!==Hb);return Hb},Hp.earcutLinked=function(Ha,Hb,Hc,Hd,He,Hf,Hg){if(Ha){!Hg&&Hf&&Hp.indexCurve(Ha,Hd,He,Hf);for(var Hh,Hi,Hj=Ha;Ha.prev!==Ha.next;)if(Hh=Ha.prev,Hi=Ha.next,Hf?Hp.isEarHashed(Ha,Hd,He,Hf):Hp.isEar(Ha))Hb.push(Hh.i/Hc),Hb.push(Ha.i/Hc),Hb.push(Hi.i/Hc),Hp.removeNode(Ha),Ha=Hi.next,Hj=Hi.next;else if((Ha=Hi)===Hj){Hg?1===Hg?(Ha=Hp.cureLocalIntersections(Ha,Hb,Hc),Hp.earcutLinked(Ha,Hb,Hc,Hd,He,Hf,2)):2===Hg&&Hp.splitEarcut(Ha,Hb,Hc,Hd,He,Hf):Hp.earcutLinked(Hp.filterPoints(Ha,null),Hb,Hc,Hd,He,Hf,1);break}}},Hp.isEar=function(Ha){var Hb=Ha.prev,Hc=Ha,Hd=Ha.next;if(0<=Hp.area(Hb,Hc,Hd))return!1;for(var He=Ha.next.next;He!==Ha.prev;){if(Hp.pointInTriangle(Hb.x,Hb.y,Hc.x,Hc.y,Hd.x,Hd.y,He.x,He.y)&&0<=Hp.area(He.prev,He,He.next))return!1;He=He.next}return!0},Hp.isEarHashed=function(Ha,Hb,Hc,Hd){var He=Ha.prev,Hf=Ha,Hg=Ha.next;if(0<=Hp.area(He,Hf,Hg))return!1;for(var Hh=He.x<Hf.x?He.x<Hg.x?He.x:Hg.x:Hf.x<Hg.x?Hf.x:Hg.x,Hi=He.y<Hf.y?He.y<Hg.y?He.y:Hg.y:Hf.y<Hg.y?Hf.y:Hg.y,Hj=He.x>Hf.x?He.x>Hg.x?He.x:Hg.x:Hf.x>Hg.x?Hf.x:Hg.x,Hk=He.y>Hf.y?He.y>Hg.y?He.y:Hg.y:Hf.y>Hg.y?Hf.y:Hg.y,Hl=Hp.zOrder(Hh,Hi,Hb,Hc,Hd),Hm=Hp.zOrder(Hj,Hk,Hb,Hc,Hd),Hn=Ha.nextZ;Hn&&Hn.z<=Hm;){if(Hn!==Ha.prev&&Hn!==Ha.next&&Hp.pointInTriangle(He.x,He.y,Hf.x,Hf.y,Hg.x,Hg.y,Hn.x,Hn.y)&&0<=Hp.area(Hn.prev,Hn,Hn.next))return!1;Hn=Hn.nextZ}for(Hn=Ha.prevZ;Hn&&Hn.z>=Hl;){if(Hn!==Ha.prev&&Hn!==Ha.next&&Hp.pointInTriangle(He.x,He.y,Hf.x,Hf.y,Hg.x,Hg.y,Hn.x,Hn.y)&&0<=Hp.area(Hn.prev,Hn,Hn.next))return!1;Hn=Hn.prevZ}return!0},Hp.cureLocalIntersections=function(Ha,Hb,Hc){var Hd=Ha;do{var He=Hd.prev,Hf=Hd.next.next;!Hp.equals(He,Hf)&&Hp.intersects(He,Hd,Hd.next,Hf)&&Hp.locallyInside(He,Hf)&&Hp.locallyInside(Hf,He)&&(Hb.push(He.i/Hc),Hb.push(Hd.i/Hc),Hb.push(Hf.i/Hc),Hp.removeNode(Hd),Hp.removeNode(Hd.next),Hd=Ha=Hf),Hd=Hd.next}while(Hd!==Ha);return Hd},Hp.splitEarcut=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=Ha;do{for(var Hh=Hg.next.next;Hh!==Hg.prev;){if(Hg.i!==Hh.i&&Hp.isValidDiagonal(Hg,Hh)){var Hi=Hp.splitPolygon(Hg,Hh);return Hg=Hp.filterPoints(Hg,Hg.next),Hi=Hp.filterPoints(Hi,Hi.next),Hp.earcutLinked(Hg,Hb,Hc,Hd,He,Hf),void Hp.earcutLinked(Hi,Hb,Hc,Hd,He,Hf)}Hh=Hh.next}Hg=Hg.next}while(Hg!==Ha)},Hp.eliminateHoles=function(Ha,Hb,Hc,Hd){var He,Hf,Hg,Hh,Hi,Hj=[];for(He=0,Hf=Hb.length;He<Hf;He++)Hg=Hb[He]*Hd,Hh=He<Hf-1?Hb[He+1]*Hd:Ha.length,(Hi=Hp.linkedList(Ha,Hg,Hh,Hd,!1))===Hi.next&&(Hi.steiner=!0),Hj.push(Hp.getLeftmost(Hi));for(Hj.sort(Hp.compareX),He=0;He<Hj.length;He++)Hp.eliminateHole(Hj[He],Hc),Hc=Hp.filterPoints(Hc,Hc.next);return Hc},Hp.compareX=function(Ha,Hb){return Ha.x-Hb.x},Hp.eliminateHole=function(Ha,Hb){if(Hb=Hp.findHoleBridge(Ha,Hb)){var Hc=Hp.splitPolygon(Hb,Ha);Hp.filterPoints(Hc,Hc.next)}},Hp.findHoleBridge=function(Ha,Hb){var Hc,Hd=Hb,He=Ha.x,Hf=Ha.y,Hg=-1/0;do{if(Hf<=Hd.y&&Hf>=Hd.next.y&&Hd.next.y!==Hd.y){var Hh=Hd.x+(Hf-Hd.y)*(Hd.next.x-Hd.x)/(Hd.next.y-Hd.y);if(Hh<=He&&Hg<Hh){if((Hg=Hh)===He){if(Hf===Hd.y)return Hd;if(Hf===Hd.next.y)return Hd.next}Hc=Hd.x<Hd.next.x?Hd:Hd.next}}Hd=Hd.next}while(Hd!==Hb);if(!Hc)return null;if(He===Hg)return Hc.prev;var Hi,Hj=Hc,Hk=Hc.x,Hl=Hc.y,Hm=1/0;for(Hd=Hc.next;Hd!==Hj;)He>=Hd.x&&Hd.x>=Hk&&He!==Hd.x&&Hp.pointInTriangle(Hf<Hl?He:Hg,Hf,Hk,Hl,Hf<Hl?Hg:He,Hf,Hd.x,Hd.y)&&((Hi=Math.abs(Hf-Hd.y)/(He-Hd.x))<Hm||Hi===Hm&&Hd.x>Hc.x)&&Hp.locallyInside(Hd,Ha)&&(Hc=Hd,Hm=Hi),Hd=Hd.next;return Hc},Hp.indexCurve=function(Ha,Hb,Hc,Hd){for(var He=Ha;null===He.z&&(He.z=Hp.zOrder(He.x,He.y,Hb,Hc,Hd)),He.prevZ=He.prev,He.nextZ=He.next,(He=He.next)!==Ha;);He.prevZ.nextZ=null,He.prevZ=null,Hp.sortLinked(He)},Hp.sortLinked=function(Ha){var Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj=1;do{for(Hc=Ha,Hf=Ha=null,Hg=0;Hc;){for(Hg++,Hd=Hc,Hb=Hh=0;Hb<Hj&&(Hh++,Hd=Hd.nextZ);Hb++);for(Hi=Hj;0<Hh||0<Hi&&Hd;)0!==Hh&&(0===Hi||!Hd||Hc.z<=Hd.z)?(Hc=(He=Hc).nextZ,Hh--):(Hd=(He=Hd).nextZ,Hi--),Hf?Hf.nextZ=He:Ha=He,He.prevZ=Hf,Hf=He;Hc=Hd}Hf.nextZ=null,Hj*=2}while(1<Hg);return Ha},Hp.zOrder=function(Ha,Hb,Hc,Hd,He){return(Ha=1431655765&((Ha=858993459&((Ha=252645135&((Ha=16711935&((Ha=32767*(Ha-Hc)*He)|Ha<<8))|Ha<<4))|Ha<<2))|Ha<<1))|(Hb=1431655765&((Hb=858993459&((Hb=252645135&((Hb=16711935&((Hb=32767*(Hb-Hd)*He)|Hb<<8))|Hb<<4))|Hb<<2))|Hb<<1))<<1},Hp.getLeftmost=function(Ha){for(var Hb=Ha,Hc=Ha;Hb.x<Hc.x&&(Hc=Hb),(Hb=Hb.next)!==Ha;);return Hc},Hp.pointInTriangle=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){return 0<=(He-Hg)*(Hb-Hh)-(Ha-Hg)*(Hf-Hh)&&0<=(Ha-Hg)*(Hd-Hh)-(Hc-Hg)*(Hb-Hh)&&0<=(Hc-Hg)*(Hf-Hh)-(He-Hg)*(Hd-Hh)},Hp.isValidDiagonal=function(Ha,Hb){return Ha.next.i!==Hb.i&&Ha.prev.i!==Hb.i&&!Hp.intersectsPolygon(Ha,Hb)&&Hp.locallyInside(Ha,Hb)&&Hp.locallyInside(Hb,Ha)&&Hp.middleInside(Ha,Hb)},Hp.area=function(Ha,Hb,Hc){return(Hb.y-Ha.y)*(Hc.x-Hb.x)-(Hb.x-Ha.x)*(Hc.y-Hb.y)},Hp.equals=function(Ha,Hb){return Ha.x===Hb.x&&Ha.y===Hb.y},Hp.intersects=function(Ha,Hb,Hc,Hd){return!!(Hp.equals(Ha,Hb)&&Hp.equals(Hc,Hd)||Hp.equals(Ha,Hd)&&Hp.equals(Hc,Hb))||0<Hp.area(Ha,Hb,Hc)!=0<Hp.area(Ha,Hb,Hd)&&0<Hp.area(Hc,Hd,Ha)!=0<Hp.area(Hc,Hd,Hb)},Hp.intersectsPolygon=function(Ha,Hb){var Hc=Ha;do{if(Hc.i!==Ha.i&&Hc.next.i!==Ha.i&&Hc.i!==Hb.i&&Hc.next.i!==Hb.i&&Hp.intersects(Hc,Hc.next,Ha,Hb))return!0;Hc=Hc.next}while(Hc!==Ha);return!1},Hp.locallyInside=function(Ha,Hb){return Hp.area(Ha.prev,Ha,Ha.next)<0?0<=Hp.area(Ha,Hb,Ha.next)&&0<=Hp.area(Ha,Ha.prev,Hb):Hp.area(Ha,Hb,Ha.prev)<0||Hp.area(Ha,Ha.next,Hb)<0},Hp.middleInside=function(Ha,Hb){for(var Hc=Ha,Hd=!1,He=(Ha.x+Hb.x)/2,Hf=(Ha.y+Hb.y)/2;Hc.y>Hf!=Hc.next.y>Hf&&Hc.next.y!==Hc.y&&He<(Hc.next.x-Hc.x)*(Hf-Hc.y)/(Hc.next.y-Hc.y)+Hc.x&&(Hd=!Hd),(Hc=Hc.next)!==Ha;);return Hd},Hp.splitPolygon=function(Ha,Hb){var Hc=new Hea(Ha.i,Ha.x,Ha.y),Hd=new Hea(Hb.i,Hb.x,Hb.y),He=Ha.next,Hf=Hb.prev;return(Ha.next=Hb).prev=Ha,(Hc.next=He).prev=Hc,(Hd.next=Hc).prev=Hd,(Hf.next=Hd).prev=Hf,Hd},Hp.insertNode=function(Ha,Hb,Hc,Hd){var He=new Hea(Ha,Hb,Hc);return Hd?(He.next=Hd.next,(He.prev=Hd).next.prev=He,Hd.next=He):(He.prev=He).next=He,He},Hp.removeNode=function(Ha){Ha.next.prev=Ha.prev,Ha.prev.next=Ha.next,Ha.prevZ&&(Ha.prevZ.nextZ=Ha.nextZ),Ha.nextZ&&(Ha.nextZ.prevZ=Ha.prevZ)},Hp.signedArea=function(Ha,Hb,Hc,Hd){for(var He=0,Hf=Hb,Hg=Hc-Hd;Hf<Hc;Hf+=Hd)He+=(Ha[Hg]-Ha[Hf])*(Ha[Hf+1]+Ha[Hg+1]),Hg=Hf;return He},Hp}(),Hea=function(){function Ha(Ha,Hb,Hc){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=Ha,this.x=Hb,this.y=Hc,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return Hm(Ha,"laya.webgl.shapes.EarcutNode"),Ha}(),Hfa=(function(){function Ha(Ha,Hb,Hc,Hd,He,Hf,Hg){this.lineWidth=Ha,this.lineColor=Hb,this.lineAlpha=Hc,this.fillColor=Hd,this.fillAlpha=He,this.shape=Hg,this.fill=Hf}Hm(Ha,"laya.webgl.shapes.GeometryData");var Hb=Ha.prototype;Hb.clone=function(){return new Ha(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},Hb.getIndexData=function(){return null},Hb.getVertexData=function(){return null},Hb.destroy=function(){this.shape=null}}(),function(){function Ha(Ha){if(Ha instanceof Float32Array)this.points=Ha;else if(Ha instanceof Array){Ha.length;this.points=new Float32Array(Ha)}}Hm(Ha,"laya.webgl.shapes.Vertex");var Hb=Ha.prototype;Hw.imps(Hb,{"laya.webgl.shapes.IShape":!0}),Hb.getData=function(Ha,Hb,Hc){},Hb.needUpdate=function(Ha){return!1},Hb.rebuild=function(Ha){},Hb.setMatrix=function(Ha){}}(),function(){function Hi(Ha){void 0===Ha&&(Ha=1e4),this._renderType=Ha}Hm(Hi,"laya.webgl.submit.Submit");var Ha=Hi.prototype;return Hw.imps(Ha,{"laya.webgl.submit.ISubmit":!0}),Ha.releaseRender=function(){var Ha=Hi._cache;(Ha[Ha._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Ha.getRenderType=function(){return this._renderType},Ha.renderSubmit=function(){if(0===this._numEle)return 1;var Ha=this.shaderValue.textureHost;if(Ha){var Hb=Ha.source;if(!Ha.bitmap||!Hb)return 1;this.shaderValue.texture=Hb,Ha.alphaTexture&&Ha.alphaTexture.source&&(this.shaderValue.texture1=Ha.alphaTexture.source)}this._vb.bind_upload(this._ib);var Hc=Hua.mainContext;return this.shaderValue.upload(),HQ.activeBlendFunction!==this._blendFn&&(Hc.enable(3042),this._blendFn(Hc),HQ.activeBlendFunction=this._blendFn),HE.drawCall++,HE.trianglesFaces+=this._numEle/3,Hc.drawElements(4,this._numEle,5123,this._startIdx),1},Hi.__init__=function(){var Ha=Hi.RENDERBASE=new Hi(-1);Ha.shaderValue=new Hya(0,0),Ha.shaderValue.ALPHA=-1234},Hi.createSubmit=function(Ha,Hb,Hc,Hd,He){var Hf=Hi._cache._length?Hi._cache[--Hi._cache._length]:new Hi;null==Hc&&((Hc=Hf._selfVb||(Hf._selfVb=H_a.create(-1))).clear(),Hd=0),Hf._ib=Hb,Hf._vb=Hc,Hf._startIdx=Hd*Hpa.BYTES_PIDX,Hf._numEle=0;var Hg=Ha._nBlendType;Hf._blendFn=Ha._targets?HQ.targetFns[Hg]:HQ.fns[Hg],Hf.shaderValue=He,Hf.shaderValue.setValue(Ha._shader2D);var Hh=Ha._shader2D.filters;return Hh&&Hf.shaderValue.setFilters(Hh),Hf},Hi.createShape=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=Hi._cache._length?Hi._cache[--Hi._cache._length]:new Hi;Hg._ib=Hb,Hg._vb=Hc,Hg._numEle=Hd,Hg._startIdx=He,Hg.shaderValue=Hf,Hg.shaderValue.setValue(Ha._shader2D);var Hh=Ha._nBlendType;return Hg._blendFn=Ha._targets?HQ.targetFns[Hh]:HQ.fns[Hh],Hg},Hi.TYPE_2D=1e4,Hi.TYPE_CANVAS=10003,Hi.TYPE_CMDSETRT=10004,Hi.TYPE_CUSTOM=10005,Hi.TYPE_BLURRT=10006,Hi.TYPE_CMDDESTORYPRERT=10007,Hi.TYPE_DISABLESTENCIL=10008,Hi.TYPE_OTHERIBVB=10009,Hi.TYPE_PRIMITIVE=10010,Hi.TYPE_RT=10011,Hi.TYPE_BLUR_RT=10012,Hi.TYPE_TARGET=10013,Hi.TYPE_CHANGE_VALUE=10014,Hi.TYPE_SHAPE=10015,Hi.TYPE_TEXTURE=10016,Hi.TYPE_FILLTEXTURE=10017,Hi.RENDERBASE=null,Hi._cache=((Hi._cache=[])._length=0,Hi._cache),Hi}()),Hga=function(){function Hd(){this.fun=null,this.args=null}Hm(Hd,"laya.webgl.submit.SubmitCMD");var Ha=Hd.prototype;return Hw.imps(Ha,{"laya.webgl.submit.ISubmit":!0}),Ha.renderSubmit=function(){return this.fun.apply(null,this.args),1},Ha.getRenderType=function(){return 0},Ha.releaseRender=function(){var Ha=Hd._cache;Ha[Ha._length++]=this},Hd.create=function(Ha,Hb){var Hc=Hd._cache._length?Hd._cache[--Hd._cache._length]:new Hd;return Hc.fun=Hb,Hc.args=Ha,Hc},Hd._cache=((Hd._cache=[])._length=0,Hd._cache),Hd}(),Hha=function(){function Hb(){this.variables={}}Hm(Hb,"laya.webgl.submit.SubmitCMDScope");var Ha=Hb.prototype;return Ha.getValue=function(Ha){return this.variables[Ha]},Ha.addValue=function(Ha,Hb){return this.variables[Ha]=Hb},Ha.setValue=function(Ha,Hb){return this.variables.hasOwnProperty(Ha)?this.variables[Ha]=Hb:null},Ha.clear=function(){for(var Ha in this.variables)delete this.variables[Ha]},Ha.recycle=function(){this.clear(),Hb.POOL.push(this)},Hb.create=function(){var Ha=Hb.POOL.pop();return Ha||(Ha=new Hb),Ha},Hb.POOL=[],Hb}(),Hia=function(){function Hl(){this.offset=0,this.startIndex=0,this._mat=Hz.create()}Hm(Hl,"laya.webgl.submit.SubmitOtherIBVB");var Ha=Hl.prototype;return Hw.imps(Ha,{"laya.webgl.submit.ISubmit":!0}),Ha.releaseRender=function(){var Ha=Hl._cache;(Ha[Ha._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Ha.getRenderType=function(){return 10009},Ha.renderSubmit=function(){var Ha=this._shaderValue.textureHost;if(Ha){var Hb=Ha.source;if(!Ha.bitmap||!Hb)return 1;this._shaderValue.texture=Hb}this._vb.bind_upload(this._ib);var Hc=Hsa.worldMatrix4,Hd=Hz.TEMP;Hz.mulPre(this._mat,Hc[0],Hc[1],Hc[4],Hc[5],Hc[12],Hc[13],Hd);var He=Hsa.worldMatrix4=Hl.tempMatrix4;He[0]=Hd.a,He[1]=Hd.b,He[4]=Hd.c,He[5]=Hd.d,He[12]=Hd.tx,He[13]=Hd.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var Hf=Hua.mainContext;return HQ.activeBlendFunction!==this._blendFn&&(Hf.enable(3042),this._blendFn(Hf),HQ.activeBlendFunction=this._blendFn),HE.drawCall++,HE.trianglesFaces+=this._numEle/3,Hf.drawElements(4,this._numEle,5123,this.startIndex),Hsa.worldMatrix4=Hc,HJa.activeShader=null,1},Hl.create=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){void 0===Hi&&(Hi=0);var Hj=Hl._cache._length?Hl._cache[--Hl._cache._length]:new Hl;Hj._ib=Hc,Hj._vb=Hb,Hj._numEle=Hd,Hj._shader=He,Hj._shaderValue=Hf;var Hk=Ha._nBlendType;switch(Hj._blendFn=Ha._targets?HQ.targetFns[Hk]:HQ.fns[Hk],Hi){case 0:Hj.offset=0,Hj.startIndex=Hh/(Hpa.BYTES_PE*Hb.vertexStride)*1.5,Hj.startIndex*=Hpa.BYTES_PIDX;break;case 1:Hj.startIndex=Hg,Hj.offset=Hh}return Hj},Hl._cache=((Hl._cache=[])._length=0,Hl._cache),Hl.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Hl}(),Hja=function(){function Hc(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new HB,this.screenRect=new HB}Hm(Hc,"laya.webgl.submit.SubmitScissor");var Ha=Hc.prototype;return Hw.imps(Ha,{"laya.webgl.submit.ISubmit":!0}),Ha._scissor=function(Ha,Hb,Hc,Hd){var He=Hsa.worldMatrix4,Hf=He[0],Hg=He[5],Hh=He[12],Hi=He[13];if(Hd*=Hg,(Hc*=Hf)<1||Hd<1)return!1;var Hj=(Ha=Ha*Hf+Hh)+Hc,Hk=(Hb=Hb*Hg+Hi)+Hd;Ha<0&&(Hc=Hj-(Ha=0)),Hb<0&&(Hd=Hk-(Hb=0));var Hl=Hsa.worldClipRect;if(Ha=Math.max(Ha,Hl.x),Hb=Math.max(Hb,Hl.y),Hc=Math.min(Hj,Hl.right)-Ha,Hd=Math.min(Hk,Hl.bottom)-Hb,Hc<1||Hd<1)return!1;var Hm=Hsa.worldScissorTest;return this.screenRect.copyFrom(Hl),Hl.x=Ha,Hl.y=Hb,Hl.width=Hc,Hl.height=Hd,Hsa.worldScissorTest=!0,Hb=Hsa.height-Hb-Hd,Hua.mainContext.scissor(Ha,Hb,Hc,Hd),Hua.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),Hm?(Hb=Hsa.height-this.screenRect.y-this.screenRect.height,Hua.mainContext.scissor(this.screenRect.x,Hb,this.screenRect.width,this.screenRect.height),Hua.mainContext.enable(3089)):(Hua.mainContext.disable(3089),Hsa.worldScissorTest=!1),Hl.copyFrom(this.screenRect),!0},Ha._scissorWithTagart=function(Ha,Hb,Hc,Hd){if(Hc<1||Hd<1)return!1;var He=Ha+Hc,Hf=Hb+Hd;Ha<0&&(Hc=He-(Ha=0)),Hb<0&&(Hd=Hf-(Hb=0));var Hg=Hsa.worldClipRect;if(Ha=Math.max(Ha,Hg.x),Hb=Math.max(Hb,Hg.y),Hc=Math.min(He,Hg.right)-Ha,Hd=Math.min(Hf,Hg.bottom)-Hb,Hc<1||Hd<1)return!1;var Hh=Hsa.worldScissorTest;return this.screenRect.copyFrom(Hg),Hsa.worldScissorTest=!0,Hg.x=Ha,Hg.y=Hb,Hg.width=Hc,Hg.height=Hd,Hb=Hsa.height-Hb-Hd,Hua.mainContext.scissor(Ha,Hb,Hc,Hd),Hua.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),Hh?(Hb=Hsa.height-this.screenRect.y-this.screenRect.height,Hua.mainContext.scissor(this.screenRect.x,Hb,this.screenRect.width,this.screenRect.height),Hua.mainContext.enable(3089)):(Hua.mainContext.disable(3089),Hsa.worldScissorTest=!1),Hg.copyFrom(this.screenRect),!0},Ha.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},Ha.getRenderType=function(){return 0},Ha.releaseRender=function(){var Ha=Hc._cache;(Ha[Ha._length++]=this).context=null},Hc.create=function(Ha){var Hb=Hc._cache._length?Hc._cache[--Hc._cache._length]:new Hc;return Hb.context=Ha,Hb},Hc._cache=((Hc._cache=[])._length=0,Hc._cache),Hc}(),Hka=function(){function Hi(){this.step=0,this.blendMode=null,this.level=0}Hm(Hi,"laya.webgl.submit.SubmitStencil");var Ha=Hi.prototype;return Hw.imps(Ha,{"laya.webgl.submit.ISubmit":!0}),Ha.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},Ha.getRenderType=function(){return 0},Ha.releaseRender=function(){var Ha=Hi._cache;Ha[Ha._length++]=this},Ha.do1=function(){var Ha=Hua.mainContext;Ha.enable(2960),Ha.clear(1024),Ha.colorMask(!1,!1,!1,!1),Ha.stencilFunc(514,this.level,255),Ha.stencilOp(7680,7680,7682)},Ha.do2=function(){var Ha=Hua.mainContext;Ha.stencilFunc(514,this.level+1,255),Ha.colorMask(!0,!0,!0,!0),Ha.stencilOp(7680,7680,7680)},Ha.do3=function(){var Ha=Hua.mainContext;Ha.colorMask(!0,!0,!0,!0),Ha.stencilOp(7680,7680,7680),Ha.clear(1024),Ha.disable(2960)},Ha.do4=function(){var Ha=Hua.mainContext;0==this.level&&(Ha.enable(2960),Ha.clear(1024)),Ha.colorMask(!1,!1,!1,!1),Ha.stencilFunc(519,0,255),Ha.stencilOp(7680,7680,7682)},Ha.do5=function(){var Ha=Hua.mainContext;Ha.stencilFunc(514,this.level,255),Ha.colorMask(!0,!0,!0,!0),Ha.stencilOp(7680,7680,7680)},Ha.do6=function(){var Ha=Hua.mainContext;HQ.targetFns[HQ.TOINT[this.blendMode]](Ha)},Ha.do7=function(){var Ha=Hua.mainContext;Ha.colorMask(!1,!1,!1,!1),Ha.stencilOp(7680,7680,7683)},Ha.do8=function(){var Ha=Hua.mainContext;Ha.colorMask(!0,!0,!0,!0),Ha.stencilFunc(514,this.level,255),Ha.stencilOp(7680,7680,7680)},Hi.restore=function(Ha,Hb,Hc,Hd,He){var Hf;if((Ha._renderKey=0)<Hi._mask&&Hi._mask--,0==Hi._mask)Hf=laya.webgl.submit.SubmitStencil.create(3),Ha.addRenderObject(Hf),Ha._curSubmit=Hfa.RENDERBASE;else{Hf=laya.webgl.submit.SubmitStencil.create(7),Ha.addRenderObject(Hf);var Hg=Ha._vb;Hg._byteLength;if(Hqa.fillRectImgVb(Hg,null,Hb.x,Hb.y,Hb.width,Hb.height,HI.DEF_UV,Hc,Hd,He,0,0)){Ha._shader2D.glTexture=null;var Hh=Ha._curSubmit=Hfa.createSubmit(Ha,Ha._ib,Hg,(Hg._byteLength-64)/32*3,Hya.create(2,0));Hh.shaderValue.ALPHA=1,Ha._submits[Ha._submits._length++]=Hh,Ha._curSubmit._numEle+=6,Ha._curSubmit=Hfa.RENDERBASE}else alert("clipRect calc stencil rect error");Hf=laya.webgl.submit.SubmitStencil.create(8),Ha.addRenderObject(Hf)}},Hi.restore2=function(Ha,Hb){var Hc;(Ha._renderKey=0)<Hi._mask&&Hi._mask--,0==Hi._mask?(Hc=laya.webgl.submit.SubmitStencil.create(3),Ha.addRenderObject(Hc),Ha._curSubmit=Hfa.RENDERBASE):(Hc=laya.webgl.submit.SubmitStencil.create(7),Ha.addRenderObject(Hc),Ha._submits[Ha._submits._length++]=Hb,Hc=laya.webgl.submit.SubmitStencil.create(8),Ha.addRenderObject(Hc))},Hi.create=function(Ha){var Hb=Hi._cache._length?Hi._cache[--Hi._cache._length]:new Hi;return 5==(Hb.step=Ha)&&++Hi._mask,Hb.level=Hi._mask,Hb},Hi._cache=((Hi._cache=[])._length=0,Hi._cache),Hi._mask=0,Hi}(),Hla=function(){function Hh(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}Hm(Hh,"laya.webgl.submit.SubmitTarget");var Ha=Hh.prototype;return Hw.imps(Ha,{"laya.webgl.submit.ISubmit":!0}),Ha.renderSubmit=function(){this._vb.bind_upload(this._ib);var Ha=this.scope.getValue(this.proName);return Ha&&(this.shaderValue.texture=Ha.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[Ha.width,Ha.height]),this.shaderValue.upload(),this.blend(),HE.drawCall++,HE.trianglesFaces+=this._numEle/3,Hua.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},Ha.blend=function(){if(HQ.activeBlendFunction!==HQ.fns[this.blendType]){var Ha=Hua.mainContext;Ha.enable(3042),HQ.fns[this.blendType](Ha),HQ.activeBlendFunction=HQ.fns[this.blendType]}},Ha.getRenderType=function(){return 0},Ha.releaseRender=function(){var Ha=Hh._cache;(Ha[Ha._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Hh.create=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=Hh._cache._length?Hh._cache[--Hh._cache._length]:new Hh;return Hg._ib=Hb,Hg._vb=Hc,Hg.proName=Hf,Hg._startIdx=Hd*Hpa.BYTES_PIDX,Hg._numEle=0,Hg.blendType=Ha._nBlendType,Hg.shaderValue=He,Hg.shaderValue.setValue(Ha._shader2D),Hg},Hh._cache=((Hh._cache=[])._length=0,Hh._cache),Hh}(),Hma=function(){function Ha(){this._sourceStr=null}Hm(Ha,"laya.webgl.text.CharSegment");var Hb=Ha.prototype;return Hw.imps(Hb,{"laya.webgl.text.ICharSegment":!0}),Hb.textToSpit=function(Ha){this._sourceStr=Ha},Hb.getChar=function(Ha){return this._sourceStr.charAt(Ha)},Hb.getCharCode=function(Ha){return this._sourceStr.charCodeAt(Ha)},Hb.length=function(){return this._sourceStr.length},Ha}(),Hna=function(){var Ha;function HE(){}return Hm(HE,"laya.webgl.text.DrawText"),HE.__init__=function(){HE._charsTemp=new Array,HE._drawValue=new Ha,HE._charSeg=new Hma},HE.customCharSeg=function(Ha){HE._charSeg=Ha},HE.getChar=function(Ha,Hb,Hc){var Hd=HTa.createOneChar(Ha,Hc);return-1!=Hb&&(HE._charsCache[Hb]=Hd),Hd},HE._drawSlow=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hl,Hm,Hn,Ho){var Hp,Hq,Hr=HE._drawValue.value(Hf,Hh,Hi,Hj,Hm,Hn,Ho),Hs=0,Ht=0,Hu=HE._charsTemp,Hv=0,Hw=NaN;if(Hd)for(Hu.length=Hd.length,Hs=0,Ht=Hd.length;Hs<Ht;Hs++)(Hq=Hd[Hs])&&(Hw=Hq.charNum+Hr.txtID,Hu[Hs]=Hp=HE._charsCache[Hw]||HE.getChar(Hq.char,Hw,Hr),Hp.active());else{var Hx=Hc instanceof laya.utils.WordText?Hc.toString():Hc;if(HH.CharacterCache){HE._charSeg.textToSpit(Hx);var Hy=HE._charSeg.length();for(Hs=0,Ht=Hu.length=Hy;Hs<Ht;Hs++)Hw=HE._charSeg.getCharCode(Hs)+Hr.txtID,Hu[Hs]=Hp=HE._charsCache[Hw]||HE.getChar(HE._charSeg.getChar(Hs),Hw,Hr),Hp.active(),Hv+=Hp.cw}else Hu.length=0,(Hp=HE.getChar(Hx,-1,Hr)).active(),Hv+=Hp.cw,Hu[0]=Hp}var Hz=0;null!==Hg&&"left"!==Hg&&(Hz=-("center"==Hg?Hv/2:Hv));var HA,HB,HC=NaN,HD=0;if(Hd)for(Hs=0,Ht=Hu.length;Hs<Ht;Hs++)Hp=Hu[Hs],Hq=Hd[Hs],Hp&&Hq&&!Hp.isSpace&&(HC=Hp.borderSize,HA=Hp.texture,Hb._drawText(HA,Hk+Hz+Hq.x*Hm-HC,Hl+Hq.y*Hn-HC,HA.width,HA.height,He,0,0,0,0));else{for(Hs=0,Ht=Hu.length;Hs<Ht;Hs++)(Hp=Hu[Hs])&&!Hp.isSpace&&(HC=Hp.borderSize,HA=Hp.texture,Hb._drawText(HA,Hk+Hz-HC,Hl-HC,HA.width,HA.height,He,0,0,0,0),Ha&&((HB=Ha[HD++])||(HB=Ha[HD-1]=[]),HB[0]=HA,HB[1]=Hz-HC,HB[2]=-HC)),Hz+=Hp.cw;Ha&&(Ha.length=HD)}},HE._drawFast=function(Ha,Hb,Hc,Hd,He){for(var Hf,Hg,Hh=0,Hi=Ha.length;Hh<Hi;Hh++)(Hf=(Hg=Ha[Hh])[0]).active(),Hb._drawText(Hf,Hd+Hg[1],He+Hg[2],Hf.width,Hf.height,Hc,0,0,0,0)},HE.drawText=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hl){if(void 0===Hl&&(Hl=0),!(Hb&&0===Hb.length||Hc&&0===Hc.length)){var Hm=Hd.a,Hn=Hd.d;(0!==Hd.b||0!==Hd.c)&&(Hm=Hn=1);var Ho=1!==Hm||1!==Hn;if(Ho&&Hw.stage.transform){var Hp=Hw.stage.transform;Ho=Hp.a===Hm&&Hp.d===Hn}else Ho=!1;if(Ho){var Hq=(Hd=Hd.copyTo(Hxa._tmpMatrix)).tx,Hr=Hd.ty;Hd.scale(1/Hm,1/Hn),Hd._checkTransform(),Hj*=Hm,Hk*=Hn,Hj+=Hq-Hd.tx,Hk+=Hr-Hd.ty}else Hm=Hn=1;if(Hc)HE._drawSlow(null,Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hm,Hn,Hl);else{if(null===Hb.toUpperCase){var Hs=Hm+1e5*Hn,Ht=Hb;return void(Ht.changed||Ht.id!==Hs?(Ht.id=Hs,Ht.changed=!1,HE._drawSlow(Ht.save,Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hm,Hn,Hl)):HE._drawFast(Ht.save,Ha,Hd,Hj,Hk))}var Hu=Hb+He.toString()+Hg+Hh+Hi+Hm+Hn+Hf,Hv=HE._textsCache[Hu];HH.CharacterCache?Hv?HE._drawFast(Hv,Ha,Hd,Hj,Hk):(HE._textsCache.__length||(HE._textsCache.__length=0),HE._textsCache.__length>Hx.WebGLTextCacheCount&&((HE._textsCache={}).__length=0,HE._curPoolIndex=0),HE._textCachesPool[HE._curPoolIndex]?(Hv=HE._textsCache[Hu]=HE._textCachesPool[HE._curPoolIndex]).length=0:HE._textCachesPool[HE._curPoolIndex]=Hv=HE._textsCache[Hu]=[],HE._textsCache.__length++,HE._curPoolIndex++,HE._drawSlow(Hv,Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hm,Hn,Hl)):HE._drawSlow(Hv,Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hm,Hn,Hl)}}},HE._charsTemp=null,HE._textCachesPool=[],HE._curPoolIndex=0,HE._charsCache={},HE._textsCache={},HE._drawValue=null,HE.d=[],HE._charSeg=null,HE.__init$=function(){Ha=function(){function Hi(){}return Hm(Hi,""),Hi.prototype.value=function(Ha,Hb,Hc,Hd,He,Hf,Hg){this.font=Ha,this.fillColor=Hb,this.borderColor=Hc,this.lineWidth=Hd,this.scaleX=He,this.scaleY=Hf,this.underLine=Hg;var Hh=Ha.toString()+He+Hf+Hd+(Hb?Hb.toLowerCase():" ")+(Hc?Hc.toLowerCase():" ")+Hg;return this.txtID=Hi._keymap[Hh],this.txtID||(this.txtID=1e-7*++Hi._keymapCount,Hi._keymap[Hh]=this.txtID),this},Hi.clear=function(){Hi._keymap={},Hi._keymapCount=1},Hi._keymap={},Hi._keymapCount=1,Hi}()},HE}(),Hoa=function(){function He(Ha){this._index=0,this._size=14,this._italic=-2,He._cache2=He._cache2||[],this.setFont(Ha||"14px Arial")}Hm(He,"laya.webgl.text.FontInContext");var Ha=He.prototype;return Ha.setFont=function(Ha){var Hb=He._cache2[Ha];if(Hb)this._words=Hb[0],this._size=Hb[1];else{this._words=Ha.split(" ");for(var Hc=0,Hd=this._words.length;Hc<Hd;Hc++)if(0<this._words[Hc].indexOf("px")){this._index=Hc;break}this._size=parseInt(this._words[this._index]),He._cache2[Ha]=[this._words,this._size]}this._text=null,this._italic=-2},Ha.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},Ha.hasType=function(Ha){for(var Hb=0,Hc=this._words.length;Hb<Hc;Hb++)if(this._words[Hb]===Ha)return Hb;return-1},Ha.removeType=function(Ha){for(var Hb=0,Hc=this._words.length;Hb<Hc;Hb++)if(this._words[Hb]===Ha){this._words.splice(Hb,1),this._index>Hb&&this._index--;break}this._text=null,this._italic=-2},Ha.copyTo=function(Ha){return Ha._text=this._text,Ha._size=this._size,Ha._index=this._index,Ha._words=this._words.slice(),Ha._italic=-2,Ha},Ha.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},Hd(0,Ha,"size",function(){return this._size},function(Ha){this._size=Ha,this._words[this._index]=Ha+"px",this._text=null}),He.create=function(Ha){var Hb=He._cache[Ha];return Hb||(Hb=He._cache[Ha]=new He(Ha))},He.EMPTY=new He,He._cache={},He._cache2=null,He}(),Hpa=function(){function Ha(){}return Hm(Ha,"laya.webgl.utils.CONST3D2D"),Ha.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ha.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],Ha.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],Ha._TMPARRAY=[],Ha._OFFSETX=0,Ha._OFFSETY=0,Hg(Ha,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),Ha}(),Hqa=function(){function Ho(){}return Hm(Ho,"laya.webgl.utils.GlUtils"),Ho.make2DProjection=function(Ha,Hb,Hc){return[2/Ha,0,0,0,0,-2/Hb,0,0,0,0,2/Hc,0,-1,1,0,1]},Ho.fillIBQuadrangle=function(Ha,Hb){if(65535/4<Hb)throw Error("IBQuadrangle count:"+Hb+" must<:"+Math.floor(65535/4));Hb=Math.floor(Hb),Ha._resizeBuffer(6*(Hb+1)*2,!1),Ha.byteLength=Ha.bufferLength;for(var Hc=Ha.getUint16Array(),Hd=0,He=0;He<Hb;He++)Hc[Hd++]=4*He,Hc[Hd++]=4*He+2,Hc[Hd++]=4*He+1,Hc[Hd++]=4*He,Hc[Hd++]=4*He+3,Hc[Hd++]=4*He+2;return Ha.setNeedUpload(),!0},Ho.expandIBQuadrangle=function(Ha,Hb){Ha.bufferLength>=6*Hb*2||Ho.fillIBQuadrangle(Ha,Hb)},Ho.mathCeilPowerOfTwo=function(Ha){return Ha--,Ha|=Ha>>1,Ha|=Ha>>2,Ha|=Ha>>4,Ha|=Ha>>8,Ha|=Ha>>16,++Ha},Ho.fillQuadrangleImgVb=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){var Hi=16+(Ha._byteLength>>2);Ha.byteLength=Hi<<2;var Hj=Ha.getFloat32Array();Hj[(Hi-=16)+2]=He[0],Hj[Hi+3]=He[1],Hj[Hi+6]=He[2],Hj[Hi+7]=He[3],Hj[Hi+10]=He[4],Hj[Hi+11]=He[5],Hj[Hi+14]=He[6],Hj[Hi+15]=He[7];var Hk=Hf.a,Hl=Hf.b,Hm=Hf.c,Hn=Hf.d;if(1!==Hk||0!==Hl||0!==Hm||1!==Hn){Hf.bTransform=!0;var Ho=Hf.tx+Hg,Hp=Hf.ty+Hh;Hj[Hi]=(Hd[0]+Hb)*Hk+(Hd[1]+Hc)*Hm+Ho,Hj[Hi+1]=(Hd[0]+Hb)*Hl+(Hd[1]+Hc)*Hn+Hp,Hj[Hi+4]=(Hd[2]+Hb)*Hk+(Hd[3]+Hc)*Hm+Ho,Hj[Hi+5]=(Hd[2]+Hb)*Hl+(Hd[3]+Hc)*Hn+Hp,Hj[Hi+8]=(Hd[4]+Hb)*Hk+(Hd[5]+Hc)*Hm+Ho,Hj[Hi+9]=(Hd[4]+Hb)*Hl+(Hd[5]+Hc)*Hn+Hp,Hj[Hi+12]=(Hd[6]+Hb)*Hk+(Hd[7]+Hc)*Hm+Ho,Hj[Hi+13]=(Hd[6]+Hb)*Hl+(Hd[7]+Hc)*Hn+Hp}else Hf.bTransform=!1,Hb+=Hf.tx+Hg,Hc+=Hf.ty+Hh,Hj[Hi]=Hb+Hd[0],Hj[Hi+1]=Hc+Hd[1],Hj[Hi+4]=Hb+Hd[2],Hj[Hi+5]=Hc+Hd[3],Hj[Hi+8]=Hb+Hd[4],Hj[Hi+9]=Hc+Hd[5],Hj[Hi+12]=Hb+Hd[6],Hj[Hi+13]=Hc+Hd[7];return Ha._upload=!0},Ho.fillTranglesVB=function(Ha,Hb,Hc,Hd,He,Hf,Hg){var Hh=(Ha._byteLength>>2)+Hd.length;Ha.byteLength=Hh<<2;var Hi=Ha.getFloat32Array();Hh-=Hd.length;for(var Hj=Hd.length,Hk=He.a,Hl=He.b,Hm=He.c,Hn=He.d,Ho=0;Ho<Hj;Ho+=4)if(Hi[Hh+Ho+2]=Hd[Ho+2],Hi[Hh+Ho+3]=Hd[Ho+3],1!==Hk||0!==Hl||0!==Hm||1!==Hn){He.bTransform=!0;var Hp=He.tx+Hf,Hq=He.ty+Hg;Hi[Hh+Ho]=(Hd[Ho]+Hb)*Hk+(Hd[Ho+1]+Hc)*Hm+Hp,Hi[Hh+Ho+1]=(Hd[Ho]+Hb)*Hl+(Hd[Ho+1]+Hc)*Hn+Hq}else He.bTransform=!1,Hb+=He.tx+Hf,Hc+=He.ty+Hg,Hi[Hh+Ho]=Hb+Hd[Ho],Hi[Hh+Ho+1]=Hc+Hd[Ho+1];return Ha._upload=!0},Ho.copyPreImgVb=function(Ha,Hb,Hc){var Hd=Ha._byteLength>>2;Ha.byteLength=Hd+16<<2;for(var He=Ha.getFloat32Array(),Hf=0,Hg=Hd-16;Hf<4;Hf++)He[Hd]=He[Hg]+Hb,++Hg,He[++Hd]=He[Hg]+Hc,++Hg,He[++Hd]=He[Hg],++Hg,He[++Hd]=He[Hg],++Hd,++Hg;Ha._upload=!0},Ho.fillRectImgVb=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hl,Hm){void 0===Hm&&(Hm=!1);var Hn,Ho,Hp,Hq,Hr,Hs,Ht,Hu,Hv,Hw,Hx,Hy,Hz,HA,HB,HC,HD=1,HE=Hh.a,HF=Hh.b,HG=Hh.c,HH=Hh.d,HI=Hb&&Hb.width<99999999;if(1!==HE||0!==HF||0!==HG||1!==HH?(Hh.bTransform=!0,0===HF&&0===HG&&(HD=23,Hv=He+Hc,Hw=Hf+Hd,Hn=HE*Hc+(Hx=Hh.tx+Hi),Hp=HE*Hv+Hx,Ho=HH*Hd+(Hy=Hh.ty+Hj),Hq=HH*Hw+Hy)):(HD=23,Hh.bTransform=!1,Hp=(Hn=Hc+Hh.tx+Hi)+He,Hq=(Ho=Hd+Hh.ty+Hj)+Hf),HI&&(Hr=Hb.x,Hs=Hb.y,Ht=Hb.width+Hr,Hu=Hb.height+Hs),1!==HD){if(Math.min(Hn,Hp)>=Ht)return!1;if(Math.min(Ho,Hq)>=Hu)return!1;if(Math.max(Hp,Hn)<=Hr)return!1;if(Math.max(Hq,Ho)<=Hs)return!1}var HJ=Ha._byteLength>>2;Ha.byteLength=16+HJ<<2;var HK=Ha.getFloat32Array();switch(HK[2+HJ]=Hg[0],HK[3+HJ]=Hg[1],HK[6+HJ]=Hg[2],HK[7+HJ]=Hg[3],HK[10+HJ]=Hg[4],HK[11+HJ]=Hg[5],HK[14+HJ]=Hg[6],HK[15+HJ]=Hg[7],HD){case 1:Hx=Hh.tx+Hi,Hy=Hh.ty+Hj;var HL=HE*Hc,HM=HG*Hd,HN=HH*Hd,HO=HF*Hc,HP=HE*(Hv=He+Hc),HQ=HG*(Hw=Hf+Hd),HR=HH*Hw,HS=HF*Hv;Hm?(Hz=HL+HM+Hx,HB=Math.round(Hz)-Hz,HA=HN+HO+Hy,HC=Math.round(HA)-HA,HK[HJ]=Hz+HB,HK[1+HJ]=HA+HC,HK[4+HJ]=HP+HM+Hx+HB,HK[5+HJ]=HN+HS+Hy+HC,HK[8+HJ]=HP+HQ+Hx+HB,HK[9+HJ]=HR+HS+Hy+HC,HK[12+HJ]=HL+HQ+Hx+HB,HK[13+HJ]=HR+HO+Hy+HC):(HK[HJ]=HL+HM+Hx,HK[1+HJ]=HN+HO+Hy,HK[4+HJ]=HP+HM+Hx,HK[5+HJ]=HN+HS+Hy,HK[8+HJ]=HP+HQ+Hx,HK[9+HJ]=HR+HS+Hy,HK[12+HJ]=HL+HQ+Hx,HK[13+HJ]=HR+HO+Hy);break;case 23:Hm?(Hz=Hn+Hk,HB=Math.round(Hz)-Hz,HA=Ho,HC=Math.round(HA)-HA,HK[HJ]=Hz+HB,HK[1+HJ]=HA+HC,HK[4+HJ]=Hp+Hk+HB,HK[5+HJ]=Ho+HC,HK[8+HJ]=Hp+HB,HK[9+HJ]=Hq+HC,HK[12+HJ]=Hn+HB,HK[13+HJ]=Hq+HC):(HK[HJ]=Hn+Hk,HK[1+HJ]=Ho,HK[4+HJ]=Hp+Hk,HK[5+HJ]=Ho,HK[8+HJ]=Hp,HK[9+HJ]=Hq,HK[12+HJ]=Hn,HK[13+HJ]=Hq)}return Ha._upload=!0},Ho.fillLineVb=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){var Hi=.5*Hg,Hj=Ho._fillLineArray,Hk=-(Hd-Hf),Hl=Hc-He,Hm=Math.sqrt(Hk*Hk+Hl*Hl);Hk/=Hm,Hl/=Hm,Hk*=Hi,Hl*=Hi,Hj[0]=Hc-Hk,Hj[1]=Hd-Hl,Hj[4]=Hc+Hk,Hj[5]=Hd+Hl,Hj[8]=He+Hk,Hj[9]=Hf+Hl,Hj[12]=He-Hk,Hj[13]=Hf-Hl,Hh&&Hh.transformPointArray(Hj,Hj);var Hn=16+(Ha._byteLength>>2);return Ha.byteLength=Hn<<2,Ha.insertData(Hj,Hn-16),!0},Ho._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ho}(),Hra=(function(){function Hi(){}Hm(Hi,"laya.webgl.utils.MatirxArray"),Hi.ArrayMul=function(Ha,Hb,Hc){if(Ha)if(Hb)for(var Hd=NaN,He=NaN,Hf=NaN,Hg=NaN,Hh=0;Hh<4;Hh++)Hd=Ha[Hh],He=Ha[Hh+4],Hf=Ha[Hh+8],Hg=Ha[Hh+12],Hc[Hh]=Hd*Hb[0]+He*Hb[1]+Hf*Hb[2]+Hg*Hb[3],Hc[Hh+4]=Hd*Hb[4]+He*Hb[5]+Hf*Hb[6]+Hg*Hb[7],Hc[Hh+8]=Hd*Hb[8]+He*Hb[9]+Hf*Hb[10]+Hg*Hb[11],Hc[Hh+12]=Hd*Hb[12]+He*Hb[13]+Hf*Hb[14]+Hg*Hb[15];else Hi.copyArray(Ha,Hc);else Hi.copyArray(Hb,Hc)},Hi.copyArray=function(Ha,Hb){if(Ha&&Hb)for(var Hc=0;Hc<Ha.length;Hc++)Hb[Hc]=Ha[Hc]}}(),function(){function Hb(Ha,Hb,Hc){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=Ha,this._vb=new H_a(Ha,35048),Hb&&this._vb._resizeBuffer(Hb,!1),this._ib=new H$a,Hc&&this._ib._resizeBuffer(Hc,!1)}Hm(Hb,"laya.webgl.utils.Mesh2D");var Ha=Hb.prototype;return Ha.cloneWithNewVB=function(){var Ha=new Hb(this._stride,0,0);return Ha._ib=this._ib,Ha._quadNum=this._quadNum,Ha._attribInfo=this._attribInfo,Ha},Ha.cloneWithNewVBIB=function(){var Ha=new Hb(this._stride,0,0);return Ha._attribInfo=this._attribInfo,Ha},Ha.getVBW=function(){return this._vb.setNeedUpload(),this._vb},Ha.getVBR=function(){return this._vb},Ha.getIBR=function(){return this._ib},Ha.getIBW=function(){return this._ib.setNeedUpload(),this._ib},Ha.createQuadIB=function(Ha){this._quadNum=Ha,this._ib._resizeBuffer(6*Ha*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var Hb=this._ib.getUint16Array(),Hc=0,Hd=0,He=0;He<Ha;He++)Hb[Hc++]=Hd,Hb[Hc++]=Hd+2,Hb[Hc++]=Hd+1,Hb[Hc++]=Hd,Hb[Hc++]=Hd+3,Hb[Hc++]=Hd+2,Hd+=4;this._ib.setNeedUpload()},Ha.setAttributes=function(Ha){if(this._attribInfo=Ha,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},Ha.getEleNum=function(){return this._ib.getBuffer().byteLength/2},Ha.releaseMesh=function(){},Ha.destroy=function(){},Ha.clearVB=function(){this._vb.clear()},Hb._gvaoid=0,Hb}()),Hsa=function(){function He(){}return Hm(He,"laya.webgl.utils.RenderState2D"),He.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},He.mat2MatArray=function(Ha,Hb){var Hc=Ha,Hd=Hb;return Hd[0]=Hc.a,Hd[1]=Hc.b,Hd[2]=He.EMPTYMAT4_ARRAY[2],Hd[3]=He.EMPTYMAT4_ARRAY[3],Hd[4]=Hc.c,Hd[5]=Hc.d,Hd[6]=He.EMPTYMAT4_ARRAY[6],Hd[7]=He.EMPTYMAT4_ARRAY[7],Hd[8]=He.EMPTYMAT4_ARRAY[8],Hd[9]=He.EMPTYMAT4_ARRAY[9],Hd[10]=He.EMPTYMAT4_ARRAY[10],Hd[11]=He.EMPTYMAT4_ARRAY[11],Hd[12]=Hc.tx,Hd[13]=Hc.ty,Hd[14]=He.EMPTYMAT4_ARRAY[14],Hd[15]=He.EMPTYMAT4_ARRAY[15],Hb},He.restoreTempArray=function(){He.TEMPMAT4_ARRAY[0]=1,He.TEMPMAT4_ARRAY[1]=0,He.TEMPMAT4_ARRAY[4]=0,He.TEMPMAT4_ARRAY[5]=1,He.TEMPMAT4_ARRAY[12]=0,He.TEMPMAT4_ARRAY[13]=0},He.clear=function(){He.worldScissorTest=!1,He.worldShaderDefines=null,He.worldFilters=null,He.worldAlpha=1,He.worldClipRect.x=He.worldClipRect.y=0,He.worldClipRect.width=He.width,He.worldClipRect.height=He.height,He.curRenderTarget=null},He._MAXSIZE=99999999,He.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],He.worldMatrix4=He.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],He.worldAlpha=1,He.worldScissorTest=!1,He.worldFilters=null,He.worldShaderDefines=null,He.curRenderTarget=null,He.width=0,He.height=0,Hg(He,["worldMatrix",function(){return this.worldMatrix=new Hz},"worldClipRect",function(){return this.worldClipRect=new HB(0,0,99999999,99999999)}]),He}(),Hta=function(){var Hs,Hc;function Ht(Ha,Hb,Hc,Hd,He){var Hf=this;function Hg(Ha){var Hb=[],Hc=new Hs(Hb);return Hf._compileToTree(Hc,Ha.split("\n"),0,Hb,He),Hc}var Hh=Hn.now();this._VS=Hg(Hb),this._PS=Hg(Hc),this._nameMap=Hd,2<Hn.now()-Hh&&console.log("ShaderCompile use time:"+(Hn.now()-Hh)+"  size:"+Hb.length+"/"+Hc.length)}Hm(Ht,"laya.webgl.utils.ShaderCompile");var Ha=Ht.prototype;return Ha._compileToTree=function(Ha,Hb,Hc,Hd,He){var Hf,Hg,Hh,Hi,Hj,Hk,Hl,Hm=0,Hn=0,Ho=0,Hp=0;for(Hn=Hc;Hn<Hb.length;Hn++)if(!((Hh=Hb[Hn]).length<1)&&0!==(Hm=Hh.indexOf("//"))){if(0<=Hm&&(Hh=Hh.substr(0,Hm)),Hf=Hl||new Hs(Hd),Hl=null,Hf.text=Hh,Hf.noCompile=!0,0<=(Hm=Hh.indexOf("#"))){for(Hi="#",Hp=Hm+1,Ho=Hh.length;Hp<Ho;Hp++){var Hq=Hh.charAt(Hp);if(" "===Hq||"\t"===Hq||"\r"===Hq||"\n"===Hq||"?"===Hq)break;Hi+=Hq}switch(Hf.name=Hi){case"#ifdef":case"#ifndef":if(Hf.src=Hh,Hf.noCompile=null!=Hh.match(/[!&|()=<>]/),Hf.noCompile?console.log("function():Boolean{return "+Hh.substr(Hm+Hf.name.length)+"}"):(Hk=Hh.replace(/^\s*/,"").split(/\s+/),Hf.setCondition(Hk[1],"#ifdef"===Hi?1:2),Hf.text="//"+Hf.text),Hf.setParent(Ha),Ha=Hf,He)for(Hk=Hh.substr(Hp).split(Ht._splitToWordExps3),Hp=0;Hp<Hk.length;Hp++)(Hh=Hk[Hp]).length&&(He[Hh]=!0);continue;case"#if":if(Hf.src=Hh,Hf.noCompile=!0,Hf.setParent(Ha),Ha=Hf,He)for(Hk=Hh.substr(Hp).split(Ht._splitToWordExps3),Hp=0;Hp<Hk.length;Hp++)(Hh=Hk[Hp]).length&&"defined"!=Hh&&(He[Hh]=!0);continue;case"#else":Hf.src=Hh,Hg=(Ha=Ha.parent).childs[Ha.childs.length-1],Hf.noCompile=Hg.noCompile,Hf.noCompile||(Hf.condition=Hg.condition,Hf.conditionType=1==Hg.conditionType?2:1,Hf.text="//"+Hf.text+" "+Hg.text+" "+Hf.conditionType),Hf.setParent(Ha),Ha=Hf;continue;case"#endif":Hg=(Ha=Ha.parent).childs[Ha.childs.length-1],Hf.noCompile=Hg.noCompile,Hf.noCompile||(Hf.text="//"+Hf.text),Hf.setParent(Ha);continue;case"#include":Hk=Ht.splitToWords(Hh,null);var Hr=Ht.includes[Hk[1]];if(!Hr)throw"ShaderCompile error no this include file:"+Hk[1];if((Hm=Hk[0].indexOf("?"))<0){Hf.setParent(Ha),Hh=Hr.getWith("with"==Hk[2]?Hk[3]:null),this._compileToTree(Hf,Hh.split("\n"),0,Hd,He),Hf.text="";continue}Hf.setCondition(Hk[0].substr(Hm+1),1),Hf.text=Hr.getWith("with"==Hk[2]?Hk[3]:null);break;case"#import":Hj=(Hk=Ht.splitToWords(Hh,null))[1],Hd.push({node:Hf,file:Ht.includes[Hj],ofs:Hf.text.length});continue}}else{if((Hg=Ha.childs[Ha.childs.length-1])&&!Hg.name){0<Hd.length&&Ht.splitToWords(Hh,Hg),Hl=Hf,Hg.text+="\n"+Hh;continue}0<Hd.length&&Ht.splitToWords(Hh,Hf)}Hf.setParent(Ha)}},Ha.createShader=function(Ha,Hb,Hc){var Hd={},He="";if(Ha)for(var Hf in Ha)He+="#define "+Hf+"\n",Hd[Hf]=!0;var Hg=this._VS.toscript(Hd,[]),Hh=this._PS.toscript(Hd,[]);return(Hc||HWa.create)(He+Hg.join("\n"),He+Hh.join("\n"),Hb,this._nameMap)},Ht._parseOne=function(Ha,Hb,Hc,Hd,He,Hf){var Hg={type:Ht.shaderParamsMap[Hc[Hd+1]],name:Hc[Hd+2],size:isNaN(parseInt(Hc[Hd+3]))?1:parseInt(Hc[Hd+3])};return Hf&&("attribute"==He?Ha.push(Hg):Hb.push(Hg)),":"==Hc[Hd+3]&&(Hg.type=Hc[Hd+4],Hd+=2),Hd+=2},Ht.addInclude=function(Ha,Hb){if(!Hb||0===Hb.length)throw new Error("add shader include file err:"+Ha);if(Ht.includes[Ha])throw new Error("add shader include file err, has add:"+Ha);Ht.includes[Ha]=new Hc(Hb)},Ht.preGetParams=function(Ha,Hb){var Hc=[Ha,Hb],Hd={},He=[],Hf=[],Hg={},Hh=[];Hd.attributes=He,Hd.uniforms=Hf,Hd.defines=Hg;for(var Hi=0,Hj=0,Hk=0;Hk<2;Hk++){Hc[Hk]=Hc[Hk].replace(Ht._removeAnnotation,"");var Hl,Hm=Hc[Hk].match(Ht._reg);for(Hi=0,Hj=Hm.length;Hi<Hj;Hi++){var Hn=Hm[Hi];if("attribute"==Hn||"uniform"==Hn)Hi=Ht._parseOne(He,Hf,Hm,Hi,Hn,!0);else{if("#define"==Hn){Hh[Hn=Hm[++Hi]]=1;continue}if("#ifdef"==Hn){Hg[Hl=Hm[++Hi]]=Hg[Hl]||[];for(Hi++;Hi<Hj;Hi++)if("attribute"==(Hn=Hm[Hi])||"uniform"==Hn)Hi=Ht._parseOne(He,Hf,Hm,Hi,Hn,Hh[Hl]);else if("#else"==Hn)for(Hi++;Hi<Hj;Hi++)if("attribute"==(Hn=Hm[Hi])||"uniform"==Hn)Hi=Ht._parseOne(He,Hf,Hm,Hi,Hn,!Hh[Hl]);else if("#endif"==Hn)break}}}}return Hd},Ht.splitToWords=function(Ha,Hb){for(var Hc,Hd,He=[],Hf=-1,Hg=0,Hh=Ha.length;Hg<Hh;Hg++)if(Hc=Ha.charAt(Hg),0<=" \t=+-*/&%!<>()'\",;".indexOf(Hc)){if(0<=Hf&&1<Hg-Hf&&(Hd=Ha.substr(Hf,Hg-Hf),He.push(Hd)),'"'==Hc||"'"==Hc){var Hi=Ha.indexOf(Hc,Hg+1);if(Hi<0)throw"Sharder err:"+Ha;He.push(Ha.substr(Hg+1,Hi-Hg-1)),Hg=Hi,Hf=-1;continue}"("==Hc&&Hb&&0<He.length&&(Hd=He[He.length-1]+";","vec4;main;".indexOf(Hd)<0&&(Hb.useFuns+=Hd)),Hf=-1}else Hf<0&&(Hf=Hg);return Hf<Hh&&1<Hh-Hf&&(Hd=Ha.substr(Hf,Hh-Hf),He.push(Hd)),He},Ht.IFDEF_NO=0,Ht.IFDEF_YES=1,Ht.IFDEF_ELSE=2,Ht.IFDEF_PARENT=3,Ht._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),Ht._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),Ht._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),Ht.includes={},Hg(Ht,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),Ht.__init$=function(){Hs=function(){function Hc(Ha){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=Ha}Hm(Hc,"");var Ha=Hc.prototype;return Ha.setParent=function(Ha){Ha.childs.push(this),this.z=Ha.z+1,this.parent=Ha},Ha.setCondition=function(Ha,Hb){Ha&&(this.conditionType=Hb,Ha=Ha.replace(/(\s*$)/g,""),this.condition=function(){return this[Ha]},this.condition.__condition=Ha)},Ha.toscript=function(Ha,Hb){return this._toscript(Ha,Hb,++Hc.__id)},Ha._toscript=function(Hd,He,Hf){if(this.childs.length<1&&!this.text)return He;He.length;if(this.condition){var Ha=!!this.condition.call(Hd);if(2===this.conditionType&&(Ha=!Ha),!Ha)return He}if(this.text&&He.push(this.text),0<this.childs.length&&this.childs.forEach(function(Ha,Hb,Hc){Ha._toscript(Hd,He,Hf)}),0<this.includefiles.length&&0<this.useFuns.length)for(var Hb,Hc=0,Hg=this.includefiles.length;Hc<Hg;Hc++)this.includefiles[Hc].curUseID!=Hf&&0<(Hb=this.includefiles[Hc].file.getFunsScript(this.useFuns)).length&&(this.includefiles[Hc].curUseID=Hf,He[0]=Hb+He[0]);return He},Hc.__id=1,Hc}(),Hc=function(){function Ha(Ha){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=Ha;for(var Hb=0,Hc=0,Hd=0;!((Hb=Ha.indexOf("#begin",Hb))<0);){for(Hd=Hb+5;!((Hd=Ha.indexOf("#end",Hd))<0)&&"i"===Ha.charAt(Hd+4);)Hd+=5;if(Hd<0)throw"add include err,no #end:"+Ha;Hc=Ha.indexOf("\n",Hb);var He=Ht.splitToWords(Ha.substr(Hb,Hc-Hb),null);"code"==He[1]?this.codes[He[2]]=Ha.substr(Hc+1,Hd-Hc-1):"function"==He[1]&&(Hc=Ha.indexOf("function",Hb),Hc+="function".length,this.funs[He[3]]=Ha.substr(Hc+1,Hd-Hc-1),this.funnames+=He[3]+";"),Hb=Hd+1}}Hm(Ha,"");var Hb=Ha.prototype;return Hb.getWith=function(Ha){var Hb=Ha?this.codes[Ha]:this.script;if(!Hb)throw"get with error:"+Ha;return Hb},Hb.getFunsScript=function(Ha){var Hb="";for(var Hc in this.funs)0<=Ha.indexOf(Hc+";")&&(Hb+=this.funs[Hc]);return Hb},Ha}()},Ht}(),Hua=function(){function Hg(){}return Hm(Hg,"laya.webgl.WebGL"),Hg._uint8ArraySlice=function(){for(var Ha=this.length,Hb=new Uint8Array(this.length),Hc=0;Hc<Ha;Hc++)Hb[Hc]=this[Hc];return Hb},Hg._float32ArraySlice=function(){for(var Ha=this.length,Hb=new Float32Array(this.length),Hc=0;Hc<Ha;Hc++)Hb[Hc]=this[Hc];return Hb},Hg._uint16ArraySlice=function(Ha){var Hb,Hc=arguments,Hd=0,He=0;if(0===Hc.length)for(Hd=this.length,Hb=new Uint16Array(Hd),He=0;He<Hd;He++)Hb[He]=this[He];else if(2===Hc.length){var Hf=Hc[0],Hg=Hc[1];if(Hf<Hg)for(Hd=Hg-Hf,Hb=new Uint16Array(Hd),He=Hf;He<Hg;He++)Hb[He-Hf]=this[He];else Hb=new Uint16Array(0)}return Hb},Hg.expandContext=function(){var Ha=He.prototype,Hb=CanvasRenderingContext2D.prototype;Hb.fillTrangles=Ha.fillTrangles,HXa.__int__(null),Hb.setIBVB=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){void 0===Hi&&(Hi=0),void 0===Hj&&(Hj=0),null===Hc&&(this._ib=this._ib||H$a.QuadrangleIB,Hc=this._ib,Hqa.expandIBQuadrangle(Hc,Hd._byteLength/64+8)),this._setIBVB(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj)},Hb.fillTrangles=function(Ha,Hb,Hc,Hd,He){this._curMat=this._curMat||Hz.create(),this._vb=this._vb||H_a.create(),this._ib||(this._ib=H$a.create(),Hqa.fillIBQuadrangle(this._ib,Hg/4));var Hf=this._vb,Hg=Hd.length>>4;Hqa.fillTranglesVB(Hf,Hb,Hc,Hd,He||this._curMat,0,0),Hqa.expandIBQuadrangle(this._ib,Hf._byteLength/64+8);var Hh=new Hya(1,0);Hh.textureHost=Ha;var Hi=new HZa("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");Hf._vertType=3,this._setIBVB(Hb,Hc,this._ib,Hf,6*Hg,He,Hi,Hh,0,0)}},Hg.enable=function(){if(Hn.__init__(),Hr.isConchApp&&!Hr.isConchWebGL)return Hv.skinAniSprite=function(){return new Haa},Hg.expandContext(),!1;if(Hv.getWebGLContext=function(Ha){for(var Hb,Hc=["webgl","experimental-webgl","webkit-3d","moz-webgl"],Hd=0;Hd<Hc.length;Hd++){try{Hb=Ha.getContext(Hc[Hd],{stencil:Hx.isStencil,alpha:Hx.isAlpha,antialias:Hx.isAntialias,premultipliedAlpha:Hx.premultipliedAlpha,preserveDrawingBuffer:Hx.preserveDrawingBuffer})}catch(Ha){}if(Hb)return Hb}return null},null==(Hg.mainContext=Hv.getWebGLContext(Hr._mainCanvas)))return!1;if(Hr.isWebGL)return!0;Hp.create=function(Ha,Hb){return new Hab(Ha,Hb)},Hq.create=function(Ha,Hb,Hc,Hd,He,Hf,Hg){return new HVa(Ha,Hb,Hc,Hd,He,Hf,Hg)},Hr.WebGL=Hg,Hr.isWebGL=!0,Hna.__init__(),Hv.createRenderSprite=function(Ha,Hb){return new Hza(Ha,Hb)},Hv.createWebGLContext2D=function(Ha){return new Hxa(Ha)},Hv.changeWebGLSize=function(Ha,Hb){laya.webgl.WebGL.onStageResize(Ha,Hb)},Hv.createGraphics=function(){return new Hwa};var Ha=Hv.createFilterAction;return Hv.createFilterAction=Ha||function(Ha){return new HAa},Hv.clear=function(Ha){Hsa.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var Hb=Hr.context.ctx,Hc=0==Hb._submits._length||Hx.preserveDrawingBuffer?Ho.create(Ha)._color:HD._wgColor;Hc&&Hb.clearBG(Hc[0],Hc[1],Hc[2],Hc[3]),Hsa.clear()},Hv.addToAtlas=function(Ha,Hb){void 0===Hb&&(Hb=!1);var Hc=Ha.bitmap;Hr.optimizeTextureMemory(Ha.url,Ha)?Hw.__typeof(Hc,"laya.webgl.resource.IMergeAtlasBitmap")&&Hc.allowMerageInAtlas&&Hc.on("recovered",Ha,Ha.addTextureToAtlas):Hc.enableMerageInAtlas=!1},Hv.isAtlas=function(Ha){return Ha instanceof laya.webgl.atlas.AtlasWebGLCanvas},HO._enable(),Hv.beginFlush=function(){for(var Ha=HO.instance,Hb=Ha.getAtlaserCount(),Hc=0;Hc<Hb;Hc++){var Hd=Ha.getAtlaserByIndex(Hc).texture;Hd._flashCacheImageNeedFlush&&Hv.flashFlushImage(Hd)}},Hv.drawToCanvas=function(Ha,Hb,Hc,Hd,He,Hf){(Hc<=0||Hd<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),Hc|=0,Hd|=0,He|=0,Hf|=0;var Hg=HKa.create(Hc,Hd,6408,5121,0,!1);Hg.start(),Hg.clear(0,0,0,0),Hr.context.clear(),Hs.renders[Hb]._fun(Ha,Hr.context,He,Hsa.height-Hd+Hf),Hr.context.flush(),Hg.end();var Hh=Hg.getData(0,0,Hc,Hd);if(Hg.recycle(),Hh.byteLength==Hc*Hd*4){var Hi=new HSa;Hi._canvas=Hn.createElement("canvas"),Hi.size(Hc,Hd);var Hj=Hi._canvas.getContext("2d");Hn.canvas.size(Hc,Hd);var Hk=Hn.context,Hl=Hk.createImageData(Hc,Hd);return Hl.data.set(new Uint8ClampedArray(Hh.buffer)),Hi._imgData=Hl,Hk.putImageData(Hl,0,0),Hj.save(),Hj.translate(0,Hd),Hj.scale(1,-1),Hj.drawImage(Hn.canvas.source,0,0),Hj.restore(),Hi}console.log("drawToCanvas error: w:"+Hc+",h:"+Hd+",datalen:"+Hh.byteLength)},Hv.createFilterAction=function(Ha){var Hb;switch(Ha){case 32:Hb=new HAa}return Hb},Hv.addTextureToAtlas=function(Ha){Ha._uvID++,HO._atlasRestore++,Ha.bitmap.enableMerageInAtlas&&HO.instance.addToAtlas(Ha)},Hv.getTexturePixels=function(Ha,Hb,Hc,Hd,He){Hr.context.ctx.clear();var Hf=new HC;Hf.graphics.drawTexture(Ha,-Hb,-Hc);var Hg=HKa.create(Hd,He);Hg.start(),Hg.clear(0,0,0,0),Hf.render(Hr.context,0,0),Hr.context.ctx.flush(),Hg.end();for(var Hh=Hg.getData(0,0,Hd,He),Hi=[],Hj=0,Hk=He-1;0<=Hk;Hk--)for(var Hl=0;Hl<Hd;Hl++)Hj=4*(Hk*Hd+Hl),Hi.push(Hh[Hj]),Hi.push(Hh[Hj+1]),Hi.push(Hh[Hj+2]),Hi.push(Hh[Hj+3]);return Hi},Hv.skinAniSprite=function(){return new Haa},Hj.create=function(Ha,Hb){var Hc=new HSa;return Hc._imgData=Hb,Hc.flipY=!1,Hc},Hy._filterStart=function(Ha,Hb,Hc,Hd,He){var Hf=Ha.getValue("bounds"),Hg=HKa.create(Hf.width,Hf.height);if(Hg.start(),Hg.clear(0,0,0,0),Ha.addValue("src",Hg),Ha.addValue("ScissorTest",Hsa.worldScissorTest),Hsa.worldScissorTest){var Hh=new HB;Hh.copyFrom(Hc.ctx._clipRect),Ha.addValue("clipRect",Hh),Hsa.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},Hy._filterEnd=function(Ha,Hb,Hc,Hd,He){var Hf=Ha.getValue("bounds");Ha.getValue("src").end();var Hg=HKa.create(Hf.width,Hf.height);Hg.start(),Hg.clear(0,0,0,0),Ha.addValue("out",Hg),Hb._set$P("_filterCache",Hg),Hb._set$P("_isHaveGlowFilter",Ha.getValue("_isHaveGlowFilter"))},Hy._EndTarget=function(Ha,Hb){if(Ha.getValue("src").recycle(),Ha.getValue("out").end(),Ha.getValue("ScissorTest")){Hsa.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),Hb.ctx.save();var Hc=Ha.getValue("clipRect");Hb.ctx.clipRect(Hc.x,Hc.y,Hc.width,Hc.height)}},Hy._useSrc=function(Ha){var Hb=Ha.getValue("out");Hb.end(),(Hb=Ha.getValue("src")).start(),Hb.clear(0,0,0,0)},Hy._endSrc=function(Ha){Ha.getValue("src").end()},Hy._useOut=function(Ha){var Hb=Ha.getValue("src");Hb.end(),(Hb=Ha.getValue("out")).start(),Hb.clear(0,0,0,0)},Hy._endOut=function(Ha){Ha.getValue("out").end()},Hy._recycleScope=function(Ha){Ha.recycle()},Hy._filter=function(Ha,Hb,Hc,Hd){var He=this._next;if(He){var Hf,Hg,Hh=Ha.filters,Hi=Hh.length;if(1==Hi&&32==Hh[0].type)return Hb.ctx.save(),Hb.ctx.setFilters([Hh[0]]),He._fun.call(He,Ha,Hb,Hc,Hd),void Hb.ctx.restore();var Hj=Hha.create(),Hk=HA.TEMP,Hl=Hb.ctx._getTransformMatrix(),Hm=Hz.create();Hl.copyTo(Hm);var Hn=0,Ho=0,Hp=!1,Hq=Ha._$P._filterCache?Ha._$P._filterCache:null;if(!Hq||Ha._repaint){Hp=Ha._isHaveGlowFilter(),Hj.addValue("_isHaveGlowFilter",Hp),Hp&&(Hn=50,Ho=25),(Hg=new HB).copyFrom(Ha.getSelfBounds()),Hg.x+=Ha.x,Hg.y+=Ha.y,Hg.x-=Ha.pivotX+4,Hg.y-=Ha.pivotY+4;var Hr=Hg.x,Hs=Hg.y;if(Hg.width+=Hn+8,Hg.height+=Hn+8,Hk.x=Hg.x*Hm.a+Hg.y*Hm.c,Hk.y=Hg.y*Hm.d+Hg.x*Hm.b,Hg.x=Hk.x,Hg.y=Hk.y,Hk.x=Hg.width*Hm.a+Hg.height*Hm.c,Hk.y=Hg.height*Hm.d+Hg.width*Hm.b,Hg.width=Hk.x,Hg.height=Hk.y,Hg.width<=0||Hg.height<=0)return;Hq&&Hq.recycle(),Hj.addValue("bounds",Hg);var Ht=Hga.create([Hj,Ha,Hb,0,0],Hy._filterStart);Hb.addRenderObject(Ht),Hb.ctx._renderKey=0,Hb.ctx._shader2D.glTexture=null;var Hu=Ha.x-Hr+Ho,Hv=Ha.y-Hs+Ho;He._fun.call(He,Ha,Hb,Hu,Hv),Ht=Hga.create([Hj,Ha,Hb,0,0],Hy._filterEnd),Hb.addRenderObject(Ht);for(var Hw=0;Hw<Hi;Hw++){0!=Hw&&(Ht=Hga.create([Hj],Hy._useSrc),Hb.addRenderObject(Ht),Hf=Hya.create(1,0),Hz.TEMP.identity(),Hb.ctx.drawTarget(Hj,0,0,Hg.width,Hg.height,Hz.TEMP,"out",Hf,null,HQ.TOINT.overlay),Ht=Hga.create([Hj],Hy._useOut),Hb.addRenderObject(Ht)),Hh[Hw].action.apply3d(Hj,Ha,Hb,0,0)}Ht=Hga.create([Hj,Hb],Hy._EndTarget),Hb.addRenderObject(Ht)}else{if((Hp=!!Ha._$P._isHaveGlowFilter&&Ha._$P._isHaveGlowFilter)&&(Hn=50,Ho=25),(Hg=Ha.getBounds()).width<=0||Hg.height<=0)return;Hg.width+=Hn,Hg.height+=Hn,Hk.x=Hg.x*Hm.a+Hg.y*Hm.c,Hk.y=Hg.y*Hm.d+Hg.x*Hm.b,Hg.x=Hk.x,Hg.y=Hk.y,Hk.x=Hg.width*Hm.a+Hg.height*Hm.c,Hk.y=Hg.height*Hm.d+Hg.width*Hm.b,Hg.width=Hk.x,Hg.height=Hk.y,Hj.addValue("out",Hq)}Hc=Hc-Ho-Ha.x,Hd=Hd-Ho-Ha.y,Hk.setTo(Hc,Hd),Hm.transformPoint(Hk),Hc=Hk.x+Hg.x,Hd=Hk.y+Hg.y,Hf=Hya.create(1,0),Hz.TEMP.identity(),Hb.ctx.drawTarget(Hj,Hc,Hd,Hg.width,Hg.height,Hz.TEMP,"out",Hf,null,HQ.TOINT.overlay),Ht=Hga.create([Hj],Hy._recycleScope),Hb.addRenderObject(Ht),Hm.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=Hg._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=Hg._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=Hg._uint8ArraySlice),!0},Hg.onStageResize=function(Ha,Hb){null!=Hg.mainContext&&(Hg.mainContext.viewport(0,0,Ha,Hb),Hsa.width=Ha,Hsa.height=Hb)},Hg.onInvalidGLRes=function(){HO.instance.freeAll(),Hu.releaseContentManagers(!0),Hg.doNodeRepaint(Hw.stage),Hg.mainContext.viewport(0,0,Hsa.width,Hsa.height),Hw.stage.event("devicelost")},Hg.doNodeRepaint=function(Ha){0==Ha.numChildren&&Ha.repaint();for(var Hb=0;Hb<Ha.numChildren;Hb++)Hg.doNodeRepaint(Ha.getChildAt(Hb))},Hg.init=function(Ha,Hb,Hc){Hg.mainCanvas=Ha,Hj._createContext=function(Ha){return new Hxa(Ha)},HSa._createContext=function(Ha){return new Hxa(Ha)};var Hd=laya.webgl.WebGL.mainContext;if(null!=Hd.getShaderPrecisionFormat){var He=Hd.getShaderPrecisionFormat(35633,36338),Hf=Hd.getShaderPrecisionFormat(35632,36338);Hg.shaderHighPrecision=!(!He.precision||!Hf.precision)}else Hg.shaderHighPrecision=!1;if(Hd.deleteTexture1=Hd.deleteTexture,Hd.deleteTexture=function(Ha){Ha==Hva.curBindTexValue&&(Hva.curBindTexValue=null),Hd.deleteTexture1(Ha)},Hg.onStageResize(Hb,Hc),null==Hg.mainContext)throw new Error("webGL getContext err!");HG.__init__(),HO.__init__(),HCa.__init__(),Hfa.__init__(),Hxa.__init__(),Hya.__init__(),H$.__init__(),HXa.__int__(Hd),HQ._init_(Hd),Hr.isConchApp&&conch.setOnInvalidGLRes(Hg.onInvalidGLRes)},Hg.mainCanvas=null,Hg.mainContext=null,Hg.antialias=!0,Hg.shaderHighPrecision=!1,Hg._bg_null=[0,0,0,0],Hg}(),Hva=function(){function Hd(){}return Hm(Hd,"laya.webgl.WebGLContext"),Hd.UseProgram=function(Ha){return Hd._useProgram!==Ha&&(Hua.mainContext.useProgram(Ha),Hd._useProgram=Ha,!0)},Hd.setDepthTest=function(Ha,Hb){Hb!==Hd._depthTest&&((Hd._depthTest=Hb)?Ha.enable(2929):Ha.disable(2929))},Hd.setDepthMask=function(Ha,Hb){Hb!==Hd._depthMask&&(Hd._depthMask=Hb,Ha.depthMask(Hb))},Hd.setDepthFunc=function(Ha,Hb){Hb!==Hd._depthFunc&&(Hd._depthFunc=Hb,Ha.depthFunc(Hb))},Hd.setBlend=function(Ha,Hb){Hb!==Hd._blend&&((Hd._blend=Hb)?Ha.enable(3042):Ha.disable(3042))},Hd.setBlendFunc=function(Ha,Hb,Hc){(Hb!==Hd._sFactor||Hc!==Hd._dFactor)&&(Hd._sFactor=Hb,Hd._dFactor=Hc,Ha.blendFunc(Hb,Hc))},Hd.setCullFace=function(Ha,Hb){Hb!==Hd._cullFace&&((Hd._cullFace=Hb)?Ha.enable(2884):Ha.disable(2884))},Hd.setFrontFace=function(Ha,Hb){Hb!==Hd._frontFace&&(Hd._frontFace=Hb,Ha.frontFace(Hb))},Hd.bindTexture=function(Ha,Hb,Hc){Ha.bindTexture(Hb,Hc),Hd.curBindTexTarget=Hb,Hd.curBindTexValue=Hc},Hd.DEPTH_BUFFER_BIT=256,Hd.STENCIL_BUFFER_BIT=1024,Hd.COLOR_BUFFER_BIT=16384,Hd.POINTS=0,Hd.LINES=1,Hd.LINE_LOOP=2,Hd.LINE_STRIP=3,Hd.TRIANGLES=4,Hd.TRIANGLE_STRIP=5,Hd.TRIANGLE_FAN=6,Hd.ZERO=0,Hd.ONE=1,Hd.SRC_COLOR=768,Hd.ONE_MINUS_SRC_COLOR=769,Hd.SRC_ALPHA=770,Hd.ONE_MINUS_SRC_ALPHA=771,Hd.DST_ALPHA=772,Hd.ONE_MINUS_DST_ALPHA=773,Hd.DST_COLOR=774,Hd.ONE_MINUS_DST_COLOR=775,Hd.SRC_ALPHA_SATURATE=776,Hd.FUNC_ADD=32774,Hd.BLEND_EQUATION=32777,Hd.BLEND_EQUATION_RGB=32777,Hd.BLEND_EQUATION_ALPHA=34877,Hd.FUNC_SUBTRACT=32778,Hd.FUNC_REVERSE_SUBTRACT=32779,Hd.BLEND_DST_RGB=32968,Hd.BLEND_SRC_RGB=32969,Hd.BLEND_DST_ALPHA=32970,Hd.BLEND_SRC_ALPHA=32971,Hd.CONSTANT_COLOR=32769,Hd.ONE_MINUS_CONSTANT_COLOR=32770,Hd.CONSTANT_ALPHA=32771,Hd.ONE_MINUS_CONSTANT_ALPHA=32772,Hd.BLEND_COLOR=32773,Hd.ARRAY_BUFFER=34962,Hd.ELEMENT_ARRAY_BUFFER=34963,Hd.ARRAY_BUFFER_BINDING=34964,Hd.ELEMENT_ARRAY_BUFFER_BINDING=34965,Hd.STREAM_DRAW=35040,Hd.STATIC_DRAW=35044,Hd.DYNAMIC_DRAW=35048,Hd.BUFFER_SIZE=34660,Hd.BUFFER_USAGE=34661,Hd.CURRENT_VERTEX_ATTRIB=34342,Hd.FRONT=1028,Hd.BACK=1029,Hd.CULL_FACE=2884,Hd.FRONT_AND_BACK=1032,Hd.BLEND=3042,Hd.DITHER=3024,Hd.STENCIL_TEST=2960,Hd.DEPTH_TEST=2929,Hd.SCISSOR_TEST=3089,Hd.POLYGON_OFFSET_FILL=32823,Hd.SAMPLE_ALPHA_TO_COVERAGE=32926,Hd.SAMPLE_COVERAGE=32928,Hd.NO_ERROR=0,Hd.INVALID_ENUM=1280,Hd.INVALID_VALUE=1281,Hd.INVALID_OPERATION=1282,Hd.OUT_OF_MEMORY=1285,Hd.CW=2304,Hd.CCW=2305,Hd.LINE_WIDTH=2849,Hd.ALIASED_POINT_SIZE_RANGE=33901,Hd.ALIASED_LINE_WIDTH_RANGE=33902,Hd.CULL_FACE_MODE=2885,Hd.FRONT_FACE=2886,Hd.DEPTH_RANGE=2928,Hd.DEPTH_WRITEMASK=2930,Hd.DEPTH_CLEAR_VALUE=2931,Hd.DEPTH_FUNC=2932,Hd.STENCIL_CLEAR_VALUE=2961,Hd.STENCIL_FUNC=2962,Hd.STENCIL_FAIL=2964,Hd.STENCIL_PASS_DEPTH_FAIL=2965,Hd.STENCIL_PASS_DEPTH_PASS=2966,Hd.STENCIL_REF=2967,Hd.STENCIL_VALUE_MASK=2963,Hd.STENCIL_WRITEMASK=2968,Hd.STENCIL_BACK_FUNC=34816,Hd.STENCIL_BACK_FAIL=34817,Hd.STENCIL_BACK_PASS_DEPTH_FAIL=34818,Hd.STENCIL_BACK_PASS_DEPTH_PASS=34819,Hd.STENCIL_BACK_REF=36003,Hd.STENCIL_BACK_VALUE_MASK=36004,Hd.STENCIL_BACK_WRITEMASK=36005,Hd.VIEWPORT=2978,Hd.SCISSOR_BOX=3088,Hd.COLOR_CLEAR_VALUE=3106,Hd.COLOR_WRITEMASK=3107,Hd.UNPACK_ALIGNMENT=3317,Hd.PACK_ALIGNMENT=3333,Hd.MAX_TEXTURE_SIZE=3379,Hd.MAX_VIEWPORT_DIMS=3386,Hd.SUBPIXEL_BITS=3408,Hd.RED_BITS=3410,Hd.GREEN_BITS=3411,Hd.BLUE_BITS=3412,Hd.ALPHA_BITS=3413,Hd.DEPTH_BITS=3414,Hd.STENCIL_BITS=3415,Hd.POLYGON_OFFSET_UNITS=10752,Hd.POLYGON_OFFSET_FACTOR=32824,Hd.TEXTURE_BINDING_2D=32873,Hd.SAMPLE_BUFFERS=32936,Hd.SAMPLES=32937,Hd.SAMPLE_COVERAGE_VALUE=32938,Hd.SAMPLE_COVERAGE_INVERT=32939,Hd.NUM_COMPRESSED_TEXTURE_FORMATS=34466,Hd.COMPRESSED_TEXTURE_FORMATS=34467,Hd.DONT_CARE=4352,Hd.FASTEST=4353,Hd.NICEST=4354,Hd.GENERATE_MIPMAP_HINT=33170,Hd.BYTE=5120,Hd.UNSIGNED_BYTE=5121,Hd.SHORT=5122,Hd.UNSIGNED_SHORT=5123,Hd.INT=5124,Hd.UNSIGNED_INT=5125,Hd.FLOAT=5126,Hd.DEPTH_COMPONENT=6402,Hd.ALPHA=6406,Hd.RGB=6407,Hd.RGBA=6408,Hd.LUMINANCE=6409,Hd.LUMINANCE_ALPHA=6410,Hd.UNSIGNED_SHORT_4_4_4_4=32819,Hd.UNSIGNED_SHORT_5_5_5_1=32820,Hd.UNSIGNED_SHORT_5_6_5=33635,Hd.FRAGMENT_SHADER=35632,Hd.VERTEX_SHADER=35633,Hd.MAX_VERTEX_ATTRIBS=34921,Hd.MAX_VERTEX_UNIFORM_VECTORS=36347,Hd.MAX_VARYING_VECTORS=36348,Hd.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,Hd.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,Hd.MAX_TEXTURE_IMAGE_UNITS=34930,Hd.MAX_FRAGMENT_UNIFORM_VECTORS=36349,Hd.SHADER_TYPE=35663,Hd.DELETE_STATUS=35712,Hd.LINK_STATUS=35714,Hd.VALIDATE_STATUS=35715,Hd.ATTACHED_SHADERS=35717,Hd.ACTIVE_UNIFORMS=35718,Hd.ACTIVE_ATTRIBUTES=35721,Hd.SHADING_LANGUAGE_VERSION=35724,Hd.CURRENT_PROGRAM=35725,Hd.NEVER=512,Hd.LESS=513,Hd.EQUAL=514,Hd.LEQUAL=515,Hd.GREATER=516,Hd.NOTEQUAL=517,Hd.GEQUAL=518,Hd.ALWAYS=519,Hd.KEEP=7680,Hd.REPLACE=7681,Hd.INCR=7682,Hd.DECR=7683,Hd.INVERT=5386,Hd.INCR_WRAP=34055,Hd.DECR_WRAP=34056,Hd.VENDOR=7936,Hd.RENDERER=7937,Hd.VERSION=7938,Hd.NEAREST=9728,Hd.LINEAR=9729,Hd.NEAREST_MIPMAP_NEAREST=9984,Hd.LINEAR_MIPMAP_NEAREST=9985,Hd.NEAREST_MIPMAP_LINEAR=9986,Hd.LINEAR_MIPMAP_LINEAR=9987,Hd.TEXTURE_MAG_FILTER=10240,Hd.TEXTURE_MIN_FILTER=10241,Hd.TEXTURE_WRAP_S=10242,Hd.TEXTURE_WRAP_T=10243,Hd.TEXTURE_2D=3553,Hd.TEXTURE=5890,Hd.TEXTURE_CUBE_MAP=34067,Hd.TEXTURE_BINDING_CUBE_MAP=34068,Hd.TEXTURE_CUBE_MAP_POSITIVE_X=34069,Hd.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,Hd.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,Hd.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,Hd.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,Hd.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,Hd.MAX_CUBE_MAP_TEXTURE_SIZE=34076,Hd.TEXTURE0=33984,Hd.TEXTURE1=33985,Hd.TEXTURE2=33986,Hd.TEXTURE3=33987,Hd.TEXTURE4=33988,Hd.TEXTURE5=33989,Hd.TEXTURE6=33990,Hd.TEXTURE7=33991,Hd.TEXTURE8=33992,Hd.TEXTURE9=33993,Hd.TEXTURE10=33994,Hd.TEXTURE11=33995,Hd.TEXTURE12=33996,Hd.TEXTURE13=33997,Hd.TEXTURE14=33998,Hd.TEXTURE15=33999,Hd.TEXTURE16=34e3,Hd.TEXTURE17=34001,Hd.TEXTURE18=34002,Hd.TEXTURE19=34003,Hd.TEXTURE20=34004,Hd.TEXTURE21=34005,Hd.TEXTURE22=34006,Hd.TEXTURE23=34007,Hd.TEXTURE24=34008,Hd.TEXTURE25=34009,Hd.TEXTURE26=34010,Hd.TEXTURE27=34011,Hd.TEXTURE28=34012,Hd.TEXTURE29=34013,Hd.TEXTURE30=34014,Hd.TEXTURE31=34015,Hd.ACTIVE_TEXTURE=34016,Hd.REPEAT=10497,Hd.CLAMP_TO_EDGE=33071,Hd.MIRRORED_REPEAT=33648,Hd.FLOAT_VEC2=35664,Hd.FLOAT_VEC3=35665,Hd.FLOAT_VEC4=35666,Hd.INT_VEC2=35667,Hd.INT_VEC3=35668,Hd.INT_VEC4=35669,Hd.BOOL=35670,Hd.BOOL_VEC2=35671,Hd.BOOL_VEC3=35672,Hd.BOOL_VEC4=35673,Hd.FLOAT_MAT2=35674,Hd.FLOAT_MAT3=35675,Hd.FLOAT_MAT4=35676,Hd.SAMPLER_2D=35678,Hd.SAMPLER_CUBE=35680,Hd.VERTEX_ATTRIB_ARRAY_ENABLED=34338,Hd.VERTEX_ATTRIB_ARRAY_SIZE=34339,Hd.VERTEX_ATTRIB_ARRAY_STRIDE=34340,Hd.VERTEX_ATTRIB_ARRAY_TYPE=34341,Hd.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,Hd.VERTEX_ATTRIB_ARRAY_POINTER=34373,Hd.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,Hd.COMPILE_STATUS=35713,Hd.LOW_FLOAT=36336,Hd.MEDIUM_FLOAT=36337,Hd.HIGH_FLOAT=36338,Hd.LOW_INT=36339,Hd.MEDIUM_INT=36340,Hd.HIGH_INT=36341,Hd.FRAMEBUFFER=36160,Hd.RENDERBUFFER=36161,Hd.RGBA4=32854,Hd.RGB5_A1=32855,Hd.RGB565=36194,Hd.DEPTH_COMPONENT16=33189,Hd.STENCIL_INDEX=6401,Hd.STENCIL_INDEX8=36168,Hd.DEPTH_STENCIL=34041,Hd.RENDERBUFFER_WIDTH=36162,Hd.RENDERBUFFER_HEIGHT=36163,Hd.RENDERBUFFER_INTERNAL_FORMAT=36164,Hd.RENDERBUFFER_RED_SIZE=36176,Hd.RENDERBUFFER_GREEN_SIZE=36177,Hd.RENDERBUFFER_BLUE_SIZE=36178,Hd.RENDERBUFFER_ALPHA_SIZE=36179,Hd.RENDERBUFFER_DEPTH_SIZE=36180,Hd.RENDERBUFFER_STENCIL_SIZE=36181,Hd.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,Hd.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,Hd.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,Hd.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,Hd.COLOR_ATTACHMENT0=36064,Hd.DEPTH_ATTACHMENT=36096,Hd.STENCIL_ATTACHMENT=36128,Hd.DEPTH_STENCIL_ATTACHMENT=33306,Hd.NONE=0,Hd.FRAMEBUFFER_COMPLETE=36053,Hd.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,Hd.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,Hd.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,Hd.FRAMEBUFFER_UNSUPPORTED=36061,Hd.FRAMEBUFFER_BINDING=36006,Hd.RENDERBUFFER_BINDING=36007,Hd.MAX_RENDERBUFFER_SIZE=34024,Hd.INVALID_FRAMEBUFFER_OPERATION=1286,Hd.UNPACK_FLIP_Y_WEBGL=37440,Hd.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,Hd.CONTEXT_LOST_WEBGL=37442,Hd.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,Hd.BROWSER_DEFAULT_WEBGL=37444,Hd._useProgram=null,Hd._depthTest=!0,Hd._depthMask=!0,Hd._blend=!1,Hd._cullFace=!1,Hd.curBindTexTarget=null,Hd.curBindTexValue=null,Hg(Hd,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),Hd}(),Hwa=function(Ha){function Hb(){Hb.__super.call(this)}Hm(Hb,"laya.webgl.display.GraphicsGL",Hh);var Hc=Hb.prototype;return Hc.setShader=function(Ha){this._saveToCmd(Hr.context._setShader,[Ha])},Hc.setIBVB=function(Ha,Hb,Hc,Hd,He,Hf){this._saveToCmd(Hr.context._setIBVB,[Ha,Hb,Hc,Hd,He,Hf])},Hc.drawParticle=function(Ha,Hb,Hc){var Hd=Hv.createParticleTemplate2D(Hc);Hd.x=Ha,Hd.y=Hb,this._saveToCmd(Hr.context._drawParticle,[Hd])},Hb}(),Hxa=function(Ha){var Hc;function HN(Ha){this._x=0,this._y=0,this._id=++HN._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,HN.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=HN.MAXCLIPRECT,this.mOutPoint,this._canvas=Ha,this._canvas._addReference(),HN._contextcount++,Hr.isFlash?(this._ib=H$a.create(35044),Hqa.fillIBQuadrangle(this._ib,16)):this._ib=H$a.QuadrangleIB,this.clear()}Hm(HN,"laya.webgl.canvas.WebGLContext2D",He);var Hb=HN.prototype;return Hb.setIsMainContext=function(){this._isMain=!0},Hb.clearBG=function(Ha,Hb,Hc,Hd){var He=Hua.mainContext;He.clearColor(Ha,Hb,Hc,Hd),He.clear(16384)},Hb._getSubmits=function(){return this._submits},Hb._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var Ha=0,Hb=this._submits._length;Ha<Hb;Ha++)this._submits[Ha].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},Hb.destroy=function(){--HN._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=H$a.QuadrangleIB&&this._ib.releaseResource()},Hb.clear=function(){this._submits||(this._other=Hc.DEFAULT,this._curMat=Hz.create(),this._vb=H_a.create(-1),this._submits=[],this._save=[HW.Create(this)],this._save.length=10,this._shader2D=new H$,this._triangleMesh=HIa.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=Hc.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=HN.MAXCLIPRECT,this._curSubmit=Hfa.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=HR.DEFAULT;for(var Ha=0,Hb=this._submits._length;Ha<Hb;Ha++)this._submits[Ha].releaseRender(),this._submits[Ha]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},Hb.size=function(Ha,Hb){if(this._width!=Ha||this._height!=Hb)if(0==Ha||0==Hb){0!=this._vb._byteLength&&(this._width=Ha,this._height=Hb,this._vb.clear(),this._vb.upload());for(var Hc=0,Hd=this._submits._length;Hc<Hd;Hc++)this._submits[Hc].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=Ha,this._height=Hb,this._targets&&this._targets.size(Ha,Hb),this._canvas.memorySize-=this._canvas.memorySize;0===Ha&&0===Hb&&this._releaseMem()},Hb._getTransformMatrix=function(){return this._curMat},Hb.translate=function(Ha,Hb){0===Ha&&0===Hb||(HY.save(this),this._curMat.bTransform&&(HX.save(this),this._curMat.transformPointN(HA.TEMP.setTo(Ha,Hb)),Ha=HA.TEMP.x,Hb=HA.TEMP.y),this._x+=Ha,this._y+=Hb)},Hb.save=function(){this._save[this._save._length++]=HW.Create(this)},Hb.restore=function(){var Ha=this._save._length;if(!(Ha<1))for(var Hb=Ha-1;0<=Hb;Hb--){var Hc=this._save[Hb];if(Hc.restore(this),Hc.isSaveMark())return void(this._save._length=Hb)}},Hb._fillText=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){void 0===Hj&&(Hj=0);var Hk=this._shader2D,Hl=this._curSubmit.shaderValue,Hm=He?Hoa.create(He):this._other.font;if(HO.enabled)Hk.ALPHA!==Hl.ALPHA&&(Hk.glTexture=null),Hna.drawText(this,Ha,Hb,this._curMat,Hm,Hi||this._other.textAlign,Hf,Hg,Hh,Hc,Hd,Hj);else{this._shader2D.defines.getValue();var Hn=Hf?Ho.create(Hf)._color:Hk.colorAdd;Hk.ALPHA===Hl.ALPHA&&Hn===Hk.colorAdd&&Hl.colorAdd===Hk.colorAdd||(Hk.glTexture=null,Hk.colorAdd=Hn),Hna.drawText(this,Ha,Hb,this._curMat,Hm,Hi||this._other.textAlign,Hf,Hg,Hh,Hc,Hd,Hj)}},Hb.fillWords=function(Ha,Hb,Hc,Hd,He,Hf){this._fillText(null,Ha,Hb,Hc,Hd,He,null,-1,null,Hf)},Hb.fillBorderWords=function(Ha,Hb,Hc,Hd,He,Hf,Hg){this._fillBorderText(null,Ha,Hb,Hc,Hd,He,Hf,Hg,null)},Hb.fillText=function(Ha,Hb,Hc,Hd,He,Hf){this._fillText(Ha,null,Hb,Hc,Hd,He,null,-1,Hf)},Hb.strokeText=function(Ha,Hb,Hc,Hd,He,Hf,Hg){this._fillText(Ha,null,Hb,Hc,Hd,null,He,Hf||1,Hg)},Hb.fillBorderText=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){this._fillBorderText(Ha,null,Hb,Hc,Hd,He,Hf,Hg,Hh)},Hb._fillBorderText=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){if(!HO.enabled)return this._fillText(Ha,Hb,Hc,Hd,He,null,Hg,Hh||1,Hi),void this._fillText(Ha,Hb,Hc,Hd,He,Hf,null,-1,Hi);var Hj=this._shader2D,Hk=this._curSubmit.shaderValue;Hj.ALPHA!==Hk.ALPHA&&(Hj.glTexture=null);var Hl=He?(HN._fontTemp.setFont(He),HN._fontTemp):this._other.font;Hna.drawText(this,Ha,Hb,this._curMat,Hl,Hi||this._other.textAlign,Hf,Hg,Hh||1,Hc,Hd,0)},Hb.fillRect=function(Ha,Hb,Hc,Hd,He){var Hf=this._vb;if(Hqa.fillRectImgVb(Hf,this._clipRect,Ha,Hb,Hc,Hd,HI.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var Hg=this._shader2D.fillStyle;He&&(this._shader2D.fillStyle=HR.create(He));var Hh=this._shader2D,Hi=this._curSubmit.shaderValue;if(Hh.fillStyle!==Hi.fillStyle||Hh.ALPHA!==Hi.ALPHA){Hh.glTexture=null;var Hj=this._curSubmit=Hfa.createSubmit(this,this._ib,Hf,(Hf._byteLength-64)/32*3,Hya.create(2,0));Hj.shaderValue.color=Hh.fillStyle._color._color,Hj.shaderValue.ALPHA=Hh.ALPHA,this._submits[this._submits._length++]=Hj}this._curSubmit._numEle+=6,this._shader2D.fillStyle=Hg}},Hb.fillTexture=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){if(Ha.loaded&&Ha.bitmap&&Ha.source){var Hi=this._vb,Hj=Ha.bitmap.width,Hk=Ha.bitmap.height,Hl=Ha.uv,Hm=Hg.x%Ha.width,Hn=Hg.y%Ha.height;if(Hj!=Hh.w||Hk!=Hh.h){if(!Hh.w&&!Hh.h)switch(Hh.oy=Hh.ox=0,Hf){case"repeat":Hh.width=Hd,Hh.height=He;break;case"repeat-x":Hh.width=Hd,Hn<0?Ha.height+Hn>He?Hh.height=He:Hh.height=Ha.height+Hn:(Hh.oy=Hn,Ha.height+Hn>He?Hh.height=He-Hn:Hh.height=Ha.height);break;case"repeat-y":Hm<0?Ha.width+Hm>Hd?Hh.width=Hd:Hh.width=Ha.width+Hm:(Hh.ox=Hm,Ha.width+Hm>Hd?Hh.width=Hd-Hm:Hh.width=Ha.width),Hh.height=He;break;case"no-repeat":Hm<0?Ha.width+Hm>Hd?Hh.width=Hd:Hh.width=Ha.width+Hm:(Hh.ox=Hm,Ha.width+Hm>Hd?Hh.width=Hd-Hm:Hh.width=Ha.width),Hn<0?Ha.height+Hn>He?Hh.height=He:Hh.height=Ha.height+Hn:(Hh.oy=Hn,Ha.height+Hn>He?Hh.height=He-Hn:Hh.height=Ha.height);break;default:Hh.width=Hd,Hh.height=He}Hh.w=Hj,Hh.h=Hk,Hh.uv=[0,0,Hh.width/Hj,0,Hh.width/Hj,Hh.height/Hk,0,Hh.height/Hk]}if(Hb+=Hh.ox,Hc+=Hh.oy,Hm-=Hh.ox,Hn-=Hh.oy,Hqa.fillRectImgVb(Hi,this._clipRect,Hb,Hc,Hh.width,Hh.height,Hh.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var Ho=HHa.create(this,this._ib,Hi,(Hi._byteLength-64)/32*3,Hya.create(256,0)),Hp=(this._submits[this._submits._length++]=Ho).shaderValue;Hp.textureHost=Ha;var Hq=Hl[0]*Hj,Hr=Hl[1]*Hk,Hs=(Hl[2]-Hl[0])*Hj,Ht=(Hl[5]-Hl[3])*Hk,Hu=-Hm/Hj,Hv=-Hn/Hk;Hp.u_TexRange[0]=Hq/Hj,Hp.u_TexRange[1]=Hs/Hj,Hp.u_TexRange[2]=Hr/Hk,Hp.u_TexRange[3]=Ht/Hk,Hp.u_offset[0]=Hu,Hp.u_offset[1]=Hv,HO.enabled&&!this._isMain&&Ho.addTexture(Ha,(Hi._byteLength>>2)-16),(this._curSubmit=Ho)._renderType=10017,Ho._numEle+=6}}else this.sprite&&Hw.timer.callLater(this,this._repaintSprite)},Hb.setShader=function(Ha){HT.save(this,1048576,this._shader2D,!0),this._shader2D.shader=Ha},Hb.setFilters=function(Ha){HT.save(this,2097152,this._shader2D,!0),this._shader2D.filters=Ha,this._curSubmit=Hfa.RENDERBASE,this._renderKey=0,this._drawCount++},Hb.drawTexture=function(Ha,Hb,Hc,Hd,He,Hf,Hg){this._drawTextureM(Ha,Hb,Hc,Hd,He,Hf,Hg,null,1)},Hb.addTextureVb=function(Ha,Hb,Hc){var Hd=this._curSubmit._vb||this._vb,He=Hd._byteLength>>2;Hd.byteLength=He+16<<2;for(var Hf=Hd.getFloat32Array(),Hg=0;Hg<16;Hg+=4)Hf[He++]=Ha[Hg]+Hb,Hf[He++]=Ha[Hg+1]+Hc,Hf[He++]=Ha[Hg+2],Hf[He++]=Ha[Hg+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),Hd._upload=!0},Hb.willDrawTexture=function(Ha,Hb){if(!(Ha.loaded&&Ha.bitmap&&Ha.source))return this.sprite&&Hw.timer.callLater(this,this._repaintSprite),0;var Hc=Ha.bitmap,Hd=Hc.id+this._shader2D.ALPHA*Hb+10016;if(Hd==this._renderKey)return Hd;var He=this._shader2D,Hf=He.ALPHA,Hg=this._curSubmit.shaderValue;He.ALPHA*=Hb,this._renderKey=Hd,this._drawCount++,He.glTexture=Hc;var Hh=this._vb,Hi=null,Hj=Hh._byteLength/32*3,Hk=Hg.textureHost&&Hg.textureHost==Ha&&Hg.textureHost.alphaTexture==Ha.alphaTexture;return Hi=HHa.create(this,this._ib,Hh,Hj,Hya.create(1,0)),(this._submits[this._submits._length++]=Hi).shaderValue.textureHost=Ha,Hi._renderType=10016,Hi._preIsSameTextureShader=10016===this._curSubmit._renderType&&He.ALPHA===Hg.ALPHA&&Hk,this._curSubmit=Hi,He.ALPHA=Hf,Hd},Hb.drawTextures=function(Ha,Hb,Hc,Hd){if(Ha.loaded&&Ha.bitmap&&Ha.source){var He=this._clipRect;if(this._clipRect=HN.MAXCLIPRECT,this._drawTextureM(Ha,Hb[0],Hb[1],Ha.width,Ha.height,Hc,Hd,null,1)){if(this._clipRect=He,HE.drawCall++,!(Hb.length<4)){for(var Hf=this._curSubmit._vb||this._vb,Hg=this._curMat.a,Hh=this._curMat.d,Hi=2,Hj=Hb.length;Hi<Hj;Hi+=2)Hqa.copyPreImgVb(Hf,(Hb[Hi]-Hb[Hi-2])*Hg,(Hb[Hi+1]-Hb[Hi-1])*Hh),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&Hw.timer.callLater(this,this._repaintSprite)},Hb._drawTextureM=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){if(!Ha.loaded||!Ha.source)return this.sprite&&Hw.timer.callLater(this,this._repaintSprite),!1;var Hj=this._curSubmit._vb||this._vb,Hk=Ha.bitmap;Hb+=Hf,Hc+=Hg,this._drawCount++;var Hl=Hk.id+this._shader2D.ALPHA*Hi+10016;if(Hl!=this._renderKey){this._renderKey=Hl;var Hm=this._curSubmit.shaderValue,Hn=this._shader2D,Ho=Hn.ALPHA;Hn.ALPHA*=Hi,Hn.glTexture=Hk;var Hp=this._vb,Hq=null,Hr=Hp._byteLength/32*3,Hs=Hm.textureHost&&Hm.textureHost==Ha&&Hm.textureHost.alphaTexture==Ha.alphaTexture;Hq=HHa.create(this,this._ib,Hp,Hr,Hya.create(1,0)),(this._submits[this._submits._length++]=Hq).shaderValue.textureHost=Ha,Hq._renderType=10016,Hq._preIsSameTextureShader=10016===this._curSubmit._renderType&&Hn.ALPHA===Hm.ALPHA&&Hs,this._curSubmit=Hq,Hj=this._curSubmit._vb||this._vb,Hn.ALPHA=Ho}return!!Hqa.fillRectImgVb(Hj,this._clipRect,Hb,Hc,Hd||Ha.width,He||Ha.height,Ha.uv,Hh||this._curMat,this._x,this._y,0,0)&&(HO.enabled&&!this._isMain&&this._curSubmit.addTexture(Ha,(Hj._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},Hb._repaintSprite=function(){this.sprite&&this.sprite.repaint()},Hb._drawText=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){var Hk=Ha.bitmap;this._drawCount++;var Hl=Hk.id+this._shader2D.ALPHA+10016;if(Hl!=this._renderKey){this._renderKey=Hl;var Hm=this._curSubmit.shaderValue,Hn=this._shader2D;Hn.glTexture=Hk;var Ho=this._vb,Hp=null,Hq=Ho._byteLength/32*3,Hr=Hm.textureHost&&Hm.textureHost==Ha&&Hm.textureHost.alphaTexture==Ha.alphaTexture;(Hp=HO.enabled?HHa.create(this,this._ib,Ho,Hq,Hya.create(1,0)):HHa.create(this,this._ib,Ho,Hq,HYa.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&Hn.ALPHA===Hm.ALPHA&&Hr,(this._submits[this._submits._length++]=Hp).shaderValue.textureHost=Ha,Hp._renderType=10016,this._curSubmit=Hp}Ha.active();var Hs=this._curSubmit._vb||this._vb;Hqa.fillRectImgVb(Hs,this._clipRect,Hb+Hg,Hc+Hh,Hd||Ha.width,He||Ha.height,Ha.uv,Hf||this._curMat,this._x,this._y,Hi,Hj,!0)&&(HO.enabled&&!this._isMain&&this._curSubmit.addTexture(Ha,(Hs._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},Hb.drawTextureWithTransform=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){if(Hf){var Hj=this._curMat,Hk=this._x,Hl=this._y;(0!==Hg||0!==Hh)&&(this._x=Hg*Hj.a+Hh*Hj.c,this._y=Hh*Hj.d+Hg*Hj.b),Hf&&Hj.bTransform?(Hz.mul(Hf,Hj,HN._tmpMatrix),(Hf=HN._tmpMatrix)._checkTransform()):(this._x+=Hj.tx,this._y+=Hj.ty),this._drawTextureM(Ha,Hb,Hc,Hd,He,0,0,Hf,Hi),this._x=Hk,this._y=Hl}else this._drawTextureM(Ha,Hb,Hc,Hd,He,Hg,Hh,null,Hi)},Hb.fillQuadrangle=function(Ha,Hb,Hc,Hd,He){var Hf=this._curSubmit,Hg=this._vb,Hh=this._shader2D,Hi=Hf.shaderValue;if(this._renderKey=0,Ha.bitmap){var Hj=Ha.bitmap;Hh.glTexture==Hj&&Hh.ALPHA===Hi.ALPHA||(Hh.glTexture=Hj,(Hf=this._curSubmit=Hfa.createSubmit(this,this._ib,Hg,Hg._byteLength/32*3,Hya.create(1,0))).shaderValue.glTexture=Hj,this._submits[this._submits._length++]=Hf),Hqa.fillQuadrangleImgVb(Hg,Hb,Hc,Hd,Ha.uv,He||this._curMat,this._x,this._y)}else Hf.shaderValue.fillStyle&&Hf.shaderValue.fillStyle.equal(Ha)&&Hh.ALPHA===Hi.ALPHA||(Hh.glTexture=null,(Hf=this._curSubmit=Hfa.createSubmit(this,this._ib,Hg,Hg._byteLength/32*3,Hya.create(2,0))).shaderValue.defines.add(2),Hf.shaderValue.fillStyle=HR.create(Ha),this._submits[this._submits._length++]=Hf),Hqa.fillQuadrangleImgVb(Hg,Hb,Hc,Hd,HI.DEF_UV,He||this._curMat,this._x,this._y);Hf._numEle+=6},Hb.drawTexture2=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){if(0!=Hf){var Hi=this._curMat;if(this._x=Ha*Hi.a+Hb*Hi.c,this._y=Hb*Hi.d+Ha*Hi.b,He&&(He=Hi.bTransform||He.bTransform?(Hz.mul(He,Hi,HN._tmpMatrix),HN._tmpMatrix):(this._x+=He.tx+Hi.tx,this._y+=He.ty+Hi.ty,Hz.EMPTY)),1!==Hf||Hg){var Hj=this._shader2D.ALPHA,Hk=this._nBlendType;this._shader2D.ALPHA=Hf,Hg&&(this._nBlendType=HQ.TOINT(Hg)),this._drawTextureM(Hh[0],Hh[1]-Hc,Hh[2]-Hd,Hh[3],Hh[4],0,0,He,1),this._shader2D.ALPHA=Hj,this._nBlendType=Hk}else this._drawTextureM(Hh[0],Hh[1]-Hc,Hh[2]-Hd,Hh[3],Hh[4],0,0,He,1);this._x=this._y=0}},Hb.drawCanvas=function(Ha,Hb,Hc,Hd,He){var Hf=Ha.context;if(this._renderKey=0,Hf._targets)this._submits[this._submits._length++]=HGa.create(Hf,0,null),this._curSubmit=Hfa.RENDERBASE,Hf._targets.drawTo(this,Hb,Hc,Hd,He);else{var Hg=this._submits[this._submits._length++]=HGa.create(Hf,this._shader2D.ALPHA,this._shader2D.filters),Hh=Hd/Ha.width,Hi=He/Ha.height,Hj=Hg._matrix;this._curMat.copyTo(Hj),1!=Hh&&1!=Hi&&Hj.scale(Hh,Hi);var Hk=Hj.tx,Hl=Hj.ty;Hj.tx=Hj.ty=0,Hj.transformPoint(HA.TEMP.setTo(Hb,Hc)),Hj.translate(HA.TEMP.x+Hk,HA.TEMP.y+Hl),this._curSubmit=Hfa.RENDERBASE}Hx.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=Hf._targets?"yellow":"green",this.strokeRect(Hb-1,Hc-1,Hd+2,He+2,1),this.strokeRect(Hb,Hc,Hd,He,1),this.restore())},Hb.drawTarget=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){void 0===Hj&&(Hj=-1);var Hk=this._vb;if(Hqa.fillRectImgVb(Hk,this._clipRect,Hb,Hc,Hd,He,Hi||HI.DEF_UV,Hf||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var Hl=this._curSubmit=Hla.create(this,this._ib,Hk,(Hk._byteLength-64)/32*3,Hh,Hg);Hl.blendType=-1==Hj?this._nBlendType:Hj,Hl.scope=Ha,this._submits[this._submits._length++]=Hl,this._curSubmit._numEle+=6}},Hb.mixRGBandAlpha=function(Ha){return this._mixRGBandAlpha(Ha,this._shader2D.ALPHA)},Hb._mixRGBandAlpha=function(Ha,Hb){var Hc=(4278190080&Ha)>>>24;return 0!=Hc?Hc*=Hb:Hc=255*Hb,16777215&Ha|Hc<<24},Hb.drawTriangles=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){if(!Ha.loaded||!Ha.source)return this.sprite&&Hw.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;Ha.bitmap;var Hk=this._mixRGBandAlpha(4294967295,Hh),Hl=(Hd.length,Hf.length);this._renderKey=-1;var Hm=this._curSubmit=HHa.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,Hya.create(1,0));return Hm.shaderValue.textureHost=Ha,Hm._renderType=10016,this._submits[this._submits._length++]=Hm,Hg?(HN._tmpMatrix.a=Hg.a,HN._tmpMatrix.b=Hg.b,HN._tmpMatrix.c=Hg.c,HN._tmpMatrix.d=Hg.d,HN._tmpMatrix.tx=Hg.tx+Hb,HN._tmpMatrix.ty=Hg.ty+Hc,Hz.mul(HN._tmpMatrix,this._curMat,HN._tmpMatrix)):(HN._tmpMatrix.a=this._curMat.a,HN._tmpMatrix.b=this._curMat.b,HN._tmpMatrix.c=this._curMat.c,HN._tmpMatrix.d=this._curMat.d,HN._tmpMatrix.tx=this._curMat.tx+Hb,HN._tmpMatrix.ty=this._curMat.ty+Hc),this._triangleMesh.addData(Hd,He,Hf,HN._tmpMatrix,Hk,this),this._curSubmit._numEle+=Hl,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},Hb.transform=function(Ha,Hb,Hc,Hd,He,Hf){HX.save(this),Hz.mul(Hz.TEMP.setTo(Ha,Hb,Hc,Hd,He,Hf),this._curMat,this._curMat),this._curMat._checkTransform()},Hb.setTransformByMatrix=function(Ha){Ha.copyTo(this._curMat)},Hb.transformByMatrix=function(Ha){HX.save(this),Hz.mul(Ha,this._curMat,this._curMat),this._curMat._checkTransform()},Hb.rotate=function(Ha){HX.save(this),this._curMat.rotateEx(Ha)},Hb.scale=function(Ha,Hb){HX.save(this),this._curMat.scaleEx(Ha,Hb)},Hb.clipRect=function(Ha,Hb,Hc,Hd){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var He=Hka.create(4);this.addRenderObject(He);var Hf=this._vb,Hg=Hf._byteLength>>2;if(Hqa.fillRectImgVb(Hf,null,Ha,Hb,Hc,Hd,HI.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var Hh=this._curSubmit=Hfa.createSubmit(this,this._ib,Hf,(Hf._byteLength-64)/32*3,Hya.create(2,0));Hh.shaderValue.ALPHA=1,this._submits[this._submits._length++]=Hh,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var Hi=Hka.create(5);this.addRenderObject(Hi);var Hj=Hf.getFloat32Array(),Hk=Math.min(Math.min(Math.min(Hj[0+Hg],Hj[4+Hg]),Hj[8+Hg]),Hj[12+Hg]),Hl=Math.max(Math.max(Math.max(Hj[0+Hg],Hj[4+Hg]),Hj[8+Hg]),Hj[12+Hg]),Hm=Math.min(Math.min(Math.min(Hj[1+Hg],Hj[5+Hg]),Hj[9+Hg]),Hj[13+Hg]),Hn=Math.max(Math.max(Math.max(Hj[1+Hg],Hj[5+Hg]),Hj[9+Hg]),Hj[13+Hg]);HV.save(this,Hi,Ha,Hb,Hc,Hd,Hk,Hm,Hl-Hk,Hn-Hm),this._curSubmit=Hfa.RENDERBASE}else{Hc*=this._curMat.a,Hd*=this._curMat.d;var Ho=HA.TEMP;this._curMat.transformPoint(Ho.setTo(Ha,Hb)),Hc<0&&(Ho.x=Ho.x+Hc,Hc=-Hc),Hd<0&&(Ho.y=Ho.y+Hd,Hd=-Hd),this._renderKey=0;var Hp=this._curSubmit=Hja.create(this);(this._submits[this._submits._length++]=Hp).submitIndex=this._submits._length,Hp.submitLength=9999999,HU.save(this,Hp);var Hq=this._clipRect,Hr=Hq.x,Hs=Hq.y,Ht=Ho.x+Hc,Hu=Ho.y+Hd;Hr<Ho.x&&(Hq.x=Ho.x),Hs<Ho.y&&(Hq.y=Ho.y),Hq.width=Math.min(Ht,Hr+Hq.width)-Hq.x,Hq.height=Math.min(Hu,Hs+Hq.height)-Hq.y,this._shader2D.glTexture=null,Hp.clipRect.copyFrom(Hq),this._curSubmit=Hfa.RENDERBASE}},Hb.setIBVB=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk){if(void 0===Hi&&(Hi=0),void 0===Hj&&(Hj=0),void 0===Hk&&(Hk=0),null===Hc){if(Hr.isFlash){var Hl=Hd;Hl._selfIB||(Hl._selfIB=H$a.create(35044)),Hl._selfIB.clear(),Hc=Hl._selfIB}else Hc=this._ib;Hqa.expandIBQuadrangle(Hc,Hd._byteLength/(4*Hd.vertexStride*4))}if(!Hh||!Hg)throw Error("setIBVB must input:shader shaderValues");var Hm=Hia.create(this,Hd,Hc,He,Hg,Hh,Hi,Hj,Hk);Hf||(Hf=Hz.EMPTY),Hf.translate(Ha,Hb),Hz.mul(Hf,this._curMat,Hm._mat),Hf.translate(-Ha,-Hb),this._submits[this._submits._length++]=Hm,this._curSubmit=Hfa.RENDERBASE,this._renderKey=0},Hb.addRenderObject=function(Ha){this._submits[this._submits._length++]=Ha},Hb.fillTrangles=function(Ha,Hb,Hc,Hd,He){var Hf=this._curSubmit,Hg=this._vb,Hh=this._shader2D,Hi=Hf.shaderValue,Hj=Hd.length>>4,Hk=Ha.bitmap;this._renderKey=0,Hh.glTexture==Hk&&Hh.ALPHA===Hi.ALPHA||((Hf=this._curSubmit=Hfa.createSubmit(this,this._ib,Hg,Hg._byteLength/32*3,Hya.create(1,0))).shaderValue.textureHost=Ha,this._submits[this._submits._length++]=Hf),Hqa.fillTranglesVB(Hg,Hb,Hc,Hd,He||this._curMat,this._x,this._y),Hf._numEle+=6*Hj},Hb.submitElement=function(Ha,Hb){var Hc=this._submits;for(Hb<0&&(Hb=Hc._length);Ha<Hb;)Ha+=Hc[Ha].renderSubmit()},Hb.finish=function(){Hua.mainContext.finish()},Hb.flush=function(){var Ha=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(Ha>this._ib.bufferLength/12&&Hqa.expandIBQuadrangle(this._ib,Ha),!this._isMain&&HO.enabled&&HO._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=HO._atlasRestore;for(var Hb=this._submits,Hc=0,Hd=Hb._length;Hc<Hd;Hc++){var He=Hb[Hc];10016===He.getRenderType()&&He.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),Hba.instance&&Hba.getInstance().reset();var Hf;for(Hc=0,Hf=this.meshlist.length;Hc<Hf;Hc++){var Hg=this.meshlist[Hc];Hg.canReuse?Hg.releaseMesh():Hg.destroy()}return this.meshlist.length=0,this._curSubmit=Hfa.RENDERBASE,this._renderKey=0,this._triangleMesh=HIa.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},Hb.setPathId=function(Ha){if(this.mId=Ha,-1!=this.mId){this.mHaveKey=!1;var Hb=HK.getInstance();Hb.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,Hb.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},Hb.movePath=function(Ha,Hb){var Hc=Ha,Hd=Hb;Ha=this._curMat.a*Hc+this._curMat.c*Hd+this._curMat.tx,Hb=this._curMat.b*Hc+this._curMat.d*Hd+this._curMat.ty,this.mX+=Ha,this.mY+=Hb},Hb.beginPath=function(){var Ha=this._getPath();Ha.tempArray.length=0,Ha.closePath=!1,this.mX=0,this.mY=0},Hb.closePath=function(){this._path.closePath=!0},Hb.fill=function(Ha){void 0===Ha&&(Ha=!1);var Hb=this._getPath();this.drawPoly(0,0,Hb.tempArray,this.fillStyle._color.numColor,0,0,Ha)},Hb.stroke=function(){var Ha=this._getPath();if(0<this.lineWidth){if(-1==this.mId)Ha.drawLine(0,0,Ha.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var Hb=HK.getInstance().shapeLineDic[this.mId];Hb.rebuild(Ha.tempArray),Ha.setGeomtry(Hb)}else HK.getInstance().addLine(this.mId,Ha.drawLine(0,0,Ha.tempArray,this.lineWidth,this.strokeStyle._color.numColor));Ha.update();var Hc=[this.mX,this.mY],Hd=Hfa.createShape(this,Ha.ib,Ha.vb,Ha.count,Ha.offset,Hya.create(4,0));Hd.shaderValue.ALPHA=this._shader2D.ALPHA,Hd.shaderValue.u_pos=Hc,Hd.shaderValue.u_mmat2=Hsa.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=Hd,this._renderKey=-1}},Hb.line=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=this._curSubmit,Hh=this._vb;if(Hqa.fillLineVb(Hh,this._clipRect,Ha,Hb,Hc,Hd,He,Hf)){this._renderKey=0;var Hi=this._shader2D,Hj=Hg.shaderValue;Hi.strokeStyle===Hj.strokeStyle&&Hi.ALPHA===Hj.ALPHA||(Hi.glTexture=null,(Hg=this._curSubmit=Hfa.createSubmit(this,this._ib,Hh,(Hh._byteLength-64)/32*3,Hya.create(2,0))).shaderValue.strokeStyle=Hi.strokeStyle,Hg.shaderValue.mainID=2,Hg.shaderValue.ALPHA=Hi.ALPHA,this._submits[this._submits._length++]=Hg),Hg._numEle+=6}},Hb.moveTo=function(Ha,Hb,Hc){void 0===Hc&&(Hc=!0);var Hd=this._getPath();if(Hc){var He=Ha,Hf=Hb;Ha=this._curMat.a*He+this._curMat.c*Hf,Hb=this._curMat.b*He+this._curMat.d*Hf}Hd.addPoint(Ha,Hb)},Hb.lineTo=function(Ha,Hb,Hc){void 0===Hc&&(Hc=!0);var Hd=this._getPath();if(Hc){var He=Ha,Hf=Hb;Ha=this._curMat.a*He+this._curMat.c*Hf,Hb=this._curMat.b*He+this._curMat.d*Hf}Hd.addPoint(Ha,Hb)},Hb.drawCurves=function(Ha,Hb,Hc){this.setPathId(-1),this.beginPath(),this.strokeStyle=Hc[3],this.lineWidth=Hc[4];var Hd=Hc[2];Ha+=Hc[0],Hb+=Hc[1],this.movePath(Ha,Hb),this.moveTo(Hd[0],Hd[1]);for(var He=2,Hf=Hd.length;He<Hf;)this.quadraticCurveTo(Hd[He++],Hd[He++],Hd[He++],Hd[He++]);this.stroke()},Hb.arcTo=function(Ha,Hb,Hc,Hd,He){if(-1==this.mId||!this.mHaveKey){var Hf=0,Hg=0,Hh=0,Hi=this._getPath();this._curMat.copyTo(HN._tmpMatrix),HN._tmpMatrix.tx=HN._tmpMatrix.ty=0,HN._tempPoint.setTo(Hi.getEndPointX(),Hi.getEndPointY()),HN._tmpMatrix.invertTransformPoint(HN._tempPoint);var Hj=HN._tempPoint.x-Ha,Hk=HN._tempPoint.y-Hb,Hl=Math.sqrt(Hj*Hj+Hk*Hk);if(!(Hl<=1e-6)){var Hm=Hj/Hl,Hn=Hk/Hl,Ho=Hc-Ha,Hp=Hd-Hb,Hq=Ho*Ho+Hp*Hp,Hr=Math.sqrt(Hq);if(!(Hr<=1e-6)){var Hs=Ho/Hr,Ht=Hp/Hr,Hu=Hm+Hs,Hv=Hn+Ht,Hw=Math.sqrt(Hu*Hu+Hv*Hv);if(!(Hw<=1e-6)){var Hx=Hu/Hw,Hy=Hv/Hw,Hz=Math.acos(Hx*Hm+Hy*Hn),HA=Math.PI/2-Hz,HB=(Hl=He/Math.tan(HA))*Hm+Ha,HC=Hl*Hn+Hb,HD=Math.sqrt(Hl*Hl+He*He),HE=Ha+Hx*HD,HF=Hb+Hy*HD,HG=0,HH=0;if(0<=Hm*Ht-Hn*Hs){var HI=2*HA/HN.SEGNUM;HG=Math.sin(HI),HH=Math.cos(HI)}else HI=2*-HA/HN.SEGNUM,HG=Math.sin(HI),HH=Math.cos(HI);Hg=this._curMat.a*HB+this._curMat.c*HC,Hh=this._curMat.b*HB+this._curMat.d*HC,Hg==this._path.getEndPointX()&&Hh==this._path.getEndPointY()||Hi.addPoint(Hg,Hh);var HJ=HB-HE,HK=HC-HF;for(Hf=0;Hf<HN.SEGNUM;Hf++){var HL=HJ*HH+HK*HG,HM=-HJ*HG+HK*HH;Hg=HL+HE,Hh=HM+HF,Ha=this._curMat.a*Hg+this._curMat.c*Hh,Hh=Hb=this._curMat.b*Hg+this._curMat.d*Hh,(Hg=Ha)==this._path.getEndPointX()&&Hh==this._path.getEndPointY()||Hi.addPoint(Hg,Hh),HJ=HL,HK=HM}}}}}},Hb.arc=function(Ha,Hb,Hc,Hd,He,Hf,Hg){if(void 0===Hf&&(Hf=!1),void 0===Hg&&(Hg=!0),-1!=this.mId){var Hh=HK.getInstance().shapeDic[this.mId];if(Hh&&this.mHaveKey&&!Hh.needUpdate(this._curMat))return;Hb=Ha=0}var Hi,Hj=0,Hk=0,Hl=0,Hm=0,Hn=0,Ho=0,Hp=0;if(Hk=He-Hd,Hf)if(Math.abs(Hk)>=2*Math.PI)Hk=2*-Math.PI;else for(;0<Hk;)Hk-=2*Math.PI;else if(Math.abs(Hk)>=2*Math.PI)Hk=2*Math.PI;else for(;Hk<0;)Hk+=2*Math.PI;Hi=Hk/(Hp=Hc<101?Math.max(10,Hk*Hc/5):Hc<201?Math.max(10,Hk*Hc/20):Math.max(10,Hk*Hc/40))/2,Hl=Math.abs(4/3*(1-Math.cos(Hi))/Math.sin(Hi)),Hf&&(Hl=-Hl);var Hq=this._getPath(),Hr=NaN,Hs=NaN;for(Ho=0;Ho<=Hp;Ho++)Hj=Hd+Hk*(Ho/Hp),Hm=Ha+Math.cos(Hj)*Hc,Hn=Hb+Math.sin(Hj)*Hc,Hg&&(Hr=Hm,Hs=Hn,Hm=this._curMat.a*Hr+this._curMat.c*Hs,Hn=this._curMat.b*Hr+this._curMat.d*Hs),Hm==this._path.getEndPointX()&&Hn==this._path.getEndPointY()||Hq.addPoint(Hm,Hn);Hm=Ha+Math.cos(He)*Hc,Hn=Hb+Math.sin(He)*Hc,Hg&&(Hr=Hm,Hs=Hn,Hm=this._curMat.a*Hr+this._curMat.c*Hs,Hn=this._curMat.b*Hr+this._curMat.d*Hs),Hm==this._path.getEndPointX()&&Hn==this._path.getEndPointY()||Hq.addPoint(Hm,Hn)},Hb.quadraticCurveTo=function(Ha,Hb,Hc,Hd){var He=Hl.I,Hf=Hc,Hg=Hd;Hc=this._curMat.a*Hf+this._curMat.c*Hg,Hd=this._curMat.b*Hf+this._curMat.d*Hg,Hf=Ha,Hg=Hb,Ha=this._curMat.a*Hf+this._curMat.c*Hg,Hb=this._curMat.b*Hf+this._curMat.d*Hg;for(var Hh=He.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),Ha,Hb,Hc,Hd],30,2),Hi=0,Hj=Hh.length/2;Hi<Hj;Hi++)this.lineTo(Hh[2*Hi],Hh[2*Hi+1],!1);this.lineTo(Hc,Hd,!1)},Hb.rect=function(Ha,Hb,Hc,Hd){this._other=this._other.make(),this._other.path||(this._other.path=new HS),this._other.path.rect(Ha,Hb,Hc,Hd)},Hb.strokeRect=function(Ha,Hb,Hc,Hd,He){var Hf=.5*He;this.line(Ha-Hf,Hb,Ha+Hc+Hf,Hb,He,this._curMat),this.line(Ha+Hc,Hb,Ha+Hc,Hb+Hd,He,this._curMat),this.line(Ha,Hb,Ha,Hb+Hd,He,this._curMat),this.line(Ha-Hf,Hb+Hd,Ha+Hc+Hf,Hb+Hd,He,this._curMat)},Hb.clip=function(){},Hb.drawPoly=function(Ha,Hb,Hc,Hd,He,Hf,Hg){void 0===Hg&&(Hg=!1),this._renderKey=0,this._shader2D.glTexture=null;var Hh=this._getPath();if(-1==this.mId)Hh.polygon(Ha,Hb,Hc,Hd,He||1,Hf);else if(this.mHaveKey){var Hi=HK.getInstance().shapeDic[this.mId];Hi.setMatrix(this._curMat),Hi.rebuild(Hh.tempArray),Hh.setGeomtry(Hi)}else{var Hj=Hh.polygon(Ha,Hb,Hc,Hd,He||1,Hf);HK.getInstance().addShape(this.mId,Hj),Hj.setMatrix(this._curMat)}Hh.update();var Hk,Hl=[this.mX,this.mY];if((Hk=Hfa.createShape(this,Hh.ib,Hh.vb,Hh.count,Hh.offset,Hya.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,Hk.shaderValue.u_pos=Hl,Hk.shaderValue.u_mmat2=Hsa.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=Hk,0<He){if(this.mHaveLineKey){var Hm=HK.getInstance().shapeLineDic[this.mId];Hm.rebuild(Hh.tempArray),Hh.setGeomtry(Hm)}else HK.getInstance().addShape(this.mId,Hh.drawLine(Ha,Hb,Hc,He,Hf));Hh.update(),(Hk=Hfa.createShape(this,Hh.ib,Hh.vb,Hh.count,Hh.offset,Hya.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,Hk.shaderValue.u_mmat2=Hsa.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=Hk}},Hb.drawParticle=function(Ha,Hb,Hc){Hc.x=Ha,Hc.y=Hb,this._submits[this._submits._length++]=Hc},Hb._getPath=function(){return this._path||(this._path=new HS)},Hd(0,Hb,"globalCompositeOperation",function(){return HQ.NAMES[this._nBlendType]},function(Ha){var Hb=HQ.TOINT[Ha];null==Hb||this._nBlendType===Hb||(HT.save(this,65536,this,!0),this._curSubmit=Hfa.RENDERBASE,this._renderKey=0,this._nBlendType=Hb)}),Hd(0,Hb,"strokeStyle",function(){return this._shader2D.strokeStyle},function(Ha){this._shader2D.strokeStyle.equal(Ha)||(HT.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=HR.create(Ha))}),Hd(0,Hb,"globalAlpha",function(){return this._shader2D.ALPHA},function(Ha){(Ha=Math.floor(1e3*Ha)/1e3)!=this._shader2D.ALPHA&&(HT.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=Ha)}),Hd(0,Hb,"asBitmap",null,function(Ha){if(Ha){if(this._targets||(this._targets=new HZ),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),Hd(0,Hb,"fillStyle",function(){return this._shader2D.fillStyle},function(Ha){this._shader2D.fillStyle.equal(Ha)||(HT.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=HR.create(Ha))}),Hd(0,Hb,"textAlign",function(){return this._other.textAlign},function(Ha){this._other.textAlign===Ha||(this._other=this._other.make(),HT.save(this,32768,this._other,!1),this._other.textAlign=Ha)}),Hd(0,Hb,"lineWidth",function(){return this._other.lineWidth},function(Ha){this._other.lineWidth===Ha||(this._other=this._other.make(),HT.save(this,256,this._other,!1),this._other.lineWidth=Ha)}),Hd(0,Hb,"textBaseline",function(){return this._other.textBaseline},function(Ha){this._other.textBaseline===Ha||(this._other=this._other.make(),HT.save(this,16384,this._other,!1),this._other.textBaseline=Ha)}),Hd(0,Hb,"font",null,function(Ha){Ha!=this._other.font.toString()&&(this._other=this._other.make(),HT.save(this,8,this._other,!1),this._other.font===Hoa.EMPTY?this._other.font=new Hoa(Ha):this._other.font.setFont(Ha))}),HN.__init__=function(){Hc.DEFAULT=new Hc},HN._tempPoint=new HA,HN._SUBMITVBSIZE=32e3,HN._MAXSIZE=99999999,HN._RECTVBSIZE=16,HN.MAXCLIPRECT=new HB(0,0,99999999,99999999),HN._COUNT=0,HN._tmpMatrix=new Hz,HN.SEGNUM=32,HN._contextcount=0,Hg(HN,["_fontTemp",function(){return this._fontTemp=new Hoa},"_drawStyleTemp",function(){return this._drawStyleTemp=new HR(null)}]),HN.__init$=function(){Hc=function(){function Ha(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=Hoa.EMPTY}Hm(Ha,"");var Hb=Ha.prototype;return Hb.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=Hoa.EMPTY},Hb.make=function(){return this===Ha.DEFAULT?new Ha:this},Ha.DEFAULT=null,Ha}()},HN}(),Hya=function(Ha){function Hd(Ha,Hb){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,Hd.__super.call(this),this.defines=new HCa,this.position=Hd._POSITION,this.mainID=Ha,this.subID=Hb,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=Ha|Hb,this._inClassCache=Hd._cache[this._cacheID],0<Ha&&!this._inClassCache&&(this._inClassCache=Hd._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}Hm(Hd,"laya.webgl.shader.d2.value.Value2D",HM);var Hb=Hd.prototype;return Hb.setValue=function(Ha){},Hb.refresh=function(){var Ha=this.size;return Ha[0]=Hsa.width,Ha[1]=Hsa.height,this.alpha=this.ALPHA*Hsa.worldAlpha,this.mmat=Hsa.worldMatrix4,this},Hb._ShaderWithCompile=function(){return HWa.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,HZa.create)},Hb._withWorldShaderDefines=function(){var Ha=Hsa.worldShaderDefines,Hb=HWa.sharders[this.mainID|this.defines._value|Ha.getValue()];if(!Hb){var Hc,Hd={};for(Hc in this.defines.toNameDic())Hd[Hc]="";for(Hc in Ha.toNameDic())Hd[Hc]="";Hb=HWa.withCompile2D(0,this.mainID,Hd,this.mainID|this.defines._value|Ha.getValue(),HZa.create)}var He=Hsa.worldFilters;if(!He)return Hb;for(var Hf,Hg=He.length,Hh=0;Hh<Hg;Hh++)(Hf=He[Hh])&&Hf.action.setValue(this);return Hb},Hb.upload=function(){var Ha=Hsa;this.alpha=this.ALPHA*Ha.worldAlpha,Hsa.worldMatrix4!==Hsa.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),Hua.shaderHighPrecision&&this.defines.add(1024);var Hb,Hc=Ha.worldShaderDefines?this._withWorldShaderDefines():HWa.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=Ha.width,this.size[1]=Ha.height,this.mmat=Ha.worldMatrix4,HJa.activeShader!==Hc?Hc._shaderValueWidth!==Ha.width||Hc._shaderValueHeight!==Ha.height?(Hc._shaderValueWidth=Ha.width,Hc._shaderValueHeight=Ha.height):Hb=Hc._params2dQuick2||Hc._make2dQuick2():Hc._shaderValueWidth!==Ha.width||Hc._shaderValueHeight!==Ha.height?(Hc._shaderValueWidth=Ha.width,Hc._shaderValueHeight=Ha.height):Hb=Hc._params2dQuick1||Hc._make2dQuick1(),Hc.upload(this,Hb)},Hb.setFilters=function(Ha){if(this.filters=Ha)for(var Hb,Hc=Ha.length,Hd=0;Hd<Hc;Hd++)(Hb=Ha[Hd])&&(this.defines.add(Hb.type),Hb.action.setValue(this))},Hb.clear=function(){this.defines.setValue(this.subID)},Hb.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},Hd._initone=function(Ha,Hb){Hd._typeClass[Ha]=Hb,Hd._cache[Ha]=[],Hd._cache[Ha]._length=0},Hd.__init__=function(){Hd._POSITION=[2,5126,!1,4*Hpa.BYTES_PE,0],Hd._TEXCOORD=[2,5126,!1,4*Hpa.BYTES_PE,2*Hpa.BYTES_PE],Hd._initone(2,HNa),Hd._initone(4,HQa),Hd._initone(256,HOa),Hd._initone(512,HMa),Hd._initone(1,HPa),Hd._initone(65,HYa),Hd._initone(9,HPa)},Hd.create=function(Ha,Hb){var Hc=Hd._cache[Ha|Hb];return Hc._length?Hc[--Hc._length]:new Hd._typeClass[Ha|Hb](Hb)},Hd._POSITION=null,Hd._TEXCOORD=null,Hd._cache=[],Hd._typeClass=[],Hd.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Hd}(),Hza=function(Ha){function Hq(Ha,Hb){Hq.__super.call(this,Ha,Hb)}Hm(Hq,"laya.webgl.utils.RenderSprite3D",Hs);var Hb=Hq.prototype;return Hb.onCreate=function(Ha){switch(Ha){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},Hb._mask=function(Ha,Hb,Hc,Hd){var He,Hf,Hg=this._next,Hh=Ha.mask;if(Hh){Hb.ctx.save();var Hi=Hb.ctx.globalCompositeOperation,Hj=new HB;if(Hj.copyFrom(Hh.getBounds()),Hj.width=Math.round(Hj.width),Hj.height=Math.round(Hj.height),Hj.x=Math.round(Hj.x),Hj.y=Math.round(Hj.y),0<Hj.width&&0<Hj.height){var Hk=Ha._style._tf,Hl=Hha.create();Hl.addValue("bounds",Hj),He=Hga.create([Hl,Hb],laya.webgl.utils.RenderSprite3D.tmpTarget),Hb.addRenderObject(He),Hh.render(Hb,-Hj.x,-Hj.y),He=Hga.create([Hl],laya.webgl.utils.RenderSprite3D.endTmpTarget),Hb.addRenderObject(He),Hb.ctx.save(),Hb.clipRect(Hc-Hk.translateX+Hj.x,Hd-Hk.translateY+Hj.y,Hj.width,Hj.height),Hg._fun.call(Hg,Ha,Hb,Hc,Hd),Hb.ctx.restore(),Hf=Hka.create(6),Hi=Hb.ctx.globalCompositeOperation,Hf.blendMode="mask",Hb.addRenderObject(Hf),Hz.TEMP.identity();var Hm=Hya.create(1,0),Hn=HI.INV_UV,Ho=Hj.width,Hp=Hj.height;(Hj.width<32||Hj.height<32)&&((Hn=Hq.tempUV)[0]=0,Hn[1]=0,Hn[2]=32<=Hj.width?1:Hj.width/32,Hn[3]=0,Hn[4]=32<=Hj.width?1:Hj.width/32,Hn[5]=32<=Hj.height?1:Hj.height/32,Hn[6]=0,Hn[7]=32<=Hj.height?1:Hj.height/32,Hj.width=32<=Hj.width?Hj.width:32,Hj.height=32<=Hj.height?Hj.height:32,Hn[1]*=-1,Hn[3]*=-1,Hn[5]*=-1,Hn[7]*=-1,Hn[1]+=1,Hn[3]+=1,Hn[5]+=1,Hn[7]+=1),Hb.ctx.drawTarget(Hl,Hc+Hj.x-Hk.translateX,Hd+Hj.y-Hk.translateY,Ho,Hp,Hz.TEMP,"tmpTarget",Hm,Hn,6),He=Hga.create([Hl],laya.webgl.utils.RenderSprite3D.recycleTarget),Hb.addRenderObject(He),(Hf=Hka.create(6)).blendMode=Hi,Hb.addRenderObject(Hf)}Hb.ctx.restore()}else Hg._fun.call(Hg,Ha,Hb,Hc,Hd)},Hb._blend=function(Ha,Hb,Hc,Hd){var He=Ha._style,Hf=this._next;He.blendMode?(Hb.ctx.save(),Hb.ctx.globalCompositeOperation=He.blendMode,Hf._fun.call(Hf,Ha,Hb,Hc,Hd),Hb.ctx.restore()):Hf._fun.call(Hf,Ha,Hb,Hc,Hd)},Hb._transform=function(Ha,Hb,Hc,Hd){var He=Ha.transform,Hf=this._next;if(He&&Hf!=Hs.NORENDER){var Hg=Hb.ctx;Ha._style;He.tx=Hc,He.ty=Hd;var Hh=Hg._getTransformMatrix(),Hi=Hh.clone();Hz.mul(He,Hh,Hh),Hh._checkTransform(),He.tx=He.ty=0,Hf._fun.call(Hf,Ha,Hb,0,0),Hi.copyTo(Hh),Hi.destroy()}else Hf._fun.call(Hf,Ha,Hb,Hc,Hd)},Hq.tmpTarget=function(Ha,Hb){var Hc=Ha.getValue("bounds"),Hd=HKa.create(Hc.width,Hc.height);Hd.start(),Hd.clear(0,0,0,0),Ha.addValue("tmpTarget",Hd)},Hq.endTmpTarget=function(Ha){Ha.getValue("tmpTarget").end()},Hq.recycleTarget=function(Ha){Ha.getValue("tmpTarget").recycle(),Ha.recycle()},Hg(Hq,["tempUV",function(){return this.tempUV=new Array(8)}]),Hq}(),HAa=function(Ha){function Hb(){this.data=null,Hb.__super.call(this)}Hm(Hb,"laya.filters.webgl.ColorFilterActionGL",HL);var Hc=Hb.prototype;return Hw.imps(Hc,{"laya.filters.IFilterActionGL":!0}),Hc.setValue=function(Ha){Ha.colorMat=this.data._mat,Ha.colorAlpha=this.data._alpha},Hc.apply3d=function(Ha,Hb,Hc,Hd,He){var Hf=Ha.getValue("bounds"),Hg=Hya.create(1,0);Hg.setFilters([this.data]);var Hh=Hz.TEMP;Hh.identity(),Hc.ctx.drawTarget(Ha,0,0,Hf.width,Hf.height,Hh,"src",Hg)},Hb}(),HBa=function(Ha){function Hf(Ha,Hb,Hc,Hd,He){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,Hf.__super.call(this,Ha,Hb,He),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new HRa,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=Hc,this._atlasCanvas.height=Hd,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}Hm(Hf,"laya.webgl.atlas.Atlaser",HN);var Hb=Hf.prototype;return Hb.computeUVinAtlasTexture=function(Ha,Hb,Hc,Hd){var He=HO.atlasTextureWidth,Hf=HO.atlasTextureHeight,Hg=Hc/He,Hh=Hd/Hf,Hi=(Hc+Ha.bitmap.width)/He,Hj=(Hd+Ha.bitmap.height)/Hf,Hk=Ha.bitmap.width/He,Hl=Ha.bitmap.height/Hf;Ha.uv=[Hg+Hb[0]*Hk,Hh+Hb[1]*Hl,Hi-(1-Hb[2])*Hk,Hh+Hb[3]*Hl,Hi-(1-Hb[4])*Hk,Hj-(1-Hb[5])*Hl,Hg+Hb[6]*Hk,Hj-(1-Hb[7])*Hl]},Hb.findBitmapIsExist=function(Ha){if(Ha instanceof laya.webgl.resource.WebGLImage){var Hb=Ha,Hc=Hb.url,Hd=this._InAtlasWebGLImagesKey[Hc||Hb.id];if(Hd)return Hd.offsetInfoID}return-1},Hb.addToAtlasTexture=function(Ha,Hb,Hc){if(Ha instanceof laya.webgl.resource.WebGLImage){var Hd=Ha,He=Hd.url;this._InAtlasWebGLImagesKey[He||Hd.id]={bitmap:Ha,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([Hb,Hc])}this._atlasCanvas.texSubImage2D(Hb,Hc,Ha.atlasSource),Ha.clearAtlasSource()},Hb.addToAtlas=function(Ha,Hb,Hc){Ha._atlasID=this._inAtlasTextureKey.length;var Hd=Ha.uv.slice(),He=Ha.bitmap;this._inAtlasTextureKey.push(Ha),this._inAtlasTextureOriUVValue.push(Hd),this._inAtlasTextureBitmapValue.push(He),this.computeUVinAtlasTexture(Ha,Hd,Hb,Hc),Ha.bitmap=this._atlasCanvas},Hb.clear=function(){for(var Ha=0,Hb=this._inAtlasTextureKey.length;Ha<Hb;Ha++)this._inAtlasTextureKey[Ha].bitmap=this._inAtlasTextureBitmapValue[Ha],this._inAtlasTextureKey[Ha].uv=this._inAtlasTextureOriUVValue[Ha],this._inAtlasTextureKey[Ha]._atlasID=-1,this._inAtlasTextureKey[Ha].bitmap.lock=!1,this._inAtlasTextureKey[Ha].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},Hb.dispose=function(){this.clear(),this._atlasCanvas.destroy()},Hd(0,Hb,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),Hd(0,Hb,"texture",function(){return this._atlasCanvas}),Hd(0,Hb,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),Hf}(),HCa=function(Ha){function Hc(){Hc.__super.call(this,Hc.__name2int,Hc.__int2name,Hc.__int2nameMap)}return Hm(Hc,"laya.webgl.shader.d2.ShaderDefines2D",H_),Hc.__init__=function(){Hc.reg("TEXTURE2D",1),Hc.reg("COLOR2D",2),Hc.reg("PRIMITIVE",4),Hc.reg("GLOW_FILTER",8),Hc.reg("BLUR_FILTER",16),Hc.reg("COLOR_FILTER",32),Hc.reg("COLOR_ADD",64),Hc.reg("WORLDMAT",128),Hc.reg("FILLTEXTURE",256),Hc.reg("FSHIGHPRECISION",1024),Hc.reg("TXTALPHA",2048),Hc.reg("TXTCOMPRESS",4096)},Hc.reg=function(Ha,Hb){H_._reg(Ha,Hb,Hc.__name2int,Hc.__int2name)},Hc.toText=function(Ha,Hb,Hc){return H_._toText(Ha,Hb,Hc)},Hc.toInt=function(Ha){return H_._toInt(Ha,Hc.__name2int)},Hc.TEXTURE2D=1,Hc.COLOR2D=2,Hc.PRIMITIVE=4,Hc.FILTERGLOW=8,Hc.FILTERBLUR=16,Hc.FILTERCOLOR=32,Hc.COLORADD=64,Hc.WORLDMAT=128,Hc.FILLTEXTURE=256,Hc.SKINMESH=512,Hc.SHADERDEFINE_FSHIGHPRECISION=1024,Hc.TXTALPHA=2048,Hc.TXTCOMPRESS=4096,Hc.__name2int={},Hc.__int2name=[],Hc.__int2nameMap=[],Hc}(),HDa=(function(Ha){function Hh(Ha,Hb,Hc,Hd,He,Hf,Hg){Hh.__super.call(this,Ha,Hb,Hc,Hd,40,He,Hf,Hg)}Hm(Hh,"laya.webgl.shapes.Ellipse",Hca)}(),function(Ha){function Hf(Ha,Hb,Hc,Hd,He){this._points=[],this.rebuild(Hc),Hf.__super.call(this,Ha,Hb,0,0,0,He,Hd,He,0)}Hm(Hf,"laya.webgl.shapes.Line",Hca);var Hb=Hf.prototype;return Hb.rebuild=function(Ha){var Hb=Ha.length;Hb!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(Hb/2-1)),this.mFloat32Array=new Float32Array(5*Hb)),this._points.length=0;for(var Hc=NaN,Hd=NaN,He=-1,Hf=-1,Hg=Ha.length/2,Hh=0;Hh<Hg;Hh++)Hc=Ha[2*Hh],Hd=Ha[2*Hh+1],(.01<Math.abs(He-Hc)||.01<Math.abs(Hf-Hd))&&this._points.push(Hc,Hd),He=Hc,Hf=Hd},Hb.getData=function(Ha,Hb,Hc){var Hd=[],He=[];0<this.borderWidth&&this.createLine2(this._points,Hd,this.borderWidth,Hc,He,this._points.length/2),this.mUint16Array.set(Hd,0),this.mFloat32Array.set(He,0),Ha.append(this.mUint16Array),Hb.append(this.mFloat32Array)},Hf}()),HEa=function(Ha){function Hl(Ha,Hb,Hc,Hd,He){this._points=[];for(var Hf=NaN,Hg=NaN,Hh=-1,Hi=-1,Hj=Hc.length/2-1,Hk=0;Hk<Hj;Hk++)Hf=Hc[2*Hk],Hg=Hc[2*Hk+1],(.01<Math.abs(Hh-Hf)||.01<Math.abs(Hi-Hg))&&this._points.push(Hf,Hg),Hh=Hf,Hi=Hg;Hf=Hc[2*Hj],Hg=Hc[2*Hj+1],Hh=this._points[0],Hi=this._points[1],(.01<Math.abs(Hh-Hf)||.01<Math.abs(Hi-Hg))&&this._points.push(Hf,Hg),Hl.__super.call(this,Ha,Hb,0,0,this._points.length/2,0,Hd,He)}Hm(Hl,"laya.webgl.shapes.LoopLine",Hca);var Hb=Hl.prototype;return Hb.getData=function(Ha,Hb,Hc){if(0<this.borderWidth){for(var Hd=this.color,He=(Hd>>16&255)/255,Hf=(Hd>>8&255)/255,Hg=(255&Hd)/255,Hh=[],Hi=0,Hj=0,Hk=[],Hl=Math.floor(this._points.length/2),Hm=0;Hm<Hl;Hm++)Hi=this._points[2*Hm],Hj=this._points[2*Hm+1],Hh.push(this.x+Hi,this.y+Hj,He,Hf,Hg);this.createLoopLine(Hh,Hk,this.borderWidth,Hc+Hh.length/5),Ha.append(new Uint16Array(Hk)),Hb.append(new Float32Array(Hh))}},Hb.createLoopLine=function(Ha,Hb,Hc,Hd,He,Hf){Ha.length;var Hg=Ha.concat(),Hh=He||Ha,Hi=this.borderColor,Hj=(Hi>>16&255)/255,Hk=(Hi>>8&255)/255,Hl=(255&Hi)/255,Hm=[Hg[0],Hg[1]],Hn=[Hg[Hg.length-5],Hg[Hg.length-4]],Ho=Hn[0]+.5*(Hm[0]-Hn[0]),Hp=Hn[1]+.5*(Hm[1]-Hn[1]);Hg.unshift(Ho,Hp,0,0,0),Hg.push(Ho,Hp,0,0,0);var Hq,Hr,Hs,Ht,Hu,Hv,Hw,Hx,Hy,Hz,HA,HB,HC,HD,HE,HF,HG,HH,HI,HJ,HK=Hg.length/5,HL=Hd,HM=Hc/2;Hs=Hg[0],Ht=Hg[1],Hz=Hs-(Hu=Hg[5]),Hy=(Hy=-(Ht-(Hv=Hg[6])))/(HJ=Math.sqrt(Hy*Hy+Hz*Hz))*HM,Hz=Hz/HJ*HM,Hh.push(Hs-Hy,Ht-Hz,Hj,Hk,Hl,Hs+Hy,Ht+Hz,Hj,Hk,Hl);for(var HN=1;HN<HK-1;HN++)Hs=Hg[5*(HN-1)],Ht=Hg[5*(HN-1)+1],Hu=Hg[5*HN],Hv=Hg[5*HN+1],Hw=Hg[5*(HN+1)],Hx=Hg[5*(HN+1)+1],Hz=Hs-Hu,HB=Hu-Hw,HE=(-(Hy=(Hy=-(Ht-Hv))/(HJ=Math.sqrt(Hy*Hy+Hz*Hz))*HM)+Hs)*(-(Hz=Hz/HJ*HM)+Hv)-(-Hy+Hu)*(-Hz+Ht),HH=(-(HA=(HA=-(Hv-Hx))/(HJ=Math.sqrt(HA*HA+HB*HB))*HM)+Hw)*(-(HB=HB/HJ*HM)+Hv)-(-HA+Hu)*(-HB+Hx),HI=(HC=-Hz+Ht-(-Hz+Hv))*(HG=-HA+Hu-(-HA+Hw))-(HF=-HB+Hx-(-HB+Hv))*(HD=-Hy+Hu-(-Hy+Hs)),Math.abs(HI)<.1?(HI+=10.1,Hh.push(Hu-Hy,Hv-Hz,Hj,Hk,Hl,Hu+Hy,Hv+Hz,Hj,Hk,Hl)):(((Hq=(HD*HH-HG*HE)/HI)-Hu)*(Hq-Hu)+((Hr=(HF*HE-HC*HH)/HI)-Hv)+(Hr-Hv),Hh.push(Hq,Hr,Hj,Hk,Hl,Hu-(Hq-Hu),Hv-(Hr-Hv),Hj,Hk,Hl));Hf&&(Hb=Hf);var HO=this.edges+1;for(HN=1;HN<HO;HN++)Hb.push(HL+2*(HN-1),HL+2*(HN-1)+1,HL+2*HN+1,HL+2*HN+1,HL+2*HN,HL+2*(HN-1));return Hb.push(HL+2*(HN-1),HL+2*(HN-1)+1,HL+1,HL+1,HL,HL+2*(HN-1)),Hh},Hl}(),HFa=function(Hg){function Hh(Ha,Hb,Hc,Hd,He,Hf){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=Hg.create(),this._points=Hc.slice(0,Hc.length),Hh.__super.call(this,Ha,Hb,0,0,this._points.length/2,Hd,He,Hf)}Hm(Hh,"laya.webgl.shapes.Polygon",Hg);var Ha=Hh.prototype;return Ha.rebuild=function(Ha){this._repaint||(this._points.length=0,this._points=this._points.concat(Ha))},Ha.setMatrix=function(Ha){Ha.copyTo(this._mat)},Ha.needUpdate=function(Ha){return this._repaint=this._mat.a==Ha.a&&this._mat.b==Ha.b&&this._mat.c==Ha.c&&this._mat.d==Ha.d&&this._mat.tx==Ha.tx&&this._mat.ty==Ha.ty,!this._repaint},Ha.getData=function(Ha,Hb,Hc){var Hd,He=0,Hf=this._points,Hg=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=Hc){for(this._start=Hc,Hd=[],Hg=this.earcutTriangles.length,He=0;He<Hg;He++)Hd.push(this.earcutTriangles[He]+Hc);this.mUint16Array=new Uint16Array(Hd)}}else{this._start=Hc,Hd=[];var Hh=[],Hi=[],Hj=this.color,Hk=(Hj>>16&255)/255,Hl=(Hj>>8&255)/255,Hm=(255&Hj)/255;for(Hg=Math.floor(Hf.length/2),He=0;He<Hg;He++)Hh.push(this.x+Hf[2*He],this.y+Hf[2*He+1],Hk,Hl,Hm),Hi.push(this.x+Hf[2*He],this.y+Hf[2*He+1]);for(this.earcutTriangles=Hda.earcut(Hi,null,2),Hg=this.earcutTriangles.length,He=0;He<Hg;He++)Hd.push(this.earcutTriangles[He]+Hc);this.mUint16Array=new Uint16Array(Hd),this.mFloat32Array=new Float32Array(Hh)}Ha.append(this.mUint16Array),Hb.append(this.mFloat32Array)},Hh}(Hca),HGa=function(Ha){function Hf(){this._matrix=new Hz,this._matrix4=Hpa.defaultMatrix4.concat(),Hf.__super.call(this,1e4),this.shaderValue=new Hya(0,0)}Hm(Hf,"laya.webgl.submit.SubmitCanvas",Hfa);var Hb=Hf.prototype;return Hb.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var Ha=Hsa.worldAlpha,Hb=Hsa.worldMatrix4,Hc=Hsa.worldMatrix,Hd=Hsa.worldFilters,He=Hsa.worldShaderDefines,Hf=this.shaderValue,Hg=this._matrix,Hh=this._matrix4,Hi=Hz.TEMP;return Hz.mul(Hg,Hc,Hi),Hh[0]=Hi.a,Hh[1]=Hi.b,Hh[4]=Hi.c,Hh[5]=Hi.d,Hh[12]=Hi.tx,Hh[13]=Hi.ty,Hsa.worldMatrix=Hi.clone(),Hsa.worldMatrix4=Hh,Hsa.worldAlpha=Hsa.worldAlpha*Hf.alpha,Hf.filters&&Hf.filters.length&&(Hsa.worldFilters=Hf.filters,Hsa.worldShaderDefines=Hf.defines),this._ctx_src.flush(),Hsa.worldAlpha=Ha,Hsa.worldMatrix4=Hb,Hsa.worldMatrix.destroy(),Hsa.worldMatrix=Hc,Hsa.worldFilters=Hd,Hsa.worldShaderDefines=He,1},Hb.releaseRender=function(){var Ha=Hf._cache;this._ctx_src=null,Ha[Ha._length++]=this},Hb.getRenderType=function(){return 10003},Hf.create=function(Ha,Hb,Hc){var Hd=Hf._cache._length?Hf._cache[--Hf._cache._length]:new Hf;Hd._ctx_src=Ha;var He=Hd.shaderValue;return He.alpha=Hb,He.defines.setValue(0),Hc&&Hc.length&&He.setFilters(Hc),Hd},Hf._cache=((Hf._cache=[])._length=0,Hf._cache),Hf}(),HHa=function(Ha){function Hj(Ha){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===Ha&&(Ha=1e4),Hj.__super.call(this,Ha)}Hm(Hj,"laya.webgl.submit.SubmitTexture",Hfa);var Hb=Hj.prototype;return Hb.releaseRender=function(){var Ha=Hj._cache;(Ha[Ha._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},Hb.addTexture=function(Ha,Hb){this._texsID[this._texs.length]=Ha._uvID,this._texs.push(Ha),this._vbPos.push(Hb)},Hb.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var Ha=this.shaderValue.textureHost.bitmap;if(null!==Ha)for(var Hb=this._vb.getFloat32Array(),Hc=0,Hd=this._texs.length;Hc<Hd;Hc++){var He=this._texs[Hc];He.active();var Hf=He.uv;if(this._texsID[Hc]!==He._uvID){this._texsID[Hc]=He._uvID;var Hg=this._vbPos[Hc];Hb[Hg+2]=Hf[0],Hb[Hg+3]=Hf[1],Hb[Hg+6]=Hf[2],Hb[Hg+7]=Hf[3],Hb[Hg+10]=Hf[4],Hb[Hg+11]=Hf[5],Hb[Hg+14]=Hf[6],Hb[Hg+15]=Hf[7],this._vb.setNeedUpload()}He.bitmap!==Ha&&(this._isSameTexture=!1)}}},Hb.renderSubmit=function(){if(0===this._numEle)return Hj._shaderSet=!1,1;var Ha=this.shaderValue.textureHost;if(Ha){var Hb=Ha.source;if(!Ha.bitmap||!Hb)return Hj._shaderSet=!1,1;this.shaderValue.texture=Hb,Ha.alphaTexture&&Ha.alphaTexture.source&&(this.shaderValue.texture1=Ha.alphaTexture.source)}this._vb.bind_upload(this._ib);var Hc=Hua.mainContext;if(HQ.activeBlendFunction!==this._blendFn&&(Hc.enable(3042),this._blendFn(Hc),HQ.activeBlendFunction=this._blendFn),HE.drawCall++,HE.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&HJa.activeShader&&Hj._shaderSet?(HJa.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&HJa.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),Hj._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var Hd=Ha.bitmap,He=0,Hf=HJa.activeShader,Hg=0,Hh=this._texs.length;Hg<Hh;Hg++){var Hi=this._texs[Hg];Hi.bitmap===Hd&&Hg+1!==Hh||(Hf.uploadTexture2D(Hi.source),Hc.drawElements(4,6*(Hg-He+1),5123,this._startIdx+6*He*Hpa.BYTES_PIDX),Hd=Hi.bitmap,He=Hg)}else Hc.drawElements(4,this._numEle,5123,this._startIdx);return 1},Hj.create=function(Ha,Hb,Hc,Hd,He){var Hf=Hj._cache._length?Hj._cache[--Hj._cache._length]:new Hj;null==Hc&&((Hc=Hf._selfVb||(Hf._selfVb=H_a.create(-1))).clear(),Hd=0),Hf._ib=Hb,Hf._vb=Hc,Hf._startIdx=Hd*Hpa.BYTES_PIDX,Hf._numEle=0;var Hg=Ha._nBlendType;Hf._blendFn=Ha._targets?HQ.targetFns[Hg]:HQ.fns[Hg],Hf.shaderValue=He,Hf.shaderValue.setValue(Ha._shader2D);var Hh=Ha._shader2D.filters;return Hh&&Hf.shaderValue.setFilters(Hh),Hf},Hj._cache=((Hj._cache=[])._length=0,Hj._cache),Hj._shaderSet=!0,Hj}(),HIa=function(Ha){function Hr(){Hr.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}Hm(Hr,"laya.webgl.utils.MeshTexture",Hra);var Hb=Hr.prototype;return Hb.addData=function(Ha,Hb,Hc,Hd,He,Hf){for(var Hg=Ha.length/2,Hh=this._vb.needSize(Hg*Hr.const_stride)>>2,Hi=this._vb.getFloat32Array(),Hj=0,Hk=0;Hk<Hg;Hk++){var Hl=Ha[Hj],Hm=Ha[Hj+1],Hn=Hl*Hd.a+Hm*Hd.c+Hd.tx,Ho=Hl*Hd.b+Hm*Hd.d+Hd.ty;Hi[Hh++]=Hn,Hi[Hh++]=Ho,Hi[Hh++]=Hb[Hj],Hi[Hh++]=Hb[Hj+1],Hj+=2}this._vb.setNeedUpload();var Hp=this.vertNum;if(0<Hp){(Hg=Hc.length)>Hr.tmpIdx.length&&(Hr.tmpIdx=new Uint16Array(Hg));for(var Hq=0;Hq<Hg;Hq++)Hr.tmpIdx[Hq]=Hc[Hq]+Hp;this._ib.appendU16Array(Hr.tmpIdx,Hc.length)}else this._ib.append(Hc);this._ib.setNeedUpload(),this.vertNum+=Hg,this.indexNum+=Hc.length},Hb.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},Hb.destroy=function(){this._ib.destroy(),this._vb.destroy()},Hr.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new Hr},Hr.const_stride=16,Hr._POOL=[],Hg(Hr,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),Hr}(),HJa=function(Ha){function Hb(){Hb.__super.call(this),this.lock=!0}return Hm(Hb,"laya.webgl.shader.BaseShader",Ht),Hb.activeShader=null,Hb.bindShader=null,Hb}(),HKa=function(Hb){function Hk(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===Hc&&(Hc=6408),void 0===Hd&&(Hd=5121),void 0===He&&(He=34041),void 0===Hf&&(Hf=!1),void 0===Hg&&(Hg=!1),void 0===Hh&&(Hh=-1),void 0===Hi&&(Hi=-1),this._type=1,this._w=Ha,this._h=Hb,this._surfaceFormat=Hc,this._surfaceType=Hd,this._depthStencilFormat=He,Hr.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=Hf,this._repeat=Hg,this._minFifter=Hh,this._magFifter=Hi,this._createWebGLRenderTarget(),this.bitmap.lock=!0,Hk.__super.call(this,this.bitmap,HI.INV_UV)}Hm(Hk,"laya.webgl.resource.RenderTarget2D",Hb);var Ha=Hk.prototype;return Hw.imps(Ha,{"laya.resource.IDispose":!0}),Ha.getType=function(){return this._type},Ha.getTexture=function(){return this},Ha.size=function(Ha,Hb){this._w==Ha&&this._h==Hb||(this._w=Ha,this._h=Hb,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},Ha.release=function(){this.destroy()},Ha.recycle=function(){Hk.POOL.push(this)},Ha.start=function(){var Ha=Hua.mainContext;return this._preRenderTarget=Hsa.curRenderTarget,Hsa.curRenderTarget=this,Ha.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(Ha.viewport(0,0,this._w,this._h),this._svWidth=Hsa.width,this._svHeight=Hsa.height,Hsa.width=this._w,Hsa.height=this._h,HJa.activeShader=null),this},Ha.clear=function(Ha,Hb,Hc,Hd){void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=1);var He=Hua.mainContext;He.clearColor(Ha,Hb,Hc,Hd);var Hf=16384;switch(this._depthStencilFormat){case 33189:Hf|=256;break;case 36168:Hf|=1024;break;case 34041:Hf|=256,Hf|=1024}He.clear(Hf)},Ha.end=function(){var Ha=Hua.mainContext;Ha.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,Hsa.curRenderTarget=this._preRenderTarget,1==this._type?(Ha.viewport(0,0,this._svWidth,this._svHeight),Hsa.width=this._svWidth,Hsa.height=this._svHeight,HJa.activeShader=null):Ha.viewport(0,0,Hw.stage.width,Hw.stage.height)},Ha.getData=function(Ha,Hb,Hc,Hd){var He=Hua.mainContext;if(He.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===He.checkFramebufferStatus(36160)))return He.bindFramebuffer(36160,null),null;var Hf=new Uint8Array(this._w*this._h*4);return He.readPixels(Ha,Hb,Hc,Hd,this._surfaceFormat,this._surfaceType,Hf),He.bindFramebuffer(36160,null),Hf},Ha.destroy=function(Ha){void 0===Ha&&(Ha=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,Hb.prototype.destroy.call(this))},Ha.dispose=function(){},Ha._createWebGLRenderTarget=function(){this.bitmap=new HUa(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(Ha){this.event("recovered")})},Hd(0,Ha,"surfaceFormat",function(){return this._surfaceFormat}),Hd(0,Ha,"magFifter",function(){return this._magFifter}),Hd(0,Ha,"surfaceType",function(){return this._surfaceType}),Hd(0,Ha,"mipMap",function(){return this._mipMap}),Hd(0,Ha,"depthStencilFormat",function(){return this._depthStencilFormat}),Hd(0,Ha,"minFifter",function(){return this._minFifter}),Hd(0,Ha,"source",function(){return this._alreadyResolved?Hw.superGet(HI,this,"source"):null}),Hk.create=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){void 0===Hc&&(Hc=6408),void 0===Hd&&(Hd=5121),void 0===He&&(He=34041),void 0===Hf&&(Hf=!1),void 0===Hg&&(Hg=!1),void 0===Hh&&(Hh=-1),void 0===Hi&&(Hi=-1);var Hj=Hk.POOL.pop();return Hj||(Hj=new Hk(Ha,Hb)),Hj.bitmap&&Hj._w==Ha&&Hj._h==Hb&&Hj._surfaceFormat==Hc&&Hj._surfaceType==Hd&&Hj._depthStencilFormat==He&&Hj._mipMap==Hf&&Hj._repeat==Hg&&Hj._minFifter==Hh&&Hj._magFifter==Hi||(Hj._w=Ha,Hj._h=Hb,Hj._surfaceFormat=Hc,Hj._surfaceType=Hd,Hj._depthStencilFormat=He,Hr.isConchWebGL&&34041===Hj._depthStencilFormat&&(Hj._depthStencilFormat=33189),Hj._mipMap=Hf,Hj._repeat=Hg,Hj._minFifter=Hh,Hj._magFifter=Hi,Hj.release(),Hj._createWebGLRenderTarget()),Hj},Hk.TYPE2D=1,Hk.TYPE3D=2,Hk.POOL=[],Hk}(HI),HLa=function(Ha){function Hb(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,Hb.__super.call(this),Hb._gl=Hua.mainContext}Hm(Hb,"laya.webgl.utils.Buffer",Ht);var Hc=Hb.prototype;return Hc._bind=function(){this.activeResource(),Hb._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(Hb._bindVertexBuffer=this._glBuffer),Hb._gl.bindBuffer(this._bufferType,Hb._bindActive[this._bufferType]=this._glBuffer),HJa.activeShader=null)},Hc.recreateResource=function(){this._glBuffer||(this._glBuffer=Hb._gl.createBuffer()),this.completeCreate()},Hc.disposeResource=function(){this._glBuffer&&(Hua.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},Hd(0,Hc,"bufferUsage",function(){return this._bufferUsage}),Hb._gl=null,Hb._bindActive={},Hb._bindVertexBuffer=null,Hb._enableAtributes=[],Hb}(),HMa=function(Ha){function Hc(Ha){this.texcoord=null,this.offsetX=300,this.offsetY=0,Hc.__super.call(this,512,0);var Hb=8*Hpa.BYTES_PE;this.position=[2,5126,!1,Hb,0],this.texcoord=[2,5126,!1,Hb,2*Hpa.BYTES_PE],this.color=[4,5126,!1,Hb,4*Hpa.BYTES_PE]}return Hm(Hc,"laya.webgl.shader.d2.skinAnishader.SkinSV",Hya),Hc}(),HNa=function(Ha){function Hb(Ha){Hb.__super.call(this,2,0),this.color=[]}return Hm(Hb,"laya.webgl.shader.d2.value.Color2dSV",Hya),Hb.prototype.setValue=function(Ha){Ha.fillStyle&&(this.color=Ha.fillStyle._color._color),Ha.strokeStyle&&(this.color=Ha.strokeStyle._color._color)},Hb}(),HOa=function(Ha){function Hb(Ha){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=Hya._TEXCOORD,Hb.__super.call(this,256,0)}Hm(Hb,"laya.webgl.shader.d2.value.FillTextureSV",Hya);var Hc=Hb.prototype;return Hc.setValue=function(Ha){this.ALPHA=Ha.ALPHA,Ha.filters&&this.setFilters(Ha.filters)},Hc.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},Hb}(),HPa=function(Ha){function Hb(Ha){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=Hya._TEXCOORD,void 0===Ha&&(Ha=0),Hb.__super.call(this,1,Ha)}Hm(Hb,"laya.webgl.shader.d2.value.TextureSV",Hya);var Hc=Hb.prototype;return Hc.setValue=function(Ha){this.ALPHA=Ha.ALPHA,Ha.filters&&this.setFilters(Ha.filters)},Hc.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},Hb}(),HQa=function(Ha){function Hb(Ha){this.a_color=null,this.u_pos=[0,0],Hb.__super.call(this,4,0),this.position=[2,5126,!1,5*Hpa.BYTES_PE,0],this.a_color=[3,5126,!1,5*Hpa.BYTES_PE,2*Hpa.BYTES_PE]}return Hm(Hb,"laya.webgl.shader.d2.value.PrimitiveSV",Hya),Hb}(),HRa=function(Ha){function Hb(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,Hb.__super.call(this)}Hm(Hb,"laya.webgl.atlas.AtlasWebGLCanvas",Ha);var Hc=Hb.prototype;return Hc.recreateResource=function(){var Ha=Hua.mainContext,Hb=this._source=Ha.createTexture(),Hc=Hva.curBindTexTarget,Hd=Hva.curBindTexValue;Hva.bindTexture(Ha,3553,Hb),Ha.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),Ha.texParameteri(3553,10241,9729),Ha.texParameteri(3553,10240,9729),Ha.texParameteri(3553,10242,33071),Ha.texParameteri(3553,10243,33071),Hc&&Hd&&Hva.bindTexture(Ha,Hc,Hd),this.memorySize=this._w*this._h*4,this.completeCreate()},Hc.disposeResource=function(){this._source&&(Hua.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Hc.texSubImage2D=function(Ha,Hb,Hc){if(Hr.isFlash){this._flashCacheImage||(this._flashCacheImage=Hp.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var Hd=Hc.bitmapdata;this._flashCacheImage._image.copyPixels(Hd,0,0,Hd.width,Hd.height,Ha,Hb),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var He=Hua.mainContext,Hf=Hva.curBindTexTarget,Hg=Hva.curBindTexValue;Hva.bindTexture(He,3553,this._source),He.pixelStorei(37441,!0),0<=Ha-1&&He.texSubImage2D(3553,0,Ha-1,Hb,6408,5121,Hc),Ha+1<=this._w&&He.texSubImage2D(3553,0,Ha+1,Hb,6408,5121,Hc),0<=Hb-1&&He.texSubImage2D(3553,0,Ha,Hb-1,6408,5121,Hc),Hb+1<=this._h&&He.texSubImage2D(3553,0,Ha,Hb+1,6408,5121,Hc),He.texSubImage2D(3553,0,Ha,Hb,6408,5121,Hc),He.pixelStorei(37441,!1),Hf&&Hg&&Hva.bindTexture(He,Hf,Hg)}},Hc.texSubImage2DPixel=function(Ha,Hb,Hc,Hd,He){var Hf=Hua.mainContext,Hg=Hva.curBindTexTarget,Hh=Hva.curBindTexValue;Hva.bindTexture(Hf,3553,this._source);var Hi=new Uint8Array(He.data);Hf.pixelStorei(37441,!0),Hf.texSubImage2D(3553,0,Ha,Hb,Hc,Hd,6408,5121,Hi),Hf.pixelStorei(37441,!1),Hg&&Hh&&Hva.bindTexture(Hf,Hg,Hh)},Hd(0,Hc,"width",Ha.prototype._$get_width,function(Ha){this._w=Ha}),Hd(0,Hc,"height",Ha.prototype._$get_height,function(Ha){this._h=Ha}),Hb}(Hc),HSa=function(Ha){function He(){this.flipY=!0,this.alwaysChange=!1,He.__super.call(this)}Hm(He,"laya.webgl.resource.WebGLCanvas",Hc);var Hb=He.prototype;return Hb.getCanvas=function(){return this._canvas},Hb.clear=function(){this._ctx&&this._ctx.clear()},Hb.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},Hb._setContext=function(Ha){this._ctx=Ha},Hb.getContext=function(Ha,Hb){return this._ctx?this._ctx:this._ctx=He._createContext(this)},Hb.size=function(Ha,Hb){this._w==Ha&&this._h==Hb||(this._w=Ha,this._h=Hb,this._ctx&&this._ctx.size(Ha,Hb),this._canvas&&(this._canvas.height=Hb,this._canvas.width=Ha))},Hb.activeResource=function(Ha){void 0===Ha&&(Ha=!1),this._source||this.recreateResource()},Hb.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},Hb.disposeResource=function(){this._source&&!this.iscpuSource&&(Hua.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Hb.createWebGlTexture=function(){var Ha=Hua.mainContext;this._canvas;var Hb=this._source=Ha.createTexture();this.iscpuSource=!1;var Hc=Hva.curBindTexTarget,Hd=Hva.curBindTexValue;Hva.bindTexture(Ha,3553,Hb),Ha.pixelStorei(37440,this.flipY?1:0),He.premulAlpha&&Ha.pixelStorei(37441,!0),Ha.texImage2D(3553,0,6408,6408,5121,this._imgData),He.premulAlpha&&Ha.pixelStorei(37441,!1),Ha.texParameteri(3553,10240,9729),Ha.texParameteri(3553,10241,9729),Ha.texParameteri(3553,10242,33071),Ha.texParameteri(3553,10243,33071),Ha.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,Hc&&Hd&&Hva.bindTexture(Ha,Hc,Hd)},Hb.reloadCanvasData=function(){var Ha=Hua.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var Hb=Hva.curBindTexTarget,Hc=Hva.curBindTexValue;Hva.bindTexture(Ha,3553,this._source),He.premulAlpha&&Ha.pixelStorei(37441,!0),Ha.texImage2D(3553,0,6408,6408,5121,this._imgData),He.premulAlpha&&Ha.pixelStorei(37441,!1),Ha.pixelStorei(37440,0),Hb&&Hc&&Hva.bindTexture(Ha,Hb,Hc)},Hb.texSubImage2D=function(Ha,Hb,Hc){var Hd=Hua.mainContext,He=Hva.curBindTexTarget,Hf=Hva.curBindTexValue;Hva.bindTexture(Hd,3553,this._source),Hd.pixelStorei(37441,!0),Hd.texSubImage2D(3553,0,Hb,Hc,6408,5121,Ha._source),Hd.pixelStorei(37441,!1),He&&Hf&&Hva.bindTexture(Hd,He,Hf)},Hb.toBase64=function(Ha,Hb,Hc){var Hd=null;this._canvas&&(Hd=this._canvas.toDataURL(Ha,Hb)),Hc.call(this,Hd)},Hd(0,Hb,"context",function(){return this._ctx}),Hd(0,Hb,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),Hd(0,Hb,"asBitmap",null,function(Ha){this._ctx&&(this._ctx.asBitmap=Ha)}),He._createContext=null,He.premulAlpha=!1,He}(),HTa=function(Ha){function Hf(Ha,Hb){this.CborderSize=12,Hf.__super.call(this),this.char=Ha,this.isSpace=" "===Ha,this.xs=Hb.scaleX,this.ys=Hb.scaleY,this.font=Hb.font.toString(),this.fontSize=Hb.font.size,this.fillColor=Hb.fillColor,this.borderColor=Hb.borderColor,this.lineWidth=Hb.lineWidth,this.underLine=Hb.underLine;var Hc,Hd=Hr.isConchApp;Hd?((Hc=ConchTextCanvas)._source=ConchTextCanvas,Hc._source.canvas=ConchTextCanvas):Hc=Hn.canvas.source,this.canvas=Hc,this._enableMerageInAtlas=!0,this._ctx=Hd?Hc:this.canvas.getContext("2d",void 0);var He=HJ.measureText(this.char,this.font);this.cw=He.width*this.xs,this.ch=(He.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new HI(this)}Hm(Hf,"laya.webgl.resource.WebGLCharImage",Hc);var Hb=Hf.prototype;return Hw.imps(Hb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Hb.active=function(){this.texture.active()},Hb.recreateResource=function(){var Ha=Hr.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),Ha){var Hb=this.fontSize;1==this.xs&&1==this.ys||(Hb=parseInt(Hb*(this.xs>this.ys?this.xs:this.ys)+""));var Hc="normal 100 "+this.font;Hc=Hc.replace(Hf._fontSizeReg,Hb),this.borderColor&&(Hc+=" 1 "+this.borderColor),this._ctx.font=Hc,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,HH.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var Hd=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(Hd,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},Hb.onresize=function(Ha,Hb){this._w=Ha,this._h=Hb,this._allowMerageInAtlas=!0},Hb.clearAtlasSource=function(){},Hd(0,Hb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Hd(0,Hb,"atlasSource",function(){return this.canvas}),Hd(0,Hb,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(Ha){this._enableMerageInAtlas=Ha}),Hf.createOneChar=function(Ha,Hb){return new Hf(Ha,Hb)},Hf._fontSizeReg=new RegExp("\\d+(?=px)","g"),Hf}(),HUa=function(Ha){function Hj(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){void 0===Hc&&(Hc=6408),void 0===Hd&&(Hd=5121),void 0===He&&(He=34041),void 0===Hf&&(Hf=!1),void 0===Hg&&(Hg=!1),void 0===Hh&&(Hh=-1),void 0===Hi&&(Hi=1),Hj.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=Ha,this._h=Hb,this._surfaceFormat=Hc,this._surfaceType=Hd,this._depthStencilFormat=He,this._mipMap=Hf,this._repeat=Hg,this._minFifter=Hh,this._magFifter=Hi}Hm(Hj,"laya.webgl.resource.WebGLRenderTarget",Hc);var Hb=Hj.prototype;return Hb.recreateResource=function(){var Ha=Hua.mainContext;this._frameBuffer||(this._frameBuffer=Ha.createFramebuffer()),this._source||(this._source=Ha.createTexture());var Hb=Hva.curBindTexTarget,Hc=Hva.curBindTexValue;Hva.bindTexture(Ha,3553,this._source),Ha.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var Hd=this._minFifter,He=this._magFifter,Hf=this._repeat?10497:33071,Hg=Hk.isPOT(this._w,this._h);if(Hg?(this._mipMap?-1!==Hd||(Hd=9987):-1!==Hd||(Hd=9729),-1!==He||(He=9729),Ha.texParameteri(3553,10241,Hd),Ha.texParameteri(3553,10240,He),Ha.texParameteri(3553,10242,Hf),Ha.texParameteri(3553,10243,Hf),this._mipMap&&Ha.generateMipmap(3553)):(-1!==Hd||(Hd=9729),-1!==He||(He=9729),Ha.texParameteri(3553,10241,Hd),Ha.texParameteri(3553,10240,He),Ha.texParameteri(3553,10242,33071),Ha.texParameteri(3553,10243,33071)),Ha.bindFramebuffer(36160,this._frameBuffer),Ha.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=Ha.createRenderbuffer()),Ha.bindRenderbuffer(36161,this._depthStencilBuffer),Ha.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:Ha.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:Ha.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:Ha.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}Ha.bindFramebuffer(36160,null),Hb&&Hc&&Hva.bindTexture(Ha,Hb,Hc),Ha.bindRenderbuffer(36161,null),Hg&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},Hb.disposeResource=function(){this._frameBuffer&&(Hua.mainContext.deleteTexture(this._source),Hua.mainContext.deleteFramebuffer(this._frameBuffer),Hua.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},Hd(0,Hb,"depthStencilBuffer",function(){return this._depthStencilBuffer}),Hd(0,Hb,"frameBuffer",function(){return this._frameBuffer}),Hj}(),HVa=function(Ha){function Hh(Ha,Hb,Hc,Hd,He,Hf,Hg){this.offsetX=0,this.offsetY=0,Hh.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=Hf,this.canvas=Ha,this._ctx=Ha.getContext("2d",void 0),this._w=Hd,this._h=He,this.offsetX=Hb,this.offsetY=Hc,this.src=Hg,this._enableMerageInAtlas=!0,HO.enabled&&this._w<HO.atlasLimitWidth&&this._h<HO.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}Hm(Hh,"laya.webgl.resource.WebGLSubImage",Hc);var Hb=Hh.prototype;return Hw.imps(Hb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Hb.size=function(Ha,Hb){this._w=Ha,this._h=Hb,this._ctx&&this._ctx.size(Ha,Hb),this.canvas&&(this.canvas.height=Hb,this.canvas.width=Ha)},Hb.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},Hb.createWebGlTexture=function(){var Ha=Hua.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var Hb=this._source=Ha.createTexture(),Hc=Hva.curBindTexTarget,Hd=Hva.curBindTexValue;Hva.bindTexture(Ha,3553,Hb),Ha.pixelStorei(37441,!0),Ha.texImage2D(3553,0,6408,6408,5121,this.canvas),Ha.pixelStorei(37441,!1);var He=this.minFifter,Hf=this.magFifter,Hg=this.repeat?10497:33071,Hh=Hk.isPOT(this.width,this.height);Hh?(this.mipmap?-1!==He||(He=9987):-1!==He||(He=9729),-1!==Hf||(Hf=9729),Ha.texParameteri(3553,10240,Hf),Ha.texParameteri(3553,10241,He),Ha.texParameteri(3553,10242,Hg),Ha.texParameteri(3553,10243,Hg),this.mipmap&&Ha.generateMipmap(3553)):(-1!==He||(He=9729),-1!==Hf||(Hf=9729),Ha.texParameteri(3553,10241,He),Ha.texParameteri(3553,10240,Hf),Ha.texParameteri(3553,10242,33071),Ha.texParameteri(3553,10243,33071)),Hc&&Hd&&Hva.bindTexture(Ha,Hc,Hd),this.canvas=null,Hh&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},Hb.disposeResource=function(){HO.enabled&&this._allowMerageInAtlas||!this._source||(Hua.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Hb.clearAtlasSource=function(){},Hd(0,Hb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Hd(0,Hb,"atlasSource",function(){return this.canvas}),Hd(0,Hb,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(Ha){this._allowMerageInAtlas=Ha}),Hh}(),HWa=function(Ha){function Hj(Ha,Hb,Hc,Hd){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,Hj.__super.call(this),!Ha||!Hb)throw"Shader Error";this._id=++Hj._count,this._vs=Ha,this._ps=Hb,this._nameMap=Hd||{},null!=Hc&&(Hj.sharders[Hc]=this)}Hm(Hj,"laya.webgl.shader.Shader",HJa);var Hb=Hj.prototype;return Hb.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},Hb.disposeResource=function(){Hua.mainContext.deleteShader(this._vshader),Hua.mainContext.deleteShader(this._pshader),Hua.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},Hb._compile=function(){if(!Hua.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var Ha=[this._vs,this._ps],Hb=Hua.mainContext;if(this._program=Hb.createProgram(),this._vshader=Hj._createShader(Hb,Ha[0],35633),this._pshader=Hj._createShader(Hb,Ha[1],35632),Hb.attachShader(this._program,this._vshader),Hb.attachShader(this._program,this._pshader),Hb.linkProgram(this._program),!Hr.isConchApp&&!Hb.getProgramParameter(this._program,35714))throw Hb.getProgramInfoLog(this._program);var Hc,Hd,He=0,Hf=0;for(Hf=Hr.isConchApp?Hb.getProgramParameterEx(this._vs,this._ps,"",35721):Hb.getProgramParameter(this._program,35721),He=0;He<Hf;He++){var Hg=null;Hc={vartype:"attribute",glfun:null,ivartype:0,attrib:Hg=Hr.isConchApp?Hb.getActiveAttribEx(this._vs,this._ps,"",He):Hb.getActiveAttrib(this._program,He),location:Hb.getAttribLocation(this._program,Hg.name),name:Hg.name,type:Hg.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(Hc)}var Hh=0;for(Hh=Hr.isConchApp?Hb.getProgramParameterEx(this._vs,this._ps,"",35718):Hb.getProgramParameter(this._program,35718),He=0;He<Hh;He++){var Hi=null;Hi=Hr.isConchApp?Hb.getActiveUniformEx(this._vs,this._ps,"",He):Hb.getActiveUniform(this._program,He),0<(Hc={vartype:"uniform",glfun:null,ivartype:1,attrib:Hg,location:Hb.getUniformLocation(this._program,Hi.name),name:Hi.name,type:Hi.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(Hc.name=Hc.name.substr(0,Hc.name.length-3),Hc.isArray=!0,Hc.location=Hb.getUniformLocation(this._program,Hc.name)),this._params.push(Hc)}for(He=0,Hd=this._params.length;He<Hd;He++)if((Hc=this._params[He]).indexOfParams=He,Hc.index=1,Hc.value=[Hc.location,null],Hc.codename=Hc.name,Hc.name=this._nameMap[Hc.codename]?this._nameMap[Hc.codename]:Hc.codename,(this._paramsMap[Hc.name]=Hc)._this=this,Hc.uploadedValue=[],"attribute"!==Hc.vartype)switch(Hc.type){case 5124:Hc.fun=Hc.isArray?this._uniform1iv:this._uniform1i;break;case 5126:Hc.fun=Hc.isArray?this._uniform1fv:this._uniform1f;break;case 35664:Hc.fun=Hc.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:Hc.fun=Hc.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:Hc.fun=Hc.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:Hc.fun=this._uniform_sampler2D;break;case 35680:Hc.fun=this._uniform_samplerCube;break;case 35676:Hc.glfun=Hb.uniformMatrix4fv,Hc.fun=this._uniformMatrix4fv;break;case 35670:Hc.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else Hc.fun=this._attribute}},Hb.getUniform=function(Ha){return this._paramsMap[Ha]},Hb._attribute=function(Ha,Hb){var Hc=Hua.mainContext,Hd=HLa._enableAtributes,He=Ha.location;return Hd[He]||Hc.enableVertexAttribArray(He),Hc.vertexAttribPointer(He,Hb[0],Hb[1],Hb[2],Hb[3],Hb[4]+this._offset),Hd[He]=HLa._bindVertexBuffer,1},Hb._uniform1f=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb?(Hua.mainContext.uniform1f(Ha.location,Hc[0]=Hb),1):0},Hb._uniform1fv=function(Ha,Hb){if(Hb.length<4){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]||Hc[2]!==Hb[2]||Hc[3]!==Hb[3]?(Hua.mainContext.uniform1fv(Ha.location,Hb),Hc[0]=Hb[0],Hc[1]=Hb[1],Hc[2]=Hb[2],Hc[3]=Hb[3],1):0}return Hua.mainContext.uniform1fv(Ha.location,Hb),1},Hb._uniform_vec2=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]?(Hua.mainContext.uniform2f(Ha.location,Hc[0]=Hb[0],Hc[1]=Hb[1]),1):0},Hb._uniform_vec2v=function(Ha,Hb){if(Hb.length<2){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]||Hc[2]!==Hb[2]||Hc[3]!==Hb[3]?(Hua.mainContext.uniform2fv(Ha.location,Hb),Hc[0]=Hb[0],Hc[1]=Hb[1],Hc[2]=Hb[2],Hc[3]=Hb[3],1):0}return Hua.mainContext.uniform2fv(Ha.location,Hb),1},Hb._uniform_vec3=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]||Hc[2]!==Hb[2]?(Hua.mainContext.uniform3f(Ha.location,Hc[0]=Hb[0],Hc[1]=Hb[1],Hc[2]=Hb[2]),1):0},Hb._uniform_vec3v=function(Ha,Hb){return Hua.mainContext.uniform3fv(Ha.location,Hb),1},Hb._uniform_vec4=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]||Hc[2]!==Hb[2]||Hc[3]!==Hb[3]?(Hua.mainContext.uniform4f(Ha.location,Hc[0]=Hb[0],Hc[1]=Hb[1],Hc[2]=Hb[2],Hc[3]=Hb[3]),1):0},Hb._uniform_vec4v=function(Ha,Hb){return Hua.mainContext.uniform4fv(Ha.location,Hb),1},Hb._uniformMatrix2fv=function(Ha,Hb){return Hua.mainContext.uniformMatrix2fv(Ha.location,!1,Hb),1},Hb._uniformMatrix3fv=function(Ha,Hb){return Hua.mainContext.uniformMatrix3fv(Ha.location,!1,Hb),1},Hb._uniformMatrix4fv=function(Ha,Hb){return Hua.mainContext.uniformMatrix4fv(Ha.location,!1,Hb),1},Hb._uniform1i=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb?(Hua.mainContext.uniform1i(Ha.location,Hc[0]=Hb),1):0},Hb._uniform1iv=function(Ha,Hb){return Hua.mainContext.uniform1iv(Ha.location,Hb),1},Hb._uniform_ivec2=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]?(Hua.mainContext.uniform2i(Ha.location,Hc[0]=Hb[0],Hc[1]=Hb[1]),1):0},Hb._uniform_ivec2v=function(Ha,Hb){return Hua.mainContext.uniform2iv(Ha.location,Hb),1},Hb._uniform_vec3i=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]||Hc[2]!==Hb[2]?(Hua.mainContext.uniform3i(Ha.location,Hc[0]=Hb[0],Hc[1]=Hb[1],Hc[2]=Hb[2]),1):0},Hb._uniform_vec3vi=function(Ha,Hb){return Hua.mainContext.uniform3iv(Ha.location,Hb),1},Hb._uniform_vec4i=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]||Hc[2]!==Hb[2]||Hc[3]!==Hb[3]?(Hua.mainContext.uniform4i(Ha.location,Hc[0]=Hb[0],Hc[1]=Hb[1],Hc[2]=Hb[2],Hc[3]=Hb[3]),1):0},Hb._uniform_vec4vi=function(Ha,Hb){return Hua.mainContext.uniform4iv(Ha.location,Hb),1},Hb._uniform_sampler2D=function(Ha,Hb){var Hc=Hua.mainContext,Hd=Ha.uploadedValue;return null==Hd[0]?(Hd[0]=this._curActTexIndex,Hc.uniform1i(Ha.location,this._curActTexIndex),Hc.activeTexture(Hj._TEXTURES[this._curActTexIndex]),Hva.bindTexture(Hc,3553,Hb),this._curActTexIndex++,1):(Hc.activeTexture(Hj._TEXTURES[Hd[0]]),Hva.bindTexture(Hc,3553,Hb),0)},Hb._uniform_samplerCube=function(Ha,Hb){var Hc=Hua.mainContext,Hd=Ha.uploadedValue;return null==Hd[0]?(Hd[0]=this._curActTexIndex,Hc.uniform1i(Ha.location,this._curActTexIndex),Hc.activeTexture(Hj._TEXTURES[this._curActTexIndex]),Hva.bindTexture(Hc,34067,Hb),this._curActTexIndex++,1):(Hc.activeTexture(Hj._TEXTURES[Hd[0]]),Hva.bindTexture(Hc,34067,Hb),0)},Hb._noSetValue=function(Ha){console.log("no....:"+Ha.name)},Hb.uploadOne=function(Ha,Hb){this.activeResource(),Hva.UseProgram(this._program);var Hc=this._paramsMap[Ha];Hc.fun.call(this,Hc,Hb)},Hb.uploadTexture2D=function(Ha){HE.shaderCall++;var Hb=Hua.mainContext;Hb.activeTexture(33984),Hva.bindTexture(Hb,3553,Ha)},Hb.uploadTexture2D1=function(Ha){HE.shaderCall++;var Hb=Hua.mainContext;Hb.activeTexture(33985),Hva.bindTexture(Hb,3553,Ha)},Hb.upload=function(Ha,Hb){HJa.activeShader=HJa.bindShader=this,this._lastUseFrameCount===HE.loopCount||this.activeResource(),Hva.UseProgram(this._program),this._reCompile?(Hb=this._params,this._reCompile=!1):Hb=Hb||this._params;Hua.mainContext;for(var Hc,Hd,He=Hb.length,Hf=0,Hg=0;Hg<He;Hg++)null!==(Hd=Ha[(Hc=Hb[Hg]).name])&&(Hf+=Hc.fun.call(this,Hc,Hd));HE.shaderCall+=Hf},Hb.uploadArray=function(Ha,Hb,Hc){HJa.activeShader=this,(HJa.bindShader=this).activeResource(),Hva.UseProgram(this._program);this._params;for(var Hd,He,Hf=0,Hg=Hb-2;0<=Hg;Hg-=2)(He=this._paramsMap[Ha[Hg]])&&null!=(Hd=Ha[Hg+1])&&(Hc&&Hc[He.name]&&Hc[He.name].bind(),Hf+=He.fun.call(this,He,Hd));HE.shaderCall+=Hf},Hb.getParams=function(){return this._params},Hj.getShader=function(Ha){return Hj.sharders[Ha]},Hj.create=function(Ha,Hb,Hc,Hd){return new Hj(Ha,Hb,Hc,Hd)},Hj.withCompile=function(Ha,Hb,Hc,Hd){if(Hc&&Hj.sharders[Hc])return Hj.sharders[Hc];var He=Hj._preCompileShader[2e-4*Ha];if(!He)throw new Error("withCompile shader err!"+Ha);return He.createShader(Hb,Hc,Hd)},Hj.withCompile2D=function(Ha,Hb,Hc,Hd,He){if(Hd&&Hj.sharders[Hd])return Hj.sharders[Hd];var Hf=Hj._preCompileShader[2e-4*Ha+Hb];if(!Hf)throw new Error("withCompile shader err!"+Ha+" "+Hb);return Hf.createShader(Hc,Hd,He)},Hj.addInclude=function(Ha,Hb){Hta.addInclude(Ha,Hb)},Hj.preCompile=function(Ha,Hb,Hc,Hd){var He=2e-4*Ha;Hj._preCompileShader[He]=new Hta(He,Hb,Hc,Hd)},Hj.preCompile2D=function(Ha,Hb,Hc,Hd,He){var Hf=2e-4*Ha+Hb;Hj._preCompileShader[Hf]=new Hta(Hf,Hc,Hd,He)},Hj._createShader=function(Ha,Hb,Hc){var Hd=Ha.createShader(Hc);return Ha.shaderSource(Hd,Hb),Ha.compileShader(Hd),Hd},Hj._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],Hj._count=0,Hj._preCompileShader={},Hj.SHADERNAME2ID=2e-4,Hj.sharders=((Hj.sharders=[]).length=32,Hj.sharders),Hg(Hj,["nameKey",function(){return this.nameKey=new HF}]),Hj}(),HXa=function(Ha){function Hb(){this._maxsize=0,this._upload=!0,this._uploadSize=0,Hb.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}Hm(Hb,"laya.webgl.utils.Buffer2D",Ha);var Hc=Hb.prototype;return Hc.needSize=function(Ha){var Hb=this._byteLength;if(Ha){var Hc=this._byteLength+Ha;Hc<=this._buffer.byteLength||this._resizeBuffer(Hc<<1,!0),this._byteLength=Hc}return Hb},Hc._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),HE.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,HLa._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),HLa._gl.bufferSubData(this._bufferType,0,this._buffer)},Hc._bufferSubData=function(Ha,Hb,Hc){if(void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),this._maxsize=Math.max(this._maxsize,this._byteLength),HE.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,HLa._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),Hb||Hc){var Hd=this._buffer.slice(Hb,Hc);HLa._gl.bufferSubData(this._bufferType,Ha,Hd)}else HLa._gl.bufferSubData(this._bufferType,Ha,this._buffer)},Hc._checkArrayUse=function(){},Hc._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},Hc._bind_subUpload=function(Ha,Hb,Hc){return void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(Ha,Hb,Hc),!0)},Hc._resizeBuffer=function(Ha,Hb){if(Ha<this._buffer.byteLength)return this;if(this.memorySize=Ha,Hb&&this._buffer&&0<this._buffer.byteLength){var Hc=new ArrayBuffer(Ha);new Uint8Array(Hc).set(new Uint8Array(this._buffer),0),this._buffer=Hc}else this._buffer=new ArrayBuffer(Ha);return this._checkArrayUse(),this._upload=!0,this},Hc.append=function(Ha){this._upload=!0;var Hb,Hc;Hb=Ha.byteLength,Ha instanceof Uint8Array?(this._resizeBuffer(this._byteLength+Hb,!0),Hc=new Uint8Array(this._buffer,this._byteLength)):Ha instanceof Uint16Array?(this._resizeBuffer(this._byteLength+Hb,!0),Hc=new Uint16Array(this._buffer,this._byteLength)):Ha instanceof Float32Array&&(this._resizeBuffer(this._byteLength+Hb,!0),Hc=new Float32Array(this._buffer,this._byteLength)),Hc.set(Ha,0),this._byteLength+=Hb,this._checkArrayUse()},Hc.appendU16Array=function(Ha,Hb){this._resizeBuffer(this._byteLength+2*Hb,!0);for(var Hc=new Uint16Array(this._buffer,this._byteLength,Hb),Hd=0;Hd<Hb;Hd++)Hc[Hd]=Ha[Hd];this._byteLength+=2*Hb,this._checkArrayUse()},Hc.appendEx=function(Ha,Hb){this._upload=!0;var Hc;Hc=Ha.byteLength,this._resizeBuffer(this._byteLength+Hc,!0),new Hb(this._buffer,this._byteLength).set(Ha,0),this._byteLength+=Hc,this._checkArrayUse()},Hc.appendEx2=function(Ha,Hb,Hc,Hd){void 0===Hd&&(Hd=1),this._upload=!0;var He,Hf;He=Hc*Hd,this._resizeBuffer(this._byteLength+He,!0),Hf=new Hb(this._buffer,this._byteLength);var Hg=0;for(Hg=0;Hg<Hc;Hg++)Hf[Hg]=Ha[Hg];this._byteLength+=He,this._checkArrayUse()},Hc.getBuffer=function(){return this._buffer},Hc.setNeedUpload=function(){this._upload=!0},Hc.getNeedUpload=function(){return this._upload},Hc.upload=function(){var Ha=this._bind_upload();return HLa._gl.bindBuffer(this._bufferType,null),HLa._bindActive[this._bufferType]=null,HJa.activeShader=null,Ha},Hc.subUpload=function(Ha,Hb,Hc){void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0);var Hd=this._bind_subUpload();return HLa._gl.bindBuffer(this._bufferType,null),HLa._bindActive[this._bufferType]=null,HJa.activeShader=null,Hd},Hc.disposeResource=function(){Ha.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},Hc.clear=function(){this._byteLength=0,this._upload=!0},Hd(0,Hc,"bufferLength",function(){return this._buffer.byteLength}),Hd(0,Hc,"byteLength",null,function(Ha){this._byteLength!==Ha&&(Ha<=this._buffer.byteLength||this._resizeBuffer(2*Ha+256,!0),this._byteLength=Ha)}),Hb.__int__=function(Ha){H$a.QuadrangleIB=H$a.create(35044),Hqa.fillIBQuadrangle(H$a.QuadrangleIB,16)},Hb.FLOAT32=4,Hb.SHORT=2,Hb}(HLa),HYa=(function(Hb){function Hc(Ha){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,Hc.__super.call(this,9)}Hm(Hc,"laya.webgl.shader.d2.value.GlowSV",Hb);var Ha=Hc.prototype;Ha.setValue=function(Ha){Hb.prototype.setValue.call(this,Ha)},Ha.clear=function(){Hb.prototype.clear.call(this)}}(HPa),function(Ha){function Hb(Ha){Hb.__super.call(this,64),this.defines.add(64)}Hm(Hb,"laya.webgl.shader.d2.value.TextSV",Ha);var Hc=Hb.prototype;return Hc.release=function(){(Hb.pool[Hb._length++]=this).clear()},Hc.clear=function(){Ha.prototype.clear.call(this)},Hb.create=function(){return Hb._length?Hb.pool[--Hb._length]:new Hb(null)},Hb.pool=[],Hb._length=0,Hb}(HPa)),HZa=function(Ha){function He(Ha,Hb,Hc,Hd){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,He.__super.call(this,Ha,Hb,Hc,Hd)}Hm(He,"laya.webgl.shader.d2.Shader2X",Ha);var Hb=He.prototype;return Hb.upload2dQuick1=function(Ha){this.upload(Ha,this._params2dQuick1||this._make2dQuick1())},Hb._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var Ha,Hb=this._params,Hc=0,Hd=Hb.length;Hc<Hd;Hc++)Ha=Hb[Hc],(Hr.isFlash||"size"!==Ha.name&&"position"!==Ha.name&&"texcoord"!==Ha.name)&&this._params2dQuick1.push(Ha)}return this._params2dQuick1},Hb.disposeResource=function(){Ha.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},Hb.upload2dQuick2=function(Ha){this.upload(Ha,this._params2dQuick2||this._make2dQuick2())},Hb._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var Ha,Hb=this._params,Hc=0,Hd=Hb.length;Hc<Hd;Hc++)Ha=Hb[Hc],(Hr.isFlash||"size"!==Ha.name)&&this._params2dQuick2.push(Ha)}return this._params2dQuick2},He.create=function(Ha,Hb,Hc,Hd){return new He(Ha,Hb,Hc,Hd)},He}(HWa),H$a=function(Ha){function Hb(Ha){this._uint8Array=null,this._uint16Array=null,void 0===Ha&&(Ha=35044),Hb.__super.call(this),this._bufferUsage=Ha,this._bufferType=34963,Hr.isFlash||(this._buffer=new ArrayBuffer(8))}Hm(Hb,"laya.webgl.utils.IndexBuffer2D",HXa);var Hc=Hb.prototype;return Hc._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},Hc.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},Hc.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},Hc.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},Hb.QuadrangleIB=null,Hb.create=function(Ha){return void 0===Ha&&(Ha=35044),new Hb(Ha)},Hb}(),H_a=function(Ha){function Hc(Ha,Hb){this._floatArray32=null,this._vertexStride=0,Hc.__super.call(this),this._vertexStride=Ha,this._bufferUsage=Hb,this._bufferType=34962,Hr.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}Hm(Hc,"laya.webgl.utils.VertexBuffer2D",Ha);var Hb=Hc.prototype;return Hb.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},Hb.bind=function(Ha){Ha&&Ha._bind(),this._bind()},Hb.insertData=function(Ha,Hb){this.getFloat32Array().set(Ha,Hb),this._upload=!0},Hb.bind_upload=function(Ha){Ha._bind_upload()||Ha._bind(),this._bind_upload()||this._bind()},Hb._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},Hb.disposeResource=function(){Ha.prototype.disposeResource.call(this)},Hb.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},Hd(0,Hb,"vertexStride",function(){return this._vertexStride}),Hc.create=function(Ha,Hb){return void 0===Hb&&(Hb=35048),new Hc(Ha,Hb)},Hc}(HXa),Hab=function(Ha){function Hh(Ha,Hb,Hc,Hd,He,Hf){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===Hc&&(Hc=6408),void 0===Hd&&(Hd=!0),Hh.__super.call(this,Ha,Hb),Ha){if(this._format=Hc,this._mipmap=Hd,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof Ha)this._url=Ha,this._src=Ha,this._image=new Hn.window.Image,Hb&&(Hb.onload&&(this.onload=Hb.onload),Hb.onerror&&(this.onerror=Hb.onerror),Hb.onCreate&&Hb.onCreate(this)),this._image.crossOrigin=Ha&&0==Ha.indexOf("data:")?null:"",Ha&&(this._image.src=Ha);else if(Ha instanceof ArrayBuffer){this._src=Hb,this._url=this._src;var Hg=new Hi(Ha);Hg.readUTFBytes(4),Hg.readUTFBytes(2),Hg.getInt16();Hg.endian="bigEndian",this._w=Hg.getInt16(),this._h=Hg.getInt16();Hg.getInt16(),Hg.getInt16();this._image=new Uint8Array(Ha,Hg.pos),this._format=Hua.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,HO.enabled&&this._w<HO.atlasLimitWidth&&this._h<HO.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(Ha instanceof Uint8Array))return this._src=Hb,this._url=this._src,this._image=Ha.source||Ha,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=Hb,this._url=this._src,this._w=He,this._h=Hf,this._image=Ha,this._format=0===Hc?Ha.byteLength/(He*Hf)==4?6408:6407:Hc}this._$5__enableMerageInAtlas=!0}}Hm(Hh,"laya.webgl.resource.WebGLImage",Hp);var Hb=Hh.prototype;return Hw.imps(Hb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Hb._init_=function(Ha,Hb){},Hb._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var Ha=Hua.mainContext,Hb=this._source=Ha.createTexture(),Hc=Hva.curBindTexTarget,Hd=Hva.curBindTexValue;Hva.bindTexture(Ha,3553,Hb);var He=this.minFifter,Hf=this.magFifter,Hg=this.repeat?10497:33071,Hh=Hk.isPOT(this._w,this._h),Hi=!1;switch(Hh?(this.mipmap?-1!==He||(He=9987):-1!==He||(He=9729),-1!==Hf||(Hf=9729),Ha.texParameteri(3553,10241,He),Ha.texParameteri(3553,10240,Hf),Ha.texParameteri(3553,10242,Hg),Ha.texParameteri(3553,10243,Hg),this.mipmap&&Ha.generateMipmap(3553)):(-1!==He||(He=9729),-1!==Hf||(Hf=9729),Ha.texParameteri(3553,10241,He),Ha.texParameteri(3553,10240,Hf),Ha.texParameteri(3553,10242,33071),Ha.texParameteri(3553,10243,33071)),Ha.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&Ha.pixelStorei(Ha.UNPACK_ALIGNMENT,1),Ha.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&Ha.pixelStorei(Ha.UNPACK_ALIGNMENT,1),Ha.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:Hi=!0,Ha.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case Hua.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:Hi=!0,Ha.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}Ha.pixelStorei(37441,!1),Hc&&Hd&&Hva.bindTexture(Ha,Hc,Hd),this.uri||(this.uri=this._url),Hi?this.memorySize=this._image.length:Hh&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},Hb.recreateResource=function(){var Ha=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var Hb=this;this._image=new Hn.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(Hb._needReleaseAgain)return Hb._needReleaseAgain=!1,Hb._image.onload=null,void(Hb._image=null);Hb._allowMerageInAtlas&&Hb._enableMerageInAtlas?(Ha.memorySize=0,Ha._recreateLock=!1):Hb._createWebGlTexture(),Hb.completeCreate()},this._image.src=this._src}},Hb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&Hua.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},Hb.onresize=function(){this._w=this._image.width,this._h=this._image.height,HO.enabled&&this._w<HO.atlasLimitWidth&&this._h<HO.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},Hb.clearAtlasSource=function(){this._image=null},Hd(0,Hb,"format",function(){return this._format}),Hd(0,Hb,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(Ha){this._$5__enableMerageInAtlas=Ha}),Hd(0,Hb,"mipmap",function(){return this._mipmap}),Hd(0,Hb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Hd(0,Hb,"atlasSource",function(){return this._image}),Hd(0,Hb,"onload",null,function(Ha){var Hb=this;this._onload=Ha,this._image&&(this._image.onload=null!=this._onload?function(){Hb.onresize(),Hb._onload()}:null)}),Hd(0,Hb,"onerror",null,function(Ha){var Hb=this;this._onerror=Ha,this._image&&(this._image.onerror=null!=this._onerror?function(){Hb._onerror()}:null)}),Hh}();Hw.__init([Hna,HN,Hxa,Hta])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ha,Hb){"use strict";for(var Hc in Object.defineProperty(Hb,"__esModule",{value:!0}),Laya){var Hd=Laya[Hc];Hd&&Hd.__isclass&&(Hb[Hc]=Hd)}}),function(Hf,Ha,Hd){Hd.un,Hd.uns;var He=Hd.static,Hg=Hd.class,Hh=Hd.getset,Hi=(Hd.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),Ho=laya.utils.ClassUtils,Hl=(laya.events.Event,laya.utils.HTMLChar),Hj=laya.net.Loader,Hk=(laya.display.Node,laya.maths.Rectangle),Hm=laya.renders.Render,Hn=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),Hp=laya.utils.Stat,HJ=laya.display.Text,Hq=laya.resource.Texture,Hr=laya.net.URL,Hs=laya.utils.Utils,Ht=function(){function Hn(){}return Hg(Hn,"laya.html.utils.HTMLParse"),Hn.parse=function(Ha,Hb,Hc){Hb=(Hb="<root>"+(Hb=Hb.replace(/<br>/g,"<br/>"))+"</root>").replace(Hn.spacePattern,Hn.char255);var Hd=Hs.parseXMLFromString(Hb);Hn._parseXML(Ha,Hd.childNodes[0].childNodes,Hc)},Hn._parseXML=function(Ha,Hb,Hc,Hd){var He=0,Hf=0;if(Hb.join||Hb.item)for(He=0,Hf=Hb.length;He<Hf;++He)Hn._parseXML(Ha,Hb[He],Hc,Hd);else{var Hg,Hh,Hi;if(3==Hb.nodeType)return void(Ha instanceof laya.html.dom.HTMLDivElement?(null==Hb.nodeName&&(Hb.nodeName="#text"),Hh=Hb.nodeName.toLowerCase(),0<(Hi=Hb.textContent.replace(/^\s+|\s+$/g,"")).length&&(Hg=Ho.getInstance(Hh))&&(Ha.addChild(Hg),Hg.innerTEXT=Hi.replace(Hn.char255AndOneSpacePattern," "))):0<(Hi=Hb.textContent.replace(/^\s+|\s+$/g,"")).length&&(Ha.innerTEXT=Hi.replace(Hn.char255AndOneSpacePattern," ")));if("#comment"==(Hh=Hb.nodeName.toLowerCase()))return;if(Hg=Ho.getInstance(Hh)){(Hg=Ha.addChild(Hg)).URI=Hc,Hg.href=Hd;var Hj=Hb.attributes;if(Hj&&0<Hj.length)for(He=0,Hf=Hj.length;He<Hf;++He){var Hk=Hj[He],Hl=Hk.nodeName,Hm=Hk.value;Hg._setAttributes(Hl,Hm)}Hn._parseXML(Hg,Hb.childNodes,Hc,Hg.href)}else Hn._parseXML(Ha,Hb.childNodes,Hc,Hd)}},Hn.char255=String.fromCharCode(255),Hn.spacePattern=/&nbsp;|&#160;/g,Hn.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),Hn}(),Hu=function(){function HI(){}return Hg(HI,"laya.html.utils.Layout"),HI.later=function(Ha){null==HI._will&&(HI._will=[],Hd.stage.frameLoop(1,null,function(){if(!(HI._will.length<1)){for(var Ha=0;Ha<HI._will.length;Ha++)laya.html.utils.Layout.layout(HI._will[Ha]);HI._will.length=0}})),HI._will.push(Ha)},HI.layout=function(Ha){if(!Ha||!Ha._style)return null;if(0==(512&Ha._style._type))return null;Ha.getStyle()._type&=-513;var Hb=HI._multiLineLayout(Ha);return Hm.isConchApp&&Ha.layaoutCallNative&&Ha.layaoutCallNative(),Hb},HI._multiLineLayout=function(Ha){if(HJ.RightToLeft)return HI._multiLineLayout2(Ha);var Hb=new Array;Ha._addChildsToLayout(Hb);var Hc,Hd,He,Hf,Hg,Hh=0,Hi=Hb.length,Hj=Ha._getCSSStyle(),Hk=Hj.letterSpacing,Hl=Hj.leading,Hm=Hj.lineHeight,Hn=Hj._widthAuto()||!Hj.wordWrap,Ho=Hn?999999:Ha.width,Hp=(Ha.height,0),Hq=Hj.italic?Hj.fontSize/3:0,Hr=Hj._getAlign(),Hs=Hj._getValign(),Ht=0!==Hs||0!==Hr||0!=Hm,Hu=0,Hv=0,Hw=0,Hx=0,Hy=new Array,Hz=Hy[0]=new HK,HA=!1,HB=!1;Hz.h=0,Hj.italic&&(Ho-=Hj.fontSize/3);var HC=0,HD=!0;function HE(){Hz.y=Hv,Hv+=Hz.h+Hl,0==Hz.h&&(Hv+=Hm),Hz.mWidth=HC,HC=0,Hz=new HK,Hy.push(Hz),Hz.h=0,HA=!(HD=!(Hu=0))}for(Hh=0;Hh<Hi;Hh++)if(null!=(Hc=Hb[Hh]))if(HD=!1,Hc instanceof laya.html.dom.HTMLBrElement)HE(),Hz.y=Hv;else{if(Hc._isChar()){if((Hf=Hc).isWord)HA=HB||"\n"===Hf.char,Hz.wordStartIndex=Hz.elements.length;else{if(Hw=Hf.width+Hf.style.letterSpacin,0<Hy.length&&Ho<Hu+Hw&&0<Hz.wordStartIndex){var HF;HF=Hz.elements.length-Hz.wordStartIndex+1,Hz.elements.length=Hz.wordStartIndex,Hh-=HF,HE();continue}HA=!1,HC+=Hf.width}Hw=Hf.width+Hk,Hx=Hf.height,HB=!1,(HA=HA||Ho<Hu+Hw)&&HE(),Hz.minTextHeight=Math.min(Hz.minTextHeight,Hc.height)}else Hd=Hc._getCSSStyle(),Hg=Hc,He=Hd.padding,0===Hd._getCssFloat()||(Ht=!0),HA=HB||Hd.lineElement,Hw=Hg.width*Hg._style._tf.scaleX+He[1]+He[3]+Hk,Hx=Hg.height*Hg._style._tf.scaleY+He[0]+He[2],HB=Hd.lineElement,(HA=HA||Ho<Hu+Hw&&Hd.wordWrap)&&HE();Hz.elements.push(Hc),Hz.h=Math.max(Hz.h,Hx),Hc.x=Hu,Hc.y=Hv,Hu+=Hw,Hz.w=Hu-Hk,Hz.y=Hv,Hp=Math.max(Hu+Hq,Hp)}else HD||(Hu+=HI.DIV_ELEMENT_PADDING),Hz.wordStartIndex=Hz.elements.length;if(Hv=Hz.y+Hz.h,Ht){var HG=0,HH=Ho;for(Hn&&0<Ha.width&&(HH=Ha.width),Hh=0,Hi=Hy.length;Hh<Hi;Hh++)Hy[Hh].updatePos(0,HH,Hh,HG,Hr,Hs,Hm),HG+=Math.max(Hm,Hy[Hh].h+Hl);Hv=HG}return Hn&&(Ha.width=Hp),Hv>Ha.height&&(Ha.height=Hv),[Hp,Hv]},HI._multiLineLayout2=function(Ha){var Hb=new Array;Ha._addChildsToLayout(Hb);var Hc,Hd,He,Hf,Hg,Hh=0,Hi=Hb.length,Hj=Ha._getCSSStyle(),Hk=Hj.letterSpacing,Hl=Hj.leading,Hm=Hj.lineHeight,Hn=Hj._widthAuto()||!Hj.wordWrap,Ho=Hn?999999:Ha.width,Hp=(Ha.height,0),Hq=Hj.italic?Hj.fontSize/3:0,Hr=2-Hj._getAlign(),Hs=Hj._getValign(),Ht=0!==Hs||0!=Hr||0!=Hm,Hu=0,Hv=0,Hw=0,Hx=0,Hy=new Array,Hz=Hy[0]=new HK,HA=!1,HB=!1;Hz.h=0,Hj.italic&&(Ho-=Hj.fontSize/3);var HC=0,HD=!0;function HE(){Hz.y=Hv,Hv+=Hz.h+Hl,0==Hz.h&&(Hv+=Hm),Hz.mWidth=HC,HC=0,Hz=new HK,Hy.push(Hz),Hz.h=0,HA=!(HD=!(Hu=0))}for(Hh=0;Hh<Hi;Hh++)if(null!=(Hc=Hb[Hh]))if(HD=!1,Hc instanceof laya.html.dom.HTMLBrElement)HE(),Hz.y=Hv;else{if(Hc._isChar()){if((Hf=Hc).isWord)HA=HB||"\n"===Hf.char,Hz.wordStartIndex=Hz.elements.length;else{if(0<Hy.length&&Ho<Hu+Hw&&0<Hz.wordStartIndex){var HF;HF=Hz.elements.length-Hz.wordStartIndex+1,Hz.elements.length=Hz.wordStartIndex,Hh-=HF,HE();continue}HA=!1,HC+=Hf.width}Hw=Hf.width+Hk,Hx=Hf.height,HB=!1,(HA=HA||Ho<Hu+Hw)&&HE(),Hz.minTextHeight=Math.min(Hz.minTextHeight,Hc.height)}else Hd=Hc._getCSSStyle(),Hg=Hc,He=Hd.padding,0===Hd._getCssFloat()||(Ht=!0),HA=HB||Hd.lineElement,Hw=Hg.width*Hg._style._tf.scaleX+He[1]+He[3]+Hk,Hx=Hg.height*Hg._style._tf.scaleY+He[0]+He[2],HB=Hd.lineElement,(HA=HA||Ho<Hu+Hw&&Hd.wordWrap)&&HE();Hz.elements.push(Hc),Hz.h=Math.max(Hz.h,Hx),Hc.x=Hu,Hc.y=Hv,Hu+=Hw,Hz.w=Hu-Hk,Hz.y=Hv,Hp=Math.max(Hu+Hq,Hp)}else HD||(Hu+=HI.DIV_ELEMENT_PADDING),Hz.wordStartIndex=Hz.elements.length;if(Hv=Hz.y+Hz.h,Ht){var HG=0,HH=Ho;for(Hh=0,Hi=Hy.length;Hh<Hi;Hh++)Hy[Hh].updatePos(0,HH,Hh,HG,Hr,Hs,Hm),HG+=Math.max(Hm,Hy[Hh].h+Hl);Hv=HG}for(Hn&&(Ha.width=Hp),Hv>Ha.height&&(Ha.height=Hv),Hh=0,Hi=Hy.length;Hh<Hi;Hh++)Hy[Hh].revertOrder(Ho);return[Hp,Hv]},HI._will=null,HI.DIV_ELEMENT_PADDING=0,HI}(),HK=function(){function Ha(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}Hg(Ha,"laya.html.utils.LayoutLine");var Hb=Ha.prototype;return Hb.updatePos=function(Ha,Hb,Hc,Hd,He,Hf,Hg){var Hh,Hi=0;0<this.elements.length&&(Hi=(Hh=this.elements[this.elements.length-1]).x+Hh.width-this.elements[0].x);var Hj=0,Hk=NaN;1===He&&(Hj=(Hb-Hi)/2),2===He&&(Hj=Hb-Hi),0===Hg||0!=Hf||(Hf=1);for(var Hl=0,Hm=this.elements.length;Hl<Hm;Hl++){var Hn=(Hh=this.elements[Hl])._getCSSStyle();switch(0!==Hj&&(Hh.x+=Hj),Hn._getValign()){case 0:Hh.y=Hd;break;case 1:var Ho=0;99999!=this.minTextHeight&&(Ho=this.minTextHeight);var Hp=(Ho+Hg)/2;Hp=Math.max(Hp,this.h),Hk=(laya.html.dom.HTMLImageElement,Hd+Hp-Hh.height),Hh.y=Hk;break;case 2:Hh.y=Hd+(Hg-Hh.height)}}},Hb.revertOrder=function(Ha){var Hb;if(0<this.elements.length){var Hc,Hd=0;for(Hc=this.elements.length,Hd=0;Hd<Hc;Hd++)(Hb=this.elements[Hd]).x=Ha-Hb.x-Hb.width}},Ha}(),Hv=function(Hc){function Hb(){this.URI=null,this._href=null,Hb.__super.call(this),this._text=Hb._EMPTYTEXT,this.setStyle(new Hi(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}Hg(Hb,"laya.html.dom.HTMLElement",Hc);var Ha=Hb.prototype;return Ha.layaoutCallNative=function(){var Ha=0;if(this._childs&&0<(Ha=this._childs.length))for(var Hb=0;Hb<Ha;Hb++)this._childs[Hb].layaoutCallNative&&this._childs[Hb].layaoutCallNative();var Hc=this._getWords();Hc?laya.html.dom.HTMLElement.fillWords(this,Hc,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},Ha.appendChild=function(Ha){return this.addChild(Ha)},Ha._getWords2=function(){var Ha=this._text.text;if(!Ha||0===Ha.length)return null;var Hb,Hc,Hd=0,He=0;if(this._text.drawWords)Hc=this._text.drawWords;else{for(He=(Hb=Ha.split(" ")).length-1,Hc=[],Hd=0;Hd<He;Hd++)Hc.push(Hb[Hd]," ");0<=He&&Hc.push(Hb[He]),this._text.drawWords=Hc}var Hf,Hg=this._text.words;if(Hg&&Hg.length===Hc.length)return Hg;null===Hg&&(this._text.words=Hg=[]),Hg.length=Hc.length;var Hh=this.style,Hi=Hh.font;for(Hd=0,He=Hc.length;Hd<He;Hd++){Hf=Hs.measureText(Hc[Hd],Hi);var Hj=Hg[Hd]=new Hl(Hc[Hd],Hf.width,Hf.height||Hh.fontSize,Hh);if(1<Hj.char.length&&(Hj.charNum=Hj.char),this.href){var Hk=new Hn;this.addChild(Hk),Hj.setSprite(Hk)}}return Hg},Ha._getWords=function(){if(!HJ.CharacterCache)return this._getWords2();var Ha=this._text.text;if(!Ha||0===Ha.length)return null;var Hb,Hc=this._text.words;if(Hc&&Hc.length===Ha.length)return Hc;null===Hc&&(this._text.words=Hc=[]),Hc.length=Ha.length;for(var Hd=this.style,He=Hd.font,Hf=0,Hg=Ha.length;Hf<Hg;Hf++)if(Hb=Hs.measureText(Ha.charAt(Hf),He)){var Hh=Hc[Hf]=new Hl(Ha.charAt(Hf),Hb.width,Hb.height||Hd.fontSize,Hd);if(this.href){var Hi=new Hn;this.addChild(Hi),Hh.setSprite(Hi)}}else console.warn("_getWords size is null"+Ha.charAt(Hf),He);return Hc},Ha.showLinkSprite=function(){var Ha=this._text.words;if(Ha)for(var Hb,Hc,Hd=[],He=0;He<Ha.length;He++)Hc=Ha[He],(Hb=new Hn).graphics.drawRect(0,0,Hc.width,Hc.height,"#ff0000"),Hb.width=Hc.width,Hb.height=Hc.height,this.addChild(Hb),Hd.push(Hb)},Ha._layoutLater=function(){var Ha=this.style;512&Ha._type||(Ha.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&Ha.block?(Hu.later(this),Ha._type|=512):this.parent&&this.parent._layoutLater())},Ha._setAttributes=function(Ha,Hb){switch(Ha){case"style":return void this.style.cssText(Hb);case"class":return void(this.className=Hb)}Hc.prototype._setAttributes.call(this,Ha,Hb)},Ha.updateHref=function(){if(null!=this._href){var Ha=this._getWords();if(Ha)for(var Hb,Hc,Hd=0;Hd<Ha.length;Hd++)(Hc=(Hb=Ha[Hd]).getSprite())&&(Hc.size(Hb.width,Hb.height),Hc.on("click",this,this.onLinkHandler))}},Ha.onLinkHandler=function(Ha){switch(Ha.type){case"click":for(var Hb=this;Hb;)Hb.event("link",[this.href]),Hb=Hb.parent}},Ha.formatURL=function(Ha){return this.URI?Hr.formatURL(Ha,this.URI?this.URI.path:null):Ha},Hh(0,Ha,"href",function(){return this._href},function(Ha){null!=(this._href=Ha)&&(this._getCSSStyle().underLine=1,this.updateHref())}),Hh(0,Ha,"color",null,function(Ha){this.style.color=Ha}),Hh(0,Ha,"onClick",null,function(Ha){Hd._runScript("fn=function(event){"+Ha+";}"),this.on("click",this,void 0)}),Hh(0,Ha,"id",null,function(Ha){Hw.document.setElementById(Ha,this)}),Hh(0,Ha,"innerTEXT",function(){return this._text.text},function(Ha){this.text=Ha}),Hh(0,Ha,"style",function(){return this._style}),Hh(0,Ha,"text",function(){return this._text.text},function(Ha){this._text==Hb._EMPTYTEXT?this._text={text:Ha,words:null}:(this._text.text=Ha,this._text.words&&(this._text.words.length=0)),Hm.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),Hh(0,Ha,"parent",Hc.prototype._$get_parent,function(Ha){if(Ha instanceof laya.html.dom.HTMLElement){var Hb=Ha;this.URI||(this.URI=Hb.URI),this.style.inherit(Hb.style)}Hd.superSet(Hn,this,"parent",Ha)}),Hh(0,Ha,"className",null,function(Ha){this.style.attrs(Hw.document.styleSheets["."+Ha])}),Hb.fillWords=function(Ha,Hb,Hc,Hd,He,Hf,Hg){Ha.graphics.clear();for(var Hh=0,Hi=Hb.length;Hh<Hi;Hh++){var Hj=Hb[Hh];Ha.graphics.fillText(Hj.char,Hj.x+Hc,Hj.y+Hd,He,Hf,"left",Hg)}},Hb._EMPTYTEXT={text:null,words:null},Hb}(Hn),Hb=(function(Ha){function Hb(){Hb.__super.call(this),this.style.lineElement=!0,this.style.block=!0}Hg(Hb,"laya.html.dom.HTMLBrElement",Hv)}(),function(Ha){function Hb(){this.contextHeight=NaN,this.contextWidth=NaN,Hb.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}Hg(Hb,"laya.html.dom.HTMLDivElement",Ha);var Hc=Hb.prototype;return Hc.appendHTML=function(Ha){Ht.parse(this,Ha,this.URI),this.layout()},Hc._addChildsToLayout=function(Hb){var Ha=this._getWords();if(null==Ha&&0==this._childs.length)return!1;Ha&&Ha.forEach(function(Ha){Hb.push(Ha)});for(var Hc=!0,Hd=0,He=this._childs.length;Hd<He;Hd++){var Hf=this._childs[Hd];Hc?Hc=!1:Hb.push(null),Hf._addToLayout(Hb)}return!0},Hc._addToLayout=function(Ha){this.layout()},Hc.layout=function(){if(this.style){this.style._type|=512;var Ha=Hu.layout(this);if(Ha){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new Hk);var Hb=this._$P.mHtmlBounds;Hb.x=Hb.y=0,Hb.width=this.contextWidth=Ha[0],Hb.height=this.contextHeight=Ha[1],this.setBounds(Hb)}}},Hh(0,Hc,"height",function(){return this._height?this._height:this.contextHeight},Ha.prototype._$set_height),Hh(0,Hc,"innerHTML",null,function(Ha){this.destroyChildren(),this.appendHTML(Ha)}),Hh(0,Hc,"width",function(){return this._width?this._width:this.contextWidth},function(Ha){var Hb=!1;Hb=0===Ha?Ha!=this._width:Ha!=this.width,Hd.superSet(Hv,this,"width",Ha),Hb&&this.layout()}),Hb}(Hv)),Hw=function(Ha){function Hb(){this.all=new Array,this.styleSheets=Hi.styleSheets,Hb.__super.call(this)}Hg(Hb,"laya.html.dom.HTMLDocument",Hv);var Hc=Hb.prototype;return Hc.getElementById=function(Ha){return this.all[Ha]},Hc.setElementById=function(Ha,Hb){this.all[Ha]=Hb},He(Hb,["document",function(){return this.document=new Hb}]),Hb}();(function(Ha){function Hb(){this._tex=null,this._url=null,this._renderArgs=[],Hb.__super.call(this),this.style.block=!0}Hg(Hb,"laya.html.dom.HTMLImageElement",Hv);var Hc=Hb.prototype;Hc._addToLayout=function(Ha){!this._style.absolute&&Ha.push(this)},Hc.render=function(Ha,Hb,Hc){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(Hp.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,Ha.ctx.drawTexture2(Hb,Hc,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},Hc.layaoutCallNative=function(){var Ha=0;if(this._childs&&0<(Ha=this._childs.length))for(var Hb=0;Hb<Ha;Hb++)this._childs[Hb].layaoutCallNative&&this._childs[Hb].layaoutCallNative()},Hh(0,Hc,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(Ha){this._width!==Ha&&(this._width=Ha,this._style.width=Ha,this.repaint())}),Hh(0,Hc,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(Ha){this._height!==Ha&&(this._height=Ha,this._style.height=Ha,this.repaint())}),Hc.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),Hj.clearCache(this,this._url),this._tex=null),Hv.prototype.destroy.call(this)},Hc.onloaded=function(){var Ha=this._style;Ha&&!Ha.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),Ha&&!Ha.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),Hm.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},Hc._loadImageComplete=function(Ha,Hb,Hc){if(!this._destroyed)if(null!=Hc)if(Hc instanceof ArrayBuffer){var Hd=new DataView(Hc);new laya.webgl.resource.WebGLImage(new Uint8Array(Hc,8),Ha,0,!1,Hd.getUint32(0),Hd.getUint32(4));this.onloaded()}else if(Hc instanceof Hq)Hj.imgMgrSet[Ha]=Hb,Hf.imgMgrLock(Ha,Hj.imgMgrSet[Ha]),this._url=Ha,this._tex=Hc,Hj.keepCache(this,Ha),Hj.cacheRes(Ha,this._tex),this.onloaded();else{var He=-1!=Ha.indexOf(".png",Ha.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(Hc,Ha,He,!1,Hc.width,Hc.height);this.onloaded()}else this.event("error","Load image failed")},Hh(0,Hc,"src",null,function(Ha){(Ha=this.formatURL(Ha),this._url!=Ha)&&(null!=this._tex&&(Hj.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=Ha,(this._tex=Hj.getRes(Ha))?(Hj.keepCache(this,Ha),this.onloaded()):Hf.imgMgrLoad(Ha,this._loadImageComplete.bind(this),2,!1))})})(),function(Ha){function Hb(){this.type=null,Hb.__super.call(this),this.visible=!1}Hg(Hb,"laya.html.dom.HTMLLinkElement",Ha);var Hc=Hb.prototype;Hc._onload=function(Ha){switch(this.type){case"text/css":Hi.parseCSS(Ha,this.URI)}},Hh(0,Hc,"href",Ha.prototype._$get_href,function(Ha){var Hb=this;Ha=this.formatURL(Ha),this.URI=new Hr(Ha);var Hc=new Hj;Hc.once("complete",null,function(Ha){Hb._onload(Ha)}),Hc.load(Ha,"text")}),Hb._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(Hv),function(Ha){function Hb(){Hb.__super.call(this),this.visible=!1}Hg(Hb,"laya.html.dom.HTMLStyleElement",Ha),Hh(0,Hb.prototype,"text",Ha.prototype._$get_text,function(Ha){Hi.parseCSS(Ha,null)})}(Hv),function(Ha){function Hb(){Hb.__super.call(this),this._getCSSStyle().valign="middle"}Hg(Hb,"laya.html.dom.HTMLIframeElement",Ha),Hh(0,Hb.prototype,"href",Ha.prototype._$get_href,function(Hc){var Hd=this;Hc=this.formatURL(Hc);var Ha=new Hj;Ha.once("complete",null,function(Ha){var Hb=Hd.URI;Hd.URI=new Hr(Hc),Hd.innerHTML=Ha,!Hb||(Hd.URI=Hb)}),Ha.load(Hc,"text")})}(Hb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ha,Hb){"use strict";for(var Hc in Object.defineProperty(Hb,"__esModule",{value:!0}),Laya){var Hd=Laya[Hc];Hd&&Hd.__isclass&&(Hb[Hc]=Hd)}}),function(Ha,Hb,Hp){Hp.un,Hp.uns;var Hd=Hp.static,Hf=Hp.class,He=Hp.getset,Hc=(Hp.__newvec,laya.display.Animation),Hq=(laya.utils.Browser,laya.utils.ClassUtils),Hg=laya.filters.ColorFilter,Hh=laya.utils.Ease,Hi=laya.events.Event,Hj=(laya.events.EventDispatcher,laya.display.css.Font),Hk=laya.display.FrameAnimation,Hl=laya.display.Graphics,Hm=laya.utils.Handler,Hn=laya.display.Input,Hs=laya.net.Loader,Ho=(laya.display.Node,laya.maths.Point),Hr=laya.maths.Rectangle,Ht=laya.renders.Render,Hu=laya.display.Sprite,Hv=laya.display.Text,Hw=laya.resource.Texture,Hx=laya.utils.Tween,Hy=laya.utils.Utils,Hz=laya.utils.WeakObject;Hp.interface("laya.ui.IItem"),Hp.interface("laya.ui.ISelect"),Hp.interface("laya.ui.IRender"),Hp.interface("laya.ui.IComponent"),Hp.interface("laya.ui.IBox","IComponent");var HA=function(){function Ha(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return Hf(Ha,"laya.ui.LayoutStyle"),Hd(Ha,["EMPTY",function(){return this.EMPTY=new Ha}]),Ha}(),HB=function(){function Ha(){}return Hf(Ha,"laya.ui.Styles"),Ha.labelColor="#000000",Ha.buttonStateNum=3,Ha.scrollBarMinNum=15,Ha.scrollBarDelayTime=500,Hd(Ha,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),Ha}(),HC=function(){function He(){}return Hf(He,"laya.ui.UIUtils"),He.fillArray=function(Ha,Hb,Hc){var Hd=Ha.concat();if(Hb)for(var He=Hb.split(","),Hf=0,Hg=Math.min(Hd.length,He.length);Hf<Hg;Hf++){var Hh=He[Hf];Hd[Hf]="true"==Hh||"false"!=Hh&&Hh,null!=Hc&&(Hd[Hf]=Hc(Hh))}return Hd},He.toColor=function(Ha){return Hy.toHexColor(Ha)},He.gray=function(Ha,Hb){void 0===Hb&&(Hb=!0),Hb?He.addFilter(Ha,He.grayFilter):He.clearFilter(Ha,Hg)},He.addFilter=function(Ha,Hb){var Hc=Ha.filters||[];Hc.push(Hb),Ha.filters=Hc},He.clearFilter=function(Ha,Hb){var Hc=Ha.filters;if(null!=Hc&&0<Hc.length){for(var Hd=Hc.length-1;-1<Hd;Hd--){var He=Hc[Hd];Hp.__typeof(He,Hb)&&Hc.splice(Hd,1)}Ha.filters=Hc}},He._getReplaceStr=function(Ha){return He.escapeSequence[Ha]},He.adptString=function(Ha){return Ha.replace(/\\(\w)/g,He._getReplaceStr)},He.getBindFun=function(Ha){var Hb=He._funMap.get(Ha);if(null==Hb){var Hc='"'+Ha+'"',Hd="(function(data){if(data==null)return;with(data){try{\nreturn "+(Hc=Hc.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";Hb=Hp._runScript(Hd),He._funMap.set(Ha,Hb)}return Hb},Hd(He,["grayFilter",function(){return this.grayFilter=new Hg([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new Hz}]),He}(),HD=function(){function Ha(){}return Hf(Ha,"UIConfig"),Ha.touchScrollEnable=!0,Ha.mouseWheelEnable=!0,Ha.showButtons=!0,Ha.popupBgColor="#000000",Ha.popupBgAlpha=.5,Ha.closeDialogOnSide=!0,Ha}(),HE=function(Hc){function Hr(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,Hr.__super.call(this),this._weakKeys=[]}Hf(Hr,"laya.ui.AutoBitmap",Hc);var Ha=Hr.prototype;return Ha.destroy=function(){if(Hs.clearObject(this,this._weakKey),this._weakKeys){for(var Ha=0,Hb=this._weakKeys.length;Ha<Hb;++Ha)Hs.clearObject(this,this._weakKeys[Ha]);this._weakKeys=null}Hc.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},Ha._setChanged=function(){this._isChanged||(this._isChanged=!0,Hp.timer.callLater(this,this.changeSource))},Ha.changeSource=function(){this._isChanged=!1;var Ha=this._source;if(Ha&&Ha.bitmap){var Hb=this.width,Hc=this.height,Hd=this._sizeGrid,He=Ha.sourceWidth,Hf=Ha.sourceHeight;if(!Hd||He===Hb&&Hf===Hc)this.cleanByTexture(Ha,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,Hb,Hc);else{Hs.clearObject(this,this._weakKey),Ha.$_GID||(Ha.$_GID=Hy.getGID());var Hg=Ha.$_GID+"."+Hb+"."+Hc+"."+Hd.join("."),Hh=Hs.findObject(Hg);if(Hy.isOKCmdList(Hh))return this._weakKey=Hg,Hs.keepObject(this,this._weakKey),void(this.cmds=Hh);this.clear();var Hi,Hj,Hk=Hd[0],Hl=Hd[1],Hm=Hd[2],Hn=Hd[3],Ho=Hd[4],Hp=!1;if(Hb==He&&(Hn=Hl=0),Hc==Hf&&(Hk=Hm=0),Hb<Hn+Hl){var Hq=Hb;Hp=!0,Hb=Hn+Hl,this.save(),this.clipRect(0,0,Hq,Hc)}Hn&&Hk&&(Hi=Hr.getTexture(Ha,0,0,Hn,Hk),Hj=this._weakKeys[0],Hi?(Hj!=Hi.weakKey&&(Hs.clearObject(this,Hj),Hs.keepObject(this,Hi.weakKey),this._weakKeys[0]=Hi.weakKey),this.drawTexture(Hi,0,0,Hn,Hk)):(Hs.clearObject(this,Hj),this._weakKeys[0]="")),Hl&&Hk&&(Hi=Hr.getTexture(Ha,He-Hl,0,Hl,Hk),Hj=this._weakKeys[1],Hi?(Hj!=Hi.weakKey&&(Hs.clearObject(this,Hj),Hs.keepObject(this,Hi.weakKey),this._weakKeys[1]=Hi.weakKey),this.drawTexture(Hi,Hb-Hl,0,Hl,Hk)):(Hs.clearObject(this,Hj),this._weakKeys[1]="")),Hn&&Hm&&(Hi=Hr.getTexture(Ha,0,Hf-Hm,Hn,Hm),Hj=this._weakKeys[2],Hi?(Hj!=Hi.weakKey&&(Hs.clearObject(this,Hj),Hs.keepObject(this,Hi.weakKey),this._weakKeys[2]=Hi.weakKey),this.drawTexture(Hi,0,Hc-Hm,Hn,Hm)):(Hs.clearObject(this,Hj),this._weakKeys[2]="")),Hl&&Hm&&(Hi=Hr.getTexture(Ha,He-Hl,Hf-Hm,Hl,Hm),Hj=this._weakKeys[3],Hi?(Hj!=Hi.weakKey&&(Hs.clearObject(this,Hj),Hs.keepObject(this,Hi.weakKey),this._weakKeys[3]=Hi.weakKey),this.drawTexture(Hi,Hb-Hl,Hc-Hm,Hl,Hm)):(Hs.clearObject(this,Hj),this._weakKeys[3]="")),Hk&&(Hi=Hr.getTexture(Ha,Hn,0,He-Hn-Hl,Hk),Hj=this._weakKeys[4],Hi?(Hj!=Hi.weakKey&&(Hs.clearObject(this,Hj),Hs.keepObject(this,Hi.weakKey),this._weakKeys[4]=Hi.weakKey),this.drawBitmap(Ho,Hi,Hn,0,Hb-Hn-Hl,Hk)):(Hs.clearObject(this,Hj),this._weakKeys[4]="")),Hm&&(Hi=Hr.getTexture(Ha,Hn,Hf-Hm,He-Hn-Hl,Hm),Hj=this._weakKeys[5],Hi?(Hj!=Hi.weakKey&&(Hs.clearObject(this,Hj),Hs.keepObject(this,Hi.weakKey),this._weakKeys[5]=Hi.weakKey),this.drawBitmap(Ho,Hi,Hn,Hc-Hm,Hb-Hn-Hl,Hm)):(Hs.clearObject(this,Hj),this._weakKeys[5]="")),Hn&&(Hi=Hr.getTexture(Ha,0,Hk,Hn,Hf-Hk-Hm),Hj=this._weakKeys[6],Hi?(Hj!=Hi.weakKey&&(Hs.clearObject(this,Hj),Hs.keepObject(this,Hi.weakKey),this._weakKeys[6]=Hi.weakKey),this.drawBitmap(Ho,Hi,0,Hk,Hn,Hc-Hk-Hm)):(Hs.clearObject(this,Hj),this._weakKeys[6]="")),Hl&&(Hi=Hr.getTexture(Ha,He-Hl,Hk,Hl,Hf-Hk-Hm),Hj=this._weakKeys[7],Hi?(Hj!=Hi.weakKey&&(Hs.clearObject(this,Hj),Hs.keepObject(this,Hi.weakKey),this._weakKeys[7]=Hi.weakKey),this.drawBitmap(Ho,Hi,Hb-Hl,Hk,Hl,Hc-Hk-Hm)):(Hs.clearObject(this,Hj),this._weakKeys[7]="")),Hi=Hr.getTexture(Ha,Hn,Hk,He-Hn-Hl,Hf-Hk-Hm),Hj=this._weakKeys[8],Hi?(Hj!=Hi.weakKey&&(Hs.clearObject(this,Hj),Hs.keepObject(this,Hi.weakKey),this._weakKeys[8]=Hi.weakKey),this.drawBitmap(Ho,Hi,Hn,Hk,Hb-Hn-Hl,Hc-Hk-Hm)):(Hs.clearObject(this,Hj),this._weakKeys[8]=""),Hp&&this.restore(),this.autoCacheCmd&&!Ht.isConchApp&&(Hs.saveObject(Hg,this.cmds,null),this._weakKey=Hg,Hs.keepObject(this,this._weakKey))}this._repaint()}},Ha.drawBitmap=function(Ha,Hb,Hc,Hd,He,Hf){void 0===He&&(He=0),void 0===Hf&&(Hf=0),He<.1||Hf<.1||(!Ha||Hb.width==He&&Hb.height==Hf?this.drawTexture(Hb,Hc,Hd,He,Hf):this.fillTexture(Hb,Hc,Hd,He,Hf))},Ha.clear=function(Ha){void 0===Ha&&(Ha=!0),Hc.prototype.clear.call(this,!1)},He(0,Ha,"sizeGrid",function(){return this._sizeGrid},function(Ha){this._sizeGrid=Ha,this._setChanged()}),He(0,Ha,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(Ha){this._width!=Ha&&(this._width=Ha,this._setChanged())}),He(0,Ha,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(Ha){this._height!=Ha&&(this._height=Ha,this._setChanged())}),He(0,Ha,"source",function(){return this._source},function(Ha){Ha?(this._source=Ha,this._setChanged()):(this._source=null,this.clear())}),Hr.getTexture=function(Ha,Hb,Hc,Hd,He){Hd<=0&&(Hd=1),He<=0&&(He=1),Ha.$_GID||(Ha.$_GID=Hy.getGID());var Hf=Ha.$_GID+"."+Hb+"."+Hc+"."+Hd+"."+He,Hg=Hs.findObject(Hf);if((!Hg||!Hg.source)&&(Hg=Hw.createFromTexture(Ha,Hb,Hc,Hd,He))){if(Ha.alphaTexture){var Hh=Ha.width/Ha.alphaTexture.width;Hg.alphaTexture=Hw.createFromTexture(Ha.alphaTexture,Hb/Hh,Hc/Hh,Hd/Hh,He/Hh)}Hs.saveObject(Hf,Hg),Hg.weakKey=Hf}return Hg},Hr}(Hl),HF=(function(Ha){function Hb(){Hb.__super.call(this)}Hf(Hb,"laya.ui.UIEvent",Hi),Hb.SHOW_TIP="showtip",Hb.HIDE_TIP="hidetip"}(),function(Hb){function Ha(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,Ha.__super.call(this),this._layout=HA.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}Hf(Ha,"laya.ui.Component",Hb);var Hc=Ha.prototype;return Hp.imps(Hc,{"laya.ui.IComponent":!0}),Hc.destroy=function(Ha){void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,Ha),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},Hc.preinitialize=function(){},Hc.createChildren=function(){},Hc.initialize=function(){},Hc.callLater=function(Ha,Hb){Hp.timer.callLater(this,Ha,Hb)},Hc.runCallLater=function(Ha){Hp.timer.runCallLater(this,Ha)},Hc.commitMeasure=function(){},Hc.changeSize=function(){this.event("resize")},Hc.getLayout=function(){return this._layout===HA.EMPTY&&(this._layout=new HA),this._layout},Hc._setLayoutEnabled=function(Ha){this._layout&&this._layout.enable!=Ha&&(this._layout.enable=Ha,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},Hc.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},Hc.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},Hc.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},Hc.resetLayoutX=function(){var Ha=this._layout;if(isNaN(Ha.anchorX)||(this.pivotX=Ha.anchorX*this.width),this.layoutEnabled){var Hb=this.parent;Hb&&(isNaN(Ha.centerX)?isNaN(Ha.left)?isNaN(Ha.right)||(this.x=Math.round(Hb.width-this.displayWidth-Ha.right+this.pivotX*this.scaleX)):(this.x=Math.round(Ha.left+this.pivotX*this.scaleX),isNaN(Ha.right)||(this.width=(Hb._width-Ha.left-Ha.right)/(this.scaleX||.01))):this.x=Math.round(.5*(Hb.width-this.displayWidth)+Ha.centerX+this.pivotX*this.scaleX))}},Hc.resetLayoutY=function(){var Ha=this._layout;if(isNaN(Ha.anchorY)||(this.pivotY=Ha.anchorY*this.height),this.layoutEnabled){var Hb=this.parent;Hb&&(isNaN(Ha.centerY)?isNaN(Ha.top)?isNaN(Ha.bottom)||(this.y=Math.round(Hb.height-this.displayHeight-Ha.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(Ha.top+this.pivotY*this.scaleY),isNaN(Ha.bottom)||(this.height=(Hb._height-Ha.top-Ha.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(Hb.height-this.displayHeight)+Ha.centerY+this.pivotY*this.scaleY))}},Hc.onMouseOver=function(Ha){Hp.stage.event("showtip",this._toolTip)},Hc.onMouseOut=function(Ha){Hp.stage.event("hidetip",this._toolTip)},He(0,Hc,"displayWidth",function(){return this.width*this.scaleX}),He(0,Hc,"width",function(){return this._width?this._width:this.measureWidth},function(Ha){this._width!=Ha&&(this._width=Ha,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),He(0,Hc,"measureWidth",function(){var Ha=0;this.commitMeasure();for(var Hb=this.numChildren-1;-1<Hb;Hb--){var Hc=this.getChildAt(Hb);Hc.visible&&(Ha=Math.max(Hc.x+Hc.width*Hc.scaleX,Ha))}return Ha}),He(0,Hc,"displayHeight",function(){return this.height*this.scaleY}),He(0,Hc,"height",function(){return this._height?this._height:this.measureHeight},function(Ha){this._height!=Ha&&(this._height=Ha,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),He(0,Hc,"dataSource",function(){return this._dataSource},function(Ha){for(var Hb in this._dataSource=Ha,this._dataSource)this.hasOwnProperty(Hb)&&"function"!=typeof this[Hb]&&(this[Hb]=this._dataSource[Hb])}),He(0,Hc,"scaleY",Hb.prototype._$get_scaleY,function(Ha){Hp.superGet(Hu,this,"scaleY")!=Ha&&(Hp.superSet(Hu,this,"scaleY",Ha),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),He(0,Hc,"measureHeight",function(){var Ha=0;this.commitMeasure();for(var Hb=this.numChildren-1;-1<Hb;Hb--){var Hc=this.getChildAt(Hb);Hc.visible&&(Ha=Math.max(Hc.y+Hc.height*Hc.scaleY,Ha))}return Ha}),He(0,Hc,"scaleX",Hb.prototype._$get_scaleX,function(Ha){Hp.superGet(Hu,this,"scaleX")!=Ha&&(Hp.superSet(Hu,this,"scaleX",Ha),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),He(0,Hc,"top",function(){return this._layout.top},function(Ha){Ha!=this._layout.top&&(this.getLayout().top=Ha,this._setLayoutEnabled(!0)),this.resetLayoutY()}),He(0,Hc,"bottom",function(){return this._layout.bottom},function(Ha){Ha!=this._layout.bottom&&(this.getLayout().bottom=Ha,this._setLayoutEnabled(!0)),this.resetLayoutY()}),He(0,Hc,"left",function(){return this._layout.left},function(Ha){Ha!=this._layout.left&&(this.getLayout().left=Ha,this._setLayoutEnabled(!0)),this.resetLayoutX()}),He(0,Hc,"right",function(){return this._layout.right},function(Ha){Ha!=this._layout.right&&(this.getLayout().right=Ha,this._setLayoutEnabled(!0)),this.resetLayoutX()}),He(0,Hc,"centerX",function(){return this._layout.centerX},function(Ha){Ha!=this._layout.centerX&&(this.getLayout().centerX=Ha,this._setLayoutEnabled(!0)),this.resetLayoutX()}),He(0,Hc,"centerY",function(){return this._layout.centerY},function(Ha){Ha!=this._layout.centerY&&(this.getLayout().centerY=Ha,this._setLayoutEnabled(!0)),this.resetLayoutY()}),He(0,Hc,"anchorX",function(){return this._layout.anchorX},function(Ha){Ha!=this._layout.anchorX&&(this.getLayout().anchorX=Ha,this._setLayoutEnabled(!0)),this.resetLayoutX()}),He(0,Hc,"anchorY",function(){return this._layout.anchorY},function(Ha){Ha!=this._layout.anchorY&&(this.getLayout().anchorY=Ha,this._setLayoutEnabled(!0)),this.resetLayoutY()}),He(0,Hc,"tag",function(){return this._tag},function(Ha){this._tag=Ha}),He(0,Hc,"toolTip",function(){return this._toolTip},function(Ha){this._toolTip!=Ha&&(null!=(this._toolTip=Ha)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),He(0,Hc,"comXml",function(){return this._comXml},function(Ha){this._comXml=Ha}),He(0,Hc,"gray",function(){return this._gray},function(Ha){Ha!==this._gray&&(this._gray=Ha,HC.gray(this,Ha))}),He(0,Hc,"disabled",function(){return this._disabled},function(Ha){Ha!==this._disabled&&(this.gray=this._disabled=Ha,this.mouseEnabled=!Ha)}),Ha}(Hu)),HG=function(Ha){function Hb(){this.lockLayer=null,this.popupEffect=function(Ha){Ha.scale(1,1),Hx.from(Ha,{x:Hp.stage.width/2,y:Hp.stage.height/2,scaleX:0,scaleY:0},300,Hh.backOut,Hm.create(this,this.doOpen,[Ha]))},this.closeEffect=function(Ha,Hb){Hx.to(Ha,{x:Hp.stage.width/2,y:Hp.stage.height/2,scaleX:0,scaleY:0},300,Hh.strongOut,Hm.create(this,this.doClose,[Ha,Hb]))},Hb.__super.call(this),this.maskLayer=new Hu,this.popupEffectHandler=Hm.create(this,this.popupEffect,null,!1),this.closeEffectHandler=Hm.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,Hp.stage.addChild(this),Hp.stage.on("resize",this,this._onResize),HD.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}Hf(Hb,"laya.ui.DialogManager",Hu);var Hc=Hb.prototype;return Hc._closeOnSide=function(){var Ha=this.getChildAt(this.numChildren-1);Ha instanceof laya.ui.Dialog&&Ha.close("side")},Hc.setLockView=function(Ha){this.lockLayer||(this.lockLayer=new HH,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(Hp.stage.width,Hp.stage.height)),this.lockLayer.removeChildren(),Ha&&(Ha.centerX=Ha.centerY=0,this.lockLayer.addChild(Ha))},Hc._onResize=function(Ha){var Hb=this.maskLayer.width=Hp.stage.width,Hc=this.maskLayer.height=Hp.stage.height;this.lockLayer&&this.lockLayer.size(Hb,Hc),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,Hb,Hc,HD.popupBgColor),this.maskLayer.alpha=HD.popupBgAlpha;for(var Hd=this.numChildren-1;-1<Hd;Hd--){var He=this.getChildAt(Hd);He.popupCenter&&this._centerDialog(He)}},Hc._centerDialog=function(Ha){Ha.x=Math.round((Hp.stage.width-Ha.width>>1)+Ha.pivotX),Ha.y=Math.round((Hp.stage.height-Ha.height>>1)+Ha.pivotY)},Hc.open=function(Ha,Hb,Hc){void 0===Hb&&(Hb=!1),void 0===Hc&&(Hc=!1),Hb&&this._closeAll(),Ha.popupCenter&&this._centerDialog(Ha),this.addChild(Ha),(Ha.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),Hc&&null!=Ha.popupEffect?Ha.popupEffect.runWith(Ha):this.doOpen(Ha),this.event("open")},Hc.doOpen=function(Ha){Ha.onOpened()},Hc.lock=function(Ha){this.lockLayer&&(Ha?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},Hc.close=function(Ha,Hb,Hc){void 0===Hc&&(Hc=!1),Hc&&null!=Ha.closeEffect?Ha.closeEffect.runWith([Ha,Hb]):this.doClose(Ha,Hb),this.event("close")},Hc.doClose=function(Ha,Hb){Ha.removeSelf(),Ha.isModal&&this._checkMask(),Ha.closeHandler&&Ha.closeHandler.runWith(Hb),Ha.onClosed(Hb)},Hc.closeAll=function(){this._closeAll(),this.event("close")},Hc._closeAll=function(){for(var Ha=this.numChildren-1;-1<Ha;Ha--){var Hb=this.getChildAt(Ha);Hb&&null!=Hb.close&&this.doClose(Hb)}},Hc.getDialogsByGroup=function(Ha){for(var Hb=[],Hc=this.numChildren-1;-1<Hc;Hc--){var Hd=this.getChildAt(Hc);Hd&&Hd.group===Ha&&Hb.push(Hd)}return Hb},Hc.closeByGroup=function(Ha){for(var Hb=[],Hc=this.numChildren-1;-1<Hc;Hc--){var Hd=this.getChildAt(Hc);Hd&&Hd.group===Ha&&(Hd.close(),Hb.push(Hd))}return Hb},Hc._checkMask=function(){this.maskLayer.removeSelf();for(var Ha=this.numChildren-1;-1<Ha;Ha--){var Hb=this.getChildAt(Ha);if(Hb&&Hb.isModal)return void this.addChildAt(this.maskLayer,Ha)}},Hb}(),HH=function(Ha){function Hb(){Hb.__super.call(this)}Hf(Hb,"laya.ui.Box",Ha);var Hc=Hb.prototype;return Hp.imps(Hc,{"laya.ui.IBox":!0}),He(0,Hc,"dataSource",Ha.prototype._$get_dataSource,function(Ha){for(var Hb in this._dataSource=Ha){var Hc=this.getChildByName(Hb);Hc?Hc.dataSource=Ha[Hb]:this.hasOwnProperty(Hb)&&"function"!=typeof this[Hb]&&(this[Hb]=Ha[Hb])}}),Hb}(HF),HI=function(Hb){function Hc(Ha,Hb){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,Hc.__super.call(this),this._labelColors=HB.buttonLabelColors,this._stateNum=HB.buttonStateNum,void 0===Hb&&(Hb=""),this.skin=Ha,this.label=Hb}Hf(Hc,"laya.ui.Button",Hb);var Ha=Hc.prototype;return Hp.imps(Ha,{"laya.ui.ISelect":!0}),Ha.destroy=function(Ha){Hs.clearCache(this,this._skin),Hs.clearObject(this,this._weakKey),void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,Ha),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(Ha),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},Ha.createChildren=function(){this.graphics=this._bitmap=new HE},Ha.createText=function(){this._text||(this._text=new Hv,this._text.overflow=Hv.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},Ha.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},Ha.onMouse=function(Ha){if(!1!==this.toggle||!this._selected)return"click"===Ha.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=Hc.stateMap[Ha.type]))},Ha.changeClips=function(){var Ha=Hs.getRes(this._skin);if(Ha&&this._skin&&""!=this._skin){Hs.clearObject(this,this._weakKey);var Hb=Ha.sourceWidth,Hc=Ha.sourceHeight/this._stateNum;Ha.$_GID||(Ha.$_GID=Hy.getGID());var Hd=Ha.$_GID+"-"+this._stateNum,He=Hs.findObject(Hd);if(Hy.isOkTextureList(He)||(He=null),He)this._weakKey=Hd,Hs.keepObject(this,this._weakKey),this._sources=He;else{if(this._sources=[],1===this._stateNum)this._sources.push(Ha);else for(var Hf=0;Hf<this._stateNum;Hf++){var Hg=Hw.createFromTexture(Ha,0,Hc*Hf,Hb,Hc);if(Ha.alphaTexture){var Hh=Ha.width/Ha.alphaTexture.width;Hg.alphaTexture=Hw.createFromTexture(Ha.alphaTexture,0/Hh,Hc*Hf/Hh,Hb/Hh,Hc/Hh)}this._sources.push(Hg)}Hs.saveObject(Hd,this._sources),this._weakKey=Hd,Hs.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||Hb,this._bitmap.height=this._height||Hc,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=Hb)}else console.warn("lose skin ",this._skin,this.name,this.__className)},Ha.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var Ha=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[Ha]),this.label&&(this._text.color=this._labelColors[Ha],this._strokeColors&&(this._text.strokeColor=this._strokeColors[Ha]))},Ha._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},He(0,Ha,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(Ha){this.createText(),this._text.strokeColor=Ha}),He(0,Ha,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),He(0,Ha,"skin",function(){return this._skin},function(Ha){this._skin!=Ha&&(Hs.clearCache(this,this._skin),this._skin=Ha,Hs.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),He(0,Ha,"state",function(){return this._state},function(Ha){this._state!=Ha&&(this._state=Ha,this._setStateChanged())}),He(0,Ha,"text",function(){return this.createText(),this._text}),He(0,Ha,"stateNum",function(){return this._stateNum},function(Ha){"string"==typeof Ha&&(Ha=parseInt(Ha)),this._stateNum!=Ha&&(this._stateNum=Ha<1?1:3<Ha?3:Ha,this.callLater(this.changeClips))}),He(0,Ha,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(Ha){this._strokeColors=HC.fillArray(HB.buttonLabelColors,Ha,String),this._setStateChanged()}),He(0,Ha,"labelColors",function(){return this._labelColors.join(",")},function(Ha){this._labelColors=HC.fillArray(HB.buttonLabelColors,Ha,String),this._setStateChanged()}),He(0,Ha,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),He(0,Ha,"label",function(){return this._text?this._text.text:null},function(Ha){(this._text||Ha)&&(this.createText(),this._text.text!=Ha&&(Ha&&!this._text.parent&&this.addChild(this._text),this._text.text=(Ha+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),He(0,Ha,"selected",function(){return this._selected},function(Ha){this._selected!=Ha&&(this._selected=Ha,this.state=this._selected?2:0,this.event("change"))}),He(0,Ha,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(Ha){this.createText(),this._text.padding=HC.fillArray(HB.labelPadding,Ha,Number)}),He(0,Ha,"labelSize",function(){return this.createText(),this._text.fontSize},function(Ha){this.createText(),this._text.fontSize=Ha}),He(0,Ha,"labelStroke",function(){return this.createText(),this._text.stroke},function(Ha){this.createText(),this._text.stroke=Ha}),He(0,Ha,"labelBold",function(){return this.createText(),this._text.bold},function(Ha){this.createText(),this._text.bold=Ha}),He(0,Ha,"labelFont",function(){return this.createText(),this._text.font},function(Ha){this.createText(),this._text.font=Ha}),He(0,Ha,"labelAlign",function(){return this.createText(),this._text.align},function(Ha){this.createText(),this._text.align=Ha}),He(0,Ha,"clickHandler",function(){return this._clickHandler},function(Ha){this._clickHandler=Ha}),He(0,Ha,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Ha){this._bitmap.sizeGrid=HC.fillArray(HB.defaultSizeGrid,Ha,Number)}),He(0,Ha,"width",Hb.prototype._$get_width,function(Ha){Hp.superSet(HF,this,"width",Ha),this._autoSize&&(this._bitmap.width=Ha,this._text&&(this._text.width=Ha))}),He(0,Ha,"height",Hb.prototype._$get_height,function(Ha){Hp.superSet(HF,this,"height",Ha),this._autoSize&&(this._bitmap.height=Ha,this._text&&(this._text.height=Ha))}),He(0,Ha,"dataSource",Hb.prototype._$get_dataSource,function(Ha){"number"==typeof(this._dataSource=Ha)||"string"==typeof Ha?this.label=Ha+"":Hp.superSet(HF,this,"dataSource",Ha)}),He(0,Ha,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(Ha){this._bitmap._offset=Ha?HC.fillArray([1,1],Ha,Number):[]}),Hd(Hc,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),Hc}(HF),HJ=function(Hb){function Hd(Ha,Hb,Hc){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,Hd.__super.call(this),void 0===Hb&&(Hb=1),void 0===Hc&&(Hc=1),this._clipX=Hb,this._clipY=Hc,this.skin=Ha}Hf(Hd,"laya.ui.Clip",Hb);var Ha=Hd.prototype;return Ha.destroy=function(Ha){Hs.clearCache(this,this._skin),Hs.clearObject(this,this._weakKey),void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},Ha.dispose=function(){this.destroy(!0),Hp.loader.clearRes(this._skin)},Ha.createChildren=function(){this.graphics=this._bitmap=new HE},Ha._onDisplay=function(Ha){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},Ha.changeClip=function(){if(this._clipChanged=!1,this._skin){var Ha=Hs.getRes(this._skin);Ha?this.loadComplete(this._skin,Ha):Hp.loader.load(this._skin,Hm.create(this,this.loadComplete,[this._skin]))}},Ha.loadComplete=function(Ha,Hb){if(Ha===this._skin&&Hb){Hs.clearObject(this,this._weakKey);var Hc=this._clipWidth||Math.ceil(Hb.sourceWidth/this._clipX),Hd=this._clipHeight||Math.ceil(Hb.sourceHeight/this._clipY),He=this._skin+Hc+Hd,Hf=Hs.findObject(He);if(Hy.isOkTextureList(Hf)||(Hf=null),Hf)this._weakKey=He,Hs.keepObject(this,this._weakKey),this._sources=Hf;else{this._sources=[];for(var Hg=0;Hg<this._clipY;Hg++)for(var Hh=0;Hh<this._clipX;Hh++){var Hi=Hw.createFromTexture(Hb,Hc*Hh,Hd*Hg,Hc,Hd);if(Hb.alphaTexture){var Hj=Hb.width/Hb.alphaTexture.width;Hi.alphaTexture=Hw.createFromTexture(Hb.alphaTexture,Hc*Hh/Hj,Hd*Hg/Hj,Hc/Hj,Hd/Hj)}this._sources.push(Hi)}Hs.saveObject(He,this._sources),this._weakKey=He,Hs.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},Ha.play=function(Ha,Hb){void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=-1),this._isPlaying=!0,this.index=Ha,this._toIndex=Hb,this._index++,Hp.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},Ha._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},Ha.stop=function(){this._isPlaying=!1,Hp.timer.clear(this,this._loop),this.event("complete")},Ha._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},He(0,Ha,"interval",function(){return this._interval},function(Ha){this._interval!=Ha&&(this._interval=Ha,this._isPlaying&&this.play())}),He(0,Ha,"skin",function(){return this._skin},function(Ha){this._skin!=Ha&&(Hs.clearCache(this,this._skin),(this._skin=Ha)?(Hs.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),He(0,Ha,"sources",function(){return this._sources},function(Ha){this._sources=Ha,this.index=this._index,this.event("loaded")}),He(0,Ha,"clipX",function(){return this._clipX},function(Ha){this._clipX=Ha||1,this._setClipChanged()}),He(0,Ha,"clipY",function(){return this._clipY},function(Ha){this._clipY=Ha||1,this._setClipChanged()}),He(0,Ha,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),He(0,Ha,"clipWidth",function(){return this._clipWidth},function(Ha){this._clipWidth=Ha,this._setClipChanged()}),He(0,Ha,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Ha){this._bitmap.sizeGrid=HC.fillArray(HB.defaultSizeGrid,Ha,Number)}),He(0,Ha,"group",function(){return this._group},function(Ha){Ha&&this._skin&&Hs.setGroup(this._skin,Ha),this._group=Ha}),He(0,Ha,"clipHeight",function(){return this._clipHeight},function(Ha){this._clipHeight=Ha,this._setClipChanged()}),He(0,Ha,"width",Hb.prototype._$get_width,function(Ha){Hp.superSet(HF,this,"width",Ha),this._bitmap.width=Ha}),He(0,Ha,"height",Hb.prototype._$get_height,function(Ha){Hp.superSet(HF,this,"height",Ha),this._bitmap.height=Ha}),He(0,Ha,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),He(0,Ha,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),He(0,Ha,"index",function(){return this._index},function(Ha){this._index=Ha,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[Ha]),this.event("change")}),He(0,Ha,"autoPlay",function(){return this._autoPlay},function(Ha){this._autoPlay!=Ha&&((this._autoPlay=Ha)?this.play():this.stop())}),He(0,Ha,"isPlaying",function(){return this._isPlaying},function(Ha){this._isPlaying=Ha}),He(0,Ha,"dataSource",Hb.prototype._$get_dataSource,function(Ha){"number"==typeof(this._dataSource=Ha)&&Math.floor(Ha)==Ha||"string"==typeof Ha?this.index=parseInt(Ha):Hp.superSet(HF,this,"dataSource",Ha)}),He(0,Ha,"bitmap",function(){return this._bitmap}),Hd}(HF),HK=function(Hb){function Ha(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,Ha.__super.call(this)}Hf(Ha,"laya.ui.ColorPicker",Hb);var Hc=Ha.prototype;return Hc.destroy=function(Ha){void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,Ha),this._colorPanel&&this._colorPanel.destroy(Ha),this._colorButton&&this._colorButton.destroy(Ha),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},Hc.createChildren=function(){this.addChild(this._colorButton=new HI),this._colorPanel=new HH,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new Hu),this._colorPanel.addChild(this._colorBlock=new Hu),this._colorPanel.addChild(this._colorInput=new Hn)},Hc.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},Hc.onPanelMouseDown=function(Ha){Ha.stopPropagation()},Hc.changePanel=function(){this._panelChanged=!1;var Ha=this._colorPanel.graphics;Ha.clear(),Ha.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(Ha=this._colorTiles.graphics).clear();for(var Hb=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],Hc=0;Hc<12;Hc++)for(var Hd=0;Hd<20;Hd++){var He=0;He=0===Hd?Hb[Hc]:1===Hd?0:51*(((3*Hc+Hd/6)%3<<0)+3*(Hc/6<<0))<<16|Hd%6*51<<8|(Hc<<0)%6*51;var Hf=HC.toColor(He);this._colors.push(Hf);var Hg=Hd*this._gridSize,Hh=Hc*this._gridSize;Ha.drawRect(Hg,Hh,this._gridSize,this._gridSize,Hf,"#000000")}},Hc.onColorButtonClick=function(Ha){this._colorPanel.parent?this.close():this.open()},Hc.open=function(){var Ha=this.localToGlobal(new Ho),Hb=Ha.x+this._colorPanel.width<=Hp.stage.width?Ha.x:Hp.stage.width-this._colorPanel.width,Hc=Ha.y+this._colorButton.height;Hc=Hc+this._colorPanel.height<=Hp.stage.height?Hc:Ha.y-this._colorPanel.height,this._colorPanel.pos(Hb,Hc),this._colorPanel.zOrder=1001,Hp._currentStage.addChild(this._colorPanel),Hp.stage.on("mousedown",this,this.removeColorBox)},Hc.close=function(){Hp.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},Hc.removeColorBox=function(Ha){this.close()},Hc.onColorFieldKeyDown=function(Ha){13==Ha.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),Ha.stopPropagation())},Hc.onColorInputChange=function(Ha){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},Hc.onColorTilesClick=function(Ha){this.selectedColor=this.getColorByMouse(),this.close()},Hc.onColorTilesMouseMove=function(Ha){this._colorInput.focus=!1;var Hb=this.getColorByMouse();this._colorInput.text=Hb,this.drawBlock(Hb)},Hc.getColorByMouse=function(){var Ha=this._colorTiles.getMousePoint(),Hb=Math.floor(Ha.x/this._gridSize),Hc=Math.floor(Ha.y/this._gridSize);return this._colors[20*Hc+Hb]},Hc.drawBlock=function(Ha){var Hb=this._colorBlock.graphics;Hb.clear();var Hc=Ha||"#ffffff";Hb.drawRect(0,0,50,20,Hc,this._borderColor),Ha||Hb.drawLine(0,0,50,20,"#ff0000")},Hc.changeColor=function(){var Ha=this.graphics;Ha.clear();var Hb=this._selectedColor||"#000000";Ha.drawRect(0,0,this._colorButton.width,this._colorButton.height,Hb)},Hc._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},He(0,Hc,"inputBgColor",function(){return this._inputBgColor},function(Ha){this._inputBgColor=Ha,this._setPanelChanged()}),He(0,Hc,"selectedColor",function(){return this._selectedColor},function(Ha){this._selectedColor!=Ha&&(this._selectedColor=this._colorInput.text=Ha,this.drawBlock(Ha),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",Hi.EMPTY.setTo("change",this,this)))}),He(0,Hc,"skin",function(){return this._colorButton.skin},function(Ha){this._colorButton.skin=Ha,this.changeColor()}),He(0,Hc,"bgColor",function(){return this._bgColor},function(Ha){this._bgColor=Ha,this._setPanelChanged()}),He(0,Hc,"borderColor",function(){return this._borderColor},function(Ha){this._borderColor=Ha,this._setPanelChanged()}),He(0,Hc,"inputColor",function(){return this._inputColor},function(Ha){this._inputColor=Ha,this._setPanelChanged()}),Ha}(HF),HL=function(Hb){function Hc(Ha,Hb){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,Hc.__super.call(this),this._itemColors=HB.comboBoxItemColors,this.skin=Ha,this.labels=Hb}Hf(Hc,"laya.ui.ComboBox",Hb);var Ha=Hc.prototype;return Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,Ha),this._button&&this._button.destroy(Ha),this._list&&this._list.destroy(Ha),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},Ha.createChildren=function(){this.addChild(this._button=new HI),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},Ha._createList=function(){this._list=new HV,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},Ha._setListEvent=function(Ha){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=Hm.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},Ha.onListDown=function(Ha){Ha.stopPropagation()},Ha.onScrollBarDown=function(Ha){Ha.stopPropagation()},Ha.onButtonMouseDown=function(Ha){this.callLater(this.switchTo,[!this._isOpen])},Ha.changeList=function(){this._listChanged=!1;var Ha=this.width-2,Hb=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:Ha,height:this._itemHeight,fontSize:this._itemSize,color:Hb}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},Ha.onlistItemMouse=function(Ha,Hb){var Hc=Ha.type;if("mouseover"===Hc||"mouseout"===Hc){if(this._isCustomList)return;var Hd=this._list.getCell(Hb);if(!Hd)return;var He=Hd.getChildByName("label");He&&("mouseover"===Hc?(He.bgColor=this._itemColors[0],He.color=this._itemColors[1]):(He.bgColor=null,He.color=this._itemColors[2]))}else"click"===Hc&&(this.selectedIndex=Hb,this.isOpen=!1)},Ha.switchTo=function(Ha){this.isOpen=Ha},Ha.changeOpen=function(){this.isOpen=!this._isOpen},Ha.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var Ha=this._list.graphics;Ha.clear(),Ha.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var Hb=this._list.array||[],Hc=Hb.length=0,Hd=this._labels.length;Hc<Hd;Hc++)Hb.push({label:this._labels[Hc]});this._list.height=this._listHeight,this._list.array=Hb},Ha.changeSelected=function(){this._button.label=this.selectedLabel},Ha._onStageMouseWheel=function(Ha){this._list&&!this._list.contains(Ha.target)&&this.removeList(null)},Ha.removeList=function(Ha){Hp.stage.off("mousedown",this,this.removeList),Hp.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},He(0,Ha,"selectedIndex",function(){return this._selectedIndex},function(Ha){this._selectedIndex!=Ha&&(this._selectedIndex=Ha,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[Hi.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),He(0,Ha,"measureHeight",function(){return this._button.height}),He(0,Ha,"skin",function(){return this._button.skin},function(Ha){this._button.skin!=Ha&&(this._button.skin=Ha,this._listChanged=!0)}),He(0,Ha,"measureWidth",function(){return this._button.width}),He(0,Ha,"width",Hb.prototype._$get_width,function(Ha){Hp.superSet(HF,this,"width",Ha),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),He(0,Ha,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(Ha){this.selectedIndex=this._labels.indexOf(Ha)}),He(0,Ha,"labels",function(){return this._labels.join(",")},function(Ha){0<this._labels.length&&(this.selectedIndex=-1),Ha?this._labels=Ha.split(","):this._labels.length=0,this._itemChanged=!0}),He(0,Ha,"height",Hb.prototype._$get_height,function(Ha){Hp.superSet(HF,this,"height",Ha),this._button.height=this._height}),He(0,Ha,"selectHandler",function(){return this._selectHandler},function(Ha){this._selectHandler=Ha}),He(0,Ha,"visibleNum",function(){return this._visibleNum},function(Ha){this._visibleNum=Ha,this._listChanged=!0}),He(0,Ha,"labelBold",function(){return this._button.text.bold},function(Ha){this._button.text.bold=Ha}),He(0,Ha,"itemColors",function(){return String(this._itemColors)},function(Ha){this._itemColors=HC.fillArray(this._itemColors,Ha,String),this._listChanged=!0}),He(0,Ha,"itemSize",function(){return this._itemSize},function(Ha){this._itemSize=Ha,this._listChanged=!0}),He(0,Ha,"scrollBar",function(){return this.list.scrollBar}),He(0,Ha,"isOpen",function(){return this._isOpen},function(Ha){if(this._isOpen!=Ha)if(this._isOpen=Ha,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var Hb=this.localToGlobal(Ho.TEMP.setTo(0,0)),Hc=Hb.y+this._button.height;Hc=Hc+this._listHeight<=Hp.stage.height?Hc:Hb.y-this._listHeight,this._list.pos(Hb.x,Hc),this._list.zOrder=1001,Hp._currentStage.addChild(this._list),Hp.stage.once("mousedown",this,this.removeList),Hp.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),He(0,Ha,"scrollBarSkin",function(){return this._scrollBarSkin},function(Ha){this._scrollBarSkin=Ha}),He(0,Ha,"sizeGrid",function(){return this._button.sizeGrid},function(Ha){this._button.sizeGrid=Ha}),He(0,Ha,"button",function(){return this._button}),He(0,Ha,"list",function(){return this._list||this._createList(),this._list},function(Ha){Ha&&(Ha.removeSelf(),this._isCustomList=!0,this._list=Ha,this._setListEvent(Ha),this._itemHeight=Ha.getCell(0).height+Ha.spaceY)}),He(0,Ha,"dataSource",Hb.prototype._$get_dataSource,function(Ha){"number"==typeof(this._dataSource=Ha)&&Math.floor(Ha)==Ha||"string"==typeof Ha?this.selectedIndex=parseInt(Ha):Ha instanceof Array?this.labels=Ha.join(","):Hp.superSet(HF,this,"dataSource",Ha)}),He(0,Ha,"labelColors",function(){return this._button.labelColors},function(Ha){this._button.labelColors!=Ha&&(this._button.labelColors=Ha)}),He(0,Ha,"labelPadding",function(){return this._button.text.padding.join(",")},function(Ha){this._button.text.padding=HC.fillArray(HB.labelPadding,Ha,Number)}),He(0,Ha,"labelSize",function(){return this._button.text.fontSize},function(Ha){this._button.text.fontSize=Ha}),He(0,Ha,"labelFont",function(){return this._button.text.font},function(Ha){this._button.text.font=Ha}),He(0,Ha,"stateNum",function(){return this._button.stateNum},function(Ha){this._button.stateNum=Ha}),Hc}(HF),HM=function(Hb){function Hc(Ha){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,Hc.__super.call(this),this._showButtons=HD.showButtons,this._touchScrollEnable=HD.touchScrollEnable,this._mouseWheelEnable=HD.mouseWheelEnable,this.skin=Ha,this.max=1}Hf(Hc,"laya.ui.ScrollBar",Hb);var Ha=Hc.prototype;return Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),this.stopScroll(),this.target=null,Hb.prototype.destroy.call(this,Ha),this.upButton&&this.upButton.destroy(Ha),this.downButton&&this.downButton.destroy(Ha),this.slider&&this.slider.destroy(Ha),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},Ha.createChildren=function(){this.addChild(this.slider=new HN),this.addChild(this.upButton=new HI),this.addChild(this.downButton=new HI)},Ha.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},Ha.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},Ha.onButtonMouseDown=function(Ha){var Hb=Ha.currentTarget===this.upButton;this.slide(Hb),Hp.timer.once(HB.scrollBarDelayTime,this,this.startLoop,[Hb]),Hp.stage.once("mouseup",this,this.onStageMouseUp)},Ha.startLoop=function(Ha){Hp.timer.frameLoop(1,this,this.slide,[Ha])},Ha.slide=function(Ha){Ha?this.value-=this._scrollSize:this.value+=this._scrollSize},Ha.onStageMouseUp=function(Ha){Hp.timer.clear(this,this.startLoop),Hp.timer.clear(this,this.slide)},Ha.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},Ha.changeSize=function(){Hb.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},Ha.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},Ha.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},Ha.setScroll=function(Ha,Hb,Hc){this.runCallLater(this.changeSize),this.slider.setSlider(Ha,Hb,Hc),this.slider.bar.visible=0<Hb,!this._hide&&this.autoHide&&(this.visible=!1)},Ha.onTargetMouseWheel=function(Ha){this.value-=Ha.delta*this._scrollSize,this.target=this._target},Ha.onTargetMouseDown=function(Ha){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new Ho),this._lastPoint.setTo(Hp.stage.mouseX,Hp.stage.mouseY),Hp.timer.clear(this,this.tweenMove),Hx.clearTween(this),Hp.stage.once("mouseup",this,this.onStageMouseUp2),Hp.stage.once("mouseout",this,this.onStageMouseUp2),Hp.timer.frameLoop(1,this,this.loop)},Ha.loop=function(){var Ha=Hp.stage.mouseY,Hb=Hp.stage.mouseX;if(this._lastOffset=this.isVertical?Ha-this._lastPoint.y:Hb-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?Hp.stage._canvasTransform.getScaleY():Hp.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=Hb,this._lastPoint.y=Ha,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},Ha.onStageMouseUp2=function(Ha){if(Hp.stage.off("mouseup",this,this.onStageMouseUp2),Hp.stage.off("mouseout",this,this.onStageMouseUp2),Hp.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?Hx.to(this,{value:this.min},this.elasticBackTime,Hh.sineOut,Hm.create(this,this.elasticOver)):this._value>this.max&&Hx.to(this,{value:this.max},this.elasticBackTime,Hh.sineOut,Hm.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?Hp.stage.mouseY-this._lastPoint.y:Hp.stage.mouseX-this._lastPoint.x);for(var Hb=0,Hc=Math.min(this._offsets.length,3),Hd=0;Hd<Hc;Hd++)Hb+=this._offsets[this._offsets.length-1-Hd];if(this._lastOffset=Hb/Hc,(Hb=Math.abs(this._lastOffset))<2)return void this.event("end");60<Hb&&(this._lastOffset=0<this._lastOffset?60:-60);var He=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));Hp.timer.frameLoop(1,this,this.tweenMove,[He])}},Ha.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&Hx.to(this,{alpha:0},500),this.event("end")},Ha.tweenMove=function(Ha){this._lastOffset*=this.rollRatio;var Hb=NaN;if(0<Ha&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,Hb=.5*-(this.min-Ha-this.value),this._lastOffset>Hb&&(this._lastOffset=Hb)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,Hb=.5*-(this.max+Ha-this.value),this._lastOffset<Hb&&(this._lastOffset=Hb))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(Hp.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?Hx.to(this,{value:this.min},this.elasticBackTime,Hh.sineOut,Hm.create(this,this.elasticOver)):this._value>this.max?Hx.to(this,{value:this.max},this.elasticBackTime,Hh.sineOut,Hm.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&Hx.to(this,{alpha:0},500)}},Ha.stopScroll=function(){this.onStageMouseUp2(null),Hp.timer.clear(this,this.tweenMove),Hx.clearTween(this)},He(0,Ha,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),He(0,Ha,"skin",function(){return this._skin},function(Ha){this._skin!=Ha&&(this._skin=Ha,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),He(0,Ha,"max",function(){return this.slider.max},function(Ha){this.slider.max=Ha}),He(0,Ha,"showButtons",function(){return this._showButtons},function(Ha){this._showButtons=Ha,this.callLater(this.changeScrollBar)}),He(0,Ha,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),He(0,Ha,"min",function(){return this.slider.min},function(Ha){this.slider.min=Ha}),He(0,Ha,"value",function(){return this._value},function(Ha){Ha!==this._value&&(this._value=Ha,this._isElastic||(this.slider._value!=Ha&&(this.slider._value=Ha,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),He(0,Ha,"isVertical",function(){return this.slider.isVertical},function(Ha){this.slider.isVertical=Ha}),He(0,Ha,"sizeGrid",function(){return this.slider.sizeGrid},function(Ha){this.slider.sizeGrid=Ha}),He(0,Ha,"scrollSize",function(){return this._scrollSize},function(Ha){this._scrollSize=Ha}),He(0,Ha,"dataSource",Hb.prototype._$get_dataSource,function(Ha){"number"==typeof(this._dataSource=Ha)||"string"==typeof Ha?this.value=Number(Ha):Hp.superSet(HF,this,"dataSource",Ha)}),He(0,Ha,"thumbPercent",function(){return this._thumbPercent},function(Ha){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),Ha=1<=Ha?.99:Ha,this._thumbPercent=Ha,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*Ha,HB.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*Ha,HB.scrollBarMinNum))}),He(0,Ha,"target",function(){return this._target},function(Ha){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=Ha)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),He(0,Ha,"hide",function(){return this._hide},function(Ha){this._hide=Ha,this.visible=!Ha}),He(0,Ha,"touchScrollEnable",function(){return this._touchScrollEnable},function(Ha){this._touchScrollEnable=Ha,this.target=this._target}),He(0,Ha,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(Ha){this._mouseWheelEnable=Ha,this.target=this._target}),He(0,Ha,"tick",function(){return this.slider.tick},function(Ha){this.slider.tick=Ha}),Hc}(HF),HN=function(Hb){function Hc(Ha){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,Hc.__super.call(this),this.skin=Ha}Hf(Hc,"laya.ui.Slider",Hb);var Ha=Hc.prototype;return Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,Ha),this._bg&&this._bg.destroy(Ha),this._bar&&this._bar.destroy(Ha),this._progress&&this._progress.destroy(Ha),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},Ha.createChildren=function(){this.addChild(this._bg=new HO),this.addChild(this._bar=new HI)},Ha.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},Ha.onBarMouseDown=function(Ha){this._globalSacle||(this._globalSacle=new Ho),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=Hp.stage.mouseX,this._ty=Hp.stage.mouseY,Hp.stage.on("mousemove",this,this.mouseMove),Hp.stage.once("mouseup",this,this.mouseUp),Hp.stage.once("mouseout",this,this.mouseUp),this.showValueText()},Ha.showValueText=function(){if(this.showLabel){var Ha=laya.ui.Slider.label;this.addChild(Ha),Ha.textField.changeText(this._value+""),this.isVertical?(Ha.x=this._bar.x+20,Ha.y=.5*(this._bar.height-Ha.height)+this._bar.y):(Ha.y=this._bar.y-20,Ha.x=.5*(this._bar.width-Ha.width)+this._bar.x)}},Ha.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},Ha.mouseUp=function(Ha){Hp.stage.off("mousemove",this,this.mouseMove),Hp.stage.off("mouseup",this,this.mouseUp),Hp.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},Ha.mouseMove=function(Ha){var Hb=this._value;this.isVertical?(this._bar.y+=(Hp.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(Hp.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=Hp.stage.mouseX,this._ty=Hp.stage.mouseY;var Hc=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*Hc)/Hc,this._value!=Hb&&this.sendChangeEvent(),this.showValueText()},Ha.sendChangeEvent=function(Ha){void 0===Ha&&(Ha="change"),this.event(Ha),this.changeHandler&&this.changeHandler.runWith(this._value)},Ha.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},Ha.changeSize=function(){Hb.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},Ha.setSlider=function(Ha,Hb,Hc){this._value=-1,this._min=Ha,this._max=Ha<Hb?Hb:Ha,this.value=Hc<Ha?Ha:Hb<Hc?Hb:Hc},Ha.changeValue=function(){var Ha=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*Ha)/Ha,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var Hb=this._max-this._min;0===Hb&&(Hb=1),this.isVertical?(this._bar.y=(this._value-this._min)/Hb*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/Hb*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},Ha.onBgMouseDown=function(Ha){var Hb=this._bg.getMousePoint();this.isVertical?this.value=Hb.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=Hb.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},He(0,Ha,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),He(0,Ha,"skin",function(){return this._skin},function(Ha){if(this._skin!=Ha){this._skin=Ha,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var Hb=this._skin.replace(".png","$progress.png");Hs.getRes(Hb)&&(this._progress||(this.addChild(this._progress=new HO),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=Hb),this.setBarPoint(),this.callLater(this.changeValue)}}),He(0,Ha,"allowClickBack",function(){return this._allowClickBack},function(Ha){this._allowClickBack!=Ha&&((this._allowClickBack=Ha)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),He(0,Ha,"max",function(){return this._max},function(Ha){this._max!=Ha&&(this._max=Ha,this.callLater(this.changeValue))}),He(0,Ha,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),He(0,Ha,"tick",function(){return this._tick},function(Ha){this._tick!=Ha&&(this._tick=Ha,this.callLater(this.changeValue))}),He(0,Ha,"sizeGrid",function(){return this._bg.sizeGrid},function(Ha){this._bg.sizeGrid=Ha,this._bar.sizeGrid=Ha,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),He(0,Ha,"min",function(){return this._min},function(Ha){this._min!=Ha&&(this._min=Ha,this.callLater(this.changeValue))}),He(0,Ha,"value",function(){return this._value},function(Ha){if(this._value!=Ha){var Hb=this._value;this._value=Ha,this.changeValue(),this._value!=Hb&&this.sendChangeEvent()}}),He(0,Ha,"dataSource",Hb.prototype._$get_dataSource,function(Ha){"number"==typeof(this._dataSource=Ha)||"string"==typeof Ha?this.value=Number(Ha):Hp.superSet(HF,this,"dataSource",Ha)}),He(0,Ha,"bar",function(){return this._bar}),Hd(Hc,["label",function(){return this.label=new HP}]),Hc}(HF),HO=function(Hb){function Hc(Ha){this._bitmap=null,this._skin=null,this._group=null,Hc.__super.call(this),this.skin=Ha}Hf(Hc,"laya.ui.Image",Hb);var Ha=Hc.prototype;return Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,Hs.clearCache(this,this._skin)},Ha.dispose=function(){this.destroy(!0),Hs.clearCache(this,this._skin)},Ha.createChildren=function(){this.graphics=this._bitmap=new HE},Ha.setSource=function(Ha,Hb){Ha===this._skin&&Hb&&(this.source=Hb,this.onCompResize())},He(0,Ha,"source",function(){return this._bitmap.source},function(Ha){this._bitmap&&(this._bitmap.source=Ha,this.event("loaded"),this.repaint())}),He(0,Ha,"dataSource",Hb.prototype._$get_dataSource,function(Ha){"string"==typeof(this._dataSource=Ha)?this.skin=Ha:Hp.superSet(HF,this,"dataSource",Ha)}),He(0,Ha,"measureHeight",function(){return this._bitmap.height}),He(0,Ha,"skin",function(){return this._skin},function(Ha){if(this._skin!=Ha)if(Hs.clearCache(this,this._skin),this._skin=Ha){Hs.keepCache(this,this._skin);var Hb=Hs.getRes(Ha);Hb?(this.source=Hb,this.onCompResize()):Hp.loader.load(this._skin,Hm.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),He(0,Ha,"group",function(){return this._group},function(Ha){Ha&&this._skin&&Hs.setGroup(this._skin,Ha),this._group=Ha}),He(0,Ha,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Ha){this._bitmap.sizeGrid=HC.fillArray(HB.defaultSizeGrid,Ha,Number)}),He(0,Ha,"measureWidth",function(){return this._bitmap.width}),He(0,Ha,"width",Hb.prototype._$get_width,function(Ha){Hp.superSet(HF,this,"width",Ha),this._bitmap.width=0==Ha?1e-7:Ha}),He(0,Ha,"height",Hb.prototype._$get_height,function(Ha){Hp.superSet(HF,this,"height",Ha),this._bitmap.height=0==Ha?1e-7:Ha}),Hc}(HF),HP=function(Hb){function Hc(Ha){this._tf=null,Hc.__super.call(this),void 0===Ha&&(Ha=""),Hj.defaultColor=HB.labelColor,this.text=Ha}Hf(Hc,"laya.ui.Label",Hb);var Ha=Hc.prototype;return Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,Ha),this._tf=null},Ha.createChildren=function(){this.addChild(this._tf=new Hv)},Ha.changeText=function(Ha){this._tf.changeText(Ha)},He(0,Ha,"padding",function(){return this._tf.padding.join(",")},function(Ha){this._tf.padding=HC.fillArray(HB.labelPadding,Ha,Number)}),He(0,Ha,"bold",function(){return this._tf.bold},function(Ha){this._tf.bold=Ha}),He(0,Ha,"align",function(){return this._tf.align},function(Ha){this._tf.align=Ha}),He(0,Ha,"text",function(){return this._tf.text},function(Ha){this._tf.text!=Ha&&(Ha&&(Ha=HC.adptString(Ha+"")),this._tf.text=Ha,this.event("change"),this._width&&this._height||this.onCompResize())}),He(0,Ha,"italic",function(){return this._tf.italic},function(Ha){this._tf.italic=Ha}),He(0,Ha,"wordWrap",function(){return this._tf.wordWrap},function(Ha){this._tf.wordWrap=Ha}),He(0,Ha,"font",function(){return this._tf.font},function(Ha){this._tf.font=Ha}),He(0,Ha,"dataSource",Hb.prototype._$get_dataSource,function(Ha){"number"==typeof(this._dataSource=Ha)||"string"==typeof Ha?this.text=Ha+"":Hp.superSet(HF,this,"dataSource",Ha)}),He(0,Ha,"color",function(){return this._tf.color},function(Ha){this._tf.color=Ha}),He(0,Ha,"valign",function(){return this._tf.valign},function(Ha){this._tf.valign=Ha}),He(0,Ha,"leading",function(){return this._tf.leading},function(Ha){this._tf.leading=Ha}),He(0,Ha,"fontSize",function(){return this._tf.fontSize},function(Ha){this._tf.fontSize=Ha}),He(0,Ha,"bgColor",function(){return this._tf.bgColor},function(Ha){this._tf.bgColor=Ha}),He(0,Ha,"borderColor",function(){return this._tf.borderColor},function(Ha){this._tf.borderColor=Ha}),He(0,Ha,"stroke",function(){return this._tf.stroke},function(Ha){this._tf.stroke=Ha}),He(0,Ha,"strokeColor",function(){return this._tf.strokeColor},function(Ha){this._tf.strokeColor=Ha}),He(0,Ha,"textField",function(){return this._tf}),He(0,Ha,"measureWidth",function(){return this._tf.width}),He(0,Ha,"measureHeight",function(){return this._tf.height}),He(0,Ha,"width",function(){return this._width||this._tf.text?Hp.superGet(HF,this,"width"):0},function(Ha){Hp.superSet(HF,this,"width",Ha),this._tf.width=Ha}),He(0,Ha,"height",function(){return this._height||this._tf.text?Hp.superGet(HF,this,"height"):0},function(Ha){Hp.superSet(HF,this,"height",Ha),this._tf.height=Ha}),He(0,Ha,"overflow",function(){return this._tf.overflow},function(Ha){this._tf.overflow=Ha}),He(0,Ha,"underline",function(){return this._tf.underline},function(Ha){this._tf.underline=Ha}),He(0,Ha,"underlineColor",function(){return this._tf.underlineColor},function(Ha){this._tf.underlineColor=Ha}),Hc}(HF),HQ=function(Hb){function Hc(Ha){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,Hc.__super.call(this),this.skin=Ha}Hf(Hc,"laya.ui.ProgressBar",Hb);var Ha=Hc.prototype;return Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,Ha),this._bg&&this._bg.destroy(Ha),this._bar&&this._bar.destroy(Ha),this._bg=this._bar=null,this.changeHandler=null},Ha.createChildren=function(){this.addChild(this._bg=new HO),this.addChild(this._bar=new HO)},Ha.changeValue=function(){if(this.sizeGrid){var Ha=this.sizeGrid.split(","),Hb=Number(Ha[3]),Hc=Number(Ha[1]),Hd=(this.width-Hb-Hc)*this._value;this._bar.width=Hb+Hc+Hd,this._bar.visible=this._bar.width>Hb+Hc}else this._bar.width=this.width*this._value},He(0,Ha,"measureHeight",function(){return this._bg.height}),He(0,Ha,"skin",function(){return this._skin},function(Ha){this._skin!=Ha&&(this._skin=Ha,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),He(0,Ha,"measureWidth",function(){return this._bg.width}),He(0,Ha,"height",Hb.prototype._$get_height,function(Ha){Hp.superSet(HF,this,"height",Ha),this._bg.height=this._height,this._bar.height=this._height}),He(0,Ha,"bar",function(){return this._bar}),He(0,Ha,"value",function(){return this._value},function(Ha){this._value!=Ha&&(Ha=1<Ha?1:Ha<0?0:Ha,this._value=Ha,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(Ha))}),He(0,Ha,"bg",function(){return this._bg}),He(0,Ha,"sizeGrid",function(){return this._bg.sizeGrid},function(Ha){this._bg.sizeGrid=this._bar.sizeGrid=Ha}),He(0,Ha,"width",Hb.prototype._$get_width,function(Ha){Hp.superSet(HF,this,"width",Ha),this._bg.width=this._width,this.callLater(this.changeValue)}),He(0,Ha,"dataSource",Hb.prototype._$get_dataSource,function(Ha){"number"==typeof(this._dataSource=Ha)||"string"==typeof Ha?this.value=Number(Ha):Hp.superSet(HF,this,"dataSource",Ha)}),Hc}(HF),HR=(function(Ha){function Hc(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,Hc.__super.call(this),this._tipBox=new HF,this._tipBox.addChild(this._tipText=new Hv),this._tipText.x=this._tipText.y=5,this._tipText.color=Hc.tipTextColor,this._defaultTipHandler=this._showDefaultTip,Hp.stage.on("showtip",this,this._onStageShowTip),Hp.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}Hf(Hc,"laya.ui.TipManager",HF);var Hb=Hc.prototype;Hb._onStageHideTip=function(Ha){Hp.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},Hb._onStageShowTip=function(Ha){Hp.timer.once(Hc.tipDelay,this,this._showTip,[Ha],!0)},Hb._showTip=function(Ha){if("string"==typeof Ha){var Hb=String(Ha);Boolean(Hb)&&this._defaultTipHandler(Hb)}else Ha instanceof laya.utils.Handler?Ha.run():"function"==typeof Ha&&Ha.apply();Hp.stage.on("mousemove",this,this._onStageMouseMove),Hp.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},Hb._onStageMouseDown=function(Ha){this.closeAll()},Hb._onStageMouseMove=function(Ha){this._showToStage(this,Hc.offsetX,Hc.offsetY)},Hb._showToStage=function(Ha,Hb,Hc){void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0);var Hd=Ha.getBounds();Ha.x=Hp.stage.mouseX+Hb,Ha.y=Hp.stage.mouseY+Hc,Ha.x+Hd.width>Hp.stage.width&&(Ha.x-=Hd.width+Hb),Ha.y+Hd.height>Hp.stage.height&&(Ha.y-=Hd.height+Hc)},Hb.closeAll=function(){Hp.timer.clear(this,this._showTip),Hp.stage.off("mousemove",this,this._onStageMouseMove),Hp.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},Hb.showDislayTip=function(Ha){this.addChild(Ha),this._showToStage(this),Hp._currentStage.addChild(this)},Hb._showDefaultTip=function(Ha){this._tipText.text=Ha;var Hb=this._tipBox.graphics;Hb.clear(),Hb.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,Hc.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),Hp._currentStage.addChild(this)},He(0,Hb,"defaultTipHandler",function(){return this._defaultTipHandler},function(Ha){this._defaultTipHandler=Ha}),Hc.offsetX=10,Hc.offsetY=15,Hc.tipTextColor="#ffffff",Hc.tipBackColor="#111111",Hc.tipDelay=200}(),function(Ha){var Hn;function Ho(){this._idMap=null,this._aniList=null,this._watchMap={},Ho.__super.call(this)}Hf(Ho,"laya.ui.View",HH);var Hb=Ho.prototype;return Hb.createView=function(Ha){if(Ha.animations&&!this._idMap&&(this._idMap={}),Ho.createComp(Ha,this,this),Ha.animations){var Hb,Hc,Hd=[],He=Ha.animations,Hf=0,Hg=He.length;for(Hf=0;Hf<Hg;Hf++){switch(Hb=new Hk,Hc=He[Hf],Hb._setUp(this._idMap,Hc),(this[Hc.name]=Hb)._setControlNode(this),Hc.action){case 1:Hb.play(0,!1);break;case 2:Hb.play(0,!0)}Hd.push(Hb)}this._aniList=Hd}0<this._width&&null==Ha.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},Hb.onEvent=function(Ha,Hb){},Hb.loadUI=function(Ha){var Hb=Ho.uiMap[Ha];Hb&&this.createView(Hb)},Hb.destroy=function(Ha){void 0===Ha&&(Ha=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,Ha)},Hb.changeData=function(Ha){var Hb=this._watchMap[Ha];if(Hb){console.log("change",Ha);for(var Hc=0,Hd=Hb.length;Hc<Hd;Hc++){Hb[Hc].exe(this)}}},Ho._regs=function(){for(var Ha in Ho.uiClassMap)Hq.regClass(Ha,Ho.uiClassMap[Ha])},Ho.createComp=function(Ha,Hb,Hc,Hd){if(!(Hb=Hb||Ho.getCompInstance(Ha)))return console.warn("can not create:"+Ha.type),null;var He=Ha.child;if(He)for(var Hf=Hb instanceof laya.ui.List,Hg=0,Hh=He.length;Hg<Hh;Hg++){var Hi=He[Hg];if(!Hb.hasOwnProperty("itemRender")||"render"!=Hi.props.name&&"render"!==Hi.props.renderType)if("Graphic"==Hi.type)Hq.addGraphicsToSprite(Hi,Hb);else if(Hq.isDrawType(Hi.type))Hq.addGraphicToSprite(Hi,Hb,!0);else{if(Hf){var Hj=[],Hk=Ho.createComp(Hi,null,Hc,Hj);Hj.length&&(Hk._$bindData=Hj)}else Hk=Ho.createComp(Hi,null,Hc,Hd);"Script"==Hi.type?"owner"in Hk?Hk.owner=Hb:"target"in Hk&&(Hk.target=Hb):"mask"==Hi.props.renderType||"mask"==Hi.props.name?Hb.mask=Hk:Hk instanceof laya.display.Sprite&&Hb.addChild(Hk)}else Hb.itemRender=Hi}var Hl=Ha.props;for(var Hm in Hl){var Hn=Hl[Hm];Ho.eventDic[Hm]?Hn&&Hc&&Hb.on(Hm,Hc,Hc.onEvent,[Hn]):Ho.setCompValue(Hb,Hm,Hn,Hc,Hd)}return Hp.__typeof(Hb,"laya.ui.IItem")&&Hb.initItems(),Ha.compId&&Hc&&Hc._idMap&&(Hc._idMap[Ha.compId]=Hb),Hb},Ho.setCompValue=function(Ha,Hb,Hc,Hd,He){if("string"==typeof Hc&&-1<Hc.indexOf("${")){if(Ho._sheet||(Ho._sheet=Hq.getClass("laya.data.Table")),!Ho._sheet)return void console.warn("Can not find class Sheet");if(He)He.push(Ha,Hb,Hc);else if(Hd){-1==Hc.indexOf("].")&&(Hc=Hc.replace(".","[0]."));var Hf,Hg,Hh=new Hn(Ha,Hb,Hc);Hh.exe(Hd);for(var Hi=Hc.replace(/\[.*?\]\./g,".");null!=(Hf=Ho._parseWatchData.exec(Hi));){for(var Hj=Hf[1];null!=(Hg=Ho._parseKeyWord.exec(Hj));){var Hk=Hg[0],Hl=Hd._watchMap[Hk]||(Hd._watchMap[Hk]=[]);Hl.push(Hh),Ho._sheet.I.notifer.on(Hk,Hd,Hd.changeData,[Hk])}(Hl=Hd._watchMap[Hj]||(Hd._watchMap[Hj]=[])).push(Hh),Ho._sheet.I.notifer.on(Hj,Hd,Hd.changeData,[Hj])}}}else if("var"===Hb&&Hd)Hd[Hc]=Ha;else if("onClick"==Hb){var Hm=Hp._runScript("(function(){"+Hc+"})");Ha.on("click",Hd,Hm)}else Ha[Hb]="true"===Hc||"false"!==Hc&&Hc},Ho.getCompInstance=function(Ha){var Hb,Hc=Ha.props?Ha.props.runtime:null;return Hb=Hc?Ho.viewClassMap[Hc]||Ho.uiClassMap[Hc]||Hp.__classmap[Hc]:Ho.uiClassMap[Ha.type],Ha.props&&Ha.props.hasOwnProperty("renderType")&&"instance"==Ha.props.renderType?Hb.instance:Hb?new Hb:null},Ho.regComponent=function(Ha,Hb){Ho.uiClassMap[Ha]=Hb,Hq.regClass(Ha,Hb)},Ho.regViewRuntime=function(Ha,Hb){Ho.viewClassMap[Ha]=Hb},Ho.uiMap={},Ho.viewClassMap={},Ho._sheet=null,Hd(Ho,["uiClassMap",function(){return this.uiClassMap={ViewStack:Haa,LinkButton:HI,TextArea:Hja,ColorPicker:HK,Box:HH,Button:HI,CheckBox:HS,Clip:HJ,ComboBox:HL,Component:HF,HScrollBar:HW,HSlider:HY,Image:HO,Label:HP,List:HV,Panel:HX,ProgressBar:HQ,Radio:H$,RadioGroup:Hha,ScrollBar:HM,Slider:HN,Tab:Hia,TextInput:Hca,View:Ho,VScrollBar:Hba,VSlider:Hda,Tree:H_,HBox:Hfa,VBox:Hga,Sprite:Hu,Animation:Hc,Text:Hv,FontClip:HU}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),Ho.__init$=function(){Ho._regs(),Hn=function(){function Ha(Ha,Hb,Hc){this.comp=null,this.prop=null,this.value=null,this.comp=Ha,this.prop=Hb,this.value=Hc}return Hf(Ha,""),Ha.prototype.exe=function(Ha){var Hb=HC.getBindFun(this.value);this.comp[this.prop]=Hb.call(this,Ha)},Ha}()},Ho}()),HS=function(Ha){function Hc(Ha,Hb){void 0===Hb&&(Hb=""),Hc.__super.call(this,Ha,Hb)}Hf(Hc,"laya.ui.CheckBox",Ha);var Hb=Hc.prototype;return Hb.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},Hb.initialize=function(){Ha.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},He(0,Hb,"dataSource",Ha.prototype._$get_dataSource,function(Ha){"boolean"==typeof(this._dataSource=Ha)?this.selected=Ha:"string"==typeof Ha?this.selected="true"===Ha:Hp.superSet(HI,this,"dataSource",Ha)}),Hc}(HI),HT=function(Ha){function Hb(){this._space=0,this._align="none",this._itemChanged=!1,Hb.__super.call(this)}Hf(Hb,"laya.ui.LayoutBox",HH);var Hc=Hb.prototype;return Hc.addChild=function(Ha){return Ha.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,Ha)},Hc.onResize=function(Ha){this._setItemChanged()},Hc.addChildAt=function(Ha,Hb){return Ha.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,Ha,Hb)},Hc.removeChild=function(Ha){return Ha.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,Ha)},Hc.removeChildAt=function(Ha){return this.getChildAt(Ha).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,Ha)},Hc.refresh=function(){this._setItemChanged()},Hc.changeItems=function(){this._itemChanged=!1},Hc.sortItem=function(Ha){Ha&&Ha.sort(function(Ha,Hb){return Ha.y-Hb.y})},Hc._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},He(0,Hc,"space",function(){return this._space},function(Ha){this._space=Ha,this._setItemChanged()}),He(0,Hc,"align",function(){return this._align},function(Ha){this._align=Ha,this._setItemChanged()}),Hb}(),HU=function(Hb){function Hc(Ha,Hb){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,Hc.__super.call(this),Ha&&(this.skin=Ha),Hb&&(this.sheet=Hb)}Hf(Hc,"laya.ui.FontClip",Hb);var Ha=Hc.prototype;return Ha.createChildren=function(){this._bitmap=new HE,this.on("loaded",this,this._onClipLoaded)},Ha._onClipLoaded=function(){this.callLater(this.changeValue)},Ha.changeValue=function(){var Ha;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),Ha=this._sources[0]))){var Hb="horizontal"===this._direction;Hb?(this._wordsW=this._valueArr.length*(Ha.sourceWidth+this.spaceX),this._wordsH=Ha.sourceHeight):(this._wordsW=Ha.sourceWidth,this._wordsH=(Ha.sourceHeight+this.spaceY)*this._valueArr.length);var Hc=0;if(this._width)switch(this._align){case"center":Hc=.5*(this._width-this._wordsW);break;case"right":Hc=this._width-this._wordsW;break;default:Hc=0}for(var Hd=0,He=this._valueArr.length;Hd<He;Hd++){var Hf=this._indexMap[this._valueArr.charAt(Hd)];this.sources[Hf]&&(Ha=this.sources[Hf],Hb?this.graphics.drawTexture(Ha,Hc+Hd*(Ha.sourceWidth+this.spaceX),0,Ha.sourceWidth,Ha.sourceHeight):this.graphics.drawTexture(Ha,0+Hc,Hd*(Ha.sourceHeight+this.spaceY),Ha.sourceWidth,Ha.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),Hb.prototype.destroy.call(this,Ha)},He(0,Ha,"sheet",function(){return this._sheet},function(Ha){Ha+="";var Hb=(this._sheet=Ha).split(" ");this._clipX=String(Hb[0]).length,this.clipY=Hb.length,this._indexMap={};for(var Hc=0;Hc<this._clipY;Hc++)for(var Hd=Hb[Hc].split(""),He=0,Hf=Hd.length;He<Hf;He++)this._indexMap[Hd[He]]=Hc*this._clipX+He}),He(0,Ha,"height",Hb.prototype._$get_height,function(Ha){Hp.superSet(HJ,this,"height",Ha),this.callLater(this.changeValue)}),He(0,Ha,"direction",function(){return this._direction},function(Ha){this._direction=Ha,this.callLater(this.changeValue)}),He(0,Ha,"value",function(){return this._valueArr?this._valueArr:""},function(Ha){Ha+="",this._valueArr=Ha,this.callLater(this.changeValue)}),He(0,Ha,"width",Hb.prototype._$get_width,function(Ha){Hp.superSet(HJ,this,"width",Ha),this.callLater(this.changeValue)}),He(0,Ha,"spaceX",function(){return this._spaceX},function(Ha){this._spaceX=Ha,"horizontal"===this._direction&&this.callLater(this.changeValue)}),He(0,Ha,"spaceY",function(){return this._spaceY},function(Ha){this._spaceY=Ha,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),He(0,Ha,"align",function(){return this._align},function(Ha){this._align=Ha,this.callLater(this.changeValue)}),He(0,Ha,"measureWidth",function(){return this._wordsW}),He(0,Ha,"measureHeight",function(){return this._wordsH}),Hc}(HJ),HV=function(Ha){function Hb(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new Ho,Hb.__super.call(this)}Hf(Hb,"laya.ui.List",Ha);var Hc=Hb.prototype;return Hp.imps(Hc,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),Hc.destroy=function(Ha){void 0===Ha&&(Ha=!0),this._content&&this._content.destroy(Ha),this._scrollBar&&this._scrollBar.destroy(Ha),laya.ui.Component.prototype.destroy.call(this,Ha),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},Hc.createChildren=function(){this.addChild(this._content=new HH)},Hc.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=Hp.superGet(HH,this,"cacheAs")),Hp.superSet(HH,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},Hc.onScrollEnd=function(){Hp.superSet(HH,this,"cacheAs",this._$P.cacheAs)},Hc._removePreScrollBar=function(){var Ha=this.removeChildByName("scrollBar");Ha&&Ha.destroy(!0)},Hc.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var Ha=this._getOneCell(),Hb=Ha.width+this._spaceX||1,Hc=Ha.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/Hb):Math.ceil(this._width/Hb)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/Hc):Math.round(this._height/Hc));var Hd=this._width?this._width:Hb*this.repeatX-this._spaceX,He=this._height?this._height:Hc*this.repeatY-this._spaceY;this._cellSize=this._isVertical?Hc:Hb,this._cellOffset=this._isVertical?Hc*Math.max(this._repeatY2,this._repeatY)-He-this._spaceY:Hb*Math.max(this._repeatX2,this._repeatX)-Hd-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=He:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=Hd),this.setContentSize(Hd,He);var Hf=this._isVertical?this.repeatX:this.repeatY,Hg=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,Hf,Hg),this._createdLine=Hg,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},Hc._getOneCell=function(){if(0===this._cells.length){var Ha=this.createItem();if(this._offset.setTo(Ha.x,Ha.y),this.cacheContent)return Ha;this._cells.push(Ha)}return this._cells[0]},Hc._createItems=function(Ha,Hb,Hc){var Hd=this._content,He=this._getOneCell(),Hf=He.width+this._spaceX,Hg=He.height+this._spaceY;if(this.cacheContent){var Hh=new HH;Hh.cacheAsBitmap=!0,Hh.pos((this._isVertical?0:Ha)*Hf,(this._isVertical?Ha:0)*Hg),this._content.addChild(Hh),this._content.optimizeScrollRect=!0,Hd=Hh}else{for(var Hi=[],Hj=this._cells.length-1;-1<Hj;Hj--){var Hk=this._cells[Hj];Hk.removeSelf(),Hi.push(Hk)}this._cells.length=0}for(var Hl=Ha;Hl<Hc;Hl++)for(var Hm=0;Hm<Hb;Hm++)(He=Hi&&Hi.length?Hi.pop():this.createItem()).x=(this._isVertical?Hm:Hl)*Hf-Hd.x,He.y=(this._isVertical?Hl:Hm)*Hg-Hd.y,He.name="item"+(Hl*Hb+Hm),Hd.addChild(He),this.addCell(He)},Hc.createItem=function(){var Ha=[];if("function"==typeof this._itemRender)var Hb=new this._itemRender;else Hb=HR.createComp(this._itemRender,null,null,Ha);if(0==Ha.length&&Hb._watchMap){var Hc=Hb._watchMap;for(var Hd in Hc)for(var He=Hc[Hd],Hf=0;Hf<He.length;Hf++){var Hg=He[Hf];Ha.push(Hg.comp,Hg.prop,Hg.value)}}return Ha.length&&(Hb._$bindData=Ha),Hb},Hc.addCell=function(Ha){Ha.on("click",this,this.onCellMouse),Ha.on("rightclick",this,this.onCellMouse),Ha.on("mouseover",this,this.onCellMouse),Ha.on("mouseout",this,this.onCellMouse),Ha.on("mousedown",this,this.onCellMouse),Ha.on("mouseup",this,this.onCellMouse),this._cells.push(Ha)},Hc.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var Ha=0,Hb=Ha=0;Hb<1e4;Hb++){var Hc=this.getChildByName("item"+Hb);if(!Hc)break;this.addCell(Hc),Ha++}this.repeatY=Ha}},Hc.setContentSize=function(Ha,Hb){this._content.width=Ha,this._content.height=Hb,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new Hr),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,Ha,Hb),this._content.scrollRect=this._content.scrollRect),this.event("resize")},Hc.onCellMouse=function(Ha){"mousedown"===Ha.type&&(this._isMoved=!1);var Hb=Ha.currentTarget,Hc=this._startIndex+this._cells.indexOf(Hb);Hc<0||("click"===Ha.type||"rightclick"===Ha.type?this.selectEnable&&!this._isMoved?this.selectedIndex=Hc:this.changeCellState(Hb,!0,0):"mouseover"!==Ha.type&&"mouseout"!==Ha.type||this._selectedIndex===Hc||this.changeCellState(Hb,"mouseover"===Ha.type,0),this.mouseHandler&&this.mouseHandler.runWith([Ha,Hc]))},Hc.changeCellState=function(Ha,Hb,Hc){var Hd=Ha.getChildByName("selectBox");Hd&&(this.selectEnable=!0,Hd.visible=Hb,Hd.index=Hc)},Hc.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},Hc.onScrollBarChange=function(Ha){this.runCallLater(this.changeCells);var Hb=this._scrollBar.value,Hc=this._isVertical?this.repeatX:this.repeatY,Hd=this._isVertical?this.repeatY:this.repeatX,He=Math.floor(Hb/this._cellSize);if(this.cacheContent)Hg=Hd+1,this._createdLine-He<Hg&&(this._createItems(this._createdLine,Hc,this._createdLine+Hg),this.renderItems(this._createdLine*Hc,0),this._createdLine+=Hg);else{var Hf=He*Hc,Hg=0;if(Hf>this._startIndex){Hg=Hf-this._startIndex;var Hh=!0,Hi=this._startIndex+Hc*(Hd+1);this._isMoved=!0}else Hf<this._startIndex&&(Hg=this._startIndex-Hf,Hh=!1,Hi=this._startIndex-1,this._isMoved=!0);for(var Hj=0;Hj<Hg;Hj++){if(Hh){var Hk=this._cells.shift();this._cells[this._cells.length]=Hk;var Hl=Hi+Hj}else Hk=this._cells.pop(),this._cells.unshift(Hk),Hl=Hi-Hj;var Hm=Math.floor(Hl/Hc)*this._cellSize;this._isVertical?Hk.y=Hm:Hk.x=Hm,this.renderItem(Hk,Hl)}this._startIndex=Hf,this.changeSelectStatus()}var Hn=this._content.scrollRect;this._isVertical?(Hn.y=Hb-this._offset.y,Hn.x=-this._offset.x):(Hn.y=-this._offset.y,Hn.x=Hb-this._offset.x),this._content.scrollRect=Hn},Hc.posCell=function(Ha,Hb){if(this._scrollBar){var Hc=this._isVertical?this.repeatX:this.repeatY,Hd=(this._isVertical?this.repeatY:this.repeatX,Math.floor(Hb/Hc)*this._cellSize);this._isVertical?Ha.y=Hd:Ha.x=Hd}},Hc.changeSelectStatus=function(){for(var Ha=0,Hb=this._cells.length;Ha<Hb;Ha++)this.changeCellState(this._cells[Ha],this._selectedIndex===this._startIndex+Ha,1)},Hc.renderItems=function(Ha,Hb){void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0);for(var Hc=Ha,Hd=Hb||this._cells.length;Hc<Hd;Hc++)this.renderItem(this._cells[Hc],this._startIndex+Hc);this.changeSelectStatus()},Hc.renderItem=function(Ha,Hb){this._array&&0<=Hb&&Hb<this._array.length?(Ha.visible=!0,Ha._$bindData?(Ha._dataSource=this._array[Hb],this._bindData(Ha,this._array[Hb])):Ha.dataSource=this._array[Hb],this.cacheContent||this.posCell(Ha,Hb),this.hasListener("render")&&this.event("render",[Ha,Hb]),this.renderHandler&&this.renderHandler.runWith([Ha,Hb])):(Ha.visible=!1,Ha.dataSource=null)},Hc._bindData=function(Ha,Hb){for(var Hc=Ha._$bindData,Hd=0,He=Hc.length;Hd<He;Hd++){var Hf=Hc[Hd++],Hg=Hc[Hd++],Hh=Hc[Hd],Hi=HC.getBindFun(Hh);Hf[Hg]=Hi.call(this,Hb)}},Hc.refresh=function(){this.array=this._array},Hc.getItem=function(Ha){return-1<Ha&&Ha<this._array.length?this._array[Ha]:null},Hc.changeItem=function(Ha,Hb){-1<Ha&&Ha<this._array.length&&(this._array[Ha]=Hb,Ha>=this._startIndex&&Ha<this._startIndex+this._cells.length&&this.renderItem(this.getCell(Ha),Ha))},Hc.setItem=function(Ha,Hb){this.changeItem(Ha,Hb)},Hc.addItem=function(Ha){this._array.push(Ha),this.array=this._array},Hc.addItemAt=function(Ha,Hb){this._array.splice(Hb,0,Ha),this.array=this._array},Hc.deleteItem=function(Ha){this._array.splice(Ha,1),this.array=this._array},Hc.getCell=function(Ha){return this.runCallLater(this.changeCells),-1<Ha&&this._cells?this._cells[(Ha-this._startIndex)%this._cells.length]:null},Hc.scrollTo=function(Ha){if(this._scrollBar){var Hb=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(Ha/Hb)*this._cellSize}else this.startIndex=Ha},Hc.tweenTo=function(Ha,Hb,Hc){if(void 0===Hb&&(Hb=200),this._scrollBar){var Hd=this._isVertical?this.repeatX:this.repeatY;Hx.to(this._scrollBar,{value:Math.floor(Ha/Hd)*this._cellSize},Hb,null,Hc,0,!0)}else this.startIndex=Ha,Hc&&Hc.run()},Hc._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},Hc.commitMeasure=function(){this.runCallLater(this.changeCells)},He(0,Hc,"cacheAs",Ha.prototype._$get_cacheAs,function(Ha){Hp.superSet(HH,this,"cacheAs",Ha),this._scrollBar&&(this._$P.cacheAs=null,"none"!==Ha?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),He(0,Hc,"content",function(){return this._content}),He(0,Hc,"height",Ha.prototype._$get_height,function(Ha){Ha!=this._height&&(Hp.superSet(HH,this,"height",Ha),this._setCellChanged())}),He(0,Hc,"itemRender",function(){return this._itemRender},function(Ha){if(this._itemRender!=Ha){this._itemRender=Ha;for(var Hb=this._cells.length-1;-1<Hb;Hb--)this._cells[Hb].destroy();this._cells.length=0,this._setCellChanged()}}),He(0,Hc,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(Ha){this._removePreScrollBar();var Hb=new Hba;Hb.name="scrollBar",Hb.right=0,Ha&&" "!=Ha&&(Hb.skin=Ha),this.scrollBar=Hb,this.addChild(Hb),this._setCellChanged()}),He(0,Hc,"page",function(){return this._page},function(Ha){this._page=Ha,this._array&&(this._page=0<Ha?Ha:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),He(0,Hc,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(Ha){this._removePreScrollBar();var Hb=new HW;Hb.name="scrollBar",Hb.bottom=0,Ha&&" "!=Ha&&(Hb.skin=Ha),this.scrollBar=Hb,this.addChild(Hb),this._setCellChanged()}),He(0,Hc,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(Ha){this._repeatX=Ha,this._setCellChanged()}),He(0,Hc,"scrollBar",function(){return this._scrollBar},function(Ha){this._scrollBar!=Ha&&(this._scrollBar=Ha)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),He(0,Hc,"width",Ha.prototype._$get_width,function(Ha){Ha!=this._width&&(Hp.superSet(HH,this,"width",Ha),this._setCellChanged())}),He(0,Hc,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(Ha){this._repeatY=Ha,this._setCellChanged()}),He(0,Hc,"spaceX",function(){return this._spaceX},function(Ha){this._spaceX=Ha,this._setCellChanged()}),He(0,Hc,"spaceY",function(){return this._spaceY},function(Ha){this._spaceY=Ha,this._setCellChanged()}),He(0,Hc,"selectedIndex",function(){return this._selectedIndex},function(Ha){this._selectedIndex!=Ha&&(this._selectedIndex=Ha,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(Ha),this.startIndex=this._startIndex)}),He(0,Hc,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(Ha){this.selectedIndex=this._array.indexOf(Ha)}),He(0,Hc,"length",function(){return this._array?this._array.length:0}),He(0,Hc,"selection",function(){return this.getCell(this._selectedIndex)},function(Ha){this.selectedIndex=this._startIndex+this._cells.indexOf(Ha)}),He(0,Hc,"startIndex",function(){return this._startIndex},function(Ha){this._startIndex=0<Ha?Ha:0,this.callLater(this.renderItems)}),He(0,Hc,"array",function(){return this._array},function(Ha){this.runCallLater(this.changeCells),this._array=Ha||[];var Hb=this._array.length;if(this.totalPage=Math.ceil(Hb/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<Hb?this._selectedIndex:Hb-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var Hc=this._isVertical?this.repeatX:this.repeatY,Hd=this._isVertical?this.repeatY:this.repeatX,He=Math.ceil(Hb/Hc);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=Hd/He,this._scrollBar.setScroll(0,(He-Hd)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),He(0,Hc,"dataSource",Ha.prototype._$get_dataSource,function(Ha){"number"==typeof(this._dataSource=Ha)&&Math.floor(Ha)==Ha||"string"==typeof Ha?this.selectedIndex=parseInt(Ha):Ha instanceof Array?this.array=Ha:Hp.superSet(HH,this,"dataSource",Ha)}),He(0,Hc,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),Hb}(HH),HW=function(Ha){function Hb(){Hb.__super.call(this)}return Hf(Hb,"laya.ui.HScrollBar",Ha),Hb.prototype.initialize=function(){Ha.prototype.initialize.call(this),this.slider.isVertical=!1},Hb}(HM),HX=function(Ha){function Hb(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,Hb.__super.call(this),this.width=this.height=100}Hf(Hb,"laya.ui.Panel",Ha);var Hc=Hb.prototype;return Hc.destroy=function(Ha){void 0===Ha&&(Ha=!0),laya.ui.Component.prototype.destroy.call(this,Ha),this._content&&this._content.destroy(Ha),this._vScrollBar&&this._vScrollBar.destroy(Ha),this._hScrollBar&&this._hScrollBar.destroy(Ha),this._vScrollBar=null,this._hScrollBar=null,this._content=null},Hc.destroyChildren=function(){this._content.destroyChildren()},Hc.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new HH)},Hc.addChild=function(Ha){return Ha.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(Ha)},Hc.onResize=function(){this._setScrollChanged()},Hc.addChildAt=function(Ha,Hb){return Ha.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(Ha,Hb)},Hc.removeChild=function(Ha){return Ha.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(Ha)},Hc.removeChildAt=function(Ha){return this.getChildAt(Ha).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(Ha)},Hc.removeChildren=function(Ha,Hb){return void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=2147483647),this._content.removeChildren(Ha,Hb),this._setScrollChanged(),this},Hc.getChildAt=function(Ha){return this._content.getChildAt(Ha)},Hc.getChildByName=function(Ha){return this._content.getChildByName(Ha)},Hc.getChildIndex=function(Ha){return this._content.getChildIndex(Ha)},Hc.changeScroll=function(){this._scrollChanged=!1;var Ha=this.contentWidth||1,Hb=this.contentHeight||1,Hc=this._vScrollBar,Hd=this._hScrollBar,He=Hc&&Hb>this._height,Hf=Hd&&Ha>this._width,Hg=He?this._width-Hc.width:this._width,Hh=Hf?this._height-Hd.height:this._height;Hc&&(Hc.x=this._width-Hc.width,Hc.y=0,Hc.height=this._height-(Hf?Hd.height:0),Hc.scrollSize=Math.max(.033*this._height,1),Hc.thumbPercent=Hh/Hb,Hc.setScroll(0,Hb-Hh,Hc.value)),Hd&&(Hd.x=0,Hd.y=this._height-Hd.height,Hd.width=this._width-(He?Hc.width:0),Hd.scrollSize=Math.max(.033*this._width,1),Hd.thumbPercent=Hg/Ha,Hd.setScroll(0,Ha-Hg,Hd.value))},Hc.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},Hc.setContentSize=function(Ha,Hb){var Hc=this._content;Hc.width=Ha,Hc.height=Hb,Hc.scrollRect||(Hc.scrollRect=new Hr),Hc.scrollRect.setTo(0,0,Ha,Hb),Hc.scrollRect=Hc.scrollRect},Hc.onScrollBarChange=function(Ha){var Hb=this._content.scrollRect;if(Hb){var Hc=Math.round(Ha.value);Ha.isVertical?Hb.y=Hc:Hb.x=Hc,this._content.scrollRect=Hb}},Hc.scrollTo=function(Ha,Hb){void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),this.vScrollBar&&(this.vScrollBar.value=Hb),this.hScrollBar&&(this.hScrollBar.value=Ha)},Hc.refresh=function(){this.changeScroll()},Hc.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=Hp.superGet(HH,this,"cacheAs")),Hp.superSet(HH,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},Hc.onScrollEnd=function(){Hp.superSet(HH,this,"cacheAs",this._$P.cacheAs)},Hc._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},He(0,Hc,"numChildren",function(){return this._content.numChildren}),He(0,Hc,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(Ha){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new HW),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=Ha}),He(0,Hc,"contentWidth",function(){for(var Ha=0,Hb=this._content.numChildren-1;-1<Hb;Hb--){var Hc=this._content.getChildAt(Hb);Ha=Math.max(Hc.x+Hc.width*Hc.scaleX,Ha)}return Ha}),He(0,Hc,"contentHeight",function(){for(var Ha=0,Hb=this._content.numChildren-1;-1<Hb;Hb--){var Hc=this._content.getChildAt(Hb);Ha=Math.max(Hc.y+Hc.height*Hc.scaleY,Ha)}return Ha}),He(0,Hc,"width",Ha.prototype._$get_width,function(Ha){Hp.superSet(HH,this,"width",Ha),this._setScrollChanged()}),He(0,Hc,"hScrollBar",function(){return this._hScrollBar}),He(0,Hc,"content",function(){return this._content}),He(0,Hc,"height",Ha.prototype._$get_height,function(Ha){Hp.superSet(HH,this,"height",Ha),this._setScrollChanged()}),He(0,Hc,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(Ha){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new Hba),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=Ha}),He(0,Hc,"vScrollBar",function(){return this._vScrollBar}),He(0,Hc,"cacheAs",Ha.prototype._$get_cacheAs,function(Ha){Hp.superSet(HH,this,"cacheAs",Ha),this._$P.cacheAs=null,"none"!==Ha?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),Hb}(HH),HY=function(Ha){function Hb(Ha){Hb.__super.call(this,Ha),this.isVertical=!1}return Hf(Hb,"laya.ui.HSlider",HN),Hb}(),HZ=function(Ha){function Hc(Ha,Hb){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,Hc.__super.call(this),this.skin=Hb,this.labels=Ha}Hf(Hc,"laya.ui.UIGroup",Ha);var Hb=Hc.prototype;return Hp.imps(Hb,{"laya.ui.IItem":!0}),Hb.preinitialize=function(){this.mouseEnabled=!0},Hb.destroy=function(Ha){void 0===Ha&&(Ha=!0),laya.ui.Component.prototype.destroy.call(this,Ha),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},Hb.addItem=function(Ha,Hb){void 0===Hb&&(Hb=!0);var Hc=Ha,Hd=this._items.length;if(Hc.name="item"+Hd,this.addChild(Hc),this.initItems(),Hb&&0<Hd){var He=this._items[Hd-1];"horizontal"==this._direction?Hc.x=He.x+He.width+this._space:Hc.y=He.y+He.height+this._space}else Hb&&(Hc.x=0,Hc.y=0);return Hd},Hb.delItem=function(Ha,Hb){void 0===Hb&&(Hb=!0);var Hc=this._items.indexOf(Ha);if(-1!=Hc){var Hd=Ha;this.removeChild(Hd);for(var He=Hc+1,Hf=this._items.length;He<Hf;He++){var Hg=this._items[He];Hg.name="item"+(He-1),Hb&&("horizontal"==this._direction?Hg.x-=Hd.width+this._space:Hg.y-=Hd.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var Hh;Hh=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=Hh}}},Hb.initItems=function(){this._items||(this._items=[]);for(var Ha=this._items.length=0;Ha<1e4;Ha++){var Hb=this.getChildByName("item"+Ha);if(null==Hb)break;this._items.push(Hb),Hb.selected=Ha===this._selectedIndex,Hb.clickHandler=Hm.create(this,this.itemClick,[Ha],!1)}},Hb.itemClick=function(Ha){this.selectedIndex=Ha},Hb.setSelect=function(Ha,Hb){this._items&&-1<Ha&&Ha<this._items.length&&(this._items[Ha].selected=Hb)},Hb.createItem=function(Ha,Hb){return null},Hb.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var Ha=0,Hb=0,Hc=this._items.length;Hb<Hc;Hb++){var Hd=this._items[Hb];this._skin&&(Hd.skin=this._skin),this._labelColors&&(Hd.labelColors=this._labelColors),this._labelSize&&(Hd.labelSize=this._labelSize),this._labelStroke&&(Hd.labelStroke=this._labelStroke),this._labelStrokeColor&&(Hd.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(Hd.strokeColors=this._strokeColors),this._labelBold&&(Hd.labelBold=this._labelBold),this._labelPadding&&(Hd.labelPadding=this._labelPadding),this._labelAlign&&(Hd.labelAlign=this._labelAlign),this._stateNum&&(Hd.stateNum=this._stateNum),this._labelFont&&(Hd.labelFont=this._labelFont),"horizontal"===this._direction?(Hd.y=0,Hd.x=Ha,Ha+=Hd.width+this._space):(Hd.x=0,Hd.y=Ha,Ha+=Hd.height+this._space)}this.changeSize()},Hb.commitMeasure=function(){this.runCallLater(this.changeLabels)},Hb._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},He(0,Hb,"labelStrokeColor",function(){return this._labelStrokeColor},function(Ha){this._labelStrokeColor!=Ha&&(this._labelStrokeColor=Ha,this._setLabelChanged())}),He(0,Hb,"skin",function(){return this._skin},function(Ha){this._skin!=Ha&&(this._skin=Ha,this._setLabelChanged())}),He(0,Hb,"selectedIndex",function(){return this._selectedIndex},function(Ha){this._selectedIndex!=Ha&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=Ha,this.setSelect(Ha,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),He(0,Hb,"labels",function(){return this._labels},function(Ha){if(this._labels!=Ha){if(this._labels=Ha,this.removeChildren(),this._setLabelChanged(),this._labels)for(var Hb=this._labels.split(","),Hc=0,Hd=Hb.length;Hc<Hd;Hc++){var He=this.createItem(this._skin,Hb[Hc]);He.name="item"+Hc,this.addChild(He)}this.initItems()}}),He(0,Hb,"strokeColors",function(){return this._strokeColors},function(Ha){this._strokeColors!=Ha&&(this._strokeColors=Ha,this._setLabelChanged())}),He(0,Hb,"labelColors",function(){return this._labelColors},function(Ha){this._labelColors!=Ha&&(this._labelColors=Ha,this._setLabelChanged())}),He(0,Hb,"labelStroke",function(){return this._labelStroke},function(Ha){this._labelStroke!=Ha&&(this._labelStroke=Ha,this._setLabelChanged())}),He(0,Hb,"labelSize",function(){return this._labelSize},function(Ha){this._labelSize!=Ha&&(this._labelSize=Ha,this._setLabelChanged())}),He(0,Hb,"stateNum",function(){return this._stateNum},function(Ha){this._stateNum!=Ha&&(this._stateNum=Ha,this._setLabelChanged())}),He(0,Hb,"labelBold",function(){return this._labelBold},function(Ha){this._labelBold!=Ha&&(this._labelBold=Ha,this._setLabelChanged())}),He(0,Hb,"labelFont",function(){return this._labelFont},function(Ha){this._labelFont!=Ha&&(this._labelFont=Ha,this._setLabelChanged())}),He(0,Hb,"labelPadding",function(){return this._labelPadding},function(Ha){this._labelPadding!=Ha&&(this._labelPadding=Ha,this._setLabelChanged())}),He(0,Hb,"direction",function(){return this._direction},function(Ha){this._direction=Ha,this._setLabelChanged()}),He(0,Hb,"space",function(){return this._space},function(Ha){this._space=Ha,this._setLabelChanged()}),He(0,Hb,"items",function(){return this._items}),He(0,Hb,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(Ha){this.selectedIndex=this._items.indexOf(Ha)}),He(0,Hb,"dataSource",Ha.prototype._$get_dataSource,function(Ha){"number"==typeof(this._dataSource=Ha)&&Math.floor(Ha)==Ha||"string"==typeof Ha?this.selectedIndex=parseInt(Ha):Ha instanceof Array?this.labels=Ha.join(","):Hp.superSet(HH,this,"dataSource",Ha)}),Hc}(HH),H$=function(Hb){function Hc(Ha,Hb){this._value=null,void 0===Hb&&(Hb=""),Hc.__super.call(this,Ha,Hb)}Hf(Hc,"laya.ui.Radio",Hb);var Ha=Hc.prototype;return Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,Ha),this._value=null},Ha.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},Ha.initialize=function(){Hb.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},Ha.onClick=function(Ha){this.selected=!0},He(0,Ha,"value",function(){return null!=this._value?this._value:this.label},function(Ha){this._value=Ha}),Hc}(HI),H_=function(Ha){function Hb(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,Hb.__super.call(this),this.width=this.height=200}Hf(Hb,"laya.ui.Tree",Ha);var Hc=Hb.prototype;return Hp.imps(Hc,{"laya.ui.IRender":!0}),Hc.destroy=function(Ha){void 0===Ha&&(Ha=!0),laya.ui.Component.prototype.destroy.call(this,Ha),this._list&&this._list.destroy(Ha),this._list=null,this._source=null,this._renderHandler=null},Hc.createChildren=function(){this.addChild(this._list=new HV),this._list.renderHandler=Hm.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},Hc.onListChange=function(Ha){this.event("change")},Hc.getArray=function(){var Ha,Hb=[];for(var Hc in this._source)Ha=this._source[Hc],this.getParentOpenStatus(Ha)&&(Ha.x=this._spaceLeft*this.getDepth(Ha),Hb.push(Ha));return Hb},Hc.getDepth=function(Ha,Hb){return void 0===Hb&&(Hb=0),null==Ha.nodeParent?Hb:this.getDepth(Ha.nodeParent,Hb+1)},Hc.getParentOpenStatus=function(Ha){var Hb=Ha.nodeParent;return null==Hb||!!Hb.isOpen&&(null==Hb.nodeParent||this.getParentOpenStatus(Hb))},Hc.renderItem=function(Ha,Hb){var Hc=Ha.dataSource;if(Hc){Ha.left=Hc.x;var Hd=Ha.getChildByName("arrow");Hd&&(Hc.hasChild?(Hd.visible=!0,Hd.index=Hc.isOpen?1:0,Hd.tag=Hb,Hd.off("click",this,this.onArrowClick),Hd.on("click",this,this.onArrowClick)):Hd.visible=!1);var He=Ha.getChildByName("folder");He&&(2==He.clipY?He.index=Hc.isDirectory?0:1:He.index=Hc.isDirectory?Hc.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([Ha,Hb])}},Hc.onArrowClick=function(Ha){var Hb=Ha.currentTarget.tag;this._list.array[Hb].isOpen=!this._list.array[Hb].isOpen,this.event("open"),this._list.array=this.getArray()},Hc.setItemState=function(Ha,Hb){this._list.array[Ha]&&(this._list.array[Ha].isOpen=Hb,this._list.array=this.getArray())},Hc.fresh=function(){this._list.array=this.getArray(),this.repaint()},Hc.parseXml=function(Ha,Hb,Hc,Hd){var He,Hf=Ha.childNodes,Hg=Hf.length;if(!Hd){He={};var Hh,Hi=Ha.attributes;for(var Hj in Hi){var Hk=(Hh=Hi[Hj]).nodeName,Hl=Hh.nodeValue;He[Hk]="true"==Hl||"false"!=Hl&&Hl}He.nodeParent=Hc,0<Hg&&(He.isDirectory=!0),He.hasChild=0<Hg,Hb.push(He)}for(var Hm=0;Hm<Hg;Hm++){var Hn=Hf[Hm];this.parseXml(Hn,Hb,He,!1)}},Hc.parseOpenStatus=function(Ha,Hb){for(var Hc=0,Hd=Hb.length;Hc<Hd;Hc++){var He=Hb[Hc];if(He.isDirectory)for(var Hf=0,Hg=Ha.length;Hf<Hg;Hf++){var Hh=Ha[Hf];if(Hh.isDirectory&&this.isSameParent(Hh,He)&&He.label==Hh.label){He.isOpen=Hh.isOpen;break}}}},Hc.isSameParent=function(Ha,Hb){return null==Ha.nodeParent&&null==Hb.nodeParent||null!=Ha.nodeParent&&null!=Hb.nodeParent&&(Ha.nodeParent.label==Hb.nodeParent.label&&this.isSameParent(Ha.nodeParent,Hb.nodeParent))},Hc.filter=function(Ha){if(Boolean(Ha)){var Hb=[];this.getFilterSource(this._source,Hb,Ha),this._list.array=Hb}else this._list.array=this.getArray()},Hc.getFilterSource=function(Ha,Hb,Hc){var Hd;for(var He in Hc=Hc.toLocaleLowerCase(),Ha)!(Hd=Ha[He]).isDirectory&&-1<String(Hd.label).toLowerCase().indexOf(Hc)&&(Hd.x=0,Hb.push(Hd)),Hd.child&&0<Hd.child.length&&this.getFilterSource(Hd.child,Hb,Hc)},He(0,Hc,"spaceBottom",function(){return this._list.spaceY},function(Ha){this._list.spaceY=Ha}),He(0,Hc,"keepStatus",function(){return this._keepStatus},function(Ha){this._keepStatus=Ha}),He(0,Hc,"itemRender",function(){return this._list.itemRender},function(Ha){this._list.itemRender=Ha}),He(0,Hc,"array",function(){return this._list.array},function(Ha){this._keepStatus&&this._list.array&&Ha&&this.parseOpenStatus(this._list.array,Ha),this._source=Ha,this._list.array=this.getArray()}),He(0,Hc,"mouseHandler",function(){return this._list.mouseHandler},function(Ha){this._list.mouseHandler=Ha}),He(0,Hc,"dataSource",Ha.prototype._$get_dataSource,function(Ha){this._dataSource=Ha,Hp.superSet(HH,this,"dataSource",Ha)}),He(0,Hc,"source",function(){return this._source}),He(0,Hc,"scrollBar",function(){return this._list.scrollBar}),He(0,Hc,"list",function(){return this._list}),He(0,Hc,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(Ha){this._list.vScrollBarSkin=Ha}),He(0,Hc,"renderHandler",function(){return this._renderHandler},function(Ha){this._renderHandler=Ha}),He(0,Hc,"selectedIndex",function(){return this._list.selectedIndex},function(Ha){this._list.selectedIndex=Ha}),He(0,Hc,"spaceLeft",function(){return this._spaceLeft},function(Ha){this._spaceLeft=Ha}),He(0,Hc,"selectedItem",function(){return this._list.selectedItem},function(Ha){this._list.selectedItem=Ha}),He(0,Hc,"width",Ha.prototype._$get_width,function(Ha){Hp.superSet(HH,this,"width",Ha),this._list.width=Ha}),He(0,Hc,"height",Ha.prototype._$get_height,function(Ha){Hp.superSet(HH,this,"height",Ha),this._list.height=Ha}),He(0,Hc,"xml",null,function(Ha){var Hb=[];this.parseXml(Ha.childNodes[0],Hb,null,!0),this.array=Hb}),He(0,Hc,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),Hb}(HH),Haa=function(Ha){function Hb(){this._items=null,this._selectedIndex=0,Hb.__super.call(this),this._setIndexHandler=Hm.create(this,this.setIndex,null,!1)}Hf(Hb,"laya.ui.ViewStack",Ha);var Hc=Hb.prototype;return Hp.imps(Hc,{"laya.ui.IItem":!0}),Hc.setItems=function(Ha){this.removeChildren();for(var Hb=0,Hc=0,Hd=Ha.length;Hc<Hd;Hc++){var He=Ha[Hc];He&&(He.name="item"+Hb,this.addChild(He),Hb++)}this.initItems()},Hc.addItem=function(Ha){Ha.name="item"+this._items.length,this.addChild(Ha),this.initItems()},Hc.initItems=function(){this._items=[];for(var Ha=0;Ha<1e4;Ha++){var Hb=this.getChildByName("item"+Ha);if(null==Hb)break;this._items.push(Hb),Hb.visible=Ha==this._selectedIndex}},Hc.setSelect=function(Ha,Hb){this._items&&-1<Ha&&Ha<this._items.length&&(this._items[Ha].visible=Hb)},Hc.setIndex=function(Ha){this.selectedIndex=Ha},He(0,Hc,"dataSource",Ha.prototype._$get_dataSource,function(Ha){if("number"==typeof(this._dataSource=Ha)&&Math.floor(Ha)==Ha||"string"==typeof Ha)this.selectedIndex=parseInt(Ha);else for(var Hb in this._dataSource)this.hasOwnProperty(Hb)&&(this[Hb]=this._dataSource[Hb])}),He(0,Hc,"selectedIndex",function(){return this._selectedIndex},function(Ha){this._selectedIndex!=Ha&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=Ha,this.setSelect(this._selectedIndex,!0))}),He(0,Hc,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(Ha){this.selectedIndex=this._items.indexOf(Ha)}),He(0,Hc,"items",function(){return this._items}),He(0,Hc,"setIndexHandler",function(){return this._setIndexHandler},function(Ha){this._setIndexHandler=Ha}),Hb}(HH),Hba=function(Ha){function Hb(){Hb.__super.call(this)}return Hf(Hb,"laya.ui.VScrollBar",HM),Hb}(),Hca=function(Hb){function Hc(Ha){this._bg=null,this._skin=null,Hc.__super.call(this),void 0===Ha&&(Ha=""),this.text=Ha,this.skin=this.skin}Hf(Hc,"laya.ui.TextInput",Hb);var Ha=Hc.prototype;return Ha.preinitialize=function(){this.mouseEnabled=!0},Ha.destroy=function(Ha){Hs.clearCache(this,this._skin),void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,Ha),this._bg&&this._bg.destroy(),this._bg=null},Ha.createChildren=function(){this.addChild(this._tf=new Hn),this._tf.padding=HB.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},Ha._onFocus=function(){this.event("focus",this)},Ha._onBlur=function(){this.event("blur",this)},Ha._onInput=function(){this.event("input",this)},Ha._onEnter=function(){this.event("enter",this)},Ha.initialize=function(){this.width=128,this.height=22},Ha.select=function(){this._tf.select()},Ha.setSelection=function(Ha,Hb){this._tf.setSelection(Ha,Hb)},He(0,Ha,"text",Hb.prototype._$get_text,function(Ha){this._tf.text!=Ha&&(Ha+="",this._tf.text=Ha,this.event("change"))}),He(0,Ha,"bg",function(){return this._bg},function(Ha){this.graphics=this._bg=Ha}),He(0,Ha,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(Ha){this._tf.inputElementYAdjuster=Ha}),He(0,Ha,"multiline",function(){return this._tf.multiline},function(Ha){this._tf.multiline=Ha}),He(0,Ha,"skin",function(){return this._skin},function(Ha){this._skin!=Ha&&(Hs.clearCache(this,this._skin),this._skin=Ha,this._bg||(this.graphics=this._bg=new HE),Hs.keepCache(this,this._skin),this._bg.source=Hs.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),He(0,Ha,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(Ha){this._bg||(this.graphics=this._bg=new HE),this._bg.sizeGrid=HC.fillArray(HB.defaultSizeGrid,Ha,Number)}),He(0,Ha,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(Ha){this._tf.inputElementXAdjuster=Ha}),He(0,Ha,"width",Hb.prototype._$get_width,function(Ha){Hp.superSet(HP,this,"width",Ha),this._bg&&(this._bg.width=Ha)}),He(0,Ha,"height",Hb.prototype._$get_height,function(Ha){Hp.superSet(HP,this,"height",Ha),this._bg&&(this._bg.height=Ha)}),He(0,Ha,"editable",function(){return this._tf.editable},function(Ha){this._tf.editable=Ha}),He(0,Ha,"restrict",function(){return this._tf.restrict},function(Ha){this._tf.restrict=Ha}),He(0,Ha,"prompt",function(){return this._tf.prompt},function(Ha){this._tf.prompt=Ha}),He(0,Ha,"promptColor",function(){return this._tf.promptColor},function(Ha){this._tf.promptColor=Ha}),He(0,Ha,"maxChars",function(){return this._tf.maxChars},function(Ha){this._tf.maxChars=Ha}),He(0,Ha,"focus",function(){return this._tf.focus},function(Ha){this._tf.focus=Ha}),He(0,Ha,"type",function(){return this._tf.type},function(Ha){this._tf.type=Ha}),He(0,Ha,"asPassword",function(){return this._tf.asPassword},function(Ha){this._tf.asPassword=Ha}),Hc}(HP),Hda=function(Ha){function Hb(){Hb.__super.call(this)}return Hf(Hb,"laya.ui.VSlider",HN),Hb}(),Hea=function(Ha){function Hd(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,Hd.__super.call(this)}Hf(Hd,"laya.ui.Dialog",Ha);var Hb=Hd.prototype;return Hb.initialize=function(){this.popupEffect=Hd.manager.popupEffectHandler,this.closeEffect=Hd.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},Hb._dealDragArea=function(){var Ha=this.getChildByName("drag");Ha&&(this.dragArea=Ha.x+","+Ha.y+","+Ha.width+","+Ha.height,Ha.removeSelf())},Hb._onClick=function(Ha){var Hb=Ha.target;if(Hb)switch(Hb.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(Hb.name)}},Hb.show=function(Ha,Hb){void 0===Ha&&(Ha=!1),void 0===Hb&&(Hb=!0),this._open(!1,Ha,Hb)},Hb.popup=function(Ha,Hb){void 0===Ha&&(Ha=!1),void 0===Hb&&(Hb=!0),this._open(!0,Ha,Hb)},Hb._open=function(Ha,Hb,Hc){Hd.manager.lock(!1),this.isModal=Ha,Hd.manager.open(this,Hb,Hc)},Hb.onOpened=function(){},Hb.close=function(Ha,Hb){void 0===Hb&&(Hb=!0),Hd.manager.close(this,Ha,Hb)},Hb.onClosed=function(Ha){},Hb._onMouseDown=function(Ha){var Hb=this.getMousePoint();this._dragArea.contains(Hb.x,Hb.y)?this.startDrag():this.stopDrag()},He(0,Hb,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(Ha){if(Ha){var Hb=HC.fillArray([0,0,0,0],Ha,Number);this._dragArea=new Hr(Hb[0],Hb[1],Hb[2],Hb[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),He(0,Hb,"isPopup",function(){return null!=this.parent}),He(0,Hb,"zOrder",Ha.prototype._$get_zOrder,function(Ha){Hp.superSet(HR,this,"zOrder",Ha),Hd.manager._checkMask()}),He(1,Hd,"manager",function(){return Hd._manager=Hd._manager||new HG},function(Ha){Hd._manager=Ha}),Hd.setLockView=function(Ha){Hd.manager.setLockView(Ha)},Hd.lock=function(Ha){Hd.manager.lock(Ha)},Hd.closeAll=function(){Hd.manager.closeAll()},Hd.getDialogsByGroup=function(Ha){return Hd.manager.getDialogsByGroup(Ha)},Hd.closeByGroup=function(Ha){return Hd.manager.closeByGroup(Ha)},Hd.CLOSE="close",Hd.CANCEL="cancel",Hd.SURE="sure",Hd.NO="no",Hd.OK="ok",Hd.YES="yes",Hd._manager=null,Hd}(HR),Hfa=function(Ha){function Hb(){Hb.__super.call(this)}Hf(Hb,"laya.ui.HBox",Ha);var Hc=Hb.prototype;return Hc.sortItem=function(Ha){Ha&&Ha.sort(function(Ha,Hb){return Ha.x-Hb.x})},Hc.changeItems=function(){this._itemChanged=!1;for(var Ha=[],Hb=0,Hc=0,Hd=this.numChildren;Hc<Hd;Hc++){var He=this.getChildAt(Hc);He&&He.layoutEnabled&&(Ha.push(He),Hb=this._height?this._height:Math.max(Hb,He.height*He.scaleY))}this.sortItem(Ha);var Hf=0;for(Hc=0,Hd=Ha.length;Hc<Hd;Hc++)(He=Ha[Hc]).x=Hf,Hf+=He.width*He.scaleX+this._space,"top"==this._align?He.y=0:"middle"==this._align?He.y=.5*(Hb-He.height*He.scaleY):"bottom"==this._align&&(He.y=Hb-He.height*He.scaleY);this.changeSize()},He(0,Hc,"height",Ha.prototype._$get_height,function(Ha){this._height!=Ha&&(Hp.superSet(HT,this,"height",Ha),this.callLater(this.changeItems))}),Hb.NONE="none",Hb.TOP="top",Hb.MIDDLE="middle",Hb.BOTTOM="bottom",Hb}(HT),Hga=function(Ha){function Hb(){Hb.__super.call(this)}Hf(Hb,"laya.ui.VBox",Ha);var Hc=Hb.prototype;return Hc.changeItems=function(){this._itemChanged=!1;for(var Ha=[],Hb=0,Hc=0,Hd=this.numChildren;Hc<Hd;Hc++){var He=this.getChildAt(Hc);He&&He.layoutEnabled&&(Ha.push(He),Hb=this._width?this._width:Math.max(Hb,He.width*He.scaleX))}this.sortItem(Ha);var Hf=0;for(Hc=0,Hd=Ha.length;Hc<Hd;Hc++)(He=Ha[Hc]).y=Hf,Hf+=He.height*He.scaleY+this._space,"left"==this._align?He.x=0:"center"==this._align?He.x=.5*(Hb-He.width*He.scaleX):"right"==this._align&&(He.x=Hb-He.width*He.scaleX);this.changeSize()},He(0,Hc,"width",Ha.prototype._$get_width,function(Ha){this._width!=Ha&&(Hp.superSet(HT,this,"width",Ha),this.callLater(this.changeItems))}),Hb.NONE="none",Hb.LEFT="left",Hb.CENTER="center",Hb.RIGHT="right",Hb}(HT),Hha=function(Ha){function Hb(){Hb.__super.call(this)}return Hf(Hb,"laya.ui.RadioGroup",HZ),Hb.prototype.createItem=function(Ha,Hb){return new H$(Ha,Hb)},Hb}(),Hia=function(Ha){function Hb(){Hb.__super.call(this)}return Hf(Hb,"laya.ui.Tab",HZ),Hb.prototype.createItem=function(Ha,Hb){return new HI(Ha,Hb)},Hb}(),Hja=function(Hb){function Hc(Ha){this._vScrollBar=null,this._hScrollBar=null,void 0===Ha&&(Ha=""),Hc.__super.call(this,Ha)}Hf(Hc,"laya.ui.TextArea",Hb);var Ha=Hc.prototype;return Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,Ha),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},Ha.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},Ha.onVBarChanged=function(Ha){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},Ha.onHBarChanged=function(Ha){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},Ha.changeScroll=function(){var Ha=this._vScrollBar&&0<this._tf.maxScrollY,Hb=this._hScrollBar&&0<this._tf.maxScrollX,Hc=Ha?this._width-this._vScrollBar.width:this._width,Hd=Hb?this._height-this._hScrollBar.height:this._height,He=this._tf.padding||HB.labelPadding;this._tf.width=Hc,this._tf.height=Hd,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-He[2],this._vScrollBar.y=He[1],this._vScrollBar.height=this._height-(Hb?this._hScrollBar.height:0)-He[1]-He[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=Hd/Math.max(this._tf.textHeight,Hd),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=Ha),this._hScrollBar&&(this._hScrollBar.x=He[0],this._hScrollBar.y=this._height-this._hScrollBar.height-He[3],this._hScrollBar.width=this._width-(Ha?this._vScrollBar.width:0)-He[0]-He[2],this._hScrollBar.scrollSize=Math.max(.033*Hc,1),this._hScrollBar.thumbPercent=Hc/Math.max(this._tf.textWidth,Hc),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=Hb)},Ha.scrollTo=function(Ha){this.commitMeasure(),this._tf.scrollY=Ha},He(0,Ha,"scrollY",function(){return this._tf.scrollY}),He(0,Ha,"width",Hb.prototype._$get_width,function(Ha){Hp.superSet(Hca,this,"width",Ha),this.callLater(this.changeScroll)}),He(0,Ha,"hScrollBar",function(){return this._hScrollBar}),He(0,Ha,"height",Hb.prototype._$get_height,function(Ha){Hp.superSet(Hca,this,"height",Ha),this.callLater(this.changeScroll)}),He(0,Ha,"maxScrollX",function(){return this._tf.maxScrollX}),He(0,Ha,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(Ha){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new Hba),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=Ha}),He(0,Ha,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(Ha){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new HW),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=Ha}),He(0,Ha,"vScrollBar",function(){return this._vScrollBar}),He(0,Ha,"maxScrollY",function(){return this._tf.maxScrollY}),He(0,Ha,"scrollX",function(){return this._tf.scrollX}),Hc}(Hca);!function(Ha){function Hb(){this._uiView=null,this.isCloseOther=!1,Hb.__super.call(this)}Hf(Hb,"laya.ui.AsynDialog",Hea);var Hc=Hb.prototype;Hc.createView=function(Ha){this._uiView=Ha},Hc._open=function(Ha,Hb,Hc){this.isModal=Ha,this.isCloseOther=Hb,Hea.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},Hc.onCreated=function(){this.createUI(),this.onOpen()},Hc.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},Hc.onOpen=function(){Hea.manager.open(this,this.isCloseOther),Hea.manager.lock(!1)},Hc.close=function(Ha,Hb){void 0===Hb&&(Hb=!0),Hea.manager.close(this),this.onClose()},Hc.onClose=function(){},Hc.destroy=function(Ha){void 0===Ha&&(Ha=!0),laya.ui.View.prototype.destroy.call(this,Ha),this._uiView=null,this.onDestroy()},Hc.onDestroy=function(){}}();Hp.__init([HR])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ha,Hb){"use strict";for(var Hc in Object.defineProperty(Hb,"__esModule",{value:!0}),Laya){var Hd=Laya[Hc];Hd&&Hd.__isclass&&(Hb[Hc]=Hd)}}),function(Hm,Ha,Hv){Hv.un,Hv.uns;var Hl=Hv.static,Hn=Hv.class,Ho=Hv.getset,Hd=Hv.__newvec,Hu=laya.maths.Arith,Hg=laya.webgl.atlas.AtlasResourceManager,Hc=laya.webgl.shader.BaseShader,HF=laya.utils.Browser,Hh=laya.webgl.utils.Buffer,Hw=laya.utils.Byte,He=laya.utils.ClassUtils,Hi=Hv.Config,Hf=(laya.events.Event,laya.events.EventDispatcher),HB=laya.utils.Handler,Hr=laya.net.Loader,Hb=laya.net.LoaderManager,Hj=(laya.maths.MathUtil,laya.display.Node),Hp=laya.renders.Render,Hk=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),Hq=laya.resource.Resource,Hs=laya.utils.RunDriver,Ht=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),Hx=laya.display.Sprite,Hy=laya.utils.Stat,Hz=laya.utils.StringKey,HC=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),HA=laya.utils.Utils,HD=laya.webgl.WebGL,HE=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;Hv.interface("laya.d3.core.IClone"),Hv.interface("laya.d3.graphics.IVertex"),Hv.interface("laya.d3.core.render.IUpdate"),Hv.interface("laya.d3.core.scene.ITreeNode"),Hv.interface("laya.d3.core.render.IRenderable");(function(){function HI(){}Hn(HI,"laya.d3.animation.AnimationClipParser01"),HI.READ_DATA=function(){HI._DATA.offset=HI._reader.getUint32(),HI._DATA.size=HI._reader.getUint32()},HI.READ_BLOCK=function(){for(var Ha=HI._BLOCK.count=HI._reader.getUint16(),Hb=HI._BLOCK.blockStarts=[],Hc=HI._BLOCK.blockLengths=[],Hd=0;Hd<Ha;Hd++)Hb.push(HI._reader.getUint32()),Hc.push(HI._reader.getUint32())},HI.READ_STRINGS=function(){var Ha=HI._reader.getUint32(),Hb=HI._reader.getUint16(),Hc=HI._reader.pos;HI._reader.pos=Ha+HI._DATA.offset;for(var Hd=0;Hd<Hb;Hd++)HI._strings[Hd]=HI._reader.readUTFString();HI._reader.pos=Hc},HI.parse=function(Ha,Hb){HI._animationClip=Ha;(HI._reader=Hb).__getBuffer();HI.READ_DATA(),HI.READ_BLOCK(),HI.READ_STRINGS();for(var Hc=0,Hd=HI._BLOCK.count;Hc<Hd;Hc++){var He=Hb.getUint16(),Hf=HI._strings[He],Hg=HI["READ_"+Hf];if(null==Hg)throw new Error("model file err,no this function:"+He+" "+Hf);Hg.call()}},HI.READ_ANIMATIONS=function(){var Ha,Hb=0,Hc=0,Hd=HI._reader,He=Hd.__getBuffer(),Hf=[],Hg=Hd.getUint8();for(Hf.length=Hg,Hb=0;Hb<Hg;Hb++)Hf[Hb]=Hd.getUint16();var Hh=[],Hi=Hd.getUint16();for(Hh.length=Hi,Hb=0;Hb<Hi;Hb++)Hh[Hb]=Hd.getFloat32();var Hj=HI._animationClip;Hj.name=HI._strings[Hd.getUint16()];var Hk=Hj._duration=Hd.getFloat32();Hj.islooping=!!Hd.getByte(),Hj._frameRate=Hd.getInt16();var Hl=Hd.getInt16(),Hm=Hj._nodes=new Array;Hm.length=Hl,(Hj._publicClipDatas=[]).length=Hl;var Hn=Hj._nodesMap={},Ho=0,Hp=0;for(Hb=0;Hb<Hl;Hb++){Ha=Hm[Hb]=new HQ;var Hq=Hd.getUint16(),Hr=Ha.path=[];for(Hr.length=Hq,Hc=0;Hc<Hq;Hc++)Hr[Hc]=HI._strings[Hd.getUint16()];var Hs=Hr.join("/"),Ht=Hn[Hs];Ht||(Hn[Hs]=Ht=[]),Ht.push(Ha);var Hu=Hd.getInt16();-1!==Hu&&(Ha.componentType=HI._strings[Hu]);var Hv=HO._propertyIndexDic[HI._strings[Hd.getUint16()]];if(null==Hv)throw new Error("AnimationClipParser01:unknown property name.");var Hw=Hv<4,Hx=!Hw||Hw&&""===Hr[0];(Ha._cacheProperty=Hx)?Ho++:Hp++,Ha.propertyNameID=Hv;var Hy=Hf[Hd.getUint8()];Ha.keyFrameWidth=Hy/4;var Hz=Ha.keyFrames=[],HA=Hz.length=Hd.getUint16(),HB=null,HC=NaN;for(Hc=0;Hc<HA;Hc++){var HD=Hz[Hc]=new HP;HC=HD.startTime=Hh[Hd.getUint16()];var HE=Hd.pos;HD.inTangent=new Float32Array(He.slice(HE,HE+Hy)),Hd.pos+=Hy,HE=Hd.pos,HD.outTangent=new Float32Array(He.slice(HE,HE+Hy)),Hd.pos+=Hy,HE=Hd.pos,HD.data=new Float32Array(He.slice(HE,HE+Hy)),Hd.pos+=Hy,HB&&(HB.next=HD,HB.duration=HC-HB.startTime),HB=HD}HD.next=null,HD.duration=Hk-HC}var HF=Hj._nodeToCachePropertyMap=new Int32Array(Hl),HG=Hj._cachePropertyMap=new Int32Array(Ho),HH=Hj._unCachePropertyMap=new Int32Array(Hp);for(Ho=Hp=0,Hb=0;Hb<Hl;Hb++)(Ha=Hm[Hb])._cacheProperty?(HF[Hb]=Ho,HG[Ho++]=Hb):HH[Hp++]=Hb},HI._animationClip=null,HI._reader=null,HI._strings=[],Hl(HI,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function HM(){}Hn(HM,"laya.d3.animation.AnimationClipParser02"),HM.READ_DATA=function(){HM._DATA.offset=HM._reader.getUint32(),HM._DATA.size=HM._reader.getUint32()},HM.READ_BLOCK=function(){for(var Ha=HM._BLOCK.count=HM._reader.getUint16(),Hb=HM._BLOCK.blockStarts=[],Hc=HM._BLOCK.blockLengths=[],Hd=0;Hd<Ha;Hd++)Hb.push(HM._reader.getUint32()),Hc.push(HM._reader.getUint32())},HM.READ_STRINGS=function(){var Ha=HM._reader.getUint32(),Hb=HM._reader.getUint16(),Hc=HM._reader.pos;HM._reader.pos=Ha+HM._DATA.offset;for(var Hd=0;Hd<Hb;Hd++)HM._strings[Hd]=HM._reader.readUTFString();HM._reader.pos=Hc},HM.parse=function(Ha,Hb){HM._animationClip=Ha;(HM._reader=Hb).__getBuffer();HM.READ_DATA(),HM.READ_BLOCK(),HM.READ_STRINGS();for(var Hc=0,Hd=HM._BLOCK.count;Hc<Hd;Hc++){var He=Hb.getUint16(),Hf=HM._strings[He],Hg=HM["READ_"+Hf];if(null==Hg)throw new Error("model file err,no this function:"+He+" "+Hf);Hg.call()}},HM.READ_ANIMATIONS=function(){var Ha,Hb=0,Hc=0,Hd=HM._reader,He=Hd.__getBuffer(),Hf=[],Hg=Hd.getUint8();for(Hf.length=Hg,Hb=0;Hb<Hg;Hb++)Hf[Hb]=Hd.getUint16();var Hh=[],Hi=Hd.getUint16();for(Hh.length=Hi,Hb=0;Hb<Hi;Hb++)Hh[Hb]=Hd.getFloat32();var Hj=HM._animationClip;Hj.name=HM._strings[Hd.getUint16()];var Hk=Hj._duration=Hd.getFloat32();Hj.islooping=!!Hd.getByte(),Hj._frameRate=Hd.getInt16();var Hl=Hd.getInt16(),Hm=Hj._nodes=new Array;Hm.length=Hl,(Hj._publicClipDatas=[]).length=Hl;var Hn=Hj._nodesMap={},Ho=0,Hp=0;for(Hb=0;Hb<Hl;Hb++){Ha=Hm[Hb]=new HQ;var Hq=Hd.getUint16(),Hr=Ha.path=[];for(Hr.length=Hq,Hc=0;Hc<Hq;Hc++)Hr[Hc]=HM._strings[Hd.getUint16()];var Hs=Hr.join("/"),Ht=Hn[Hs];Ht||(Hn[Hs]=Ht=[]),Ht.push(Ha);var Hu=Hd.getInt16();-1!==Hu&&(Ha.componentType=HM._strings[Hu]);var Hv=HO._propertyIndexDic[HM._strings[Hd.getUint16()]];if(null==Hv)throw new Error("AnimationClipParser02:unknown property name.");var Hw=Hv<4,Hx=!Hw||Hw&&""===Hr[0];(Ha._cacheProperty=Hx)?Ho++:Hp++,Ha.propertyNameID=Hv;var Hy=Hf[Hd.getUint8()];Ha.keyFrameWidth=Hy/4;var Hz=Ha.keyFrames=[],HA=Hz.length=Hd.getUint16(),HB=null,HC=NaN;for(Hc=0;Hc<HA;Hc++){var HD=Hz[Hc]=new HP;HC=HD.startTime=Hh[Hd.getUint16()];var HE=Hd.pos;HD.inTangent=new Float32Array(He.slice(HE,HE+Hy)),Hd.pos+=Hy,HE=Hd.pos,HD.outTangent=new Float32Array(He.slice(HE,HE+Hy)),Hd.pos+=Hy,HE=Hd.pos,HD.data=new Float32Array(He.slice(HE,HE+Hy)),Hd.pos+=Hy,HB&&(HB.next=HD,HB.duration=HC-HB.startTime),HB=HD}HD.next=null,HD.duration=Hk-HC}var HF=Hd.getUint16();for(Hb=0;Hb<HF;Hb++){var HG,HH=new HN;HH.time=Hd.getFloat32(),HH.eventName=HM._strings[Hd.getUint16()];var HI=Hd.getUint16();for(0<HI&&(HH.params=HG=[]),Hc=0;Hc<HI;Hc++){switch(Hd.getByte()){case 0:HG.push(!!Hd.getByte());break;case 1:HG.push(Hd.getInt32());break;case 2:HG.push(Hd.getFloat32());break;case 3:HG.push(HM._strings[Hd.getUint16()]);break;default:throw new Error("unknown type.")}}Hj.addEvent(HH)}var HJ=Hj._nodeToCachePropertyMap=new Int32Array(Hl),HK=Hj._cachePropertyMap=new Int32Array(Ho),HL=Hj._unCachePropertyMap=new Int32Array(Hp);for(Ho=Hp=0,Hb=0;Hb<Hl;Hb++)(Ha=Hm[Hb])._cacheProperty?(HJ[Hb]=Ho,HK[Ho++]=Hb):HL[Hp++]=Hb},HM._animationClip=null,HM._reader=null,HM._strings=[],Hl(HM,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var HN=function(){function Ha(){this.time=NaN,this.eventName=null,this.params=null}return Hn(Ha,"laya.d3.animation.AnimationEvent"),Ha}(),HO=function(){function Hd(){this._childs=[],this.transform=new Hsb(this)}Hn(Hd,"laya.d3.animation.AnimationNode");var Ha=Hd.prototype;return Hv.imps(Ha,{"laya.d3.core.IClone":!0}),Ha.addChild=function(Ha){Ha._parent=this,Ha.transform.setParent(this.transform),this._childs.push(Ha)},Ha.removeChild=function(Ha){var Hb=this._childs.indexOf(Ha);-1!==Hb&&this._childs.splice(Hb,1)},Ha.getChildByName=function(Ha){for(var Hb=0,Hc=this._childs.length;Hb<Hc;Hb++){var Hd=this._childs[Hb];if(Hd.name===Ha)return Hd}return null},Ha.getChildByIndex=function(Ha){return this._childs[Ha]},Ha.getChildCount=function(){return this._childs.length},Ha.cloneTo=function(Ha){var Hb=Ha;Hb.name=this.name;for(var Hc=0,Hd=this._childs.length;Hc<Hd;Hc++){var He=this._childs[Hc],Hf=He.clone();Hb.addChild(Hf);var Hg=He.transform,Hh=Hf.transform;Hh.setLocalPosition(Hg.getLocalPosition()),Hh.setLocalRotation(Hg.getLocalRotation()),Hh.setLocalScale(Hg.getLocalScale()),Hh._localRotationEuler=Hg._localRotationEuler,Hh._setWorldMatrixIgnoreUpdate(Hg.getWorldMatrix())}},Ha.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Hd.__init__=function(){Hd.registerAnimationNodeProperty("localPosition",Hd._getLocalPosition,Hd._setLocalPosition),Hd.registerAnimationNodeProperty("localRotation",Hd._getLocalRotation,Hd._setLocalRotation),Hd.registerAnimationNodeProperty("localScale",Hd._getLocalScale,Hd._setLocalScale),Hd.registerAnimationNodeProperty("localRotationEuler",Hd._getLocalRotationEuler,Hd._setLocalRotationEuler),Hd.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",Hd._getParticleRenderSharedMaterialTintColor,Hd._setParticleRenderSharedMaterialTintColor),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",Hd._getMeshRenderSharedMaterialTilingOffset,Hd._setMeshRenderSharedMaterialTilingOffset),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",Hd._getMeshRenderSharedMaterialAlbedo,Hd._setMeshRenderSharedMaterialAlbedo),Hd.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",Hd._getSkinnedMeshRenderSharedMaterialTilingOffset,Hd._setSkinnedMeshRenderSharedMaterialTilingOffset),Hd.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",Hd._getSkinnedMeshRenderSharedMaterialAlbedo,Hd._setSkinnedMeshRenderSharedMaterialAlbedo),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",Hd._getMeshRenderSharedMaterialAlbedo,Hd._setMeshRenderSharedMaterialAlbedo),Hd.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",Hd._getSkinnedMeshRenderSharedMaterialAlbedo,Hd._setSkinnedMeshRenderSharedMaterialAlbedo),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",Hd._getMeshRenderSharedMaterialIntensity,Hd._setMeshRenderSharedMaterialIntensity),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",Hd._getMeshRenderSharedMaterialAlpha,Hd._setMeshRenderSharedMaterialAlpha),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",Hd._getMeshRenderSharedMaterialAlphaColor,Hd._setMeshRenderSharedMaterialAlphaColor),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",Hd._getMeshRenderSharedMaterialBaseColor,Hd._setMeshRenderSharedMaterialBaseColor),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",Hd._getMeshRenderSharedMaterialDissolve,Hd._setMeshRenderSharedMaterialDissolve),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",Hd._getMeshRenderSharedMaterialDissolveSpeed,Hd._setMeshRenderSharedMaterialDissolveSpeed),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",Hd._getMeshRenderSharedMaterialMMultiplier,Hd._setMeshRenderSharedMaterialMMultiplier),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",Hd._getMeshRenderSharedMaterialBaseScrollSpeedX,Hd._setMeshRenderSharedMaterialBaseScrollSpeedX),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",Hd._getMeshRenderSharedMaterialBaseScrollSpeedY,Hd._setMeshRenderSharedMaterialBaseScrollSpeedY),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",Hd._getMeshRenderSharedMaterialSecondScrollSpeedX,Hd._setMeshRenderSharedMaterialSecondScrollSpeedX),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",Hd._getMeshRenderSharedMaterialSecondScrollSpeedY,Hd._setMeshRenderSharedMaterialSecondScrollSpeedY),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",Hd._getMeshRenderSharedMaterialDetailTilingOffset,Hd._setMeshRenderSharedMaterialDetailTilingOffset),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",Hd._getMeshRenderSharedMaterialDissolveTilingOffset,Hd._setMeshRenderSharedMaterialDissolveTilingOffset),Hd.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",Hd._getMeshRenderSharedMaterialMaskTilingOffset,Hd._setMeshRenderSharedMaterialMaskTilingOffset)},Hd.registerAnimationNodeProperty=function(Ha,Hb,Hc){if(Hd._propertyIndexDic[Ha])throw new Error("AnimationNode: this propertyName has registered.");Hd._propertyIndexDic[Ha]=Hd._propertyIDCounter,Hd._propertyGetFuncs[Hd._propertyIDCounter]=Hb,Hd._propertySetFuncs[Hd._propertyIDCounter]=Hc,Hd._propertyIDCounter++},Hd._getLocalPosition=function(Ha,Hb){return Ha?Ha.transform.getLocalPosition():Hb._transform.localPosition.elements},Hd._setLocalPosition=function(Ha,Hb,Hc){if(Ha)Ha.transform.setLocalPosition(Hc);else{var Hd=Hb._transform,He=Hd.localPosition;He.elements=Hc,Hd.localPosition=He}},Hd._getLocalRotation=function(Ha,Hb){return Ha?Ha.transform.getLocalRotation():Hb._transform.localRotation.elements},Hd._setLocalRotation=function(Ha,Hb,Hc){if(Ha)Ha.transform.setLocalRotation(Hc);else{var Hd=Hb._transform,He=Hd.localRotation;He.elements=Hc,Hd.localRotation=He}},Hd._getLocalScale=function(Ha,Hb){return Ha?Ha.transform.getLocalScale():Hb._transform.localScale.elements},Hd._setLocalScale=function(Ha,Hb,Hc){if(Ha)Ha.transform.setLocalScale(Hc);else{var Hd=Hb._transform,He=Hd.localScale;He.elements=Hc,Hd.localScale=He}},Hd._getLocalRotationEuler=function(Ha,Hb){return Ha?Ha.transform.getLocalRotationEuler():Hb._transform.localRotationEuler.elements},Hd._setLocalRotationEuler=function(Ha,Hb,Hc){if(Ha)Ha.transform.setLocalRotationEuler(Hc);else{var Hd=Hb._transform,He=Hd.localRotationEuler;He.elements=Hc,Hd.localRotationEuler=He}},Hd._getMeshRenderSharedMaterialTilingOffset=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return Hb.meshRender.sharedMaterial.tilingOffset.elements},Hd._setMeshRenderSharedMaterialTilingOffset=function(Ha,Hb,Hc){var Hd,He;if(Ha){var Hf=Ha.transform._entity;Hf&&((He=(Hd=Hf.owner.meshRender.material).tilingOffset).elements=Hc,Hd.tilingOffset=He)}else(He=(Hd=Hb.meshRender.material).tilingOffset).elements=Hc,Hd.tilingOffset=He},Hd._getMeshRenderSharedMaterialAlbedo=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.albedoColor.elements:null}return Hb.meshRender.sharedMaterial.albedoColor.elements},Hd._setMeshRenderSharedMaterialAlbedo=function(Ha,Hb,Hc){var Hd,He;if(Ha){var Hf=Ha.transform._entity;Hf&&((He=(Hd=Hf.owner.meshRender.material).albedoColor).elements=Hc,Hd.albedoColor=He)}else(He=(Hd=Hb.meshRender.material).albedoColor).elements=Hc,Hd.albedoColor=He},Hd._getSkinnedMeshRenderSharedMaterialTilingOffset=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return Hb.skinnedMeshRender.sharedMaterial.tilingOffset.elements},Hd._setSkinnedMeshRenderSharedMaterialTilingOffset=function(Ha,Hb,Hc){var Hd,He;if(Ha){var Hf=Ha.transform._entity;Hf&&((He=(Hd=Hf.owner.skinnedMeshRender.material).tilingOffset).elements=Hc,Hd.tilingOffset=He)}else(He=(Hd=Hb.skinnedMeshRender.material).tilingOffset).elements=Hc,Hd.tilingOffset=He},Hd._getSkinnedMeshRenderSharedMaterialAlbedo=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return Hb.skinnedMeshRender.sharedMaterial.albedoColor.elements},Hd._setSkinnedMeshRenderSharedMaterialAlbedo=function(Ha,Hb,Hc){var Hd,He;if(Ha){var Hf=Ha.transform._entity;Hf&&((He=(Hd=Hf.owner.skinnedMeshRender.material).albedoColor).elements=Hc,Hd.albedoColor=He)}else(He=(Hd=Hb.skinnedMeshRender.material).albedoColor).elements=Hc,Hd.albedoColor=He},Hd._getParticleRenderSharedMaterialTintColor=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.particleRender.sharedMaterial.tintColor.elements:null}return Hb.particleRender.sharedMaterial.tintColor.elements},Hd._setParticleRenderSharedMaterialTintColor=function(Ha,Hb,Hc){var Hd,He;if(Ha){var Hf=Ha.transform._entity;Hf&&((He=(Hd=Hf.owner.particleRender.material).tintColor).elements=Hc,Hd.tintColor=He)}else(He=(Hd=Hb.particleRender.material).tintColor).elements=Hc,Hd.tintColor=He},Hd._getMeshRenderSharedMaterialAlphaColor=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.alphaColor.elements:null}return Hb.meshRender.sharedMaterial.alphaColor.elements},Hd._setMeshRenderSharedMaterialAlphaColor=function(Ha,Hb,Hc){var Hd,He;if(Ha){var Hf=Ha.transform._entity;Hf&&((He=(Hd=Hf.owner.meshRender.material).alphaColor).elements=Hc,Hd.alphaColor=He)}else(He=(Hd=Hb.meshRender.material).alphaColor).elements=Hc,Hd.alphaColor=He},Hd._getMeshRenderSharedMaterialBaseColor=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.baseColor.elements:null}return Hb.meshRender.sharedMaterial.baseColor.elements},Hd._setMeshRenderSharedMaterialBaseColor=function(Ha,Hb,Hc){var Hd,He;if(Ha){var Hf=Ha.transform._entity;Hf&&((He=(Hd=Hf.owner.meshRender.material).baseColor).elements=Hc,Hd.baseColor=He)}else(He=(Hd=Hb.meshRender.material).baseColor).elements=Hc,Hd.baseColor=He},Hd._getMeshRenderSharedMaterialDissolve=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.dissolve:0}return Hb.meshRender.sharedMaterial.dissolve},Hd._setMeshRenderSharedMaterialDissolve=function(Ha,Hb,Hc){if(Ha){var Hd=Ha.transform._entity;Hd&&(Hd.owner.meshRender.material.dissolve=Hc[0])}else Hb.meshRender.material.dissolve=Hc[0]},Hd._getMeshRenderSharedMaterialDissolveSpeed=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.dissolveSpeed:0}return Hb.meshRender.sharedMaterial.dissolveSpeed},Hd._setMeshRenderSharedMaterialDissolveSpeed=function(Ha,Hb,Hc){if(Ha){var Hd=Ha.transform._entity;Hd&&(Hd.owner.meshRender.material.dissolveSpeed=Hc[0])}else Hb.meshRender.material.dissolveSpeed=Hc[0]},Hd._getMeshRenderSharedMaterialMMultiplier=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.mMultiplier:0}return Hb.meshRender.sharedMaterial.mMultiplier},Hd._setMeshRenderSharedMaterialMMultiplier=function(Ha,Hb,Hc){if(Ha){var Hd=Ha.transform._entity;Hd&&(Hd.owner.meshRender.material.mMultiplier=Hc[0])}else Hb.meshRender.material.mMultiplier=Hc[0]},Hd._getMeshRenderSharedMaterialBaseScrollSpeedX=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return Hb.meshRender.sharedMaterial.baseScrollSpeedX},Hd._setMeshRenderSharedMaterialBaseScrollSpeedX=function(Ha,Hb,Hc){if(Ha){var Hd=Ha.transform._entity;Hd&&(Hd.owner.meshRender.material.baseScrollSpeedX=Hc[0])}else Hb.meshRender.material.baseScrollSpeedX=Hc[0]},Hd._getMeshRenderSharedMaterialBaseScrollSpeedY=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return Hb.meshRender.sharedMaterial.baseScrollSpeedY},Hd._setMeshRenderSharedMaterialBaseScrollSpeedY=function(Ha,Hb,Hc){if(Ha){var Hd=Ha.transform._entity;Hd&&(Hd.owner.meshRender.material.baseScrollSpeedY=Hc[0])}else Hb.meshRender.material.baseScrollSpeedY=Hc[0]},Hd._getMeshRenderSharedMaterialSecondScrollSpeedX=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return Hb.meshRender.sharedMaterial.secondScrollSpeedX},Hd._setMeshRenderSharedMaterialSecondScrollSpeedX=function(Ha,Hb,Hc){if(Ha){var Hd=Ha.transform._entity;Hd&&(Hd.owner.meshRender.material.secondScrollSpeedX=Hc[0])}else Hb.meshRender.material.secondScrollSpeedX=Hc[0]},Hd._getMeshRenderSharedMaterialSecondScrollSpeedY=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return Hb.meshRender.sharedMaterial.secondScrollSpeedY},Hd._setMeshRenderSharedMaterialSecondScrollSpeedY=function(Ha,Hb,Hc){if(Ha){var Hd=Ha.transform._entity;Hd&&(Hd.owner.meshRender.material.secondScrollSpeedY=Hc[0])}else Hb.meshRender.material.secondScrollSpeedY=Hc[0]},Hd._getMeshRenderSharedMaterialAlpha=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.alpha:0}return Hb.meshRender.sharedMaterial.alpha},Hd._setMeshRenderSharedMaterialAlpha=function(Ha,Hb,Hc){if(Ha){var Hd=Ha.transform._entity;Hd&&(Hd.owner.meshRender.material.alpha=Hc[0])}else Hb.meshRender.material.alpha=Hc[0]},Hd._getMeshRenderSharedMaterialIntensity=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.intensity:0}return Hb.meshRender.sharedMaterial.intensity},Hd._setMeshRenderSharedMaterialIntensity=function(Ha,Hb,Hc){if(Ha){var Hd=Ha.transform._entity;Hd&&(Hd.owner.meshRender.material.intensity=Hc[0])}else Hb.meshRender.material.intensity=Hc[0]},Hd._getMeshRenderSharedMaterialDetailTilingOffset=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return Hb.meshRender.sharedMaterial.detailTilingOffset.elements},Hd._setMeshRenderSharedMaterialDetailTilingOffset=function(Ha,Hb,Hc){var Hd,He;if(Ha){var Hf=Ha.transform._entity;Hf&&((He=(Hd=Hf.owner.meshRender.material).detailTilingOffset).elements=Hc,Hd.detailTilingOffset=He)}else(He=(Hd=Hb.meshRender.material).detailTilingOffset).elements=Hc,Hd.detailTilingOffset=He},Hd._getMeshRenderSharedMaterialDissolveTilingOffset=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return Hb.meshRender.sharedMaterial.dissolveTilingOffset.elements},Hd._setMeshRenderSharedMaterialDissolveTilingOffset=function(Ha,Hb,Hc){var Hd,He;if(Ha){var Hf=Ha.transform._entity;Hf&&((He=(Hd=Hf.owner.meshRender.material).dissolveTilingOffset).elements=Hc,Hd.dissolveTilingOffset=He)}else(He=(Hd=Hb.meshRender.material).dissolveTilingOffset).elements=Hc,Hd.dissolveTilingOffset=He},Hd._getMeshRenderSharedMaterialMaskTilingOffset=function(Ha,Hb){if(Ha){var Hc=Ha.transform._entity;return Hc?Hc.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return Hb.meshRender.sharedMaterial.maskTilingOffset.elements},Hd._setMeshRenderSharedMaterialMaskTilingOffset=function(Ha,Hb,Hc){var Hd,He;if(Ha){var Hf=Ha.transform._entity;Hf&&((He=(Hd=Hf.owner.meshRender.material).maskTilingOffset).elements=Hc,Hd.maskTilingOffset=He)}else(He=(Hd=Hb.meshRender.material).maskTilingOffset).elements=Hc,Hd.maskTilingOffset=He},Hd._propertyIDCounter=0,Hd._propertyIndexDic={},Hd._propertySetFuncs=[],Hd._propertyGetFuncs=[],Hd}(),HP=function(){function Ha(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return Hn(Ha,"laya.d3.animation.Keyframe"),Ha}(),HQ=function(){function Ha(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return Hn(Ha,"laya.d3.animation.KeyframeNode"),Ha}(),HG=(function(){function Ha(){this._tempVector30=new Hgb,this._tempVector31=new Hgb,this._tempVector32=new Hgb,this._a=new Hgb,this._b=new Hgb,this._c=new Hgb,this._d=new Hgb}Hn(Ha,"laya.d3.core.glitter.SplineCurvePositionVelocity");var Hb=Ha.prototype;Hb.Init=function(Ha,Hb,Hc,Hd){Ha.cloneTo(this._d),Hb.cloneTo(this._c),Hgb.scale(Ha,2,this._a),Hgb.scale(Hc,2,this._tempVector30),Hgb.subtract(this._a,this._tempVector30,this._a),Hgb.add(this._a,Hb,this._a),Hgb.add(this._a,Hd,this._a),Hgb.scale(Hc,3,this._b),Hgb.scale(Ha,3,this._tempVector30),Hgb.subtract(this._b,this._tempVector30,this._b),Hgb.subtract(this._b,Hd,this._b),Hgb.scale(Hb,2,this._tempVector30),Hgb.subtract(this._b,this._tempVector30,this._b)},Hb.Slerp=function(Ha,Hb){Hgb.scale(this._a,Ha*Ha*Ha,this._tempVector30),Hgb.scale(this._b,Ha*Ha,this._tempVector31),Hgb.scale(this._c,Ha,this._tempVector32),Hgb.add(this._tempVector30,this._tempVector31,Hb),Hgb.add(Hb,this._tempVector32,Hb),Hgb.add(Hb,this._d,Hb)}}(),function(){function HK(Ha,Hb,Hc,Hd){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=Ha,this._h=Hb,this._minHeight=Hc,this._maxHeight=Hd}Hn(HK,"laya.d3.core.HeightMap");var Ha=HK.prototype;Ha._inBounds=function(Ha,Hb){return 0<=Ha&&Ha<this._h&&0<=Hb&&Hb<this._w},Ha.getHeight=function(Ha,Hb){return this._inBounds(Ha,Hb)?this._datas[Ha][Hb]:NaN},Ho(0,Ha,"width",function(){return this._w}),Ho(0,Ha,"height",function(){return this._h}),Ho(0,Ha,"maxHeight",function(){return this._maxHeight}),Ho(0,Ha,"minHeight",function(){return this._minHeight}),HK.creatFromMesh=function(Ha,Hb,Hc,Hd){for(var He=[],Hf=[],Hg=Ha.getSubMeshCount(),Hh=0;Hh<Hg;Hh++){for(var Hi=Ha.getSubMesh(Hh),Hj=Hi._getVertexBuffer(),Hk=Hj.getData(),Hl=[],Hm=0;Hm<Hk.length;Hm+=Hj.vertexDeclaration.vertexStride/4){var Hn=new Hgb(Hk[Hm+0],Hk[Hm+1],Hk[Hm+2]);Hl.push(Hn)}He.push(Hl);var Ho=Hi._getIndexBuffer();Hf.push(Ho.getData())}var Hp=Ha.boundingBox,Hq=Hp.min.x,Hr=Hp.min.z,Hs=Hp.max.x,Ht=Hp.max.z,Hu=Hp.min.y,Hv=Hp.max.y,Hw=Hs-Hq,Hx=Ht-Hr,Hy=Hd.elements[0]=Hw/(Hb-1),Hz=Hd.elements[1]=Hx/(Hc-1),HA=new HK(Hb,Hc,Hu,Hv),HB=HK._tempRay,HC=HB.direction.elements;HC[0]=0,HC[1]=-1,HC[2]=0;var HD=Hv+.1;HB.origin.elements[1]=HD;for(var HE=0;HE<Hc;HE++){var HF=Hr+HE*Hz;HA._datas[HE]=[];for(var HG=0;HG<Hb;HG++){var HH=Hq+HG*Hy,HI=HB.origin.elements;HI[0]=HH,HI[2]=HF;var HJ=HK._getPosition(HB,He,Hf);HA._datas[HE][HG]=HJ===Number.MAX_VALUE?NaN:HD-HJ}}return HA},HK.createFromImage=function(Ha,Hb,Hc){for(var Hd=Ha.width,He=Ha.height,Hf=new HK(Hd,He,Hb,Hc),Hg=(Hc-Hb)/254,Hh=Ha.getPixels(),Hi=0,Hj=0;Hj<He;Hj++)for(var Hk=Hf._datas[Hj]=[],Hl=0;Hl<Hd;Hl++){var Hm=Hh[Hi++],Hn=Hh[Hi++],Ho=Hh[Hi++],Hp=Hh[Hi++];Hk[Hl]=255==Hm&&255==Hn&&255==Ho&&255==Hp?NaN:(Hm+Hn+Ho)/3*Hg+Hb}return Hf},HK._getPosition=function(Ha,Hb,Hc){for(var Hd=Number.MAX_VALUE,He=0;He<Hb.length;He++)for(var Hf=Hb[He],Hg=Hc[He],Hh=0;Hh<Hg.length;Hh+=3){var Hi=Hf[Hg[Hh+0]],Hj=Hf[Hg[Hh+1]],Hk=Hf[Hg[Hh+2]],Hl=Hob.rayIntersectsTriangle(Ha,Hi,Hj,Hk);!isNaN(Hl)&&Hl<Hd&&(Hd=Hl)}return Hd},Hl(HK,["_tempRay",function(){return this._tempRay=new Heb(new Hgb,new Hgb)}])}(),function(){function He(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}Hn(He,"laya.d3.core.Layer");var Ha=He.prototype;return Ha._binarySearchIndex=function(){for(var Ha=0,Hb=He._collsionTestList.length-1,Hc=0;Ha<=Hb;){Hc=Math.floor((Ha+Hb)/2);var Hd=He._collsionTestList[Hc];if(Hd==this._number)return Hc;Hd>this._number?Hb=Hc-1:Ha=Hc+1}return Ha},Ha._addCollider=function(Ha){0===this._colliders.length&&He._collsionTestList.splice(this._binarySearchIndex(),0,this._number),Ha._isRigidbody?(this._colliders.unshift(Ha),this._nonRigidbodyOffset++):this._colliders.push(Ha)},Ha._removeCollider=function(Ha){var Hb=this._colliders.indexOf(Ha);Hb<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(Hb,1),0===this._colliders.length&&He._collsionTestList.splice(He._collsionTestList.indexOf(this._number),1)},Ho(0,Ha,"number",function(){return this._number}),Ho(0,Ha,"visible",function(){return this._visible},function(Ha){this._visible=Ha,He._visibleLayers=Ha?He._visibleLayers|this.mask:He._visibleLayers&~this.mask}),Ho(0,Ha,"mask",function(){return this._mask}),Ho(1,He,"visibleLayers",function(){return He._visibleLayers},function(Ha){He._visibleLayers=Ha;for(var Hb=0,Hc=He._layerList.length;Hb<Hc;Hb++){var Hd=He._layerList[Hb];Hd._visible=0!=(Hd._mask&He._visibleLayers)}}),He.__init__=function(){He._layerList.length=31;for(var Ha=0;Ha<31;Ha++){var Hb=new He;He._layerList[Ha]=Hb,0===Ha?(Hb.name="Default Layer",Hb.visible=!0):(Hb.name="Layer-"+Ha,Hb.visible=!1),Hb._number=Ha,Hb._mask=Math.pow(2,Ha)}He.currentCreationLayer=He._layerList[0]},He.getLayerByNumber=function(Ha){if(Ha<0||30<Ha)throw new Error("无法返回指定Layer，该number超出范围！");return He._layerList[Ha]},He.getLayerByName=function(Ha){for(var Hb=0;Hb<31;Hb++)if(He._layerList[Hb].name===Ha)return He._layerList[Hb];throw new Error("无法返回指定Layer,该name不存在")},He.isVisible=function(Ha){return 0!=(Ha&He._currentCameraCullingMask&He._visibleLayers)},He._layerList=[],He._visibleLayers=2147483647,He._collsionTestList=[],He._currentCameraCullingMask=2147483647,He.maxCount=31,He.currentCreationLayer=null,He}()),HH=(function(){function Ha(Ha,Hb,Hc){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=Ha,this._minCount=Hb,this._maxCount=Hc}Hn(Ha,"laya.d3.core.particleShuriKen.module.Burst");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb.cloneTo=function(Ha){var Hb=Ha;Hb._time=this._time,Hb._minCount=this._minCount,Hb._maxCount=this._maxCount},Hb.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Hb,"time",function(){return this._time}),Ho(0,Hb,"minCount",function(){return this._minCount}),Ho(0,Hb,"maxCount",function(){return this._maxCount})}(),function(){function Ha(Ha){this._color=null,this.enbale=!1,this._color=Ha}Hn(Ha,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var Hb=Ha.prototype;Hb.cloneTo=function(Ha){var Hb=Ha;this._color.cloneTo(Hb._color),Hb.enbale=this.enbale},Hb.clone=function(){var Ha;switch(this._color.type){case 0:Ha=HJ.createByConstant(this._color.constant.clone());break;case 1:Ha=HJ.createByGradient(this._color.gradient.clone());break;case 2:Ha=HJ.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:Ha=HJ.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var Hb=new this.constructor(Ha);return Hb.enbale=this.enbale,Hb},Ho(0,Hb,"color",function(){return this._color})}(),function(){function Ha(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}Hn(Ha,"laya.d3.core.particleShuriKen.module.Emission");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),Hb._destroy=function(){this._bursts=null,this._destroyed=!0},Hb.getBurstsCount=function(){return this._bursts.length},Hb.getBurstByIndex=function(Ha){return this._bursts[Ha]},Hb.addBurst=function(Ha){var Hb=this._bursts.length;if(0<Hb)for(var Hc=0;Hc<Hb;Hc++)this._bursts[Hc].time>Ha.time&&this._bursts.splice(Hc,0,Ha);this._bursts.push(Ha)},Hb.removeBurst=function(Ha){var Hb=this._bursts.indexOf(Ha);-1!==Hb&&this._bursts.splice(Hb,1)},Hb.removeBurstByIndex=function(Ha){this._bursts.splice(Ha,1)},Hb.clearBurst=function(){this._bursts.length=0},Hb.cloneTo=function(Ha){var Hb=Ha,Hc=Hb._bursts;Hc.length=this._bursts.length;for(var Hd=0,He=this._bursts.length;Hd<He;Hd++){var Hf=Hc[Hd];Hf?this._bursts[Hd].cloneTo(Hf):Hc[Hd]=this._bursts[Hd].clone()}Hb._emissionRate=this._emissionRate,Hb.enbale=this.enbale},Hb.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Hb,"destroyed",function(){return this._destroyed}),Ho(0,Hb,"emissionRate",function(){return this._emissionRate},function(Ha){if(Ha<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=Ha})}(),function(){function Hd(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}Hn(Hd,"laya.d3.core.particleShuriKen.module.FrameOverTime");var Ha=Hd.prototype;return Hv.imps(Ha,{"laya.d3.core.IClone":!0}),Ha.cloneTo=function(Ha){var Hb=Ha;Hb._type=this._type,Hb._constant=this._constant,this._overTime.cloneTo(Hb._overTime),Hb._constantMin=this._constantMin,Hb._constantMax=this._constantMax,this._overTimeMin.cloneTo(Hb._overTimeMin),this._overTimeMax.cloneTo(Hb._overTimeMax)},Ha.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Ha,"frameOverTimeData",function(){return this._overTime}),Ho(0,Ha,"constant",function(){return this._constant}),Ho(0,Ha,"type",function(){return this._type}),Ho(0,Ha,"frameOverTimeDataMin",function(){return this._overTimeMin}),Ho(0,Ha,"constantMin",function(){return this._constantMin}),Ho(0,Ha,"frameOverTimeDataMax",function(){return this._overTimeMax}),Ho(0,Ha,"constantMax",function(){return this._constantMax}),Hd.createByConstant=function(Ha){var Hb=new Hd;return Hb._type=0,Hb._constant=Ha,Hb},Hd.createByOverTime=function(Ha){var Hb=new Hd;return Hb._type=1,Hb._overTime=Ha,Hb},Hd.createByRandomTwoConstant=function(Ha,Hb){var Hc=new Hd;return Hc._type=2,Hc._constantMin=Ha,Hc._constantMax=Hb,Hc},Hd.createByRandomTwoOverTime=function(Ha,Hb){var Hc=new Hd;return Hc._type=3,Hc._overTimeMin=Ha,Hc._overTimeMax=Hb,Hc},Hd}()),HI=function(){function Hj(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}Hn(Hj,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var Ha=Hj.prototype;return Hv.imps(Ha,{"laya.d3.core.IClone":!0}),Ha.cloneTo=function(Ha){var Hb=Ha;Hb._type=this._type,Hb._separateAxes=this._separateAxes,Hb._constant=this._constant,this._constantSeparate.cloneTo(Hb._constantSeparate),this._gradient.cloneTo(Hb._gradient),this._gradientX.cloneTo(Hb._gradientX),this._gradientY.cloneTo(Hb._gradientY),this._gradientZ.cloneTo(Hb._gradientZ),Hb._constantMin=this._constantMin,Hb._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(Hb._constantMinSeparate),this._constantMaxSeparate.cloneTo(Hb._constantMaxSeparate),this._gradientMin.cloneTo(Hb._gradientMin),this._gradientMax.cloneTo(Hb._gradientMax),this._gradientXMin.cloneTo(Hb._gradientXMin),this._gradientXMax.cloneTo(Hb._gradientXMax),this._gradientYMin.cloneTo(Hb._gradientYMin),this._gradientYMax.cloneTo(Hb._gradientYMax),this._gradientZMin.cloneTo(Hb._gradientZMin),this._gradientZMax.cloneTo(Hb._gradientZMax)},Ha.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Ha,"gradientZ",function(){return this._gradientZ}),Ho(0,Ha,"constant",function(){return this._constant}),Ho(0,Ha,"gradient",function(){return this._gradient}),Ho(0,Ha,"separateAxes",function(){return this._separateAxes}),Ho(0,Ha,"type",function(){return this._type}),Ho(0,Ha,"constantSeparate",function(){return this._constantSeparate}),Ho(0,Ha,"gradientX",function(){return this._gradientX}),Ho(0,Ha,"gradientY",function(){return this._gradientY}),Ho(0,Ha,"gradientW",function(){return this._gradientW}),Ho(0,Ha,"gradientMin",function(){return this._gradientMin}),Ho(0,Ha,"constantMin",function(){return this._constantMin}),Ho(0,Ha,"gradientMax",function(){return this._gradientMax}),Ho(0,Ha,"constantMax",function(){return this._constantMax}),Ho(0,Ha,"gradientWMin",function(){return this._gradientWMin}),Ho(0,Ha,"constantMinSeparate",function(){return this._constantMinSeparate}),Ho(0,Ha,"constantMaxSeparate",function(){return this._constantMaxSeparate}),Ho(0,Ha,"gradientXMin",function(){return this._gradientXMin}),Ho(0,Ha,"gradientXMax",function(){return this._gradientXMax}),Ho(0,Ha,"gradientWMax",function(){return this._gradientWMax}),Ho(0,Ha,"gradientYMin",function(){return this._gradientYMin}),Ho(0,Ha,"gradientYMax",function(){return this._gradientYMax}),Ho(0,Ha,"gradientZMin",function(){return this._gradientZMin}),Ho(0,Ha,"gradientZMax",function(){return this._gradientZMax}),Hj.createByConstant=function(Ha){var Hb=new Hj;return Hb._type=0,Hb._separateAxes=!1,Hb._constant=Ha,Hb},Hj.createByConstantSeparate=function(Ha){var Hb=new Hj;return Hb._type=0,Hb._separateAxes=!0,Hb._constantSeparate=Ha,Hb},Hj.createByGradient=function(Ha){var Hb=new Hj;return Hb._type=1,Hb._separateAxes=!1,Hb._gradient=Ha,Hb},Hj.createByGradientSeparate=function(Ha,Hb,Hc,Hd){var He=new Hj;return He._type=1,He._separateAxes=!0,He._gradientX=Ha,He._gradientY=Hb,He._gradientZ=Hc,He._gradientW=Hd,He},Hj.createByRandomTwoConstant=function(Ha,Hb){var Hc=new Hj;return Hc._type=2,Hc._separateAxes=!1,Hc._constantMin=Ha,Hc._constantMax=Hb,Hc},Hj.createByRandomTwoConstantSeparate=function(Ha,Hb){var Hc=new Hj;return Hc._type=2,Hc._separateAxes=!0,Hc._constantMinSeparate=Ha,Hc._constantMaxSeparate=Hb,Hc},Hj.createByRandomTwoGradient=function(Ha,Hb){var Hc=new Hj;return Hc._type=3,Hc._separateAxes=!1,Hc._gradientMin=Ha,Hc._gradientMax=Hb,Hc},Hj.createByRandomTwoGradientSeparate=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){var Hi=new Hj;return Hi._type=3,Hi._separateAxes=!0,Hi._gradientXMin=Ha,Hi._gradientXMax=Hb,Hi._gradientYMin=Hc,Hi._gradientYMax=Hd,Hi._gradientZMin=He,Hi._gradientZMax=Hf,Hi._gradientWMin=Hg,Hi._gradientWMax=Hh,Hi},Hj}(),HJ=function(){function Hd(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}Hn(Hd,"laya.d3.core.particleShuriKen.module.GradientColor");var Ha=Hd.prototype;return Hv.imps(Ha,{"laya.d3.core.IClone":!0}),Ha.cloneTo=function(Ha){var Hb=Ha;Hb._type=this._type,this._constant.cloneTo(Hb._constant),this._constantMin.cloneTo(Hb._constantMin),this._constantMax.cloneTo(Hb._constantMax),this._gradient.cloneTo(Hb._gradient),this._gradientMin.cloneTo(Hb._gradientMin),this._gradientMax.cloneTo(Hb._gradientMax)},Ha.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Ha,"gradient",function(){return this._gradient}),Ho(0,Ha,"constant",function(){return this._constant}),Ho(0,Ha,"type",function(){return this._type}),Ho(0,Ha,"gradientMin",function(){return this._gradientMin}),Ho(0,Ha,"constantMin",function(){return this._constantMin}),Ho(0,Ha,"gradientMax",function(){return this._gradientMax}),Ho(0,Ha,"constantMax",function(){return this._constantMax}),Hd.createByConstant=function(Ha){var Hb=new Hd;return Hb._type=0,Hb._constant=Ha,Hb},Hd.createByGradient=function(Ha){var Hb=new Hd;return Hb._type=1,Hb._gradient=Ha,Hb},Hd.createByRandomTwoConstant=function(Ha,Hb){var Hc=new Hd;return Hc._type=2,Hc._constantMin=Ha,Hc._constantMax=Hb,Hc},Hd.createByRandomTwoGradient=function(Ha,Hb){var Hc=new Hd;return Hc._type=3,Hc._gradientMin=Ha,Hc._gradientMax=Hb,Hc},Hd}(),HK=(function(){function Ha(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}Hn(Ha,"laya.d3.core.particleShuriKen.module.GradientDataColor");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb.addAlpha=function(Ha,Hb){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==Ha&&(Ha=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=Ha,this._alphaElements[this._alphaCurrentLength++]=Hb):DEBUG},Hb.addRGB=function(Ha,Hb){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==Ha&&(Ha=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=Ha,this._rgbElements[this._rgbCurrentLength++]=Hb.x,this._rgbElements[this._rgbCurrentLength++]=Hb.y,this._rgbElements[this._rgbCurrentLength++]=Hb.z):DEBUG},Hb.cloneTo=function(Ha){var Hb=Ha,Hc=0,Hd=0;Hb._alphaCurrentLength=this._alphaCurrentLength;var He=Hb._alphaElements;for(He.length=this._alphaElements.length,Hc=0,Hd=this._alphaElements.length;Hc<Hd;Hc++)He[Hc]=this._alphaElements[Hc];Hb._rgbCurrentLength=this._rgbCurrentLength;var Hf=Hb._rgbElements;for(Hf.length=this._rgbElements.length,Hc=0,Hd=this._rgbElements.length;Hc<Hd;Hc++)Hf[Hc]=this._rgbElements[Hc]},Hb.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Hb,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),Ho(0,Hb,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function Ha(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}Hn(Ha,"laya.d3.core.particleShuriKen.module.GradientDataInt");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb.add=function(Ha,Hb){this._currentLength<8?(6===this._currentLength&&1!==Ha&&(Ha=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=Ha,this._elements[this._currentLength++]=Hb):console.log("Warning:data count must lessEqual than 4")},Hb.cloneTo=function(Ha){var Hb=Ha;Hb._currentLength=this._currentLength;var Hc=Hb._elements;Hc.length=this._elements.length;for(var Hd=0,He=this._elements.length;Hd<He;Hd++)Hc[Hd]=this._elements[Hd]},Hb.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Hb,"gradientCount",function(){return this._currentLength/2})}(),function(){function Ha(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}Hn(Ha,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb.add=function(Ha,Hb){this._currentLength<8?(6===this._currentLength&&1!==Ha&&(Ha=1,DEBUG),this._elements[this._currentLength++]=Ha,this._elements[this._currentLength++]=Hb):DEBUG},Hb.getKeyByIndex=function(Ha){return this._elements[2*Ha]},Hb.getValueByIndex=function(Ha){return this._elements[2*Ha+1]},Hb.getAverageValue=function(){for(var Ha=0,Hb=this._currentLength-2;Ha<Hb;Ha+=2){this._elements[Ha+1];this._elements[Ha+3],this._elements[Ha+2]-this._elements[Ha]}return 0},Hb.cloneTo=function(Ha){var Hb=Ha;Hb._currentLength=this._currentLength;var Hc=Hb._elements;Hc.length=this._elements.length;for(var Hd=0,He=this._elements.length;Hd<He;Hd++)Hc[Hd]=this._elements[Hd]},Hb.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Hb,"gradientCount",function(){return this._currentLength/2})}(),function(){function Ha(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}Hn(Ha,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb.add=function(Ha,Hb){this._currentLength<8?(6===this._currentLength&&1!==Ha&&(Ha=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=Ha,this._elements[this._currentLength++]=Hb.x,this._elements[this._currentLength++]=Hb.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},Hb.cloneTo=function(Ha){var Hb=Ha;Hb._currentLength=this._currentLength;var Hc=Hb._elements;Hc.length=this._elements.length;for(var Hd=0,He=this._elements.length;Hd<He;Hd++)Hc[Hd]=this._elements[Hd]},Hb.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Hb,"gradientCount",function(){return this._currentLength/3})}(),function(){function Hh(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}Hn(Hh,"laya.d3.core.particleShuriKen.module.GradientSize");var Ha=Hh.prototype;return Hv.imps(Ha,{"laya.d3.core.IClone":!0}),Ha.getMaxSizeInGradient=function(){var Ha=0,Hb=0,Hc=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(Ha=0,Hb=this._gradientX.gradientCount;Ha<Hb;Ha++)Hc=Math.max(Hc,this._gradientX.getValueByIndex(Ha));for(Ha=0,Hb=this._gradientY.gradientCount;Ha<Hb;Ha++)Hc=Math.max(Hc,this._gradientY.getValueByIndex(Ha))}else for(Ha=0,Hb=this._gradient.gradientCount;Ha<Hb;Ha++)Hc=Math.max(Hc,this._gradient.getValueByIndex(Ha));break;case 1:Hc=this._separateAxes?(Hc=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),Hc=Math.max(Hc,this._constantMinSeparate.y),Math.max(Hc,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(Ha=0,Hb=this._gradientXMin.gradientCount;Ha<Hb;Ha++)Hc=Math.max(Hc,this._gradientXMin.getValueByIndex(Ha));for(Ha=0,Hb=this._gradientXMax.gradientCount;Ha<Hb;Ha++)Hc=Math.max(Hc,this._gradientXMax.getValueByIndex(Ha));for(Ha=0,Hb=this._gradientYMin.gradientCount;Ha<Hb;Ha++)Hc=Math.max(Hc,this._gradientYMin.getValueByIndex(Ha));for(Ha=0,Hb=this._gradientZMax.gradientCount;Ha<Hb;Ha++)Hc=Math.max(Hc,this._gradientZMax.getValueByIndex(Ha))}else{for(Ha=0,Hb=this._gradientMin.gradientCount;Ha<Hb;Ha++)Hc=Math.max(Hc,this._gradientMin.getValueByIndex(Ha));for(Ha=0,Hb=this._gradientMax.gradientCount;Ha<Hb;Ha++)Hc=Math.max(Hc,this._gradientMax.getValueByIndex(Ha))}}return Hc},Ha.cloneTo=function(Ha){var Hb=Ha;Hb._type=this._type,Hb._separateAxes=this._separateAxes,this._gradient.cloneTo(Hb._gradient),this._gradientX.cloneTo(Hb._gradientX),this._gradientY.cloneTo(Hb._gradientY),this._gradientZ.cloneTo(Hb._gradientZ),Hb._constantMin=this._constantMin,Hb._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(Hb._constantMinSeparate),this._constantMaxSeparate.cloneTo(Hb._constantMaxSeparate),this._gradientMin.cloneTo(Hb._gradientMin),this._gradientMax.cloneTo(Hb._gradientMax),this._gradientXMin.cloneTo(Hb._gradientXMin),this._gradientXMax.cloneTo(Hb._gradientXMax),this._gradientYMin.cloneTo(Hb._gradientYMin),this._gradientYMax.cloneTo(Hb._gradientYMax),this._gradientZMin.cloneTo(Hb._gradientZMin),this._gradientZMax.cloneTo(Hb._gradientZMax)},Ha.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Ha,"gradientZ",function(){return this._gradientZ}),Ho(0,Ha,"gradient",function(){return this._gradient}),Ho(0,Ha,"separateAxes",function(){return this._separateAxes}),Ho(0,Ha,"type",function(){return this._type}),Ho(0,Ha,"gradientMin",function(){return this._gradientMin}),Ho(0,Ha,"constantMin",function(){return this._constantMin}),Ho(0,Ha,"gradientX",function(){return this._gradientX}),Ho(0,Ha,"gradientY",function(){return this._gradientY}),Ho(0,Ha,"gradientMax",function(){return this._gradientMax}),Ho(0,Ha,"constantMax",function(){return this._constantMax}),Ho(0,Ha,"constantMinSeparate",function(){return this._constantMinSeparate}),Ho(0,Ha,"constantMaxSeparate",function(){return this._constantMaxSeparate}),Ho(0,Ha,"gradientXMin",function(){return this._gradientXMin}),Ho(0,Ha,"gradientXMax",function(){return this._gradientXMax}),Ho(0,Ha,"gradientYMin",function(){return this._gradientYMin}),Ho(0,Ha,"gradientYMax",function(){return this._gradientYMax}),Ho(0,Ha,"gradientZMin",function(){return this._gradientZMin}),Ho(0,Ha,"gradientZMax",function(){return this._gradientZMax}),Hh.createByGradient=function(Ha){var Hb=new Hh;return Hb._type=0,Hb._separateAxes=!1,Hb._gradient=Ha,Hb},Hh.createByGradientSeparate=function(Ha,Hb,Hc){var Hd=new Hh;return Hd._type=0,Hd._separateAxes=!0,Hd._gradientX=Ha,Hd._gradientY=Hb,Hd._gradientZ=Hc,Hd},Hh.createByRandomTwoConstant=function(Ha,Hb){var Hc=new Hh;return Hc._type=1,Hc._separateAxes=!1,Hc._constantMin=Ha,Hc._constantMax=Hb,Hc},Hh.createByRandomTwoConstantSeparate=function(Ha,Hb){var Hc=new Hh;return Hc._type=1,Hc._separateAxes=!0,Hc._constantMinSeparate=Ha,Hc._constantMaxSeparate=Hb,Hc},Hh.createByRandomTwoGradient=function(Ha,Hb){var Hc=new Hh;return Hc._type=2,Hc._separateAxes=!1,Hc._gradientMin=Ha,Hc._gradientMax=Hb,Hc},Hh.createByRandomTwoGradientSeparate=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=new Hh;return Hg._type=2,Hg._separateAxes=!0,Hg._gradientXMin=Ha,Hg._gradientXMax=Hb,Hg._gradientYMin=Hc,Hg._gradientYMax=Hd,Hg._gradientZMin=He,Hg._gradientZMax=Hf,Hg},Hh}()),HL=function(){function Hh(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}Hn(Hh,"laya.d3.core.particleShuriKen.module.GradientVelocity");var Ha=Hh.prototype;return Hv.imps(Ha,{"laya.d3.core.IClone":!0}),Ha.cloneTo=function(Ha){var Hb=Ha;Hb._type=this._type,this._constant.cloneTo(Hb._constant),this._gradientX.cloneTo(Hb._gradientX),this._gradientY.cloneTo(Hb._gradientY),this._gradientZ.cloneTo(Hb._gradientZ),this._constantMin.cloneTo(Hb._constantMin),this._constantMax.cloneTo(Hb._constantMax),this._gradientXMin.cloneTo(Hb._gradientXMin),this._gradientXMax.cloneTo(Hb._gradientXMax),this._gradientYMin.cloneTo(Hb._gradientYMin),this._gradientYMax.cloneTo(Hb._gradientYMax),this._gradientZMin.cloneTo(Hb._gradientZMin),this._gradientZMax.cloneTo(Hb._gradientZMax)},Ha.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Ha,"gradientZ",function(){return this._gradientZ}),Ho(0,Ha,"constant",function(){return this._constant}),Ho(0,Ha,"type",function(){return this._type}),Ho(0,Ha,"gradientXMax",function(){return this._gradientXMax}),Ho(0,Ha,"constantMin",function(){return this._constantMin}),Ho(0,Ha,"gradientX",function(){return this._gradientX}),Ho(0,Ha,"gradientY",function(){return this._gradientY}),Ho(0,Ha,"gradientXMin",function(){return this._gradientXMin}),Ho(0,Ha,"constantMax",function(){return this._constantMax}),Ho(0,Ha,"gradientYMin",function(){return this._gradientYMin}),Ho(0,Ha,"gradientYMax",function(){return this._gradientYMax}),Ho(0,Ha,"gradientZMin",function(){return this._gradientZMin}),Ho(0,Ha,"gradientZMax",function(){return this._gradientZMax}),Hh.createByConstant=function(Ha){var Hb=new Hh;return Hb._type=0,Hb._constant=Ha,Hb},Hh.createByGradient=function(Ha,Hb,Hc){var Hd=new Hh;return Hd._type=1,Hd._gradientX=Ha,Hd._gradientY=Hb,Hd._gradientZ=Hc,Hd},Hh.createByRandomTwoConstant=function(Ha,Hb){var Hc=new Hh;return Hc._type=2,Hc._constantMin=Ha,Hc._constantMax=Hb,Hc},Hh.createByRandomTwoGradient=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=new Hh;return Hg._type=3,Hg._gradientXMin=Ha,Hg._gradientXMax=Hb,Hg._gradientYMin=Hc,Hg._gradientYMax=Hd,Hg._gradientZMin=He,Hg._gradientZMax=Hf,Hg},Hh}(),HM=(function(){function Ha(Ha){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=Ha}Hn(Ha,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb.cloneTo=function(Ha){var Hb=Ha;this._angularVelocity.cloneTo(Hb._angularVelocity),Hb.enbale=this.enbale},Hb.clone=function(){var Ha;switch(this._angularVelocity.type){case 0:Ha=this._angularVelocity.separateAxes?HI.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):HI.createByConstant(this._angularVelocity.constant);break;case 1:Ha=this._angularVelocity.separateAxes?HI.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):HI.createByGradient(this._angularVelocity.gradient.clone());break;case 2:Ha=this._angularVelocity.separateAxes?HI.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):HI.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:Ha=this._angularVelocity.separateAxes?HI.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):HI.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var Hb=new this.constructor(Ha);return Hb.enbale=this.enbale,Hb},Ho(0,Hb,"angularVelocity",function(){return this._angularVelocity})}(),function(){function Ha(){this.enable=!1,this.randomDirection=!1}Hn(Ha,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb._getShapeBoundBox=function(Ha){throw new Error("BaseShape: must override it.")},Hb._getSpeedBoundBox=function(Ha){throw new Error("BaseShape: must override it.")},Hb.generatePositionAndDirection=function(Ha,Hb,Hc,Hd){throw new Error("BaseShape: must override it.")},Hb._calculateProceduralBounds=function(Ha,Hb,Hc){this._getShapeBoundBox(Ha);var Hd=Ha.min,He=Ha.max;Hgb.multiply(Hd,Hb,Hd),Hgb.multiply(He,Hb,He);var Hf=new HXa(new Hgb,new Hgb);this.randomDirection?(Hf.min=new Hgb(-1,-1,-1),Hf.max=new Hgb(1,1,1)):this._getSpeedBoundBox(Hf);var Hg=new HXa(new Hgb,new Hgb),Hh=Hg.min,Hi=Hg.max;Hgb.scale(Hf.min,Hc.y,Hh),Hgb.scale(Hf.max,Hc.y,Hi),Hgb.add(Ha.min,Hh,Hh),Hgb.add(Ha.max,Hi,Hi),Hgb.min(Ha.min,Hh,Ha.min),Hgb.max(Ha.max,Hh,Ha.max);var Hj=new HXa(new Hgb,new Hgb),Hk=Hj.min,Hl=Hj.max;Hgb.scale(Hf.min,Hc.x,Hk),Hgb.scale(Hf.max,Hc.x,Hl),Hgb.min(Hj.min,Hl,Hh),Hgb.max(Hj.min,Hl,Hi),Hgb.min(Ha.min,Hh,Ha.min),Hgb.max(Ha.max,Hh,Ha.max)},Hb.cloneTo=function(Ha){Ha.enable=this.enable},Hb.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ha}()),HR=function(){function Hf(){}return Hn(Hf,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),Hf._randomPointUnitArcCircle=function(Ha,Hb,Hc){var Hd=Hb.elements,He=NaN;He=Hc?Hc.getFloat()*Ha:Math.random()*Ha,Hd[0]=Math.cos(He),Hd[1]=Math.sin(He)},Hf._randomPointInsideUnitArcCircle=function(Ha,Hb,Hc){var Hd=Hb.elements;Hf._randomPointUnitArcCircle(Ha,Hb,Hc);var He=NaN;He=Hc?Math.pow(Hc.getFloat(),.5):Math.pow(Math.random(),.5),Hd[0]=Hd[0]*He,Hd[1]=Hd[1]*He},Hf._randomPointUnitCircle=function(Ha,Hb){var Hc=Ha.elements,Hd=NaN;Hd=Hb?Hb.getFloat()*Math.PI*2:Math.random()*Math.PI*2,Hc[0]=Math.cos(Hd),Hc[1]=Math.sin(Hd)},Hf._randomPointInsideUnitCircle=function(Ha,Hb){var Hc=Ha.elements;Hf._randomPointUnitCircle(Ha);var Hd=NaN;Hd=Hb?Math.pow(Hb.getFloat(),.5):Math.pow(Math.random(),.5),Hc[0]=Hc[0]*Hd,Hc[1]=Hc[1]*Hd},Hf._randomPointUnitSphere=function(Ha,Hb){var Hc=Ha.elements,Hd=NaN,He=NaN;He=Hb?(Hd=Hc[2]=2*Hb.getFloat()-1,Hb.getFloat()*Math.PI*2):(Hd=Hc[2]=2*Math.random()-1,Math.random()*Math.PI*2);var Hf=Math.sqrt(1-Hd*Hd);Hc[0]=Hf*Math.cos(He),Hc[1]=Hf*Math.sin(He)},Hf._randomPointInsideUnitSphere=function(Ha,Hb){var Hc=Ha.elements;Hf._randomPointUnitSphere(Ha);var Hd=NaN;Hd=Hb?Math.pow(Hb.getFloat(),1/3):Math.pow(Math.random(),1/3),Hc[0]=Hc[0]*Hd,Hc[1]=Hc[1]*Hd,Hc[2]=Hc[2]*Hd},Hf._randomPointInsideHalfUnitBox=function(Ha,Hb){var Hc=Ha.elements;Hb?(Hc[0]=Hb.getFloat()-.5,Hc[1]=Hb.getFloat()-.5,Hc[2]=Hb.getFloat()-.5):(Hc[0]=Math.random()-.5,Hc[1]=Math.random()-.5,Hc[2]=Math.random()-.5)},Hf}(),HS=(function(){function Ha(Ha){this._size=null,this.enbale=!1,this._size=Ha}Hn(Ha,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb.cloneTo=function(Ha){var Hb=Ha;this._size.cloneTo(Hb._size),Hb.enbale=this.enbale},Hb.clone=function(){var Ha;switch(this._size.type){case 0:Ha=this._size.separateAxes?HK.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):HK.createByGradient(this._size.gradient.clone());break;case 1:Ha=this._size.separateAxes?HK.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):HK.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:Ha=this._size.separateAxes?HK.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):HK.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var Hb=new this.constructor(Ha);return Hb.enbale=this.enbale,Hb},Ho(0,Hb,"size",function(){return this._size})}(),function(){function Hd(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}Hn(Hd,"laya.d3.core.particleShuriKen.module.StartFrame");var Ha=Hd.prototype;return Hv.imps(Ha,{"laya.d3.core.IClone":!0}),Ha.cloneTo=function(Ha){var Hb=Ha;Hb._type=this._type,Hb._constant=this._constant,Hb._constantMin=this._constantMin,Hb._constantMax=this._constantMax},Ha.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Ha,"constant",function(){return this._constant}),Ho(0,Ha,"type",function(){return this._type}),Ho(0,Ha,"constantMin",function(){return this._constantMin}),Ho(0,Ha,"constantMax",function(){return this._constantMax}),Hd.createByConstant=function(Ha){var Hb=new Hd;return Hb._type=0,Hb._constant=Ha,Hb},Hd.createByRandomTwoConstant=function(Ha,Hb){var Hc=new Hd;return Hc._type=1,Hc._constantMin=Ha,Hc._constantMax=Hb,Hc},Hd}()),HT=(function(){function Ha(Ha,Hb){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new Hfb(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=Ha,this._startFrame=Hb}Hn(Ha,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb.cloneTo=function(Ha){var Hb=Ha;this.tiles.cloneTo(Hb.tiles),Hb.type=this.type,Hb.randomRow=this.randomRow,this._frame.cloneTo(Hb._frame),this._startFrame.cloneTo(Hb._startFrame),Hb.cycles=this.cycles,Hb.enableUVChannels=this.enableUVChannels,Hb.enable=this.enable},Hb.clone=function(){var Ha,Hb;switch(this._frame.type){case 0:Ha=HH.createByConstant(this._frame.constant);break;case 1:Ha=HH.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:Ha=HH.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:Ha=HH.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:Hb=HS.createByConstant(this._startFrame.constant);break;case 1:Hb=HS.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var Hc=new this.constructor(Ha,Hb);return this.tiles.cloneTo(Hc.tiles),Hc.type=this.type,Hc.randomRow=this.randomRow,Hc.cycles=this.cycles,Hc.enableUVChannels=this.enableUVChannels,Hc.enable=this.enable,Hc},Ho(0,Hb,"frame",function(){return this._frame}),Ho(0,Hb,"startFrame",function(){return this._startFrame})}(),function(){function Ha(Ha){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=Ha}Hn(Ha,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb.cloneTo=function(Ha){var Hb=Ha;this._velocity.cloneTo(Hb._velocity),Hb.enbale=this.enbale,Hb.space=this.space},Hb.clone=function(){var Ha;switch(this._velocity.type){case 0:Ha=HL.createByConstant(this._velocity.constant.clone());break;case 1:Ha=HL.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:Ha=HL.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:Ha=HL.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var Hb=new this.constructor(Ha);return Hb.enbale=this.enbale,Hb.space=this.space,Hb},Ho(0,Hb,"velocity",function(){return this._velocity})}(),function(){function Ha(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new Hmb,this._vb=HMb.create(Ha._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=HLb.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=HJb.nameKey.getID("LINE"),this._shaderCompile=Hyb._preCompileShader[this._sharderNameID]}Hn(Ha,"laya.d3.core.PhasorSpriter3D");var Hb=Ha.prototype;return Hb.line=function(Ha,Hb,Hc,Hd){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Ha.x,Ha.y,Ha.z,Hb.x,Hb.y,Hb.z,Hb.w),this.addVertex(Hc.x,Hc.y,Hc.z,Hd.x,Hd.y,Hd.z,Hd.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},Hb.circle=function(Ha,Hb,Hc,Hd,He,Hf){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*Hb,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/Hb,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*Ha,Math.cos(this._tempNumver0)*Ha,0,Hc,Hd,He,Hf),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},Hb.plane=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=Hd/2,this._tempNumver1=He/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Ha-this._tempNumver0,Hb+this._tempNumver1,Hc,Hf,Hg,Hh,Hi),this.addVertex(Ha+this._tempNumver0,Hb+this._tempNumver1,Hc,Hf,Hg,Hh,Hi),this.addVertex(Ha-this._tempNumver0,Hb-this._tempNumver1,Hc,Hf,Hg,Hh,Hi),this.addVertex(Ha+this._tempNumver0,Hb-this._tempNumver1,Hc,Hf,Hg,Hh,Hi),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},Hb.box=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=Hd/2,this._tempNumver1=He/2,this._tempNumver2=Hf/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Ha-this._tempNumver0,Hb+this._tempNumver1,Hc+this._tempNumver2,Hg,Hh,Hi,Hj),this.addVertex(Ha+this._tempNumver0,Hb+this._tempNumver1,Hc+this._tempNumver2,Hg,Hh,Hi,Hj),this.addVertex(Ha-this._tempNumver0,Hb-this._tempNumver1,Hc+this._tempNumver2,Hg,Hh,Hi,Hj),this.addVertex(Ha+this._tempNumver0,Hb-this._tempNumver1,Hc+this._tempNumver2,Hg,Hh,Hi,Hj),this.addVertex(Ha+this._tempNumver0,Hb+this._tempNumver1,Hc-this._tempNumver2,Hg,Hh,Hi,Hj),this.addVertex(Ha-this._tempNumver0,Hb+this._tempNumver1,Hc-this._tempNumver2,Hg,Hh,Hi,Hj),this.addVertex(Ha+this._tempNumver0,Hb-this._tempNumver1,Hc-this._tempNumver2,Hg,Hh,Hi,Hj),this.addVertex(Ha-this._tempNumver0,Hb-this._tempNumver1,Hc-this._tempNumver2,Hg,Hh,Hi,Hj),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},Hb.cone=function(Ha,Hb,Hc,Hd,He,Hf,Hg){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*Hc+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*Hc>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/Hc,this.addVertexIndex(0,Hb,0,Hd,He,Hf,Hg,this._tempUint0),this.addVertexIndex(0,0,0,Hd,He,Hf,Hg,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<Hc;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(Ha*this._tempNumver2,0,Ha*this._tempNumver3,Hd,He,Hf,Hg,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==Hc-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(Ha*this._tempNumver2,0,Ha*this._tempNumver3,Hd,He,Hf,Hg,this._tempUint0+(this._tempInt0+Hc)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==Hc-1?this.addIndexes(this._tempUint1+Hc+2):this.addIndexes(this._tempUint1+this._tempInt0+Hc+1),this.addIndexes(this._tempUint1+this._tempInt0+Hc),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},Hb.boundingBoxLine=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Ha,He,Hf,Hg,Hh,Hi,Hj),this.addVertex(Hd,He,Hf,Hg,Hh,Hi,Hj),this.addVertex(Ha,Hb,Hf,Hg,Hh,Hi,Hj),this.addVertex(Hd,Hb,Hf,Hg,Hh,Hi,Hj),this.addVertex(Hd,He,Hc,Hg,Hh,Hi,Hj),this.addVertex(Ha,He,Hc,Hg,Hh,Hi,Hj),this.addVertex(Hd,Hb,Hc,Hg,Hh,Hi,Hj),this.addVertex(Ha,Hb,Hc,Hg,Hh,Hi,Hj),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},Hb.addVertex=function(Ha,Hb,Hc,Hd,He,Hf,Hg){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=Ha,this._vbData[this._posInVBData+1]=Hb,this._vbData[this._posInVBData+2]=Hc,this._vbData[this._posInVBData+3]=Hd,this._vbData[this._posInVBData+4]=He,this._vbData[this._posInVBData+5]=Hf,this._vbData[this._posInVBData+6]=Hg,this._posInVBData+=this._floatSizePerVer,this},Hb.addVertexIndex=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){return this._hasBegun||this.addVertexIndexException(),this._vbData[Hh]=Ha,this._vbData[Hh+1]=Hb,this._vbData[Hh+2]=Hc,this._vbData[Hh+3]=Hd,this._vbData[Hh+4]=He,this._vbData[Hh+5]=Hf,this._vbData[Hh+6]=Hg,(Hh+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=Hh),this},Hb.addIndexes=function(Ha){var Hb=arguments;this._hasBegun||this.addVertexIndexException();for(var Hc=0;Hc<Hb.length;Hc++)this._ibData[this._posInIBData]=Hb[Hc],this._posInIBData++;return this},Hb.begin=function(Ha,Hb){return this._hasBegun&&this.beginException0(),1!==Ha&&4!==Ha&&this.beginException1(),this._primitiveType=Ha,this._camera=Hb,this._hasBegun=!0,this},Hb.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},Hb.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(Ha._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),Hy.drawCall++,HD.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},Hb.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},Hb.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},Hb.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},Hb.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},Hb.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},Hb.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(28,[new Hga(0,"vector3",0),new Hga(12,"vector4",1)])}]),Ha}()),HU=function(){function Ha(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++Ha._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new Hmb}Hn(Ha,"laya.d3.core.render.RenderElement");var Hb=Ha.prototype;return Hb.getDynamicBatchBakedVertexs=function(Ha){for(var Hb=this._renderObj._getVertexBuffer(Ha),Hc=Hb.getData().slice(),Hd=Hb.vertexDeclaration,He=Hd.getVertexElementByUsage(0).offset/4,Hf=Hd.getVertexElementByUsage(3).offset/4,Hg=this._sprite3D.transform,Hh=Hg.worldMatrix,Hi=Hg.rotation,Hj=Hd.vertexStride/4,Hk=0,Hl=Hc.length;Hk<Hl;Hk+=Hj){var Hm=Hk+He,Hn=Hk+Hf;Hqb.transformVector3ArrayToVector3ArrayCoordinate(Hc,Hm,Hh,Hc,Hm),Hqb.transformVector3ArrayByQuat(Hc,Hn,Hi,Hc,Hn)}return Hc},Hb.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},Hb._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},Ho(0,Hb,"id",function(){return this._id}),Ho(0,Hb,"renderObj",function(){return this._renderObj},function(Ha){this._renderObj!==Ha&&(this._renderObj=Ha)}),Ha._uniqueIDCounter=0,Ha}(),HV=function(){function Hb(Ha){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++Hb._uniqueIDCounter,this._needSort=!1,this._scene=Ha,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}Hn(Hb,"laya.d3.core.render.RenderQueue");var Ha=Hb.prototype;return Ha._sortOpaqueFunc=function(Ha,Hb){if(Ha._render&&Hb._render){var Hc=Ha._material.renderQueue-Hb._material.renderQueue;return 0==Hc?Ha._render._distanceForSort-Hb._render._distanceForSort:Hc}return 0},Ha._sortAlphaFunc=function(Ha,Hb){if(Ha._render&&Hb._render){var Hc=Ha._material.renderQueue-Hb._material.renderQueue;return 0==Hc?Hb._render._distanceForSort-Ha._render._distanceForSort:Hc}return 0},Ha._begainRenderElement=function(Ha,Hb,Hc){return!!Hb._beforeRender(Ha)},Ha._sortAlpha=function(Ha){Hb._cameraPosition=Ha,this._finalElements.sort(this._sortAlphaFunc)},Ha._sortOpaque=function(Ha){Hb._cameraPosition=Ha,this._finalElements.sort(this._sortOpaqueFunc)},Ha._preRender=function(Ha){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},Ha._render=function(Ha,Hb){for(var Hc,Hd,He,Hf,Hg,Hh,Hi=Hy.loopCount,Hj=this._scene,Hk=Ha.camera,Hl=(Hk.id,!1),Hm=0,Hn=this._finalElements.length;Hm<Hn;Hm++){var Ho,Hp,Hq,Hr=this._finalElements[Hm];if(null!=Hr._onPreRenderFunction&&Hr._onPreRenderFunction.call(Hr._sprite3D,Ha),0===Hr._type){if(Ha.owner=Hq=Hr._sprite3D,Ha.renderElement=Hr,Hq._preRenderUpdateComponents(Ha),Ho=Hr.renderObj,Hp=Hr._material,this._begainRenderElement(Ha,Ho,Hp)){if(Hc=Ho._getVertexBuffers(),!(He=(Hd=Ho._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[Hd.id]){this._errorRecord[Hd.id]=1;var Hs="vertexBuffer:"+("("+Hd._destroyed+","+Hd._released+","+Hd._referenceCount+","+Hd._buffer+")")+", material:"+(Hp?Hp.__className+"("+Hp._destroyed+","+Hp._released+")":"null")+", owner:"+(Hq?Hq.__className+"("+Hq._destroyed+","+Hq._activeInHierarchy+","+Hq._displayedInStage+")":"null")+", renderObj:"+(Ho?Ho.__className+"("+Ho._destroyed+","+Ho._released+","+Ho._referenceCount+")":"")+", parent:, url:"+(Hq?Hq.url:"")+", disposeStack:"+Hd.disposeStack;Hv.recordError("报错：unknown vertexDeclaration  "+Hs)}continue}if(Hl=(Hf=Ha._shader=Hp._getShader(Hj._shaderDefineValue,He.shaderDefineValue,Hq._shaderDefineValue)).bind()||Hi!==Hf._uploadLoopCount,Hc){if(Hf._uploadVertexBuffer!==Hc||Hl){for(var Ht=0;Ht<Hc.length;Ht++){var Hu=Hc[Ht];Hf.uploadAttributesX(Hu.vertexDeclaration.shaderValues.data,Hu)}Hf._uploadVertexBuffer=Hc}}else(Hf._uploadVertexBuffer!==Hd||Hl)&&(Hf.uploadAttributes(He.shaderValues.data,null),Hf._uploadVertexBuffer=Hd);(Hf._uploadScene!==Hj||Hl)&&(Hf.uploadSceneUniforms(Hj._shaderValues.data),Hf._uploadScene=Hj),(Hk!==Hf._uploadCamera||Hf._uploadSprite3D!==Hq||Hl)&&(Hf.uploadSpriteUniforms(Hq._shaderValues.data),Hf._uploadSprite3D=Hq),(Hk!==Hf._uploadCamera||Hl)&&(Hf.uploadCameraUniforms(Hk._shaderValues.data),Hf._uploadCamera=Hk),(Hf._uploadMaterial!==Hp||Hl)&&(Hp._upload(),Hf._uploadMaterial=Hp),Hg!==Hp?(Hp._setRenderStateBlendDepth(),Hp._setRenderStateFrontFace(Hb,Hq.transform),Hg=Hp,Hh=Hq):Hh!==Hq&&(Hp._setRenderStateFrontFace(Hb,Hq.transform),Hh=Hq),Ho._render(Ha),Hf._uploadLoopCount=Hi}Hq._postRenderUpdateComponents(Ha)}else if(2===Hr._type){Hr.renderObj;Ha.owner=Hq=Hr._sprite3D,Ha.renderElement=Hr,Ha._batchIndexStart=Hr._tempBatchIndexStart,Ha._batchIndexEnd=Hr._tempBatchIndexEnd,Ho=Hr.renderObj,Hp=Hr._material,this._begainRenderElement(Ha,Ho,Hp)&&(He=(Hd=Ho._getVertexBuffer(0)).vertexDeclaration,Hl=(Hf=Ha._shader=Hp._getShader(Hj._shaderDefineValue,He.shaderDefineValue,Hq._shaderDefineValue)).bind()||Hi!==Hf._uploadLoopCount,(Hf._uploadVertexBuffer!==Hd||Hl)&&(Hf.uploadAttributes(He.shaderValues.data,null),Hf._uploadVertexBuffer=Hd),(Hf._uploadScene!==Hj||Hl)&&(Hf.uploadSceneUniforms(Hj._shaderValues.data),Hf._uploadScene=Hj),(Hk!==Hf._uploadCamera||Hf._uploadSprite3D!==Hq||Hl)&&(Hf.uploadSpriteUniforms(Hq._shaderValues.data),Hf._uploadSprite3D=Hq),(Hk!==Hf._uploadCamera||Hl)&&(Hf.uploadCameraUniforms(Hk._shaderValues.data),Hf._uploadCamera=Hk),(Hf._uploadMaterial!==Hp||Hl)&&(Hp._upload(),Hf._uploadMaterial=Hp),Hg!==Hp?(Hp._setRenderStateBlendDepth(),Hp._setRenderStateFrontFace(Hb,Hq.transform),Hg=Hp,Hh=Hq):Hh!==Hq&&(Hp._setRenderStateFrontFace(Hb,Hq.transform),Hh=Hq),Ho._render(Ha),Hf._uploadLoopCount=Hi)}}},Ha._renderShadow=function(Ha,Hb){for(var Hc,Hd,He,Hf,Hg,Hh=Hy.loopCount,Hi=this._scene,Hj=Ha.camera,Hk=!1,Hl=0,Hm=this._finalElements.length;Hl<Hm;Hl++){var Hn,Ho,Hp,Hq=this._finalElements[Hl];0===Hq._type&&(Ha.owner=Hp=Hq._sprite3D,Hb||Hp._projectionViewWorldUpdateCamera===Hj&&Hp._projectionViewWorldUpdateLoopCount===Hy.loopCount||(Hp._render._renderUpdate(Ha._projectionViewMatrix),Hp._projectionViewWorldUpdateLoopCount=Hy.loopCount,Hp._projectionViewWorldUpdateCamera=Hj),Ha.renderElement=Hq,Hp._preRenderUpdateComponents(Ha),Hn=Hq.renderObj,Ho=Hq._material,this._begainRenderElement(Ha,Hn,null)&&(Hd=(Hc=Hn._getVertexBuffer(0)).vertexDeclaration,Hk=(He=Ha._shader=Ho._getShader(Hi._shaderDefineValue,Hd.shaderDefineValue,Hp._shaderDefineValue)).bind()||Hh!==He._uploadLoopCount,(He._uploadVertexBuffer!==Hc||Hk)&&(He.uploadAttributes(Hd.shaderValues.data,null),He._uploadVertexBuffer=Hc),(Hj!==He._uploadCamera||He._uploadSprite3D!==Hp||Hk)&&(He.uploadSpriteUniforms(Hp._shaderValues.data),He._uploadSprite3D=Hp),(Hj!==He._uploadCamera||Hk)&&(He.uploadCameraUniforms(Hj._shaderValues.data),He._uploadCamera=Hj),(He._uploadMaterial!==Ho||Hk)&&(Ho._upload(),He._uploadMaterial=Ho),He._uploadRenderElement,Hf!==Ho?(Ho._setRenderStateFrontFace(!1,Hp.transform),Hf=Ho,Hg=Hp):Hg!==Hp&&(Ho._setRenderStateFrontFace(!1,Hp.transform),Hg=Hp),Hn._render(Ha),He._uploadLoopCount=Hh),Hp._postRenderUpdateComponents(Ha))}},Ha._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},Ha._addRenderElement=function(Ha){this._renderElements.push(Ha),this._needSort=!0},Ha._addDynamicBatchElement=function(Ha){this._dynamicBatchCombineRenderElements.push(Ha)},Ho(0,Ha,"id",function(){return this._id}),Hb._uniqueIDCounter=0,Hb._cameraPosition=null,Hb}(),HW=function(){function Ha(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return Hn(Ha,"laya.d3.core.render.RenderState"),Ha.clientWidth=0,Ha.clientHeight=0,Ha}(),HX=function(){function Hg(Ha,Hb){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new HZa(new Hgb,0),this._corners=[new Hgb,new Hgb,new Hgb,new Hgb,new Hgb,new Hgb,new Hgb,new Hgb],this._boundingBoxCenter=new Hgb,this._children=Hd(8),this._objects=[],this._tempBoundBoxCorners=[new Hgb,new Hgb,new Hgb,new Hgb,new Hgb,new Hgb,new Hgb,new Hgb],this._scene=Ha,this._currentDepth=Hb}Hn(Hg,"laya.d3.core.scene.OctreeNode");var Ha=Hg.prototype;return Hv.imps(Ha,{"laya.d3.core.scene.ITreeNode":!0}),Ha.init=function(Ha,Hb){var Hc=new Hgb,Hd=new Hgb;Hgb.scale(Hb,-.5,Hc),Hgb.scale(Hb,.5,Hd),Hgb.add(Hc,Ha,Hc),Hgb.add(Hd,Ha,Hd),this.exactBox=new HXa(Hc,Hd),this.relaxBox=new HXa(Hc,Hd)},Ha.addTreeNode=function(Ha){1===Collision.boxContainsBox(this._relaxBox,Ha.boundingBox)?this.addNodeDown(Ha,0):this.addObject(Ha)},Ha.addChild=function(Ha){var Hb=this._children[Ha];if(null==Hb){Hb=new Hg(this._scene,this._currentDepth+1),(this._children[Ha]=Hb)._parent=this,Hgb.subtract(this._exactBox.max,this._exactBox.min,Hg.tempSize),Hgb.multiply(Hg.tempSize,Hg._octreeSplit[Ha],Hg.tempCenter),Hgb.add(this._exactBox.min,Hg.tempCenter,Hg.tempCenter),Hgb.scale(Hg.tempSize,.25,Hg.tempSize);var Hc=new Hgb,Hd=new Hgb;Hgb.subtract(Hg.tempCenter,Hg.tempSize,Hc),Hgb.add(Hg.tempCenter,Hg.tempSize,Hd),Hb.exactBox=new HXa(Hc,Hd),Hgb.scale(Hg.tempSize,Hg.relax,Hg.tempSize);var He=new Hgb,Hf=new Hgb;Hgb.subtract(Hg.tempCenter,Hg.tempSize,He),Hgb.add(Hg.tempCenter,Hg.tempSize,Hf),Hb.relaxBox=new HXa(He,Hf)}return Hb},Ha.addObject=function(Ha){(Ha._treeNode=this)._objects.push(Ha)},Ha.removeObject=function(Ha){if(Ha._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var Hb=this._objects.indexOf(Ha);return-1!==Hb&&(this._objects.splice(Hb,1),!0)},Ha.clearObject=function(){this._objects.length=0},Ha.addNodeUp=function(Ha,Hb){this._parent&&1!==Collision.boxContainsBox(this._exactBox,Ha.boundingBox)?this._parent.addNodeUp(Ha,Hb-1):this.addNodeDown(Ha,Hb)},Ha.addNodeDown=function(Ha,Hb){if(Hb<this._scene.treeLevel){var Hc=this.inChildIndex(Ha.boundingBoxCenter),Hd=this.addChild(Hc);1===Collision.boxContainsBox(Hd._relaxBox,Ha.boundingBox)?Hd.addNodeDown(Ha,++Hb):this.addObject(Ha)}else this.addObject(Ha)},Ha.inChildIndex=function(Ha){return 4*(Ha.z<this._boundingBoxCenter.z?0:1)+2*(Ha.y<this._boundingBoxCenter.y?0:1)+(Ha.x<this._boundingBoxCenter.x?0:1)},Ha.updateObject=function(Ha){1===Collision.boxContainsBox(this._relaxBox,Ha.boundingBox)?(this.removeObject(Ha),Ha._treeNode=null,this.addNodeDown(Ha,this._currentDepth)):this._parent&&(this.removeObject(Ha),Ha._treeNode=null,this._parent.addNodeUp(Ha,this._currentDepth-1))},Ha.cullingObjects=function(Ha,Hb,Hc,Hd,He){var Hf,Hg=0,Hh=0,Hi=0,Hj=this._scene._dynamicBatchManager;for(Hg=0,Hf=this._objects.length;Hg<Hf;Hg++){var Hk=this._objects[Hg];if(HG.isVisible(Hk._owner.layer.mask)&&Hk.enable){if(Hb&&(Hy.treeSpriteCollision+=1,0===Ha.containsBoundSphere(Hk.boundingSphere)))continue;Hk._renderUpdate(He),Hk._distanceForSort=Hgb.distance(Hk.boundingSphere.center,Hd)+Hk.sortingFudge;var Hl=Hk._renderElements;for(Hh=0,Hi=Hl.length;Hh<Hi;Hh++){var Hm=Hl[Hh],Hn=Hm._staticBatch;if(Hn&&Hn._material===Hm._material)Hn._addBatchRenderElement(Hm);else{var Ho=Hm.renderObj;Ho.triangleCount<10&&1===Ho._vertexBufferCount&&Ho._getIndexBuffer()&&Hm._material.renderQueue<2&&Hm._canDynamicBatch&&!Hk._owner.isStatic?Hj._addPrepareRenderElement(Hm):this._scene.getRenderQueue(Hm._material.renderQueue)._addRenderElement(Hm)}}}}for(Hg=0;Hg<8;Hg++){var Hp=this._children[Hg];if(null!=Hp){var Hq=Hb;if(Hb){var Hr=Ha.containsBoundBox(Hp._relaxBox);if(Hy.treeNodeCollision+=1,0===Hr)continue;Hq=2===Hr}Hp.cullingObjects(Ha,Hq,Hc,Hd,He)}}},Ha.cullingShadowObjects=function(Ha,Hb,Hc,Hd,He){var Hf,Hg=0,Hh=0,Hi=0;this._scene._dynamicBatchManager;for(Hg=0,Hf=this._objects.length;Hg<Hf;Hg++){var Hj=this._objects[Hg];if(Hj.castShadow&&HG.isVisible(Hj._owner.layer.mask)&&Hj.enable){if(Hc&&0===Ha[0].containsBoundSphere(Hj.boundingSphere))continue;for(var Hk=1,Hl=Ha.length;Hk<Hl;Hk++){var Hm=Hb[Hk-1];if(0!==Ha[Hk].containsBoundSphere(Hj.boundingSphere)){var Hn=Hj._renderElements;for(Hh=0,Hi=Hn.length;Hh<Hi;Hh++)Hm._addRenderElement(Hn[Hh])}}}}for(Hg=0;Hg<8;Hg++){var Ho=this._children[Hg];if(null!=Ho){var Hp=Hc;if(Hc){var Hq=Ha[0].containsBoundBox(Ho._relaxBox);if(0===Hq)continue;Hp=2===Hq}Ho.cullingShadowObjects(Ha,Hb,Hp,Hd,He)}}},Ha.cullingShadowObjectsOnePSSM=function(Ha,Hb,Hc,Hd,He,Hf){var Hg,Hh=Hb[0],Hi=0,Hj=0,Hk=0;for(Hi=0,Hg=this._objects.length;Hi<Hg;Hi++){var Hl=this._objects[Hi];if(Hl.castShadow&&HG.isVisible(Hl._owner.layer.mask)&&Hl.enable){if(Hd&&0===Ha.containsBoundSphere(Hl.boundingSphere))continue;Hl._renderUpdate(Hc);var Hm=Hl._renderElements;for(Hj=0,Hk=Hm.length;Hj<Hk;Hj++)Hh._addRenderElement(Hm[Hj])}}for(Hi=0;Hi<8;Hi++){var Hn=this._children[Hi];if(null!=Hn){var Ho=Hd;if(Hd){var Hp=Ha.containsBoundBox(Hn._relaxBox);if(0===Hp)continue;Ho=2===Hp}Hn.cullingShadowObjectsOnePSSM(Ha,Hb,Hc,Ho,He,Hf)}}},Ha.renderBoudingBox=function(Ha){this._renderBoudingBox(Ha);for(var Hb=0;Hb<8;++Hb){var Hc=this._children[Hb];Hc&&Hc.renderBoudingBox(Ha)}},Ha.buildAllChild=function(Ha){if(Ha<this._scene.treeLevel)for(var Hb=0;Hb<8;Hb++){this.addChild(Hb).buildAllChild(Ha+1)}},Ha._renderBoudingBox=function(Ha){},Ho(0,Ha,"exactBox",function(){return this._exactBox},function(Ha){this._exactBox=Ha,Hgb.add(Ha.min,Ha.max,this._boundingBoxCenter),Hgb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),Ho(0,Ha,"relaxBox",function(){return this._relaxBox},function(Ha){(this._relaxBox=Ha).getCorners(this._corners),HZa.createfromPoints(this._corners,this._boundingSphere)}),Hg.debugMode=!1,Hg.relax=1.15,Hg.CHILDNUM=8,Hl(Hg,["tempVector0",function(){return this.tempVector0=new Hgb},"tempSize",function(){return this.tempSize=new Hgb},"tempCenter",function(){return this.tempCenter=new Hgb},"_octreeSplit",function(){return this._octreeSplit=[new Hgb(.25,.25,.25),new Hgb(.75,.25,.25),new Hgb(.25,.75,.25),new Hgb(.75,.75,.25),new Hgb(.25,.25,.75),new Hgb(.75,.25,.75),new Hgb(.25,.75,.75),new Hgb(.75,.75,.75)]}]),Hg}(),HY=(function(){function Ha(){}Hn(Ha,"laya.d3.core.scene.SceneManager")}(),function(){function Ha(Ha,Hb,Hc,Hd){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===Ha&&(Ha=1),void 0===Hb&&(Hb=1),void 0===Hc&&(Hc=1),void 0===Hd&&(Hd=1),this._r=Ha,this._g=Hb,this._b=Hc,this._a=Hd}return Hn(Ha,"laya.d3.core.trail.module.Color",null,"Color$1"),Ha.prototype.cloneTo=function(Ha){Ha._r=this._r,Ha._g=this._g,Ha._b=this._b,Ha._a=this._a},Hl(Ha,["RED",function(){return this.RED=new Ha(1,0,0,1)},"GREEN",function(){return this.GREEN=new Ha(0,1,0,1)},"BLUE",function(){return this.BLUE=new Ha(0,0,1,1)},"CYAN",function(){return this.CYAN=new Ha(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new Ha(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new Ha(1,0,1,1)},"GRAY",function(){return this.GRAY=new Ha(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new Ha(1,1,1,1)},"BLACK",function(){return this.BLACK=new Ha(0,0,0,1)}]),Ha}()),HZ=(function(){function Ha(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}Hn(Ha,"laya.d3.core.trail.module.Gradient");var Hb=Ha.prototype;Hb.setKeys=function(Ha,Hb){var Hc,Hd;this._colorKeys=Ha;for(var He=this.index=0;He<Ha.length;He++){var Hf=(Hc=Ha[He]).color;this._colorKeyData[this.index++]=Hf._r,this._colorKeyData[this.index++]=Hf._g,this._colorKeyData[this.index++]=Hf._b,this._colorKeyData[this.index++]=Hc.time}this._alphaKeys=Hb;for(var Hg=this.index=0;Hg<Hb.length;Hg++)Hd=Hb[Hg],this._alphaKeyData[this.index++]=Hd.alpha,this._alphaKeyData[this.index++]=Hd.time},Hb.cloneTo=function(Ha){var Hb=0,Hc=0,Hd=this.colorKeys,He=[];for(Hb=0,Hc=Hd.length;Hb<Hc;Hb++){var Hf=new H$;Hd[Hb].cloneTo(Hf),He.push(Hf)}var Hg=this.alphaKeys,Hh=[];for(Hb=0,Hc=Hg.length;Hb<Hc;Hb++){var Hi=new HZ;Hg[Hb].cloneTo(Hi),Hh.push(Hi)}Ha.setKeys(He,Hh)},Ho(0,Hb,"mode",function(){return this._mode},function(Ha){this._mode=Ha}),Ho(0,Hb,"colorKeys",function(){return this._colorKeys},function(Ha){this._colorKeys=Ha;for(var Hb=this.index=0;Hb<Ha.length;Hb++){var Hc=Ha[Hb],Hd=Hc.color;this._colorKeyData[this.index++]=Hd._r,this._colorKeyData[this.index++]=Hd._g,this._colorKeyData[this.index++]=Hd._b,this._colorKeyData[this.index++]=Hc.time}}),Ho(0,Hb,"alphaKeys",function(){return this._alphaKeys},function(Ha){this._alphaKeys=Ha;for(var Hb=this.index=0;Hb<Ha.length;Hb++){var Hc=Ha[Hb];this._alphaKeyData[this.index++]=Hc.alpha,this._alphaKeyData[this.index++]=Hc.time}})}(),function(){function Ha(Ha,Hb){this._alpha=NaN,this._time=NaN,void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),this._alpha=Ha,this._time=Hb}Hn(Ha,"laya.d3.core.trail.module.GradientAlphaKey");var Hb=Ha.prototype;return Hb.cloneTo=function(Ha){Ha.alpha=this.alpha,Ha.time=this.time},Ho(0,Hb,"alpha",function(){return this._alpha},function(Ha){this._alpha=Ha}),Ho(0,Hb,"time",function(){return this._time},function(Ha){this._time=Ha}),Ha}()),H$=function(){function Ha(Ha,Hb){this._color=null,this._time=NaN,void 0===Hb&&(Hb=0),this._color=Ha||new HY,this._time=Hb}Hn(Ha,"laya.d3.core.trail.module.GradientColorKey");var Hb=Ha.prototype;return Hb.cloneTo=function(Ha){this.color.cloneTo(Ha.color),Ha.time=this.time},Ho(0,Hb,"color",function(){return this._color},function(Ha){this._color=Ha}),Ho(0,Hb,"time",function(){return this._time},function(Ha){this._time=Ha}),Ha}(),H_=(function(){function Ha(){}Hn(Ha,"laya.d3.core.trail.module.GradientMode"),Ha.Blend=0,Ha.Fixed=1}(),function(){function Ha(){}Hn(Ha,"laya.d3.core.trail.module.TextureMode"),Ha.Stretch=0,Ha.Tile=1}(),function(){function Ha(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}Hn(Ha,"laya.d3.core.trail.module.TrailKeyFrame"),Ha.prototype.cloneTo=function(Ha){Ha.time=this.time,Ha.inTangent=this.inTangent,Ha.outTangent=this.outTangent,Ha.value=this.value}}(),function(){function Hb(Ha){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new Hgb,this._curPosition=new Hgb,this._delVector3=new Hgb,this._lastFixedVertexPosition=new Hgb,this._pointAtoBVector3=new Hgb,this._pointA=new Hgb,this._pointB=new Hgb,this._owner=Ha,this._id=Hb.renderElementCount++,0==this._id?Ha._owner.transform.position.cloneTo(this._lastPosition):Ha._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new HMb(H_.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new HMb(H_.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}Hn(Hb,"laya.d3.core.trail.TrailRenderElement");var Ha=Hb.prototype;Hv.imps(Ha,{"laya.d3.core.render.IRenderable":!0}),Ha._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},Ha._addTrailByFirstPosition=function(Ha,Hb){Hgb.subtract(Hb,Ha,this._delVector3),Hgb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),Hgb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),Hgb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(Ha),Ha.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},Ha._addTrailByNextPosition=function(Ha){Hgb.subtract(Ha,this._lastFixedVertexPosition,this._delVector3),Hgb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),Hgb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),Hgb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=Hgb.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=H$a.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(Ha),Ha.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(Ha),this._virtualVerticesCount=2)},Ha._updateVerticesByPosition=function(Ha){this._pointe=Ha.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},Ha._updateVertexBuffer2=function(){var Ha,Hb=0,Hc=0,Hd=0;for(Hd=0,Ha=(this._verticesCount+this._virtualVerticesCount)/2;Hd<Ha;Hd++)Hc=0==this._owner.textureMode?(this._VerticesToTailLength[Hd]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[Hd],this._vertices2[Hb++]=1-Hc,this._vertices2[Hb++]=1-Hc;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},Ha._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},Ha._updateDisappear=function(){var Ha,Hb=0;for(Hb=this._curDisappearIndex,Ha=(this._verticesCount+this._virtualVerticesCount)/2;Hb<Ha;Hb++)this._owner._curtime-this._everyGroupVertexBirthTime[Hb]>=this._owner.time+H$a.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},Ha._beforeRender=function(Ha){return this._camera=Ha.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),Hgb.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},Ha._render=function(Ha){this._isDead||(HD.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),Hy.drawCall++,Hy.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},Ha._getVertexBuffer=function(Ha){return void 0===Ha&&(Ha=0),0===Ha?this._vertexBuffer1:1===Ha?this._vertexBuffer2:null},Ha._getVertexBuffers=function(){return this._vertexBuffers},Ha._getIndexBuffer=function(){return null},Ha.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},Ha._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},Ho(0,Ha,"_vertexBufferCount",function(){return this._vertexBuffers.length}),Ho(0,Ha,"triangleCount",function(){return 0}),Hb.renderElementCount=0}(),function(){function Ha(){}Hn(Ha,"laya.d3.core.trail.VertexTrail");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration1}),Ho(1,Ha,"vertexDeclaration1",function(){return Ha._vertexDeclaration1}),Ho(1,Ha,"vertexDeclaration2",function(){return Ha._vertexDeclaration2}),Hl(Ha,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new Hfa(32,[new Hga(0,"vector3",0),new Hga(12,"vector3",41),new Hga(24,"single",33),new Hga(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new Hfa(4,[new Hga(0,"single",38)])}]),Ha}()),Haa=function(){function Hu(Ha){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=Ha}Hn(Hu,"laya.d3.graphics.DynamicBatch");var Ha=Hu.prototype;return Hv.imps(Ha,{"laya.d3.core.render.IRenderable":!0}),Ha._getVertexBuffer=function(Ha){return void 0===Ha&&(Ha=0),0===Ha?this._vertexBuffer:null},Ha._getIndexBuffer=function(){return this._indexBuffer},Ha._getCombineRenderElementFromPool=function(Ha,Hb,Hc){var Hd=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return Hd||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=Hd=new HU,Hd._sprite3D=new HVb),Hd._sprite3D._render._renderUpdate(Hc),Hd},Ha._getRenderElement=function(Ha,Hb,Hc){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*Hu.maxVertexCount),this._indexDatas=new Uint16Array(Hu.maxIndexCount),this._vertexBuffer=HMb.create(this._vertexDeclaration,Hu.maxVertexCount,35048),this._indexBuffer=HLb.create("ushort",Hu.maxIndexCount,35048));for(var Hd=this._merageElements.length=0,He=0,Hf=0,Hg=this._combineRenderElements.length;Hf<Hg;Hf++){var Hh=this._combineRenderElements[Hf],Hi=Hh.getDynamicBatchBakedVertexs(0),Hj=Hh.getBakedIndices(),Hk=Hh._sprite3D.transform._isFrontFaceInvert,Hl=Hd/(this._vertexDeclaration.vertexStride/4),Hm=He,Hn=Hm+Hj.length;Hh._tempBatchIndexStart=Hm,Hh._tempBatchIndexEnd=Hn,this._indexDatas.set(Hj,He);var Ho=0;if(Hk)for(Ho=Hm;Ho<Hn;Ho+=3){this._indexDatas[Ho]=Hl+this._indexDatas[Ho];var Hp=this._indexDatas[Ho+1],Hq=this._indexDatas[Ho+2];this._indexDatas[Ho+1]=Hl+Hq,this._indexDatas[Ho+2]=Hl+Hp}else for(Ho=Hm;Ho<Hn;Ho+=3)this._indexDatas[Ho]=Hl+this._indexDatas[Ho],this._indexDatas[Ho+1]=Hl+this._indexDatas[Ho+1],this._indexDatas[Ho+2]=Hl+this._indexDatas[Ho+2];He+=Hj.length,this._vertexDatas.set(Hi,Hd),Hd+=Hi.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),Hf=this._combineRenderElementPoolIndex=0,Hg=this._materials.length;Hf<Hg;Hf++){var Hr=this._getCombineRenderElementFromPool(Ha,Hb,Hc);Hr._type=2,Hr._staticBatch=null;var Hs=(Hr.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[Hf]]._tempBatchIndexStart,Ht=Hf+1===this._materialToRenderElementsOffsets.length?He:this._combineRenderElements[this._materialToRenderElementsOffsets[Hf+1]]._tempBatchIndexStart;Hr._tempBatchIndexStart=Hs,Hr._tempBatchIndexEnd=Ht,Hr._material=this._materials[Hf],this._merageElements.push(Hr)}},Ha._addCombineRenderObjTest=function(Ha){var Hb=Ha.renderObj,Hc=this._currentCombineIndexCount+Hb._getIndexBuffer().indexCount,Hd=this._currentCombineVertexCount+Hb._getVertexBuffer().vertexCount;return!(Hu.maxVertexCount<Hd||Hu.maxIndexCount<Hc)},Ha._addCombineRenderObj=function(Ha){var Hb=Ha.renderObj;this._combineRenderElements.push(Ha),this._currentCombineIndexCount=this._currentCombineIndexCount+Hb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+Hb._getVertexBuffer().vertexCount},Ha._addCombineMaterial=function(Ha){this._materials.push(Ha)},Ha._addMaterialToRenderElementOffset=function(Ha){this._materialToRenderElementsOffsets.push(Ha)},Ha._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},Ha._addToRenderQueue=function(Ha,Hb,Hc,Hd){this._getRenderElement(Hb,Hc,Hd);for(var He=0,Hf=this._materials.length;He<Hf;He++)Ha.getRenderQueue(this._materials[He].renderQueue)._addDynamicBatchElement(this._merageElements[He])},Ha._beforeRender=function(Ha){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Ha._render=function(Ha){var Hb=Ha._batchIndexEnd-Ha._batchIndexStart;HD.mainContext.drawElements(4,Hb,5123,2*Ha._batchIndexStart),Hy.drawCall++,Hy.trianglesFaces+=Hb/3},Ha._getVertexBuffers=function(){return null},Ho(0,Ha,"_vertexBufferCount",function(){return 1}),Ho(0,Ha,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Ho(0,Ha,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),Hu.maxVertexCount=2e4,Hu.maxIndexCount=4e4,Hu.maxCombineTriangleCount=10,Hu}(),Hba=function(){function Hu(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}Hn(Hu,"laya.d3.graphics.DynamicBatchManager");var Ha=Hu.prototype;return Ha.getDynamicBatch=function(Ha,Hb){var Hc,Hd=Ha.id.toString()+Hb;return this._dynamicBatches[Hd]?Hc=this._dynamicBatches[Hd]:this._dynamicBatches[Hd]=Hc=new Haa(Ha),Hc},Ha._garbageCollection=function(){for(var Ha in this._dynamicBatches)0===this._dynamicBatches[Ha].combineRenderElementsCount&&delete this._dynamicBatches[Ha]},Ha._addPrepareRenderElement=function(Ha){this._prepareDynamicBatchCombineElements.push(Ha)},Ha._finishCombineDynamicBatch=function(Ha){var Hb,Hc,Hd;this._prepareDynamicBatchCombineElements.sort(Hu._sortPrepareDynamicBatch);for(var He,Hf,Hg,Hh,Hi,Hj=-1,Hk=!0,Hl=0,Hm=-1,Hn=0,Ho=this._prepareDynamicBatchCombineElements.length;Hn<Ho;Hn++){var Hp=(Hf=this._prepareDynamicBatchCombineElements[Hn]).renderObj._getVertexBuffer(0).vertexDeclaration,Hq=Hc!==Hp;Hq&&(Hl=0,Hc=Hp);var Hr=Hl!==Hj;if(Hr&&(Hj=Hl),(Hq||Hr)&&(Hg=this.getDynamicBatch(Hp,Hl),Hb=null),Hk)if(Hg._addCombineRenderObjTest(Hf)){if(Hb!==(He=Hf._material))Hh&&(Ha.getRenderQueue(Hi._material.renderQueue)._addRenderElement(Hi),Hi=Hh=null,Hm=-1),Hh=He,Hm=Hg.combineRenderElementsCount,Hi=Hf,Hb=He;else if(Hh){var Hs=Hi.renderObj,Ht=Hf.renderObj;Hs._getVertexBuffer().vertexCount+Ht._getVertexBuffer().vertexCount>Haa.maxVertexCount||Hs._getIndexBuffer().indexCount+Ht._getIndexBuffer().indexCount>Haa.maxIndexCount?(Ha.getRenderQueue(Hi._material.renderQueue)._addRenderElement(Hi),Hh=He,Hm=Hg.combineRenderElementsCount,Hi=Hf):(Hg._addCombineMaterial(Hh),Hg._addMaterialToRenderElementOffset(Hm),Hg._addCombineRenderObj(Hi),Hi=Hh=null,Hm=-1,Hg._addCombineRenderObj(Hf))}else Hg._addCombineRenderObj(Hf);Hk=!0}else Hh&&(Ha.getRenderQueue(Hi._material.renderQueue)._addRenderElement(Hi),Hi=Hh=null,Hm=-1),Hl++,Hk=!1;else Hd=this._prepareDynamicBatchCombineElements[Hn-1],Hg._addMaterialToRenderElementOffset(Hg.combineRenderElementsCount),Hb=Hd._material,Hg._addCombineMaterial(Hb),Hg._addCombineRenderObj(Hd),Hk=!0,Hb!==(He=Hf._material)?(Hh=He,Hm=Hg.combineRenderElementsCount,Hi=Hf):Hg._addCombineRenderObj(Hf),Hb=He}Hh&&(Ha.getRenderQueue(Hi._material.renderQueue)._addRenderElement(Hi),Hi=Hh=null,Hm=-1),this._prepareDynamicBatchCombineElements.length=0},Ha._clearRenderElements=function(){for(var Ha in this._dynamicBatches)this._dynamicBatches[Ha]._clearRenderElements()},Ha._addToRenderQueue=function(Ha,Hb,Hc,Hd){for(var He in this._dynamicBatches){var Hf=this._dynamicBatches[He];0<Hf.combineRenderElementsCount&&Hf._addToRenderQueue(Ha,Hb,Hc,Hd)}},Ha.dispose=function(){this._dynamicBatches=null},Hu._sortPrepareDynamicBatch=function(Ha,Hb){return Ha._mainSortID-Hb._mainSortID},Hu}(),Hca=function(){function Ha(){}return Hn(Ha,"laya.d3.graphics.FrustumCulling"),Ha.renderShadowObjectCulling=function(Ha,Hb,Hc,Hd,He){var Hf=0,Hg=0,Hh=0,Hi=0;for(Hf=0,Hh=Hc.length;Hf<Hh;Hf++){var Hj=Hc[Hf];Hj&&Hj._clearRenderElements()}var Hk,Hl,Hm,Hn=Ha._cullingRenders;if(1<He){for(Hf=0,Hh=Ha._cullingRendersLength;Hf<Hh;Hf++)if((Hk=Hn[Hf]).castShadow&&HG.isVisible(Hk._owner.layer.mask)&&Hk.enable)for(var Ho=1,Hp=Hb.length;Ho<Hp;Ho++)if(Hl=Hc[Ho-1],0!==Hb[Ho].containsBoundSphere(Hk.boundingSphere))for(Hg=0,Hi=(Hm=Hk._renderElements).length;Hg<Hi;Hg++)Hl._addRenderElement(Hm[Hg])}else for(Hf=0,Hh=Ha._cullingRendersLength;Hf<Hh;Hf++)if((Hk=Hn[Hf]).castShadow&&HG.isVisible(Hk._owner.layer.mask)&&Hk.enable&&0!==Hb[0].containsBoundSphere(Hk.boundingSphere))for(Hk._renderUpdate(Hd),Hl=Hc[0],Hg=0,Hi=(Hm=Hk._renderElements).length;Hg<Hi;Hg++)Hl._addRenderElement(Hm[Hg])},Ha.renderShadowObjectCullingOctree=function(Ha,Hb,Hc,Hd,He){for(var Hf=0,Hg=Hc.length;Hf<Hg;Hf++){var Hh=Hc[Hf];Hh&&Hh._clearRenderElements()}1<He?Ha.treeRoot.cullingShadowObjects(Hb,Hc,!0,0,Ha):Ha.treeRoot.cullingShadowObjectsOnePSSM(Hb[0],Hc,Hd,!0,0,Ha)},Ha.renderObjectCulling=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=0,Hh=0,Hi=0,Hj=0,Hk=Hb._quenes,Hl=Hb._dynamicBatchManager,Hm=Hb._cullingRenders;for(Hg=0,Hh=Hk.length;Hg<Hh;Hg++){var Hn=Hk[Hg];Hn&&Hn._clearRenderElements()}var Ho=Hda._staticBatchManagers;for(Hg=0,Hh=Ho.length;Hg<Hh;Hg++)Ho[Hg]._clearRenderElements();Hl._clearRenderElements();var Hp=Hc.transform.position;for(Hg=0,Hh=Hb._cullingRendersLength;Hg<Hh;Hg++){var Hq=Hm[Hg];if(HG.isVisible(Hq._owner.layer.mask)&&Hq.enable&&0!==Ha.containsBoundSphere(Hq.boundingSphere)&&Hq._renderUpdate(Hf)){Hq._distanceForSort=Hgb.distance(Hq.boundingSphere.center,Hp)+Hq.sortingFudge;var Hr=Hq._renderElements;for(Hi=0,Hj=Hr.length;Hi<Hj;Hi++){var Hs=Hr[Hi],Ht=Hs._staticBatch;if(Ht&&Ht._material===Hs._material)Ht._addBatchRenderElement(Hs);else{var Hu=Hs.renderObj;Hu.triangleCount<10&&1===Hu._vertexBufferCount&&Hu._getIndexBuffer()&&Hs._material.renderQueue<2&&Hs._canDynamicBatch&&!Hq._owner.isStatic?Hl._addPrepareRenderElement(Hs):Hb.getRenderQueue(Hs._material.renderQueue)._addRenderElement(Hs)}}}}for(Hg=0,Hh=Ho.length;Hg<Hh;Hg++)Ho[Hg]._addToRenderQueue(Hb,Hd,He,Hf);Hl._finishCombineDynamicBatch(Hb),Hl._addToRenderQueue(Hb,Hd,He,Hf)},Ha.renderObjectCullingOctree=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=0,Hh=0,Hi=Hb._quenes,Hj=Hb._dynamicBatchManager;for(Hg=0,Hh=Hi.length;Hg<Hh;Hg++){var Hk=Hi[Hg];Hk&&Hk._clearRenderElements()}var Hl=Hda._staticBatchManagers;for(Hg=0,Hh=Hl.length;Hg<Hh;Hg++)Hl[Hg]._clearRenderElements();for(Hj._clearRenderElements(),Hb._cullingRenders.length=0,Hb.treeRoot.cullingObjects(Ha,!0,0,Hc.transform.position,Hf),Hg=0,Hh=Hl.length;Hg<Hh;Hg++)Hl[Hg]._addToRenderQueue(Hb,Hd,He,Hf);Hj._finishCombineDynamicBatch(Hb),Hj._addToRenderQueue(Hb,Hd,He,Hf)},Ha.renderObjectCullingNoBoundFrustum=function(Ha,Hb,Hc,Hd,He){var Hf=0,Hg=0,Hh=0,Hi=0,Hj=Ha._quenes,Hk=Ha._dynamicBatchManager,Hl=Ha._cullingRenders;for(Hf=0,Hg=Hj.length;Hf<Hg;Hf++){var Hm=Hj[Hf];Hm&&Hm._clearRenderElements()}var Hn=Hda._staticBatchManagers;for(Hf=0,Hg=Hn.length;Hf<Hg;Hf++)Hn[Hf]._clearRenderElements();Hk._clearRenderElements();var Ho=Hb.transform.position;for(Hf=0,Hg=Ha._cullingRendersLength;Hf<Hg;Hf++){var Hp=Hl[Hf];if(HG.isVisible(Hp._owner.layer.mask)&&Hp.enable){Hp._renderUpdate(He),Hp._distanceForSort=Hgb.distance(Hp.boundingSphere.center,Ho)+Hp.sortingFudge;var Hq=Hp._renderElements;for(Hh=0,Hi=Hq.length;Hh<Hi;Hh++){var Hr=Hq[Hh],Hs=Hr._staticBatch;if(Hs&&Hs._material===Hr._material)Hs._addBatchRenderElement(Hr);else{var Ht=Hr.renderObj;Ht.triangleCount<10&&1===Ht._vertexBufferCount&&Ht._getIndexBuffer()&&Hr._material.renderQueue<2&&Hr._canDynamicBatch&&!Hp._owner.isStatic?Hk._addPrepareRenderElement(Hr):Ha.getRenderQueue(Hr._material.renderQueue)._addRenderElement(Hr)}}}}for(Hf=0,Hg=Hn.length;Hf<Hg;Hf++)Hn[Hf]._addToRenderQueue(Ha,Hc,Hd,He);Hk._finishCombineDynamicBatch(Ha),Hk._addToRenderQueue(Ha,Hc,Hd,He)},Ha}(),Hda=function(){function Hf(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}Hn(Hf,"laya.d3.graphics.StaticBatchManager");var Ha=Hf.prototype;return Ha._finishInit=function(){for(var Ha in this._staticBatches)this._staticBatches[Ha]._finishInit();this._initBatchRenderElements.length=0},Ha._initStaticBatchs=function(Ha){throw new Error("StaticBatchManager:must override this function.")},Ha._addInitBatchSprite=function(Ha){for(var Hb=Ha._render._renderElements,Hc=0,Hd=Hb.length;Hc<Hd;Hc++)this._initBatchRenderElements.push(Hb[Hc])},Ha._clearRenderElements=function(){for(var Ha in this._staticBatches)this._staticBatches[Ha]._clearRenderElements()},Ha._garbageCollection=function(Ha){var Hb=Ha._staticBatch,Hc=Hb._initBatchRenderElements,Hd=Hc.indexOf(Ha);Hc.splice(Hd,1),0===Hc.length&&(Hb.dispose(),delete this._staticBatches[Hb._key])},Ha._addToRenderQueue=function(Ha,Hb,Hc,Hd){for(var He in this._staticBatches){var Hf=this._staticBatches[He];0<Hf._batchRenderElements.length&&Hf._updateToRenderQueue(Ha,Hd)}},Ha.dispose=function(){this._staticBatches=null},Hf._addToStaticBatchQueue=function(Ha){Ha instanceof laya.d3.core.RenderableSprite3D&&Ha._addToInitStaticBatchManager();for(var Hb=0,Hc=Ha.numChildren;Hb<Hc;Hb++)Hf._addToStaticBatchQueue(Ha._childs[Hb])},Hf.combine=function(Ha,Hb){var Hc,Hd=0,He=0;if(Hb)for(Hd=0,He=Hb.length;Hd<He;Hd++){Hb[Hd]._addToInitStaticBatchManager()}else Ha&&Hf._addToStaticBatchQueue(Ha);for(Hd=0,He=Hf._staticBatchManagers.length;Hd<He;Hd++)(Hc=Hf._staticBatchManagers[Hd])._initStaticBatchs(Ha),Hc._finishInit()},Hf._staticBatchManagers=[],Hf}(),Hea=function(){function Ha(Ha,Hb,Hc){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=Ha,this._manager=Hb,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=Hc}Hn(Ha,"laya.d3.graphics.StaticBatch");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),Hb._binarySearch=function(Ha){for(var Hb=0,Hc=this._batchRenderElements.length-1,Hd=0;Hb<=Hc;)Hd=Math.floor((Hb+Hc)/2),this._compareBatchRenderElement(this._batchRenderElements[Hd],Ha)?Hc=Hd-1:Hb=Hd+1;return Hb},Hb._compareBatchRenderElement=function(Ha,Hb){throw new Error("StaticBatch:must override this function.")},Hb._getVertexDecLightMap=function(Ha){return Ha===HLa.vertexDeclaration?HGa.vertexDeclaration:Ha===HKa.vertexDeclaration?HFa.vertexDeclaration:Ha===Hza.vertexDeclaration?Hua.vertexDeclaration:Ha===HPa.vertexDeclaration?null:Ha===Hpa.vertexDeclaration?Hqa.vertexDeclaration:Ha===HNa.vertexDeclaration?HIa.vertexDeclaration:Ha===HDa.vertexDeclaration?HEa.vertexDeclaration:Ha===HMa.vertexDeclaration?HHa.vertexDeclaration:Ha===HKa.vertexDeclaration?HFa.vertexDeclaration:Ha===HAa.vertexDeclaration?Hva.vertexDeclaration:Ha===HPa.vertexDeclaration?null:Ha===Hpa.vertexDeclaration?Hqa.vertexDeclaration:Ha===HOa.vertexDeclaration?HJa.vertexDeclaration:Ha===HDa.vertexDeclaration?HEa.vertexDeclaration:Ha},Hb._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},Hb._addBatchRenderElement=function(Ha){this._batchRenderElements.splice(this._binarySearch(Ha),0,Ha)},Hb._updateToRenderQueue=function(Ha,Hb){this._combineRenderElementPoolIndex=0,this._getRenderElement(Ha.getRenderQueue(this._material.renderQueue)._renderElements,Ha,Hb)},Hb._getRenderElement=function(Ha,Hb,Hc){throw new Error("StaticBatch:must override this function.")},Hb._finishInit=function(){throw new Error("StaticBatch:must override this function.")},Hb._clearRenderElements=function(){this._batchRenderElements.length=0},Hb.dispose=function(){},Hb._getVertexBuffer=function(Ha){return void 0===Ha&&(Ha=0),null},Hb._getIndexBuffer=function(){return null},Hb._beforeRender=function(Ha){return!0},Hb._render=function(Ha){},Hb._getVertexBuffers=function(){return null},Ho(0,Hb,"_vertexBufferCount",function(){return 1}),Ho(0,Hb,"triangleCount",function(){return 0}),Ha.combine=function(Ha){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),Hda.combine(Ha)},Ha.maxBatchVertexCount=65535,Ha}(),Hfa=function(){function Hg(Ha,Hb){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++Hg._uniqueIDCounter,this._id>Hg.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",Hg.maxVertexDeclaration);this._shaderValues=new Hmb,this._vertexElementsDic={},this._vertexStride=Ha,this._vertexElements=Hb;for(var Hc=0;Hc<Hb.length;Hc++){var Hd=Hb[Hc],He=Hd.elementUsage;this._vertexElementsDic[He]=Hd;var Hf=[Hg._getTypeSize(Hd.elementFormat)/4,5126,!1,this._vertexStride,Hd.offset];switch(this._shaderValues.setValue(He,Hf),He){case 1:this._addShaderDefine(Hyb.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(Hyb.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(Hyb.SHADERDEFINE_UV1)}}}Hn(Hg,"laya.d3.graphics.VertexDeclaration");var Ha=Hg.prototype;return Ha._addShaderDefine=function(Ha){this._shaderDefineValue|=Ha},Ha._removeShaderDefine=function(Ha){this._shaderDefineValue&=~Ha},Ha.getVertexElements=function(){return this._vertexElements.slice()},Ha.getVertexElementByUsage=function(Ha){return this._vertexElementsDic[Ha]},Ha.unBinding=function(){},Ho(0,Ha,"shaderDefineValue",function(){return this._shaderDefineValue}),Ho(0,Ha,"id",function(){return this._id}),Ho(0,Ha,"vertexStride",function(){return this._vertexStride}),Ho(0,Ha,"shaderValues",function(){return this._shaderValues}),Hg._getTypeSize=function(Ha){switch(Ha){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},Hg.getVertexStride=function(Ha){for(var Hb=0,Hc=0;Hc<Ha.Length;Hc++){var Hd=Ha[Hc],He=Hd.offset+Hg._getTypeSize(Hd.elementFormat);Hb<He&&(Hb=He)}return Hb},Hg._maxVertexDeclarationBit=1e3,Hg._uniqueIDCounter=1,Hl(Hg,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),Hg}(),Hga=function(){function Ha(Ha,Hb,Hc){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=Ha,this.elementFormat=Hb,this.elementUsage=Hc}return Hn(Ha,"laya.d3.graphics.VertexElement"),Ha}(),Hha=(function(){function Ha(){}Hn(Ha,"laya.d3.graphics.VertexElementFormat"),Ha.Single="single",Ha.Vector2="vector2",Ha.Vector3="vector3",Ha.Vector4="vector4",Ha.Color="color",Ha.Byte4="byte4",Ha.Short2="short2",Ha.Short4="short4",Ha.NormalizedShort2="normalizedshort2",Ha.NormalizedShort4="normalizedshort4",Ha.HalfVector2="halfvector2",Ha.HalfVector4="halfvector4"}(),function(){function Ha(){}Hn(Ha,"laya.d3.graphics.VertexElementUsage"),Ha.POSITION0=0,Ha.COLOR0=1,Ha.TEXTURECOORDINATE0=2,Ha.NORMAL0=3,Ha.BINORMAL0=4,Ha.TANGENT0=5,Ha.BLENDINDICES0=6,Ha.BLENDWEIGHT0=7,Ha.DEPTH0=8,Ha.FOG0=9,Ha.POINTSIZE0=10,Ha.SAMPLE0=11,Ha.TESSELLATEFACTOR0=12,Ha.COLOR1=13,Ha.NEXTTEXTURECOORDINATE0=14,Ha.TEXTURECOORDINATE1=15,Ha.NEXTTEXTURECOORDINATE1=16,Ha.CORNERTEXTURECOORDINATE0=17,Ha.VELOCITY0=18,Ha.STARTCOLOR0=19,Ha.STARTSIZE=20,Ha.AGEADDSCALE0=21,Ha.STARTROTATION=22,Ha.ENDCOLOR0=23,Ha.STARTLIFETIME=24,Ha.TIME0=33,Ha.SHAPEPOSITIONSTARTLIFETIME=30,Ha.DIRECTIONTIME=32,Ha.SIZEROTATION0=27,Ha.RADIUS0=28,Ha.RADIAN0=29,Ha.STARTSPEED=31,Ha.RANDOM0=34,Ha.RANDOM1=35,Ha.SIMULATIONWORLDPOSTION=36,Ha.SIMULATIONWORLDROTATION=37,Ha.TEXTURECOORDINATE0X=38,Ha.TEXTURECOORDINATE0X1=39,Ha.TEXTURECOORDINATE0Y=40,Ha.OFFSETVECTOR=41}(),function(){function Ha(Ha,Hb,Hc){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=Ha,this._textureCoordinate0=Hb,this._time=Hc}Hn(Ha,"laya.d3.graphics.VertexGlitter");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate0}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"time",function(){return this._time}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(24,[new Hga(0,"vector3",0),new Hga(12,"vector2",2),new Hga(20,"single",33)])}])}(),function(){function Ha(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=Ha,this._position=Hb,this._velocity=Hc,this._startColor=Hd,this._endColor=He,this._sizeRotation=Hf,this._radius=Hg,this._radian=Hh,this._ageAddScale=Hi,this._time=Hj}Hn(Ha,"laya.d3.graphics.VertexParticle");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"endColor",function(){return this._endColor}),Ho(0,Hb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Ho(0,Hb,"sizeRotation",function(){return this._sizeRotation}),Ho(0,Hb,"velocity",function(){return this._velocity}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"startColor",function(){return this._startColor}),Ho(0,Hb,"radius",function(){return this._radius}),Ho(0,Hb,"radian",function(){return this._radian}),Ho(0,Hb,"ageAddScale",function(){return this._ageAddScale}),Ho(0,Hb,"time",function(){return this._time}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(116,[new Hga(0,"vector4",17),new Hga(16,"vector3",0),new Hga(28,"vector3",18),new Hga(40,"vector4",19),new Hga(56,"vector4",23),new Hga(72,"vector3",27),new Hga(84,"vector2",28),new Hga(92,"vector4",29),new Hga(108,"single",24),new Hga(112,"single",33)])}])}(),function(){function Ha(Ha){this._position=null,this._position=Ha}Hn(Ha,"laya.d3.graphics.VertexPosition");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(12,[new Hga(0,"vector3",0)])}]),Ha}()),Hia=function(){function Ha(Ha,Hb){this._position=null,this._normal=null,this._position=Ha,this._normal=Hb}Hn(Ha,"laya.d3.graphics.VertexPositionNormal");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(24,[new Hga(0,"vector3",0),new Hga(12,"vector3",3)])}]),Ha}(),Hja=function(){function Ha(Ha,Hb,Hc){this._position=null,this._normal=null,this._color=null,this._position=Ha,this._normal=Hb,this._color=Hc}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColor");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(40,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1)])}]),Ha}(),Hka=function(){function Ha(Ha,Hb,Hc,Hd,He){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._blendIndex=Hd,this._blendWeight=He}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorSkin");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(72,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector4",7),new Hga(56,"vector4",6)])}]),Ha}(),Hla=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._tangent=Hd,this._blendIndex=He,this._blendWeight=Hf}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(88,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector4",7),new Hga(56,"vector4",6),new Hga(72,"vector4",5)])}]),Ha}(),Hma=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._tangent=Hd,this._blendIndex=He,this._blendWeight=Hf}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(84,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector4",7),new Hga(56,"vector4",6),new Hga(72,"vector3",5)])}]),Ha}(),Hna=function(){function Ha(Ha,Hb,Hc,Hd){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._tangent=Hd}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorSTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(56,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector4",5)])}]),Ha}(),Hoa=function(){function Ha(Ha,Hb,Hc,Hd){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._tangent=Hd}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(52,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector3",5)])}]),Ha}(),Hpa=function(){function Ha(Ha,Hb,Hc,Hd){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._textureCoordinate=Hd}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTexture");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(48,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector2",2)])}]),Ha}(),Hqa=function(){function Ha(Ha,Hb,Hc,Hd,He){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._textureCoordinate0=Hd,this._textureCoordinate1=He}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(56,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector2",2),new Hga(48,"vector2",15)])}]),Ha}(),Hra=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf,Hg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._textureCoordinate0=Hd,this._textureCoordinate1=He,this._blendIndex=Hf,this._blendWeight=Hg}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(88,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector2",2),new Hga(48,"vector2",15),new Hga(56,"vector4",7),new Hga(72,"vector4",6)])}]),Ha}(),Hsa=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._textureCoordinate0=Hd,this._textureCoordinate1=He,this._tangent=Hf,this._blendIndex=Hg,this._blendWeight=Hh}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(104,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector2",2),new Hga(48,"vector2",15),new Hga(56,"vector4",7),new Hga(72,"vector4",6),new Hga(88,"vector4",5)])}]),Ha}(),Hta=function(){function Ha(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Hb.VertexPositionNormalColorTexture0SkinTangent=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){this._position=Ha,this._normal=Hb,this._color=Hc,this._textureCoordinate0=Hd,this._textureCoordinate1=He,this._tangent=Hf,this._blendIndex=Hg,this._blendWeight=Hh},Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(100,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector2",2),new Hga(48,"vector2",15),new Hga(56,"vector4",7),new Hga(72,"vector4",6),new Hga(88,"vector3",5)])}]),Ha}(),Hua=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._textureCoordinate0=Hd,this._textureCoordinate1=He,this._tangent=Hf}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(72,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector2",2),new Hga(48,"vector2",15),new Hga(56,"vector4",5)])}]),Ha}(),Hva=function(){function Ha(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Hb.VertexPositionNormalColorTexture0Tangent=function(Ha,Hb,Hc,Hd,He,Hf){this._position=Ha,this._normal=Hb,this._color=Hc,this._textureCoordinate0=Hd,this._textureCoordinate1=He,this._tangent=Hf},Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(68,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector2",2),new Hga(48,"vector2",15),new Hga(56,"vector3",5)])}]),Ha}(),Hwa=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._textureCoordinate=Hd,this._blendIndex=He,this._blendWeight=Hf}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(80,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector2",2),new Hga(48,"vector4",7),new Hga(64,"vector4",6)])}]),Ha}(),Hxa=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf,Hg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._textureCoordinate=Hd,this._tangent=He,this._blendIndex=Hf,this._blendWeight=Hg}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(96,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector2",2),new Hga(48,"vector4",7),new Hga(64,"vector4",6),new Hga(80,"vector4",5)])}]),Ha}(),Hya=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf,Hg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._textureCoordinate=Hd,this._tangent=He,this._blendIndex=Hf,this._blendWeight=Hg}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(92,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector2",2),new Hga(48,"vector4",7),new Hga(64,"vector4",6),new Hga(80,"vector3",5)])}]),Ha}(),Hza=function(){function Ha(Ha,Hb,Hc,Hd,He){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._textureCoordinate=Hd,this._tangent=He}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(64,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector2",2),new Hga(48,"vector4",5)])}]),Ha}(),HAa=function(){function Ha(Ha,Hb,Hc,Hd,He){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._color=Hc,this._textureCoordinate=Hd,this._tangent=He}Hn(Ha,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"color",function(){return this._color}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(60,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",1),new Hga(40,"vector2",2),new Hga(48,"vector3",5)])}]),Ha}(),HBa=function(){function Ha(Ha,Hb,Hc){this._position=null,this._normal=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._tangent=Hc}Hn(Ha,"laya.d3.graphics.VertexPositionNormalSTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(40,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector4",5)])}]),Ha}(),HCa=function(){function Ha(Ha,Hb,Hc){this._position=null,this._normal=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._tangent=Hc}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(36,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector3",5)])}]),Ha}(),HDa=function(){function Ha(Ha,Hb,Hc){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Ha,this._normal=Hb,this._textureCoordinate=Hc}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTexture");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(32,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2)])}]),Ha}(),HEa=function(){function Ha(Ha,Hb,Hc,Hd){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=Ha,this._normal=Hb,this._textureCoordinate0=Hc,this._textureCoordinate1=Hd}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(40,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2),new Hga(32,"vector2",15)])}]),Ha}(),HFa=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=Ha,this._normal=Hb,this._textureCoordinate0=Hc,this._textureCoordinate1=Hd,this._blendIndex=He,this._blendWeight=Hf}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(72,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2),new Hga(32,"vector2",15),new Hga(40,"vector4",7),new Hga(56,"vector4",6)])}]),Ha}(),HGa=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf,Hg){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._textureCoordinate0=Hc,this._textureCoordinate1=Hd,this._tangent=He,this._blendIndex=Hf,this._blendWeight=Hg}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(88,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2),new Hga(32,"vector2",15),new Hga(40,"vector4",7),new Hga(56,"vector4",6),new Hga(72,"vector4",5)])}]),Ha}(),HHa=function(){function Ha(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Hb.VertexPositionNormalTexture0SkinTangent=function(Ha,Hb,Hc,Hd,He,Hf,Hg){this._position=Ha,this._normal=Hb,this._textureCoordinate0=Hc,this._textureCoordinate1=Hd,this._tangent=He,this._blendIndex=Hf,this._blendWeight=Hg},Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(84,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2),new Hga(32,"vector2",15),new Hga(40,"vector4",7),new Hga(56,"vector4",6),new Hga(72,"vector3",5)])}]),Ha}(),HIa=function(){function Ha(Ha,Hb,Hc,Hd,He){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._textureCoordinate0=Hc,this._textureCoordinate1=Hd,this._tangent=He}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(56,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2),new Hga(32,"vector2",15),new Hga(40,"vector4",5)])}]),Ha}(),HJa=function(){function Ha(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Hb.VertexPositionNormalTexture0Tangent=function(Ha,Hb,Hc,Hd,He){this._position=Ha,this._normal=Hb,this._textureCoordinate0=Hc,this._textureCoordinate1=Hd,this._tangent=He},Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(52,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2),new Hga(32,"vector2",15),new Hga(40,"vector3",5)])}]),Ha}(),HKa=function(){function Ha(Ha,Hb,Hc,Hd,He){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=Ha,this._normal=Hb,this._textureCoordinate=Hc,this._blendIndex=Hd,this._blendWeight=He}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTextureSkin");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(64,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2),new Hga(32,"vector4",7),new Hga(48,"vector4",6)])}]),Ha}(),HLa=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._textureCoordinate=Hc,this._tangent=Hd,this._blendIndex=He,this._blendWeight=Hf}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(80,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2),new Hga(32,"vector4",7),new Hga(48,"vector4",6),new Hga(64,"vector4",5)])}]),Ha}(),HMa=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._textureCoordinate=Hc,this._tangent=Hd,this._blendIndex=He,this._blendWeight=Hf}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(76,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2),new Hga(32,"vector4",7),new Hga(48,"vector4",6),new Hga(64,"vector3",5)])}]),Ha}(),HNa=function(){function Ha(Ha,Hb,Hc,Hd){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._textureCoordinate=Hc,this._tangent=Hd}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(48,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2),new Hga(32,"vector4",5)])}]),Ha}(),HOa=function(){function Ha(Ha,Hb,Hc,Hd){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=Ha,this._normal=Hb,this._textureCoordinate=Hc,this._tangent=Hd}Hn(Ha,"laya.d3.graphics.VertexPositionNormalTextureTangent");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(44,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2),new Hga(32,"vector3",5)])}]),Ha}(),HPa=function(){function Ha(Ha,Hb,Hc){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Ha,this._normal=Hb,this._textureCoordinate=Hc}Hn(Ha,"laya.d3.graphics.VertexPositionNTBTexture");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(56,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector3",5),new Hga(36,"vector3",4),new Hga(48,"vector2",2)])}]),Ha}(),HQa=function(){function Ha(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=Ha,this._normal=Hb,this._textureCoordinate0=Hd,this._textureCoordinate1=He,this._tangent=Hf,Hc=Hc,this._blendIndex=Hg,this._blendWeight=Hh}Hn(Ha,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"tangent",function(){return this._tangent}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(0,Hb,"textureCoordinate1",function(){return this._textureCoordinate1}),Ho(0,Hb,"blendIndex",function(){return this._blendIndex}),Ho(0,Hb,"blendWeight",function(){return this._blendWeight}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(96,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector3",5),new Hga(36,"vector3",4),new Hga(48,"vector2",2),new Hga(56,"vector2",15),new Hga(64,"vector4",7),new Hga(80,"vector4",6)])}]),Ha}(),HRa=function(){function Ha(Ha,Hb,Hc){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Ha,this._normal=Hb,this._textureCoordinate=Hc}Hn(Ha,"laya.d3.graphics.VertexPositionNTBTextureSkin");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"textureCoordinate",function(){return this._textureCoordinate}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(88,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector3",5),new Hga(36,"vector3",4),new Hga(48,"vector2",2),new Hga(56,"vector4",7),new Hga(72,"vector4",6)])}]),Ha}(),HSa=(function(){function Ha(Ha,Hb,Hc,Hd){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=Ha,this._normal=Hb,this._textureCoord0=Hc,this._textureCoord1=Hd}Hn(Ha,"laya.d3.graphics.VertexPositionTerrain");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"normal",function(){return this._normal}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"textureCoord0",function(){return this._textureCoord0}),Ho(0,Hb,"textureCoord1",function(){return this._textureCoord1}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(40,[new Hga(0,"vector3",0),new Hga(12,"vector3",3),new Hga(24,"vector2",2),new Hga(32,"vector2",15)])}])}(),function(){function Ha(Ha,Hb){this._position=null,this._textureCoordinate0=null,this._position=Ha,this._textureCoordinate0=Hb}Hn(Ha,"laya.d3.graphics.VertexPositionTexture0");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"position",function(){return this._position}),Ho(0,Hb,"textureCoordinate0",function(){return this._textureCoordinate0}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(20,[new Hga(0,"vector3",0),new Hga(12,"vector2",2)])}]),Ha}()),HTa=(function(){function Ha(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hl,Hm,Hn){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=Ha,this._positionStartLifeTime=Hb,this._velocity=Hc,this._startColor=Hd,this._startSize=He,this._startRotation0=Hf,this._startRotation1=Hg,this._startRotation2=Hh,this._startLifeTime=Hi,this._time=Hj,this._startSpeed=Hk,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=Hn}Hn(Ha,"laya.d3.graphics.VertexShurikenParticleBillboard");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Ho(0,Hb,"random1",function(){return this._randoms1}),Ho(0,Hb,"startRotation2",function(){return this._startRotation2}),Ho(0,Hb,"positionStartLifeTime",function(){return this._positionStartLifeTime}),Ho(0,Hb,"velocity",function(){return this._velocity}),Ho(0,Hb,"random0",function(){return this._randoms0}),Ho(0,Hb,"startSize",function(){return this._startSize}),Ho(0,Hb,"startColor",function(){return this._startColor}),Ho(0,Hb,"startRotation0",function(){return this._startRotation0}),Ho(0,Hb,"startRotation1",function(){return this._startRotation1}),Ho(0,Hb,"startLifeTime",function(){return this._startLifeTime}),Ho(0,Hb,"time",function(){return this._time}),Ho(0,Hb,"startSpeed",function(){return this._startSpeed}),Ho(0,Hb,"simulationWorldPostion",function(){return this._simulationWorldPostion}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(152,[new Hga(0,"vector4",17),new Hga(16,"vector4",30),new Hga(32,"vector4",32),new Hga(48,"vector4",19),new Hga(64,"vector3",20),new Hga(76,"vector3",22),new Hga(88,"single",31),new Hga(92,"vector4",34),new Hga(108,"vector4",35),new Hga(124,"vector3",36),new Hga(136,"vector4",37)])}])}(),function(){function Ha(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hl,Hm,Hn){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=Ha,this._positionStartLifeTime=Hb,this._velocity=Hc,this._startColor=Hd,this._startSize=He,this._startRotation0=Hf,this._startRotation1=Hg,this._startRotation2=Hh,this._startLifeTime=Hi,this._time=Hj,this._startSpeed=Hk,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=Hn}Hn(Ha,"laya.d3.graphics.VertexShurikenParticleMesh");var Hb=Ha.prototype;Hv.imps(Hb,{"laya.d3.graphics.IVertex":!0}),Ho(0,Hb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Ho(0,Hb,"velocity",function(){return this._velocity}),Ho(0,Hb,"position",function(){return this._positionStartLifeTime}),Ho(0,Hb,"random0",function(){return this._randoms0}),Ho(0,Hb,"startSize",function(){return this._startSize}),Ho(0,Hb,"startColor",function(){return this._startColor}),Ho(0,Hb,"startRotation0",function(){return this._startRotation0}),Ho(0,Hb,"startRotation1",function(){return this._startRotation1}),Ho(0,Hb,"random1",function(){return this._randoms1}),Ho(0,Hb,"startRotation2",function(){return this._startRotation2}),Ho(0,Hb,"startLifeTime",function(){return this._startLifeTime}),Ho(0,Hb,"time",function(){return this._time}),Ho(0,Hb,"startSpeed",function(){return this._startSpeed}),Ho(0,Hb,"simulationWorldPostion",function(){return this._simulationWorldPostion}),Ho(0,Hb,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Ho(1,Ha,"vertexDeclaration",function(){return Ha._vertexDeclaration}),Hl(Ha,["_vertexDeclaration",function(){return this._vertexDeclaration=new Hfa(172,[new Hga(0,"vector3",0),new Hga(12,"vector4",1),new Hga(28,"vector2",2),new Hga(36,"vector4",30),new Hga(52,"vector4",32),new Hga(68,"vector4",19),new Hga(84,"vector3",20),new Hga(96,"vector3",22),new Hga(108,"single",31),new Hga(112,"vector4",34),new Hga(128,"vector4",35),new Hga(144,"vector3",36),new Hga(156,"vector4",37)])}])}(),function(){function Ht(Ha,Hb,Hc,Hd,He,Hf){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=Hc,this._materials=Hd,this._subMeshes=He,this._materialMap=Hf,this._version=Hb,this._onLoaded(Ha)}Hn(Ht,"laya.d3.loaders.LoadModelV01");var Ha=Ht.prototype;return Ha._onLoaded=function(Ha){this._readData=Ha,this.READ_BLOCK();for(var Hb=0;Hb<this._BLOCK.count;Hb++){var Hc=this._readData.getUint16(),Hd=this._strings[Hc],He=this["READ_"+Hd];if(null==He)throw new Error("model file err,no this function:"+Hc+" "+Hd);if(!He.call(this))break}return this._mesh},Ha.onError=function(){},Ha._readString=function(){return this._strings[this._readData.getUint16()]},Ha.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},Ha.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},Ha.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var Ha=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var Hb=0;Hb<this._STRINGS.size;Hb++)this._strings[Hb]=this._readData.readUTFString();return this._readData.pos=Ha,!0},Ha.READ_MATERIAL=function(){var Ha=this._readData.getUint16(),Hb=(this._readString(),this._readString());return this._materials[Ha]="null"!==Hb?Hr.getRes(this._materialMap[Hb]):new HCb,!0},Ha.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var Ha,Hb=this._readData.__getBuffer(),Hc=0,Hd=this._readData.getUint32(),He=this._readData.getUint32(),Hf=(new Float32Array(Hb.slice(Hd+this._DATA.offset,Hd+this._DATA.offset+He)),this._readData.getUint32()),Hg=this._readData.getUint32(),Hh=new Float32Array(Hb.slice(Hf+this._DATA.offset,Hf+this._DATA.offset+Hg));for(this.mesh._inverseBindPoses=[],Hc=0,Ha=Hh.length;Hc<Ha;Hc+=16){var Hi=new Hab(Hh[Hc+0],Hh[Hc+1],Hh[Hc+2],Hh[Hc+3],Hh[Hc+4],Hh[Hc+5],Hh[Hc+6],Hh[Hc+7],Hh[Hc+8],Hh[Hc+9],Hh[Hc+10],Hh[Hc+11],Hh[Hc+12],Hh[Hc+13],Hh[Hc+14],Hh[Hc+15]);this.mesh._inverseBindPoses.push(Hi)}break;default:throw new Error("LoadModel:unknown version.")}return!0},Ha.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var Ha=this._readString();this._shaderAttributes=Ha.match(Ht._attrReg);var Hb=this._readData.getUint32(),Hc=this._readData.getUint32(),Hd=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),He=this._readData.getUint32(),Hf=this._readData.getUint32(),Hg=this._readData.getUint32(),Hh=this._readData.__getBuffer(),Hi=new Hjb(this._mesh),Hj=this._getVertexDeclaration(),Hk=HMb.create(Hj,He/Hj.vertexStride,35044,!0),Hl=Hd+this._DATA.offset,Hm=Hh.slice(Hl,Hl+He);Hk.setData(new Float32Array(Hm));for(var Hn=(Hi._vertexBuffer=Hk).vertexDeclaration.getVertexElements(),Ho=0;Ho<Hn.length;Ho++)Hi._bufferUsage[Hn[Ho].elementUsage]=Hk;var Hp=HLb.create("ushort",Hc/2,35044,!0),Hq=Hb+this._DATA.offset,Hr=Hh.slice(Hq,Hq+Hc);Hp.setData(new Uint16Array(Hr)),Hi._indexBuffer=Hp;var Hs=Hh.slice(Hf+this._DATA.offset,Hf+this._DATA.offset+Hg);return Hi._boneIndicesList[0]=new Uint8Array(Hs),this._subMeshes.push(Hi),!0},Ha.READ_DATAAREA=function(){return!1},Ha._getVertexDeclaration=function(){for(var Ha,Hb=!1,Hc=!1,Hd=!1,He=!1,Hf=!1,Hg=!1,Hh=!1,Hi=!1,Hj=!1,Hk=0;Hk<this._shaderAttributes.length;Hk+=8)switch(this._shaderAttributes[Hk]){case"POSITION":Hb=!0;break;case"NORMAL":Hc=!0;break;case"COLOR":Hd=!0;break;case"UV":He=!0;break;case"UV1":Hf=!0;break;case"BLENDWEIGHT":Hh=!0;break;case"BLENDINDICES":Hi=!0;break;case"TANGENT":Hg=!0;break;case"BINORMAL":Hj=!0}return Hb&&Hc&&Hd&&He&&Hf&&Hh&&Hi&&Hg?Ha=Hta.vertexDeclaration:Hb&&Hc&&Hd&&He&&Hf&&Hh&&Hi?Ha=Hra.vertexDeclaration:Hb&&Hc&&He&&Hf&&Hh&&Hi&&Hg?Ha=HHa.vertexDeclaration:Hb&&Hc&&He&&Hf&&Hh&&Hi?Ha=HFa.vertexDeclaration:Hb&&Hc&&Hd&&He&&Hh&&Hi&&Hg?Ha=Hya.vertexDeclaration:Hb&&Hc&&Hd&&He&&Hh&&Hi?Ha=Hwa.vertexDeclaration:Hb&&Hc&&Hg&&Hj&&He&&Hh&&Hi?Ha=HRa.vertexDeclaration:Hb&&Hc&&He&&Hh&&Hi&&Hg?Ha=HMa.vertexDeclaration:Hb&&Hc&&He&&Hh&&Hi?Ha=HKa.vertexDeclaration:Hb&&Hc&&Hd&&Hh&&Hi&&Hg?Ha=Hma.vertexDeclaration:Hb&&Hc&&Hd&&Hh&&Hi?Ha=Hka.vertexDeclaration:Hb&&Hc&&Hd&&He&&Hf&&Hg?Ha=Hva.vertexDeclaration:Hb&&Hc&&Hd&&He&&Hf?Ha=Hqa.vertexDeclaration:Hb&&Hc&&He&&Hf&&Hg?Ha=HJa.vertexDeclaration:Hb&&Hc&&He&&Hf?Ha=HEa.vertexDeclaration:Hb&&Hc&&Hd&&He&&Hg?Ha=HAa.vertexDeclaration:Hb&&Hc&&He&&Hg&&Hj?Ha=HPa.vertexDeclaration:Hb&&Hc&&Hd&&He?Ha=Hpa.vertexDeclaration:Hb&&Hc&&He&&Hg?Ha=HOa.vertexDeclaration:Hb&&Hc&&He?Ha=HDa.vertexDeclaration:Hb&&Hc&&Hd&&Hg?Ha=Hoa.vertexDeclaration:Hb&&Hc&&Hd&&(Ha=Hja.vertexDeclaration),Ha},Ho(0,Ha,"mesh",function(){return this._mesh}),Ht._attrReg=new RegExp("(\\w+)|([:,;])","g"),Ht}()),HUa=function(){function Hx(){}return Hn(Hx,"laya.d3.loaders.LoadModelV02"),Hx.parse=function(Ha,Hb,Hc,Hd,He,Hf){Hx._mesh=Hc,Hx._materials=Hd,Hx._subMeshes=He,Hx._materialMap=Hf,Hx._version=Hb,Hx._readData=Ha,Hx.READ_DATA(),Hx.READ_BLOCK(),Hx.READ_STRINGS();for(var Hg=0,Hh=Hx._BLOCK.count;Hg<Hh;Hg++){Hx._readData.pos=Hx._BLOCK.blockStarts[Hg];var Hi=Hx._readData.getUint16(),Hj=Hx._strings[Hi],Hk=Hx["READ_"+Hj];if(null==Hk)throw new Error("model file err,no this function:"+Hi+" "+Hj);Hk.call()}Hx._strings.length=0,Hx._readData=null,Hx._version=null,Hx._mesh=null,Hx._materials=null,Hx._subMeshes=null,Hx._materialMap=null},Hx._readString=function(){return Hx._strings[Hx._readData.getUint16()]},Hx.READ_DATA=function(){Hx._DATA.offset=Hx._readData.getUint32(),Hx._DATA.size=Hx._readData.getUint32()},Hx.READ_BLOCK=function(){for(var Ha=Hx._BLOCK.count=Hx._readData.getUint16(),Hb=Hx._BLOCK.blockStarts=[],Hc=Hx._BLOCK.blockLengths=[],Hd=0;Hd<Ha;Hd++)Hb.push(Hx._readData.getUint32()),Hc.push(Hx._readData.getUint32())},Hx.READ_STRINGS=function(){var Ha=Hx._readData.getUint32(),Hb=Hx._readData.getUint16(),Hc=Hx._readData.pos;Hx._readData.pos=Ha+Hx._DATA.offset;for(var Hd=0;Hd<Hb;Hd++)Hx._strings[Hd]=Hx._readData.readUTFString();Hx._readData.pos=Hc},Hx.READ_MATERIAL=function(){Hx._readString(),Hx._readString();var Ha=Hx._readString();return""!==Ha&&Hx._materials.push(Hr.getRes(Hx._materialMap[Ha])),!0},Hx.READ_MESH=function(){Hx._readString();var Ha,Hb=Hx._readData.__getBuffer(),Hc=0,Hd=Hx._readData.getInt16(),He=Hx._DATA.offset;for(Hc=0;Hc<Hd;Hc++){var Hf=He+Hx._readData.getUint32(),Hg=Hx._readData.getUint32(),Hh=new Float32Array(Hb.slice(Hf,Hf+Hg)),Hi=Hx._readString().match(Hx._attrReg),Hj=Hx._getVertexDeclaration(Hi),Hk=HMb.create(Hj,4*Hh.length/Hj.vertexStride,35044,!0);Hk.setData(Hh),Hx._mesh._vertexBuffers.push(Hk)}var Hl=He+Hx._readData.getUint32(),Hm=Hx._readData.getUint32(),Hn=new Uint16Array(Hb.slice(Hl,Hl+Hm)),Ho=HLb.create("ushort",Hm/2,35044,!0);Ho.setData(Hn),Hx._mesh._indexBuffer=Ho;var Hp=Hx._mesh._boneNames=[],Hq=Hx._readData.getUint16();for(Hp.length=Hq,Hc=0;Hc<Hq;Hc++)Hp[Hc]=Hx._strings[Hx._readData.getUint16()];var Hr=Hx._readData.getUint32(),Hs=Hx._readData.getUint32(),Ht=(new Float32Array(Hb.slice(He+Hr,He+Hr+Hs)),Hx._readData.getUint32()),Hu=Hx._readData.getUint32(),Hv=new Float32Array(Hb.slice(He+Ht,He+Ht+Hu));for(Hx._mesh._inverseBindPoses=[],Hc=0,Ha=Hv.length;Hc<Ha;Hc+=16){var Hw=new Hab(Hv[Hc+0],Hv[Hc+1],Hv[Hc+2],Hv[Hc+3],Hv[Hc+4],Hv[Hc+5],Hv[Hc+6],Hv[Hc+7],Hv[Hc+8],Hv[Hc+9],Hv[Hc+10],Hv[Hc+11],Hv[Hc+12],Hv[Hc+13],Hv[Hc+14],Hv[Hc+15]);Hx._mesh._inverseBindPoses.push(Hw)}return Hx._mesh._skinnedDatas=new Float32Array(16*Hv.length),!0},Hx.READ_SUBMESH=function(){var Ha=Hx._readData.__getBuffer(),Hb=new Hjb(Hx._mesh),Hc=Hx._readData.getInt16(),Hd=Hx._readData.getUint32(),He=Hx._readData.getUint32();Hb._vertexBuffer=Hx._mesh._vertexBuffers[Hc],Hb._vertexStart=Hd,Hb._vertexCount=He;var Hf=Hx._readData.getUint32(),Hg=Hx._readData.getUint32(),Hh=Hx._mesh._indexBuffer;Hb._indexBuffer=Hh,Hb._indexStart=Hf,Hb._indexCount=Hg,Hb._indices=new Uint16Array(Hh.getData().buffer,2*Hf,Hg);var Hi=Hx._DATA.offset,Hj=Hb._subIndexBufferStart,Hk=Hb._subIndexBufferCount,Hl=Hb._boneIndicesList,Hm=Hx._readData.getUint16();Hj.length=Hm,Hk.length=Hm,Hl.length=Hm;for(var Hn=0;Hn<Hm;Hn++){Hj[Hn]=Hx._readData.getUint32(),Hk[Hn]=Hx._readData.getUint32();var Ho=Hx._readData.getUint32(),Hp=Hx._readData.getUint32();Hb._boneIndicesList[Hn]=new Uint8Array(Ha.slice(Hi+Ho,Hi+Ho+Hp))}return Hx._subMeshes.push(Hb),!0},Hx._getVertexDeclaration=function(Ha){for(var Hb,Hc=!1,Hd=!1,He=!1,Hf=!1,Hg=!1,Hh=!1,Hi=!1,Hj=!1,Hk=!1,Hl=0;Hl<Ha.length;Hl++)switch(Ha[Hl]){case"POSITION":Hc=!0;break;case"NORMAL":Hd=!0;break;case"COLOR":He=!0;break;case"UV":Hf=!0;break;case"UV1":Hg=!0;break;case"BLENDWEIGHT":Hi=!0;break;case"BLENDINDICES":Hj=!0;break;case"TANGENT":Hh=!0;break;case"BINORMAL":Hk=!0}return Hc&&Hd&&He&&Hf&&Hg&&Hi&&Hj&&Hh?Hb=Hta.vertexDeclaration:Hc&&Hd&&He&&Hf&&Hg&&Hi&&Hj?Hb=Hra.vertexDeclaration:Hc&&Hd&&Hf&&Hg&&Hi&&Hj&&Hh?Hb=HHa.vertexDeclaration:Hc&&Hd&&Hf&&Hg&&Hi&&Hj?Hb=HFa.vertexDeclaration:Hc&&Hd&&He&&Hf&&Hi&&Hj&&Hh?Hb=Hya.vertexDeclaration:Hc&&Hd&&He&&Hf&&Hi&&Hj?Hb=Hwa.vertexDeclaration:Hc&&Hd&&Hf&&Hi&&Hj&&Hh?Hb=HMa.vertexDeclaration:Hc&&Hd&&Hf&&Hi&&Hj?Hb=HKa.vertexDeclaration:Hc&&Hd&&He&&Hi&&Hj&&Hh?Hb=Hma.vertexDeclaration:Hc&&Hd&&He&&Hi&&Hj?Hb=Hka.vertexDeclaration:Hc&&Hd&&He&&Hf&&Hg&&Hh?Hb=Hva.vertexDeclaration:Hc&&Hd&&He&&Hf&&Hg?Hb=Hqa.vertexDeclaration:Hc&&Hd&&Hf&&Hg&&Hh?Hb=HJa.vertexDeclaration:Hc&&Hd&&Hf&&Hg?Hb=HEa.vertexDeclaration:Hc&&Hd&&He&&Hf&&Hh?Hb=HAa.vertexDeclaration:Hc&&Hd&&Hf&&Hh&&Hk?Hb=HPa.vertexDeclaration:Hc&&Hd&&He&&Hf?Hb=Hpa.vertexDeclaration:Hc&&Hd&&Hf&&Hh?Hb=HOa.vertexDeclaration:Hc&&Hd&&Hf?Hb=HDa.vertexDeclaration:Hc&&Hd&&He&&Hh?Hb=Hoa.vertexDeclaration:Hc&&Hd&&He&&(Hb=Hja.vertexDeclaration),Hb},Hx._attrReg=new RegExp("(\\w+)|([:,;])","g"),Hx._strings=[],Hx._readData=null,Hx._version=null,Hx._mesh=null,Hx._materials=null,Hx._subMeshes=null,Hx._materialMap=null,Hl(Hx,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Hx}(),HVa=function(){function Hw(){}return Hn(Hw,"laya.d3.loaders.LoadModelV03"),Hw.parse=function(Ha,Hb,Hc,Hd,He){Hw._mesh=Hc,Hw._subMeshes=Hd,Hw._materialMap=He,Hw._version=Hb,Hw._readData=Ha,Hw.READ_DATA(),Hw.READ_BLOCK(),Hw.READ_STRINGS();for(var Hf=0,Hg=Hw._BLOCK.count;Hf<Hg;Hf++){Hw._readData.pos=Hw._BLOCK.blockStarts[Hf];var Hh=Hw._readData.getUint16(),Hi=Hw._strings[Hh],Hj=Hw["READ_"+Hi];if(null==Hj)throw new Error("model file err,no this function:"+Hh+" "+Hi);Hj.call()}Hw._strings.length=0,Hw._readData=null,Hw._version=null,Hw._mesh=null,Hw._subMeshes=null,Hw._materialMap=null},Hw._readString=function(){return Hw._strings[Hw._readData.getUint16()]},Hw.READ_DATA=function(){Hw._DATA.offset=Hw._readData.getUint32(),Hw._DATA.size=Hw._readData.getUint32()},Hw.READ_BLOCK=function(){for(var Ha=Hw._BLOCK.count=Hw._readData.getUint16(),Hb=Hw._BLOCK.blockStarts=[],Hc=Hw._BLOCK.blockLengths=[],Hd=0;Hd<Ha;Hd++)Hb.push(Hw._readData.getUint32()),Hc.push(Hw._readData.getUint32())},Hw.READ_STRINGS=function(){var Ha=Hw._readData.getUint32(),Hb=Hw._readData.getUint16(),Hc=Hw._readData.pos;Hw._readData.pos=Ha+Hw._DATA.offset;for(var Hd=0;Hd<Hb;Hd++)Hw._strings[Hd]=Hw._readData.readUTFString();Hw._readData.pos=Hc},Hw.READ_MESH=function(){var Ha,Hb=Hw._readString(),Hc=Hw._readData.__getBuffer(),Hd=0,He=Hw._readData.getInt16(),Hf=Hw._DATA.offset;for(Hd=0;Hd<He;Hd++){var Hg,Hh=Hf+Hw._readData.getUint32(),Hi=Hw._readData.getUint32(),Hj=new Float32Array(Hc.slice(Hh,Hh+Hi)),Hk=Hw._readString();switch(Hw._version){case"LAYAMODEL:03":Hg=Hw._vertexDeclarationMap_Discard[Hk];break;case"LAYAMODEL:0301":Hg=Hw._vertexDeclarationMap[Hk];break;default:throw new Error("LoadModelV03: unknown version.")}if(!Hg)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+Hw._version+"  bufferAttribute="+Hk+"  name="+Hb+"  url="+(Hw._mesh?Hw._mesh.url:"null"));var Hl=HMb.create(Hg,4*Hj.length/Hg.vertexStride,35044,!0,Hw._mesh._url+"_"+Hd);Hl.setData(Hj),Hw._mesh._vertexBuffers.push(Hl)}var Hm=Hf+Hw._readData.getUint32(),Hn=Hw._readData.getUint32(),Ho=new Uint16Array(Hc.slice(Hm,Hm+Hn)),Hp=HLb.create("ushort",Hn/2,35044,!0,Hw._mesh._url);Hp.setData(Ho),Hw._mesh._indexBuffer=Hp;var Hq=Hw._mesh._boneNames=[],Hr=Hw._readData.getUint16();for(Hq.length=Hr,Hd=0;Hd<Hr;Hd++)Hq[Hd]=Hw._strings[Hw._readData.getUint16()];Hw._readData.pos+=8;var Hs=Hw._readData.getUint32(),Ht=Hw._readData.getUint32(),Hu=new Float32Array(Hc.slice(Hf+Hs,Hf+Hs+Ht));for(Hw._mesh._inverseBindPoses=[],Hd=0,Ha=Hu.length;Hd<Ha;Hd+=16){var Hv=new Hab(Hu[Hd+0],Hu[Hd+1],Hu[Hd+2],Hu[Hd+3],Hu[Hd+4],Hu[Hd+5],Hu[Hd+6],Hu[Hd+7],Hu[Hd+8],Hu[Hd+9],Hu[Hd+10],Hu[Hd+11],Hu[Hd+12],Hu[Hd+13],Hu[Hd+14],Hu[Hd+15]);Hw._mesh._inverseBindPoses.push(Hv)}return Hw._mesh._skinnedDatas=new Float32Array(16*Hu.length),!0},Hw.READ_SUBMESH=function(){var Ha=Hw._readData.__getBuffer(),Hb=new Hjb(Hw._mesh),Hc=Hw._readData.getInt16(),Hd=Hw._readData.getUint32(),He=Hw._readData.getUint32();Hb._vertexBuffer=Hw._mesh._vertexBuffers[Hc],Hb._vertexStart=Hd,Hb._vertexCount=He;var Hf=Hw._readData.getUint32(),Hg=Hw._readData.getUint32(),Hh=Hw._mesh._indexBuffer;Hb._indexBuffer=Hh,Hb._indexStart=Hf,Hb._indexCount=Hg,Hb._indices=new Uint16Array(Hh.getData().buffer,2*Hf,Hg);var Hi=Hw._DATA.offset,Hj=Hb._subIndexBufferStart,Hk=Hb._subIndexBufferCount,Hl=Hb._boneIndicesList,Hm=Hw._readData.getUint16();Hj.length=Hm,Hk.length=Hm,Hl.length=Hm;for(var Hn=0;Hn<Hm;Hn++){Hj[Hn]=Hw._readData.getUint32(),Hk[Hn]=Hw._readData.getUint32();var Ho=Hw._readData.getUint32(),Hp=Hw._readData.getUint32();Hl[Hn]=new Uint8Array(Ha.slice(Hi+Ho,Hi+Ho+Hp))}return Hw._subMeshes.push(Hb),!0},Hw._strings=[],Hw._readData=null,Hw._version=null,Hw._mesh=null,Hw._subMeshes=null,Hw._materialMap=null,Hl(Hw,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":Hta.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":Hra.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":HQa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":HHa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":HFa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":Hya.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":Hwa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":HMa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":HKa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Hma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":Hka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":Hva.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Hqa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":HJa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":HEa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":HAa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":HPa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Hpa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":HOa.vertexDeclaration,"POSITION,NORMAL,UV":HDa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Hoa.vertexDeclaration,"POSITION,NORMAL,COLOR":Hja.vertexDeclaration,"POSITION,NORMAL,TANGENT":HCa.vertexDeclaration,"POSITION,NORMAL":Hia.vertexDeclaration,"POSITION,UV":HSa.vertexDeclaration,POSITION:Hha.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":Hsa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":Hra.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":HQa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":HGa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":HFa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":Hxa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":Hwa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":HLa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":HKa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Hla.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":Hka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":Hua.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Hqa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":HIa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":HEa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":Hza.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":HPa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Hpa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":HNa.vertexDeclaration,"POSITION,NORMAL,UV":HDa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Hna.vertexDeclaration,"POSITION,NORMAL,COLOR":Hja.vertexDeclaration,"POSITION,NORMAL,TANGENT":HBa.vertexDeclaration,"POSITION,NORMAL":Hia.vertexDeclaration,"POSITION,UV":HSa.vertexDeclaration,POSITION:Hha.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Hw}(),HWa=function(){function Hh(){}return Hn(Hh,"laya.d3.loaders.MeshReader"),Hh.read=function(Ha,Hb,Hc,Hd,He){var Hf=new Hw(Ha);Hf.pos=0;var Hg=Hf.readUTFString();switch(Hg){case"LAYAMODEL:01":case"LAYASKINANI:01":Hh._readVersion01(Hf,Hg,Hb,Hc,Hd,He);break;case"LAYAMODEL:02":HUa.parse(Hf,Hg,Hb,Hc,Hd,He);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":HVa.parse(Hf,Hg,Hb,Hd,He);break;default:throw new Error("MeshReader: unknown mesh version.")}Hb._setSubMeshes(Hd)},Hh._readVersion01=function(Ha,Hb,Hc,Hd,He,Hf){new HTa(Ha,Hb,Hc,Hd,He,Hf)},Hh}(),HXa=function(){function Ha(Ha,Hb){this.min=null,this.max=null,this.min=Ha,this.max=Hb}Hn(Ha,"laya.d3.math.BoundBox");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb.getCorners=function(Ha){Ha.length=8;var Hb=this.min.elements,Hc=this.max.elements,Hd=Hb[0],He=Hb[1],Hf=Hb[2],Hg=Hc[0],Hh=Hc[1],Hi=Hc[2];Ha[0]=new Hgb(Hd,Hh,Hi),Ha[1]=new Hgb(Hg,Hh,Hi),Ha[2]=new Hgb(Hg,He,Hi),Ha[3]=new Hgb(Hd,He,Hi),Ha[4]=new Hgb(Hd,Hh,Hf),Ha[5]=new Hgb(Hg,Hh,Hf),Ha[6]=new Hgb(Hg,He,Hf),Ha[7]=new Hgb(Hd,He,Hf)},Hb.toDefault=function(){this.min.toDefault(),this.max.toDefault()},Hb.cloneTo=function(Ha){var Hb=Ha;this.min.cloneTo(Hb.min),this.max.cloneTo(Hb.max)},Hb.clone=function(){var Ha=new this.constructor(new Hgb,new Hgb);return this.cloneTo(Ha),Ha},Ha.createfromPoints=function(Ha,Hb){if(null==Ha)throw new Error("points");var Hc=Hb.min,Hd=Hb.max,He=Hc.elements;He[0]=Number.MAX_VALUE,He[1]=Number.MAX_VALUE,He[2]=Number.MAX_VALUE;var Hf=Hd.elements;Hf[0]=-Number.MAX_VALUE,Hf[1]=-Number.MAX_VALUE,Hf[2]=-Number.MAX_VALUE;for(var Hg=0,Hh=Ha.length;Hg<Hh;++Hg)Hgb.min(Hc,Ha[Hg],Hc),Hgb.max(Hd,Ha[Hg],Hd)},Ha.merge=function(Ha,Hb,Hc){Hgb.min(Ha.min,Hb.min,Hc.min),Hgb.max(Ha.max,Hb.max,Hc.max)},Ha}(),HYa=function(){function Hj(Ha){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=Ha,this._near=new Hbb(new Hgb),this._far=new Hbb(new Hgb),this._left=new Hbb(new Hgb),this._right=new Hbb(new Hgb),this._top=new Hbb(new Hgb),this._bottom=new Hbb(new Hgb),Hj._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}Hn(Hj,"laya.d3.math.BoundFrustum");var Ha=Hj.prototype;return Ha.equalsBoundFrustum=function(Ha){return this._matrix.equalsOtherMatrix(Ha.matrix)},Ha.equalsObj=function(Ha){if(Ha instanceof laya.d3.math.BoundFrustum){var Hb=Ha;return this.equalsBoundFrustum(Hb)}return!1},Ha.getPlane=function(Ha){switch(Ha){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},Ha.getCorners=function(Ha){Hj._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(Ha[0]),Hj._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(Ha[1]),Hj._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(Ha[2]),Hj._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(Ha[3]),Hj._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(Ha[4]),Hj._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(Ha[5]),Hj._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(Ha[6]),Hj._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(Ha[7])},Ha.containsPoint=function(Ha){for(var Hb=Hbb.PlaneIntersectionType_Front,Hc=Hbb.PlaneIntersectionType_Front,Hd=0;Hd<6;Hd++){switch(Hd){case 0:Hc=Collision.intersectsPlaneAndPoint(this._near,Ha);break;case 1:Hc=Collision.intersectsPlaneAndPoint(this._far,Ha);break;case 2:Hc=Collision.intersectsPlaneAndPoint(this._left,Ha);break;case 3:Hc=Collision.intersectsPlaneAndPoint(this._right,Ha);break;case 4:Hc=Collision.intersectsPlaneAndPoint(this._top,Ha);break;case 5:Hc=Collision.intersectsPlaneAndPoint(this._bottom,Ha)}switch(Hc){case Hbb.PlaneIntersectionType_Back:return 0;case Hbb.PlaneIntersectionType_Intersecting:Hb=Hbb.PlaneIntersectionType_Intersecting}}switch(Hb){case Hbb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},Ha.containsBoundBox=function(Ha){for(var Hb,Hc=Hj._tempV30,Hd=Hj._tempV31,He=1,Hf=0;Hf<6;Hf++){if(Hb=this.getPlane(Hf),this._getBoxToPlanePVertexNVertex(Ha,Hb.normal,Hc,Hd),Collision.intersectsPlaneAndPoint(Hb,Hc)===Hbb.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(Hb,Hd)===Hbb.PlaneIntersectionType_Back&&(He=2)}return He},Ha.containsBoundSphere=function(Ha){for(var Hb=Hbb.PlaneIntersectionType_Front,Hc=Hbb.PlaneIntersectionType_Front,Hd=0;Hd<6;Hd++){switch(Hd){case 0:Hc=Collision.intersectsPlaneAndSphere(this._near,Ha);break;case 1:Hc=Collision.intersectsPlaneAndSphere(this._far,Ha);break;case 2:Hc=Collision.intersectsPlaneAndSphere(this._left,Ha);break;case 3:Hc=Collision.intersectsPlaneAndSphere(this._right,Ha);break;case 4:Hc=Collision.intersectsPlaneAndSphere(this._top,Ha);break;case 5:Hc=Collision.intersectsPlaneAndSphere(this._bottom,Ha)}switch(Hc){case Hbb.PlaneIntersectionType_Back:return 0;case Hbb.PlaneIntersectionType_Intersecting:Hb=Hbb.PlaneIntersectionType_Intersecting}}switch(Hb){case Hbb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},Ha._getBoxToPlanePVertexNVertex=function(Ha,Hb,Hc,Hd){var He=Ha.min,Hf=He.elements,Hg=Ha.max,Hh=Hg.elements,Hi=Hb.elements,Hj=Hi[0],Hk=Hi[1],Hl=Hi[2];He.cloneTo(Hc);var Hm=Hc.elements;0<=Hj&&(Hm[0]=Hh[0]),0<=Hk&&(Hm[1]=Hh[1]),0<=Hl&&(Hm[2]=Hh[2]),Hg.cloneTo(Hd);var Hn=Hd.elements;0<=Hj&&(Hn[0]=Hf[0]),0<=Hk&&(Hn[1]=Hf[1]),0<=Hl&&(Hn[2]=Hf[2])},Ho(0,Ha,"top",function(){return this._top}),Ho(0,Ha,"matrix",function(){return this._matrix},function(Ha){this._matrix=Ha,Hj._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),Ho(0,Ha,"near",function(){return this._near}),Ho(0,Ha,"far",function(){return this._far}),Ho(0,Ha,"left",function(){return this._left}),Ho(0,Ha,"right",function(){return this._right}),Ho(0,Ha,"bottom",function(){return this._bottom}),Hj._getPlanesFromMatrix=function(Ha,Hb,Hc,Hd,He,Hf,Hg){var Hh=Ha.elements,Hi=Hh[0],Hj=Hh[1],Hk=Hh[2],Hl=Hh[3],Hm=Hh[4],Hn=Hh[5],Ho=Hh[6],Hp=Hh[7],Hq=Hh[8],Hr=Hh[9],Hs=Hh[10],Ht=Hh[11],Hu=Hh[12],Hv=Hh[13],Hw=Hh[14],Hx=Hh[15],Hy=Hb.normal.elements;Hy[0]=Hl+Hk,Hy[1]=Hp+Ho,Hy[2]=Ht+Hs,Hb.distance=Hx+Hw,Hb.normalize();var Hz=Hc.normal.elements;Hz[0]=Hl-Hk,Hz[1]=Hp-Ho,Hz[2]=Ht-Hs,Hc.distance=Hx-Hw,Hc.normalize();var HA=Hd.normal.elements;HA[0]=Hl+Hi,HA[1]=Hp+Hm,HA[2]=Ht+Hq,Hd.distance=Hx+Hu,Hd.normalize();var HB=He.normal.elements;HB[0]=Hl-Hi,HB[1]=Hp-Hm,HB[2]=Ht-Hq,He.distance=Hx-Hu,He.normalize();var HC=Hf.normal.elements;HC[0]=Hl-Hj,HC[1]=Hp-Hn,HC[2]=Ht-Hr,Hf.distance=Hx-Hv,Hf.normalize();var HD=Hg.normal.elements;HD[0]=Hl+Hj,HD[1]=Hp+Hn,HD[2]=Ht+Hr,Hg.distance=Hx+Hv,Hg.normalize()},Hj._get3PlaneInterPoint=function(Ha,Hb,Hc){var Hd=Ha.normal,He=Hb.normal,Hf=Hc.normal;Hgb.cross(He,Hf,Hj._tempV30),Hgb.cross(Hf,Hd,Hj._tempV31),Hgb.cross(Hd,He,Hj._tempV32);var Hg=Hgb.dot(Hd,Hj._tempV30),Hh=Hgb.dot(He,Hj._tempV31),Hi=Hgb.dot(Hf,Hj._tempV32);return Hgb.scale(Hj._tempV30,-Ha.distance/Hg,Hj._tempV33),Hgb.scale(Hj._tempV31,-Hb.distance/Hh,Hj._tempV34),Hgb.scale(Hj._tempV32,-Hc.distance/Hi,Hj._tempV35),Hgb.add(Hj._tempV33,Hj._tempV34,Hj._tempV36),Hgb.add(Hj._tempV35,Hj._tempV36,Hj._tempV37),Hj._tempV37},Hl(Hj,["_tempV30",function(){return this._tempV30=new Hgb},"_tempV31",function(){return this._tempV31=new Hgb},"_tempV32",function(){return this._tempV32=new Hgb},"_tempV33",function(){return this._tempV33=new Hgb},"_tempV34",function(){return this._tempV34=new Hgb},"_tempV35",function(){return this._tempV35=new Hgb},"_tempV36",function(){return this._tempV36=new Hgb},"_tempV37",function(){return this._tempV37=new Hgb}]),Hj}(),HZa=function(){function Hk(Ha,Hb){this.center=null,this.radius=NaN,this.center=Ha,this.radius=Hb}Hn(Hk,"laya.d3.math.BoundSphere");var Ha=Hk.prototype;return Hv.imps(Ha,{"laya.d3.core.IClone":!0}),Ha.toDefault=function(){this.center.toDefault(),this.radius=0},Ha.intersectsRayDistance=function(Ha){return Collision.intersectsRayAndSphereRD(Ha,this)},Ha.intersectsRayPoint=function(Ha,Hb){return Collision.intersectsRayAndSphereRP(Ha,this,Hb)},Ha.cloneTo=function(Ha){var Hb=Ha;this.center.cloneTo(Hb.center),Hb.radius=this.radius},Ha.clone=function(){var Ha=new this.constructor(new Hgb,new Hgb);return this.cloneTo(Ha),Ha},Hk.createFromSubPoints=function(Ha,Hb,Hc,Hd){if(null==Ha)throw new Error("points");if(Hb<0||Hb>=Ha.length)throw new Error("start"+Hb+"Must be in the range [0, "+(Ha.length-1)+"]");if(Hc<0||Hb+Hc>Ha.length)throw new Error("count"+Hc+"Must be in the range <= "+Ha.length+"}");var He=Hb+Hc,Hf=Hk._tempVector3;Hf.elements[0]=0,Hf.elements[1]=0,Hf.elements[2]=0;for(var Hg=Hb;Hg<He;++Hg)Hgb.add(Ha[Hg],Hf,Hf);var Hh=Hd.center;Hgb.scale(Hf,1/Hc,Hh);var Hi=0;for(Hg=Hb;Hg<He;++Hg){var Hj=Hgb.distanceSquared(Hh,Ha[Hg]);Hi<Hj&&(Hi=Hj)}Hd.radius=Math.sqrt(Hi)},Hk.createfromPoints=function(Ha,Hb){if(null==Ha)throw new Error("points");Hk.createFromSubPoints(Ha,0,Ha.length,Hb)},Hl(Hk,["_tempVector3",function(){return this._tempVector3=new Hgb}]),Hk}(),H$a=(function(){function Ha(){}Hn(Ha,"laya.d3.math.ContainmentType"),Ha.Disjoint=0,Ha.Contains=1,Ha.Intersects=2}(),function(){function Hc(){}return Hn(Hc,"laya.d3.math.MathUtils3D"),Hc.isZero=function(Ha){return Math.abs(Ha)<Hc.zeroTolerance},Hc.nearEqual=function(Ha,Hb){return!!Hc.isZero(Ha-Hb)},Hc.fastInvSqrt=function(Ha){return Hc.isZero(Ha)?Ha:1/Math.sqrt(Ha)},Hl(Hc,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),Hc}()),H_a=function(){function Hi(){var Ha=this.elements=new Float32Array(9);Ha[0]=1,Ha[1]=0,Ha[2]=0,Ha[3]=0,Ha[4]=1,Ha[5]=0,Ha[6]=0,Ha[7]=0,Ha[8]=1}Hn(Hi,"laya.d3.math.Matrix3x3");var Ha=Hi.prototype;return Hv.imps(Ha,{"laya.d3.core.IClone":!0}),Ha.determinant=function(){var Ha=this.elements,Hb=Ha[0],Hc=Ha[1],Hd=Ha[2],He=Ha[3],Hf=Ha[4],Hg=Ha[5],Hh=Ha[6],Hi=Ha[7],Hj=Ha[8];return Hb*(Hj*Hf-Hg*Hi)+Hc*(-Hj*He+Hg*Hh)+Hd*(Hi*He-Hf*Hh)},Ha.translate=function(Ha,Hb){var Hc=Hb.elements,Hd=this.elements,He=Ha.elements,Hf=Hd[0],Hg=Hd[1],Hh=Hd[2],Hi=Hd[3],Hj=Hd[4],Hk=Hd[5],Hl=Hd[6],Hm=Hd[7],Hn=Hd[8],Ho=He[0],Hp=He[1];Hc[0]=Hf,Hc[1]=Hg,Hc[2]=Hh,Hc[3]=Hi,Hc[4]=Hj,Hc[5]=Hk,Hc[6]=Ho*Hf+Hp*Hi+Hl,Hc[7]=Ho*Hg+Hp*Hj+Hm,Hc[8]=Ho*Hh+Hp*Hk+Hn},Ha.rotate=function(Ha,Hb){var Hc=Hb.elements,Hd=this.elements,He=Hd[0],Hf=Hd[1],Hg=Hd[2],Hh=Hd[3],Hi=Hd[4],Hj=Hd[5],Hk=Hd[6],Hl=Hd[7],Hm=Hd[8],Hn=Math.sin(Ha),Ho=Math.cos(Ha);Hc[0]=Ho*He+Hn*Hh,Hc[1]=Ho*Hf+Hn*Hi,Hc[2]=Ho*Hg+Hn*Hj,Hc[3]=Ho*Hh-Hn*He,Hc[4]=Ho*Hi-Hn*Hf,Hc[5]=Ho*Hj-Hn*Hg,Hc[6]=Hk,Hc[7]=Hl,Hc[8]=Hm},Ha.scale=function(Ha,Hb){var Hc=Hb.elements,Hd=this.elements,He=Ha.elements,Hf=He[0],Hg=He[1];Hc[0]=Hf*Hd[0],Hc[1]=Hf*Hd[1],Hc[2]=Hf*Hd[2],Hc[3]=Hg*Hd[3],Hc[4]=Hg*Hd[4],Hc[5]=Hg*Hd[5],Hc[6]=Hd[6],Hc[7]=Hd[7],Hc[8]=Hd[8]},Ha.invert=function(Ha){var Hb=Ha.elements,Hc=this.elements,Hd=Hc[0],He=Hc[1],Hf=Hc[2],Hg=Hc[3],Hh=Hc[4],Hi=Hc[5],Hj=Hc[6],Hk=Hc[7],Hl=Hc[8],Hm=Hl*Hh-Hi*Hk,Hn=-Hl*Hg+Hi*Hj,Ho=Hk*Hg-Hh*Hj,Hp=Hd*Hm+He*Hn+Hf*Ho;Hp||(Ha=null),Hp=1/Hp,Hb[0]=Hm*Hp,Hb[1]=(-Hl*He+Hf*Hk)*Hp,Hb[2]=(Hi*He-Hf*Hh)*Hp,Hb[3]=Hn*Hp,Hb[4]=(Hl*Hd-Hf*Hj)*Hp,Hb[5]=(-Hi*Hd+Hf*Hg)*Hp,Hb[6]=Ho*Hp,Hb[7]=(-Hk*Hd+He*Hj)*Hp,Hb[8]=(Hh*Hd-He*Hg)*Hp},Ha.transpose=function(Ha){var Hb=Ha.elements,Hc=this.elements;if(Ha===this){var Hd=Hc[1],He=Hc[2],Hf=Hc[5];Hb[1]=Hc[3],Hb[2]=Hc[6],Hb[3]=Hd,Hb[5]=Hc[7],Hb[6]=He,Hb[7]=Hf}else Hb[0]=Hc[0],Hb[1]=Hc[3],Hb[2]=Hc[6],Hb[3]=Hc[1],Hb[4]=Hc[4],Hb[5]=Hc[7],Hb[6]=Hc[2],Hb[7]=Hc[5],Hb[8]=Hc[8]},Ha.identity=function(){var Ha=this.elements;Ha[0]=1,Ha[1]=0,Ha[2]=0,Ha[3]=0,Ha[4]=1,Ha[5]=0,Ha[6]=0,Ha[7]=0,Ha[8]=1},Ha.cloneTo=function(Ha){var Hb,Hc,Hd;if((Hc=this.elements)!==(Hd=Ha.elements))for(Hb=0;Hb<9;++Hb)Hd[Hb]=Hc[Hb]},Ha.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Hi.createFromTranslation=function(Ha,Hb){Hb.elements;var Hc=Ha.elements;Hb[0]=1,Hb[1]=0,Hb[2]=0,Hb[3]=0,Hb[4]=1,Hb[5]=0,Hb[6]=Hc[0],Hb[7]=Hc[1],Hb[8]=1},Hi.createFromRotation=function(Ha,Hb){var Hc=Hb.elements,Hd=Math.sin(Ha),He=Math.cos(Ha);Hc[0]=He,Hc[1]=Hd,Hc[2]=0,Hc[3]=-Hd,Hc[4]=He,Hc[5]=0,Hc[6]=0,Hc[7]=0,Hc[8]=1},Hi.createFromScaling=function(Ha,Hb){var Hc=Hb.elements,Hd=Ha.elements;Hc[0]=Hd[0],Hc[1]=0,Hc[2]=0,Hc[3]=0,Hc[4]=Hd[1],Hc[5]=0,Hc[6]=0,Hc[7]=0,Hc[8]=1},Hi.createFromMatrix4x4=function(Ha,Hb){Hb[0]=Ha[0],Hb[1]=Ha[1],Hb[2]=Ha[2],Hb[3]=Ha[4],Hb[4]=Ha[5],Hb[5]=Ha[6],Hb[6]=Ha[8],Hb[7]=Ha[9],Hb[8]=Ha[10]},Hi.multiply=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements,Hg=He[0],Hh=He[1],Hi=He[2],Hj=He[3],Hk=He[4],Hl=He[5],Hm=He[6],Hn=He[7],Ho=He[8],Hp=Hf[0],Hq=Hf[1],Hr=Hf[2],Hs=Hf[3],Ht=Hf[4],Hu=Hf[5],Hv=Hf[6],Hw=Hf[7],Hx=Hf[8];Hd[0]=Hp*Hg+Hq*Hj+Hr*Hm,Hd[1]=Hp*Hh+Hq*Hk+Hr*Hn,Hd[2]=Hp*Hi+Hq*Hl+Hr*Ho,Hd[3]=Hs*Hg+Ht*Hj+Hu*Hm,Hd[4]=Hs*Hh+Ht*Hk+Hu*Hn,Hd[5]=Hs*Hi+Ht*Hl+Hu*Ho,Hd[6]=Hv*Hg+Hw*Hj+Hx*Hm,Hd[7]=Hv*Hh+Hw*Hk+Hx*Hn,Hd[8]=Hv*Hi+Hw*Hl+Hx*Ho},Hi.lookAt=function(Ha,Hb,Hc,Hd){Hgb.subtract(Ha,Hb,Hi._tempV30),Hgb.normalize(Hi._tempV30,Hi._tempV30),Hgb.cross(Hc,Hi._tempV30,Hi._tempV31),Hgb.normalize(Hi._tempV31,Hi._tempV31),Hgb.cross(Hi._tempV30,Hi._tempV31,Hi._tempV32);var He=Hi._tempV30.elements,Hf=Hi._tempV31.elements,Hg=Hi._tempV32.elements,Hh=Hd.elements;Hh[0]=Hf[0],Hh[3]=Hf[1],Hh[6]=Hf[2],Hh[1]=Hg[0],Hh[4]=Hg[1],Hh[7]=Hg[2],Hh[2]=He[0],Hh[5]=He[1],Hh[8]=He[2]},Hi.DEFAULT=new Hi,Hl(Hi,["_tempV30",function(){return this._tempV30=new Hgb},"_tempV31",function(){return this._tempV31=new Hgb},"_tempV32",function(){return this._tempV32=new Hgb}]),Hi}(),Hab=function(){function Hz(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hl,Hm,Hn,Ho,Hp){void 0===Ha&&(Ha=1),void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=0),void 0===He&&(He=0),void 0===Hf&&(Hf=1),void 0===Hg&&(Hg=0),void 0===Hh&&(Hh=0),void 0===Hi&&(Hi=0),void 0===Hj&&(Hj=0),void 0===Hk&&(Hk=1),void 0===Hl&&(Hl=0),void 0===Hm&&(Hm=0),void 0===Hn&&(Hn=0),void 0===Ho&&(Ho=0),void 0===Hp&&(Hp=1);var Hq=this.elements=new Float32Array(16);Hq[0]=Ha,Hq[1]=Hb,Hq[2]=Hc,Hq[3]=Hd,Hq[4]=He,Hq[5]=Hf,Hq[6]=Hg,Hq[7]=Hh,Hq[8]=Hi,Hq[9]=Hj,Hq[10]=Hk,Hq[11]=Hl,Hq[12]=Hm,Hq[13]=Hn,Hq[14]=Ho,Hq[15]=Hp}Hn(Hz,"laya.d3.math.Matrix4x4");var Ha=Hz.prototype;return Hv.imps(Ha,{"laya.d3.core.IClone":!0}),Ha.getElementByRowColumn=function(Ha,Hb){if(Ha<0||3<Ha)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(Hb<0||3<Hb)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*Ha+Hb]},Ha.setElementByRowColumn=function(Ha,Hb,Hc){if(Ha<0||3<Ha)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(Hb<0||3<Hb)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*Ha+Hb]=Hc},Ha.equalsOtherMatrix=function(Ha){var Hb=this.elements,Hc=Ha.elements;return H$a.nearEqual(Hb[0],Hc[0])&&H$a.nearEqual(Hb[1],Hc[1])&&H$a.nearEqual(Hb[2],Hc[2])&&H$a.nearEqual(Hb[3],Hc[3])&&H$a.nearEqual(Hb[4],Hc[4])&&H$a.nearEqual(Hb[5],Hc[5])&&H$a.nearEqual(Hb[6],Hc[6])&&H$a.nearEqual(Hb[7],Hc[7])&&H$a.nearEqual(Hb[8],Hc[8])&&H$a.nearEqual(Hb[9],Hc[9])&&H$a.nearEqual(Hb[10],Hc[10])&&H$a.nearEqual(Hb[11],Hc[11])&&H$a.nearEqual(Hb[12],Hc[12])&&H$a.nearEqual(Hb[13],Hc[13])&&H$a.nearEqual(Hb[14],Hc[14])&&H$a.nearEqual(Hb[15],Hc[15])},Ha.decomposeTransRotScale=function(Ha,Hb,Hc){var Hd=Hz._tempMatrix4x4;return this.decomposeTransRotMatScale(Ha,Hd,Hc)?(Hcb.createFromMatrix4x4(Hd,Hb),!0):(Hb.identity(),!1)},Ha.decomposeTransRotMatScale=function(Ha,Hb,Hc){var Hd=this.elements,He=Ha.elements,Hf=Hb.elements,Hg=Hc.elements;He[0]=Hd[12],He[1]=Hd[13],He[2]=Hd[14];var Hh=Hd[0],Hi=Hd[1],Hj=Hd[2],Hk=Hd[4],Hl=Hd[5],Hm=Hd[6],Hn=Hd[8],Ho=Hd[9],Hp=Hd[10],Hq=Hg[0]=Math.sqrt(Hh*Hh+Hi*Hi+Hj*Hj),Hr=Hg[1]=Math.sqrt(Hk*Hk+Hl*Hl+Hm*Hm),Hs=Hg[2]=Math.sqrt(Hn*Hn+Ho*Ho+Hp*Hp);if(H$a.isZero(Hq)||H$a.isZero(Hr)||H$a.isZero(Hs))return Hf[1]=Hf[2]=Hf[3]=Hf[4]=Hf[6]=Hf[7]=Hf[8]=Hf[9]=Hf[11]=Hf[12]=Hf[13]=Hf[14]=0,Hf[0]=Hf[5]=Hf[10]=Hf[15]=1,!1;var Ht=Hz._tempVector0,Hu=Ht.elements;Hu[0]=Hn/Hs,Hu[1]=Ho/Hs,Hu[2]=Hp/Hs;var Hv=Hz._tempVector1,Hw=Hv.elements;Hw[0]=Hh/Hq,Hw[1]=Hi/Hq,Hw[2]=Hj/Hq;var Hx=Hz._tempVector2;Hgb.cross(Ht,Hv,Hx);var Hy=Hz._tempVector1;return Hgb.cross(Hx,Ht,Hy),Hf[3]=Hf[7]=Hf[11]=Hf[12]=Hf[13]=Hf[14]=0,Hf[15]=1,Hf[0]=Hy.x,Hf[1]=Hy.y,Hf[2]=Hy.z,Hf[4]=Hx.x,Hf[5]=Hx.y,Hf[6]=Hx.z,Hf[8]=Ht.x,Hf[9]=Ht.y,Hf[10]=Ht.z,Hf[0]*Hh+Hf[1]*Hi+Hf[2]*Hj<0&&(Hg[0]=-Hq),Hf[4]*Hk+Hf[5]*Hl+Hf[6]*Hm<0&&(Hg[1]=-Hr),Hf[8]*Hn+Hf[9]*Ho+Hf[10]*Hp<0&&(Hg[2]=-Hs),!0},Ha.decomposeYawPitchRoll=function(Ha){var Hb=Ha.elements,Hc=Math.asin(-this.elements[9]);Hb[1]=Hc,Math.cos(Hc)>H$a.zeroTolerance?(Hb[2]=Math.atan2(this.elements[1],this.elements[5]),Hb[0]=Math.atan2(this.elements[8],this.elements[10])):(Hb[2]=Math.atan2(-this.elements[4],this.elements[0]),Hb[0]=0)},Ha.normalize=function(){var Ha=this.elements,Hb=Ha[0],Hc=Ha[1],Hd=Ha[2],He=Math.sqrt(Hb*Hb+Hc*Hc+Hd*Hd);if(!He)return Ha[0]=0,Ha[1]=0,void(Ha[2]=0);1!=He&&(He=1/He,Ha[0]=Hb*He,Ha[1]=Hc*He,Ha[2]=Hd*He)},Ha.transpose=function(){var Ha,Hb;return Hb=(Ha=this.elements)[1],Ha[1]=Ha[4],Ha[4]=Hb,Hb=Ha[2],Ha[2]=Ha[8],Ha[8]=Hb,Hb=Ha[3],Ha[3]=Ha[12],Ha[12]=Hb,Hb=Ha[6],Ha[6]=Ha[9],Ha[9]=Hb,Hb=Ha[7],Ha[7]=Ha[13],Ha[13]=Hb,Hb=Ha[11],Ha[11]=Ha[14],Ha[14]=Hb,this},Ha.invert=function(Ha){var Hb=this.elements,Hc=Ha.elements,Hd=Hb[0],He=Hb[1],Hf=Hb[2],Hg=Hb[3],Hh=Hb[4],Hi=Hb[5],Hj=Hb[6],Hk=Hb[7],Hl=Hb[8],Hm=Hb[9],Hn=Hb[10],Ho=Hb[11],Hp=Hb[12],Hq=Hb[13],Hr=Hb[14],Hs=Hb[15],Ht=Hd*Hi-He*Hh,Hu=Hd*Hj-Hf*Hh,Hv=Hd*Hk-Hg*Hh,Hw=He*Hj-Hf*Hi,Hx=He*Hk-Hg*Hi,Hy=Hf*Hk-Hg*Hj,Hz=Hl*Hq-Hm*Hp,HA=Hl*Hr-Hn*Hp,HB=Hl*Hs-Ho*Hp,HC=Hm*Hr-Hn*Hq,HD=Hm*Hs-Ho*Hq,HE=Hn*Hs-Ho*Hr,HF=Ht*HE-Hu*HD+Hv*HC+Hw*HB-Hx*HA+Hy*Hz;0!==Math.abs(HF)&&(HF=1/HF,Hc[0]=(Hi*HE-Hj*HD+Hk*HC)*HF,Hc[1]=(Hf*HD-He*HE-Hg*HC)*HF,Hc[2]=(Hq*Hy-Hr*Hx+Hs*Hw)*HF,Hc[3]=(Hn*Hx-Hm*Hy-Ho*Hw)*HF,Hc[4]=(Hj*HB-Hh*HE-Hk*HA)*HF,Hc[5]=(Hd*HE-Hf*HB+Hg*HA)*HF,Hc[6]=(Hr*Hv-Hp*Hy-Hs*Hu)*HF,Hc[7]=(Hl*Hy-Hn*Hv+Ho*Hu)*HF,Hc[8]=(Hh*HD-Hi*HB+Hk*Hz)*HF,Hc[9]=(He*HB-Hd*HD-Hg*Hz)*HF,Hc[10]=(Hp*Hx-Hq*Hv+Hs*Ht)*HF,Hc[11]=(Hm*Hv-Hl*Hx-Ho*Ht)*HF,Hc[12]=(Hi*HA-Hh*HC-Hj*Hz)*HF,Hc[13]=(Hd*HC-He*HA+Hf*Hz)*HF,Hc[14]=(Hq*Hu-Hp*Hw-Hr*Ht)*HF,Hc[15]=(Hl*Hw-Hm*Hu+Hn*Ht)*HF)},Ha.identity=function(){var Ha=this.elements;Ha[1]=Ha[2]=Ha[3]=Ha[4]=Ha[6]=Ha[7]=Ha[8]=Ha[9]=Ha[11]=Ha[12]=Ha[13]=Ha[14]=0,Ha[0]=Ha[5]=Ha[10]=Ha[15]=1},Ha.cloneTo=function(Ha){var Hb,Hc,Hd;if((Hc=this.elements)!==(Hd=Ha.elements))for(Hb=0;Hb<16;++Hb)Hd[Hb]=Hc[Hb]},Ha.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ha.getTranslationVector=function(Ha){var Hb=this.elements,Hc=Ha.elements;Hc[0]=Hb[12],Hc[1]=Hb[13],Hc[2]=Hb[14]},Ha.setTranslationVector=function(Ha){var Hb=this.elements,Hc=Ha.elements;Hb[12]=Hc[0],Hb[13]=Hc[1],Hb[14]=Hc[2]},Ha.getForward=function(Ha){var Hb=this.elements,Hc=Ha.elements;Hc[0]=-Hb[8],Hc[1]=-Hb[9],Hc[2]=-Hb[10]},Ha.setForward=function(Ha){var Hb=this.elements,Hc=Ha.elements;Hb[8]=-Hc[0],Hb[9]=-Hc[1],Hb[10]=-Hc[2]},Hz.createRotationX=function(Ha,Hb){var Hc=Hb.elements,Hd=Math.sin(Ha),He=Math.cos(Ha);Hc[1]=Hc[2]=Hc[3]=Hc[4]=Hc[7]=Hc[8]=Hc[11]=Hc[12]=Hc[13]=Hc[14]=0,Hc[0]=Hc[15]=1,Hc[5]=Hc[10]=He,Hc[6]=Hd,Hc[9]=-Hd},Hz.createRotationY=function(Ha,Hb){var Hc=Hb.elements,Hd=Math.sin(Ha),He=Math.cos(Ha);Hc[1]=Hc[3]=Hc[4]=Hc[6]=Hc[7]=Hc[9]=Hc[11]=Hc[12]=Hc[13]=Hc[14]=0,Hc[5]=Hc[15]=1,Hc[0]=Hc[10]=He,Hc[2]=-Hd,Hc[8]=Hd},Hz.createRotationZ=function(Ha,Hb){var Hc=Hb.elements,Hd=Math.sin(Ha),He=Math.cos(Ha);Hc[2]=Hc[3]=Hc[6]=Hc[7]=Hc[8]=Hc[9]=Hc[11]=Hc[12]=Hc[13]=Hc[14]=0,Hc[10]=Hc[15]=1,Hc[0]=Hc[5]=He,Hc[1]=Hd,Hc[4]=-Hd},Hz.createRotationYawPitchRoll=function(Ha,Hb,Hc,Hd){Hcb.createFromYawPitchRoll(Ha,Hb,Hc,Hz._tempQuaternion),Hz.createRotationQuaternion(Hz._tempQuaternion,Hd)},Hz.createRotationAxis=function(Ha,Hb,Hc){var Hd=Ha.elements,He=Hd[0],Hf=Hd[1],Hg=Hd[2],Hh=Math.cos(Hb),Hi=Math.sin(Hb),Hj=He*He,Hk=Hf*Hf,Hl=Hg*Hg,Hm=He*Hf,Hn=He*Hg,Ho=Hf*Hg,Hp=Hc.elements;Hp[3]=Hp[7]=Hp[11]=Hp[12]=Hp[13]=Hp[14]=0,Hp[15]=1,Hp[0]=Hj+Hh*(1-Hj),Hp[1]=Hm-Hh*Hm+Hi*Hg,Hp[2]=Hn-Hh*Hn-Hi*Hf,Hp[4]=Hm-Hh*Hm-Hi*Hg,Hp[5]=Hk+Hh*(1-Hk),Hp[6]=Ho-Hh*Ho+Hi*He,Hp[8]=Hn-Hh*Hn+Hi*Hf,Hp[9]=Ho-Hh*Ho-Hi*He,Hp[10]=Hl+Hh*(1-Hl)},Hz.createRotationQuaternion=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements,He=Hc[0],Hf=Hc[1],Hg=Hc[2],Hh=Hc[3],Hi=He*He,Hj=Hf*Hf,Hk=Hg*Hg,Hl=He*Hf,Hm=Hg*Hh,Hn=Hg*He,Ho=Hf*Hh,Hp=Hf*Hg,Hq=He*Hh;Hd[3]=Hd[7]=Hd[11]=Hd[12]=Hd[13]=Hd[14]=0,Hd[15]=1,Hd[0]=1-2*(Hj+Hk),Hd[1]=2*(Hl+Hm),Hd[2]=2*(Hn-Ho),Hd[4]=2*(Hl-Hm),Hd[5]=1-2*(Hk+Hi),Hd[6]=2*(Hp+Hq),Hd[8]=2*(Hn+Ho),Hd[9]=2*(Hp-Hq),Hd[10]=1-2*(Hj+Hi)},Hz.createTranslate=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements;Hd[4]=Hd[8]=Hd[1]=Hd[9]=Hd[2]=Hd[6]=Hd[3]=Hd[7]=Hd[11]=0,Hd[0]=Hd[5]=Hd[10]=Hd[15]=1,Hd[12]=Hc[0],Hd[13]=Hc[1],Hd[14]=Hc[2]},Hz.createScaling=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements;Hd[0]=Hc[0],Hd[5]=Hc[1],Hd[10]=Hc[2],Hd[1]=Hd[4]=Hd[8]=Hd[12]=Hd[9]=Hd[13]=Hd[2]=Hd[6]=Hd[14]=Hd[3]=Hd[7]=Hd[11]=0,Hd[15]=1},Hz.multiply=function(Ha,Hb,Hc){var Hd,He,Hf,Hg,Hh,Hi,Hj,Hk;for(He=Hc.elements,Hf=Ha.elements,He===(Hg=Hb.elements)&&(Hg=Hg.slice()),Hd=0;Hd<4;Hd++)Hh=Hf[Hd],Hi=Hf[Hd+4],Hj=Hf[Hd+8],Hk=Hf[Hd+12],He[Hd]=Hh*Hg[0]+Hi*Hg[1]+Hj*Hg[2]+Hk*Hg[3],He[Hd+4]=Hh*Hg[4]+Hi*Hg[5]+Hj*Hg[6]+Hk*Hg[7],He[Hd+8]=Hh*Hg[8]+Hi*Hg[9]+Hj*Hg[10]+Hk*Hg[11],He[Hd+12]=Hh*Hg[12]+Hi*Hg[13]+Hj*Hg[14]+Hk*Hg[15]},Hz.createFromQuaternion=function(Ha,Hb){var Hc=Hb.elements,Hd=Ha.elements,He=Hd[0],Hf=Hd[1],Hg=Hd[2],Hh=Hd[3],Hi=He+He,Hj=Hf+Hf,Hk=Hg+Hg,Hl=He*Hi,Hm=Hf*Hi,Hn=Hf*Hj,Ho=Hg*Hi,Hp=Hg*Hj,Hq=Hg*Hk,Hr=Hh*Hi,Hs=Hh*Hj,Ht=Hh*Hk;Hc[0]=1-Hn-Hq,Hc[1]=Hm+Ht,Hc[2]=Ho-Hs,Hc[3]=0,Hc[4]=Hm-Ht,Hc[5]=1-Hl-Hq,Hc[6]=Hp+Hr,Hc[7]=0,Hc[8]=Ho+Hs,Hc[9]=Hp-Hr,Hc[10]=1-Hl-Hn,Hc[11]=0,Hc[12]=0,Hc[13]=0,Hc[14]=0,Hc[15]=1},Hz.createAffineTransformation=function(Ha,Hb,Hc,Hd){var He=Ha.elements,Hf=Hb.elements,Hg=Hc.elements,Hh=Hd.elements,Hi=Hf[0],Hj=Hf[1],Hk=Hf[2],Hl=Hf[3],Hm=Hi+Hi,Hn=Hj+Hj,Ho=Hk+Hk,Hp=Hi*Hm,Hq=Hi*Hn,Hr=Hi*Ho,Hs=Hj*Hn,Ht=Hj*Ho,Hu=Hk*Ho,Hv=Hl*Hm,Hw=Hl*Hn,Hx=Hl*Ho,Hy=Hg[0],Hz=Hg[1],HA=Hg[2];Hh[0]=(1-(Hs+Hu))*Hy,Hh[1]=(Hq+Hx)*Hy,Hh[2]=(Hr-Hw)*Hy,Hh[3]=0,Hh[4]=(Hq-Hx)*Hz,Hh[5]=(1-(Hp+Hu))*Hz,Hh[6]=(Ht+Hv)*Hz,Hh[7]=0,Hh[8]=(Hr+Hw)*HA,Hh[9]=(Ht-Hv)*HA,Hh[10]=(1-(Hp+Hs))*HA,Hh[11]=0,Hh[12]=He[0],Hh[13]=He[1],Hh[14]=He[2],Hh[15]=1},Hz.createLookAt=function(Ha,Hb,Hc,Hd){var He=Hd.elements,Hf=Hz._tempVector0,Hg=Hz._tempVector1,Hh=Hz._tempVector2;Hgb.subtract(Ha,Hb,Hh),Hgb.normalize(Hh,Hh),Hgb.cross(Hc,Hh,Hf),Hgb.normalize(Hf,Hf),Hgb.cross(Hh,Hf,Hg),Hd.identity(),He[0]=Hf.x,He[4]=Hf.y,He[8]=Hf.z,He[1]=Hg.x,He[5]=Hg.y,He[9]=Hg.z,He[2]=Hh.x,He[6]=Hh.y,He[10]=Hh.z,He[12]=-Hgb.dot(Hf,Ha),He[13]=-Hgb.dot(Hg,Ha),He[14]=-Hgb.dot(Hh,Ha)},Hz.createPerspective=function(Ha,Hb,Hc,Hd,He){var Hf=He.elements,Hg=1/Math.tan(Ha/2),Hh=1/(Hc-Hd);Hf[0]=Hg/Hb,Hf[5]=Hg,Hf[10]=(Hd+Hc)*Hh,Hf[11]=-1,Hf[14]=2*Hd*Hc*Hh,Hf[1]=Hf[2]=Hf[3]=Hf[4]=Hf[6]=Hf[7]=Hf[8]=Hf[9]=Hf[12]=Hf[13]=Hf[15]=0},Hz.createOrthoOffCenterRH=function(Ha,Hb,Hc,Hd,He,Hf,Hg){var Hh=Hg.elements,Hi=1/(Ha-Hb),Hj=1/(Hc-Hd),Hk=1/(He-Hf);Hh[1]=Hh[2]=Hh[3]=Hh[4]=Hh[6]=Hh[7]=Hh[8]=Hh[9]=Hh[11]=0,Hh[15]=1,Hh[0]=-2*Hi,Hh[5]=-2*Hj,Hh[10]=2*Hk,Hh[12]=(Ha+Hb)*Hi,Hh[13]=(Hd+Hc)*Hj,Hh[14]=(Hf+He)*Hk},Hz.translation=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements;Hd[0]=Hd[5]=Hd[10]=Hd[15]=1,Hd[12]=Hc[0],Hd[13]=Hc[1],Hd[14]=Hc[2]},Hl(Hz,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new Hz},"_tempVector0",function(){return this._tempVector0=new Hgb},"_tempVector1",function(){return this._tempVector1=new Hgb},"_tempVector2",function(){return this._tempVector2=new Hgb},"_tempQuaternion",function(){return this._tempQuaternion=new Hcb},"DEFAULT",function(){return this.DEFAULT=new Hz},"ZERO",function(){return this.ZERO=new Hz(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),Hz}(),Hbb=(function(){function Ht(Ha,Hb){this.extents=null,this.transformation=null,this.extents=Ha,this.transformation=Hb}Hn(Ht,"laya.d3.math.OrientedBoundBox");var Ha=Ht.prototype;Ha.getCorners=function(Ha){var Hb=Ht._tempV30.elements,Hc=Ht._tempV31.elements,Hd=Ht._tempV32.elements,He=this.extents.elements;Hb[0]=He[0],Hb[1]=Hb[2]=0,Hc[1]=He[1],Hc[0]=Hc[2]=0,Hd[2]=He[2],Hd[0]=Hd[1]=0,Hgb.TransformNormal(Ht._tempV30,this.transformation,Ht._tempV30),Hgb.TransformNormal(Ht._tempV31,this.transformation,Ht._tempV31),Hgb.TransformNormal(Ht._tempV32,this.transformation,Ht._tempV32);var Hf=Ht._tempV33;this.transformation.getTranslationVector(Hf),Ha.length=8,Hgb.add(Hf,Ht._tempV30,Ht._tempV34),Hgb.add(Ht._tempV34,Ht._tempV31,Ht._tempV34),Hgb.add(Ht._tempV34,Ht._tempV32,Ha[0]),Hgb.add(Hf,Ht._tempV30,Ht._tempV34),Hgb.add(Ht._tempV34,Ht._tempV31,Ht._tempV34),Hgb.subtract(Ht._tempV34,Ht._tempV32,Ha[1]),Hgb.subtract(Hf,Ht._tempV30,Ht._tempV34),Hgb.add(Ht._tempV34,Ht._tempV31,Ht._tempV34),Hgb.subtract(Ht._tempV34,Ht._tempV32,Ha[2]),Hgb.subtract(Hf,Ht._tempV30,Ht._tempV34),Hgb.add(Ht._tempV34,Ht._tempV31,Ht._tempV34),Hgb.add(Ht._tempV34,Ht._tempV32,Ha[3]),Hgb.add(Hf,Ht._tempV30,Ht._tempV34),Hgb.subtract(Ht._tempV34,Ht._tempV31,Ht._tempV34),Hgb.add(Ht._tempV34,Ht._tempV32,Ha[4]),Hgb.add(Hf,Ht._tempV30,Ht._tempV34),Hgb.subtract(Ht._tempV34,Ht._tempV31,Ht._tempV34),Hgb.subtract(Ht._tempV34,Ht._tempV32,Ha[5]),Hgb.subtract(Hf,Ht._tempV30,Ht._tempV34),Hgb.subtract(Ht._tempV34,Ht._tempV31,Ht._tempV34),Hgb.subtract(Ht._tempV34,Ht._tempV32,Ha[6]),Hgb.subtract(Hf,Ht._tempV30,Ht._tempV34),Hgb.subtract(Ht._tempV34,Ht._tempV31,Ht._tempV34),Hgb.add(Ht._tempV34,Ht._tempV32,Ha[7])},Ha.transform=function(Ha){Hab.multiply(this.transformation,Ha,this.transformation)},Ha.scale=function(Ha){Hgb.multiply(this.extents,Ha,this.extents)},Ha.translate=function(Ha){this.transformation.getTranslationVector(Ht._tempV30),Hgb.add(Ht._tempV30,Ha,Ht._tempV31),this.transformation.setTranslationVector(Ht._tempV31)},Ha.Size=function(Ha){Hgb.scale(this.extents,2,Ha)},Ha.getSize=function(Ha){var Hb=this.extents.elements;Ht._tempV30.x=Hb[0],Ht._tempV31.y=Hb[1],Ht._tempV32.z=Hb[2],Hgb.TransformNormal(Ht._tempV30,this.transformation,Ht._tempV30),Hgb.TransformNormal(Ht._tempV31,this.transformation,Ht._tempV31),Hgb.TransformNormal(Ht._tempV31,this.transformation,Ht._tempV32);var Hc=Ha.elements;Hc[0]=Hgb.scalarLength(Ht._tempV30),Hc[1]=Hgb.scalarLength(Ht._tempV31),Hc[2]=Hgb.scalarLength(Ht._tempV32)},Ha.getSizeSquared=function(Ha){var Hb=this.extents.elements;Ht._tempV30.x=Hb[0],Ht._tempV31.y=Hb[1],Ht._tempV32.z=Hb[2],Hgb.TransformNormal(Ht._tempV30,this.transformation,Ht._tempV30),Hgb.TransformNormal(Ht._tempV31,this.transformation,Ht._tempV31),Hgb.TransformNormal(Ht._tempV31,this.transformation,Ht._tempV32);var Hc=Ha.elements;Hc[0]=Hgb.scalarLengthSquared(Ht._tempV30),Hc[1]=Hgb.scalarLengthSquared(Ht._tempV31),Hc[2]=Hgb.scalarLengthSquared(Ht._tempV32)},Ha.getCenter=function(Ha){this.transformation.getTranslationVector(Ha)},Ha.containsPoint=function(Ha){var Hb=this.extents.elements,Hc=Hb[0],Hd=Hb[1],He=Hb[2];this.transformation.invert(Ht._tempM0),Hgb.transformCoordinate(Ha,Ht._tempM0,Ht._tempV30);var Hf=Ht._tempV30.elements,Hg=Math.abs(Hf[0]),Hh=Math.abs(Hf[1]),Hi=Math.abs(Hf[2]);return H$a.nearEqual(Hg,Hc)&&H$a.nearEqual(Hh,Hd)&&H$a.nearEqual(Hi,He)?2:Hg<Hc&&Hh<Hd&&Hi<He?1:0},Ha.containsPoints=function(Ha){var Hb=this.extents.elements,Hc=Hb[0],Hd=Hb[1],He=Hb[2];this.transformation.invert(Ht._tempM0);for(var Hf=!0,Hg=!1,Hh=0;Hh<Ha.length;Hh++){Hgb.transformCoordinate(Ha[Hh],Ht._tempM0,Ht._tempV30);var Hi=Ht._tempV30.elements,Hj=Math.abs(Hi[0]),Hk=Math.abs(Hi[1]),Hl=Math.abs(Hi[2]);H$a.nearEqual(Hj,Hc)&&H$a.nearEqual(Hk,Hd)&&H$a.nearEqual(Hl,He)&&(Hg=!0),Hj<Hc&&Hk<Hd&&Hl<He?Hg=!0:Hf=!1}return Hf?1:Hg?2:0},Ha.containsSphere=function(Ha,Hb){void 0===Hb&&(Hb=!1);var Hc=this.extents.elements,Hd=Hc[0],He=Hc[1],Hf=Hc[2],Hg=Ha.radius;this.transformation.invert(Ht._tempM0),Hgb.transformCoordinate(Ha.center,Ht._tempM0,Ht._tempV30);var Hh=NaN;if(Hh=Hb?Hg:(Hgb.scale(Hgb.UnitX,Hg,Ht._tempV31),Hgb.TransformNormal(Ht._tempV31,Ht._tempM0,Ht._tempV31),Hgb.scalarLength(Ht._tempV31)),Hgb.scale(this.extents,-1,Ht._tempV32),Hgb.Clamp(Ht._tempV30,Ht._tempV32,this.extents,Ht._tempV33),Hh*Hh<Hgb.distanceSquared(Ht._tempV30,Ht._tempV33))return 0;var Hi=Ht._tempV30.elements,Hj=Hi[0],Hk=Hi[1],Hl=Hi[2],Hm=Ht._tempV32.elements,Hn=Hm[0],Ho=Hm[1],Hp=Hm[2];return Hn+Hh<=Hj&&Hj<=Hd-Hh&&Hh<Hd-Hn&&Ho+Hh<=Hk&&Hk<=He-Hh&&Hh<He-Ho&&Hp+Hh<=Hl&&Hl<=Hf-Hh&&Hh<Hf-Hp?1:2},Ha.containsOrientedBoundBox=function(Ha){var Hb=0,Hc=0;Ha.getCorners(Ht._corners);var Hd=this.containsPoints(Ht._corners);if(0!=Hd)return Hd;var He=this.extents.elements;Ha.extents.cloneTo(Ht._tempV35);var Hf=Ht._tempV35.elements;Ht._getRows(this.transformation,Ht._rows1),Ht._getRows(Ha.transformation,Ht._rows2);var Hg=NaN;for(Hb=0;Hb<4;Hb++)for(Hc=0;Hc<4;Hc++)3==Hb||3==Hc?(Ht._tempM0.setElementByRowColumn(Hb,Hc,0),Ht._tempM1.setElementByRowColumn(Hb,Hc,0)):(Hg=Hgb.dot(Ht._rows1[Hb],Ht._rows2[Hc]),Ht._tempM0.setElementByRowColumn(Hb,Hc,Hg),Ht._tempM1.setElementByRowColumn(Hb,Hc,Math.abs(Hg)));Ha.getCenter(Ht._tempV34),this.getCenter(Ht._tempV36),Hgb.subtract(Ht._tempV34,Ht._tempV36,Ht._tempV30);var Hh=Ht._tempV31.elements;Hh[0]=Hgb.dot(Ht._tempV30,Ht._rows1[0]),Hh[1]=Hgb.dot(Ht._tempV30,Ht._rows1[1]),Hh[2]=Hgb.dot(Ht._tempV30,Ht._rows1[2]);var Hi=Ht._tempV32.elements,Hj=Ht._tempV33.elements;for(Hb=0;Hb<3;Hb++)if(Hi[0]=Ht._tempM1.getElementByRowColumn(Hb,0),Hi[1]=Ht._tempM1.getElementByRowColumn(Hb,1),Hi[2]=Ht._tempM1.getElementByRowColumn(Hb,2),He[Hb]+Hgb.dot(Ht._tempV35,Ht._tempV32)<Math.abs(Hh[Hb]))return 0;for(Hc=0;Hc<3;Hc++)if(Hi[0]=Ht._tempM1.getElementByRowColumn(0,Hc),Hi[1]=Ht._tempM1.getElementByRowColumn(1,Hc),Hi[2]=Ht._tempM1.getElementByRowColumn(2,Hc),Hj[0]=Ht._tempM0.getElementByRowColumn(0,Hc),Hj[1]=Ht._tempM0.getElementByRowColumn(1,Hc),Hj[2]=Ht._tempM0.getElementByRowColumn(2,Hc),Hgb.dot(this.extents,Ht._tempV32)+Hf[Hc]<Math.abs(Hgb.dot(Ht._tempV31,Ht._tempV33)))return 0;for(Hb=0;Hb<3;Hb++)for(Hc=0;Hc<3;Hc++){var Hk=(Hb+1)%3,Hl=(Hb+2)%3,Hm=(Hc+1)%3,Hn=(Hc+2)%3;if(He[Hk]*Ht._tempM1.getElementByRowColumn(Hl,Hc)+He[Hl]*Ht._tempM1.getElementByRowColumn(Hk,Hc)+(Hf[Hm]*Ht._tempM1.getElementByRowColumn(Hb,Hn)+Hf[Hn]*Ht._tempM1.getElementByRowColumn(Hb,Hm))<Math.abs(Hh[Hl]*Ht._tempM0.getElementByRowColumn(Hk,Hc)-Hh[Hk]*Ht._tempM0.getElementByRowColumn(Hl,Hc)))return 0}return 2},Ha.containsLine=function(Ha,Hb){Ht._corners[0]=Ha,Ht._corners[1]=Hb;var Hc=this.containsPoints(Ht._corners);if(0!=Hc)return Hc;var Hd=this.extents.elements,He=Hd[0],Hf=Hd[1],Hg=Hd[2];this.transformation.invert(Ht._tempM0),Hgb.transformCoordinate(Ha,Ht._tempM0,Ht._tempV30),Hgb.transformCoordinate(Hb,Ht._tempM0,Ht._tempV31),Hgb.add(Ht._tempV30,Ht._tempV31,Ht._tempV32),Hgb.scale(Ht._tempV32,.5,Ht._tempV32),Hgb.subtract(Ht._tempV30,Ht._tempV32,Ht._tempV33);var Hh=Ht._tempV33.elements,Hi=Hh[0],Hj=Hh[1],Hk=Hh[2],Hl=Ht._tempV34.elements,Hm=Hl[0]=Math.abs(Hh[0]),Hn=Hl[1]=Math.abs(Hh[1]),Ho=Hl[2]=Math.abs(Hh[2]),Hp=Ht._tempV32.elements,Hq=Hp[0],Hr=Hp[1],Hs=Hp[2];return Math.abs(Hq)>He+Hm?0:Math.abs(Hr)>Hf+Hn?0:Math.abs(Hs)>Hg+Ho?0:Math.abs(Hr*Hk-Hs*Hj)>Hf*Ho+Hg*Hn?0:Math.abs(Hq*Hk-Hs*Hi)>He*Ho+Hg*Hm?0:Math.abs(Hq*Hj-Hr*Hi)>He*Hn+Hf*Hm?0:2},Ha.containsBoundBox=function(Ha){var Hb=0,Hc=0,Hd=Ha.min,He=Ha.max;Ha.getCorners(Ht._corners);var Hf=this.containsPoints(Ht._corners);if(0!=Hf)return Hf;Hgb.subtract(He,Hd,Ht._tempV30),Hgb.scale(Ht._tempV30,.5,Ht._tempV30),Hgb.add(Hd,Ht._tempV30,Ht._tempV30),Hgb.subtract(He,Ht._tempV30,Ht._tempV31);var Hg=this.extents.elements,Hh=Ht._tempV31.elements;Ht._getRows(this.transformation,Ht._rows1),this.transformation.invert(Ht._tempM0);for(Hb=0;Hb<3;Hb++)for(Hc=0;Hc<3;Hc++)Ht._tempM1.setElementByRowColumn(Hb,Hc,Math.abs(Ht._tempM0.getElementByRowColumn(Hb,Hc)));this.getCenter(Ht._tempV35),Hgb.subtract(Ht._tempV30,Ht._tempV35,Ht._tempV32);var Hi=Ht._tempV31.elements;Hi[0]=Hgb.dot(Ht._tempV32,Ht._rows1[0]),Hi[1]=Hgb.dot(Ht._tempV32,Ht._rows1[1]),Hi[2]=Hgb.dot(Ht._tempV32,Ht._rows1[2]);var Hj=Ht._tempV33.elements,Hk=Ht._tempV34.elements;for(Hb=0;Hb<3;Hb++)if(Hj[0]=Ht._tempM1.getElementByRowColumn(Hb,0),Hj[1]=Ht._tempM1.getElementByRowColumn(Hb,1),Hj[2]=Ht._tempM1.getElementByRowColumn(Hb,2),Hg[Hb]+Hgb.dot(Ht._tempV31,Ht._tempV33)<Math.abs(Hi[Hb]))return 0;for(Hc=0;Hc<3;Hc++)if(Hj[0]=Ht._tempM1.getElementByRowColumn(0,Hc),Hj[1]=Ht._tempM1.getElementByRowColumn(1,Hc),Hj[2]=Ht._tempM1.getElementByRowColumn(2,Hc),Hk[0]=Ht._tempM0.getElementByRowColumn(0,Hc),Hk[1]=Ht._tempM0.getElementByRowColumn(1,Hc),Hk[2]=Ht._tempM0.getElementByRowColumn(2,Hc),Hgb.dot(this.extents,Ht._tempV33)+Hh[Hc]<Math.abs(Hgb.dot(Ht._tempV31,Ht._tempV34)))return 0;for(Hb=0;Hb<3;Hb++)for(Hc=0;Hc<3;Hc++){var Hl=(Hb+1)%3,Hm=(Hb+2)%3,Hn=(Hc+1)%3,Ho=(Hc+2)%3;if(Hg[Hl]*Ht._tempM1.getElementByRowColumn(Hm,Hc)+Hg[Hm]*Ht._tempM1.getElementByRowColumn(Hl,Hc)+(Hh[Hn]*Ht._tempM1.getElementByRowColumn(Hb,Ho)+Hh[Ho]*Ht._tempM1.getElementByRowColumn(Hb,Hn))<Math.abs(Hi[Hm]*Ht._tempM0.getElementByRowColumn(Hl,Hc)-Hi[Hl]*Ht._tempM0.getElementByRowColumn(Hm,Hc)))return 0}return 2},Ha.intersectsRay=function(Ha,Hb){Hgb.scale(this.extents,-1,Ht._tempV30),this.transformation.invert(Ht._tempM0),Hgb.TransformNormal(Ha.direction,Ht._tempM0,Ht._ray.direction),Hgb.transformCoordinate(Ha.origin,Ht._tempM0,Ht._ray.origin),Ht._boxBound1.min=Ht._tempV30,Ht._boxBound1.max=this.extents;var Hc=Collision.intersectsRayAndBoxRP(Ht._ray,Ht._boxBound1,Hb);return-1!==Hc&&Hgb.transformCoordinate(Hb,this.transformation,Hb),Hc},Ha._getLocalCorners=function(Ha){Ha.length=8;var Hb=this.extents.elements;Ht._tempV30.x=Hb[0],Ht._tempV31.y=Hb[1],Ht._tempV32.z=Hb[2],Hgb.add(Ht._tempV30,Ht._tempV31,Ht._tempV33),Hgb.add(Ht._tempV33,Ht._tempV32,Ha[0]),Hgb.add(Ht._tempV30,Ht._tempV31,Ht._tempV33),Hgb.subtract(Ht._tempV33,Ht._tempV32,Ha[1]),Hgb.subtract(Ht._tempV31,Ht._tempV30,Ht._tempV33),Hgb.subtract(Ht._tempV33,Ht._tempV30,Ha[2]),Hgb.subtract(Ht._tempV31,Ht._tempV30,Ht._tempV33),Hgb.add(Ht._tempV33,Ht._tempV32,Ha[3]),Hgb.subtract(Ht._tempV30,Ht._tempV31,Ht._tempV33),Hgb.add(Ht._tempV33,Ht._tempV32,Ha[4]),Hgb.subtract(Ht._tempV30,Ht._tempV31,Ht._tempV33),Hgb.subtract(Ht._tempV33,Ht._tempV32,Ha[5]),Hgb.scale(Ha[0],-1,Ha[6]),Hgb.subtract(Ht._tempV32,Ht._tempV30,Ht._tempV33),Hgb.subtract(Ht._tempV33,Ht._tempV31,Ha[7])},Ha.equals=function(Ha){return this.extents==Ha.extents&&this.transformation==Ha.transformation},Ha.cloneTo=function(Ha){var Hb=Ha;this.extents.cloneTo(Hb.extents),this.transformation.cloneTo(Hb.transformation)},Ht.createByBoundBox=function(Ha,Hb){var Hc=Ha.min,Hd=Ha.max;Hgb.subtract(Hd,Hc,Ht._tempV30),Hgb.scale(Ht._tempV30,.5,Ht._tempV30),Hgb.add(Hc,Ht._tempV30,Ht._tempV31),Hgb.subtract(Hd,Ht._tempV31,Ht._tempV32),Hab.translation(Ht._tempV31,Ht._tempM0);var He=Ht._tempV32.clone(),Hf=Ht._tempM0.clone();Hb.extents=He,Hb.transformation=Hf},Ht.createByMinAndMaxVertex=function(Ha,Hb){return Hgb.subtract(Hb,Ha,Ht._tempV30),Hgb.scale(Ht._tempV30,.5,Ht._tempV30),Hgb.add(Ha,Ht._tempV30,Ht._tempV31),Hgb.subtract(Hb,Ht._tempV31,Ht._tempV32),Hab.translation(Ht._tempV31,Ht._tempM0),new Ht(Ht._tempV32,Ht._tempM0)},Ht._getRows=function(Ha,Hb){Hb.length=3;var Hc=Ha.elements,Hd=Hb[0].elements;Hd[0]=Hc[0],Hd[1]=Hc[1],Hd[2]=Hc[2];var He=Hb[1].elements;He[0]=Hc[4],He[1]=Hc[5],He[2]=Hc[6];var Hf=Hb[2].elements;Hf[0]=Hc[8],Hf[1]=Hc[9],Hf[2]=Hc[10]},Ht.getObbtoObbMatrix4x4=function(Ha,Hb,Hc,Hd){var He=Ha.transformation,Hf=Hb.transformation;if(Hc){Ht._getRows(He,Ht._rows1),Ht._getRows(Hf,Ht._rows2);for(var Hg=0;Hg<3;Hg++)for(var Hh=0;Hh<3;Hh++)Hd.setElementByRowColumn(Hg,Hh,Hgb.dot(Ht._rows2[Hg],Ht._rows1[Hh]));Hb.getCenter(Ht._tempV30),Ha.getCenter(Ht._tempV31),Hgb.subtract(Ht._tempV30,Ht._tempV31,Ht._tempV32);var Hi=Hd.elements;Hi[12]=Hgb.dot(Ht._tempV32,Ht._rows1[0]),Hi[13]=Hgb.dot(Ht._tempV32,Ht._rows1[1]),Hi[14]=Hgb.dot(Ht._tempV32,Ht._rows1[2]),Hi[15]=1}else He.invert(Ht._tempM0),Hab.multiply(Hf,Ht._tempM0,Hd)},Ht.merge=function(Ha,Hb,Hc){var Hd=Ha.extents,He=Ha.transformation;Ht.getObbtoObbMatrix4x4(Ha,Hb,Hc,Ht._tempM0),Hb._getLocalCorners(Ht._corners),Hgb.transformCoordinate(Ht._corners[0],Ht._tempM0,Ht._corners[0]),Hgb.transformCoordinate(Ht._corners[1],Ht._tempM0,Ht._corners[1]),Hgb.transformCoordinate(Ht._corners[2],Ht._tempM0,Ht._corners[2]),Hgb.transformCoordinate(Ht._corners[3],Ht._tempM0,Ht._corners[3]),Hgb.transformCoordinate(Ht._corners[4],Ht._tempM0,Ht._corners[4]),Hgb.transformCoordinate(Ht._corners[5],Ht._tempM0,Ht._corners[5]),Hgb.transformCoordinate(Ht._corners[6],Ht._tempM0,Ht._corners[6]),Hgb.transformCoordinate(Ht._corners[7],Ht._tempM0,Ht._corners[7]),Hgb.scale(Hd,-1,Ht._boxBound1.min),Hd.cloneTo(Ht._boxBound1.max),HXa.createfromPoints(Ht._corners,Ht._boxBound2),HXa.merge(Ht._boxBound2,Ht._boxBound1,Ht._boxBound3);var Hf=Ht._boxBound3.min,Hg=Ht._boxBound3.max;Hgb.subtract(Hg,Hf,Ht._tempV30),Hgb.scale(Ht._tempV30,.5,Ht._tempV30),Hgb.add(Hf,Ht._tempV30,Ht._tempV32),Hgb.subtract(Hg,Ht._tempV32,Hd),Hgb.transformCoordinate(Ht._tempV32,He,Ht._tempV33)},Hl(Ht,["_tempV30",function(){return this._tempV30=new Hgb},"_tempV31",function(){return this._tempV31=new Hgb},"_tempV32",function(){return this._tempV32=new Hgb},"_tempV33",function(){return this._tempV33=new Hgb},"_tempV34",function(){return this._tempV34=new Hgb},"_tempV35",function(){return this._tempV35=new Hgb},"_tempV36",function(){return this._tempV36=new Hgb},"_tempM0",function(){return this._tempM0=new Hab},"_tempM1",function(){return this._tempM1=new Hab},"_corners",function(){return this._corners=[new Hgb,new Hgb,new Hgb,new Hgb,new Hgb,new Hgb,new Hgb,new Hgb]},"_rows1",function(){return this._rows1=[new Hgb,new Hgb,new Hgb]},"_rows2",function(){return this._rows2=[new Hgb,new Hgb,new Hgb]},"_ray",function(){return this._ray=new Heb(new Hgb,new Hgb)},"_boxBound1",function(){return this._boxBound1=new HXa(new Hgb,new Hgb)},"_boxBound2",function(){return this._boxBound2=new HXa(new Hgb,new Hgb)},"_boxBound3",function(){return this._boxBound3=new HXa(new Hgb,new Hgb)}])}(),function(){function Hv(Ha,Hb){this.normal=null,this.distance=NaN,void 0===Hb&&(Hb=0),this.normal=Ha,this.distance=Hb}return Hn(Hv,"laya.d3.math.Plane"),Hv.prototype.normalize=function(){var Ha=this.normal.elements,Hb=Ha[0],Hc=Ha[1],Hd=Ha[2],He=1/Math.sqrt(Hb*Hb+Hc*Hc+Hd*Hd);Ha[0]=Hb*He,Ha[1]=Hc*He,Ha[2]=Hd*He,this.distance*=He},Hv.createPlaneBy3P=function(Ha,Hb,Hc){var Hd=Ha.elements,He=Hb.elements,Hf=Hc.elements,Hg=He[0]-Hd[0],Hh=He[1]-Hd[1],Hi=He[2]-Hd[2],Hj=Hf[0]-Hd[0],Hk=Hf[1]-Hd[1],Hl=Hf[2]-Hd[2],Hm=Hh*Hl-Hi*Hk,Hn=Hi*Hj-Hg*Hl,Ho=Hg*Hk-Hh*Hj,Hp=1/Math.sqrt(Hm*Hm+Hn*Hn+Ho*Ho),Hq=Hm*Hp,Hr=Hn*Hp,Hs=Ho*Hp,Ht=Hv._TEMPVec3.elements;Ht[0]=Hq,Ht[1]=Hr,Ht[2]=Hs;var Hu=-(Hq*Hd[0]+Hr*Hd[1]+Hs*Hd[2]);return new Hv(Hv._TEMPVec3,Hu)},Hv.PlaneIntersectionType_Back=0,Hv.PlaneIntersectionType_Front=1,Hv.PlaneIntersectionType_Intersecting=2,Hl(Hv,["_TEMPVec3",function(){return this._TEMPVec3=new Hgb}]),Hv}()),Hcb=function(){function He(Ha,Hb,Hc,Hd){this.elements=new Float32Array(4),void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=1),this.elements[0]=Ha,this.elements[1]=Hb,this.elements[2]=Hc,this.elements[3]=Hd}Hn(He,"laya.d3.math.Quaternion");var Ha=He.prototype;return Hv.imps(Ha,{"laya.d3.core.IClone":!0}),Ha.scaling=function(Ha,Hb){var Hc=Hb.elements,Hd=this.elements;Hc[0]=Hd[0]*Ha,Hc[1]=Hd[1]*Ha,Hc[2]=Hd[2]*Ha,Hc[3]=Hd[3]*Ha},Ha.normalize=function(Ha){var Hb=Ha.elements,Hc=this.elements,Hd=Hc[0],He=Hc[1],Hf=Hc[2],Hg=Hc[3],Hh=Hd*Hd+He*He+Hf*Hf+Hg*Hg;0<Hh&&(Hh=1/Math.sqrt(Hh),Hb[0]=Hd*Hh,Hb[1]=He*Hh,Hb[2]=Hf*Hh,Hb[3]=Hg*Hh)},Ha.length=function(){var Ha=this.elements,Hb=Ha[0],Hc=Ha[1],Hd=Ha[2],He=Ha[3];return Math.sqrt(Hb*Hb+Hc*Hc+Hd*Hd+He*He)},Ha.rotateX=function(Ha,Hb){var Hc=Hb.elements,Hd=this.elements;Ha*=.5;var He=Hd[0],Hf=Hd[1],Hg=Hd[2],Hh=Hd[3],Hi=Math.sin(Ha),Hj=Math.cos(Ha);Hc[0]=He*Hj+Hh*Hi,Hc[1]=Hf*Hj+Hg*Hi,Hc[2]=Hg*Hj-Hf*Hi,Hc[3]=Hh*Hj-He*Hi},Ha.rotateY=function(Ha,Hb){var Hc=Hb.elements,Hd=this.elements;Ha*=.5;var He=Hd[0],Hf=Hd[1],Hg=Hd[2],Hh=Hd[3],Hi=Math.sin(Ha),Hj=Math.cos(Ha);Hc[0]=He*Hj-Hg*Hi,Hc[1]=Hf*Hj+Hh*Hi,Hc[2]=Hg*Hj+He*Hi,Hc[3]=Hh*Hj-Hf*Hi},Ha.rotateZ=function(Ha,Hb){var Hc=Hb.elements,Hd=this.elements;Ha*=.5;var He=Hd[0],Hf=Hd[1],Hg=Hd[2],Hh=Hd[3],Hi=Math.sin(Ha),Hj=Math.cos(Ha);Hc[0]=He*Hj+Hf*Hi,Hc[1]=Hf*Hj-He*Hi,Hc[2]=Hg*Hj+Hh*Hi,Hc[3]=Hh*Hj-Hg*Hi},Ha.getYawPitchRoll=function(Ha){Hgb.transformQuat(Hgb.ForwardRH,this,He.TEMPVector31),Hgb.transformQuat(Hgb.Up,this,He.TEMPVector32);var Hb=He.TEMPVector32.elements;He.angleTo(Hgb.ZERO,He.TEMPVector31,He.TEMPVector33);var Hc=He.TEMPVector33.elements;Hc[0]==Math.PI/2?(Hc[1]=He.arcTanAngle(Hb[2],Hb[0]),Hc[2]=0):Hc[0]==-Math.PI/2?(Hc[1]=He.arcTanAngle(-Hb[2],-Hb[0]),Hc[2]=0):(Hab.createRotationY(-Hc[1],He.TEMPMatrix0),Hab.createRotationX(-Hc[0],He.TEMPMatrix1),Hgb.transformCoordinate(He.TEMPVector32,He.TEMPMatrix0,He.TEMPVector32),Hgb.transformCoordinate(He.TEMPVector32,He.TEMPMatrix1,He.TEMPVector32),Hc[2]=He.arcTanAngle(Hb[1],-Hb[0])),Hc[1]<=-Math.PI&&(Hc[1]=Math.PI),Hc[2]<=-Math.PI&&(Hc[2]=Math.PI),Hc[1]>=Math.PI&&Hc[2]>=Math.PI&&(Hc[1]=0,Hc[2]=0,Hc[0]=Math.PI-Hc[0]);var Hd=Ha.elements;Hd[0]=Hc[1],Hd[1]=Hc[0],Hd[2]=Hc[2]},Ha.invert=function(Ha){var Hb=Ha.elements,Hc=this.elements,Hd=Hc[0],He=Hc[1],Hf=Hc[2],Hg=Hc[3],Hh=Hd*Hd+He*He+Hf*Hf+Hg*Hg,Hi=Hh?1/Hh:0;Hb[0]=-Hd*Hi,Hb[1]=-He*Hi,Hb[2]=-Hf*Hi,Hb[3]=Hg*Hi},Ha.identity=function(){var Ha=this.elements;Ha[0]=0,Ha[1]=0,Ha[2]=0,Ha[3]=1},Ha.fromArray=function(Ha,Hb){void 0===Hb&&(Hb=0),this.elements[0]=Ha[Hb+0],this.elements[1]=Ha[Hb+1],this.elements[2]=Ha[Hb+2],this.elements[3]=Ha[Hb+3]},Ha.cloneTo=function(Ha){var Hb,Hc,Hd;if((Hc=this.elements)!==(Hd=Ha.elements))for(Hb=0;Hb<4;++Hb)Hd[Hb]=Hc[Hb]},Ha.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ha.equals=function(Ha){var Hb=this.elements,Hc=Ha.elements;return H$a.nearEqual(Hb[0],Hc[0])&&H$a.nearEqual(Hb[1],Hc[1])&&H$a.nearEqual(Hb[2],Hc[2])&&H$a.nearEqual(Hb[3],Hc[3])},Ha.lengthSquared=function(){var Ha=this.elements[0],Hb=this.elements[1],Hc=this.elements[2],Hd=this.elements[3];return Ha*Ha+Hb*Hb+Hc*Hc+Hd*Hd},Ho(0,Ha,"x",function(){return this.elements[0]}),Ho(0,Ha,"y",function(){return this.elements[1]}),Ho(0,Ha,"z",function(){return this.elements[2]}),Ho(0,Ha,"w",function(){return this.elements[3]}),He.createFromYawPitchRoll=function(Ha,Hb,Hc,Hd){var He=.5*Hc,Hf=.5*Hb,Hg=.5*Ha,Hh=Math.sin(He),Hi=Math.cos(He),Hj=Math.sin(Hf),Hk=Math.cos(Hf),Hl=Math.sin(Hg),Hm=Math.cos(Hg),Hn=Hd.elements;Hn[0]=Hm*Hj*Hi+Hl*Hk*Hh,Hn[1]=Hl*Hk*Hi-Hm*Hj*Hh,Hn[2]=Hm*Hk*Hh-Hl*Hj*Hi,Hn[3]=Hm*Hk*Hi+Hl*Hj*Hh},He.multiply=function(Ha,Hb,Hc){var Hd=Ha.elements,He=Hb.elements,Hf=Hc.elements,Hg=Hd[0],Hh=Hd[1],Hi=Hd[2],Hj=Hd[3],Hk=He[0],Hl=He[1],Hm=He[2],Hn=He[3],Ho=Hh*Hm-Hi*Hl,Hp=Hi*Hk-Hg*Hm,Hq=Hg*Hl-Hh*Hk,Hr=Hg*Hk+Hh*Hl+Hi*Hm;Hf[0]=Hg*Hn+Hk*Hj+Ho,Hf[1]=Hh*Hn+Hl*Hj+Hp,Hf[2]=Hi*Hn+Hm*Hj+Hq,Hf[3]=Hj*Hn-Hr},He.arcTanAngle=function(Ha,Hb){return 0==Ha?1==Hb?Math.PI/2:-Math.PI/2:0<Ha?Math.atan(Hb/Ha):Ha<0?0<Hb?Math.atan(Hb/Ha)+Math.PI:Math.atan(Hb/Ha)-Math.PI:0},He.angleTo=function(Ha,Hb,Hc){Hgb.subtract(Hb,Ha,He.TEMPVector30),Hgb.normalize(He.TEMPVector30,He.TEMPVector30),Hc.elements[0]=Math.asin(He.TEMPVector30.y),Hc.elements[1]=He.arcTanAngle(-He.TEMPVector30.z,-He.TEMPVector30.x)},He.createFromAxisAngle=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements;Hb*=.5;var Hf=Math.sin(Hb);Hd[0]=Hf*He[0],Hd[1]=Hf*He[1],Hd[2]=Hf*He[2],Hd[3]=Math.cos(Hb)},He.createFromMatrix3x3=function(Ha,Hb){var Hc,Hd=Hb.elements,He=Ha.elements,Hf=He[0]+He[4]+He[8];if(0<Hf)Hc=Math.sqrt(Hf+1),Hd[3]=.5*Hc,Hc=.5/Hc,Hd[0]=(He[5]-He[7])*Hc,Hd[1]=(He[6]-He[2])*Hc,Hd[2]=(He[1]-He[3])*Hc;else{var Hg=0;He[4]>He[0]&&(Hg=1),He[8]>He[3*Hg+Hg]&&(Hg=2);var Hh=(Hg+1)%3,Hi=(Hg+2)%3;Hc=Math.sqrt(He[3*Hg+Hg]-He[3*Hh+Hh]-He[3*Hi+Hi]+1),Hd[Hg]=.5*Hc,Hc=.5/Hc,Hd[3]=(He[3*Hh+Hi]-He[3*Hi+Hh])*Hc,Hd[Hh]=(He[3*Hh+Hg]+He[3*Hg+Hh])*Hc,Hd[Hi]=(He[3*Hi+Hg]+He[3*Hg+Hi])*Hc}},He.createFromMatrix4x4=function(Ha,Hb){var Hc,Hd,He=Ha.elements,Hf=Hb.elements,Hg=He[0]+He[5]+He[10];0<Hg?(Hc=Math.sqrt(Hg+1),Hf[3]=.5*Hc,Hc=.5/Hc,Hf[0]=(He[6]-He[9])*Hc,Hf[1]=(He[8]-He[2])*Hc,Hf[2]=(He[1]-He[4])*Hc):He[0]>=He[5]&&He[0]>=He[10]?(Hd=.5/(Hc=Math.sqrt(1+He[0]-He[5]-He[10])),Hf[0]=.5*Hc,Hf[1]=(He[1]+He[4])*Hd,Hf[2]=(He[2]+He[8])*Hd,Hf[3]=(He[6]-He[9])*Hd):He[5]>He[10]?(Hd=.5/(Hc=Math.sqrt(1+He[5]-He[0]-He[10])),Hf[0]=(He[4]+He[1])*Hd,Hf[1]=.5*Hc,Hf[2]=(He[9]+He[6])*Hd,Hf[3]=(He[8]-He[2])*Hd):(Hd=.5/(Hc=Math.sqrt(1+He[10]-He[0]-He[5])),Hf[0]=(He[8]+He[2])*Hd,Hf[1]=(He[9]+He[6])*Hd,Hf[2]=.5*Hc,Hf[3]=(He[1]-He[4])*Hd)},He.slerp=function(Ha,Hb,Hc,Hd){var He,Hf,Hg,Hh,Hi,Hj=Ha.elements,Hk=Hb.elements,Hl=Hd.elements,Hm=Hj[0],Hn=Hj[1],Ho=Hj[2],Hp=Hj[3],Hq=Hk[0],Hr=Hk[1],Hs=Hk[2],Ht=Hk[3];return(Hf=Hm*Hq+Hn*Hr+Ho*Hs+Hp*Ht)<0&&(Hf=-Hf,Hq=-Hq,Hr=-Hr,Hs=-Hs,Ht=-Ht),Hi=1e-6<1-Hf?(He=Math.acos(Hf),Hg=Math.sin(He),Hh=Math.sin((1-Hc)*He)/Hg,Math.sin(Hc*He)/Hg):(Hh=1-Hc,Hc),Hl[0]=Hh*Hm+Hi*Hq,Hl[1]=Hh*Hn+Hi*Hr,Hl[2]=Hh*Ho+Hi*Hs,Hl[3]=Hh*Hp+Hi*Ht,Hl},He.lerp=function(Ha,Hb,Hc,Hd){var He=Hd.elements,Hf=Ha.elements,Hg=Hb.elements,Hh=Hf[0],Hi=Hf[1],Hj=Hf[2],Hk=Hf[3];He[0]=Hh+Hc*(Hg[0]-Hh),He[1]=Hi+Hc*(Hg[1]-Hi),He[2]=Hj+Hc*(Hg[2]-Hj),He[3]=Hk+Hc*(Hg[3]-Hk)},He.add=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements;Hd[0]=He[0]+Hf[0],Hd[1]=He[1]+Hf[1],Hd[2]=He[2]+Hf[2],Hd[3]=He[3]+Hf[3]},He.dot=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements;return Hc[0]*Hd[0]+Hc[1]*Hd[1]+Hc[2]*Hd[2]+Hc[3]*Hd[3]},He.rotationLookAt=function(Ha,Hb,Hc){He.lookAt(Hgb.ZERO,Ha,Hb,Hc)},He.lookAt=function(Ha,Hb,Hc,Hd){H_a.lookAt(Ha,Hb,Hc,He._tempMatrix3x3),He.rotationMatrix(He._tempMatrix3x3,Hd)},He.invert=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements,He=Ha.lengthSquared();H$a.isZero(He)||(He=1/He,Hd[0]=-Hc[0]*He,Hd[1]=-Hc[1]*He,Hd[2]=-Hc[2]*He,Hd[3]=Hc[3]*He)},He.rotationMatrix=function(Ha,Hb){var Hc=Ha.elements,Hd=Hc[0],He=Hc[1],Hf=Hc[2],Hg=Hc[3],Hh=Hc[4],Hi=Hc[5],Hj=Hc[6],Hk=Hc[7],Hl=Hc[8],Hm=Hb.elements,Hn=NaN,Ho=NaN,Hp=Hd+Hh+Hl;0<Hp?(Hn=Math.sqrt(Hp+1),Hm[3]=.5*Hn,Hn=.5/Hn,Hm[0]=(Hi-Hk)*Hn,Hm[1]=(Hj-Hf)*Hn,Hm[2]=(He-Hg)*Hn):Hh<=Hd&&Hl<=Hd?(Ho=.5/(Hn=Math.sqrt(1+Hd-Hh-Hl)),Hm[0]=.5*Hn,Hm[1]=(He+Hg)*Ho,Hm[2]=(Hf+Hj)*Ho,Hm[3]=(Hi-Hk)*Ho):Hl<Hh?(Ho=.5/(Hn=Math.sqrt(1+Hh-Hd-Hl)),Hm[0]=(Hg+He)*Ho,Hm[1]=.5*Hn,Hm[2]=(Hk+Hi)*Ho,Hm[3]=(Hj-Hf)*Ho):(Ho=.5/(Hn=Math.sqrt(1+Hl-Hd-Hh)),Hm[0]=(Hj+Hf)*Ho,Hm[1]=(Hk+Hi)*Ho,Hm[2]=.5*Hn,Hm[3]=(He-Hg)*Ho)},He.DEFAULT=new He,Hl(He,["TEMPVector30",function(){return this.TEMPVector30=new Hgb},"TEMPVector31",function(){return this.TEMPVector31=new Hgb},"TEMPVector32",function(){return this.TEMPVector32=new Hgb},"TEMPVector33",function(){return this.TEMPVector33=new Hgb},"TEMPMatrix0",function(){return this.TEMPMatrix0=new Hab},"TEMPMatrix1",function(){return this.TEMPMatrix1=new Hab},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new H_a},"NAN",function(){return this.NAN=new He(NaN,NaN,NaN,NaN)}]),He}(),Hdb=function(){function Ha(Ha){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=Ha,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}Hn(Ha,"laya.d3.math.Rand");var Hb=Ha.prototype;return Hb.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},Hb.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},Hb.getSignedFloat=function(){return 2*this.getFloat()-1},Ho(0,Hb,"seed",function(){return this.seeds[0]},function(Ha){this.seeds[0]=Ha,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),Ha.getFloatFromInt=function(Ha){return 1/8388607*(8388607&Ha)},Ha.getByteFromInt=function(Ha){return(8388607&Ha)>>>15},Ha}(),Heb=(function(){function He(Ha){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(Ha instanceof Array)||4!==Ha.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|Ha[0],this._state0L=0|Ha[1],this._state1U=0|Ha[2],this._state1L=0|Ha[3]}Hn(He,"laya.d3.math.RandX");var Ha=He.prototype;Ha.randomint=function(){var Ha=this._state0U,Hb=this._state0L,Hc=this._state1U,Hd=this._state1L,He=(Hd>>>0)+(Hb>>>0),Hf=Hc+Ha+(He/2>>>31)>>>0,Hg=He>>>0,Hh=0,Hi=0;Hh=(Ha^=Hh=Ha<<23|(-512&Hb)>>>9)^(this._state0U=Hc),Hi=(Hb^=Hi=Hb<<23)^(this._state0L=Hd);Hh^=Ha>>>18,Hi^=Hb>>>18|(262143&Ha)<<14;return Hh^=Hc>>>5,Hi^=Hd>>>5|(31&Hc)<<27,this._state1U=Hh,this._state1L=Hi,[Hf,Hg]},Ha.random=function(){var Ha=this.randomint(),Hb=Ha[0],Hc=1023<<20|Hb>>>12,Hd=0|(Ha[1]>>>12|(4095&Hb)<<20);return He._CONVERTION_BUFFER.setUint32(0,Hc,!1),He._CONVERTION_BUFFER.setUint32(4,Hd,!1),Hdb._CONVERTION_BUFFER.getFloat64(0,!1)-1},Hl(He,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new Hdb([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function Ha(Ha,Hb){this.origin=null,this.direction=null,this.origin=Ha,this.direction=Hb}return Hn(Ha,"laya.d3.math.Ray"),Ha}()),Hfb=function(){function Ha(Ha,Hb){this.elements=new Float32Array(2),void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0);var Hc=this.elements;Hc[0]=Ha,Hc[1]=Hb}Hn(Ha,"laya.d3.math.Vector2");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb.fromArray=function(Ha,Hb){void 0===Hb&&(Hb=0),this.elements[0]=Ha[Hb+0],this.elements[1]=Ha[Hb+1]},Hb.cloneTo=function(Ha){var Hb=Ha.elements,Hc=this.elements;Hb[0]=Hc[0],Hb[1]=Hc[1]},Hb.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Hb,"x",function(){return this.elements[0]},function(Ha){this.elements[0]=Ha}),Ho(0,Hb,"y",function(){return this.elements[1]},function(Ha){this.elements[1]=Ha}),Ha.scale=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements;Hd[0]=He[0]*Hb,Hd[1]=He[1]*Hb},Hl(Ha,["ZERO",function(){return this.ZERO=new Ha(0,0)},"ONE",function(){return this.ONE=new Ha(1,1)}]),Ha}(),Hgb=function(){function Hk(Ha,Hb,Hc){this.elements=new Float32Array(3),void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0);var Hd=this.elements;Hd[0]=Ha,Hd[1]=Hb,Hd[2]=Hc}Hn(Hk,"laya.d3.math.Vector3");var Ha=Hk.prototype;return Hv.imps(Ha,{"laya.d3.core.IClone":!0}),Ha.fromArray=function(Ha,Hb){void 0===Hb&&(Hb=0),this.elements[0]=Ha[Hb+0],this.elements[1]=Ha[Hb+1],this.elements[2]=Ha[Hb+2]},Ha.cloneTo=function(Ha){var Hb=Ha.elements,Hc=this.elements;Hb[0]=Hc[0],Hb[1]=Hc[1],Hb[2]=Hc[2]},Ha.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ha.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},Ha.reset=function(Ha,Hb,Hc){this.elements[0]=Ha,this.elements[1]=Hb,this.elements[2]=Hc},Ho(0,Ha,"x",function(){return this.elements[0]},function(Ha){this.elements[0]=Ha}),Ho(0,Ha,"y",function(){return this.elements[1]},function(Ha){this.elements[1]=Ha}),Ho(0,Ha,"z",function(){return this.elements[2]},function(Ha){this.elements[2]=Ha}),Hk.distanceSquared=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements,He=Hc[0]-Hd[0],Hf=Hc[1]-Hd[1],Hg=Hc[2]-Hd[2];return He*He+Hf*Hf+Hg*Hg},Hk.distance=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements,He=Hc[0]-Hd[0],Hf=Hc[1]-Hd[1],Hg=Hc[2]-Hd[2];return Math.sqrt(He*He+Hf*Hf+Hg*Hg)},Hk.min=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements;Hd[0]=Math.min(He[0],Hf[0]),Hd[1]=Math.min(He[1],Hf[1]),Hd[2]=Math.min(He[2],Hf[2])},Hk.max=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements;Hd[0]=Math.max(He[0],Hf[0]),Hd[1]=Math.max(He[1],Hf[1]),Hd[2]=Math.max(He[2],Hf[2])},Hk.transformQuat=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements,Hg=He[0],Hh=He[1],Hi=He[2],Hj=Hf[0],Hk=Hf[1],Hl=Hf[2],Hm=Hf[3],Hn=Hm*Hg+Hk*Hi-Hl*Hh,Ho=Hm*Hh+Hl*Hg-Hj*Hi,Hp=Hm*Hi+Hj*Hh-Hk*Hg,Hq=-Hj*Hg-Hk*Hh-Hl*Hi;Hd[0]=Hn*Hm+Hq*-Hj+Ho*-Hl-Hp*-Hk,Hd[1]=Ho*Hm+Hq*-Hk+Hp*-Hj-Hn*-Hl,Hd[2]=Hp*Hm+Hq*-Hl+Hn*-Hk-Ho*-Hj},Hk.scalarLength=function(Ha){var Hb=Ha.elements,Hc=Hb[0],Hd=Hb[1],He=Hb[2];return Math.sqrt(Hc*Hc+Hd*Hd+He*He)},Hk.scalarLengthSquared=function(Ha){var Hb=Ha.elements,Hc=Hb[0],Hd=Hb[1],He=Hb[2];return Hc*Hc+Hd*Hd+He*He},Hk.normalize=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements,He=Hc[0],Hf=Hc[1],Hg=Hc[2],Hh=He*He+Hf*Hf+Hg*Hg;0<Hh&&(Hh=1/Math.sqrt(Hh),Hd[0]=Hc[0]*Hh,Hd[1]=Hc[1]*Hh,Hd[2]=Hc[2]*Hh)},Hk.multiply=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements;Hd[0]=He[0]*Hf[0],Hd[1]=He[1]*Hf[1],Hd[2]=He[2]*Hf[2]},Hk.scale=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements;Hd[0]=He[0]*Hb,Hd[1]=He[1]*Hb,Hd[2]=He[2]*Hb},Hk.lerp=function(Ha,Hb,Hc,Hd){var He=Hd.elements,Hf=Ha.elements,Hg=Hb.elements,Hh=Hf[0],Hi=Hf[1],Hj=Hf[2];He[0]=Hh+Hc*(Hg[0]-Hh),He[1]=Hi+Hc*(Hg[1]-Hi),He[2]=Hj+Hc*(Hg[2]-Hj)},Hk.transformV3ToV3=function(Ha,Hb,Hc){var Hd=Hk._tempVector4;Hk.transformV3ToV4(Ha,Hb,Hd);var He=Hd.elements,Hf=Hc.elements;Hf[0]=He[0],Hf[1]=He[1],Hf[2]=He[2]},Hk.transformV3ToV4=function(Ha,Hb,Hc){var Hd=Ha.elements,He=Hd[0],Hf=Hd[1],Hg=Hd[2],Hh=Hb.elements,Hi=Hc.elements;Hi[0]=He*Hh[0]+Hf*Hh[4]+Hg*Hh[8]+Hh[12],Hi[1]=He*Hh[1]+Hf*Hh[5]+Hg*Hh[9]+Hh[13],Hi[2]=He*Hh[2]+Hf*Hh[6]+Hg*Hh[10]+Hh[14],Hi[3]=He*Hh[3]+Hf*Hh[7]+Hg*Hh[11]+Hh[15]},Hk.TransformNormal=function(Ha,Hb,Hc){var Hd=Ha.elements,He=Hd[0],Hf=Hd[1],Hg=Hd[2],Hh=Hb.elements,Hi=Hc.elements;Hi[0]=He*Hh[0]+Hf*Hh[4]+Hg*Hh[8],Hi[1]=He*Hh[1]+Hf*Hh[5]+Hg*Hh[9],Hi[2]=He*Hh[2]+Hf*Hh[6]+Hg*Hh[10]},Hk.transformCoordinate=function(Ha,Hb,Hc){var Hd=Hk._tempVector4.elements,He=Ha.elements,Hf=He[0],Hg=He[1],Hh=He[2],Hi=Hb.elements;Hd[0]=Hf*Hi[0]+Hg*Hi[4]+Hh*Hi[8]+Hi[12],Hd[1]=Hf*Hi[1]+Hg*Hi[5]+Hh*Hi[9]+Hi[13],Hd[2]=Hf*Hi[2]+Hg*Hi[6]+Hh*Hi[10]+Hi[14],Hd[3]=1/(Hf*Hi[3]+Hg*Hi[7]+Hh*Hi[11]+Hi[15]);var Hj=Hc.elements;Hj[0]=Hd[0]*Hd[3],Hj[1]=Hd[1]*Hd[3],Hj[2]=Hd[2]*Hd[3]},Hk.Clamp=function(Ha,Hb,Hc,Hd){var He=Ha.elements,Hf=He[0],Hg=He[1],Hh=He[2],Hi=Hb.elements,Hj=Hi[0],Hk=Hi[1],Hl=Hi[2],Hm=Hc.elements,Hn=Hm[0],Ho=Hm[1],Hp=Hm[2],Hq=Hd.elements;Hf=(Hf=Hn<Hf?Hn:Hf)<Hj?Hj:Hf,Hg=(Hg=Ho<Hg?Ho:Hg)<Hk?Hk:Hg,Hh=(Hh=Hp<Hh?Hp:Hh)<Hl?Hl:Hh,Hq[0]=Hf,Hq[1]=Hg,Hq[2]=Hh},Hk.add=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements;Hd[0]=He[0]+Hf[0],Hd[1]=He[1]+Hf[1],Hd[2]=He[2]+Hf[2]},Hk.subtract=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements;Hd[0]=He[0]-Hf[0],Hd[1]=He[1]-Hf[1],Hd[2]=He[2]-Hf[2]},Hk.cross=function(Ha,Hb,Hc){var Hd=Ha.elements,He=Hb.elements,Hf=Hc.elements,Hg=Hd[0],Hh=Hd[1],Hi=Hd[2],Hj=He[0],Hk=He[1],Hl=He[2];Hf[0]=Hh*Hl-Hi*Hk,Hf[1]=Hi*Hj-Hg*Hl,Hf[2]=Hg*Hk-Hh*Hj},Hk.dot=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements;return Hc[0]*Hd[0]+Hc[1]*Hd[1]+Hc[2]*Hd[2]},Hk.equals=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements;return H$a.nearEqual(Math.abs(Hc[0]),Math.abs(Hd[0]))&&H$a.nearEqual(Math.abs(Hc[1]),Math.abs(Hd[1]))&&H$a.nearEqual(Math.abs(Hc[2]),Math.abs(Hd[2]))},Hk.ZERO=new Hk(0,0,0),Hk.ONE=new Hk(1,1,1),Hk.NegativeUnitX=new Hk(-1,0,0),Hk.UnitX=new Hk(1,0,0),Hk.UnitY=new Hk(0,1,0),Hk.UnitZ=new Hk(0,0,1),Hk.ForwardRH=new Hk(0,0,-1),Hk.ForwardLH=new Hk(0,0,1),Hk.Up=new Hk(0,1,0),Hk.NAN=new Hk(NaN,NaN,NaN),Hl(Hk,["_tempVector4",function(){return this._tempVector4=new Hhb}]),Hk}(),Hhb=function(){function Ha(Ha,Hb,Hc,Hd){this.elements=new Float32Array(4),void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=0);var He=this.elements;He[0]=Ha,He[1]=Hb,He[2]=Hc,He[3]=Hd}Hn(Ha,"laya.d3.math.Vector4");var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb.fromArray=function(Ha,Hb){void 0===Hb&&(Hb=0),this.elements[0]=Ha[Hb+0],this.elements[1]=Ha[Hb+1],this.elements[2]=Ha[Hb+2],this.elements[3]=Ha[Hb+3]},Hb.cloneTo=function(Ha){var Hb=Ha.elements,Hc=this.elements;Hb[0]=Hc[0],Hb[1]=Hc[1],Hb[2]=Hc[2],Hb[3]=Hc[3]},Hb.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Hb.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},Hb.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},Ho(0,Hb,"x",function(){return this.elements[0]},function(Ha){this.elements[0]=Ha}),Ho(0,Hb,"y",function(){return this.elements[1]},function(Ha){this.elements[1]=Ha}),Ho(0,Hb,"z",function(){return this.elements[2]},function(Ha){this.elements[2]=Ha}),Ho(0,Hb,"w",function(){return this.elements[3]},function(Ha){this.elements[3]=Ha}),Ha.lerp=function(Ha,Hb,Hc,Hd){var He=Hd.elements,Hf=Ha.elements,Hg=Hb.elements,Hh=Hf[0],Hi=Hf[1],Hj=Hf[2],Hk=Hf[3];He[0]=Hh+Hc*(Hg[0]-Hh),He[1]=Hi+Hc*(Hg[1]-Hi),He[2]=Hj+Hc*(Hg[2]-Hj),He[3]=Hk+Hc*(Hg[3]-Hk)},Ha.transformByM4x4=function(Ha,Hb,Hc){var Hd=Ha.elements,He=Hd[0],Hf=Hd[1],Hg=Hd[2],Hh=Hd[3],Hi=Hb.elements,Hj=Hc.elements;Hj[0]=He*Hi[0]+Hf*Hi[4]+Hg*Hi[8]+Hh*Hi[12],Hj[1]=He*Hi[1]+Hf*Hi[5]+Hg*Hi[9]+Hh*Hi[13],Hj[2]=He*Hi[2]+Hf*Hi[6]+Hg*Hi[10]+Hh*Hi[14],Hj[3]=He*Hi[3]+Hf*Hi[7]+Hg*Hi[11]+Hh*Hi[15]},Ha.equals=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements;return H$a.nearEqual(Math.abs(Hc[0]),Math.abs(Hd[0]))&&H$a.nearEqual(Math.abs(Hc[1]),Math.abs(Hd[1]))&&H$a.nearEqual(Math.abs(Hc[2]),Math.abs(Hd[2]))&&H$a.nearEqual(Math.abs(Hc[3]),Math.abs(Hd[3]))},Ha.normalize=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements,He=Ha.length();0<He&&(Hd[0]=Hc[0]*He,Hd[1]=Hc[1]*He,Hd[2]=Hc[2]*He,Hd[3]=Hc[3]*He)},Ha.add=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements;Hd[0]=He[0]+Hf[0],Hd[1]=He[1]+Hf[1],Hd[2]=He[2]+Hf[2],Hd[3]=He[3]+Hf[3]},Ha.subtract=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements;Hd[0]=He[0]-Hf[0],Hd[1]=He[1]-Hf[1],Hd[2]=He[2]-Hf[2],Hd[3]=He[3]-Hf[3]},Ha.multiply=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements;Hd[0]=He[0]*Hf[0],Hd[1]=He[1]*Hf[1],Hd[2]=He[2]*Hf[2],Hd[3]=He[3]*Hf[3]},Ha.scale=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements;Hd[0]=He[0]*Hb,Hd[1]=He[1]*Hb,Hd[2]=He[2]*Hb,Hd[3]=He[3]*Hb},Ha.Clamp=function(Ha,Hb,Hc,Hd){var He=Ha.elements,Hf=He[0],Hg=He[1],Hh=He[2],Hi=He[3],Hj=Hb.elements,Hk=Hj[0],Hl=Hj[1],Hm=Hj[2],Hn=Hj[3],Ho=Hc.elements,Hp=Ho[0],Hq=Ho[1],Hr=Ho[2],Hs=Ho[3],Ht=Hd.elements;Hf=(Hf=Hp<Hf?Hp:Hf)<Hk?Hk:Hf,Hg=(Hg=Hq<Hg?Hq:Hg)<Hl?Hl:Hg,Hh=(Hh=Hr<Hh?Hr:Hh)<Hm?Hm:Hh,Hi=(Hi=Hs<Hi?Hs:Hi)<Hn?Hn:Hi,Ht[0]=Hf,Ht[1]=Hg,Ht[2]=Hh,Ht[3]=Hi},Ha.distanceSquared=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements,He=Hc[0]-Hd[0],Hf=Hc[1]-Hd[1],Hg=Hc[2]-Hd[2],Hh=Hc[3]-Hd[3];return He*He+Hf*Hf+Hg*Hg+Hh*Hh},Ha.distance=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements,He=Hc[0]-Hd[0],Hf=Hc[1]-Hd[1],Hg=Hc[2]-Hd[2],Hh=Hc[3]-Hd[3];return Math.sqrt(He*He+Hf*Hf+Hg*Hg+Hh*Hh)},Ha.dot=function(Ha,Hb){var Hc=Ha.elements,Hd=Hb.elements;return Hc[0]*Hd[0]+Hc[1]*Hd[1]+Hc[2]*Hd[2]+Hc[3]*Hd[3]},Ha.min=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements;Hd[0]=Math.min(He[0],Hf[0]),Hd[1]=Math.min(He[1],Hf[1]),Hd[2]=Math.min(He[2],Hf[2]),Hd[3]=Math.min(He[3],Hf[3])},Ha.max=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb.elements;Hd[0]=Math.max(He[0],Hf[0]),Hd[1]=Math.max(He[1],Hf[1]),Hd[2]=Math.max(He[2],Hf[2]),Hd[3]=Math.max(He[3],Hf[3])},Hl(Ha,["ZERO",function(){return this.ZERO=new Ha},"ONE",function(){return this.ONE=new Ha(1,1,1,1)},"UnitX",function(){return this.UnitX=new Ha(1,0,0,0)},"UnitY",function(){return this.UnitY=new Ha(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new Ha(0,0,1,0)},"UnitW",function(){return this.UnitW=new Ha(0,0,0,1)}]),Ha}(),Hib=function(){function Hf(Ha,Hb,Hc,Hd){this.minDepth=0,this.maxDepth=1,this.x=Ha,this.y=Hb,this.width=Hc,this.height=Hd}Hn(Hf,"laya.d3.math.Viewport");var Ha=Hf.prototype;return Ha.project=function(Ha,Hb,Hc){Hgb.transformV3ToV3(Ha,Hb,Hc);var Hd=Ha.elements,He=Hb.elements,Hf=Hc.elements,Hg=Hd[0]*He[3]+Hd[1]*He[7]+Hd[2]*He[11]+He[15];1!==Hg&&(Hf[0]=Hf[0]/Hg,Hf[1]=Hf[1]/Hg,Hf[2]=Hf[2]/Hg),Hf[0]=.5*(Hf[0]+1)*this.width+this.x,Hf[1]=.5*(1-Hf[1])*this.height+this.y,Hf[2]=Hf[2]*(this.maxDepth-this.minDepth)+this.minDepth},Ha.unprojectFromMat=function(Ha,Hb,Hc){var Hd=Ha.elements,He=Hb.elements,Hf=Hc.elements;Hf[0]=(Hd[0]-this.x)/this.width*2-1,Hf[1]=-((Hd[1]-this.y)/this.height*2-1);var Hg=(this.maxDepth-this.minDepth)/2;Hf[2]=(Hd[2]-this.minDepth-Hg)/Hg;var Hh=Hf[0]*He[3]+Hf[1]*He[7]+Hf[2]*He[11]+He[15];Hgb.transformV3ToV3(Hc,Hb,Hc),1!==Hh&&(Hf[0]=Hf[0]/Hh,Hf[1]=Hf[1]/Hh,Hf[2]=Hf[2]/Hh)},Ha.unprojectFromWVP=function(Ha,Hb,Hc,Hd,He){Hab.multiply(Hb,Hc,Hf._tempMatrix4x4),Hd&&Hab.multiply(Hf._tempMatrix4x4,Hd,Hf._tempMatrix4x4),Hf._tempMatrix4x4.invert(Hf._tempMatrix4x4),this.unprojectFromMat(Ha,Hf._tempMatrix4x4,He)},Hl(Hf,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new Hab}]),Hf}(),Hjb=function(){function HC(Ha){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=Ha,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}Hn(HC,"laya.d3.resource.models.SubMesh");var Ha=HC.prototype;return Hv.imps(Ha,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),Ha._getVertexBuffer=function(Ha){return void 0===Ha&&(Ha=0),0===Ha?this._vertexBuffer:null},Ha._getIndexBuffer=function(){return this._indexBuffer},Ha._getStaticBatchBakedVertexs=function(Ha,Hb){var Hc,Hd,He=this._vertexBuffer,Hf=He.vertexDeclaration,Hg=Hf.getVertexElementByUsage(0).offset/4,Hh=Hf.getVertexElementByUsage(3).offset/4,Hi=Hb.meshRender.lightmapScaleOffset,Hj=0,Hk=0,Hl=0,Hm=0,Hn=0,Ho=0;if(Hi)if(Hd=Hf.getVertexElementByUsage(15))Hl=Hf.vertexStride/4,Hc=0<this._vertexCount?He.getData().slice(this._vertexStart*Hl,(this._vertexStart+this._vertexCount)*Hl):He.getData().slice(),Hm=Hd.offset/4;else{Hl=(Ho=Hf.vertexStride/4)+2,Hc=this._vertexCount?new Float32Array(this._vertexCount*(He.vertexDeclaration.vertexStride/4+2)):new Float32Array(He.vertexCount*(He.vertexDeclaration.vertexStride/4+2)),Hm=(Hn=Hf.getVertexElementByUsage(2).offset/4)+2;var Hp=He.getData();for(Hj=0,Hk=Hp.length/Ho;Hj<Hk;Hj++){var Hq=0;Hq=0<this._vertexCount?(this._vertexStart+Hj)*Ho:Hj*Ho;var Hr=Hj*Hl,Hs=0;for(Hs=0;Hs<Hm;Hs++)Hc[Hr+Hs]=Hp[Hq+Hs];for(Hs=Hm;Hs<Ho;Hs++)Hc[Hr+Hs+2]=Hp[Hq+Hs]}}else Hl=Hf.vertexStride/4,Hc=this._vertexCount?He.getData().slice(this._vertexStart*Hl,(this._vertexStart+this._vertexCount)*Hl):He.getData().slice();if(Ha){var Ht=Ha.worldMatrix,Hu=HC._tempMatrix4x40;Ht.invert(Hu);var Hv=HC._tempMatrix4x41,Hw=Hb.transform.worldMatrix;Hab.multiply(Hu,Hw,Hv)}else Hv=Hb.transform.worldMatrix;var Hx=HC._tempQuaternion0;for(Hv.decomposeTransRotScale(HC._tempVector30,Hx,HC._tempVector31),Hj=0,Hk=Hc.length/Hl;Hj<Hk;Hj++){var Hy=Hj*Hl+Hg,Hz=Hj*Hl+Hh;if(Hqb.transformVector3ArrayToVector3ArrayCoordinate(Hc,Hy,Hv,Hc,Hy),Hqb.transformVector3ArrayByQuat(Hc,Hz,Hx,Hc,Hz),Hi){var HA=Hj*Hl+Hm;if(Hd)Hqb.transformLightingMapTexcoordByUV1Array(Hc,HA,Hi,Hc,HA);else{var HB=Hj*Ho+Hn;Hqb.transformLightingMapTexcoordByUV0Array(Hp,HB,Hi,Hc,HA)}}}return Hc},Ha._getVertexBuffers=function(){return null},Ha._beforeRender=function(Ha){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Ha._render=function(Ha){var Hb,Hc=0,Hd=Ha.renderElement;if(1<this._indexCount){var He=this._boneIndicesList.length;if(1<He){for(var Hf=0;Hf<He;Hf++)(Hb=Hd._skinAnimationDatas||this._skinAnimationDatas)&&(Hd._shaderValue.setValue(0,Hb[Hf]),Ha._shader.uploadRenderElementUniforms(Hd._shaderValue.data)),HD.mainContext.drawElements(4,this._subIndexBufferCount[Hf],5123,2*this._subIndexBufferStart[Hf]);Hy.drawCall+=He}else(Hb=Hd._skinAnimationDatas||this._skinAnimationDatas)&&(Hd._shaderValue.setValue(0,Hb[0]),Ha._shader.uploadRenderElementUniforms(Hd._shaderValue.data)),HD.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),Hy.drawCall++;Hc=this._indexCount}else Hc=this._indexBuffer.indexCount,(Hb=Hd._skinAnimationDatas||this._skinAnimationDatas)&&(Hd._shaderValue.setValue(0,Hb[0]),Ha._shader.uploadRenderElementUniforms(Hd._shaderValue.data)),HD.mainContext.drawElements(4,Hc,5123,0),Hy.drawCall++;Hy.trianglesFaces+=Hc/3},Ha.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},Ha.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},Ho(0,Ha,"_vertexBufferCount",function(){return 1}),Ho(0,Ha,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Hl(HC,["_tempVector30",function(){return this._tempVector30=new Hgb},"_tempVector31",function(){return this._tempVector31=new Hgb},"_tempQuaternion0",function(){return this._tempQuaternion0=new Hcb},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new Hab},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new Hab}]),HC}(),Hkb=function(){function Ha(Ha){this.defineCounter=0,this.defines=null,Ha?(this.defineCounter=Ha.defineCounter,this.defines=Ha.defines.slice()):(this.defineCounter=0,this.defines=[])}return Hn(Ha,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),Ha.prototype.registerDefine=function(Ha){var Hb=Math.pow(2,this.defineCounter++);return this.defines[Hb]=Ha,Hb},Ha}(),Hlb=function(){function Ha(){}return Hn(Ha,"laya.d3.shader.ShaderInit3D"),Ha.__init__=function(){var Ha,Hb;Hyb._globalRegDefine("HIGHPRECISION",Hyb.SHADERDEFINE_HIGHPRECISION),Hyb._globalRegDefine("FOG",Hyb.SHADERDEFINE_FOG),Hyb._globalRegDefine("DIRECTIONLIGHT",Hyb.SHADERDEFINE_DIRECTIONLIGHT),Hyb._globalRegDefine("POINTLIGHT",Hyb.SHADERDEFINE_POINTLIGHT),Hyb._globalRegDefine("SPOTLIGHT",Hyb.SHADERDEFINE_SPOTLIGHT),Hyb._globalRegDefine("UV",Hyb.SHADERDEFINE_UV0),Hyb._globalRegDefine("COLOR",Hyb.SHADERDEFINE_COLOR),Hyb._globalRegDefine("UV1",Hyb.SHADERDEFINE_UV1),Hyb._globalRegDefine("CASTSHADOW",Hnb.SHADERDEFINE_CAST_SHADOW),Hyb._globalRegDefine("SHADOWMAP_PSSM1",Hnb.SHADERDEFINE_SHADOW_PSSM1),Hyb._globalRegDefine("SHADOWMAP_PSSM2",Hnb.SHADERDEFINE_SHADOW_PSSM2),Hyb._globalRegDefine("SHADOWMAP_PSSM3",Hnb.SHADERDEFINE_SHADOW_PSSM3),Hyb._globalRegDefine("SHADOWMAP_PCF_NO",Hnb.SHADERDEFINE_SHADOW_PCF_NO),Hyb._globalRegDefine("SHADOWMAP_PCF1",Hnb.SHADERDEFINE_SHADOW_PCF1),Hyb._globalRegDefine("SHADOWMAP_PCF2",Hnb.SHADERDEFINE_SHADOW_PCF2),Hyb._globalRegDefine("SHADOWMAP_PCF3",Hnb.SHADERDEFINE_SHADOW_PCF3),Hyb._globalRegDefine("DEPTHFOG",Hyb.SAHDERDEFINE_DEPTHFOG),HJb.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),HJb.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),Ha={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},Hb={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var Hc=HJb.nameKey.add("SIMPLE");shaderCompile=Hyb.add(Hc,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',Ha,Hb),HKb.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),HKb.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),HKb.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),HKb.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),HKb.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),HKb.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),HKb.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),HKb.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),HKb.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},Ha}(),Hmb=function(){function Ha(){this._data=null,this._data=[]}Hn(Ha,"laya.d3.shader.ValusArray");var Hb=Ha.prototype;return Hb.setValue=function(Ha,Hb){this._data[Ha]=Hb},Ho(0,Hb,"data",function(){return this._data}),Ha}(),Hnb=function(){function Ha(){}return Ha.SHADERDEFINE_RECEIVE_SHADOW=1,Ha.SHADERDEFINE_CAST_SHADOW=512,Ha.SHADERDEFINE_SHADOW_PSSM1=1024,Ha.SHADERDEFINE_SHADOW_PSSM2=2048,Ha.SHADERDEFINE_SHADOW_PSSM3=4096,Ha.SHADERDEFINE_SHADOW_PCF_NO=8192,Ha.SHADERDEFINE_SHADOW_PCF1=16384,Ha.SHADERDEFINE_SHADOW_PCF2=32768,Ha.SHADERDEFINE_SHADOW_PCF3=65536,Ha.MAX_PSSM_COUNT=3,Ha}(),Hob=function(){function HV(){}return Hn(HV,"laya.d3.utils.Picker"),HV.calculateCursorRay=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=Ha.elements[0],Hh=Ha.elements[1],Hi=HV._tempVector30,Hj=Hi.elements;Hj[0]=Hg,Hj[1]=Hh,Hj[2]=Hb.minDepth;var Hk=HV._tempVector31,Hl=Hk.elements;Hl[0]=Hg,Hl[1]=Hh,Hl[2]=Hb.maxDepth;var Hm=Hf.origin,Hn=HV._tempVector32;Hb.unprojectFromWVP(Hi,Hc,Hd,He,Hm),Hb.unprojectFromWVP(Hk,Hc,Hd,He,Hn);var Ho=Hf.direction.elements;Ho[0]=Hn.x-Hm.x,Ho[1]=Hn.y-Hm.y,Ho[2]=Hn.z-Hm.z,Hgb.normalize(Hf.direction,Hf.direction)},HV.rayIntersectsPositionsAndIndices=function(Ha,Hb,Hc,Hd,He){for(var Hf=Hc.vertexStride/4,Hg=Hc.getVertexElementByUsage(0).offset/4,Hh=Number.MAX_VALUE,Hi=-1,Hj=-1,Hk=-1,Hl=0;Hl<Hd.length;Hl+=3){var Hm=HV._tempVector35,Hn=Hm.elements,Ho=Hd[Hl]*Hf,Hp=Ho+Hg;Hn[0]=Hb[Hp],Hn[1]=Hb[1+Hp],Hn[2]=Hb[2+Hp];var Hq=HV._tempVector36,Hr=Hq.elements,Hs=Hd[Hl+1]*Hf,Ht=Hs+Hg;Hr[0]=Hb[Ht],Hr[1]=Hb[1+Ht],Hr[2]=Hb[2+Ht];var Hu=HV._tempVector37,Hv=Hu.elements,Hw=Hd[Hl+2]*Hf,Hx=Hw+Hg;Hv[0]=Hb[Hx],Hv[1]=Hb[1+Hx],Hv[2]=Hb[2+Hx];var Hy=laya.d3.utils.Picker.rayIntersectsTriangle(Ha,Hm,Hq,Hu);!isNaN(Hy)&&Hy<Hh&&(Hh=Hy,Hi=Ho,Hj=Hs,Hk=Hw)}if(Hh===Number.MAX_VALUE)return He.position.toDefault(),He.distance=Number.MAX_VALUE,He.trianglePositions[0].toDefault(),He.trianglePositions[1].toDefault(),He.trianglePositions[2].toDefault(),He.triangleNormals[0].toDefault(),He.triangleNormals[1].toDefault(),He.triangleNormals[2].toDefault(),!1;He.distance=Hh,Hgb.scale(Ha.direction,Hh,He.position),Hgb.add(Ha.origin,He.position,He.position);var Hz=He.trianglePositions,HA=Hz[0],HB=Hz[1],HC=Hz[2],HD=HA.elements,HE=HB.elements,HF=HC.elements,HG=Hi+Hg;HD[0]=Hb[HG],HD[1]=Hb[HG+1],HD[2]=Hb[HG+2];var HH=Hj+Hg;HE[0]=Hb[HH],HE[1]=Hb[HH+1],HE[2]=Hb[HH+2];var HI=Hk+Hg;HF[0]=Hb[HI],HF[1]=Hb[HI+1],HF[2]=Hb[HI+2];var HJ=Hc.getVertexElementByUsage(3);if(HJ){var HK=HJ.offset/4,HL=He.triangleNormals,HM=HL[0],HN=HL[1],HO=HL[2],HP=HM.elements,HQ=HN.elements,HR=HO.elements,HS=Hi+HK;HP[0]=Hb[HS],HP[1]=Hb[HS+1],HP[2]=Hb[HS+2];var HT=Hj+HK;HQ[0]=Hb[HT],HQ[1]=Hb[HT+1],HQ[2]=Hb[HT+2];var HU=Hk+HK;HR[0]=Hb[HU],HR[1]=Hb[HU+1],HR[2]=Hb[HU+2]}return!0},HV.rayIntersectsTriangle=function(Ha,Hb,Hc,Hd){var He=HV._tempVector30,Hf=HV._tempVector31;Hgb.subtract(Hc,Hb,He),Hgb.subtract(Hd,Hb,Hf);var Hg,Hh=HV._tempVector32;if(Hgb.cross(Ha.direction,Hf,Hh),(Hg=Hgb.dot(He,Hh))>-Number.MIN_VALUE&&Hg<Number.MIN_VALUE)return Number.NaN;var Hi,Hj=1/Hg,Hk=HV._tempVector33;if(Hgb.subtract(Ha.origin,Hb,Hk),Hi=Hgb.dot(Hk,Hh),(Hi*=Hj)<0||1<Hi)return Number.NaN;var Hl,Hm,Hn=HV._tempVector34;return Hgb.cross(Hk,He,Hn),Hl=Hgb.dot(Ha.direction,Hn),(Hl*=Hj)<0||1<Hi+Hl?Number.NaN:(Hm=Hgb.dot(Hf,Hn),(Hm*=Hj)<0?Number.NaN:Hm)},Hl(HV,["_tempVector30",function(){return this._tempVector30=new Hgb},"_tempVector31",function(){return this._tempVector31=new Hgb},"_tempVector32",function(){return this._tempVector32=new Hgb},"_tempVector33",function(){return this._tempVector33=new Hgb},"_tempVector34",function(){return this._tempVector34=new Hgb},"_tempVector35",function(){return this._tempVector35=new Hgb},"_tempVector36",function(){return this._tempVector36=new Hgb},"_tempVector37",function(){return this._tempVector37=new Hgb}]),HV}(),Hpb=(function(){function Ha(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new Hgb,new Hgb,new Hgb],this.trianglePositions.length=3,this.triangleNormals=[new Hgb,new Hgb,new Hgb],this.triangleNormals.length=3,this.position=new Hgb}Hn(Ha,"laya.d3.utils.RaycastHit"),Ha.prototype.cloneTo=function(Ha){Ha.distance=this.distance,this.trianglePositions[0].cloneTo(Ha.trianglePositions[0]),this.trianglePositions[1].cloneTo(Ha.trianglePositions[1]),this.trianglePositions[2].cloneTo(Ha.trianglePositions[2]),this.triangleNormals[0].cloneTo(Ha.triangleNormals[0]),this.triangleNormals[1].cloneTo(Ha.triangleNormals[1]),this.triangleNormals[2].cloneTo(Ha.triangleNormals[2]),this.position.cloneTo(Ha.position),Ha.sprite3D=this.sprite3D}}(),function(){function Ha(Ha,Hb){this._width=0,this._height=0,this._width=Ha,this._height=Hb}Hn(Ha,"laya.d3.utils.Size");var Hb=Ha.prototype;return Ho(0,Hb,"width",function(){return-1===this._width?HW.clientWidth:this._width}),Ho(0,Hb,"height",function(){return-1===this._height?HW.clientHeight:this._height}),Ho(1,Ha,"fullScreen",function(){return new Ha(-1,-1)}),Ha}()),Hqb=function(){function HG(){}return Hn(HG,"laya.d3.utils.Utils3D"),HG._rotationTransformScaleSkinAnimation=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hl){var Hm,Hn,Ho,Hp,Hq,Hr=HG._tempArray16_0,Hs=HG._tempArray16_1,Ht=HG._tempArray16_2,Hu=Hd+Hd,Hv=He+He,Hw=Hf+Hf,Hx=Hd*Hu,Hy=He*Hu,Hz=He*Hv,HA=Hf*Hu,HB=Hf*Hv,HC=Hf*Hw,HD=Hg*Hu,HE=Hg*Hv,HF=Hg*Hw;for(Hr[15]=1,Hr[0]=1-Hz-HC,Hr[1]=Hy+HF,Hr[2]=HA-HE,Hr[4]=Hy-HF,Hr[5]=1-Hx-HC,Hr[6]=HB+HD,Hr[8]=HA+HE,Hr[9]=HB-HD,Hr[10]=1-Hx-Hz,Hs[15]=1,Hs[0]=Hh,Hs[5]=Hi,Hs[10]=Hj,Hm=0;Hm<4;Hm++)Hn=Hr[Hm],Ho=Hr[Hm+4],Hp=Hr[Hm+8],Hq=Hr[Hm+12],Ht[Hm]=Hn,Ht[Hm+4]=Ho,Ht[Hm+8]=Hp,Ht[Hm+12]=Hn*Ha+Ho*Hb+Hp*Hc+Hq;for(Hm=0;Hm<4;Hm++)Hn=Ht[Hm],Ho=Ht[Hm+4],Hp=Ht[Hm+8],Hq=Ht[Hm+12],Hk[Hm+Hl]=Hn*Hs[0]+Ho*Hs[1]+Hp*Hs[2]+Hq*Hs[3],Hk[Hm+Hl+4]=Hn*Hs[4]+Ho*Hs[5]+Hp*Hs[6]+Hq*Hs[7],Hk[Hm+Hl+8]=Hn*Hs[8]+Ho*Hs[9]+Hp*Hs[10]+Hq*Hs[11],Hk[Hm+Hl+12]=Hn*Hs[12]+Ho*Hs[13]+Hp*Hs[14]+Hq*Hs[15]},HG._createNodeByJson=function(Ha,Hb,Hc,Hd){if(!Hc)switch(Hb.type){case"Sprite3D":Hc=new HIb;break;case"MeshSprite3D":Hc=new HVb;break;case"SkinnedMeshSprite3D":Hc=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":Hc=new ShuriKenParticle3D;break;case"TrailSprite3D":Hc=new TrailSprite3D;break;case"Terrain":Hc=new Terrain;break;case"Camera":Hc=new HUb;break;case"DirectionLight":Hc=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var He=Hb.props;if(He)for(var Hf in He)Hc[Hf]=He[Hf];var Hg=Hb.customProps;Hg&&(Hc instanceof laya.d3.core.Sprite3D?(Hc._parseBaseCustomProps(Hg),Hc._parseCustomProps(Ha,Hd,Hg,Hb),Hc._parseCustomComponent(Ha,Hd,Hb.components)):Hc._parseCustomProps(Ha,Hd,Hg,Hb));var Hh=Hb.child;if(Hh)for(var Hi=0,Hj=Hh.length;Hi<Hj;Hi++){var Hk=HG._createNodeByJson(Ha,Hh[Hi],null,Hd);Hc.addChild(Hk)}return Hc},HG._computeBoneAndAnimationDatasByBindPoseMatrxix=function(Ha,Hb,Hc,Hd,He,Hf){var Hg,Hh,Hi=0,Hj=0,Hk=Ha.length;for(Hg=0;Hg<Hk;Hi+=Ha[Hg].keyframeWidth,Hj+=16,Hg++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(Hb[Hi+0],Hb[Hi+1],Hb[Hi+2],Hb[Hi+3],Hb[Hi+4],Hb[Hi+5],Hb[Hi+6],Hb[Hi+7],Hb[Hi+8],Hb[Hi+9],Hd,Hj),0!=Hg&&(Hh=16*Ha[Hg].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(Hd,Hh,Hd,Hj,Hd,Hj));var Hl=Hc.length;for(Hg=0;Hg<Hl;Hg++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Hd,16*Hf[Hg],Hc[Hg],He,16*Hg)},HG._computeAnimationDatasByArrayAndMatrixFast=function(Ha,Hb,Hc,Hd){for(var He=0,Hf=Ha.length;He<Hf;He++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Hb,16*Hd[He],Ha[He],Hc,16*He)},HG._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(Ha,Hb,Hc,Hd,He){var Hf,Hg,Hh=0,Hi=0,Hj=Ha.length;for(Hf=0;Hf<Hj;Hh+=Ha[Hf].keyframeWidth,Hi+=16,Hf++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(Hb[Hh+7],Hb[Hh+8],Hb[Hh+9],Hb[Hh+3],Hb[Hh+4],Hb[Hh+5],Hb[Hh+6],Hb[Hh+0],Hb[Hh+1],Hb[Hh+2],Hd,Hi),0!=Hf&&(Hg=16*Ha[Hf].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(Hd,Hg,Hd,Hi,Hd,Hi));var Hk=Hc.length;for(Hf=0;Hf<Hk;Hf++){var Hl=16*Hf;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Hd,Hl,Hc[Hf],He,Hl)}},HG._computeAnimationDatasByArrayAndMatrixFastOld=function(Ha,Hb,Hc){for(var Hd=Ha.length,He=0;He<Hd;He++){var Hf=16*He;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Hb,Hf,Ha[He],Hc,Hf)}},HG._computeRootAnimationData=function(Ha,Hb,Hc){for(var Hd=0,He=0,Hf=0,Hg=Ha.length;Hd<Hg;He+=Ha[Hd].keyframeWidth,Hf+=16,Hd++)laya.d3.utils.Utils3D.createAffineTransformationArray(Hb[He+0],Hb[He+1],Hb[He+2],Hb[He+3],Hb[He+4],Hb[He+5],Hb[He+6],Hb[He+7],Hb[He+8],Hb[He+9],Hc,Hf)},HG.transformVector3ArrayByQuat=function(Ha,Hb,Hc,Hd,He){var Hf=Hc.elements,Hg=Ha[Hb],Hh=Ha[Hb+1],Hi=Ha[Hb+2],Hj=Hf[0],Hk=Hf[1],Hl=Hf[2],Hm=Hf[3],Hn=Hm*Hg+Hk*Hi-Hl*Hh,Ho=Hm*Hh+Hl*Hg-Hj*Hi,Hp=Hm*Hi+Hj*Hh-Hk*Hg,Hq=-Hj*Hg-Hk*Hh-Hl*Hi;Hd[He]=Hn*Hm+Hq*-Hj+Ho*-Hl-Hp*-Hk,Hd[He+1]=Ho*Hm+Hq*-Hk+Hp*-Hj-Hn*-Hl,Hd[He+2]=Hp*Hm+Hq*-Hl+Hn*-Hk-Ho*-Hj},HG.mulMatrixByArray=function(Ha,Hb,Hc,Hd,He,Hf){var Hg,Hh,Hi,Hj,Hk;if(He===Hc){for(Hc=HG._tempArray16_3,Hg=0;Hg<16;++Hg)Hc[Hg]=He[Hf+Hg];Hd=0}for(Hg=0;Hg<4;Hg++)Hh=Ha[Hb+Hg],Hi=Ha[Hb+Hg+4],Hj=Ha[Hb+Hg+8],Hk=Ha[Hb+Hg+12],He[Hf+Hg]=Hh*Hc[Hd+0]+Hi*Hc[Hd+1]+Hj*Hc[Hd+2]+Hk*Hc[Hd+3],He[Hf+Hg+4]=Hh*Hc[Hd+4]+Hi*Hc[Hd+5]+Hj*Hc[Hd+6]+Hk*Hc[Hd+7],He[Hf+Hg+8]=Hh*Hc[Hd+8]+Hi*Hc[Hd+9]+Hj*Hc[Hd+10]+Hk*Hc[Hd+11],He[Hf+Hg+12]=Hh*Hc[Hd+12]+Hi*Hc[Hd+13]+Hj*Hc[Hd+14]+Hk*Hc[Hd+15]},HG.mulMatrixByArrayFast=function(Ha,Hb,Hc,Hd,He,Hf){var Hg,Hh,Hi,Hj,Hk;for(Hg=0;Hg<4;Hg++)Hh=Ha[Hb+Hg],Hi=Ha[Hb+Hg+4],Hj=Ha[Hb+Hg+8],Hk=Ha[Hb+Hg+12],He[Hf+Hg]=Hh*Hc[Hd+0]+Hi*Hc[Hd+1]+Hj*Hc[Hd+2]+Hk*Hc[Hd+3],He[Hf+Hg+4]=Hh*Hc[Hd+4]+Hi*Hc[Hd+5]+Hj*Hc[Hd+6]+Hk*Hc[Hd+7],He[Hf+Hg+8]=Hh*Hc[Hd+8]+Hi*Hc[Hd+9]+Hj*Hc[Hd+10]+Hk*Hc[Hd+11],He[Hf+Hg+12]=Hh*Hc[Hd+12]+Hi*Hc[Hd+13]+Hj*Hc[Hd+14]+Hk*Hc[Hd+15]},HG.mulMatrixByArrayAndMatrixFast=function(Ha,Hb,Hc,Hd,He){var Hf,Hg,Hh,Hi,Hj,Hk=Hc.elements,Hl=Hk[0],Hm=Hk[1],Hn=Hk[2],Ho=Hk[3],Hp=Hk[4],Hq=Hk[5],Hr=Hk[6],Hs=Hk[7],Ht=Hk[8],Hu=Hk[9],Hv=Hk[10],Hw=Hk[11],Hx=Hk[12],Hy=Hk[13],Hz=Hk[14],HA=Hk[15],HB=Hb,HC=Hb+4,HD=Hb+8,HE=Hb+12,HF=He,HG=He+4,HH=He+8,HI=He+12;for(Hf=0;Hf<4;Hf++)Hg=Ha[HB+Hf],Hh=Ha[HC+Hf],Hi=Ha[HD+Hf],Hj=Ha[HE+Hf],Hd[HF+Hf]=Hg*Hl+Hh*Hm+Hi*Hn+Hj*Ho,Hd[HG+Hf]=Hg*Hp+Hh*Hq+Hi*Hr+Hj*Hs,Hd[HH+Hf]=Hg*Ht+Hh*Hu+Hi*Hv+Hj*Hw,Hd[HI+Hf]=Hg*Hx+Hh*Hy+Hi*Hz+Hj*HA},HG.createAffineTransformationArray=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hl){var Hm=Hd+Hd,Hn=He+He,Ho=Hf+Hf,Hp=Hd*Hm,Hq=Hd*Hn,Hr=Hd*Ho,Hs=He*Hn,Ht=He*Ho,Hu=Hf*Ho,Hv=Hg*Hm,Hw=Hg*Hn,Hx=Hg*Ho;Hk[Hl+0]=(1-(Hs+Hu))*Hh,Hk[Hl+1]=(Hq+Hx)*Hh,Hk[Hl+2]=(Hr-Hw)*Hh,Hk[Hl+3]=0,Hk[Hl+4]=(Hq-Hx)*Hi,Hk[Hl+5]=(1-(Hp+Hu))*Hi,Hk[Hl+6]=(Ht+Hv)*Hi,Hk[Hl+7]=0,Hk[Hl+8]=(Hr+Hw)*Hj,Hk[Hl+9]=(Ht-Hv)*Hj,Hk[Hl+10]=(1-(Hp+Hs))*Hj,Hk[Hl+11]=0,Hk[Hl+12]=Ha,Hk[Hl+13]=Hb,Hk[Hl+14]=Hc,Hk[Hl+15]=1},HG.transformVector3ArrayToVector3ArrayCoordinate=function(Ha,Hb,Hc,Hd,He){var Hf=HG._tempArray4_0,Hg=Ha[Hb+0],Hh=Ha[Hb+1],Hi=Ha[Hb+2],Hj=Hc.elements;Hf[0]=Hg*Hj[0]+Hh*Hj[4]+Hi*Hj[8]+Hj[12],Hf[1]=Hg*Hj[1]+Hh*Hj[5]+Hi*Hj[9]+Hj[13],Hf[2]=Hg*Hj[2]+Hh*Hj[6]+Hi*Hj[10]+Hj[14],Hf[3]=1/(Hg*Hj[3]+Hh*Hj[7]+Hi*Hj[11]+Hj[15]),Hd[He+0]=Hf[0]*Hf[3],Hd[He+1]=Hf[1]*Hf[3],Hd[He+2]=Hf[2]*Hf[3]},HG.transformLightingMapTexcoordByUV0Array=function(Ha,Hb,Hc,Hd,He){var Hf=Hc.elements;Hd[He+0]=Ha[Hb+0]*Hf[0]+Hf[2],Hd[He+1]=(Ha[Hb+1]-1)*Hf[1]+Hf[3]},HG.transformLightingMapTexcoordByUV1Array=function(Ha,Hb,Hc,Hd,He){var Hf=Hc.elements;Hd[He+0]=Ha[Hb+0]*Hf[0]+Hf[2],Hd[He+1]=1+Ha[Hb+1]*Hf[1]+Hf[3]},HG.getURLVerion=function(Ha){var Hb=Ha.indexOf("?");return 0<=Hb?Ha.substr(Hb):null},HG._quaternionCreateFromYawPitchRollArray=function(Ha,Hb,Hc,Hd){var He=.5*Hc,Hf=.5*Hb,Hg=.5*Ha,Hh=Math.sin(He),Hi=Math.cos(He),Hj=Math.sin(Hf),Hk=Math.cos(Hf),Hl=Math.sin(Hg),Hm=Math.cos(Hg);Hd[0]=Hm*Hj*Hi+Hl*Hk*Hh,Hd[1]=Hl*Hk*Hi-Hm*Hj*Hh,Hd[2]=Hm*Hk*Hh-Hl*Hj*Hi,Hd[3]=Hm*Hk*Hi+Hl*Hj*Hh},HG._createAffineTransformationArray=function(Ha,Hb,Hc,Hd){var He=Hb[0],Hf=Hb[1],Hg=Hb[2],Hh=Hb[3],Hi=He+He,Hj=Hf+Hf,Hk=Hg+Hg,Hl=He*Hi,Hm=He*Hj,Hn=He*Hk,Ho=Hf*Hj,Hp=Hf*Hk,Hq=Hg*Hk,Hr=Hh*Hi,Hs=Hh*Hj,Ht=Hh*Hk,Hu=Hc[0],Hv=Hc[1],Hw=Hc[2];Hd[0]=(1-(Ho+Hq))*Hu,Hd[1]=(Hm+Ht)*Hu,Hd[2]=(Hn-Hs)*Hu,Hd[3]=0,Hd[4]=(Hm-Ht)*Hv,Hd[5]=(1-(Hl+Hq))*Hv,Hd[6]=(Hp+Hr)*Hv,Hd[7]=0,Hd[8]=(Hn+Hs)*Hw,Hd[9]=(Hp-Hr)*Hw,Hd[10]=(1-(Hl+Ho))*Hw,Hd[11]=0,Hd[12]=Ha[0],Hd[13]=Ha[1],Hd[14]=Ha[2],Hd[15]=1},HG._mulMatrixArray=function(Ha,Hb,Hc,Hd){var He,Hf,Hg,Hh,Hi,Hj=Hb.elements,Hk=Hj[0],Hl=Hj[1],Hm=Hj[2],Hn=Hj[3],Ho=Hj[4],Hp=Hj[5],Hq=Hj[6],Hr=Hj[7],Hs=Hj[8],Ht=Hj[9],Hu=Hj[10],Hv=Hj[11],Hw=Hj[12],Hx=Hj[13],Hy=Hj[14],Hz=Hj[15],HA=Hd,HB=Hd+4,HC=Hd+8,HD=Hd+12;for(He=0;He<4;He++)Hf=Ha[He],Hg=Ha[He+4],Hh=Ha[He+8],Hi=Ha[He+12],Hc[HA+He]=Hf*Hk+Hg*Hl+Hh*Hm+Hi*Hn,Hc[HB+He]=Hf*Ho+Hg*Hp+Hh*Hq+Hi*Hr,Hc[HC+He]=Hf*Hs+Hg*Ht+Hh*Hu+Hi*Hv,Hc[HD+He]=Hf*Hw+Hg*Hx+Hh*Hy+Hi*Hz},HG.getYawPitchRoll=function(Ha,Hb){HG.transformQuat(Hgb.ForwardRH,Ha,Hcb.TEMPVector31),HG.transformQuat(Hgb.Up,Ha,Hcb.TEMPVector32);var Hc=Hcb.TEMPVector32.elements;HG.angleTo(Hgb.ZERO,Hcb.TEMPVector31,Hcb.TEMPVector33);var Hd=Hcb.TEMPVector33.elements;Hd[0]==Math.PI/2?(Hd[1]=HG.arcTanAngle(Hc[2],Hc[0]),Hd[2]=0):Hd[0]==-Math.PI/2?(Hd[1]=HG.arcTanAngle(-Hc[2],-Hc[0]),Hd[2]=0):(Hab.createRotationY(-Hd[1],Hcb.TEMPMatrix0),Hab.createRotationX(-Hd[0],Hcb.TEMPMatrix1),Hgb.transformCoordinate(Hcb.TEMPVector32,Hcb.TEMPMatrix0,Hcb.TEMPVector32),Hgb.transformCoordinate(Hcb.TEMPVector32,Hcb.TEMPMatrix1,Hcb.TEMPVector32),Hd[2]=HG.arcTanAngle(Hc[1],-Hc[0])),Hd[1]<=-Math.PI&&(Hd[1]=Math.PI),Hd[2]<=-Math.PI&&(Hd[2]=Math.PI),Hd[1]>=Math.PI&&Hd[2]>=Math.PI&&(Hd[1]=0,Hd[2]=0,Hd[0]=Math.PI-Hd[0]),Hb[0]=Hd[1],Hb[1]=Hd[0],Hb[2]=Hd[2]},HG.arcTanAngle=function(Ha,Hb){return 0==Ha?1==Hb?Math.PI/2:-Math.PI/2:0<Ha?Math.atan(Hb/Ha):Ha<0?0<Hb?Math.atan(Hb/Ha)+Math.PI:Math.atan(Hb/Ha)-Math.PI:0},HG.angleTo=function(Ha,Hb,Hc){Hgb.subtract(Hb,Ha,Hcb.TEMPVector30),Hgb.normalize(Hcb.TEMPVector30,Hcb.TEMPVector30),Hc.elements[0]=Math.asin(Hcb.TEMPVector30.y),Hc.elements[1]=HG.arcTanAngle(-Hcb.TEMPVector30.z,-Hcb.TEMPVector30.x)},HG.transformQuat=function(Ha,Hb,Hc){var Hd=Hc.elements,He=Ha.elements,Hf=Hb,Hg=He[0],Hh=He[1],Hi=He[2],Hj=Hf[0],Hk=Hf[1],Hl=Hf[2],Hm=Hf[3],Hn=Hm*Hg+Hk*Hi-Hl*Hh,Ho=Hm*Hh+Hl*Hg-Hj*Hi,Hp=Hm*Hi+Hj*Hh-Hk*Hg,Hq=-Hj*Hg-Hk*Hh-Hl*Hi;Hd[0]=Hn*Hm+Hq*-Hj+Ho*-Hl-Hp*-Hk,Hd[1]=Ho*Hm+Hq*-Hk+Hp*-Hj-Hn*-Hl,Hd[2]=Hp*Hm+Hq*-Hl+Hn*-Hk-Ho*-Hj},HG.quaterionNormalize=function(Ha,Hb){var Hc=Ha[0],Hd=Ha[1],He=Ha[2],Hf=Ha[3],Hg=Hc*Hc+Hd*Hd+He*He+Hf*Hf;0<Hg&&(Hg=1/Math.sqrt(Hg),Hb[0]=Hc*Hg,Hb[1]=Hd*Hg,Hb[2]=He*Hg,Hb[3]=Hf*Hg)},HG.matrix4x4MultiplyFFF=function(Ha,Hb,Hc){var Hd,He,Hf,Hg,Hh;if(Hc===Hb)for(Hb=new Float32Array(16),Hd=0;Hd<16;++Hd)Hb[Hd]=Hc[Hd];for(Hd=0;Hd<4;Hd++)He=Ha[Hd],Hf=Ha[Hd+4],Hg=Ha[Hd+8],Hh=Ha[Hd+12],Hc[Hd]=He*Hb[0]+Hf*Hb[1]+Hg*Hb[2]+Hh*Hb[3],Hc[Hd+4]=He*Hb[4]+Hf*Hb[5]+Hg*Hb[6]+Hh*Hb[7],Hc[Hd+8]=He*Hb[8]+Hf*Hb[9]+Hg*Hb[10]+Hh*Hb[11],Hc[Hd+12]=He*Hb[12]+Hf*Hb[13]+Hg*Hb[14]+Hh*Hb[15]},HG.matrix4x4MultiplyMFM=function(Ha,Hb,Hc){HG.matrix4x4MultiplyFFF(Ha.elements,Hb,Hc.elements)},Hl(HG,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new Hgb},"_tempVector3_1",function(){return this._tempVector3_1=new Hgb},"_tempVector3_2",function(){return this._tempVector3_2=new Hgb},"_tempVector3_3",function(){return this._tempVector3_3=new Hgb},"_tempVector3_4",function(){return this._tempVector3_4=new Hgb},"_tempVector3_5",function(){return this._tempVector3_5=new Hgb},"_tempVector3_6",function(){return this._tempVector3_6=new Hgb},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),HG}(),Hrb=function(){function HE(){}return Hn(HE,"Laya3D"),HE._cancelLoadByUrl=function(Ha){Hv.loader.cancelLoadByUrl(Ha),HE._innerFirstLevelLoaderManager.cancelLoadByUrl(Ha),HE._innerSecondLevelLoaderManager.cancelLoadByUrl(Ha),HE._innerThirdLevelLoaderManager.cancelLoadByUrl(Ha),HE._innerFourthLevelLoaderManager.cancelLoadByUrl(Ha)},HE._changeWebGLSize=function(Ha,Hb){HD.onStageResize(Ha,Hb),HW.clientWidth=Ha,HW.clientHeight=Hb},HE.__init__=function(){var Ha=Hb.createMap;Ha.lh=[HIb,"SPRITE3DHIERARCHY"],Ha.ls=[HHb,"SPRITE3DHIERARCHY"],Ha.lm=[HPb,"MESH"],Ha.lmat=[HKb,"MATERIAL"],Ha.jpg=[HRb,"nativeimage"],Ha.jpeg=[HRb,"nativeimage"],Ha.png=[HRb,"nativeimage"],Ha.pkm=[HRb,"arraybuffer"],Ha.raw=[HNb,"arraybuffer"],Ha.mipmaps=[HNb,"arraybuffer"],Hr.parserMap.SPRITE3DHIERARCHY=HE._loadHierarchy,Hr.parserMap.MESH=HE._loadMesh,Hr.parserMap.MATERIAL=HE._loadMaterial,Hr.parserMap.TEXTURECUBE=HE._loadTextureCube,Hr.parserMap.TERRAIN=HE._loadTerrain,HE._innerFirstLevelLoaderManager.on("error",null,HE._eventLoadManagerError),HE._innerSecondLevelLoaderManager.on("error",null,HE._eventLoadManagerError),HE._innerThirdLevelLoaderManager.on("error",null,HE._eventLoadManagerError),HE._innerFourthLevelLoaderManager.on("error",null,HE._eventLoadManagerError)},HE.READ_BLOCK=function(){return HE._readData.pos+=4,!0},HE.READ_DATA=function(){return HE._DATA.offset=HE._readData.getUint32(),HE._DATA.size=HE._readData.getUint32(),!0},HE.READ_STRINGS=function(){var Ha=[],Hb={offset:0,size:0};Hb.offset=HE._readData.getUint16(),Hb.size=HE._readData.getUint16();HE._readData.pos;HE._readData.pos=Hb.offset+HE._DATA.offset;for(var Hc=0;Hc<Hb.size;Hc++){var Hd=HE._readData.readUTFString();-1===Hd.lastIndexOf(".lmat")&&-1===Hd.lastIndexOf(".lpbr")||Ha.push(Hd)}return Ha},HE.formatRelativePath=function(Ha,Hb){var Hc;if("."===Hb.charAt(0)){for(var Hd=(Ha+Hb).split("/"),He=0,Hf=Hd.length;He<Hf;He++)if(".."==Hd[He]){var Hg=He-1;0<Hg&&".."!==Hd[Hg]&&(Hd.splice(Hg,2),He-=2)}Hc=Hd.join("/")}else Hc=Ha+Hb;return null!=HC.customFormat&&(Hc=HC.customFormat(Hc,null)),Hc},HE._eventLoadManagerError=function(Ha){Hv.loader.event("error",Ha)},HE._addHierarchyInnerUrls=function(Ha,Hb,Hc,Hd,He,Hf){var Hg=HE.formatRelativePath(Hd,He);Hc&&(Hg+=Hc),Ha.push({url:Hg,clas:Hf}),Hb[He]=Hg},HE._getSprite3DHierarchyInnerUrls=function(Ha,Hb,Hc,Hd,He,Hf,Hg){var Hh,Hi=0,Hj=0;switch(Ha.type){case"Scene":var Hk=Ha.customProps.lightmaps;for(Hi=0,Hj=Hk.length;Hi<Hj;Hi++){var Hl=Hk[Hi].replace(".exr",".png");HE._addHierarchyInnerUrls(Hd,He,Hf,Hg,Hl,HRb)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var Hm;if(Ha.instanceParams)(Hm=Ha.instanceParams.loadPath)&&HE._addHierarchyInnerUrls(Hb,He,Hf,Hg,Hm,HPb);else{(Hm=(Hh=Ha.customProps).meshPath)&&HE._addHierarchyInnerUrls(Hb,He,Hf,Hg,Hm,HPb);var Hn=Hh.materials;if(Hn)for(Hi=0,Hj=Hn.length;Hi<Hj;Hi++){for(var Ho=Hn[Hi],Hp=Ho.type.split("."),Hq=HF.window,Hr=0,Hs=Hp.length;Hr<Hs;++Hr){Hq=Hq[this.clasPaths[Hr]]}if("function"!=typeof Hq)throw"_getSprite3DHierarchyInnerUrls 错误: "+Ho.type+" 不是类";HE._addHierarchyInnerUrls(Hc,He,Hf,Hg,Ho.path,Hq)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var Ht=(Hh=Ha.customProps).meshPath;Ht&&HE._addHierarchyInnerUrls(Hb,He,Hf,Hg,Ht,HPb);var Hu=Hh.material;if(Hu){Hp=Hu.type.split("."),Hq=HF.window;for(Hr=0,Hs=Hp.length;Hr<Hs;++Hr){Hq=Hq[this.clasPaths[Hr]]}HE._addHierarchyInnerUrls(Hc,He,Hf,Hg,Hu.path,Hq)}else{var Hv=Hh.materialPath;if(Hv)HE._addHierarchyInnerUrls(Hc,He,Hf,Hg,Hv,ShurikenParticleMaterial);else{var Hw=Hh.texturePath;Hw&&HE._addHierarchyInnerUrls(Hd,He,Hf,Hg,Hw,HRb)}}break;case"Terrain":HE._addHierarchyInnerUrls(Hd,He,Hf,Hg,Ha.customProps.dataPath,TerrainRes)}var Hx=Ha.components;for(var Hy in Hx){var Hz=Hx[Hy];switch(Hy){case"Animator":var HA=Hz.avatarPath;if(HA)HE._addHierarchyInnerUrls(Hd,He,Hf,Hg,HA,Avatar);else{var HB=Hz.avatar;HB&&HE._addHierarchyInnerUrls(Hd,He,Hf,Hg,HB.path,Avatar)}var HC=Hz.clipPaths;for(Hi=0,Hj=HC.length;Hi<Hj;Hi++)HE._addHierarchyInnerUrls(Hd,He,Hf,Hg,HC[Hi],AnimationClip)}}var HD=Ha.child;for(Hi=0,Hj=HD.length;Hi<Hj;Hi++)HE._getSprite3DHierarchyInnerUrls(HD[Hi],Hb,Hc,Hd,He,Hf,Hg)},HE._loadHierarchy=function(Ha){Ha.on("loaded",null,HE._onHierarchylhLoaded,[Ha,Ha._class._getGroup()]),Ha.load(Ha.url,"json",!1,null,!0)},HE._onHierarchylhLoaded=function(Ha,Hb,Hc){if(Ha._class.destroyed)Ha.endLoad();else{var Hd=Ha.url,He=Hqb.getURLVerion(Hd),Hf=HC.getPath(Hd),Hg=[],Hh=[],Hi=[],Hj={};HE._getSprite3DHierarchyInnerUrls(Hc,Hg,Hh,Hi,Hj,He,Hf);var Hk=Hg.length+Hh.length+Hi.length,Hl=Hk+1,Hm=1/Hl;if(HE._onProcessChange(Ha,0,Hm,1),0<Hi.length){var Hn=Hk/Hl,Ho=HB.create(null,HE._onProcessChange,[Ha,Hm,Hn],!1);HE._innerFourthLevelLoaderManager.create(Hi,HB.create(null,HE._onHierarchyInnerForthLevResouLoaded,[Ha,Hb,Ho,Hc,Hj,Hg,Hh,Hm+Hn*Hi.length,Hn]),Ho,null,null,1,!0,Hb)}else HE._onHierarchyInnerForthLevResouLoaded(Ha,Hb,null,Hc,Hj,Hg,Hh,Hm,Hn)}},HE._onHierarchyInnerForthLevResouLoaded=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){if(Ha._class.destroyed)Ha.endLoad();else if(Hc&&Hc.recover(),0<Hg.length){var Hj=HB.create(null,HE._onProcessChange,[Ha,Hh,Hi],!1);HE._innerSecondLevelLoaderManager.create(Hg,HB.create(null,HE._onHierarchyInnerSecondLevResouLoaded,[Ha,Hb,Hj,Hd,He,Hf,Hh+Hi*Hg.length,Hi]),Hc,null,null,1,!0,Hb)}else HE._onHierarchyInnerSecondLevResouLoaded(Ha,Hb,null,Hd,He,Hf,Hh,Hi)},HE._onHierarchyInnerSecondLevResouLoaded=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh){if(Ha._class.destroyed)Ha.endLoad();else if(Hc&&Hc.recover(),0<Hf.length){var Hi=HB.create(null,HE._onProcessChange,[Ha,Hg,Hh],!1);HE._innerFirstLevelLoaderManager.create(Hf,HB.create(null,HE._onHierarchyInnerFirstLevResouLoaded,[Ha,Hi,Hd,He]),Hc,null,null,1,!0,Hb)}else HE._onHierarchyInnerFirstLevResouLoaded(Ha,null,Hd,He)},HE._onHierarchyInnerFirstLevResouLoaded=function(Ha,Hb,Hc,Hd){Hb&&Hb.recover(),Ha.endLoad([Hc,Hd])},HE._loadTerrain=function(Ha){Ha.on("loaded",null,HE._onTerrainLtLoaded,[Ha,Ha._class._getGroup()]),Ha.load(Ha.url,"json",!1,null,!0)},HE._onTerrainLtLoaded=function(Ha,Hb,Hc){if(Ha._class.destroyed)Ha.endLoad();else{var Hd,He,Hf=Ha.url,Hg=Hqb.getURLVerion(Hf),Hh=HC.getPath(Hf),Hi=[],Hj={},Hk=0,Hl=0,Hm=Hc.heightData;Hd=Hm.url,He=HE.formatRelativePath(Hh,Hd),Hg&&(He+=Hg),Hd=Hj[Hd]=He;var Hn=Hc.detailTexture;for(Hk=0,Hl=Hn.length;Hk<Hl;Hk++)Hi.push({url:Hn[Hk].diffuse});var Ho=Hc.normalMap;for(Hk=0,Hl=Ho.length;Hk<Hl;Hk++)Hi.push({url:Ho[Hk]});var Hp=Hc.alphaMap;for(Hk=0,Hl=Hp.length;Hk<Hl;Hk++)Hi.push({url:Hp[Hk],params:[!1,!1,6408,!0]});for(Hk=0,Hl=Hi.length;Hk<Hl;Hk++){var Hq=Hi[Hk].url;He=HE.formatRelativePath(Hh,Hq),Hg&&(He+=Hg),Hi[Hk].url=He,Hj[Hq]=He}var Hr=Hi.length,Hs=Hr+2,Ht=1/Hs;HE._onProcessChange(Ha,0,Ht,1);var Hu={heightMapLoaded:!1,texturesLoaded:!1},Hv=HB.create(null,HE._onProcessChange,[Ha,Ht,Ht],!1);HE._innerFourthLevelLoaderManager.create(Hd,HB.create(null,HE._onTerrainHeightMapLoaded,[Ha,Hv,Hc,Hj,Hu]),Hv,null,[Hm.numX,Hm.numZ,Hm.bitType,Hm.value],1,!0,Hb);var Hw=HB.create(null,HE._onProcessChange,[Ha,2*Ht,Hr/Hs],!1);HE._innerFourthLevelLoaderManager.create(Hi,HB.create(null,HE._onTerrainTexturesLoaded,[Ha,Hw,Hc,Hj,Hu]),Hw,null,null,1,!0,Hb)}},HE._onTerrainHeightMapLoaded=function(Ha,Hb,Hc,Hd,He){He.heightMapLoaded=!0,He.texturesLoaded&&(Ha.endLoad([Hc,Hd]),Hb.recover())},HE._onTerrainTexturesLoaded=function(Ha,Hb,Hc,Hd,He){He.texturesLoaded=!0,He.heightMapLoaded&&(Ha.endLoad([Hc,Hd]),Hb.recover())},HE._loadMesh=function(Ha){Ha.on("loaded",null,HE._onMeshLmLoaded,[Ha,Ha._class._getGroup()]),Ha.load(Ha.url,"arraybuffer",!1,null,!0)},HE._onMeshLmLoaded=function(Ha,Hb,Hc){if(Ha._class.destroyed)Ha.endLoad();else{var Hd,He,Hf,Hg=Ha.url,Hh=Hqb.getURLVerion(Hg),Hi=HC.getPath(Hg),Hj={},Hk=0,Hl=0;switch((HE._readData=new Hw(Hc)).pos=0,HE._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var Hm=HE._readData.getUint32();HE._readData.pos=HE._readData.pos+4,Hl=HE._readData.getUint16(),HE._readData.pos=HE._readData.pos+8*Hl;var Hn=HE._readData.getUint32();for(Hl=HE._readData.getUint16(),HE._readData.pos=Hm+Hn,Hd=[],Hk=0;Hk<Hl;Hk++){var Ho=HE._readData.readUTFString();-1!==Ho.lastIndexOf(".lmat")&&Hd.push(Ho)}break;default:for(HE.READ_BLOCK(),Hk=0;Hk<2;Hk++){var Hp=HE._readData.getUint16(),Hq=HE._strings[Hp],Hr=HE["READ_"+Hq];if(null==Hr)throw new Error("model file err,no this function:"+Hp+" "+Hq);1===Hk?Hd=Hr.call():Hr.call()}}for(Hk=0,Hf=Hd.length;Hk<Hf;Hk++){var Hs=Hd[Hk];He=HE.formatRelativePath(Hi,Hs),Hh&&(He+=Hh),Hd[Hk]=He,Hj[Hs]=He}if(0<Hd.length){HE._onProcessChange(Ha,0,.5,1);var Ht=HB.create(null,HE._onProcessChange,[Ha,.5,.5],!1);HE._innerSecondLevelLoaderManager.create(Hd,HB.create(null,HE._onMeshMateialLoaded,[Ha,Ht,Hc,Hj]),Ht,null,null,1,!0,Hb)}else Ha.endLoad([Hc,Hj])}},HE._onMeshMateialLoaded=function(Ha,Hb,Hc,Hd){Ha.endLoad([Hc,Hd]),Hb.recover()},HE._getMaterialTexturePath=function(Ha,Hb,Hc){var Hd=Ha.length-4;return Ha.indexOf(".dds")!=Hd&&Ha.indexOf(".tga")!=Hd&&Ha.indexOf(".exr")!=Hd&&Ha.indexOf(".DDS")!=Hd&&Ha.indexOf(".TGA")!=Hd&&Ha.indexOf(".EXR")!=Hd||(Ha=Ha.substr(0,Hd)+".png"),Ha=HE.formatRelativePath(Hc,Ha),Hb&&(Ha+=Hb),Ha},HE._loadMaterial=function(Ha){Ha.on("loaded",null,HE._onMaterilLmatLoaded,[Ha,Ha._class._getGroup()]),Ha.load(Ha.url,"json",!1,null,!0)},HE._onMaterilLmatLoaded=function(Ha,Hb,Hc){if(Ha._class.destroyed)Ha.endLoad();else{var Hd,He=Ha.url,Hf=Hqb.getURLVerion(He),Hg=HC.getPath(He),Hh=[],Hi={},Hj=Hc.customProps,Hk=Hc.version;if(Hk)switch(Hk){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var Hl=Hc.props.textures,Hm=0,Hn=Hl.length;Hm<Hn;Hm++){var Ho=Hl[Hm],Hp=Ho.path;if(Hp){var Hq=Hp.length-4;Hp.indexOf(".exr")!=Hq&&Hp.indexOf(".EXR")!=Hq||(Hp=Hp.substr(0,Hq)+".png"),Hd=HE.formatRelativePath(Hg,Hp),Hf&&(Hd+=Hf),Hh.push({url:Hd,params:Ho.params}),Hi[Hp]=Hd}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var Hr=Hj.diffuseTexture.texture2D;if(Hr&&(Hd=HE._getMaterialTexturePath(Hr,Hf,Hg),Hh.push(Hd),Hi[Hr]=Hd),Hj.normalTexture){var Hs=Hj.normalTexture.texture2D;Hs&&(Hd=HE._getMaterialTexturePath(Hs,Hf,Hg),Hh.push(Hd),Hi[Hs]=Hd)}if(Hj.specularTexture){var Ht=Hj.specularTexture.texture2D;Ht&&(Hd=HE._getMaterialTexturePath(Ht,Hf,Hg),Hh.push(Hd),Hi[Ht]=Hd)}if(Hj.emissiveTexture){var Hu=Hj.emissiveTexture.texture2D;Hu&&(Hd=HE._getMaterialTexturePath(Hu,Hf,Hg),Hh.push(Hd),Hi[Hu]=Hd)}if(Hj.ambientTexture){var Hv=Hj.ambientTexture.texture2D;Hv&&(Hd=HE._getMaterialTexturePath(Hv,Hf,Hg),Hh.push(Hd),Hi[Hv]=Hd)}if(Hj.reflectTexture){var Hw=Hj.reflectTexture.texture2D;Hw&&(Hd=HE._getMaterialTexturePath(Hw,Hf,Hg),Hh.push(Hd),Hi[Hw]=Hd)}}var Hx=Hh.length,Hy=Hx+1,Hz=1/Hy;if(HE._onProcessChange(Ha,0,Hz,1),0<Hx){var HA=HB.create(null,HE._onProcessChange,[Ha,Hz,Hx/Hy],!1);HE._innerFourthLevelLoaderManager.create(Hh,HB.create(null,HE._onMateialTexturesLoaded,[Ha,HA,Hc,Hi]),HA,HRb,null,1,!0,Hb)}else HE._onMateialTexturesLoaded(Ha,null,Hc,null)}},HE._onMateialTexturesLoaded=function(Ha,Hb,Hc,Hd){Ha.endLoad([Hc,Hd]),Hb&&Hb.recover()},HE._loadTextureCube=function(Ha){Ha.on("loaded",null,HE._onTextureCubeLtcLoaded,[Ha]),Ha.load(Ha.url,"json",!1,null,!0)},HE._onTextureCubeLtcLoaded=function(Ha,Hb){if(Ha._class.destroyed)Ha.endLoad();else{var Hc=HC.getPath(Ha.url),Hd=[HE.formatRelativePath(Hc,Hb.px),HE.formatRelativePath(Hc,Hb.nx),HE.formatRelativePath(Hc,Hb.py),HE.formatRelativePath(Hc,Hb.ny),HE.formatRelativePath(Hc,Hb.pz),HE.formatRelativePath(Hc,Hb.nz)];HE._onProcessChange(Ha,0,1/7,1);var He=HB.create(null,HE._onProcessChange,[Ha,1/7,6/7],!1);HE._innerFourthLevelLoaderManager.load(Hd,HB.create(null,HE._onTextureCubeImagesLoaded,[Ha,Hd,He]),He,"nativeimage")}},HE._onTextureCubeImagesLoaded=function(Ha,Hb,Hc){var Hd=[];Hd.length=6;for(var He=0;He<6;He++){var Hf=Hb[He];Hd[He]=Hr.getRes(Hf),Hr.clearRes(Hf)}Ha.endLoad(Hd),Hc.recover()},HE._onProcessChange=function(Ha,Hb,Hc,Hd){(Hd=Hb+Hd*Hc)<1&&Ha.event("progress",Hd)},HE.init=function(Ha,Hb,Hc,Hd,He,Hf){if(void 0===Hc&&(Hc=!1),void 0===Hd&&(Hd=!1),void 0===He&&(He=!0),void 0===Hf&&(Hf=!0),Hs.update3DLoop=function(){},Hs.cancelLoadByUrl=function(Ha){HE._cancelLoadByUrl(Ha)},Hi.isAntialias=Hc,Hi.isAlpha=Hd,Hi.premultipliedAlpha=He,Hi.isStencil=Hf,!HD.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");Hs.changeWebGLSize=HE._changeWebGLSize,Hp.is3DMode=!0,Hv.init(Ha,Hb),HG.__init__(),Hlb.__init__(),HVb.__init__(),HO.__init__(),HE.__init__(),Hg.maxTextureCount=2,(HE.debugMode||HX.debugMode)&&(HE._debugPhasorSprite=new HT)},HE.HIERARCHY="SPRITE3DHIERARCHY",HE.MESH="MESH",HE.MATERIAL="MATERIAL",HE.PBRMATERIAL="PBRMTL",HE.TEXTURECUBE="TEXTURECUBE",HE.TERRAIN="TERRAIN",HE._readData=null,HE._debugPhasorSprite=null,HE.debugMode=!1,Hl(HE,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new Hb},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new Hb},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new Hb},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new Hb}]),HE}(),Hsb=function(Ha){function He(Ha){He.__super.call(this),this._owner=Ha,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}Hn(He,"laya.d3.animation.AnimationTransform3D",Hf);var Hb=He.prototype;return Hb._getlocalMatrix=function(){return this._localUpdate&&(Hqb._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},Hb._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var Ha=0,Hb=this._childs.length;Ha<Hb;Ha++)this._childs[Ha]._onWorldTransform()}},Hb._setWorldMatrixAndUpdate=function(Ha){if(this._worldMatrix=Ha,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var Hb=this._getlocalMatrix(),Hc=0;Hc<16;++Hc)this._worldMatrix[Hc]=Hb[Hc];else Hqb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},Hb._setWorldMatrixNoUpdate=function(Ha){this._worldMatrix=Ha},Hb._setWorldMatrixIgnoreUpdate=function(Ha){this._worldMatrix=Ha,this._worldUpdate=!1},Hb.getLocalPosition=function(){return this._localPosition},Hb.setLocalPosition=function(Ha){if(this._parent)this._localPosition=Ha,this._localUpdate=!0,this._onWorldTransform();else{var Hb=this._entity.owner._transform,Hc=this._entity.localPosition,Hd=Hc.elements;Hd[0]=Ha[0],Hd[1]=Ha[1],Hd[2]=Ha[2],Hb.localPosition=Hc}},Hb.getLocalRotation=function(){if(this._localQuaternionUpdate){var Ha=this._localRotationEuler;Hqb._quaternionCreateFromYawPitchRollArray(Ha[1]/He._angleToRandin,Ha[0]/He._angleToRandin,Ha[2]/He._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},Hb.setLocalRotation=function(Ha){if(this._parent)this._localRotation=Ha,Hqb.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var Hb=this._entity.owner._transform,Hc=this._entity.localRotation,Hd=Hc.elements;Hd[0]=Ha[0],Hd[1]=Ha[1],Hd[2]=Ha[2],Hd[3]=Ha[3],Hb.localRotation=Hc}},Hb.getLocalScale=function(){return this._localScale},Hb.setLocalScale=function(Ha){if(this._parent)this._localScale=Ha,this._localUpdate=!0,this._onWorldTransform();else{var Hb=this._entity.owner._transform,Hc=this._entity.localScale,Hd=Hc.elements;Hd[0]=Ha[0],Hd[1]=Ha[1],Hd[2]=Ha[2],Hb.localScale=Hc}},Hb.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){Hqb.getYawPitchRoll(this._localRotation,He._tempVector3);var Ha=He._tempVector3,Hb=this._localRotationEuler;Hb[0]=Ha[1]*He._angleToRandin,Hb[1]=Ha[0]*He._angleToRandin,Hb[2]=Ha[2]*He._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},Hb.setLocalRotationEuler=function(Ha){if(this._parent)Hqb._quaternionCreateFromYawPitchRollArray(Ha[1]/He._angleToRandin,Ha[0]/He._angleToRandin,Ha[2]/He._angleToRandin,this._localRotation),this._localRotationEuler=Ha,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var Hb=this._entity.owner._transform,Hc=this._entity.localRotationEuler,Hd=Hc.elements;Hd[0]=Ha[0],Hd[1]=Ha[1],Hd[2]=Ha[2],Hb.localRotationEuler=Hc}},Hb.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)Hqb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var Ha=this._getlocalMatrix(),Hb=0;Hb<16;++Hb)this._worldMatrix[Hb]=Ha[Hb];this._worldUpdate=!1}return this._worldMatrix},Hb.setParent=function(Ha){if(this._parent!==Ha){if(this._parent){var Hb=this._parent._childs,Hc=Hb.indexOf(this);Hb.splice(Hc,1)}Ha&&(Ha._childs.push(this),Ha&&this._onWorldTransform()),this._parent=Ha}},Hl(He,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),He}(),Htb=function(Ha){function Hb(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,Hb.__super.call(this),this._destroyed=!1,this._id=Hb._uniqueIDCounter,Hb._uniqueIDCounter++}Hn(Hb,"laya.d3.component.Component3D",Hf);var Hc=Hb.prototype;return Hv.imps(Hc,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),Hc._initialize=function(Ha){this._owner=Ha,this._enable=!0,this.started=!1,this._load(Ha)},Hc._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},Hc._load=function(Ha){},Hc._start=function(Ha){},Hc._update=function(Ha){},Hc._lateUpdate=function(Ha){},Hc._preRenderUpdate=function(Ha){},Hc._postRenderUpdate=function(Ha){},Hc._unload=function(Ha){this.offAll()},Hc._cloneTo=function(Ha){},Ho(0,Hc,"id",function(){return this._id}),Ho(0,Hc,"destroyed",function(){return this._destroyed}),Ho(0,Hc,"owner",function(){return this._owner}),Ho(0,Hc,"enable",function(){return this._enable},function(Ha){this._enable!==Ha&&(this._enable=Ha,this.event("enablechanged",this._enable))}),Ho(0,Hc,"isSingleton",function(){return Hb._isSingleton}),Hb._isSingleton=!0,Hb._uniqueIDCounter=1,Hb}(),Hub=function(Ha){function Hb(){this._destroyed=!1,Hb.__super.call(this),this._destroyed=!1}Hn(Hb,"laya.d3.core.GeometryFilter",Hf);var Hc=Hb.prototype;return Hv.imps(Hc,{"laya.resource.IDestroy":!0}),Hc._destroy=function(){this.offAll(),this._destroyed=!0},Ho(0,Hc,"_isAsyncLoaded",function(){return!0}),Ho(0,Hc,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),Ho(0,Hc,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),Ho(0,Hc,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),Ho(0,Hc,"destroyed",function(){return this._destroyed}),Hb}(),Hvb=function(Ha){function Hd(Ha){Hd.__super.call(this),this._id=++Hd._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new HXa(new Hgb,new Hgb),this._boundingBoxCenter=new Hgb,this._boundingSphere=new HZa(new Hgb,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=Ha,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}Hn(Hd,"laya.d3.core.render.BaseRender",Hf);var Hb=Hd.prototype;return Hv.imps(Hb,{"laya.resource.IDestroy":!0}),Hb._changeMaterialReference=function(Ha,Hb){Ha&&Ha._removeReference(),Hb._addReference()},Hb._getInstanceMaterial=function(Ha,Hb){var Hc=new Ha.constructor;return Ha.cloneTo(Hc),Hc.name=Hc.name+"(Instance)",this._materialsInstance[Hb]=!0,this._changeMaterialReference(this._materials[Hb],Hc),this._materials[Hb]=Hc},Hb._setShaderValuelightMap=function(Ha){this._setShaderValueTexture(3,Ha)},Hb._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},Hb._renderRenderableBoundBox=function(){var Ha=Hrb._debugPhasorSprite,Hb=this.boundingBox,Hc=Hd._tempBoundBoxCorners;Hb.getCorners(Hc),Ha.line(Hc[0],Hd._greenColor,Hc[1],Hd._greenColor),Ha.line(Hc[2],Hd._greenColor,Hc[3],Hd._greenColor),Ha.line(Hc[4],Hd._greenColor,Hc[5],Hd._greenColor),Ha.line(Hc[6],Hd._greenColor,Hc[7],Hd._greenColor),Ha.line(Hc[0],Hd._greenColor,Hc[3],Hd._greenColor),Ha.line(Hc[1],Hd._greenColor,Hc[2],Hd._greenColor),Ha.line(Hc[2],Hd._greenColor,Hc[6],Hd._greenColor),Ha.line(Hc[3],Hd._greenColor,Hc[7],Hd._greenColor),Ha.line(Hc[0],Hd._greenColor,Hc[4],Hd._greenColor),Ha.line(Hc[1],Hd._greenColor,Hc[5],Hd._greenColor),Ha.line(Hc[4],Hd._greenColor,Hc[7],Hd._greenColor),Ha.line(Hc[5],Hd._greenColor,Hc[6],Hd._greenColor)},Hb._calculateBoundingSphere=function(){throw"BaseRender: must override it."},Hb._calculateBoundingBox=function(){throw"BaseRender: must override it."},Hb._setShaderValueTexture=function(Ha,Hb){this._owner._shaderValues.setValue(Ha,Hb)},Hb._setShaderValueMatrix4x4=function(Ha,Hb){this._owner._shaderValues.setValue(Ha,Hb?Hb.elements:null)},Hb._setShaderValueColor=function(Ha,Hb){this._owner._shaderValues.setValue(Ha,Hb?Hb.elements:null)},Hb._setShaderValueBuffer=function(Ha,Hb){this._owner._shaderValues.setValue(Ha,Hb)},Hb._setShaderValueInt=function(Ha,Hb){this._owner._shaderValues.setValue(Ha,Hb)},Hb._setShaderValueBool=function(Ha,Hb){this._owner._shaderValues.setValue(Ha,Hb)},Hb._setShaderValueNumber=function(Ha,Hb){this._owner._shaderValues.setValue(Ha,Hb)},Hb._setShaderValueVector2=function(Ha,Hb){this._owner._shaderValues.setValue(Ha,Hb?Hb.elements:null)},Hb._addShaderDefine=function(Ha){this._owner._shaderDefineValue|=Ha},Hb._removeShaderDefine=function(Ha){this._owner._shaderDefineValue&=~Ha},Hb._renderUpdate=function(Ha){return!0},Hb._applyLightMapParams=function(){if(0<=this._lightmapIndex){var Ha=this._owner.scene;if(Ha){var Hb=Ha.getlightmaps()[this._lightmapIndex];Hb?(this._addShaderDefine(HTb.SAHDERDEFINE_LIGHTMAP),Hb.loaded?this._setShaderValuelightMap(Hb):Hb.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(HTb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(HTb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(HTb.SAHDERDEFINE_LIGHTMAP)},Hb._updateOctreeNode=function(){var Ha=this._treeNode;Ha&&this._octreeNodeNeedChange&&(Ha.updateObject(this),this._octreeNodeNeedChange=!1)},Hb._destroy=function(){this.offAll();var Ha=0,Hb=0;for(Ha=0,Hb=this._renderElements.length;Ha<Hb;Ha++)this._renderElements[Ha]._destroy();for(Ha=0,Hb=this._materials.length;Ha<Hb;Ha++)this._materials[Ha]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},Ho(0,Hb,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),Ho(0,Hb,"id",function(){return this._id}),Ho(0,Hb,"material",function(){var Ha=this._materials[0];if(Ha&&!this._materialsInstance[0]){var Hb=this._getInstanceMaterial(Ha,0);this.event("materialchanged",[this,0,Hb])}return this._materials[0]},function(Ha){this.sharedMaterial=Ha}),Ho(0,Hb,"sharedMaterial",function(){return this._materials[0]},function(Ha){var Hb=this._materials[0];Hb!==Ha&&(this._materials[0]=Ha,this._materialsInstance[0]=!1,this._changeMaterialReference(Hb,Ha),this.event("materialchanged",[this,0,Ha]))}),Ho(0,Hb,"lightmapIndex",function(){return this._lightmapIndex},function(Ha){this._lightmapIndex=Ha,this._applyLightMapParams()}),Ho(0,Hb,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(Ha){this._lightmapScaleOffset=Ha,this._setShaderValueColor(2,Ha),this._addShaderDefine(HTb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),Ho(0,Hb,"enable",function(){return this._enable},function(Ha){this._enable=Ha,this.event("enablechanged",[this,Ha])}),Ho(0,Hb,"materials",function(){for(var Ha=0,Hb=this._materials.length;Ha<Hb;Ha++)if(!this._materialsInstance[Ha]){var Hc=this._getInstanceMaterial(this._materials[Ha],Ha);this.event("materialchanged",[this,Ha,Hc])}return this._materials.slice()},function(Ha){this.sharedMaterials=Ha}),Ho(0,Hb,"sharedMaterials",function(){return this._materials.slice()},function(Ha){if(!Ha)throw new Error("MeshRender: shadredMaterials value can't be null.");var Hb=Ha.length;this._materialsInstance.length=Hb;for(var Hc=0;Hc<Hb;Hc++){var Hd=this._materials[Hc];Hd!==Ha[Hc]&&(this._materialsInstance[Hc]=!1,this._changeMaterialReference(Hd,Ha[Hc]),this.event("materialchanged",[this,Hc,Ha[Hc]]))}this._materials=Ha}),Ho(0,Hb,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),Ho(0,Hb,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var Ha=this.boundingBox;Hgb.add(Ha.min,Ha.max,this._boundingBoxCenter),Hgb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),Ho(0,Hb,"receiveShadow",function(){return this._receiveShadow},function(Ha){this._receiveShadow!==Ha&&((this._receiveShadow=Ha)?this._addShaderDefine(Hnb.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(Hnb.SHADERDEFINE_RECEIVE_SHADOW))}),Ho(0,Hb,"destroyed",function(){return this._destroyed}),Hd._uniqueIDCounter=0,Hl(Hd,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new Hgb,new Hgb,new Hgb,new Hgb,new Hgb,new Hgb,new Hgb,new Hgb]},"_greenColor",function(){return this._greenColor=new Hhb(0,1,0,1)}]),Hd}(),Hwb=function(Ha){function Hh(Ha){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,Hh.__super.call(this),this._localPosition=new Hgb,this._localRotation=new Hcb(0,0,0,1),this._localScale=new Hgb(1,1,1),this._localRotationEuler=new Hgb,this._localMatrix=new Hab,this._position=new Hgb,this._rotation=new Hcb(0,0,0,1),this._scale=new Hgb(1,1,1),this._worldMatrix=new Hab,this._forward=new Hgb,this._up=new Hgb,this._right=new Hgb,this._owner=Ha,this._childs=[]}Hn(Hh,"laya.d3.core.Transform3D",Hf);var Hb=Hh.prototype;return Hb._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)Hab.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var Ha=Hh._tempVector30;Hgb.multiply(this.pivot,this._localScale,Ha);var Hb=Hh._tempVector31;Hgb.subtract(Ha,this.pivot,Hb);var Hc=Hh._tempVector32,Hd=this.localRotation;Hgb.transformQuat(Ha,Hd,Hc),Hgb.subtract(Hc,Ha,Hc);var He=Hh._tempVector33;Hgb.subtract(this._localPosition,Hb,He),Hgb.subtract(He,Hc,He),Hab.createAffineTransformation(He,Hd,this._localScale,this._localMatrix)}},Hb._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var Ha=0,Hb=this._childs.length;Ha<Hb;Ha++)this._childs[Ha]._onWorldPositionRotationTransform()}},Hb._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Ha=0,Hb=this._childs.length;Ha<Hb;Ha++)this._childs[Ha]._onWorldPositionScaleTransform()}},Hb._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var Ha=0,Hb=this._childs.length;Ha<Hb;Ha++)this._childs[Ha]._onWorldPositionTransform()}},Hb._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var Ha=0,Hb=this._childs.length;Ha<Hb;Ha++)this._childs[Ha]._onWorldPositionRotationTransform()}},Hb._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Ha=0,Hb=this._childs.length;Ha<Hb;Ha++)this._childs[Ha]._onWorldPositionScaleTransform()}},Hb._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Ha=0,Hb=this._childs.length;Ha<Hb;Ha++)this._childs[Ha]._onWorldTransform()}},Hb.translate=function(Ha,Hb){void 0===Hb&&(Hb=!0),Hb?(Hab.createFromQuaternion(this.localRotation,Hh._tempMatrix0),Hgb.transformCoordinate(Ha,Hh._tempMatrix0,Hh._tempVector30),Hgb.add(this.localPosition,Hh._tempVector30,this._localPosition),this.localPosition=this._localPosition):(Hgb.add(this.position,Ha,this._position),this.position=this._position)},Hb.rotate=function(Ha,Hb,Hc){var Hd;void 0===Hb&&(Hb=!0),void 0===Hc&&(Hc=!0),Hd=Hc?Ha:(Hgb.scale(Ha,Math.PI/180,Hh._tempVector30),Hh._tempVector30),Hcb.createFromYawPitchRoll(Hd.y,Hd.x,Hd.z,Hh._tempQuaternion0),Hb?(Hcb.multiply(this._localRotation,Hh._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(Hcb.multiply(Hh._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},Hb.lookAt=function(Ha,Hb,Hc){void 0===Hc&&(Hc=!1);var Hd,He=Ha.elements;if(Hc){if(Hd=this._localPosition.elements,Math.abs(Hd[0]-He[0])<H$a.zeroTolerance&&Math.abs(Hd[1]-He[1])<H$a.zeroTolerance&&Math.abs(Hd[2]-He[2])<H$a.zeroTolerance)return;Hcb.lookAt(this._localPosition,Ha,Hb,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var Hf=this.position;if(Hd=Hf.elements,Math.abs(Hd[0]-He[0])<H$a.zeroTolerance&&Math.abs(Hd[1]-He[1])<H$a.zeroTolerance&&Math.abs(Hd[2]-He[2])<H$a.zeroTolerance)return;Hcb.lookAt(Hf,Ha,Hb,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},Ho(0,Hb,"_isFrontFaceInvert",function(){var Ha=this.scale,Hb=Ha.x<0;return Ha.y<0&&(Hb=!Hb),Ha.z<0&&(Hb=!Hb),Hb}),Ho(0,Hb,"owner",function(){return this._owner}),Ho(0,Hb,"localRotation",function(){if(this._localQuaternionUpdate){var Ha=this._localRotationEuler.elements;Hcb.createFromYawPitchRoll(Ha[1]/Hh._angleToRandin,Ha[0]/Hh._angleToRandin,Ha[2]/Hh._angleToRandin,this._localRotation)}return this._localRotation},function(Ha){this._localRotation=Ha,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),Ho(0,Hb,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?Hab.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(Ha){null===this._parent?Ha.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),Hab.multiply(this._localMatrix,Ha,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=Ha,this._worldUpdate=!1}),Ho(0,Hb,"worldNeedUpdate",function(){return this._worldUpdate}),Ho(0,Hb,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(Ha){this._localMatrix=Ha,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),Ho(0,Hb,"dummy",function(){return this._dummy},function(Ha){this._dummy!==Ha&&(this._dummy&&(this._dummy._entity=null),Ha&&(Ha._entity=this),this._dummy=Ha)}),Ho(0,Hb,"localPosition",function(){return this._localPosition},function(Ha){this._localPosition=Ha,this._localUpdate=!0,this._onWorldPositionTransform()}),Ho(0,Hb,"position",function(){if(this._positionUpdate){if(null!=this._parent){var Ha=this._parent.position;Hgb.multiply(this._localPosition,this._parent.scale,Hh._tempVector30),Hgb.transformQuat(Hh._tempVector30,this._parent.rotation,Hh._tempVector30),Hgb.add(Ha,Hh._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(Ha){if(null!=this._parent){Hgb.subtract(Ha,this._parent.position,this._localPosition);var Hb=this._parent.scale.elements,Hc=Hb[0],Hd=Hb[1],He=Hb[2];if(1!==Hc||1!==Hd||1!==He){var Hf=Hh._tempVector30,Hg=Hf.elements;Hg[0]=1/Hc,Hg[1]=1/Hd,Hg[2]=1/He,Hgb.multiply(this._localPosition,Hf,this._localPosition)}this._parent.rotation.invert(Hh._tempQuaternion0),Hgb.transformQuat(this._localPosition,Hh._tempQuaternion0,this._localPosition)}else Ha.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=Ha,this._positionUpdate=!1}),Ho(0,Hb,"localScale",function(){return this._localScale},function(Ha){this._localScale=Ha,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),Ho(0,Hb,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(Hh._tempVector30);var Ha=Hh._tempVector30.elements,Hb=this._localRotationEuler.elements;Hb[0]=Ha[1]*Hh._angleToRandin,Hb[1]=Ha[0]*Hh._angleToRandin,Hb[2]=Ha[2]*Hh._angleToRandin}return this._localRotationEuler},function(Ha){this._localRotationEuler=Ha,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),Ho(0,Hb,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?Hcb.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(Ha){null!=this._parent?(this._parent.rotation.invert(Hh._tempQuaternion0),Hcb.multiply(Ha,Hh._tempQuaternion0,this._localRotation)):Ha.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=Ha,this._rotationUpdate=!1}),Ho(0,Hb,"scale",function(){return this._scaleUpdate&&(null!==this._parent?Hgb.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(Ha){if(null!==this._parent){var Hb=this._parent.scale.elements,Hc=Hh._tempVector30.elements;Hc[0]=1/Hb[0],Hc[1]=1/Hb[1],Hc[2]=1/Hb[2],Hgb.multiply(Ha,Hh._tempVector30,this._localScale)}else Ha.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=Ha,this._scaleUpdate=!1}),Ho(0,Hb,"rotationEuler",null,function(Ha){Hcb.createFromYawPitchRoll(Ha.y,Ha.x,Ha.z,this._rotation),this.rotation=this._rotation}),Ho(0,Hb,"forward",function(){var Ha=this.worldMatrix.elements;return this._forward.elements[0]=-Ha[8],this._forward.elements[1]=-Ha[9],this._forward.elements[2]=-Ha[10],this._forward}),Ho(0,Hb,"up",function(){var Ha=this.worldMatrix.elements;return this._up.elements[0]=Ha[4],this._up.elements[1]=Ha[5],this._up.elements[2]=Ha[6],this._up}),Ho(0,Hb,"right",function(){var Ha=this.worldMatrix.elements;return this._right.elements[0]=Ha[0],this._right.elements[1]=Ha[1],this._right.elements[2]=Ha[2],this._right}),Ho(0,Hb,"parent",function(){return this._parent},function(Ha){if(this._parent!==Ha){if(this._parent){var Hb=this._parent._childs,Hc=Hb.indexOf(this);Hb.splice(Hc,1)}Ha&&(Ha._childs.push(this),Ha&&this._onWorldTransform()),this._parent=Ha}}),Hl(Hh,["_tempVector30",function(){return this._tempVector30=new Hgb},"_tempVector31",function(){return this._tempVector31=new Hgb},"_tempVector32",function(){return this._tempVector32=new Hgb},"_tempVector33",function(){return this._tempVector33=new Hgb},"_tempQuaternion0",function(){return this._tempQuaternion0=new Hcb},"_tempMatrix0",function(){return this._tempMatrix0=new Hab},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),Hh}(),Hxb=(function(Ha){function Hb(){this._rotation=0,this._matNeedUpdte=!1,Hb.__super.call(this),this._matrix=new Hab,this._offset=new Hfb,this._tiling=new Hfb(1,1)}Hn(Hb,"laya.d3.core.TransformUV",Hf);var Hc=Hb.prototype;Hv.imps(Hc,{"laya.d3.core.IClone":!0}),Hc._updateMatrix=function(){Hb._tempOffsetV3.elements[0]=this._offset.x,Hb._tempOffsetV3.elements[1]=this._offset.y,Hcb.createFromYawPitchRoll(0,0,this._rotation,Hb._tempRotationQua),Hb._tempTitlingV3.elements[0]=this._tiling.x,Hb._tempTitlingV3.elements[1]=this._tiling.y,Hab.createAffineTransformation(Hb._tempOffsetV3,Hb._tempRotationQua,Hb._tempTitlingV3,this._matrix)},Hc.cloneTo=function(Ha){Ha._matrix=this._matrix.clone(),Ha._offset=this._offset.clone(),Ha._rotation=this._rotation,Ha._tiling=this._tiling.clone()},Hc.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Hc,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),Ho(0,Hc,"tiling",function(){return this._tiling},function(Ha){this._tiling=Ha,this._matNeedUpdte=!0}),Ho(0,Hc,"offset",function(){return this._offset},function(Ha){this._offset=Ha,this._matNeedUpdte=!0}),Ho(0,Hc,"rotation",function(){return this._rotation},function(Ha){this._rotation=Ha,this._matNeedUpdte=!0}),Hl(Hb,["_tempOffsetV3",function(){return this._tempOffsetV3=new Hgb(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new Hcb},"_tempTitlingV3",function(){return this._tempTitlingV3=new Hgb(1,1,1)}])}(),function(Hc){function Ha(){this.x=NaN,this.y=NaN,this.z=NaN,Ha.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}Hn(Ha,"laya.d3.core.particleShuriKen.module.shape.BoxShape",Hc);var Hb=Ha.prototype;Hb._getShapeBoundBox=function(Ha){var Hb=Ha.min.elements;Hb[0]=.5*-this.x,Hb[1]=.5*-this.y,Hb[2]=.5*-this.z;var Hc=Ha.max.elements;Hc[0]=.5*this.x,Hc[1]=.5*this.y,Hc[2]=.5*this.z},Hb._getSpeedBoundBox=function(Ha){var Hb=Ha.min.elements;Hb[0]=0,Hb[1]=0,Hb[2]=0;var Hc=Ha.max.elements;Hc[0]=0,Hc[1]=1,Hc[2]=0},Hb.generatePositionAndDirection=function(Ha,Hb,Hc,Hd){var He=Ha.elements,Hf=Hb.elements;Hc?(Hc.seed=Hd[16],HR._randomPointInsideHalfUnitBox(Ha,Hc),Hd[16]=Hc.seed):HR._randomPointInsideHalfUnitBox(Ha),He[0]=this.x*He[0],He[1]=this.y*He[1],He[2]=this.z*He[2],this.randomDirection?Hc?(Hc.seed=Hd[17],HR._randomPointUnitSphere(Hb,Hc),Hd[17]=Hc.seed):HR._randomPointUnitSphere(Hb):(Hf[0]=0,Hf[1]=0,Hf[2]=1)},Hb.cloneTo=function(Ha){Hc.prototype.cloneTo.call(this,Ha);var Hb=Ha;Hb.x=this.x,Hb.y=this.y,Hb.z=this.z,Hb.randomDirection=this.randomDirection}}(HM),function(Hc){function Hg(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,Hg.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}Hn(Hg,"laya.d3.core.particleShuriKen.module.shape.CircleShape",Hc);var Ha=Hg.prototype;Ha._getShapeBoundBox=function(Ha){var Hb=Ha.min.elements;Hb[0]=Hb[2]=-this.radius,Hb[1]=0;var Hc=Ha.max.elements;Hc[0]=Hc[2]=this.radius,Hc[1]=0},Ha._getSpeedBoundBox=function(Ha){var Hb=Ha.min.elements;Hb[0]=Hb[1]=-1,Hb[2]=0;var Hc=Ha.max.elements;Hc[0]=Hc[1]=1,Hc[2]=0},Ha.generatePositionAndDirection=function(Ha,Hb,Hc,Hd){var He=Ha.elements,Hf=Hg._tempPositionPoint.elements;Hc?(Hc.seed=Hd[16],this.emitFromEdge?HR._randomPointUnitArcCircle(this.arc,Hg._tempPositionPoint,Hc):HR._randomPointInsideUnitArcCircle(this.arc,Hg._tempPositionPoint,Hc),Hd[16]=Hc.seed):this.emitFromEdge?HR._randomPointUnitArcCircle(this.arc,Hg._tempPositionPoint):HR._randomPointInsideUnitArcCircle(this.arc,Hg._tempPositionPoint),He[0]=-Hf[0],He[1]=Hf[1],He[2]=0,Hgb.scale(Ha,this.radius,Ha),this.randomDirection?Hc?(Hc.seed=Hd[17],HR._randomPointUnitSphere(Hb,Hc),Hd[17]=Hc.seed):HR._randomPointUnitSphere(Hb):Ha.cloneTo(Hb)},Ha.cloneTo=function(Ha){Hc.prototype.cloneTo.call(this,Ha);var Hb=Ha;Hb.radius=this.radius,Hb.arc=this.arc,Hb.emitFromEdge=this.emitFromEdge,Hb.randomDirection=this.randomDirection},Hl(Hg,["_tempPositionPoint",function(){return this._tempPositionPoint=new Hfb}])}(HM),function(Hc){function Hm(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,Hm.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}Hn(Hm,"laya.d3.core.particleShuriKen.module.shape.ConeShape",Hc);var Ha=Hm.prototype;Ha._getShapeBoundBox=function(Ha){var Hb=this.radius+this.length*Math.sin(this.angle),Hc=this.length*Math.cos(this.angle),Hd=Ha.min.elements;Hd[0]=Hd[1]=-Hb,Hd[2]=0;var He=Ha.max.elements;He[0]=He[1]=Hb,He[2]=Hc},Ha._getSpeedBoundBox=function(Ha){var Hb=Math.sin(this.angle),Hc=Ha.min.elements;Hc[0]=Hc[1]=-Hb,Hc[2]=0;var Hd=Ha.max.elements;Hd[0]=Hc[1]=Hb,Hd[2]=1},Ha.generatePositionAndDirection=function(Ha,Hb,Hc,Hd){var He,Hf=Ha.elements,Hg=Hb.elements,Hh=Hm._tempPositionPoint.elements,Hi=NaN,Hj=NaN,Hk=Math.cos(this.angle),Hl=Math.sin(this.angle);switch(this.emitType){case 0:Hc?(Hc.seed=Hd[16],HR._randomPointInsideUnitCircle(Hm._tempPositionPoint,Hc),Hd[16]=Hc.seed):HR._randomPointInsideUnitCircle(Hm._tempPositionPoint),Hi=Hh[0],Hj=Hh[1],Hf[0]=Hi*this.radius,Hf[1]=Hj*this.radius,Hf[2]=0,this.randomDirection?(Hc?(Hc.seed=Hd[17],HR._randomPointInsideUnitCircle(Hm._tempDirectionPoint,Hc),Hd[17]=Hc.seed):HR._randomPointInsideUnitCircle(Hm._tempDirectionPoint),He=Hm._tempDirectionPoint.elements,Hg[0]=He[0]*Hl,Hg[1]=He[1]*Hl):(Hg[0]=Hi*Hl,Hg[1]=Hj*Hl),Hg[2]=Hk;break;case 1:Hc?(Hc.seed=Hd[16],HR._randomPointUnitCircle(Hm._tempPositionPoint,Hc),Hd[16]=Hc.seed):HR._randomPointUnitCircle(Hm._tempPositionPoint),Hi=Hh[0],Hj=Hh[1],Hf[0]=Hi*this.radius,Hf[1]=Hj*this.radius,Hf[2]=0,this.randomDirection?(Hc?(Hc.seed=Hd[17],HR._randomPointInsideUnitCircle(Hm._tempDirectionPoint,Hc),Hd[17]=Hc.seed):HR._randomPointInsideUnitCircle(Hm._tempDirectionPoint),He=Hm._tempDirectionPoint.elements,Hg[0]=He[0]*Hl,Hg[1]=He[1]*Hl):(Hg[0]=Hi*Hl,Hg[1]=Hj*Hl),Hg[2]=Hk;break;case 2:Hc?(Hc.seed=Hd[16],HR._randomPointInsideUnitCircle(Hm._tempPositionPoint,Hc)):HR._randomPointInsideUnitCircle(Hm._tempPositionPoint),Hi=Hh[0],Hj=Hh[1],Hf[0]=Hi*this.radius,Hf[1]=Hj*this.radius,Hg[Hf[2]=0]=Hi*Hl,Hg[1]=Hj*Hl,Hg[2]=Hk,Hgb.normalize(Hb,Hb),Hc?(Hgb.scale(Hb,this.length*Hc.getFloat(),Hb),Hd[16]=Hc.seed):Hgb.scale(Hb,this.length*Math.random(),Hb),Hgb.add(Ha,Hb,Ha),this.randomDirection&&(Hc?(Hc.seed=Hd[17],HR._randomPointUnitSphere(Hb,Hc),Hd[17]=Hc.seed):HR._randomPointUnitSphere(Hb));break;case 3:Hc?(Hc.seed=Hd[16],HR._randomPointUnitCircle(Hm._tempPositionPoint,Hc)):HR._randomPointUnitCircle(Hm._tempPositionPoint),Hi=Hh[0],Hj=Hh[1],Hf[0]=Hi*this.radius,Hf[1]=Hj*this.radius,Hg[Hf[2]=0]=Hi*Hl,Hg[1]=Hj*Hl,Hg[2]=Hk,Hgb.normalize(Hb,Hb),Hc?(Hgb.scale(Hb,this.length*Hc.getFloat(),Hb),Hd[16]=Hc.seed):Hgb.scale(Hb,this.length*Math.random(),Hb),Hgb.add(Ha,Hb,Ha),this.randomDirection&&(Hc?(Hc.seed=Hd[17],HR._randomPointUnitSphere(Hb,Hc),Hd[17]=Hc.seed):HR._randomPointUnitSphere(Hb));break;default:throw new Error("ConeShape:emitType is invalid.")}},Ha.cloneTo=function(Ha){Hc.prototype.cloneTo.call(this,Ha);var Hb=Ha;Hb.angle=this.angle,Hb.radius=this.radius,Hb.length=this.length,Hb.emitType=this.emitType,Hb.randomDirection=this.randomDirection},Hl(Hm,["_tempPositionPoint",function(){return this._tempPositionPoint=new Hfb},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new Hfb}])}(HM),function(Hc){function Ha(){this.radius=NaN,this.emitFromShell=!1,Ha.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}Hn(Ha,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",Hc);var Hb=Ha.prototype;Hb._getShapeBoundBox=function(Ha){var Hb=Ha.min.elements;Hb[0]=Hb[1]=Hb[2]=-this.radius;var Hc=Ha.max.elements;Hc[0]=Hc[1]=this.radius,Hc[2]=0},Hb._getSpeedBoundBox=function(Ha){var Hb=Ha.min.elements;Hb[0]=Hb[1]=-1,Hb[2]=0;var Hc=Ha.max.elements;Hc[0]=Hc[1]=Hc[2]=1},Hb.generatePositionAndDirection=function(Ha,Hb,Hc,Hd){var He=Ha.elements;Hc?(Hc.seed=Hd[16],this.emitFromShell?HR._randomPointUnitSphere(Ha,Hc):HR._randomPointInsideUnitSphere(Ha,Hc),Hd[16]=Hc.seed):this.emitFromShell?HR._randomPointUnitSphere(Ha):HR._randomPointInsideUnitSphere(Ha),Hgb.scale(Ha,this.radius,Ha);var Hf=He[2];Hf<0&&(He[2]=-1*Hf),this.randomDirection?Hc?(Hc.seed=Hd[17],HR._randomPointUnitSphere(Hb,Hc),Hd[17]=Hc.seed):HR._randomPointUnitSphere(Hb):Ha.cloneTo(Hb)},Hb.cloneTo=function(Ha){Hc.prototype.cloneTo.call(this,Ha);var Hb=Ha;Hb.radius=this.radius,Hb.emitFromShell=this.emitFromShell,Hb.randomDirection=this.randomDirection}}(HM),function(Hc){function Ha(){this.radius=NaN,this.emitFromShell=!1,Ha.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}Hn(Ha,"laya.d3.core.particleShuriKen.module.shape.SphereShape",Hc);var Hb=Ha.prototype;Hb._getShapeBoundBox=function(Ha){var Hb=Ha.min.elements;Hb[0]=Hb[1]=Hb[2]=-this.radius;var Hc=Ha.max.elements;Hc[0]=Hc[1]=Hc[2]=this.radius},Hb._getSpeedBoundBox=function(Ha){var Hb=Ha.min.elements;Hb[0]=Hb[1]=Hb[2]=-1;var Hc=Ha.max.elements;Hc[0]=Hc[1]=Hc[2]=1},Hb.generatePositionAndDirection=function(Ha,Hb,Hc,Hd){Hc?(Hc.seed=Hd[16],this.emitFromShell?HR._randomPointUnitSphere(Ha,Hc):HR._randomPointInsideUnitSphere(Ha,Hc),Hd[16]=Hc.seed):this.emitFromShell?HR._randomPointUnitSphere(Ha):HR._randomPointInsideUnitSphere(Ha),Hgb.scale(Ha,this.radius,Ha),this.randomDirection?Hc?(Hc.seed=Hd[17],HR._randomPointUnitSphere(Hb,Hc),Hd[17]=Hc.seed):HR._randomPointUnitSphere(Hb):Ha.cloneTo(Hb)},Hb.cloneTo=function(Ha){Hc.prototype.cloneTo.call(this,Ha);var Hb=Ha;Hb.radius=this.radius,Hb.emitFromShell=this.emitFromShell,Hb.randomDirection=this.randomDirection}}(HM),function(Ha){function Hb(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,Hb.__super.call(this)}return Hn(Hb,"laya.d3.core.render.SubMeshRenderElement",HU),Hb}()),Hyb=function(Ha){function Hq(Ha,Hb,Hc,Hd,He,Hf){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=Ha,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[Hnb.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[HTb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[HTb.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[HCb.SHADERDEFINE_ALPHATEST]="ALPHATEST";Hq.__super.call(this,Ha,Hb,Hc,null,{}),this._attributeMap=Hd;var Hg;for(Hg in He){var Hh=He[Hg];switch(Hh[1]){case 0:this._renderElementUniformMap[Hg]=Hh[0];break;case 1:this._materialUniformMap[Hg]=Hh[0];break;case 2:this._spriteUniformMap[Hg]=Hh[0];break;case 3:this._cameraUniformMap[Hg]=Hh[0];break;case 4:this._sceneUniformMap[Hg]=Hh[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}Hn(Hq,"laya.d3.shader.ShaderCompile3D",Ht);var Hb=Hq.prototype;return Hb._definesToNameDic=function(Ha,Hb){for(var Hc={},Hd=1,He=0;He<32&&!(Ha<(Hd=1<<He));He++)if(Ha&Hd){var Hf=Hb[Hd];Hf&&(Hc[Hf]="")}return Hc},Hb.withCompile=function(Ha,Hb,Hc,Hd){var He,Hf,Hg;if(Hf=this.sharders[Ha])if(Hg=Hf[Hb]){if(He=Hg[Hc])return He}else Hg=Hf[Hb]=[];else Hg=(Hf=this.sharders[Ha]=[])[Hb]=[];var Hh,Hi=this._definesToNameDic(Ha,Hq._globalInt2name),Hj=this._definesToNameDic(Hb,this._spriteInt2name),Hk=this._definesToNameDic(Hc,this._materialInt2name),Hl={},Hm="";if(Hi)for(Hh in Hi)Hm+="#define "+Hh+"\n",Hl[Hh]=!0;if(Hj)for(Hh in Hj)Hm+="#define "+Hh+"\n",Hl[Hh]=!0;if(Hk)for(Hh in Hk)Hm+="#define "+Hh+"\n",Hl[Hh]=!0;var Hn=HJb.nameKey.getName(this._name)+" compile ("+Ha+","+Hb+","+Hc+")",Ho=this._VS.toscript(Hl,[]),Hp=this._PS.toscript(Hl,[]);HF.now();if(He=HJb.create(Hm+Ho.join("\n"),Hm+Hp.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,Hd,Hn),Hg[Hc]=He,laya.d3.shader.ShaderCompile3D.debugMode)HF.now();return He},Hb.precompileShaderWithShaderDefine=function(Ha,Hb,Hc){this.withCompile(Ha,Hb,Hc,!0)},Hb.addMaterialDefines=function(Ha){var Hb=Ha.defines;for(var Hc in Hb){var Hd=Hb[Hc],He=parseInt(Hc);this._materialInt2name[He]=Hd,this._materialName2Int[Hd]=He}},Hb.addSpriteDefines=function(Ha){var Hb=Ha.defines;for(var Hc in Hb){var Hd=Hb[Hc],He=parseInt(Hc);this._spriteInt2name[He]=Hd,this._spriteName2Int[Hd]=He}},Hb.getMaterialDefineByName=function(Ha){return this._materialName2Int[Ha]},Hb.registerMaterialDefine=function(Ha){var Hb=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[Hb]=Ha,this._materialName2Int[Ha]=Hb},Hb.registerSpriteDefine=function(Ha){var Hb=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[Hb]=Ha,this._spriteName2Int[Ha]=Hb},Hq._globalRegDefine=function(Ha,Hb){Hq._globalInt2name[Hb]=Ha},Hq.add=function(Ha,Hb,Hc,Hd,He){return laya.d3.shader.ShaderCompile3D._preCompileShader[Ha]=new Hq(Ha,Hb,Hc,Hd,He,Ht.includes)},Hq.get=function(Ha){return laya.d3.shader.ShaderCompile3D._preCompileShader[HJb.nameKey.getID(Ha)]},Hq._preCompileShader={},Hq._globalInt2name=[],Hq.debugMode=!1,Hq.SHADERDEFINE_HIGHPRECISION=1,Hq.SHADERDEFINE_FOG=4,Hq.SHADERDEFINE_DIRECTIONLIGHT=8,Hq.SHADERDEFINE_POINTLIGHT=16,Hq.SHADERDEFINE_SPOTLIGHT=32,Hq.SHADERDEFINE_UV0=64,Hq.SHADERDEFINE_COLOR=128,Hq.SHADERDEFINE_UV1=256,Hq.SAHDERDEFINE_DEPTHFOG=131072,Hq}(),Hzb=function(Ha){function Ho(){Ho.__super.call(this)}Hn(Ho,"laya.d3.graphics.MeshSprite3DStaticBatchManager",Hda);var Hb=Ho.prototype;return Hb._getStaticBatch=function(Ha,Hb,Hc,Hd){var He,Hf;return Hf=Ha?Ha.id.toString()+Hc.id.toString()+Hb.id.toString()+Hd.toString():Hc.id.toString()+Hb.id.toString()+Hd.toString(),this._staticBatches[Hf]?He=this._staticBatches[Hf]:this._staticBatches[Hf]=He=new HAb(Hf,this,Ha,Hb,Hc),He},Hb._initStaticBatchs=function(Ha){var Hb,Hc;this._initBatchRenderElements.sort(Ho._sortPrepareStaticBatch);for(var Hd,He=!1,Hf=0,Hg=0,Hh=this._initBatchRenderElements.length;Hg<Hh;Hg++){var Hi,Hj=this._initBatchRenderElements[Hg],Hk=Hj.renderObj._getVertexBuffer(0);Hj._sprite3D;if(Hc===Hk.vertexDeclaration&&Hb===Hj._material)if(He)Hd._addCombineBatchRenderObjTest(Hj)?(Hi=Hj._staticBatch)!==Hd&&(Hi&&Hi._deleteCombineBatchRenderObj(Hj),Hd._addCombineBatchRenderObj(Hj)):(He=!1,Hf++);else{var Hl=this._initBatchRenderElements[Hg-1],Hm=Hl.renderObj,Hn=Hj.renderObj;He=!(65535<Hm._getVertexBuffer().vertexCount+Hn._getVertexBuffer().vertexCount)&&(Hd=this._getStaticBatch(Ha,Hc,Hb,Hf),(Hi=Hl._staticBatch)!==Hd&&(Hi&&Hi._deleteCombineBatchRenderObj(Hl),Hd._addCombineBatchRenderObj(Hl)),(Hi=Hj._staticBatch)!==Hd&&(Hi&&Hi._deleteCombineBatchRenderObj(Hj),Hd._addCombineBatchRenderObj(Hj)),!0)}else He=!1,Hf=0;Hb=Hj._material,Hc=Hk.vertexDeclaration}},Ho._sortPrepareStaticBatch=function(Ha,Hb){var Hc=Ha._render,Hd=Hb._render,He=Hc.lightmapIndex-Hd.lightmapIndex;if(0!=He)return He;var Hf=Hc.receiveShadow-Hd.receiveShadow;if(0!=Hf)return Hf;var Hg=Ha._mainSortID-Hb._mainSortID;return 0==Hg?Ha.renderObj.triangleCount-Hb.renderObj.triangleCount:Hg},Ho}(),HAb=function(Ha){function Hf(Ha,Hb,Hc,Hd,He){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,Hf.__super.call(this,Ha,Hb,Hc),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=Hd,this._material=He}Hn(Hf,"laya.d3.graphics.SubMeshStaticBatch",Hea);var Hb=Hf.prototype;return Hb._compareBatchRenderElement=function(Ha,Hb){return Ha._batchIndexStart>Hb._batchIndexStart},Hb._addCombineBatchRenderObjTest=function(Ha){var Hb=Ha.renderObj._vertexCount;return!(65535<(0<Hb?this._currentCombineVertexCount+Hb:this._currentCombineVertexCount+Ha.renderObj._getVertexBuffer().vertexCount))},Hb._addCombineBatchRenderObj=function(Ha){var Hb=Ha.renderObj,Hc=Hb._vertexCount;this._initBatchRenderElements.push(Ha),Ha._staticBatch=this,0<Hc?(this._currentCombineIndexCount+=Hb._indexCount,this._currentCombineVertexCount+=Hc):(this._currentCombineIndexCount=this._currentCombineIndexCount+Hb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+Hb._getVertexBuffer().vertexCount),this._needFinishCombine=!0},Hb._deleteCombineBatchRenderObj=function(Ha){var Hb=Ha.renderObj,Hc=this._initBatchRenderElements.indexOf(Ha);if(-1!==Hc){this._initBatchRenderElements.splice(Hc,1),Ha._staticBatch=null;var Hd=Hb._vertexCount;0<Hd?(this._currentCombineIndexCount=this._currentCombineIndexCount-Hb._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-Hd):(this._currentCombineIndexCount=this._currentCombineIndexCount-Hb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-Hb._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},Hb._finishInit=function(){if(this._needFinishCombine){var Ha=0,Hb=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var Hc=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),Hd=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=HMb.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=HLb.create("ushort",this._currentCombineIndexCount,35044);for(var He=0,Hf=this._initBatchRenderElements.length;He<Hf;He++){var Hg=this._initBatchRenderElements[He],Hh=Hg.renderObj,Hi=Hh._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,Hg._sprite3D),Hj=Hh.getIndices(),Hk=Hg._sprite3D.transform._isFrontFaceInvert,Hl=Ha/(this._vertexDeclaration.vertexStride/4)-Hh._vertexStart,Hm=Hb,Hn=Hm+Hj.length;Hg._batchIndexStart=Hm,Hg._batchIndexEnd=Hn,Hd.set(Hj,Hb);var Ho=0;if(Hk)for(Ho=Hm;Ho<Hn;Ho+=3){Hd[Ho]=Hl+Hd[Ho];var Hp=Hd[Ho+1],Hq=Hd[Ho+2];Hd[Ho+1]=Hl+Hq,Hd[Ho+2]=Hl+Hp}else for(Ho=Hm;Ho<Hn;Ho+=3)Hd[Ho]=Hl+Hd[Ho],Hd[Ho+1]=Hl+Hd[Ho+1],Hd[Ho+2]=Hl+Hd[Ho+2];Hb+=Hj.length,Hc.set(Hi,Ha),Ha+=Hi.length}this._vertexBuffer.setData(Hc),this._indexBuffer.setData(Hd),this._needFinishCombine=!1}},Hb._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new Hxb)},Hb._getRenderElement=function(Ha,Hb,Hc){for(var Hd,He,Hf=this._batchRenderElements.length,Hg=!0,Hh=0;Hh<Hf;Hh++){var Hi,Hj,Hk=(He=this._batchRenderElements[Hh])._sprite3D._render;if(0!==Hh&&(Hg=(Hi=(Hd=this._batchRenderElements[Hh-1])._sprite3D._render).lightmapIndex!==Hk.lightmapIndex||Hi.receiveShadow!==Hk.receiveShadow||Hd._batchIndexEnd!==He._batchIndexStart),Hg){(Hj=this._getCombineRenderElementFromPool()).renderObj=this,Hj._material=this._material,Hj._batchIndexStart=He._batchIndexStart,Hj._batchIndexEnd=He._batchIndexEnd;var Hl=Hk.lightmapIndex,Hm=Hl+1,Hn=this._batchOwnerIndices[Hm];Hn||(Hn=this._batchOwnerIndices[Hm]=[]);var Ho,Hp=Hn[He._render.receiveShadow?1:0];void 0===Hp?(Hn[Hk.receiveShadow?1:0]=this._batchOwners.length,(Ho=new HVb(null,"StaticBatchMeshSprite3D"))._scene=Hb,Ho._transform=this._rootOwner?this._rootOwner._transform:null,Ho._render.lightmapIndex=Hl,Ho._render.receiveShadow=He._render.receiveShadow,this._batchOwners.push(Ho)):Ho=this._batchOwners[Hp],Ho._render._renderUpdate(Hc),Hj._sprite3D=Ho,Ha.push(Hj)}else Hj._batchIndexEnd=He._batchIndexEnd}},Hb._beforeRender=function(Ha){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Hb._render=function(Ha){var Hb=Ha.renderElement,Hc=Hb._batchIndexStart,Hd=Hb._batchIndexEnd-Hc;HD.mainContext.drawElements(4,Hd,5123,2*Hc),Hy.drawCall++,Hy.trianglesFaces+=Hd/3},Hb.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},Hb._getVertexBuffer=function(Ha){return void 0===Ha&&(Ha=0),this._vertexBuffer},Hf}(),HBb=function(Ha){function Hb(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,Hb.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}Hn(Hb,"laya.d3.core.ComponentNode",Hj);var Hc=Hb.prototype;return Hc.addComponent=function(Ha){var Hb,Hc=this._componentsMap.indexOf(Ha);if(-1===Hc)Hb=[],this._componentsMap.push(Ha),this._typeComponentsIndices.push(Hb);else if(Hb=this._typeComponentsIndices[Hc],this._components[Hb[0]].isSingleton)throw new Error("无法单实例创建"+Ha+"组件，"+Ha+"组件已存在！");var Hd=He.getInstance(Ha);return Hb.push(this._components.length),this._components.push(Hd),Hd instanceof laya.d3.component.Script&&this._scripts.push(Hd),Hd._initialize(this),Hd},Hc._removeComponent=function(Ha,Hb){var Hc=this._typeComponentsIndices[Ha],Hd=Hc[Hb],He=this._components[Hd];this._components.splice(Hd,1),He instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(He),1),Hc.splice(Hb,1),0===Hc.length&&(this._typeComponentsIndices.splice(Ha,1),this._componentsMap.splice(Ha,1));for(var Hf=0,Hg=this._componentsMap.length;Hf<Hg;Hf++)for(var Hh=(Hc=this._typeComponentsIndices[Hf]).length-1;0<=Hh;Hh--){var Hi=Hc[Hh];if(!(Hd<Hi))break;Hc[Hh]=--Hi}He._destroy()},Hc.getComponentByType=function(Ha,Hb){void 0===Hb&&(Hb=0);var Hc=this._componentsMap.indexOf(Ha);return-1===Hc?null:this._components[this._typeComponentsIndices[Hc][Hb]]},Hc.getComponentsByType=function(Ha,Hb){var Hc=this._componentsMap.indexOf(Ha);if(-1!==Hc){var Hd=this._typeComponentsIndices[Hc],He=Hd.length;Hb.length=He;for(var Hf=0;Hf<He;Hf++)Hb[Hf]=this._components[Hd[Hf]]}else Hb.length=0},Hc.getComponentByIndex=function(Ha){return this._components[Ha]},Hc.removeComponentByType=function(Ha,Hb){void 0===Hb&&(Hb=0);var Hc=this._componentsMap.indexOf(Ha);-1!==Hc&&this._removeComponent(Hc,Hb)},Hc.removeComponentsByType=function(Ha){var Hb=this._componentsMap.indexOf(Ha);if(-1!==Hb)for(var Hc=this._typeComponentsIndices[Hb],Hd=0,He=Hc.length;Hd<He;Hc.length<He?He--:Hd++)this._removeComponent(Hb,Hd)},Hc.removeAllComponent=function(){for(var Ha=0,Hb=this._componentsMap.length;Ha<Hb;this._componentsMap.length<Hb?Hb--:Ha++)this.removeComponentsByType(this._componentsMap[Ha])},Hc._updateComponents=function(Ha){for(var Hb=0,Hc=this._components.length;Hb<Hc;Hb++){var Hd=this._components[Hb];!Hd.started&&(Hd._start(Ha),Hd.started=!0),Hd.enable&&Hd._update(Ha)}},Hc._lateUpdateComponents=function(Ha){for(var Hb=0;Hb<this._components.length;Hb++){var Hc=this._components[Hb];!Hc.started&&(Hc._start(Ha),Hc.started=!0),Hc.enable&&Hc._lateUpdate(Ha)}},Hc._preRenderUpdateComponents=function(Ha){for(var Hb=0;Hb<this._components.length;Hb++){var Hc=this._components[Hb];!Hc.started&&(Hc._start(Ha),Hc.started=!0),Hc.enable&&Hc._preRenderUpdate(Ha)}},Hc._postRenderUpdateComponents=function(Ha){for(var Hb=0;Hb<this._components.length;Hb++){var Hc=this._components[Hb];!Hc.started&&(Hc._start(Ha),Hc.started=!0),Hc.enable&&Hc._postRenderUpdate(Ha)}},Hb}(),HCb=function(Hd){function Ha(){Ha.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new Hmb,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new Hhb(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}Hn(Ha,"laya.d3.core.material.BaseMaterial",Hd);var Hb=Ha.prototype;return Hv.imps(Hb,{"laya.d3.core.IClone":!0}),Hb._addShaderDefine=function(Ha){this._shaderDefineValue|=Ha},Hb._removeShaderDefine=function(Ha){this._shaderDefineValue&=~Ha},Hb._addDisablePublicShaderDefine=function(Ha){this._disablePublicShaderDefine|=Ha},Hb._removeDisablePublicShaderDefine=function(Ha){this._disablePublicShaderDefine&=~Ha},Hb._setBuffer=function(Ha,Hb){this._shaderValues.setValue(Ha,Hb),this._values[Ha]=Hb},Hb._getBuffer=function(Ha){return this._values[Ha]},Hb._setMatrix4x4=function(Ha,Hb){this._shaderValues.setValue(Ha,Hb?Hb.elements:null),this._values[Ha]=Hb},Hb._getMatrix4x4=function(Ha){return this._values[Ha]},Hb._setInt=function(Ha,Hb){this._shaderValues.setValue(Ha,Hb),this._values[Ha]=Hb},Hb._getInt=function(Ha){return this._values[Ha]},Hb._setNumber=function(Ha,Hb){this._shaderValues.setValue(Ha,Hb),this._values[Ha]=Hb},Hb._getNumber=function(Ha){return this._values[Ha]},Hb._setBool=function(Ha,Hb){this._shaderValues.setValue(Ha,Hb),this._values[Ha]=Hb},Hb._getBool=function(Ha){return this._values[Ha]},Hb._setVector2=function(Ha,Hb){this._shaderValues.setValue(Ha,Hb?Hb.elements:null),this._values[Ha]=Hb},Hb._getVector2=function(Ha){return this._values[Ha]},Hb._setColor=function(Ha,Hb){this._shaderValues.setValue(Ha,Hb?Hb.elements:null),this._values[Ha]=Hb},Hb._getColor=function(Ha){return this._values[Ha]},Hb._setTexture=function(Ha,Hb){var Hc=this._values[Ha];this._values[Ha]=Hb,this._shaderValues.setValue(Ha,Hb),0<this.referenceCount&&(Hc&&Hc._removeReference(),Hb&&Hb._addReference())},Hb._getTexture=function(Ha){return this._values[Ha]},Hb._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},Hb._getShader=function(Ha,Hb,Hc){var Hd=(Ha|Hb)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(Hd,Hc,this._shaderDefineValue),this._shader},Hb._setRenderStateBlendDepth=function(){var Ha=HD.mainContext;switch(HE.setDepthMask(Ha,this.depthWrite),0===this.depthTest?HE.setDepthTest(Ha,!1):(HE.setDepthTest(Ha,!0),HE.setDepthFunc(Ha,this.depthTest)),this.blend){case 0:HE.setBlend(Ha,!1);break;case 1:HE.setBlend(Ha,!0),HE.setBlendFunc(Ha,this.srcBlend,this.dstBlend);break;case 2:HE.setBlend(Ha,!0)}},Hb._setRenderStateFrontFace=function(Ha,Hb){var Hc=HD.mainContext,Hd=0;switch(this.cull){case 0:HE.setCullFace(Hc,!1);break;case 1:HE.setCullFace(Hc,!0),Hd=Ha?Hb&&Hb._isFrontFaceInvert?2305:2304:Hb&&Hb._isFrontFaceInvert?2304:2305,HE.setFrontFace(Hc,Hd);break;case 2:HE.setCullFace(Hc,!0),Hd=Ha?Hb&&Hb._isFrontFaceInvert?2304:2305:Hb&&Hb._isFrontFaceInvert?2305:2304,HE.setFrontFace(Hc,Hd)}},Hb.onAsynLoaded=function(Ha,Hb,Hc){var Hd=Hb[0],He=Hb[1];switch(Hd.version){case"LAYAMATERIAL:01":var Hf=0,Hg=0,Hh=Hd.props;for(var Hi in Hh)switch(Hi){case"vectors":var Hj=Hh[Hi];for(Hf=0,Hg=Hj.length;Hf<Hg;Hf++){var Hk=Hj[Hf],Hl=Hk.value;switch(Hl.length){case 2:this[Hk.name]=new Hfb(Hl[0],Hl[1]);break;case 3:this[Hk.name]=new Hgb(Hl[0],Hl[1],Hl[2]);break;case 4:this[Hk.name]=new Hhb(Hl[0],Hl[1],Hl[2],Hl[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var Hm=Hh[Hi];for(Hf=0,Hg=Hm.length;Hf<Hg;Hf++){var Hn=Hm[Hf],Ho=Hn.path;Ho&&(this[Hn.name]=Hr.getRes(He[Ho]))}break;case"defines":var Hp=Hh[Hi];for(Hf=0,Hg=Hp.length;Hf<Hg;Hf++){var Hq=this._shaderCompile.getMaterialDefineByName(Hp[Hf]);this._addShaderDefine(Hq)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[Hi]=Hh[Hi];break;case"renderQueue":switch(Hh[Hi]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[Hi]=Hh[Hi]}break;case"LAYAMATERIAL:02":for(Hi in Hh=Hd.props)switch(Hi){case"vectors":for(Hf=0,Hg=(Hj=Hh[Hi]).length;Hf<Hg;Hf++)switch((Hl=(Hk=Hj[Hf]).value).length){case 2:this[Hk.name]=new Hfb(Hl[0],Hl[1]);break;case 3:this[Hk.name]=new Hgb(Hl[0],Hl[1],Hl[2]);break;case 4:this[Hk.name]=new Hhb(Hl[0],Hl[1],Hl[2],Hl[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(Hf=0,Hg=(Hm=Hh[Hi]).length;Hf<Hg;Hf++)(Ho=(Hn=Hm[Hf]).path)&&(this[Hn.name]=Hr.getRes(He[Ho]));break;case"defines":for(Hf=0,Hg=(Hp=Hh[Hi]).length;Hf<Hg;Hf++)Hq=this._shaderCompile.getMaterialDefineByName(Hp[Hf]),this._addShaderDefine(Hq);break;default:this[Hi]=Hh[Hi]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},Hb._addReference=function(){Hd.prototype._addReference.call(this);for(var Ha=0,Hb=this._values.length;Ha<Hb;Ha++){var Hc=this._values[Ha];Hc&&Hc instanceof laya.d3.resource.BaseTexture&&Hc._addReference()}},Hb._removeReference=function(){Hd.prototype._removeReference.call(this);for(var Ha=0,Hb=this._values.length;Ha<Hb;Ha++){var Hc=this._values[Ha];Hc&&Hc instanceof laya.d3.resource.BaseTexture&&Hc._removeReference()}},Hb.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},Hb.setShaderName=function(Ha){var Hb=HJb.nameKey.getID(Ha);if(-1===Hb)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=Hyb._preCompileShader[Hb]},Hb.cloneTo=function(Ha){var Hb=Ha;Hb.name=this.name,Hb.cull=this.cull,Hb.blend=this.blend,Hb.srcBlend=this.srcBlend,Hb.dstBlend=this.dstBlend,Hb.srcBlendRGB=this.srcBlendRGB,Hb.dstBlendRGB=this.dstBlendRGB,Hb.srcBlendAlpha=this.srcBlendAlpha,Hb.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(Hb.blendConstColor),Hb.blendEquation=this.blendEquation,Hb.blendEquationRGB=this.blendEquationRGB,Hb.blendEquationAlpha=this.blendEquationAlpha,Hb.depthTest=this.depthTest,Hb.depthWrite=this.depthWrite,Hb.renderQueue=this.renderQueue,Hb._shader=this._shader,Hb._disablePublicShaderDefine=this._disablePublicShaderDefine,Hb._shaderDefineValue=this._shaderDefineValue;var Hc,Hd=0,He=Hb._shaderValues;Hb._shaderValues.data.length=this._shaderValues.data.length;var Hf=this._values.length,Hg=Hb._values;for(Hd=0,Hc=Hg.length=Hf;Hd<Hc;Hd++){var Hh=this._values[Hd];if(Hh)if("number"==typeof Hh)Hg[Hd]=Hh,He.data[Hd]=Hh;else if("number"==typeof Hh&&Math.floor(Hh)==Hh)Hg[Hd]=Hh,He.data[Hd]=Hh;else if("boolean"==typeof Hh)Hg[Hd]=Hh,He.data[Hd]=Hh;else if(Hh instanceof laya.d3.math.Vector2){var Hi=Hg[Hd]||(Hg[Hd]=new Hfb);Hh.cloneTo(Hi),He.data[Hd]=Hi.elements}else if(Hh instanceof laya.d3.math.Vector3){var Hj=Hg[Hd]||(Hg[Hd]=new Hgb);Hh.cloneTo(Hj),He.data[Hd]=Hj.elements}else if(Hh instanceof laya.d3.math.Vector4){var Hk=Hg[Hd]||(Hg[Hd]=new Hhb);Hh.cloneTo(Hk),He.data[Hd]=Hk.elements}else if(Hh instanceof laya.d3.math.Matrix4x4){var Hl=Hg[Hd]||(Hg[Hd]=new Hab);Hh.cloneTo(Hl),He.data[Hd]=Hl.elements}else Hh instanceof laya.d3.resource.BaseTexture&&(Hg[Hd]=Hh,He.data[Hd]=Hh)}},Hb.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Ho(0,Hb,"alphaTestValue",function(){return this._getNumber(0)},function(Ha){this._setNumber(0,Ha)}),Ho(0,Hb,"alphaTest",function(){return this._alphaTest},function(Ha){(this._alphaTest=Ha)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),Ha.__init__=function(){Ha.SHADERDEFINE_ALPHATEST=Ha.shaderDefines.registerDefine("ALPHATEST")},Ha.RENDERQUEUE_OPAQUE=2e3,Ha.RENDERQUEUE_ALPHATEST=2450,Ha.RENDERQUEUE_TRANSPARENT=3e3,Ha.CULL_NONE=0,Ha.CULL_FRONT=1,Ha.CULL_BACK=2,Ha.BLEND_DISABLE=0,Ha.BLEND_ENABLE_ALL=1,Ha.BLEND_ENABLE_SEPERATE=2,Ha.BLENDPARAM_ZERO=0,Ha.BLENDPARAM_ONE=1,Ha.BLENDPARAM_SRC_COLOR=768,Ha.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,Ha.BLENDPARAM_DST_COLOR=774,Ha.BLENDPARAM_ONE_MINUS_DST_COLOR=775,Ha.BLENDPARAM_SRC_ALPHA=770,Ha.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,Ha.BLENDPARAM_DST_ALPHA=772,Ha.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,Ha.BLENDPARAM_SRC_ALPHA_SATURATE=776,Ha.BLENDEQUATION_ADD=0,Ha.BLENDEQUATION_SUBTRACT=1,Ha.BLENDEQUATION_REVERSE_SUBTRACT=2,Ha.DEPTHTEST_OFF=0,Ha.DEPTHTEST_NEVER=512,Ha.DEPTHTEST_LESS=513,Ha.DEPTHTEST_EQUAL=514,Ha.DEPTHTEST_LEQUAL=515,Ha.DEPTHTEST_GREATER=516,Ha.DEPTHTEST_NOTEQUAL=517,Ha.DEPTHTEST_GEQUAL=518,Ha.DEPTHTEST_ALWAYS=519,Ha.SHADERDEFINE_ALPHATEST=1,Ha.ALPHATESTVALUE=0,Hl(Ha,["shaderDefines",function(){return this.shaderDefines=new Hkb}]),Ha}(Hq),HDb=function(Ha){function Hb(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,Hb.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}Hn(Hb,"laya.d3.resource.BaseTexture",Hq);var Hc=Hb.prototype;return Ho(0,Hc,"width",function(){return this._width}),Ho(0,Hc,"repeat",function(){return this._repeat},function(Ha){if(this._repeat!==Ha&&(this._repeat=Ha,this._source)){var Hb=HD.mainContext;HE.bindTexture(Hb,this._type,this._source),Hu.isPOT(this._width,this._height)&&this._repeat?(Hb.texParameteri(this._type,10242,10497),Hb.texParameteri(this._type,10243,10497)):(Hb.texParameteri(this._type,10242,33071),Hb.texParameteri(this._type,10243,33071))}}),Ho(0,Hc,"height",function(){return this._height}),Ho(0,Hc,"magFifter",function(){return this._magFifter},function(Ha){(this._magFifter=Ha)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(Ha)}),Ho(0,Hc,"wrapModeV",function(){return this._wrapModeV}),Ho(0,Hc,"size",function(){return this._size}),Ho(0,Hc,"wrapModeU",function(){return this._wrapModeU}),Ho(0,Hc,"mipmap",function(){return this._mipmap},function(Ha){this._mipmap=Ha,this._mipmap!=Ha&&this._conchTexture&&this._conchTexture.setMipMap(Ha)}),Ho(0,Hc,"minFifter",function(){return this._minFifter},function(Ha){this._minFifter=Ha,this._minFifter!=Ha&&this._conchTexture&&this._conchTexture.setMinFifter(Ha)}),Ho(0,Hc,"format",function(){return this._format}),Ho(0,Hc,"source",function(){return this.activeResource(),this._source}),Ho(0,Hc,"defaulteTexture",function(){return HQb.grayTexture}),Hb.WARPMODE_REPEAT=0,Hb.WARPMODE_CLAMP=1,Hb}(),HEb=function(Ha){function Hb(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,Hb.__super.call(this),this._boundingBoxCorners=Hd(8,null)}Hn(Hb,"laya.d3.resource.models.BaseMesh",Hq);var Hc=Hb.prototype;return Hc._getPositions=function(){throw new Error("未Override,请重载该属性！")},Hc._generateBoundingObject=function(){this._boundingSphere=new HZa(new Hgb,0),HZa.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new HXa(new Hgb,new Hgb),HXa.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},Hc.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},Hc.getRenderElement=function(Ha){throw new Error("未Override,请重载该属性！")},Ho(0,Hc,"subMeshCount",function(){return this._subMeshCount}),Ho(0,Hc,"boundingBox",function(){return this._boundingBox}),Ho(0,Hc,"boundingBoxCorners",function(){return this._boundingBoxCorners}),Ho(0,Hc,"boundingSphere",function(){return this._boundingSphere}),Hb}(),HFb=(function(Ha){function Hb(){Hb.__super.call(this)}Hn(Hb,"laya.d3.component.Script",Htb);var Hc=Hb.prototype;Hc.onTriggerEnter=function(Ha){},Hc.onTriggerExit=function(Ha){},Hc.onTriggerStay=function(Ha){},Ho(0,Hc,"isSingleton",function(){return Hb._isSingleton}),Hb._isSingleton=!1}(),function(Ha){function Hb(Ha){this._owner=null,this._sharedMesh=null,Hb.__super.call(this),this._owner=Ha}Hn(Hb,"laya.d3.core.MeshFilter",Ha);var Hc=Hb.prototype;return Hc._sharedMeshLoaded=function(){this.event("loaded")},Hc._destroy=function(){Ha.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},Ho(0,Hc,"sharedMesh",function(){return this._sharedMesh},function(Ha){var Hb=this._sharedMesh;Hb&&Hb._removeReference(),(this._sharedMesh=Ha)._addReference(),this.event("meshchanged",[this,Hb,Ha]),Ha.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),Ho(0,Hc,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),Ho(0,Hc,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),Ho(0,Hc,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),Ho(0,Hc,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),Hb}(Hub)),HGb=function(Ha){function Hb(Ha){Hb.__super.call(this,Ha),Ha.meshFilter.on("meshchanged",this,this._onMeshChanged)}Hn(Hb,"laya.d3.core.MeshRender",Hvb);var Hc=Hb.prototype;return Hc._onMeshChanged=function(Ha,Hb,Hc){Hc.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:Hc.once("loaded",this,this._onMeshLoaed)},Hc._onMeshLoaed=function(Ha,Hb){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},Hc._calculateBoundingSphereByInitSphere=function(Ha){var Hb=NaN,Hc=this._owner.transform,Hd=Hc.scale.elements,He=Math.abs(Hd[0]),Hf=Math.abs(Hd[1]),Hg=Math.abs(Hd[2]);Hb=Hf<=He&&Hg<=He?He:Hg<=Hf?Hf:Hg,Hgb.transformCoordinate(Ha.center,Hc.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=Ha.radius*Hb},Hc._calculateBoundBoxByInitCorners=function(Ha){for(var Hb=this._owner.transform.worldMatrix,Hc=0;Hc<8;Hc++)Hgb.transformCoordinate(Ha[Hc],Hb,Hvb._tempBoundBoxCorners[Hc]);HXa.createfromPoints(Hvb._tempBoundBoxCorners,this._boundingBox)},Hc._calculateBoundingSphere=function(){var Ha=this._owner.meshFilter.sharedMesh;null==Ha||null==Ha.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(Ha.boundingSphere)},Hc._calculateBoundingBox=function(){var Ha=this._owner.meshFilter.sharedMesh;null==Ha||null==Ha.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(Ha.boundingBoxCorners)},Hc._renderUpdate=function(Ha){var Hb=this._owner.transform;if(Hb){this._setShaderValueMatrix4x4(0,Hb.worldMatrix);var Hc=this._owner.getProjectionViewWorldMatrix(Ha);this._setShaderValueMatrix4x4(1,Hc)}else this._setShaderValueMatrix4x4(0,Hab.DEFAULT),this._setShaderValueMatrix4x4(1,Ha);return Hrb.debugMode&&this._renderRenderableBoundBox(),!0},Hb}(),HHb=function(Hb){function Hd(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,Hd.__super.call(this),this._renderState=new HW,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new Hmb,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new Hba,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new Hgb(.7,.7,.7),this.ambientColor=new Hgb(.212,.227,.259),HD.shaderHighPrecision&&this.addShaderDefine(Hyb.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}Hn(Hd,"laya.d3.core.scene.Scene",Hb);var Ha=Hd.prototype;return Hv.imps(Ha,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),Ha._setUrl=function(Ha){this._url=Ha},Ha._getGroup=function(){return this._group},Ha._setGroup=function(Ha){this._group=Ha},Ha._display=function(){Hv.stage._scenes.push(this),Hv.stage._scenes.sort(Hd._sortScenes);for(var Ha=0,Hb=this._childs.length;Ha<Hb;Ha++){var Hc=this._childs[Ha];Hc.active&&Hc._activeHierarchy()}},Ha._unDisplay=function(){var Ha=Hv.stage._scenes;Ha.splice(Ha.indexOf(this),1);for(var Hb=0,Hc=this._childs.length;Hb<Hc;Hb++){var Hd=this._childs[Hb];Hd.active&&Hd._inActiveHierarchy()}},Ha._addChild3D=function(Ha){Ha.transform._onWorldTransform(),Ha._setBelongScene(this),this.displayedInStage&&Ha.active&&Ha._activeHierarchy()},Ha._removeChild3D=function(Ha){Ha.transform.parent=null,this.displayedInStage&&Ha.active&&Ha._inActiveHierarchy(),Ha._setUnBelongScene()},Ha.initOctree=function(Ha,Hb,Hc,Hd,He){void 0===He&&(He=6),this.treeSize=new Hgb(Ha,Hb,Hc),this.treeLevel=He,this.treeRoot=new HX(this,0),this.treeRoot.init(Hd,this.treeSize)},Ha._prepareUpdateToRenderState=function(Ha,Hb){Hb.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,Hb.scene=this},Ha._prepareSceneToRender=function(Ha){var Hb=this._lights.length;if(0<Hb)for(var Hc=0,Hd=0;Hd<Hb&&!(this._lights[Hd]._prepareToScene(Ha)&&++Hc>=this._enableLightCount);Hd++);},Ha._updateChilds=function(Ha){for(var Hb=0,Hc=this._childs.length;Hb<Hc;++Hb)this._childs[Hb]._update(Ha)},Ha._preRenderScene=function(Ha,Hb,Hc){var Hd,He=Hb._viewMatrix,Hf=Hb._projectionMatrix,Hg=Hb._projectionViewMatrix,Hh=0,Hi=Hb.camera;for(Hi.useOcclusionCulling?this.treeRoot?Hca.renderObjectCullingOctree(Hc,this,Hi,He,Hf,Hg):Hca.renderObjectCulling(Hc,this,Hi,He,Hf,Hg):Hca.renderObjectCullingNoBoundFrustum(this,Hi,He,Hf,Hg),Hh=0,Hd=this._quenes.length;Hh<Hd;Hh++)this._quenes[Hh]&&this._quenes[Hh]._preRender(Hb)},Ha._clear=function(Ha,Hb){var Hc=Hb._viewport,Hd=Hb.camera,He=Hc.x,Hf=Hd.renderTargetSize.height-Hc.y-Hc.height,Hg=Hc.width,Hh=Hc.height;Ha.viewport(He,Hf,Hg,Hh);var Hi=256,Hj=Hd.renderTarget;switch(Hd.clearFlag){case 0:var Hk=Hd.clearColor;if(Hk){Ha.enable(3089),Ha.scissor(He,Hf,Hg,Hh);var Hl=Hk.elements;Ha.clearColor(Hl[0],Hl[1],Hl[2],Hl[3]),Hi|=16384}if(Hj)switch(Hk||(Hi=16384),Hj.depthStencilFormat){case 33189:Hi|=256;break;case 36168:Hi|=1024;break;case 34041:Hi|=256,Hi|=1024}Ha.clear(Hi),Hk&&Ha.disable(3089);break;case 1:case 2:if(Hj)switch(Hi=16384,Hj.depthStencilFormat){case 33189:Hi|=256;break;case 36168:Hi|=1024;break;case 34041:Hi|=256,Hi|=1024}Ha.clear(Hi);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},Ha._renderScene=function(Ha,Hb){var Hc,Hd,He=Hb.camera,Hf=0;for(Hf=0;Hf<2;Hf++)(Hd=this._quenes[Hf])&&(He.renderTarget?Hd._render(Hb,!0):Hd._render(Hb,!1));if(1===He.clearFlag){var Hg=He.sky;Hg&&(HE.setCullFace(Ha,!1),HE.setDepthFunc(Ha,515),HE.setDepthMask(Ha,!1),Hg._render(Hb),HE.setDepthFunc(Ha,513),HE.setDepthMask(Ha,!0))}for(Hf=2,Hc=this._quenes.length;Hf<Hc;Hf++)(Hd=this._quenes[Hf])&&(Hd._sortAlpha(Hb.camera.transform.position),He.renderTarget?Hd._render(Hb,!0):Hd._render(Hb,!1))},Ha._set3DRenderConfig=function(Ha){Ha.disable(3042),HE._blend=!1,Ha.blendFunc(770,771),HE._sFactor=770,HE._dFactor=771,Ha.disable(2929),HE._depthTest=!1,Ha.enable(2884),HE._cullFace=!0,Ha.depthMask(1),HE._depthMask=!0,Ha.frontFace(2304),HE._frontFace=2304},Ha._set2DRenderConfig=function(Ha){HE.setBlend(Ha,!0),HE.setBlendFunc(Ha,1,771),HE.setDepthTest(Ha,!1),HE.setCullFace(Ha,!1),HE.setDepthMask(Ha,!0),HE.setFrontFace(Ha,2305),Ha.viewport(0,0,Hk.width,Hk.height)},Ha._parseCustomProps=function(Ha,Hb,Hc,Hd){var He=Hd.customProps.lightmaps,Hf=He.length,Hg=this._lightmaps;Hg.length=Hf;for(var Hh=0;Hh<Hf;Hh++)Hg[Hh]=Hr.getRes(Hb[He[Hh].replace(".exr",".png")]);this.setlightmaps(Hg);var Hi=Hd.customProps.ambientColor;Hi&&(this.ambientColor=new Hgb(Hi[0],Hi[1],Hi[2]));var Hj=Hd.customProps.fogColor;Hj&&(this.fogColor=new Hgb(Hj[0],Hj[1],Hj[2]))},Ha._addLight=function(Ha){this._lights.indexOf(Ha)<0&&this._lights.push(Ha)},Ha._removeLight=function(Ha){var Hb=this._lights.indexOf(Ha);0<=Hb&&this._lights.splice(Hb,1)},Ha._updateScene=function(){var Ha=this._renderState;this._prepareUpdateToRenderState(HD.mainContext,Ha),this._updateComponents(Ha),this._updateChilds(Ha),this._lateUpdateComponents(Ha),this._time+=Ha.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},Ha._updateSceneConch=function(){var Ha=this._renderState;this._prepareUpdateToRenderState(HD.mainContext,Ha),this._updateComponents(Ha),this._lateUpdateComponents(Ha),this._prepareSceneToRender(Ha);for(var Hb=0,Hc=this._cameraPool.length;Hb<Hc;Hb++){var Hd=this._cameraPool[Hb];(Ha.camera=Hd)._prepareCameraToRender()}},Ha._preRenderShadow=function(Ha,Hb,Hc,Hd,He){this.treeRoot?Hca.renderShadowObjectCullingOctree(this,Hb,Hc,Hd,He):Hca.renderShadowObjectCulling(this,Hb,Hc,Hd,He);for(var Hf=0,Hg=Hc.length;Hf<Hg;Hf++)Hc[Hf]&&Hc[Hf]._preRender(Ha)},Ha._renderShadowMap=function(Ha,Hb,Hc){var Hd=this.parallelSplitShadowMaps[0];Hd._calcAllLightCameraInfo(Hc);var He,Hf,Hg,Hh=Hd.PSSMNum;if(this._preRenderShadow(Hb,Hd._lightCulling,Hd._shadowQuenes,Hd._lightVPMatrix[0],Hh),this.addShaderDefine(Hnb.SHADERDEFINE_CAST_SHADOW),1<Hh)for(var Hi=0;Hi<Hh;Hi++)He=Hd.getRenderTarget(Hi+1),Hd.beginRenderTarget(Hi+1),Ha.clearColor(1,1,1,1),Ha.clear(16640),Ha.viewport(0,0,He.width,He.height),Hb.camera=Hg=Hd.getLightCamera(Hi),Hg._prepareCameraToRender(),Hg._prepareCameraViewProject(Hg.viewMatrix,Hg.projectionMatrix),Hb._projectionViewMatrix=Hd._lightVPMatrix[Hi+1],(Hf=Hd._shadowQuenes[Hi])._preRender(Hb),Hf._renderShadow(Hb,!1),Hd.endRenderTarget(Hi+1);else He=Hd.getRenderTarget(1),Hd.beginRenderTarget(1),Ha.clearColor(1,1,1,1),Ha.clear(16640),Ha.viewport(0,0,He.width,He.height),Hb.camera=Hg=Hd.getLightCamera(0),Hg._prepareCameraToRender(),Hg._prepareCameraViewProject(Hg.viewMatrix,Hg.projectionMatrix),Hb._projectionViewMatrix=Hd._lightVPMatrix[0],(Hf=Hd._shadowQuenes[0])._preRender(Hb),Hf._renderShadow(Hb,!0),Hd.endRenderTarget(1);this.removeShaderDefine(Hnb.SHADERDEFINE_CAST_SHADOW)},Ha.addTreeNode=function(Ha){this.treeRoot.addTreeNode(Ha)},Ha.removeTreeNode=function(Ha){this.treeSize&&Ha._treeNode&&Ha._treeNode.removeObject(Ha)},Ha.setlightmaps=function(Ha){this._lightmaps=Ha;for(var Hb=0,Hc=this._renderableSprite3Ds.length;Hb<Hc;Hb++)this._renderableSprite3Ds[Hb]._render._applyLightMapParams()},Ha.getlightmaps=function(){return this._lightmaps},Ha.addChildAt=function(Ha,Hb){if(!(Ha instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(Ha&&Ha.__className));if(!Ha||this.destroyed||Ha===this)return Ha;if(Ha.zOrder&&this._set$P("hasZorder",!0),0<=Hb&&Hb<=this._childs.length){if(Ha._parent===this){var Hc=this.getChildIndex(Ha);this._childs.splice(Hc,1),this._childs.splice(Hb,0,Ha),this.conchModel&&(this.conchModel.removeChild(Ha.conchModel),this.conchModel.addChildAt(Ha.conchModel,Hb)),this._childChanged()}else Ha.parent&&Ha.parent.removeChild(Ha),this._childs===Hj.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Hb,0,Ha),this.conchModel&&this.conchModel.addChildAt(Ha.conchModel,Hb),(Ha.parent=this)._addChild3D(Ha);return Ha}throw new Error("appendChildAt:The index is out of bounds")},Ha.addChild=function(Ha){if(!(Ha instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Ha||this.destroyed||Ha===this)return Ha;if(Ha.zOrder&&this._set$P("hasZorder",!0),Ha._parent===this){var Hb=this.getChildIndex(Ha);Hb!==this._childs.length-1&&(this._childs.splice(Hb,1),this._childs.push(Ha),this.conchModel&&(this.conchModel.removeChild(Ha.conchModel),this.conchModel.addChildAt(Ha.conchModel,this._childs.length-1)),this._childChanged())}else Ha.parent&&Ha.parent.removeChild(Ha),this._childs===Hj.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Ha),this.conchModel&&this.conchModel.addChildAt(Ha.conchModel,this._childs.length-1),(Ha.parent=this)._childChanged(),this._addChild3D(Ha);return Ha},Ha.removeChildAt=function(Ha){var Hb=this.getChildAt(Ha);return Hb&&(this._removeChild3D(Hb),this._childs.splice(Ha,1),this.conchModel&&this.conchModel.removeChild(Hb.conchModel),Hb.parent=null),Hb},Ha.removeChildren=function(Ha,Hb){if(void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=2147483647),this._childs&&0<this._childs.length){var Hc=this._childs;if(0===Ha&&Hf<=Hb){var Hd=Hc;this._childs=Hj.ARRAY_EMPTY}else Hd=Hc.splice(Ha,Hb-Ha);for(var He=0,Hf=Hd.length;He<Hf;He++)this._removeChild3D(Hd[He]),Hd[He].parent=null,this.conchModel&&this.conchModel.removeChild(Hd[He].conchModel)}return this},Ha.addFrustumCullingObject=function(Ha){this.treeRoot?this.addTreeNode(Ha):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(Ha):this._cullingRenders[this._cullingRendersLength]=Ha,Ha._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},Ha.removeFrustumCullingObject=function(Ha){if(this.treeRoot)this.removeTreeNode(Ha);else{this._cullingRendersLength--;var Hb=Ha._indexInSceneFrustumCullingObjects;if(Hb!==this._cullingRendersLength){var Hc=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[Hb]=Hc)._indexInSceneFrustumCullingObjects=Hb,Ha._indexInSceneFrustumCullingObjects=-1}}},Ha.getRenderQueue=function(Ha){return Ha<3e3?this._quenes[1]||(this._quenes[1]=new HV(this)):this._quenes[2]||(this._quenes[2]=new HV(this))},Ha.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new HV(this)},Ha.addShaderDefine=function(Ha){this._shaderDefineValue|=Ha},Ha.removeShaderDefine=function(Ha){this._shaderDefineValue&=~Ha},Ha.addScript=function(Ha){return this._addComponent(Ha)},Ha.getScriptByType=function(Ha,Hb){return void 0===Hb&&(Hb=0),this._getComponentByType(Ha,Hb)},Ha.getScriptsByType=function(Ha,Hb){this._getComponentsByType(Ha,Hb)},Ha.getScriptByIndex=function(Ha){return this._getComponentByIndex(Ha)},Ha.removeScriptByType=function(Ha,Hb){void 0===Hb&&(Hb=0),this._removeComponentByType(Ha,Hb)},Ha.removeScriptsByType=function(Ha){this._removeComponentByType(Ha)},Ha.removeAllScript=function(){this._removeAllComponent()},Ha.render=function(Ha,Hb,Hc){(Hp._context.ctx._renderKey=0)<this._childs.length&&Ha.addRenderObject(this)},Ha.renderSubmit=function(){var Ha=HD.mainContext,Hb=this._renderState;this._set3DRenderConfig(Ha),this._prepareSceneToRender(this._renderState);var Hc,Hd=0,He=0;if(Hrb.debugMode||HX.debugMode)for(Hd=0,He=this._cameraPool.length;Hd<He;Hd++)Hc=this._cameraPool[Hd],Hrb._debugPhasorSprite.begin(1,Hc),Hc.activeInHierarchy&&Hc._renderCamera(Ha,Hb,this),Hrb._debugPhasorSprite.end();else for(Hd=0,He=this._cameraPool.length;Hd<He;Hd++)(Hc=this._cameraPool[Hd]).activeInHierarchy&&Hc._renderCamera(Ha,Hb,this);return this._set2DRenderConfig(Ha),1},Ha.onAsynLoaded=function(Ha,Hb,Hc){var Hd=Hb[0];if("Scene"!==Hd.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var He=Hb[1];Hqb._createNodeByJson(this,Hd,this,He),this.event("hierarchyloaded",[this]),this.__loaded=!0},Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),this.destroyed||(Hb.prototype.destroy.call(this,Ha),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,Hr.clearRes(this.url),this.loaded||Hrb._cancelLoadByUrl(this.url))},Ha.getRenderType=function(){return 0},Ha.releaseRender=function(){},Ha._addComponent=function(Ha){var Hb,Hc=this._componentsMap.indexOf(Ha);if(-1===Hc)Hb=[],this._componentsMap.push(Ha),this._typeComponentsIndices.push(Hb);else if(Hb=this._typeComponentsIndices[Hc],this._components[Hb[0]].isSingleton)throw new Error("无法单实例创建"+Ha+"组件，"+Ha+"组件已存在！");var Hd=He.getInstance(Ha);Hb.push(this._components.length),this._components.push(Hd);return Hd._initialize(this),Hd},Ha._removeComponent=function(Ha,Hb){var Hc=this._typeComponentsIndices[Ha],Hd=Hc[Hb],He=this._components[Hd];this._components.splice(Hd,1),Hc.splice(Hb,1),0===Hc.length&&(this._typeComponentsIndices.splice(Ha,1),this._componentsMap.splice(Ha,1));for(var Hf=0,Hg=this._componentsMap.length;Hf<Hg;Hf++)for(var Hh=(Hc=this._typeComponentsIndices[Hf]).length-1;0<=Hh;Hh--){var Hi=Hc[Hh];if(!(Hd<Hi))break;Hc[Hh]=--Hi}He._destroy()},Ha._getComponentByType=function(Ha,Hb){void 0===Hb&&(Hb=0);var Hc=this._componentsMap.indexOf(Ha);return-1===Hc?null:this._components[this._typeComponentsIndices[Hc][Hb]]},Ha._getComponentsByType=function(Ha,Hb){var Hc=this._componentsMap.indexOf(Ha);if(-1!==Hc){var Hd=this._typeComponentsIndices[Hc],He=Hd.length;Hb.length=He;for(var Hf=0;Hf<He;Hf++)Hb[Hf]=this._components[Hd[Hf]]}else Hb.length=0},Ha._getComponentByIndex=function(Ha){return this._components[Ha]},Ha._removeComponentByType=function(Ha,Hb){void 0===Hb&&(Hb=0);var Hc=this._componentsMap.indexOf(Ha);-1!==Hc&&this._removeComponent(Hc,Hb)},Ha._removeComponentsByType=function(Ha){var Hb=this._componentsMap.indexOf(Ha);if(-1!==Hb)for(var Hc=this._typeComponentsIndices[Hb],Hd=0,He=Hc.length;Hd<He;Hc.length<He?He--:Hd++)this._removeComponent(Hb,Hd)},Ha._removeAllComponent=function(){for(var Ha=0,Hb=this._componentsMap.length;Ha<Hb;this._componentsMap.length<Hb?Hb--:Ha++)this._removeComponentsByType(this._componentsMap[Ha])},Ha._updateComponents=function(Ha){for(var Hb=0,Hc=this._components.length;Hb<Hc;Hb++){var Hd=this._components[Hb];!Hd.started&&(Hd._start(Ha),Hd.started=!0),Hd.enable&&Hd._update(Ha)}},Ha._lateUpdateComponents=function(Ha){for(var Hb=0;Hb<this._components.length;Hb++){var Hc=this._components[Hb];!Hc.started&&(Hc._start(Ha),Hc.started=!0),Hc.enable&&Hc._lateUpdate(Ha)}},Ha._preRenderUpdateComponents=function(Ha){for(var Hb=0;Hb<this._components.length;Hb++){var Hc=this._components[Hb];!Hc.started&&(Hc._start(Ha),Hc.started=!0),Hc.enable&&Hc._preRenderUpdate(Ha)}},Ha._postRenderUpdateComponents=function(Ha){for(var Hb=0;Hb<this._components.length;Hb++){var Hc=this._components[Hb];!Hc.started&&(Hc._start(Ha),Hc.started=!0),Hc.enable&&Hc._postRenderUpdate(Ha)}},Ho(0,Ha,"_loaded",null,function(Ha){this.__loaded=Ha}),Ho(0,Ha,"fogColor",function(){return this._fogColor},function(Ha){this._fogColor=Ha,this._shaderValues.setValue(0,Ha.elements)}),Ho(0,Ha,"enableFog",function(){return this._enableFog},function(Ha){this._enableFog!==Ha&&((this._enableFog=Ha)?(this.addShaderDefine(Hyb.SHADERDEFINE_FOG),this.removeShaderDefine(Hyb.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(Hyb.SHADERDEFINE_FOG))}),Ho(0,Ha,"url",function(){return this._url}),Ho(0,Ha,"loaded",function(){return this.__loaded}),Ho(0,Ha,"enableDepthFog",function(){return this._enableDepthFog},function(Ha){this._enableDepthFog!=Ha&&((this._enableDepthFog=Ha)?(this.addShaderDefine(Hyb.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(Hyb.SHADERDEFINE_FOG)):this.removeShaderDefine(Hyb.SAHDERDEFINE_DEPTHFOG))}),Ho(0,Ha,"fogStart",function(){return this._fogStart},function(Ha){this._fogStart=Ha,this._shaderValues.setValue(1,Ha)}),Ho(0,Ha,"fogRange",function(){return this._fogRange},function(Ha){this._fogRange=Ha,this._shaderValues.setValue(2,Ha)}),Ho(0,Ha,"ambientColor",function(){return this._ambientColor},function(Ha){this._ambientColor=Ha,this._shaderValues.setValue(21,Ha.elements)}),Ho(0,Ha,"scene",function(){return this}),Ho(0,Ha,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),Hd._sortScenes=function(Ha,Hb){if(Ha.parent!==Hv.stage||Hb.parent!==Hv.stage)return Ha.parent!==Hv.stage&&Hb.parent!==Hv.stage?Hd._sortScenes(Ha.parent,Hb.parent):Ha.parent===Hv.stage?-1:1;var Hc=Hv.stage._childs;return Hc.indexOf(Ha)-Hc.indexOf(Hb)},Hd.load=function(Ha){return Hv.loader.create(Ha,null,null,Hd)},Hd.FOGCOLOR=0,Hd.FOGSTART=1,Hd.FOGRANGE=2,Hd.LIGHTDIRECTION=3,Hd.LIGHTDIRCOLOR=4,Hd.POINTLIGHTPOS=5,Hd.POINTLIGHTRANGE=6,Hd.POINTLIGHTATTENUATION=7,Hd.POINTLIGHTCOLOR=8,Hd.SPOTLIGHTPOS=9,Hd.SPOTLIGHTDIRECTION=10,Hd.SPOTLIGHTSPOT=11,Hd.SPOTLIGHTRANGE=12,Hd.SPOTLIGHTATTENUATION=13,Hd.SPOTLIGHTCOLOR=14,Hd.SHADOWDISTANCE=15,Hd.SHADOWLIGHTVIEWPROJECT=16,Hd.SHADOWMAPPCFOFFSET=17,Hd.SHADOWMAPTEXTURE1=18,Hd.SHADOWMAPTEXTURE2=19,Hd.SHADOWMAPTEXTURE3=20,Hd.AMBIENTCOLOR=21,Hd.TIME=22,Hd}(Hx),HIb=function(Ha){function Hb(Ha){Hb.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new Hab,this._shaderValues=new Hmb,this._colliders=[],this._id=++Hb._uniqueIDCounter,this._transform=new Hwb(this),this.name=Ha||"Sprite3D-"+Hb._nameNumberCounter++,this.layer=HG.currentCreationLayer,this.active=!0}Hn(Hb,"laya.d3.core.Sprite3D",HBb);var Hc=Hb.prototype;return Hv.imps(Hc,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),Hc._setUrl=function(Ha){this._url=Ha},Hc._getGroup=function(){return this._group},Hc._setGroup=function(Ha){this._group=Ha},Hc._addChild3D=function(Ha){Ha.transform.parent=this.transform,this._hierarchyAnimator&&(!Ha._hierarchyAnimator&&Ha._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(Ha,!0,[Ha.name])),this._scene&&(Ha._setBelongScene(this._scene),this._activeInHierarchy&&Ha._active&&Ha._activeHierarchy())},Hc._removeChild3D=function(Ha){Ha.transform.parent=null,this._scene&&(this._activeInHierarchy&&Ha._active&&Ha._inActiveHierarchy(),Ha._setUnBelongScene()),this._hierarchyAnimator&&(Ha._hierarchyAnimator==this._hierarchyAnimator&&Ha._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(Ha,!1,[Ha.name]))},Hc._parseBaseCustomProps=function(Ha){var Hb=this.transform.localPosition;Ha.translate?(Hb.fromArray(Ha.translate),Hb.x*=100,Hb.y*=100,Hb.z*=100):Hb.elements.fill(0),this.transform.localPosition=Hb;var Hc=this.transform.localRotation;Ha.rotation?Hc.fromArray(Ha.rotation):Hc.fromArray([0,0,0,-1]),this.transform.localRotation=Hc;var Hd=this.transform.localScale;Ha.scale?Hd.fromArray(Ha.scale):Hd.elements.fill(1),this.transform.localScale=Hd;var He=Ha.layer;null!=He&&(this.layer=HG.getLayerByNumber(He))},Hc._parseCustomComponent=function(Ha,Hb,Hc){for(var Hd in Hc){var He=Hc[Hd];switch(Hd){case"Animator":var Hf=this.addComponent(Animator);if(He.avatarPath)Hf.avatar=Hr.getRes(Hb[He.avatarPath]);else{var Hg=He.avatar;if(Hg){Hf.avatar=Hr.getRes(Hb[Hg.path]);var Hh=Hg.linkSprites;Hh&&Ha.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[Hf,Hh])}}for(var Hi=He.clipPaths,Hj=Hi.length,Hk=0;Hk<Hj;Hk++)Hf.addClip(Hr.getRes(Hb[Hi[Hk]]));Hf.clip=Hr.getRes(Hb[Hi[0]]);var Hl=He.playOnWake;void 0!==Hl&&(Hf.playOnWake=Hl);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var Hm=this.addComponent(SphereCollider);Hm.isTrigger=He.isTrigger;var Hn=Hm.center;Hn.fromArray(He.center),Hm.center=Hn,Hm.radius=He.radius;break;case"BoxCollider":var Ho=this.addComponent(BoxCollider);Ho.isTrigger=He.isTrigger,Ho.center.fromArray(He.center);var Hp=Ho.size;Hp.fromArray(He.size),Ho.size=Hp;break;case"MeshCollider":this.addComponent(MeshCollider)}}},Hc._onRootNodeHierarchyLoaded=function(Ha,Hb){for(var Hc in Hb){for(var Hd=this,He=Hb[Hc],Hf=0,Hg=He.length;Hf<Hg;Hf++){var Hh=He[Hf];if(""===Hh)break;if(!(Hd=Hd.getChildByName(Hh)))break}Hd&&Ha.linkSprite3DToAvatarNode(Hc,Hd)}},Hc._setHierarchyAnimator=function(Ha,Hb){this._changeHierarchyAnimator(Ha);for(var Hc=0,Hd=this._childs.length;Hc<Hd;Hc++){var He=this._childs[Hc];He._hierarchyAnimator==Hb&&He._setHierarchyAnimator(Ha,Hb)}},Hc._clearHierarchyAnimator=function(Ha,Hb){this._changeHierarchyAnimator(Hb);for(var Hc=0,Hd=this._childs.length;Hc<Hd;Hc++){var He=this._childs[Hc];He._hierarchyAnimator==Ha&&He._clearHierarchyAnimator(Ha,Hb)}},Hc._getAnimatorToLinkSprite3D=function(Ha,Hb,Hc){var Hd=this.getComponentByType(Animator);if(Hd&&(Hd.avatar?Hd.avatar._version||Ha._setAnimatorToLinkAvatar(Hd,Hb):Ha._setAnimatorToLinkSprite3DNoAvatar(Hd,Hb,Hc)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){Hc.unshift(this._parent.name);var He=this._parent;He._hierarchyAnimator&&He._getAnimatorToLinkSprite3D(Ha,Hb,Hc)}},Hc._setAnimatorToLinkSprite3DNoAvatar=function(Ha,Hb,Hc){var Hd=0,He=0;for(Hd=0,He=Ha.getClipCount();Hd<He;Hd++)Ha._handleSpriteOwnersBySprite(Hd,Hb,Hc,this);for(Hd=0,He=this._childs.length;Hd<He;Hd++){var Hf=this._childs[Hd],Hg=Hc.length;Hc.push(Hf.name),Hf._setAnimatorToLinkSprite3DNoAvatar(Ha,Hb,Hc),Hc.splice(Hg,1)}},Hc._changeHierarchyAnimator=function(Ha){this._hierarchyAnimator=Ha},Hc._isLinkSpriteToAnimationNode=function(Ha,Hb,Hc){var Hd=Ha._avatarNodes.indexOf(Hb),He=Ha._cacheSpriteToNodesMap;if(Hc)this._transform.dummy=Hb.transform,Ha._cacheNodesToSpriteMap[Hd]=He.length,He.push(Hd);else{this._transform.dummy=null;var Hf=Ha._cacheNodesToSpriteMap[Hd];Ha._cacheNodesToSpriteMap[Hd]=null,He.splice(Hf,1)}},Hc._setBelongScene=function(Ha){this._scene=Ha;for(var Hb=0,Hc=this._childs.length;Hb<Hc;Hb++)this._childs[Hb]._setBelongScene(Ha)},Hc._setUnBelongScene=function(){this._scene=null;for(var Ha=0,Hb=this._childs.length;Ha<Hb;Ha++)this._childs[Ha]._setUnBelongScene()},Hc._activeHierarchy=function(){var Ha=0,Hb=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),Ha=0,Hb=this._colliders.length;Ha<Hb;Ha++)this._layer._addCollider(this._colliders[Ha]);for(this.event("activeinhierarchychanged",!0),Ha=0,Hb=this._childs.length;Ha<Hb;Ha++){var Hc=this._childs[Ha];Hc._active&&Hc._activeHierarchy()}},Hc._inActiveHierarchy=function(){var Ha=0,Hb=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),Ha=0,Hb=this._colliders.length;Ha<Hb;Ha++){var Hc=this._colliders[Ha];Hc._clearCollsionMap(),this._layer._removeCollider(Hc)}for(this.event("activeinhierarchychanged",!1),Ha=0,Hb=this._childs.length;Ha<Hb;Ha++){var Hd=this._childs[Ha];Hd._active&&Hd._inActiveHierarchy()}},Hc.addComponent=function(Ha){var Hb,Hc=this._componentsMap.indexOf(Ha);if(-1===Hc)Hb=[],this._componentsMap.push(Ha),this._typeComponentsIndices.push(Hb);else if(Hb=this._typeComponentsIndices[Hc],this._components[Hb[0]].isSingleton)throw new Error("无法单实例创建"+Ha+"组件，"+Ha+"组件已存在！");var Hd=He.getInstance(Ha);return Hb.push(this._components.length),this._components.push(Hd),Hd instanceof laya.d3.component.Script&&this._scripts.push(Hd),Hd._initialize(this),Hd},Hc._removeComponent=function(Ha,Hb){var Hc,Hd=0,He=this._typeComponentsIndices[Ha],Hf=He[Hb],Hg=this._components[Hf];for(Hg instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(Hg),1),He.splice(Hb,1),0===He.length&&(this._typeComponentsIndices.splice(Ha,1),this._componentsMap.splice(Ha,1)),Hd=0,Hc=this._componentsMap.length;Hd<Hc;Hd++)for(var Hh=(He=this._typeComponentsIndices[Hd]).length-1;0<=Hh;Hh--){var Hi=He[Hh];if(!(Hf<Hi))break;He[Hh]=--Hi}Hg._destroy()},Hc._clearSelfRenderObjects=function(){},Hc._addSelfRenderObjects=function(){},Hc._parseCustomProps=function(Ha,Hb,Hc,Hd){},Hc._updateChilds=function(Ha){var Hb=this._childs.length;if(0!==Hb)for(var Hc=0;Hc<Hb;++Hc)this._childs[Hc]._update(Ha)},Hc._getSortID=function(Ha,Hb){return 1e3*Hb.id+Ha._getVertexBuffer().vertexDeclaration.id},Hc._update=function(Ha){(Ha.owner=this)._activeInHierarchy&&(this._updateComponents(Ha),this._lateUpdateComponents(Ha),Hy.spriteCount++,this._childs.length&&this._updateChilds(Ha))},Hc.getProjectionViewWorldMatrix=function(Ha){return Hab.multiply(Ha,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},Hc.loadHierarchy=function(Ha){this.addChild(laya.d3.core.Sprite3D.load(Ha))},Hc.addChildAt=function(Ha,Hb){if(!(Ha instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Ha||this.destroyed||Ha===this)return Ha;if(Ha.zOrder&&this._set$P("hasZorder",!0),0<=Hb&&Hb<=this._childs.length){if(Ha._parent===this){var Hc=this.getChildIndex(Ha);this._childs.splice(Hc,1),this._childs.splice(Hb,0,Ha),this.conchModel&&(this.conchModel.removeChild(Ha.conchModel),this.conchModel.addChildAt(Ha.conchModel,Hb)),this._childChanged()}else Ha.parent&&Ha.parent.removeChild(Ha),this._childs===Hj.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Hb,0,Ha),this.conchModel&&this.conchModel.addChildAt(Ha.conchModel,Hb),(Ha.parent=this)._addChild3D(Ha);return Ha}throw new Error("appendChildAt:The index is out of bounds")},Hc.addChild=function(Ha){if(!(Ha instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Ha||this.destroyed||Ha===this)return Ha;if(Ha.zOrder&&this._set$P("hasZorder",!0),Ha._parent===this){var Hb=this.getChildIndex(Ha);Hb!==this._childs.length-1&&(this._childs.splice(Hb,1),this._childs.push(Ha),this.conchModel&&(this.conchModel.removeChild(Ha.conchModel),this.conchModel.addChildAt(Ha.conchModel,this._childs.length-1)),this._childChanged())}else Ha.parent&&Ha.parent.removeChild(Ha),this._childs===Hj.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Ha),this.conchModel&&this.conchModel.addChildAt(Ha.conchModel,this._childs.length-1),(Ha.parent=this)._childChanged(),this._addChild3D(Ha);return Ha},Hc.removeChildAt=function(Ha){var Hb=this.getChildAt(Ha);return Hb&&(this._removeChild3D(Hb),this._childs.splice(Ha,1),this.conchModel&&this.conchModel.removeChild(Hb.conchModel),Hb.parent=null),Hb},Hc.removeChildren=function(Ha,Hb){if(void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=2147483647),this._childs&&0<this._childs.length){var Hc=this._childs;if(0===Ha&&Hf<=Hb){var Hd=Hc;this._childs=Hj.ARRAY_EMPTY}else Hd=Hc.splice(Ha,Hb-Ha);for(var He=0,Hf=Hd.length;He<Hf;He++)this._removeChild3D(Hd[He]),Hd[He].parent=null,this.conchModel&&this.conchModel.removeChild(Hd[He].conchModel)}return this},Hc.onAsynLoaded=function(Ha,Hb,Hc){var Hd=Hb[0];if("Sprite3D"!==Hd.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var He=Hb[1];Hqb._createNodeByJson(this,Hd,this,He),this.event("hierarchyloaded",[this]),this.__loaded=!0},Hc.cloneTo=function(Ha){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var Hb=Ha;Hb.name=this.name,Hb._destroyed=this._destroyed,Hb.timer=this.timer,Hb._$P=this._$P,Hb.active=this._active;var Hc=Hb.transform.localPosition;this.transform.localPosition.cloneTo(Hc),Hb.transform.localPosition=Hc;var Hd=Hb.transform.localRotation;this.transform.localRotation.cloneTo(Hd),Hb.transform.localRotation=Hd;var He=Hb.transform.localScale;this.transform.localScale.cloneTo(He),Hb.transform.localScale=He,Hb.isStatic=this.isStatic;var Hf=0,Hg=0;for(Hf=0,Hg=this._componentsMap.length;Hf<Hg;Hf++){var Hh=Hb.addComponent(this._componentsMap[Hf]);this._components[Hf]._cloneTo(Hh)}for(Hf=0,Hg=this._childs.length;Hf<Hg;Hf++)Hb.addChild(this._childs[Hf].clone());var Hi=Hb.getComponentByType(Animator);if(Hi){var Hj=Hi._linkSpritesData;if(Hj)for(var Hk in Hj){for(var Hl=Hj[Hk],Hm=Hb,Hn=0,Ho=Hl.length;Hn<Ho&&(Hm=Hm.getChildByName(Hl[Hn]));Hn++);if(Hm){var Hp=Hi._avatarNodeMap[Hk];Hm._isLinkSpriteToAnimationNode(Hi,Hp,!0)}}}},Hc.clone=function(){var Ha=new this.constructor;return this.cloneTo(Ha),Ha},Hc.destroy=function(Ha){if(void 0===Ha&&(Ha=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,Ha);var Hb,Hc=0;for(Hc=0,Hb=this._components.length;Hc<Hb;Hc++)this._components[Hc]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,Hr.clearRes(this.url),this.loaded||Hrb._cancelLoadByUrl(this.url)}},Hc._handleSpriteToAvatar=function(Ha,Hb){Ha._avatarNodes;var Hc=Ha._avatarNodeMap[this.name];Hc&&Hc.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(Ha,Hc,Hb)},Hc._setAnimatorToLinkAvatar=function(Ha,Hb){this._handleSpriteToAvatar(Ha,Hb);for(var Hc=0,Hd=this._childs.length;Hc<Hd;Hc++){this._childs[Hc]._setAnimatorToLinkAvatar(Ha,Hb)}},Ho(0,Hc,"activeInHierarchy",function(){return this._activeInHierarchy}),Ho(0,Hc,"_loaded",null,function(Ha){this.__loaded=Ha}),Ho(0,Hc,"active",function(){return this._active},function(Ha){this._active!==Ha&&(this._active=Ha,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(Ha?this._activeHierarchy():this._inActiveHierarchy()))}),Ho(0,Hc,"componentsCount",function(){return this._components.length}),Ho(0,Hc,"loaded",function(){return this.__loaded}),Ho(0,Hc,"id",function(){return this._id}),Ho(0,Hc,"url",function(){return this._url}),Ho(0,Hc,"layer",function(){return this._layer},function(Ha){if(this._layer!==Ha){if(!Ha)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var Hb=0,Hc=this._colliders.length;if(this._layer)for(Hb=0;Hb<Hc;Hb++)this._layer._removeCollider(this._colliders[Hb]);for(Hb=0;Hb<Hc;Hb++)Ha._addCollider(this._colliders[Hb])}this._layer=Ha,this.event("layerchanged",Ha)}}),Ho(0,Hc,"scene",function(){return this._scene}),Ho(0,Hc,"transform",function(){return this._transform}),Hb.instantiate=function(Ha,Hb,Hc,Hd,He){void 0===Hc&&(Hc=!0);var Hf=Ha.clone();Hb&&Hb.addChild(Hf);var Hg=Hf.transform;if(Hc){var Hh=Hg.worldMatrix;Ha.transform.worldMatrix.cloneTo(Hh),Hg.worldMatrix=Hh}else Hd&&(Hg.position=Hd),He&&(Hg.rotation=He);return Hf},Hb.load=function(Ha){return Hv.loader.create(Ha,null,null,Hb)},Hb.WORLDMATRIX=0,Hb.MVPMATRIX=1,Hb._uniqueIDCounter=0,Hb._nameNumberCounter=0,Hb}(),HJb=function(Ha){function Hk(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],Hk.__super.call(this),!Ha||!Hb)throw"Shader Error";this._id=++Hk._count,this._vs=Ha,this._ps=Hb,this._attributeMap=Hc,this._sceneUniformMap=Hd,this._cameraUniformMap=He,this._spriteUniformMap=Hf,this._materialUniformMap=Hg,this._renderElementUniformMap=Hh,this._precompile=Hi,this._define=Hj,this._precompile&&Hk.extCompileObj&&Hk.extCompileFunc?Hk.extCompileFunc.call(Hk.extCompileObj,Ha,Hb,Hj):this.recreateResource()}Hn(Hk,"laya.d3.shader.Shader3D",Hc);var Hb=Hk.prototype;return Hb.recreateResource=function(){HF.now();this._compile(),this.completeCreate(),this.memorySize=0},Hb.disposeResource=function(){HD.mainContext.deleteShader(this._vshader),HD.mainContext.deleteShader(this._pshader),HD.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},Hb._compile=function(){if(!HD.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var Ha=[this._vs,this._ps],Hb=HD.mainContext;if(this._program=Hb.createProgram(),this._vshader=Hk._createShader(Hb,Ha[0],35633),this._pshader=Hk._createShader(Hb,Ha[1],35632),Hb.attachShader(this._program,this._vshader),Hb.attachShader(this._program,this._pshader),Hb.linkProgram(this._program),!Hp.isConchApp&&Hyb.debugMode&&!Hb.getProgramParameter(this._program,35714))throw Hb.getProgramInfoLog(this._program);var Hc,Hd=0,He=0,Hf=0;for(Hf=Hp.isConchApp?Hb.getProgramParameterEx(this._vs,this._ps,"",35721):Hb.getProgramParameter(this._program,35721),Hd=0;Hd<Hf;Hd++){var Hg=null;Hc={vartype:"attribute",ivartype:0,attrib:Hg=Hp.isConchApp?Hb.getActiveAttribEx(this._vs,this._ps,"",Hd):Hb.getActiveAttrib(this._program,Hd),location:Hb.getAttribLocation(this._program,Hg.name),name:Hg.name,type:Hg.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(Hc)}var Hh=0;for(Hh=Hp.isConchApp?Hb.getProgramParameterEx(this._vs,this._ps,"",35718):Hb.getProgramParameter(this._program,35718),Hd=0;Hd<Hh;Hd++){var Hi=null;Hi=Hp.isConchApp?Hb.getActiveUniformEx(this._vs,this._ps,"",Hd):Hb.getActiveUniform(this._program,Hd),0<(Hc={vartype:"uniform",ivartype:1,attrib:Hg,location:Hb.getUniformLocation(this._program,Hi.name),name:Hi.name,type:Hi.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(Hc.name=Hc.name.substr(0,Hc.name.length-3),Hc.isArray=!0,Hc.location=Hb.getUniformLocation(this._program,Hc.name)),this._uniformParams.push(Hc)}for(Hd=0,He=this._attributeParams.length;Hd<He;Hd++)(Hc=this._attributeParams[Hd]).indexOfParams=Hd,Hc.index=1,Hc.value=[Hc.location,null],Hc.codename=Hc.name,Hc.name=null!=this._attributeMap[Hc.codename]?this._attributeMap[Hc.codename]:Hc.codename,this._attributeParamsMap.push(Hc.name),this._attributeParamsMap.push(Hc),Hc._this=this,Hc.uploadedValue=[],Hc.fun=this._attribute;for(Hd=0,He=this._uniformParams.length;Hd<He;Hd++)switch((Hc=this._uniformParams[Hd]).indexOfParams=Hd,Hc.index=1,Hc.value=[Hc.location,null],Hc.codename=Hc.name,null!=this._sceneUniformMap[Hc.codename]?(Hc.name=this._sceneUniformMap[Hc.codename],this._sceneUniformParamsMap.push(Hc.name),this._sceneUniformParamsMap.push(Hc)):null!=this._cameraUniformMap[Hc.codename]?(Hc.name=this._cameraUniformMap[Hc.codename],this._cameraUniformParamsMap.push(Hc.name),this._cameraUniformParamsMap.push(Hc)):null!=this._spriteUniformMap[Hc.codename]?(Hc.name=this._spriteUniformMap[Hc.codename],this._spriteUniformParamsMap.push(Hc.name),this._spriteUniformParamsMap.push(Hc)):null!=this._materialUniformMap[Hc.codename]?(Hc.name=this._materialUniformMap[Hc.codename],this._materialUniformParamsMap.push(Hc.name),this._materialUniformParamsMap.push(Hc)):null!=this._renderElementUniformMap[Hc.codename]?(Hc.name=this._renderElementUniformMap[Hc.codename],this._renderElementUniformParamsMap.push(Hc.name),this._renderElementUniformParamsMap.push(Hc)):console.log("Shader:can't find uinform name:"+Hc.codename+" in shader file."),Hc._this=this,Hc.uploadedValue=[],Hc.type){case 5124:Hc.fun=Hc.isArray?this._uniform1iv:this._uniform1i;break;case 5126:Hc.fun=Hc.isArray?this._uniform1fv:this._uniform1f;break;case 35664:Hc.fun=Hc.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:Hc.fun=Hc.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:Hc.fun=Hc.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:Hc.fun=this._uniform_sampler2D;break;case 35680:Hc.fun=this._uniform_samplerCube;break;case 35676:Hc.fun=this._uniformMatrix4fv;break;case 35670:Hc.fun=this._uniform1i;break;case 35674:Hc.fun=this._uinformMatrix2fv;break;case 35675:Hc.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},Hb._attribute=function(Ha,Hb){var Hc=HD.mainContext,Hd=Hh._enableAtributes,He=Ha.location;return Hd[He]||Hc.enableVertexAttribArray(He),Hc.vertexAttribPointer(He,Hb[0],Hb[1],Hb[2],Hb[3],Hb[4]),Hd[He]=Hh._bindVertexBuffer,1},Hb._uniform1f=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb?(HD.mainContext.uniform1f(Ha.location,Hc[0]=Hb),1):0},Hb._uniform1fv=function(Ha,Hb){if(Hb.length<4){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]||Hc[2]!==Hb[2]||Hc[3]!==Hb[3]?(HD.mainContext.uniform1fv(Ha.location,Hb),Hc[0]=Hb[0],Hc[1]=Hb[1],Hc[2]=Hb[2],Hc[3]=Hb[3],1):0}return HD.mainContext.uniform1fv(Ha.location,Hb),1},Hb._uniform_vec2=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]?(HD.mainContext.uniform2f(Ha.location,Hc[0]=Hb[0],Hc[1]=Hb[1]),1):0},Hb._uniform_vec2v=function(Ha,Hb){if(Hb.length<2){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]||Hc[2]!==Hb[2]||Hc[3]!==Hb[3]?(HD.mainContext.uniform2fv(Ha.location,Hb),Hc[0]=Hb[0],Hc[1]=Hb[1],Hc[2]=Hb[2],Hc[3]=Hb[3],1):0}return HD.mainContext.uniform2fv(Ha.location,Hb),1},Hb._uniform_vec3=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]||Hc[2]!==Hb[2]?(HD.mainContext.uniform3f(Ha.location,Hc[0]=Hb[0],Hc[1]=Hb[1],Hc[2]=Hb[2]),1):0},Hb._uniform_vec3v=function(Ha,Hb){return HD.mainContext.uniform3fv(Ha.location,Hb),1},Hb._uniform_vec4=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]||Hc[2]!==Hb[2]||Hc[3]!==Hb[3]?(HD.mainContext.uniform4f(Ha.location,Hc[0]=Hb[0],Hc[1]=Hb[1],Hc[2]=Hb[2],Hc[3]=Hb[3]),1):0},Hb._uniform_vec4v=function(Ha,Hb){return HD.mainContext.uniform4fv(Ha.location,Hb),1},Hb._uniformMatrix2fv=function(Ha,Hb){return HD.mainContext.uniformMatrix2fv(Ha.location,!1,Hb),1},Hb._uniformMatrix3fv=function(Ha,Hb){return HD.mainContext.uniformMatrix3fv(Ha.location,!1,Hb),1},Hb._uniformMatrix4fv=function(Ha,Hb){return HD.mainContext.uniformMatrix4fv(Ha.location,!1,Hb),1},Hb._uinformMatrix2fv=function(Ha,Hb){return HD.mainContext.uniformMatrix2fv(Ha.location,!1,Hb),1},Hb._uinformMatrix3fv=function(Ha,Hb){return HD.mainContext.uniformMatrix3fv(Ha.location,!1,Hb),1},Hb._uniform1i=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb?(HD.mainContext.uniform1i(Ha.location,Hc[0]=Hb),1):0},Hb._uniform1iv=function(Ha,Hb){return HD.mainContext.uniform1iv(Ha.location,Hb),1},Hb._uniform_ivec2=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]?(HD.mainContext.uniform2i(Ha.location,Hc[0]=Hb[0],Hc[1]=Hb[1]),1):0},Hb._uniform_ivec2v=function(Ha,Hb){return HD.mainContext.uniform2iv(Ha.location,Hb),1},Hb._uniform_vec3i=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]||Hc[2]!==Hb[2]?(HD.mainContext.uniform3i(Ha.location,Hc[0]=Hb[0],Hc[1]=Hb[1],Hc[2]=Hb[2]),1):0},Hb._uniform_vec3vi=function(Ha,Hb){return HD.mainContext.uniform3iv(Ha.location,Hb),1},Hb._uniform_vec4i=function(Ha,Hb){var Hc=Ha.uploadedValue;return Hc[0]!==Hb[0]||Hc[1]!==Hb[1]||Hc[2]!==Hb[2]||Hc[3]!==Hb[3]?(HD.mainContext.uniform4i(Ha.location,Hc[0]=Hb[0],Hc[1]=Hb[1],Hc[2]=Hb[2],Hc[3]=Hb[3]),1):0},Hb._uniform_vec4vi=function(Ha,Hb){return HD.mainContext.uniform4iv(Ha.location,Hb),1},Hb._uniform_sampler2D=function(Ha,Hb){var Hc=Hb.source||Hb.defaulteTexture.source,Hd=HD.mainContext,He=Ha.uploadedValue;if(null!=He[0])return Hd.activeTexture(Hk._TEXTURES[He[0]]),Hc&&HE.bindTexture(Hd,3553,Hc),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return He[0]=this._curActTexIndex,Hd.uniform1i(Ha.location,this._curActTexIndex),Hd.activeTexture(Hk._TEXTURES[this._curActTexIndex]),Hc&&HE.bindTexture(Hd,3553,Hc),this._curActTexIndex++,1},Hb._uniform_samplerCube=function(Ha,Hb){var Hc=Hb.source||Hb.defaulteTexture.source,Hd=HD.mainContext,He=Ha.uploadedValue;if(null!=He[0])return Hd.activeTexture(Hk._TEXTURES[He[0]]),Hc?HE.bindTexture(Hd,34067,Hc):HE.bindTexture(Hd,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return He[0]=this._curActTexIndex,Hd.uniform1i(Ha.location,this._curActTexIndex),Hd.activeTexture(Hk._TEXTURES[this._curActTexIndex]),Hc?HE.bindTexture(Hd,34067,Hc):HE.bindTexture(Hd,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},Hb._noSetValue=function(Ha){console.log("no....:"+Ha.name)},Hb.bind=function(){return Hc.activeShader=this,(Hc.bindShader=this).activeResource(),HE.UseProgram(this._program)},Hb.uploadAttributes=function(Ha,Hb){for(var Hc,Hd,He=0,Hf=0,Hg=this._attributeParamsMap.length;Hf<Hg;Hf+=2)Hd=this._attributeParamsMap[Hf+1],null!=(Hc=Ha[this._attributeParamsMap[Hf]])&&(Hb&&Hb[Hd.name]&&Hb[Hd.name].bind(),He+=Hd.fun.call(this,Hd,Hc));Hy.shaderCall+=He},Hb.uploadAttributesX=function(Ha,Hb){for(var Hc,Hd,He=0,Hf=0,Hg=this._attributeParamsMap.length;Hf<Hg;Hf+=2)Hd=this._attributeParamsMap[Hf+1],null!=(Hc=Ha[this._attributeParamsMap[Hf]])&&(Hb._bind(),He+=Hd.fun.call(this,Hd,Hc));Hy.shaderCall+=He},Hb.uploadSceneUniforms=function(Ha){for(var Hb,Hc,Hd=0,He=0,Hf=this._sceneUniformParamsMap.length;He<Hf;He+=2)Hc=this._sceneUniformParamsMap[He+1],null!=(Hb=Ha[this._sceneUniformParamsMap[He]])&&(Hd+=Hc.fun.call(this,Hc,Hb));Hy.shaderCall+=Hd},Hb.uploadCameraUniforms=function(Ha){for(var Hb,Hc,Hd=0,He=0,Hf=this._cameraUniformParamsMap.length;He<Hf;He+=2)Hc=this._cameraUniformParamsMap[He+1],null!=(Hb=Ha[this._cameraUniformParamsMap[He]])&&(Hd+=Hc.fun.call(this,Hc,Hb));Hy.shaderCall+=Hd},Hb.uploadSpriteUniforms=function(Ha){for(var Hb,Hc,Hd=0,He=0,Hf=this._spriteUniformParamsMap.length;He<Hf;He+=2)Hc=this._spriteUniformParamsMap[He+1],null!=(Hb=Ha[this._spriteUniformParamsMap[He]])&&(Hd+=Hc.fun.call(this,Hc,Hb));Hy.shaderCall+=Hd},Hb.uploadMaterialUniforms=function(Ha){for(var Hb,Hc,Hd=0,He=0,Hf=this._materialUniformParamsMap.length;He<Hf;He+=2)Hc=this._materialUniformParamsMap[He+1],null!=(Hb=Ha[this._materialUniformParamsMap[He]])&&(Hd+=Hc.fun.call(this,Hc,Hb));Hy.shaderCall+=Hd},Hb.uploadRenderElementUniforms=function(Ha){for(var Hb,Hc,Hd=0,He=0,Hf=this._renderElementUniformParamsMap.length;He<Hf;He+=2)Hc=this._renderElementUniformParamsMap[He+1],null!=(Hb=Ha[this._renderElementUniformParamsMap[He]])&&(Hd+=Hc.fun.call(this,Hc,Hb));Hy.shaderCall+=Hd},Hk.create=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){return new Hk(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj)},Hk.addInclude=function(Ha,Hb){Ht.addInclude(Ha,Hb)},Hk._createShader=function(Ha,Hb,Hc){var Hd=Ha.createShader(Hc);if(Ha.shaderSource(Hd,Hb),Ha.compileShader(Hd),Hyb.debugMode&&!Ha.getShaderParameter(Hd,35713))throw Ha.getShaderInfoLog(Hd);return Hd},Hk.PERIOD_RENDERELEMENT=0,Hk.PERIOD_MATERIAL=1,Hk.PERIOD_SPRITE=2,Hk.PERIOD_CAMERA=3,Hk.PERIOD_SCENE=4,Hk._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],Hk._count=0,Hk._preCompile=!1,Hk.extCompileFunc=null,Hk.extCompileObj=null,Hl(Hk,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new Hz}]),Hk}(),HKb=function(Hh){function Hi(){this._transformUV=null,Hi.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new Hgb(.6,.6,.6)),this._setColor(10,new Hgb(1,1,1)),this._setColor(11,new Hhb(1,1,1,8)),this._setColor(12,new Hgb(1,1,1)),this._setColor(7,new Hhb(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new Hhb(1,1,0,0)),this.renderMode=1}Hn(Hi,"laya.d3.core.material.StandardMaterial",Hh);var Ha=Hi.prototype;return Ha.disableLight=function(){this._addDisablePublicShaderDefine(Hyb.SHADERDEFINE_POINTLIGHT|Hyb.SHADERDEFINE_SPOTLIGHT|Hyb.SHADERDEFINE_DIRECTIONLIGHT)},Ha.disableFog=function(){this._addDisablePublicShaderDefine(Hyb.SHADERDEFINE_FOG)},Ha.onAsynLoaded=function(Ha,Hb,Hc){var Hd=Hb[0];if(Hd.version)Hh.prototype.onAsynLoaded.call(this,Ha,Hb,Hc);else{var He=Hb[1],Hf=Hd.props;for(var Hg in Hf)this[Hg]=Hf[Hg];Hi._parseStandardMaterial(He,this,Hd),this._endLoaded()}},Ha.cloneTo=function(Ha){Hh.prototype.cloneTo.call(this,Ha);var Hb=Ha;this._transformUV&&(Hb._transformUV=this._transformUV.clone())},Ho(0,Ha,"ambientColor",function(){return this._getColor(9)},function(Ha){this._setColor(9,Ha)}),Ho(0,Ha,"ambientTexture",function(){return this._getTexture(5)},function(Ha){Ha?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,Ha)}),Ho(0,Ha,"renderMode",null,function(Ha){switch(Ha){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Hi.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(Ha)}),Ho(0,Ha,"reflectColor",function(){return this._getColor(12)},function(Ha){this._setColor(12,Ha)}),Ho(0,Ha,"tilingOffset",function(){return this._getColor(15)},function(Ha){if(Ha){var Hb=Ha.elements;1!=Hb[0]||1!=Hb[1]||0!=Hb[2]||0!=Hb[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,Ha)}),Ho(0,Ha,"albedo",function(){return this._getColor(7)},function(Ha){this._setColor(7,Ha)}),Ho(0,Ha,"diffuseColor",function(){return this._getColor(10)},function(Ha){this._setColor(10,Ha)}),Ho(0,Ha,"albedoColor",function(){return this._getColor(7)},function(Ha){this._setColor(7,Ha)}),Ho(0,Ha,"specularColor",function(){return this._getColor(11)},function(Ha){this._setColor(11,Ha)}),Ho(0,Ha,"diffuseTexture",function(){return this._getTexture(1)},function(Ha){Ha?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,Ha)}),Ho(0,Ha,"normalTexture",function(){return this._getTexture(2)},function(Ha){Ha?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,Ha)}),Ho(0,Ha,"specularTexture",function(){return this._getTexture(3)},function(Ha){Ha?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,Ha)}),Ho(0,Ha,"emissiveTexture",function(){return this._getTexture(4)},function(Ha){Ha?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,Ha)}),Ho(0,Ha,"reflectTexture",function(){return this._getTexture(6)},function(Ha){Ha?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,Ha)}),Ho(0,Ha,"transformUV",function(){return this._transformUV},function(Ha){this._transformUV=Ha,this._setMatrix4x4(13,Ha.matrix),Ha?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,Ha.matrix.elements,0)}),Hi.__init__=function(){Hi.SHADERDEFINE_DIFFUSEMAP=Hi.shaderDefines.registerDefine("DIFFUSEMAP"),Hi.SHADERDEFINE_NORMALMAP=Hi.shaderDefines.registerDefine("NORMALMAP"),Hi.SHADERDEFINE_SPECULARMAP=Hi.shaderDefines.registerDefine("SPECULARMAP"),Hi.SHADERDEFINE_EMISSIVEMAP=Hi.shaderDefines.registerDefine("EMISSIVEMAP"),Hi.SHADERDEFINE_AMBIENTMAP=Hi.shaderDefines.registerDefine("AMBIENTMAP"),Hi.SHADERDEFINE_REFLECTMAP=Hi.shaderDefines.registerDefine("REFLECTMAP"),Hi.SHADERDEFINE_UVTRANSFORM=Hi.shaderDefines.registerDefine("UVTRANSFORM"),Hi.SHADERDEFINE_TILINGOFFSET=Hi.shaderDefines.registerDefine("TILINGOFFSET"),Hi.SHADERDEFINE_ADDTIVEFOG=Hi.shaderDefines.registerDefine("ADDTIVEFOG")},Hi.load=function(Ha){return Hv.loader.create(Ha,null,null,Hi)},Hi._parseStandardMaterial=function(Ha,Hb,Hc){var Hd=Hc.customProps,He=Hd.ambientColor;Hb.ambientColor=new Hgb(He[0],He[1],He[2]);var Hf=Hd.diffuseColor;Hb.diffuseColor=new Hgb(Hf[0],Hf[1],Hf[2]);var Hg=Hd.specularColor;Hb.specularColor=new Hhb(Hg[0],Hg[1],Hg[2],Hg[3]);var Hh=Hd.reflectColor;Hb.reflectColor=new Hgb(Hh[0],Hh[1],Hh[2]);var Hi=Hd.albedoColor;Hi&&(Hb.albedo=new Hhb(Hi[0],Hi[1],Hi[2],Hi[3]));var Hj=Hd.diffuseTexture.texture2D;Hj&&(Hb.diffuseTexture=Hr.getRes(Ha[Hj]));var Hk=Hd.normalTexture.texture2D;Hk&&(Hb.normalTexture=Hr.getRes(Ha[Hk]));var Hl=Hd.specularTexture.texture2D;Hl&&(Hb.specularTexture=Hr.getRes(Ha[Hl]));var Hm=Hd.emissiveTexture.texture2D;Hm&&(Hb.emissiveTexture=Hr.getRes(Ha[Hm]));var Hn=Hd.ambientTexture.texture2D;Hn&&(Hb.ambientTexture=Hr.getRes(Ha[Hn]));var Ho=Hd.reflectTexture.texture2D;Ho&&(Hb.reflectTexture=Hr.getRes(Ha[Ho]))},Hi.RENDERMODE_OPAQUE=1,Hi.RENDERMODE_OPAQUEDOUBLEFACE=2,Hi.RENDERMODE_CUTOUT=3,Hi.RENDERMODE_CUTOUTDOUBLEFACE=4,Hi.RENDERMODE_TRANSPARENT=13,Hi.RENDERMODE_TRANSPARENTDOUBLEFACE=14,Hi.RENDERMODE_ADDTIVE=15,Hi.RENDERMODE_ADDTIVEDOUBLEFACE=16,Hi.RENDERMODE_DEPTHREAD_TRANSPARENT=5,Hi.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,Hi.RENDERMODE_DEPTHREAD_ADDTIVE=7,Hi.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,Hi.RENDERMODE_NONDEPTH_TRANSPARENT=9,Hi.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,Hi.RENDERMODE_NONDEPTH_ADDTIVE=11,Hi.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,Hi.SHADERDEFINE_DIFFUSEMAP=0,Hi.SHADERDEFINE_NORMALMAP=0,Hi.SHADERDEFINE_SPECULARMAP=0,Hi.SHADERDEFINE_EMISSIVEMAP=0,Hi.SHADERDEFINE_AMBIENTMAP=0,Hi.SHADERDEFINE_REFLECTMAP=0,Hi.SHADERDEFINE_UVTRANSFORM=0,Hi.SHADERDEFINE_TILINGOFFSET=0,Hi.SHADERDEFINE_ADDTIVEFOG=0,Hi.DIFFUSETEXTURE=1,Hi.NORMALTEXTURE=2,Hi.SPECULARTEXTURE=3,Hi.EMISSIVETEXTURE=4,Hi.AMBIENTTEXTURE=5,Hi.REFLECTTEXTURE=6,Hi.ALBEDO=7,Hi.UVANIAGE=8,Hi.MATERIALAMBIENT=9,Hi.MATERIALDIFFUSE=10,Hi.MATERIALSPECULAR=11,Hi.MATERIALREFLECT=12,Hi.UVMATRIX=13,Hi.UVAGE=14,Hi.TILINGOFFSET=15,Hl(Hi,["defaultMaterial",function(){var Ha=new Hi;return Ha.lock=!0,this.defaultMaterial=Ha},"shaderDefines",function(){return this.shaderDefines=new Hkb(HCb.shaderDefines)}]),Hi}(HCb),HLb=function(Ha){function Hg(Ha,Hb,Hc,Hd,He){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===Hc&&(Hc=35044),void 0===Hd&&(Hd=!1),Hg.__super.call(this),this._indexType=Ha,this._indexCount=Hb,this._bufferUsage=Hc,this._bufferType=34963,this._canRead=Hd;var Hf;if("ushort"==Ha)this._indexTypeByteCount=2;else{if("ubyte"!=Ha)throw new Error("unidentification index type.");this._indexTypeByteCount=1}Hf=this._indexTypeByteCount*Hb,this._byteLength=Hf,this._bind(),Hh._gl.bufferData(this._bufferType,Hf,this._bufferUsage),this.uri=He,Hd?("ushort"==Ha?this._buffer=new Uint16Array(Hb):"ubyte"==Ha&&(this._buffer=new Uint8Array(Hb)),this.memorySize=2*Hf):this.memorySize=Hf}Hn(Hg,"laya.d3.graphics.IndexBuffer3D",Ha);var Hb=Hg.prototype;return Hb.setData=function(Ha,Hb,Hc,Hd){void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=4294967295);var He=0;if("ushort"==this._indexType?(He=2,0===Hc&&4294967295===Hd||(Ha=new Uint16Array(Ha.buffer,Hc*He,Hd))):"ubyte"==this._indexType&&(He=1,0===Hc&&4294967295===Hd||(Ha=new Uint8Array(Ha.buffer,Hc*He,Hd))),this._bind(),Hh._gl.bufferSubData(this._bufferType,Hb*He,Ha),this._canRead)if(0!==Hb||0!==Hc||4294967295!==Hd){var Hf=this._buffer.length-Hb;Hf<Hd&&(Hd=Hf);for(var Hg=0;Hg<Hd;Hg++)this._buffer[Hb+Hg]=Ha[Hg]}else this._buffer=Ha},Hb.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},Hb.disposeResource=function(){Ha.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},Ho(0,Hb,"indexType",function(){return this._indexType}),Ho(0,Hb,"indexTypeByteCount",function(){return this._indexTypeByteCount}),Ho(0,Hb,"indexCount",function(){return this._indexCount}),Ho(0,Hb,"canRead",function(){return this._canRead}),Hg.INDEXTYPE_UBYTE="ubyte",Hg.INDEXTYPE_USHORT="ushort",Hg.create=function(Ha,Hb,Hc,Hd,He){return void 0===Hc&&(Hc=35044),void 0===Hd&&(Hd=!1),new Hg(Ha,Hb,Hc,Hd,He)},Hg}(Hh),HMb=function(Hf){function Hg(Ha,Hb,Hc,Hd,He){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===Hd&&(Hd=!1),Hg.__super.call(this),this._vertexDeclaration=Ha,this._vertexCount=Hb,this._bufferUsage=Hc,this._bufferType=34962,this._canRead=Hd,this.uri=He,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*Hb,this._bind(),Hh._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),Hd&&(this._buffer=new Float32Array(this._byteLength/4))}Hn(Hg,"laya.d3.graphics.VertexBuffer3D",Hf);var Ha=Hg.prototype;return Ha.bindWithIndexBuffer=function(Ha){Ha&&Ha._bind(),this._bind()},Ha.setData=function(Ha,Hb,Hc,Hd){if(void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=4294967295),0===Hc&&4294967295===Hd||(Ha=new Float32Array(Ha.buffer,4*Hc,Hd)),this._bind(),Hh._gl.bufferSubData(this._bufferType,4*Hb,Ha),this._canRead)if(0!==Hb||0!==Hc||4294967295!==Hd){var He=this._buffer.length-Hb;He<Hd&&(Hd=He);for(var Hf=0;Hf<Hd;Hf++)this._buffer[Hb+Hf]=Ha[Hf]}else this._buffer=Ha},Ha.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},Ha.disposeResource=function(){for(var Ha=HD.mainContext,Hb=this._vertexDeclaration.getVertexElements(),Hc=Hh._enableAtributes,Hd=0,He=Hb.length;Hd<He;Hd++)Hc[Hd]===this._glBuffer&&(Ha.disableVertexAttribArray(Hd),Hc[Hd]=null);Hf.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},Ho(0,Ha,"vertexDeclaration",function(){return this._vertexDeclaration}),Ho(0,Ha,"vertexCount",function(){return this._vertexCount}),Ho(0,Ha,"canRead",function(){return this._canRead}),Hg.create=function(Ha,Hb,Hc,Hd,He){return void 0===Hc&&(Hc=35044),void 0===Hd&&(Hd=!1),new Hg(Ha,Hb,Hc,Hd,He)},Hg}(Hh),HNb=function(Ha){function Ht(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,Ht.__super.call(this),this._type=3553}Hn(Ht,"laya.d3.resource.DataTexture2D",HDb);var Hb=Ht.prototype;return Hb.genDebugMipmaps=function(){var Ha=[];return Ha.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),Ha.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),Ha.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),Ha.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),Ha.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),Ha.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),Ha.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),Ha.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),Ha.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),Ha.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),Ha},Hb._onTextureLoaded=function(Ha){},Hb._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var Ha=HD.mainContext,Hb=this._source=Ha.createTexture(),Hc=this._width,Hd=this._height,He=HE.curBindTexTarget,Hf=HE.curBindTexValue,Hg=!1;if(HE.bindTexture(Ha,this._type,Hb),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var Hh=0;Ha.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var Hi=0;Hi<this._mipmaps.length;Hi++){if(this._mipmaps[Hi].byteLength!=Hj*Hk*4)throw"mipmap size error  level:"+Hi;Ha.texSubImage2D(this._type,0,Ht.simLodRect[Hh++],Ht.simLodRect[Hh++],Ht.simLodRect[Hh++],Ht.simLodRect[Hh++],6408,5121,new Uint8Array(this._mipmaps[Hi]))}this.minFifter=9729,this.magFifter=9729}else{var Hj=this._width,Hk=this._height;for(Hh=0,Ha.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),Hi=0;Hi<this._mipmaps.length;Hi++){if(this._mipmaps[Hi].byteLength!=Hj*Hk*4)throw"mipmap size error  level:"+Hi;Ha.texImage2D(this._type,Hi,6408,Hj,Hk,0,6408,5121,new Uint8Array(this._mipmaps[Hi])),(Hj/=2)<1&&(Hj=1),(Hk/=2)<1&&(Hk=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&Ha.pixelStorei(Ha.UNPACK_ALIGNMENT,1),Ha.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var Hl=0,Hm=!1,Hn=!1;this._buffer.byteLength==4*Hc*Hd?(Hl=6408,Hm=!0):this._buffer.byteLength==3*Hc*Hd?(Hl=6407,Hn=!0):Hl=this._format,Hm||Hn?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),Hn&&Ha.pixelStorei(Ha.UNPACK_ALIGNMENT,1),Ha.texImage2D(this._type,0,Hl,Hc,Hd,0,Hl,5121,this._buffer)):Ha&&Hl==Ha.ALPHA?(Ha.texImage2D(3553,0,Hl,Hc,Hd,0,Hl,Ha.UNSIGNED_BYTE,this._buffer),Hg=!0):0!=Hl&&(Ha.compressedTexImage2D(3553,0,Hl,Hc,Hd,0,this._buffer),Hg=!0)}var Ho=this._minFifter,Hp=this._magFifter,Hq=0==this._wrapModeU?10497:33071,Hr=0==this._wrapModeV?10497:33071,Hs=Hu.isPOT(Hc,Hd);Hs?(this._mipmap||this._mipmaps?-1!==Ho||(Ho=9987):-1!==Ho||(Ho=9729),-1!==Hp||(Hp=9729),Ha.texParameteri(this._type,10241,Ho),Ha.texParameteri(this._type,10240,Hp),Ha.texParameteri(this._type,10242,Hq),Ha.texParameteri(this._type,10243,Hr),this._mipmap&&Ha.generateMipmap(this._type)):(-1!==Ho||(Ho=9729),-1!==Hp||(Hp=9729),Ha.texParameteri(this._type,10241,Ho),Ha.texParameteri(this._type,10240,Hp),Ha.texParameteri(this._type,10242,33071),Ha.texParameteri(this._type,10243,33071)),He&&Hf&&HE.bindTexture(Ha,He,Hf),this.memorySize=Hg?this._buffer.length:Hs?Hc*Hd*4*(1+1/3):Hc*Hd*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},Hb.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},Hb.onAsynLoaded=function(Ha,Hb,Hc){var Hd;Hc&&(Hd=Hc[0].call(this,Hb)),Hd&&(this._width=Hd.width,this._height=Hd.height,this._buffer=Hd.data),this._src=Ha,this._size=new Hpb(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},Hb.getPixels=function(){return new Uint8Array(this._buffer)},Hb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(HD.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},Ho(0,Hb,"src",function(){return this._src}),Ht.create=function(Ha,Hb,Hc,Hd,He,Hf,Hg){if(void 0===Hd&&(Hd=9729),void 0===He&&(He=9729),void 0===Hf&&(Hf=!0),!Ha||Ha.byteLength<Hb*Hc*4)throw"DataTexture2D create error";var Hh=new Ht;return Hh.uri=Hg,Hh._buffer=Ha,Hh._width=Hb,Hh._height=Hc,Hh._mipmap=Hf,Hh._magFifter=Hd,Hh._minFifter=He,Hh._size=new Hpb(Hh._width,Hh._height),Hh._conchTexture?alert("怎么给runtime传递datatexture数据"):Hh.activeResource(),Hh},Ht.load=function(Ha,Hb,Hc,Hd,He){if(void 0===Hb&&(Hb=0),void 0===Hc&&(Hc=0),void 0===Hd&&(Hd=9729),void 0===He&&(He=9729),"mipmaps"===HA.getFileExtension(Ha)){var Hf=Hv.loader.create(Ha,null,null,Ht,[function(Ha){this._mipmaps=[];var Hb=new Uint32Array(Ha);this._width=Hb[0];var Hc=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,Hc=1024),this._width!=Hc)throw"现在只支持512x256的环境贴图。当前的是"+Hb[0];this._height=Hb[1];for(var Hd=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,He=this._height,Hf=8;;){var Hg=Hd*He*4;if(Hf+Hg>Ha.byteLength)throw"load mipmaps data size error ";var Hh=new Uint8Array(Ha,Hf,Hg);if(this._mipmaps.push(Hh),Hf+=Hg,1==Hd&&1==He)break;(Hd/=2)<1&&(Hd=1),(He/=2)<1&&(He=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){Hf.simLodInfo=new Float32Array(40);for(var Hg=0;Hg<Hf.simLodInfo.length;)Hf.simLodInfo[Hg]=(Ht.simLodRect[Hg]+.5)/1024,Hg++,Hf.simLodInfo[Hg]=(Ht.simLodRect[Hg]+.5)/256,Hg++,Hf.simLodInfo[Hg]=Math.max(Ht.simLodRect[Hg]-1,.1)/1024,Hg++,Hf.simLodInfo[Hg]=Math.max(Ht.simLodRect[Hg]-1.5,.1)/256,Hg++}return Hf}if("number"==typeof Hb)return Hv.loader.create(Ha,null,null,Ht,[function(Ha){return this._width=Hb,this._height=Hc,this._buffer=Ha,null}]);if("function"==typeof Hb)return Hv.loader.create(Ha,null,null,Ht,[Hb]);throw new Error("unknown params.")},Ht.lodasatlas=!1,Hl(Ht,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),Ht}(),HOb=function(Ha){function Hb(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,Hb.__super.call(this)}Hn(Hb,"laya.d3.resource.models.PrimitiveMesh",HEb);var Hc=Hb.prototype;return Hv.imps(Hc,{"laya.d3.core.render.IRenderable":!0}),Hc._getVertexBuffer=function(Ha){return void 0===Ha&&(Ha=0),0===Ha?this._vertexBuffer:null},Hc._getVertexBuffers=function(){return null},Hc._getIndexBuffer=function(){return this._indexBuffer},Hc._getPositions=function(){var Ha,Hb=[],Hc=this._vertexBuffer.vertexDeclaration.getVertexElements(),Hd=0;for(Hd=0;Hd<Hc.length;Hd++){var He=Hc[Hd];if("vector3"===He.elementFormat&&0===He.elementUsage){Ha=He;break}}var Hf=this._vertexBuffer.getData();for(Hd=0;Hd<Hf.length;Hd+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var Hg=Hd+Ha.offset/4,Hh=new Hgb(Hf[Hg+0],Hf[Hg+1],Hf[Hg+2]);Hb.push(Hh)}return Hb},Hc.getRenderElement=function(Ha){return this},Hc.getRenderElementsCount=function(){return 1},Hc.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},Hc._beforeRender=function(Ha){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Hc._render=function(Ha){HD.mainContext.drawElements(4,this._numberIndices,5123,0),Hy.drawCall++,Hy.trianglesFaces+=this._numberIndices/3},Ho(0,Hc,"_vertexBufferCount",function(){return 1}),Ho(0,Hc,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Hb}(),HPb=function(Ha){function Hb(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,Hb.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}Hn(Hb,"laya.d3.resource.models.Mesh",HEb);var Hc=Hb.prototype;return Hc._getPositions=function(){var Ha,Hb,Hc,Hd,He,Hf=[],Hg=0,Hh=0,Hi=0;if(0!==this._vertexBuffers.length){var Hj=this._vertexBuffers.length;for(Hg=0;Hg<Hj;Hg++){for(Hc=(Ha=this._vertexBuffers[Hg]).vertexDeclaration.getVertexElements(),Hh=0;Hh<Hc.length;Hh++)if("vector3"===(Hd=Hc[Hh]).elementFormat&&0===Hd.elementUsage){Hb=Hd;break}for(He=Ha.getData(),Hh=0;Hh<He.length;Hh+=Ha.vertexDeclaration.vertexStride/4)Hi=Hh+Hb.offset/4,Hf.push(new Hgb(He[Hi+0],He[Hi+1],He[Hi+2]))}}else{var Hk=this._subMeshes.length;for(Hg=0;Hg<Hk;Hg++){for(Hc=(Ha=this._subMeshes[Hg]._getVertexBuffer()).vertexDeclaration.getVertexElements(),Hh=0;Hh<Hc.length;Hh++)if("vector3"===(Hd=Hc[Hh]).elementFormat&&0===Hd.elementUsage){Hb=Hd;break}for(He=Ha.getData(),Hh=0;Hh<He.length;Hh+=Ha.vertexDeclaration.vertexStride/4)Hi=Hh+Hb.offset/4,Hf.push(new Hgb(He[Hi+0],He[Hi+1],He[Hi+2]))}}return Hf},Hc._setSubMeshes=function(Ha){this._subMeshes=Ha,this._subMeshCount=Ha.length;for(var Hb=0;Hb<this._subMeshCount;Hb++)Ha[Hb]._indexInMesh=Hb;this._positions=this._getPositions(),this._generateBoundingObject()},Hc.onAsynLoaded=function(Ha,Hb,Hc){var Hd=Hb[0],He=Hb[1];HWa.read(Hd,this,this._materials,this._subMeshes,He),this.completeCreate(),this._endLoaded()},Hc.getSubMesh=function(Ha){return this._subMeshes[Ha]},Hc.getSubMeshCount=function(){return this._subMeshes.length},Hc.getRenderElementsCount=function(){return this._subMeshes.length},Hc.getRenderElement=function(Ha){return this._subMeshes[Ha]},Hc.disposeResource=function(){for(var Ha=0;Ha<this._subMeshes.length;Ha++)this._subMeshes[Ha].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},Ho(0,Hc,"materials",function(){return this._materials.slice()}),Ho(0,Hc,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),Hb.load=function(Ha){return Hv.loader.create(Ha,null,null,Hb)},Hb}(),HQb=(function(Ha){function Hj(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===Hc&&(Hc=6408),void 0===Hd&&(Hd=5121),void 0===He&&(He=33189),void 0===Hf&&(Hf=!1),void 0===Hg&&(Hg=!1),void 0===Hh&&(Hh=-1),void 0===Hi&&(Hi=-1),Hj.__super.call(this),this._type=3553,this._width=Ha,this._height=Hb,this._size=new Hpb(Ha,Hb),this._surfaceFormat=Hc,this._surfaceType=Hd,this._depthStencilFormat=He,Hp.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=Hf,this._repeat=Hg,this._minFifter=Hh,this._magFifter=Hi,this.activeResource(),this._alreadyResolved=!0}Hn(Hj,"laya.d3.resource.RenderTexture",HDb);var Hb=Hj.prototype;Hb.recreateResource=function(){var Ha=HD.mainContext;this._frameBuffer=Ha.createFramebuffer(),this._source=Ha.createTexture();var Hb=HE.curBindTexTarget,Hc=HE.curBindTexValue;HE.bindTexture(Ha,this._type,this._source),Ha.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var Hd=this._minFifter,He=this._magFifter,Hf=this._repeat?10497:33071;if(Hu.isPOT(this._width,this._height)?(this._mipmap?-1!==Hd||(Hd=9987):-1!==Hd||(Hd=9729),-1!==He||(He=9729),Ha.texParameteri(this._type,10241,Hd),Ha.texParameteri(this._type,10240,He),Ha.texParameteri(this._type,10242,Hf),Ha.texParameteri(this._type,10243,Hf),this._mipmap&&Ha.generateMipmap(this._type)):(-1!==Hd||(Hd=9729),-1!==He||(He=9729),Ha.texParameteri(this._type,10241,Hd),Ha.texParameteri(this._type,10240,He),Ha.texParameteri(this._type,10242,33071),Ha.texParameteri(this._type,10243,33071)),Hb&&Hc&&HE.bindTexture(Ha,Hb,Hc),Ha.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=Ha.createRenderbuffer(),Ha.bindRenderbuffer(36161,this._depthStencilBuffer),Ha.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),Ha.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:Ha.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:Ha.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:Ha.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}Ha.framebufferTexture2D(36160,36064,3553,this._source,0),Ha.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},Hb.start=function(){HD.mainContext.bindFramebuffer(36160,this.frameBuffer),(Hj._currentRenderTarget=this)._alreadyResolved=!1},Hb.end=function(){HD.mainContext.bindFramebuffer(36160,null),Hj._currentRenderTarget=null,this._alreadyResolved=!0},Hb.getData=function(Ha,Hb,Hc,Hd){var He=HD.mainContext;if(He.bindFramebuffer(36160,this._frameBuffer),!(36053===He.checkFramebufferStatus(36160)))return He.bindFramebuffer(36160,null),null;var Hf=new Uint8Array(this._width*this._height*4);return He.readPixels(Ha,Hb,Hc,Hd,this._surfaceFormat,this._surfaceType,Hf),He.bindFramebuffer(36160,null),Hf},Hb.disposeResource=function(){if(this._frameBuffer){var Ha=HD.mainContext;Ha.deleteTexture(this._source),Ha.deleteFramebuffer(this._frameBuffer),Ha.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},Ho(0,Hb,"surfaceFormat",function(){return this._surfaceFormat}),Ho(0,Hb,"surfaceType",function(){return this._surfaceType}),Ho(0,Hb,"depthStencilFormat",function(){return this._depthStencilFormat}),Ho(0,Hb,"source",function(){return this._alreadyResolved?Hv.superGet(HDb,this,"source"):null}),Ho(0,Hb,"depthStencilBuffer",function(){return this._depthStencilBuffer}),Ho(0,Hb,"frameBuffer",function(){return this._frameBuffer}),Hj._currentRenderTarget=null}(),function(Ha){function Hb(Ha){this._color=null,this._pixels=null,Hb.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new Hpb(this.width,this.height),this._color=Ha,this._pixels=new Uint8Array([255*Ha.x,255*Ha.y,255*Ha.z,255*Ha.w]),this.uri="SolidColorTexture2D_"+this.id}Hn(Hb,"laya.d3.resource.SolidColorTexture2D",HDb);var Hc=Hb.prototype;return Hc._createWebGlTexture=function(){var Ha=HD.mainContext,Hb=this._source=Ha.createTexture(),Hc=this._width,Hd=this._height,He=HE.curBindTexTarget,Hf=HE.curBindTexValue;HE.bindTexture(Ha,this._type,Hb),Ha.texImage2D(this._type,0,6408,Hc,Hd,0,6408,5121,this._pixels);var Hg=this._minFifter,Hh=this._magFifter,Hi=this._repeat?10497:33071,Hj=Hu.isPOT(Hc,Hd);Hj?(this._mipmap?-1!==Hg||(Hg=9987):-1!==Hg||(Hg=9729),-1!==Hh||(Hh=9729),Ha.texParameteri(this._type,10241,Hg),Ha.texParameteri(this._type,10240,Hh),Ha.texParameteri(this._type,10242,Hi),Ha.texParameteri(this._type,10243,Hi),this._mipmap&&Ha.generateMipmap(this._type)):(-1!==Hg||(Hg=9729),-1!==Hh||(Hh=9729),Ha.texParameteri(this._type,10241,Hg),Ha.texParameteri(this._type,10240,Hh),Ha.texParameteri(this._type,10242,33071),Ha.texParameteri(this._type,10243,33071)),He&&Hf&&HE.bindTexture(Ha,He,Hf),this.memorySize=Hj?Hc*Hd*4*(1+1/3):Hc*Hd*4},Hc.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},Hc.disposeResource=function(){this._source&&(HD.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Hl(Hb,["magentaTexture",function(){var Ha=new Hb(new Hhb(1,0,1,1));return Ha.lock=!0,this.magentaTexture=Ha},"grayTexture",function(){var Ha=new Hb(new Hhb(.5,.5,.5,1));return Ha.lock=!0,this.grayTexture=Ha}]),Hb}()),HRb=function(Ha){function He(Ha,Hb,Hc,Hd){this._canRead=!1,this._image=null,this._pixels=null,void 0===Ha&&(Ha=!1),void 0===Hb&&(Hb=!0),void 0===Hc&&(Hc=6408),void 0===Hd&&(Hd=!0),He.__super.call(this),this._type=3553,this._repeat=Hb,this._canRead=Ha,this._format=Hc,this._mipmap=Hd}Hn(He,"laya.d3.resource.Texture2D",HDb);var Hb=He.prototype;return Hb._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var Ha=HD.mainContext,Hb=this._source=Ha.createTexture(),Hc=this._width,Hd=this._height,He=HE.curBindTexTarget,Hf=HE.curBindTexValue;switch(HE.bindTexture(Ha,this._type,Hb),this._format){case 6407:case 6408:this._canRead?Ha.texImage2D(this._type,0,this._format,Hc,Hd,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?Ha.texImage2D(this._type,0,this._image._format,Hc,Hd,0,this._image._format,5121,this._image.atlasSource):Ha.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case HD.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:Ha.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var Hg=this._minFifter,Hh=this._magFifter,Hi=this._repeat?10497:33071,Hj=0==this._wrapModeU?10497:33071,Hk=0==this._wrapModeV?10497:33071,Hl=Hu.isPOT(Hc,Hd);Hl?(this._mipmap?-1!==Hg||(Hg=9987):-1!==Hg||(Hg=9729),-1!==Hh||(Hh=9729),Ha.texParameteri(this._type,10241,Hg),Ha.texParameteri(this._type,10240,Hh),Ha.texParameteri(this._type,10242,Hi),Ha.texParameteri(this._type,10243,Hi),Ha.texParameteri(this._type,10242,Hj),Ha.texParameteri(this._type,10243,Hk),this._mipmap&&Ha.generateMipmap(this._type)):(-1!==Hg||(Hg=9729),-1!==Hh||(Hh=9729),Ha.texParameteri(this._type,10241,Hg),Ha.texParameteri(this._type,10240,Hh),Ha.texParameteri(this._type,10242,33071),Ha.texParameteri(this._type,10243,33071)),He&&Hf&&HE.bindTexture(Ha,He,Hf),this._image.onload=null,this._image=null,this.memorySize=Hl?Hc*Hd*4*(1+1/3):Hc*Hd*4},Hb.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},Hb.onAsynLoaded=function(Ha,Hb,Hc){if(Hc){var Hd=Hc[0];void 0!==Hd&&(this._canRead=Hd);var He=Hc[1];void 0!==He&&(this._repeat=He);var Hf=Hc[2];void 0!==Hf&&(this._format=Hf);var Hg=Hc[3];void 0!==Hg&&(this._mipmap=Hg);var Hh=Hc.wrapModeU;void 0!==Hh&&(this._wrapModeU=Hh);var Hi=Hc.wrapModeV;void 0!==Hi&&(this._wrapModeV=Hi)}switch(this._format){case 6407:case 6408:var Hj=(this._image=Hb).width,Hk=Hb.height;this._width=Hj,this._height=Hk,this._size=new Hpb(Hj,Hk),this._canRead&&(Hp.isConchApp?Hb instanceof Hm.HTMLElement&&(this._pixels=new Uint8Array(Hb.getImageData(0,0,Hj,Hk))):(HF.canvas.size(Hj,Hk),HF.canvas.clear(),HF.context.drawImage(Hb,0,0,Hj,Hk),this._pixels=new Uint8Array(HF.context.getImageData(0,0,Hj,Hk).data.buffer)));break;case HD.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var Hl=new Hw(Hb);Hl.readUTFBytes(4),Hl.readUTFBytes(2),Hl.getInt16();Hl.endian="bigEndian",this._width=Hl.getInt16(),this._height=Hl.getInt16(),this._size=new Hpb(this._width,this._height);Hl.getInt16(),Hl.getInt16();this._image=new Uint8Array(Hb,Hl.pos)}this.recreateResource(),this._endLoaded()},Hb.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},Hb.disposeResource=function(){this._source&&(HD.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},Ho(0,Hb,"_src",function(){return this.url}),Ho(0,Hb,"src",function(){return this.url}),He.load=function(Ha){return Hv.loader.create(Ha,null,null,He)},He}(),HSb=function(Hb){function Hc(Ha,Hb){Hc.__super.call(this),void 0===Ha&&(Ha=.3),void 0===Hb&&(Hb=1e3),this._tempVector3=new Hgb,this._position=new Hgb,this._up=new Hgb,this._forward=new Hgb,this._right=new Hgb,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=Hpb.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=Ha,this._farPlane=Hb,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),Hv.stage.on("resize",this,this._onScreenSizeChanged)}Hn(Hc,"laya.d3.core.BaseCamera",Hb);var Ha=Hc.prototype;return Ha._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var Ha=this.scene._cameraPool,Hb=Ha.length-1,Hc=0;Hc<Hb;Hc++)if(Ha[Hc].renderingOrder>Ha[Hb].renderingOrder){var Hd=Ha[Hc];Ha[Hc]=Ha[Hb],Ha[Hb]=Hd}},Ha._calculateProjectionMatrix=function(){},Ha._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},Ha._prepareCameraToRender=function(){HG._currentCameraCullingMask=this.cullingMask;var Ha=this._shaderValues;Ha.setValue(0,this.transform.position.elements),Ha.setValue(5,this.forward.elements),Ha.setValue(6,this.up.elements)},Ha._prepareCameraViewProject=function(Ha,Hb){var Hc=this._shaderValues;Hc.setValue(1,Ha.elements),Hc.setValue(2,Hb.elements)},Ha._renderCamera=function(Ha,Hb,Hc){},Ha.addLayer=function(Ha){29!==Ha.number&&30!=Ha.number&&(this.cullingMask=this.cullingMask|Ha.mask)},Ha.removeLayer=function(Ha){29!==Ha.number&&30!=Ha.number&&(this.cullingMask=this.cullingMask&~Ha.mask)},Ha.addAllLayers=function(){this.cullingMask=2147483647},Ha.removeAllLayers=function(){this.cullingMask=0|HG.getLayerByNumber(29).mask|HG.getLayerByNumber(30).mask},Ha.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},Ha.moveForward=function(Ha){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=Ha,this.transform.translate(this._tempVector3)},Ha.moveRight=function(Ha){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=Ha,this.transform.translate(this._tempVector3)},Ha.moveVertical=function(Ha){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=Ha,this.transform.translate(this._tempVector3,!1)},Ha._addSelfRenderObjects=function(){var Ha=this.scene._cameraPool,Hb=Ha.length;if(0<Hb){for(var Hc=Hb-1;0<=Hc;Hc--)if(this.renderingOrder<=Ha[Hc].renderingOrder){Ha.splice(Hc+1,0,this);break}}else Ha.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},Ha._clearSelfRenderObjects=function(){var Ha=this.scene._cameraPool;Ha.splice(Ha.indexOf(this),1)},Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,Hv.stage.off("resize",this,this._onScreenSizeChanged),Hb.prototype.destroy.call(this,Ha)},Ho(0,Ha,"sky",function(){return this._sky},function(Ha){(this._sky=Ha)._ownerCamera=this}),Ho(0,Ha,"forward",function(){var Ha=this.transform.worldMatrix.elements,Hb=this._forward.elements;return Hb[0]=-Ha[8],Hb[1]=-Ha[9],Hb[2]=-Ha[10],this._forward}),Ho(0,Ha,"position",function(){var Ha=this.transform.worldMatrix.elements,Hb=this._position.elements;return Hb[0]=Ha[12],Hb[1]=Ha[13],Hb[2]=Ha[14],this._position}),Ho(0,Ha,"renderTarget",function(){return this._renderTarget},function(Ha){null!=(this._renderTarget=Ha)&&(this._renderTargetSize=Ha.size)}),Ho(0,Ha,"up",function(){var Ha=this.transform.worldMatrix.elements,Hb=this._up.elements;return Hb[0]=Ha[4],Hb[1]=Ha[5],Hb[2]=Ha[6],this._up}),Ho(0,Ha,"right",function(){var Ha=this.transform.worldMatrix.elements,Hb=this._right.elements;return Hb[0]=Ha[0],Hb[1]=Ha[1],Hb[2]=Ha[2],this._right}),Ho(0,Ha,"renderTargetSize",function(){return this._renderTargetSize},function(Ha){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=Ha,this._calculateProjectionMatrix()}),Ho(0,Ha,"fieldOfView",function(){return this._fieldOfView},function(Ha){this._fieldOfView=Ha,this._calculateProjectionMatrix()}),Ho(0,Ha,"nearPlane",function(){return this._nearPlane},function(Ha){this._nearPlane=Ha,this._calculateProjectionMatrix()}),Ho(0,Ha,"farPlane",function(){return this._farPlane},function(Ha){this._farPlane=Ha,this._calculateProjectionMatrix()}),Ho(0,Ha,"orthographic",function(){return this._orthographic},function(Ha){this._orthographic=Ha,this._calculateProjectionMatrix()}),Ho(0,Ha,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(Ha){this._orthographicVerticalSize=Ha,this._calculateProjectionMatrix()}),Ho(0,Ha,"renderingOrder",function(){return this._renderingOrder},function(Ha){this._renderingOrder=Ha,this._sortCamerasByRenderingOrder()}),Hc.CAMERAPOS=0,Hc.VIEWMATRIX=1,Hc.PROJECTMATRIX=2,Hc.VPMATRIX=3,Hc.VPMATRIX_NO_TRANSLATE=4,Hc.CAMERADIRECTION=5,Hc.CAMERAUP=6,Hc.ENVIRONMENTDIFFUSE=7,Hc.ENVIRONMENTSPECULAR=8,Hc.SIMLODINFO=9,Hc.DIFFUSEIRRADMATR=10,Hc.DIFFUSEIRRADMATG=11,Hc.DIFFUSEIRRADMATB=12,Hc.HDREXPOSURE=13,Hc.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",Hc.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",Hc.CLEARFLAG_SOLIDCOLOR=0,Hc.CLEARFLAG_SKY=1,Hc.CLEARFLAG_DEPTHONLY=2,Hc.CLEARFLAG_NONE=3,Hl(Hc,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new Hab(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new Hab},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new Hab}]),Hc}(HIb),HTb=function(Hc){function Hb(Ha){this._render=null,this._geometryFilter=null,Hb.__super.call(this,Ha)}Hn(Hb,"laya.d3.core.RenderableSprite3D",Hc);var Ha=Hb.prototype;return Ha._addToInitStaticBatchManager=function(){},Ha._setBelongScene=function(Ha){Hc.prototype._setBelongScene.call(this,Ha),Ha._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},Ha._setUnBelongScene=function(){var Ha=this._scene._renderableSprite3Ds,Hb=Ha.indexOf(this);Ha.splice(Hb,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),Hc.prototype._setUnBelongScene.call(this)},Ha._update=function(Ha){(Ha.owner=this)._activeInHierarchy&&(this._updateComponents(Ha),this._render._updateOctreeNode(),this._lateUpdateComponents(Ha),Hy.spriteCount++,this._childs.length&&this._updateChilds(Ha))},Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),Hc.prototype.destroy.call(this,Ha),this._render._destroy(),this._render=null},Hb.__init__=function(){Hb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=Hb.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),Hb.SAHDERDEFINE_LIGHTMAP=Hb.shaderDefines.registerDefine("LIGHTMAP")},Hb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,Hb.SAHDERDEFINE_LIGHTMAP=4,Hb.LIGHTMAPSCALEOFFSET=2,Hb.LIGHTMAP=3,Hl(Hb,["shaderDefines",function(){return this.shaderDefines=new Hkb}]),Hb}(HIb),HUb=(function(Ha){function Hd(Ha,Hb,Hc){this._long=NaN,this._width=NaN,this._height=NaN,void 0===Ha&&(Ha=1),void 0===Hb&&(Hb=1),void 0===Hc&&(Hc=1),Hd.__super.call(this),this._long=Ha,this._width=Hb,this._height=Hc,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}Hn(Hd,"laya.d3.resource.models.BoxMesh",HOb);var Hb=Hd.prototype;Hb.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var Ha=HDa.vertexDeclaration,Hb=(Ha.vertexStride,this._long/2),Hc=this._height/2,Hd=this._width/2,He=new Float32Array([-Hb,Hc,-Hd,0,1,0,0,0,Hb,Hc,-Hd,0,1,0,1,0,Hb,Hc,Hd,0,1,0,1,1,-Hb,Hc,Hd,0,1,0,0,1,-Hb,-Hc,-Hd,0,-1,0,0,1,Hb,-Hc,-Hd,0,-1,0,1,1,Hb,-Hc,Hd,0,-1,0,1,0,-Hb,-Hc,Hd,0,-1,0,0,0,-Hb,Hc,-Hd,-1,0,0,0,0,-Hb,Hc,Hd,-1,0,0,1,0,-Hb,-Hc,Hd,-1,0,0,1,1,-Hb,-Hc,-Hd,-1,0,0,0,1,Hb,Hc,-Hd,1,0,0,1,0,Hb,Hc,Hd,1,0,0,0,0,Hb,-Hc,Hd,1,0,0,0,1,Hb,-Hc,-Hd,1,0,0,1,1,-Hb,Hc,Hd,0,0,1,0,0,Hb,Hc,Hd,0,0,1,1,0,Hb,-Hc,Hd,0,0,1,1,1,-Hb,-Hc,Hd,0,0,1,0,1,-Hb,Hc,-Hd,0,0,-1,1,0,Hb,Hc,-Hd,0,0,-1,0,0,Hb,-Hc,-Hd,0,0,-1,0,1,-Hb,-Hc,-Hd,0,0,-1,1,1]),Hf=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new HMb(Ha,this._numberVertices,35044,!0),this._indexBuffer=new HLb("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(He),this._indexBuffer.setData(Hf),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},Ho(0,Hb,"long",function(){return this._long},function(Ha){this._long!==Ha&&(this._long=Ha,this.releaseResource(),this.activeResource())}),Ho(0,Hb,"width",function(){return this._width},function(Ha){this._width!==Ha&&(this._width=Ha,this.releaseResource(),this.activeResource())}),Ho(0,Hb,"height",function(){return this._height},function(Ha){this._height!==Ha&&(this._height=Ha,this.releaseResource(),this.activeResource())})}(),function(Ha){function Hg(Ha,Hb,Hc){void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=.3),void 0===Hc&&(Hc=1e3),this._viewMatrix=new Hab,this._projectionMatrix=new Hab,this._projectionViewMatrix=new Hab,this._viewport=new Hib(0,0,0,0),this._normalizedViewport=new Hib(0,0,1,1),this._aspectRatio=Ha,this._boundFrustumUpdate=!0,this._boundFrustum=new HYa(Hab.DEFAULT),Hg.__super.call(this,Hb,Hc),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}Hn(Hg,"laya.d3.core.Camera",HSb);var Hb=Hg.prototype;return Hb._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},Hb._parseCustomProps=function(Ha,Hb,Hc,Hd){var He=Hc.clearColor;this.clearColor=new Hhb(He[0],He[1],He[2],He[3]);var Hf=Hc.viewport;this.normalizedViewport=new Hib(Hf[0],Hf[1],Hf[2],Hf[3])},Hb._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var Ha=this.orthographicVerticalSize*this.aspectRatio*.5,Hb=.5*this.orthographicVerticalSize;Hab.createOrthoOffCenterRH(-Ha,Ha,-Hb,Hb,this.nearPlane,this.farPlane,this._projectionMatrix)}else Hab.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},Hb._update=function(Ha){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,Ha)},Hb._renderCamera=function(Ha,Hb,Hc){var Hd,He;Hc.parallelSplitShadowMaps[0]&&Hc._renderShadowMap(Ha,Hb,this),(Hb.camera=this)._prepareCameraToRender(),Hc._preRenderUpdateComponents(Hb),Hd=Hb._viewMatrix=this.viewMatrix;var Hf=this._renderTarget;Hf?(Hf.start(),Hab.multiply(HSb._invertYScaleMatrix,this._projectionMatrix,HSb._invertYProjectionMatrix),Hab.multiply(HSb._invertYScaleMatrix,this.projectionViewMatrix,HSb._invertYProjectionViewMatrix),He=Hb._projectionMatrix=HSb._invertYProjectionMatrix,Hb._projectionViewMatrix=HSb._invertYProjectionViewMatrix):(He=Hb._projectionMatrix=this._projectionMatrix,Hb._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(Hd,He),Hb._viewport=this.viewport,Hc._preRenderScene(Ha,Hb,this.boundFrustum),Hc._clear(Ha,Hb),Hc._renderScene(Ha,Hb),Hc._postRenderUpdateComponents(Hb),Hf&&Hf.end()},Hb.viewportPointToRay=function(Ha,Hb){Hob.calculateCursorRay(Ha,this.viewport,this._projectionMatrix,this.viewMatrix,null,Hb)},Hb.normalizedViewportPointToRay=function(Ha,Hb){var Hc=Hg._tempVector20,Hd=this.viewport,He=Ha.elements,Hf=Hc.elements;Hf[0]=He[0]*Hd.width,Hf[1]=He[1]*Hd.height,Hob.calculateCursorRay(Hc,this.viewport,this._projectionMatrix,this.viewMatrix,null,Hb)},Hb.worldToViewportPoint=function(Ha,Hb){Hab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(Ha,this._projectionViewMatrix,Hb);var Hc=Hb.elements;Hc[0]=Hc[0]/Hv.stage.clientScaleX,Hc[1]=Hc[1]/Hv.stage.clientScaleY},Hb.worldToNormalizedViewportPoint=function(Ha,Hb){Hab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(Ha,this._projectionViewMatrix,Hb);var Hc=Hb.elements;Hc[0]=Hc[0]/Hv.stage.clientScaleX,Hc[1]=Hc[1]/Hv.stage.clientScaleY},Hb.convertScreenCoordToOrthographicCoord=function(Ha,Hb){if(this._orthographic){var Hc=HW.clientWidth,Hd=HW.clientHeight,He=this.orthographicVerticalSize*this.aspectRatio/Hc,Hf=this.orthographicVerticalSize/Hd,Hg=Ha.elements,Hh=Hb.elements;return Hh[0]=(-Hc/2+Hg[0])*He,Hh[1]=(Hd/2-Hg[1])*Hf,Hh[2]=(this.nearPlane-this.farPlane)*(Hg[2]+1)/2-this.nearPlane,Hgb.transformCoordinate(Hb,this.transform.worldMatrix,Hb),!0}return!1},Ho(0,Hb,"projectionViewMatrix",function(){return Hab.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),Ho(0,Hb,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var Ha=this.viewport;return Ha.width/Ha.height},function(Ha){if(Ha<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=Ha,this._calculateProjectionMatrix()}),Ho(0,Hb,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),Ho(0,Hb,"needViewport",function(){var Ha=this.normalizedViewport;return 0===Ha.x&&0===Ha.y&&1===Ha.width&&1===Ha.height}),Ho(0,Hb,"viewport",function(){if(this._viewportExpressedInClipSpace){var Ha=this._normalizedViewport,Hb=this.renderTargetSize,Hc=Hb.width,Hd=Hb.height;this._viewport.x=Ha.x*Hc,this._viewport.y=Ha.y*Hd,this._viewport.width=Ha.width*Hc,this._viewport.height=Ha.height*Hd}return this._viewport},function(Ha){if(null!=this.renderTarget&&(Ha.x<0||Ha.y<0||0==Ha.width||0==Ha.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=Ha,this._calculateProjectionMatrix()}),Ho(0,Hb,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var Ha=this._viewport,Hb=this.renderTargetSize,Hc=Hb.width,Hd=Hb.height;this._normalizedViewport.x=Ha.x/Hc,this._normalizedViewport.y=Ha.y/Hd,this._normalizedViewport.width=Ha.width/Hc,this._normalizedViewport.height=Ha.height/Hd}return this._normalizedViewport},function(Ha){Ha.x<0&&(Ha.x=0,console.warn("Camera: viewport.x must large than 0.0.")),Ha.y<0&&(Ha.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<Ha.x+Ha.width&&(Ha.width=1-Ha.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<Ha.y+Ha.height&&(Ha.height=1-Ha.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=Ha,this._calculateProjectionMatrix()}),Ho(0,Hb,"projectionMatrix",function(){return this._projectionMatrix},function(Ha){this._projectionMatrix=Ha,this._useUserProjectionMatrix=!0}),Ho(0,Hb,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),Hl(Hg,["_tempVector20",function(){return this._tempVector20=new Hfb}]),Hg}()),HVb=function(Hc){function Hd(Ha,Hb){Hd.__super.call(this,Hb),this._geometryFilter=new HFb(this),this._render=new HGb(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),Ha&&(this._geometryFilter.sharedMesh=Ha)instanceof laya.d3.resource.models.Mesh&&(Ha.loaded?this._render.sharedMaterials=Ha.materials:Ha.once("loaded",this,this._applyMeshMaterials))}Hn(Hd,"laya.d3.core.MeshSprite3D",Hc);var Ha=Hd.prototype;return Ha._changeRenderObjectByMesh=function(Ha){var Hb=this._render._renderElements,Hc=Hb[Ha];Hc||(Hc=Hb[Ha]=new Hxb),Hc._render=this._render;var Hd=this._render.sharedMaterials[Ha];Hd||(Hd=HKb.defaultMaterial);var He=this._geometryFilter.sharedMesh.getRenderElement(Ha);return Hc._mainSortID=this._getSortID(He,Hd),Hc._sprite3D=this,Hc.renderObj=He,Hc._material=Hd,Hc},Ha._changeRenderObjectByMaterial=function(Ha,Hb){var Hc=this._render._renderElements[Ha];Hb||(Hb=HKb.defaultMaterial);var Hd=this._geometryFilter.sharedMesh.getRenderElement(Ha);return Hc._mainSortID=this._getSortID(Hd,Hb),Hc._sprite3D=this,Hc.renderObj=Hd,Hc._material=Hb,Hc},Ha._changeRenderObjectsByMesh=function(){var Ha=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=Ha;for(var Hb=0;Hb<Ha;Hb++)this._changeRenderObjectByMesh(Hb)},Ha._onMeshChanged=function(Ha){var Hb=Ha.sharedMesh;Hb.loaded?this._changeRenderObjectsByMesh():Hb.once("loaded",this,this._onMeshLoaded)},Ha._onMeshLoaded=function(Ha){Ha===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},Ha._onMaterialChanged=function(Ha,Hb,Hc){Hb<this._render._renderElements.length&&this._changeRenderObjectByMaterial(Hb,Hc)},Ha._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},Ha._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},Ha._parseCustomProps=function(Ha,Hb,Hc,Hd){var He=this.meshRender,Hf=Hc.lightmapIndex;null!=Hf&&(He.lightmapIndex=Hf);var Hg,Hh,Hi=Hc.lightmapScaleOffset;if(Hi&&(He.lightmapScaleOffset=new Hhb(Hi[0],Hi[1],Hi[2],Hi[3])),Hd.instanceParams)(Hg=Hd.instanceParams.loadPath)&&(Hh=Hr.getRes(Hb[Hg]),(this.meshFilter.sharedMesh=Hh).loaded?He.sharedMaterials=Hh.materials:Hh.once("loaded",this,this._applyMeshMaterials));else{(Hg=Hc.meshPath)&&(Hh=Hr.getRes(Hb[Hg]),this.meshFilter.sharedMesh=Hh);var Hj=Hc.materials;if(Hj){var Hk=He.sharedMaterials,Hl=Hj.length;Hk.length=Hl;for(var Hm=0;Hm<Hl;Hm++)Hk[Hm]=Hr.getRes(Hb[Hj[Hm].path]);He.sharedMaterials=Hk}}},Ha._applyMeshMaterials=function(Ha){for(var Hb=this._render.sharedMaterials,Hc=Ha.materials,Hd=0,He=Hc.length;Hd<He;Hd++)Hb[Hd]||(Hb[Hd]=Hc[Hd]);this._render.sharedMaterials=Hb},Ha._addToInitStaticBatchManager=function(){Hd._staticBatchManager._addInitBatchSprite(this)},Ha.cloneTo=function(Ha){var Hb=Ha;Hb._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var Hc=this._render,Hd=Hb._render;Hd.enable=Hc.enable,Hd.sharedMaterials=Hc.sharedMaterials,Hd.castShadow=Hc.castShadow;var He=Hc.lightmapScaleOffset;He&&(Hd.lightmapScaleOffset=He.clone()),Hd.lightmapIndex=Hc.lightmapIndex,Hd.receiveShadow=Hc.receiveShadow,Hd.sortingFudge=Hc.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,Ha)},Ha.destroy=function(Ha){if(void 0===Ha&&(Ha=!0),!this.destroyed){var Hb=this.meshFilter.sharedMesh;null!=Hb&&(Hb.loaded||Hb.off("loaded",this,this._applyMeshMaterials)),Hc.prototype.destroy.call(this,Ha),this._geometryFilter._destroy()}},Ho(0,Ha,"meshFilter",function(){return this._geometryFilter}),Ho(0,Ha,"meshRender",function(){return this._render}),Hd.__init__=function(){Hda._staticBatchManagers.push(Hd._staticBatchManager)},Hd.load=function(Ha){return Hv.loader.create(Ha,null,null,Hd)},Hl(Hd,["_staticBatchManager",function(){return this._staticBatchManager=new Hzb}]),Hd}(HTb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ha,Hb){"use strict";for(var Hc in Object.defineProperty(Hb,"__esModule",{value:!0}),Laya){var Hd=Laya[Hc];Hd&&Hd.__isclass&&(Hb[Hc]=Hd)}}),function(Ha,Hb,Hea){Hea.un,Hea.uns;var Hc=Hea.static,Hd=Hea.class,Hf=Hea.getset,Hp=Hea.__newvec,Hh=laya.maths.Bezier,Hl=laya.utils.Browser,HDa=laya.utils.Byte,He=(laya.events.Event,laya.events.EventDispatcher),Hg=laya.display.Graphics,Hi=(laya.resource.HTMLCanvas,laya.utils.Handler),Hj=laya.net.Loader,Hm=laya.maths.MathUtil,HEa=laya.maths.Matrix,Hq=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),Hk=(laya.renders.RenderContext,laya.resource.Resource),Hn=laya.utils.RunDriver,Hfa=laya.display.Sprite,Ho=laya.utils.Stat,HFa=laya.resource.Texture,Hr=(laya.net.URL,laya.utils.Utils),HE=function(){function Ha(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return Hd(Ha,"laya.ani.AnimationContent"),Ha}(),HF=function(){function Ha(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return Hd(Ha,"laya.ani.AnimationNodeContent"),Ha}(),Ht=function(){function Ha(){}return Hd(Ha,"laya.ani.AnimationParser01"),Ha.parse=function(Ha,Hb){var Hc=Hb.__getBuffer(),Hd=0,He=0,Hf=0,Hg=0,Hh=0,Hi=0,Hj=0,Hk=Hb.readUTFString();Ha._aniClassName=Hk;var Hl,Hm=Hb.readUTFString().split("\n"),Hn=Hb.getUint8(),Ho=Hb.getUint32(),Hp=Hb.getUint32();0<Ho&&(Hl=Hc.slice(Ho,Hp));var Hq=new HDa(Hl);for(0<Hp&&(Ha._publicExtData=Hc.slice(Hp,Hc.byteLength)),Ha._useParent=!!Hb.getUint8(),Ha._anis.length=Hn,Hd=0;Hd<Hn;Hd++){var Hr=Ha._anis[Hd]=new HE;Hr.nodes=new Array;var Hs=Hr.name=Hm[Hb.getUint16()];Ha._aniMap[Hs]=Hd,Hr.bone3DMap={},Hr.playTime=Hb.getFloat32(),Hr.playTime<=0&&console.error("播放时间不能为0  url="+Ha.url+" name="+Hr.name);var Ht=Hr.nodes.length=Hb.getUint8();for(He=Hr.totalKeyframeDatasLength=0;He<Ht;He++){var Hu=Hr.nodes[He]=new HF;Hu.childs=[];var Hv=Hb.getInt16();0<=Hv&&(Hu.name=Hm[Hv],Hr.bone3DMap[Hu.name]=He),Hu.keyFrame=new Array,Hu.parentIndex=Hb.getInt16(),-1==Hu.parentIndex?Hu.parent=null:Hu.parent=Hr.nodes[Hu.parentIndex],Hu.lerpType=Hb.getUint8();var Hw=Hb.getUint32();Hq.pos=Hw;var Hx=Hu.keyframeWidth=Hq.getUint16();if(Hr.totalKeyframeDatasLength+=Hx,0===Hu.lerpType||1===Hu.lerpType)for(Hu.interpolationMethod=[],Hu.interpolationMethod.length=Hx,Hf=0;Hf<Hx;Hf++)Hu.interpolationMethod[Hf]=HI.interpolation[Hq.getUint8()];null!=Hu.parent&&Hu.parent.childs.push(Hu);var Hy=Hb.getUint16();0<Hy&&(Hu.extenData=Hc.slice(Hb.pos,Hb.pos+Hy),Hb.pos+=Hy);var Hz,HA=Hb.getUint16(),HB=0;for(Hf=0,Hg=Hu.keyFrame.length=HA;Hf<Hg;Hf++){if((Hz=Hu.keyFrame[Hf]=new HG).duration=Hb.getFloat32(),Hz.startTime=HB,2===Hu.lerpType){Hz.interpolationData=[];var HC,HD=Hb.getUint8();switch(HC=Hb.getFloat32()){case 254:for(Hz.interpolationData.length=Hx,Hj=0;Hj<Hx;Hj++)Hz.interpolationData[Hj]=0;break;case 255:for(Hz.interpolationData.length=Hx,Hj=0;Hj<Hx;Hj++)Hz.interpolationData[Hj]=5;break;default:for(Hz.interpolationData.push(HC),Hi=1;Hi<HD;Hi++)Hz.interpolationData.push(Hb.getFloat32())}}for(Hz.data=new Float32Array(Hx),Hh=0;Hh<Hx;Hh++)Hz.data[Hh]=Hb.getFloat32(),-1e-8<Hz.data[Hh]&&Hz.data[Hh]<1e-8&&(Hz.data[Hh]=0);HB+=Hz.duration}Hz.startTime=Hr.playTime,Hu.playTime=Hr.playTime,Ha._calculateKeyFrame(Hu,HA,Hx)}}},Ha}(),Hu=function(){function Hv(){}return Hd(Hv,"laya.ani.AnimationParser02"),Hv.READ_DATA=function(){Hv._DATA.offset=Hv._reader.getUint32(),Hv._DATA.size=Hv._reader.getUint32()},Hv.READ_BLOCK=function(){for(var Ha=Hv._BLOCK.count=Hv._reader.getUint16(),Hb=Hv._BLOCK.blockStarts=[],Hc=Hv._BLOCK.blockLengths=[],Hd=0;Hd<Ha;Hd++)Hb.push(Hv._reader.getUint32()),Hc.push(Hv._reader.getUint32())},Hv.READ_STRINGS=function(){var Ha=Hv._reader.getUint32(),Hb=Hv._reader.getUint16(),Hc=Hv._reader.pos;Hv._reader.pos=Ha+Hv._DATA.offset;for(var Hd=0;Hd<Hb;Hd++)Hv._strings[Hd]=Hv._reader.readUTFString();Hv._reader.pos=Hc},Hv.parse=function(Ha,Hb){Hv._templet=Ha;(Hv._reader=Hb).__getBuffer();Hv.READ_DATA(),Hv.READ_BLOCK(),Hv.READ_STRINGS();for(var Hc=0,Hd=Hv._BLOCK.count;Hc<Hd;Hc++){var He=Hb.getUint16(),Hf=Hv._strings[He],Hg=Hv["READ_"+Hf];if(null==Hg)throw new Error("model file err,no this function:"+He+" "+Hf);Hg.call()}},Hv.READ_ANIMATIONS=function(){var Ha=Hv._reader,Hb=Ha.__getBuffer(),Hc=0,Hd=0,He=0,Hf=0,Hg=Ha.getUint16(),Hh=[];for(Hh.length=Hg,Hc=0;Hc<Hg;Hc++)Hh[Hc]=HI.interpolation[Ha.getByte()];var Hi=Ha.getUint8();for(Hv._templet._anis.length=Hi,Hc=0;Hc<Hi;Hc++){var Hj=Hv._templet._anis[Hc]={};Hj.nodes=new Array;var Hk=Hj.name=Hv._strings[Ha.getUint16()];Hv._templet._aniMap[Hk]=Hc,Hj.bone3DMap={},Hj.playTime=Ha.getFloat32();var Hl=Hj.nodes.length=Ha.getInt16();for(Hd=Hj.totalKeyframeDatasLength=0;Hd<Hl;Hd++){var Hm=Hj.nodes[Hd]={};Hm.keyframeWidth=Hg,Hm.childs=[];var Hn=Ha.getUint16();0<=Hn&&(Hm.name=Hv._strings[Hn],Hj.bone3DMap[Hm.name]=Hd),Hm.keyFrame=new Array,Hm.parentIndex=Ha.getInt16(),-1==Hm.parentIndex?Hm.parent=null:Hm.parent=Hj.nodes[Hm.parentIndex],Hj.totalKeyframeDatasLength+=Hg,Hm.interpolationMethod=Hh,null!=Hm.parent&&Hm.parent.childs.push(Hm);var Ho=Ha.getUint16(),Hp=null,Hq=null;for(He=0,Hf=Hm.keyFrame.length=Ho;He<Hf;He++){(Hp=Hm.keyFrame[He]={}).startTime=Ha.getFloat32(),Hq&&(Hq.duration=Hp.startTime-Hq.startTime);var Hr=Hv._DATA.offset,Hs=Ha.getUint32(),Ht=4*Hg,Hu=Hb.slice(Hr+Hs,Hr+Hs+Ht);Hp.data=new Float32Array(Hu),Hq=Hp}Hp.duration=0,Hm.playTime=Hj.playTime,Hv._templet._calculateKeyFrame(Hm,Ho,Hg)}}},Hv._templet=null,Hv._reader=null,Hv._strings=[],Hc(Hv,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Hv}(),HGa=(function(){function Ha(){}Hd(Ha,"laya.ani.AnimationState"),Ha.stopped=0,Ha.paused=1,Ha.playing=2}(),function(){function He(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new HTa,this.resultMatrix=new HEa,this._children=[]}Hd(He,"laya.ani.bone.Bone");var Ha=He.prototype;return Ha.setTempMatrix=function(Ha){this._tempMatrix=Ha;var Hb,Hc=0;for(Hc=0,Hb=this._children.length;Hc<Hb;Hc++)this._children[Hc].setTempMatrix(this._tempMatrix)},Ha.update=function(Ha){var Hb;if(this.rotation=this.transform.skX,Ha)Hb=this.resultTransform.getMatrix(),HEa.mul(Hb,Ha,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)Hb=this.resultTransform.getMatrix(),HEa.mul(Hb,this.parentBone.resultMatrix,this.resultMatrix);else{var Hc=this.parentBone,Hd=NaN,He=NaN,Hf=NaN,Hg=this.parentBone.resultMatrix;Hb=this.resultTransform.getMatrix();var Hh=Hg.a*Hb.tx+Hg.c*Hb.ty+Hg.tx,Hi=Hg.b*Hb.tx+Hg.d*Hb.ty+Hg.ty,Hj=new HEa;this.inheritRotation?(Hd=Math.atan2(Hc.resultMatrix.b,Hc.resultMatrix.a),He=Math.cos(Hd),Hf=Math.sin(Hd),Hj.setTo(He,Hf,-Hf,He,0,0),HEa.mul(this._tempMatrix,Hj,HEa.TEMP),HEa.TEMP.copyTo(Hj),Hb=this.resultTransform.getMatrix(),HEa.mul(Hb,Hj,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,Hb=this.resultTransform.getMatrix(),HEa.TEMP.identity(),HEa.TEMP.d=this.d,HEa.mul(Hb,HEa.TEMP,this.resultMatrix)),this.resultMatrix.tx=Hh,this.resultMatrix.ty=Hi}else(Hb=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var Hk,Hl=0;for(Hl=0,Hk=this._children.length;Hl<Hk;Hl++)this._children[Hl].update()},Ha.updateChild=function(){var Ha,Hb=0;for(Hb=0,Ha=this._children.length;Hb<Ha;Hb++)this._children[Hb].update()},Ha.setRotation=function(Ha){this._sprite&&(this._sprite.rotation=180*Ha/Math.PI)},Ha.updateDraw=function(Ha,Hb){He.ShowBones&&!He.ShowBones[this.name]||(this._sprite||(this._sprite=new Hfa,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),Hea.stage.addChild(this._sprite)),this._sprite.x=Ha+this.resultMatrix.tx,this._sprite.y=Hb+this.resultMatrix.ty);var Hc,Hd=0;for(Hd=0,Hc=this._children.length;Hd<Hc;Hd++)this._children[Hd].updateDraw(Ha,Hb)},Ha.addChild=function(Ha){this._children.push(Ha),Ha.parentBone=this},Ha.findBone=function(Ha){if(this.name==Ha)return this;var Hb,Hc,Hd=0;for(Hd=0,Hb=this._children.length;Hd<Hb;Hd++)if(Hc=this._children[Hd].findBone(Ha))return Hc;return null},Ha.localToWorld=function(Ha){var Hb=Ha[0],Hc=Ha[1];Ha[0]=Hb*this.resultMatrix.a+Hc*this.resultMatrix.c+this.resultMatrix.tx,Ha[1]=Hb*this.resultMatrix.b+Hc*this.resultMatrix.d+this.resultMatrix.ty},He.ShowBones={},He}()),HHa=function(){function Hp(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}Hd(Hp,"laya.ani.bone.BoneSlot");var Ha=Hp.prototype;return Ha.showSlotData=function(Ha,Hb){void 0===Hb&&(Hb=!0),this.currSlotData=Ha,Hb&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},Ha.showDisplayByName=function(Ha){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(Ha))},Ha.replaceDisplayByName=function(Ha,Hb){if(this.currSlotData){var Hc;Hc=this.currSlotData.getDisplayByName(Ha);var Hd;Hd=this.currSlotData.getDisplayByName(Hb),this.replaceDisplayByIndex(Hc,Hd)}},Ha.replaceDisplayByIndex=function(Ha,Hb){this.currSlotData&&(this._replaceDic[Ha]=Hb,this.displayIndex==Ha&&this.showDisplayByIndex(Ha))},Ha.showDisplayByIndex=function(Ha){if(null!=this._replaceDic[Ha]&&(Ha=this._replaceDic[Ha]),this.currSlotData&&-1<Ha&&Ha<this.currSlotData.displayArr.length){if(this.displayIndex=Ha,this.currDisplayData=this.currSlotData.displayArr[Ha],this.currDisplayData){var Hb=this.currDisplayData.name;this.currTexture=this.templet.getTexture(Hb),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!Hq.isConchApp||Hq.isConchApp&&"0.9.15"<Hfa.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},Ha.replaceSkin=function(Ha){this._diyTexture=Ha,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},Ha.setParentMatrix=function(Ha){this._parentMatrix=Ha},Ha.draw=function(Ha,Hb,Hc,Hd){if(void 0===Hc&&(Hc=!1),void 0===Hd&&(Hd=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var He,Hf=this.currTexture;switch(this._diyTexture&&(Hf=this._diyTexture),this.currDisplayData.type){case 0:if(Ha){var Hg=this.getDisplayMatrix();if(this._parentMatrix){var Hh=!1;if(Hg){var Hi;if(HEa.mul(Hg,this._parentMatrix,HEa.TEMP),Hi=Hc?(null==this._resultMatrix&&(this._resultMatrix=new HEa),this._resultMatrix):new HEa,!Hq.isWebGL&&this.currDisplayData.uvs||Hq.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var Hj=Hp._tempMatrix;Hj.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(Hj.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(Hh=!0,Hj.rotate(-Math.PI/2)),HEa.mul(Hj,HEa.TEMP,Hi)}else HEa.TEMP.copyTo(Hi);Hh?Ha.drawTexture(Hf,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,Hi):Ha.drawTexture(Hf,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,Hi)}}}break;case 1:if(null==(He=Hc?(null==this._skinSprite&&(this._skinSprite=Hp.createSkinMesh()),this._skinSprite):Hp.createSkinMesh()))return;var Hk;if(null==this.currDisplayData.bones){var Hl,Hm=this.currDisplayData.weights;this.deformData&&(Hm=this.deformData),Hl=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Hx.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Hx.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=Hm;this.currDisplayData.triangles.length;Hk=this.currDisplayData.triangles,He.init2(Hf,null,Hk,this._mVerticleArr,Hl);var Hn,Ho=this.getDisplayMatrix();if(this._parentMatrix)if(Ho)HEa.mul(Ho,this._parentMatrix,HEa.TEMP),Hn=Hc?(null==this._resultMatrix&&(this._resultMatrix=new HEa),this._resultMatrix):new HEa,HEa.TEMP.copyTo(Hn),He.transform=Hn}else this.skinMesh(Hb,He,Hd);Ha.drawSkin(He);break;case 2:if(null==(He=Hc?(null==this._skinSprite&&(this._skinSprite=Hp.createSkinMesh()),this._skinSprite):Hp.createSkinMesh()))return;this.skinMesh(Hb,He,Hd),Ha.drawSkin(He)}}},Ha.skinMesh=function(Ha,Hb,Hc){var Hd,He=this.currTexture,Hf=this.currDisplayData.bones;Hd=this._diyTexture?(He=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Hx.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Hx.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var Hg,Hh,Hi=this.currDisplayData.weights,Hj=this.currDisplayData.triangles,Hk=0,Hl=0,Hm=0,Hn=NaN,Ho=NaN,Hp=0,Hq=0,Hr=[],Hs=0,Ht=0;if(this.deformData&&0<this.deformData.length){var Hu=0;for(Hs=0,Ht=Hf.length;Hs<Ht;){for(Hm=Hf[Hs++]+Hs,Hl=Hk=0;Hs<Hm;Hs++)Hh=Ha[Hf[Hs]],Hn=Hi[Hp]+this.deformData[Hu++],Ho=Hi[Hp+1]+this.deformData[Hu++],Hq=Hi[Hp+2],Hk+=(Hn*Hh.a+Ho*Hh.c+Hh.tx)*Hq,Hl+=(Hn*Hh.b+Ho*Hh.d+Hh.ty)*Hq,Hp+=3;Hr.push(Hk,Hl)}}else for(Hs=0,Ht=Hf.length;Hs<Ht;){for(Hm=Hf[Hs++]+Hs,Hl=Hk=0;Hs<Hm;Hs++)Hh=Ha[Hf[Hs]],Hn=Hi[Hp],Ho=Hi[Hp+1],Hq=Hi[Hp+2],Hk+=(Hn*Hh.a+Ho*Hh.c+Hh.tx)*Hq,Hl+=(Hn*Hh.b+Ho*Hh.d+Hh.ty)*Hq,Hp+=3;Hr.push(Hk,Hl)}this._mVerticleArr=Hr,Hg=Hj,Hb.init2(He,null,Hg,this._mVerticleArr,Hd)},Ha.drawBonePoint=function(Ha){Ha&&this._parentMatrix&&Ha.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},Ha.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},Ha.getMatrix=function(){return this._resultMatrix},Ha.copy=function(){var Ha=new Hp;return Ha.type="copy",Ha.name=this.name,Ha.attachmentName=this.attachmentName,Ha.srcDisplayIndex=this.srcDisplayIndex,Ha.parent=this.parent,Ha.displayIndex=this.displayIndex,Ha.templet=this.templet,Ha.currSlotData=this.currSlotData,Ha.currTexture=this.currTexture,Ha.currDisplayData=this.currDisplayData,Ha},Hp.createSkinMesh=function(){return Hq.isWebGL||Hq.isConchApp?Hn.skinAniSprite():(Hq.isWebGL,null)},Hc(Hp,["_tempMatrix",function(){return this._tempMatrix=new HEa}]),Hp}(),HIa=function(){function Ha(){this.skinName=null,this.deformSlotDataList=[]}return Hd(Ha,"laya.ani.bone.DeformAniData"),Ha}(),HJa=function(){function Ha(){this.deformSlotDisplayList=[]}return Hd(Ha,"laya.ani.bone.DeformSlotData"),Ha}(),HKa=function(){function Ha(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}Hd(Ha,"laya.ani.bone.DeformSlotDisplayData");var Hb=Ha.prototype;return Hb.binarySearch1=function(Ha,Hb){var Hc=0,Hd=Ha.length-2;if(0==Hd)return 1;for(var He=Hd>>>1;;){if(Ha[Math.floor(He+1)]<=Hb?Hc=He+1:Hd=He,Hc==Hd)return Hc+1;He=Hc+Hd>>>1}return 0},Hb.apply=function(Ha,Hb,Hc){if(void 0===Hc&&(Hc=1),Ha+=.05,!(this.timeList.length<=0)){var Hd=0;if(!(Ha<this.timeList[0])){var He=this.vectices[0].length,Hf=[],Hg=this.binarySearch1(this.timeList,Ha);if(this.frameIndex=Hg,Ha>=this.timeList[this.timeList.length-1]){var Hh=this.vectices[this.vectices.length-1];if(Hc<1)for(Hd=0;Hd<He;Hd++)Hf[Hd]+=(Hh[Hd]-Hf[Hd])*Hc;else for(Hd=0;Hd<He;Hd++)Hf[Hd]=Hh[Hd];this.deformData=Hf}else{this.tweenKeyList[this.frameIndex];var Hi=this.vectices[this.frameIndex-1],Hj=this.vectices[this.frameIndex],Hk=this.timeList[this.frameIndex-1],Hl=this.timeList[this.frameIndex];Hc=this.tweenKeyList[Hg-1]?(Ha-Hk)/(Hl-Hk):0;var Hm=NaN;for(Hd=0;Hd<He;Hd++)Hm=Hi[Hd],Hf[Hd]=Hm+(Hj[Hd]-Hm)*Hc;this.deformData=Hf}}}},Ha}(),HLa=function(){function Ha(){this.time=NaN,this.drawOrder=[]}return Hd(Ha,"laya.ani.bone.DrawOrderData"),Ha}(),HMa=function(){function Ha(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return Hd(Ha,"laya.ani.bone.EventData"),Ha}(),Hs=function(){function Hda(Ha,Hb){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=Ha,this._targetBone=Hb[Ha.targetBoneIndex],this.isSpine=Ha.isSpine,null==this._bones&&(this._bones=[]);for(var Hc=this._bones.length=0,Hd=Ha.boneIndexs.length;Hc<Hd;Hc++)this._bones.push(Hb[Ha.boneIndexs[Hc]]);this.name=Ha.name,this.mix=Ha.mix,this.bendDirection=Ha.bendDirection}Hd(Hda,"laya.ani.bone.IkConstraint");var Ha=Hda.prototype;return Ha.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},Ha._applyIk1=function(Ha,Hb,Hc,Hd){var He=Ha.parentBone,Hf=1/(He.resultMatrix.a*He.resultMatrix.d-He.resultMatrix.b*He.resultMatrix.c),Hg=Hb-He.resultMatrix.tx,Hh=Hc-He.resultMatrix.ty,Hi=(Hg*He.resultMatrix.d-Hh*He.resultMatrix.c)*Hf-Ha.transform.x,Hj=(Hh*He.resultMatrix.a-Hg*He.resultMatrix.b)*Hf-Ha.transform.y,Hk=Math.atan2(Hj,Hi)*Hda.radDeg-0-Ha.transform.skX;Ha.transform.scX<0&&(Hk+=180),180<Hk?Hk-=360:Hk<-180&&(Hk+=360),Ha.transform.skX=Ha.transform.skY=Ha.transform.skX+Hk*Hd,Ha.update()},Ha.updatePos=function(Ha,Hb){this._sp&&this._sp.pos(Ha,Hb)},Ha._applyIk2=function(Ha,Hb,Hc,Hd,He,Hf){if(0!=Hf){var Hg=Ha.resultTransform.x,Hh=Ha.resultTransform.y,Hi=Ha.transform.scX,Hj=Ha.transform.scY,Hk=Hb.transform.scX,Hl=0,Hm=0,Hn=0;Hn=Hi<0?(Hi=-Hi,Hl=180,-1):(Hl=0,1),Hj<0&&(Hj=-Hj,Hn=-Hn),Hm=Hk<0?(Hk=-Hk,180):0;var Ho=Hb.resultTransform.x,Hp=NaN,Hq=NaN,Hr=NaN,Hs=Ha.resultMatrix.a,Ht=Ha.resultMatrix.c,Hu=Ha.resultMatrix.b,Hv=Ha.resultMatrix.d,Hw=Math.abs(Hi-Hj)<=1e-4;Hr=Hw?(Hq=Hs*Ho+Ht*(Hp=Hb.resultTransform.y)+Ha.resultMatrix.tx,Hu*Ho+Hv*Hp+Ha.resultMatrix.ty):(Hp=0,Hq=Hs*Ho+Ha.resultMatrix.tx,Hu*Ho+Ha.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new Hfa,Hea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(Hc,Hd,15,"#ffff00"),this._sp.graphics.drawCircle(Hq,Hr,15,"#ff00ff")),Ha.setRotation(Math.atan2(Hr-Ha.resultMatrix.ty,Hq-Ha.resultMatrix.tx));var Hx=Ha.parentBone;Hs=Hx.resultMatrix.a,Ht=Hx.resultMatrix.c,Hu=Hx.resultMatrix.b;var Hy=1/(Hs*(Hv=Hx.resultMatrix.d)-Ht*Hu),Hz=Hc-Hx.resultMatrix.tx,HA=Hd-Hx.resultMatrix.ty,HB=(Hz*Hv-HA*Ht)*Hy-Hg,HC=(HA*Hs-Hz*Hu)*Hy-Hh,HD=((Hz=Hq-Hx.resultMatrix.tx)*Hv-(HA=Hr-Hx.resultMatrix.ty)*Ht)*Hy-Hg,HE=(HA*Hs-Hz*Hu)*Hy-Hh,HF=Math.sqrt(HD*HD+HE*HE),HG=Hb.length*Hk,HH=NaN,HI=NaN;if(Hw){var HJ=(HB*HB+HC*HC-HF*HF-(HG*=Hi)*HG)/(2*HF*HG);HJ<-1?HJ=-1:1<HJ&&(HJ=1),HI=Math.acos(HJ)*He,Hs=HF+HG*HJ,Ht=HG*Math.sin(HI),HH=Math.atan2(HC*Hs-HB*Ht,HB*Hs+HC*Ht)}else{var HK=(Hs=Hi*HG)*Hs,HL=(Ht=Hj*HG)*Ht,HM=HB*HB+HC*HC,HN=Math.atan2(HC,HB),HO=-2*HL*HF,HP=HL-HK;if(0<(Hv=HO*HO-4*HP*(Hu=HL*HF*HF+HK*HM-HK*HL))){var HQ=Math.sqrt(Hv);HO<0&&(HQ=-HQ);var HR=(HQ=-(HO+HQ)/2)/HP,HS=Hu/HQ,HT=Math.abs(HR)<Math.abs(HS)?HR:HS;HT*HT<=HM&&(HA=Math.sqrt(HM-HT*HT)*He,HH=HN-Math.atan2(HA,HT),HI=Math.atan2(HA/Hj,(HT-HF)/Hi))}var HU=0,HV=Number.MAX_VALUE,HW=0,HX=0,HY=0,HZ=0,H$=0,H_=0;HZ<(Hv=(Hz=HF+Hs)*Hz)&&(HY=0,HZ=Hv,H$=Hz),(Hv=(Hz=HF-Hs)*Hz)<HV&&(HU=Math.PI,HV=Hv,HW=Hz);var Haa=Math.acos(-Hs*HF/(HK-HL));(Hv=(Hz=Hs*Math.cos(Haa)+HF)*Hz+(HA=Ht*Math.sin(Haa))*HA)<HV&&(HU=Haa,HV=Hv,HW=Hz,HX=HA),HZ<Hv&&(HY=Haa,HZ=Hv,H$=Hz,H_=HA),HI=HM<=(HV+HZ)/2?(HH=HN-Math.atan2(HX*He,HW),HU*He):(HH=HN-Math.atan2(H_*He,H$),HY*He)}var Hba=Math.atan2(Hp,Ho)*Hn,Hca=Ha.resultTransform.skX;180<(HH=(HH-Hba)*Hda.radDeg+Hl-Hca)?HH-=360:HH<-180&&(HH+=360),Ha.resultTransform.x=Hg,Ha.resultTransform.y=Hh,Ha.resultTransform.skX=Ha.resultTransform.skY=Hca+HH*Hf,Hca=Hb.resultTransform.skX,180<(HI=((HI+Hba)*Hda.radDeg-0)*Hn+Hm-(Hca%=360))?HI-=360:HI<-180&&(HI+=360),Hb.resultTransform.x=Ho,Hb.resultTransform.y=Hp,Hb.resultTransform.skX=Hb.resultTransform.skY=Hb.resultTransform.skY+HI*Hf,Ha.update()}},Ha._applyIk3=function(Ha,Hb,Hc,Hd,He,Hf){if(0!=Hf){var Hg,Hh,Hi=Hb.resultMatrix.a*Hb.length,Hj=Hb.resultMatrix.b*Hb.length,Hk=Hi*Hi+Hj*Hj,Hl=Math.sqrt(Hk),Hm=Ha.resultMatrix.tx,Hn=Ha.resultMatrix.ty,Ho=Hb.resultMatrix.tx,Hp=Hb.resultMatrix.ty,Hq=Ho-Hm,Hr=Hp-Hn,Hs=Hq*Hq+Hr*Hr,Ht=Math.sqrt(Hs),Hu=(Hq=Hc-Ha.resultMatrix.tx)*Hq+(Hr=Hd-Ha.resultMatrix.ty)*Hr,Hv=Math.sqrt(Hu);if(Hl+Ht<=Hv||Hv+Hl<=Ht||Hv+Ht<=Hl){var Hw=NaN;Ho=Hm+(Hw=Hl+Ht<=Hv?1:-1)*(Hc-Hm)*Ht/Hv,Hp=Hn+Hw*(Hd-Hn)*Ht/Hv}else{var Hx=(Hs-Hk+Hu)/(2*Hu),Hy=Math.sqrt(Hs-Hx*Hx*Hu)/Hv,Hz=Hm+Hq*Hx,HA=Hn+Hr*Hx,HB=-Hr*Hy,HC=Hq*Hy;Hp=0<He?(Ho=Hz-HB,HA-HC):(Ho=Hz+HB,HA+HC)}Hg=Ho,Hh=Hp,this.isDebug&&(this._sp||(this._sp=new Hfa,Hea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(Hm,Hn,15,"#ff00ff"),this._sp.graphics.drawCircle(Hc,Hd,15,"#ffff00"),this._sp.graphics.drawCircle(Hg,Hh,15,"#ff00ff"));var HD,HE;HD=Math.atan2(Hh-Ha.resultMatrix.ty,Hg-Ha.resultMatrix.tx),Ha.setRotation(HD),(HE=Hda._tempMatrix).identity(),HE.rotate(HD),HE.scale(Ha.resultMatrix.getScaleX(),Ha.resultMatrix.getScaleY()),HE.translate(Ha.resultMatrix.tx,Ha.resultMatrix.ty),HE.copyTo(Ha.resultMatrix),Ha.updateChild();var HF,HG;HF=Math.atan2(Hd-Hh,Hc-Hg),Hb.setRotation(HF),(HG=Hda._tempMatrix).identity(),HG.rotate(HF),HG.scale(Hb.resultMatrix.getScaleX(),Hb.resultMatrix.getScaleY()),HG.translate(Hg,Hh),HE.copyTo(Hb.resultMatrix),Hb.updateChild()}},Hc(Hda,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new HEa}]),Hda}(),HNa=function(){function Ha(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return Hd(Ha,"laya.ani.bone.IkConstraintData"),Ha}(),Hv=function(){function HG(Ha,Hb){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=Ha,this.position=Ha.position,this.spacing=Ha.spacing,this.rotateMix=Ha.rotateMix,this.translateMix=Ha.translateMix,this.bones=[];for(var Hc=this.data.bones,Hd=0,He=Hc.length;Hd<He;Hd++)this.bones.push(Hb[Hc[Hd]])}Hd(HG,"laya.ani.bone.PathConstraint");var Ha=HG.prototype;return Ha.apply=function(Ha,Hb){if(this.target){var Hc=this.translateMix,Hd=this.translateMix,He=0<Hd,Hf=this.data.spacingMode,Hg="length"==Hf,Hh=this.data.rotateMode,Hi="tangent"==Hh,Hj="chainScale"==Hh,Hk=[],Hl=this.bones.length,Hm=Hi?Hl:Hl+1,Hn=[];(this._spaces=Hn)[0]=this.position;var Ho=this.spacing;if(Hj||Hg)for(var Hp=0,Hq=Hm-1;Hp<Hq;){var Hr=this.bones[Hp],Hs=Hr.length,Ht=Hs*Hr.resultMatrix.a,Hu=Hs*Hr.resultMatrix.b;Hs=Math.sqrt(Ht*Ht+Hu*Hu),Hj&&(Hk[Hp]=Hs),Hn[++Hp]=Hg?Math.max(0,Hs+Ho):Ho}else for(Hp=1;Hp<Hm;Hp++)Hn[Hp]=Ho;var Hv=this.computeWorldPositions(this.target,Ha,Hb,Hm,Hi,"percent"==this.data.positionMode,"percent"==Hf);if(this._debugKey){for(Hp=0;Hp<Hv.length;Hp++)Hb.drawCircle(Hv[Hp++],Hv[Hp++],5,"#00ff00");var Hw=[];for(Hp=0;Hp<Hv.length;Hp++)Hw.push(Hv[Hp++],Hv[Hp++]);Hb.drawLines(0,0,Hw,"#ff0000")}var Hx=Hv[0],Hy=Hv[1],Hz=this.data.offsetRotation,HA="chain"==Hh&&0==Hz,HB=NaN;for(Hp=0,HB=3;Hp<Hl;Hp++,HB+=3){(Hr=this.bones[Hp]).resultMatrix.tx+=(Hx-Hr.resultMatrix.tx)*Hc,Hr.resultMatrix.ty+=(Hy-Hr.resultMatrix.ty)*Hc;var HC=(Ht=Hv[HB])-Hx,HD=(Hu=Hv[HB+1])-Hy;if(Hj&&0!=(Hs=Hk[Hp])){var HE=(Math.sqrt(HC*HC+HD*HD)/Hs-1)*Hd+1;Hr.resultMatrix.a*=HE,Hr.resultMatrix.c*=HE}if(Hx=Ht,Hy=Hu,He){var HF=Hr.resultMatrix.a,HG=Hr.resultMatrix.c,HH=Hr.resultMatrix.b,HI=Hr.resultMatrix.d,HJ=NaN,HK=NaN,HL=NaN;HJ=Hi?Hv[HB-1]:0==Hn[Hp+1]?Hv[HB+2]:Math.atan2(HD,HC),HJ-=Math.atan2(HH,HF)-Hz/180*Math.PI,HA&&(HK=Math.cos(HJ),HL=Math.sin(HJ),Hx+=((Hs=Hr.length)*(HK*HF-HL*HH)-HC)*Hd,Hy+=(Hs*(HL*HF+HK*HH)-HD)*Hd),HJ>Math.PI?HJ-=2*Math.PI:HJ<-Math.PI&&(HJ+=2*Math.PI),HJ*=Hd,HK=Math.cos(HJ),HL=Math.sin(HJ),Hr.resultMatrix.a=HK*HF-HL*HH,Hr.resultMatrix.c=HK*HG-HL*HI,Hr.resultMatrix.b=HL*HF+HK*HH,Hr.resultMatrix.d=HL*HG+HK*HI}}}},Ha.computeWorldVertices2=function(Ha,Hb,Hc,Hd,He,Hf){var Hg,Hh,Hi=Ha.currDisplayData.bones,Hj=Ha.currDisplayData.weights,Hk=Ha.currDisplayData.triangles,Hl=0,Hm=0,Hn=0,Ho=0,Hp=0,Hq=0,Hr=0,Hs=0,Ht=0,Hu=0,Hv=0;if(null!=Hi){for(Hl=0;Hl<Hc;Hl+=2)Hm+=(Ho=Hi[Hm])+1,Hn+=Ho;var Hw=Hb;for(Hp=Hf,Hq=3*Hn;Hp<Hd;Hp+=2){for(Hs=Hr=0,Ho=Hi[Hm++],Ho+=Hm;Hm<Ho;Hm++,Hq+=3){Hg=Hw[Hi[Hm]].resultMatrix,Ht=Hj[Hq],Hu=Hj[Hq+1];var Hx=Hj[Hq+2];Hr+=(Ht*Hg.a+Hu*Hg.c+Hg.tx)*Hx,Hs+=(Ht*Hg.b+Hu*Hg.d+Hg.ty)*Hx}He[Hp]=Hr,He[Hp+1]=Hs}}else{var Hy,Hz;if(Hk||(Hk=Hj),Ha.deformData&&(Hk=Ha.deformData),Hy=Ha.parent,Hb)for(Hv=Hb.length,Hl=0;Hl<Hv;Hl++)if(Hb[Hl].name==Hy){Hh=Hb[Hl];break}Hh&&(Hz=Hh.resultMatrix),Hz||(Hz=HG._tempMt);var HA=Hz.tx,HB=Hz.ty,HC=Hz.a,HD=Hz.b,HE=Hz.c,HF=Hz.d;for(Hh&&(HF*=Hh.d),Hm=Hc,Hp=Hf;Hp<Hd;Hm+=2,Hp+=2)Ht=Hk[Hm],Hu=Hk[Hm+1],He[Hp]=Ht*HC+Hu*HD+HA,He[Hp+1]=-(Ht*HE+Hu*HF+HB)}},Ha.computeWorldPositions=function(Ha,Hb,Hc,Hd,He,Hf,Hg){Ha.currDisplayData.bones,Ha.currDisplayData.weights,Ha.currDisplayData.triangles;var Hh=[],Hi=0,Hj=Ha.currDisplayData.verLen,Hk=this.position,Hl=this._spaces,Hm=[],Hn=[],Ho=Hj/6,Hp=-1,Hq=NaN,Hr=0,Hs=0,Ht=NaN,Hu=NaN,Hv=NaN,Hw=NaN;if(Ho--,Hj-=4,this.computeWorldVertices2(Ha,Hb,2,Hj,Hh,0),this._debugKey)for(Hi=0;Hi<Hh.length;)Hc.drawCircle(Hh[Hi++],Hh[Hi++],10,"#ff0000");Hm=Hh,this._curves.length=Ho;var Hx=this._curves,Hy=Hm[Hq=0],Hz=Hm[1],HA=0,HB=0,HC=0,HD=0,HE=0,HF=0,HG=NaN,HH=NaN,HI=NaN,HJ=NaN,HK=NaN,HL=NaN,HM=NaN,HN=NaN,HO=0;for(Hi=0,HO=2;Hi<Ho;Hi++,HO+=6)HA=Hm[HO],HB=Hm[HO+1],HC=Hm[HO+2],HD=Hm[HO+3],HK=2*(HG=.1875*(Hy-2*HA+HC))+(HI=.09375*(3*(HA-HC)-Hy+(HE=Hm[HO+4]))),HL=2*(HH=.1875*(Hz-2*HB+HD))+(HJ=.09375*(3*(HB-HD)-Hz+(HF=Hm[HO+5]))),HM=.75*(HA-Hy)+HG+.16666667*HI,HN=.75*(HB-Hz)+HH+.16666667*HJ,Hq+=Math.sqrt(HM*HM+HN*HN),HM+=HK,HN+=HL,HK+=HI,HL+=HJ,Hq+=Math.sqrt(HM*HM+HN*HN),HM+=HK,HN+=HL,Hq+=Math.sqrt(HM*HM+HN*HN),HM+=HK+HI,HN+=HL+HJ,Hq+=Math.sqrt(HM*HM+HN*HN),Hx[Hi]=Hq,Hy=HE,Hz=HF;if(Hf&&(Hk*=Hq),Hg)for(Hi=0;Hi<Hd;Hi++)Hl[Hi]*=Hq;var HP=this._segments,HQ=0,HR=0;for(HR=Hs=Hr=Hi=0;Hi<Hd;Hi++,Hr+=3)if((Ht=Hk+=Hu=Hl[Hi])<0)this.addBeforePosition(Ht,Hm,0,Hn,Hr);else if(Hq<Ht)this.addAfterPosition(Ht-Hq,Hm,Hj-4,Hn,Hr);else{for(;;Hs++)if(!((Hw=Hx[Hs])<Ht)){0==Hs?Ht/=Hw:Ht=(Ht-(Hv=Hx[Hs-1]))/(Hw-Hv);break}if(Hs!=Hp){var HS=6*(Hp=Hs);for(Hy=Hm[HS],Hz=Hm[HS+1],HA=Hm[HS+2],HB=Hm[HS+3],HC=Hm[HS+4],HD=Hm[HS+5],HK=2*(HG=.03*(Hy-2*HA+HC))+(HI=.006*(3*(HA-HC)-Hy+(HE=Hm[HS+6]))),HL=2*(HH=.03*(Hz-2*HB+HD))+(HJ=.006*(3*(HB-HD)-Hz+(HF=Hm[HS+7]))),HM=.3*(HA-Hy)+HG+.16666667*HI,HN=.3*(HB-Hz)+HH+.16666667*HJ,HQ=Math.sqrt(HM*HM+HN*HN),HP[0]=HQ,HS=1;HS<8;HS++)HM+=HK,HN+=HL,HK+=HI,HL+=HJ,HQ+=Math.sqrt(HM*HM+HN*HN),HP[HS]=HQ;HM+=HK,HN+=HL,HQ+=Math.sqrt(HM*HM+HN*HN),HP[8]=HQ,HM+=HK+HI,HN+=HL+HJ,HQ+=Math.sqrt(HM*HM+HN*HN),HP[9]=HQ,HR=0}for(Ht*=HQ;;HR++)if(!((Hw=HP[HR])<Ht)){0==HR?Ht/=Hw:Ht=HR+(Ht-(Hv=HP[HR-1]))/(Hw-Hv);break}this.addCurvePosition(.1*Ht,Hy,Hz,HA,HB,HC,HD,HE,HF,Hn,Hr,He||0<Hi&&0==Hu)}return Hn},Ha.addBeforePosition=function(Ha,Hb,Hc,Hd,He){var Hf=Hb[Hc],Hg=Hb[Hc+1],Hh=Hb[Hc+2]-Hf,Hi=Hb[Hc+3]-Hg,Hj=Math.atan2(Hi,Hh);Hd[He]=Hf+Ha*Math.cos(Hj),Hd[He+1]=Hg+Ha*Math.sin(Hj),Hd[He+2]=Hj},Ha.addAfterPosition=function(Ha,Hb,Hc,Hd,He){var Hf=Hb[Hc+2],Hg=Hb[Hc+3],Hh=Hf-Hb[Hc],Hi=Hg-Hb[Hc+1],Hj=Math.atan2(Hi,Hh);Hd[He]=Hf+Ha*Math.cos(Hj),Hd[He+1]=Hg+Ha*Math.sin(Hj),Hd[He+2]=Hj},Ha.addCurvePosition=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk,Hl){0==Ha&&(Ha=1e-4);var Hm=Ha*Ha,Hn=Hm*Ha,Ho=1-Ha,Hp=Ho*Ho,Hq=Hp*Ho,Hr=Ho*Ha,Hs=3*Hr,Ht=Ho*Hs,Hu=Hs*Ha,Hv=Hb*Hq+Hd*Ht+Hf*Hu+Hh*Hn,Hw=Hc*Hq+He*Ht+Hg*Hu+Hi*Hn;Hj[Hk]=Hv,Hj[Hk+1]=Hw,Hj[Hk+2]=Hl?Math.atan2(Hw-(Hc*Hp+He*Hr*2+Hg*Hm),Hv-(Hb*Hp+Hd*Hr*2+Hf*Hm)):0},HG.NONE=-1,HG.BEFORE=-2,HG.AFTER=-3,Hc(HG,["_tempMt",function(){return this._tempMt=new HEa}]),HG}(),HOa=function(){function Ha(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return Hd(Ha,"laya.ani.bone.PathConstraintData"),Ha}(),HPa=function(){function Ha(){this.name=null,this.slotArr=[]}return Hd(Ha,"laya.ani.bone.SkinData"),Ha}(),HQa=function(){function Ha(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}Hd(Ha,"laya.ani.bone.SkinSlotDisplayData");var Hb=Ha.prototype;return Hb.createTexture=function(Ha){return this.texture||(this.texture=new HFa(Ha.bitmap,this.uvs),Ha.bitmap.alphaTexture&&(this.texture.alphaTexture=new HFa(Ha.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=Ha.height,this.texture.height=Ha.width,this.texture.offsetX=-Ha.offsetX,this.texture.offsetY=-Ha.offsetY,this.texture.sourceWidth=Ha.sourceHeight,this.texture.sourceHeight=Ha.sourceWidth):(this.texture.width=Ha.width,this.texture.height=Ha.height,this.texture.offsetX=-Ha.offsetX,this.texture.offsetY=-Ha.offsetY,this.texture.sourceWidth=Ha.sourceWidth,this.texture.sourceHeight=Ha.sourceHeight),Hq.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},Hb.destory=function(){this.texture&&this.texture.destroy()},Ha}(),HRa=function(){function Ha(){this.name=null,this.displayArr=[]}return Hd(Ha,"laya.ani.bone.SlotData"),Ha.prototype.getDisplayByName=function(Ha){for(var Hb=0,Hc=this.displayArr.length;Hb<Hc;Hb++)if(this.displayArr[Hb].attachmentName==Ha)return Hb;return-1},Ha}(),Hw=function(){function Ha(Ha,Hb){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=Hp(2,0),this._data=Ha,null==this._bones&&(this._bones=[]),this.target=Hb[Ha.targetIndex];var Hc,Hd=0;for(Hd=0,Hc=Ha.boneIndexs.length;Hd<Hc;Hd++)this._bones.push(Hb[Ha.boneIndexs[Hd]]);this.rotateMix=Ha.rotateMix,this.translateMix=Ha.translateMix,this.scaleMix=Ha.scaleMix,this.shearMix=Ha.shearMix}return Hd(Ha,"laya.ani.bone.TfConstraint"),Ha.prototype.apply=function(){for(var Ha,Hb=this.target.resultMatrix.a,Hc=this.target.resultMatrix.b,Hd=this.target.resultMatrix.c,He=this.target.resultMatrix.d,Hf=0,Hg=this._bones.length;Hf<Hg;Hf++){if(Ha=this._bones[Hf],0<this.rotateMix){var Hh=Ha.resultMatrix.a,Hi=Ha.resultMatrix.b,Hj=Ha.resultMatrix.c,Hk=Ha.resultMatrix.d,Hl=Math.atan2(Hd,Hb)-Math.atan2(Hj,Hh)+this._data.offsetRotation*Math.PI/180;Hl>Math.PI?Hl-=2*Math.PI:Hl<-Math.PI&&(Hl+=2*Math.PI),Hl*=this.rotateMix;var Hm=Math.cos(Hl),Hn=Math.sin(Hl);Ha.resultMatrix.a=Hm*Hh-Hn*Hj,Ha.resultMatrix.b=Hm*Hi-Hn*Hk,Ha.resultMatrix.c=Hn*Hh+Hm*Hj,Ha.resultMatrix.d=Hn*Hi+Hm*Hk}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),Ha.resultMatrix.tx+=(this._temp[0]-Ha.resultMatrix.tx)*this.translateMix,Ha.resultMatrix.ty+=(this._temp[1]-Ha.resultMatrix.ty)*this.translateMix,Ha.updateChild()),0<this.scaleMix){var Ho=Math.sqrt(Ha.resultMatrix.a*Ha.resultMatrix.a+Ha.resultMatrix.c*Ha.resultMatrix.c),Hp=Math.sqrt(Hb*Hb+Hd*Hd),Hq=1e-5<Ho?(Ho+(Hp-Ho+this._data.offsetScaleX)*this.scaleMix)/Ho:0;Ha.resultMatrix.a*=Hq,Ha.resultMatrix.c*=Hq,Ho=Math.sqrt(Ha.resultMatrix.b*Ha.resultMatrix.b+Ha.resultMatrix.d*Ha.resultMatrix.d),Hp=Math.sqrt(Hc*Hc+He*He),Hq=1e-5<Ho?(Ho+(Hp-Ho+this._data.offsetScaleY)*this.scaleMix)/Ho:0,Ha.resultMatrix.b*=Hq,Ha.resultMatrix.d*=Hq}if(0<this.shearMix){Hi=Ha.resultMatrix.b,Hk=Ha.resultMatrix.d;var Hr=Math.atan2(Hk,Hi);(Hl=Math.atan2(He,Hc)-Math.atan2(Hd,Hb)-(Hr-Math.atan2(Ha.resultMatrix.c,Ha.resultMatrix.a)))>Math.PI?Hl-=2*Math.PI:Hl<-Math.PI&&(Hl+=2*Math.PI),Hl=Hr+(Hl+this._data.offsetShearY*Math.PI/180)*this.shearMix,Hq=Math.sqrt(Hi*Hi+Hk*Hk),Ha.resultMatrix.b=Math.cos(Hl)*Hq,Ha.resultMatrix.d=Math.sin(Hl)*Hq}}},Ha}(),HSa=function(){function Ha(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return Hd(Ha,"laya.ani.bone.TfConstraintData"),Ha}(),HTa=function(){function Ha(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}Hd(Ha,"laya.ani.bone.Transform");var Hb=Ha.prototype;return Hb.initData=function(Ha){null!=Ha.x&&(this.x=Ha.x),null!=Ha.y&&(this.y=Ha.y),null!=Ha.skX&&(this.skX=Ha.skX),null!=Ha.skY&&(this.skY=Ha.skY),null!=Ha.scX&&(this.scX=Ha.scX),null!=Ha.scY&&(this.scY=Ha.scY)},Hb.getMatrix=function(){var Ha;return(Ha=this.mMatrix?this.mMatrix:this.mMatrix=new HEa).identity(),Ha.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(Ha,this.skewX*Math.PI/180,this.skewY*Math.PI/180),Ha.rotate(this.skX*Math.PI/180),Ha.translate(this.x,this.y),Ha},Hb.skew=function(Ha,Hb,Hc){var Hd=Math.sin(Hc),He=Math.cos(Hc),Hf=Math.sin(Hb),Hg=Math.cos(Hb);return Ha.setTo(Ha.a*Hg-Ha.b*Hd,Ha.a*Hf+Ha.b*He,Ha.c*Hg-Ha.d*Hd,Ha.c*Hf+Ha.d*He,Ha.tx*Hg-Ha.ty*Hd,Ha.tx*Hf+Ha.ty*He),Ha},Ha}(),Hx=function(){function Ha(){}return Hd(Ha,"laya.ani.bone.UVTools"),Ha.getRelativeUV=function(Ha,Hb,Hc){var Hd=Ha[0],He=Ha[2]-Ha[0],Hf=Ha[1],Hg=Ha[5]-Ha[1];Hc||(Hc=[]),Hc.length=Hb.length;var Hh,Hi=0;Hh=Hc.length;var Hj=1/He,Hk=1/Hg;for(Hi=0;Hi<Hh;Hi+=2)Hc[Hi]=(Hb[Hi]-Hd)*Hj,Hc[Hi+1]=(Hb[Hi+1]-Hf)*Hk;return Hc},Ha.getAbsoluteUV=function(Ha,Hb,Hc){if(0==Ha[0]&&0==Ha[1]&&1==Ha[4]&&1==Ha[5])return Hc?(Hr.copyArray(Hc,Hb),Hc):Hb;var Hd=Ha[0],He=Ha[2]-Ha[0],Hf=Ha[1],Hg=Ha[5]-Ha[1];Hc||(Hc=[]),Hc.length=Hb.length;var Hh,Hi=0;for(Hh=Hc.length,Hi=0;Hi<Hh;Hi+=2)Hc[Hi]=Hb[Hi]*He+Hd,Hc[Hi+1]=Hb[Hi+1]*Hg+Hf;return Hc},Ha}(),HG=function(){function Ha(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return Hd(Ha,"laya.ani.KeyFramesContent"),Ha}(),Hy=function(){function Hk(){}return Hd(Hk,"laya.ani.math.BezierLerp"),Hk.getBezierRate=function(Ha,Hb,Hc,Hd,He){var Hf=Hk._getBezierParamKey(Hb,Hc,Hd,He),Hg=100*Hf+Ha;if(Hk._bezierResultCache[Hg])return Hk._bezierResultCache[Hg];var Hh,Hi=Hk._getBezierPoints(Hb,Hc,Hd,He,Hf),Hj=0;for(Hh=Hi.length,Hj=0;Hj<Hh;Hj+=2)if(Ha<=Hi[Hj])return Hk._bezierResultCache[Hg]=Hi[Hj+1],Hi[Hj+1];return Hk._bezierResultCache[Hg]=1},Hk._getBezierParamKey=function(Ha,Hb,Hc,Hd){return 100*(100*(100*(100*Ha+Hb)+Hc)+Hd)},Hk._getBezierPoints=function(Ha,Hb,Hc,Hd,He){return Hk._bezierPointsCache[He]?Hk._bezierPointsCache[He]:(Hf=[0,0,Ha,Hb,Hc,Hd,1,1],Hg=(new Hh).getBezierPoints(Hf,100,3),Hk._bezierPointsCache[He]=Hg);var Hf,Hg},Hk._bezierResultCache={},Hk._bezierPointsCache={},Hk}(),Hz=function(Ha){function Hb(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,Hb.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}Hd(Hb,"laya.ani.AnimationPlayer",He);var Hc=Hb.prototype;return Hea.imps(Hc,{"laya.resource.IDestroy":!0}),Hc._onTempletLoadedComputeFullKeyframeIndices=function(Ha,Hb,Hc){this._templet===Hc&&this._cachePlayRate===Ha&&this._cacheFrameRate===Hb&&this._computeFullKeyframeIndices()},Hc._computeFullKeyframeIndices=function(){for(var Ha=this._fullFrames=[],Hb=this._templet,Hc=this._cacheFrameRateInterval*this._cachePlayRate,Hd=0,He=Hb.getAnimationCount();Hd<He;Hd++){for(var Hf=[],Hg=0,Hh=Hb.getAnimation(Hd).nodes.length;Hg<Hh;Hg++){for(var Hi=Hb.getAnimation(Hd).nodes[Hg],Hj=Math.floor(Hi.playTime/Hc+.01),Hk=new Uint16Array(Hj+1),Hl=-1,Hm=0,Hn=Hi.keyFrame.length;Hm<Hn;Hm++){var Ho=Hi.keyFrame[Hm],Hp=Ho.startTime,Hq=Hp+Ho.duration+Hc;do{for(var Hr=Math.floor(Hp/Hc+.5),Hs=Hl+1;Hs<Hr;Hs++)Hk[Hs]=Hm;Hk[Hl=Hr]=Hm,Hp+=Hc}while(Hp<=Hq)}Hf.push(Hk)}Ha.push(Hf)}},Hc._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},Hc._calculatePlayDuration=function(){if(0!==this.state){var Ha=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=Ha),this._playEnd>Ha&&(this._playEnd=Ha),this._playDuration=this._playEnd-this._playStart}},Hc._setPlayParams=function(Ha,Hb){this._currentTime=Ha,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/Hb+.01),0),this._currentFrameTime=this._currentKeyframeIndex*Hb},Hc._setPlayParamsWhenStop=function(Ha,Hb){this._currentTime=Ha,this._currentKeyframeIndex=Math.max(Math.floor(Ha/Hb+.01),0),this._currentFrameTime=this._currentKeyframeIndex*Hb,this._currentAnimationClipIndex=-1},Hc._update=function(Ha){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var Hb=this._cacheFrameRateInterval*this._cachePlayRate,Hc=0;this._startUpdateLoopCount!==Ho.loopCount&&(Hc=Ha*this.playbackRate,this._elapsedPlaybackTime+=Hc);var Hd=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=Hd)return this._setPlayParamsWhenStop(Hd,Hb),void this.event("stopped");if(Hc+=this._currentTime,0<Hd)if(Hd<=Hc)do{if(Hc-=Hd,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(Hd,Hb),this._stopWhenCircleFinish=!1,void this.event("stopped");Hc<Hd&&(this._setPlayParams(Hc,Hb),this.event("complete"))}while(Hd<=Hc);else this._setPlayParams(Hc,Hb);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(Hd,Hb),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},Hc._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},Hc.play=function(Ha,Hb,Hc,Hd,He){if(void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=1),void 0===Hc&&(Hc=2147483647),void 0===Hd&&(Hd=0),void 0===He&&(He=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(Hc<0||Hd<0||He<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==He&&He<Hd)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=Hb,this._overallDuration=Hc,this._playStart=Hd,this._playEnd=He,this._paused=!1,this._currentAnimationClipIndex=Ha,this._currentKeyframeIndex=0,this._startUpdateLoopCount=Ho.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},Hc.playByFrame=function(Ha,Hb,Hc,Hd,He,Hf){void 0===Ha&&(Ha=0),void 0===Hb&&(Hb=1),void 0===Hc&&(Hc=2147483647),void 0===Hd&&(Hd=0),void 0===He&&(He=0),void 0===Hf&&(Hf=30);var Hg=1e3/Hf;this.play(Ha,Hb,Hc,Hd*Hg,He*Hg)},Hc.stop=function(Ha){void 0===Ha&&(Ha=!0),Ha?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},Hf(0,Hc,"playEnd",function(){return this._playEnd}),Hf(0,Hc,"templet",function(){return this._templet},function(Ha){0===!this.state&&this.stop(!0),this._templet!==Ha&&((this._templet=Ha).loaded?this._computeFullKeyframeIndices():Ha.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),Hf(0,Hc,"playStart",function(){return this._playStart}),Hf(0,Hc,"playDuration",function(){return this._playDuration}),Hf(0,Hc,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),Hf(0,Hc,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),Hf(0,Hc,"overallDuration",function(){return this._overallDuration}),Hf(0,Hc,"currentFrameTime",function(){return this._currentFrameTime}),Hf(0,Hc,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),Hf(0,Hc,"currentPlayTime",function(){return this._currentTime+this._playStart}),Hf(0,Hc,"cachePlayRate",function(){return this._cachePlayRate},function(Ha){this._cachePlayRate!==Ha&&(this._cachePlayRate=Ha,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[Ha,this._cacheFrameRate])))}),Hf(0,Hc,"cacheFrameRate",function(){return this._cacheFrameRate},function(Ha){this._cacheFrameRate!==Ha&&(this._cacheFrameRate=Ha,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,Ha])))}),Hf(0,Hc,"currentTime",null,function(Ha){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(Ha<this._playStart||Ha>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=Ho.loopCount;var Hb=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=Ha,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/Hb),0),this._currentFrameTime=this._currentKeyframeIndex*Hb}}),Hf(0,Hc,"paused",function(){return this._paused},function(Ha){(this._paused=Ha)&&this.event("paused")}),Hf(0,Hc,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),Hf(0,Hc,"destroyed",function(){return this._destroyed}),Hb}(),HH=function(Ha){function Hb(){Hb.__super.call(this),Hq.isConchNode&&(this.drawSkin=function(Ha){Ha.transform||(Ha.transform=HEa.EMPTY),this._addCmd([Ha]),this.setSkinMesh&&this.setSkinMesh(Ha._ps,Ha.mVBData,Ha.mEleNum,0,Ha.mTexture,Ha.transform)})}return Hd(Hb,"laya.ani.GraphicsAni",Hg),Hb.prototype.drawSkin=function(Ha){var Hb=[Ha];this._saveToCmd(Hq._context._drawSkin,Hb)},Hb.create=function(){return Hb._caches.pop()||new Hb},Hb.recycle=function(Ha){Ha.clear(),Hb._caches.push(Ha)},Hb._caches=[],Hb}(),HI=function(Ha){function Hs(){this._aniMap={},this.unfixedLastAniIndex=-1,Hs.__super.call(this),this._anis=new Array}Hd(Hs,"laya.ani.AnimationTemplet",Hk);var Hb=Hs.prototype;return Hb.parse=function(Ha){var Hb=new HDa(Ha);this._aniVersion=Hb.readUTFString(),Ht.parse(this,Hb)},Hb._calculateKeyFrame=function(Ha,Hb,Hc){var Hd=Ha.keyFrame;Hd[Hb]=Hd[0];for(var He=0;He<Hb;He++){var Hf=Hd[He];Hf.nextData=0===Hf.duration?Hf.data:Hd[He+1].data}Hd.length--},Hb.onAsynLoaded=function(Ha,Hb,Hc){var Hd=new HDa(Hb);switch(this._aniVersion=Hd.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":Hu.parse(this,Hd);break;default:Ht.parse(this,Hd)}this._endLoaded()},Hb.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},Hb.getAnimationCount=function(){return this._anis.length},Hb.getAnimation=function(Ha){return this._anis[Ha]},Hb.getAniDuration=function(Ha){return this._anis[Ha].playTime},Hb.getNodes=function(Ha){return this._anis[Ha].nodes},Hb.getNodeIndexWithName=function(Ha,Hb){return this._anis[Ha].bone3DMap[Hb]},Hb.getNodeCount=function(Ha){return this._anis[Ha].nodes.length},Hb.getTotalkeyframesLength=function(Ha){return this._anis[Ha].totalKeyframeDatasLength},Hb.getPublicExtData=function(){return this._publicExtData},Hb.getAnimationDataWithCache=function(Ha,Hb,Hc,Hd){var He=Hb[Hc];if(He){var Hf=He[Ha];return Hf?Hf[Hd]:null}return null},Hb.setAnimationDataWithCache=function(Ha,Hb,Hc,Hd,He){var Hf=Hb[Hc]||(Hb[Hc]={});(Hf[Ha]||(Hf[Ha]=[]))[Hd]=He},Hb.getOriginalData=function(Ha,Hb,Hc,Hd,He){for(var Hf=this._anis[Ha].nodes,Hg=0,Hh=0,Hi=Hf.length,Hj=0;Hh<Hi;Hh++){var Hk,Hl=Hf[Hh];Hk=Hl.keyFrame[Hc[Hh][Hd]],Hl.dataOffset=Hj;var Hm=He-Hk.startTime,Hn=Hl.lerpType;if(Hn)switch(Hn){case 0:case 1:for(Hg=0;Hg<Hl.keyframeWidth;)Hg+=Hl.interpolationMethod[Hg](Hl,Hg,Hb,Hj+Hg,Hk.data,Hm,null,Hk.duration,Hk.nextData);break;case 2:var Ho=Hk.interpolationData,Hp=Ho.length,Hq=0;for(Hg=0;Hg<Hp;){var Hr=Ho[Hg];switch(Hr){case 6:case 7:Hg+=Hs.interpolation[Hr](Hl,Hq,Hb,Hj+Hq,Hk.data,Hm,null,Hk.duration,Hk.nextData,Ho,Hg+1);break;default:Hg+=Hs.interpolation[Hr](Hl,Hq,Hb,Hj+Hq,Hk.data,Hm,null,Hk.duration,Hk.nextData)}Hq++}}else for(Hg=0;Hg<Hl.keyframeWidth;)Hg+=Hl.interpolationMethod[Hg](Hl,Hg,Hb,Hj+Hg,Hk.data,Hm,null,Hk.duration,Hk.nextData);Hj+=Hl.keyframeWidth}},Hb.getNodesCurrentFrameIndex=function(Ha,Hb){var Hc=this._anis[Ha].nodes;Ha!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(Hc.length),this.unfixedCurrentTimes=new Float32Array(Hc.length),this.unfixedLastAniIndex=Ha);for(var Hd=0,He=Hc.length;Hd<He;Hd++){var Hf=Hc[Hd];for(Hb<this.unfixedCurrentTimes[Hd]&&(this.unfixedCurrentFrameIndexes[Hd]=0),this.unfixedCurrentTimes[Hd]=Hb;this.unfixedCurrentFrameIndexes[Hd]<Hf.keyFrame.length&&!(Hf.keyFrame[this.unfixedCurrentFrameIndexes[Hd]].startTime>this.unfixedCurrentTimes[Hd]);)this.unfixedCurrentFrameIndexes[Hd]++;this.unfixedCurrentFrameIndexes[Hd]--}return this.unfixedCurrentFrameIndexes},Hb.getOriginalDataUnfixedRate=function(Ha,Hb,Hc){var Hd=this._anis[Ha].nodes;Ha!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(Hd.length),this.unfixedCurrentTimes=new Float32Array(Hd.length),this.unfixedKeyframes=Hp(Hd.length),this.unfixedLastAniIndex=Ha);for(var He=0,Hf=0,Hg=Hd.length,Hh=0;Hf<Hg;Hf++){var Hi=Hd[Hf];for(Hc<this.unfixedCurrentTimes[Hf]&&(this.unfixedCurrentFrameIndexes[Hf]=0),this.unfixedCurrentTimes[Hf]=Hc;this.unfixedCurrentFrameIndexes[Hf]<Hi.keyFrame.length&&!(Hi.keyFrame[this.unfixedCurrentFrameIndexes[Hf]].startTime>this.unfixedCurrentTimes[Hf]);)this.unfixedKeyframes[Hf]=Hi.keyFrame[this.unfixedCurrentFrameIndexes[Hf]],this.unfixedCurrentFrameIndexes[Hf]++;var Hj=this.unfixedKeyframes[Hf];Hi.dataOffset=Hh;var Hk=Hc-Hj.startTime;if(Hi.lerpType)switch(Hi.lerpType){case 0:case 1:for(He=0;He<Hi.keyframeWidth;)He+=Hi.interpolationMethod[He](Hi,He,Hb,Hh+He,Hj.data,Hk,null,Hj.duration,Hj.nextData);break;case 2:var Hl=Hj.interpolationData,Hm=Hl.length,Hn=0;for(He=0;He<Hm;){var Ho=Hl[He];switch(Ho){case 6:case 7:He+=Hs.interpolation[Ho](Hi,Hn,Hb,Hh+Hn,Hj.data,Hk,null,Hj.duration,Hj.nextData,Hl,He+1);break;default:He+=Hs.interpolation[Ho](Hi,Hn,Hb,Hh+Hn,Hj.data,Hk,null,Hj.duration,Hj.nextData)}Hn++}}else for(He=0;He<Hi.keyframeWidth;)He+=Hi.interpolationMethod[He](Hi,He,Hb,Hh+He,Hj.data,Hk,null,Hj.duration,Hj.nextData);Hh+=Hi.keyframeWidth}},Hs._LinearInterpolation_0=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){var Hk=0===Hh?0:Hf/Hh;return Hc[Hd]=(1-Hk)*He[Hb]+Hk*Hi[Hb],1},Hs._QuaternionInterpolation_1=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){var Hk=0===Hh?0:Hf/Hh;return Hm.slerpQuaternionArray(He,Hb,Hi,Hb,Hk,Hc,Hd),4},Hs._AngleInterpolation_2=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){return 0},Hs._RadiansInterpolation_3=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){return 0},Hs._Matrix4x4Interpolation_4=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){for(var Hk=0;Hk<16;Hk++,Hb++)Hc[Hd+Hk]=He[Hb]+Hf*Hg[Hb];return 16},Hs._NoInterpolation_5=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj){return Hc[Hd]=He[Hb],1},Hs._BezierInterpolation_6=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk){return void 0===Hk&&(Hk=0),Hc[Hd]=He[Hb]+(Hi[Hb]-He[Hb])*Hy.getBezierRate(Hf/Hh,Hj[Hk],Hj[Hk+1],Hj[Hk+2],Hj[Hk+3]),5},Hs._BezierInterpolation_7=function(Ha,Hb,Hc,Hd,He,Hf,Hg,Hh,Hi,Hj,Hk){return void 0===Hk&&(Hk=0),Hc[Hd]=Hj[Hk+4]+Hj[Hk+5]*Hy.getBezierRate((.001*Hf+Hj[Hk+6])/Hj[Hk+7],Hj[Hk],Hj[Hk+1],Hj[Hk+2],Hj[Hk+3]),9},Hs.load=function(Ha){return Hea.loader.create(Ha,null,null,Hs)},Hs.interpolation=[Hs._LinearInterpolation_0,Hs._QuaternionInterpolation_1,Hs._AngleInterpolation_2,Hs._RadiansInterpolation_3,Hs._Matrix4x4Interpolation_4,Hs._NoInterpolation_5,Hs._BezierInterpolation_6,Hs._BezierInterpolation_7],Hs}(),HA=function(Hb){function Hc(Ha,Hb){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,Hc.__super.call(this),void 0===Hb&&(Hb=0),Ha&&this.init(Ha,Hb)}Hd(Hc,"laya.ani.bone.Skeleton",Hb);var Ha=Hc.prototype;return Ha.init=function(Ha,Hb){void 0===Hb&&(Hb=0);var Hc,Hd,He,Hf=0,Hg=0;if(1==Hb)for(this._graphicsCache=[],Hf=0,Hg=Ha.getAnimationCount();Hf<Hg;Hf++)this._graphicsCache.push([]);if(this._yReverseMatrix=Ha.yReverseMatrix,this._aniMode=Hb,this._templet=Ha,this._player=new Hz,this._player.cacheFrameRate=Ha.rate,this._player.templet=Ha,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=Ha.mBoneArr,this._rootBone=Ha.mRootBone,this._aniSectionDic=Ha.aniSectionDic,0<Ha.ikArr.length)for(this._ikArr=[],Hf=0,Hg=Ha.ikArr.length;Hf<Hg;Hf++)this._ikArr.push(new Hs(Ha.ikArr[Hf],this._boneList));if(0<Ha.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),Hf=0,Hg=Ha.pathArr.length;Hf<Hg;Hf++)Hc=Ha.pathArr[Hf],Hd=new Hv(Hc,this._boneList),(He=this._boneSlotDic[Hc.name])&&((Hd=new Hv(Hc,this._boneList)).target=He),this._pathDic[Hc.name]=Hd;if(0<Ha.tfArr.length)for(this._tfArr=[],Hf=0,Hg=Ha.tfArr.length;Hf<Hg;Hf++)this._tfArr.push(new Hw(Ha.tfArr[Hf],this._boneList));if(0<Ha.skinDataArray.length){var Hh=this._templet.skinDataArray[this._skinIndex];this._skinName=Hh.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},Ha.load=function(Ha,Hb,Hc){},Ha._onLoaded=function(){},Ha._parseComplete=function(){var Ha=HB.TEMPLET_DICTIONARY[this._aniPath];Ha&&(this.init(Ha,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},Ha._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},Ha._onPlay=function(){this.event("played")},Ha._onStop=function(){var Ha,Hb=this._templet.eventAniArr[this._aniClipIndex];if(Hb&&this._eventIndex<Hb.length)for(;this._eventIndex<Hb.length;this._eventIndex++)(Ha=Hb[this._eventIndex]).time>=this._player.playStart&&Ha.time<=this._player.playEnd&&this.event("label",Ha);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},Ha._onPause=function(){this.event("paused")},Ha._parseSrcBoneMatrix=function(){var Ha=0,Hb=0;for(Hb=this._templet.srcBoneMatrixArr.length,Ha=0;Ha<Hb;Ha++)this._boneMatrixArray.push(new HEa);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var Hc,Hd,He=this._templet.boneSlotArray;for(Ha=0,Hb=He.length;Ha<Hb;Ha++)Hc=He[Ha],null==(Hd=this._bindBoneBoneSlotDic[Hc.parent])&&(this._bindBoneBoneSlotDic[Hc.parent]=Hd=[]),this._boneSlotDic[Hc.name]=Hc=Hc.copy(),Hd.push(Hc),this._boneSlotArray.push(Hc)}},Ha._emitMissedEvents=function(Ha,Hb,Hc){void 0===Hc&&(Hc=0);var Hd=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(Hd){var He,Hf,Hg=0;for(He=Hd.length,Hg=Hc;Hg<He;Hg++)(Hf=Hd[Hg]).time>=this._player.playStart&&Hf.time<=this._player.playEnd&&this.event("label",Hf)}},Ha._update=function(Ha){if(void 0===Ha&&(Ha=!0),!(this._pause||Ha&&this._indexControl)){var Hb=this.timer.currTimer,Hc=this._player.currentKeyframeIndex,Hd=Hb-this._lastTime;if(Ha?this._player._update(Hd):Hc=-1,this._lastTime=Hb,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<Hd&&this._clipIndex==Hc&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var He;this._lastUpdateAniClipIndex=this._aniClipIndex,Hc>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var Hf,Hg=this._templet.eventAniArr[this._aniClipIndex];if(Hg&&this._eventIndex<Hg.length&&((He=Hg[this._eventIndex]).time>=this._player.playStart&&He.time<=this._player.playEnd?this._player.currentPlayTime>=He.time&&(this.event("label",He),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(Hf=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=Hf&&(this.graphics=Hf));var Hh=0,Hi=0;for(Hi=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,Hi-1)&&0<Hi;)Hi--;if(Hi<this._clipIndex)for(Hh=Hi;Hh<this._clipIndex;Hh++)this._createGraphics(Hh)}else if(1==this._aniMode){if(Hf=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=Hf&&(this.graphics=Hf));for(Hi=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,Hi-1)&&0<Hi;)Hi--;if(Hi<this._clipIndex)for(Hh=Hi;Hh<this._clipIndex;Hh++)this._createGraphics(Hh)}this._createGraphics()}}},Ha._createGraphics=function(Ha){void 0===Ha&&(Ha=-1),-1==Ha&&(Ha=this._clipIndex);var Hb,Hc,Hd=Ha*this._player.cacheFrameRateInterval,He=this._templet.drawOrderAniArr[this._aniClipIndex];if(He&&0<He.length)for(this._drawOrderIndex=0,Hb=He[this._drawOrderIndex];Hd>=Hb.time&&(this._drawOrder=Hb.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=He.length));)Hb=He[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=HH.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=HH.create(),Hc=this.graphics;var Hf=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],Ha,Hd);var Hg,Hh,Hi,Hj,Hk=this._aniSectionDic[this._aniClipIndex],Hl=0,Hm=0,Hn=0,Ho=0,Hp=0,Hq=this._templet.srcBoneMatrixArr.length;for(Hp=Hk[Hm=0];Hm<Hq;Hm++)Hj=this._boneList[Hm],Hi=this._templet.srcBoneMatrixArr[Hm],Hj.resultTransform.scX=Hi.scX*this._curOriginalData[Hl++],Hj.resultTransform.skX=Hi.skX+this._curOriginalData[Hl++],Hj.resultTransform.skY=Hi.skY+this._curOriginalData[Hl++],Hj.resultTransform.scY=Hi.scY*this._curOriginalData[Hl++],Hj.resultTransform.x=Hi.x+this._curOriginalData[Hl++],Hj.resultTransform.y=Hi.y+this._curOriginalData[Hl++],8===this._templet.tMatrixDataLen&&(Hj.resultTransform.skewX=Hi.skewX+this._curOriginalData[Hl++],Hj.resultTransform.skewY=Hi.skewY+this._curOriginalData[Hl++]);var Hr,Hs={},Ht={};for(Hp+=Hk[1];Hm<Hp;Hm++)Hs[(Hr=Hf[Hm]).name]=this._curOriginalData[Hl++],Ht[Hr.name]=this._curOriginalData[Hl++],this._curOriginalData[Hl++],this._curOriginalData[Hl++],this._curOriginalData[Hl++],this._curOriginalData[Hl++];var Hu,Hv,Hw={},Hx={};for(Hp+=Hk[2];Hm<Hp;Hm++)Hw[(Hr=Hf[Hm]).name]=this._curOriginalData[Hl++],Hx[Hr.name]=this._curOriginalData[Hl++],this._curOriginalData[Hl++],this._curOriginalData[Hl++],this._curOriginalData[Hl++],this._curOriginalData[Hl++];if(this._pathDic)for(Hp+=Hk[3];Hm<Hp;Hm++){if(Hr=Hf[Hm],Hu=this._pathDic[Hr.name])switch(new HDa(Hr.extenData).getByte()){case 1:Hu.position=this._curOriginalData[Hl++];break;case 2:Hu.spacing=this._curOriginalData[Hl++];break;case 3:Hu.rotateMix=this._curOriginalData[Hl++],Hu.translateMix=this._curOriginalData[Hl++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(HEa.TEMP.identity()),this._ikArr)for(Hm=0,Hp=this._ikArr.length;Hm<Hp;Hm++)Hv=this._ikArr[Hm],Hw.hasOwnProperty(Hv.name)&&(Hv.bendDirection=Hw[Hv.name]),Hx.hasOwnProperty(Hv.name)&&(Hv.mix=Hx[Hv.name]),Hv.apply();if(this._pathDic)for(var Hy in this._pathDic)(Hu=this._pathDic[Hy]).apply(this._boneList,Hc);if(this._tfArr)for(Hm=0,Ho=this._tfArr.length;Hm<Ho;Hm++)this._tfArr[Hm].apply();for(Hm=0,Ho=this._boneList.length;Hm<Ho;Hm++)if(Hj=this._boneList[Hm],Hh=this._bindBoneBoneSlotDic[Hj.name],Hj.resultMatrix.copyTo(this._boneMatrixArray[Hm]),Hh)for(Hn=0,Hp=Hh.length;Hn<Hp;Hn++)(Hg=Hh[Hn])&&Hg.setParentMatrix(Hj.resultMatrix);var Hz,HA,HB,HC,HD={},HE=this._templet.deformAniArr;if(HE&&0<HE.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,Hm=0,Hp=this._boneSlotArray.length;Hm<Hp;Hm++)(Hg=this._boneSlotArray[Hm]).deformData=null;var HF,HG=HE[this._aniClipIndex];for(HF in Hz=HG.default,this._setDeform(Hz,HD,this._boneSlotArray,Hd),HG)"default"!=HF&&HF!=this._skinName&&(Hz=HG[HF],this._setDeform(Hz,HD,this._boneSlotArray,Hd));Hz=HG[this._skinName],this._setDeform(Hz,HD,this._boneSlotArray,Hd)}if(this._drawOrder)for(Hm=0,Hp=this._drawOrder.length;Hm<Hp;Hm++)HA=Hs[(Hg=this._boneSlotArray[this._drawOrder[Hm]]).name],HB=Ht[Hg.name],isNaN(HB)||(Hc.save(),Hc.alpha(HB)),isNaN(HA)||-2==HA||(this._templet.attachmentNames?Hg.showDisplayByName(this._templet.attachmentNames[HA]):Hg.showDisplayByIndex(HA)),HD[this._drawOrder[Hm]]?(HC=HD[this._drawOrder[Hm]],Hg.currDisplayData&&HC[Hg.currDisplayData.attachmentName]?Hg.deformData=HC[Hg.currDisplayData.attachmentName]:Hg.deformData=null):Hg.deformData=null,isNaN(HB)?Hg.draw(Hc,this._boneMatrixArray,2==this._aniMode):Hg.draw(Hc,this._boneMatrixArray,2==this._aniMode,HB),isNaN(HB)||Hc.restore();else for(Hm=0,Hp=this._boneSlotArray.length;Hm<Hp;Hm++)HA=Hs[(Hg=this._boneSlotArray[Hm]).name],HB=Ht[Hg.name],isNaN(HB)||(Hc.save(),Hc.alpha(HB)),isNaN(HA)||-2==HA||(this._templet.attachmentNames?Hg.showDisplayByName(this._templet.attachmentNames[HA]):Hg.showDisplayByIndex(HA)),HD[Hm]?(HC=HD[Hm],Hg.currDisplayData&&HC[Hg.currDisplayData.attachmentName]?Hg.deformData=HC[Hg.currDisplayData.attachmentName]:Hg.deformData=null):Hg.deformData=null,isNaN(HB)?Hg.draw(Hc,this._boneMatrixArray,2==this._aniMode):Hg.draw(Hc,this._boneMatrixArray,2==this._aniMode,HB),isNaN(HB)||Hc.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,Ha,Hc):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,Ha,Hc)},Ha._setDeform=function(Ha,Hb,Hc,Hd){if(Ha){var He,Hf,Hg,Hh=0,Hi=0,Hj=0;if(Ha)for(Hh=0,Hi=Ha.deformSlotDataList.length;Hh<Hi;Hh++)for(He=Ha.deformSlotDataList[Hh],Hj=0;Hj<He.deformSlotDisplayList.length;Hj++)Hg=Hc[(Hf=He.deformSlotDisplayList[Hj]).slotIndex],Hf.apply(Hd,Hg),Hb[Hf.slotIndex]||(Hb[Hf.slotIndex]={}),Hb[Hf.slotIndex][Hf.attachment]=Hf.deformData}},Ha.getAnimNum=function(){return this._templet.getAnimationCount()},Ha.getAniNameByIndex=function(Ha){return this._templet.getAniNameByIndex(Ha)},Ha.getSlotByName=function(Ha){return this._boneSlotDic[Ha]},Ha.showSkinByName=function(Ha,Hb){void 0===Hb&&(Hb=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(Ha),Hb)},Ha.showSkinByIndex=function(Ha,Hb){void 0===Hb&&(Hb=!0);for(var Hc=0;Hc<this._boneSlotArray.length;Hc++)this._boneSlotArray[Hc].showSlotData(null,Hb);if(this._templet.showSkinByIndex(this._boneSlotDic,Ha,Hb)){var Hd=this._templet.skinDataArray[Ha];this._skinIndex=Ha,this._skinName=Hd.name}this._clearCache()},Ha.showSlotSkinByIndex=function(Ha,Hb){if(0!=this._aniMode){var Hc=this.getSlotByName(Ha);Hc&&Hc.showDisplayByIndex(Hb),this._clearCache()}},Ha.showSlotSkinByName=function(Ha,Hb){if(0!=this._aniMode){var Hc=this.getSlotByName(Ha);Hc&&Hc.showDisplayByName(Hb),this._clearCache()}},Ha.replaceSlotSkinName=function(Ha,Hb,Hc){if(0!=this._aniMode){var Hd=this.getSlotByName(Ha);Hd&&Hd.replaceDisplayByName(Hb,Hc),this._clearCache()}},Ha.replaceSlotSkinByIndex=function(Ha,Hb,Hc){if(0!=this._aniMode){var Hd=this.getSlotByName(Ha);Hd&&Hd.replaceDisplayByIndex(Hb,Hc),this._clearCache()}},Ha.setSlotSkin=function(Ha,Hb){if(0!=this._aniMode){var Hc=this.getSlotByName(Ha);Hc&&Hc.replaceSkin(Hb),this._clearCache()}},Ha._clearCache=function(){if(1==this._aniMode)for(var Ha=0,Hb=this._graphicsCache.length;Ha<Hb;Ha++){for(var Hc=0,Hd=this._graphicsCache[Ha].length;Hc<Hd;Hc++){var He=this._graphicsCache[Ha][Hc];He!=this.graphics&&HH.recycle(He)}this._graphicsCache[Ha].length=0}},Ha.play=function(Ha,Hb,Hc,Hd,He,Hf){void 0===Hc&&(Hc=!0),void 0===Hd&&(Hd=0),void 0===He&&(He=0),void 0===Hf&&(Hf=!0),this._indexControl=!1;var Hg=-1,Hh=NaN;if(Hh=Hb?2147483647:0,"string"==typeof Ha)for(var Hi=0,Hj=this._templet.getAnimationCount();Hi<Hj;Hi++){var Hk=this._templet.getAnimation(Hi);if(Hk&&Ha==Hk.name){Hg=Hi;break}}else Hg=Ha;-1<Hg&&Hg<this.getAnimNum()&&(this._aniClipIndex=Hg,(Hc||this._pause||this._currAniIndex!=Hg)&&(this._currAniIndex=Hg,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(Hg)),this._drawOrder=null,this._eventIndex=0,this._player.play(Hg,this._player.playbackRate,Hh,Hd,He),Hf&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=Hl.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},Ha.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},Ha.playbackRate=function(Ha){this._player&&(this._player.playbackRate=Ha)},Ha.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},Ha.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=Hl.now(),this.timer.frameLoop(1,this,this._update,null,!0))},Ha._getGrahicsDataWithCache=function(Ha,Hb){return this._graphicsCache[Ha][Hb]},Ha._setGrahicsDataWithCache=function(Ha,Hb,Hc){this._graphicsCache[Ha][Hb]=Hc},Ha.destroy=function(Ha){void 0===Ha&&(Ha=!0),Hb.prototype.destroy.call(this,Ha),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},Hf(0,Ha,"url",function(){return this._aniPath},function(Ha){this.load(Ha)}),Hf(0,Ha,"index",function(){return this._index},function(Ha){this.player&&(this._index=Ha,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),Hf(0,Ha,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),Hf(0,Ha,"templet",function(){return this._templet}),Hf(0,Ha,"player",function(){return this._player}),Hc.useSimpleMeshInCanvas=!1,Hc}(Hfa),HB=function(Hb){function He(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,He.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}Hd(He,"laya.ani.bone.Templet",Hb);var Ha=He.prototype;return Ha.getLoadList=function(){return this._loadList},Ha.loadAni=function(Ha){this._skBufferUrl=Ha,Hea.loader.load(Ha,Hi.create(this,this.onComplete),null,"arraybuffer")},Ha.onComplete=function(Ha){if(this._isDestroyed)this.destroy();else{var Hb=Hj.getRes(this._skBufferUrl);Hb?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,Hb)):this.event("error","load failed:"+this._skBufferUrl)}},Ha.parseData=function(Ha,Hb,Hc){void 0===Hc&&(Hc=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=Ha,this._mainTexture&&Hq.isWebGL&&Ha.bitmap&&(Ha.bitmap.enableMerageInAtlas=!1),this._rate=Hc,this.parse(Hb)},Ha.buildArmature=function(Ha){return void 0===Ha&&(Ha=0),new HA(this,Ha)},Ha.parse=function(Ha){Hb.prototype.parse.call(this,Ha),this._endLoaded(),this._aniVersion!=He.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+He.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},Ha._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var Ha=0;this._loadList=[];var Hb,Hc=new HDa(this.getPublicExtData()),Hd=0,He=0,Hf=0,Hg=Hc.getInt32(),Hh=Hc.readUTFString(),Hi=Hh.split("\n");for(Ha=0;Ha<Hg;Ha++)Hb=this._path+Hi[2*Ha],Hh=Hi[2*Ha+1],Hc.getFloat32(),Hc.getFloat32(),Hd=Hc.getFloat32(),He=Hc.getFloat32(),Hf=Hc.getFloat32(),isNaN(Hf)?0:Hf,Hf=Hc.getFloat32(),isNaN(Hf)?0:Hf,Hf=Hc.getFloat32(),isNaN(Hf)?Hd:Hf,Hf=Hc.getFloat32(),isNaN(Hf)?He:Hf,-1==this._loadList.indexOf(Hb)&&this._loadList.push(Hb);this.event("inited",this)}},Ha._textureComplete=function(){for(var Ha,Hb,Hc=0,Hd=this._loadList.length;Hc<Hd;Hc++)Hb=this._loadList[Hc],Ha=this._textureDic[Hb]=Hj.getRes(Hb),Hq.isWebGL&&Ha&&Ha.bitmap&&(Ha.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},Ha._parsePublicExtData=function(){var Ha=0,Hb=0,Hc=0,Hd=0,He=0;for(Ha=0,He=this.getAnimationCount();Ha<He;Ha++)this._graphicsCache.push([]);var Hf;Hf="Dragon"!=this._aniClassName;var Hg,Hh,Hi=new HDa(this.getPublicExtData()),Hj=0,Hk=0,Hl=0,Hm=0,Hn=0,Ho=0,Hp=0,Hq=0,Hr=0,Hs=Hi.getInt32(),Ht=Hi.readUTFString(),Hu=Ht.split("\n");for(Ha=0;Ha<Hs;Ha++){if(Hg=this._mainTexture,Hh=this._path+Hu[2*Ha],Ht=Hu[2*Ha+1],null==this._mainTexture&&(Hg=this._textureDic[Hh]),!Hg)return this.event("error",this),void(this.isParseFail=!0);Hj=Hi.getFloat32(),Hk=Hi.getFloat32(),Hl=Hi.getFloat32(),Hm=Hi.getFloat32(),Hr=Hi.getFloat32(),Hn=isNaN(Hr)?0:Hr,Hr=Hi.getFloat32(),Ho=isNaN(Hr)?0:Hr,Hr=Hi.getFloat32(),Hp=isNaN(Hr)?Hl:Hr,Hr=Hi.getFloat32(),Hq=isNaN(Hr)?Hm:Hr,this.subTextureDic[Ht]=HFa.create(Hg,Hj,Hk,Hl,Hm,-Hn,-Ho,Hp,Hq),Hg.alphaTexture&&(this.subTextureDic[Ht].alphaTexture=HFa.create(Hg.alphaTexture,Hj,Hk,Hl,Hm,-Hn,-Ho,Hp,Hq))}this._mainTexture=Hg;var Hv,Hw,Hx,Hy,Hz,HA=Hi.getUint16();for(Ha=0;Ha<HA;Ha++)(Hv=[]).push(Hi.getUint16()),Hv.push(Hi.getUint16()),Hv.push(Hi.getUint16()),Hv.push(Hi.getUint16()),this.aniSectionDic[Ha]=Hv;var HB,HC=Hi.getInt16(),HD={};for(Ha=0;Ha<HC;Ha++)Hw=new HGa,0==Ha?HB=Hw:Hw.root=HB,Hw.d=Hf?-1:1,Hy=Hi.readUTFString(),Hz=Hi.readUTFString(),Hw.length=Hi.getFloat32(),1==Hi.getByte()&&(Hw.inheritRotation=!1),1==Hi.getByte()&&(Hw.inheritScale=!1),Hw.name=Hy,Hz&&((Hx=HD[Hz])?Hx.addChild(Hw):this.mRootBone=Hw),HD[Hy]=Hw,this.mBoneArr.push(Hw);this.tMatrixDataLen=Hi.getUint16();var HE,HF,HG=Hi.getUint16(),HH=Math.floor(HG/this.tMatrixDataLen),HI=this.srcBoneMatrixArr;for(Ha=0;Ha<HH;Ha++)(HE=new HTa).scX=Hi.getFloat32(),HE.skX=Hi.getFloat32(),HE.skY=Hi.getFloat32(),HE.scY=Hi.getFloat32(),HE.x=Hi.getFloat32(),HE.y=Hi.getFloat32(),8===this.tMatrixDataLen&&(HE.skewX=Hi.getFloat32(),HE.skewY=Hi.getFloat32()),HI.push(HE),(Hw=this.mBoneArr[Ha]).transform=HE;var HJ,HK=Hi.getUint16(),HL=0;for(Ha=0;Ha<HK;Ha++){for(HF=new HNa,HL=Hi.getUint16(),Hb=0;Hb<HL;Hb++)HF.boneNames.push(Hi.readUTFString()),HF.boneIndexs.push(Hi.getInt16());HF.name=Hi.readUTFString(),HF.targetBoneName=Hi.readUTFString(),HF.targetBoneIndex=Hi.getInt16(),HF.bendDirection=Hi.getFloat32(),HF.mix=Hi.getFloat32(),HF.isSpine=Hf,this.ikArr.push(HF)}var HM,HN=Hi.getUint16(),HO=0;for(Ha=0;Ha<HN;Ha++){for(HJ=new HSa,HO=Hi.getUint16(),Hb=0;Hb<HO;Hb++)HJ.boneIndexs.push(Hi.getInt16());HJ.name=Hi.getUTFString(),HJ.targetIndex=Hi.getInt16(),HJ.rotateMix=Hi.getFloat32(),HJ.translateMix=Hi.getFloat32(),HJ.scaleMix=Hi.getFloat32(),HJ.shearMix=Hi.getFloat32(),HJ.offsetRotation=Hi.getFloat32(),HJ.offsetX=Hi.getFloat32(),HJ.offsetY=Hi.getFloat32(),HJ.offsetScaleX=Hi.getFloat32(),HJ.offsetScaleY=Hi.getFloat32(),HJ.offsetShearY=Hi.getFloat32(),this.tfArr.push(HJ)}var HP=Hi.getUint16(),HQ=0;for(Ha=0;Ha<HP;Ha++){for((HM=new HOa).name=Hi.readUTFString(),HQ=Hi.getUint16(),Hb=0;Hb<HQ;Hb++)HM.bones.push(Hi.getInt16());HM.target=Hi.readUTFString(),HM.positionMode=Hi.readUTFString(),HM.spacingMode=Hi.readUTFString(),HM.rotateMode=Hi.readUTFString(),HM.offsetRotation=Hi.getFloat32(),HM.position=Hi.getFloat32(),HM.spacing=Hi.getFloat32(),HM.rotateMix=Hi.getFloat32(),HM.translateMix=Hi.getFloat32(),this.pathArr.push(HM)}var HR,HS,HT,HU,HV,HW=0,HX=0,HY=0,HZ=NaN,H$=0,H_=Hi.getInt16();for(Ha=0;Ha<H_;Ha++){var Haa=Hi.getUint8(),Hba={};this.deformAniArr.push(Hba);for(var Hca=0;Hca<Haa;Hca++)for((HR=new HIa).skinName=Hi.getUTFString(),Hba[HR.skinName]=HR,HW=Hi.getInt16(),Hb=0;Hb<HW;Hb++)for(HS=new HJa,HR.deformSlotDataList.push(HS),HX=Hi.getInt16(),Hc=0;Hc<HX;Hc++)for(HT=new HKa,HS.deformSlotDisplayList.push(HT),HT.slotIndex=Hi.getInt16(),HT.attachment=Hi.getUTFString(),HY=Hi.getInt16(),Hd=0;Hd<HY;Hd++)for(1==Hi.getByte()?HT.tweenKeyList.push(!0):HT.tweenKeyList.push(!1),HZ=Hi.getFloat32(),HT.timeList.push(HZ),HU=[],HT.vectices.push(HU),H$=Hi.getInt16(),He=0;He<H$;He++)HU.push(Hi.getFloat32())}var Hda,Hea,Hfa=Hi.getInt16(),Hga=0,Hha=0;for(Ha=0;Ha<Hfa;Ha++){for(Hga=Hi.getInt16(),HV=[],Hb=0;Hb<Hga;Hb++){for((Hda=new HLa).time=Hi.getFloat32(),Hha=Hi.getInt16(),Hc=0;Hc<Hha;Hc++)Hda.drawOrder.push(Hi.getInt16());HV.push(Hda)}this.drawOrderAniArr.push(HV)}var Hia,Hja=Hi.getInt16(),Hka=0;for(Ha=0;Ha<Hja;Ha++){for(Hka=Hi.getInt16(),Hea=[],Hb=0;Hb<Hka;Hb++)(Hia=new HMa).name=Hi.getUTFString(),Hia.intValue=Hi.getInt32(),Hia.floatValue=Hi.getFloat32(),Hia.stringValue=Hi.getUTFString(),Hia.time=Hi.getFloat32(),Hea.push(Hia);this.eventAniArr.push(Hea)}var Hla=Hi.getInt16();if(0<Hla)for(this.attachmentNames=[],Ha=0;Ha<Hla;Ha++)this.attachmentNames.push(Hi.getUTFString());var Hma,Hna,Hoa=Hi.getInt16();for(Ha=0;Ha<Hoa;Ha++)(Hma=new HHa).name=Hi.readUTFString(),Hma.parent=Hi.readUTFString(),Hma.attachmentName=Hi.readUTFString(),Hma.srcDisplayIndex=Hma.displayIndex=Hi.getInt16(),(Hma.templet=this).boneSlotDic[Hma.name]=Hma,null==(Hna=this.bindBoneBoneSlotDic[Hma.parent])&&(this.bindBoneBoneSlotDic[Hma.parent]=Hna=[]),Hna.push(Hma),this.boneSlotArray.push(Hma);var Hpa,Hqa,Hra,Hsa=Hi.readUTFString().split("\n"),Hta=0,Hua=Hi.getUint8(),Hva=0,Hwa=0,Hxa=0,Hya=0,Hza=0,HAa=0,HBa=0;for(Ha=0;Ha<Hua;Ha++){for((Hpa=new HPa).name=Hsa[Hta++],Hva=Hi.getUint8(),Hb=0;Hb<Hva;Hb++){for((Hqa=new HRa).name=Hsa[Hta++],Hma=this.boneSlotDic[Hqa.name],Hwa=Hi.getUint8(),Hc=0;Hc<Hwa;Hc++){if(Hra=new HQa,this.skinSlotDisplayDataArr.push(Hra),Hra.name=Hsa[Hta++],Hra.attachmentName=Hsa[Hta++],Hra.transform=new HTa,Hra.transform.scX=Hi.getFloat32(),Hra.transform.skX=Hi.getFloat32(),Hra.transform.skY=Hi.getFloat32(),Hra.transform.scY=Hi.getFloat32(),Hra.transform.x=Hi.getFloat32(),Hra.transform.y=Hi.getFloat32(),Hqa.displayArr.push(Hra),Hra.width=Hi.getFloat32(),Hra.height=Hi.getFloat32(),Hra.type=Hi.getUint8(),Hra.verLen=Hi.getUint16(),0<(HC=Hi.getUint16()))for(Hra.bones=[],Hd=0;Hd<HC;Hd++){var HCa=Hi.getUint16();Hra.bones.push(HCa)}if(0<(Hxa=Hi.getUint16()))for(Hra.uvs=[],Hd=0;Hd<Hxa;Hd++)Hra.uvs.push(Hi.getFloat32());if(0<(Hya=Hi.getUint16()))for(Hra.weights=[],Hd=0;Hd<Hya;Hd++)Hra.weights.push(Hi.getFloat32());if(0<(Hza=Hi.getUint16()))for(Hra.triangles=[],Hd=0;Hd<Hza;Hd++)Hra.triangles.push(Hi.getUint16());if(0<(HAa=Hi.getUint16()))for(Hra.vertices=[],Hd=0;Hd<HAa;Hd++)Hra.vertices.push(Hi.getFloat32());if(0<(HBa=Hi.getUint16()))for(Hra.lengths=[],Hd=0;Hd<HBa;Hd++)Hra.lengths.push(Hi.getFloat32())}Hpa.slotArr.push(Hqa)}this.skinDic[Hpa.name]=Hpa,this.skinDataArray.push(Hpa)}1==Hi.getUint8()?(this.yReverseMatrix=new HEa(1,0,0,-1,0,0),HB&&HB.setTempMatrix(this.yReverseMatrix)):HB&&HB.setTempMatrix(new HEa),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},Ha.getTexture=function(Ha){var Hb=this.subTextureDic[Ha];return Hb||(Hb=this.subTextureDic[Ha.substr(0,Ha.length-1)]),null==Hb?this._mainTexture:Hb},Ha.showSkinByIndex=function(Ha,Hb,Hc){if(void 0===Hc&&(Hc=!0),Hb<0&&Hb>=this.skinDataArray.length)return!1;var Hd,He,Hf=0,Hg=0,Hh=this.skinDataArray[Hb];if(Hh){for(Hf=0,Hg=Hh.slotArr.length;Hf<Hg;Hf++)(He=Hh.slotArr[Hf])&&(Hd=Ha[He.name])&&(Hd.showSlotData(He,Hc),Hc&&"undefined"!=Hd.attachmentName&&"null"!=Hd.attachmentName?Hd.showDisplayByName(Hd.attachmentName):Hd.showDisplayByIndex(Hd.displayIndex));return!0}return!1},Ha.getSkinIndexByName=function(Ha){for(var Hb=0,Hc=this.skinDataArray.length;Hb<Hc;Hb++)if(this.skinDataArray[Hb].name==Ha)return Hb;return-1},Ha.getGrahicsDataWithCache=function(Ha,Hb){return this._graphicsCache[Ha][Hb]},Ha.setGrahicsDataWithCache=function(Ha,Hb,Hc){this._graphicsCache[Ha][Hb]=Hc},Ha.destroy=function(){var Ha;for(var Hb in this._isDestroyed=!0,this.subTextureDic)(Ha=this.subTextureDic[Hb])&&Ha.destroy();for(Hb in this._textureDic)(Ha=this._textureDic[Hb])&&Ha.destroy();for(var Hc=0,Hd=this.skinSlotDisplayDataArr.length;Hc<Hd;Hc++)this.skinSlotDisplayDataArr[Hc].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete He.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},Ha.getAniNameByIndex=function(Ha){var Hb=this.getAnimation(Ha);return Hb?Hb.name:null},Hf(0,Ha,"rate",function(){return this._rate},function(Ha){this._rate=Ha}),He.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",He.TEMPLET_DICTIONARY=null,He}(HI)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ha,Hb){"use strict";for(var Hc in Object.defineProperty(Hb,"__esModule",{value:!0}),Laya){var Hd=Laya[Hc];Hd&&Hd.__isclass&&(Hb[Hc]=Hd)}});